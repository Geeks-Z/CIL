nohup: 忽略输入
2024-09-14 12:21:25,183 [trainer.py] => config: ./exps/finetune_vtab_B0_Inc5.json
2024-09-14 12:21:25,183 [trainer.py] => prefix: reproduce
2024-09-14 12:21:25,183 [trainer.py] => dataset: vtab
2024-09-14 12:21:25,183 [trainer.py] => memory_size: 0
2024-09-14 12:21:25,183 [trainer.py] => memory_per_class: 0
2024-09-14 12:21:25,183 [trainer.py] => fixed_memory: False
2024-09-14 12:21:25,183 [trainer.py] => shuffle: True
2024-09-14 12:21:25,184 [trainer.py] => init_cls: 10
2024-09-14 12:21:25,184 [trainer.py] => increment: 10
2024-09-14 12:21:25,184 [trainer.py] => model_name: finetune
2024-09-14 12:21:25,184 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-14 12:21:25,184 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 12:21:25,184 [trainer.py] => seed: 1993
2024-09-14 12:21:25,184 [trainer.py] => init_epoch: 20
2024-09-14 12:21:25,184 [trainer.py] => init_lr: 0.001
2024-09-14 12:21:25,184 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-14 12:21:25,184 [trainer.py] => init_lr_decay: 0.1
2024-09-14 12:21:25,184 [trainer.py] => init_weight_decay: 0.0005
2024-09-14 12:21:25,184 [trainer.py] => epochs: 20
2024-09-14 12:21:25,184 [trainer.py] => lrate: 0.001
2024-09-14 12:21:25,184 [trainer.py] => milestones: [40, 70]
2024-09-14 12:21:25,184 [trainer.py] => lrate_decay: 0.1
2024-09-14 12:21:25,184 [trainer.py] => batch_size: 48
2024-09-14 12:21:25,184 [trainer.py] => weight_decay: 0.0002
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 12:21:25,706 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-14 12:21:27,900 [trainer.py] => All params: 85798656
2024-09-14 12:21:27,901 [trainer.py] => Trainable params: 85798656
2024-09-14 12:21:27,901 [finetune.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.543, Train_accy 24.84, Test_accy 24.33:   0%|          | 0/20 [00:05<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.543, Train_accy 24.84, Test_accy 24.33:   5%|▌         | 1/20 [00:05<01:45,  5.58s/it]
Task 0, Epoch 2/20 => Loss 1.203, Train_accy 55.28:   5%|▌         | 1/20 [00:07<01:45,  5.58s/it]                 
Task 0, Epoch 2/20 => Loss 1.203, Train_accy 55.28:  10%|█         | 2/20 [00:07<00:58,  3.25s/it]
Task 0, Epoch 3/20 => Loss 0.309, Train_accy 88.82:  10%|█         | 2/20 [00:08<00:58,  3.25s/it]
Task 0, Epoch 3/20 => Loss 0.309, Train_accy 88.82:  15%|█▌        | 3/20 [00:08<00:42,  2.51s/it]
Task 0, Epoch 4/20 => Loss 0.193, Train_accy 93.17:  15%|█▌        | 3/20 [00:10<00:42,  2.51s/it]
Task 0, Epoch 4/20 => Loss 0.193, Train_accy 93.17:  20%|██        | 4/20 [00:10<00:35,  2.20s/it]
Task 0, Epoch 5/20 => Loss 0.141, Train_accy 94.41:  20%|██        | 4/20 [00:12<00:35,  2.20s/it]
Task 0, Epoch 5/20 => Loss 0.141, Train_accy 94.41:  25%|██▌       | 5/20 [00:12<00:30,  2.01s/it]
Task 0, Epoch 6/20 => Loss 0.214, Train_accy 93.17, Test_accy 85.59:  25%|██▌       | 5/20 [00:16<00:30,  2.01s/it]
Task 0, Epoch 6/20 => Loss 0.214, Train_accy 93.17, Test_accy 85.59:  30%|███       | 6/20 [00:16<00:40,  2.92s/it]
Task 0, Epoch 7/20 => Loss 0.186, Train_accy 90.68:  30%|███       | 6/20 [00:18<00:40,  2.92s/it]                 
Task 0, Epoch 7/20 => Loss 0.186, Train_accy 90.68:  35%|███▌      | 7/20 [00:18<00:32,  2.52s/it]
Task 0, Epoch 8/20 => Loss 0.316, Train_accy 93.17:  35%|███▌      | 7/20 [00:20<00:32,  2.52s/it]
Task 0, Epoch 8/20 => Loss 0.316, Train_accy 93.17:  40%|████      | 8/20 [00:20<00:27,  2.28s/it]
Task 0, Epoch 9/20 => Loss 0.237, Train_accy 92.55:  40%|████      | 8/20 [00:22<00:27,  2.28s/it]
Task 0, Epoch 9/20 => Loss 0.237, Train_accy 92.55:  45%|████▌     | 9/20 [00:22<00:23,  2.10s/it]
Task 0, Epoch 10/20 => Loss 0.261, Train_accy 93.17:  45%|████▌     | 9/20 [00:23<00:23,  2.10s/it]
Task 0, Epoch 10/20 => Loss 0.261, Train_accy 93.17:  50%|█████     | 10/20 [00:23<00:19,  1.96s/it]
Task 0, Epoch 11/20 => Loss 0.069, Train_accy 98.76, Test_accy 96.13:  50%|█████     | 10/20 [00:28<00:19,  1.96s/it]
Task 0, Epoch 11/20 => Loss 0.069, Train_accy 98.76, Test_accy 96.13:  55%|█████▌    | 11/20 [00:28<00:24,  2.77s/it]
Task 0, Epoch 12/20 => Loss 0.094, Train_accy 96.89:  55%|█████▌    | 11/20 [00:30<00:24,  2.77s/it]                 
Task 0, Epoch 12/20 => Loss 0.094, Train_accy 96.89:  60%|██████    | 12/20 [00:30<00:19,  2.44s/it]
Task 0, Epoch 13/20 => Loss 0.087, Train_accy 96.27:  60%|██████    | 12/20 [00:31<00:19,  2.44s/it]
Task 0, Epoch 13/20 => Loss 0.087, Train_accy 96.27:  65%|██████▌   | 13/20 [00:31<00:15,  2.21s/it]
Task 0, Epoch 14/20 => Loss 0.109, Train_accy 97.52:  65%|██████▌   | 13/20 [00:33<00:15,  2.21s/it]
Task 0, Epoch 14/20 => Loss 0.109, Train_accy 97.52:  70%|███████   | 14/20 [00:33<00:12,  2.06s/it]
Task 0, Epoch 15/20 => Loss 0.069, Train_accy 96.89:  70%|███████   | 14/20 [00:35<00:12,  2.06s/it]
Task 0, Epoch 15/20 => Loss 0.069, Train_accy 96.89:  75%|███████▌  | 15/20 [00:35<00:09,  1.95s/it]
Task 0, Epoch 16/20 => Loss 0.020, Train_accy 98.76, Test_accy 96.25:  75%|███████▌  | 15/20 [00:39<00:09,  1.95s/it]
Task 0, Epoch 16/20 => Loss 0.020, Train_accy 98.76, Test_accy 96.25:  80%|████████  | 16/20 [00:39<00:11,  2.76s/it]
Task 0, Epoch 17/20 => Loss 0.076, Train_accy 97.52:  80%|████████  | 16/20 [00:41<00:11,  2.76s/it]                 
Task 0, Epoch 17/20 => Loss 0.076, Train_accy 97.52:  85%|████████▌ | 17/20 [00:41<00:07,  2.43s/it]
Task 0, Epoch 18/20 => Loss 0.065, Train_accy 96.89:  85%|████████▌ | 17/20 [00:43<00:07,  2.43s/it]
Task 0, Epoch 18/20 => Loss 0.065, Train_accy 96.89:  90%|█████████ | 18/20 [00:43<00:04,  2.19s/it]
Task 0, Epoch 19/20 => Loss 0.050, Train_accy 98.14:  90%|█████████ | 18/20 [00:44<00:04,  2.19s/it]
Task 0, Epoch 19/20 => Loss 0.050, Train_accy 98.14:  95%|█████████▌| 19/20 [00:44<00:02,  2.03s/it]
Task 0, Epoch 20/20 => Loss 0.071, Train_accy 98.14:  95%|█████████▌| 19/20 [00:46<00:02,  2.03s/it]
Task 0, Epoch 20/20 => Loss 0.071, Train_accy 98.14: 100%|██████████| 20/20 [00:46<00:00,  1.93s/it]
Task 0, Epoch 20/20 => Loss 0.071, Train_accy 98.14: 100%|██████████| 20/20 [00:46<00:00,  2.32s/it]2024-09-14 12:22:14,831 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.071, Train_accy 98.14

2024-09-14 12:22:17,824 [trainer.py] => No NME accuracy.
2024-09-14 12:22:17,824 [trainer.py] => CNN: {'total': 97.34, '00-09': 97.34, 'old': 0, 'new': 97.34}
2024-09-14 12:22:17,824 [trainer.py] => CNN top1 curve: [97.34]
2024-09-14 12:22:17,824 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.34
2024-09-14 12:22:17,824 [trainer.py] => Average Accuracy (CNN): 97.34 

2024-09-14 12:22:17,825 [trainer.py] => All params: 85806346
2024-09-14 12:22:17,826 [trainer.py] => Trainable params: 85806346
2024-09-14 12:22:17,828 [finetune.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.520, Train_accy 22.95, Test_accy 54.62:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.520, Train_accy 22.95, Test_accy 54.62:   5%|▌         | 1/20 [00:12<03:56, 12.44s/it]
Task 1, Epoch 2/20 => Loss 0.619, Train_accy 69.32:   5%|▌         | 1/20 [00:15<03:56, 12.44s/it]                 
Task 1, Epoch 2/20 => Loss 0.619, Train_accy 69.32:  10%|█         | 2/20 [00:15<02:09,  7.21s/it]
Task 1, Epoch 3/20 => Loss 0.361, Train_accy 83.09:  10%|█         | 2/20 [00:19<02:09,  7.21s/it]
Task 1, Epoch 3/20 => Loss 0.361, Train_accy 83.09:  15%|█▌        | 3/20 [00:19<01:33,  5.48s/it]
Task 1, Epoch 4/20 => Loss 0.200, Train_accy 93.00:  15%|█▌        | 3/20 [00:23<01:33,  5.48s/it]
Task 1, Epoch 4/20 => Loss 0.200, Train_accy 93.00:  20%|██        | 4/20 [00:23<01:15,  4.74s/it]
Task 1, Epoch 5/20 => Loss 0.157, Train_accy 94.44:  20%|██        | 4/20 [00:26<01:15,  4.74s/it]
Task 1, Epoch 5/20 => Loss 0.157, Train_accy 94.44:  25%|██▌       | 5/20 [00:26<01:05,  4.34s/it]
Task 1, Epoch 6/20 => Loss 0.157, Train_accy 94.44, Test_accy 94.06:  25%|██▌       | 5/20 [00:38<01:05,  4.34s/it]
Task 1, Epoch 6/20 => Loss 0.157, Train_accy 94.44, Test_accy 94.06:  30%|███       | 6/20 [00:38<01:36,  6.92s/it]
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 93.48:  30%|███       | 6/20 [00:41<01:36,  6.92s/it]                 
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 93.48:  35%|███▌      | 7/20 [00:41<01:14,  5.74s/it]
Task 1, Epoch 8/20 => Loss 0.112, Train_accy 96.62:  35%|███▌      | 7/20 [00:45<01:14,  5.74s/it]
Task 1, Epoch 8/20 => Loss 0.112, Train_accy 96.62:  40%|████      | 8/20 [00:45<00:59,  4.95s/it]
Task 1, Epoch 9/20 => Loss 0.130, Train_accy 95.89:  40%|████      | 8/20 [00:48<00:59,  4.95s/it]
Task 1, Epoch 9/20 => Loss 0.130, Train_accy 95.89:  45%|████▌     | 9/20 [00:48<00:49,  4.46s/it]
Task 1, Epoch 10/20 => Loss 0.083, Train_accy 96.38:  45%|████▌     | 9/20 [00:51<00:49,  4.46s/it]
Task 1, Epoch 10/20 => Loss 0.083, Train_accy 96.38:  50%|█████     | 10/20 [00:51<00:40,  4.09s/it]
Task 1, Epoch 11/20 => Loss 0.097, Train_accy 96.62, Test_accy 96.35:  50%|█████     | 10/20 [01:03<00:40,  4.09s/it]
Task 1, Epoch 11/20 => Loss 0.097, Train_accy 96.62, Test_accy 96.35:  55%|█████▌    | 11/20 [01:03<00:57,  6.40s/it]
Task 1, Epoch 12/20 => Loss 0.091, Train_accy 97.34:  55%|█████▌    | 11/20 [01:06<00:57,  6.40s/it]                 
Task 1, Epoch 12/20 => Loss 0.091, Train_accy 97.34:  60%|██████    | 12/20 [01:06<00:43,  5.46s/it]
Task 1, Epoch 13/20 => Loss 0.121, Train_accy 94.69:  60%|██████    | 12/20 [01:10<00:43,  5.46s/it]
Task 1, Epoch 13/20 => Loss 0.121, Train_accy 94.69:  65%|██████▌   | 13/20 [01:10<00:34,  4.86s/it]
Task 1, Epoch 14/20 => Loss 0.078, Train_accy 96.86:  65%|██████▌   | 13/20 [01:13<00:34,  4.86s/it]
Task 1, Epoch 14/20 => Loss 0.078, Train_accy 96.86:  70%|███████   | 14/20 [01:13<00:26,  4.45s/it]
Task 1, Epoch 15/20 => Loss 0.067, Train_accy 96.86:  70%|███████   | 14/20 [01:17<00:26,  4.45s/it]
Task 1, Epoch 15/20 => Loss 0.067, Train_accy 96.86:  75%|███████▌  | 15/20 [01:17<00:21,  4.21s/it]
Task 1, Epoch 16/20 => Loss 0.055, Train_accy 98.55, Test_accy 94.59:  75%|███████▌  | 15/20 [01:29<00:21,  4.21s/it]
Task 1, Epoch 16/20 => Loss 0.055, Train_accy 98.55, Test_accy 94.59:  80%|████████  | 16/20 [01:29<00:25,  6.50s/it]
Task 1, Epoch 17/20 => Loss 0.058, Train_accy 97.83:  80%|████████  | 16/20 [01:32<00:25,  6.50s/it]                 
Task 1, Epoch 17/20 => Loss 0.058, Train_accy 97.83:  85%|████████▌ | 17/20 [01:32<00:16,  5.55s/it]
Task 1, Epoch 18/20 => Loss 0.065, Train_accy 97.58:  85%|████████▌ | 17/20 [01:35<00:16,  5.55s/it]
Task 1, Epoch 18/20 => Loss 0.065, Train_accy 97.58:  90%|█████████ | 18/20 [01:35<00:09,  4.91s/it]
Task 1, Epoch 19/20 => Loss 0.081, Train_accy 96.62:  90%|█████████ | 18/20 [01:39<00:09,  4.91s/it]
Task 1, Epoch 19/20 => Loss 0.081, Train_accy 96.62:  95%|█████████▌| 19/20 [01:39<00:04,  4.47s/it]
Task 1, Epoch 20/20 => Loss 0.064, Train_accy 97.83:  95%|█████████▌| 19/20 [01:42<00:04,  4.47s/it]
Task 1, Epoch 20/20 => Loss 0.064, Train_accy 97.83: 100%|██████████| 20/20 [01:42<00:00,  4.11s/it]
Task 1, Epoch 20/20 => Loss 0.064, Train_accy 97.83: 100%|██████████| 20/20 [01:42<00:00,  5.13s/it]2024-09-14 12:24:00,533 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.064, Train_accy 97.83

2024-09-14 12:24:08,853 [trainer.py] => No NME accuracy.
2024-09-14 12:24:08,853 [trainer.py] => CNN: {'total': 94.66, '00-09': 89.83, '10-19': 96.64, 'old': 89.83, 'new': 96.64}
2024-09-14 12:24:08,854 [trainer.py] => CNN top1 curve: [97.34, 94.66]
2024-09-14 12:24:08,854 [trainer.py] => CNN top5 curve: [100.0, 99.65]

Average Accuracy (CNN): 96.0
2024-09-14 12:24:08,854 [trainer.py] => Average Accuracy (CNN): 96.0 

2024-09-14 12:24:08,855 [trainer.py] => All params: 85814036
2024-09-14 12:24:08,856 [trainer.py] => Trainable params: 85814036
2024-09-14 12:24:08,858 [finetune.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.582, Train_accy 22.19, Test_accy 67.19:   0%|          | 0/20 [00:16<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.582, Train_accy 22.19, Test_accy 67.19:   5%|▌         | 1/20 [00:16<05:17, 16.73s/it]
Task 2, Epoch 2/20 => Loss 0.318, Train_accy 63.84:   5%|▌         | 1/20 [00:19<05:17, 16.73s/it]                 
Task 2, Epoch 2/20 => Loss 0.318, Train_accy 63.84:  10%|█         | 2/20 [00:19<02:37,  8.75s/it]
Task 2, Epoch 3/20 => Loss 0.175, Train_accy 83.29:  10%|█         | 2/20 [00:23<02:37,  8.75s/it]
Task 2, Epoch 3/20 => Loss 0.175, Train_accy 83.29:  15%|█▌        | 3/20 [00:23<01:45,  6.19s/it]
Task 2, Epoch 4/20 => Loss 0.104, Train_accy 90.41:  15%|█▌        | 3/20 [00:26<01:45,  6.19s/it]
Task 2, Epoch 4/20 => Loss 0.104, Train_accy 90.41:  20%|██        | 4/20 [00:26<01:20,  5.00s/it]
Task 2, Epoch 5/20 => Loss 0.112, Train_accy 92.60:  20%|██        | 4/20 [00:29<01:20,  5.00s/it]
Task 2, Epoch 5/20 => Loss 0.112, Train_accy 92.60:  25%|██▌       | 5/20 [00:29<01:05,  4.35s/it]
Task 2, Epoch 6/20 => Loss 0.142, Train_accy 93.70, Test_accy 73.62:  25%|██▌       | 5/20 [00:46<01:05,  4.35s/it]
Task 2, Epoch 6/20 => Loss 0.142, Train_accy 93.70, Test_accy 73.62:  30%|███       | 6/20 [00:46<02:00,  8.63s/it]
Task 2, Epoch 7/20 => Loss 0.083, Train_accy 94.52:  30%|███       | 6/20 [00:49<02:00,  8.63s/it]                 
Task 2, Epoch 7/20 => Loss 0.083, Train_accy 94.52:  35%|███▌      | 7/20 [00:49<01:29,  6.87s/it]
Task 2, Epoch 8/20 => Loss 0.081, Train_accy 93.70:  35%|███▌      | 7/20 [00:52<01:29,  6.87s/it]
Task 2, Epoch 8/20 => Loss 0.081, Train_accy 93.70:  40%|████      | 8/20 [00:52<01:08,  5.68s/it]
Task 2, Epoch 9/20 => Loss 0.054, Train_accy 95.62:  40%|████      | 8/20 [00:55<01:08,  5.68s/it]
Task 2, Epoch 9/20 => Loss 0.054, Train_accy 95.62:  45%|████▌     | 9/20 [00:55<00:53,  4.89s/it]
Task 2, Epoch 10/20 => Loss 0.062, Train_accy 95.62:  45%|████▌     | 9/20 [00:59<00:53,  4.89s/it]
Task 2, Epoch 10/20 => Loss 0.062, Train_accy 95.62:  50%|█████     | 10/20 [00:59<00:43,  4.40s/it]
Task 2, Epoch 11/20 => Loss 0.099, Train_accy 94.52, Test_accy 74.91:  50%|█████     | 10/20 [01:16<00:43,  4.40s/it]
Task 2, Epoch 11/20 => Loss 0.099, Train_accy 94.52, Test_accy 74.91:  55%|█████▌    | 11/20 [01:16<01:14,  8.25s/it]
Task 2, Epoch 12/20 => Loss 0.106, Train_accy 92.33:  55%|█████▌    | 11/20 [01:19<01:14,  8.25s/it]                 
Task 2, Epoch 12/20 => Loss 0.106, Train_accy 92.33:  60%|██████    | 12/20 [01:19<00:53,  6.72s/it]
Task 2, Epoch 13/20 => Loss 0.075, Train_accy 94.25:  60%|██████    | 12/20 [01:22<00:53,  6.72s/it]
Task 2, Epoch 13/20 => Loss 0.075, Train_accy 94.25:  65%|██████▌   | 13/20 [01:22<00:39,  5.71s/it]
Task 2, Epoch 14/20 => Loss 0.063, Train_accy 96.44:  65%|██████▌   | 13/20 [01:27<00:39,  5.71s/it]
Task 2, Epoch 14/20 => Loss 0.063, Train_accy 96.44:  70%|███████   | 14/20 [01:27<00:31,  5.29s/it]
Task 2, Epoch 15/20 => Loss 0.101, Train_accy 96.16:  70%|███████   | 14/20 [01:30<00:31,  5.29s/it]
Task 2, Epoch 15/20 => Loss 0.101, Train_accy 96.16:  75%|███████▌  | 15/20 [01:30<00:23,  4.73s/it]
Task 2, Epoch 16/20 => Loss 0.063, Train_accy 97.26, Test_accy 74.24:  75%|███████▌  | 15/20 [01:47<00:23,  4.73s/it]
Task 2, Epoch 16/20 => Loss 0.063, Train_accy 97.26, Test_accy 74.24:  80%|████████  | 16/20 [01:47<00:33,  8.37s/it]
Task 2, Epoch 17/20 => Loss 0.059, Train_accy 97.26:  80%|████████  | 16/20 [01:50<00:33,  8.37s/it]                 
Task 2, Epoch 17/20 => Loss 0.059, Train_accy 97.26:  85%|████████▌ | 17/20 [01:50<00:20,  6.79s/it]
Task 2, Epoch 18/20 => Loss 0.027, Train_accy 96.71:  85%|████████▌ | 17/20 [01:53<00:20,  6.79s/it]
Task 2, Epoch 18/20 => Loss 0.027, Train_accy 96.71:  90%|█████████ | 18/20 [01:53<00:11,  5.67s/it]
Task 2, Epoch 19/20 => Loss 0.076, Train_accy 93.15:  90%|█████████ | 18/20 [01:56<00:11,  5.67s/it]
Task 2, Epoch 19/20 => Loss 0.076, Train_accy 93.15:  95%|█████████▌| 19/20 [01:56<00:04,  4.88s/it]
Task 2, Epoch 20/20 => Loss 0.032, Train_accy 97.53:  95%|█████████▌| 19/20 [01:59<00:04,  4.88s/it]
Task 2, Epoch 20/20 => Loss 0.032, Train_accy 97.53: 100%|██████████| 20/20 [01:59<00:00,  4.32s/it]
Task 2, Epoch 20/20 => Loss 0.032, Train_accy 97.53: 100%|██████████| 20/20 [01:59<00:00,  5.98s/it]2024-09-14 12:26:08,439 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.032, Train_accy 97.53

2024-09-14 12:26:21,390 [trainer.py] => No NME accuracy.
2024-09-14 12:26:21,391 [trainer.py] => CNN: {'total': 73.64, '00-09': 69.13, '10-19': 59.03, '20-29': 94.0, 'old': 61.96, 'new': 94.0}
2024-09-14 12:26:21,391 [trainer.py] => CNN top1 curve: [97.34, 94.66, 73.64]
2024-09-14 12:26:21,391 [trainer.py] => CNN top5 curve: [100.0, 99.65, 97.12]

Average Accuracy (CNN): 88.55
2024-09-14 12:26:21,391 [trainer.py] => Average Accuracy (CNN): 88.55 

2024-09-14 12:26:21,392 [trainer.py] => All params: 85821726
2024-09-14 12:26:21,394 [trainer.py] => Trainable params: 85821726
2024-09-14 12:26:21,396 [finetune.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.758, Train_accy 5.28, Test_accy 61.08:   0%|          | 0/20 [00:19<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.758, Train_accy 5.28, Test_accy 61.08:   5%|▌         | 1/20 [00:19<06:02, 19.10s/it]
Task 3, Epoch 2/20 => Loss 0.370, Train_accy 31.68:   5%|▌         | 1/20 [00:21<06:02, 19.10s/it]                
Task 3, Epoch 2/20 => Loss 0.370, Train_accy 31.68:  10%|█         | 2/20 [00:21<02:51,  9.53s/it]
Task 3, Epoch 3/20 => Loss 0.176, Train_accy 57.76:  10%|█         | 2/20 [00:24<02:51,  9.53s/it]
Task 3, Epoch 3/20 => Loss 0.176, Train_accy 57.76:  15%|█▌        | 3/20 [00:24<01:49,  6.45s/it]
Task 3, Epoch 4/20 => Loss 0.142, Train_accy 66.67:  15%|█▌        | 3/20 [00:27<01:49,  6.45s/it]
Task 3, Epoch 4/20 => Loss 0.142, Train_accy 66.67:  20%|██        | 4/20 [00:27<01:19,  4.98s/it]
Task 3, Epoch 5/20 => Loss 0.108, Train_accy 88.12:  20%|██        | 4/20 [00:30<01:19,  4.98s/it]
Task 3, Epoch 5/20 => Loss 0.108, Train_accy 88.12:  25%|██▌       | 5/20 [00:30<01:02,  4.14s/it]
Task 3, Epoch 6/20 => Loss 0.105, Train_accy 89.11, Test_accy 67.36:  25%|██▌       | 5/20 [00:49<01:02,  4.14s/it]
Task 3, Epoch 6/20 => Loss 0.105, Train_accy 89.11, Test_accy 67.36:  30%|███       | 6/20 [00:49<02:09,  9.26s/it]
Task 3, Epoch 7/20 => Loss 0.041, Train_accy 85.81:  30%|███       | 6/20 [00:51<02:09,  9.26s/it]                 
Task 3, Epoch 7/20 => Loss 0.041, Train_accy 85.81:  35%|███▌      | 7/20 [00:51<01:32,  7.12s/it]
Task 3, Epoch 8/20 => Loss 0.060, Train_accy 83.17:  35%|███▌      | 7/20 [00:54<01:32,  7.12s/it]
Task 3, Epoch 8/20 => Loss 0.060, Train_accy 83.17:  40%|████      | 8/20 [00:54<01:08,  5.68s/it]
Task 3, Epoch 9/20 => Loss 0.041, Train_accy 90.10:  40%|████      | 8/20 [00:57<01:08,  5.68s/it]
Task 3, Epoch 9/20 => Loss 0.041, Train_accy 90.10:  45%|████▌     | 9/20 [00:57<00:51,  4.70s/it]
Task 3, Epoch 10/20 => Loss 0.023, Train_accy 90.10:  45%|████▌     | 9/20 [00:59<00:51,  4.70s/it]
Task 3, Epoch 10/20 => Loss 0.023, Train_accy 90.10:  50%|█████     | 10/20 [00:59<00:40,  4.03s/it]
Task 3, Epoch 11/20 => Loss 0.027, Train_accy 90.76, Test_accy 63.05:  50%|█████     | 10/20 [01:20<00:40,  4.03s/it]
Task 3, Epoch 11/20 => Loss 0.027, Train_accy 90.76, Test_accy 63.05:  55%|█████▌    | 11/20 [01:20<01:22,  9.12s/it]
Task 3, Epoch 12/20 => Loss 0.040, Train_accy 93.07:  55%|█████▌    | 11/20 [01:23<01:22,  9.12s/it]                 
Task 3, Epoch 12/20 => Loss 0.040, Train_accy 93.07:  60%|██████    | 12/20 [01:23<00:57,  7.23s/it]
Task 3, Epoch 13/20 => Loss 0.066, Train_accy 95.05:  60%|██████    | 12/20 [01:26<00:57,  7.23s/it]
Task 3, Epoch 13/20 => Loss 0.066, Train_accy 95.05:  65%|██████▌   | 13/20 [01:26<00:41,  5.90s/it]
Task 3, Epoch 14/20 => Loss 0.069, Train_accy 86.47:  65%|██████▌   | 13/20 [01:28<00:41,  5.90s/it]
Task 3, Epoch 14/20 => Loss 0.069, Train_accy 86.47:  70%|███████   | 14/20 [01:28<00:29,  4.97s/it]
Task 3, Epoch 15/20 => Loss 0.045, Train_accy 81.19:  70%|███████   | 14/20 [01:31<00:29,  4.97s/it]
Task 3, Epoch 15/20 => Loss 0.045, Train_accy 81.19:  75%|███████▌  | 15/20 [01:31<00:21,  4.31s/it]
Task 3, Epoch 16/20 => Loss 0.039, Train_accy 82.51, Test_accy 66.86:  75%|███████▌  | 15/20 [01:52<00:21,  4.31s/it]
Task 3, Epoch 16/20 => Loss 0.039, Train_accy 82.51, Test_accy 66.86:  80%|████████  | 16/20 [01:52<00:36,  9.20s/it]
Task 3, Epoch 17/20 => Loss 0.091, Train_accy 85.81:  80%|████████  | 16/20 [01:55<00:36,  9.20s/it]                 
Task 3, Epoch 17/20 => Loss 0.091, Train_accy 85.81:  85%|████████▌ | 17/20 [01:55<00:21,  7.27s/it]
Task 3, Epoch 18/20 => Loss 0.144, Train_accy 81.85:  85%|████████▌ | 17/20 [01:57<00:21,  7.27s/it]
Task 3, Epoch 18/20 => Loss 0.144, Train_accy 81.85:  90%|█████████ | 18/20 [01:57<00:11,  5.89s/it]
Task 3, Epoch 19/20 => Loss 0.090, Train_accy 83.83:  90%|█████████ | 18/20 [02:00<00:11,  5.89s/it]
Task 3, Epoch 19/20 => Loss 0.090, Train_accy 83.83:  95%|█████████▌| 19/20 [02:00<00:04,  4.93s/it]
Task 3, Epoch 20/20 => Loss 0.060, Train_accy 79.21:  95%|█████████▌| 19/20 [02:03<00:04,  4.93s/it]
Task 3, Epoch 20/20 => Loss 0.060, Train_accy 79.21: 100%|██████████| 20/20 [02:03<00:00,  4.31s/it]
Task 3, Epoch 20/20 => Loss 0.060, Train_accy 79.21: 100%|██████████| 20/20 [02:03<00:00,  6.16s/it]2024-09-14 12:28:24,676 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.060, Train_accy 79.21

2024-09-14 12:28:42,341 [trainer.py] => No NME accuracy.
2024-09-14 12:28:42,342 [trainer.py] => CNN: {'total': 65.86, '00-09': 43.7, '10-19': 56.16, '20-29': 73.73, '30-39': 85.92, 'old': 60.27, 'new': 85.92}
2024-09-14 12:28:42,342 [trainer.py] => CNN top1 curve: [97.34, 94.66, 73.64, 65.86]
2024-09-14 12:28:42,342 [trainer.py] => CNN top5 curve: [100.0, 99.65, 97.12, 97.0]

Average Accuracy (CNN): 82.88
2024-09-14 12:28:42,342 [trainer.py] => Average Accuracy (CNN): 82.88 

2024-09-14 12:28:42,344 [trainer.py] => All params: 85829416
2024-09-14 12:28:42,346 [trainer.py] => Trainable params: 85829416
2024-09-14 12:28:42,348 [finetune.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.386, Train_accy 18.63, Test_accy 45.45:   0%|          | 0/20 [00:30<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.386, Train_accy 18.63, Test_accy 45.45:   5%|▌         | 1/20 [00:30<09:39, 30.53s/it]
Task 4, Epoch 2/20 => Loss 0.291, Train_accy 62.39:   5%|▌         | 1/20 [00:34<09:39, 30.53s/it]                 
Task 4, Epoch 2/20 => Loss 0.291, Train_accy 62.39:  10%|█         | 2/20 [00:34<04:31, 15.08s/it]
Task 4, Epoch 3/20 => Loss 0.477, Train_accy 71.07:  10%|█         | 2/20 [00:39<04:31, 15.08s/it]
Task 4, Epoch 3/20 => Loss 0.477, Train_accy 71.07:  15%|█▌        | 3/20 [00:39<02:52, 10.13s/it]
Task 4, Epoch 4/20 => Loss 0.329, Train_accy 70.16:  15%|█▌        | 3/20 [00:43<02:52, 10.13s/it]
Task 4, Epoch 4/20 => Loss 0.329, Train_accy 70.16:  20%|██        | 4/20 [00:43<02:05,  7.86s/it]
Task 4, Epoch 5/20 => Loss 0.175, Train_accy 81.74:  20%|██        | 4/20 [00:47<02:05,  7.86s/it]
Task 4, Epoch 5/20 => Loss 0.175, Train_accy 81.74:  25%|██▌       | 5/20 [00:47<01:38,  6.57s/it]
Task 4, Epoch 6/20 => Loss 0.166, Train_accy 86.98, Test_accy 60.80:  25%|██▌       | 5/20 [01:17<01:38,  6.57s/it]
Task 4, Epoch 6/20 => Loss 0.166, Train_accy 86.98, Test_accy 60.80:  30%|███       | 6/20 [01:17<03:24, 14.58s/it]
Task 4, Epoch 7/20 => Loss 0.274, Train_accy 82.46:  30%|███       | 6/20 [01:22<03:24, 14.58s/it]                 
Task 4, Epoch 7/20 => Loss 0.274, Train_accy 82.46:  35%|███▌      | 7/20 [01:22<02:25, 11.22s/it]
Task 4, Epoch 8/20 => Loss 0.150, Train_accy 86.98:  35%|███▌      | 7/20 [01:26<02:25, 11.22s/it]
Task 4, Epoch 8/20 => Loss 0.150, Train_accy 86.98:  40%|████      | 8/20 [01:26<01:48,  9.02s/it]
Task 4, Epoch 9/20 => Loss 0.137, Train_accy 89.69:  40%|████      | 8/20 [01:30<01:48,  9.02s/it]
Task 4, Epoch 9/20 => Loss 0.137, Train_accy 89.69:  45%|████▌     | 9/20 [01:30<01:23,  7.56s/it]
Task 4, Epoch 10/20 => Loss 0.164, Train_accy 89.15:  45%|████▌     | 9/20 [01:35<01:23,  7.56s/it]
Task 4, Epoch 10/20 => Loss 0.164, Train_accy 89.15:  50%|█████     | 10/20 [01:35<01:05,  6.58s/it]
Task 4, Epoch 11/20 => Loss 0.098, Train_accy 91.68, Test_accy 61.19:  50%|█████     | 10/20 [02:04<01:05,  6.58s/it]
Task 4, Epoch 11/20 => Loss 0.098, Train_accy 91.68, Test_accy 61.19:  55%|█████▌    | 11/20 [02:04<02:03, 13.67s/it]
Task 4, Epoch 12/20 => Loss 0.126, Train_accy 91.50:  55%|█████▌    | 11/20 [02:09<02:03, 13.67s/it]                 
Task 4, Epoch 12/20 => Loss 0.126, Train_accy 91.50:  60%|██████    | 12/20 [02:09<01:27, 10.92s/it]
Task 4, Epoch 13/20 => Loss 0.105, Train_accy 90.05:  60%|██████    | 12/20 [02:14<01:27, 10.92s/it]
Task 4, Epoch 13/20 => Loss 0.105, Train_accy 90.05:  65%|██████▌   | 13/20 [02:14<01:03,  9.02s/it]
Task 4, Epoch 14/20 => Loss 0.100, Train_accy 89.15:  65%|██████▌   | 13/20 [02:18<01:03,  9.02s/it]
Task 4, Epoch 14/20 => Loss 0.100, Train_accy 89.15:  70%|███████   | 14/20 [02:18<00:46,  7.69s/it]
Task 4, Epoch 15/20 => Loss 0.085, Train_accy 89.87:  70%|███████   | 14/20 [02:23<00:46,  7.69s/it]
Task 4, Epoch 15/20 => Loss 0.085, Train_accy 89.87:  75%|███████▌  | 15/20 [02:23<00:33,  6.75s/it]
Task 4, Epoch 16/20 => Loss 0.077, Train_accy 93.49, Test_accy 63.93:  75%|███████▌  | 15/20 [02:54<00:33,  6.75s/it]
Task 4, Epoch 16/20 => Loss 0.077, Train_accy 93.49, Test_accy 63.93:  80%|████████  | 16/20 [02:54<00:55, 13.94s/it]
Task 4, Epoch 17/20 => Loss 0.063, Train_accy 91.14:  80%|████████  | 16/20 [02:58<00:55, 13.94s/it]                 
Task 4, Epoch 17/20 => Loss 0.063, Train_accy 91.14:  85%|████████▌ | 17/20 [02:58<00:33, 11.13s/it]
Task 4, Epoch 18/20 => Loss 0.087, Train_accy 91.86:  85%|████████▌ | 17/20 [03:03<00:33, 11.13s/it]
Task 4, Epoch 18/20 => Loss 0.087, Train_accy 91.86:  90%|█████████ | 18/20 [03:03<00:18,  9.16s/it]
Task 4, Epoch 19/20 => Loss 0.086, Train_accy 89.69:  90%|█████████ | 18/20 [03:07<00:18,  9.16s/it]
Task 4, Epoch 19/20 => Loss 0.086, Train_accy 89.69:  95%|█████████▌| 19/20 [03:07<00:07,  7.78s/it]
Task 4, Epoch 20/20 => Loss 0.109, Train_accy 90.60:  95%|█████████▌| 19/20 [03:12<00:07,  7.78s/it]
Task 4, Epoch 20/20 => Loss 0.109, Train_accy 90.60: 100%|██████████| 20/20 [03:12<00:00,  6.82s/it]
Task 4, Epoch 20/20 => Loss 0.109, Train_accy 90.60: 100%|██████████| 20/20 [03:12<00:00,  9.62s/it]2024-09-14 12:31:54,703 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.109, Train_accy 90.60

2024-09-14 12:32:20,512 [trainer.py] => No NME accuracy.
2024-09-14 12:32:20,512 [trainer.py] => CNN: {'total': 61.94, '00-09': 39.47, '10-19': 52.25, '20-29': 42.99, '30-39': 54.8, '40-49': 88.96, 'old': 48.32, 'new': 88.96}
2024-09-14 12:32:20,512 [trainer.py] => CNN top1 curve: [97.34, 94.66, 73.64, 65.86, 61.94]
2024-09-14 12:32:20,512 [trainer.py] => CNN top5 curve: [100.0, 99.65, 97.12, 97.0, 92.56]

Average Accuracy (CNN): 78.69
2024-09-14 12:32:20,512 [trainer.py] => Average Accuracy (CNN): 78.69 

Accuracy Matrix (CNN):
[[97.34 89.83 69.13 43.7  39.47]
 [ 0.   96.64 59.03 56.16 52.25]
 [ 0.    0.   94.   73.73 42.99]
 [ 0.    0.    0.   85.92 54.8 ]
 [ 0.    0.    0.    0.   88.96]]
2024-09-14 12:32:20,513 [trainer.py] => Forgetting (CNN): 46.097500000000004
2024-09-14 12:32:33,929 [trainer.py] => config: ./exps/finetune_vtab_B0_Inc10.json
2024-09-14 12:32:33,946 [trainer.py] => prefix: reproduce
2024-09-14 12:32:33,946 [trainer.py] => dataset: vtab
2024-09-14 12:32:33,946 [trainer.py] => memory_size: 0
2024-09-14 12:32:33,946 [trainer.py] => memory_per_class: 0
2024-09-14 12:32:33,946 [trainer.py] => fixed_memory: False
2024-09-14 12:32:33,946 [trainer.py] => shuffle: True
2024-09-14 12:32:33,946 [trainer.py] => init_cls: 5
2024-09-14 12:32:33,947 [trainer.py] => increment: 5
2024-09-14 12:32:33,947 [trainer.py] => model_name: finetune
2024-09-14 12:32:33,947 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-14 12:32:33,947 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 12:32:33,947 [trainer.py] => seed: 1993
2024-09-14 12:32:33,947 [trainer.py] => init_epoch: 20
2024-09-14 12:32:33,947 [trainer.py] => init_lr: 0.001
2024-09-14 12:32:33,947 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-14 12:32:33,947 [trainer.py] => init_lr_decay: 0.1
2024-09-14 12:32:33,948 [trainer.py] => init_weight_decay: 0.0005
2024-09-14 12:32:33,948 [trainer.py] => epochs: 20
2024-09-14 12:32:33,948 [trainer.py] => lrate: 0.001
2024-09-14 12:32:33,948 [trainer.py] => milestones: [40, 70]
2024-09-14 12:32:33,948 [trainer.py] => lrate_decay: 0.1
2024-09-14 12:32:33,948 [trainer.py] => batch_size: 48
2024-09-14 12:32:33,948 [trainer.py] => weight_decay: 0.0002
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 12:32:33,998 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-14 12:32:43,309 [trainer.py] => All params: 85798656
2024-09-14 12:32:43,312 [trainer.py] => Trainable params: 85798656
2024-09-14 12:32:43,313 [finetune.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.576, Train_accy 26.37, Test_accy 51.75:   0%|          | 0/20 [00:03<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.576, Train_accy 26.37, Test_accy 51.75:   5%|▌         | 1/20 [00:03<01:12,  3.80s/it]
Task 0, Epoch 2/20 => Loss 1.095, Train_accy 56.04:   5%|▌         | 1/20 [00:04<01:12,  3.80s/it]                 
Task 0, Epoch 2/20 => Loss 1.095, Train_accy 56.04:  10%|█         | 2/20 [00:04<00:40,  2.26s/it]
Task 0, Epoch 3/20 => Loss 0.467, Train_accy 89.01:  10%|█         | 2/20 [00:06<00:40,  2.26s/it]
Task 0, Epoch 3/20 => Loss 0.467, Train_accy 89.01:  15%|█▌        | 3/20 [00:06<00:29,  1.76s/it]
Task 0, Epoch 4/20 => Loss 0.128, Train_accy 95.60:  15%|█▌        | 3/20 [00:07<00:29,  1.76s/it]
Task 0, Epoch 4/20 => Loss 0.128, Train_accy 95.60:  20%|██        | 4/20 [00:07<00:24,  1.52s/it]
Task 0, Epoch 5/20 => Loss 0.583, Train_accy 90.11:  20%|██        | 4/20 [00:08<00:24,  1.52s/it]
Task 0, Epoch 5/20 => Loss 0.583, Train_accy 90.11:  25%|██▌       | 5/20 [00:08<00:20,  1.40s/it]
Task 0, Epoch 6/20 => Loss 0.911, Train_accy 72.53, Test_accy 88.81:  25%|██▌       | 5/20 [00:10<00:20,  1.40s/it]
Task 0, Epoch 6/20 => Loss 0.911, Train_accy 72.53, Test_accy 88.81:  30%|███       | 6/20 [00:10<00:24,  1.77s/it]
Task 0, Epoch 7/20 => Loss 0.483, Train_accy 84.62:  30%|███       | 6/20 [00:12<00:24,  1.77s/it]                 
Task 0, Epoch 7/20 => Loss 0.483, Train_accy 84.62:  35%|███▌      | 7/20 [00:12<00:20,  1.58s/it]
Task 0, Epoch 8/20 => Loss 0.291, Train_accy 90.11:  35%|███▌      | 7/20 [00:13<00:20,  1.58s/it]
Task 0, Epoch 8/20 => Loss 0.291, Train_accy 90.11:  40%|████      | 8/20 [00:13<00:17,  1.45s/it]
Task 0, Epoch 9/20 => Loss 0.367, Train_accy 87.91:  40%|████      | 8/20 [00:14<00:17,  1.45s/it]
Task 0, Epoch 9/20 => Loss 0.367, Train_accy 87.91:  45%|████▌     | 9/20 [00:14<00:14,  1.35s/it]
Task 0, Epoch 10/20 => Loss 0.316, Train_accy 91.21:  45%|████▌     | 9/20 [00:15<00:14,  1.35s/it]
Task 0, Epoch 10/20 => Loss 0.316, Train_accy 91.21:  50%|█████     | 10/20 [00:15<00:12,  1.27s/it]
Task 0, Epoch 11/20 => Loss 0.310, Train_accy 92.31, Test_accy 92.66:  50%|█████     | 10/20 [00:18<00:12,  1.27s/it]
Task 0, Epoch 11/20 => Loss 0.310, Train_accy 92.31, Test_accy 92.66:  55%|█████▌    | 11/20 [00:18<00:15,  1.75s/it]
Task 0, Epoch 12/20 => Loss 0.239, Train_accy 93.41:  55%|█████▌    | 11/20 [00:19<00:15,  1.75s/it]                 
Task 0, Epoch 12/20 => Loss 0.239, Train_accy 93.41:  60%|██████    | 12/20 [00:19<00:12,  1.55s/it]
Task 0, Epoch 13/20 => Loss 0.184, Train_accy 92.31:  60%|██████    | 12/20 [00:20<00:12,  1.55s/it]
Task 0, Epoch 13/20 => Loss 0.184, Train_accy 92.31:  65%|██████▌   | 13/20 [00:20<00:09,  1.41s/it]
Task 0, Epoch 14/20 => Loss 0.108, Train_accy 95.60:  65%|██████▌   | 13/20 [00:21<00:09,  1.41s/it]
Task 0, Epoch 14/20 => Loss 0.108, Train_accy 95.60:  70%|███████   | 14/20 [00:21<00:07,  1.33s/it]
Task 0, Epoch 15/20 => Loss 0.080, Train_accy 94.51:  70%|███████   | 14/20 [00:22<00:07,  1.33s/it]
Task 0, Epoch 15/20 => Loss 0.080, Train_accy 94.51:  75%|███████▌  | 15/20 [00:22<00:06,  1.26s/it]
Task 0, Epoch 16/20 => Loss 0.067, Train_accy 97.80, Test_accy 91.96:  75%|███████▌  | 15/20 [00:25<00:06,  1.26s/it]
Task 0, Epoch 16/20 => Loss 0.067, Train_accy 97.80, Test_accy 91.96:  80%|████████  | 16/20 [00:25<00:06,  1.66s/it]
Task 0, Epoch 17/20 => Loss 0.050, Train_accy 98.90:  80%|████████  | 16/20 [00:26<00:06,  1.66s/it]                 
Task 0, Epoch 17/20 => Loss 0.050, Train_accy 98.90:  85%|████████▌ | 17/20 [00:26<00:04,  1.49s/it]
Task 0, Epoch 18/20 => Loss 0.155, Train_accy 95.60:  85%|████████▌ | 17/20 [00:27<00:04,  1.49s/it]
Task 0, Epoch 18/20 => Loss 0.155, Train_accy 95.60:  90%|█████████ | 18/20 [00:27<00:02,  1.37s/it]
Task 0, Epoch 19/20 => Loss 0.087, Train_accy 94.51:  90%|█████████ | 18/20 [00:28<00:02,  1.37s/it]
Task 0, Epoch 19/20 => Loss 0.087, Train_accy 94.51:  95%|█████████▌| 19/20 [00:28<00:01,  1.28s/it]
Task 0, Epoch 20/20 => Loss 0.141, Train_accy 94.51:  95%|█████████▌| 19/20 [00:29<00:01,  1.28s/it]
Task 0, Epoch 20/20 => Loss 0.141, Train_accy 94.51: 100%|██████████| 20/20 [00:29<00:00,  1.21s/it]
Task 0, Epoch 20/20 => Loss 0.141, Train_accy 94.51: 100%|██████████| 20/20 [00:29<00:00,  1.49s/it]2024-09-14 12:33:13,529 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.141, Train_accy 94.51

2024-09-14 12:33:14,956 [trainer.py] => No NME accuracy.
2024-09-14 12:33:14,956 [trainer.py] => CNN: {'total': 91.26, '00-04': 91.26, 'old': 0, 'new': 91.26}
2024-09-14 12:33:14,956 [trainer.py] => CNN top1 curve: [91.26]
2024-09-14 12:33:14,956 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 91.26
2024-09-14 12:33:14,957 [trainer.py] => Average Accuracy (CNN): 91.26 

2024-09-14 12:33:14,958 [trainer.py] => All params: 85802501
2024-09-14 12:33:14,958 [trainer.py] => Trainable params: 85802501
2024-09-14 12:33:14,959 [finetune.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.674, Train_accy 1.43, Test_accy 31.48:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.674, Train_accy 1.43, Test_accy 31.48:   5%|▌         | 1/20 [00:04<01:22,  4.32s/it]
Task 1, Epoch 2/20 => Loss 1.061, Train_accy 0.00:   5%|▌         | 1/20 [00:05<01:22,  4.32s/it]                 
Task 1, Epoch 2/20 => Loss 1.061, Train_accy 0.00:  10%|█         | 2/20 [00:05<00:41,  2.33s/it]
Task 1, Epoch 3/20 => Loss 0.421, Train_accy 8.57:  10%|█         | 2/20 [00:06<00:41,  2.33s/it]
Task 1, Epoch 3/20 => Loss 0.421, Train_accy 8.57:  15%|█▌        | 3/20 [00:06<00:28,  1.70s/it]
Task 1, Epoch 4/20 => Loss 0.350, Train_accy 21.43:  15%|█▌        | 3/20 [00:07<00:28,  1.70s/it]
Task 1, Epoch 4/20 => Loss 0.350, Train_accy 21.43:  20%|██        | 4/20 [00:07<00:22,  1.40s/it]
Task 1, Epoch 5/20 => Loss 0.407, Train_accy 24.29:  20%|██        | 4/20 [00:08<00:22,  1.40s/it]
Task 1, Epoch 5/20 => Loss 0.407, Train_accy 24.29:  25%|██▌       | 5/20 [00:08<00:18,  1.23s/it]
Task 1, Epoch 6/20 => Loss 0.373, Train_accy 22.86, Test_accy 58.60:  25%|██▌       | 5/20 [00:11<00:18,  1.23s/it]
Task 1, Epoch 6/20 => Loss 0.373, Train_accy 22.86, Test_accy 58.60:  30%|███       | 6/20 [00:11<00:29,  2.09s/it]
Task 1, Epoch 7/20 => Loss 0.452, Train_accy 24.29:  30%|███       | 6/20 [00:12<00:29,  2.09s/it]                 
Task 1, Epoch 7/20 => Loss 0.452, Train_accy 24.29:  35%|███▌      | 7/20 [00:12<00:22,  1.72s/it]
Task 1, Epoch 8/20 => Loss 0.182, Train_accy 38.57:  35%|███▌      | 7/20 [00:13<00:22,  1.72s/it]
Task 1, Epoch 8/20 => Loss 0.182, Train_accy 38.57:  40%|████      | 8/20 [00:13<00:17,  1.47s/it]
Task 1, Epoch 9/20 => Loss 0.186, Train_accy 35.71:  40%|████      | 8/20 [00:14<00:17,  1.47s/it]
Task 1, Epoch 9/20 => Loss 0.186, Train_accy 35.71:  45%|████▌     | 9/20 [00:14<00:14,  1.31s/it]
Task 1, Epoch 10/20 => Loss 0.086, Train_accy 44.29:  45%|████▌     | 9/20 [00:15<00:14,  1.31s/it]
Task 1, Epoch 10/20 => Loss 0.086, Train_accy 44.29:  50%|█████     | 10/20 [00:15<00:11,  1.19s/it]
Task 1, Epoch 11/20 => Loss 0.346, Train_accy 54.29, Test_accy 74.46:  50%|█████     | 10/20 [00:19<00:11,  1.19s/it]
Task 1, Epoch 11/20 => Loss 0.346, Train_accy 54.29, Test_accy 74.46:  55%|█████▌    | 11/20 [00:19<00:18,  2.00s/it]
Task 1, Epoch 12/20 => Loss 0.066, Train_accy 58.57:  55%|█████▌    | 11/20 [00:20<00:18,  2.00s/it]                 
Task 1, Epoch 12/20 => Loss 0.066, Train_accy 58.57:  60%|██████    | 12/20 [00:20<00:13,  1.70s/it]
Task 1, Epoch 13/20 => Loss 0.310, Train_accy 47.14:  60%|██████    | 12/20 [00:21<00:13,  1.70s/it]
Task 1, Epoch 13/20 => Loss 0.310, Train_accy 47.14:  65%|██████▌   | 13/20 [00:21<00:10,  1.48s/it]
Task 1, Epoch 14/20 => Loss 0.055, Train_accy 52.86:  65%|██████▌   | 13/20 [00:22<00:10,  1.48s/it]
Task 1, Epoch 14/20 => Loss 0.055, Train_accy 52.86:  70%|███████   | 14/20 [00:22<00:08,  1.34s/it]
Task 1, Epoch 15/20 => Loss 0.143, Train_accy 54.29:  70%|███████   | 14/20 [00:23<00:08,  1.34s/it]
Task 1, Epoch 15/20 => Loss 0.143, Train_accy 54.29:  75%|███████▌  | 15/20 [00:23<00:06,  1.23s/it]
Task 1, Epoch 16/20 => Loss 0.037, Train_accy 60.00, Test_accy 76.51:  75%|███████▌  | 15/20 [00:27<00:06,  1.23s/it]
Task 1, Epoch 16/20 => Loss 0.037, Train_accy 60.00, Test_accy 76.51:  80%|████████  | 16/20 [00:27<00:08,  2.04s/it]
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 64.29:  80%|████████  | 16/20 [00:28<00:08,  2.04s/it]                 
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 64.29:  85%|████████▌ | 17/20 [00:28<00:05,  1.75s/it]
Task 1, Epoch 18/20 => Loss 0.081, Train_accy 62.86:  85%|████████▌ | 17/20 [00:29<00:05,  1.75s/it]
Task 1, Epoch 18/20 => Loss 0.081, Train_accy 62.86:  90%|█████████ | 18/20 [00:29<00:03,  1.53s/it]
Task 1, Epoch 19/20 => Loss 0.012, Train_accy 61.43:  90%|█████████ | 18/20 [00:30<00:03,  1.53s/it]
Task 1, Epoch 19/20 => Loss 0.012, Train_accy 61.43:  95%|█████████▌| 19/20 [00:30<00:01,  1.38s/it]
Task 1, Epoch 20/20 => Loss 0.017, Train_accy 70.00:  95%|█████████▌| 19/20 [00:31<00:01,  1.38s/it]
Task 1, Epoch 20/20 => Loss 0.017, Train_accy 70.00: 100%|██████████| 20/20 [00:31<00:00,  1.25s/it]
Task 1, Epoch 20/20 => Loss 0.017, Train_accy 70.00: 100%|██████████| 20/20 [00:31<00:00,  1.57s/it]2024-09-14 12:33:46,369 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.017, Train_accy 70.00

2024-09-14 12:33:49,494 [trainer.py] => No NME accuracy.
2024-09-14 12:33:49,494 [trainer.py] => CNN: {'total': 73.49, '00-04': 85.66, '05-09': 67.04, 'old': 85.66, 'new': 67.04}
2024-09-14 12:33:49,494 [trainer.py] => CNN top1 curve: [91.26, 73.49]
2024-09-14 12:33:49,494 [trainer.py] => CNN top5 curve: [100.0, 97.46]

Average Accuracy (CNN): 82.38
2024-09-14 12:33:49,494 [trainer.py] => Average Accuracy (CNN): 82.38 

2024-09-14 12:33:49,495 [trainer.py] => All params: 85806346
2024-09-14 12:33:49,496 [trainer.py] => Trainable params: 85806346
2024-09-14 12:33:49,498 [finetune.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.272, Train_accy 3.62, Test_accy 44.99:   0%|          | 0/20 [00:06<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.272, Train_accy 3.62, Test_accy 44.99:   5%|▌         | 1/20 [00:06<02:01,  6.38s/it]
Task 2, Epoch 2/20 => Loss 0.408, Train_accy 11.59:   5%|▌         | 1/20 [00:07<02:01,  6.38s/it]                
Task 2, Epoch 2/20 => Loss 0.408, Train_accy 11.59:  10%|█         | 2/20 [00:07<01:02,  3.46s/it]
Task 2, Epoch 3/20 => Loss 0.065, Train_accy 49.28:  10%|█         | 2/20 [00:09<01:02,  3.46s/it]
Task 2, Epoch 3/20 => Loss 0.065, Train_accy 49.28:  15%|█▌        | 3/20 [00:09<00:44,  2.60s/it]
Task 2, Epoch 4/20 => Loss 0.018, Train_accy 76.81:  15%|█▌        | 3/20 [00:10<00:44,  2.60s/it]
Task 2, Epoch 4/20 => Loss 0.018, Train_accy 76.81:  20%|██        | 4/20 [00:10<00:34,  2.14s/it]
Task 2, Epoch 5/20 => Loss 0.035, Train_accy 79.71:  20%|██        | 4/20 [00:12<00:34,  2.14s/it]
Task 2, Epoch 5/20 => Loss 0.035, Train_accy 79.71:  25%|██▌       | 5/20 [00:12<00:28,  1.88s/it]
Task 2, Epoch 6/20 => Loss 0.005, Train_accy 85.51, Test_accy 71.07:  25%|██▌       | 5/20 [00:18<00:28,  1.88s/it]
Task 2, Epoch 6/20 => Loss 0.005, Train_accy 85.51, Test_accy 71.07:  30%|███       | 6/20 [00:18<00:47,  3.39s/it]
Task 2, Epoch 7/20 => Loss 0.022, Train_accy 89.13:  30%|███       | 6/20 [00:19<00:47,  3.39s/it]                 
Task 2, Epoch 7/20 => Loss 0.022, Train_accy 89.13:  35%|███▌      | 7/20 [00:19<00:35,  2.75s/it]
Task 2, Epoch 8/20 => Loss 0.008, Train_accy 89.86:  35%|███▌      | 7/20 [00:21<00:35,  2.75s/it]
Task 2, Epoch 8/20 => Loss 0.008, Train_accy 89.86:  40%|████      | 8/20 [00:21<00:27,  2.33s/it]
Task 2, Epoch 9/20 => Loss 0.094, Train_accy 88.41:  40%|████      | 8/20 [00:22<00:27,  2.33s/it]
Task 2, Epoch 9/20 => Loss 0.094, Train_accy 88.41:  45%|████▌     | 9/20 [00:22<00:22,  2.05s/it]
Task 2, Epoch 10/20 => Loss 0.171, Train_accy 86.96:  45%|████▌     | 9/20 [00:24<00:22,  2.05s/it]
Task 2, Epoch 10/20 => Loss 0.171, Train_accy 86.96:  50%|█████     | 10/20 [00:24<00:18,  1.84s/it]
Task 2, Epoch 11/20 => Loss 0.011, Train_accy 84.78, Test_accy 70.65:  50%|█████     | 10/20 [00:30<00:18,  1.84s/it]
Task 2, Epoch 11/20 => Loss 0.011, Train_accy 84.78, Test_accy 70.65:  55%|█████▌    | 11/20 [00:30<00:28,  3.17s/it]
Task 2, Epoch 12/20 => Loss 0.003, Train_accy 81.16:  55%|█████▌    | 11/20 [00:31<00:28,  3.17s/it]                 
Task 2, Epoch 12/20 => Loss 0.003, Train_accy 81.16:  60%|██████    | 12/20 [00:31<00:21,  2.65s/it]
Task 2, Epoch 13/20 => Loss 0.007, Train_accy 80.43:  60%|██████    | 12/20 [00:33<00:21,  2.65s/it]
Task 2, Epoch 13/20 => Loss 0.007, Train_accy 80.43:  65%|██████▌   | 13/20 [00:33<00:16,  2.30s/it]
Task 2, Epoch 14/20 => Loss 0.007, Train_accy 84.78:  65%|██████▌   | 13/20 [00:34<00:16,  2.30s/it]
Task 2, Epoch 14/20 => Loss 0.007, Train_accy 84.78:  70%|███████   | 14/20 [00:34<00:12,  2.03s/it]
Task 2, Epoch 15/20 => Loss 0.001, Train_accy 85.51:  70%|███████   | 14/20 [00:36<00:12,  2.03s/it]
Task 2, Epoch 15/20 => Loss 0.001, Train_accy 85.51:  75%|███████▌  | 15/20 [00:36<00:09,  1.85s/it]
Task 2, Epoch 16/20 => Loss 0.002, Train_accy 87.68, Test_accy 67.11:  75%|███████▌  | 15/20 [00:42<00:09,  1.85s/it]
Task 2, Epoch 16/20 => Loss 0.002, Train_accy 87.68, Test_accy 67.11:  80%|████████  | 16/20 [00:42<00:12,  3.16s/it]
Task 2, Epoch 17/20 => Loss 0.100, Train_accy 84.06:  80%|████████  | 16/20 [00:43<00:12,  3.16s/it]                 
Task 2, Epoch 17/20 => Loss 0.100, Train_accy 84.06:  85%|████████▌ | 17/20 [00:43<00:07,  2.65s/it]
Task 2, Epoch 18/20 => Loss 0.002, Train_accy 87.68:  85%|████████▌ | 17/20 [00:45<00:07,  2.65s/it]
Task 2, Epoch 18/20 => Loss 0.002, Train_accy 87.68:  90%|█████████ | 18/20 [00:45<00:04,  2.29s/it]
Task 2, Epoch 19/20 => Loss 0.015, Train_accy 88.41:  90%|█████████ | 18/20 [00:46<00:04,  2.29s/it]
Task 2, Epoch 19/20 => Loss 0.015, Train_accy 88.41:  95%|█████████▌| 19/20 [00:46<00:02,  2.03s/it]
Task 2, Epoch 20/20 => Loss 0.012, Train_accy 89.86:  95%|█████████▌| 19/20 [00:48<00:02,  2.03s/it]
Task 2, Epoch 20/20 => Loss 0.012, Train_accy 89.86: 100%|██████████| 20/20 [00:48<00:00,  1.89s/it]
Task 2, Epoch 20/20 => Loss 0.012, Train_accy 89.86: 100%|██████████| 20/20 [00:48<00:00,  2.42s/it]2024-09-14 12:34:37,817 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.012, Train_accy 89.86

2024-09-14 12:34:42,585 [trainer.py] => No NME accuracy.
2024-09-14 12:34:42,585 [trainer.py] => CNN: {'total': 61.82, '00-04': 62.24, '05-09': 29.07, '10-14': 90.52, 'old': 40.56, 'new': 90.52}
2024-09-14 12:34:42,585 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82]
2024-09-14 12:34:42,585 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3]

Average Accuracy (CNN): 75.52
2024-09-14 12:34:42,586 [trainer.py] => Average Accuracy (CNN): 75.52 

2024-09-14 12:34:42,587 [trainer.py] => All params: 85810191
2024-09-14 12:34:42,587 [trainer.py] => Trainable params: 85810191
2024-09-14 12:34:42,588 [finetune.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.574, Train_accy 9.78, Test_accy 49.84:   0%|          | 0/20 [00:11<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.574, Train_accy 9.78, Test_accy 49.84:   5%|▌         | 1/20 [00:11<03:37, 11.45s/it]
Task 3, Epoch 2/20 => Loss 1.747, Train_accy 34.78:   5%|▌         | 1/20 [00:13<03:37, 11.45s/it]                
Task 3, Epoch 2/20 => Loss 1.747, Train_accy 34.78:  10%|█         | 2/20 [00:13<01:49,  6.10s/it]
Task 3, Epoch 3/20 => Loss 0.997, Train_accy 44.93:  10%|█         | 2/20 [00:16<01:49,  6.10s/it]
Task 3, Epoch 3/20 => Loss 0.997, Train_accy 44.93:  15%|█▌        | 3/20 [00:16<01:14,  4.41s/it]
Task 3, Epoch 4/20 => Loss 0.526, Train_accy 69.57:  15%|█▌        | 3/20 [00:18<01:14,  4.41s/it]
Task 3, Epoch 4/20 => Loss 0.526, Train_accy 69.57:  20%|██        | 4/20 [00:18<00:57,  3.60s/it]
Task 3, Epoch 5/20 => Loss 0.408, Train_accy 77.17:  20%|██        | 4/20 [00:20<00:57,  3.60s/it]
Task 3, Epoch 5/20 => Loss 0.408, Train_accy 77.17:  25%|██▌       | 5/20 [00:20<00:47,  3.18s/it]
Task 3, Epoch 6/20 => Loss 0.378, Train_accy 77.90, Test_accy 63.68:  25%|██▌       | 5/20 [00:32<00:47,  3.18s/it]
Task 3, Epoch 6/20 => Loss 0.378, Train_accy 77.90, Test_accy 63.68:  30%|███       | 6/20 [00:32<01:23,  5.98s/it]
Task 3, Epoch 7/20 => Loss 0.232, Train_accy 88.77:  30%|███       | 6/20 [00:34<01:23,  5.98s/it]                 
Task 3, Epoch 7/20 => Loss 0.232, Train_accy 88.77:  35%|███▌      | 7/20 [00:34<01:02,  4.80s/it]
Task 3, Epoch 8/20 => Loss 0.212, Train_accy 90.22:  35%|███▌      | 7/20 [00:37<01:02,  4.80s/it]
Task 3, Epoch 8/20 => Loss 0.212, Train_accy 90.22:  40%|████      | 8/20 [00:37<00:47,  3.98s/it]
Task 3, Epoch 9/20 => Loss 0.159, Train_accy 92.39:  40%|████      | 8/20 [00:39<00:47,  3.98s/it]
Task 3, Epoch 9/20 => Loss 0.159, Train_accy 92.39:  45%|████▌     | 9/20 [00:39<00:37,  3.44s/it]
Task 3, Epoch 10/20 => Loss 0.165, Train_accy 90.58:  45%|████▌     | 9/20 [00:41<00:37,  3.44s/it]
Task 3, Epoch 10/20 => Loss 0.165, Train_accy 90.58:  50%|█████     | 10/20 [00:41<00:30,  3.07s/it]
Task 3, Epoch 11/20 => Loss 0.129, Train_accy 92.75, Test_accy 67.93:  50%|█████     | 10/20 [00:52<00:30,  3.07s/it]
Task 3, Epoch 11/20 => Loss 0.129, Train_accy 92.75, Test_accy 67.93:  55%|█████▌    | 11/20 [00:52<00:48,  5.38s/it]
Task 3, Epoch 12/20 => Loss 0.100, Train_accy 96.01:  55%|█████▌    | 11/20 [00:54<00:48,  5.38s/it]                 
Task 3, Epoch 12/20 => Loss 0.100, Train_accy 96.01:  60%|██████    | 12/20 [00:54<00:35,  4.43s/it]
Task 3, Epoch 13/20 => Loss 0.093, Train_accy 96.01:  60%|██████    | 12/20 [00:56<00:35,  4.43s/it]
Task 3, Epoch 13/20 => Loss 0.093, Train_accy 96.01:  65%|██████▌   | 13/20 [00:56<00:26,  3.78s/it]
Task 3, Epoch 14/20 => Loss 0.126, Train_accy 94.57:  65%|██████▌   | 13/20 [00:58<00:26,  3.78s/it]
Task 3, Epoch 14/20 => Loss 0.126, Train_accy 94.57:  70%|███████   | 14/20 [00:58<00:19,  3.31s/it]
Task 3, Epoch 15/20 => Loss 0.160, Train_accy 91.67:  70%|███████   | 14/20 [01:01<00:19,  3.31s/it]
Task 3, Epoch 15/20 => Loss 0.160, Train_accy 91.67:  75%|███████▌  | 15/20 [01:01<00:14,  3.00s/it]
Task 3, Epoch 16/20 => Loss 0.172, Train_accy 91.30, Test_accy 66.46:  75%|███████▌  | 15/20 [01:12<00:14,  3.00s/it]
Task 3, Epoch 16/20 => Loss 0.172, Train_accy 91.30, Test_accy 66.46:  80%|████████  | 16/20 [01:12<00:21,  5.40s/it]
Task 3, Epoch 17/20 => Loss 0.159, Train_accy 92.75:  80%|████████  | 16/20 [01:14<00:21,  5.40s/it]                 
Task 3, Epoch 17/20 => Loss 0.159, Train_accy 92.75:  85%|████████▌ | 17/20 [01:14<00:13,  4.53s/it]
Task 3, Epoch 18/20 => Loss 0.289, Train_accy 87.32:  85%|████████▌ | 17/20 [01:17<00:13,  4.53s/it]
Task 3, Epoch 18/20 => Loss 0.289, Train_accy 87.32:  90%|█████████ | 18/20 [01:17<00:07,  3.90s/it]
Task 3, Epoch 19/20 => Loss 0.169, Train_accy 91.67:  90%|█████████ | 18/20 [01:19<00:07,  3.90s/it]
Task 3, Epoch 19/20 => Loss 0.169, Train_accy 91.67:  95%|█████████▌| 19/20 [01:19<00:03,  3.47s/it]
Task 3, Epoch 20/20 => Loss 0.111, Train_accy 94.93:  95%|█████████▌| 19/20 [01:22<00:03,  3.47s/it]
Task 3, Epoch 20/20 => Loss 0.111, Train_accy 94.93: 100%|██████████| 20/20 [01:22<00:00,  3.17s/it]
Task 3, Epoch 20/20 => Loss 0.111, Train_accy 94.93: 100%|██████████| 20/20 [01:22<00:00,  4.10s/it]2024-09-14 12:36:04,601 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.111, Train_accy 94.93

2024-09-14 12:36:12,915 [trainer.py] => No NME accuracy.
2024-09-14 12:36:12,916 [trainer.py] => CNN: {'total': 68.49, '00-04': 74.48, '05-09': 35.37, '10-14': 30.88, '15-19': 96.31, 'old': 41.24, 'new': 96.31}
2024-09-14 12:36:12,916 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82, 68.49]
2024-09-14 12:36:12,916 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3, 90.41]

Average Accuracy (CNN): 73.76
2024-09-14 12:36:12,916 [trainer.py] => Average Accuracy (CNN): 73.76 

2024-09-14 12:36:12,917 [trainer.py] => All params: 85814036
2024-09-14 12:36:12,918 [trainer.py] => Trainable params: 85814036
2024-09-14 12:36:12,920 [finetune.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.304, Train_accy 7.60, Test_accy 57.92:   0%|          | 0/20 [00:14<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.304, Train_accy 7.60, Test_accy 57.92:   5%|▌         | 1/20 [00:14<04:26, 14.02s/it]
Task 4, Epoch 2/20 => Loss 0.464, Train_accy 24.80:   5%|▌         | 1/20 [00:16<04:26, 14.02s/it]                
Task 4, Epoch 2/20 => Loss 0.464, Train_accy 24.80:  10%|█         | 2/20 [00:16<02:06,  7.00s/it]
Task 4, Epoch 3/20 => Loss 0.335, Train_accy 42.40:  10%|█         | 2/20 [00:18<02:06,  7.00s/it]
Task 4, Epoch 3/20 => Loss 0.335, Train_accy 42.40:  15%|█▌        | 3/20 [00:18<01:20,  4.76s/it]
Task 4, Epoch 4/20 => Loss 0.325, Train_accy 59.60:  15%|█▌        | 3/20 [00:20<01:20,  4.76s/it]
Task 4, Epoch 4/20 => Loss 0.325, Train_accy 59.60:  20%|██        | 4/20 [00:20<00:59,  3.71s/it]
Task 4, Epoch 5/20 => Loss 0.148, Train_accy 57.20:  20%|██        | 4/20 [00:22<00:59,  3.71s/it]
Task 4, Epoch 5/20 => Loss 0.148, Train_accy 57.20:  25%|██▌       | 5/20 [00:22<00:47,  3.14s/it]
Task 4, Epoch 6/20 => Loss 0.180, Train_accy 67.60, Test_accy 61.29:  25%|██▌       | 5/20 [00:37<00:47,  3.14s/it]
Task 4, Epoch 6/20 => Loss 0.180, Train_accy 67.60, Test_accy 61.29:  30%|███       | 6/20 [00:37<01:38,  7.04s/it]
Task 4, Epoch 7/20 => Loss 0.235, Train_accy 73.20:  30%|███       | 6/20 [00:39<01:38,  7.04s/it]                 
Task 4, Epoch 7/20 => Loss 0.235, Train_accy 73.20:  35%|███▌      | 7/20 [00:39<01:11,  5.47s/it]
Task 4, Epoch 8/20 => Loss 0.136, Train_accy 74.80:  35%|███▌      | 7/20 [00:41<01:11,  5.47s/it]
Task 4, Epoch 8/20 => Loss 0.136, Train_accy 74.80:  40%|████      | 8/20 [00:41<00:53,  4.46s/it]
Task 4, Epoch 9/20 => Loss 0.074, Train_accy 78.80:  40%|████      | 8/20 [00:43<00:53,  4.46s/it]
Task 4, Epoch 9/20 => Loss 0.074, Train_accy 78.80:  45%|████▌     | 9/20 [00:43<00:41,  3.77s/it]
Task 4, Epoch 10/20 => Loss 0.130, Train_accy 84.80:  45%|████▌     | 9/20 [00:46<00:41,  3.77s/it]
Task 4, Epoch 10/20 => Loss 0.130, Train_accy 84.80:  50%|█████     | 10/20 [00:46<00:33,  3.31s/it]
Task 4, Epoch 11/20 => Loss 0.050, Train_accy 89.60, Test_accy 64.92:  50%|█████     | 10/20 [01:00<00:33,  3.31s/it]
Task 4, Epoch 11/20 => Loss 0.050, Train_accy 89.60, Test_accy 64.92:  55%|█████▌    | 11/20 [01:00<01:01,  6.82s/it]
Task 4, Epoch 12/20 => Loss 0.058, Train_accy 91.60:  55%|█████▌    | 11/20 [01:03<01:01,  6.82s/it]                 
Task 4, Epoch 12/20 => Loss 0.058, Train_accy 91.60:  60%|██████    | 12/20 [01:03<00:43,  5.41s/it]
Task 4, Epoch 13/20 => Loss 0.043, Train_accy 90.40:  60%|██████    | 12/20 [01:05<00:43,  5.41s/it]
Task 4, Epoch 13/20 => Loss 0.043, Train_accy 90.40:  65%|██████▌   | 13/20 [01:05<00:31,  4.46s/it]
Task 4, Epoch 14/20 => Loss 0.121, Train_accy 89.60:  65%|██████▌   | 13/20 [01:07<00:31,  4.46s/it]
Task 4, Epoch 14/20 => Loss 0.121, Train_accy 89.60:  70%|███████   | 14/20 [01:07<00:22,  3.78s/it]
Task 4, Epoch 15/20 => Loss 0.061, Train_accy 95.60:  70%|███████   | 14/20 [01:09<00:22,  3.78s/it]
Task 4, Epoch 15/20 => Loss 0.061, Train_accy 95.60:  75%|███████▌  | 15/20 [01:09<00:16,  3.32s/it]
Task 4, Epoch 16/20 => Loss 0.099, Train_accy 92.40, Test_accy 60.46:  75%|███████▌  | 15/20 [01:24<00:16,  3.32s/it]
Task 4, Epoch 16/20 => Loss 0.099, Train_accy 92.40, Test_accy 60.46:  80%|████████  | 16/20 [01:24<00:27,  6.78s/it]
Task 4, Epoch 17/20 => Loss 0.147, Train_accy 92.00:  80%|████████  | 16/20 [01:26<00:27,  6.78s/it]                 
Task 4, Epoch 17/20 => Loss 0.147, Train_accy 92.00:  85%|████████▌ | 17/20 [01:26<00:16,  5.43s/it]
Task 4, Epoch 18/20 => Loss 0.114, Train_accy 93.20:  85%|████████▌ | 17/20 [01:29<00:16,  5.43s/it]
Task 4, Epoch 18/20 => Loss 0.114, Train_accy 93.20:  90%|█████████ | 18/20 [01:29<00:08,  4.48s/it]
Task 4, Epoch 19/20 => Loss 0.131, Train_accy 87.60:  90%|█████████ | 18/20 [01:31<00:08,  4.48s/it]
Task 4, Epoch 19/20 => Loss 0.131, Train_accy 87.60:  95%|█████████▌| 19/20 [01:31<00:03,  3.82s/it]
Task 4, Epoch 20/20 => Loss 0.071, Train_accy 88.80:  95%|█████████▌| 19/20 [01:33<00:03,  3.82s/it]
Task 4, Epoch 20/20 => Loss 0.071, Train_accy 88.80: 100%|██████████| 20/20 [01:33<00:00,  3.35s/it]
Task 4, Epoch 20/20 => Loss 0.071, Train_accy 88.80: 100%|██████████| 20/20 [01:33<00:00,  4.69s/it]2024-09-14 12:37:46,639 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.071, Train_accy 88.80

2024-09-14 12:37:59,111 [trainer.py] => No NME accuracy.
2024-09-14 12:37:59,111 [trainer.py] => CNN: {'total': 63.77, '00-04': 47.2, '05-09': 20.19, '10-14': 26.8, '15-19': 79.49, '20-24': 86.69, 'old': 53.67, 'new': 86.69}
2024-09-14 12:37:59,111 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82, 68.49, 63.77]
2024-09-14 12:37:59,111 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3, 90.41, 95.15]

Average Accuracy (CNN): 71.77
2024-09-14 12:37:59,111 [trainer.py] => Average Accuracy (CNN): 71.77 

2024-09-14 12:37:59,112 [trainer.py] => All params: 85817881
2024-09-14 12:37:59,113 [trainer.py] => Trainable params: 85817881
2024-09-14 12:37:59,114 [finetune.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.799, Train_accy 0.00, Test_accy 56.74:   0%|          | 0/20 [00:15<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.799, Train_accy 0.00, Test_accy 56.74:   5%|▌         | 1/20 [00:15<04:50, 15.30s/it]
Task 5, Epoch 2/20 => Loss 1.046, Train_accy 0.00:   5%|▌         | 1/20 [00:16<04:50, 15.30s/it]                 
Task 5, Epoch 2/20 => Loss 1.046, Train_accy 0.00:  10%|█         | 2/20 [00:16<02:07,  7.07s/it]
Task 5, Epoch 3/20 => Loss 0.284, Train_accy 5.22:  10%|█         | 2/20 [00:17<02:07,  7.07s/it]
Task 5, Epoch 3/20 => Loss 0.284, Train_accy 5.22:  15%|█▌        | 3/20 [00:17<01:15,  4.44s/it]
Task 5, Epoch 4/20 => Loss 0.263, Train_accy 17.39:  15%|█▌        | 3/20 [00:19<01:15,  4.44s/it]
Task 5, Epoch 4/20 => Loss 0.263, Train_accy 17.39:  20%|██        | 4/20 [00:19<00:51,  3.20s/it]
Task 5, Epoch 5/20 => Loss 0.054, Train_accy 25.22:  20%|██        | 4/20 [00:20<00:51,  3.20s/it]
Task 5, Epoch 5/20 => Loss 0.054, Train_accy 25.22:  25%|██▌       | 5/20 [00:20<00:38,  2.54s/it]
Task 5, Epoch 6/20 => Loss 0.069, Train_accy 28.70, Test_accy 57.57:  25%|██▌       | 5/20 [00:34<00:38,  2.54s/it]
Task 5, Epoch 6/20 => Loss 0.069, Train_accy 28.70, Test_accy 57.57:  30%|███       | 6/20 [00:34<01:32,  6.57s/it]
Task 5, Epoch 7/20 => Loss 0.034, Train_accy 41.74:  30%|███       | 6/20 [00:36<01:32,  6.57s/it]                 
Task 5, Epoch 7/20 => Loss 0.034, Train_accy 41.74:  35%|███▌      | 7/20 [00:36<01:03,  4.85s/it]
Task 5, Epoch 8/20 => Loss 0.109, Train_accy 49.57:  35%|███▌      | 7/20 [00:37<01:03,  4.85s/it]
Task 5, Epoch 8/20 => Loss 0.109, Train_accy 49.57:  40%|████      | 8/20 [00:37<00:44,  3.69s/it]
Task 5, Epoch 9/20 => Loss 0.049, Train_accy 57.39:  40%|████      | 8/20 [00:38<00:44,  3.69s/it]
Task 5, Epoch 9/20 => Loss 0.049, Train_accy 57.39:  45%|████▌     | 9/20 [00:38<00:32,  2.94s/it]
Task 5, Epoch 10/20 => Loss 0.071, Train_accy 62.61:  45%|████▌     | 9/20 [00:39<00:32,  2.94s/it]
Task 5, Epoch 10/20 => Loss 0.071, Train_accy 62.61:  50%|█████     | 10/20 [00:39<00:24,  2.40s/it]
Task 5, Epoch 11/20 => Loss 0.025, Train_accy 70.43, Test_accy 58.55:  50%|█████     | 10/20 [00:54<00:24,  2.40s/it]
Task 5, Epoch 11/20 => Loss 0.025, Train_accy 70.43, Test_accy 58.55:  55%|█████▌    | 11/20 [00:54<00:53,  5.98s/it]
Task 5, Epoch 12/20 => Loss 0.022, Train_accy 69.57:  55%|█████▌    | 11/20 [00:55<00:53,  5.98s/it]                 
Task 5, Epoch 12/20 => Loss 0.022, Train_accy 69.57:  60%|██████    | 12/20 [00:55<00:36,  4.56s/it]
Task 5, Epoch 13/20 => Loss 0.062, Train_accy 75.65:  60%|██████    | 12/20 [00:56<00:36,  4.56s/it]
Task 5, Epoch 13/20 => Loss 0.062, Train_accy 75.65:  65%|██████▌   | 13/20 [00:56<00:25,  3.61s/it]
Task 5, Epoch 14/20 => Loss 0.022, Train_accy 73.91:  65%|██████▌   | 13/20 [00:58<00:25,  3.61s/it]
Task 5, Epoch 14/20 => Loss 0.022, Train_accy 73.91:  70%|███████   | 14/20 [00:58<00:17,  2.91s/it]
Task 5, Epoch 15/20 => Loss 0.074, Train_accy 75.65:  70%|███████   | 14/20 [00:59<00:17,  2.91s/it]
Task 5, Epoch 15/20 => Loss 0.074, Train_accy 75.65:  75%|███████▌  | 15/20 [00:59<00:12,  2.43s/it]
Task 5, Epoch 16/20 => Loss 0.003, Train_accy 80.87, Test_accy 59.26:  75%|███████▌  | 15/20 [01:14<00:12,  2.43s/it]
Task 5, Epoch 16/20 => Loss 0.003, Train_accy 80.87, Test_accy 59.26:  80%|████████  | 16/20 [01:14<00:24,  6.25s/it]
Task 5, Epoch 17/20 => Loss 0.007, Train_accy 76.52:  80%|████████  | 16/20 [01:15<00:24,  6.25s/it]                 
Task 5, Epoch 17/20 => Loss 0.007, Train_accy 76.52:  85%|████████▌ | 17/20 [01:15<00:14,  4.79s/it]
Task 5, Epoch 18/20 => Loss 0.016, Train_accy 80.00:  85%|████████▌ | 17/20 [01:17<00:14,  4.79s/it]
Task 5, Epoch 18/20 => Loss 0.016, Train_accy 80.00:  90%|█████████ | 18/20 [01:17<00:07,  3.73s/it]
Task 5, Epoch 19/20 => Loss 0.019, Train_accy 75.65:  90%|█████████ | 18/20 [01:18<00:07,  3.73s/it]
Task 5, Epoch 19/20 => Loss 0.019, Train_accy 75.65:  95%|█████████▌| 19/20 [01:18<00:02,  2.99s/it]
Task 5, Epoch 20/20 => Loss 0.039, Train_accy 77.39:  95%|█████████▌| 19/20 [01:19<00:02,  2.99s/it]
Task 5, Epoch 20/20 => Loss 0.039, Train_accy 77.39: 100%|██████████| 20/20 [01:19<00:00,  2.53s/it]
Task 5, Epoch 20/20 => Loss 0.039, Train_accy 77.39: 100%|██████████| 20/20 [01:19<00:00,  4.00s/it]2024-09-14 12:39:19,052 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.039, Train_accy 77.39

2024-09-14 12:39:31,976 [trainer.py] => No NME accuracy.
2024-09-14 12:39:31,977 [trainer.py] => CNN: {'total': 59.55, '00-04': 68.18, '05-09': 38.52, '10-14': 26.96, '15-19': 59.97, '20-24': 82.71, '25-29': 57.41, 'old': 59.75, 'new': 57.41}
2024-09-14 12:39:31,977 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82, 68.49, 63.77, 59.55]
2024-09-14 12:39:31,977 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3, 90.41, 95.15, 94.91]

Average Accuracy (CNN): 69.73
2024-09-14 12:39:31,977 [trainer.py] => Average Accuracy (CNN): 69.73 

2024-09-14 12:39:31,978 [trainer.py] => All params: 85821726
2024-09-14 12:39:31,979 [trainer.py] => Trainable params: 85821726
2024-09-14 12:39:31,980 [finetune.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.120, Train_accy 2.30, Test_accy 53.26:   0%|          | 0/20 [00:16<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.120, Train_accy 2.30, Test_accy 53.26:   5%|▌         | 1/20 [00:16<05:18, 16.74s/it]
Task 6, Epoch 2/20 => Loss 0.255, Train_accy 35.06:   5%|▌         | 1/20 [00:18<05:18, 16.74s/it]                
Task 6, Epoch 2/20 => Loss 0.255, Train_accy 35.06:  10%|█         | 2/20 [00:18<02:21,  7.88s/it]
Task 6, Epoch 3/20 => Loss 0.085, Train_accy 51.15:  10%|█         | 2/20 [00:20<02:21,  7.88s/it]
Task 6, Epoch 3/20 => Loss 0.085, Train_accy 51.15:  15%|█▌        | 3/20 [00:20<01:26,  5.08s/it]
Task 6, Epoch 4/20 => Loss 0.082, Train_accy 79.31:  15%|█▌        | 3/20 [00:21<01:26,  5.08s/it]
Task 6, Epoch 4/20 => Loss 0.082, Train_accy 79.31:  20%|██        | 4/20 [00:21<00:59,  3.73s/it]
Task 6, Epoch 5/20 => Loss 0.013, Train_accy 94.83:  20%|██        | 4/20 [00:23<00:59,  3.73s/it]
Task 6, Epoch 5/20 => Loss 0.013, Train_accy 94.83:  25%|██▌       | 5/20 [00:23<00:44,  2.98s/it]
Task 6, Epoch 6/20 => Loss 0.023, Train_accy 91.95, Test_accy 44.79:  25%|██▌       | 5/20 [00:41<00:44,  2.98s/it]
Task 6, Epoch 6/20 => Loss 0.023, Train_accy 91.95, Test_accy 44.79:  30%|███       | 6/20 [00:41<01:51,  7.94s/it]
Task 6, Epoch 7/20 => Loss 0.007, Train_accy 94.25:  30%|███       | 6/20 [00:42<01:51,  7.94s/it]                 
Task 6, Epoch 7/20 => Loss 0.007, Train_accy 94.25:  35%|███▌      | 7/20 [00:42<01:16,  5.88s/it]
Task 6, Epoch 8/20 => Loss 0.008, Train_accy 95.40:  35%|███▌      | 7/20 [00:44<01:16,  5.88s/it]
Task 6, Epoch 8/20 => Loss 0.008, Train_accy 95.40:  40%|████      | 8/20 [00:44<00:54,  4.56s/it]
Task 6, Epoch 9/20 => Loss 0.004, Train_accy 97.13:  40%|████      | 8/20 [00:46<00:54,  4.56s/it]
Task 6, Epoch 9/20 => Loss 0.004, Train_accy 97.13:  45%|████▌     | 9/20 [00:46<00:40,  3.65s/it]
Task 6, Epoch 10/20 => Loss 0.002, Train_accy 99.43:  45%|████▌     | 9/20 [00:47<00:40,  3.65s/it]
Task 6, Epoch 10/20 => Loss 0.002, Train_accy 99.43:  50%|█████     | 10/20 [00:47<00:30,  3.03s/it]
Task 6, Epoch 11/20 => Loss 0.009, Train_accy 97.70, Test_accy 51.71:  50%|█████     | 10/20 [01:05<00:30,  3.03s/it]
Task 6, Epoch 11/20 => Loss 0.009, Train_accy 97.70, Test_accy 51.71:  55%|█████▌    | 11/20 [01:05<01:07,  7.54s/it]
Task 6, Epoch 12/20 => Loss 0.002, Train_accy 97.70:  55%|█████▌    | 11/20 [01:07<01:07,  7.54s/it]                 
Task 6, Epoch 12/20 => Loss 0.002, Train_accy 97.70:  60%|██████    | 12/20 [01:07<00:45,  5.74s/it]
Task 6, Epoch 13/20 => Loss 0.019, Train_accy 97.13:  60%|██████    | 12/20 [01:08<00:45,  5.74s/it]
Task 6, Epoch 13/20 => Loss 0.019, Train_accy 97.13:  65%|██████▌   | 13/20 [01:08<00:31,  4.52s/it]
Task 6, Epoch 14/20 => Loss 0.001, Train_accy 95.98:  65%|██████▌   | 13/20 [01:10<00:31,  4.52s/it]
Task 6, Epoch 14/20 => Loss 0.001, Train_accy 95.98:  70%|███████   | 14/20 [01:10<00:21,  3.65s/it]
Task 6, Epoch 15/20 => Loss 0.018, Train_accy 87.36:  70%|███████   | 14/20 [01:12<00:21,  3.65s/it]
Task 6, Epoch 15/20 => Loss 0.018, Train_accy 87.36:  75%|███████▌  | 15/20 [01:12<00:15,  3.04s/it]
Task 6, Epoch 16/20 => Loss 0.010, Train_accy 92.53, Test_accy 49.90:  75%|███████▌  | 15/20 [01:29<00:15,  3.04s/it]
Task 6, Epoch 16/20 => Loss 0.010, Train_accy 92.53, Test_accy 49.90:  80%|████████  | 16/20 [01:29<00:29,  7.44s/it]
Task 6, Epoch 17/20 => Loss 0.002, Train_accy 98.28:  80%|████████  | 16/20 [01:31<00:29,  7.44s/it]                 
Task 6, Epoch 17/20 => Loss 0.002, Train_accy 98.28:  85%|████████▌ | 17/20 [01:31<00:17,  5.73s/it]
Task 6, Epoch 18/20 => Loss 0.003, Train_accy 99.43:  85%|████████▌ | 17/20 [01:33<00:17,  5.73s/it]
Task 6, Epoch 18/20 => Loss 0.003, Train_accy 99.43:  90%|█████████ | 18/20 [01:33<00:09,  4.52s/it]
Task 6, Epoch 19/20 => Loss 0.025, Train_accy 97.70:  90%|█████████ | 18/20 [01:34<00:09,  4.52s/it]
Task 6, Epoch 19/20 => Loss 0.025, Train_accy 97.70:  95%|█████████▌| 19/20 [01:34<00:03,  3.68s/it]
Task 6, Epoch 20/20 => Loss 0.038, Train_accy 98.85:  95%|█████████▌| 19/20 [01:36<00:03,  3.68s/it]
Task 6, Epoch 20/20 => Loss 0.038, Train_accy 98.85: 100%|██████████| 20/20 [01:36<00:00,  3.07s/it]
Task 6, Epoch 20/20 => Loss 0.038, Train_accy 98.85: 100%|██████████| 20/20 [01:36<00:00,  4.83s/it]2024-09-14 12:41:08,556 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.038, Train_accy 98.85

2024-09-14 12:41:24,600 [trainer.py] => No NME accuracy.
2024-09-14 12:41:24,601 [trainer.py] => CNN: {'total': 49.12, '00-04': 59.79, '05-09': 9.63, '10-14': 19.77, '15-19': 32.65, '20-24': 70.6, '25-29': 31.75, '30-34': 97.29, 'old': 40.4, 'new': 97.29}
2024-09-14 12:41:24,601 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82, 68.49, 63.77, 59.55, 49.12]
2024-09-14 12:41:24,601 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3, 90.41, 95.15, 94.91, 86.15]

Average Accuracy (CNN): 66.79
2024-09-14 12:41:24,601 [trainer.py] => Average Accuracy (CNN): 66.79 

2024-09-14 12:41:24,603 [trainer.py] => All params: 85825571
2024-09-14 12:41:24,604 [trainer.py] => Trainable params: 85825571
2024-09-14 12:41:24,606 [finetune.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.154, Train_accy 0.00, Test_accy 43.56:   0%|          | 0/20 [00:17<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.154, Train_accy 0.00, Test_accy 43.56:   5%|▌         | 1/20 [00:17<05:36, 17.71s/it]
Task 7, Epoch 2/20 => Loss 0.905, Train_accy 0.00:   5%|▌         | 1/20 [00:19<05:36, 17.71s/it]                 
Task 7, Epoch 2/20 => Loss 0.905, Train_accy 0.00:  10%|█         | 2/20 [00:19<02:25,  8.08s/it]
Task 7, Epoch 3/20 => Loss 0.298, Train_accy 10.08:  10%|█         | 2/20 [00:20<02:25,  8.08s/it]
Task 7, Epoch 3/20 => Loss 0.298, Train_accy 10.08:  15%|█▌        | 3/20 [00:20<01:24,  5.00s/it]
Task 7, Epoch 4/20 => Loss 0.206, Train_accy 27.13:  15%|█▌        | 3/20 [00:21<01:24,  5.00s/it]
Task 7, Epoch 4/20 => Loss 0.206, Train_accy 27.13:  20%|██        | 4/20 [00:21<00:56,  3.55s/it]
Task 7, Epoch 5/20 => Loss 0.172, Train_accy 31.78:  20%|██        | 4/20 [00:23<00:56,  3.55s/it]
Task 7, Epoch 5/20 => Loss 0.172, Train_accy 31.78:  25%|██▌       | 5/20 [00:23<00:41,  2.74s/it]
Task 7, Epoch 6/20 => Loss 0.250, Train_accy 51.16, Test_accy 50.26:  25%|██▌       | 5/20 [00:40<00:41,  2.74s/it]
Task 7, Epoch 6/20 => Loss 0.250, Train_accy 51.16, Test_accy 50.26:  30%|███       | 6/20 [00:40<01:48,  7.78s/it]
Task 7, Epoch 7/20 => Loss 0.115, Train_accy 62.02:  30%|███       | 6/20 [00:41<01:48,  7.78s/it]                 
Task 7, Epoch 7/20 => Loss 0.115, Train_accy 62.02:  35%|███▌      | 7/20 [00:41<01:13,  5.67s/it]
Task 7, Epoch 8/20 => Loss 0.075, Train_accy 68.99:  35%|███▌      | 7/20 [00:43<01:13,  5.67s/it]
Task 7, Epoch 8/20 => Loss 0.075, Train_accy 68.99:  40%|████      | 8/20 [00:43<00:51,  4.26s/it]
Task 7, Epoch 9/20 => Loss 0.138, Train_accy 79.84:  40%|████      | 8/20 [00:44<00:51,  4.26s/it]
Task 7, Epoch 9/20 => Loss 0.138, Train_accy 79.84:  45%|████▌     | 9/20 [00:44<00:36,  3.35s/it]
Task 7, Epoch 10/20 => Loss 0.077, Train_accy 73.64:  45%|████▌     | 9/20 [00:45<00:36,  3.35s/it]
Task 7, Epoch 10/20 => Loss 0.077, Train_accy 73.64:  50%|█████     | 10/20 [00:45<00:27,  2.77s/it]
Task 7, Epoch 11/20 => Loss 0.045, Train_accy 70.54, Test_accy 49.63:  50%|█████     | 10/20 [01:03<00:27,  2.77s/it]
Task 7, Epoch 11/20 => Loss 0.045, Train_accy 70.54, Test_accy 49.63:  55%|█████▌    | 11/20 [01:03<01:06,  7.40s/it]
Task 7, Epoch 12/20 => Loss 0.109, Train_accy 82.17:  55%|█████▌    | 11/20 [01:05<01:06,  7.40s/it]                 
Task 7, Epoch 12/20 => Loss 0.109, Train_accy 82.17:  60%|██████    | 12/20 [01:05<00:44,  5.58s/it]
Task 7, Epoch 13/20 => Loss 0.036, Train_accy 81.40:  60%|██████    | 12/20 [01:06<00:44,  5.58s/it]
Task 7, Epoch 13/20 => Loss 0.036, Train_accy 81.40:  65%|██████▌   | 13/20 [01:06<00:30,  4.30s/it]
Task 7, Epoch 14/20 => Loss 0.056, Train_accy 82.95:  65%|██████▌   | 13/20 [01:07<00:30,  4.30s/it]
Task 7, Epoch 14/20 => Loss 0.056, Train_accy 82.95:  70%|███████   | 14/20 [01:07<00:20,  3.41s/it]
Task 7, Epoch 15/20 => Loss 0.065, Train_accy 87.60:  70%|███████   | 14/20 [01:09<00:20,  3.41s/it]
Task 7, Epoch 15/20 => Loss 0.065, Train_accy 87.60:  75%|███████▌  | 15/20 [01:09<00:14,  2.81s/it]
Task 7, Epoch 16/20 => Loss 0.100, Train_accy 84.50, Test_accy 49.20:  75%|███████▌  | 15/20 [01:27<00:14,  2.81s/it]
Task 7, Epoch 16/20 => Loss 0.100, Train_accy 84.50, Test_accy 49.20:  80%|████████  | 16/20 [01:27<00:29,  7.27s/it]
Task 7, Epoch 17/20 => Loss 0.023, Train_accy 84.50:  80%|████████  | 16/20 [01:28<00:29,  7.27s/it]                 
Task 7, Epoch 17/20 => Loss 0.023, Train_accy 84.50:  85%|████████▌ | 17/20 [01:28<00:16,  5.48s/it]
Task 7, Epoch 18/20 => Loss 0.041, Train_accy 82.17:  85%|████████▌ | 17/20 [01:29<00:16,  5.48s/it]
Task 7, Epoch 18/20 => Loss 0.041, Train_accy 82.17:  90%|█████████ | 18/20 [01:29<00:08,  4.27s/it]
Task 7, Epoch 19/20 => Loss 0.236, Train_accy 76.74:  90%|█████████ | 18/20 [01:31<00:08,  4.27s/it]
Task 7, Epoch 19/20 => Loss 0.236, Train_accy 76.74:  95%|█████████▌| 19/20 [01:31<00:03,  3.42s/it]
Task 7, Epoch 20/20 => Loss 0.022, Train_accy 86.05:  95%|█████████▌| 19/20 [01:32<00:03,  3.42s/it]
Task 7, Epoch 20/20 => Loss 0.022, Train_accy 86.05: 100%|██████████| 20/20 [01:32<00:00,  2.81s/it]
Task 7, Epoch 20/20 => Loss 0.022, Train_accy 86.05: 100%|██████████| 20/20 [01:32<00:00,  4.63s/it]2024-09-14 12:42:57,231 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.022, Train_accy 86.05

2024-09-14 12:43:14,795 [trainer.py] => No NME accuracy.
2024-09-14 12:43:14,796 [trainer.py] => CNN: {'total': 49.02, '00-04': 32.17, '05-09': 8.15, '10-14': 23.04, '15-19': 51.74, '20-24': 50.28, '25-29': 13.49, '30-34': 95.93, '35-39': 78.13, 'old': 46.61, 'new': 78.13}
2024-09-14 12:43:14,796 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82, 68.49, 63.77, 59.55, 49.12, 49.02]
2024-09-14 12:43:14,796 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3, 90.41, 95.15, 94.91, 86.15, 87.63]

Average Accuracy (CNN): 64.56
2024-09-14 12:43:14,797 [trainer.py] => Average Accuracy (CNN): 64.56 

2024-09-14 12:43:14,798 [trainer.py] => All params: 85829416
2024-09-14 12:43:14,800 [trainer.py] => Trainable params: 85829416
2024-09-14 12:43:14,802 [finetune.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.396, Train_accy 7.22, Test_accy 23.60:   0%|          | 0/20 [00:24<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.396, Train_accy 7.22, Test_accy 23.60:   5%|▌         | 1/20 [00:24<07:40, 24.26s/it]
Task 8, Epoch 2/20 => Loss 0.488, Train_accy 58.08:   5%|▌         | 1/20 [00:26<07:40, 24.26s/it]                
Task 8, Epoch 2/20 => Loss 0.488, Train_accy 58.08:  10%|█         | 2/20 [00:26<03:26, 11.48s/it]
Task 8, Epoch 3/20 => Loss 0.180, Train_accy 69.42:  10%|█         | 2/20 [00:29<03:26, 11.48s/it]
Task 8, Epoch 3/20 => Loss 0.180, Train_accy 69.42:  15%|█▌        | 3/20 [00:29<02:06,  7.44s/it]
Task 8, Epoch 4/20 => Loss 0.208, Train_accy 76.63:  15%|█▌        | 3/20 [00:32<02:06,  7.44s/it]
Task 8, Epoch 4/20 => Loss 0.208, Train_accy 76.63:  20%|██        | 4/20 [00:32<01:28,  5.53s/it]
Task 8, Epoch 5/20 => Loss 0.143, Train_accy 85.91:  20%|██        | 4/20 [00:34<01:28,  5.53s/it]
Task 8, Epoch 5/20 => Loss 0.143, Train_accy 85.91:  25%|██▌       | 5/20 [00:34<01:07,  4.49s/it]
Task 8, Epoch 6/20 => Loss 0.187, Train_accy 84.19, Test_accy 24.07:  25%|██▌       | 5/20 [00:59<01:07,  4.49s/it]
Task 8, Epoch 6/20 => Loss 0.187, Train_accy 84.19, Test_accy 24.07:  30%|███       | 6/20 [00:59<02:37, 11.26s/it]
Task 8, Epoch 7/20 => Loss 1.574, Train_accy 64.60:  30%|███       | 6/20 [01:01<02:37, 11.26s/it]                 
Task 8, Epoch 7/20 => Loss 1.574, Train_accy 64.60:  35%|███▌      | 7/20 [01:01<01:49,  8.43s/it]
Task 8, Epoch 8/20 => Loss 0.527, Train_accy 39.86:  35%|███▌      | 7/20 [01:04<01:49,  8.43s/it]
Task 8, Epoch 8/20 => Loss 0.527, Train_accy 39.86:  40%|████      | 8/20 [01:04<01:18,  6.57s/it]
Task 8, Epoch 9/20 => Loss 0.352, Train_accy 67.35:  40%|████      | 8/20 [01:06<01:18,  6.57s/it]
Task 8, Epoch 9/20 => Loss 0.352, Train_accy 67.35:  45%|████▌     | 9/20 [01:06<00:58,  5.32s/it]
Task 8, Epoch 10/20 => Loss 0.522, Train_accy 72.51:  45%|████▌     | 9/20 [01:09<00:58,  5.32s/it]
Task 8, Epoch 10/20 => Loss 0.522, Train_accy 72.51:  50%|█████     | 10/20 [01:09<00:44,  4.49s/it]
Task 8, Epoch 11/20 => Loss 0.662, Train_accy 76.63, Test_accy 17.38:  50%|█████     | 10/20 [01:34<00:44,  4.49s/it]
Task 8, Epoch 11/20 => Loss 0.662, Train_accy 76.63, Test_accy 17.38:  55%|█████▌    | 11/20 [01:34<01:37, 10.81s/it]
Task 8, Epoch 12/20 => Loss 0.413, Train_accy 65.64:  55%|█████▌    | 11/20 [01:37<01:37, 10.81s/it]                 
Task 8, Epoch 12/20 => Loss 0.413, Train_accy 65.64:  60%|██████    | 12/20 [01:37<01:06,  8.35s/it]
Task 8, Epoch 13/20 => Loss 0.296, Train_accy 75.26:  60%|██████    | 12/20 [01:39<01:06,  8.35s/it]
Task 8, Epoch 13/20 => Loss 0.296, Train_accy 75.26:  65%|██████▌   | 13/20 [01:39<00:45,  6.55s/it]
Task 8, Epoch 14/20 => Loss 0.313, Train_accy 78.69:  65%|██████▌   | 13/20 [01:42<00:45,  6.55s/it]
Task 8, Epoch 14/20 => Loss 0.313, Train_accy 78.69:  70%|███████   | 14/20 [01:42<00:31,  5.32s/it]
Task 8, Epoch 15/20 => Loss 0.232, Train_accy 81.10:  70%|███████   | 14/20 [01:44<00:31,  5.32s/it]
Task 8, Epoch 15/20 => Loss 0.232, Train_accy 81.10:  75%|███████▌  | 15/20 [01:44<00:22,  4.44s/it]
Task 8, Epoch 16/20 => Loss 0.223, Train_accy 71.82, Test_accy 32.41:  75%|███████▌  | 15/20 [02:08<00:22,  4.44s/it]
Task 8, Epoch 16/20 => Loss 0.223, Train_accy 71.82, Test_accy 32.41:  80%|████████  | 16/20 [02:08<00:40, 10.16s/it]
Task 8, Epoch 17/20 => Loss 0.205, Train_accy 80.76:  80%|████████  | 16/20 [02:10<00:40, 10.16s/it]                 
Task 8, Epoch 17/20 => Loss 0.205, Train_accy 80.76:  85%|████████▌ | 17/20 [02:10<00:23,  7.94s/it]
Task 8, Epoch 18/20 => Loss 0.109, Train_accy 85.91:  85%|████████▌ | 17/20 [02:13<00:23,  7.94s/it]
Task 8, Epoch 18/20 => Loss 0.109, Train_accy 85.91:  90%|█████████ | 18/20 [02:13<00:12,  6.25s/it]
Task 8, Epoch 19/20 => Loss 0.114, Train_accy 88.66:  90%|█████████ | 18/20 [02:16<00:12,  6.25s/it]
Task 8, Epoch 19/20 => Loss 0.114, Train_accy 88.66:  95%|█████████▌| 19/20 [02:16<00:05,  5.25s/it]
Task 8, Epoch 20/20 => Loss 0.067, Train_accy 90.03:  95%|█████████▌| 19/20 [02:20<00:05,  5.25s/it]
Task 8, Epoch 20/20 => Loss 0.067, Train_accy 90.03: 100%|██████████| 20/20 [02:21<00:00,  5.14s/it]
Task 8, Epoch 20/20 => Loss 0.067, Train_accy 90.03: 100%|██████████| 20/20 [02:21<00:00,  7.05s/it]2024-09-14 12:45:35,829 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.067, Train_accy 90.03

2024-09-14 12:45:58,919 [trainer.py] => No NME accuracy.
2024-09-14 12:45:58,920 [trainer.py] => CNN: {'total': 41.39, '00-04': 20.63, '05-09': 0.74, '10-14': 18.95, '15-19': 30.73, '20-24': 19.04, '25-29': 20.11, '30-34': 72.26, '35-39': 18.45, '40-44': 92.5, 'old': 27.82, 'new': 92.5}
2024-09-14 12:45:58,920 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82, 68.49, 63.77, 59.55, 49.12, 49.02, 41.39]
2024-09-14 12:45:58,920 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3, 90.41, 95.15, 94.91, 86.15, 87.63, 76.9]

Average Accuracy (CNN): 61.99
2024-09-14 12:45:58,920 [trainer.py] => Average Accuracy (CNN): 61.99 

2024-09-14 12:45:58,922 [trainer.py] => All params: 85833261
2024-09-14 12:45:58,923 [trainer.py] => Trainable params: 85833261
2024-09-14 12:45:58,926 [finetune.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.997, Train_accy 1.53, Test_accy 28.40:   0%|          | 0/20 [00:28<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.997, Train_accy 1.53, Test_accy 28.40:   5%|▌         | 1/20 [00:28<09:08, 28.86s/it]
Task 9, Epoch 2/20 => Loss 0.267, Train_accy 33.21:   5%|▌         | 1/20 [00:31<09:08, 28.86s/it]                
Task 9, Epoch 2/20 => Loss 0.267, Train_accy 33.21:  10%|█         | 2/20 [00:31<03:59, 13.29s/it]
Task 9, Epoch 3/20 => Loss 0.085, Train_accy 72.14:  10%|█         | 2/20 [00:33<03:59, 13.29s/it]
Task 9, Epoch 3/20 => Loss 0.085, Train_accy 72.14:  15%|█▌        | 3/20 [00:33<02:20,  8.28s/it]
Task 9, Epoch 4/20 => Loss 0.139, Train_accy 80.92:  15%|█▌        | 3/20 [00:35<02:20,  8.28s/it]
Task 9, Epoch 4/20 => Loss 0.139, Train_accy 80.92:  20%|██        | 4/20 [00:35<01:35,  5.96s/it]
Task 9, Epoch 5/20 => Loss 0.043, Train_accy 85.11:  20%|██        | 4/20 [00:38<01:35,  5.96s/it]
Task 9, Epoch 5/20 => Loss 0.043, Train_accy 85.11:  25%|██▌       | 5/20 [00:38<01:09,  4.63s/it]
Task 9, Epoch 6/20 => Loss 0.064, Train_accy 83.97, Test_accy 26.48:  25%|██▌       | 5/20 [01:06<01:09,  4.63s/it]
Task 9, Epoch 6/20 => Loss 0.064, Train_accy 83.97, Test_accy 26.48:  30%|███       | 6/20 [01:06<02:56, 12.59s/it]
Task 9, Epoch 7/20 => Loss 0.041, Train_accy 85.11:  30%|███       | 6/20 [01:08<02:56, 12.59s/it]                 
Task 9, Epoch 7/20 => Loss 0.041, Train_accy 85.11:  35%|███▌      | 7/20 [01:08<02:00,  9.26s/it]
Task 9, Epoch 8/20 => Loss 0.021, Train_accy 89.69:  35%|███▌      | 7/20 [01:11<02:00,  9.26s/it]
Task 9, Epoch 8/20 => Loss 0.021, Train_accy 89.69:  40%|████      | 8/20 [01:11<01:24,  7.05s/it]
Task 9, Epoch 9/20 => Loss 0.108, Train_accy 90.46:  40%|████      | 8/20 [01:13<01:24,  7.05s/it]
Task 9, Epoch 9/20 => Loss 0.108, Train_accy 90.46:  45%|████▌     | 9/20 [01:13<01:01,  5.56s/it]
Task 9, Epoch 10/20 => Loss 0.061, Train_accy 93.13:  45%|████▌     | 9/20 [01:15<01:01,  5.56s/it]
Task 9, Epoch 10/20 => Loss 0.061, Train_accy 93.13:  50%|█████     | 10/20 [01:15<00:45,  4.55s/it]
Task 9, Epoch 11/20 => Loss 0.048, Train_accy 86.64, Test_accy 33.70:  50%|█████     | 10/20 [01:43<00:45,  4.55s/it]
Task 9, Epoch 11/20 => Loss 0.048, Train_accy 86.64, Test_accy 33.70:  55%|█████▌    | 11/20 [01:43<01:45, 11.76s/it]
Task 9, Epoch 12/20 => Loss 0.034, Train_accy 89.31:  55%|█████▌    | 11/20 [01:46<01:45, 11.76s/it]                 
Task 9, Epoch 12/20 => Loss 0.034, Train_accy 89.31:  60%|██████    | 12/20 [01:46<01:11,  8.89s/it]
Task 9, Epoch 13/20 => Loss 0.055, Train_accy 93.89:  60%|██████    | 12/20 [01:48<01:11,  8.89s/it]
Task 9, Epoch 13/20 => Loss 0.055, Train_accy 93.89:  65%|██████▌   | 13/20 [01:48<00:48,  6.92s/it]
Task 9, Epoch 14/20 => Loss 0.039, Train_accy 93.51:  65%|██████▌   | 13/20 [01:50<00:48,  6.92s/it]
Task 9, Epoch 14/20 => Loss 0.039, Train_accy 93.51:  70%|███████   | 14/20 [01:50<00:33,  5.53s/it]
Task 9, Epoch 15/20 => Loss 0.075, Train_accy 95.04:  70%|███████   | 14/20 [01:53<00:33,  5.53s/it]
Task 9, Epoch 15/20 => Loss 0.075, Train_accy 95.04:  75%|███████▌  | 15/20 [01:53<00:22,  4.56s/it]
Task 9, Epoch 16/20 => Loss 0.087, Train_accy 89.69, Test_accy 32.90:  75%|███████▌  | 15/20 [02:20<00:22,  4.56s/it]
Task 9, Epoch 16/20 => Loss 0.087, Train_accy 89.69, Test_accy 32.90:  80%|████████  | 16/20 [02:20<00:46, 11.56s/it]
Task 9, Epoch 17/20 => Loss 0.081, Train_accy 86.26:  80%|████████  | 16/20 [02:23<00:46, 11.56s/it]                 
Task 9, Epoch 17/20 => Loss 0.081, Train_accy 86.26:  85%|████████▌ | 17/20 [02:23<00:26,  8.75s/it]
Task 9, Epoch 18/20 => Loss 0.030, Train_accy 88.17:  85%|████████▌ | 17/20 [02:25<00:26,  8.75s/it]
Task 9, Epoch 18/20 => Loss 0.030, Train_accy 88.17:  90%|█████████ | 18/20 [02:25<00:13,  6.79s/it]
Task 9, Epoch 19/20 => Loss 0.027, Train_accy 87.02:  90%|█████████ | 18/20 [02:27<00:13,  6.79s/it]
Task 9, Epoch 19/20 => Loss 0.027, Train_accy 87.02:  95%|█████████▌| 19/20 [02:27<00:05,  5.39s/it]
Task 9, Epoch 20/20 => Loss 0.010, Train_accy 92.75:  95%|█████████▌| 19/20 [02:29<00:05,  5.39s/it]
Task 9, Epoch 20/20 => Loss 0.010, Train_accy 92.75: 100%|██████████| 20/20 [02:29<00:00,  4.45s/it]
Task 9, Epoch 20/20 => Loss 0.010, Train_accy 92.75: 100%|██████████| 20/20 [02:29<00:00,  7.48s/it]2024-09-14 12:48:28,666 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.010, Train_accy 92.75

2024-09-14 12:48:52,016 [trainer.py] => No NME accuracy.
2024-09-14 12:48:52,016 [trainer.py] => CNN: {'total': 34.1, '00-04': 23.08, '05-09': 0.19, '10-14': 17.16, '15-19': 31.87, '20-24': 2.23, '25-29': 14.29, '30-34': 15.66, '35-39': 40.55, '40-44': 45.89, '45-49': 90.13, 'old': 23.53, 'new': 90.13}
2024-09-14 12:48:52,016 [trainer.py] => CNN top1 curve: [91.26, 73.49, 61.82, 68.49, 63.77, 59.55, 49.12, 49.02, 41.39, 34.1]
2024-09-14 12:48:52,016 [trainer.py] => CNN top5 curve: [100.0, 97.46, 94.3, 90.41, 95.15, 94.91, 86.15, 87.63, 76.9, 74.99]

Average Accuracy (CNN): 59.2
2024-09-14 12:48:52,016 [trainer.py] => Average Accuracy (CNN): 59.2 

Accuracy Matrix (CNN):
[[91.26 85.66 62.24 74.48 47.2  68.18 59.79 32.17 20.63 23.08]
 [ 0.   67.04 29.07 35.37 20.19 38.52  9.63  8.15  0.74  0.19]
 [ 0.    0.   90.52 30.88 26.8  26.96 19.77 23.04 18.95 17.16]
 [ 0.    0.    0.   96.31 79.49 59.97 32.65 51.74 30.73 31.87]
 [ 0.    0.    0.    0.   86.69 82.71 70.6  50.28 19.04  2.23]
 [ 0.    0.    0.    0.    0.   57.41 31.75 13.49 20.11 14.29]
 [ 0.    0.    0.    0.    0.    0.   97.29 95.93 72.26 15.66]
 [ 0.    0.    0.    0.    0.    0.    0.   78.13 18.45 40.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   92.5  45.89]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   90.13]]
2024-09-14 12:48:52,018 [trainer.py] => Forgetting (CNN): 62.91444444444445
2024-09-14 12:49:15,332 [trainer.py] => config: ./exps/simplecil_vtab_B0_Inc5.json
2024-09-14 12:49:15,332 [trainer.py] => prefix:  
2024-09-14 12:49:15,332 [trainer.py] => dataset: vtab
2024-09-14 12:49:15,332 [trainer.py] => memory_size: 0
2024-09-14 12:49:15,332 [trainer.py] => memory_per_class: 0
2024-09-14 12:49:15,332 [trainer.py] => fixed_memory: False
2024-09-14 12:49:15,332 [trainer.py] => shuffle: True
2024-09-14 12:49:15,332 [trainer.py] => init_cls: 10
2024-09-14 12:49:15,332 [trainer.py] => increment: 10
2024-09-14 12:49:15,332 [trainer.py] => model_name: simplecil
2024-09-14 12:49:15,332 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-14 12:49:15,332 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 12:49:15,332 [trainer.py] => seed: 1993
2024-09-14 12:49:15,332 [trainer.py] => tuned_epoch: 20
2024-09-14 12:49:15,333 [trainer.py] => init_lr: 0.01
2024-09-14 12:49:15,333 [trainer.py] => batch_size: 48
2024-09-14 12:49:15,333 [trainer.py] => weight_decay: 0.05
2024-09-14 12:49:15,333 [trainer.py] => min_lr: 1e-08
2024-09-14 12:49:15,333 [trainer.py] => optimizer: sgd
2024-09-14 12:49:15,333 [trainer.py] => vpt_type: shallow
2024-09-14 12:49:15,333 [trainer.py] => prompt_token_num: 3
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 12:49:15,459 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-14 12:49:27,101 [trainer.py] => All params: 85798656
2024-09-14 12:49:27,102 [trainer.py] => Trainable params: 85798656
2024-09-14 12:49:27,520 [simplecil.py] => Learning on 0-10
2024-09-14 12:49:34,251 [trainer.py] => No NME accuracy.
2024-09-14 12:49:34,251 [trainer.py] => CNN: {'total': 99.39, '00-09': 99.39, 'old': 0, 'new': 99.39}
2024-09-14 12:49:34,251 [trainer.py] => CNN top1 curve: [99.39]
2024-09-14 12:49:34,251 [trainer.py] => CNN top5 curve: [99.88]

Average Accuracy (CNN): 99.39
2024-09-14 12:49:34,251 [trainer.py] => Average Accuracy (CNN): 99.39 

2024-09-14 12:49:34,252 [trainer.py] => All params: 85806337
2024-09-14 12:49:34,253 [trainer.py] => Trainable params: 85806337
2024-09-14 12:49:34,255 [simplecil.py] => Learning on 10-20
2024-09-14 12:49:45,876 [trainer.py] => No NME accuracy.
2024-09-14 12:49:45,877 [trainer.py] => CNN: {'total': 94.59, '00-09': 98.06, '10-19': 93.17, 'old': 98.06, 'new': 93.17}
2024-09-14 12:49:45,877 [trainer.py] => CNN top1 curve: [99.39, 94.59]
2024-09-14 12:49:45,877 [trainer.py] => CNN top5 curve: [99.88, 99.86]

Average Accuracy (CNN): 96.99
2024-09-14 12:49:45,877 [trainer.py] => Average Accuracy (CNN): 96.99 

2024-09-14 12:49:45,879 [trainer.py] => All params: 85814017
2024-09-14 12:49:45,880 [trainer.py] => Trainable params: 85814017
2024-09-14 12:49:45,882 [simplecil.py] => Learning on 20-30
2024-09-14 12:50:01,486 [trainer.py] => No NME accuracy.
2024-09-14 12:50:01,486 [trainer.py] => CNN: {'total': 89.0, '00-09': 96.0, '10-19': 90.85, '20-29': 83.16, 'old': 92.34, 'new': 83.16}
2024-09-14 12:50:01,487 [trainer.py] => CNN top1 curve: [99.39, 94.59, 89.0]
2024-09-14 12:50:01,487 [trainer.py] => CNN top5 curve: [99.88, 99.86, 99.71]

Average Accuracy (CNN): 94.33
2024-09-14 12:50:01,487 [trainer.py] => Average Accuracy (CNN): 94.33 

2024-09-14 12:50:01,488 [trainer.py] => All params: 85821697
2024-09-14 12:50:01,488 [trainer.py] => Trainable params: 85821697
2024-09-14 12:50:01,490 [simplecil.py] => Learning on 30-40
2024-09-14 12:50:20,921 [trainer.py] => No NME accuracy.
2024-09-14 12:50:20,922 [trainer.py] => CNN: {'total': 88.13, '00-09': 95.88, '10-19': 90.25, '20-29': 80.1, '30-39': 90.08, 'old': 87.59, 'new': 90.08}
2024-09-14 12:50:20,922 [trainer.py] => CNN top1 curve: [99.39, 94.59, 89.0, 88.13]
2024-09-14 12:50:20,922 [trainer.py] => CNN top5 curve: [99.88, 99.86, 99.71, 99.39]

Average Accuracy (CNN): 92.78
2024-09-14 12:50:20,922 [trainer.py] => Average Accuracy (CNN): 92.78 

2024-09-14 12:50:20,923 [trainer.py] => All params: 85829377
2024-09-14 12:50:20,924 [trainer.py] => Trainable params: 85829377
2024-09-14 12:50:20,926 [simplecil.py] => Learning on 40-50
2024-09-14 12:50:48,686 [trainer.py] => No NME accuracy.
2024-09-14 12:50:48,687 [trainer.py] => CNN: {'total': 83.61, '00-09': 95.76, '10-19': 86.15, '20-29': 71.77, '30-39': 88.88, '40-49': 82.76, 'old': 84.03, 'new': 82.76}
2024-09-14 12:50:48,687 [trainer.py] => CNN top1 curve: [99.39, 94.59, 89.0, 88.13, 83.61]
2024-09-14 12:50:48,687 [trainer.py] => CNN top5 curve: [99.88, 99.86, 99.71, 99.39, 98.64]

Average Accuracy (CNN): 90.94
2024-09-14 12:50:48,687 [trainer.py] => Average Accuracy (CNN): 90.94 

Accuracy Matrix (CNN):
[[99.39 98.06 96.   95.88 95.76]
 [ 0.   93.17 90.85 90.25 86.15]
 [ 0.    0.   83.16 80.1  71.77]
 [ 0.    0.    0.   90.08 88.88]
 [ 0.    0.    0.    0.   82.76]]
2024-09-14 12:50:48,688 [trainer.py] => Forgetting (CNN): 5.809999999999999
2024-09-14 12:50:50,973 [trainer.py] => config: ./exps/simplecil_vtab_B0_Inc10.json
2024-09-14 12:50:50,998 [trainer.py] => prefix:  
2024-09-14 12:50:50,998 [trainer.py] => dataset: vtab
2024-09-14 12:50:50,998 [trainer.py] => memory_size: 0
2024-09-14 12:50:50,998 [trainer.py] => memory_per_class: 0
2024-09-14 12:50:50,998 [trainer.py] => fixed_memory: False
2024-09-14 12:50:50,998 [trainer.py] => shuffle: True
2024-09-14 12:50:50,998 [trainer.py] => init_cls: 5
2024-09-14 12:50:50,998 [trainer.py] => increment: 5
2024-09-14 12:50:50,998 [trainer.py] => model_name: simplecil
2024-09-14 12:50:50,999 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-14 12:50:50,999 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 12:50:50,999 [trainer.py] => seed: 1993
2024-09-14 12:50:50,999 [trainer.py] => tuned_epoch: 20
2024-09-14 12:50:50,999 [trainer.py] => init_lr: 0.01
2024-09-14 12:50:50,999 [trainer.py] => batch_size: 48
2024-09-14 12:50:50,999 [trainer.py] => weight_decay: 0.05
2024-09-14 12:50:50,999 [trainer.py] => min_lr: 1e-08
2024-09-14 12:50:50,999 [trainer.py] => optimizer: sgd
2024-09-14 12:50:51,000 [trainer.py] => vpt_type: shallow
2024-09-14 12:50:51,000 [trainer.py] => prompt_token_num: 3
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 12:50:51,048 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-14 12:50:53,364 [trainer.py] => All params: 85798656
2024-09-14 12:50:53,365 [trainer.py] => Trainable params: 85798656
2024-09-14 12:50:53,771 [simplecil.py] => Learning on 0-5
2024-09-14 12:50:57,354 [trainer.py] => No NME accuracy.
2024-09-14 12:50:57,355 [trainer.py] => CNN: {'total': 99.3, '00-04': 99.3, 'old': 0, 'new': 99.3}
2024-09-14 12:50:57,355 [trainer.py] => CNN top1 curve: [99.3]
2024-09-14 12:50:57,355 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.3
2024-09-14 12:50:57,355 [trainer.py] => Average Accuracy (CNN): 99.3 

2024-09-14 12:50:57,357 [trainer.py] => All params: 85802497
2024-09-14 12:50:57,358 [trainer.py] => Trainable params: 85802497
2024-09-14 12:50:57,360 [simplecil.py] => Learning on 5-10
2024-09-14 12:51:01,815 [trainer.py] => No NME accuracy.
2024-09-14 12:51:01,815 [trainer.py] => CNN: {'total': 99.39, '00-04': 98.25, '05-09': 100.0, 'old': 98.25, 'new': 100.0}
2024-09-14 12:51:01,815 [trainer.py] => CNN top1 curve: [99.3, 99.39]
2024-09-14 12:51:01,815 [trainer.py] => CNN top5 curve: [100.0, 99.88]

Average Accuracy (CNN): 99.34
2024-09-14 12:51:01,816 [trainer.py] => Average Accuracy (CNN): 99.34 

2024-09-14 12:51:01,817 [trainer.py] => All params: 85806337
2024-09-14 12:51:01,818 [trainer.py] => Trainable params: 85806337
2024-09-14 12:51:01,819 [simplecil.py] => Learning on 10-15
2024-09-14 12:51:08,215 [trainer.py] => No NME accuracy.
2024-09-14 12:51:08,215 [trainer.py] => CNN: {'total': 98.75, '00-04': 96.15, '05-09': 99.81, '10-14': 99.02, 'old': 98.55, 'new': 99.02}
2024-09-14 12:51:08,215 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75]
2024-09-14 12:51:08,215 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86]

Average Accuracy (CNN): 99.15
2024-09-14 12:51:08,216 [trainer.py] => Average Accuracy (CNN): 99.15 

2024-09-14 12:51:08,217 [trainer.py] => All params: 85810177
2024-09-14 12:51:08,219 [trainer.py] => Trainable params: 85810177
2024-09-14 12:51:08,224 [simplecil.py] => Learning on 15-20
2024-09-14 12:51:18,385 [trainer.py] => No NME accuracy.
2024-09-14 12:51:18,386 [trainer.py] => CNN: {'total': 94.59, '00-04': 95.1, '05-09': 99.63, '10-14': 97.71, '15-19': 91.2, 'old': 97.91, 'new': 91.2}
2024-09-14 12:51:18,386 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75, 94.59]
2024-09-14 12:51:18,386 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86]

Average Accuracy (CNN): 98.01
2024-09-14 12:51:18,386 [trainer.py] => Average Accuracy (CNN): 98.01 

2024-09-14 12:51:18,387 [trainer.py] => All params: 85814017
2024-09-14 12:51:18,388 [trainer.py] => Trainable params: 85814017
2024-09-14 12:51:18,390 [simplecil.py] => Learning on 20-25
2024-09-14 12:51:31,686 [trainer.py] => No NME accuracy.
2024-09-14 12:51:31,686 [trainer.py] => CNN: {'total': 88.79, '00-04': 95.1, '05-09': 97.96, '10-14': 93.79, '15-19': 89.57, '20-24': 80.08, 'old': 92.62, 'new': 80.08}
2024-09-14 12:51:31,686 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75, 94.59, 88.79]
2024-09-14 12:51:31,686 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.68]

Average Accuracy (CNN): 96.16
2024-09-14 12:51:31,687 [trainer.py] => Average Accuracy (CNN): 96.16 

2024-09-14 12:51:31,687 [trainer.py] => All params: 85817857
2024-09-14 12:51:31,688 [trainer.py] => Trainable params: 85817857
2024-09-14 12:51:31,689 [simplecil.py] => Learning on 25-30
2024-09-14 12:51:45,189 [trainer.py] => No NME accuracy.
2024-09-14 12:51:45,189 [trainer.py] => CNN: {'total': 89.0, '00-04': 92.31, '05-09': 97.96, '10-14': 93.79, '15-19': 89.57, '20-24': 79.84, '25-29': 94.18, 'old': 88.52, 'new': 94.18}
2024-09-14 12:51:45,189 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75, 94.59, 88.79, 89.0]
2024-09-14 12:51:45,189 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.68, 99.71]

Average Accuracy (CNN): 94.97
2024-09-14 12:51:45,190 [trainer.py] => Average Accuracy (CNN): 94.97 

2024-09-14 12:51:45,191 [trainer.py] => All params: 85821697
2024-09-14 12:51:45,192 [trainer.py] => Trainable params: 85821697
2024-09-14 12:51:45,193 [simplecil.py] => Learning on 30-35
2024-09-14 12:52:01,746 [trainer.py] => No NME accuracy.
2024-09-14 12:52:01,746 [trainer.py] => CNN: {'total': 88.15, '00-04': 92.31, '05-09': 97.96, '10-14': 93.14, '15-19': 89.28, '20-24': 76.57, '25-29': 93.39, '30-34': 89.89, 'old': 87.83, 'new': 89.89}
2024-09-14 12:52:01,747 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75, 94.59, 88.79, 89.0, 88.15]
2024-09-14 12:52:01,747 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.68, 99.71, 99.7]

Average Accuracy (CNN): 94.0
2024-09-14 12:52:01,747 [trainer.py] => Average Accuracy (CNN): 94.0 

2024-09-14 12:52:01,748 [trainer.py] => All params: 85825537
2024-09-14 12:52:01,750 [trainer.py] => Trainable params: 85825537
2024-09-14 12:52:01,751 [simplecil.py] => Learning on 35-40
2024-09-14 12:52:20,484 [trainer.py] => No NME accuracy.
2024-09-14 12:52:20,485 [trainer.py] => CNN: {'total': 88.13, '00-04': 92.31, '05-09': 97.78, '10-14': 92.97, '15-19': 89.07, '20-24': 76.1, '25-29': 93.39, '30-34': 89.89, '35-39': 90.43, 'old': 87.94, 'new': 90.43}
2024-09-14 12:52:20,485 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75, 94.59, 88.79, 89.0, 88.15, 88.13]
2024-09-14 12:52:20,485 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.68, 99.71, 99.7, 99.39]

Average Accuracy (CNN): 93.26
2024-09-14 12:52:20,485 [trainer.py] => Average Accuracy (CNN): 93.26 

2024-09-14 12:52:20,486 [trainer.py] => All params: 85829377
2024-09-14 12:52:20,487 [trainer.py] => Trainable params: 85829377
2024-09-14 12:52:20,488 [simplecil.py] => Learning on 40-45
2024-09-14 12:52:44,008 [trainer.py] => No NME accuracy.
2024-09-14 12:52:44,008 [trainer.py] => CNN: {'total': 86.88, '00-04': 92.31, '05-09': 97.78, '10-14': 89.38, '15-19': 88.08, '20-24': 71.55, '25-29': 92.86, '30-34': 89.64, '35-39': 89.98, '40-44': 88.69, 'old': 86.4, 'new': 88.69}
2024-09-14 12:52:44,008 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75, 94.59, 88.79, 89.0, 88.15, 88.13, 86.88]
2024-09-14 12:52:44,009 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.68, 99.71, 99.7, 99.39, 99.17]

Average Accuracy (CNN): 92.55
2024-09-14 12:52:44,009 [trainer.py] => Average Accuracy (CNN): 92.55 

2024-09-14 12:52:44,009 [trainer.py] => All params: 85833217
2024-09-14 12:52:44,010 [trainer.py] => Trainable params: 85833217
2024-09-14 12:52:44,011 [simplecil.py] => Learning on 45-50
2024-09-14 12:53:10,977 [trainer.py] => No NME accuracy.
2024-09-14 12:53:10,977 [trainer.py] => CNN: {'total': 83.61, '00-04': 91.96, '05-09': 97.78, '10-14': 84.31, '15-19': 86.94, '20-24': 65.42, '25-29': 92.86, '30-34': 89.4, '35-39': 87.93, '40-44': 83.17, '45-49': 82.31, 'old': 83.85, 'new': 82.31}
2024-09-14 12:53:10,978 [trainer.py] => CNN top1 curve: [99.3, 99.39, 98.75, 94.59, 88.79, 89.0, 88.15, 88.13, 86.88, 83.61]
2024-09-14 12:53:10,978 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.68, 99.71, 99.7, 99.39, 99.17, 98.64]

Average Accuracy (CNN): 91.66
2024-09-14 12:53:10,978 [trainer.py] => Average Accuracy (CNN): 91.66 

Accuracy Matrix (CNN):
[[ 99.3   98.25  96.15  95.1   95.1   92.31  92.31  92.31  92.31  91.96]
 [  0.   100.    99.81  99.63  97.96  97.96  97.96  97.78  97.78  97.78]
 [  0.     0.    99.02  97.71  93.79  93.79  93.14  92.97  89.38  84.31]
 [  0.     0.     0.    91.2   89.57  89.57  89.28  89.07  88.08  86.94]
 [  0.     0.     0.     0.    80.08  79.84  76.57  76.1   71.55  65.42]
 [  0.     0.     0.     0.     0.    94.18  93.39  93.39  92.86  92.86]
 [  0.     0.     0.     0.     0.     0.    89.89  89.89  89.64  89.4 ]
 [  0.     0.     0.     0.     0.     0.     0.    90.43  89.98  87.93]
 [  0.     0.     0.     0.     0.     0.     0.     0.    88.69  83.17]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    82.31]]
2024-09-14 12:53:10,980 [trainer.py] => Forgetting (CNN): 5.891111111111111
2024-09-14 21:10:22,875 [trainer.py] => config: ./exps/l2p_vtab_B0_Inc5.json
2024-09-14 21:10:22,875 [trainer.py] => prefix:  
2024-09-14 21:10:22,875 [trainer.py] => dataset: vtab
2024-09-14 21:10:22,875 [trainer.py] => memory_size: 0
2024-09-14 21:10:22,875 [trainer.py] => memory_per_class: 0
2024-09-14 21:10:22,875 [trainer.py] => fixed_memory: False
2024-09-14 21:10:22,875 [trainer.py] => shuffle: True
2024-09-14 21:10:22,875 [trainer.py] => init_cls: 10
2024-09-14 21:10:22,875 [trainer.py] => increment: 10
2024-09-14 21:10:22,875 [trainer.py] => model_name: l2p
2024-09-14 21:10:22,875 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-14 21:10:22,875 [trainer.py] => get_original_backbone: True
2024-09-14 21:10:22,875 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 21:10:22,875 [trainer.py] => seed: 1993
2024-09-14 21:10:22,875 [trainer.py] => tuned_epoch: 20
2024-09-14 21:10:22,875 [trainer.py] => init_lr: 0.001875
2024-09-14 21:10:22,875 [trainer.py] => batch_size: 48
2024-09-14 21:10:22,875 [trainer.py] => weight_decay: 0
2024-09-14 21:10:22,876 [trainer.py] => min_lr: 1e-05
2024-09-14 21:10:22,876 [trainer.py] => optimizer: adam
2024-09-14 21:10:22,876 [trainer.py] => scheduler: constant
2024-09-14 21:10:22,876 [trainer.py] => reinit_optimizer: True
2024-09-14 21:10:22,876 [trainer.py] => global_pool: token
2024-09-14 21:10:22,876 [trainer.py] => head_type: prompt
2024-09-14 21:10:22,876 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-14 21:10:22,876 [trainer.py] => pretrained: True
2024-09-14 21:10:22,876 [trainer.py] => drop: 0.0
2024-09-14 21:10:22,876 [trainer.py] => drop_path: 0.0
2024-09-14 21:10:22,876 [trainer.py] => prompt_pool: True
2024-09-14 21:10:22,876 [trainer.py] => size: 10
2024-09-14 21:10:22,876 [trainer.py] => length: 5
2024-09-14 21:10:22,876 [trainer.py] => top_k: 5
2024-09-14 21:10:22,876 [trainer.py] => initializer: uniform
2024-09-14 21:10:22,876 [trainer.py] => prompt_key: True
2024-09-14 21:10:22,876 [trainer.py] => prompt_key_init: uniform
2024-09-14 21:10:22,876 [trainer.py] => use_prompt_mask: False
2024-09-14 21:10:22,876 [trainer.py] => shared_prompt_pool: False
2024-09-14 21:10:22,876 [trainer.py] => shared_prompt_key: False
2024-09-14 21:10:22,876 [trainer.py] => batchwise_prompt: True
2024-09-14 21:10:22,876 [trainer.py] => embedding_key: cls
2024-09-14 21:10:22,876 [trainer.py] => predefined_key: 
2024-09-14 21:10:22,876 [trainer.py] => pull_constraint: True
2024-09-14 21:10:22,876 [trainer.py] => pull_constraint_coeff: 0.1
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 21:10:22,915 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-09-14 21:10:24,829 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-14 21:10:24,829 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-14 21:10:29,026 [l2p.py] => 85,902,386 model total parameters.
2024-09-14 21:10:29,027 [l2p.py] => 84,530 model training parameters.
2024-09-14 21:10:29,027 [l2p.py] => prompt.prompt: 38400
2024-09-14 21:10:29,027 [l2p.py] => prompt.prompt_key: 7680
2024-09-14 21:10:29,027 [l2p.py] => head.weight: 38400
2024-09-14 21:10:29,027 [l2p.py] => head.bias: 50
2024-09-14 21:10:29,028 [trainer.py] => All params: 171739492
2024-09-14 21:10:29,029 [trainer.py] => Trainable params: 84530
2024-09-14 21:10:29,029 [l2p.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.269, Train_accy 26.09:   0%|          | 0/20 [00:02<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.269, Train_accy 26.09:   5%|▌         | 1/20 [00:02<00:55,  2.94s/it]
Task 0, Epoch 2/20 => Loss 0.829, Train_accy 68.94:   5%|▌         | 1/20 [00:04<00:55,  2.94s/it]
Task 0, Epoch 2/20 => Loss 0.829, Train_accy 68.94:  10%|█         | 2/20 [00:04<00:43,  2.39s/it]
Task 0, Epoch 3/20 => Loss 0.443, Train_accy 90.06:  10%|█         | 2/20 [00:07<00:43,  2.39s/it]
Task 0, Epoch 3/20 => Loss 0.443, Train_accy 90.06:  15%|█▌        | 3/20 [00:07<00:38,  2.24s/it]
Task 0, Epoch 4/20 => Loss 0.274, Train_accy 88.82:  15%|█▌        | 3/20 [00:09<00:38,  2.24s/it]
Task 0, Epoch 4/20 => Loss 0.274, Train_accy 88.82:  20%|██        | 4/20 [00:09<00:34,  2.15s/it]
Task 0, Epoch 5/20 => Loss 0.308, Train_accy 91.30, Test_accy 97.82:  20%|██        | 4/20 [00:16<00:34,  2.15s/it]
Task 0, Epoch 5/20 => Loss 0.308, Train_accy 91.30, Test_accy 97.82:  25%|██▌       | 5/20 [00:16<01:01,  4.12s/it]
Task 0, Epoch 6/20 => Loss 0.066, Train_accy 96.89:  25%|██▌       | 5/20 [00:18<01:01,  4.12s/it]                 
Task 0, Epoch 6/20 => Loss 0.066, Train_accy 96.89:  30%|███       | 6/20 [00:18<00:47,  3.39s/it]
Task 0, Epoch 7/20 => Loss 0.072, Train_accy 97.52:  30%|███       | 6/20 [00:20<00:47,  3.39s/it]
Task 0, Epoch 7/20 => Loss 0.072, Train_accy 97.52:  35%|███▌      | 7/20 [00:20<00:38,  2.99s/it]
Task 0, Epoch 8/20 => Loss 0.109, Train_accy 95.65:  35%|███▌      | 7/20 [00:22<00:38,  2.99s/it]
Task 0, Epoch 8/20 => Loss 0.109, Train_accy 95.65:  40%|████      | 8/20 [00:22<00:31,  2.65s/it]
Task 0, Epoch 9/20 => Loss 0.139, Train_accy 95.65:  40%|████      | 8/20 [00:24<00:31,  2.65s/it]
Task 0, Epoch 9/20 => Loss 0.139, Train_accy 95.65:  45%|████▌     | 9/20 [00:24<00:26,  2.44s/it]
Task 0, Epoch 10/20 => Loss 0.071, Train_accy 98.76, Test_accy 98.06:  45%|████▌     | 9/20 [00:32<00:26,  2.44s/it]
Task 0, Epoch 10/20 => Loss 0.071, Train_accy 98.76, Test_accy 98.06:  50%|█████     | 10/20 [00:32<00:39,  3.99s/it]
Task 0, Epoch 11/20 => Loss 0.062, Train_accy 96.89:  50%|█████     | 10/20 [00:34<00:39,  3.99s/it]                 
Task 0, Epoch 11/20 => Loss 0.062, Train_accy 96.89:  55%|█████▌    | 11/20 [00:34<00:30,  3.38s/it]
Task 0, Epoch 12/20 => Loss 0.092, Train_accy 96.89:  55%|█████▌    | 11/20 [00:36<00:30,  3.38s/it]
Task 0, Epoch 12/20 => Loss 0.092, Train_accy 96.89:  60%|██████    | 12/20 [00:36<00:23,  2.98s/it]
Task 0, Epoch 13/20 => Loss 0.046, Train_accy 97.52:  60%|██████    | 12/20 [00:38<00:23,  2.98s/it]
Task 0, Epoch 13/20 => Loss 0.046, Train_accy 97.52:  65%|██████▌   | 13/20 [00:38<00:18,  2.66s/it]
Task 0, Epoch 14/20 => Loss 0.039, Train_accy 96.89:  65%|██████▌   | 13/20 [00:40<00:18,  2.66s/it]
Task 0, Epoch 14/20 => Loss 0.039, Train_accy 96.89:  70%|███████   | 14/20 [00:40<00:14,  2.48s/it]
Task 0, Epoch 15/20 => Loss 0.061, Train_accy 96.27, Test_accy 98.43:  70%|███████   | 14/20 [00:47<00:14,  2.48s/it]
Task 0, Epoch 15/20 => Loss 0.061, Train_accy 96.27, Test_accy 98.43:  75%|███████▌  | 15/20 [00:47<00:20,  4.00s/it]
Task 0, Epoch 16/20 => Loss 0.019, Train_accy 98.76:  75%|███████▌  | 15/20 [00:49<00:20,  4.00s/it]                 
Task 0, Epoch 16/20 => Loss 0.019, Train_accy 98.76:  80%|████████  | 16/20 [00:49<00:13,  3.38s/it]
Task 0, Epoch 17/20 => Loss 0.044, Train_accy 98.76:  80%|████████  | 16/20 [00:51<00:13,  3.38s/it]
Task 0, Epoch 17/20 => Loss 0.044, Train_accy 98.76:  85%|████████▌ | 17/20 [00:51<00:08,  2.94s/it]
Task 0, Epoch 18/20 => Loss 0.029, Train_accy 97.52:  85%|████████▌ | 17/20 [00:53<00:08,  2.94s/it]
Task 0, Epoch 18/20 => Loss 0.029, Train_accy 97.52:  90%|█████████ | 18/20 [00:53<00:05,  2.67s/it]
Task 0, Epoch 19/20 => Loss 0.037, Train_accy 99.38:  90%|█████████ | 18/20 [00:55<00:05,  2.67s/it]
Task 0, Epoch 19/20 => Loss 0.037, Train_accy 99.38:  95%|█████████▌| 19/20 [00:55<00:02,  2.47s/it]
Task 0, Epoch 20/20 => Loss 0.032, Train_accy 96.89, Test_accy 97.94:  95%|█████████▌| 19/20 [01:03<00:02,  2.47s/it]
Task 0, Epoch 20/20 => Loss 0.032, Train_accy 96.89, Test_accy 97.94: 100%|██████████| 20/20 [01:03<00:00,  3.96s/it]
Task 0, Epoch 20/20 => Loss 0.032, Train_accy 96.89, Test_accy 97.94: 100%|██████████| 20/20 [01:03<00:00,  3.15s/it]2024-09-14 21:11:32,669 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.032, Train_accy 96.89, Test_accy 97.94

2024-09-14 21:11:38,307 [trainer.py] => No NME accuracy.
2024-09-14 21:11:38,308 [trainer.py] => CNN: {'total': 97.94, '00-09': 97.94, 'old': 0, 'new': 97.94}
2024-09-14 21:11:38,308 [trainer.py] => CNN top1 curve: [97.94]
2024-09-14 21:11:38,308 [trainer.py] => CNN top5 curve: [99.88]

Average Accuracy (CNN): 97.94
2024-09-14 21:11:38,308 [trainer.py] => Average Accuracy (CNN): 97.94 

2024-09-14 21:11:38,310 [trainer.py] => All params: 171739492
2024-09-14 21:11:38,312 [trainer.py] => Trainable params: 84530
2024-09-14 21:11:38,312 [l2p.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.937, Train_accy 41.06:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.937, Train_accy 41.06:   5%|▌         | 1/20 [00:04<01:22,  4.32s/it]
Task 1, Epoch 2/20 => Loss 0.727, Train_accy 77.54:   5%|▌         | 1/20 [00:08<01:22,  4.32s/it]
Task 1, Epoch 2/20 => Loss 0.727, Train_accy 77.54:  10%|█         | 2/20 [00:08<01:17,  4.28s/it]
Task 1, Epoch 3/20 => Loss 0.364, Train_accy 88.89:  10%|█         | 2/20 [00:12<01:17,  4.28s/it]
Task 1, Epoch 3/20 => Loss 0.364, Train_accy 88.89:  15%|█▌        | 3/20 [00:12<01:13,  4.30s/it]
Task 1, Epoch 4/20 => Loss 0.221, Train_accy 91.06:  15%|█▌        | 3/20 [00:17<01:13,  4.30s/it]
Task 1, Epoch 4/20 => Loss 0.221, Train_accy 91.06:  20%|██        | 4/20 [00:17<01:08,  4.30s/it]
Task 1, Epoch 5/20 => Loss 0.160, Train_accy 94.44, Test_accy 94.98:  20%|██        | 4/20 [00:38<01:08,  4.30s/it]
Task 1, Epoch 5/20 => Loss 0.160, Train_accy 94.44, Test_accy 94.98:  25%|██▌       | 5/20 [00:38<02:34, 10.33s/it]
Task 1, Epoch 6/20 => Loss 0.199, Train_accy 93.24:  25%|██▌       | 5/20 [00:42<02:34, 10.33s/it]                 
Task 1, Epoch 6/20 => Loss 0.199, Train_accy 93.24:  30%|███       | 6/20 [00:42<01:54,  8.18s/it]
Task 1, Epoch 7/20 => Loss 0.132, Train_accy 94.93:  30%|███       | 6/20 [00:46<01:54,  8.18s/it]
Task 1, Epoch 7/20 => Loss 0.132, Train_accy 94.93:  35%|███▌      | 7/20 [00:46<01:28,  6.78s/it]
Task 1, Epoch 8/20 => Loss 0.103, Train_accy 96.14:  35%|███▌      | 7/20 [00:50<01:28,  6.78s/it]
Task 1, Epoch 8/20 => Loss 0.103, Train_accy 96.14:  40%|████      | 8/20 [00:50<01:10,  5.89s/it]
Task 1, Epoch 9/20 => Loss 0.075, Train_accy 95.65:  40%|████      | 8/20 [00:54<01:10,  5.89s/it]
Task 1, Epoch 9/20 => Loss 0.075, Train_accy 95.65:  45%|████▌     | 9/20 [00:54<00:58,  5.31s/it]
Task 1, Epoch 10/20 => Loss 0.104, Train_accy 96.14, Test_accy 97.05:  45%|████▌     | 9/20 [01:14<00:58,  5.31s/it]
Task 1, Epoch 10/20 => Loss 0.104, Train_accy 96.14, Test_accy 97.05:  50%|█████     | 10/20 [01:14<01:39,  9.92s/it]
Task 1, Epoch 11/20 => Loss 0.055, Train_accy 96.62:  50%|█████     | 10/20 [01:18<01:39,  9.92s/it]                 
Task 1, Epoch 11/20 => Loss 0.055, Train_accy 96.62:  55%|█████▌    | 11/20 [01:18<01:12,  8.11s/it]
Task 1, Epoch 12/20 => Loss 0.062, Train_accy 96.86:  55%|█████▌    | 11/20 [01:22<01:12,  8.11s/it]
Task 1, Epoch 12/20 => Loss 0.062, Train_accy 96.86:  60%|██████    | 12/20 [01:22<00:54,  6.85s/it]
Task 1, Epoch 13/20 => Loss 0.070, Train_accy 96.86:  60%|██████    | 12/20 [01:26<00:54,  6.85s/it]
Task 1, Epoch 13/20 => Loss 0.070, Train_accy 96.86:  65%|██████▌   | 13/20 [01:26<00:41,  5.96s/it]
Task 1, Epoch 14/20 => Loss 0.051, Train_accy 97.58:  65%|██████▌   | 13/20 [01:30<00:41,  5.96s/it]
Task 1, Epoch 14/20 => Loss 0.051, Train_accy 97.58:  70%|███████   | 14/20 [01:30<00:32,  5.43s/it]
Task 1, Epoch 15/20 => Loss 0.044, Train_accy 96.14, Test_accy 96.91:  70%|███████   | 14/20 [01:52<00:32,  5.43s/it]
Task 1, Epoch 15/20 => Loss 0.044, Train_accy 96.14, Test_accy 96.91:  75%|███████▌  | 15/20 [01:52<00:51, 10.38s/it]
Task 1, Epoch 16/20 => Loss 0.035, Train_accy 96.62:  75%|███████▌  | 15/20 [01:56<00:51, 10.38s/it]                 
Task 1, Epoch 16/20 => Loss 0.035, Train_accy 96.62:  80%|████████  | 16/20 [01:56<00:34,  8.52s/it]
Task 1, Epoch 17/20 => Loss 0.030, Train_accy 96.14:  80%|████████  | 16/20 [02:00<00:34,  8.52s/it]
Task 1, Epoch 17/20 => Loss 0.030, Train_accy 96.14:  85%|████████▌ | 17/20 [02:00<00:21,  7.20s/it]
Task 1, Epoch 18/20 => Loss 0.070, Train_accy 94.93:  85%|████████▌ | 17/20 [02:05<00:21,  7.20s/it]
Task 1, Epoch 18/20 => Loss 0.070, Train_accy 94.93:  90%|█████████ | 18/20 [02:05<00:12,  6.35s/it]
Task 1, Epoch 19/20 => Loss 0.027, Train_accy 96.62:  90%|█████████ | 18/20 [02:09<00:12,  6.35s/it]
Task 1, Epoch 19/20 => Loss 0.027, Train_accy 96.62:  95%|█████████▌| 19/20 [02:09<00:05,  5.73s/it]
Task 1, Epoch 20/20 => Loss 0.021, Train_accy 96.38, Test_accy 96.31:  95%|█████████▌| 19/20 [02:31<00:05,  5.73s/it]
Task 1, Epoch 20/20 => Loss 0.021, Train_accy 96.38, Test_accy 96.31: 100%|██████████| 20/20 [02:31<00:00, 10.58s/it]
Task 1, Epoch 20/20 => Loss 0.021, Train_accy 96.38, Test_accy 96.31: 100%|██████████| 20/20 [02:31<00:00,  7.56s/it]2024-09-14 21:14:09,524 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.021, Train_accy 96.38, Test_accy 96.31

2024-09-14 21:14:27,143 [trainer.py] => No NME accuracy.
2024-09-14 21:14:27,144 [trainer.py] => CNN: {'total': 96.31, '00-09': 95.04, '10-19': 96.83, 'old': 95.04, 'new': 96.83}
2024-09-14 21:14:27,144 [trainer.py] => CNN top1 curve: [97.94, 96.31]
2024-09-14 21:14:27,144 [trainer.py] => CNN top5 curve: [99.88, 99.68]

Average Accuracy (CNN): 97.12
2024-09-14 21:14:27,144 [trainer.py] => Average Accuracy (CNN): 97.12 

2024-09-14 21:14:27,145 [trainer.py] => All params: 171739492
2024-09-14 21:14:27,147 [trainer.py] => Trainable params: 84530
2024-09-14 21:14:27,147 [l2p.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.490, Train_accy 44.66:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.490, Train_accy 44.66:   5%|▌         | 1/20 [00:03<01:13,  3.87s/it]
Task 2, Epoch 2/20 => Loss 0.454, Train_accy 79.73:   5%|▌         | 1/20 [00:07<01:13,  3.87s/it]
Task 2, Epoch 2/20 => Loss 0.454, Train_accy 79.73:  10%|█         | 2/20 [00:07<01:08,  3.80s/it]
Task 2, Epoch 3/20 => Loss 0.297, Train_accy 84.11:  10%|█         | 2/20 [00:11<01:08,  3.80s/it]
Task 2, Epoch 3/20 => Loss 0.297, Train_accy 84.11:  15%|█▌        | 3/20 [00:11<01:05,  3.83s/it]
Task 2, Epoch 4/20 => Loss 0.241, Train_accy 89.86:  15%|█▌        | 3/20 [00:15<01:05,  3.83s/it]
Task 2, Epoch 4/20 => Loss 0.241, Train_accy 89.86:  20%|██        | 4/20 [00:15<01:01,  3.87s/it]
Task 2, Epoch 5/20 => Loss 0.128, Train_accy 91.51, Test_accy 78.91:  20%|██        | 4/20 [00:46<01:01,  3.87s/it]
Task 2, Epoch 5/20 => Loss 0.128, Train_accy 91.51, Test_accy 78.91:  25%|██▌       | 5/20 [00:46<03:23, 13.56s/it]
Task 2, Epoch 6/20 => Loss 0.084, Train_accy 94.79:  25%|██▌       | 5/20 [00:49<03:23, 13.56s/it]                 
Task 2, Epoch 6/20 => Loss 0.084, Train_accy 94.79:  30%|███       | 6/20 [00:49<02:22, 10.16s/it]
Task 2, Epoch 7/20 => Loss 0.073, Train_accy 94.52:  30%|███       | 6/20 [00:53<02:22, 10.16s/it]
Task 2, Epoch 7/20 => Loss 0.073, Train_accy 94.52:  35%|███▌      | 7/20 [00:53<01:43,  7.98s/it]
Task 2, Epoch 8/20 => Loss 0.060, Train_accy 96.16:  35%|███▌      | 7/20 [00:56<01:43,  7.98s/it]
Task 2, Epoch 8/20 => Loss 0.060, Train_accy 96.16:  40%|████      | 8/20 [00:56<01:19,  6.61s/it]
Task 2, Epoch 9/20 => Loss 0.024, Train_accy 95.62:  40%|████      | 8/20 [01:00<01:19,  6.61s/it]
Task 2, Epoch 9/20 => Loss 0.024, Train_accy 95.62:  45%|████▌     | 9/20 [01:00<01:02,  5.65s/it]
Task 2, Epoch 10/20 => Loss 0.033, Train_accy 95.62, Test_accy 82.28:  45%|████▌     | 9/20 [01:29<01:02,  5.65s/it]
Task 2, Epoch 10/20 => Loss 0.033, Train_accy 95.62, Test_accy 82.28:  50%|█████     | 10/20 [01:29<02:08, 12.81s/it]
Task 2, Epoch 11/20 => Loss 0.011, Train_accy 96.99:  50%|█████     | 10/20 [01:32<02:08, 12.81s/it]                 
Task 2, Epoch 11/20 => Loss 0.011, Train_accy 96.99:  55%|█████▌    | 11/20 [01:32<01:29,  9.97s/it]
Task 2, Epoch 12/20 => Loss 0.056, Train_accy 94.52:  55%|█████▌    | 11/20 [01:36<01:29,  9.97s/it]
Task 2, Epoch 12/20 => Loss 0.056, Train_accy 94.52:  60%|██████    | 12/20 [01:36<01:04,  8.01s/it]
Task 2, Epoch 13/20 => Loss -0.009, Train_accy 98.08:  60%|██████    | 12/20 [01:39<01:04,  8.01s/it]
Task 2, Epoch 13/20 => Loss -0.009, Train_accy 98.08:  65%|██████▌   | 13/20 [01:39<00:46,  6.68s/it]
Task 2, Epoch 14/20 => Loss 0.001, Train_accy 96.71:  65%|██████▌   | 13/20 [01:43<00:46,  6.68s/it] 
Task 2, Epoch 14/20 => Loss 0.001, Train_accy 96.71:  70%|███████   | 14/20 [01:43<00:34,  5.75s/it]
Task 2, Epoch 15/20 => Loss -0.003, Train_accy 95.34, Test_accy 81.90:  70%|███████   | 14/20 [02:14<00:34,  5.75s/it]
Task 2, Epoch 15/20 => Loss -0.003, Train_accy 95.34, Test_accy 81.90:  75%|███████▌  | 15/20 [02:14<01:06, 13.38s/it]
Task 2, Epoch 16/20 => Loss -0.012, Train_accy 95.89:  75%|███████▌  | 15/20 [02:18<01:06, 13.38s/it]                 
Task 2, Epoch 16/20 => Loss -0.012, Train_accy 95.89:  80%|████████  | 16/20 [02:18<00:42, 10.51s/it]
Task 2, Epoch 17/20 => Loss 0.013, Train_accy 94.79:  80%|████████  | 16/20 [02:22<00:42, 10.51s/it] 
Task 2, Epoch 17/20 => Loss 0.013, Train_accy 94.79:  85%|████████▌ | 17/20 [02:22<00:25,  8.46s/it]
Task 2, Epoch 18/20 => Loss -0.049, Train_accy 97.81:  85%|████████▌ | 17/20 [02:26<00:25,  8.46s/it]
Task 2, Epoch 18/20 => Loss -0.049, Train_accy 97.81:  90%|█████████ | 18/20 [02:26<00:14,  7.10s/it]
Task 2, Epoch 19/20 => Loss -0.040, Train_accy 96.71:  90%|█████████ | 18/20 [02:29<00:14,  7.10s/it]
Task 2, Epoch 19/20 => Loss -0.040, Train_accy 96.71:  95%|█████████▌| 19/20 [02:29<00:06,  6.10s/it]
Task 2, Epoch 20/20 => Loss -0.068, Train_accy 98.08, Test_accy 81.85:  95%|█████████▌| 19/20 [03:01<00:06,  6.10s/it]
Task 2, Epoch 20/20 => Loss -0.068, Train_accy 98.08, Test_accy 81.85: 100%|██████████| 20/20 [03:01<00:00, 13.66s/it]
Task 2, Epoch 20/20 => Loss -0.068, Train_accy 98.08, Test_accy 81.85: 100%|██████████| 20/20 [03:01<00:00,  9.06s/it]2024-09-14 21:17:28,267 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.068, Train_accy 98.08, Test_accy 81.85

2024-09-14 21:17:55,565 [trainer.py] => No NME accuracy.
2024-09-14 21:17:55,566 [trainer.py] => CNN: {'total': 81.85, '00-09': 70.7, '10-19': 78.43, '20-29': 91.73, 'old': 76.19, 'new': 91.73}
2024-09-14 21:17:55,566 [trainer.py] => CNN top1 curve: [97.94, 96.31, 81.85]
2024-09-14 21:17:55,566 [trainer.py] => CNN top5 curve: [99.88, 99.68, 98.86]

Average Accuracy (CNN): 92.03
2024-09-14 21:17:55,566 [trainer.py] => Average Accuracy (CNN): 92.03 

2024-09-14 21:17:55,569 [trainer.py] => All params: 171739492
2024-09-14 21:17:55,570 [trainer.py] => Trainable params: 84530
2024-09-14 21:17:55,570 [l2p.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.435, Train_accy 54.46:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.435, Train_accy 54.46:   5%|▌         | 1/20 [00:03<01:04,  3.39s/it]
Task 3, Epoch 2/20 => Loss 0.242, Train_accy 88.12:   5%|▌         | 1/20 [00:06<01:04,  3.39s/it]
Task 3, Epoch 2/20 => Loss 0.242, Train_accy 88.12:  10%|█         | 2/20 [00:06<01:01,  3.41s/it]
Task 3, Epoch 3/20 => Loss 0.046, Train_accy 95.05:  10%|█         | 2/20 [00:10<01:01,  3.41s/it]
Task 3, Epoch 3/20 => Loss 0.046, Train_accy 95.05:  15%|█▌        | 3/20 [00:10<00:56,  3.33s/it]
Task 3, Epoch 4/20 => Loss 0.005, Train_accy 97.69:  15%|█▌        | 3/20 [00:13<00:56,  3.33s/it]
Task 3, Epoch 4/20 => Loss 0.005, Train_accy 97.69:  20%|██        | 4/20 [00:13<00:52,  3.28s/it]
Task 3, Epoch 5/20 => Loss 0.019, Train_accy 96.70, Test_accy 70.44:  20%|██        | 4/20 [00:49<00:52,  3.28s/it]
Task 3, Epoch 5/20 => Loss 0.019, Train_accy 96.70, Test_accy 70.44:  25%|██▌       | 5/20 [00:49<03:45, 15.03s/it]
Task 3, Epoch 6/20 => Loss -0.043, Train_accy 97.36:  25%|██▌       | 5/20 [00:52<03:45, 15.03s/it]                
Task 3, Epoch 6/20 => Loss -0.043, Train_accy 97.36:  30%|███       | 6/20 [00:52<02:33, 10.98s/it]
Task 3, Epoch 7/20 => Loss -0.026, Train_accy 96.70:  30%|███       | 6/20 [00:55<02:33, 10.98s/it]
Task 3, Epoch 7/20 => Loss -0.026, Train_accy 96.70:  35%|███▌      | 7/20 [00:55<01:49,  8.40s/it]
Task 3, Epoch 8/20 => Loss -0.105, Train_accy 99.67:  35%|███▌      | 7/20 [00:58<01:49,  8.40s/it]
Task 3, Epoch 8/20 => Loss -0.105, Train_accy 99.67:  40%|████      | 8/20 [00:58<01:20,  6.68s/it]
Task 3, Epoch 9/20 => Loss -0.076, Train_accy 98.02:  40%|████      | 8/20 [01:01<01:20,  6.68s/it]
Task 3, Epoch 9/20 => Loss -0.076, Train_accy 98.02:  45%|████▌     | 9/20 [01:01<01:00,  5.53s/it]
Task 3, Epoch 10/20 => Loss -0.082, Train_accy 98.68, Test_accy 71.55:  45%|████▌     | 9/20 [01:37<01:00,  5.53s/it]
Task 3, Epoch 10/20 => Loss -0.082, Train_accy 98.68, Test_accy 71.55:  50%|█████     | 10/20 [01:37<02:31, 15.15s/it]
Task 3, Epoch 11/20 => Loss -0.081, Train_accy 98.68:  50%|█████     | 10/20 [01:41<02:31, 15.15s/it]                 
Task 3, Epoch 11/20 => Loss -0.081, Train_accy 98.68:  55%|█████▌    | 11/20 [01:41<01:43, 11.49s/it]
Task 3, Epoch 12/20 => Loss -0.094, Train_accy 99.01:  55%|█████▌    | 11/20 [01:44<01:43, 11.49s/it]
Task 3, Epoch 12/20 => Loss -0.094, Train_accy 99.01:  60%|██████    | 12/20 [01:44<01:11,  8.99s/it]
Task 3, Epoch 13/20 => Loss -0.086, Train_accy 98.68:  60%|██████    | 12/20 [01:47<01:11,  8.99s/it]
Task 3, Epoch 13/20 => Loss -0.086, Train_accy 98.68:  65%|██████▌   | 13/20 [01:47<00:50,  7.23s/it]
Task 3, Epoch 14/20 => Loss -0.057, Train_accy 97.36:  65%|██████▌   | 13/20 [01:50<00:50,  7.23s/it]
Task 3, Epoch 14/20 => Loss -0.057, Train_accy 97.36:  70%|███████   | 14/20 [01:50<00:36,  6.04s/it]
Task 3, Epoch 15/20 => Loss -0.113, Train_accy 99.34, Test_accy 67.99:  70%|███████   | 14/20 [02:29<00:36,  6.04s/it]
Task 3, Epoch 15/20 => Loss -0.113, Train_accy 99.34, Test_accy 67.99:  75%|███████▌  | 15/20 [02:29<01:18, 15.72s/it]
Task 3, Epoch 16/20 => Loss -0.131, Train_accy 99.01:  75%|███████▌  | 15/20 [02:32<01:18, 15.72s/it]                 
Task 3, Epoch 16/20 => Loss -0.131, Train_accy 99.01:  80%|████████  | 16/20 [02:32<00:47, 11.96s/it]
Task 3, Epoch 17/20 => Loss -0.139, Train_accy 99.67:  80%|████████  | 16/20 [02:35<00:47, 11.96s/it]
Task 3, Epoch 17/20 => Loss -0.139, Train_accy 99.67:  85%|████████▌ | 17/20 [02:35<00:28,  9.35s/it]
Task 3, Epoch 18/20 => Loss -0.139, Train_accy 99.34:  85%|████████▌ | 17/20 [02:38<00:28,  9.35s/it]
Task 3, Epoch 18/20 => Loss -0.139, Train_accy 99.34:  90%|█████████ | 18/20 [02:38<00:15,  7.51s/it]
Task 3, Epoch 19/20 => Loss -0.122, Train_accy 98.35:  90%|█████████ | 18/20 [02:42<00:15,  7.51s/it]
Task 3, Epoch 19/20 => Loss -0.122, Train_accy 98.35:  95%|█████████▌| 19/20 [02:42<00:06,  6.22s/it]
Task 3, Epoch 20/20 => Loss -0.131, Train_accy 99.34, Test_accy 70.23:  95%|█████████▌| 19/20 [03:20<00:06,  6.22s/it]
Task 3, Epoch 20/20 => Loss -0.131, Train_accy 99.34, Test_accy 70.23: 100%|██████████| 20/20 [03:20<00:00, 15.85s/it]
Task 3, Epoch 20/20 => Loss -0.131, Train_accy 99.34, Test_accy 70.23: 100%|██████████| 20/20 [03:20<00:00, 10.02s/it]2024-09-14 21:21:15,888 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.131, Train_accy 99.34, Test_accy 70.23

2024-09-14 21:21:49,018 [trainer.py] => No NME accuracy.
2024-09-14 21:21:49,019 [trainer.py] => CNN: {'total': 70.23, '00-09': 69.98, '10-19': 63.73, '20-29': 72.99, '30-39': 77.28, 'old': 68.26, 'new': 77.28}
2024-09-14 21:21:49,019 [trainer.py] => CNN top1 curve: [97.94, 96.31, 81.85, 70.23]
2024-09-14 21:21:49,019 [trainer.py] => CNN top5 curve: [99.88, 99.68, 98.86, 97.07]

Average Accuracy (CNN): 86.58
2024-09-14 21:21:49,019 [trainer.py] => Average Accuracy (CNN): 86.58 

2024-09-14 21:21:49,022 [trainer.py] => All params: 171739492
2024-09-14 21:21:49,025 [trainer.py] => Trainable params: 84530
2024-09-14 21:21:49,025 [l2p.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.380, Train_accy 47.38:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.380, Train_accy 47.38:   5%|▌         | 1/20 [00:05<01:39,  5.25s/it]
Task 4, Epoch 2/20 => Loss 0.389, Train_accy 80.29:   5%|▌         | 1/20 [00:10<01:39,  5.25s/it]
Task 4, Epoch 2/20 => Loss 0.389, Train_accy 80.29:  10%|█         | 2/20 [00:10<01:33,  5.19s/it]
Task 4, Epoch 3/20 => Loss 0.228, Train_accy 83.91:  10%|█         | 2/20 [00:15<01:33,  5.19s/it]
Task 4, Epoch 3/20 => Loss 0.228, Train_accy 83.91:  15%|█▌        | 3/20 [00:15<01:27,  5.17s/it]
Task 4, Epoch 4/20 => Loss 0.116, Train_accy 89.15:  15%|█▌        | 3/20 [00:20<01:27,  5.17s/it]
Task 4, Epoch 4/20 => Loss 0.116, Train_accy 89.15:  20%|██        | 4/20 [00:20<01:22,  5.18s/it]
Task 4, Epoch 5/20 => Loss 0.020, Train_accy 92.22, Test_accy 65.45:  20%|██        | 4/20 [01:17<01:22,  5.18s/it]
Task 4, Epoch 5/20 => Loss 0.020, Train_accy 92.22, Test_accy 65.45:  25%|██▌       | 5/20 [01:17<05:54, 23.62s/it]
Task 4, Epoch 6/20 => Loss 0.019, Train_accy 91.14:  25%|██▌       | 5/20 [01:22<05:54, 23.62s/it]                 
Task 4, Epoch 6/20 => Loss 0.019, Train_accy 91.14:  30%|███       | 6/20 [01:22<04:05, 17.54s/it]
Task 4, Epoch 7/20 => Loss -0.012, Train_accy 93.85:  30%|███       | 6/20 [01:28<04:05, 17.54s/it]
Task 4, Epoch 7/20 => Loss -0.012, Train_accy 93.85:  35%|███▌      | 7/20 [01:28<02:57, 13.64s/it]
Task 4, Epoch 8/20 => Loss -0.025, Train_accy 94.03:  35%|███▌      | 7/20 [01:33<02:57, 13.64s/it]
Task 4, Epoch 8/20 => Loss -0.025, Train_accy 94.03:  40%|████      | 8/20 [01:33<02:12, 11.05s/it]
Task 4, Epoch 9/20 => Loss -0.019, Train_accy 93.85:  40%|████      | 8/20 [01:39<02:12, 11.05s/it]
Task 4, Epoch 9/20 => Loss -0.019, Train_accy 93.85:  45%|████▌     | 9/20 [01:39<01:42,  9.31s/it]
Task 4, Epoch 10/20 => Loss -0.053, Train_accy 94.58, Test_accy 64.66:  45%|████▌     | 9/20 [02:37<01:42,  9.31s/it]
Task 4, Epoch 10/20 => Loss -0.053, Train_accy 94.58, Test_accy 64.66:  50%|█████     | 10/20 [02:37<04:02, 24.25s/it]
Task 4, Epoch 11/20 => Loss -0.081, Train_accy 95.12:  50%|█████     | 10/20 [02:42<04:02, 24.25s/it]                 
Task 4, Epoch 11/20 => Loss -0.081, Train_accy 95.12:  55%|█████▌    | 11/20 [02:42<02:46, 18.48s/it]
Task 4, Epoch 12/20 => Loss -0.020, Train_accy 91.86:  55%|█████▌    | 11/20 [02:47<02:46, 18.48s/it]
Task 4, Epoch 12/20 => Loss -0.020, Train_accy 91.86:  60%|██████    | 12/20 [02:47<01:55, 14.42s/it]
Task 4, Epoch 13/20 => Loss -0.062, Train_accy 93.67:  60%|██████    | 12/20 [02:52<01:55, 14.42s/it]
Task 4, Epoch 13/20 => Loss -0.062, Train_accy 93.67:  65%|██████▌   | 13/20 [02:52<01:21, 11.61s/it]
Task 4, Epoch 14/20 => Loss -0.073, Train_accy 94.03:  65%|██████▌   | 13/20 [02:58<01:21, 11.61s/it]
Task 4, Epoch 14/20 => Loss -0.073, Train_accy 94.03:  70%|███████   | 14/20 [02:58<00:58,  9.70s/it]
Task 4, Epoch 15/20 => Loss -0.070, Train_accy 93.13, Test_accy 64.49:  70%|███████   | 14/20 [03:52<00:58,  9.70s/it]
Task 4, Epoch 15/20 => Loss -0.070, Train_accy 93.13, Test_accy 64.49:  75%|███████▌  | 15/20 [03:52<01:55, 23.12s/it]
Task 4, Epoch 16/20 => Loss -0.075, Train_accy 94.21:  75%|███████▌  | 15/20 [03:57<01:55, 23.12s/it]                 
Task 4, Epoch 16/20 => Loss -0.075, Train_accy 94.21:  80%|████████  | 16/20 [03:57<01:11, 17.82s/it]
Task 4, Epoch 17/20 => Loss -0.122, Train_accy 96.02:  80%|████████  | 16/20 [04:03<01:11, 17.82s/it]
Task 4, Epoch 17/20 => Loss -0.122, Train_accy 96.02:  85%|████████▌ | 17/20 [04:03<00:42, 14.11s/it]
Task 4, Epoch 18/20 => Loss -0.096, Train_accy 94.58:  85%|████████▌ | 17/20 [04:08<00:42, 14.11s/it]
Task 4, Epoch 18/20 => Loss -0.096, Train_accy 94.58:  90%|█████████ | 18/20 [04:08<00:23, 11.54s/it]
Task 4, Epoch 19/20 => Loss -0.124, Train_accy 95.30:  90%|█████████ | 18/20 [04:14<00:23, 11.54s/it]
Task 4, Epoch 19/20 => Loss -0.124, Train_accy 95.30:  95%|█████████▌| 19/20 [04:14<00:09,  9.74s/it]
Task 4, Epoch 20/20 => Loss -0.106, Train_accy 94.39, Test_accy 64.24:  95%|█████████▌| 19/20 [05:11<00:09,  9.74s/it]
Task 4, Epoch 20/20 => Loss -0.106, Train_accy 94.39, Test_accy 64.24: 100%|██████████| 20/20 [05:11<00:00, 24.01s/it]
Task 4, Epoch 20/20 => Loss -0.106, Train_accy 94.39, Test_accy 64.24: 100%|██████████| 20/20 [05:11<00:00, 15.58s/it]2024-09-14 21:27:00,693 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.106, Train_accy 94.39, Test_accy 64.24

2024-09-14 21:27:51,864 [trainer.py] => No NME accuracy.
2024-09-14 21:27:51,865 [trainer.py] => CNN: {'total': 64.24, '00-09': 65.01, '10-19': 39.83, '20-29': 54.07, '30-39': 65.2, '40-49': 86.43, 'old': 53.05, 'new': 86.43}
2024-09-14 21:27:51,865 [trainer.py] => CNN top1 curve: [97.94, 96.31, 81.85, 70.23, 64.24]
2024-09-14 21:27:51,865 [trainer.py] => CNN top5 curve: [99.88, 99.68, 98.86, 97.07, 92.64]

Average Accuracy (CNN): 82.11
2024-09-14 21:27:51,865 [trainer.py] => Average Accuracy (CNN): 82.11 

Accuracy Matrix (CNN):
[[97.94 95.04 70.7  69.98 65.01]
 [ 0.   96.83 78.43 63.73 39.83]
 [ 0.    0.   91.73 72.99 54.07]
 [ 0.    0.    0.   77.28 65.2 ]
 [ 0.    0.    0.    0.   86.43]]
2024-09-14 21:27:51,867 [trainer.py] => Forgetting (CNN): 34.917500000000004
2024-09-14 21:27:54,450 [trainer.py] => config: ./exps/l2p_vtab_B0_Inc10.json
2024-09-14 21:27:54,456 [trainer.py] => prefix:  
2024-09-14 21:27:54,457 [trainer.py] => dataset: vtab
2024-09-14 21:27:54,457 [trainer.py] => memory_size: 0
2024-09-14 21:27:54,457 [trainer.py] => memory_per_class: 0
2024-09-14 21:27:54,457 [trainer.py] => fixed_memory: False
2024-09-14 21:27:54,457 [trainer.py] => shuffle: True
2024-09-14 21:27:54,457 [trainer.py] => init_cls: 5
2024-09-14 21:27:54,457 [trainer.py] => increment: 5
2024-09-14 21:27:54,457 [trainer.py] => model_name: l2p
2024-09-14 21:27:54,457 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-14 21:27:54,457 [trainer.py] => get_original_backbone: True
2024-09-14 21:27:54,457 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 21:27:54,457 [trainer.py] => seed: 1993
2024-09-14 21:27:54,457 [trainer.py] => tuned_epoch: 20
2024-09-14 21:27:54,457 [trainer.py] => init_lr: 0.001875
2024-09-14 21:27:54,457 [trainer.py] => batch_size: 48
2024-09-14 21:27:54,457 [trainer.py] => weight_decay: 0
2024-09-14 21:27:54,457 [trainer.py] => min_lr: 1e-05
2024-09-14 21:27:54,457 [trainer.py] => optimizer: adam
2024-09-14 21:27:54,457 [trainer.py] => scheduler: constant
2024-09-14 21:27:54,457 [trainer.py] => reinit_optimizer: True
2024-09-14 21:27:54,457 [trainer.py] => global_pool: token
2024-09-14 21:27:54,458 [trainer.py] => head_type: prompt
2024-09-14 21:27:54,458 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-14 21:27:54,458 [trainer.py] => pretrained: True
2024-09-14 21:27:54,458 [trainer.py] => drop: 0.0
2024-09-14 21:27:54,458 [trainer.py] => drop_path: 0.0
2024-09-14 21:27:54,458 [trainer.py] => prompt_pool: True
2024-09-14 21:27:54,458 [trainer.py] => size: 10
2024-09-14 21:27:54,458 [trainer.py] => length: 5
2024-09-14 21:27:54,458 [trainer.py] => top_k: 5
2024-09-14 21:27:54,458 [trainer.py] => initializer: uniform
2024-09-14 21:27:54,458 [trainer.py] => prompt_key: True
2024-09-14 21:27:54,458 [trainer.py] => prompt_key_init: uniform
2024-09-14 21:27:54,458 [trainer.py] => use_prompt_mask: False
2024-09-14 21:27:54,458 [trainer.py] => shared_prompt_pool: False
2024-09-14 21:27:54,458 [trainer.py] => shared_prompt_key: False
2024-09-14 21:27:54,458 [trainer.py] => batchwise_prompt: True
2024-09-14 21:27:54,458 [trainer.py] => embedding_key: cls
2024-09-14 21:27:54,458 [trainer.py] => predefined_key: 
2024-09-14 21:27:54,458 [trainer.py] => pull_constraint: True
2024-09-14 21:27:54,458 [trainer.py] => pull_constraint_coeff: 0.1
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 21:27:54,498 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-09-14 21:27:56,603 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-14 21:27:56,603 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-14 21:27:59,052 [l2p.py] => 85,902,386 model total parameters.
2024-09-14 21:27:59,053 [l2p.py] => 84,530 model training parameters.
2024-09-14 21:27:59,053 [l2p.py] => prompt.prompt: 38400
2024-09-14 21:27:59,053 [l2p.py] => prompt.prompt_key: 7680
2024-09-14 21:27:59,053 [l2p.py] => head.weight: 38400
2024-09-14 21:27:59,053 [l2p.py] => head.bias: 50
2024-09-14 21:27:59,055 [trainer.py] => All params: 171739492
2024-09-14 21:27:59,057 [trainer.py] => Trainable params: 84530
2024-09-14 21:27:59,057 [l2p.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.112, Train_accy 27.47:   0%|          | 0/20 [00:01<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.112, Train_accy 27.47:   5%|▌         | 1/20 [00:01<00:30,  1.63s/it]
Task 0, Epoch 2/20 => Loss 1.196, Train_accy 47.25:   5%|▌         | 1/20 [00:02<00:30,  1.63s/it]
Task 0, Epoch 2/20 => Loss 1.196, Train_accy 47.25:  10%|█         | 2/20 [00:02<00:25,  1.44s/it]
Task 0, Epoch 3/20 => Loss 0.632, Train_accy 70.33:  10%|█         | 2/20 [00:04<00:25,  1.44s/it]
Task 0, Epoch 3/20 => Loss 0.632, Train_accy 70.33:  15%|█▌        | 3/20 [00:04<00:22,  1.33s/it]
Task 0, Epoch 4/20 => Loss 0.318, Train_accy 86.81:  15%|█▌        | 3/20 [00:05<00:22,  1.33s/it]
Task 0, Epoch 4/20 => Loss 0.318, Train_accy 86.81:  20%|██        | 4/20 [00:05<00:21,  1.31s/it]
Task 0, Epoch 5/20 => Loss 0.256, Train_accy 93.41, Test_accy 92.66:  20%|██        | 4/20 [00:08<00:21,  1.31s/it]
Task 0, Epoch 5/20 => Loss 0.256, Train_accy 93.41, Test_accy 92.66:  25%|██▌       | 5/20 [00:08<00:31,  2.09s/it]
Task 0, Epoch 6/20 => Loss 0.197, Train_accy 94.51:  25%|██▌       | 5/20 [00:10<00:31,  2.09s/it]                 
Task 0, Epoch 6/20 => Loss 0.197, Train_accy 94.51:  30%|███       | 6/20 [00:10<00:25,  1.84s/it]
Task 0, Epoch 7/20 => Loss 0.124, Train_accy 98.90:  30%|███       | 6/20 [00:11<00:25,  1.84s/it]
Task 0, Epoch 7/20 => Loss 0.124, Train_accy 98.90:  35%|███▌      | 7/20 [00:11<00:22,  1.72s/it]
Task 0, Epoch 8/20 => Loss 0.156, Train_accy 95.60:  35%|███▌      | 7/20 [00:13<00:22,  1.72s/it]
Task 0, Epoch 8/20 => Loss 0.156, Train_accy 95.60:  40%|████      | 8/20 [00:13<00:19,  1.60s/it]
Task 0, Epoch 9/20 => Loss 0.106, Train_accy 96.70:  40%|████      | 8/20 [00:14<00:19,  1.60s/it]
Task 0, Epoch 9/20 => Loss 0.106, Train_accy 96.70:  45%|████▌     | 9/20 [00:14<00:16,  1.51s/it]
Task 0, Epoch 10/20 => Loss 0.062, Train_accy 98.90, Test_accy 96.50:  45%|████▌     | 9/20 [00:17<00:16,  1.51s/it]
Task 0, Epoch 10/20 => Loss 0.062, Train_accy 98.90, Test_accy 96.50:  50%|█████     | 10/20 [00:17<00:21,  2.14s/it]
Task 0, Epoch 11/20 => Loss 0.056, Train_accy 97.80:  50%|█████     | 10/20 [00:19<00:21,  2.14s/it]                 
Task 0, Epoch 11/20 => Loss 0.056, Train_accy 97.80:  55%|█████▌    | 11/20 [00:19<00:16,  1.85s/it]
Task 0, Epoch 12/20 => Loss 0.069, Train_accy 97.80:  55%|█████▌    | 11/20 [00:20<00:16,  1.85s/it]
Task 0, Epoch 12/20 => Loss 0.069, Train_accy 97.80:  60%|██████    | 12/20 [00:20<00:13,  1.68s/it]
Task 0, Epoch 13/20 => Loss 0.061, Train_accy 97.80:  60%|██████    | 12/20 [00:21<00:13,  1.68s/it]
Task 0, Epoch 13/20 => Loss 0.061, Train_accy 97.80:  65%|██████▌   | 13/20 [00:21<00:11,  1.58s/it]
Task 0, Epoch 14/20 => Loss 0.079, Train_accy 98.90:  65%|██████▌   | 13/20 [00:22<00:11,  1.58s/it]
Task 0, Epoch 14/20 => Loss 0.079, Train_accy 98.90:  70%|███████   | 14/20 [00:22<00:08,  1.47s/it]
Task 0, Epoch 15/20 => Loss 0.029, Train_accy 98.90, Test_accy 96.50:  70%|███████   | 14/20 [00:26<00:08,  1.47s/it]
Task 0, Epoch 15/20 => Loss 0.029, Train_accy 98.90, Test_accy 96.50:  75%|███████▌  | 15/20 [00:26<00:10,  2.08s/it]
Task 0, Epoch 16/20 => Loss 0.048, Train_accy 98.90:  75%|███████▌  | 15/20 [00:27<00:10,  2.08s/it]                 
Task 0, Epoch 16/20 => Loss 0.048, Train_accy 98.90:  80%|████████  | 16/20 [00:27<00:07,  1.84s/it]
Task 0, Epoch 17/20 => Loss 0.019, Train_accy 100.00:  80%|████████  | 16/20 [00:29<00:07,  1.84s/it]
Task 0, Epoch 17/20 => Loss 0.019, Train_accy 100.00:  85%|████████▌ | 17/20 [00:29<00:05,  1.68s/it]
Task 0, Epoch 18/20 => Loss 0.043, Train_accy 97.80:  85%|████████▌ | 17/20 [00:30<00:05,  1.68s/it] 
Task 0, Epoch 18/20 => Loss 0.043, Train_accy 97.80:  90%|█████████ | 18/20 [00:30<00:03,  1.55s/it]
Task 0, Epoch 19/20 => Loss 0.008, Train_accy 100.00:  90%|█████████ | 18/20 [00:31<00:03,  1.55s/it]
Task 0, Epoch 19/20 => Loss 0.008, Train_accy 100.00:  95%|█████████▌| 19/20 [00:31<00:01,  1.49s/it]
Task 0, Epoch 20/20 => Loss 0.025, Train_accy 98.90, Test_accy 95.45:  95%|█████████▌| 19/20 [00:35<00:01,  1.49s/it]
Task 0, Epoch 20/20 => Loss 0.025, Train_accy 98.90, Test_accy 95.45: 100%|██████████| 20/20 [00:35<00:00,  2.10s/it]
Task 0, Epoch 20/20 => Loss 0.025, Train_accy 98.90, Test_accy 95.45: 100%|██████████| 20/20 [00:35<00:00,  1.76s/it]2024-09-14 21:28:34,881 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.025, Train_accy 98.90, Test_accy 95.45

2024-09-14 21:28:37,181 [trainer.py] => No NME accuracy.
2024-09-14 21:28:37,182 [trainer.py] => CNN: {'total': 95.45, '00-04': 95.45, 'old': 0, 'new': 95.45}
2024-09-14 21:28:37,182 [trainer.py] => CNN top1 curve: [95.45]
2024-09-14 21:28:37,182 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 95.45
2024-09-14 21:28:37,182 [trainer.py] => Average Accuracy (CNN): 95.45 

2024-09-14 21:28:37,185 [trainer.py] => All params: 171739492
2024-09-14 21:28:37,188 [trainer.py] => Trainable params: 84530
2024-09-14 21:28:37,188 [l2p.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.654, Train_accy 22.86:   0%|          | 0/20 [00:01<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.654, Train_accy 22.86:   5%|▌         | 1/20 [00:01<00:21,  1.15s/it]
Task 1, Epoch 2/20 => Loss 0.668, Train_accy 67.14:   5%|▌         | 1/20 [00:02<00:21,  1.15s/it]
Task 1, Epoch 2/20 => Loss 0.668, Train_accy 67.14:  10%|█         | 2/20 [00:02<00:20,  1.13s/it]
Task 1, Epoch 3/20 => Loss 0.190, Train_accy 98.57:  10%|█         | 2/20 [00:03<00:20,  1.13s/it]
Task 1, Epoch 3/20 => Loss 0.190, Train_accy 98.57:  15%|█▌        | 3/20 [00:03<00:18,  1.12s/it]
Task 1, Epoch 4/20 => Loss 0.093, Train_accy 98.57:  15%|█▌        | 3/20 [00:04<00:18,  1.12s/it]
Task 1, Epoch 4/20 => Loss 0.093, Train_accy 98.57:  20%|██        | 4/20 [00:04<00:17,  1.11s/it]
Task 1, Epoch 5/20 => Loss 0.164, Train_accy 94.29, Test_accy 90.44:  20%|██        | 4/20 [00:11<00:17,  1.11s/it]
Task 1, Epoch 5/20 => Loss 0.164, Train_accy 94.29, Test_accy 90.44:  25%|██▌       | 5/20 [00:11<00:46,  3.08s/it]
Task 1, Epoch 6/20 => Loss 0.025, Train_accy 97.14:  25%|██▌       | 5/20 [00:12<00:46,  3.08s/it]                 
Task 1, Epoch 6/20 => Loss 0.025, Train_accy 97.14:  30%|███       | 6/20 [00:12<00:34,  2.47s/it]
Task 1, Epoch 7/20 => Loss 0.003, Train_accy 100.00:  30%|███       | 6/20 [00:13<00:34,  2.47s/it]
Task 1, Epoch 7/20 => Loss 0.003, Train_accy 100.00:  35%|███▌      | 7/20 [00:13<00:26,  2.06s/it]
Task 1, Epoch 8/20 => Loss 0.001, Train_accy 100.00:  35%|███▌      | 7/20 [00:14<00:26,  2.06s/it]
Task 1, Epoch 8/20 => Loss 0.001, Train_accy 100.00:  40%|████      | 8/20 [00:14<00:21,  1.77s/it]
Task 1, Epoch 9/20 => Loss 0.042, Train_accy 97.14:  40%|████      | 8/20 [00:15<00:21,  1.77s/it] 
Task 1, Epoch 9/20 => Loss 0.042, Train_accy 97.14:  45%|████▌     | 9/20 [00:15<00:17,  1.59s/it]
Task 1, Epoch 10/20 => Loss 0.028, Train_accy 97.14, Test_accy 96.85:  45%|████▌     | 9/20 [00:22<00:17,  1.59s/it]
Task 1, Epoch 10/20 => Loss 0.028, Train_accy 97.14, Test_accy 96.85:  50%|█████     | 10/20 [00:22<00:32,  3.21s/it]
Task 1, Epoch 11/20 => Loss -0.011, Train_accy 98.57:  50%|█████     | 10/20 [00:23<00:32,  3.21s/it]                
Task 1, Epoch 11/20 => Loss -0.011, Train_accy 98.57:  55%|█████▌    | 11/20 [00:23<00:23,  2.57s/it]
Task 1, Epoch 12/20 => Loss 0.019, Train_accy 97.14:  55%|█████▌    | 11/20 [00:25<00:23,  2.57s/it] 
Task 1, Epoch 12/20 => Loss 0.019, Train_accy 97.14:  60%|██████    | 12/20 [00:25<00:17,  2.20s/it]
Task 1, Epoch 13/20 => Loss 0.015, Train_accy 98.57:  60%|██████    | 12/20 [00:26<00:17,  2.20s/it]
Task 1, Epoch 13/20 => Loss 0.015, Train_accy 98.57:  65%|██████▌   | 13/20 [00:26<00:13,  1.88s/it]
Task 1, Epoch 14/20 => Loss -0.013, Train_accy 100.00:  65%|██████▌   | 13/20 [00:27<00:13,  1.88s/it]
Task 1, Epoch 14/20 => Loss -0.013, Train_accy 100.00:  70%|███████   | 14/20 [00:27<00:10,  1.67s/it]
Task 1, Epoch 15/20 => Loss -0.012, Train_accy 100.00, Test_accy 97.70:  70%|███████   | 14/20 [00:34<00:10,  1.67s/it]
Task 1, Epoch 15/20 => Loss -0.012, Train_accy 100.00, Test_accy 97.70:  75%|███████▌  | 15/20 [00:34<00:16,  3.25s/it]
Task 1, Epoch 16/20 => Loss 0.009, Train_accy 97.14:  75%|███████▌  | 15/20 [00:35<00:16,  3.25s/it]                   
Task 1, Epoch 16/20 => Loss 0.009, Train_accy 97.14:  80%|████████  | 16/20 [00:35<00:10,  2.62s/it]
Task 1, Epoch 17/20 => Loss -0.030, Train_accy 100.00:  80%|████████  | 16/20 [00:36<00:10,  2.62s/it]
Task 1, Epoch 17/20 => Loss -0.030, Train_accy 100.00:  85%|████████▌ | 17/20 [00:36<00:06,  2.22s/it]
Task 1, Epoch 18/20 => Loss 0.062, Train_accy 98.57:  85%|████████▌ | 17/20 [00:38<00:06,  2.22s/it]  
Task 1, Epoch 18/20 => Loss 0.062, Train_accy 98.57:  90%|█████████ | 18/20 [00:38<00:03,  1.91s/it]
Task 1, Epoch 19/20 => Loss -0.028, Train_accy 100.00:  90%|█████████ | 18/20 [00:39<00:03,  1.91s/it]
Task 1, Epoch 19/20 => Loss -0.028, Train_accy 100.00:  95%|█████████▌| 19/20 [00:39<00:01,  1.70s/it]
Task 1, Epoch 20/20 => Loss 0.006, Train_accy 98.57, Test_accy 96.97:  95%|█████████▌| 19/20 [00:46<00:01,  1.70s/it]
Task 1, Epoch 20/20 => Loss 0.006, Train_accy 98.57, Test_accy 96.97: 100%|██████████| 20/20 [00:46<00:00,  3.22s/it]
Task 1, Epoch 20/20 => Loss 0.006, Train_accy 98.57, Test_accy 96.97: 100%|██████████| 20/20 [00:46<00:00,  2.30s/it]2024-09-14 21:29:23,237 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.006, Train_accy 98.57, Test_accy 96.97

2024-09-14 21:29:29,174 [trainer.py] => No NME accuracy.
2024-09-14 21:29:29,175 [trainer.py] => CNN: {'total': 96.97, '00-04': 91.96, '05-09': 99.63, 'old': 91.96, 'new': 99.63}
2024-09-14 21:29:29,175 [trainer.py] => CNN top1 curve: [95.45, 96.97]
2024-09-14 21:29:29,175 [trainer.py] => CNN top5 curve: [100.0, 99.39]

Average Accuracy (CNN): 96.21
2024-09-14 21:29:29,175 [trainer.py] => Average Accuracy (CNN): 96.21 

2024-09-14 21:29:29,179 [trainer.py] => All params: 171739492
2024-09-14 21:29:29,182 [trainer.py] => Trainable params: 84530
2024-09-14 21:29:29,182 [l2p.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.681, Train_accy 34.06:   0%|          | 0/20 [00:01<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.681, Train_accy 34.06:   5%|▌         | 1/20 [00:01<00:32,  1.72s/it]
Task 2, Epoch 2/20 => Loss 0.743, Train_accy 70.29:   5%|▌         | 1/20 [00:03<00:32,  1.72s/it]
Task 2, Epoch 2/20 => Loss 0.743, Train_accy 70.29:  10%|█         | 2/20 [00:03<00:31,  1.75s/it]
Task 2, Epoch 3/20 => Loss 0.291, Train_accy 88.41:  10%|█         | 2/20 [00:05<00:31,  1.75s/it]
Task 2, Epoch 3/20 => Loss 0.291, Train_accy 88.41:  15%|█▌        | 3/20 [00:05<00:30,  1.79s/it]
Task 2, Epoch 4/20 => Loss 0.140, Train_accy 97.10:  15%|█▌        | 3/20 [00:07<00:30,  1.79s/it]
Task 2, Epoch 4/20 => Loss 0.140, Train_accy 97.10:  20%|██        | 4/20 [00:07<00:28,  1.77s/it]
Task 2, Epoch 5/20 => Loss 0.052, Train_accy 100.00, Test_accy 97.01:  20%|██        | 4/20 [00:18<00:28,  1.77s/it]
Task 2, Epoch 5/20 => Loss 0.052, Train_accy 100.00, Test_accy 97.01:  25%|██▌       | 5/20 [00:18<01:16,  5.10s/it]
Task 2, Epoch 6/20 => Loss 0.097, Train_accy 97.10:  25%|██▌       | 5/20 [00:19<01:16,  5.10s/it]                  
Task 2, Epoch 6/20 => Loss 0.097, Train_accy 97.10:  30%|███       | 6/20 [00:19<00:55,  3.97s/it]
Task 2, Epoch 7/20 => Loss -0.007, Train_accy 100.00:  30%|███       | 6/20 [00:21<00:55,  3.97s/it]
Task 2, Epoch 7/20 => Loss -0.007, Train_accy 100.00:  35%|███▌      | 7/20 [00:21<00:42,  3.24s/it]
Task 2, Epoch 8/20 => Loss -0.005, Train_accy 100.00:  35%|███▌      | 7/20 [00:23<00:42,  3.24s/it]
Task 2, Epoch 8/20 => Loss -0.005, Train_accy 100.00:  40%|████      | 8/20 [00:23<00:33,  2.77s/it]
Task 2, Epoch 9/20 => Loss -0.012, Train_accy 100.00:  40%|████      | 8/20 [00:25<00:33,  2.77s/it]
Task 2, Epoch 9/20 => Loss -0.012, Train_accy 100.00:  45%|████▌     | 9/20 [00:25<00:27,  2.46s/it]
Task 2, Epoch 10/20 => Loss -0.012, Train_accy 100.00, Test_accy 96.80:  45%|████▌     | 9/20 [00:36<00:27,  2.46s/it]
Task 2, Epoch 10/20 => Loss -0.012, Train_accy 100.00, Test_accy 96.80:  50%|█████     | 10/20 [00:36<00:52,  5.20s/it]
Task 2, Epoch 11/20 => Loss 0.004, Train_accy 99.28:  50%|█████     | 10/20 [00:38<00:52,  5.20s/it]                   
Task 2, Epoch 11/20 => Loss 0.004, Train_accy 99.28:  55%|█████▌    | 11/20 [00:38<00:37,  4.13s/it]
Task 2, Epoch 12/20 => Loss -0.028, Train_accy 100.00:  55%|█████▌    | 11/20 [00:39<00:37,  4.13s/it]
Task 2, Epoch 12/20 => Loss -0.028, Train_accy 100.00:  60%|██████    | 12/20 [00:39<00:27,  3.41s/it]
Task 2, Epoch 13/20 => Loss 0.047, Train_accy 97.10:  60%|██████    | 12/20 [00:41<00:27,  3.41s/it]  
Task 2, Epoch 13/20 => Loss 0.047, Train_accy 97.10:  65%|██████▌   | 13/20 [00:41<00:20,  2.91s/it]
Task 2, Epoch 14/20 => Loss -0.002, Train_accy 98.55:  65%|██████▌   | 13/20 [00:43<00:20,  2.91s/it]
Task 2, Epoch 14/20 => Loss -0.002, Train_accy 98.55:  70%|███████   | 14/20 [00:43<00:15,  2.58s/it]
Task 2, Epoch 15/20 => Loss -0.027, Train_accy 100.00, Test_accy 97.29:  70%|███████   | 14/20 [00:54<00:15,  2.58s/it]
Task 2, Epoch 15/20 => Loss -0.027, Train_accy 100.00, Test_accy 97.29:  75%|███████▌  | 15/20 [00:54<00:26,  5.22s/it]
Task 2, Epoch 16/20 => Loss -0.011, Train_accy 99.28:  75%|███████▌  | 15/20 [00:56<00:26,  5.22s/it]                  
Task 2, Epoch 16/20 => Loss -0.011, Train_accy 99.28:  80%|████████  | 16/20 [00:56<00:16,  4.16s/it]
Task 2, Epoch 17/20 => Loss -0.021, Train_accy 98.55:  80%|████████  | 16/20 [00:58<00:16,  4.16s/it]
Task 2, Epoch 17/20 => Loss -0.021, Train_accy 98.55:  85%|████████▌ | 17/20 [00:58<00:10,  3.47s/it]
Task 2, Epoch 18/20 => Loss -0.026, Train_accy 99.28:  85%|████████▌ | 17/20 [01:00<00:10,  3.47s/it]
Task 2, Epoch 18/20 => Loss -0.026, Train_accy 99.28:  90%|█████████ | 18/20 [01:00<00:05,  2.92s/it]
Task 2, Epoch 19/20 => Loss -0.034, Train_accy 100.00:  90%|█████████ | 18/20 [01:01<00:05,  2.92s/it]
Task 2, Epoch 19/20 => Loss -0.034, Train_accy 100.00:  95%|█████████▌| 19/20 [01:01<00:02,  2.58s/it]
Task 2, Epoch 20/20 => Loss 0.016, Train_accy 98.55, Test_accy 97.29:  95%|█████████▌| 19/20 [01:13<00:02,  2.58s/it]
Task 2, Epoch 20/20 => Loss 0.016, Train_accy 98.55, Test_accy 97.29: 100%|██████████| 20/20 [01:13<00:00,  5.20s/it]
Task 2, Epoch 20/20 => Loss 0.016, Train_accy 98.55, Test_accy 97.29: 100%|██████████| 20/20 [01:13<00:00,  3.66s/it]2024-09-14 21:30:42,343 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.016, Train_accy 98.55, Test_accy 97.29

2024-09-14 21:30:50,987 [trainer.py] => No NME accuracy.
2024-09-14 21:30:50,987 [trainer.py] => CNN: {'total': 97.29, '00-04': 88.46, '05-09': 99.44, '10-14': 99.51, 'old': 95.64, 'new': 99.51}
2024-09-14 21:30:50,987 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29]
2024-09-14 21:30:50,988 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58]

Average Accuracy (CNN): 96.57
2024-09-14 21:30:50,988 [trainer.py] => Average Accuracy (CNN): 96.57 

2024-09-14 21:30:50,990 [trainer.py] => All params: 171739492
2024-09-14 21:30:50,992 [trainer.py] => Trainable params: 84530
2024-09-14 21:30:50,992 [l2p.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.467, Train_accy 45.29:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.467, Train_accy 45.29:   5%|▌         | 1/20 [00:02<00:53,  2.80s/it]
Task 3, Epoch 2/20 => Loss 0.660, Train_accy 78.62:   5%|▌         | 1/20 [00:05<00:53,  2.80s/it]
Task 3, Epoch 2/20 => Loss 0.660, Train_accy 78.62:  10%|█         | 2/20 [00:05<00:49,  2.77s/it]
Task 3, Epoch 3/20 => Loss 0.341, Train_accy 85.87:  10%|█         | 2/20 [00:08<00:49,  2.77s/it]
Task 3, Epoch 3/20 => Loss 0.341, Train_accy 85.87:  15%|█▌        | 3/20 [00:08<00:46,  2.76s/it]
Task 3, Epoch 4/20 => Loss 0.269, Train_accy 90.58:  15%|█▌        | 3/20 [00:11<00:46,  2.76s/it]
Task 3, Epoch 4/20 => Loss 0.269, Train_accy 90.58:  20%|██        | 4/20 [00:11<00:44,  2.75s/it]
Task 3, Epoch 5/20 => Loss 0.237, Train_accy 90.58, Test_accy 89.32:  20%|██        | 4/20 [00:30<00:44,  2.75s/it]
Task 3, Epoch 5/20 => Loss 0.237, Train_accy 90.58, Test_accy 89.32:  25%|██▌       | 5/20 [00:30<02:13,  8.91s/it]
Task 3, Epoch 6/20 => Loss 0.237, Train_accy 90.94:  25%|██▌       | 5/20 [00:33<02:13,  8.91s/it]                 
Task 3, Epoch 6/20 => Loss 0.237, Train_accy 90.94:  30%|███       | 6/20 [00:33<01:35,  6.80s/it]
Task 3, Epoch 7/20 => Loss 0.149, Train_accy 93.84:  30%|███       | 6/20 [00:36<01:35,  6.80s/it]
Task 3, Epoch 7/20 => Loss 0.149, Train_accy 93.84:  35%|███▌      | 7/20 [00:36<01:11,  5.47s/it]
Task 3, Epoch 8/20 => Loss 0.134, Train_accy 92.75:  35%|███▌      | 7/20 [00:39<01:11,  5.47s/it]
Task 3, Epoch 8/20 => Loss 0.134, Train_accy 92.75:  40%|████      | 8/20 [00:39<00:55,  4.62s/it]
Task 3, Epoch 9/20 => Loss 0.096, Train_accy 95.29:  40%|████      | 8/20 [00:41<00:55,  4.62s/it]
Task 3, Epoch 9/20 => Loss 0.096, Train_accy 95.29:  45%|████▌     | 9/20 [00:41<00:44,  4.02s/it]
Task 3, Epoch 10/20 => Loss 0.071, Train_accy 96.38, Test_accy 93.47:  45%|████▌     | 9/20 [01:01<00:44,  4.02s/it]
Task 3, Epoch 10/20 => Loss 0.071, Train_accy 96.38, Test_accy 93.47:  50%|█████     | 10/20 [01:01<01:27,  8.74s/it]
Task 3, Epoch 11/20 => Loss 0.059, Train_accy 95.65:  50%|█████     | 10/20 [01:03<01:27,  8.74s/it]                 
Task 3, Epoch 11/20 => Loss 0.059, Train_accy 95.65:  55%|█████▌    | 11/20 [01:03<01:02,  6.91s/it]
Task 3, Epoch 12/20 => Loss 0.050, Train_accy 96.38:  55%|█████▌    | 11/20 [01:06<01:02,  6.91s/it]
Task 3, Epoch 12/20 => Loss 0.050, Train_accy 96.38:  60%|██████    | 12/20 [01:06<00:45,  5.73s/it]
Task 3, Epoch 13/20 => Loss 0.082, Train_accy 94.93:  60%|██████    | 12/20 [01:09<00:45,  5.73s/it]
Task 3, Epoch 13/20 => Loss 0.082, Train_accy 94.93:  65%|██████▌   | 13/20 [01:09<00:34,  4.87s/it]
Task 3, Epoch 14/20 => Loss 0.081, Train_accy 94.93:  65%|██████▌   | 13/20 [01:12<00:34,  4.87s/it]
Task 3, Epoch 14/20 => Loss 0.081, Train_accy 94.93:  70%|███████   | 14/20 [01:12<00:25,  4.28s/it]
Task 3, Epoch 15/20 => Loss 0.058, Train_accy 95.65, Test_accy 93.05:  70%|███████   | 14/20 [01:33<00:25,  4.28s/it]
Task 3, Epoch 15/20 => Loss 0.058, Train_accy 95.65, Test_accy 93.05:  75%|███████▌  | 15/20 [01:33<00:46,  9.27s/it]
Task 3, Epoch 16/20 => Loss 0.035, Train_accy 96.74:  75%|███████▌  | 15/20 [01:36<00:46,  9.27s/it]                 
Task 3, Epoch 16/20 => Loss 0.035, Train_accy 96.74:  80%|████████  | 16/20 [01:36<00:29,  7.39s/it]
Task 3, Epoch 17/20 => Loss 0.019, Train_accy 97.10:  80%|████████  | 16/20 [01:39<00:29,  7.39s/it]
Task 3, Epoch 17/20 => Loss 0.019, Train_accy 97.10:  85%|████████▌ | 17/20 [01:39<00:18,  6.06s/it]
Task 3, Epoch 18/20 => Loss -0.010, Train_accy 98.19:  85%|████████▌ | 17/20 [01:42<00:18,  6.06s/it]
Task 3, Epoch 18/20 => Loss -0.010, Train_accy 98.19:  90%|█████████ | 18/20 [01:42<00:10,  5.11s/it]
Task 3, Epoch 19/20 => Loss -0.005, Train_accy 97.10:  90%|█████████ | 18/20 [01:45<00:10,  5.11s/it]
Task 3, Epoch 19/20 => Loss -0.005, Train_accy 97.10:  95%|█████████▌| 19/20 [01:45<00:04,  4.47s/it]
Task 3, Epoch 20/20 => Loss -0.029, Train_accy 98.91, Test_accy 93.64:  95%|█████████▌| 19/20 [02:06<00:04,  4.47s/it]
Task 3, Epoch 20/20 => Loss -0.029, Train_accy 98.91, Test_accy 93.64: 100%|██████████| 20/20 [02:06<00:00,  9.38s/it]
Task 3, Epoch 20/20 => Loss -0.029, Train_accy 98.91, Test_accy 93.64: 100%|██████████| 20/20 [02:06<00:00,  6.31s/it]2024-09-14 21:32:57,235 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.029, Train_accy 98.91, Test_accy 93.64

2024-09-14 21:33:14,946 [trainer.py] => No NME accuracy.
2024-09-14 21:33:14,947 [trainer.py] => CNN: {'total': 93.64, '00-04': 87.41, '05-09': 99.26, '10-14': 95.1, '15-19': 92.12, 'old': 95.13, 'new': 92.12}
2024-09-14 21:33:14,947 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29, 93.64]
2024-09-14 21:33:14,947 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.51]

Average Accuracy (CNN): 95.84
2024-09-14 21:33:14,947 [trainer.py] => Average Accuracy (CNN): 95.84 

2024-09-14 21:33:14,949 [trainer.py] => All params: 171739492
2024-09-14 21:33:14,950 [trainer.py] => Trainable params: 84530
2024-09-14 21:33:14,950 [l2p.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.539, Train_accy 40.80:   0%|          | 0/20 [00:02<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.539, Train_accy 40.80:   5%|▌         | 1/20 [00:02<00:55,  2.90s/it]
Task 4, Epoch 2/20 => Loss 0.944, Train_accy 58.00:   5%|▌         | 1/20 [00:05<00:55,  2.90s/it]
Task 4, Epoch 2/20 => Loss 0.944, Train_accy 58.00:  10%|█         | 2/20 [00:05<00:50,  2.79s/it]
Task 4, Epoch 3/20 => Loss 0.543, Train_accy 75.60:  10%|█         | 2/20 [00:08<00:50,  2.79s/it]
Task 4, Epoch 3/20 => Loss 0.543, Train_accy 75.60:  15%|█▌        | 3/20 [00:08<00:46,  2.75s/it]
Task 4, Epoch 4/20 => Loss 0.342, Train_accy 80.80:  15%|█▌        | 3/20 [00:11<00:46,  2.75s/it]
Task 4, Epoch 4/20 => Loss 0.342, Train_accy 80.80:  20%|██        | 4/20 [00:11<00:44,  2.75s/it]
Task 4, Epoch 5/20 => Loss 0.232, Train_accy 84.80, Test_accy 78.69:  20%|██        | 4/20 [00:38<00:44,  2.75s/it]
Task 4, Epoch 5/20 => Loss 0.232, Train_accy 84.80, Test_accy 78.69:  25%|██▌       | 5/20 [00:38<02:56, 11.74s/it]
Task 4, Epoch 6/20 => Loss 0.137, Train_accy 88.80:  25%|██▌       | 5/20 [00:41<02:56, 11.74s/it]                 
Task 4, Epoch 6/20 => Loss 0.137, Train_accy 88.80:  30%|███       | 6/20 [00:41<02:00,  8.63s/it]
Task 4, Epoch 7/20 => Loss 0.114, Train_accy 94.00:  30%|███       | 6/20 [00:43<02:00,  8.63s/it]
Task 4, Epoch 7/20 => Loss 0.114, Train_accy 94.00:  35%|███▌      | 7/20 [00:43<01:26,  6.65s/it]
Task 4, Epoch 8/20 => Loss 0.118, Train_accy 93.60:  35%|███▌      | 7/20 [00:46<01:26,  6.65s/it]
Task 4, Epoch 8/20 => Loss 0.118, Train_accy 93.60:  40%|████      | 8/20 [00:46<01:04,  5.36s/it]
Task 4, Epoch 9/20 => Loss 0.096, Train_accy 94.00:  40%|████      | 8/20 [00:49<01:04,  5.36s/it]
Task 4, Epoch 9/20 => Loss 0.096, Train_accy 94.00:  45%|████▌     | 9/20 [00:49<00:49,  4.50s/it]
Task 4, Epoch 10/20 => Loss 0.059, Train_accy 96.00, Test_accy 79.08:  45%|████▌     | 9/20 [01:15<00:49,  4.50s/it]
Task 4, Epoch 10/20 => Loss 0.059, Train_accy 96.00, Test_accy 79.08:  50%|█████     | 10/20 [01:15<01:52, 11.28s/it]
Task 4, Epoch 11/20 => Loss 0.025, Train_accy 95.20:  50%|█████     | 10/20 [01:18<01:52, 11.28s/it]                 
Task 4, Epoch 11/20 => Loss 0.025, Train_accy 95.20:  55%|█████▌    | 11/20 [01:18<01:17,  8.62s/it]
Task 4, Epoch 12/20 => Loss 0.035, Train_accy 95.60:  55%|█████▌    | 11/20 [01:20<01:17,  8.62s/it]
Task 4, Epoch 12/20 => Loss 0.035, Train_accy 95.60:  60%|██████    | 12/20 [01:20<00:54,  6.78s/it]
Task 4, Epoch 13/20 => Loss 0.040, Train_accy 93.60:  60%|██████    | 12/20 [01:23<00:54,  6.78s/it]
Task 4, Epoch 13/20 => Loss 0.040, Train_accy 93.60:  65%|██████▌   | 13/20 [01:23<00:38,  5.51s/it]
Task 4, Epoch 14/20 => Loss 0.036, Train_accy 93.20:  65%|██████▌   | 13/20 [01:25<00:38,  5.51s/it]
Task 4, Epoch 14/20 => Loss 0.036, Train_accy 93.20:  70%|███████   | 14/20 [01:25<00:27,  4.63s/it]
Task 4, Epoch 15/20 => Loss -0.016, Train_accy 97.20, Test_accy 77.94:  70%|███████   | 14/20 [01:52<00:27,  4.63s/it]
Task 4, Epoch 15/20 => Loss -0.016, Train_accy 97.20, Test_accy 77.94:  75%|███████▌  | 15/20 [01:52<00:56, 11.20s/it]
Task 4, Epoch 16/20 => Loss -0.023, Train_accy 96.80:  75%|███████▌  | 15/20 [01:54<00:56, 11.20s/it]                 
Task 4, Epoch 16/20 => Loss -0.023, Train_accy 96.80:  80%|████████  | 16/20 [01:54<00:34,  8.62s/it]
Task 4, Epoch 17/20 => Loss -0.016, Train_accy 96.00:  80%|████████  | 16/20 [01:57<00:34,  8.62s/it]
Task 4, Epoch 17/20 => Loss -0.016, Train_accy 96.00:  85%|████████▌ | 17/20 [01:57<00:20,  6.83s/it]
Task 4, Epoch 18/20 => Loss -0.024, Train_accy 97.60:  85%|████████▌ | 17/20 [02:00<00:20,  6.83s/it]
Task 4, Epoch 18/20 => Loss -0.024, Train_accy 97.60:  90%|█████████ | 18/20 [02:00<00:11,  5.57s/it]
Task 4, Epoch 19/20 => Loss -0.048, Train_accy 97.60:  90%|█████████ | 18/20 [02:03<00:11,  5.57s/it]
Task 4, Epoch 19/20 => Loss -0.048, Train_accy 97.60:  95%|█████████▌| 19/20 [02:03<00:04,  4.71s/it]
Task 4, Epoch 20/20 => Loss -0.039, Train_accy 96.40, Test_accy 78.64:  95%|█████████▌| 19/20 [02:30<00:04,  4.71s/it]
Task 4, Epoch 20/20 => Loss -0.039, Train_accy 96.40, Test_accy 78.64: 100%|██████████| 20/20 [02:30<00:00, 11.66s/it]
Task 4, Epoch 20/20 => Loss -0.039, Train_accy 96.40, Test_accy 78.64: 100%|██████████| 20/20 [02:30<00:00,  7.54s/it]2024-09-14 21:35:45,828 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.039, Train_accy 96.40, Test_accy 78.64

2024-09-14 21:36:12,261 [trainer.py] => No NME accuracy.
2024-09-14 21:36:12,262 [trainer.py] => CNN: {'total': 78.64, '00-04': 80.42, '05-09': 80.56, '10-14': 68.3, '15-19': 70.33, '20-24': 91.79, 'old': 72.85, 'new': 91.79}
2024-09-14 21:36:12,262 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29, 93.64, 78.64]
2024-09-14 21:36:12,262 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.51, 98.1]

Average Accuracy (CNN): 92.4
2024-09-14 21:36:12,262 [trainer.py] => Average Accuracy (CNN): 92.4 

2024-09-14 21:36:12,264 [trainer.py] => All params: 171739492
2024-09-14 21:36:12,265 [trainer.py] => Trainable params: 84530
2024-09-14 21:36:12,265 [l2p.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.563, Train_accy 29.57:   0%|          | 0/20 [00:02<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.563, Train_accy 29.57:   5%|▌         | 1/20 [00:02<00:44,  2.34s/it]
Task 5, Epoch 2/20 => Loss 0.265, Train_accy 93.04:   5%|▌         | 1/20 [00:03<00:44,  2.34s/it]
Task 5, Epoch 2/20 => Loss 0.265, Train_accy 93.04:  10%|█         | 2/20 [00:03<00:34,  1.90s/it]
Task 5, Epoch 3/20 => Loss 0.022, Train_accy 100.00:  10%|█         | 2/20 [00:05<00:34,  1.90s/it]
Task 5, Epoch 3/20 => Loss 0.022, Train_accy 100.00:  15%|█▌        | 3/20 [00:05<00:30,  1.80s/it]
Task 5, Epoch 4/20 => Loss 0.009, Train_accy 96.52:  15%|█▌        | 3/20 [00:07<00:30,  1.80s/it] 
Task 5, Epoch 4/20 => Loss 0.009, Train_accy 96.52:  20%|██        | 4/20 [00:07<00:27,  1.73s/it]
Task 5, Epoch 5/20 => Loss 0.017, Train_accy 99.13, Test_accy 73.71:  20%|██        | 4/20 [00:36<00:27,  1.73s/it]
Task 5, Epoch 5/20 => Loss 0.017, Train_accy 99.13, Test_accy 73.71:  25%|██▌       | 5/20 [00:36<02:55, 11.67s/it]
Task 5, Epoch 6/20 => Loss -0.057, Train_accy 100.00:  25%|██▌       | 5/20 [00:38<02:55, 11.67s/it]               
Task 5, Epoch 6/20 => Loss -0.057, Train_accy 100.00:  30%|███       | 6/20 [00:38<01:55,  8.24s/it]
Task 5, Epoch 7/20 => Loss -0.015, Train_accy 97.39:  30%|███       | 6/20 [00:39<01:55,  8.24s/it] 
Task 5, Epoch 7/20 => Loss -0.015, Train_accy 97.39:  35%|███▌      | 7/20 [00:39<01:19,  6.08s/it]
Task 5, Epoch 8/20 => Loss 0.045, Train_accy 95.65:  35%|███▌      | 7/20 [00:41<01:19,  6.08s/it] 
Task 5, Epoch 8/20 => Loss 0.045, Train_accy 95.65:  40%|████      | 8/20 [00:41<00:55,  4.63s/it]
Task 5, Epoch 9/20 => Loss -0.030, Train_accy 98.26:  40%|████      | 8/20 [00:42<00:55,  4.63s/it]
Task 5, Epoch 9/20 => Loss -0.030, Train_accy 98.26:  45%|████▌     | 9/20 [00:42<00:40,  3.68s/it]
Task 5, Epoch 10/20 => Loss -0.050, Train_accy 99.13, Test_accy 76.63:  45%|████▌     | 9/20 [01:10<00:40,  3.68s/it]
Task 5, Epoch 10/20 => Loss -0.050, Train_accy 99.13, Test_accy 76.63:  50%|█████     | 10/20 [01:10<01:50, 11.06s/it]
Task 5, Epoch 11/20 => Loss -0.074, Train_accy 100.00:  50%|█████     | 10/20 [01:12<01:50, 11.06s/it]                
Task 5, Epoch 11/20 => Loss -0.074, Train_accy 100.00:  55%|█████▌    | 11/20 [01:12<01:13,  8.18s/it]
Task 5, Epoch 12/20 => Loss -0.058, Train_accy 99.13:  55%|█████▌    | 11/20 [01:13<01:13,  8.18s/it] 
Task 5, Epoch 12/20 => Loss -0.058, Train_accy 99.13:  60%|██████    | 12/20 [01:13<00:49,  6.14s/it]
Task 5, Epoch 13/20 => Loss -0.072, Train_accy 100.00:  60%|██████    | 12/20 [01:15<00:49,  6.14s/it]
Task 5, Epoch 13/20 => Loss -0.072, Train_accy 100.00:  65%|██████▌   | 13/20 [01:15<00:33,  4.74s/it]
Task 5, Epoch 14/20 => Loss -0.016, Train_accy 95.65:  65%|██████▌   | 13/20 [01:16<00:33,  4.74s/it] 
Task 5, Epoch 14/20 => Loss -0.016, Train_accy 95.65:  70%|███████   | 14/20 [01:16<00:22,  3.74s/it]
Task 5, Epoch 15/20 => Loss -0.067, Train_accy 99.13, Test_accy 77.52:  70%|███████   | 14/20 [01:44<00:22,  3.74s/it]
Task 5, Epoch 15/20 => Loss -0.067, Train_accy 99.13, Test_accy 77.52:  75%|███████▌  | 15/20 [01:44<00:54, 10.92s/it]
Task 5, Epoch 16/20 => Loss -0.080, Train_accy 100.00:  75%|███████▌  | 15/20 [01:45<00:54, 10.92s/it]                
Task 5, Epoch 16/20 => Loss -0.080, Train_accy 100.00:  80%|████████  | 16/20 [01:45<00:32,  8.18s/it]
Task 5, Epoch 17/20 => Loss -0.055, Train_accy 98.26:  80%|████████  | 16/20 [01:47<00:32,  8.18s/it] 
Task 5, Epoch 17/20 => Loss -0.055, Train_accy 98.26:  85%|████████▌ | 17/20 [01:47<00:18,  6.19s/it]
Task 5, Epoch 18/20 => Loss -0.064, Train_accy 100.00:  85%|████████▌ | 17/20 [01:48<00:18,  6.19s/it]
Task 5, Epoch 18/20 => Loss -0.064, Train_accy 100.00:  90%|█████████ | 18/20 [01:48<00:09,  4.78s/it]
Task 5, Epoch 19/20 => Loss -0.047, Train_accy 98.26:  90%|█████████ | 18/20 [01:50<00:09,  4.78s/it] 
Task 5, Epoch 19/20 => Loss -0.047, Train_accy 98.26:  95%|█████████▌| 19/20 [01:50<00:03,  3.82s/it]
Task 5, Epoch 20/20 => Loss -0.054, Train_accy 99.13, Test_accy 77.25:  95%|█████████▌| 19/20 [02:18<00:03,  3.82s/it]
Task 5, Epoch 20/20 => Loss -0.054, Train_accy 99.13, Test_accy 77.25: 100%|██████████| 20/20 [02:18<00:00, 11.03s/it]
Task 5, Epoch 20/20 => Loss -0.054, Train_accy 99.13, Test_accy 77.25: 100%|██████████| 20/20 [02:18<00:00,  6.92s/it]2024-09-14 21:38:30,662 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.054, Train_accy 99.13, Test_accy 77.25

2024-09-14 21:38:58,164 [trainer.py] => No NME accuracy.
2024-09-14 21:38:58,165 [trainer.py] => CNN: {'total': 77.25, '00-04': 52.45, '05-09': 80.56, '10-14': 67.48, '15-19': 69.77, '20-24': 91.55, '25-29': 87.57, 'old': 76.3, 'new': 87.57}
2024-09-14 21:38:58,165 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29, 93.64, 78.64, 77.25]
2024-09-14 21:38:58,165 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.51, 98.1, 97.75]

Average Accuracy (CNN): 89.87
2024-09-14 21:38:58,166 [trainer.py] => Average Accuracy (CNN): 89.87 

2024-09-14 21:38:58,167 [trainer.py] => All params: 171739492
2024-09-14 21:38:58,168 [trainer.py] => Trainable params: 84530
2024-09-14 21:38:58,168 [l2p.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.512, Train_accy 45.98:   0%|          | 0/20 [00:02<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.512, Train_accy 45.98:   5%|▌         | 1/20 [00:02<00:55,  2.90s/it]
Task 6, Epoch 2/20 => Loss 0.447, Train_accy 86.78:   5%|▌         | 1/20 [00:05<00:55,  2.90s/it]
Task 6, Epoch 2/20 => Loss 0.447, Train_accy 86.78:  10%|█         | 2/20 [00:05<00:44,  2.46s/it]
Task 6, Epoch 3/20 => Loss 0.120, Train_accy 90.23:  10%|█         | 2/20 [00:07<00:44,  2.46s/it]
Task 6, Epoch 3/20 => Loss 0.120, Train_accy 90.23:  15%|█▌        | 3/20 [00:07<00:39,  2.31s/it]
Task 6, Epoch 4/20 => Loss -0.079, Train_accy 98.85:  15%|█▌        | 3/20 [00:09<00:39,  2.31s/it]
Task 6, Epoch 4/20 => Loss -0.079, Train_accy 98.85:  20%|██        | 4/20 [00:09<00:35,  2.23s/it]
Task 6, Epoch 5/20 => Loss -0.032, Train_accy 97.13, Test_accy 66.19:  20%|██        | 4/20 [00:48<00:35,  2.23s/it]
Task 6, Epoch 5/20 => Loss -0.032, Train_accy 97.13, Test_accy 66.19:  25%|██▌       | 5/20 [00:48<03:54, 15.65s/it]
Task 6, Epoch 6/20 => Loss -0.101, Train_accy 99.43:  25%|██▌       | 5/20 [00:52<03:54, 15.65s/it]                 
Task 6, Epoch 6/20 => Loss -0.101, Train_accy 99.43:  30%|███       | 6/20 [00:52<02:42, 11.59s/it]
Task 6, Epoch 7/20 => Loss -0.086, Train_accy 98.28:  30%|███       | 6/20 [01:05<02:42, 11.59s/it]
Task 6, Epoch 7/20 => Loss -0.086, Train_accy 98.28:  35%|███▌      | 7/20 [01:06<02:40, 12.31s/it]
Task 6, Epoch 8/20 => Loss -0.095, Train_accy 100.00:  35%|███▌      | 7/20 [01:10<02:40, 12.31s/it]
Task 6, Epoch 8/20 => Loss -0.095, Train_accy 100.00:  40%|████      | 8/20 [01:10<01:57,  9.79s/it]
Task 6, Epoch 9/20 => Loss -0.102, Train_accy 98.85:  40%|████      | 8/20 [01:12<01:57,  9.79s/it] 
Task 6, Epoch 9/20 => Loss -0.102, Train_accy 98.85:  45%|████▌     | 9/20 [01:12<01:21,  7.39s/it]
Task 6, Epoch 10/20 => Loss -0.096, Train_accy 99.43, Test_accy 66.09:  45%|████▌     | 9/20 [01:46<01:21,  7.39s/it]
Task 6, Epoch 10/20 => Loss -0.096, Train_accy 99.43, Test_accy 66.09:  50%|█████     | 10/20 [01:46<02:34, 15.46s/it]
Task 6, Epoch 11/20 => Loss -0.115, Train_accy 98.85:  50%|█████     | 10/20 [01:48<02:34, 15.46s/it]                 
Task 6, Epoch 11/20 => Loss -0.115, Train_accy 98.85:  55%|█████▌    | 11/20 [01:48<01:42, 11.36s/it]
Task 6, Epoch 12/20 => Loss -0.107, Train_accy 98.85:  55%|█████▌    | 11/20 [01:50<01:42, 11.36s/it]
Task 6, Epoch 12/20 => Loss -0.107, Train_accy 98.85:  60%|██████    | 12/20 [01:50<01:07,  8.48s/it]
Task 6, Epoch 13/20 => Loss -0.124, Train_accy 100.00:  60%|██████    | 12/20 [01:52<01:07,  8.48s/it]
Task 6, Epoch 13/20 => Loss -0.124, Train_accy 100.00:  65%|██████▌   | 13/20 [01:52<00:45,  6.50s/it]
Task 6, Epoch 14/20 => Loss -0.126, Train_accy 100.00:  65%|██████▌   | 13/20 [01:54<00:45,  6.50s/it]
Task 6, Epoch 14/20 => Loss -0.126, Train_accy 100.00:  70%|███████   | 14/20 [01:54<00:30,  5.10s/it]
Task 6, Epoch 15/20 => Loss -0.127, Train_accy 100.00, Test_accy 64.47:  70%|███████   | 14/20 [02:26<00:30,  5.10s/it]
Task 6, Epoch 15/20 => Loss -0.127, Train_accy 100.00, Test_accy 64.47:  75%|███████▌  | 15/20 [02:26<01:07, 13.42s/it]
Task 6, Epoch 16/20 => Loss -0.105, Train_accy 98.85:  75%|███████▌  | 15/20 [02:28<01:07, 13.42s/it]                  
Task 6, Epoch 16/20 => Loss -0.105, Train_accy 98.85:  80%|████████  | 16/20 [02:28<00:39,  9.97s/it]
Task 6, Epoch 17/20 => Loss -0.134, Train_accy 100.00:  80%|████████  | 16/20 [02:30<00:39,  9.97s/it]
Task 6, Epoch 17/20 => Loss -0.134, Train_accy 100.00:  85%|████████▌ | 17/20 [02:30<00:22,  7.59s/it]
Task 6, Epoch 18/20 => Loss -0.134, Train_accy 100.00:  85%|████████▌ | 17/20 [02:32<00:22,  7.59s/it]
Task 6, Epoch 18/20 => Loss -0.134, Train_accy 100.00:  90%|█████████ | 18/20 [02:32<00:11,  5.87s/it]
Task 6, Epoch 19/20 => Loss -0.138, Train_accy 100.00:  90%|█████████ | 18/20 [02:34<00:11,  5.87s/it]
Task 6, Epoch 19/20 => Loss -0.138, Train_accy 100.00:  95%|█████████▌| 19/20 [02:34<00:04,  4.67s/it]
Task 6, Epoch 20/20 => Loss -0.099, Train_accy 98.85, Test_accy 63.41:  95%|█████████▌| 19/20 [03:07<00:04,  4.67s/it]
Task 6, Epoch 20/20 => Loss -0.099, Train_accy 98.85, Test_accy 63.41: 100%|██████████| 20/20 [03:07<00:00, 13.31s/it]
Task 6, Epoch 20/20 => Loss -0.099, Train_accy 98.85, Test_accy 63.41: 100%|██████████| 20/20 [03:07<00:00,  9.40s/it]2024-09-14 21:42:06,100 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.099, Train_accy 98.85, Test_accy 63.41

2024-09-14 21:42:38,740 [trainer.py] => No NME accuracy.
2024-09-14 21:42:38,741 [trainer.py] => CNN: {'total': 63.41, '00-04': 50.35, '05-09': 80.37, '10-14': 38.89, '15-19': 55.36, '20-24': 52.91, '25-29': 79.37, '30-34': 98.03, 'old': 57.14, 'new': 98.03}
2024-09-14 21:42:38,741 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29, 93.64, 78.64, 77.25, 63.41]
2024-09-14 21:42:38,741 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.51, 98.1, 97.75, 97.45]

Average Accuracy (CNN): 86.09
2024-09-14 21:42:38,741 [trainer.py] => Average Accuracy (CNN): 86.09 

2024-09-14 21:42:38,744 [trainer.py] => All params: 171739492
2024-09-14 21:42:38,746 [trainer.py] => Trainable params: 84530
2024-09-14 21:42:38,746 [l2p.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.319, Train_accy 48.84:   0%|          | 0/20 [00:01<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.319, Train_accy 48.84:   5%|▌         | 1/20 [00:01<00:36,  1.93s/it]
Task 7, Epoch 2/20 => Loss 0.244, Train_accy 89.92:   5%|▌         | 1/20 [00:03<00:36,  1.93s/it]
Task 7, Epoch 2/20 => Loss 0.244, Train_accy 89.92:  10%|█         | 2/20 [00:03<00:32,  1.79s/it]
Task 7, Epoch 3/20 => Loss 0.108, Train_accy 91.47:  10%|█         | 2/20 [00:05<00:32,  1.79s/it]
Task 7, Epoch 3/20 => Loss 0.108, Train_accy 91.47:  15%|█▌        | 3/20 [00:05<00:28,  1.70s/it]
Task 7, Epoch 4/20 => Loss 0.001, Train_accy 95.35:  15%|█▌        | 3/20 [00:06<00:28,  1.70s/it]
Task 7, Epoch 4/20 => Loss 0.001, Train_accy 95.35:  20%|██        | 4/20 [00:06<00:27,  1.70s/it]
Task 7, Epoch 5/20 => Loss -0.049, Train_accy 97.67, Test_accy 58.53:  20%|██        | 4/20 [00:43<00:27,  1.70s/it]
Task 7, Epoch 5/20 => Loss -0.049, Train_accy 97.67, Test_accy 58.53:  25%|██▌       | 5/20 [00:43<03:35, 14.34s/it]
Task 7, Epoch 6/20 => Loss -0.078, Train_accy 97.67:  25%|██▌       | 5/20 [00:45<03:35, 14.34s/it]                 
Task 7, Epoch 6/20 => Loss -0.078, Train_accy 97.67:  30%|███       | 6/20 [00:45<02:20, 10.04s/it]
Task 7, Epoch 7/20 => Loss -0.017, Train_accy 95.35:  30%|███       | 6/20 [00:47<02:20, 10.04s/it]
Task 7, Epoch 7/20 => Loss -0.017, Train_accy 95.35:  35%|███▌      | 7/20 [00:47<01:35,  7.35s/it]
Task 7, Epoch 8/20 => Loss -0.034, Train_accy 97.67:  35%|███▌      | 7/20 [00:48<01:35,  7.35s/it]
Task 7, Epoch 8/20 => Loss -0.034, Train_accy 97.67:  40%|████      | 8/20 [00:48<01:06,  5.53s/it]
Task 7, Epoch 9/20 => Loss -0.068, Train_accy 97.67:  40%|████      | 8/20 [00:50<01:06,  5.53s/it]
Task 7, Epoch 9/20 => Loss -0.068, Train_accy 97.67:  45%|████▌     | 9/20 [00:50<00:47,  4.32s/it]
Task 7, Epoch 10/20 => Loss -0.089, Train_accy 97.67, Test_accy 61.31:  45%|████▌     | 9/20 [01:24<00:47,  4.32s/it]
Task 7, Epoch 10/20 => Loss -0.089, Train_accy 97.67, Test_accy 61.31:  50%|█████     | 10/20 [01:24<02:16, 13.63s/it]
Task 7, Epoch 11/20 => Loss -0.075, Train_accy 98.45:  50%|█████     | 10/20 [01:26<02:16, 13.63s/it]                 
Task 7, Epoch 11/20 => Loss -0.075, Train_accy 98.45:  55%|█████▌    | 11/20 [01:26<01:29,  9.95s/it]
Task 7, Epoch 12/20 => Loss -0.111, Train_accy 99.22:  55%|█████▌    | 11/20 [01:28<01:29,  9.95s/it]
Task 7, Epoch 12/20 => Loss -0.111, Train_accy 99.22:  60%|██████    | 12/20 [01:28<00:59,  7.41s/it]
Task 7, Epoch 13/20 => Loss -0.105, Train_accy 98.45:  60%|██████    | 12/20 [01:29<00:59,  7.41s/it]
Task 7, Epoch 13/20 => Loss -0.105, Train_accy 98.45:  65%|██████▌   | 13/20 [01:29<00:39,  5.67s/it]
Task 7, Epoch 14/20 => Loss -0.108, Train_accy 98.45:  65%|██████▌   | 13/20 [01:31<00:39,  5.67s/it]
Task 7, Epoch 14/20 => Loss -0.108, Train_accy 98.45:  70%|███████   | 14/20 [01:31<00:27,  4.52s/it]
Task 7, Epoch 15/20 => Loss -0.085, Train_accy 98.45, Test_accy 62.67:  70%|███████   | 14/20 [02:06<00:27,  4.52s/it]
Task 7, Epoch 15/20 => Loss -0.085, Train_accy 98.45, Test_accy 62.67:  75%|███████▌  | 15/20 [02:06<01:08, 13.70s/it]
Task 7, Epoch 16/20 => Loss -0.120, Train_accy 100.00:  75%|███████▌  | 15/20 [02:08<01:08, 13.70s/it]                
Task 7, Epoch 16/20 => Loss -0.120, Train_accy 100.00:  80%|████████  | 16/20 [02:08<00:40, 10.04s/it]
Task 7, Epoch 17/20 => Loss -0.131, Train_accy 100.00:  80%|████████  | 16/20 [02:09<00:40, 10.04s/it]
Task 7, Epoch 17/20 => Loss -0.131, Train_accy 100.00:  85%|████████▌ | 17/20 [02:09<00:22,  7.51s/it]
Task 7, Epoch 18/20 => Loss -0.103, Train_accy 99.22:  85%|████████▌ | 17/20 [02:11<00:22,  7.51s/it] 
Task 7, Epoch 18/20 => Loss -0.103, Train_accy 99.22:  90%|█████████ | 18/20 [02:11<00:11,  5.72s/it]
Task 7, Epoch 19/20 => Loss -0.137, Train_accy 100.00:  90%|█████████ | 18/20 [02:13<00:11,  5.72s/it]
Task 7, Epoch 19/20 => Loss -0.137, Train_accy 100.00:  95%|█████████▌| 19/20 [02:13<00:04,  4.55s/it]
Task 7, Epoch 20/20 => Loss -0.130, Train_accy 100.00, Test_accy 61.78:  95%|█████████▌| 19/20 [02:49<00:04,  4.55s/it]
Task 7, Epoch 20/20 => Loss -0.130, Train_accy 100.00, Test_accy 61.78: 100%|██████████| 20/20 [02:49<00:00, 14.17s/it]
Task 7, Epoch 20/20 => Loss -0.130, Train_accy 100.00, Test_accy 61.78: 100%|██████████| 20/20 [02:49<00:00,  8.49s/it]2024-09-14 21:45:28,539 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.130, Train_accy 100.00, Test_accy 61.78

2024-09-14 21:46:03,426 [trainer.py] => No NME accuracy.
2024-09-14 21:46:03,427 [trainer.py] => CNN: {'total': 61.78, '00-04': 51.75, '05-09': 80.74, '10-14': 36.11, '15-19': 51.31, '20-24': 52.35, '25-29': 79.89, '30-34': 97.66, '35-39': 59.45, 'old': 61.97, 'new': 59.45}
2024-09-14 21:46:03,427 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29, 93.64, 78.64, 77.25, 63.41, 61.78]
2024-09-14 21:46:03,427 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.51, 98.1, 97.75, 97.45, 96.91]

Average Accuracy (CNN): 83.05
2024-09-14 21:46:03,427 [trainer.py] => Average Accuracy (CNN): 83.05 

2024-09-14 21:46:03,430 [trainer.py] => All params: 171739492
2024-09-14 21:46:03,432 [trainer.py] => Trainable params: 84530
2024-09-14 21:46:03,432 [l2p.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.098, Train_accy 52.92:   0%|          | 0/20 [00:03<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.098, Train_accy 52.92:   5%|▌         | 1/20 [00:03<01:06,  3.52s/it]
Task 8, Epoch 2/20 => Loss 0.214, Train_accy 87.63:   5%|▌         | 1/20 [00:06<01:06,  3.52s/it]
Task 8, Epoch 2/20 => Loss 0.214, Train_accy 87.63:  10%|█         | 2/20 [00:06<00:58,  3.23s/it]
Task 8, Epoch 3/20 => Loss 0.110, Train_accy 88.32:  10%|█         | 2/20 [00:09<00:58,  3.23s/it]
Task 8, Epoch 3/20 => Loss 0.110, Train_accy 88.32:  15%|█▌        | 3/20 [00:09<00:53,  3.15s/it]
Task 8, Epoch 4/20 => Loss -0.054, Train_accy 95.19:  15%|█▌        | 3/20 [00:12<00:53,  3.15s/it]
Task 8, Epoch 4/20 => Loss -0.054, Train_accy 95.19:  20%|██        | 4/20 [00:12<00:49,  3.12s/it]
Task 8, Epoch 5/20 => Loss 0.044, Train_accy 95.19, Test_accy 60.54:  20%|██        | 4/20 [00:57<00:49,  3.12s/it]
Task 8, Epoch 5/20 => Loss 0.044, Train_accy 95.19, Test_accy 60.54:  25%|██▌       | 5/20 [00:57<04:34, 18.30s/it]
Task 8, Epoch 6/20 => Loss -0.036, Train_accy 92.78:  25%|██▌       | 5/20 [01:00<04:34, 18.30s/it]                
Task 8, Epoch 6/20 => Loss -0.036, Train_accy 92.78:  30%|███       | 6/20 [01:00<03:03, 13.08s/it]
Task 8, Epoch 7/20 => Loss -0.111, Train_accy 97.94:  30%|███       | 6/20 [01:03<03:03, 13.08s/it]
Task 8, Epoch 7/20 => Loss -0.111, Train_accy 97.94:  35%|███▌      | 7/20 [01:03<02:06,  9.75s/it]
Task 8, Epoch 8/20 => Loss -0.096, Train_accy 96.22:  35%|███▌      | 7/20 [01:06<02:06,  9.75s/it]
Task 8, Epoch 8/20 => Loss -0.096, Train_accy 96.22:  40%|████      | 8/20 [01:06<01:31,  7.62s/it]
Task 8, Epoch 9/20 => Loss -0.106, Train_accy 98.28:  40%|████      | 8/20 [01:09<01:31,  7.62s/it]
Task 8, Epoch 9/20 => Loss -0.106, Train_accy 98.28:  45%|████▌     | 9/20 [01:09<01:07,  6.17s/it]
Task 8, Epoch 10/20 => Loss -0.149, Train_accy 98.63, Test_accy 60.75:  45%|████▌     | 9/20 [01:54<01:07,  6.17s/it]
Task 8, Epoch 10/20 => Loss -0.149, Train_accy 98.63, Test_accy 60.75:  50%|█████     | 10/20 [01:54<03:00, 18.05s/it]
Task 8, Epoch 11/20 => Loss -0.137, Train_accy 98.28:  50%|█████     | 10/20 [01:57<03:00, 18.05s/it]                 
Task 8, Epoch 11/20 => Loss -0.137, Train_accy 98.28:  55%|█████▌    | 11/20 [01:57<02:01, 13.48s/it]
Task 8, Epoch 12/20 => Loss -0.140, Train_accy 97.94:  55%|█████▌    | 11/20 [02:00<02:01, 13.48s/it]
Task 8, Epoch 12/20 => Loss -0.140, Train_accy 97.94:  60%|██████    | 12/20 [02:00<01:22, 10.32s/it]
Task 8, Epoch 13/20 => Loss -0.160, Train_accy 98.63:  60%|██████    | 12/20 [02:03<01:22, 10.32s/it]
Task 8, Epoch 13/20 => Loss -0.160, Train_accy 98.63:  65%|██████▌   | 13/20 [02:03<00:56,  8.13s/it]
Task 8, Epoch 14/20 => Loss -0.144, Train_accy 97.94:  65%|██████▌   | 13/20 [02:06<00:56,  8.13s/it]
Task 8, Epoch 14/20 => Loss -0.144, Train_accy 97.94:  70%|███████   | 14/20 [02:06<00:39,  6.60s/it]
Task 8, Epoch 15/20 => Loss -0.132, Train_accy 97.59, Test_accy 61.45:  70%|███████   | 14/20 [02:53<00:39,  6.60s/it]
Task 8, Epoch 15/20 => Loss -0.132, Train_accy 97.59, Test_accy 61.45:  75%|███████▌  | 15/20 [02:53<01:33, 18.79s/it]
Task 8, Epoch 16/20 => Loss -0.161, Train_accy 99.31:  75%|███████▌  | 15/20 [02:56<01:33, 18.79s/it]                 
Task 8, Epoch 16/20 => Loss -0.161, Train_accy 99.31:  80%|████████  | 16/20 [02:56<00:56, 14.08s/it]
Task 8, Epoch 17/20 => Loss -0.184, Train_accy 98.97:  80%|████████  | 16/20 [03:00<00:56, 14.08s/it]
Task 8, Epoch 17/20 => Loss -0.184, Train_accy 98.97:  85%|████████▌ | 17/20 [03:00<00:32, 10.78s/it]
Task 8, Epoch 18/20 => Loss -0.134, Train_accy 96.91:  85%|████████▌ | 17/20 [03:03<00:32, 10.78s/it]
Task 8, Epoch 18/20 => Loss -0.134, Train_accy 96.91:  90%|█████████ | 18/20 [03:03<00:16,  8.46s/it]
Task 8, Epoch 19/20 => Loss -0.191, Train_accy 99.66:  90%|█████████ | 18/20 [03:06<00:16,  8.46s/it]
Task 8, Epoch 19/20 => Loss -0.191, Train_accy 99.66:  95%|█████████▌| 19/20 [03:06<00:06,  6.84s/it]
Task 8, Epoch 20/20 => Loss -0.192, Train_accy 98.63, Test_accy 61.12:  95%|█████████▌| 19/20 [03:51<00:06,  6.84s/it]
Task 8, Epoch 20/20 => Loss -0.192, Train_accy 98.63, Test_accy 61.12: 100%|██████████| 20/20 [03:51<00:00, 18.52s/it]
Task 8, Epoch 20/20 => Loss -0.192, Train_accy 98.63, Test_accy 61.12: 100%|██████████| 20/20 [03:51<00:00, 11.60s/it]2024-09-14 21:49:55,421 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.192, Train_accy 98.63, Test_accy 61.12

2024-09-14 21:50:37,711 [trainer.py] => No NME accuracy.
2024-09-14 21:50:37,712 [trainer.py] => CNN: {'total': 61.12, '00-04': 51.4, '05-09': 80.0, '10-14': 23.86, '15-19': 37.19, '20-24': 45.34, '25-29': 79.37, '30-34': 97.53, '35-39': 59.68, '40-44': 82.91, 'old': 55.34, 'new': 82.91}
2024-09-14 21:50:37,712 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29, 93.64, 78.64, 77.25, 63.41, 61.78, 61.12]
2024-09-14 21:50:37,712 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.51, 98.1, 97.75, 97.45, 96.91, 94.69]

Average Accuracy (CNN): 80.62
2024-09-14 21:50:37,712 [trainer.py] => Average Accuracy (CNN): 80.62 

2024-09-14 21:50:37,715 [trainer.py] => All params: 171739492
2024-09-14 21:50:37,717 [trainer.py] => Trainable params: 84530
2024-09-14 21:50:37,717 [l2p.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.902, Train_accy 63.74:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.902, Train_accy 63.74:   5%|▌         | 1/20 [00:02<00:54,  2.87s/it]
Task 9, Epoch 2/20 => Loss 0.080, Train_accy 90.46:   5%|▌         | 1/20 [00:05<00:54,  2.87s/it]
Task 9, Epoch 2/20 => Loss 0.080, Train_accy 90.46:  10%|█         | 2/20 [00:05<00:49,  2.74s/it]
Task 9, Epoch 3/20 => Loss -0.135, Train_accy 96.56:  10%|█         | 2/20 [00:08<00:49,  2.74s/it]
Task 9, Epoch 3/20 => Loss -0.135, Train_accy 96.56:  15%|█▌        | 3/20 [00:08<00:45,  2.70s/it]
Task 9, Epoch 4/20 => Loss -0.128, Train_accy 96.56:  15%|█▌        | 3/20 [00:10<00:45,  2.70s/it]
Task 9, Epoch 4/20 => Loss -0.128, Train_accy 96.56:  20%|██        | 4/20 [00:10<00:42,  2.65s/it]
Task 9, Epoch 5/20 => Loss -0.162, Train_accy 98.09, Test_accy 56.14:  20%|██        | 4/20 [01:05<00:42,  2.65s/it]
Task 9, Epoch 5/20 => Loss -0.162, Train_accy 98.09, Test_accy 56.14:  25%|██▌       | 5/20 [01:05<05:21, 21.43s/it]
Task 9, Epoch 6/20 => Loss -0.157, Train_accy 97.33:  25%|██▌       | 5/20 [01:08<05:21, 21.43s/it]                 
Task 9, Epoch 6/20 => Loss -0.157, Train_accy 97.33:  30%|███       | 6/20 [01:08<03:31, 15.11s/it]
Task 9, Epoch 7/20 => Loss -0.092, Train_accy 96.56:  30%|███       | 6/20 [01:11<03:31, 15.11s/it]
Task 9, Epoch 7/20 => Loss -0.092, Train_accy 96.56:  35%|███▌      | 7/20 [01:11<02:24, 11.09s/it]
Task 9, Epoch 8/20 => Loss -0.162, Train_accy 97.71:  35%|███▌      | 7/20 [01:14<02:24, 11.09s/it]
Task 9, Epoch 8/20 => Loss -0.162, Train_accy 97.71:  40%|████      | 8/20 [01:14<01:41,  8.48s/it]
Task 9, Epoch 9/20 => Loss -0.164, Train_accy 98.47:  40%|████      | 8/20 [01:16<01:41,  8.48s/it]
Task 9, Epoch 9/20 => Loss -0.164, Train_accy 98.47:  45%|████▌     | 9/20 [01:16<01:13,  6.70s/it]
Task 9, Epoch 10/20 => Loss -0.188, Train_accy 97.71, Test_accy 54.03:  45%|████▌     | 9/20 [02:11<01:13,  6.70s/it]
Task 9, Epoch 10/20 => Loss -0.188, Train_accy 97.71, Test_accy 54.03:  50%|█████     | 10/20 [02:11<03:34, 21.43s/it]
Task 9, Epoch 11/20 => Loss -0.183, Train_accy 97.71:  50%|█████     | 10/20 [02:13<03:34, 21.43s/it]                 
Task 9, Epoch 11/20 => Loss -0.183, Train_accy 97.71:  55%|█████▌    | 11/20 [02:13<02:20, 15.66s/it]
Task 9, Epoch 12/20 => Loss -0.185, Train_accy 99.24:  55%|█████▌    | 11/20 [02:16<02:20, 15.66s/it]
Task 9, Epoch 12/20 => Loss -0.185, Train_accy 99.24:  60%|██████    | 12/20 [02:16<01:33, 11.74s/it]
Task 9, Epoch 13/20 => Loss -0.214, Train_accy 98.47:  60%|██████    | 12/20 [02:19<01:33, 11.74s/it]
Task 9, Epoch 13/20 => Loss -0.214, Train_accy 98.47:  65%|██████▌   | 13/20 [02:19<01:02,  8.99s/it]
Task 9, Epoch 14/20 => Loss -0.222, Train_accy 99.24:  65%|██████▌   | 13/20 [02:21<01:02,  8.99s/it]
Task 9, Epoch 14/20 => Loss -0.222, Train_accy 99.24:  70%|███████   | 14/20 [02:21<00:42,  7.06s/it]
Task 9, Epoch 15/20 => Loss -0.200, Train_accy 97.71, Test_accy 56.10:  70%|███████   | 14/20 [03:14<00:42,  7.06s/it]
Task 9, Epoch 15/20 => Loss -0.200, Train_accy 97.71, Test_accy 56.10:  75%|███████▌  | 15/20 [03:14<01:44, 20.84s/it]
Task 9, Epoch 16/20 => Loss -0.219, Train_accy 98.85:  75%|███████▌  | 15/20 [03:17<01:44, 20.84s/it]                 
Task 9, Epoch 16/20 => Loss -0.219, Train_accy 98.85:  80%|████████  | 16/20 [03:17<01:01, 15.37s/it]
Task 9, Epoch 17/20 => Loss -0.181, Train_accy 98.09:  80%|████████  | 16/20 [03:19<01:01, 15.37s/it]
Task 9, Epoch 17/20 => Loss -0.181, Train_accy 98.09:  85%|████████▌ | 17/20 [03:19<00:34, 11.55s/it]
Task 9, Epoch 18/20 => Loss -0.233, Train_accy 100.00:  85%|████████▌ | 17/20 [03:22<00:34, 11.55s/it]
Task 9, Epoch 18/20 => Loss -0.233, Train_accy 100.00:  90%|█████████ | 18/20 [03:22<00:17,  8.89s/it]
Task 9, Epoch 19/20 => Loss -0.222, Train_accy 98.85:  90%|█████████ | 18/20 [03:25<00:17,  8.89s/it] 
Task 9, Epoch 19/20 => Loss -0.222, Train_accy 98.85:  95%|█████████▌| 19/20 [03:25<00:07,  7.08s/it]
Task 9, Epoch 20/20 => Loss -0.163, Train_accy 96.95, Test_accy 54.80:  95%|█████████▌| 19/20 [04:20<00:07,  7.08s/it]
Task 9, Epoch 20/20 => Loss -0.163, Train_accy 96.95, Test_accy 54.80: 100%|██████████| 20/20 [04:20<00:00, 21.37s/it]
Task 9, Epoch 20/20 => Loss -0.163, Train_accy 96.95, Test_accy 54.80: 100%|██████████| 20/20 [04:20<00:00, 13.01s/it]2024-09-14 21:54:57,895 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.163, Train_accy 96.95, Test_accy 54.80

2024-09-14 21:55:49,473 [trainer.py] => No NME accuracy.
2024-09-14 21:55:49,474 [trainer.py] => CNN: {'total': 54.8, '00-04': 51.4, '05-09': 79.81, '10-14': 16.34, '15-19': 32.15, '20-24': 34.74, '25-29': 66.93, '30-34': 81.13, '35-39': 37.36, '40-44': 68.38, '45-49': 76.1, 'old': 50.78, 'new': 76.1}
2024-09-14 21:55:49,474 [trainer.py] => CNN top1 curve: [95.45, 96.97, 97.29, 93.64, 78.64, 77.25, 63.41, 61.78, 61.12, 54.8]
2024-09-14 21:55:49,474 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.51, 98.1, 97.75, 97.45, 96.91, 94.69, 91.39]

Average Accuracy (CNN): 78.04
2024-09-14 21:55:49,474 [trainer.py] => Average Accuracy (CNN): 78.04 

Accuracy Matrix (CNN):
[[95.45 91.96 88.46 87.41 80.42 52.45 50.35 51.75 51.4  51.4 ]
 [ 0.   99.63 99.44 99.26 80.56 80.56 80.37 80.74 80.   79.81]
 [ 0.    0.   99.51 95.1  68.3  67.48 38.89 36.11 23.86 16.34]
 [ 0.    0.    0.   92.12 70.33 69.77 55.36 51.31 37.19 32.15]
 [ 0.    0.    0.    0.   91.79 91.55 52.91 52.35 45.34 34.74]
 [ 0.    0.    0.    0.    0.   87.57 79.37 79.89 79.37 66.93]
 [ 0.    0.    0.    0.    0.    0.   98.03 97.66 97.53 81.13]
 [ 0.    0.    0.    0.    0.    0.    0.   59.45 59.68 37.36]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   82.91 68.38]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   76.1 ]]
2024-09-14 21:55:49,477 [trainer.py] => Forgetting (CNN): 37.60555555555556
2024-09-14 21:56:02,922 [trainer.py] => config: ./exps/dualprompt_vtab_B0_Inc5.json
2024-09-14 21:56:02,922 [trainer.py] => prefix:  
2024-09-14 21:56:02,922 [trainer.py] => dataset: vtab
2024-09-14 21:56:02,922 [trainer.py] => memory_size: 0
2024-09-14 21:56:02,922 [trainer.py] => memory_per_class: 0
2024-09-14 21:56:02,922 [trainer.py] => fixed_memory: False
2024-09-14 21:56:02,922 [trainer.py] => shuffle: True
2024-09-14 21:56:02,922 [trainer.py] => init_cls: 10
2024-09-14 21:56:02,922 [trainer.py] => increment: 10
2024-09-14 21:56:02,922 [trainer.py] => model_name: dualprompt
2024-09-14 21:56:02,922 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-14 21:56:02,922 [trainer.py] => get_original_backbone: True
2024-09-14 21:56:02,922 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 21:56:02,923 [trainer.py] => seed: 1993
2024-09-14 21:56:02,923 [trainer.py] => tuned_epoch: 20
2024-09-14 21:56:02,923 [trainer.py] => init_lr: 0.001
2024-09-14 21:56:02,923 [trainer.py] => batch_size: 48
2024-09-14 21:56:02,923 [trainer.py] => weight_decay: 0
2024-09-14 21:56:02,923 [trainer.py] => min_lr: 1e-05
2024-09-14 21:56:02,923 [trainer.py] => optimizer: adam
2024-09-14 21:56:02,923 [trainer.py] => scheduler: constant
2024-09-14 21:56:02,923 [trainer.py] => reinit_optimizer: True
2024-09-14 21:56:02,923 [trainer.py] => global_pool: token
2024-09-14 21:56:02,923 [trainer.py] => head_type: token
2024-09-14 21:56:02,923 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-14 21:56:02,923 [trainer.py] => pretrained: True
2024-09-14 21:56:02,923 [trainer.py] => drop: 0.0
2024-09-14 21:56:02,923 [trainer.py] => drop_path: 0.0
2024-09-14 21:56:02,923 [trainer.py] => use_g_prompt: True
2024-09-14 21:56:02,923 [trainer.py] => g_prompt_length: 5
2024-09-14 21:56:02,923 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-14 21:56:02,923 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-14 21:56:02,923 [trainer.py] => use_e_prompt: True
2024-09-14 21:56:02,923 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-14 21:56:02,923 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-14 21:56:02,923 [trainer.py] => prompt_pool: True
2024-09-14 21:56:02,923 [trainer.py] => size: 10
2024-09-14 21:56:02,923 [trainer.py] => length: 5
2024-09-14 21:56:02,923 [trainer.py] => top_k: 1
2024-09-14 21:56:02,923 [trainer.py] => initializer: uniform
2024-09-14 21:56:02,923 [trainer.py] => prompt_key: True
2024-09-14 21:56:02,923 [trainer.py] => prompt_key_init: uniform
2024-09-14 21:56:02,923 [trainer.py] => use_prompt_mask: True
2024-09-14 21:56:02,923 [trainer.py] => shared_prompt_pool: True
2024-09-14 21:56:02,923 [trainer.py] => shared_prompt_key: False
2024-09-14 21:56:02,923 [trainer.py] => batchwise_prompt: True
2024-09-14 21:56:02,923 [trainer.py] => embedding_key: cls
2024-09-14 21:56:02,924 [trainer.py] => predefined_key: 
2024-09-14 21:56:02,924 [trainer.py] => pull_constraint: True
2024-09-14 21:56:02,924 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-14 21:56:02,924 [trainer.py] => same_key_value: False
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 21:56:03,036 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-09-14 21:56:14,882 [dualprompt.py] => 86,090,546 model total parameters.
2024-09-14 21:56:14,883 [dualprompt.py] => 291,890 model training parameters.
2024-09-14 21:56:14,883 [dualprompt.py] => g_prompt: 15360
2024-09-14 21:56:14,883 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-14 21:56:14,883 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-14 21:56:14,883 [dualprompt.py] => head.weight: 38400
2024-09-14 21:56:14,883 [dualprompt.py] => head.bias: 50
2024-09-14 21:56:14,884 [trainer.py] => All params: 171927652
2024-09-14 21:56:14,885 [trainer.py] => Trainable params: 291890
2024-09-14 21:56:14,885 [dualprompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.339, Train_accy 27.95:   0%|          | 0/20 [00:04<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.339, Train_accy 27.95:   5%|▌         | 1/20 [00:04<01:26,  4.56s/it]
Task 0, Epoch 2/20 => Loss 0.918, Train_accy 78.88:   5%|▌         | 1/20 [00:06<01:26,  4.56s/it]
Task 0, Epoch 2/20 => Loss 0.918, Train_accy 78.88:  10%|█         | 2/20 [00:06<00:54,  3.01s/it]
Task 0, Epoch 3/20 => Loss 0.373, Train_accy 90.68:  10%|█         | 2/20 [00:08<00:54,  3.01s/it]
Task 0, Epoch 3/20 => Loss 0.373, Train_accy 90.68:  15%|█▌        | 3/20 [00:08<00:41,  2.46s/it]
Task 0, Epoch 4/20 => Loss 0.178, Train_accy 98.76:  15%|█▌        | 3/20 [00:10<00:41,  2.46s/it]
Task 0, Epoch 4/20 => Loss 0.178, Train_accy 98.76:  20%|██        | 4/20 [00:10<00:35,  2.21s/it]
Task 0, Epoch 5/20 => Loss 0.125, Train_accy 95.03, Test_accy 98.55:  20%|██        | 4/20 [00:17<00:35,  2.21s/it]
Task 0, Epoch 5/20 => Loss 0.125, Train_accy 95.03, Test_accy 98.55:  25%|██▌       | 5/20 [00:17<00:58,  3.93s/it]
Task 0, Epoch 6/20 => Loss 0.060, Train_accy 98.14:  25%|██▌       | 5/20 [00:18<00:58,  3.93s/it]                 
Task 0, Epoch 6/20 => Loss 0.060, Train_accy 98.14:  30%|███       | 6/20 [00:18<00:44,  3.21s/it]
Task 0, Epoch 7/20 => Loss 0.073, Train_accy 98.14:  30%|███       | 6/20 [00:20<00:44,  3.21s/it]
Task 0, Epoch 7/20 => Loss 0.073, Train_accy 98.14:  35%|███▌      | 7/20 [00:20<00:35,  2.72s/it]
Task 0, Epoch 8/20 => Loss 0.050, Train_accy 99.38:  35%|███▌      | 7/20 [00:22<00:35,  2.72s/it]
Task 0, Epoch 8/20 => Loss 0.050, Train_accy 99.38:  40%|████      | 8/20 [00:22<00:28,  2.41s/it]
Task 0, Epoch 9/20 => Loss 0.055, Train_accy 98.76:  40%|████      | 8/20 [00:24<00:28,  2.41s/it]
Task 0, Epoch 9/20 => Loss 0.055, Train_accy 98.76:  45%|████▌     | 9/20 [00:24<00:24,  2.19s/it]
Task 0, Epoch 10/20 => Loss 0.015, Train_accy 100.00, Test_accy 98.91:  45%|████▌     | 9/20 [00:30<00:24,  2.19s/it]
Task 0, Epoch 10/20 => Loss 0.015, Train_accy 100.00, Test_accy 98.91:  50%|█████     | 10/20 [00:30<00:36,  3.64s/it]
Task 0, Epoch 11/20 => Loss 0.038, Train_accy 98.76:  50%|█████     | 10/20 [00:32<00:36,  3.64s/it]                  
Task 0, Epoch 11/20 => Loss 0.038, Train_accy 98.76:  55%|█████▌    | 11/20 [00:32<00:27,  3.06s/it]
Task 0, Epoch 12/20 => Loss 0.039, Train_accy 98.76:  55%|█████▌    | 11/20 [00:34<00:27,  3.06s/it]
Task 0, Epoch 12/20 => Loss 0.039, Train_accy 98.76:  60%|██████    | 12/20 [00:34<00:21,  2.66s/it]
Task 0, Epoch 13/20 => Loss 0.047, Train_accy 98.14:  60%|██████    | 12/20 [00:36<00:21,  2.66s/it]
Task 0, Epoch 13/20 => Loss 0.047, Train_accy 98.14:  65%|██████▌   | 13/20 [00:36<00:16,  2.40s/it]
Task 0, Epoch 14/20 => Loss 0.044, Train_accy 98.76:  65%|██████▌   | 13/20 [00:37<00:16,  2.40s/it]
Task 0, Epoch 14/20 => Loss 0.044, Train_accy 98.76:  70%|███████   | 14/20 [00:37<00:13,  2.19s/it]
Task 0, Epoch 15/20 => Loss 0.032, Train_accy 98.14, Test_accy 99.03:  70%|███████   | 14/20 [00:44<00:13,  2.19s/it]
Task 0, Epoch 15/20 => Loss 0.032, Train_accy 98.14, Test_accy 99.03:  75%|███████▌  | 15/20 [00:44<00:18,  3.60s/it]
Task 0, Epoch 16/20 => Loss 0.038, Train_accy 99.38:  75%|███████▌  | 15/20 [00:46<00:18,  3.60s/it]                 
Task 0, Epoch 16/20 => Loss 0.038, Train_accy 99.38:  80%|████████  | 16/20 [00:46<00:12,  3.06s/it]
Task 0, Epoch 17/20 => Loss 0.022, Train_accy 98.76:  80%|████████  | 16/20 [00:48<00:12,  3.06s/it]
Task 0, Epoch 17/20 => Loss 0.022, Train_accy 98.76:  85%|████████▌ | 17/20 [00:48<00:08,  2.71s/it]
Task 0, Epoch 18/20 => Loss 0.027, Train_accy 99.38:  85%|████████▌ | 17/20 [00:50<00:08,  2.71s/it]
Task 0, Epoch 18/20 => Loss 0.027, Train_accy 99.38:  90%|█████████ | 18/20 [00:50<00:04,  2.45s/it]
Task 0, Epoch 19/20 => Loss 0.026, Train_accy 99.38:  90%|█████████ | 18/20 [00:52<00:04,  2.45s/it]
Task 0, Epoch 19/20 => Loss 0.026, Train_accy 99.38:  95%|█████████▌| 19/20 [00:52<00:02,  2.26s/it]
Task 0, Epoch 20/20 => Loss 0.029, Train_accy 99.38, Test_accy 98.91:  95%|█████████▌| 19/20 [00:59<00:02,  2.26s/it]
Task 0, Epoch 20/20 => Loss 0.029, Train_accy 99.38, Test_accy 98.91: 100%|██████████| 20/20 [00:59<00:00,  3.78s/it]
Task 0, Epoch 20/20 => Loss 0.029, Train_accy 99.38, Test_accy 98.91: 100%|██████████| 20/20 [00:59<00:00,  2.98s/it]2024-09-14 21:57:15,110 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.029, Train_accy 99.38, Test_accy 98.91

2024-09-14 21:57:20,427 [trainer.py] => No NME accuracy.
2024-09-14 21:57:20,427 [trainer.py] => CNN: {'total': 98.91, '00-09': 98.91, 'old': 0, 'new': 98.91}
2024-09-14 21:57:20,428 [trainer.py] => CNN top1 curve: [98.91]
2024-09-14 21:57:20,428 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.91
2024-09-14 21:57:20,428 [trainer.py] => Average Accuracy (CNN): 98.91 

2024-09-14 21:57:20,431 [trainer.py] => All params: 171927652
2024-09-14 21:57:20,434 [trainer.py] => Trainable params: 291890
2024-09-14 21:57:20,434 [dualprompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.444, Train_accy 53.62:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.444, Train_accy 53.62:   5%|▌         | 1/20 [00:04<01:19,  4.16s/it]
Task 1, Epoch 2/20 => Loss 0.429, Train_accy 88.89:   5%|▌         | 1/20 [00:08<01:19,  4.16s/it]
Task 1, Epoch 2/20 => Loss 0.429, Train_accy 88.89:  10%|█         | 2/20 [00:08<01:12,  4.02s/it]
Task 1, Epoch 3/20 => Loss 0.253, Train_accy 92.75:  10%|█         | 2/20 [00:11<01:12,  4.02s/it]
Task 1, Epoch 3/20 => Loss 0.253, Train_accy 92.75:  15%|█▌        | 3/20 [00:11<01:07,  3.94s/it]
Task 1, Epoch 4/20 => Loss 0.158, Train_accy 94.69:  15%|█▌        | 3/20 [00:15<01:07,  3.94s/it]
Task 1, Epoch 4/20 => Loss 0.158, Train_accy 94.69:  20%|██        | 4/20 [00:15<01:03,  3.96s/it]
Task 1, Epoch 5/20 => Loss 0.142, Train_accy 95.17, Test_accy 95.86:  20%|██        | 4/20 [00:36<01:03,  3.96s/it]
Task 1, Epoch 5/20 => Loss 0.142, Train_accy 95.17, Test_accy 95.86:  25%|██▌       | 5/20 [00:36<02:30, 10.02s/it]
Task 1, Epoch 6/20 => Loss 0.110, Train_accy 96.38:  25%|██▌       | 5/20 [00:40<02:30, 10.02s/it]                 
Task 1, Epoch 6/20 => Loss 0.110, Train_accy 96.38:  30%|███       | 6/20 [00:40<01:51,  7.96s/it]
Task 1, Epoch 7/20 => Loss 0.108, Train_accy 96.38:  30%|███       | 6/20 [00:44<01:51,  7.96s/it]
Task 1, Epoch 7/20 => Loss 0.108, Train_accy 96.38:  35%|███▌      | 7/20 [00:44<01:26,  6.64s/it]
Task 1, Epoch 8/20 => Loss 0.094, Train_accy 97.10:  35%|███▌      | 7/20 [00:48<01:26,  6.64s/it]
Task 1, Epoch 8/20 => Loss 0.094, Train_accy 97.10:  40%|████      | 8/20 [00:48<01:09,  5.78s/it]
Task 1, Epoch 9/20 => Loss 0.093, Train_accy 96.86:  40%|████      | 8/20 [00:52<01:09,  5.78s/it]
Task 1, Epoch 9/20 => Loss 0.093, Train_accy 96.86:  45%|████▌     | 9/20 [00:52<00:57,  5.19s/it]
Task 1, Epoch 10/20 => Loss 0.084, Train_accy 97.10, Test_accy 95.79:  45%|████▌     | 9/20 [01:12<00:57,  5.19s/it]
Task 1, Epoch 10/20 => Loss 0.084, Train_accy 97.10, Test_accy 95.79:  50%|█████     | 10/20 [01:12<01:39,  9.91s/it]
Task 1, Epoch 11/20 => Loss 0.080, Train_accy 98.55:  50%|█████     | 10/20 [01:16<01:39,  9.91s/it]                 
Task 1, Epoch 11/20 => Loss 0.080, Train_accy 98.55:  55%|█████▌    | 11/20 [01:16<01:12,  8.10s/it]
Task 1, Epoch 12/20 => Loss 0.064, Train_accy 98.79:  55%|█████▌    | 11/20 [01:20<01:12,  8.10s/it]
Task 1, Epoch 12/20 => Loss 0.064, Train_accy 98.79:  60%|██████    | 12/20 [01:20<00:54,  6.82s/it]
Task 1, Epoch 13/20 => Loss 0.062, Train_accy 98.31:  60%|██████    | 12/20 [01:24<00:54,  6.82s/it]
Task 1, Epoch 13/20 => Loss 0.062, Train_accy 98.31:  65%|██████▌   | 13/20 [01:24<00:41,  5.88s/it]
Task 1, Epoch 14/20 => Loss 0.038, Train_accy 99.03:  65%|██████▌   | 13/20 [01:28<00:41,  5.88s/it]
Task 1, Epoch 14/20 => Loss 0.038, Train_accy 99.03:  70%|███████   | 14/20 [01:28<00:31,  5.21s/it]
Task 1, Epoch 15/20 => Loss 0.036, Train_accy 99.03, Test_accy 97.12:  70%|███████   | 14/20 [01:47<00:31,  5.21s/it]
Task 1, Epoch 15/20 => Loss 0.036, Train_accy 99.03, Test_accy 97.12:  75%|███████▌  | 15/20 [01:47<00:47,  9.46s/it]
Task 1, Epoch 16/20 => Loss 0.065, Train_accy 97.58:  75%|███████▌  | 15/20 [01:51<00:47,  9.46s/it]                 
Task 1, Epoch 16/20 => Loss 0.065, Train_accy 97.58:  80%|████████  | 16/20 [01:51<00:30,  7.74s/it]
Task 1, Epoch 17/20 => Loss 0.065, Train_accy 97.58:  80%|████████  | 16/20 [01:55<00:30,  7.74s/it]
Task 1, Epoch 17/20 => Loss 0.065, Train_accy 97.58:  85%|████████▌ | 17/20 [01:55<00:19,  6.56s/it]
Task 1, Epoch 18/20 => Loss 0.059, Train_accy 97.83:  85%|████████▌ | 17/20 [01:58<00:19,  6.56s/it]
Task 1, Epoch 18/20 => Loss 0.059, Train_accy 97.83:  90%|█████████ | 18/20 [01:58<00:11,  5.77s/it]
Task 1, Epoch 19/20 => Loss 0.034, Train_accy 99.03:  90%|█████████ | 18/20 [02:02<00:11,  5.77s/it]
Task 1, Epoch 19/20 => Loss 0.034, Train_accy 99.03:  95%|█████████▌| 19/20 [02:02<00:05,  5.21s/it]
Task 1, Epoch 20/20 => Loss 0.065, Train_accy 98.31, Test_accy 97.23:  95%|█████████▌| 19/20 [02:22<00:05,  5.21s/it]
Task 1, Epoch 20/20 => Loss 0.065, Train_accy 98.31, Test_accy 97.23: 100%|██████████| 20/20 [02:22<00:00,  9.63s/it]
Task 1, Epoch 20/20 => Loss 0.065, Train_accy 98.31, Test_accy 97.23: 100%|██████████| 20/20 [02:22<00:00,  7.14s/it]2024-09-14 21:59:43,227 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.065, Train_accy 98.31, Test_accy 97.23

2024-09-14 21:59:59,011 [trainer.py] => No NME accuracy.
2024-09-14 21:59:59,012 [trainer.py] => CNN: {'total': 97.23, '00-09': 97.22, '10-19': 97.23, 'old': 97.22, 'new': 97.23}
2024-09-14 21:59:59,012 [trainer.py] => CNN top1 curve: [98.91, 97.23]
2024-09-14 21:59:59,012 [trainer.py] => CNN top5 curve: [100.0, 99.96]

Average Accuracy (CNN): 98.07
2024-09-14 21:59:59,012 [trainer.py] => Average Accuracy (CNN): 98.07 

2024-09-14 21:59:59,016 [trainer.py] => All params: 171927652
2024-09-14 21:59:59,019 [trainer.py] => Trainable params: 291890
2024-09-14 21:59:59,019 [dualprompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.952, Train_accy 38.63:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.952, Train_accy 38.63:   5%|▌         | 1/20 [00:03<01:04,  3.37s/it]
Task 2, Epoch 2/20 => Loss 0.459, Train_accy 87.12:   5%|▌         | 1/20 [00:06<01:04,  3.37s/it]
Task 2, Epoch 2/20 => Loss 0.459, Train_accy 87.12:  10%|█         | 2/20 [00:06<01:00,  3.35s/it]
Task 2, Epoch 3/20 => Loss 0.224, Train_accy 93.97:  10%|█         | 2/20 [00:10<01:00,  3.35s/it]
Task 2, Epoch 3/20 => Loss 0.224, Train_accy 93.97:  15%|█▌        | 3/20 [00:10<00:58,  3.46s/it]
Task 2, Epoch 4/20 => Loss 0.173, Train_accy 93.15:  15%|█▌        | 3/20 [00:13<00:58,  3.46s/it]
Task 2, Epoch 4/20 => Loss 0.173, Train_accy 93.15:  20%|██        | 4/20 [00:13<00:55,  3.49s/it]
Task 2, Epoch 5/20 => Loss 0.115, Train_accy 96.16, Test_accy 89.15:  20%|██        | 4/20 [00:43<00:55,  3.49s/it]
Task 2, Epoch 5/20 => Loss 0.115, Train_accy 96.16, Test_accy 89.15:  25%|██▌       | 5/20 [00:43<03:14, 12.94s/it]
Task 2, Epoch 6/20 => Loss 0.090, Train_accy 97.26:  25%|██▌       | 5/20 [00:47<03:14, 12.94s/it]                 
Task 2, Epoch 6/20 => Loss 0.090, Train_accy 97.26:  30%|███       | 6/20 [00:47<02:16,  9.75s/it]
Task 2, Epoch 7/20 => Loss 0.090, Train_accy 96.16:  30%|███       | 6/20 [00:50<02:16,  9.75s/it]
Task 2, Epoch 7/20 => Loss 0.090, Train_accy 96.16:  35%|███▌      | 7/20 [00:50<01:40,  7.70s/it]
Task 2, Epoch 8/20 => Loss 0.088, Train_accy 96.99:  35%|███▌      | 7/20 [00:54<01:40,  7.70s/it]
Task 2, Epoch 8/20 => Loss 0.088, Train_accy 96.99:  40%|████      | 8/20 [00:54<01:17,  6.44s/it]
Task 2, Epoch 9/20 => Loss 0.072, Train_accy 97.53:  40%|████      | 8/20 [00:57<01:17,  6.44s/it]
Task 2, Epoch 9/20 => Loss 0.072, Train_accy 97.53:  45%|████▌     | 9/20 [00:57<01:00,  5.52s/it]
Task 2, Epoch 10/20 => Loss 0.044, Train_accy 99.18, Test_accy 90.49:  45%|████▌     | 9/20 [01:27<01:00,  5.52s/it]
Task 2, Epoch 10/20 => Loss 0.044, Train_accy 99.18, Test_accy 90.49:  50%|█████     | 10/20 [01:27<02:09, 12.96s/it]
Task 2, Epoch 11/20 => Loss 0.068, Train_accy 97.26:  50%|█████     | 10/20 [01:30<02:09, 12.96s/it]                 
Task 2, Epoch 11/20 => Loss 0.068, Train_accy 97.26:  55%|█████▌    | 11/20 [01:30<01:30, 10.08s/it]
Task 2, Epoch 12/20 => Loss 0.048, Train_accy 98.63:  55%|█████▌    | 11/20 [01:34<01:30, 10.08s/it]
Task 2, Epoch 12/20 => Loss 0.048, Train_accy 98.63:  60%|██████    | 12/20 [01:34<01:04,  8.08s/it]
Task 2, Epoch 13/20 => Loss 0.086, Train_accy 97.81:  60%|██████    | 12/20 [01:37<01:04,  8.08s/it]
Task 2, Epoch 13/20 => Loss 0.086, Train_accy 97.81:  65%|██████▌   | 13/20 [01:37<00:46,  6.70s/it]
Task 2, Epoch 14/20 => Loss 0.071, Train_accy 97.53:  65%|██████▌   | 13/20 [01:41<00:46,  6.70s/it]
Task 2, Epoch 14/20 => Loss 0.071, Train_accy 97.53:  70%|███████   | 14/20 [01:41<00:34,  5.77s/it]
Task 2, Epoch 15/20 => Loss 0.059, Train_accy 98.08, Test_accy 90.04:  70%|███████   | 14/20 [02:09<00:34,  5.77s/it]
Task 2, Epoch 15/20 => Loss 0.059, Train_accy 98.08, Test_accy 90.04:  75%|███████▌  | 15/20 [02:09<01:01, 12.38s/it]
Task 2, Epoch 16/20 => Loss 0.033, Train_accy 98.90:  75%|███████▌  | 15/20 [02:12<01:01, 12.38s/it]                 
Task 2, Epoch 16/20 => Loss 0.033, Train_accy 98.90:  80%|████████  | 16/20 [02:12<00:38,  9.66s/it]
Task 2, Epoch 17/20 => Loss 0.053, Train_accy 98.36:  80%|████████  | 16/20 [02:16<00:38,  9.66s/it]
Task 2, Epoch 17/20 => Loss 0.053, Train_accy 98.36:  85%|████████▌ | 17/20 [02:16<00:23,  7.83s/it]
Task 2, Epoch 18/20 => Loss 0.034, Train_accy 98.63:  85%|████████▌ | 17/20 [02:19<00:23,  7.83s/it]
Task 2, Epoch 18/20 => Loss 0.034, Train_accy 98.63:  90%|█████████ | 18/20 [02:19<00:13,  6.56s/it]
Task 2, Epoch 19/20 => Loss 0.042, Train_accy 99.18:  90%|█████████ | 18/20 [02:23<00:13,  6.56s/it]
Task 2, Epoch 19/20 => Loss 0.042, Train_accy 99.18:  95%|█████████▌| 19/20 [02:23<00:05,  5.66s/it]
Task 2, Epoch 20/20 => Loss 0.079, Train_accy 97.26, Test_accy 90.45:  95%|█████████▌| 19/20 [02:51<00:05,  5.66s/it]
Task 2, Epoch 20/20 => Loss 0.079, Train_accy 97.26, Test_accy 90.45: 100%|██████████| 20/20 [02:51<00:00, 12.54s/it]
Task 2, Epoch 20/20 => Loss 0.079, Train_accy 97.26, Test_accy 90.45: 100%|██████████| 20/20 [02:51<00:00,  8.60s/it]2024-09-14 22:02:51,020 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.079, Train_accy 97.26, Test_accy 90.45

2024-09-14 22:03:15,834 [trainer.py] => No NME accuracy.
2024-09-14 22:03:15,834 [trainer.py] => CNN: {'total': 90.45, '00-09': 88.74, '10-19': 92.53, '20-29': 88.73, 'old': 91.43, 'new': 88.73}
2024-09-14 22:03:15,834 [trainer.py] => CNN top1 curve: [98.91, 97.23, 90.45]
2024-09-14 22:03:15,834 [trainer.py] => CNN top5 curve: [100.0, 99.96, 99.6]

Average Accuracy (CNN): 95.53
2024-09-14 22:03:15,834 [trainer.py] => Average Accuracy (CNN): 95.53 

2024-09-14 22:03:15,836 [trainer.py] => All params: 171927652
2024-09-14 22:03:15,837 [trainer.py] => Trainable params: 291890
2024-09-14 22:03:15,837 [dualprompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.655, Train_accy 39.60:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.655, Train_accy 39.60:   5%|▌         | 1/20 [00:03<00:59,  3.13s/it]
Task 3, Epoch 2/20 => Loss 0.289, Train_accy 93.07:   5%|▌         | 1/20 [00:06<00:59,  3.13s/it]
Task 3, Epoch 2/20 => Loss 0.289, Train_accy 93.07:  10%|█         | 2/20 [00:06<00:55,  3.07s/it]
Task 3, Epoch 3/20 => Loss 0.094, Train_accy 98.35:  10%|█         | 2/20 [00:09<00:55,  3.07s/it]
Task 3, Epoch 3/20 => Loss 0.094, Train_accy 98.35:  15%|█▌        | 3/20 [00:09<00:52,  3.08s/it]
Task 3, Epoch 4/20 => Loss 0.065, Train_accy 98.35:  15%|█▌        | 3/20 [00:12<00:52,  3.08s/it]
Task 3, Epoch 4/20 => Loss 0.065, Train_accy 98.35:  20%|██        | 4/20 [00:12<00:48,  3.06s/it]
Task 3, Epoch 5/20 => Loss 0.050, Train_accy 98.68, Test_accy 83.35:  20%|██        | 4/20 [00:48<00:48,  3.06s/it]
Task 3, Epoch 5/20 => Loss 0.050, Train_accy 98.68, Test_accy 83.35:  25%|██▌       | 5/20 [00:48<03:45, 15.00s/it]
Task 3, Epoch 6/20 => Loss 0.076, Train_accy 99.01:  25%|██▌       | 5/20 [00:51<03:45, 15.00s/it]                 
Task 3, Epoch 6/20 => Loss 0.076, Train_accy 99.01:  30%|███       | 6/20 [00:51<02:33, 10.94s/it]
Task 3, Epoch 7/20 => Loss 0.024, Train_accy 99.67:  30%|███       | 6/20 [00:54<02:33, 10.94s/it]
Task 3, Epoch 7/20 => Loss 0.024, Train_accy 99.67:  35%|███▌      | 7/20 [00:54<01:48,  8.35s/it]
Task 3, Epoch 8/20 => Loss 0.044, Train_accy 98.68:  35%|███▌      | 7/20 [00:57<01:48,  8.35s/it]
Task 3, Epoch 8/20 => Loss 0.044, Train_accy 98.68:  40%|████      | 8/20 [00:57<01:19,  6.63s/it]
Task 3, Epoch 9/20 => Loss 0.034, Train_accy 99.67:  40%|████      | 8/20 [01:00<01:19,  6.63s/it]
Task 3, Epoch 9/20 => Loss 0.034, Train_accy 99.67:  45%|████▌     | 9/20 [01:00<01:00,  5.50s/it]
Task 3, Epoch 10/20 => Loss 0.027, Train_accy 99.34, Test_accy 83.82:  45%|████▌     | 9/20 [01:35<01:00,  5.50s/it]
Task 3, Epoch 10/20 => Loss 0.027, Train_accy 99.34, Test_accy 83.82:  50%|█████     | 10/20 [01:35<02:26, 14.69s/it]
Task 3, Epoch 11/20 => Loss 0.052, Train_accy 99.01:  50%|█████     | 10/20 [01:38<02:26, 14.69s/it]                 
Task 3, Epoch 11/20 => Loss 0.052, Train_accy 99.01:  55%|█████▌    | 11/20 [01:38<01:39, 11.05s/it]
Task 3, Epoch 12/20 => Loss 0.012, Train_accy 100.00:  55%|█████▌    | 11/20 [01:41<01:39, 11.05s/it]
Task 3, Epoch 12/20 => Loss 0.012, Train_accy 100.00:  60%|██████    | 12/20 [01:41<01:08,  8.58s/it]
Task 3, Epoch 13/20 => Loss 0.031, Train_accy 99.01:  60%|██████    | 12/20 [01:44<01:08,  8.58s/it] 
Task 3, Epoch 13/20 => Loss 0.031, Train_accy 99.01:  65%|██████▌   | 13/20 [01:44<00:47,  6.85s/it]
Task 3, Epoch 14/20 => Loss 0.021, Train_accy 99.67:  65%|██████▌   | 13/20 [01:47<00:47,  6.85s/it]
Task 3, Epoch 14/20 => Loss 0.021, Train_accy 99.67:  70%|███████   | 14/20 [01:47<00:33,  5.64s/it]
Task 3, Epoch 15/20 => Loss 0.061, Train_accy 98.68, Test_accy 83.87:  70%|███████   | 14/20 [02:22<00:33,  5.64s/it]
Task 3, Epoch 15/20 => Loss 0.061, Train_accy 98.68, Test_accy 83.87:  75%|███████▌  | 15/20 [02:22<01:12, 14.59s/it]
Task 3, Epoch 16/20 => Loss 0.018, Train_accy 99.67:  75%|███████▌  | 15/20 [02:25<01:12, 14.59s/it]                 
Task 3, Epoch 16/20 => Loss 0.018, Train_accy 99.67:  80%|████████  | 16/20 [02:25<00:44, 11.07s/it]
Task 3, Epoch 17/20 => Loss 0.009, Train_accy 99.67:  80%|████████  | 16/20 [02:28<00:44, 11.07s/it]
Task 3, Epoch 17/20 => Loss 0.009, Train_accy 99.67:  85%|████████▌ | 17/20 [02:28<00:25,  8.58s/it]
Task 3, Epoch 18/20 => Loss 0.019, Train_accy 99.67:  85%|████████▌ | 17/20 [02:31<00:25,  8.58s/it]
Task 3, Epoch 18/20 => Loss 0.019, Train_accy 99.67:  90%|█████████ | 18/20 [02:31<00:13,  6.86s/it]
Task 3, Epoch 19/20 => Loss 0.020, Train_accy 99.67:  90%|█████████ | 18/20 [02:33<00:13,  6.86s/it]
Task 3, Epoch 19/20 => Loss 0.020, Train_accy 99.67:  95%|█████████▌| 19/20 [02:33<00:05,  5.67s/it]
Task 3, Epoch 20/20 => Loss 0.015, Train_accy 99.67, Test_accy 83.66:  95%|█████████▌| 19/20 [03:08<00:05,  5.67s/it]
Task 3, Epoch 20/20 => Loss 0.015, Train_accy 99.67, Test_accy 83.66: 100%|██████████| 20/20 [03:08<00:00, 14.39s/it]
Task 3, Epoch 20/20 => Loss 0.015, Train_accy 99.67, Test_accy 83.66: 100%|██████████| 20/20 [03:08<00:00,  9.43s/it]2024-09-14 22:06:24,528 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.015, Train_accy 99.67, Test_accy 83.66

2024-09-14 22:06:57,615 [trainer.py] => No NME accuracy.
2024-09-14 22:06:57,615 [trainer.py] => CNN: {'total': 83.66, '00-09': 85.47, '10-19': 85.11, '20-29': 84.26, '30-39': 79.36, 'old': 84.87, 'new': 79.36}
2024-09-14 22:06:57,615 [trainer.py] => CNN top1 curve: [98.91, 97.23, 90.45, 83.66]
2024-09-14 22:06:57,615 [trainer.py] => CNN top5 curve: [100.0, 99.96, 99.6, 99.32]

Average Accuracy (CNN): 92.56
2024-09-14 22:06:57,615 [trainer.py] => Average Accuracy (CNN): 92.56 

2024-09-14 22:06:57,617 [trainer.py] => All params: 171927652
2024-09-14 22:06:57,618 [trainer.py] => Trainable params: 291890
2024-09-14 22:06:57,618 [dualprompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.213, Train_accy 58.95:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.213, Train_accy 58.95:   5%|▌         | 1/20 [00:05<01:36,  5.10s/it]
Task 4, Epoch 2/20 => Loss 0.362, Train_accy 89.51:   5%|▌         | 1/20 [00:10<01:36,  5.10s/it]
Task 4, Epoch 2/20 => Loss 0.362, Train_accy 89.51:  10%|█         | 2/20 [00:10<01:31,  5.09s/it]
Task 4, Epoch 3/20 => Loss 0.234, Train_accy 91.86:  10%|█         | 2/20 [00:15<01:31,  5.09s/it]
Task 4, Epoch 3/20 => Loss 0.234, Train_accy 91.86:  15%|█▌        | 3/20 [00:15<01:26,  5.10s/it]
Task 4, Epoch 4/20 => Loss 0.171, Train_accy 93.13:  15%|█▌        | 3/20 [00:20<01:26,  5.10s/it]
Task 4, Epoch 4/20 => Loss 0.171, Train_accy 93.13:  20%|██        | 4/20 [00:20<01:21,  5.10s/it]
Task 4, Epoch 5/20 => Loss 0.133, Train_accy 95.12, Test_accy 78.13:  20%|██        | 4/20 [01:13<01:21,  5.10s/it]
Task 4, Epoch 5/20 => Loss 0.133, Train_accy 95.12, Test_accy 78.13:  25%|██▌       | 5/20 [01:13<05:33, 22.26s/it]
Task 4, Epoch 6/20 => Loss 0.108, Train_accy 96.38:  25%|██▌       | 5/20 [01:17<05:33, 22.26s/it]                 
Task 4, Epoch 6/20 => Loss 0.108, Train_accy 96.38:  30%|███       | 6/20 [01:17<03:49, 16.36s/it]
Task 4, Epoch 7/20 => Loss 0.102, Train_accy 96.38:  30%|███       | 6/20 [01:23<03:49, 16.36s/it]
Task 4, Epoch 7/20 => Loss 0.102, Train_accy 96.38:  35%|███▌      | 7/20 [01:23<02:44, 12.68s/it]
Task 4, Epoch 8/20 => Loss 0.107, Train_accy 95.84:  35%|███▌      | 7/20 [01:28<02:44, 12.68s/it]
Task 4, Epoch 8/20 => Loss 0.107, Train_accy 95.84:  40%|████      | 8/20 [01:28<02:03, 10.27s/it]
Task 4, Epoch 9/20 => Loss 0.080, Train_accy 97.29:  40%|████      | 8/20 [01:33<02:03, 10.27s/it]
Task 4, Epoch 9/20 => Loss 0.080, Train_accy 97.29:  45%|████▌     | 9/20 [01:33<01:35,  8.66s/it]
Task 4, Epoch 10/20 => Loss 0.096, Train_accy 96.56, Test_accy 78.99:  45%|████▌     | 9/20 [02:25<01:35,  8.66s/it]
Task 4, Epoch 10/20 => Loss 0.096, Train_accy 96.56, Test_accy 78.99:  50%|█████     | 10/20 [02:25<03:41, 22.11s/it]
Task 4, Epoch 11/20 => Loss 0.125, Train_accy 95.84:  50%|█████     | 10/20 [02:30<03:41, 22.11s/it]                 
Task 4, Epoch 11/20 => Loss 0.125, Train_accy 95.84:  55%|█████▌    | 11/20 [02:30<02:32, 16.91s/it]
Task 4, Epoch 12/20 => Loss 0.085, Train_accy 97.11:  55%|█████▌    | 11/20 [02:35<02:32, 16.91s/it]
Task 4, Epoch 12/20 => Loss 0.085, Train_accy 97.11:  60%|██████    | 12/20 [02:35<01:46, 13.29s/it]
Task 4, Epoch 13/20 => Loss 0.060, Train_accy 98.19:  60%|██████    | 12/20 [02:40<01:46, 13.29s/it]
Task 4, Epoch 13/20 => Loss 0.060, Train_accy 98.19:  65%|██████▌   | 13/20 [02:40<01:15, 10.80s/it]
Task 4, Epoch 14/20 => Loss 0.074, Train_accy 96.75:  65%|██████▌   | 13/20 [02:45<01:15, 10.80s/it]
Task 4, Epoch 14/20 => Loss 0.074, Train_accy 96.75:  70%|███████   | 14/20 [02:45<00:54,  9.05s/it]
Task 4, Epoch 15/20 => Loss 0.081, Train_accy 96.56, Test_accy 78.64:  70%|███████   | 14/20 [03:40<00:54,  9.05s/it]
Task 4, Epoch 15/20 => Loss 0.081, Train_accy 96.56, Test_accy 78.64:  75%|███████▌  | 15/20 [03:40<01:53, 22.75s/it]
Task 4, Epoch 16/20 => Loss 0.091, Train_accy 97.29:  75%|███████▌  | 15/20 [03:45<01:53, 22.75s/it]                 
Task 4, Epoch 16/20 => Loss 0.091, Train_accy 97.29:  80%|████████  | 16/20 [03:45<01:09, 17.41s/it]
Task 4, Epoch 17/20 => Loss 0.064, Train_accy 98.01:  80%|████████  | 16/20 [03:50<01:09, 17.41s/it]
Task 4, Epoch 17/20 => Loss 0.064, Train_accy 98.01:  85%|████████▌ | 17/20 [03:50<00:40, 13.62s/it]
Task 4, Epoch 18/20 => Loss 0.066, Train_accy 97.29:  85%|████████▌ | 17/20 [03:54<00:40, 13.62s/it]
Task 4, Epoch 18/20 => Loss 0.066, Train_accy 97.29:  90%|█████████ | 18/20 [03:54<00:21, 10.96s/it]
Task 4, Epoch 19/20 => Loss 0.078, Train_accy 96.56:  90%|█████████ | 18/20 [03:59<00:21, 10.96s/it]
Task 4, Epoch 19/20 => Loss 0.078, Train_accy 96.56:  95%|█████████▌| 19/20 [03:59<00:09,  9.12s/it]
Task 4, Epoch 20/20 => Loss 0.058, Train_accy 96.93, Test_accy 79.57:  95%|█████████▌| 19/20 [04:52<00:09,  9.12s/it]
Task 4, Epoch 20/20 => Loss 0.058, Train_accy 96.93, Test_accy 79.57: 100%|██████████| 20/20 [04:52<00:00, 22.22s/it]
Task 4, Epoch 20/20 => Loss 0.058, Train_accy 96.93, Test_accy 79.57: 100%|██████████| 20/20 [04:52<00:00, 14.62s/it]2024-09-14 22:11:50,055 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.058, Train_accy 96.93, Test_accy 79.57

2024-09-14 22:12:38,205 [trainer.py] => No NME accuracy.
2024-09-14 22:12:38,206 [trainer.py] => CNN: {'total': 79.57, '00-09': 85.35, '10-19': 78.38, '20-29': 75.02, '30-39': 73.68, '40-49': 83.87, 'old': 77.4, 'new': 83.87}
2024-09-14 22:12:38,206 [trainer.py] => CNN top1 curve: [98.91, 97.23, 90.45, 83.66, 79.57]
2024-09-14 22:12:38,206 [trainer.py] => CNN top5 curve: [100.0, 99.96, 99.6, 99.32, 98.68]

Average Accuracy (CNN): 89.96
2024-09-14 22:12:38,206 [trainer.py] => Average Accuracy (CNN): 89.96 
Accuracy Matrix (CNN):
[[98.91 97.22 88.74 85.47 85.35]
 [ 0.   97.23 92.53 85.11 78.38]
 [ 0.    0.   88.73 84.26 75.02]
 [ 0.    0.    0.   79.36 73.68]
 [ 0.    0.    0.    0.   83.87]]
2024-09-14 22:12:38,208 [trainer.py] => Forgetting (CNN): 12.950000000000003
2024-09-14 22:12:40,655 [trainer.py] => config: ./exps/dualprompt_vtab_B0_Inc10.json
2024-09-14 22:12:40,667 [trainer.py] => prefix:  
2024-09-14 22:12:40,667 [trainer.py] => dataset: vtab
2024-09-14 22:12:40,667 [trainer.py] => memory_size: 0
2024-09-14 22:12:40,667 [trainer.py] => memory_per_class: 0
2024-09-14 22:12:40,667 [trainer.py] => fixed_memory: False
2024-09-14 22:12:40,667 [trainer.py] => shuffle: True
2024-09-14 22:12:40,667 [trainer.py] => init_cls: 5
2024-09-14 22:12:40,667 [trainer.py] => increment: 5
2024-09-14 22:12:40,668 [trainer.py] => model_name: dualprompt
2024-09-14 22:12:40,668 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-14 22:12:40,668 [trainer.py] => get_original_backbone: True
2024-09-14 22:12:40,668 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 22:12:40,668 [trainer.py] => seed: 1993
2024-09-14 22:12:40,668 [trainer.py] => tuned_epoch: 20
2024-09-14 22:12:40,668 [trainer.py] => init_lr: 0.001
2024-09-14 22:12:40,668 [trainer.py] => batch_size: 48
2024-09-14 22:12:40,668 [trainer.py] => weight_decay: 0
2024-09-14 22:12:40,668 [trainer.py] => min_lr: 1e-05
2024-09-14 22:12:40,668 [trainer.py] => optimizer: adam
2024-09-14 22:12:40,668 [trainer.py] => scheduler: constant
2024-09-14 22:12:40,669 [trainer.py] => reinit_optimizer: True
2024-09-14 22:12:40,669 [trainer.py] => global_pool: token
2024-09-14 22:12:40,669 [trainer.py] => head_type: token
2024-09-14 22:12:40,669 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-14 22:12:40,669 [trainer.py] => pretrained: True
2024-09-14 22:12:40,669 [trainer.py] => drop: 0.0
2024-09-14 22:12:40,669 [trainer.py] => drop_path: 0.0
2024-09-14 22:12:40,669 [trainer.py] => use_g_prompt: True
2024-09-14 22:12:40,669 [trainer.py] => g_prompt_length: 5
2024-09-14 22:12:40,669 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-14 22:12:40,669 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-14 22:12:40,669 [trainer.py] => use_e_prompt: True
2024-09-14 22:12:40,669 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-14 22:12:40,670 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-14 22:12:40,670 [trainer.py] => prompt_pool: True
2024-09-14 22:12:40,670 [trainer.py] => size: 10
2024-09-14 22:12:40,670 [trainer.py] => length: 5
2024-09-14 22:12:40,670 [trainer.py] => top_k: 1
2024-09-14 22:12:40,670 [trainer.py] => initializer: uniform
2024-09-14 22:12:40,670 [trainer.py] => prompt_key: True
2024-09-14 22:12:40,670 [trainer.py] => prompt_key_init: uniform
2024-09-14 22:12:40,670 [trainer.py] => use_prompt_mask: True
2024-09-14 22:12:40,670 [trainer.py] => shared_prompt_pool: True
2024-09-14 22:12:40,670 [trainer.py] => shared_prompt_key: False
2024-09-14 22:12:40,670 [trainer.py] => batchwise_prompt: True
2024-09-14 22:12:40,670 [trainer.py] => embedding_key: cls
2024-09-14 22:12:40,671 [trainer.py] => predefined_key: 
2024-09-14 22:12:40,671 [trainer.py] => pull_constraint: True
2024-09-14 22:12:40,671 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-14 22:12:40,671 [trainer.py] => same_key_value: False
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 22:12:40,731 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-09-14 22:12:46,157 [dualprompt.py] => 86,090,546 model total parameters.
2024-09-14 22:12:46,158 [dualprompt.py] => 291,890 model training parameters.
2024-09-14 22:12:46,158 [dualprompt.py] => g_prompt: 15360
2024-09-14 22:12:46,158 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-14 22:12:46,158 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-14 22:12:46,158 [dualprompt.py] => head.weight: 38400
2024-09-14 22:12:46,158 [dualprompt.py] => head.bias: 50
2024-09-14 22:12:46,159 [trainer.py] => All params: 171927652
2024-09-14 22:12:46,160 [trainer.py] => Trainable params: 291890
2024-09-14 22:12:46,160 [dualprompt.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.643, Train_accy 16.48:   0%|          | 0/20 [00:01<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.643, Train_accy 16.48:   5%|▌         | 1/20 [00:01<00:32,  1.72s/it]
Task 0, Epoch 2/20 => Loss 1.441, Train_accy 36.26:   5%|▌         | 1/20 [00:03<00:32,  1.72s/it]
Task 0, Epoch 2/20 => Loss 1.441, Train_accy 36.26:  10%|█         | 2/20 [00:03<00:26,  1.48s/it]
Task 0, Epoch 3/20 => Loss 0.736, Train_accy 79.12:  10%|█         | 2/20 [00:04<00:26,  1.48s/it]
Task 0, Epoch 3/20 => Loss 0.736, Train_accy 79.12:  15%|█▌        | 3/20 [00:04<00:23,  1.40s/it]
Task 0, Epoch 4/20 => Loss 0.418, Train_accy 90.11:  15%|█▌        | 3/20 [00:05<00:23,  1.40s/it]
Task 0, Epoch 4/20 => Loss 0.418, Train_accy 90.11:  20%|██        | 4/20 [00:05<00:21,  1.34s/it]
Task 0, Epoch 5/20 => Loss 0.287, Train_accy 93.41, Test_accy 93.71:  20%|██        | 4/20 [00:09<00:21,  1.34s/it]
Task 0, Epoch 5/20 => Loss 0.287, Train_accy 93.41, Test_accy 93.71:  25%|██▌       | 5/20 [00:09<00:31,  2.13s/it]
Task 0, Epoch 6/20 => Loss 0.212, Train_accy 93.41:  25%|██▌       | 5/20 [00:10<00:31,  2.13s/it]                 
Task 0, Epoch 6/20 => Loss 0.212, Train_accy 93.41:  30%|███       | 6/20 [00:10<00:25,  1.84s/it]
Task 0, Epoch 7/20 => Loss 0.157, Train_accy 94.51:  30%|███       | 6/20 [00:11<00:25,  1.84s/it]
Task 0, Epoch 7/20 => Loss 0.157, Train_accy 94.51:  35%|███▌      | 7/20 [00:11<00:21,  1.63s/it]
Task 0, Epoch 8/20 => Loss 0.091, Train_accy 98.90:  35%|███▌      | 7/20 [00:12<00:21,  1.63s/it]
Task 0, Epoch 8/20 => Loss 0.091, Train_accy 98.90:  40%|████      | 8/20 [00:12<00:18,  1.51s/it]
Task 0, Epoch 9/20 => Loss 0.077, Train_accy 96.70:  40%|████      | 8/20 [00:14<00:18,  1.51s/it]
Task 0, Epoch 9/20 => Loss 0.077, Train_accy 96.70:  45%|████▌     | 9/20 [00:14<00:15,  1.43s/it]
Task 0, Epoch 10/20 => Loss 0.064, Train_accy 98.90, Test_accy 96.50:  45%|████▌     | 9/20 [00:17<00:15,  1.43s/it]
Task 0, Epoch 10/20 => Loss 0.064, Train_accy 98.90, Test_accy 96.50:  50%|█████     | 10/20 [00:17<00:20,  2.09s/it]
Task 0, Epoch 11/20 => Loss 0.045, Train_accy 100.00:  50%|█████     | 10/20 [00:18<00:20,  2.09s/it]                
Task 0, Epoch 11/20 => Loss 0.045, Train_accy 100.00:  55%|█████▌    | 11/20 [00:18<00:16,  1.83s/it]
Task 0, Epoch 12/20 => Loss 0.036, Train_accy 98.90:  55%|█████▌    | 11/20 [00:20<00:16,  1.83s/it] 
Task 0, Epoch 12/20 => Loss 0.036, Train_accy 98.90:  60%|██████    | 12/20 [00:20<00:13,  1.65s/it]
Task 0, Epoch 13/20 => Loss 0.045, Train_accy 98.90:  60%|██████    | 12/20 [00:21<00:13,  1.65s/it]
Task 0, Epoch 13/20 => Loss 0.045, Train_accy 98.90:  65%|██████▌   | 13/20 [00:21<00:10,  1.56s/it]
Task 0, Epoch 14/20 => Loss 0.024, Train_accy 100.00:  65%|██████▌   | 13/20 [00:22<00:10,  1.56s/it]
Task 0, Epoch 14/20 => Loss 0.024, Train_accy 100.00:  70%|███████   | 14/20 [00:22<00:08,  1.46s/it]
Task 0, Epoch 15/20 => Loss 0.018, Train_accy 100.00, Test_accy 97.20:  70%|███████   | 14/20 [00:26<00:08,  1.46s/it]
Task 0, Epoch 15/20 => Loss 0.018, Train_accy 100.00, Test_accy 97.20:  75%|███████▌  | 15/20 [00:26<00:10,  2.17s/it]
Task 0, Epoch 16/20 => Loss 0.028, Train_accy 100.00:  75%|███████▌  | 15/20 [00:27<00:10,  2.17s/it]                 
Task 0, Epoch 16/20 => Loss 0.028, Train_accy 100.00:  80%|████████  | 16/20 [00:27<00:07,  1.90s/it]
Task 0, Epoch 17/20 => Loss 0.010, Train_accy 100.00:  80%|████████  | 16/20 [00:29<00:07,  1.90s/it]
Task 0, Epoch 17/20 => Loss 0.010, Train_accy 100.00:  85%|████████▌ | 17/20 [00:29<00:05,  1.71s/it]
Task 0, Epoch 18/20 => Loss 0.035, Train_accy 98.90:  85%|████████▌ | 17/20 [00:30<00:05,  1.71s/it] 
Task 0, Epoch 18/20 => Loss 0.035, Train_accy 98.90:  90%|█████████ | 18/20 [00:30<00:03,  1.58s/it]
Task 0, Epoch 19/20 => Loss 0.037, Train_accy 98.90:  90%|█████████ | 18/20 [00:31<00:03,  1.58s/it]
Task 0, Epoch 19/20 => Loss 0.037, Train_accy 98.90:  95%|█████████▌| 19/20 [00:31<00:01,  1.48s/it]
Task 0, Epoch 20/20 => Loss 0.029, Train_accy 100.00, Test_accy 97.20:  95%|█████████▌| 19/20 [00:35<00:01,  1.48s/it]
Task 0, Epoch 20/20 => Loss 0.029, Train_accy 100.00, Test_accy 97.20: 100%|██████████| 20/20 [00:35<00:00,  2.12s/it]
Task 0, Epoch 20/20 => Loss 0.029, Train_accy 100.00, Test_accy 97.20: 100%|██████████| 20/20 [00:35<00:00,  1.76s/it]2024-09-14 22:13:21,992 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.029, Train_accy 100.00, Test_accy 97.20

2024-09-14 22:13:24,268 [trainer.py] => No NME accuracy.
2024-09-14 22:13:24,268 [trainer.py] => CNN: {'total': 97.2, '00-04': 97.2, 'old': 0, 'new': 97.2}
2024-09-14 22:13:24,268 [trainer.py] => CNN top1 curve: [97.2]
2024-09-14 22:13:24,269 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.2
2024-09-14 22:13:24,269 [trainer.py] => Average Accuracy (CNN): 97.2 

2024-09-14 22:13:24,272 [trainer.py] => All params: 171927652
2024-09-14 22:13:24,274 [trainer.py] => Trainable params: 291890
2024-09-14 22:13:24,274 [dualprompt.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.513, Train_accy 32.86:   0%|          | 0/20 [00:01<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.513, Train_accy 32.86:   5%|▌         | 1/20 [00:01<00:19,  1.02s/it]
Task 1, Epoch 2/20 => Loss 0.668, Train_accy 80.00:   5%|▌         | 1/20 [00:02<00:19,  1.02s/it]
Task 1, Epoch 2/20 => Loss 0.668, Train_accy 80.00:  10%|█         | 2/20 [00:02<00:19,  1.08s/it]
Task 1, Epoch 3/20 => Loss 0.331, Train_accy 94.29:  10%|█         | 2/20 [00:03<00:19,  1.08s/it]
Task 1, Epoch 3/20 => Loss 0.331, Train_accy 94.29:  15%|█▌        | 3/20 [00:03<00:18,  1.09s/it]
Task 1, Epoch 4/20 => Loss 0.144, Train_accy 100.00:  15%|█▌        | 3/20 [00:04<00:18,  1.09s/it]
Task 1, Epoch 4/20 => Loss 0.144, Train_accy 100.00:  20%|██        | 4/20 [00:04<00:17,  1.11s/it]
Task 1, Epoch 5/20 => Loss 0.109, Train_accy 98.57, Test_accy 95.40:  20%|██        | 4/20 [00:11<00:17,  1.11s/it]
Task 1, Epoch 5/20 => Loss 0.109, Train_accy 98.57, Test_accy 95.40:  25%|██▌       | 5/20 [00:11<00:47,  3.14s/it]
Task 1, Epoch 6/20 => Loss 0.071, Train_accy 98.57:  25%|██▌       | 5/20 [00:12<00:47,  3.14s/it]                 
Task 1, Epoch 6/20 => Loss 0.071, Train_accy 98.57:  30%|███       | 6/20 [00:12<00:35,  2.50s/it]
Task 1, Epoch 7/20 => Loss 0.034, Train_accy 100.00:  30%|███       | 6/20 [00:13<00:35,  2.50s/it]
Task 1, Epoch 7/20 => Loss 0.034, Train_accy 100.00:  35%|███▌      | 7/20 [00:13<00:26,  2.03s/it]
Task 1, Epoch 8/20 => Loss 0.028, Train_accy 100.00:  35%|███▌      | 7/20 [00:14<00:26,  2.03s/it]
Task 1, Epoch 8/20 => Loss 0.028, Train_accy 100.00:  40%|████      | 8/20 [00:14<00:20,  1.73s/it]
Task 1, Epoch 9/20 => Loss 0.033, Train_accy 100.00:  40%|████      | 8/20 [00:15<00:20,  1.73s/it]
Task 1, Epoch 9/20 => Loss 0.033, Train_accy 100.00:  45%|████▌     | 9/20 [00:15<00:16,  1.53s/it]
Task 1, Epoch 10/20 => Loss 0.047, Train_accy 100.00, Test_accy 97.58:  45%|████▌     | 9/20 [00:21<00:16,  1.53s/it]
Task 1, Epoch 10/20 => Loss 0.047, Train_accy 100.00, Test_accy 97.58:  50%|█████     | 10/20 [00:21<00:29,  2.96s/it]
Task 1, Epoch 11/20 => Loss 0.085, Train_accy 98.57:  50%|█████     | 10/20 [00:22<00:29,  2.96s/it]                  
Task 1, Epoch 11/20 => Loss 0.085, Train_accy 98.57:  55%|█████▌    | 11/20 [00:22<00:21,  2.38s/it]
Task 1, Epoch 12/20 => Loss 0.008, Train_accy 100.00:  55%|█████▌    | 11/20 [00:23<00:21,  2.38s/it]
Task 1, Epoch 12/20 => Loss 0.008, Train_accy 100.00:  60%|██████    | 12/20 [00:23<00:15,  1.98s/it]
Task 1, Epoch 13/20 => Loss 0.014, Train_accy 100.00:  60%|██████    | 12/20 [00:24<00:15,  1.98s/it]
Task 1, Epoch 13/20 => Loss 0.014, Train_accy 100.00:  65%|██████▌   | 13/20 [00:24<00:11,  1.70s/it]
Task 1, Epoch 14/20 => Loss 0.041, Train_accy 100.00:  65%|██████▌   | 13/20 [00:26<00:11,  1.70s/it]
Task 1, Epoch 14/20 => Loss 0.041, Train_accy 100.00:  70%|███████   | 14/20 [00:26<00:09,  1.51s/it]
Task 1, Epoch 15/20 => Loss 0.006, Train_accy 100.00, Test_accy 97.46:  70%|███████   | 14/20 [00:31<00:09,  1.51s/it]
Task 1, Epoch 15/20 => Loss 0.006, Train_accy 100.00, Test_accy 97.46:  75%|███████▌  | 15/20 [00:31<00:14,  2.85s/it]
Task 1, Epoch 16/20 => Loss 0.032, Train_accy 98.57:  75%|███████▌  | 15/20 [00:33<00:14,  2.85s/it]                  
Task 1, Epoch 16/20 => Loss 0.032, Train_accy 98.57:  80%|████████  | 16/20 [00:33<00:09,  2.34s/it]
Task 1, Epoch 17/20 => Loss 0.013, Train_accy 100.00:  80%|████████  | 16/20 [00:34<00:09,  2.34s/it]
Task 1, Epoch 17/20 => Loss 0.013, Train_accy 100.00:  85%|████████▌ | 17/20 [00:34<00:05,  1.95s/it]
Task 1, Epoch 18/20 => Loss 0.004, Train_accy 100.00:  85%|████████▌ | 17/20 [00:35<00:05,  1.95s/it]
Task 1, Epoch 18/20 => Loss 0.004, Train_accy 100.00:  90%|█████████ | 18/20 [00:35<00:03,  1.69s/it]
Task 1, Epoch 19/20 => Loss 0.026, Train_accy 98.57:  90%|█████████ | 18/20 [00:36<00:03,  1.69s/it] 
Task 1, Epoch 19/20 => Loss 0.026, Train_accy 98.57:  95%|█████████▌| 19/20 [00:36<00:01,  1.51s/it]
Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.46:  95%|█████████▌| 19/20 [00:42<00:01,  1.51s/it]
Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.46: 100%|██████████| 20/20 [00:42<00:00,  2.94s/it]
Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.46: 100%|██████████| 20/20 [00:42<00:00,  2.13s/it]2024-09-14 22:14:06,920 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.46

2024-09-14 22:14:11,943 [trainer.py] => No NME accuracy.
2024-09-14 22:14:11,944 [trainer.py] => CNN: {'total': 97.46, '00-04': 92.66, '05-09': 100.0, 'old': 92.66, 'new': 100.0}
2024-09-14 22:14:11,944 [trainer.py] => CNN top1 curve: [97.2, 97.46]
2024-09-14 22:14:11,944 [trainer.py] => CNN top5 curve: [100.0, 99.88]

Average Accuracy (CNN): 97.33
2024-09-14 22:14:11,945 [trainer.py] => Average Accuracy (CNN): 97.33 

2024-09-14 22:14:11,948 [trainer.py] => All params: 171927652
2024-09-14 22:14:11,950 [trainer.py] => Trainable params: 291890
2024-09-14 22:14:11,950 [dualprompt.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.743, Train_accy 27.54:   0%|          | 0/20 [00:01<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.743, Train_accy 27.54:   5%|▌         | 1/20 [00:01<00:28,  1.53s/it]
Task 2, Epoch 2/20 => Loss 0.669, Train_accy 86.23:   5%|▌         | 1/20 [00:03<00:28,  1.53s/it]
Task 2, Epoch 2/20 => Loss 0.669, Train_accy 86.23:  10%|█         | 2/20 [00:03<00:28,  1.56s/it]
Task 2, Epoch 3/20 => Loss 0.306, Train_accy 93.48:  10%|█         | 2/20 [00:04<00:28,  1.56s/it]
Task 2, Epoch 3/20 => Loss 0.306, Train_accy 93.48:  15%|█▌        | 3/20 [00:04<00:27,  1.62s/it]
Task 2, Epoch 4/20 => Loss 0.111, Train_accy 98.55:  15%|█▌        | 3/20 [00:06<00:27,  1.62s/it]
Task 2, Epoch 4/20 => Loss 0.111, Train_accy 98.55:  20%|██        | 4/20 [00:06<00:27,  1.74s/it]
Task 2, Epoch 5/20 => Loss 0.089, Train_accy 97.83, Test_accy 97.01:  20%|██        | 4/20 [00:17<00:27,  1.74s/it]
Task 2, Epoch 5/20 => Loss 0.089, Train_accy 97.83, Test_accy 97.01:  25%|██▌       | 5/20 [00:17<01:13,  4.91s/it]
Task 2, Epoch 6/20 => Loss 0.059, Train_accy 98.55:  25%|██▌       | 5/20 [00:18<01:13,  4.91s/it]                 
Task 2, Epoch 6/20 => Loss 0.059, Train_accy 98.55:  30%|███       | 6/20 [00:18<00:53,  3.80s/it]
Task 2, Epoch 7/20 => Loss 0.027, Train_accy 100.00:  30%|███       | 6/20 [00:20<00:53,  3.80s/it]
Task 2, Epoch 7/20 => Loss 0.027, Train_accy 100.00:  35%|███▌      | 7/20 [00:20<00:40,  3.09s/it]
Task 2, Epoch 8/20 => Loss 0.021, Train_accy 99.28:  35%|███▌      | 7/20 [00:22<00:40,  3.09s/it] 
Task 2, Epoch 8/20 => Loss 0.021, Train_accy 99.28:  40%|████      | 8/20 [00:22<00:31,  2.61s/it]
Task 2, Epoch 9/20 => Loss 0.014, Train_accy 99.28:  40%|████      | 8/20 [00:23<00:31,  2.61s/it]
Task 2, Epoch 9/20 => Loss 0.014, Train_accy 99.28:  45%|████▌     | 9/20 [00:23<00:25,  2.29s/it]
Task 2, Epoch 10/20 => Loss 0.021, Train_accy 99.28, Test_accy 97.57:  45%|████▌     | 9/20 [00:33<00:25,  2.29s/it]
Task 2, Epoch 10/20 => Loss 0.021, Train_accy 99.28, Test_accy 97.57:  50%|█████     | 10/20 [00:33<00:46,  4.64s/it]
Task 2, Epoch 11/20 => Loss 0.008, Train_accy 100.00:  50%|█████     | 10/20 [00:35<00:46,  4.64s/it]                
Task 2, Epoch 11/20 => Loss 0.008, Train_accy 100.00:  55%|█████▌    | 11/20 [00:35<00:33,  3.68s/it]
Task 2, Epoch 12/20 => Loss 0.010, Train_accy 100.00:  55%|█████▌    | 11/20 [00:36<00:33,  3.68s/it]
Task 2, Epoch 12/20 => Loss 0.010, Train_accy 100.00:  60%|██████    | 12/20 [00:36<00:24,  3.02s/it]
Task 2, Epoch 13/20 => Loss 0.027, Train_accy 99.28:  60%|██████    | 12/20 [00:38<00:24,  3.02s/it] 
Task 2, Epoch 13/20 => Loss 0.027, Train_accy 99.28:  65%|██████▌   | 13/20 [00:38<00:18,  2.59s/it]
Task 2, Epoch 14/20 => Loss 0.063, Train_accy 98.55:  65%|██████▌   | 13/20 [00:39<00:18,  2.59s/it]
Task 2, Epoch 14/20 => Loss 0.063, Train_accy 98.55:  70%|███████   | 14/20 [00:39<00:13,  2.27s/it]
Task 2, Epoch 15/20 => Loss 0.016, Train_accy 99.28, Test_accy 97.50:  70%|███████   | 14/20 [00:49<00:13,  2.27s/it]
Task 2, Epoch 15/20 => Loss 0.016, Train_accy 99.28, Test_accy 97.50:  75%|███████▌  | 15/20 [00:49<00:22,  4.51s/it]
Task 2, Epoch 16/20 => Loss 0.016, Train_accy 99.28:  75%|███████▌  | 15/20 [00:50<00:22,  4.51s/it]                 
Task 2, Epoch 16/20 => Loss 0.016, Train_accy 99.28:  80%|████████  | 16/20 [00:50<00:14,  3.60s/it]
Task 2, Epoch 17/20 => Loss 0.027, Train_accy 99.28:  80%|████████  | 16/20 [00:52<00:14,  3.60s/it]
Task 2, Epoch 17/20 => Loss 0.027, Train_accy 99.28:  85%|████████▌ | 17/20 [00:52<00:08,  2.98s/it]
Task 2, Epoch 18/20 => Loss 0.013, Train_accy 99.28:  85%|████████▌ | 17/20 [00:53<00:08,  2.98s/it]
Task 2, Epoch 18/20 => Loss 0.013, Train_accy 99.28:  90%|█████████ | 18/20 [00:53<00:05,  2.53s/it]
Task 2, Epoch 19/20 => Loss 0.000, Train_accy 100.00:  90%|█████████ | 18/20 [00:55<00:05,  2.53s/it]
Task 2, Epoch 19/20 => Loss 0.000, Train_accy 100.00:  95%|█████████▌| 19/20 [00:55<00:02,  2.25s/it]
Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.50:  95%|█████████▌| 19/20 [01:06<00:02,  2.25s/it]
Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.50: 100%|██████████| 20/20 [01:06<00:00,  4.71s/it]
Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.50: 100%|██████████| 20/20 [01:06<00:00,  3.30s/it]2024-09-14 22:15:17,965 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.50

2024-09-14 22:15:26,730 [trainer.py] => No NME accuracy.
2024-09-14 22:15:26,730 [trainer.py] => CNN: {'total': 97.5, '00-04': 91.96, '05-09': 99.07, '10-14': 98.69, 'old': 96.61, 'new': 98.69}
2024-09-14 22:15:26,730 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5]
2024-09-14 22:15:26,730 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72]

Average Accuracy (CNN): 97.39
2024-09-14 22:15:26,730 [trainer.py] => Average Accuracy (CNN): 97.39 

2024-09-14 22:15:26,733 [trainer.py] => All params: 171927652
2024-09-14 22:15:26,734 [trainer.py] => Trainable params: 291890
2024-09-14 22:15:26,734 [dualprompt.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.122, Train_accy 60.87:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.122, Train_accy 60.87:   5%|▌         | 1/20 [00:02<00:50,  2.67s/it]
Task 3, Epoch 2/20 => Loss 0.391, Train_accy 89.49:   5%|▌         | 1/20 [00:05<00:50,  2.67s/it]
Task 3, Epoch 2/20 => Loss 0.391, Train_accy 89.49:  10%|█         | 2/20 [00:05<00:48,  2.72s/it]
Task 3, Epoch 3/20 => Loss 0.244, Train_accy 90.94:  10%|█         | 2/20 [00:08<00:48,  2.72s/it]
Task 3, Epoch 3/20 => Loss 0.244, Train_accy 90.94:  15%|█▌        | 3/20 [00:08<00:45,  2.69s/it]
Task 3, Epoch 4/20 => Loss 0.127, Train_accy 96.01:  15%|█▌        | 3/20 [00:10<00:45,  2.69s/it]
Task 3, Epoch 4/20 => Loss 0.127, Train_accy 96.01:  20%|██        | 4/20 [00:10<00:43,  2.73s/it]
Task 3, Epoch 5/20 => Loss 0.198, Train_accy 92.75, Test_accy 89.53:  20%|██        | 4/20 [00:30<00:43,  2.73s/it]
Task 3, Epoch 5/20 => Loss 0.198, Train_accy 92.75, Test_accy 89.53:  25%|██▌       | 5/20 [00:30<02:11,  8.74s/it]
Task 3, Epoch 6/20 => Loss 0.161, Train_accy 93.48:  25%|██▌       | 5/20 [00:33<02:11,  8.74s/it]                 
Task 3, Epoch 6/20 => Loss 0.161, Train_accy 93.48:  30%|███       | 6/20 [00:33<01:34,  6.71s/it]
Task 3, Epoch 7/20 => Loss 0.120, Train_accy 95.65:  30%|███       | 6/20 [00:35<01:34,  6.71s/it]
Task 3, Epoch 7/20 => Loss 0.120, Train_accy 95.65:  35%|███▌      | 7/20 [00:35<01:11,  5.47s/it]
Task 3, Epoch 8/20 => Loss 0.119, Train_accy 94.57:  35%|███▌      | 7/20 [00:38<01:11,  5.47s/it]
Task 3, Epoch 8/20 => Loss 0.119, Train_accy 94.57:  40%|████      | 8/20 [00:38<00:55,  4.59s/it]
Task 3, Epoch 9/20 => Loss 0.100, Train_accy 96.74:  40%|████      | 8/20 [00:41<00:55,  4.59s/it]
Task 3, Epoch 9/20 => Loss 0.100, Train_accy 96.74:  45%|████▌     | 9/20 [00:41<00:44,  4.00s/it]
Task 3, Epoch 10/20 => Loss 0.109, Train_accy 97.46, Test_accy 92.17:  45%|████▌     | 9/20 [01:00<00:44,  4.00s/it]
Task 3, Epoch 10/20 => Loss 0.109, Train_accy 97.46, Test_accy 92.17:  50%|█████     | 10/20 [01:00<01:27,  8.80s/it]
Task 3, Epoch 11/20 => Loss 0.089, Train_accy 97.46:  50%|█████     | 10/20 [01:03<01:27,  8.80s/it]                 
Task 3, Epoch 11/20 => Loss 0.089, Train_accy 97.46:  55%|█████▌    | 11/20 [01:03<01:02,  6.92s/it]
Task 3, Epoch 12/20 => Loss 0.064, Train_accy 98.19:  55%|█████▌    | 11/20 [01:06<01:02,  6.92s/it]
Task 3, Epoch 12/20 => Loss 0.064, Train_accy 98.19:  60%|██████    | 12/20 [01:06<00:44,  5.62s/it]
Task 3, Epoch 13/20 => Loss 0.060, Train_accy 97.83:  60%|██████    | 12/20 [01:09<00:44,  5.62s/it]
Task 3, Epoch 13/20 => Loss 0.060, Train_accy 97.83:  65%|██████▌   | 13/20 [01:09<00:33,  4.76s/it]
Task 3, Epoch 14/20 => Loss 0.063, Train_accy 97.46:  65%|██████▌   | 13/20 [01:11<00:33,  4.76s/it]
Task 3, Epoch 14/20 => Loss 0.063, Train_accy 97.46:  70%|███████   | 14/20 [01:11<00:24,  4.12s/it]
Task 3, Epoch 15/20 => Loss 0.073, Train_accy 96.74, Test_accy 94.20:  70%|███████   | 14/20 [01:30<00:24,  4.12s/it]
Task 3, Epoch 15/20 => Loss 0.073, Train_accy 96.74, Test_accy 94.20:  75%|███████▌  | 15/20 [01:30<00:42,  8.42s/it]
Task 3, Epoch 16/20 => Loss 0.095, Train_accy 96.01:  75%|███████▌  | 15/20 [01:32<00:42,  8.42s/it]                 
Task 3, Epoch 16/20 => Loss 0.095, Train_accy 96.01:  80%|████████  | 16/20 [01:32<00:26,  6.68s/it]
Task 3, Epoch 17/20 => Loss 0.084, Train_accy 97.46:  80%|████████  | 16/20 [01:35<00:26,  6.68s/it]
Task 3, Epoch 17/20 => Loss 0.084, Train_accy 97.46:  85%|████████▌ | 17/20 [01:35<00:16,  5.42s/it]
Task 3, Epoch 18/20 => Loss 0.098, Train_accy 96.38:  85%|████████▌ | 17/20 [01:37<00:16,  5.42s/it]
Task 3, Epoch 18/20 => Loss 0.098, Train_accy 96.38:  90%|█████████ | 18/20 [01:37<00:09,  4.55s/it]
Task 3, Epoch 19/20 => Loss 0.046, Train_accy 97.10:  90%|█████████ | 18/20 [01:40<00:09,  4.55s/it]
Task 3, Epoch 19/20 => Loss 0.046, Train_accy 97.10:  95%|█████████▌| 19/20 [01:40<00:03,  3.95s/it]
Task 3, Epoch 20/20 => Loss 0.045, Train_accy 97.83, Test_accy 95.08:  95%|█████████▌| 19/20 [01:59<00:03,  3.95s/it]
Task 3, Epoch 20/20 => Loss 0.045, Train_accy 97.83, Test_accy 95.08: 100%|██████████| 20/20 [01:59<00:00,  8.48s/it]
Task 3, Epoch 20/20 => Loss 0.045, Train_accy 97.83, Test_accy 95.08: 100%|██████████| 20/20 [01:59<00:00,  5.96s/it]2024-09-14 22:17:26,017 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.045, Train_accy 97.83, Test_accy 95.08

2024-09-14 22:17:42,611 [trainer.py] => No NME accuracy.
2024-09-14 22:17:42,612 [trainer.py] => CNN: {'total': 95.08, '00-04': 91.61, '05-09': 99.07, '10-14': 97.88, '15-19': 93.04, 'old': 97.08, 'new': 93.04}
2024-09-14 22:17:42,612 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5, 95.08]
2024-09-14 22:17:42,612 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72]

Average Accuracy (CNN): 96.81
2024-09-14 22:17:42,612 [trainer.py] => Average Accuracy (CNN): 96.81 

2024-09-14 22:17:42,615 [trainer.py] => All params: 171927652
2024-09-14 22:17:42,617 [trainer.py] => Trainable params: 291890
2024-09-14 22:17:42,617 [dualprompt.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.393, Train_accy 43.20:   0%|          | 0/20 [00:02<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.393, Train_accy 43.20:   5%|▌         | 1/20 [00:02<00:44,  2.35s/it]
Task 4, Epoch 2/20 => Loss 0.469, Train_accy 83.20:   5%|▌         | 1/20 [00:04<00:44,  2.35s/it]
Task 4, Epoch 2/20 => Loss 0.469, Train_accy 83.20:  10%|█         | 2/20 [00:04<00:42,  2.35s/it]
Task 4, Epoch 3/20 => Loss 0.224, Train_accy 91.60:  10%|█         | 2/20 [00:07<00:42,  2.35s/it]
Task 4, Epoch 3/20 => Loss 0.224, Train_accy 91.60:  15%|█▌        | 3/20 [00:07<00:41,  2.43s/it]
Task 4, Epoch 4/20 => Loss 0.268, Train_accy 90.40:  15%|█▌        | 3/20 [00:09<00:41,  2.43s/it]
Task 4, Epoch 4/20 => Loss 0.268, Train_accy 90.40:  20%|██        | 4/20 [00:09<00:38,  2.39s/it]
Task 4, Epoch 5/20 => Loss 0.157, Train_accy 94.00, Test_accy 81.50:  20%|██        | 4/20 [00:34<00:38,  2.39s/it]
Task 4, Epoch 5/20 => Loss 0.157, Train_accy 94.00, Test_accy 81.50:  25%|██▌       | 5/20 [00:34<02:35, 10.38s/it]
Task 4, Epoch 6/20 => Loss 0.185, Train_accy 94.80:  25%|██▌       | 5/20 [00:36<02:35, 10.38s/it]                 
Task 4, Epoch 6/20 => Loss 0.185, Train_accy 94.80:  30%|███       | 6/20 [00:36<01:47,  7.71s/it]
Task 4, Epoch 7/20 => Loss 0.077, Train_accy 98.00:  30%|███       | 6/20 [00:39<01:47,  7.71s/it]
Task 4, Epoch 7/20 => Loss 0.077, Train_accy 98.00:  35%|███▌      | 7/20 [00:39<01:18,  6.03s/it]
Task 4, Epoch 8/20 => Loss 0.106, Train_accy 96.40:  35%|███▌      | 7/20 [00:41<01:18,  6.03s/it]
Task 4, Epoch 8/20 => Loss 0.106, Train_accy 96.40:  40%|████      | 8/20 [00:41<00:58,  4.90s/it]
Task 4, Epoch 9/20 => Loss 0.075, Train_accy 98.00:  40%|████      | 8/20 [00:44<00:58,  4.90s/it]
Task 4, Epoch 9/20 => Loss 0.075, Train_accy 98.00:  45%|████▌     | 9/20 [00:44<00:45,  4.13s/it]
Task 4, Epoch 10/20 => Loss 0.079, Train_accy 97.20, Test_accy 86.42:  45%|████▌     | 9/20 [01:10<00:45,  4.13s/it]
Task 4, Epoch 10/20 => Loss 0.079, Train_accy 97.20, Test_accy 86.42:  50%|█████     | 10/20 [01:10<01:49, 11.00s/it]
Task 4, Epoch 11/20 => Loss 0.077, Train_accy 97.20:  50%|█████     | 10/20 [01:13<01:49, 11.00s/it]                 
Task 4, Epoch 11/20 => Loss 0.077, Train_accy 97.20:  55%|█████▌    | 11/20 [01:13<01:15,  8.41s/it]
Task 4, Epoch 12/20 => Loss 0.061, Train_accy 98.40:  55%|█████▌    | 11/20 [01:15<01:15,  8.41s/it]
Task 4, Epoch 12/20 => Loss 0.061, Train_accy 98.40:  60%|██████    | 12/20 [01:15<00:53,  6.63s/it]
Task 4, Epoch 13/20 => Loss 0.065, Train_accy 98.00:  60%|██████    | 12/20 [01:18<00:53,  6.63s/it]
Task 4, Epoch 13/20 => Loss 0.065, Train_accy 98.00:  65%|██████▌   | 13/20 [01:18<00:37,  5.37s/it]
Task 4, Epoch 14/20 => Loss 0.073, Train_accy 98.40:  65%|██████▌   | 13/20 [01:20<00:37,  5.37s/it]
Task 4, Epoch 14/20 => Loss 0.073, Train_accy 98.40:  70%|███████   | 14/20 [01:20<00:27,  4.53s/it]
Task 4, Epoch 15/20 => Loss 0.068, Train_accy 98.00, Test_accy 87.03:  70%|███████   | 14/20 [01:46<00:27,  4.53s/it]
Task 4, Epoch 15/20 => Loss 0.068, Train_accy 98.00, Test_accy 87.03:  75%|███████▌  | 15/20 [01:46<00:55, 11.09s/it]
Task 4, Epoch 16/20 => Loss 0.061, Train_accy 96.80:  75%|███████▌  | 15/20 [01:49<00:55, 11.09s/it]                 
Task 4, Epoch 16/20 => Loss 0.061, Train_accy 96.80:  80%|████████  | 16/20 [01:49<00:34,  8.53s/it]
Task 4, Epoch 17/20 => Loss 0.079, Train_accy 96.40:  80%|████████  | 16/20 [01:52<00:34,  8.53s/it]
Task 4, Epoch 17/20 => Loss 0.079, Train_accy 96.40:  85%|████████▌ | 17/20 [01:52<00:20,  6.72s/it]
Task 4, Epoch 18/20 => Loss 0.090, Train_accy 96.00:  85%|████████▌ | 17/20 [01:54<00:20,  6.72s/it]
Task 4, Epoch 18/20 => Loss 0.090, Train_accy 96.00:  90%|█████████ | 18/20 [01:54<00:10,  5.47s/it]
Task 4, Epoch 19/20 => Loss 0.038, Train_accy 98.80:  90%|█████████ | 18/20 [01:56<00:10,  5.47s/it]
Task 4, Epoch 19/20 => Loss 0.038, Train_accy 98.80:  95%|█████████▌| 19/20 [01:56<00:04,  4.56s/it]
Task 4, Epoch 20/20 => Loss 0.049, Train_accy 98.00, Test_accy 87.23:  95%|█████████▌| 19/20 [02:21<00:04,  4.56s/it]
Task 4, Epoch 20/20 => Loss 0.049, Train_accy 98.00, Test_accy 87.23: 100%|██████████| 20/20 [02:21<00:00, 10.67s/it]
Task 4, Epoch 20/20 => Loss 0.049, Train_accy 98.00, Test_accy 87.23: 100%|██████████| 20/20 [02:21<00:00,  7.09s/it]2024-09-14 22:20:04,529 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.049, Train_accy 98.00, Test_accy 87.23

2024-09-14 22:20:27,488 [trainer.py] => No NME accuracy.
2024-09-14 22:20:27,488 [trainer.py] => CNN: {'total': 87.23, '00-04': 90.56, '05-09': 92.78, '10-14': 91.67, '15-19': 92.26, '20-24': 76.25, 'old': 92.06, 'new': 76.25}
2024-09-14 22:20:27,488 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5, 95.08, 87.23]
2024-09-14 22:20:27,489 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.27]

Average Accuracy (CNN): 94.89
2024-09-14 22:20:27,489 [trainer.py] => Average Accuracy (CNN): 94.89 

2024-09-14 22:20:27,491 [trainer.py] => All params: 171927652
2024-09-14 22:20:27,493 [trainer.py] => Trainable params: 291890
2024-09-14 22:20:27,494 [dualprompt.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.155, Train_accy 14.78:   0%|          | 0/20 [00:01<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.155, Train_accy 14.78:   5%|▌         | 1/20 [00:01<00:27,  1.44s/it]
Task 5, Epoch 2/20 => Loss 0.877, Train_accy 66.09:   5%|▌         | 1/20 [00:02<00:27,  1.44s/it]
Task 5, Epoch 2/20 => Loss 0.877, Train_accy 66.09:  10%|█         | 2/20 [00:02<00:26,  1.49s/it]
Task 5, Epoch 3/20 => Loss 0.366, Train_accy 89.57:  10%|█         | 2/20 [00:04<00:26,  1.49s/it]
Task 5, Epoch 3/20 => Loss 0.366, Train_accy 89.57:  15%|█▌        | 3/20 [00:04<00:26,  1.53s/it]
Task 5, Epoch 4/20 => Loss 0.208, Train_accy 93.91:  15%|█▌        | 3/20 [00:05<00:26,  1.53s/it]
Task 5, Epoch 4/20 => Loss 0.208, Train_accy 93.91:  20%|██        | 4/20 [00:05<00:23,  1.49s/it]
Task 5, Epoch 5/20 => Loss 0.197, Train_accy 94.78, Test_accy 83.82:  20%|██        | 4/20 [00:32<00:23,  1.49s/it]
Task 5, Epoch 5/20 => Loss 0.197, Train_accy 94.78, Test_accy 83.82:  25%|██▌       | 5/20 [00:32<02:37, 10.47s/it]
Task 5, Epoch 6/20 => Loss 0.087, Train_accy 94.78:  25%|██▌       | 5/20 [00:33<02:37, 10.47s/it]                 
Task 5, Epoch 6/20 => Loss 0.087, Train_accy 94.78:  30%|███       | 6/20 [00:33<01:43,  7.42s/it]
Task 5, Epoch 7/20 => Loss 0.064, Train_accy 97.39:  30%|███       | 6/20 [00:35<01:43,  7.42s/it]
Task 5, Epoch 7/20 => Loss 0.064, Train_accy 97.39:  35%|███▌      | 7/20 [00:35<01:10,  5.43s/it]
Task 5, Epoch 8/20 => Loss 0.080, Train_accy 98.26:  35%|███▌      | 7/20 [00:36<01:10,  5.43s/it]
Task 5, Epoch 8/20 => Loss 0.080, Train_accy 98.26:  40%|████      | 8/20 [00:36<00:49,  4.15s/it]
Task 5, Epoch 9/20 => Loss 0.019, Train_accy 100.00:  40%|████      | 8/20 [00:38<00:49,  4.15s/it]
Task 5, Epoch 9/20 => Loss 0.019, Train_accy 100.00:  45%|████▌     | 9/20 [00:38<00:36,  3.31s/it]
Task 5, Epoch 10/20 => Loss 0.027, Train_accy 100.00, Test_accy 86.00:  45%|████▌     | 9/20 [01:04<00:36,  3.31s/it]
Task 5, Epoch 10/20 => Loss 0.027, Train_accy 100.00, Test_accy 86.00:  50%|█████     | 10/20 [01:04<01:45, 10.52s/it]
Task 5, Epoch 11/20 => Loss 0.048, Train_accy 98.26:  50%|█████     | 10/20 [01:06<01:45, 10.52s/it]                  
Task 5, Epoch 11/20 => Loss 0.048, Train_accy 98.26:  55%|█████▌    | 11/20 [01:06<01:09,  7.76s/it]
Task 5, Epoch 12/20 => Loss 0.012, Train_accy 100.00:  55%|█████▌    | 11/20 [01:07<01:09,  7.76s/it]
Task 5, Epoch 12/20 => Loss 0.012, Train_accy 100.00:  60%|██████    | 12/20 [01:07<00:46,  5.85s/it]
Task 5, Epoch 13/20 => Loss 0.024, Train_accy 100.00:  60%|██████    | 12/20 [01:09<00:46,  5.85s/it]
Task 5, Epoch 13/20 => Loss 0.024, Train_accy 100.00:  65%|██████▌   | 13/20 [01:09<00:31,  4.50s/it]
Task 5, Epoch 14/20 => Loss 0.025, Train_accy 100.00:  65%|██████▌   | 13/20 [01:10<00:31,  4.50s/it]
Task 5, Epoch 14/20 => Loss 0.025, Train_accy 100.00:  70%|███████   | 14/20 [01:10<00:21,  3.60s/it]
Task 5, Epoch 15/20 => Loss 0.025, Train_accy 99.13, Test_accy 86.27:  70%|███████   | 14/20 [01:38<00:21,  3.60s/it]
Task 5, Epoch 15/20 => Loss 0.025, Train_accy 99.13, Test_accy 86.27:  75%|███████▌  | 15/20 [01:38<00:53, 10.79s/it]
Task 5, Epoch 16/20 => Loss 0.015, Train_accy 100.00:  75%|███████▌  | 15/20 [01:39<00:53, 10.79s/it]                
Task 5, Epoch 16/20 => Loss 0.015, Train_accy 100.00:  80%|████████  | 16/20 [01:39<00:31,  7.97s/it]
Task 5, Epoch 17/20 => Loss 0.015, Train_accy 100.00:  80%|████████  | 16/20 [01:40<00:31,  7.97s/it]
Task 5, Epoch 17/20 => Loss 0.015, Train_accy 100.00:  85%|████████▌ | 17/20 [01:40<00:18,  6.02s/it]
Task 5, Epoch 18/20 => Loss 0.054, Train_accy 99.13:  85%|████████▌ | 17/20 [01:42<00:18,  6.02s/it] 
Task 5, Epoch 18/20 => Loss 0.054, Train_accy 99.13:  90%|█████████ | 18/20 [01:42<00:09,  4.65s/it]
Task 5, Epoch 19/20 => Loss 0.014, Train_accy 100.00:  90%|█████████ | 18/20 [01:43<00:09,  4.65s/it]
Task 5, Epoch 19/20 => Loss 0.014, Train_accy 100.00:  95%|█████████▌| 19/20 [01:43<00:03,  3.69s/it]
Task 5, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 86.38:  95%|█████████▌| 19/20 [02:11<00:03,  3.69s/it]
Task 5, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 86.38: 100%|██████████| 20/20 [02:11<00:00, 10.82s/it]
Task 5, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 86.38: 100%|██████████| 20/20 [02:11<00:00,  6.57s/it]2024-09-14 22:22:38,839 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 86.38

2024-09-14 22:23:03,930 [trainer.py] => No NME accuracy.
2024-09-14 22:23:03,931 [trainer.py] => CNN: {'total': 86.38, '00-04': 86.36, '05-09': 92.78, '10-14': 92.32, '15-19': 91.91, '20-24': 75.94, '25-29': 81.75, 'old': 86.81, 'new': 81.75}
2024-09-14 22:23:03,931 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5, 95.08, 87.23, 86.38]
2024-09-14 22:23:03,931 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.27, 99.13]

Average Accuracy (CNN): 93.47
2024-09-14 22:23:03,931 [trainer.py] => Average Accuracy (CNN): 93.47 

2024-09-14 22:23:03,934 [trainer.py] => All params: 171927652
2024-09-14 22:23:03,936 [trainer.py] => Trainable params: 291890
2024-09-14 22:23:03,937 [dualprompt.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.731, Train_accy 25.86:   0%|          | 0/20 [00:01<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.731, Train_accy 25.86:   5%|▌         | 1/20 [00:01<00:32,  1.73s/it]
Task 6, Epoch 2/20 => Loss 0.414, Train_accy 90.80:   5%|▌         | 1/20 [00:03<00:32,  1.73s/it]
Task 6, Epoch 2/20 => Loss 0.414, Train_accy 90.80:  10%|█         | 2/20 [00:03<00:31,  1.76s/it]
Task 6, Epoch 3/20 => Loss 0.126, Train_accy 97.13:  10%|█         | 2/20 [00:05<00:31,  1.76s/it]
Task 6, Epoch 3/20 => Loss 0.126, Train_accy 97.13:  15%|█▌        | 3/20 [00:05<00:29,  1.75s/it]
Task 6, Epoch 4/20 => Loss 0.080, Train_accy 98.28:  15%|█▌        | 3/20 [00:06<00:29,  1.75s/it]
Task 6, Epoch 4/20 => Loss 0.080, Train_accy 98.28:  20%|██        | 4/20 [00:06<00:27,  1.75s/it]
Task 6, Epoch 5/20 => Loss 0.036, Train_accy 99.43, Test_accy 82.63:  20%|██        | 4/20 [00:38<00:27,  1.75s/it]
Task 6, Epoch 5/20 => Loss 0.036, Train_accy 99.43, Test_accy 82.63:  25%|██▌       | 5/20 [00:38<03:09, 12.63s/it]
Task 6, Epoch 6/20 => Loss 0.062, Train_accy 98.28:  25%|██▌       | 5/20 [00:40<03:09, 12.63s/it]                 
Task 6, Epoch 6/20 => Loss 0.062, Train_accy 98.28:  30%|███       | 6/20 [00:40<02:05,  8.96s/it]
Task 6, Epoch 7/20 => Loss 0.027, Train_accy 99.43:  30%|███       | 6/20 [00:42<02:05,  8.96s/it]
Task 6, Epoch 7/20 => Loss 0.027, Train_accy 99.43:  35%|███▌      | 7/20 [00:42<01:26,  6.67s/it]
Task 6, Epoch 8/20 => Loss 0.028, Train_accy 99.43:  35%|███▌      | 7/20 [00:44<01:26,  6.67s/it]
Task 6, Epoch 8/20 => Loss 0.028, Train_accy 99.43:  40%|████      | 8/20 [00:44<01:01,  5.12s/it]
Task 6, Epoch 9/20 => Loss 0.006, Train_accy 100.00:  40%|████      | 8/20 [00:46<01:01,  5.12s/it]
Task 6, Epoch 9/20 => Loss 0.006, Train_accy 100.00:  45%|████▌     | 9/20 [00:46<00:44,  4.07s/it]
Task 6, Epoch 10/20 => Loss 0.004, Train_accy 100.00, Test_accy 83.69:  45%|████▌     | 9/20 [01:16<00:44,  4.07s/it]
Task 6, Epoch 10/20 => Loss 0.004, Train_accy 100.00, Test_accy 83.69:  50%|█████     | 10/20 [01:16<02:01, 12.18s/it]
Task 6, Epoch 11/20 => Loss 0.007, Train_accy 100.00:  50%|█████     | 10/20 [01:18<02:01, 12.18s/it]                 
Task 6, Epoch 11/20 => Loss 0.007, Train_accy 100.00:  55%|█████▌    | 11/20 [01:18<01:21,  9.04s/it]
Task 6, Epoch 12/20 => Loss 0.026, Train_accy 99.43:  55%|█████▌    | 11/20 [01:20<01:21,  9.04s/it] 
Task 6, Epoch 12/20 => Loss 0.026, Train_accy 99.43:  60%|██████    | 12/20 [01:20<00:55,  6.88s/it]
Task 6, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  60%|██████    | 12/20 [01:22<00:55,  6.88s/it]
Task 6, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  65%|██████▌   | 13/20 [01:22<00:37,  5.36s/it]
Task 6, Epoch 14/20 => Loss 0.053, Train_accy 98.28:  65%|██████▌   | 13/20 [01:24<00:37,  5.36s/it] 
Task 6, Epoch 14/20 => Loss 0.053, Train_accy 98.28:  70%|███████   | 14/20 [01:24<00:25,  4.29s/it]
Task 6, Epoch 15/20 => Loss 0.002, Train_accy 100.00, Test_accy 83.69:  70%|███████   | 14/20 [01:56<00:25,  4.29s/it]
Task 6, Epoch 15/20 => Loss 0.002, Train_accy 100.00, Test_accy 83.69:  75%|███████▌  | 15/20 [01:56<01:03, 12.75s/it]
Task 6, Epoch 16/20 => Loss 0.027, Train_accy 98.85:  75%|███████▌  | 15/20 [01:58<01:03, 12.75s/it]                  
Task 6, Epoch 16/20 => Loss 0.027, Train_accy 98.85:  80%|████████  | 16/20 [01:58<00:37,  9.47s/it]
Task 6, Epoch 17/20 => Loss 0.002, Train_accy 100.00:  80%|████████  | 16/20 [02:00<00:37,  9.47s/it]
Task 6, Epoch 17/20 => Loss 0.002, Train_accy 100.00:  85%|████████▌ | 17/20 [02:00<00:21,  7.19s/it]
Task 6, Epoch 18/20 => Loss 0.000, Train_accy 100.00:  85%|████████▌ | 17/20 [02:02<00:21,  7.19s/it]
Task 6, Epoch 18/20 => Loss 0.000, Train_accy 100.00:  90%|█████████ | 18/20 [02:02<00:11,  5.61s/it]
Task 6, Epoch 19/20 => Loss 0.003, Train_accy 100.00:  90%|█████████ | 18/20 [02:04<00:11,  5.61s/it]
Task 6, Epoch 19/20 => Loss 0.003, Train_accy 100.00:  95%|█████████▌| 19/20 [02:04<00:04,  4.49s/it]
Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.82:  95%|█████████▌| 19/20 [02:36<00:04,  4.49s/it]
Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.82: 100%|██████████| 20/20 [02:36<00:00, 12.91s/it]
Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.82: 100%|██████████| 20/20 [02:36<00:00,  7.83s/it]2024-09-14 22:25:40,564 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.82

2024-09-14 22:26:09,507 [trainer.py] => No NME accuracy.
2024-09-14 22:26:09,508 [trainer.py] => CNN: {'total': 83.82, '00-04': 86.36, '05-09': 92.59, '10-14': 83.5, '15-19': 90.21, '20-24': 71.47, '25-29': 80.42, '30-34': 86.93, 'old': 83.26, 'new': 86.93}
2024-09-14 22:26:09,508 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5, 95.08, 87.23, 86.38, 83.82]
2024-09-14 22:26:09,508 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.27, 99.13, 98.9]

Average Accuracy (CNN): 92.1
2024-09-14 22:26:09,508 [trainer.py] => Average Accuracy (CNN): 92.1 

2024-09-14 22:26:09,512 [trainer.py] => All params: 171927652
2024-09-14 22:26:09,514 [trainer.py] => Trainable params: 291890
2024-09-14 22:26:09,514 [dualprompt.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.449, Train_accy 37.21:   0%|          | 0/20 [00:01<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.449, Train_accy 37.21:   5%|▌         | 1/20 [00:01<00:27,  1.47s/it]
Task 7, Epoch 2/20 => Loss 0.574, Train_accy 79.84:   5%|▌         | 1/20 [00:02<00:27,  1.47s/it]
Task 7, Epoch 2/20 => Loss 0.574, Train_accy 79.84:  10%|█         | 2/20 [00:02<00:26,  1.45s/it]
Task 7, Epoch 3/20 => Loss 0.267, Train_accy 88.37:  10%|█         | 2/20 [00:04<00:26,  1.45s/it]
Task 7, Epoch 3/20 => Loss 0.267, Train_accy 88.37:  15%|█▌        | 3/20 [00:04<00:24,  1.45s/it]
Task 7, Epoch 4/20 => Loss 0.129, Train_accy 95.35:  15%|█▌        | 3/20 [00:05<00:24,  1.45s/it]
Task 7, Epoch 4/20 => Loss 0.129, Train_accy 95.35:  20%|██        | 4/20 [00:05<00:23,  1.46s/it]
Task 7, Epoch 5/20 => Loss 0.100, Train_accy 97.67, Test_accy 79.11:  20%|██        | 4/20 [00:40<00:23,  1.46s/it]
Task 7, Epoch 5/20 => Loss 0.100, Train_accy 97.67, Test_accy 79.11:  25%|██▌       | 5/20 [00:40<03:19, 13.29s/it]
Task 7, Epoch 6/20 => Loss 0.040, Train_accy 99.22:  25%|██▌       | 5/20 [00:41<03:19, 13.29s/it]                 
Task 7, Epoch 6/20 => Loss 0.040, Train_accy 99.22:  30%|███       | 6/20 [00:41<02:10,  9.29s/it]
Task 7, Epoch 7/20 => Loss 0.039, Train_accy 99.22:  30%|███       | 6/20 [00:43<02:10,  9.29s/it]
Task 7, Epoch 7/20 => Loss 0.039, Train_accy 99.22:  35%|███▌      | 7/20 [00:43<01:27,  6.72s/it]
Task 7, Epoch 8/20 => Loss 0.050, Train_accy 99.22:  35%|███▌      | 7/20 [00:44<01:27,  6.72s/it]
Task 7, Epoch 8/20 => Loss 0.050, Train_accy 99.22:  40%|████      | 8/20 [00:44<01:00,  5.05s/it]
Task 7, Epoch 9/20 => Loss 0.018, Train_accy 99.22:  40%|████      | 8/20 [00:45<01:00,  5.05s/it]
Task 7, Epoch 9/20 => Loss 0.018, Train_accy 99.22:  45%|████▌     | 9/20 [00:45<00:43,  3.91s/it]
Task 7, Epoch 10/20 => Loss 0.030, Train_accy 99.22, Test_accy 80.05:  45%|████▌     | 9/20 [01:18<00:43,  3.91s/it]
Task 7, Epoch 10/20 => Loss 0.030, Train_accy 99.22, Test_accy 80.05:  50%|█████     | 10/20 [01:18<02:08, 12.87s/it]
Task 7, Epoch 11/20 => Loss 0.031, Train_accy 98.45:  50%|█████     | 10/20 [01:20<02:08, 12.87s/it]                 
Task 7, Epoch 11/20 => Loss 0.031, Train_accy 98.45:  55%|█████▌    | 11/20 [01:20<01:24,  9.40s/it]
Task 7, Epoch 12/20 => Loss 0.029, Train_accy 98.45:  55%|█████▌    | 11/20 [01:21<01:24,  9.40s/it]
Task 7, Epoch 12/20 => Loss 0.029, Train_accy 98.45:  60%|██████    | 12/20 [01:21<00:56,  7.00s/it]
Task 7, Epoch 13/20 => Loss 0.009, Train_accy 100.00:  60%|██████    | 12/20 [01:23<00:56,  7.00s/it]
Task 7, Epoch 13/20 => Loss 0.009, Train_accy 100.00:  65%|██████▌   | 13/20 [01:23<00:37,  5.37s/it]
Task 7, Epoch 14/20 => Loss 0.018, Train_accy 99.22:  65%|██████▌   | 13/20 [01:25<00:37,  5.37s/it] 
Task 7, Epoch 14/20 => Loss 0.018, Train_accy 99.22:  70%|███████   | 14/20 [01:25<00:25,  4.23s/it]
Task 7, Epoch 15/20 => Loss 0.036, Train_accy 99.22, Test_accy 80.33:  70%|███████   | 14/20 [01:59<00:25,  4.23s/it]
Task 7, Epoch 15/20 => Loss 0.036, Train_accy 99.22, Test_accy 80.33:  75%|███████▌  | 15/20 [01:59<01:06, 13.37s/it]
Task 7, Epoch 16/20 => Loss 0.016, Train_accy 100.00:  75%|███████▌  | 15/20 [02:01<01:06, 13.37s/it]                
Task 7, Epoch 16/20 => Loss 0.016, Train_accy 100.00:  80%|████████  | 16/20 [02:01<00:39,  9.83s/it]
Task 7, Epoch 17/20 => Loss 0.091, Train_accy 98.45:  80%|████████  | 16/20 [02:02<00:39,  9.83s/it] 
Task 7, Epoch 17/20 => Loss 0.091, Train_accy 98.45:  85%|████████▌ | 17/20 [02:02<00:21,  7.32s/it]
Task 7, Epoch 18/20 => Loss 0.010, Train_accy 100.00:  85%|████████▌ | 17/20 [02:04<00:21,  7.32s/it]
Task 7, Epoch 18/20 => Loss 0.010, Train_accy 100.00:  90%|█████████ | 18/20 [02:04<00:11,  5.62s/it]
Task 7, Epoch 19/20 => Loss 0.015, Train_accy 99.22:  90%|█████████ | 18/20 [02:05<00:11,  5.62s/it] 
Task 7, Epoch 19/20 => Loss 0.015, Train_accy 99.22:  95%|█████████▌| 19/20 [02:05<00:04,  4.38s/it]
Task 7, Epoch 20/20 => Loss 0.001, Train_accy 100.00, Test_accy 80.26:  95%|█████████▌| 19/20 [02:40<00:04,  4.38s/it]
Task 7, Epoch 20/20 => Loss 0.001, Train_accy 100.00, Test_accy 80.26: 100%|██████████| 20/20 [02:40<00:00, 13.46s/it]
Task 7, Epoch 20/20 => Loss 0.001, Train_accy 100.00, Test_accy 80.26: 100%|██████████| 20/20 [02:40<00:00,  8.03s/it]2024-09-14 22:28:50,034 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.001, Train_accy 100.00, Test_accy 80.26

2024-09-14 22:29:21,014 [trainer.py] => No NME accuracy.
2024-09-14 22:29:21,015 [trainer.py] => CNN: {'total': 80.26, '00-04': 86.36, '05-09': 87.96, '10-14': 78.59, '15-19': 83.82, '20-24': 66.77, '25-29': 80.16, '30-34': 88.29, '35-39': 81.55, 'old': 80.15, 'new': 81.55}
2024-09-14 22:29:21,015 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5, 95.08, 87.23, 86.38, 83.82, 80.26]
2024-09-14 22:29:21,015 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.27, 99.13, 98.9, 98.18]

Average Accuracy (CNN): 90.62
2024-09-14 22:29:21,015 [trainer.py] => Average Accuracy (CNN): 90.62 

2024-09-14 22:29:21,018 [trainer.py] => All params: 171927652
2024-09-14 22:29:21,021 [trainer.py] => Trainable params: 291890
2024-09-14 22:29:21,021 [dualprompt.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.044, Train_accy 58.08:   0%|          | 0/20 [00:02<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.044, Train_accy 58.08:   5%|▌         | 1/20 [00:02<00:53,  2.83s/it]
Task 8, Epoch 2/20 => Loss 0.300, Train_accy 92.44:   5%|▌         | 1/20 [00:05<00:53,  2.83s/it]
Task 8, Epoch 2/20 => Loss 0.300, Train_accy 92.44:  10%|█         | 2/20 [00:05<00:51,  2.88s/it]
Task 8, Epoch 3/20 => Loss 0.080, Train_accy 98.28:  10%|█         | 2/20 [00:08<00:51,  2.88s/it]
Task 8, Epoch 3/20 => Loss 0.080, Train_accy 98.28:  15%|█▌        | 3/20 [00:08<00:49,  2.89s/it]
Task 8, Epoch 4/20 => Loss 0.078, Train_accy 97.25:  15%|█▌        | 3/20 [00:11<00:49,  2.89s/it]
Task 8, Epoch 4/20 => Loss 0.078, Train_accy 97.25:  20%|██        | 4/20 [00:11<00:45,  2.87s/it]
Task 8, Epoch 5/20 => Loss 0.076, Train_accy 97.25, Test_accy 76.90:  20%|██        | 4/20 [00:53<00:45,  2.87s/it]
Task 8, Epoch 5/20 => Loss 0.076, Train_accy 97.25, Test_accy 76.90:  25%|██▌       | 5/20 [00:53<04:17, 17.14s/it]
Task 8, Epoch 6/20 => Loss 0.041, Train_accy 99.31:  25%|██▌       | 5/20 [00:56<04:17, 17.14s/it]                 
Task 8, Epoch 6/20 => Loss 0.041, Train_accy 99.31:  30%|███       | 6/20 [00:56<02:51, 12.22s/it]
Task 8, Epoch 7/20 => Loss 0.054, Train_accy 97.94:  30%|███       | 6/20 [00:59<02:51, 12.22s/it]
Task 8, Epoch 7/20 => Loss 0.054, Train_accy 97.94:  35%|███▌      | 7/20 [00:59<01:58,  9.14s/it]
Task 8, Epoch 8/20 => Loss 0.038, Train_accy 98.97:  35%|███▌      | 7/20 [01:02<01:58,  9.14s/it]
Task 8, Epoch 8/20 => Loss 0.038, Train_accy 98.97:  40%|████      | 8/20 [01:02<01:25,  7.16s/it]
Task 8, Epoch 9/20 => Loss 0.028, Train_accy 99.31:  40%|████      | 8/20 [01:05<01:25,  7.16s/it]
Task 8, Epoch 9/20 => Loss 0.028, Train_accy 99.31:  45%|████▌     | 9/20 [01:05<01:03,  5.81s/it]
Task 8, Epoch 10/20 => Loss 0.038, Train_accy 99.31, Test_accy 77.20:  45%|████▌     | 9/20 [01:50<01:03,  5.81s/it]
Task 8, Epoch 10/20 => Loss 0.038, Train_accy 99.31, Test_accy 77.20:  50%|█████     | 10/20 [01:50<02:59, 17.91s/it]
Task 8, Epoch 11/20 => Loss 0.025, Train_accy 99.31:  50%|█████     | 10/20 [01:53<02:59, 17.91s/it]                 
Task 8, Epoch 11/20 => Loss 0.025, Train_accy 99.31:  55%|█████▌    | 11/20 [01:53<01:59, 13.31s/it]
Task 8, Epoch 12/20 => Loss 0.054, Train_accy 98.28:  55%|█████▌    | 11/20 [01:55<01:59, 13.31s/it]
Task 8, Epoch 12/20 => Loss 0.054, Train_accy 98.28:  60%|██████    | 12/20 [01:55<01:21, 10.14s/it]
Task 8, Epoch 13/20 => Loss 0.023, Train_accy 99.31:  60%|██████    | 12/20 [01:58<01:21, 10.14s/it]
Task 8, Epoch 13/20 => Loss 0.023, Train_accy 99.31:  65%|██████▌   | 13/20 [01:58<00:55,  7.96s/it]
Task 8, Epoch 14/20 => Loss 0.028, Train_accy 99.31:  65%|██████▌   | 13/20 [02:01<00:55,  7.96s/it]
Task 8, Epoch 14/20 => Loss 0.028, Train_accy 99.31:  70%|███████   | 14/20 [02:01<00:38,  6.43s/it]
Task 8, Epoch 15/20 => Loss 0.019, Train_accy 98.97, Test_accy 78.69:  70%|███████   | 14/20 [02:44<00:38,  6.43s/it]
Task 8, Epoch 15/20 => Loss 0.019, Train_accy 98.97, Test_accy 78.69:  75%|███████▌  | 15/20 [02:44<01:27, 17.50s/it]
Task 8, Epoch 16/20 => Loss 0.019, Train_accy 99.31:  75%|███████▌  | 15/20 [02:47<01:27, 17.50s/it]                 
Task 8, Epoch 16/20 => Loss 0.019, Train_accy 99.31:  80%|████████  | 16/20 [02:47<00:52, 13.04s/it]
Task 8, Epoch 17/20 => Loss 0.006, Train_accy 99.66:  80%|████████  | 16/20 [02:50<00:52, 13.04s/it]
Task 8, Epoch 17/20 => Loss 0.006, Train_accy 99.66:  85%|████████▌ | 17/20 [02:50<00:29,  9.90s/it]
Task 8, Epoch 18/20 => Loss 0.012, Train_accy 99.31:  85%|████████▌ | 17/20 [02:52<00:29,  9.90s/it]
Task 8, Epoch 18/20 => Loss 0.012, Train_accy 99.31:  90%|█████████ | 18/20 [02:52<00:15,  7.74s/it]
Task 8, Epoch 19/20 => Loss 0.008, Train_accy 99.66:  90%|█████████ | 18/20 [02:55<00:15,  7.74s/it]
Task 8, Epoch 19/20 => Loss 0.008, Train_accy 99.66:  95%|█████████▌| 19/20 [02:55<00:06,  6.22s/it]
Task 8, Epoch 20/20 => Loss 0.011, Train_accy 99.66, Test_accy 78.60:  95%|█████████▌| 19/20 [03:39<00:06,  6.22s/it]
Task 8, Epoch 20/20 => Loss 0.011, Train_accy 99.66, Test_accy 78.60: 100%|██████████| 20/20 [03:39<00:00, 17.44s/it]
Task 8, Epoch 20/20 => Loss 0.011, Train_accy 99.66, Test_accy 78.60: 100%|██████████| 20/20 [03:39<00:00, 10.96s/it]2024-09-14 22:33:00,231 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.011, Train_accy 99.66, Test_accy 78.60

2024-09-14 22:33:40,746 [trainer.py] => No NME accuracy.
2024-09-14 22:33:40,747 [trainer.py] => CNN: {'total': 78.6, '00-04': 86.36, '05-09': 84.63, '10-14': 74.18, '15-19': 81.76, '20-24': 62.07, '25-29': 80.42, '30-34': 87.18, '35-39': 79.27, '40-44': 82.25, 'old': 77.63, 'new': 82.25}
2024-09-14 22:33:40,747 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5, 95.08, 87.23, 86.38, 83.82, 80.26, 78.6]
2024-09-14 22:33:40,747 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.27, 99.13, 98.9, 98.18, 97.85]

Average Accuracy (CNN): 89.28
2024-09-14 22:33:40,747 [trainer.py] => Average Accuracy (CNN): 89.28 

2024-09-14 22:33:40,750 [trainer.py] => All params: 171927652
2024-09-14 22:33:40,752 [trainer.py] => Trainable params: 291890
2024-09-14 22:33:40,752 [dualprompt.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.993, Train_accy 60.31:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.993, Train_accy 60.31:   5%|▌         | 1/20 [00:02<00:48,  2.55s/it]
Task 9, Epoch 2/20 => Loss 0.202, Train_accy 93.51:   5%|▌         | 1/20 [00:05<00:48,  2.55s/it]
Task 9, Epoch 2/20 => Loss 0.202, Train_accy 93.51:  10%|█         | 2/20 [00:05<00:45,  2.55s/it]
Task 9, Epoch 3/20 => Loss 0.111, Train_accy 96.18:  10%|█         | 2/20 [00:07<00:45,  2.55s/it]
Task 9, Epoch 3/20 => Loss 0.111, Train_accy 96.18:  15%|█▌        | 3/20 [00:07<00:43,  2.57s/it]
Task 9, Epoch 4/20 => Loss 0.076, Train_accy 97.71:  15%|█▌        | 3/20 [00:10<00:43,  2.57s/it]
Task 9, Epoch 4/20 => Loss 0.076, Train_accy 97.71:  20%|██        | 4/20 [00:10<00:40,  2.53s/it]
Task 9, Epoch 5/20 => Loss 0.074, Train_accy 96.18, Test_accy 71.44:  20%|██        | 4/20 [01:02<00:40,  2.53s/it]
Task 9, Epoch 5/20 => Loss 0.074, Train_accy 96.18, Test_accy 71.44:  25%|██▌       | 5/20 [01:02<05:05, 20.35s/it]
Task 9, Epoch 6/20 => Loss 0.051, Train_accy 98.09:  25%|██▌       | 5/20 [01:04<05:05, 20.35s/it]                 
Task 9, Epoch 6/20 => Loss 0.051, Train_accy 98.09:  30%|███       | 6/20 [01:04<03:20, 14.33s/it]
Task 9, Epoch 7/20 => Loss 0.049, Train_accy 98.47:  30%|███       | 6/20 [01:07<03:20, 14.33s/it]
Task 9, Epoch 7/20 => Loss 0.049, Train_accy 98.47:  35%|███▌      | 7/20 [01:07<02:16, 10.50s/it]
Task 9, Epoch 8/20 => Loss 0.036, Train_accy 99.62:  35%|███▌      | 7/20 [01:09<02:16, 10.50s/it]
Task 9, Epoch 8/20 => Loss 0.036, Train_accy 99.62:  40%|████      | 8/20 [01:09<01:35,  7.96s/it]
Task 9, Epoch 9/20 => Loss 0.028, Train_accy 99.24:  40%|████      | 8/20 [01:12<01:35,  7.96s/it]
Task 9, Epoch 9/20 => Loss 0.028, Train_accy 99.24:  45%|████▌     | 9/20 [01:12<01:08,  6.24s/it]
Task 9, Epoch 10/20 => Loss 0.021, Train_accy 99.62, Test_accy 71.91:  45%|████▌     | 9/20 [02:02<01:08,  6.24s/it]
Task 9, Epoch 10/20 => Loss 0.021, Train_accy 99.62, Test_accy 71.91:  50%|█████     | 10/20 [02:02<03:18, 19.81s/it]
Task 9, Epoch 11/20 => Loss 0.034, Train_accy 98.09:  50%|█████     | 10/20 [02:05<03:18, 19.81s/it]                 
Task 9, Epoch 11/20 => Loss 0.034, Train_accy 98.09:  55%|█████▌    | 11/20 [02:05<02:10, 14.55s/it]
Task 9, Epoch 12/20 => Loss 0.038, Train_accy 97.71:  55%|█████▌    | 11/20 [02:07<02:10, 14.55s/it]
Task 9, Epoch 12/20 => Loss 0.038, Train_accy 97.71:  60%|██████    | 12/20 [02:07<01:27, 10.91s/it]
Task 9, Epoch 13/20 => Loss 0.023, Train_accy 99.62:  60%|██████    | 12/20 [02:10<01:27, 10.91s/it]
Task 9, Epoch 13/20 => Loss 0.023, Train_accy 99.62:  65%|██████▌   | 13/20 [02:10<00:58,  8.38s/it]
Task 9, Epoch 14/20 => Loss 0.010, Train_accy 99.24:  65%|██████▌   | 13/20 [02:12<00:58,  8.38s/it]
Task 9, Epoch 14/20 => Loss 0.010, Train_accy 99.24:  70%|███████   | 14/20 [02:12<00:39,  6.64s/it]
Task 9, Epoch 15/20 => Loss 0.042, Train_accy 98.09, Test_accy 72.21:  70%|███████   | 14/20 [03:02<00:39,  6.64s/it]
Task 9, Epoch 15/20 => Loss 0.042, Train_accy 98.09, Test_accy 72.21:  75%|███████▌  | 15/20 [03:02<01:38, 19.67s/it]
Task 9, Epoch 16/20 => Loss 0.017, Train_accy 99.62:  75%|███████▌  | 15/20 [03:05<01:38, 19.67s/it]                 
Task 9, Epoch 16/20 => Loss 0.017, Train_accy 99.62:  80%|████████  | 16/20 [03:05<00:58, 14.56s/it]
Task 9, Epoch 17/20 => Loss 0.039, Train_accy 99.24:  80%|████████  | 16/20 [03:08<00:58, 14.56s/it]
Task 9, Epoch 17/20 => Loss 0.039, Train_accy 99.24:  85%|████████▌ | 17/20 [03:08<00:32, 10.96s/it]
Task 9, Epoch 18/20 => Loss 0.037, Train_accy 97.71:  85%|████████▌ | 17/20 [03:10<00:32, 10.96s/it]
Task 9, Epoch 18/20 => Loss 0.037, Train_accy 97.71:  90%|█████████ | 18/20 [03:10<00:16,  8.46s/it]
Task 9, Epoch 19/20 => Loss 0.016, Train_accy 99.62:  90%|█████████ | 18/20 [03:13<00:16,  8.46s/it]
Task 9, Epoch 19/20 => Loss 0.016, Train_accy 99.62:  95%|█████████▌| 19/20 [03:13<00:06,  6.70s/it]
Task 9, Epoch 20/20 => Loss 0.013, Train_accy 99.62, Test_accy 72.58:  95%|█████████▌| 19/20 [04:05<00:06,  6.70s/it]
Task 9, Epoch 20/20 => Loss 0.013, Train_accy 99.62, Test_accy 72.58: 100%|██████████| 20/20 [04:05<00:00, 20.23s/it]
Task 9, Epoch 20/20 => Loss 0.013, Train_accy 99.62, Test_accy 72.58: 100%|██████████| 20/20 [04:05<00:00, 12.25s/it]2024-09-14 22:37:45,847 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.013, Train_accy 99.62, Test_accy 72.58

2024-09-14 22:38:32,642 [trainer.py] => No NME accuracy.
2024-09-14 22:38:32,642 [trainer.py] => CNN: {'total': 72.58, '00-04': 86.01, '05-09': 84.44, '10-14': 69.61, '15-19': 70.26, '20-24': 52.11, '25-29': 79.37, '30-34': 80.64, '35-39': 63.55, '40-44': 76.07, '45-49': 79.97, 'old': 71.19, 'new': 79.97}
2024-09-14 22:38:32,643 [trainer.py] => CNN top1 curve: [97.2, 97.46, 97.5, 95.08, 87.23, 86.38, 83.82, 80.26, 78.6, 72.58]
2024-09-14 22:38:32,643 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.27, 99.13, 98.9, 98.18, 97.85, 97.13]

Average Accuracy (CNN): 87.61
2024-09-14 22:38:32,643 [trainer.py] => Average Accuracy (CNN): 87.61 

Accuracy Matrix (CNN):
[[ 97.2   92.66  91.96  91.61  90.56  86.36  86.36  86.36  86.36  86.01]
 [  0.   100.    99.07  99.07  92.78  92.78  92.59  87.96  84.63  84.44]
 [  0.     0.    98.69  97.88  91.67  92.32  83.5   78.59  74.18  69.61]
 [  0.     0.     0.    93.04  92.26  91.91  90.21  83.82  81.76  70.26]
 [  0.     0.     0.     0.    76.25  75.94  71.47  66.77  62.07  52.11]
 [  0.     0.     0.     0.     0.    81.75  80.42  80.16  80.42  79.37]
 [  0.     0.     0.     0.     0.     0.    86.93  88.29  87.18  80.64]
 [  0.     0.     0.     0.     0.     0.     0.    81.55  79.27  63.55]
 [  0.     0.     0.     0.     0.     0.     0.     0.    82.25  76.07]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    79.97]]
2024-09-14 22:38:32,644 [trainer.py] => Forgetting (CNN): 15.217777777777778
2024-09-14 22:38:35,126 [trainer.py] => config: ./exps/coda_prompt_vtab_B0_Inc5.json
2024-09-14 22:38:35,126 [trainer.py] => prefix:  
2024-09-14 22:38:35,126 [trainer.py] => dataset: vtab
2024-09-14 22:38:35,127 [trainer.py] => memory_size: 0
2024-09-14 22:38:35,127 [trainer.py] => memory_per_class: 0
2024-09-14 22:38:35,127 [trainer.py] => fixed_memory: False
2024-09-14 22:38:35,127 [trainer.py] => shuffle: True
2024-09-14 22:38:35,127 [trainer.py] => init_cls: 10
2024-09-14 22:38:35,127 [trainer.py] => increment: 10
2024-09-14 22:38:35,127 [trainer.py] => model_name: coda_prompt
2024-09-14 22:38:35,127 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-14 22:38:35,127 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 22:38:35,127 [trainer.py] => seed: 1993
2024-09-14 22:38:35,127 [trainer.py] => tuned_epoch: 20
2024-09-14 22:38:35,127 [trainer.py] => init_lr: 0.001
2024-09-14 22:38:35,127 [trainer.py] => batch_size: 48
2024-09-14 22:38:35,127 [trainer.py] => weight_decay: 0
2024-09-14 22:38:35,127 [trainer.py] => min_lr: 1e-05
2024-09-14 22:38:35,127 [trainer.py] => optimizer: adam
2024-09-14 22:38:35,127 [trainer.py] => scheduler: cosine
2024-09-14 22:38:35,127 [trainer.py] => reinit_optimizer: True
2024-09-14 22:38:35,127 [trainer.py] => pretrained: True
2024-09-14 22:38:35,127 [trainer.py] => drop: 0.0
2024-09-14 22:38:35,127 [trainer.py] => drop_path: 0.0
2024-09-14 22:38:35,128 [trainer.py] => prompt_param: [100, 8.0, 0.0]
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 22:38:35,161 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-09-14 22:38:37,484 [coda_prompt.py] => 89,677,106 total parameters.
2024-09-14 22:38:37,485 [coda_prompt.py] => 3,878,450 fc and prompt training parameters.
2024-09-14 22:38:37,485 [trainer.py] => All params: 89677106
2024-09-14 22:38:37,486 [trainer.py] => Trainable params: 89677106
2024-09-14 22:38:37,486 [coda_prompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.504, Train_accy 18.75:   0%|          | 0/20 [00:04<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.504, Train_accy 18.75:   5%|▌         | 1/20 [00:04<01:17,  4.05s/it]
Task 0, Epoch 2/20 => Loss 1.184, Train_accy 68.06:   5%|▌         | 1/20 [00:06<01:17,  4.05s/it]
Task 0, Epoch 2/20 => Loss 1.184, Train_accy 68.06:  10%|█         | 2/20 [00:06<00:51,  2.87s/it]
Task 0, Epoch 3/20 => Loss 0.615, Train_accy 87.50:  10%|█         | 2/20 [00:08<00:51,  2.87s/it]
Task 0, Epoch 3/20 => Loss 0.615, Train_accy 87.50:  15%|█▌        | 3/20 [00:08<00:41,  2.45s/it]
Task 0, Epoch 4/20 => Loss 0.314, Train_accy 93.06:  15%|█▌        | 3/20 [00:10<00:41,  2.45s/it]
Task 0, Epoch 4/20 => Loss 0.314, Train_accy 93.06:  20%|██        | 4/20 [00:10<00:36,  2.29s/it]
Task 0, Epoch 5/20 => Loss 0.233, Train_accy 96.53, Test_accy 97.09:  20%|██        | 4/20 [00:17<00:36,  2.29s/it]
Task 0, Epoch 5/20 => Loss 0.233, Train_accy 96.53, Test_accy 97.09:  25%|██▌       | 5/20 [00:17<01:01,  4.12s/it]
Task 0, Epoch 6/20 => Loss 0.156, Train_accy 97.22:  25%|██▌       | 5/20 [00:19<01:01,  4.12s/it]                 
Task 0, Epoch 6/20 => Loss 0.156, Train_accy 97.22:  30%|███       | 6/20 [00:19<00:46,  3.35s/it]
Task 0, Epoch 7/20 => Loss 0.120, Train_accy 97.92:  30%|███       | 6/20 [00:21<00:46,  3.35s/it]
Task 0, Epoch 7/20 => Loss 0.120, Train_accy 97.92:  35%|███▌      | 7/20 [00:21<00:37,  2.90s/it]
Task 0, Epoch 8/20 => Loss 0.072, Train_accy 98.61:  35%|███▌      | 7/20 [00:23<00:37,  2.90s/it]
Task 0, Epoch 8/20 => Loss 0.072, Train_accy 98.61:  40%|████      | 8/20 [00:23<00:30,  2.58s/it]
Task 0, Epoch 9/20 => Loss 0.075, Train_accy 97.92:  40%|████      | 8/20 [00:24<00:30,  2.58s/it]
Task 0, Epoch 9/20 => Loss 0.075, Train_accy 97.92:  45%|████▌     | 9/20 [00:24<00:25,  2.34s/it]
Task 0, Epoch 10/20 => Loss 0.054, Train_accy 98.61, Test_accy 98.43:  45%|████▌     | 9/20 [00:32<00:25,  2.34s/it]
Task 0, Epoch 10/20 => Loss 0.054, Train_accy 98.61, Test_accy 98.43:  50%|█████     | 10/20 [00:32<00:37,  3.79s/it]
Task 0, Epoch 11/20 => Loss 0.073, Train_accy 97.22:  50%|█████     | 10/20 [00:33<00:37,  3.79s/it]                 
Task 0, Epoch 11/20 => Loss 0.073, Train_accy 97.22:  55%|█████▌    | 11/20 [00:33<00:28,  3.20s/it]
Task 0, Epoch 12/20 => Loss 0.048, Train_accy 98.61:  55%|█████▌    | 11/20 [00:35<00:28,  3.20s/it]
Task 0, Epoch 12/20 => Loss 0.048, Train_accy 98.61:  60%|██████    | 12/20 [00:35<00:22,  2.79s/it]
Task 0, Epoch 13/20 => Loss 0.030, Train_accy 99.31:  60%|██████    | 12/20 [00:37<00:22,  2.79s/it]
Task 0, Epoch 13/20 => Loss 0.030, Train_accy 99.31:  65%|██████▌   | 13/20 [00:37<00:17,  2.53s/it]
Task 0, Epoch 14/20 => Loss 0.041, Train_accy 98.61:  65%|██████▌   | 13/20 [00:39<00:17,  2.53s/it]
Task 0, Epoch 14/20 => Loss 0.041, Train_accy 98.61:  70%|███████   | 14/20 [00:39<00:14,  2.35s/it]
Task 0, Epoch 15/20 => Loss 0.022, Train_accy 99.31, Test_accy 98.55:  70%|███████   | 14/20 [00:46<00:14,  2.35s/it]
Task 0, Epoch 15/20 => Loss 0.022, Train_accy 99.31, Test_accy 98.55:  75%|███████▌  | 15/20 [00:46<00:18,  3.73s/it]
Task 0, Epoch 16/20 => Loss 0.033, Train_accy 98.61:  75%|███████▌  | 15/20 [00:48<00:18,  3.73s/it]                 
Task 0, Epoch 16/20 => Loss 0.033, Train_accy 98.61:  80%|████████  | 16/20 [00:48<00:12,  3.18s/it]
Task 0, Epoch 17/20 => Loss 0.026, Train_accy 99.31:  80%|████████  | 16/20 [00:50<00:12,  3.18s/it]
Task 0, Epoch 17/20 => Loss 0.026, Train_accy 99.31:  85%|████████▌ | 17/20 [00:50<00:08,  2.79s/it]
Task 0, Epoch 18/20 => Loss 0.081, Train_accy 97.92:  85%|████████▌ | 17/20 [00:52<00:08,  2.79s/it]
Task 0, Epoch 18/20 => Loss 0.081, Train_accy 97.92:  90%|█████████ | 18/20 [00:52<00:05,  2.56s/it]
Task 0, Epoch 19/20 => Loss 0.023, Train_accy 99.31:  90%|█████████ | 18/20 [00:54<00:05,  2.56s/it]
Task 0, Epoch 19/20 => Loss 0.023, Train_accy 99.31:  95%|█████████▌| 19/20 [00:54<00:02,  2.38s/it]
Task 0, Epoch 20/20 => Loss 0.032, Train_accy 99.31, Test_accy 98.55:  95%|█████████▌| 19/20 [01:01<00:02,  2.38s/it]
Task 0, Epoch 20/20 => Loss 0.032, Train_accy 99.31, Test_accy 98.55: 100%|██████████| 20/20 [01:01<00:00,  3.85s/it]
Task 0, Epoch 20/20 => Loss 0.032, Train_accy 99.31, Test_accy 98.55: 100%|██████████| 20/20 [01:01<00:00,  3.08s/it]2024-09-14 22:39:39,578 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.032, Train_accy 99.31, Test_accy 98.55

2024-09-14 22:39:45,068 [trainer.py] => No NME accuracy.
2024-09-14 22:39:45,069 [trainer.py] => CNN: {'total': 98.55, '00-09': 98.55, 'old': 0, 'new': 98.55}
2024-09-14 22:39:45,069 [trainer.py] => CNN top1 curve: [98.55]
2024-09-14 22:39:45,069 [trainer.py] => CNN top5 curve: [99.39]

Average Accuracy (CNN): 98.55
2024-09-14 22:39:45,070 [trainer.py] => Average Accuracy (CNN): 98.55 

2024-09-14 22:39:45,071 [trainer.py] => All params: 89677106
2024-09-14 22:39:45,073 [trainer.py] => Trainable params: 89677106
2024-09-14 22:39:46,488 [coda_prompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.493, Train_accy 54.43:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.493, Train_accy 54.43:   5%|▌         | 1/20 [00:04<01:25,  4.47s/it]
Task 1, Epoch 2/20 => Loss 0.410, Train_accy 86.20:   5%|▌         | 1/20 [00:08<01:25,  4.47s/it]
Task 1, Epoch 2/20 => Loss 0.410, Train_accy 86.20:  10%|█         | 2/20 [00:08<01:20,  4.46s/it]
Task 1, Epoch 3/20 => Loss 0.199, Train_accy 95.05:  10%|█         | 2/20 [00:13<01:20,  4.46s/it]
Task 1, Epoch 3/20 => Loss 0.199, Train_accy 95.05:  15%|█▌        | 3/20 [00:13<01:16,  4.51s/it]
Task 1, Epoch 4/20 => Loss 0.127, Train_accy 95.31:  15%|█▌        | 3/20 [00:18<01:16,  4.51s/it]
Task 1, Epoch 4/20 => Loss 0.127, Train_accy 95.31:  20%|██        | 4/20 [00:18<01:12,  4.53s/it]
Task 1, Epoch 5/20 => Loss 0.133, Train_accy 95.57, Test_accy 96.07:  20%|██        | 4/20 [00:39<01:12,  4.53s/it]
Task 1, Epoch 5/20 => Loss 0.133, Train_accy 95.57, Test_accy 96.07:  25%|██▌       | 5/20 [00:39<02:38, 10.56s/it]
Task 1, Epoch 6/20 => Loss 0.097, Train_accy 97.40:  25%|██▌       | 5/20 [00:43<02:38, 10.56s/it]                 
Task 1, Epoch 6/20 => Loss 0.097, Train_accy 97.40:  30%|███       | 6/20 [00:43<01:58,  8.49s/it]
Task 1, Epoch 7/20 => Loss 0.041, Train_accy 99.22:  30%|███       | 6/20 [00:48<01:58,  8.49s/it]
Task 1, Epoch 7/20 => Loss 0.041, Train_accy 99.22:  35%|███▌      | 7/20 [00:48<01:34,  7.24s/it]
Task 1, Epoch 8/20 => Loss 0.059, Train_accy 98.18:  35%|███▌      | 7/20 [00:52<01:34,  7.24s/it]
Task 1, Epoch 8/20 => Loss 0.059, Train_accy 98.18:  40%|████      | 8/20 [00:52<01:16,  6.34s/it]
Task 1, Epoch 9/20 => Loss 0.070, Train_accy 97.40:  40%|████      | 8/20 [00:57<01:16,  6.34s/it]
Task 1, Epoch 9/20 => Loss 0.070, Train_accy 97.40:  45%|████▌     | 9/20 [00:57<01:03,  5.77s/it]
Task 1, Epoch 10/20 => Loss 0.065, Train_accy 98.18, Test_accy 97.15:  45%|████▌     | 9/20 [01:17<01:03,  5.77s/it]
Task 1, Epoch 10/20 => Loss 0.065, Train_accy 98.18, Test_accy 97.15:  50%|█████     | 10/20 [01:17<01:42, 10.25s/it]
Task 1, Epoch 11/20 => Loss 0.053, Train_accy 97.66:  50%|█████     | 10/20 [01:21<01:42, 10.25s/it]                 
Task 1, Epoch 11/20 => Loss 0.053, Train_accy 97.66:  55%|█████▌    | 11/20 [01:21<01:15,  8.41s/it]
Task 1, Epoch 12/20 => Loss 0.067, Train_accy 97.66:  55%|█████▌    | 11/20 [01:26<01:15,  8.41s/it]
Task 1, Epoch 12/20 => Loss 0.067, Train_accy 97.66:  60%|██████    | 12/20 [01:26<00:57,  7.14s/it]
Task 1, Epoch 13/20 => Loss 0.067, Train_accy 98.44:  60%|██████    | 12/20 [01:30<00:57,  7.14s/it]
Task 1, Epoch 13/20 => Loss 0.067, Train_accy 98.44:  65%|██████▌   | 13/20 [01:30<00:43,  6.27s/it]
Task 1, Epoch 14/20 => Loss 0.034, Train_accy 99.22:  65%|██████▌   | 13/20 [01:34<00:43,  6.27s/it]
Task 1, Epoch 14/20 => Loss 0.034, Train_accy 99.22:  70%|███████   | 14/20 [01:34<00:34,  5.70s/it]
Task 1, Epoch 15/20 => Loss 0.072, Train_accy 97.92, Test_accy 96.45:  70%|███████   | 14/20 [01:56<00:34,  5.70s/it]
Task 1, Epoch 15/20 => Loss 0.072, Train_accy 97.92, Test_accy 96.45:  75%|███████▌  | 15/20 [01:56<00:51, 10.39s/it]
Task 1, Epoch 16/20 => Loss 0.031, Train_accy 99.22:  75%|███████▌  | 15/20 [02:00<00:51, 10.39s/it]                 
Task 1, Epoch 16/20 => Loss 0.031, Train_accy 99.22:  80%|████████  | 16/20 [02:00<00:34,  8.62s/it]
Task 1, Epoch 17/20 => Loss 0.057, Train_accy 98.70:  80%|████████  | 16/20 [02:05<00:34,  8.62s/it]
Task 1, Epoch 17/20 => Loss 0.057, Train_accy 98.70:  85%|████████▌ | 17/20 [02:05<00:22,  7.40s/it]
Task 1, Epoch 18/20 => Loss 0.053, Train_accy 98.18:  85%|████████▌ | 17/20 [02:09<00:22,  7.40s/it]
Task 1, Epoch 18/20 => Loss 0.053, Train_accy 98.18:  90%|█████████ | 18/20 [02:09<00:13,  6.53s/it]
Task 1, Epoch 19/20 => Loss 0.046, Train_accy 98.70:  90%|█████████ | 18/20 [02:14<00:13,  6.53s/it]
Task 1, Epoch 19/20 => Loss 0.046, Train_accy 98.70:  95%|█████████▌| 19/20 [02:14<00:05,  5.93s/it]
Task 1, Epoch 20/20 => Loss 0.034, Train_accy 99.48, Test_accy 97.30:  95%|█████████▌| 19/20 [02:34<00:05,  5.93s/it]
Task 1, Epoch 20/20 => Loss 0.034, Train_accy 99.48, Test_accy 97.30: 100%|██████████| 20/20 [02:34<00:00, 10.15s/it]
Task 1, Epoch 20/20 => Loss 0.034, Train_accy 99.48, Test_accy 97.30: 100%|██████████| 20/20 [02:34<00:00,  7.71s/it]2024-09-14 22:42:20,614 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.034, Train_accy 99.48, Test_accy 97.30

2024-09-14 22:42:36,741 [trainer.py] => No NME accuracy.
2024-09-14 22:42:36,742 [trainer.py] => CNN: {'total': 97.3, '00-09': 96.97, '10-19': 97.43, 'old': 96.97, 'new': 97.43}
2024-09-14 22:42:36,742 [trainer.py] => CNN top1 curve: [98.55, 97.3]
2024-09-14 22:42:36,742 [trainer.py] => CNN top5 curve: [99.39, 99.65]

Average Accuracy (CNN): 97.92
2024-09-14 22:42:36,742 [trainer.py] => Average Accuracy (CNN): 97.92 

2024-09-14 22:42:36,744 [trainer.py] => All params: 89677106
2024-09-14 22:42:36,745 [trainer.py] => Trainable params: 89677106
2024-09-14 22:42:39,064 [coda_prompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.014, Train_accy 38.10:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.014, Train_accy 38.10:   5%|▌         | 1/20 [00:04<01:17,  4.09s/it]
Task 2, Epoch 2/20 => Loss 0.554, Train_accy 82.44:   5%|▌         | 1/20 [00:08<01:17,  4.09s/it]
Task 2, Epoch 2/20 => Loss 0.554, Train_accy 82.44:  10%|█         | 2/20 [00:08<01:13,  4.07s/it]
Task 2, Epoch 3/20 => Loss 0.253, Train_accy 91.96:  10%|█         | 2/20 [00:12<01:13,  4.07s/it]
Task 2, Epoch 3/20 => Loss 0.253, Train_accy 91.96:  15%|█▌        | 3/20 [00:12<01:08,  4.05s/it]
Task 2, Epoch 4/20 => Loss 0.140, Train_accy 94.94:  15%|█▌        | 3/20 [00:16<01:08,  4.05s/it]
Task 2, Epoch 4/20 => Loss 0.140, Train_accy 94.94:  20%|██        | 4/20 [00:16<01:04,  4.05s/it]
Task 2, Epoch 5/20 => Loss 0.098, Train_accy 96.13, Test_accy 85.58:  20%|██        | 4/20 [00:46<01:04,  4.05s/it]
Task 2, Epoch 5/20 => Loss 0.098, Train_accy 96.13, Test_accy 85.58:  25%|██▌       | 5/20 [00:46<03:21, 13.41s/it]
Task 2, Epoch 6/20 => Loss 0.096, Train_accy 97.02:  25%|██▌       | 5/20 [00:50<03:21, 13.41s/it]                 
Task 2, Epoch 6/20 => Loss 0.096, Train_accy 97.02:  30%|███       | 6/20 [00:50<02:23, 10.26s/it]
Task 2, Epoch 7/20 => Loss 0.081, Train_accy 98.51:  30%|███       | 6/20 [00:54<02:23, 10.26s/it]
Task 2, Epoch 7/20 => Loss 0.081, Train_accy 98.51:  35%|███▌      | 7/20 [00:54<01:46,  8.23s/it]
Task 2, Epoch 8/20 => Loss 0.066, Train_accy 97.92:  35%|███▌      | 7/20 [00:58<01:46,  8.23s/it]
Task 2, Epoch 8/20 => Loss 0.066, Train_accy 97.92:  40%|████      | 8/20 [00:58<01:22,  6.90s/it]
Task 2, Epoch 9/20 => Loss 0.078, Train_accy 98.21:  40%|████      | 8/20 [01:02<01:22,  6.90s/it]
Task 2, Epoch 9/20 => Loss 0.078, Train_accy 98.21:  45%|████▌     | 9/20 [01:02<01:06,  6.02s/it]
Task 2, Epoch 10/20 => Loss 0.040, Train_accy 99.40, Test_accy 86.43:  45%|████▌     | 9/20 [01:31<01:06,  6.02s/it]
Task 2, Epoch 10/20 => Loss 0.040, Train_accy 99.40, Test_accy 86.43:  50%|█████     | 10/20 [01:31<02:09, 12.97s/it]
Task 2, Epoch 11/20 => Loss 0.055, Train_accy 99.11:  50%|█████     | 10/20 [01:34<02:09, 12.97s/it]                 
Task 2, Epoch 11/20 => Loss 0.055, Train_accy 99.11:  55%|█████▌    | 11/20 [01:34<01:31, 10.15s/it]
Task 2, Epoch 12/20 => Loss 0.077, Train_accy 97.32:  55%|█████▌    | 11/20 [01:38<01:31, 10.15s/it]
Task 2, Epoch 12/20 => Loss 0.077, Train_accy 97.32:  60%|██████    | 12/20 [01:38<01:05,  8.20s/it]
Task 2, Epoch 13/20 => Loss 0.069, Train_accy 98.51:  60%|██████    | 12/20 [01:42<01:05,  8.20s/it]
Task 2, Epoch 13/20 => Loss 0.069, Train_accy 98.51:  65%|██████▌   | 13/20 [01:42<00:48,  6.97s/it]
Task 2, Epoch 14/20 => Loss 0.047, Train_accy 98.21:  65%|██████▌   | 13/20 [01:46<00:48,  6.97s/it]
Task 2, Epoch 14/20 => Loss 0.047, Train_accy 98.21:  70%|███████   | 14/20 [01:46<00:36,  6.07s/it]
Task 2, Epoch 15/20 => Loss 0.061, Train_accy 98.21, Test_accy 86.05:  70%|███████   | 14/20 [02:16<00:36,  6.07s/it]
Task 2, Epoch 15/20 => Loss 0.061, Train_accy 98.21, Test_accy 86.05:  75%|███████▌  | 15/20 [02:16<01:06, 13.30s/it]
Task 2, Epoch 16/20 => Loss 0.046, Train_accy 98.51:  75%|███████▌  | 15/20 [02:20<01:06, 13.30s/it]                 
Task 2, Epoch 16/20 => Loss 0.046, Train_accy 98.51:  80%|████████  | 16/20 [02:20<00:41, 10.49s/it]
Task 2, Epoch 17/20 => Loss 0.053, Train_accy 98.21:  80%|████████  | 16/20 [02:24<00:41, 10.49s/it]
Task 2, Epoch 17/20 => Loss 0.053, Train_accy 98.21:  85%|████████▌ | 17/20 [02:24<00:25,  8.54s/it]
Task 2, Epoch 18/20 => Loss 0.037, Train_accy 99.11:  85%|████████▌ | 17/20 [02:28<00:25,  8.54s/it]
Task 2, Epoch 18/20 => Loss 0.037, Train_accy 99.11:  90%|█████████ | 18/20 [02:28<00:14,  7.10s/it]
Task 2, Epoch 19/20 => Loss 0.045, Train_accy 98.21:  90%|█████████ | 18/20 [02:32<00:14,  7.10s/it]
Task 2, Epoch 19/20 => Loss 0.045, Train_accy 98.21:  95%|█████████▌| 19/20 [02:32<00:06,  6.09s/it]
Task 2, Epoch 20/20 => Loss 0.052, Train_accy 98.51, Test_accy 86.16:  95%|█████████▌| 19/20 [03:00<00:06,  6.09s/it]
Task 2, Epoch 20/20 => Loss 0.052, Train_accy 98.51, Test_accy 86.16: 100%|██████████| 20/20 [03:00<00:00, 12.79s/it]
Task 2, Epoch 20/20 => Loss 0.052, Train_accy 98.51, Test_accy 86.16: 100%|██████████| 20/20 [03:00<00:00,  9.03s/it]2024-09-14 22:45:39,717 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.052, Train_accy 98.51, Test_accy 86.16

2024-09-14 22:46:05,827 [trainer.py] => No NME accuracy.
2024-09-14 22:46:05,827 [trainer.py] => CNN: {'total': 86.16, '00-09': 92.49, '10-19': 79.07, '20-29': 91.73, 'old': 82.96, 'new': 91.73}
2024-09-14 22:46:05,827 [trainer.py] => CNN top1 curve: [98.55, 97.3, 86.16]
2024-09-14 22:46:05,827 [trainer.py] => CNN top5 curve: [99.39, 99.65, 99.58]

Average Accuracy (CNN): 94.0
2024-09-14 22:46:05,827 [trainer.py] => Average Accuracy (CNN): 94.0 

2024-09-14 22:46:05,829 [trainer.py] => All params: 89677106
2024-09-14 22:46:05,830 [trainer.py] => Trainable params: 89677106
2024-09-14 22:46:09,137 [coda_prompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.404, Train_accy 31.94:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.404, Train_accy 31.94:   5%|▌         | 1/20 [00:03<01:07,  3.57s/it]
Task 3, Epoch 2/20 => Loss 0.528, Train_accy 88.19:   5%|▌         | 1/20 [00:07<01:07,  3.57s/it]
Task 3, Epoch 2/20 => Loss 0.528, Train_accy 88.19:  10%|█         | 2/20 [00:07<01:04,  3.59s/it]
Task 3, Epoch 3/20 => Loss 0.173, Train_accy 96.53:  10%|█         | 2/20 [00:10<01:04,  3.59s/it]
Task 3, Epoch 3/20 => Loss 0.173, Train_accy 96.53:  15%|█▌        | 3/20 [00:10<01:01,  3.62s/it]
Task 3, Epoch 4/20 => Loss 0.111, Train_accy 96.88:  15%|█▌        | 3/20 [00:14<01:01,  3.62s/it]
Task 3, Epoch 4/20 => Loss 0.111, Train_accy 96.88:  20%|██        | 4/20 [00:14<00:57,  3.59s/it]
Task 3, Epoch 5/20 => Loss 0.070, Train_accy 98.26, Test_accy 82.62:  20%|██        | 4/20 [00:49<00:57,  3.59s/it]
Task 3, Epoch 5/20 => Loss 0.070, Train_accy 98.26, Test_accy 82.62:  25%|██▌       | 5/20 [00:49<03:46, 15.11s/it]
Task 3, Epoch 6/20 => Loss 0.038, Train_accy 99.65:  25%|██▌       | 5/20 [00:53<03:46, 15.11s/it]                 
Task 3, Epoch 6/20 => Loss 0.038, Train_accy 99.65:  30%|███       | 6/20 [00:53<02:35, 11.09s/it]
Task 3, Epoch 7/20 => Loss 0.032, Train_accy 99.65:  30%|███       | 6/20 [00:59<02:35, 11.09s/it]
Task 3, Epoch 7/20 => Loss 0.032, Train_accy 99.65:  35%|███▌      | 7/20 [01:00<02:05,  9.69s/it]
Task 3, Epoch 8/20 => Loss 0.040, Train_accy 98.96:  35%|███▌      | 7/20 [01:03<02:05,  9.69s/it]
Task 3, Epoch 8/20 => Loss 0.040, Train_accy 98.96:  40%|████      | 8/20 [01:03<01:31,  7.66s/it]
Task 3, Epoch 9/20 => Loss 0.023, Train_accy 99.31:  40%|████      | 8/20 [01:06<01:31,  7.66s/it]
Task 3, Epoch 9/20 => Loss 0.023, Train_accy 99.31:  45%|████▌     | 9/20 [01:06<01:10,  6.38s/it]
Task 3, Epoch 10/20 => Loss 0.046, Train_accy 98.61, Test_accy 82.27:  45%|████▌     | 9/20 [01:43<01:10,  6.38s/it]
Task 3, Epoch 10/20 => Loss 0.046, Train_accy 98.61, Test_accy 82.27:  50%|█████     | 10/20 [01:43<02:38, 15.86s/it]
Task 3, Epoch 11/20 => Loss 0.038, Train_accy 99.31:  50%|█████     | 10/20 [01:47<02:38, 15.86s/it]                 
Task 3, Epoch 11/20 => Loss 0.038, Train_accy 99.31:  55%|█████▌    | 11/20 [01:47<01:49, 12.16s/it]
Task 3, Epoch 12/20 => Loss 0.034, Train_accy 99.31:  55%|█████▌    | 11/20 [01:52<01:49, 12.16s/it]
Task 3, Epoch 12/20 => Loss 0.034, Train_accy 99.31:  60%|██████    | 12/20 [01:52<01:18,  9.81s/it]
Task 3, Epoch 13/20 => Loss 0.019, Train_accy 99.65:  60%|██████    | 12/20 [01:55<01:18,  9.81s/it]
Task 3, Epoch 13/20 => Loss 0.019, Train_accy 99.65:  65%|██████▌   | 13/20 [01:55<00:54,  7.83s/it]
Task 3, Epoch 14/20 => Loss 0.035, Train_accy 98.96:  65%|██████▌   | 13/20 [01:58<00:54,  7.83s/it]
Task 3, Epoch 14/20 => Loss 0.035, Train_accy 98.96:  70%|███████   | 14/20 [01:58<00:38,  6.47s/it]
Task 3, Epoch 15/20 => Loss 0.018, Train_accy 99.31, Test_accy 82.16:  70%|███████   | 14/20 [02:33<00:38,  6.47s/it]
Task 3, Epoch 15/20 => Loss 0.018, Train_accy 99.31, Test_accy 82.16:  75%|███████▌  | 15/20 [02:33<01:15, 15.04s/it]
Task 3, Epoch 16/20 => Loss 0.016, Train_accy 100.00:  75%|███████▌  | 15/20 [02:37<01:15, 15.04s/it]                
Task 3, Epoch 16/20 => Loss 0.016, Train_accy 100.00:  80%|████████  | 16/20 [02:37<00:46, 11.58s/it]
Task 3, Epoch 17/20 => Loss 0.029, Train_accy 99.31:  80%|████████  | 16/20 [02:40<00:46, 11.58s/it] 
Task 3, Epoch 17/20 => Loss 0.029, Train_accy 99.31:  85%|████████▌ | 17/20 [02:40<00:27,  9.19s/it]
Task 3, Epoch 18/20 => Loss 0.018, Train_accy 99.31:  85%|████████▌ | 17/20 [02:44<00:27,  9.19s/it]
Task 3, Epoch 18/20 => Loss 0.018, Train_accy 99.31:  90%|█████████ | 18/20 [02:44<00:14,  7.50s/it]
Task 3, Epoch 19/20 => Loss 0.026, Train_accy 98.96:  90%|█████████ | 18/20 [02:47<00:14,  7.50s/it]
Task 3, Epoch 19/20 => Loss 0.026, Train_accy 98.96:  95%|█████████▌| 19/20 [02:47<00:06,  6.30s/it]
Task 3, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 82.18:  95%|█████████▌| 19/20 [03:24<00:06,  6.30s/it]
Task 3, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 82.18: 100%|██████████| 20/20 [03:24<00:00, 15.40s/it]
Task 3, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 82.18: 100%|██████████| 20/20 [03:24<00:00, 10.23s/it]2024-09-14 22:49:33,670 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 82.18

2024-09-14 22:50:05,177 [trainer.py] => No NME accuracy.
2024-09-14 22:50:05,178 [trainer.py] => CNN: {'total': 82.18, '00-09': 83.41, '10-19': 75.16, '20-29': 84.94, '30-39': 89.12, 'old': 80.25, 'new': 89.12}
2024-09-14 22:50:05,178 [trainer.py] => CNN top1 curve: [98.55, 97.3, 86.16, 82.18]
2024-09-14 22:50:05,178 [trainer.py] => CNN top5 curve: [99.39, 99.65, 99.58, 99.28]

Average Accuracy (CNN): 91.05
2024-09-14 22:50:05,179 [trainer.py] => Average Accuracy (CNN): 91.05 

2024-09-14 22:50:05,180 [trainer.py] => All params: 89677106
2024-09-14 22:50:05,181 [trainer.py] => Trainable params: 89677106
2024-09-14 22:50:08,975 [coda_prompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.268, Train_accy 61.93:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.268, Train_accy 61.93:   5%|▌         | 1/20 [00:05<01:49,  5.76s/it]
Task 4, Epoch 2/20 => Loss 0.307, Train_accy 89.02:   5%|▌         | 1/20 [00:11<01:49,  5.76s/it]
Task 4, Epoch 2/20 => Loss 0.307, Train_accy 89.02:  10%|█         | 2/20 [00:11<01:46,  5.93s/it]
Task 4, Epoch 3/20 => Loss 0.157, Train_accy 94.51:  10%|█         | 2/20 [00:17<01:46,  5.93s/it]
Task 4, Epoch 3/20 => Loss 0.157, Train_accy 94.51:  15%|█▌        | 3/20 [00:17<01:41,  5.97s/it]
Task 4, Epoch 4/20 => Loss 0.139, Train_accy 95.27:  15%|█▌        | 3/20 [00:23<01:41,  5.97s/it]
Task 4, Epoch 4/20 => Loss 0.139, Train_accy 95.27:  20%|██        | 4/20 [00:23<01:36,  6.01s/it]
Task 4, Epoch 5/20 => Loss 0.120, Train_accy 96.40, Test_accy 73.67:  20%|██        | 4/20 [01:17<01:36,  6.01s/it]
Task 4, Epoch 5/20 => Loss 0.120, Train_accy 96.40, Test_accy 73.67:  25%|██▌       | 5/20 [01:17<05:49, 23.33s/it]
Task 4, Epoch 6/20 => Loss 0.073, Train_accy 97.35:  25%|██▌       | 5/20 [01:23<05:49, 23.33s/it]                 
Task 4, Epoch 6/20 => Loss 0.073, Train_accy 97.35:  30%|███       | 6/20 [01:23<04:03, 17.39s/it]
Task 4, Epoch 7/20 => Loss 0.091, Train_accy 96.59:  30%|███       | 6/20 [01:29<04:03, 17.39s/it]
Task 4, Epoch 7/20 => Loss 0.091, Train_accy 96.59:  35%|███▌      | 7/20 [01:29<02:56, 13.61s/it]
Task 4, Epoch 8/20 => Loss 0.094, Train_accy 96.78:  35%|███▌      | 7/20 [01:35<02:56, 13.61s/it]
Task 4, Epoch 8/20 => Loss 0.094, Train_accy 96.78:  40%|████      | 8/20 [01:35<02:14, 11.21s/it]
Task 4, Epoch 9/20 => Loss 0.067, Train_accy 97.92:  40%|████      | 8/20 [01:41<02:14, 11.21s/it]
Task 4, Epoch 9/20 => Loss 0.067, Train_accy 97.92:  45%|████▌     | 9/20 [01:41<01:45,  9.59s/it]
Task 4, Epoch 10/20 => Loss 0.087, Train_accy 97.35, Test_accy 74.92:  45%|████▌     | 9/20 [02:36<01:45,  9.59s/it]
Task 4, Epoch 10/20 => Loss 0.087, Train_accy 97.35, Test_accy 74.92:  50%|█████     | 10/20 [02:36<03:56, 23.65s/it]
Task 4, Epoch 11/20 => Loss 0.090, Train_accy 97.16:  50%|█████     | 10/20 [02:42<03:56, 23.65s/it]                 
Task 4, Epoch 11/20 => Loss 0.090, Train_accy 97.16:  55%|█████▌    | 11/20 [02:42<02:43, 18.15s/it]
Task 4, Epoch 12/20 => Loss 0.083, Train_accy 97.35:  55%|█████▌    | 11/20 [02:48<02:43, 18.15s/it]
Task 4, Epoch 12/20 => Loss 0.083, Train_accy 97.35:  60%|██████    | 12/20 [02:48<01:54, 14.37s/it]
Task 4, Epoch 13/20 => Loss 0.079, Train_accy 97.73:  60%|██████    | 12/20 [02:53<01:54, 14.37s/it]
Task 4, Epoch 13/20 => Loss 0.079, Train_accy 97.73:  65%|██████▌   | 13/20 [02:53<01:22, 11.73s/it]
Task 4, Epoch 14/20 => Loss 0.068, Train_accy 97.73:  65%|██████▌   | 13/20 [02:59<01:22, 11.73s/it]
Task 4, Epoch 14/20 => Loss 0.068, Train_accy 97.73:  70%|███████   | 14/20 [02:59<00:59,  9.90s/it]
Task 4, Epoch 15/20 => Loss 0.067, Train_accy 97.92, Test_accy 74.51:  70%|███████   | 14/20 [03:54<00:59,  9.90s/it]
Task 4, Epoch 15/20 => Loss 0.067, Train_accy 97.92, Test_accy 74.51:  75%|███████▌  | 15/20 [03:54<01:57, 23.58s/it]
Task 4, Epoch 16/20 => Loss 0.067, Train_accy 98.86:  75%|███████▌  | 15/20 [04:00<01:57, 23.58s/it]                 
Task 4, Epoch 16/20 => Loss 0.067, Train_accy 98.86:  80%|████████  | 16/20 [04:00<01:13, 18.28s/it]
Task 4, Epoch 17/20 => Loss 0.063, Train_accy 97.73:  80%|████████  | 16/20 [04:06<01:13, 18.28s/it]
Task 4, Epoch 17/20 => Loss 0.063, Train_accy 97.73:  85%|████████▌ | 17/20 [04:06<00:43, 14.47s/it]
Task 4, Epoch 18/20 => Loss 0.070, Train_accy 98.48:  85%|████████▌ | 17/20 [04:12<00:43, 14.47s/it]
Task 4, Epoch 18/20 => Loss 0.070, Train_accy 98.48:  90%|█████████ | 18/20 [04:12<00:23, 11.82s/it]
Task 4, Epoch 19/20 => Loss 0.065, Train_accy 98.48:  90%|█████████ | 18/20 [04:17<00:23, 11.82s/it]
Task 4, Epoch 19/20 => Loss 0.065, Train_accy 98.48:  95%|█████████▌| 19/20 [04:17<00:09,  9.99s/it]
Task 4, Epoch 20/20 => Loss 0.036, Train_accy 98.86, Test_accy 74.90:  95%|█████████▌| 19/20 [05:12<00:09,  9.99s/it]
Task 4, Epoch 20/20 => Loss 0.036, Train_accy 98.86, Test_accy 74.90: 100%|██████████| 20/20 [05:12<00:00, 23.28s/it]
Task 4, Epoch 20/20 => Loss 0.036, Train_accy 98.86, Test_accy 74.90: 100%|██████████| 20/20 [05:12<00:00, 15.61s/it]2024-09-14 22:55:21,090 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.036, Train_accy 98.86, Test_accy 74.90

2024-09-14 22:56:08,487 [trainer.py] => No NME accuracy.
2024-09-14 22:56:08,487 [trainer.py] => CNN: {'total': 74.9, '00-09': 82.2, '10-19': 69.77, '20-29': 78.87, '30-39': 86.96, '40-49': 68.95, 'old': 77.91, 'new': 68.95}
2024-09-14 22:56:08,487 [trainer.py] => CNN top1 curve: [98.55, 97.3, 86.16, 82.18, 74.9]
2024-09-14 22:56:08,487 [trainer.py] => CNN top5 curve: [99.39, 99.65, 99.58, 99.28, 98.47]

Average Accuracy (CNN): 87.82
2024-09-14 22:56:08,487 [trainer.py] => Average Accuracy (CNN): 87.82 

Accuracy Matrix (CNN):
[[98.55 96.97 92.49 83.41 82.2 ]
 [ 0.   97.43 79.07 75.16 69.77]
 [ 0.    0.   91.73 84.94 78.87]
 [ 0.    0.    0.   89.12 86.96]
 [ 0.    0.    0.    0.   68.95]]
2024-09-14 22:56:08,488 [trainer.py] => Forgetting (CNN): 14.757500000000004
2024-09-14 22:56:10,904 [trainer.py] => config: ./exps/coda_prompt_vtab_B0_Inc10.json
2024-09-14 22:56:10,924 [trainer.py] => prefix:  
2024-09-14 22:56:10,924 [trainer.py] => dataset: vtab
2024-09-14 22:56:10,924 [trainer.py] => memory_size: 0
2024-09-14 22:56:10,924 [trainer.py] => memory_per_class: 0
2024-09-14 22:56:10,924 [trainer.py] => fixed_memory: False
2024-09-14 22:56:10,924 [trainer.py] => shuffle: True
2024-09-14 22:56:10,924 [trainer.py] => init_cls: 5
2024-09-14 22:56:10,925 [trainer.py] => increment: 5
2024-09-14 22:56:10,925 [trainer.py] => model_name: coda_prompt
2024-09-14 22:56:10,925 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-14 22:56:10,925 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 22:56:10,925 [trainer.py] => seed: 1993
2024-09-14 22:56:10,925 [trainer.py] => tuned_epoch: 20
2024-09-14 22:56:10,925 [trainer.py] => init_lr: 0.001
2024-09-14 22:56:10,925 [trainer.py] => batch_size: 48
2024-09-14 22:56:10,925 [trainer.py] => weight_decay: 0
2024-09-14 22:56:10,926 [trainer.py] => min_lr: 1e-05
2024-09-14 22:56:10,926 [trainer.py] => optimizer: adam
2024-09-14 22:56:10,926 [trainer.py] => scheduler: cosine
2024-09-14 22:56:10,926 [trainer.py] => reinit_optimizer: True
2024-09-14 22:56:10,926 [trainer.py] => pretrained: True
2024-09-14 22:56:10,926 [trainer.py] => drop: 0.0
2024-09-14 22:56:10,926 [trainer.py] => drop_path: 0.0
2024-09-14 22:56:10,926 [trainer.py] => prompt_param: [100, 8.0, 0.0]
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 22:56:10,977 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-09-14 22:56:13,185 [coda_prompt.py] => 89,677,106 total parameters.
2024-09-14 22:56:13,185 [coda_prompt.py] => 3,878,450 fc and prompt training parameters.
2024-09-14 22:56:13,186 [trainer.py] => All params: 89677106
2024-09-14 22:56:13,186 [trainer.py] => Trainable params: 89677106
2024-09-14 22:56:13,186 [coda_prompt.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.436, Train_accy 12.50:   0%|          | 0/20 [00:01<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.436, Train_accy 12.50:   5%|▌         | 1/20 [00:01<00:30,  1.62s/it]
Task 0, Epoch 2/20 => Loss 1.867, Train_accy 18.75:   5%|▌         | 1/20 [00:02<00:30,  1.62s/it]
Task 0, Epoch 2/20 => Loss 1.867, Train_accy 18.75:  10%|█         | 2/20 [00:02<00:23,  1.30s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 50.00:  10%|█         | 2/20 [00:03<00:23,  1.30s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 50.00:  15%|█▌        | 3/20 [00:03<00:19,  1.17s/it]
Task 0, Epoch 4/20 => Loss 1.191, Train_accy 54.17:  15%|█▌        | 3/20 [00:04<00:19,  1.17s/it]
Task 0, Epoch 4/20 => Loss 1.191, Train_accy 54.17:  20%|██        | 4/20 [00:04<00:17,  1.08s/it]
Task 0, Epoch 5/20 => Loss 0.687, Train_accy 81.25, Test_accy 85.66:  20%|██        | 4/20 [00:07<00:17,  1.08s/it]
Task 0, Epoch 5/20 => Loss 0.687, Train_accy 81.25, Test_accy 85.66:  25%|██▌       | 5/20 [00:07<00:27,  1.85s/it]
Task 0, Epoch 6/20 => Loss 0.608, Train_accy 79.17:  25%|██▌       | 5/20 [00:08<00:27,  1.85s/it]                 
Task 0, Epoch 6/20 => Loss 0.608, Train_accy 79.17:  30%|███       | 6/20 [00:08<00:21,  1.55s/it]
Task 0, Epoch 7/20 => Loss 0.351, Train_accy 95.83:  30%|███       | 6/20 [00:09<00:21,  1.55s/it]
Task 0, Epoch 7/20 => Loss 0.351, Train_accy 95.83:  35%|███▌      | 7/20 [00:09<00:17,  1.36s/it]
Task 0, Epoch 8/20 => Loss 0.358, Train_accy 93.75:  35%|███▌      | 7/20 [00:10<00:17,  1.36s/it]
Task 0, Epoch 8/20 => Loss 0.358, Train_accy 93.75:  40%|████      | 8/20 [00:10<00:14,  1.23s/it]
Task 0, Epoch 9/20 => Loss 0.255, Train_accy 93.75:  40%|████      | 8/20 [00:11<00:14,  1.23s/it]
Task 0, Epoch 9/20 => Loss 0.255, Train_accy 93.75:  45%|████▌     | 9/20 [00:11<00:12,  1.15s/it]
Task 0, Epoch 10/20 => Loss 0.153, Train_accy 95.83, Test_accy 91.96:  45%|████▌     | 9/20 [00:14<00:12,  1.15s/it]
Task 0, Epoch 10/20 => Loss 0.153, Train_accy 95.83, Test_accy 91.96:  50%|█████     | 10/20 [00:14<00:17,  1.77s/it]
Task 0, Epoch 11/20 => Loss 0.136, Train_accy 97.92:  50%|█████     | 10/20 [00:15<00:17,  1.77s/it]                 
Task 0, Epoch 11/20 => Loss 0.136, Train_accy 97.92:  55%|█████▌    | 11/20 [00:15<00:13,  1.53s/it]
Task 0, Epoch 12/20 => Loss 0.133, Train_accy 95.83:  55%|█████▌    | 11/20 [00:16<00:13,  1.53s/it]
Task 0, Epoch 12/20 => Loss 0.133, Train_accy 95.83:  60%|██████    | 12/20 [00:16<00:10,  1.36s/it]
Task 0, Epoch 13/20 => Loss 0.098, Train_accy 100.00:  60%|██████    | 12/20 [00:17<00:10,  1.36s/it]
Task 0, Epoch 13/20 => Loss 0.098, Train_accy 100.00:  65%|██████▌   | 13/20 [00:17<00:08,  1.22s/it]
Task 0, Epoch 14/20 => Loss 0.092, Train_accy 100.00:  65%|██████▌   | 13/20 [00:18<00:08,  1.22s/it]
Task 0, Epoch 14/20 => Loss 0.092, Train_accy 100.00:  70%|███████   | 14/20 [00:18<00:06,  1.15s/it]
Task 0, Epoch 15/20 => Loss 0.109, Train_accy 100.00, Test_accy 94.06:  70%|███████   | 14/20 [00:21<00:06,  1.15s/it]
Task 0, Epoch 15/20 => Loss 0.109, Train_accy 100.00, Test_accy 94.06:  75%|███████▌  | 15/20 [00:21<00:08,  1.75s/it]
Task 0, Epoch 16/20 => Loss 0.057, Train_accy 100.00:  75%|███████▌  | 15/20 [00:22<00:08,  1.75s/it]                 
Task 0, Epoch 16/20 => Loss 0.057, Train_accy 100.00:  80%|████████  | 16/20 [00:22<00:06,  1.51s/it]
Task 0, Epoch 17/20 => Loss 0.072, Train_accy 97.92:  80%|████████  | 16/20 [00:23<00:06,  1.51s/it] 
Task 0, Epoch 17/20 => Loss 0.072, Train_accy 97.92:  85%|████████▌ | 17/20 [00:23<00:04,  1.34s/it]
Task 0, Epoch 18/20 => Loss 0.075, Train_accy 97.92:  85%|████████▌ | 17/20 [00:24<00:04,  1.34s/it]
Task 0, Epoch 18/20 => Loss 0.075, Train_accy 97.92:  90%|█████████ | 18/20 [00:24<00:02,  1.27s/it]
Task 0, Epoch 19/20 => Loss 0.064, Train_accy 97.92:  90%|█████████ | 18/20 [00:25<00:02,  1.27s/it]
Task 0, Epoch 19/20 => Loss 0.064, Train_accy 97.92:  95%|█████████▌| 19/20 [00:25<00:01,  1.17s/it]
Task 0, Epoch 20/20 => Loss 0.053, Train_accy 100.00, Test_accy 94.41:  95%|█████████▌| 19/20 [00:29<00:01,  1.17s/it]
Task 0, Epoch 20/20 => Loss 0.053, Train_accy 100.00, Test_accy 94.41: 100%|██████████| 20/20 [00:29<00:00,  1.79s/it]
Task 0, Epoch 20/20 => Loss 0.053, Train_accy 100.00, Test_accy 94.41: 100%|██████████| 20/20 [00:29<00:00,  1.45s/it]2024-09-14 22:56:42,753 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.053, Train_accy 100.00, Test_accy 94.41

2024-09-14 22:56:44,999 [trainer.py] => No NME accuracy.
2024-09-14 22:56:45,000 [trainer.py] => CNN: {'total': 94.41, '00-04': 94.41, 'old': 0, 'new': 94.41}
2024-09-14 22:56:45,000 [trainer.py] => CNN top1 curve: [94.41]
2024-09-14 22:56:45,000 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 94.41
2024-09-14 22:56:45,000 [trainer.py] => Average Accuracy (CNN): 94.41 

2024-09-14 22:56:45,002 [trainer.py] => All params: 89677106
2024-09-14 22:56:45,003 [trainer.py] => Trainable params: 89677106
2024-09-14 22:56:45,357 [coda_prompt.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.198, Train_accy 12.50:   0%|          | 0/20 [00:01<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.198, Train_accy 12.50:   5%|▌         | 1/20 [00:01<00:22,  1.21s/it]
Task 1, Epoch 2/20 => Loss 1.665, Train_accy 25.00:   5%|▌         | 1/20 [00:02<00:22,  1.21s/it]
Task 1, Epoch 2/20 => Loss 1.665, Train_accy 25.00:  10%|█         | 2/20 [00:02<00:19,  1.07s/it]
Task 1, Epoch 3/20 => Loss 1.046, Train_accy 64.58:  10%|█         | 2/20 [00:03<00:19,  1.07s/it]
Task 1, Epoch 3/20 => Loss 1.046, Train_accy 64.58:  15%|█▌        | 3/20 [00:03<00:18,  1.07s/it]
Task 1, Epoch 4/20 => Loss 0.712, Train_accy 83.33:  15%|█▌        | 3/20 [00:04<00:18,  1.07s/it]
Task 1, Epoch 4/20 => Loss 0.712, Train_accy 83.33:  20%|██        | 4/20 [00:04<00:17,  1.09s/it]
Task 1, Epoch 5/20 => Loss 0.522, Train_accy 93.75, Test_accy 83.78:  20%|██        | 4/20 [00:10<00:17,  1.09s/it]
Task 1, Epoch 5/20 => Loss 0.522, Train_accy 93.75, Test_accy 83.78:  25%|██▌       | 5/20 [00:10<00:44,  2.96s/it]
Task 1, Epoch 6/20 => Loss 0.337, Train_accy 93.75:  25%|██▌       | 5/20 [00:11<00:44,  2.96s/it]                 
Task 1, Epoch 6/20 => Loss 0.337, Train_accy 93.75:  30%|███       | 6/20 [00:11<00:32,  2.30s/it]
Task 1, Epoch 7/20 => Loss 0.286, Train_accy 93.75:  30%|███       | 6/20 [00:12<00:32,  2.30s/it]
Task 1, Epoch 7/20 => Loss 0.286, Train_accy 93.75:  35%|███▌      | 7/20 [00:12<00:24,  1.86s/it]
Task 1, Epoch 8/20 => Loss 0.144, Train_accy 100.00:  35%|███▌      | 7/20 [00:13<00:24,  1.86s/it]
Task 1, Epoch 8/20 => Loss 0.144, Train_accy 100.00:  40%|████      | 8/20 [00:13<00:19,  1.60s/it]
Task 1, Epoch 9/20 => Loss 0.149, Train_accy 97.92:  40%|████      | 8/20 [00:14<00:19,  1.60s/it] 
Task 1, Epoch 9/20 => Loss 0.149, Train_accy 97.92:  45%|████▌     | 9/20 [00:14<00:15,  1.40s/it]
Task 1, Epoch 10/20 => Loss 0.071, Train_accy 100.00, Test_accy 94.67:  45%|████▌     | 9/20 [00:20<00:15,  1.40s/it]
Task 1, Epoch 10/20 => Loss 0.071, Train_accy 100.00, Test_accy 94.67:  50%|█████     | 10/20 [00:20<00:29,  2.94s/it]
Task 1, Epoch 11/20 => Loss 0.066, Train_accy 100.00:  50%|█████     | 10/20 [00:21<00:29,  2.94s/it]                 
Task 1, Epoch 11/20 => Loss 0.066, Train_accy 100.00:  55%|█████▌    | 11/20 [00:21<00:21,  2.34s/it]
Task 1, Epoch 12/20 => Loss 0.063, Train_accy 100.00:  55%|█████▌    | 11/20 [00:22<00:21,  2.34s/it]
Task 1, Epoch 12/20 => Loss 0.063, Train_accy 100.00:  60%|██████    | 12/20 [00:22<00:15,  1.93s/it]
Task 1, Epoch 13/20 => Loss 0.042, Train_accy 100.00:  60%|██████    | 12/20 [00:23<00:15,  1.93s/it]
Task 1, Epoch 13/20 => Loss 0.042, Train_accy 100.00:  65%|██████▌   | 13/20 [00:23<00:11,  1.65s/it]
Task 1, Epoch 14/20 => Loss 0.042, Train_accy 100.00:  65%|██████▌   | 13/20 [00:24<00:11,  1.65s/it]
Task 1, Epoch 14/20 => Loss 0.042, Train_accy 100.00:  70%|███████   | 14/20 [00:24<00:08,  1.45s/it]
Task 1, Epoch 15/20 => Loss 0.027, Train_accy 100.00, Test_accy 95.76:  70%|███████   | 14/20 [00:30<00:08,  1.45s/it]
Task 1, Epoch 15/20 => Loss 0.027, Train_accy 100.00, Test_accy 95.76:  75%|███████▌  | 15/20 [00:30<00:14,  2.81s/it]
Task 1, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  75%|███████▌  | 15/20 [00:31<00:14,  2.81s/it]                 
Task 1, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  80%|████████  | 16/20 [00:31<00:09,  2.29s/it]
Task 1, Epoch 17/20 => Loss 0.112, Train_accy 97.92:  80%|████████  | 16/20 [00:32<00:09,  2.29s/it] 
Task 1, Epoch 17/20 => Loss 0.112, Train_accy 97.92:  85%|████████▌ | 17/20 [00:32<00:05,  1.89s/it]
Task 1, Epoch 18/20 => Loss 0.023, Train_accy 100.00:  85%|████████▌ | 17/20 [00:33<00:05,  1.89s/it]
Task 1, Epoch 18/20 => Loss 0.023, Train_accy 100.00:  90%|█████████ | 18/20 [00:33<00:03,  1.61s/it]
Task 1, Epoch 19/20 => Loss 0.051, Train_accy 97.92:  90%|█████████ | 18/20 [00:34<00:03,  1.61s/it] 
Task 1, Epoch 19/20 => Loss 0.051, Train_accy 97.92:  95%|█████████▌| 19/20 [00:34<00:01,  1.42s/it]
Task 1, Epoch 20/20 => Loss 0.019, Train_accy 100.00, Test_accy 96.13:  95%|█████████▌| 19/20 [00:40<00:01,  1.42s/it]
Task 1, Epoch 20/20 => Loss 0.019, Train_accy 100.00, Test_accy 96.13: 100%|██████████| 20/20 [00:40<00:00,  2.80s/it]
Task 1, Epoch 20/20 => Loss 0.019, Train_accy 100.00, Test_accy 96.13: 100%|██████████| 20/20 [00:40<00:00,  2.05s/it]2024-09-14 22:57:26,274 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.019, Train_accy 100.00, Test_accy 96.13

2024-09-14 22:57:31,288 [trainer.py] => No NME accuracy.
2024-09-14 22:57:31,288 [trainer.py] => CNN: {'total': 96.13, '00-04': 90.21, '05-09': 99.26, 'old': 90.21, 'new': 99.26}
2024-09-14 22:57:31,289 [trainer.py] => CNN top1 curve: [94.41, 96.13]
2024-09-14 22:57:31,289 [trainer.py] => CNN top5 curve: [100.0, 99.15]

Average Accuracy (CNN): 95.27
2024-09-14 22:57:31,289 [trainer.py] => Average Accuracy (CNN): 95.27 

2024-09-14 22:57:31,290 [trainer.py] => All params: 89677106
2024-09-14 22:57:31,291 [trainer.py] => Trainable params: 89677106
2024-09-14 22:57:31,909 [coda_prompt.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.486, Train_accy 51.04:   0%|          | 0/20 [00:01<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.486, Train_accy 51.04:   5%|▌         | 1/20 [00:01<00:24,  1.32s/it]
Task 2, Epoch 2/20 => Loss 0.678, Train_accy 77.08:   5%|▌         | 1/20 [00:02<00:24,  1.32s/it]
Task 2, Epoch 2/20 => Loss 0.678, Train_accy 77.08:  10%|█         | 2/20 [00:02<00:24,  1.36s/it]
Task 2, Epoch 3/20 => Loss 0.347, Train_accy 94.79:  10%|█         | 2/20 [00:04<00:24,  1.36s/it]
Task 2, Epoch 3/20 => Loss 0.347, Train_accy 94.79:  15%|█▌        | 3/20 [00:04<00:23,  1.38s/it]
Task 2, Epoch 4/20 => Loss 0.171, Train_accy 97.92:  15%|█▌        | 3/20 [00:05<00:23,  1.38s/it]
Task 2, Epoch 4/20 => Loss 0.171, Train_accy 97.92:  20%|██        | 4/20 [00:05<00:22,  1.40s/it]
Task 2, Epoch 5/20 => Loss 0.133, Train_accy 97.92, Test_accy 95.55:  20%|██        | 4/20 [00:15<00:22,  1.40s/it]
Task 2, Epoch 5/20 => Loss 0.133, Train_accy 97.92, Test_accy 95.55:  25%|██▌       | 5/20 [00:15<01:08,  4.56s/it]
Task 2, Epoch 6/20 => Loss 0.097, Train_accy 96.88:  25%|██▌       | 5/20 [00:17<01:08,  4.56s/it]                 
Task 2, Epoch 6/20 => Loss 0.097, Train_accy 96.88:  30%|███       | 6/20 [00:17<00:49,  3.51s/it]
Task 2, Epoch 7/20 => Loss 0.047, Train_accy 98.96:  30%|███       | 6/20 [00:18<00:49,  3.51s/it]
Task 2, Epoch 7/20 => Loss 0.047, Train_accy 98.96:  35%|███▌      | 7/20 [00:18<00:36,  2.82s/it]
Task 2, Epoch 8/20 => Loss 0.027, Train_accy 100.00:  35%|███▌      | 7/20 [00:20<00:36,  2.82s/it]
Task 2, Epoch 8/20 => Loss 0.027, Train_accy 100.00:  40%|████      | 8/20 [00:20<00:28,  2.40s/it]
Task 2, Epoch 9/20 => Loss 0.015, Train_accy 100.00:  40%|████      | 8/20 [00:21<00:28,  2.40s/it]
Task 2, Epoch 9/20 => Loss 0.015, Train_accy 100.00:  45%|████▌     | 9/20 [00:21<00:23,  2.10s/it]
Task 2, Epoch 10/20 => Loss 0.013, Train_accy 100.00, Test_accy 96.24:  45%|████▌     | 9/20 [00:31<00:23,  2.10s/it]
Task 2, Epoch 10/20 => Loss 0.013, Train_accy 100.00, Test_accy 96.24:  50%|█████     | 10/20 [00:31<00:46,  4.61s/it]
Task 2, Epoch 11/20 => Loss 0.011, Train_accy 100.00:  50%|█████     | 10/20 [00:33<00:46,  4.61s/it]                 
Task 2, Epoch 11/20 => Loss 0.011, Train_accy 100.00:  55%|█████▌    | 11/20 [00:33<00:32,  3.66s/it]
Task 2, Epoch 12/20 => Loss 0.026, Train_accy 100.00:  55%|█████▌    | 11/20 [00:34<00:32,  3.66s/it]
Task 2, Epoch 12/20 => Loss 0.026, Train_accy 100.00:  60%|██████    | 12/20 [00:34<00:23,  2.97s/it]
Task 2, Epoch 13/20 => Loss 0.009, Train_accy 100.00:  60%|██████    | 12/20 [00:36<00:23,  2.97s/it]
Task 2, Epoch 13/20 => Loss 0.009, Train_accy 100.00:  65%|██████▌   | 13/20 [00:36<00:17,  2.53s/it]
Task 2, Epoch 14/20 => Loss 0.010, Train_accy 100.00:  65%|██████▌   | 13/20 [00:37<00:17,  2.53s/it]
Task 2, Epoch 14/20 => Loss 0.010, Train_accy 100.00:  70%|███████   | 14/20 [00:37<00:13,  2.21s/it]
Task 2, Epoch 15/20 => Loss 0.009, Train_accy 100.00, Test_accy 96.24:  70%|███████   | 14/20 [00:47<00:13,  2.21s/it]
Task 2, Epoch 15/20 => Loss 0.009, Train_accy 100.00, Test_accy 96.24:  75%|███████▌  | 15/20 [00:47<00:23,  4.64s/it]
Task 2, Epoch 16/20 => Loss 0.017, Train_accy 98.96:  75%|███████▌  | 15/20 [00:49<00:23,  4.64s/it]                  
Task 2, Epoch 16/20 => Loss 0.017, Train_accy 98.96:  80%|████████  | 16/20 [00:49<00:14,  3.69s/it]
Task 2, Epoch 17/20 => Loss 0.021, Train_accy 98.96:  80%|████████  | 16/20 [00:50<00:14,  3.69s/it]
Task 2, Epoch 17/20 => Loss 0.021, Train_accy 98.96:  85%|████████▌ | 17/20 [00:50<00:09,  3.02s/it]
Task 2, Epoch 18/20 => Loss 0.003, Train_accy 100.00:  85%|████████▌ | 17/20 [00:52<00:09,  3.02s/it]
Task 2, Epoch 18/20 => Loss 0.003, Train_accy 100.00:  90%|█████████ | 18/20 [00:52<00:05,  2.55s/it]
Task 2, Epoch 19/20 => Loss 0.009, Train_accy 100.00:  90%|█████████ | 18/20 [00:53<00:05,  2.55s/it]
Task 2, Epoch 19/20 => Loss 0.009, Train_accy 100.00:  95%|█████████▌| 19/20 [00:53<00:02,  2.23s/it]
Task 2, Epoch 20/20 => Loss 0.048, Train_accy 98.96, Test_accy 96.38:  95%|█████████▌| 19/20 [01:04<00:02,  2.23s/it]
Task 2, Epoch 20/20 => Loss 0.048, Train_accy 98.96, Test_accy 96.38: 100%|██████████| 20/20 [01:04<00:00,  4.66s/it]
Task 2, Epoch 20/20 => Loss 0.048, Train_accy 98.96, Test_accy 96.38: 100%|██████████| 20/20 [01:04<00:00,  3.21s/it]2024-09-14 22:58:36,046 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.048, Train_accy 98.96, Test_accy 96.38

2024-09-14 22:58:44,207 [trainer.py] => No NME accuracy.
2024-09-14 22:58:44,207 [trainer.py] => CNN: {'total': 96.38, '00-04': 87.06, '05-09': 97.59, '10-14': 99.67, 'old': 93.95, 'new': 99.67}
2024-09-14 22:58:44,207 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38]
2024-09-14 22:58:44,207 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1]

Average Accuracy (CNN): 95.64
2024-09-14 22:58:44,208 [trainer.py] => Average Accuracy (CNN): 95.64 

2024-09-14 22:58:44,209 [trainer.py] => All params: 89677106
2024-09-14 22:58:44,209 [trainer.py] => Trainable params: 89677106
2024-09-14 22:58:44,974 [coda_prompt.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.437, Train_accy 45.83:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.437, Train_accy 45.83:   5%|▌         | 1/20 [00:02<00:51,  2.73s/it]
Task 3, Epoch 2/20 => Loss 0.515, Train_accy 79.58:   5%|▌         | 1/20 [00:05<00:51,  2.73s/it]
Task 3, Epoch 2/20 => Loss 0.515, Train_accy 79.58:  10%|█         | 2/20 [00:05<00:50,  2.81s/it]
Task 3, Epoch 3/20 => Loss 0.252, Train_accy 92.50:  10%|█         | 2/20 [00:08<00:50,  2.81s/it]
Task 3, Epoch 3/20 => Loss 0.252, Train_accy 92.50:  15%|█▌        | 3/20 [00:08<00:47,  2.80s/it]
Task 3, Epoch 4/20 => Loss 0.180, Train_accy 92.50:  15%|█▌        | 3/20 [00:11<00:47,  2.80s/it]
Task 3, Epoch 4/20 => Loss 0.180, Train_accy 92.50:  20%|██        | 4/20 [00:11<00:44,  2.77s/it]
Task 3, Epoch 5/20 => Loss 0.147, Train_accy 95.42, Test_accy 84.86:  20%|██        | 4/20 [00:30<00:44,  2.77s/it]
Task 3, Epoch 5/20 => Loss 0.147, Train_accy 95.42, Test_accy 84.86:  25%|██▌       | 5/20 [00:30<02:09,  8.62s/it]
Task 3, Epoch 6/20 => Loss 0.144, Train_accy 94.17:  25%|██▌       | 5/20 [00:33<02:09,  8.62s/it]                 
Task 3, Epoch 6/20 => Loss 0.144, Train_accy 94.17:  30%|███       | 6/20 [00:33<01:34,  6.73s/it]
Task 3, Epoch 7/20 => Loss 0.095, Train_accy 97.50:  30%|███       | 6/20 [00:36<01:34,  6.73s/it]
Task 3, Epoch 7/20 => Loss 0.095, Train_accy 97.50:  35%|███▌      | 7/20 [00:36<01:11,  5.49s/it]
Task 3, Epoch 8/20 => Loss 0.103, Train_accy 96.67:  35%|███▌      | 7/20 [00:39<01:11,  5.49s/it]
Task 3, Epoch 8/20 => Loss 0.103, Train_accy 96.67:  40%|████      | 8/20 [00:39<00:56,  4.70s/it]
Task 3, Epoch 9/20 => Loss 0.076, Train_accy 97.92:  40%|████      | 8/20 [00:42<00:56,  4.70s/it]
Task 3, Epoch 9/20 => Loss 0.076, Train_accy 97.92:  45%|████▌     | 9/20 [00:42<00:45,  4.15s/it]
Task 3, Epoch 10/20 => Loss 0.070, Train_accy 98.33, Test_accy 89.88:  45%|████▌     | 9/20 [01:01<00:45,  4.15s/it]
Task 3, Epoch 10/20 => Loss 0.070, Train_accy 98.33, Test_accy 89.88:  50%|█████     | 10/20 [01:01<01:29,  8.93s/it]
Task 3, Epoch 11/20 => Loss 0.101, Train_accy 96.67:  50%|█████     | 10/20 [01:04<01:29,  8.93s/it]                 
Task 3, Epoch 11/20 => Loss 0.101, Train_accy 96.67:  55%|█████▌    | 11/20 [01:04<01:03,  7.11s/it]
Task 3, Epoch 12/20 => Loss 0.093, Train_accy 97.50:  55%|█████▌    | 11/20 [01:07<01:03,  7.11s/it]
Task 3, Epoch 12/20 => Loss 0.093, Train_accy 97.50:  60%|██████    | 12/20 [01:07<00:46,  5.84s/it]
Task 3, Epoch 13/20 => Loss 0.132, Train_accy 94.58:  60%|██████    | 12/20 [01:10<00:46,  5.84s/it]
Task 3, Epoch 13/20 => Loss 0.132, Train_accy 94.58:  65%|██████▌   | 13/20 [01:10<00:35,  5.02s/it]
Task 3, Epoch 14/20 => Loss 0.085, Train_accy 97.92:  65%|██████▌   | 13/20 [01:13<00:35,  5.02s/it]
Task 3, Epoch 14/20 => Loss 0.085, Train_accy 97.92:  70%|███████   | 14/20 [01:13<00:26,  4.39s/it]
Task 3, Epoch 15/20 => Loss 0.082, Train_accy 97.08, Test_accy 91.15:  70%|███████   | 14/20 [01:32<00:26,  4.39s/it]
Task 3, Epoch 15/20 => Loss 0.082, Train_accy 97.08, Test_accy 91.15:  75%|███████▌  | 15/20 [01:32<00:44,  8.84s/it]
Task 3, Epoch 16/20 => Loss 0.068, Train_accy 97.08:  75%|███████▌  | 15/20 [01:35<00:44,  8.84s/it]                 
Task 3, Epoch 16/20 => Loss 0.068, Train_accy 97.08:  80%|████████  | 16/20 [01:35<00:28,  7.00s/it]
Task 3, Epoch 17/20 => Loss 0.060, Train_accy 97.92:  80%|████████  | 16/20 [01:38<00:28,  7.00s/it]
Task 3, Epoch 17/20 => Loss 0.060, Train_accy 97.92:  85%|████████▌ | 17/20 [01:38<00:17,  5.72s/it]
Task 3, Epoch 18/20 => Loss 0.037, Train_accy 99.58:  85%|████████▌ | 17/20 [01:41<00:17,  5.72s/it]
Task 3, Epoch 18/20 => Loss 0.037, Train_accy 99.58:  90%|█████████ | 18/20 [01:41<00:09,  4.83s/it]
Task 3, Epoch 19/20 => Loss 0.074, Train_accy 97.08:  90%|█████████ | 18/20 [01:43<00:09,  4.83s/it]
Task 3, Epoch 19/20 => Loss 0.074, Train_accy 97.08:  95%|█████████▌| 19/20 [01:43<00:04,  4.20s/it]
Task 3, Epoch 20/20 => Loss 0.099, Train_accy 95.83, Test_accy 91.50:  95%|█████████▌| 19/20 [02:02<00:04,  4.20s/it]
Task 3, Epoch 20/20 => Loss 0.099, Train_accy 95.83, Test_accy 91.50: 100%|██████████| 20/20 [02:02<00:00,  8.54s/it]
Task 3, Epoch 20/20 => Loss 0.099, Train_accy 95.83, Test_accy 91.50: 100%|██████████| 20/20 [02:02<00:00,  6.12s/it]2024-09-14 23:00:47,409 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.099, Train_accy 95.83, Test_accy 91.50

2024-09-14 23:01:04,207 [trainer.py] => No NME accuracy.
2024-09-14 23:01:04,208 [trainer.py] => CNN: {'total': 91.5, '00-04': 87.06, '05-09': 97.41, '10-14': 97.88, '15-19': 87.37, 'old': 95.55, 'new': 87.37}
2024-09-14 23:01:04,208 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38, 91.5]
2024-09-14 23:01:04,208 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1, 99.23]

Average Accuracy (CNN): 94.6
2024-09-14 23:01:04,209 [trainer.py] => Average Accuracy (CNN): 94.6 

2024-09-14 23:01:04,210 [trainer.py] => All params: 89677106
2024-09-14 23:01:04,212 [trainer.py] => Trainable params: 89677106
2024-09-14 23:01:05,274 [coda_prompt.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.178, Train_accy 55.00:   0%|          | 0/20 [00:02<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.178, Train_accy 55.00:   5%|▌         | 1/20 [00:02<00:54,  2.89s/it]
Task 4, Epoch 2/20 => Loss 0.434, Train_accy 84.17:   5%|▌         | 1/20 [00:05<00:54,  2.89s/it]
Task 4, Epoch 2/20 => Loss 0.434, Train_accy 84.17:  10%|█         | 2/20 [00:05<00:53,  2.98s/it]
Task 4, Epoch 3/20 => Loss 0.191, Train_accy 95.42:  10%|█         | 2/20 [00:08<00:53,  2.98s/it]
Task 4, Epoch 3/20 => Loss 0.191, Train_accy 95.42:  15%|█▌        | 3/20 [00:08<00:50,  2.98s/it]
Task 4, Epoch 4/20 => Loss 0.153, Train_accy 95.00:  15%|█▌        | 3/20 [00:11<00:50,  2.98s/it]
Task 4, Epoch 4/20 => Loss 0.153, Train_accy 95.00:  20%|██        | 4/20 [00:11<00:48,  3.00s/it]
Task 4, Epoch 5/20 => Loss 0.127, Train_accy 95.83, Test_accy 78.52:  20%|██        | 4/20 [00:38<00:48,  3.00s/it]
Task 4, Epoch 5/20 => Loss 0.127, Train_accy 95.83, Test_accy 78.52:  25%|██▌       | 5/20 [00:38<02:52, 11.51s/it]
Task 4, Epoch 6/20 => Loss 0.087, Train_accy 97.08:  25%|██▌       | 5/20 [00:41<02:52, 11.51s/it]                 
Task 4, Epoch 6/20 => Loss 0.087, Train_accy 97.08:  30%|███       | 6/20 [00:41<01:59,  8.55s/it]
Task 4, Epoch 7/20 => Loss 0.115, Train_accy 94.17:  30%|███       | 6/20 [00:44<01:59,  8.55s/it]
Task 4, Epoch 7/20 => Loss 0.115, Train_accy 94.17:  35%|███▌      | 7/20 [00:44<01:26,  6.68s/it]
Task 4, Epoch 8/20 => Loss 0.099, Train_accy 96.25:  35%|███▌      | 7/20 [00:47<01:26,  6.68s/it]
Task 4, Epoch 8/20 => Loss 0.099, Train_accy 96.25:  40%|████      | 8/20 [00:47<01:05,  5.46s/it]
Task 4, Epoch 9/20 => Loss 0.053, Train_accy 98.75:  40%|████      | 8/20 [00:49<01:05,  5.46s/it]
Task 4, Epoch 9/20 => Loss 0.053, Train_accy 98.75:  45%|████▌     | 9/20 [00:49<00:50,  4.62s/it]
Task 4, Epoch 10/20 => Loss 0.078, Train_accy 97.50, Test_accy 81.50:  45%|████▌     | 9/20 [01:15<00:50,  4.62s/it]
Task 4, Epoch 10/20 => Loss 0.078, Train_accy 97.50, Test_accy 81.50:  50%|█████     | 10/20 [01:15<01:52, 11.22s/it]
Task 4, Epoch 11/20 => Loss 0.049, Train_accy 99.17:  50%|█████     | 10/20 [01:18<01:52, 11.22s/it]                 
Task 4, Epoch 11/20 => Loss 0.049, Train_accy 99.17:  55%|█████▌    | 11/20 [01:18<01:18,  8.68s/it]
Task 4, Epoch 12/20 => Loss 0.076, Train_accy 97.50:  55%|█████▌    | 11/20 [01:21<01:18,  8.68s/it]
Task 4, Epoch 12/20 => Loss 0.076, Train_accy 97.50:  60%|██████    | 12/20 [01:21<00:55,  6.94s/it]
Task 4, Epoch 13/20 => Loss 0.045, Train_accy 98.75:  60%|██████    | 12/20 [01:24<00:55,  6.94s/it]
Task 4, Epoch 13/20 => Loss 0.045, Train_accy 98.75:  65%|██████▌   | 13/20 [01:24<00:40,  5.75s/it]
Task 4, Epoch 14/20 => Loss 0.060, Train_accy 97.92:  65%|██████▌   | 13/20 [01:27<00:40,  5.75s/it]
Task 4, Epoch 14/20 => Loss 0.060, Train_accy 97.92:  70%|███████   | 14/20 [01:27<00:29,  4.94s/it]
Task 4, Epoch 15/20 => Loss 0.052, Train_accy 98.33, Test_accy 81.25:  70%|███████   | 14/20 [01:54<00:29,  4.94s/it]
Task 4, Epoch 15/20 => Loss 0.052, Train_accy 98.33, Test_accy 81.25:  75%|███████▌  | 15/20 [01:54<00:57, 11.50s/it]
Task 4, Epoch 16/20 => Loss 0.099, Train_accy 96.67:  75%|███████▌  | 15/20 [01:57<00:57, 11.50s/it]                 
Task 4, Epoch 16/20 => Loss 0.099, Train_accy 96.67:  80%|████████  | 16/20 [01:57<00:35,  8.94s/it]
Task 4, Epoch 17/20 => Loss 0.057, Train_accy 98.75:  80%|████████  | 16/20 [02:00<00:35,  8.94s/it]
Task 4, Epoch 17/20 => Loss 0.057, Train_accy 98.75:  85%|████████▌ | 17/20 [02:00<00:21,  7.12s/it]
Task 4, Epoch 18/20 => Loss 0.041, Train_accy 98.75:  85%|████████▌ | 17/20 [02:03<00:21,  7.12s/it]
Task 4, Epoch 18/20 => Loss 0.041, Train_accy 98.75:  90%|█████████ | 18/20 [02:03<00:11,  5.86s/it]
Task 4, Epoch 19/20 => Loss 0.065, Train_accy 97.08:  90%|█████████ | 18/20 [02:06<00:11,  5.86s/it]
Task 4, Epoch 19/20 => Loss 0.065, Train_accy 97.08:  95%|█████████▌| 19/20 [02:06<00:04,  4.93s/it]
Task 4, Epoch 20/20 => Loss 0.063, Train_accy 97.08, Test_accy 81.28:  95%|█████████▌| 19/20 [02:31<00:04,  4.93s/it]
Task 4, Epoch 20/20 => Loss 0.063, Train_accy 97.08, Test_accy 81.28: 100%|██████████| 20/20 [02:31<00:00, 10.99s/it]
Task 4, Epoch 20/20 => Loss 0.063, Train_accy 97.08, Test_accy 81.28: 100%|██████████| 20/20 [02:31<00:00,  7.56s/it]2024-09-14 23:03:36,429 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.063, Train_accy 97.08, Test_accy 81.28

2024-09-14 23:04:00,066 [trainer.py] => No NME accuracy.
2024-09-14 23:04:00,067 [trainer.py] => CNN: {'total': 81.28, '00-04': 86.36, '05-09': 89.44, '10-14': 89.71, '15-19': 73.95, '20-24': 80.72, 'old': 81.52, 'new': 80.72}
2024-09-14 23:04:00,067 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38, 91.5, 81.28]
2024-09-14 23:04:00,067 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1, 99.23, 98.98]

Average Accuracy (CNN): 91.94
2024-09-14 23:04:00,067 [trainer.py] => Average Accuracy (CNN): 91.94 

2024-09-14 23:04:00,068 [trainer.py] => All params: 89677106
2024-09-14 23:04:00,068 [trainer.py] => Trainable params: 89677106
2024-09-14 23:04:01,434 [coda_prompt.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.757, Train_accy 12.50:   0%|          | 0/20 [00:01<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.757, Train_accy 12.50:   5%|▌         | 1/20 [00:01<00:27,  1.46s/it]
Task 5, Epoch 2/20 => Loss 1.472, Train_accy 40.62:   5%|▌         | 1/20 [00:03<00:27,  1.46s/it]
Task 5, Epoch 2/20 => Loss 1.472, Train_accy 40.62:  10%|█         | 2/20 [00:03<00:27,  1.51s/it]
Task 5, Epoch 3/20 => Loss 0.973, Train_accy 71.88:  10%|█         | 2/20 [00:04<00:27,  1.51s/it]
Task 5, Epoch 3/20 => Loss 0.973, Train_accy 71.88:  15%|█▌        | 3/20 [00:04<00:25,  1.47s/it]
Task 5, Epoch 4/20 => Loss 0.528, Train_accy 82.29:  15%|█▌        | 3/20 [00:05<00:25,  1.47s/it]
Task 5, Epoch 4/20 => Loss 0.528, Train_accy 82.29:  20%|██        | 4/20 [00:05<00:23,  1.46s/it]
Task 5, Epoch 5/20 => Loss 0.237, Train_accy 92.71, Test_accy 77.95:  20%|██        | 4/20 [00:33<00:23,  1.46s/it]
Task 5, Epoch 5/20 => Loss 0.237, Train_accy 92.71, Test_accy 77.95:  25%|██▌       | 5/20 [00:33<02:41, 10.78s/it]
Task 5, Epoch 6/20 => Loss 0.148, Train_accy 96.88:  25%|██▌       | 5/20 [00:34<02:41, 10.78s/it]                 
Task 5, Epoch 6/20 => Loss 0.148, Train_accy 96.88:  30%|███       | 6/20 [00:34<01:47,  7.66s/it]
Task 5, Epoch 7/20 => Loss 0.122, Train_accy 98.96:  30%|███       | 6/20 [00:36<01:47,  7.66s/it]
Task 5, Epoch 7/20 => Loss 0.122, Train_accy 98.96:  35%|███▌      | 7/20 [00:36<01:12,  5.60s/it]
Task 5, Epoch 8/20 => Loss 0.110, Train_accy 96.88:  35%|███▌      | 7/20 [00:37<01:12,  5.60s/it]
Task 5, Epoch 8/20 => Loss 0.110, Train_accy 96.88:  40%|████      | 8/20 [00:37<00:51,  4.31s/it]
Task 5, Epoch 9/20 => Loss 0.064, Train_accy 98.96:  40%|████      | 8/20 [00:39<00:51,  4.31s/it]
Task 5, Epoch 9/20 => Loss 0.064, Train_accy 98.96:  45%|████▌     | 9/20 [00:39<00:37,  3.39s/it]
Task 5, Epoch 10/20 => Loss 0.059, Train_accy 100.00, Test_accy 80.20:  45%|████▌     | 9/20 [01:04<00:37,  3.39s/it]
Task 5, Epoch 10/20 => Loss 0.059, Train_accy 100.00, Test_accy 80.20:  50%|█████     | 10/20 [01:04<01:42, 10.25s/it]
Task 5, Epoch 11/20 => Loss 0.068, Train_accy 98.96:  50%|█████     | 10/20 [01:06<01:42, 10.25s/it]                  
Task 5, Epoch 11/20 => Loss 0.068, Train_accy 98.96:  55%|█████▌    | 11/20 [01:06<01:08,  7.56s/it]
Task 5, Epoch 12/20 => Loss 0.033, Train_accy 100.00:  55%|█████▌    | 11/20 [01:07<01:08,  7.56s/it]
Task 5, Epoch 12/20 => Loss 0.033, Train_accy 100.00:  60%|██████    | 12/20 [01:07<00:45,  5.72s/it]
Task 5, Epoch 13/20 => Loss 0.048, Train_accy 97.92:  60%|██████    | 12/20 [01:09<00:45,  5.72s/it] 
Task 5, Epoch 13/20 => Loss 0.048, Train_accy 97.92:  65%|██████▌   | 13/20 [01:09<00:31,  4.44s/it]
Task 5, Epoch 14/20 => Loss 0.036, Train_accy 100.00:  65%|██████▌   | 13/20 [01:10<00:31,  4.44s/it]
Task 5, Epoch 14/20 => Loss 0.036, Train_accy 100.00:  70%|███████   | 14/20 [01:10<00:21,  3.57s/it]
Task 5, Epoch 15/20 => Loss 0.029, Train_accy 100.00, Test_accy 80.40:  70%|███████   | 14/20 [01:38<00:21,  3.57s/it]
Task 5, Epoch 15/20 => Loss 0.029, Train_accy 100.00, Test_accy 80.40:  75%|███████▌  | 15/20 [01:38<00:53, 10.78s/it]
Task 5, Epoch 16/20 => Loss 0.030, Train_accy 98.96:  75%|███████▌  | 15/20 [01:39<00:53, 10.78s/it]                  
Task 5, Epoch 16/20 => Loss 0.030, Train_accy 98.96:  80%|████████  | 16/20 [01:39<00:31,  7.97s/it]
Task 5, Epoch 17/20 => Loss 0.050, Train_accy 97.92:  80%|████████  | 16/20 [01:41<00:31,  7.97s/it]
Task 5, Epoch 17/20 => Loss 0.050, Train_accy 97.92:  85%|████████▌ | 17/20 [01:41<00:18,  6.02s/it]
Task 5, Epoch 18/20 => Loss 0.026, Train_accy 100.00:  85%|████████▌ | 17/20 [01:42<00:18,  6.02s/it]
Task 5, Epoch 18/20 => Loss 0.026, Train_accy 100.00:  90%|█████████ | 18/20 [01:42<00:09,  4.68s/it]
Task 5, Epoch 19/20 => Loss 0.020, Train_accy 100.00:  90%|█████████ | 18/20 [01:44<00:09,  4.68s/it]
Task 5, Epoch 19/20 => Loss 0.020, Train_accy 100.00:  95%|█████████▌| 19/20 [01:44<00:03,  3.73s/it]
Task 5, Epoch 20/20 => Loss 0.043, Train_accy 98.96, Test_accy 80.49:  95%|█████████▌| 19/20 [02:11<00:03,  3.73s/it]
Task 5, Epoch 20/20 => Loss 0.043, Train_accy 98.96, Test_accy 80.49: 100%|██████████| 20/20 [02:11<00:00, 10.85s/it]
Task 5, Epoch 20/20 => Loss 0.043, Train_accy 98.96, Test_accy 80.49: 100%|██████████| 20/20 [02:11<00:00,  6.58s/it]2024-09-14 23:06:13,086 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.043, Train_accy 98.96, Test_accy 80.49

2024-09-14 23:06:37,683 [trainer.py] => No NME accuracy.
2024-09-14 23:06:37,684 [trainer.py] => CNN: {'total': 80.49, '00-04': 75.17, '05-09': 87.78, '10-14': 89.71, '15-19': 72.68, '20-24': 80.24, '25-29': 89.15, 'old': 79.69, 'new': 89.15}
2024-09-14 23:06:37,685 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38, 91.5, 81.28, 80.49]
2024-09-14 23:06:37,685 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1, 99.23, 98.98, 98.19]

Average Accuracy (CNN): 90.03
2024-09-14 23:06:37,685 [trainer.py] => Average Accuracy (CNN): 90.03 

2024-09-14 23:06:37,687 [trainer.py] => All params: 89677106
2024-09-14 23:06:37,688 [trainer.py] => Trainable params: 89677106
2024-09-14 23:06:39,256 [coda_prompt.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.304, Train_accy 16.67:   0%|          | 0/20 [00:01<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.304, Train_accy 16.67:   5%|▌         | 1/20 [00:01<00:36,  1.90s/it]
Task 6, Epoch 2/20 => Loss 0.842, Train_accy 68.06:   5%|▌         | 1/20 [00:03<00:36,  1.90s/it]
Task 6, Epoch 2/20 => Loss 0.842, Train_accy 68.06:  10%|█         | 2/20 [00:03<00:33,  1.87s/it]
Task 6, Epoch 3/20 => Loss 0.325, Train_accy 93.06:  10%|█         | 2/20 [00:05<00:33,  1.87s/it]
Task 6, Epoch 3/20 => Loss 0.325, Train_accy 93.06:  15%|█▌        | 3/20 [00:05<00:32,  1.89s/it]
Task 6, Epoch 4/20 => Loss 0.148, Train_accy 97.22:  15%|█▌        | 3/20 [00:07<00:32,  1.89s/it]
Task 6, Epoch 4/20 => Loss 0.148, Train_accy 97.22:  20%|██        | 4/20 [00:07<00:30,  1.92s/it]
Task 6, Epoch 5/20 => Loss 0.077, Train_accy 98.61, Test_accy 75.26:  20%|██        | 4/20 [00:40<00:30,  1.92s/it]
Task 6, Epoch 5/20 => Loss 0.077, Train_accy 98.61, Test_accy 75.26:  25%|██▌       | 5/20 [00:40<03:14, 12.95s/it]
Task 6, Epoch 6/20 => Loss 0.036, Train_accy 100.00:  25%|██▌       | 5/20 [00:42<03:14, 12.95s/it]                
Task 6, Epoch 6/20 => Loss 0.036, Train_accy 100.00:  30%|███       | 6/20 [00:42<02:08,  9.19s/it]
Task 6, Epoch 7/20 => Loss 0.064, Train_accy 97.92:  30%|███       | 6/20 [00:43<02:08,  9.19s/it] 
Task 6, Epoch 7/20 => Loss 0.064, Train_accy 97.92:  35%|███▌      | 7/20 [00:43<01:28,  6.83s/it]
Task 6, Epoch 8/20 => Loss 0.036, Train_accy 99.31:  35%|███▌      | 7/20 [00:45<01:28,  6.83s/it]
Task 6, Epoch 8/20 => Loss 0.036, Train_accy 99.31:  40%|████      | 8/20 [00:45<01:03,  5.29s/it]
Task 6, Epoch 9/20 => Loss 0.021, Train_accy 100.00:  40%|████      | 8/20 [00:47<01:03,  5.29s/it]
Task 6, Epoch 9/20 => Loss 0.021, Train_accy 100.00:  45%|████▌     | 9/20 [00:47<00:46,  4.24s/it]
Task 6, Epoch 10/20 => Loss 0.037, Train_accy 99.31, Test_accy 79.08:  45%|████▌     | 9/20 [01:18<00:46,  4.24s/it]
Task 6, Epoch 10/20 => Loss 0.037, Train_accy 99.31, Test_accy 79.08:  50%|█████     | 10/20 [01:18<02:04, 12.47s/it]
Task 6, Epoch 11/20 => Loss 0.026, Train_accy 99.31:  50%|█████     | 10/20 [01:20<02:04, 12.47s/it]                 
Task 6, Epoch 11/20 => Loss 0.026, Train_accy 99.31:  55%|█████▌    | 11/20 [01:20<01:22,  9.21s/it]
Task 6, Epoch 12/20 => Loss 0.017, Train_accy 99.31:  55%|█████▌    | 11/20 [01:22<01:22,  9.21s/it]
Task 6, Epoch 12/20 => Loss 0.017, Train_accy 99.31:  60%|██████    | 12/20 [01:22<00:55,  6.97s/it]
Task 6, Epoch 13/20 => Loss 0.006, Train_accy 100.00:  60%|██████    | 12/20 [01:24<00:55,  6.97s/it]
Task 6, Epoch 13/20 => Loss 0.006, Train_accy 100.00:  65%|██████▌   | 13/20 [01:24<00:38,  5.43s/it]
Task 6, Epoch 14/20 => Loss 0.027, Train_accy 98.61:  65%|██████▌   | 13/20 [01:26<00:38,  5.43s/it] 
Task 6, Epoch 14/20 => Loss 0.027, Train_accy 98.61:  70%|███████   | 14/20 [01:26<00:26,  4.34s/it]
Task 6, Epoch 15/20 => Loss 0.005, Train_accy 100.00, Test_accy 79.21:  70%|███████   | 14/20 [01:58<00:26,  4.34s/it]
Task 6, Epoch 15/20 => Loss 0.005, Train_accy 100.00, Test_accy 79.21:  75%|███████▌  | 15/20 [01:58<01:03, 12.78s/it]
Task 6, Epoch 16/20 => Loss 0.006, Train_accy 100.00:  75%|███████▌  | 15/20 [02:00<01:03, 12.78s/it]                 
Task 6, Epoch 16/20 => Loss 0.006, Train_accy 100.00:  80%|████████  | 16/20 [02:00<00:38,  9.51s/it]
Task 6, Epoch 17/20 => Loss 0.006, Train_accy 100.00:  80%|████████  | 16/20 [02:02<00:38,  9.51s/it]
Task 6, Epoch 17/20 => Loss 0.006, Train_accy 100.00:  85%|████████▌ | 17/20 [02:02<00:21,  7.25s/it]
Task 6, Epoch 18/20 => Loss 0.015, Train_accy 99.31:  85%|████████▌ | 17/20 [02:04<00:21,  7.25s/it] 
Task 6, Epoch 18/20 => Loss 0.015, Train_accy 99.31:  90%|█████████ | 18/20 [02:04<00:11,  5.66s/it]
Task 6, Epoch 19/20 => Loss 0.007, Train_accy 100.00:  90%|█████████ | 18/20 [02:06<00:11,  5.66s/it]
Task 6, Epoch 19/20 => Loss 0.007, Train_accy 100.00:  95%|█████████▌| 19/20 [02:06<00:04,  4.53s/it]
Task 6, Epoch 20/20 => Loss 0.027, Train_accy 99.31, Test_accy 79.13:  95%|█████████▌| 19/20 [02:38<00:04,  4.53s/it]
Task 6, Epoch 20/20 => Loss 0.027, Train_accy 99.31, Test_accy 79.13: 100%|██████████| 20/20 [02:38<00:00, 12.78s/it]
Task 6, Epoch 20/20 => Loss 0.027, Train_accy 99.31, Test_accy 79.13: 100%|██████████| 20/20 [02:38<00:00,  7.92s/it]2024-09-14 23:09:17,577 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.027, Train_accy 99.31, Test_accy 79.13

2024-09-14 23:09:46,363 [trainer.py] => No NME accuracy.
2024-09-14 23:09:46,364 [trainer.py] => CNN: {'total': 79.13, '00-04': 71.33, '05-09': 87.41, '10-14': 83.82, '15-19': 71.04, '20-24': 77.69, '25-29': 84.39, '30-34': 86.68, 'old': 77.77, 'new': 86.68}
2024-09-14 23:09:46,364 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38, 91.5, 81.28, 80.49, 79.13]
2024-09-14 23:09:46,364 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1, 99.23, 98.98, 98.19, 97.79]

Average Accuracy (CNN): 88.47
2024-09-14 23:09:46,364 [trainer.py] => Average Accuracy (CNN): 88.47 

2024-09-14 23:09:46,366 [trainer.py] => All params: 89677106
2024-09-14 23:09:46,368 [trainer.py] => Trainable params: 89677106
2024-09-14 23:09:48,152 [coda_prompt.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.718, Train_accy 32.29:   0%|          | 0/20 [00:01<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.718, Train_accy 32.29:   5%|▌         | 1/20 [00:01<00:27,  1.47s/it]
Task 7, Epoch 2/20 => Loss 0.893, Train_accy 66.67:   5%|▌         | 1/20 [00:03<00:27,  1.47s/it]
Task 7, Epoch 2/20 => Loss 0.893, Train_accy 66.67:  10%|█         | 2/20 [00:03<00:27,  1.51s/it]
Task 7, Epoch 3/20 => Loss 0.556, Train_accy 82.29:  10%|█         | 2/20 [00:04<00:27,  1.51s/it]
Task 7, Epoch 3/20 => Loss 0.556, Train_accy 82.29:  15%|█▌        | 3/20 [00:04<00:25,  1.50s/it]
Task 7, Epoch 4/20 => Loss 0.242, Train_accy 94.79:  15%|█▌        | 3/20 [00:05<00:25,  1.50s/it]
Task 7, Epoch 4/20 => Loss 0.242, Train_accy 94.79:  20%|██        | 4/20 [00:05<00:23,  1.49s/it]
Task 7, Epoch 5/20 => Loss 0.225, Train_accy 93.75, Test_accy 76.46:  20%|██        | 4/20 [00:40<00:23,  1.49s/it]
Task 7, Epoch 5/20 => Loss 0.225, Train_accy 93.75, Test_accy 76.46:  25%|██▌       | 5/20 [00:40<03:21, 13.45s/it]
Task 7, Epoch 6/20 => Loss 0.175, Train_accy 94.79:  25%|██▌       | 5/20 [00:42<03:21, 13.45s/it]                 
Task 7, Epoch 6/20 => Loss 0.175, Train_accy 94.79:  30%|███       | 6/20 [00:42<02:11,  9.38s/it]
Task 7, Epoch 7/20 => Loss 0.154, Train_accy 95.83:  30%|███       | 6/20 [00:43<02:11,  9.38s/it]
Task 7, Epoch 7/20 => Loss 0.154, Train_accy 95.83:  35%|███▌      | 7/20 [00:43<01:28,  6.81s/it]
Task 7, Epoch 8/20 => Loss 0.107, Train_accy 97.92:  35%|███▌      | 7/20 [00:45<01:28,  6.81s/it]
Task 7, Epoch 8/20 => Loss 0.107, Train_accy 97.92:  40%|████      | 8/20 [00:45<01:01,  5.11s/it]
Task 7, Epoch 9/20 => Loss 0.084, Train_accy 96.88:  40%|████      | 8/20 [00:46<01:01,  5.11s/it]
Task 7, Epoch 9/20 => Loss 0.084, Train_accy 96.88:  45%|████▌     | 9/20 [00:46<00:43,  3.97s/it]
Task 7, Epoch 10/20 => Loss 0.099, Train_accy 95.83, Test_accy 75.64:  45%|████▌     | 9/20 [01:19<00:43,  3.97s/it]
Task 7, Epoch 10/20 => Loss 0.099, Train_accy 95.83, Test_accy 75.64:  50%|█████     | 10/20 [01:19<02:07, 12.77s/it]
Task 7, Epoch 11/20 => Loss 0.058, Train_accy 98.96:  50%|█████     | 10/20 [01:20<02:07, 12.77s/it]                 
Task 7, Epoch 11/20 => Loss 0.058, Train_accy 98.96:  55%|█████▌    | 11/20 [01:20<01:24,  9.33s/it]
Task 7, Epoch 12/20 => Loss 0.045, Train_accy 98.96:  55%|█████▌    | 11/20 [01:22<01:24,  9.33s/it]
Task 7, Epoch 12/20 => Loss 0.045, Train_accy 98.96:  60%|██████    | 12/20 [01:22<00:55,  6.97s/it]
Task 7, Epoch 13/20 => Loss 0.061, Train_accy 98.96:  60%|██████    | 12/20 [01:23<00:55,  6.97s/it]
Task 7, Epoch 13/20 => Loss 0.061, Train_accy 98.96:  65%|██████▌   | 13/20 [01:23<00:37,  5.32s/it]
Task 7, Epoch 14/20 => Loss 0.074, Train_accy 97.92:  65%|██████▌   | 13/20 [01:25<00:37,  5.32s/it]
Task 7, Epoch 14/20 => Loss 0.074, Train_accy 97.92:  70%|███████   | 14/20 [01:25<00:24,  4.16s/it]
Task 7, Epoch 15/20 => Loss 0.062, Train_accy 98.96, Test_accy 75.03:  70%|███████   | 14/20 [01:59<00:24,  4.16s/it]
Task 7, Epoch 15/20 => Loss 0.062, Train_accy 98.96, Test_accy 75.03:  75%|███████▌  | 15/20 [01:59<01:06, 13.31s/it]
Task 7, Epoch 16/20 => Loss 0.036, Train_accy 98.96:  75%|███████▌  | 15/20 [02:01<01:06, 13.31s/it]                 
Task 7, Epoch 16/20 => Loss 0.036, Train_accy 98.96:  80%|████████  | 16/20 [02:01<00:39,  9.77s/it]
Task 7, Epoch 17/20 => Loss 0.015, Train_accy 100.00:  80%|████████  | 16/20 [02:02<00:39,  9.77s/it]
Task 7, Epoch 17/20 => Loss 0.015, Train_accy 100.00:  85%|████████▌ | 17/20 [02:02<00:21,  7.28s/it]
Task 7, Epoch 18/20 => Loss 0.013, Train_accy 100.00:  85%|████████▌ | 17/20 [02:04<00:21,  7.28s/it]
Task 7, Epoch 18/20 => Loss 0.013, Train_accy 100.00:  90%|█████████ | 18/20 [02:04<00:11,  5.54s/it]
Task 7, Epoch 19/20 => Loss 0.056, Train_accy 97.92:  90%|█████████ | 18/20 [02:05<00:11,  5.54s/it] 
Task 7, Epoch 19/20 => Loss 0.056, Train_accy 97.92:  95%|█████████▌| 19/20 [02:05<00:04,  4.32s/it]
Task 7, Epoch 20/20 => Loss 0.028, Train_accy 100.00, Test_accy 74.82:  95%|█████████▌| 19/20 [02:39<00:04,  4.32s/it]
Task 7, Epoch 20/20 => Loss 0.028, Train_accy 100.00, Test_accy 74.82: 100%|██████████| 20/20 [02:39<00:00, 13.05s/it]
Task 7, Epoch 20/20 => Loss 0.028, Train_accy 100.00, Test_accy 74.82: 100%|██████████| 20/20 [02:39<00:00,  7.95s/it]2024-09-14 23:12:27,200 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.028, Train_accy 100.00, Test_accy 74.82

2024-09-14 23:12:58,631 [trainer.py] => No NME accuracy.
2024-09-14 23:12:58,632 [trainer.py] => CNN: {'total': 74.82, '00-04': 70.63, '05-09': 78.15, '10-14': 83.33, '15-19': 62.88, '20-24': 69.48, '25-29': 81.75, '30-34': 86.81, '35-39': 87.02, 'old': 73.8, 'new': 87.02}
2024-09-14 23:12:58,632 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38, 91.5, 81.28, 80.49, 79.13, 74.82]
2024-09-14 23:12:58,632 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1, 99.23, 98.98, 98.19, 97.79, 96.61]

Average Accuracy (CNN): 86.77
2024-09-14 23:12:58,632 [trainer.py] => Average Accuracy (CNN): 86.77 

2024-09-14 23:12:58,633 [trainer.py] => All params: 89677106
2024-09-14 23:12:58,634 [trainer.py] => Trainable params: 89677106
2024-09-14 23:13:00,852 [coda_prompt.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.942, Train_accy 63.19:   0%|          | 0/20 [00:03<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.942, Train_accy 63.19:   5%|▌         | 1/20 [00:03<01:06,  3.48s/it]
Task 8, Epoch 2/20 => Loss 0.211, Train_accy 94.44:   5%|▌         | 1/20 [00:06<01:06,  3.48s/it]
Task 8, Epoch 2/20 => Loss 0.211, Train_accy 94.44:  10%|█         | 2/20 [00:06<01:02,  3.49s/it]
Task 8, Epoch 3/20 => Loss 0.110, Train_accy 96.88:  10%|█         | 2/20 [00:10<01:02,  3.49s/it]
Task 8, Epoch 3/20 => Loss 0.110, Train_accy 96.88:  15%|█▌        | 3/20 [00:10<00:58,  3.46s/it]
Task 8, Epoch 4/20 => Loss 0.079, Train_accy 97.57:  15%|█▌        | 3/20 [00:13<00:58,  3.46s/it]
Task 8, Epoch 4/20 => Loss 0.079, Train_accy 97.57:  20%|██        | 4/20 [00:13<00:55,  3.48s/it]
Task 8, Epoch 5/20 => Loss 0.051, Train_accy 97.22, Test_accy 71.41:  20%|██        | 4/20 [00:57<00:55,  3.48s/it]
Task 8, Epoch 5/20 => Loss 0.051, Train_accy 97.22, Test_accy 71.41:  25%|██▌       | 5/20 [00:57<04:30, 18.05s/it]
Task 8, Epoch 6/20 => Loss 0.057, Train_accy 98.26:  25%|██▌       | 5/20 [01:01<04:30, 18.05s/it]                 
Task 8, Epoch 6/20 => Loss 0.057, Train_accy 98.26:  30%|███       | 6/20 [01:01<03:02, 13.02s/it]
Task 8, Epoch 7/20 => Loss 0.037, Train_accy 99.31:  30%|███       | 6/20 [01:04<03:02, 13.02s/it]
Task 8, Epoch 7/20 => Loss 0.037, Train_accy 99.31:  35%|███▌      | 7/20 [01:04<02:07,  9.83s/it]
Task 8, Epoch 8/20 => Loss 0.033, Train_accy 98.61:  35%|███▌      | 7/20 [01:07<02:07,  9.83s/it]
Task 8, Epoch 8/20 => Loss 0.033, Train_accy 98.61:  40%|████      | 8/20 [01:07<01:33,  7.76s/it]
Task 8, Epoch 9/20 => Loss 0.027, Train_accy 99.31:  40%|████      | 8/20 [01:11<01:33,  7.76s/it]
Task 8, Epoch 9/20 => Loss 0.027, Train_accy 99.31:  45%|████▌     | 9/20 [01:11<01:10,  6.44s/it]
Task 8, Epoch 10/20 => Loss 0.021, Train_accy 99.65, Test_accy 72.17:  45%|████▌     | 9/20 [01:56<01:10,  6.44s/it]
Task 8, Epoch 10/20 => Loss 0.021, Train_accy 99.65, Test_accy 72.17:  50%|█████     | 10/20 [01:56<03:03, 18.36s/it]
Task 8, Epoch 11/20 => Loss 0.068, Train_accy 98.61:  50%|█████     | 10/20 [01:59<03:03, 18.36s/it]                 
Task 8, Epoch 11/20 => Loss 0.068, Train_accy 98.61:  55%|█████▌    | 11/20 [01:59<02:04, 13.80s/it]
Task 8, Epoch 12/20 => Loss 0.038, Train_accy 99.65:  55%|█████▌    | 11/20 [02:03<02:04, 13.80s/it]
Task 8, Epoch 12/20 => Loss 0.038, Train_accy 99.65:  60%|██████    | 12/20 [02:03<01:25, 10.68s/it]
Task 8, Epoch 13/20 => Loss 0.025, Train_accy 99.31:  60%|██████    | 12/20 [02:06<01:25, 10.68s/it]
Task 8, Epoch 13/20 => Loss 0.025, Train_accy 99.31:  65%|██████▌   | 13/20 [02:06<00:59,  8.51s/it]
Task 8, Epoch 14/20 => Loss 0.022, Train_accy 99.65:  65%|██████▌   | 13/20 [02:10<00:59,  8.51s/it]
Task 8, Epoch 14/20 => Loss 0.022, Train_accy 99.65:  70%|███████   | 14/20 [02:10<00:42,  7.02s/it]
Task 8, Epoch 15/20 => Loss 0.028, Train_accy 99.31, Test_accy 72.17:  70%|███████   | 14/20 [02:53<00:42,  7.02s/it]
Task 8, Epoch 15/20 => Loss 0.028, Train_accy 99.31, Test_accy 72.17:  75%|███████▌  | 15/20 [02:53<01:29, 17.87s/it]
Task 8, Epoch 16/20 => Loss 0.015, Train_accy 99.65:  75%|███████▌  | 15/20 [02:56<01:29, 17.87s/it]                 
Task 8, Epoch 16/20 => Loss 0.015, Train_accy 99.65:  80%|████████  | 16/20 [02:56<00:54, 13.56s/it]
Task 8, Epoch 17/20 => Loss 0.011, Train_accy 99.65:  80%|████████  | 16/20 [03:00<00:54, 13.56s/it]
Task 8, Epoch 17/20 => Loss 0.011, Train_accy 99.65:  85%|████████▌ | 17/20 [03:00<00:31, 10.52s/it]
Task 8, Epoch 18/20 => Loss 0.032, Train_accy 98.96:  85%|████████▌ | 17/20 [03:03<00:31, 10.52s/it]
Task 8, Epoch 18/20 => Loss 0.032, Train_accy 98.96:  90%|█████████ | 18/20 [03:03<00:16,  8.39s/it]
Task 8, Epoch 19/20 => Loss 0.010, Train_accy 100.00:  90%|█████████ | 18/20 [03:07<00:16,  8.39s/it]
Task 8, Epoch 19/20 => Loss 0.010, Train_accy 100.00:  95%|█████████▌| 19/20 [03:07<00:06,  6.90s/it]
Task 8, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 72.42:  95%|█████████▌| 19/20 [03:50<00:06,  6.90s/it]
Task 8, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 72.42: 100%|██████████| 20/20 [03:50<00:00, 17.94s/it]
Task 8, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 72.42: 100%|██████████| 20/20 [03:50<00:00, 11.54s/it]2024-09-14 23:16:51,743 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.012, Train_accy 100.00, Test_accy 72.42

2024-09-14 23:17:32,352 [trainer.py] => No NME accuracy.
2024-09-14 23:17:32,353 [trainer.py] => CNN: {'total': 72.42, '00-04': 70.28, '05-09': 77.04, '10-14': 80.88, '15-19': 59.83, '20-24': 67.49, '25-29': 81.22, '30-34': 88.9, '35-39': 83.83, '40-44': 69.23, 'old': 73.26, 'new': 69.23}
2024-09-14 23:17:32,353 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38, 91.5, 81.28, 80.49, 79.13, 74.82, 72.42]
2024-09-14 23:17:32,353 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1, 99.23, 98.98, 98.19, 97.79, 96.61, 96.04]

Average Accuracy (CNN): 85.17
2024-09-14 23:17:32,354 [trainer.py] => Average Accuracy (CNN): 85.17 

2024-09-14 23:17:32,355 [trainer.py] => All params: 89677106
2024-09-14 23:17:32,357 [trainer.py] => Trainable params: 89677106
2024-09-14 23:17:34,699 [coda_prompt.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.430, Train_accy 57.92:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.430, Train_accy 57.92:   5%|▌         | 1/20 [00:02<00:55,  2.91s/it]
Task 9, Epoch 2/20 => Loss 0.306, Train_accy 89.17:   5%|▌         | 1/20 [00:05<00:55,  2.91s/it]
Task 9, Epoch 2/20 => Loss 0.306, Train_accy 89.17:  10%|█         | 2/20 [00:05<00:53,  2.95s/it]
Task 9, Epoch 3/20 => Loss 0.105, Train_accy 97.92:  10%|█         | 2/20 [00:08<00:53,  2.95s/it]
Task 9, Epoch 3/20 => Loss 0.105, Train_accy 97.92:  15%|█▌        | 3/20 [00:08<00:50,  2.95s/it]
Task 9, Epoch 4/20 => Loss 0.070, Train_accy 97.50:  15%|█▌        | 3/20 [00:11<00:50,  2.95s/it]
Task 9, Epoch 4/20 => Loss 0.070, Train_accy 97.50:  20%|██        | 4/20 [00:11<00:47,  2.98s/it]
Task 9, Epoch 5/20 => Loss 0.064, Train_accy 97.50, Test_accy 67.58:  20%|██        | 4/20 [01:02<00:47,  2.98s/it]
Task 9, Epoch 5/20 => Loss 0.064, Train_accy 97.50, Test_accy 67.58:  25%|██▌       | 5/20 [01:02<05:02, 20.14s/it]
Task 9, Epoch 6/20 => Loss 0.063, Train_accy 98.33:  25%|██▌       | 5/20 [01:05<05:02, 20.14s/it]                 
Task 9, Epoch 6/20 => Loss 0.063, Train_accy 98.33:  30%|███       | 6/20 [01:05<03:19, 14.23s/it]
Task 9, Epoch 7/20 => Loss 0.042, Train_accy 99.17:  30%|███       | 6/20 [01:07<03:19, 14.23s/it]
Task 9, Epoch 7/20 => Loss 0.042, Train_accy 99.17:  35%|███▌      | 7/20 [01:07<02:16, 10.48s/it]
Task 9, Epoch 8/20 => Loss 0.068, Train_accy 98.33:  35%|███▌      | 7/20 [01:10<02:16, 10.48s/it]
Task 9, Epoch 8/20 => Loss 0.068, Train_accy 98.33:  40%|████      | 8/20 [01:10<01:36,  8.03s/it]
Task 9, Epoch 9/20 => Loss 0.068, Train_accy 97.50:  40%|████      | 8/20 [01:13<01:36,  8.03s/it]
Task 9, Epoch 9/20 => Loss 0.068, Train_accy 97.50:  45%|████▌     | 9/20 [01:13<01:10,  6.42s/it]
Task 9, Epoch 10/20 => Loss 0.034, Train_accy 99.58, Test_accy 67.37:  45%|████▌     | 9/20 [02:05<01:10,  6.42s/it]
Task 9, Epoch 10/20 => Loss 0.034, Train_accy 99.58, Test_accy 67.37:  50%|█████     | 10/20 [02:05<03:25, 20.51s/it]
Task 9, Epoch 11/20 => Loss 0.020, Train_accy 99.17:  50%|█████     | 10/20 [02:08<03:25, 20.51s/it]                 
Task 9, Epoch 11/20 => Loss 0.020, Train_accy 99.17:  55%|█████▌    | 11/20 [02:08<02:15, 15.09s/it]
Task 9, Epoch 12/20 => Loss 0.040, Train_accy 98.75:  55%|█████▌    | 11/20 [02:11<02:15, 15.09s/it]
Task 9, Epoch 12/20 => Loss 0.040, Train_accy 98.75:  60%|██████    | 12/20 [02:11<01:30, 11.35s/it]
Task 9, Epoch 13/20 => Loss 0.045, Train_accy 98.75:  60%|██████    | 12/20 [02:14<01:30, 11.35s/it]
Task 9, Epoch 13/20 => Loss 0.045, Train_accy 98.75:  65%|██████▌   | 13/20 [02:14<01:01,  8.74s/it]
Task 9, Epoch 14/20 => Loss 0.061, Train_accy 97.92:  65%|██████▌   | 13/20 [02:16<01:01,  8.74s/it]
Task 9, Epoch 14/20 => Loss 0.061, Train_accy 97.92:  70%|███████   | 14/20 [02:16<00:41,  6.94s/it]
Task 9, Epoch 15/20 => Loss 0.024, Train_accy 99.58, Test_accy 67.25:  70%|███████   | 14/20 [03:08<00:41,  6.94s/it]
Task 9, Epoch 15/20 => Loss 0.024, Train_accy 99.58, Test_accy 67.25:  75%|███████▌  | 15/20 [03:08<01:41, 20.33s/it]
Task 9, Epoch 16/20 => Loss 0.036, Train_accy 98.75:  75%|███████▌  | 15/20 [03:11<01:41, 20.33s/it]                 
Task 9, Epoch 16/20 => Loss 0.036, Train_accy 98.75:  80%|████████  | 16/20 [03:11<01:00, 15.10s/it]
Task 9, Epoch 17/20 => Loss 0.035, Train_accy 97.92:  80%|████████  | 16/20 [03:14<01:00, 15.10s/it]
Task 9, Epoch 17/20 => Loss 0.035, Train_accy 97.92:  85%|████████▌ | 17/20 [03:14<00:34, 11.47s/it]
Task 9, Epoch 18/20 => Loss 0.034, Train_accy 99.17:  85%|████████▌ | 17/20 [03:17<00:34, 11.47s/it]
Task 9, Epoch 18/20 => Loss 0.034, Train_accy 99.17:  90%|█████████ | 18/20 [03:17<00:17,  8.92s/it]
Task 9, Epoch 19/20 => Loss 0.048, Train_accy 97.92:  90%|█████████ | 18/20 [03:20<00:17,  8.92s/it]
Task 9, Epoch 19/20 => Loss 0.048, Train_accy 97.92:  95%|█████████▌| 19/20 [03:20<00:07,  7.14s/it]
Task 9, Epoch 20/20 => Loss 0.015, Train_accy 100.00, Test_accy 67.07:  95%|█████████▌| 19/20 [04:10<00:07,  7.14s/it]
Task 9, Epoch 20/20 => Loss 0.015, Train_accy 100.00, Test_accy 67.07: 100%|██████████| 20/20 [04:10<00:00, 20.18s/it]
Task 9, Epoch 20/20 => Loss 0.015, Train_accy 100.00, Test_accy 67.07: 100%|██████████| 20/20 [04:10<00:00, 12.53s/it]2024-09-14 23:21:45,390 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.015, Train_accy 100.00, Test_accy 67.07

2024-09-14 23:22:34,845 [trainer.py] => No NME accuracy.
2024-09-14 23:22:34,845 [trainer.py] => CNN: {'total': 67.07, '00-04': 69.23, '05-09': 64.07, '10-14': 65.85, '15-19': 53.02, '20-24': 61.12, '25-29': 79.89, '30-34': 83.85, '35-39': 77.22, '40-44': 68.7, '45-49': 69.74, 'old': 66.57, 'new': 69.74}
2024-09-14 23:22:34,845 [trainer.py] => CNN top1 curve: [94.41, 96.13, 96.38, 91.5, 81.28, 80.49, 79.13, 74.82, 72.42, 67.07]
2024-09-14 23:22:34,846 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.1, 99.23, 98.98, 98.19, 97.79, 96.61, 96.04, 95.01]

Average Accuracy (CNN): 83.36
2024-09-14 23:22:34,846 [trainer.py] => Average Accuracy (CNN): 83.36 

Accuracy Matrix (CNN):
[[94.41 90.21 87.06 87.06 86.36 75.17 71.33 70.63 70.28 69.23]
 [ 0.   99.26 97.59 97.41 89.44 87.78 87.41 78.15 77.04 64.07]
 [ 0.    0.   99.67 97.88 89.71 89.71 83.82 83.33 80.88 65.85]
 [ 0.    0.    0.   87.37 73.95 72.68 71.04 62.88 59.83 53.02]
 [ 0.    0.    0.    0.   80.72 80.24 77.69 69.48 67.49 61.12]
 [ 0.    0.    0.    0.    0.   89.15 84.39 81.75 81.22 79.89]
 [ 0.    0.    0.    0.    0.    0.   86.68 86.81 88.9  83.85]
 [ 0.    0.    0.    0.    0.    0.    0.   87.02 83.83 77.22]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   69.23 68.7 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   69.74]]
2024-09-14 23:22:34,847 [trainer.py] => Forgetting (CNN): 19.19777777777778
2024-09-14 23:22:37,108 [trainer.py] => config: ./exps/ease_vtab_B0_Inc5.json
2024-09-14 23:22:37,108 [trainer.py] => prefix:  
2024-09-14 23:22:37,108 [trainer.py] => dataset: vtab
2024-09-14 23:22:37,108 [trainer.py] => memory_size: 0
2024-09-14 23:22:37,108 [trainer.py] => memory_per_class: 0
2024-09-14 23:22:37,108 [trainer.py] => fixed_memory: False
2024-09-14 23:22:37,108 [trainer.py] => shuffle: True
2024-09-14 23:22:37,108 [trainer.py] => init_cls: 10
2024-09-14 23:22:37,108 [trainer.py] => increment: 10
2024-09-14 23:22:37,109 [trainer.py] => model_name: ease
2024-09-14 23:22:37,109 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-14 23:22:37,109 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 23:22:37,109 [trainer.py] => seed: 1993
2024-09-14 23:22:37,109 [trainer.py] => init_epochs: 20
2024-09-14 23:22:37,109 [trainer.py] => init_lr: 0.05
2024-09-14 23:22:37,109 [trainer.py] => later_epochs: 20
2024-09-14 23:22:37,109 [trainer.py] => later_lr: 0.05
2024-09-14 23:22:37,109 [trainer.py] => batch_size: 48
2024-09-14 23:22:37,109 [trainer.py] => weight_decay: 0.005
2024-09-14 23:22:37,109 [trainer.py] => min_lr: 0
2024-09-14 23:22:37,109 [trainer.py] => optimizer: sgd
2024-09-14 23:22:37,109 [trainer.py] => scheduler: cosine
2024-09-14 23:22:37,109 [trainer.py] => pretrained: True
2024-09-14 23:22:37,109 [trainer.py] => vpt_type: Deep
2024-09-14 23:22:37,109 [trainer.py] => prompt_token_num: 5
2024-09-14 23:22:37,109 [trainer.py] => ffn_num: 16
2024-09-14 23:22:37,109 [trainer.py] => use_diagonal: False
2024-09-14 23:22:37,110 [trainer.py] => recalc_sim: True
2024-09-14 23:22:37,110 [trainer.py] => alpha: 0.1
2024-09-14 23:22:37,110 [trainer.py] => use_init_ptm: False
2024-09-14 23:22:37,110 [trainer.py] => beta: 0
2024-09-14 23:22:37,110 [trainer.py] => use_old_data: False
2024-09-14 23:22:37,110 [trainer.py] => use_reweight: True
2024-09-14 23:22:37,110 [trainer.py] => moni_adam: False
2024-09-14 23:22:37,110 [trainer.py] => adapter_num: -1
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 23:22:37,157 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-14 23:22:40,572 [trainer.py] => All params: 86102976
2024-09-14 23:22:40,573 [trainer.py] => Trainable params: 304320
2024-09-14 23:22:40,579 [ease.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.278, Train_accy 26.71:   0%|          | 0/20 [00:01<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.278, Train_accy 26.71:   5%|▌         | 1/20 [00:01<00:31,  1.68s/it]
Task 0, Epoch 2/20 => Loss 2.200, Train_accy 76.40:   5%|▌         | 1/20 [00:02<00:31,  1.68s/it]
Task 0, Epoch 2/20 => Loss 2.200, Train_accy 76.40:  10%|█         | 2/20 [00:02<00:26,  1.45s/it]
Task 0, Epoch 3/20 => Loss 2.064, Train_accy 93.17:  10%|█         | 2/20 [00:04<00:26,  1.45s/it]
Task 0, Epoch 3/20 => Loss 2.064, Train_accy 93.17:  15%|█▌        | 3/20 [00:04<00:23,  1.36s/it]
Task 0, Epoch 4/20 => Loss 1.901, Train_accy 95.65:  15%|█▌        | 3/20 [00:05<00:23,  1.36s/it]
Task 0, Epoch 4/20 => Loss 1.901, Train_accy 95.65:  20%|██        | 4/20 [00:05<00:21,  1.33s/it]
Task 0, Epoch 5/20 => Loss 1.674, Train_accy 96.27:  20%|██        | 4/20 [00:06<00:21,  1.33s/it]
Task 0, Epoch 5/20 => Loss 1.674, Train_accy 96.27:  25%|██▌       | 5/20 [00:06<00:19,  1.32s/it]
Task 0, Epoch 6/20 => Loss 1.423, Train_accy 97.52:  25%|██▌       | 5/20 [00:08<00:19,  1.32s/it]
Task 0, Epoch 6/20 => Loss 1.423, Train_accy 97.52:  30%|███       | 6/20 [00:08<00:18,  1.30s/it]
Task 0, Epoch 7/20 => Loss 1.194, Train_accy 96.27:  30%|███       | 6/20 [00:09<00:18,  1.30s/it]
Task 0, Epoch 7/20 => Loss 1.194, Train_accy 96.27:  35%|███▌      | 7/20 [00:09<00:17,  1.31s/it]
Task 0, Epoch 8/20 => Loss 0.968, Train_accy 98.76:  35%|███▌      | 7/20 [00:10<00:17,  1.31s/it]
Task 0, Epoch 8/20 => Loss 0.968, Train_accy 98.76:  40%|████      | 8/20 [00:10<00:15,  1.30s/it]
Task 0, Epoch 9/20 => Loss 0.810, Train_accy 99.38:  40%|████      | 8/20 [00:12<00:15,  1.30s/it]
Task 0, Epoch 9/20 => Loss 0.810, Train_accy 99.38:  45%|████▌     | 9/20 [00:12<00:14,  1.33s/it]
Task 0, Epoch 10/20 => Loss 0.692, Train_accy 97.52:  45%|████▌     | 9/20 [00:13<00:14,  1.33s/it]
Task 0, Epoch 10/20 => Loss 0.692, Train_accy 97.52:  50%|█████     | 10/20 [00:13<00:13,  1.33s/it]
Task 0, Epoch 11/20 => Loss 0.581, Train_accy 96.89:  50%|█████     | 10/20 [00:14<00:13,  1.33s/it]
Task 0, Epoch 11/20 => Loss 0.581, Train_accy 96.89:  55%|█████▌    | 11/20 [00:14<00:11,  1.32s/it]
Task 0, Epoch 12/20 => Loss 0.570, Train_accy 98.14:  55%|█████▌    | 11/20 [00:15<00:11,  1.32s/it]
Task 0, Epoch 12/20 => Loss 0.570, Train_accy 98.14:  60%|██████    | 12/20 [00:15<00:10,  1.31s/it]
Task 0, Epoch 13/20 => Loss 0.513, Train_accy 97.52:  60%|██████    | 12/20 [00:17<00:10,  1.31s/it]
Task 0, Epoch 13/20 => Loss 0.513, Train_accy 97.52:  65%|██████▌   | 13/20 [00:17<00:09,  1.34s/it]
Task 0, Epoch 14/20 => Loss 0.501, Train_accy 97.52:  65%|██████▌   | 13/20 [00:18<00:09,  1.34s/it]
Task 0, Epoch 14/20 => Loss 0.501, Train_accy 97.52:  70%|███████   | 14/20 [00:18<00:07,  1.33s/it]
Task 0, Epoch 15/20 => Loss 0.506, Train_accy 96.89:  70%|███████   | 14/20 [00:20<00:07,  1.33s/it]
Task 0, Epoch 15/20 => Loss 0.506, Train_accy 96.89:  75%|███████▌  | 15/20 [00:20<00:06,  1.34s/it]
Task 0, Epoch 16/20 => Loss 0.470, Train_accy 98.14:  75%|███████▌  | 15/20 [00:21<00:06,  1.34s/it]
Task 0, Epoch 16/20 => Loss 0.470, Train_accy 98.14:  80%|████████  | 16/20 [00:21<00:05,  1.33s/it]
Task 0, Epoch 17/20 => Loss 0.462, Train_accy 97.52:  80%|████████  | 16/20 [00:22<00:05,  1.33s/it]
Task 0, Epoch 17/20 => Loss 0.462, Train_accy 97.52:  85%|████████▌ | 17/20 [00:22<00:04,  1.35s/it]
Task 0, Epoch 18/20 => Loss 0.436, Train_accy 97.52:  85%|████████▌ | 17/20 [00:24<00:04,  1.35s/it]
Task 0, Epoch 18/20 => Loss 0.436, Train_accy 97.52:  90%|█████████ | 18/20 [00:24<00:02,  1.33s/it]
Task 0, Epoch 19/20 => Loss 0.444, Train_accy 96.89:  90%|█████████ | 18/20 [00:25<00:02,  1.33s/it]
Task 0, Epoch 19/20 => Loss 0.444, Train_accy 96.89:  95%|█████████▌| 19/20 [00:25<00:01,  1.33s/it]
Task 0, Epoch 20/20 => Loss 0.434, Train_accy 98.14:  95%|█████████▌| 19/20 [00:26<00:01,  1.33s/it]
Task 0, Epoch 20/20 => Loss 0.434, Train_accy 98.14: 100%|██████████| 20/20 [00:26<00:00,  1.36s/it]
Task 0, Epoch 20/20 => Loss 0.434, Train_accy 98.14: 100%|██████████| 20/20 [00:26<00:00,  1.34s/it]2024-09-14 23:23:07,516 [ease.py] => Task 0, Epoch 20/20 => Loss 0.434, Train_accy 98.14

2024-09-14 23:23:12,125 [ease.py] => Task correct: 100.0
2024-09-14 23:23:12,126 [ease.py] => Task acc: 98.6682808716707
2024-09-14 23:23:12,153 [trainer.py] => No NME accuracy.
2024-09-14 23:23:12,154 [trainer.py] => CNN: {'total': 98.67, '00-09': 98.67, 'old': 0, 'new': 98.67}
2024-09-14 23:23:12,154 [trainer.py] => CNN top1 curve: [98.67]
2024-09-14 23:23:12,154 [trainer.py] => CNN top5 curve: [99.64]

Average Accuracy (CNN): 98.67
2024-09-14 23:23:12,154 [trainer.py] => Average Accuracy (CNN): 98.67 

2024-09-14 23:23:12,155 [trainer.py] => All params: 86118338
2024-09-14 23:23:12,155 [trainer.py] => Trainable params: 304320
2024-09-14 23:23:12,157 [ease.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.223, Train_accy 37.20:   0%|          | 0/20 [00:02<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.223, Train_accy 37.20:   5%|▌         | 1/20 [00:02<00:51,  2.73s/it]
Task 1, Epoch 2/20 => Loss 1.855, Train_accy 66.18:   5%|▌         | 1/20 [00:05<00:51,  2.73s/it]
Task 1, Epoch 2/20 => Loss 1.855, Train_accy 66.18:  10%|█         | 2/20 [00:05<00:49,  2.75s/it]
Task 1, Epoch 3/20 => Loss 1.364, Train_accy 71.98:  10%|█         | 2/20 [00:08<00:49,  2.75s/it]
Task 1, Epoch 3/20 => Loss 1.364, Train_accy 71.98:  15%|█▌        | 3/20 [00:08<00:46,  2.75s/it]
Task 1, Epoch 4/20 => Loss 0.930, Train_accy 80.68:  15%|█▌        | 3/20 [00:10<00:46,  2.75s/it]
Task 1, Epoch 4/20 => Loss 0.930, Train_accy 80.68:  20%|██        | 4/20 [00:10<00:43,  2.74s/it]
Task 1, Epoch 5/20 => Loss 0.663, Train_accy 90.58:  20%|██        | 4/20 [00:13<00:43,  2.74s/it]
Task 1, Epoch 5/20 => Loss 0.663, Train_accy 90.58:  25%|██▌       | 5/20 [00:13<00:41,  2.74s/it]
Task 1, Epoch 6/20 => Loss 0.518, Train_accy 92.27:  25%|██▌       | 5/20 [00:16<00:41,  2.74s/it]
Task 1, Epoch 6/20 => Loss 0.518, Train_accy 92.27:  30%|███       | 6/20 [00:16<00:38,  2.76s/it]
Task 1, Epoch 7/20 => Loss 0.433, Train_accy 93.72:  30%|███       | 6/20 [00:19<00:38,  2.76s/it]
Task 1, Epoch 7/20 => Loss 0.433, Train_accy 93.72:  35%|███▌      | 7/20 [00:19<00:35,  2.75s/it]
Task 1, Epoch 8/20 => Loss 0.366, Train_accy 95.65:  35%|███▌      | 7/20 [00:22<00:35,  2.75s/it]
Task 1, Epoch 8/20 => Loss 0.366, Train_accy 95.65:  40%|████      | 8/20 [00:22<00:33,  2.77s/it]
Task 1, Epoch 9/20 => Loss 0.339, Train_accy 95.65:  40%|████      | 8/20 [00:24<00:33,  2.77s/it]
Task 1, Epoch 9/20 => Loss 0.339, Train_accy 95.65:  45%|████▌     | 9/20 [00:24<00:30,  2.77s/it]
Task 1, Epoch 10/20 => Loss 0.344, Train_accy 94.20:  45%|████▌     | 9/20 [00:27<00:30,  2.77s/it]
Task 1, Epoch 10/20 => Loss 0.344, Train_accy 94.20:  50%|█████     | 10/20 [00:27<00:27,  2.76s/it]
Task 1, Epoch 11/20 => Loss 0.342, Train_accy 93.00:  50%|█████     | 10/20 [00:30<00:27,  2.76s/it]
Task 1, Epoch 11/20 => Loss 0.342, Train_accy 93.00:  55%|█████▌    | 11/20 [00:30<00:24,  2.78s/it]
Task 1, Epoch 12/20 => Loss 0.277, Train_accy 96.14:  55%|█████▌    | 11/20 [00:33<00:24,  2.78s/it]
Task 1, Epoch 12/20 => Loss 0.277, Train_accy 96.14:  60%|██████    | 12/20 [00:33<00:22,  2.77s/it]
Task 1, Epoch 13/20 => Loss 0.294, Train_accy 95.89:  60%|██████    | 12/20 [00:35<00:22,  2.77s/it]
Task 1, Epoch 13/20 => Loss 0.294, Train_accy 95.89:  65%|██████▌   | 13/20 [00:35<00:19,  2.78s/it]
Task 1, Epoch 14/20 => Loss 0.281, Train_accy 94.20:  65%|██████▌   | 13/20 [00:38<00:19,  2.78s/it]
Task 1, Epoch 14/20 => Loss 0.281, Train_accy 94.20:  70%|███████   | 14/20 [00:38<00:16,  2.76s/it]
Task 1, Epoch 15/20 => Loss 0.267, Train_accy 95.89:  70%|███████   | 14/20 [00:41<00:16,  2.76s/it]
Task 1, Epoch 15/20 => Loss 0.267, Train_accy 95.89:  75%|███████▌  | 15/20 [00:41<00:13,  2.75s/it]
Task 1, Epoch 16/20 => Loss 0.283, Train_accy 95.41:  75%|███████▌  | 15/20 [00:44<00:13,  2.75s/it]
Task 1, Epoch 16/20 => Loss 0.283, Train_accy 95.41:  80%|████████  | 16/20 [00:44<00:10,  2.74s/it]
Task 1, Epoch 17/20 => Loss 0.273, Train_accy 95.89:  80%|████████  | 16/20 [00:46<00:10,  2.74s/it]
Task 1, Epoch 17/20 => Loss 0.273, Train_accy 95.89:  85%|████████▌ | 17/20 [00:46<00:08,  2.75s/it]
Task 1, Epoch 18/20 => Loss 0.260, Train_accy 95.89:  85%|████████▌ | 17/20 [00:49<00:08,  2.75s/it]
Task 1, Epoch 18/20 => Loss 0.260, Train_accy 95.89:  90%|█████████ | 18/20 [00:49<00:05,  2.76s/it]
Task 1, Epoch 19/20 => Loss 0.264, Train_accy 95.17:  90%|█████████ | 18/20 [00:52<00:05,  2.76s/it]
Task 1, Epoch 19/20 => Loss 0.264, Train_accy 95.17:  95%|█████████▌| 19/20 [00:52<00:02,  2.75s/it]
Task 1, Epoch 20/20 => Loss 0.292, Train_accy 94.44:  95%|█████████▌| 19/20 [00:55<00:02,  2.75s/it]
Task 1, Epoch 20/20 => Loss 0.292, Train_accy 94.44: 100%|██████████| 20/20 [00:55<00:00,  2.76s/it]
Task 1, Epoch 20/20 => Loss 0.292, Train_accy 94.44: 100%|██████████| 20/20 [00:55<00:00,  2.76s/it]2024-09-14 23:24:07,338 [ease.py] => Task 1, Epoch 20/20 => Loss 0.292, Train_accy 94.44

2024-09-14 23:24:27,421 [ease.py] => Task correct: 99.57850368809272
2024-09-14 23:24:27,421 [ease.py] => Task acc: 95.29329118370214
2024-09-14 23:24:27,446 [trainer.py] => No NME accuracy.
2024-09-14 23:24:27,446 [trainer.py] => CNN: {'total': 95.01, '00-09': 98.18, '10-19': 93.72, 'old': 98.18, 'new': 93.72}
2024-09-14 23:24:27,446 [trainer.py] => CNN top1 curve: [98.67, 95.01]
2024-09-14 23:24:27,446 [trainer.py] => CNN top5 curve: [99.64, 99.75]

Average Accuracy (CNN): 96.84
2024-09-14 23:24:27,447 [trainer.py] => Average Accuracy (CNN): 96.84 

2024-09-14 23:24:27,447 [trainer.py] => All params: 86141378
2024-09-14 23:24:27,448 [trainer.py] => Trainable params: 304320
2024-09-14 23:24:27,449 [ease.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.235, Train_accy 39.45:   0%|          | 0/20 [00:02<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.235, Train_accy 39.45:   5%|▌         | 1/20 [00:02<00:44,  2.36s/it]
Task 2, Epoch 2/20 => Loss 1.957, Train_accy 62.47:   5%|▌         | 1/20 [00:04<00:44,  2.36s/it]
Task 2, Epoch 2/20 => Loss 1.957, Train_accy 62.47:  10%|█         | 2/20 [00:04<00:42,  2.36s/it]
Task 2, Epoch 3/20 => Loss 1.557, Train_accy 78.08:  10%|█         | 2/20 [00:07<00:42,  2.36s/it]
Task 2, Epoch 3/20 => Loss 1.557, Train_accy 78.08:  15%|█▌        | 3/20 [00:07<00:39,  2.35s/it]
Task 2, Epoch 4/20 => Loss 1.150, Train_accy 85.48:  15%|█▌        | 3/20 [00:09<00:39,  2.35s/it]
Task 2, Epoch 4/20 => Loss 1.150, Train_accy 85.48:  20%|██        | 4/20 [00:09<00:37,  2.35s/it]
Task 2, Epoch 5/20 => Loss 0.818, Train_accy 92.05:  20%|██        | 4/20 [00:11<00:37,  2.35s/it]
Task 2, Epoch 5/20 => Loss 0.818, Train_accy 92.05:  25%|██▌       | 5/20 [00:11<00:35,  2.34s/it]
Task 2, Epoch 6/20 => Loss 0.623, Train_accy 94.52:  25%|██▌       | 5/20 [00:14<00:35,  2.34s/it]
Task 2, Epoch 6/20 => Loss 0.623, Train_accy 94.52:  30%|███       | 6/20 [00:14<00:32,  2.35s/it]
Task 2, Epoch 7/20 => Loss 0.516, Train_accy 93.42:  30%|███       | 6/20 [00:16<00:32,  2.35s/it]
Task 2, Epoch 7/20 => Loss 0.516, Train_accy 93.42:  35%|███▌      | 7/20 [00:16<00:30,  2.38s/it]
Task 2, Epoch 8/20 => Loss 0.466, Train_accy 93.15:  35%|███▌      | 7/20 [00:18<00:30,  2.38s/it]
Task 2, Epoch 8/20 => Loss 0.466, Train_accy 93.15:  40%|████      | 8/20 [00:18<00:28,  2.37s/it]
Task 2, Epoch 9/20 => Loss 0.420, Train_accy 94.79:  40%|████      | 8/20 [00:21<00:28,  2.37s/it]
Task 2, Epoch 9/20 => Loss 0.420, Train_accy 94.79:  45%|████▌     | 9/20 [00:21<00:26,  2.40s/it]
Task 2, Epoch 10/20 => Loss 0.359, Train_accy 96.16:  45%|████▌     | 9/20 [00:23<00:26,  2.40s/it]
Task 2, Epoch 10/20 => Loss 0.359, Train_accy 96.16:  50%|█████     | 10/20 [00:23<00:24,  2.44s/it]
Task 2, Epoch 11/20 => Loss 0.348, Train_accy 96.16:  50%|█████     | 10/20 [00:26<00:24,  2.44s/it]
Task 2, Epoch 11/20 => Loss 0.348, Train_accy 96.16:  55%|█████▌    | 11/20 [00:26<00:22,  2.45s/it]
Task 2, Epoch 12/20 => Loss 0.341, Train_accy 96.16:  55%|█████▌    | 11/20 [00:28<00:22,  2.45s/it]
Task 2, Epoch 12/20 => Loss 0.341, Train_accy 96.16:  60%|██████    | 12/20 [00:28<00:19,  2.45s/it]
Task 2, Epoch 13/20 => Loss 0.297, Train_accy 97.26:  60%|██████    | 12/20 [00:31<00:19,  2.45s/it]
Task 2, Epoch 13/20 => Loss 0.297, Train_accy 97.26:  65%|██████▌   | 13/20 [00:31<00:17,  2.49s/it]
Task 2, Epoch 14/20 => Loss 0.317, Train_accy 96.99:  65%|██████▌   | 13/20 [00:33<00:17,  2.49s/it]
Task 2, Epoch 14/20 => Loss 0.317, Train_accy 96.99:  70%|███████   | 14/20 [00:33<00:14,  2.47s/it]
Task 2, Epoch 15/20 => Loss 0.307, Train_accy 96.71:  70%|███████   | 14/20 [00:36<00:14,  2.47s/it]
Task 2, Epoch 15/20 => Loss 0.307, Train_accy 96.71:  75%|███████▌  | 15/20 [00:36<00:12,  2.47s/it]
Task 2, Epoch 16/20 => Loss 0.328, Train_accy 94.52:  75%|███████▌  | 15/20 [00:38<00:12,  2.47s/it]
Task 2, Epoch 16/20 => Loss 0.328, Train_accy 94.52:  80%|████████  | 16/20 [00:38<00:09,  2.46s/it]
Task 2, Epoch 17/20 => Loss 0.292, Train_accy 96.99:  80%|████████  | 16/20 [00:41<00:09,  2.46s/it]
Task 2, Epoch 17/20 => Loss 0.292, Train_accy 96.99:  85%|████████▌ | 17/20 [00:41<00:07,  2.44s/it]
Task 2, Epoch 18/20 => Loss 0.304, Train_accy 95.62:  85%|████████▌ | 17/20 [00:43<00:07,  2.44s/it]
Task 2, Epoch 18/20 => Loss 0.304, Train_accy 95.62:  90%|█████████ | 18/20 [00:43<00:04,  2.44s/it]
Task 2, Epoch 19/20 => Loss 0.296, Train_accy 96.71:  90%|█████████ | 18/20 [00:46<00:04,  2.44s/it]
Task 2, Epoch 19/20 => Loss 0.296, Train_accy 96.71:  95%|█████████▌| 19/20 [00:46<00:02,  2.48s/it]
Task 2, Epoch 20/20 => Loss 0.292, Train_accy 95.89:  95%|█████████▌| 19/20 [00:48<00:02,  2.48s/it]
Task 2, Epoch 20/20 => Loss 0.292, Train_accy 95.89: 100%|██████████| 20/20 [00:48<00:00,  2.50s/it]
Task 2, Epoch 20/20 => Loss 0.292, Train_accy 95.89: 100%|██████████| 20/20 [00:48<00:00,  2.43s/it]2024-09-14 23:25:16,116 [ease.py] => Task 2, Epoch 20/20 => Loss 0.292, Train_accy 95.89

2024-09-14 23:25:58,583 [ease.py] => Task correct: 91.5625
2024-09-14 23:25:58,584 [ease.py] => Task acc: 95.73660714285714
2024-09-14 23:25:58,608 [trainer.py] => No NME accuracy.
2024-09-14 23:25:58,609 [trainer.py] => CNN: {'total': 88.93, '00-09': 95.04, '10-19': 87.68, '20-29': 87.39, 'old': 89.81, 'new': 87.39}
2024-09-14 23:25:58,609 [trainer.py] => CNN top1 curve: [98.67, 95.01, 88.93]
2024-09-14 23:25:58,609 [trainer.py] => CNN top5 curve: [99.64, 99.75, 99.58]

Average Accuracy (CNN): 94.2
2024-09-14 23:25:58,609 [trainer.py] => Average Accuracy (CNN): 94.2 

2024-09-14 23:25:58,610 [trainer.py] => All params: 86179778
2024-09-14 23:25:58,610 [trainer.py] => Trainable params: 304320
2024-09-14 23:25:58,612 [ease.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.251, Train_accy 33.66:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.251, Train_accy 33.66:   5%|▌         | 1/20 [00:02<00:39,  2.09s/it]
Task 3, Epoch 2/20 => Loss 1.996, Train_accy 66.34:   5%|▌         | 1/20 [00:04<00:39,  2.09s/it]
Task 3, Epoch 2/20 => Loss 1.996, Train_accy 66.34:  10%|█         | 2/20 [00:04<00:37,  2.07s/it]
Task 3, Epoch 3/20 => Loss 1.616, Train_accy 78.88:  10%|█         | 2/20 [00:06<00:37,  2.07s/it]
Task 3, Epoch 3/20 => Loss 1.616, Train_accy 78.88:  15%|█▌        | 3/20 [00:06<00:35,  2.06s/it]
Task 3, Epoch 4/20 => Loss 1.164, Train_accy 89.77:  15%|█▌        | 3/20 [00:08<00:35,  2.06s/it]
Task 3, Epoch 4/20 => Loss 1.164, Train_accy 89.77:  20%|██        | 4/20 [00:08<00:34,  2.15s/it]
Task 3, Epoch 5/20 => Loss 0.786, Train_accy 93.73:  20%|██        | 4/20 [00:10<00:34,  2.15s/it]
Task 3, Epoch 5/20 => Loss 0.786, Train_accy 93.73:  25%|██▌       | 5/20 [00:10<00:32,  2.16s/it]
Task 3, Epoch 6/20 => Loss 0.561, Train_accy 96.04:  25%|██▌       | 5/20 [00:12<00:32,  2.16s/it]
Task 3, Epoch 6/20 => Loss 0.561, Train_accy 96.04:  30%|███       | 6/20 [00:12<00:30,  2.19s/it]
Task 3, Epoch 7/20 => Loss 0.445, Train_accy 96.70:  30%|███       | 6/20 [00:15<00:30,  2.19s/it]
Task 3, Epoch 7/20 => Loss 0.445, Train_accy 96.70:  35%|███▌      | 7/20 [00:15<00:28,  2.18s/it]
Task 3, Epoch 8/20 => Loss 0.355, Train_accy 97.03:  35%|███▌      | 7/20 [00:17<00:28,  2.18s/it]
Task 3, Epoch 8/20 => Loss 0.355, Train_accy 97.03:  40%|████      | 8/20 [00:17<00:25,  2.17s/it]
Task 3, Epoch 9/20 => Loss 0.302, Train_accy 98.35:  40%|████      | 8/20 [00:19<00:25,  2.17s/it]
Task 3, Epoch 9/20 => Loss 0.302, Train_accy 98.35:  45%|████▌     | 9/20 [00:19<00:23,  2.18s/it]
Task 3, Epoch 10/20 => Loss 0.263, Train_accy 100.00:  45%|████▌     | 9/20 [00:21<00:23,  2.18s/it]
Task 3, Epoch 10/20 => Loss 0.263, Train_accy 100.00:  50%|█████     | 10/20 [00:21<00:21,  2.17s/it]
Task 3, Epoch 11/20 => Loss 0.258, Train_accy 98.68:  50%|█████     | 10/20 [00:23<00:21,  2.17s/it] 
Task 3, Epoch 11/20 => Loss 0.258, Train_accy 98.68:  55%|█████▌    | 11/20 [00:23<00:19,  2.17s/it]
Task 3, Epoch 12/20 => Loss 0.244, Train_accy 98.68:  55%|█████▌    | 11/20 [00:25<00:19,  2.17s/it]
Task 3, Epoch 12/20 => Loss 0.244, Train_accy 98.68:  60%|██████    | 12/20 [00:25<00:17,  2.16s/it]
Task 3, Epoch 13/20 => Loss 0.230, Train_accy 99.01:  60%|██████    | 12/20 [00:27<00:17,  2.16s/it]
Task 3, Epoch 13/20 => Loss 0.230, Train_accy 99.01:  65%|██████▌   | 13/20 [00:27<00:15,  2.15s/it]
Task 3, Epoch 14/20 => Loss 0.231, Train_accy 97.69:  65%|██████▌   | 13/20 [00:30<00:15,  2.15s/it]
Task 3, Epoch 14/20 => Loss 0.231, Train_accy 97.69:  70%|███████   | 14/20 [00:30<00:12,  2.16s/it]
Task 3, Epoch 15/20 => Loss 0.242, Train_accy 98.02:  70%|███████   | 14/20 [00:32<00:12,  2.16s/it]
Task 3, Epoch 15/20 => Loss 0.242, Train_accy 98.02:  75%|███████▌  | 15/20 [00:32<00:10,  2.15s/it]
Task 3, Epoch 16/20 => Loss 0.204, Train_accy 99.67:  75%|███████▌  | 15/20 [00:34<00:10,  2.15s/it]
Task 3, Epoch 16/20 => Loss 0.204, Train_accy 99.67:  80%|████████  | 16/20 [00:34<00:08,  2.15s/it]
Task 3, Epoch 17/20 => Loss 0.215, Train_accy 99.34:  80%|████████  | 16/20 [00:36<00:08,  2.15s/it]
Task 3, Epoch 17/20 => Loss 0.215, Train_accy 99.34:  85%|████████▌ | 17/20 [00:36<00:06,  2.15s/it]
Task 3, Epoch 18/20 => Loss 0.218, Train_accy 98.02:  85%|████████▌ | 17/20 [00:38<00:06,  2.15s/it]
Task 3, Epoch 18/20 => Loss 0.218, Train_accy 98.02:  90%|█████████ | 18/20 [00:38<00:04,  2.16s/it]
Task 3, Epoch 19/20 => Loss 0.209, Train_accy 98.68:  90%|█████████ | 18/20 [00:41<00:04,  2.16s/it]
Task 3, Epoch 19/20 => Loss 0.209, Train_accy 98.68:  95%|█████████▌| 19/20 [00:41<00:02,  2.18s/it]
Task 3, Epoch 20/20 => Loss 0.207, Train_accy 99.01:  95%|█████████▌| 19/20 [00:43<00:02,  2.18s/it]
Task 3, Epoch 20/20 => Loss 0.207, Train_accy 99.01: 100%|██████████| 20/20 [00:43<00:00,  2.19s/it]
Task 3, Epoch 20/20 => Loss 0.207, Train_accy 99.01: 100%|██████████| 20/20 [00:43<00:00,  2.16s/it]2024-09-14 23:26:41,829 [ease.py] => Task 3, Epoch 20/20 => Loss 0.207, Train_accy 99.01

2024-09-14 23:27:51,358 [ease.py] => Task correct: 89.42408376963351
2024-09-14 23:27:51,359 [ease.py] => Task acc: 96.43979057591623
2024-09-14 23:27:51,387 [trainer.py] => No NME accuracy.
2024-09-14 23:27:51,387 [trainer.py] => CNN: {'total': 87.56, '00-09': 94.31, '10-19': 86.69, '20-29': 81.87, '30-39': 91.92, 'old': 86.34, 'new': 91.92}
2024-09-14 23:27:51,388 [trainer.py] => CNN top1 curve: [98.67, 95.01, 88.93, 87.56]
2024-09-14 23:27:51,388 [trainer.py] => CNN top5 curve: [99.64, 99.75, 99.58, 99.06]

Average Accuracy (CNN): 92.54
2024-09-14 23:27:51,388 [trainer.py] => Average Accuracy (CNN): 92.54 

2024-09-14 23:27:51,389 [trainer.py] => All params: 86233538
2024-09-14 23:27:51,390 [trainer.py] => Trainable params: 304320
2024-09-14 23:27:51,392 [ease.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.154, Train_accy 39.60:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.154, Train_accy 39.60:   5%|▌         | 1/20 [00:03<01:05,  3.47s/it]
Task 4, Epoch 2/20 => Loss 1.572, Train_accy 63.83:   5%|▌         | 1/20 [00:06<01:05,  3.47s/it]
Task 4, Epoch 2/20 => Loss 1.572, Train_accy 63.83:  10%|█         | 2/20 [00:06<01:02,  3.48s/it]
Task 4, Epoch 3/20 => Loss 1.062, Train_accy 75.95:  10%|█         | 2/20 [00:10<01:02,  3.48s/it]
Task 4, Epoch 3/20 => Loss 1.062, Train_accy 75.95:  15%|█▌        | 3/20 [00:10<00:59,  3.49s/it]
Task 4, Epoch 4/20 => Loss 0.738, Train_accy 86.62:  15%|█▌        | 3/20 [00:13<00:59,  3.49s/it]
Task 4, Epoch 4/20 => Loss 0.738, Train_accy 86.62:  20%|██        | 4/20 [00:13<00:55,  3.49s/it]
Task 4, Epoch 5/20 => Loss 0.559, Train_accy 90.42:  20%|██        | 4/20 [00:17<00:55,  3.49s/it]
Task 4, Epoch 5/20 => Loss 0.559, Train_accy 90.42:  25%|██▌       | 5/20 [00:17<00:52,  3.52s/it]
Task 4, Epoch 6/20 => Loss 0.471, Train_accy 91.14:  25%|██▌       | 5/20 [00:21<00:52,  3.52s/it]
Task 4, Epoch 6/20 => Loss 0.471, Train_accy 91.14:  30%|███       | 6/20 [00:21<00:49,  3.56s/it]
Task 4, Epoch 7/20 => Loss 0.372, Train_accy 94.03:  30%|███       | 6/20 [00:24<00:49,  3.56s/it]
Task 4, Epoch 7/20 => Loss 0.372, Train_accy 94.03:  35%|███▌      | 7/20 [00:24<00:46,  3.59s/it]
Task 4, Epoch 8/20 => Loss 0.369, Train_accy 93.85:  35%|███▌      | 7/20 [00:28<00:46,  3.59s/it]
Task 4, Epoch 8/20 => Loss 0.369, Train_accy 93.85:  40%|████      | 8/20 [00:28<00:43,  3.59s/it]
Task 4, Epoch 9/20 => Loss 0.324, Train_accy 94.03:  40%|████      | 8/20 [00:31<00:43,  3.59s/it]
Task 4, Epoch 9/20 => Loss 0.324, Train_accy 94.03:  45%|████▌     | 9/20 [00:31<00:39,  3.59s/it]
Task 4, Epoch 10/20 => Loss 0.303, Train_accy 94.03:  45%|████▌     | 9/20 [00:35<00:39,  3.59s/it]
Task 4, Epoch 10/20 => Loss 0.303, Train_accy 94.03:  50%|█████     | 10/20 [00:35<00:35,  3.59s/it]
Task 4, Epoch 11/20 => Loss 0.304, Train_accy 93.49:  50%|█████     | 10/20 [00:39<00:35,  3.59s/it]
Task 4, Epoch 11/20 => Loss 0.304, Train_accy 93.49:  55%|█████▌    | 11/20 [00:39<00:31,  3.54s/it]
Task 4, Epoch 12/20 => Loss 0.304, Train_accy 93.49:  55%|█████▌    | 11/20 [00:42<00:31,  3.54s/it]
Task 4, Epoch 12/20 => Loss 0.304, Train_accy 93.49:  60%|██████    | 12/20 [00:42<00:28,  3.53s/it]
Task 4, Epoch 13/20 => Loss 0.262, Train_accy 94.76:  60%|██████    | 12/20 [00:45<00:28,  3.53s/it]
Task 4, Epoch 13/20 => Loss 0.262, Train_accy 94.76:  65%|██████▌   | 13/20 [00:45<00:24,  3.45s/it]
Task 4, Epoch 14/20 => Loss 0.253, Train_accy 96.02:  65%|██████▌   | 13/20 [00:49<00:24,  3.45s/it]
Task 4, Epoch 14/20 => Loss 0.253, Train_accy 96.02:  70%|███████   | 14/20 [00:49<00:20,  3.41s/it]
Task 4, Epoch 15/20 => Loss 0.254, Train_accy 96.02:  70%|███████   | 14/20 [00:52<00:20,  3.41s/it]
Task 4, Epoch 15/20 => Loss 0.254, Train_accy 96.02:  75%|███████▌  | 15/20 [00:52<00:16,  3.38s/it]
Task 4, Epoch 16/20 => Loss 0.244, Train_accy 95.12:  75%|███████▌  | 15/20 [00:55<00:16,  3.38s/it]
Task 4, Epoch 16/20 => Loss 0.244, Train_accy 95.12:  80%|████████  | 16/20 [00:55<00:13,  3.36s/it]
Task 4, Epoch 17/20 => Loss 0.252, Train_accy 94.94:  80%|████████  | 16/20 [00:59<00:13,  3.36s/it]
Task 4, Epoch 17/20 => Loss 0.252, Train_accy 94.94:  85%|████████▌ | 17/20 [00:59<00:10,  3.38s/it]
Task 4, Epoch 18/20 => Loss 0.235, Train_accy 96.75:  85%|████████▌ | 17/20 [01:02<00:10,  3.38s/it]
Task 4, Epoch 18/20 => Loss 0.235, Train_accy 96.75:  90%|█████████ | 18/20 [01:02<00:06,  3.35s/it]
Task 4, Epoch 19/20 => Loss 0.260, Train_accy 95.12:  90%|█████████ | 18/20 [01:05<00:06,  3.35s/it]
Task 4, Epoch 19/20 => Loss 0.260, Train_accy 95.12:  95%|█████████▌| 19/20 [01:05<00:03,  3.33s/it]
Task 4, Epoch 20/20 => Loss 0.250, Train_accy 95.12:  95%|█████████▌| 19/20 [01:08<00:03,  3.33s/it]
Task 4, Epoch 20/20 => Loss 0.250, Train_accy 95.12: 100%|██████████| 20/20 [01:08<00:00,  3.31s/it]
Task 4, Epoch 20/20 => Loss 0.250, Train_accy 95.12: 100%|██████████| 20/20 [01:08<00:00,  3.45s/it]2024-09-14 23:29:00,372 [ease.py] => Task 4, Epoch 20/20 => Loss 0.250, Train_accy 95.12

2024-09-14 23:31:12,748 [ease.py] => Task correct: 84.01206636500754
2024-09-14 23:31:12,749 [ease.py] => Task acc: 95.5215222183548
2024-09-14 23:31:12,784 [trainer.py] => No NME accuracy.
2024-09-14 23:31:12,784 [trainer.py] => CNN: {'total': 82.2, '00-09': 94.31, '10-19': 85.8, '20-29': 79.42, '30-39': 90.8, '40-49': 74.07, 'old': 86.3, 'new': 74.07}
2024-09-14 23:31:12,784 [trainer.py] => CNN top1 curve: [98.67, 95.01, 88.93, 87.56, 82.2]
2024-09-14 23:31:12,784 [trainer.py] => CNN top5 curve: [99.64, 99.75, 99.58, 99.06, 98.06]

Average Accuracy (CNN): 90.47
2024-09-14 23:31:12,785 [trainer.py] => Average Accuracy (CNN): 90.47 

Accuracy Matrix (CNN):
[[98.67 98.18 95.04 94.31 94.31]
 [ 0.   93.72 87.68 86.69 85.8 ]
 [ 0.    0.   87.39 81.87 79.42]
 [ 0.    0.    0.   91.92 90.8 ]
 [ 0.    0.    0.    0.   74.07]]
2024-09-14 23:31:12,785 [trainer.py] => Forgetting (CNN): 5.342500000000001
2024-09-14 23:31:14,975 [trainer.py] => config: ./exps/ease_vtab_B0_Inc10.json
2024-09-14 23:31:15,005 [trainer.py] => prefix:  
2024-09-14 23:31:15,005 [trainer.py] => dataset: vtab
2024-09-14 23:31:15,005 [trainer.py] => memory_size: 0
2024-09-14 23:31:15,006 [trainer.py] => memory_per_class: 0
2024-09-14 23:31:15,006 [trainer.py] => fixed_memory: False
2024-09-14 23:31:15,006 [trainer.py] => shuffle: True
2024-09-14 23:31:15,006 [trainer.py] => init_cls: 5
2024-09-14 23:31:15,006 [trainer.py] => increment: 5
2024-09-14 23:31:15,006 [trainer.py] => model_name: ease
2024-09-14 23:31:15,006 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-14 23:31:15,006 [trainer.py] => device: [device(type='cuda', index=6)]
2024-09-14 23:31:15,006 [trainer.py] => seed: 1993
2024-09-14 23:31:15,006 [trainer.py] => init_epochs: 20
2024-09-14 23:31:15,006 [trainer.py] => init_lr: 0.05
2024-09-14 23:31:15,007 [trainer.py] => later_epochs: 20
2024-09-14 23:31:15,007 [trainer.py] => later_lr: 0.05
2024-09-14 23:31:15,007 [trainer.py] => batch_size: 48
2024-09-14 23:31:15,007 [trainer.py] => weight_decay: 0.005
2024-09-14 23:31:15,007 [trainer.py] => min_lr: 0
2024-09-14 23:31:15,007 [trainer.py] => optimizer: sgd
2024-09-14 23:31:15,007 [trainer.py] => scheduler: cosine
2024-09-14 23:31:15,007 [trainer.py] => pretrained: True
2024-09-14 23:31:15,007 [trainer.py] => vpt_type: Deep
2024-09-14 23:31:15,007 [trainer.py] => prompt_token_num: 5
2024-09-14 23:31:15,007 [trainer.py] => ffn_num: 16
2024-09-14 23:31:15,007 [trainer.py] => use_diagonal: False
2024-09-14 23:31:15,008 [trainer.py] => recalc_sim: True
2024-09-14 23:31:15,008 [trainer.py] => alpha: 0.1
2024-09-14 23:31:15,008 [trainer.py] => use_init_ptm: False
2024-09-14 23:31:15,008 [trainer.py] => beta: 0
2024-09-14 23:31:15,008 [trainer.py] => use_old_data: False
2024-09-14 23:31:15,008 [trainer.py] => use_reweight: True
2024-09-14 23:31:15,008 [trainer.py] => moni_adam: False
2024-09-14 23:31:15,008 [trainer.py] => adapter_num: -1
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-09-14 23:31:15,060 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-14 23:31:19,336 [trainer.py] => All params: 86102976
2024-09-14 23:31:19,337 [trainer.py] => Trainable params: 304320
2024-09-14 23:31:19,344 [ease.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.612, Train_accy 19.78:   0%|          | 0/20 [00:01<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.612, Train_accy 19.78:   5%|▌         | 1/20 [00:01<00:23,  1.22s/it]
Task 0, Epoch 2/20 => Loss 1.575, Train_accy 49.45:   5%|▌         | 1/20 [00:02<00:23,  1.22s/it]
Task 0, Epoch 2/20 => Loss 1.575, Train_accy 49.45:  10%|█         | 2/20 [00:02<00:19,  1.06s/it]
Task 0, Epoch 3/20 => Loss 1.509, Train_accy 86.81:  10%|█         | 2/20 [00:03<00:19,  1.06s/it]
Task 0, Epoch 3/20 => Loss 1.509, Train_accy 86.81:  15%|█▌        | 3/20 [00:03<00:16,  1.01it/s]
Task 0, Epoch 4/20 => Loss 1.432, Train_accy 93.41:  15%|█▌        | 3/20 [00:04<00:16,  1.01it/s]
Task 0, Epoch 4/20 => Loss 1.432, Train_accy 93.41:  20%|██        | 4/20 [00:04<00:15,  1.03it/s]
Task 0, Epoch 5/20 => Loss 1.343, Train_accy 94.51:  20%|██        | 4/20 [00:04<00:15,  1.03it/s]
Task 0, Epoch 5/20 => Loss 1.343, Train_accy 94.51:  25%|██▌       | 5/20 [00:04<00:14,  1.05it/s]
Task 0, Epoch 6/20 => Loss 1.267, Train_accy 95.60:  25%|██▌       | 5/20 [00:05<00:14,  1.05it/s]
Task 0, Epoch 6/20 => Loss 1.267, Train_accy 95.60:  30%|███       | 6/20 [00:05<00:13,  1.06it/s]
Task 0, Epoch 7/20 => Loss 1.169, Train_accy 93.41:  30%|███       | 6/20 [00:06<00:13,  1.06it/s]
Task 0, Epoch 7/20 => Loss 1.169, Train_accy 93.41:  35%|███▌      | 7/20 [00:06<00:12,  1.05it/s]
Task 0, Epoch 8/20 => Loss 1.097, Train_accy 96.70:  35%|███▌      | 7/20 [00:07<00:12,  1.05it/s]
Task 0, Epoch 8/20 => Loss 1.097, Train_accy 96.70:  40%|████      | 8/20 [00:07<00:11,  1.06it/s]
Task 0, Epoch 9/20 => Loss 1.017, Train_accy 96.70:  40%|████      | 8/20 [00:08<00:11,  1.06it/s]
Task 0, Epoch 9/20 => Loss 1.017, Train_accy 96.70:  45%|████▌     | 9/20 [00:08<00:10,  1.04it/s]
Task 0, Epoch 10/20 => Loss 0.945, Train_accy 96.70:  45%|████▌     | 9/20 [00:09<00:10,  1.04it/s]
Task 0, Epoch 10/20 => Loss 0.945, Train_accy 96.70:  50%|█████     | 10/20 [00:09<00:10,  1.03s/it]
Task 0, Epoch 11/20 => Loss 0.892, Train_accy 97.80:  50%|█████     | 10/20 [00:10<00:10,  1.03s/it]
Task 0, Epoch 11/20 => Loss 0.892, Train_accy 97.80:  55%|█████▌    | 11/20 [00:10<00:09,  1.03s/it]
Task 0, Epoch 12/20 => Loss 0.852, Train_accy 95.60:  55%|█████▌    | 11/20 [00:11<00:09,  1.03s/it]
Task 0, Epoch 12/20 => Loss 0.852, Train_accy 95.60:  60%|██████    | 12/20 [00:11<00:07,  1.01it/s]
Task 0, Epoch 13/20 => Loss 0.805, Train_accy 96.70:  60%|██████    | 12/20 [00:12<00:07,  1.01it/s]
Task 0, Epoch 13/20 => Loss 0.805, Train_accy 96.70:  65%|██████▌   | 13/20 [00:12<00:06,  1.04it/s]
Task 0, Epoch 14/20 => Loss 0.817, Train_accy 98.90:  65%|██████▌   | 13/20 [00:13<00:06,  1.04it/s]
Task 0, Epoch 14/20 => Loss 0.817, Train_accy 98.90:  70%|███████   | 14/20 [00:13<00:05,  1.06it/s]
Task 0, Epoch 15/20 => Loss 0.741, Train_accy 97.80:  70%|███████   | 14/20 [00:14<00:05,  1.06it/s]
Task 0, Epoch 15/20 => Loss 0.741, Train_accy 97.80:  75%|███████▌  | 15/20 [00:14<00:04,  1.07it/s]
Task 0, Epoch 16/20 => Loss 0.711, Train_accy 98.90:  75%|███████▌  | 15/20 [00:15<00:04,  1.07it/s]
Task 0, Epoch 16/20 => Loss 0.711, Train_accy 98.90:  80%|████████  | 16/20 [00:15<00:03,  1.08it/s]
Task 0, Epoch 17/20 => Loss 0.710, Train_accy 97.80:  80%|████████  | 16/20 [00:16<00:03,  1.08it/s]
Task 0, Epoch 17/20 => Loss 0.710, Train_accy 97.80:  85%|████████▌ | 17/20 [00:16<00:02,  1.10it/s]
Task 0, Epoch 18/20 => Loss 0.703, Train_accy 98.90:  85%|████████▌ | 17/20 [00:17<00:02,  1.10it/s]
Task 0, Epoch 18/20 => Loss 0.703, Train_accy 98.90:  90%|█████████ | 18/20 [00:17<00:01,  1.10it/s]
Task 0, Epoch 19/20 => Loss 0.701, Train_accy 97.80:  90%|█████████ | 18/20 [00:18<00:01,  1.10it/s]
Task 0, Epoch 19/20 => Loss 0.701, Train_accy 97.80:  95%|█████████▌| 19/20 [00:18<00:00,  1.09it/s]
Task 0, Epoch 20/20 => Loss 0.691, Train_accy 97.80:  95%|█████████▌| 19/20 [00:19<00:00,  1.09it/s]
Task 0, Epoch 20/20 => Loss 0.691, Train_accy 97.80: 100%|██████████| 20/20 [00:19<00:00,  1.10it/s]
Task 0, Epoch 20/20 => Loss 0.691, Train_accy 97.80: 100%|██████████| 20/20 [00:19<00:00,  1.05it/s]2024-09-14 23:31:38,606 [ease.py] => Task 0, Epoch 20/20 => Loss 0.691, Train_accy 97.80

2024-09-14 23:31:40,827 [ease.py] => Task correct: 100.0
2024-09-14 23:31:40,828 [ease.py] => Task acc: 96.5034965034965
2024-09-14 23:31:40,849 [trainer.py] => No NME accuracy.
2024-09-14 23:31:40,850 [trainer.py] => CNN: {'total': 96.5, '00-04': 96.5, 'old': 0, 'new': 96.5}
2024-09-14 23:31:40,850 [trainer.py] => CNN top1 curve: [96.5]
2024-09-14 23:31:40,850 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 96.5
2024-09-14 23:31:40,850 [trainer.py] => Average Accuracy (CNN): 96.5 

2024-09-14 23:31:40,851 [trainer.py] => All params: 86110658
2024-09-14 23:31:40,852 [trainer.py] => Trainable params: 304320
2024-09-14 23:31:40,853 [ease.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.600, Train_accy 22.86:   0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.600, Train_accy 22.86:   5%|▌         | 1/20 [00:00<00:16,  1.17it/s]
Task 1, Epoch 2/20 => Loss 1.564, Train_accy 60.00:   5%|▌         | 1/20 [00:01<00:16,  1.17it/s]
Task 1, Epoch 2/20 => Loss 1.564, Train_accy 60.00:  10%|█         | 2/20 [00:01<00:16,  1.08it/s]
Task 1, Epoch 3/20 => Loss 1.491, Train_accy 88.57:  10%|█         | 2/20 [00:02<00:16,  1.08it/s]
Task 1, Epoch 3/20 => Loss 1.491, Train_accy 88.57:  15%|█▌        | 3/20 [00:02<00:15,  1.11it/s]
Task 1, Epoch 4/20 => Loss 1.391, Train_accy 100.00:  15%|█▌        | 3/20 [00:03<00:15,  1.11it/s]
Task 1, Epoch 4/20 => Loss 1.391, Train_accy 100.00:  20%|██        | 4/20 [00:03<00:14,  1.13it/s]
Task 1, Epoch 5/20 => Loss 1.312, Train_accy 97.14:  20%|██        | 4/20 [00:04<00:14,  1.13it/s] 
Task 1, Epoch 5/20 => Loss 1.312, Train_accy 97.14:  25%|██▌       | 5/20 [00:04<00:13,  1.11it/s]
Task 1, Epoch 6/20 => Loss 1.210, Train_accy 98.57:  25%|██▌       | 5/20 [00:05<00:13,  1.11it/s]
Task 1, Epoch 6/20 => Loss 1.210, Train_accy 98.57:  30%|███       | 6/20 [00:05<00:12,  1.14it/s]
Task 1, Epoch 7/20 => Loss 1.127, Train_accy 100.00:  30%|███       | 6/20 [00:06<00:12,  1.14it/s]
Task 1, Epoch 7/20 => Loss 1.127, Train_accy 100.00:  35%|███▌      | 7/20 [00:06<00:11,  1.15it/s]
Task 1, Epoch 8/20 => Loss 1.028, Train_accy 98.57:  35%|███▌      | 7/20 [00:07<00:11,  1.15it/s] 
Task 1, Epoch 8/20 => Loss 1.028, Train_accy 98.57:  40%|████      | 8/20 [00:07<00:10,  1.17it/s]
Task 1, Epoch 9/20 => Loss 0.931, Train_accy 100.00:  40%|████      | 8/20 [00:07<00:10,  1.17it/s]
Task 1, Epoch 9/20 => Loss 0.931, Train_accy 100.00:  45%|████▌     | 9/20 [00:07<00:09,  1.15it/s]
Task 1, Epoch 10/20 => Loss 0.858, Train_accy 100.00:  45%|████▌     | 9/20 [00:08<00:09,  1.15it/s]
Task 1, Epoch 10/20 => Loss 0.858, Train_accy 100.00:  50%|█████     | 10/20 [00:08<00:08,  1.19it/s]
Task 1, Epoch 11/20 => Loss 0.778, Train_accy 100.00:  50%|█████     | 10/20 [00:09<00:08,  1.19it/s]
Task 1, Epoch 11/20 => Loss 0.778, Train_accy 100.00:  55%|█████▌    | 11/20 [00:09<00:07,  1.18it/s]
Task 1, Epoch 12/20 => Loss 0.747, Train_accy 100.00:  55%|█████▌    | 11/20 [00:10<00:07,  1.18it/s]
Task 1, Epoch 12/20 => Loss 0.747, Train_accy 100.00:  60%|██████    | 12/20 [00:10<00:06,  1.19it/s]
Task 1, Epoch 13/20 => Loss 0.682, Train_accy 100.00:  60%|██████    | 12/20 [00:11<00:06,  1.19it/s]
Task 1, Epoch 13/20 => Loss 0.682, Train_accy 100.00:  65%|██████▌   | 13/20 [00:11<00:05,  1.18it/s]
Task 1, Epoch 14/20 => Loss 0.659, Train_accy 100.00:  65%|██████▌   | 13/20 [00:12<00:05,  1.18it/s]
Task 1, Epoch 14/20 => Loss 0.659, Train_accy 100.00:  70%|███████   | 14/20 [00:12<00:04,  1.21it/s]
Task 1, Epoch 15/20 => Loss 0.624, Train_accy 100.00:  70%|███████   | 14/20 [00:12<00:04,  1.21it/s]
Task 1, Epoch 15/20 => Loss 0.624, Train_accy 100.00:  75%|███████▌  | 15/20 [00:12<00:04,  1.17it/s]
Task 1, Epoch 16/20 => Loss 0.595, Train_accy 100.00:  75%|███████▌  | 15/20 [00:13<00:04,  1.17it/s]
Task 1, Epoch 16/20 => Loss 0.595, Train_accy 100.00:  80%|████████  | 16/20 [00:13<00:03,  1.16it/s]
Task 1, Epoch 17/20 => Loss 0.602, Train_accy 100.00:  80%|████████  | 16/20 [00:14<00:03,  1.16it/s]
Task 1, Epoch 17/20 => Loss 0.602, Train_accy 100.00:  85%|████████▌ | 17/20 [00:14<00:02,  1.10it/s]
Task 1, Epoch 18/20 => Loss 0.596, Train_accy 100.00:  85%|████████▌ | 17/20 [00:15<00:02,  1.10it/s]
Task 1, Epoch 18/20 => Loss 0.596, Train_accy 100.00:  90%|█████████ | 18/20 [00:15<00:01,  1.10it/s]
Task 1, Epoch 19/20 => Loss 0.581, Train_accy 100.00:  90%|█████████ | 18/20 [00:16<00:01,  1.10it/s]
Task 1, Epoch 19/20 => Loss 0.581, Train_accy 100.00:  95%|█████████▌| 19/20 [00:16<00:00,  1.12it/s]
Task 1, Epoch 20/20 => Loss 0.569, Train_accy 100.00:  95%|█████████▌| 19/20 [00:17<00:00,  1.12it/s]
Task 1, Epoch 20/20 => Loss 0.569, Train_accy 100.00: 100%|██████████| 20/20 [00:17<00:00,  1.16it/s]
Task 1, Epoch 20/20 => Loss 0.569, Train_accy 100.00: 100%|██████████| 20/20 [00:17<00:00,  1.15it/s]2024-09-14 23:31:58,250 [ease.py] => Task 1, Epoch 20/20 => Loss 0.569, Train_accy 100.00

2024-09-14 23:32:05,088 [ease.py] => Task correct: 99.27360774818402
2024-09-14 23:32:05,089 [ease.py] => Task acc: 98.78934624697337
2024-09-14 23:32:05,114 [trainer.py] => No NME accuracy.
2024-09-14 23:32:05,114 [trainer.py] => CNN: {'total': 98.55, '00-04': 95.8, '05-09': 100.0, 'old': 95.8, 'new': 100.0}
2024-09-14 23:32:05,114 [trainer.py] => CNN top1 curve: [96.5, 98.55]
2024-09-14 23:32:05,114 [trainer.py] => CNN top5 curve: [100.0, 99.64]

Average Accuracy (CNN): 97.52
2024-09-14 23:32:05,114 [trainer.py] => Average Accuracy (CNN): 97.52 

2024-09-14 23:32:05,115 [trainer.py] => All params: 86122178
2024-09-14 23:32:05,116 [trainer.py] => Trainable params: 304320
2024-09-14 23:32:05,117 [ease.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.591, Train_accy 38.41:   0%|          | 0/20 [00:01<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.591, Train_accy 38.41:   5%|▌         | 1/20 [00:01<00:23,  1.24s/it]
Task 2, Epoch 2/20 => Loss 1.493, Train_accy 74.64:   5%|▌         | 1/20 [00:02<00:23,  1.24s/it]
Task 2, Epoch 2/20 => Loss 1.493, Train_accy 74.64:  10%|█         | 2/20 [00:02<00:21,  1.17s/it]
Task 2, Epoch 3/20 => Loss 1.333, Train_accy 78.26:  10%|█         | 2/20 [00:03<00:21,  1.17s/it]
Task 2, Epoch 3/20 => Loss 1.333, Train_accy 78.26:  15%|█▌        | 3/20 [00:03<00:19,  1.16s/it]
Task 2, Epoch 4/20 => Loss 1.173, Train_accy 84.78:  15%|█▌        | 3/20 [00:04<00:19,  1.16s/it]
Task 2, Epoch 4/20 => Loss 1.173, Train_accy 84.78:  20%|██        | 4/20 [00:04<00:18,  1.18s/it]
Task 2, Epoch 5/20 => Loss 1.029, Train_accy 86.23:  20%|██        | 4/20 [00:05<00:18,  1.18s/it]
Task 2, Epoch 5/20 => Loss 1.029, Train_accy 86.23:  25%|██▌       | 5/20 [00:05<00:17,  1.18s/it]
Task 2, Epoch 6/20 => Loss 0.861, Train_accy 92.03:  25%|██▌       | 5/20 [00:07<00:17,  1.18s/it]
Task 2, Epoch 6/20 => Loss 0.861, Train_accy 92.03:  30%|███       | 6/20 [00:07<00:16,  1.20s/it]
Task 2, Epoch 7/20 => Loss 0.752, Train_accy 92.75:  30%|███       | 6/20 [00:08<00:16,  1.20s/it]
Task 2, Epoch 7/20 => Loss 0.752, Train_accy 92.75:  35%|███▌      | 7/20 [00:08<00:15,  1.21s/it]
Task 2, Epoch 8/20 => Loss 0.635, Train_accy 95.65:  35%|███▌      | 7/20 [00:09<00:15,  1.21s/it]
Task 2, Epoch 8/20 => Loss 0.635, Train_accy 95.65:  40%|████      | 8/20 [00:09<00:14,  1.23s/it]
Task 2, Epoch 9/20 => Loss 0.580, Train_accy 95.65:  40%|████      | 8/20 [00:10<00:14,  1.23s/it]
Task 2, Epoch 9/20 => Loss 0.580, Train_accy 95.65:  45%|████▌     | 9/20 [00:10<00:13,  1.24s/it]
Task 2, Epoch 10/20 => Loss 0.497, Train_accy 97.83:  45%|████▌     | 9/20 [00:12<00:13,  1.24s/it]
Task 2, Epoch 10/20 => Loss 0.497, Train_accy 97.83:  50%|█████     | 10/20 [00:12<00:12,  1.23s/it]
Task 2, Epoch 11/20 => Loss 0.434, Train_accy 97.83:  50%|█████     | 10/20 [00:13<00:12,  1.23s/it]
Task 2, Epoch 11/20 => Loss 0.434, Train_accy 97.83:  55%|█████▌    | 11/20 [00:13<00:10,  1.20s/it]
Task 2, Epoch 12/20 => Loss 0.428, Train_accy 97.10:  55%|█████▌    | 11/20 [00:14<00:10,  1.20s/it]
Task 2, Epoch 12/20 => Loss 0.428, Train_accy 97.10:  60%|██████    | 12/20 [00:14<00:09,  1.18s/it]
Task 2, Epoch 13/20 => Loss 0.375, Train_accy 99.28:  60%|██████    | 12/20 [00:15<00:09,  1.18s/it]
Task 2, Epoch 13/20 => Loss 0.375, Train_accy 99.28:  65%|██████▌   | 13/20 [00:15<00:08,  1.20s/it]
Task 2, Epoch 14/20 => Loss 0.352, Train_accy 99.28:  65%|██████▌   | 13/20 [00:16<00:08,  1.20s/it]
Task 2, Epoch 14/20 => Loss 0.352, Train_accy 99.28:  70%|███████   | 14/20 [00:16<00:07,  1.20s/it]
Task 2, Epoch 15/20 => Loss 0.351, Train_accy 98.55:  70%|███████   | 14/20 [00:18<00:07,  1.20s/it]
Task 2, Epoch 15/20 => Loss 0.351, Train_accy 98.55:  75%|███████▌  | 15/20 [00:18<00:06,  1.20s/it]
Task 2, Epoch 16/20 => Loss 0.373, Train_accy 96.38:  75%|███████▌  | 15/20 [00:19<00:06,  1.20s/it]
Task 2, Epoch 16/20 => Loss 0.373, Train_accy 96.38:  80%|████████  | 16/20 [00:19<00:04,  1.20s/it]
Task 2, Epoch 17/20 => Loss 0.329, Train_accy 99.28:  80%|████████  | 16/20 [00:20<00:04,  1.20s/it]
Task 2, Epoch 17/20 => Loss 0.329, Train_accy 99.28:  85%|████████▌ | 17/20 [00:20<00:03,  1.20s/it]
Task 2, Epoch 18/20 => Loss 0.317, Train_accy 99.28:  85%|████████▌ | 17/20 [00:21<00:03,  1.20s/it]
Task 2, Epoch 18/20 => Loss 0.317, Train_accy 99.28:  90%|█████████ | 18/20 [00:21<00:02,  1.20s/it]
Task 2, Epoch 19/20 => Loss 0.320, Train_accy 99.28:  90%|█████████ | 18/20 [00:22<00:02,  1.20s/it]
Task 2, Epoch 19/20 => Loss 0.320, Train_accy 99.28:  95%|█████████▌| 19/20 [00:22<00:01,  1.21s/it]
Task 2, Epoch 20/20 => Loss 0.319, Train_accy 98.55:  95%|█████████▌| 19/20 [00:24<00:01,  1.21s/it]
Task 2, Epoch 20/20 => Loss 0.319, Train_accy 98.55: 100%|██████████| 20/20 [00:24<00:00,  1.20s/it]
Task 2, Epoch 20/20 => Loss 0.319, Train_accy 98.55: 100%|██████████| 20/20 [00:24<00:00,  1.20s/it]2024-09-14 23:32:29,160 [ease.py] => Task 2, Epoch 20/20 => Loss 0.319, Train_accy 98.55

2024-09-14 23:32:45,192 [ease.py] => Task correct: 98.74826147426982
2024-09-14 23:32:45,193 [ease.py] => Task acc: 99.09596662030599
2024-09-14 23:32:45,216 [trainer.py] => No NME accuracy.
2024-09-14 23:32:45,216 [trainer.py] => CNN: {'total': 98.33, '00-04': 94.06, '05-09': 100.0, '10-14': 98.86, 'old': 97.94, 'new': 98.86}
2024-09-14 23:32:45,216 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33]
2024-09-14 23:32:45,216 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79]

Average Accuracy (CNN): 97.79
2024-09-14 23:32:45,216 [trainer.py] => Average Accuracy (CNN): 97.79 

2024-09-14 23:32:45,217 [trainer.py] => All params: 86141378
2024-09-14 23:32:45,218 [trainer.py] => Trainable params: 304320
2024-09-14 23:32:45,220 [ease.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.542, Train_accy 48.19:   0%|          | 0/20 [00:01<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.542, Train_accy 48.19:   5%|▌         | 1/20 [00:01<00:37,  2.00s/it]
Task 3, Epoch 2/20 => Loss 1.295, Train_accy 69.93:   5%|▌         | 1/20 [00:03<00:37,  2.00s/it]
Task 3, Epoch 2/20 => Loss 1.295, Train_accy 69.93:  10%|█         | 2/20 [00:03<00:35,  1.96s/it]
Task 3, Epoch 3/20 => Loss 1.049, Train_accy 69.20:  10%|█         | 2/20 [00:05<00:35,  1.96s/it]
Task 3, Epoch 3/20 => Loss 1.049, Train_accy 69.20:  15%|█▌        | 3/20 [00:05<00:33,  1.96s/it]
Task 3, Epoch 4/20 => Loss 0.848, Train_accy 70.65:  15%|█▌        | 3/20 [00:07<00:33,  1.96s/it]
Task 3, Epoch 4/20 => Loss 0.848, Train_accy 70.65:  20%|██        | 4/20 [00:07<00:31,  1.97s/it]
Task 3, Epoch 5/20 => Loss 0.719, Train_accy 74.64:  20%|██        | 4/20 [00:09<00:31,  1.97s/it]
Task 3, Epoch 5/20 => Loss 0.719, Train_accy 74.64:  25%|██▌       | 5/20 [00:09<00:29,  1.95s/it]
Task 3, Epoch 6/20 => Loss 0.620, Train_accy 80.80:  25%|██▌       | 5/20 [00:11<00:29,  1.95s/it]
Task 3, Epoch 6/20 => Loss 0.620, Train_accy 80.80:  30%|███       | 6/20 [00:11<00:26,  1.92s/it]
Task 3, Epoch 7/20 => Loss 0.526, Train_accy 88.41:  30%|███       | 6/20 [00:13<00:26,  1.92s/it]
Task 3, Epoch 7/20 => Loss 0.526, Train_accy 88.41:  35%|███▌      | 7/20 [00:13<00:25,  1.94s/it]
Task 3, Epoch 8/20 => Loss 0.515, Train_accy 90.58:  35%|███▌      | 7/20 [00:15<00:25,  1.94s/it]
Task 3, Epoch 8/20 => Loss 0.515, Train_accy 90.58:  40%|████      | 8/20 [00:15<00:23,  1.94s/it]
Task 3, Epoch 9/20 => Loss 0.453, Train_accy 92.75:  40%|████      | 8/20 [00:17<00:23,  1.94s/it]
Task 3, Epoch 9/20 => Loss 0.453, Train_accy 92.75:  45%|████▌     | 9/20 [00:17<00:21,  1.97s/it]
Task 3, Epoch 10/20 => Loss 0.420, Train_accy 92.75:  45%|████▌     | 9/20 [00:19<00:21,  1.97s/it]
Task 3, Epoch 10/20 => Loss 0.420, Train_accy 92.75:  50%|█████     | 10/20 [00:19<00:19,  1.94s/it]
Task 3, Epoch 11/20 => Loss 0.399, Train_accy 93.48:  50%|█████     | 10/20 [00:21<00:19,  1.94s/it]
Task 3, Epoch 11/20 => Loss 0.399, Train_accy 93.48:  55%|█████▌    | 11/20 [00:21<00:17,  1.92s/it]
Task 3, Epoch 12/20 => Loss 0.375, Train_accy 91.67:  55%|█████▌    | 11/20 [00:23<00:17,  1.92s/it]
Task 3, Epoch 12/20 => Loss 0.375, Train_accy 91.67:  60%|██████    | 12/20 [00:23<00:15,  1.91s/it]
Task 3, Epoch 13/20 => Loss 0.371, Train_accy 93.12:  60%|██████    | 12/20 [00:25<00:15,  1.91s/it]
Task 3, Epoch 13/20 => Loss 0.371, Train_accy 93.12:  65%|██████▌   | 13/20 [00:25<00:13,  1.92s/it]
Task 3, Epoch 14/20 => Loss 0.357, Train_accy 92.39:  65%|██████▌   | 13/20 [00:27<00:13,  1.92s/it]
Task 3, Epoch 14/20 => Loss 0.357, Train_accy 92.39:  70%|███████   | 14/20 [00:27<00:11,  1.95s/it]
Task 3, Epoch 15/20 => Loss 0.384, Train_accy 90.58:  70%|███████   | 14/20 [00:29<00:11,  1.95s/it]
Task 3, Epoch 15/20 => Loss 0.384, Train_accy 90.58:  75%|███████▌  | 15/20 [00:29<00:09,  1.91s/it]
Task 3, Epoch 16/20 => Loss 0.364, Train_accy 91.30:  75%|███████▌  | 15/20 [00:30<00:09,  1.91s/it]
Task 3, Epoch 16/20 => Loss 0.364, Train_accy 91.30:  80%|████████  | 16/20 [00:30<00:07,  1.87s/it]
Task 3, Epoch 17/20 => Loss 0.336, Train_accy 94.20:  80%|████████  | 16/20 [00:32<00:07,  1.87s/it]
Task 3, Epoch 17/20 => Loss 0.336, Train_accy 94.20:  85%|████████▌ | 17/20 [00:32<00:05,  1.84s/it]
Task 3, Epoch 18/20 => Loss 0.335, Train_accy 93.12:  85%|████████▌ | 17/20 [00:34<00:05,  1.84s/it]
Task 3, Epoch 18/20 => Loss 0.335, Train_accy 93.12:  90%|█████████ | 18/20 [00:34<00:03,  1.82s/it]
Task 3, Epoch 19/20 => Loss 0.340, Train_accy 93.48:  90%|█████████ | 18/20 [00:36<00:03,  1.82s/it]
Task 3, Epoch 19/20 => Loss 0.340, Train_accy 93.48:  95%|█████████▌| 19/20 [00:36<00:01,  1.82s/it]
Task 3, Epoch 20/20 => Loss 0.362, Train_accy 93.12:  95%|█████████▌| 19/20 [00:37<00:01,  1.82s/it]
Task 3, Epoch 20/20 => Loss 0.362, Train_accy 93.12: 100%|██████████| 20/20 [00:37<00:00,  1.81s/it]
Task 3, Epoch 20/20 => Loss 0.362, Train_accy 93.12: 100%|██████████| 20/20 [00:37<00:00,  1.90s/it]2024-09-14 23:33:23,179 [ease.py] => Task 3, Epoch 20/20 => Loss 0.362, Train_accy 93.12

2024-09-14 23:33:59,703 [ease.py] => Task correct: 98.06814190375835
2024-09-14 23:33:59,704 [ease.py] => Task acc: 95.85528626624517
2024-09-14 23:33:59,728 [trainer.py] => No NME accuracy.
2024-09-14 23:33:59,728 [trainer.py] => CNN: {'total': 94.45, '00-04': 93.71, '05-09': 100.0, '10-14': 97.71, '15-19': 91.06, 'old': 97.77, 'new': 91.06}
2024-09-14 23:33:59,728 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33, 94.45]
2024-09-14 23:33:59,728 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.68]

Average Accuracy (CNN): 96.96
2024-09-14 23:33:59,729 [trainer.py] => Average Accuracy (CNN): 96.96 

2024-09-14 23:33:59,729 [trainer.py] => All params: 86168258
2024-09-14 23:33:59,730 [trainer.py] => Trainable params: 304320
2024-09-14 23:33:59,731 [ease.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.544, Train_accy 48.80:   0%|          | 0/20 [00:01<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.544, Train_accy 48.80:   5%|▌         | 1/20 [00:01<00:34,  1.79s/it]
Task 4, Epoch 2/20 => Loss 1.332, Train_accy 72.00:   5%|▌         | 1/20 [00:03<00:34,  1.79s/it]
Task 4, Epoch 2/20 => Loss 1.332, Train_accy 72.00:  10%|█         | 2/20 [00:03<00:32,  1.82s/it]
Task 4, Epoch 3/20 => Loss 1.065, Train_accy 78.00:  10%|█         | 2/20 [00:05<00:32,  1.82s/it]
Task 4, Epoch 3/20 => Loss 1.065, Train_accy 78.00:  15%|█▌        | 3/20 [00:05<00:31,  1.83s/it]
Task 4, Epoch 4/20 => Loss 0.876, Train_accy 80.40:  15%|█▌        | 3/20 [00:07<00:31,  1.83s/it]
Task 4, Epoch 4/20 => Loss 0.876, Train_accy 80.40:  20%|██        | 4/20 [00:07<00:28,  1.80s/it]
Task 4, Epoch 5/20 => Loss 0.703, Train_accy 87.60:  20%|██        | 4/20 [00:09<00:28,  1.80s/it]
Task 4, Epoch 5/20 => Loss 0.703, Train_accy 87.60:  25%|██▌       | 5/20 [00:09<00:27,  1.80s/it]
Task 4, Epoch 6/20 => Loss 0.598, Train_accy 91.20:  25%|██▌       | 5/20 [00:10<00:27,  1.80s/it]
Task 4, Epoch 6/20 => Loss 0.598, Train_accy 91.20:  30%|███       | 6/20 [00:10<00:25,  1.80s/it]
Task 4, Epoch 7/20 => Loss 0.523, Train_accy 92.40:  30%|███       | 6/20 [00:12<00:25,  1.80s/it]
Task 4, Epoch 7/20 => Loss 0.523, Train_accy 92.40:  35%|███▌      | 7/20 [00:12<00:23,  1.80s/it]
Task 4, Epoch 8/20 => Loss 0.480, Train_accy 92.40:  35%|███▌      | 7/20 [00:14<00:23,  1.80s/it]
Task 4, Epoch 8/20 => Loss 0.480, Train_accy 92.40:  40%|████      | 8/20 [00:14<00:21,  1.80s/it]
Task 4, Epoch 9/20 => Loss 0.406, Train_accy 92.00:  40%|████      | 8/20 [00:16<00:21,  1.80s/it]
Task 4, Epoch 9/20 => Loss 0.406, Train_accy 92.00:  45%|████▌     | 9/20 [00:16<00:19,  1.81s/it]
Task 4, Epoch 10/20 => Loss 0.366, Train_accy 94.40:  45%|████▌     | 9/20 [00:18<00:19,  1.81s/it]
Task 4, Epoch 10/20 => Loss 0.366, Train_accy 94.40:  50%|█████     | 10/20 [00:18<00:17,  1.79s/it]
Task 4, Epoch 11/20 => Loss 0.358, Train_accy 92.80:  50%|█████     | 10/20 [00:19<00:17,  1.79s/it]
Task 4, Epoch 11/20 => Loss 0.358, Train_accy 92.80:  55%|█████▌    | 11/20 [00:19<00:16,  1.78s/it]
Task 4, Epoch 12/20 => Loss 0.335, Train_accy 95.20:  55%|█████▌    | 11/20 [00:21<00:16,  1.78s/it]
Task 4, Epoch 12/20 => Loss 0.335, Train_accy 95.20:  60%|██████    | 12/20 [00:21<00:14,  1.81s/it]
Task 4, Epoch 13/20 => Loss 0.298, Train_accy 96.40:  60%|██████    | 12/20 [00:23<00:14,  1.81s/it]
Task 4, Epoch 13/20 => Loss 0.298, Train_accy 96.40:  65%|██████▌   | 13/20 [00:23<00:12,  1.83s/it]
Task 4, Epoch 14/20 => Loss 0.321, Train_accy 95.20:  65%|██████▌   | 13/20 [00:25<00:12,  1.83s/it]
Task 4, Epoch 14/20 => Loss 0.321, Train_accy 95.20:  70%|███████   | 14/20 [00:25<00:11,  1.84s/it]
Task 4, Epoch 15/20 => Loss 0.303, Train_accy 95.60:  70%|███████   | 14/20 [00:27<00:11,  1.84s/it]
Task 4, Epoch 15/20 => Loss 0.303, Train_accy 95.60:  75%|███████▌  | 15/20 [00:27<00:09,  1.84s/it]
Task 4, Epoch 16/20 => Loss 0.323, Train_accy 95.20:  75%|███████▌  | 15/20 [00:29<00:09,  1.84s/it]
Task 4, Epoch 16/20 => Loss 0.323, Train_accy 95.20:  80%|████████  | 16/20 [00:29<00:07,  1.85s/it]
Task 4, Epoch 17/20 => Loss 0.325, Train_accy 93.60:  80%|████████  | 16/20 [00:30<00:07,  1.85s/it]
Task 4, Epoch 17/20 => Loss 0.325, Train_accy 93.60:  85%|████████▌ | 17/20 [00:30<00:05,  1.79s/it]
Task 4, Epoch 18/20 => Loss 0.312, Train_accy 94.40:  85%|████████▌ | 17/20 [00:32<00:05,  1.79s/it]
Task 4, Epoch 18/20 => Loss 0.312, Train_accy 94.40:  90%|█████████ | 18/20 [00:32<00:03,  1.76s/it]
Task 4, Epoch 19/20 => Loss 0.280, Train_accy 95.60:  90%|█████████ | 18/20 [00:34<00:03,  1.76s/it]
Task 4, Epoch 19/20 => Loss 0.280, Train_accy 95.60:  95%|█████████▌| 19/20 [00:34<00:01,  1.76s/it]
Task 4, Epoch 20/20 => Loss 0.299, Train_accy 96.00:  95%|█████████▌| 19/20 [00:35<00:01,  1.76s/it]
Task 4, Epoch 20/20 => Loss 0.299, Train_accy 96.00: 100%|██████████| 20/20 [00:35<00:00,  1.75s/it]
Task 4, Epoch 20/20 => Loss 0.299, Train_accy 96.00: 100%|██████████| 20/20 [00:35<00:00,  1.80s/it]2024-09-14 23:34:35,673 [ease.py] => Task 4, Epoch 20/20 => Loss 0.299, Train_accy 96.00

2024-09-14 23:35:38,726 [ease.py] => Task correct: 91.12627986348123
2024-09-14 23:35:38,727 [ease.py] => Task acc: 95.95319356411507
2024-09-14 23:35:38,750 [trainer.py] => No NME accuracy.
2024-09-14 23:35:38,750 [trainer.py] => CNN: {'total': 88.54, '00-04': 92.66, '05-09': 97.96, '10-14': 91.18, '15-19': 89.0, '20-24': 81.75, 'old': 91.53, 'new': 81.75}
2024-09-14 23:35:38,750 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33, 94.45, 88.54]
2024-09-14 23:35:38,750 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.68, 99.41]

Average Accuracy (CNN): 95.27
2024-09-14 23:35:38,750 [trainer.py] => Average Accuracy (CNN): 95.27 

2024-09-14 23:35:38,751 [trainer.py] => All params: 86202818
2024-09-14 23:35:38,752 [trainer.py] => Trainable params: 304320
2024-09-14 23:35:38,754 [ease.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.597, Train_accy 24.35:   0%|          | 0/20 [00:01<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.597, Train_accy 24.35:   5%|▌         | 1/20 [00:01<00:20,  1.06s/it]
Task 5, Epoch 2/20 => Loss 1.533, Train_accy 73.91:   5%|▌         | 1/20 [00:02<00:20,  1.06s/it]
Task 5, Epoch 2/20 => Loss 1.533, Train_accy 73.91:  10%|█         | 2/20 [00:02<00:19,  1.07s/it]
Task 5, Epoch 3/20 => Loss 1.428, Train_accy 94.78:  10%|█         | 2/20 [00:03<00:19,  1.07s/it]
Task 5, Epoch 3/20 => Loss 1.428, Train_accy 94.78:  15%|█▌        | 3/20 [00:03<00:18,  1.09s/it]
Task 5, Epoch 4/20 => Loss 1.305, Train_accy 95.65:  15%|█▌        | 3/20 [00:04<00:18,  1.09s/it]
Task 5, Epoch 4/20 => Loss 1.305, Train_accy 95.65:  20%|██        | 4/20 [00:04<00:17,  1.10s/it]
Task 5, Epoch 5/20 => Loss 1.197, Train_accy 98.26:  20%|██        | 4/20 [00:05<00:17,  1.10s/it]
Task 5, Epoch 5/20 => Loss 1.197, Train_accy 98.26:  25%|██▌       | 5/20 [00:05<00:16,  1.11s/it]
Task 5, Epoch 6/20 => Loss 1.009, Train_accy 99.13:  25%|██▌       | 5/20 [00:06<00:16,  1.11s/it]
Task 5, Epoch 6/20 => Loss 1.009, Train_accy 99.13:  30%|███       | 6/20 [00:06<00:15,  1.10s/it]
Task 5, Epoch 7/20 => Loss 0.926, Train_accy 96.52:  30%|███       | 6/20 [00:07<00:15,  1.10s/it]
Task 5, Epoch 7/20 => Loss 0.926, Train_accy 96.52:  35%|███▌      | 7/20 [00:07<00:14,  1.09s/it]
Task 5, Epoch 8/20 => Loss 0.797, Train_accy 97.39:  35%|███▌      | 7/20 [00:08<00:14,  1.09s/it]
Task 5, Epoch 8/20 => Loss 0.797, Train_accy 97.39:  40%|████      | 8/20 [00:08<00:13,  1.09s/it]
Task 5, Epoch 9/20 => Loss 0.748, Train_accy 99.13:  40%|████      | 8/20 [00:10<00:13,  1.09s/it]
Task 5, Epoch 9/20 => Loss 0.748, Train_accy 99.13:  45%|████▌     | 9/20 [00:10<00:12,  1.17s/it]
Task 5, Epoch 10/20 => Loss 0.668, Train_accy 97.39:  45%|████▌     | 9/20 [00:11<00:12,  1.17s/it]
Task 5, Epoch 10/20 => Loss 0.668, Train_accy 97.39:  50%|█████     | 10/20 [00:11<00:11,  1.15s/it]
Task 5, Epoch 11/20 => Loss 0.599, Train_accy 98.26:  50%|█████     | 10/20 [00:12<00:11,  1.15s/it]
Task 5, Epoch 11/20 => Loss 0.599, Train_accy 98.26:  55%|█████▌    | 11/20 [00:12<00:10,  1.14s/it]
Task 5, Epoch 12/20 => Loss 0.557, Train_accy 99.13:  55%|█████▌    | 11/20 [00:13<00:10,  1.14s/it]
Task 5, Epoch 12/20 => Loss 0.557, Train_accy 99.13:  60%|██████    | 12/20 [00:13<00:09,  1.14s/it]
Task 5, Epoch 13/20 => Loss 0.528, Train_accy 98.26:  60%|██████    | 12/20 [00:14<00:09,  1.14s/it]
Task 5, Epoch 13/20 => Loss 0.528, Train_accy 98.26:  65%|██████▌   | 13/20 [00:14<00:07,  1.13s/it]
Task 5, Epoch 14/20 => Loss 0.510, Train_accy 99.13:  65%|██████▌   | 13/20 [00:15<00:07,  1.13s/it]
Task 5, Epoch 14/20 => Loss 0.510, Train_accy 99.13:  70%|███████   | 14/20 [00:15<00:06,  1.12s/it]
Task 5, Epoch 15/20 => Loss 0.472, Train_accy 98.26:  70%|███████   | 14/20 [00:16<00:06,  1.12s/it]
Task 5, Epoch 15/20 => Loss 0.472, Train_accy 98.26:  75%|███████▌  | 15/20 [00:16<00:05,  1.11s/it]
Task 5, Epoch 16/20 => Loss 0.480, Train_accy 98.26:  75%|███████▌  | 15/20 [00:17<00:05,  1.11s/it]
Task 5, Epoch 16/20 => Loss 0.480, Train_accy 98.26:  80%|████████  | 16/20 [00:17<00:04,  1.12s/it]
Task 5, Epoch 17/20 => Loss 0.455, Train_accy 98.26:  80%|████████  | 16/20 [00:18<00:04,  1.12s/it]
Task 5, Epoch 17/20 => Loss 0.455, Train_accy 98.26:  85%|████████▌ | 17/20 [00:18<00:03,  1.10s/it]
Task 5, Epoch 18/20 => Loss 0.447, Train_accy 98.26:  85%|████████▌ | 17/20 [00:20<00:03,  1.10s/it]
Task 5, Epoch 18/20 => Loss 0.447, Train_accy 98.26:  90%|█████████ | 18/20 [00:20<00:02,  1.10s/it]
Task 5, Epoch 19/20 => Loss 0.445, Train_accy 98.26:  90%|█████████ | 18/20 [00:21<00:02,  1.10s/it]
Task 5, Epoch 19/20 => Loss 0.445, Train_accy 98.26:  95%|█████████▌| 19/20 [00:21<00:01,  1.14s/it]
Task 5, Epoch 20/20 => Loss 0.450, Train_accy 98.26:  95%|█████████▌| 19/20 [00:22<00:01,  1.14s/it]
Task 5, Epoch 20/20 => Loss 0.450, Train_accy 98.26: 100%|██████████| 20/20 [00:22<00:00,  1.19s/it]
Task 5, Epoch 20/20 => Loss 0.450, Train_accy 98.26: 100%|██████████| 20/20 [00:22<00:00,  1.13s/it]2024-09-14 23:36:01,334 [ease.py] => Task 5, Epoch 20/20 => Loss 0.450, Train_accy 98.26

2024-09-14 23:37:21,804 [ease.py] => Task correct: 91.00446428571429
2024-09-14 23:37:21,804 [ease.py] => Task acc: 96.29464285714286
2024-09-14 23:37:21,830 [trainer.py] => No NME accuracy.
2024-09-14 23:37:21,830 [trainer.py] => CNN: {'total': 88.66, '00-04': 88.11, '05-09': 97.96, '10-14': 91.01, '15-19': 88.93, '20-24': 81.59, '25-29': 94.44, 'old': 88.13, 'new': 94.44}
2024-09-14 23:37:21,830 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33, 94.45, 88.54, 88.66]
2024-09-14 23:37:21,830 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.68, 99.41, 99.42]

Average Accuracy (CNN): 94.17
2024-09-14 23:37:21,830 [trainer.py] => Average Accuracy (CNN): 94.17 

2024-09-14 23:37:21,831 [trainer.py] => All params: 86245058
2024-09-14 23:37:21,832 [trainer.py] => Trainable params: 304320
2024-09-14 23:37:21,835 [ease.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.562, Train_accy 35.63:   0%|          | 0/20 [00:01<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.562, Train_accy 35.63:   5%|▌         | 1/20 [00:01<00:25,  1.34s/it]
Task 6, Epoch 2/20 => Loss 1.338, Train_accy 78.74:   5%|▌         | 1/20 [00:02<00:25,  1.34s/it]
Task 6, Epoch 2/20 => Loss 1.338, Train_accy 78.74:  10%|█         | 2/20 [00:02<00:24,  1.36s/it]
Task 6, Epoch 3/20 => Loss 1.109, Train_accy 87.93:  10%|█         | 2/20 [00:04<00:24,  1.36s/it]
Task 6, Epoch 3/20 => Loss 1.109, Train_accy 87.93:  15%|█▌        | 3/20 [00:04<00:23,  1.39s/it]
Task 6, Epoch 4/20 => Loss 0.878, Train_accy 94.83:  15%|█▌        | 3/20 [00:05<00:23,  1.39s/it]
Task 6, Epoch 4/20 => Loss 0.878, Train_accy 94.83:  20%|██        | 4/20 [00:05<00:22,  1.40s/it]
Task 6, Epoch 5/20 => Loss 0.661, Train_accy 95.98:  20%|██        | 4/20 [00:06<00:22,  1.40s/it]
Task 6, Epoch 5/20 => Loss 0.661, Train_accy 95.98:  25%|██▌       | 5/20 [00:06<00:20,  1.36s/it]
Task 6, Epoch 6/20 => Loss 0.530, Train_accy 97.13:  25%|██▌       | 5/20 [00:08<00:20,  1.36s/it]
Task 6, Epoch 6/20 => Loss 0.530, Train_accy 97.13:  30%|███       | 6/20 [00:08<00:18,  1.33s/it]
Task 6, Epoch 7/20 => Loss 0.413, Train_accy 99.43:  30%|███       | 6/20 [00:09<00:18,  1.33s/it]
Task 6, Epoch 7/20 => Loss 0.413, Train_accy 99.43:  35%|███▌      | 7/20 [00:09<00:17,  1.31s/it]
Task 6, Epoch 8/20 => Loss 0.348, Train_accy 98.28:  35%|███▌      | 7/20 [00:10<00:17,  1.31s/it]
Task 6, Epoch 8/20 => Loss 0.348, Train_accy 98.28:  40%|████      | 8/20 [00:10<00:15,  1.30s/it]
Task 6, Epoch 9/20 => Loss 0.294, Train_accy 98.85:  40%|████      | 8/20 [00:12<00:15,  1.30s/it]
Task 6, Epoch 9/20 => Loss 0.294, Train_accy 98.85:  45%|████▌     | 9/20 [00:12<00:14,  1.31s/it]
Task 6, Epoch 10/20 => Loss 0.264, Train_accy 98.85:  45%|████▌     | 9/20 [00:13<00:14,  1.31s/it]
Task 6, Epoch 10/20 => Loss 0.264, Train_accy 98.85:  50%|█████     | 10/20 [00:13<00:13,  1.31s/it]
Task 6, Epoch 11/20 => Loss 0.238, Train_accy 99.43:  50%|█████     | 10/20 [00:14<00:13,  1.31s/it]
Task 6, Epoch 11/20 => Loss 0.238, Train_accy 99.43:  55%|█████▌    | 11/20 [00:14<00:11,  1.29s/it]
Task 6, Epoch 12/20 => Loss 0.212, Train_accy 98.85:  55%|█████▌    | 11/20 [00:15<00:11,  1.29s/it]
Task 6, Epoch 12/20 => Loss 0.212, Train_accy 98.85:  60%|██████    | 12/20 [00:15<00:10,  1.29s/it]
Task 6, Epoch 13/20 => Loss 0.196, Train_accy 99.43:  60%|██████    | 12/20 [00:17<00:10,  1.29s/it]
Task 6, Epoch 13/20 => Loss 0.196, Train_accy 99.43:  65%|██████▌   | 13/20 [00:17<00:09,  1.30s/it]
Task 6, Epoch 14/20 => Loss 0.184, Train_accy 100.00:  65%|██████▌   | 13/20 [00:18<00:09,  1.30s/it]
Task 6, Epoch 14/20 => Loss 0.184, Train_accy 100.00:  70%|███████   | 14/20 [00:18<00:07,  1.30s/it]
Task 6, Epoch 15/20 => Loss 0.190, Train_accy 99.43:  70%|███████   | 14/20 [00:19<00:07,  1.30s/it] 
Task 6, Epoch 15/20 => Loss 0.190, Train_accy 99.43:  75%|███████▌  | 15/20 [00:19<00:06,  1.30s/it]
Task 6, Epoch 16/20 => Loss 0.191, Train_accy 98.85:  75%|███████▌  | 15/20 [00:21<00:06,  1.30s/it]
Task 6, Epoch 16/20 => Loss 0.191, Train_accy 98.85:  80%|████████  | 16/20 [00:21<00:05,  1.29s/it]
Task 6, Epoch 17/20 => Loss 0.182, Train_accy 99.43:  80%|████████  | 16/20 [00:22<00:05,  1.29s/it]
Task 6, Epoch 17/20 => Loss 0.182, Train_accy 99.43:  85%|████████▌ | 17/20 [00:22<00:03,  1.30s/it]
Task 6, Epoch 18/20 => Loss 0.178, Train_accy 99.43:  85%|████████▌ | 17/20 [00:23<00:03,  1.30s/it]
Task 6, Epoch 18/20 => Loss 0.178, Train_accy 99.43:  90%|█████████ | 18/20 [00:23<00:02,  1.34s/it]
Task 6, Epoch 19/20 => Loss 0.163, Train_accy 100.00:  90%|█████████ | 18/20 [00:25<00:02,  1.34s/it]
Task 6, Epoch 19/20 => Loss 0.163, Train_accy 100.00:  95%|█████████▌| 19/20 [00:25<00:01,  1.33s/it]
Task 6, Epoch 20/20 => Loss 0.173, Train_accy 99.43:  95%|█████████▌| 19/20 [00:26<00:01,  1.33s/it] 
Task 6, Epoch 20/20 => Loss 0.173, Train_accy 99.43: 100%|██████████| 20/20 [00:26<00:00,  1.33s/it]
Task 6, Epoch 20/20 => Loss 0.173, Train_accy 99.43: 100%|██████████| 20/20 [00:26<00:00,  1.32s/it]2024-09-14 23:37:48,255 [ease.py] => Task 6, Epoch 20/20 => Loss 0.173, Train_accy 99.43

2024-09-14 23:39:39,062 [ease.py] => Task correct: 89.88848988848989
2024-09-14 23:39:39,063 [ease.py] => Task acc: 96.84369684369685
2024-09-14 23:39:39,088 [trainer.py] => No NME accuracy.
2024-09-14 23:39:39,088 [trainer.py] => CNN: {'total': 88.07, '00-04': 88.46, '05-09': 97.96, '10-14': 91.01, '15-19': 88.79, '20-24': 76.25, '25-29': 93.92, '30-34': 93.46, 'old': 87.1, 'new': 93.46}
2024-09-14 23:39:39,088 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33, 94.45, 88.54, 88.66, 88.07]
2024-09-14 23:39:39,088 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.68, 99.41, 99.42, 99.17]

Average Accuracy (CNN): 93.3
2024-09-14 23:39:39,088 [trainer.py] => Average Accuracy (CNN): 93.3 

2024-09-14 23:39:39,089 [trainer.py] => All params: 86294978
2024-09-14 23:39:39,090 [trainer.py] => Trainable params: 304320
2024-09-14 23:39:39,092 [ease.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.588, Train_accy 41.86:   0%|          | 0/20 [00:01<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.588, Train_accy 41.86:   5%|▌         | 1/20 [00:01<00:20,  1.07s/it]
Task 7, Epoch 2/20 => Loss 1.518, Train_accy 80.62:   5%|▌         | 1/20 [00:02<00:20,  1.07s/it]
Task 7, Epoch 2/20 => Loss 1.518, Train_accy 80.62:  10%|█         | 2/20 [00:02<00:19,  1.10s/it]
Task 7, Epoch 3/20 => Loss 1.404, Train_accy 79.84:  10%|█         | 2/20 [00:03<00:19,  1.10s/it]
Task 7, Epoch 3/20 => Loss 1.404, Train_accy 79.84:  15%|█▌        | 3/20 [00:03<00:18,  1.09s/it]
Task 7, Epoch 4/20 => Loss 1.263, Train_accy 84.50:  15%|█▌        | 3/20 [00:04<00:18,  1.09s/it]
Task 7, Epoch 4/20 => Loss 1.263, Train_accy 84.50:  20%|██        | 4/20 [00:04<00:17,  1.09s/it]
Task 7, Epoch 5/20 => Loss 1.122, Train_accy 89.15:  20%|██        | 4/20 [00:05<00:17,  1.09s/it]
Task 7, Epoch 5/20 => Loss 1.122, Train_accy 89.15:  25%|██▌       | 5/20 [00:05<00:16,  1.10s/it]
Task 7, Epoch 6/20 => Loss 0.997, Train_accy 87.60:  25%|██▌       | 5/20 [00:06<00:16,  1.10s/it]
Task 7, Epoch 6/20 => Loss 0.997, Train_accy 87.60:  30%|███       | 6/20 [00:06<00:15,  1.10s/it]
Task 7, Epoch 7/20 => Loss 0.869, Train_accy 87.60:  30%|███       | 6/20 [00:07<00:15,  1.10s/it]
Task 7, Epoch 7/20 => Loss 0.869, Train_accy 87.60:  35%|███▌      | 7/20 [00:07<00:14,  1.11s/it]
Task 7, Epoch 8/20 => Loss 0.769, Train_accy 90.70:  35%|███▌      | 7/20 [00:08<00:14,  1.11s/it]
Task 7, Epoch 8/20 => Loss 0.769, Train_accy 90.70:  40%|████      | 8/20 [00:08<00:13,  1.12s/it]
Task 7, Epoch 9/20 => Loss 0.707, Train_accy 92.25:  40%|████      | 8/20 [00:09<00:13,  1.12s/it]
Task 7, Epoch 9/20 => Loss 0.707, Train_accy 92.25:  45%|████▌     | 9/20 [00:09<00:12,  1.12s/it]
Task 7, Epoch 10/20 => Loss 0.605, Train_accy 93.80:  45%|████▌     | 9/20 [00:11<00:12,  1.12s/it]
Task 7, Epoch 10/20 => Loss 0.605, Train_accy 93.80:  50%|█████     | 10/20 [00:11<00:11,  1.14s/it]
Task 7, Epoch 11/20 => Loss 0.559, Train_accy 97.67:  50%|█████     | 10/20 [00:12<00:11,  1.14s/it]
Task 7, Epoch 11/20 => Loss 0.559, Train_accy 97.67:  55%|█████▌    | 11/20 [00:12<00:10,  1.14s/it]
Task 7, Epoch 12/20 => Loss 0.509, Train_accy 95.35:  55%|█████▌    | 11/20 [00:13<00:10,  1.14s/it]
Task 7, Epoch 12/20 => Loss 0.509, Train_accy 95.35:  60%|██████    | 12/20 [00:13<00:09,  1.16s/it]
Task 7, Epoch 13/20 => Loss 0.505, Train_accy 99.22:  60%|██████    | 12/20 [00:14<00:09,  1.16s/it]
Task 7, Epoch 13/20 => Loss 0.505, Train_accy 99.22:  65%|██████▌   | 13/20 [00:14<00:08,  1.18s/it]
Task 7, Epoch 14/20 => Loss 0.486, Train_accy 97.67:  65%|██████▌   | 13/20 [00:15<00:08,  1.18s/it]
Task 7, Epoch 14/20 => Loss 0.486, Train_accy 97.67:  70%|███████   | 14/20 [00:15<00:06,  1.17s/it]
Task 7, Epoch 15/20 => Loss 0.474, Train_accy 96.90:  70%|███████   | 14/20 [00:16<00:06,  1.17s/it]
Task 7, Epoch 15/20 => Loss 0.474, Train_accy 96.90:  75%|███████▌  | 15/20 [00:16<00:05,  1.15s/it]
Task 7, Epoch 16/20 => Loss 0.460, Train_accy 96.12:  75%|███████▌  | 15/20 [00:18<00:05,  1.15s/it]
Task 7, Epoch 16/20 => Loss 0.460, Train_accy 96.12:  80%|████████  | 16/20 [00:18<00:04,  1.17s/it]
Task 7, Epoch 17/20 => Loss 0.459, Train_accy 98.45:  80%|████████  | 16/20 [00:19<00:04,  1.17s/it]
Task 7, Epoch 17/20 => Loss 0.459, Train_accy 98.45:  85%|████████▌ | 17/20 [00:19<00:03,  1.17s/it]
Task 7, Epoch 18/20 => Loss 0.445, Train_accy 99.22:  85%|████████▌ | 17/20 [00:20<00:03,  1.17s/it]
Task 7, Epoch 18/20 => Loss 0.445, Train_accy 99.22:  90%|█████████ | 18/20 [00:20<00:02,  1.17s/it]
Task 7, Epoch 19/20 => Loss 0.448, Train_accy 99.22:  90%|█████████ | 18/20 [00:21<00:02,  1.17s/it]
Task 7, Epoch 19/20 => Loss 0.448, Train_accy 99.22:  95%|█████████▌| 19/20 [00:21<00:01,  1.18s/it]
Task 7, Epoch 20/20 => Loss 0.465, Train_accy 96.90:  95%|█████████▌| 19/20 [00:22<00:01,  1.18s/it]
Task 7, Epoch 20/20 => Loss 0.465, Train_accy 96.90: 100%|██████████| 20/20 [00:22<00:00,  1.18s/it]
Task 7, Epoch 20/20 => Loss 0.465, Train_accy 96.90: 100%|██████████| 20/20 [00:22<00:00,  1.15s/it]2024-09-14 23:40:02,028 [ease.py] => Task 7, Epoch 20/20 => Loss 0.465, Train_accy 96.90

2024-09-14 23:42:18,468 [ease.py] => Task correct: 89.19720767888307
2024-09-14 23:42:18,469 [ease.py] => Task acc: 96.9458987783595
2024-09-14 23:42:18,492 [trainer.py] => No NME accuracy.
2024-09-14 23:42:18,492 [trainer.py] => CNN: {'total': 87.54, '00-04': 88.46, '05-09': 96.11, '10-14': 91.01, '15-19': 88.22, '20-24': 74.66, '25-29': 93.39, '30-34': 93.34, '35-39': 90.43, 'old': 87.3, 'new': 90.43}
2024-09-14 23:42:18,492 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33, 94.45, 88.54, 88.66, 88.07, 87.54]
2024-09-14 23:42:18,492 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.68, 99.41, 99.42, 99.17, 98.95]

Average Accuracy (CNN): 92.58
2024-09-14 23:42:18,492 [trainer.py] => Average Accuracy (CNN): 92.58 

2024-09-14 23:42:18,493 [trainer.py] => All params: 86352578
2024-09-14 23:42:18,494 [trainer.py] => Trainable params: 304320
2024-09-14 23:42:18,497 [ease.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.523, Train_accy 48.11:   0%|          | 0/20 [00:01<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.523, Train_accy 48.11:   5%|▌         | 1/20 [00:01<00:35,  1.88s/it]
Task 8, Epoch 2/20 => Loss 1.129, Train_accy 73.88:   5%|▌         | 1/20 [00:03<00:35,  1.88s/it]
Task 8, Epoch 2/20 => Loss 1.129, Train_accy 73.88:  10%|█         | 2/20 [00:03<00:34,  1.90s/it]
Task 8, Epoch 3/20 => Loss 0.868, Train_accy 75.60:  10%|█         | 2/20 [00:05<00:34,  1.90s/it]
Task 8, Epoch 3/20 => Loss 0.868, Train_accy 75.60:  15%|█▌        | 3/20 [00:05<00:32,  1.89s/it]
Task 8, Epoch 4/20 => Loss 0.722, Train_accy 81.79:  15%|█▌        | 3/20 [00:07<00:32,  1.89s/it]
Task 8, Epoch 4/20 => Loss 0.722, Train_accy 81.79:  20%|██        | 4/20 [00:07<00:30,  1.92s/it]
Task 8, Epoch 5/20 => Loss 0.493, Train_accy 91.07:  20%|██        | 4/20 [00:09<00:30,  1.92s/it]
Task 8, Epoch 5/20 => Loss 0.493, Train_accy 91.07:  25%|██▌       | 5/20 [00:09<00:28,  1.91s/it]
Task 8, Epoch 6/20 => Loss 0.419, Train_accy 94.16:  25%|██▌       | 5/20 [00:11<00:28,  1.91s/it]
Task 8, Epoch 6/20 => Loss 0.419, Train_accy 94.16:  30%|███       | 6/20 [00:11<00:27,  1.93s/it]
Task 8, Epoch 7/20 => Loss 0.380, Train_accy 94.50:  30%|███       | 6/20 [00:13<00:27,  1.93s/it]
Task 8, Epoch 7/20 => Loss 0.380, Train_accy 94.50:  35%|███▌      | 7/20 [00:13<00:24,  1.92s/it]
Task 8, Epoch 8/20 => Loss 0.291, Train_accy 94.85:  35%|███▌      | 7/20 [00:15<00:24,  1.92s/it]
Task 8, Epoch 8/20 => Loss 0.291, Train_accy 94.85:  40%|████      | 8/20 [00:15<00:23,  1.94s/it]
Task 8, Epoch 9/20 => Loss 0.275, Train_accy 94.85:  40%|████      | 8/20 [00:17<00:23,  1.94s/it]
Task 8, Epoch 9/20 => Loss 0.275, Train_accy 94.85:  45%|████▌     | 9/20 [00:17<00:21,  1.94s/it]
Task 8, Epoch 10/20 => Loss 0.260, Train_accy 95.53:  45%|████▌     | 9/20 [00:19<00:21,  1.94s/it]
Task 8, Epoch 10/20 => Loss 0.260, Train_accy 95.53:  50%|█████     | 10/20 [00:19<00:19,  1.95s/it]
Task 8, Epoch 11/20 => Loss 0.242, Train_accy 96.91:  50%|█████     | 10/20 [00:21<00:19,  1.95s/it]
Task 8, Epoch 11/20 => Loss 0.242, Train_accy 96.91:  55%|█████▌    | 11/20 [00:21<00:17,  1.94s/it]
Task 8, Epoch 12/20 => Loss 0.234, Train_accy 96.56:  55%|█████▌    | 11/20 [00:23<00:17,  1.94s/it]
Task 8, Epoch 12/20 => Loss 0.234, Train_accy 96.56:  60%|██████    | 12/20 [00:23<00:15,  1.93s/it]
Task 8, Epoch 13/20 => Loss 0.290, Train_accy 95.88:  60%|██████    | 12/20 [00:25<00:15,  1.93s/it]
Task 8, Epoch 13/20 => Loss 0.290, Train_accy 95.88:  65%|██████▌   | 13/20 [00:25<00:13,  1.93s/it]
Task 8, Epoch 14/20 => Loss 0.199, Train_accy 97.25:  65%|██████▌   | 13/20 [00:26<00:13,  1.93s/it]
Task 8, Epoch 14/20 => Loss 0.199, Train_accy 97.25:  70%|███████   | 14/20 [00:26<00:11,  1.91s/it]
Task 8, Epoch 15/20 => Loss 0.241, Train_accy 96.22:  70%|███████   | 14/20 [00:28<00:11,  1.91s/it]
Task 8, Epoch 15/20 => Loss 0.241, Train_accy 96.22:  75%|███████▌  | 15/20 [00:28<00:09,  1.93s/it]
Task 8, Epoch 16/20 => Loss 0.206, Train_accy 96.56:  75%|███████▌  | 15/20 [00:30<00:09,  1.93s/it]
Task 8, Epoch 16/20 => Loss 0.206, Train_accy 96.56:  80%|████████  | 16/20 [00:30<00:07,  1.99s/it]
Task 8, Epoch 17/20 => Loss 0.201, Train_accy 97.59:  80%|████████  | 16/20 [00:33<00:07,  1.99s/it]
Task 8, Epoch 17/20 => Loss 0.201, Train_accy 97.59:  85%|████████▌ | 17/20 [00:33<00:06,  2.01s/it]
Task 8, Epoch 18/20 => Loss 0.215, Train_accy 98.63:  85%|████████▌ | 17/20 [00:35<00:06,  2.01s/it]
Task 8, Epoch 18/20 => Loss 0.215, Train_accy 98.63:  90%|█████████ | 18/20 [00:35<00:04,  2.02s/it]
Task 8, Epoch 19/20 => Loss 0.226, Train_accy 95.53:  90%|█████████ | 18/20 [00:37<00:04,  2.02s/it]
Task 8, Epoch 19/20 => Loss 0.226, Train_accy 95.53:  95%|█████████▌| 19/20 [00:37<00:02,  2.02s/it]
Task 8, Epoch 20/20 => Loss 0.231, Train_accy 96.56:  95%|█████████▌| 19/20 [00:39<00:02,  2.02s/it]
Task 8, Epoch 20/20 => Loss 0.231, Train_accy 96.56: 100%|██████████| 20/20 [00:39<00:00,  2.03s/it]
Task 8, Epoch 20/20 => Loss 0.231, Train_accy 96.56: 100%|██████████| 20/20 [00:39<00:00,  1.96s/it]2024-09-14 23:42:57,674 [ease.py] => Task 8, Epoch 20/20 => Loss 0.231, Train_accy 96.56

2024-09-14 23:46:10,691 [ease.py] => Task correct: 87.93269893807751
2024-09-14 23:46:10,692 [ease.py] => Task acc: 96.96593573300234
2024-09-14 23:46:10,721 [trainer.py] => No NME accuracy.
2024-09-14 23:46:10,721 [trainer.py] => CNN: {'total': 86.5, '00-04': 88.46, '05-09': 96.11, '10-14': 88.89, '15-19': 87.65, '20-24': 72.11, '25-29': 92.86, '30-34': 93.22, '35-39': 89.98, '40-44': 86.39, 'old': 86.53, 'new': 86.39}
2024-09-14 23:46:10,721 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33, 94.45, 88.54, 88.66, 88.07, 87.54, 86.5]
2024-09-14 23:46:10,721 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.68, 99.41, 99.42, 99.17, 98.95, 98.8]

Average Accuracy (CNN): 91.9
2024-09-14 23:46:10,721 [trainer.py] => Average Accuracy (CNN): 91.9 

2024-09-14 23:46:10,722 [trainer.py] => All params: 86417858
2024-09-14 23:46:10,723 [trainer.py] => Trainable params: 304320
2024-09-14 23:46:10,728 [ease.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.491, Train_accy 75.19:   0%|          | 0/20 [00:01<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.491, Train_accy 75.19:   5%|▌         | 1/20 [00:01<00:35,  1.87s/it]
Task 9, Epoch 2/20 => Loss 1.147, Train_accy 77.48:   5%|▌         | 1/20 [00:03<00:35,  1.87s/it]
Task 9, Epoch 2/20 => Loss 1.147, Train_accy 77.48:  10%|█         | 2/20 [00:03<00:32,  1.82s/it]
Task 9, Epoch 3/20 => Loss 0.818, Train_accy 81.30:  10%|█         | 2/20 [00:05<00:32,  1.82s/it]
Task 9, Epoch 3/20 => Loss 0.818, Train_accy 81.30:  15%|█▌        | 3/20 [00:05<00:30,  1.81s/it]
Task 9, Epoch 4/20 => Loss 0.613, Train_accy 84.35:  15%|█▌        | 3/20 [00:07<00:30,  1.81s/it]
Task 9, Epoch 4/20 => Loss 0.613, Train_accy 84.35:  20%|██        | 4/20 [00:07<00:29,  1.84s/it]
Task 9, Epoch 5/20 => Loss 0.474, Train_accy 89.69:  20%|██        | 4/20 [00:09<00:29,  1.84s/it]
Task 9, Epoch 5/20 => Loss 0.474, Train_accy 89.69:  25%|██▌       | 5/20 [00:09<00:28,  1.90s/it]
Task 9, Epoch 6/20 => Loss 0.359, Train_accy 95.42:  25%|██▌       | 5/20 [00:11<00:28,  1.90s/it]
Task 9, Epoch 6/20 => Loss 0.359, Train_accy 95.42:  30%|███       | 6/20 [00:11<00:26,  1.90s/it]
Task 9, Epoch 7/20 => Loss 0.297, Train_accy 97.33:  30%|███       | 6/20 [00:13<00:26,  1.90s/it]
Task 9, Epoch 7/20 => Loss 0.297, Train_accy 97.33:  35%|███▌      | 7/20 [00:13<00:25,  1.93s/it]
Task 9, Epoch 8/20 => Loss 0.272, Train_accy 96.18:  35%|███▌      | 7/20 [00:15<00:25,  1.93s/it]
Task 9, Epoch 8/20 => Loss 0.272, Train_accy 96.18:  40%|████      | 8/20 [00:15<00:22,  1.90s/it]
Task 9, Epoch 9/20 => Loss 0.231, Train_accy 98.09:  40%|████      | 8/20 [00:16<00:22,  1.90s/it]
Task 9, Epoch 9/20 => Loss 0.231, Train_accy 98.09:  45%|████▌     | 9/20 [00:16<00:20,  1.88s/it]
Task 9, Epoch 10/20 => Loss 0.218, Train_accy 96.95:  45%|████▌     | 9/20 [00:18<00:20,  1.88s/it]
Task 9, Epoch 10/20 => Loss 0.218, Train_accy 96.95:  50%|█████     | 10/20 [00:18<00:18,  1.88s/it]
Task 9, Epoch 11/20 => Loss 0.211, Train_accy 97.71:  50%|█████     | 10/20 [00:20<00:18,  1.88s/it]
Task 9, Epoch 11/20 => Loss 0.211, Train_accy 97.71:  55%|█████▌    | 11/20 [00:20<00:16,  1.83s/it]
Task 9, Epoch 12/20 => Loss 0.214, Train_accy 96.95:  55%|█████▌    | 11/20 [00:22<00:16,  1.83s/it]
Task 9, Epoch 12/20 => Loss 0.214, Train_accy 96.95:  60%|██████    | 12/20 [00:22<00:14,  1.80s/it]
Task 9, Epoch 13/20 => Loss 0.187, Train_accy 98.09:  60%|██████    | 12/20 [00:23<00:14,  1.80s/it]
Task 9, Epoch 13/20 => Loss 0.187, Train_accy 98.09:  65%|██████▌   | 13/20 [00:23<00:12,  1.77s/it]
Task 9, Epoch 14/20 => Loss 0.175, Train_accy 98.47:  65%|██████▌   | 13/20 [00:25<00:12,  1.77s/it]
Task 9, Epoch 14/20 => Loss 0.175, Train_accy 98.47:  70%|███████   | 14/20 [00:25<00:10,  1.75s/it]
Task 9, Epoch 15/20 => Loss 0.180, Train_accy 97.71:  70%|███████   | 14/20 [00:27<00:10,  1.75s/it]
Task 9, Epoch 15/20 => Loss 0.180, Train_accy 97.71:  75%|███████▌  | 15/20 [00:27<00:08,  1.74s/it]
Task 9, Epoch 16/20 => Loss 0.194, Train_accy 96.95:  75%|███████▌  | 15/20 [00:29<00:08,  1.74s/it]
Task 9, Epoch 16/20 => Loss 0.194, Train_accy 96.95:  80%|████████  | 16/20 [00:29<00:06,  1.75s/it]
Task 9, Epoch 17/20 => Loss 0.195, Train_accy 96.95:  80%|████████  | 16/20 [00:30<00:06,  1.75s/it]
Task 9, Epoch 17/20 => Loss 0.195, Train_accy 96.95:  85%|████████▌ | 17/20 [00:30<00:05,  1.77s/it]
Task 9, Epoch 18/20 => Loss 0.182, Train_accy 96.18:  85%|████████▌ | 17/20 [00:32<00:05,  1.77s/it]
Task 9, Epoch 18/20 => Loss 0.182, Train_accy 96.18:  90%|█████████ | 18/20 [00:32<00:03,  1.77s/it]
Task 9, Epoch 19/20 => Loss 0.191, Train_accy 97.71:  90%|█████████ | 18/20 [00:34<00:03,  1.77s/it]
Task 9, Epoch 19/20 => Loss 0.191, Train_accy 97.71:  95%|█████████▌| 19/20 [00:34<00:01,  1.78s/it]
Task 9, Epoch 20/20 => Loss 0.174, Train_accy 97.33:  95%|█████████▌| 19/20 [00:36<00:01,  1.78s/it]
Task 9, Epoch 20/20 => Loss 0.174, Train_accy 97.33: 100%|██████████| 20/20 [00:36<00:00,  1.78s/it]
Task 9, Epoch 20/20 => Loss 0.174, Train_accy 97.33: 100%|██████████| 20/20 [00:36<00:00,  1.81s/it]2024-09-14 23:46:47,026 [ease.py] => Task 9, Epoch 20/20 => Loss 0.174, Train_accy 97.33

2024-09-14 23:51:00,007 [ease.py] => Task correct: 84.73140735584174
2024-09-14 23:51:00,008 [ease.py] => Task acc: 97.27346559925745
2024-09-14 23:51:00,036 [trainer.py] => No NME accuracy.
2024-09-14 23:51:00,036 [trainer.py] => CNN: {'total': 83.56, '00-04': 88.46, '05-09': 95.93, '10-14': 84.8, '15-19': 86.44, '20-24': 68.76, '25-29': 92.86, '30-34': 93.09, '35-39': 88.84, '40-44': 82.97, '45-49': 78.44, 'old': 84.53, 'new': 78.44}
2024-09-14 23:51:00,036 [trainer.py] => CNN top1 curve: [96.5, 98.55, 98.33, 94.45, 88.54, 88.66, 88.07, 87.54, 86.5, 83.56]
2024-09-14 23:51:00,036 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.68, 99.41, 99.42, 99.17, 98.95, 98.8, 98.31]

Average Accuracy (CNN): 91.07
2024-09-14 23:51:00,036 [trainer.py] => Average Accuracy (CNN): 91.07 

Accuracy Matrix (CNN):
[[ 96.5   95.8   94.06  93.71  92.66  88.11  88.46  88.46  88.46  88.46]
 [  0.   100.   100.   100.    97.96  97.96  97.96  96.11  96.11  95.93]
 [  0.     0.    98.86  97.71  91.18  91.01  91.01  91.01  88.89  84.8 ]
 [  0.     0.     0.    91.06  89.    88.93  88.79  88.22  87.65  86.44]
 [  0.     0.     0.     0.    81.75  81.59  76.25  74.66  72.11  68.76]
 [  0.     0.     0.     0.     0.    94.44  93.92  93.39  92.86  92.86]
 [  0.     0.     0.     0.     0.     0.    93.46  93.34  93.22  93.09]
 [  0.     0.     0.     0.     0.     0.     0.    90.43  89.98  88.84]
 [  0.     0.     0.     0.     0.     0.     0.     0.    86.39  82.97]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    78.44]]
2024-09-14 23:51:00,038 [trainer.py] => Forgetting (CNN): 5.637777777777777
