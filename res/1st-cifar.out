nohup: 忽略输入
2024-09-12 08:18:10,979 [trainer.py] => config: ./exps/finetune_cifar_B0_Inc5.json
2024-09-12 08:18:10,994 [trainer.py] => prefix: reproduce
2024-09-12 08:18:10,994 [trainer.py] => dataset: cifar224
2024-09-12 08:18:10,994 [trainer.py] => memory_size: 0
2024-09-12 08:18:10,994 [trainer.py] => memory_per_class: 0
2024-09-12 08:18:10,994 [trainer.py] => fixed_memory: False
2024-09-12 08:18:10,994 [trainer.py] => shuffle: Trues
2024-09-12 08:18:10,994 [trainer.py] => init_cls: 20
2024-09-12 08:18:10,994 [trainer.py] => increment: 20
2024-09-12 08:18:10,994 [trainer.py] => model_name: finetune
2024-09-12 08:18:10,994 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 08:18:10,994 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 08:18:10,994 [trainer.py] => seed: 1993
2024-09-12 08:18:10,994 [trainer.py] => init_epoch: 20
2024-09-12 08:18:10,994 [trainer.py] => init_lr: 0.001
2024-09-12 08:18:10,994 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 08:18:10,994 [trainer.py] => init_lr_decay: 0.1
2024-09-12 08:18:10,995 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 08:18:10,995 [trainer.py] => epochs: 20
2024-09-12 08:18:10,995 [trainer.py] => lrate: 0.001
2024-09-12 08:18:10,995 [trainer.py] => milestones: [40, 70]
2024-09-12 08:18:10,995 [trainer.py] => lrate_decay: 0.1
2024-09-12 08:18:10,995 [trainer.py] => batch_size: 48
2024-09-12 08:18:10,995 [trainer.py] => weight_decay: 0.0002
2024-09-12 08:18:12,389 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 08:18:14,406 [trainer.py] => All params: 85798656
2024-09-12 08:18:14,406 [trainer.py] => Trainable params: 85798656
2024-09-12 08:18:14,407 [finetune.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.628, Train_accy 21.14, Test_accy 79.20:   0%|          | 0/20 [01:29<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.628, Train_accy 21.14, Test_accy 79.20:   5%|▌         | 1/20 [01:29<28:11, 89.02s/it]
Task 0, Epoch 2/20 => Loss 0.791, Train_accy 75.96:   5%|▌         | 1/20 [02:52<28:11, 89.02s/it]                 
Task 0, Epoch 2/20 => Loss 0.791, Train_accy 75.96:  10%|█         | 2/20 [02:52<25:39, 85.54s/it]
Task 0, Epoch 3/20 => Loss 0.556, Train_accy 83.36:  10%|█         | 2/20 [04:15<25:39, 85.54s/it]
Task 0, Epoch 3/20 => Loss 0.556, Train_accy 83.36:  15%|█▌        | 3/20 [04:15<23:58, 84.65s/it]
Task 0, Epoch 4/20 => Loss 0.481, Train_accy 85.79:  15%|█▌        | 3/20 [05:39<23:58, 84.65s/it]
Task 0, Epoch 4/20 => Loss 0.481, Train_accy 85.79:  20%|██        | 4/20 [05:39<22:29, 84.34s/it]
Task 0, Epoch 5/20 => Loss 0.430, Train_accy 87.03:  20%|██        | 4/20 [07:03<22:29, 84.34s/it]
Task 0, Epoch 5/20 => Loss 0.430, Train_accy 87.03:  25%|██▌       | 5/20 [07:03<21:03, 84.22s/it]
Task 0, Epoch 6/20 => Loss 0.428, Train_accy 86.95, Test_accy 95.90:  25%|██▌       | 5/20 [08:33<21:03, 84.22s/it]
Task 0, Epoch 6/20 => Loss 0.428, Train_accy 86.95, Test_accy 95.90:  30%|███       | 6/20 [08:33<20:07, 86.22s/it]
Task 0, Epoch 7/20 => Loss 0.394, Train_accy 88.03:  30%|███       | 6/20 [09:57<20:07, 86.22s/it]                 
Task 0, Epoch 7/20 => Loss 0.394, Train_accy 88.03:  35%|███▌      | 7/20 [09:57<18:32, 85.54s/it]
Task 0, Epoch 8/20 => Loss 0.372, Train_accy 88.84:  35%|███▌      | 7/20 [11:21<18:32, 85.54s/it]
Task 0, Epoch 8/20 => Loss 0.372, Train_accy 88.84:  40%|████      | 8/20 [11:21<17:00, 85.03s/it]
Task 0, Epoch 9/20 => Loss 0.345, Train_accy 89.63:  40%|████      | 8/20 [12:45<17:00, 85.03s/it]
Task 0, Epoch 9/20 => Loss 0.345, Train_accy 89.63:  45%|████▌     | 9/20 [12:45<15:31, 84.70s/it]
Task 0, Epoch 10/20 => Loss 0.332, Train_accy 90.20:  45%|████▌     | 9/20 [14:09<15:31, 84.70s/it]
Task 0, Epoch 10/20 => Loss 0.332, Train_accy 90.20:  50%|█████     | 10/20 [14:09<14:04, 84.44s/it]
Task 0, Epoch 11/20 => Loss 0.326, Train_accy 89.89, Test_accy 95.65:  50%|█████     | 10/20 [15:40<14:04, 84.44s/it]
Task 0, Epoch 11/20 => Loss 0.326, Train_accy 89.89, Test_accy 95.65:  55%|█████▌    | 11/20 [15:40<12:57, 86.34s/it]
Task 0, Epoch 12/20 => Loss 0.308, Train_accy 90.79:  55%|█████▌    | 11/20 [17:04<12:57, 86.34s/it]                 
Task 0, Epoch 12/20 => Loss 0.308, Train_accy 90.79:  60%|██████    | 12/20 [17:04<11:26, 85.76s/it]
Task 0, Epoch 13/20 => Loss 0.304, Train_accy 90.60:  60%|██████    | 12/20 [18:28<11:26, 85.76s/it]
Task 0, Epoch 13/20 => Loss 0.304, Train_accy 90.60:  65%|██████▌   | 13/20 [18:28<09:56, 85.25s/it]
Task 0, Epoch 14/20 => Loss 0.299, Train_accy 91.02:  65%|██████▌   | 13/20 [19:52<09:56, 85.25s/it]
Task 0, Epoch 14/20 => Loss 0.299, Train_accy 91.02:  70%|███████   | 14/20 [19:52<08:29, 84.85s/it]
Task 0, Epoch 15/20 => Loss 0.307, Train_accy 90.88:  70%|███████   | 14/20 [21:16<08:29, 84.85s/it]
Task 0, Epoch 15/20 => Loss 0.307, Train_accy 90.88:  75%|███████▌  | 15/20 [21:16<07:02, 84.56s/it]
Task 0, Epoch 16/20 => Loss 0.305, Train_accy 91.07, Test_accy 96.45:  75%|███████▌  | 15/20 [22:47<07:02, 84.56s/it]
Task 0, Epoch 16/20 => Loss 0.305, Train_accy 91.07, Test_accy 96.45:  80%|████████  | 16/20 [22:47<05:45, 86.34s/it]
Task 0, Epoch 17/20 => Loss 0.286, Train_accy 91.45:  80%|████████  | 16/20 [24:11<05:45, 86.34s/it]                 
Task 0, Epoch 17/20 => Loss 0.286, Train_accy 91.45:  85%|████████▌ | 17/20 [24:11<04:16, 85.64s/it]
Task 0, Epoch 18/20 => Loss 0.281, Train_accy 91.35:  85%|████████▌ | 17/20 [25:35<04:16, 85.64s/it]
Task 0, Epoch 18/20 => Loss 0.281, Train_accy 91.35:  90%|█████████ | 18/20 [25:35<02:50, 85.14s/it]
Task 0, Epoch 19/20 => Loss 0.273, Train_accy 91.93:  90%|█████████ | 18/20 [26:59<02:50, 85.14s/it]
Task 0, Epoch 19/20 => Loss 0.273, Train_accy 91.93:  95%|█████████▌| 19/20 [26:59<01:24, 84.84s/it]
Task 0, Epoch 20/20 => Loss 0.273, Train_accy 91.81:  95%|█████████▌| 19/20 [28:23<01:24, 84.84s/it]
Task 0, Epoch 20/20 => Loss 0.273, Train_accy 91.81: 100%|██████████| 20/20 [28:23<00:00, 84.58s/it]
Task 0, Epoch 20/20 => Loss 0.273, Train_accy 91.81: 100%|██████████| 20/20 [28:23<00:00, 85.16s/it]
2024-09-12 08:46:38,013 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.273, Train_accy 91.81
2024-09-12 08:46:44,511 [trainer.py] => No NME accuracy.
2024-09-12 08:46:44,512 [trainer.py] => CNN: {'total': 95.7, '00-19': 95.7, 'old': 0, 'new': 95.7}
2024-09-12 08:46:44,512 [trainer.py] => CNN top1 curve: [95.7]
2024-09-12 08:46:44,512 [trainer.py] => CNN top5 curve: [99.4]

Average Accuracy (CNN): 95.7
2024-09-12 08:46:44,512 [trainer.py] => Average Accuracy (CNN): 95.7 

2024-09-12 08:46:44,514 [trainer.py] => All params: 85814036
2024-09-12 08:46:44,515 [trainer.py] => Trainable params: 85814036
2024-09-12 08:46:44,516 [finetune.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.667, Train_accy 55.09, Test_accy 87.10:   0%|          | 0/20 [01:37<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.667, Train_accy 55.09, Test_accy 87.10:   5%|▌         | 1/20 [01:37<30:49, 97.35s/it]
Task 1, Epoch 2/20 => Loss 0.373, Train_accy 76.68:   5%|▌         | 1/20 [03:01<30:49, 97.35s/it]                 
Task 1, Epoch 2/20 => Loss 0.373, Train_accy 76.68:  10%|█         | 2/20 [03:01<26:53, 89.66s/it]
Task 1, Epoch 3/20 => Loss 0.341, Train_accy 81.46:  10%|█         | 2/20 [04:25<26:53, 89.66s/it]
Task 1, Epoch 3/20 => Loss 0.341, Train_accy 81.46:  15%|█▌        | 3/20 [04:25<24:41, 87.15s/it]
Task 1, Epoch 4/20 => Loss 0.303, Train_accy 84.13:  15%|█▌        | 3/20 [05:49<24:41, 87.15s/it]
Task 1, Epoch 4/20 => Loss 0.303, Train_accy 84.13:  20%|██        | 4/20 [05:49<22:55, 85.99s/it]
Task 1, Epoch 5/20 => Loss 0.303, Train_accy 86.13:  20%|██        | 4/20 [07:13<22:55, 85.99s/it]
Task 1, Epoch 5/20 => Loss 0.303, Train_accy 86.13:  25%|██▌       | 5/20 [07:13<21:17, 85.20s/it]
Task 1, Epoch 6/20 => Loss 0.280, Train_accy 87.57, Test_accy 90.32:  25%|██▌       | 5/20 [08:50<21:17, 85.20s/it]
Task 1, Epoch 6/20 => Loss 0.280, Train_accy 87.57, Test_accy 90.32:  30%|███       | 6/20 [08:50<20:46, 89.03s/it]
Task 1, Epoch 7/20 => Loss 0.274, Train_accy 88.50:  30%|███       | 6/20 [10:14<20:46, 89.03s/it]                 
Task 1, Epoch 7/20 => Loss 0.274, Train_accy 88.50:  35%|███▌      | 7/20 [10:14<18:56, 87.41s/it]
Task 1, Epoch 8/20 => Loss 0.274, Train_accy 89.04:  35%|███▌      | 7/20 [11:38<18:56, 87.41s/it]
Task 1, Epoch 8/20 => Loss 0.274, Train_accy 89.04:  40%|████      | 8/20 [11:38<17:16, 86.36s/it]
Task 1, Epoch 9/20 => Loss 0.252, Train_accy 89.85:  40%|████      | 8/20 [13:02<17:16, 86.36s/it]
Task 1, Epoch 9/20 => Loss 0.252, Train_accy 89.85:  45%|████▌     | 9/20 [13:02<15:41, 85.63s/it]
Task 1, Epoch 10/20 => Loss 0.237, Train_accy 90.85:  45%|████▌     | 9/20 [14:25<15:41, 85.63s/it]
Task 1, Epoch 10/20 => Loss 0.237, Train_accy 90.85:  50%|█████     | 10/20 [14:25<14:07, 84.72s/it]
Task 1, Epoch 11/20 => Loss 0.240, Train_accy 90.60, Test_accy 88.00:  50%|█████     | 10/20 [15:59<14:07, 84.72s/it]
Task 1, Epoch 11/20 => Loss 0.240, Train_accy 90.60, Test_accy 88.00:  55%|█████▌    | 11/20 [15:59<13:07, 87.53s/it]
Task 1, Epoch 12/20 => Loss 0.237, Train_accy 90.96:  55%|█████▌    | 11/20 [17:20<13:07, 87.53s/it]                 
Task 1, Epoch 12/20 => Loss 0.237, Train_accy 90.96:  60%|██████    | 12/20 [17:20<11:25, 85.73s/it]
Task 1, Epoch 13/20 => Loss 0.227, Train_accy 91.60:  60%|██████    | 12/20 [18:42<11:25, 85.73s/it]
Task 1, Epoch 13/20 => Loss 0.227, Train_accy 91.60:  65%|██████▌   | 13/20 [18:42<09:51, 84.53s/it]
Task 1, Epoch 14/20 => Loss 0.219, Train_accy 91.92:  65%|██████▌   | 13/20 [20:04<09:51, 84.53s/it]
Task 1, Epoch 14/20 => Loss 0.219, Train_accy 91.92:  70%|███████   | 14/20 [20:04<08:22, 83.67s/it]
Task 1, Epoch 15/20 => Loss 0.211, Train_accy 92.21:  70%|███████   | 14/20 [21:26<08:22, 83.67s/it]
Task 1, Epoch 15/20 => Loss 0.211, Train_accy 92.21:  75%|███████▌  | 15/20 [21:26<06:55, 83.15s/it]
Task 1, Epoch 16/20 => Loss 0.216, Train_accy 92.37, Test_accy 85.98:  75%|███████▌  | 15/20 [23:00<06:55, 83.15s/it]
Task 1, Epoch 16/20 => Loss 0.216, Train_accy 92.37, Test_accy 85.98:  80%|████████  | 16/20 [23:00<05:45, 86.40s/it]
Task 1, Epoch 17/20 => Loss 0.212, Train_accy 92.15:  80%|████████  | 16/20 [24:21<05:45, 86.40s/it]                 
Task 1, Epoch 17/20 => Loss 0.212, Train_accy 92.15:  85%|████████▌ | 17/20 [24:21<04:15, 85.03s/it]
Task 1, Epoch 18/20 => Loss 0.207, Train_accy 92.65:  85%|████████▌ | 17/20 [25:43<04:15, 85.03s/it]
Task 1, Epoch 18/20 => Loss 0.207, Train_accy 92.65:  90%|█████████ | 18/20 [25:43<02:48, 84.01s/it]
Task 1, Epoch 19/20 => Loss 0.201, Train_accy 93.04:  90%|█████████ | 18/20 [27:05<02:48, 84.01s/it]
Task 1, Epoch 19/20 => Loss 0.201, Train_accy 93.04:  95%|█████████▌| 19/20 [27:05<01:23, 83.40s/it]
Task 1, Epoch 20/20 => Loss 0.215, Train_accy 92.60:  95%|█████████▌| 19/20 [28:27<01:23, 83.40s/it]
Task 1, Epoch 20/20 => Loss 0.215, Train_accy 92.60: 100%|██████████| 20/20 [28:27<00:00, 82.99s/it]
Task 1, Epoch 20/20 => Loss 0.215, Train_accy 92.60: 100%|██████████| 20/20 [28:27<00:00, 85.37s/it]
2024-09-12 09:15:12,040 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.215, Train_accy 92.60
2024-09-12 09:15:24,283 [trainer.py] => No NME accuracy.
2024-09-12 09:15:24,283 [trainer.py] => CNN: {'total': 84.48, '00-19': 72.25, '20-39': 96.7, 'old': 72.25, 'new': 96.7}
2024-09-12 09:15:24,283 [trainer.py] => CNN top1 curve: [95.7, 84.48]
2024-09-12 09:15:24,283 [trainer.py] => CNN top5 curve: [99.4, 98.7]

Average Accuracy (CNN): 90.09
2024-09-12 09:15:24,284 [trainer.py] => Average Accuracy (CNN): 90.09 

2024-09-12 09:15:24,285 [trainer.py] => All params: 85829416
2024-09-12 09:15:24,286 [trainer.py] => Trainable params: 85829416
2024-09-12 09:15:24,288 [finetune.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.729, Train_accy 47.58, Test_accy 81.92:   0%|          | 0/20 [01:40<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.729, Train_accy 47.58, Test_accy 81.92:   5%|▌         | 1/20 [01:40<31:49, 100.49s/it]
Task 2, Epoch 2/20 => Loss 0.399, Train_accy 69.70:   5%|▌         | 1/20 [03:02<31:49, 100.49s/it]                 
Task 2, Epoch 2/20 => Loss 0.399, Train_accy 69.70:  10%|█         | 2/20 [03:02<26:54, 89.72s/it] 
Task 2, Epoch 3/20 => Loss 0.349, Train_accy 75.86:  10%|█         | 2/20 [04:24<26:54, 89.72s/it]
Task 2, Epoch 3/20 => Loss 0.349, Train_accy 75.86:  15%|█▌        | 3/20 [04:24<24:26, 86.26s/it]
Task 2, Epoch 4/20 => Loss 0.326, Train_accy 79.11:  15%|█▌        | 3/20 [05:46<24:26, 86.26s/it]
Task 2, Epoch 4/20 => Loss 0.326, Train_accy 79.11:  20%|██        | 4/20 [05:46<22:33, 84.60s/it]
Task 2, Epoch 5/20 => Loss 0.325, Train_accy 81.44:  20%|██        | 4/20 [07:08<22:33, 84.60s/it]
Task 2, Epoch 5/20 => Loss 0.325, Train_accy 81.44:  25%|██▌       | 5/20 [07:08<20:55, 83.68s/it]
Task 2, Epoch 6/20 => Loss 0.296, Train_accy 83.88, Test_accy 83.92:  25%|██▌       | 5/20 [08:49<20:55, 83.68s/it]
Task 2, Epoch 6/20 => Loss 0.296, Train_accy 83.88, Test_accy 83.92:  30%|███       | 6/20 [08:49<20:52, 89.48s/it]
Task 2, Epoch 7/20 => Loss 0.281, Train_accy 85.21:  30%|███       | 6/20 [10:11<20:52, 89.48s/it]                 
Task 2, Epoch 7/20 => Loss 0.281, Train_accy 85.21:  35%|███▌      | 7/20 [10:11<18:52, 87.09s/it]
Task 2, Epoch 8/20 => Loss 0.274, Train_accy 85.71:  35%|███▌      | 7/20 [11:33<18:52, 87.09s/it]
Task 2, Epoch 8/20 => Loss 0.274, Train_accy 85.71:  40%|████      | 8/20 [11:33<17:05, 85.47s/it]
Task 2, Epoch 9/20 => Loss 0.279, Train_accy 86.57:  40%|████      | 8/20 [12:55<17:05, 85.47s/it]
Task 2, Epoch 9/20 => Loss 0.279, Train_accy 86.57:  45%|████▌     | 9/20 [12:55<15:27, 84.30s/it]
Task 2, Epoch 10/20 => Loss 0.255, Train_accy 88.39:  45%|████▌     | 9/20 [14:17<15:27, 84.30s/it]
Task 2, Epoch 10/20 => Loss 0.255, Train_accy 88.39:  50%|█████     | 10/20 [14:17<13:55, 83.56s/it]
Task 2, Epoch 11/20 => Loss 0.258, Train_accy 87.81, Test_accy 81.63:  50%|█████     | 10/20 [15:57<13:55, 83.56s/it]
Task 2, Epoch 11/20 => Loss 0.258, Train_accy 87.81, Test_accy 81.63:  55%|█████▌    | 11/20 [15:57<13:17, 88.60s/it]
Task 2, Epoch 12/20 => Loss 0.245, Train_accy 88.77:  55%|█████▌    | 11/20 [17:19<13:17, 88.60s/it]                 
Task 2, Epoch 12/20 => Loss 0.245, Train_accy 88.77:  60%|██████    | 12/20 [17:19<11:32, 86.58s/it]
Task 2, Epoch 13/20 => Loss 0.237, Train_accy 89.13:  60%|██████    | 12/20 [18:41<11:32, 86.58s/it]
Task 2, Epoch 13/20 => Loss 0.237, Train_accy 89.13:  65%|██████▌   | 13/20 [18:41<09:56, 85.19s/it]
Task 2, Epoch 14/20 => Loss 0.241, Train_accy 89.07:  65%|██████▌   | 13/20 [20:03<09:56, 85.19s/it]
Task 2, Epoch 14/20 => Loss 0.241, Train_accy 89.07:  70%|███████   | 14/20 [20:03<08:25, 84.24s/it]
Task 2, Epoch 15/20 => Loss 0.222, Train_accy 90.26:  70%|███████   | 14/20 [21:25<08:25, 84.24s/it]
Task 2, Epoch 15/20 => Loss 0.222, Train_accy 90.26:  75%|███████▌  | 15/20 [21:25<06:57, 83.50s/it]
Task 2, Epoch 16/20 => Loss 0.233, Train_accy 89.74, Test_accy 81.37:  75%|███████▌  | 15/20 [23:05<06:57, 83.50s/it]
Task 2, Epoch 16/20 => Loss 0.233, Train_accy 89.74, Test_accy 81.37:  80%|████████  | 16/20 [23:05<05:53, 88.43s/it]
Task 2, Epoch 17/20 => Loss 0.214, Train_accy 90.58:  80%|████████  | 16/20 [24:26<05:53, 88.43s/it]                 
Task 2, Epoch 17/20 => Loss 0.214, Train_accy 90.58:  85%|████████▌ | 17/20 [24:26<04:19, 86.40s/it]
Task 2, Epoch 18/20 => Loss 0.214, Train_accy 90.82:  85%|████████▌ | 17/20 [25:48<04:19, 86.40s/it]
Task 2, Epoch 18/20 => Loss 0.214, Train_accy 90.82:  90%|█████████ | 18/20 [25:48<02:50, 85.11s/it]
Task 2, Epoch 19/20 => Loss 0.228, Train_accy 90.50:  90%|█████████ | 18/20 [27:10<02:50, 85.11s/it]
Task 2, Epoch 19/20 => Loss 0.228, Train_accy 90.50:  95%|█████████▌| 19/20 [27:10<01:24, 84.14s/it]
Task 2, Epoch 20/20 => Loss 0.230, Train_accy 90.64:  95%|█████████▌| 19/20 [28:32<01:24, 84.14s/it]
Task 2, Epoch 20/20 => Loss 0.230, Train_accy 90.64: 100%|██████████| 20/20 [28:32<00:00, 83.51s/it]
Task 2, Epoch 20/20 => Loss 0.230, Train_accy 90.64: 100%|██████████| 20/20 [28:32<00:00, 85.64s/it]
2024-09-12 09:43:57,209 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.230, Train_accy 90.64
2024-09-12 09:44:15,478 [trainer.py] => No NME accuracy.
2024-09-12 09:44:15,478 [trainer.py] => CNN: {'total': 80.38, '00-19': 63.55, '20-39': 83.2, '40-59': 94.4, 'old': 73.38, 'new': 94.4}
2024-09-12 09:44:15,478 [trainer.py] => CNN top1 curve: [95.7, 84.48, 80.38]
2024-09-12 09:44:15,479 [trainer.py] => CNN top5 curve: [99.4, 98.7, 97.85]

Average Accuracy (CNN): 86.85
2024-09-12 09:44:15,479 [trainer.py] => Average Accuracy (CNN): 86.85 

2024-09-12 09:44:15,479 [trainer.py] => All params: 85844796
2024-09-12 09:44:15,480 [trainer.py] => Trainable params: 85844796
2024-09-12 09:44:15,482 [finetune.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.665, Train_accy 41.37, Test_accy 77.24:   0%|          | 0/20 [01:46<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.665, Train_accy 41.37, Test_accy 77.24:   5%|▌         | 1/20 [01:46<33:39, 106.28s/it]
Task 3, Epoch 2/20 => Loss 0.392, Train_accy 65.05:   5%|▌         | 1/20 [03:08<33:39, 106.28s/it]                 
Task 3, Epoch 2/20 => Loss 0.392, Train_accy 65.05:  10%|█         | 2/20 [03:08<27:36, 92.05s/it] 
Task 3, Epoch 3/20 => Loss 0.343, Train_accy 71.42:  10%|█         | 2/20 [04:30<27:36, 92.05s/it]
Task 3, Epoch 3/20 => Loss 0.343, Train_accy 71.42:  15%|█▌        | 3/20 [04:30<24:46, 87.45s/it]
Task 3, Epoch 4/20 => Loss 0.295, Train_accy 76.79:  15%|█▌        | 3/20 [05:52<24:46, 87.45s/it]
Task 3, Epoch 4/20 => Loss 0.295, Train_accy 76.79:  20%|██        | 4/20 [05:52<22:45, 85.32s/it]
Task 3, Epoch 5/20 => Loss 0.297, Train_accy 79.04:  20%|██        | 4/20 [07:14<22:45, 85.32s/it]
Task 3, Epoch 5/20 => Loss 0.297, Train_accy 79.04:  25%|██▌       | 5/20 [07:14<21:02, 84.17s/it]
Task 3, Epoch 6/20 => Loss 0.272, Train_accy 81.04, Test_accy 79.47:  25%|██▌       | 5/20 [09:00<21:02, 84.17s/it]
Task 3, Epoch 6/20 => Loss 0.272, Train_accy 81.04, Test_accy 79.47:  30%|███       | 6/20 [09:00<21:23, 91.70s/it]
Task 3, Epoch 7/20 => Loss 0.271, Train_accy 82.24:  30%|███       | 6/20 [10:22<21:23, 91.70s/it]                 
Task 3, Epoch 7/20 => Loss 0.271, Train_accy 82.24:  35%|███▌      | 7/20 [10:22<19:10, 88.51s/it]
Task 3, Epoch 8/20 => Loss 0.255, Train_accy 83.70:  35%|███▌      | 7/20 [11:44<19:10, 88.51s/it]
Task 3, Epoch 8/20 => Loss 0.255, Train_accy 83.70:  40%|████      | 8/20 [11:44<17:16, 86.40s/it]
Task 3, Epoch 9/20 => Loss 0.255, Train_accy 84.46:  40%|████      | 8/20 [13:06<17:16, 86.40s/it]
Task 3, Epoch 9/20 => Loss 0.255, Train_accy 84.46:  45%|████▌     | 9/20 [13:06<15:34, 84.94s/it]
Task 3, Epoch 10/20 => Loss 0.242, Train_accy 85.87:  45%|████▌     | 9/20 [14:28<15:34, 84.94s/it]
Task 3, Epoch 10/20 => Loss 0.242, Train_accy 85.87:  50%|█████     | 10/20 [14:28<14:00, 84.01s/it]
Task 3, Epoch 11/20 => Loss 0.252, Train_accy 85.57, Test_accy 79.01:  50%|█████     | 10/20 [16:14<14:00, 84.01s/it]
Task 3, Epoch 11/20 => Loss 0.252, Train_accy 85.57, Test_accy 79.01:  55%|█████▌    | 11/20 [16:14<13:37, 90.89s/it]
Task 3, Epoch 12/20 => Loss 0.240, Train_accy 86.67:  55%|█████▌    | 11/20 [17:36<13:37, 90.89s/it]                 
Task 3, Epoch 12/20 => Loss 0.240, Train_accy 86.67:  60%|██████    | 12/20 [17:36<11:45, 88.19s/it]
Task 3, Epoch 13/20 => Loss 0.212, Train_accy 87.51:  60%|██████    | 12/20 [18:59<11:45, 88.19s/it]
Task 3, Epoch 13/20 => Loss 0.212, Train_accy 87.51:  65%|██████▌   | 13/20 [18:59<10:04, 86.38s/it]
Task 3, Epoch 14/20 => Loss 0.220, Train_accy 87.93:  65%|██████▌   | 13/20 [20:21<10:04, 86.38s/it]
Task 3, Epoch 14/20 => Loss 0.220, Train_accy 87.93:  70%|███████   | 14/20 [20:21<08:30, 85.09s/it]
Task 3, Epoch 15/20 => Loss 0.215, Train_accy 88.41:  70%|███████   | 14/20 [21:43<08:30, 85.09s/it]
Task 3, Epoch 15/20 => Loss 0.215, Train_accy 88.41:  75%|███████▌  | 15/20 [21:43<07:01, 84.24s/it]
Task 3, Epoch 16/20 => Loss 0.218, Train_accy 89.10, Test_accy 78.00:  75%|███████▌  | 15/20 [23:29<07:01, 84.24s/it]
Task 3, Epoch 16/20 => Loss 0.218, Train_accy 89.10, Test_accy 78.00:  80%|████████  | 16/20 [23:29<06:03, 90.84s/it]
Task 3, Epoch 17/20 => Loss 0.213, Train_accy 89.33:  80%|████████  | 16/20 [24:51<06:03, 90.84s/it]                 
Task 3, Epoch 17/20 => Loss 0.213, Train_accy 89.33:  85%|████████▌ | 17/20 [24:51<04:24, 88.22s/it]
Task 3, Epoch 18/20 => Loss 0.205, Train_accy 88.84:  85%|████████▌ | 17/20 [26:13<04:24, 88.22s/it]
Task 3, Epoch 18/20 => Loss 0.205, Train_accy 88.84:  90%|█████████ | 18/20 [26:13<02:52, 86.34s/it]
Task 3, Epoch 19/20 => Loss 0.208, Train_accy 89.20:  90%|█████████ | 18/20 [27:35<02:52, 86.34s/it]
Task 3, Epoch 19/20 => Loss 0.208, Train_accy 89.20:  95%|█████████▌| 19/20 [27:35<01:24, 84.94s/it]
Task 3, Epoch 20/20 => Loss 0.192, Train_accy 90.25:  95%|█████████▌| 19/20 [28:57<01:24, 84.94s/it]
Task 3, Epoch 20/20 => Loss 0.192, Train_accy 90.25: 100%|██████████| 20/20 [28:57<00:00, 84.06s/it]
Task 3, Epoch 20/20 => Loss 0.192, Train_accy 90.25: 100%|██████████| 20/20 [28:57<00:00, 86.87s/it]
2024-09-12 10:13:12,896 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.192, Train_accy 90.25
2024-09-12 10:13:37,266 [trainer.py] => No NME accuracy.
2024-09-12 10:13:37,267 [trainer.py] => CNN: {'total': 76.1, '00-19': 58.9, '20-39': 77.1, '40-59': 76.85, '60-79': 91.55, 'old': 70.95, 'new': 91.55}
2024-09-12 10:13:37,267 [trainer.py] => CNN top1 curve: [95.7, 84.48, 80.38, 76.1]
2024-09-12 10:13:37,267 [trainer.py] => CNN top5 curve: [99.4, 98.7, 97.85, 96.92]

Average Accuracy (CNN): 84.16
2024-09-12 10:13:37,267 [trainer.py] => Average Accuracy (CNN): 84.16 

2024-09-12 10:13:37,269 [trainer.py] => All params: 85860176
2024-09-12 10:13:37,270 [trainer.py] => Trainable params: 85860176
2024-09-12 10:13:37,272 [finetune.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.703, Train_accy 44.71, Test_accy 75.38:   0%|          | 0/20 [01:52<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.703, Train_accy 44.71, Test_accy 75.38:   5%|▌         | 1/20 [01:52<35:30, 112.12s/it]
Task 4, Epoch 2/20 => Loss 0.372, Train_accy 68.50:   5%|▌         | 1/20 [03:14<35:30, 112.12s/it]                 
Task 4, Epoch 2/20 => Loss 0.372, Train_accy 68.50:  10%|█         | 2/20 [03:14<28:20, 94.45s/it] 
Task 4, Epoch 3/20 => Loss 0.329, Train_accy 74.28:  10%|█         | 2/20 [04:36<28:20, 94.45s/it]
Task 4, Epoch 3/20 => Loss 0.329, Train_accy 74.28:  15%|█▌        | 3/20 [04:36<25:09, 88.77s/it]
Task 4, Epoch 4/20 => Loss 0.321, Train_accy 77.49:  15%|█▌        | 3/20 [05:58<25:09, 88.77s/it]
Task 4, Epoch 4/20 => Loss 0.321, Train_accy 77.49:  20%|██        | 4/20 [05:58<22:57, 86.11s/it]
Task 4, Epoch 5/20 => Loss 0.294, Train_accy 80.07:  20%|██        | 4/20 [07:20<22:57, 86.11s/it]
Task 4, Epoch 5/20 => Loss 0.294, Train_accy 80.07:  25%|██▌       | 5/20 [07:20<21:10, 84.69s/it]
Task 4, Epoch 6/20 => Loss 0.269, Train_accy 82.18, Test_accy 76.34:  25%|██▌       | 5/20 [09:13<21:10, 84.69s/it]
Task 4, Epoch 6/20 => Loss 0.269, Train_accy 82.18, Test_accy 76.34:  30%|███       | 6/20 [09:13<21:58, 94.18s/it]
Task 4, Epoch 7/20 => Loss 0.259, Train_accy 82.86:  30%|███       | 6/20 [10:35<21:58, 94.18s/it]                 
Task 4, Epoch 7/20 => Loss 0.259, Train_accy 82.86:  35%|███▌      | 7/20 [10:35<19:33, 90.28s/it]
Task 4, Epoch 8/20 => Loss 0.257, Train_accy 84.57:  35%|███▌      | 7/20 [11:57<19:33, 90.28s/it]
Task 4, Epoch 8/20 => Loss 0.257, Train_accy 84.57:  40%|████      | 8/20 [11:57<17:33, 87.77s/it]
Task 4, Epoch 9/20 => Loss 0.245, Train_accy 85.88:  40%|████      | 8/20 [13:19<17:33, 87.77s/it]
Task 4, Epoch 9/20 => Loss 0.245, Train_accy 85.88:  45%|████▌     | 9/20 [13:19<15:46, 86.05s/it]
Task 4, Epoch 10/20 => Loss 0.244, Train_accy 86.07:  45%|████▌     | 9/20 [14:42<15:46, 86.05s/it]
Task 4, Epoch 10/20 => Loss 0.244, Train_accy 86.07:  50%|█████     | 10/20 [14:42<14:08, 84.88s/it]
Task 4, Epoch 11/20 => Loss 0.235, Train_accy 86.95, Test_accy 74.33:  50%|█████     | 10/20 [16:34<14:08, 84.88s/it]
Task 4, Epoch 11/20 => Loss 0.235, Train_accy 86.95, Test_accy 74.33:  55%|█████▌    | 11/20 [16:34<13:59, 93.28s/it]
Task 4, Epoch 12/20 => Loss 0.218, Train_accy 87.71:  55%|█████▌    | 11/20 [17:56<13:59, 93.28s/it]                 
Task 4, Epoch 12/20 => Loss 0.218, Train_accy 87.71:  60%|██████    | 12/20 [17:56<11:58, 89.86s/it]
Task 4, Epoch 13/20 => Loss 0.226, Train_accy 88.09:  60%|██████    | 12/20 [19:18<11:58, 89.86s/it]
Task 4, Epoch 13/20 => Loss 0.226, Train_accy 88.09:  65%|██████▌   | 13/20 [19:18<10:12, 87.45s/it]
Task 4, Epoch 14/20 => Loss 0.230, Train_accy 87.93:  65%|██████▌   | 13/20 [20:40<10:12, 87.45s/it]
Task 4, Epoch 14/20 => Loss 0.230, Train_accy 87.93:  70%|███████   | 14/20 [20:40<08:34, 85.79s/it]
Task 4, Epoch 15/20 => Loss 0.209, Train_accy 89.02:  70%|███████   | 14/20 [22:02<08:34, 85.79s/it]
Task 4, Epoch 15/20 => Loss 0.209, Train_accy 89.02:  75%|███████▌  | 15/20 [22:02<07:03, 84.66s/it]
Task 4, Epoch 16/20 => Loss 0.214, Train_accy 89.33, Test_accy 72.43:  75%|███████▌  | 15/20 [23:54<07:03, 84.66s/it]
Task 4, Epoch 16/20 => Loss 0.214, Train_accy 89.33, Test_accy 72.43:  80%|████████  | 16/20 [23:54<06:11, 92.95s/it]
Task 4, Epoch 17/20 => Loss 0.219, Train_accy 89.28:  80%|████████  | 16/20 [25:16<06:11, 92.95s/it]                 
Task 4, Epoch 17/20 => Loss 0.219, Train_accy 89.28:  85%|████████▌ | 17/20 [25:16<04:28, 89.63s/it]
Task 4, Epoch 18/20 => Loss 0.204, Train_accy 89.70:  85%|████████▌ | 17/20 [26:38<04:28, 89.63s/it]
Task 4, Epoch 18/20 => Loss 0.204, Train_accy 89.70:  90%|█████████ | 18/20 [26:38<02:54, 87.31s/it]
Task 4, Epoch 19/20 => Loss 0.214, Train_accy 89.21:  90%|█████████ | 18/20 [28:00<02:54, 87.31s/it]
Task 4, Epoch 19/20 => Loss 0.214, Train_accy 89.21:  95%|█████████▌| 19/20 [28:00<01:25, 85.72s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 90.16:  95%|█████████▌| 19/20 [29:22<01:25, 85.72s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 90.16: 100%|██████████| 20/20 [29:22<00:00, 84.57s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 90.16: 100%|██████████| 20/20 [29:22<00:00, 88.12s/it]
2024-09-12 10:42:59,704 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.202, Train_accy 90.16
2024-09-12 10:43:29,858 [trainer.py] => No NME accuracy.
2024-09-12 10:43:29,859 [trainer.py] => CNN: {'total': 70.76, '00-19': 44.95, '20-39': 69.3, '40-59': 68.55, '60-79': 76.75, '80-99': 94.25, 'old': 64.89, 'new': 94.25}
2024-09-12 10:43:29,859 [trainer.py] => CNN top1 curve: [95.7, 84.48, 80.38, 76.1, 70.76]
2024-09-12 10:43:29,859 [trainer.py] => CNN top5 curve: [99.4, 98.7, 97.85, 96.92, 95.33]

Average Accuracy (CNN): 81.48
2024-09-12 10:43:29,859 [trainer.py] => Average Accuracy (CNN): 81.48 

Accuracy Matrix (CNN):
[[95.7  72.25 63.55 58.9  44.95]
 [ 0.   96.7  83.2  77.1  69.3 ]
 [ 0.    0.   94.4  76.85 68.55]
 [ 0.    0.    0.   91.55 76.75]
 [ 0.    0.    0.    0.   94.25]]
2024-09-12 10:43:29,860 [trainer.py] => Forgetting (CNN): 29.700000000000003
2024-09-12 10:43:33,070 [trainer.py] => config: ./exps/finetune_cifar_B0_Inc10.json
2024-09-12 10:43:33,071 [trainer.py] => prefix: reproduce
2024-09-12 10:43:33,071 [trainer.py] => dataset: cifar224
2024-09-12 10:43:33,071 [trainer.py] => memory_size: 0
2024-09-12 10:43:33,071 [trainer.py] => memory_per_class: 0
2024-09-12 10:43:33,071 [trainer.py] => fixed_memory: False
2024-09-12 10:43:33,071 [trainer.py] => shuffle: True
2024-09-12 10:43:33,071 [trainer.py] => init_cls: 10
2024-09-12 10:43:33,071 [trainer.py] => increment: 10
2024-09-12 10:43:33,071 [trainer.py] => model_name: finetune
2024-09-12 10:43:33,071 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 10:43:33,071 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 10:43:33,071 [trainer.py] => seed: 1993
2024-09-12 10:43:33,071 [trainer.py] => init_epoch: 20
2024-09-12 10:43:33,071 [trainer.py] => init_lr: 0.001
2024-09-12 10:43:33,071 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 10:43:33,071 [trainer.py] => init_lr_decay: 0.1
2024-09-12 10:43:33,071 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 10:43:33,071 [trainer.py] => epochs: 20
2024-09-12 10:43:33,071 [trainer.py] => lrate: 0.001
2024-09-12 10:43:33,071 [trainer.py] => milestones: [40, 70]
2024-09-12 10:43:33,071 [trainer.py] => lrate_decay: 0.1
2024-09-12 10:43:33,071 [trainer.py] => batch_size: 48
2024-09-12 10:43:33,071 [trainer.py] => weight_decay: 0.0002
2024-09-12 10:43:34,217 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 10:43:36,086 [trainer.py] => All params: 85798656
2024-09-12 10:43:36,086 [trainer.py] => Trainable params: 85798656
2024-09-12 10:43:36,087 [finetune.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.880, Train_accy 71.06, Test_accy 97.00:   0%|          | 0/20 [00:45<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.880, Train_accy 71.06, Test_accy 97.00:   5%|▌         | 1/20 [00:45<14:18, 45.20s/it]
Task 0, Epoch 2/20 => Loss 0.446, Train_accy 85.86:   5%|▌         | 1/20 [01:26<14:18, 45.20s/it]                 
Task 0, Epoch 2/20 => Loss 0.446, Train_accy 85.86:  10%|█         | 2/20 [01:26<12:48, 42.67s/it]
Task 0, Epoch 3/20 => Loss 0.327, Train_accy 89.18:  10%|█         | 2/20 [02:07<12:48, 42.67s/it]
Task 0, Epoch 3/20 => Loss 0.327, Train_accy 89.18:  15%|█▌        | 3/20 [02:07<11:52, 41.92s/it]
Task 0, Epoch 4/20 => Loss 0.351, Train_accy 88.84:  15%|█▌        | 3/20 [02:48<11:52, 41.92s/it]
Task 0, Epoch 4/20 => Loss 0.351, Train_accy 88.84:  20%|██        | 4/20 [02:48<11:07, 41.74s/it]
Task 0, Epoch 5/20 => Loss 0.311, Train_accy 90.48:  20%|██        | 4/20 [03:29<11:07, 41.74s/it]
Task 0, Epoch 5/20 => Loss 0.311, Train_accy 90.48:  25%|██▌       | 5/20 [03:29<10:22, 41.47s/it]
Task 0, Epoch 6/20 => Loss 0.295, Train_accy 90.40, Test_accy 97.90:  25%|██▌       | 5/20 [04:14<10:22, 41.47s/it]
Task 0, Epoch 6/20 => Loss 0.295, Train_accy 90.40, Test_accy 97.90:  30%|███       | 6/20 [04:14<09:55, 42.54s/it]
Task 0, Epoch 7/20 => Loss 0.260, Train_accy 91.56:  30%|███       | 6/20 [04:55<09:55, 42.54s/it]                 
Task 0, Epoch 7/20 => Loss 0.260, Train_accy 91.56:  35%|███▌      | 7/20 [04:55<09:07, 42.11s/it]
Task 0, Epoch 8/20 => Loss 0.242, Train_accy 92.36:  35%|███▌      | 7/20 [05:36<09:07, 42.11s/it]
Task 0, Epoch 8/20 => Loss 0.242, Train_accy 92.36:  40%|████      | 8/20 [05:36<08:23, 41.93s/it]
Task 0, Epoch 9/20 => Loss 0.232, Train_accy 92.22:  40%|████      | 8/20 [06:18<08:23, 41.93s/it]
Task 0, Epoch 9/20 => Loss 0.232, Train_accy 92.22:  45%|████▌     | 9/20 [06:18<07:39, 41.73s/it]
Task 0, Epoch 10/20 => Loss 0.227, Train_accy 92.56:  45%|████▌     | 9/20 [06:59<07:39, 41.73s/it]
Task 0, Epoch 10/20 => Loss 0.227, Train_accy 92.56:  50%|█████     | 10/20 [06:59<06:55, 41.51s/it]
Task 0, Epoch 11/20 => Loss 0.224, Train_accy 92.72, Test_accy 98.80:  50%|█████     | 10/20 [07:44<06:55, 41.51s/it]
Task 0, Epoch 11/20 => Loss 0.224, Train_accy 92.72, Test_accy 98.80:  55%|█████▌    | 11/20 [07:44<06:23, 42.61s/it]
Task 0, Epoch 12/20 => Loss 0.221, Train_accy 92.84:  55%|█████▌    | 11/20 [08:25<06:23, 42.61s/it]                 
Task 0, Epoch 12/20 => Loss 0.221, Train_accy 92.84:  60%|██████    | 12/20 [08:25<05:37, 42.19s/it]
Task 0, Epoch 13/20 => Loss 0.202, Train_accy 93.64:  60%|██████    | 12/20 [09:06<05:37, 42.19s/it]
Task 0, Epoch 13/20 => Loss 0.202, Train_accy 93.64:  65%|██████▌   | 13/20 [09:06<04:53, 41.87s/it]
Task 0, Epoch 14/20 => Loss 0.178, Train_accy 94.68:  65%|██████▌   | 13/20 [09:47<04:53, 41.87s/it]
Task 0, Epoch 14/20 => Loss 0.178, Train_accy 94.68:  70%|███████   | 14/20 [09:47<04:09, 41.66s/it]
Task 0, Epoch 15/20 => Loss 0.187, Train_accy 94.08:  70%|███████   | 14/20 [10:29<04:09, 41.66s/it]
Task 0, Epoch 15/20 => Loss 0.187, Train_accy 94.08:  75%|███████▌  | 15/20 [10:29<03:28, 41.68s/it]
Task 0, Epoch 16/20 => Loss 0.205, Train_accy 93.76, Test_accy 98.20:  75%|███████▌  | 15/20 [11:14<03:28, 41.68s/it]
Task 0, Epoch 16/20 => Loss 0.205, Train_accy 93.76, Test_accy 98.20:  80%|████████  | 16/20 [11:14<02:50, 42.59s/it]
Task 0, Epoch 17/20 => Loss 0.192, Train_accy 93.70:  80%|████████  | 16/20 [11:55<02:50, 42.59s/it]                 
Task 0, Epoch 17/20 => Loss 0.192, Train_accy 93.70:  85%|████████▌ | 17/20 [11:55<02:06, 42.11s/it]
Task 0, Epoch 18/20 => Loss 0.190, Train_accy 93.66:  85%|████████▌ | 17/20 [12:36<02:06, 42.11s/it]
Task 0, Epoch 18/20 => Loss 0.190, Train_accy 93.66:  90%|█████████ | 18/20 [12:36<01:23, 41.82s/it]
Task 0, Epoch 19/20 => Loss 0.198, Train_accy 93.60:  90%|█████████ | 18/20 [13:18<01:23, 41.82s/it]
Task 0, Epoch 19/20 => Loss 0.198, Train_accy 93.60:  95%|█████████▌| 19/20 [13:18<00:41, 41.82s/it]
Task 0, Epoch 20/20 => Loss 0.201, Train_accy 94.10:  95%|█████████▌| 19/20 [13:59<00:41, 41.82s/it]
Task 0, Epoch 20/20 => Loss 0.201, Train_accy 94.10: 100%|██████████| 20/20 [13:59<00:00, 41.55s/it]
Task 0, Epoch 20/20 => Loss 0.201, Train_accy 94.10: 100%|██████████| 20/20 [13:59<00:00, 41.96s/it]
2024-09-12 10:57:35,839 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.201, Train_accy 94.10
2024-09-12 10:57:39,375 [trainer.py] => No NME accuracy.
2024-09-12 10:57:39,376 [trainer.py] => CNN: {'total': 98.5, '00-09': 98.5, 'old': 0, 'new': 98.5}
2024-09-12 10:57:39,376 [trainer.py] => CNN top1 curve: [98.5]
2024-09-12 10:57:39,376 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.5
2024-09-12 10:57:39,376 [trainer.py] => Average Accuracy (CNN): 98.5 

2024-09-12 10:57:39,377 [trainer.py] => All params: 85806346
2024-09-12 10:57:39,378 [trainer.py] => Trainable params: 85806346
2024-09-12 10:57:39,380 [finetune.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.698, Train_accy 60.78, Test_accy 93.00:   0%|          | 0/20 [00:47<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.698, Train_accy 60.78, Test_accy 93.00:   5%|▌         | 1/20 [00:47<15:09, 47.87s/it]
Task 1, Epoch 2/20 => Loss 0.349, Train_accy 82.80:   5%|▌         | 1/20 [01:29<15:09, 47.87s/it]                 
Task 1, Epoch 2/20 => Loss 0.349, Train_accy 82.80:  10%|█         | 2/20 [01:29<13:11, 44.00s/it]
Task 1, Epoch 3/20 => Loss 0.334, Train_accy 84.16:  10%|█         | 2/20 [02:10<13:11, 44.00s/it]
Task 1, Epoch 3/20 => Loss 0.334, Train_accy 84.16:  15%|█▌        | 3/20 [02:10<12:05, 42.67s/it]
Task 1, Epoch 4/20 => Loss 0.319, Train_accy 85.86:  15%|█▌        | 3/20 [02:51<12:05, 42.67s/it]
Task 1, Epoch 4/20 => Loss 0.319, Train_accy 85.86:  20%|██        | 4/20 [02:51<11:13, 42.10s/it]
Task 1, Epoch 5/20 => Loss 0.273, Train_accy 88.48:  20%|██        | 4/20 [03:32<11:13, 42.10s/it]
Task 1, Epoch 5/20 => Loss 0.273, Train_accy 88.48:  25%|██▌       | 5/20 [03:32<10:27, 41.81s/it]
Task 1, Epoch 6/20 => Loss 0.298, Train_accy 87.64, Test_accy 93.45:  25%|██▌       | 5/20 [04:20<10:27, 41.81s/it]
Task 1, Epoch 6/20 => Loss 0.298, Train_accy 87.64, Test_accy 93.45:  30%|███       | 6/20 [04:20<10:11, 43.69s/it]
Task 1, Epoch 7/20 => Loss 0.267, Train_accy 88.48:  30%|███       | 6/20 [05:01<10:11, 43.69s/it]                 
Task 1, Epoch 7/20 => Loss 0.267, Train_accy 88.48:  35%|███▌      | 7/20 [05:01<09:16, 42.83s/it]
Task 1, Epoch 8/20 => Loss 0.257, Train_accy 89.56:  35%|███▌      | 7/20 [05:42<09:16, 42.83s/it]
Task 1, Epoch 8/20 => Loss 0.257, Train_accy 89.56:  40%|████      | 8/20 [05:42<08:26, 42.21s/it]
Task 1, Epoch 9/20 => Loss 0.239, Train_accy 90.38:  40%|████      | 8/20 [06:23<08:26, 42.21s/it]
Task 1, Epoch 9/20 => Loss 0.239, Train_accy 90.38:  45%|████▌     | 9/20 [06:23<07:41, 42.00s/it]
Task 1, Epoch 10/20 => Loss 0.248, Train_accy 90.20:  45%|████▌     | 9/20 [07:04<07:41, 42.00s/it]
Task 1, Epoch 10/20 => Loss 0.248, Train_accy 90.20:  50%|█████     | 10/20 [07:04<06:57, 41.76s/it]
Task 1, Epoch 11/20 => Loss 0.222, Train_accy 91.62, Test_accy 90.55:  50%|█████     | 10/20 [07:52<06:57, 41.76s/it]
Task 1, Epoch 11/20 => Loss 0.222, Train_accy 91.62, Test_accy 90.55:  55%|█████▌    | 11/20 [07:52<06:31, 43.51s/it]
Task 1, Epoch 12/20 => Loss 0.229, Train_accy 91.24:  55%|█████▌    | 11/20 [08:33<06:31, 43.51s/it]                 
Task 1, Epoch 12/20 => Loss 0.229, Train_accy 91.24:  60%|██████    | 12/20 [08:33<05:42, 42.79s/it]
Task 1, Epoch 13/20 => Loss 0.208, Train_accy 92.02:  60%|██████    | 12/20 [09:14<05:42, 42.79s/it]
Task 1, Epoch 13/20 => Loss 0.208, Train_accy 92.02:  65%|██████▌   | 13/20 [09:14<04:55, 42.21s/it]
Task 1, Epoch 14/20 => Loss 0.229, Train_accy 91.30:  65%|██████▌   | 13/20 [09:55<04:55, 42.21s/it]
Task 1, Epoch 14/20 => Loss 0.229, Train_accy 91.30:  70%|███████   | 14/20 [09:55<04:11, 41.97s/it]
Task 1, Epoch 15/20 => Loss 0.231, Train_accy 91.54:  70%|███████   | 14/20 [10:36<04:11, 41.97s/it]
Task 1, Epoch 15/20 => Loss 0.231, Train_accy 91.54:  75%|███████▌  | 15/20 [10:36<03:28, 41.68s/it]
Task 1, Epoch 16/20 => Loss 0.225, Train_accy 91.68, Test_accy 90.40:  75%|███████▌  | 15/20 [11:24<03:28, 41.68s/it]
Task 1, Epoch 16/20 => Loss 0.225, Train_accy 91.68, Test_accy 90.40:  80%|████████  | 16/20 [11:24<02:53, 43.41s/it]
Task 1, Epoch 17/20 => Loss 0.204, Train_accy 92.00:  80%|████████  | 16/20 [12:05<02:53, 43.41s/it]                 
Task 1, Epoch 17/20 => Loss 0.204, Train_accy 92.00:  85%|████████▌ | 17/20 [12:05<02:08, 42.72s/it]
Task 1, Epoch 18/20 => Loss 0.190, Train_accy 92.80:  85%|████████▌ | 17/20 [12:46<02:08, 42.72s/it]
Task 1, Epoch 18/20 => Loss 0.190, Train_accy 92.80:  90%|█████████ | 18/20 [12:46<01:24, 42.35s/it]
Task 1, Epoch 19/20 => Loss 0.199, Train_accy 92.22:  90%|█████████ | 18/20 [13:27<01:24, 42.35s/it]
Task 1, Epoch 19/20 => Loss 0.199, Train_accy 92.22:  95%|█████████▌| 19/20 [13:27<00:41, 42.00s/it]
Task 1, Epoch 20/20 => Loss 0.203, Train_accy 92.42:  95%|█████████▌| 19/20 [14:08<00:41, 42.00s/it]
Task 1, Epoch 20/20 => Loss 0.203, Train_accy 92.42: 100%|██████████| 20/20 [14:08<00:00, 41.71s/it]
Task 1, Epoch 20/20 => Loss 0.203, Train_accy 92.42: 100%|██████████| 20/20 [14:08<00:00, 42.45s/it]
2024-09-12 11:11:48,389 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.203, Train_accy 92.42
2024-09-12 11:11:54,769 [trainer.py] => No NME accuracy.
2024-09-12 11:11:54,769 [trainer.py] => CNN: {'total': 90.5, '00-09': 84.0, '10-19': 97.0, 'old': 84.0, 'new': 97.0}
2024-09-12 11:11:54,769 [trainer.py] => CNN top1 curve: [98.5, 90.5]
2024-09-12 11:11:54,769 [trainer.py] => CNN top5 curve: [100.0, 99.5]

Average Accuracy (CNN): 94.5
2024-09-12 11:11:54,770 [trainer.py] => Average Accuracy (CNN): 94.5 

2024-09-12 11:11:54,771 [trainer.py] => All params: 85814036
2024-09-12 11:11:54,772 [trainer.py] => Trainable params: 85814036
2024-09-12 11:11:54,774 [finetune.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.389, Train_accy 59.54, Test_accy 85.20:   0%|          | 0/20 [00:50<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.389, Train_accy 59.54, Test_accy 85.20:   5%|▌         | 1/20 [00:50<15:59, 50.51s/it]
Task 2, Epoch 2/20 => Loss 0.215, Train_accy 78.60:   5%|▌         | 1/20 [01:31<15:59, 50.51s/it]                 
Task 2, Epoch 2/20 => Loss 0.215, Train_accy 78.60:  10%|█         | 2/20 [01:31<13:28, 44.90s/it]
Task 2, Epoch 3/20 => Loss 0.176, Train_accy 82.60:  10%|█         | 2/20 [02:12<13:28, 44.90s/it]
Task 2, Epoch 3/20 => Loss 0.176, Train_accy 82.60:  15%|█▌        | 3/20 [02:12<12:13, 43.15s/it]
Task 2, Epoch 4/20 => Loss 0.164, Train_accy 86.62:  15%|█▌        | 3/20 [02:53<12:13, 43.15s/it]
Task 2, Epoch 4/20 => Loss 0.164, Train_accy 86.62:  20%|██        | 4/20 [02:53<11:17, 42.37s/it]
Task 2, Epoch 5/20 => Loss 0.172, Train_accy 85.82:  20%|██        | 4/20 [03:34<11:17, 42.37s/it]
Task 2, Epoch 5/20 => Loss 0.172, Train_accy 85.82:  25%|██▌       | 5/20 [03:34<10:27, 41.85s/it]
Task 2, Epoch 6/20 => Loss 0.153, Train_accy 87.90, Test_accy 85.33:  25%|██▌       | 5/20 [04:25<10:27, 41.85s/it]
Task 2, Epoch 6/20 => Loss 0.153, Train_accy 87.90, Test_accy 85.33:  30%|███       | 6/20 [04:25<10:29, 44.97s/it]
Task 2, Epoch 7/20 => Loss 0.161, Train_accy 89.12:  30%|███       | 6/20 [05:06<10:29, 44.97s/it]                 
Task 2, Epoch 7/20 => Loss 0.161, Train_accy 89.12:  35%|███▌      | 7/20 [05:06<09:27, 43.65s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 90.44:  35%|███▌      | 7/20 [05:47<09:27, 43.65s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 90.44:  40%|████      | 8/20 [05:47<08:34, 42.91s/it]
Task 2, Epoch 9/20 => Loss 0.139, Train_accy 91.00:  40%|████      | 8/20 [06:29<08:34, 42.91s/it]
Task 2, Epoch 9/20 => Loss 0.139, Train_accy 91.00:  45%|████▌     | 9/20 [06:29<07:45, 42.35s/it]
Task 2, Epoch 10/20 => Loss 0.149, Train_accy 90.68:  45%|████▌     | 9/20 [07:10<07:45, 42.35s/it]
Task 2, Epoch 10/20 => Loss 0.149, Train_accy 90.68:  50%|█████     | 10/20 [07:10<06:59, 41.97s/it]
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 90.88, Test_accy 84.03:  50%|█████     | 10/20 [08:01<06:59, 41.97s/it]
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 90.88, Test_accy 84.03:  55%|█████▌    | 11/20 [08:01<06:42, 44.70s/it]
Task 2, Epoch 12/20 => Loss 0.149, Train_accy 90.62:  55%|█████▌    | 11/20 [08:42<06:42, 44.70s/it]                 
Task 2, Epoch 12/20 => Loss 0.149, Train_accy 90.62:  60%|██████    | 12/20 [08:42<05:50, 43.81s/it]
Task 2, Epoch 13/20 => Loss 0.137, Train_accy 91.72:  60%|██████    | 12/20 [09:24<05:50, 43.81s/it]
Task 2, Epoch 13/20 => Loss 0.137, Train_accy 91.72:  65%|██████▌   | 13/20 [09:24<05:01, 43.05s/it]
Task 2, Epoch 14/20 => Loss 0.138, Train_accy 92.06:  65%|██████▌   | 13/20 [10:05<05:01, 43.05s/it]
Task 2, Epoch 14/20 => Loss 0.138, Train_accy 92.06:  70%|███████   | 14/20 [10:05<04:14, 42.49s/it]
Task 2, Epoch 15/20 => Loss 0.126, Train_accy 92.50:  70%|███████   | 14/20 [10:46<04:14, 42.49s/it]
Task 2, Epoch 15/20 => Loss 0.126, Train_accy 92.50:  75%|███████▌  | 15/20 [10:46<03:30, 42.20s/it]
Task 2, Epoch 16/20 => Loss 0.119, Train_accy 92.64, Test_accy 84.77:  75%|███████▌  | 15/20 [11:37<03:30, 42.20s/it]
Task 2, Epoch 16/20 => Loss 0.119, Train_accy 92.64, Test_accy 84.77:  80%|████████  | 16/20 [11:37<02:58, 44.69s/it]
Task 2, Epoch 17/20 => Loss 0.120, Train_accy 93.02:  80%|████████  | 16/20 [12:18<02:58, 44.69s/it]                 
Task 2, Epoch 17/20 => Loss 0.120, Train_accy 93.02:  85%|████████▌ | 17/20 [12:18<02:11, 43.73s/it]
Task 2, Epoch 18/20 => Loss 0.133, Train_accy 92.90:  85%|████████▌ | 17/20 [12:59<02:11, 43.73s/it]
Task 2, Epoch 18/20 => Loss 0.133, Train_accy 92.90:  90%|█████████ | 18/20 [12:59<01:25, 42.95s/it]
Task 2, Epoch 19/20 => Loss 0.122, Train_accy 93.16:  90%|█████████ | 18/20 [13:41<01:25, 42.95s/it]
Task 2, Epoch 19/20 => Loss 0.122, Train_accy 93.16:  95%|█████████▌| 19/20 [13:41<00:42, 42.40s/it]
Task 2, Epoch 20/20 => Loss 0.105, Train_accy 94.36:  95%|█████████▌| 19/20 [14:22<00:42, 42.40s/it]
Task 2, Epoch 20/20 => Loss 0.105, Train_accy 94.36: 100%|██████████| 20/20 [14:22<00:00, 42.11s/it]
Task 2, Epoch 20/20 => Loss 0.105, Train_accy 94.36: 100%|██████████| 20/20 [14:22<00:00, 43.13s/it]
2024-09-12 11:26:17,347 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.105, Train_accy 94.36
2024-09-12 11:26:26,549 [trainer.py] => No NME accuracy.
2024-09-12 11:26:26,549 [trainer.py] => CNN: {'total': 83.3, '00-09': 71.3, '10-19': 81.4, '20-29': 97.2, 'old': 76.35, 'new': 97.2}
2024-09-12 11:26:26,549 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3]
2024-09-12 11:26:26,549 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5]

Average Accuracy (CNN): 90.77
2024-09-12 11:26:26,549 [trainer.py] => Average Accuracy (CNN): 90.77 

2024-09-12 11:26:26,551 [trainer.py] => All params: 85821726
2024-09-12 11:26:26,552 [trainer.py] => Trainable params: 85821726
2024-09-12 11:26:26,554 [finetune.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.555, Train_accy 52.10, Test_accy 79.10:   0%|          | 0/20 [00:54<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.555, Train_accy 52.10, Test_accy 79.10:   5%|▌         | 1/20 [00:54<17:08, 54.12s/it]
Task 3, Epoch 2/20 => Loss 0.270, Train_accy 74.90:   5%|▌         | 1/20 [01:35<17:08, 54.12s/it]                 
Task 3, Epoch 2/20 => Loss 0.270, Train_accy 74.90:  10%|█         | 2/20 [01:35<13:55, 46.43s/it]
Task 3, Epoch 3/20 => Loss 0.249, Train_accy 80.44:  10%|█         | 2/20 [02:16<13:55, 46.43s/it]
Task 3, Epoch 3/20 => Loss 0.249, Train_accy 80.44:  15%|█▌        | 3/20 [02:16<12:27, 43.96s/it]
Task 3, Epoch 4/20 => Loss 0.206, Train_accy 84.74:  15%|█▌        | 3/20 [02:57<12:27, 43.96s/it]
Task 3, Epoch 4/20 => Loss 0.206, Train_accy 84.74:  20%|██        | 4/20 [02:57<11:26, 42.91s/it]
Task 3, Epoch 5/20 => Loss 0.208, Train_accy 85.30:  20%|██        | 4/20 [03:38<11:26, 42.91s/it]
Task 3, Epoch 5/20 => Loss 0.208, Train_accy 85.30:  25%|██▌       | 5/20 [03:38<10:32, 42.17s/it]
Task 3, Epoch 6/20 => Loss 0.209, Train_accy 85.76, Test_accy 80.78:  25%|██▌       | 5/20 [04:32<10:32, 42.17s/it]
Task 3, Epoch 6/20 => Loss 0.209, Train_accy 85.76, Test_accy 80.78:  30%|███       | 6/20 [04:32<10:45, 46.10s/it]
Task 3, Epoch 7/20 => Loss 0.186, Train_accy 87.50:  30%|███       | 6/20 [05:13<10:45, 46.10s/it]                 
Task 3, Epoch 7/20 => Loss 0.186, Train_accy 87.50:  35%|███▌      | 7/20 [05:13<09:38, 44.46s/it]
Task 3, Epoch 8/20 => Loss 0.180, Train_accy 88.72:  35%|███▌      | 7/20 [05:54<09:38, 44.46s/it]
Task 3, Epoch 8/20 => Loss 0.180, Train_accy 88.72:  40%|████      | 8/20 [05:54<08:40, 43.41s/it]
Task 3, Epoch 9/20 => Loss 0.171, Train_accy 88.78:  40%|████      | 8/20 [06:35<08:40, 43.41s/it]
Task 3, Epoch 9/20 => Loss 0.171, Train_accy 88.78:  45%|████▌     | 9/20 [06:35<07:50, 42.80s/it]
Task 3, Epoch 10/20 => Loss 0.161, Train_accy 89.74:  45%|████▌     | 9/20 [07:16<07:50, 42.80s/it]
Task 3, Epoch 10/20 => Loss 0.161, Train_accy 89.74:  50%|█████     | 10/20 [07:16<07:02, 42.22s/it]
Task 3, Epoch 11/20 => Loss 0.156, Train_accy 90.44, Test_accy 80.12:  50%|█████     | 10/20 [08:10<07:02, 42.22s/it]
Task 3, Epoch 11/20 => Loss 0.156, Train_accy 90.44, Test_accy 80.12:  55%|█████▌    | 11/20 [08:10<06:51, 45.76s/it]
Task 3, Epoch 12/20 => Loss 0.175, Train_accy 89.48:  55%|█████▌    | 11/20 [08:51<06:51, 45.76s/it]                 
Task 3, Epoch 12/20 => Loss 0.175, Train_accy 89.48:  60%|██████    | 12/20 [08:51<05:54, 44.29s/it]
Task 3, Epoch 13/20 => Loss 0.157, Train_accy 89.98:  60%|██████    | 12/20 [09:32<05:54, 44.29s/it]
Task 3, Epoch 13/20 => Loss 0.157, Train_accy 89.98:  65%|██████▌   | 13/20 [09:32<05:03, 43.42s/it]
Task 3, Epoch 14/20 => Loss 0.174, Train_accy 90.34:  65%|██████▌   | 13/20 [10:14<05:03, 43.42s/it]
Task 3, Epoch 14/20 => Loss 0.174, Train_accy 90.34:  70%|███████   | 14/20 [10:14<04:16, 42.78s/it]
Task 3, Epoch 15/20 => Loss 0.145, Train_accy 92.12:  70%|███████   | 14/20 [10:55<04:16, 42.78s/it]
Task 3, Epoch 15/20 => Loss 0.145, Train_accy 92.12:  75%|███████▌  | 15/20 [10:55<03:31, 42.33s/it]
Task 3, Epoch 16/20 => Loss 0.142, Train_accy 91.38, Test_accy 77.28:  75%|███████▌  | 15/20 [11:49<03:31, 42.33s/it]
Task 3, Epoch 16/20 => Loss 0.142, Train_accy 91.38, Test_accy 77.28:  80%|████████  | 16/20 [11:49<03:03, 45.76s/it]
Task 3, Epoch 17/20 => Loss 0.148, Train_accy 91.78:  80%|████████  | 16/20 [12:30<03:03, 45.76s/it]                 
Task 3, Epoch 17/20 => Loss 0.148, Train_accy 91.78:  85%|████████▌ | 17/20 [12:30<02:13, 44.34s/it]
Task 3, Epoch 18/20 => Loss 0.132, Train_accy 92.52:  85%|████████▌ | 17/20 [13:11<02:13, 44.34s/it]
Task 3, Epoch 18/20 => Loss 0.132, Train_accy 92.52:  90%|█████████ | 18/20 [13:11<01:26, 43.46s/it]
Task 3, Epoch 19/20 => Loss 0.139, Train_accy 92.24:  90%|█████████ | 18/20 [13:52<01:26, 43.46s/it]
Task 3, Epoch 19/20 => Loss 0.139, Train_accy 92.24:  95%|█████████▌| 19/20 [13:52<00:42, 42.76s/it]
Task 3, Epoch 20/20 => Loss 0.143, Train_accy 92.60:  95%|█████████▌| 19/20 [14:33<00:42, 42.76s/it]
Task 3, Epoch 20/20 => Loss 0.143, Train_accy 92.60: 100%|██████████| 20/20 [14:33<00:00, 42.23s/it]
Task 3, Epoch 20/20 => Loss 0.143, Train_accy 92.60: 100%|██████████| 20/20 [14:33<00:00, 43.69s/it]
2024-09-12 11:41:00,332 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.143, Train_accy 92.60
2024-09-12 11:41:12,807 [trainer.py] => No NME accuracy.
2024-09-12 11:41:12,807 [trainer.py] => CNN: {'total': 77.68, '00-09': 57.3, '10-19': 70.6, '20-29': 87.5, '30-39': 95.3, 'old': 71.8, 'new': 95.3}
2024-09-12 11:41:12,808 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3, 77.68]
2024-09-12 11:41:12,808 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5, 97.5]

Average Accuracy (CNN): 87.5
2024-09-12 11:41:12,808 [trainer.py] => Average Accuracy (CNN): 87.5 

2024-09-12 11:41:12,810 [trainer.py] => All params: 85829416
2024-09-12 11:41:12,811 [trainer.py] => Trainable params: 85829416
2024-09-12 11:41:12,813 [finetune.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.457, Train_accy 45.76, Test_accy 75.10:   0%|          | 0/20 [00:56<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.457, Train_accy 45.76, Test_accy 75.10:   5%|▌         | 1/20 [00:56<18:00, 56.85s/it]
Task 4, Epoch 2/20 => Loss 0.215, Train_accy 66.06:   5%|▌         | 1/20 [01:37<18:00, 56.85s/it]                 
Task 4, Epoch 2/20 => Loss 0.215, Train_accy 66.06:  10%|█         | 2/20 [01:37<14:16, 47.60s/it]
Task 4, Epoch 3/20 => Loss 0.177, Train_accy 71.78:  10%|█         | 2/20 [02:19<14:16, 47.60s/it]
Task 4, Epoch 3/20 => Loss 0.177, Train_accy 71.78:  15%|█▌        | 3/20 [02:19<12:39, 44.66s/it]
Task 4, Epoch 4/20 => Loss 0.183, Train_accy 73.38:  15%|█▌        | 3/20 [03:00<12:39, 44.66s/it]
Task 4, Epoch 4/20 => Loss 0.183, Train_accy 73.38:  20%|██        | 4/20 [03:00<11:35, 43.49s/it]
Task 4, Epoch 5/20 => Loss 0.168, Train_accy 74.80:  20%|██        | 4/20 [03:42<11:35, 43.49s/it]
Task 4, Epoch 5/20 => Loss 0.168, Train_accy 74.80:  25%|██▌       | 5/20 [03:42<10:40, 42.69s/it]
Task 4, Epoch 6/20 => Loss 0.165, Train_accy 77.14, Test_accy 76.44:  25%|██▌       | 5/20 [04:38<10:40, 42.69s/it]
Task 4, Epoch 6/20 => Loss 0.165, Train_accy 77.14, Test_accy 76.44:  30%|███       | 6/20 [04:38<11:04, 47.47s/it]
Task 4, Epoch 7/20 => Loss 0.172, Train_accy 78.16:  30%|███       | 6/20 [05:20<11:04, 47.47s/it]                 
Task 4, Epoch 7/20 => Loss 0.172, Train_accy 78.16:  35%|███▌      | 7/20 [05:20<09:51, 45.49s/it]
Task 4, Epoch 8/20 => Loss 0.132, Train_accy 80.10:  35%|███▌      | 7/20 [06:01<09:51, 45.49s/it]
Task 4, Epoch 8/20 => Loss 0.132, Train_accy 80.10:  40%|████      | 8/20 [06:01<08:48, 44.08s/it]
Task 4, Epoch 9/20 => Loss 0.127, Train_accy 81.30:  40%|████      | 8/20 [06:42<08:48, 44.08s/it]
Task 4, Epoch 9/20 => Loss 0.127, Train_accy 81.30:  45%|████▌     | 9/20 [06:42<07:55, 43.21s/it]
Task 4, Epoch 10/20 => Loss 0.134, Train_accy 81.16:  45%|████▌     | 9/20 [07:24<07:55, 43.21s/it]
Task 4, Epoch 10/20 => Loss 0.134, Train_accy 81.16:  50%|█████     | 10/20 [07:24<07:06, 42.65s/it]
Task 4, Epoch 11/20 => Loss 0.129, Train_accy 81.32, Test_accy 75.46:  50%|█████     | 10/20 [08:20<07:06, 42.65s/it]
Task 4, Epoch 11/20 => Loss 0.129, Train_accy 81.32, Test_accy 75.46:  55%|█████▌    | 11/20 [08:20<07:01, 46.84s/it]
Task 4, Epoch 12/20 => Loss 0.139, Train_accy 81.14:  55%|█████▌    | 11/20 [09:01<07:01, 46.84s/it]                 
Task 4, Epoch 12/20 => Loss 0.139, Train_accy 81.14:  60%|██████    | 12/20 [09:01<06:00, 45.08s/it]
Task 4, Epoch 13/20 => Loss 0.139, Train_accy 82.56:  60%|██████    | 12/20 [09:43<06:00, 45.08s/it]
Task 4, Epoch 13/20 => Loss 0.139, Train_accy 82.56:  65%|██████▌   | 13/20 [09:43<05:08, 44.02s/it]
Task 4, Epoch 14/20 => Loss 0.139, Train_accy 82.66:  65%|██████▌   | 13/20 [10:24<05:08, 44.02s/it]
Task 4, Epoch 14/20 => Loss 0.139, Train_accy 82.66:  70%|███████   | 14/20 [10:24<04:18, 43.13s/it]
Task 4, Epoch 15/20 => Loss 0.115, Train_accy 84.08:  70%|███████   | 14/20 [11:05<04:18, 43.13s/it]
Task 4, Epoch 15/20 => Loss 0.115, Train_accy 84.08:  75%|███████▌  | 15/20 [11:05<03:32, 42.59s/it]
Task 4, Epoch 16/20 => Loss 0.131, Train_accy 83.16, Test_accy 74.54:  75%|███████▌  | 15/20 [12:02<03:32, 42.59s/it]
Task 4, Epoch 16/20 => Loss 0.131, Train_accy 83.16, Test_accy 74.54:  80%|████████  | 16/20 [12:02<03:07, 46.88s/it]
Task 4, Epoch 17/20 => Loss 0.119, Train_accy 84.30:  80%|████████  | 16/20 [12:43<03:07, 46.88s/it]                 
Task 4, Epoch 17/20 => Loss 0.119, Train_accy 84.30:  85%|████████▌ | 17/20 [12:43<02:15, 45.15s/it]
Task 4, Epoch 18/20 => Loss 0.132, Train_accy 83.10:  85%|████████▌ | 17/20 [13:24<02:15, 45.15s/it]
Task 4, Epoch 18/20 => Loss 0.132, Train_accy 83.10:  90%|█████████ | 18/20 [13:24<01:27, 44.00s/it]
Task 4, Epoch 19/20 => Loss 0.114, Train_accy 84.12:  90%|█████████ | 18/20 [14:05<01:27, 44.00s/it]
Task 4, Epoch 19/20 => Loss 0.114, Train_accy 84.12:  95%|█████████▌| 19/20 [14:05<00:43, 43.15s/it]
Task 4, Epoch 20/20 => Loss 0.118, Train_accy 84.74:  95%|█████████▌| 19/20 [14:46<00:43, 43.15s/it]
Task 4, Epoch 20/20 => Loss 0.118, Train_accy 84.74: 100%|██████████| 20/20 [14:46<00:00, 42.46s/it]
Task 4, Epoch 20/20 => Loss 0.118, Train_accy 84.74: 100%|██████████| 20/20 [14:46<00:00, 44.34s/it]
2024-09-12 11:55:59,572 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.118, Train_accy 84.74
2024-09-12 11:56:15,251 [trainer.py] => No NME accuracy.
2024-09-12 11:56:15,251 [trainer.py] => CNN: {'total': 73.38, '00-09': 48.2, '10-19': 64.1, '20-29': 74.2, '30-39': 90.8, '40-49': 89.6, 'old': 69.32, 'new': 89.6}
2024-09-12 11:56:15,251 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3, 77.68, 73.38]
2024-09-12 11:56:15,252 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5, 97.5, 97.32]

Average Accuracy (CNN): 84.67
2024-09-12 11:56:15,252 [trainer.py] => Average Accuracy (CNN): 84.67 

2024-09-12 11:56:15,254 [trainer.py] => All params: 85837106
2024-09-12 11:56:15,255 [trainer.py] => Trainable params: 85837106
2024-09-12 11:56:15,258 [finetune.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.524, Train_accy 42.86, Test_accy 72.75:   0%|          | 0/20 [01:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.524, Train_accy 42.86, Test_accy 72.75:   5%|▌         | 1/20 [01:00<19:02, 60.12s/it]
Task 5, Epoch 2/20 => Loss 0.270, Train_accy 65.64:   5%|▌         | 1/20 [01:41<19:02, 60.12s/it]                 
Task 5, Epoch 2/20 => Loss 0.270, Train_accy 65.64:  10%|█         | 2/20 [01:41<14:40, 48.90s/it]
Task 5, Epoch 3/20 => Loss 0.237, Train_accy 72.98:  10%|█         | 2/20 [02:22<14:40, 48.90s/it]
Task 5, Epoch 3/20 => Loss 0.237, Train_accy 72.98:  15%|█▌        | 3/20 [02:22<12:50, 45.31s/it]
Task 5, Epoch 4/20 => Loss 0.226, Train_accy 76.34:  15%|█▌        | 3/20 [03:03<12:50, 45.31s/it]
Task 5, Epoch 4/20 => Loss 0.226, Train_accy 76.34:  20%|██        | 4/20 [03:03<11:40, 43.78s/it]
Task 5, Epoch 5/20 => Loss 0.204, Train_accy 78.30:  20%|██        | 4/20 [03:44<11:40, 43.78s/it]
Task 5, Epoch 5/20 => Loss 0.204, Train_accy 78.30:  25%|██▌       | 5/20 [03:44<10:40, 42.72s/it]
Task 5, Epoch 6/20 => Loss 0.188, Train_accy 81.86, Test_accy 74.40:  25%|██▌       | 5/20 [04:44<10:40, 42.72s/it]
Task 5, Epoch 6/20 => Loss 0.188, Train_accy 81.86, Test_accy 74.40:  30%|███       | 6/20 [04:44<11:19, 48.54s/it]
Task 5, Epoch 7/20 => Loss 0.178, Train_accy 83.30:  30%|███       | 6/20 [05:25<11:19, 48.54s/it]                 
Task 5, Epoch 7/20 => Loss 0.178, Train_accy 83.30:  35%|███▌      | 7/20 [05:25<10:00, 46.16s/it]
Task 5, Epoch 8/20 => Loss 0.187, Train_accy 83.94:  35%|███▌      | 7/20 [06:06<10:00, 46.16s/it]
Task 5, Epoch 8/20 => Loss 0.187, Train_accy 83.94:  40%|████      | 8/20 [06:06<08:53, 44.48s/it]
Task 5, Epoch 9/20 => Loss 0.179, Train_accy 85.92:  40%|████      | 8/20 [06:48<08:53, 44.48s/it]
Task 5, Epoch 9/20 => Loss 0.179, Train_accy 85.92:  45%|████▌     | 9/20 [06:48<07:59, 43.59s/it]
Task 5, Epoch 10/20 => Loss 0.193, Train_accy 86.16:  45%|████▌     | 9/20 [07:29<07:59, 43.59s/it]
Task 5, Epoch 10/20 => Loss 0.193, Train_accy 86.16:  50%|█████     | 10/20 [07:29<07:08, 42.82s/it]
Task 5, Epoch 11/20 => Loss 0.170, Train_accy 85.94, Test_accy 74.98:  50%|█████     | 10/20 [08:29<07:08, 42.82s/it]
Task 5, Epoch 11/20 => Loss 0.170, Train_accy 85.94, Test_accy 74.98:  55%|█████▌    | 11/20 [08:29<07:12, 48.02s/it]
Task 5, Epoch 12/20 => Loss 0.153, Train_accy 86.24:  55%|█████▌    | 11/20 [09:10<07:12, 48.02s/it]                 
Task 5, Epoch 12/20 => Loss 0.153, Train_accy 86.24:  60%|██████    | 12/20 [09:10<06:08, 46.09s/it]
Task 5, Epoch 13/20 => Loss 0.140, Train_accy 88.48:  60%|██████    | 12/20 [09:51<06:08, 46.09s/it]
Task 5, Epoch 13/20 => Loss 0.140, Train_accy 88.48:  65%|██████▌   | 13/20 [09:51<05:11, 44.53s/it]
Task 5, Epoch 14/20 => Loss 0.155, Train_accy 88.28:  65%|██████▌   | 13/20 [10:33<05:11, 44.53s/it]
Task 5, Epoch 14/20 => Loss 0.155, Train_accy 88.28:  70%|███████   | 14/20 [10:33<04:21, 43.59s/it]
Task 5, Epoch 15/20 => Loss 0.150, Train_accy 88.86:  70%|███████   | 14/20 [11:14<04:21, 43.59s/it]
Task 5, Epoch 15/20 => Loss 0.150, Train_accy 88.86:  75%|███████▌  | 15/20 [11:14<03:34, 42.82s/it]
Task 5, Epoch 16/20 => Loss 0.161, Train_accy 88.90, Test_accy 74.72:  75%|███████▌  | 15/20 [12:13<03:34, 42.82s/it]
Task 5, Epoch 16/20 => Loss 0.161, Train_accy 88.90, Test_accy 74.72:  80%|████████  | 16/20 [12:13<03:11, 47.91s/it]
Task 5, Epoch 17/20 => Loss 0.141, Train_accy 89.88:  80%|████████  | 16/20 [12:54<03:11, 47.91s/it]                 
Task 5, Epoch 17/20 => Loss 0.141, Train_accy 89.88:  85%|████████▌ | 17/20 [12:54<02:17, 45.87s/it]
Task 5, Epoch 18/20 => Loss 0.132, Train_accy 90.20:  85%|████████▌ | 17/20 [13:36<02:17, 45.87s/it]
Task 5, Epoch 18/20 => Loss 0.132, Train_accy 90.20:  90%|█████████ | 18/20 [13:36<01:28, 44.45s/it]
Task 5, Epoch 19/20 => Loss 0.153, Train_accy 89.62:  90%|█████████ | 18/20 [14:17<01:28, 44.45s/it]
Task 5, Epoch 19/20 => Loss 0.153, Train_accy 89.62:  95%|█████████▌| 19/20 [14:17<00:43, 43.46s/it]
Task 5, Epoch 20/20 => Loss 0.150, Train_accy 90.24:  95%|█████████▌| 19/20 [14:58<00:43, 43.46s/it]
Task 5, Epoch 20/20 => Loss 0.150, Train_accy 90.24: 100%|██████████| 20/20 [14:58<00:00, 42.68s/it]
Task 5, Epoch 20/20 => Loss 0.150, Train_accy 90.24: 100%|██████████| 20/20 [14:58<00:00, 44.90s/it]
2024-09-12 12:11:13,388 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.150, Train_accy 90.24
2024-09-12 12:11:31,830 [trainer.py] => No NME accuracy.
2024-09-12 12:11:31,830 [trainer.py] => CNN: {'total': 73.63, '00-09': 46.3, '10-19': 68.1, '20-29': 70.4, '30-39': 81.8, '40-49': 81.1, '50-59': 94.1, 'old': 69.54, 'new': 94.1}
2024-09-12 12:11:31,831 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3, 77.68, 73.38, 73.63]
2024-09-12 12:11:31,831 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5, 97.5, 97.32, 96.67]

Average Accuracy (CNN): 82.83
2024-09-12 12:11:31,831 [trainer.py] => Average Accuracy (CNN): 82.83 

2024-09-12 12:11:31,832 [trainer.py] => All params: 85844796
2024-09-12 12:11:31,833 [trainer.py] => Trainable params: 85844796
2024-09-12 12:11:31,836 [finetune.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.465, Train_accy 59.76, Test_accy 74.19:   0%|          | 0/20 [01:02<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.465, Train_accy 59.76, Test_accy 74.19:   5%|▌         | 1/20 [01:02<19:54, 62.86s/it]
Task 6, Epoch 2/20 => Loss 0.210, Train_accy 76.54:   5%|▌         | 1/20 [01:44<19:54, 62.86s/it]                 
Task 6, Epoch 2/20 => Loss 0.210, Train_accy 76.54:  10%|█         | 2/20 [01:44<15:05, 50.29s/it]
Task 6, Epoch 3/20 => Loss 0.178, Train_accy 78.82:  10%|█         | 2/20 [02:25<15:05, 50.29s/it]
Task 6, Epoch 3/20 => Loss 0.178, Train_accy 78.82:  15%|█▌        | 3/20 [02:25<13:03, 46.06s/it]
Task 6, Epoch 4/20 => Loss 0.155, Train_accy 82.28:  15%|█▌        | 3/20 [03:06<13:03, 46.06s/it]
Task 6, Epoch 4/20 => Loss 0.155, Train_accy 82.28:  20%|██        | 4/20 [03:06<11:44, 44.01s/it]
Task 6, Epoch 5/20 => Loss 0.172, Train_accy 82.36:  20%|██        | 4/20 [03:47<11:44, 44.01s/it]
Task 6, Epoch 5/20 => Loss 0.172, Train_accy 82.36:  25%|██▌       | 5/20 [03:47<10:46, 43.12s/it]
Task 6, Epoch 6/20 => Loss 0.175, Train_accy 82.10, Test_accy 73.33:  25%|██▌       | 5/20 [04:50<10:46, 43.12s/it]
Task 6, Epoch 6/20 => Loss 0.175, Train_accy 82.10, Test_accy 73.33:  30%|███       | 6/20 [04:50<11:37, 49.80s/it]
Task 6, Epoch 7/20 => Loss 0.127, Train_accy 85.40:  30%|███       | 6/20 [05:31<11:37, 49.80s/it]                 
Task 6, Epoch 7/20 => Loss 0.127, Train_accy 85.40:  35%|███▌      | 7/20 [05:31<10:10, 46.98s/it]
Task 6, Epoch 8/20 => Loss 0.154, Train_accy 85.00:  35%|███▌      | 7/20 [06:12<10:10, 46.98s/it]
Task 6, Epoch 8/20 => Loss 0.154, Train_accy 85.00:  40%|████      | 8/20 [06:12<09:00, 45.05s/it]
Task 6, Epoch 9/20 => Loss 0.144, Train_accy 86.00:  40%|████      | 8/20 [06:54<09:00, 45.05s/it]
Task 6, Epoch 9/20 => Loss 0.144, Train_accy 86.00:  45%|████▌     | 9/20 [06:54<08:03, 43.93s/it]
Task 6, Epoch 10/20 => Loss 0.136, Train_accy 86.00:  45%|████▌     | 9/20 [07:35<08:03, 43.93s/it]
Task 6, Epoch 10/20 => Loss 0.136, Train_accy 86.00:  50%|█████     | 10/20 [07:35<07:10, 43.00s/it]
Task 6, Epoch 11/20 => Loss 0.115, Train_accy 87.82, Test_accy 71.71:  50%|█████     | 10/20 [08:37<07:10, 43.00s/it]
Task 6, Epoch 11/20 => Loss 0.115, Train_accy 87.82, Test_accy 71.71:  55%|█████▌    | 11/20 [08:37<07:20, 48.94s/it]
Task 6, Epoch 12/20 => Loss 0.135, Train_accy 87.50:  55%|█████▌    | 11/20 [09:19<07:20, 48.94s/it]                 
Task 6, Epoch 12/20 => Loss 0.135, Train_accy 87.50:  60%|██████    | 12/20 [09:19<06:13, 46.70s/it]
Task 6, Epoch 13/20 => Loss 0.137, Train_accy 86.52:  60%|██████    | 12/20 [10:00<06:13, 46.70s/it]
Task 6, Epoch 13/20 => Loss 0.137, Train_accy 86.52:  65%|██████▌   | 13/20 [10:00<05:14, 44.99s/it]
Task 6, Epoch 14/20 => Loss 0.127, Train_accy 87.32:  65%|██████▌   | 13/20 [10:41<05:14, 44.99s/it]
Task 6, Epoch 14/20 => Loss 0.127, Train_accy 87.32:  70%|███████   | 14/20 [10:41<04:23, 43.87s/it]
Task 6, Epoch 15/20 => Loss 0.118, Train_accy 88.68:  70%|███████   | 14/20 [11:22<04:23, 43.87s/it]
Task 6, Epoch 15/20 => Loss 0.118, Train_accy 88.68:  75%|███████▌  | 15/20 [11:22<03:35, 43.10s/it]
Task 6, Epoch 16/20 => Loss 0.115, Train_accy 89.24, Test_accy 73.06:  75%|███████▌  | 15/20 [12:25<03:35, 43.10s/it]
Task 6, Epoch 16/20 => Loss 0.115, Train_accy 89.24, Test_accy 73.06:  80%|████████  | 16/20 [12:25<03:16, 49.06s/it]
Task 6, Epoch 17/20 => Loss 0.128, Train_accy 88.96:  80%|████████  | 16/20 [13:06<03:16, 49.06s/it]                 
Task 6, Epoch 17/20 => Loss 0.128, Train_accy 88.96:  85%|████████▌ | 17/20 [13:06<02:19, 46.63s/it]
Task 6, Epoch 18/20 => Loss 0.121, Train_accy 90.04:  85%|████████▌ | 17/20 [13:47<02:19, 46.63s/it]
Task 6, Epoch 18/20 => Loss 0.121, Train_accy 90.04:  90%|█████████ | 18/20 [13:47<01:30, 45.01s/it]
Task 6, Epoch 19/20 => Loss 0.138, Train_accy 89.24:  90%|█████████ | 18/20 [14:29<01:30, 45.01s/it]
Task 6, Epoch 19/20 => Loss 0.138, Train_accy 89.24:  95%|█████████▌| 19/20 [14:29<00:43, 43.94s/it]
Task 6, Epoch 20/20 => Loss 0.113, Train_accy 91.08:  95%|█████████▌| 19/20 [15:10<00:43, 43.94s/it]
Task 6, Epoch 20/20 => Loss 0.113, Train_accy 91.08: 100%|██████████| 20/20 [15:10<00:00, 43.01s/it]
Task 6, Epoch 20/20 => Loss 0.113, Train_accy 91.08: 100%|██████████| 20/20 [15:10<00:00, 45.50s/it]
2024-09-12 12:26:41,936 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.113, Train_accy 91.08
2024-09-12 12:27:03,570 [trainer.py] => No NME accuracy.
2024-09-12 12:27:03,570 [trainer.py] => CNN: {'total': 71.79, '00-09': 43.2, '10-19': 58.4, '20-29': 70.3, '30-39': 79.7, '40-49': 74.2, '50-59': 82.8, '60-69': 93.9, 'old': 68.1, 'new': 93.9}
2024-09-12 12:27:03,570 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3, 77.68, 73.38, 73.63, 71.79]
2024-09-12 12:27:03,571 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5, 97.5, 97.32, 96.67, 95.87]

Average Accuracy (CNN): 81.25
2024-09-12 12:27:03,571 [trainer.py] => Average Accuracy (CNN): 81.25 

2024-09-12 12:27:03,572 [trainer.py] => All params: 85852486
2024-09-12 12:27:03,573 [trainer.py] => Trainable params: 85852486
2024-09-12 12:27:03,575 [finetune.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.540, Train_accy 43.92, Test_accy 68.53:   0%|          | 0/20 [01:06<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.540, Train_accy 43.92, Test_accy 68.53:   5%|▌         | 1/20 [01:06<20:54, 66.02s/it]
Task 7, Epoch 2/20 => Loss 0.251, Train_accy 69.50:   5%|▌         | 1/20 [01:47<20:54, 66.02s/it]                 
Task 7, Epoch 2/20 => Loss 0.251, Train_accy 69.50:  10%|█         | 2/20 [01:47<15:23, 51.31s/it]
Task 7, Epoch 3/20 => Loss 0.215, Train_accy 75.06:  10%|█         | 2/20 [02:28<15:23, 51.31s/it]
Task 7, Epoch 3/20 => Loss 0.215, Train_accy 75.06:  15%|█▌        | 3/20 [02:28<13:12, 46.64s/it]
Task 7, Epoch 4/20 => Loss 0.199, Train_accy 79.68:  15%|█▌        | 3/20 [03:09<13:12, 46.64s/it]
Task 7, Epoch 4/20 => Loss 0.199, Train_accy 79.68:  20%|██        | 4/20 [03:09<11:55, 44.69s/it]
Task 7, Epoch 5/20 => Loss 0.204, Train_accy 80.94:  20%|██        | 4/20 [03:50<11:55, 44.69s/it]
Task 7, Epoch 5/20 => Loss 0.204, Train_accy 80.94:  25%|██▌       | 5/20 [03:50<10:49, 43.31s/it]
Task 7, Epoch 6/20 => Loss 0.179, Train_accy 82.52, Test_accy 71.56:  25%|██▌       | 5/20 [04:56<10:49, 43.31s/it]
Task 7, Epoch 6/20 => Loss 0.179, Train_accy 82.52, Test_accy 71.56:  30%|███       | 6/20 [04:56<11:53, 51.00s/it]
Task 7, Epoch 7/20 => Loss 0.167, Train_accy 85.18:  30%|███       | 6/20 [05:37<11:53, 51.00s/it]                 
Task 7, Epoch 7/20 => Loss 0.167, Train_accy 85.18:  35%|███▌      | 7/20 [05:37<10:21, 47.80s/it]
Task 7, Epoch 8/20 => Loss 0.172, Train_accy 85.82:  35%|███▌      | 7/20 [06:19<10:21, 47.80s/it]
Task 7, Epoch 8/20 => Loss 0.172, Train_accy 85.82:  40%|████      | 8/20 [06:19<09:10, 45.85s/it]
Task 7, Epoch 9/20 => Loss 0.164, Train_accy 85.68:  40%|████      | 8/20 [07:00<09:10, 45.85s/it]
Task 7, Epoch 9/20 => Loss 0.164, Train_accy 85.68:  45%|████▌     | 9/20 [07:00<08:08, 44.39s/it]
Task 7, Epoch 10/20 => Loss 0.160, Train_accy 86.46:  45%|████▌     | 9/20 [07:41<08:08, 44.39s/it]
Task 7, Epoch 10/20 => Loss 0.160, Train_accy 86.46:  50%|█████     | 10/20 [07:41<07:14, 43.44s/it]
Task 7, Epoch 11/20 => Loss 0.148, Train_accy 87.54, Test_accy 70.00:  50%|█████     | 10/20 [08:47<07:14, 43.44s/it]
Task 7, Epoch 11/20 => Loss 0.148, Train_accy 87.54, Test_accy 70.00:  55%|█████▌    | 11/20 [08:47<07:32, 50.30s/it]
Task 7, Epoch 12/20 => Loss 0.149, Train_accy 87.84:  55%|█████▌    | 11/20 [09:29<07:32, 50.30s/it]                 
Task 7, Epoch 12/20 => Loss 0.149, Train_accy 87.84:  60%|██████    | 12/20 [09:29<06:21, 47.65s/it]
Task 7, Epoch 13/20 => Loss 0.162, Train_accy 87.94:  60%|██████    | 12/20 [10:10<06:21, 47.65s/it]
Task 7, Epoch 13/20 => Loss 0.162, Train_accy 87.94:  65%|██████▌   | 13/20 [10:10<05:19, 45.60s/it]
Task 7, Epoch 14/20 => Loss 0.134, Train_accy 89.26:  65%|██████▌   | 13/20 [10:51<05:19, 45.60s/it]
Task 7, Epoch 14/20 => Loss 0.134, Train_accy 89.26:  70%|███████   | 14/20 [10:51<04:26, 44.37s/it]
Task 7, Epoch 15/20 => Loss 0.131, Train_accy 89.40:  70%|███████   | 14/20 [11:32<04:26, 44.37s/it]
Task 7, Epoch 15/20 => Loss 0.131, Train_accy 89.40:  75%|███████▌  | 15/20 [11:32<03:36, 43.32s/it]
Task 7, Epoch 16/20 => Loss 0.115, Train_accy 90.28, Test_accy 68.01:  75%|███████▌  | 15/20 [12:38<03:36, 43.32s/it]
Task 7, Epoch 16/20 => Loss 0.115, Train_accy 90.28, Test_accy 68.01:  80%|████████  | 16/20 [12:38<03:20, 50.17s/it]
Task 7, Epoch 17/20 => Loss 0.142, Train_accy 89.44:  80%|████████  | 16/20 [13:19<03:20, 50.17s/it]                 
Task 7, Epoch 17/20 => Loss 0.142, Train_accy 89.44:  85%|████████▌ | 17/20 [13:19<02:22, 47.39s/it]
Task 7, Epoch 18/20 => Loss 0.133, Train_accy 89.32:  85%|████████▌ | 17/20 [14:01<02:22, 47.39s/it]
Task 7, Epoch 18/20 => Loss 0.133, Train_accy 89.32:  90%|█████████ | 18/20 [14:01<01:31, 45.64s/it]
Task 7, Epoch 19/20 => Loss 0.137, Train_accy 90.34:  90%|█████████ | 18/20 [14:42<01:31, 45.64s/it]
Task 7, Epoch 19/20 => Loss 0.137, Train_accy 90.34:  95%|█████████▌| 19/20 [14:42<00:44, 44.25s/it]
Task 7, Epoch 20/20 => Loss 0.127, Train_accy 90.38:  95%|█████████▌| 19/20 [15:23<00:44, 44.25s/it]
Task 7, Epoch 20/20 => Loss 0.127, Train_accy 90.38: 100%|██████████| 20/20 [15:23<00:00, 43.31s/it]
Task 7, Epoch 20/20 => Loss 0.127, Train_accy 90.38: 100%|██████████| 20/20 [15:23<00:00, 46.17s/it]
2024-09-12 12:42:27,048 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.127, Train_accy 90.38
2024-09-12 12:42:51,548 [trainer.py] => No NME accuracy.
2024-09-12 12:42:51,548 [trainer.py] => CNN: {'total': 67.5, '00-09': 37.2, '10-19': 53.2, '20-29': 69.3, '30-39': 72.1, '40-49': 69.8, '50-59': 64.2, '60-69': 82.7, '70-79': 91.5, 'old': 64.07, 'new': 91.5}
2024-09-12 12:42:51,549 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3, 77.68, 73.38, 73.63, 71.79, 67.5]
2024-09-12 12:42:51,549 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5, 97.5, 97.32, 96.67, 95.87, 95.04]

Average Accuracy (CNN): 79.54
2024-09-12 12:42:51,549 [trainer.py] => Average Accuracy (CNN): 79.54 

2024-09-12 12:42:51,549 [trainer.py] => All params: 85860176
2024-09-12 12:42:51,550 [trainer.py] => Trainable params: 85860176
2024-09-12 12:42:51,551 [finetune.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.499, Train_accy 45.98, Test_accy 68.09:   0%|          | 0/20 [01:09<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.499, Train_accy 45.98, Test_accy 68.09:   5%|▌         | 1/20 [01:09<21:52, 69.10s/it]
Task 8, Epoch 2/20 => Loss 0.241, Train_accy 67.50:   5%|▌         | 1/20 [01:50<21:52, 69.10s/it]                 
Task 8, Epoch 2/20 => Loss 0.241, Train_accy 67.50:  10%|█         | 2/20 [01:50<15:45, 52.54s/it]
Task 8, Epoch 3/20 => Loss 0.207, Train_accy 73.92:  10%|█         | 2/20 [02:31<15:45, 52.54s/it]
Task 8, Epoch 3/20 => Loss 0.207, Train_accy 73.92:  15%|█▌        | 3/20 [02:31<13:26, 47.46s/it]
Task 8, Epoch 4/20 => Loss 0.201, Train_accy 77.38:  15%|█▌        | 3/20 [03:12<13:26, 47.46s/it]
Task 8, Epoch 4/20 => Loss 0.201, Train_accy 77.38:  20%|██        | 4/20 [03:12<11:59, 44.98s/it]
Task 8, Epoch 5/20 => Loss 0.183, Train_accy 80.32:  20%|██        | 4/20 [03:53<11:59, 44.98s/it]
Task 8, Epoch 5/20 => Loss 0.183, Train_accy 80.32:  25%|██▌       | 5/20 [03:53<10:53, 43.56s/it]
Task 8, Epoch 6/20 => Loss 0.176, Train_accy 82.80, Test_accy 69.18:  25%|██▌       | 5/20 [05:03<10:53, 43.56s/it]
Task 8, Epoch 6/20 => Loss 0.176, Train_accy 82.80, Test_accy 69.18:  30%|███       | 6/20 [05:03<12:12, 52.32s/it]
Task 8, Epoch 7/20 => Loss 0.175, Train_accy 83.18:  30%|███       | 6/20 [05:43<12:12, 52.32s/it]                 
Task 8, Epoch 7/20 => Loss 0.175, Train_accy 83.18:  35%|███▌      | 7/20 [05:43<10:31, 48.58s/it]
Task 8, Epoch 8/20 => Loss 0.166, Train_accy 83.52:  35%|███▌      | 7/20 [06:25<10:31, 48.58s/it]
Task 8, Epoch 8/20 => Loss 0.166, Train_accy 83.52:  40%|████      | 8/20 [06:25<09:15, 46.33s/it]
Task 8, Epoch 9/20 => Loss 0.155, Train_accy 83.40:  40%|████      | 8/20 [07:06<09:15, 46.33s/it]
Task 8, Epoch 9/20 => Loss 0.155, Train_accy 83.40:  45%|████▌     | 9/20 [07:06<08:12, 44.77s/it]
Task 8, Epoch 10/20 => Loss 0.173, Train_accy 84.58:  45%|████▌     | 9/20 [07:47<08:12, 44.77s/it]
Task 8, Epoch 10/20 => Loss 0.173, Train_accy 84.58:  50%|█████     | 10/20 [07:47<07:16, 43.61s/it]
Task 8, Epoch 11/20 => Loss 0.169, Train_accy 85.32, Test_accy 69.02:  50%|█████     | 10/20 [08:56<07:16, 43.61s/it]
Task 8, Epoch 11/20 => Loss 0.169, Train_accy 85.32, Test_accy 69.02:  55%|█████▌    | 11/20 [08:56<07:41, 51.32s/it]
Task 8, Epoch 12/20 => Loss 0.139, Train_accy 87.06:  55%|█████▌    | 11/20 [09:37<07:41, 51.32s/it]                 
Task 8, Epoch 12/20 => Loss 0.139, Train_accy 87.06:  60%|██████    | 12/20 [09:37<06:25, 48.22s/it]
Task 8, Epoch 13/20 => Loss 0.158, Train_accy 85.56:  60%|██████    | 12/20 [10:19<06:25, 48.22s/it]
Task 8, Epoch 13/20 => Loss 0.158, Train_accy 85.56:  65%|██████▌   | 13/20 [10:19<05:23, 46.25s/it]
Task 8, Epoch 14/20 => Loss 0.157, Train_accy 86.04:  65%|██████▌   | 13/20 [11:00<05:23, 46.25s/it]
Task 8, Epoch 14/20 => Loss 0.157, Train_accy 86.04:  70%|███████   | 14/20 [11:00<04:28, 44.68s/it]
Task 8, Epoch 15/20 => Loss 0.142, Train_accy 87.32:  70%|███████   | 14/20 [11:41<04:28, 44.68s/it]
Task 8, Epoch 15/20 => Loss 0.142, Train_accy 87.32:  75%|███████▌  | 15/20 [11:41<03:37, 43.60s/it]
Task 8, Epoch 16/20 => Loss 0.144, Train_accy 87.08, Test_accy 68.97:  75%|███████▌  | 15/20 [12:50<03:37, 43.60s/it]
Task 8, Epoch 16/20 => Loss 0.144, Train_accy 87.08, Test_accy 68.97:  80%|████████  | 16/20 [12:50<03:24, 51.25s/it]
Task 8, Epoch 17/20 => Loss 0.149, Train_accy 86.76:  80%|████████  | 16/20 [13:31<03:24, 51.25s/it]                 
Task 8, Epoch 17/20 => Loss 0.149, Train_accy 86.76:  85%|████████▌ | 17/20 [13:31<02:24, 48.29s/it]
Task 8, Epoch 18/20 => Loss 0.130, Train_accy 87.84:  85%|████████▌ | 17/20 [14:13<02:24, 48.29s/it]
Task 8, Epoch 18/20 => Loss 0.130, Train_accy 87.84:  90%|█████████ | 18/20 [14:13<01:32, 46.11s/it]
Task 8, Epoch 19/20 => Loss 0.133, Train_accy 89.34:  90%|█████████ | 18/20 [14:54<01:32, 46.11s/it]
Task 8, Epoch 19/20 => Loss 0.133, Train_accy 89.34:  95%|█████████▌| 19/20 [14:54<00:44, 44.59s/it]
Task 8, Epoch 20/20 => Loss 0.125, Train_accy 89.72:  95%|█████████▌| 19/20 [15:35<00:44, 44.59s/it]
Task 8, Epoch 20/20 => Loss 0.125, Train_accy 89.72: 100%|██████████| 20/20 [15:35<00:00, 43.62s/it]
Task 8, Epoch 20/20 => Loss 0.125, Train_accy 89.72: 100%|██████████| 20/20 [15:35<00:00, 46.77s/it]
2024-09-12 12:58:27,010 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.125, Train_accy 89.72
2024-09-12 12:58:54,770 [trainer.py] => No NME accuracy.
2024-09-12 12:58:54,770 [trainer.py] => CNN: {'total': 67.54, '00-09': 35.8, '10-19': 48.8, '20-29': 64.5, '30-39': 69.3, '40-49': 64.8, '50-59': 68.9, '60-69': 78.8, '70-79': 83.6, '80-89': 93.4, 'old': 64.31, 'new': 93.4}
2024-09-12 12:58:54,770 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3, 77.68, 73.38, 73.63, 71.79, 67.5, 67.54]
2024-09-12 12:58:54,771 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5, 97.5, 97.32, 96.67, 95.87, 95.04, 94.53]

Average Accuracy (CNN): 78.2
2024-09-12 12:58:54,772 [trainer.py] => Average Accuracy (CNN): 78.2 

2024-09-12 12:58:54,774 [trainer.py] => All params: 85867866
2024-09-12 12:58:54,775 [trainer.py] => Trainable params: 85867866
2024-09-12 12:58:54,777 [finetune.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.584, Train_accy 52.98, Test_accy 68.84:   0%|          | 0/20 [01:11<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.584, Train_accy 52.98, Test_accy 68.84:   5%|▌         | 1/20 [01:11<22:37, 71.43s/it]
Task 9, Epoch 2/20 => Loss 0.267, Train_accy 73.92:   5%|▌         | 1/20 [01:53<22:37, 71.43s/it]                 
Task 9, Epoch 2/20 => Loss 0.267, Train_accy 73.92:  10%|█         | 2/20 [01:53<16:13, 54.09s/it]
Task 9, Epoch 3/20 => Loss 0.234, Train_accy 78.18:  10%|█         | 2/20 [02:34<16:13, 54.09s/it]
Task 9, Epoch 3/20 => Loss 0.234, Train_accy 78.18:  15%|█▌        | 3/20 [02:34<13:38, 48.16s/it]
Task 9, Epoch 4/20 => Loss 0.229, Train_accy 80.66:  15%|█▌        | 3/20 [03:15<13:38, 48.16s/it]
Task 9, Epoch 4/20 => Loss 0.229, Train_accy 80.66:  20%|██        | 4/20 [03:15<12:07, 45.47s/it]
Task 9, Epoch 5/20 => Loss 0.224, Train_accy 80.96:  20%|██        | 4/20 [03:57<12:07, 45.47s/it]
Task 9, Epoch 5/20 => Loss 0.224, Train_accy 80.96:  25%|██▌       | 5/20 [03:57<11:00, 44.01s/it]
Task 9, Epoch 6/20 => Loss 0.203, Train_accy 84.62, Test_accy 70.10:  25%|██▌       | 5/20 [05:08<11:00, 44.01s/it]
Task 9, Epoch 6/20 => Loss 0.203, Train_accy 84.62, Test_accy 70.10:  30%|███       | 6/20 [05:08<12:27, 53.38s/it]
Task 9, Epoch 7/20 => Loss 0.183, Train_accy 85.88:  30%|███       | 6/20 [05:50<12:27, 53.38s/it]                 
Task 9, Epoch 7/20 => Loss 0.183, Train_accy 85.88:  35%|███▌      | 7/20 [05:50<10:45, 49.64s/it]
Task 9, Epoch 8/20 => Loss 0.185, Train_accy 86.76:  35%|███▌      | 7/20 [06:32<10:45, 49.64s/it]
Task 9, Epoch 8/20 => Loss 0.185, Train_accy 86.76:  40%|████      | 8/20 [06:32<09:23, 46.98s/it]
Task 9, Epoch 9/20 => Loss 0.162, Train_accy 87.18:  40%|████      | 8/20 [07:13<09:23, 46.98s/it]
Task 9, Epoch 9/20 => Loss 0.162, Train_accy 87.18:  45%|████▌     | 9/20 [07:13<08:17, 45.19s/it]
Task 9, Epoch 10/20 => Loss 0.168, Train_accy 87.12:  45%|████▌     | 9/20 [07:54<08:17, 45.19s/it]
Task 9, Epoch 10/20 => Loss 0.168, Train_accy 87.12:  50%|█████     | 10/20 [07:54<07:20, 44.04s/it]
Task 9, Epoch 11/20 => Loss 0.175, Train_accy 88.34, Test_accy 68.97:  50%|█████     | 10/20 [09:06<07:20, 44.04s/it]
Task 9, Epoch 11/20 => Loss 0.175, Train_accy 88.34, Test_accy 68.97:  55%|█████▌    | 11/20 [09:06<07:52, 52.45s/it]
Task 9, Epoch 12/20 => Loss 0.158, Train_accy 89.06:  55%|█████▌    | 11/20 [09:47<07:52, 52.45s/it]                 
Task 9, Epoch 12/20 => Loss 0.158, Train_accy 89.06:  60%|██████    | 12/20 [09:47<06:33, 49.15s/it]
Task 9, Epoch 13/20 => Loss 0.144, Train_accy 89.04:  60%|██████    | 12/20 [10:28<06:33, 49.15s/it]
Task 9, Epoch 13/20 => Loss 0.144, Train_accy 89.04:  65%|██████▌   | 13/20 [10:28<05:26, 46.70s/it]
Task 9, Epoch 14/20 => Loss 0.148, Train_accy 89.28:  65%|██████▌   | 13/20 [11:10<05:26, 46.70s/it]
Task 9, Epoch 14/20 => Loss 0.148, Train_accy 89.28:  70%|███████   | 14/20 [11:10<04:30, 45.12s/it]
Task 9, Epoch 15/20 => Loss 0.153, Train_accy 89.54:  70%|███████   | 14/20 [11:51<04:30, 45.12s/it]
Task 9, Epoch 15/20 => Loss 0.153, Train_accy 89.54:  75%|███████▌  | 15/20 [11:51<03:39, 43.93s/it]
Task 9, Epoch 16/20 => Loss 0.159, Train_accy 89.64, Test_accy 67.78:  75%|███████▌  | 15/20 [13:03<03:39, 43.93s/it]
Task 9, Epoch 16/20 => Loss 0.159, Train_accy 89.64, Test_accy 67.78:  80%|████████  | 16/20 [13:03<03:28, 52.20s/it]
Task 9, Epoch 17/20 => Loss 0.150, Train_accy 90.50:  80%|████████  | 16/20 [13:44<03:28, 52.20s/it]                 
Task 9, Epoch 17/20 => Loss 0.150, Train_accy 90.50:  85%|████████▌ | 17/20 [13:44<02:27, 49.05s/it]
Task 9, Epoch 18/20 => Loss 0.143, Train_accy 90.82:  85%|████████▌ | 17/20 [14:25<02:27, 49.05s/it]
Task 9, Epoch 18/20 => Loss 0.143, Train_accy 90.82:  90%|█████████ | 18/20 [14:25<01:33, 46.65s/it]
Task 9, Epoch 19/20 => Loss 0.141, Train_accy 91.20:  90%|█████████ | 18/20 [15:06<01:33, 46.65s/it]
Task 9, Epoch 19/20 => Loss 0.141, Train_accy 91.20:  95%|█████████▌| 19/20 [15:06<00:44, 44.97s/it]
Task 9, Epoch 20/20 => Loss 0.132, Train_accy 92.14:  95%|█████████▌| 19/20 [15:48<00:44, 44.97s/it]
Task 9, Epoch 20/20 => Loss 0.132, Train_accy 92.14: 100%|██████████| 20/20 [15:48<00:00, 43.98s/it]
Task 9, Epoch 20/20 => Loss 0.132, Train_accy 92.14: 100%|██████████| 20/20 [15:48<00:00, 47.43s/it]
2024-09-12 13:14:43,362 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.132, Train_accy 92.14
2024-09-12 13:15:13,820 [trainer.py] => No NME accuracy.
2024-09-12 13:15:13,821 [trainer.py] => CNN: {'total': 65.5, '00-09': 29.4, '10-19': 47.2, '20-29': 61.1, '30-39': 63.8, '40-49': 62.8, '50-59': 60.9, '60-69': 75.1, '70-79': 74.4, '80-89': 85.1, '90-99': 95.2, 'old': 62.2, 'new': 95.2}
2024-09-12 13:15:13,821 [trainer.py] => CNN top1 curve: [98.5, 90.5, 83.3, 77.68, 73.38, 73.63, 71.79, 67.5, 67.54, 65.5]
2024-09-12 13:15:13,821 [trainer.py] => CNN top5 curve: [100.0, 99.5, 98.5, 97.5, 97.32, 96.67, 95.87, 95.04, 94.53, 93.31]

Average Accuracy (CNN): 76.93
2024-09-12 13:15:13,821 [trainer.py] => Average Accuracy (CNN): 76.93 

Accuracy Matrix (CNN):
[[98.5 84.  71.3 57.3 48.2 46.3 43.2 37.2 35.8 29.4]
 [ 0.  97.  81.4 70.6 64.1 68.1 58.4 53.2 48.8 47.2]
 [ 0.   0.  97.2 87.5 74.2 70.4 70.3 69.3 64.5 61.1]
 [ 0.   0.   0.  95.3 90.8 81.8 79.7 72.1 69.3 63.8]
 [ 0.   0.   0.   0.  89.6 81.1 74.2 69.8 64.8 62.8]
 [ 0.   0.   0.   0.   0.  94.1 82.8 64.2 68.9 60.9]
 [ 0.   0.   0.   0.   0.   0.  93.9 82.7 78.8 75.1]
 [ 0.   0.   0.   0.   0.   0.   0.  91.5 83.6 74.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  93.4 85.1]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  95.2]]
2024-09-12 13:15:13,822 [trainer.py] => Forgetting (CNN): 32.3
2024-09-12 13:15:17,313 [trainer.py] => config: ./exps/finetune_cifar_B0_Inc20.json
2024-09-12 13:15:17,313 [trainer.py] => prefix: reproduce
2024-09-12 13:15:17,313 [trainer.py] => dataset: cifar224
2024-09-12 13:15:17,313 [trainer.py] => memory_size: 0
2024-09-12 13:15:17,313 [trainer.py] => memory_per_class: 0
2024-09-12 13:15:17,313 [trainer.py] => fixed_memory: False
2024-09-12 13:15:17,313 [trainer.py] => shuffle: True
2024-09-12 13:15:17,313 [trainer.py] => init_cls: 5
2024-09-12 13:15:17,313 [trainer.py] => increment: 5
2024-09-12 13:15:17,313 [trainer.py] => model_name: finetune
2024-09-12 13:15:17,313 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 13:15:17,313 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 13:15:17,313 [trainer.py] => seed: 1993
2024-09-12 13:15:17,313 [trainer.py] => init_epoch: 20
2024-09-12 13:15:17,313 [trainer.py] => init_lr: 0.001
2024-09-12 13:15:17,313 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 13:15:17,313 [trainer.py] => init_lr_decay: 0.1
2024-09-12 13:15:17,313 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 13:15:17,313 [trainer.py] => epochs: 20
2024-09-12 13:15:17,313 [trainer.py] => lrate: 0.001
2024-09-12 13:15:17,314 [trainer.py] => milestones: [40, 70]
2024-09-12 13:15:17,314 [trainer.py] => lrate_decay: 0.1
2024-09-12 13:15:17,314 [trainer.py] => batch_size: 48
2024-09-12 13:15:17,314 [trainer.py] => weight_decay: 0.0002
2024-09-12 13:15:18,441 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 13:15:20,763 [trainer.py] => All params: 85798656
2024-09-12 13:15:20,764 [trainer.py] => Trainable params: 85798656
2024-09-12 13:15:20,764 [finetune.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.663, Train_accy 75.96, Test_accy 98.00:   0%|          | 0/20 [00:23<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.663, Train_accy 75.96, Test_accy 98.00:   5%|▌         | 1/20 [00:23<07:22, 23.29s/it]
Task 0, Epoch 2/20 => Loss 0.257, Train_accy 91.12:   5%|▌         | 1/20 [00:44<07:22, 23.29s/it]                 
Task 0, Epoch 2/20 => Loss 0.257, Train_accy 91.12:  10%|█         | 2/20 [00:44<06:32, 21.83s/it]
Task 0, Epoch 3/20 => Loss 0.200, Train_accy 92.80:  10%|█         | 2/20 [01:04<06:32, 21.83s/it]
Task 0, Epoch 3/20 => Loss 0.200, Train_accy 92.80:  15%|█▌        | 3/20 [01:04<06:03, 21.37s/it]
Task 0, Epoch 4/20 => Loss 0.202, Train_accy 93.40:  15%|█▌        | 3/20 [01:25<06:03, 21.37s/it]
Task 0, Epoch 4/20 => Loss 0.202, Train_accy 93.40:  20%|██        | 4/20 [01:25<05:36, 21.02s/it]
Task 0, Epoch 5/20 => Loss 0.218, Train_accy 92.56:  20%|██        | 4/20 [01:46<05:36, 21.02s/it]
Task 0, Epoch 5/20 => Loss 0.218, Train_accy 92.56:  25%|██▌       | 5/20 [01:46<05:13, 20.87s/it]
Task 0, Epoch 6/20 => Loss 0.217, Train_accy 93.12, Test_accy 99.40:  25%|██▌       | 5/20 [02:08<05:13, 20.87s/it]
Task 0, Epoch 6/20 => Loss 0.217, Train_accy 93.12, Test_accy 99.40:  30%|███       | 6/20 [02:08<04:59, 21.39s/it]
Task 0, Epoch 7/20 => Loss 0.171, Train_accy 94.12:  30%|███       | 6/20 [02:29<04:59, 21.39s/it]                 
Task 0, Epoch 7/20 => Loss 0.171, Train_accy 94.12:  35%|███▌      | 7/20 [02:29<04:35, 21.16s/it]
Task 0, Epoch 8/20 => Loss 0.133, Train_accy 95.80:  35%|███▌      | 7/20 [02:49<04:35, 21.16s/it]
Task 0, Epoch 8/20 => Loss 0.133, Train_accy 95.80:  40%|████      | 8/20 [02:49<04:12, 21.04s/it]
Task 0, Epoch 9/20 => Loss 0.121, Train_accy 95.84:  40%|████      | 8/20 [03:10<04:12, 21.04s/it]
Task 0, Epoch 9/20 => Loss 0.121, Train_accy 95.84:  45%|████▌     | 9/20 [03:10<03:49, 20.88s/it]
Task 0, Epoch 10/20 => Loss 0.120, Train_accy 95.96:  45%|████▌     | 9/20 [03:31<03:49, 20.88s/it]
Task 0, Epoch 10/20 => Loss 0.120, Train_accy 95.96:  50%|█████     | 10/20 [03:31<03:27, 20.80s/it]
Task 0, Epoch 11/20 => Loss 0.113, Train_accy 96.16, Test_accy 99.20:  50%|█████     | 10/20 [03:53<03:27, 20.80s/it]
Task 0, Epoch 11/20 => Loss 0.113, Train_accy 96.16, Test_accy 99.20:  55%|█████▌    | 11/20 [03:53<03:11, 21.29s/it]
Task 0, Epoch 12/20 => Loss 0.130, Train_accy 95.76:  55%|█████▌    | 11/20 [04:14<03:11, 21.29s/it]                 
Task 0, Epoch 12/20 => Loss 0.130, Train_accy 95.76:  60%|██████    | 12/20 [04:14<02:48, 21.11s/it]
Task 0, Epoch 13/20 => Loss 0.182, Train_accy 93.76:  60%|██████    | 12/20 [04:34<02:48, 21.11s/it]
Task 0, Epoch 13/20 => Loss 0.182, Train_accy 93.76:  65%|██████▌   | 13/20 [04:34<02:26, 20.92s/it]
Task 0, Epoch 14/20 => Loss 0.120, Train_accy 96.00:  65%|██████▌   | 13/20 [04:55<02:26, 20.92s/it]
Task 0, Epoch 14/20 => Loss 0.120, Train_accy 96.00:  70%|███████   | 14/20 [04:55<02:05, 20.83s/it]
Task 0, Epoch 15/20 => Loss 0.139, Train_accy 95.20:  70%|███████   | 14/20 [05:15<02:05, 20.83s/it]
Task 0, Epoch 15/20 => Loss 0.139, Train_accy 95.20:  75%|███████▌  | 15/20 [05:15<01:43, 20.72s/it]
Task 0, Epoch 16/20 => Loss 0.112, Train_accy 95.92, Test_accy 99.40:  75%|███████▌  | 15/20 [05:38<01:43, 20.72s/it]
Task 0, Epoch 16/20 => Loss 0.112, Train_accy 95.92, Test_accy 99.40:  80%|████████  | 16/20 [05:38<01:24, 21.24s/it]
Task 0, Epoch 17/20 => Loss 0.116, Train_accy 96.24:  80%|████████  | 16/20 [05:58<01:24, 21.24s/it]                 
Task 0, Epoch 17/20 => Loss 0.116, Train_accy 96.24:  85%|████████▌ | 17/20 [05:58<01:03, 21.04s/it]
Task 0, Epoch 18/20 => Loss 0.102, Train_accy 96.40:  85%|████████▌ | 17/20 [06:19<01:03, 21.04s/it]
Task 0, Epoch 18/20 => Loss 0.102, Train_accy 96.40:  90%|█████████ | 18/20 [06:19<00:41, 20.89s/it]
Task 0, Epoch 19/20 => Loss 0.105, Train_accy 96.48:  90%|█████████ | 18/20 [06:39<00:41, 20.89s/it]
Task 0, Epoch 19/20 => Loss 0.105, Train_accy 96.48:  95%|█████████▌| 19/20 [06:39<00:20, 20.82s/it]
Task 0, Epoch 20/20 => Loss 0.095, Train_accy 96.20:  95%|█████████▌| 19/20 [07:00<00:20, 20.82s/it]
Task 0, Epoch 20/20 => Loss 0.095, Train_accy 96.20: 100%|██████████| 20/20 [07:00<00:00, 20.73s/it]
Task 0, Epoch 20/20 => Loss 0.095, Train_accy 96.20: 100%|██████████| 20/20 [07:00<00:00, 21.02s/it]
2024-09-12 13:22:21,677 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.095, Train_accy 96.20
2024-09-12 13:22:23,568 [trainer.py] => No NME accuracy.
2024-09-12 13:22:23,568 [trainer.py] => CNN: {'total': 99.8, '00-04': 99.8, 'old': 0, 'new': 99.8}
2024-09-12 13:22:23,568 [trainer.py] => CNN top1 curve: [99.8]
2024-09-12 13:22:23,568 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.8
2024-09-12 13:22:23,568 [trainer.py] => Average Accuracy (CNN): 99.8 

2024-09-12 13:22:23,569 [trainer.py] => All params: 85802501
2024-09-12 13:22:23,569 [trainer.py] => Trainable params: 85802501
2024-09-12 13:22:23,570 [finetune.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.540, Train_accy 67.60, Test_accy 93.30:   0%|          | 0/20 [00:24<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.540, Train_accy 67.60, Test_accy 93.30:   5%|▌         | 1/20 [00:24<07:38, 24.15s/it]
Task 1, Epoch 2/20 => Loss 0.224, Train_accy 89.28:   5%|▌         | 1/20 [00:44<07:38, 24.15s/it]                 
Task 1, Epoch 2/20 => Loss 0.224, Train_accy 89.28:  10%|█         | 2/20 [00:44<06:36, 22.01s/it]
Task 1, Epoch 3/20 => Loss 0.227, Train_accy 88.36:  10%|█         | 2/20 [01:05<06:36, 22.01s/it]
Task 1, Epoch 3/20 => Loss 0.227, Train_accy 88.36:  15%|█▌        | 3/20 [01:05<06:04, 21.45s/it]
Task 1, Epoch 4/20 => Loss 0.201, Train_accy 90.88:  15%|█▌        | 3/20 [01:25<06:04, 21.45s/it]
Task 1, Epoch 4/20 => Loss 0.201, Train_accy 90.88:  20%|██        | 4/20 [01:25<05:37, 21.08s/it]
Task 1, Epoch 5/20 => Loss 0.289, Train_accy 87.00:  20%|██        | 4/20 [01:46<05:37, 21.08s/it]
Task 1, Epoch 5/20 => Loss 0.289, Train_accy 87.00:  25%|██▌       | 5/20 [01:46<05:14, 20.93s/it]
Task 1, Epoch 6/20 => Loss 0.198, Train_accy 91.36, Test_accy 94.60:  25%|██▌       | 5/20 [02:10<05:14, 20.93s/it]
Task 1, Epoch 6/20 => Loss 0.198, Train_accy 91.36, Test_accy 94.60:  30%|███       | 6/20 [02:10<05:07, 22.00s/it]
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 92.12:  30%|███       | 6/20 [02:31<05:07, 22.00s/it]                 
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 92.12:  35%|███▌      | 7/20 [02:31<04:40, 21.57s/it]
Task 1, Epoch 8/20 => Loss 0.151, Train_accy 93.04:  35%|███▌      | 7/20 [02:52<04:40, 21.57s/it]
Task 1, Epoch 8/20 => Loss 0.151, Train_accy 93.04:  40%|████      | 8/20 [02:52<04:15, 21.29s/it]
Task 1, Epoch 9/20 => Loss 0.201, Train_accy 91.60:  40%|████      | 8/20 [03:12<04:15, 21.29s/it]
Task 1, Epoch 9/20 => Loss 0.201, Train_accy 91.60:  45%|████▌     | 9/20 [03:12<03:52, 21.13s/it]
Task 1, Epoch 10/20 => Loss 0.180, Train_accy 91.40:  45%|████▌     | 9/20 [03:33<03:52, 21.13s/it]
Task 1, Epoch 10/20 => Loss 0.180, Train_accy 91.40:  50%|█████     | 10/20 [03:33<03:29, 20.94s/it]
Task 1, Epoch 11/20 => Loss 0.157, Train_accy 92.12, Test_accy 94.00:  50%|█████     | 10/20 [03:57<03:29, 20.94s/it]
Task 1, Epoch 11/20 => Loss 0.157, Train_accy 92.12, Test_accy 94.00:  55%|█████▌    | 11/20 [03:57<03:16, 21.88s/it]
Task 1, Epoch 12/20 => Loss 0.151, Train_accy 92.88:  55%|█████▌    | 11/20 [04:17<03:16, 21.88s/it]                 
Task 1, Epoch 12/20 => Loss 0.151, Train_accy 92.88:  60%|██████    | 12/20 [04:17<02:51, 21.49s/it]
Task 1, Epoch 13/20 => Loss 0.152, Train_accy 93.08:  60%|██████    | 12/20 [04:38<02:51, 21.49s/it]
Task 1, Epoch 13/20 => Loss 0.152, Train_accy 93.08:  65%|██████▌   | 13/20 [04:38<02:28, 21.24s/it]
Task 1, Epoch 14/20 => Loss 0.128, Train_accy 93.40:  65%|██████▌   | 13/20 [04:59<02:28, 21.24s/it]
Task 1, Epoch 14/20 => Loss 0.128, Train_accy 93.40:  70%|███████   | 14/20 [04:59<02:06, 21.04s/it]
Task 1, Epoch 15/20 => Loss 0.117, Train_accy 94.40:  70%|███████   | 14/20 [05:19<02:06, 21.04s/it]
Task 1, Epoch 15/20 => Loss 0.117, Train_accy 94.40:  75%|███████▌  | 15/20 [05:19<01:44, 20.91s/it]
Task 1, Epoch 16/20 => Loss 0.132, Train_accy 94.24, Test_accy 94.60:  75%|███████▌  | 15/20 [05:43<01:44, 20.91s/it]
Task 1, Epoch 16/20 => Loss 0.132, Train_accy 94.24, Test_accy 94.60:  80%|████████  | 16/20 [05:43<01:27, 21.84s/it]
Task 1, Epoch 17/20 => Loss 0.163, Train_accy 92.84:  80%|████████  | 16/20 [06:04<01:27, 21.84s/it]                 
Task 1, Epoch 17/20 => Loss 0.163, Train_accy 92.84:  85%|████████▌ | 17/20 [06:04<01:04, 21.54s/it]
Task 1, Epoch 18/20 => Loss 0.164, Train_accy 92.76:  85%|████████▌ | 17/20 [06:25<01:04, 21.54s/it]
Task 1, Epoch 18/20 => Loss 0.164, Train_accy 92.76:  90%|█████████ | 18/20 [06:25<00:42, 21.21s/it]
Task 1, Epoch 19/20 => Loss 0.137, Train_accy 94.48:  90%|█████████ | 18/20 [06:45<00:42, 21.21s/it]
Task 1, Epoch 19/20 => Loss 0.137, Train_accy 94.48:  95%|█████████▌| 19/20 [06:45<00:21, 21.05s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 93.04:  95%|█████████▌| 19/20 [07:06<00:21, 21.05s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 93.04: 100%|██████████| 20/20 [07:06<00:00, 20.94s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 93.04: 100%|██████████| 20/20 [07:06<00:00, 21.32s/it]
2024-09-12 13:29:30,079 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.154, Train_accy 93.04
2024-09-12 13:29:33,560 [trainer.py] => No NME accuracy.
2024-09-12 13:29:33,560 [trainer.py] => CNN: {'total': 93.2, '00-04': 87.8, '05-09': 98.6, 'old': 87.8, 'new': 98.6}
2024-09-12 13:29:33,560 [trainer.py] => CNN top1 curve: [99.8, 93.2]
2024-09-12 13:29:33,560 [trainer.py] => CNN top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 96.5
2024-09-12 13:29:33,560 [trainer.py] => Average Accuracy (CNN): 96.5 

2024-09-12 13:29:33,561 [trainer.py] => All params: 85806346
2024-09-12 13:29:33,562 [trainer.py] => Trainable params: 85806346
2024-09-12 13:29:33,563 [finetune.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.473, Train_accy 57.00, Test_accy 91.60:   0%|          | 0/20 [00:25<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.473, Train_accy 57.00, Test_accy 91.60:   5%|▌         | 1/20 [00:25<08:08, 25.69s/it]
Task 2, Epoch 2/20 => Loss 0.229, Train_accy 84.60:   5%|▌         | 1/20 [00:46<08:08, 25.69s/it]                 
Task 2, Epoch 2/20 => Loss 0.229, Train_accy 84.60:  10%|█         | 2/20 [00:46<06:50, 22.81s/it]
Task 2, Epoch 3/20 => Loss 0.170, Train_accy 88.88:  10%|█         | 2/20 [01:07<06:50, 22.81s/it]
Task 2, Epoch 3/20 => Loss 0.170, Train_accy 88.88:  15%|█▌        | 3/20 [01:07<06:11, 21.84s/it]
Task 2, Epoch 4/20 => Loss 0.184, Train_accy 88.40:  15%|█▌        | 3/20 [01:27<06:11, 21.84s/it]
Task 2, Epoch 4/20 => Loss 0.184, Train_accy 88.40:  20%|██        | 4/20 [01:27<05:41, 21.36s/it]
Task 2, Epoch 5/20 => Loss 0.158, Train_accy 90.04:  20%|██        | 4/20 [01:48<05:41, 21.36s/it]
Task 2, Epoch 5/20 => Loss 0.158, Train_accy 90.04:  25%|██▌       | 5/20 [01:48<05:15, 21.01s/it]
Task 2, Epoch 6/20 => Loss 0.159, Train_accy 89.52, Test_accy 89.93:  25%|██▌       | 5/20 [02:13<05:15, 21.01s/it]
Task 2, Epoch 6/20 => Loss 0.159, Train_accy 89.52, Test_accy 89.93:  30%|███       | 6/20 [02:13<05:16, 22.59s/it]
Task 2, Epoch 7/20 => Loss 0.146, Train_accy 90.72:  30%|███       | 6/20 [02:34<05:16, 22.59s/it]                 
Task 2, Epoch 7/20 => Loss 0.146, Train_accy 90.72:  35%|███▌      | 7/20 [02:34<04:45, 21.99s/it]
Task 2, Epoch 8/20 => Loss 0.171, Train_accy 89.48:  35%|███▌      | 7/20 [02:55<04:45, 21.99s/it]
Task 2, Epoch 8/20 => Loss 0.171, Train_accy 89.48:  40%|████      | 8/20 [02:55<04:18, 21.57s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 91.04:  40%|████      | 8/20 [03:15<04:18, 21.57s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 91.04:  45%|████▌     | 9/20 [03:15<03:53, 21.25s/it]
Task 2, Epoch 10/20 => Loss 0.153, Train_accy 91.72:  45%|████▌     | 9/20 [03:36<03:53, 21.25s/it]
Task 2, Epoch 10/20 => Loss 0.153, Train_accy 91.72:  50%|█████     | 10/20 [03:36<03:30, 21.07s/it]
Task 2, Epoch 11/20 => Loss 0.155, Train_accy 91.56, Test_accy 89.67:  50%|█████     | 10/20 [04:02<03:30, 21.07s/it]
Task 2, Epoch 11/20 => Loss 0.155, Train_accy 91.56, Test_accy 89.67:  55%|█████▌    | 11/20 [04:02<03:21, 22.44s/it]
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 91.80:  55%|█████▌    | 11/20 [04:23<03:21, 22.44s/it]                 
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 91.80:  60%|██████    | 12/20 [04:23<02:56, 22.00s/it]
Task 2, Epoch 13/20 => Loss 0.124, Train_accy 93.12:  60%|██████    | 12/20 [04:43<02:56, 22.00s/it]
Task 2, Epoch 13/20 => Loss 0.124, Train_accy 93.12:  65%|██████▌   | 13/20 [04:43<02:30, 21.57s/it]
Task 2, Epoch 14/20 => Loss 0.148, Train_accy 91.56:  65%|██████▌   | 13/20 [05:04<02:30, 21.57s/it]
Task 2, Epoch 14/20 => Loss 0.148, Train_accy 91.56:  70%|███████   | 14/20 [05:04<02:08, 21.35s/it]
Task 2, Epoch 15/20 => Loss 0.113, Train_accy 93.08:  70%|███████   | 14/20 [05:25<02:08, 21.35s/it]
Task 2, Epoch 15/20 => Loss 0.113, Train_accy 93.08:  75%|███████▌  | 15/20 [05:25<01:45, 21.19s/it]
Task 2, Epoch 16/20 => Loss 0.119, Train_accy 92.68, Test_accy 90.47:  75%|███████▌  | 15/20 [05:50<01:45, 21.19s/it]
Task 2, Epoch 16/20 => Loss 0.119, Train_accy 92.68, Test_accy 90.47:  80%|████████  | 16/20 [05:50<01:29, 22.41s/it]
Task 2, Epoch 17/20 => Loss 0.111, Train_accy 93.04:  80%|████████  | 16/20 [06:11<01:29, 22.41s/it]                 
Task 2, Epoch 17/20 => Loss 0.111, Train_accy 93.04:  85%|████████▌ | 17/20 [06:11<01:05, 21.87s/it]
Task 2, Epoch 18/20 => Loss 0.121, Train_accy 92.48:  85%|████████▌ | 17/20 [06:31<01:05, 21.87s/it]
Task 2, Epoch 18/20 => Loss 0.121, Train_accy 92.48:  90%|█████████ | 18/20 [06:31<00:42, 21.47s/it]
Task 2, Epoch 19/20 => Loss 0.128, Train_accy 93.08:  90%|█████████ | 18/20 [06:52<00:42, 21.47s/it]
Task 2, Epoch 19/20 => Loss 0.128, Train_accy 93.08:  95%|█████████▌| 19/20 [06:52<00:21, 21.20s/it]
Task 2, Epoch 20/20 => Loss 0.112, Train_accy 93.76:  95%|█████████▌| 19/20 [07:12<00:21, 21.20s/it]
Task 2, Epoch 20/20 => Loss 0.112, Train_accy 93.76: 100%|██████████| 20/20 [07:12<00:00, 20.97s/it]
Task 2, Epoch 20/20 => Loss 0.112, Train_accy 93.76: 100%|██████████| 20/20 [07:12<00:00, 21.63s/it]
2024-09-12 13:36:46,294 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.112, Train_accy 93.76
2024-09-12 13:36:51,379 [trainer.py] => No NME accuracy.
2024-09-12 13:36:51,380 [trainer.py] => CNN: {'total': 87.87, '00-04': 81.8, '05-09': 83.2, '10-14': 98.6, 'old': 82.5, 'new': 98.6}
2024-09-12 13:36:51,380 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87]
2024-09-12 13:36:51,380 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6]

Average Accuracy (CNN): 93.62
2024-09-12 13:36:51,380 [trainer.py] => Average Accuracy (CNN): 93.62 

2024-09-12 13:36:51,382 [trainer.py] => All params: 85810191
2024-09-12 13:36:51,384 [trainer.py] => Trainable params: 85810191
2024-09-12 13:36:51,386 [finetune.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.501, Train_accy 57.36, Test_accy 87.55:   0%|          | 0/20 [00:27<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.501, Train_accy 57.36, Test_accy 87.55:   5%|▌         | 1/20 [00:27<08:35, 27.13s/it]
Task 3, Epoch 2/20 => Loss 0.242, Train_accy 83.44:   5%|▌         | 1/20 [00:47<08:35, 27.13s/it]                 
Task 3, Epoch 2/20 => Loss 0.242, Train_accy 83.44:  10%|█         | 2/20 [00:47<07:01, 23.43s/it]
Task 3, Epoch 3/20 => Loss 0.219, Train_accy 86.32:  10%|█         | 2/20 [01:08<07:01, 23.43s/it]
Task 3, Epoch 3/20 => Loss 0.219, Train_accy 86.32:  15%|█▌        | 3/20 [01:08<06:16, 22.12s/it]
Task 3, Epoch 4/20 => Loss 0.179, Train_accy 88.80:  15%|█▌        | 3/20 [01:29<06:16, 22.12s/it]
Task 3, Epoch 4/20 => Loss 0.179, Train_accy 88.80:  20%|██        | 4/20 [01:29<05:44, 21.50s/it]
Task 3, Epoch 5/20 => Loss 0.155, Train_accy 89.80:  20%|██        | 4/20 [01:49<05:44, 21.50s/it]
Task 3, Epoch 5/20 => Loss 0.155, Train_accy 89.80:  25%|██▌       | 5/20 [01:49<05:18, 21.20s/it]
Task 3, Epoch 6/20 => Loss 0.199, Train_accy 87.52, Test_accy 88.80:  25%|██▌       | 5/20 [02:16<05:18, 21.20s/it]
Task 3, Epoch 6/20 => Loss 0.199, Train_accy 87.52, Test_accy 88.80:  30%|███       | 6/20 [02:16<05:24, 23.18s/it]
Task 3, Epoch 7/20 => Loss 0.175, Train_accy 88.56:  30%|███       | 6/20 [02:37<05:24, 23.18s/it]                 
Task 3, Epoch 7/20 => Loss 0.175, Train_accy 88.56:  35%|███▌      | 7/20 [02:37<04:51, 22.44s/it]
Task 3, Epoch 8/20 => Loss 0.150, Train_accy 89.56:  35%|███▌      | 7/20 [02:58<04:51, 22.44s/it]
Task 3, Epoch 8/20 => Loss 0.150, Train_accy 89.56:  40%|████      | 8/20 [02:58<04:21, 21.79s/it]
Task 3, Epoch 9/20 => Loss 0.160, Train_accy 90.20:  40%|████      | 8/20 [03:18<04:21, 21.79s/it]
Task 3, Epoch 9/20 => Loss 0.160, Train_accy 90.20:  45%|████▌     | 9/20 [03:18<03:55, 21.39s/it]
Task 3, Epoch 10/20 => Loss 0.163, Train_accy 90.64:  45%|████▌     | 9/20 [03:39<03:55, 21.39s/it]
Task 3, Epoch 10/20 => Loss 0.163, Train_accy 90.64:  50%|█████     | 10/20 [03:39<03:31, 21.13s/it]
Task 3, Epoch 11/20 => Loss 0.158, Train_accy 89.68, Test_accy 88.20:  50%|█████     | 10/20 [04:06<03:31, 21.13s/it]
Task 3, Epoch 11/20 => Loss 0.158, Train_accy 89.68, Test_accy 88.20:  55%|█████▌    | 11/20 [04:06<03:26, 22.94s/it]
Task 3, Epoch 12/20 => Loss 0.148, Train_accy 90.96:  55%|█████▌    | 11/20 [04:27<03:26, 22.94s/it]                 
Task 3, Epoch 12/20 => Loss 0.148, Train_accy 90.96:  60%|██████    | 12/20 [04:27<02:58, 22.33s/it]
Task 3, Epoch 13/20 => Loss 0.136, Train_accy 91.80:  60%|██████    | 12/20 [04:47<02:58, 22.33s/it]
Task 3, Epoch 13/20 => Loss 0.136, Train_accy 91.80:  65%|██████▌   | 13/20 [04:47<02:33, 21.88s/it]
Task 3, Epoch 14/20 => Loss 0.142, Train_accy 91.88:  65%|██████▌   | 13/20 [05:08<02:33, 21.88s/it]
Task 3, Epoch 14/20 => Loss 0.142, Train_accy 91.88:  70%|███████   | 14/20 [05:08<02:09, 21.55s/it]
Task 3, Epoch 15/20 => Loss 0.141, Train_accy 91.60:  70%|███████   | 14/20 [05:29<02:09, 21.55s/it]
Task 3, Epoch 15/20 => Loss 0.141, Train_accy 91.60:  75%|███████▌  | 15/20 [05:29<01:46, 21.29s/it]
Task 3, Epoch 16/20 => Loss 0.149, Train_accy 91.48, Test_accy 86.25:  75%|███████▌  | 15/20 [05:56<01:46, 21.29s/it]
Task 3, Epoch 16/20 => Loss 0.149, Train_accy 91.48, Test_accy 86.25:  80%|████████  | 16/20 [05:56<01:32, 23.00s/it]
Task 3, Epoch 17/20 => Loss 0.131, Train_accy 91.56:  80%|████████  | 16/20 [06:17<01:32, 23.00s/it]                 
Task 3, Epoch 17/20 => Loss 0.131, Train_accy 91.56:  85%|████████▌ | 17/20 [06:17<01:07, 22.38s/it]
Task 3, Epoch 18/20 => Loss 0.125, Train_accy 92.40:  85%|████████▌ | 17/20 [06:38<01:07, 22.38s/it]
Task 3, Epoch 18/20 => Loss 0.125, Train_accy 92.40:  90%|█████████ | 18/20 [06:38<00:43, 21.87s/it]
Task 3, Epoch 19/20 => Loss 0.115, Train_accy 93.24:  90%|█████████ | 18/20 [06:58<00:43, 21.87s/it]
Task 3, Epoch 19/20 => Loss 0.115, Train_accy 93.24:  95%|█████████▌| 19/20 [06:58<00:21, 21.51s/it]
Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.28:  95%|█████████▌| 19/20 [07:19<00:21, 21.51s/it]
Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.28: 100%|██████████| 20/20 [07:19<00:00, 21.24s/it]
Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.28: 100%|██████████| 20/20 [07:19<00:00, 21.97s/it]
2024-09-12 13:44:10,760 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.28
2024-09-12 13:44:17,107 [trainer.py] => No NME accuracy.
2024-09-12 13:44:17,107 [trainer.py] => CNN: {'total': 86.0, '00-04': 76.8, '05-09': 80.8, '10-14': 90.0, '15-19': 96.4, 'old': 82.53, 'new': 96.4}
2024-09-12 13:44:17,108 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0]
2024-09-12 13:44:17,108 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3]

Average Accuracy (CNN): 91.72
2024-09-12 13:44:17,108 [trainer.py] => Average Accuracy (CNN): 91.72 

2024-09-12 13:44:17,109 [trainer.py] => All params: 85814036
2024-09-12 13:44:17,110 [trainer.py] => Trainable params: 85814036
2024-09-12 13:44:17,112 [finetune.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.295, Train_accy 61.64, Test_accy 83.36:   0%|          | 0/20 [00:28<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.295, Train_accy 61.64, Test_accy 83.36:   5%|▌         | 1/20 [00:28<09:00, 28.47s/it]
Task 4, Epoch 2/20 => Loss 0.133, Train_accy 90.80:   5%|▌         | 1/20 [00:49<09:00, 28.47s/it]                 
Task 4, Epoch 2/20 => Loss 0.133, Train_accy 90.80:  10%|█         | 2/20 [00:49<07:14, 24.14s/it]
Task 4, Epoch 3/20 => Loss 0.118, Train_accy 91.36:  10%|█         | 2/20 [01:10<07:14, 24.14s/it]
Task 4, Epoch 3/20 => Loss 0.118, Train_accy 91.36:  15%|█▌        | 3/20 [01:10<06:24, 22.61s/it]
Task 4, Epoch 4/20 => Loss 0.088, Train_accy 92.56:  15%|█▌        | 3/20 [01:31<06:24, 22.61s/it]
Task 4, Epoch 4/20 => Loss 0.088, Train_accy 92.56:  20%|██        | 4/20 [01:31<05:50, 21.89s/it]
Task 4, Epoch 5/20 => Loss 0.080, Train_accy 93.44:  20%|██        | 4/20 [01:51<05:50, 21.89s/it]
Task 4, Epoch 5/20 => Loss 0.080, Train_accy 93.44:  25%|██▌       | 5/20 [01:51<05:21, 21.41s/it]
Task 4, Epoch 6/20 => Loss 0.086, Train_accy 93.36, Test_accy 84.60:  25%|██▌       | 5/20 [02:20<05:21, 21.41s/it]
Task 4, Epoch 6/20 => Loss 0.086, Train_accy 93.36, Test_accy 84.60:  30%|███       | 6/20 [02:20<05:33, 23.84s/it]
Task 4, Epoch 7/20 => Loss 0.096, Train_accy 93.16:  30%|███       | 6/20 [02:41<05:33, 23.84s/it]                 
Task 4, Epoch 7/20 => Loss 0.096, Train_accy 93.16:  35%|███▌      | 7/20 [02:41<04:57, 22.89s/it]
Task 4, Epoch 8/20 => Loss 0.118, Train_accy 92.00:  35%|███▌      | 7/20 [03:01<04:57, 22.89s/it]
Task 4, Epoch 8/20 => Loss 0.118, Train_accy 92.00:  40%|████      | 8/20 [03:01<04:26, 22.18s/it]
Task 4, Epoch 9/20 => Loss 0.113, Train_accy 93.88:  40%|████      | 8/20 [03:22<04:26, 22.18s/it]
Task 4, Epoch 9/20 => Loss 0.113, Train_accy 93.88:  45%|████▌     | 9/20 [03:22<03:58, 21.68s/it]
Task 4, Epoch 10/20 => Loss 0.072, Train_accy 94.04:  45%|████▌     | 9/20 [03:43<03:58, 21.68s/it]
Task 4, Epoch 10/20 => Loss 0.072, Train_accy 94.04:  50%|█████     | 10/20 [03:43<03:33, 21.38s/it]
Task 4, Epoch 11/20 => Loss 0.069, Train_accy 95.24, Test_accy 83.12:  50%|█████     | 10/20 [04:11<03:33, 21.38s/it]
Task 4, Epoch 11/20 => Loss 0.069, Train_accy 95.24, Test_accy 83.12:  55%|█████▌    | 11/20 [04:11<03:32, 23.56s/it]
Task 4, Epoch 12/20 => Loss 0.073, Train_accy 95.00:  55%|█████▌    | 11/20 [04:32<03:32, 23.56s/it]                 
Task 4, Epoch 12/20 => Loss 0.073, Train_accy 95.00:  60%|██████    | 12/20 [04:32<03:02, 22.77s/it]
Task 4, Epoch 13/20 => Loss 0.074, Train_accy 95.76:  60%|██████    | 12/20 [04:53<03:02, 22.77s/it]
Task 4, Epoch 13/20 => Loss 0.074, Train_accy 95.76:  65%|██████▌   | 13/20 [04:53<02:35, 22.14s/it]
Task 4, Epoch 14/20 => Loss 0.067, Train_accy 95.84:  65%|██████▌   | 13/20 [05:14<02:35, 22.14s/it]
Task 4, Epoch 14/20 => Loss 0.067, Train_accy 95.84:  70%|███████   | 14/20 [05:14<02:10, 21.73s/it]
Task 4, Epoch 15/20 => Loss 0.068, Train_accy 96.00:  70%|███████   | 14/20 [05:34<02:10, 21.73s/it]
Task 4, Epoch 15/20 => Loss 0.068, Train_accy 96.00:  75%|███████▌  | 15/20 [05:34<01:47, 21.44s/it]
Task 4, Epoch 16/20 => Loss 0.081, Train_accy 95.76, Test_accy 81.04:  75%|███████▌  | 15/20 [06:03<01:47, 21.44s/it]
Task 4, Epoch 16/20 => Loss 0.081, Train_accy 95.76, Test_accy 81.04:  80%|████████  | 16/20 [06:03<01:34, 23.53s/it]
Task 4, Epoch 17/20 => Loss 0.080, Train_accy 94.88:  80%|████████  | 16/20 [06:24<01:34, 23.53s/it]                 
Task 4, Epoch 17/20 => Loss 0.080, Train_accy 94.88:  85%|████████▌ | 17/20 [06:24<01:08, 22.76s/it]
Task 4, Epoch 18/20 => Loss 0.073, Train_accy 95.12:  85%|████████▌ | 17/20 [06:44<01:08, 22.76s/it]
Task 4, Epoch 18/20 => Loss 0.073, Train_accy 95.12:  90%|█████████ | 18/20 [06:44<00:44, 22.05s/it]
Task 4, Epoch 19/20 => Loss 0.078, Train_accy 94.96:  90%|█████████ | 18/20 [07:05<00:44, 22.05s/it]
Task 4, Epoch 19/20 => Loss 0.078, Train_accy 94.96:  95%|█████████▌| 19/20 [07:05<00:21, 21.65s/it]
Task 4, Epoch 20/20 => Loss 0.079, Train_accy 95.44:  95%|█████████▌| 19/20 [07:25<00:21, 21.65s/it]
Task 4, Epoch 20/20 => Loss 0.079, Train_accy 95.44: 100%|██████████| 20/20 [07:25<00:00, 21.29s/it]
Task 4, Epoch 20/20 => Loss 0.079, Train_accy 95.44: 100%|██████████| 20/20 [07:25<00:00, 22.29s/it]
2024-09-12 13:51:42,931 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.079, Train_accy 95.44
2024-09-12 13:51:50,874 [trainer.py] => No NME accuracy.
2024-09-12 13:51:50,875 [trainer.py] => CNN: {'total': 82.64, '00-04': 81.4, '05-09': 71.8, '10-14': 70.2, '15-19': 90.0, '20-24': 99.8, 'old': 78.35, 'new': 99.8}
2024-09-12 13:51:50,875 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64]
2024-09-12 13:51:50,875 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4]

Average Accuracy (CNN): 89.9
2024-09-12 13:51:50,875 [trainer.py] => Average Accuracy (CNN): 89.9 

2024-09-12 13:51:50,877 [trainer.py] => All params: 85817881
2024-09-12 13:51:50,878 [trainer.py] => Trainable params: 85817881
2024-09-12 13:51:50,880 [finetune.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.332, Train_accy 68.20, Test_accy 78.93:   0%|          | 0/20 [00:30<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.332, Train_accy 68.20, Test_accy 78.93:   5%|▌         | 1/20 [00:30<09:30, 30.03s/it]
Task 5, Epoch 2/20 => Loss 0.120, Train_accy 89.96:   5%|▌         | 1/20 [00:50<09:30, 30.03s/it]                 
Task 5, Epoch 2/20 => Loss 0.120, Train_accy 89.96:  10%|█         | 2/20 [00:50<07:21, 24.55s/it]
Task 5, Epoch 3/20 => Loss 0.101, Train_accy 91.96:  10%|█         | 2/20 [01:11<07:21, 24.55s/it]
Task 5, Epoch 3/20 => Loss 0.101, Train_accy 91.96:  15%|█▌        | 3/20 [01:11<06:26, 22.72s/it]
Task 5, Epoch 4/20 => Loss 0.124, Train_accy 91.04:  15%|█▌        | 3/20 [01:31<06:26, 22.72s/it]
Task 5, Epoch 4/20 => Loss 0.124, Train_accy 91.04:  20%|██        | 4/20 [01:31<05:50, 21.89s/it]
Task 5, Epoch 5/20 => Loss 0.102, Train_accy 92.20:  20%|██        | 4/20 [01:52<05:50, 21.89s/it]
Task 5, Epoch 5/20 => Loss 0.102, Train_accy 92.20:  25%|██▌       | 5/20 [01:52<05:20, 21.39s/it]
Task 5, Epoch 6/20 => Loss 0.084, Train_accy 93.72, Test_accy 80.23:  25%|██▌       | 5/20 [02:22<05:20, 21.39s/it]
Task 5, Epoch 6/20 => Loss 0.084, Train_accy 93.72, Test_accy 80.23:  30%|███       | 6/20 [02:22<05:41, 24.37s/it]
Task 5, Epoch 7/20 => Loss 0.099, Train_accy 92.36:  30%|███       | 6/20 [02:43<05:41, 24.37s/it]                 
Task 5, Epoch 7/20 => Loss 0.099, Train_accy 92.36:  35%|███▌      | 7/20 [02:43<05:01, 23.21s/it]
Task 5, Epoch 8/20 => Loss 0.068, Train_accy 94.12:  35%|███▌      | 7/20 [03:04<05:01, 23.21s/it]
Task 5, Epoch 8/20 => Loss 0.068, Train_accy 94.12:  40%|████      | 8/20 [03:04<04:28, 22.41s/it]
Task 5, Epoch 9/20 => Loss 0.070, Train_accy 94.68:  40%|████      | 8/20 [03:24<04:28, 22.41s/it]
Task 5, Epoch 9/20 => Loss 0.070, Train_accy 94.68:  45%|████▌     | 9/20 [03:24<04:00, 21.89s/it]
Task 5, Epoch 10/20 => Loss 0.089, Train_accy 93.56:  45%|████▌     | 9/20 [03:45<04:00, 21.89s/it]
Task 5, Epoch 10/20 => Loss 0.089, Train_accy 93.56:  50%|█████     | 10/20 [03:45<03:34, 21.45s/it]
Task 5, Epoch 11/20 => Loss 0.067, Train_accy 94.12, Test_accy 80.60:  50%|█████     | 10/20 [04:15<03:34, 21.45s/it]
Task 5, Epoch 11/20 => Loss 0.067, Train_accy 94.12, Test_accy 80.60:  55%|█████▌    | 11/20 [04:15<03:36, 24.08s/it]
Task 5, Epoch 12/20 => Loss 0.079, Train_accy 93.84:  55%|█████▌    | 11/20 [04:36<03:36, 24.08s/it]                 
Task 5, Epoch 12/20 => Loss 0.079, Train_accy 93.84:  60%|██████    | 12/20 [04:36<03:04, 23.12s/it]
Task 5, Epoch 13/20 => Loss 0.077, Train_accy 94.72:  60%|██████    | 12/20 [04:56<03:04, 23.12s/it]
Task 5, Epoch 13/20 => Loss 0.077, Train_accy 94.72:  65%|██████▌   | 13/20 [04:56<02:36, 22.38s/it]
Task 5, Epoch 14/20 => Loss 0.079, Train_accy 94.00:  65%|██████▌   | 13/20 [05:17<02:36, 22.38s/it]
Task 5, Epoch 14/20 => Loss 0.079, Train_accy 94.00:  70%|███████   | 14/20 [05:17<02:10, 21.81s/it]
Task 5, Epoch 15/20 => Loss 0.081, Train_accy 94.16:  70%|███████   | 14/20 [05:38<02:10, 21.81s/it]
Task 5, Epoch 15/20 => Loss 0.081, Train_accy 94.16:  75%|███████▌  | 15/20 [05:38<01:47, 21.45s/it]
Task 5, Epoch 16/20 => Loss 0.076, Train_accy 94.68, Test_accy 77.93:  75%|███████▌  | 15/20 [06:08<01:47, 21.45s/it]
Task 5, Epoch 16/20 => Loss 0.076, Train_accy 94.68, Test_accy 77.93:  80%|████████  | 16/20 [06:08<01:36, 24.01s/it]
Task 5, Epoch 17/20 => Loss 0.086, Train_accy 94.28:  80%|████████  | 16/20 [06:29<01:36, 24.01s/it]                 
Task 5, Epoch 17/20 => Loss 0.086, Train_accy 94.28:  85%|████████▌ | 17/20 [06:29<01:09, 23.10s/it]
Task 5, Epoch 18/20 => Loss 0.074, Train_accy 94.00:  85%|████████▌ | 17/20 [06:49<01:09, 23.10s/it]
Task 5, Epoch 18/20 => Loss 0.074, Train_accy 94.00:  90%|█████████ | 18/20 [06:49<00:44, 22.36s/it]
Task 5, Epoch 19/20 => Loss 0.072, Train_accy 94.60:  90%|█████████ | 18/20 [07:10<00:44, 22.36s/it]
Task 5, Epoch 19/20 => Loss 0.072, Train_accy 94.60:  95%|█████████▌| 19/20 [07:10<00:21, 21.85s/it]
Task 5, Epoch 20/20 => Loss 0.068, Train_accy 94.96:  95%|█████████▌| 19/20 [07:31<00:21, 21.85s/it]
Task 5, Epoch 20/20 => Loss 0.068, Train_accy 94.96: 100%|██████████| 20/20 [07:31<00:00, 21.52s/it]
Task 5, Epoch 20/20 => Loss 0.068, Train_accy 94.96: 100%|██████████| 20/20 [07:31<00:00, 22.55s/it]
2024-09-12 13:59:21,951 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.068, Train_accy 94.96
2024-09-12 13:59:31,206 [trainer.py] => No NME accuracy.
2024-09-12 13:59:31,207 [trainer.py] => CNN: {'total': 78.0, '00-04': 69.8, '05-09': 54.6, '10-14': 71.8, '15-19': 76.0, '20-24': 96.6, '25-29': 99.2, 'old': 73.76, 'new': 99.2}
2024-09-12 13:59:31,207 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0]
2024-09-12 13:59:31,207 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9]

Average Accuracy (CNN): 87.92
2024-09-12 13:59:31,208 [trainer.py] => Average Accuracy (CNN): 87.92 

2024-09-12 13:59:31,210 [trainer.py] => All params: 85821726
2024-09-12 13:59:31,211 [trainer.py] => Trainable params: 85821726
2024-09-12 13:59:31,213 [finetune.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.472, Train_accy 49.32, Test_accy 75.40:   0%|          | 0/20 [00:31<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.472, Train_accy 49.32, Test_accy 75.40:   5%|▌         | 1/20 [00:31<10:05, 31.86s/it]
Task 6, Epoch 2/20 => Loss 0.219, Train_accy 79.52:   5%|▌         | 1/20 [00:52<10:05, 31.86s/it]                 
Task 6, Epoch 2/20 => Loss 0.219, Train_accy 79.52:  10%|█         | 2/20 [00:52<07:35, 25.29s/it]
Task 6, Epoch 3/20 => Loss 0.217, Train_accy 80.72:  10%|█         | 2/20 [01:13<07:35, 25.29s/it]
Task 6, Epoch 3/20 => Loss 0.217, Train_accy 80.72:  15%|█▌        | 3/20 [01:13<06:32, 23.10s/it]
Task 6, Epoch 4/20 => Loss 0.200, Train_accy 83.36:  15%|█▌        | 3/20 [01:33<06:32, 23.10s/it]
Task 6, Epoch 4/20 => Loss 0.200, Train_accy 83.36:  20%|██        | 4/20 [01:33<05:53, 22.10s/it]
Task 6, Epoch 5/20 => Loss 0.202, Train_accy 83.04:  20%|██        | 4/20 [01:54<05:53, 22.10s/it]
Task 6, Epoch 5/20 => Loss 0.202, Train_accy 83.04:  25%|██▌       | 5/20 [01:54<05:22, 21.53s/it]
Task 6, Epoch 6/20 => Loss 0.163, Train_accy 85.80, Test_accy 75.34:  25%|██▌       | 5/20 [02:25<05:22, 21.53s/it]
Task 6, Epoch 6/20 => Loss 0.163, Train_accy 85.80, Test_accy 75.34:  30%|███       | 6/20 [02:25<05:48, 24.91s/it]
Task 6, Epoch 7/20 => Loss 0.153, Train_accy 87.68:  30%|███       | 6/20 [02:46<05:48, 24.91s/it]                 
Task 6, Epoch 7/20 => Loss 0.153, Train_accy 87.68:  35%|███▌      | 7/20 [02:46<05:07, 23.66s/it]
Task 6, Epoch 8/20 => Loss 0.133, Train_accy 90.24:  35%|███▌      | 7/20 [03:07<05:07, 23.66s/it]
Task 6, Epoch 8/20 => Loss 0.133, Train_accy 90.24:  40%|████      | 8/20 [03:07<04:32, 22.75s/it]
Task 6, Epoch 9/20 => Loss 0.125, Train_accy 90.80:  40%|████      | 8/20 [03:27<04:32, 22.75s/it]
Task 6, Epoch 9/20 => Loss 0.125, Train_accy 90.80:  45%|████▌     | 9/20 [03:27<04:02, 22.05s/it]
Task 6, Epoch 10/20 => Loss 0.150, Train_accy 88.36:  45%|████▌     | 9/20 [03:48<04:02, 22.05s/it]
Task 6, Epoch 10/20 => Loss 0.150, Train_accy 88.36:  50%|█████     | 10/20 [03:48<03:36, 21.61s/it]
Task 6, Epoch 11/20 => Loss 0.129, Train_accy 87.96, Test_accy 76.20:  50%|█████     | 10/20 [04:19<03:36, 21.61s/it]
Task 6, Epoch 11/20 => Loss 0.129, Train_accy 87.96, Test_accy 76.20:  55%|█████▌    | 11/20 [04:19<03:41, 24.58s/it]
Task 6, Epoch 12/20 => Loss 0.137, Train_accy 88.20:  55%|█████▌    | 11/20 [04:40<03:41, 24.58s/it]                 
Task 6, Epoch 12/20 => Loss 0.137, Train_accy 88.20:  60%|██████    | 12/20 [04:40<03:07, 23.49s/it]
Task 6, Epoch 13/20 => Loss 0.096, Train_accy 92.44:  60%|██████    | 12/20 [05:01<03:07, 23.49s/it]
Task 6, Epoch 13/20 => Loss 0.096, Train_accy 92.44:  65%|██████▌   | 13/20 [05:01<02:38, 22.68s/it]
Task 6, Epoch 14/20 => Loss 0.120, Train_accy 91.28:  65%|██████▌   | 13/20 [05:22<02:38, 22.68s/it]
Task 6, Epoch 14/20 => Loss 0.120, Train_accy 91.28:  70%|███████   | 14/20 [05:22<02:12, 22.03s/it]
Task 6, Epoch 15/20 => Loss 0.093, Train_accy 92.24:  70%|███████   | 14/20 [05:42<02:12, 22.03s/it]
Task 6, Epoch 15/20 => Loss 0.093, Train_accy 92.24:  75%|███████▌  | 15/20 [05:42<01:48, 21.61s/it]
Task 6, Epoch 16/20 => Loss 0.114, Train_accy 91.32, Test_accy 74.91:  75%|███████▌  | 15/20 [06:14<01:48, 21.61s/it]
Task 6, Epoch 16/20 => Loss 0.114, Train_accy 91.32, Test_accy 74.91:  80%|████████  | 16/20 [06:14<01:38, 24.50s/it]
Task 6, Epoch 17/20 => Loss 0.118, Train_accy 91.12:  80%|████████  | 16/20 [06:35<01:38, 24.50s/it]                 
Task 6, Epoch 17/20 => Loss 0.118, Train_accy 91.12:  85%|████████▌ | 17/20 [06:35<01:10, 23.47s/it]
Task 6, Epoch 18/20 => Loss 0.106, Train_accy 91.92:  85%|████████▌ | 17/20 [06:55<01:10, 23.47s/it]
Task 6, Epoch 18/20 => Loss 0.106, Train_accy 91.92:  90%|█████████ | 18/20 [06:55<00:45, 22.63s/it]
Task 6, Epoch 19/20 => Loss 0.109, Train_accy 92.28:  90%|█████████ | 18/20 [07:16<00:45, 22.63s/it]
Task 6, Epoch 19/20 => Loss 0.109, Train_accy 92.28:  95%|█████████▌| 19/20 [07:16<00:22, 22.04s/it]
Task 6, Epoch 20/20 => Loss 0.114, Train_accy 91.16:  95%|█████████▌| 19/20 [07:37<00:22, 22.04s/it]
Task 6, Epoch 20/20 => Loss 0.114, Train_accy 91.16: 100%|██████████| 20/20 [07:37<00:00, 21.61s/it]
Task 6, Epoch 20/20 => Loss 0.114, Train_accy 91.16: 100%|██████████| 20/20 [07:37<00:00, 22.86s/it]
2024-09-12 14:07:08,401 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.114, Train_accy 91.16
2024-09-12 14:07:19,026 [trainer.py] => No NME accuracy.
2024-09-12 14:07:19,027 [trainer.py] => CNN: {'total': 75.29, '00-04': 67.4, '05-09': 49.4, '10-14': 66.8, '15-19': 69.4, '20-24': 81.4, '25-29': 97.8, '30-34': 94.8, 'old': 72.03, 'new': 94.8}
2024-09-12 14:07:19,027 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29]
2024-09-12 14:07:19,027 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43]

Average Accuracy (CNN): 86.11
2024-09-12 14:07:19,027 [trainer.py] => Average Accuracy (CNN): 86.11 

2024-09-12 14:07:19,028 [trainer.py] => All params: 85825571
2024-09-12 14:07:19,028 [trainer.py] => Trainable params: 85825571
2024-09-12 14:07:19,030 [finetune.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.358, Train_accy 58.48, Test_accy 70.85:   0%|          | 0/20 [00:33<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.358, Train_accy 58.48, Test_accy 70.85:   5%|▌         | 1/20 [00:33<10:33, 33.32s/it]
Task 7, Epoch 2/20 => Loss 0.119, Train_accy 84.08:   5%|▌         | 1/20 [00:54<10:33, 33.32s/it]                 
Task 7, Epoch 2/20 => Loss 0.119, Train_accy 84.08:  10%|█         | 2/20 [00:54<07:46, 25.89s/it]
Task 7, Epoch 3/20 => Loss 0.119, Train_accy 85.16:  10%|█         | 2/20 [01:14<07:46, 25.89s/it]
Task 7, Epoch 3/20 => Loss 0.119, Train_accy 85.16:  15%|█▌        | 3/20 [01:14<06:38, 23.45s/it]
Task 7, Epoch 4/20 => Loss 0.101, Train_accy 87.36:  15%|█▌        | 3/20 [01:35<06:38, 23.45s/it]
Task 7, Epoch 4/20 => Loss 0.101, Train_accy 87.36:  20%|██        | 4/20 [01:35<05:56, 22.29s/it]
Task 7, Epoch 5/20 => Loss 0.111, Train_accy 86.56:  20%|██        | 4/20 [01:55<05:56, 22.29s/it]
Task 7, Epoch 5/20 => Loss 0.111, Train_accy 86.56:  25%|██▌       | 5/20 [01:55<05:25, 21.68s/it]
Task 7, Epoch 6/20 => Loss 0.101, Train_accy 87.76, Test_accy 73.70:  25%|██▌       | 5/20 [02:28<05:25, 21.68s/it]
Task 7, Epoch 6/20 => Loss 0.101, Train_accy 87.76, Test_accy 73.70:  30%|███       | 6/20 [02:28<05:56, 25.45s/it]
Task 7, Epoch 7/20 => Loss 0.102, Train_accy 87.84:  30%|███       | 6/20 [02:49<05:56, 25.45s/it]                 
Task 7, Epoch 7/20 => Loss 0.102, Train_accy 87.84:  35%|███▌      | 7/20 [02:49<05:12, 24.01s/it]
Task 7, Epoch 8/20 => Loss 0.091, Train_accy 88.68:  35%|███▌      | 7/20 [03:10<05:12, 24.01s/it]
Task 7, Epoch 8/20 => Loss 0.091, Train_accy 88.68:  40%|████      | 8/20 [03:10<04:35, 22.99s/it]
Task 7, Epoch 9/20 => Loss 0.092, Train_accy 89.64:  40%|████      | 8/20 [03:31<04:35, 22.99s/it]
Task 7, Epoch 9/20 => Loss 0.092, Train_accy 89.64:  45%|████▌     | 9/20 [03:31<04:05, 22.29s/it]
Task 7, Epoch 10/20 => Loss 0.089, Train_accy 89.08:  45%|████▌     | 9/20 [03:51<04:05, 22.29s/it]
Task 7, Epoch 10/20 => Loss 0.089, Train_accy 89.08:  50%|█████     | 10/20 [03:51<03:37, 21.77s/it]
Task 7, Epoch 11/20 => Loss 0.075, Train_accy 89.44, Test_accy 72.68:  50%|█████     | 10/20 [04:24<03:37, 21.77s/it]
Task 7, Epoch 11/20 => Loss 0.075, Train_accy 89.44, Test_accy 72.68:  55%|█████▌    | 11/20 [04:24<03:46, 25.13s/it]
Task 7, Epoch 12/20 => Loss 0.073, Train_accy 91.04:  55%|█████▌    | 11/20 [04:45<03:46, 25.13s/it]                 
Task 7, Epoch 12/20 => Loss 0.073, Train_accy 91.04:  60%|██████    | 12/20 [04:45<03:11, 23.95s/it]
Task 7, Epoch 13/20 => Loss 0.091, Train_accy 88.84:  60%|██████    | 12/20 [05:06<03:11, 23.95s/it]
Task 7, Epoch 13/20 => Loss 0.091, Train_accy 88.84:  65%|██████▌   | 13/20 [05:06<02:40, 22.98s/it]
Task 7, Epoch 14/20 => Loss 0.079, Train_accy 90.36:  65%|██████▌   | 13/20 [05:27<02:40, 22.98s/it]
Task 7, Epoch 14/20 => Loss 0.079, Train_accy 90.36:  70%|███████   | 14/20 [05:27<02:13, 22.28s/it]
Task 7, Epoch 15/20 => Loss 0.074, Train_accy 90.60:  70%|███████   | 14/20 [05:47<02:13, 22.28s/it]
Task 7, Epoch 15/20 => Loss 0.074, Train_accy 90.60:  75%|███████▌  | 15/20 [05:47<01:49, 21.83s/it]
Task 7, Epoch 16/20 => Loss 0.063, Train_accy 91.88, Test_accy 71.22:  75%|███████▌  | 15/20 [06:20<01:49, 21.83s/it]
Task 7, Epoch 16/20 => Loss 0.063, Train_accy 91.88, Test_accy 71.22:  80%|████████  | 16/20 [06:20<01:40, 25.16s/it]
Task 7, Epoch 17/20 => Loss 0.083, Train_accy 90.08:  80%|████████  | 16/20 [06:41<01:40, 25.16s/it]                 
Task 7, Epoch 17/20 => Loss 0.083, Train_accy 90.08:  85%|████████▌ | 17/20 [06:41<01:11, 23.77s/it]
Task 7, Epoch 18/20 => Loss 0.085, Train_accy 90.40:  85%|████████▌ | 17/20 [07:01<01:11, 23.77s/it]
Task 7, Epoch 18/20 => Loss 0.085, Train_accy 90.40:  90%|█████████ | 18/20 [07:01<00:45, 22.81s/it]
Task 7, Epoch 19/20 => Loss 0.071, Train_accy 90.60:  90%|█████████ | 18/20 [07:22<00:45, 22.81s/it]
Task 7, Epoch 19/20 => Loss 0.071, Train_accy 90.60:  95%|█████████▌| 19/20 [07:22<00:22, 22.15s/it]
Task 7, Epoch 20/20 => Loss 0.069, Train_accy 91.40:  95%|█████████▌| 19/20 [07:42<00:22, 22.15s/it]
Task 7, Epoch 20/20 => Loss 0.069, Train_accy 91.40: 100%|██████████| 20/20 [07:42<00:00, 21.65s/it]
Task 7, Epoch 20/20 => Loss 0.069, Train_accy 91.40: 100%|██████████| 20/20 [07:42<00:00, 23.15s/it]
2024-09-12 14:15:01,987 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.069, Train_accy 91.40
2024-09-12 14:15:14,337 [trainer.py] => No NME accuracy.
2024-09-12 14:15:14,337 [trainer.py] => CNN: {'total': 72.28, '00-04': 53.2, '05-09': 49.4, '10-14': 63.2, '15-19': 61.2, '20-24': 79.6, '25-29': 88.8, '30-34': 86.6, '35-39': 96.2, 'old': 68.86, 'new': 96.2}
2024-09-12 14:15:14,337 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28]
2024-09-12 14:15:14,338 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65]

Average Accuracy (CNN): 84.38
2024-09-12 14:15:14,338 [trainer.py] => Average Accuracy (CNN): 84.38 

2024-09-12 14:15:14,340 [trainer.py] => All params: 85829416
2024-09-12 14:15:14,341 [trainer.py] => Trainable params: 85829416
2024-09-12 14:15:14,343 [finetune.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.366, Train_accy 47.76, Test_accy 73.18:   0%|          | 0/20 [00:34<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.366, Train_accy 47.76, Test_accy 73.18:   5%|▌         | 1/20 [00:34<10:59, 34.74s/it]
Task 8, Epoch 2/20 => Loss 0.172, Train_accy 78.84:   5%|▌         | 1/20 [00:55<10:59, 34.74s/it]                 
Task 8, Epoch 2/20 => Loss 0.172, Train_accy 78.84:  10%|█         | 2/20 [00:55<07:56, 26.46s/it]
Task 8, Epoch 3/20 => Loss 0.156, Train_accy 78.92:  10%|█         | 2/20 [01:16<07:56, 26.46s/it]
Task 8, Epoch 3/20 => Loss 0.156, Train_accy 78.92:  15%|█▌        | 3/20 [01:16<06:44, 23.78s/it]
Task 8, Epoch 4/20 => Loss 0.123, Train_accy 83.76:  15%|█▌        | 3/20 [01:36<06:44, 23.78s/it]
Task 8, Epoch 4/20 => Loss 0.123, Train_accy 83.76:  20%|██        | 4/20 [01:36<06:00, 22.52s/it]
Task 8, Epoch 5/20 => Loss 0.113, Train_accy 86.08:  20%|██        | 4/20 [01:57<06:00, 22.52s/it]
Task 8, Epoch 5/20 => Loss 0.113, Train_accy 86.08:  25%|██▌       | 5/20 [01:57<05:26, 21.79s/it]
Task 8, Epoch 6/20 => Loss 0.115, Train_accy 86.36, Test_accy 74.13:  25%|██▌       | 5/20 [02:31<05:26, 21.79s/it]
Task 8, Epoch 6/20 => Loss 0.115, Train_accy 86.36, Test_accy 74.13:  30%|███       | 6/20 [02:31<06:04, 26.05s/it]
Task 8, Epoch 7/20 => Loss 0.104, Train_accy 86.88:  30%|███       | 6/20 [02:52<06:04, 26.05s/it]                 
Task 8, Epoch 7/20 => Loss 0.104, Train_accy 86.88:  35%|███▌      | 7/20 [02:52<05:15, 24.28s/it]
Task 8, Epoch 8/20 => Loss 0.106, Train_accy 87.44:  35%|███▌      | 7/20 [03:12<05:15, 24.28s/it]
Task 8, Epoch 8/20 => Loss 0.106, Train_accy 87.44:  40%|████      | 8/20 [03:12<04:37, 23.09s/it]
Task 8, Epoch 9/20 => Loss 0.108, Train_accy 87.08:  40%|████      | 8/20 [03:33<04:37, 23.09s/it]
Task 8, Epoch 9/20 => Loss 0.108, Train_accy 87.08:  45%|████▌     | 9/20 [03:33<04:05, 22.30s/it]
Task 8, Epoch 10/20 => Loss 0.099, Train_accy 88.16:  45%|████▌     | 9/20 [03:53<04:05, 22.30s/it]
Task 8, Epoch 10/20 => Loss 0.099, Train_accy 88.16:  50%|█████     | 10/20 [03:53<03:37, 21.74s/it]
Task 8, Epoch 11/20 => Loss 0.094, Train_accy 89.56, Test_accy 70.80:  50%|█████     | 10/20 [04:28<03:37, 21.74s/it]
Task 8, Epoch 11/20 => Loss 0.094, Train_accy 89.56, Test_accy 70.80:  55%|█████▌    | 11/20 [04:28<03:52, 25.81s/it]
Task 8, Epoch 12/20 => Loss 0.089, Train_accy 88.64:  55%|█████▌    | 11/20 [04:49<03:52, 25.81s/it]                 
Task 8, Epoch 12/20 => Loss 0.089, Train_accy 88.64:  60%|██████    | 12/20 [04:49<03:13, 24.21s/it]
Task 8, Epoch 13/20 => Loss 0.099, Train_accy 89.96:  60%|██████    | 12/20 [05:09<03:13, 24.21s/it]
Task 8, Epoch 13/20 => Loss 0.099, Train_accy 89.96:  65%|██████▌   | 13/20 [05:09<02:41, 23.11s/it]
Task 8, Epoch 14/20 => Loss 0.102, Train_accy 89.96:  65%|██████▌   | 13/20 [05:30<02:41, 23.11s/it]
Task 8, Epoch 14/20 => Loss 0.102, Train_accy 89.96:  70%|███████   | 14/20 [05:30<02:13, 22.29s/it]
Task 8, Epoch 15/20 => Loss 0.099, Train_accy 91.32:  70%|███████   | 14/20 [05:50<02:13, 22.29s/it]
Task 8, Epoch 15/20 => Loss 0.099, Train_accy 91.32:  75%|███████▌  | 15/20 [05:50<01:48, 21.77s/it]
Task 8, Epoch 16/20 => Loss 0.090, Train_accy 90.72, Test_accy 70.11:  75%|███████▌  | 15/20 [06:25<01:48, 21.77s/it]
Task 8, Epoch 16/20 => Loss 0.090, Train_accy 90.72, Test_accy 70.11:  80%|████████  | 16/20 [06:25<01:42, 25.54s/it]
Task 8, Epoch 17/20 => Loss 0.100, Train_accy 90.60:  80%|████████  | 16/20 [06:45<01:42, 25.54s/it]                 
Task 8, Epoch 17/20 => Loss 0.100, Train_accy 90.60:  85%|████████▌ | 17/20 [06:45<01:12, 24.07s/it]
Task 8, Epoch 18/20 => Loss 0.080, Train_accy 91.88:  85%|████████▌ | 17/20 [07:06<01:12, 24.07s/it]
Task 8, Epoch 18/20 => Loss 0.080, Train_accy 91.88:  90%|█████████ | 18/20 [07:06<00:46, 23.04s/it]
Task 8, Epoch 19/20 => Loss 0.113, Train_accy 89.88:  90%|█████████ | 18/20 [07:26<00:46, 23.04s/it]
Task 8, Epoch 19/20 => Loss 0.113, Train_accy 89.88:  95%|█████████▌| 19/20 [07:26<00:22, 22.27s/it]
Task 8, Epoch 20/20 => Loss 0.095, Train_accy 89.72:  95%|█████████▌| 19/20 [07:47<00:22, 22.27s/it]
Task 8, Epoch 20/20 => Loss 0.095, Train_accy 89.72: 100%|██████████| 20/20 [07:47<00:00, 21.75s/it]
Task 8, Epoch 20/20 => Loss 0.095, Train_accy 89.72: 100%|██████████| 20/20 [07:47<00:00, 23.37s/it]
2024-09-12 14:23:01,770 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.095, Train_accy 89.72
2024-09-12 14:23:15,491 [trainer.py] => No NME accuracy.
2024-09-12 14:23:15,492 [trainer.py] => CNN: {'total': 71.02, '00-04': 50.0, '05-09': 49.8, '10-14': 57.2, '15-19': 53.4, '20-24': 70.8, '25-29': 82.4, '30-34': 87.8, '35-39': 91.8, '40-44': 96.0, 'old': 67.9, 'new': 96.0}
2024-09-12 14:23:15,492 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02]
2024-09-12 14:23:15,492 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07]

Average Accuracy (CNN): 82.9
2024-09-12 14:23:15,492 [trainer.py] => Average Accuracy (CNN): 82.9 

2024-09-12 14:23:15,494 [trainer.py] => All params: 85833261
2024-09-12 14:23:15,495 [trainer.py] => Trainable params: 85833261
2024-09-12 14:23:15,497 [finetune.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.260, Train_accy 46.80, Test_accy 65.90:   0%|          | 0/20 [00:36<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.260, Train_accy 46.80, Test_accy 65.90:   5%|▌         | 1/20 [00:36<11:27, 36.18s/it]
Task 9, Epoch 2/20 => Loss 0.108, Train_accy 66.52:   5%|▌         | 1/20 [00:56<11:27, 36.18s/it]                 
Task 9, Epoch 2/20 => Loss 0.108, Train_accy 66.52:  10%|█         | 2/20 [00:56<08:07, 27.11s/it]
Task 9, Epoch 3/20 => Loss 0.077, Train_accy 70.56:  10%|█         | 2/20 [01:17<08:07, 27.11s/it]
Task 9, Epoch 3/20 => Loss 0.077, Train_accy 70.56:  15%|█▌        | 3/20 [01:17<06:49, 24.12s/it]
Task 9, Epoch 4/20 => Loss 0.071, Train_accy 72.88:  15%|█▌        | 3/20 [01:37<06:49, 24.12s/it]
Task 9, Epoch 4/20 => Loss 0.071, Train_accy 72.88:  20%|██        | 4/20 [01:37<06:02, 22.67s/it]
Task 9, Epoch 5/20 => Loss 0.061, Train_accy 73.28:  20%|██        | 4/20 [01:58<06:02, 22.67s/it]
Task 9, Epoch 5/20 => Loss 0.061, Train_accy 73.28:  25%|██▌       | 5/20 [01:58<05:28, 21.90s/it]
Task 9, Epoch 6/20 => Loss 0.073, Train_accy 72.80, Test_accy 65.88:  25%|██▌       | 5/20 [02:34<05:28, 21.90s/it]
Task 9, Epoch 6/20 => Loss 0.073, Train_accy 72.80, Test_accy 65.88:  30%|███       | 6/20 [02:34<06:12, 26.60s/it]
Task 9, Epoch 7/20 => Loss 0.078, Train_accy 71.84:  30%|███       | 6/20 [02:54<06:12, 26.60s/it]                 
Task 9, Epoch 7/20 => Loss 0.078, Train_accy 71.84:  35%|███▌      | 7/20 [02:54<05:19, 24.61s/it]
Task 9, Epoch 8/20 => Loss 0.049, Train_accy 74.24:  35%|███▌      | 7/20 [03:15<05:19, 24.61s/it]
Task 9, Epoch 8/20 => Loss 0.049, Train_accy 74.24:  40%|████      | 8/20 [03:15<04:39, 23.26s/it]
Task 9, Epoch 9/20 => Loss 0.056, Train_accy 74.36:  40%|████      | 8/20 [03:35<04:39, 23.26s/it]
Task 9, Epoch 9/20 => Loss 0.056, Train_accy 74.36:  45%|████▌     | 9/20 [03:35<04:06, 22.41s/it]
Task 9, Epoch 10/20 => Loss 0.067, Train_accy 73.84:  45%|████▌     | 9/20 [03:56<04:06, 22.41s/it]
Task 9, Epoch 10/20 => Loss 0.067, Train_accy 73.84:  50%|█████     | 10/20 [03:56<03:38, 21.85s/it]
Task 9, Epoch 11/20 => Loss 0.050, Train_accy 74.24, Test_accy 65.06:  50%|█████     | 10/20 [04:32<03:38, 21.85s/it]
Task 9, Epoch 11/20 => Loss 0.050, Train_accy 74.24, Test_accy 65.06:  55%|█████▌    | 11/20 [04:32<03:56, 26.29s/it]
Task 9, Epoch 12/20 => Loss 0.055, Train_accy 73.84:  55%|█████▌    | 11/20 [04:53<03:56, 26.29s/it]                 
Task 9, Epoch 12/20 => Loss 0.055, Train_accy 73.84:  60%|██████    | 12/20 [04:53<03:16, 24.60s/it]
Task 9, Epoch 13/20 => Loss 0.054, Train_accy 74.72:  60%|██████    | 12/20 [05:13<03:16, 24.60s/it]
Task 9, Epoch 13/20 => Loss 0.054, Train_accy 74.72:  65%|██████▌   | 13/20 [05:14<02:43, 23.41s/it]
Task 9, Epoch 14/20 => Loss 0.048, Train_accy 75.56:  65%|██████▌   | 13/20 [05:34<02:43, 23.41s/it]
Task 9, Epoch 14/20 => Loss 0.048, Train_accy 75.56:  70%|███████   | 14/20 [05:34<02:15, 22.57s/it]
Task 9, Epoch 15/20 => Loss 0.059, Train_accy 75.16:  70%|███████   | 14/20 [05:55<02:15, 22.57s/it]
Task 9, Epoch 15/20 => Loss 0.059, Train_accy 75.16:  75%|███████▌  | 15/20 [05:55<01:50, 22.01s/it]
Task 9, Epoch 16/20 => Loss 0.057, Train_accy 74.52, Test_accy 65.48:  75%|███████▌  | 15/20 [06:31<01:50, 22.01s/it]
Task 9, Epoch 16/20 => Loss 0.057, Train_accy 74.52, Test_accy 65.48:  80%|████████  | 16/20 [06:31<01:44, 26.14s/it]
Task 9, Epoch 17/20 => Loss 0.056, Train_accy 74.80:  80%|████████  | 16/20 [06:51<01:44, 26.14s/it]                 
Task 9, Epoch 17/20 => Loss 0.056, Train_accy 74.80:  85%|████████▌ | 17/20 [06:51<01:13, 24.40s/it]
Task 9, Epoch 18/20 => Loss 0.042, Train_accy 75.24:  85%|████████▌ | 17/20 [07:12<01:13, 24.40s/it]
Task 9, Epoch 18/20 => Loss 0.042, Train_accy 75.24:  90%|█████████ | 18/20 [07:12<00:46, 23.26s/it]
Task 9, Epoch 19/20 => Loss 0.057, Train_accy 74.44:  90%|█████████ | 18/20 [07:32<00:46, 23.26s/it]
Task 9, Epoch 19/20 => Loss 0.057, Train_accy 74.44:  95%|█████████▌| 19/20 [07:32<00:22, 22.47s/it]
Task 9, Epoch 20/20 => Loss 0.056, Train_accy 74.40:  95%|█████████▌| 19/20 [07:53<00:22, 22.47s/it]
Task 9, Epoch 20/20 => Loss 0.056, Train_accy 74.40: 100%|██████████| 20/20 [07:53<00:00, 21.88s/it]
Task 9, Epoch 20/20 => Loss 0.056, Train_accy 74.40: 100%|██████████| 20/20 [07:53<00:00, 23.66s/it]
2024-09-12 14:31:08,714 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.056, Train_accy 74.40
2024-09-12 14:31:24,050 [trainer.py] => No NME accuracy.
2024-09-12 14:31:24,050 [trainer.py] => CNN: {'total': 63.92, '00-04': 45.8, '05-09': 38.6, '10-14': 38.4, '15-19': 46.6, '20-24': 62.6, '25-29': 75.4, '30-34': 77.4, '35-39': 84.6, '40-44': 91.6, '45-49': 78.2, 'old': 62.33, 'new': 78.2}
2024-09-12 14:31:24,051 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92]
2024-09-12 14:31:24,051 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04]

Average Accuracy (CNN): 81.0
2024-09-12 14:31:24,051 [trainer.py] => Average Accuracy (CNN): 81.0 

2024-09-12 14:31:24,052 [trainer.py] => All params: 85837106
2024-09-12 14:31:24,054 [trainer.py] => Trainable params: 85837106
2024-09-12 14:31:24,056 [finetune.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.289, Train_accy 33.12, Test_accy 62.62:   0%|          | 0/20 [00:37<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.289, Train_accy 33.12, Test_accy 62.62:   5%|▌         | 1/20 [00:37<11:50, 37.38s/it]
Task 10, Epoch 2/20 => Loss 0.142, Train_accy 52.04:   5%|▌         | 1/20 [00:58<11:50, 37.38s/it]                 
Task 10, Epoch 2/20 => Loss 0.142, Train_accy 52.04:  10%|█         | 2/20 [00:58<08:15, 27.55s/it]
Task 10, Epoch 3/20 => Loss 0.112, Train_accy 50.52:  10%|█         | 2/20 [01:18<08:15, 27.55s/it]
Task 10, Epoch 3/20 => Loss 0.112, Train_accy 50.52:  15%|█▌        | 3/20 [01:18<06:55, 24.44s/it]
Task 10, Epoch 4/20 => Loss 0.098, Train_accy 55.16:  15%|█▌        | 3/20 [01:39<06:55, 24.44s/it]
Task 10, Epoch 4/20 => Loss 0.098, Train_accy 55.16:  20%|██        | 4/20 [01:39<06:06, 22.89s/it]
Task 10, Epoch 5/20 => Loss 0.088, Train_accy 59.36:  20%|██        | 4/20 [01:59<06:06, 22.89s/it]
Task 10, Epoch 5/20 => Loss 0.088, Train_accy 59.36:  25%|██▌       | 5/20 [01:59<05:30, 22.05s/it]
Task 10, Epoch 6/20 => Loss 0.068, Train_accy 59.28, Test_accy 62.80:  25%|██▌       | 5/20 [02:36<05:30, 22.05s/it]
Task 10, Epoch 6/20 => Loss 0.068, Train_accy 59.28, Test_accy 62.80:  30%|███       | 6/20 [02:36<06:20, 27.18s/it]
Task 10, Epoch 7/20 => Loss 0.074, Train_accy 57.96:  30%|███       | 6/20 [02:57<06:20, 27.18s/it]                 
Task 10, Epoch 7/20 => Loss 0.074, Train_accy 57.96:  35%|███▌      | 7/20 [02:57<05:24, 24.95s/it]
Task 10, Epoch 8/20 => Loss 0.100, Train_accy 62.56:  35%|███▌      | 7/20 [03:17<05:24, 24.95s/it]
Task 10, Epoch 8/20 => Loss 0.100, Train_accy 62.56:  40%|████      | 8/20 [03:17<04:42, 23.56s/it]
Task 10, Epoch 9/20 => Loss 0.077, Train_accy 65.64:  40%|████      | 8/20 [03:38<04:42, 23.56s/it]
Task 10, Epoch 9/20 => Loss 0.077, Train_accy 65.64:  45%|████▌     | 9/20 [03:38<04:08, 22.58s/it]
Task 10, Epoch 10/20 => Loss 0.079, Train_accy 65.92:  45%|████▌     | 9/20 [03:58<04:08, 22.58s/it]
Task 10, Epoch 10/20 => Loss 0.079, Train_accy 65.92:  50%|█████     | 10/20 [03:58<03:39, 21.95s/it]
Task 10, Epoch 11/20 => Loss 0.078, Train_accy 66.12, Test_accy 63.35:  50%|█████     | 10/20 [04:36<03:39, 21.95s/it]
Task 10, Epoch 11/20 => Loss 0.078, Train_accy 66.12, Test_accy 63.35:  55%|█████▌    | 11/20 [04:36<04:01, 26.79s/it]
Task 10, Epoch 12/20 => Loss 0.111, Train_accy 64.60:  55%|█████▌    | 11/20 [04:57<04:01, 26.79s/it]                 
Task 10, Epoch 12/20 => Loss 0.111, Train_accy 64.60:  60%|██████    | 12/20 [04:57<03:19, 24.97s/it]
Task 10, Epoch 13/20 => Loss 0.084, Train_accy 66.64:  60%|██████    | 12/20 [05:18<03:19, 24.97s/it]
Task 10, Epoch 13/20 => Loss 0.084, Train_accy 66.64:  65%|██████▌   | 13/20 [05:18<02:45, 23.70s/it]
Task 10, Epoch 14/20 => Loss 0.074, Train_accy 69.60:  65%|██████▌   | 13/20 [05:38<02:45, 23.70s/it]
Task 10, Epoch 14/20 => Loss 0.074, Train_accy 69.60:  70%|███████   | 14/20 [05:38<02:16, 22.76s/it]
Task 10, Epoch 15/20 => Loss 0.073, Train_accy 71.92:  70%|███████   | 14/20 [05:59<02:16, 22.76s/it]
Task 10, Epoch 15/20 => Loss 0.073, Train_accy 71.92:  75%|███████▌  | 15/20 [05:59<01:50, 22.13s/it]
Task 10, Epoch 16/20 => Loss 0.076, Train_accy 69.20, Test_accy 64.44:  75%|███████▌  | 15/20 [06:36<01:50, 22.13s/it]
Task 10, Epoch 16/20 => Loss 0.076, Train_accy 69.20, Test_accy 64.44:  80%|████████  | 16/20 [06:36<01:46, 26.70s/it]
Task 10, Epoch 17/20 => Loss 0.089, Train_accy 72.68:  80%|████████  | 16/20 [06:57<01:46, 26.70s/it]                 
Task 10, Epoch 17/20 => Loss 0.089, Train_accy 72.68:  85%|████████▌ | 17/20 [06:57<01:14, 24.89s/it]
Task 10, Epoch 18/20 => Loss 0.095, Train_accy 71.96:  85%|████████▌ | 17/20 [07:18<01:14, 24.89s/it]
Task 10, Epoch 18/20 => Loss 0.095, Train_accy 71.96:  90%|█████████ | 18/20 [07:18<00:47, 23.64s/it]
Task 10, Epoch 19/20 => Loss 0.070, Train_accy 74.52:  90%|█████████ | 18/20 [07:38<00:47, 23.64s/it]
Task 10, Epoch 19/20 => Loss 0.070, Train_accy 74.52:  95%|█████████▌| 19/20 [07:38<00:22, 22.69s/it]
Task 10, Epoch 20/20 => Loss 0.067, Train_accy 75.76:  95%|█████████▌| 19/20 [07:59<00:22, 22.69s/it]
Task 10, Epoch 20/20 => Loss 0.067, Train_accy 75.76: 100%|██████████| 20/20 [07:59<00:00, 22.09s/it]
Task 10, Epoch 20/20 => Loss 0.067, Train_accy 75.76: 100%|██████████| 20/20 [07:59<00:00, 23.97s/it]
2024-09-12 14:39:23,483 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.067, Train_accy 75.76
2024-09-12 14:39:40,401 [trainer.py] => No NME accuracy.
2024-09-12 14:39:40,402 [trainer.py] => CNN: {'total': 65.25, '00-04': 40.8, '05-09': 38.8, '10-14': 51.6, '15-19': 47.4, '20-24': 59.4, '25-29': 76.0, '30-34': 74.6, '35-39': 88.4, '40-44': 86.6, '45-49': 73.6, '50-54': 80.6, 'old': 63.72, 'new': 80.6}
2024-09-12 14:39:40,402 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25]
2024-09-12 14:39:40,402 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71]

Average Accuracy (CNN): 79.57
2024-09-12 14:39:40,402 [trainer.py] => Average Accuracy (CNN): 79.57 

2024-09-12 14:39:40,403 [trainer.py] => All params: 85840951
2024-09-12 14:39:40,404 [trainer.py] => Trainable params: 85840951
2024-09-12 14:39:40,406 [finetune.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.575, Train_accy 39.92, Test_accy 68.10:   0%|          | 0/20 [00:39<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.575, Train_accy 39.92, Test_accy 68.10:   5%|▌         | 1/20 [00:39<12:26, 39.26s/it]
Task 11, Epoch 2/20 => Loss 0.298, Train_accy 70.88:   5%|▌         | 1/20 [00:59<12:26, 39.26s/it]                 
Task 11, Epoch 2/20 => Loss 0.298, Train_accy 70.88:  10%|█         | 2/20 [00:59<08:28, 28.26s/it]
Task 11, Epoch 3/20 => Loss 0.394, Train_accy 68.04:  10%|█         | 2/20 [01:20<08:28, 28.26s/it]
Task 11, Epoch 3/20 => Loss 0.394, Train_accy 68.04:  15%|█▌        | 3/20 [01:20<07:00, 24.71s/it]
Task 11, Epoch 4/20 => Loss 0.242, Train_accy 76.32:  15%|█▌        | 3/20 [01:40<07:00, 24.71s/it]
Task 11, Epoch 4/20 => Loss 0.242, Train_accy 76.32:  20%|██        | 4/20 [01:40<06:09, 23.09s/it]
Task 11, Epoch 5/20 => Loss 0.234, Train_accy 79.24:  20%|██        | 4/20 [02:01<06:09, 23.09s/it]
Task 11, Epoch 5/20 => Loss 0.234, Train_accy 79.24:  25%|██▌       | 5/20 [02:01<05:32, 22.20s/it]
Task 11, Epoch 6/20 => Loss 0.194, Train_accy 82.28, Test_accy 71.33:  25%|██▌       | 5/20 [02:40<05:32, 22.20s/it]
Task 11, Epoch 6/20 => Loss 0.194, Train_accy 82.28, Test_accy 71.33:  30%|███       | 6/20 [02:40<06:30, 27.88s/it]
Task 11, Epoch 7/20 => Loss 0.220, Train_accy 81.52:  30%|███       | 6/20 [03:01<06:30, 27.88s/it]                 
Task 11, Epoch 7/20 => Loss 0.220, Train_accy 81.52:  35%|███▌      | 7/20 [03:01<05:31, 25.52s/it]
Task 11, Epoch 8/20 => Loss 0.173, Train_accy 83.48:  35%|███▌      | 7/20 [03:21<05:31, 25.52s/it]
Task 11, Epoch 8/20 => Loss 0.173, Train_accy 83.48:  40%|████      | 8/20 [03:21<04:47, 23.92s/it]
Task 11, Epoch 9/20 => Loss 0.181, Train_accy 83.44:  40%|████      | 8/20 [03:42<04:47, 23.92s/it]
Task 11, Epoch 9/20 => Loss 0.181, Train_accy 83.44:  45%|████▌     | 9/20 [03:42<04:11, 22.90s/it]
Task 11, Epoch 10/20 => Loss 0.178, Train_accy 84.08:  45%|████▌     | 9/20 [04:02<04:11, 22.90s/it]
Task 11, Epoch 10/20 => Loss 0.178, Train_accy 84.08:  50%|█████     | 10/20 [04:02<03:41, 22.19s/it]
Task 11, Epoch 11/20 => Loss 0.190, Train_accy 84.96, Test_accy 73.28:  50%|█████     | 10/20 [04:41<03:41, 22.19s/it]
Task 11, Epoch 11/20 => Loss 0.190, Train_accy 84.96, Test_accy 73.28:  55%|█████▌    | 11/20 [04:41<04:06, 27.36s/it]
Task 11, Epoch 12/20 => Loss 0.205, Train_accy 82.28:  55%|█████▌    | 11/20 [05:02<04:06, 27.36s/it]                 
Task 11, Epoch 12/20 => Loss 0.205, Train_accy 82.28:  60%|██████    | 12/20 [05:02<03:22, 25.36s/it]
Task 11, Epoch 13/20 => Loss 0.162, Train_accy 85.24:  60%|██████    | 12/20 [05:23<03:22, 25.36s/it]
Task 11, Epoch 13/20 => Loss 0.162, Train_accy 85.24:  65%|██████▌   | 13/20 [05:23<02:47, 23.89s/it]
Task 11, Epoch 14/20 => Loss 0.157, Train_accy 86.40:  65%|██████▌   | 13/20 [05:44<02:47, 23.89s/it]
Task 11, Epoch 14/20 => Loss 0.157, Train_accy 86.40:  70%|███████   | 14/20 [05:44<02:17, 22.95s/it]
Task 11, Epoch 15/20 => Loss 0.174, Train_accy 85.76:  70%|███████   | 14/20 [06:04<02:17, 22.95s/it]
Task 11, Epoch 15/20 => Loss 0.174, Train_accy 85.76:  75%|███████▌  | 15/20 [06:04<01:50, 22.20s/it]
Task 11, Epoch 16/20 => Loss 0.170, Train_accy 85.28, Test_accy 70.40:  75%|███████▌  | 15/20 [06:43<01:50, 22.20s/it]
Task 11, Epoch 16/20 => Loss 0.170, Train_accy 85.28, Test_accy 70.40:  80%|████████  | 16/20 [06:43<01:49, 27.30s/it]
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 87.88:  80%|████████  | 16/20 [07:04<01:49, 27.30s/it]                 
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 87.88:  85%|████████▌ | 17/20 [07:04<01:15, 25.25s/it]
Task 11, Epoch 18/20 => Loss 0.165, Train_accy 87.28:  85%|████████▌ | 17/20 [07:24<01:15, 25.25s/it]
Task 11, Epoch 18/20 => Loss 0.165, Train_accy 87.28:  90%|█████████ | 18/20 [07:24<00:47, 23.83s/it]
Task 11, Epoch 19/20 => Loss 0.134, Train_accy 88.24:  90%|█████████ | 18/20 [07:45<00:47, 23.83s/it]
Task 11, Epoch 19/20 => Loss 0.134, Train_accy 88.24:  95%|█████████▌| 19/20 [07:45<00:22, 22.80s/it]
Task 11, Epoch 20/20 => Loss 0.130, Train_accy 88.96:  95%|█████████▌| 19/20 [08:05<00:22, 22.80s/it]
Task 11, Epoch 20/20 => Loss 0.130, Train_accy 88.96: 100%|██████████| 20/20 [08:05<00:00, 22.14s/it]
Task 11, Epoch 20/20 => Loss 0.130, Train_accy 88.96: 100%|██████████| 20/20 [08:05<00:00, 24.28s/it]
2024-09-12 14:47:46,051 [finetune.py] => Task 11, Epoch 20/20 => Loss 0.130, Train_accy 88.96
2024-09-12 14:48:04,698 [trainer.py] => No NME accuracy.
2024-09-12 14:48:04,698 [trainer.py] => CNN: {'total': 71.5, '00-04': 44.4, '05-09': 46.6, '10-14': 60.4, '15-19': 73.6, '20-24': 65.8, '25-29': 81.0, '30-34': 78.6, '35-39': 87.4, '40-44': 88.2, '45-49': 68.2, '50-54': 70.4, '55-59': 93.4, 'old': 69.51, 'new': 93.4}
2024-09-12 14:48:04,698 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5]
2024-09-12 14:48:04,698 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42]

Average Accuracy (CNN): 78.9
2024-09-12 14:48:04,698 [trainer.py] => Average Accuracy (CNN): 78.9 

2024-09-12 14:48:04,700 [trainer.py] => All params: 85844796
2024-09-12 14:48:04,701 [trainer.py] => Trainable params: 85844796
2024-09-12 14:48:04,702 [finetune.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.346, Train_accy 56.32, Test_accy 69.03:   0%|          | 0/20 [00:40<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.346, Train_accy 56.32, Test_accy 69.03:   5%|▌         | 1/20 [00:40<12:53, 40.70s/it]
Task 12, Epoch 2/20 => Loss 0.115, Train_accy 85.12:   5%|▌         | 1/20 [01:01<12:53, 40.70s/it]                 
Task 12, Epoch 2/20 => Loss 0.115, Train_accy 85.12:  10%|█         | 2/20 [01:01<08:40, 28.92s/it]
Task 12, Epoch 3/20 => Loss 0.109, Train_accy 87.88:  10%|█         | 2/20 [01:21<08:40, 28.92s/it]
Task 12, Epoch 3/20 => Loss 0.109, Train_accy 87.88:  15%|█▌        | 3/20 [01:21<07:06, 25.11s/it]
Task 12, Epoch 4/20 => Loss 0.109, Train_accy 89.04:  15%|█▌        | 3/20 [01:42<07:06, 25.11s/it]
Task 12, Epoch 4/20 => Loss 0.109, Train_accy 89.04:  20%|██        | 4/20 [01:42<06:13, 23.35s/it]
Task 12, Epoch 5/20 => Loss 0.101, Train_accy 87.96:  20%|██        | 4/20 [02:03<06:13, 23.35s/it]
Task 12, Epoch 5/20 => Loss 0.101, Train_accy 87.96:  25%|██▌       | 5/20 [02:03<05:35, 22.34s/it]
Task 12, Epoch 6/20 => Loss 0.115, Train_accy 88.92, Test_accy 70.75:  25%|██▌       | 5/20 [02:43<05:35, 22.34s/it]
Task 12, Epoch 6/20 => Loss 0.115, Train_accy 88.92, Test_accy 70.75:  30%|███       | 6/20 [02:43<06:40, 28.59s/it]
Task 12, Epoch 7/20 => Loss 0.113, Train_accy 86.12:  30%|███       | 6/20 [03:04<06:40, 28.59s/it]                 
Task 12, Epoch 7/20 => Loss 0.113, Train_accy 86.12:  35%|███▌      | 7/20 [03:04<05:37, 25.96s/it]
Task 12, Epoch 8/20 => Loss 0.092, Train_accy 87.40:  35%|███▌      | 7/20 [03:25<05:37, 25.96s/it]
Task 12, Epoch 8/20 => Loss 0.092, Train_accy 87.40:  40%|████      | 8/20 [03:25<04:51, 24.26s/it]
Task 12, Epoch 9/20 => Loss 0.074, Train_accy 89.20:  40%|████      | 8/20 [03:45<04:51, 24.26s/it]
Task 12, Epoch 9/20 => Loss 0.074, Train_accy 89.20:  45%|████▌     | 9/20 [03:45<04:14, 23.11s/it]
Task 12, Epoch 10/20 => Loss 0.097, Train_accy 88.68:  45%|████▌     | 9/20 [04:06<04:14, 23.11s/it]
Task 12, Epoch 10/20 => Loss 0.097, Train_accy 88.68:  50%|█████     | 10/20 [04:06<03:43, 22.32s/it]
Task 12, Epoch 11/20 => Loss 0.098, Train_accy 88.40, Test_accy 65.82:  50%|█████     | 10/20 [04:46<03:43, 22.32s/it]
Task 12, Epoch 11/20 => Loss 0.098, Train_accy 88.40, Test_accy 65.82:  55%|█████▌    | 11/20 [04:46<04:11, 27.94s/it]
Task 12, Epoch 12/20 => Loss 0.089, Train_accy 89.52:  55%|█████▌    | 11/20 [05:07<04:11, 27.94s/it]                 
Task 12, Epoch 12/20 => Loss 0.089, Train_accy 89.52:  60%|██████    | 12/20 [05:07<03:25, 25.73s/it]
Task 12, Epoch 13/20 => Loss 0.078, Train_accy 89.20:  60%|██████    | 12/20 [05:28<03:25, 25.73s/it]
Task 12, Epoch 13/20 => Loss 0.078, Train_accy 89.20:  65%|██████▌   | 13/20 [05:28<02:49, 24.20s/it]
Task 12, Epoch 14/20 => Loss 0.081, Train_accy 88.40:  65%|██████▌   | 13/20 [05:48<02:49, 24.20s/it]
Task 12, Epoch 14/20 => Loss 0.081, Train_accy 88.40:  70%|███████   | 14/20 [05:48<02:18, 23.06s/it]
Task 12, Epoch 15/20 => Loss 0.084, Train_accy 87.96:  70%|███████   | 14/20 [06:09<02:18, 23.06s/it]
Task 12, Epoch 15/20 => Loss 0.084, Train_accy 87.96:  75%|███████▌  | 15/20 [06:09<01:51, 22.32s/it]
Task 12, Epoch 16/20 => Loss 0.065, Train_accy 90.16, Test_accy 69.51:  75%|███████▌  | 15/20 [06:49<01:51, 22.32s/it]
Task 12, Epoch 16/20 => Loss 0.065, Train_accy 90.16, Test_accy 69.51:  80%|████████  | 16/20 [06:49<01:51, 27.86s/it]
Task 12, Epoch 17/20 => Loss 0.073, Train_accy 89.64:  80%|████████  | 16/20 [07:10<01:51, 27.86s/it]                 
Task 12, Epoch 17/20 => Loss 0.073, Train_accy 89.64:  85%|████████▌ | 17/20 [07:10<01:17, 25.70s/it]
Task 12, Epoch 18/20 => Loss 0.089, Train_accy 89.24:  85%|████████▌ | 17/20 [07:31<01:17, 25.70s/it]
Task 12, Epoch 18/20 => Loss 0.089, Train_accy 89.24:  90%|█████████ | 18/20 [07:31<00:48, 24.25s/it]
Task 12, Epoch 19/20 => Loss 0.079, Train_accy 90.80:  90%|█████████ | 18/20 [07:52<00:48, 24.25s/it]
Task 12, Epoch 19/20 => Loss 0.079, Train_accy 90.80:  95%|█████████▌| 19/20 [07:52<00:23, 23.17s/it]
Task 12, Epoch 20/20 => Loss 0.079, Train_accy 90.64:  95%|█████████▌| 19/20 [08:12<00:23, 23.17s/it]
Task 12, Epoch 20/20 => Loss 0.079, Train_accy 90.64: 100%|██████████| 20/20 [08:12<00:00, 22.36s/it]
Task 12, Epoch 20/20 => Loss 0.079, Train_accy 90.64: 100%|██████████| 20/20 [08:12<00:00, 24.63s/it]
2024-09-12 14:56:17,395 [finetune.py] => Task 12, Epoch 20/20 => Loss 0.079, Train_accy 90.64
2024-09-12 14:56:37,593 [trainer.py] => No NME accuracy.
2024-09-12 14:56:37,594 [trainer.py] => CNN: {'total': 67.92, '00-04': 48.6, '05-09': 41.4, '10-14': 59.8, '15-19': 48.4, '20-24': 64.0, '25-29': 80.2, '30-34': 74.4, '35-39': 76.6, '40-44': 82.2, '45-49': 66.4, '50-54': 64.4, '55-59': 81.4, '60-64': 95.2, 'old': 65.65, 'new': 95.2}
2024-09-12 14:56:37,594 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92]
2024-09-12 14:56:37,594 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45]

Average Accuracy (CNN): 78.05
2024-09-12 14:56:37,594 [trainer.py] => Average Accuracy (CNN): 78.05 

2024-09-12 14:56:37,596 [trainer.py] => All params: 85848641
2024-09-12 14:56:37,597 [trainer.py] => Trainable params: 85848641
2024-09-12 14:56:37,599 [finetune.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.275, Train_accy 65.28, Test_accy 64.87:   0%|          | 0/20 [00:42<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.275, Train_accy 65.28, Test_accy 64.87:   5%|▌         | 1/20 [00:42<13:20, 42.14s/it]
Task 13, Epoch 2/20 => Loss 0.090, Train_accy 89.92:   5%|▌         | 1/20 [01:02<13:20, 42.14s/it]                 
Task 13, Epoch 2/20 => Loss 0.090, Train_accy 89.92:  10%|█         | 2/20 [01:02<08:52, 29.56s/it]
Task 13, Epoch 3/20 => Loss 0.095, Train_accy 90.04:  10%|█         | 2/20 [01:23<08:52, 29.56s/it]
Task 13, Epoch 3/20 => Loss 0.095, Train_accy 90.04:  15%|█▌        | 3/20 [01:23<07:13, 25.47s/it]
Task 13, Epoch 4/20 => Loss 0.081, Train_accy 91.84:  15%|█▌        | 3/20 [01:44<07:13, 25.47s/it]
Task 13, Epoch 4/20 => Loss 0.081, Train_accy 91.84:  20%|██        | 4/20 [01:44<06:16, 23.55s/it]
Task 13, Epoch 5/20 => Loss 0.085, Train_accy 91.16:  20%|██        | 4/20 [02:04<06:16, 23.55s/it]
Task 13, Epoch 5/20 => Loss 0.085, Train_accy 91.16:  25%|██▌       | 5/20 [02:04<05:37, 22.47s/it]
Task 13, Epoch 6/20 => Loss 0.081, Train_accy 92.24, Test_accy 64.91:  25%|██▌       | 5/20 [02:46<05:37, 22.47s/it]
Task 13, Epoch 6/20 => Loss 0.081, Train_accy 92.24, Test_accy 64.91:  30%|███       | 6/20 [02:46<06:47, 29.14s/it]
Task 13, Epoch 7/20 => Loss 0.081, Train_accy 91.76:  30%|███       | 6/20 [03:07<06:47, 29.14s/it]                 
Task 13, Epoch 7/20 => Loss 0.081, Train_accy 91.76:  35%|███▌      | 7/20 [03:07<05:42, 26.32s/it]
Task 13, Epoch 8/20 => Loss 0.071, Train_accy 93.04:  35%|███▌      | 7/20 [03:27<05:42, 26.32s/it]
Task 13, Epoch 8/20 => Loss 0.071, Train_accy 93.04:  40%|████      | 8/20 [03:27<04:54, 24.52s/it]
Task 13, Epoch 9/20 => Loss 0.071, Train_accy 92.84:  40%|████      | 8/20 [03:48<04:54, 24.52s/it]
Task 13, Epoch 9/20 => Loss 0.071, Train_accy 92.84:  45%|████▌     | 9/20 [03:48<04:16, 23.31s/it]
Task 13, Epoch 10/20 => Loss 0.059, Train_accy 94.28:  45%|████▌     | 9/20 [04:09<04:16, 23.31s/it]
Task 13, Epoch 10/20 => Loss 0.059, Train_accy 94.28:  50%|█████     | 10/20 [04:09<03:44, 22.46s/it]
Task 13, Epoch 11/20 => Loss 0.065, Train_accy 94.08, Test_accy 61.30:  50%|█████     | 10/20 [04:51<03:44, 22.46s/it]
Task 13, Epoch 11/20 => Loss 0.065, Train_accy 94.08, Test_accy 61.30:  55%|█████▌    | 11/20 [04:51<04:16, 28.49s/it]
Task 13, Epoch 12/20 => Loss 0.122, Train_accy 91.84:  55%|█████▌    | 11/20 [05:11<04:16, 28.49s/it]                 
Task 13, Epoch 12/20 => Loss 0.122, Train_accy 91.84:  60%|██████    | 12/20 [05:11<03:28, 26.09s/it]
Task 13, Epoch 13/20 => Loss 0.079, Train_accy 93.92:  60%|██████    | 12/20 [05:32<03:28, 26.09s/it]
Task 13, Epoch 13/20 => Loss 0.079, Train_accy 93.92:  65%|██████▌   | 13/20 [05:32<02:51, 24.44s/it]
Task 13, Epoch 14/20 => Loss 0.065, Train_accy 93.92:  65%|██████▌   | 13/20 [05:53<02:51, 24.44s/it]
Task 13, Epoch 14/20 => Loss 0.065, Train_accy 93.92:  70%|███████   | 14/20 [05:53<02:19, 23.29s/it]
Task 13, Epoch 15/20 => Loss 0.075, Train_accy 93.16:  70%|███████   | 14/20 [06:13<02:19, 23.29s/it]
Task 13, Epoch 15/20 => Loss 0.075, Train_accy 93.16:  75%|███████▌  | 15/20 [06:13<01:52, 22.46s/it]
Task 13, Epoch 16/20 => Loss 0.050, Train_accy 94.72, Test_accy 66.24:  75%|███████▌  | 15/20 [06:55<01:52, 22.46s/it]
Task 13, Epoch 16/20 => Loss 0.050, Train_accy 94.72, Test_accy 66.24:  80%|████████  | 16/20 [06:55<01:53, 28.40s/it]
Task 13, Epoch 17/20 => Loss 0.069, Train_accy 93.96:  80%|████████  | 16/20 [07:16<01:53, 28.40s/it]                 
Task 13, Epoch 17/20 => Loss 0.069, Train_accy 93.96:  85%|████████▌ | 17/20 [07:16<01:18, 26.12s/it]
Task 13, Epoch 18/20 => Loss 0.066, Train_accy 94.52:  85%|████████▌ | 17/20 [07:37<01:18, 26.12s/it]
Task 13, Epoch 18/20 => Loss 0.066, Train_accy 94.52:  90%|█████████ | 18/20 [07:37<00:48, 24.45s/it]
Task 13, Epoch 19/20 => Loss 0.068, Train_accy 93.84:  90%|█████████ | 18/20 [07:57<00:48, 24.45s/it]
Task 13, Epoch 19/20 => Loss 0.068, Train_accy 93.84:  95%|█████████▌| 19/20 [07:57<00:23, 23.30s/it]
Task 13, Epoch 20/20 => Loss 0.039, Train_accy 95.56:  95%|█████████▌| 19/20 [08:18<00:23, 23.30s/it]
Task 13, Epoch 20/20 => Loss 0.039, Train_accy 95.56: 100%|██████████| 20/20 [08:18<00:00, 22.45s/it]
Task 13, Epoch 20/20 => Loss 0.039, Train_accy 95.56: 100%|██████████| 20/20 [08:18<00:00, 24.92s/it]
2024-09-12 15:04:56,016 [finetune.py] => Task 13, Epoch 20/20 => Loss 0.039, Train_accy 95.56
2024-09-12 15:05:17,762 [trainer.py] => No NME accuracy.
2024-09-12 15:05:17,763 [trainer.py] => CNN: {'total': 64.43, '00-04': 26.6, '05-09': 36.2, '10-14': 51.0, '15-19': 56.4, '20-24': 69.4, '25-29': 77.0, '30-34': 68.2, '35-39': 68.4, '40-44': 75.2, '45-49': 61.0, '50-54': 59.4, '55-59': 71.2, '60-64': 82.8, '65-69': 99.2, 'old': 61.75, 'new': 99.2}
2024-09-12 15:05:17,763 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92, 64.43]
2024-09-12 15:05:17,763 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45, 93.76]

Average Accuracy (CNN): 77.08
2024-09-12 15:05:17,763 [trainer.py] => Average Accuracy (CNN): 77.08 

2024-09-12 15:05:17,765 [trainer.py] => All params: 85852486
2024-09-12 15:05:17,766 [trainer.py] => Trainable params: 85852486
2024-09-12 15:05:17,768 [finetune.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.292, Train_accy 28.52, Test_accy 60.87:   0%|          | 0/20 [00:43<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.292, Train_accy 28.52, Test_accy 60.87:   5%|▌         | 1/20 [00:43<13:50, 43.72s/it]
Task 14, Epoch 2/20 => Loss 0.109, Train_accy 52.40:   5%|▌         | 1/20 [01:04<13:50, 43.72s/it]                 
Task 14, Epoch 2/20 => Loss 0.109, Train_accy 52.40:  10%|█         | 2/20 [01:04<09:06, 30.35s/it]
Task 14, Epoch 3/20 => Loss 0.105, Train_accy 56.08:  10%|█         | 2/20 [01:25<09:06, 30.35s/it]
Task 14, Epoch 3/20 => Loss 0.105, Train_accy 56.08:  15%|█▌        | 3/20 [01:25<07:21, 25.99s/it]
Task 14, Epoch 4/20 => Loss 0.099, Train_accy 57.44:  15%|█▌        | 3/20 [01:46<07:21, 25.99s/it]
Task 14, Epoch 4/20 => Loss 0.099, Train_accy 57.44:  20%|██        | 4/20 [01:46<06:21, 23.86s/it]
Task 14, Epoch 5/20 => Loss 0.116, Train_accy 58.56:  20%|██        | 4/20 [02:06<06:21, 23.86s/it]
Task 14, Epoch 5/20 => Loss 0.116, Train_accy 58.56:  25%|██▌       | 5/20 [02:06<05:41, 22.74s/it]
Task 14, Epoch 6/20 => Loss 0.106, Train_accy 63.00, Test_accy 62.44:  25%|██▌       | 5/20 [02:50<05:41, 22.74s/it]
Task 14, Epoch 6/20 => Loss 0.106, Train_accy 63.00, Test_accy 62.44:  30%|███       | 6/20 [02:50<06:58, 29.92s/it]
Task 14, Epoch 7/20 => Loss 0.112, Train_accy 61.60:  30%|███       | 6/20 [03:11<06:58, 29.92s/it]                 
Task 14, Epoch 7/20 => Loss 0.112, Train_accy 61.60:  35%|███▌      | 7/20 [03:11<05:50, 26.98s/it]
Task 14, Epoch 8/20 => Loss 0.091, Train_accy 62.60:  35%|███▌      | 7/20 [03:32<05:50, 26.98s/it]
Task 14, Epoch 8/20 => Loss 0.091, Train_accy 62.60:  40%|████      | 8/20 [03:32<05:00, 25.00s/it]
Task 14, Epoch 9/20 => Loss 0.079, Train_accy 64.88:  40%|████      | 8/20 [03:53<05:00, 25.00s/it]
Task 14, Epoch 9/20 => Loss 0.079, Train_accy 64.88:  45%|████▌     | 9/20 [03:53<04:20, 23.70s/it]
Task 14, Epoch 10/20 => Loss 0.068, Train_accy 69.08:  45%|████▌     | 9/20 [04:13<04:20, 23.70s/it]
Task 14, Epoch 10/20 => Loss 0.068, Train_accy 69.08:  50%|█████     | 10/20 [04:13<03:47, 22.77s/it]
Task 14, Epoch 11/20 => Loss 0.093, Train_accy 66.64, Test_accy 61.93:  50%|█████     | 10/20 [04:57<03:47, 22.77s/it]
Task 14, Epoch 11/20 => Loss 0.093, Train_accy 66.64, Test_accy 61.93:  55%|█████▌    | 11/20 [04:57<04:22, 29.15s/it]
Task 14, Epoch 12/20 => Loss 0.077, Train_accy 64.88:  55%|█████▌    | 11/20 [05:18<04:22, 29.15s/it]                 
Task 14, Epoch 12/20 => Loss 0.077, Train_accy 64.88:  60%|██████    | 12/20 [05:18<03:32, 26.62s/it]
Task 14, Epoch 13/20 => Loss 0.071, Train_accy 66.64:  60%|██████    | 12/20 [05:38<03:32, 26.62s/it]
Task 14, Epoch 13/20 => Loss 0.071, Train_accy 66.64:  65%|██████▌   | 13/20 [05:38<02:53, 24.78s/it]
Task 14, Epoch 14/20 => Loss 0.080, Train_accy 64.88:  65%|██████▌   | 13/20 [05:59<02:53, 24.78s/it]
Task 14, Epoch 14/20 => Loss 0.080, Train_accy 64.88:  70%|███████   | 14/20 [05:59<02:21, 23.54s/it]
Task 14, Epoch 15/20 => Loss 0.087, Train_accy 63.08:  70%|███████   | 14/20 [06:20<02:21, 23.54s/it]
Task 14, Epoch 15/20 => Loss 0.087, Train_accy 63.08:  75%|███████▌  | 15/20 [06:20<01:53, 22.64s/it]
Task 14, Epoch 16/20 => Loss 0.080, Train_accy 65.32, Test_accy 61.89:  75%|███████▌  | 15/20 [07:04<01:53, 22.64s/it]
Task 14, Epoch 16/20 => Loss 0.080, Train_accy 65.32, Test_accy 61.89:  80%|████████  | 16/20 [07:04<01:56, 29.06s/it]
Task 14, Epoch 17/20 => Loss 0.072, Train_accy 71.40:  80%|████████  | 16/20 [07:24<01:56, 29.06s/it]                 
Task 14, Epoch 17/20 => Loss 0.072, Train_accy 71.40:  85%|████████▌ | 17/20 [07:24<01:19, 26.58s/it]
Task 14, Epoch 18/20 => Loss 0.068, Train_accy 74.52:  85%|████████▌ | 17/20 [07:45<01:19, 26.58s/it]
Task 14, Epoch 18/20 => Loss 0.068, Train_accy 74.52:  90%|█████████ | 18/20 [07:45<00:49, 24.81s/it]
Task 14, Epoch 19/20 => Loss 0.061, Train_accy 74.12:  90%|█████████ | 18/20 [08:06<00:49, 24.81s/it]
Task 14, Epoch 19/20 => Loss 0.061, Train_accy 74.12:  95%|█████████▌| 19/20 [08:06<00:23, 23.59s/it]
Task 14, Epoch 20/20 => Loss 0.068, Train_accy 77.92:  95%|█████████▌| 19/20 [08:26<00:23, 23.59s/it]
Task 14, Epoch 20/20 => Loss 0.068, Train_accy 77.92: 100%|██████████| 20/20 [08:26<00:00, 22.69s/it]
Task 14, Epoch 20/20 => Loss 0.068, Train_accy 77.92: 100%|██████████| 20/20 [08:26<00:00, 25.35s/it]
2024-09-12 15:13:44,799 [finetune.py] => Task 14, Epoch 20/20 => Loss 0.068, Train_accy 77.92
2024-09-12 15:14:08,121 [trainer.py] => No NME accuracy.
2024-09-12 15:14:08,122 [trainer.py] => CNN: {'total': 60.75, '00-04': 28.4, '05-09': 40.0, '10-14': 45.4, '15-19': 49.4, '20-24': 57.6, '25-29': 72.0, '30-34': 62.8, '35-39': 65.6, '40-44': 68.2, '45-49': 59.4, '50-54': 52.0, '55-59': 57.0, '60-64': 71.8, '65-69': 98.0, '70-74': 83.6, 'old': 59.11, 'new': 83.6}
2024-09-12 15:14:08,122 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92, 64.43, 60.75]
2024-09-12 15:14:08,122 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45, 93.76, 92.63]

Average Accuracy (CNN): 75.99
2024-09-12 15:14:08,123 [trainer.py] => Average Accuracy (CNN): 75.99 

2024-09-12 15:14:08,124 [trainer.py] => All params: 85856331
2024-09-12 15:14:08,126 [trainer.py] => Trainable params: 85856331
2024-09-12 15:14:08,128 [finetune.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.322, Train_accy 36.64, Test_accy 57.82:   0%|          | 0/20 [00:45<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.322, Train_accy 36.64, Test_accy 57.82:   5%|▌         | 1/20 [00:45<14:22, 45.39s/it]
Task 15, Epoch 2/20 => Loss 0.120, Train_accy 57.32:   5%|▌         | 1/20 [01:06<14:22, 45.39s/it]                 
Task 15, Epoch 2/20 => Loss 0.120, Train_accy 57.32:  10%|█         | 2/20 [01:06<09:19, 31.06s/it]
Task 15, Epoch 3/20 => Loss 0.104, Train_accy 61.04:  10%|█         | 2/20 [01:27<09:19, 31.06s/it]
Task 15, Epoch 3/20 => Loss 0.104, Train_accy 61.04:  15%|█▌        | 3/20 [01:27<07:28, 26.39s/it]
Task 15, Epoch 4/20 => Loss 0.107, Train_accy 58.76:  15%|█▌        | 3/20 [01:47<07:28, 26.39s/it]
Task 15, Epoch 4/20 => Loss 0.107, Train_accy 58.76:  20%|██        | 4/20 [01:47<06:26, 24.16s/it]
Task 15, Epoch 5/20 => Loss 0.094, Train_accy 62.04:  20%|██        | 4/20 [02:08<06:26, 24.16s/it]
Task 15, Epoch 5/20 => Loss 0.094, Train_accy 62.04:  25%|██▌       | 5/20 [02:08<05:43, 22.90s/it]
Task 15, Epoch 6/20 => Loss 0.101, Train_accy 66.00, Test_accy 61.85:  25%|██▌       | 5/20 [02:53<05:43, 22.90s/it]
Task 15, Epoch 6/20 => Loss 0.101, Train_accy 66.00, Test_accy 61.85:  30%|███       | 6/20 [02:53<07:06, 30.50s/it]
Task 15, Epoch 7/20 => Loss 0.080, Train_accy 66.16:  30%|███       | 6/20 [03:14<07:06, 30.50s/it]                 
Task 15, Epoch 7/20 => Loss 0.080, Train_accy 66.16:  35%|███▌      | 7/20 [03:14<05:55, 27.37s/it]
Task 15, Epoch 8/20 => Loss 0.089, Train_accy 66.64:  35%|███▌      | 7/20 [03:35<05:55, 27.37s/it]
Task 15, Epoch 8/20 => Loss 0.089, Train_accy 66.64:  40%|████      | 8/20 [03:35<05:02, 25.20s/it]
Task 15, Epoch 9/20 => Loss 0.096, Train_accy 68.72:  40%|████      | 8/20 [03:56<05:02, 25.20s/it]
Task 15, Epoch 9/20 => Loss 0.096, Train_accy 68.72:  45%|████▌     | 9/20 [03:56<04:21, 23.78s/it]
Task 15, Epoch 10/20 => Loss 0.092, Train_accy 67.00:  45%|████▌     | 9/20 [04:16<04:21, 23.78s/it]
Task 15, Epoch 10/20 => Loss 0.092, Train_accy 67.00:  50%|█████     | 10/20 [04:16<03:48, 22.80s/it]
Task 15, Epoch 11/20 => Loss 0.100, Train_accy 67.52, Test_accy 60.72:  50%|█████     | 10/20 [05:01<03:48, 22.80s/it]
Task 15, Epoch 11/20 => Loss 0.100, Train_accy 67.52, Test_accy 60.72:  55%|█████▌    | 11/20 [05:01<04:26, 29.65s/it]
Task 15, Epoch 12/20 => Loss 0.075, Train_accy 67.24:  55%|█████▌    | 11/20 [05:22<04:26, 29.65s/it]                 
Task 15, Epoch 12/20 => Loss 0.075, Train_accy 67.24:  60%|██████    | 12/20 [05:22<03:35, 26.95s/it]
Task 15, Epoch 13/20 => Loss 0.077, Train_accy 70.96:  60%|██████    | 12/20 [05:43<03:35, 26.95s/it]
Task 15, Epoch 13/20 => Loss 0.077, Train_accy 70.96:  65%|██████▌   | 13/20 [05:43<02:55, 25.08s/it]
Task 15, Epoch 14/20 => Loss 0.063, Train_accy 74.20:  65%|██████▌   | 13/20 [06:04<02:55, 25.08s/it]
Task 15, Epoch 14/20 => Loss 0.063, Train_accy 74.20:  70%|███████   | 14/20 [06:04<02:22, 23.78s/it]
Task 15, Epoch 15/20 => Loss 0.075, Train_accy 75.24:  70%|███████   | 14/20 [06:24<02:22, 23.78s/it]
Task 15, Epoch 15/20 => Loss 0.075, Train_accy 75.24:  75%|███████▌  | 15/20 [06:24<01:54, 22.84s/it]
Task 15, Epoch 16/20 => Loss 0.083, Train_accy 74.40, Test_accy 63.12:  75%|███████▌  | 15/20 [07:10<01:54, 22.84s/it]
Task 15, Epoch 16/20 => Loss 0.083, Train_accy 74.40, Test_accy 63.12:  80%|████████  | 16/20 [07:10<01:58, 29.59s/it]
Task 15, Epoch 17/20 => Loss 0.085, Train_accy 70.48:  80%|████████  | 16/20 [07:31<01:58, 29.59s/it]                 
Task 15, Epoch 17/20 => Loss 0.085, Train_accy 70.48:  85%|████████▌ | 17/20 [07:31<01:21, 27.02s/it]
Task 15, Epoch 18/20 => Loss 0.078, Train_accy 71.56:  85%|████████▌ | 17/20 [07:51<01:21, 27.02s/it]
Task 15, Epoch 18/20 => Loss 0.078, Train_accy 71.56:  90%|█████████ | 18/20 [07:51<00:50, 25.16s/it]
Task 15, Epoch 19/20 => Loss 0.079, Train_accy 73.16:  90%|█████████ | 18/20 [08:12<00:50, 25.16s/it]
Task 15, Epoch 19/20 => Loss 0.079, Train_accy 73.16:  95%|█████████▌| 19/20 [08:12<00:23, 23.84s/it]
Task 15, Epoch 20/20 => Loss 0.074, Train_accy 75.52:  95%|█████████▌| 19/20 [08:33<00:23, 23.84s/it]
Task 15, Epoch 20/20 => Loss 0.074, Train_accy 75.52: 100%|██████████| 20/20 [08:33<00:00, 22.90s/it]
Task 15, Epoch 20/20 => Loss 0.074, Train_accy 75.52: 100%|██████████| 20/20 [08:33<00:00, 25.67s/it]
2024-09-12 15:22:41,638 [finetune.py] => Task 15, Epoch 20/20 => Loss 0.074, Train_accy 75.52
2024-09-12 15:23:06,139 [trainer.py] => No NME accuracy.
2024-09-12 15:23:06,140 [trainer.py] => CNN: {'total': 61.46, '00-04': 28.2, '05-09': 41.8, '10-14': 44.0, '15-19': 51.0, '20-24': 66.6, '25-29': 76.8, '30-34': 61.4, '35-39': 57.8, '40-44': 66.8, '45-49': 59.2, '50-54': 47.6, '55-59': 53.4, '60-64': 68.0, '65-69': 97.0, '70-74': 77.2, '75-79': 86.6, 'old': 59.79, 'new': 86.6}
2024-09-12 15:23:06,140 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92, 64.43, 60.75, 61.46]
2024-09-12 15:23:06,140 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45, 93.76, 92.63, 92.16]

Average Accuracy (CNN): 75.08
2024-09-12 15:23:06,140 [trainer.py] => Average Accuracy (CNN): 75.08 

2024-09-12 15:23:06,142 [trainer.py] => All params: 85860176
2024-09-12 15:23:06,143 [trainer.py] => Trainable params: 85860176
2024-09-12 15:23:06,145 [finetune.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.312, Train_accy 39.36, Test_accy 59.69:   0%|          | 0/20 [00:46<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.312, Train_accy 39.36, Test_accy 59.69:   5%|▌         | 1/20 [00:46<14:42, 46.42s/it]
Task 16, Epoch 2/20 => Loss 0.104, Train_accy 63.44:   5%|▌         | 1/20 [01:06<14:42, 46.42s/it]                 
Task 16, Epoch 2/20 => Loss 0.104, Train_accy 63.44:  10%|█         | 2/20 [01:06<09:21, 31.17s/it]
Task 16, Epoch 3/20 => Loss 0.089, Train_accy 67.04:  10%|█         | 2/20 [01:27<09:21, 31.17s/it]
Task 16, Epoch 3/20 => Loss 0.089, Train_accy 67.04:  15%|█▌        | 3/20 [01:27<07:30, 26.52s/it]
Task 16, Epoch 4/20 => Loss 0.117, Train_accy 64.28:  15%|█▌        | 3/20 [01:48<07:30, 26.52s/it]
Task 16, Epoch 4/20 => Loss 0.117, Train_accy 64.28:  20%|██        | 4/20 [01:48<06:28, 24.31s/it]
Task 16, Epoch 5/20 => Loss 0.111, Train_accy 65.60:  20%|██        | 4/20 [02:09<06:28, 24.31s/it]
Task 16, Epoch 5/20 => Loss 0.111, Train_accy 65.60:  25%|██▌       | 5/20 [02:09<05:44, 22.98s/it]
Task 16, Epoch 6/20 => Loss 0.127, Train_accy 66.96, Test_accy 59.45:  25%|██▌       | 5/20 [02:56<05:44, 22.98s/it]
Task 16, Epoch 6/20 => Loss 0.127, Train_accy 66.96, Test_accy 59.45:  30%|███       | 6/20 [02:56<07:13, 31.00s/it]
Task 16, Epoch 7/20 => Loss 0.084, Train_accy 70.52:  30%|███       | 6/20 [03:16<07:13, 31.00s/it]                 
Task 16, Epoch 7/20 => Loss 0.084, Train_accy 70.52:  35%|███▌      | 7/20 [03:16<06:00, 27.69s/it]
Task 16, Epoch 8/20 => Loss 0.099, Train_accy 71.80:  35%|███▌      | 7/20 [03:37<06:00, 27.69s/it]
Task 16, Epoch 8/20 => Loss 0.099, Train_accy 71.80:  40%|████      | 8/20 [03:37<05:05, 25.46s/it]
Task 16, Epoch 9/20 => Loss 0.076, Train_accy 72.20:  40%|████      | 8/20 [03:58<05:05, 25.46s/it]
Task 16, Epoch 9/20 => Loss 0.076, Train_accy 72.20:  45%|████▌     | 9/20 [03:58<04:23, 23.97s/it]
Task 16, Epoch 10/20 => Loss 0.073, Train_accy 78.76:  45%|████▌     | 9/20 [04:18<04:23, 23.97s/it]
Task 16, Epoch 10/20 => Loss 0.073, Train_accy 78.76:  50%|█████     | 10/20 [04:18<03:49, 22.97s/it]
Task 16, Epoch 11/20 => Loss 0.058, Train_accy 78.12, Test_accy 59.01:  50%|█████     | 10/20 [05:05<03:49, 22.97s/it]
Task 16, Epoch 11/20 => Loss 0.058, Train_accy 78.12, Test_accy 59.01:  55%|█████▌    | 11/20 [05:05<04:32, 30.26s/it]
Task 16, Epoch 12/20 => Loss 0.065, Train_accy 76.12:  55%|█████▌    | 11/20 [05:26<04:32, 30.26s/it]                 
Task 16, Epoch 12/20 => Loss 0.065, Train_accy 76.12:  60%|██████    | 12/20 [05:26<03:39, 27.44s/it]
Task 16, Epoch 13/20 => Loss 0.053, Train_accy 78.84:  60%|██████    | 12/20 [05:47<03:39, 27.44s/it]
Task 16, Epoch 13/20 => Loss 0.053, Train_accy 78.84:  65%|██████▌   | 13/20 [05:47<02:57, 25.40s/it]
Task 16, Epoch 14/20 => Loss 0.065, Train_accy 78.36:  65%|██████▌   | 13/20 [06:08<02:57, 25.40s/it]
Task 16, Epoch 14/20 => Loss 0.065, Train_accy 78.36:  70%|███████   | 14/20 [06:08<02:23, 23.99s/it]
Task 16, Epoch 15/20 => Loss 0.061, Train_accy 80.24:  70%|███████   | 14/20 [06:28<02:23, 23.99s/it]
Task 16, Epoch 15/20 => Loss 0.061, Train_accy 80.24:  75%|███████▌  | 15/20 [06:28<01:55, 23.01s/it]
Task 16, Epoch 16/20 => Loss 0.053, Train_accy 82.08, Test_accy 59.47:  75%|███████▌  | 15/20 [07:15<01:55, 23.01s/it]
Task 16, Epoch 16/20 => Loss 0.053, Train_accy 82.08, Test_accy 59.47:  80%|████████  | 16/20 [07:15<02:00, 30.01s/it]
Task 16, Epoch 17/20 => Loss 0.058, Train_accy 79.92:  80%|████████  | 16/20 [07:36<02:00, 30.01s/it]                 
Task 16, Epoch 17/20 => Loss 0.058, Train_accy 79.92:  85%|████████▌ | 17/20 [07:36<01:21, 27.24s/it]
Task 16, Epoch 18/20 => Loss 0.063, Train_accy 82.40:  85%|████████▌ | 17/20 [07:56<01:21, 27.24s/it]
Task 16, Epoch 18/20 => Loss 0.063, Train_accy 82.40:  90%|█████████ | 18/20 [07:56<00:50, 25.33s/it]
Task 16, Epoch 19/20 => Loss 0.062, Train_accy 83.64:  90%|█████████ | 18/20 [08:17<00:50, 25.33s/it]
Task 16, Epoch 19/20 => Loss 0.062, Train_accy 83.64:  95%|█████████▌| 19/20 [08:17<00:23, 23.92s/it]
Task 16, Epoch 20/20 => Loss 0.060, Train_accy 79.84:  95%|█████████▌| 19/20 [08:38<00:23, 23.92s/it]
Task 16, Epoch 20/20 => Loss 0.060, Train_accy 79.84: 100%|██████████| 20/20 [08:38<00:00, 22.92s/it]
Task 16, Epoch 20/20 => Loss 0.060, Train_accy 79.84: 100%|██████████| 20/20 [08:38<00:00, 25.91s/it]
2024-09-12 15:31:44,309 [finetune.py] => Task 16, Epoch 20/20 => Loss 0.060, Train_accy 79.84
2024-09-12 15:32:10,344 [trainer.py] => No NME accuracy.
2024-09-12 15:32:10,344 [trainer.py] => CNN: {'total': 59.86, '00-04': 34.2, '05-09': 33.8, '10-14': 45.0, '15-19': 52.4, '20-24': 57.6, '25-29': 74.8, '30-34': 55.8, '35-39': 66.8, '40-44': 66.0, '45-49': 48.6, '50-54': 42.2, '55-59': 51.2, '60-64': 60.2, '65-69': 93.2, '70-74': 70.2, '75-79': 79.8, '80-84': 85.8, 'old': 58.24, 'new': 85.8}
2024-09-12 15:32:10,344 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92, 64.43, 60.75, 61.46, 59.86]
2024-09-12 15:32:10,345 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45, 93.76, 92.63, 92.16, 91.47]

Average Accuracy (CNN): 74.19
2024-09-12 15:32:10,345 [trainer.py] => Average Accuracy (CNN): 74.19 

2024-09-12 15:32:10,347 [trainer.py] => All params: 85864021
2024-09-12 15:32:10,348 [trainer.py] => Trainable params: 85864021
2024-09-12 15:32:10,351 [finetune.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.530, Train_accy 31.08, Test_accy 62.54:   0%|          | 0/20 [00:48<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.530, Train_accy 31.08, Test_accy 62.54:   5%|▌         | 1/20 [00:48<15:13, 48.09s/it]
Task 17, Epoch 2/20 => Loss 0.262, Train_accy 62.84:   5%|▌         | 1/20 [01:08<15:13, 48.09s/it]                 
Task 17, Epoch 2/20 => Loss 0.262, Train_accy 62.84:  10%|█         | 2/20 [01:08<09:34, 31.91s/it]
Task 17, Epoch 3/20 => Loss 0.208, Train_accy 69.16:  10%|█         | 2/20 [01:29<09:34, 31.91s/it]
Task 17, Epoch 3/20 => Loss 0.208, Train_accy 69.16:  15%|█▌        | 3/20 [01:29<07:35, 26.78s/it]
Task 17, Epoch 4/20 => Loss 0.175, Train_accy 74.52:  15%|█▌        | 3/20 [01:49<07:35, 26.78s/it]
Task 17, Epoch 4/20 => Loss 0.175, Train_accy 74.52:  20%|██        | 4/20 [01:49<06:28, 24.27s/it]
Task 17, Epoch 5/20 => Loss 0.171, Train_accy 74.28:  20%|██        | 4/20 [02:10<06:28, 24.27s/it]
Task 17, Epoch 5/20 => Loss 0.171, Train_accy 74.28:  25%|██▌       | 5/20 [02:10<05:44, 22.99s/it]
Task 17, Epoch 6/20 => Loss 0.166, Train_accy 76.00, Test_accy 63.52:  25%|██▌       | 5/20 [02:58<05:44, 22.99s/it]
Task 17, Epoch 6/20 => Loss 0.166, Train_accy 76.00, Test_accy 63.52:  30%|███       | 6/20 [02:58<07:21, 31.54s/it]
Task 17, Epoch 7/20 => Loss 0.168, Train_accy 75.16:  30%|███       | 6/20 [03:19<07:21, 31.54s/it]                 
Task 17, Epoch 7/20 => Loss 0.168, Train_accy 75.16:  35%|███▌      | 7/20 [03:19<06:04, 28.07s/it]
Task 17, Epoch 8/20 => Loss 0.187, Train_accy 74.80:  35%|███▌      | 7/20 [03:40<06:04, 28.07s/it]
Task 17, Epoch 8/20 => Loss 0.187, Train_accy 74.80:  40%|████      | 8/20 [03:40<05:08, 25.75s/it]
Task 17, Epoch 9/20 => Loss 0.185, Train_accy 76.80:  40%|████      | 8/20 [04:00<05:08, 25.75s/it]
Task 17, Epoch 9/20 => Loss 0.185, Train_accy 76.80:  45%|████▌     | 9/20 [04:00<04:25, 24.14s/it]
Task 17, Epoch 10/20 => Loss 0.183, Train_accy 78.88:  45%|████▌     | 9/20 [04:21<04:25, 24.14s/it]
Task 17, Epoch 10/20 => Loss 0.183, Train_accy 78.88:  50%|█████     | 10/20 [04:21<03:51, 23.10s/it]
Task 17, Epoch 11/20 => Loss 0.213, Train_accy 73.20, Test_accy 62.26:  50%|█████     | 10/20 [05:09<03:51, 23.10s/it]
Task 17, Epoch 11/20 => Loss 0.213, Train_accy 73.20, Test_accy 62.26:  55%|█████▌    | 11/20 [05:09<04:36, 30.76s/it]
Task 17, Epoch 12/20 => Loss 0.173, Train_accy 78.12:  55%|█████▌    | 11/20 [05:31<04:36, 30.76s/it]                 
Task 17, Epoch 12/20 => Loss 0.173, Train_accy 78.12:  60%|██████    | 12/20 [05:31<03:42, 27.85s/it]
Task 17, Epoch 13/20 => Loss 0.147, Train_accy 81.40:  60%|██████    | 12/20 [05:51<03:42, 27.85s/it]
Task 17, Epoch 13/20 => Loss 0.147, Train_accy 81.40:  65%|██████▌   | 13/20 [05:51<03:00, 25.75s/it]
Task 17, Epoch 14/20 => Loss 0.144, Train_accy 80.88:  65%|██████▌   | 13/20 [06:12<03:00, 25.75s/it]
Task 17, Epoch 14/20 => Loss 0.144, Train_accy 80.88:  70%|███████   | 14/20 [06:12<02:25, 24.25s/it]
Task 17, Epoch 15/20 => Loss 0.131, Train_accy 84.52:  70%|███████   | 14/20 [06:33<02:25, 24.25s/it]
Task 17, Epoch 15/20 => Loss 0.131, Train_accy 84.52:  75%|███████▌  | 15/20 [06:33<01:55, 23.18s/it]
Task 17, Epoch 16/20 => Loss 0.133, Train_accy 83.76, Test_accy 63.31:  75%|███████▌  | 15/20 [07:21<01:55, 23.18s/it]
Task 17, Epoch 16/20 => Loss 0.133, Train_accy 83.76, Test_accy 63.31:  80%|████████  | 16/20 [07:21<02:02, 30.65s/it]
Task 17, Epoch 17/20 => Loss 0.137, Train_accy 84.76:  80%|████████  | 16/20 [07:42<02:02, 30.65s/it]                 
Task 17, Epoch 17/20 => Loss 0.137, Train_accy 84.76:  85%|████████▌ | 17/20 [07:42<01:23, 27.78s/it]
Task 17, Epoch 18/20 => Loss 0.154, Train_accy 81.92:  85%|████████▌ | 17/20 [08:03<01:23, 27.78s/it]
Task 17, Epoch 18/20 => Loss 0.154, Train_accy 81.92:  90%|█████████ | 18/20 [08:03<00:51, 25.63s/it]
Task 17, Epoch 19/20 => Loss 0.133, Train_accy 82.84:  90%|█████████ | 18/20 [08:23<00:51, 25.63s/it]
Task 17, Epoch 19/20 => Loss 0.133, Train_accy 82.84:  95%|█████████▌| 19/20 [08:23<00:24, 24.12s/it]
Task 17, Epoch 20/20 => Loss 0.144, Train_accy 83.72:  95%|█████████▌| 19/20 [08:44<00:24, 24.12s/it]
Task 17, Epoch 20/20 => Loss 0.144, Train_accy 83.72: 100%|██████████| 20/20 [08:44<00:00, 23.03s/it]
Task 17, Epoch 20/20 => Loss 0.144, Train_accy 83.72: 100%|██████████| 20/20 [08:44<00:00, 26.21s/it]
2024-09-12 15:40:54,628 [finetune.py] => Task 17, Epoch 20/20 => Loss 0.144, Train_accy 83.72
2024-09-12 15:41:22,030 [trainer.py] => No NME accuracy.
2024-09-12 15:41:22,031 [trainer.py] => CNN: {'total': 62.44, '00-04': 28.4, '05-09': 41.2, '10-14': 48.2, '15-19': 46.6, '20-24': 55.8, '25-29': 72.6, '30-34': 66.0, '35-39': 65.8, '40-44': 63.6, '45-49': 49.0, '50-54': 44.0, '55-59': 60.6, '60-64': 65.0, '65-69': 92.8, '70-74': 69.6, '75-79': 81.2, '80-84': 83.0, '85-89': 90.6, 'old': 60.79, 'new': 90.6}
2024-09-12 15:41:22,031 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92, 64.43, 60.75, 61.46, 59.86, 62.44]
2024-09-12 15:41:22,031 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45, 93.76, 92.63, 92.16, 91.47, 92.57]

Average Accuracy (CNN): 73.54
2024-09-12 15:41:22,031 [trainer.py] => Average Accuracy (CNN): 73.54 

2024-09-12 15:41:22,033 [trainer.py] => All params: 85867866
2024-09-12 15:41:22,034 [trainer.py] => Trainable params: 85867866
2024-09-12 15:41:22,036 [finetune.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.384, Train_accy 52.12, Test_accy 60.60:   0%|          | 0/20 [00:49<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.384, Train_accy 52.12, Test_accy 60.60:   5%|▌         | 1/20 [00:49<15:44, 49.73s/it]
Task 18, Epoch 2/20 => Loss 0.128, Train_accy 81.60:   5%|▌         | 1/20 [01:10<15:44, 49.73s/it]                 
Task 18, Epoch 2/20 => Loss 0.128, Train_accy 81.60:  10%|█         | 2/20 [01:10<09:48, 32.70s/it]
Task 18, Epoch 3/20 => Loss 0.112, Train_accy 85.08:  10%|█         | 2/20 [01:31<09:48, 32.70s/it]
Task 18, Epoch 3/20 => Loss 0.112, Train_accy 85.08:  15%|█▌        | 3/20 [01:31<07:41, 27.15s/it]
Task 18, Epoch 4/20 => Loss 0.112, Train_accy 85.80:  15%|█▌        | 3/20 [01:51<07:41, 27.15s/it]
Task 18, Epoch 4/20 => Loss 0.112, Train_accy 85.80:  20%|██        | 4/20 [01:51<06:33, 24.57s/it]
Task 18, Epoch 5/20 => Loss 0.102, Train_accy 85.76:  20%|██        | 4/20 [02:12<06:33, 24.57s/it]
Task 18, Epoch 5/20 => Loss 0.102, Train_accy 85.76:  25%|██▌       | 5/20 [02:12<05:46, 23.10s/it]
Task 18, Epoch 6/20 => Loss 0.086, Train_accy 86.96, Test_accy 62.63:  25%|██▌       | 5/20 [03:01<05:46, 23.10s/it]
Task 18, Epoch 6/20 => Loss 0.086, Train_accy 86.96, Test_accy 62.63:  30%|███       | 6/20 [03:01<07:28, 32.07s/it]
Task 18, Epoch 7/20 => Loss 0.082, Train_accy 89.32:  30%|███       | 6/20 [03:22<07:28, 32.07s/it]                 
Task 18, Epoch 7/20 => Loss 0.082, Train_accy 89.32:  35%|███▌      | 7/20 [03:22<06:08, 28.37s/it]
Task 18, Epoch 8/20 => Loss 0.087, Train_accy 90.48:  35%|███▌      | 7/20 [03:42<06:08, 28.37s/it]
Task 18, Epoch 8/20 => Loss 0.087, Train_accy 90.48:  40%|████      | 8/20 [03:42<05:10, 25.89s/it]
Task 18, Epoch 9/20 => Loss 0.124, Train_accy 87.00:  40%|████      | 8/20 [04:03<05:10, 25.89s/it]
Task 18, Epoch 9/20 => Loss 0.124, Train_accy 87.00:  45%|████▌     | 9/20 [04:03<04:27, 24.27s/it]
Task 18, Epoch 10/20 => Loss 0.073, Train_accy 91.52:  45%|████▌     | 9/20 [04:24<04:27, 24.27s/it]
Task 18, Epoch 10/20 => Loss 0.073, Train_accy 91.52:  50%|█████     | 10/20 [04:24<03:51, 23.14s/it]
Task 18, Epoch 11/20 => Loss 0.084, Train_accy 91.52, Test_accy 59.92:  50%|█████     | 10/20 [05:13<03:51, 23.14s/it]
Task 18, Epoch 11/20 => Loss 0.084, Train_accy 91.52, Test_accy 59.92:  55%|█████▌    | 11/20 [05:13<04:40, 31.15s/it]
Task 18, Epoch 12/20 => Loss 0.064, Train_accy 92.68:  55%|█████▌    | 11/20 [05:34<04:40, 31.15s/it]                 
Task 18, Epoch 12/20 => Loss 0.064, Train_accy 92.68:  60%|██████    | 12/20 [05:34<03:43, 27.93s/it]
Task 18, Epoch 13/20 => Loss 0.076, Train_accy 91.72:  60%|██████    | 12/20 [05:55<03:43, 27.93s/it]
Task 18, Epoch 13/20 => Loss 0.076, Train_accy 91.72:  65%|██████▌   | 13/20 [05:55<03:00, 25.84s/it]
Task 18, Epoch 14/20 => Loss 0.071, Train_accy 92.64:  65%|██████▌   | 13/20 [06:16<03:00, 25.84s/it]
Task 18, Epoch 14/20 => Loss 0.071, Train_accy 92.64:  70%|███████   | 14/20 [06:16<02:26, 24.35s/it]
Task 18, Epoch 15/20 => Loss 0.066, Train_accy 92.36:  70%|███████   | 14/20 [06:35<02:26, 24.35s/it]
Task 18, Epoch 15/20 => Loss 0.066, Train_accy 92.36:  75%|███████▌  | 15/20 [06:35<01:54, 22.87s/it]
Task 18, Epoch 16/20 => Loss 0.078, Train_accy 92.44, Test_accy 61.03:  75%|███████▌  | 15/20 [07:21<01:54, 22.87s/it]
Task 18, Epoch 16/20 => Loss 0.078, Train_accy 92.44, Test_accy 61.03:  80%|████████  | 16/20 [07:21<01:58, 29.71s/it]
Task 18, Epoch 17/20 => Loss 0.075, Train_accy 93.20:  80%|████████  | 16/20 [07:40<01:58, 29.71s/it]                 
Task 18, Epoch 17/20 => Loss 0.075, Train_accy 93.20:  85%|████████▌ | 17/20 [07:40<01:19, 26.48s/it]
Task 18, Epoch 18/20 => Loss 0.074, Train_accy 93.52:  85%|████████▌ | 17/20 [07:59<01:19, 26.48s/it]
Task 18, Epoch 18/20 => Loss 0.074, Train_accy 93.52:  90%|█████████ | 18/20 [07:59<00:48, 24.20s/it]
Task 18, Epoch 19/20 => Loss 0.079, Train_accy 92.36:  90%|█████████ | 18/20 [08:17<00:48, 24.20s/it]
Task 18, Epoch 19/20 => Loss 0.079, Train_accy 92.36:  95%|█████████▌| 19/20 [08:17<00:22, 22.63s/it]
Task 18, Epoch 20/20 => Loss 0.074, Train_accy 92.84:  95%|█████████▌| 19/20 [08:36<00:22, 22.63s/it]
Task 18, Epoch 20/20 => Loss 0.074, Train_accy 92.84: 100%|██████████| 20/20 [08:36<00:00, 21.53s/it]
Task 18, Epoch 20/20 => Loss 0.074, Train_accy 92.84: 100%|██████████| 20/20 [08:36<00:00, 25.85s/it]
2024-09-12 15:49:59,028 [finetune.py] => Task 18, Epoch 20/20 => Loss 0.074, Train_accy 92.84
2024-09-12 15:50:25,754 [trainer.py] => No NME accuracy.
2024-09-12 15:50:25,754 [trainer.py] => CNN: {'total': 60.63, '00-04': 23.4, '05-09': 33.2, '10-14': 42.2, '15-19': 44.0, '20-24': 52.0, '25-29': 70.0, '30-34': 61.6, '35-39': 66.8, '40-44': 54.6, '45-49': 55.4, '50-54': 48.4, '55-59': 59.4, '60-64': 64.2, '65-69': 92.8, '70-74': 66.4, '75-79': 65.2, '80-84': 80.8, '85-89': 74.8, '90-94': 96.8, 'old': 58.62, 'new': 96.8}
2024-09-12 15:50:25,754 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92, 64.43, 60.75, 61.46, 59.86, 62.44, 60.63]
2024-09-12 15:50:25,754 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45, 93.76, 92.63, 92.16, 91.47, 92.57, 90.77]

Average Accuracy (CNN): 72.86
2024-09-12 15:50:25,755 [trainer.py] => Average Accuracy (CNN): 72.86 

2024-09-12 15:50:25,756 [trainer.py] => All params: 85871711
2024-09-12 15:50:25,756 [trainer.py] => Trainable params: 85871711
2024-09-12 15:50:25,758 [finetune.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.422, Train_accy 51.48, Test_accy 58.52:   0%|          | 0/20 [00:47<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.422, Train_accy 51.48, Test_accy 58.52:   5%|▌         | 1/20 [00:47<14:53, 47.02s/it]
Task 19, Epoch 2/20 => Loss 0.196, Train_accy 75.96:   5%|▌         | 1/20 [01:05<14:53, 47.02s/it]                 
Task 19, Epoch 2/20 => Loss 0.196, Train_accy 75.96:  10%|█         | 2/20 [01:05<09:09, 30.51s/it]
Task 19, Epoch 3/20 => Loss 0.131, Train_accy 83.32:  10%|█         | 2/20 [01:24<09:09, 30.51s/it]
Task 19, Epoch 3/20 => Loss 0.131, Train_accy 83.32:  15%|█▌        | 3/20 [01:24<07:09, 25.24s/it]
Task 19, Epoch 4/20 => Loss 0.127, Train_accy 83.88:  15%|█▌        | 3/20 [01:43<07:09, 25.24s/it]
Task 19, Epoch 4/20 => Loss 0.127, Train_accy 83.88:  20%|██        | 4/20 [01:43<06:04, 22.76s/it]
Task 19, Epoch 5/20 => Loss 0.128, Train_accy 82.64:  20%|██        | 4/20 [02:02<06:04, 22.76s/it]
Task 19, Epoch 5/20 => Loss 0.128, Train_accy 82.64:  25%|██▌       | 5/20 [02:02<05:20, 21.38s/it]
Task 19, Epoch 6/20 => Loss 0.122, Train_accy 85.20, Test_accy 58.03:  25%|██▌       | 5/20 [02:50<05:20, 21.38s/it]
Task 19, Epoch 6/20 => Loss 0.122, Train_accy 85.20, Test_accy 58.03:  30%|███       | 6/20 [02:50<07:02, 30.20s/it]
Task 19, Epoch 7/20 => Loss 0.131, Train_accy 85.20:  30%|███       | 6/20 [03:09<07:02, 30.20s/it]                 
Task 19, Epoch 7/20 => Loss 0.131, Train_accy 85.20:  35%|███▌      | 7/20 [03:09<05:44, 26.52s/it]
Task 19, Epoch 8/20 => Loss 0.143, Train_accy 83.64:  35%|███▌      | 7/20 [03:28<05:44, 26.52s/it]
Task 19, Epoch 8/20 => Loss 0.143, Train_accy 83.64:  40%|████      | 8/20 [03:28<04:49, 24.13s/it]
Task 19, Epoch 9/20 => Loss 0.133, Train_accy 85.76:  40%|████      | 8/20 [03:47<04:49, 24.13s/it]
Task 19, Epoch 9/20 => Loss 0.133, Train_accy 85.76:  45%|████▌     | 9/20 [03:47<04:07, 22.53s/it]
Task 19, Epoch 10/20 => Loss 0.137, Train_accy 83.64:  45%|████▌     | 9/20 [04:06<04:07, 22.53s/it]
Task 19, Epoch 10/20 => Loss 0.137, Train_accy 83.64:  50%|█████     | 10/20 [04:06<03:34, 21.40s/it]
Task 19, Epoch 11/20 => Loss 0.122, Train_accy 84.92, Test_accy 59.43:  50%|█████     | 10/20 [04:55<03:34, 21.40s/it]
Task 19, Epoch 11/20 => Loss 0.122, Train_accy 84.92, Test_accy 59.43:  55%|█████▌    | 11/20 [04:55<04:29, 29.99s/it]
Task 19, Epoch 12/20 => Loss 0.120, Train_accy 85.56:  55%|█████▌    | 11/20 [05:16<04:29, 29.99s/it]                 
Task 19, Epoch 12/20 => Loss 0.120, Train_accy 85.56:  60%|██████    | 12/20 [05:16<03:38, 27.31s/it]
Task 19, Epoch 13/20 => Loss 0.104, Train_accy 87.20:  60%|██████    | 12/20 [05:37<03:38, 27.31s/it]
Task 19, Epoch 13/20 => Loss 0.104, Train_accy 87.20:  65%|██████▌   | 13/20 [05:37<02:58, 25.45s/it]
Task 19, Epoch 14/20 => Loss 0.086, Train_accy 88.68:  65%|██████▌   | 13/20 [05:59<02:58, 25.45s/it]
Task 19, Epoch 14/20 => Loss 0.086, Train_accy 88.68:  70%|███████   | 14/20 [05:59<02:25, 24.21s/it]
Task 19, Epoch 15/20 => Loss 0.094, Train_accy 88.52:  70%|███████   | 14/20 [06:20<02:25, 24.21s/it]
Task 19, Epoch 15/20 => Loss 0.094, Train_accy 88.52:  75%|███████▌  | 15/20 [06:20<01:56, 23.28s/it]
Task 19, Epoch 16/20 => Loss 0.080, Train_accy 89.60, Test_accy 56.88:  75%|███████▌  | 15/20 [07:12<01:56, 23.28s/it]
Task 19, Epoch 16/20 => Loss 0.080, Train_accy 89.60, Test_accy 56.88:  80%|████████  | 16/20 [07:12<02:08, 32.07s/it]
Task 19, Epoch 17/20 => Loss 0.099, Train_accy 89.24:  80%|████████  | 16/20 [07:34<02:08, 32.07s/it]                 
Task 19, Epoch 17/20 => Loss 0.099, Train_accy 89.24:  85%|████████▌ | 17/20 [07:34<01:26, 28.84s/it]
Task 19, Epoch 18/20 => Loss 0.118, Train_accy 86.48:  85%|████████▌ | 17/20 [07:55<01:26, 28.84s/it]
Task 19, Epoch 18/20 => Loss 0.118, Train_accy 86.48:  90%|█████████ | 18/20 [07:55<00:52, 26.50s/it]
Task 19, Epoch 19/20 => Loss 0.088, Train_accy 89.72:  90%|█████████ | 18/20 [08:16<00:52, 26.50s/it]
Task 19, Epoch 19/20 => Loss 0.088, Train_accy 89.72:  95%|█████████▌| 19/20 [08:16<00:24, 24.92s/it]
Task 19, Epoch 20/20 => Loss 0.087, Train_accy 90.64:  95%|█████████▌| 19/20 [08:37<00:24, 24.92s/it]
Task 19, Epoch 20/20 => Loss 0.087, Train_accy 90.64: 100%|██████████| 20/20 [08:37<00:00, 23.77s/it]
Task 19, Epoch 20/20 => Loss 0.087, Train_accy 90.64: 100%|██████████| 20/20 [08:37<00:00, 25.87s/it]
2024-09-12 15:59:03,275 [finetune.py] => Task 19, Epoch 20/20 => Loss 0.087, Train_accy 90.64
2024-09-12 15:59:34,653 [trainer.py] => No NME accuracy.
2024-09-12 15:59:34,653 [trainer.py] => CNN: {'total': 58.46, '00-04': 15.2, '05-09': 31.2, '10-14': 43.6, '15-19': 45.2, '20-24': 49.0, '25-29': 54.6, '30-34': 59.4, '35-39': 56.2, '40-44': 54.2, '45-49': 53.4, '50-54': 45.4, '55-59': 56.0, '60-64': 63.0, '65-69': 82.0, '70-74': 58.8, '75-79': 64.6, '80-84': 78.8, '85-89': 72.0, '90-94': 92.4, '95-99': 94.2, 'old': 56.58, 'new': 94.2}
2024-09-12 15:59:34,653 [trainer.py] => CNN top1 curve: [99.8, 93.2, 87.87, 86.0, 82.64, 78.0, 75.29, 72.28, 71.02, 63.92, 65.25, 71.5, 67.92, 64.43, 60.75, 61.46, 59.86, 62.44, 60.63, 58.46]
2024-09-12 15:59:34,653 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.6, 99.3, 98.4, 97.9, 97.43, 96.65, 96.07, 94.04, 94.71, 95.42, 94.45, 93.76, 92.63, 92.16, 91.47, 92.57, 90.77, 90.63]

Average Accuracy (CNN): 72.14
2024-09-12 15:59:34,653 [trainer.py] => Average Accuracy (CNN): 72.14 

Accuracy Matrix (CNN):
[[99.8 87.8 81.8 76.8 81.4 69.8 67.4 53.2 50.  45.8 40.8 44.4 48.6 26.6
  28.4 28.2 34.2 28.4 23.4 15.2]
 [ 0.  98.6 83.2 80.8 71.8 54.6 49.4 49.4 49.8 38.6 38.8 46.6 41.4 36.2
  40.  41.8 33.8 41.2 33.2 31.2]
 [ 0.   0.  98.6 90.  70.2 71.8 66.8 63.2 57.2 38.4 51.6 60.4 59.8 51.
  45.4 44.  45.  48.2 42.2 43.6]
 [ 0.   0.   0.  96.4 90.  76.  69.4 61.2 53.4 46.6 47.4 73.6 48.4 56.4
  49.4 51.  52.4 46.6 44.  45.2]
 [ 0.   0.   0.   0.  99.8 96.6 81.4 79.6 70.8 62.6 59.4 65.8 64.  69.4
  57.6 66.6 57.6 55.8 52.  49. ]
 [ 0.   0.   0.   0.   0.  99.2 97.8 88.8 82.4 75.4 76.  81.  80.2 77.
  72.  76.8 74.8 72.6 70.  54.6]
 [ 0.   0.   0.   0.   0.   0.  94.8 86.6 87.8 77.4 74.6 78.6 74.4 68.2
  62.8 61.4 55.8 66.  61.6 59.4]
 [ 0.   0.   0.   0.   0.   0.   0.  96.2 91.8 84.6 88.4 87.4 76.6 68.4
  65.6 57.8 66.8 65.8 66.8 56.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  96.  91.6 86.6 88.2 82.2 75.2
  68.2 66.8 66.  63.6 54.6 54.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  78.2 73.6 68.2 66.4 61.
  59.4 59.2 48.6 49.  55.4 53.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  80.6 70.4 64.4 59.4
  52.  47.6 42.2 44.  48.4 45.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.4 81.4 71.2
  57.  53.4 51.2 60.6 59.4 56. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  95.2 82.8
  71.8 68.  60.2 65.  64.2 63. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  99.2
  98.  97.  93.2 92.8 92.8 82. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  83.6 77.2 70.2 69.6 66.4 58.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  86.6 79.8 81.2 65.2 64.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  85.8 83.  80.8 78.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  90.6 74.8 72. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  96.8 92.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  94.2]]
2024-09-12 15:59:34,656 [trainer.py] => Forgetting (CNN): 36.54736842105263
2024-09-12 15:59:37,733 [trainer.py] => config: ./exps/finetune_cifar_B50_Inc5.json
2024-09-12 15:59:37,742 [trainer.py] => prefix: reproduce
2024-09-12 15:59:37,742 [trainer.py] => dataset: cifar224
2024-09-12 15:59:37,742 [trainer.py] => memory_size: 0
2024-09-12 15:59:37,742 [trainer.py] => memory_per_class: 0
2024-09-12 15:59:37,742 [trainer.py] => fixed_memory: False
2024-09-12 15:59:37,742 [trainer.py] => shuffle: True
2024-09-12 15:59:37,742 [trainer.py] => init_cls: 50
2024-09-12 15:59:37,743 [trainer.py] => increment: 10
2024-09-12 15:59:37,743 [trainer.py] => model_name: finetune
2024-09-12 15:59:37,743 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 15:59:37,743 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 15:59:37,743 [trainer.py] => seed: 1993
2024-09-12 15:59:37,743 [trainer.py] => init_epoch: 20
2024-09-12 15:59:37,743 [trainer.py] => init_lr: 0.001
2024-09-12 15:59:37,743 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 15:59:37,743 [trainer.py] => init_lr_decay: 0.1
2024-09-12 15:59:37,743 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 15:59:37,743 [trainer.py] => epochs: 20
2024-09-12 15:59:37,743 [trainer.py] => lrate: 0.001
2024-09-12 15:59:37,743 [trainer.py] => milestones: [40, 70]
2024-09-12 15:59:37,743 [trainer.py] => lrate_decay: 0.1
2024-09-12 15:59:37,743 [trainer.py] => batch_size: 48
2024-09-12 15:59:37,743 [trainer.py] => weight_decay: 0.0002
2024-09-12 15:59:38,858 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 15:59:40,977 [trainer.py] => All params: 85798656
2024-09-12 15:59:40,977 [trainer.py] => Trainable params: 85798656
2024-09-12 15:59:40,978 [finetune.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.267, Train_accy 41.81, Test_accy 87.76:   0%|          | 0/20 [03:45<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.267, Train_accy 41.81, Test_accy 87.76:   5%|▌         | 1/20 [03:45<1:11:18, 225.16s/it]
Task 0, Epoch 2/20 => Loss 0.848, Train_accy 76.28:   5%|▌         | 1/20 [07:24<1:11:18, 225.16s/it]                 
Task 0, Epoch 2/20 => Loss 0.848, Train_accy 76.28:  10%|█         | 2/20 [07:24<1:06:32, 221.79s/it]
Task 0, Epoch 3/20 => Loss 0.709, Train_accy 79.91:  10%|█         | 2/20 [11:07<1:06:32, 221.79s/it]
Task 0, Epoch 3/20 => Loss 0.709, Train_accy 79.91:  15%|█▌        | 3/20 [11:07<1:02:58, 222.25s/it]
Task 0, Epoch 4/20 => Loss 0.638, Train_accy 81.88:  15%|█▌        | 3/20 [14:50<1:02:58, 222.25s/it]
Task 0, Epoch 4/20 => Loss 0.638, Train_accy 81.88:  20%|██        | 4/20 [14:50<59:19, 222.49s/it]  
Task 0, Epoch 5/20 => Loss 0.577, Train_accy 83.60:  20%|██        | 4/20 [18:33<59:19, 222.49s/it]
Task 0, Epoch 5/20 => Loss 0.577, Train_accy 83.60:  25%|██▌       | 5/20 [18:33<55:40, 222.67s/it]
Task 0, Epoch 6/20 => Loss 0.556, Train_accy 84.05, Test_accy 91.30:  25%|██▌       | 5/20 [22:32<55:40, 222.67s/it]
Task 0, Epoch 6/20 => Loss 0.556, Train_accy 84.05, Test_accy 91.30:  30%|███       | 6/20 [22:32<53:17, 228.36s/it]
Task 0, Epoch 7/20 => Loss 0.516, Train_accy 85.42:  30%|███       | 6/20 [26:15<53:17, 228.36s/it]                 
Task 0, Epoch 7/20 => Loss 0.516, Train_accy 85.42:  35%|███▌      | 7/20 [26:15<49:05, 226.54s/it]
Task 0, Epoch 8/20 => Loss 0.506, Train_accy 85.47:  35%|███▌      | 7/20 [29:58<49:05, 226.54s/it]
Task 0, Epoch 8/20 => Loss 0.506, Train_accy 85.47:  40%|████      | 8/20 [29:58<45:04, 225.35s/it]
Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.55:  40%|████      | 8/20 [33:40<45:04, 225.35s/it]
Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.55:  45%|████▌     | 9/20 [33:40<41:08, 224.44s/it]
Task 0, Epoch 10/20 => Loss 0.456, Train_accy 87.32:  45%|████▌     | 9/20 [37:23<41:08, 224.44s/it]
Task 0, Epoch 10/20 => Loss 0.456, Train_accy 87.32:  50%|█████     | 10/20 [37:23<37:20, 224.00s/it]
Task 0, Epoch 11/20 => Loss 0.440, Train_accy 87.42, Test_accy 92.82:  50%|█████     | 10/20 [41:23<37:20, 224.00s/it]
Task 0, Epoch 11/20 => Loss 0.440, Train_accy 87.42, Test_accy 92.82:  55%|█████▌    | 11/20 [41:23<34:18, 228.74s/it]
Task 0, Epoch 12/20 => Loss 0.433, Train_accy 87.68:  55%|█████▌    | 11/20 [45:06<34:18, 228.74s/it]                 
Task 0, Epoch 12/20 => Loss 0.433, Train_accy 87.68:  60%|██████    | 12/20 [45:06<30:16, 227.04s/it]
Task 0, Epoch 13/20 => Loss 0.422, Train_accy 88.16:  60%|██████    | 12/20 [48:49<30:16, 227.04s/it]
Task 0, Epoch 13/20 => Loss 0.422, Train_accy 88.16:  65%|██████▌   | 13/20 [48:49<26:20, 225.78s/it]
Task 0, Epoch 14/20 => Loss 0.415, Train_accy 88.15:  65%|██████▌   | 13/20 [52:32<26:20, 225.78s/it]
Task 0, Epoch 14/20 => Loss 0.415, Train_accy 88.15:  70%|███████   | 14/20 [52:32<22:29, 224.97s/it]
Task 0, Epoch 15/20 => Loss 0.399, Train_accy 88.58:  70%|███████   | 14/20 [56:16<22:29, 224.97s/it]
Task 0, Epoch 15/20 => Loss 0.399, Train_accy 88.58:  75%|███████▌  | 15/20 [56:16<18:43, 224.67s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.66, Test_accy 92.98:  75%|███████▌  | 15/20 [1:00:15<18:43, 224.67s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.66, Test_accy 92.98:  80%|████████  | 16/20 [1:00:15<15:16, 229.06s/it]
Task 0, Epoch 17/20 => Loss 0.390, Train_accy 89.04:  80%|████████  | 16/20 [1:03:58<15:16, 229.06s/it]                 
Task 0, Epoch 17/20 => Loss 0.390, Train_accy 89.04:  85%|████████▌ | 17/20 [1:03:58<11:21, 227.10s/it]
Task 0, Epoch 18/20 => Loss 0.380, Train_accy 89.12:  85%|████████▌ | 17/20 [1:07:40<11:21, 227.10s/it]
Task 0, Epoch 18/20 => Loss 0.380, Train_accy 89.12:  90%|█████████ | 18/20 [1:07:40<07:31, 225.78s/it]
Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.25:  90%|█████████ | 18/20 [1:11:24<07:31, 225.78s/it]
Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.25:  95%|█████████▌| 19/20 [1:11:24<03:45, 225.01s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64:  95%|█████████▌| 19/20 [1:15:06<03:45, 225.01s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64: 100%|██████████| 20/20 [1:15:06<00:00, 224.38s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64: 100%|██████████| 20/20 [1:15:06<00:00, 225.35s/it]
2024-09-12 17:14:48,405 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64
2024-09-12 17:15:05,342 [trainer.py] => No NME accuracy.
2024-09-12 17:15:05,343 [trainer.py] => CNN: {'total': 92.58, '00-49': 92.58, 'old': 0, 'new': 92.58}
2024-09-12 17:15:05,343 [trainer.py] => CNN top1 curve: [92.58]
2024-09-12 17:15:05,343 [trainer.py] => CNN top5 curve: [98.86]

Average Accuracy (CNN): 92.58
2024-09-12 17:15:05,343 [trainer.py] => Average Accuracy (CNN): 92.58 

2024-09-12 17:15:05,345 [trainer.py] => All params: 85837106
2024-09-12 17:15:05,346 [trainer.py] => Trainable params: 85837106
2024-09-12 17:15:05,349 [finetune.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.555, Train_accy 48.72, Test_accy 89.22:   0%|          | 0/20 [01:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.555, Train_accy 48.72, Test_accy 89.22:   5%|▌         | 1/20 [01:05<20:38, 65.16s/it]
Task 1, Epoch 2/20 => Loss 0.239, Train_accy 70.76:   5%|▌         | 1/20 [01:49<20:38, 65.16s/it]                 
Task 1, Epoch 2/20 => Loss 0.239, Train_accy 70.76:  10%|█         | 2/20 [01:49<15:57, 53.19s/it]
Task 1, Epoch 3/20 => Loss 0.217, Train_accy 73.52:  10%|█         | 2/20 [02:34<15:57, 53.19s/it]
Task 1, Epoch 3/20 => Loss 0.217, Train_accy 73.52:  15%|█▌        | 3/20 [02:34<14:00, 49.41s/it]
Task 1, Epoch 4/20 => Loss 0.208, Train_accy 76.46:  15%|█▌        | 3/20 [03:19<14:00, 49.41s/it]
Task 1, Epoch 4/20 => Loss 0.208, Train_accy 76.46:  20%|██        | 4/20 [03:19<12:42, 47.64s/it]
Task 1, Epoch 5/20 => Loss 0.199, Train_accy 77.72:  20%|██        | 4/20 [04:04<12:42, 47.64s/it]
Task 1, Epoch 5/20 => Loss 0.199, Train_accy 77.72:  25%|██▌       | 5/20 [04:04<11:40, 46.68s/it]
Task 1, Epoch 6/20 => Loss 0.177, Train_accy 79.72, Test_accy 89.43:  25%|██▌       | 5/20 [05:09<11:40, 46.68s/it]
Task 1, Epoch 6/20 => Loss 0.177, Train_accy 79.72, Test_accy 89.43:  30%|███       | 6/20 [05:09<12:19, 52.82s/it]
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 79.48:  30%|███       | 6/20 [05:54<12:19, 52.82s/it]                 
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 79.48:  35%|███▌      | 7/20 [05:54<10:53, 50.25s/it]
Task 1, Epoch 8/20 => Loss 0.164, Train_accy 80.48:  35%|███▌      | 7/20 [06:39<10:53, 50.25s/it]
Task 1, Epoch 8/20 => Loss 0.164, Train_accy 80.48:  40%|████      | 8/20 [06:39<09:42, 48.55s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 82.00:  40%|████      | 8/20 [07:24<09:42, 48.55s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 82.00:  45%|████▌     | 9/20 [07:24<08:41, 47.37s/it]
Task 1, Epoch 10/20 => Loss 0.181, Train_accy 81.82:  45%|████▌     | 9/20 [08:09<08:41, 47.37s/it]
Task 1, Epoch 10/20 => Loss 0.181, Train_accy 81.82:  50%|█████     | 10/20 [08:09<07:46, 46.68s/it]
Task 1, Epoch 11/20 => Loss 0.153, Train_accy 83.64, Test_accy 89.17:  50%|█████     | 10/20 [09:14<07:46, 46.68s/it]
Task 1, Epoch 11/20 => Loss 0.153, Train_accy 83.64, Test_accy 89.17:  55%|█████▌    | 11/20 [09:14<07:50, 52.24s/it]
Task 1, Epoch 12/20 => Loss 0.157, Train_accy 83.60:  55%|█████▌    | 11/20 [09:59<07:50, 52.24s/it]                 
Task 1, Epoch 12/20 => Loss 0.157, Train_accy 83.60:  60%|██████    | 12/20 [09:59<06:40, 50.06s/it]
Task 1, Epoch 13/20 => Loss 0.151, Train_accy 84.28:  60%|██████    | 12/20 [10:44<06:40, 50.06s/it]
Task 1, Epoch 13/20 => Loss 0.151, Train_accy 84.28:  65%|██████▌   | 13/20 [10:44<05:39, 48.53s/it]
Task 1, Epoch 14/20 => Loss 0.143, Train_accy 84.86:  65%|██████▌   | 13/20 [11:29<05:39, 48.53s/it]
Task 1, Epoch 14/20 => Loss 0.143, Train_accy 84.86:  70%|███████   | 14/20 [11:29<04:44, 47.44s/it]
Task 1, Epoch 15/20 => Loss 0.143, Train_accy 85.52:  70%|███████   | 14/20 [12:14<04:44, 47.44s/it]
Task 1, Epoch 15/20 => Loss 0.143, Train_accy 85.52:  75%|███████▌  | 15/20 [12:14<03:53, 46.66s/it]
Task 1, Epoch 16/20 => Loss 0.152, Train_accy 85.84, Test_accy 88.50:  75%|███████▌  | 15/20 [13:19<03:53, 46.66s/it]
Task 1, Epoch 16/20 => Loss 0.152, Train_accy 85.84, Test_accy 88.50:  80%|████████  | 16/20 [13:19<03:28, 52.19s/it]
Task 1, Epoch 17/20 => Loss 0.132, Train_accy 86.66:  80%|████████  | 16/20 [14:03<03:28, 52.19s/it]                 
Task 1, Epoch 17/20 => Loss 0.132, Train_accy 86.66:  85%|████████▌ | 17/20 [14:03<02:29, 49.97s/it]
Task 1, Epoch 18/20 => Loss 0.148, Train_accy 85.76:  85%|████████▌ | 17/20 [14:48<02:29, 49.97s/it]
Task 1, Epoch 18/20 => Loss 0.148, Train_accy 85.76:  90%|█████████ | 18/20 [14:48<01:36, 48.49s/it]
Task 1, Epoch 19/20 => Loss 0.136, Train_accy 86.08:  90%|█████████ | 18/20 [15:33<01:36, 48.49s/it]
Task 1, Epoch 19/20 => Loss 0.136, Train_accy 86.08:  95%|█████████▌| 19/20 [15:33<00:47, 47.37s/it]
Task 1, Epoch 20/20 => Loss 0.142, Train_accy 85.82:  95%|█████████▌| 19/20 [16:18<00:47, 47.37s/it]
Task 1, Epoch 20/20 => Loss 0.142, Train_accy 85.82: 100%|██████████| 20/20 [16:18<00:00, 46.56s/it]
Task 1, Epoch 20/20 => Loss 0.142, Train_accy 85.82: 100%|██████████| 20/20 [16:18<00:00, 48.92s/it]
2024-09-12 17:31:23,692 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.142, Train_accy 85.82
2024-09-12 17:31:43,817 [trainer.py] => No NME accuracy.
2024-09-12 17:31:43,818 [trainer.py] => CNN: {'total': 88.83, '00-49': 88.6, '50-59': 90.0, 'old': 88.6, 'new': 90.0}
2024-09-12 17:31:43,818 [trainer.py] => CNN top1 curve: [92.58, 88.83]
2024-09-12 17:31:43,818 [trainer.py] => CNN top5 curve: [98.86, 98.5]

Average Accuracy (CNN): 90.7
2024-09-12 17:31:43,818 [trainer.py] => Average Accuracy (CNN): 90.7 

2024-09-12 17:31:43,819 [trainer.py] => All params: 85844796
2024-09-12 17:31:43,820 [trainer.py] => Trainable params: 85844796
2024-09-12 17:31:43,822 [finetune.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.469, Train_accy 52.58, Test_accy 86.37:   0%|          | 0/20 [01:08<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.469, Train_accy 52.58, Test_accy 86.37:   5%|▌         | 1/20 [01:08<21:41, 68.50s/it]
Task 2, Epoch 2/20 => Loss 0.198, Train_accy 72.58:   5%|▌         | 1/20 [01:53<21:41, 68.50s/it]                 
Task 2, Epoch 2/20 => Loss 0.198, Train_accy 72.58:  10%|█         | 2/20 [01:53<16:22, 54.57s/it]
Task 2, Epoch 3/20 => Loss 0.173, Train_accy 76.68:  10%|█         | 2/20 [02:38<16:22, 54.57s/it]
Task 2, Epoch 3/20 => Loss 0.173, Train_accy 76.68:  15%|█▌        | 3/20 [02:38<14:13, 50.23s/it]
Task 2, Epoch 4/20 => Loss 0.156, Train_accy 79.62:  15%|█▌        | 3/20 [03:23<14:13, 50.23s/it]
Task 2, Epoch 4/20 => Loss 0.156, Train_accy 79.62:  20%|██        | 4/20 [03:23<12:52, 48.26s/it]
Task 2, Epoch 5/20 => Loss 0.146, Train_accy 81.66:  20%|██        | 4/20 [04:08<12:52, 48.26s/it]
Task 2, Epoch 5/20 => Loss 0.146, Train_accy 81.66:  25%|██▌       | 5/20 [04:08<11:45, 47.02s/it]
Task 2, Epoch 6/20 => Loss 0.140, Train_accy 82.70, Test_accy 85.41:  25%|██▌       | 5/20 [05:16<11:45, 47.02s/it]
Task 2, Epoch 6/20 => Loss 0.140, Train_accy 82.70, Test_accy 85.41:  30%|███       | 6/20 [05:16<12:39, 54.23s/it]
Task 2, Epoch 7/20 => Loss 0.139, Train_accy 83.66:  30%|███       | 6/20 [06:01<12:39, 54.23s/it]                 
Task 2, Epoch 7/20 => Loss 0.139, Train_accy 83.66:  35%|███▌      | 7/20 [06:01<11:04, 51.15s/it]
Task 2, Epoch 8/20 => Loss 0.127, Train_accy 85.06:  35%|███▌      | 7/20 [06:46<11:04, 51.15s/it]
Task 2, Epoch 8/20 => Loss 0.127, Train_accy 85.06:  40%|████      | 8/20 [06:46<09:49, 49.13s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 85.00:  40%|████      | 8/20 [07:31<09:49, 49.13s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 85.00:  45%|████▌     | 9/20 [07:31<08:45, 47.81s/it]
Task 2, Epoch 10/20 => Loss 0.126, Train_accy 86.36:  45%|████▌     | 9/20 [08:16<08:45, 47.81s/it]
Task 2, Epoch 10/20 => Loss 0.126, Train_accy 86.36:  50%|█████     | 10/20 [08:16<07:49, 46.91s/it]
Task 2, Epoch 11/20 => Loss 0.123, Train_accy 87.04, Test_accy 86.44:  50%|█████     | 10/20 [09:24<07:49, 46.91s/it]
Task 2, Epoch 11/20 => Loss 0.123, Train_accy 87.04, Test_accy 86.44:  55%|█████▌    | 11/20 [09:24<08:01, 53.48s/it]
Task 2, Epoch 12/20 => Loss 0.135, Train_accy 87.70:  55%|█████▌    | 11/20 [10:09<08:01, 53.48s/it]                 
Task 2, Epoch 12/20 => Loss 0.135, Train_accy 87.70:  60%|██████    | 12/20 [10:09<06:47, 50.90s/it]
Task 2, Epoch 13/20 => Loss 0.134, Train_accy 88.08:  60%|██████    | 12/20 [10:54<06:47, 50.90s/it]
Task 2, Epoch 13/20 => Loss 0.134, Train_accy 88.08:  65%|██████▌   | 13/20 [10:54<05:43, 49.05s/it]
Task 2, Epoch 14/20 => Loss 0.119, Train_accy 88.12:  65%|██████▌   | 13/20 [11:39<05:43, 49.05s/it]
Task 2, Epoch 14/20 => Loss 0.119, Train_accy 88.12:  70%|███████   | 14/20 [11:39<04:46, 47.80s/it]
Task 2, Epoch 15/20 => Loss 0.124, Train_accy 87.66:  70%|███████   | 14/20 [12:24<04:46, 47.80s/it]
Task 2, Epoch 15/20 => Loss 0.124, Train_accy 87.66:  75%|███████▌  | 15/20 [12:24<03:54, 46.94s/it]
Task 2, Epoch 16/20 => Loss 0.123, Train_accy 88.56, Test_accy 85.40:  75%|███████▌  | 15/20 [13:32<03:54, 46.94s/it]
Task 2, Epoch 16/20 => Loss 0.123, Train_accy 88.56, Test_accy 85.40:  80%|████████  | 16/20 [13:32<03:33, 53.40s/it]
Task 2, Epoch 17/20 => Loss 0.111, Train_accy 89.80:  80%|████████  | 16/20 [14:17<03:33, 53.40s/it]                 
Task 2, Epoch 17/20 => Loss 0.111, Train_accy 89.80:  85%|████████▌ | 17/20 [14:17<02:32, 50.85s/it]
Task 2, Epoch 18/20 => Loss 0.136, Train_accy 89.32:  85%|████████▌ | 17/20 [15:02<02:32, 50.85s/it]
Task 2, Epoch 18/20 => Loss 0.136, Train_accy 89.32:  90%|█████████ | 18/20 [15:02<01:37, 49.00s/it]
Task 2, Epoch 19/20 => Loss 0.126, Train_accy 90.06:  90%|█████████ | 18/20 [15:47<01:37, 49.00s/it]
Task 2, Epoch 19/20 => Loss 0.126, Train_accy 90.06:  95%|█████████▌| 19/20 [15:47<00:47, 47.78s/it]
Task 2, Epoch 20/20 => Loss 0.114, Train_accy 90.50:  95%|█████████▌| 19/20 [16:31<00:47, 47.78s/it]
Task 2, Epoch 20/20 => Loss 0.114, Train_accy 90.50: 100%|██████████| 20/20 [16:31<00:00, 46.90s/it]
Task 2, Epoch 20/20 => Loss 0.114, Train_accy 90.50: 100%|██████████| 20/20 [16:31<00:00, 49.60s/it]
2024-09-12 17:48:15,771 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.114, Train_accy 90.50
2024-09-12 17:48:39,250 [trainer.py] => No NME accuracy.
2024-09-12 17:48:39,250 [trainer.py] => CNN: {'total': 85.03, '00-49': 84.72, '50-59': 75.4, '60-69': 96.2, 'old': 83.17, 'new': 96.2}
2024-09-12 17:48:39,251 [trainer.py] => CNN top1 curve: [92.58, 88.83, 85.03]
2024-09-12 17:48:39,251 [trainer.py] => CNN top5 curve: [98.86, 98.5, 97.89]

Average Accuracy (CNN): 88.81
2024-09-12 17:48:39,251 [trainer.py] => Average Accuracy (CNN): 88.81 

2024-09-12 17:48:39,252 [trainer.py] => All params: 85852486
2024-09-12 17:48:39,253 [trainer.py] => Trainable params: 85852486
2024-09-12 17:48:39,255 [finetune.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.545, Train_accy 44.34, Test_accy 78.56:   0%|          | 0/20 [01:11<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.545, Train_accy 44.34, Test_accy 78.56:   5%|▌         | 1/20 [01:11<22:46, 71.91s/it]
Task 3, Epoch 2/20 => Loss 0.246, Train_accy 65.62:   5%|▌         | 1/20 [01:56<22:46, 71.91s/it]                 
Task 3, Epoch 2/20 => Loss 0.246, Train_accy 65.62:  10%|█         | 2/20 [01:56<16:48, 56.01s/it]
Task 3, Epoch 3/20 => Loss 0.211, Train_accy 71.32:  10%|█         | 2/20 [02:41<16:48, 56.01s/it]
Task 3, Epoch 3/20 => Loss 0.211, Train_accy 71.32:  15%|█▌        | 3/20 [02:41<14:25, 50.92s/it]
Task 3, Epoch 4/20 => Loss 0.180, Train_accy 76.70:  15%|█▌        | 3/20 [03:26<14:25, 50.92s/it]
Task 3, Epoch 4/20 => Loss 0.180, Train_accy 76.70:  20%|██        | 4/20 [03:26<12:57, 48.56s/it]
Task 3, Epoch 5/20 => Loss 0.179, Train_accy 79.20:  20%|██        | 4/20 [04:11<12:57, 48.56s/it]
Task 3, Epoch 5/20 => Loss 0.179, Train_accy 79.20:  25%|██▌       | 5/20 [04:11<11:47, 47.19s/it]
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 80.60, Test_accy 79.05:  25%|██▌       | 5/20 [05:22<11:47, 47.19s/it]
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 80.60, Test_accy 79.05:  30%|███       | 6/20 [05:22<12:56, 55.46s/it]
Task 3, Epoch 7/20 => Loss 0.189, Train_accy 79.90:  30%|███       | 6/20 [06:08<12:56, 55.46s/it]                 
Task 3, Epoch 7/20 => Loss 0.189, Train_accy 79.90:  35%|███▌      | 7/20 [06:08<11:17, 52.09s/it]
Task 3, Epoch 8/20 => Loss 0.163, Train_accy 81.30:  35%|███▌      | 7/20 [06:52<11:17, 52.09s/it]
Task 3, Epoch 8/20 => Loss 0.163, Train_accy 81.30:  40%|████      | 8/20 [06:52<09:57, 49.79s/it]
Task 3, Epoch 9/20 => Loss 0.172, Train_accy 81.50:  40%|████      | 8/20 [07:37<09:57, 49.79s/it]
Task 3, Epoch 9/20 => Loss 0.172, Train_accy 81.50:  45%|████▌     | 9/20 [07:37<08:50, 48.23s/it]
Task 3, Epoch 10/20 => Loss 0.148, Train_accy 81.28:  45%|████▌     | 9/20 [08:22<08:50, 48.23s/it]
Task 3, Epoch 10/20 => Loss 0.148, Train_accy 81.28:  50%|█████     | 10/20 [08:22<07:52, 47.28s/it]
Task 3, Epoch 11/20 => Loss 0.145, Train_accy 82.68, Test_accy 78.34:  50%|█████     | 10/20 [09:34<07:52, 47.28s/it]
Task 3, Epoch 11/20 => Loss 0.145, Train_accy 82.68, Test_accy 78.34:  55%|█████▌    | 11/20 [09:34<08:13, 54.80s/it]
Task 3, Epoch 12/20 => Loss 0.145, Train_accy 84.18:  55%|█████▌    | 11/20 [10:19<08:13, 54.80s/it]                 
Task 3, Epoch 12/20 => Loss 0.145, Train_accy 84.18:  60%|██████    | 12/20 [10:19<06:54, 51.84s/it]
Task 3, Epoch 13/20 => Loss 0.152, Train_accy 84.40:  60%|██████    | 12/20 [11:04<06:54, 51.84s/it]
Task 3, Epoch 13/20 => Loss 0.152, Train_accy 84.40:  65%|██████▌   | 13/20 [11:04<05:48, 49.72s/it]
Task 3, Epoch 14/20 => Loss 0.138, Train_accy 84.72:  65%|██████▌   | 13/20 [11:49<05:48, 49.72s/it]
Task 3, Epoch 14/20 => Loss 0.138, Train_accy 84.72:  70%|███████   | 14/20 [11:49<04:49, 48.22s/it]
Task 3, Epoch 15/20 => Loss 0.143, Train_accy 85.58:  70%|███████   | 14/20 [12:34<04:49, 48.22s/it]
Task 3, Epoch 15/20 => Loss 0.143, Train_accy 85.58:  75%|███████▌  | 15/20 [12:34<03:56, 47.24s/it]
Task 3, Epoch 16/20 => Loss 0.139, Train_accy 86.78, Test_accy 76.50:  75%|███████▌  | 15/20 [13:46<03:56, 47.24s/it]
Task 3, Epoch 16/20 => Loss 0.139, Train_accy 86.78, Test_accy 76.50:  80%|████████  | 16/20 [13:46<03:38, 54.63s/it]
Task 3, Epoch 17/20 => Loss 0.132, Train_accy 87.60:  80%|████████  | 16/20 [14:30<03:38, 54.63s/it]                 
Task 3, Epoch 17/20 => Loss 0.132, Train_accy 87.60:  85%|████████▌ | 17/20 [14:30<02:34, 51.47s/it]
Task 3, Epoch 18/20 => Loss 0.116, Train_accy 88.64:  85%|████████▌ | 17/20 [15:14<02:34, 51.47s/it]
Task 3, Epoch 18/20 => Loss 0.116, Train_accy 88.64:  90%|█████████ | 18/20 [15:14<01:38, 49.41s/it]
Task 3, Epoch 19/20 => Loss 0.139, Train_accy 86.26:  90%|█████████ | 18/20 [15:59<01:38, 49.41s/it]
Task 3, Epoch 19/20 => Loss 0.139, Train_accy 86.26:  95%|█████████▌| 19/20 [15:59<00:48, 48.12s/it]
Task 3, Epoch 20/20 => Loss 0.116, Train_accy 87.82:  95%|█████████▌| 19/20 [16:45<00:48, 48.12s/it]
Task 3, Epoch 20/20 => Loss 0.116, Train_accy 87.82: 100%|██████████| 20/20 [16:45<00:00, 47.20s/it]
Task 3, Epoch 20/20 => Loss 0.116, Train_accy 87.82: 100%|██████████| 20/20 [16:45<00:00, 50.25s/it]
2024-09-12 18:05:24,327 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.116, Train_accy 87.82
2024-09-12 18:05:51,016 [trainer.py] => No NME accuracy.
2024-09-12 18:05:51,017 [trainer.py] => CNN: {'total': 76.71, '00-49': 77.32, '50-59': 58.8, '60-69': 77.6, '70-79': 90.7, 'old': 74.71, 'new': 90.7}
2024-09-12 18:05:51,017 [trainer.py] => CNN top1 curve: [92.58, 88.83, 85.03, 76.71]
2024-09-12 18:05:51,017 [trainer.py] => CNN top5 curve: [98.86, 98.5, 97.89, 96.18]

Average Accuracy (CNN): 85.79
2024-09-12 18:05:51,017 [trainer.py] => Average Accuracy (CNN): 85.79 

2024-09-12 18:05:51,019 [trainer.py] => All params: 85860176
2024-09-12 18:05:51,020 [trainer.py] => Trainable params: 85860176
2024-09-12 18:05:51,022 [finetune.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.557, Train_accy 40.38, Test_accy 73.31:   0%|          | 0/20 [01:14<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.557, Train_accy 40.38, Test_accy 73.31:   5%|▌         | 1/20 [01:14<23:36, 74.53s/it]
Task 4, Epoch 2/20 => Loss 0.236, Train_accy 65.48:   5%|▌         | 1/20 [01:59<23:36, 74.53s/it]                 
Task 4, Epoch 2/20 => Loss 0.236, Train_accy 65.48:  10%|█         | 2/20 [01:59<17:05, 56.99s/it]
Task 4, Epoch 3/20 => Loss 0.211, Train_accy 68.68:  10%|█         | 2/20 [02:44<17:05, 56.99s/it]
Task 4, Epoch 3/20 => Loss 0.211, Train_accy 68.68:  15%|█▌        | 3/20 [02:44<14:35, 51.49s/it]
Task 4, Epoch 4/20 => Loss 0.195, Train_accy 74.20:  15%|█▌        | 3/20 [03:29<14:35, 51.49s/it]
Task 4, Epoch 4/20 => Loss 0.195, Train_accy 74.20:  20%|██        | 4/20 [03:29<13:01, 48.86s/it]
Task 4, Epoch 5/20 => Loss 0.190, Train_accy 73.72:  20%|██        | 4/20 [04:13<13:01, 48.86s/it]
Task 4, Epoch 5/20 => Loss 0.190, Train_accy 73.72:  25%|██▌       | 5/20 [04:13<11:50, 47.37s/it]
Task 4, Epoch 6/20 => Loss 0.166, Train_accy 74.70, Test_accy 76.17:  25%|██▌       | 5/20 [05:29<11:50, 47.37s/it]
Task 4, Epoch 6/20 => Loss 0.166, Train_accy 74.70, Test_accy 76.17:  30%|███       | 6/20 [05:29<13:17, 56.96s/it]
Task 4, Epoch 7/20 => Loss 0.180, Train_accy 77.02:  30%|███       | 6/20 [06:14<13:17, 56.96s/it]                 
Task 4, Epoch 7/20 => Loss 0.180, Train_accy 77.02:  35%|███▌      | 7/20 [06:14<11:29, 53.01s/it]
Task 4, Epoch 8/20 => Loss 0.167, Train_accy 78.42:  35%|███▌      | 7/20 [06:58<11:29, 53.01s/it]
Task 4, Epoch 8/20 => Loss 0.167, Train_accy 78.42:  40%|████      | 8/20 [06:58<10:04, 50.39s/it]
Task 4, Epoch 9/20 => Loss 0.152, Train_accy 80.48:  40%|████      | 8/20 [07:44<10:04, 50.39s/it]
Task 4, Epoch 9/20 => Loss 0.152, Train_accy 80.48:  45%|████▌     | 9/20 [07:44<08:55, 48.73s/it]
Task 4, Epoch 10/20 => Loss 0.160, Train_accy 81.80:  45%|████▌     | 9/20 [08:29<08:55, 48.73s/it]
Task 4, Epoch 10/20 => Loss 0.160, Train_accy 81.80:  50%|█████     | 10/20 [08:29<07:55, 47.57s/it]
Task 4, Epoch 11/20 => Loss 0.162, Train_accy 81.44, Test_accy 75.77:  50%|█████     | 10/20 [09:44<07:55, 47.57s/it]
Task 4, Epoch 11/20 => Loss 0.162, Train_accy 81.44, Test_accy 75.77:  55%|█████▌    | 11/20 [09:44<08:24, 56.02s/it]
Task 4, Epoch 12/20 => Loss 0.137, Train_accy 82.84:  55%|█████▌    | 11/20 [10:29<08:24, 56.02s/it]                 
Task 4, Epoch 12/20 => Loss 0.137, Train_accy 82.84:  60%|██████    | 12/20 [10:29<07:01, 52.63s/it]
Task 4, Epoch 13/20 => Loss 0.145, Train_accy 83.02:  60%|██████    | 12/20 [11:13<07:01, 52.63s/it]
Task 4, Epoch 13/20 => Loss 0.145, Train_accy 83.02:  65%|██████▌   | 13/20 [11:13<05:51, 50.26s/it]
Task 4, Epoch 14/20 => Loss 0.130, Train_accy 84.84:  65%|██████▌   | 13/20 [11:58<05:51, 50.26s/it]
Task 4, Epoch 14/20 => Loss 0.130, Train_accy 84.84:  70%|███████   | 14/20 [11:58<04:51, 48.62s/it]
Task 4, Epoch 15/20 => Loss 0.151, Train_accy 84.32:  70%|███████   | 14/20 [12:43<04:51, 48.62s/it]
Task 4, Epoch 15/20 => Loss 0.151, Train_accy 84.32:  75%|███████▌  | 15/20 [12:43<03:57, 47.54s/it]
Task 4, Epoch 16/20 => Loss 0.134, Train_accy 86.28, Test_accy 75.20:  75%|███████▌  | 15/20 [13:58<03:57, 47.54s/it]
Task 4, Epoch 16/20 => Loss 0.134, Train_accy 86.28, Test_accy 75.20:  80%|████████  | 16/20 [13:58<03:43, 55.80s/it]
Task 4, Epoch 17/20 => Loss 0.143, Train_accy 86.32:  80%|████████  | 16/20 [14:43<03:43, 55.80s/it]                 
Task 4, Epoch 17/20 => Loss 0.143, Train_accy 86.32:  85%|████████▌ | 17/20 [14:43<02:37, 52.49s/it]
Task 4, Epoch 18/20 => Loss 0.141, Train_accy 84.86:  85%|████████▌ | 17/20 [15:28<02:37, 52.49s/it]
Task 4, Epoch 18/20 => Loss 0.141, Train_accy 84.86:  90%|█████████ | 18/20 [15:28<01:40, 50.26s/it]
Task 4, Epoch 19/20 => Loss 0.140, Train_accy 85.92:  90%|█████████ | 18/20 [16:13<01:40, 50.26s/it]
Task 4, Epoch 19/20 => Loss 0.140, Train_accy 85.92:  95%|█████████▌| 19/20 [16:13<00:48, 48.71s/it]
Task 4, Epoch 20/20 => Loss 0.137, Train_accy 87.70:  95%|█████████▌| 19/20 [16:58<00:48, 48.71s/it]
Task 4, Epoch 20/20 => Loss 0.137, Train_accy 87.70: 100%|██████████| 20/20 [16:58<00:00, 47.55s/it]
Task 4, Epoch 20/20 => Loss 0.137, Train_accy 87.70: 100%|██████████| 20/20 [16:58<00:00, 50.93s/it]
2024-09-12 18:22:49,608 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.137, Train_accy 87.70
2024-09-12 18:23:20,148 [trainer.py] => No NME accuracy.
2024-09-12 18:23:20,148 [trainer.py] => CNN: {'total': 74.3, '00-49': 73.32, '50-59': 59.9, '60-69': 73.4, '70-79': 76.0, '80-89': 92.8, 'old': 71.99, 'new': 92.8}
2024-09-12 18:23:20,148 [trainer.py] => CNN top1 curve: [92.58, 88.83, 85.03, 76.71, 74.3]
2024-09-12 18:23:20,148 [trainer.py] => CNN top5 curve: [98.86, 98.5, 97.89, 96.18, 95.78]

Average Accuracy (CNN): 83.49
2024-09-12 18:23:20,148 [trainer.py] => Average Accuracy (CNN): 83.49 

2024-09-12 18:23:20,150 [trainer.py] => All params: 85867866
2024-09-12 18:23:20,151 [trainer.py] => Trainable params: 85867866
2024-09-12 18:23:20,154 [finetune.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.554, Train_accy 41.32, Test_accy 75.09:   0%|          | 0/20 [01:18<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.554, Train_accy 41.32, Test_accy 75.09:   5%|▌         | 1/20 [01:18<24:55, 78.71s/it]
Task 5, Epoch 2/20 => Loss 0.264, Train_accy 65.80:   5%|▌         | 1/20 [02:03<24:55, 78.71s/it]                 
Task 5, Epoch 2/20 => Loss 0.264, Train_accy 65.80:  10%|█         | 2/20 [02:03<17:37, 58.76s/it]
Task 5, Epoch 3/20 => Loss 0.248, Train_accy 70.94:  10%|█         | 2/20 [02:48<17:37, 58.76s/it]
Task 5, Epoch 3/20 => Loss 0.248, Train_accy 70.94:  15%|█▌        | 3/20 [02:48<14:52, 52.48s/it]
Task 5, Epoch 4/20 => Loss 0.194, Train_accy 76.92:  15%|█▌        | 3/20 [03:33<14:52, 52.48s/it]
Task 5, Epoch 4/20 => Loss 0.194, Train_accy 76.92:  20%|██        | 4/20 [03:33<13:11, 49.47s/it]
Task 5, Epoch 5/20 => Loss 0.196, Train_accy 78.74:  20%|██        | 4/20 [04:18<13:11, 49.47s/it]
Task 5, Epoch 5/20 => Loss 0.196, Train_accy 78.74:  25%|██▌       | 5/20 [04:18<11:57, 47.82s/it]
Task 5, Epoch 6/20 => Loss 0.200, Train_accy 80.90, Test_accy 75.37:  25%|██▌       | 5/20 [05:37<11:57, 47.82s/it]
Task 5, Epoch 6/20 => Loss 0.200, Train_accy 80.90, Test_accy 75.37:  30%|███       | 6/20 [05:37<13:36, 58.35s/it]
Task 5, Epoch 7/20 => Loss 0.184, Train_accy 83.52:  30%|███       | 6/20 [06:22<13:36, 58.35s/it]                 
Task 5, Epoch 7/20 => Loss 0.184, Train_accy 83.52:  35%|███▌      | 7/20 [06:22<11:42, 54.03s/it]
Task 5, Epoch 8/20 => Loss 0.175, Train_accy 84.92:  35%|███▌      | 7/20 [07:07<11:42, 54.03s/it]
Task 5, Epoch 8/20 => Loss 0.175, Train_accy 84.92:  40%|████      | 8/20 [07:07<10:13, 51.10s/it]
Task 5, Epoch 9/20 => Loss 0.162, Train_accy 86.04:  40%|████      | 8/20 [07:51<10:13, 51.10s/it]
Task 5, Epoch 9/20 => Loss 0.162, Train_accy 86.04:  45%|████▌     | 9/20 [07:51<09:00, 49.12s/it]
Task 5, Epoch 10/20 => Loss 0.167, Train_accy 85.52:  45%|████▌     | 9/20 [08:36<09:00, 49.12s/it]
Task 5, Epoch 10/20 => Loss 0.167, Train_accy 85.52:  50%|█████     | 10/20 [08:36<07:58, 47.81s/it]
Task 5, Epoch 11/20 => Loss 0.174, Train_accy 85.98, Test_accy 75.23:  50%|█████     | 10/20 [09:55<07:58, 47.81s/it]
Task 5, Epoch 11/20 => Loss 0.174, Train_accy 85.98, Test_accy 75.23:  55%|█████▌    | 11/20 [09:55<08:34, 57.16s/it]
Task 5, Epoch 12/20 => Loss 0.158, Train_accy 87.10:  55%|█████▌    | 11/20 [10:39<08:34, 57.16s/it]                 
Task 5, Epoch 12/20 => Loss 0.158, Train_accy 87.10:  60%|██████    | 12/20 [10:39<07:07, 53.42s/it]
Task 5, Epoch 13/20 => Loss 0.147, Train_accy 87.90:  60%|██████    | 12/20 [11:24<07:07, 53.42s/it]
Task 5, Epoch 13/20 => Loss 0.147, Train_accy 87.90:  65%|██████▌   | 13/20 [11:24<05:56, 50.87s/it]
Task 5, Epoch 14/20 => Loss 0.136, Train_accy 88.40:  65%|██████▌   | 13/20 [12:09<05:56, 50.87s/it]
Task 5, Epoch 14/20 => Loss 0.136, Train_accy 88.40:  70%|███████   | 14/20 [12:09<04:54, 49.06s/it]
Task 5, Epoch 15/20 => Loss 0.146, Train_accy 89.32:  70%|███████   | 14/20 [12:54<04:54, 49.06s/it]
Task 5, Epoch 15/20 => Loss 0.146, Train_accy 89.32:  75%|███████▌  | 15/20 [12:54<03:58, 47.61s/it]
Task 5, Epoch 16/20 => Loss 0.147, Train_accy 89.48, Test_accy 75.02:  75%|███████▌  | 15/20 [14:11<03:58, 47.61s/it]
Task 5, Epoch 16/20 => Loss 0.147, Train_accy 89.48, Test_accy 75.02:  80%|████████  | 16/20 [14:11<03:45, 56.46s/it]
Task 5, Epoch 17/20 => Loss 0.148, Train_accy 90.02:  80%|████████  | 16/20 [14:54<03:45, 56.46s/it]                 
Task 5, Epoch 17/20 => Loss 0.148, Train_accy 90.02:  85%|████████▌ | 17/20 [14:54<02:37, 52.66s/it]
Task 5, Epoch 18/20 => Loss 0.132, Train_accy 90.62:  85%|████████▌ | 17/20 [15:39<02:37, 52.66s/it]
Task 5, Epoch 18/20 => Loss 0.132, Train_accy 90.62:  90%|█████████ | 18/20 [15:39<01:40, 50.14s/it]
Task 5, Epoch 19/20 => Loss 0.136, Train_accy 90.38:  90%|█████████ | 18/20 [16:23<01:40, 50.14s/it]
Task 5, Epoch 19/20 => Loss 0.136, Train_accy 90.38:  95%|█████████▌| 19/20 [16:23<00:48, 48.31s/it]
Task 5, Epoch 20/20 => Loss 0.137, Train_accy 90.82:  95%|█████████▌| 19/20 [17:06<00:48, 48.31s/it]
Task 5, Epoch 20/20 => Loss 0.137, Train_accy 90.82: 100%|██████████| 20/20 [17:06<00:00, 46.94s/it]
Task 5, Epoch 20/20 => Loss 0.137, Train_accy 90.82: 100%|██████████| 20/20 [17:06<00:00, 51.34s/it]
2024-09-12 18:40:27,101 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.137, Train_accy 90.82
2024-09-12 18:41:00,164 [trainer.py] => No NME accuracy.
2024-09-12 18:41:00,165 [trainer.py] => CNN: {'total': 75.74, '00-49': 75.8, '50-59': 56.1, '60-69': 69.6, '70-79': 72.6, '80-89': 85.3, '90-99': 94.8, 'old': 73.62, 'new': 94.8}
2024-09-12 18:41:00,165 [trainer.py] => CNN top1 curve: [92.58, 88.83, 85.03, 76.71, 74.3, 75.74]
2024-09-12 18:41:00,165 [trainer.py] => CNN top5 curve: [98.86, 98.5, 97.89, 96.18, 95.78, 95.42]

Average Accuracy (CNN): 82.2
2024-09-12 18:41:00,165 [trainer.py] => Average Accuracy (CNN): 82.2 

Accuracy Matrix (CNN):
[[92.58 88.6  84.72 77.32 73.32 75.8 ]
 [ 0.   90.   75.4  58.8  59.9  56.1 ]
 [ 0.    0.   96.2  77.6  73.4  69.6 ]
 [ 0.    0.    0.   90.7  76.   72.6 ]
 [ 0.    0.    0.    0.   92.8  85.3 ]
 [ 0.    0.    0.    0.    0.   94.8 ]]
2024-09-12 18:41:00,167 [trainer.py] => Forgetting (CNN): 20.576
2024-09-12 18:41:03,618 [trainer.py] => config: ./exps/finetune_cifar_B50_Inc10.json
2024-09-12 18:41:03,618 [trainer.py] => prefix: reproduce
2024-09-12 18:41:03,618 [trainer.py] => dataset: cifar224
2024-09-12 18:41:03,618 [trainer.py] => memory_size: 0
2024-09-12 18:41:03,618 [trainer.py] => memory_per_class: 0
2024-09-12 18:41:03,618 [trainer.py] => fixed_memory: False
2024-09-12 18:41:03,618 [trainer.py] => shuffle: True
2024-09-12 18:41:03,618 [trainer.py] => init_cls: 50
2024-09-12 18:41:03,618 [trainer.py] => increment: 5
2024-09-12 18:41:03,618 [trainer.py] => model_name: finetune
2024-09-12 18:41:03,618 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 18:41:03,618 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 18:41:03,618 [trainer.py] => seed: 1993
2024-09-12 18:41:03,618 [trainer.py] => init_epoch: 20
2024-09-12 18:41:03,618 [trainer.py] => init_lr: 0.001
2024-09-12 18:41:03,618 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 18:41:03,618 [trainer.py] => init_lr_decay: 0.1
2024-09-12 18:41:03,618 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 18:41:03,618 [trainer.py] => epochs: 20
2024-09-12 18:41:03,618 [trainer.py] => lrate: 0.001
2024-09-12 18:41:03,618 [trainer.py] => milestones: [40, 70]
2024-09-12 18:41:03,618 [trainer.py] => lrate_decay: 0.1
2024-09-12 18:41:03,618 [trainer.py] => batch_size: 48
2024-09-12 18:41:03,618 [trainer.py] => weight_decay: 0.0002
2024-09-12 18:41:04,707 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 18:41:06,737 [trainer.py] => All params: 85798656
2024-09-12 18:41:06,737 [trainer.py] => Trainable params: 85798656
2024-09-12 18:41:06,738 [finetune.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.267, Train_accy 41.81, Test_accy 87.76:   0%|          | 0/20 [03:58<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.267, Train_accy 41.81, Test_accy 87.76:   5%|▌         | 1/20 [03:58<1:15:39, 238.91s/it]
Task 0, Epoch 2/20 => Loss 0.848, Train_accy 76.28:   5%|▌         | 1/20 [07:42<1:15:39, 238.91s/it]                 
Task 0, Epoch 2/20 => Loss 0.848, Train_accy 76.28:  10%|█         | 2/20 [07:42<1:08:58, 229.93s/it]
Task 0, Epoch 3/20 => Loss 0.709, Train_accy 79.91:  10%|█         | 2/20 [11:25<1:08:58, 229.93s/it]
Task 0, Epoch 3/20 => Loss 0.709, Train_accy 79.91:  15%|█▌        | 3/20 [11:25<1:04:13, 226.66s/it]
Task 0, Epoch 4/20 => Loss 0.638, Train_accy 81.88:  15%|█▌        | 3/20 [15:07<1:04:13, 226.66s/it]
Task 0, Epoch 4/20 => Loss 0.638, Train_accy 81.88:  20%|██        | 4/20 [15:07<59:59, 224.99s/it]  
Task 0, Epoch 5/20 => Loss 0.577, Train_accy 83.60:  20%|██        | 4/20 [18:47<59:59, 224.99s/it]
Task 0, Epoch 5/20 => Loss 0.577, Train_accy 83.60:  25%|██▌       | 5/20 [18:47<55:48, 223.23s/it]
Task 0, Epoch 6/20 => Loss 0.556, Train_accy 84.05, Test_accy 91.30:  25%|██▌       | 5/20 [22:48<55:48, 223.23s/it]
Task 0, Epoch 6/20 => Loss 0.556, Train_accy 84.05, Test_accy 91.30:  30%|███       | 6/20 [22:48<53:26, 229.03s/it]
Task 0, Epoch 7/20 => Loss 0.516, Train_accy 85.42:  30%|███       | 6/20 [26:31<53:26, 229.03s/it]                 
Task 0, Epoch 7/20 => Loss 0.516, Train_accy 85.42:  35%|███▌      | 7/20 [26:31<49:12, 227.08s/it]
Task 0, Epoch 8/20 => Loss 0.506, Train_accy 85.47:  35%|███▌      | 7/20 [30:14<49:12, 227.08s/it]
Task 0, Epoch 8/20 => Loss 0.506, Train_accy 85.47:  40%|████      | 8/20 [30:14<45:09, 225.76s/it]
Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.55:  40%|████      | 8/20 [33:57<45:09, 225.76s/it]
Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.55:  45%|████▌     | 9/20 [33:57<41:13, 224.89s/it]
Task 0, Epoch 10/20 => Loss 0.456, Train_accy 87.32:  45%|████▌     | 9/20 [37:40<41:13, 224.89s/it]
Task 0, Epoch 10/20 => Loss 0.456, Train_accy 87.32:  50%|█████     | 10/20 [37:40<37:23, 224.34s/it]
Task 0, Epoch 11/20 => Loss 0.440, Train_accy 87.42, Test_accy 92.82:  50%|█████     | 10/20 [41:42<37:23, 224.34s/it]
Task 0, Epoch 11/20 => Loss 0.440, Train_accy 87.42, Test_accy 92.82:  55%|█████▌    | 11/20 [41:42<34:29, 229.90s/it]
Task 0, Epoch 12/20 => Loss 0.433, Train_accy 87.68:  55%|█████▌    | 11/20 [45:26<34:29, 229.90s/it]                 
Task 0, Epoch 12/20 => Loss 0.433, Train_accy 87.68:  60%|██████    | 12/20 [45:26<30:24, 228.02s/it]
Task 0, Epoch 13/20 => Loss 0.422, Train_accy 88.16:  60%|██████    | 12/20 [49:09<30:24, 228.02s/it]
Task 0, Epoch 13/20 => Loss 0.422, Train_accy 88.16:  65%|██████▌   | 13/20 [49:09<26:25, 226.52s/it]
Task 0, Epoch 14/20 => Loss 0.415, Train_accy 88.15:  65%|██████▌   | 13/20 [52:53<26:25, 226.52s/it]
Task 0, Epoch 14/20 => Loss 0.415, Train_accy 88.15:  70%|███████   | 14/20 [52:53<22:34, 225.68s/it]
Task 0, Epoch 15/20 => Loss 0.399, Train_accy 88.58:  70%|███████   | 14/20 [56:35<22:34, 225.68s/it]
Task 0, Epoch 15/20 => Loss 0.399, Train_accy 88.58:  75%|███████▌  | 15/20 [56:35<18:43, 224.71s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.66, Test_accy 92.98:  75%|███████▌  | 15/20 [1:00:35<18:43, 224.71s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.66, Test_accy 92.98:  80%|████████  | 16/20 [1:00:35<15:16, 229.21s/it]
Task 0, Epoch 17/20 => Loss 0.390, Train_accy 89.04:  80%|████████  | 16/20 [1:04:18<15:16, 229.21s/it]                 
Task 0, Epoch 17/20 => Loss 0.390, Train_accy 89.04:  85%|████████▌ | 17/20 [1:04:18<11:21, 227.28s/it]
Task 0, Epoch 18/20 => Loss 0.380, Train_accy 89.12:  85%|████████▌ | 17/20 [1:08:02<11:21, 227.28s/it]
Task 0, Epoch 18/20 => Loss 0.380, Train_accy 89.12:  90%|█████████ | 18/20 [1:08:02<07:32, 226.33s/it]
Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.25:  90%|█████████ | 18/20 [1:11:46<07:32, 226.33s/it]
Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.25:  95%|█████████▌| 19/20 [1:11:46<03:45, 225.67s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64:  95%|█████████▌| 19/20 [1:15:27<03:45, 225.67s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64: 100%|██████████| 20/20 [1:15:27<00:00, 224.40s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64: 100%|██████████| 20/20 [1:15:27<00:00, 226.39s/it]
2024-09-12 19:56:35,221 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.64
2024-09-12 19:56:51,761 [trainer.py] => No NME accuracy.
2024-09-12 19:56:51,762 [trainer.py] => CNN: {'total': 92.58, '00-49': 92.58, 'old': 0, 'new': 92.58}
2024-09-12 19:56:51,763 [trainer.py] => CNN top1 curve: [92.58]
2024-09-12 19:56:51,763 [trainer.py] => CNN top5 curve: [98.86]

Average Accuracy (CNN): 92.58
2024-09-12 19:56:51,763 [trainer.py] => Average Accuracy (CNN): 92.58 

2024-09-12 19:56:51,765 [trainer.py] => All params: 85837106
2024-09-12 19:56:51,766 [trainer.py] => Trainable params: 85837106
2024-09-12 19:56:51,785 [finetune.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.360, Train_accy 38.64, Test_accy 86.16:   0%|          | 0/20 [00:41<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.360, Train_accy 38.64, Test_accy 86.16:   5%|▌         | 1/20 [00:41<13:00, 41.09s/it]
Task 1, Epoch 2/20 => Loss 0.142, Train_accy 53.48:   5%|▌         | 1/20 [01:03<13:00, 41.09s/it]                 
Task 1, Epoch 2/20 => Loss 0.142, Train_accy 53.48:  10%|█         | 2/20 [01:03<09:01, 30.09s/it]
Task 1, Epoch 3/20 => Loss 0.121, Train_accy 61.28:  10%|█         | 2/20 [01:25<09:01, 30.09s/it]
Task 1, Epoch 3/20 => Loss 0.121, Train_accy 61.28:  15%|█▌        | 3/20 [01:25<07:31, 26.57s/it]
Task 1, Epoch 4/20 => Loss 0.093, Train_accy 64.32:  15%|█▌        | 3/20 [01:48<07:31, 26.57s/it]
Task 1, Epoch 4/20 => Loss 0.093, Train_accy 64.32:  20%|██        | 4/20 [01:48<06:38, 24.93s/it]
Task 1, Epoch 5/20 => Loss 0.087, Train_accy 64.64:  20%|██        | 4/20 [02:10<06:38, 24.93s/it]
Task 1, Epoch 5/20 => Loss 0.087, Train_accy 64.64:  25%|██▌       | 5/20 [02:10<06:01, 24.09s/it]
Task 1, Epoch 6/20 => Loss 0.099, Train_accy 65.16, Test_accy 88.07:  25%|██▌       | 5/20 [02:51<06:01, 24.09s/it]
Task 1, Epoch 6/20 => Loss 0.099, Train_accy 65.16, Test_accy 88.07:  30%|███       | 6/20 [02:51<06:57, 29.81s/it]
Task 1, Epoch 7/20 => Loss 0.075, Train_accy 70.12:  30%|███       | 6/20 [03:13<06:57, 29.81s/it]                 
Task 1, Epoch 7/20 => Loss 0.075, Train_accy 70.12:  35%|███▌      | 7/20 [03:13<05:54, 27.29s/it]
Task 1, Epoch 8/20 => Loss 0.079, Train_accy 72.48:  35%|███▌      | 7/20 [03:36<05:54, 27.29s/it]
Task 1, Epoch 8/20 => Loss 0.079, Train_accy 72.48:  40%|████      | 8/20 [03:36<05:08, 25.72s/it]
Task 1, Epoch 9/20 => Loss 0.083, Train_accy 70.92:  40%|████      | 8/20 [03:58<05:08, 25.72s/it]
Task 1, Epoch 9/20 => Loss 0.083, Train_accy 70.92:  45%|████▌     | 9/20 [03:58<04:30, 24.57s/it]
Task 1, Epoch 10/20 => Loss 0.055, Train_accy 71.04:  45%|████▌     | 9/20 [04:20<04:30, 24.57s/it]
Task 1, Epoch 10/20 => Loss 0.055, Train_accy 71.04:  50%|█████     | 10/20 [04:20<03:59, 23.95s/it]
Task 1, Epoch 11/20 => Loss 0.077, Train_accy 71.36, Test_accy 87.24:  50%|█████     | 10/20 [05:01<03:59, 23.95s/it]
Task 1, Epoch 11/20 => Loss 0.077, Train_accy 71.36, Test_accy 87.24:  55%|█████▌    | 11/20 [05:01<04:22, 29.16s/it]
Task 1, Epoch 12/20 => Loss 0.070, Train_accy 72.72:  55%|█████▌    | 11/20 [05:24<04:22, 29.16s/it]                 
Task 1, Epoch 12/20 => Loss 0.070, Train_accy 72.72:  60%|██████    | 12/20 [05:24<03:37, 27.17s/it]
Task 1, Epoch 13/20 => Loss 0.091, Train_accy 74.40:  60%|██████    | 12/20 [05:46<03:37, 27.17s/it]
Task 1, Epoch 13/20 => Loss 0.091, Train_accy 74.40:  65%|██████▌   | 13/20 [05:46<03:00, 25.76s/it]
Task 1, Epoch 14/20 => Loss 0.052, Train_accy 76.96:  65%|██████▌   | 13/20 [06:09<03:00, 25.76s/it]
Task 1, Epoch 14/20 => Loss 0.052, Train_accy 76.96:  70%|███████   | 14/20 [06:09<02:28, 24.78s/it]
Task 1, Epoch 15/20 => Loss 0.067, Train_accy 77.16:  70%|███████   | 14/20 [06:31<02:28, 24.78s/it]
Task 1, Epoch 15/20 => Loss 0.067, Train_accy 77.16:  75%|███████▌  | 15/20 [06:31<02:00, 24.10s/it]
Task 1, Epoch 16/20 => Loss 0.077, Train_accy 74.24, Test_accy 88.80:  75%|███████▌  | 15/20 [07:13<02:00, 24.10s/it]
Task 1, Epoch 16/20 => Loss 0.077, Train_accy 74.24, Test_accy 88.80:  80%|████████  | 16/20 [07:13<01:56, 29.24s/it]
Task 1, Epoch 17/20 => Loss 0.068, Train_accy 73.84:  80%|████████  | 16/20 [07:35<01:56, 29.24s/it]                 
Task 1, Epoch 17/20 => Loss 0.068, Train_accy 73.84:  85%|████████▌ | 17/20 [07:35<01:21, 27.15s/it]
Task 1, Epoch 18/20 => Loss 0.065, Train_accy 76.96:  85%|████████▌ | 17/20 [07:58<01:21, 27.15s/it]
Task 1, Epoch 18/20 => Loss 0.065, Train_accy 76.96:  90%|█████████ | 18/20 [07:58<00:51, 25.81s/it]
Task 1, Epoch 19/20 => Loss 0.063, Train_accy 78.96:  90%|█████████ | 18/20 [08:20<00:51, 25.81s/it]
Task 1, Epoch 19/20 => Loss 0.063, Train_accy 78.96:  95%|█████████▌| 19/20 [08:20<00:24, 24.75s/it]
Task 1, Epoch 20/20 => Loss 0.068, Train_accy 78.04:  95%|█████████▌| 19/20 [08:42<00:24, 24.75s/it]
Task 1, Epoch 20/20 => Loss 0.068, Train_accy 78.04: 100%|██████████| 20/20 [08:42<00:00, 24.04s/it]
Task 1, Epoch 20/20 => Loss 0.068, Train_accy 78.04: 100%|██████████| 20/20 [08:42<00:00, 26.14s/it]
2024-09-12 20:05:35,648 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.068, Train_accy 78.04
2024-09-12 20:05:54,061 [trainer.py] => No NME accuracy.
2024-09-12 20:05:54,062 [trainer.py] => CNN: {'total': 88.67, '00-49': 89.34, '50-54': 82.0, 'old': 89.34, 'new': 82.0}
2024-09-12 20:05:54,062 [trainer.py] => CNN top1 curve: [92.58, 88.67]
2024-09-12 20:05:54,062 [trainer.py] => CNN top5 curve: [98.86, 98.69]

Average Accuracy (CNN): 90.62
2024-09-12 20:05:54,062 [trainer.py] => Average Accuracy (CNN): 90.62 

2024-09-12 20:05:54,063 [trainer.py] => All params: 85840951
2024-09-12 20:05:54,065 [trainer.py] => Trainable params: 85840951
2024-09-12 20:05:54,067 [finetune.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.526, Train_accy 34.68, Test_accy 86.43:   0%|          | 0/20 [00:42<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.526, Train_accy 34.68, Test_accy 86.43:   5%|▌         | 1/20 [00:42<13:32, 42.78s/it]
Task 2, Epoch 2/20 => Loss 0.242, Train_accy 64.52:   5%|▌         | 1/20 [01:04<13:32, 42.78s/it]                 
Task 2, Epoch 2/20 => Loss 0.242, Train_accy 64.52:  10%|█         | 2/20 [01:04<09:11, 30.66s/it]
Task 2, Epoch 3/20 => Loss 0.249, Train_accy 68.80:  10%|█         | 2/20 [01:27<09:11, 30.66s/it]
Task 2, Epoch 3/20 => Loss 0.249, Train_accy 68.80:  15%|█▌        | 3/20 [01:27<07:39, 27.01s/it]
Task 2, Epoch 4/20 => Loss 0.199, Train_accy 72.08:  15%|█▌        | 3/20 [01:50<07:39, 27.01s/it]
Task 2, Epoch 4/20 => Loss 0.199, Train_accy 72.08:  20%|██        | 4/20 [01:50<06:44, 25.31s/it]
Task 2, Epoch 5/20 => Loss 0.194, Train_accy 74.96:  20%|██        | 4/20 [02:12<06:44, 25.31s/it]
Task 2, Epoch 5/20 => Loss 0.194, Train_accy 74.96:  25%|██▌       | 5/20 [02:12<06:05, 24.35s/it]
Task 2, Epoch 6/20 => Loss 0.172, Train_accy 76.16, Test_accy 88.22:  25%|██▌       | 5/20 [02:55<06:05, 24.35s/it]
Task 2, Epoch 6/20 => Loss 0.172, Train_accy 76.16, Test_accy 88.22:  30%|███       | 6/20 [02:55<07:08, 30.64s/it]
Task 2, Epoch 7/20 => Loss 0.166, Train_accy 76.84:  30%|███       | 6/20 [03:18<07:08, 30.64s/it]                 
Task 2, Epoch 7/20 => Loss 0.166, Train_accy 76.84:  35%|███▌      | 7/20 [03:18<06:04, 28.04s/it]
Task 2, Epoch 8/20 => Loss 0.164, Train_accy 78.28:  35%|███▌      | 7/20 [03:40<06:04, 28.04s/it]
Task 2, Epoch 8/20 => Loss 0.164, Train_accy 78.28:  40%|████      | 8/20 [03:40<05:14, 26.21s/it]
Task 2, Epoch 9/20 => Loss 0.164, Train_accy 80.12:  40%|████      | 8/20 [04:03<05:14, 26.21s/it]
Task 2, Epoch 9/20 => Loss 0.164, Train_accy 80.12:  45%|████▌     | 9/20 [04:03<04:35, 25.08s/it]
Task 2, Epoch 10/20 => Loss 0.181, Train_accy 78.40:  45%|████▌     | 9/20 [04:25<04:35, 25.08s/it]
Task 2, Epoch 10/20 => Loss 0.181, Train_accy 78.40:  50%|█████     | 10/20 [04:25<04:02, 24.27s/it]
Task 2, Epoch 11/20 => Loss 0.148, Train_accy 80.80, Test_accy 88.55:  50%|█████     | 10/20 [05:08<04:02, 24.27s/it]
Task 2, Epoch 11/20 => Loss 0.148, Train_accy 80.80, Test_accy 88.55:  55%|█████▌    | 11/20 [05:08<04:29, 29.96s/it]
Task 2, Epoch 12/20 => Loss 0.164, Train_accy 80.80:  55%|█████▌    | 11/20 [05:31<04:29, 29.96s/it]                 
Task 2, Epoch 12/20 => Loss 0.164, Train_accy 80.80:  60%|██████    | 12/20 [05:31<03:41, 27.70s/it]
Task 2, Epoch 13/20 => Loss 0.190, Train_accy 79.48:  60%|██████    | 12/20 [05:53<03:41, 27.70s/it]
Task 2, Epoch 13/20 => Loss 0.190, Train_accy 79.48:  65%|██████▌   | 13/20 [05:53<03:03, 26.16s/it]
Task 2, Epoch 14/20 => Loss 0.175, Train_accy 79.24:  65%|██████▌   | 13/20 [06:16<03:03, 26.16s/it]
Task 2, Epoch 14/20 => Loss 0.175, Train_accy 79.24:  70%|███████   | 14/20 [06:16<02:30, 25.02s/it]
Task 2, Epoch 15/20 => Loss 0.159, Train_accy 81.52:  70%|███████   | 14/20 [06:38<02:30, 25.02s/it]
Task 2, Epoch 15/20 => Loss 0.159, Train_accy 81.52:  75%|███████▌  | 15/20 [06:38<02:01, 24.25s/it]
Task 2, Epoch 16/20 => Loss 0.153, Train_accy 81.96, Test_accy 88.45:  75%|███████▌  | 15/20 [07:20<02:01, 24.25s/it]
Task 2, Epoch 16/20 => Loss 0.153, Train_accy 81.96, Test_accy 88.45:  80%|████████  | 16/20 [07:20<01:58, 29.60s/it]
Task 2, Epoch 17/20 => Loss 0.130, Train_accy 84.00:  80%|████████  | 16/20 [07:43<01:58, 29.60s/it]                 
Task 2, Epoch 17/20 => Loss 0.130, Train_accy 84.00:  85%|████████▌ | 17/20 [07:43<01:22, 27.53s/it]
Task 2, Epoch 18/20 => Loss 0.123, Train_accy 84.48:  85%|████████▌ | 17/20 [08:06<01:22, 27.53s/it]
Task 2, Epoch 18/20 => Loss 0.123, Train_accy 84.48:  90%|█████████ | 18/20 [08:06<00:52, 26.04s/it]
Task 2, Epoch 19/20 => Loss 0.148, Train_accy 83.56:  90%|█████████ | 18/20 [08:28<00:52, 26.04s/it]
Task 2, Epoch 19/20 => Loss 0.148, Train_accy 83.56:  95%|█████████▌| 19/20 [08:28<00:25, 25.03s/it]
Task 2, Epoch 20/20 => Loss 0.145, Train_accy 84.12:  95%|█████████▌| 19/20 [08:51<00:25, 25.03s/it]
Task 2, Epoch 20/20 => Loss 0.145, Train_accy 84.12: 100%|██████████| 20/20 [08:51<00:00, 24.22s/it]
Task 2, Epoch 20/20 => Loss 0.145, Train_accy 84.12: 100%|██████████| 20/20 [08:51<00:00, 26.55s/it]
2024-09-12 20:14:45,562 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.145, Train_accy 84.12
2024-09-12 20:15:05,466 [trainer.py] => No NME accuracy.
2024-09-12 20:15:05,466 [trainer.py] => CNN: {'total': 88.32, '00-49': 89.18, '50-54': 77.2, '55-59': 90.8, 'old': 88.09, 'new': 90.8}
2024-09-12 20:15:05,466 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32]
2024-09-12 20:15:05,466 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37]

Average Accuracy (CNN): 89.86
2024-09-12 20:15:05,466 [trainer.py] => Average Accuracy (CNN): 89.86 

2024-09-12 20:15:05,468 [trainer.py] => All params: 85844796
2024-09-12 20:15:05,469 [trainer.py] => Trainable params: 85844796
2024-09-12 20:15:05,471 [finetune.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.310, Train_accy 44.12, Test_accy 85.40:   0%|          | 0/20 [00:45<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.310, Train_accy 44.12, Test_accy 85.40:   5%|▌         | 1/20 [00:45<14:20, 45.30s/it]
Task 3, Epoch 2/20 => Loss 0.104, Train_accy 76.24:   5%|▌         | 1/20 [01:07<14:20, 45.30s/it]                 
Task 3, Epoch 2/20 => Loss 0.104, Train_accy 76.24:  10%|█         | 2/20 [01:07<09:33, 31.88s/it]
Task 3, Epoch 3/20 => Loss 0.116, Train_accy 79.00:  10%|█         | 2/20 [01:30<09:33, 31.88s/it]
Task 3, Epoch 3/20 => Loss 0.116, Train_accy 79.00:  15%|█▌        | 3/20 [01:30<07:49, 27.63s/it]
Task 3, Epoch 4/20 => Loss 0.130, Train_accy 73.40:  15%|█▌        | 3/20 [01:52<07:49, 27.63s/it]
Task 3, Epoch 4/20 => Loss 0.130, Train_accy 73.40:  20%|██        | 4/20 [01:52<06:49, 25.61s/it]
Task 3, Epoch 5/20 => Loss 0.108, Train_accy 81.76:  20%|██        | 4/20 [02:15<06:49, 25.61s/it]
Task 3, Epoch 5/20 => Loss 0.108, Train_accy 81.76:  25%|██▌       | 5/20 [02:15<06:06, 24.44s/it]
Task 3, Epoch 6/20 => Loss 0.143, Train_accy 76.32, Test_accy 85.35:  25%|██▌       | 5/20 [02:59<06:06, 24.44s/it]
Task 3, Epoch 6/20 => Loss 0.143, Train_accy 76.32, Test_accy 85.35:  30%|███       | 6/20 [02:59<07:16, 31.20s/it]
Task 3, Epoch 7/20 => Loss 0.090, Train_accy 81.72:  30%|███       | 6/20 [03:22<07:16, 31.20s/it]                 
Task 3, Epoch 7/20 => Loss 0.090, Train_accy 81.72:  35%|███▌      | 7/20 [03:22<06:09, 28.39s/it]
Task 3, Epoch 8/20 => Loss 0.096, Train_accy 82.32:  35%|███▌      | 7/20 [03:44<06:09, 28.39s/it]
Task 3, Epoch 8/20 => Loss 0.096, Train_accy 82.32:  40%|████      | 8/20 [03:44<05:18, 26.54s/it]
Task 3, Epoch 9/20 => Loss 0.102, Train_accy 83.84:  40%|████      | 8/20 [04:07<05:18, 26.54s/it]
Task 3, Epoch 9/20 => Loss 0.102, Train_accy 83.84:  45%|████▌     | 9/20 [04:07<04:37, 25.27s/it]
Task 3, Epoch 10/20 => Loss 0.072, Train_accy 87.04:  45%|████▌     | 9/20 [04:29<04:37, 25.27s/it]
Task 3, Epoch 10/20 => Loss 0.072, Train_accy 87.04:  50%|█████     | 10/20 [04:29<04:04, 24.49s/it]
Task 3, Epoch 11/20 => Loss 0.101, Train_accy 87.04, Test_accy 85.11:  50%|█████     | 10/20 [05:14<04:04, 24.49s/it]
Task 3, Epoch 11/20 => Loss 0.101, Train_accy 87.04, Test_accy 85.11:  55%|█████▌    | 11/20 [05:14<04:36, 30.68s/it]
Task 3, Epoch 12/20 => Loss 0.109, Train_accy 82.72:  55%|█████▌    | 11/20 [05:37<04:36, 30.68s/it]                 
Task 3, Epoch 12/20 => Loss 0.109, Train_accy 82.72:  60%|██████    | 12/20 [05:37<03:45, 28.17s/it]
Task 3, Epoch 13/20 => Loss 0.071, Train_accy 84.72:  60%|██████    | 12/20 [05:59<03:45, 28.17s/it]
Task 3, Epoch 13/20 => Loss 0.071, Train_accy 84.72:  65%|██████▌   | 13/20 [05:59<03:05, 26.44s/it]
Task 3, Epoch 14/20 => Loss 0.078, Train_accy 86.44:  65%|██████▌   | 13/20 [06:22<03:05, 26.44s/it]
Task 3, Epoch 14/20 => Loss 0.078, Train_accy 86.44:  70%|███████   | 14/20 [06:22<02:31, 25.28s/it]
Task 3, Epoch 15/20 => Loss 0.083, Train_accy 86.52:  70%|███████   | 14/20 [06:44<02:31, 25.28s/it]
Task 3, Epoch 15/20 => Loss 0.083, Train_accy 86.52:  75%|███████▌  | 15/20 [06:44<02:02, 24.47s/it]
Task 3, Epoch 16/20 => Loss 0.070, Train_accy 86.56, Test_accy 85.23:  75%|███████▌  | 15/20 [07:29<02:02, 24.47s/it]
Task 3, Epoch 16/20 => Loss 0.070, Train_accy 86.56, Test_accy 85.23:  80%|████████  | 16/20 [07:29<02:02, 30.58s/it]
Task 3, Epoch 17/20 => Loss 0.082, Train_accy 87.52:  80%|████████  | 16/20 [07:51<02:02, 30.58s/it]                 
Task 3, Epoch 17/20 => Loss 0.082, Train_accy 87.52:  85%|████████▌ | 17/20 [07:51<01:24, 28.08s/it]
Task 3, Epoch 18/20 => Loss 0.073, Train_accy 88.04:  85%|████████▌ | 17/20 [08:14<01:24, 28.08s/it]
Task 3, Epoch 18/20 => Loss 0.073, Train_accy 88.04:  90%|█████████ | 18/20 [08:14<00:52, 26.37s/it]
Task 3, Epoch 19/20 => Loss 0.073, Train_accy 87.56:  90%|█████████ | 18/20 [08:36<00:52, 26.37s/it]
Task 3, Epoch 19/20 => Loss 0.073, Train_accy 87.56:  95%|█████████▌| 19/20 [08:36<00:25, 25.21s/it]
Task 3, Epoch 20/20 => Loss 0.074, Train_accy 86.76:  95%|█████████▌| 19/20 [08:59<00:25, 25.21s/it]
Task 3, Epoch 20/20 => Loss 0.074, Train_accy 86.76: 100%|██████████| 20/20 [08:59<00:00, 24.44s/it]
Task 3, Epoch 20/20 => Loss 0.074, Train_accy 86.76: 100%|██████████| 20/20 [08:59<00:00, 26.97s/it]
2024-09-12 20:24:05,191 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.074, Train_accy 86.76
2024-09-12 20:24:27,350 [trainer.py] => No NME accuracy.
2024-09-12 20:24:27,351 [trainer.py] => CNN: {'total': 85.17, '00-49': 87.64, '50-54': 74.4, '55-59': 63.2, '60-64': 93.2, 'old': 84.5, 'new': 93.2}
2024-09-12 20:24:27,351 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17]
2024-09-12 20:24:27,351 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91]

Average Accuracy (CNN): 88.68
2024-09-12 20:24:27,351 [trainer.py] => Average Accuracy (CNN): 88.68 

2024-09-12 20:24:27,352 [trainer.py] => All params: 85848641
2024-09-12 20:24:27,352 [trainer.py] => Trainable params: 85848641
2024-09-12 20:24:27,353 [finetune.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.236, Train_accy 43.20, Test_accy 79.07:   0%|          | 0/20 [00:45<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.236, Train_accy 43.20, Test_accy 79.07:   5%|▌         | 1/20 [00:45<14:28, 45.72s/it]
Task 4, Epoch 2/20 => Loss 0.105, Train_accy 68.40:   5%|▌         | 1/20 [01:08<14:28, 45.72s/it]                 
Task 4, Epoch 2/20 => Loss 0.105, Train_accy 68.40:  10%|█         | 2/20 [01:08<09:39, 32.19s/it]
Task 4, Epoch 3/20 => Loss 0.102, Train_accy 68.48:  10%|█         | 2/20 [01:30<09:39, 32.19s/it]
Task 4, Epoch 3/20 => Loss 0.102, Train_accy 68.48:  15%|█▌        | 3/20 [01:30<07:51, 27.74s/it]
Task 4, Epoch 4/20 => Loss 0.080, Train_accy 74.52:  15%|█▌        | 3/20 [01:53<07:51, 27.74s/it]
Task 4, Epoch 4/20 => Loss 0.080, Train_accy 74.52:  20%|██        | 4/20 [01:53<06:51, 25.72s/it]
Task 4, Epoch 5/20 => Loss 0.070, Train_accy 75.68:  20%|██        | 4/20 [02:15<06:51, 25.72s/it]
Task 4, Epoch 5/20 => Loss 0.070, Train_accy 75.68:  25%|██▌       | 5/20 [02:15<06:08, 24.53s/it]
Task 4, Epoch 6/20 => Loss 0.054, Train_accy 78.64, Test_accy 80.90:  25%|██▌       | 5/20 [03:01<06:08, 24.53s/it]
Task 4, Epoch 6/20 => Loss 0.054, Train_accy 78.64, Test_accy 80.90:  30%|███       | 6/20 [03:01<07:25, 31.83s/it]
Task 4, Epoch 7/20 => Loss 0.058, Train_accy 78.92:  30%|███       | 6/20 [03:24<07:25, 31.83s/it]                 
Task 4, Epoch 7/20 => Loss 0.058, Train_accy 78.92:  35%|███▌      | 7/20 [03:24<06:13, 28.74s/it]
Task 4, Epoch 8/20 => Loss 0.065, Train_accy 79.60:  35%|███▌      | 7/20 [03:46<06:13, 28.74s/it]
Task 4, Epoch 8/20 => Loss 0.065, Train_accy 79.60:  40%|████      | 8/20 [03:46<05:21, 26.80s/it]
Task 4, Epoch 9/20 => Loss 0.055, Train_accy 79.44:  40%|████      | 8/20 [04:09<05:21, 26.80s/it]
Task 4, Epoch 9/20 => Loss 0.055, Train_accy 79.44:  45%|████▌     | 9/20 [04:09<04:39, 25.45s/it]
Task 4, Epoch 10/20 => Loss 0.052, Train_accy 81.20:  45%|████▌     | 9/20 [04:32<04:39, 25.45s/it]
Task 4, Epoch 10/20 => Loss 0.052, Train_accy 81.20:  50%|█████     | 10/20 [04:32<04:06, 24.65s/it]
Task 4, Epoch 11/20 => Loss 0.071, Train_accy 81.56, Test_accy 81.13:  50%|█████     | 10/20 [05:18<04:06, 24.65s/it]
Task 4, Epoch 11/20 => Loss 0.071, Train_accy 81.56, Test_accy 81.13:  55%|█████▌    | 11/20 [05:18<04:40, 31.19s/it]
Task 4, Epoch 12/20 => Loss 0.057, Train_accy 81.12:  55%|█████▌    | 11/20 [05:40<04:40, 31.19s/it]                 
Task 4, Epoch 12/20 => Loss 0.057, Train_accy 81.12:  60%|██████    | 12/20 [05:40<03:48, 28.58s/it]
Task 4, Epoch 13/20 => Loss 0.058, Train_accy 83.20:  60%|██████    | 12/20 [06:03<03:48, 28.58s/it]
Task 4, Epoch 13/20 => Loss 0.058, Train_accy 83.20:  65%|██████▌   | 13/20 [06:03<03:07, 26.77s/it]
Task 4, Epoch 14/20 => Loss 0.063, Train_accy 83.80:  65%|██████▌   | 13/20 [06:26<03:07, 26.77s/it]
Task 4, Epoch 14/20 => Loss 0.063, Train_accy 83.80:  70%|███████   | 14/20 [06:26<02:33, 25.53s/it]
Task 4, Epoch 15/20 => Loss 0.065, Train_accy 84.24:  70%|███████   | 14/20 [06:49<02:33, 25.53s/it]
Task 4, Epoch 15/20 => Loss 0.065, Train_accy 84.24:  75%|███████▌  | 15/20 [06:49<02:03, 24.71s/it]
Task 4, Epoch 16/20 => Loss 0.061, Train_accy 81.80, Test_accy 79.74:  75%|███████▌  | 15/20 [07:35<02:03, 24.71s/it]
Task 4, Epoch 16/20 => Loss 0.061, Train_accy 81.80, Test_accy 79.74:  80%|████████  | 16/20 [07:35<02:04, 31.12s/it]
Task 4, Epoch 17/20 => Loss 0.061, Train_accy 82.00:  80%|████████  | 16/20 [07:57<02:04, 31.12s/it]                 
Task 4, Epoch 17/20 => Loss 0.061, Train_accy 82.00:  85%|████████▌ | 17/20 [07:57<01:25, 28.62s/it]
Task 4, Epoch 18/20 => Loss 0.057, Train_accy 82.24:  85%|████████▌ | 17/20 [08:20<01:25, 28.62s/it]
Task 4, Epoch 18/20 => Loss 0.057, Train_accy 82.24:  90%|█████████ | 18/20 [08:20<00:53, 26.78s/it]
Task 4, Epoch 19/20 => Loss 0.057, Train_accy 83.68:  90%|█████████ | 18/20 [08:42<00:53, 26.78s/it]
Task 4, Epoch 19/20 => Loss 0.057, Train_accy 83.68:  95%|█████████▌| 19/20 [08:42<00:25, 25.47s/it]
Task 4, Epoch 20/20 => Loss 0.055, Train_accy 83.72:  95%|█████████▌| 19/20 [09:05<00:25, 25.47s/it]
Task 4, Epoch 20/20 => Loss 0.055, Train_accy 83.72: 100%|██████████| 20/20 [09:05<00:00, 24.62s/it]
Task 4, Epoch 20/20 => Loss 0.055, Train_accy 83.72: 100%|██████████| 20/20 [09:05<00:00, 27.27s/it]
2024-09-12 20:33:33,100 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.055, Train_accy 83.72
2024-09-12 20:33:56,641 [trainer.py] => No NME accuracy.
2024-09-12 20:33:56,641 [trainer.py] => CNN: {'total': 80.63, '00-49': 82.7, '50-54': 68.0, '55-59': 58.4, '60-64': 84.0, '65-69': 91.4, 'old': 79.8, 'new': 91.4}
2024-09-12 20:33:56,642 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17, 80.63]
2024-09-12 20:33:56,642 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91, 97.37]

Average Accuracy (CNN): 87.07
2024-09-12 20:33:56,642 [trainer.py] => Average Accuracy (CNN): 87.07 

2024-09-12 20:33:56,643 [trainer.py] => All params: 85852486
2024-09-12 20:33:56,644 [trainer.py] => Trainable params: 85852486
2024-09-12 20:33:56,646 [finetune.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.345, Train_accy 41.24, Test_accy 74.71:   0%|          | 0/20 [00:48<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.345, Train_accy 41.24, Test_accy 74.71:   5%|▌         | 1/20 [00:48<15:13, 48.06s/it]
Task 5, Epoch 2/20 => Loss 0.141, Train_accy 71.32:   5%|▌         | 1/20 [01:10<15:13, 48.06s/it]                 
Task 5, Epoch 2/20 => Loss 0.141, Train_accy 71.32:  10%|█         | 2/20 [01:10<09:54, 33.05s/it]
Task 5, Epoch 3/20 => Loss 0.137, Train_accy 73.72:  10%|█         | 2/20 [01:33<09:54, 33.05s/it]
Task 5, Epoch 3/20 => Loss 0.137, Train_accy 73.72:  15%|█▌        | 3/20 [01:33<08:00, 28.26s/it]
Task 5, Epoch 4/20 => Loss 0.110, Train_accy 75.64:  15%|█▌        | 3/20 [01:55<08:00, 28.26s/it]
Task 5, Epoch 4/20 => Loss 0.110, Train_accy 75.64:  20%|██        | 4/20 [01:55<06:56, 26.05s/it]
Task 5, Epoch 5/20 => Loss 0.076, Train_accy 81.20:  20%|██        | 4/20 [02:18<06:56, 26.05s/it]
Task 5, Epoch 5/20 => Loss 0.076, Train_accy 81.20:  25%|██▌       | 5/20 [02:18<06:11, 24.75s/it]
Task 5, Epoch 6/20 => Loss 0.098, Train_accy 80.88, Test_accy 78.20:  25%|██▌       | 5/20 [03:06<06:11, 24.75s/it]
Task 5, Epoch 6/20 => Loss 0.098, Train_accy 80.88, Test_accy 78.20:  30%|███       | 6/20 [03:06<07:37, 32.67s/it]
Task 5, Epoch 7/20 => Loss 0.095, Train_accy 82.68:  30%|███       | 6/20 [03:28<07:37, 32.67s/it]                 
Task 5, Epoch 7/20 => Loss 0.095, Train_accy 82.68:  35%|███▌      | 7/20 [03:28<06:21, 29.37s/it]
Task 5, Epoch 8/20 => Loss 0.082, Train_accy 84.48:  35%|███▌      | 7/20 [03:51<06:21, 29.37s/it]
Task 5, Epoch 8/20 => Loss 0.082, Train_accy 84.48:  40%|████      | 8/20 [03:51<05:26, 27.22s/it]
Task 5, Epoch 9/20 => Loss 0.126, Train_accy 85.00:  40%|████      | 8/20 [04:14<05:26, 27.22s/it]
Task 5, Epoch 9/20 => Loss 0.126, Train_accy 85.00:  45%|████▌     | 9/20 [04:14<04:43, 25.76s/it]
Task 5, Epoch 10/20 => Loss 0.102, Train_accy 82.24:  45%|████▌     | 9/20 [04:36<04:43, 25.76s/it]
Task 5, Epoch 10/20 => Loss 0.102, Train_accy 82.24:  50%|█████     | 10/20 [04:36<04:08, 24.81s/it]
Task 5, Epoch 11/20 => Loss 0.071, Train_accy 84.00, Test_accy 76.68:  50%|█████     | 10/20 [05:24<04:08, 24.81s/it]
Task 5, Epoch 11/20 => Loss 0.071, Train_accy 84.00, Test_accy 76.68:  55%|█████▌    | 11/20 [05:24<04:46, 31.79s/it]
Task 5, Epoch 12/20 => Loss 0.085, Train_accy 85.36:  55%|█████▌    | 11/20 [05:46<04:46, 31.79s/it]                 
Task 5, Epoch 12/20 => Loss 0.085, Train_accy 85.36:  60%|██████    | 12/20 [05:46<03:51, 28.99s/it]
Task 5, Epoch 13/20 => Loss 0.077, Train_accy 85.96:  60%|██████    | 12/20 [06:09<03:51, 28.99s/it]
Task 5, Epoch 13/20 => Loss 0.077, Train_accy 85.96:  65%|██████▌   | 13/20 [06:09<03:09, 27.07s/it]
Task 5, Epoch 14/20 => Loss 0.079, Train_accy 86.76:  65%|██████▌   | 13/20 [06:32<03:09, 27.07s/it]
Task 5, Epoch 14/20 => Loss 0.079, Train_accy 86.76:  70%|███████   | 14/20 [06:32<02:34, 25.71s/it]
Task 5, Epoch 15/20 => Loss 0.077, Train_accy 86.48:  70%|███████   | 14/20 [06:54<02:34, 25.71s/it]
Task 5, Epoch 15/20 => Loss 0.077, Train_accy 86.48:  75%|███████▌  | 15/20 [06:54<02:03, 24.76s/it]
Task 5, Epoch 16/20 => Loss 0.087, Train_accy 86.20, Test_accy 76.88:  75%|███████▌  | 15/20 [07:42<02:03, 24.76s/it]
Task 5, Epoch 16/20 => Loss 0.087, Train_accy 86.20, Test_accy 76.88:  80%|████████  | 16/20 [07:42<02:06, 31.66s/it]
Task 5, Epoch 17/20 => Loss 0.070, Train_accy 87.12:  80%|████████  | 16/20 [08:05<02:06, 31.66s/it]                 
Task 5, Epoch 17/20 => Loss 0.070, Train_accy 87.12:  85%|████████▌ | 17/20 [08:05<01:26, 28.95s/it]
Task 5, Epoch 18/20 => Loss 0.071, Train_accy 87.76:  85%|████████▌ | 17/20 [08:27<01:26, 28.95s/it]
Task 5, Epoch 18/20 => Loss 0.071, Train_accy 87.76:  90%|█████████ | 18/20 [08:27<00:54, 27.04s/it]
Task 5, Epoch 19/20 => Loss 0.074, Train_accy 88.24:  90%|█████████ | 18/20 [08:49<00:54, 27.04s/it]
Task 5, Epoch 19/20 => Loss 0.074, Train_accy 88.24:  95%|█████████▌| 19/20 [08:49<00:25, 25.63s/it]
Task 5, Epoch 20/20 => Loss 0.081, Train_accy 88.80:  95%|█████████▌| 19/20 [09:12<00:25, 25.63s/it]
Task 5, Epoch 20/20 => Loss 0.081, Train_accy 88.80: 100%|██████████| 20/20 [09:12<00:00, 24.72s/it]
Task 5, Epoch 20/20 => Loss 0.081, Train_accy 88.80: 100%|██████████| 20/20 [09:12<00:00, 27.63s/it]
2024-09-12 20:43:09,502 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.081, Train_accy 88.80
2024-09-12 20:43:34,775 [trainer.py] => No NME accuracy.
2024-09-12 20:43:34,776 [trainer.py] => CNN: {'total': 77.15, '00-49': 81.36, '50-54': 66.8, '55-59': 36.2, '60-64': 60.4, '65-69': 84.0, '70-74': 96.2, 'old': 75.79, 'new': 96.2}
2024-09-12 20:43:34,776 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17, 80.63, 77.15]
2024-09-12 20:43:34,777 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91, 97.37, 96.63]

Average Accuracy (CNN): 85.42
2024-09-12 20:43:34,777 [trainer.py] => Average Accuracy (CNN): 85.42 

2024-09-12 20:43:34,778 [trainer.py] => All params: 85856331
2024-09-12 20:43:34,780 [trainer.py] => Trainable params: 85856331
2024-09-12 20:43:34,782 [finetune.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.347, Train_accy 20.04, Test_accy 75.18:   0%|          | 0/20 [00:49<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.347, Train_accy 20.04, Test_accy 75.18:   5%|▌         | 1/20 [00:49<15:43, 49.68s/it]
Task 6, Epoch 2/20 => Loss 0.143, Train_accy 35.96:   5%|▌         | 1/20 [01:12<15:43, 49.68s/it]                 
Task 6, Epoch 2/20 => Loss 0.143, Train_accy 35.96:  10%|█         | 2/20 [01:12<10:05, 33.63s/it]
Task 6, Epoch 3/20 => Loss 0.110, Train_accy 37.16:  10%|█         | 2/20 [01:34<10:05, 33.63s/it]
Task 6, Epoch 3/20 => Loss 0.110, Train_accy 37.16:  15%|█▌        | 3/20 [01:34<08:05, 28.54s/it]
Task 6, Epoch 4/20 => Loss 0.092, Train_accy 39.28:  15%|█▌        | 3/20 [01:57<08:05, 28.54s/it]
Task 6, Epoch 4/20 => Loss 0.092, Train_accy 39.28:  20%|██        | 4/20 [01:57<07:00, 26.27s/it]
Task 6, Epoch 5/20 => Loss 0.100, Train_accy 43.24:  20%|██        | 4/20 [02:19<07:00, 26.27s/it]
Task 6, Epoch 5/20 => Loss 0.100, Train_accy 43.24:  25%|██▌       | 5/20 [02:19<06:12, 24.86s/it]
Task 6, Epoch 6/20 => Loss 0.079, Train_accy 43.56, Test_accy 74.47:  25%|██▌       | 5/20 [03:08<06:12, 24.86s/it]
Task 6, Epoch 6/20 => Loss 0.079, Train_accy 43.56, Test_accy 74.47:  30%|███       | 6/20 [03:08<07:44, 33.16s/it]
Task 6, Epoch 7/20 => Loss 0.076, Train_accy 48.08:  30%|███       | 6/20 [03:31<07:44, 33.16s/it]                 
Task 6, Epoch 7/20 => Loss 0.076, Train_accy 48.08:  35%|███▌      | 7/20 [03:31<06:25, 29.67s/it]
Task 6, Epoch 8/20 => Loss 0.075, Train_accy 48.64:  35%|███▌      | 7/20 [03:54<06:25, 29.67s/it]
Task 6, Epoch 8/20 => Loss 0.075, Train_accy 48.64:  40%|████      | 8/20 [03:54<05:29, 27.46s/it]
Task 6, Epoch 9/20 => Loss 0.082, Train_accy 48.28:  40%|████      | 8/20 [04:16<05:29, 27.46s/it]
Task 6, Epoch 9/20 => Loss 0.082, Train_accy 48.28:  45%|████▌     | 9/20 [04:16<04:44, 25.87s/it]
Task 6, Epoch 10/20 => Loss 0.100, Train_accy 43.04:  45%|████▌     | 9/20 [04:39<04:44, 25.87s/it]
Task 6, Epoch 10/20 => Loss 0.100, Train_accy 43.04:  50%|█████     | 10/20 [04:39<04:09, 24.90s/it]
Task 6, Epoch 11/20 => Loss 0.069, Train_accy 44.08, Test_accy 75.60:  50%|█████     | 10/20 [05:28<04:09, 24.90s/it]
Task 6, Epoch 11/20 => Loss 0.069, Train_accy 44.08, Test_accy 75.60:  55%|█████▌    | 11/20 [05:28<04:51, 32.41s/it]
Task 6, Epoch 12/20 => Loss 0.064, Train_accy 45.40:  55%|█████▌    | 11/20 [05:51<04:51, 32.41s/it]                 
Task 6, Epoch 12/20 => Loss 0.064, Train_accy 45.40:  60%|██████    | 12/20 [05:51<03:55, 29.48s/it]
Task 6, Epoch 13/20 => Loss 0.065, Train_accy 46.28:  60%|██████    | 12/20 [06:14<03:55, 29.48s/it]
Task 6, Epoch 13/20 => Loss 0.065, Train_accy 46.28:  65%|██████▌   | 13/20 [06:14<03:11, 27.37s/it]
Task 6, Epoch 14/20 => Loss 0.062, Train_accy 48.60:  65%|██████▌   | 13/20 [06:36<03:11, 27.37s/it]
Task 6, Epoch 14/20 => Loss 0.062, Train_accy 48.60:  70%|███████   | 14/20 [06:36<02:35, 25.93s/it]
Task 6, Epoch 15/20 => Loss 0.072, Train_accy 47.88:  70%|███████   | 14/20 [06:59<02:35, 25.93s/it]
Task 6, Epoch 15/20 => Loss 0.072, Train_accy 47.88:  75%|███████▌  | 15/20 [06:59<02:04, 24.90s/it]
Task 6, Epoch 16/20 => Loss 0.080, Train_accy 50.16, Test_accy 74.00:  75%|███████▌  | 15/20 [07:48<02:04, 24.90s/it]
Task 6, Epoch 16/20 => Loss 0.080, Train_accy 50.16, Test_accy 74.00:  80%|████████  | 16/20 [07:48<02:09, 32.26s/it]
Task 6, Epoch 17/20 => Loss 0.078, Train_accy 49.04:  80%|████████  | 16/20 [08:10<02:09, 32.26s/it]                 
Task 6, Epoch 17/20 => Loss 0.078, Train_accy 49.04:  85%|████████▌ | 17/20 [08:10<01:27, 29.28s/it]
Task 6, Epoch 18/20 => Loss 0.073, Train_accy 47.48:  85%|████████▌ | 17/20 [08:33<01:27, 29.28s/it]
Task 6, Epoch 18/20 => Loss 0.073, Train_accy 47.48:  90%|█████████ | 18/20 [08:33<00:54, 27.28s/it]
Task 6, Epoch 19/20 => Loss 0.063, Train_accy 49.72:  90%|█████████ | 18/20 [08:56<00:54, 27.28s/it]
Task 6, Epoch 19/20 => Loss 0.063, Train_accy 49.72:  95%|█████████▌| 19/20 [08:56<00:25, 25.86s/it]
Task 6, Epoch 20/20 => Loss 0.072, Train_accy 51.24:  95%|█████████▌| 19/20 [09:18<00:25, 25.86s/it]
Task 6, Epoch 20/20 => Loss 0.072, Train_accy 51.24: 100%|██████████| 20/20 [09:18<00:00, 24.85s/it]
Task 6, Epoch 20/20 => Loss 0.072, Train_accy 51.24: 100%|██████████| 20/20 [09:18<00:00, 27.93s/it]
2024-09-12 20:52:53,540 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.072, Train_accy 51.24
2024-09-12 20:53:20,679 [trainer.py] => No NME accuracy.
2024-09-12 20:53:20,679 [trainer.py] => CNN: {'total': 75.18, '00-49': 80.74, '50-54': 68.6, '55-59': 34.8, '60-64': 63.2, '65-69': 83.2, '70-74': 90.0, '75-79': 55.6, 'old': 76.48, 'new': 55.6}
2024-09-12 20:53:20,679 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17, 80.63, 77.15, 75.18]
2024-09-12 20:53:20,680 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91, 97.37, 96.63, 96.16]

Average Accuracy (CNN): 83.96
2024-09-12 20:53:20,680 [trainer.py] => Average Accuracy (CNN): 83.96 

2024-09-12 20:53:20,681 [trainer.py] => All params: 85860176
2024-09-12 20:53:20,682 [trainer.py] => Trainable params: 85860176
2024-09-12 20:53:20,684 [finetune.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.251, Train_accy 36.16, Test_accy 72.87:   0%|          | 0/20 [00:50<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.251, Train_accy 36.16, Test_accy 72.87:   5%|▌         | 1/20 [00:50<16:06, 50.85s/it]
Task 7, Epoch 2/20 => Loss 0.088, Train_accy 63.36:   5%|▌         | 1/20 [01:13<16:06, 50.85s/it]                 
Task 7, Epoch 2/20 => Loss 0.088, Train_accy 63.36:  10%|█         | 2/20 [01:13<10:15, 34.19s/it]
Task 7, Epoch 3/20 => Loss 0.089, Train_accy 62.44:  10%|█         | 2/20 [01:35<10:15, 34.19s/it]
Task 7, Epoch 3/20 => Loss 0.089, Train_accy 62.44:  15%|█▌        | 3/20 [01:35<08:10, 28.86s/it]
Task 7, Epoch 4/20 => Loss 0.122, Train_accy 62.04:  15%|█▌        | 3/20 [01:58<08:10, 28.86s/it]
Task 7, Epoch 4/20 => Loss 0.122, Train_accy 62.04:  20%|██        | 4/20 [01:58<07:02, 26.39s/it]
Task 7, Epoch 5/20 => Loss 0.098, Train_accy 62.60:  20%|██        | 4/20 [02:21<07:02, 26.39s/it]
Task 7, Epoch 5/20 => Loss 0.098, Train_accy 62.60:  25%|██▌       | 5/20 [02:21<06:15, 25.04s/it]
Task 7, Epoch 6/20 => Loss 0.072, Train_accy 65.56, Test_accy 74.54:  25%|██▌       | 5/20 [03:12<06:15, 25.04s/it]
Task 7, Epoch 6/20 => Loss 0.072, Train_accy 65.56, Test_accy 74.54:  30%|███       | 6/20 [03:12<07:54, 33.87s/it]
Task 7, Epoch 7/20 => Loss 0.066, Train_accy 69.28:  30%|███       | 6/20 [03:34<07:54, 33.87s/it]                 
Task 7, Epoch 7/20 => Loss 0.066, Train_accy 69.28:  35%|███▌      | 7/20 [03:34<06:32, 30.22s/it]
Task 7, Epoch 8/20 => Loss 0.065, Train_accy 71.08:  35%|███▌      | 7/20 [03:57<06:32, 30.22s/it]
Task 7, Epoch 8/20 => Loss 0.065, Train_accy 71.08:  40%|████      | 8/20 [03:57<05:33, 27.83s/it]
Task 7, Epoch 9/20 => Loss 0.066, Train_accy 68.64:  40%|████      | 8/20 [04:19<05:33, 27.83s/it]
Task 7, Epoch 9/20 => Loss 0.066, Train_accy 68.64:  45%|████▌     | 9/20 [04:19<04:47, 26.11s/it]
Task 7, Epoch 10/20 => Loss 0.051, Train_accy 71.12:  45%|████▌     | 9/20 [04:42<04:47, 26.11s/it]
Task 7, Epoch 10/20 => Loss 0.051, Train_accy 71.12:  50%|█████     | 10/20 [04:42<04:10, 25.03s/it]
Task 7, Epoch 11/20 => Loss 0.057, Train_accy 74.56, Test_accy 74.64:  50%|█████     | 10/20 [05:33<04:10, 25.03s/it]
Task 7, Epoch 11/20 => Loss 0.057, Train_accy 74.56, Test_accy 74.64:  55%|█████▌    | 11/20 [05:33<04:56, 32.92s/it]
Task 7, Epoch 12/20 => Loss 0.055, Train_accy 73.72:  55%|█████▌    | 11/20 [05:55<04:56, 32.92s/it]                 
Task 7, Epoch 12/20 => Loss 0.055, Train_accy 73.72:  60%|██████    | 12/20 [05:55<03:58, 29.77s/it]
Task 7, Epoch 13/20 => Loss 0.054, Train_accy 74.48:  60%|██████    | 12/20 [06:18<03:58, 29.77s/it]
Task 7, Epoch 13/20 => Loss 0.054, Train_accy 74.48:  65%|██████▌   | 13/20 [06:18<03:13, 27.58s/it]
Task 7, Epoch 14/20 => Loss 0.050, Train_accy 76.36:  65%|██████▌   | 13/20 [06:41<03:13, 27.58s/it]
Task 7, Epoch 14/20 => Loss 0.050, Train_accy 76.36:  70%|███████   | 14/20 [06:41<02:36, 26.09s/it]
Task 7, Epoch 15/20 => Loss 0.037, Train_accy 76.80:  70%|███████   | 14/20 [07:03<02:36, 26.09s/it]
Task 7, Epoch 15/20 => Loss 0.037, Train_accy 76.80:  75%|███████▌  | 15/20 [07:03<02:04, 24.98s/it]
Task 7, Epoch 16/20 => Loss 0.056, Train_accy 77.20, Test_accy 74.45:  75%|███████▌  | 15/20 [07:54<02:04, 24.98s/it]
Task 7, Epoch 16/20 => Loss 0.056, Train_accy 77.20, Test_accy 74.45:  80%|████████  | 16/20 [07:54<02:11, 32.92s/it]
Task 7, Epoch 17/20 => Loss 0.054, Train_accy 75.20:  80%|████████  | 16/20 [08:17<02:11, 32.92s/it]                 
Task 7, Epoch 17/20 => Loss 0.054, Train_accy 75.20:  85%|████████▌ | 17/20 [08:17<01:29, 29.77s/it]
Task 7, Epoch 18/20 => Loss 0.056, Train_accy 75.48:  85%|████████▌ | 17/20 [08:39<01:29, 29.77s/it]
Task 7, Epoch 18/20 => Loss 0.056, Train_accy 75.48:  90%|█████████ | 18/20 [08:39<00:55, 27.64s/it]
Task 7, Epoch 19/20 => Loss 0.046, Train_accy 78.36:  90%|█████████ | 18/20 [09:02<00:55, 27.64s/it]
Task 7, Epoch 19/20 => Loss 0.046, Train_accy 78.36:  95%|█████████▌| 19/20 [09:02<00:26, 26.12s/it]
Task 7, Epoch 20/20 => Loss 0.049, Train_accy 79.00:  95%|█████████▌| 19/20 [09:25<00:26, 26.12s/it]
Task 7, Epoch 20/20 => Loss 0.049, Train_accy 79.00: 100%|██████████| 20/20 [09:25<00:00, 25.02s/it]
Task 7, Epoch 20/20 => Loss 0.049, Train_accy 79.00: 100%|██████████| 20/20 [09:25<00:00, 28.25s/it]
2024-09-12 21:02:45,892 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.049, Train_accy 79.00
2024-09-12 21:03:14,650 [trainer.py] => No NME accuracy.
2024-09-12 21:03:14,650 [trainer.py] => CNN: {'total': 74.87, '00-49': 81.28, '50-54': 61.8, '55-59': 37.2, '60-64': 52.6, '65-69': 86.2, '70-74': 86.0, '75-79': 50.2, '80-84': 86.0, 'old': 74.18, 'new': 86.0}
2024-09-12 21:03:14,651 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17, 80.63, 77.15, 75.18, 74.87]
2024-09-12 21:03:14,651 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91, 97.37, 96.63, 96.16, 96.2]

Average Accuracy (CNN): 82.82
2024-09-12 21:03:14,651 [trainer.py] => Average Accuracy (CNN): 82.82 

2024-09-12 21:03:14,653 [trainer.py] => All params: 85864021
2024-09-12 21:03:14,654 [trainer.py] => Trainable params: 85864021
2024-09-12 21:03:14,657 [finetune.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.546, Train_accy 25.08, Test_accy 71.90:   0%|          | 0/20 [00:53<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.546, Train_accy 25.08, Test_accy 71.90:   5%|▌         | 1/20 [00:53<16:50, 53.19s/it]
Task 8, Epoch 2/20 => Loss 0.234, Train_accy 55.60:   5%|▌         | 1/20 [01:15<16:50, 53.19s/it]                 
Task 8, Epoch 2/20 => Loss 0.234, Train_accy 55.60:  10%|█         | 2/20 [01:15<10:32, 35.13s/it]
Task 8, Epoch 3/20 => Loss 0.181, Train_accy 61.08:  10%|█         | 2/20 [01:38<10:32, 35.13s/it]
Task 8, Epoch 3/20 => Loss 0.181, Train_accy 61.08:  15%|█▌        | 3/20 [01:38<08:20, 29.46s/it]
Task 8, Epoch 4/20 => Loss 0.194, Train_accy 63.24:  15%|█▌        | 3/20 [02:01<08:20, 29.46s/it]
Task 8, Epoch 4/20 => Loss 0.194, Train_accy 63.24:  20%|██        | 4/20 [02:01<07:08, 26.78s/it]
Task 8, Epoch 5/20 => Loss 0.158, Train_accy 70.32:  20%|██        | 4/20 [02:23<07:08, 26.78s/it]
Task 8, Epoch 5/20 => Loss 0.158, Train_accy 70.32:  25%|██▌       | 5/20 [02:23<06:19, 25.29s/it]
Task 8, Epoch 6/20 => Loss 0.152, Train_accy 72.52, Test_accy 74.98:  25%|██▌       | 5/20 [03:16<06:19, 25.29s/it]
Task 8, Epoch 6/20 => Loss 0.152, Train_accy 72.52, Test_accy 74.98:  30%|███       | 6/20 [03:16<08:03, 34.51s/it]
Task 8, Epoch 7/20 => Loss 0.162, Train_accy 73.56:  30%|███       | 6/20 [03:38<08:03, 34.51s/it]                 
Task 8, Epoch 7/20 => Loss 0.162, Train_accy 73.56:  35%|███▌      | 7/20 [03:38<06:36, 30.54s/it]
Task 8, Epoch 8/20 => Loss 0.164, Train_accy 72.48:  35%|███▌      | 7/20 [04:01<06:36, 30.54s/it]
Task 8, Epoch 8/20 => Loss 0.164, Train_accy 72.48:  40%|████      | 8/20 [04:01<05:36, 28.05s/it]
Task 8, Epoch 9/20 => Loss 0.148, Train_accy 75.00:  40%|████      | 8/20 [04:23<05:36, 28.05s/it]
Task 8, Epoch 9/20 => Loss 0.148, Train_accy 75.00:  45%|████▌     | 9/20 [04:23<04:49, 26.32s/it]
Task 8, Epoch 10/20 => Loss 0.147, Train_accy 76.72:  45%|████▌     | 9/20 [04:46<04:49, 26.32s/it]
Task 8, Epoch 10/20 => Loss 0.147, Train_accy 76.72:  50%|█████     | 10/20 [04:46<04:12, 25.22s/it]
Task 8, Epoch 11/20 => Loss 0.145, Train_accy 77.80, Test_accy 74.23:  50%|█████     | 10/20 [05:39<04:12, 25.22s/it]
Task 8, Epoch 11/20 => Loss 0.145, Train_accy 77.80, Test_accy 74.23:  55%|█████▌    | 11/20 [05:39<05:02, 33.62s/it]
Task 8, Epoch 12/20 => Loss 0.131, Train_accy 78.24:  55%|█████▌    | 11/20 [06:01<05:02, 33.62s/it]                 
Task 8, Epoch 12/20 => Loss 0.131, Train_accy 78.24:  60%|██████    | 12/20 [06:01<04:02, 30.26s/it]
Task 8, Epoch 13/20 => Loss 0.150, Train_accy 77.24:  60%|██████    | 12/20 [06:24<04:02, 30.26s/it]
Task 8, Epoch 13/20 => Loss 0.150, Train_accy 77.24:  65%|██████▌   | 13/20 [06:24<03:15, 27.93s/it]
Task 8, Epoch 14/20 => Loss 0.130, Train_accy 80.20:  65%|██████▌   | 13/20 [06:46<03:15, 27.93s/it]
Task 8, Epoch 14/20 => Loss 0.130, Train_accy 80.20:  70%|███████   | 14/20 [06:46<02:37, 26.32s/it]
Task 8, Epoch 15/20 => Loss 0.139, Train_accy 77.68:  70%|███████   | 14/20 [07:09<02:37, 26.32s/it]
Task 8, Epoch 15/20 => Loss 0.139, Train_accy 77.68:  75%|███████▌  | 15/20 [07:09<02:06, 25.22s/it]
Task 8, Epoch 16/20 => Loss 0.118, Train_accy 82.36, Test_accy 73.43:  75%|███████▌  | 15/20 [08:02<02:06, 25.22s/it]
Task 8, Epoch 16/20 => Loss 0.118, Train_accy 82.36, Test_accy 73.43:  80%|████████  | 16/20 [08:02<02:13, 33.48s/it]
Task 8, Epoch 17/20 => Loss 0.132, Train_accy 82.12:  80%|████████  | 16/20 [08:24<02:13, 33.48s/it]                 
Task 8, Epoch 17/20 => Loss 0.132, Train_accy 82.12:  85%|████████▌ | 17/20 [08:24<01:30, 30.25s/it]
Task 8, Epoch 18/20 => Loss 0.122, Train_accy 83.24:  85%|████████▌ | 17/20 [08:47<01:30, 30.25s/it]
Task 8, Epoch 18/20 => Loss 0.122, Train_accy 83.24:  90%|█████████ | 18/20 [08:47<00:55, 27.91s/it]
Task 8, Epoch 19/20 => Loss 0.130, Train_accy 82.76:  90%|█████████ | 18/20 [09:10<00:55, 27.91s/it]
Task 8, Epoch 19/20 => Loss 0.130, Train_accy 82.76:  95%|█████████▌| 19/20 [09:10<00:26, 26.33s/it]
Task 8, Epoch 20/20 => Loss 0.108, Train_accy 84.52:  95%|█████████▌| 19/20 [09:32<00:26, 26.33s/it]
Task 8, Epoch 20/20 => Loss 0.108, Train_accy 84.52: 100%|██████████| 20/20 [09:32<00:00, 25.16s/it]
Task 8, Epoch 20/20 => Loss 0.108, Train_accy 84.52: 100%|██████████| 20/20 [09:32<00:00, 28.63s/it]
2024-09-12 21:12:47,343 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.108, Train_accy 84.52
2024-09-12 21:13:17,694 [trainer.py] => No NME accuracy.
2024-09-12 21:13:17,695 [trainer.py] => CNN: {'total': 73.91, '00-49': 79.24, '50-54': 68.8, '55-59': 39.0, '60-64': 53.8, '65-69': 81.6, '70-74': 81.0, '75-79': 42.2, '80-84': 82.2, '85-89': 89.4, 'old': 73.0, 'new': 89.4}
2024-09-12 21:13:17,695 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17, 80.63, 77.15, 75.18, 74.87, 73.91]
2024-09-12 21:13:17,695 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91, 97.37, 96.63, 96.16, 96.2, 95.57]

Average Accuracy (CNN): 81.83
2024-09-12 21:13:17,695 [trainer.py] => Average Accuracy (CNN): 81.83 

2024-09-12 21:13:17,697 [trainer.py] => All params: 85867866
2024-09-12 21:13:17,698 [trainer.py] => Trainable params: 85867866
2024-09-12 21:13:17,700 [finetune.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.349, Train_accy 40.04, Test_accy 73.48:   0%|          | 0/20 [00:54<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.349, Train_accy 40.04, Test_accy 73.48:   5%|▌         | 1/20 [00:54<17:11, 54.29s/it]
Task 9, Epoch 2/20 => Loss 0.129, Train_accy 67.12:   5%|▌         | 1/20 [01:16<17:11, 54.29s/it]                 
Task 9, Epoch 2/20 => Loss 0.129, Train_accy 67.12:  10%|█         | 2/20 [01:16<10:41, 35.65s/it]
Task 9, Epoch 3/20 => Loss 0.113, Train_accy 70.92:  10%|█         | 2/20 [01:39<10:41, 35.65s/it]
Task 9, Epoch 3/20 => Loss 0.113, Train_accy 70.92:  15%|█▌        | 3/20 [01:39<08:23, 29.63s/it]
Task 9, Epoch 4/20 => Loss 0.097, Train_accy 73.44:  15%|█▌        | 3/20 [02:01<08:23, 29.63s/it]
Task 9, Epoch 4/20 => Loss 0.097, Train_accy 73.44:  20%|██        | 4/20 [02:01<07:09, 26.85s/it]
Task 9, Epoch 5/20 => Loss 0.083, Train_accy 73.44:  20%|██        | 4/20 [02:24<07:09, 26.85s/it]
Task 9, Epoch 5/20 => Loss 0.083, Train_accy 73.44:  25%|██▌       | 5/20 [02:24<06:19, 25.33s/it]
Task 9, Epoch 6/20 => Loss 0.080, Train_accy 76.96, Test_accy 73.22:  25%|██▌       | 5/20 [03:19<06:19, 25.33s/it]
Task 9, Epoch 6/20 => Loss 0.080, Train_accy 76.96, Test_accy 73.22:  30%|███       | 6/20 [03:19<08:13, 35.25s/it]
Task 9, Epoch 7/20 => Loss 0.089, Train_accy 78.20:  30%|███       | 6/20 [03:41<08:13, 35.25s/it]                 
Task 9, Epoch 7/20 => Loss 0.089, Train_accy 78.20:  35%|███▌      | 7/20 [03:41<06:44, 31.14s/it]
Task 9, Epoch 8/20 => Loss 0.120, Train_accy 73.24:  35%|███▌      | 7/20 [04:04<06:44, 31.14s/it]
Task 9, Epoch 8/20 => Loss 0.120, Train_accy 73.24:  40%|████      | 8/20 [04:04<05:40, 28.41s/it]
Task 9, Epoch 9/20 => Loss 0.099, Train_accy 77.92:  40%|████      | 8/20 [04:26<05:40, 28.41s/it]
Task 9, Epoch 9/20 => Loss 0.099, Train_accy 77.92:  45%|████▌     | 9/20 [04:26<04:52, 26.57s/it]
Task 9, Epoch 10/20 => Loss 0.075, Train_accy 83.44:  45%|████▌     | 9/20 [04:49<04:52, 26.57s/it]
Task 9, Epoch 10/20 => Loss 0.075, Train_accy 83.44:  50%|█████     | 10/20 [04:49<04:13, 25.37s/it]
Task 9, Epoch 11/20 => Loss 0.088, Train_accy 83.12, Test_accy 73.84:  50%|█████     | 10/20 [05:43<04:13, 25.37s/it]
Task 9, Epoch 11/20 => Loss 0.088, Train_accy 83.12, Test_accy 73.84:  55%|█████▌    | 11/20 [05:43<05:08, 34.26s/it]
Task 9, Epoch 12/20 => Loss 0.070, Train_accy 83.16:  55%|█████▌    | 11/20 [06:06<05:08, 34.26s/it]                 
Task 9, Epoch 12/20 => Loss 0.070, Train_accy 83.16:  60%|██████    | 12/20 [06:06<04:05, 30.71s/it]
Task 9, Epoch 13/20 => Loss 0.066, Train_accy 83.84:  60%|██████    | 12/20 [06:29<04:05, 30.71s/it]
Task 9, Epoch 13/20 => Loss 0.066, Train_accy 83.84:  65%|██████▌   | 13/20 [06:29<03:17, 28.26s/it]
Task 9, Epoch 14/20 => Loss 0.069, Train_accy 85.64:  65%|██████▌   | 13/20 [06:51<03:17, 28.26s/it]
Task 9, Epoch 14/20 => Loss 0.069, Train_accy 85.64:  70%|███████   | 14/20 [06:51<02:39, 26.56s/it]
Task 9, Epoch 15/20 => Loss 0.064, Train_accy 87.28:  70%|███████   | 14/20 [07:14<02:39, 26.56s/it]
Task 9, Epoch 15/20 => Loss 0.064, Train_accy 87.28:  75%|███████▌  | 15/20 [07:14<02:06, 25.40s/it]
Task 9, Epoch 16/20 => Loss 0.065, Train_accy 85.16, Test_accy 73.15:  75%|███████▌  | 15/20 [08:08<02:06, 25.40s/it]
Task 9, Epoch 16/20 => Loss 0.065, Train_accy 85.16, Test_accy 73.15:  80%|████████  | 16/20 [08:08<02:16, 34.10s/it]
Task 9, Epoch 17/20 => Loss 0.056, Train_accy 87.64:  80%|████████  | 16/20 [08:31<02:16, 34.10s/it]                 
Task 9, Epoch 17/20 => Loss 0.056, Train_accy 87.64:  85%|████████▌ | 17/20 [08:31<01:32, 30.67s/it]
Task 9, Epoch 18/20 => Loss 0.061, Train_accy 89.40:  85%|████████▌ | 17/20 [08:53<01:32, 30.67s/it]
Task 9, Epoch 18/20 => Loss 0.061, Train_accy 89.40:  90%|█████████ | 18/20 [08:53<00:56, 28.15s/it]
Task 9, Epoch 19/20 => Loss 0.067, Train_accy 88.28:  90%|█████████ | 18/20 [09:16<00:56, 28.15s/it]
Task 9, Epoch 19/20 => Loss 0.067, Train_accy 88.28:  95%|█████████▌| 19/20 [09:16<00:26, 26.48s/it]
Task 9, Epoch 20/20 => Loss 0.058, Train_accy 88.72:  95%|█████████▌| 19/20 [09:39<00:26, 26.48s/it]
Task 9, Epoch 20/20 => Loss 0.058, Train_accy 88.72: 100%|██████████| 20/20 [09:39<00:00, 25.33s/it]
Task 9, Epoch 20/20 => Loss 0.058, Train_accy 88.72: 100%|██████████| 20/20 [09:39<00:00, 28.95s/it]
2024-09-12 21:22:56,838 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.058, Train_accy 88.72
2024-09-12 21:23:28,590 [trainer.py] => No NME accuracy.
2024-09-12 21:23:28,591 [trainer.py] => CNN: {'total': 73.18, '00-49': 77.9, '50-54': 66.6, '55-59': 37.4, '60-64': 57.6, '65-69': 83.4, '70-74': 79.4, '75-79': 39.4, '80-84': 78.0, '85-89': 75.8, '90-94': 93.8, 'old': 72.03, 'new': 93.8}
2024-09-12 21:23:28,591 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17, 80.63, 77.15, 75.18, 74.87, 73.91, 73.18]
2024-09-12 21:23:28,591 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91, 97.37, 96.63, 96.16, 96.2, 95.57, 94.95]

Average Accuracy (CNN): 80.97
2024-09-12 21:23:28,591 [trainer.py] => Average Accuracy (CNN): 80.97 

2024-09-12 21:23:28,593 [trainer.py] => All params: 85871711
2024-09-12 21:23:28,593 [trainer.py] => Trainable params: 85871711
2024-09-12 21:23:28,596 [finetune.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.400, Train_accy 39.84, Test_accy 71.23:   0%|          | 0/20 [00:55<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.400, Train_accy 39.84, Test_accy 71.23:   5%|▌         | 1/20 [00:55<17:42, 55.92s/it]
Task 10, Epoch 2/20 => Loss 0.160, Train_accy 64.56:   5%|▌         | 1/20 [01:18<17:42, 55.92s/it]                 
Task 10, Epoch 2/20 => Loss 0.160, Train_accy 64.56:  10%|█         | 2/20 [01:18<10:53, 36.33s/it]
Task 10, Epoch 3/20 => Loss 0.155, Train_accy 68.88:  10%|█         | 2/20 [01:41<10:53, 36.33s/it]
Task 10, Epoch 3/20 => Loss 0.155, Train_accy 68.88:  15%|█▌        | 3/20 [01:41<08:32, 30.15s/it]
Task 10, Epoch 4/20 => Loss 0.162, Train_accy 70.52:  15%|█▌        | 3/20 [02:03<08:32, 30.15s/it]
Task 10, Epoch 4/20 => Loss 0.162, Train_accy 70.52:  20%|██        | 4/20 [02:03<07:13, 27.11s/it]
Task 10, Epoch 5/20 => Loss 0.142, Train_accy 70.56:  20%|██        | 4/20 [02:26<07:13, 27.11s/it]
Task 10, Epoch 5/20 => Loss 0.142, Train_accy 70.56:  25%|██▌       | 5/20 [02:26<06:22, 25.52s/it]
Task 10, Epoch 6/20 => Loss 0.120, Train_accy 75.64, Test_accy 72.52:  25%|██▌       | 5/20 [03:22<06:22, 25.52s/it]
Task 10, Epoch 6/20 => Loss 0.120, Train_accy 75.64, Test_accy 72.52:  30%|███       | 6/20 [03:22<08:22, 35.89s/it]
Task 10, Epoch 7/20 => Loss 0.141, Train_accy 74.72:  30%|███       | 6/20 [03:45<08:22, 35.89s/it]                 
Task 10, Epoch 7/20 => Loss 0.141, Train_accy 74.72:  35%|███▌      | 7/20 [03:45<06:50, 31.58s/it]
Task 10, Epoch 8/20 => Loss 0.159, Train_accy 75.12:  35%|███▌      | 7/20 [04:07<06:50, 31.58s/it]
Task 10, Epoch 8/20 => Loss 0.159, Train_accy 75.12:  40%|████      | 8/20 [04:07<05:44, 28.75s/it]
Task 10, Epoch 9/20 => Loss 0.111, Train_accy 76.88:  40%|████      | 8/20 [04:30<05:44, 28.75s/it]
Task 10, Epoch 9/20 => Loss 0.111, Train_accy 76.88:  45%|████▌     | 9/20 [04:30<04:54, 26.76s/it]
Task 10, Epoch 10/20 => Loss 0.111, Train_accy 79.00:  45%|████▌     | 9/20 [04:52<04:54, 26.76s/it]
Task 10, Epoch 10/20 => Loss 0.111, Train_accy 79.00:  50%|█████     | 10/20 [04:52<04:14, 25.50s/it]
Task 10, Epoch 11/20 => Loss 0.080, Train_accy 81.80, Test_accy 71.97:  50%|█████     | 10/20 [05:49<04:14, 25.50s/it]
Task 10, Epoch 11/20 => Loss 0.080, Train_accy 81.80, Test_accy 71.97:  55%|█████▌    | 11/20 [05:49<05:13, 34.86s/it]
Task 10, Epoch 12/20 => Loss 0.102, Train_accy 82.04:  55%|█████▌    | 11/20 [06:11<05:13, 34.86s/it]                 
Task 10, Epoch 12/20 => Loss 0.102, Train_accy 82.04:  60%|██████    | 12/20 [06:11<04:08, 31.11s/it]
Task 10, Epoch 13/20 => Loss 0.081, Train_accy 82.08:  60%|██████    | 12/20 [06:34<04:08, 31.11s/it]
Task 10, Epoch 13/20 => Loss 0.081, Train_accy 82.08:  65%|██████▌   | 13/20 [06:34<03:19, 28.54s/it]
Task 10, Epoch 14/20 => Loss 0.083, Train_accy 81.44:  65%|██████▌   | 13/20 [06:56<03:19, 28.54s/it]
Task 10, Epoch 14/20 => Loss 0.083, Train_accy 81.44:  70%|███████   | 14/20 [06:56<02:40, 26.74s/it]
Task 10, Epoch 15/20 => Loss 0.091, Train_accy 81.80:  70%|███████   | 14/20 [07:19<02:40, 26.74s/it]
Task 10, Epoch 15/20 => Loss 0.091, Train_accy 81.80:  75%|███████▌  | 15/20 [07:19<02:07, 25.52s/it]
Task 10, Epoch 16/20 => Loss 0.084, Train_accy 81.84, Test_accy 71.42:  75%|███████▌  | 15/20 [08:15<02:07, 25.52s/it]
Task 10, Epoch 16/20 => Loss 0.084, Train_accy 81.84, Test_accy 71.42:  80%|████████  | 16/20 [08:15<02:18, 34.69s/it]
Task 10, Epoch 17/20 => Loss 0.083, Train_accy 83.68:  80%|████████  | 16/20 [08:38<02:18, 34.69s/it]                 
Task 10, Epoch 17/20 => Loss 0.083, Train_accy 83.68:  85%|████████▌ | 17/20 [08:38<01:33, 31.10s/it]
Task 10, Epoch 18/20 => Loss 0.069, Train_accy 85.40:  85%|████████▌ | 17/20 [09:00<01:33, 31.10s/it]
Task 10, Epoch 18/20 => Loss 0.069, Train_accy 85.40:  90%|█████████ | 18/20 [09:00<00:57, 28.52s/it]
Task 10, Epoch 19/20 => Loss 0.075, Train_accy 83.96:  90%|█████████ | 18/20 [09:23<00:57, 28.52s/it]
Task 10, Epoch 19/20 => Loss 0.075, Train_accy 83.96:  95%|█████████▌| 19/20 [09:23<00:26, 26.69s/it]
Task 10, Epoch 20/20 => Loss 0.075, Train_accy 85.00:  95%|█████████▌| 19/20 [09:45<00:26, 26.69s/it]
Task 10, Epoch 20/20 => Loss 0.075, Train_accy 85.00: 100%|██████████| 20/20 [09:45<00:00, 25.51s/it]
Task 10, Epoch 20/20 => Loss 0.075, Train_accy 85.00: 100%|██████████| 20/20 [09:45<00:00, 29.29s/it]
2024-09-12 21:33:14,607 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.075, Train_accy 85.00
2024-09-12 21:33:47,882 [trainer.py] => No NME accuracy.
2024-09-12 21:33:47,883 [trainer.py] => CNN: {'total': 70.21, '00-49': 74.86, '50-54': 59.8, '55-59': 31.8, '60-64': 53.6, '65-69': 68.4, '70-74': 76.4, '75-79': 39.6, '80-84': 78.2, '85-89': 73.0, '90-94': 88.0, '95-99': 86.8, 'old': 69.34, 'new': 86.8}
2024-09-12 21:33:47,883 [trainer.py] => CNN top1 curve: [92.58, 88.67, 88.32, 85.17, 80.63, 77.15, 75.18, 74.87, 73.91, 73.18, 70.21]
2024-09-12 21:33:47,883 [trainer.py] => CNN top5 curve: [98.86, 98.69, 98.37, 97.91, 97.37, 96.63, 96.16, 96.2, 95.57, 94.95, 94.03]

Average Accuracy (CNN): 79.99
2024-09-12 21:33:47,883 [trainer.py] => Average Accuracy (CNN): 79.99 

Accuracy Matrix (CNN):
[[92.58 89.34 89.18 87.64 82.7  81.36 80.74 81.28 79.24 77.9  74.86]
 [ 0.   82.   77.2  74.4  68.   66.8  68.6  61.8  68.8  66.6  59.8 ]
 [ 0.    0.   90.8  63.2  58.4  36.2  34.8  37.2  39.   37.4  31.8 ]
 [ 0.    0.    0.   93.2  84.   60.4  63.2  52.6  53.8  57.6  53.6 ]
 [ 0.    0.    0.    0.   91.4  84.   83.2  86.2  81.6  83.4  68.4 ]
 [ 0.    0.    0.    0.    0.   96.2  90.   86.   81.   79.4  76.4 ]
 [ 0.    0.    0.    0.    0.    0.   55.6  50.2  42.2  39.4  39.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.   86.   82.2  78.   78.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   89.4  75.8  73.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   93.8  88.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   86.8 ]]
2024-09-12 21:33:47,887 [trainer.py] => Forgetting (CNN): 22.732
2024-09-12 21:34:04,528 [trainer.py] => config: ./exps/simplecil_cifar_B0_Inc5.json
2024-09-12 21:34:04,538 [trainer.py] => prefix:  
2024-09-12 21:34:04,538 [trainer.py] => dataset: cifar224
2024-09-12 21:34:04,538 [trainer.py] => memory_size: 0
2024-09-12 21:34:04,538 [trainer.py] => memory_per_class: 0
2024-09-12 21:34:04,538 [trainer.py] => fixed_memory: False
2024-09-12 21:34:04,538 [trainer.py] => shuffle: True
2024-09-12 21:34:04,538 [trainer.py] => init_cls: 20
2024-09-12 21:34:04,538 [trainer.py] => increment: 20
2024-09-12 21:34:04,538 [trainer.py] => model_name: simplecil
2024-09-12 21:34:04,538 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-12 21:34:04,538 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 21:34:04,538 [trainer.py] => seed: 1993
2024-09-12 21:34:04,538 [trainer.py] => tuned_epoch: 0
2024-09-12 21:34:04,538 [trainer.py] => init_lr: 0.01
2024-09-12 21:34:04,538 [trainer.py] => batch_size: 48
2024-09-12 21:34:04,538 [trainer.py] => weight_decay: 0.05
2024-09-12 21:34:04,538 [trainer.py] => min_lr: 1e-08
2024-09-12 21:34:04,538 [trainer.py] => optimizer: sgd
2024-09-12 21:34:04,538 [trainer.py] => vpt_type: shallow
2024-09-12 21:34:04,538 [trainer.py] => prompt_token_num: 3
2024-09-12 21:34:06,039 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 21:34:11,458 [trainer.py] => All params: 85798656
2024-09-12 21:34:11,459 [trainer.py] => Trainable params: 85798656
2024-09-12 21:34:11,908 [simplecil.py] => Learning on 0-20
2024-09-12 21:34:53,920 [trainer.py] => No NME accuracy.
2024-09-12 21:34:53,920 [trainer.py] => CNN: {'total': 88.3, '00-19': 88.3, 'old': 0, 'new': 88.3}
2024-09-12 21:34:53,920 [trainer.py] => CNN top1 curve: [88.3]
2024-09-12 21:34:53,921 [trainer.py] => CNN top5 curve: [97.85]

Average Accuracy (CNN): 88.3
2024-09-12 21:34:53,921 [trainer.py] => Average Accuracy (CNN): 88.3 

2024-09-12 21:34:53,922 [trainer.py] => All params: 85814017
2024-09-12 21:34:53,923 [trainer.py] => Trainable params: 85814017
2024-09-12 21:34:53,925 [simplecil.py] => Learning on 20-40
2024-09-12 21:35:40,530 [trainer.py] => No NME accuracy.
2024-09-12 21:35:40,531 [trainer.py] => CNN: {'total': 83.7, '00-19': 83.0, '20-39': 84.4, 'old': 83.0, 'new': 84.4}
2024-09-12 21:35:40,531 [trainer.py] => CNN top1 curve: [88.3, 83.7]
2024-09-12 21:35:40,531 [trainer.py] => CNN top5 curve: [97.85, 96.25]

Average Accuracy (CNN): 86.0
2024-09-12 21:35:40,531 [trainer.py] => Average Accuracy (CNN): 86.0 

2024-09-12 21:35:40,532 [trainer.py] => All params: 85829377
2024-09-12 21:35:40,534 [trainer.py] => Trainable params: 85829377
2024-09-12 21:35:40,536 [simplecil.py] => Learning on 40-60
2024-09-12 21:36:33,426 [trainer.py] => No NME accuracy.
2024-09-12 21:36:33,427 [trainer.py] => CNN: {'total': 80.07, '00-19': 79.5, '20-39': 80.8, '40-59': 79.9, 'old': 80.15, 'new': 79.9}
2024-09-12 21:36:33,427 [trainer.py] => CNN top1 curve: [88.3, 83.7, 80.07]
2024-09-12 21:36:33,427 [trainer.py] => CNN top5 curve: [97.85, 96.25, 94.47]

Average Accuracy (CNN): 84.02
2024-09-12 21:36:33,427 [trainer.py] => Average Accuracy (CNN): 84.02 

2024-09-12 21:36:33,428 [trainer.py] => All params: 85844737
2024-09-12 21:36:33,429 [trainer.py] => Trainable params: 85844737
2024-09-12 21:36:33,431 [simplecil.py] => Learning on 60-80
2024-09-12 21:37:32,655 [trainer.py] => No NME accuracy.
2024-09-12 21:37:32,656 [trainer.py] => CNN: {'total': 77.31, '00-19': 76.95, '20-39': 79.85, '40-59': 75.25, '60-79': 77.2, 'old': 77.35, 'new': 77.2}
2024-09-12 21:37:32,656 [trainer.py] => CNN top1 curve: [88.3, 83.7, 80.07, 77.31]
2024-09-12 21:37:32,656 [trainer.py] => CNN top5 curve: [97.85, 96.25, 94.47, 93.54]

Average Accuracy (CNN): 82.34
2024-09-12 21:37:32,656 [trainer.py] => Average Accuracy (CNN): 82.34 

2024-09-12 21:37:32,657 [trainer.py] => All params: 85860097
2024-09-12 21:37:32,659 [trainer.py] => Trainable params: 85860097
2024-09-12 21:37:32,661 [simplecil.py] => Learning on 80-100
2024-09-12 21:38:38,927 [trainer.py] => No NME accuracy.
2024-09-12 21:38:38,927 [trainer.py] => CNN: {'total': 76.21, '00-19': 75.25, '20-39': 78.35, '40-59': 72.55, '60-79': 76.2, '80-99': 78.7, 'old': 75.59, 'new': 78.7}
2024-09-12 21:38:38,928 [trainer.py] => CNN top1 curve: [88.3, 83.7, 80.07, 77.31, 76.21]
2024-09-12 21:38:38,928 [trainer.py] => CNN top5 curve: [97.85, 96.25, 94.47, 93.54, 92.54]

Average Accuracy (CNN): 81.12
2024-09-12 21:38:38,928 [trainer.py] => Average Accuracy (CNN): 81.12 

Accuracy Matrix (CNN):
[[88.3  83.   79.5  76.95 75.25]
 [ 0.   84.4  80.8  79.85 78.35]
 [ 0.    0.   79.9  75.25 72.55]
 [ 0.    0.    0.   77.2  76.2 ]
 [ 0.    0.    0.    0.   78.7 ]]
2024-09-12 21:38:38,930 [trainer.py] => Forgetting (CNN): 6.862500000000004
2024-09-12 21:38:41,925 [trainer.py] => config: ./exps/simplecil_cifar_B0_Inc10.json
2024-09-12 21:38:41,949 [trainer.py] => prefix:  
2024-09-12 21:38:41,949 [trainer.py] => dataset: cifar224
2024-09-12 21:38:41,949 [trainer.py] => memory_size: 0
2024-09-12 21:38:41,949 [trainer.py] => memory_per_class: 0
2024-09-12 21:38:41,949 [trainer.py] => fixed_memory: False
2024-09-12 21:38:41,949 [trainer.py] => shuffle: True
2024-09-12 21:38:41,949 [trainer.py] => init_cls: 10
2024-09-12 21:38:41,949 [trainer.py] => increment: 10
2024-09-12 21:38:41,949 [trainer.py] => model_name: simplecil
2024-09-12 21:38:41,949 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-12 21:38:41,950 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 21:38:41,950 [trainer.py] => seed: 1993
2024-09-12 21:38:41,950 [trainer.py] => tuned_epoch: 0
2024-09-12 21:38:41,950 [trainer.py] => init_lr: 0.01
2024-09-12 21:38:41,950 [trainer.py] => batch_size: 48
2024-09-12 21:38:41,950 [trainer.py] => weight_decay: 0.05
2024-09-12 21:38:41,950 [trainer.py] => min_lr: 1e-08
2024-09-12 21:38:41,950 [trainer.py] => optimizer: sgd
2024-09-12 21:38:41,950 [trainer.py] => vpt_type: shallow
2024-09-12 21:38:41,950 [trainer.py] => prompt_token_num: 3
2024-09-12 21:38:43,121 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 21:38:45,147 [trainer.py] => All params: 85798656
2024-09-12 21:38:45,148 [trainer.py] => Trainable params: 85798656
2024-09-12 21:38:45,667 [simplecil.py] => Learning on 0-10
2024-09-12 21:39:06,233 [trainer.py] => No NME accuracy.
2024-09-12 21:39:06,234 [trainer.py] => CNN: {'total': 92.6, '00-09': 92.6, 'old': 0, 'new': 92.6}
2024-09-12 21:39:06,234 [trainer.py] => CNN top1 curve: [92.6]
2024-09-12 21:39:06,234 [trainer.py] => CNN top5 curve: [99.3]

Average Accuracy (CNN): 92.6
2024-09-12 21:39:06,234 [trainer.py] => Average Accuracy (CNN): 92.6 

2024-09-12 21:39:06,235 [trainer.py] => All params: 85806337
2024-09-12 21:39:06,236 [trainer.py] => Trainable params: 85806337
2024-09-12 21:39:06,238 [simplecil.py] => Learning on 10-20
2024-09-12 21:39:30,622 [trainer.py] => No NME accuracy.
2024-09-12 21:39:30,623 [trainer.py] => CNN: {'total': 88.3, '00-09': 89.6, '10-19': 87.0, 'old': 89.6, 'new': 87.0}
2024-09-12 21:39:30,623 [trainer.py] => CNN top1 curve: [92.6, 88.3]
2024-09-12 21:39:30,623 [trainer.py] => CNN top5 curve: [99.3, 97.85]

Average Accuracy (CNN): 90.45
2024-09-12 21:39:30,623 [trainer.py] => Average Accuracy (CNN): 90.45 

2024-09-12 21:39:30,624 [trainer.py] => All params: 85814017
2024-09-12 21:39:30,625 [trainer.py] => Trainable params: 85814017
2024-09-12 21:39:30,627 [simplecil.py] => Learning on 20-30
2024-09-12 21:39:57,420 [trainer.py] => No NME accuracy.
2024-09-12 21:39:57,421 [trainer.py] => CNN: {'total': 86.5, '00-09': 86.3, '10-19': 84.0, '20-29': 89.2, 'old': 85.15, 'new': 89.2}
2024-09-12 21:39:57,421 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5]
2024-09-12 21:39:57,421 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1]

Average Accuracy (CNN): 89.13
2024-09-12 21:39:57,421 [trainer.py] => Average Accuracy (CNN): 89.13 

2024-09-12 21:39:57,423 [trainer.py] => All params: 85821697
2024-09-12 21:39:57,424 [trainer.py] => Trainable params: 85821697
2024-09-12 21:39:57,425 [simplecil.py] => Learning on 30-40
2024-09-12 21:40:27,405 [trainer.py] => No NME accuracy.
2024-09-12 21:40:27,406 [trainer.py] => CNN: {'total': 83.7, '00-09': 84.0, '10-19': 82.0, '20-29': 86.8, '30-39': 82.0, 'old': 84.27, 'new': 82.0}
2024-09-12 21:40:27,406 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5, 83.7]
2024-09-12 21:40:27,406 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1, 96.25]

Average Accuracy (CNN): 87.78
2024-09-12 21:40:27,406 [trainer.py] => Average Accuracy (CNN): 87.78 

2024-09-12 21:40:27,408 [trainer.py] => All params: 85829377
2024-09-12 21:40:27,409 [trainer.py] => Trainable params: 85829377
2024-09-12 21:40:27,411 [simplecil.py] => Learning on 40-50
2024-09-12 21:41:00,734 [trainer.py] => No NME accuracy.
2024-09-12 21:41:00,735 [trainer.py] => CNN: {'total': 81.82, '00-09': 82.6, '10-19': 79.4, '20-29': 85.3, '30-39': 78.5, '40-49': 83.3, 'old': 81.45, 'new': 83.3}
2024-09-12 21:41:00,735 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5, 83.7, 81.82]
2024-09-12 21:41:00,735 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1, 96.25, 95.52]

Average Accuracy (CNN): 86.58
2024-09-12 21:41:00,735 [trainer.py] => Average Accuracy (CNN): 86.58 

2024-09-12 21:41:00,737 [trainer.py] => All params: 85837057
2024-09-12 21:41:00,738 [trainer.py] => Trainable params: 85837057
2024-09-12 21:41:00,740 [simplecil.py] => Learning on 50-60
2024-09-12 21:41:37,571 [trainer.py] => No NME accuracy.
2024-09-12 21:41:37,571 [trainer.py] => CNN: {'total': 80.07, '00-09': 80.6, '10-19': 78.4, '20-29': 84.3, '30-39': 77.3, '40-49': 80.5, '50-59': 79.3, 'old': 80.22, 'new': 79.3}
2024-09-12 21:41:37,572 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5, 83.7, 81.82, 80.07]
2024-09-12 21:41:37,572 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1, 96.25, 95.52, 94.47]

Average Accuracy (CNN): 85.5
2024-09-12 21:41:37,572 [trainer.py] => Average Accuracy (CNN): 85.5 

2024-09-12 21:41:37,573 [trainer.py] => All params: 85844737
2024-09-12 21:41:37,574 [trainer.py] => Trainable params: 85844737
2024-09-12 21:41:37,576 [simplecil.py] => Learning on 60-70
2024-09-12 21:42:17,649 [trainer.py] => No NME accuracy.
2024-09-12 21:42:17,649 [trainer.py] => CNN: {'total': 79.99, '00-09': 79.1, '10-19': 77.3, '20-29': 84.3, '30-39': 77.0, '40-49': 80.2, '50-59': 76.3, '60-69': 85.7, 'old': 79.03, 'new': 85.7}
2024-09-12 21:42:17,649 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5, 83.7, 81.82, 80.07, 79.99]
2024-09-12 21:42:17,649 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1, 96.25, 95.52, 94.47, 94.36]

Average Accuracy (CNN): 84.71
2024-09-12 21:42:17,649 [trainer.py] => Average Accuracy (CNN): 84.71 

2024-09-12 21:42:17,650 [trainer.py] => All params: 85852417
2024-09-12 21:42:17,651 [trainer.py] => Trainable params: 85852417
2024-09-12 21:42:17,653 [simplecil.py] => Learning on 70-80
2024-09-12 21:43:00,738 [trainer.py] => No NME accuracy.
2024-09-12 21:43:00,738 [trainer.py] => CNN: {'total': 77.31, '00-09': 78.0, '10-19': 75.9, '20-29': 83.9, '30-39': 75.8, '40-49': 77.8, '50-59': 72.7, '60-69': 83.7, '70-79': 70.7, 'old': 78.26, 'new': 70.7}
2024-09-12 21:43:00,739 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5, 83.7, 81.82, 80.07, 79.99, 77.31]
2024-09-12 21:43:00,739 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1, 96.25, 95.52, 94.47, 94.36, 93.54]

Average Accuracy (CNN): 83.79
2024-09-12 21:43:00,739 [trainer.py] => Average Accuracy (CNN): 83.79 

2024-09-12 21:43:00,740 [trainer.py] => All params: 85860097
2024-09-12 21:43:00,741 [trainer.py] => Trainable params: 85860097
2024-09-12 21:43:00,743 [simplecil.py] => Learning on 80-90
2024-09-12 21:43:47,242 [trainer.py] => No NME accuracy.
2024-09-12 21:43:47,242 [trainer.py] => CNN: {'total': 76.59, '00-09': 77.2, '10-19': 74.5, '20-29': 82.9, '30-39': 75.1, '40-49': 75.8, '50-59': 72.2, '60-69': 83.4, '70-79': 70.1, '80-89': 78.1, 'old': 76.4, 'new': 78.1}
2024-09-12 21:43:47,243 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5, 83.7, 81.82, 80.07, 79.99, 77.31, 76.59]
2024-09-12 21:43:47,243 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1, 96.25, 95.52, 94.47, 94.36, 93.54, 92.92]

Average Accuracy (CNN): 82.99
2024-09-12 21:43:47,243 [trainer.py] => Average Accuracy (CNN): 82.99 

2024-09-12 21:43:47,244 [trainer.py] => All params: 85867777
2024-09-12 21:43:47,245 [trainer.py] => Trainable params: 85867777
2024-09-12 21:43:47,248 [simplecil.py] => Learning on 90-100
2024-09-12 21:44:37,266 [trainer.py] => No NME accuracy.
2024-09-12 21:44:37,266 [trainer.py] => CNN: {'total': 76.21, '00-09': 76.4, '10-19': 74.1, '20-29': 82.5, '30-39': 74.2, '40-49': 74.8, '50-59': 70.3, '60-69': 83.3, '70-79': 69.1, '80-89': 77.2, '90-99': 80.2, 'old': 75.77, 'new': 80.2}
2024-09-12 21:44:37,266 [trainer.py] => CNN top1 curve: [92.6, 88.3, 86.5, 83.7, 81.82, 80.07, 79.99, 77.31, 76.59, 76.21]
2024-09-12 21:44:37,266 [trainer.py] => CNN top5 curve: [99.3, 97.85, 97.1, 96.25, 95.52, 94.47, 94.36, 93.54, 92.92, 92.54]

Average Accuracy (CNN): 82.31
2024-09-12 21:44:37,267 [trainer.py] => Average Accuracy (CNN): 82.31 

Accuracy Matrix (CNN):
[[92.6 89.6 86.3 84.  82.6 80.6 79.1 78.  77.2 76.4]
 [ 0.  87.  84.  82.  79.4 78.4 77.3 75.9 74.5 74.1]
 [ 0.   0.  89.2 86.8 85.3 84.3 84.3 83.9 82.9 82.5]
 [ 0.   0.   0.  82.  78.5 77.3 77.  75.8 75.1 74.2]
 [ 0.   0.   0.   0.  83.3 80.5 80.2 77.8 75.8 74.8]
 [ 0.   0.   0.   0.   0.  79.3 76.3 72.7 72.2 70.3]
 [ 0.   0.   0.   0.   0.   0.  85.7 83.7 83.4 83.3]
 [ 0.   0.   0.   0.   0.   0.   0.  70.7 70.1 69.1]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  78.1 77.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  80.2]]
2024-09-12 21:44:37,268 [trainer.py] => Forgetting (CNN): 7.333333333333333
2024-09-12 21:44:40,361 [trainer.py] => config: ./exps/simplecil_cifar_B0_Inc20.json
2024-09-12 21:44:40,361 [trainer.py] => prefix:  
2024-09-12 21:44:40,361 [trainer.py] => dataset: cifar224
2024-09-12 21:44:40,361 [trainer.py] => memory_size: 0
2024-09-12 21:44:40,361 [trainer.py] => memory_per_class: 0
2024-09-12 21:44:40,361 [trainer.py] => fixed_memory: False
2024-09-12 21:44:40,361 [trainer.py] => shuffle: True
2024-09-12 21:44:40,362 [trainer.py] => init_cls: 5
2024-09-12 21:44:40,362 [trainer.py] => increment: 5
2024-09-12 21:44:40,362 [trainer.py] => model_name: simplecil
2024-09-12 21:44:40,362 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-12 21:44:40,362 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 21:44:40,362 [trainer.py] => seed: 1993
2024-09-12 21:44:40,362 [trainer.py] => tuned_epoch: 0
2024-09-12 21:44:40,362 [trainer.py] => init_lr: 0.01
2024-09-12 21:44:40,362 [trainer.py] => batch_size: 48
2024-09-12 21:44:40,362 [trainer.py] => weight_decay: 0.05
2024-09-12 21:44:40,362 [trainer.py] => min_lr: 1e-08
2024-09-12 21:44:40,362 [trainer.py] => optimizer: sgd
2024-09-12 21:44:40,363 [trainer.py] => vpt_type: shallow
2024-09-12 21:44:40,363 [trainer.py] => prompt_token_num: 3
2024-09-12 21:44:41,512 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 21:44:44,455 [trainer.py] => All params: 85798656
2024-09-12 21:44:44,455 [trainer.py] => Trainable params: 85798656
2024-09-12 21:44:44,841 [simplecil.py] => Learning on 0-5
2024-09-12 21:44:55,692 [trainer.py] => No NME accuracy.
2024-09-12 21:44:55,693 [trainer.py] => CNN: {'total': 96.4, '00-04': 96.4, 'old': 0, 'new': 96.4}
2024-09-12 21:44:55,693 [trainer.py] => CNN top1 curve: [96.4]
2024-09-12 21:44:55,693 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 96.4
2024-09-12 21:44:55,693 [trainer.py] => Average Accuracy (CNN): 96.4 

2024-09-12 21:44:55,694 [trainer.py] => All params: 85802497
2024-09-12 21:44:55,695 [trainer.py] => Trainable params: 85802497
2024-09-12 21:44:55,697 [simplecil.py] => Learning on 5-10
2024-09-12 21:45:08,228 [trainer.py] => No NME accuracy.
2024-09-12 21:45:08,229 [trainer.py] => CNN: {'total': 92.6, '00-04': 92.4, '05-09': 92.8, 'old': 92.4, 'new': 92.8}
2024-09-12 21:45:08,229 [trainer.py] => CNN top1 curve: [96.4, 92.6]
2024-09-12 21:45:08,229 [trainer.py] => CNN top5 curve: [100.0, 99.3]

Average Accuracy (CNN): 94.5
2024-09-12 21:45:08,229 [trainer.py] => Average Accuracy (CNN): 94.5 

2024-09-12 21:45:08,230 [trainer.py] => All params: 85806337
2024-09-12 21:45:08,230 [trainer.py] => Trainable params: 85806337
2024-09-12 21:45:08,231 [simplecil.py] => Learning on 10-15
2024-09-12 21:45:22,131 [trainer.py] => No NME accuracy.
2024-09-12 21:45:22,132 [trainer.py] => CNN: {'total': 90.13, '00-04': 91.8, '05-09': 88.4, '10-14': 90.2, 'old': 90.1, 'new': 90.2}
2024-09-12 21:45:22,132 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13]
2024-09-12 21:45:22,132 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87]

Average Accuracy (CNN): 93.04
2024-09-12 21:45:22,132 [trainer.py] => Average Accuracy (CNN): 93.04 

2024-09-12 21:45:22,133 [trainer.py] => All params: 85810177
2024-09-12 21:45:22,134 [trainer.py] => Trainable params: 85810177
2024-09-12 21:45:22,136 [simplecil.py] => Learning on 15-20
2024-09-12 21:45:37,654 [trainer.py] => No NME accuracy.
2024-09-12 21:45:37,654 [trainer.py] => CNN: {'total': 88.3, '00-04': 91.8, '05-09': 87.4, '10-14': 89.4, '15-19': 84.6, 'old': 89.53, 'new': 84.6}
2024-09-12 21:45:37,654 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3]
2024-09-12 21:45:37,654 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85]

Average Accuracy (CNN): 91.86
2024-09-12 21:45:37,654 [trainer.py] => Average Accuracy (CNN): 91.86 

2024-09-12 21:45:37,656 [trainer.py] => All params: 85814017
2024-09-12 21:45:37,657 [trainer.py] => Trainable params: 85814017
2024-09-12 21:45:37,659 [simplecil.py] => Learning on 20-25
2024-09-12 21:45:54,780 [trainer.py] => No NME accuracy.
2024-09-12 21:45:54,780 [trainer.py] => CNN: {'total': 87.24, '00-04': 91.6, '05-09': 86.8, '10-14': 86.2, '15-19': 83.8, '20-24': 87.8, 'old': 87.1, 'new': 87.8}
2024-09-12 21:45:54,780 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24]
2024-09-12 21:45:54,780 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36]

Average Accuracy (CNN): 90.93
2024-09-12 21:45:54,780 [trainer.py] => Average Accuracy (CNN): 90.93 

2024-09-12 21:45:54,782 [trainer.py] => All params: 85817857
2024-09-12 21:45:54,783 [trainer.py] => Trainable params: 85817857
2024-09-12 21:45:54,784 [simplecil.py] => Learning on 25-30
2024-09-12 21:46:13,918 [trainer.py] => No NME accuracy.
2024-09-12 21:46:13,918 [trainer.py] => CNN: {'total': 86.5, '00-04': 91.0, '05-09': 81.6, '10-14': 84.8, '15-19': 83.2, '20-24': 87.4, '25-29': 91.0, 'old': 85.6, 'new': 91.0}
2024-09-12 21:46:13,918 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5]
2024-09-12 21:46:13,918 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1]

Average Accuracy (CNN): 90.2
2024-09-12 21:46:13,918 [trainer.py] => Average Accuracy (CNN): 90.2 

2024-09-12 21:46:13,920 [trainer.py] => All params: 85821697
2024-09-12 21:46:13,921 [trainer.py] => Trainable params: 85821697
2024-09-12 21:46:13,923 [simplecil.py] => Learning on 30-35
2024-09-12 21:46:34,117 [trainer.py] => No NME accuracy.
2024-09-12 21:46:34,117 [trainer.py] => CNN: {'total': 84.26, '00-04': 90.2, '05-09': 79.6, '10-14': 84.4, '15-19': 82.4, '20-24': 86.4, '25-29': 90.2, '30-34': 76.6, 'old': 85.53, 'new': 76.6}
2024-09-12 21:46:34,117 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26]
2024-09-12 21:46:34,117 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91]

Average Accuracy (CNN): 89.35
2024-09-12 21:46:34,117 [trainer.py] => Average Accuracy (CNN): 89.35 

2024-09-12 21:46:34,118 [trainer.py] => All params: 85825537
2024-09-12 21:46:34,119 [trainer.py] => Trainable params: 85825537
2024-09-12 21:46:34,121 [simplecil.py] => Learning on 35-40
2024-09-12 21:46:56,593 [trainer.py] => No NME accuracy.
2024-09-12 21:46:56,593 [trainer.py] => CNN: {'total': 83.7, '00-04': 88.6, '05-09': 79.4, '10-14': 83.6, '15-19': 80.4, '20-24': 85.4, '25-29': 88.2, '30-34': 75.8, '35-39': 88.2, 'old': 83.06, 'new': 88.2}
2024-09-12 21:46:56,593 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7]
2024-09-12 21:46:56,594 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25]

Average Accuracy (CNN): 88.64
2024-09-12 21:46:56,594 [trainer.py] => Average Accuracy (CNN): 88.64 

2024-09-12 21:46:56,595 [trainer.py] => All params: 85829377
2024-09-12 21:46:56,596 [trainer.py] => Trainable params: 85829377
2024-09-12 21:46:56,598 [simplecil.py] => Learning on 40-45
2024-09-12 21:47:20,181 [trainer.py] => No NME accuracy.
2024-09-12 21:47:20,181 [trainer.py] => CNN: {'total': 82.76, '00-04': 87.8, '05-09': 79.2, '10-14': 80.6, '15-19': 79.8, '20-24': 84.6, '25-29': 88.0, '30-34': 75.6, '35-39': 87.4, '40-44': 81.8, 'old': 82.88, 'new': 81.8}
2024-09-12 21:47:20,181 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76]
2024-09-12 21:47:20,182 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82]

Average Accuracy (CNN): 87.99
2024-09-12 21:47:20,182 [trainer.py] => Average Accuracy (CNN): 87.99 

2024-09-12 21:47:20,183 [trainer.py] => All params: 85833217
2024-09-12 21:47:20,185 [trainer.py] => Trainable params: 85833217
2024-09-12 21:47:20,187 [simplecil.py] => Learning on 45-50
2024-09-12 21:47:46,251 [trainer.py] => No NME accuracy.
2024-09-12 21:47:46,251 [trainer.py] => CNN: {'total': 81.82, '00-04': 87.8, '05-09': 77.4, '10-14': 79.2, '15-19': 79.6, '20-24': 83.8, '25-29': 86.8, '30-34': 75.2, '35-39': 81.8, '40-44': 80.8, '45-49': 85.8, 'old': 81.38, 'new': 85.8}
2024-09-12 21:47:46,251 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82]
2024-09-12 21:47:46,252 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52]

Average Accuracy (CNN): 87.37
2024-09-12 21:47:46,252 [trainer.py] => Average Accuracy (CNN): 87.37 

2024-09-12 21:47:46,253 [trainer.py] => All params: 85837057
2024-09-12 21:47:46,255 [trainer.py] => Trainable params: 85837057
2024-09-12 21:47:46,257 [simplecil.py] => Learning on 50-55
2024-09-12 21:48:13,223 [trainer.py] => No NME accuracy.
2024-09-12 21:48:13,223 [trainer.py] => CNN: {'total': 80.15, '00-04': 84.8, '05-09': 77.0, '10-14': 78.6, '15-19': 79.6, '20-24': 83.4, '25-29': 85.6, '30-34': 74.6, '35-39': 80.4, '40-44': 78.4, '45-49': 82.6, '50-54': 76.6, 'old': 80.5, 'new': 76.6}
2024-09-12 21:48:13,224 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15]
2024-09-12 21:48:13,224 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87]

Average Accuracy (CNN): 86.71
2024-09-12 21:48:13,224 [trainer.py] => Average Accuracy (CNN): 86.71 

2024-09-12 21:48:13,225 [trainer.py] => All params: 85840897
2024-09-12 21:48:13,226 [trainer.py] => Trainable params: 85840897
2024-09-12 21:48:13,227 [simplecil.py] => Learning on 55-60
2024-09-12 21:48:42,008 [trainer.py] => No NME accuracy.
2024-09-12 21:48:42,008 [trainer.py] => CNN: {'total': 80.07, '00-04': 84.8, '05-09': 76.4, '10-14': 77.8, '15-19': 79.0, '20-24': 83.4, '25-29': 85.2, '30-34': 74.2, '35-39': 80.4, '40-44': 78.4, '45-49': 82.6, '50-54': 76.6, '55-59': 82.0, 'old': 79.89, 'new': 82.0}
2024-09-12 21:48:42,008 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07]
2024-09-12 21:48:42,009 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47]

Average Accuracy (CNN): 86.16
2024-09-12 21:48:42,009 [trainer.py] => Average Accuracy (CNN): 86.16 

2024-09-12 21:48:42,010 [trainer.py] => All params: 85844737
2024-09-12 21:48:42,011 [trainer.py] => Trainable params: 85844737
2024-09-12 21:48:42,013 [simplecil.py] => Learning on 60-65
2024-09-12 21:49:12,061 [trainer.py] => No NME accuracy.
2024-09-12 21:49:12,061 [trainer.py] => CNN: {'total': 79.6, '00-04': 84.6, '05-09': 76.2, '10-14': 76.6, '15-19': 79.0, '20-24': 83.4, '25-29': 85.2, '30-34': 74.0, '35-39': 80.4, '40-44': 78.2, '45-49': 82.4, '50-54': 76.2, '55-59': 77.0, '60-64': 81.6, 'old': 79.43, 'new': 81.6}
2024-09-12 21:49:12,061 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6]
2024-09-12 21:49:12,061 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31]

Average Accuracy (CNN): 85.66
2024-09-12 21:49:12,062 [trainer.py] => Average Accuracy (CNN): 85.66 

2024-09-12 21:49:12,062 [trainer.py] => All params: 85848577
2024-09-12 21:49:12,063 [trainer.py] => Trainable params: 85848577
2024-09-12 21:49:12,065 [simplecil.py] => Learning on 65-70
2024-09-12 21:49:43,998 [trainer.py] => No NME accuracy.
2024-09-12 21:49:43,998 [trainer.py] => CNN: {'total': 79.99, '00-04': 82.2, '05-09': 76.0, '10-14': 75.8, '15-19': 78.8, '20-24': 83.4, '25-29': 85.2, '30-34': 73.8, '35-39': 80.2, '40-44': 78.2, '45-49': 82.2, '50-54': 76.2, '55-59': 76.4, '60-64': 81.0, '65-69': 90.4, 'old': 79.18, 'new': 90.4}
2024-09-12 21:49:43,998 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6, 79.99]
2024-09-12 21:49:43,998 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31, 94.36]

Average Accuracy (CNN): 85.25
2024-09-12 21:49:43,999 [trainer.py] => Average Accuracy (CNN): 85.25 

2024-09-12 21:49:43,999 [trainer.py] => All params: 85852417
2024-09-12 21:49:44,000 [trainer.py] => Trainable params: 85852417
2024-09-12 21:49:44,002 [simplecil.py] => Learning on 70-75
2024-09-12 21:50:17,296 [trainer.py] => No NME accuracy.
2024-09-12 21:50:17,297 [trainer.py] => CNN: {'total': 78.53, '00-04': 82.0, '05-09': 75.0, '10-14': 74.2, '15-19': 78.0, '20-24': 83.4, '25-29': 85.2, '30-34': 73.4, '35-39': 79.2, '40-44': 77.4, '45-49': 82.0, '50-54': 75.4, '55-59': 74.4, '60-64': 78.6, '65-69': 90.0, '70-74': 69.8, 'old': 79.16, 'new': 69.8}
2024-09-12 21:50:17,297 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6, 79.99, 78.53]
2024-09-12 21:50:17,297 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31, 94.36, 93.85]

Average Accuracy (CNN): 84.8
2024-09-12 21:50:17,297 [trainer.py] => Average Accuracy (CNN): 84.8 

2024-09-12 21:50:17,299 [trainer.py] => All params: 85856257
2024-09-12 21:50:17,300 [trainer.py] => Trainable params: 85856257
2024-09-12 21:50:17,302 [simplecil.py] => Learning on 75-80
2024-09-12 21:50:52,330 [trainer.py] => No NME accuracy.
2024-09-12 21:50:52,330 [trainer.py] => CNN: {'total': 77.31, '00-04': 81.8, '05-09': 74.2, '10-14': 73.8, '15-19': 78.0, '20-24': 82.6, '25-29': 85.2, '30-34': 73.4, '35-39': 78.2, '40-44': 76.8, '45-49': 78.8, '50-54': 72.2, '55-59': 73.2, '60-64': 78.0, '65-69': 89.4, '70-74': 68.4, '75-79': 73.0, 'old': 77.6, 'new': 73.0}
2024-09-12 21:50:52,330 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31]
2024-09-12 21:50:52,330 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54]

Average Accuracy (CNN): 84.34
2024-09-12 21:50:52,330 [trainer.py] => Average Accuracy (CNN): 84.34 

2024-09-12 21:50:52,331 [trainer.py] => All params: 85860097
2024-09-12 21:50:52,332 [trainer.py] => Trainable params: 85860097
2024-09-12 21:50:52,334 [simplecil.py] => Learning on 80-85
2024-09-12 21:51:29,096 [trainer.py] => No NME accuracy.
2024-09-12 21:51:29,097 [trainer.py] => CNN: {'total': 76.98, '00-04': 81.8, '05-09': 73.6, '10-14': 72.6, '15-19': 78.0, '20-24': 82.2, '25-29': 83.6, '30-34': 72.4, '35-39': 78.0, '40-44': 76.4, '45-49': 75.4, '50-54': 71.8, '55-59': 73.2, '60-64': 77.4, '65-69': 89.4, '70-74': 68.4, '75-79': 73.0, '80-84': 81.4, 'old': 76.7, 'new': 81.4}
2024-09-12 21:51:29,097 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98]
2024-09-12 21:51:29,097 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47]

Average Accuracy (CNN): 83.9
2024-09-12 21:51:29,097 [trainer.py] => Average Accuracy (CNN): 83.9 

2024-09-12 21:51:29,098 [trainer.py] => All params: 85863937
2024-09-12 21:51:29,099 [trainer.py] => Trainable params: 85863937
2024-09-12 21:51:29,101 [simplecil.py] => Learning on 85-90
2024-09-12 21:52:07,802 [trainer.py] => No NME accuracy.
2024-09-12 21:52:07,802 [trainer.py] => CNN: {'total': 76.59, '00-04': 81.8, '05-09': 72.6, '10-14': 71.2, '15-19': 77.8, '20-24': 82.2, '25-29': 83.6, '30-34': 72.2, '35-39': 78.0, '40-44': 76.4, '45-49': 75.2, '50-54': 71.6, '55-59': 72.8, '60-64': 77.4, '65-69': 89.4, '70-74': 68.2, '75-79': 72.0, '80-84': 81.4, '85-89': 74.8, 'old': 76.69, 'new': 74.8}
2024-09-12 21:52:07,803 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98, 76.59]
2024-09-12 21:52:07,803 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47, 92.92]

Average Accuracy (CNN): 83.5
2024-09-12 21:52:07,803 [trainer.py] => Average Accuracy (CNN): 83.5 

2024-09-12 21:52:07,804 [trainer.py] => All params: 85867777
2024-09-12 21:52:07,805 [trainer.py] => Trainable params: 85867777
2024-09-12 21:52:07,808 [simplecil.py] => Learning on 90-95
2024-09-12 21:52:47,539 [trainer.py] => No NME accuracy.
2024-09-12 21:52:47,540 [trainer.py] => CNN: {'total': 76.72, '00-04': 81.6, '05-09': 72.0, '10-14': 71.2, '15-19': 77.6, '20-24': 81.8, '25-29': 83.6, '30-34': 71.6, '35-39': 78.0, '40-44': 75.0, '45-49': 75.0, '50-54': 70.0, '55-59': 72.8, '60-64': 77.2, '65-69': 89.4, '70-74': 68.0, '75-79': 70.6, '80-84': 81.4, '85-89': 74.6, '90-94': 86.2, 'old': 76.19, 'new': 86.2}
2024-09-12 21:52:47,540 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98, 76.59, 76.72]
2024-09-12 21:52:47,540 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47, 92.92, 92.88]

Average Accuracy (CNN): 83.14
2024-09-12 21:52:47,540 [trainer.py] => Average Accuracy (CNN): 83.14 

2024-09-12 21:52:47,542 [trainer.py] => All params: 85871617
2024-09-12 21:52:47,544 [trainer.py] => Trainable params: 85871617
2024-09-12 21:52:47,546 [simplecil.py] => Learning on 95-100
2024-09-12 21:53:29,213 [trainer.py] => No NME accuracy.
2024-09-12 21:53:29,213 [trainer.py] => CNN: {'total': 76.21, '00-04': 81.2, '05-09': 71.6, '10-14': 70.6, '15-19': 77.6, '20-24': 81.6, '25-29': 83.4, '30-34': 71.6, '35-39': 76.8, '40-44': 74.8, '45-49': 74.8, '50-54': 67.8, '55-59': 72.8, '60-64': 77.2, '65-69': 89.4, '70-74': 67.6, '75-79': 70.6, '80-84': 81.4, '85-89': 73.0, '90-94': 84.6, '95-99': 75.8, 'old': 76.23, 'new': 75.8}
2024-09-12 21:53:29,213 [trainer.py] => CNN top1 curve: [96.4, 92.6, 90.13, 88.3, 87.24, 86.5, 84.26, 83.7, 82.76, 81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98, 76.59, 76.72, 76.21]
2024-09-12 21:53:29,214 [trainer.py] => CNN top5 curve: [100.0, 99.3, 98.87, 97.85, 97.36, 97.1, 96.91, 96.25, 95.82, 95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47, 92.92, 92.88, 92.54]

Average Accuracy (CNN): 82.79
2024-09-12 21:53:29,214 [trainer.py] => Average Accuracy (CNN): 82.79 

Accuracy Matrix (CNN):
[[96.4 92.4 91.8 91.8 91.6 91.  90.2 88.6 87.8 87.8 84.8 84.8 84.6 82.2
  82.  81.8 81.8 81.8 81.6 81.2]
 [ 0.  92.8 88.4 87.4 86.8 81.6 79.6 79.4 79.2 77.4 77.  76.4 76.2 76.
  75.  74.2 73.6 72.6 72.  71.6]
 [ 0.   0.  90.2 89.4 86.2 84.8 84.4 83.6 80.6 79.2 78.6 77.8 76.6 75.8
  74.2 73.8 72.6 71.2 71.2 70.6]
 [ 0.   0.   0.  84.6 83.8 83.2 82.4 80.4 79.8 79.6 79.6 79.  79.  78.8
  78.  78.  78.  77.8 77.6 77.6]
 [ 0.   0.   0.   0.  87.8 87.4 86.4 85.4 84.6 83.8 83.4 83.4 83.4 83.4
  83.4 82.6 82.2 82.2 81.8 81.6]
 [ 0.   0.   0.   0.   0.  91.  90.2 88.2 88.  86.8 85.6 85.2 85.2 85.2
  85.2 85.2 83.6 83.6 83.6 83.4]
 [ 0.   0.   0.   0.   0.   0.  76.6 75.8 75.6 75.2 74.6 74.2 74.  73.8
  73.4 73.4 72.4 72.2 71.6 71.6]
 [ 0.   0.   0.   0.   0.   0.   0.  88.2 87.4 81.8 80.4 80.4 80.4 80.2
  79.2 78.2 78.  78.  78.  76.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  81.8 80.8 78.4 78.4 78.2 78.2
  77.4 76.8 76.4 76.4 75.  74.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  85.8 82.6 82.6 82.4 82.2
  82.  78.8 75.4 75.2 75.  74.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  76.6 76.6 76.2 76.2
  75.4 72.2 71.8 71.6 70.  67.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  82.  77.  76.4
  74.4 73.2 73.2 72.8 72.8 72.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  81.6 81.
  78.6 78.  77.4 77.4 77.2 77.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  90.4
  90.  89.4 89.4 89.4 89.4 89.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  69.8 68.4 68.4 68.2 68.  67.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  73.  73.  72.  70.6 70.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  81.4 81.4 81.4 81.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  74.8 74.6 73. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  86.2 84.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  75.8]]
2024-09-12 21:53:29,219 [trainer.py] => Forgetting (CNN): 7.505263157894738
2024-09-12 21:53:32,262 [trainer.py] => config: ./exps/simplecil_cifar_B50_Inc5.json
2024-09-12 21:53:32,277 [trainer.py] => prefix:  
2024-09-12 21:53:32,277 [trainer.py] => dataset: cifar224
2024-09-12 21:53:32,277 [trainer.py] => memory_size: 0
2024-09-12 21:53:32,277 [trainer.py] => memory_per_class: 0
2024-09-12 21:53:32,277 [trainer.py] => fixed_memory: False
2024-09-12 21:53:32,277 [trainer.py] => shuffle: True
2024-09-12 21:53:32,277 [trainer.py] => init_cls: 50
2024-09-12 21:53:32,277 [trainer.py] => increment: 10
2024-09-12 21:53:32,277 [trainer.py] => model_name: simplecil
2024-09-12 21:53:32,277 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-12 21:53:32,277 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 21:53:32,277 [trainer.py] => seed: 1993
2024-09-12 21:53:32,277 [trainer.py] => tuned_epoch: 0
2024-09-12 21:53:32,277 [trainer.py] => init_lr: 0.01
2024-09-12 21:53:32,277 [trainer.py] => batch_size: 48
2024-09-12 21:53:32,277 [trainer.py] => weight_decay: 0.05
2024-09-12 21:53:32,277 [trainer.py] => min_lr: 1e-08
2024-09-12 21:53:32,277 [trainer.py] => optimizer: sgd
2024-09-12 21:53:32,277 [trainer.py] => vpt_type: shallow
2024-09-12 21:53:32,277 [trainer.py] => prompt_token_num: 3
2024-09-12 21:53:33,496 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 21:53:35,807 [trainer.py] => All params: 85798656
2024-09-12 21:53:35,808 [trainer.py] => Trainable params: 85798656
2024-09-12 21:53:36,246 [simplecil.py] => Learning on 0-50
2024-09-12 21:55:13,933 [trainer.py] => No NME accuracy.
2024-09-12 21:55:13,933 [trainer.py] => CNN: {'total': 81.82, '00-49': 81.82, 'old': 0, 'new': 81.82}
2024-09-12 21:55:13,933 [trainer.py] => CNN top1 curve: [81.82]
2024-09-12 21:55:13,933 [trainer.py] => CNN top5 curve: [95.52]

Average Accuracy (CNN): 81.82
2024-09-12 21:55:13,934 [trainer.py] => Average Accuracy (CNN): 81.82 

2024-09-12 21:55:13,936 [trainer.py] => All params: 85837057
2024-09-12 21:55:13,937 [trainer.py] => Trainable params: 85837057
2024-09-12 21:55:13,941 [simplecil.py] => Learning on 50-60
2024-09-12 21:55:50,520 [trainer.py] => No NME accuracy.
2024-09-12 21:55:50,521 [trainer.py] => CNN: {'total': 80.07, '00-49': 80.22, '50-59': 79.3, 'old': 80.22, 'new': 79.3}
2024-09-12 21:55:50,521 [trainer.py] => CNN top1 curve: [81.82, 80.07]
2024-09-12 21:55:50,521 [trainer.py] => CNN top5 curve: [95.52, 94.47]

Average Accuracy (CNN): 80.94
2024-09-12 21:55:50,521 [trainer.py] => Average Accuracy (CNN): 80.94 

2024-09-12 21:55:50,522 [trainer.py] => All params: 85844737
2024-09-12 21:55:50,523 [trainer.py] => Trainable params: 85844737
2024-09-12 21:55:50,525 [simplecil.py] => Learning on 60-70
2024-09-12 21:56:30,364 [trainer.py] => No NME accuracy.
2024-09-12 21:56:30,364 [trainer.py] => CNN: {'total': 79.99, '00-49': 79.58, '50-59': 76.3, '60-69': 85.7, 'old': 79.03, 'new': 85.7}
2024-09-12 21:56:30,364 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99]
2024-09-12 21:56:30,364 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36]

Average Accuracy (CNN): 80.63
2024-09-12 21:56:30,364 [trainer.py] => Average Accuracy (CNN): 80.63 

2024-09-12 21:56:30,365 [trainer.py] => All params: 85852417
2024-09-12 21:56:30,366 [trainer.py] => Trainable params: 85852417
2024-09-12 21:56:30,368 [simplecil.py] => Learning on 70-80
2024-09-12 21:57:13,377 [trainer.py] => No NME accuracy.
2024-09-12 21:57:13,377 [trainer.py] => CNN: {'total': 77.31, '00-49': 78.28, '50-59': 72.7, '60-69': 83.7, '70-79': 70.7, 'old': 78.26, 'new': 70.7}
2024-09-12 21:57:13,377 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31]
2024-09-12 21:57:13,377 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54]

Average Accuracy (CNN): 79.8
2024-09-12 21:57:13,377 [trainer.py] => Average Accuracy (CNN): 79.8 

2024-09-12 21:57:13,379 [trainer.py] => All params: 85860097
2024-09-12 21:57:13,380 [trainer.py] => Trainable params: 85860097
2024-09-12 21:57:13,382 [simplecil.py] => Learning on 80-90
2024-09-12 21:57:59,957 [trainer.py] => No NME accuracy.
2024-09-12 21:57:59,957 [trainer.py] => CNN: {'total': 76.59, '00-49': 77.1, '50-59': 72.2, '60-69': 83.4, '70-79': 70.1, '80-89': 78.1, 'old': 76.4, 'new': 78.1}
2024-09-12 21:57:59,958 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31, 76.59]
2024-09-12 21:57:59,958 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54, 92.92]

Average Accuracy (CNN): 79.16
2024-09-12 21:57:59,958 [trainer.py] => Average Accuracy (CNN): 79.16 

2024-09-12 21:57:59,959 [trainer.py] => All params: 85867777
2024-09-12 21:57:59,960 [trainer.py] => Trainable params: 85867777
2024-09-12 21:57:59,962 [simplecil.py] => Learning on 90-100
2024-09-12 21:58:49,832 [trainer.py] => No NME accuracy.
2024-09-12 21:58:49,832 [trainer.py] => CNN: {'total': 76.21, '00-49': 76.4, '50-59': 70.3, '60-69': 83.3, '70-79': 69.1, '80-89': 77.2, '90-99': 80.2, 'old': 75.77, 'new': 80.2}
2024-09-12 21:58:49,832 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31, 76.59, 76.21]
2024-09-12 21:58:49,832 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54, 92.92, 92.54]

Average Accuracy (CNN): 78.66
2024-09-12 21:58:49,832 [trainer.py] => Average Accuracy (CNN): 78.66 

Accuracy Matrix (CNN):
[[81.82 80.22 79.58 78.28 77.1  76.4 ]
 [ 0.   79.3  76.3  72.7  72.2  70.3 ]
 [ 0.    0.   85.7  83.7  83.4  83.3 ]
 [ 0.    0.    0.   70.7  70.1  69.1 ]
 [ 0.    0.    0.    0.   78.1  77.2 ]
 [ 0.    0.    0.    0.    0.   80.2 ]]
2024-09-12 21:58:49,833 [trainer.py] => Forgetting (CNN): 3.8639999999999985
2024-09-12 21:58:53,027 [trainer.py] => config: ./exps/simplecil_cifar_B50_Inc10.json
2024-09-12 21:58:53,027 [trainer.py] => prefix:  
2024-09-12 21:58:53,027 [trainer.py] => dataset: cifar224
2024-09-12 21:58:53,027 [trainer.py] => memory_size: 0
2024-09-12 21:58:53,027 [trainer.py] => memory_per_class: 0
2024-09-12 21:58:53,027 [trainer.py] => fixed_memory: False
2024-09-12 21:58:53,027 [trainer.py] => shuffle: True
2024-09-12 21:58:53,027 [trainer.py] => init_cls: 50
2024-09-12 21:58:53,027 [trainer.py] => increment: 5
2024-09-12 21:58:53,027 [trainer.py] => model_name: simplecil
2024-09-12 21:58:53,027 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-12 21:58:53,027 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-12 21:58:53,027 [trainer.py] => seed: 1993
2024-09-12 21:58:53,027 [trainer.py] => tuned_epoch: 0
2024-09-12 21:58:53,027 [trainer.py] => init_lr: 0.01
2024-09-12 21:58:53,027 [trainer.py] => batch_size: 48
2024-09-12 21:58:53,027 [trainer.py] => weight_decay: 0.05
2024-09-12 21:58:53,027 [trainer.py] => min_lr: 1e-08
2024-09-12 21:58:53,028 [trainer.py] => optimizer: sgd
2024-09-12 21:58:53,028 [trainer.py] => vpt_type: shallow
2024-09-12 21:58:53,028 [trainer.py] => prompt_token_num: 3
2024-09-12 21:58:54,204 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 21:58:56,219 [trainer.py] => All params: 85798656
2024-09-12 21:58:56,220 [trainer.py] => Trainable params: 85798656
2024-09-12 21:58:56,648 [simplecil.py] => Learning on 0-50
2024-09-12 22:00:34,878 [trainer.py] => No NME accuracy.
2024-09-12 22:00:34,878 [trainer.py] => CNN: {'total': 81.82, '00-49': 81.82, 'old': 0, 'new': 81.82}
2024-09-12 22:00:34,878 [trainer.py] => CNN top1 curve: [81.82]
2024-09-12 22:00:34,878 [trainer.py] => CNN top5 curve: [95.52]

Average Accuracy (CNN): 81.82
2024-09-12 22:00:34,878 [trainer.py] => Average Accuracy (CNN): 81.82 

2024-09-12 22:00:34,879 [trainer.py] => All params: 85837057
2024-09-12 22:00:34,880 [trainer.py] => Trainable params: 85837057
2024-09-12 22:00:34,882 [simplecil.py] => Learning on 50-55
2024-09-12 22:01:01,990 [trainer.py] => No NME accuracy.
2024-09-12 22:01:01,990 [trainer.py] => CNN: {'total': 80.15, '00-49': 80.5, '50-54': 76.6, 'old': 80.5, 'new': 76.6}
2024-09-12 22:01:01,990 [trainer.py] => CNN top1 curve: [81.82, 80.15]
2024-09-12 22:01:01,990 [trainer.py] => CNN top5 curve: [95.52, 94.87]

Average Accuracy (CNN): 80.98
2024-09-12 22:01:01,990 [trainer.py] => Average Accuracy (CNN): 80.98 

2024-09-12 22:01:01,991 [trainer.py] => All params: 85840897
2024-09-12 22:01:01,992 [trainer.py] => Trainable params: 85840897
2024-09-12 22:01:01,994 [simplecil.py] => Learning on 55-60
2024-09-12 22:01:30,738 [trainer.py] => No NME accuracy.
2024-09-12 22:01:30,739 [trainer.py] => CNN: {'total': 80.07, '00-49': 80.22, '50-54': 76.6, '55-59': 82.0, 'old': 79.89, 'new': 82.0}
2024-09-12 22:01:30,739 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07]
2024-09-12 22:01:30,739 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47]

Average Accuracy (CNN): 80.68
2024-09-12 22:01:30,739 [trainer.py] => Average Accuracy (CNN): 80.68 

2024-09-12 22:01:30,740 [trainer.py] => All params: 85844737
2024-09-12 22:01:30,740 [trainer.py] => Trainable params: 85844737
2024-09-12 22:01:30,742 [simplecil.py] => Learning on 60-65
2024-09-12 22:02:01,123 [trainer.py] => No NME accuracy.
2024-09-12 22:02:01,123 [trainer.py] => CNN: {'total': 79.6, '00-49': 80.0, '50-54': 76.2, '55-59': 77.0, '60-64': 81.6, 'old': 79.43, 'new': 81.6}
2024-09-12 22:02:01,124 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6]
2024-09-12 22:02:01,124 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31]

Average Accuracy (CNN): 80.41
2024-09-12 22:02:01,124 [trainer.py] => Average Accuracy (CNN): 80.41 

2024-09-12 22:02:01,125 [trainer.py] => All params: 85848577
2024-09-12 22:02:01,125 [trainer.py] => Trainable params: 85848577
2024-09-12 22:02:01,127 [simplecil.py] => Learning on 65-70
2024-09-12 22:02:32,960 [trainer.py] => No NME accuracy.
2024-09-12 22:02:32,960 [trainer.py] => CNN: {'total': 79.99, '00-49': 79.58, '50-54': 76.2, '55-59': 76.4, '60-64': 81.0, '65-69': 90.4, 'old': 79.18, 'new': 90.4}
2024-09-12 22:02:32,960 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6, 79.99]
2024-09-12 22:02:32,960 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31, 94.36]

Average Accuracy (CNN): 80.33
2024-09-12 22:02:32,960 [trainer.py] => Average Accuracy (CNN): 80.33 

2024-09-12 22:02:32,961 [trainer.py] => All params: 85852417
2024-09-12 22:02:32,962 [trainer.py] => Trainable params: 85852417
2024-09-12 22:02:32,964 [simplecil.py] => Learning on 70-75
2024-09-12 22:03:06,332 [trainer.py] => No NME accuracy.
2024-09-12 22:03:06,332 [trainer.py] => CNN: {'total': 78.53, '00-49': 78.98, '50-54': 75.4, '55-59': 74.4, '60-64': 78.6, '65-69': 90.0, '70-74': 69.8, 'old': 79.16, 'new': 69.8}
2024-09-12 22:03:06,332 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6, 79.99, 78.53]
2024-09-12 22:03:06,333 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31, 94.36, 93.85]

Average Accuracy (CNN): 80.03
2024-09-12 22:03:06,333 [trainer.py] => Average Accuracy (CNN): 80.03 

2024-09-12 22:03:06,334 [trainer.py] => All params: 85856257
2024-09-12 22:03:06,335 [trainer.py] => Trainable params: 85856257
2024-09-12 22:03:06,340 [simplecil.py] => Learning on 75-80
2024-09-12 22:03:41,590 [trainer.py] => No NME accuracy.
2024-09-12 22:03:41,591 [trainer.py] => CNN: {'total': 77.31, '00-49': 78.28, '50-54': 72.2, '55-59': 73.2, '60-64': 78.0, '65-69': 89.4, '70-74': 68.4, '75-79': 73.0, 'old': 77.6, 'new': 73.0}
2024-09-12 22:03:41,591 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31]
2024-09-12 22:03:41,591 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54]

Average Accuracy (CNN): 79.64
2024-09-12 22:03:41,591 [trainer.py] => Average Accuracy (CNN): 79.64 

2024-09-12 22:03:41,592 [trainer.py] => All params: 85860097
2024-09-12 22:03:41,592 [trainer.py] => Trainable params: 85860097
2024-09-12 22:03:41,594 [simplecil.py] => Learning on 80-85
2024-09-12 22:04:18,273 [trainer.py] => No NME accuracy.
2024-09-12 22:04:18,273 [trainer.py] => CNN: {'total': 76.98, '00-49': 77.4, '50-54': 71.8, '55-59': 73.2, '60-64': 77.4, '65-69': 89.4, '70-74': 68.4, '75-79': 73.0, '80-84': 81.4, 'old': 76.7, 'new': 81.4}
2024-09-12 22:04:18,274 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98]
2024-09-12 22:04:18,274 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47]

Average Accuracy (CNN): 79.31
2024-09-12 22:04:18,274 [trainer.py] => Average Accuracy (CNN): 79.31 

2024-09-12 22:04:18,275 [trainer.py] => All params: 85863937
2024-09-12 22:04:18,276 [trainer.py] => Trainable params: 85863937
2024-09-12 22:04:18,279 [simplecil.py] => Learning on 85-90
2024-09-12 22:04:57,222 [trainer.py] => No NME accuracy.
2024-09-12 22:04:57,223 [trainer.py] => CNN: {'total': 76.59, '00-49': 77.1, '50-54': 71.6, '55-59': 72.8, '60-64': 77.4, '65-69': 89.4, '70-74': 68.2, '75-79': 72.0, '80-84': 81.4, '85-89': 74.8, 'old': 76.69, 'new': 74.8}
2024-09-12 22:04:57,223 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98, 76.59]
2024-09-12 22:04:57,223 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47, 92.92]

Average Accuracy (CNN): 79.0
2024-09-12 22:04:57,223 [trainer.py] => Average Accuracy (CNN): 79.0 

2024-09-12 22:04:57,225 [trainer.py] => All params: 85867777
2024-09-12 22:04:57,226 [trainer.py] => Trainable params: 85867777
2024-09-12 22:04:57,229 [simplecil.py] => Learning on 90-95
2024-09-12 22:05:37,035 [trainer.py] => No NME accuracy.
2024-09-12 22:05:37,036 [trainer.py] => CNN: {'total': 76.72, '00-49': 76.74, '50-54': 70.0, '55-59': 72.8, '60-64': 77.2, '65-69': 89.4, '70-74': 68.0, '75-79': 70.6, '80-84': 81.4, '85-89': 74.6, '90-94': 86.2, 'old': 76.19, 'new': 86.2}
2024-09-12 22:05:37,036 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98, 76.59, 76.72]
2024-09-12 22:05:37,036 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47, 92.92, 92.88]

Average Accuracy (CNN): 78.78
2024-09-12 22:05:37,036 [trainer.py] => Average Accuracy (CNN): 78.78 

2024-09-12 22:05:37,038 [trainer.py] => All params: 85871617
2024-09-12 22:05:37,039 [trainer.py] => Trainable params: 85871617
2024-09-12 22:05:37,042 [simplecil.py] => Learning on 95-100
2024-09-12 22:06:18,404 [trainer.py] => No NME accuracy.
2024-09-12 22:06:18,405 [trainer.py] => CNN: {'total': 76.21, '00-49': 76.4, '50-54': 67.8, '55-59': 72.8, '60-64': 77.2, '65-69': 89.4, '70-74': 67.6, '75-79': 70.6, '80-84': 81.4, '85-89': 73.0, '90-94': 84.6, '95-99': 75.8, 'old': 76.23, 'new': 75.8}
2024-09-12 22:06:18,405 [trainer.py] => CNN top1 curve: [81.82, 80.15, 80.07, 79.6, 79.99, 78.53, 77.31, 76.98, 76.59, 76.72, 76.21]
2024-09-12 22:06:18,405 [trainer.py] => CNN top5 curve: [95.52, 94.87, 94.47, 94.31, 94.36, 93.85, 93.54, 93.47, 92.92, 92.88, 92.54]

Average Accuracy (CNN): 78.54
2024-09-12 22:06:18,405 [trainer.py] => Average Accuracy (CNN): 78.54 

Accuracy Matrix (CNN):
[[81.82 80.5  80.22 80.   79.58 78.98 78.28 77.4  77.1  76.74 76.4 ]
 [ 0.   76.6  76.6  76.2  76.2  75.4  72.2  71.8  71.6  70.   67.8 ]
 [ 0.    0.   82.   77.   76.4  74.4  73.2  73.2  72.8  72.8  72.8 ]
 [ 0.    0.    0.   81.6  81.   78.6  78.   77.4  77.4  77.2  77.2 ]
 [ 0.    0.    0.    0.   90.4  90.   89.4  89.4  89.4  89.4  89.4 ]
 [ 0.    0.    0.    0.    0.   69.8  68.4  68.4  68.2  68.   67.6 ]
 [ 0.    0.    0.    0.    0.    0.   73.   73.   72.   70.6  70.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.   81.4  81.4  81.4  81.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   74.8  74.6  73.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   86.2  84.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   75.8 ]]
2024-09-12 22:06:18,408 [trainer.py] => Forgetting (CNN): 3.6819999999999995

nohup: ignoring input
2024-08-17 21:20:02,049 [trainer.py] => config: ./exps/icarl_cifar_B0_Inc5.json
2024-08-17 21:20:02,049 [trainer.py] => prefix: reproduce
2024-08-17 21:20:02,049 [trainer.py] => dataset: cifar224
2024-08-17 21:20:02,049 [trainer.py] => memory_size: 2000
2024-08-17 21:20:02,049 [trainer.py] => memory_per_class: 20
2024-08-17 21:20:02,049 [trainer.py] => fixed_memory: False
2024-08-17 21:20:02,049 [trainer.py] => shuffle: True
2024-08-17 21:20:02,049 [trainer.py] => init_cls: 20
2024-08-17 21:20:02,049 [trainer.py] => increment: 20
2024-08-17 21:20:02,049 [trainer.py] => model_name: icarl
2024-08-17 21:20:02,049 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-08-17 21:20:02,049 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-17 21:20:02,049 [trainer.py] => seed: 1993
2024-08-17 21:20:02,049 [trainer.py] => init_epoch: 20
2024-08-17 21:20:02,049 [trainer.py] => init_lr: 0.001
2024-08-17 21:20:02,049 [trainer.py] => init_milestones: [60, 120, 170]
2024-08-17 21:20:02,050 [trainer.py] => init_lr_decay: 0.1
2024-08-17 21:20:02,050 [trainer.py] => init_weight_decay: 0.0005
2024-08-17 21:20:02,050 [trainer.py] => epochs: 20
2024-08-17 21:20:02,050 [trainer.py] => lrate: 0.001
2024-08-17 21:20:02,050 [trainer.py] => milestones: [80, 120]
2024-08-17 21:20:02,050 [trainer.py] => lrate_decay: 0.1
2024-08-17 21:20:02,050 [trainer.py] => batch_size: 48
2024-08-17 21:20:02,050 [trainer.py] => weight_decay: 0.0002
2024-08-17 21:20:02,050 [trainer.py] => T: 2
2024-08-17 21:20:03,033 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-08-17 21:20:05,256 [trainer.py] => All params: 85798656
2024-08-17 21:20:05,257 [trainer.py] => Trainable params: 85798656
2024-08-17 21:20:05,257 [icarl.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.572, Train_accy 22.65, Test_accy 75.35:   0%|          | 0/20 [00:38<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.572, Train_accy 22.65, Test_accy 75.35:   5%|▌         | 1/20 [00:38<12:16, 38.78s/it]
Task 0, Epoch 2/20 => Loss 0.805, Train_accy 75.75:   5%|▌         | 1/20 [01:14<12:16, 38.78s/it]                 
Task 0, Epoch 2/20 => Loss 0.805, Train_accy 75.75:  10%|█         | 2/20 [01:14<11:08, 37.14s/it]
Task 0, Epoch 3/20 => Loss 0.552, Train_accy 83.64:  10%|█         | 2/20 [01:50<11:08, 37.14s/it]
Task 0, Epoch 3/20 => Loss 0.552, Train_accy 83.64:  15%|█▌        | 3/20 [01:50<10:24, 36.71s/it]
Task 0, Epoch 4/20 => Loss 0.489, Train_accy 85.13:  15%|█▌        | 3/20 [02:27<10:24, 36.71s/it]
Task 0, Epoch 4/20 => Loss 0.489, Train_accy 85.13:  20%|██        | 4/20 [02:27<09:44, 36.54s/it]
Task 0, Epoch 5/20 => Loss 0.432, Train_accy 86.67:  20%|██        | 4/20 [03:03<09:44, 36.54s/it]
Task 0, Epoch 5/20 => Loss 0.432, Train_accy 86.67:  25%|██▌       | 5/20 [03:03<09:06, 36.43s/it]
Task 0, Epoch 6/20 => Loss 0.413, Train_accy 87.46, Test_accy 95.85:  25%|██▌       | 5/20 [03:42<09:06, 36.43s/it]
Task 0, Epoch 6/20 => Loss 0.413, Train_accy 87.46, Test_accy 95.85:  30%|███       | 6/20 [03:42<08:43, 37.42s/it]
Task 0, Epoch 7/20 => Loss 0.389, Train_accy 88.12:  30%|███       | 6/20 [04:19<08:43, 37.42s/it]                 
Task 0, Epoch 7/20 => Loss 0.389, Train_accy 88.12:  35%|███▌      | 7/20 [04:19<08:01, 37.02s/it]
Task 0, Epoch 8/20 => Loss 0.379, Train_accy 88.65:  35%|███▌      | 7/20 [04:55<08:01, 37.02s/it]
Task 0, Epoch 8/20 => Loss 0.379, Train_accy 88.65:  40%|████      | 8/20 [04:55<07:21, 36.78s/it]
Task 0, Epoch 9/20 => Loss 0.348, Train_accy 89.54:  40%|████      | 8/20 [05:31<07:21, 36.78s/it]
Task 0, Epoch 9/20 => Loss 0.348, Train_accy 89.54:  45%|████▌     | 9/20 [05:31<06:42, 36.64s/it]
Task 0, Epoch 10/20 => Loss 0.332, Train_accy 89.96:  45%|████▌     | 9/20 [06:07<06:42, 36.64s/it]
Task 0, Epoch 10/20 => Loss 0.332, Train_accy 89.96:  50%|█████     | 10/20 [06:07<06:05, 36.52s/it]
Task 0, Epoch 11/20 => Loss 0.321, Train_accy 90.18, Test_accy 96.50:  50%|█████     | 10/20 [06:47<06:05, 36.52s/it]
Task 0, Epoch 11/20 => Loss 0.321, Train_accy 90.18, Test_accy 96.50:  55%|█████▌    | 11/20 [06:47<05:36, 37.43s/it]
Task 0, Epoch 12/20 => Loss 0.309, Train_accy 90.57:  55%|█████▌    | 11/20 [07:23<05:36, 37.43s/it]                 
Task 0, Epoch 12/20 => Loss 0.309, Train_accy 90.57:  60%|██████    | 12/20 [07:23<04:56, 37.05s/it]
Task 0, Epoch 13/20 => Loss 0.308, Train_accy 90.80:  60%|██████    | 12/20 [07:59<04:56, 37.05s/it]
Task 0, Epoch 13/20 => Loss 0.308, Train_accy 90.80:  65%|██████▌   | 13/20 [07:59<04:17, 36.82s/it]
Task 0, Epoch 14/20 => Loss 0.290, Train_accy 91.15:  65%|██████▌   | 13/20 [08:36<04:17, 36.82s/it]
Task 0, Epoch 14/20 => Loss 0.290, Train_accy 91.15:  70%|███████   | 14/20 [08:36<03:39, 36.63s/it]
Task 0, Epoch 15/20 => Loss 0.299, Train_accy 90.93:  70%|███████   | 14/20 [09:12<03:39, 36.63s/it]
Task 0, Epoch 15/20 => Loss 0.299, Train_accy 90.93:  75%|███████▌  | 15/20 [09:12<03:02, 36.49s/it]
Task 0, Epoch 16/20 => Loss 0.298, Train_accy 90.89, Test_accy 96.20:  75%|███████▌  | 15/20 [09:51<03:02, 36.49s/it]
Task 0, Epoch 16/20 => Loss 0.298, Train_accy 90.89, Test_accy 96.20:  80%|████████  | 16/20 [09:51<02:29, 37.32s/it]
Task 0, Epoch 17/20 => Loss 0.284, Train_accy 91.36:  80%|████████  | 16/20 [10:27<02:29, 37.32s/it]                 
Task 0, Epoch 17/20 => Loss 0.284, Train_accy 91.36:  85%|████████▌ | 17/20 [10:27<01:51, 37.02s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 91.33:  85%|████████▌ | 17/20 [11:04<01:51, 37.02s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 91.33:  90%|█████████ | 18/20 [11:04<01:13, 36.79s/it]
Task 0, Epoch 19/20 => Loss 0.275, Train_accy 91.57:  90%|█████████ | 18/20 [11:40<01:13, 36.79s/it]
Task 0, Epoch 19/20 => Loss 0.275, Train_accy 91.57:  95%|█████████▌| 19/20 [11:40<00:36, 36.60s/it]
Task 0, Epoch 20/20 => Loss 0.270, Train_accy 91.63:  95%|█████████▌| 19/20 [12:16<00:36, 36.60s/it]
Task 0, Epoch 20/20 => Loss 0.270, Train_accy 91.63: 100%|██████████| 20/20 [12:16<00:00, 36.50s/it]
Task 0, Epoch 20/20 => Loss 0.270, Train_accy 91.63: 100%|██████████| 20/20 [12:16<00:00, 36.82s/it]
2024-08-17 21:32:22,020 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.270, Train_accy 91.63
2024-08-17 21:32:22,022 [base.py] => Reducing exemplars...(100 per classes)
2024-08-17 21:32:22,022 [base.py] => Constructing exemplars...(100 per classes)
2024-08-17 21:32:55,809 [icarl.py] => Exemplar size: 2000
2024-08-17 21:32:55,809 [trainer.py] => CNN: {'total': 96.3, '00-19': 96.3, 'old': 0, 'new': 96.3}
2024-08-17 21:32:55,809 [trainer.py] => NME: {'total': 96.6, '00-19': 96.6, 'old': 0, 'new': 96.6}
2024-08-17 21:32:55,809 [trainer.py] => CNN top1 curve: [96.3]
2024-08-17 21:32:55,809 [trainer.py] => CNN top5 curve: [99.5]
2024-08-17 21:32:55,809 [trainer.py] => NME top1 curve: [96.6]
2024-08-17 21:32:55,809 [trainer.py] => NME top5 curve: [99.65]

Average Accuracy (CNN): 96.3
Average Accuracy (NME): 96.6
2024-08-17 21:32:55,809 [trainer.py] => Average Accuracy (CNN): 96.3
2024-08-17 21:32:55,809 [trainer.py] => Average Accuracy (NME): 96.6
2024-08-17 21:32:55,809 [trainer.py] => Train Time: 0
2024-08-17 21:32:55,809 [trainer.py] => Test Time: 6.25 

2024-08-17 21:32:55,810 [trainer.py] => All params: 85814036
2024-08-17 21:32:55,810 [trainer.py] => Trainable params: 85814036
2024-08-17 21:32:55,811 [icarl.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.308, Train_accy 75.88, Test_accy 90.82:   0%|          | 0/20 [01:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.308, Train_accy 75.88, Test_accy 90.82:   5%|▌         | 1/20 [01:03<20:03, 63.35s/it]
Task 1, Epoch 2/20 => Loss 1.839, Train_accy 85.76:   5%|▌         | 1/20 [02:00<20:03, 63.35s/it]                 
Task 1, Epoch 2/20 => Loss 1.839, Train_accy 85.76:  10%|█         | 2/20 [02:00<17:56, 59.81s/it]
Task 1, Epoch 3/20 => Loss 1.785, Train_accy 87.18:  10%|█         | 2/20 [02:58<17:56, 59.81s/it]
Task 1, Epoch 3/20 => Loss 1.785, Train_accy 87.18:  15%|█▌        | 3/20 [02:58<16:37, 58.70s/it]
Task 1, Epoch 4/20 => Loss 1.736, Train_accy 88.39:  15%|█▌        | 3/20 [03:55<16:37, 58.70s/it]
Task 1, Epoch 4/20 => Loss 1.736, Train_accy 88.39:  20%|██        | 4/20 [03:55<15:30, 58.18s/it]
Task 1, Epoch 5/20 => Loss 1.717, Train_accy 89.27:  20%|██        | 4/20 [04:52<15:30, 58.18s/it]
Task 1, Epoch 5/20 => Loss 1.717, Train_accy 89.27:  25%|██▌       | 5/20 [04:52<14:28, 57.91s/it]
Task 1, Epoch 6/20 => Loss 1.685, Train_accy 89.94, Test_accy 93.65:  25%|██▌       | 5/20 [05:56<14:28, 57.91s/it]
Task 1, Epoch 6/20 => Loss 1.685, Train_accy 89.94, Test_accy 93.65:  30%|███       | 6/20 [05:56<13:56, 59.73s/it]
Task 1, Epoch 7/20 => Loss 1.682, Train_accy 90.28:  30%|███       | 6/20 [06:53<13:56, 59.73s/it]                 
Task 1, Epoch 7/20 => Loss 1.682, Train_accy 90.28:  35%|███▌      | 7/20 [06:53<12:47, 59.03s/it]
Task 1, Epoch 8/20 => Loss 1.651, Train_accy 90.82:  35%|███▌      | 7/20 [07:51<12:47, 59.03s/it]
Task 1, Epoch 8/20 => Loss 1.651, Train_accy 90.82:  40%|████      | 8/20 [07:51<11:42, 58.51s/it]
Task 1, Epoch 9/20 => Loss 1.682, Train_accy 90.24:  40%|████      | 8/20 [08:48<11:42, 58.51s/it]
Task 1, Epoch 9/20 => Loss 1.682, Train_accy 90.24:  45%|████▌     | 9/20 [08:48<10:40, 58.25s/it]
Task 1, Epoch 10/20 => Loss 1.650, Train_accy 90.85:  45%|████▌     | 9/20 [09:46<10:40, 58.25s/it]
Task 1, Epoch 10/20 => Loss 1.650, Train_accy 90.85:  50%|█████     | 10/20 [09:46<09:39, 58.00s/it]
Task 1, Epoch 11/20 => Loss 1.637, Train_accy 91.34, Test_accy 92.22:  50%|█████     | 10/20 [10:49<09:39, 58.00s/it]
Task 1, Epoch 11/20 => Loss 1.637, Train_accy 91.34, Test_accy 92.22:  55%|█████▌    | 11/20 [10:49<08:57, 59.69s/it]
Task 1, Epoch 12/20 => Loss 1.622, Train_accy 91.65:  55%|█████▌    | 11/20 [11:47<08:57, 59.69s/it]                 
Task 1, Epoch 12/20 => Loss 1.622, Train_accy 91.65:  60%|██████    | 12/20 [11:47<07:52, 59.02s/it]
Task 1, Epoch 13/20 => Loss 1.621, Train_accy 92.02:  60%|██████    | 12/20 [12:44<07:52, 59.02s/it]
Task 1, Epoch 13/20 => Loss 1.621, Train_accy 92.02:  65%|██████▌   | 13/20 [12:44<06:49, 58.55s/it]
Task 1, Epoch 14/20 => Loss 1.642, Train_accy 91.41:  65%|██████▌   | 13/20 [13:42<06:49, 58.55s/it]
Task 1, Epoch 14/20 => Loss 1.642, Train_accy 91.41:  70%|███████   | 14/20 [13:42<05:49, 58.22s/it]
Task 1, Epoch 15/20 => Loss 1.617, Train_accy 91.78:  70%|███████   | 14/20 [14:39<05:49, 58.22s/it]
Task 1, Epoch 15/20 => Loss 1.617, Train_accy 91.78:  75%|███████▌  | 15/20 [14:39<04:49, 57.98s/it]
Task 1, Epoch 16/20 => Loss 1.606, Train_accy 92.08, Test_accy 92.98:  75%|███████▌  | 15/20 [15:43<04:49, 57.98s/it]
Task 1, Epoch 16/20 => Loss 1.606, Train_accy 92.08, Test_accy 92.98:  80%|████████  | 16/20 [15:43<03:58, 59.63s/it]
Task 1, Epoch 17/20 => Loss 1.601, Train_accy 92.24:  80%|████████  | 16/20 [16:40<03:58, 59.63s/it]                 
Task 1, Epoch 17/20 => Loss 1.601, Train_accy 92.24:  85%|████████▌ | 17/20 [16:40<02:56, 58.98s/it]
Task 1, Epoch 18/20 => Loss 1.586, Train_accy 92.32:  85%|████████▌ | 17/20 [17:38<02:56, 58.98s/it]
Task 1, Epoch 18/20 => Loss 1.586, Train_accy 92.32:  90%|█████████ | 18/20 [17:38<01:57, 58.55s/it]
Task 1, Epoch 19/20 => Loss 1.559, Train_accy 92.82:  90%|█████████ | 18/20 [18:35<01:57, 58.55s/it]
Task 1, Epoch 19/20 => Loss 1.559, Train_accy 92.82:  95%|█████████▌| 19/20 [18:35<00:58, 58.24s/it]
Task 1, Epoch 20/20 => Loss 1.599, Train_accy 92.19:  95%|█████████▌| 19/20 [19:33<00:58, 58.24s/it]
Task 1, Epoch 20/20 => Loss 1.599, Train_accy 92.19: 100%|██████████| 20/20 [19:33<00:00, 58.00s/it]
Task 1, Epoch 20/20 => Loss 1.599, Train_accy 92.19: 100%|██████████| 20/20 [19:33<00:00, 58.65s/it]
2024-08-17 21:52:28,954 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.599, Train_accy 92.19
2024-08-17 21:52:28,955 [base.py] => Reducing exemplars...(50 per classes)
2024-08-17 21:52:34,380 [base.py] => Constructing exemplars...(50 per classes)
2024-08-17 21:53:11,487 [icarl.py] => Exemplar size: 2000
2024-08-17 21:53:11,487 [trainer.py] => CNN: {'total': 92.68, '00-19': 89.35, '20-39': 96.0, 'old': 89.35, 'new': 96.0}
2024-08-17 21:53:11,487 [trainer.py] => NME: {'total': 93.82, '00-19': 92.05, '20-39': 95.6, 'old': 92.05, 'new': 95.6}
2024-08-17 21:53:11,487 [trainer.py] => CNN top1 curve: [96.3, 92.68]
2024-08-17 21:53:11,487 [trainer.py] => CNN top5 curve: [99.5, 98.85]
2024-08-17 21:53:11,487 [trainer.py] => NME top1 curve: [96.6, 93.82]
2024-08-17 21:53:11,487 [trainer.py] => NME top5 curve: [99.65, 99.42]

Average Accuracy (CNN): 94.49
Average Accuracy (NME): 95.21
2024-08-17 21:53:11,487 [trainer.py] => Average Accuracy (CNN): 94.49
2024-08-17 21:53:11,487 [trainer.py] => Average Accuracy (NME): 95.21
2024-08-17 21:53:11,487 [trainer.py] => Train Time: 0
2024-08-17 21:53:11,487 [trainer.py] => Test Time: 18.310000000000002 

2024-08-17 21:53:11,488 [trainer.py] => All params: 85829416
2024-08-17 21:53:11,488 [trainer.py] => Trainable params: 85829416
2024-08-17 21:53:11,489 [icarl.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.028, Train_accy 74.26, Test_accy 88.72:   0%|          | 0/20 [01:06<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.028, Train_accy 74.26, Test_accy 88.72:   5%|▌         | 1/20 [01:06<21:05, 66.62s/it]
Task 2, Epoch 2/20 => Loss 2.457, Train_accy 85.85:   5%|▌         | 1/20 [02:04<21:05, 66.62s/it]                 
Task 2, Epoch 2/20 => Loss 2.457, Train_accy 85.85:  10%|█         | 2/20 [02:04<18:22, 61.23s/it]
Task 2, Epoch 3/20 => Loss 2.423, Train_accy 87.02:  10%|█         | 2/20 [03:01<18:22, 61.23s/it]
Task 2, Epoch 3/20 => Loss 2.423, Train_accy 87.02:  15%|█▌        | 3/20 [03:01<16:52, 59.53s/it]
Task 2, Epoch 4/20 => Loss 2.360, Train_accy 87.88:  15%|█▌        | 3/20 [03:58<16:52, 59.53s/it]
Task 2, Epoch 4/20 => Loss 2.360, Train_accy 87.88:  20%|██        | 4/20 [03:58<15:38, 58.68s/it]
Task 2, Epoch 5/20 => Loss 2.356, Train_accy 88.41:  20%|██        | 4/20 [04:56<15:38, 58.68s/it]
Task 2, Epoch 5/20 => Loss 2.356, Train_accy 88.41:  25%|██▌       | 5/20 [04:56<14:34, 58.33s/it]
Task 2, Epoch 6/20 => Loss 2.338, Train_accy 89.14, Test_accy 88.08:  25%|██▌       | 5/20 [06:03<14:34, 58.33s/it]
Task 2, Epoch 6/20 => Loss 2.338, Train_accy 89.14, Test_accy 88.08:  30%|███       | 6/20 [06:03<14:15, 61.10s/it]
Task 2, Epoch 7/20 => Loss 2.293, Train_accy 90.35:  30%|███       | 6/20 [07:00<14:15, 61.10s/it]                 
Task 2, Epoch 7/20 => Loss 2.293, Train_accy 90.35:  35%|███▌      | 7/20 [07:00<12:58, 59.88s/it]
Task 2, Epoch 8/20 => Loss 2.291, Train_accy 90.43:  35%|███▌      | 7/20 [07:57<12:58, 59.88s/it]
Task 2, Epoch 8/20 => Loss 2.291, Train_accy 90.43:  40%|████      | 8/20 [07:57<11:48, 59.05s/it]
Task 2, Epoch 9/20 => Loss 2.266, Train_accy 90.71:  40%|████      | 8/20 [08:55<11:48, 59.05s/it]
Task 2, Epoch 9/20 => Loss 2.266, Train_accy 90.71:  45%|████▌     | 9/20 [08:55<10:43, 58.50s/it]
Task 2, Epoch 10/20 => Loss 2.269, Train_accy 90.92:  45%|████▌     | 9/20 [09:52<10:43, 58.50s/it]
Task 2, Epoch 10/20 => Loss 2.269, Train_accy 90.92:  50%|█████     | 10/20 [09:52<09:41, 58.13s/it]
Task 2, Epoch 11/20 => Loss 2.259, Train_accy 91.22, Test_accy 88.87:  50%|█████     | 10/20 [10:58<09:41, 58.13s/it]
Task 2, Epoch 11/20 => Loss 2.259, Train_accy 91.22, Test_accy 88.87:  55%|█████▌    | 11/20 [10:58<09:05, 60.57s/it]
Task 2, Epoch 12/20 => Loss 2.238, Train_accy 91.71:  55%|█████▌    | 11/20 [11:55<09:05, 60.57s/it]                 
Task 2, Epoch 12/20 => Loss 2.238, Train_accy 91.71:  60%|██████    | 12/20 [11:55<07:56, 59.56s/it]
Task 2, Epoch 13/20 => Loss 2.232, Train_accy 91.71:  60%|██████    | 12/20 [12:53<07:56, 59.56s/it]
Task 2, Epoch 13/20 => Loss 2.232, Train_accy 91.71:  65%|██████▌   | 13/20 [12:53<06:52, 58.91s/it]
Task 2, Epoch 14/20 => Loss 2.227, Train_accy 91.71:  65%|██████▌   | 13/20 [13:50<06:52, 58.91s/it]
Task 2, Epoch 14/20 => Loss 2.227, Train_accy 91.71:  70%|███████   | 14/20 [13:50<05:50, 58.43s/it]
Task 2, Epoch 15/20 => Loss 2.222, Train_accy 92.22:  70%|███████   | 14/20 [14:47<05:50, 58.43s/it]
Task 2, Epoch 15/20 => Loss 2.222, Train_accy 92.22:  75%|███████▌  | 15/20 [14:47<04:50, 58.14s/it]
Task 2, Epoch 16/20 => Loss 2.230, Train_accy 91.98, Test_accy 88.07:  75%|███████▌  | 15/20 [15:54<04:50, 58.14s/it]
Task 2, Epoch 16/20 => Loss 2.230, Train_accy 91.98, Test_accy 88.07:  80%|████████  | 16/20 [15:54<04:02, 60.65s/it]
Task 2, Epoch 17/20 => Loss 2.240, Train_accy 91.93:  80%|████████  | 16/20 [16:52<04:02, 60.65s/it]                 
Task 2, Epoch 17/20 => Loss 2.240, Train_accy 91.93:  85%|████████▌ | 17/20 [16:52<02:59, 59.74s/it]
Task 2, Epoch 18/20 => Loss 2.229, Train_accy 92.11:  85%|████████▌ | 17/20 [17:49<02:59, 59.74s/it]
Task 2, Epoch 18/20 => Loss 2.229, Train_accy 92.11:  90%|█████████ | 18/20 [17:49<01:58, 59.05s/it]
Task 2, Epoch 19/20 => Loss 2.227, Train_accy 92.39:  90%|█████████ | 18/20 [18:46<01:58, 59.05s/it]
Task 2, Epoch 19/20 => Loss 2.227, Train_accy 92.39:  95%|█████████▌| 19/20 [18:46<00:58, 58.56s/it]
Task 2, Epoch 20/20 => Loss 2.208, Train_accy 92.44:  95%|█████████▌| 19/20 [19:44<00:58, 58.56s/it]
Task 2, Epoch 20/20 => Loss 2.208, Train_accy 92.44: 100%|██████████| 20/20 [19:44<00:00, 58.25s/it]
Task 2, Epoch 20/20 => Loss 2.208, Train_accy 92.44: 100%|██████████| 20/20 [19:44<00:00, 59.22s/it]
2024-08-17 22:12:56,021 [icarl.py] => Task 2, Epoch 20/20 => Loss 2.208, Train_accy 92.44
2024-08-17 22:12:56,022 [base.py] => Reducing exemplars...(33 per classes)
2024-08-17 22:13:04,539 [base.py] => Constructing exemplars...(33 per classes)
2024-08-17 22:13:45,900 [icarl.py] => Exemplar size: 1980
2024-08-17 22:13:45,901 [trainer.py] => CNN: {'total': 87.7, '00-19': 79.35, '20-39': 88.95, '40-59': 94.8, 'old': 84.15, 'new': 94.8}
2024-08-17 22:13:45,901 [trainer.py] => NME: {'total': 90.73, '00-19': 88.6, '20-39': 91.25, '40-59': 92.35, 'old': 89.92, 'new': 92.35}
2024-08-17 22:13:45,901 [trainer.py] => CNN top1 curve: [96.3, 92.68, 87.7]
2024-08-17 22:13:45,901 [trainer.py] => CNN top5 curve: [99.5, 98.85, 98.22]
2024-08-17 22:13:45,901 [trainer.py] => NME top1 curve: [96.6, 93.82, 90.73]
2024-08-17 22:13:45,901 [trainer.py] => NME top5 curve: [99.65, 99.42, 98.98]

Average Accuracy (CNN): 92.23
Average Accuracy (NME): 93.72
2024-08-17 22:13:45,901 [trainer.py] => Average Accuracy (CNN): 92.23
2024-08-17 22:13:45,901 [trainer.py] => Average Accuracy (NME): 93.72
2024-08-17 22:13:45,901 [trainer.py] => Train Time: 0
2024-08-17 22:13:45,901 [trainer.py] => Test Time: 36.17 

2024-08-17 22:13:45,902 [trainer.py] => All params: 85844796
2024-08-17 22:13:45,902 [trainer.py] => Trainable params: 85844796
2024-08-17 22:13:45,903 [icarl.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.125, Train_accy 73.68, Test_accy 81.06:   0%|          | 0/20 [01:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.125, Train_accy 73.68, Test_accy 81.06:   5%|▌         | 1/20 [01:08<21:50, 68.99s/it]
Task 3, Epoch 2/20 => Loss 2.430, Train_accy 85.28:   5%|▌         | 1/20 [02:06<21:50, 68.99s/it]                 
Task 3, Epoch 2/20 => Loss 2.430, Train_accy 85.28:  10%|█         | 2/20 [02:06<18:35, 61.99s/it]
Task 3, Epoch 3/20 => Loss 2.385, Train_accy 86.54:  10%|█         | 2/20 [03:03<18:35, 61.99s/it]
Task 3, Epoch 3/20 => Loss 2.385, Train_accy 86.54:  15%|█▌        | 3/20 [03:03<16:56, 59.77s/it]
Task 3, Epoch 4/20 => Loss 2.345, Train_accy 87.77:  15%|█▌        | 3/20 [04:00<16:56, 59.77s/it]
Task 3, Epoch 4/20 => Loss 2.345, Train_accy 87.77:  20%|██        | 4/20 [04:00<15:38, 58.66s/it]
Task 3, Epoch 5/20 => Loss 2.296, Train_accy 89.06:  20%|██        | 4/20 [04:57<15:38, 58.66s/it]
Task 3, Epoch 5/20 => Loss 2.296, Train_accy 89.06:  25%|██▌       | 5/20 [04:57<14:30, 58.05s/it]
Task 3, Epoch 6/20 => Loss 2.290, Train_accy 89.47, Test_accy 82.71:  25%|██▌       | 5/20 [06:05<14:30, 58.05s/it]
Task 3, Epoch 6/20 => Loss 2.290, Train_accy 89.47, Test_accy 82.71:  30%|███       | 6/20 [06:05<14:22, 61.64s/it]
Task 3, Epoch 7/20 => Loss 2.280, Train_accy 90.17:  30%|███       | 6/20 [07:02<14:22, 61.64s/it]                 
Task 3, Epoch 7/20 => Loss 2.280, Train_accy 90.17:  35%|███▌      | 7/20 [07:02<13:01, 60.13s/it]
Task 3, Epoch 8/20 => Loss 2.256, Train_accy 90.74:  35%|███▌      | 7/20 [07:59<13:01, 60.13s/it]
Task 3, Epoch 8/20 => Loss 2.256, Train_accy 90.74:  40%|████      | 8/20 [07:59<11:49, 59.14s/it]
Task 3, Epoch 9/20 => Loss 2.259, Train_accy 90.50:  40%|████      | 8/20 [08:56<11:49, 59.14s/it]
Task 3, Epoch 9/20 => Loss 2.259, Train_accy 90.50:  45%|████▌     | 9/20 [08:56<10:42, 58.45s/it]
Task 3, Epoch 10/20 => Loss 2.218, Train_accy 91.69:  45%|████▌     | 9/20 [09:54<10:42, 58.45s/it]
Task 3, Epoch 10/20 => Loss 2.218, Train_accy 91.69:  50%|█████     | 10/20 [09:54<09:41, 58.12s/it]
Task 3, Epoch 11/20 => Loss 2.235, Train_accy 91.19, Test_accy 81.42:  50%|█████     | 10/20 [11:02<09:41, 58.12s/it]
Task 3, Epoch 11/20 => Loss 2.235, Train_accy 91.19, Test_accy 81.42:  55%|█████▌    | 11/20 [11:02<09:12, 61.37s/it]
Task 3, Epoch 12/20 => Loss 2.199, Train_accy 91.94:  55%|█████▌    | 11/20 [11:59<09:12, 61.37s/it]                 
Task 3, Epoch 12/20 => Loss 2.199, Train_accy 91.94:  60%|██████    | 12/20 [11:59<08:00, 60.08s/it]
Task 3, Epoch 13/20 => Loss 2.233, Train_accy 91.69:  60%|██████    | 12/20 [12:57<08:00, 60.08s/it]
Task 3, Epoch 13/20 => Loss 2.233, Train_accy 91.69:  65%|██████▌   | 13/20 [12:57<06:54, 59.17s/it]
Task 3, Epoch 14/20 => Loss 2.201, Train_accy 92.07:  65%|██████▌   | 13/20 [13:54<06:54, 59.17s/it]
Task 3, Epoch 14/20 => Loss 2.201, Train_accy 92.07:  70%|███████   | 14/20 [13:54<05:51, 58.58s/it]
Task 3, Epoch 15/20 => Loss 2.207, Train_accy 91.84:  70%|███████   | 14/20 [14:51<05:51, 58.58s/it]
Task 3, Epoch 15/20 => Loss 2.207, Train_accy 91.84:  75%|███████▌  | 15/20 [14:51<04:50, 58.10s/it]
Task 3, Epoch 16/20 => Loss 2.172, Train_accy 92.70, Test_accy 82.42:  75%|███████▌  | 15/20 [15:59<04:50, 58.10s/it]
Task 3, Epoch 16/20 => Loss 2.172, Train_accy 92.70, Test_accy 82.42:  80%|████████  | 16/20 [15:59<04:04, 61.24s/it]
Task 3, Epoch 17/20 => Loss 2.181, Train_accy 92.50:  80%|████████  | 16/20 [16:56<04:04, 61.24s/it]                 
Task 3, Epoch 17/20 => Loss 2.181, Train_accy 92.50:  85%|████████▌ | 17/20 [16:56<03:00, 60.00s/it]
Task 3, Epoch 18/20 => Loss 2.177, Train_accy 92.31:  85%|████████▌ | 17/20 [17:53<03:00, 60.00s/it]
Task 3, Epoch 18/20 => Loss 2.177, Train_accy 92.31:  90%|█████████ | 18/20 [17:53<01:58, 59.12s/it]
Task 3, Epoch 19/20 => Loss 2.175, Train_accy 92.87:  90%|█████████ | 18/20 [18:51<01:58, 59.12s/it]
Task 3, Epoch 19/20 => Loss 2.175, Train_accy 92.87:  95%|█████████▌| 19/20 [18:51<00:58, 58.50s/it]
Task 3, Epoch 20/20 => Loss 2.177, Train_accy 93.03:  95%|█████████▌| 19/20 [19:48<00:58, 58.50s/it]
Task 3, Epoch 20/20 => Loss 2.177, Train_accy 93.03: 100%|██████████| 20/20 [19:48<00:00, 58.05s/it]
Task 3, Epoch 20/20 => Loss 2.177, Train_accy 93.03: 100%|██████████| 20/20 [19:48<00:00, 59.40s/it]
2024-08-17 22:33:34,033 [icarl.py] => Task 3, Epoch 20/20 => Loss 2.177, Train_accy 93.03
2024-08-17 22:33:34,034 [base.py] => Reducing exemplars...(25 per classes)
2024-08-17 22:33:45,767 [base.py] => Constructing exemplars...(25 per classes)
2024-08-17 22:34:32,457 [icarl.py] => Exemplar size: 2000
2024-08-17 22:34:32,457 [trainer.py] => CNN: {'total': 82.59, '00-19': 74.3, '20-39': 84.85, '40-59': 76.45, '60-79': 94.75, 'old': 78.53, 'new': 94.75}
2024-08-17 22:34:32,457 [trainer.py] => NME: {'total': 87.92, '00-19': 85.8, '20-39': 89.65, '40-59': 85.85, '60-79': 90.4, 'old': 87.1, 'new': 90.4}
2024-08-17 22:34:32,457 [trainer.py] => CNN top1 curve: [96.3, 92.68, 87.7, 82.59]
2024-08-17 22:34:32,457 [trainer.py] => CNN top5 curve: [99.5, 98.85, 98.22, 96.99]
2024-08-17 22:34:32,457 [trainer.py] => NME top1 curve: [96.6, 93.82, 90.73, 87.92]
2024-08-17 22:34:32,457 [trainer.py] => NME top5 curve: [99.65, 99.42, 98.98, 98.52]

Average Accuracy (CNN): 89.82
Average Accuracy (NME): 92.27
2024-08-17 22:34:32,457 [trainer.py] => Average Accuracy (CNN): 89.82
2024-08-17 22:34:32,457 [trainer.py] => Average Accuracy (NME): 92.27
2024-08-17 22:34:32,457 [trainer.py] => Train Time: 0
2024-08-17 22:34:32,457 [trainer.py] => Test Time: 59.25 

2024-08-17 22:34:32,458 [trainer.py] => All params: 85860176
2024-08-17 22:34:32,458 [trainer.py] => Trainable params: 85860176
2024-08-17 22:34:32,460 [icarl.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.414, Train_accy 74.86, Test_accy 77.83:   0%|          | 0/20 [01:11<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.414, Train_accy 74.86, Test_accy 77.83:   5%|▌         | 1/20 [01:11<22:31, 71.15s/it]
Task 4, Epoch 2/20 => Loss 2.728, Train_accy 86.08:   5%|▌         | 1/20 [02:08<22:31, 71.15s/it]                 
Task 4, Epoch 2/20 => Loss 2.728, Train_accy 86.08:  10%|█         | 2/20 [02:08<18:49, 62.77s/it]
Task 4, Epoch 3/20 => Loss 2.656, Train_accy 87.71:  10%|█         | 2/20 [03:04<18:49, 62.77s/it]
Task 4, Epoch 3/20 => Loss 2.656, Train_accy 87.71:  15%|█▌        | 3/20 [03:04<17:00, 60.05s/it]
Task 4, Epoch 4/20 => Loss 2.626, Train_accy 89.24:  15%|█▌        | 3/20 [04:01<17:00, 60.05s/it]
Task 4, Epoch 4/20 => Loss 2.626, Train_accy 89.24:  20%|██        | 4/20 [04:01<15:41, 58.84s/it]
Task 4, Epoch 5/20 => Loss 2.589, Train_accy 89.87:  20%|██        | 4/20 [04:58<15:41, 58.84s/it]
Task 4, Epoch 5/20 => Loss 2.589, Train_accy 89.87:  25%|██▌       | 5/20 [04:58<14:32, 58.15s/it]
Task 4, Epoch 6/20 => Loss 2.557, Train_accy 90.59, Test_accy 77.71:  25%|██▌       | 5/20 [06:09<14:32, 58.15s/it]
Task 4, Epoch 6/20 => Loss 2.557, Train_accy 90.59, Test_accy 77.71:  30%|███       | 6/20 [06:09<14:35, 62.55s/it]
Task 4, Epoch 7/20 => Loss 2.569, Train_accy 90.74:  30%|███       | 6/20 [07:07<14:35, 62.55s/it]                 
Task 4, Epoch 7/20 => Loss 2.569, Train_accy 90.74:  35%|███▌      | 7/20 [07:07<13:10, 60.81s/it]
Task 4, Epoch 8/20 => Loss 2.520, Train_accy 91.34:  35%|███▌      | 7/20 [08:04<13:10, 60.81s/it]
Task 4, Epoch 8/20 => Loss 2.520, Train_accy 91.34:  40%|████      | 8/20 [08:04<11:54, 59.58s/it]
Task 4, Epoch 9/20 => Loss 2.528, Train_accy 91.25:  40%|████      | 8/20 [09:00<11:54, 59.58s/it]
Task 4, Epoch 9/20 => Loss 2.528, Train_accy 91.25:  45%|████▌     | 9/20 [09:00<10:45, 58.71s/it]
Task 4, Epoch 10/20 => Loss 2.511, Train_accy 91.83:  45%|████▌     | 9/20 [09:57<10:45, 58.71s/it]
Task 4, Epoch 10/20 => Loss 2.511, Train_accy 91.83:  50%|█████     | 10/20 [09:57<09:41, 58.19s/it]
Task 4, Epoch 11/20 => Loss 2.499, Train_accy 92.12, Test_accy 77.45:  50%|█████     | 10/20 [11:08<09:41, 58.19s/it]
Task 4, Epoch 11/20 => Loss 2.499, Train_accy 92.12, Test_accy 77.45:  55%|█████▌    | 11/20 [11:08<09:19, 62.11s/it]
Task 4, Epoch 12/20 => Loss 2.491, Train_accy 92.16:  55%|█████▌    | 11/20 [12:05<09:19, 62.11s/it]                 
Task 4, Epoch 12/20 => Loss 2.491, Train_accy 92.16:  60%|██████    | 12/20 [12:05<08:04, 60.51s/it]
Task 4, Epoch 13/20 => Loss 2.494, Train_accy 92.11:  60%|██████    | 12/20 [13:02<08:04, 60.51s/it]
Task 4, Epoch 13/20 => Loss 2.494, Train_accy 92.11:  65%|██████▌   | 13/20 [13:02<06:55, 59.41s/it]
Task 4, Epoch 14/20 => Loss 2.478, Train_accy 92.65:  65%|██████▌   | 13/20 [13:59<06:55, 59.41s/it]
Task 4, Epoch 14/20 => Loss 2.478, Train_accy 92.65:  70%|███████   | 14/20 [13:59<05:51, 58.62s/it]
Task 4, Epoch 15/20 => Loss 2.501, Train_accy 92.37:  70%|███████   | 14/20 [14:56<05:51, 58.62s/it]
Task 4, Epoch 15/20 => Loss 2.501, Train_accy 92.37:  75%|███████▌  | 15/20 [14:56<04:50, 58.07s/it]
Task 4, Epoch 16/20 => Loss 2.482, Train_accy 92.49, Test_accy 77.60:  75%|███████▌  | 15/20 [16:07<04:50, 58.07s/it]
Task 4, Epoch 16/20 => Loss 2.482, Train_accy 92.49, Test_accy 77.60:  80%|████████  | 16/20 [16:07<04:08, 62.05s/it]
Task 4, Epoch 17/20 => Loss 2.460, Train_accy 92.61:  80%|████████  | 16/20 [17:04<04:08, 62.05s/it]                 
Task 4, Epoch 17/20 => Loss 2.460, Train_accy 92.61:  85%|████████▌ | 17/20 [17:04<03:01, 60.58s/it]
Task 4, Epoch 18/20 => Loss 2.466, Train_accy 92.78:  85%|████████▌ | 17/20 [18:01<03:01, 60.58s/it]
Task 4, Epoch 18/20 => Loss 2.466, Train_accy 92.78:  90%|█████████ | 18/20 [18:01<01:59, 59.52s/it]
Task 4, Epoch 19/20 => Loss 2.472, Train_accy 92.82:  90%|█████████ | 18/20 [18:58<01:59, 59.52s/it]
Task 4, Epoch 19/20 => Loss 2.472, Train_accy 92.82:  95%|█████████▌| 19/20 [18:58<00:58, 58.77s/it]
Task 4, Epoch 20/20 => Loss 2.459, Train_accy 92.95:  95%|█████████▌| 19/20 [19:55<00:58, 58.77s/it]
Task 4, Epoch 20/20 => Loss 2.459, Train_accy 92.95: 100%|██████████| 20/20 [19:55<00:00, 58.24s/it]
Task 4, Epoch 20/20 => Loss 2.459, Train_accy 92.95: 100%|██████████| 20/20 [19:55<00:00, 59.79s/it]
2024-08-17 22:54:28,325 [icarl.py] => Task 4, Epoch 20/20 => Loss 2.459, Train_accy 92.95
2024-08-17 22:54:28,326 [base.py] => Reducing exemplars...(20 per classes)
2024-08-17 22:54:42,705 [base.py] => Constructing exemplars...(20 per classes)
2024-08-17 22:55:34,166 [icarl.py] => Exemplar size: 2000
2024-08-17 22:55:34,167 [trainer.py] => CNN: {'total': 77.45, '00-19': 63.75, '20-39': 75.85, '40-59': 68.7, '60-79': 83.3, '80-99': 95.65, 'old': 72.9, 'new': 95.65}
2024-08-17 22:55:34,167 [trainer.py] => NME: {'total': 85.44, '00-19': 81.7, '20-39': 86.7, '40-59': 82.25, '60-79': 86.3, '80-99': 90.25, 'old': 84.24, 'new': 90.25}
2024-08-17 22:55:34,167 [trainer.py] => CNN top1 curve: [96.3, 92.68, 87.7, 82.59, 77.45]
2024-08-17 22:55:34,167 [trainer.py] => CNN top5 curve: [99.5, 98.85, 98.22, 96.99, 94.72]
2024-08-17 22:55:34,167 [trainer.py] => NME top1 curve: [96.6, 93.82, 90.73, 87.92, 85.44]
2024-08-17 22:55:34,167 [trainer.py] => NME top5 curve: [99.65, 99.42, 98.98, 98.52, 97.91]

Average Accuracy (CNN): 87.34
Average Accuracy (NME): 90.9
2024-08-17 22:55:34,167 [trainer.py] => Average Accuracy (CNN): 87.34
2024-08-17 22:55:34,167 [trainer.py] => Average Accuracy (NME): 90.9
2024-08-17 22:55:34,167 [trainer.py] => Train Time: 0
2024-08-17 22:55:34,167 [trainer.py] => Test Time: 87.82 

Accuracy Matrix (CNN):
[[96.3  89.35 79.35 74.3  63.75]
 [ 0.   96.   88.95 84.85 75.85]
 [ 0.    0.   94.8  76.45 68.7 ]
 [ 0.    0.    0.   94.75 83.3 ]
 [ 0.    0.    0.    0.   95.65]]
2024-08-17 22:55:34,168 [trainer.py] => Forgetting (CNN): 22.5625
Accuracy Matrix (NME):
[[96.6  92.05 88.6  85.8  81.7 ]
 [ 0.   95.6  91.25 89.65 86.7 ]
 [ 0.    0.   92.35 85.85 82.25]
 [ 0.    0.    0.   90.4  86.3 ]
 [ 0.    0.    0.    0.   90.25]]
2024-08-17 22:55:34,168 [trainer.py] => Forgetting (NME): 9.499999999999996
2024-08-17 22:55:36,203 [trainer.py] => config: ./exps/icarl_cifar_B0_Inc10.json
2024-08-17 22:55:36,203 [trainer.py] => prefix: reproduce
2024-08-17 22:55:36,203 [trainer.py] => dataset: cifar224
2024-08-17 22:55:36,203 [trainer.py] => memory_size: 2000
2024-08-17 22:55:36,203 [trainer.py] => memory_per_class: 20
2024-08-17 22:55:36,203 [trainer.py] => fixed_memory: False
2024-08-17 22:55:36,203 [trainer.py] => shuffle: True
2024-08-17 22:55:36,203 [trainer.py] => init_cls: 10
2024-08-17 22:55:36,203 [trainer.py] => increment: 10
2024-08-17 22:55:36,203 [trainer.py] => model_name: icarl
2024-08-17 22:55:36,203 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-08-17 22:55:36,203 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-17 22:55:36,203 [trainer.py] => seed: 1993
2024-08-17 22:55:36,203 [trainer.py] => init_epoch: 20
2024-08-17 22:55:36,203 [trainer.py] => init_lr: 0.001
2024-08-17 22:55:36,203 [trainer.py] => init_milestones: [60, 120, 170]
2024-08-17 22:55:36,204 [trainer.py] => init_lr_decay: 0.1
2024-08-17 22:55:36,204 [trainer.py] => init_weight_decay: 0.0005
2024-08-17 22:55:36,204 [trainer.py] => epochs: 20
2024-08-17 22:55:36,204 [trainer.py] => lrate: 0.001
2024-08-17 22:55:36,204 [trainer.py] => milestones: [80, 120]
2024-08-17 22:55:36,204 [trainer.py] => lrate_decay: 0.1
2024-08-17 22:55:36,204 [trainer.py] => batch_size: 48
2024-08-17 22:55:36,204 [trainer.py] => weight_decay: 0.0002
2024-08-17 22:55:36,204 [trainer.py] => T: 2
2024-08-17 22:55:37,153 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-08-17 22:55:39,175 [trainer.py] => All params: 85798656
2024-08-17 22:55:39,175 [trainer.py] => Trainable params: 85798656
2024-08-17 22:55:39,176 [icarl.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.895, Train_accy 70.24, Test_accy 95.90:   0%|          | 0/20 [00:20<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.895, Train_accy 70.24, Test_accy 95.90:   5%|▌         | 1/20 [00:20<06:22, 20.11s/it]
Task 0, Epoch 2/20 => Loss 0.420, Train_accy 86.50:   5%|▌         | 1/20 [00:38<06:22, 20.11s/it]                 
Task 0, Epoch 2/20 => Loss 0.420, Train_accy 86.50:  10%|█         | 2/20 [00:38<05:43, 19.07s/it]
Task 0, Epoch 3/20 => Loss 0.337, Train_accy 89.52:  10%|█         | 2/20 [00:56<05:43, 19.07s/it]
Task 0, Epoch 3/20 => Loss 0.337, Train_accy 89.52:  15%|█▌        | 3/20 [00:56<05:17, 18.68s/it]
Task 0, Epoch 4/20 => Loss 0.312, Train_accy 89.70:  15%|█▌        | 3/20 [01:14<05:17, 18.68s/it]
Task 0, Epoch 4/20 => Loss 0.312, Train_accy 89.70:  20%|██        | 4/20 [01:14<04:56, 18.53s/it]
Task 0, Epoch 5/20 => Loss 0.297, Train_accy 90.28:  20%|██        | 4/20 [01:33<04:56, 18.53s/it]
Task 0, Epoch 5/20 => Loss 0.297, Train_accy 90.28:  25%|██▌       | 5/20 [01:33<04:36, 18.43s/it]
Task 0, Epoch 6/20 => Loss 0.266, Train_accy 91.24, Test_accy 97.90:  25%|██▌       | 5/20 [01:53<04:36, 18.43s/it]
Task 0, Epoch 6/20 => Loss 0.266, Train_accy 91.24, Test_accy 97.90:  30%|███       | 6/20 [01:53<04:25, 18.95s/it]
Task 0, Epoch 7/20 => Loss 0.246, Train_accy 92.40:  30%|███       | 6/20 [02:11<04:25, 18.95s/it]                 
Task 0, Epoch 7/20 => Loss 0.246, Train_accy 92.40:  35%|███▌      | 7/20 [02:11<04:03, 18.72s/it]
Task 0, Epoch 8/20 => Loss 0.241, Train_accy 92.18:  35%|███▌      | 7/20 [02:29<04:03, 18.72s/it]
Task 0, Epoch 8/20 => Loss 0.241, Train_accy 92.18:  40%|████      | 8/20 [02:29<03:42, 18.58s/it]
Task 0, Epoch 9/20 => Loss 0.230, Train_accy 92.18:  40%|████      | 8/20 [02:47<03:42, 18.58s/it]
Task 0, Epoch 9/20 => Loss 0.230, Train_accy 92.18:  45%|████▌     | 9/20 [02:47<03:23, 18.48s/it]
Task 0, Epoch 10/20 => Loss 0.226, Train_accy 92.56:  45%|████▌     | 9/20 [03:06<03:23, 18.48s/it]
Task 0, Epoch 10/20 => Loss 0.226, Train_accy 92.56:  50%|█████     | 10/20 [03:06<03:04, 18.40s/it]
Task 0, Epoch 11/20 => Loss 0.221, Train_accy 93.06, Test_accy 98.50:  50%|█████     | 10/20 [03:26<03:04, 18.40s/it]
Task 0, Epoch 11/20 => Loss 0.221, Train_accy 93.06, Test_accy 98.50:  55%|█████▌    | 11/20 [03:26<02:50, 18.92s/it]
Task 0, Epoch 12/20 => Loss 0.233, Train_accy 92.44:  55%|█████▌    | 11/20 [03:44<02:50, 18.92s/it]                 
Task 0, Epoch 12/20 => Loss 0.233, Train_accy 92.44:  60%|██████    | 12/20 [03:44<02:29, 18.71s/it]
Task 0, Epoch 13/20 => Loss 0.216, Train_accy 92.76:  60%|██████    | 12/20 [04:02<02:29, 18.71s/it]
Task 0, Epoch 13/20 => Loss 0.216, Train_accy 92.76:  65%|██████▌   | 13/20 [04:02<02:10, 18.60s/it]
Task 0, Epoch 14/20 => Loss 0.178, Train_accy 94.44:  65%|██████▌   | 13/20 [04:21<02:10, 18.60s/it]
Task 0, Epoch 14/20 => Loss 0.178, Train_accy 94.44:  70%|███████   | 14/20 [04:21<01:50, 18.48s/it]
Task 0, Epoch 15/20 => Loss 0.187, Train_accy 93.84:  70%|███████   | 14/20 [04:39<01:50, 18.48s/it]
Task 0, Epoch 15/20 => Loss 0.187, Train_accy 93.84:  75%|███████▌  | 15/20 [04:39<01:32, 18.42s/it]
Task 0, Epoch 16/20 => Loss 0.186, Train_accy 94.00, Test_accy 98.20:  75%|███████▌  | 15/20 [04:59<01:32, 18.42s/it]
Task 0, Epoch 16/20 => Loss 0.186, Train_accy 94.00, Test_accy 98.20:  80%|████████  | 16/20 [04:59<01:15, 18.88s/it]
Task 0, Epoch 17/20 => Loss 0.193, Train_accy 93.48:  80%|████████  | 16/20 [05:17<01:15, 18.88s/it]                 
Task 0, Epoch 17/20 => Loss 0.193, Train_accy 93.48:  85%|████████▌ | 17/20 [05:17<00:56, 18.69s/it]
Task 0, Epoch 18/20 => Loss 0.190, Train_accy 93.92:  85%|████████▌ | 17/20 [05:35<00:56, 18.69s/it]
Task 0, Epoch 18/20 => Loss 0.190, Train_accy 93.92:  90%|█████████ | 18/20 [05:35<00:37, 18.55s/it]
Task 0, Epoch 19/20 => Loss 0.196, Train_accy 93.96:  90%|█████████ | 18/20 [05:54<00:37, 18.55s/it]
Task 0, Epoch 19/20 => Loss 0.196, Train_accy 93.96:  95%|█████████▌| 19/20 [05:54<00:18, 18.47s/it]
Task 0, Epoch 20/20 => Loss 0.194, Train_accy 94.18:  95%|█████████▌| 19/20 [06:12<00:18, 18.47s/it]
Task 0, Epoch 20/20 => Loss 0.194, Train_accy 94.18: 100%|██████████| 20/20 [06:12<00:00, 18.37s/it]
Task 0, Epoch 20/20 => Loss 0.194, Train_accy 94.18: 100%|██████████| 20/20 [06:12<00:00, 18.61s/it]
2024-08-17 23:01:51,674 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.194, Train_accy 94.18
2024-08-17 23:01:51,675 [base.py] => Reducing exemplars...(200 per classes)
2024-08-17 23:01:51,676 [base.py] => Constructing exemplars...(200 per classes)
2024-08-17 23:02:11,529 [icarl.py] => Exemplar size: 2000
2024-08-17 23:02:11,529 [trainer.py] => CNN: {'total': 98.2, '00-09': 98.2, 'old': 0, 'new': 98.2}
2024-08-17 23:02:11,529 [trainer.py] => NME: {'total': 98.6, '00-09': 98.6, 'old': 0, 'new': 98.6}
2024-08-17 23:02:11,529 [trainer.py] => CNN top1 curve: [98.2]
2024-08-17 23:02:11,529 [trainer.py] => CNN top5 curve: [100.0]
2024-08-17 23:02:11,529 [trainer.py] => NME top1 curve: [98.6]
2024-08-17 23:02:11,529 [trainer.py] => NME top5 curve: [99.9]

Average Accuracy (CNN): 98.2
Average Accuracy (NME): 98.6
2024-08-17 23:02:11,529 [trainer.py] => Average Accuracy (CNN): 98.2
2024-08-17 23:02:11,529 [trainer.py] => Average Accuracy (NME): 98.6
2024-08-17 23:02:11,529 [trainer.py] => Train Time: 0
2024-08-17 23:02:11,529 [trainer.py] => Test Time: 3.36 

2024-08-17 23:02:11,530 [trainer.py] => All params: 85806346
2024-08-17 23:02:11,531 [trainer.py] => Trainable params: 85806346
2024-08-17 23:02:11,532 [icarl.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.962, Train_accy 76.90, Test_accy 94.55:   0%|          | 0/20 [00:36<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.962, Train_accy 76.90, Test_accy 94.55:   5%|▌         | 1/20 [00:36<11:29, 36.28s/it]
Task 1, Epoch 2/20 => Loss 1.599, Train_accy 87.10:   5%|▌         | 1/20 [01:09<11:29, 36.28s/it]                 
Task 1, Epoch 2/20 => Loss 1.599, Train_accy 87.10:  10%|█         | 2/20 [01:09<10:21, 34.54s/it]
Task 1, Epoch 3/20 => Loss 1.556, Train_accy 88.01:  10%|█         | 2/20 [01:42<10:21, 34.54s/it]
Task 1, Epoch 3/20 => Loss 1.556, Train_accy 88.01:  15%|█▌        | 3/20 [01:42<09:37, 33.96s/it]
Task 1, Epoch 4/20 => Loss 1.527, Train_accy 88.21:  15%|█▌        | 3/20 [02:16<09:37, 33.96s/it]
Task 1, Epoch 4/20 => Loss 1.527, Train_accy 88.21:  20%|██        | 4/20 [02:16<08:59, 33.72s/it]
Task 1, Epoch 5/20 => Loss 1.502, Train_accy 90.03:  20%|██        | 4/20 [02:49<08:59, 33.72s/it]
Task 1, Epoch 5/20 => Loss 1.502, Train_accy 90.03:  25%|██▌       | 5/20 [02:49<08:23, 33.59s/it]
Task 1, Epoch 6/20 => Loss 1.480, Train_accy 90.17, Test_accy 95.65:  25%|██▌       | 5/20 [03:25<08:23, 33.59s/it]
Task 1, Epoch 6/20 => Loss 1.480, Train_accy 90.17, Test_accy 95.65:  30%|███       | 6/20 [03:25<08:03, 34.55s/it]
Task 1, Epoch 7/20 => Loss 1.488, Train_accy 89.81:  30%|███       | 6/20 [03:59<08:03, 34.55s/it]                 
Task 1, Epoch 7/20 => Loss 1.488, Train_accy 89.81:  35%|███▌      | 7/20 [03:59<07:24, 34.16s/it]
Task 1, Epoch 8/20 => Loss 1.463, Train_accy 90.80:  35%|███▌      | 7/20 [04:32<07:24, 34.16s/it]
Task 1, Epoch 8/20 => Loss 1.463, Train_accy 90.80:  40%|████      | 8/20 [04:32<06:46, 33.88s/it]
Task 1, Epoch 9/20 => Loss 1.455, Train_accy 91.36:  40%|████      | 8/20 [05:05<06:46, 33.88s/it]
Task 1, Epoch 9/20 => Loss 1.455, Train_accy 91.36:  45%|████▌     | 9/20 [05:05<06:10, 33.72s/it]
Task 1, Epoch 10/20 => Loss 1.428, Train_accy 91.47:  45%|████▌     | 9/20 [05:39<06:10, 33.72s/it]
Task 1, Epoch 10/20 => Loss 1.428, Train_accy 91.47:  50%|█████     | 10/20 [05:39<05:36, 33.61s/it]
Task 1, Epoch 11/20 => Loss 1.431, Train_accy 91.61, Test_accy 96.20:  50%|█████     | 10/20 [06:15<05:36, 33.61s/it]
Task 1, Epoch 11/20 => Loss 1.431, Train_accy 91.61, Test_accy 96.20:  55%|█████▌    | 11/20 [06:15<05:10, 34.48s/it]
Task 1, Epoch 12/20 => Loss 1.428, Train_accy 91.86:  55%|█████▌    | 11/20 [06:49<05:10, 34.48s/it]                 
Task 1, Epoch 12/20 => Loss 1.428, Train_accy 91.86:  60%|██████    | 12/20 [06:49<04:33, 34.14s/it]
Task 1, Epoch 13/20 => Loss 1.429, Train_accy 91.89:  60%|██████    | 12/20 [07:22<04:33, 34.14s/it]
Task 1, Epoch 13/20 => Loss 1.429, Train_accy 91.89:  65%|██████▌   | 13/20 [07:22<03:57, 33.87s/it]
Task 1, Epoch 14/20 => Loss 1.438, Train_accy 91.37:  65%|██████▌   | 13/20 [07:55<03:57, 33.87s/it]
Task 1, Epoch 14/20 => Loss 1.438, Train_accy 91.37:  70%|███████   | 14/20 [07:55<03:22, 33.69s/it]
Task 1, Epoch 15/20 => Loss 1.432, Train_accy 91.56:  70%|███████   | 14/20 [08:28<03:22, 33.69s/it]
Task 1, Epoch 15/20 => Loss 1.432, Train_accy 91.56:  75%|███████▌  | 15/20 [08:28<02:47, 33.56s/it]
Task 1, Epoch 16/20 => Loss 1.396, Train_accy 92.76, Test_accy 95.90:  75%|███████▌  | 15/20 [09:05<02:47, 33.56s/it]
Task 1, Epoch 16/20 => Loss 1.396, Train_accy 92.76, Test_accy 95.90:  80%|████████  | 16/20 [09:05<02:17, 34.37s/it]
Task 1, Epoch 17/20 => Loss 1.411, Train_accy 91.90:  80%|████████  | 16/20 [09:38<02:17, 34.37s/it]                 
Task 1, Epoch 17/20 => Loss 1.411, Train_accy 91.90:  85%|████████▌ | 17/20 [09:38<01:42, 34.19s/it]
Task 1, Epoch 18/20 => Loss 1.406, Train_accy 92.33:  85%|████████▌ | 17/20 [10:12<01:42, 34.19s/it]
Task 1, Epoch 18/20 => Loss 1.406, Train_accy 92.33:  90%|█████████ | 18/20 [10:12<01:08, 34.04s/it]
Task 1, Epoch 19/20 => Loss 1.390, Train_accy 92.47:  90%|█████████ | 18/20 [10:46<01:08, 34.04s/it]
Task 1, Epoch 19/20 => Loss 1.390, Train_accy 92.47:  95%|█████████▌| 19/20 [10:46<00:33, 33.97s/it]
Task 1, Epoch 20/20 => Loss 1.379, Train_accy 92.97:  95%|█████████▌| 19/20 [11:20<00:33, 33.97s/it]
Task 1, Epoch 20/20 => Loss 1.379, Train_accy 92.97: 100%|██████████| 20/20 [11:20<00:00, 33.88s/it]
Task 1, Epoch 20/20 => Loss 1.379, Train_accy 92.97: 100%|██████████| 20/20 [11:20<00:00, 34.01s/it]
2024-08-17 23:13:31,731 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.379, Train_accy 92.97
2024-08-17 23:13:31,732 [base.py] => Reducing exemplars...(100 per classes)
2024-08-17 23:13:35,438 [base.py] => Constructing exemplars...(100 per classes)
2024-08-17 23:13:55,978 [icarl.py] => Exemplar size: 2000
2024-08-17 23:13:55,978 [trainer.py] => CNN: {'total': 96.25, '00-09': 95.6, '10-19': 96.9, 'old': 95.6, 'new': 96.9}
2024-08-17 23:13:55,979 [trainer.py] => NME: {'total': 96.35, '00-09': 97.1, '10-19': 95.6, 'old': 97.1, 'new': 95.6}
2024-08-17 23:13:55,979 [trainer.py] => CNN top1 curve: [98.2, 96.25]
2024-08-17 23:13:55,979 [trainer.py] => CNN top5 curve: [100.0, 99.7]
2024-08-17 23:13:55,979 [trainer.py] => NME top1 curve: [98.6, 96.35]
2024-08-17 23:13:55,979 [trainer.py] => NME top5 curve: [99.9, 99.7]

Average Accuracy (CNN): 97.22
Average Accuracy (NME): 97.48
2024-08-17 23:13:55,979 [trainer.py] => Average Accuracy (CNN): 97.22
2024-08-17 23:13:55,979 [trainer.py] => Average Accuracy (NME): 97.48
2024-08-17 23:13:55,979 [trainer.py] => Train Time: 0
2024-08-17 23:13:55,979 [trainer.py] => Test Time: 9.61 

2024-08-17 23:13:55,979 [trainer.py] => All params: 85814036
2024-08-17 23:13:55,980 [trainer.py] => Trainable params: 85814036
2024-08-17 23:13:55,981 [icarl.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.199, Train_accy 81.00, Test_accy 93.47:   0%|          | 0/20 [00:37<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.199, Train_accy 81.00, Test_accy 93.47:   5%|▌         | 1/20 [00:37<11:58, 37.81s/it]
Task 2, Epoch 2/20 => Loss 1.727, Train_accy 90.24:   5%|▌         | 1/20 [01:11<11:58, 37.81s/it]                 
Task 2, Epoch 2/20 => Loss 1.727, Train_accy 90.24:  10%|█         | 2/20 [01:11<10:32, 35.14s/it]
Task 2, Epoch 3/20 => Loss 1.696, Train_accy 91.30:  10%|█         | 2/20 [01:44<10:32, 35.14s/it]
Task 2, Epoch 3/20 => Loss 1.696, Train_accy 91.30:  15%|█▌        | 3/20 [01:44<09:42, 34.29s/it]
Task 2, Epoch 4/20 => Loss 1.667, Train_accy 91.74:  15%|█▌        | 3/20 [02:17<09:42, 34.29s/it]
Task 2, Epoch 4/20 => Loss 1.667, Train_accy 91.74:  20%|██        | 4/20 [02:17<09:02, 33.91s/it]
Task 2, Epoch 5/20 => Loss 1.705, Train_accy 91.40:  20%|██        | 4/20 [02:51<09:02, 33.91s/it]
Task 2, Epoch 5/20 => Loss 1.705, Train_accy 91.40:  25%|██▌       | 5/20 [02:51<08:25, 33.71s/it]
Task 2, Epoch 6/20 => Loss 1.663, Train_accy 91.99, Test_accy 93.20:  25%|██▌       | 5/20 [03:29<08:25, 33.71s/it]
Task 2, Epoch 6/20 => Loss 1.663, Train_accy 91.99, Test_accy 93.20:  30%|███       | 6/20 [03:29<08:12, 35.19s/it]
Task 2, Epoch 7/20 => Loss 1.649, Train_accy 92.76:  30%|███       | 6/20 [04:02<08:12, 35.19s/it]                 
Task 2, Epoch 7/20 => Loss 1.649, Train_accy 92.76:  35%|███▌      | 7/20 [04:02<07:29, 34.61s/it]
Task 2, Epoch 8/20 => Loss 1.659, Train_accy 92.73:  35%|███▌      | 7/20 [04:35<07:29, 34.61s/it]
Task 2, Epoch 8/20 => Loss 1.659, Train_accy 92.73:  40%|████      | 8/20 [04:35<06:50, 34.21s/it]
Task 2, Epoch 9/20 => Loss 1.635, Train_accy 93.04:  40%|████      | 8/20 [05:09<06:50, 34.21s/it]
Task 2, Epoch 9/20 => Loss 1.635, Train_accy 93.04:  45%|████▌     | 9/20 [05:09<06:13, 33.93s/it]
Task 2, Epoch 10/20 => Loss 1.604, Train_accy 93.66:  45%|████▌     | 9/20 [05:42<06:13, 33.93s/it]
Task 2, Epoch 10/20 => Loss 1.604, Train_accy 93.66:  50%|█████     | 10/20 [05:42<05:38, 33.83s/it]
Task 2, Epoch 11/20 => Loss 1.613, Train_accy 93.81, Test_accy 94.90:  50%|█████     | 10/20 [06:20<05:38, 33.83s/it]
Task 2, Epoch 11/20 => Loss 1.613, Train_accy 93.81, Test_accy 94.90:  55%|█████▌    | 11/20 [06:20<05:15, 35.07s/it]
Task 2, Epoch 12/20 => Loss 1.591, Train_accy 93.74:  55%|█████▌    | 11/20 [06:54<05:15, 35.07s/it]                 
Task 2, Epoch 12/20 => Loss 1.591, Train_accy 93.74:  60%|██████    | 12/20 [06:54<04:36, 34.55s/it]
Task 2, Epoch 13/20 => Loss 1.616, Train_accy 93.44:  60%|██████    | 12/20 [07:27<04:36, 34.55s/it]
Task 2, Epoch 13/20 => Loss 1.616, Train_accy 93.44:  65%|██████▌   | 13/20 [07:27<03:59, 34.27s/it]
Task 2, Epoch 14/20 => Loss 1.617, Train_accy 93.36:  65%|██████▌   | 13/20 [08:00<03:59, 34.27s/it]
Task 2, Epoch 14/20 => Loss 1.617, Train_accy 93.36:  70%|███████   | 14/20 [08:00<03:23, 33.98s/it]
Task 2, Epoch 15/20 => Loss 1.613, Train_accy 93.67:  70%|███████   | 14/20 [08:34<03:23, 33.98s/it]
Task 2, Epoch 15/20 => Loss 1.613, Train_accy 93.67:  75%|███████▌  | 15/20 [08:34<02:49, 33.81s/it]
Task 2, Epoch 16/20 => Loss 1.591, Train_accy 93.89, Test_accy 94.03:  75%|███████▌  | 15/20 [09:12<02:49, 33.81s/it]
Task 2, Epoch 16/20 => Loss 1.591, Train_accy 93.89, Test_accy 94.03:  80%|████████  | 16/20 [09:12<02:20, 35.03s/it]
Task 2, Epoch 17/20 => Loss 1.589, Train_accy 93.91:  80%|████████  | 16/20 [09:45<02:20, 35.03s/it]                 
Task 2, Epoch 17/20 => Loss 1.589, Train_accy 93.91:  85%|████████▌ | 17/20 [09:45<01:43, 34.56s/it]
Task 2, Epoch 18/20 => Loss 1.598, Train_accy 93.67:  85%|████████▌ | 17/20 [10:19<01:43, 34.56s/it]
Task 2, Epoch 18/20 => Loss 1.598, Train_accy 93.67:  90%|█████████ | 18/20 [10:19<01:08, 34.18s/it]
Task 2, Epoch 19/20 => Loss 1.581, Train_accy 93.77:  90%|█████████ | 18/20 [10:52<01:08, 34.18s/it]
Task 2, Epoch 19/20 => Loss 1.581, Train_accy 93.77:  95%|█████████▌| 19/20 [10:52<00:33, 33.96s/it]
Task 2, Epoch 20/20 => Loss 1.588, Train_accy 94.07:  95%|█████████▌| 19/20 [11:25<00:33, 33.96s/it]
Task 2, Epoch 20/20 => Loss 1.588, Train_accy 94.07: 100%|██████████| 20/20 [11:25<00:00, 33.77s/it]
Task 2, Epoch 20/20 => Loss 1.588, Train_accy 94.07: 100%|██████████| 20/20 [11:25<00:00, 34.29s/it]
2024-08-17 23:25:21,876 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.588, Train_accy 94.07
2024-08-17 23:25:21,877 [base.py] => Reducing exemplars...(66 per classes)
2024-08-17 23:25:28,826 [base.py] => Constructing exemplars...(66 per classes)
2024-08-17 23:25:51,492 [icarl.py] => Exemplar size: 1980
2024-08-17 23:25:51,492 [trainer.py] => CNN: {'total': 93.73, '00-09': 91.7, '10-19': 90.8, '20-29': 98.7, 'old': 91.25, 'new': 98.7}
2024-08-17 23:25:51,492 [trainer.py] => NME: {'total': 94.9, '00-09': 94.5, '10-19': 93.1, '20-29': 97.1, 'old': 93.8, 'new': 97.1}
2024-08-17 23:25:51,492 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73]
2024-08-17 23:25:51,492 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37]
2024-08-17 23:25:51,492 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9]
2024-08-17 23:25:51,492 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5]

Average Accuracy (CNN): 96.06
Average Accuracy (NME): 96.62
2024-08-17 23:25:51,492 [trainer.py] => Average Accuracy (CNN): 96.06
2024-08-17 23:25:51,492 [trainer.py] => Average Accuracy (NME): 96.62
2024-08-17 23:25:51,492 [trainer.py] => Train Time: 0
2024-08-17 23:25:51,492 [trainer.py] => Test Time: 18.729999999999997 

2024-08-17 23:25:51,493 [trainer.py] => All params: 85821726
2024-08-17 23:25:51,493 [trainer.py] => Trainable params: 85821726
2024-08-17 23:25:51,494 [icarl.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.492, Train_accy 78.48, Test_accy 88.95:   0%|          | 0/20 [00:39<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.492, Train_accy 78.48, Test_accy 88.95:   5%|▌         | 1/20 [00:39<12:31, 39.54s/it]
Task 3, Epoch 2/20 => Loss 1.922, Train_accy 88.14:   5%|▌         | 1/20 [01:13<12:31, 39.54s/it]                 
Task 3, Epoch 2/20 => Loss 1.922, Train_accy 88.14:  10%|█         | 2/20 [01:13<10:48, 36.03s/it]
Task 3, Epoch 3/20 => Loss 1.897, Train_accy 89.15:  10%|█         | 2/20 [01:46<10:48, 36.03s/it]
Task 3, Epoch 3/20 => Loss 1.897, Train_accy 89.15:  15%|█▌        | 3/20 [01:46<09:53, 34.88s/it]
Task 3, Epoch 4/20 => Loss 1.848, Train_accy 90.17:  15%|█▌        | 3/20 [02:20<09:53, 34.88s/it]
Task 3, Epoch 4/20 => Loss 1.848, Train_accy 90.17:  20%|██        | 4/20 [02:20<09:10, 34.38s/it]
Task 3, Epoch 5/20 => Loss 1.841, Train_accy 90.67:  20%|██        | 4/20 [02:53<09:10, 34.38s/it]
Task 3, Epoch 5/20 => Loss 1.841, Train_accy 90.67:  25%|██▌       | 5/20 [02:53<08:31, 34.08s/it]
Task 3, Epoch 6/20 => Loss 1.831, Train_accy 91.05, Test_accy 91.60:  25%|██▌       | 5/20 [03:33<08:31, 34.08s/it]
Task 3, Epoch 6/20 => Loss 1.831, Train_accy 91.05, Test_accy 91.60:  30%|███       | 6/20 [03:33<08:22, 35.92s/it]
Task 3, Epoch 7/20 => Loss 1.812, Train_accy 91.72:  30%|███       | 6/20 [04:06<08:22, 35.92s/it]                 
Task 3, Epoch 7/20 => Loss 1.812, Train_accy 91.72:  35%|███▌      | 7/20 [04:06<07:36, 35.13s/it]
Task 3, Epoch 8/20 => Loss 1.801, Train_accy 92.25:  35%|███▌      | 7/20 [04:40<07:36, 35.13s/it]
Task 3, Epoch 8/20 => Loss 1.801, Train_accy 92.25:  40%|████      | 8/20 [04:40<06:55, 34.62s/it]
Task 3, Epoch 9/20 => Loss 1.814, Train_accy 91.63:  40%|████      | 8/20 [05:13<06:55, 34.62s/it]
Task 3, Epoch 9/20 => Loss 1.814, Train_accy 91.63:  45%|████▌     | 9/20 [05:13<06:17, 34.29s/it]
Task 3, Epoch 10/20 => Loss 1.815, Train_accy 92.15:  45%|████▌     | 9/20 [05:47<06:17, 34.29s/it]
Task 3, Epoch 10/20 => Loss 1.815, Train_accy 92.15:  50%|█████     | 10/20 [05:47<05:40, 34.07s/it]
Task 3, Epoch 11/20 => Loss 1.802, Train_accy 92.46, Test_accy 89.75:  50%|█████     | 10/20 [06:27<05:40, 34.07s/it]
Task 3, Epoch 11/20 => Loss 1.802, Train_accy 92.46, Test_accy 89.75:  55%|█████▌    | 11/20 [06:27<05:21, 35.76s/it]
Task 3, Epoch 12/20 => Loss 1.785, Train_accy 92.58:  55%|█████▌    | 11/20 [07:00<05:21, 35.76s/it]                 
Task 3, Epoch 12/20 => Loss 1.785, Train_accy 92.58:  60%|██████    | 12/20 [07:00<04:40, 35.06s/it]
Task 3, Epoch 13/20 => Loss 1.772, Train_accy 93.15:  60%|██████    | 12/20 [07:34<04:40, 35.06s/it]
Task 3, Epoch 13/20 => Loss 1.772, Train_accy 93.15:  65%|██████▌   | 13/20 [07:34<04:02, 34.60s/it]
Task 3, Epoch 14/20 => Loss 1.770, Train_accy 92.81:  65%|██████▌   | 13/20 [08:07<04:02, 34.60s/it]
Task 3, Epoch 14/20 => Loss 1.770, Train_accy 92.81:  70%|███████   | 14/20 [08:07<03:25, 34.26s/it]
Task 3, Epoch 15/20 => Loss 1.772, Train_accy 92.92:  70%|███████   | 14/20 [08:41<03:25, 34.26s/it]
Task 3, Epoch 15/20 => Loss 1.772, Train_accy 92.92:  75%|███████▌  | 15/20 [08:41<02:50, 34.05s/it]
Task 3, Epoch 16/20 => Loss 1.770, Train_accy 93.32, Test_accy 91.00:  75%|███████▌  | 15/20 [09:20<02:50, 34.05s/it]
Task 3, Epoch 16/20 => Loss 1.770, Train_accy 93.32, Test_accy 91.00:  80%|████████  | 16/20 [09:20<02:22, 35.72s/it]
Task 3, Epoch 17/20 => Loss 1.731, Train_accy 93.54:  80%|████████  | 16/20 [09:54<02:22, 35.72s/it]                 
Task 3, Epoch 17/20 => Loss 1.731, Train_accy 93.54:  85%|████████▌ | 17/20 [09:54<01:45, 35.06s/it]
Task 3, Epoch 18/20 => Loss 1.769, Train_accy 93.35:  85%|████████▌ | 17/20 [10:27<01:45, 35.06s/it]
Task 3, Epoch 18/20 => Loss 1.769, Train_accy 93.35:  90%|█████████ | 18/20 [10:27<01:09, 34.60s/it]
Task 3, Epoch 19/20 => Loss 1.755, Train_accy 93.22:  90%|█████████ | 18/20 [11:01<01:09, 34.60s/it]
Task 3, Epoch 19/20 => Loss 1.755, Train_accy 93.22:  95%|█████████▌| 19/20 [11:01<00:34, 34.26s/it]
Task 3, Epoch 20/20 => Loss 1.763, Train_accy 93.12:  95%|█████████▌| 19/20 [11:34<00:34, 34.26s/it]
Task 3, Epoch 20/20 => Loss 1.763, Train_accy 93.12: 100%|██████████| 20/20 [11:34<00:00, 34.06s/it]
Task 3, Epoch 20/20 => Loss 1.763, Train_accy 93.12: 100%|██████████| 20/20 [11:34<00:00, 34.74s/it]
2024-08-17 23:37:26,347 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.763, Train_accy 93.12
2024-08-17 23:37:26,348 [base.py] => Reducing exemplars...(50 per classes)
2024-08-17 23:37:34,353 [base.py] => Constructing exemplars...(50 per classes)
2024-08-17 23:37:59,014 [icarl.py] => Exemplar size: 2000
2024-08-17 23:37:59,015 [trainer.py] => CNN: {'total': 90.95, '00-09': 86.3, '10-19': 87.4, '20-29': 94.4, '30-39': 95.7, 'old': 89.37, 'new': 95.7}
2024-08-17 23:37:59,015 [trainer.py] => NME: {'total': 92.48, '00-09': 92.1, '10-19': 89.9, '20-29': 94.5, '30-39': 93.4, 'old': 92.17, 'new': 93.4}
2024-08-17 23:37:59,015 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73, 90.95]
2024-08-17 23:37:59,015 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37, 98.85]
2024-08-17 23:37:59,015 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9, 92.48]
2024-08-17 23:37:59,015 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5, 99.3]

Average Accuracy (CNN): 94.78
Average Accuracy (NME): 95.58
2024-08-17 23:37:59,015 [trainer.py] => Average Accuracy (CNN): 94.78
2024-08-17 23:37:59,015 [trainer.py] => Average Accuracy (NME): 95.58
2024-08-17 23:37:59,015 [trainer.py] => Train Time: 0
2024-08-17 23:37:59,015 [trainer.py] => Test Time: 30.83 

2024-08-17 23:37:59,015 [trainer.py] => All params: 85829416
2024-08-17 23:37:59,016 [trainer.py] => Trainable params: 85829416
2024-08-17 23:37:59,017 [icarl.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.535, Train_accy 80.59, Test_accy 85.86:   0%|          | 0/20 [00:40<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.535, Train_accy 80.59, Test_accy 85.86:   5%|▌         | 1/20 [00:40<12:58, 40.99s/it]
Task 4, Epoch 2/20 => Loss 1.938, Train_accy 89.50:   5%|▌         | 1/20 [01:14<12:58, 40.99s/it]                 
Task 4, Epoch 2/20 => Loss 1.938, Train_accy 89.50:  10%|█         | 2/20 [01:14<10:59, 36.65s/it]
Task 4, Epoch 3/20 => Loss 1.923, Train_accy 90.60:  10%|█         | 2/20 [01:48<10:59, 36.65s/it]
Task 4, Epoch 3/20 => Loss 1.923, Train_accy 90.60:  15%|█▌        | 3/20 [01:48<09:59, 35.25s/it]
Task 4, Epoch 4/20 => Loss 1.869, Train_accy 91.23:  15%|█▌        | 3/20 [02:21<09:59, 35.25s/it]
Task 4, Epoch 4/20 => Loss 1.869, Train_accy 91.23:  20%|██        | 4/20 [02:21<09:13, 34.58s/it]
Task 4, Epoch 5/20 => Loss 1.852, Train_accy 92.04:  20%|██        | 4/20 [02:55<09:13, 34.58s/it]
Task 4, Epoch 5/20 => Loss 1.852, Train_accy 92.04:  25%|██▌       | 5/20 [02:55<08:33, 34.21s/it]
Task 4, Epoch 6/20 => Loss 1.850, Train_accy 92.33, Test_accy 87.84:  25%|██▌       | 5/20 [03:36<08:33, 34.21s/it]
Task 4, Epoch 6/20 => Loss 1.850, Train_accy 92.33, Test_accy 87.84:  30%|███       | 6/20 [03:36<08:31, 36.52s/it]
Task 4, Epoch 7/20 => Loss 1.840, Train_accy 92.20:  30%|███       | 6/20 [04:09<08:31, 36.52s/it]                 
Task 4, Epoch 7/20 => Loss 1.840, Train_accy 92.20:  35%|███▌      | 7/20 [04:09<07:42, 35.60s/it]
Task 4, Epoch 8/20 => Loss 1.815, Train_accy 93.11:  35%|███▌      | 7/20 [04:43<07:42, 35.60s/it]
Task 4, Epoch 8/20 => Loss 1.815, Train_accy 93.11:  40%|████      | 8/20 [04:43<06:59, 34.94s/it]
Task 4, Epoch 9/20 => Loss 1.828, Train_accy 92.57:  40%|████      | 8/20 [05:17<06:59, 34.94s/it]
Task 4, Epoch 9/20 => Loss 1.828, Train_accy 92.57:  45%|████▌     | 9/20 [05:17<06:19, 34.50s/it]
Task 4, Epoch 10/20 => Loss 1.840, Train_accy 92.70:  45%|████▌     | 9/20 [05:50<06:19, 34.50s/it]
Task 4, Epoch 10/20 => Loss 1.840, Train_accy 92.70:  50%|█████     | 10/20 [05:50<05:41, 34.20s/it]
Task 4, Epoch 11/20 => Loss 1.807, Train_accy 93.09, Test_accy 88.66:  50%|█████     | 10/20 [06:31<05:41, 34.20s/it]
Task 4, Epoch 11/20 => Loss 1.807, Train_accy 93.09, Test_accy 88.66:  55%|█████▌    | 11/20 [06:31<05:26, 36.31s/it]
Task 4, Epoch 12/20 => Loss 1.811, Train_accy 92.99:  55%|█████▌    | 11/20 [07:05<05:26, 36.31s/it]                 
Task 4, Epoch 12/20 => Loss 1.811, Train_accy 92.99:  60%|██████    | 12/20 [07:05<04:44, 35.51s/it]
Task 4, Epoch 13/20 => Loss 1.805, Train_accy 93.30:  60%|██████    | 12/20 [07:38<04:44, 35.51s/it]
Task 4, Epoch 13/20 => Loss 1.805, Train_accy 93.30:  65%|██████▌   | 13/20 [07:38<04:04, 34.91s/it]
Task 4, Epoch 14/20 => Loss 1.809, Train_accy 93.50:  65%|██████▌   | 13/20 [08:12<04:04, 34.91s/it]
Task 4, Epoch 14/20 => Loss 1.809, Train_accy 93.50:  70%|███████   | 14/20 [08:12<03:27, 34.53s/it]
Task 4, Epoch 15/20 => Loss 1.772, Train_accy 94.24:  70%|███████   | 14/20 [08:46<03:27, 34.53s/it]
Task 4, Epoch 15/20 => Loss 1.772, Train_accy 94.24:  75%|███████▌  | 15/20 [08:46<02:51, 34.26s/it]
Task 4, Epoch 16/20 => Loss 1.773, Train_accy 94.17, Test_accy 88.40:  75%|███████▌  | 15/20 [09:27<02:51, 34.26s/it]
Task 4, Epoch 16/20 => Loss 1.773, Train_accy 94.17, Test_accy 88.40:  80%|████████  | 16/20 [09:27<02:25, 36.34s/it]
Task 4, Epoch 17/20 => Loss 1.775, Train_accy 94.04:  80%|████████  | 16/20 [10:00<02:25, 36.34s/it]                 
Task 4, Epoch 17/20 => Loss 1.775, Train_accy 94.04:  85%|████████▌ | 17/20 [10:00<01:46, 35.53s/it]
Task 4, Epoch 18/20 => Loss 1.770, Train_accy 94.49:  85%|████████▌ | 17/20 [10:34<01:46, 35.53s/it]
Task 4, Epoch 18/20 => Loss 1.770, Train_accy 94.49:  90%|█████████ | 18/20 [10:34<01:09, 34.97s/it]
Task 4, Epoch 19/20 => Loss 1.779, Train_accy 94.57:  90%|█████████ | 18/20 [11:08<01:09, 34.97s/it]
Task 4, Epoch 19/20 => Loss 1.779, Train_accy 94.57:  95%|█████████▌| 19/20 [11:08<00:34, 34.55s/it]
Task 4, Epoch 20/20 => Loss 1.791, Train_accy 94.24:  95%|█████████▌| 19/20 [11:41<00:34, 34.55s/it]
Task 4, Epoch 20/20 => Loss 1.791, Train_accy 94.24: 100%|██████████| 20/20 [11:41<00:00, 34.24s/it]
Task 4, Epoch 20/20 => Loss 1.791, Train_accy 94.24: 100%|██████████| 20/20 [11:41<00:00, 35.09s/it]
2024-08-17 23:49:40,828 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.791, Train_accy 94.24
2024-08-17 23:49:40,829 [base.py] => Reducing exemplars...(40 per classes)
2024-08-17 23:49:50,049 [base.py] => Constructing exemplars...(40 per classes)
2024-08-17 23:50:17,058 [icarl.py] => Exemplar size: 2000
2024-08-17 23:50:17,059 [trainer.py] => CNN: {'total': 86.54, '00-09': 81.4, '10-19': 75.5, '20-29': 89.9, '30-39': 87.5, '40-49': 98.4, 'old': 83.58, 'new': 98.4}
2024-08-17 23:50:17,059 [trainer.py] => NME: {'total': 90.5, '00-09': 90.0, '10-19': 85.3, '20-29': 92.8, '30-39': 89.3, '40-49': 95.1, 'old': 89.35, 'new': 95.1}
2024-08-17 23:50:17,059 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73, 90.95, 86.54]
2024-08-17 23:50:17,059 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37, 98.85, 98.14]
2024-08-17 23:50:17,059 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9, 92.48, 90.5]
2024-08-17 23:50:17,059 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5, 99.3, 99.04]

Average Accuracy (CNN): 93.13
Average Accuracy (NME): 94.57
2024-08-17 23:50:17,059 [trainer.py] => Average Accuracy (CNN): 93.13
2024-08-17 23:50:17,059 [trainer.py] => Average Accuracy (NME): 94.57
2024-08-17 23:50:17,059 [trainer.py] => Train Time: 0
2024-08-17 23:50:17,059 [trainer.py] => Test Time: 45.81 

2024-08-17 23:50:17,059 [trainer.py] => All params: 85837106
2024-08-17 23:50:17,060 [trainer.py] => Trainable params: 85837106
2024-08-17 23:50:17,061 [icarl.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.877, Train_accy 77.94, Test_accy 83.90:   0%|          | 0/20 [00:42<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.877, Train_accy 77.94, Test_accy 83.90:   5%|▌         | 1/20 [00:42<13:25, 42.42s/it]
Task 5, Epoch 2/20 => Loss 2.301, Train_accy 88.66:   5%|▌         | 1/20 [01:16<13:25, 42.42s/it]                 
Task 5, Epoch 2/20 => Loss 2.301, Train_accy 88.66:  10%|█         | 2/20 [01:16<11:11, 37.29s/it]
Task 5, Epoch 3/20 => Loss 2.219, Train_accy 90.20:  10%|█         | 2/20 [01:49<11:11, 37.29s/it]
Task 5, Epoch 3/20 => Loss 2.219, Train_accy 90.20:  15%|█▌        | 3/20 [01:49<10:05, 35.64s/it]
Task 5, Epoch 4/20 => Loss 2.229, Train_accy 90.54:  15%|█▌        | 3/20 [02:23<10:05, 35.64s/it]
Task 5, Epoch 4/20 => Loss 2.229, Train_accy 90.54:  20%|██        | 4/20 [02:23<09:17, 34.83s/it]
Task 5, Epoch 5/20 => Loss 2.185, Train_accy 91.40:  20%|██        | 4/20 [02:56<09:17, 34.83s/it]
Task 5, Epoch 5/20 => Loss 2.185, Train_accy 91.40:  25%|██▌       | 5/20 [02:56<08:35, 34.36s/it]
Task 5, Epoch 6/20 => Loss 2.192, Train_accy 91.33, Test_accy 84.23:  25%|██▌       | 5/20 [03:39<08:35, 34.36s/it]
Task 5, Epoch 6/20 => Loss 2.192, Train_accy 91.33, Test_accy 84.23:  30%|███       | 6/20 [03:39<08:38, 37.07s/it]
Task 5, Epoch 7/20 => Loss 2.187, Train_accy 91.33:  30%|███       | 6/20 [04:12<08:38, 37.07s/it]                 
Task 5, Epoch 7/20 => Loss 2.187, Train_accy 91.33:  35%|███▌      | 7/20 [04:12<07:46, 35.91s/it]
Task 5, Epoch 8/20 => Loss 2.172, Train_accy 92.03:  35%|███▌      | 7/20 [04:46<07:46, 35.91s/it]
Task 5, Epoch 8/20 => Loss 2.172, Train_accy 92.03:  40%|████      | 8/20 [04:46<07:01, 35.14s/it]
Task 5, Epoch 9/20 => Loss 2.148, Train_accy 92.21:  40%|████      | 8/20 [05:19<07:01, 35.14s/it]
Task 5, Epoch 9/20 => Loss 2.148, Train_accy 92.21:  45%|████▌     | 9/20 [05:19<06:21, 34.64s/it]
Task 5, Epoch 10/20 => Loss 2.139, Train_accy 92.84:  45%|████▌     | 9/20 [05:53<06:21, 34.64s/it]
Task 5, Epoch 10/20 => Loss 2.139, Train_accy 92.84:  50%|█████     | 10/20 [05:53<05:43, 34.31s/it]
Task 5, Epoch 11/20 => Loss 2.127, Train_accy 93.01, Test_accy 84.98:  50%|█████     | 10/20 [06:35<05:43, 34.31s/it]
Task 5, Epoch 11/20 => Loss 2.127, Train_accy 93.01, Test_accy 84.98:  55%|█████▌    | 11/20 [06:35<05:31, 36.80s/it]
Task 5, Epoch 12/20 => Loss 2.157, Train_accy 92.59:  55%|█████▌    | 11/20 [07:09<05:31, 36.80s/it]                 
Task 5, Epoch 12/20 => Loss 2.157, Train_accy 92.59:  60%|██████    | 12/20 [07:09<04:46, 35.82s/it]
Task 5, Epoch 13/20 => Loss 2.121, Train_accy 93.36:  60%|██████    | 12/20 [07:43<04:46, 35.82s/it]
Task 5, Epoch 13/20 => Loss 2.121, Train_accy 93.36:  65%|██████▌   | 13/20 [07:43<04:06, 35.16s/it]
Task 5, Epoch 14/20 => Loss 2.114, Train_accy 93.44:  65%|██████▌   | 13/20 [08:16<04:06, 35.16s/it]
Task 5, Epoch 14/20 => Loss 2.114, Train_accy 93.44:  70%|███████   | 14/20 [08:16<03:28, 34.69s/it]
Task 5, Epoch 15/20 => Loss 2.103, Train_accy 93.69:  70%|███████   | 14/20 [08:50<03:28, 34.69s/it]
Task 5, Epoch 15/20 => Loss 2.103, Train_accy 93.69:  75%|███████▌  | 15/20 [08:50<02:51, 34.39s/it]
Task 5, Epoch 16/20 => Loss 2.154, Train_accy 92.67, Test_accy 84.60:  75%|███████▌  | 15/20 [09:32<02:51, 34.39s/it]
Task 5, Epoch 16/20 => Loss 2.154, Train_accy 92.67, Test_accy 84.60:  80%|████████  | 16/20 [09:32<02:27, 36.82s/it]
Task 5, Epoch 17/20 => Loss 2.100, Train_accy 93.44:  80%|████████  | 16/20 [10:06<02:27, 36.82s/it]                 
Task 5, Epoch 17/20 => Loss 2.100, Train_accy 93.44:  85%|████████▌ | 17/20 [10:06<01:47, 35.84s/it]
Task 5, Epoch 18/20 => Loss 2.140, Train_accy 93.01:  85%|████████▌ | 17/20 [10:39<01:47, 35.84s/it]
Task 5, Epoch 18/20 => Loss 2.140, Train_accy 93.01:  90%|█████████ | 18/20 [10:39<01:10, 35.15s/it]
Task 5, Epoch 19/20 => Loss 2.097, Train_accy 94.14:  90%|█████████ | 18/20 [11:13<01:10, 35.15s/it]
Task 5, Epoch 19/20 => Loss 2.097, Train_accy 94.14:  95%|█████████▌| 19/20 [11:13<00:34, 34.67s/it]
Task 5, Epoch 20/20 => Loss 2.110, Train_accy 93.71:  95%|█████████▌| 19/20 [11:47<00:34, 34.67s/it]
Task 5, Epoch 20/20 => Loss 2.110, Train_accy 93.71: 100%|██████████| 20/20 [11:47<00:00, 34.35s/it]
Task 5, Epoch 20/20 => Loss 2.110, Train_accy 93.71: 100%|██████████| 20/20 [11:47<00:00, 35.35s/it]
2024-08-18 00:02:04,179 [icarl.py] => Task 5, Epoch 20/20 => Loss 2.110, Train_accy 93.71
2024-08-18 00:02:04,181 [base.py] => Reducing exemplars...(33 per classes)
2024-08-18 00:02:14,947 [base.py] => Constructing exemplars...(33 per classes)
2024-08-18 00:02:44,695 [icarl.py] => Exemplar size: 1980
2024-08-18 00:02:44,695 [trainer.py] => CNN: {'total': 85.15, '00-09': 80.6, '10-19': 73.7, '20-29': 86.0, '30-39': 83.6, '40-49': 91.1, '50-59': 95.9, 'old': 83.0, 'new': 95.9}
2024-08-18 00:02:44,695 [trainer.py] => NME: {'total': 89.62, '00-09': 89.5, '10-19': 84.6, '20-29': 91.6, '30-39': 87.8, '40-49': 92.7, '50-59': 91.5, 'old': 89.24, 'new': 91.5}
2024-08-18 00:02:44,695 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73, 90.95, 86.54, 85.15]
2024-08-18 00:02:44,695 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37, 98.85, 98.14, 97.23]
2024-08-18 00:02:44,695 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9, 92.48, 90.5, 89.62]
2024-08-18 00:02:44,695 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5, 99.3, 99.04, 98.85]

Average Accuracy (CNN): 91.8
Average Accuracy (NME): 93.74
2024-08-18 00:02:44,695 [trainer.py] => Average Accuracy (CNN): 91.8
2024-08-18 00:02:44,695 [trainer.py] => Average Accuracy (NME): 93.74
2024-08-18 00:02:44,695 [trainer.py] => Train Time: 0
2024-08-18 00:02:44,695 [trainer.py] => Test Time: 63.72 

2024-08-18 00:02:44,696 [trainer.py] => All params: 85844796
2024-08-18 00:02:44,696 [trainer.py] => Trainable params: 85844796
2024-08-18 00:02:44,697 [icarl.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.886, Train_accy 81.16, Test_accy 83.37:   0%|          | 0/20 [00:43<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.886, Train_accy 81.16, Test_accy 83.37:   5%|▌         | 1/20 [00:43<13:53, 43.87s/it]
Task 6, Epoch 2/20 => Loss 2.245, Train_accy 90.36:   5%|▌         | 1/20 [01:17<13:53, 43.87s/it]                 
Task 6, Epoch 2/20 => Loss 2.245, Train_accy 90.36:  10%|█         | 2/20 [01:17<11:20, 37.78s/it]
Task 6, Epoch 3/20 => Loss 2.165, Train_accy 92.12:  10%|█         | 2/20 [01:50<11:20, 37.78s/it]
Task 6, Epoch 3/20 => Loss 2.165, Train_accy 92.12:  15%|█▌        | 3/20 [01:50<10:09, 35.84s/it]
Task 6, Epoch 4/20 => Loss 2.142, Train_accy 92.59:  15%|█▌        | 3/20 [02:24<10:09, 35.84s/it]
Task 6, Epoch 4/20 => Loss 2.142, Train_accy 92.59:  20%|██        | 4/20 [02:24<09:19, 34.94s/it]
Task 6, Epoch 5/20 => Loss 2.165, Train_accy 92.46:  20%|██        | 4/20 [02:57<09:19, 34.94s/it]
Task 6, Epoch 5/20 => Loss 2.165, Train_accy 92.46:  25%|██▌       | 5/20 [02:57<08:36, 34.43s/it]
Task 6, Epoch 6/20 => Loss 2.110, Train_accy 93.04, Test_accy 84.07:  25%|██▌       | 5/20 [03:41<08:36, 34.43s/it]
Task 6, Epoch 6/20 => Loss 2.110, Train_accy 93.04, Test_accy 84.07:  30%|███       | 6/20 [03:41<08:46, 37.59s/it]
Task 6, Epoch 7/20 => Loss 2.097, Train_accy 93.72:  30%|███       | 6/20 [04:15<08:46, 37.59s/it]                 
Task 6, Epoch 7/20 => Loss 2.097, Train_accy 93.72:  35%|███▌      | 7/20 [04:15<07:51, 36.28s/it]
Task 6, Epoch 8/20 => Loss 2.113, Train_accy 93.78:  35%|███▌      | 7/20 [04:48<07:51, 36.28s/it]
Task 6, Epoch 8/20 => Loss 2.113, Train_accy 93.78:  40%|████      | 8/20 [04:48<07:04, 35.38s/it]
Task 6, Epoch 9/20 => Loss 2.071, Train_accy 94.13:  40%|████      | 8/20 [05:22<07:04, 35.38s/it]
Task 6, Epoch 9/20 => Loss 2.071, Train_accy 94.13:  45%|████▌     | 9/20 [05:22<06:22, 34.77s/it]
Task 6, Epoch 10/20 => Loss 2.103, Train_accy 93.85:  45%|████▌     | 9/20 [05:55<06:22, 34.77s/it]
Task 6, Epoch 10/20 => Loss 2.103, Train_accy 93.85:  50%|█████     | 10/20 [05:55<05:43, 34.35s/it]
Task 6, Epoch 11/20 => Loss 2.100, Train_accy 93.87, Test_accy 82.93:  50%|█████     | 10/20 [06:39<05:43, 34.35s/it]
Task 6, Epoch 11/20 => Loss 2.100, Train_accy 93.87, Test_accy 82.93:  55%|█████▌    | 11/20 [06:39<05:35, 37.25s/it]
Task 6, Epoch 12/20 => Loss 2.091, Train_accy 94.30:  55%|█████▌    | 11/20 [07:12<05:35, 37.25s/it]                 
Task 6, Epoch 12/20 => Loss 2.091, Train_accy 94.30:  60%|██████    | 12/20 [07:12<04:48, 36.12s/it]
Task 6, Epoch 13/20 => Loss 2.119, Train_accy 94.04:  60%|██████    | 12/20 [07:46<04:48, 36.12s/it]
Task 6, Epoch 13/20 => Loss 2.119, Train_accy 94.04:  65%|██████▌   | 13/20 [07:46<04:07, 35.35s/it]
Task 6, Epoch 14/20 => Loss 2.093, Train_accy 93.84:  65%|██████▌   | 13/20 [08:20<04:07, 35.35s/it]
Task 6, Epoch 14/20 => Loss 2.093, Train_accy 93.84:  70%|███████   | 14/20 [08:20<03:28, 34.79s/it]
Task 6, Epoch 15/20 => Loss 2.084, Train_accy 94.03:  70%|███████   | 14/20 [08:53<03:28, 34.79s/it]
Task 6, Epoch 15/20 => Loss 2.084, Train_accy 94.03:  75%|███████▌  | 15/20 [08:53<02:51, 34.40s/it]
Task 6, Epoch 16/20 => Loss 2.040, Train_accy 94.86, Test_accy 84.33:  75%|███████▌  | 15/20 [09:37<02:51, 34.40s/it]
Task 6, Epoch 16/20 => Loss 2.040, Train_accy 94.86, Test_accy 84.33:  80%|████████  | 16/20 [09:37<02:29, 37.26s/it]
Task 6, Epoch 17/20 => Loss 2.075, Train_accy 94.57:  80%|████████  | 16/20 [10:10<02:29, 37.26s/it]                 
Task 6, Epoch 17/20 => Loss 2.075, Train_accy 94.57:  85%|████████▌ | 17/20 [10:10<01:48, 36.15s/it]
Task 6, Epoch 18/20 => Loss 2.068, Train_accy 95.01:  85%|████████▌ | 17/20 [10:44<01:48, 36.15s/it]
Task 6, Epoch 18/20 => Loss 2.068, Train_accy 95.01:  90%|█████████ | 18/20 [10:44<01:10, 35.36s/it]
Task 6, Epoch 19/20 => Loss 2.058, Train_accy 94.81:  90%|█████████ | 18/20 [11:18<01:10, 35.36s/it]
Task 6, Epoch 19/20 => Loss 2.058, Train_accy 94.81:  95%|█████████▌| 19/20 [11:18<00:34, 34.83s/it]
Task 6, Epoch 20/20 => Loss 2.074, Train_accy 94.53:  95%|█████████▌| 19/20 [11:51<00:34, 34.83s/it]
Task 6, Epoch 20/20 => Loss 2.074, Train_accy 94.53: 100%|██████████| 20/20 [11:51<00:00, 34.46s/it]
Task 6, Epoch 20/20 => Loss 2.074, Train_accy 94.53: 100%|██████████| 20/20 [11:51<00:00, 35.59s/it]
2024-08-18 00:14:36,461 [icarl.py] => Task 6, Epoch 20/20 => Loss 2.074, Train_accy 94.53
2024-08-18 00:14:36,462 [base.py] => Reducing exemplars...(28 per classes)
2024-08-18 00:14:48,069 [base.py] => Constructing exemplars...(28 per classes)
2024-08-18 00:15:20,514 [icarl.py] => Exemplar size: 1960
2024-08-18 00:15:20,514 [trainer.py] => CNN: {'total': 83.66, '00-09': 76.0, '10-19': 70.6, '20-29': 85.3, '30-39': 81.0, '40-49': 89.7, '50-59': 84.5, '60-69': 98.5, 'old': 81.18, 'new': 98.5}
2024-08-18 00:15:20,515 [trainer.py] => NME: {'total': 88.07, '00-09': 86.5, '10-19': 82.1, '20-29': 90.8, '30-39': 85.5, '40-49': 91.4, '50-59': 85.6, '60-69': 94.6, 'old': 86.98, 'new': 94.6}
2024-08-18 00:15:20,515 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73, 90.95, 86.54, 85.15, 83.66]
2024-08-18 00:15:20,515 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37, 98.85, 98.14, 97.23, 96.54]
2024-08-18 00:15:20,515 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9, 92.48, 90.5, 89.62, 88.07]
2024-08-18 00:15:20,515 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5, 99.3, 99.04, 98.85, 98.53]

Average Accuracy (CNN): 90.64
Average Accuracy (NME): 92.93
2024-08-18 00:15:20,515 [trainer.py] => Average Accuracy (CNN): 90.64
2024-08-18 00:15:20,515 [trainer.py] => Average Accuracy (NME): 92.93
2024-08-18 00:15:20,515 [trainer.py] => Train Time: 0
2024-08-18 00:15:20,515 [trainer.py] => Test Time: 84.35 

2024-08-18 00:15:20,515 [trainer.py] => All params: 85852486
2024-08-18 00:15:20,516 [trainer.py] => Trainable params: 85852486
2024-08-18 00:15:20,517 [icarl.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.726, Train_accy 78.02, Test_accy 77.12:   0%|          | 0/20 [00:45<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.726, Train_accy 78.02, Test_accy 77.12:   5%|▌         | 1/20 [00:45<14:19, 45.24s/it]
Task 7, Epoch 2/20 => Loss 2.050, Train_accy 88.41:   5%|▌         | 1/20 [01:18<14:19, 45.24s/it]                 
Task 7, Epoch 2/20 => Loss 2.050, Train_accy 88.41:  10%|█         | 2/20 [01:18<11:30, 38.36s/it]
Task 7, Epoch 3/20 => Loss 2.019, Train_accy 89.70:  10%|█         | 2/20 [01:52<11:30, 38.36s/it]
Task 7, Epoch 3/20 => Loss 2.019, Train_accy 89.70:  15%|█▌        | 3/20 [01:52<10:14, 36.16s/it]
Task 7, Epoch 4/20 => Loss 1.998, Train_accy 90.55:  15%|█▌        | 3/20 [02:25<10:14, 36.16s/it]
Task 7, Epoch 4/20 => Loss 1.998, Train_accy 90.55:  20%|██        | 4/20 [02:25<09:20, 35.06s/it]
Task 7, Epoch 5/20 => Loss 1.973, Train_accy 91.35:  20%|██        | 4/20 [02:59<09:20, 35.06s/it]
Task 7, Epoch 5/20 => Loss 1.973, Train_accy 91.35:  25%|██▌       | 5/20 [02:59<08:36, 34.44s/it]
Task 7, Epoch 6/20 => Loss 1.986, Train_accy 91.67, Test_accy 76.82:  25%|██▌       | 5/20 [03:44<08:36, 34.44s/it]
Task 7, Epoch 6/20 => Loss 1.986, Train_accy 91.67, Test_accy 76.82:  30%|███       | 6/20 [03:44<08:53, 38.11s/it]
Task 7, Epoch 7/20 => Loss 1.945, Train_accy 92.04:  30%|███       | 6/20 [04:17<08:53, 38.11s/it]                 
Task 7, Epoch 7/20 => Loss 1.945, Train_accy 92.04:  35%|███▌      | 7/20 [04:17<07:55, 36.56s/it]
Task 7, Epoch 8/20 => Loss 1.942, Train_accy 92.59:  35%|███▌      | 7/20 [04:51<07:55, 36.56s/it]
Task 7, Epoch 8/20 => Loss 1.942, Train_accy 92.59:  40%|████      | 8/20 [04:51<07:07, 35.59s/it]
Task 7, Epoch 9/20 => Loss 1.955, Train_accy 92.50:  40%|████      | 8/20 [05:24<07:07, 35.59s/it]
Task 7, Epoch 9/20 => Loss 1.955, Train_accy 92.50:  45%|████▌     | 9/20 [05:24<06:24, 34.93s/it]
Task 7, Epoch 10/20 => Loss 1.903, Train_accy 92.89:  45%|████▌     | 9/20 [05:58<06:24, 34.93s/it]
Task 7, Epoch 10/20 => Loss 1.903, Train_accy 92.89:  50%|█████     | 10/20 [05:58<05:44, 34.50s/it]
Task 7, Epoch 11/20 => Loss 1.908, Train_accy 93.05, Test_accy 78.62:  50%|█████     | 10/20 [06:43<05:44, 34.50s/it]
Task 7, Epoch 11/20 => Loss 1.908, Train_accy 93.05, Test_accy 78.62:  55%|█████▌    | 11/20 [06:43<05:39, 37.76s/it]
Task 7, Epoch 12/20 => Loss 1.892, Train_accy 93.49:  55%|█████▌    | 11/20 [07:16<05:39, 37.76s/it]                 
Task 7, Epoch 12/20 => Loss 1.892, Train_accy 93.49:  60%|██████    | 12/20 [07:16<04:51, 36.46s/it]
Task 7, Epoch 13/20 => Loss 1.925, Train_accy 93.36:  60%|██████    | 12/20 [07:50<04:51, 36.46s/it]
Task 7, Epoch 13/20 => Loss 1.925, Train_accy 93.36:  65%|██████▌   | 13/20 [07:50<04:09, 35.57s/it]
Task 7, Epoch 14/20 => Loss 1.901, Train_accy 93.42:  65%|██████▌   | 13/20 [08:23<04:09, 35.57s/it]
Task 7, Epoch 14/20 => Loss 1.901, Train_accy 93.42:  70%|███████   | 14/20 [08:23<03:29, 34.93s/it]
Task 7, Epoch 15/20 => Loss 1.907, Train_accy 93.32:  70%|███████   | 14/20 [08:57<03:29, 34.93s/it]
Task 7, Epoch 15/20 => Loss 1.907, Train_accy 93.32:  75%|███████▌  | 15/20 [08:57<02:52, 34.46s/it]
Task 7, Epoch 16/20 => Loss 1.901, Train_accy 93.51, Test_accy 77.40:  75%|███████▌  | 15/20 [09:42<02:52, 34.46s/it]
Task 7, Epoch 16/20 => Loss 1.901, Train_accy 93.51, Test_accy 77.40:  80%|████████  | 16/20 [09:42<02:30, 37.70s/it]
Task 7, Epoch 17/20 => Loss 1.906, Train_accy 93.78:  80%|████████  | 16/20 [10:15<02:30, 37.70s/it]                 
Task 7, Epoch 17/20 => Loss 1.906, Train_accy 93.78:  85%|████████▌ | 17/20 [10:15<01:49, 36.41s/it]
Task 7, Epoch 18/20 => Loss 1.922, Train_accy 93.74:  85%|████████▌ | 17/20 [10:49<01:49, 36.41s/it]
Task 7, Epoch 18/20 => Loss 1.922, Train_accy 93.74:  90%|█████████ | 18/20 [10:49<01:11, 35.53s/it]
Task 7, Epoch 19/20 => Loss 1.884, Train_accy 94.30:  90%|█████████ | 18/20 [11:22<01:11, 35.53s/it]
Task 7, Epoch 19/20 => Loss 1.884, Train_accy 94.30:  95%|█████████▌| 19/20 [11:22<00:34, 34.94s/it]
Task 7, Epoch 20/20 => Loss 1.869, Train_accy 94.54:  95%|█████████▌| 19/20 [11:56<00:34, 34.94s/it]
Task 7, Epoch 20/20 => Loss 1.869, Train_accy 94.54: 100%|██████████| 20/20 [11:56<00:00, 34.52s/it]
Task 7, Epoch 20/20 => Loss 1.869, Train_accy 94.54: 100%|██████████| 20/20 [11:56<00:00, 35.82s/it]
2024-08-18 00:27:16,944 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.869, Train_accy 94.54
2024-08-18 00:27:16,945 [base.py] => Reducing exemplars...(25 per classes)
2024-08-18 00:27:29,839 [base.py] => Constructing exemplars...(25 per classes)
2024-08-18 00:28:05,557 [icarl.py] => Exemplar size: 2000
2024-08-18 00:28:05,557 [trainer.py] => CNN: {'total': 77.92, '00-09': 73.0, '10-19': 67.2, '20-29': 83.6, '30-39': 73.8, '40-49': 79.1, '50-59': 65.3, '60-69': 85.7, '70-79': 95.7, 'old': 75.39, 'new': 95.7}
2024-08-18 00:28:05,557 [trainer.py] => NME: {'total': 85.26, '00-09': 84.6, '10-19': 79.8, '20-29': 90.1, '30-39': 83.8, '40-49': 87.6, '50-59': 77.7, '60-69': 88.9, '70-79': 89.6, 'old': 84.64, 'new': 89.6}
2024-08-18 00:28:05,557 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73, 90.95, 86.54, 85.15, 83.66, 77.92]
2024-08-18 00:28:05,557 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37, 98.85, 98.14, 97.23, 96.54, 95.38]
2024-08-18 00:28:05,557 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9, 92.48, 90.5, 89.62, 88.07, 85.26]
2024-08-18 00:28:05,557 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5, 99.3, 99.04, 98.85, 98.53, 98.39]

Average Accuracy (CNN): 89.05
Average Accuracy (NME): 91.97
2024-08-18 00:28:05,557 [trainer.py] => Average Accuracy (CNN): 89.05
2024-08-18 00:28:05,557 [trainer.py] => Average Accuracy (NME): 91.97
2024-08-18 00:28:05,557 [trainer.py] => Train Time: 0
2024-08-18 00:28:05,557 [trainer.py] => Test Time: 108.33 

2024-08-18 00:28:05,558 [trainer.py] => All params: 85860176
2024-08-18 00:28:05,558 [trainer.py] => Trainable params: 85860176
2024-08-18 00:28:05,559 [icarl.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.033, Train_accy 78.67, Test_accy 75.01:   0%|          | 0/20 [00:46<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.033, Train_accy 78.67, Test_accy 75.01:   5%|▌         | 1/20 [00:46<14:50, 46.88s/it]
Task 8, Epoch 2/20 => Loss 2.357, Train_accy 89.14:   5%|▌         | 1/20 [01:20<14:50, 46.88s/it]                 
Task 8, Epoch 2/20 => Loss 2.357, Train_accy 89.14:  10%|█         | 2/20 [01:20<11:43, 39.09s/it]
Task 8, Epoch 3/20 => Loss 2.320, Train_accy 90.79:  10%|█         | 2/20 [01:54<11:43, 39.09s/it]
Task 8, Epoch 3/20 => Loss 2.320, Train_accy 90.79:  15%|█▌        | 3/20 [01:54<10:22, 36.59s/it]
Task 8, Epoch 4/20 => Loss 2.281, Train_accy 91.69:  15%|█▌        | 3/20 [02:27<10:22, 36.59s/it]
Task 8, Epoch 4/20 => Loss 2.281, Train_accy 91.69:  20%|██        | 4/20 [02:27<09:26, 35.42s/it]
Task 8, Epoch 5/20 => Loss 2.267, Train_accy 92.23:  20%|██        | 4/20 [03:01<09:26, 35.42s/it]
Task 8, Epoch 5/20 => Loss 2.267, Train_accy 92.23:  25%|██▌       | 5/20 [03:01<08:42, 34.82s/it]
Task 8, Epoch 6/20 => Loss 2.244, Train_accy 92.51, Test_accy 74.11:  25%|██▌       | 5/20 [03:48<08:42, 34.82s/it]
Task 8, Epoch 6/20 => Loss 2.244, Train_accy 92.51, Test_accy 74.11:  30%|███       | 6/20 [03:48<09:05, 38.93s/it]
Task 8, Epoch 7/20 => Loss 2.245, Train_accy 92.27:  30%|███       | 6/20 [04:22<09:05, 38.93s/it]                 
Task 8, Epoch 7/20 => Loss 2.245, Train_accy 92.27:  35%|███▌      | 7/20 [04:22<08:03, 37.21s/it]
Task 8, Epoch 8/20 => Loss 2.242, Train_accy 92.99:  35%|███▌      | 7/20 [04:55<08:03, 37.21s/it]
Task 8, Epoch 8/20 => Loss 2.242, Train_accy 92.99:  40%|████      | 8/20 [04:55<07:12, 36.04s/it]
Task 8, Epoch 9/20 => Loss 2.253, Train_accy 92.93:  40%|████      | 8/20 [05:29<07:12, 36.04s/it]
Task 8, Epoch 9/20 => Loss 2.253, Train_accy 92.93:  45%|████▌     | 9/20 [05:29<06:27, 35.26s/it]
Task 8, Epoch 10/20 => Loss 2.196, Train_accy 93.19:  45%|████▌     | 9/20 [06:02<06:27, 35.26s/it]
Task 8, Epoch 10/20 => Loss 2.196, Train_accy 93.19:  50%|█████     | 10/20 [06:02<05:47, 34.75s/it]
Task 8, Epoch 11/20 => Loss 2.206, Train_accy 93.70, Test_accy 74.88:  50%|█████     | 10/20 [06:49<05:47, 34.75s/it]
Task 8, Epoch 11/20 => Loss 2.206, Train_accy 93.70, Test_accy 74.88:  55%|█████▌    | 11/20 [06:49<05:46, 38.52s/it]
Task 8, Epoch 12/20 => Loss 2.230, Train_accy 93.39:  55%|█████▌    | 11/20 [07:23<05:46, 38.52s/it]                 
Task 8, Epoch 12/20 => Loss 2.230, Train_accy 93.39:  60%|██████    | 12/20 [07:23<04:56, 37.04s/it]
Task 8, Epoch 13/20 => Loss 2.221, Train_accy 93.39:  60%|██████    | 12/20 [07:57<04:56, 37.04s/it]
Task 8, Epoch 13/20 => Loss 2.221, Train_accy 93.39:  65%|██████▌   | 13/20 [07:57<04:12, 36.03s/it]
Task 8, Epoch 14/20 => Loss 2.176, Train_accy 94.30:  65%|██████▌   | 13/20 [08:30<04:12, 36.03s/it]
Task 8, Epoch 14/20 => Loss 2.176, Train_accy 94.30:  70%|███████   | 14/20 [08:30<03:31, 35.31s/it]
Task 8, Epoch 15/20 => Loss 2.220, Train_accy 93.46:  70%|███████   | 14/20 [09:04<03:31, 35.31s/it]
Task 8, Epoch 15/20 => Loss 2.220, Train_accy 93.46:  75%|███████▌  | 15/20 [09:04<02:53, 34.79s/it]
Task 8, Epoch 16/20 => Loss 2.208, Train_accy 93.63, Test_accy 75.81:  75%|███████▌  | 15/20 [09:51<02:53, 34.79s/it]
Task 8, Epoch 16/20 => Loss 2.208, Train_accy 93.63, Test_accy 75.81:  80%|████████  | 16/20 [09:51<02:33, 38.40s/it]
Task 8, Epoch 17/20 => Loss 2.218, Train_accy 94.21:  80%|████████  | 16/20 [10:24<02:33, 38.40s/it]                 
Task 8, Epoch 17/20 => Loss 2.218, Train_accy 94.21:  85%|████████▌ | 17/20 [10:24<01:50, 36.97s/it]
Task 8, Epoch 18/20 => Loss 2.173, Train_accy 94.14:  85%|████████▌ | 17/20 [10:58<01:50, 36.97s/it]
Task 8, Epoch 18/20 => Loss 2.173, Train_accy 94.14:  90%|█████████ | 18/20 [10:58<01:11, 35.94s/it]
Task 8, Epoch 19/20 => Loss 2.178, Train_accy 94.39:  90%|█████████ | 18/20 [11:31<01:11, 35.94s/it]
Task 8, Epoch 19/20 => Loss 2.178, Train_accy 94.39:  95%|█████████▌| 19/20 [11:31<00:35, 35.22s/it]
Task 8, Epoch 20/20 => Loss 2.153, Train_accy 94.59:  95%|█████████▌| 19/20 [12:05<00:35, 35.22s/it]
Task 8, Epoch 20/20 => Loss 2.153, Train_accy 94.59: 100%|██████████| 20/20 [12:05<00:00, 34.71s/it]
Task 8, Epoch 20/20 => Loss 2.153, Train_accy 94.59: 100%|██████████| 20/20 [12:05<00:00, 36.27s/it]
2024-08-18 00:40:11,118 [icarl.py] => Task 8, Epoch 20/20 => Loss 2.153, Train_accy 94.59
2024-08-18 00:40:11,119 [base.py] => Reducing exemplars...(22 per classes)
2024-08-18 00:40:25,205 [base.py] => Constructing exemplars...(22 per classes)
2024-08-18 00:41:03,692 [icarl.py] => Exemplar size: 1980
2024-08-18 00:41:03,692 [trainer.py] => CNN: {'total': 73.16, '00-09': 69.0, '10-19': 54.6, '20-29': 74.0, '30-39': 67.7, '40-49': 68.3, '50-59': 63.7, '60-69': 77.9, '70-79': 86.6, '80-89': 96.6, 'old': 70.22, 'new': 96.6}
2024-08-18 00:41:03,692 [trainer.py] => NME: {'total': 83.7, '00-09': 82.6, '10-19': 75.5, '20-29': 87.5, '30-39': 82.6, '40-49': 85.1, '50-59': 76.3, '60-69': 87.1, '70-79': 86.5, '80-89': 90.1, 'old': 82.9, 'new': 90.1}
2024-08-18 00:41:03,692 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73, 90.95, 86.54, 85.15, 83.66, 77.92, 73.16]
2024-08-18 00:41:03,692 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37, 98.85, 98.14, 97.23, 96.54, 95.38, 93.49]
2024-08-18 00:41:03,692 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9, 92.48, 90.5, 89.62, 88.07, 85.26, 83.7]
2024-08-18 00:41:03,692 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5, 99.3, 99.04, 98.85, 98.53, 98.39, 97.63]

Average Accuracy (CNN): 87.28
Average Accuracy (NME): 91.05
2024-08-18 00:41:03,692 [trainer.py] => Average Accuracy (CNN): 87.28
2024-08-18 00:41:03,692 [trainer.py] => Average Accuracy (NME): 91.05
2024-08-18 00:41:03,692 [trainer.py] => Train Time: 0
2024-08-18 00:41:03,692 [trainer.py] => Test Time: 134.95 

2024-08-18 00:41:03,693 [trainer.py] => All params: 85867866
2024-08-18 00:41:03,693 [trainer.py] => Trainable params: 85867866
2024-08-18 00:41:03,694 [icarl.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.194, Train_accy 79.05, Test_accy 71.65:   0%|          | 0/20 [00:48<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.194, Train_accy 79.05, Test_accy 71.65:   5%|▌         | 1/20 [00:48<15:16, 48.21s/it]
Task 9, Epoch 2/20 => Loss 2.479, Train_accy 89.26:   5%|▌         | 1/20 [01:21<15:16, 48.21s/it]                 
Task 9, Epoch 2/20 => Loss 2.479, Train_accy 89.26:  10%|█         | 2/20 [01:21<11:52, 39.60s/it]
Task 9, Epoch 3/20 => Loss 2.428, Train_accy 90.80:  10%|█         | 2/20 [01:55<11:52, 39.60s/it]
Task 9, Epoch 3/20 => Loss 2.428, Train_accy 90.80:  15%|█▌        | 3/20 [01:55<10:26, 36.83s/it]
Task 9, Epoch 4/20 => Loss 2.412, Train_accy 91.12:  15%|█▌        | 3/20 [02:28<10:26, 36.83s/it]
Task 9, Epoch 4/20 => Loss 2.412, Train_accy 91.12:  20%|██        | 4/20 [02:28<09:28, 35.54s/it]
Task 9, Epoch 5/20 => Loss 2.383, Train_accy 92.19:  20%|██        | 4/20 [03:02<09:28, 35.54s/it]
Task 9, Epoch 5/20 => Loss 2.383, Train_accy 92.19:  25%|██▌       | 5/20 [03:02<08:42, 34.82s/it]
Task 9, Epoch 6/20 => Loss 2.387, Train_accy 92.22, Test_accy 71.37:  25%|██▌       | 5/20 [03:50<08:42, 34.82s/it]
Task 9, Epoch 6/20 => Loss 2.387, Train_accy 92.22, Test_accy 71.37:  30%|███       | 6/20 [03:50<09:11, 39.39s/it]
Task 9, Epoch 7/20 => Loss 2.353, Train_accy 92.34:  30%|███       | 6/20 [04:24<09:11, 39.39s/it]                 
Task 9, Epoch 7/20 => Loss 2.353, Train_accy 92.34:  35%|███▌      | 7/20 [04:24<08:07, 37.48s/it]
Task 9, Epoch 8/20 => Loss 2.357, Train_accy 92.81:  35%|███▌      | 7/20 [04:57<08:07, 37.48s/it]
Task 9, Epoch 8/20 => Loss 2.357, Train_accy 92.81:  40%|████      | 8/20 [04:57<07:14, 36.24s/it]
Task 9, Epoch 9/20 => Loss 2.348, Train_accy 92.91:  40%|████      | 8/20 [05:31<07:14, 36.24s/it]
Task 9, Epoch 9/20 => Loss 2.348, Train_accy 92.91:  45%|████▌     | 9/20 [05:31<06:29, 35.40s/it]
Task 9, Epoch 10/20 => Loss 2.345, Train_accy 93.27:  45%|████▌     | 9/20 [06:04<06:29, 35.40s/it]
Task 9, Epoch 10/20 => Loss 2.345, Train_accy 93.27:  50%|█████     | 10/20 [06:04<05:48, 34.84s/it]
Task 9, Epoch 11/20 => Loss 2.345, Train_accy 93.61, Test_accy 72.37:  50%|█████     | 10/20 [06:53<05:48, 34.84s/it]
Task 9, Epoch 11/20 => Loss 2.345, Train_accy 93.61, Test_accy 72.37:  55%|█████▌    | 11/20 [06:53<05:50, 38.96s/it]
Task 9, Epoch 12/20 => Loss 2.302, Train_accy 93.68:  55%|█████▌    | 11/20 [07:26<05:50, 38.96s/it]                 
Task 9, Epoch 12/20 => Loss 2.302, Train_accy 93.68:  60%|██████    | 12/20 [07:26<04:58, 37.35s/it]
Task 9, Epoch 13/20 => Loss 2.323, Train_accy 93.81:  60%|██████    | 12/20 [08:00<04:58, 37.35s/it]
Task 9, Epoch 13/20 => Loss 2.323, Train_accy 93.81:  65%|██████▌   | 13/20 [08:00<04:13, 36.20s/it]
Task 9, Epoch 14/20 => Loss 2.337, Train_accy 93.25:  65%|██████▌   | 13/20 [08:34<04:13, 36.20s/it]
Task 9, Epoch 14/20 => Loss 2.337, Train_accy 93.25:  70%|███████   | 14/20 [08:34<03:32, 35.41s/it]
Task 9, Epoch 15/20 => Loss 2.317, Train_accy 93.83:  70%|███████   | 14/20 [09:07<03:32, 35.41s/it]
Task 9, Epoch 15/20 => Loss 2.317, Train_accy 93.83:  75%|███████▌  | 15/20 [09:07<02:54, 34.85s/it]
Task 9, Epoch 16/20 => Loss 2.300, Train_accy 94.14, Test_accy 72.29:  75%|███████▌  | 15/20 [09:55<02:54, 34.85s/it]
Task 9, Epoch 16/20 => Loss 2.300, Train_accy 94.14, Test_accy 72.29:  80%|████████  | 16/20 [09:55<02:35, 38.91s/it]
Task 9, Epoch 17/20 => Loss 2.340, Train_accy 93.62:  80%|████████  | 16/20 [10:29<02:35, 38.91s/it]                 
Task 9, Epoch 17/20 => Loss 2.340, Train_accy 93.62:  85%|████████▌ | 17/20 [10:29<01:52, 37.34s/it]
Task 9, Epoch 18/20 => Loss 2.300, Train_accy 94.63:  85%|████████▌ | 17/20 [11:03<01:52, 37.34s/it]
Task 9, Epoch 18/20 => Loss 2.300, Train_accy 94.63:  90%|█████████ | 18/20 [11:03<01:12, 36.24s/it]
Task 9, Epoch 19/20 => Loss 2.299, Train_accy 94.48:  90%|█████████ | 18/20 [11:36<01:12, 36.24s/it]
Task 9, Epoch 19/20 => Loss 2.299, Train_accy 94.48:  95%|█████████▌| 19/20 [11:36<00:35, 35.45s/it]
Task 9, Epoch 20/20 => Loss 2.287, Train_accy 94.46:  95%|█████████▌| 19/20 [12:10<00:35, 35.45s/it]
Task 9, Epoch 20/20 => Loss 2.287, Train_accy 94.46: 100%|██████████| 20/20 [12:10<00:00, 34.90s/it]
Task 9, Epoch 20/20 => Loss 2.287, Train_accy 94.46: 100%|██████████| 20/20 [12:10<00:00, 36.53s/it]
2024-08-18 00:53:14,309 [icarl.py] => Task 9, Epoch 20/20 => Loss 2.287, Train_accy 94.46
2024-08-18 00:53:14,310 [base.py] => Reducing exemplars...(20 per classes)
2024-08-18 00:53:29,630 [base.py] => Constructing exemplars...(20 per classes)
2024-08-18 00:54:11,258 [icarl.py] => Exemplar size: 2000
2024-08-18 00:54:11,258 [trainer.py] => CNN: {'total': 71.8, '00-09': 63.6, '10-19': 56.2, '20-29': 72.2, '30-39': 63.2, '40-49': 66.4, '50-59': 57.5, '60-69': 75.6, '70-79': 77.1, '80-89': 90.4, '90-99': 95.8, 'old': 69.13, 'new': 95.8}
2024-08-18 00:54:11,258 [trainer.py] => NME: {'total': 82.69, '00-09': 80.5, '10-19': 74.3, '20-29': 86.6, '30-39': 80.4, '40-49': 84.2, '50-59': 73.9, '60-69': 86.3, '70-79': 82.4, '80-89': 88.7, '90-99': 89.6, 'old': 81.92, 'new': 89.6}
2024-08-18 00:54:11,258 [trainer.py] => CNN top1 curve: [98.2, 96.25, 93.73, 90.95, 86.54, 85.15, 83.66, 77.92, 73.16, 71.8]
2024-08-18 00:54:11,258 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.37, 98.85, 98.14, 97.23, 96.54, 95.38, 93.49, 91.61]
2024-08-18 00:54:11,258 [trainer.py] => NME top1 curve: [98.6, 96.35, 94.9, 92.48, 90.5, 89.62, 88.07, 85.26, 83.7, 82.69]
2024-08-18 00:54:11,258 [trainer.py] => NME top5 curve: [99.9, 99.7, 99.5, 99.3, 99.04, 98.85, 98.53, 98.39, 97.63, 97.06]

Average Accuracy (CNN): 85.74
Average Accuracy (NME): 90.22
2024-08-18 00:54:11,258 [trainer.py] => Average Accuracy (CNN): 85.74
2024-08-18 00:54:11,258 [trainer.py] => Average Accuracy (NME): 90.22
2024-08-18 00:54:11,258 [trainer.py] => Train Time: 0
2024-08-18 00:54:11,258 [trainer.py] => Test Time: 164.83999999999997 

Accuracy Matrix (CNN):
[[98.2 95.6 91.7 86.3 81.4 80.6 76.  73.  69.  63.6]
 [ 0.  96.9 90.8 87.4 75.5 73.7 70.6 67.2 54.6 56.2]
 [ 0.   0.  98.7 94.4 89.9 86.  85.3 83.6 74.  72.2]
 [ 0.   0.   0.  95.7 87.5 83.6 81.  73.8 67.7 63.2]
 [ 0.   0.   0.   0.  98.4 91.1 89.7 79.1 68.3 66.4]
 [ 0.   0.   0.   0.   0.  95.9 84.5 65.3 63.7 57.5]
 [ 0.   0.   0.   0.   0.   0.  98.5 85.7 77.9 75.6]
 [ 0.   0.   0.   0.   0.   0.   0.  95.7 86.6 77.1]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  96.6 90.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  95.8]]
2024-08-18 00:54:11,259 [trainer.py] => Forgetting (CNN): 28.044444444444448
Accuracy Matrix (NME):
[[98.6 97.1 94.5 92.1 90.  89.5 86.5 84.6 82.6 80.5]
 [ 0.  95.6 93.1 89.9 85.3 84.6 82.1 79.8 75.5 74.3]
 [ 0.   0.  97.1 94.5 92.8 91.6 90.8 90.1 87.5 86.6]
 [ 0.   0.   0.  93.4 89.3 87.8 85.5 83.8 82.6 80.4]
 [ 0.   0.   0.   0.  95.1 92.7 91.4 87.6 85.1 84.2]
 [ 0.   0.   0.   0.   0.  91.5 85.6 77.7 76.3 73.9]
 [ 0.   0.   0.   0.   0.   0.  94.6 88.9 87.1 86.3]
 [ 0.   0.   0.   0.   0.   0.   0.  89.6 86.5 82.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  90.1 88.7]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  89.6]]
2024-08-18 00:54:11,260 [trainer.py] => Forgetting (NME): 12.033333333333328
2024-08-18 00:54:13,230 [trainer.py] => config: ./exps/icarl_cifar_B0_Inc20.json
2024-08-18 00:54:13,230 [trainer.py] => prefix: reproduce
2024-08-18 00:54:13,230 [trainer.py] => dataset: cifar224
2024-08-18 00:54:13,230 [trainer.py] => memory_size: 2000
2024-08-18 00:54:13,230 [trainer.py] => memory_per_class: 20
2024-08-18 00:54:13,230 [trainer.py] => fixed_memory: False
2024-08-18 00:54:13,230 [trainer.py] => shuffle: True
2024-08-18 00:54:13,230 [trainer.py] => init_cls: 5
2024-08-18 00:54:13,230 [trainer.py] => increment: 5
2024-08-18 00:54:13,230 [trainer.py] => model_name: icarl
2024-08-18 00:54:13,230 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-08-18 00:54:13,230 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-18 00:54:13,230 [trainer.py] => seed: 1993
2024-08-18 00:54:13,230 [trainer.py] => init_epoch: 20
2024-08-18 00:54:13,230 [trainer.py] => init_lr: 0.001
2024-08-18 00:54:13,230 [trainer.py] => init_milestones: [60, 120, 170]
2024-08-18 00:54:13,231 [trainer.py] => init_lr_decay: 0.1
2024-08-18 00:54:13,231 [trainer.py] => init_weight_decay: 0.0005
2024-08-18 00:54:13,231 [trainer.py] => epochs: 20
2024-08-18 00:54:13,231 [trainer.py] => lrate: 0.001
2024-08-18 00:54:13,231 [trainer.py] => milestones: [80, 120]
2024-08-18 00:54:13,231 [trainer.py] => lrate_decay: 0.1
2024-08-18 00:54:13,231 [trainer.py] => batch_size: 48
2024-08-18 00:54:13,231 [trainer.py] => weight_decay: 0.0002
2024-08-18 00:54:13,231 [trainer.py] => T: 2
2024-08-18 00:54:14,167 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-08-18 00:54:16,186 [trainer.py] => All params: 85798656
2024-08-18 00:54:16,187 [trainer.py] => Trainable params: 85798656
2024-08-18 00:54:16,187 [icarl.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.694, Train_accy 75.40, Test_accy 96.60:   0%|          | 0/20 [00:10<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.694, Train_accy 75.40, Test_accy 96.60:   5%|▌         | 1/20 [00:10<03:17, 10.42s/it]
Task 0, Epoch 2/20 => Loss 0.280, Train_accy 90.56:   5%|▌         | 1/20 [00:19<03:17, 10.42s/it]                 
Task 0, Epoch 2/20 => Loss 0.280, Train_accy 90.56:  10%|█         | 2/20 [00:19<02:55,  9.77s/it]
Task 0, Epoch 3/20 => Loss 0.218, Train_accy 92.72:  10%|█         | 2/20 [00:29<02:55,  9.77s/it]
Task 0, Epoch 3/20 => Loss 0.218, Train_accy 92.72:  15%|█▌        | 3/20 [00:29<02:42,  9.55s/it]
Task 0, Epoch 4/20 => Loss 0.200, Train_accy 93.24:  15%|█▌        | 3/20 [00:38<02:42,  9.55s/it]
Task 0, Epoch 4/20 => Loss 0.200, Train_accy 93.24:  20%|██        | 4/20 [00:38<02:31,  9.46s/it]
Task 0, Epoch 5/20 => Loss 0.193, Train_accy 94.48:  20%|██        | 4/20 [00:47<02:31,  9.46s/it]
Task 0, Epoch 5/20 => Loss 0.193, Train_accy 94.48:  25%|██▌       | 5/20 [00:47<02:21,  9.41s/it]
Task 0, Epoch 6/20 => Loss 0.218, Train_accy 92.20, Test_accy 99.40:  25%|██▌       | 5/20 [00:57<02:21,  9.41s/it]
Task 0, Epoch 6/20 => Loss 0.218, Train_accy 92.20, Test_accy 99.40:  30%|███       | 6/20 [00:57<02:15,  9.68s/it]
Task 0, Epoch 7/20 => Loss 0.163, Train_accy 94.32:  30%|███       | 6/20 [01:07<02:15,  9.68s/it]                 
Task 0, Epoch 7/20 => Loss 0.163, Train_accy 94.32:  35%|███▌      | 7/20 [01:07<02:04,  9.56s/it]
Task 0, Epoch 8/20 => Loss 0.122, Train_accy 95.68:  35%|███▌      | 7/20 [01:16<02:04,  9.56s/it]
Task 0, Epoch 8/20 => Loss 0.122, Train_accy 95.68:  40%|████      | 8/20 [01:16<01:53,  9.47s/it]
Task 0, Epoch 9/20 => Loss 0.116, Train_accy 96.16:  40%|████      | 8/20 [01:25<01:53,  9.47s/it]
Task 0, Epoch 9/20 => Loss 0.116, Train_accy 96.16:  45%|████▌     | 9/20 [01:25<01:43,  9.43s/it]
Task 0, Epoch 10/20 => Loss 0.144, Train_accy 94.64:  45%|████▌     | 9/20 [01:35<01:43,  9.43s/it]
Task 0, Epoch 10/20 => Loss 0.144, Train_accy 94.64:  50%|█████     | 10/20 [01:35<01:33,  9.39s/it]
Task 0, Epoch 11/20 => Loss 0.126, Train_accy 95.52, Test_accy 98.80:  50%|█████     | 10/20 [01:45<01:33,  9.39s/it]
Task 0, Epoch 11/20 => Loss 0.126, Train_accy 95.52, Test_accy 98.80:  55%|█████▌    | 11/20 [01:45<01:27,  9.71s/it]
Task 0, Epoch 12/20 => Loss 0.134, Train_accy 95.88:  55%|█████▌    | 11/20 [01:54<01:27,  9.71s/it]                 
Task 0, Epoch 12/20 => Loss 0.134, Train_accy 95.88:  60%|██████    | 12/20 [01:54<01:16,  9.59s/it]
Task 0, Epoch 13/20 => Loss 0.131, Train_accy 95.32:  60%|██████    | 12/20 [02:04<01:16,  9.59s/it]
Task 0, Epoch 13/20 => Loss 0.131, Train_accy 95.32:  65%|██████▌   | 13/20 [02:04<01:06,  9.51s/it]
Task 0, Epoch 14/20 => Loss 0.123, Train_accy 95.36:  65%|██████▌   | 13/20 [02:13<01:06,  9.51s/it]
Task 0, Epoch 14/20 => Loss 0.123, Train_accy 95.36:  70%|███████   | 14/20 [02:13<00:56,  9.44s/it]
Task 0, Epoch 15/20 => Loss 0.126, Train_accy 95.88:  70%|███████   | 14/20 [02:22<00:56,  9.44s/it]
Task 0, Epoch 15/20 => Loss 0.126, Train_accy 95.88:  75%|███████▌  | 15/20 [02:22<00:46,  9.40s/it]
Task 0, Epoch 16/20 => Loss 0.099, Train_accy 96.56, Test_accy 99.60:  75%|███████▌  | 15/20 [02:33<00:46,  9.40s/it]
Task 0, Epoch 16/20 => Loss 0.099, Train_accy 96.56, Test_accy 99.60:  80%|████████  | 16/20 [02:33<00:38,  9.67s/it]
Task 0, Epoch 17/20 => Loss 0.125, Train_accy 95.64:  80%|████████  | 16/20 [02:42<00:38,  9.67s/it]                 
Task 0, Epoch 17/20 => Loss 0.125, Train_accy 95.64:  85%|████████▌ | 17/20 [02:42<00:28,  9.56s/it]
Task 0, Epoch 18/20 => Loss 0.097, Train_accy 96.28:  85%|████████▌ | 17/20 [02:51<00:28,  9.56s/it]
Task 0, Epoch 18/20 => Loss 0.097, Train_accy 96.28:  90%|█████████ | 18/20 [02:51<00:18,  9.47s/it]
Task 0, Epoch 19/20 => Loss 0.101, Train_accy 96.72:  90%|█████████ | 18/20 [03:00<00:18,  9.47s/it]
Task 0, Epoch 19/20 => Loss 0.101, Train_accy 96.72:  95%|█████████▌| 19/20 [03:00<00:09,  9.42s/it]
Task 0, Epoch 20/20 => Loss 0.090, Train_accy 96.64:  95%|█████████▌| 19/20 [03:10<00:09,  9.42s/it]
Task 0, Epoch 20/20 => Loss 0.090, Train_accy 96.64: 100%|██████████| 20/20 [03:10<00:00,  9.38s/it]
Task 0, Epoch 20/20 => Loss 0.090, Train_accy 96.64: 100%|██████████| 20/20 [03:10<00:00,  9.51s/it]
2024-08-18 00:57:26,661 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.090, Train_accy 96.64
2024-08-18 00:57:26,663 [base.py] => Reducing exemplars...(400 per classes)
2024-08-18 00:57:26,663 [base.py] => Constructing exemplars...(400 per classes)
2024-08-18 00:57:39,180 [icarl.py] => Exemplar size: 2000
2024-08-18 00:57:39,181 [trainer.py] => CNN: {'total': 99.4, '00-04': 99.4, 'old': 0, 'new': 99.4}
2024-08-18 00:57:39,181 [trainer.py] => NME: {'total': 99.6, '00-04': 99.6, 'old': 0, 'new': 99.6}
2024-08-18 00:57:39,181 [trainer.py] => CNN top1 curve: [99.4]
2024-08-18 00:57:39,181 [trainer.py] => CNN top5 curve: [100.0]
2024-08-18 00:57:39,181 [trainer.py] => NME top1 curve: [99.6]
2024-08-18 00:57:39,181 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.4
Average Accuracy (NME): 99.6
2024-08-18 00:57:39,181 [trainer.py] => Average Accuracy (CNN): 99.4
2024-08-18 00:57:39,181 [trainer.py] => Average Accuracy (NME): 99.6
2024-08-18 00:57:39,181 [trainer.py] => Train Time: 0
2024-08-18 00:57:39,181 [trainer.py] => Test Time: 2.01 

2024-08-18 00:57:39,182 [trainer.py] => All params: 85802501
2024-08-18 00:57:39,182 [trainer.py] => Trainable params: 85802501
2024-08-18 00:57:39,183 [icarl.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.214, Train_accy 84.20, Test_accy 98.00:   0%|          | 0/20 [00:23<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.214, Train_accy 84.20, Test_accy 98.00:   5%|▌         | 1/20 [00:23<07:22, 23.28s/it]
Task 1, Epoch 2/20 => Loss 1.018, Train_accy 90.38:   5%|▌         | 1/20 [00:44<07:22, 23.28s/it]                 
Task 1, Epoch 2/20 => Loss 1.018, Train_accy 90.38:  10%|█         | 2/20 [00:44<06:41, 22.30s/it]
Task 1, Epoch 3/20 => Loss 1.013, Train_accy 91.04:  10%|█         | 2/20 [01:06<06:41, 22.30s/it]
Task 1, Epoch 3/20 => Loss 1.013, Train_accy 91.04:  15%|█▌        | 3/20 [01:06<06:13, 21.99s/it]
Task 1, Epoch 4/20 => Loss 0.989, Train_accy 91.84:  15%|█▌        | 3/20 [01:28<06:13, 21.99s/it]
Task 1, Epoch 4/20 => Loss 0.989, Train_accy 91.84:  20%|██        | 4/20 [01:28<05:49, 21.85s/it]
Task 1, Epoch 5/20 => Loss 0.971, Train_accy 92.13:  20%|██        | 4/20 [01:49<05:49, 21.85s/it]
Task 1, Epoch 5/20 => Loss 0.971, Train_accy 92.13:  25%|██▌       | 5/20 [01:49<05:26, 21.76s/it]
Task 1, Epoch 6/20 => Loss 0.965, Train_accy 92.58, Test_accy 98.80:  25%|██▌       | 5/20 [02:13<05:26, 21.76s/it]
Task 1, Epoch 6/20 => Loss 0.965, Train_accy 92.58, Test_accy 98.80:  30%|███       | 6/20 [02:13<05:11, 22.27s/it]
Task 1, Epoch 7/20 => Loss 0.940, Train_accy 92.80:  30%|███       | 6/20 [02:34<05:11, 22.27s/it]                 
Task 1, Epoch 7/20 => Loss 0.940, Train_accy 92.80:  35%|███▌      | 7/20 [02:34<04:46, 22.06s/it]
Task 1, Epoch 8/20 => Loss 0.895, Train_accy 94.42:  35%|███▌      | 7/20 [02:56<04:46, 22.06s/it]
Task 1, Epoch 8/20 => Loss 0.895, Train_accy 94.42:  40%|████      | 8/20 [02:56<04:23, 21.94s/it]
Task 1, Epoch 9/20 => Loss 0.893, Train_accy 94.64:  40%|████      | 8/20 [03:17<04:23, 21.94s/it]
Task 1, Epoch 9/20 => Loss 0.893, Train_accy 94.64:  45%|████▌     | 9/20 [03:17<04:00, 21.83s/it]
Task 1, Epoch 10/20 => Loss 0.906, Train_accy 93.76:  45%|████▌     | 9/20 [03:39<04:00, 21.83s/it]
Task 1, Epoch 10/20 => Loss 0.906, Train_accy 93.76:  50%|█████     | 10/20 [03:39<03:37, 21.76s/it]
Task 1, Epoch 11/20 => Loss 0.885, Train_accy 94.49, Test_accy 98.40:  50%|█████     | 10/20 [04:02<03:37, 21.76s/it]
Task 1, Epoch 11/20 => Loss 0.885, Train_accy 94.49, Test_accy 98.40:  55%|█████▌    | 11/20 [04:02<03:20, 22.24s/it]
Task 1, Epoch 12/20 => Loss 0.902, Train_accy 94.29:  55%|█████▌    | 11/20 [04:24<03:20, 22.24s/it]                 
Task 1, Epoch 12/20 => Loss 0.902, Train_accy 94.29:  60%|██████    | 12/20 [04:24<02:56, 22.06s/it]
Task 1, Epoch 13/20 => Loss 0.874, Train_accy 95.07:  60%|██████    | 12/20 [04:46<02:56, 22.06s/it]
Task 1, Epoch 13/20 => Loss 0.874, Train_accy 95.07:  65%|██████▌   | 13/20 [04:46<02:33, 21.92s/it]
Task 1, Epoch 14/20 => Loss 0.905, Train_accy 94.27:  65%|██████▌   | 13/20 [05:07<02:33, 21.92s/it]
Task 1, Epoch 14/20 => Loss 0.905, Train_accy 94.27:  70%|███████   | 14/20 [05:07<02:10, 21.82s/it]
Task 1, Epoch 15/20 => Loss 0.914, Train_accy 93.93:  70%|███████   | 14/20 [05:29<02:10, 21.82s/it]
Task 1, Epoch 15/20 => Loss 0.914, Train_accy 93.93:  75%|███████▌  | 15/20 [05:29<01:48, 21.75s/it]
Task 1, Epoch 16/20 => Loss 0.875, Train_accy 94.87, Test_accy 98.50:  75%|███████▌  | 15/20 [05:52<01:48, 21.75s/it]
Task 1, Epoch 16/20 => Loss 0.875, Train_accy 94.87, Test_accy 98.50:  80%|████████  | 16/20 [05:52<01:28, 22.20s/it]
Task 1, Epoch 17/20 => Loss 0.863, Train_accy 95.22:  80%|████████  | 16/20 [06:14<01:28, 22.20s/it]                 
Task 1, Epoch 17/20 => Loss 0.863, Train_accy 95.22:  85%|████████▌ | 17/20 [06:14<01:06, 22.06s/it]
Task 1, Epoch 18/20 => Loss 0.879, Train_accy 94.80:  85%|████████▌ | 17/20 [06:35<01:06, 22.06s/it]
Task 1, Epoch 18/20 => Loss 0.879, Train_accy 94.80:  90%|█████████ | 18/20 [06:35<00:43, 21.93s/it]
Task 1, Epoch 19/20 => Loss 0.876, Train_accy 94.78:  90%|█████████ | 18/20 [06:57<00:43, 21.93s/it]
Task 1, Epoch 19/20 => Loss 0.876, Train_accy 94.78:  95%|█████████▌| 19/20 [06:57<00:21, 21.83s/it]
Task 1, Epoch 20/20 => Loss 0.869, Train_accy 94.80:  95%|█████████▌| 19/20 [07:19<00:21, 21.83s/it]
Task 1, Epoch 20/20 => Loss 0.869, Train_accy 94.80: 100%|██████████| 20/20 [07:19<00:00, 21.76s/it]
Task 1, Epoch 20/20 => Loss 0.869, Train_accy 94.80: 100%|██████████| 20/20 [07:19<00:00, 21.95s/it]
2024-08-18 01:04:58,307 [icarl.py] => Task 1, Epoch 20/20 => Loss 0.869, Train_accy 94.80
2024-08-18 01:04:58,309 [base.py] => Reducing exemplars...(200 per classes)
2024-08-18 01:05:01,035 [base.py] => Constructing exemplars...(200 per classes)
2024-08-18 01:05:12,810 [icarl.py] => Exemplar size: 2000
2024-08-18 01:05:12,810 [trainer.py] => CNN: {'total': 98.5, '00-04': 98.8, '05-09': 98.2, 'old': 98.8, 'new': 98.2}
2024-08-18 01:05:12,810 [trainer.py] => NME: {'total': 98.9, '00-04': 99.2, '05-09': 98.6, 'old': 99.2, 'new': 98.6}
2024-08-18 01:05:12,810 [trainer.py] => CNN top1 curve: [99.4, 98.5]
2024-08-18 01:05:12,810 [trainer.py] => CNN top5 curve: [100.0, 100.0]
2024-08-18 01:05:12,810 [trainer.py] => NME top1 curve: [99.6, 98.9]
2024-08-18 01:05:12,810 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 98.95
Average Accuracy (NME): 99.25
2024-08-18 01:05:12,810 [trainer.py] => Average Accuracy (CNN): 98.95
2024-08-18 01:05:12,811 [trainer.py] => Average Accuracy (NME): 99.25
2024-08-18 01:05:12,811 [trainer.py] => Train Time: 0
2024-08-18 01:05:12,811 [trainer.py] => Test Time: 5.43 

2024-08-18 01:05:12,811 [trainer.py] => All params: 85806346
2024-08-18 01:05:12,812 [trainer.py] => Trainable params: 85806346
2024-08-18 01:05:12,812 [icarl.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.630, Train_accy 81.11, Test_accy 96.40:   0%|          | 0/20 [00:23<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.630, Train_accy 81.11, Test_accy 96.40:   5%|▌         | 1/20 [00:23<07:34, 23.92s/it]
Task 2, Epoch 2/20 => Loss 1.290, Train_accy 89.49:   5%|▌         | 1/20 [00:45<07:34, 23.92s/it]                 
Task 2, Epoch 2/20 => Loss 1.290, Train_accy 89.49:  10%|█         | 2/20 [00:45<06:45, 22.55s/it]
Task 2, Epoch 3/20 => Loss 1.249, Train_accy 90.93:  10%|█         | 2/20 [01:07<06:45, 22.55s/it]
Task 2, Epoch 3/20 => Loss 1.249, Train_accy 90.93:  15%|█▌        | 3/20 [01:07<06:15, 22.11s/it]
Task 2, Epoch 4/20 => Loss 1.264, Train_accy 90.89:  15%|█▌        | 3/20 [01:28<06:15, 22.11s/it]
Task 2, Epoch 4/20 => Loss 1.264, Train_accy 90.89:  20%|██        | 4/20 [01:28<05:50, 21.90s/it]
Task 2, Epoch 5/20 => Loss 1.211, Train_accy 92.38:  20%|██        | 4/20 [01:50<05:50, 21.90s/it]
Task 2, Epoch 5/20 => Loss 1.211, Train_accy 92.38:  25%|██▌       | 5/20 [01:50<05:27, 21.82s/it]
Task 2, Epoch 6/20 => Loss 1.201, Train_accy 92.71, Test_accy 96.87:  25%|██▌       | 5/20 [02:14<05:27, 21.82s/it]
Task 2, Epoch 6/20 => Loss 1.201, Train_accy 92.71, Test_accy 96.87:  30%|███       | 6/20 [02:14<05:16, 22.58s/it]
Task 2, Epoch 7/20 => Loss 1.191, Train_accy 92.56:  30%|███       | 6/20 [02:35<05:16, 22.58s/it]                 
Task 2, Epoch 7/20 => Loss 1.191, Train_accy 92.56:  35%|███▌      | 7/20 [02:35<04:49, 22.25s/it]
Task 2, Epoch 8/20 => Loss 1.184, Train_accy 93.02:  35%|███▌      | 7/20 [02:57<04:49, 22.25s/it]
Task 2, Epoch 8/20 => Loss 1.184, Train_accy 93.02:  40%|████      | 8/20 [02:57<04:24, 22.05s/it]
Task 2, Epoch 9/20 => Loss 1.189, Train_accy 92.73:  40%|████      | 8/20 [03:19<04:24, 22.05s/it]
Task 2, Epoch 9/20 => Loss 1.189, Train_accy 92.73:  45%|████▌     | 9/20 [03:19<04:00, 21.90s/it]
Task 2, Epoch 10/20 => Loss 1.161, Train_accy 93.76:  45%|████▌     | 9/20 [03:40<04:00, 21.90s/it]
Task 2, Epoch 10/20 => Loss 1.161, Train_accy 93.76:  50%|█████     | 10/20 [03:40<03:38, 21.81s/it]
Task 2, Epoch 11/20 => Loss 1.194, Train_accy 92.80, Test_accy 97.07:  50%|█████     | 10/20 [04:04<03:38, 21.81s/it]
Task 2, Epoch 11/20 => Loss 1.194, Train_accy 92.80, Test_accy 97.07:  55%|█████▌    | 11/20 [04:04<03:22, 22.47s/it]
Task 2, Epoch 12/20 => Loss 1.194, Train_accy 93.09:  55%|█████▌    | 11/20 [04:26<03:22, 22.47s/it]                 
Task 2, Epoch 12/20 => Loss 1.194, Train_accy 93.09:  60%|██████    | 12/20 [04:26<02:57, 22.20s/it]
Task 2, Epoch 13/20 => Loss 1.196, Train_accy 93.00:  60%|██████    | 12/20 [04:47<02:57, 22.20s/it]
Task 2, Epoch 13/20 => Loss 1.196, Train_accy 93.00:  65%|██████▌   | 13/20 [04:47<02:34, 22.01s/it]
Task 2, Epoch 14/20 => Loss 1.143, Train_accy 94.04:  65%|██████▌   | 13/20 [05:09<02:34, 22.01s/it]
Task 2, Epoch 14/20 => Loss 1.143, Train_accy 94.04:  70%|███████   | 14/20 [05:09<02:11, 21.86s/it]
Task 2, Epoch 15/20 => Loss 1.171, Train_accy 93.89:  70%|███████   | 14/20 [05:31<02:11, 21.86s/it]
Task 2, Epoch 15/20 => Loss 1.171, Train_accy 93.89:  75%|███████▌  | 15/20 [05:31<01:49, 21.81s/it]
Task 2, Epoch 16/20 => Loss 1.139, Train_accy 94.16, Test_accy 96.67:  75%|███████▌  | 15/20 [05:55<01:49, 21.81s/it]
Task 2, Epoch 16/20 => Loss 1.139, Train_accy 94.16, Test_accy 96.67:  80%|████████  | 16/20 [05:55<01:29, 22.47s/it]
Task 2, Epoch 17/20 => Loss 1.141, Train_accy 94.47:  80%|████████  | 16/20 [06:16<01:29, 22.47s/it]                 
Task 2, Epoch 17/20 => Loss 1.141, Train_accy 94.47:  85%|████████▌ | 17/20 [06:16<01:06, 22.20s/it]
Task 2, Epoch 18/20 => Loss 1.197, Train_accy 92.87:  85%|████████▌ | 17/20 [06:38<01:06, 22.20s/it]
Task 2, Epoch 18/20 => Loss 1.197, Train_accy 92.87:  90%|█████████ | 18/20 [06:38<00:44, 22.02s/it]
Task 2, Epoch 19/20 => Loss 1.178, Train_accy 93.49:  90%|█████████ | 18/20 [06:59<00:44, 22.02s/it]
Task 2, Epoch 19/20 => Loss 1.178, Train_accy 93.49:  95%|█████████▌| 19/20 [06:59<00:21, 21.87s/it]
Task 2, Epoch 20/20 => Loss 1.146, Train_accy 93.96:  95%|█████████▌| 19/20 [07:21<00:21, 21.87s/it]
Task 2, Epoch 20/20 => Loss 1.146, Train_accy 93.96: 100%|██████████| 20/20 [07:21<00:00, 21.78s/it]
Task 2, Epoch 20/20 => Loss 1.146, Train_accy 93.96: 100%|██████████| 20/20 [07:21<00:00, 22.07s/it]
2024-08-18 01:12:34,223 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.146, Train_accy 93.96
2024-08-18 01:12:34,224 [base.py] => Reducing exemplars...(133 per classes)
2024-08-18 01:12:38,712 [base.py] => Constructing exemplars...(133 per classes)
2024-08-18 01:12:51,108 [icarl.py] => Exemplar size: 1995
2024-08-18 01:12:51,108 [trainer.py] => CNN: {'total': 97.13, '00-04': 98.6, '05-09': 95.0, '10-14': 97.8, 'old': 96.8, 'new': 97.8}
2024-08-18 01:12:51,108 [trainer.py] => NME: {'total': 97.67, '00-04': 99.0, '05-09': 96.4, '10-14': 97.6, 'old': 97.7, 'new': 97.6}
2024-08-18 01:12:51,108 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13]
2024-08-18 01:12:51,108 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87]
2024-08-18 01:12:51,108 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67]
2024-08-18 01:12:51,108 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87]

Average Accuracy (CNN): 98.34
Average Accuracy (NME): 98.72
2024-08-18 01:12:51,108 [trainer.py] => Average Accuracy (CNN): 98.34
2024-08-18 01:12:51,108 [trainer.py] => Average Accuracy (NME): 98.72
2024-08-18 01:12:51,108 [trainer.py] => Train Time: 0
2024-08-18 01:12:51,108 [trainer.py] => Test Time: 10.2 

2024-08-18 01:12:51,109 [trainer.py] => All params: 85810191
2024-08-18 01:12:51,109 [trainer.py] => Trainable params: 85810191
2024-08-18 01:12:51,110 [icarl.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.930, Train_accy 79.13, Test_accy 93.60:   0%|          | 0/20 [00:24<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.930, Train_accy 79.13, Test_accy 93.60:   5%|▌         | 1/20 [00:24<07:48, 24.66s/it]
Task 3, Epoch 2/20 => Loss 1.497, Train_accy 89.05:   5%|▌         | 1/20 [00:46<07:48, 24.66s/it]                 
Task 3, Epoch 2/20 => Loss 1.497, Train_accy 89.05:  10%|█         | 2/20 [00:46<06:51, 22.84s/it]
Task 3, Epoch 3/20 => Loss 1.451, Train_accy 90.01:  10%|█         | 2/20 [01:07<06:51, 22.84s/it]
Task 3, Epoch 3/20 => Loss 1.451, Train_accy 90.01:  15%|█▌        | 3/20 [01:07<06:18, 22.26s/it]
Task 3, Epoch 4/20 => Loss 1.397, Train_accy 91.59:  15%|█▌        | 3/20 [01:29<06:18, 22.26s/it]
Task 3, Epoch 4/20 => Loss 1.397, Train_accy 91.59:  20%|██        | 4/20 [01:29<05:51, 21.98s/it]
Task 3, Epoch 5/20 => Loss 1.416, Train_accy 91.15:  20%|██        | 4/20 [01:50<05:51, 21.98s/it]
Task 3, Epoch 5/20 => Loss 1.416, Train_accy 91.15:  25%|██▌       | 5/20 [01:50<05:27, 21.85s/it]
Task 3, Epoch 6/20 => Loss 1.386, Train_accy 92.61, Test_accy 95.40:  25%|██▌       | 5/20 [02:15<05:27, 21.85s/it]
Task 3, Epoch 6/20 => Loss 1.386, Train_accy 92.61, Test_accy 95.40:  30%|███       | 6/20 [02:15<05:20, 22.86s/it]
Task 3, Epoch 7/20 => Loss 1.372, Train_accy 92.61:  30%|███       | 6/20 [02:37<05:20, 22.86s/it]                 
Task 3, Epoch 7/20 => Loss 1.372, Train_accy 92.61:  35%|███▌      | 7/20 [02:37<04:51, 22.44s/it]
Task 3, Epoch 8/20 => Loss 1.373, Train_accy 92.35:  35%|███▌      | 7/20 [02:58<04:51, 22.44s/it]
Task 3, Epoch 8/20 => Loss 1.373, Train_accy 92.35:  40%|████      | 8/20 [02:58<04:26, 22.18s/it]
Task 3, Epoch 9/20 => Loss 1.386, Train_accy 91.95:  40%|████      | 8/20 [03:20<04:26, 22.18s/it]
Task 3, Epoch 9/20 => Loss 1.386, Train_accy 91.95:  45%|████▌     | 9/20 [03:20<04:02, 22.01s/it]
Task 3, Epoch 10/20 => Loss 1.376, Train_accy 92.68:  45%|████▌     | 9/20 [03:42<04:02, 22.01s/it]
Task 3, Epoch 10/20 => Loss 1.376, Train_accy 92.68:  50%|█████     | 10/20 [03:42<03:38, 21.88s/it]
Task 3, Epoch 11/20 => Loss 1.355, Train_accy 92.84, Test_accy 95.85:  50%|█████     | 10/20 [04:06<03:38, 21.88s/it]
Task 3, Epoch 11/20 => Loss 1.355, Train_accy 92.84, Test_accy 95.85:  55%|█████▌    | 11/20 [04:06<03:24, 22.77s/it]
Task 3, Epoch 12/20 => Loss 1.311, Train_accy 93.84:  55%|█████▌    | 11/20 [04:28<03:24, 22.77s/it]                 
Task 3, Epoch 12/20 => Loss 1.311, Train_accy 93.84:  60%|██████    | 12/20 [04:28<02:59, 22.42s/it]
Task 3, Epoch 13/20 => Loss 1.348, Train_accy 92.77:  60%|██████    | 12/20 [04:50<02:59, 22.42s/it]
Task 3, Epoch 13/20 => Loss 1.348, Train_accy 92.77:  65%|██████▌   | 13/20 [04:50<02:35, 22.17s/it]
Task 3, Epoch 14/20 => Loss 1.314, Train_accy 93.68:  65%|██████▌   | 13/20 [05:11<02:35, 22.17s/it]
Task 3, Epoch 14/20 => Loss 1.314, Train_accy 93.68:  70%|███████   | 14/20 [05:11<02:12, 22.00s/it]
Task 3, Epoch 15/20 => Loss 1.341, Train_accy 92.90:  70%|███████   | 14/20 [05:33<02:12, 22.00s/it]
Task 3, Epoch 15/20 => Loss 1.341, Train_accy 92.90:  75%|███████▌  | 15/20 [05:33<01:49, 21.89s/it]
Task 3, Epoch 16/20 => Loss 1.354, Train_accy 93.35, Test_accy 95.00:  75%|███████▌  | 15/20 [05:58<01:49, 21.89s/it]
Task 3, Epoch 16/20 => Loss 1.354, Train_accy 93.35, Test_accy 95.00:  80%|████████  | 16/20 [05:58<01:30, 22.74s/it]
Task 3, Epoch 17/20 => Loss 1.326, Train_accy 93.68:  80%|████████  | 16/20 [06:19<01:30, 22.74s/it]                 
Task 3, Epoch 17/20 => Loss 1.326, Train_accy 93.68:  85%|████████▌ | 17/20 [06:19<01:07, 22.38s/it]
Task 3, Epoch 18/20 => Loss 1.354, Train_accy 93.57:  85%|████████▌ | 17/20 [06:41<01:07, 22.38s/it]
Task 3, Epoch 18/20 => Loss 1.354, Train_accy 93.57:  90%|█████████ | 18/20 [06:41<00:44, 22.14s/it]
Task 3, Epoch 19/20 => Loss 1.326, Train_accy 93.88:  90%|█████████ | 18/20 [07:02<00:44, 22.14s/it]
Task 3, Epoch 19/20 => Loss 1.326, Train_accy 93.88:  95%|█████████▌| 19/20 [07:02<00:21, 21.98s/it]
Task 3, Epoch 20/20 => Loss 1.313, Train_accy 93.59:  95%|█████████▌| 19/20 [07:24<00:21, 21.98s/it]
Task 3, Epoch 20/20 => Loss 1.313, Train_accy 93.59: 100%|██████████| 20/20 [07:24<00:00, 21.86s/it]
Task 3, Epoch 20/20 => Loss 1.313, Train_accy 93.59: 100%|██████████| 20/20 [07:24<00:00, 22.22s/it]
2024-08-18 01:20:15,614 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.313, Train_accy 93.59
2024-08-18 01:20:15,616 [base.py] => Reducing exemplars...(100 per classes)
2024-08-18 01:20:21,603 [base.py] => Constructing exemplars...(100 per classes)
2024-08-18 01:20:35,477 [icarl.py] => Exemplar size: 2000
2024-08-18 01:20:35,478 [trainer.py] => CNN: {'total': 95.65, '00-04': 98.4, '05-09': 92.8, '10-14': 96.4, '15-19': 95.0, 'old': 95.87, 'new': 95.0}
2024-08-18 01:20:35,478 [trainer.py] => NME: {'total': 95.95, '00-04': 99.0, '05-09': 94.6, '10-14': 97.0, '15-19': 93.2, 'old': 96.87, 'new': 93.2}
2024-08-18 01:20:35,478 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65]
2024-08-18 01:20:35,478 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7]
2024-08-18 01:20:35,478 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95]
2024-08-18 01:20:35,478 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65]

Average Accuracy (CNN): 97.67
Average Accuracy (NME): 98.03
2024-08-18 01:20:35,478 [trainer.py] => Average Accuracy (CNN): 97.67
2024-08-18 01:20:35,478 [trainer.py] => Average Accuracy (NME): 98.03
2024-08-18 01:20:35,478 [trainer.py] => Train Time: 0
2024-08-18 01:20:35,478 [trainer.py] => Test Time: 16.6 

2024-08-18 01:20:35,479 [trainer.py] => All params: 85814036
2024-08-18 01:20:35,479 [trainer.py] => Trainable params: 85814036
2024-08-18 01:20:35,480 [icarl.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.974, Train_accy 84.47, Test_accy 93.72:   0%|          | 0/20 [00:25<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.974, Train_accy 84.47, Test_accy 93.72:   5%|▌         | 1/20 [00:25<08:03, 25.44s/it]
Task 4, Epoch 2/20 => Loss 1.553, Train_accy 92.62:   5%|▌         | 1/20 [00:47<08:03, 25.44s/it]                 
Task 4, Epoch 2/20 => Loss 1.553, Train_accy 92.62:  10%|█         | 2/20 [00:47<06:58, 23.23s/it]
Task 4, Epoch 3/20 => Loss 1.546, Train_accy 92.78:  10%|█         | 2/20 [01:08<06:58, 23.23s/it]
Task 4, Epoch 3/20 => Loss 1.546, Train_accy 92.78:  15%|█▌        | 3/20 [01:08<06:23, 22.54s/it]
Task 4, Epoch 4/20 => Loss 1.501, Train_accy 93.69:  15%|█▌        | 3/20 [01:30<06:23, 22.54s/it]
Task 4, Epoch 4/20 => Loss 1.501, Train_accy 93.69:  20%|██        | 4/20 [01:30<05:55, 22.22s/it]
Task 4, Epoch 5/20 => Loss 1.491, Train_accy 94.04:  20%|██        | 4/20 [01:52<05:55, 22.22s/it]
Task 4, Epoch 5/20 => Loss 1.491, Train_accy 94.04:  25%|██▌       | 5/20 [01:52<05:30, 22.02s/it]
Task 4, Epoch 6/20 => Loss 1.516, Train_accy 93.49, Test_accy 94.80:  25%|██▌       | 5/20 [02:17<05:30, 22.02s/it]
Task 4, Epoch 6/20 => Loss 1.516, Train_accy 93.49, Test_accy 94.80:  30%|███       | 6/20 [02:17<05:24, 23.19s/it]
Task 4, Epoch 7/20 => Loss 1.503, Train_accy 93.47:  30%|███       | 6/20 [02:39<05:24, 23.19s/it]                 
Task 4, Epoch 7/20 => Loss 1.503, Train_accy 93.47:  35%|███▌      | 7/20 [02:39<04:54, 22.69s/it]
Task 4, Epoch 8/20 => Loss 1.485, Train_accy 93.96:  35%|███▌      | 7/20 [03:00<04:54, 22.69s/it]
Task 4, Epoch 8/20 => Loss 1.485, Train_accy 93.96:  40%|████      | 8/20 [03:00<04:28, 22.35s/it]
Task 4, Epoch 9/20 => Loss 1.490, Train_accy 94.24:  40%|████      | 8/20 [03:22<04:28, 22.35s/it]
Task 4, Epoch 9/20 => Loss 1.490, Train_accy 94.24:  45%|████▌     | 9/20 [03:22<04:03, 22.12s/it]
Task 4, Epoch 10/20 => Loss 1.466, Train_accy 94.56:  45%|████▌     | 9/20 [03:44<04:03, 22.12s/it]
Task 4, Epoch 10/20 => Loss 1.466, Train_accy 94.56:  50%|█████     | 10/20 [03:44<03:39, 21.94s/it]
Task 4, Epoch 11/20 => Loss 1.464, Train_accy 94.42, Test_accy 94.72:  50%|█████     | 10/20 [04:09<03:39, 21.94s/it]
Task 4, Epoch 11/20 => Loss 1.464, Train_accy 94.42, Test_accy 94.72:  55%|█████▌    | 11/20 [04:09<03:27, 23.03s/it]
Task 4, Epoch 12/20 => Loss 1.490, Train_accy 94.24:  55%|█████▌    | 11/20 [04:31<03:27, 23.03s/it]                 
Task 4, Epoch 12/20 => Loss 1.490, Train_accy 94.24:  60%|██████    | 12/20 [04:31<03:00, 22.62s/it]
Task 4, Epoch 13/20 => Loss 1.505, Train_accy 94.18:  60%|██████    | 12/20 [04:52<03:00, 22.62s/it]
Task 4, Epoch 13/20 => Loss 1.505, Train_accy 94.18:  65%|██████▌   | 13/20 [04:52<02:36, 22.33s/it]
Task 4, Epoch 14/20 => Loss 1.464, Train_accy 94.89:  65%|██████▌   | 13/20 [05:14<02:36, 22.33s/it]
Task 4, Epoch 14/20 => Loss 1.464, Train_accy 94.89:  70%|███████   | 14/20 [05:14<02:12, 22.12s/it]
Task 4, Epoch 15/20 => Loss 1.466, Train_accy 94.69:  70%|███████   | 14/20 [05:36<02:12, 22.12s/it]
Task 4, Epoch 15/20 => Loss 1.466, Train_accy 94.69:  75%|███████▌  | 15/20 [05:36<01:49, 21.96s/it]
Task 4, Epoch 16/20 => Loss 1.447, Train_accy 95.33, Test_accy 95.52:  75%|███████▌  | 15/20 [06:01<01:49, 21.96s/it]
Task 4, Epoch 16/20 => Loss 1.447, Train_accy 95.33, Test_accy 95.52:  80%|████████  | 16/20 [06:01<01:32, 23.03s/it]
Task 4, Epoch 17/20 => Loss 1.480, Train_accy 94.07:  80%|████████  | 16/20 [06:23<01:32, 23.03s/it]                 
Task 4, Epoch 17/20 => Loss 1.480, Train_accy 94.07:  85%|████████▌ | 17/20 [06:23<01:07, 22.60s/it]
Task 4, Epoch 18/20 => Loss 1.480, Train_accy 94.47:  85%|████████▌ | 17/20 [06:45<01:07, 22.60s/it]
Task 4, Epoch 18/20 => Loss 1.480, Train_accy 94.47:  90%|█████████ | 18/20 [06:45<00:44, 22.33s/it]
Task 4, Epoch 19/20 => Loss 1.442, Train_accy 94.89:  90%|█████████ | 18/20 [07:06<00:44, 22.33s/it]
Task 4, Epoch 19/20 => Loss 1.442, Train_accy 94.89:  95%|█████████▌| 19/20 [07:06<00:22, 22.11s/it]
Task 4, Epoch 20/20 => Loss 1.461, Train_accy 94.84:  95%|█████████▌| 19/20 [07:28<00:22, 22.11s/it]
Task 4, Epoch 20/20 => Loss 1.461, Train_accy 94.84: 100%|██████████| 20/20 [07:28<00:00, 21.98s/it]
Task 4, Epoch 20/20 => Loss 1.461, Train_accy 94.84: 100%|██████████| 20/20 [07:28<00:00, 22.41s/it]
2024-08-18 01:28:03,814 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.461, Train_accy 94.84
2024-08-18 01:28:03,817 [base.py] => Reducing exemplars...(80 per classes)
2024-08-18 01:28:11,077 [base.py] => Constructing exemplars...(80 per classes)
2024-08-18 01:28:25,930 [icarl.py] => Exemplar size: 2000
2024-08-18 01:28:25,930 [trainer.py] => CNN: {'total': 94.88, '00-04': 97.4, '05-09': 91.0, '10-14': 92.8, '15-19': 94.8, '20-24': 98.4, 'old': 94.0, 'new': 98.4}
2024-08-18 01:28:25,930 [trainer.py] => NME: {'total': 95.12, '00-04': 98.2, '05-09': 93.4, '10-14': 93.8, '15-19': 93.4, '20-24': 96.8, 'old': 94.7, 'new': 96.8}
2024-08-18 01:28:25,930 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88]
2024-08-18 01:28:25,930 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36]
2024-08-18 01:28:25,930 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12]
2024-08-18 01:28:25,930 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68]

Average Accuracy (CNN): 97.11
Average Accuracy (NME): 97.45
2024-08-18 01:28:25,930 [trainer.py] => Average Accuracy (CNN): 97.11
2024-08-18 01:28:25,931 [trainer.py] => Average Accuracy (NME): 97.45
2024-08-18 01:28:25,931 [trainer.py] => Train Time: 0
2024-08-18 01:28:25,931 [trainer.py] => Test Time: 24.43 

2024-08-18 01:28:25,931 [trainer.py] => All params: 85817881
2024-08-18 01:28:25,932 [trainer.py] => Trainable params: 85817881
2024-08-18 01:28:25,932 [icarl.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.111, Train_accy 85.24, Test_accy 91.93:   0%|          | 0/20 [00:26<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.111, Train_accy 85.24, Test_accy 91.93:   5%|▌         | 1/20 [00:26<08:17, 26.19s/it]
Task 5, Epoch 2/20 => Loss 1.754, Train_accy 92.00:   5%|▌         | 1/20 [00:47<08:17, 26.19s/it]                 
Task 5, Epoch 2/20 => Loss 1.754, Train_accy 92.00:  10%|█         | 2/20 [00:47<07:02, 23.49s/it]
Task 5, Epoch 3/20 => Loss 1.695, Train_accy 92.80:  10%|█         | 2/20 [01:09<07:02, 23.49s/it]
Task 5, Epoch 3/20 => Loss 1.695, Train_accy 92.80:  15%|█▌        | 3/20 [01:09<06:24, 22.63s/it]
Task 5, Epoch 4/20 => Loss 1.727, Train_accy 92.93:  15%|█▌        | 3/20 [01:31<06:24, 22.63s/it]
Task 5, Epoch 4/20 => Loss 1.727, Train_accy 92.93:  20%|██        | 4/20 [01:31<05:55, 22.24s/it]
Task 5, Epoch 5/20 => Loss 1.722, Train_accy 93.22:  20%|██        | 4/20 [01:52<05:55, 22.24s/it]
Task 5, Epoch 5/20 => Loss 1.722, Train_accy 93.22:  25%|██▌       | 5/20 [01:52<05:30, 22.00s/it]
Task 5, Epoch 6/20 => Loss 1.703, Train_accy 93.38, Test_accy 92.30:  25%|██▌       | 5/20 [02:18<05:30, 22.00s/it]
Task 5, Epoch 6/20 => Loss 1.703, Train_accy 93.38, Test_accy 92.30:  30%|███       | 6/20 [02:18<05:27, 23.38s/it]
Task 5, Epoch 7/20 => Loss 1.681, Train_accy 94.44:  30%|███       | 6/20 [02:40<05:27, 23.38s/it]                 
Task 5, Epoch 7/20 => Loss 1.681, Train_accy 94.44:  35%|███▌      | 7/20 [02:40<04:56, 22.80s/it]
Task 5, Epoch 8/20 => Loss 1.696, Train_accy 93.71:  35%|███▌      | 7/20 [03:01<04:56, 22.80s/it]
Task 5, Epoch 8/20 => Loss 1.696, Train_accy 93.71:  40%|████      | 8/20 [03:01<04:29, 22.42s/it]
Task 5, Epoch 9/20 => Loss 1.680, Train_accy 94.51:  40%|████      | 8/20 [03:23<04:29, 22.42s/it]
Task 5, Epoch 9/20 => Loss 1.680, Train_accy 94.51:  45%|████▌     | 9/20 [03:23<04:03, 22.16s/it]
Task 5, Epoch 10/20 => Loss 1.678, Train_accy 94.49:  45%|████▌     | 9/20 [03:45<04:03, 22.16s/it]
Task 5, Epoch 10/20 => Loss 1.678, Train_accy 94.49:  50%|█████     | 10/20 [03:45<03:40, 22.01s/it]
Task 5, Epoch 11/20 => Loss 1.682, Train_accy 94.02, Test_accy 93.63:  50%|█████     | 10/20 [04:11<03:40, 22.01s/it]
Task 5, Epoch 11/20 => Loss 1.682, Train_accy 94.02, Test_accy 93.63:  55%|█████▌    | 11/20 [04:11<03:29, 23.25s/it]
Task 5, Epoch 12/20 => Loss 1.666, Train_accy 94.00:  55%|█████▌    | 11/20 [04:32<03:29, 23.25s/it]                 
Task 5, Epoch 12/20 => Loss 1.666, Train_accy 94.00:  60%|██████    | 12/20 [04:32<03:02, 22.76s/it]
Task 5, Epoch 13/20 => Loss 1.669, Train_accy 94.42:  60%|██████    | 12/20 [04:54<03:02, 22.76s/it]
Task 5, Epoch 13/20 => Loss 1.669, Train_accy 94.42:  65%|██████▌   | 13/20 [04:54<02:36, 22.40s/it]
Task 5, Epoch 14/20 => Loss 1.676, Train_accy 94.53:  65%|██████▌   | 13/20 [05:15<02:36, 22.40s/it]
Task 5, Epoch 14/20 => Loss 1.676, Train_accy 94.53:  70%|███████   | 14/20 [05:15<02:12, 22.14s/it]
Task 5, Epoch 15/20 => Loss 1.669, Train_accy 94.36:  70%|███████   | 14/20 [05:37<02:12, 22.14s/it]
Task 5, Epoch 15/20 => Loss 1.669, Train_accy 94.36:  75%|███████▌  | 15/20 [05:37<01:49, 21.96s/it]
Task 5, Epoch 16/20 => Loss 1.678, Train_accy 94.67, Test_accy 93.30:  75%|███████▌  | 15/20 [06:03<01:49, 21.96s/it]
Task 5, Epoch 16/20 => Loss 1.678, Train_accy 94.67, Test_accy 93.30:  80%|████████  | 16/20 [06:03<01:32, 23.17s/it]
Task 5, Epoch 17/20 => Loss 1.665, Train_accy 94.82:  80%|████████  | 16/20 [06:25<01:32, 23.17s/it]                 
Task 5, Epoch 17/20 => Loss 1.665, Train_accy 94.82:  85%|████████▌ | 17/20 [06:25<01:08, 22.69s/it]
Task 5, Epoch 18/20 => Loss 1.657, Train_accy 95.24:  85%|████████▌ | 17/20 [06:46<01:08, 22.69s/it]
Task 5, Epoch 18/20 => Loss 1.657, Train_accy 95.24:  90%|█████████ | 18/20 [06:46<00:44, 22.36s/it]
Task 5, Epoch 19/20 => Loss 1.658, Train_accy 94.76:  90%|█████████ | 18/20 [07:08<00:44, 22.36s/it]
Task 5, Epoch 19/20 => Loss 1.658, Train_accy 94.76:  95%|█████████▌| 19/20 [07:08<00:22, 22.12s/it]
Task 5, Epoch 20/20 => Loss 1.650, Train_accy 94.91:  95%|█████████▌| 19/20 [07:29<00:22, 22.12s/it]
Task 5, Epoch 20/20 => Loss 1.650, Train_accy 94.91: 100%|██████████| 20/20 [07:29<00:00, 21.94s/it]
Task 5, Epoch 20/20 => Loss 1.650, Train_accy 94.91: 100%|██████████| 20/20 [07:29<00:00, 22.49s/it]
2024-08-18 01:35:55,732 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.650, Train_accy 94.91
2024-08-18 01:35:55,734 [base.py] => Reducing exemplars...(66 per classes)
2024-08-18 01:36:04,355 [base.py] => Constructing exemplars...(66 per classes)
2024-08-18 01:36:20,467 [icarl.py] => Exemplar size: 1980
2024-08-18 01:36:20,467 [trainer.py] => CNN: {'total': 92.83, '00-04': 97.4, '05-09': 85.0, '10-14': 86.6, '15-19': 93.6, '20-24': 95.6, '25-29': 98.8, 'old': 91.64, 'new': 98.8}
2024-08-18 01:36:20,467 [trainer.py] => NME: {'total': 94.07, '00-04': 98.6, '05-09': 88.8, '10-14': 90.4, '15-19': 93.2, '20-24': 96.4, '25-29': 97.0, 'old': 93.48, 'new': 97.0}
2024-08-18 01:36:20,467 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83]
2024-08-18 01:36:20,467 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1]
2024-08-18 01:36:20,467 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07]
2024-08-18 01:36:20,467 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33]

Average Accuracy (CNN): 96.4
Average Accuracy (NME): 96.88
2024-08-18 01:36:20,468 [trainer.py] => Average Accuracy (CNN): 96.4
2024-08-18 01:36:20,468 [trainer.py] => Average Accuracy (NME): 96.88
2024-08-18 01:36:20,468 [trainer.py] => Train Time: 0
2024-08-18 01:36:20,468 [trainer.py] => Test Time: 33.53 

2024-08-18 01:36:20,468 [trainer.py] => All params: 85821726
2024-08-18 01:36:20,468 [trainer.py] => Trainable params: 85821726
2024-08-18 01:36:20,469 [icarl.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.294, Train_accy 79.82, Test_accy 90.51:   0%|          | 0/20 [00:26<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.294, Train_accy 79.82, Test_accy 90.51:   5%|▌         | 1/20 [00:26<08:30, 26.85s/it]
Task 6, Epoch 2/20 => Loss 1.782, Train_accy 89.17:   5%|▌         | 1/20 [00:48<08:30, 26.85s/it]                 
Task 6, Epoch 2/20 => Loss 1.782, Train_accy 89.17:  10%|█         | 2/20 [00:48<07:06, 23.72s/it]
Task 6, Epoch 3/20 => Loss 1.729, Train_accy 90.83:  10%|█         | 2/20 [01:09<07:06, 23.72s/it]
Task 6, Epoch 3/20 => Loss 1.729, Train_accy 90.83:  15%|█▌        | 3/20 [01:09<06:26, 22.74s/it]
Task 6, Epoch 4/20 => Loss 1.727, Train_accy 91.56:  15%|█▌        | 3/20 [01:31<06:26, 22.74s/it]
Task 6, Epoch 4/20 => Loss 1.727, Train_accy 91.56:  20%|██        | 4/20 [01:31<05:55, 22.24s/it]
Task 6, Epoch 5/20 => Loss 1.734, Train_accy 91.07:  20%|██        | 4/20 [01:52<05:55, 22.24s/it]
Task 6, Epoch 5/20 => Loss 1.734, Train_accy 91.07:  25%|██▌       | 5/20 [01:52<05:29, 21.96s/it]
Task 6, Epoch 6/20 => Loss 1.687, Train_accy 92.43, Test_accy 90.83:  25%|██▌       | 5/20 [02:19<05:29, 21.96s/it]
Task 6, Epoch 6/20 => Loss 1.687, Train_accy 92.43, Test_accy 90.83:  30%|███       | 6/20 [02:19<05:30, 23.59s/it]
Task 6, Epoch 7/20 => Loss 1.686, Train_accy 92.54:  30%|███       | 6/20 [02:41<05:30, 23.59s/it]                 
Task 6, Epoch 7/20 => Loss 1.686, Train_accy 92.54:  35%|███▌      | 7/20 [02:41<04:57, 22.90s/it]
Task 6, Epoch 8/20 => Loss 1.670, Train_accy 92.10:  35%|███▌      | 7/20 [03:02<04:57, 22.90s/it]
Task 6, Epoch 8/20 => Loss 1.670, Train_accy 92.10:  40%|████      | 8/20 [03:02<04:29, 22.49s/it]
Task 6, Epoch 9/20 => Loss 1.665, Train_accy 92.90:  40%|████      | 8/20 [03:24<04:29, 22.49s/it]
Task 6, Epoch 9/20 => Loss 1.665, Train_accy 92.90:  45%|████▌     | 9/20 [03:24<04:03, 22.17s/it]
Task 6, Epoch 10/20 => Loss 1.699, Train_accy 92.77:  45%|████▌     | 9/20 [03:45<04:03, 22.17s/it]
Task 6, Epoch 10/20 => Loss 1.699, Train_accy 92.77:  50%|█████     | 10/20 [03:45<03:39, 21.98s/it]
Task 6, Epoch 11/20 => Loss 1.647, Train_accy 93.08, Test_accy 90.23:  50%|█████     | 10/20 [04:12<03:39, 21.98s/it]
Task 6, Epoch 11/20 => Loss 1.647, Train_accy 93.08, Test_accy 90.23:  55%|█████▌    | 11/20 [04:12<03:31, 23.46s/it]
Task 6, Epoch 12/20 => Loss 1.643, Train_accy 93.53:  55%|█████▌    | 11/20 [04:34<03:31, 23.46s/it]                 
Task 6, Epoch 12/20 => Loss 1.643, Train_accy 93.53:  60%|██████    | 12/20 [04:34<03:03, 22.88s/it]
Task 6, Epoch 13/20 => Loss 1.643, Train_accy 93.62:  60%|██████    | 12/20 [04:55<03:03, 22.88s/it]
Task 6, Epoch 13/20 => Loss 1.643, Train_accy 93.62:  65%|██████▌   | 13/20 [04:55<02:37, 22.45s/it]
Task 6, Epoch 14/20 => Loss 1.661, Train_accy 93.57:  65%|██████▌   | 13/20 [05:17<02:37, 22.45s/it]
Task 6, Epoch 14/20 => Loss 1.661, Train_accy 93.57:  70%|███████   | 14/20 [05:17<02:12, 22.15s/it]
Task 6, Epoch 15/20 => Loss 1.610, Train_accy 94.73:  70%|███████   | 14/20 [05:38<02:12, 22.15s/it]
Task 6, Epoch 15/20 => Loss 1.610, Train_accy 94.73:  75%|███████▌  | 15/20 [05:38<01:49, 21.94s/it]
Task 6, Epoch 16/20 => Loss 1.655, Train_accy 93.26, Test_accy 90.60:  75%|███████▌  | 15/20 [06:05<01:49, 21.94s/it]
Task 6, Epoch 16/20 => Loss 1.655, Train_accy 93.26, Test_accy 90.60:  80%|████████  | 16/20 [06:05<01:33, 23.39s/it]
Task 6, Epoch 17/20 => Loss 1.636, Train_accy 94.17:  80%|████████  | 16/20 [06:26<01:33, 23.39s/it]                 
Task 6, Epoch 17/20 => Loss 1.636, Train_accy 94.17:  85%|████████▌ | 17/20 [06:26<01:08, 22.83s/it]
Task 6, Epoch 18/20 => Loss 1.652, Train_accy 93.82:  85%|████████▌ | 17/20 [06:48<01:08, 22.83s/it]
Task 6, Epoch 18/20 => Loss 1.652, Train_accy 93.82:  90%|█████████ | 18/20 [06:48<00:44, 22.44s/it]
Task 6, Epoch 19/20 => Loss 1.636, Train_accy 94.15:  90%|█████████ | 18/20 [07:09<00:44, 22.44s/it]
Task 6, Epoch 19/20 => Loss 1.636, Train_accy 94.15:  95%|█████████▌| 19/20 [07:09<00:22, 22.16s/it]
Task 6, Epoch 20/20 => Loss 1.626, Train_accy 94.20:  95%|█████████▌| 19/20 [07:31<00:22, 22.16s/it]
Task 6, Epoch 20/20 => Loss 1.626, Train_accy 94.20: 100%|██████████| 20/20 [07:31<00:00, 21.97s/it]
Task 6, Epoch 20/20 => Loss 1.626, Train_accy 94.20: 100%|██████████| 20/20 [07:31<00:00, 22.57s/it]
2024-08-18 01:43:51,848 [icarl.py] => Task 6, Epoch 20/20 => Loss 1.626, Train_accy 94.20
2024-08-18 01:43:51,849 [base.py] => Reducing exemplars...(57 per classes)
2024-08-18 01:44:01,327 [base.py] => Constructing exemplars...(57 per classes)
2024-08-18 01:44:18,337 [icarl.py] => Exemplar size: 1995
2024-08-18 01:44:18,338 [trainer.py] => CNN: {'total': 89.4, '00-04': 93.8, '05-09': 76.4, '10-14': 86.0, '15-19': 87.8, '20-24': 90.0, '25-29': 97.0, '30-34': 94.8, 'old': 88.5, 'new': 94.8}
2024-08-18 01:44:18,338 [trainer.py] => NME: {'total': 92.43, '00-04': 98.0, '05-09': 85.8, '10-14': 89.4, '15-19': 89.0, '20-24': 95.0, '25-29': 96.4, '30-34': 93.4, 'old': 92.27, 'new': 93.4}
2024-08-18 01:44:18,338 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4]
2024-08-18 01:44:18,338 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66]
2024-08-18 01:44:18,338 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43]
2024-08-18 01:44:18,338 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43]

Average Accuracy (CNN): 95.4
Average Accuracy (NME): 96.25
2024-08-18 01:44:18,338 [trainer.py] => Average Accuracy (CNN): 95.4
2024-08-18 01:44:18,338 [trainer.py] => Average Accuracy (NME): 96.25
2024-08-18 01:44:18,338 [trainer.py] => Train Time: 0
2024-08-18 01:44:18,338 [trainer.py] => Test Time: 43.97 

2024-08-18 01:44:18,338 [trainer.py] => All params: 85825571
2024-08-18 01:44:18,339 [trainer.py] => Trainable params: 85825571
2024-08-18 01:44:18,340 [icarl.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.345, Train_accy 83.38, Test_accy 89.00:   0%|          | 0/20 [00:27<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.345, Train_accy 83.38, Test_accy 89.00:   5%|▌         | 1/20 [00:27<08:42, 27.51s/it]
Task 7, Epoch 2/20 => Loss 1.862, Train_accy 92.06:   5%|▌         | 1/20 [00:49<08:42, 27.51s/it]                 
Task 7, Epoch 2/20 => Loss 1.862, Train_accy 92.06:  10%|█         | 2/20 [00:49<07:12, 24.00s/it]
Task 7, Epoch 3/20 => Loss 1.818, Train_accy 92.28:  10%|█         | 2/20 [01:10<07:12, 24.00s/it]
Task 7, Epoch 3/20 => Loss 1.818, Train_accy 92.28:  15%|█▌        | 3/20 [01:10<06:28, 22.87s/it]
Task 7, Epoch 4/20 => Loss 1.847, Train_accy 92.15:  15%|█▌        | 3/20 [01:32<06:28, 22.87s/it]
Task 7, Epoch 4/20 => Loss 1.847, Train_accy 92.15:  20%|██        | 4/20 [01:32<05:57, 22.35s/it]
Task 7, Epoch 5/20 => Loss 1.827, Train_accy 92.93:  20%|██        | 4/20 [01:53<05:57, 22.35s/it]
Task 7, Epoch 5/20 => Loss 1.827, Train_accy 92.93:  25%|██▌       | 5/20 [01:53<05:30, 22.06s/it]
Task 7, Epoch 6/20 => Loss 1.809, Train_accy 93.88, Test_accy 89.15:  25%|██▌       | 5/20 [02:21<05:30, 22.06s/it]
Task 7, Epoch 6/20 => Loss 1.809, Train_accy 93.88, Test_accy 89.15:  30%|███       | 6/20 [02:21<05:34, 23.89s/it]
Task 7, Epoch 7/20 => Loss 1.809, Train_accy 93.95:  30%|███       | 6/20 [02:42<05:34, 23.89s/it]                 
Task 7, Epoch 7/20 => Loss 1.809, Train_accy 93.95:  35%|███▌      | 7/20 [02:42<05:01, 23.16s/it]
Task 7, Epoch 8/20 => Loss 1.791, Train_accy 93.66:  35%|███▌      | 7/20 [03:04<05:01, 23.16s/it]
Task 7, Epoch 8/20 => Loss 1.791, Train_accy 93.66:  40%|████      | 8/20 [03:04<04:31, 22.67s/it]
Task 7, Epoch 9/20 => Loss 1.817, Train_accy 93.77:  40%|████      | 8/20 [03:25<04:31, 22.67s/it]
Task 7, Epoch 9/20 => Loss 1.817, Train_accy 93.77:  45%|████▌     | 9/20 [03:25<04:05, 22.33s/it]
Task 7, Epoch 10/20 => Loss 1.804, Train_accy 94.15:  45%|████▌     | 9/20 [03:47<04:05, 22.33s/it]
Task 7, Epoch 10/20 => Loss 1.804, Train_accy 94.15:  50%|█████     | 10/20 [03:47<03:41, 22.11s/it]
Task 7, Epoch 11/20 => Loss 1.773, Train_accy 93.84, Test_accy 89.35:  50%|█████     | 10/20 [04:15<03:41, 22.11s/it]
Task 7, Epoch 11/20 => Loss 1.773, Train_accy 93.84, Test_accy 89.35:  55%|█████▌    | 11/20 [04:15<03:33, 23.77s/it]
Task 7, Epoch 12/20 => Loss 1.830, Train_accy 93.44:  55%|█████▌    | 11/20 [04:36<03:33, 23.77s/it]                 
Task 7, Epoch 12/20 => Loss 1.830, Train_accy 93.44:  60%|██████    | 12/20 [04:36<03:04, 23.12s/it]
Task 7, Epoch 13/20 => Loss 1.779, Train_accy 94.08:  60%|██████    | 12/20 [04:58<03:04, 23.12s/it]
Task 7, Epoch 13/20 => Loss 1.779, Train_accy 94.08:  65%|██████▌   | 13/20 [04:58<02:38, 22.66s/it]
Task 7, Epoch 14/20 => Loss 1.768, Train_accy 94.37:  65%|██████▌   | 13/20 [05:19<02:38, 22.66s/it]
Task 7, Epoch 14/20 => Loss 1.768, Train_accy 94.37:  70%|███████   | 14/20 [05:19<02:14, 22.35s/it]
Task 7, Epoch 15/20 => Loss 1.755, Train_accy 95.08:  70%|███████   | 14/20 [05:41<02:14, 22.35s/it]
Task 7, Epoch 15/20 => Loss 1.755, Train_accy 95.08:  75%|███████▌  | 15/20 [05:41<01:50, 22.12s/it]
Task 7, Epoch 16/20 => Loss 1.742, Train_accy 94.86, Test_accy 88.92:  75%|███████▌  | 15/20 [06:08<01:50, 22.12s/it]
Task 7, Epoch 16/20 => Loss 1.742, Train_accy 94.86, Test_accy 88.92:  80%|████████  | 16/20 [06:08<01:34, 23.72s/it]
Task 7, Epoch 17/20 => Loss 1.764, Train_accy 94.77:  80%|████████  | 16/20 [06:30<01:34, 23.72s/it]                 
Task 7, Epoch 17/20 => Loss 1.764, Train_accy 94.77:  85%|████████▌ | 17/20 [06:30<01:09, 23.06s/it]
Task 7, Epoch 18/20 => Loss 1.763, Train_accy 94.66:  85%|████████▌ | 17/20 [06:52<01:09, 23.06s/it]
Task 7, Epoch 18/20 => Loss 1.763, Train_accy 94.66:  90%|█████████ | 18/20 [06:52<00:45, 22.62s/it]
Task 7, Epoch 19/20 => Loss 1.786, Train_accy 94.51:  90%|█████████ | 18/20 [07:13<00:45, 22.62s/it]
Task 7, Epoch 19/20 => Loss 1.786, Train_accy 94.51:  95%|█████████▌| 19/20 [07:13<00:22, 22.29s/it]
Task 7, Epoch 20/20 => Loss 1.714, Train_accy 95.26:  95%|█████████▌| 19/20 [07:35<00:22, 22.29s/it]
Task 7, Epoch 20/20 => Loss 1.714, Train_accy 95.26: 100%|██████████| 20/20 [07:35<00:00, 22.05s/it]
Task 7, Epoch 20/20 => Loss 1.714, Train_accy 95.26: 100%|██████████| 20/20 [07:35<00:00, 22.76s/it]
2024-08-18 01:51:53,526 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.714, Train_accy 95.26
2024-08-18 01:51:53,527 [base.py] => Reducing exemplars...(50 per classes)
2024-08-18 01:52:03,937 [base.py] => Constructing exemplars...(50 per classes)
2024-08-18 01:52:22,307 [icarl.py] => Exemplar size: 2000
2024-08-18 01:52:22,307 [trainer.py] => CNN: {'total': 87.85, '00-04': 88.8, '05-09': 77.4, '10-14': 80.0, '15-19': 83.0, '20-24': 92.6, '25-29': 90.2, '30-34': 92.2, '35-39': 98.6, 'old': 86.31, 'new': 98.6}
2024-08-18 01:52:22,307 [trainer.py] => NME: {'total': 92.02, '00-04': 96.6, '05-09': 85.2, '10-14': 87.8, '15-19': 87.4, '20-24': 95.8, '25-29': 94.0, '30-34': 92.6, '35-39': 96.8, 'old': 91.34, 'new': 96.8}
2024-08-18 01:52:22,307 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85]
2024-08-18 01:52:22,307 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02]
2024-08-18 01:52:22,307 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02]
2024-08-18 01:52:22,307 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95]

Average Accuracy (CNN): 94.46
Average Accuracy (NME): 95.72
2024-08-18 01:52:22,307 [trainer.py] => Average Accuracy (CNN): 94.46
2024-08-18 01:52:22,308 [trainer.py] => Average Accuracy (NME): 95.72
2024-08-18 01:52:22,308 [trainer.py] => Train Time: 0
2024-08-18 01:52:22,308 [trainer.py] => Test Time: 55.76 

2024-08-18 01:52:22,308 [trainer.py] => All params: 85829416
2024-08-18 01:52:22,309 [trainer.py] => Trainable params: 85829416
2024-08-18 01:52:22,309 [icarl.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.561, Train_accy 82.44, Test_accy 85.04:   0%|          | 0/20 [00:28<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.561, Train_accy 82.44, Test_accy 85.04:   5%|▌         | 1/20 [00:28<08:53, 28.07s/it]
Task 8, Epoch 2/20 => Loss 2.080, Train_accy 89.87:   5%|▌         | 1/20 [00:49<08:53, 28.07s/it]                 
Task 8, Epoch 2/20 => Loss 2.080, Train_accy 89.87:  10%|█         | 2/20 [00:49<07:17, 24.29s/it]
Task 8, Epoch 3/20 => Loss 2.015, Train_accy 92.22:  10%|█         | 2/20 [01:11<07:17, 24.29s/it]
Task 8, Epoch 3/20 => Loss 2.015, Train_accy 92.22:  15%|█▌        | 3/20 [01:11<06:32, 23.08s/it]
Task 8, Epoch 4/20 => Loss 2.008, Train_accy 92.69:  15%|█▌        | 3/20 [01:32<06:32, 23.08s/it]
Task 8, Epoch 4/20 => Loss 2.008, Train_accy 92.69:  20%|██        | 4/20 [01:32<06:00, 22.51s/it]
Task 8, Epoch 5/20 => Loss 1.974, Train_accy 93.53:  20%|██        | 4/20 [01:54<06:00, 22.51s/it]
Task 8, Epoch 5/20 => Loss 1.974, Train_accy 93.53:  25%|██▌       | 5/20 [01:54<05:32, 22.14s/it]
Task 8, Epoch 6/20 => Loss 2.012, Train_accy 92.76, Test_accy 84.56:  25%|██▌       | 5/20 [02:22<05:32, 22.14s/it]
Task 8, Epoch 6/20 => Loss 2.012, Train_accy 92.76, Test_accy 84.56:  30%|███       | 6/20 [02:22<05:39, 24.22s/it]
Task 8, Epoch 7/20 => Loss 1.985, Train_accy 92.91:  30%|███       | 6/20 [02:44<05:39, 24.22s/it]                 
Task 8, Epoch 7/20 => Loss 1.985, Train_accy 92.91:  35%|███▌      | 7/20 [02:44<05:04, 23.39s/it]
Task 8, Epoch 8/20 => Loss 1.933, Train_accy 94.38:  35%|███▌      | 7/20 [03:06<05:04, 23.39s/it]
Task 8, Epoch 8/20 => Loss 1.933, Train_accy 94.38:  40%|████      | 8/20 [03:06<04:33, 22.83s/it]
Task 8, Epoch 9/20 => Loss 1.967, Train_accy 93.69:  40%|████      | 8/20 [03:27<04:33, 22.83s/it]
Task 8, Epoch 9/20 => Loss 1.967, Train_accy 93.69:  45%|████▌     | 9/20 [03:27<04:06, 22.42s/it]
Task 8, Epoch 10/20 => Loss 1.964, Train_accy 94.02:  45%|████▌     | 9/20 [03:49<04:06, 22.42s/it]
Task 8, Epoch 10/20 => Loss 1.964, Train_accy 94.02:  50%|█████     | 10/20 [03:49<03:41, 22.15s/it]
Task 8, Epoch 11/20 => Loss 1.965, Train_accy 94.20, Test_accy 86.31:  50%|█████     | 10/20 [04:17<03:41, 22.15s/it]
Task 8, Epoch 11/20 => Loss 1.965, Train_accy 94.20, Test_accy 86.31:  55%|█████▌    | 11/20 [04:17<03:35, 24.00s/it]
Task 8, Epoch 12/20 => Loss 1.936, Train_accy 94.36:  55%|█████▌    | 11/20 [04:38<03:35, 24.00s/it]                 
Task 8, Epoch 12/20 => Loss 1.936, Train_accy 94.36:  60%|██████    | 12/20 [04:38<03:06, 23.27s/it]
Task 8, Epoch 13/20 => Loss 1.941, Train_accy 94.38:  60%|██████    | 12/20 [05:00<03:06, 23.27s/it]
Task 8, Epoch 13/20 => Loss 1.941, Train_accy 94.38:  65%|██████▌   | 13/20 [05:00<02:39, 22.78s/it]
Task 8, Epoch 14/20 => Loss 1.934, Train_accy 94.82:  65%|██████▌   | 13/20 [05:22<02:39, 22.78s/it]
Task 8, Epoch 14/20 => Loss 1.934, Train_accy 94.82:  70%|███████   | 14/20 [05:22<02:14, 22.43s/it]
Task 8, Epoch 15/20 => Loss 1.930, Train_accy 94.69:  70%|███████   | 14/20 [05:43<02:14, 22.43s/it]
Task 8, Epoch 15/20 => Loss 1.930, Train_accy 94.69:  75%|███████▌  | 15/20 [05:43<01:50, 22.20s/it]
Task 8, Epoch 16/20 => Loss 1.969, Train_accy 93.87, Test_accy 86.11:  75%|███████▌  | 15/20 [06:12<01:50, 22.20s/it]
Task 8, Epoch 16/20 => Loss 1.969, Train_accy 93.87, Test_accy 86.11:  80%|████████  | 16/20 [06:12<01:36, 24.01s/it]
Task 8, Epoch 17/20 => Loss 1.926, Train_accy 94.38:  80%|████████  | 16/20 [06:33<01:36, 24.01s/it]                 
Task 8, Epoch 17/20 => Loss 1.926, Train_accy 94.38:  85%|████████▌ | 17/20 [06:33<01:09, 23.28s/it]
Task 8, Epoch 18/20 => Loss 1.934, Train_accy 94.56:  85%|████████▌ | 17/20 [06:55<01:09, 23.28s/it]
Task 8, Epoch 18/20 => Loss 1.934, Train_accy 94.56:  90%|█████████ | 18/20 [06:55<00:45, 22.80s/it]
Task 8, Epoch 19/20 => Loss 1.942, Train_accy 94.16:  90%|█████████ | 18/20 [07:16<00:45, 22.80s/it]
Task 8, Epoch 19/20 => Loss 1.942, Train_accy 94.16:  95%|█████████▌| 19/20 [07:16<00:22, 22.45s/it]
Task 8, Epoch 20/20 => Loss 1.927, Train_accy 95.27:  95%|█████████▌| 19/20 [07:38<00:22, 22.45s/it]
Task 8, Epoch 20/20 => Loss 1.927, Train_accy 95.27: 100%|██████████| 20/20 [07:38<00:00, 22.21s/it]
Task 8, Epoch 20/20 => Loss 1.927, Train_accy 95.27: 100%|██████████| 20/20 [07:38<00:00, 22.93s/it]
2024-08-18 02:00:00,934 [icarl.py] => Task 8, Epoch 20/20 => Loss 1.927, Train_accy 95.27
2024-08-18 02:00:00,935 [base.py] => Reducing exemplars...(44 per classes)
2024-08-18 02:00:12,020 [base.py] => Constructing exemplars...(44 per classes)
2024-08-18 02:00:31,799 [icarl.py] => Exemplar size: 1980
2024-08-18 02:00:31,799 [trainer.py] => CNN: {'total': 85.96, '00-04': 86.2, '05-09': 76.2, '10-14': 70.4, '15-19': 79.6, '20-24': 88.6, '25-29': 87.8, '30-34': 90.2, '35-39': 95.4, '40-44': 99.2, 'old': 84.3, 'new': 99.2}
2024-08-18 02:00:31,799 [trainer.py] => NME: {'total': 90.96, '00-04': 95.6, '05-09': 84.8, '10-14': 82.6, '15-19': 87.4, '20-24': 94.4, '25-29': 93.2, '30-34': 91.2, '35-39': 94.8, '40-44': 94.6, 'old': 90.5, 'new': 94.6}
2024-08-18 02:00:31,799 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96]
2024-08-18 02:00:31,799 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58]
2024-08-18 02:00:31,799 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96]
2024-08-18 02:00:31,799 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78]

Average Accuracy (CNN): 93.51
Average Accuracy (NME): 95.19
2024-08-18 02:00:31,799 [trainer.py] => Average Accuracy (CNN): 93.51
2024-08-18 02:00:31,799 [trainer.py] => Average Accuracy (NME): 95.19
2024-08-18 02:00:31,799 [trainer.py] => Train Time: 0
2024-08-18 02:00:31,799 [trainer.py] => Test Time: 69.02 

2024-08-18 02:00:31,800 [trainer.py] => All params: 85833261
2024-08-18 02:00:31,800 [trainer.py] => Trainable params: 85833261
2024-08-18 02:00:31,801 [icarl.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.357, Train_accy 85.38, Test_accy 83.76:   0%|          | 0/20 [00:28<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.357, Train_accy 85.38, Test_accy 83.76:   5%|▌         | 1/20 [00:28<09:07, 28.81s/it]
Task 9, Epoch 2/20 => Loss 1.821, Train_accy 92.05:   5%|▌         | 1/20 [00:50<09:07, 28.81s/it]                 
Task 9, Epoch 2/20 => Loss 1.821, Train_accy 92.05:  10%|█         | 2/20 [00:50<07:21, 24.52s/it]
Task 9, Epoch 3/20 => Loss 1.763, Train_accy 93.50:  10%|█         | 2/20 [01:11<07:21, 24.52s/it]
Task 9, Epoch 3/20 => Loss 1.763, Train_accy 93.50:  15%|█▌        | 3/20 [01:11<06:34, 23.19s/it]
Task 9, Epoch 4/20 => Loss 1.741, Train_accy 93.82:  15%|█▌        | 3/20 [01:33<06:34, 23.19s/it]
Task 9, Epoch 4/20 => Loss 1.741, Train_accy 93.82:  20%|██        | 4/20 [01:33<06:00, 22.55s/it]
Task 9, Epoch 5/20 => Loss 1.736, Train_accy 93.84:  20%|██        | 4/20 [01:55<06:00, 22.55s/it]
Task 9, Epoch 5/20 => Loss 1.736, Train_accy 93.84:  25%|██▌       | 5/20 [01:55<05:32, 22.20s/it]
Task 9, Epoch 6/20 => Loss 1.715, Train_accy 94.69, Test_accy 84.32:  25%|██▌       | 5/20 [02:24<05:32, 22.20s/it]
Task 9, Epoch 6/20 => Loss 1.715, Train_accy 94.69, Test_accy 84.32:  30%|███       | 6/20 [02:24<05:45, 24.65s/it]
Task 9, Epoch 7/20 => Loss 1.725, Train_accy 94.38:  30%|███       | 6/20 [02:46<05:45, 24.65s/it]                 
Task 9, Epoch 7/20 => Loss 1.725, Train_accy 94.38:  35%|███▌      | 7/20 [02:46<05:07, 23.65s/it]
Task 9, Epoch 8/20 => Loss 1.726, Train_accy 94.38:  35%|███▌      | 7/20 [03:07<05:07, 23.65s/it]
Task 9, Epoch 8/20 => Loss 1.726, Train_accy 94.38:  40%|████      | 8/20 [03:07<04:35, 22.96s/it]
Task 9, Epoch 9/20 => Loss 1.673, Train_accy 95.65:  40%|████      | 8/20 [03:29<04:35, 22.96s/it]
Task 9, Epoch 9/20 => Loss 1.673, Train_accy 95.65:  45%|████▌     | 9/20 [03:29<04:07, 22.53s/it]
Task 9, Epoch 10/20 => Loss 1.720, Train_accy 95.22:  45%|████▌     | 9/20 [03:50<04:07, 22.53s/it]
Task 9, Epoch 10/20 => Loss 1.720, Train_accy 95.22:  50%|█████     | 10/20 [03:50<03:41, 22.19s/it]
Task 9, Epoch 11/20 => Loss 1.717, Train_accy 94.69, Test_accy 85.58:  50%|█████     | 10/20 [04:19<03:41, 22.19s/it]
Task 9, Epoch 11/20 => Loss 1.717, Train_accy 94.69, Test_accy 85.58:  55%|█████▌    | 11/20 [04:19<03:38, 24.23s/it]
Task 9, Epoch 12/20 => Loss 1.768, Train_accy 93.75:  55%|█████▌    | 11/20 [04:40<03:38, 24.23s/it]                 
Task 9, Epoch 12/20 => Loss 1.768, Train_accy 93.75:  60%|██████    | 12/20 [04:40<03:07, 23.42s/it]
Task 9, Epoch 13/20 => Loss 1.730, Train_accy 94.73:  60%|██████    | 12/20 [05:02<03:07, 23.42s/it]
Task 9, Epoch 13/20 => Loss 1.730, Train_accy 94.73:  65%|██████▌   | 13/20 [05:02<02:39, 22.85s/it]
Task 9, Epoch 14/20 => Loss 1.735, Train_accy 95.18:  65%|██████▌   | 13/20 [05:24<02:39, 22.85s/it]
Task 9, Epoch 14/20 => Loss 1.735, Train_accy 95.18:  70%|███████   | 14/20 [05:24<02:14, 22.46s/it]
Task 9, Epoch 15/20 => Loss 1.712, Train_accy 94.53:  70%|███████   | 14/20 [05:45<02:14, 22.46s/it]
Task 9, Epoch 15/20 => Loss 1.712, Train_accy 94.53:  75%|███████▌  | 15/20 [05:45<01:51, 22.20s/it]
Task 9, Epoch 16/20 => Loss 1.714, Train_accy 94.91, Test_accy 83.98:  75%|███████▌  | 15/20 [06:14<01:51, 22.20s/it]
Task 9, Epoch 16/20 => Loss 1.714, Train_accy 94.91, Test_accy 83.98:  80%|████████  | 16/20 [06:14<01:36, 24.23s/it]
Task 9, Epoch 17/20 => Loss 1.720, Train_accy 95.20:  80%|████████  | 16/20 [06:36<01:36, 24.23s/it]                 
Task 9, Epoch 17/20 => Loss 1.720, Train_accy 95.20:  85%|████████▌ | 17/20 [06:36<01:10, 23.40s/it]
Task 9, Epoch 18/20 => Loss 1.676, Train_accy 95.60:  85%|████████▌ | 17/20 [06:57<01:10, 23.40s/it]
Task 9, Epoch 18/20 => Loss 1.676, Train_accy 95.60:  90%|█████████ | 18/20 [06:57<00:45, 22.83s/it]
Task 9, Epoch 19/20 => Loss 1.674, Train_accy 95.54:  90%|█████████ | 18/20 [07:19<00:45, 22.83s/it]
Task 9, Epoch 19/20 => Loss 1.674, Train_accy 95.54:  95%|█████████▌| 19/20 [07:19<00:22, 22.44s/it]
Task 9, Epoch 20/20 => Loss 1.686, Train_accy 95.31:  95%|█████████▌| 19/20 [07:40<00:22, 22.44s/it]
Task 9, Epoch 20/20 => Loss 1.686, Train_accy 95.31: 100%|██████████| 20/20 [07:40<00:00, 22.17s/it]
Task 9, Epoch 20/20 => Loss 1.686, Train_accy 95.31: 100%|██████████| 20/20 [07:40<00:00, 23.03s/it]
2024-08-18 02:08:12,507 [icarl.py] => Task 9, Epoch 20/20 => Loss 1.686, Train_accy 95.31
2024-08-18 02:08:12,509 [base.py] => Reducing exemplars...(40 per classes)
2024-08-18 02:08:24,088 [base.py] => Constructing exemplars...(40 per classes)
2024-08-18 02:08:45,319 [icarl.py] => Exemplar size: 2000
2024-08-18 02:08:45,319 [trainer.py] => CNN: {'total': 84.46, '00-04': 86.8, '05-09': 72.6, '10-14': 67.6, '15-19': 81.8, '20-24': 87.8, '25-29': 86.4, '30-34': 86.6, '35-39': 81.2, '40-44': 96.4, '45-49': 97.4, 'old': 83.02, 'new': 97.4}
2024-08-18 02:08:45,319 [trainer.py] => NME: {'total': 89.18, '00-04': 95.0, '05-09': 81.0, '10-14': 80.8, '15-19': 87.2, '20-24': 94.0, '25-29': 91.0, '30-34': 88.2, '35-39': 85.8, '40-44': 93.2, '45-49': 95.6, 'old': 88.47, 'new': 95.6}
2024-08-18 02:08:45,319 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46]
2024-08-18 02:08:45,319 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92]
2024-08-18 02:08:45,319 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18]
2024-08-18 02:08:45,319 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76]

Average Accuracy (CNN): 92.61
Average Accuracy (NME): 94.59
2024-08-18 02:08:45,320 [trainer.py] => Average Accuracy (CNN): 92.61
2024-08-18 02:08:45,320 [trainer.py] => Average Accuracy (NME): 94.59
2024-08-18 02:08:45,320 [trainer.py] => Train Time: 0
2024-08-18 02:08:45,320 [trainer.py] => Test Time: 83.86 

2024-08-18 02:08:45,320 [trainer.py] => All params: 85837106
2024-08-18 02:08:45,321 [trainer.py] => Trainable params: 85837106
2024-08-18 02:08:45,321 [icarl.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.503, Train_accy 82.42, Test_accy 83.29:   0%|          | 0/20 [00:29<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.503, Train_accy 82.42, Test_accy 83.29:   5%|▌         | 1/20 [00:29<09:24, 29.72s/it]
Task 10, Epoch 2/20 => Loss 1.842, Train_accy 92.02:   5%|▌         | 1/20 [00:51<09:24, 29.72s/it]                 
Task 10, Epoch 2/20 => Loss 1.842, Train_accy 92.02:  10%|█         | 2/20 [00:51<07:29, 24.99s/it]
Task 10, Epoch 3/20 => Loss 1.814, Train_accy 92.64:  10%|█         | 2/20 [01:13<07:29, 24.99s/it]
Task 10, Epoch 3/20 => Loss 1.814, Train_accy 92.64:  15%|█▌        | 3/20 [01:13<06:38, 23.46s/it]
Task 10, Epoch 4/20 => Loss 1.832, Train_accy 92.53:  15%|█▌        | 3/20 [01:34<06:38, 23.46s/it]
Task 10, Epoch 4/20 => Loss 1.832, Train_accy 92.53:  20%|██        | 4/20 [01:34<06:03, 22.70s/it]
Task 10, Epoch 5/20 => Loss 1.770, Train_accy 94.36:  20%|██        | 4/20 [01:56<06:03, 22.70s/it]
Task 10, Epoch 5/20 => Loss 1.770, Train_accy 94.36:  25%|██▌       | 5/20 [01:56<05:34, 22.29s/it]
Task 10, Epoch 6/20 => Loss 1.834, Train_accy 92.51, Test_accy 82.38:  25%|██▌       | 5/20 [02:25<05:34, 22.29s/it]
Task 10, Epoch 6/20 => Loss 1.834, Train_accy 92.51, Test_accy 82.38:  30%|███       | 6/20 [02:25<05:47, 24.80s/it]
Task 10, Epoch 7/20 => Loss 1.817, Train_accy 93.49:  30%|███       | 6/20 [02:47<05:47, 24.80s/it]                 
Task 10, Epoch 7/20 => Loss 1.817, Train_accy 93.49:  35%|███▌      | 7/20 [02:47<05:08, 23.74s/it]
Task 10, Epoch 8/20 => Loss 1.812, Train_accy 93.82:  35%|███▌      | 7/20 [03:08<05:08, 23.74s/it]
Task 10, Epoch 8/20 => Loss 1.812, Train_accy 93.82:  40%|████      | 8/20 [03:08<04:36, 23.02s/it]
Task 10, Epoch 9/20 => Loss 1.782, Train_accy 94.67:  40%|████      | 8/20 [03:30<04:36, 23.02s/it]
Task 10, Epoch 9/20 => Loss 1.782, Train_accy 94.67:  45%|████▌     | 9/20 [03:30<04:08, 22.56s/it]
Task 10, Epoch 10/20 => Loss 1.725, Train_accy 94.80:  45%|████▌     | 9/20 [03:51<04:08, 22.56s/it]
Task 10, Epoch 10/20 => Loss 1.725, Train_accy 94.80:  50%|█████     | 10/20 [03:51<03:42, 22.25s/it]
Task 10, Epoch 11/20 => Loss 1.766, Train_accy 94.71, Test_accy 82.84:  50%|█████     | 10/20 [04:21<03:42, 22.25s/it]
Task 10, Epoch 11/20 => Loss 1.766, Train_accy 94.71, Test_accy 82.84:  55%|█████▌    | 11/20 [04:21<03:40, 24.48s/it]
Task 10, Epoch 12/20 => Loss 1.739, Train_accy 94.69:  55%|█████▌    | 11/20 [04:43<03:40, 24.48s/it]                 
Task 10, Epoch 12/20 => Loss 1.739, Train_accy 94.69:  60%|██████    | 12/20 [04:43<03:08, 23.58s/it]
Task 10, Epoch 13/20 => Loss 1.750, Train_accy 94.91:  60%|██████    | 12/20 [05:04<03:08, 23.58s/it]
Task 10, Epoch 13/20 => Loss 1.750, Train_accy 94.91:  65%|██████▌   | 13/20 [05:04<02:40, 22.95s/it]
Task 10, Epoch 14/20 => Loss 1.781, Train_accy 94.36:  65%|██████▌   | 13/20 [05:25<02:40, 22.95s/it]
Task 10, Epoch 14/20 => Loss 1.781, Train_accy 94.36:  70%|███████   | 14/20 [05:25<02:15, 22.51s/it]
Task 10, Epoch 15/20 => Loss 1.759, Train_accy 94.71:  70%|███████   | 14/20 [05:47<02:15, 22.51s/it]
Task 10, Epoch 15/20 => Loss 1.759, Train_accy 94.71:  75%|███████▌  | 15/20 [05:47<01:51, 22.21s/it]
Task 10, Epoch 16/20 => Loss 1.735, Train_accy 95.02, Test_accy 83.09:  75%|███████▌  | 15/20 [06:16<01:51, 22.21s/it]
Task 10, Epoch 16/20 => Loss 1.735, Train_accy 95.02, Test_accy 83.09:  80%|████████  | 16/20 [06:16<01:37, 24.38s/it]
Task 10, Epoch 17/20 => Loss 1.776, Train_accy 94.89:  80%|████████  | 16/20 [06:38<01:37, 24.38s/it]                 
Task 10, Epoch 17/20 => Loss 1.776, Train_accy 94.89:  85%|████████▌ | 17/20 [06:38<01:10, 23.55s/it]
Task 10, Epoch 18/20 => Loss 1.737, Train_accy 95.22:  85%|████████▌ | 17/20 [07:00<01:10, 23.55s/it]
Task 10, Epoch 18/20 => Loss 1.737, Train_accy 95.22:  90%|█████████ | 18/20 [07:00<00:45, 22.98s/it]
Task 10, Epoch 19/20 => Loss 1.765, Train_accy 94.71:  90%|█████████ | 18/20 [07:21<00:45, 22.98s/it]
Task 10, Epoch 19/20 => Loss 1.765, Train_accy 94.71:  95%|█████████▌| 19/20 [07:21<00:22, 22.55s/it]
Task 10, Epoch 20/20 => Loss 1.767, Train_accy 94.73:  95%|█████████▌| 19/20 [07:43<00:22, 22.55s/it]
Task 10, Epoch 20/20 => Loss 1.767, Train_accy 94.73: 100%|██████████| 20/20 [07:43<00:00, 22.25s/it]
Task 10, Epoch 20/20 => Loss 1.767, Train_accy 94.73: 100%|██████████| 20/20 [07:43<00:00, 23.17s/it]
2024-08-18 02:16:28,670 [icarl.py] => Task 10, Epoch 20/20 => Loss 1.767, Train_accy 94.73
2024-08-18 02:16:28,671 [base.py] => Reducing exemplars...(36 per classes)
2024-08-18 02:16:41,713 [base.py] => Constructing exemplars...(36 per classes)
2024-08-18 02:17:04,478 [icarl.py] => Exemplar size: 1980
2024-08-18 02:17:04,478 [trainer.py] => CNN: {'total': 83.27, '00-04': 76.4, '05-09': 70.6, '10-14': 69.4, '15-19': 83.4, '20-24': 86.0, '25-29': 83.8, '30-34': 85.6, '35-39': 80.6, '40-44': 89.8, '45-49': 93.8, '50-54': 96.6, 'old': 81.94, 'new': 96.6}
2024-08-18 02:17:04,478 [trainer.py] => NME: {'total': 88.71, '00-04': 91.0, '05-09': 81.8, '10-14': 80.2, '15-19': 88.0, '20-24': 93.2, '25-29': 89.4, '30-34': 88.8, '35-39': 85.4, '40-44': 90.8, '45-49': 94.4, '50-54': 92.8, 'old': 88.3, 'new': 92.8}
2024-08-18 02:17:04,478 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27]
2024-08-18 02:17:04,478 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67]
2024-08-18 02:17:04,478 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71]
2024-08-18 02:17:04,478 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73]

Average Accuracy (CNN): 91.76
Average Accuracy (NME): 94.06
2024-08-18 02:17:04,478 [trainer.py] => Average Accuracy (CNN): 91.76
2024-08-18 02:17:04,478 [trainer.py] => Average Accuracy (NME): 94.06
2024-08-18 02:17:04,479 [trainer.py] => Train Time: 0
2024-08-18 02:17:04,479 [trainer.py] => Test Time: 100.23 

2024-08-18 02:17:04,479 [trainer.py] => All params: 85840951
2024-08-18 02:17:04,479 [trainer.py] => Trainable params: 85840951
2024-08-18 02:17:04,480 [icarl.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.756, Train_accy 81.05, Test_accy 83.25:   0%|          | 0/20 [00:30<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.756, Train_accy 81.05, Test_accy 83.25:   5%|▌         | 1/20 [00:30<09:39, 30.47s/it]
Task 11, Epoch 2/20 => Loss 2.302, Train_accy 89.82:   5%|▌         | 1/20 [00:52<09:39, 30.47s/it]                 
Task 11, Epoch 2/20 => Loss 2.302, Train_accy 89.82:  10%|█         | 2/20 [00:52<07:35, 25.33s/it]
Task 11, Epoch 3/20 => Loss 2.286, Train_accy 90.62:  10%|█         | 2/20 [01:13<07:35, 25.33s/it]
Task 11, Epoch 3/20 => Loss 2.286, Train_accy 90.62:  15%|█▌        | 3/20 [01:13<06:42, 23.68s/it]
Task 11, Epoch 4/20 => Loss 2.296, Train_accy 90.69:  15%|█▌        | 3/20 [01:35<06:42, 23.68s/it]
Task 11, Epoch 4/20 => Loss 2.296, Train_accy 90.69:  20%|██        | 4/20 [01:35<06:06, 22.89s/it]
Task 11, Epoch 5/20 => Loss 2.256, Train_accy 91.47:  20%|██        | 4/20 [01:57<06:06, 22.89s/it]
Task 11, Epoch 5/20 => Loss 2.256, Train_accy 91.47:  25%|██▌       | 5/20 [01:57<05:37, 22.47s/it]
Task 11, Epoch 6/20 => Loss 2.193, Train_accy 92.66, Test_accy 81.88:  25%|██▌       | 5/20 [02:28<05:37, 22.47s/it]
Task 11, Epoch 6/20 => Loss 2.193, Train_accy 92.66, Test_accy 81.88:  30%|███       | 6/20 [02:28<05:54, 25.30s/it]
Task 11, Epoch 7/20 => Loss 2.239, Train_accy 92.03:  30%|███       | 6/20 [02:49<05:54, 25.30s/it]                 
Task 11, Epoch 7/20 => Loss 2.239, Train_accy 92.03:  35%|███▌      | 7/20 [02:49<05:13, 24.14s/it]
Task 11, Epoch 8/20 => Loss 2.202, Train_accy 92.59:  35%|███▌      | 7/20 [03:11<05:13, 24.14s/it]
Task 11, Epoch 8/20 => Loss 2.202, Train_accy 92.59:  40%|████      | 8/20 [03:11<04:40, 23.37s/it]
Task 11, Epoch 9/20 => Loss 2.198, Train_accy 93.26:  40%|████      | 8/20 [03:33<04:40, 23.37s/it]
Task 11, Epoch 9/20 => Loss 2.198, Train_accy 93.26:  45%|████▌     | 9/20 [03:33<04:11, 22.88s/it]
Task 11, Epoch 10/20 => Loss 2.186, Train_accy 93.21:  45%|████▌     | 9/20 [03:55<04:11, 22.88s/it]
Task 11, Epoch 10/20 => Loss 2.186, Train_accy 93.21:  50%|█████     | 10/20 [03:55<03:45, 22.53s/it]
Task 11, Epoch 11/20 => Loss 2.214, Train_accy 92.77, Test_accy 82.87:  50%|█████     | 10/20 [04:25<03:45, 22.53s/it]
Task 11, Epoch 11/20 => Loss 2.214, Train_accy 92.77, Test_accy 82.87:  55%|█████▌    | 11/20 [04:25<03:45, 25.03s/it]
Task 11, Epoch 12/20 => Loss 2.178, Train_accy 93.55:  55%|█████▌    | 11/20 [04:47<03:45, 25.03s/it]                 
Task 11, Epoch 12/20 => Loss 2.178, Train_accy 93.55:  60%|██████    | 12/20 [04:47<03:12, 24.03s/it]
Task 11, Epoch 13/20 => Loss 2.206, Train_accy 93.21:  60%|██████    | 12/20 [05:09<03:12, 24.03s/it]
Task 11, Epoch 13/20 => Loss 2.206, Train_accy 93.21:  65%|██████▌   | 13/20 [05:09<02:43, 23.35s/it]
Task 11, Epoch 14/20 => Loss 2.162, Train_accy 93.64:  65%|██████▌   | 13/20 [05:31<02:43, 23.35s/it]
Task 11, Epoch 14/20 => Loss 2.162, Train_accy 93.64:  70%|███████   | 14/20 [05:31<02:17, 22.86s/it]
Task 11, Epoch 15/20 => Loss 2.187, Train_accy 93.44:  70%|███████   | 14/20 [05:52<02:17, 22.86s/it]
Task 11, Epoch 15/20 => Loss 2.187, Train_accy 93.44:  75%|███████▌  | 15/20 [05:52<01:52, 22.52s/it]
Task 11, Epoch 16/20 => Loss 2.163, Train_accy 94.08, Test_accy 82.65:  75%|███████▌  | 15/20 [06:23<01:52, 22.52s/it]
Task 11, Epoch 16/20 => Loss 2.163, Train_accy 94.08, Test_accy 82.65:  80%|████████  | 16/20 [06:23<01:39, 25.00s/it]
Task 11, Epoch 17/20 => Loss 2.179, Train_accy 93.73:  80%|████████  | 16/20 [06:45<01:39, 25.00s/it]                 
Task 11, Epoch 17/20 => Loss 2.179, Train_accy 93.73:  85%|████████▌ | 17/20 [06:45<01:12, 24.03s/it]
Task 11, Epoch 18/20 => Loss 2.185, Train_accy 93.73:  85%|████████▌ | 17/20 [07:07<01:12, 24.03s/it]
Task 11, Epoch 18/20 => Loss 2.185, Train_accy 93.73:  90%|█████████ | 18/20 [07:07<00:46, 23.32s/it]
Task 11, Epoch 19/20 => Loss 2.150, Train_accy 93.86:  90%|█████████ | 18/20 [07:28<00:46, 23.32s/it]
Task 11, Epoch 19/20 => Loss 2.150, Train_accy 93.86:  95%|█████████▌| 19/20 [07:28<00:22, 22.83s/it]
Task 11, Epoch 20/20 => Loss 2.223, Train_accy 93.30:  95%|█████████▌| 19/20 [07:50<00:22, 22.83s/it]
Task 11, Epoch 20/20 => Loss 2.223, Train_accy 93.30: 100%|██████████| 20/20 [07:50<00:00, 22.56s/it]
Task 11, Epoch 20/20 => Loss 2.223, Train_accy 93.30: 100%|██████████| 20/20 [07:50<00:00, 23.53s/it]
2024-08-18 02:24:55,162 [icarl.py] => Task 11, Epoch 20/20 => Loss 2.223, Train_accy 93.30
2024-08-18 02:24:55,164 [base.py] => Reducing exemplars...(33 per classes)
2024-08-18 02:25:07,274 [base.py] => Constructing exemplars...(33 per classes)
2024-08-18 02:25:31,902 [icarl.py] => Exemplar size: 1980
2024-08-18 02:25:31,902 [trainer.py] => CNN: {'total': 81.52, '00-04': 79.6, '05-09': 63.8, '10-14': 62.8, '15-19': 75.0, '20-24': 86.2, '25-29': 75.6, '30-34': 83.6, '35-39': 78.8, '40-44': 90.0, '45-49': 92.8, '50-54': 94.6, '55-59': 95.4, 'old': 80.25, 'new': 95.4}
2024-08-18 02:25:31,902 [trainer.py] => NME: {'total': 88.5, '00-04': 92.8, '05-09': 81.0, '10-14': 77.8, '15-19': 87.2, '20-24': 92.4, '25-29': 88.0, '30-34': 88.4, '35-39': 85.8, '40-44': 90.2, '45-49': 93.0, '50-54': 91.6, '55-59': 93.8, 'old': 88.02, 'new': 93.8}
2024-08-18 02:25:31,902 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52]
2024-08-18 02:25:31,902 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33]
2024-08-18 02:25:31,902 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5]
2024-08-18 02:25:31,903 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17]

Average Accuracy (CNN): 90.9
Average Accuracy (NME): 93.59
2024-08-18 02:25:31,903 [trainer.py] => Average Accuracy (CNN): 90.9
2024-08-18 02:25:31,903 [trainer.py] => Average Accuracy (NME): 93.59
2024-08-18 02:25:31,903 [trainer.py] => Train Time: 0
2024-08-18 02:25:31,903 [trainer.py] => Test Time: 118.51 

2024-08-18 02:25:31,903 [trainer.py] => All params: 85844796
2024-08-18 02:25:31,904 [trainer.py] => Trainable params: 85844796
2024-08-18 02:25:31,905 [icarl.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.582, Train_accy 84.24, Test_accy 77.77:   0%|          | 0/20 [00:31<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.582, Train_accy 84.24, Test_accy 77.77:   5%|▌         | 1/20 [00:31<09:58, 31.51s/it]
Task 12, Epoch 2/20 => Loss 1.939, Train_accy 92.23:   5%|▌         | 1/20 [00:53<09:58, 31.51s/it]                 
Task 12, Epoch 2/20 => Loss 1.939, Train_accy 92.23:  10%|█         | 2/20 [00:53<07:43, 25.74s/it]
Task 12, Epoch 3/20 => Loss 1.853, Train_accy 93.48:  10%|█         | 2/20 [01:14<07:43, 25.74s/it]
Task 12, Epoch 3/20 => Loss 1.853, Train_accy 93.48:  15%|█▌        | 3/20 [01:14<06:46, 23.91s/it]
Task 12, Epoch 4/20 => Loss 1.906, Train_accy 93.10:  15%|█▌        | 3/20 [01:36<06:46, 23.91s/it]
Task 12, Epoch 4/20 => Loss 1.906, Train_accy 93.10:  20%|██        | 4/20 [01:36<06:08, 23.05s/it]
Task 12, Epoch 5/20 => Loss 1.875, Train_accy 93.57:  20%|██        | 4/20 [01:58<06:08, 23.05s/it]
Task 12, Epoch 5/20 => Loss 1.875, Train_accy 93.57:  25%|██▌       | 5/20 [01:58<05:38, 22.55s/it]
Task 12, Epoch 6/20 => Loss 1.894, Train_accy 94.20, Test_accy 77.91:  25%|██▌       | 5/20 [02:29<05:38, 22.55s/it]
Task 12, Epoch 6/20 => Loss 1.894, Train_accy 94.20, Test_accy 77.91:  30%|███       | 6/20 [02:29<05:57, 25.56s/it]
Task 12, Epoch 7/20 => Loss 1.838, Train_accy 94.60:  30%|███       | 6/20 [02:51<05:57, 25.56s/it]                 
Task 12, Epoch 7/20 => Loss 1.838, Train_accy 94.60:  35%|███▌      | 7/20 [02:51<05:15, 24.28s/it]
Task 12, Epoch 8/20 => Loss 1.889, Train_accy 94.31:  35%|███▌      | 7/20 [03:13<05:15, 24.28s/it]
Task 12, Epoch 8/20 => Loss 1.889, Train_accy 94.31:  40%|████      | 8/20 [03:13<04:41, 23.46s/it]
Task 12, Epoch 9/20 => Loss 1.863, Train_accy 94.35:  40%|████      | 8/20 [03:34<04:41, 23.46s/it]
Task 12, Epoch 9/20 => Loss 1.863, Train_accy 94.35:  45%|████▌     | 9/20 [03:34<04:11, 22.89s/it]
Task 12, Epoch 10/20 => Loss 1.865, Train_accy 94.51:  45%|████▌     | 9/20 [03:56<04:11, 22.89s/it]
Task 12, Epoch 10/20 => Loss 1.865, Train_accy 94.51:  50%|█████     | 10/20 [03:56<03:45, 22.53s/it]
Task 12, Epoch 11/20 => Loss 1.859, Train_accy 94.62, Test_accy 81.32:  50%|█████     | 10/20 [04:27<03:45, 22.53s/it]
Task 12, Epoch 11/20 => Loss 1.859, Train_accy 94.62, Test_accy 81.32:  55%|█████▌    | 11/20 [04:27<03:47, 25.25s/it]
Task 12, Epoch 12/20 => Loss 1.845, Train_accy 94.62:  55%|█████▌    | 11/20 [04:49<03:47, 25.25s/it]                 
Task 12, Epoch 12/20 => Loss 1.845, Train_accy 94.62:  60%|██████    | 12/20 [04:49<03:13, 24.15s/it]
Task 12, Epoch 13/20 => Loss 1.830, Train_accy 94.98:  60%|██████    | 12/20 [05:11<03:13, 24.15s/it]
Task 12, Epoch 13/20 => Loss 1.830, Train_accy 94.98:  65%|██████▌   | 13/20 [05:11<02:43, 23.40s/it]
Task 12, Epoch 14/20 => Loss 1.827, Train_accy 95.27:  65%|██████▌   | 13/20 [05:32<02:43, 23.40s/it]
Task 12, Epoch 14/20 => Loss 1.827, Train_accy 95.27:  70%|███████   | 14/20 [05:32<02:17, 22.87s/it]
Task 12, Epoch 15/20 => Loss 1.833, Train_accy 94.89:  70%|███████   | 14/20 [05:54<02:17, 22.87s/it]
Task 12, Epoch 15/20 => Loss 1.833, Train_accy 94.89:  75%|███████▌  | 15/20 [05:54<01:52, 22.51s/it]
Task 12, Epoch 16/20 => Loss 1.838, Train_accy 95.18, Test_accy 80.75:  75%|███████▌  | 15/20 [06:25<01:52, 22.51s/it]
Task 12, Epoch 16/20 => Loss 1.838, Train_accy 95.18, Test_accy 80.75:  80%|████████  | 16/20 [06:25<01:40, 25.21s/it]
Task 12, Epoch 17/20 => Loss 1.784, Train_accy 95.45:  80%|████████  | 16/20 [06:47<01:40, 25.21s/it]                 
Task 12, Epoch 17/20 => Loss 1.784, Train_accy 95.45:  85%|████████▌ | 17/20 [06:47<01:12, 24.14s/it]
Task 12, Epoch 18/20 => Loss 1.833, Train_accy 95.13:  85%|████████▌ | 17/20 [07:09<01:12, 24.14s/it]
Task 12, Epoch 18/20 => Loss 1.833, Train_accy 95.13:  90%|█████████ | 18/20 [07:09<00:46, 23.37s/it]
Task 12, Epoch 19/20 => Loss 1.826, Train_accy 95.04:  90%|█████████ | 18/20 [07:30<00:46, 23.37s/it]
Task 12, Epoch 19/20 => Loss 1.826, Train_accy 95.04:  95%|█████████▌| 19/20 [07:30<00:22, 22.85s/it]
Task 12, Epoch 20/20 => Loss 1.818, Train_accy 95.56:  95%|█████████▌| 19/20 [07:52<00:22, 22.85s/it]
Task 12, Epoch 20/20 => Loss 1.818, Train_accy 95.56: 100%|██████████| 20/20 [07:52<00:00, 22.51s/it]
Task 12, Epoch 20/20 => Loss 1.818, Train_accy 95.56: 100%|██████████| 20/20 [07:52<00:00, 23.63s/it]
2024-08-18 02:33:24,511 [icarl.py] => Task 12, Epoch 20/20 => Loss 1.818, Train_accy 95.56
2024-08-18 02:33:24,512 [base.py] => Reducing exemplars...(30 per classes)
2024-08-18 02:33:37,299 [base.py] => Constructing exemplars...(30 per classes)
2024-08-18 02:34:02,745 [icarl.py] => Exemplar size: 1950
2024-08-18 02:34:02,746 [trainer.py] => CNN: {'total': 79.75, '00-04': 81.2, '05-09': 66.6, '10-14': 59.6, '15-19': 70.0, '20-24': 85.2, '25-29': 74.6, '30-34': 83.4, '35-39': 78.8, '40-44': 87.0, '45-49': 89.0, '50-54': 91.2, '55-59': 71.4, '60-64': 98.8, 'old': 78.17, 'new': 98.8}
2024-08-18 02:34:02,746 [trainer.py] => NME: {'total': 87.06, '00-04': 91.8, '05-09': 79.4, '10-14': 75.4, '15-19': 84.6, '20-24': 93.4, '25-29': 87.2, '30-34': 87.0, '35-39': 84.6, '40-44': 88.6, '45-49': 93.0, '50-54': 89.6, '55-59': 84.2, '60-64': 93.0, 'old': 86.57, 'new': 93.0}
2024-08-18 02:34:02,746 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75]
2024-08-18 02:34:02,746 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52]
2024-08-18 02:34:02,746 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06]
2024-08-18 02:34:02,746 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05]

Average Accuracy (CNN): 90.05
Average Accuracy (NME): 93.09
2024-08-18 02:34:02,746 [trainer.py] => Average Accuracy (CNN): 90.05
2024-08-18 02:34:02,746 [trainer.py] => Average Accuracy (NME): 93.09
2024-08-18 02:34:02,746 [trainer.py] => Train Time: 0
2024-08-18 02:34:02,746 [trainer.py] => Test Time: 137.93 

2024-08-18 02:34:02,747 [trainer.py] => All params: 85848641
2024-08-18 02:34:02,747 [trainer.py] => Trainable params: 85848641
2024-08-18 02:34:02,748 [icarl.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.618, Train_accy 85.06, Test_accy 78.50:   0%|          | 0/20 [00:31<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.618, Train_accy 85.06, Test_accy 78.50:   5%|▌         | 1/20 [00:31<10:06, 31.93s/it]
Task 13, Epoch 2/20 => Loss 2.002, Train_accy 93.89:   5%|▌         | 1/20 [00:53<10:06, 31.93s/it]                 
Task 13, Epoch 2/20 => Loss 2.002, Train_accy 93.89:  10%|█         | 2/20 [00:53<07:44, 25.81s/it]
Task 13, Epoch 3/20 => Loss 1.974, Train_accy 94.20:  10%|█         | 2/20 [01:14<07:44, 25.81s/it]
Task 13, Epoch 3/20 => Loss 1.974, Train_accy 94.20:  15%|█▌        | 3/20 [01:14<06:45, 23.86s/it]
Task 13, Epoch 4/20 => Loss 1.993, Train_accy 94.65:  15%|█▌        | 3/20 [01:36<06:45, 23.86s/it]
Task 13, Epoch 4/20 => Loss 1.993, Train_accy 94.65:  20%|██        | 4/20 [01:36<06:07, 22.95s/it]
Task 13, Epoch 5/20 => Loss 1.984, Train_accy 94.43:  20%|██        | 4/20 [01:58<06:07, 22.95s/it]
Task 13, Epoch 5/20 => Loss 1.984, Train_accy 94.43:  25%|██▌       | 5/20 [01:58<05:36, 22.42s/it]
Task 13, Epoch 6/20 => Loss 1.945, Train_accy 94.94, Test_accy 78.83:  25%|██▌       | 5/20 [02:30<05:36, 22.42s/it]
Task 13, Epoch 6/20 => Loss 1.945, Train_accy 94.94, Test_accy 78.83:  30%|███       | 6/20 [02:30<05:59, 25.69s/it]
Task 13, Epoch 7/20 => Loss 1.942, Train_accy 95.08:  30%|███       | 6/20 [02:51<05:59, 25.69s/it]                 
Task 13, Epoch 7/20 => Loss 1.942, Train_accy 95.08:  35%|███▌      | 7/20 [02:51<05:16, 24.32s/it]
Task 13, Epoch 8/20 => Loss 1.938, Train_accy 95.33:  35%|███▌      | 7/20 [03:13<05:16, 24.32s/it]
Task 13, Epoch 8/20 => Loss 1.938, Train_accy 95.33:  40%|████      | 8/20 [03:13<04:41, 23.44s/it]
Task 13, Epoch 9/20 => Loss 1.976, Train_accy 94.52:  40%|████      | 8/20 [03:34<04:41, 23.44s/it]
Task 13, Epoch 9/20 => Loss 1.976, Train_accy 94.52:  45%|████▌     | 9/20 [03:34<04:11, 22.82s/it]
Task 13, Epoch 10/20 => Loss 1.942, Train_accy 95.30:  45%|████▌     | 9/20 [03:56<04:11, 22.82s/it]
Task 13, Epoch 10/20 => Loss 1.942, Train_accy 95.30:  50%|█████     | 10/20 [03:56<03:43, 22.40s/it]
Task 13, Epoch 11/20 => Loss 1.946, Train_accy 95.33, Test_accy 79.90:  50%|█████     | 10/20 [04:28<03:43, 22.40s/it]
Task 13, Epoch 11/20 => Loss 1.946, Train_accy 95.33, Test_accy 79.90:  55%|█████▌    | 11/20 [04:28<03:48, 25.37s/it]
Task 13, Epoch 12/20 => Loss 1.953, Train_accy 95.57:  55%|█████▌    | 11/20 [04:49<03:48, 25.37s/it]                 
Task 13, Epoch 12/20 => Loss 1.953, Train_accy 95.57:  60%|██████    | 12/20 [04:49<03:13, 24.23s/it]
Task 13, Epoch 13/20 => Loss 1.950, Train_accy 95.64:  60%|██████    | 12/20 [05:11<03:13, 24.23s/it]
Task 13, Epoch 13/20 => Loss 1.950, Train_accy 95.64:  65%|██████▌   | 13/20 [05:11<02:43, 23.41s/it]
Task 13, Epoch 14/20 => Loss 1.979, Train_accy 94.88:  65%|██████▌   | 13/20 [05:32<02:43, 23.41s/it]
Task 13, Epoch 14/20 => Loss 1.979, Train_accy 94.88:  70%|███████   | 14/20 [05:32<02:17, 22.84s/it]
Task 13, Epoch 15/20 => Loss 1.907, Train_accy 95.42:  70%|███████   | 14/20 [05:54<02:17, 22.84s/it]
Task 13, Epoch 15/20 => Loss 1.907, Train_accy 95.42:  75%|███████▌  | 15/20 [05:54<01:52, 22.43s/it]
Task 13, Epoch 16/20 => Loss 1.971, Train_accy 94.85, Test_accy 80.00:  75%|███████▌  | 15/20 [06:26<01:52, 22.43s/it]
Task 13, Epoch 16/20 => Loss 1.971, Train_accy 94.85, Test_accy 80.00:  80%|████████  | 16/20 [06:26<01:40, 25.25s/it]
Task 13, Epoch 17/20 => Loss 1.927, Train_accy 95.71:  80%|████████  | 16/20 [06:47<01:40, 25.25s/it]                 
Task 13, Epoch 17/20 => Loss 1.927, Train_accy 95.71:  85%|████████▌ | 17/20 [06:47<01:12, 24.14s/it]
Task 13, Epoch 18/20 => Loss 1.958, Train_accy 95.39:  85%|████████▌ | 17/20 [07:09<01:12, 24.14s/it]
Task 13, Epoch 18/20 => Loss 1.958, Train_accy 95.39:  90%|█████████ | 18/20 [07:09<00:46, 23.34s/it]
Task 13, Epoch 19/20 => Loss 1.956, Train_accy 95.55:  90%|█████████ | 18/20 [07:30<00:46, 23.34s/it]
Task 13, Epoch 19/20 => Loss 1.956, Train_accy 95.55:  95%|█████████▌| 19/20 [07:30<00:22, 22.78s/it]
Task 13, Epoch 20/20 => Loss 1.930, Train_accy 96.11:  95%|█████████▌| 19/20 [07:52<00:22, 22.78s/it]
Task 13, Epoch 20/20 => Loss 1.930, Train_accy 96.11: 100%|██████████| 20/20 [07:52<00:00, 22.38s/it]
Task 13, Epoch 20/20 => Loss 1.930, Train_accy 96.11: 100%|██████████| 20/20 [07:52<00:00, 23.60s/it]
2024-08-18 02:41:54,824 [icarl.py] => Task 13, Epoch 20/20 => Loss 1.930, Train_accy 96.11
2024-08-18 02:41:54,825 [base.py] => Reducing exemplars...(28 per classes)
2024-08-18 02:42:07,919 [base.py] => Constructing exemplars...(28 per classes)
2024-08-18 02:42:34,703 [icarl.py] => Exemplar size: 1960
2024-08-18 02:42:34,703 [trainer.py] => CNN: {'total': 79.97, '00-04': 77.2, '05-09': 67.8, '10-14': 59.4, '15-19': 69.6, '20-24': 85.0, '25-29': 76.0, '30-34': 84.0, '35-39': 72.0, '40-44': 86.0, '45-49': 88.0, '50-54': 87.6, '55-59': 74.2, '60-64': 93.4, '65-69': 99.4, 'old': 78.48, 'new': 99.4}
2024-08-18 02:42:34,703 [trainer.py] => NME: {'total': 87.33, '00-04': 89.6, '05-09': 79.6, '10-14': 74.0, '15-19': 83.4, '20-24': 93.6, '25-29': 88.0, '30-34': 88.8, '35-39': 82.8, '40-44': 89.2, '45-49': 93.4, '50-54': 89.6, '55-59': 84.0, '60-64': 89.4, '65-69': 97.2, 'old': 86.57, 'new': 97.2}
2024-08-18 02:42:34,703 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75, 79.97]
2024-08-18 02:42:34,704 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52, 94.14]
2024-08-18 02:42:34,704 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06, 87.33]
2024-08-18 02:42:34,704 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05, 97.77]

Average Accuracy (CNN): 89.33
Average Accuracy (NME): 92.68
2024-08-18 02:42:34,704 [trainer.py] => Average Accuracy (CNN): 89.33
2024-08-18 02:42:34,704 [trainer.py] => Average Accuracy (NME): 92.68
2024-08-18 02:42:34,704 [trainer.py] => Train Time: 0
2024-08-18 02:42:34,704 [trainer.py] => Test Time: 158.85000000000002 

2024-08-18 02:42:34,704 [trainer.py] => All params: 85852486
2024-08-18 02:42:34,705 [trainer.py] => Trainable params: 85852486
2024-08-18 02:42:34,706 [icarl.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.661, Train_accy 82.91, Test_accy 76.59:   0%|          | 0/20 [00:32<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.661, Train_accy 82.91, Test_accy 76.59:   5%|▌         | 1/20 [00:32<10:22, 32.78s/it]
Task 14, Epoch 2/20 => Loss 1.992, Train_accy 92.04:   5%|▌         | 1/20 [00:54<10:22, 32.78s/it]                 
Task 14, Epoch 2/20 => Loss 1.992, Train_accy 92.04:  10%|█         | 2/20 [00:54<07:51, 26.21s/it]
Task 14, Epoch 3/20 => Loss 1.925, Train_accy 93.00:  10%|█         | 2/20 [01:16<07:51, 26.21s/it]
Task 14, Epoch 3/20 => Loss 1.925, Train_accy 93.00:  15%|█▌        | 3/20 [01:16<06:49, 24.12s/it]
Task 14, Epoch 4/20 => Loss 1.882, Train_accy 93.90:  15%|█▌        | 3/20 [01:37<06:49, 24.12s/it]
Task 14, Epoch 4/20 => Loss 1.882, Train_accy 93.90:  20%|██        | 4/20 [01:37<06:09, 23.11s/it]
Task 14, Epoch 5/20 => Loss 1.884, Train_accy 94.19:  20%|██        | 4/20 [01:59<06:09, 23.11s/it]
Task 14, Epoch 5/20 => Loss 1.884, Train_accy 94.19:  25%|██▌       | 5/20 [01:59<05:38, 22.56s/it]
Task 14, Epoch 6/20 => Loss 1.899, Train_accy 93.97, Test_accy 78.51:  25%|██▌       | 5/20 [02:31<05:38, 22.56s/it]
Task 14, Epoch 6/20 => Loss 1.899, Train_accy 93.97, Test_accy 78.51:  30%|███       | 6/20 [02:31<06:04, 26.03s/it]
Task 14, Epoch 7/20 => Loss 1.854, Train_accy 94.87:  30%|███       | 6/20 [02:53<06:04, 26.03s/it]                 
Task 14, Epoch 7/20 => Loss 1.854, Train_accy 94.87:  35%|███▌      | 7/20 [02:53<05:19, 24.60s/it]
Task 14, Epoch 8/20 => Loss 1.886, Train_accy 94.30:  35%|███▌      | 7/20 [03:15<05:19, 24.60s/it]
Task 14, Epoch 8/20 => Loss 1.886, Train_accy 94.30:  40%|████      | 8/20 [03:15<04:43, 23.65s/it]
Task 14, Epoch 9/20 => Loss 1.859, Train_accy 94.71:  40%|████      | 8/20 [03:36<04:43, 23.65s/it]
Task 14, Epoch 9/20 => Loss 1.859, Train_accy 94.71:  45%|████▌     | 9/20 [03:36<04:13, 23.01s/it]
Task 14, Epoch 10/20 => Loss 1.849, Train_accy 95.34:  45%|████▌     | 9/20 [03:58<04:13, 23.01s/it]
Task 14, Epoch 10/20 => Loss 1.849, Train_accy 95.34:  50%|█████     | 10/20 [03:58<03:45, 22.56s/it]
Task 14, Epoch 11/20 => Loss 1.878, Train_accy 94.64, Test_accy 78.73:  50%|█████     | 10/20 [04:31<03:45, 22.56s/it]
Task 14, Epoch 11/20 => Loss 1.878, Train_accy 94.64, Test_accy 78.73:  55%|█████▌    | 11/20 [04:31<03:50, 25.66s/it]
Task 14, Epoch 12/20 => Loss 1.874, Train_accy 95.11:  55%|█████▌    | 11/20 [04:52<03:50, 25.66s/it]                 
Task 14, Epoch 12/20 => Loss 1.874, Train_accy 95.11:  60%|██████    | 12/20 [04:52<03:15, 24.43s/it]
Task 14, Epoch 13/20 => Loss 1.833, Train_accy 95.27:  60%|██████    | 12/20 [05:14<03:15, 24.43s/it]
Task 14, Epoch 13/20 => Loss 1.833, Train_accy 95.27:  65%|██████▌   | 13/20 [05:14<02:44, 23.57s/it]
Task 14, Epoch 14/20 => Loss 1.868, Train_accy 95.18:  65%|██████▌   | 13/20 [05:35<02:44, 23.57s/it]
Task 14, Epoch 14/20 => Loss 1.868, Train_accy 95.18:  70%|███████   | 14/20 [05:35<02:17, 22.99s/it]
Task 14, Epoch 15/20 => Loss 1.833, Train_accy 95.40:  70%|███████   | 14/20 [05:57<02:17, 22.99s/it]
Task 14, Epoch 15/20 => Loss 1.833, Train_accy 95.40:  75%|███████▌  | 15/20 [05:57<01:52, 22.58s/it]
Task 14, Epoch 16/20 => Loss 1.878, Train_accy 94.71, Test_accy 78.01:  75%|███████▌  | 15/20 [06:30<01:52, 22.58s/it]
Task 14, Epoch 16/20 => Loss 1.878, Train_accy 94.71, Test_accy 78.01:  80%|████████  | 16/20 [06:30<01:42, 25.64s/it]
Task 14, Epoch 17/20 => Loss 1.845, Train_accy 94.96:  80%|████████  | 16/20 [06:51<01:42, 25.64s/it]                 
Task 14, Epoch 17/20 => Loss 1.845, Train_accy 94.96:  85%|████████▌ | 17/20 [06:51<01:13, 24.44s/it]
Task 14, Epoch 18/20 => Loss 1.842, Train_accy 95.31:  85%|████████▌ | 17/20 [07:13<01:13, 24.44s/it]
Task 14, Epoch 18/20 => Loss 1.842, Train_accy 95.31:  90%|█████████ | 18/20 [07:13<00:47, 23.59s/it]
Task 14, Epoch 19/20 => Loss 1.834, Train_accy 95.81:  90%|█████████ | 18/20 [07:35<00:47, 23.59s/it]
Task 14, Epoch 19/20 => Loss 1.834, Train_accy 95.81:  95%|█████████▌| 19/20 [07:35<00:22, 22.99s/it]
Task 14, Epoch 20/20 => Loss 1.837, Train_accy 95.36:  95%|█████████▌| 19/20 [07:56<00:22, 22.99s/it]
Task 14, Epoch 20/20 => Loss 1.837, Train_accy 95.36: 100%|██████████| 20/20 [07:56<00:00, 22.59s/it]
Task 14, Epoch 20/20 => Loss 1.837, Train_accy 95.36: 100%|██████████| 20/20 [07:56<00:00, 23.84s/it]
2024-08-18 02:50:31,546 [icarl.py] => Task 14, Epoch 20/20 => Loss 1.837, Train_accy 95.36
2024-08-18 02:50:31,547 [base.py] => Reducing exemplars...(26 per classes)
2024-08-18 02:50:45,047 [base.py] => Constructing exemplars...(26 per classes)
2024-08-18 02:51:13,541 [icarl.py] => Exemplar size: 1950
2024-08-18 02:51:13,541 [trainer.py] => CNN: {'total': 78.63, '00-04': 76.4, '05-09': 68.2, '10-14': 57.6, '15-19': 72.2, '20-24': 84.0, '25-29': 79.6, '30-34': 79.6, '35-39': 68.8, '40-44': 80.2, '45-49': 88.0, '50-54': 85.0, '55-59': 63.6, '60-64': 81.4, '65-69': 97.0, '70-74': 97.8, 'old': 77.26, 'new': 97.8}
2024-08-18 02:51:13,541 [trainer.py] => NME: {'total': 86.0, '00-04': 88.4, '05-09': 79.8, '10-14': 74.0, '15-19': 84.0, '20-24': 93.6, '25-29': 88.8, '30-34': 87.0, '35-39': 79.4, '40-44': 85.8, '45-49': 91.8, '50-54': 89.2, '55-59': 76.8, '60-64': 83.0, '65-69': 95.2, '70-74': 93.2, 'old': 85.49, 'new': 93.2}
2024-08-18 02:51:13,541 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75, 79.97, 78.63]
2024-08-18 02:51:13,542 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52, 94.14, 93.47]
2024-08-18 02:51:13,542 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06, 87.33, 86.0]
2024-08-18 02:51:13,542 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05, 97.77, 97.51]

Average Accuracy (CNN): 88.61
Average Accuracy (NME): 92.23
2024-08-18 02:51:13,542 [trainer.py] => Average Accuracy (CNN): 88.61
2024-08-18 02:51:13,542 [trainer.py] => Average Accuracy (NME): 92.23
2024-08-18 02:51:13,542 [trainer.py] => Train Time: 0
2024-08-18 02:51:13,542 [trainer.py] => Test Time: 181.36 

2024-08-18 02:51:13,542 [trainer.py] => All params: 85856331
2024-08-18 02:51:13,543 [trainer.py] => Trainable params: 85856331
2024-08-18 02:51:13,544 [icarl.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.717, Train_accy 82.76, Test_accy 73.68:   0%|          | 0/20 [00:33<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.717, Train_accy 82.76, Test_accy 73.68:   5%|▌         | 1/20 [00:33<10:35, 33.44s/it]
Task 15, Epoch 2/20 => Loss 1.965, Train_accy 91.30:   5%|▌         | 1/20 [00:54<10:35, 33.44s/it]                 
Task 15, Epoch 2/20 => Loss 1.965, Train_accy 91.30:  10%|█         | 2/20 [00:54<07:56, 26.45s/it]
Task 15, Epoch 3/20 => Loss 1.936, Train_accy 91.93:  10%|█         | 2/20 [01:16<07:56, 26.45s/it]
Task 15, Epoch 3/20 => Loss 1.936, Train_accy 91.93:  15%|█▌        | 3/20 [01:16<06:51, 24.21s/it]
Task 15, Epoch 4/20 => Loss 1.879, Train_accy 93.24:  15%|█▌        | 3/20 [01:38<06:51, 24.21s/it]
Task 15, Epoch 4/20 => Loss 1.879, Train_accy 93.24:  20%|██        | 4/20 [01:38<06:10, 23.17s/it]
Task 15, Epoch 5/20 => Loss 1.884, Train_accy 93.08:  20%|██        | 4/20 [01:59<06:10, 23.17s/it]
Task 15, Epoch 5/20 => Loss 1.884, Train_accy 93.08:  25%|██▌       | 5/20 [01:59<05:38, 22.56s/it]
Task 15, Epoch 6/20 => Loss 1.862, Train_accy 94.11, Test_accy 73.70:  25%|██▌       | 5/20 [02:32<05:38, 22.56s/it]
Task 15, Epoch 6/20 => Loss 1.862, Train_accy 94.11, Test_accy 73.70:  30%|███       | 6/20 [02:32<06:07, 26.22s/it]
Task 15, Epoch 7/20 => Loss 1.856, Train_accy 94.40:  30%|███       | 6/20 [02:54<06:07, 26.22s/it]                 
Task 15, Epoch 7/20 => Loss 1.856, Train_accy 94.40:  35%|███▌      | 7/20 [02:54<05:21, 24.71s/it]
Task 15, Epoch 8/20 => Loss 1.839, Train_accy 94.04:  35%|███▌      | 7/20 [03:16<05:21, 24.71s/it]
Task 15, Epoch 8/20 => Loss 1.839, Train_accy 94.04:  40%|████      | 8/20 [03:16<04:44, 23.69s/it]
Task 15, Epoch 9/20 => Loss 1.840, Train_accy 94.70:  40%|████      | 8/20 [03:37<04:44, 23.69s/it]
Task 15, Epoch 9/20 => Loss 1.840, Train_accy 94.70:  45%|████▌     | 9/20 [03:37<04:13, 23.03s/it]
Task 15, Epoch 10/20 => Loss 1.818, Train_accy 94.61:  45%|████▌     | 9/20 [03:59<04:13, 23.03s/it]
Task 15, Epoch 10/20 => Loss 1.818, Train_accy 94.61:  50%|█████     | 10/20 [03:59<03:45, 22.56s/it]
Task 15, Epoch 11/20 => Loss 1.843, Train_accy 94.67, Test_accy 73.34:  50%|█████     | 10/20 [04:32<03:45, 22.56s/it]
Task 15, Epoch 11/20 => Loss 1.843, Train_accy 94.67, Test_accy 73.34:  55%|█████▌    | 11/20 [04:32<03:53, 25.90s/it]
Task 15, Epoch 12/20 => Loss 1.841, Train_accy 94.85:  55%|█████▌    | 11/20 [04:54<03:53, 25.90s/it]                 
Task 15, Epoch 12/20 => Loss 1.841, Train_accy 94.85:  60%|██████    | 12/20 [04:54<03:16, 24.58s/it]
Task 15, Epoch 13/20 => Loss 1.836, Train_accy 94.45:  60%|██████    | 12/20 [05:15<03:16, 24.58s/it]
Task 15, Epoch 13/20 => Loss 1.836, Train_accy 94.45:  65%|██████▌   | 13/20 [05:15<02:45, 23.65s/it]
Task 15, Epoch 14/20 => Loss 1.835, Train_accy 95.21:  65%|██████▌   | 13/20 [05:37<02:45, 23.65s/it]
Task 15, Epoch 14/20 => Loss 1.835, Train_accy 95.21:  70%|███████   | 14/20 [05:37<02:18, 23.02s/it]
Task 15, Epoch 15/20 => Loss 1.808, Train_accy 95.44:  70%|███████   | 14/20 [05:58<02:18, 23.02s/it]
Task 15, Epoch 15/20 => Loss 1.808, Train_accy 95.44:  75%|███████▌  | 15/20 [05:58<01:52, 22.55s/it]
Task 15, Epoch 16/20 => Loss 1.848, Train_accy 94.56, Test_accy 74.96:  75%|███████▌  | 15/20 [06:31<01:52, 22.55s/it]
Task 15, Epoch 16/20 => Loss 1.848, Train_accy 94.56, Test_accy 74.96:  80%|████████  | 16/20 [06:31<01:42, 25.75s/it]
Task 15, Epoch 17/20 => Loss 1.831, Train_accy 95.01:  80%|████████  | 16/20 [06:53<01:42, 25.75s/it]                 
Task 15, Epoch 17/20 => Loss 1.831, Train_accy 95.01:  85%|████████▌ | 17/20 [06:53<01:13, 24.45s/it]
Task 15, Epoch 18/20 => Loss 1.835, Train_accy 94.90:  85%|████████▌ | 17/20 [07:14<01:13, 24.45s/it]
Task 15, Epoch 18/20 => Loss 1.835, Train_accy 94.90:  90%|█████████ | 18/20 [07:14<00:47, 23.57s/it]
Task 15, Epoch 19/20 => Loss 1.826, Train_accy 95.46:  90%|█████████ | 18/20 [07:36<00:47, 23.57s/it]
Task 15, Epoch 19/20 => Loss 1.826, Train_accy 95.46:  95%|█████████▌| 19/20 [07:36<00:22, 22.94s/it]
Task 15, Epoch 20/20 => Loss 1.838, Train_accy 95.15:  95%|█████████▌| 19/20 [07:57<00:22, 22.94s/it]
Task 15, Epoch 20/20 => Loss 1.838, Train_accy 95.15: 100%|██████████| 20/20 [07:57<00:00, 22.53s/it]
Task 15, Epoch 20/20 => Loss 1.838, Train_accy 95.15: 100%|██████████| 20/20 [07:57<00:00, 23.89s/it]
2024-08-18 02:59:11,457 [icarl.py] => Task 15, Epoch 20/20 => Loss 1.838, Train_accy 95.15
2024-08-18 02:59:11,458 [base.py] => Reducing exemplars...(25 per classes)
2024-08-18 02:59:25,901 [base.py] => Constructing exemplars...(25 per classes)
2024-08-18 02:59:55,624 [icarl.py] => Exemplar size: 2000
2024-08-18 02:59:55,624 [trainer.py] => CNN: {'total': 73.92, '00-04': 68.8, '05-09': 63.6, '10-14': 55.6, '15-19': 73.0, '20-24': 77.8, '25-29': 77.0, '30-34': 77.0, '35-39': 64.2, '40-44': 73.4, '45-49': 72.4, '50-54': 52.8, '55-59': 64.0, '60-64': 81.6, '65-69': 95.2, '70-74': 87.8, '75-79': 98.6, 'old': 72.28, 'new': 98.6}
2024-08-18 02:59:55,624 [trainer.py] => NME: {'total': 83.51, '00-04': 87.2, '05-09': 76.4, '10-14': 73.2, '15-19': 81.0, '20-24': 89.6, '25-29': 87.8, '30-34': 85.0, '35-39': 78.0, '40-44': 84.2, '45-49': 84.6, '50-54': 78.4, '55-59': 74.6, '60-64': 82.6, '65-69': 95.2, '70-74': 89.8, '75-79': 88.6, 'old': 83.17, 'new': 88.6}
2024-08-18 02:59:55,624 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75, 79.97, 78.63, 73.92]
2024-08-18 02:59:55,624 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52, 94.14, 93.47, 92.68]
2024-08-18 02:59:55,624 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06, 87.33, 86.0, 83.51]
2024-08-18 02:59:55,624 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05, 97.77, 97.51, 97.26]

Average Accuracy (CNN): 87.7
Average Accuracy (NME): 91.69
2024-08-18 02:59:55,624 [trainer.py] => Average Accuracy (CNN): 87.7
2024-08-18 02:59:55,624 [trainer.py] => Average Accuracy (NME): 91.69
2024-08-18 02:59:55,624 [trainer.py] => Train Time: 0
2024-08-18 02:59:55,624 [trainer.py] => Test Time: 205.24 

2024-08-18 02:59:55,625 [trainer.py] => All params: 85860176
2024-08-18 02:59:55,625 [trainer.py] => Trainable params: 85860176
2024-08-18 02:59:55,626 [icarl.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.759, Train_accy 86.02, Test_accy 74.04:   0%|          | 0/20 [00:34<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.759, Train_accy 86.02, Test_accy 74.04:   5%|▌         | 1/20 [00:34<10:55, 34.48s/it]
Task 16, Epoch 2/20 => Loss 2.178, Train_accy 93.38:   5%|▌         | 1/20 [00:56<10:55, 34.48s/it]                 
Task 16, Epoch 2/20 => Loss 2.178, Train_accy 93.38:  10%|█         | 2/20 [00:56<08:06, 27.02s/it]
Task 16, Epoch 3/20 => Loss 2.158, Train_accy 93.80:  10%|█         | 2/20 [01:18<08:06, 27.02s/it]
Task 16, Epoch 3/20 => Loss 2.158, Train_accy 93.80:  15%|█▌        | 3/20 [01:18<06:58, 24.63s/it]
Task 16, Epoch 4/20 => Loss 2.158, Train_accy 94.80:  15%|█▌        | 3/20 [01:39<06:58, 24.63s/it]
Task 16, Epoch 4/20 => Loss 2.158, Train_accy 94.80:  20%|██        | 4/20 [01:39<06:16, 23.51s/it]
Task 16, Epoch 5/20 => Loss 2.147, Train_accy 94.67:  20%|██        | 4/20 [02:01<06:16, 23.51s/it]
Task 16, Epoch 5/20 => Loss 2.147, Train_accy 94.67:  25%|██▌       | 5/20 [02:01<05:43, 22.89s/it]
Task 16, Epoch 6/20 => Loss 2.137, Train_accy 95.02, Test_accy 71.00:  25%|██▌       | 5/20 [02:36<05:43, 22.89s/it]
Task 16, Epoch 6/20 => Loss 2.137, Train_accy 95.02, Test_accy 71.00:  30%|███       | 6/20 [02:36<06:15, 26.81s/it]
Task 16, Epoch 7/20 => Loss 2.128, Train_accy 94.91:  30%|███       | 6/20 [02:57<06:15, 26.81s/it]                 
Task 16, Epoch 7/20 => Loss 2.128, Train_accy 94.91:  35%|███▌      | 7/20 [02:57<05:27, 25.18s/it]
Task 16, Epoch 8/20 => Loss 2.105, Train_accy 95.47:  35%|███▌      | 7/20 [03:19<05:27, 25.18s/it]
Task 16, Epoch 8/20 => Loss 2.105, Train_accy 95.47:  40%|████      | 8/20 [03:19<04:48, 24.07s/it]
Task 16, Epoch 9/20 => Loss 2.119, Train_accy 95.22:  40%|████      | 8/20 [03:41<04:48, 24.07s/it]
Task 16, Epoch 9/20 => Loss 2.119, Train_accy 95.22:  45%|████▌     | 9/20 [03:41<04:16, 23.36s/it]
Task 16, Epoch 10/20 => Loss 2.117, Train_accy 95.58:  45%|████▌     | 9/20 [04:03<04:16, 23.36s/it]
Task 16, Epoch 10/20 => Loss 2.117, Train_accy 95.58:  50%|█████     | 10/20 [04:03<03:48, 22.86s/it]
Task 16, Epoch 11/20 => Loss 2.107, Train_accy 95.36, Test_accy 70.82:  50%|█████     | 10/20 [04:37<03:48, 22.86s/it]
Task 16, Epoch 11/20 => Loss 2.107, Train_accy 95.36, Test_accy 70.82:  55%|█████▌    | 11/20 [04:37<03:56, 26.31s/it]
Task 16, Epoch 12/20 => Loss 2.072, Train_accy 95.78:  55%|█████▌    | 11/20 [04:58<03:56, 26.31s/it]                 
Task 16, Epoch 12/20 => Loss 2.072, Train_accy 95.78:  60%|██████    | 12/20 [04:58<03:19, 24.89s/it]
Task 16, Epoch 13/20 => Loss 2.100, Train_accy 96.02:  60%|██████    | 12/20 [05:20<03:19, 24.89s/it]
Task 16, Epoch 13/20 => Loss 2.100, Train_accy 96.02:  65%|██████▌   | 13/20 [05:20<02:47, 23.91s/it]
Task 16, Epoch 14/20 => Loss 2.065, Train_accy 95.91:  65%|██████▌   | 13/20 [05:42<02:47, 23.91s/it]
Task 16, Epoch 14/20 => Loss 2.065, Train_accy 95.91:  70%|███████   | 14/20 [05:42<02:19, 23.23s/it]
Task 16, Epoch 15/20 => Loss 2.108, Train_accy 95.36:  70%|███████   | 14/20 [06:03<02:19, 23.23s/it]
Task 16, Epoch 15/20 => Loss 2.108, Train_accy 95.36:  75%|███████▌  | 15/20 [06:03<01:53, 22.76s/it]
Task 16, Epoch 16/20 => Loss 2.114, Train_accy 95.47, Test_accy 72.12:  75%|███████▌  | 15/20 [06:38<01:53, 22.76s/it]
Task 16, Epoch 16/20 => Loss 2.114, Train_accy 95.47, Test_accy 72.12:  80%|████████  | 16/20 [06:38<01:45, 26.27s/it]
Task 16, Epoch 17/20 => Loss 2.099, Train_accy 95.96:  80%|████████  | 16/20 [07:00<01:45, 26.27s/it]                 
Task 16, Epoch 17/20 => Loss 2.099, Train_accy 95.96:  85%|████████▌ | 17/20 [07:00<01:14, 24.91s/it]
Task 16, Epoch 18/20 => Loss 2.078, Train_accy 95.98:  85%|████████▌ | 17/20 [07:21<01:14, 24.91s/it]
Task 16, Epoch 18/20 => Loss 2.078, Train_accy 95.98:  90%|█████████ | 18/20 [07:21<00:47, 23.97s/it]
Task 16, Epoch 19/20 => Loss 2.093, Train_accy 96.04:  90%|█████████ | 18/20 [07:43<00:47, 23.97s/it]
Task 16, Epoch 19/20 => Loss 2.093, Train_accy 96.04:  95%|█████████▌| 19/20 [07:43<00:23, 23.31s/it]
Task 16, Epoch 20/20 => Loss 2.095, Train_accy 95.40:  95%|█████████▌| 19/20 [08:05<00:23, 23.31s/it]
Task 16, Epoch 20/20 => Loss 2.095, Train_accy 95.40: 100%|██████████| 20/20 [08:05<00:00, 22.83s/it]
Task 16, Epoch 20/20 => Loss 2.095, Train_accy 95.40: 100%|██████████| 20/20 [08:05<00:00, 24.27s/it]
2024-08-18 03:08:01,008 [icarl.py] => Task 16, Epoch 20/20 => Loss 2.095, Train_accy 95.40
2024-08-18 03:08:01,009 [base.py] => Reducing exemplars...(23 per classes)
2024-08-18 03:08:15,978 [base.py] => Constructing exemplars...(23 per classes)
2024-08-18 03:08:47,073 [icarl.py] => Exemplar size: 1955
2024-08-18 03:08:47,073 [trainer.py] => CNN: {'total': 72.13, '00-04': 72.4, '05-09': 59.2, '10-14': 52.2, '15-19': 67.8, '20-24': 72.2, '25-29': 71.2, '30-34': 71.2, '35-39': 63.6, '40-44': 70.8, '45-49': 65.8, '50-54': 55.2, '55-59': 61.8, '60-64': 66.6, '65-69': 94.4, '70-74': 85.0, '75-79': 97.4, '80-84': 99.4, 'old': 70.42, 'new': 99.4}
2024-08-18 03:08:47,073 [trainer.py] => NME: {'total': 82.91, '00-04': 86.6, '05-09': 74.6, '10-14': 71.0, '15-19': 81.8, '20-24': 86.8, '25-29': 86.0, '30-34': 86.0, '35-39': 77.6, '40-44': 86.0, '45-49': 80.2, '50-54': 77.2, '55-59': 75.2, '60-64': 78.6, '65-69': 95.4, '70-74': 88.6, '75-79': 87.0, '80-84': 90.8, 'old': 82.41, 'new': 90.8}
2024-08-18 03:08:47,073 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75, 79.97, 78.63, 73.92, 72.13]
2024-08-18 03:08:47,073 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52, 94.14, 93.47, 92.68, 91.64]
2024-08-18 03:08:47,073 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06, 87.33, 86.0, 83.51, 82.91]
2024-08-18 03:08:47,073 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05, 97.77, 97.51, 97.26, 97.14]

Average Accuracy (CNN): 86.78
Average Accuracy (NME): 91.17
2024-08-18 03:08:47,073 [trainer.py] => Average Accuracy (CNN): 86.78
2024-08-18 03:08:47,073 [trainer.py] => Average Accuracy (NME): 91.17
2024-08-18 03:08:47,073 [trainer.py] => Train Time: 0
2024-08-18 03:08:47,073 [trainer.py] => Test Time: 230.36 

2024-08-18 03:08:47,074 [trainer.py] => All params: 85864021
2024-08-18 03:08:47,074 [trainer.py] => Trainable params: 85864021
2024-08-18 03:08:47,075 [icarl.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 3.007, Train_accy 80.36, Test_accy 70.30:   0%|          | 0/20 [00:34<?, ?it/s]
Task 17, Epoch 1/20 => Loss 3.007, Train_accy 80.36, Test_accy 70.30:   5%|▌         | 1/20 [00:34<10:59, 34.73s/it]
Task 17, Epoch 2/20 => Loss 2.364, Train_accy 91.02:   5%|▌         | 1/20 [00:56<10:59, 34.73s/it]                 
Task 17, Epoch 2/20 => Loss 2.364, Train_accy 91.02:  10%|█         | 2/20 [00:56<08:06, 27.04s/it]
Task 17, Epoch 3/20 => Loss 2.339, Train_accy 92.35:  10%|█         | 2/20 [01:17<08:06, 27.04s/it]
Task 17, Epoch 3/20 => Loss 2.339, Train_accy 92.35:  15%|█▌        | 3/20 [01:17<06:57, 24.54s/it]
Task 17, Epoch 4/20 => Loss 2.298, Train_accy 92.93:  15%|█▌        | 3/20 [01:39<06:57, 24.54s/it]
Task 17, Epoch 4/20 => Loss 2.298, Train_accy 92.93:  20%|██        | 4/20 [01:39<06:13, 23.37s/it]
Task 17, Epoch 5/20 => Loss 2.338, Train_accy 92.14:  20%|██        | 4/20 [02:01<06:13, 23.37s/it]
Task 17, Epoch 5/20 => Loss 2.338, Train_accy 92.14:  25%|██▌       | 5/20 [02:01<05:40, 22.70s/it]
Task 17, Epoch 6/20 => Loss 2.302, Train_accy 92.79, Test_accy 71.76:  25%|██▌       | 5/20 [02:35<05:40, 22.70s/it]
Task 17, Epoch 6/20 => Loss 2.302, Train_accy 92.79, Test_accy 71.76:  30%|███       | 6/20 [02:35<06:15, 26.80s/it]
Task 17, Epoch 7/20 => Loss 2.290, Train_accy 93.02:  30%|███       | 6/20 [02:57<06:15, 26.80s/it]                 
Task 17, Epoch 7/20 => Loss 2.290, Train_accy 93.02:  35%|███▌      | 7/20 [02:57<05:25, 25.06s/it]
Task 17, Epoch 8/20 => Loss 2.269, Train_accy 93.71:  35%|███▌      | 7/20 [03:18<05:25, 25.06s/it]
Task 17, Epoch 8/20 => Loss 2.269, Train_accy 93.71:  40%|████      | 8/20 [03:18<04:46, 23.91s/it]
Task 17, Epoch 9/20 => Loss 2.303, Train_accy 93.51:  40%|████      | 8/20 [03:40<04:46, 23.91s/it]
Task 17, Epoch 9/20 => Loss 2.303, Train_accy 93.51:  45%|████▌     | 9/20 [03:40<04:14, 23.16s/it]
Task 17, Epoch 10/20 => Loss 2.294, Train_accy 93.74:  45%|████▌     | 9/20 [04:01<04:14, 23.16s/it]
Task 17, Epoch 10/20 => Loss 2.294, Train_accy 93.74:  50%|█████     | 10/20 [04:01<03:46, 22.65s/it]
Task 17, Epoch 11/20 => Loss 2.271, Train_accy 93.56, Test_accy 70.96:  50%|█████     | 10/20 [04:36<03:46, 22.65s/it]
Task 17, Epoch 11/20 => Loss 2.271, Train_accy 93.56, Test_accy 70.96:  55%|█████▌    | 11/20 [04:36<03:57, 26.37s/it]
Task 17, Epoch 12/20 => Loss 2.294, Train_accy 93.74:  55%|█████▌    | 11/20 [04:58<03:57, 26.37s/it]                 
Task 17, Epoch 12/20 => Loss 2.294, Train_accy 93.74:  60%|██████    | 12/20 [04:58<03:19, 24.91s/it]
Task 17, Epoch 13/20 => Loss 2.260, Train_accy 93.54:  60%|██████    | 12/20 [05:19<03:19, 24.91s/it]
Task 17, Epoch 13/20 => Loss 2.260, Train_accy 93.54:  65%|██████▌   | 13/20 [05:19<02:47, 23.89s/it]
Task 17, Epoch 14/20 => Loss 2.281, Train_accy 93.63:  65%|██████▌   | 13/20 [05:41<02:47, 23.89s/it]
Task 17, Epoch 14/20 => Loss 2.281, Train_accy 93.63:  70%|███████   | 14/20 [05:41<02:18, 23.17s/it]
Task 17, Epoch 15/20 => Loss 2.242, Train_accy 94.59:  70%|███████   | 14/20 [06:02<02:18, 23.17s/it]
Task 17, Epoch 15/20 => Loss 2.242, Train_accy 94.59:  75%|███████▌  | 15/20 [06:02<01:53, 22.67s/it]
Task 17, Epoch 16/20 => Loss 2.264, Train_accy 94.19, Test_accy 71.36:  75%|███████▌  | 15/20 [06:37<01:53, 22.67s/it]
Task 17, Epoch 16/20 => Loss 2.264, Train_accy 94.19, Test_accy 71.36:  80%|████████  | 16/20 [06:37<01:45, 26.30s/it]
Task 17, Epoch 17/20 => Loss 2.214, Train_accy 94.70:  80%|████████  | 16/20 [06:58<01:45, 26.30s/it]                 
Task 17, Epoch 17/20 => Loss 2.214, Train_accy 94.70:  85%|████████▌ | 17/20 [06:58<01:14, 24.87s/it]
Task 17, Epoch 18/20 => Loss 2.216, Train_accy 94.66:  85%|████████▌ | 17/20 [07:20<01:14, 24.87s/it]
Task 17, Epoch 18/20 => Loss 2.216, Train_accy 94.66:  90%|█████████ | 18/20 [07:20<00:47, 23.89s/it]
Task 17, Epoch 19/20 => Loss 2.237, Train_accy 94.64:  90%|█████████ | 18/20 [07:42<00:47, 23.89s/it]
Task 17, Epoch 19/20 => Loss 2.237, Train_accy 94.64:  95%|█████████▌| 19/20 [07:42<00:23, 23.16s/it]
Task 17, Epoch 20/20 => Loss 2.255, Train_accy 94.75:  95%|█████████▌| 19/20 [08:03<00:23, 23.16s/it]
Task 17, Epoch 20/20 => Loss 2.255, Train_accy 94.75: 100%|██████████| 20/20 [08:03<00:00, 22.75s/it]
Task 17, Epoch 20/20 => Loss 2.255, Train_accy 94.75: 100%|██████████| 20/20 [08:03<00:00, 24.19s/it]
2024-08-18 03:16:50,946 [icarl.py] => Task 17, Epoch 20/20 => Loss 2.255, Train_accy 94.75
2024-08-18 03:16:50,948 [base.py] => Reducing exemplars...(22 per classes)
2024-08-18 03:17:06,508 [base.py] => Constructing exemplars...(22 per classes)
2024-08-18 03:17:39,057 [icarl.py] => Exemplar size: 1980
2024-08-18 03:17:39,057 [trainer.py] => CNN: {'total': 69.86, '00-04': 75.6, '05-09': 54.2, '10-14': 46.2, '15-19': 60.2, '20-24': 70.0, '25-29': 66.4, '30-34': 69.2, '35-39': 64.6, '40-44': 65.0, '45-49': 63.8, '50-54': 55.0, '55-59': 54.8, '60-64': 69.0, '65-69': 91.0, '70-74': 76.2, '75-79': 82.8, '80-84': 97.4, '85-89': 96.0, 'old': 68.32, 'new': 96.0}
2024-08-18 03:17:39,057 [trainer.py] => NME: {'total': 80.38, '00-04': 86.0, '05-09': 68.8, '10-14': 63.8, '15-19': 77.8, '20-24': 87.2, '25-29': 82.6, '30-34': 81.6, '35-39': 76.0, '40-44': 81.0, '45-49': 80.8, '50-54': 74.4, '55-59': 69.6, '60-64': 75.6, '65-69': 94.0, '70-74': 85.2, '75-79': 80.8, '80-84': 90.6, '85-89': 91.0, 'old': 79.75, 'new': 91.0}
2024-08-18 03:17:39,057 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75, 79.97, 78.63, 73.92, 72.13, 69.86]
2024-08-18 03:17:39,057 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52, 94.14, 93.47, 92.68, 91.64, 89.98]
2024-08-18 03:17:39,057 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06, 87.33, 86.0, 83.51, 82.91, 80.38]
2024-08-18 03:17:39,057 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05, 97.77, 97.51, 97.26, 97.14, 96.27]

Average Accuracy (CNN): 85.84
Average Accuracy (NME): 90.57
2024-08-18 03:17:39,057 [trainer.py] => Average Accuracy (CNN): 85.84
2024-08-18 03:17:39,057 [trainer.py] => Average Accuracy (NME): 90.57
2024-08-18 03:17:39,057 [trainer.py] => Train Time: 0
2024-08-18 03:17:39,057 [trainer.py] => Test Time: 257.0 

2024-08-18 03:17:39,058 [trainer.py] => All params: 85867866
2024-08-18 03:17:39,058 [trainer.py] => Trainable params: 85867866
2024-08-18 03:17:39,059 [icarl.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.866, Train_accy 84.13, Test_accy 68.43:   0%|          | 0/20 [00:35<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.866, Train_accy 84.13, Test_accy 68.43:   5%|▌         | 1/20 [00:35<11:15, 35.53s/it]
Task 18, Epoch 2/20 => Loss 2.224, Train_accy 92.39:   5%|▌         | 1/20 [00:57<11:15, 35.53s/it]                 
Task 18, Epoch 2/20 => Loss 2.224, Train_accy 92.39:  10%|█         | 2/20 [00:57<08:12, 27.34s/it]
Task 18, Epoch 3/20 => Loss 2.190, Train_accy 93.33:  10%|█         | 2/20 [01:18<08:12, 27.34s/it]
Task 18, Epoch 3/20 => Loss 2.190, Train_accy 93.33:  15%|█▌        | 3/20 [01:18<07:01, 24.80s/it]
Task 18, Epoch 4/20 => Loss 2.113, Train_accy 94.17:  15%|█▌        | 3/20 [01:40<07:01, 24.80s/it]
Task 18, Epoch 4/20 => Loss 2.113, Train_accy 94.17:  20%|██        | 4/20 [01:40<06:17, 23.57s/it]
Task 18, Epoch 5/20 => Loss 2.119, Train_accy 95.02:  20%|██        | 4/20 [02:02<06:17, 23.57s/it]
Task 18, Epoch 5/20 => Loss 2.119, Train_accy 95.02:  25%|██▌       | 5/20 [02:02<05:43, 22.88s/it]
Task 18, Epoch 6/20 => Loss 2.137, Train_accy 94.80, Test_accy 68.46:  25%|██▌       | 5/20 [02:38<05:43, 22.88s/it]
Task 18, Epoch 6/20 => Loss 2.137, Train_accy 94.80, Test_accy 68.46:  30%|███       | 6/20 [02:38<06:22, 27.30s/it]
Task 18, Epoch 7/20 => Loss 2.107, Train_accy 94.80:  30%|███       | 6/20 [02:59<06:22, 27.30s/it]                 
Task 18, Epoch 7/20 => Loss 2.107, Train_accy 94.80:  35%|███▌      | 7/20 [02:59<05:30, 25.45s/it]
Task 18, Epoch 8/20 => Loss 2.084, Train_accy 95.51:  35%|███▌      | 7/20 [03:21<05:30, 25.45s/it]
Task 18, Epoch 8/20 => Loss 2.084, Train_accy 95.51:  40%|████      | 8/20 [03:21<04:51, 24.29s/it]
Task 18, Epoch 9/20 => Loss 2.103, Train_accy 95.22:  40%|████      | 8/20 [03:43<04:51, 24.29s/it]
Task 18, Epoch 9/20 => Loss 2.103, Train_accy 95.22:  45%|████▌     | 9/20 [03:43<04:18, 23.47s/it]
Task 18, Epoch 10/20 => Loss 2.101, Train_accy 95.31:  45%|████▌     | 9/20 [04:04<04:18, 23.47s/it]
Task 18, Epoch 10/20 => Loss 2.101, Train_accy 95.31:  50%|█████     | 10/20 [04:04<03:48, 22.90s/it]
Task 18, Epoch 11/20 => Loss 2.074, Train_accy 95.76, Test_accy 69.51:  50%|█████     | 10/20 [04:40<03:48, 22.90s/it]
Task 18, Epoch 11/20 => Loss 2.074, Train_accy 95.76, Test_accy 69.51:  55%|█████▌    | 11/20 [04:40<04:00, 26.78s/it]
Task 18, Epoch 12/20 => Loss 2.103, Train_accy 95.09:  55%|█████▌    | 11/20 [05:02<04:00, 26.78s/it]                 
Task 18, Epoch 12/20 => Loss 2.103, Train_accy 95.09:  60%|██████    | 12/20 [05:02<03:21, 25.23s/it]
Task 18, Epoch 13/20 => Loss 2.104, Train_accy 95.36:  60%|██████    | 12/20 [05:23<03:21, 25.23s/it]
Task 18, Epoch 13/20 => Loss 2.104, Train_accy 95.36:  65%|██████▌   | 13/20 [05:23<02:49, 24.16s/it]
Task 18, Epoch 14/20 => Loss 2.104, Train_accy 95.11:  65%|██████▌   | 13/20 [05:45<02:49, 24.16s/it]
Task 18, Epoch 14/20 => Loss 2.104, Train_accy 95.11:  70%|███████   | 14/20 [05:45<02:20, 23.38s/it]
Task 18, Epoch 15/20 => Loss 2.049, Train_accy 95.92:  70%|███████   | 14/20 [06:07<02:20, 23.38s/it]
Task 18, Epoch 15/20 => Loss 2.049, Train_accy 95.92:  75%|███████▌  | 15/20 [06:07<01:54, 22.85s/it]
Task 18, Epoch 16/20 => Loss 2.097, Train_accy 95.40, Test_accy 70.17:  75%|███████▌  | 15/20 [06:42<01:54, 22.85s/it]
Task 18, Epoch 16/20 => Loss 2.097, Train_accy 95.40, Test_accy 70.17:  80%|████████  | 16/20 [06:42<01:46, 26.75s/it]
Task 18, Epoch 17/20 => Loss 2.066, Train_accy 95.94:  80%|████████  | 16/20 [07:04<01:46, 26.75s/it]                 
Task 18, Epoch 17/20 => Loss 2.066, Train_accy 95.94:  85%|████████▌ | 17/20 [07:04<01:15, 25.23s/it]
Task 18, Epoch 18/20 => Loss 2.051, Train_accy 96.32:  85%|████████▌ | 17/20 [07:26<01:15, 25.23s/it]
Task 18, Epoch 18/20 => Loss 2.051, Train_accy 96.32:  90%|█████████ | 18/20 [07:26<00:48, 24.17s/it]
Task 18, Epoch 19/20 => Loss 2.093, Train_accy 95.65:  90%|█████████ | 18/20 [07:47<00:48, 24.17s/it]
Task 18, Epoch 19/20 => Loss 2.093, Train_accy 95.65:  95%|█████████▌| 19/20 [07:47<00:23, 23.40s/it]
Task 18, Epoch 20/20 => Loss 2.051, Train_accy 96.58:  95%|█████████▌| 19/20 [08:09<00:23, 23.40s/it]
Task 18, Epoch 20/20 => Loss 2.051, Train_accy 96.58: 100%|██████████| 20/20 [08:09<00:00, 22.88s/it]
Task 18, Epoch 20/20 => Loss 2.051, Train_accy 96.58: 100%|██████████| 20/20 [08:09<00:00, 24.47s/it]
2024-08-18 03:25:48,597 [icarl.py] => Task 18, Epoch 20/20 => Loss 2.051, Train_accy 96.58
2024-08-18 03:25:48,598 [base.py] => Reducing exemplars...(21 per classes)
2024-08-18 03:26:04,599 [base.py] => Constructing exemplars...(21 per classes)
2024-08-18 03:26:38,939 [icarl.py] => Exemplar size: 1995
2024-08-18 03:26:38,939 [trainer.py] => CNN: {'total': 69.4, '00-04': 72.2, '05-09': 51.2, '10-14': 46.0, '15-19': 61.2, '20-24': 67.6, '25-29': 68.0, '30-34': 69.0, '35-39': 60.6, '40-44': 59.6, '45-49': 63.0, '50-54': 57.8, '55-59': 56.0, '60-64': 69.6, '65-69': 89.4, '70-74': 73.2, '75-79': 74.4, '80-84': 94.4, '85-89': 86.8, '90-94': 98.6, 'old': 67.78, 'new': 98.6}
2024-08-18 03:26:38,939 [trainer.py] => NME: {'total': 79.74, '00-04': 85.4, '05-09': 66.8, '10-14': 59.6, '15-19': 77.2, '20-24': 87.0, '25-29': 83.6, '30-34': 81.6, '35-39': 74.2, '40-44': 80.6, '45-49': 78.2, '50-54': 73.2, '55-59': 68.2, '60-64': 76.2, '65-69': 93.4, '70-74': 85.2, '75-79': 77.6, '80-84': 87.8, '85-89': 87.4, '90-94': 91.8, 'old': 79.07, 'new': 91.8}
2024-08-18 03:26:38,939 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75, 79.97, 78.63, 73.92, 72.13, 69.86, 69.4]
2024-08-18 03:26:38,939 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52, 94.14, 93.47, 92.68, 91.64, 89.98, 88.44]
2024-08-18 03:26:38,939 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06, 87.33, 86.0, 83.51, 82.91, 80.38, 79.74]
2024-08-18 03:26:38,939 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05, 97.77, 97.51, 97.26, 97.14, 96.27, 95.37]

Average Accuracy (CNN): 84.97
Average Accuracy (NME): 90.0
2024-08-18 03:26:38,940 [trainer.py] => Average Accuracy (CNN): 84.97
2024-08-18 03:26:38,940 [trainer.py] => Average Accuracy (NME): 90.0
2024-08-18 03:26:38,940 [trainer.py] => Train Time: 0
2024-08-18 03:26:38,940 [trainer.py] => Test Time: 285.51 

2024-08-18 03:26:38,940 [trainer.py] => All params: 85871711
2024-08-18 03:26:38,940 [trainer.py] => Trainable params: 85871711
2024-08-18 03:26:38,941 [icarl.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.957, Train_accy 82.22, Test_accy 65.23:   0%|          | 0/20 [00:36<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.957, Train_accy 82.22, Test_accy 65.23:   5%|▌         | 1/20 [00:36<11:34, 36.55s/it]
Task 19, Epoch 2/20 => Loss 2.264, Train_accy 91.50:   5%|▌         | 1/20 [00:58<11:34, 36.55s/it]                 
Task 19, Epoch 2/20 => Loss 2.264, Train_accy 91.50:  10%|█         | 2/20 [00:58<08:21, 27.88s/it]
Task 19, Epoch 3/20 => Loss 2.199, Train_accy 92.73:  10%|█         | 2/20 [01:20<08:21, 27.88s/it]
Task 19, Epoch 3/20 => Loss 2.199, Train_accy 92.73:  15%|█▌        | 3/20 [01:20<07:06, 25.11s/it]
Task 19, Epoch 4/20 => Loss 2.209, Train_accy 92.88:  15%|█▌        | 3/20 [01:42<07:06, 25.11s/it]
Task 19, Epoch 4/20 => Loss 2.209, Train_accy 92.88:  20%|██        | 4/20 [01:42<06:21, 23.82s/it]
Task 19, Epoch 5/20 => Loss 2.174, Train_accy 93.93:  20%|██        | 4/20 [02:03<06:21, 23.82s/it]
Task 19, Epoch 5/20 => Loss 2.174, Train_accy 93.93:  25%|██▌       | 5/20 [02:03<05:46, 23.08s/it]
Task 19, Epoch 6/20 => Loss 2.171, Train_accy 93.93, Test_accy 68.08:  25%|██▌       | 5/20 [02:40<05:46, 23.08s/it]
Task 19, Epoch 6/20 => Loss 2.171, Train_accy 93.93, Test_accy 68.08:  30%|███       | 6/20 [02:40<06:27, 27.68s/it]
Task 19, Epoch 7/20 => Loss 2.185, Train_accy 93.77:  30%|███       | 6/20 [03:02<06:27, 27.68s/it]                 
Task 19, Epoch 7/20 => Loss 2.185, Train_accy 93.77:  35%|███▌      | 7/20 [03:02<05:34, 25.72s/it]
Task 19, Epoch 8/20 => Loss 2.169, Train_accy 94.37:  35%|███▌      | 7/20 [03:23<05:34, 25.72s/it]
Task 19, Epoch 8/20 => Loss 2.169, Train_accy 94.37:  40%|████      | 8/20 [03:23<04:53, 24.43s/it]
Task 19, Epoch 9/20 => Loss 2.190, Train_accy 94.17:  40%|████      | 8/20 [03:45<04:53, 24.43s/it]
Task 19, Epoch 9/20 => Loss 2.190, Train_accy 94.17:  45%|████▌     | 9/20 [03:45<04:19, 23.57s/it]
Task 19, Epoch 10/20 => Loss 2.114, Train_accy 95.17:  45%|████▌     | 9/20 [04:07<04:19, 23.57s/it]
Task 19, Epoch 10/20 => Loss 2.114, Train_accy 95.17:  50%|█████     | 10/20 [04:07<03:49, 22.98s/it]
Task 19, Epoch 11/20 => Loss 2.183, Train_accy 94.39, Test_accy 69.03:  50%|█████     | 10/20 [04:43<03:49, 22.98s/it]
Task 19, Epoch 11/20 => Loss 2.183, Train_accy 94.39, Test_accy 69.03:  55%|█████▌    | 11/20 [04:43<04:03, 27.09s/it]
Task 19, Epoch 12/20 => Loss 2.112, Train_accy 94.95:  55%|█████▌    | 11/20 [05:05<04:03, 27.09s/it]                 
Task 19, Epoch 12/20 => Loss 2.112, Train_accy 94.95:  60%|██████    | 12/20 [05:05<03:23, 25.48s/it]
Task 19, Epoch 13/20 => Loss 2.142, Train_accy 94.64:  60%|██████    | 12/20 [05:27<03:23, 25.48s/it]
Task 19, Epoch 13/20 => Loss 2.142, Train_accy 94.64:  65%|██████▌   | 13/20 [05:27<02:50, 24.35s/it]
Task 19, Epoch 14/20 => Loss 2.173, Train_accy 94.59:  65%|██████▌   | 13/20 [05:48<02:50, 24.35s/it]
Task 19, Epoch 14/20 => Loss 2.173, Train_accy 94.59:  70%|███████   | 14/20 [05:48<02:21, 23.55s/it]
Task 19, Epoch 15/20 => Loss 2.119, Train_accy 95.62:  70%|███████   | 14/20 [06:10<02:21, 23.55s/it]
Task 19, Epoch 15/20 => Loss 2.119, Train_accy 95.62:  75%|███████▌  | 15/20 [06:10<01:55, 23.00s/it]
Task 19, Epoch 16/20 => Loss 2.158, Train_accy 95.22, Test_accy 66.13:  75%|███████▌  | 15/20 [06:46<01:55, 23.00s/it]
Task 19, Epoch 16/20 => Loss 2.158, Train_accy 95.22, Test_accy 66.13:  80%|████████  | 16/20 [06:46<01:48, 27.02s/it]
Task 19, Epoch 17/20 => Loss 2.117, Train_accy 95.86:  80%|████████  | 16/20 [07:08<01:48, 27.02s/it]                 
Task 19, Epoch 17/20 => Loss 2.117, Train_accy 95.86:  85%|████████▌ | 17/20 [07:08<01:16, 25.41s/it]
Task 19, Epoch 18/20 => Loss 2.101, Train_accy 95.68:  85%|████████▌ | 17/20 [07:30<01:16, 25.41s/it]
Task 19, Epoch 18/20 => Loss 2.101, Train_accy 95.68:  90%|█████████ | 18/20 [07:30<00:48, 24.28s/it]
Task 19, Epoch 19/20 => Loss 2.150, Train_accy 95.02:  90%|█████████ | 18/20 [07:51<00:48, 24.28s/it]
Task 19, Epoch 19/20 => Loss 2.150, Train_accy 95.02:  95%|█████████▌| 19/20 [07:51<00:23, 23.50s/it]
Task 19, Epoch 20/20 => Loss 2.121, Train_accy 95.24:  95%|█████████▌| 19/20 [08:13<00:23, 23.50s/it]
Task 19, Epoch 20/20 => Loss 2.121, Train_accy 95.24: 100%|██████████| 20/20 [08:13<00:00, 22.97s/it]
Task 19, Epoch 20/20 => Loss 2.121, Train_accy 95.24: 100%|██████████| 20/20 [08:13<00:00, 24.68s/it]
2024-08-18 03:34:52,540 [icarl.py] => Task 19, Epoch 20/20 => Loss 2.121, Train_accy 95.24
2024-08-18 03:34:52,541 [base.py] => Reducing exemplars...(20 per classes)
2024-08-18 03:35:09,019 [base.py] => Constructing exemplars...(20 per classes)
2024-08-18 03:35:44,745 [icarl.py] => Exemplar size: 2000
2024-08-18 03:35:44,745 [trainer.py] => CNN: {'total': 66.83, '00-04': 61.2, '05-09': 54.8, '10-14': 44.0, '15-19': 56.2, '20-24': 67.2, '25-29': 63.8, '30-34': 67.6, '35-39': 51.4, '40-44': 57.2, '45-49': 58.4, '50-54': 52.8, '55-59': 55.2, '60-64': 65.4, '65-69': 81.0, '70-74': 70.4, '75-79': 74.8, '80-84': 90.0, '85-89': 80.8, '90-94': 87.2, '95-99': 97.2, 'old': 65.23, 'new': 97.2}
2024-08-18 03:35:44,746 [trainer.py] => NME: {'total': 78.62, '00-04': 79.4, '05-09': 65.6, '10-14': 57.4, '15-19': 74.2, '20-24': 85.6, '25-29': 81.8, '30-34': 79.2, '35-39': 71.8, '40-44': 77.6, '45-49': 77.8, '50-54': 69.2, '55-59': 67.4, '60-64': 76.0, '65-69': 90.6, '70-74': 84.4, '75-79': 78.0, '80-84': 88.4, '85-89': 87.4, '90-94': 90.4, '95-99': 90.2, 'old': 78.01, 'new': 90.2}
2024-08-18 03:35:44,746 [trainer.py] => CNN top1 curve: [99.4, 98.5, 97.13, 95.65, 94.88, 92.83, 89.4, 87.85, 85.96, 84.46, 83.27, 81.52, 79.75, 79.97, 78.63, 73.92, 72.13, 69.86, 69.4, 66.83]
2024-08-18 03:35:44,746 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.87, 99.7, 99.36, 99.1, 98.66, 98.02, 97.58, 96.92, 96.67, 95.33, 94.52, 94.14, 93.47, 92.68, 91.64, 89.98, 88.44, 86.4]
2024-08-18 03:35:44,746 [trainer.py] => NME top1 curve: [99.6, 98.9, 97.67, 95.95, 95.12, 94.07, 92.43, 92.02, 90.96, 89.18, 88.71, 88.5, 87.06, 87.33, 86.0, 83.51, 82.91, 80.38, 79.74, 78.62]
2024-08-18 03:35:44,746 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.65, 99.68, 99.33, 99.43, 98.95, 98.78, 98.76, 98.73, 98.17, 98.05, 97.77, 97.51, 97.26, 97.14, 96.27, 95.37, 94.69]

Average Accuracy (CNN): 84.07
Average Accuracy (NME): 89.43
2024-08-18 03:35:44,746 [trainer.py] => Average Accuracy (CNN): 84.07
2024-08-18 03:35:44,746 [trainer.py] => Average Accuracy (NME): 89.43
2024-08-18 03:35:44,746 [trainer.py] => Train Time: 0
2024-08-18 03:35:44,746 [trainer.py] => Test Time: 315.45 

Accuracy Matrix (CNN):
[[99.4 98.8 98.6 98.4 97.4 97.4 93.8 88.8 86.2 86.8 76.4 79.6 81.2 77.2
  76.4 68.8 72.4 75.6 72.2 61.2]
 [ 0.  98.2 95.  92.8 91.  85.  76.4 77.4 76.2 72.6 70.6 63.8 66.6 67.8
  68.2 63.6 59.2 54.2 51.2 54.8]
 [ 0.   0.  97.8 96.4 92.8 86.6 86.  80.  70.4 67.6 69.4 62.8 59.6 59.4
  57.6 55.6 52.2 46.2 46.  44. ]
 [ 0.   0.   0.  95.  94.8 93.6 87.8 83.  79.6 81.8 83.4 75.  70.  69.6
  72.2 73.  67.8 60.2 61.2 56.2]
 [ 0.   0.   0.   0.  98.4 95.6 90.  92.6 88.6 87.8 86.  86.2 85.2 85.
  84.  77.8 72.2 70.  67.6 67.2]
 [ 0.   0.   0.   0.   0.  98.8 97.  90.2 87.8 86.4 83.8 75.6 74.6 76.
  79.6 77.  71.2 66.4 68.  63.8]
 [ 0.   0.   0.   0.   0.   0.  94.8 92.2 90.2 86.6 85.6 83.6 83.4 84.
  79.6 77.  71.2 69.2 69.  67.6]
 [ 0.   0.   0.   0.   0.   0.   0.  98.6 95.4 81.2 80.6 78.8 78.8 72.
  68.8 64.2 63.6 64.6 60.6 51.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  99.2 96.4 89.8 90.  87.  86.
  80.2 73.4 70.8 65.  59.6 57.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  97.4 93.8 92.8 89.  88.
  88.  72.4 65.8 63.8 63.  58.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  96.6 94.6 91.2 87.6
  85.  52.8 55.2 55.  57.8 52.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  95.4 71.4 74.2
  63.6 64.  61.8 54.8 56.  55.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  98.8 93.4
  81.4 81.6 66.6 69.  69.6 65.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  99.4
  97.  95.2 94.4 91.  89.4 81. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  97.8 87.8 85.  76.2 73.2 70.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  98.6 97.4 82.8 74.4 74.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  99.4 97.4 94.4 90. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  96.  86.8 80.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  98.6 87.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  97.2]]
2024-08-18 03:35:44,748 [trainer.py] => Forgetting (CNN): 32.568421052631585
Accuracy Matrix (NME):
[[99.6 99.2 99.  99.  98.2 98.6 98.  96.6 95.6 95.  91.  92.8 91.8 89.6
  88.4 87.2 86.6 86.  85.4 79.4]
 [ 0.  98.6 96.4 94.6 93.4 88.8 85.8 85.2 84.8 81.  81.8 81.  79.4 79.6
  79.8 76.4 74.6 68.8 66.8 65.6]
 [ 0.   0.  97.6 97.  93.8 90.4 89.4 87.8 82.6 80.8 80.2 77.8 75.4 74.
  74.  73.2 71.  63.8 59.6 57.4]
 [ 0.   0.   0.  93.2 93.4 93.2 89.  87.4 87.4 87.2 88.  87.2 84.6 83.4
  84.  81.  81.8 77.8 77.2 74.2]
 [ 0.   0.   0.   0.  96.8 96.4 95.  95.8 94.4 94.  93.2 92.4 93.4 93.6
  93.6 89.6 86.8 87.2 87.  85.6]
 [ 0.   0.   0.   0.   0.  97.  96.4 94.  93.2 91.  89.4 88.  87.2 88.
  88.8 87.8 86.  82.6 83.6 81.8]
 [ 0.   0.   0.   0.   0.   0.  93.4 92.6 91.2 88.2 88.8 88.4 87.  88.8
  87.  85.  86.  81.6 81.6 79.2]
 [ 0.   0.   0.   0.   0.   0.   0.  96.8 94.8 85.8 85.4 85.8 84.6 82.8
  79.4 78.  77.6 76.  74.2 71.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  94.6 93.2 90.8 90.2 88.6 89.2
  85.8 84.2 86.  81.  80.6 77.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  95.6 94.4 93.  93.  93.4
  91.8 84.6 80.2 80.8 78.2 77.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  92.8 91.6 89.6 89.6
  89.2 78.4 77.2 74.4 73.2 69.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.8 84.2 84.
  76.8 74.6 75.2 69.6 68.2 67.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.  89.4
  83.  82.6 78.6 75.6 76.2 76. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  97.2
  95.2 95.2 95.4 94.  93.4 90.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  93.2 89.8 88.6 85.2 85.2 84.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  88.6 87.  80.8 77.6 78. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  90.8 90.6 87.8 88.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  91.  87.4 87.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  91.8 90.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  90.2]]
2024-08-18 03:35:44,750 [trainer.py] => Forgetting (NME): 16.49473684210526
2024-08-18 03:35:46,629 [trainer.py] => config: ./exps/icarl_cifar_B50_Inc5.json
2024-08-18 03:35:46,629 [trainer.py] => prefix: reproduce
2024-08-18 03:35:46,629 [trainer.py] => dataset: cifar224
2024-08-18 03:35:46,629 [trainer.py] => memory_size: 2000
2024-08-18 03:35:46,629 [trainer.py] => memory_per_class: 20
2024-08-18 03:35:46,629 [trainer.py] => fixed_memory: False
2024-08-18 03:35:46,629 [trainer.py] => shuffle: True
2024-08-18 03:35:46,629 [trainer.py] => init_cls: 50
2024-08-18 03:35:46,629 [trainer.py] => increment: 10
2024-08-18 03:35:46,629 [trainer.py] => model_name: icarl
2024-08-18 03:35:46,629 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-08-18 03:35:46,629 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-18 03:35:46,629 [trainer.py] => seed: 1993
2024-08-18 03:35:46,629 [trainer.py] => init_epoch: 20
2024-08-18 03:35:46,629 [trainer.py] => init_lr: 0.001
2024-08-18 03:35:46,629 [trainer.py] => init_milestones: [60, 120, 170]
2024-08-18 03:35:46,629 [trainer.py] => init_lr_decay: 0.1
2024-08-18 03:35:46,629 [trainer.py] => init_weight_decay: 0.0005
2024-08-18 03:35:46,629 [trainer.py] => epochs: 20
2024-08-18 03:35:46,629 [trainer.py] => lrate: 0.001
2024-08-18 03:35:46,629 [trainer.py] => milestones: [80, 120]
2024-08-18 03:35:46,629 [trainer.py] => lrate_decay: 0.1
2024-08-18 03:35:46,629 [trainer.py] => batch_size: 48
2024-08-18 03:35:46,629 [trainer.py] => weight_decay: 0.0002
2024-08-18 03:35:46,629 [trainer.py] => T: 2
2024-08-18 03:35:47,566 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-08-18 03:35:49,557 [trainer.py] => All params: 85798656
2024-08-18 03:35:49,558 [trainer.py] => Trainable params: 85798656
2024-08-18 03:35:49,558 [icarl.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.705, Train_accy 31.62, Test_accy 87.56:   0%|          | 0/20 [01:37<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.705, Train_accy 31.62, Test_accy 87.56:   5%|▌         | 1/20 [01:37<30:58, 97.80s/it]
Task 0, Epoch 2/20 => Loss 0.870, Train_accy 75.44:   5%|▌         | 1/20 [03:08<30:58, 97.80s/it]                 
Task 0, Epoch 2/20 => Loss 0.870, Train_accy 75.44:  10%|█         | 2/20 [03:08<28:03, 93.51s/it]
Task 0, Epoch 3/20 => Loss 0.725, Train_accy 79.38:  10%|█         | 2/20 [04:38<28:03, 93.51s/it]
Task 0, Epoch 3/20 => Loss 0.725, Train_accy 79.38:  15%|█▌        | 3/20 [04:38<26:04, 92.03s/it]
Task 0, Epoch 4/20 => Loss 0.651, Train_accy 81.58:  15%|█▌        | 3/20 [06:09<26:04, 92.03s/it]
Task 0, Epoch 4/20 => Loss 0.651, Train_accy 81.58:  20%|██        | 4/20 [06:09<24:22, 91.40s/it]
Task 0, Epoch 5/20 => Loss 0.593, Train_accy 83.12:  20%|██        | 4/20 [07:39<24:22, 91.40s/it]
Task 0, Epoch 5/20 => Loss 0.593, Train_accy 83.12:  25%|██▌       | 5/20 [07:39<22:44, 90.99s/it]
Task 0, Epoch 6/20 => Loss 0.550, Train_accy 84.22, Test_accy 92.88:  25%|██▌       | 5/20 [09:16<22:44, 90.99s/it]
Task 0, Epoch 6/20 => Loss 0.550, Train_accy 84.22, Test_accy 92.88:  30%|███       | 6/20 [09:16<21:45, 93.23s/it]
Task 0, Epoch 7/20 => Loss 0.514, Train_accy 85.27:  30%|███       | 6/20 [10:47<21:45, 93.23s/it]                 
Task 0, Epoch 7/20 => Loss 0.514, Train_accy 85.27:  35%|███▌      | 7/20 [10:47<19:59, 92.29s/it]
Task 0, Epoch 8/20 => Loss 0.507, Train_accy 85.52:  35%|███▌      | 7/20 [12:17<19:59, 92.29s/it]
Task 0, Epoch 8/20 => Loss 0.507, Train_accy 85.52:  40%|████      | 8/20 [12:17<18:19, 91.61s/it]
Task 0, Epoch 9/20 => Loss 0.477, Train_accy 86.33:  40%|████      | 8/20 [13:47<18:19, 91.61s/it]
Task 0, Epoch 9/20 => Loss 0.477, Train_accy 86.33:  45%|████▌     | 9/20 [13:47<16:43, 91.19s/it]
Task 0, Epoch 10/20 => Loss 0.464, Train_accy 86.89:  45%|████▌     | 9/20 [15:17<16:43, 91.19s/it]
Task 0, Epoch 10/20 => Loss 0.464, Train_accy 86.89:  50%|█████     | 10/20 [15:17<15:08, 90.89s/it]
Task 0, Epoch 11/20 => Loss 0.446, Train_accy 87.14, Test_accy 93.28:  50%|█████     | 10/20 [16:55<15:08, 90.89s/it]
Task 0, Epoch 11/20 => Loss 0.446, Train_accy 87.14, Test_accy 93.28:  55%|█████▌    | 11/20 [16:55<13:57, 93.07s/it]
Task 0, Epoch 12/20 => Loss 0.432, Train_accy 87.94:  55%|█████▌    | 11/20 [18:26<13:57, 93.07s/it]                 
Task 0, Epoch 12/20 => Loss 0.432, Train_accy 87.94:  60%|██████    | 12/20 [18:26<12:17, 92.23s/it]
Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.92:  60%|██████    | 12/20 [19:56<12:17, 92.23s/it]
Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.92:  65%|██████▌   | 13/20 [19:56<10:41, 91.66s/it]
Task 0, Epoch 14/20 => Loss 0.422, Train_accy 88.09:  65%|██████▌   | 13/20 [21:26<10:41, 91.66s/it]
Task 0, Epoch 14/20 => Loss 0.422, Train_accy 88.09:  70%|███████   | 14/20 [21:26<09:07, 91.24s/it]
Task 0, Epoch 15/20 => Loss 0.405, Train_accy 88.29:  70%|███████   | 14/20 [22:57<09:07, 91.24s/it]
Task 0, Epoch 15/20 => Loss 0.405, Train_accy 88.29:  75%|███████▌  | 15/20 [22:57<07:34, 90.99s/it]
Task 0, Epoch 16/20 => Loss 0.396, Train_accy 88.52, Test_accy 93.38:  75%|███████▌  | 15/20 [24:35<07:34, 90.99s/it]
Task 0, Epoch 16/20 => Loss 0.396, Train_accy 88.52, Test_accy 93.38:  80%|████████  | 16/20 [24:35<06:12, 93.07s/it]
Task 0, Epoch 17/20 => Loss 0.393, Train_accy 88.81:  80%|████████  | 16/20 [26:05<06:12, 93.07s/it]                 
Task 0, Epoch 17/20 => Loss 0.393, Train_accy 88.81:  85%|████████▌ | 17/20 [26:05<04:36, 92.30s/it]
Task 0, Epoch 18/20 => Loss 0.378, Train_accy 89.30:  85%|████████▌ | 17/20 [27:35<04:36, 92.30s/it]
Task 0, Epoch 18/20 => Loss 0.378, Train_accy 89.30:  90%|█████████ | 18/20 [27:35<03:03, 91.72s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.32:  90%|█████████ | 18/20 [29:06<03:03, 91.72s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.32:  95%|█████████▌| 19/20 [29:06<01:31, 91.33s/it]
Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61:  95%|█████████▌| 19/20 [30:36<01:31, 91.33s/it]
Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61: 100%|██████████| 20/20 [30:36<00:00, 91.00s/it]
Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61: 100%|██████████| 20/20 [30:36<00:00, 91.83s/it]
2024-08-18 04:06:26,569 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61
2024-08-18 04:06:26,570 [base.py] => Reducing exemplars...(40 per classes)
2024-08-18 04:06:26,571 [base.py] => Constructing exemplars...(40 per classes)
2024-08-18 04:07:42,373 [icarl.py] => Exemplar size: 2000
2024-08-18 04:07:42,373 [trainer.py] => CNN: {'total': 92.64, '00-49': 92.64, 'old': 0, 'new': 92.64}
2024-08-18 04:07:42,373 [trainer.py] => NME: {'total': 93.2, '00-49': 93.2, 'old': 0, 'new': 93.2}
2024-08-18 04:07:42,373 [trainer.py] => CNN top1 curve: [92.64]
2024-08-18 04:07:42,373 [trainer.py] => CNN top5 curve: [99.16]
2024-08-18 04:07:42,373 [trainer.py] => NME top1 curve: [93.2]
2024-08-18 04:07:42,373 [trainer.py] => NME top5 curve: [99.18]

Average Accuracy (CNN): 92.64
Average Accuracy (NME): 93.2
2024-08-18 04:07:42,373 [trainer.py] => Average Accuracy (CNN): 92.64
2024-08-18 04:07:42,373 [trainer.py] => Average Accuracy (NME): 93.2
2024-08-18 04:07:42,373 [trainer.py] => Train Time: 0
2024-08-18 04:07:42,373 [trainer.py] => Test Time: 15.09 

2024-08-18 04:07:42,374 [trainer.py] => All params: 85837106
2024-08-18 04:07:42,374 [trainer.py] => Trainable params: 85837106
2024-08-18 04:07:42,375 [icarl.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.033, Train_accy 78.16, Test_accy 88.43:   0%|          | 0/20 [00:42<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.033, Train_accy 78.16, Test_accy 88.43:   5%|▌         | 1/20 [00:42<13:30, 42.67s/it]
Task 1, Epoch 2/20 => Loss 2.523, Train_accy 88.04:   5%|▌         | 1/20 [01:16<13:30, 42.67s/it]                 
Task 1, Epoch 2/20 => Loss 2.523, Train_accy 88.04:  10%|█         | 2/20 [01:16<11:13, 37.44s/it]
Task 1, Epoch 3/20 => Loss 2.487, Train_accy 89.24:  10%|█         | 2/20 [01:50<11:13, 37.44s/it]
Task 1, Epoch 3/20 => Loss 2.487, Train_accy 89.24:  15%|█▌        | 3/20 [01:50<10:08, 35.77s/it]
Task 1, Epoch 4/20 => Loss 2.462, Train_accy 90.11:  15%|█▌        | 3/20 [02:24<10:08, 35.77s/it]
Task 1, Epoch 4/20 => Loss 2.462, Train_accy 90.11:  20%|██        | 4/20 [02:24<09:19, 34.98s/it]
Task 1, Epoch 5/20 => Loss 2.466, Train_accy 90.07:  20%|██        | 4/20 [02:57<09:19, 34.98s/it]
Task 1, Epoch 5/20 => Loss 2.466, Train_accy 90.07:  25%|██▌       | 5/20 [02:57<08:38, 34.57s/it]
Task 1, Epoch 6/20 => Loss 2.451, Train_accy 90.91, Test_accy 89.05:  25%|██▌       | 5/20 [03:40<08:38, 34.57s/it]
Task 1, Epoch 6/20 => Loss 2.451, Train_accy 90.91, Test_accy 89.05:  30%|███       | 6/20 [03:40<08:42, 37.32s/it]
Task 1, Epoch 7/20 => Loss 2.442, Train_accy 91.29:  30%|███       | 6/20 [04:14<08:42, 37.32s/it]                 
Task 1, Epoch 7/20 => Loss 2.442, Train_accy 91.29:  35%|███▌      | 7/20 [04:14<07:50, 36.17s/it]
Task 1, Epoch 8/20 => Loss 2.392, Train_accy 92.17:  35%|███▌      | 7/20 [04:48<07:50, 36.17s/it]
Task 1, Epoch 8/20 => Loss 2.392, Train_accy 92.17:  40%|████      | 8/20 [04:48<07:04, 35.40s/it]
Task 1, Epoch 9/20 => Loss 2.397, Train_accy 91.71:  40%|████      | 8/20 [05:21<07:04, 35.40s/it]
Task 1, Epoch 9/20 => Loss 2.397, Train_accy 91.71:  45%|████▌     | 9/20 [05:21<06:23, 34.83s/it]
Task 1, Epoch 10/20 => Loss 2.411, Train_accy 92.03:  45%|████▌     | 9/20 [05:55<06:23, 34.83s/it]
Task 1, Epoch 10/20 => Loss 2.411, Train_accy 92.03:  50%|█████     | 10/20 [05:55<05:44, 34.49s/it]
Task 1, Epoch 11/20 => Loss 2.411, Train_accy 91.77, Test_accy 89.40:  50%|█████     | 10/20 [06:38<05:44, 34.49s/it]
Task 1, Epoch 11/20 => Loss 2.411, Train_accy 91.77, Test_accy 89.40:  55%|█████▌    | 11/20 [06:38<05:32, 36.99s/it]
Task 1, Epoch 12/20 => Loss 2.401, Train_accy 92.41:  55%|█████▌    | 11/20 [07:11<05:32, 36.99s/it]                 
Task 1, Epoch 12/20 => Loss 2.401, Train_accy 92.41:  60%|██████    | 12/20 [07:11<04:48, 36.04s/it]
Task 1, Epoch 13/20 => Loss 2.370, Train_accy 92.74:  60%|██████    | 12/20 [07:45<04:48, 36.04s/it]
Task 1, Epoch 13/20 => Loss 2.370, Train_accy 92.74:  65%|██████▌   | 13/20 [07:45<04:07, 35.32s/it]
Task 1, Epoch 14/20 => Loss 2.357, Train_accy 92.90:  65%|██████▌   | 13/20 [08:19<04:07, 35.32s/it]
Task 1, Epoch 14/20 => Loss 2.357, Train_accy 92.90:  70%|███████   | 14/20 [08:19<03:29, 34.86s/it]
Task 1, Epoch 15/20 => Loss 2.375, Train_accy 93.03:  70%|███████   | 14/20 [08:53<03:29, 34.86s/it]
Task 1, Epoch 15/20 => Loss 2.375, Train_accy 93.03:  75%|███████▌  | 15/20 [08:53<02:52, 34.54s/it]
Task 1, Epoch 16/20 => Loss 2.361, Train_accy 92.94, Test_accy 89.92:  75%|███████▌  | 15/20 [09:35<02:52, 34.54s/it]
Task 1, Epoch 16/20 => Loss 2.361, Train_accy 92.94, Test_accy 89.92:  80%|████████  | 16/20 [09:35<02:28, 37.01s/it]
Task 1, Epoch 17/20 => Loss 2.430, Train_accy 91.99:  80%|████████  | 16/20 [10:09<02:28, 37.01s/it]                 
Task 1, Epoch 17/20 => Loss 2.430, Train_accy 91.99:  85%|████████▌ | 17/20 [10:09<01:47, 35.99s/it]
Task 1, Epoch 18/20 => Loss 2.342, Train_accy 93.14:  85%|████████▌ | 17/20 [10:43<01:47, 35.99s/it]
Task 1, Epoch 18/20 => Loss 2.342, Train_accy 93.14:  90%|█████████ | 18/20 [10:43<01:10, 35.31s/it]
Task 1, Epoch 19/20 => Loss 2.358, Train_accy 93.00:  90%|█████████ | 18/20 [11:17<01:10, 35.31s/it]
Task 1, Epoch 19/20 => Loss 2.358, Train_accy 93.00:  95%|█████████▌| 19/20 [11:17<00:34, 34.86s/it]
Task 1, Epoch 20/20 => Loss 2.357, Train_accy 93.60:  95%|█████████▌| 19/20 [11:50<00:34, 34.86s/it]
Task 1, Epoch 20/20 => Loss 2.357, Train_accy 93.60: 100%|██████████| 20/20 [11:50<00:00, 34.50s/it]
Task 1, Epoch 20/20 => Loss 2.357, Train_accy 93.60: 100%|██████████| 20/20 [11:50<00:00, 35.53s/it]
2024-08-18 04:19:33,126 [icarl.py] => Task 1, Epoch 20/20 => Loss 2.357, Train_accy 93.60
2024-08-18 04:19:33,127 [base.py] => Reducing exemplars...(33 per classes)
2024-08-18 04:19:43,753 [base.py] => Constructing exemplars...(33 per classes)
2024-08-18 04:20:13,943 [icarl.py] => Exemplar size: 1980
2024-08-18 04:20:13,943 [trainer.py] => CNN: {'total': 89.37, '00-49': 87.86, '50-59': 96.9, 'old': 87.86, 'new': 96.9}
2024-08-18 04:20:13,943 [trainer.py] => NME: {'total': 91.92, '00-49': 91.76, '50-59': 92.7, 'old': 91.76, 'new': 92.7}
2024-08-18 04:20:13,943 [trainer.py] => CNN top1 curve: [92.64, 89.37]
2024-08-18 04:20:13,943 [trainer.py] => CNN top5 curve: [99.16, 98.4]
2024-08-18 04:20:13,943 [trainer.py] => NME top1 curve: [93.2, 91.92]
2024-08-18 04:20:13,943 [trainer.py] => NME top5 curve: [99.18, 99.05]

Average Accuracy (CNN): 91.0
Average Accuracy (NME): 92.56
2024-08-18 04:20:13,944 [trainer.py] => Average Accuracy (CNN): 91.0
2024-08-18 04:20:13,944 [trainer.py] => Average Accuracy (NME): 92.56
2024-08-18 04:20:13,944 [trainer.py] => Train Time: 0
2024-08-18 04:20:13,944 [trainer.py] => Test Time: 33.04 

2024-08-18 04:20:13,944 [trainer.py] => All params: 85844796
2024-08-18 04:20:13,945 [trainer.py] => Trainable params: 85844796
2024-08-18 04:20:13,945 [icarl.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.931, Train_accy 80.50, Test_accy 85.36:   0%|          | 0/20 [00:43<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.931, Train_accy 80.50, Test_accy 85.36:   5%|▌         | 1/20 [00:43<13:55, 43.97s/it]
Task 2, Epoch 2/20 => Loss 2.263, Train_accy 90.03:   5%|▌         | 1/20 [01:17<13:55, 43.97s/it]                 
Task 2, Epoch 2/20 => Loss 2.263, Train_accy 90.03:  10%|█         | 2/20 [01:17<11:22, 37.93s/it]
Task 2, Epoch 3/20 => Loss 2.196, Train_accy 91.52:  10%|█         | 2/20 [01:51<11:22, 37.93s/it]
Task 2, Epoch 3/20 => Loss 2.196, Train_accy 91.52:  15%|█▌        | 3/20 [01:51<10:10, 35.91s/it]
Task 2, Epoch 4/20 => Loss 2.151, Train_accy 92.48:  15%|█▌        | 3/20 [02:24<10:10, 35.91s/it]
Task 2, Epoch 4/20 => Loss 2.151, Train_accy 92.48:  20%|██        | 4/20 [02:24<09:19, 34.96s/it]
Task 2, Epoch 5/20 => Loss 2.131, Train_accy 92.62:  20%|██        | 4/20 [02:58<09:19, 34.96s/it]
Task 2, Epoch 5/20 => Loss 2.131, Train_accy 92.62:  25%|██▌       | 5/20 [02:58<08:36, 34.42s/it]
Task 2, Epoch 6/20 => Loss 2.134, Train_accy 92.84, Test_accy 85.93:  25%|██▌       | 5/20 [03:42<08:36, 34.42s/it]
Task 2, Epoch 6/20 => Loss 2.134, Train_accy 92.84, Test_accy 85.93:  30%|███       | 6/20 [03:42<08:47, 37.66s/it]
Task 2, Epoch 7/20 => Loss 2.131, Train_accy 93.21:  30%|███       | 6/20 [04:15<08:47, 37.66s/it]                 
Task 2, Epoch 7/20 => Loss 2.131, Train_accy 93.21:  35%|███▌      | 7/20 [04:15<07:52, 36.31s/it]
Task 2, Epoch 8/20 => Loss 2.139, Train_accy 93.50:  35%|███▌      | 7/20 [04:49<07:52, 36.31s/it]
Task 2, Epoch 8/20 => Loss 2.139, Train_accy 93.50:  40%|████      | 8/20 [04:49<07:05, 35.48s/it]
Task 2, Epoch 9/20 => Loss 2.101, Train_accy 93.48:  40%|████      | 8/20 [05:22<07:05, 35.48s/it]
Task 2, Epoch 9/20 => Loss 2.101, Train_accy 93.48:  45%|████▌     | 9/20 [05:22<06:23, 34.88s/it]
Task 2, Epoch 10/20 => Loss 2.144, Train_accy 93.52:  45%|████▌     | 9/20 [05:56<06:23, 34.88s/it]
Task 2, Epoch 10/20 => Loss 2.144, Train_accy 93.52:  50%|█████     | 10/20 [05:56<05:45, 34.50s/it]
Task 2, Epoch 11/20 => Loss 2.103, Train_accy 93.71, Test_accy 87.09:  50%|█████     | 10/20 [06:40<05:45, 34.50s/it]
Task 2, Epoch 11/20 => Loss 2.103, Train_accy 93.71, Test_accy 87.09:  55%|█████▌    | 11/20 [06:40<05:36, 37.41s/it]
Task 2, Epoch 12/20 => Loss 2.095, Train_accy 94.04:  55%|█████▌    | 11/20 [07:14<05:36, 37.41s/it]                 
Task 2, Epoch 12/20 => Loss 2.095, Train_accy 94.04:  60%|██████    | 12/20 [07:14<04:50, 36.27s/it]
Task 2, Epoch 13/20 => Loss 2.073, Train_accy 94.34:  60%|██████    | 12/20 [07:47<04:50, 36.27s/it]
Task 2, Epoch 13/20 => Loss 2.073, Train_accy 94.34:  65%|██████▌   | 13/20 [07:47<04:08, 35.44s/it]
Task 2, Epoch 14/20 => Loss 2.089, Train_accy 94.10:  65%|██████▌   | 13/20 [08:21<04:08, 35.44s/it]
Task 2, Epoch 14/20 => Loss 2.089, Train_accy 94.10:  70%|███████   | 14/20 [08:21<03:29, 34.87s/it]
Task 2, Epoch 15/20 => Loss 2.108, Train_accy 93.93:  70%|███████   | 14/20 [08:55<03:29, 34.87s/it]
Task 2, Epoch 15/20 => Loss 2.108, Train_accy 93.93:  75%|███████▌  | 15/20 [08:55<02:52, 34.54s/it]
Task 2, Epoch 16/20 => Loss 2.077, Train_accy 94.13, Test_accy 86.86:  75%|███████▌  | 15/20 [09:39<02:52, 34.54s/it]
Task 2, Epoch 16/20 => Loss 2.077, Train_accy 94.13, Test_accy 86.86:  80%|████████  | 16/20 [09:39<02:29, 37.42s/it]
Task 2, Epoch 17/20 => Loss 2.091, Train_accy 94.07:  80%|████████  | 16/20 [10:12<02:29, 37.42s/it]                 
Task 2, Epoch 17/20 => Loss 2.091, Train_accy 94.07:  85%|████████▌ | 17/20 [10:12<01:48, 36.28s/it]
Task 2, Epoch 18/20 => Loss 2.092, Train_accy 93.91:  85%|████████▌ | 17/20 [10:46<01:48, 36.28s/it]
Task 2, Epoch 18/20 => Loss 2.092, Train_accy 93.91:  90%|█████████ | 18/20 [10:46<01:10, 35.47s/it]
Task 2, Epoch 19/20 => Loss 2.079, Train_accy 94.46:  90%|█████████ | 18/20 [11:19<01:10, 35.47s/it]
Task 2, Epoch 19/20 => Loss 2.079, Train_accy 94.46:  95%|█████████▌| 19/20 [11:19<00:34, 34.90s/it]
Task 2, Epoch 20/20 => Loss 2.075, Train_accy 94.48:  95%|█████████▌| 19/20 [11:53<00:34, 34.90s/it]
Task 2, Epoch 20/20 => Loss 2.075, Train_accy 94.48: 100%|██████████| 20/20 [11:53<00:00, 34.52s/it]
Task 2, Epoch 20/20 => Loss 2.075, Train_accy 94.48: 100%|██████████| 20/20 [11:53<00:00, 35.68s/it]
2024-08-18 04:32:07,613 [icarl.py] => Task 2, Epoch 20/20 => Loss 2.075, Train_accy 94.48
2024-08-18 04:32:07,613 [base.py] => Reducing exemplars...(28 per classes)
2024-08-18 04:32:19,186 [base.py] => Constructing exemplars...(28 per classes)
2024-08-18 04:32:52,063 [icarl.py] => Exemplar size: 1960
2024-08-18 04:32:52,063 [trainer.py] => CNN: {'total': 86.61, '00-49': 84.72, '50-59': 84.2, '60-69': 98.5, 'old': 84.63, 'new': 98.5}
2024-08-18 04:32:52,063 [trainer.py] => NME: {'total': 90.27, '00-49': 89.92, '50-59': 87.6, '60-69': 94.7, 'old': 89.53, 'new': 94.7}
2024-08-18 04:32:52,063 [trainer.py] => CNN top1 curve: [92.64, 89.37, 86.61]
2024-08-18 04:32:52,063 [trainer.py] => CNN top5 curve: [99.16, 98.4, 97.66]
2024-08-18 04:32:52,063 [trainer.py] => NME top1 curve: [93.2, 91.92, 90.27]
2024-08-18 04:32:52,063 [trainer.py] => NME top5 curve: [99.18, 99.05, 98.9]

Average Accuracy (CNN): 89.54
Average Accuracy (NME): 91.8
2024-08-18 04:32:52,064 [trainer.py] => Average Accuracy (CNN): 89.54
2024-08-18 04:32:52,064 [trainer.py] => Average Accuracy (NME): 91.8
2024-08-18 04:32:52,064 [trainer.py] => Train Time: 0
2024-08-18 04:32:52,064 [trainer.py] => Test Time: 54.03 

2024-08-18 04:32:52,064 [trainer.py] => All params: 85852486
2024-08-18 04:32:52,065 [trainer.py] => Trainable params: 85852486
2024-08-18 04:32:52,066 [icarl.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.882, Train_accy 77.66, Test_accy 80.45:   0%|          | 0/20 [00:45<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.882, Train_accy 77.66, Test_accy 80.45:   5%|▌         | 1/20 [00:45<14:23, 45.44s/it]
Task 3, Epoch 2/20 => Loss 2.136, Train_accy 87.95:   5%|▌         | 1/20 [01:18<14:23, 45.44s/it]                 
Task 3, Epoch 2/20 => Loss 2.136, Train_accy 87.95:  10%|█         | 2/20 [01:18<11:32, 38.45s/it]
Task 3, Epoch 3/20 => Loss 2.075, Train_accy 89.27:  10%|█         | 2/20 [01:52<11:32, 38.45s/it]
Task 3, Epoch 3/20 => Loss 2.075, Train_accy 89.27:  15%|█▌        | 3/20 [01:52<10:15, 36.22s/it]
Task 3, Epoch 4/20 => Loss 2.019, Train_accy 90.66:  15%|█▌        | 3/20 [02:26<10:15, 36.22s/it]
Task 3, Epoch 4/20 => Loss 2.019, Train_accy 90.66:  20%|██        | 4/20 [02:26<09:22, 35.17s/it]
Task 3, Epoch 5/20 => Loss 2.027, Train_accy 91.31:  20%|██        | 4/20 [02:59<09:22, 35.17s/it]
Task 3, Epoch 5/20 => Loss 2.027, Train_accy 91.31:  25%|██▌       | 5/20 [02:59<08:38, 34.56s/it]
Task 3, Epoch 6/20 => Loss 1.983, Train_accy 91.93, Test_accy 80.68:  25%|██▌       | 5/20 [03:44<08:38, 34.56s/it]
Task 3, Epoch 6/20 => Loss 1.983, Train_accy 91.93, Test_accy 80.68:  30%|███       | 6/20 [03:44<08:54, 38.16s/it]
Task 3, Epoch 7/20 => Loss 2.006, Train_accy 91.62:  30%|███       | 6/20 [04:18<08:54, 38.16s/it]                 
Task 3, Epoch 7/20 => Loss 2.006, Train_accy 91.62:  35%|███▌      | 7/20 [04:18<07:56, 36.62s/it]
Task 3, Epoch 8/20 => Loss 1.988, Train_accy 91.93:  35%|███▌      | 7/20 [04:51<07:56, 36.62s/it]
Task 3, Epoch 8/20 => Loss 1.988, Train_accy 91.93:  40%|████      | 8/20 [04:51<07:07, 35.65s/it]
Task 3, Epoch 9/20 => Loss 1.971, Train_accy 92.46:  40%|████      | 8/20 [05:25<07:07, 35.65s/it]
Task 3, Epoch 9/20 => Loss 1.971, Train_accy 92.46:  45%|████▌     | 9/20 [05:25<06:24, 34.95s/it]
Task 3, Epoch 10/20 => Loss 1.941, Train_accy 92.97:  45%|████▌     | 9/20 [05:58<06:24, 34.95s/it]
Task 3, Epoch 10/20 => Loss 1.941, Train_accy 92.97:  50%|█████     | 10/20 [05:58<05:44, 34.49s/it]
Task 3, Epoch 11/20 => Loss 1.943, Train_accy 93.30, Test_accy 82.31:  50%|█████     | 10/20 [06:43<05:44, 34.49s/it]
Task 3, Epoch 11/20 => Loss 1.943, Train_accy 93.30, Test_accy 82.31:  55%|█████▌    | 11/20 [06:43<05:39, 37.73s/it]
Task 3, Epoch 12/20 => Loss 1.957, Train_accy 93.00:  55%|█████▌    | 11/20 [07:17<05:39, 37.73s/it]                 
Task 3, Epoch 12/20 => Loss 1.957, Train_accy 93.00:  60%|██████    | 12/20 [07:17<04:51, 36.44s/it]
Task 3, Epoch 13/20 => Loss 1.910, Train_accy 94.02:  60%|██████    | 12/20 [07:50<04:51, 36.44s/it]
Task 3, Epoch 13/20 => Loss 1.910, Train_accy 94.02:  65%|██████▌   | 13/20 [07:50<04:09, 35.57s/it]
Task 3, Epoch 14/20 => Loss 1.953, Train_accy 93.25:  65%|██████▌   | 13/20 [08:24<04:09, 35.57s/it]
Task 3, Epoch 14/20 => Loss 1.953, Train_accy 93.25:  70%|███████   | 14/20 [08:24<03:29, 34.93s/it]
Task 3, Epoch 15/20 => Loss 1.956, Train_accy 92.83:  70%|███████   | 14/20 [08:57<03:29, 34.93s/it]
Task 3, Epoch 15/20 => Loss 1.956, Train_accy 92.83:  75%|███████▌  | 15/20 [08:57<02:52, 34.49s/it]
Task 3, Epoch 16/20 => Loss 1.886, Train_accy 93.94, Test_accy 80.86:  75%|███████▌  | 15/20 [09:42<02:52, 34.49s/it]
Task 3, Epoch 16/20 => Loss 1.886, Train_accy 93.94, Test_accy 80.86:  80%|████████  | 16/20 [09:42<02:30, 37.72s/it]
Task 3, Epoch 17/20 => Loss 1.940, Train_accy 93.91:  80%|████████  | 16/20 [10:16<02:30, 37.72s/it]                 
Task 3, Epoch 17/20 => Loss 1.940, Train_accy 93.91:  85%|████████▌ | 17/20 [10:16<01:49, 36.42s/it]
Task 3, Epoch 18/20 => Loss 1.910, Train_accy 94.08:  85%|████████▌ | 17/20 [10:49<01:49, 36.42s/it]
Task 3, Epoch 18/20 => Loss 1.910, Train_accy 94.08:  90%|█████████ | 18/20 [10:49<01:11, 35.50s/it]
Task 3, Epoch 19/20 => Loss 1.920, Train_accy 93.71:  90%|█████████ | 18/20 [11:23<01:11, 35.50s/it]
Task 3, Epoch 19/20 => Loss 1.920, Train_accy 93.71:  95%|█████████▌| 19/20 [11:23<00:34, 34.85s/it]
Task 3, Epoch 20/20 => Loss 1.905, Train_accy 94.28:  95%|█████████▌| 19/20 [11:56<00:34, 34.85s/it]
Task 3, Epoch 20/20 => Loss 1.905, Train_accy 94.28: 100%|██████████| 20/20 [11:56<00:00, 34.40s/it]
Task 3, Epoch 20/20 => Loss 1.905, Train_accy 94.28: 100%|██████████| 20/20 [11:56<00:00, 35.82s/it]
2024-08-18 04:44:48,482 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.905, Train_accy 94.28
2024-08-18 04:44:48,483 [base.py] => Reducing exemplars...(25 per classes)
2024-08-18 04:45:01,241 [base.py] => Constructing exemplars...(25 per classes)
2024-08-18 04:45:36,619 [icarl.py] => Exemplar size: 2000
2024-08-18 04:45:36,619 [trainer.py] => CNN: {'total': 81.16, '00-49': 79.6, '50-59': 67.6, '60-69': 89.7, '70-79': 94.0, 'old': 79.33, 'new': 94.0}
2024-08-18 04:45:36,619 [trainer.py] => NME: {'total': 87.39, '00-49': 87.9, '50-59': 79.4, '60-69': 89.6, '70-79': 90.6, 'old': 86.93, 'new': 90.6}
2024-08-18 04:45:36,619 [trainer.py] => CNN top1 curve: [92.64, 89.37, 86.61, 81.16]
2024-08-18 04:45:36,619 [trainer.py] => CNN top5 curve: [99.16, 98.4, 97.66, 96.68]
2024-08-18 04:45:36,619 [trainer.py] => NME top1 curve: [93.2, 91.92, 90.27, 87.39]
2024-08-18 04:45:36,619 [trainer.py] => NME top5 curve: [99.18, 99.05, 98.9, 98.45]

Average Accuracy (CNN): 87.44
Average Accuracy (NME): 90.7
2024-08-18 04:45:36,619 [trainer.py] => Average Accuracy (CNN): 87.44
2024-08-18 04:45:36,619 [trainer.py] => Average Accuracy (NME): 90.7
2024-08-18 04:45:36,619 [trainer.py] => Train Time: 0
2024-08-18 04:45:36,619 [trainer.py] => Test Time: 77.68 

2024-08-18 04:45:36,620 [trainer.py] => All params: 85860176
2024-08-18 04:45:36,620 [trainer.py] => Trainable params: 85860176
2024-08-18 04:45:36,621 [icarl.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.182, Train_accy 79.09, Test_accy 76.77:   0%|          | 0/20 [00:47<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.182, Train_accy 79.09, Test_accy 76.77:   5%|▌         | 1/20 [00:47<14:53, 47.05s/it]
Task 4, Epoch 2/20 => Loss 2.477, Train_accy 89.27:   5%|▌         | 1/20 [01:20<14:53, 47.05s/it]                 
Task 4, Epoch 2/20 => Loss 2.477, Train_accy 89.27:  10%|█         | 2/20 [01:20<11:46, 39.22s/it]
Task 4, Epoch 3/20 => Loss 2.388, Train_accy 90.87:  10%|█         | 2/20 [01:54<11:46, 39.22s/it]
Task 4, Epoch 3/20 => Loss 2.388, Train_accy 90.87:  15%|█▌        | 3/20 [01:54<10:23, 36.68s/it]
Task 4, Epoch 4/20 => Loss 2.369, Train_accy 91.56:  15%|█▌        | 3/20 [02:28<10:23, 36.68s/it]
Task 4, Epoch 4/20 => Loss 2.369, Train_accy 91.56:  20%|██        | 4/20 [02:28<09:27, 35.50s/it]
Task 4, Epoch 5/20 => Loss 2.373, Train_accy 91.74:  20%|██        | 4/20 [03:01<09:27, 35.50s/it]
Task 4, Epoch 5/20 => Loss 2.373, Train_accy 91.74:  25%|██▌       | 5/20 [03:01<08:42, 34.84s/it]
Task 4, Epoch 6/20 => Loss 2.347, Train_accy 92.16, Test_accy 77.41:  25%|██▌       | 5/20 [03:48<08:42, 34.84s/it]
Task 4, Epoch 6/20 => Loss 2.347, Train_accy 92.16, Test_accy 77.41:  30%|███       | 6/20 [03:48<09:04, 38.93s/it]
Task 4, Epoch 7/20 => Loss 2.343, Train_accy 92.54:  30%|███       | 6/20 [04:22<09:04, 38.93s/it]                 
Task 4, Epoch 7/20 => Loss 2.343, Train_accy 92.54:  35%|███▌      | 7/20 [04:22<08:03, 37.21s/it]
Task 4, Epoch 8/20 => Loss 2.325, Train_accy 92.87:  35%|███▌      | 7/20 [04:56<08:03, 37.21s/it]
Task 4, Epoch 8/20 => Loss 2.325, Train_accy 92.87:  40%|████      | 8/20 [04:56<07:13, 36.09s/it]
Task 4, Epoch 9/20 => Loss 2.323, Train_accy 93.17:  40%|████      | 8/20 [05:29<07:13, 36.09s/it]
Task 4, Epoch 9/20 => Loss 2.323, Train_accy 93.17:  45%|████▌     | 9/20 [05:29<06:28, 35.32s/it]
Task 4, Epoch 10/20 => Loss 2.322, Train_accy 93.34:  45%|████▌     | 9/20 [06:03<06:28, 35.32s/it]
Task 4, Epoch 10/20 => Loss 2.322, Train_accy 93.34:  50%|█████     | 10/20 [06:03<05:48, 34.80s/it]
Task 4, Epoch 11/20 => Loss 2.315, Train_accy 93.29, Test_accy 76.70:  50%|█████     | 10/20 [06:50<05:48, 34.80s/it]
Task 4, Epoch 11/20 => Loss 2.315, Train_accy 93.29, Test_accy 76.70:  55%|█████▌    | 11/20 [06:50<05:46, 38.50s/it]
Task 4, Epoch 12/20 => Loss 2.290, Train_accy 93.46:  55%|█████▌    | 11/20 [07:23<05:46, 38.50s/it]                 
Task 4, Epoch 12/20 => Loss 2.290, Train_accy 93.46:  60%|██████    | 12/20 [07:23<04:56, 37.04s/it]
Task 4, Epoch 13/20 => Loss 2.334, Train_accy 93.26:  60%|██████    | 12/20 [07:57<04:56, 37.04s/it]
Task 4, Epoch 13/20 => Loss 2.334, Train_accy 93.26:  65%|██████▌   | 13/20 [07:57<04:11, 35.99s/it]
Task 4, Epoch 14/20 => Loss 2.291, Train_accy 93.99:  65%|██████▌   | 13/20 [08:31<04:11, 35.99s/it]
Task 4, Epoch 14/20 => Loss 2.291, Train_accy 93.99:  70%|███████   | 14/20 [08:31<03:31, 35.27s/it]
Task 4, Epoch 15/20 => Loss 2.282, Train_accy 93.86:  70%|███████   | 14/20 [09:04<03:31, 35.27s/it]
Task 4, Epoch 15/20 => Loss 2.282, Train_accy 93.86:  75%|███████▌  | 15/20 [09:04<02:53, 34.74s/it]
Task 4, Epoch 16/20 => Loss 2.302, Train_accy 93.66, Test_accy 76.82:  75%|███████▌  | 15/20 [09:51<02:53, 34.74s/it]
Task 4, Epoch 16/20 => Loss 2.302, Train_accy 93.66, Test_accy 76.82:  80%|████████  | 16/20 [09:51<02:33, 38.38s/it]
Task 4, Epoch 17/20 => Loss 2.314, Train_accy 93.56:  80%|████████  | 16/20 [10:25<02:33, 38.38s/it]                 
Task 4, Epoch 17/20 => Loss 2.314, Train_accy 93.56:  85%|████████▌ | 17/20 [10:25<01:50, 36.96s/it]
Task 4, Epoch 18/20 => Loss 2.309, Train_accy 93.84:  85%|████████▌ | 17/20 [10:58<01:50, 36.96s/it]
Task 4, Epoch 18/20 => Loss 2.309, Train_accy 93.84:  90%|█████████ | 18/20 [10:58<01:11, 35.97s/it]
Task 4, Epoch 19/20 => Loss 2.255, Train_accy 94.59:  90%|█████████ | 18/20 [11:32<01:11, 35.97s/it]
Task 4, Epoch 19/20 => Loss 2.255, Train_accy 94.59:  95%|█████████▌| 19/20 [11:32<00:35, 35.26s/it]
Task 4, Epoch 20/20 => Loss 2.251, Train_accy 94.61:  95%|█████████▌| 19/20 [12:05<00:35, 35.26s/it]
Task 4, Epoch 20/20 => Loss 2.251, Train_accy 94.61: 100%|██████████| 20/20 [12:05<00:00, 34.75s/it]
Task 4, Epoch 20/20 => Loss 2.251, Train_accy 94.61: 100%|██████████| 20/20 [12:05<00:00, 36.29s/it]
2024-08-18 04:57:42,570 [icarl.py] => Task 4, Epoch 20/20 => Loss 2.251, Train_accy 94.61
2024-08-18 04:57:42,571 [base.py] => Reducing exemplars...(22 per classes)
2024-08-18 04:57:56,637 [base.py] => Constructing exemplars...(22 per classes)
2024-08-18 04:58:35,095 [icarl.py] => Exemplar size: 1980
2024-08-18 04:58:35,096 [trainer.py] => CNN: {'total': 77.4, '00-49': 73.14, '50-59': 65.8, '60-69': 82.6, '70-79': 85.8, '80-89': 96.7, 'old': 74.99, 'new': 96.7}
2024-08-18 04:58:35,096 [trainer.py] => NME: {'total': 85.86, '00-49': 85.38, '50-59': 76.7, '60-69': 87.9, '70-79': 87.7, '80-89': 93.5, 'old': 84.9, 'new': 93.5}
2024-08-18 04:58:35,096 [trainer.py] => CNN top1 curve: [92.64, 89.37, 86.61, 81.16, 77.4]
2024-08-18 04:58:35,096 [trainer.py] => CNN top5 curve: [99.16, 98.4, 97.66, 96.68, 95.26]
2024-08-18 04:58:35,096 [trainer.py] => NME top1 curve: [93.2, 91.92, 90.27, 87.39, 85.86]
2024-08-18 04:58:35,096 [trainer.py] => NME top5 curve: [99.18, 99.05, 98.9, 98.45, 97.83]

Average Accuracy (CNN): 85.44
Average Accuracy (NME): 89.73
2024-08-18 04:58:35,096 [trainer.py] => Average Accuracy (CNN): 85.44
2024-08-18 04:58:35,096 [trainer.py] => Average Accuracy (NME): 89.73
2024-08-18 04:58:35,096 [trainer.py] => Train Time: 0
2024-08-18 04:58:35,096 [trainer.py] => Test Time: 104.54 

2024-08-18 04:58:35,096 [trainer.py] => All params: 85867866
2024-08-18 04:58:35,097 [trainer.py] => Trainable params: 85867866
2024-08-18 04:58:35,098 [icarl.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.152, Train_accy 78.87, Test_accy 75.99:   0%|          | 0/20 [00:48<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.152, Train_accy 78.87, Test_accy 75.99:   5%|▌         | 1/20 [00:48<15:20, 48.45s/it]
Task 5, Epoch 2/20 => Loss 2.465, Train_accy 89.28:   5%|▌         | 1/20 [01:22<15:20, 48.45s/it]                 
Task 5, Epoch 2/20 => Loss 2.465, Train_accy 89.28:  10%|█         | 2/20 [01:22<11:55, 39.74s/it]
Task 5, Epoch 3/20 => Loss 2.436, Train_accy 90.26:  10%|█         | 2/20 [01:55<11:55, 39.74s/it]
Task 5, Epoch 3/20 => Loss 2.436, Train_accy 90.26:  15%|█▌        | 3/20 [01:55<10:27, 36.92s/it]
Task 5, Epoch 4/20 => Loss 2.401, Train_accy 91.45:  15%|█▌        | 3/20 [02:29<10:27, 36.92s/it]
Task 5, Epoch 4/20 => Loss 2.401, Train_accy 91.45:  20%|██        | 4/20 [02:29<09:29, 35.61s/it]
Task 5, Epoch 5/20 => Loss 2.373, Train_accy 91.58:  20%|██        | 4/20 [03:02<09:29, 35.61s/it]
Task 5, Epoch 5/20 => Loss 2.373, Train_accy 91.58:  25%|██▌       | 5/20 [03:02<08:42, 34.85s/it]
Task 5, Epoch 6/20 => Loss 2.387, Train_accy 91.91, Test_accy 75.71:  25%|██▌       | 5/20 [03:51<08:42, 34.85s/it]
Task 5, Epoch 6/20 => Loss 2.387, Train_accy 91.91, Test_accy 75.71:  30%|███       | 6/20 [03:51<09:12, 39.48s/it]
Task 5, Epoch 7/20 => Loss 2.337, Train_accy 92.59:  30%|███       | 6/20 [04:24<09:12, 39.48s/it]                 
Task 5, Epoch 7/20 => Loss 2.337, Train_accy 92.59:  35%|███▌      | 7/20 [04:24<08:07, 37.52s/it]
Task 5, Epoch 8/20 => Loss 2.352, Train_accy 92.62:  35%|███▌      | 7/20 [04:58<08:07, 37.52s/it]
Task 5, Epoch 8/20 => Loss 2.352, Train_accy 92.62:  40%|████      | 8/20 [04:58<07:14, 36.24s/it]
Task 5, Epoch 9/20 => Loss 2.382, Train_accy 92.21:  40%|████      | 8/20 [05:31<07:14, 36.24s/it]
Task 5, Epoch 9/20 => Loss 2.382, Train_accy 92.21:  45%|████▌     | 9/20 [05:31<06:29, 35.38s/it]
Task 5, Epoch 10/20 => Loss 2.359, Train_accy 92.79:  45%|████▌     | 9/20 [06:05<06:29, 35.38s/it]
Task 5, Epoch 10/20 => Loss 2.359, Train_accy 92.79:  50%|█████     | 10/20 [06:05<05:48, 34.84s/it]
Task 5, Epoch 11/20 => Loss 2.329, Train_accy 93.37, Test_accy 75.49:  50%|█████     | 10/20 [06:53<05:48, 34.84s/it]
Task 5, Epoch 11/20 => Loss 2.329, Train_accy 93.37, Test_accy 75.49:  55%|█████▌    | 11/20 [06:53<05:50, 38.89s/it]
Task 5, Epoch 12/20 => Loss 2.304, Train_accy 93.64:  55%|█████▌    | 11/20 [07:26<05:50, 38.89s/it]                 
Task 5, Epoch 12/20 => Loss 2.304, Train_accy 93.64:  60%|██████    | 12/20 [07:26<04:58, 37.28s/it]
Task 5, Epoch 13/20 => Loss 2.340, Train_accy 93.11:  60%|██████    | 12/20 [08:00<04:58, 37.28s/it]
Task 5, Epoch 13/20 => Loss 2.340, Train_accy 93.11:  65%|██████▌   | 13/20 [08:00<04:13, 36.15s/it]
Task 5, Epoch 14/20 => Loss 2.309, Train_accy 93.44:  65%|██████▌   | 13/20 [08:34<04:13, 36.15s/it]
Task 5, Epoch 14/20 => Loss 2.309, Train_accy 93.44:  70%|███████   | 14/20 [08:34<03:32, 35.39s/it]
Task 5, Epoch 15/20 => Loss 2.317, Train_accy 93.70:  70%|███████   | 14/20 [09:07<03:32, 35.39s/it]
Task 5, Epoch 15/20 => Loss 2.317, Train_accy 93.70:  75%|███████▌  | 15/20 [09:07<02:54, 34.85s/it]
Task 5, Epoch 16/20 => Loss 2.309, Train_accy 93.57, Test_accy 75.51:  75%|███████▌  | 15/20 [09:56<02:54, 34.85s/it]
Task 5, Epoch 16/20 => Loss 2.309, Train_accy 93.57, Test_accy 75.51:  80%|████████  | 16/20 [09:56<02:35, 38.98s/it]
Task 5, Epoch 17/20 => Loss 2.291, Train_accy 94.00:  80%|████████  | 16/20 [10:29<02:35, 38.98s/it]                 
Task 5, Epoch 17/20 => Loss 2.291, Train_accy 94.00:  85%|████████▌ | 17/20 [10:29<01:51, 37.32s/it]
Task 5, Epoch 18/20 => Loss 2.315, Train_accy 93.80:  85%|████████▌ | 17/20 [11:03<01:51, 37.32s/it]
Task 5, Epoch 18/20 => Loss 2.315, Train_accy 93.80:  90%|█████████ | 18/20 [11:03<01:12, 36.18s/it]
Task 5, Epoch 19/20 => Loss 2.281, Train_accy 94.26:  90%|█████████ | 18/20 [11:36<01:12, 36.18s/it]
Task 5, Epoch 19/20 => Loss 2.281, Train_accy 94.26:  95%|█████████▌| 19/20 [11:36<00:35, 35.37s/it]
Task 5, Epoch 20/20 => Loss 2.293, Train_accy 94.11:  95%|█████████▌| 19/20 [12:10<00:35, 35.37s/it]
Task 5, Epoch 20/20 => Loss 2.293, Train_accy 94.11: 100%|██████████| 20/20 [12:10<00:00, 34.80s/it]
Task 5, Epoch 20/20 => Loss 2.293, Train_accy 94.11: 100%|██████████| 20/20 [12:10<00:00, 36.51s/it]
2024-08-18 05:10:45,446 [icarl.py] => Task 5, Epoch 20/20 => Loss 2.293, Train_accy 94.11
2024-08-18 05:10:45,448 [base.py] => Reducing exemplars...(20 per classes)
2024-08-18 05:11:00,762 [base.py] => Constructing exemplars...(20 per classes)
2024-08-18 05:11:42,072 [icarl.py] => Exemplar size: 2000
2024-08-18 05:11:42,072 [trainer.py] => CNN: {'total': 73.58, '00-49': 67.46, '50-59': 61.5, '60-69': 75.7, '70-79': 76.8, '80-89': 88.7, '90-99': 95.8, 'old': 71.11, 'new': 95.8}
2024-08-18 05:11:42,072 [trainer.py] => NME: {'total': 84.35, '00-49': 83.3, '50-59': 76.2, '60-69': 85.3, '70-79': 83.9, '80-89': 90.5, '90-99': 91.1, 'old': 83.6, 'new': 91.1}
2024-08-18 05:11:42,072 [trainer.py] => CNN top1 curve: [92.64, 89.37, 86.61, 81.16, 77.4, 73.58]
2024-08-18 05:11:42,072 [trainer.py] => CNN top5 curve: [99.16, 98.4, 97.66, 96.68, 95.26, 92.48]
2024-08-18 05:11:42,072 [trainer.py] => NME top1 curve: [93.2, 91.92, 90.27, 87.39, 85.86, 84.35]
2024-08-18 05:11:42,072 [trainer.py] => NME top5 curve: [99.18, 99.05, 98.9, 98.45, 97.83, 97.01]

Average Accuracy (CNN): 83.46
Average Accuracy (NME): 88.83
2024-08-18 05:11:42,072 [trainer.py] => Average Accuracy (CNN): 83.46
2024-08-18 05:11:42,072 [trainer.py] => Average Accuracy (NME): 88.83
2024-08-18 05:11:42,072 [trainer.py] => Train Time: 0
2024-08-18 05:11:42,072 [trainer.py] => Test Time: 134.26 

Accuracy Matrix (CNN):
[[92.64 87.86 84.72 79.6  73.14 67.46]
 [ 0.   96.9  84.2  67.6  65.8  61.5 ]
 [ 0.    0.   98.5  89.7  82.6  75.7 ]
 [ 0.    0.    0.   94.   85.8  76.8 ]
 [ 0.    0.    0.    0.   96.7  88.7 ]
 [ 0.    0.    0.    0.    0.   95.8 ]]
2024-08-18 05:11:42,073 [trainer.py] => Forgetting (CNN): 21.716
Accuracy Matrix (NME):
[[93.2  91.76 89.92 87.9  85.38 83.3 ]
 [ 0.   92.7  87.6  79.4  76.7  76.2 ]
 [ 0.    0.   94.7  89.6  87.9  85.3 ]
 [ 0.    0.    0.   90.6  87.7  83.9 ]
 [ 0.    0.    0.    0.   93.5  90.5 ]
 [ 0.    0.    0.    0.    0.   91.1 ]]
2024-08-18 05:11:42,073 [trainer.py] => Forgetting (NME): 9.1
2024-08-18 05:11:43,866 [trainer.py] => config: ./exps/icarl_cifar_B50_Inc10.json
2024-08-18 05:11:43,866 [trainer.py] => prefix: reproduce
2024-08-18 05:11:43,866 [trainer.py] => dataset: cifar224
2024-08-18 05:11:43,866 [trainer.py] => memory_size: 2000
2024-08-18 05:11:43,866 [trainer.py] => memory_per_class: 20
2024-08-18 05:11:43,866 [trainer.py] => fixed_memory: False
2024-08-18 05:11:43,866 [trainer.py] => shuffle: True
2024-08-18 05:11:43,866 [trainer.py] => init_cls: 50
2024-08-18 05:11:43,866 [trainer.py] => increment: 5
2024-08-18 05:11:43,866 [trainer.py] => model_name: icarl
2024-08-18 05:11:43,867 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-08-18 05:11:43,867 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-18 05:11:43,867 [trainer.py] => seed: 1993
2024-08-18 05:11:43,867 [trainer.py] => init_epoch: 20
2024-08-18 05:11:43,867 [trainer.py] => init_lr: 0.001
2024-08-18 05:11:43,867 [trainer.py] => init_milestones: [60, 120, 170]
2024-08-18 05:11:43,867 [trainer.py] => init_lr_decay: 0.1
2024-08-18 05:11:43,867 [trainer.py] => init_weight_decay: 0.0005
2024-08-18 05:11:43,867 [trainer.py] => epochs: 20
2024-08-18 05:11:43,867 [trainer.py] => lrate: 0.001
2024-08-18 05:11:43,867 [trainer.py] => milestones: [80, 120]
2024-08-18 05:11:43,867 [trainer.py] => lrate_decay: 0.1
2024-08-18 05:11:43,867 [trainer.py] => batch_size: 48
2024-08-18 05:11:43,867 [trainer.py] => weight_decay: 0.0002
2024-08-18 05:11:43,867 [trainer.py] => T: 2
2024-08-18 05:11:44,795 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-08-18 05:11:46,912 [trainer.py] => All params: 85798656
2024-08-18 05:11:46,913 [trainer.py] => Trainable params: 85798656
2024-08-18 05:11:46,913 [icarl.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.705, Train_accy 31.62, Test_accy 87.56:   0%|          | 0/20 [01:37<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.705, Train_accy 31.62, Test_accy 87.56:   5%|▌         | 1/20 [01:37<30:59, 97.87s/it]
Task 0, Epoch 2/20 => Loss 0.870, Train_accy 75.44:   5%|▌         | 1/20 [03:08<30:59, 97.87s/it]                 
Task 0, Epoch 2/20 => Loss 0.870, Train_accy 75.44:  10%|█         | 2/20 [03:08<28:04, 93.61s/it]
Task 0, Epoch 3/20 => Loss 0.725, Train_accy 79.38:  10%|█         | 2/20 [04:38<28:04, 93.61s/it]
Task 0, Epoch 3/20 => Loss 0.725, Train_accy 79.38:  15%|█▌        | 3/20 [04:38<26:06, 92.16s/it]
Task 0, Epoch 4/20 => Loss 0.651, Train_accy 81.58:  15%|█▌        | 3/20 [06:09<26:06, 92.16s/it]
Task 0, Epoch 4/20 => Loss 0.651, Train_accy 81.58:  20%|██        | 4/20 [06:09<24:22, 91.39s/it]
Task 0, Epoch 5/20 => Loss 0.593, Train_accy 83.12:  20%|██        | 4/20 [07:39<24:22, 91.39s/it]
Task 0, Epoch 5/20 => Loss 0.593, Train_accy 83.12:  25%|██▌       | 5/20 [07:39<22:43, 90.93s/it]
Task 0, Epoch 6/20 => Loss 0.550, Train_accy 84.22, Test_accy 92.88:  25%|██▌       | 5/20 [09:17<22:43, 90.93s/it]
Task 0, Epoch 6/20 => Loss 0.550, Train_accy 84.22, Test_accy 92.88:  30%|███       | 6/20 [09:17<21:45, 93.28s/it]
Task 0, Epoch 7/20 => Loss 0.514, Train_accy 85.27:  30%|███       | 6/20 [10:47<21:45, 93.28s/it]                 
Task 0, Epoch 7/20 => Loss 0.514, Train_accy 85.27:  35%|███▌      | 7/20 [10:47<19:59, 92.29s/it]
Task 0, Epoch 8/20 => Loss 0.507, Train_accy 85.52:  35%|███▌      | 7/20 [12:17<19:59, 92.29s/it]
Task 0, Epoch 8/20 => Loss 0.507, Train_accy 85.52:  40%|████      | 8/20 [12:17<18:19, 91.66s/it]
Task 0, Epoch 9/20 => Loss 0.477, Train_accy 86.33:  40%|████      | 8/20 [13:48<18:19, 91.66s/it]
Task 0, Epoch 9/20 => Loss 0.477, Train_accy 86.33:  45%|████▌     | 9/20 [13:48<16:44, 91.27s/it]
Task 0, Epoch 10/20 => Loss 0.464, Train_accy 86.89:  45%|████▌     | 9/20 [15:18<16:44, 91.27s/it]
Task 0, Epoch 10/20 => Loss 0.464, Train_accy 86.89:  50%|█████     | 10/20 [15:18<15:10, 91.02s/it]
Task 0, Epoch 11/20 => Loss 0.446, Train_accy 87.14, Test_accy 93.28:  50%|█████     | 10/20 [16:56<15:10, 91.02s/it]
Task 0, Epoch 11/20 => Loss 0.446, Train_accy 87.14, Test_accy 93.28:  55%|█████▌    | 11/20 [16:56<13:58, 93.12s/it]
Task 0, Epoch 12/20 => Loss 0.432, Train_accy 87.94:  55%|█████▌    | 11/20 [18:26<13:58, 93.12s/it]                 
Task 0, Epoch 12/20 => Loss 0.432, Train_accy 87.94:  60%|██████    | 12/20 [18:26<12:17, 92.22s/it]
Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.92:  60%|██████    | 12/20 [19:56<12:17, 92.22s/it]
Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.92:  65%|██████▌   | 13/20 [19:56<10:41, 91.62s/it]
Task 0, Epoch 14/20 => Loss 0.422, Train_accy 88.09:  65%|██████▌   | 13/20 [21:27<10:41, 91.62s/it]
Task 0, Epoch 14/20 => Loss 0.422, Train_accy 88.09:  70%|███████   | 14/20 [21:27<09:07, 91.22s/it]
Task 0, Epoch 15/20 => Loss 0.405, Train_accy 88.29:  70%|███████   | 14/20 [22:57<09:07, 91.22s/it]
Task 0, Epoch 15/20 => Loss 0.405, Train_accy 88.29:  75%|███████▌  | 15/20 [22:57<07:34, 90.97s/it]
Task 0, Epoch 16/20 => Loss 0.396, Train_accy 88.52, Test_accy 93.38:  75%|███████▌  | 15/20 [24:35<07:34, 90.97s/it]
Task 0, Epoch 16/20 => Loss 0.396, Train_accy 88.52, Test_accy 93.38:  80%|████████  | 16/20 [24:35<06:12, 93.08s/it]
Task 0, Epoch 17/20 => Loss 0.393, Train_accy 88.81:  80%|████████  | 16/20 [26:05<06:12, 93.08s/it]                 
Task 0, Epoch 17/20 => Loss 0.393, Train_accy 88.81:  85%|████████▌ | 17/20 [26:05<04:36, 92.30s/it]
Task 0, Epoch 18/20 => Loss 0.378, Train_accy 89.30:  85%|████████▌ | 17/20 [27:36<04:36, 92.30s/it]
Task 0, Epoch 18/20 => Loss 0.378, Train_accy 89.30:  90%|█████████ | 18/20 [27:36<03:03, 91.68s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.32:  90%|█████████ | 18/20 [29:06<03:03, 91.68s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.32:  95%|█████████▌| 19/20 [29:06<01:31, 91.23s/it]
Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61:  95%|█████████▌| 19/20 [30:36<01:31, 91.23s/it]
Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61: 100%|██████████| 20/20 [30:36<00:00, 91.03s/it]
Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61: 100%|██████████| 20/20 [30:36<00:00, 91.85s/it]
2024-08-18 05:42:24,225 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.61
2024-08-18 05:42:24,226 [base.py] => Reducing exemplars...(40 per classes)
2024-08-18 05:42:24,226 [base.py] => Constructing exemplars...(40 per classes)
2024-08-18 05:43:40,495 [icarl.py] => Exemplar size: 2000
2024-08-18 05:43:40,495 [trainer.py] => CNN: {'total': 92.64, '00-49': 92.64, 'old': 0, 'new': 92.64}
2024-08-18 05:43:40,495 [trainer.py] => NME: {'total': 93.2, '00-49': 93.2, 'old': 0, 'new': 93.2}
2024-08-18 05:43:40,495 [trainer.py] => CNN top1 curve: [92.64]
2024-08-18 05:43:40,495 [trainer.py] => CNN top5 curve: [99.16]
2024-08-18 05:43:40,495 [trainer.py] => NME top1 curve: [93.2]
2024-08-18 05:43:40,495 [trainer.py] => NME top5 curve: [99.18]

Average Accuracy (CNN): 92.64
Average Accuracy (NME): 93.2
2024-08-18 05:43:40,495 [trainer.py] => Average Accuracy (CNN): 92.64
2024-08-18 05:43:40,495 [trainer.py] => Average Accuracy (NME): 93.2
2024-08-18 05:43:40,495 [trainer.py] => Train Time: 0
2024-08-18 05:43:40,495 [trainer.py] => Test Time: 14.98 

2024-08-18 05:43:40,496 [trainer.py] => All params: 85837106
2024-08-18 05:43:40,496 [trainer.py] => Trainable params: 85837106
2024-08-18 05:43:40,497 [icarl.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.573, Train_accy 81.47, Test_accy 88.67:   0%|          | 0/20 [00:30<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.573, Train_accy 81.47, Test_accy 88.67:   5%|▌         | 1/20 [00:30<09:30, 30.03s/it]
Task 1, Epoch 2/20 => Loss 2.070, Train_accy 90.33:   5%|▌         | 1/20 [00:51<09:30, 30.03s/it]                 
Task 1, Epoch 2/20 => Loss 2.070, Train_accy 90.33:  10%|█         | 2/20 [00:51<07:32, 25.16s/it]
Task 1, Epoch 3/20 => Loss 2.097, Train_accy 90.53:  10%|█         | 2/20 [01:13<07:32, 25.16s/it]
Task 1, Epoch 3/20 => Loss 2.097, Train_accy 90.53:  15%|█▌        | 3/20 [01:13<06:41, 23.64s/it]
Task 1, Epoch 4/20 => Loss 2.068, Train_accy 90.33:  15%|█▌        | 3/20 [01:35<06:41, 23.64s/it]
Task 1, Epoch 4/20 => Loss 2.068, Train_accy 90.33:  20%|██        | 4/20 [01:35<06:06, 22.91s/it]
Task 1, Epoch 5/20 => Loss 2.060, Train_accy 91.47:  20%|██        | 4/20 [01:57<06:06, 22.91s/it]
Task 1, Epoch 5/20 => Loss 2.060, Train_accy 91.47:  25%|██▌       | 5/20 [01:57<05:37, 22.49s/it]
Task 1, Epoch 6/20 => Loss 2.024, Train_accy 92.16, Test_accy 89.60:  25%|██▌       | 5/20 [02:27<05:37, 22.49s/it]
Task 1, Epoch 6/20 => Loss 2.024, Train_accy 92.16, Test_accy 89.60:  30%|███       | 6/20 [02:27<05:51, 25.08s/it]
Task 1, Epoch 7/20 => Loss 2.013, Train_accy 92.58:  30%|███       | 6/20 [02:49<05:51, 25.08s/it]                 
Task 1, Epoch 7/20 => Loss 2.013, Train_accy 92.58:  35%|███▌      | 7/20 [02:49<05:12, 24.01s/it]
Task 1, Epoch 8/20 => Loss 1.947, Train_accy 93.78:  35%|███▌      | 7/20 [03:10<05:12, 24.01s/it]
Task 1, Epoch 8/20 => Loss 1.947, Train_accy 93.78:  40%|████      | 8/20 [03:10<04:39, 23.30s/it]
Task 1, Epoch 9/20 => Loss 2.005, Train_accy 92.58:  40%|████      | 8/20 [03:32<04:39, 23.30s/it]
Task 1, Epoch 9/20 => Loss 2.005, Train_accy 92.58:  45%|████▌     | 9/20 [03:32<04:10, 22.82s/it]
Task 1, Epoch 10/20 => Loss 1.971, Train_accy 93.80:  45%|████▌     | 9/20 [03:54<04:10, 22.82s/it]
Task 1, Epoch 10/20 => Loss 1.971, Train_accy 93.80:  50%|█████     | 10/20 [03:54<03:45, 22.51s/it]
Task 1, Epoch 11/20 => Loss 2.020, Train_accy 92.71, Test_accy 89.45:  50%|█████     | 10/20 [04:24<03:45, 22.51s/it]
Task 1, Epoch 11/20 => Loss 2.020, Train_accy 92.71, Test_accy 89.45:  55%|█████▌    | 11/20 [04:24<03:43, 24.80s/it]
Task 1, Epoch 12/20 => Loss 1.955, Train_accy 93.22:  55%|█████▌    | 11/20 [04:46<03:43, 24.80s/it]                 
Task 1, Epoch 12/20 => Loss 1.955, Train_accy 93.22:  60%|██████    | 12/20 [04:46<03:10, 23.87s/it]
Task 1, Epoch 13/20 => Loss 2.003, Train_accy 93.11:  60%|██████    | 12/20 [05:07<03:10, 23.87s/it]
Task 1, Epoch 13/20 => Loss 2.003, Train_accy 93.11:  65%|██████▌   | 13/20 [05:07<02:42, 23.24s/it]
Task 1, Epoch 14/20 => Loss 1.925, Train_accy 94.00:  65%|██████▌   | 13/20 [05:29<02:42, 23.24s/it]
Task 1, Epoch 14/20 => Loss 1.925, Train_accy 94.00:  70%|███████   | 14/20 [05:29<02:16, 22.78s/it]
Task 1, Epoch 15/20 => Loss 1.984, Train_accy 93.49:  70%|███████   | 14/20 [05:51<02:16, 22.78s/it]
Task 1, Epoch 15/20 => Loss 1.984, Train_accy 93.49:  75%|███████▌  | 15/20 [05:51<01:52, 22.48s/it]
Task 1, Epoch 16/20 => Loss 1.984, Train_accy 93.80, Test_accy 89.95:  75%|███████▌  | 15/20 [06:21<01:52, 22.48s/it]
Task 1, Epoch 16/20 => Loss 1.984, Train_accy 93.80, Test_accy 89.95:  80%|████████  | 16/20 [06:21<01:38, 24.74s/it]
Task 1, Epoch 17/20 => Loss 1.950, Train_accy 94.04:  80%|████████  | 16/20 [06:43<01:38, 24.74s/it]                 
Task 1, Epoch 17/20 => Loss 1.950, Train_accy 94.04:  85%|████████▌ | 17/20 [06:43<01:11, 23.87s/it]
Task 1, Epoch 18/20 => Loss 1.984, Train_accy 93.67:  85%|████████▌ | 17/20 [07:05<01:11, 23.87s/it]
Task 1, Epoch 18/20 => Loss 1.984, Train_accy 93.67:  90%|█████████ | 18/20 [07:05<00:46, 23.23s/it]
Task 1, Epoch 19/20 => Loss 1.918, Train_accy 94.56:  90%|█████████ | 18/20 [07:26<00:46, 23.23s/it]
Task 1, Epoch 19/20 => Loss 1.918, Train_accy 94.56:  95%|█████████▌| 19/20 [07:26<00:22, 22.78s/it]
Task 1, Epoch 20/20 => Loss 1.961, Train_accy 93.87:  95%|█████████▌| 19/20 [07:48<00:22, 22.78s/it]
Task 1, Epoch 20/20 => Loss 1.961, Train_accy 93.87: 100%|██████████| 20/20 [07:48<00:00, 22.48s/it]
Task 1, Epoch 20/20 => Loss 1.961, Train_accy 93.87: 100%|██████████| 20/20 [07:48<00:00, 23.43s/it]
2024-08-18 05:51:29,081 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.961, Train_accy 93.87
2024-08-18 05:51:29,082 [base.py] => Reducing exemplars...(36 per classes)
2024-08-18 05:51:40,334 [base.py] => Constructing exemplars...(36 per classes)
2024-08-18 05:52:02,903 [icarl.py] => Exemplar size: 1980
2024-08-18 05:52:02,903 [trainer.py] => CNN: {'total': 89.91, '00-49': 89.12, '50-54': 97.8, 'old': 89.12, 'new': 97.8}
2024-08-18 05:52:02,903 [trainer.py] => NME: {'total': 91.85, '00-49': 91.74, '50-54': 93.0, 'old': 91.74, 'new': 93.0}
2024-08-18 05:52:02,903 [trainer.py] => CNN top1 curve: [92.64, 89.91]
2024-08-18 05:52:02,903 [trainer.py] => CNN top5 curve: [99.16, 98.82]
2024-08-18 05:52:02,903 [trainer.py] => NME top1 curve: [93.2, 91.85]
2024-08-18 05:52:02,903 [trainer.py] => NME top5 curve: [99.18, 99.27]

Average Accuracy (CNN): 91.28
Average Accuracy (NME): 92.52
2024-08-18 05:52:02,903 [trainer.py] => Average Accuracy (CNN): 91.28
2024-08-18 05:52:02,903 [trainer.py] => Average Accuracy (NME): 92.52
2024-08-18 05:52:02,903 [trainer.py] => Train Time: 0
2024-08-18 05:52:02,903 [trainer.py] => Test Time: 31.400000000000002 

2024-08-18 05:52:02,904 [trainer.py] => All params: 85840951
2024-08-18 05:52:02,904 [trainer.py] => Trainable params: 85840951
2024-08-18 05:52:02,905 [icarl.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.944, Train_accy 80.18, Test_accy 87.43:   0%|          | 0/20 [00:30<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.944, Train_accy 80.18, Test_accy 87.43:   5%|▌         | 1/20 [00:30<09:40, 30.55s/it]
Task 2, Epoch 2/20 => Loss 2.471, Train_accy 89.13:   5%|▌         | 1/20 [00:52<09:40, 30.55s/it]                 
Task 2, Epoch 2/20 => Loss 2.471, Train_accy 89.13:  10%|█         | 2/20 [00:52<07:35, 25.30s/it]
Task 2, Epoch 3/20 => Loss 2.452, Train_accy 90.31:  10%|█         | 2/20 [01:13<07:35, 25.30s/it]
Task 2, Epoch 3/20 => Loss 2.452, Train_accy 90.31:  15%|█▌        | 3/20 [01:13<06:41, 23.64s/it]
Task 2, Epoch 4/20 => Loss 2.454, Train_accy 90.04:  15%|█▌        | 3/20 [01:35<06:41, 23.64s/it]
Task 2, Epoch 4/20 => Loss 2.454, Train_accy 90.04:  20%|██        | 4/20 [01:35<06:06, 22.88s/it]
Task 2, Epoch 5/20 => Loss 2.432, Train_accy 90.92:  20%|██        | 4/20 [01:57<06:06, 22.88s/it]
Task 2, Epoch 5/20 => Loss 2.432, Train_accy 90.92:  25%|██▌       | 5/20 [01:57<05:36, 22.43s/it]
Task 2, Epoch 6/20 => Loss 2.366, Train_accy 91.76, Test_accy 89.07:  25%|██▌       | 5/20 [02:27<05:36, 22.43s/it]
Task 2, Epoch 6/20 => Loss 2.366, Train_accy 91.76, Test_accy 89.07:  30%|███       | 6/20 [02:27<05:52, 25.20s/it]
Task 2, Epoch 7/20 => Loss 2.378, Train_accy 91.74:  30%|███       | 6/20 [02:49<05:52, 25.20s/it]                 
Task 2, Epoch 7/20 => Loss 2.378, Train_accy 91.74:  35%|███▌      | 7/20 [02:49<05:12, 24.05s/it]
Task 2, Epoch 8/20 => Loss 2.388, Train_accy 91.76:  35%|███▌      | 7/20 [03:11<05:12, 24.05s/it]
Task 2, Epoch 8/20 => Loss 2.388, Train_accy 91.76:  40%|████      | 8/20 [03:11<04:39, 23.26s/it]
Task 2, Epoch 9/20 => Loss 2.398, Train_accy 91.63:  40%|████      | 8/20 [03:32<04:39, 23.26s/it]
Task 2, Epoch 9/20 => Loss 2.398, Train_accy 91.63:  45%|████▌     | 9/20 [03:32<04:10, 22.75s/it]
Task 2, Epoch 10/20 => Loss 2.366, Train_accy 92.39:  45%|████▌     | 9/20 [03:54<04:10, 22.75s/it]
Task 2, Epoch 10/20 => Loss 2.366, Train_accy 92.39:  50%|█████     | 10/20 [03:54<03:44, 22.41s/it]
Task 2, Epoch 11/20 => Loss 2.370, Train_accy 92.52, Test_accy 88.68:  50%|█████     | 10/20 [04:24<03:44, 22.41s/it]
Task 2, Epoch 11/20 => Loss 2.370, Train_accy 92.52, Test_accy 88.68:  55%|█████▌    | 11/20 [04:24<03:44, 24.93s/it]
Task 2, Epoch 12/20 => Loss 2.374, Train_accy 92.57:  55%|█████▌    | 11/20 [04:46<03:44, 24.93s/it]                 
Task 2, Epoch 12/20 => Loss 2.374, Train_accy 92.57:  60%|██████    | 12/20 [04:46<03:11, 23.94s/it]
Task 2, Epoch 13/20 => Loss 2.333, Train_accy 92.48:  60%|██████    | 12/20 [05:08<03:11, 23.94s/it]
Task 2, Epoch 13/20 => Loss 2.333, Train_accy 92.48:  65%|██████▌   | 13/20 [05:08<02:42, 23.26s/it]
Task 2, Epoch 14/20 => Loss 2.370, Train_accy 92.75:  65%|██████▌   | 13/20 [05:29<02:42, 23.26s/it]
Task 2, Epoch 14/20 => Loss 2.370, Train_accy 92.75:  70%|███████   | 14/20 [05:29<02:16, 22.77s/it]
Task 2, Epoch 15/20 => Loss 2.333, Train_accy 92.99:  70%|███████   | 14/20 [05:51<02:16, 22.77s/it]
Task 2, Epoch 15/20 => Loss 2.333, Train_accy 92.99:  75%|███████▌  | 15/20 [05:51<01:52, 22.44s/it]
Task 2, Epoch 16/20 => Loss 2.380, Train_accy 92.25, Test_accy 88.07:  75%|███████▌  | 15/20 [06:22<01:52, 22.44s/it]
Task 2, Epoch 16/20 => Loss 2.380, Train_accy 92.25, Test_accy 88.07:  80%|████████  | 16/20 [06:22<01:39, 24.92s/it]
Task 2, Epoch 17/20 => Loss 2.376, Train_accy 92.37:  80%|████████  | 16/20 [06:43<01:39, 24.92s/it]                 
Task 2, Epoch 17/20 => Loss 2.376, Train_accy 92.37:  85%|████████▌ | 17/20 [06:43<01:11, 23.93s/it]
Task 2, Epoch 18/20 => Loss 2.373, Train_accy 92.75:  85%|████████▌ | 17/20 [07:05<01:11, 23.93s/it]
Task 2, Epoch 18/20 => Loss 2.373, Train_accy 92.75:  90%|█████████ | 18/20 [07:05<00:46, 23.25s/it]
Task 2, Epoch 19/20 => Loss 2.355, Train_accy 93.17:  90%|█████████ | 18/20 [07:27<00:46, 23.25s/it]
Task 2, Epoch 19/20 => Loss 2.355, Train_accy 93.17:  95%|█████████▌| 19/20 [07:27<00:22, 22.78s/it]
Task 2, Epoch 20/20 => Loss 2.354, Train_accy 92.99:  95%|█████████▌| 19/20 [07:49<00:22, 22.78s/it]
Task 2, Epoch 20/20 => Loss 2.354, Train_accy 92.99: 100%|██████████| 20/20 [07:49<00:00, 22.47s/it]
Task 2, Epoch 20/20 => Loss 2.354, Train_accy 92.99: 100%|██████████| 20/20 [07:49<00:00, 23.45s/it]
2024-08-18 05:59:51,971 [icarl.py] => Task 2, Epoch 20/20 => Loss 2.354, Train_accy 92.99
2024-08-18 05:59:51,972 [base.py] => Reducing exemplars...(33 per classes)
2024-08-18 06:00:03,724 [base.py] => Constructing exemplars...(33 per classes)
2024-08-18 06:00:27,848 [icarl.py] => Exemplar size: 1980
2024-08-18 06:00:27,848 [trainer.py] => CNN: {'total': 88.58, '00-49': 87.12, '50-54': 96.8, '55-59': 95.0, 'old': 88.0, 'new': 95.0}
2024-08-18 06:00:27,848 [trainer.py] => NME: {'total': 91.22, '00-49': 91.04, '50-54': 91.6, '55-59': 92.6, 'old': 91.09, 'new': 92.6}
2024-08-18 06:00:27,848 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58]
2024-08-18 06:00:27,848 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45]
2024-08-18 06:00:27,848 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22]
2024-08-18 06:00:27,848 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23]

Average Accuracy (CNN): 90.38
Average Accuracy (NME): 92.09
2024-08-18 06:00:27,848 [trainer.py] => Average Accuracy (CNN): 90.38
2024-08-18 06:00:27,848 [trainer.py] => Average Accuracy (NME): 92.09
2024-08-18 06:00:27,848 [trainer.py] => Train Time: 0
2024-08-18 06:00:27,848 [trainer.py] => Test Time: 49.5 

2024-08-18 06:00:27,849 [trainer.py] => All params: 85844796
2024-08-18 06:00:27,849 [trainer.py] => Trainable params: 85844796
2024-08-18 06:00:27,850 [icarl.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.632, Train_accy 83.93, Test_accy 84.28:   0%|          | 0/20 [00:31<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.632, Train_accy 83.93, Test_accy 84.28:   5%|▌         | 1/20 [00:31<09:58, 31.51s/it]
Task 3, Epoch 2/20 => Loss 2.014, Train_accy 92.10:   5%|▌         | 1/20 [00:53<09:58, 31.51s/it]                 
Task 3, Epoch 2/20 => Loss 2.014, Train_accy 92.10:  10%|█         | 2/20 [00:53<07:42, 25.71s/it]
Task 3, Epoch 3/20 => Loss 1.979, Train_accy 92.72:  10%|█         | 2/20 [01:14<07:42, 25.71s/it]
Task 3, Epoch 3/20 => Loss 1.979, Train_accy 92.72:  15%|█▌        | 3/20 [01:14<06:46, 23.89s/it]
Task 3, Epoch 4/20 => Loss 1.982, Train_accy 92.72:  15%|█▌        | 3/20 [01:36<06:46, 23.89s/it]
Task 3, Epoch 4/20 => Loss 1.982, Train_accy 92.72:  20%|██        | 4/20 [01:36<06:08, 23.05s/it]
Task 3, Epoch 5/20 => Loss 1.907, Train_accy 94.15:  20%|██        | 4/20 [01:58<06:08, 23.05s/it]
Task 3, Epoch 5/20 => Loss 1.907, Train_accy 94.15:  25%|██▌       | 5/20 [01:58<05:38, 22.56s/it]
Task 3, Epoch 6/20 => Loss 1.945, Train_accy 93.93, Test_accy 84.49:  25%|██▌       | 5/20 [02:29<05:38, 22.56s/it]
Task 3, Epoch 6/20 => Loss 1.945, Train_accy 93.93, Test_accy 84.49:  30%|███       | 6/20 [02:29<05:58, 25.59s/it]
Task 3, Epoch 7/20 => Loss 1.934, Train_accy 94.22:  30%|███       | 6/20 [02:51<05:58, 25.59s/it]                 
Task 3, Epoch 7/20 => Loss 1.934, Train_accy 94.22:  35%|███▌      | 7/20 [02:51<05:15, 24.30s/it]
Task 3, Epoch 8/20 => Loss 1.983, Train_accy 92.83:  35%|███▌      | 7/20 [03:13<05:15, 24.30s/it]
Task 3, Epoch 8/20 => Loss 1.983, Train_accy 92.83:  40%|████      | 8/20 [03:13<04:41, 23.47s/it]
Task 3, Epoch 9/20 => Loss 1.975, Train_accy 93.42:  40%|████      | 8/20 [03:34<04:41, 23.47s/it]
Task 3, Epoch 9/20 => Loss 1.975, Train_accy 93.42:  45%|████▌     | 9/20 [03:34<04:12, 22.95s/it]
Task 3, Epoch 10/20 => Loss 1.922, Train_accy 94.71:  45%|████▌     | 9/20 [03:56<04:12, 22.95s/it]
Task 3, Epoch 10/20 => Loss 1.922, Train_accy 94.71:  50%|█████     | 10/20 [03:56<03:45, 22.54s/it]
Task 3, Epoch 11/20 => Loss 1.919, Train_accy 94.06, Test_accy 87.45:  50%|█████     | 10/20 [04:28<03:45, 22.54s/it]
Task 3, Epoch 11/20 => Loss 1.919, Train_accy 94.06, Test_accy 87.45:  55%|█████▌    | 11/20 [04:28<03:47, 25.27s/it]
Task 3, Epoch 12/20 => Loss 1.928, Train_accy 94.53:  55%|█████▌    | 11/20 [04:49<03:47, 25.27s/it]                 
Task 3, Epoch 12/20 => Loss 1.928, Train_accy 94.53:  60%|██████    | 12/20 [04:49<03:13, 24.16s/it]
Task 3, Epoch 13/20 => Loss 1.925, Train_accy 94.55:  60%|██████    | 12/20 [05:11<03:13, 24.16s/it]
Task 3, Epoch 13/20 => Loss 1.925, Train_accy 94.55:  65%|██████▌   | 13/20 [05:11<02:43, 23.40s/it]
Task 3, Epoch 14/20 => Loss 1.930, Train_accy 94.49:  65%|██████▌   | 13/20 [05:33<02:43, 23.40s/it]
Task 3, Epoch 14/20 => Loss 1.930, Train_accy 94.49:  70%|███████   | 14/20 [05:33<02:17, 22.88s/it]
Task 3, Epoch 15/20 => Loss 1.898, Train_accy 94.84:  70%|███████   | 14/20 [05:54<02:17, 22.88s/it]
Task 3, Epoch 15/20 => Loss 1.898, Train_accy 94.84:  75%|███████▌  | 15/20 [05:54<01:52, 22.51s/it]
Task 3, Epoch 16/20 => Loss 1.945, Train_accy 94.44, Test_accy 87.18:  75%|███████▌  | 15/20 [06:25<01:52, 22.51s/it]
Task 3, Epoch 16/20 => Loss 1.945, Train_accy 94.44, Test_accy 87.18:  80%|████████  | 16/20 [06:25<01:40, 25.17s/it]
Task 3, Epoch 17/20 => Loss 1.870, Train_accy 95.51:  80%|████████  | 16/20 [06:47<01:40, 25.17s/it]                 
Task 3, Epoch 17/20 => Loss 1.870, Train_accy 95.51:  85%|████████▌ | 17/20 [06:47<01:12, 24.12s/it]
Task 3, Epoch 18/20 => Loss 1.895, Train_accy 95.33:  85%|████████▌ | 17/20 [07:09<01:12, 24.12s/it]
Task 3, Epoch 18/20 => Loss 1.895, Train_accy 95.33:  90%|█████████ | 18/20 [07:09<00:46, 23.36s/it]
Task 3, Epoch 19/20 => Loss 1.900, Train_accy 95.20:  90%|█████████ | 18/20 [07:30<00:46, 23.36s/it]
Task 3, Epoch 19/20 => Loss 1.900, Train_accy 95.20:  95%|█████████▌| 19/20 [07:30<00:22, 22.86s/it]
Task 3, Epoch 20/20 => Loss 1.904, Train_accy 95.29:  95%|█████████▌| 19/20 [07:52<00:22, 22.86s/it]
Task 3, Epoch 20/20 => Loss 1.904, Train_accy 95.29: 100%|██████████| 20/20 [07:52<00:00, 22.49s/it]
Task 3, Epoch 20/20 => Loss 1.904, Train_accy 95.29: 100%|██████████| 20/20 [07:52<00:00, 23.63s/it]
2024-08-18 06:08:20,491 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.904, Train_accy 95.29
2024-08-18 06:08:20,492 [base.py] => Reducing exemplars...(30 per classes)
2024-08-18 06:08:32,933 [base.py] => Constructing exemplars...(30 per classes)
2024-08-18 06:08:58,445 [icarl.py] => Exemplar size: 1950
2024-08-18 06:08:58,446 [trainer.py] => CNN: {'total': 86.23, '00-49': 85.3, '50-54': 95.0, '55-59': 73.8, '60-64': 99.2, 'old': 85.15, 'new': 99.2}
2024-08-18 06:08:58,446 [trainer.py] => NME: {'total': 90.48, '00-49': 90.64, '50-54': 92.2, '55-59': 82.6, '60-64': 95.0, 'old': 90.1, 'new': 95.0}
2024-08-18 06:08:58,446 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23]
2024-08-18 06:08:58,446 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86]
2024-08-18 06:08:58,446 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48]
2024-08-18 06:08:58,446 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92]

Average Accuracy (CNN): 89.34
Average Accuracy (NME): 91.69
2024-08-18 06:08:58,446 [trainer.py] => Average Accuracy (CNN): 89.34
2024-08-18 06:08:58,446 [trainer.py] => Average Accuracy (NME): 91.69
2024-08-18 06:08:58,446 [trainer.py] => Train Time: 0
2024-08-18 06:08:58,446 [trainer.py] => Test Time: 68.93 

2024-08-18 06:08:58,447 [trainer.py] => All params: 85848641
2024-08-18 06:08:58,447 [trainer.py] => Trainable params: 85848641
2024-08-18 06:08:58,448 [icarl.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.550, Train_accy 86.22, Test_accy 82.34:   0%|          | 0/20 [00:31<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.550, Train_accy 86.22, Test_accy 82.34:   5%|▌         | 1/20 [00:31<10:06, 31.92s/it]
Task 4, Epoch 2/20 => Loss 2.030, Train_accy 93.53:   5%|▌         | 1/20 [00:53<10:06, 31.92s/it]                 
Task 4, Epoch 2/20 => Loss 2.030, Train_accy 93.53:  10%|█         | 2/20 [00:53<07:45, 25.83s/it]
Task 4, Epoch 3/20 => Loss 2.036, Train_accy 93.35:  10%|█         | 2/20 [01:15<07:45, 25.83s/it]
Task 4, Epoch 3/20 => Loss 2.036, Train_accy 93.35:  15%|█▌        | 3/20 [01:15<06:45, 23.88s/it]
Task 4, Epoch 4/20 => Loss 2.003, Train_accy 94.16:  15%|█▌        | 3/20 [01:36<06:45, 23.88s/it]
Task 4, Epoch 4/20 => Loss 2.003, Train_accy 94.16:  20%|██        | 4/20 [01:36<06:07, 22.99s/it]
Task 4, Epoch 5/20 => Loss 2.000, Train_accy 94.58:  20%|██        | 4/20 [01:58<06:07, 22.99s/it]
Task 4, Epoch 5/20 => Loss 2.000, Train_accy 94.58:  25%|██▌       | 5/20 [01:58<05:36, 22.45s/it]
Task 4, Epoch 6/20 => Loss 1.983, Train_accy 94.49, Test_accy 84.17:  25%|██▌       | 5/20 [02:30<05:36, 22.45s/it]
Task 4, Epoch 6/20 => Loss 1.983, Train_accy 94.49, Test_accy 84.17:  30%|███       | 6/20 [02:30<05:59, 25.67s/it]
Task 4, Epoch 7/20 => Loss 2.004, Train_accy 94.79:  30%|███       | 6/20 [02:51<05:59, 25.67s/it]                 
Task 4, Epoch 7/20 => Loss 2.004, Train_accy 94.79:  35%|███▌      | 7/20 [02:51<05:16, 24.34s/it]
Task 4, Epoch 8/20 => Loss 2.023, Train_accy 94.07:  35%|███▌      | 7/20 [03:13<05:16, 24.34s/it]
Task 4, Epoch 8/20 => Loss 2.023, Train_accy 94.07:  40%|████      | 8/20 [03:13<04:41, 23.45s/it]
Task 4, Epoch 9/20 => Loss 1.985, Train_accy 95.03:  40%|████      | 8/20 [03:34<04:41, 23.45s/it]
Task 4, Epoch 9/20 => Loss 1.985, Train_accy 95.03:  45%|████▌     | 9/20 [03:34<04:11, 22.84s/it]
Task 4, Epoch 10/20 => Loss 1.974, Train_accy 95.12:  45%|████▌     | 9/20 [03:56<04:11, 22.84s/it]
Task 4, Epoch 10/20 => Loss 1.974, Train_accy 95.12:  50%|█████     | 10/20 [03:56<03:44, 22.42s/it]
Task 4, Epoch 11/20 => Loss 1.945, Train_accy 95.73, Test_accy 84.37:  50%|█████     | 10/20 [04:28<03:44, 22.42s/it]
Task 4, Epoch 11/20 => Loss 1.945, Train_accy 95.73, Test_accy 84.37:  55%|█████▌    | 11/20 [04:28<03:48, 25.35s/it]
Task 4, Epoch 12/20 => Loss 1.947, Train_accy 95.26:  55%|█████▌    | 11/20 [04:49<03:48, 25.35s/it]                 
Task 4, Epoch 12/20 => Loss 1.947, Train_accy 95.26:  60%|██████    | 12/20 [04:49<03:13, 24.20s/it]
Task 4, Epoch 13/20 => Loss 2.003, Train_accy 95.01:  60%|██████    | 12/20 [05:11<03:13, 24.20s/it]
Task 4, Epoch 13/20 => Loss 2.003, Train_accy 95.01:  65%|██████▌   | 13/20 [05:11<02:43, 23.40s/it]
Task 4, Epoch 14/20 => Loss 2.006, Train_accy 94.90:  65%|██████▌   | 13/20 [05:32<02:43, 23.40s/it]
Task 4, Epoch 14/20 => Loss 2.006, Train_accy 94.90:  70%|███████   | 14/20 [05:32<02:17, 22.85s/it]
Task 4, Epoch 15/20 => Loss 1.949, Train_accy 95.51:  70%|███████   | 14/20 [05:54<02:17, 22.85s/it]
Task 4, Epoch 15/20 => Loss 1.949, Train_accy 95.51:  75%|███████▌  | 15/20 [05:54<01:52, 22.44s/it]
Task 4, Epoch 16/20 => Loss 1.949, Train_accy 95.44, Test_accy 83.93:  75%|███████▌  | 15/20 [06:26<01:52, 22.44s/it]
Task 4, Epoch 16/20 => Loss 1.949, Train_accy 95.44, Test_accy 83.93:  80%|████████  | 16/20 [06:26<01:41, 25.30s/it]
Task 4, Epoch 17/20 => Loss 1.967, Train_accy 95.28:  80%|████████  | 16/20 [06:47<01:41, 25.30s/it]                 
Task 4, Epoch 17/20 => Loss 1.967, Train_accy 95.28:  85%|████████▌ | 17/20 [06:47<01:12, 24.19s/it]
Task 4, Epoch 18/20 => Loss 1.950, Train_accy 95.21:  85%|████████▌ | 17/20 [07:09<01:12, 24.19s/it]
Task 4, Epoch 18/20 => Loss 1.950, Train_accy 95.21:  90%|█████████ | 18/20 [07:09<00:46, 23.40s/it]
Task 4, Epoch 19/20 => Loss 1.963, Train_accy 95.30:  90%|█████████ | 18/20 [07:31<00:46, 23.40s/it]
Task 4, Epoch 19/20 => Loss 1.963, Train_accy 95.30:  95%|█████████▌| 19/20 [07:31<00:22, 22.85s/it]
Task 4, Epoch 20/20 => Loss 1.978, Train_accy 95.55:  95%|█████████▌| 19/20 [07:52<00:22, 22.85s/it]
Task 4, Epoch 20/20 => Loss 1.978, Train_accy 95.55: 100%|██████████| 20/20 [07:52<00:00, 22.43s/it]
Task 4, Epoch 20/20 => Loss 1.978, Train_accy 95.55: 100%|██████████| 20/20 [07:52<00:00, 23.63s/it]
2024-08-18 06:16:51,036 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.978, Train_accy 95.55
2024-08-18 06:16:51,037 [base.py] => Reducing exemplars...(28 per classes)
2024-08-18 06:17:03,850 [base.py] => Constructing exemplars...(28 per classes)
2024-08-18 06:17:30,735 [icarl.py] => Exemplar size: 1960
2024-08-18 06:17:30,735 [trainer.py] => CNN: {'total': 84.4, '00-49': 82.74, '50-54': 90.0, '55-59': 72.4, '60-64': 92.8, '65-69': 99.0, 'old': 83.28, 'new': 99.0}
2024-08-18 06:17:30,735 [trainer.py] => NME: {'total': 89.17, '00-49': 88.92, '50-54': 90.2, '55-59': 82.6, '60-64': 89.2, '65-69': 97.2, 'old': 88.55, 'new': 97.2}
2024-08-18 06:17:30,735 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23, 84.4]
2024-08-18 06:17:30,736 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86, 97.17]
2024-08-18 06:17:30,736 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48, 89.17]
2024-08-18 06:17:30,736 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92, 98.59]

Average Accuracy (CNN): 88.35
Average Accuracy (NME): 91.18
2024-08-18 06:17:30,736 [trainer.py] => Average Accuracy (CNN): 88.35
2024-08-18 06:17:30,736 [trainer.py] => Average Accuracy (NME): 91.18
2024-08-18 06:17:30,736 [trainer.py] => Train Time: 0
2024-08-18 06:17:30,736 [trainer.py] => Test Time: 89.91000000000001 

2024-08-18 06:17:30,736 [trainer.py] => All params: 85852486
2024-08-18 06:17:30,737 [trainer.py] => Trainable params: 85852486
2024-08-18 06:17:30,738 [icarl.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.471, Train_accy 83.00, Test_accy 81.68:   0%|          | 0/20 [00:32<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.471, Train_accy 83.00, Test_accy 81.68:   5%|▌         | 1/20 [00:32<10:21, 32.73s/it]
Task 5, Epoch 2/20 => Loss 1.849, Train_accy 91.43:   5%|▌         | 1/20 [00:54<10:21, 32.73s/it]                 
Task 5, Epoch 2/20 => Loss 1.849, Train_accy 91.43:  10%|█         | 2/20 [00:54<07:51, 26.19s/it]
Task 5, Epoch 3/20 => Loss 1.812, Train_accy 92.31:  10%|█         | 2/20 [01:15<07:51, 26.19s/it]
Task 5, Epoch 3/20 => Loss 1.812, Train_accy 92.31:  15%|█▌        | 3/20 [01:15<06:49, 24.10s/it]
Task 5, Epoch 4/20 => Loss 1.764, Train_accy 93.45:  15%|█▌        | 3/20 [01:37<06:49, 24.10s/it]
Task 5, Epoch 4/20 => Loss 1.764, Train_accy 93.45:  20%|██        | 4/20 [01:37<06:09, 23.10s/it]
Task 5, Epoch 5/20 => Loss 1.725, Train_accy 94.08:  20%|██        | 4/20 [01:59<06:09, 23.10s/it]
Task 5, Epoch 5/20 => Loss 1.725, Train_accy 94.08:  25%|██▌       | 5/20 [01:59<05:38, 22.56s/it]
Task 5, Epoch 6/20 => Loss 1.710, Train_accy 94.19, Test_accy 80.88:  25%|██▌       | 5/20 [02:31<05:38, 22.56s/it]
Task 5, Epoch 6/20 => Loss 1.710, Train_accy 94.19, Test_accy 80.88:  30%|███       | 6/20 [02:31<06:04, 26.03s/it]
Task 5, Epoch 7/20 => Loss 1.721, Train_accy 94.60:  30%|███       | 6/20 [02:53<06:04, 26.03s/it]                 
Task 5, Epoch 7/20 => Loss 1.721, Train_accy 94.60:  35%|███▌      | 7/20 [02:53<05:19, 24.57s/it]
Task 5, Epoch 8/20 => Loss 1.723, Train_accy 94.15:  35%|███▌      | 7/20 [03:15<05:19, 24.57s/it]
Task 5, Epoch 8/20 => Loss 1.723, Train_accy 94.15:  40%|████      | 8/20 [03:15<04:43, 23.65s/it]
Task 5, Epoch 9/20 => Loss 1.712, Train_accy 94.39:  40%|████      | 8/20 [03:36<04:43, 23.65s/it]
Task 5, Epoch 9/20 => Loss 1.712, Train_accy 94.39:  45%|████▌     | 9/20 [03:36<04:12, 22.98s/it]
Task 5, Epoch 10/20 => Loss 1.743, Train_accy 94.08:  45%|████▌     | 9/20 [03:58<04:12, 22.98s/it]
Task 5, Epoch 10/20 => Loss 1.743, Train_accy 94.08:  50%|█████     | 10/20 [03:58<03:45, 22.56s/it]
Task 5, Epoch 11/20 => Loss 1.733, Train_accy 94.98, Test_accy 80.09:  50%|█████     | 10/20 [04:30<03:45, 22.56s/it]
Task 5, Epoch 11/20 => Loss 1.733, Train_accy 94.98, Test_accy 80.09:  55%|█████▌    | 11/20 [04:30<03:50, 25.64s/it]
Task 5, Epoch 12/20 => Loss 1.664, Train_accy 95.31:  55%|█████▌    | 11/20 [04:52<03:50, 25.64s/it]                 
Task 5, Epoch 12/20 => Loss 1.664, Train_accy 95.31:  60%|██████    | 12/20 [04:52<03:15, 24.40s/it]
Task 5, Epoch 13/20 => Loss 1.744, Train_accy 94.35:  60%|██████    | 12/20 [05:14<03:15, 24.40s/it]
Task 5, Epoch 13/20 => Loss 1.744, Train_accy 94.35:  65%|██████▌   | 13/20 [05:14<02:44, 23.56s/it]
Task 5, Epoch 14/20 => Loss 1.697, Train_accy 94.73:  65%|██████▌   | 13/20 [05:35<02:44, 23.56s/it]
Task 5, Epoch 14/20 => Loss 1.697, Train_accy 94.73:  70%|███████   | 14/20 [05:35<02:17, 22.93s/it]
Task 5, Epoch 15/20 => Loss 1.737, Train_accy 94.55:  70%|███████   | 14/20 [05:57<02:17, 22.93s/it]
Task 5, Epoch 15/20 => Loss 1.737, Train_accy 94.55:  75%|███████▌  | 15/20 [05:57<01:52, 22.53s/it]
Task 5, Epoch 16/20 => Loss 1.680, Train_accy 95.07, Test_accy 81.08:  75%|███████▌  | 15/20 [06:30<01:52, 22.53s/it]
Task 5, Epoch 16/20 => Loss 1.680, Train_accy 95.07, Test_accy 81.08:  80%|████████  | 16/20 [06:30<01:42, 25.65s/it]
Task 5, Epoch 17/20 => Loss 1.710, Train_accy 94.73:  80%|████████  | 16/20 [06:51<01:42, 25.65s/it]                 
Task 5, Epoch 17/20 => Loss 1.710, Train_accy 94.73:  85%|████████▌ | 17/20 [06:51<01:13, 24.44s/it]
Task 5, Epoch 18/20 => Loss 1.690, Train_accy 95.07:  85%|████████▌ | 17/20 [07:13<01:13, 24.44s/it]
Task 5, Epoch 18/20 => Loss 1.690, Train_accy 95.07:  90%|█████████ | 18/20 [07:13<00:47, 23.57s/it]
Task 5, Epoch 19/20 => Loss 1.754, Train_accy 94.33:  90%|█████████ | 18/20 [07:34<00:47, 23.57s/it]
Task 5, Epoch 19/20 => Loss 1.754, Train_accy 94.33:  95%|█████████▌| 19/20 [07:34<00:22, 22.96s/it]
Task 5, Epoch 20/20 => Loss 1.712, Train_accy 94.93:  95%|█████████▌| 19/20 [07:56<00:22, 22.96s/it]
Task 5, Epoch 20/20 => Loss 1.712, Train_accy 94.93: 100%|██████████| 20/20 [07:56<00:00, 22.55s/it]
Task 5, Epoch 20/20 => Loss 1.712, Train_accy 94.93: 100%|██████████| 20/20 [07:56<00:00, 23.82s/it]
2024-08-18 06:25:27,133 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.712, Train_accy 94.93
2024-08-18 06:25:27,135 [base.py] => Reducing exemplars...(26 per classes)
2024-08-18 06:25:40,324 [base.py] => Constructing exemplars...(26 per classes)
2024-08-18 06:26:08,668 [icarl.py] => Exemplar size: 1950
2024-08-18 06:26:08,668 [trainer.py] => CNN: {'total': 80.61, '00-49': 80.12, '50-54': 83.2, '55-59': 56.6, '60-64': 77.0, '65-69': 92.6, '70-74': 98.6, 'old': 79.33, 'new': 98.6}
2024-08-18 06:26:08,668 [trainer.py] => NME: {'total': 87.72, '00-49': 87.8, '50-54': 88.8, '55-59': 77.0, '60-64': 82.0, '65-69': 95.4, '70-74': 94.6, 'old': 87.23, 'new': 94.6}
2024-08-18 06:26:08,668 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23, 84.4, 80.61]
2024-08-18 06:26:08,668 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86, 97.17, 95.69]
2024-08-18 06:26:08,668 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48, 89.17, 87.72]
2024-08-18 06:26:08,668 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92, 98.59, 98.03]

Average Accuracy (CNN): 87.06
Average Accuracy (NME): 90.61
2024-08-18 06:26:08,668 [trainer.py] => Average Accuracy (CNN): 87.06
2024-08-18 06:26:08,668 [trainer.py] => Average Accuracy (NME): 90.61
2024-08-18 06:26:08,668 [trainer.py] => Train Time: 0
2024-08-18 06:26:08,668 [trainer.py] => Test Time: 112.31 

2024-08-18 06:26:08,669 [trainer.py] => All params: 85856331
2024-08-18 06:26:08,669 [trainer.py] => Trainable params: 85856331
2024-08-18 06:26:08,670 [icarl.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.645, Train_accy 82.63, Test_accy 77.39:   0%|          | 0/20 [00:33<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.645, Train_accy 82.63, Test_accy 77.39:   5%|▌         | 1/20 [00:33<10:36, 33.49s/it]
Task 6, Epoch 2/20 => Loss 1.945, Train_accy 90.97:   5%|▌         | 1/20 [00:55<10:36, 33.49s/it]                 
Task 6, Epoch 2/20 => Loss 1.945, Train_accy 90.97:  10%|█         | 2/20 [00:55<07:56, 26.48s/it]
Task 6, Epoch 3/20 => Loss 1.886, Train_accy 92.88:  10%|█         | 2/20 [01:16<07:56, 26.48s/it]
Task 6, Epoch 3/20 => Loss 1.886, Train_accy 92.88:  15%|█▌        | 3/20 [01:16<06:51, 24.22s/it]
Task 6, Epoch 4/20 => Loss 1.886, Train_accy 93.03:  15%|█▌        | 3/20 [01:38<06:51, 24.22s/it]
Task 6, Epoch 4/20 => Loss 1.886, Train_accy 93.03:  20%|██        | 4/20 [01:38<06:10, 23.16s/it]
Task 6, Epoch 5/20 => Loss 1.888, Train_accy 93.30:  20%|██        | 4/20 [01:59<06:10, 23.16s/it]
Task 6, Epoch 5/20 => Loss 1.888, Train_accy 93.30:  25%|██▌       | 5/20 [01:59<05:39, 22.61s/it]
Task 6, Epoch 6/20 => Loss 1.869, Train_accy 93.24, Test_accy 77.06:  25%|██▌       | 5/20 [02:33<05:39, 22.61s/it]
Task 6, Epoch 6/20 => Loss 1.869, Train_accy 93.24, Test_accy 77.06:  30%|███       | 6/20 [02:33<06:08, 26.29s/it]
Task 6, Epoch 7/20 => Loss 1.829, Train_accy 94.20:  30%|███       | 6/20 [02:54<06:08, 26.29s/it]                 
Task 6, Epoch 7/20 => Loss 1.829, Train_accy 94.20:  35%|███▌      | 7/20 [02:54<05:21, 24.76s/it]
Task 6, Epoch 8/20 => Loss 1.831, Train_accy 94.25:  35%|███▌      | 7/20 [03:16<05:21, 24.76s/it]
Task 6, Epoch 8/20 => Loss 1.831, Train_accy 94.25:  40%|████      | 8/20 [03:16<04:44, 23.73s/it]
Task 6, Epoch 9/20 => Loss 1.863, Train_accy 94.02:  40%|████      | 8/20 [03:37<04:44, 23.73s/it]
Task 6, Epoch 9/20 => Loss 1.863, Train_accy 94.02:  45%|████▌     | 9/20 [03:37<04:13, 23.06s/it]
Task 6, Epoch 10/20 => Loss 1.822, Train_accy 94.56:  45%|████▌     | 9/20 [03:59<04:13, 23.06s/it]
Task 6, Epoch 10/20 => Loss 1.822, Train_accy 94.56:  50%|█████     | 10/20 [03:59<03:46, 22.60s/it]
Task 6, Epoch 11/20 => Loss 1.867, Train_accy 93.93, Test_accy 77.95:  50%|█████     | 10/20 [04:33<03:46, 22.60s/it]
Task 6, Epoch 11/20 => Loss 1.867, Train_accy 93.93, Test_accy 77.95:  55%|█████▌    | 11/20 [04:33<03:53, 25.97s/it]
Task 6, Epoch 12/20 => Loss 1.832, Train_accy 94.70:  55%|█████▌    | 11/20 [04:54<03:53, 25.97s/it]                 
Task 6, Epoch 12/20 => Loss 1.832, Train_accy 94.70:  60%|██████    | 12/20 [04:54<03:16, 24.61s/it]
Task 6, Epoch 13/20 => Loss 1.825, Train_accy 94.79:  60%|██████    | 12/20 [05:16<03:16, 24.61s/it]
Task 6, Epoch 13/20 => Loss 1.825, Train_accy 94.79:  65%|██████▌   | 13/20 [05:16<02:45, 23.68s/it]
Task 6, Epoch 14/20 => Loss 1.814, Train_accy 94.65:  65%|██████▌   | 13/20 [05:37<02:45, 23.68s/it]
Task 6, Epoch 14/20 => Loss 1.814, Train_accy 94.65:  70%|███████   | 14/20 [05:37<02:18, 23.01s/it]
Task 6, Epoch 15/20 => Loss 1.854, Train_accy 94.11:  70%|███████   | 14/20 [05:59<02:18, 23.01s/it]
Task 6, Epoch 15/20 => Loss 1.854, Train_accy 94.11:  75%|███████▌  | 15/20 [05:59<01:52, 22.56s/it]
Task 6, Epoch 16/20 => Loss 1.868, Train_accy 94.18, Test_accy 78.01:  75%|███████▌  | 15/20 [06:32<01:52, 22.56s/it]
Task 6, Epoch 16/20 => Loss 1.868, Train_accy 94.18, Test_accy 78.01:  80%|████████  | 16/20 [06:32<01:43, 25.82s/it]
Task 6, Epoch 17/20 => Loss 1.817, Train_accy 95.37:  80%|████████  | 16/20 [06:54<01:43, 25.82s/it]                 
Task 6, Epoch 17/20 => Loss 1.817, Train_accy 95.37:  85%|████████▌ | 17/20 [06:54<01:13, 24.55s/it]
Task 6, Epoch 18/20 => Loss 1.801, Train_accy 95.06:  85%|████████▌ | 17/20 [07:15<01:13, 24.55s/it]
Task 6, Epoch 18/20 => Loss 1.801, Train_accy 95.06:  90%|█████████ | 18/20 [07:15<00:47, 23.63s/it]
Task 6, Epoch 19/20 => Loss 1.831, Train_accy 94.76:  90%|█████████ | 18/20 [07:37<00:47, 23.63s/it]
Task 6, Epoch 19/20 => Loss 1.831, Train_accy 94.76:  95%|█████████▌| 19/20 [07:37<00:23, 23.01s/it]
Task 6, Epoch 20/20 => Loss 1.793, Train_accy 95.64:  95%|█████████▌| 19/20 [07:58<00:23, 23.01s/it]
Task 6, Epoch 20/20 => Loss 1.793, Train_accy 95.64: 100%|██████████| 20/20 [07:58<00:00, 22.55s/it]
Task 6, Epoch 20/20 => Loss 1.793, Train_accy 95.64: 100%|██████████| 20/20 [07:58<00:00, 23.93s/it]
2024-08-18 06:34:07,341 [icarl.py] => Task 6, Epoch 20/20 => Loss 1.793, Train_accy 95.64
2024-08-18 06:34:07,341 [base.py] => Reducing exemplars...(25 per classes)
2024-08-18 06:34:21,521 [base.py] => Constructing exemplars...(25 per classes)
2024-08-18 06:34:51,155 [icarl.py] => Exemplar size: 2000
2024-08-18 06:34:51,156 [trainer.py] => CNN: {'total': 77.28, '00-49': 75.62, '50-54': 64.2, '55-59': 58.6, '60-64': 78.0, '65-69': 92.0, '70-74': 88.8, '75-79': 98.6, 'old': 75.85, 'new': 98.6}
2024-08-18 06:34:51,156 [trainer.py] => NME: {'total': 85.78, '00-49': 86.5, '50-54': 77.2, '55-59': 73.4, '60-64': 79.8, '65-69': 94.8, '70-74': 89.0, '75-79': 93.2, 'old': 85.28, 'new': 93.2}
2024-08-18 06:34:51,156 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23, 84.4, 80.61, 77.28]
2024-08-18 06:34:51,156 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86, 97.17, 95.69, 94.56]
2024-08-18 06:34:51,156 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48, 89.17, 87.72, 85.78]
2024-08-18 06:34:51,156 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92, 98.59, 98.03, 97.72]

Average Accuracy (CNN): 85.66
Average Accuracy (NME): 89.92
2024-08-18 06:34:51,156 [trainer.py] => Average Accuracy (CNN): 85.66
2024-08-18 06:34:51,156 [trainer.py] => Average Accuracy (NME): 89.92
2024-08-18 06:34:51,156 [trainer.py] => Train Time: 0
2024-08-18 06:34:51,156 [trainer.py] => Test Time: 136.11 

2024-08-18 06:34:51,157 [trainer.py] => All params: 85860176
2024-08-18 06:34:51,157 [trainer.py] => Trainable params: 85860176
2024-08-18 06:34:51,158 [icarl.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.554, Train_accy 86.44, Test_accy 74.99:   0%|          | 0/20 [00:34<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.554, Train_accy 86.44, Test_accy 74.99:   5%|▌         | 1/20 [00:34<10:53, 34.42s/it]
Task 7, Epoch 2/20 => Loss 2.108, Train_accy 93.04:   5%|▌         | 1/20 [00:56<10:53, 34.42s/it]                 
Task 7, Epoch 2/20 => Loss 2.108, Train_accy 93.04:  10%|█         | 2/20 [00:56<08:05, 26.97s/it]
Task 7, Epoch 3/20 => Loss 2.084, Train_accy 93.44:  10%|█         | 2/20 [01:17<08:05, 26.97s/it]
Task 7, Epoch 3/20 => Loss 2.084, Train_accy 93.44:  15%|█▌        | 3/20 [01:17<06:58, 24.60s/it]
Task 7, Epoch 4/20 => Loss 2.020, Train_accy 94.93:  15%|█▌        | 3/20 [01:39<06:58, 24.60s/it]
Task 7, Epoch 4/20 => Loss 2.020, Train_accy 94.93:  20%|██        | 4/20 [01:39<06:15, 23.47s/it]
Task 7, Epoch 5/20 => Loss 2.056, Train_accy 93.93:  20%|██        | 4/20 [02:01<06:15, 23.47s/it]
Task 7, Epoch 5/20 => Loss 2.056, Train_accy 93.93:  25%|██▌       | 5/20 [02:01<05:43, 22.87s/it]
Task 7, Epoch 6/20 => Loss 2.012, Train_accy 94.89, Test_accy 73.86:  25%|██▌       | 5/20 [02:35<05:43, 22.87s/it]
Task 7, Epoch 6/20 => Loss 2.012, Train_accy 94.89, Test_accy 73.86:  30%|███       | 6/20 [02:35<06:14, 26.76s/it]
Task 7, Epoch 7/20 => Loss 2.030, Train_accy 94.71:  30%|███       | 6/20 [02:57<06:14, 26.76s/it]                 
Task 7, Epoch 7/20 => Loss 2.030, Train_accy 94.71:  35%|███▌      | 7/20 [02:57<05:26, 25.12s/it]
Task 7, Epoch 8/20 => Loss 2.007, Train_accy 95.31:  35%|███▌      | 7/20 [03:19<05:26, 25.12s/it]
Task 7, Epoch 8/20 => Loss 2.007, Train_accy 95.31:  40%|████      | 8/20 [03:19<04:48, 24.05s/it]
Task 7, Epoch 9/20 => Loss 2.020, Train_accy 95.16:  40%|████      | 8/20 [03:41<04:48, 24.05s/it]
Task 7, Epoch 9/20 => Loss 2.020, Train_accy 95.16:  45%|████▌     | 9/20 [03:41<04:16, 23.33s/it]
Task 7, Epoch 10/20 => Loss 2.012, Train_accy 95.38:  45%|████▌     | 9/20 [04:02<04:16, 23.33s/it]
Task 7, Epoch 10/20 => Loss 2.012, Train_accy 95.38:  50%|█████     | 10/20 [04:02<03:48, 22.84s/it]
Task 7, Epoch 11/20 => Loss 2.021, Train_accy 95.18, Test_accy 74.76:  50%|█████     | 10/20 [04:37<03:48, 22.84s/it]
Task 7, Epoch 11/20 => Loss 2.021, Train_accy 95.18, Test_accy 74.76:  55%|█████▌    | 11/20 [04:37<03:57, 26.39s/it]
Task 7, Epoch 12/20 => Loss 2.061, Train_accy 94.82:  55%|█████▌    | 11/20 [04:59<03:57, 26.39s/it]                 
Task 7, Epoch 12/20 => Loss 2.061, Train_accy 94.82:  60%|██████    | 12/20 [04:59<03:19, 24.98s/it]
Task 7, Epoch 13/20 => Loss 2.000, Train_accy 95.47:  60%|██████    | 12/20 [05:20<03:19, 24.98s/it]
Task 7, Epoch 13/20 => Loss 2.000, Train_accy 95.47:  65%|██████▌   | 13/20 [05:20<02:48, 24.00s/it]
Task 7, Epoch 14/20 => Loss 2.010, Train_accy 95.53:  65%|██████▌   | 13/20 [05:42<02:48, 24.00s/it]
Task 7, Epoch 14/20 => Loss 2.010, Train_accy 95.53:  70%|███████   | 14/20 [05:42<02:20, 23.34s/it]
Task 7, Epoch 15/20 => Loss 2.034, Train_accy 95.29:  70%|███████   | 14/20 [06:04<02:20, 23.34s/it]
Task 7, Epoch 15/20 => Loss 2.034, Train_accy 95.29:  75%|███████▌  | 15/20 [06:04<01:54, 22.87s/it]
Task 7, Epoch 16/20 => Loss 2.008, Train_accy 95.62, Test_accy 73.84:  75%|███████▌  | 15/20 [06:38<01:54, 22.87s/it]
Task 7, Epoch 16/20 => Loss 2.008, Train_accy 95.62, Test_accy 73.84:  80%|████████  | 16/20 [06:38<01:45, 26.33s/it]
Task 7, Epoch 17/20 => Loss 1.999, Train_accy 95.73:  80%|████████  | 16/20 [07:00<01:45, 26.33s/it]                 
Task 7, Epoch 17/20 => Loss 1.999, Train_accy 95.73:  85%|████████▌ | 17/20 [07:00<01:14, 24.95s/it]
Task 7, Epoch 18/20 => Loss 2.010, Train_accy 95.56:  85%|████████▌ | 17/20 [07:22<01:14, 24.95s/it]
Task 7, Epoch 18/20 => Loss 2.010, Train_accy 95.56:  90%|█████████ | 18/20 [07:22<00:47, 23.99s/it]
Task 7, Epoch 19/20 => Loss 2.002, Train_accy 95.89:  90%|█████████ | 18/20 [07:43<00:47, 23.99s/it]
Task 7, Epoch 19/20 => Loss 2.002, Train_accy 95.89:  95%|█████████▌| 19/20 [07:43<00:23, 23.32s/it]
Task 7, Epoch 20/20 => Loss 1.995, Train_accy 95.78:  95%|█████████▌| 19/20 [08:05<00:23, 23.32s/it]
Task 7, Epoch 20/20 => Loss 1.995, Train_accy 95.78: 100%|██████████| 20/20 [08:05<00:00, 22.88s/it]
Task 7, Epoch 20/20 => Loss 1.995, Train_accy 95.78: 100%|██████████| 20/20 [08:05<00:00, 24.29s/it]
2024-08-18 06:42:57,024 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.995, Train_accy 95.78
2024-08-18 06:42:57,025 [base.py] => Reducing exemplars...(23 per classes)
2024-08-18 06:43:11,700 [base.py] => Constructing exemplars...(23 per classes)
2024-08-18 06:43:42,991 [icarl.py] => Exemplar size: 1955
2024-08-18 06:43:42,991 [trainer.py] => CNN: {'total': 74.47, '00-49': 70.68, '50-54': 67.6, '55-59': 55.4, '60-64': 64.4, '65-69': 91.2, '70-74': 85.4, '75-79': 96.6, '80-84': 98.6, 'old': 72.96, 'new': 98.6}
2024-08-18 06:43:42,991 [trainer.py] => NME: {'total': 84.16, '00-49': 84.04, '50-54': 77.2, '55-59': 72.4, '60-64': 75.6, '65-69': 94.0, '70-74': 89.0, '75-79': 90.4, '80-84': 91.8, 'old': 83.69, 'new': 91.8}
2024-08-18 06:43:42,991 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23, 84.4, 80.61, 77.28, 74.47]
2024-08-18 06:43:42,991 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86, 97.17, 95.69, 94.56, 93.58]
2024-08-18 06:43:42,991 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48, 89.17, 87.72, 85.78, 84.16]
2024-08-18 06:43:42,991 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92, 98.59, 98.03, 97.72, 97.19]

Average Accuracy (CNN): 84.26
Average Accuracy (NME): 89.2
2024-08-18 06:43:42,991 [trainer.py] => Average Accuracy (CNN): 84.26
2024-08-18 06:43:42,991 [trainer.py] => Average Accuracy (NME): 89.2
2024-08-18 06:43:42,991 [trainer.py] => Train Time: 0
2024-08-18 06:43:42,991 [trainer.py] => Test Time: 161.51000000000002 

2024-08-18 06:43:42,992 [trainer.py] => All params: 85864021
2024-08-18 06:43:42,992 [trainer.py] => Trainable params: 85864021
2024-08-18 06:43:42,993 [icarl.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.992, Train_accy 80.79, Test_accy 72.00:   0%|          | 0/20 [00:34<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.992, Train_accy 80.79, Test_accy 72.00:   5%|▌         | 1/20 [00:34<11:01, 34.84s/it]
Task 8, Epoch 2/20 => Loss 2.299, Train_accy 90.44:   5%|▌         | 1/20 [00:56<11:01, 34.84s/it]                 
Task 8, Epoch 2/20 => Loss 2.299, Train_accy 90.44:  10%|█         | 2/20 [00:56<08:07, 27.06s/it]
Task 8, Epoch 3/20 => Loss 2.257, Train_accy 91.69:  10%|█         | 2/20 [01:18<08:07, 27.06s/it]
Task 8, Epoch 3/20 => Loss 2.257, Train_accy 91.69:  15%|█▌        | 3/20 [01:18<06:59, 24.70s/it]
Task 8, Epoch 4/20 => Loss 2.258, Train_accy 92.08:  15%|█▌        | 3/20 [01:39<06:59, 24.70s/it]
Task 8, Epoch 4/20 => Loss 2.258, Train_accy 92.08:  20%|██        | 4/20 [01:39<06:15, 23.45s/it]
Task 8, Epoch 5/20 => Loss 2.234, Train_accy 92.62:  20%|██        | 4/20 [02:01<06:15, 23.45s/it]
Task 8, Epoch 5/20 => Loss 2.234, Train_accy 92.62:  25%|██▌       | 5/20 [02:01<05:41, 22.78s/it]
Task 8, Epoch 6/20 => Loss 2.239, Train_accy 92.03, Test_accy 72.69:  25%|██▌       | 5/20 [02:36<05:41, 22.78s/it]
Task 8, Epoch 6/20 => Loss 2.239, Train_accy 92.03, Test_accy 72.69:  30%|███       | 6/20 [02:36<06:15, 26.85s/it]
Task 8, Epoch 7/20 => Loss 2.225, Train_accy 93.36:  30%|███       | 6/20 [02:57<06:15, 26.85s/it]                 
Task 8, Epoch 7/20 => Loss 2.225, Train_accy 93.36:  35%|███▌      | 7/20 [02:57<05:26, 25.10s/it]
Task 8, Epoch 8/20 => Loss 2.181, Train_accy 93.71:  35%|███▌      | 7/20 [03:19<05:26, 25.10s/it]
Task 8, Epoch 8/20 => Loss 2.181, Train_accy 93.71:  40%|████      | 8/20 [03:19<04:47, 23.97s/it]
Task 8, Epoch 9/20 => Loss 2.227, Train_accy 92.93:  40%|████      | 8/20 [03:40<04:47, 23.97s/it]
Task 8, Epoch 9/20 => Loss 2.227, Train_accy 92.93:  45%|████▌     | 9/20 [03:40<04:14, 23.18s/it]
Task 8, Epoch 10/20 => Loss 2.210, Train_accy 93.74:  45%|████▌     | 9/20 [04:02<04:14, 23.18s/it]
Task 8, Epoch 10/20 => Loss 2.210, Train_accy 93.74:  50%|█████     | 10/20 [04:02<03:46, 22.65s/it]
Task 8, Epoch 11/20 => Loss 2.212, Train_accy 93.67, Test_accy 73.10:  50%|█████     | 10/20 [04:37<03:46, 22.65s/it]
Task 8, Epoch 11/20 => Loss 2.212, Train_accy 93.67, Test_accy 73.10:  55%|█████▌    | 11/20 [04:37<03:58, 26.45s/it]
Task 8, Epoch 12/20 => Loss 2.200, Train_accy 93.71:  55%|█████▌    | 11/20 [04:58<03:58, 26.45s/it]                 
Task 8, Epoch 12/20 => Loss 2.200, Train_accy 93.71:  60%|██████    | 12/20 [04:58<03:19, 24.96s/it]
Task 8, Epoch 13/20 => Loss 2.161, Train_accy 94.32:  60%|██████    | 12/20 [05:20<03:19, 24.96s/it]
Task 8, Epoch 13/20 => Loss 2.161, Train_accy 94.32:  65%|██████▌   | 13/20 [05:20<02:47, 23.94s/it]
Task 8, Epoch 14/20 => Loss 2.166, Train_accy 94.07:  65%|██████▌   | 13/20 [05:41<02:47, 23.94s/it]
Task 8, Epoch 14/20 => Loss 2.166, Train_accy 94.07:  70%|███████   | 14/20 [05:41<02:19, 23.20s/it]
Task 8, Epoch 15/20 => Loss 2.201, Train_accy 94.10:  70%|███████   | 14/20 [06:03<02:19, 23.20s/it]
Task 8, Epoch 15/20 => Loss 2.201, Train_accy 94.10:  75%|███████▌  | 15/20 [06:03<01:53, 22.74s/it]
Task 8, Epoch 16/20 => Loss 2.177, Train_accy 93.98, Test_accy 73.40:  75%|███████▌  | 15/20 [06:38<01:53, 22.74s/it]
Task 8, Epoch 16/20 => Loss 2.177, Train_accy 93.98, Test_accy 73.40:  80%|████████  | 16/20 [06:38<01:45, 26.43s/it]
Task 8, Epoch 17/20 => Loss 2.212, Train_accy 93.85:  80%|████████  | 16/20 [07:00<01:45, 26.43s/it]                 
Task 8, Epoch 17/20 => Loss 2.212, Train_accy 93.85:  85%|████████▌ | 17/20 [07:00<01:14, 24.95s/it]
Task 8, Epoch 18/20 => Loss 2.164, Train_accy 94.39:  85%|████████▌ | 17/20 [07:21<01:14, 24.95s/it]
Task 8, Epoch 18/20 => Loss 2.164, Train_accy 94.39:  90%|█████████ | 18/20 [07:21<00:47, 23.91s/it]
Task 8, Epoch 19/20 => Loss 2.172, Train_accy 94.23:  90%|█████████ | 18/20 [07:43<00:47, 23.91s/it]
Task 8, Epoch 19/20 => Loss 2.172, Train_accy 94.23:  95%|█████████▌| 19/20 [07:43<00:23, 23.18s/it]
Task 8, Epoch 20/20 => Loss 2.165, Train_accy 94.59:  95%|█████████▌| 19/20 [08:04<00:23, 23.18s/it]
Task 8, Epoch 20/20 => Loss 2.165, Train_accy 94.59: 100%|██████████| 20/20 [08:04<00:00, 22.68s/it]
Task 8, Epoch 20/20 => Loss 2.165, Train_accy 94.59: 100%|██████████| 20/20 [08:04<00:00, 24.23s/it]
2024-08-18 06:51:47,573 [icarl.py] => Task 8, Epoch 20/20 => Loss 2.165, Train_accy 94.59
2024-08-18 06:51:47,574 [base.py] => Reducing exemplars...(22 per classes)
2024-08-18 06:52:02,803 [base.py] => Constructing exemplars...(22 per classes)
2024-08-18 06:52:35,380 [icarl.py] => Exemplar size: 1980
2024-08-18 06:52:35,380 [trainer.py] => CNN: {'total': 72.53, '00-49': 67.98, '50-54': 63.4, '55-59': 50.8, '60-64': 66.2, '65-69': 89.6, '70-74': 78.0, '75-79': 86.4, '80-84': 96.2, '85-89': 95.2, 'old': 71.2, 'new': 95.2}
2024-08-18 06:52:35,380 [trainer.py] => NME: {'total': 82.37, '00-49': 81.9, '50-54': 75.0, '55-59': 67.6, '60-64': 76.2, '65-69': 93.4, '70-74': 85.4, '75-79': 85.2, '80-84': 91.8, '85-89': 89.0, 'old': 81.98, 'new': 89.0}
2024-08-18 06:52:35,380 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23, 84.4, 80.61, 77.28, 74.47, 72.53]
2024-08-18 06:52:35,380 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86, 97.17, 95.69, 94.56, 93.58, 91.43]
2024-08-18 06:52:35,380 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48, 89.17, 87.72, 85.78, 84.16, 82.37]
2024-08-18 06:52:35,380 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92, 98.59, 98.03, 97.72, 97.19, 96.82]

Average Accuracy (CNN): 82.96
Average Accuracy (NME): 88.44
2024-08-18 06:52:35,380 [trainer.py] => Average Accuracy (CNN): 82.96
2024-08-18 06:52:35,381 [trainer.py] => Average Accuracy (NME): 88.44
2024-08-18 06:52:35,381 [trainer.py] => Train Time: 0
2024-08-18 06:52:35,381 [trainer.py] => Test Time: 188.29000000000002 

2024-08-18 06:52:35,381 [trainer.py] => All params: 85867866
2024-08-18 06:52:35,381 [trainer.py] => Trainable params: 85867866
2024-08-18 06:52:35,383 [icarl.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.855, Train_accy 83.28, Test_accy 71.84:   0%|          | 0/20 [00:35<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.855, Train_accy 83.28, Test_accy 71.84:   5%|▌         | 1/20 [00:35<11:17, 35.67s/it]
Task 9, Epoch 2/20 => Loss 2.097, Train_accy 92.90:   5%|▌         | 1/20 [00:57<11:17, 35.67s/it]                 
Task 9, Epoch 2/20 => Loss 2.097, Train_accy 92.90:  10%|█         | 2/20 [00:57<08:14, 27.50s/it]
Task 9, Epoch 3/20 => Loss 2.053, Train_accy 93.88:  10%|█         | 2/20 [01:19<08:14, 27.50s/it]
Task 9, Epoch 3/20 => Loss 2.053, Train_accy 93.88:  15%|█▌        | 3/20 [01:19<07:02, 24.83s/it]
Task 9, Epoch 4/20 => Loss 2.033, Train_accy 94.29:  15%|█▌        | 3/20 [01:40<07:02, 24.83s/it]
Task 9, Epoch 4/20 => Loss 2.033, Train_accy 94.29:  20%|██        | 4/20 [01:40<06:17, 23.61s/it]
Task 9, Epoch 5/20 => Loss 1.978, Train_accy 94.84:  20%|██        | 4/20 [02:02<06:17, 23.61s/it]
Task 9, Epoch 5/20 => Loss 1.978, Train_accy 94.84:  25%|██▌       | 5/20 [02:02<05:43, 22.91s/it]
Task 9, Epoch 6/20 => Loss 2.029, Train_accy 94.67, Test_accy 73.55:  25%|██▌       | 5/20 [02:38<05:43, 22.91s/it]
Task 9, Epoch 6/20 => Loss 2.029, Train_accy 94.67, Test_accy 73.55:  30%|███       | 6/20 [02:38<06:21, 27.26s/it]
Task 9, Epoch 7/20 => Loss 1.999, Train_accy 95.02:  30%|███       | 6/20 [02:59<06:21, 27.26s/it]                 
Task 9, Epoch 7/20 => Loss 1.999, Train_accy 95.02:  35%|███▌      | 7/20 [02:59<05:30, 25.43s/it]
Task 9, Epoch 8/20 => Loss 1.976, Train_accy 95.02:  35%|███▌      | 7/20 [03:21<05:30, 25.43s/it]
Task 9, Epoch 8/20 => Loss 1.976, Train_accy 95.02:  40%|████      | 8/20 [03:21<04:50, 24.23s/it]
Task 9, Epoch 9/20 => Loss 2.023, Train_accy 94.44:  40%|████      | 8/20 [03:43<04:50, 24.23s/it]
Task 9, Epoch 9/20 => Loss 2.023, Train_accy 94.44:  45%|████▌     | 9/20 [03:43<04:17, 23.44s/it]
Task 9, Epoch 10/20 => Loss 2.002, Train_accy 95.45:  45%|████▌     | 9/20 [04:04<04:17, 23.44s/it]
Task 9, Epoch 10/20 => Loss 2.002, Train_accy 95.45:  50%|█████     | 10/20 [04:04<03:48, 22.87s/it]
Task 9, Epoch 11/20 => Loss 1.999, Train_accy 95.25, Test_accy 71.76:  50%|█████     | 10/20 [04:40<03:48, 22.87s/it]
Task 9, Epoch 11/20 => Loss 1.999, Train_accy 95.25, Test_accy 71.76:  55%|█████▌    | 11/20 [04:40<04:01, 26.80s/it]
Task 9, Epoch 12/20 => Loss 1.988, Train_accy 95.40:  55%|█████▌    | 11/20 [05:02<04:01, 26.80s/it]                 
Task 9, Epoch 12/20 => Loss 1.988, Train_accy 95.40:  60%|██████    | 12/20 [05:02<03:21, 25.22s/it]
Task 9, Epoch 13/20 => Loss 2.013, Train_accy 95.00:  60%|██████    | 12/20 [05:23<03:21, 25.22s/it]
Task 9, Epoch 13/20 => Loss 2.013, Train_accy 95.00:  65%|██████▌   | 13/20 [05:23<02:49, 24.15s/it]
Task 9, Epoch 14/20 => Loss 1.986, Train_accy 95.33:  65%|██████▌   | 13/20 [05:45<02:49, 24.15s/it]
Task 9, Epoch 14/20 => Loss 1.986, Train_accy 95.33:  70%|███████   | 14/20 [05:45<02:20, 23.43s/it]
Task 9, Epoch 15/20 => Loss 2.030, Train_accy 94.73:  70%|███████   | 14/20 [06:07<02:20, 23.43s/it]
Task 9, Epoch 15/20 => Loss 2.030, Train_accy 94.73:  75%|███████▌  | 15/20 [06:07<01:54, 22.88s/it]
Task 9, Epoch 16/20 => Loss 1.964, Train_accy 96.00, Test_accy 72.18:  75%|███████▌  | 15/20 [06:43<01:54, 22.88s/it]
Task 9, Epoch 16/20 => Loss 1.964, Train_accy 96.00, Test_accy 72.18:  80%|████████  | 16/20 [06:43<01:47, 26.78s/it]
Task 9, Epoch 17/20 => Loss 2.000, Train_accy 95.18:  80%|████████  | 16/20 [07:04<01:47, 26.78s/it]                 
Task 9, Epoch 17/20 => Loss 2.000, Train_accy 95.18:  85%|████████▌ | 17/20 [07:04<01:15, 25.24s/it]
Task 9, Epoch 18/20 => Loss 2.005, Train_accy 95.11:  85%|████████▌ | 17/20 [07:26<01:15, 25.24s/it]
Task 9, Epoch 18/20 => Loss 2.005, Train_accy 95.11:  90%|█████████ | 18/20 [07:26<00:48, 24.18s/it]
Task 9, Epoch 19/20 => Loss 1.986, Train_accy 95.58:  90%|█████████ | 18/20 [07:48<00:48, 24.18s/it]
Task 9, Epoch 19/20 => Loss 1.986, Train_accy 95.58:  95%|█████████▌| 19/20 [07:48<00:23, 23.44s/it]
Task 9, Epoch 20/20 => Loss 1.947, Train_accy 95.49:  95%|█████████▌| 19/20 [08:09<00:23, 23.44s/it]
Task 9, Epoch 20/20 => Loss 1.947, Train_accy 95.49: 100%|██████████| 20/20 [08:09<00:00, 22.92s/it]
Task 9, Epoch 20/20 => Loss 1.947, Train_accy 95.49: 100%|██████████| 20/20 [08:09<00:00, 24.49s/it]
2024-08-18 07:00:45,274 [icarl.py] => Task 9, Epoch 20/20 => Loss 1.947, Train_accy 95.49
2024-08-18 07:00:45,275 [base.py] => Reducing exemplars...(21 per classes)
2024-08-18 07:01:01,034 [base.py] => Constructing exemplars...(21 per classes)
2024-08-18 07:01:35,159 [icarl.py] => Exemplar size: 1995
2024-08-18 07:01:35,159 [trainer.py] => CNN: {'total': 72.03, '00-49': 67.04, '50-54': 60.2, '55-59': 51.6, '60-64': 62.4, '65-69': 89.6, '70-74': 78.6, '75-79': 77.0, '80-84': 91.2, '85-89': 89.6, '90-94': 98.0, 'old': 70.59, 'new': 98.0}
2024-08-18 07:01:35,159 [trainer.py] => NME: {'total': 81.94, '00-49': 80.62, '50-54': 73.6, '55-59': 70.0, '60-64': 76.2, '65-69': 94.0, '70-74': 83.0, '75-79': 81.2, '80-84': 90.2, '85-89': 87.6, '90-94': 94.8, 'old': 81.22, 'new': 94.8}
2024-08-18 07:01:35,159 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23, 84.4, 80.61, 77.28, 74.47, 72.53, 72.03]
2024-08-18 07:01:35,159 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86, 97.17, 95.69, 94.56, 93.58, 91.43, 89.42]
2024-08-18 07:01:35,159 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48, 89.17, 87.72, 85.78, 84.16, 82.37, 81.94]
2024-08-18 07:01:35,159 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92, 98.59, 98.03, 97.72, 97.19, 96.82, 96.27]

Average Accuracy (CNN): 81.87
Average Accuracy (NME): 87.79
2024-08-18 07:01:35,159 [trainer.py] => Average Accuracy (CNN): 81.87
2024-08-18 07:01:35,160 [trainer.py] => Average Accuracy (NME): 87.79
2024-08-18 07:01:35,160 [trainer.py] => Train Time: 0
2024-08-18 07:01:35,160 [trainer.py] => Test Time: 216.45000000000002 

2024-08-18 07:01:35,160 [trainer.py] => All params: 85871711
2024-08-18 07:01:35,160 [trainer.py] => Trainable params: 85871711
2024-08-18 07:01:35,161 [icarl.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 3.016, Train_accy 81.89, Test_accy 65.62:   0%|          | 0/20 [00:36<?, ?it/s]
Task 10, Epoch 1/20 => Loss 3.016, Train_accy 81.89, Test_accy 65.62:   5%|▌         | 1/20 [00:36<11:37, 36.69s/it]
Task 10, Epoch 2/20 => Loss 2.263, Train_accy 92.19:   5%|▌         | 1/20 [00:58<11:37, 36.69s/it]                 
Task 10, Epoch 2/20 => Loss 2.263, Train_accy 92.19:  10%|█         | 2/20 [00:58<08:21, 27.88s/it]
Task 10, Epoch 3/20 => Loss 2.257, Train_accy 92.73:  10%|█         | 2/20 [01:20<08:21, 27.88s/it]
Task 10, Epoch 3/20 => Loss 2.257, Train_accy 92.73:  15%|█▌        | 3/20 [01:20<07:05, 25.05s/it]
Task 10, Epoch 4/20 => Loss 2.244, Train_accy 92.93:  15%|█▌        | 3/20 [01:41<07:05, 25.05s/it]
Task 10, Epoch 4/20 => Loss 2.244, Train_accy 92.93:  20%|██        | 4/20 [01:41<06:19, 23.73s/it]
Task 10, Epoch 5/20 => Loss 2.189, Train_accy 93.77:  20%|██        | 4/20 [02:03<06:19, 23.73s/it]
Task 10, Epoch 5/20 => Loss 2.189, Train_accy 93.77:  25%|██▌       | 5/20 [02:03<05:44, 22.99s/it]
Task 10, Epoch 6/20 => Loss 2.205, Train_accy 93.90, Test_accy 68.95:  25%|██▌       | 5/20 [02:39<05:44, 22.99s/it]
Task 10, Epoch 6/20 => Loss 2.205, Train_accy 93.90, Test_accy 68.95:  30%|███       | 6/20 [02:39<06:26, 27.59s/it]
Task 10, Epoch 7/20 => Loss 2.245, Train_accy 93.53:  30%|███       | 6/20 [03:01<06:26, 27.59s/it]                 
Task 10, Epoch 7/20 => Loss 2.245, Train_accy 93.53:  35%|███▌      | 7/20 [03:01<05:33, 25.69s/it]
Task 10, Epoch 8/20 => Loss 2.251, Train_accy 93.48:  35%|███▌      | 7/20 [03:23<05:33, 25.69s/it]
Task 10, Epoch 8/20 => Loss 2.251, Train_accy 93.48:  40%|████      | 8/20 [03:23<04:53, 24.43s/it]
Task 10, Epoch 9/20 => Loss 2.190, Train_accy 94.24:  40%|████      | 8/20 [03:45<04:53, 24.43s/it]
Task 10, Epoch 9/20 => Loss 2.190, Train_accy 94.24:  45%|████▌     | 9/20 [03:45<04:19, 23.56s/it]
Task 10, Epoch 10/20 => Loss 2.203, Train_accy 94.64:  45%|████▌     | 9/20 [04:06<04:19, 23.56s/it]
Task 10, Epoch 10/20 => Loss 2.203, Train_accy 94.64:  50%|█████     | 10/20 [04:06<03:49, 22.98s/it]
Task 10, Epoch 11/20 => Loss 2.161, Train_accy 94.75, Test_accy 69.78:  50%|█████     | 10/20 [04:43<03:49, 22.98s/it]
Task 10, Epoch 11/20 => Loss 2.161, Train_accy 94.75, Test_accy 69.78:  55%|█████▌    | 11/20 [04:43<04:03, 27.10s/it]
Task 10, Epoch 12/20 => Loss 2.173, Train_accy 94.53:  55%|█████▌    | 11/20 [05:04<04:03, 27.10s/it]                 
Task 10, Epoch 12/20 => Loss 2.173, Train_accy 94.53:  60%|██████    | 12/20 [05:04<03:23, 25.44s/it]
Task 10, Epoch 13/20 => Loss 2.164, Train_accy 94.53:  60%|██████    | 12/20 [05:26<03:23, 25.44s/it]
Task 10, Epoch 13/20 => Loss 2.164, Train_accy 94.53:  65%|██████▌   | 13/20 [05:26<02:50, 24.30s/it]
Task 10, Epoch 14/20 => Loss 2.199, Train_accy 94.97:  65%|██████▌   | 13/20 [05:48<02:50, 24.30s/it]
Task 10, Epoch 14/20 => Loss 2.199, Train_accy 94.97:  70%|███████   | 14/20 [05:48<02:21, 23.53s/it]
Task 10, Epoch 15/20 => Loss 2.168, Train_accy 95.19:  70%|███████   | 14/20 [06:10<02:21, 23.53s/it]
Task 10, Epoch 15/20 => Loss 2.168, Train_accy 95.19:  75%|███████▌  | 15/20 [06:10<01:54, 22.97s/it]
Task 10, Epoch 16/20 => Loss 2.188, Train_accy 94.44, Test_accy 68.83:  75%|███████▌  | 15/20 [06:46<01:54, 22.97s/it]
Task 10, Epoch 16/20 => Loss 2.188, Train_accy 94.44, Test_accy 68.83:  80%|████████  | 16/20 [06:46<01:48, 27.07s/it]
Task 10, Epoch 17/20 => Loss 2.152, Train_accy 95.06:  80%|████████  | 16/20 [07:08<01:48, 27.07s/it]                 
Task 10, Epoch 17/20 => Loss 2.152, Train_accy 95.06:  85%|████████▌ | 17/20 [07:08<01:16, 25.46s/it]
Task 10, Epoch 18/20 => Loss 2.167, Train_accy 94.97:  85%|████████▌ | 17/20 [07:30<01:16, 25.46s/it]
Task 10, Epoch 18/20 => Loss 2.167, Train_accy 94.97:  90%|█████████ | 18/20 [07:30<00:48, 24.33s/it]
Task 10, Epoch 19/20 => Loss 2.153, Train_accy 95.51:  90%|█████████ | 18/20 [07:51<00:48, 24.33s/it]
Task 10, Epoch 19/20 => Loss 2.153, Train_accy 95.51:  95%|█████████▌| 19/20 [07:51<00:23, 23.55s/it]
Task 10, Epoch 20/20 => Loss 2.181, Train_accy 94.71:  95%|█████████▌| 19/20 [08:13<00:23, 23.55s/it]
Task 10, Epoch 20/20 => Loss 2.181, Train_accy 94.71: 100%|██████████| 20/20 [08:13<00:00, 23.03s/it]
Task 10, Epoch 20/20 => Loss 2.181, Train_accy 94.71: 100%|██████████| 20/20 [08:13<00:00, 24.68s/it]
2024-08-18 07:09:48,767 [icarl.py] => Task 10, Epoch 20/20 => Loss 2.181, Train_accy 94.71
2024-08-18 07:09:48,768 [base.py] => Reducing exemplars...(20 per classes)
2024-08-18 07:10:04,761 [base.py] => Constructing exemplars...(20 per classes)
2024-08-18 07:10:39,948 [icarl.py] => Exemplar size: 2000
2024-08-18 07:10:39,948 [trainer.py] => CNN: {'total': 68.66, '00-49': 62.32, '50-54': 56.2, '55-59': 51.8, '60-64': 62.8, '65-69': 78.4, '70-74': 74.4, '75-79': 71.8, '80-84': 86.8, '85-89': 82.2, '90-94': 89.4, '95-99': 96.2, 'old': 67.21, 'new': 96.2}
2024-08-18 07:10:39,948 [trainer.py] => NME: {'total': 79.82, '00-49': 77.92, '50-54': 69.4, '55-59': 69.0, '60-64': 74.2, '65-69': 90.0, '70-74': 82.6, '75-79': 76.6, '80-84': 89.0, '85-89': 84.8, '90-94': 90.0, '95-99': 91.6, 'old': 79.2, 'new': 91.6}
2024-08-18 07:10:39,949 [trainer.py] => CNN top1 curve: [92.64, 89.91, 88.58, 86.23, 84.4, 80.61, 77.28, 74.47, 72.53, 72.03, 68.66]
2024-08-18 07:10:39,949 [trainer.py] => CNN top5 curve: [99.16, 98.82, 98.45, 97.86, 97.17, 95.69, 94.56, 93.58, 91.43, 89.42, 87.32]
2024-08-18 07:10:39,949 [trainer.py] => NME top1 curve: [93.2, 91.85, 91.22, 90.48, 89.17, 87.72, 85.78, 84.16, 82.37, 81.94, 79.82]
2024-08-18 07:10:39,949 [trainer.py] => NME top5 curve: [99.18, 99.27, 99.23, 98.92, 98.59, 98.03, 97.72, 97.19, 96.82, 96.27, 94.73]

Average Accuracy (CNN): 80.67
Average Accuracy (NME): 87.06
2024-08-18 07:10:39,949 [trainer.py] => Average Accuracy (CNN): 80.67
2024-08-18 07:10:39,949 [trainer.py] => Average Accuracy (NME): 87.06
2024-08-18 07:10:39,949 [trainer.py] => Train Time: 0
2024-08-18 07:10:39,949 [trainer.py] => Test Time: 245.98000000000002 

Accuracy Matrix (CNN):
[[92.64 89.12 87.12 85.3  82.74 80.12 75.62 70.68 67.98 67.04 62.32]
 [ 0.   97.8  96.8  95.   90.   83.2  64.2  67.6  63.4  60.2  56.2 ]
 [ 0.    0.   95.   73.8  72.4  56.6  58.6  55.4  50.8  51.6  51.8 ]
 [ 0.    0.    0.   99.2  92.8  77.   78.   64.4  66.2  62.4  62.8 ]
 [ 0.    0.    0.    0.   99.   92.6  92.   91.2  89.6  89.6  78.4 ]
 [ 0.    0.    0.    0.    0.   98.6  88.8  85.4  78.   78.6  74.4 ]
 [ 0.    0.    0.    0.    0.    0.   98.6  96.6  86.4  77.   71.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.   98.6  96.2  91.2  86.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   95.2  89.6  82.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   98.   89.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   96.2 ]]
2024-08-18 07:10:39,950 [trainer.py] => Forgetting (CNN): 25.651999999999997
Accuracy Matrix (NME):
[[93.2  91.74 91.04 90.64 88.92 87.8  86.5  84.04 81.9  80.62 77.92]
 [ 0.   93.   91.6  92.2  90.2  88.8  77.2  77.2  75.   73.6  69.4 ]
 [ 0.    0.   92.6  82.6  82.6  77.   73.4  72.4  67.6  70.   69.  ]
 [ 0.    0.    0.   95.   89.2  82.   79.8  75.6  76.2  76.2  74.2 ]
 [ 0.    0.    0.    0.   97.2  95.4  94.8  94.   93.4  94.   90.  ]
 [ 0.    0.    0.    0.    0.   94.6  89.   89.   85.4  83.   82.6 ]
 [ 0.    0.    0.    0.    0.    0.   93.2  90.4  85.2  81.2  76.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.   91.8  91.8  90.2  89.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   89.   87.6  84.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   94.8  90.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   91.6 ]]
2024-08-18 07:10:39,950 [trainer.py] => Forgetting (NME): 13.088

nohup: 忽略输入
2024-09-04 08:01:55,175 [trainer.py] => config: ./exps/der_cifar_B0_Inc5.json
2024-09-04 08:01:55,185 [trainer.py] => prefix: reproduce
2024-09-04 08:01:55,185 [trainer.py] => dataset: cifar224
2024-09-04 08:01:55,186 [trainer.py] => memory_size: 2000
2024-09-04 08:01:55,186 [trainer.py] => memory_per_class: 20
2024-09-04 08:01:55,186 [trainer.py] => fixed_memory: False
2024-09-04 08:01:55,186 [trainer.py] => shuffle: True
2024-09-04 08:01:55,186 [trainer.py] => init_cls: 20
2024-09-04 08:01:55,186 [trainer.py] => increment: 20
2024-09-04 08:01:55,186 [trainer.py] => model_name: der
2024-09-04 08:01:55,186 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 08:01:55,186 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-04 08:01:55,186 [trainer.py] => seed: 1993
2024-09-04 08:01:55,186 [trainer.py] => init_epoch: 20
2024-09-04 08:01:55,186 [trainer.py] => init_lr: 0.001
2024-09-04 08:01:55,186 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 08:01:55,186 [trainer.py] => init_lr_decay: 0.1
2024-09-04 08:01:55,186 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 08:01:55,186 [trainer.py] => epochs: 20
2024-09-04 08:01:55,186 [trainer.py] => lrate: 0.001
2024-09-04 08:01:55,186 [trainer.py] => milestones: [80, 120, 150]
2024-09-04 08:01:55,186 [trainer.py] => lrate_decay: 0.1
2024-09-04 08:01:55,186 [trainer.py] => batch_size: 48
2024-09-04 08:01:55,186 [trainer.py] => weight_decay: 0.0002
2024-09-04 08:01:55,186 [trainer.py] => T: 2
2024-09-04 08:01:56,289 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 08:01:56,655 [trainer.py] => All params: 0
2024-09-04 08:01:56,655 [trainer.py] => Trainable params: 0
2024-09-04 08:01:58,237 [der.py] => Learning on 0-20
2024-09-04 08:01:58,237 [der.py] => All params: 85830185
2024-09-04 08:01:58,238 [der.py] => Trainable params: 85830185

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.317, Train_accy 30.68, Test_accy 87.15:   0%|          | 0/20 [01:20<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.317, Train_accy 30.68, Test_accy 87.15:   5%|▌         | 1/20 [01:20<25:28, 80.47s/it]
Task 0, Epoch 2/20 => Loss 0.731, Train_accy 78.05:   5%|▌         | 1/20 [02:36<25:28, 80.47s/it]                 
Task 0, Epoch 2/20 => Loss 0.731, Train_accy 78.05:  10%|█         | 2/20 [02:36<23:16, 77.57s/it]
Task 0, Epoch 3/20 => Loss 0.552, Train_accy 83.23:  10%|█         | 2/20 [03:52<23:16, 77.57s/it]
Task 0, Epoch 3/20 => Loss 0.552, Train_accy 83.23:  15%|█▌        | 3/20 [03:52<21:47, 76.89s/it]
Task 0, Epoch 4/20 => Loss 0.472, Train_accy 86.01:  15%|█▌        | 3/20 [05:08<21:47, 76.89s/it]
Task 0, Epoch 4/20 => Loss 0.472, Train_accy 86.01:  20%|██        | 4/20 [05:08<20:26, 76.66s/it]
Task 0, Epoch 5/20 => Loss 0.418, Train_accy 87.57:  20%|██        | 4/20 [06:24<20:26, 76.66s/it]
Task 0, Epoch 5/20 => Loss 0.418, Train_accy 87.57:  25%|██▌       | 5/20 [06:24<19:07, 76.51s/it]
Task 0, Epoch 6/20 => Loss 0.404, Train_accy 87.60, Test_accy 95.25:  25%|██▌       | 5/20 [07:47<19:07, 76.51s/it]
Task 0, Epoch 6/20 => Loss 0.404, Train_accy 87.60, Test_accy 95.25:  30%|███       | 6/20 [07:47<18:18, 78.50s/it]
Task 0, Epoch 7/20 => Loss 0.377, Train_accy 88.60:  30%|███       | 6/20 [09:03<18:18, 78.50s/it]                 
Task 0, Epoch 7/20 => Loss 0.377, Train_accy 88.60:  35%|███▌      | 7/20 [09:03<16:51, 77.80s/it]
Task 0, Epoch 8/20 => Loss 0.370, Train_accy 88.96:  35%|███▌      | 7/20 [10:19<16:51, 77.80s/it]
Task 0, Epoch 8/20 => Loss 0.370, Train_accy 88.96:  40%|████      | 8/20 [10:19<15:27, 77.32s/it]
Task 0, Epoch 9/20 => Loss 0.371, Train_accy 88.55:  40%|████      | 8/20 [11:35<15:27, 77.32s/it]
Task 0, Epoch 9/20 => Loss 0.371, Train_accy 88.55:  45%|████▌     | 9/20 [11:35<14:06, 76.97s/it]
Task 0, Epoch 10/20 => Loss 0.334, Train_accy 89.97:  45%|████▌     | 9/20 [12:52<14:06, 76.97s/it]
Task 0, Epoch 10/20 => Loss 0.334, Train_accy 89.97:  50%|█████     | 10/20 [12:52<12:47, 76.75s/it]
Task 0, Epoch 11/20 => Loss 0.317, Train_accy 90.42, Test_accy 95.65:  50%|█████     | 10/20 [14:14<12:47, 76.75s/it]
Task 0, Epoch 11/20 => Loss 0.317, Train_accy 90.42, Test_accy 95.65:  55%|█████▌    | 11/20 [14:14<11:45, 78.40s/it]
Task 0, Epoch 12/20 => Loss 0.321, Train_accy 90.08:  55%|█████▌    | 11/20 [15:30<11:45, 78.40s/it]                 
Task 0, Epoch 12/20 => Loss 0.321, Train_accy 90.08:  60%|██████    | 12/20 [15:30<10:22, 77.77s/it]
Task 0, Epoch 13/20 => Loss 0.295, Train_accy 90.88:  60%|██████    | 12/20 [16:46<10:22, 77.77s/it]
Task 0, Epoch 13/20 => Loss 0.295, Train_accy 90.88:  65%|██████▌   | 13/20 [16:46<09:01, 77.33s/it]
Task 0, Epoch 14/20 => Loss 0.300, Train_accy 91.01:  65%|██████▌   | 13/20 [18:03<09:01, 77.33s/it]
Task 0, Epoch 14/20 => Loss 0.300, Train_accy 91.01:  70%|███████   | 14/20 [18:03<07:41, 77.00s/it]
Task 0, Epoch 15/20 => Loss 0.280, Train_accy 91.62:  70%|███████   | 14/20 [19:19<07:41, 77.00s/it]
Task 0, Epoch 15/20 => Loss 0.280, Train_accy 91.62:  75%|███████▌  | 15/20 [19:19<06:23, 76.78s/it]
Task 0, Epoch 16/20 => Loss 0.306, Train_accy 90.29, Test_accy 96.35:  75%|███████▌  | 15/20 [20:41<06:23, 76.78s/it]
Task 0, Epoch 16/20 => Loss 0.306, Train_accy 90.29, Test_accy 96.35:  80%|████████  | 16/20 [20:41<05:13, 78.42s/it]
Task 0, Epoch 17/20 => Loss 0.291, Train_accy 91.30:  80%|████████  | 16/20 [21:58<05:13, 78.42s/it]                 
Task 0, Epoch 17/20 => Loss 0.291, Train_accy 91.30:  85%|████████▌ | 17/20 [21:58<03:53, 77.82s/it]
Task 0, Epoch 18/20 => Loss 0.292, Train_accy 91.39:  85%|████████▌ | 17/20 [23:14<03:53, 77.82s/it]
Task 0, Epoch 18/20 => Loss 0.292, Train_accy 91.39:  90%|█████████ | 18/20 [23:14<02:34, 77.43s/it]
Task 0, Epoch 19/20 => Loss 0.271, Train_accy 91.72:  90%|█████████ | 18/20 [24:30<02:34, 77.43s/it]
Task 0, Epoch 19/20 => Loss 0.271, Train_accy 91.72:  95%|█████████▌| 19/20 [24:30<01:17, 77.09s/it]
Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.63:  95%|█████████▌| 19/20 [25:47<01:17, 77.09s/it]
Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.63: 100%|██████████| 20/20 [25:47<00:00, 76.90s/it]
Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.63: 100%|██████████| 20/20 [25:47<00:00, 77.37s/it]
2024-09-04 08:27:46,144 [der.py] => Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.63
2024-09-04 08:27:46,146 [base.py] => Reducing exemplars...(100 per classes)
2024-09-04 08:27:46,147 [base.py] => Constructing exemplars...(100 per classes)
2024-09-04 08:28:44,849 [der.py] => Exemplar size: 2000
2024-09-04 08:28:44,850 [trainer.py] => CNN: {'total': 96.65, '00-19': 96.65, 'old': 0, 'new': 96.65}
2024-09-04 08:28:44,850 [trainer.py] => NME: {'total': 96.45, '00-19': 96.45, 'old': 0, 'new': 96.45}
2024-09-04 08:28:44,850 [trainer.py] => CNN top1 curve: [96.65]
2024-09-04 08:28:44,850 [trainer.py] => CNN top5 curve: [99.75]
2024-09-04 08:28:44,850 [trainer.py] => NME top1 curve: [96.45]
2024-09-04 08:28:44,850 [trainer.py] => NME top5 curve: [99.75]

Average Accuracy (CNN): 96.65
Average Accuracy (NME): 96.45
2024-09-04 08:28:44,850 [trainer.py] => Average Accuracy (CNN): 96.65
2024-09-04 08:28:44,850 [trainer.py] => Average Accuracy (NME): 96.45
2024-09-04 08:28:44,851 [trainer.py] => All params: 85830185
2024-09-04 08:28:44,851 [trainer.py] => Trainable params: 85830185
2024-09-04 08:28:46,376 [der.py] => Learning on 20-40
2024-09-04 08:28:46,377 [der.py] => All params: 171674941
2024-09-04 08:28:46,378 [der.py] => Trainable params: 85876285

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.688, Loss_clf 0.887, Loss_aux 0.801, Train_accy 76.44, Test_accy 92.05:   0%|          | 0/20 [02:25<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.688, Loss_clf 0.887, Loss_aux 0.801, Train_accy 76.44, Test_accy 92.05:   5%|▌         | 1/20 [02:25<46:05, 145.54s/it]
Task 1, Epoch 2/20 => Loss 1.025, Loss_clf 0.495, Loss_aux 0.529, Train_accy 84.81:   5%|▌         | 1/20 [04:29<46:05, 145.54s/it]                 
Task 1, Epoch 2/20 => Loss 1.025, Loss_clf 0.495, Loss_aux 0.529, Train_accy 84.81:  10%|█         | 2/20 [04:29<39:47, 132.64s/it]
Task 1, Epoch 3/20 => Loss 0.946, Loss_clf 0.460, Loss_aux 0.486, Train_accy 86.01:  10%|█         | 2/20 [06:32<39:47, 132.64s/it]
Task 1, Epoch 3/20 => Loss 0.946, Loss_clf 0.460, Loss_aux 0.486, Train_accy 86.01:  15%|█▌        | 3/20 [06:32<36:24, 128.52s/it]
Task 1, Epoch 4/20 => Loss 0.873, Loss_clf 0.427, Loss_aux 0.446, Train_accy 86.89:  15%|█▌        | 3/20 [08:36<36:24, 128.52s/it]
Task 1, Epoch 4/20 => Loss 0.873, Loss_clf 0.427, Loss_aux 0.446, Train_accy 86.89:  20%|██        | 4/20 [08:36<33:44, 126.52s/it]
Task 1, Epoch 5/20 => Loss 0.801, Loss_clf 0.391, Loss_aux 0.410, Train_accy 88.41:  20%|██        | 4/20 [10:39<33:44, 126.52s/it]
Task 1, Epoch 5/20 => Loss 0.801, Loss_clf 0.391, Loss_aux 0.410, Train_accy 88.41:  25%|██▌       | 5/20 [10:39<31:21, 125.42s/it]
Task 1, Epoch 6/20 => Loss 0.771, Loss_clf 0.378, Loss_aux 0.393, Train_accy 88.78, Test_accy 92.05:  25%|██▌       | 5/20 [13:05<31:21, 125.42s/it]
Task 1, Epoch 6/20 => Loss 0.771, Loss_clf 0.378, Loss_aux 0.393, Train_accy 88.78, Test_accy 92.05:  30%|███       | 6/20 [13:05<30:53, 132.39s/it]
Task 1, Epoch 7/20 => Loss 0.749, Loss_clf 0.369, Loss_aux 0.379, Train_accy 89.00:  30%|███       | 6/20 [15:09<30:53, 132.39s/it]                 
Task 1, Epoch 7/20 => Loss 0.749, Loss_clf 0.369, Loss_aux 0.379, Train_accy 89.00:  35%|███▌      | 7/20 [15:09<28:03, 129.50s/it]
Task 1, Epoch 8/20 => Loss 0.691, Loss_clf 0.342, Loss_aux 0.349, Train_accy 90.01:  35%|███▌      | 7/20 [17:12<28:03, 129.50s/it]
Task 1, Epoch 8/20 => Loss 0.691, Loss_clf 0.342, Loss_aux 0.349, Train_accy 90.01:  40%|████      | 8/20 [17:12<25:31, 127.63s/it]
Task 1, Epoch 9/20 => Loss 0.690, Loss_clf 0.340, Loss_aux 0.350, Train_accy 89.82:  40%|████      | 8/20 [19:16<25:31, 127.63s/it]
Task 1, Epoch 9/20 => Loss 0.690, Loss_clf 0.340, Loss_aux 0.350, Train_accy 89.82:  45%|████▌     | 9/20 [19:16<23:10, 126.39s/it]
Task 1, Epoch 10/20 => Loss 0.663, Loss_clf 0.330, Loss_aux 0.333, Train_accy 90.57:  45%|████▌     | 9/20 [21:19<23:10, 126.39s/it]
Task 1, Epoch 10/20 => Loss 0.663, Loss_clf 0.330, Loss_aux 0.333, Train_accy 90.57:  50%|█████     | 10/20 [21:19<20:54, 125.49s/it]
Task 1, Epoch 11/20 => Loss 0.675, Loss_clf 0.332, Loss_aux 0.343, Train_accy 90.22, Test_accy 93.38:  50%|█████     | 10/20 [23:45<20:54, 125.49s/it]
Task 1, Epoch 11/20 => Loss 0.675, Loss_clf 0.332, Loss_aux 0.343, Train_accy 90.22, Test_accy 93.38:  55%|█████▌    | 11/20 [23:45<19:45, 131.68s/it]
Task 1, Epoch 12/20 => Loss 0.657, Loss_clf 0.329, Loss_aux 0.327, Train_accy 90.38:  55%|█████▌    | 11/20 [25:48<19:45, 131.68s/it]                 
Task 1, Epoch 12/20 => Loss 0.657, Loss_clf 0.329, Loss_aux 0.327, Train_accy 90.38:  60%|██████    | 12/20 [25:48<17:13, 129.14s/it]
Task 1, Epoch 13/20 => Loss 0.630, Loss_clf 0.309, Loss_aux 0.320, Train_accy 90.78:  60%|██████    | 12/20 [27:52<17:13, 129.14s/it]
Task 1, Epoch 13/20 => Loss 0.630, Loss_clf 0.309, Loss_aux 0.320, Train_accy 90.78:  65%|██████▌   | 13/20 [27:52<14:51, 127.39s/it]
Task 1, Epoch 14/20 => Loss 0.617, Loss_clf 0.306, Loss_aux 0.310, Train_accy 90.69:  65%|██████▌   | 13/20 [29:56<14:51, 127.39s/it]
Task 1, Epoch 14/20 => Loss 0.617, Loss_clf 0.306, Loss_aux 0.310, Train_accy 90.69:  70%|███████   | 14/20 [29:56<12:37, 126.29s/it]
Task 1, Epoch 15/20 => Loss 0.630, Loss_clf 0.314, Loss_aux 0.317, Train_accy 90.86:  70%|███████   | 14/20 [31:59<12:37, 126.29s/it]
Task 1, Epoch 15/20 => Loss 0.630, Loss_clf 0.314, Loss_aux 0.317, Train_accy 90.86:  75%|███████▌  | 15/20 [31:59<10:27, 125.44s/it]
Task 1, Epoch 16/20 => Loss 0.593, Loss_clf 0.296, Loss_aux 0.297, Train_accy 91.27, Test_accy 93.82:  75%|███████▌  | 15/20 [34:25<10:27, 125.44s/it]
Task 1, Epoch 16/20 => Loss 0.593, Loss_clf 0.296, Loss_aux 0.297, Train_accy 91.27, Test_accy 93.82:  80%|████████  | 16/20 [34:25<08:46, 131.61s/it]
Task 1, Epoch 17/20 => Loss 0.562, Loss_clf 0.279, Loss_aux 0.283, Train_accy 91.70:  80%|████████  | 16/20 [36:29<08:46, 131.61s/it]                 
Task 1, Epoch 17/20 => Loss 0.562, Loss_clf 0.279, Loss_aux 0.283, Train_accy 91.70:  85%|████████▌ | 17/20 [36:29<06:27, 129.25s/it]
Task 1, Epoch 18/20 => Loss 0.567, Loss_clf 0.288, Loss_aux 0.280, Train_accy 91.72:  85%|████████▌ | 17/20 [38:32<06:27, 129.25s/it]
Task 1, Epoch 18/20 => Loss 0.567, Loss_clf 0.288, Loss_aux 0.280, Train_accy 91.72:  90%|█████████ | 18/20 [38:32<04:15, 127.51s/it]
Task 1, Epoch 19/20 => Loss 0.584, Loss_clf 0.294, Loss_aux 0.290, Train_accy 91.27:  90%|█████████ | 18/20 [40:36<04:15, 127.51s/it]
Task 1, Epoch 19/20 => Loss 0.584, Loss_clf 0.294, Loss_aux 0.290, Train_accy 91.27:  95%|█████████▌| 19/20 [40:36<02:06, 126.32s/it]
Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.293, Loss_aux 0.290, Train_accy 91.48:  95%|█████████▌| 19/20 [42:40<02:06, 126.32s/it]
Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.293, Loss_aux 0.290, Train_accy 91.48: 100%|██████████| 20/20 [42:40<00:00, 125.56s/it]
Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.293, Loss_aux 0.290, Train_accy 91.48: 100%|██████████| 20/20 [42:40<00:00, 128.00s/it]
2024-09-04 09:11:26,536 [der.py] => Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.293, Loss_aux 0.290, Train_accy 91.48
2024-09-04 09:11:26,537 [base.py] => Reducing exemplars...(50 per classes)
2024-09-04 09:11:37,135 [base.py] => Constructing exemplars...(50 per classes)
2024-09-04 09:13:36,028 [der.py] => Exemplar size: 2000
2024-09-04 09:13:36,028 [trainer.py] => CNN: {'total': 92.95, '00-19': 89.6, '20-39': 96.3, 'old': 89.6, 'new': 96.3}
2024-09-04 09:13:36,028 [trainer.py] => NME: {'total': 93.68, '00-19': 92.35, '20-39': 95.0, 'old': 92.35, 'new': 95.0}
2024-09-04 09:13:36,028 [trainer.py] => CNN top1 curve: [96.65, 92.95]
2024-09-04 09:13:36,028 [trainer.py] => CNN top5 curve: [99.75, 99.38]
2024-09-04 09:13:36,029 [trainer.py] => NME top1 curve: [96.45, 93.68]
2024-09-04 09:13:36,029 [trainer.py] => NME top5 curve: [99.75, 99.52]

Average Accuracy (CNN): 94.8
Average Accuracy (NME): 95.06
2024-09-04 09:13:36,029 [trainer.py] => Average Accuracy (CNN): 94.8
2024-09-04 09:13:36,029 [trainer.py] => Average Accuracy (NME): 95.06
2024-09-04 09:13:36,030 [trainer.py] => All params: 171674941
2024-09-04 09:13:36,031 [trainer.py] => Trainable params: 85876285
2024-09-04 09:13:37,537 [der.py] => Learning on 40-60
2024-09-04 09:13:37,540 [der.py] => All params: 257550417
2024-09-04 09:13:37,541 [der.py] => Trainable params: 85953105

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.834, Loss_clf 0.994, Loss_aux 0.840, Train_accy 75.70, Test_accy 86.87:   0%|          | 0/20 [03:25<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.834, Loss_clf 0.994, Loss_aux 0.840, Train_accy 75.70, Test_accy 86.87:   5%|▌         | 1/20 [03:25<1:05:00, 205.29s/it]
Task 2, Epoch 2/20 => Loss 1.023, Loss_clf 0.507, Loss_aux 0.515, Train_accy 84.74:   5%|▌         | 1/20 [06:01<1:05:00, 205.29s/it]                 
Task 2, Epoch 2/20 => Loss 1.023, Loss_clf 0.507, Loss_aux 0.515, Train_accy 84.74:  10%|█         | 2/20 [06:01<52:51, 176.21s/it]  
Task 2, Epoch 3/20 => Loss 0.893, Loss_clf 0.447, Loss_aux 0.446, Train_accy 86.52:  10%|█         | 2/20 [08:36<52:51, 176.21s/it]
Task 2, Epoch 3/20 => Loss 0.893, Loss_clf 0.447, Loss_aux 0.446, Train_accy 86.52:  15%|█▌        | 3/20 [08:36<47:15, 166.82s/it]
Task 2, Epoch 4/20 => Loss 0.847, Loss_clf 0.422, Loss_aux 0.425, Train_accy 87.21:  15%|█▌        | 3/20 [11:12<47:15, 166.82s/it]
Task 2, Epoch 4/20 => Loss 0.847, Loss_clf 0.422, Loss_aux 0.425, Train_accy 87.21:  20%|██        | 4/20 [11:12<43:18, 162.38s/it]
Task 2, Epoch 5/20 => Loss 0.819, Loss_clf 0.411, Loss_aux 0.407, Train_accy 87.85:  20%|██        | 4/20 [13:47<43:18, 162.38s/it]
Task 2, Epoch 5/20 => Loss 0.819, Loss_clf 0.411, Loss_aux 0.407, Train_accy 87.85:  25%|██▌       | 5/20 [13:47<39:59, 159.95s/it]
Task 2, Epoch 6/20 => Loss 0.777, Loss_clf 0.387, Loss_aux 0.389, Train_accy 88.42, Test_accy 88.22:  25%|██▌       | 5/20 [17:12<39:59, 159.95s/it]
Task 2, Epoch 6/20 => Loss 0.777, Loss_clf 0.387, Loss_aux 0.389, Train_accy 88.42, Test_accy 88.22:  30%|███       | 6/20 [17:12<40:53, 175.26s/it]
Task 2, Epoch 7/20 => Loss 0.746, Loss_clf 0.375, Loss_aux 0.370, Train_accy 89.25:  30%|███       | 6/20 [19:48<40:53, 175.26s/it]                 
Task 2, Epoch 7/20 => Loss 0.746, Loss_clf 0.375, Loss_aux 0.370, Train_accy 89.25:  35%|███▌      | 7/20 [19:48<36:34, 168.82s/it]
Task 2, Epoch 8/20 => Loss 0.734, Loss_clf 0.373, Loss_aux 0.362, Train_accy 89.12:  35%|███▌      | 7/20 [22:24<36:34, 168.82s/it]
Task 2, Epoch 8/20 => Loss 0.734, Loss_clf 0.373, Loss_aux 0.362, Train_accy 89.12:  40%|████      | 8/20 [22:24<32:55, 164.59s/it]
Task 2, Epoch 9/20 => Loss 0.689, Loss_clf 0.358, Loss_aux 0.331, Train_accy 89.59:  40%|████      | 8/20 [24:59<32:55, 164.59s/it]
Task 2, Epoch 9/20 => Loss 0.689, Loss_clf 0.358, Loss_aux 0.331, Train_accy 89.59:  45%|████▌     | 9/20 [24:59<29:38, 161.72s/it]
Task 2, Epoch 10/20 => Loss 0.684, Loss_clf 0.346, Loss_aux 0.339, Train_accy 89.92:  45%|████▌     | 9/20 [27:34<29:38, 161.72s/it]
Task 2, Epoch 10/20 => Loss 0.684, Loss_clf 0.346, Loss_aux 0.339, Train_accy 89.92:  50%|█████     | 10/20 [27:34<26:36, 159.66s/it]
Task 2, Epoch 11/20 => Loss 0.657, Loss_clf 0.339, Loss_aux 0.319, Train_accy 90.08, Test_accy 88.87:  50%|█████     | 10/20 [30:56<26:36, 159.66s/it]
Task 2, Epoch 11/20 => Loss 0.657, Loss_clf 0.339, Loss_aux 0.319, Train_accy 90.08, Test_accy 88.87:  55%|█████▌    | 11/20 [30:56<25:54, 172.74s/it]
Task 2, Epoch 12/20 => Loss 0.652, Loss_clf 0.334, Loss_aux 0.318, Train_accy 90.03:  55%|█████▌    | 11/20 [33:30<25:54, 172.74s/it]                 
Task 2, Epoch 12/20 => Loss 0.652, Loss_clf 0.334, Loss_aux 0.318, Train_accy 90.03:  60%|██████    | 12/20 [33:30<22:16, 167.02s/it]
Task 2, Epoch 13/20 => Loss 0.665, Loss_clf 0.339, Loss_aux 0.326, Train_accy 90.23:  60%|██████    | 12/20 [36:05<22:16, 167.02s/it]
Task 2, Epoch 13/20 => Loss 0.665, Loss_clf 0.339, Loss_aux 0.326, Train_accy 90.23:  65%|██████▌   | 13/20 [36:05<19:02, 163.18s/it]
Task 2, Epoch 14/20 => Loss 0.618, Loss_clf 0.316, Loss_aux 0.302, Train_accy 90.61:  65%|██████▌   | 13/20 [38:40<19:02, 163.18s/it]
Task 2, Epoch 14/20 => Loss 0.618, Loss_clf 0.316, Loss_aux 0.302, Train_accy 90.61:  70%|███████   | 14/20 [38:40<16:04, 160.83s/it]
Task 2, Epoch 15/20 => Loss 0.618, Loss_clf 0.317, Loss_aux 0.301, Train_accy 90.88:  70%|███████   | 14/20 [41:15<16:04, 160.83s/it]
Task 2, Epoch 15/20 => Loss 0.618, Loss_clf 0.317, Loss_aux 0.301, Train_accy 90.88:  75%|███████▌  | 15/20 [41:15<13:14, 158.93s/it]
Task 2, Epoch 16/20 => Loss 0.594, Loss_clf 0.303, Loss_aux 0.290, Train_accy 91.22, Test_accy 89.15:  75%|███████▌  | 15/20 [44:39<13:14, 158.93s/it]
Task 2, Epoch 16/20 => Loss 0.594, Loss_clf 0.303, Loss_aux 0.290, Train_accy 91.22, Test_accy 89.15:  80%|████████  | 16/20 [44:39<11:29, 172.48s/it]
Task 2, Epoch 17/20 => Loss 0.569, Loss_clf 0.290, Loss_aux 0.279, Train_accy 91.52:  80%|████████  | 16/20 [47:13<11:29, 172.48s/it]                 
Task 2, Epoch 17/20 => Loss 0.569, Loss_clf 0.290, Loss_aux 0.279, Train_accy 91.52:  85%|████████▌ | 17/20 [47:13<08:21, 167.18s/it]
Task 2, Epoch 18/20 => Loss 0.567, Loss_clf 0.291, Loss_aux 0.276, Train_accy 91.44:  85%|████████▌ | 17/20 [49:48<08:21, 167.18s/it]
Task 2, Epoch 18/20 => Loss 0.567, Loss_clf 0.291, Loss_aux 0.276, Train_accy 91.44:  90%|█████████ | 18/20 [49:48<05:26, 163.47s/it]
Task 2, Epoch 19/20 => Loss 0.564, Loss_clf 0.292, Loss_aux 0.271, Train_accy 91.67:  90%|█████████ | 18/20 [52:23<05:26, 163.47s/it]
Task 2, Epoch 19/20 => Loss 0.564, Loss_clf 0.292, Loss_aux 0.271, Train_accy 91.67:  95%|█████████▌| 19/20 [52:23<02:40, 160.89s/it]
Task 2, Epoch 20/20 => Loss 0.554, Loss_clf 0.282, Loss_aux 0.272, Train_accy 92.00:  95%|█████████▌| 19/20 [54:58<02:40, 160.89s/it]
Task 2, Epoch 20/20 => Loss 0.554, Loss_clf 0.282, Loss_aux 0.272, Train_accy 92.00: 100%|██████████| 20/20 [54:58<00:00, 158.93s/it]
Task 2, Epoch 20/20 => Loss 0.554, Loss_clf 0.282, Loss_aux 0.272, Train_accy 92.00: 100%|██████████| 20/20 [54:58<00:00, 164.90s/it]
2024-09-04 10:08:35,707 [der.py] => Task 2, Epoch 20/20 => Loss 0.554, Loss_clf 0.282, Loss_aux 0.272, Train_accy 92.00
2024-09-04 10:08:35,709 [base.py] => Reducing exemplars...(33 per classes)
2024-09-04 10:08:56,327 [base.py] => Constructing exemplars...(33 per classes)
2024-09-04 10:12:14,238 [der.py] => Exemplar size: 1980
2024-09-04 10:12:14,239 [trainer.py] => CNN: {'total': 89.2, '00-19': 83.4, '20-39': 89.4, '40-59': 94.8, 'old': 86.4, 'new': 94.8}
2024-09-04 10:12:14,239 [trainer.py] => NME: {'total': 91.67, '00-19': 89.8, '20-39': 92.8, '40-59': 92.4, 'old': 91.3, 'new': 92.4}
2024-09-04 10:12:14,239 [trainer.py] => CNN top1 curve: [96.65, 92.95, 89.2]
2024-09-04 10:12:14,239 [trainer.py] => CNN top5 curve: [99.75, 99.38, 98.57]
2024-09-04 10:12:14,239 [trainer.py] => NME top1 curve: [96.45, 93.68, 91.67]
2024-09-04 10:12:14,239 [trainer.py] => NME top5 curve: [99.75, 99.52, 99.32]

Average Accuracy (CNN): 92.93
Average Accuracy (NME): 93.93
2024-09-04 10:12:14,239 [trainer.py] => Average Accuracy (CNN): 92.93
2024-09-04 10:12:14,239 [trainer.py] => Average Accuracy (NME): 93.93
2024-09-04 10:12:14,241 [trainer.py] => All params: 257550417
2024-09-04 10:12:14,243 [trainer.py] => Trainable params: 85953105
2024-09-04 10:12:16,485 [der.py] => Learning on 60-80
2024-09-04 10:12:16,491 [der.py] => All params: 343456613
2024-09-04 10:12:16,492 [der.py] => Trainable params: 86060645

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.885, Loss_clf 1.106, Loss_aux 0.779, Train_accy 75.67, Test_accy 82.72:   0%|          | 0/20 [04:32<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.885, Loss_clf 1.106, Loss_aux 0.779, Train_accy 75.67, Test_accy 82.72:   5%|▌         | 1/20 [04:32<1:26:08, 272.02s/it]
Task 3, Epoch 2/20 => Loss 1.014, Loss_clf 0.529, Loss_aux 0.485, Train_accy 84.58:   5%|▌         | 1/20 [07:37<1:26:08, 272.02s/it]                 
Task 3, Epoch 2/20 => Loss 1.014, Loss_clf 0.529, Loss_aux 0.485, Train_accy 84.58:  10%|█         | 2/20 [07:37<1:06:23, 221.31s/it]
Task 3, Epoch 3/20 => Loss 0.927, Loss_clf 0.478, Loss_aux 0.449, Train_accy 85.85:  10%|█         | 2/20 [10:44<1:06:23, 221.31s/it]
Task 3, Epoch 3/20 => Loss 0.927, Loss_clf 0.478, Loss_aux 0.449, Train_accy 85.85:  15%|█▌        | 3/20 [10:44<58:09, 205.28s/it]  
Task 3, Epoch 4/20 => Loss 0.857, Loss_clf 0.438, Loss_aux 0.419, Train_accy 86.69:  15%|█▌        | 3/20 [13:50<58:09, 205.28s/it]
Task 3, Epoch 4/20 => Loss 0.857, Loss_clf 0.438, Loss_aux 0.419, Train_accy 86.69:  20%|██        | 4/20 [13:50<52:44, 197.75s/it]
Task 3, Epoch 5/20 => Loss 0.788, Loss_clf 0.409, Loss_aux 0.379, Train_accy 88.11:  20%|██        | 4/20 [16:55<52:44, 197.75s/it]
Task 3, Epoch 5/20 => Loss 0.788, Loss_clf 0.409, Loss_aux 0.379, Train_accy 88.11:  25%|██▌       | 5/20 [16:55<48:20, 193.37s/it]
Task 3, Epoch 6/20 => Loss 0.739, Loss_clf 0.382, Loss_aux 0.357, Train_accy 89.00, Test_accy 84.65:  25%|██▌       | 5/20 [21:28<48:20, 193.37s/it]
Task 3, Epoch 6/20 => Loss 0.739, Loss_clf 0.382, Loss_aux 0.357, Train_accy 89.00, Test_accy 84.65:  30%|███       | 6/20 [21:28<51:24, 220.34s/it]
Task 3, Epoch 7/20 => Loss 0.722, Loss_clf 0.372, Loss_aux 0.350, Train_accy 89.01:  30%|███       | 6/20 [24:33<51:24, 220.34s/it]                 
Task 3, Epoch 7/20 => Loss 0.722, Loss_clf 0.372, Loss_aux 0.350, Train_accy 89.01:  35%|███▌      | 7/20 [24:33<45:14, 208.78s/it]
Task 3, Epoch 8/20 => Loss 0.667, Loss_clf 0.347, Loss_aux 0.320, Train_accy 89.85:  35%|███▌      | 7/20 [27:37<45:14, 208.78s/it]
Task 3, Epoch 8/20 => Loss 0.667, Loss_clf 0.347, Loss_aux 0.320, Train_accy 89.85:  40%|████      | 8/20 [27:37<40:11, 200.96s/it]
Task 3, Epoch 9/20 => Loss 0.689, Loss_clf 0.354, Loss_aux 0.336, Train_accy 89.77:  40%|████      | 8/20 [30:42<40:11, 200.96s/it]
Task 3, Epoch 9/20 => Loss 0.689, Loss_clf 0.354, Loss_aux 0.336, Train_accy 89.77:  45%|████▌     | 9/20 [30:42<35:53, 195.75s/it]
Task 3, Epoch 10/20 => Loss 0.628, Loss_clf 0.322, Loss_aux 0.305, Train_accy 90.62:  45%|████▌     | 9/20 [33:47<35:53, 195.75s/it]
Task 3, Epoch 10/20 => Loss 0.628, Loss_clf 0.322, Loss_aux 0.305, Train_accy 90.62:  50%|█████     | 10/20 [33:47<32:05, 192.55s/it]
Task 3, Epoch 11/20 => Loss 0.643, Loss_clf 0.338, Loss_aux 0.305, Train_accy 90.33, Test_accy 85.15:  50%|█████     | 10/20 [38:20<32:05, 192.55s/it]
Task 3, Epoch 11/20 => Loss 0.643, Loss_clf 0.338, Loss_aux 0.305, Train_accy 90.33, Test_accy 85.15:  55%|█████▌    | 11/20 [38:20<32:33, 217.08s/it]
Task 3, Epoch 12/20 => Loss 0.630, Loss_clf 0.325, Loss_aux 0.305, Train_accy 90.45:  55%|█████▌    | 11/20 [41:26<32:33, 217.08s/it]                 
Task 3, Epoch 12/20 => Loss 0.630, Loss_clf 0.325, Loss_aux 0.305, Train_accy 90.45:  60%|██████    | 12/20 [41:26<27:41, 207.65s/it]
Task 3, Epoch 13/20 => Loss 0.602, Loss_clf 0.312, Loss_aux 0.290, Train_accy 90.96:  60%|██████    | 12/20 [44:32<27:41, 207.65s/it]
Task 3, Epoch 13/20 => Loss 0.602, Loss_clf 0.312, Loss_aux 0.290, Train_accy 90.96:  65%|██████▌   | 13/20 [44:32<23:28, 201.20s/it]
Task 3, Epoch 14/20 => Loss 0.601, Loss_clf 0.314, Loss_aux 0.287, Train_accy 91.19:  65%|██████▌   | 13/20 [47:38<23:28, 201.20s/it]
Task 3, Epoch 14/20 => Loss 0.601, Loss_clf 0.314, Loss_aux 0.287, Train_accy 91.19:  70%|███████   | 14/20 [47:38<19:39, 196.54s/it]
Task 3, Epoch 15/20 => Loss 0.585, Loss_clf 0.304, Loss_aux 0.282, Train_accy 91.23:  70%|███████   | 14/20 [50:44<19:39, 196.54s/it]
Task 3, Epoch 15/20 => Loss 0.585, Loss_clf 0.304, Loss_aux 0.282, Train_accy 91.23:  75%|███████▌  | 15/20 [50:44<16:07, 193.41s/it]
Task 3, Epoch 16/20 => Loss 0.582, Loss_clf 0.305, Loss_aux 0.278, Train_accy 91.18, Test_accy 85.29:  75%|███████▌  | 15/20 [55:15<16:07, 193.41s/it]
Task 3, Epoch 16/20 => Loss 0.582, Loss_clf 0.305, Loss_aux 0.278, Train_accy 91.18, Test_accy 85.29:  80%|████████  | 16/20 [55:15<14:26, 216.73s/it]
Task 3, Epoch 17/20 => Loss 0.574, Loss_clf 0.300, Loss_aux 0.275, Train_accy 91.29:  80%|████████  | 16/20 [58:17<14:26, 216.73s/it]                 
Task 3, Epoch 17/20 => Loss 0.574, Loss_clf 0.300, Loss_aux 0.275, Train_accy 91.29:  85%|████████▌ | 17/20 [58:17<10:18, 206.21s/it]
Task 3, Epoch 18/20 => Loss 0.553, Loss_clf 0.289, Loss_aux 0.264, Train_accy 91.74:  85%|████████▌ | 17/20 [1:01:18<10:18, 206.21s/it]
Task 3, Epoch 18/20 => Loss 0.553, Loss_clf 0.289, Loss_aux 0.264, Train_accy 91.74:  90%|█████████ | 18/20 [1:01:18<06:37, 198.79s/it]
Task 3, Epoch 19/20 => Loss 0.569, Loss_clf 0.299, Loss_aux 0.271, Train_accy 91.67:  90%|█████████ | 18/20 [1:04:20<06:37, 198.79s/it]
Task 3, Epoch 19/20 => Loss 0.569, Loss_clf 0.299, Loss_aux 0.271, Train_accy 91.67:  95%|█████████▌| 19/20 [1:04:20<03:13, 193.63s/it]
Task 3, Epoch 20/20 => Loss 0.525, Loss_clf 0.276, Loss_aux 0.249, Train_accy 92.20:  95%|█████████▌| 19/20 [1:07:21<03:13, 193.63s/it]
Task 3, Epoch 20/20 => Loss 0.525, Loss_clf 0.276, Loss_aux 0.249, Train_accy 92.20: 100%|██████████| 20/20 [1:07:21<00:00, 190.02s/it]
Task 3, Epoch 20/20 => Loss 0.525, Loss_clf 0.276, Loss_aux 0.249, Train_accy 92.20: 100%|██████████| 20/20 [1:07:21<00:00, 202.09s/it]
2024-09-04 11:19:38,691 [der.py] => Task 3, Epoch 20/20 => Loss 0.525, Loss_clf 0.276, Loss_aux 0.249, Train_accy 92.20
2024-09-04 11:19:38,692 [base.py] => Reducing exemplars...(25 per classes)
2024-09-04 11:20:10,565 [base.py] => Constructing exemplars...(25 per classes)
2024-09-04 11:25:05,032 [der.py] => Exemplar size: 2000
2024-09-04 11:25:05,033 [trainer.py] => CNN: {'total': 84.42, '00-19': 79.6, '20-39': 87.3, '40-59': 76.45, '60-79': 94.35, 'old': 81.12, 'new': 94.35}
2024-09-04 11:25:05,033 [trainer.py] => NME: {'total': 88.46, '00-19': 87.0, '20-39': 91.3, '40-59': 86.25, '60-79': 89.3, 'old': 88.18, 'new': 89.3}
2024-09-04 11:25:05,033 [trainer.py] => CNN top1 curve: [96.65, 92.95, 89.2, 84.42]
2024-09-04 11:25:05,033 [trainer.py] => CNN top5 curve: [99.75, 99.38, 98.57, 97.44]
2024-09-04 11:25:05,033 [trainer.py] => NME top1 curve: [96.45, 93.68, 91.67, 88.46]
2024-09-04 11:25:05,033 [trainer.py] => NME top5 curve: [99.75, 99.52, 99.32, 98.89]

Average Accuracy (CNN): 90.8
Average Accuracy (NME): 92.56
2024-09-04 11:25:05,033 [trainer.py] => Average Accuracy (CNN): 90.8
2024-09-04 11:25:05,033 [trainer.py] => Average Accuracy (NME): 92.56
2024-09-04 11:25:05,035 [trainer.py] => All params: 343456613
2024-09-04 11:25:05,037 [trainer.py] => Trainable params: 86060645
2024-09-04 11:25:06,682 [der.py] => Learning on 80-100
2024-09-04 11:25:06,688 [der.py] => All params: 429393529
2024-09-04 11:25:06,691 [der.py] => Trainable params: 86198905

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.956, Loss_clf 1.124, Loss_aux 0.832, Train_accy 76.76, Test_accy 80.29:   0%|          | 0/20 [05:43<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.956, Loss_clf 1.124, Loss_aux 0.832, Train_accy 76.76, Test_accy 80.29:   5%|▌         | 1/20 [05:43<1:48:55, 343.96s/it]
Task 4, Epoch 2/20 => Loss 1.019, Loss_clf 0.511, Loss_aux 0.508, Train_accy 85.42:   5%|▌         | 1/20 [09:16<1:48:55, 343.96s/it]                 
Task 4, Epoch 2/20 => Loss 1.019, Loss_clf 0.511, Loss_aux 0.508, Train_accy 85.42:  10%|█         | 2/20 [09:16<1:19:59, 266.62s/it]
Task 4, Epoch 3/20 => Loss 0.877, Loss_clf 0.444, Loss_aux 0.433, Train_accy 87.52:  10%|█         | 2/20 [12:48<1:19:59, 266.62s/it]
Task 4, Epoch 3/20 => Loss 0.877, Loss_clf 0.444, Loss_aux 0.433, Train_accy 87.52:  15%|█▌        | 3/20 [12:48<1:08:32, 241.89s/it]
Task 4, Epoch 4/20 => Loss 0.818, Loss_clf 0.419, Loss_aux 0.398, Train_accy 87.84:  15%|█▌        | 3/20 [16:21<1:08:32, 241.89s/it]
Task 4, Epoch 4/20 => Loss 0.818, Loss_clf 0.419, Loss_aux 0.398, Train_accy 87.84:  20%|██        | 4/20 [16:21<1:01:24, 230.29s/it]
Task 4, Epoch 5/20 => Loss 0.772, Loss_clf 0.394, Loss_aux 0.378, Train_accy 88.79:  20%|██        | 4/20 [19:54<1:01:24, 230.29s/it]
Task 4, Epoch 5/20 => Loss 0.772, Loss_clf 0.394, Loss_aux 0.378, Train_accy 88.79:  25%|██▌       | 5/20 [19:54<55:58, 223.91s/it]  
Task 4, Epoch 6/20 => Loss 0.723, Loss_clf 0.369, Loss_aux 0.354, Train_accy 89.75, Test_accy 80.86:  25%|██▌       | 5/20 [25:37<55:58, 223.91s/it]
Task 4, Epoch 6/20 => Loss 0.723, Loss_clf 0.369, Loss_aux 0.354, Train_accy 89.75, Test_accy 80.86:  30%|███       | 6/20 [25:37<1:01:44, 264.60s/it]
Task 4, Epoch 7/20 => Loss 0.665, Loss_clf 0.336, Loss_aux 0.328, Train_accy 90.60:  30%|███       | 6/20 [29:10<1:01:44, 264.60s/it]                 
Task 4, Epoch 7/20 => Loss 0.665, Loss_clf 0.336, Loss_aux 0.328, Train_accy 90.60:  35%|███▌      | 7/20 [29:10<53:39, 247.62s/it]  
Task 4, Epoch 8/20 => Loss 0.657, Loss_clf 0.336, Loss_aux 0.320, Train_accy 90.68:  35%|███▌      | 7/20 [32:42<53:39, 247.62s/it]
Task 4, Epoch 8/20 => Loss 0.657, Loss_clf 0.336, Loss_aux 0.320, Train_accy 90.68:  40%|████      | 8/20 [32:42<47:17, 236.44s/it]
Task 4, Epoch 9/20 => Loss 0.651, Loss_clf 0.339, Loss_aux 0.312, Train_accy 90.71:  40%|████      | 8/20 [36:15<47:17, 236.44s/it]
Task 4, Epoch 9/20 => Loss 0.651, Loss_clf 0.339, Loss_aux 0.312, Train_accy 90.71:  45%|████▌     | 9/20 [36:15<41:58, 228.98s/it]
Task 4, Epoch 10/20 => Loss 0.675, Loss_clf 0.344, Loss_aux 0.331, Train_accy 90.16:  45%|████▌     | 9/20 [39:47<41:58, 228.98s/it]
Task 4, Epoch 10/20 => Loss 0.675, Loss_clf 0.344, Loss_aux 0.331, Train_accy 90.16:  50%|█████     | 10/20 [39:47<37:19, 223.93s/it]
Task 4, Epoch 11/20 => Loss 0.622, Loss_clf 0.324, Loss_aux 0.298, Train_accy 91.11, Test_accy 81.46:  50%|█████     | 10/20 [45:31<37:19, 223.93s/it]
Task 4, Epoch 11/20 => Loss 0.622, Loss_clf 0.324, Loss_aux 0.298, Train_accy 91.11, Test_accy 81.46:  55%|█████▌    | 11/20 [45:31<39:04, 260.50s/it]
Task 4, Epoch 12/20 => Loss 0.607, Loss_clf 0.316, Loss_aux 0.292, Train_accy 91.12:  55%|█████▌    | 11/20 [49:03<39:04, 260.50s/it]                 
Task 4, Epoch 12/20 => Loss 0.607, Loss_clf 0.316, Loss_aux 0.292, Train_accy 91.12:  60%|██████    | 12/20 [49:03<32:47, 245.92s/it]
Task 4, Epoch 13/20 => Loss 0.582, Loss_clf 0.297, Loss_aux 0.284, Train_accy 91.54:  60%|██████    | 12/20 [52:36<32:47, 245.92s/it]
Task 4, Epoch 13/20 => Loss 0.582, Loss_clf 0.297, Loss_aux 0.284, Train_accy 91.54:  65%|██████▌   | 13/20 [52:36<27:31, 235.88s/it]
Task 4, Epoch 14/20 => Loss 0.614, Loss_clf 0.318, Loss_aux 0.297, Train_accy 91.25:  65%|██████▌   | 13/20 [56:09<27:31, 235.88s/it]
Task 4, Epoch 14/20 => Loss 0.614, Loss_clf 0.318, Loss_aux 0.297, Train_accy 91.25:  70%|███████   | 14/20 [56:09<22:53, 228.87s/it]
Task 4, Epoch 15/20 => Loss 0.538, Loss_clf 0.279, Loss_aux 0.259, Train_accy 92.18:  70%|███████   | 14/20 [59:42<22:53, 228.87s/it]
Task 4, Epoch 15/20 => Loss 0.538, Loss_clf 0.279, Loss_aux 0.259, Train_accy 92.18:  75%|███████▌  | 15/20 [59:42<18:40, 224.02s/it]
Task 4, Epoch 16/20 => Loss 0.532, Loss_clf 0.277, Loss_aux 0.254, Train_accy 92.32, Test_accy 80.56:  75%|███████▌  | 15/20 [1:05:25<18:40, 224.02s/it]
Task 4, Epoch 16/20 => Loss 0.532, Loss_clf 0.277, Loss_aux 0.254, Train_accy 92.32, Test_accy 80.56:  80%|████████  | 16/20 [1:05:25<17:20, 260.01s/it]
Task 4, Epoch 17/20 => Loss 0.572, Loss_clf 0.299, Loss_aux 0.274, Train_accy 91.72:  80%|████████  | 16/20 [1:08:58<17:20, 260.01s/it]                 
Task 4, Epoch 17/20 => Loss 0.572, Loss_clf 0.299, Loss_aux 0.274, Train_accy 91.72:  85%|████████▌ | 17/20 [1:08:58<12:17, 245.74s/it]
Task 4, Epoch 18/20 => Loss 0.559, Loss_clf 0.290, Loss_aux 0.269, Train_accy 91.93:  85%|████████▌ | 17/20 [1:12:30<12:17, 245.74s/it]
Task 4, Epoch 18/20 => Loss 0.559, Loss_clf 0.290, Loss_aux 0.269, Train_accy 91.93:  90%|█████████ | 18/20 [1:12:30<07:51, 235.79s/it]
Task 4, Epoch 19/20 => Loss 0.527, Loss_clf 0.271, Loss_aux 0.256, Train_accy 92.12:  90%|█████████ | 18/20 [1:16:03<07:51, 235.79s/it]
Task 4, Epoch 19/20 => Loss 0.527, Loss_clf 0.271, Loss_aux 0.256, Train_accy 92.12:  95%|█████████▌| 19/20 [1:16:03<03:48, 228.80s/it]
Task 4, Epoch 20/20 => Loss 0.538, Loss_clf 0.278, Loss_aux 0.260, Train_accy 92.14:  95%|█████████▌| 19/20 [1:19:36<03:48, 228.80s/it]
Task 4, Epoch 20/20 => Loss 0.538, Loss_clf 0.278, Loss_aux 0.260, Train_accy 92.14: 100%|██████████| 20/20 [1:19:36<00:00, 223.93s/it]
Task 4, Epoch 20/20 => Loss 0.538, Loss_clf 0.278, Loss_aux 0.260, Train_accy 92.14: 100%|██████████| 20/20 [1:19:36<00:00, 238.80s/it]
2024-09-04 12:44:42,909 [der.py] => Task 4, Epoch 20/20 => Loss 0.538, Loss_clf 0.278, Loss_aux 0.260, Train_accy 92.14
2024-09-04 12:44:42,911 [base.py] => Reducing exemplars...(20 per classes)
2024-09-04 12:45:26,958 [base.py] => Constructing exemplars...(20 per classes)
2024-09-04 12:52:22,392 [der.py] => Exemplar size: 2000
2024-09-04 12:52:22,392 [trainer.py] => CNN: {'total': 80.66, '00-19': 72.0, '20-39': 81.45, '40-59': 72.7, '60-79': 81.6, '80-99': 95.55, 'old': 76.94, 'new': 95.55}
2024-09-04 12:52:22,393 [trainer.py] => NME: {'total': 86.54, '00-19': 83.15, '20-39': 89.0, '40-59': 82.3, '60-79': 87.95, '80-99': 90.3, 'old': 85.6, 'new': 90.3}
2024-09-04 12:52:22,393 [trainer.py] => CNN top1 curve: [96.65, 92.95, 89.2, 84.42, 80.66]
2024-09-04 12:52:22,393 [trainer.py] => CNN top5 curve: [99.75, 99.38, 98.57, 97.44, 95.93]
2024-09-04 12:52:22,393 [trainer.py] => NME top1 curve: [96.45, 93.68, 91.67, 88.46, 86.54]
2024-09-04 12:52:22,393 [trainer.py] => NME top5 curve: [99.75, 99.52, 99.32, 98.89, 98.3]

Average Accuracy (CNN): 88.78
Average Accuracy (NME): 91.36
2024-09-04 12:52:22,393 [trainer.py] => Average Accuracy (CNN): 88.78
2024-09-04 12:52:22,393 [trainer.py] => Average Accuracy (NME): 91.36
Accuracy Matrix (CNN):
[[96.65 89.6  83.4  79.6  72.  ]
 [ 0.   96.3  89.4  87.3  81.45]
 [ 0.    0.   94.8  76.45 72.7 ]
 [ 0.    0.    0.   94.35 81.6 ]
 [ 0.    0.    0.    0.   95.55]]
2024-09-04 12:52:22,394 [trainer.py] => Forgetting (CNN): 18.5875
Accuracy Matrix (NME):
[[96.45 92.35 89.8  87.   83.15]
 [ 0.   95.   92.8  91.3  89.  ]
 [ 0.    0.   92.4  86.25 82.3 ]
 [ 0.    0.    0.   89.3  87.95]
 [ 0.    0.    0.    0.   90.3 ]]
2024-09-04 12:52:22,394 [trainer.py] => Forgetting (NME): 7.6875
2024-09-04 12:52:25,553 [trainer.py] => config: ./exps/der_cifar_B0_Inc10.json
2024-09-04 12:52:25,554 [trainer.py] => prefix: reproduce
2024-09-04 12:52:25,554 [trainer.py] => dataset: cifar224
2024-09-04 12:52:25,554 [trainer.py] => memory_size: 2000
2024-09-04 12:52:25,554 [trainer.py] => memory_per_class: 20
2024-09-04 12:52:25,554 [trainer.py] => fixed_memory: False
2024-09-04 12:52:25,554 [trainer.py] => shuffle: True
2024-09-04 12:52:25,554 [trainer.py] => init_cls: 10
2024-09-04 12:52:25,554 [trainer.py] => increment: 10
2024-09-04 12:52:25,554 [trainer.py] => model_name: der
2024-09-04 12:52:25,554 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 12:52:25,554 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-04 12:52:25,554 [trainer.py] => seed: 1993
2024-09-04 12:52:25,554 [trainer.py] => init_epoch: 20
2024-09-04 12:52:25,554 [trainer.py] => init_lr: 0.001
2024-09-04 12:52:25,554 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 12:52:25,554 [trainer.py] => init_lr_decay: 0.1
2024-09-04 12:52:25,554 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 12:52:25,554 [trainer.py] => epochs: 20
2024-09-04 12:52:25,554 [trainer.py] => lrate: 0.001
2024-09-04 12:52:25,555 [trainer.py] => milestones: [80, 120, 150]
2024-09-04 12:52:25,555 [trainer.py] => lrate_decay: 0.1
2024-09-04 12:52:25,555 [trainer.py] => batch_size: 48
2024-09-04 12:52:25,555 [trainer.py] => weight_decay: 0.0002
2024-09-04 12:52:25,555 [trainer.py] => T: 2
2024-09-04 12:52:26,691 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 12:52:27,056 [trainer.py] => All params: 0
2024-09-04 12:52:27,056 [trainer.py] => Trainable params: 0
2024-09-04 12:52:29,085 [der.py] => Learning on 0-10
2024-09-04 12:52:29,086 [der.py] => All params: 85814805
2024-09-04 12:52:29,087 [der.py] => Trainable params: 85814805

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.088, Train_accy 26.92, Test_accy 91.30:   0%|          | 0/20 [00:40<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.088, Train_accy 26.92, Test_accy 91.30:   5%|▌         | 1/20 [00:40<12:56, 40.86s/it]
Task 0, Epoch 2/20 => Loss 0.569, Train_accy 81.38:   5%|▌         | 1/20 [01:18<12:56, 40.86s/it]                 
Task 0, Epoch 2/20 => Loss 0.569, Train_accy 81.38:  10%|█         | 2/20 [01:18<11:39, 38.87s/it]
Task 0, Epoch 3/20 => Loss 0.405, Train_accy 87.46:  10%|█         | 2/20 [01:55<11:39, 38.87s/it]
Task 0, Epoch 3/20 => Loss 0.405, Train_accy 87.46:  15%|█▌        | 3/20 [01:55<10:48, 38.17s/it]
Task 0, Epoch 4/20 => Loss 0.340, Train_accy 89.36:  15%|█▌        | 3/20 [02:33<10:48, 38.17s/it]
Task 0, Epoch 4/20 => Loss 0.340, Train_accy 89.36:  20%|██        | 4/20 [02:33<10:06, 37.91s/it]
Task 0, Epoch 5/20 => Loss 0.275, Train_accy 90.96:  20%|██        | 4/20 [03:10<10:06, 37.91s/it]
Task 0, Epoch 5/20 => Loss 0.275, Train_accy 90.96:  25%|██▌       | 5/20 [03:10<09:25, 37.73s/it]
Task 0, Epoch 6/20 => Loss 0.286, Train_accy 90.88, Test_accy 98.20:  25%|██▌       | 5/20 [03:51<09:25, 37.73s/it]
Task 0, Epoch 6/20 => Loss 0.286, Train_accy 90.88, Test_accy 98.20:  30%|███       | 6/20 [03:51<09:01, 38.65s/it]
Task 0, Epoch 7/20 => Loss 0.258, Train_accy 91.64:  30%|███       | 6/20 [04:28<09:01, 38.65s/it]                 
Task 0, Epoch 7/20 => Loss 0.258, Train_accy 91.64:  35%|███▌      | 7/20 [04:28<08:17, 38.26s/it]
Task 0, Epoch 8/20 => Loss 0.258, Train_accy 91.56:  35%|███▌      | 7/20 [05:05<08:17, 38.26s/it]
Task 0, Epoch 8/20 => Loss 0.258, Train_accy 91.56:  40%|████      | 8/20 [05:05<07:35, 37.96s/it]
Task 0, Epoch 9/20 => Loss 0.233, Train_accy 92.66:  40%|████      | 8/20 [05:43<07:35, 37.96s/it]
Task 0, Epoch 9/20 => Loss 0.233, Train_accy 92.66:  45%|████▌     | 9/20 [05:43<06:56, 37.82s/it]
Task 0, Epoch 10/20 => Loss 0.233, Train_accy 92.24:  45%|████▌     | 9/20 [06:20<06:56, 37.82s/it]
Task 0, Epoch 10/20 => Loss 0.233, Train_accy 92.24:  50%|█████     | 10/20 [06:20<06:17, 37.72s/it]
Task 0, Epoch 11/20 => Loss 0.204, Train_accy 93.36, Test_accy 97.80:  50%|█████     | 10/20 [07:01<06:17, 37.72s/it]
Task 0, Epoch 11/20 => Loss 0.204, Train_accy 93.36, Test_accy 97.80:  55%|█████▌    | 11/20 [07:01<05:46, 38.55s/it]
Task 0, Epoch 12/20 => Loss 0.226, Train_accy 92.96:  55%|█████▌    | 11/20 [07:38<05:46, 38.55s/it]                 
Task 0, Epoch 12/20 => Loss 0.226, Train_accy 92.96:  60%|██████    | 12/20 [07:38<05:05, 38.22s/it]
Task 0, Epoch 13/20 => Loss 0.199, Train_accy 93.66:  60%|██████    | 12/20 [08:16<05:05, 38.22s/it]
Task 0, Epoch 13/20 => Loss 0.199, Train_accy 93.66:  65%|██████▌   | 13/20 [08:16<04:25, 37.99s/it]
Task 0, Epoch 14/20 => Loss 0.204, Train_accy 93.44:  65%|██████▌   | 13/20 [08:53<04:25, 37.99s/it]
Task 0, Epoch 14/20 => Loss 0.204, Train_accy 93.44:  70%|███████   | 14/20 [08:53<03:46, 37.79s/it]
Task 0, Epoch 15/20 => Loss 0.194, Train_accy 93.72:  70%|███████   | 14/20 [09:30<03:46, 37.79s/it]
Task 0, Epoch 15/20 => Loss 0.194, Train_accy 93.72:  75%|███████▌  | 15/20 [09:30<03:08, 37.64s/it]
Task 0, Epoch 16/20 => Loss 0.182, Train_accy 94.24, Test_accy 98.70:  75%|███████▌  | 15/20 [10:11<03:08, 37.64s/it]
Task 0, Epoch 16/20 => Loss 0.182, Train_accy 94.24, Test_accy 98.70:  80%|████████  | 16/20 [10:11<02:34, 38.53s/it]
Task 0, Epoch 17/20 => Loss 0.191, Train_accy 93.82:  80%|████████  | 16/20 [10:48<02:34, 38.53s/it]                 
Task 0, Epoch 17/20 => Loss 0.191, Train_accy 93.82:  85%|████████▌ | 17/20 [10:48<01:54, 38.23s/it]
Task 0, Epoch 18/20 => Loss 0.198, Train_accy 93.68:  85%|████████▌ | 17/20 [11:26<01:54, 38.23s/it]
Task 0, Epoch 18/20 => Loss 0.198, Train_accy 93.68:  90%|█████████ | 18/20 [11:26<01:15, 37.99s/it]
Task 0, Epoch 19/20 => Loss 0.185, Train_accy 94.34:  90%|█████████ | 18/20 [12:03<01:15, 37.99s/it]
Task 0, Epoch 19/20 => Loss 0.185, Train_accy 94.34:  95%|█████████▌| 19/20 [12:03<00:37, 37.82s/it]
Task 0, Epoch 20/20 => Loss 0.179, Train_accy 94.44:  95%|█████████▌| 19/20 [12:41<00:37, 37.82s/it]
Task 0, Epoch 20/20 => Loss 0.179, Train_accy 94.44: 100%|██████████| 20/20 [12:41<00:00, 37.70s/it]
Task 0, Epoch 20/20 => Loss 0.179, Train_accy 94.44: 100%|██████████| 20/20 [12:41<00:00, 38.06s/it]
2024-09-04 13:05:10,700 [der.py] => Task 0, Epoch 20/20 => Loss 0.179, Train_accy 94.44
2024-09-04 13:05:10,701 [base.py] => Reducing exemplars...(200 per classes)
2024-09-04 13:05:10,701 [base.py] => Constructing exemplars...(200 per classes)
2024-09-04 13:05:43,858 [der.py] => Exemplar size: 2000
2024-09-04 13:05:43,858 [trainer.py] => CNN: {'total': 98.2, '00-09': 98.2, 'old': 0, 'new': 98.2}
2024-09-04 13:05:43,858 [trainer.py] => NME: {'total': 98.4, '00-09': 98.4, 'old': 0, 'new': 98.4}
2024-09-04 13:05:43,858 [trainer.py] => CNN top1 curve: [98.2]
2024-09-04 13:05:43,858 [trainer.py] => CNN top5 curve: [100.0]
2024-09-04 13:05:43,858 [trainer.py] => NME top1 curve: [98.4]
2024-09-04 13:05:43,858 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 98.2
Average Accuracy (NME): 98.4
2024-09-04 13:05:43,858 [trainer.py] => Average Accuracy (CNN): 98.2
2024-09-04 13:05:43,858 [trainer.py] => Average Accuracy (NME): 98.4
2024-09-04 13:05:43,859 [trainer.py] => All params: 85814805
2024-09-04 13:05:43,860 [trainer.py] => Trainable params: 85814805
2024-09-04 13:05:45,875 [der.py] => Learning on 10-20
2024-09-04 13:05:45,876 [der.py] => All params: 171636511
2024-09-04 13:05:45,877 [der.py] => Trainable params: 85837855

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.572, Loss_clf 0.800, Loss_aux 0.772, Train_accy 76.99, Test_accy 93.70:   0%|          | 0/20 [01:21<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.572, Loss_clf 0.800, Loss_aux 0.772, Train_accy 76.99, Test_accy 93.70:   5%|▌         | 1/20 [01:21<25:51, 81.68s/it]
Task 1, Epoch 2/20 => Loss 0.889, Loss_clf 0.430, Loss_aux 0.459, Train_accy 86.57:   5%|▌         | 1/20 [02:31<25:51, 81.68s/it]                 
Task 1, Epoch 2/20 => Loss 0.889, Loss_clf 0.430, Loss_aux 0.459, Train_accy 86.57:  10%|█         | 2/20 [02:31<22:29, 74.98s/it]
Task 1, Epoch 3/20 => Loss 0.793, Loss_clf 0.391, Loss_aux 0.402, Train_accy 87.66:  10%|█         | 2/20 [03:42<22:29, 74.98s/it]
Task 1, Epoch 3/20 => Loss 0.793, Loss_clf 0.391, Loss_aux 0.402, Train_accy 87.66:  15%|█▌        | 3/20 [03:42<20:38, 72.86s/it]
Task 1, Epoch 4/20 => Loss 0.767, Loss_clf 0.378, Loss_aux 0.389, Train_accy 88.37:  15%|█▌        | 3/20 [04:52<20:38, 72.86s/it]
Task 1, Epoch 4/20 => Loss 0.767, Loss_clf 0.378, Loss_aux 0.389, Train_accy 88.37:  20%|██        | 4/20 [04:52<19:09, 71.85s/it]
Task 1, Epoch 5/20 => Loss 0.705, Loss_clf 0.349, Loss_aux 0.356, Train_accy 89.09:  20%|██        | 4/20 [06:02<19:09, 71.85s/it]
Task 1, Epoch 5/20 => Loss 0.705, Loss_clf 0.349, Loss_aux 0.356, Train_accy 89.09:  25%|██▌       | 5/20 [06:02<17:48, 71.26s/it]
Task 1, Epoch 6/20 => Loss 0.704, Loss_clf 0.350, Loss_aux 0.354, Train_accy 88.81, Test_accy 94.80:  25%|██▌       | 5/20 [07:24<17:48, 71.26s/it]
Task 1, Epoch 6/20 => Loss 0.704, Loss_clf 0.350, Loss_aux 0.354, Train_accy 88.81, Test_accy 94.80:  30%|███       | 6/20 [07:24<17:25, 74.64s/it]
Task 1, Epoch 7/20 => Loss 0.662, Loss_clf 0.326, Loss_aux 0.336, Train_accy 89.71:  30%|███       | 6/20 [08:34<17:25, 74.64s/it]                 
Task 1, Epoch 7/20 => Loss 0.662, Loss_clf 0.326, Loss_aux 0.336, Train_accy 89.71:  35%|███▌      | 7/20 [08:34<15:51, 73.18s/it]
Task 1, Epoch 8/20 => Loss 0.610, Loss_clf 0.304, Loss_aux 0.306, Train_accy 90.36:  35%|███▌      | 7/20 [09:44<15:51, 73.18s/it]
Task 1, Epoch 8/20 => Loss 0.610, Loss_clf 0.304, Loss_aux 0.306, Train_accy 90.36:  40%|████      | 8/20 [09:44<14:26, 72.23s/it]
Task 1, Epoch 9/20 => Loss 0.644, Loss_clf 0.326, Loss_aux 0.318, Train_accy 89.74:  40%|████      | 8/20 [10:54<14:26, 72.23s/it]
Task 1, Epoch 9/20 => Loss 0.644, Loss_clf 0.326, Loss_aux 0.318, Train_accy 89.74:  45%|████▌     | 9/20 [10:54<13:08, 71.66s/it]
Task 1, Epoch 10/20 => Loss 0.582, Loss_clf 0.298, Loss_aux 0.284, Train_accy 91.04:  45%|████▌     | 9/20 [12:05<13:08, 71.66s/it]
Task 1, Epoch 10/20 => Loss 0.582, Loss_clf 0.298, Loss_aux 0.284, Train_accy 91.04:  50%|█████     | 10/20 [12:05<11:52, 71.25s/it]
Task 1, Epoch 11/20 => Loss 0.604, Loss_clf 0.303, Loss_aux 0.301, Train_accy 90.31, Test_accy 95.60:  50%|█████     | 10/20 [13:26<11:52, 71.25s/it]
Task 1, Epoch 11/20 => Loss 0.604, Loss_clf 0.303, Loss_aux 0.301, Train_accy 90.31, Test_accy 95.60:  55%|█████▌    | 11/20 [13:26<11:09, 74.37s/it]
Task 1, Epoch 12/20 => Loss 0.552, Loss_clf 0.280, Loss_aux 0.272, Train_accy 91.31:  55%|█████▌    | 11/20 [14:36<11:09, 74.37s/it]                 
Task 1, Epoch 12/20 => Loss 0.552, Loss_clf 0.280, Loss_aux 0.272, Train_accy 91.31:  60%|██████    | 12/20 [14:36<09:45, 73.16s/it]
Task 1, Epoch 13/20 => Loss 0.569, Loss_clf 0.284, Loss_aux 0.285, Train_accy 91.27:  60%|██████    | 12/20 [15:47<09:45, 73.16s/it]
Task 1, Epoch 13/20 => Loss 0.569, Loss_clf 0.284, Loss_aux 0.285, Train_accy 91.27:  65%|██████▌   | 13/20 [15:47<08:25, 72.27s/it]
Task 1, Epoch 14/20 => Loss 0.543, Loss_clf 0.277, Loss_aux 0.266, Train_accy 91.47:  65%|██████▌   | 13/20 [16:57<08:25, 72.27s/it]
Task 1, Epoch 14/20 => Loss 0.543, Loss_clf 0.277, Loss_aux 0.266, Train_accy 91.47:  70%|███████   | 14/20 [16:57<07:09, 71.66s/it]
Task 1, Epoch 15/20 => Loss 0.535, Loss_clf 0.265, Loss_aux 0.270, Train_accy 91.33:  70%|███████   | 14/20 [18:07<07:09, 71.66s/it]
Task 1, Epoch 15/20 => Loss 0.535, Loss_clf 0.265, Loss_aux 0.270, Train_accy 91.33:  75%|███████▌  | 15/20 [18:07<05:56, 71.29s/it]
Task 1, Epoch 16/20 => Loss 0.516, Loss_clf 0.263, Loss_aux 0.252, Train_accy 91.83, Test_accy 96.10:  75%|███████▌  | 15/20 [19:29<05:56, 71.29s/it]
Task 1, Epoch 16/20 => Loss 0.516, Loss_clf 0.263, Loss_aux 0.252, Train_accy 91.83, Test_accy 96.10:  80%|████████  | 16/20 [19:29<04:57, 74.41s/it]
Task 1, Epoch 17/20 => Loss 0.521, Loss_clf 0.266, Loss_aux 0.255, Train_accy 91.56:  80%|████████  | 16/20 [20:39<04:57, 74.41s/it]                 
Task 1, Epoch 17/20 => Loss 0.521, Loss_clf 0.266, Loss_aux 0.255, Train_accy 91.56:  85%|████████▌ | 17/20 [20:39<03:39, 73.19s/it]
Task 1, Epoch 18/20 => Loss 0.504, Loss_clf 0.259, Loss_aux 0.246, Train_accy 91.97:  85%|████████▌ | 17/20 [21:50<03:39, 73.19s/it]
Task 1, Epoch 18/20 => Loss 0.504, Loss_clf 0.259, Loss_aux 0.246, Train_accy 91.97:  90%|█████████ | 18/20 [21:50<02:24, 72.31s/it]
Task 1, Epoch 19/20 => Loss 0.534, Loss_clf 0.277, Loss_aux 0.258, Train_accy 91.49:  90%|█████████ | 18/20 [23:00<02:24, 72.31s/it]
Task 1, Epoch 19/20 => Loss 0.534, Loss_clf 0.277, Loss_aux 0.258, Train_accy 91.49:  95%|█████████▌| 19/20 [23:00<01:11, 71.69s/it]
Task 1, Epoch 20/20 => Loss 0.476, Loss_clf 0.240, Loss_aux 0.236, Train_accy 92.24:  95%|█████████▌| 19/20 [24:10<01:11, 71.69s/it]
Task 1, Epoch 20/20 => Loss 0.476, Loss_clf 0.240, Loss_aux 0.236, Train_accy 92.24: 100%|██████████| 20/20 [24:10<00:00, 71.26s/it]
Task 1, Epoch 20/20 => Loss 0.476, Loss_clf 0.240, Loss_aux 0.236, Train_accy 92.24: 100%|██████████| 20/20 [24:10<00:00, 72.53s/it]
2024-09-04 13:29:56,618 [der.py] => Task 1, Epoch 20/20 => Loss 0.476, Loss_clf 0.240, Loss_aux 0.236, Train_accy 92.24
2024-09-04 13:29:56,619 [base.py] => Reducing exemplars...(100 per classes)
2024-09-04 13:30:04,687 [base.py] => Constructing exemplars...(100 per classes)
2024-09-04 13:31:06,660 [der.py] => Exemplar size: 2000
2024-09-04 13:31:06,661 [trainer.py] => CNN: {'total': 95.75, '00-09': 95.4, '10-19': 96.1, 'old': 95.4, 'new': 96.1}
2024-09-04 13:31:06,661 [trainer.py] => NME: {'total': 96.0, '00-09': 97.0, '10-19': 95.0, 'old': 97.0, 'new': 95.0}
2024-09-04 13:31:06,661 [trainer.py] => CNN top1 curve: [98.2, 95.75]
2024-09-04 13:31:06,661 [trainer.py] => CNN top5 curve: [100.0, 99.7]
2024-09-04 13:31:06,661 [trainer.py] => NME top1 curve: [98.4, 96.0]
2024-09-04 13:31:06,661 [trainer.py] => NME top5 curve: [100.0, 99.55]

Average Accuracy (CNN): 96.98
Average Accuracy (NME): 97.2
2024-09-04 13:31:06,661 [trainer.py] => Average Accuracy (CNN): 96.98
2024-09-04 13:31:06,661 [trainer.py] => Average Accuracy (NME): 97.2
2024-09-04 13:31:06,662 [trainer.py] => All params: 171636511
2024-09-04 13:31:06,663 [trainer.py] => Trainable params: 85837855
2024-09-04 13:31:08,308 [der.py] => Learning on 20-30
2024-09-04 13:31:08,310 [der.py] => All params: 257473577
2024-09-04 13:31:08,311 [der.py] => Trainable params: 85876265

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.425, Loss_clf 0.816, Loss_aux 0.609, Train_accy 81.34, Test_accy 93.57:   0%|          | 0/20 [01:52<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.425, Loss_clf 0.816, Loss_aux 0.609, Train_accy 81.34, Test_accy 93.57:   5%|▌         | 1/20 [01:52<35:34, 112.34s/it]
Task 2, Epoch 2/20 => Loss 0.671, Loss_clf 0.347, Loss_aux 0.325, Train_accy 89.66:   5%|▌         | 1/20 [03:20<35:34, 112.34s/it]                 
Task 2, Epoch 2/20 => Loss 0.671, Loss_clf 0.347, Loss_aux 0.325, Train_accy 89.66:  10%|█         | 2/20 [03:20<29:26, 98.16s/it] 
Task 2, Epoch 3/20 => Loss 0.606, Loss_clf 0.316, Loss_aux 0.291, Train_accy 90.64:  10%|█         | 2/20 [04:49<29:26, 98.16s/it]
Task 2, Epoch 3/20 => Loss 0.606, Loss_clf 0.316, Loss_aux 0.291, Train_accy 90.64:  15%|█▌        | 3/20 [04:49<26:33, 93.73s/it]
Task 2, Epoch 4/20 => Loss 0.548, Loss_clf 0.284, Loss_aux 0.265, Train_accy 91.57:  15%|█▌        | 3/20 [06:17<26:33, 93.73s/it]
Task 2, Epoch 4/20 => Loss 0.548, Loss_clf 0.284, Loss_aux 0.265, Train_accy 91.57:  20%|██        | 4/20 [06:17<24:25, 91.60s/it]
Task 2, Epoch 5/20 => Loss 0.546, Loss_clf 0.284, Loss_aux 0.262, Train_accy 91.61:  20%|██        | 4/20 [07:45<24:25, 91.60s/it]
Task 2, Epoch 5/20 => Loss 0.546, Loss_clf 0.284, Loss_aux 0.262, Train_accy 91.61:  25%|██▌       | 5/20 [07:45<22:36, 90.44s/it]
Task 2, Epoch 6/20 => Loss 0.534, Loss_clf 0.281, Loss_aux 0.253, Train_accy 91.37, Test_accy 93.63:  25%|██▌       | 5/20 [09:38<22:36, 90.44s/it]
Task 2, Epoch 6/20 => Loss 0.534, Loss_clf 0.281, Loss_aux 0.253, Train_accy 91.37, Test_accy 93.63:  30%|███       | 6/20 [09:38<22:51, 97.99s/it]
Task 2, Epoch 7/20 => Loss 0.490, Loss_clf 0.258, Loss_aux 0.232, Train_accy 92.11:  30%|███       | 6/20 [11:06<22:51, 97.99s/it]                 
Task 2, Epoch 7/20 => Loss 0.490, Loss_clf 0.258, Loss_aux 0.232, Train_accy 92.11:  35%|███▌      | 7/20 [11:06<20:32, 94.84s/it]
Task 2, Epoch 8/20 => Loss 0.452, Loss_clf 0.240, Loss_aux 0.212, Train_accy 92.77:  35%|███▌      | 7/20 [12:34<20:32, 94.84s/it]
Task 2, Epoch 8/20 => Loss 0.452, Loss_clf 0.240, Loss_aux 0.212, Train_accy 92.77:  40%|████      | 8/20 [12:34<18:32, 92.73s/it]
Task 2, Epoch 9/20 => Loss 0.488, Loss_clf 0.257, Loss_aux 0.231, Train_accy 92.04:  40%|████      | 8/20 [14:03<18:32, 92.73s/it]
Task 2, Epoch 9/20 => Loss 0.488, Loss_clf 0.257, Loss_aux 0.231, Train_accy 92.04:  45%|████▌     | 9/20 [14:03<16:44, 91.34s/it]
Task 2, Epoch 10/20 => Loss 0.464, Loss_clf 0.248, Loss_aux 0.216, Train_accy 92.50:  45%|████▌     | 9/20 [15:31<16:44, 91.34s/it]
Task 2, Epoch 10/20 => Loss 0.464, Loss_clf 0.248, Loss_aux 0.216, Train_accy 92.50:  50%|█████     | 10/20 [15:31<15:04, 90.43s/it]
Task 2, Epoch 11/20 => Loss 0.480, Loss_clf 0.262, Loss_aux 0.218, Train_accy 92.26, Test_accy 94.83:  50%|█████     | 10/20 [17:24<15:04, 90.43s/it]
Task 2, Epoch 11/20 => Loss 0.480, Loss_clf 0.262, Loss_aux 0.218, Train_accy 92.26, Test_accy 94.83:  55%|█████▌    | 11/20 [17:24<14:35, 97.23s/it]
Task 2, Epoch 12/20 => Loss 0.429, Loss_clf 0.225, Loss_aux 0.203, Train_accy 93.23:  55%|█████▌    | 11/20 [18:52<14:35, 97.23s/it]                 
Task 2, Epoch 12/20 => Loss 0.429, Loss_clf 0.225, Loss_aux 0.203, Train_accy 93.23:  60%|██████    | 12/20 [18:52<12:36, 94.51s/it]
Task 2, Epoch 13/20 => Loss 0.452, Loss_clf 0.240, Loss_aux 0.212, Train_accy 92.83:  60%|██████    | 12/20 [20:20<12:36, 94.51s/it]
Task 2, Epoch 13/20 => Loss 0.452, Loss_clf 0.240, Loss_aux 0.212, Train_accy 92.83:  65%|██████▌   | 13/20 [20:20<10:48, 92.60s/it]
Task 2, Epoch 14/20 => Loss 0.452, Loss_clf 0.238, Loss_aux 0.214, Train_accy 92.87:  65%|██████▌   | 13/20 [21:49<10:48, 92.60s/it]
Task 2, Epoch 14/20 => Loss 0.452, Loss_clf 0.238, Loss_aux 0.214, Train_accy 92.87:  70%|███████   | 14/20 [21:49<09:07, 91.32s/it]
Task 2, Epoch 15/20 => Loss 0.427, Loss_clf 0.233, Loss_aux 0.195, Train_accy 92.97:  70%|███████   | 14/20 [23:17<09:07, 91.32s/it]
Task 2, Epoch 15/20 => Loss 0.427, Loss_clf 0.233, Loss_aux 0.195, Train_accy 92.97:  75%|███████▌  | 15/20 [23:17<07:32, 90.45s/it]
Task 2, Epoch 16/20 => Loss 0.408, Loss_clf 0.217, Loss_aux 0.190, Train_accy 93.50, Test_accy 94.57:  75%|███████▌  | 15/20 [25:10<07:32, 90.45s/it]
Task 2, Epoch 16/20 => Loss 0.408, Loss_clf 0.217, Loss_aux 0.190, Train_accy 93.50, Test_accy 94.57:  80%|████████  | 16/20 [25:10<06:28, 97.13s/it]
Task 2, Epoch 17/20 => Loss 0.407, Loss_clf 0.218, Loss_aux 0.188, Train_accy 93.71:  80%|████████  | 16/20 [26:38<06:28, 97.13s/it]                 
Task 2, Epoch 17/20 => Loss 0.407, Loss_clf 0.218, Loss_aux 0.188, Train_accy 93.71:  85%|████████▌ | 17/20 [26:38<04:43, 94.45s/it]
Task 2, Epoch 18/20 => Loss 0.424, Loss_clf 0.228, Loss_aux 0.196, Train_accy 93.50:  85%|████████▌ | 17/20 [28:06<04:43, 94.45s/it]
Task 2, Epoch 18/20 => Loss 0.424, Loss_clf 0.228, Loss_aux 0.196, Train_accy 93.50:  90%|█████████ | 18/20 [28:06<03:05, 92.63s/it]
Task 2, Epoch 19/20 => Loss 0.422, Loss_clf 0.226, Loss_aux 0.195, Train_accy 93.29:  90%|█████████ | 18/20 [29:35<03:05, 92.63s/it]
Task 2, Epoch 19/20 => Loss 0.422, Loss_clf 0.226, Loss_aux 0.195, Train_accy 93.29:  95%|█████████▌| 19/20 [29:35<01:31, 91.34s/it]
Task 2, Epoch 20/20 => Loss 0.429, Loss_clf 0.232, Loss_aux 0.197, Train_accy 93.09:  95%|█████████▌| 19/20 [31:03<01:31, 91.34s/it]
Task 2, Epoch 20/20 => Loss 0.429, Loss_clf 0.232, Loss_aux 0.197, Train_accy 93.09: 100%|██████████| 20/20 [31:03<00:00, 90.42s/it]
Task 2, Epoch 20/20 => Loss 0.429, Loss_clf 0.232, Loss_aux 0.197, Train_accy 93.09: 100%|██████████| 20/20 [31:03<00:00, 93.17s/it]
2024-09-04 14:02:11,847 [der.py] => Task 2, Epoch 20/20 => Loss 0.429, Loss_clf 0.232, Loss_aux 0.197, Train_accy 93.09
2024-09-04 14:02:11,849 [base.py] => Reducing exemplars...(66 per classes)
2024-09-04 14:02:28,625 [base.py] => Constructing exemplars...(66 per classes)
2024-09-04 14:04:10,764 [der.py] => Exemplar size: 1980
2024-09-04 14:04:10,764 [trainer.py] => CNN: {'total': 94.87, '00-09': 93.2, '10-19': 92.5, '20-29': 98.9, 'old': 92.85, 'new': 98.9}
2024-09-04 14:04:10,764 [trainer.py] => NME: {'total': 95.47, '00-09': 95.1, '10-19': 94.0, '20-29': 97.3, 'old': 94.55, 'new': 97.3}
2024-09-04 14:04:10,764 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87]
2024-09-04 14:04:10,764 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3]
2024-09-04 14:04:10,764 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47]
2024-09-04 14:04:10,764 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53]

Average Accuracy (CNN): 96.27
Average Accuracy (NME): 96.62
2024-09-04 14:04:10,764 [trainer.py] => Average Accuracy (CNN): 96.27
2024-09-04 14:04:10,764 [trainer.py] => Average Accuracy (NME): 96.62
2024-09-04 14:04:10,766 [trainer.py] => All params: 257473577
2024-09-04 14:04:10,767 [trainer.py] => Trainable params: 85876265
2024-09-04 14:04:12,291 [der.py] => Learning on 30-40
2024-09-04 14:04:12,295 [der.py] => All params: 343326003
2024-09-04 14:04:12,296 [der.py] => Trainable params: 85930035

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.597, Loss_clf 0.924, Loss_aux 0.673, Train_accy 78.04, Test_accy 90.98:   0%|          | 0/20 [02:28<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.597, Loss_clf 0.924, Loss_aux 0.673, Train_accy 78.04, Test_accy 90.98:   5%|▌         | 1/20 [02:28<46:56, 148.23s/it]
Task 3, Epoch 2/20 => Loss 0.778, Loss_clf 0.413, Loss_aux 0.365, Train_accy 86.92:   5%|▌         | 1/20 [04:14<46:56, 148.23s/it]                 
Task 3, Epoch 2/20 => Loss 0.778, Loss_clf 0.413, Loss_aux 0.365, Train_accy 86.92:  10%|█         | 2/20 [04:14<36:59, 123.33s/it]
Task 3, Epoch 3/20 => Loss 0.678, Loss_clf 0.362, Loss_aux 0.316, Train_accy 88.84:  10%|█         | 2/20 [06:00<36:59, 123.33s/it]
Task 3, Epoch 3/20 => Loss 0.678, Loss_clf 0.362, Loss_aux 0.316, Train_accy 88.84:  15%|█▌        | 3/20 [06:00<32:42, 115.41s/it]
Task 3, Epoch 4/20 => Loss 0.643, Loss_clf 0.339, Loss_aux 0.304, Train_accy 89.71:  15%|█▌        | 3/20 [07:46<32:42, 115.41s/it]
Task 3, Epoch 4/20 => Loss 0.643, Loss_clf 0.339, Loss_aux 0.304, Train_accy 89.71:  20%|██        | 4/20 [07:46<29:48, 111.78s/it]
Task 3, Epoch 5/20 => Loss 0.623, Loss_clf 0.330, Loss_aux 0.293, Train_accy 90.09:  20%|██        | 4/20 [09:32<29:48, 111.78s/it]
Task 3, Epoch 5/20 => Loss 0.623, Loss_clf 0.330, Loss_aux 0.293, Train_accy 90.09:  25%|██▌       | 5/20 [09:32<27:26, 109.80s/it]
Task 3, Epoch 6/20 => Loss 0.601, Loss_clf 0.313, Loss_aux 0.289, Train_accy 90.62, Test_accy 92.35:  25%|██▌       | 5/20 [12:01<27:26, 109.80s/it]
Task 3, Epoch 6/20 => Loss 0.601, Loss_clf 0.313, Loss_aux 0.289, Train_accy 90.62, Test_accy 92.35:  30%|███       | 6/20 [12:01<28:41, 122.94s/it]
Task 3, Epoch 7/20 => Loss 0.576, Loss_clf 0.312, Loss_aux 0.265, Train_accy 90.47:  30%|███       | 6/20 [13:47<28:41, 122.94s/it]                 
Task 3, Epoch 7/20 => Loss 0.576, Loss_clf 0.312, Loss_aux 0.265, Train_accy 90.47:  35%|███▌      | 7/20 [13:47<25:29, 117.64s/it]
Task 3, Epoch 8/20 => Loss 0.540, Loss_clf 0.292, Loss_aux 0.248, Train_accy 91.17:  35%|███▌      | 7/20 [15:33<25:29, 117.64s/it]
Task 3, Epoch 8/20 => Loss 0.540, Loss_clf 0.292, Loss_aux 0.248, Train_accy 91.17:  40%|████      | 8/20 [15:33<22:46, 113.92s/it]
Task 3, Epoch 9/20 => Loss 0.564, Loss_clf 0.304, Loss_aux 0.260, Train_accy 90.86:  40%|████      | 8/20 [17:19<22:46, 113.92s/it]
Task 3, Epoch 9/20 => Loss 0.564, Loss_clf 0.304, Loss_aux 0.260, Train_accy 90.86:  45%|████▌     | 9/20 [17:19<20:26, 111.49s/it]
Task 3, Epoch 10/20 => Loss 0.515, Loss_clf 0.275, Loss_aux 0.240, Train_accy 91.48:  45%|████▌     | 9/20 [19:05<20:26, 111.49s/it]
Task 3, Epoch 10/20 => Loss 0.515, Loss_clf 0.275, Loss_aux 0.240, Train_accy 91.48:  50%|█████     | 10/20 [19:05<18:18, 109.81s/it]
Task 3, Epoch 11/20 => Loss 0.504, Loss_clf 0.273, Loss_aux 0.232, Train_accy 91.83, Test_accy 92.75:  50%|█████     | 10/20 [21:34<18:18, 109.81s/it]
Task 3, Epoch 11/20 => Loss 0.504, Loss_clf 0.273, Loss_aux 0.232, Train_accy 91.83, Test_accy 92.75:  55%|█████▌    | 11/20 [21:34<18:14, 121.57s/it]
Task 3, Epoch 12/20 => Loss 0.518, Loss_clf 0.277, Loss_aux 0.241, Train_accy 91.48:  55%|█████▌    | 11/20 [23:20<18:14, 121.57s/it]                 
Task 3, Epoch 12/20 => Loss 0.518, Loss_clf 0.277, Loss_aux 0.241, Train_accy 91.48:  60%|██████    | 12/20 [23:20<15:35, 116.90s/it]
Task 3, Epoch 13/20 => Loss 0.452, Loss_clf 0.242, Loss_aux 0.210, Train_accy 92.34:  60%|██████    | 12/20 [25:06<15:35, 116.90s/it]
Task 3, Epoch 13/20 => Loss 0.452, Loss_clf 0.242, Loss_aux 0.210, Train_accy 92.34:  65%|██████▌   | 13/20 [25:06<13:15, 113.63s/it]
Task 3, Epoch 14/20 => Loss 0.510, Loss_clf 0.274, Loss_aux 0.236, Train_accy 91.72:  65%|██████▌   | 13/20 [26:52<13:15, 113.63s/it]
Task 3, Epoch 14/20 => Loss 0.510, Loss_clf 0.274, Loss_aux 0.236, Train_accy 91.72:  70%|███████   | 14/20 [26:52<11:08, 111.42s/it]
Task 3, Epoch 15/20 => Loss 0.483, Loss_clf 0.264, Loss_aux 0.219, Train_accy 92.25:  70%|███████   | 14/20 [28:38<11:08, 111.42s/it]
Task 3, Epoch 15/20 => Loss 0.483, Loss_clf 0.264, Loss_aux 0.219, Train_accy 92.25:  75%|███████▌  | 15/20 [28:38<09:08, 109.76s/it]
Task 3, Epoch 16/20 => Loss 0.430, Loss_clf 0.229, Loss_aux 0.201, Train_accy 92.89, Test_accy 91.08:  75%|███████▌  | 15/20 [31:07<09:08, 109.76s/it]
Task 3, Epoch 16/20 => Loss 0.430, Loss_clf 0.229, Loss_aux 0.201, Train_accy 92.89, Test_accy 91.08:  80%|████████  | 16/20 [31:07<08:05, 121.36s/it]
Task 3, Epoch 17/20 => Loss 0.452, Loss_clf 0.241, Loss_aux 0.211, Train_accy 92.81:  80%|████████  | 16/20 [32:52<08:05, 121.36s/it]                 
Task 3, Epoch 17/20 => Loss 0.452, Loss_clf 0.241, Loss_aux 0.211, Train_accy 92.81:  85%|████████▌ | 17/20 [32:52<05:50, 116.72s/it]
Task 3, Epoch 18/20 => Loss 0.451, Loss_clf 0.245, Loss_aux 0.207, Train_accy 92.79:  85%|████████▌ | 17/20 [34:39<05:50, 116.72s/it]
Task 3, Epoch 18/20 => Loss 0.451, Loss_clf 0.245, Loss_aux 0.207, Train_accy 92.79:  90%|█████████ | 18/20 [34:39<03:47, 113.63s/it]
Task 3, Epoch 19/20 => Loss 0.452, Loss_clf 0.243, Loss_aux 0.210, Train_accy 92.56:  90%|█████████ | 18/20 [36:25<03:47, 113.63s/it]
Task 3, Epoch 19/20 => Loss 0.452, Loss_clf 0.243, Loss_aux 0.210, Train_accy 92.56:  95%|█████████▌| 19/20 [36:25<01:51, 111.39s/it]
Task 3, Epoch 20/20 => Loss 0.468, Loss_clf 0.254, Loss_aux 0.213, Train_accy 92.62:  95%|█████████▌| 19/20 [38:11<01:51, 111.39s/it]
Task 3, Epoch 20/20 => Loss 0.468, Loss_clf 0.254, Loss_aux 0.213, Train_accy 92.62: 100%|██████████| 20/20 [38:11<00:00, 109.76s/it]
Task 3, Epoch 20/20 => Loss 0.468, Loss_clf 0.254, Loss_aux 0.213, Train_accy 92.62: 100%|██████████| 20/20 [38:11<00:00, 114.58s/it]
2024-09-04 14:42:23,943 [der.py] => Task 3, Epoch 20/20 => Loss 0.468, Loss_clf 0.254, Loss_aux 0.213, Train_accy 92.62
2024-09-04 14:42:23,945 [base.py] => Reducing exemplars...(50 per classes)
2024-09-04 14:42:48,017 [base.py] => Constructing exemplars...(50 per classes)
2024-09-04 14:45:19,288 [der.py] => Exemplar size: 2000
2024-09-04 14:45:19,288 [trainer.py] => CNN: {'total': 92.8, '00-09': 90.3, '10-19': 89.8, '20-29': 95.1, '30-39': 96.0, 'old': 91.73, 'new': 96.0}
2024-09-04 14:45:19,288 [trainer.py] => NME: {'total': 93.32, '00-09': 92.9, '10-19': 92.2, '20-29': 96.5, '30-39': 91.7, 'old': 93.87, 'new': 91.7}
2024-09-04 14:45:19,288 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87, 92.8]
2024-09-04 14:45:19,288 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3, 99.0]
2024-09-04 14:45:19,288 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47, 93.32]
2024-09-04 14:45:19,288 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53, 99.42]

Average Accuracy (CNN): 95.4
Average Accuracy (NME): 95.8
2024-09-04 14:45:19,289 [trainer.py] => Average Accuracy (CNN): 95.4
2024-09-04 14:45:19,289 [trainer.py] => Average Accuracy (NME): 95.8
2024-09-04 14:45:19,291 [trainer.py] => All params: 343326003
2024-09-04 14:45:19,293 [trainer.py] => Trainable params: 85930035
2024-09-04 14:45:20,814 [der.py] => Learning on 40-50
2024-09-04 14:45:20,819 [der.py] => All params: 429193789
2024-09-04 14:45:20,821 [der.py] => Trainable params: 85999165

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.474, Loss_clf 0.893, Loss_aux 0.581, Train_accy 80.87, Test_accy 89.56:   0%|          | 0/20 [03:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.474, Loss_clf 0.893, Loss_aux 0.581, Train_accy 80.87, Test_accy 89.56:   5%|▌         | 1/20 [03:10<1:00:11, 190.06s/it]
Task 4, Epoch 2/20 => Loss 0.721, Loss_clf 0.390, Loss_aux 0.332, Train_accy 88.49:   5%|▌         | 1/20 [05:14<1:00:11, 190.06s/it]                 
Task 4, Epoch 2/20 => Loss 0.721, Loss_clf 0.390, Loss_aux 0.332, Train_accy 88.49:  10%|█         | 2/20 [05:14<45:25, 151.42s/it]  
Task 4, Epoch 3/20 => Loss 0.621, Loss_clf 0.338, Loss_aux 0.283, Train_accy 89.94:  10%|█         | 2/20 [07:18<45:25, 151.42s/it]
Task 4, Epoch 3/20 => Loss 0.621, Loss_clf 0.338, Loss_aux 0.283, Train_accy 89.94:  15%|█▌        | 3/20 [07:18<39:23, 139.04s/it]
Task 4, Epoch 4/20 => Loss 0.607, Loss_clf 0.327, Loss_aux 0.280, Train_accy 90.80:  15%|█▌        | 3/20 [09:22<39:23, 139.04s/it]
Task 4, Epoch 4/20 => Loss 0.607, Loss_clf 0.327, Loss_aux 0.280, Train_accy 90.80:  20%|██        | 4/20 [09:22<35:30, 133.17s/it]
Task 4, Epoch 5/20 => Loss 0.561, Loss_clf 0.302, Loss_aux 0.258, Train_accy 91.19:  20%|██        | 4/20 [11:27<35:30, 133.17s/it]
Task 4, Epoch 5/20 => Loss 0.561, Loss_clf 0.302, Loss_aux 0.258, Train_accy 91.19:  25%|██▌       | 5/20 [11:27<32:29, 129.94s/it]
Task 4, Epoch 6/20 => Loss 0.557, Loss_clf 0.298, Loss_aux 0.259, Train_accy 91.11, Test_accy 90.36:  25%|██▌       | 5/20 [14:37<32:29, 129.94s/it]
Task 4, Epoch 6/20 => Loss 0.557, Loss_clf 0.298, Loss_aux 0.259, Train_accy 91.11, Test_accy 90.36:  30%|███       | 6/20 [14:37<35:05, 150.36s/it]
Task 4, Epoch 7/20 => Loss 0.521, Loss_clf 0.285, Loss_aux 0.236, Train_accy 91.90:  30%|███       | 6/20 [16:41<35:05, 150.36s/it]                 
Task 4, Epoch 7/20 => Loss 0.521, Loss_clf 0.285, Loss_aux 0.236, Train_accy 91.90:  35%|███▌      | 7/20 [16:41<30:43, 141.79s/it]
Task 4, Epoch 8/20 => Loss 0.544, Loss_clf 0.297, Loss_aux 0.247, Train_accy 91.41:  35%|███▌      | 7/20 [18:45<30:43, 141.79s/it]
Task 4, Epoch 8/20 => Loss 0.544, Loss_clf 0.297, Loss_aux 0.247, Train_accy 91.41:  40%|████      | 8/20 [18:45<27:14, 136.18s/it]
Task 4, Epoch 9/20 => Loss 0.514, Loss_clf 0.284, Loss_aux 0.230, Train_accy 91.87:  40%|████      | 8/20 [20:49<27:14, 136.18s/it]
Task 4, Epoch 9/20 => Loss 0.514, Loss_clf 0.284, Loss_aux 0.230, Train_accy 91.87:  45%|████▌     | 9/20 [20:49<24:16, 132.44s/it]
Task 4, Epoch 10/20 => Loss 0.500, Loss_clf 0.273, Loss_aux 0.227, Train_accy 92.11:  45%|████▌     | 9/20 [22:54<24:16, 132.44s/it]
Task 4, Epoch 10/20 => Loss 0.500, Loss_clf 0.273, Loss_aux 0.227, Train_accy 92.11:  50%|█████     | 10/20 [22:54<21:39, 129.95s/it]
Task 4, Epoch 11/20 => Loss 0.476, Loss_clf 0.259, Loss_aux 0.216, Train_accy 92.59, Test_accy 89.32:  50%|█████     | 10/20 [26:04<21:39, 129.95s/it]
Task 4, Epoch 11/20 => Loss 0.476, Loss_clf 0.259, Loss_aux 0.216, Train_accy 92.59, Test_accy 89.32:  55%|█████▌    | 11/20 [26:04<22:15, 148.34s/it]
Task 4, Epoch 12/20 => Loss 0.471, Loss_clf 0.259, Loss_aux 0.212, Train_accy 92.44:  55%|█████▌    | 11/20 [28:08<22:15, 148.34s/it]                 
Task 4, Epoch 12/20 => Loss 0.471, Loss_clf 0.259, Loss_aux 0.212, Train_accy 92.44:  60%|██████    | 12/20 [28:08<18:47, 140.97s/it]
Task 4, Epoch 13/20 => Loss 0.452, Loss_clf 0.258, Loss_aux 0.194, Train_accy 92.83:  60%|██████    | 12/20 [30:12<18:47, 140.97s/it]
Task 4, Epoch 13/20 => Loss 0.452, Loss_clf 0.258, Loss_aux 0.194, Train_accy 92.83:  65%|██████▌   | 13/20 [30:12<15:51, 135.91s/it]
Task 4, Epoch 14/20 => Loss 0.464, Loss_clf 0.256, Loss_aux 0.207, Train_accy 92.51:  65%|██████▌   | 13/20 [32:16<15:51, 135.91s/it]
Task 4, Epoch 14/20 => Loss 0.464, Loss_clf 0.256, Loss_aux 0.207, Train_accy 92.51:  70%|███████   | 14/20 [32:16<13:14, 132.38s/it]
Task 4, Epoch 15/20 => Loss 0.449, Loss_clf 0.241, Loss_aux 0.209, Train_accy 93.01:  70%|███████   | 14/20 [34:21<13:14, 132.38s/it]
Task 4, Epoch 15/20 => Loss 0.449, Loss_clf 0.241, Loss_aux 0.209, Train_accy 93.01:  75%|███████▌  | 15/20 [34:21<10:49, 129.97s/it]
Task 4, Epoch 16/20 => Loss 0.430, Loss_clf 0.237, Loss_aux 0.193, Train_accy 93.17, Test_accy 88.90:  75%|███████▌  | 15/20 [37:31<10:49, 129.97s/it]
Task 4, Epoch 16/20 => Loss 0.430, Loss_clf 0.237, Loss_aux 0.193, Train_accy 93.17, Test_accy 88.90:  80%|████████  | 16/20 [37:31<09:52, 148.09s/it]
Task 4, Epoch 17/20 => Loss 0.439, Loss_clf 0.245, Loss_aux 0.193, Train_accy 92.96:  80%|████████  | 16/20 [39:35<09:52, 148.09s/it]                 
Task 4, Epoch 17/20 => Loss 0.439, Loss_clf 0.245, Loss_aux 0.193, Train_accy 92.96:  85%|████████▌ | 17/20 [39:35<07:02, 140.91s/it]
Task 4, Epoch 18/20 => Loss 0.428, Loss_clf 0.236, Loss_aux 0.192, Train_accy 93.27:  85%|████████▌ | 17/20 [41:39<07:02, 140.91s/it]
Task 4, Epoch 18/20 => Loss 0.428, Loss_clf 0.236, Loss_aux 0.192, Train_accy 93.27:  90%|█████████ | 18/20 [41:39<04:31, 135.91s/it]
Task 4, Epoch 19/20 => Loss 0.394, Loss_clf 0.217, Loss_aux 0.178, Train_accy 93.89:  90%|█████████ | 18/20 [43:44<04:31, 135.91s/it]
Task 4, Epoch 19/20 => Loss 0.394, Loss_clf 0.217, Loss_aux 0.178, Train_accy 93.89:  95%|█████████▌| 19/20 [43:44<02:12, 132.42s/it]
Task 4, Epoch 20/20 => Loss 0.415, Loss_clf 0.231, Loss_aux 0.183, Train_accy 93.50:  95%|█████████▌| 19/20 [45:48<02:12, 132.42s/it]
Task 4, Epoch 20/20 => Loss 0.415, Loss_clf 0.231, Loss_aux 0.183, Train_accy 93.50: 100%|██████████| 20/20 [45:48<00:00, 130.02s/it]
Task 4, Epoch 20/20 => Loss 0.415, Loss_clf 0.231, Loss_aux 0.183, Train_accy 93.50: 100%|██████████| 20/20 [45:48<00:00, 137.42s/it]
2024-09-04 15:31:09,344 [der.py] => Task 4, Epoch 20/20 => Loss 0.415, Loss_clf 0.231, Loss_aux 0.183, Train_accy 93.50
2024-09-04 15:31:09,345 [base.py] => Reducing exemplars...(40 per classes)
2024-09-04 15:31:43,002 [base.py] => Constructing exemplars...(40 per classes)
2024-09-04 15:35:14,772 [der.py] => Exemplar size: 2000
2024-09-04 15:35:14,772 [trainer.py] => CNN: {'total': 89.34, '00-09': 86.1, '10-19': 80.8, '20-29': 92.8, '30-39': 90.1, '40-49': 96.9, 'old': 87.45, 'new': 96.9}
2024-09-04 15:35:14,772 [trainer.py] => NME: {'total': 91.7, '00-09': 91.8, '10-19': 87.8, '20-29': 94.6, '30-39': 90.7, '40-49': 93.6, 'old': 91.22, 'new': 93.6}
2024-09-04 15:35:14,772 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87, 92.8, 89.34]
2024-09-04 15:35:14,773 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3, 99.0, 98.48]
2024-09-04 15:35:14,773 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47, 93.32, 91.7]
2024-09-04 15:35:14,773 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53, 99.42, 99.4]

Average Accuracy (CNN): 94.19
Average Accuracy (NME): 94.98
2024-09-04 15:35:14,773 [trainer.py] => Average Accuracy (CNN): 94.19
2024-09-04 15:35:14,773 [trainer.py] => Average Accuracy (NME): 94.98
2024-09-04 15:35:14,776 [trainer.py] => All params: 429193789
2024-09-04 15:35:14,779 [trainer.py] => Trainable params: 85999165
2024-09-04 15:35:16,628 [der.py] => Learning on 50-60
2024-09-04 15:35:16,635 [der.py] => All params: 515076935
2024-09-04 15:35:16,638 [der.py] => Trainable params: 86083655

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.639, Loss_clf 1.030, Loss_aux 0.609, Train_accy 79.01, Test_accy 86.03:   0%|          | 0/20 [03:56<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.639, Loss_clf 1.030, Loss_aux 0.609, Train_accy 79.01, Test_accy 86.03:   5%|▌         | 1/20 [03:56<1:14:59, 236.80s/it]
Task 5, Epoch 2/20 => Loss 0.774, Loss_clf 0.421, Loss_aux 0.353, Train_accy 87.16:   5%|▌         | 1/20 [06:19<1:14:59, 236.80s/it]                 
Task 5, Epoch 2/20 => Loss 0.774, Loss_clf 0.421, Loss_aux 0.353, Train_accy 87.16:  10%|█         | 2/20 [06:19<54:23, 181.32s/it]  
Task 5, Epoch 3/20 => Loss 0.701, Loss_clf 0.379, Loss_aux 0.322, Train_accy 88.40:  10%|█         | 2/20 [08:41<54:23, 181.32s/it]
Task 5, Epoch 3/20 => Loss 0.701, Loss_clf 0.379, Loss_aux 0.322, Train_accy 88.40:  15%|█▌        | 3/20 [08:41<46:21, 163.65s/it]
Task 5, Epoch 4/20 => Loss 0.613, Loss_clf 0.335, Loss_aux 0.279, Train_accy 90.23:  15%|█▌        | 3/20 [11:04<46:21, 163.65s/it]
Task 5, Epoch 4/20 => Loss 0.613, Loss_clf 0.335, Loss_aux 0.279, Train_accy 90.23:  20%|██        | 4/20 [11:04<41:24, 155.29s/it]
Task 5, Epoch 5/20 => Loss 0.610, Loss_clf 0.333, Loss_aux 0.277, Train_accy 90.26:  20%|██        | 4/20 [13:26<41:24, 155.29s/it]
Task 5, Epoch 5/20 => Loss 0.610, Loss_clf 0.333, Loss_aux 0.277, Train_accy 90.26:  25%|██▌       | 5/20 [13:26<37:39, 150.66s/it]
Task 5, Epoch 6/20 => Loss 0.571, Loss_clf 0.310, Loss_aux 0.261, Train_accy 90.83, Test_accy 86.65:  25%|██▌       | 5/20 [17:23<37:39, 150.66s/it]
Task 5, Epoch 6/20 => Loss 0.571, Loss_clf 0.310, Loss_aux 0.261, Train_accy 90.83, Test_accy 86.65:  30%|███       | 6/20 [17:23<42:00, 180.05s/it]
Task 5, Epoch 7/20 => Loss 0.584, Loss_clf 0.314, Loss_aux 0.270, Train_accy 90.50:  30%|███       | 6/20 [19:46<42:00, 180.05s/it]                 
Task 5, Epoch 7/20 => Loss 0.584, Loss_clf 0.314, Loss_aux 0.270, Train_accy 90.50:  35%|███▌      | 7/20 [19:46<36:20, 167.77s/it]
Task 5, Epoch 8/20 => Loss 0.547, Loss_clf 0.299, Loss_aux 0.248, Train_accy 91.10:  35%|███▌      | 7/20 [22:08<36:20, 167.77s/it]
Task 5, Epoch 8/20 => Loss 0.547, Loss_clf 0.299, Loss_aux 0.248, Train_accy 91.10:  40%|████      | 8/20 [22:08<31:56, 159.70s/it]
Task 5, Epoch 9/20 => Loss 0.551, Loss_clf 0.299, Loss_aux 0.252, Train_accy 91.14:  40%|████      | 8/20 [24:31<31:56, 159.70s/it]
Task 5, Epoch 9/20 => Loss 0.551, Loss_clf 0.299, Loss_aux 0.252, Train_accy 91.14:  45%|████▌     | 9/20 [24:31<28:17, 154.36s/it]
Task 5, Epoch 10/20 => Loss 0.526, Loss_clf 0.286, Loss_aux 0.240, Train_accy 91.36:  45%|████▌     | 9/20 [26:53<28:17, 154.36s/it]
Task 5, Epoch 10/20 => Loss 0.526, Loss_clf 0.286, Loss_aux 0.240, Train_accy 91.36:  50%|█████     | 10/20 [26:53<25:07, 150.71s/it]
Task 5, Epoch 11/20 => Loss 0.538, Loss_clf 0.295, Loss_aux 0.243, Train_accy 91.61, Test_accy 87.25:  50%|█████     | 10/20 [30:51<25:07, 150.71s/it]
Task 5, Epoch 11/20 => Loss 0.538, Loss_clf 0.295, Loss_aux 0.243, Train_accy 91.61, Test_accy 87.25:  55%|█████▌    | 11/20 [30:51<26:34, 177.15s/it]
Task 5, Epoch 12/20 => Loss 0.515, Loss_clf 0.287, Loss_aux 0.228, Train_accy 91.71:  55%|█████▌    | 11/20 [33:13<26:34, 177.15s/it]                 
Task 5, Epoch 12/20 => Loss 0.515, Loss_clf 0.287, Loss_aux 0.228, Train_accy 91.71:  60%|██████    | 12/20 [33:13<22:12, 166.58s/it]
Task 5, Epoch 13/20 => Loss 0.508, Loss_clf 0.278, Loss_aux 0.231, Train_accy 91.49:  60%|██████    | 12/20 [35:35<22:12, 166.58s/it]
Task 5, Epoch 13/20 => Loss 0.508, Loss_clf 0.278, Loss_aux 0.231, Train_accy 91.49:  65%|██████▌   | 13/20 [35:35<18:34, 159.28s/it]
Task 5, Epoch 14/20 => Loss 0.467, Loss_clf 0.260, Loss_aux 0.207, Train_accy 92.41:  65%|██████▌   | 13/20 [37:58<18:34, 159.28s/it]
Task 5, Epoch 14/20 => Loss 0.467, Loss_clf 0.260, Loss_aux 0.207, Train_accy 92.41:  70%|███████   | 14/20 [37:58<15:25, 154.18s/it]
Task 5, Epoch 15/20 => Loss 0.504, Loss_clf 0.273, Loss_aux 0.231, Train_accy 92.04:  70%|███████   | 14/20 [40:20<15:25, 154.18s/it]
Task 5, Epoch 15/20 => Loss 0.504, Loss_clf 0.273, Loss_aux 0.231, Train_accy 92.04:  75%|███████▌  | 15/20 [40:20<12:33, 150.64s/it]
Task 5, Epoch 16/20 => Loss 0.477, Loss_clf 0.262, Loss_aux 0.215, Train_accy 92.30, Test_accy 87.82:  75%|███████▌  | 15/20 [44:17<12:33, 150.64s/it]
Task 5, Epoch 16/20 => Loss 0.477, Loss_clf 0.262, Loss_aux 0.215, Train_accy 92.30, Test_accy 87.82:  80%|████████  | 16/20 [44:17<11:46, 176.56s/it]
Task 5, Epoch 17/20 => Loss 0.476, Loss_clf 0.266, Loss_aux 0.210, Train_accy 92.26:  80%|████████  | 16/20 [46:39<11:46, 176.56s/it]                 
Task 5, Epoch 17/20 => Loss 0.476, Loss_clf 0.266, Loss_aux 0.210, Train_accy 92.26:  85%|████████▌ | 17/20 [46:39<08:18, 166.29s/it]
Task 5, Epoch 18/20 => Loss 0.448, Loss_clf 0.247, Loss_aux 0.201, Train_accy 92.47:  85%|████████▌ | 17/20 [49:02<08:18, 166.29s/it]
Task 5, Epoch 18/20 => Loss 0.448, Loss_clf 0.247, Loss_aux 0.201, Train_accy 92.47:  90%|█████████ | 18/20 [49:02<05:18, 159.11s/it]
Task 5, Epoch 19/20 => Loss 0.468, Loss_clf 0.257, Loss_aux 0.211, Train_accy 92.63:  90%|█████████ | 18/20 [51:24<05:18, 159.11s/it]
Task 5, Epoch 19/20 => Loss 0.468, Loss_clf 0.257, Loss_aux 0.211, Train_accy 92.63:  95%|█████████▌| 19/20 [51:24<02:34, 154.09s/it]
Task 5, Epoch 20/20 => Loss 0.448, Loss_clf 0.253, Loss_aux 0.195, Train_accy 92.60:  95%|█████████▌| 19/20 [53:47<02:34, 154.09s/it]
Task 5, Epoch 20/20 => Loss 0.448, Loss_clf 0.253, Loss_aux 0.195, Train_accy 92.60: 100%|██████████| 20/20 [53:47<00:00, 150.59s/it]
Task 5, Epoch 20/20 => Loss 0.448, Loss_clf 0.253, Loss_aux 0.195, Train_accy 92.60: 100%|██████████| 20/20 [53:47<00:00, 161.36s/it]
2024-09-04 16:29:03,963 [der.py] => Task 5, Epoch 20/20 => Loss 0.448, Loss_clf 0.253, Loss_aux 0.195, Train_accy 92.60
2024-09-04 16:29:03,964 [base.py] => Reducing exemplars...(33 per classes)
2024-09-04 16:29:44,503 [base.py] => Constructing exemplars...(33 per classes)
2024-09-04 16:34:26,820 [der.py] => Exemplar size: 1980
2024-09-04 16:34:26,820 [trainer.py] => CNN: {'total': 87.87, '00-09': 83.3, '10-19': 83.3, '20-29': 88.0, '30-39': 87.0, '40-49': 89.1, '50-59': 96.5, 'old': 86.14, 'new': 96.5}
2024-09-04 16:34:26,820 [trainer.py] => NME: {'total': 90.32, '00-09': 89.6, '10-19': 86.5, '20-29': 93.3, '30-39': 89.2, '40-49': 91.5, '50-59': 91.8, 'old': 90.02, 'new': 91.8}
2024-09-04 16:34:26,821 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87, 92.8, 89.34, 87.87]
2024-09-04 16:34:26,821 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3, 99.0, 98.48, 98.12]
2024-09-04 16:34:26,821 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47, 93.32, 91.7, 90.32]
2024-09-04 16:34:26,821 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53, 99.42, 99.4, 99.0]

Average Accuracy (CNN): 93.14
Average Accuracy (NME): 94.2
2024-09-04 16:34:26,821 [trainer.py] => Average Accuracy (CNN): 93.14
2024-09-04 16:34:26,821 [trainer.py] => Average Accuracy (NME): 94.2
2024-09-04 16:34:26,824 [trainer.py] => All params: 515076935
2024-09-04 16:34:26,827 [trainer.py] => Trainable params: 86083655
2024-09-04 16:34:28,528 [der.py] => Learning on 60-70
2024-09-04 16:34:28,536 [der.py] => All params: 600975441
2024-09-04 16:34:28,539 [der.py] => Trainable params: 86183505

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.531, Loss_clf 0.928, Loss_aux 0.603, Train_accy 81.62, Test_accy 85.70:   0%|          | 0/20 [04:48<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.531, Loss_clf 0.928, Loss_aux 0.603, Train_accy 81.62, Test_accy 85.70:   5%|▌         | 1/20 [04:48<1:31:21, 288.50s/it]
Task 6, Epoch 2/20 => Loss 0.627, Loss_clf 0.348, Loss_aux 0.279, Train_accy 89.54:   5%|▌         | 1/20 [07:28<1:31:21, 288.50s/it]                 
Task 6, Epoch 2/20 => Loss 0.627, Loss_clf 0.348, Loss_aux 0.279, Train_accy 89.54:  10%|█         | 2/20 [07:28<1:03:56, 213.16s/it]
Task 6, Epoch 3/20 => Loss 0.559, Loss_clf 0.314, Loss_aux 0.245, Train_accy 91.49:  10%|█         | 2/20 [10:09<1:03:56, 213.16s/it]
Task 6, Epoch 3/20 => Loss 0.559, Loss_clf 0.314, Loss_aux 0.245, Train_accy 91.49:  15%|█▌        | 3/20 [10:09<53:34, 189.07s/it]  
Task 6, Epoch 4/20 => Loss 0.539, Loss_clf 0.304, Loss_aux 0.235, Train_accy 91.30:  15%|█▌        | 3/20 [12:49<53:34, 189.07s/it]
Task 6, Epoch 4/20 => Loss 0.539, Loss_clf 0.304, Loss_aux 0.235, Train_accy 91.30:  20%|██        | 4/20 [12:49<47:24, 177.77s/it]
Task 6, Epoch 5/20 => Loss 0.505, Loss_clf 0.282, Loss_aux 0.222, Train_accy 92.22:  20%|██        | 4/20 [15:30<47:24, 177.77s/it]
Task 6, Epoch 5/20 => Loss 0.505, Loss_clf 0.282, Loss_aux 0.222, Train_accy 92.22:  25%|██▌       | 5/20 [15:30<42:53, 171.53s/it]
Task 6, Epoch 6/20 => Loss 0.497, Loss_clf 0.278, Loss_aux 0.220, Train_accy 92.15, Test_accy 85.91:  25%|██▌       | 5/20 [20:18<42:53, 171.53s/it]
Task 6, Epoch 6/20 => Loss 0.497, Loss_clf 0.278, Loss_aux 0.220, Train_accy 92.15, Test_accy 85.91:  30%|███       | 6/20 [20:18<49:19, 211.36s/it]
Task 6, Epoch 7/20 => Loss 0.508, Loss_clf 0.292, Loss_aux 0.216, Train_accy 91.98:  30%|███       | 6/20 [22:59<49:19, 211.36s/it]                 
Task 6, Epoch 7/20 => Loss 0.508, Loss_clf 0.292, Loss_aux 0.216, Train_accy 91.98:  35%|███▌      | 7/20 [22:59<42:11, 194.71s/it]
Task 6, Epoch 8/20 => Loss 0.489, Loss_clf 0.269, Loss_aux 0.220, Train_accy 92.62:  35%|███▌      | 7/20 [25:39<42:11, 194.71s/it]
Task 6, Epoch 8/20 => Loss 0.489, Loss_clf 0.269, Loss_aux 0.220, Train_accy 92.62:  40%|████      | 8/20 [25:39<36:45, 183.78s/it]
Task 6, Epoch 9/20 => Loss 0.458, Loss_clf 0.257, Loss_aux 0.202, Train_accy 92.71:  40%|████      | 8/20 [28:20<36:45, 183.78s/it]
Task 6, Epoch 9/20 => Loss 0.458, Loss_clf 0.257, Loss_aux 0.202, Train_accy 92.71:  45%|████▌     | 9/20 [28:20<32:21, 176.46s/it]
Task 6, Epoch 10/20 => Loss 0.448, Loss_clf 0.254, Loss_aux 0.194, Train_accy 92.69:  45%|████▌     | 9/20 [31:00<32:21, 176.46s/it]
Task 6, Epoch 10/20 => Loss 0.448, Loss_clf 0.254, Loss_aux 0.194, Train_accy 92.69:  50%|█████     | 10/20 [31:00<28:35, 171.50s/it]
Task 6, Epoch 11/20 => Loss 0.420, Loss_clf 0.245, Loss_aux 0.175, Train_accy 93.11, Test_accy 87.37:  50%|█████     | 10/20 [35:49<28:35, 171.50s/it]
Task 6, Epoch 11/20 => Loss 0.420, Loss_clf 0.245, Loss_aux 0.175, Train_accy 93.11, Test_accy 87.37:  55%|█████▌    | 11/20 [35:49<31:06, 207.37s/it]
Task 6, Epoch 12/20 => Loss 0.431, Loss_clf 0.246, Loss_aux 0.185, Train_accy 93.57:  55%|█████▌    | 11/20 [38:29<31:06, 207.37s/it]                 
Task 6, Epoch 12/20 => Loss 0.431, Loss_clf 0.246, Loss_aux 0.185, Train_accy 93.57:  60%|██████    | 12/20 [38:29<25:44, 193.10s/it]
Task 6, Epoch 13/20 => Loss 0.452, Loss_clf 0.258, Loss_aux 0.194, Train_accy 92.74:  60%|██████    | 12/20 [41:10<25:44, 193.10s/it]
Task 6, Epoch 13/20 => Loss 0.452, Loss_clf 0.258, Loss_aux 0.194, Train_accy 92.74:  65%|██████▌   | 13/20 [41:10<21:22, 183.24s/it]
Task 6, Epoch 14/20 => Loss 0.423, Loss_clf 0.240, Loss_aux 0.183, Train_accy 93.28:  65%|██████▌   | 13/20 [43:50<21:22, 183.24s/it]
Task 6, Epoch 14/20 => Loss 0.423, Loss_clf 0.240, Loss_aux 0.183, Train_accy 93.28:  70%|███████   | 14/20 [43:50<17:38, 176.34s/it]
Task 6, Epoch 15/20 => Loss 0.428, Loss_clf 0.249, Loss_aux 0.180, Train_accy 92.88:  70%|███████   | 14/20 [46:31<17:38, 176.34s/it]
Task 6, Epoch 15/20 => Loss 0.428, Loss_clf 0.249, Loss_aux 0.180, Train_accy 92.88:  75%|███████▌  | 15/20 [46:31<14:17, 171.55s/it]
Task 6, Epoch 16/20 => Loss 0.406, Loss_clf 0.236, Loss_aux 0.169, Train_accy 93.54, Test_accy 86.59:  75%|███████▌  | 15/20 [51:20<14:17, 171.55s/it]
Task 6, Epoch 16/20 => Loss 0.406, Loss_clf 0.236, Loss_aux 0.169, Train_accy 93.54, Test_accy 86.59:  80%|████████  | 16/20 [51:20<13:47, 206.96s/it]
Task 6, Epoch 17/20 => Loss 0.364, Loss_clf 0.203, Loss_aux 0.161, Train_accy 94.56:  80%|████████  | 16/20 [54:00<13:47, 206.96s/it]                 
Task 6, Epoch 17/20 => Loss 0.364, Loss_clf 0.203, Loss_aux 0.161, Train_accy 94.56:  85%|████████▌ | 17/20 [54:00<09:38, 193.00s/it]
Task 6, Epoch 18/20 => Loss 0.375, Loss_clf 0.216, Loss_aux 0.159, Train_accy 94.13:  85%|████████▌ | 17/20 [56:41<09:38, 193.00s/it]
Task 6, Epoch 18/20 => Loss 0.375, Loss_clf 0.216, Loss_aux 0.159, Train_accy 94.13:  90%|█████████ | 18/20 [56:41<06:06, 183.22s/it]
Task 6, Epoch 19/20 => Loss 0.375, Loss_clf 0.217, Loss_aux 0.158, Train_accy 93.93:  90%|█████████ | 18/20 [59:21<06:06, 183.22s/it]
Task 6, Epoch 19/20 => Loss 0.375, Loss_clf 0.217, Loss_aux 0.158, Train_accy 93.93:  95%|█████████▌| 19/20 [59:21<02:56, 176.39s/it]
Task 6, Epoch 20/20 => Loss 0.410, Loss_clf 0.233, Loss_aux 0.178, Train_accy 93.57:  95%|█████████▌| 19/20 [1:02:02<02:56, 176.39s/it]
Task 6, Epoch 20/20 => Loss 0.410, Loss_clf 0.233, Loss_aux 0.178, Train_accy 93.57: 100%|██████████| 20/20 [1:02:02<00:00, 171.64s/it]
Task 6, Epoch 20/20 => Loss 0.410, Loss_clf 0.233, Loss_aux 0.178, Train_accy 93.57: 100%|██████████| 20/20 [1:02:02<00:00, 186.11s/it]
2024-09-04 17:36:30,946 [der.py] => Task 6, Epoch 20/20 => Loss 0.410, Loss_clf 0.233, Loss_aux 0.178, Train_accy 93.57
2024-09-04 17:36:30,947 [base.py] => Reducing exemplars...(28 per classes)
2024-09-04 17:37:21,190 [base.py] => Constructing exemplars...(28 per classes)
2024-09-04 17:43:25,470 [der.py] => Exemplar size: 1960
2024-09-04 17:43:25,471 [trainer.py] => CNN: {'total': 87.37, '00-09': 83.6, '10-19': 78.9, '20-29': 89.6, '30-39': 87.4, '40-49': 88.4, '50-59': 86.1, '60-69': 97.6, 'old': 85.67, 'new': 97.6}
2024-09-04 17:43:25,471 [trainer.py] => NME: {'total': 89.24, '00-09': 87.7, '10-19': 83.6, '20-29': 92.7, '30-39': 88.1, '40-49': 91.6, '50-59': 88.6, '60-69': 92.4, 'old': 88.72, 'new': 92.4}
2024-09-04 17:43:25,471 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87, 92.8, 89.34, 87.87, 87.37]
2024-09-04 17:43:25,471 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3, 99.0, 98.48, 98.12, 97.8]
2024-09-04 17:43:25,471 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47, 93.32, 91.7, 90.32, 89.24]
2024-09-04 17:43:25,471 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53, 99.42, 99.4, 99.0, 98.81]

Average Accuracy (CNN): 92.31
Average Accuracy (NME): 93.49
2024-09-04 17:43:25,471 [trainer.py] => Average Accuracy (CNN): 92.31
2024-09-04 17:43:25,471 [trainer.py] => Average Accuracy (NME): 93.49
2024-09-04 17:43:25,476 [trainer.py] => All params: 600975441
2024-09-04 17:43:25,480 [trainer.py] => Trainable params: 86183505
2024-09-04 17:43:27,676 [der.py] => Learning on 70-80
2024-09-04 17:43:27,686 [der.py] => All params: 686889307
2024-09-04 17:43:27,689 [der.py] => Trainable params: 86298715

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.809, Loss_clf 1.183, Loss_aux 0.626, Train_accy 78.79, Test_accy 80.55:   0%|          | 0/20 [05:45<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.809, Loss_clf 1.183, Loss_aux 0.626, Train_accy 78.79, Test_accy 80.55:   5%|▌         | 1/20 [05:45<1:49:26, 345.58s/it]
Task 7, Epoch 2/20 => Loss 0.800, Loss_clf 0.439, Loss_aux 0.360, Train_accy 87.47:   5%|▌         | 1/20 [08:43<1:49:26, 345.58s/it]                 
Task 7, Epoch 2/20 => Loss 0.800, Loss_clf 0.439, Loss_aux 0.360, Train_accy 87.47:  10%|█         | 2/20 [08:43<1:14:09, 247.18s/it]
Task 7, Epoch 3/20 => Loss 0.717, Loss_clf 0.397, Loss_aux 0.320, Train_accy 88.16:  10%|█         | 2/20 [11:42<1:14:09, 247.18s/it]
Task 7, Epoch 3/20 => Loss 0.717, Loss_clf 0.397, Loss_aux 0.320, Train_accy 88.16:  15%|█▌        | 3/20 [11:42<1:01:06, 215.66s/it]
Task 7, Epoch 4/20 => Loss 0.660, Loss_clf 0.364, Loss_aux 0.296, Train_accy 89.07:  15%|█▌        | 3/20 [14:40<1:01:06, 215.66s/it]
Task 7, Epoch 4/20 => Loss 0.660, Loss_clf 0.364, Loss_aux 0.296, Train_accy 89.07:  20%|██        | 4/20 [14:40<53:33, 200.82s/it]  
Task 7, Epoch 5/20 => Loss 0.628, Loss_clf 0.357, Loss_aux 0.271, Train_accy 89.48:  20%|██        | 4/20 [17:38<53:33, 200.82s/it]
Task 7, Epoch 5/20 => Loss 0.628, Loss_clf 0.357, Loss_aux 0.271, Train_accy 89.48:  25%|██▌       | 5/20 [17:38<48:10, 192.68s/it]
Task 7, Epoch 6/20 => Loss 0.593, Loss_clf 0.330, Loss_aux 0.263, Train_accy 90.49, Test_accy 81.91:  25%|██▌       | 5/20 [23:24<48:10, 192.68s/it]
Task 7, Epoch 6/20 => Loss 0.593, Loss_clf 0.330, Loss_aux 0.263, Train_accy 90.49, Test_accy 81.91:  30%|███       | 6/20 [23:24<57:07, 244.79s/it]
Task 7, Epoch 7/20 => Loss 0.578, Loss_clf 0.317, Loss_aux 0.261, Train_accy 90.39:  30%|███       | 6/20 [26:22<57:07, 244.79s/it]                 
Task 7, Epoch 7/20 => Loss 0.578, Loss_clf 0.317, Loss_aux 0.261, Train_accy 90.39:  35%|███▌      | 7/20 [26:22<48:19, 223.04s/it]
Task 7, Epoch 8/20 => Loss 0.544, Loss_clf 0.302, Loss_aux 0.242, Train_accy 90.78:  35%|███▌      | 7/20 [29:20<48:19, 223.04s/it]
Task 7, Epoch 8/20 => Loss 0.544, Loss_clf 0.302, Loss_aux 0.242, Train_accy 90.78:  40%|████      | 8/20 [29:20<41:45, 208.82s/it]
Task 7, Epoch 9/20 => Loss 0.552, Loss_clf 0.306, Loss_aux 0.246, Train_accy 90.98:  40%|████      | 8/20 [32:19<41:45, 208.82s/it]
Task 7, Epoch 9/20 => Loss 0.552, Loss_clf 0.306, Loss_aux 0.246, Train_accy 90.98:  45%|████▌     | 9/20 [32:19<36:32, 199.29s/it]
Task 7, Epoch 10/20 => Loss 0.535, Loss_clf 0.292, Loss_aux 0.244, Train_accy 91.16:  45%|████▌     | 9/20 [35:17<36:32, 199.29s/it]
Task 7, Epoch 10/20 => Loss 0.535, Loss_clf 0.292, Loss_aux 0.244, Train_accy 91.16:  50%|█████     | 10/20 [35:17<32:08, 192.81s/it]
Task 7, Epoch 11/20 => Loss 0.516, Loss_clf 0.287, Loss_aux 0.229, Train_accy 91.45, Test_accy 81.42:  50%|█████     | 10/20 [41:04<32:08, 192.81s/it]
Task 7, Epoch 11/20 => Loss 0.516, Loss_clf 0.287, Loss_aux 0.229, Train_accy 91.45, Test_accy 81.42:  55%|█████▌    | 11/20 [41:04<35:59, 239.92s/it]
Task 7, Epoch 12/20 => Loss 0.474, Loss_clf 0.260, Loss_aux 0.213, Train_accy 92.54:  55%|█████▌    | 11/20 [44:02<35:59, 239.92s/it]                 
Task 7, Epoch 12/20 => Loss 0.474, Loss_clf 0.260, Loss_aux 0.213, Train_accy 92.54:  60%|██████    | 12/20 [44:02<29:29, 221.21s/it]
Task 7, Epoch 13/20 => Loss 0.503, Loss_clf 0.279, Loss_aux 0.225, Train_accy 91.94:  60%|██████    | 12/20 [47:01<29:29, 221.21s/it]
Task 7, Epoch 13/20 => Loss 0.503, Loss_clf 0.279, Loss_aux 0.225, Train_accy 91.94:  65%|██████▌   | 13/20 [47:01<24:17, 208.24s/it]
Task 7, Epoch 14/20 => Loss 0.505, Loss_clf 0.284, Loss_aux 0.221, Train_accy 91.80:  65%|██████▌   | 13/20 [49:59<24:17, 208.24s/it]
Task 7, Epoch 14/20 => Loss 0.505, Loss_clf 0.284, Loss_aux 0.221, Train_accy 91.80:  70%|███████   | 14/20 [49:59<19:55, 199.17s/it]
Task 7, Epoch 15/20 => Loss 0.482, Loss_clf 0.261, Loss_aux 0.220, Train_accy 92.57:  70%|███████   | 14/20 [52:57<19:55, 199.17s/it]
Task 7, Epoch 15/20 => Loss 0.482, Loss_clf 0.261, Loss_aux 0.220, Train_accy 92.57:  75%|███████▌  | 15/20 [52:57<16:04, 192.86s/it]
Task 7, Epoch 16/20 => Loss 0.459, Loss_clf 0.253, Loss_aux 0.205, Train_accy 93.00, Test_accy 82.30:  75%|███████▌  | 15/20 [58:43<16:04, 192.86s/it]
Task 7, Epoch 16/20 => Loss 0.459, Loss_clf 0.253, Loss_aux 0.205, Train_accy 93.00, Test_accy 82.30:  80%|████████  | 16/20 [58:43<15:55, 238.92s/it]
Task 7, Epoch 17/20 => Loss 0.467, Loss_clf 0.270, Loss_aux 0.198, Train_accy 92.50:  80%|████████  | 16/20 [1:01:42<15:55, 238.92s/it]               
Task 7, Epoch 17/20 => Loss 0.467, Loss_clf 0.270, Loss_aux 0.198, Train_accy 92.50:  85%|████████▌ | 17/20 [1:01:42<11:02, 220.79s/it]
Task 7, Epoch 18/20 => Loss 0.426, Loss_clf 0.243, Loss_aux 0.183, Train_accy 93.02:  85%|████████▌ | 17/20 [1:04:40<11:02, 220.79s/it]
Task 7, Epoch 18/20 => Loss 0.426, Loss_clf 0.243, Loss_aux 0.183, Train_accy 93.02:  90%|█████████ | 18/20 [1:04:40<06:55, 207.99s/it]
Task 7, Epoch 19/20 => Loss 0.457, Loss_clf 0.255, Loss_aux 0.202, Train_accy 92.89:  90%|█████████ | 18/20 [1:07:38<06:55, 207.99s/it]
Task 7, Epoch 19/20 => Loss 0.457, Loss_clf 0.255, Loss_aux 0.202, Train_accy 92.89:  95%|█████████▌| 19/20 [1:07:38<03:19, 199.08s/it]
Task 7, Epoch 20/20 => Loss 0.442, Loss_clf 0.244, Loss_aux 0.198, Train_accy 92.96:  95%|█████████▌| 19/20 [1:10:36<03:19, 199.08s/it]
Task 7, Epoch 20/20 => Loss 0.442, Loss_clf 0.244, Loss_aux 0.198, Train_accy 92.96: 100%|██████████| 20/20 [1:10:36<00:00, 192.86s/it]
Task 7, Epoch 20/20 => Loss 0.442, Loss_clf 0.244, Loss_aux 0.198, Train_accy 92.96: 100%|██████████| 20/20 [1:10:36<00:00, 211.85s/it]
2024-09-04 18:54:04,794 [der.py] => Task 7, Epoch 20/20 => Loss 0.442, Loss_clf 0.244, Loss_aux 0.198, Train_accy 92.96
2024-09-04 18:54:04,795 [base.py] => Reducing exemplars...(25 per classes)
2024-09-04 18:55:05,364 [base.py] => Constructing exemplars...(25 per classes)
2024-09-04 19:02:42,582 [der.py] => Exemplar size: 2000
2024-09-04 19:02:42,582 [trainer.py] => CNN: {'total': 81.28, '00-09': 76.2, '10-19': 80.2, '20-29': 89.0, '30-39': 81.0, '40-49': 75.5, '50-59': 66.3, '60-69': 85.7, '70-79': 96.3, 'old': 79.13, 'new': 96.3}
2024-09-04 19:02:42,582 [trainer.py] => NME: {'total': 86.71, '00-09': 85.6, '10-19': 82.2, '20-29': 92.7, '30-39': 86.7, '40-49': 88.6, '50-59': 79.7, '60-69': 88.3, '70-79': 89.9, 'old': 86.26, 'new': 89.9}
2024-09-04 19:02:42,582 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87, 92.8, 89.34, 87.87, 87.37, 81.28]
2024-09-04 19:02:42,582 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3, 99.0, 98.48, 98.12, 97.8, 96.71]
2024-09-04 19:02:42,582 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47, 93.32, 91.7, 90.32, 89.24, 86.71]
2024-09-04 19:02:42,582 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53, 99.42, 99.4, 99.0, 98.81, 98.44]

Average Accuracy (CNN): 90.94
Average Accuracy (NME): 92.65
2024-09-04 19:02:42,582 [trainer.py] => Average Accuracy (CNN): 90.94
2024-09-04 19:02:42,582 [trainer.py] => Average Accuracy (NME): 92.65
2024-09-04 19:02:42,587 [trainer.py] => All params: 686889307
2024-09-04 19:02:42,591 [trainer.py] => Trainable params: 86298715
2024-09-04 19:02:44,527 [der.py] => Learning on 80-90
2024-09-04 19:02:44,537 [der.py] => All params: 772818533
2024-09-04 19:02:44,541 [der.py] => Trainable params: 86429285

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.718, Loss_clf 1.070, Loss_aux 0.648, Train_accy 79.71, Test_accy 78.44:   0%|          | 0/20 [06:49<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.718, Loss_clf 1.070, Loss_aux 0.648, Train_accy 79.71, Test_accy 78.44:   5%|▌         | 1/20 [06:49<2:09:34, 409.20s/it]
Task 8, Epoch 2/20 => Loss 0.771, Loss_clf 0.420, Loss_aux 0.351, Train_accy 88.30:   5%|▌         | 1/20 [10:06<2:09:34, 409.20s/it]                 
Task 8, Epoch 2/20 => Loss 0.771, Loss_clf 0.420, Loss_aux 0.351, Train_accy 88.30:  10%|█         | 2/20 [10:06<1:25:22, 284.60s/it]
Task 8, Epoch 3/20 => Loss 0.671, Loss_clf 0.371, Loss_aux 0.300, Train_accy 89.47:  10%|█         | 2/20 [13:24<1:25:22, 284.60s/it]
Task 8, Epoch 3/20 => Loss 0.671, Loss_clf 0.371, Loss_aux 0.300, Train_accy 89.47:  15%|█▌        | 3/20 [13:24<1:09:21, 244.82s/it]
Task 8, Epoch 4/20 => Loss 0.613, Loss_clf 0.343, Loss_aux 0.270, Train_accy 90.26:  15%|█▌        | 3/20 [16:41<1:09:21, 244.82s/it]
Task 8, Epoch 4/20 => Loss 0.613, Loss_clf 0.343, Loss_aux 0.270, Train_accy 90.26:  20%|██        | 4/20 [16:41<1:00:17, 226.06s/it]
Task 8, Epoch 5/20 => Loss 0.602, Loss_clf 0.329, Loss_aux 0.273, Train_accy 90.77:  20%|██        | 4/20 [19:58<1:00:17, 226.06s/it]
Task 8, Epoch 5/20 => Loss 0.602, Loss_clf 0.329, Loss_aux 0.273, Train_accy 90.77:  25%|██▌       | 5/20 [19:58<53:55, 215.70s/it]  
Task 8, Epoch 6/20 => Loss 0.536, Loss_clf 0.297, Loss_aux 0.240, Train_accy 91.56, Test_accy 79.52:  25%|██▌       | 5/20 [26:47<53:55, 215.70s/it]
Task 8, Epoch 6/20 => Loss 0.536, Loss_clf 0.297, Loss_aux 0.240, Train_accy 91.56, Test_accy 79.52:  30%|███       | 6/20 [26:47<1:05:40, 281.50s/it]
Task 8, Epoch 7/20 => Loss 0.546, Loss_clf 0.298, Loss_aux 0.247, Train_accy 91.60:  30%|███       | 6/20 [30:05<1:05:40, 281.50s/it]                 
Task 8, Epoch 7/20 => Loss 0.546, Loss_clf 0.298, Loss_aux 0.247, Train_accy 91.60:  35%|███▌      | 7/20 [30:05<55:01, 253.96s/it]  
Task 8, Epoch 8/20 => Loss 0.534, Loss_clf 0.299, Loss_aux 0.236, Train_accy 91.47:  35%|███▌      | 7/20 [33:22<55:01, 253.96s/it]
Task 8, Epoch 8/20 => Loss 0.534, Loss_clf 0.299, Loss_aux 0.236, Train_accy 91.47:  40%|████      | 8/20 [33:22<47:11, 235.96s/it]
Task 8, Epoch 9/20 => Loss 0.511, Loss_clf 0.288, Loss_aux 0.223, Train_accy 91.77:  40%|████      | 8/20 [36:40<47:11, 235.96s/it]
Task 8, Epoch 9/20 => Loss 0.511, Loss_clf 0.288, Loss_aux 0.223, Train_accy 91.77:  45%|████▌     | 9/20 [36:40<41:02, 223.91s/it]
Task 8, Epoch 10/20 => Loss 0.490, Loss_clf 0.269, Loss_aux 0.221, Train_accy 92.31:  45%|████▌     | 9/20 [39:57<41:02, 223.91s/it]
Task 8, Epoch 10/20 => Loss 0.490, Loss_clf 0.269, Loss_aux 0.221, Train_accy 92.31:  50%|█████     | 10/20 [39:57<35:58, 215.86s/it]
Task 8, Epoch 11/20 => Loss 0.473, Loss_clf 0.261, Loss_aux 0.213, Train_accy 92.56, Test_accy 80.76:  50%|█████     | 10/20 [46:47<35:58, 215.86s/it]
Task 8, Epoch 11/20 => Loss 0.473, Loss_clf 0.261, Loss_aux 0.213, Train_accy 92.56, Test_accy 80.76:  55%|█████▌    | 11/20 [46:47<41:16, 275.19s/it]
Task 8, Epoch 12/20 => Loss 0.483, Loss_clf 0.269, Loss_aux 0.214, Train_accy 92.34:  55%|█████▌    | 11/20 [50:05<41:16, 275.19s/it]                 
Task 8, Epoch 12/20 => Loss 0.483, Loss_clf 0.269, Loss_aux 0.214, Train_accy 92.34:  60%|██████    | 12/20 [50:05<33:32, 251.55s/it]
Task 8, Epoch 13/20 => Loss 0.467, Loss_clf 0.256, Loss_aux 0.211, Train_accy 92.67:  60%|██████    | 12/20 [53:22<33:32, 251.55s/it]
Task 8, Epoch 13/20 => Loss 0.467, Loss_clf 0.256, Loss_aux 0.211, Train_accy 92.67:  65%|██████▌   | 13/20 [53:22<27:26, 235.18s/it]
Task 8, Epoch 14/20 => Loss 0.424, Loss_clf 0.241, Loss_aux 0.184, Train_accy 93.19:  65%|██████▌   | 13/20 [56:40<27:26, 235.18s/it]
Task 8, Epoch 14/20 => Loss 0.424, Loss_clf 0.241, Loss_aux 0.184, Train_accy 93.19:  70%|███████   | 14/20 [56:40<22:22, 223.83s/it]
Task 8, Epoch 15/20 => Loss 0.461, Loss_clf 0.261, Loss_aux 0.200, Train_accy 92.89:  70%|███████   | 14/20 [59:57<22:22, 223.83s/it]
Task 8, Epoch 15/20 => Loss 0.461, Loss_clf 0.261, Loss_aux 0.200, Train_accy 92.89:  75%|███████▌  | 15/20 [59:57<17:59, 215.88s/it]
Task 8, Epoch 16/20 => Loss 0.448, Loss_clf 0.253, Loss_aux 0.195, Train_accy 92.71, Test_accy 80.19:  75%|███████▌  | 15/20 [1:06:47<17:59, 215.88s/it]
Task 8, Epoch 16/20 => Loss 0.448, Loss_clf 0.253, Loss_aux 0.195, Train_accy 92.71, Test_accy 80.19:  80%|████████  | 16/20 [1:06:47<18:16, 274.24s/it]
Task 8, Epoch 17/20 => Loss 0.433, Loss_clf 0.243, Loss_aux 0.190, Train_accy 93.06:  80%|████████  | 16/20 [1:10:04<18:16, 274.24s/it]                 
Task 8, Epoch 17/20 => Loss 0.433, Loss_clf 0.243, Loss_aux 0.190, Train_accy 93.06:  85%|████████▌ | 17/20 [1:10:04<12:33, 251.15s/it]
Task 8, Epoch 18/20 => Loss 0.428, Loss_clf 0.244, Loss_aux 0.184, Train_accy 93.19:  85%|████████▌ | 17/20 [1:13:22<12:33, 251.15s/it]
Task 8, Epoch 18/20 => Loss 0.428, Loss_clf 0.244, Loss_aux 0.184, Train_accy 93.19:  90%|█████████ | 18/20 [1:13:22<07:50, 235.03s/it]
Task 8, Epoch 19/20 => Loss 0.420, Loss_clf 0.240, Loss_aux 0.179, Train_accy 93.24:  90%|█████████ | 18/20 [1:16:39<07:50, 235.03s/it]
Task 8, Epoch 19/20 => Loss 0.420, Loss_clf 0.240, Loss_aux 0.179, Train_accy 93.24:  95%|█████████▌| 19/20 [1:16:39<03:43, 223.72s/it]
Task 8, Epoch 20/20 => Loss 0.426, Loss_clf 0.240, Loss_aux 0.186, Train_accy 93.56:  95%|█████████▌| 19/20 [1:19:57<03:43, 223.72s/it]
Task 8, Epoch 20/20 => Loss 0.426, Loss_clf 0.240, Loss_aux 0.186, Train_accy 93.56: 100%|██████████| 20/20 [1:19:57<00:00, 215.85s/it]
Task 8, Epoch 20/20 => Loss 0.426, Loss_clf 0.240, Loss_aux 0.186, Train_accy 93.56: 100%|██████████| 20/20 [1:19:57<00:00, 239.86s/it]
2024-09-04 20:22:41,901 [der.py] => Task 8, Epoch 20/20 => Loss 0.426, Loss_clf 0.240, Loss_aux 0.186, Train_accy 93.56
2024-09-04 20:22:41,903 [base.py] => Reducing exemplars...(22 per classes)
2024-09-04 20:23:51,701 [base.py] => Constructing exemplars...(22 per classes)
2024-09-04 20:33:11,361 [der.py] => Exemplar size: 1980
2024-09-04 20:33:11,362 [trainer.py] => CNN: {'total': 79.58, '00-09': 73.9, '10-19': 71.2, '20-29': 80.7, '30-39': 79.9, '40-49': 74.8, '50-59': 72.4, '60-69': 82.5, '70-79': 83.5, '80-89': 97.3, 'old': 77.36, 'new': 97.3}
2024-09-04 20:33:11,362 [trainer.py] => NME: {'total': 84.81, '00-09': 82.2, '10-19': 79.2, '20-29': 91.0, '30-39': 85.6, '40-49': 83.5, '50-59': 77.2, '60-69': 87.5, '70-79': 88.1, '80-89': 89.0, 'old': 84.29, 'new': 89.0}
2024-09-04 20:33:11,362 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87, 92.8, 89.34, 87.87, 87.37, 81.28, 79.58]
2024-09-04 20:33:11,362 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3, 99.0, 98.48, 98.12, 97.8, 96.71, 95.69]
2024-09-04 20:33:11,362 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47, 93.32, 91.7, 90.32, 89.24, 86.71, 84.81]
2024-09-04 20:33:11,362 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53, 99.42, 99.4, 99.0, 98.81, 98.44, 97.7]

Average Accuracy (CNN): 89.67
Average Accuracy (NME): 91.77
2024-09-04 20:33:11,362 [trainer.py] => Average Accuracy (CNN): 89.67
2024-09-04 20:33:11,362 [trainer.py] => Average Accuracy (NME): 91.77
2024-09-04 20:33:11,367 [trainer.py] => All params: 772818533
2024-09-04 20:33:11,371 [trainer.py] => Trainable params: 86429285
2024-09-04 20:33:13,046 [der.py] => Learning on 90-100
2024-09-04 20:33:13,057 [der.py] => All params: 858763119
2024-09-04 20:33:13,061 [der.py] => Trainable params: 86575215

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.731, Loss_clf 1.088, Loss_aux 0.643, Train_accy 79.94, Test_accy 78.30:   0%|          | 0/20 [07:55<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.731, Loss_clf 1.088, Loss_aux 0.643, Train_accy 79.94, Test_accy 78.30:   5%|▌         | 1/20 [07:55<2:30:36, 475.58s/it]
Task 9, Epoch 2/20 => Loss 0.748, Loss_clf 0.411, Loss_aux 0.337, Train_accy 88.50:   5%|▌         | 1/20 [11:30<2:30:36, 475.58s/it]                 
Task 9, Epoch 2/20 => Loss 0.748, Loss_clf 0.411, Loss_aux 0.337, Train_accy 88.50:  10%|█         | 2/20 [11:30<1:36:38, 322.12s/it]
Task 9, Epoch 3/20 => Loss 0.664, Loss_clf 0.364, Loss_aux 0.300, Train_accy 89.14:  10%|█         | 2/20 [15:05<1:36:38, 322.12s/it]
Task 9, Epoch 3/20 => Loss 0.664, Loss_clf 0.364, Loss_aux 0.300, Train_accy 89.14:  15%|█▌        | 3/20 [15:05<1:17:25, 273.24s/it]
Task 9, Epoch 4/20 => Loss 0.612, Loss_clf 0.335, Loss_aux 0.277, Train_accy 90.17:  15%|█▌        | 3/20 [18:40<1:17:25, 273.24s/it]
Task 9, Epoch 4/20 => Loss 0.612, Loss_clf 0.335, Loss_aux 0.277, Train_accy 90.17:  20%|██        | 4/20 [18:40<1:06:42, 250.15s/it]
Task 9, Epoch 5/20 => Loss 0.585, Loss_clf 0.322, Loss_aux 0.262, Train_accy 90.72:  20%|██        | 4/20 [22:18<1:06:42, 250.15s/it]
Task 9, Epoch 5/20 => Loss 0.585, Loss_clf 0.322, Loss_aux 0.262, Train_accy 90.72:  25%|██▌       | 5/20 [22:18<59:38, 238.56s/it]  
Task 9, Epoch 6/20 => Loss 0.575, Loss_clf 0.320, Loss_aux 0.255, Train_accy 90.72, Test_accy 78.36:  25%|██▌       | 5/20 [30:26<59:38, 238.56s/it]
Task 9, Epoch 6/20 => Loss 0.575, Loss_clf 0.320, Loss_aux 0.255, Train_accy 90.72, Test_accy 78.36:  30%|███       | 6/20 [30:26<1:15:26, 323.33s/it]
Task 9, Epoch 7/20 => Loss 0.539, Loss_clf 0.297, Loss_aux 0.242, Train_accy 91.35:  30%|███       | 6/20 [34:05<1:15:26, 323.33s/it]                 
Task 9, Epoch 7/20 => Loss 0.539, Loss_clf 0.297, Loss_aux 0.242, Train_accy 91.35:  35%|███▌      | 7/20 [34:05<1:02:44, 289.55s/it]
Task 9, Epoch 8/20 => Loss 0.516, Loss_clf 0.286, Loss_aux 0.230, Train_accy 91.79:  35%|███▌      | 7/20 [37:46<1:02:44, 289.55s/it]
Task 9, Epoch 8/20 => Loss 0.516, Loss_clf 0.286, Loss_aux 0.230, Train_accy 91.79:  40%|████      | 8/20 [37:46<53:29, 267.42s/it]  
Task 9, Epoch 9/20 => Loss 0.526, Loss_clf 0.295, Loss_aux 0.231, Train_accy 91.48:  40%|████      | 8/20 [41:26<53:29, 267.42s/it]
Task 9, Epoch 9/20 => Loss 0.526, Loss_clf 0.295, Loss_aux 0.231, Train_accy 91.48:  45%|████▌     | 9/20 [41:26<46:20, 252.73s/it]
Task 9, Epoch 10/20 => Loss 0.518, Loss_clf 0.291, Loss_aux 0.227, Train_accy 91.69:  45%|████▌     | 9/20 [45:07<46:20, 252.73s/it]
Task 9, Epoch 10/20 => Loss 0.518, Loss_clf 0.291, Loss_aux 0.227, Train_accy 91.69:  50%|█████     | 10/20 [45:07<40:28, 242.83s/it]
Task 9, Epoch 11/20 => Loss 0.461, Loss_clf 0.254, Loss_aux 0.207, Train_accy 92.79, Test_accy 78.52:  50%|█████     | 10/20 [53:15<40:28, 242.83s/it]
Task 9, Epoch 11/20 => Loss 0.461, Loss_clf 0.254, Loss_aux 0.207, Train_accy 92.79, Test_accy 78.52:  55%|█████▌    | 11/20 [53:15<47:42, 318.06s/it]
Task 9, Epoch 12/20 => Loss 0.521, Loss_clf 0.291, Loss_aux 0.230, Train_accy 91.78:  55%|█████▌    | 11/20 [56:56<47:42, 318.06s/it]                 
Task 9, Epoch 12/20 => Loss 0.521, Loss_clf 0.291, Loss_aux 0.230, Train_accy 91.78:  60%|██████    | 12/20 [56:56<38:28, 288.60s/it]
Task 9, Epoch 13/20 => Loss 0.457, Loss_clf 0.263, Loss_aux 0.195, Train_accy 92.78:  60%|██████    | 12/20 [1:00:37<38:28, 288.60s/it]
Task 9, Epoch 13/20 => Loss 0.457, Loss_clf 0.263, Loss_aux 0.195, Train_accy 92.78:  65%|██████▌   | 13/20 [1:00:37<31:16, 268.05s/it]
Task 9, Epoch 14/20 => Loss 0.463, Loss_clf 0.256, Loss_aux 0.207, Train_accy 92.85:  65%|██████▌   | 13/20 [1:04:19<31:16, 268.05s/it]
Task 9, Epoch 14/20 => Loss 0.463, Loss_clf 0.256, Loss_aux 0.207, Train_accy 92.85:  70%|███████   | 14/20 [1:04:19<25:23, 253.99s/it]
Task 9, Epoch 15/20 => Loss 0.485, Loss_clf 0.269, Loss_aux 0.215, Train_accy 92.59:  70%|███████   | 14/20 [1:08:00<25:23, 253.99s/it]
Task 9, Epoch 15/20 => Loss 0.485, Loss_clf 0.269, Loss_aux 0.215, Train_accy 92.59:  75%|███████▌  | 15/20 [1:08:00<20:20, 244.14s/it]
Task 9, Epoch 16/20 => Loss 0.449, Loss_clf 0.253, Loss_aux 0.196, Train_accy 92.75, Test_accy 78.24:  75%|███████▌  | 15/20 [1:16:11<20:20, 244.14s/it]
Task 9, Epoch 16/20 => Loss 0.449, Loss_clf 0.253, Loss_aux 0.196, Train_accy 92.75, Test_accy 78.24:  80%|████████  | 16/20 [1:16:11<21:13, 318.28s/it]
Task 9, Epoch 17/20 => Loss 0.437, Loss_clf 0.250, Loss_aux 0.187, Train_accy 93.14:  80%|████████  | 16/20 [1:19:52<21:13, 318.28s/it]                 
Task 9, Epoch 17/20 => Loss 0.437, Loss_clf 0.250, Loss_aux 0.187, Train_accy 93.14:  85%|████████▌ | 17/20 [1:19:52<14:27, 289.11s/it]
Task 9, Epoch 18/20 => Loss 0.460, Loss_clf 0.260, Loss_aux 0.201, Train_accy 92.68:  85%|████████▌ | 17/20 [1:23:33<14:27, 289.11s/it]
Task 9, Epoch 18/20 => Loss 0.460, Loss_clf 0.260, Loss_aux 0.201, Train_accy 92.68:  90%|█████████ | 18/20 [1:23:33<08:57, 268.72s/it]
Task 9, Epoch 19/20 => Loss 0.430, Loss_clf 0.247, Loss_aux 0.183, Train_accy 92.89:  90%|█████████ | 18/20 [1:27:14<08:57, 268.72s/it]
Task 9, Epoch 19/20 => Loss 0.430, Loss_clf 0.247, Loss_aux 0.183, Train_accy 92.89:  95%|█████████▌| 19/20 [1:27:14<04:14, 254.47s/it]
Task 9, Epoch 20/20 => Loss 0.439, Loss_clf 0.247, Loss_aux 0.192, Train_accy 93.15:  95%|█████████▌| 19/20 [1:30:56<04:14, 254.47s/it]
Task 9, Epoch 20/20 => Loss 0.439, Loss_clf 0.247, Loss_aux 0.192, Train_accy 93.15: 100%|██████████| 20/20 [1:30:56<00:00, 244.48s/it]
Task 9, Epoch 20/20 => Loss 0.439, Loss_clf 0.247, Loss_aux 0.192, Train_accy 93.15: 100%|██████████| 20/20 [1:30:56<00:00, 272.80s/it]
2024-09-04 22:04:09,222 [der.py] => Task 9, Epoch 20/20 => Loss 0.439, Loss_clf 0.247, Loss_aux 0.192, Train_accy 93.15
2024-09-04 22:04:09,224 [base.py] => Reducing exemplars...(20 per classes)
2024-09-04 22:05:26,960 [base.py] => Constructing exemplars...(20 per classes)
2024-09-04 22:16:57,511 [der.py] => Exemplar size: 2000
2024-09-04 22:16:57,511 [trainer.py] => CNN: {'total': 78.75, '00-09': 67.7, '10-19': 70.6, '20-29': 80.8, '30-39': 78.4, '40-49': 69.8, '50-59': 69.6, '60-69': 83.4, '70-79': 80.7, '80-89': 89.6, '90-99': 96.9, 'old': 76.73, 'new': 96.9}
2024-09-04 22:16:57,511 [trainer.py] => NME: {'total': 84.12, '00-09': 80.5, '10-19': 78.5, '20-29': 89.8, '30-39': 83.6, '40-49': 81.8, '50-59': 75.8, '60-69': 86.7, '70-79': 85.6, '80-89': 90.8, '90-99': 88.1, 'old': 83.68, 'new': 88.1}
2024-09-04 22:16:57,511 [trainer.py] => CNN top1 curve: [98.2, 95.75, 94.87, 92.8, 89.34, 87.87, 87.37, 81.28, 79.58, 78.75]
2024-09-04 22:16:57,511 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.3, 99.0, 98.48, 98.12, 97.8, 96.71, 95.69, 94.54]
2024-09-04 22:16:57,511 [trainer.py] => NME top1 curve: [98.4, 96.0, 95.47, 93.32, 91.7, 90.32, 89.24, 86.71, 84.81, 84.12]
2024-09-04 22:16:57,511 [trainer.py] => NME top5 curve: [100.0, 99.55, 99.53, 99.42, 99.4, 99.0, 98.81, 98.44, 97.7, 97.34]

Average Accuracy (CNN): 88.58
Average Accuracy (NME): 91.01
2024-09-04 22:16:57,511 [trainer.py] => Average Accuracy (CNN): 88.58
2024-09-04 22:16:57,511 [trainer.py] => Average Accuracy (NME): 91.01
Accuracy Matrix (CNN):
[[98.2 95.4 93.2 90.3 86.1 83.3 83.6 76.2 73.9 67.7]
 [ 0.  96.1 92.5 89.8 80.8 83.3 78.9 80.2 71.2 70.6]
 [ 0.   0.  98.9 95.1 92.8 88.  89.6 89.  80.7 80.8]
 [ 0.   0.   0.  96.  90.1 87.  87.4 81.  79.9 78.4]
 [ 0.   0.   0.   0.  96.9 89.1 88.4 75.5 74.8 69.8]
 [ 0.   0.   0.   0.   0.  96.5 86.1 66.3 72.4 69.6]
 [ 0.   0.   0.   0.   0.   0.  97.6 85.7 82.5 83.4]
 [ 0.   0.   0.   0.   0.   0.   0.  96.3 83.5 80.7]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  97.3 89.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  96.9]]
2024-09-04 22:16:57,512 [trainer.py] => Forgetting (CNN): 20.355555555555554
Accuracy Matrix (NME):
[[98.4 97.  95.1 92.9 91.8 89.6 87.7 85.6 82.2 80.5]
 [ 0.  95.  94.  92.2 87.8 86.5 83.6 82.2 79.2 78.5]
 [ 0.   0.  97.3 96.5 94.6 93.3 92.7 92.7 91.  89.8]
 [ 0.   0.   0.  91.7 90.7 89.2 88.1 86.7 85.6 83.6]
 [ 0.   0.   0.   0.  93.6 91.5 91.6 88.6 83.5 81.8]
 [ 0.   0.   0.   0.   0.  91.8 88.6 79.7 77.2 75.8]
 [ 0.   0.   0.   0.   0.   0.  92.4 88.3 87.5 86.7]
 [ 0.   0.   0.   0.   0.   0.   0.  89.9 88.1 85.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  89.  90.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  88.1]]
2024-09-04 22:16:57,513 [trainer.py] => Forgetting (NME): 9.755555555555558
2024-09-04 22:17:00,325 [trainer.py] => config: ./exps/der_cifar_B0_Inc20.json
2024-09-04 22:17:00,325 [trainer.py] => prefix: reproduce
2024-09-04 22:17:00,325 [trainer.py] => dataset: cifar224
2024-09-04 22:17:00,325 [trainer.py] => memory_size: 2000
2024-09-04 22:17:00,325 [trainer.py] => memory_per_class: 20
2024-09-04 22:17:00,325 [trainer.py] => fixed_memory: False
2024-09-04 22:17:00,325 [trainer.py] => shuffle: True
2024-09-04 22:17:00,325 [trainer.py] => init_cls: 5
2024-09-04 22:17:00,325 [trainer.py] => increment: 5
2024-09-04 22:17:00,325 [trainer.py] => model_name: der
2024-09-04 22:17:00,326 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 22:17:00,326 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-04 22:17:00,326 [trainer.py] => seed: 1993
2024-09-04 22:17:00,326 [trainer.py] => init_epoch: 20
2024-09-04 22:17:00,326 [trainer.py] => init_lr: 0.001
2024-09-04 22:17:00,326 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 22:17:00,326 [trainer.py] => init_lr_decay: 0.1
2024-09-04 22:17:00,326 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 22:17:00,326 [trainer.py] => epochs: 20
2024-09-04 22:17:00,326 [trainer.py] => lrate: 0.001
2024-09-04 22:17:00,326 [trainer.py] => milestones: [80, 120, 150]
2024-09-04 22:17:00,326 [trainer.py] => lrate_decay: 0.1
2024-09-04 22:17:00,326 [trainer.py] => batch_size: 48
2024-09-04 22:17:00,326 [trainer.py] => weight_decay: 0.0002
2024-09-04 22:17:00,326 [trainer.py] => T: 2
2024-09-04 22:17:01,426 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 22:17:01,831 [trainer.py] => All params: 0
2024-09-04 22:17:01,831 [trainer.py] => Trainable params: 0
2024-09-04 22:17:03,347 [der.py] => Learning on 0-5
2024-09-04 22:17:03,348 [der.py] => All params: 85807115
2024-09-04 22:17:03,349 [der.py] => Trainable params: 85807115

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.685, Train_accy 76.44, Test_accy 96.20:   0%|          | 0/20 [00:21<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.685, Train_accy 76.44, Test_accy 96.20:   5%|▌         | 1/20 [00:21<06:40, 21.07s/it]
Task 0, Epoch 2/20 => Loss 0.348, Train_accy 87.96:   5%|▌         | 1/20 [00:40<06:40, 21.07s/it]                 
Task 0, Epoch 2/20 => Loss 0.348, Train_accy 87.96:  10%|█         | 2/20 [00:40<05:59, 19.97s/it]
Task 0, Epoch 3/20 => Loss 0.194, Train_accy 93.96:  10%|█         | 2/20 [00:59<05:59, 19.97s/it]
Task 0, Epoch 3/20 => Loss 0.194, Train_accy 93.96:  15%|█▌        | 3/20 [00:59<05:34, 19.66s/it]
Task 0, Epoch 4/20 => Loss 0.155, Train_accy 94.32:  15%|█▌        | 3/20 [01:18<05:34, 19.66s/it]
Task 0, Epoch 4/20 => Loss 0.155, Train_accy 94.32:  20%|██        | 4/20 [01:18<05:12, 19.54s/it]
Task 0, Epoch 5/20 => Loss 0.170, Train_accy 94.60:  20%|██        | 4/20 [01:38<05:12, 19.54s/it]
Task 0, Epoch 5/20 => Loss 0.170, Train_accy 94.60:  25%|██▌       | 5/20 [01:38<04:51, 19.43s/it]
Task 0, Epoch 6/20 => Loss 0.148, Train_accy 94.72, Test_accy 99.20:  25%|██▌       | 5/20 [01:59<04:51, 19.43s/it]
Task 0, Epoch 6/20 => Loss 0.148, Train_accy 94.72, Test_accy 99.20:  30%|███       | 6/20 [01:59<04:40, 20.03s/it]
Task 0, Epoch 7/20 => Loss 0.169, Train_accy 94.32:  30%|███       | 6/20 [02:18<04:40, 20.03s/it]                 
Task 0, Epoch 7/20 => Loss 0.169, Train_accy 94.32:  35%|███▌      | 7/20 [02:18<04:17, 19.81s/it]
Task 0, Epoch 8/20 => Loss 0.140, Train_accy 95.24:  35%|███▌      | 7/20 [02:38<04:17, 19.81s/it]
Task 0, Epoch 8/20 => Loss 0.140, Train_accy 95.24:  40%|████      | 8/20 [02:38<03:55, 19.66s/it]
Task 0, Epoch 9/20 => Loss 0.196, Train_accy 93.08:  40%|████      | 8/20 [02:57<03:55, 19.66s/it]
Task 0, Epoch 9/20 => Loss 0.196, Train_accy 93.08:  45%|████▌     | 9/20 [02:57<03:35, 19.56s/it]
Task 0, Epoch 10/20 => Loss 0.156, Train_accy 95.12:  45%|████▌     | 9/20 [03:16<03:35, 19.56s/it]
Task 0, Epoch 10/20 => Loss 0.156, Train_accy 95.12:  50%|█████     | 10/20 [03:16<03:15, 19.50s/it]
Task 0, Epoch 11/20 => Loss 0.119, Train_accy 95.76, Test_accy 99.20:  50%|█████     | 10/20 [03:37<03:15, 19.50s/it]
Task 0, Epoch 11/20 => Loss 0.119, Train_accy 95.76, Test_accy 99.20:  55%|█████▌    | 11/20 [03:37<02:59, 19.97s/it]
Task 0, Epoch 12/20 => Loss 0.100, Train_accy 96.56:  55%|█████▌    | 11/20 [03:57<02:59, 19.97s/it]                 
Task 0, Epoch 12/20 => Loss 0.100, Train_accy 96.56:  60%|██████    | 12/20 [03:57<02:38, 19.76s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 95.36:  60%|██████    | 12/20 [04:16<02:38, 19.76s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 95.36:  65%|██████▌   | 13/20 [04:16<02:17, 19.64s/it]
Task 0, Epoch 14/20 => Loss 0.113, Train_accy 96.08:  65%|██████▌   | 13/20 [04:35<02:17, 19.64s/it]
Task 0, Epoch 14/20 => Loss 0.113, Train_accy 96.08:  70%|███████   | 14/20 [04:35<01:57, 19.55s/it]
Task 0, Epoch 15/20 => Loss 0.117, Train_accy 96.08:  70%|███████   | 14/20 [04:55<01:57, 19.55s/it]
Task 0, Epoch 15/20 => Loss 0.117, Train_accy 96.08:  75%|███████▌  | 15/20 [04:55<01:37, 19.48s/it]
Task 0, Epoch 16/20 => Loss 0.110, Train_accy 96.36, Test_accy 99.20:  75%|███████▌  | 15/20 [05:16<01:37, 19.48s/it]
Task 0, Epoch 16/20 => Loss 0.110, Train_accy 96.36, Test_accy 99.20:  80%|████████  | 16/20 [05:16<01:19, 19.96s/it]
Task 0, Epoch 17/20 => Loss 0.104, Train_accy 96.44:  80%|████████  | 16/20 [05:35<01:19, 19.96s/it]                 
Task 0, Epoch 17/20 => Loss 0.104, Train_accy 96.44:  85%|████████▌ | 17/20 [05:35<00:59, 19.78s/it]
Task 0, Epoch 18/20 => Loss 0.102, Train_accy 96.20:  85%|████████▌ | 17/20 [05:54<00:59, 19.78s/it]
Task 0, Epoch 18/20 => Loss 0.102, Train_accy 96.20:  90%|█████████ | 18/20 [05:54<00:39, 19.66s/it]
Task 0, Epoch 19/20 => Loss 0.109, Train_accy 96.12:  90%|█████████ | 18/20 [06:14<00:39, 19.66s/it]
Task 0, Epoch 19/20 => Loss 0.109, Train_accy 96.12:  95%|█████████▌| 19/20 [06:14<00:19, 19.55s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.80:  95%|█████████▌| 19/20 [06:33<00:19, 19.55s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.80: 100%|██████████| 20/20 [06:33<00:00, 19.51s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.80: 100%|██████████| 20/20 [06:33<00:00, 19.68s/it]
2024-09-04 22:23:37,435 [der.py] => Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.80
2024-09-04 22:23:37,437 [base.py] => Reducing exemplars...(400 per classes)
2024-09-04 22:23:37,437 [base.py] => Constructing exemplars...(400 per classes)
2024-09-04 22:23:57,826 [der.py] => Exemplar size: 2000
2024-09-04 22:23:57,827 [trainer.py] => CNN: {'total': 99.2, '00-04': 99.2, 'old': 0, 'new': 99.2}
2024-09-04 22:23:57,827 [trainer.py] => NME: {'total': 99.6, '00-04': 99.6, 'old': 0, 'new': 99.6}
2024-09-04 22:23:57,827 [trainer.py] => CNN top1 curve: [99.2]
2024-09-04 22:23:57,827 [trainer.py] => CNN top5 curve: [100.0]
2024-09-04 22:23:57,827 [trainer.py] => NME top1 curve: [99.6]
2024-09-04 22:23:57,827 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.2
Average Accuracy (NME): 99.6
2024-09-04 22:23:57,827 [trainer.py] => Average Accuracy (CNN): 99.2
2024-09-04 22:23:57,827 [trainer.py] => Average Accuracy (NME): 99.6
2024-09-04 22:23:57,828 [trainer.py] => All params: 85807115
2024-09-04 22:23:57,829 [trainer.py] => Trainable params: 85807115
2024-09-04 22:23:59,446 [der.py] => Learning on 5-10
2024-09-04 22:23:59,447 [der.py] => All params: 171617296
2024-09-04 22:23:59,448 [der.py] => Trainable params: 85818640

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.113, Loss_clf 0.548, Loss_aux 0.565, Train_accy 82.11, Test_accy 97.60:   0%|          | 0/20 [00:52<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.113, Loss_clf 0.548, Loss_aux 0.565, Train_accy 82.11, Test_accy 97.60:   5%|▌         | 1/20 [00:52<16:37, 52.49s/it]
Task 1, Epoch 2/20 => Loss 0.632, Loss_clf 0.309, Loss_aux 0.323, Train_accy 89.64:   5%|▌         | 1/20 [01:39<16:37, 52.49s/it]                 
Task 1, Epoch 2/20 => Loss 0.632, Loss_clf 0.309, Loss_aux 0.323, Train_accy 89.64:  10%|█         | 2/20 [01:39<14:42, 49.06s/it]
Task 1, Epoch 3/20 => Loss 0.479, Loss_clf 0.234, Loss_aux 0.245, Train_accy 92.49:  10%|█         | 2/20 [02:25<14:42, 49.06s/it]
Task 1, Epoch 3/20 => Loss 0.479, Loss_clf 0.234, Loss_aux 0.245, Train_accy 92.49:  15%|█▌        | 3/20 [02:25<13:34, 47.93s/it]
Task 1, Epoch 4/20 => Loss 0.490, Loss_clf 0.240, Loss_aux 0.251, Train_accy 91.93:  15%|█▌        | 3/20 [03:12<13:34, 47.93s/it]
Task 1, Epoch 4/20 => Loss 0.490, Loss_clf 0.240, Loss_aux 0.251, Train_accy 91.93:  20%|██        | 4/20 [03:12<12:38, 47.40s/it]
Task 1, Epoch 5/20 => Loss 0.443, Loss_clf 0.218, Loss_aux 0.224, Train_accy 92.56:  20%|██        | 4/20 [03:58<12:38, 47.40s/it]
Task 1, Epoch 5/20 => Loss 0.443, Loss_clf 0.218, Loss_aux 0.224, Train_accy 92.56:  25%|██▌       | 5/20 [03:58<11:46, 47.11s/it]
Task 1, Epoch 6/20 => Loss 0.424, Loss_clf 0.212, Loss_aux 0.212, Train_accy 93.31, Test_accy 98.40:  25%|██▌       | 5/20 [04:51<11:46, 47.11s/it]
Task 1, Epoch 6/20 => Loss 0.424, Loss_clf 0.212, Loss_aux 0.212, Train_accy 93.31, Test_accy 98.40:  30%|███       | 6/20 [04:51<11:25, 48.95s/it]
Task 1, Epoch 7/20 => Loss 0.432, Loss_clf 0.215, Loss_aux 0.217, Train_accy 92.60:  30%|███       | 6/20 [05:37<11:25, 48.95s/it]                 
Task 1, Epoch 7/20 => Loss 0.432, Loss_clf 0.215, Loss_aux 0.217, Train_accy 92.60:  35%|███▌      | 7/20 [05:37<10:25, 48.14s/it]
Task 1, Epoch 8/20 => Loss 0.436, Loss_clf 0.218, Loss_aux 0.219, Train_accy 92.56:  35%|███▌      | 7/20 [06:24<10:25, 48.14s/it]
Task 1, Epoch 8/20 => Loss 0.436, Loss_clf 0.218, Loss_aux 0.219, Train_accy 92.56:  40%|████      | 8/20 [06:24<09:31, 47.61s/it]
Task 1, Epoch 9/20 => Loss 0.375, Loss_clf 0.193, Loss_aux 0.182, Train_accy 93.62:  40%|████      | 8/20 [07:10<09:31, 47.61s/it]
Task 1, Epoch 9/20 => Loss 0.375, Loss_clf 0.193, Loss_aux 0.182, Train_accy 93.62:  45%|████▌     | 9/20 [07:10<08:40, 47.27s/it]
Task 1, Epoch 10/20 => Loss 0.397, Loss_clf 0.202, Loss_aux 0.196, Train_accy 93.64:  45%|████▌     | 9/20 [07:57<08:40, 47.27s/it]
Task 1, Epoch 10/20 => Loss 0.397, Loss_clf 0.202, Loss_aux 0.196, Train_accy 93.64:  50%|█████     | 10/20 [07:57<07:50, 47.05s/it]
Task 1, Epoch 11/20 => Loss 0.408, Loss_clf 0.208, Loss_aux 0.200, Train_accy 93.16, Test_accy 98.40:  50%|█████     | 10/20 [08:49<07:50, 47.05s/it]
Task 1, Epoch 11/20 => Loss 0.408, Loss_clf 0.208, Loss_aux 0.200, Train_accy 93.16, Test_accy 98.40:  55%|█████▌    | 11/20 [08:49<07:18, 48.68s/it]
Task 1, Epoch 12/20 => Loss 0.375, Loss_clf 0.194, Loss_aux 0.181, Train_accy 93.87:  55%|█████▌    | 11/20 [09:36<07:18, 48.68s/it]                 
Task 1, Epoch 12/20 => Loss 0.375, Loss_clf 0.194, Loss_aux 0.181, Train_accy 93.87:  60%|██████    | 12/20 [09:36<06:24, 48.05s/it]
Task 1, Epoch 13/20 => Loss 0.355, Loss_clf 0.182, Loss_aux 0.173, Train_accy 93.78:  60%|██████    | 12/20 [10:23<06:24, 48.05s/it]
Task 1, Epoch 13/20 => Loss 0.355, Loss_clf 0.182, Loss_aux 0.173, Train_accy 93.78:  65%|██████▌   | 13/20 [10:23<05:33, 47.61s/it]
Task 1, Epoch 14/20 => Loss 0.352, Loss_clf 0.180, Loss_aux 0.172, Train_accy 93.76:  65%|██████▌   | 13/20 [11:09<05:33, 47.61s/it]
Task 1, Epoch 14/20 => Loss 0.352, Loss_clf 0.180, Loss_aux 0.172, Train_accy 93.76:  70%|███████   | 14/20 [11:09<04:44, 47.36s/it]
Task 1, Epoch 15/20 => Loss 0.381, Loss_clf 0.196, Loss_aux 0.185, Train_accy 93.67:  70%|███████   | 14/20 [11:56<04:44, 47.36s/it]
Task 1, Epoch 15/20 => Loss 0.381, Loss_clf 0.196, Loss_aux 0.185, Train_accy 93.67:  75%|███████▌  | 15/20 [11:56<03:55, 47.13s/it]
Task 1, Epoch 16/20 => Loss 0.356, Loss_clf 0.185, Loss_aux 0.172, Train_accy 93.87, Test_accy 98.60:  75%|███████▌  | 15/20 [12:49<03:55, 47.13s/it]
Task 1, Epoch 16/20 => Loss 0.356, Loss_clf 0.185, Loss_aux 0.172, Train_accy 93.87, Test_accy 98.60:  80%|████████  | 16/20 [12:49<03:15, 48.77s/it]
Task 1, Epoch 17/20 => Loss 0.316, Loss_clf 0.164, Loss_aux 0.152, Train_accy 94.58:  80%|████████  | 16/20 [13:35<03:15, 48.77s/it]                 
Task 1, Epoch 17/20 => Loss 0.316, Loss_clf 0.164, Loss_aux 0.152, Train_accy 94.58:  85%|████████▌ | 17/20 [13:35<02:24, 48.14s/it]
Task 1, Epoch 18/20 => Loss 0.335, Loss_clf 0.173, Loss_aux 0.162, Train_accy 94.11:  85%|████████▌ | 17/20 [14:22<02:24, 48.14s/it]
Task 1, Epoch 18/20 => Loss 0.335, Loss_clf 0.173, Loss_aux 0.162, Train_accy 94.11:  90%|█████████ | 18/20 [14:22<01:35, 47.74s/it]
Task 1, Epoch 19/20 => Loss 0.328, Loss_clf 0.174, Loss_aux 0.154, Train_accy 94.24:  90%|█████████ | 18/20 [15:09<01:35, 47.74s/it]
Task 1, Epoch 19/20 => Loss 0.328, Loss_clf 0.174, Loss_aux 0.154, Train_accy 94.24:  95%|█████████▌| 19/20 [15:09<00:47, 47.39s/it]
Task 1, Epoch 20/20 => Loss 0.324, Loss_clf 0.167, Loss_aux 0.157, Train_accy 94.31:  95%|█████████▌| 19/20 [15:55<00:47, 47.39s/it]
Task 1, Epoch 20/20 => Loss 0.324, Loss_clf 0.167, Loss_aux 0.157, Train_accy 94.31: 100%|██████████| 20/20 [15:55<00:00, 47.12s/it]
Task 1, Epoch 20/20 => Loss 0.324, Loss_clf 0.167, Loss_aux 0.157, Train_accy 94.31: 100%|██████████| 20/20 [15:55<00:00, 47.78s/it]
2024-09-04 22:39:55,099 [der.py] => Task 1, Epoch 20/20 => Loss 0.324, Loss_clf 0.167, Loss_aux 0.157, Train_accy 94.31
2024-09-04 22:39:55,101 [base.py] => Reducing exemplars...(200 per classes)
2024-09-04 22:40:02,102 [base.py] => Constructing exemplars...(200 per classes)
2024-09-04 22:40:37,757 [der.py] => Exemplar size: 2000
2024-09-04 22:40:37,757 [trainer.py] => CNN: {'total': 97.8, '00-04': 98.6, '05-09': 97.0, 'old': 98.6, 'new': 97.0}
2024-09-04 22:40:37,757 [trainer.py] => NME: {'total': 97.7, '00-04': 99.0, '05-09': 96.4, 'old': 99.0, 'new': 96.4}
2024-09-04 22:40:37,757 [trainer.py] => CNN top1 curve: [99.2, 97.8]
2024-09-04 22:40:37,757 [trainer.py] => CNN top5 curve: [100.0, 100.0]
2024-09-04 22:40:37,757 [trainer.py] => NME top1 curve: [99.6, 97.7]
2024-09-04 22:40:37,757 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 98.5
Average Accuracy (NME): 98.65
2024-09-04 22:40:37,758 [trainer.py] => Average Accuracy (CNN): 98.5
2024-09-04 22:40:37,758 [trainer.py] => Average Accuracy (NME): 98.65
2024-09-04 22:40:37,759 [trainer.py] => All params: 171617296
2024-09-04 22:40:37,760 [trainer.py] => Trainable params: 85818640
2024-09-04 22:40:39,482 [der.py] => Learning on 10-15
2024-09-04 22:40:39,484 [der.py] => All params: 257435157
2024-09-04 22:40:39,485 [der.py] => Trainable params: 85837845

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.187, Loss_clf 0.649, Loss_aux 0.537, Train_accy 81.40, Test_accy 96.33:   0%|          | 0/20 [01:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.187, Loss_clf 0.649, Loss_aux 0.537, Train_accy 81.40, Test_accy 96.33:   5%|▌         | 1/20 [01:11<22:29, 71.05s/it]
Task 2, Epoch 2/20 => Loss 0.603, Loss_clf 0.321, Loss_aux 0.282, Train_accy 89.31:   5%|▌         | 1/20 [02:09<22:29, 71.05s/it]                 
Task 2, Epoch 2/20 => Loss 0.603, Loss_clf 0.321, Loss_aux 0.282, Train_accy 89.31:  10%|█         | 2/20 [02:09<19:07, 63.75s/it]
Task 2, Epoch 3/20 => Loss 0.544, Loss_clf 0.290, Loss_aux 0.253, Train_accy 90.47:  10%|█         | 2/20 [03:08<19:07, 63.75s/it]
Task 2, Epoch 3/20 => Loss 0.544, Loss_clf 0.290, Loss_aux 0.253, Train_accy 90.47:  15%|█▌        | 3/20 [03:08<17:23, 61.37s/it]
Task 2, Epoch 4/20 => Loss 0.502, Loss_clf 0.268, Loss_aux 0.235, Train_accy 91.18:  15%|█▌        | 3/20 [04:06<17:23, 61.37s/it]
Task 2, Epoch 4/20 => Loss 0.502, Loss_clf 0.268, Loss_aux 0.235, Train_accy 91.18:  20%|██        | 4/20 [04:06<16:03, 60.25s/it]
Task 2, Epoch 5/20 => Loss 0.501, Loss_clf 0.277, Loss_aux 0.224, Train_accy 91.31:  20%|██        | 4/20 [05:05<16:03, 60.25s/it]
Task 2, Epoch 5/20 => Loss 0.501, Loss_clf 0.277, Loss_aux 0.224, Train_accy 91.31:  25%|██▌       | 5/20 [05:05<14:54, 59.64s/it]
Task 2, Epoch 6/20 => Loss 0.523, Loss_clf 0.275, Loss_aux 0.248, Train_accy 90.64, Test_accy 96.47:  25%|██▌       | 5/20 [06:16<14:54, 59.64s/it]
Task 2, Epoch 6/20 => Loss 0.523, Loss_clf 0.275, Loss_aux 0.248, Train_accy 90.64, Test_accy 96.47:  30%|███       | 6/20 [06:16<14:49, 63.55s/it]
Task 2, Epoch 7/20 => Loss 0.456, Loss_clf 0.242, Loss_aux 0.214, Train_accy 91.98:  30%|███       | 6/20 [07:15<14:49, 63.55s/it]                 
Task 2, Epoch 7/20 => Loss 0.456, Loss_clf 0.242, Loss_aux 0.214, Train_accy 91.98:  35%|███▌      | 7/20 [07:15<13:25, 61.97s/it]
Task 2, Epoch 8/20 => Loss 0.424, Loss_clf 0.234, Loss_aux 0.190, Train_accy 92.27:  35%|███▌      | 7/20 [08:13<13:25, 61.97s/it]
Task 2, Epoch 8/20 => Loss 0.424, Loss_clf 0.234, Loss_aux 0.190, Train_accy 92.27:  40%|████      | 8/20 [08:13<12:10, 60.90s/it]
Task 2, Epoch 9/20 => Loss 0.422, Loss_clf 0.219, Loss_aux 0.203, Train_accy 92.91:  40%|████      | 8/20 [09:12<12:10, 60.90s/it]
Task 2, Epoch 9/20 => Loss 0.422, Loss_clf 0.219, Loss_aux 0.203, Train_accy 92.91:  45%|████▌     | 9/20 [09:12<11:02, 60.19s/it]
Task 2, Epoch 10/20 => Loss 0.450, Loss_clf 0.245, Loss_aux 0.205, Train_accy 92.31:  45%|████▌     | 9/20 [10:11<11:02, 60.19s/it]
Task 2, Epoch 10/20 => Loss 0.450, Loss_clf 0.245, Loss_aux 0.205, Train_accy 92.31:  50%|█████     | 10/20 [10:11<09:57, 59.71s/it]
Task 2, Epoch 11/20 => Loss 0.417, Loss_clf 0.227, Loss_aux 0.190, Train_accy 92.69, Test_accy 96.67:  50%|█████     | 10/20 [11:22<09:57, 59.71s/it]
Task 2, Epoch 11/20 => Loss 0.417, Loss_clf 0.227, Loss_aux 0.190, Train_accy 92.69, Test_accy 96.67:  55%|█████▌    | 11/20 [11:22<09:28, 63.22s/it]
Task 2, Epoch 12/20 => Loss 0.408, Loss_clf 0.224, Loss_aux 0.183, Train_accy 93.04:  55%|█████▌    | 11/20 [12:20<09:28, 63.22s/it]                 
Task 2, Epoch 12/20 => Loss 0.408, Loss_clf 0.224, Loss_aux 0.183, Train_accy 93.04:  60%|██████    | 12/20 [12:20<08:14, 61.79s/it]
Task 2, Epoch 13/20 => Loss 0.407, Loss_clf 0.233, Loss_aux 0.174, Train_accy 92.69:  60%|██████    | 12/20 [13:19<08:14, 61.79s/it]
Task 2, Epoch 13/20 => Loss 0.407, Loss_clf 0.233, Loss_aux 0.174, Train_accy 92.69:  65%|██████▌   | 13/20 [13:19<07:05, 60.80s/it]
Task 2, Epoch 14/20 => Loss 0.385, Loss_clf 0.214, Loss_aux 0.171, Train_accy 93.04:  65%|██████▌   | 13/20 [14:17<07:05, 60.80s/it]
Task 2, Epoch 14/20 => Loss 0.385, Loss_clf 0.214, Loss_aux 0.171, Train_accy 93.04:  70%|███████   | 14/20 [14:17<06:00, 60.12s/it]
Task 2, Epoch 15/20 => Loss 0.389, Loss_clf 0.209, Loss_aux 0.181, Train_accy 93.02:  70%|███████   | 14/20 [15:16<06:00, 60.12s/it]
Task 2, Epoch 15/20 => Loss 0.389, Loss_clf 0.209, Loss_aux 0.181, Train_accy 93.02:  75%|███████▌  | 15/20 [15:16<04:58, 59.63s/it]
Task 2, Epoch 16/20 => Loss 0.414, Loss_clf 0.226, Loss_aux 0.187, Train_accy 92.96, Test_accy 97.20:  75%|███████▌  | 15/20 [16:27<04:58, 59.63s/it]
Task 2, Epoch 16/20 => Loss 0.414, Loss_clf 0.226, Loss_aux 0.187, Train_accy 92.96, Test_accy 97.20:  80%|████████  | 16/20 [16:27<04:12, 63.08s/it]
Task 2, Epoch 17/20 => Loss 0.390, Loss_clf 0.226, Loss_aux 0.163, Train_accy 92.80:  80%|████████  | 16/20 [17:25<04:12, 63.08s/it]                 
Task 2, Epoch 17/20 => Loss 0.390, Loss_clf 0.226, Loss_aux 0.163, Train_accy 92.80:  85%|████████▌ | 17/20 [17:25<03:05, 61.70s/it]
Task 2, Epoch 18/20 => Loss 0.376, Loss_clf 0.212, Loss_aux 0.164, Train_accy 93.11:  85%|████████▌ | 17/20 [18:24<03:05, 61.70s/it]
Task 2, Epoch 18/20 => Loss 0.376, Loss_clf 0.212, Loss_aux 0.164, Train_accy 93.11:  90%|█████████ | 18/20 [18:24<02:01, 60.78s/it]
Task 2, Epoch 19/20 => Loss 0.381, Loss_clf 0.211, Loss_aux 0.170, Train_accy 92.89:  90%|█████████ | 18/20 [19:23<02:01, 60.78s/it]
Task 2, Epoch 19/20 => Loss 0.381, Loss_clf 0.211, Loss_aux 0.170, Train_accy 92.89:  95%|█████████▌| 19/20 [19:23<01:00, 60.10s/it]
Task 2, Epoch 20/20 => Loss 0.377, Loss_clf 0.207, Loss_aux 0.169, Train_accy 93.22:  95%|█████████▌| 19/20 [20:21<01:00, 60.10s/it]
Task 2, Epoch 20/20 => Loss 0.377, Loss_clf 0.207, Loss_aux 0.169, Train_accy 93.22: 100%|██████████| 20/20 [20:21<00:00, 59.63s/it]
Task 2, Epoch 20/20 => Loss 0.377, Loss_clf 0.207, Loss_aux 0.169, Train_accy 93.22: 100%|██████████| 20/20 [20:21<00:00, 61.08s/it]
2024-09-04 23:01:01,137 [der.py] => Task 2, Epoch 20/20 => Loss 0.377, Loss_clf 0.207, Loss_aux 0.169, Train_accy 93.22
2024-09-04 23:01:01,138 [base.py] => Reducing exemplars...(133 per classes)
2024-09-04 23:01:15,033 [base.py] => Constructing exemplars...(133 per classes)
2024-09-04 23:02:10,868 [der.py] => Exemplar size: 1995
2024-09-04 23:02:10,868 [trainer.py] => CNN: {'total': 97.53, '00-04': 98.4, '05-09': 96.0, '10-14': 98.2, 'old': 97.2, 'new': 98.2}
2024-09-04 23:02:10,868 [trainer.py] => NME: {'total': 97.2, '00-04': 99.8, '05-09': 96.2, '10-14': 95.6, 'old': 98.0, 'new': 95.6}
2024-09-04 23:02:10,868 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53]
2024-09-04 23:02:10,868 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0]
2024-09-04 23:02:10,868 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2]
2024-09-04 23:02:10,868 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73]

Average Accuracy (CNN): 98.18
Average Accuracy (NME): 98.17
2024-09-04 23:02:10,868 [trainer.py] => Average Accuracy (CNN): 98.18
2024-09-04 23:02:10,868 [trainer.py] => Average Accuracy (NME): 98.17
2024-09-04 23:02:10,870 [trainer.py] => All params: 257435157
2024-09-04 23:02:10,871 [trainer.py] => Trainable params: 85837845
2024-09-04 23:02:12,396 [der.py] => Learning on 15-20
2024-09-04 23:02:12,400 [der.py] => All params: 343260698
2024-09-04 23:02:12,402 [der.py] => Trainable params: 85864730

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.211, Loss_clf 0.704, Loss_aux 0.507, Train_accy 81.51, Test_accy 93.35:   0%|          | 0/20 [01:32<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.211, Loss_clf 0.704, Loss_aux 0.507, Train_accy 81.51, Test_accy 93.35:   5%|▌         | 1/20 [01:32<29:19, 92.62s/it]
Task 3, Epoch 2/20 => Loss 0.646, Loss_clf 0.356, Loss_aux 0.291, Train_accy 88.83:   5%|▌         | 1/20 [02:43<29:19, 92.62s/it]                 
Task 3, Epoch 2/20 => Loss 0.646, Loss_clf 0.356, Loss_aux 0.291, Train_accy 88.83:  10%|█         | 2/20 [02:43<23:52, 79.57s/it]
Task 3, Epoch 3/20 => Loss 0.546, Loss_clf 0.300, Loss_aux 0.246, Train_accy 90.08:  10%|█         | 2/20 [03:53<23:52, 79.57s/it]
Task 3, Epoch 3/20 => Loss 0.546, Loss_clf 0.300, Loss_aux 0.246, Train_accy 90.08:  15%|█▌        | 3/20 [03:53<21:21, 75.39s/it]
Task 3, Epoch 4/20 => Loss 0.560, Loss_clf 0.312, Loss_aux 0.248, Train_accy 89.61:  15%|█▌        | 3/20 [05:03<21:21, 75.39s/it]
Task 3, Epoch 4/20 => Loss 0.560, Loss_clf 0.312, Loss_aux 0.248, Train_accy 89.61:  20%|██        | 4/20 [05:03<19:35, 73.46s/it]
Task 3, Epoch 5/20 => Loss 0.501, Loss_clf 0.276, Loss_aux 0.225, Train_accy 91.50:  20%|██        | 4/20 [06:14<19:35, 73.46s/it]
Task 3, Epoch 5/20 => Loss 0.501, Loss_clf 0.276, Loss_aux 0.225, Train_accy 91.50:  25%|██▌       | 5/20 [06:14<18:05, 72.38s/it]
Task 3, Epoch 6/20 => Loss 0.498, Loss_clf 0.284, Loss_aux 0.214, Train_accy 90.88, Test_accy 95.15:  25%|██▌       | 5/20 [07:47<18:05, 72.38s/it]
Task 3, Epoch 6/20 => Loss 0.498, Loss_clf 0.284, Loss_aux 0.214, Train_accy 90.88, Test_accy 95.15:  30%|███       | 6/20 [07:47<18:30, 79.29s/it]
Task 3, Epoch 7/20 => Loss 0.477, Loss_clf 0.264, Loss_aux 0.213, Train_accy 91.68:  30%|███       | 6/20 [08:57<18:30, 79.29s/it]                 
Task 3, Epoch 7/20 => Loss 0.477, Loss_clf 0.264, Loss_aux 0.213, Train_accy 91.68:  35%|███▌      | 7/20 [08:57<16:33, 76.43s/it]
Task 3, Epoch 8/20 => Loss 0.466, Loss_clf 0.250, Loss_aux 0.216, Train_accy 92.12:  35%|███▌      | 7/20 [10:08<16:33, 76.43s/it]
Task 3, Epoch 8/20 => Loss 0.466, Loss_clf 0.250, Loss_aux 0.216, Train_accy 92.12:  40%|████      | 8/20 [10:08<14:54, 74.52s/it]
Task 3, Epoch 9/20 => Loss 0.463, Loss_clf 0.262, Loss_aux 0.200, Train_accy 91.99:  40%|████      | 8/20 [11:18<14:54, 74.52s/it]
Task 3, Epoch 9/20 => Loss 0.463, Loss_clf 0.262, Loss_aux 0.200, Train_accy 91.99:  45%|████▌     | 9/20 [11:18<13:25, 73.27s/it]
Task 3, Epoch 10/20 => Loss 0.436, Loss_clf 0.246, Loss_aux 0.191, Train_accy 92.24:  45%|████▌     | 9/20 [12:29<13:25, 73.27s/it]
Task 3, Epoch 10/20 => Loss 0.436, Loss_clf 0.246, Loss_aux 0.191, Train_accy 92.24:  50%|█████     | 10/20 [12:29<12:03, 72.39s/it]
Task 3, Epoch 11/20 => Loss 0.437, Loss_clf 0.241, Loss_aux 0.196, Train_accy 92.26, Test_accy 95.45:  50%|█████     | 10/20 [14:01<12:03, 72.39s/it]
Task 3, Epoch 11/20 => Loss 0.437, Loss_clf 0.241, Loss_aux 0.196, Train_accy 92.26, Test_accy 95.45:  55%|█████▌    | 11/20 [14:01<11:46, 78.54s/it]
Task 3, Epoch 12/20 => Loss 0.408, Loss_clf 0.232, Loss_aux 0.176, Train_accy 92.93:  55%|█████▌    | 11/20 [15:12<11:46, 78.54s/it]                 
Task 3, Epoch 12/20 => Loss 0.408, Loss_clf 0.232, Loss_aux 0.176, Train_accy 92.93:  60%|██████    | 12/20 [15:12<10:08, 76.11s/it]
Task 3, Epoch 13/20 => Loss 0.439, Loss_clf 0.250, Loss_aux 0.189, Train_accy 92.08:  60%|██████    | 12/20 [16:22<10:08, 76.11s/it]
Task 3, Epoch 13/20 => Loss 0.439, Loss_clf 0.250, Loss_aux 0.189, Train_accy 92.08:  65%|██████▌   | 13/20 [16:22<08:41, 74.45s/it]
Task 3, Epoch 14/20 => Loss 0.460, Loss_clf 0.261, Loss_aux 0.199, Train_accy 91.84:  65%|██████▌   | 13/20 [17:33<08:41, 74.45s/it]
Task 3, Epoch 14/20 => Loss 0.460, Loss_clf 0.261, Loss_aux 0.199, Train_accy 91.84:  70%|███████   | 14/20 [17:33<07:19, 73.27s/it]
Task 3, Epoch 15/20 => Loss 0.409, Loss_clf 0.237, Loss_aux 0.172, Train_accy 92.39:  70%|███████   | 14/20 [18:43<07:19, 73.27s/it]
Task 3, Epoch 15/20 => Loss 0.409, Loss_clf 0.237, Loss_aux 0.172, Train_accy 92.39:  75%|███████▌  | 15/20 [18:43<06:02, 72.41s/it]
Task 3, Epoch 16/20 => Loss 0.368, Loss_clf 0.211, Loss_aux 0.158, Train_accy 93.17, Test_accy 96.10:  75%|███████▌  | 15/20 [20:16<06:02, 72.41s/it]
Task 3, Epoch 16/20 => Loss 0.368, Loss_clf 0.211, Loss_aux 0.158, Train_accy 93.17, Test_accy 96.10:  80%|████████  | 16/20 [20:16<05:13, 78.45s/it]
Task 3, Epoch 17/20 => Loss 0.421, Loss_clf 0.245, Loss_aux 0.176, Train_accy 92.08:  80%|████████  | 16/20 [21:26<05:13, 78.45s/it]                 
Task 3, Epoch 17/20 => Loss 0.421, Loss_clf 0.245, Loss_aux 0.176, Train_accy 92.08:  85%|████████▌ | 17/20 [21:26<03:48, 76.07s/it]
Task 3, Epoch 18/20 => Loss 0.396, Loss_clf 0.227, Loss_aux 0.169, Train_accy 93.08:  85%|████████▌ | 17/20 [22:37<03:48, 76.07s/it]
Task 3, Epoch 18/20 => Loss 0.396, Loss_clf 0.227, Loss_aux 0.169, Train_accy 93.08:  90%|█████████ | 18/20 [22:37<02:28, 74.38s/it]
Task 3, Epoch 19/20 => Loss 0.400, Loss_clf 0.232, Loss_aux 0.169, Train_accy 92.59:  90%|█████████ | 18/20 [23:47<02:28, 74.38s/it]
Task 3, Epoch 19/20 => Loss 0.400, Loss_clf 0.232, Loss_aux 0.169, Train_accy 92.59:  95%|█████████▌| 19/20 [23:47<01:13, 73.21s/it]
Task 3, Epoch 20/20 => Loss 0.399, Loss_clf 0.230, Loss_aux 0.169, Train_accy 92.77:  95%|█████████▌| 19/20 [24:58<01:13, 73.21s/it]
Task 3, Epoch 20/20 => Loss 0.399, Loss_clf 0.230, Loss_aux 0.169, Train_accy 92.77: 100%|██████████| 20/20 [24:58<00:00, 72.38s/it]
Task 3, Epoch 20/20 => Loss 0.399, Loss_clf 0.230, Loss_aux 0.169, Train_accy 92.77: 100%|██████████| 20/20 [24:58<00:00, 74.90s/it]
2024-09-04 23:27:10,545 [der.py] => Task 3, Epoch 20/20 => Loss 0.399, Loss_clf 0.230, Loss_aux 0.169, Train_accy 92.77
2024-09-04 23:27:10,547 [base.py] => Reducing exemplars...(100 per classes)
2024-09-04 23:27:31,560 [base.py] => Constructing exemplars...(100 per classes)
2024-09-04 23:28:53,314 [der.py] => Exemplar size: 2000
2024-09-04 23:28:53,314 [trainer.py] => CNN: {'total': 96.05, '00-04': 97.6, '05-09': 93.4, '10-14': 96.4, '15-19': 96.8, 'old': 95.8, 'new': 96.8}
2024-09-04 23:28:53,314 [trainer.py] => NME: {'total': 95.85, '00-04': 99.2, '05-09': 94.0, '10-14': 97.4, '15-19': 92.8, 'old': 96.87, 'new': 92.8}
2024-09-04 23:28:53,314 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05]
2024-09-04 23:28:53,314 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5]
2024-09-04 23:28:53,314 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85]
2024-09-04 23:28:53,314 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65]

Average Accuracy (CNN): 97.64
Average Accuracy (NME): 97.59
2024-09-04 23:28:53,314 [trainer.py] => Average Accuracy (CNN): 97.64
2024-09-04 23:28:53,314 [trainer.py] => Average Accuracy (NME): 97.59
2024-09-04 23:28:53,317 [trainer.py] => All params: 343260698
2024-09-04 23:28:53,319 [trainer.py] => Trainable params: 85864730
2024-09-04 23:28:54,832 [der.py] => Learning on 20-25
2024-09-04 23:28:54,838 [der.py] => All params: 429093919
2024-09-04 23:28:54,841 [der.py] => Trainable params: 85899295

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.282, Loss_clf 0.812, Loss_aux 0.471, Train_accy 83.36, Test_accy 93.84:   0%|          | 0/20 [01:56<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.282, Loss_clf 0.812, Loss_aux 0.471, Train_accy 83.36, Test_accy 93.84:   5%|▌         | 1/20 [01:56<36:58, 116.76s/it]
Task 4, Epoch 2/20 => Loss 0.446, Loss_clf 0.263, Loss_aux 0.183, Train_accy 92.07:   5%|▌         | 1/20 [03:19<36:58, 116.76s/it]                 
Task 4, Epoch 2/20 => Loss 0.446, Loss_clf 0.263, Loss_aux 0.183, Train_accy 92.07:  10%|█         | 2/20 [03:19<28:58, 96.61s/it] 
Task 4, Epoch 3/20 => Loss 0.427, Loss_clf 0.255, Loss_aux 0.172, Train_accy 92.09:  10%|█         | 2/20 [04:41<28:58, 96.61s/it]
Task 4, Epoch 3/20 => Loss 0.427, Loss_clf 0.255, Loss_aux 0.172, Train_accy 92.09:  15%|█▌        | 3/20 [04:41<25:32, 90.15s/it]
Task 4, Epoch 4/20 => Loss 0.419, Loss_clf 0.251, Loss_aux 0.168, Train_accy 92.29:  15%|█▌        | 3/20 [06:04<25:32, 90.15s/it]
Task 4, Epoch 4/20 => Loss 0.419, Loss_clf 0.251, Loss_aux 0.168, Train_accy 92.29:  20%|██        | 4/20 [06:04<23:13, 87.09s/it]
Task 4, Epoch 5/20 => Loss 0.402, Loss_clf 0.236, Loss_aux 0.166, Train_accy 93.00:  20%|██        | 4/20 [07:26<23:13, 87.09s/it]
Task 4, Epoch 5/20 => Loss 0.402, Loss_clf 0.236, Loss_aux 0.166, Train_accy 93.00:  25%|██▌       | 5/20 [07:26<21:21, 85.40s/it]
Task 4, Epoch 6/20 => Loss 0.392, Loss_clf 0.233, Loss_aux 0.159, Train_accy 92.98, Test_accy 95.16:  25%|██▌       | 5/20 [09:23<21:21, 85.40s/it]
Task 4, Epoch 6/20 => Loss 0.392, Loss_clf 0.233, Loss_aux 0.159, Train_accy 92.98, Test_accy 95.16:  30%|███       | 6/20 [09:23<22:24, 96.01s/it]
Task 4, Epoch 7/20 => Loss 0.379, Loss_clf 0.223, Loss_aux 0.155, Train_accy 93.38:  30%|███       | 6/20 [10:45<22:24, 96.01s/it]                 
Task 4, Epoch 7/20 => Loss 0.379, Loss_clf 0.223, Loss_aux 0.155, Train_accy 93.38:  35%|███▌      | 7/20 [10:45<19:50, 91.57s/it]
Task 4, Epoch 8/20 => Loss 0.333, Loss_clf 0.201, Loss_aux 0.131, Train_accy 93.71:  35%|███▌      | 7/20 [12:07<19:50, 91.57s/it]
Task 4, Epoch 8/20 => Loss 0.333, Loss_clf 0.201, Loss_aux 0.131, Train_accy 93.71:  40%|████      | 8/20 [12:07<17:43, 88.65s/it]
Task 4, Epoch 9/20 => Loss 0.357, Loss_clf 0.214, Loss_aux 0.143, Train_accy 93.62:  40%|████      | 8/20 [13:30<17:43, 88.65s/it]
Task 4, Epoch 9/20 => Loss 0.357, Loss_clf 0.214, Loss_aux 0.143, Train_accy 93.62:  45%|████▌     | 9/20 [13:30<15:53, 86.69s/it]
Task 4, Epoch 10/20 => Loss 0.387, Loss_clf 0.232, Loss_aux 0.155, Train_accy 92.76:  45%|████▌     | 9/20 [14:52<15:53, 86.69s/it]
Task 4, Epoch 10/20 => Loss 0.387, Loss_clf 0.232, Loss_aux 0.155, Train_accy 92.76:  50%|█████     | 10/20 [14:52<14:13, 85.38s/it]
Task 4, Epoch 11/20 => Loss 0.359, Loss_clf 0.221, Loss_aux 0.137, Train_accy 93.16, Test_accy 94.76:  50%|█████     | 10/20 [16:49<14:13, 85.38s/it]
Task 4, Epoch 11/20 => Loss 0.359, Loss_clf 0.221, Loss_aux 0.137, Train_accy 93.16, Test_accy 94.76:  55%|█████▌    | 11/20 [16:49<14:14, 94.94s/it]
Task 4, Epoch 12/20 => Loss 0.364, Loss_clf 0.222, Loss_aux 0.142, Train_accy 93.24:  55%|█████▌    | 11/20 [18:11<14:14, 94.94s/it]                 
Task 4, Epoch 12/20 => Loss 0.364, Loss_clf 0.222, Loss_aux 0.142, Train_accy 93.24:  60%|██████    | 12/20 [18:11<12:09, 91.13s/it]
Task 4, Epoch 13/20 => Loss 0.303, Loss_clf 0.185, Loss_aux 0.118, Train_accy 94.18:  60%|██████    | 12/20 [19:34<12:09, 91.13s/it]
Task 4, Epoch 13/20 => Loss 0.303, Loss_clf 0.185, Loss_aux 0.118, Train_accy 94.18:  65%|██████▌   | 13/20 [19:34<10:19, 88.51s/it]
Task 4, Epoch 14/20 => Loss 0.350, Loss_clf 0.215, Loss_aux 0.136, Train_accy 93.58:  65%|██████▌   | 13/20 [20:56<10:19, 88.51s/it]
Task 4, Epoch 14/20 => Loss 0.350, Loss_clf 0.215, Loss_aux 0.136, Train_accy 93.58:  70%|███████   | 14/20 [20:56<08:40, 86.67s/it]
Task 4, Epoch 15/20 => Loss 0.327, Loss_clf 0.206, Loss_aux 0.121, Train_accy 93.93:  70%|███████   | 14/20 [22:19<08:40, 86.67s/it]
Task 4, Epoch 15/20 => Loss 0.327, Loss_clf 0.206, Loss_aux 0.121, Train_accy 93.93:  75%|███████▌  | 15/20 [22:19<07:06, 85.39s/it]
Task 4, Epoch 16/20 => Loss 0.334, Loss_clf 0.207, Loss_aux 0.127, Train_accy 93.76, Test_accy 95.80:  75%|███████▌  | 15/20 [24:15<07:06, 85.39s/it]
Task 4, Epoch 16/20 => Loss 0.334, Loss_clf 0.207, Loss_aux 0.127, Train_accy 93.76, Test_accy 95.80:  80%|████████  | 16/20 [24:15<06:19, 94.80s/it]
Task 4, Epoch 17/20 => Loss 0.295, Loss_clf 0.184, Loss_aux 0.112, Train_accy 94.49:  80%|████████  | 16/20 [25:38<06:19, 94.80s/it]                 
Task 4, Epoch 17/20 => Loss 0.295, Loss_clf 0.184, Loss_aux 0.112, Train_accy 94.49:  85%|████████▌ | 17/20 [25:38<04:33, 91.11s/it]
Task 4, Epoch 18/20 => Loss 0.338, Loss_clf 0.203, Loss_aux 0.135, Train_accy 93.80:  85%|████████▌ | 17/20 [27:00<04:33, 91.11s/it]
Task 4, Epoch 18/20 => Loss 0.338, Loss_clf 0.203, Loss_aux 0.135, Train_accy 93.80:  90%|█████████ | 18/20 [27:00<02:57, 88.52s/it]
Task 4, Epoch 19/20 => Loss 0.338, Loss_clf 0.207, Loss_aux 0.131, Train_accy 93.64:  90%|█████████ | 18/20 [28:23<02:57, 88.52s/it]
Task 4, Epoch 19/20 => Loss 0.338, Loss_clf 0.207, Loss_aux 0.131, Train_accy 93.64:  95%|█████████▌| 19/20 [28:23<01:26, 86.71s/it]
Task 4, Epoch 20/20 => Loss 0.317, Loss_clf 0.197, Loss_aux 0.120, Train_accy 94.22:  95%|█████████▌| 19/20 [29:45<01:26, 86.71s/it]
Task 4, Epoch 20/20 => Loss 0.317, Loss_clf 0.197, Loss_aux 0.120, Train_accy 94.22: 100%|██████████| 20/20 [29:45<00:00, 85.44s/it]
Task 4, Epoch 20/20 => Loss 0.317, Loss_clf 0.197, Loss_aux 0.120, Train_accy 94.22: 100%|██████████| 20/20 [29:45<00:00, 89.29s/it]
2024-09-04 23:58:40,727 [der.py] => Task 4, Epoch 20/20 => Loss 0.317, Loss_clf 0.197, Loss_aux 0.120, Train_accy 94.22
2024-09-04 23:58:40,727 [base.py] => Reducing exemplars...(80 per classes)
2024-09-04 23:59:09,061 [base.py] => Constructing exemplars...(80 per classes)
2024-09-05 00:01:01,808 [der.py] => Exemplar size: 2000
2024-09-05 00:01:01,808 [trainer.py] => CNN: {'total': 95.76, '00-04': 97.0, '05-09': 92.4, '10-14': 94.2, '15-19': 96.0, '20-24': 99.2, 'old': 94.9, 'new': 99.2}
2024-09-05 00:01:01,808 [trainer.py] => NME: {'total': 95.84, '00-04': 98.8, '05-09': 93.8, '10-14': 95.0, '15-19': 94.2, '20-24': 97.4, 'old': 95.45, 'new': 97.4}
2024-09-05 00:01:01,808 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76]
2024-09-05 00:01:01,808 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44]
2024-09-05 00:01:01,808 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84]
2024-09-05 00:01:01,808 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64]

Average Accuracy (CNN): 97.27
Average Accuracy (NME): 97.24
2024-09-05 00:01:01,809 [trainer.py] => Average Accuracy (CNN): 97.27
2024-09-05 00:01:01,809 [trainer.py] => Average Accuracy (NME): 97.24
2024-09-05 00:01:01,811 [trainer.py] => All params: 429093919
2024-09-05 00:01:01,814 [trainer.py] => Trainable params: 85899295
2024-09-05 00:01:03,369 [der.py] => Learning on 25-30
2024-09-05 00:01:03,375 [der.py] => All params: 514934820
2024-09-05 00:01:03,378 [der.py] => Trainable params: 85941540

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.195, Loss_clf 0.716, Loss_aux 0.479, Train_accy 84.44, Test_accy 92.87:   0%|          | 0/20 [02:23<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.195, Loss_clf 0.716, Loss_aux 0.479, Train_accy 84.44, Test_accy 92.87:   5%|▌         | 1/20 [02:23<45:24, 143.42s/it]
Task 5, Epoch 2/20 => Loss 0.522, Loss_clf 0.303, Loss_aux 0.219, Train_accy 90.91:   5%|▌         | 1/20 [03:58<45:24, 143.42s/it]                 
Task 5, Epoch 2/20 => Loss 0.522, Loss_clf 0.303, Loss_aux 0.219, Train_accy 90.91:  10%|█         | 2/20 [03:58<34:24, 114.72s/it]
Task 5, Epoch 3/20 => Loss 0.421, Loss_clf 0.245, Loss_aux 0.176, Train_accy 92.60:  10%|█         | 2/20 [05:32<34:24, 114.72s/it]
Task 5, Epoch 3/20 => Loss 0.421, Loss_clf 0.245, Loss_aux 0.176, Train_accy 92.60:  15%|█▌        | 3/20 [05:32<29:54, 105.55s/it]
Task 5, Epoch 4/20 => Loss 0.446, Loss_clf 0.269, Loss_aux 0.177, Train_accy 92.11:  15%|█▌        | 3/20 [07:07<29:54, 105.55s/it]
Task 5, Epoch 4/20 => Loss 0.446, Loss_clf 0.269, Loss_aux 0.177, Train_accy 92.11:  20%|██        | 4/20 [07:07<26:59, 101.23s/it]
Task 5, Epoch 5/20 => Loss 0.455, Loss_clf 0.273, Loss_aux 0.181, Train_accy 92.04:  20%|██        | 4/20 [08:41<26:59, 101.23s/it]
Task 5, Epoch 5/20 => Loss 0.455, Loss_clf 0.273, Loss_aux 0.181, Train_accy 92.04:  25%|██▌       | 5/20 [08:41<24:42, 98.85s/it] 
Task 5, Epoch 6/20 => Loss 0.412, Loss_clf 0.245, Loss_aux 0.167, Train_accy 92.78, Test_accy 94.33:  25%|██▌       | 5/20 [11:05<24:42, 98.85s/it]
Task 5, Epoch 6/20 => Loss 0.412, Loss_clf 0.245, Loss_aux 0.167, Train_accy 92.78, Test_accy 94.33:  30%|███       | 6/20 [11:05<26:36, 114.05s/it]
Task 5, Epoch 7/20 => Loss 0.427, Loss_clf 0.251, Loss_aux 0.176, Train_accy 92.38:  30%|███       | 6/20 [12:40<26:36, 114.05s/it]                 
Task 5, Epoch 7/20 => Loss 0.427, Loss_clf 0.251, Loss_aux 0.176, Train_accy 92.38:  35%|███▌      | 7/20 [12:40<23:20, 107.69s/it]
Task 5, Epoch 8/20 => Loss 0.400, Loss_clf 0.241, Loss_aux 0.159, Train_accy 92.64:  35%|███▌      | 7/20 [14:14<23:20, 107.69s/it]
Task 5, Epoch 8/20 => Loss 0.400, Loss_clf 0.241, Loss_aux 0.159, Train_accy 92.64:  40%|████      | 8/20 [14:14<20:42, 103.53s/it]
Task 5, Epoch 9/20 => Loss 0.410, Loss_clf 0.252, Loss_aux 0.158, Train_accy 92.20:  40%|████      | 8/20 [15:49<20:42, 103.53s/it]
Task 5, Epoch 9/20 => Loss 0.410, Loss_clf 0.252, Loss_aux 0.158, Train_accy 92.20:  45%|████▌     | 9/20 [15:49<18:28, 100.75s/it]
Task 5, Epoch 10/20 => Loss 0.349, Loss_clf 0.213, Loss_aux 0.136, Train_accy 93.60:  45%|████▌     | 9/20 [17:24<18:28, 100.75s/it]
Task 5, Epoch 10/20 => Loss 0.349, Loss_clf 0.213, Loss_aux 0.136, Train_accy 93.60:  50%|█████     | 10/20 [17:24<16:28, 98.87s/it]
Task 5, Epoch 11/20 => Loss 0.379, Loss_clf 0.237, Loss_aux 0.142, Train_accy 92.98, Test_accy 93.63:  50%|█████     | 10/20 [19:47<16:28, 98.87s/it]
Task 5, Epoch 11/20 => Loss 0.379, Loss_clf 0.237, Loss_aux 0.142, Train_accy 92.98, Test_accy 93.63:  55%|█████▌    | 11/20 [19:47<16:53, 112.57s/it]
Task 5, Epoch 12/20 => Loss 0.360, Loss_clf 0.204, Loss_aux 0.156, Train_accy 94.04:  55%|█████▌    | 11/20 [21:22<16:53, 112.57s/it]                 
Task 5, Epoch 12/20 => Loss 0.360, Loss_clf 0.204, Loss_aux 0.156, Train_accy 94.04:  60%|██████    | 12/20 [21:22<14:17, 107.13s/it]
Task 5, Epoch 13/20 => Loss 0.367, Loss_clf 0.225, Loss_aux 0.142, Train_accy 93.31:  60%|██████    | 12/20 [22:57<14:17, 107.13s/it]
Task 5, Epoch 13/20 => Loss 0.367, Loss_clf 0.225, Loss_aux 0.142, Train_accy 93.31:  65%|██████▌   | 13/20 [22:57<12:03, 103.36s/it]
Task 5, Epoch 14/20 => Loss 0.389, Loss_clf 0.233, Loss_aux 0.156, Train_accy 92.98:  65%|██████▌   | 13/20 [24:31<12:03, 103.36s/it]
Task 5, Epoch 14/20 => Loss 0.389, Loss_clf 0.233, Loss_aux 0.156, Train_accy 92.98:  70%|███████   | 14/20 [24:31<10:04, 100.77s/it]
Task 5, Epoch 15/20 => Loss 0.368, Loss_clf 0.224, Loss_aux 0.143, Train_accy 93.36:  70%|███████   | 14/20 [26:06<10:04, 100.77s/it]
Task 5, Epoch 15/20 => Loss 0.368, Loss_clf 0.224, Loss_aux 0.143, Train_accy 93.36:  75%|███████▌  | 15/20 [26:06<08:14, 98.95s/it] 
Task 5, Epoch 16/20 => Loss 0.325, Loss_clf 0.201, Loss_aux 0.124, Train_accy 94.18, Test_accy 93.97:  75%|███████▌  | 15/20 [28:30<08:14, 98.95s/it]
Task 5, Epoch 16/20 => Loss 0.325, Loss_clf 0.201, Loss_aux 0.124, Train_accy 94.18, Test_accy 93.97:  80%|████████  | 16/20 [28:30<07:29, 112.38s/it]
Task 5, Epoch 17/20 => Loss 0.385, Loss_clf 0.232, Loss_aux 0.153, Train_accy 92.89:  80%|████████  | 16/20 [30:04<07:29, 112.38s/it]                 
Task 5, Epoch 17/20 => Loss 0.385, Loss_clf 0.232, Loss_aux 0.153, Train_accy 92.89:  85%|████████▌ | 17/20 [30:04<05:21, 107.04s/it]
Task 5, Epoch 18/20 => Loss 0.389, Loss_clf 0.233, Loss_aux 0.156, Train_accy 93.49:  85%|████████▌ | 17/20 [31:39<05:21, 107.04s/it]
Task 5, Epoch 18/20 => Loss 0.389, Loss_clf 0.233, Loss_aux 0.156, Train_accy 93.49:  90%|█████████ | 18/20 [31:39<03:26, 103.31s/it]
Task 5, Epoch 19/20 => Loss 0.341, Loss_clf 0.209, Loss_aux 0.133, Train_accy 94.04:  90%|█████████ | 18/20 [33:13<03:26, 103.31s/it]
Task 5, Epoch 19/20 => Loss 0.341, Loss_clf 0.209, Loss_aux 0.133, Train_accy 94.04:  95%|█████████▌| 19/20 [33:13<01:40, 100.70s/it]
Task 5, Epoch 20/20 => Loss 0.342, Loss_clf 0.202, Loss_aux 0.140, Train_accy 94.13:  95%|█████████▌| 19/20 [34:48<01:40, 100.70s/it]
Task 5, Epoch 20/20 => Loss 0.342, Loss_clf 0.202, Loss_aux 0.140, Train_accy 94.13: 100%|██████████| 20/20 [34:48<00:00, 98.87s/it] 
Task 5, Epoch 20/20 => Loss 0.342, Loss_clf 0.202, Loss_aux 0.140, Train_accy 94.13: 100%|██████████| 20/20 [34:48<00:00, 104.43s/it]
2024-09-05 00:35:52,026 [der.py] => Task 5, Epoch 20/20 => Loss 0.342, Loss_clf 0.202, Loss_aux 0.140, Train_accy 94.13
2024-09-05 00:35:52,027 [base.py] => Reducing exemplars...(66 per classes)
2024-09-05 00:36:27,560 [base.py] => Constructing exemplars...(66 per classes)
2024-09-05 00:38:56,702 [der.py] => Exemplar size: 1980
2024-09-05 00:38:56,702 [trainer.py] => CNN: {'total': 93.8, '00-04': 97.4, '05-09': 86.0, '10-14': 91.0, '15-19': 92.0, '20-24': 97.2, '25-29': 99.2, 'old': 92.72, 'new': 99.2}
2024-09-05 00:38:56,702 [trainer.py] => NME: {'total': 95.23, '00-04': 98.8, '05-09': 90.6, '10-14': 94.0, '15-19': 93.2, '20-24': 98.2, '25-29': 96.6, 'old': 94.96, 'new': 96.6}
2024-09-05 00:38:56,702 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8]
2024-09-05 00:38:56,702 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13]
2024-09-05 00:38:56,702 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23]
2024-09-05 00:38:56,702 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57]

Average Accuracy (CNN): 96.69
Average Accuracy (NME): 96.9
2024-09-05 00:38:56,702 [trainer.py] => Average Accuracy (CNN): 96.69
2024-09-05 00:38:56,702 [trainer.py] => Average Accuracy (NME): 96.9
2024-09-05 00:38:56,705 [trainer.py] => All params: 514934820
2024-09-05 00:38:56,708 [trainer.py] => Trainable params: 85941540
2024-09-05 00:38:58,302 [der.py] => Learning on 30-35
2024-09-05 00:38:58,309 [der.py] => All params: 600783401
2024-09-05 00:38:58,312 [der.py] => Trainable params: 85991465

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.365, Loss_clf 0.883, Loss_aux 0.482, Train_accy 80.76, Test_accy 90.03:   0%|          | 0/20 [02:52<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.365, Loss_clf 0.883, Loss_aux 0.482, Train_accy 80.76, Test_accy 90.03:   5%|▌         | 1/20 [02:52<54:39, 172.61s/it]
Task 6, Epoch 2/20 => Loss 0.682, Loss_clf 0.410, Loss_aux 0.272, Train_accy 87.57:   5%|▌         | 1/20 [04:39<54:39, 172.61s/it]                 
Task 6, Epoch 2/20 => Loss 0.682, Loss_clf 0.410, Loss_aux 0.272, Train_accy 87.57:  10%|█         | 2/20 [04:39<40:06, 133.71s/it]
Task 6, Epoch 3/20 => Loss 0.556, Loss_clf 0.328, Loss_aux 0.227, Train_accy 89.46:  10%|█         | 2/20 [06:25<40:06, 133.71s/it]
Task 6, Epoch 3/20 => Loss 0.556, Loss_clf 0.328, Loss_aux 0.227, Train_accy 89.46:  15%|█▌        | 3/20 [06:25<34:21, 121.26s/it]
Task 6, Epoch 4/20 => Loss 0.543, Loss_clf 0.329, Loss_aux 0.214, Train_accy 89.78:  15%|█▌        | 3/20 [08:12<34:21, 121.26s/it]
Task 6, Epoch 4/20 => Loss 0.543, Loss_clf 0.329, Loss_aux 0.214, Train_accy 89.78:  20%|██        | 4/20 [08:12<30:46, 115.42s/it]
Task 6, Epoch 5/20 => Loss 0.546, Loss_clf 0.331, Loss_aux 0.215, Train_accy 89.73:  20%|██        | 4/20 [09:58<30:46, 115.42s/it]
Task 6, Epoch 5/20 => Loss 0.546, Loss_clf 0.331, Loss_aux 0.215, Train_accy 89.73:  25%|██▌       | 5/20 [09:58<28:02, 112.18s/it]
Task 6, Epoch 6/20 => Loss 0.482, Loss_clf 0.284, Loss_aux 0.198, Train_accy 91.36, Test_accy 92.94:  25%|██▌       | 5/20 [12:51<28:02, 112.18s/it]
Task 6, Epoch 6/20 => Loss 0.482, Loss_clf 0.284, Loss_aux 0.198, Train_accy 91.36, Test_accy 92.94:  30%|███       | 6/20 [12:51<30:59, 132.79s/it]
Task 6, Epoch 7/20 => Loss 0.479, Loss_clf 0.284, Loss_aux 0.195, Train_accy 91.05:  30%|███       | 6/20 [14:37<30:59, 132.79s/it]                 
Task 6, Epoch 7/20 => Loss 0.479, Loss_clf 0.284, Loss_aux 0.195, Train_accy 91.05:  35%|███▌      | 7/20 [14:37<26:54, 124.18s/it]
Task 6, Epoch 8/20 => Loss 0.503, Loss_clf 0.305, Loss_aux 0.198, Train_accy 90.58:  35%|███▌      | 7/20 [16:24<26:54, 124.18s/it]
Task 6, Epoch 8/20 => Loss 0.503, Loss_clf 0.305, Loss_aux 0.198, Train_accy 90.58:  40%|████      | 8/20 [16:24<23:42, 118.54s/it]
Task 6, Epoch 9/20 => Loss 0.444, Loss_clf 0.278, Loss_aux 0.167, Train_accy 91.90:  40%|████      | 8/20 [18:10<23:42, 118.54s/it]
Task 6, Epoch 9/20 => Loss 0.444, Loss_clf 0.278, Loss_aux 0.167, Train_accy 91.90:  45%|████▌     | 9/20 [18:10<21:02, 114.75s/it]
Task 6, Epoch 10/20 => Loss 0.467, Loss_clf 0.278, Loss_aux 0.190, Train_accy 91.38:  45%|████▌     | 9/20 [19:57<21:02, 114.75s/it]
Task 6, Epoch 10/20 => Loss 0.467, Loss_clf 0.278, Loss_aux 0.190, Train_accy 91.38:  50%|█████     | 10/20 [19:57<18:42, 112.21s/it]
Task 6, Epoch 11/20 => Loss 0.416, Loss_clf 0.246, Loss_aux 0.169, Train_accy 92.01, Test_accy 93.29:  50%|█████     | 10/20 [22:50<18:42, 112.21s/it]
Task 6, Epoch 11/20 => Loss 0.416, Loss_clf 0.246, Loss_aux 0.169, Train_accy 92.01, Test_accy 93.29:  55%|█████▌    | 11/20 [22:50<19:37, 130.80s/it]
Task 6, Epoch 12/20 => Loss 0.391, Loss_clf 0.229, Loss_aux 0.162, Train_accy 92.86:  55%|█████▌    | 11/20 [24:36<19:37, 130.80s/it]                 
Task 6, Epoch 12/20 => Loss 0.391, Loss_clf 0.229, Loss_aux 0.162, Train_accy 92.86:  60%|██████    | 12/20 [24:36<16:27, 123.39s/it]
Task 6, Epoch 13/20 => Loss 0.418, Loss_clf 0.253, Loss_aux 0.165, Train_accy 91.96:  60%|██████    | 12/20 [26:23<16:27, 123.39s/it]
Task 6, Epoch 13/20 => Loss 0.418, Loss_clf 0.253, Loss_aux 0.165, Train_accy 91.96:  65%|██████▌   | 13/20 [26:23<13:48, 118.29s/it]
Task 6, Epoch 14/20 => Loss 0.387, Loss_clf 0.233, Loss_aux 0.153, Train_accy 92.68:  65%|██████▌   | 13/20 [28:09<13:48, 118.29s/it]
Task 6, Epoch 14/20 => Loss 0.387, Loss_clf 0.233, Loss_aux 0.153, Train_accy 92.68:  70%|███████   | 14/20 [28:09<11:28, 114.75s/it]
Task 6, Epoch 15/20 => Loss 0.362, Loss_clf 0.216, Loss_aux 0.146, Train_accy 93.33:  70%|███████   | 14/20 [29:56<11:28, 114.75s/it]
Task 6, Epoch 15/20 => Loss 0.362, Loss_clf 0.216, Loss_aux 0.146, Train_accy 93.33:  75%|███████▌  | 15/20 [29:56<09:21, 112.26s/it]
Task 6, Epoch 16/20 => Loss 0.392, Loss_clf 0.230, Loss_aux 0.162, Train_accy 92.61, Test_accy 92.89:  75%|███████▌  | 15/20 [32:48<09:21, 112.26s/it]
Task 6, Epoch 16/20 => Loss 0.392, Loss_clf 0.230, Loss_aux 0.162, Train_accy 92.61, Test_accy 92.89:  80%|████████  | 16/20 [32:48<08:41, 130.48s/it]
Task 6, Epoch 17/20 => Loss 0.364, Loss_clf 0.225, Loss_aux 0.139, Train_accy 93.37:  80%|████████  | 16/20 [34:35<08:41, 130.48s/it]                 
Task 6, Epoch 17/20 => Loss 0.364, Loss_clf 0.225, Loss_aux 0.139, Train_accy 93.37:  85%|████████▌ | 17/20 [34:35<06:09, 123.26s/it]
Task 6, Epoch 18/20 => Loss 0.415, Loss_clf 0.260, Loss_aux 0.155, Train_accy 92.54:  85%|████████▌ | 17/20 [36:21<06:09, 123.26s/it]
Task 6, Epoch 18/20 => Loss 0.415, Loss_clf 0.260, Loss_aux 0.155, Train_accy 92.54:  90%|█████████ | 18/20 [36:21<03:56, 118.21s/it]
Task 6, Epoch 19/20 => Loss 0.398, Loss_clf 0.239, Loss_aux 0.159, Train_accy 92.68:  90%|█████████ | 18/20 [38:08<03:56, 118.21s/it]
Task 6, Epoch 19/20 => Loss 0.398, Loss_clf 0.239, Loss_aux 0.159, Train_accy 92.68:  95%|█████████▌| 19/20 [38:08<01:54, 114.67s/it]
Task 6, Epoch 20/20 => Loss 0.338, Loss_clf 0.214, Loss_aux 0.125, Train_accy 93.39:  95%|█████████▌| 19/20 [39:54<01:54, 114.67s/it]
Task 6, Epoch 20/20 => Loss 0.338, Loss_clf 0.214, Loss_aux 0.125, Train_accy 93.39: 100%|██████████| 20/20 [39:54<00:00, 112.20s/it]
Task 6, Epoch 20/20 => Loss 0.338, Loss_clf 0.214, Loss_aux 0.125, Train_accy 93.39: 100%|██████████| 20/20 [39:54<00:00, 119.73s/it]
2024-09-05 01:18:53,094 [der.py] => Task 6, Epoch 20/20 => Loss 0.338, Loss_clf 0.214, Loss_aux 0.125, Train_accy 93.39
2024-09-05 01:18:53,095 [base.py] => Reducing exemplars...(57 per classes)
2024-09-05 01:19:35,454 [base.py] => Constructing exemplars...(57 per classes)
2024-09-05 01:22:45,909 [der.py] => Exemplar size: 1995
2024-09-05 01:22:45,909 [trainer.py] => CNN: {'total': 92.83, '00-04': 95.8, '05-09': 82.4, '10-14': 92.0, '15-19': 90.8, '20-24': 96.2, '25-29': 97.0, '30-34': 95.6, 'old': 92.37, 'new': 95.6}
2024-09-05 01:22:45,910 [trainer.py] => NME: {'total': 93.94, '00-04': 98.6, '05-09': 89.0, '10-14': 93.2, '15-19': 92.4, '20-24': 97.6, '25-29': 97.2, '30-34': 89.6, 'old': 94.67, 'new': 89.6}
2024-09-05 01:22:45,910 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83]
2024-09-05 01:22:45,910 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2]
2024-09-05 01:22:45,910 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94]
2024-09-05 01:22:45,910 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54]

Average Accuracy (CNN): 96.14
Average Accuracy (NME): 96.48
2024-09-05 01:22:45,910 [trainer.py] => Average Accuracy (CNN): 96.14
2024-09-05 01:22:45,910 [trainer.py] => Average Accuracy (NME): 96.48
2024-09-05 01:22:45,914 [trainer.py] => All params: 600783401
2024-09-05 01:22:45,917 [trainer.py] => Trainable params: 85991465
2024-09-05 01:22:47,390 [der.py] => Learning on 35-40
2024-09-05 01:22:47,397 [der.py] => All params: 686639662
2024-09-05 01:22:47,401 [der.py] => Trainable params: 86049070

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.233, Loss_clf 0.790, Loss_aux 0.443, Train_accy 84.27, Test_accy 89.28:   0%|          | 0/20 [03:25<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.233, Loss_clf 0.790, Loss_aux 0.443, Train_accy 84.27, Test_accy 89.28:   5%|▌         | 1/20 [03:25<1:04:56, 205.10s/it]
Task 7, Epoch 2/20 => Loss 0.561, Loss_clf 0.332, Loss_aux 0.229, Train_accy 90.32:   5%|▌         | 1/20 [05:23<1:04:56, 205.10s/it]                 
Task 7, Epoch 2/20 => Loss 0.561, Loss_clf 0.332, Loss_aux 0.229, Train_accy 90.32:  10%|█         | 2/20 [05:23<46:17, 154.32s/it]  
Task 7, Epoch 3/20 => Loss 0.478, Loss_clf 0.290, Loss_aux 0.189, Train_accy 91.55:  10%|█         | 2/20 [07:22<46:17, 154.32s/it]
Task 7, Epoch 3/20 => Loss 0.478, Loss_clf 0.290, Loss_aux 0.189, Train_accy 91.55:  15%|█▌        | 3/20 [07:22<39:07, 138.09s/it]
Task 7, Epoch 4/20 => Loss 0.458, Loss_clf 0.277, Loss_aux 0.181, Train_accy 91.75:  15%|█▌        | 3/20 [09:21<39:07, 138.09s/it]
Task 7, Epoch 4/20 => Loss 0.458, Loss_clf 0.277, Loss_aux 0.181, Train_accy 91.75:  20%|██        | 4/20 [09:21<34:47, 130.47s/it]
Task 7, Epoch 5/20 => Loss 0.429, Loss_clf 0.257, Loss_aux 0.172, Train_accy 91.90:  20%|██        | 4/20 [11:20<34:47, 130.47s/it]
Task 7, Epoch 5/20 => Loss 0.429, Loss_clf 0.257, Loss_aux 0.172, Train_accy 91.90:  25%|██▌       | 5/20 [11:20<31:34, 126.31s/it]
Task 7, Epoch 6/20 => Loss 0.444, Loss_clf 0.268, Loss_aux 0.176, Train_accy 91.72, Test_accy 91.28:  25%|██▌       | 5/20 [14:46<31:34, 126.31s/it]
Task 7, Epoch 6/20 => Loss 0.444, Loss_clf 0.268, Loss_aux 0.176, Train_accy 91.72, Test_accy 91.28:  30%|███       | 6/20 [14:46<35:46, 153.32s/it]
Task 7, Epoch 7/20 => Loss 0.446, Loss_clf 0.267, Loss_aux 0.178, Train_accy 91.99:  30%|███       | 6/20 [16:45<35:46, 153.32s/it]                 
Task 7, Epoch 7/20 => Loss 0.446, Loss_clf 0.267, Loss_aux 0.178, Train_accy 91.99:  35%|███▌      | 7/20 [16:45<30:47, 142.09s/it]
Task 7, Epoch 8/20 => Loss 0.420, Loss_clf 0.252, Loss_aux 0.168, Train_accy 92.97:  35%|███▌      | 7/20 [18:43<30:47, 142.09s/it]
Task 7, Epoch 8/20 => Loss 0.420, Loss_clf 0.252, Loss_aux 0.168, Train_accy 92.97:  40%|████      | 8/20 [18:43<26:56, 134.67s/it]
Task 7, Epoch 9/20 => Loss 0.443, Loss_clf 0.265, Loss_aux 0.178, Train_accy 92.10:  40%|████      | 8/20 [20:42<26:56, 134.67s/it]
Task 7, Epoch 9/20 => Loss 0.443, Loss_clf 0.265, Loss_aux 0.178, Train_accy 92.10:  45%|████▌     | 9/20 [20:42<23:46, 129.72s/it]
Task 7, Epoch 10/20 => Loss 0.398, Loss_clf 0.239, Loss_aux 0.159, Train_accy 93.13:  45%|████▌     | 9/20 [22:41<23:46, 129.72s/it]
Task 7, Epoch 10/20 => Loss 0.398, Loss_clf 0.239, Loss_aux 0.159, Train_accy 93.13:  50%|█████     | 10/20 [22:41<21:03, 126.36s/it]
Task 7, Epoch 11/20 => Loss 0.388, Loss_clf 0.244, Loss_aux 0.144, Train_accy 92.95, Test_accy 91.32:  50%|█████     | 10/20 [26:07<21:03, 126.36s/it]
Task 7, Epoch 11/20 => Loss 0.388, Loss_clf 0.244, Loss_aux 0.144, Train_accy 92.95, Test_accy 91.32:  55%|█████▌    | 11/20 [26:07<22:35, 150.58s/it]
Task 7, Epoch 12/20 => Loss 0.409, Loss_clf 0.247, Loss_aux 0.162, Train_accy 92.99:  55%|█████▌    | 11/20 [28:05<22:35, 150.58s/it]                 
Task 7, Epoch 12/20 => Loss 0.409, Loss_clf 0.247, Loss_aux 0.162, Train_accy 92.99:  60%|██████    | 12/20 [28:05<18:47, 140.93s/it]
Task 7, Epoch 13/20 => Loss 0.397, Loss_clf 0.243, Loss_aux 0.154, Train_accy 93.24:  60%|██████    | 12/20 [30:04<18:47, 140.93s/it]
Task 7, Epoch 13/20 => Loss 0.397, Loss_clf 0.243, Loss_aux 0.154, Train_accy 93.24:  65%|██████▌   | 13/20 [30:04<15:39, 134.23s/it]
Task 7, Epoch 14/20 => Loss 0.372, Loss_clf 0.230, Loss_aux 0.143, Train_accy 93.26:  65%|██████▌   | 13/20 [32:03<15:39, 134.23s/it]
Task 7, Epoch 14/20 => Loss 0.372, Loss_clf 0.230, Loss_aux 0.143, Train_accy 93.26:  70%|███████   | 14/20 [32:03<12:57, 129.57s/it]
Task 7, Epoch 15/20 => Loss 0.354, Loss_clf 0.212, Loss_aux 0.142, Train_accy 93.88:  70%|███████   | 14/20 [34:02<12:57, 129.57s/it]
Task 7, Epoch 15/20 => Loss 0.354, Loss_clf 0.212, Loss_aux 0.142, Train_accy 93.88:  75%|███████▌  | 15/20 [34:02<10:31, 126.33s/it]
Task 7, Epoch 16/20 => Loss 0.411, Loss_clf 0.256, Loss_aux 0.155, Train_accy 92.21, Test_accy 91.78:  75%|███████▌  | 15/20 [37:27<10:31, 126.33s/it]
Task 7, Epoch 16/20 => Loss 0.411, Loss_clf 0.256, Loss_aux 0.155, Train_accy 92.21, Test_accy 91.78:  80%|████████  | 16/20 [37:27<10:00, 150.10s/it]
Task 7, Epoch 17/20 => Loss 0.365, Loss_clf 0.225, Loss_aux 0.140, Train_accy 93.41:  80%|████████  | 16/20 [39:26<10:00, 150.10s/it]                 
Task 7, Epoch 17/20 => Loss 0.365, Loss_clf 0.225, Loss_aux 0.140, Train_accy 93.41:  85%|████████▌ | 17/20 [39:26<07:02, 140.67s/it]
Task 7, Epoch 18/20 => Loss 0.373, Loss_clf 0.228, Loss_aux 0.145, Train_accy 93.39:  85%|████████▌ | 17/20 [41:25<07:02, 140.67s/it]
Task 7, Epoch 18/20 => Loss 0.373, Loss_clf 0.228, Loss_aux 0.145, Train_accy 93.39:  90%|█████████ | 18/20 [41:25<04:28, 134.08s/it]
Task 7, Epoch 19/20 => Loss 0.360, Loss_clf 0.223, Loss_aux 0.137, Train_accy 93.50:  90%|█████████ | 18/20 [43:23<04:28, 134.08s/it]
Task 7, Epoch 19/20 => Loss 0.360, Loss_clf 0.223, Loss_aux 0.137, Train_accy 93.50:  95%|█████████▌| 19/20 [43:23<02:09, 129.48s/it]
Task 7, Epoch 20/20 => Loss 0.373, Loss_clf 0.236, Loss_aux 0.137, Train_accy 93.17:  95%|█████████▌| 19/20 [45:22<02:09, 129.48s/it]
Task 7, Epoch 20/20 => Loss 0.373, Loss_clf 0.236, Loss_aux 0.137, Train_accy 93.17: 100%|██████████| 20/20 [45:22<00:00, 126.27s/it]
Task 7, Epoch 20/20 => Loss 0.373, Loss_clf 0.236, Loss_aux 0.137, Train_accy 93.17: 100%|██████████| 20/20 [45:22<00:00, 136.13s/it]
2024-09-05 02:08:10,176 [der.py] => Task 7, Epoch 20/20 => Loss 0.373, Loss_clf 0.236, Loss_aux 0.137, Train_accy 93.17
2024-09-05 02:08:10,178 [base.py] => Reducing exemplars...(50 per classes)
2024-09-05 02:08:59,595 [base.py] => Constructing exemplars...(50 per classes)
2024-09-05 02:12:58,567 [der.py] => Exemplar size: 2000
2024-09-05 02:12:58,568 [trainer.py] => CNN: {'total': 91.85, '00-04': 93.8, '05-09': 84.6, '10-14': 88.4, '15-19': 87.6, '20-24': 96.0, '25-29': 92.4, '30-34': 93.8, '35-39': 98.2, 'old': 90.94, 'new': 98.2}
2024-09-05 02:12:58,568 [trainer.py] => NME: {'total': 93.25, '00-04': 97.8, '05-09': 88.2, '10-14': 92.6, '15-19': 91.0, '20-24': 97.6, '25-29': 95.6, '30-34': 91.2, '35-39': 92.0, 'old': 93.43, 'new': 92.0}
2024-09-05 02:12:58,568 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85]
2024-09-05 02:12:58,568 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82]
2024-09-05 02:12:58,568 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25]
2024-09-05 02:12:58,568 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4]

Average Accuracy (CNN): 95.6
Average Accuracy (NME): 96.08
2024-09-05 02:12:58,568 [trainer.py] => Average Accuracy (CNN): 95.6
2024-09-05 02:12:58,568 [trainer.py] => Average Accuracy (NME): 96.08
2024-09-05 02:12:58,572 [trainer.py] => All params: 686639662
2024-09-05 02:12:58,576 [trainer.py] => Trainable params: 86049070
2024-09-05 02:13:00,099 [der.py] => Learning on 40-45
2024-09-05 02:13:00,108 [der.py] => All params: 772503603
2024-09-05 02:13:00,112 [der.py] => Trainable params: 86114355

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.330, Loss_clf 0.849, Loss_aux 0.481, Train_accy 82.67, Test_accy 90.22:   0%|          | 0/20 [04:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.330, Loss_clf 0.849, Loss_aux 0.481, Train_accy 82.67, Test_accy 90.22:   5%|▌         | 1/20 [04:00<1:16:04, 240.24s/it]
Task 8, Epoch 2/20 => Loss 0.608, Loss_clf 0.362, Loss_aux 0.246, Train_accy 89.51:   5%|▌         | 1/20 [06:11<1:16:04, 240.24s/it]                 
Task 8, Epoch 2/20 => Loss 0.608, Loss_clf 0.362, Loss_aux 0.246, Train_accy 89.51:  10%|█         | 2/20 [06:11<52:47, 175.99s/it]  
Task 8, Epoch 3/20 => Loss 0.532, Loss_clf 0.310, Loss_aux 0.222, Train_accy 90.49:  10%|█         | 2/20 [08:22<52:47, 175.99s/it]
Task 8, Epoch 3/20 => Loss 0.532, Loss_clf 0.310, Loss_aux 0.222, Train_accy 90.49:  15%|█▌        | 3/20 [08:22<44:02, 155.42s/it]
Task 8, Epoch 4/20 => Loss 0.488, Loss_clf 0.301, Loss_aux 0.188, Train_accy 90.91:  15%|█▌        | 3/20 [10:33<44:02, 155.42s/it]
Task 8, Epoch 4/20 => Loss 0.488, Loss_clf 0.301, Loss_aux 0.188, Train_accy 90.91:  20%|██        | 4/20 [10:33<38:51, 145.75s/it]
Task 8, Epoch 5/20 => Loss 0.523, Loss_clf 0.329, Loss_aux 0.195, Train_accy 90.53:  20%|██        | 4/20 [12:43<38:51, 145.75s/it]
Task 8, Epoch 5/20 => Loss 0.523, Loss_clf 0.329, Loss_aux 0.195, Train_accy 90.53:  25%|██▌       | 5/20 [12:43<35:05, 140.37s/it]
Task 8, Epoch 6/20 => Loss 0.477, Loss_clf 0.294, Loss_aux 0.183, Train_accy 91.40, Test_accy 89.78:  25%|██▌       | 5/20 [16:44<35:05, 140.37s/it]
Task 8, Epoch 6/20 => Loss 0.477, Loss_clf 0.294, Loss_aux 0.183, Train_accy 91.40, Test_accy 89.78:  30%|███       | 6/20 [16:44<40:40, 174.33s/it]
Task 8, Epoch 7/20 => Loss 0.442, Loss_clf 0.269, Loss_aux 0.174, Train_accy 92.53:  30%|███       | 6/20 [18:55<40:40, 174.33s/it]                 
Task 8, Epoch 7/20 => Loss 0.442, Loss_clf 0.269, Loss_aux 0.174, Train_accy 92.53:  35%|███▌      | 7/20 [18:55<34:41, 160.12s/it]
Task 8, Epoch 8/20 => Loss 0.419, Loss_clf 0.260, Loss_aux 0.159, Train_accy 92.36:  35%|███▌      | 7/20 [21:05<34:41, 160.12s/it]
Task 8, Epoch 8/20 => Loss 0.419, Loss_clf 0.260, Loss_aux 0.159, Train_accy 92.36:  40%|████      | 8/20 [21:05<30:09, 150.80s/it]
Task 8, Epoch 9/20 => Loss 0.414, Loss_clf 0.250, Loss_aux 0.163, Train_accy 92.71:  40%|████      | 8/20 [23:16<30:09, 150.80s/it]
Task 8, Epoch 9/20 => Loss 0.414, Loss_clf 0.250, Loss_aux 0.163, Train_accy 92.71:  45%|████▌     | 9/20 [23:16<26:30, 144.56s/it]
Task 8, Epoch 10/20 => Loss 0.442, Loss_clf 0.273, Loss_aux 0.169, Train_accy 92.02:  45%|████▌     | 9/20 [25:27<26:30, 144.56s/it]
Task 8, Epoch 10/20 => Loss 0.442, Loss_clf 0.273, Loss_aux 0.169, Train_accy 92.02:  50%|█████     | 10/20 [25:27<23:23, 140.33s/it]
Task 8, Epoch 11/20 => Loss 0.393, Loss_clf 0.235, Loss_aux 0.158, Train_accy 93.20, Test_accy 89.56:  50%|█████     | 10/20 [29:27<23:23, 140.33s/it]
Task 8, Epoch 11/20 => Loss 0.393, Loss_clf 0.235, Loss_aux 0.158, Train_accy 93.20, Test_accy 89.56:  55%|█████▌    | 11/20 [29:27<25:38, 170.93s/it]
Task 8, Epoch 12/20 => Loss 0.442, Loss_clf 0.272, Loss_aux 0.171, Train_accy 92.07:  55%|█████▌    | 11/20 [31:38<25:38, 170.93s/it]                 
Task 8, Epoch 12/20 => Loss 0.442, Loss_clf 0.272, Loss_aux 0.171, Train_accy 92.07:  60%|██████    | 12/20 [31:38<21:10, 158.76s/it]
Task 8, Epoch 13/20 => Loss 0.432, Loss_clf 0.265, Loss_aux 0.167, Train_accy 92.89:  60%|██████    | 12/20 [33:49<21:10, 158.76s/it]
Task 8, Epoch 13/20 => Loss 0.432, Loss_clf 0.265, Loss_aux 0.167, Train_accy 92.89:  65%|██████▌   | 13/20 [33:49<17:32, 150.31s/it]
Task 8, Epoch 14/20 => Loss 0.442, Loss_clf 0.276, Loss_aux 0.165, Train_accy 92.38:  65%|██████▌   | 13/20 [36:00<17:32, 150.31s/it]
Task 8, Epoch 14/20 => Loss 0.442, Loss_clf 0.276, Loss_aux 0.165, Train_accy 92.38:  70%|███████   | 14/20 [36:00<14:26, 144.42s/it]
Task 8, Epoch 15/20 => Loss 0.388, Loss_clf 0.237, Loss_aux 0.151, Train_accy 93.42:  70%|███████   | 14/20 [38:11<14:26, 144.42s/it]
Task 8, Epoch 15/20 => Loss 0.388, Loss_clf 0.237, Loss_aux 0.151, Train_accy 93.42:  75%|███████▌  | 15/20 [38:11<11:41, 140.32s/it]
Task 8, Epoch 16/20 => Loss 0.406, Loss_clf 0.247, Loss_aux 0.159, Train_accy 92.89, Test_accy 89.80:  75%|███████▌  | 15/20 [42:11<11:41, 140.32s/it]
Task 8, Epoch 16/20 => Loss 0.406, Loss_clf 0.247, Loss_aux 0.159, Train_accy 92.89, Test_accy 89.80:  80%|████████  | 16/20 [42:11<11:21, 170.44s/it]
Task 8, Epoch 17/20 => Loss 0.384, Loss_clf 0.239, Loss_aux 0.145, Train_accy 93.13:  80%|████████  | 16/20 [44:22<11:21, 170.44s/it]                 
Task 8, Epoch 17/20 => Loss 0.384, Loss_clf 0.239, Loss_aux 0.145, Train_accy 93.13:  85%|████████▌ | 17/20 [44:22<07:55, 158.55s/it]
Task 8, Epoch 18/20 => Loss 0.378, Loss_clf 0.245, Loss_aux 0.132, Train_accy 93.29:  85%|████████▌ | 17/20 [46:33<07:55, 158.55s/it]
Task 8, Epoch 18/20 => Loss 0.378, Loss_clf 0.245, Loss_aux 0.132, Train_accy 93.29:  90%|█████████ | 18/20 [46:33<05:00, 150.22s/it]
Task 8, Epoch 19/20 => Loss 0.371, Loss_clf 0.231, Loss_aux 0.141, Train_accy 92.87:  90%|█████████ | 18/20 [48:44<05:00, 150.22s/it]
Task 8, Epoch 19/20 => Loss 0.371, Loss_clf 0.231, Loss_aux 0.141, Train_accy 92.87:  95%|█████████▌| 19/20 [48:44<02:24, 144.39s/it]
Task 8, Epoch 20/20 => Loss 0.369, Loss_clf 0.229, Loss_aux 0.140, Train_accy 93.64:  95%|█████████▌| 19/20 [50:55<02:24, 144.39s/it]
Task 8, Epoch 20/20 => Loss 0.369, Loss_clf 0.229, Loss_aux 0.140, Train_accy 93.64: 100%|██████████| 20/20 [50:55<00:00, 140.32s/it]
Task 8, Epoch 20/20 => Loss 0.369, Loss_clf 0.229, Loss_aux 0.140, Train_accy 93.64: 100%|██████████| 20/20 [50:55<00:00, 152.75s/it]
2024-09-05 03:03:55,290 [der.py] => Task 8, Epoch 20/20 => Loss 0.369, Loss_clf 0.229, Loss_aux 0.140, Train_accy 93.64
2024-09-05 03:03:55,292 [base.py] => Reducing exemplars...(44 per classes)
2024-09-05 03:04:51,654 [base.py] => Constructing exemplars...(44 per classes)
2024-09-05 03:09:42,048 [der.py] => Exemplar size: 1980
2024-09-05 03:09:42,048 [trainer.py] => CNN: {'total': 91.2, '00-04': 94.4, '05-09': 83.8, '10-14': 81.2, '15-19': 87.8, '20-24': 92.6, '25-29': 95.4, '30-34': 91.6, '35-39': 96.4, '40-44': 97.6, 'old': 90.4, 'new': 97.6}
2024-09-05 03:09:42,048 [trainer.py] => NME: {'total': 92.31, '00-04': 97.2, '05-09': 87.8, '10-14': 89.4, '15-19': 90.4, '20-24': 97.0, '25-29': 95.2, '30-34': 90.4, '35-39': 94.6, '40-44': 88.8, 'old': 92.75, 'new': 88.8}
2024-09-05 03:09:42,048 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2]
2024-09-05 03:09:42,048 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62]
2024-09-05 03:09:42,048 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31]
2024-09-05 03:09:42,048 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27]

Average Accuracy (CNN): 95.11
Average Accuracy (NME): 95.66
2024-09-05 03:09:42,048 [trainer.py] => Average Accuracy (CNN): 95.11
2024-09-05 03:09:42,048 [trainer.py] => Average Accuracy (NME): 95.66
2024-09-05 03:09:42,053 [trainer.py] => All params: 772503603
2024-09-05 03:09:42,057 [trainer.py] => Trainable params: 86114355
2024-09-05 03:09:43,448 [der.py] => Learning on 45-50
2024-09-05 03:09:43,457 [der.py] => All params: 858375224
2024-09-05 03:09:43,461 [der.py] => Trainable params: 86187320

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.390, Loss_clf 0.924, Loss_aux 0.467, Train_accy 84.42, Test_accy 88.34:   0%|          | 0/20 [04:36<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.390, Loss_clf 0.924, Loss_aux 0.467, Train_accy 84.42, Test_accy 88.34:   5%|▌         | 1/20 [04:36<1:27:42, 276.96s/it]
Task 9, Epoch 2/20 => Loss 0.498, Loss_clf 0.310, Loss_aux 0.188, Train_accy 91.12:   5%|▌         | 1/20 [06:59<1:27:42, 276.96s/it]                 
Task 9, Epoch 2/20 => Loss 0.498, Loss_clf 0.310, Loss_aux 0.188, Train_accy 91.12:  10%|█         | 2/20 [06:59<59:20, 197.78s/it]  
Task 9, Epoch 3/20 => Loss 0.460, Loss_clf 0.289, Loss_aux 0.171, Train_accy 91.63:  10%|█         | 2/20 [09:21<59:20, 197.78s/it]
Task 9, Epoch 3/20 => Loss 0.460, Loss_clf 0.289, Loss_aux 0.171, Train_accy 91.63:  15%|█▌        | 3/20 [09:21<48:52, 172.49s/it]
Task 9, Epoch 4/20 => Loss 0.442, Loss_clf 0.283, Loss_aux 0.159, Train_accy 91.99:  15%|█▌        | 3/20 [11:44<48:52, 172.49s/it]
Task 9, Epoch 4/20 => Loss 0.442, Loss_clf 0.283, Loss_aux 0.159, Train_accy 91.99:  20%|██        | 4/20 [11:44<42:49, 160.57s/it]
Task 9, Epoch 5/20 => Loss 0.404, Loss_clf 0.256, Loss_aux 0.147, Train_accy 92.63:  20%|██        | 4/20 [14:06<42:49, 160.57s/it]
Task 9, Epoch 5/20 => Loss 0.404, Loss_clf 0.256, Loss_aux 0.147, Train_accy 92.63:  25%|██▌       | 5/20 [14:06<38:29, 153.99s/it]
Task 9, Epoch 6/20 => Loss 0.350, Loss_clf 0.226, Loss_aux 0.124, Train_accy 93.53, Test_accy 87.80:  25%|██▌       | 5/20 [18:43<38:29, 153.99s/it]
Task 9, Epoch 6/20 => Loss 0.350, Loss_clf 0.226, Loss_aux 0.124, Train_accy 93.53, Test_accy 87.80:  30%|███       | 6/20 [18:43<45:42, 195.87s/it]
Task 9, Epoch 7/20 => Loss 0.406, Loss_clf 0.264, Loss_aux 0.143, Train_accy 92.46:  30%|███       | 6/20 [21:05<45:42, 195.87s/it]                 
Task 9, Epoch 7/20 => Loss 0.406, Loss_clf 0.264, Loss_aux 0.143, Train_accy 92.46:  35%|███▌      | 7/20 [21:05<38:38, 178.35s/it]
Task 9, Epoch 8/20 => Loss 0.391, Loss_clf 0.250, Loss_aux 0.141, Train_accy 92.59:  35%|███▌      | 7/20 [23:28<38:38, 178.35s/it]
Task 9, Epoch 8/20 => Loss 0.391, Loss_clf 0.250, Loss_aux 0.141, Train_accy 92.59:  40%|████      | 8/20 [23:28<33:22, 166.86s/it]
Task 9, Epoch 9/20 => Loss 0.397, Loss_clf 0.249, Loss_aux 0.149, Train_accy 93.06:  40%|████      | 8/20 [25:50<33:22, 166.86s/it]
Task 9, Epoch 9/20 => Loss 0.397, Loss_clf 0.249, Loss_aux 0.149, Train_accy 93.06:  45%|████▌     | 9/20 [25:50<29:11, 159.20s/it]
Task 9, Epoch 10/20 => Loss 0.376, Loss_clf 0.241, Loss_aux 0.135, Train_accy 92.99:  45%|████▌     | 9/20 [28:12<29:11, 159.20s/it]
Task 9, Epoch 10/20 => Loss 0.376, Loss_clf 0.241, Loss_aux 0.135, Train_accy 92.99:  50%|█████     | 10/20 [28:12<25:39, 153.96s/it]
Task 9, Epoch 11/20 => Loss 0.363, Loss_clf 0.228, Loss_aux 0.135, Train_accy 93.71, Test_accy 89.38:  50%|█████     | 10/20 [32:49<25:39, 153.96s/it]
Task 9, Epoch 11/20 => Loss 0.363, Loss_clf 0.228, Loss_aux 0.135, Train_accy 93.71, Test_accy 89.38:  55%|█████▌    | 11/20 [32:49<28:44, 191.67s/it]
Task 9, Epoch 12/20 => Loss 0.362, Loss_clf 0.237, Loss_aux 0.125, Train_accy 93.21:  55%|█████▌    | 11/20 [35:12<28:44, 191.67s/it]                 
Task 9, Epoch 12/20 => Loss 0.362, Loss_clf 0.237, Loss_aux 0.125, Train_accy 93.21:  60%|██████    | 12/20 [35:12<23:33, 176.63s/it]
Task 9, Epoch 13/20 => Loss 0.341, Loss_clf 0.217, Loss_aux 0.123, Train_accy 93.84:  60%|██████    | 12/20 [37:34<23:33, 176.63s/it]
Task 9, Epoch 13/20 => Loss 0.341, Loss_clf 0.217, Loss_aux 0.123, Train_accy 93.84:  65%|██████▌   | 13/20 [37:34<19:23, 166.22s/it]
Task 9, Epoch 14/20 => Loss 0.364, Loss_clf 0.234, Loss_aux 0.130, Train_accy 93.26:  65%|██████▌   | 13/20 [39:56<19:23, 166.22s/it]
Task 9, Epoch 14/20 => Loss 0.364, Loss_clf 0.234, Loss_aux 0.130, Train_accy 93.26:  70%|███████   | 14/20 [39:56<15:53, 158.98s/it]
Task 9, Epoch 15/20 => Loss 0.324, Loss_clf 0.213, Loss_aux 0.111, Train_accy 94.08:  70%|███████   | 14/20 [42:18<15:53, 158.98s/it]
Task 9, Epoch 15/20 => Loss 0.324, Loss_clf 0.213, Loss_aux 0.111, Train_accy 94.08:  75%|███████▌  | 15/20 [42:18<12:49, 153.93s/it]
Task 9, Epoch 16/20 => Loss 0.343, Loss_clf 0.225, Loss_aux 0.118, Train_accy 93.39, Test_accy 89.06:  75%|███████▌  | 15/20 [46:55<12:49, 153.93s/it]
Task 9, Epoch 16/20 => Loss 0.343, Loss_clf 0.225, Loss_aux 0.118, Train_accy 93.39, Test_accy 89.06:  80%|████████  | 16/20 [46:55<12:44, 191.02s/it]
Task 9, Epoch 17/20 => Loss 0.342, Loss_clf 0.211, Loss_aux 0.131, Train_accy 93.88:  80%|████████  | 16/20 [49:18<12:44, 191.02s/it]                 
Task 9, Epoch 17/20 => Loss 0.342, Loss_clf 0.211, Loss_aux 0.131, Train_accy 93.88:  85%|████████▌ | 17/20 [49:18<08:49, 176.37s/it]
Task 9, Epoch 18/20 => Loss 0.320, Loss_clf 0.206, Loss_aux 0.113, Train_accy 94.00:  85%|████████▌ | 17/20 [51:40<08:49, 176.37s/it]
Task 9, Epoch 18/20 => Loss 0.320, Loss_clf 0.206, Loss_aux 0.113, Train_accy 94.00:  90%|█████████ | 18/20 [51:40<05:32, 166.18s/it]
Task 9, Epoch 19/20 => Loss 0.327, Loss_clf 0.206, Loss_aux 0.121, Train_accy 94.24:  90%|█████████ | 18/20 [54:03<05:32, 166.18s/it]
Task 9, Epoch 19/20 => Loss 0.327, Loss_clf 0.206, Loss_aux 0.121, Train_accy 94.24:  95%|█████████▌| 19/20 [54:03<02:39, 159.07s/it]
Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.206, Loss_aux 0.122, Train_accy 94.15:  95%|█████████▌| 19/20 [56:25<02:39, 159.07s/it]
Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.206, Loss_aux 0.122, Train_accy 94.15: 100%|██████████| 20/20 [56:25<00:00, 154.08s/it]
Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.206, Loss_aux 0.122, Train_accy 94.15: 100%|██████████| 20/20 [56:25<00:00, 169.28s/it]
2024-09-05 04:06:09,179 [der.py] => Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.206, Loss_aux 0.122, Train_accy 94.15
2024-09-05 04:06:09,181 [base.py] => Reducing exemplars...(40 per classes)
2024-09-05 04:07:16,518 [base.py] => Constructing exemplars...(40 per classes)
2024-09-05 04:13:06,979 [der.py] => Exemplar size: 2000
2024-09-05 04:13:06,979 [trainer.py] => CNN: {'total': 88.72, '00-04': 91.2, '05-09': 78.2, '10-14': 77.2, '15-19': 84.8, '20-24': 94.8, '25-29': 90.6, '30-34': 90.8, '35-39': 86.0, '40-44': 94.8, '45-49': 98.8, 'old': 87.6, 'new': 98.8}
2024-09-05 04:13:06,979 [trainer.py] => NME: {'total': 91.54, '00-04': 96.8, '05-09': 86.8, '10-14': 87.0, '15-19': 90.2, '20-24': 97.2, '25-29': 93.4, '30-34': 90.4, '35-39': 88.8, '40-44': 91.0, '45-49': 93.8, 'old': 91.29, 'new': 93.8}
2024-09-05 04:13:06,979 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72]
2024-09-05 04:13:06,979 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5]
2024-09-05 04:13:06,979 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54]
2024-09-05 04:13:06,979 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28]

Average Accuracy (CNN): 94.47
Average Accuracy (NME): 95.25
2024-09-05 04:13:06,979 [trainer.py] => Average Accuracy (CNN): 94.47
2024-09-05 04:13:06,979 [trainer.py] => Average Accuracy (NME): 95.25
2024-09-05 04:13:06,985 [trainer.py] => All params: 858375224
2024-09-05 04:13:06,989 [trainer.py] => Trainable params: 86187320
2024-09-05 04:13:08,632 [der.py] => Learning on 50-55
2024-09-05 04:13:08,642 [der.py] => All params: 944254525
2024-09-05 04:13:08,647 [der.py] => Trainable params: 86267965

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.308, Loss_clf 0.870, Loss_aux 0.437, Train_accy 83.76, Test_accy 88.56:   0%|          | 0/20 [05:17<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.308, Loss_clf 0.870, Loss_aux 0.437, Train_accy 83.76, Test_accy 88.56:   5%|▌         | 1/20 [05:17<1:40:41, 317.99s/it]
Task 10, Epoch 2/20 => Loss 0.535, Loss_clf 0.319, Loss_aux 0.216, Train_accy 90.47:   5%|▌         | 1/20 [07:52<1:40:41, 317.99s/it]                 
Task 10, Epoch 2/20 => Loss 0.535, Loss_clf 0.319, Loss_aux 0.216, Train_accy 90.47:  10%|█         | 2/20 [07:52<1:06:37, 222.10s/it]
Task 10, Epoch 3/20 => Loss 0.511, Loss_clf 0.314, Loss_aux 0.197, Train_accy 90.58:  10%|█         | 2/20 [10:27<1:06:37, 222.10s/it]
Task 10, Epoch 3/20 => Loss 0.511, Loss_clf 0.314, Loss_aux 0.197, Train_accy 90.58:  15%|█▌        | 3/20 [10:27<54:15, 191.48s/it]  
Task 10, Epoch 4/20 => Loss 0.481, Loss_clf 0.288, Loss_aux 0.193, Train_accy 91.22:  15%|█▌        | 3/20 [13:03<54:15, 191.48s/it]
Task 10, Epoch 4/20 => Loss 0.481, Loss_clf 0.288, Loss_aux 0.193, Train_accy 91.22:  20%|██        | 4/20 [13:03<47:13, 177.08s/it]
Task 10, Epoch 5/20 => Loss 0.417, Loss_clf 0.259, Loss_aux 0.158, Train_accy 92.53:  20%|██        | 4/20 [15:38<47:13, 177.08s/it]
Task 10, Epoch 5/20 => Loss 0.417, Loss_clf 0.259, Loss_aux 0.158, Train_accy 92.53:  25%|██▌       | 5/20 [15:38<42:17, 169.15s/it]
Task 10, Epoch 6/20 => Loss 0.435, Loss_clf 0.268, Loss_aux 0.167, Train_accy 92.13, Test_accy 86.09:  25%|██▌       | 5/20 [20:56<42:17, 169.15s/it]
Task 10, Epoch 6/20 => Loss 0.435, Loss_clf 0.268, Loss_aux 0.167, Train_accy 92.13, Test_accy 86.09:  30%|███       | 6/20 [20:56<51:16, 219.77s/it]
Task 10, Epoch 7/20 => Loss 0.430, Loss_clf 0.265, Loss_aux 0.165, Train_accy 91.96:  30%|███       | 6/20 [23:31<51:16, 219.77s/it]                 
Task 10, Epoch 7/20 => Loss 0.430, Loss_clf 0.265, Loss_aux 0.165, Train_accy 91.96:  35%|███▌      | 7/20 [23:31<43:01, 198.57s/it]
Task 10, Epoch 8/20 => Loss 0.385, Loss_clf 0.234, Loss_aux 0.151, Train_accy 93.18:  35%|███▌      | 7/20 [26:06<43:01, 198.57s/it]
Task 10, Epoch 8/20 => Loss 0.385, Loss_clf 0.234, Loss_aux 0.151, Train_accy 93.18:  40%|████      | 8/20 [26:06<36:56, 184.70s/it]
Task 10, Epoch 9/20 => Loss 0.394, Loss_clf 0.250, Loss_aux 0.145, Train_accy 92.47:  40%|████      | 8/20 [28:41<36:56, 184.70s/it]
Task 10, Epoch 9/20 => Loss 0.394, Loss_clf 0.250, Loss_aux 0.145, Train_accy 92.47:  45%|████▌     | 9/20 [28:41<32:09, 175.42s/it]
Task 10, Epoch 10/20 => Loss 0.425, Loss_clf 0.259, Loss_aux 0.167, Train_accy 92.27:  45%|████▌     | 9/20 [31:16<32:09, 175.42s/it]
Task 10, Epoch 10/20 => Loss 0.425, Loss_clf 0.259, Loss_aux 0.167, Train_accy 92.27:  50%|█████     | 10/20 [31:16<28:11, 169.10s/it]
Task 10, Epoch 11/20 => Loss 0.390, Loss_clf 0.244, Loss_aux 0.147, Train_accy 92.93, Test_accy 87.56:  50%|█████     | 10/20 [36:34<28:11, 169.10s/it]
Task 10, Epoch 11/20 => Loss 0.390, Loss_clf 0.244, Loss_aux 0.147, Train_accy 92.93, Test_accy 87.56:  55%|█████▌    | 11/20 [36:34<32:12, 214.71s/it]
Task 10, Epoch 12/20 => Loss 0.384, Loss_clf 0.244, Loss_aux 0.140, Train_accy 92.96:  55%|█████▌    | 11/20 [39:09<32:12, 214.71s/it]                 
Task 10, Epoch 12/20 => Loss 0.384, Loss_clf 0.244, Loss_aux 0.140, Train_accy 92.96:  60%|██████    | 12/20 [39:09<26:12, 196.54s/it]
Task 10, Epoch 13/20 => Loss 0.374, Loss_clf 0.229, Loss_aux 0.145, Train_accy 93.29:  60%|██████    | 12/20 [41:44<26:12, 196.54s/it]
Task 10, Epoch 13/20 => Loss 0.374, Loss_clf 0.229, Loss_aux 0.145, Train_accy 93.29:  65%|██████▌   | 13/20 [41:44<21:27, 183.94s/it]
Task 10, Epoch 14/20 => Loss 0.372, Loss_clf 0.236, Loss_aux 0.136, Train_accy 93.13:  65%|██████▌   | 13/20 [44:19<21:27, 183.94s/it]
Task 10, Epoch 14/20 => Loss 0.372, Loss_clf 0.236, Loss_aux 0.136, Train_accy 93.13:  70%|███████   | 14/20 [44:19<17:31, 175.19s/it]
Task 10, Epoch 15/20 => Loss 0.388, Loss_clf 0.250, Loss_aux 0.139, Train_accy 92.96:  70%|███████   | 14/20 [46:54<17:31, 175.19s/it]
Task 10, Epoch 15/20 => Loss 0.388, Loss_clf 0.250, Loss_aux 0.139, Train_accy 92.96:  75%|███████▌  | 15/20 [46:54<14:05, 169.10s/it]
Task 10, Epoch 16/20 => Loss 0.383, Loss_clf 0.237, Loss_aux 0.145, Train_accy 93.11, Test_accy 87.64:  75%|███████▌  | 15/20 [52:12<14:05, 169.10s/it]
Task 10, Epoch 16/20 => Loss 0.383, Loss_clf 0.237, Loss_aux 0.145, Train_accy 93.11, Test_accy 87.64:  80%|████████  | 16/20 [52:12<14:15, 213.94s/it]
Task 10, Epoch 17/20 => Loss 0.374, Loss_clf 0.246, Loss_aux 0.128, Train_accy 93.11:  80%|████████  | 16/20 [54:47<14:15, 213.94s/it]                 
Task 10, Epoch 17/20 => Loss 0.374, Loss_clf 0.246, Loss_aux 0.128, Train_accy 93.11:  85%|████████▌ | 17/20 [54:47<09:48, 196.21s/it]
Task 10, Epoch 18/20 => Loss 0.328, Loss_clf 0.210, Loss_aux 0.118, Train_accy 93.84:  85%|████████▌ | 17/20 [57:22<09:48, 196.21s/it]
Task 10, Epoch 18/20 => Loss 0.328, Loss_clf 0.210, Loss_aux 0.118, Train_accy 93.84:  90%|█████████ | 18/20 [57:22<06:07, 183.82s/it]
Task 10, Epoch 19/20 => Loss 0.346, Loss_clf 0.223, Loss_aux 0.123, Train_accy 93.51:  90%|█████████ | 18/20 [59:57<06:07, 183.82s/it]
Task 10, Epoch 19/20 => Loss 0.346, Loss_clf 0.223, Loss_aux 0.123, Train_accy 93.51:  95%|█████████▌| 19/20 [59:57<02:55, 175.15s/it]
Task 10, Epoch 20/20 => Loss 0.288, Loss_clf 0.175, Loss_aux 0.113, Train_accy 95.07:  95%|█████████▌| 19/20 [1:02:31<02:55, 175.15s/it]
Task 10, Epoch 20/20 => Loss 0.288, Loss_clf 0.175, Loss_aux 0.113, Train_accy 95.07: 100%|██████████| 20/20 [1:02:31<00:00, 169.08s/it]
Task 10, Epoch 20/20 => Loss 0.288, Loss_clf 0.175, Loss_aux 0.113, Train_accy 95.07: 100%|██████████| 20/20 [1:02:31<00:00, 187.60s/it]
2024-09-05 05:15:40,765 [der.py] => Task 10, Epoch 20/20 => Loss 0.288, Loss_clf 0.175, Loss_aux 0.113, Train_accy 95.07
2024-09-05 05:15:40,766 [base.py] => Reducing exemplars...(36 per classes)
2024-09-05 05:16:52,980 [base.py] => Constructing exemplars...(36 per classes)
2024-09-05 05:23:46,169 [der.py] => Exemplar size: 1980
2024-09-05 05:23:46,169 [trainer.py] => CNN: {'total': 87.69, '00-04': 83.4, '05-09': 79.8, '10-14': 76.4, '15-19': 87.4, '20-24': 94.0, '25-29': 87.4, '30-34': 88.8, '35-39': 87.4, '40-44': 89.6, '45-49': 92.0, '50-54': 98.4, 'old': 86.62, 'new': 98.4}
2024-09-05 05:23:46,170 [trainer.py] => NME: {'total': 90.35, '00-04': 95.0, '05-09': 85.6, '10-14': 85.8, '15-19': 89.8, '20-24': 97.2, '25-29': 92.6, '30-34': 90.4, '35-39': 87.2, '40-44': 90.0, '45-49': 93.0, '50-54': 87.2, 'old': 90.66, 'new': 87.2}
2024-09-05 05:23:46,170 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69]
2024-09-05 05:23:46,170 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13]
2024-09-05 05:23:46,170 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35]
2024-09-05 05:23:46,170 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15]

Average Accuracy (CNN): 93.86
Average Accuracy (NME): 94.8
2024-09-05 05:23:46,170 [trainer.py] => Average Accuracy (CNN): 93.86
2024-09-05 05:23:46,170 [trainer.py] => Average Accuracy (NME): 94.8
2024-09-05 05:23:46,176 [trainer.py] => All params: 944254525
2024-09-05 05:23:46,181 [trainer.py] => Trainable params: 86267965
2024-09-05 05:23:47,717 [der.py] => Learning on 55-60
2024-09-05 05:23:47,729 [der.py] => All params: 1030141506
2024-09-05 05:23:47,735 [der.py] => Trainable params: 86356290

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.439, Loss_clf 0.878, Loss_aux 0.561, Train_accy 79.67, Test_accy 86.87:   0%|          | 0/20 [05:59<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.439, Loss_clf 0.878, Loss_aux 0.561, Train_accy 79.67, Test_accy 86.87:   5%|▌         | 1/20 [05:59<1:53:55, 359.77s/it]
Task 11, Epoch 2/20 => Loss 0.684, Loss_clf 0.396, Loss_aux 0.288, Train_accy 87.68:   5%|▌         | 1/20 [08:45<1:53:55, 359.77s/it]                 
Task 11, Epoch 2/20 => Loss 0.684, Loss_clf 0.396, Loss_aux 0.288, Train_accy 87.68:  10%|█         | 2/20 [08:45<1:13:46, 245.91s/it]
Task 11, Epoch 3/20 => Loss 0.594, Loss_clf 0.333, Loss_aux 0.260, Train_accy 89.53:  10%|█         | 2/20 [11:32<1:13:46, 245.91s/it]
Task 11, Epoch 3/20 => Loss 0.594, Loss_clf 0.333, Loss_aux 0.260, Train_accy 89.53:  15%|█▌        | 3/20 [11:32<59:22, 209.56s/it]  
Task 11, Epoch 4/20 => Loss 0.569, Loss_clf 0.339, Loss_aux 0.230, Train_accy 89.49:  15%|█▌        | 3/20 [14:18<59:22, 209.56s/it]
Task 11, Epoch 4/20 => Loss 0.569, Loss_clf 0.339, Loss_aux 0.230, Train_accy 89.49:  20%|██        | 4/20 [14:18<51:19, 192.46s/it]
Task 11, Epoch 5/20 => Loss 0.548, Loss_clf 0.320, Loss_aux 0.228, Train_accy 90.07:  20%|██        | 4/20 [17:04<51:19, 192.46s/it]
Task 11, Epoch 5/20 => Loss 0.548, Loss_clf 0.320, Loss_aux 0.228, Train_accy 90.07:  25%|██▌       | 5/20 [17:04<45:45, 183.03s/it]
Task 11, Epoch 6/20 => Loss 0.509, Loss_clf 0.297, Loss_aux 0.212, Train_accy 90.89, Test_accy 87.85:  25%|██▌       | 5/20 [23:04<45:45, 183.03s/it]
Task 11, Epoch 6/20 => Loss 0.509, Loss_clf 0.297, Loss_aux 0.212, Train_accy 90.89, Test_accy 87.85:  30%|███       | 6/20 [23:05<56:45, 243.26s/it]
Task 11, Epoch 7/20 => Loss 0.514, Loss_clf 0.300, Loss_aux 0.213, Train_accy 91.41:  30%|███       | 6/20 [25:51<56:45, 243.26s/it]                 
Task 11, Epoch 7/20 => Loss 0.514, Loss_clf 0.300, Loss_aux 0.213, Train_accy 91.41:  35%|███▌      | 7/20 [25:51<47:14, 218.07s/it]
Task 11, Epoch 8/20 => Loss 0.497, Loss_clf 0.298, Loss_aux 0.199, Train_accy 91.52:  35%|███▌      | 7/20 [28:37<47:14, 218.07s/it]
Task 11, Epoch 8/20 => Loss 0.497, Loss_clf 0.298, Loss_aux 0.199, Train_accy 91.52:  40%|████      | 8/20 [28:37<40:18, 201.58s/it]
Task 11, Epoch 9/20 => Loss 0.478, Loss_clf 0.293, Loss_aux 0.185, Train_accy 91.32:  40%|████      | 8/20 [31:23<40:18, 201.58s/it]
Task 11, Epoch 9/20 => Loss 0.478, Loss_clf 0.293, Loss_aux 0.185, Train_accy 91.32:  45%|████▌     | 9/20 [31:23<34:55, 190.53s/it]
Task 11, Epoch 10/20 => Loss 0.455, Loss_clf 0.277, Loss_aux 0.178, Train_accy 91.43:  45%|████▌     | 9/20 [34:09<34:55, 190.53s/it]
Task 11, Epoch 10/20 => Loss 0.455, Loss_clf 0.277, Loss_aux 0.178, Train_accy 91.43:  50%|█████     | 10/20 [34:09<30:30, 183.03s/it]
Task 11, Epoch 11/20 => Loss 0.467, Loss_clf 0.285, Loss_aux 0.183, Train_accy 91.70, Test_accy 88.53:  50%|█████     | 10/20 [40:10<30:30, 183.03s/it]
Task 11, Epoch 11/20 => Loss 0.467, Loss_clf 0.285, Loss_aux 0.183, Train_accy 91.70, Test_accy 88.53:  55%|█████▌    | 11/20 [40:10<35:35, 237.26s/it]
Task 11, Epoch 12/20 => Loss 0.436, Loss_clf 0.260, Loss_aux 0.175, Train_accy 92.23:  55%|█████▌    | 11/20 [42:56<35:35, 237.26s/it]                 
Task 11, Epoch 12/20 => Loss 0.436, Loss_clf 0.260, Loss_aux 0.175, Train_accy 92.23:  60%|██████    | 12/20 [42:56<28:45, 215.67s/it]
Task 11, Epoch 13/20 => Loss 0.473, Loss_clf 0.286, Loss_aux 0.186, Train_accy 91.21:  60%|██████    | 12/20 [45:42<28:45, 215.67s/it]
Task 11, Epoch 13/20 => Loss 0.473, Loss_clf 0.286, Loss_aux 0.186, Train_accy 91.21:  65%|██████▌   | 13/20 [45:42<23:24, 200.69s/it]
Task 11, Epoch 14/20 => Loss 0.458, Loss_clf 0.277, Loss_aux 0.181, Train_accy 91.45:  65%|██████▌   | 13/20 [48:29<23:24, 200.69s/it]
Task 11, Epoch 14/20 => Loss 0.458, Loss_clf 0.277, Loss_aux 0.181, Train_accy 91.45:  70%|███████   | 14/20 [48:29<19:01, 190.31s/it]
Task 11, Epoch 15/20 => Loss 0.458, Loss_clf 0.272, Loss_aux 0.186, Train_accy 91.72:  70%|███████   | 14/20 [51:15<19:01, 190.31s/it]
Task 11, Epoch 15/20 => Loss 0.458, Loss_clf 0.272, Loss_aux 0.186, Train_accy 91.72:  75%|███████▌  | 15/20 [51:15<15:15, 183.07s/it]
Task 11, Epoch 16/20 => Loss 0.439, Loss_clf 0.262, Loss_aux 0.177, Train_accy 92.08, Test_accy 87.83:  75%|███████▌  | 15/20 [57:15<15:15, 183.07s/it]
Task 11, Epoch 16/20 => Loss 0.439, Loss_clf 0.262, Loss_aux 0.177, Train_accy 92.08, Test_accy 87.83:  80%|████████  | 16/20 [57:15<15:45, 236.35s/it]
Task 11, Epoch 17/20 => Loss 0.448, Loss_clf 0.263, Loss_aux 0.185, Train_accy 92.08:  80%|████████  | 16/20 [1:00:01<15:45, 236.35s/it]               
Task 11, Epoch 17/20 => Loss 0.448, Loss_clf 0.263, Loss_aux 0.185, Train_accy 92.08:  85%|████████▌ | 17/20 [1:00:01<10:45, 215.27s/it]
Task 11, Epoch 18/20 => Loss 0.469, Loss_clf 0.282, Loss_aux 0.186, Train_accy 91.61:  85%|████████▌ | 17/20 [1:02:47<10:45, 215.27s/it]
Task 11, Epoch 18/20 => Loss 0.469, Loss_clf 0.282, Loss_aux 0.186, Train_accy 91.61:  90%|█████████ | 18/20 [1:02:47<06:41, 200.53s/it]
Task 11, Epoch 19/20 => Loss 0.451, Loss_clf 0.277, Loss_aux 0.174, Train_accy 91.96:  90%|█████████ | 18/20 [1:05:34<06:41, 200.53s/it]
Task 11, Epoch 19/20 => Loss 0.451, Loss_clf 0.277, Loss_aux 0.174, Train_accy 91.96:  95%|█████████▌| 19/20 [1:05:34<03:10, 190.23s/it]
Task 11, Epoch 20/20 => Loss 0.436, Loss_clf 0.267, Loss_aux 0.169, Train_accy 91.83:  95%|█████████▌| 19/20 [1:08:20<03:10, 190.23s/it]
Task 11, Epoch 20/20 => Loss 0.436, Loss_clf 0.267, Loss_aux 0.169, Train_accy 91.83: 100%|██████████| 20/20 [1:08:20<00:00, 183.04s/it]
Task 11, Epoch 20/20 => Loss 0.436, Loss_clf 0.267, Loss_aux 0.169, Train_accy 91.83: 100%|██████████| 20/20 [1:08:20<00:00, 205.02s/it]
2024-09-05 06:32:08,244 [der.py] => Task 11, Epoch 20/20 => Loss 0.436, Loss_clf 0.267, Loss_aux 0.169, Train_accy 91.83
2024-09-05 06:32:08,246 [base.py] => Reducing exemplars...(33 per classes)
2024-09-05 06:33:28,310 [base.py] => Constructing exemplars...(33 per classes)
2024-09-05 06:41:29,891 [der.py] => Exemplar size: 1980
2024-09-05 06:41:29,891 [trainer.py] => CNN: {'total': 88.18, '00-04': 88.8, '05-09': 77.2, '10-14': 76.0, '15-19': 83.6, '20-24': 93.6, '25-29': 85.4, '30-34': 90.6, '35-39': 89.2, '40-44': 89.8, '45-49': 91.2, '50-54': 97.0, '55-59': 95.8, 'old': 87.49, 'new': 95.8}
2024-09-05 06:41:29,891 [trainer.py] => NME: {'total': 89.9, '00-04': 93.8, '05-09': 85.4, '10-14': 84.6, '15-19': 87.6, '20-24': 97.0, '25-29': 91.0, '30-34': 89.8, '35-39': 88.0, '40-44': 90.4, '45-49': 92.8, '50-54': 89.8, '55-59': 88.6, 'old': 90.02, 'new': 88.6}
2024-09-05 06:41:29,891 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18]
2024-09-05 06:41:29,891 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75]
2024-09-05 06:41:29,891 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9]
2024-09-05 06:41:29,891 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93]

Average Accuracy (CNN): 93.38
Average Accuracy (NME): 94.39
2024-09-05 06:41:29,891 [trainer.py] => Average Accuracy (CNN): 93.38
2024-09-05 06:41:29,891 [trainer.py] => Average Accuracy (NME): 94.39
2024-09-05 06:41:29,897 [trainer.py] => All params: 1030141506
2024-09-05 06:41:29,903 [trainer.py] => Trainable params: 86356290
2024-09-05 06:41:31,409 [der.py] => Learning on 60-65
2024-09-05 06:41:31,422 [der.py] => All params: 1116036167
2024-09-05 06:41:31,427 [der.py] => Trainable params: 86452295

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.589, Loss_clf 1.155, Loss_aux 0.434, Train_accy 83.37, Test_accy 85.78:   0%|          | 0/20 [06:45<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.589, Loss_clf 1.155, Loss_aux 0.434, Train_accy 83.37, Test_accy 85.78:   5%|▌         | 1/20 [06:45<2:08:19, 405.24s/it]
Task 12, Epoch 2/20 => Loss 0.533, Loss_clf 0.328, Loss_aux 0.205, Train_accy 90.87:   5%|▌         | 1/20 [09:43<2:08:19, 405.24s/it]                 
Task 12, Epoch 2/20 => Loss 0.533, Loss_clf 0.328, Loss_aux 0.205, Train_accy 90.87:  10%|█         | 2/20 [09:43<1:21:30, 271.70s/it]
Task 12, Epoch 3/20 => Loss 0.489, Loss_clf 0.312, Loss_aux 0.178, Train_accy 90.78:  10%|█         | 2/20 [12:41<1:21:30, 271.70s/it]
Task 12, Epoch 3/20 => Loss 0.489, Loss_clf 0.312, Loss_aux 0.178, Train_accy 90.78:  15%|█▌        | 3/20 [12:41<1:04:54, 229.10s/it]
Task 12, Epoch 4/20 => Loss 0.463, Loss_clf 0.297, Loss_aux 0.167, Train_accy 91.76:  15%|█▌        | 3/20 [15:40<1:04:54, 229.10s/it]
Task 12, Epoch 4/20 => Loss 0.463, Loss_clf 0.297, Loss_aux 0.167, Train_accy 91.76:  20%|██        | 4/20 [15:40<55:44, 209.01s/it]  
Task 12, Epoch 5/20 => Loss 0.439, Loss_clf 0.275, Loss_aux 0.164, Train_accy 92.34:  20%|██        | 4/20 [18:38<55:44, 209.01s/it]
Task 12, Epoch 5/20 => Loss 0.439, Loss_clf 0.275, Loss_aux 0.164, Train_accy 92.34:  25%|██▌       | 5/20 [18:38<49:28, 197.88s/it]
Task 12, Epoch 6/20 => Loss 0.383, Loss_clf 0.239, Loss_aux 0.144, Train_accy 93.06, Test_accy 85.49:  25%|██▌       | 5/20 [25:23<49:28, 197.88s/it]
Task 12, Epoch 6/20 => Loss 0.383, Loss_clf 0.239, Loss_aux 0.144, Train_accy 93.06, Test_accy 85.49:  30%|███       | 6/20 [25:23<1:02:38, 268.44s/it]
Task 12, Epoch 7/20 => Loss 0.402, Loss_clf 0.259, Loss_aux 0.144, Train_accy 92.34:  30%|███       | 6/20 [28:21<1:02:38, 268.44s/it]                 
Task 12, Epoch 7/20 => Loss 0.402, Loss_clf 0.259, Loss_aux 0.144, Train_accy 92.34:  35%|███▌      | 7/20 [28:21<51:46, 238.96s/it]  
Task 12, Epoch 8/20 => Loss 0.373, Loss_clf 0.242, Loss_aux 0.131, Train_accy 93.24:  35%|███▌      | 7/20 [31:20<51:46, 238.96s/it]
Task 12, Epoch 8/20 => Loss 0.373, Loss_clf 0.242, Loss_aux 0.131, Train_accy 93.24:  40%|████      | 8/20 [31:20<43:55, 219.62s/it]
Task 12, Epoch 9/20 => Loss 0.367, Loss_clf 0.229, Loss_aux 0.138, Train_accy 93.42:  40%|████      | 8/20 [34:18<43:55, 219.62s/it]
Task 12, Epoch 9/20 => Loss 0.367, Loss_clf 0.229, Loss_aux 0.138, Train_accy 93.42:  45%|████▌     | 9/20 [34:18<37:53, 206.67s/it]
Task 12, Epoch 10/20 => Loss 0.377, Loss_clf 0.244, Loss_aux 0.133, Train_accy 92.97:  45%|████▌     | 9/20 [37:16<37:53, 206.67s/it]
Task 12, Epoch 10/20 => Loss 0.377, Loss_clf 0.244, Loss_aux 0.133, Train_accy 92.97:  50%|█████     | 10/20 [37:16<32:58, 197.87s/it]
Task 12, Epoch 11/20 => Loss 0.354, Loss_clf 0.231, Loss_aux 0.124, Train_accy 93.75, Test_accy 87.00:  50%|█████     | 10/20 [44:01<32:58, 197.87s/it]
Task 12, Epoch 11/20 => Loss 0.354, Loss_clf 0.231, Loss_aux 0.124, Train_accy 93.75, Test_accy 87.00:  55%|█████▌    | 11/20 [44:01<39:12, 261.40s/it]
Task 12, Epoch 12/20 => Loss 0.387, Loss_clf 0.238, Loss_aux 0.149, Train_accy 93.26:  55%|█████▌    | 11/20 [47:00<39:12, 261.40s/it]                 
Task 12, Epoch 12/20 => Loss 0.387, Loss_clf 0.238, Loss_aux 0.149, Train_accy 93.26:  60%|██████    | 12/20 [47:00<31:28, 236.08s/it]
Task 12, Epoch 13/20 => Loss 0.378, Loss_clf 0.248, Loss_aux 0.130, Train_accy 93.44:  60%|██████    | 12/20 [49:58<31:28, 236.08s/it]
Task 12, Epoch 13/20 => Loss 0.378, Loss_clf 0.248, Loss_aux 0.130, Train_accy 93.44:  65%|██████▌   | 13/20 [49:58<25:29, 218.52s/it]
Task 12, Epoch 14/20 => Loss 0.317, Loss_clf 0.203, Loss_aux 0.114, Train_accy 94.33:  65%|██████▌   | 13/20 [52:56<25:29, 218.52s/it]
Task 12, Epoch 14/20 => Loss 0.317, Loss_clf 0.203, Loss_aux 0.114, Train_accy 94.33:  70%|███████   | 14/20 [52:56<20:37, 206.33s/it]
Task 12, Epoch 15/20 => Loss 0.361, Loss_clf 0.224, Loss_aux 0.137, Train_accy 93.79:  70%|███████   | 14/20 [55:54<20:37, 206.33s/it]
Task 12, Epoch 15/20 => Loss 0.361, Loss_clf 0.224, Loss_aux 0.137, Train_accy 93.79:  75%|███████▌  | 15/20 [55:54<16:29, 197.84s/it]
Task 12, Epoch 16/20 => Loss 0.369, Loss_clf 0.237, Loss_aux 0.132, Train_accy 93.17, Test_accy 84.62:  75%|███████▌  | 15/20 [1:02:39<16:29, 197.84s/it]
Task 12, Epoch 16/20 => Loss 0.369, Loss_clf 0.237, Loss_aux 0.132, Train_accy 93.17, Test_accy 84.62:  80%|████████  | 16/20 [1:02:39<17:21, 260.34s/it]
Task 12, Epoch 17/20 => Loss 0.356, Loss_clf 0.226, Loss_aux 0.131, Train_accy 93.39:  80%|████████  | 16/20 [1:05:38<17:21, 260.34s/it]                 
Task 12, Epoch 17/20 => Loss 0.356, Loss_clf 0.226, Loss_aux 0.131, Train_accy 93.39:  85%|████████▌ | 17/20 [1:05:38<11:46, 235.62s/it]
Task 12, Epoch 18/20 => Loss 0.324, Loss_clf 0.212, Loss_aux 0.113, Train_accy 94.11:  85%|████████▌ | 17/20 [1:08:36<11:46, 235.62s/it]
Task 12, Epoch 18/20 => Loss 0.324, Loss_clf 0.212, Loss_aux 0.113, Train_accy 94.11:  90%|█████████ | 18/20 [1:08:36<07:16, 218.37s/it]
Task 12, Epoch 19/20 => Loss 0.318, Loss_clf 0.201, Loss_aux 0.117, Train_accy 94.29:  90%|█████████ | 18/20 [1:11:34<07:16, 218.37s/it]
Task 12, Epoch 19/20 => Loss 0.318, Loss_clf 0.201, Loss_aux 0.117, Train_accy 94.29:  95%|█████████▌| 19/20 [1:11:34<03:26, 206.34s/it]
Task 12, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.86:  95%|█████████▌| 19/20 [1:14:32<03:26, 206.34s/it]
Task 12, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.86: 100%|██████████| 20/20 [1:14:32<00:00, 197.92s/it]
Task 12, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.86: 100%|██████████| 20/20 [1:14:32<00:00, 223.65s/it]
2024-09-05 07:56:04,518 [der.py] => Task 12, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.86
2024-09-05 07:56:04,520 [base.py] => Reducing exemplars...(30 per classes)
2024-09-05 07:57:34,524 [base.py] => Constructing exemplars...(30 per classes)
2024-09-05 08:06:51,027 [der.py] => Exemplar size: 1950
2024-09-05 08:06:51,027 [trainer.py] => CNN: {'total': 86.26, '00-04': 88.0, '05-09': 79.6, '10-14': 77.2, '15-19': 80.8, '20-24': 94.4, '25-29': 86.0, '30-34': 88.4, '35-39': 82.8, '40-44': 90.4, '45-49': 82.6, '50-54': 97.8, '55-59': 75.0, '60-64': 98.4, 'old': 85.25, 'new': 98.4}
2024-09-05 08:06:51,027 [trainer.py] => NME: {'total': 89.23, '00-04': 93.6, '05-09': 85.2, '10-14': 82.6, '15-19': 86.8, '20-24': 97.2, '25-29': 91.0, '30-34': 90.0, '35-39': 87.6, '40-44': 90.8, '45-49': 92.4, '50-54': 91.8, '55-59': 79.4, '60-64': 91.6, 'old': 89.03, 'new': 91.6}
2024-09-05 08:06:51,028 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26]
2024-09-05 08:06:51,028 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63]
2024-09-05 08:06:51,028 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23]
2024-09-05 08:06:51,028 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78]

Average Accuracy (CNN): 92.84
Average Accuracy (NME): 94.0
2024-09-05 08:06:51,028 [trainer.py] => Average Accuracy (CNN): 92.84
2024-09-05 08:06:51,028 [trainer.py] => Average Accuracy (NME): 94.0
2024-09-05 08:06:51,035 [trainer.py] => All params: 1116036167
2024-09-05 08:06:51,041 [trainer.py] => Trainable params: 86452295
2024-09-05 08:06:52,602 [der.py] => Learning on 65-70
2024-09-05 08:06:52,617 [der.py] => All params: 1201938508
2024-09-05 08:06:52,623 [der.py] => Trainable params: 86555980

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.220, Loss_clf 0.865, Loss_aux 0.355, Train_accy 86.40, Test_accy 83.31:   0%|          | 0/20 [07:32<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.220, Loss_clf 0.865, Loss_aux 0.355, Train_accy 86.40, Test_accy 83.31:   5%|▌         | 1/20 [07:32<2:23:08, 452.02s/it]
Task 13, Epoch 2/20 => Loss 0.502, Loss_clf 0.305, Loss_aux 0.197, Train_accy 91.66:   5%|▌         | 1/20 [10:40<2:23:08, 452.02s/it]                 
Task 13, Epoch 2/20 => Loss 0.502, Loss_clf 0.305, Loss_aux 0.197, Train_accy 91.66:  10%|█         | 2/20 [10:40<1:29:10, 297.27s/it]
Task 13, Epoch 3/20 => Loss 0.422, Loss_clf 0.263, Loss_aux 0.159, Train_accy 92.90:  10%|█         | 2/20 [13:49<1:29:10, 297.27s/it]
Task 13, Epoch 3/20 => Loss 0.422, Loss_clf 0.263, Loss_aux 0.159, Train_accy 92.90:  15%|█▌        | 3/20 [13:49<1:10:12, 247.79s/it]
Task 13, Epoch 4/20 => Loss 0.388, Loss_clf 0.243, Loss_aux 0.145, Train_accy 93.42:  15%|█▌        | 3/20 [16:58<1:10:12, 247.79s/it]
Task 13, Epoch 4/20 => Loss 0.388, Loss_clf 0.243, Loss_aux 0.145, Train_accy 93.42:  20%|██        | 4/20 [16:58<59:53, 224.57s/it]  
Task 13, Epoch 5/20 => Loss 0.413, Loss_clf 0.262, Loss_aux 0.151, Train_accy 92.85:  20%|██        | 4/20 [20:07<59:53, 224.57s/it]
Task 13, Epoch 5/20 => Loss 0.413, Loss_clf 0.262, Loss_aux 0.151, Train_accy 92.85:  25%|██▌       | 5/20 [20:07<52:55, 211.72s/it]
Task 13, Epoch 6/20 => Loss 0.371, Loss_clf 0.235, Loss_aux 0.136, Train_accy 93.64, Test_accy 85.20:  25%|██▌       | 5/20 [27:40<52:55, 211.72s/it]
Task 13, Epoch 6/20 => Loss 0.371, Loss_clf 0.235, Loss_aux 0.136, Train_accy 93.64, Test_accy 85.20:  30%|███       | 6/20 [27:40<1:08:29, 293.51s/it]
Task 13, Epoch 7/20 => Loss 0.369, Loss_clf 0.241, Loss_aux 0.128, Train_accy 93.57:  30%|███       | 6/20 [30:48<1:08:29, 293.51s/it]                 
Task 13, Epoch 7/20 => Loss 0.369, Loss_clf 0.241, Loss_aux 0.128, Train_accy 93.57:  35%|███▌      | 7/20 [30:48<56:10, 259.29s/it]  
Task 13, Epoch 8/20 => Loss 0.376, Loss_clf 0.243, Loss_aux 0.133, Train_accy 93.19:  35%|███▌      | 7/20 [33:57<56:10, 259.29s/it]
Task 13, Epoch 8/20 => Loss 0.376, Loss_clf 0.243, Loss_aux 0.133, Train_accy 93.19:  40%|████      | 8/20 [33:57<47:22, 236.88s/it]
Task 13, Epoch 9/20 => Loss 0.341, Loss_clf 0.227, Loss_aux 0.114, Train_accy 93.91:  40%|████      | 8/20 [37:06<47:22, 236.88s/it]
Task 13, Epoch 9/20 => Loss 0.341, Loss_clf 0.227, Loss_aux 0.114, Train_accy 93.91:  45%|████▌     | 9/20 [37:06<40:40, 221.89s/it]
Task 13, Epoch 10/20 => Loss 0.344, Loss_clf 0.224, Loss_aux 0.120, Train_accy 93.84:  45%|████▌     | 9/20 [40:15<40:40, 221.89s/it]
Task 13, Epoch 10/20 => Loss 0.344, Loss_clf 0.224, Loss_aux 0.120, Train_accy 93.84:  50%|█████     | 10/20 [40:15<35:17, 211.71s/it]
Task 13, Epoch 11/20 => Loss 0.337, Loss_clf 0.228, Loss_aux 0.108, Train_accy 93.93, Test_accy 85.09:  50%|█████     | 10/20 [47:47<35:17, 211.71s/it]
Task 13, Epoch 11/20 => Loss 0.337, Loss_clf 0.228, Loss_aux 0.108, Train_accy 93.93, Test_accy 85.09:  55%|█████▌    | 11/20 [47:47<42:47, 285.32s/it]
Task 13, Epoch 12/20 => Loss 0.329, Loss_clf 0.206, Loss_aux 0.123, Train_accy 94.38:  55%|█████▌    | 11/20 [50:56<42:47, 285.32s/it]                 
Task 13, Epoch 12/20 => Loss 0.329, Loss_clf 0.206, Loss_aux 0.123, Train_accy 94.38:  60%|██████    | 12/20 [50:56<34:07, 255.98s/it]
Task 13, Epoch 13/20 => Loss 0.322, Loss_clf 0.215, Loss_aux 0.107, Train_accy 94.13:  60%|██████    | 12/20 [54:05<34:07, 255.98s/it]
Task 13, Epoch 13/20 => Loss 0.322, Loss_clf 0.215, Loss_aux 0.107, Train_accy 94.13:  65%|██████▌   | 13/20 [54:05<27:29, 235.66s/it]
Task 13, Epoch 14/20 => Loss 0.289, Loss_clf 0.185, Loss_aux 0.104, Train_accy 94.92:  65%|██████▌   | 13/20 [57:14<27:29, 235.66s/it]
Task 13, Epoch 14/20 => Loss 0.289, Loss_clf 0.185, Loss_aux 0.104, Train_accy 94.92:  70%|███████   | 14/20 [57:14<22:09, 221.57s/it]
Task 13, Epoch 15/20 => Loss 0.315, Loss_clf 0.201, Loss_aux 0.114, Train_accy 94.67:  70%|███████   | 14/20 [1:00:23<22:09, 221.57s/it]
Task 13, Epoch 15/20 => Loss 0.315, Loss_clf 0.201, Loss_aux 0.114, Train_accy 94.67:  75%|███████▌  | 15/20 [1:00:23<17:38, 211.73s/it]
Task 13, Epoch 16/20 => Loss 0.303, Loss_clf 0.201, Loss_aux 0.102, Train_accy 94.47, Test_accy 84.77:  75%|███████▌  | 15/20 [1:07:55<17:38, 211.73s/it]
Task 13, Epoch 16/20 => Loss 0.303, Loss_clf 0.201, Loss_aux 0.102, Train_accy 94.47, Test_accy 84.77:  80%|████████  | 16/20 [1:07:55<18:56, 284.09s/it]
Task 13, Epoch 17/20 => Loss 0.342, Loss_clf 0.233, Loss_aux 0.109, Train_accy 93.78:  80%|████████  | 16/20 [1:11:04<18:56, 284.09s/it]                 
Task 13, Epoch 17/20 => Loss 0.342, Loss_clf 0.233, Loss_aux 0.109, Train_accy 93.78:  85%|████████▌ | 17/20 [1:11:04<12:46, 255.46s/it]
Task 13, Epoch 18/20 => Loss 0.323, Loss_clf 0.212, Loss_aux 0.110, Train_accy 94.38:  85%|████████▌ | 17/20 [1:14:13<12:46, 255.46s/it]
Task 13, Epoch 18/20 => Loss 0.323, Loss_clf 0.212, Loss_aux 0.110, Train_accy 94.38:  90%|█████████ | 18/20 [1:14:13<07:50, 235.47s/it]
Task 13, Epoch 19/20 => Loss 0.311, Loss_clf 0.206, Loss_aux 0.105, Train_accy 94.70:  90%|█████████ | 18/20 [1:17:22<07:50, 235.47s/it]
Task 13, Epoch 19/20 => Loss 0.311, Loss_clf 0.206, Loss_aux 0.105, Train_accy 94.70:  95%|█████████▌| 19/20 [1:17:22<03:41, 221.47s/it]
Task 13, Epoch 20/20 => Loss 0.318, Loss_clf 0.206, Loss_aux 0.112, Train_accy 94.16:  95%|█████████▌| 19/20 [1:20:31<03:41, 221.47s/it]
Task 13, Epoch 20/20 => Loss 0.318, Loss_clf 0.206, Loss_aux 0.112, Train_accy 94.16: 100%|██████████| 20/20 [1:20:31<00:00, 211.72s/it]
Task 13, Epoch 20/20 => Loss 0.318, Loss_clf 0.206, Loss_aux 0.112, Train_accy 94.16: 100%|██████████| 20/20 [1:20:31<00:00, 241.57s/it]
2024-09-05 09:27:24,113 [der.py] => Task 13, Epoch 20/20 => Loss 0.318, Loss_clf 0.206, Loss_aux 0.112, Train_accy 94.16
2024-09-05 09:27:24,115 [base.py] => Reducing exemplars...(28 per classes)
2024-09-05 09:29:00,185 [base.py] => Constructing exemplars...(28 per classes)
2024-09-05 09:39:35,823 [der.py] => Exemplar size: 1960
2024-09-05 09:39:35,823 [trainer.py] => CNN: {'total': 85.71, '00-04': 82.4, '05-09': 76.2, '10-14': 73.6, '15-19': 76.4, '20-24': 92.2, '25-29': 84.6, '30-34': 89.0, '35-39': 85.4, '40-44': 88.6, '45-49': 89.8, '50-54': 95.8, '55-59': 77.8, '60-64': 89.0, '65-69': 99.2, 'old': 84.68, 'new': 99.2}
2024-09-05 09:39:35,823 [trainer.py] => NME: {'total': 89.06, '00-04': 91.8, '05-09': 84.4, '10-14': 81.2, '15-19': 86.4, '20-24': 96.8, '25-29': 90.8, '30-34': 89.6, '35-39': 87.2, '40-44': 90.6, '45-49': 92.8, '50-54': 91.4, '55-59': 79.0, '60-64': 90.2, '65-69': 94.6, 'old': 88.63, 'new': 94.6}
2024-09-05 09:39:35,823 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26, 85.71]
2024-09-05 09:39:35,823 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63, 97.26]
2024-09-05 09:39:35,823 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23, 89.06]
2024-09-05 09:39:35,823 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78, 98.66]

Average Accuracy (CNN): 92.33
Average Accuracy (NME): 93.64
2024-09-05 09:39:35,823 [trainer.py] => Average Accuracy (CNN): 92.33
2024-09-05 09:39:35,823 [trainer.py] => Average Accuracy (NME): 93.64
2024-09-05 09:39:35,831 [trainer.py] => All params: 1201938508
2024-09-05 09:39:35,837 [trainer.py] => Trainable params: 86555980
2024-09-05 09:39:37,372 [der.py] => Learning on 70-75
2024-09-05 09:39:37,386 [der.py] => All params: 1287848529
2024-09-05 09:39:37,392 [der.py] => Trainable params: 86667345

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.671, Loss_clf 1.148, Loss_aux 0.523, Train_accy 83.18, Test_accy 83.15:   0%|          | 0/20 [08:23<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.671, Loss_clf 1.148, Loss_aux 0.523, Train_accy 83.18, Test_accy 83.15:   5%|▌         | 1/20 [08:23<2:39:33, 503.85s/it]
Task 14, Epoch 2/20 => Loss 0.587, Loss_clf 0.361, Loss_aux 0.226, Train_accy 90.25:   5%|▌         | 1/20 [11:45<2:39:33, 503.85s/it]                 
Task 14, Epoch 2/20 => Loss 0.587, Loss_clf 0.361, Loss_aux 0.226, Train_accy 90.25:  10%|█         | 2/20 [11:45<1:37:46, 325.91s/it]
Task 14, Epoch 3/20 => Loss 0.510, Loss_clf 0.315, Loss_aux 0.195, Train_accy 91.46:  10%|█         | 2/20 [15:06<1:37:46, 325.91s/it]
Task 14, Epoch 3/20 => Loss 0.510, Loss_clf 0.315, Loss_aux 0.195, Train_accy 91.46:  15%|█▌        | 3/20 [15:06<1:16:12, 268.98s/it]
Task 14, Epoch 4/20 => Loss 0.465, Loss_clf 0.276, Loss_aux 0.189, Train_accy 92.13:  15%|█▌        | 3/20 [18:27<1:16:12, 268.98s/it]
Task 14, Epoch 4/20 => Loss 0.465, Loss_clf 0.276, Loss_aux 0.189, Train_accy 92.13:  20%|██        | 4/20 [18:27<1:04:35, 242.23s/it]
Task 14, Epoch 5/20 => Loss 0.439, Loss_clf 0.271, Loss_aux 0.168, Train_accy 92.13:  20%|██        | 4/20 [21:48<1:04:35, 242.23s/it]
Task 14, Epoch 5/20 => Loss 0.439, Loss_clf 0.271, Loss_aux 0.168, Train_accy 92.13:  25%|██▌       | 5/20 [21:48<56:51, 227.42s/it]  
Task 14, Epoch 6/20 => Loss 0.406, Loss_clf 0.253, Loss_aux 0.153, Train_accy 92.96, Test_accy 83.49:  25%|██▌       | 5/20 [30:12<56:51, 227.42s/it]
Task 14, Epoch 6/20 => Loss 0.406, Loss_clf 0.253, Loss_aux 0.153, Train_accy 92.96, Test_accy 83.49:  30%|███       | 6/20 [30:12<1:14:59, 321.36s/it]
Task 14, Epoch 7/20 => Loss 0.419, Loss_clf 0.261, Loss_aux 0.158, Train_accy 92.74:  30%|███       | 6/20 [33:33<1:14:59, 321.36s/it]                 
Task 14, Epoch 7/20 => Loss 0.419, Loss_clf 0.261, Loss_aux 0.158, Train_accy 92.74:  35%|███▌      | 7/20 [33:33<1:01:06, 282.07s/it]
Task 14, Epoch 8/20 => Loss 0.416, Loss_clf 0.260, Loss_aux 0.156, Train_accy 92.67:  35%|███▌      | 7/20 [36:54<1:01:06, 282.07s/it]
Task 14, Epoch 8/20 => Loss 0.416, Loss_clf 0.260, Loss_aux 0.156, Train_accy 92.67:  40%|████      | 8/20 [36:54<51:15, 256.31s/it]  
Task 14, Epoch 9/20 => Loss 0.365, Loss_clf 0.230, Loss_aux 0.135, Train_accy 93.81:  40%|████      | 8/20 [40:16<51:15, 256.31s/it]
Task 14, Epoch 9/20 => Loss 0.365, Loss_clf 0.230, Loss_aux 0.135, Train_accy 93.81:  45%|████▌     | 9/20 [40:16<43:50, 239.11s/it]
Task 14, Epoch 10/20 => Loss 0.389, Loss_clf 0.243, Loss_aux 0.146, Train_accy 93.57:  45%|████▌     | 9/20 [43:37<43:50, 239.11s/it]
Task 14, Epoch 10/20 => Loss 0.389, Loss_clf 0.243, Loss_aux 0.146, Train_accy 93.57:  50%|█████     | 10/20 [43:37<37:53, 227.38s/it]
Task 14, Epoch 11/20 => Loss 0.374, Loss_clf 0.244, Loss_aux 0.130, Train_accy 93.27, Test_accy 83.32:  50%|█████     | 10/20 [52:00<37:53, 227.38s/it]
Task 14, Epoch 11/20 => Loss 0.374, Loss_clf 0.244, Loss_aux 0.130, Train_accy 93.27, Test_accy 83.32:  55%|█████▌    | 11/20 [52:00<46:47, 311.93s/it]
Task 14, Epoch 12/20 => Loss 0.373, Loss_clf 0.242, Loss_aux 0.131, Train_accy 93.45:  55%|█████▌    | 11/20 [55:22<46:47, 311.93s/it]                 
Task 14, Epoch 12/20 => Loss 0.373, Loss_clf 0.242, Loss_aux 0.131, Train_accy 93.45:  60%|██████    | 12/20 [55:22<37:05, 278.23s/it]
Task 14, Epoch 13/20 => Loss 0.398, Loss_clf 0.248, Loss_aux 0.150, Train_accy 93.12:  60%|██████    | 12/20 [58:43<37:05, 278.23s/it]
Task 14, Epoch 13/20 => Loss 0.398, Loss_clf 0.248, Loss_aux 0.150, Train_accy 93.12:  65%|██████▌   | 13/20 [58:43<29:44, 254.88s/it]
Task 14, Epoch 14/20 => Loss 0.335, Loss_clf 0.213, Loss_aux 0.122, Train_accy 94.15:  65%|██████▌   | 13/20 [1:02:04<29:44, 254.88s/it]
Task 14, Epoch 14/20 => Loss 0.335, Loss_clf 0.213, Loss_aux 0.122, Train_accy 94.15:  70%|███████   | 14/20 [1:02:04<23:52, 238.67s/it]
Task 14, Epoch 15/20 => Loss 0.316, Loss_clf 0.199, Loss_aux 0.117, Train_accy 94.46:  70%|███████   | 14/20 [1:05:25<23:52, 238.67s/it]
Task 14, Epoch 15/20 => Loss 0.316, Loss_clf 0.199, Loss_aux 0.117, Train_accy 94.46:  75%|███████▌  | 15/20 [1:05:25<18:56, 227.38s/it]
Task 14, Epoch 16/20 => Loss 0.334, Loss_clf 0.215, Loss_aux 0.119, Train_accy 93.72, Test_accy 83.69:  75%|███████▌  | 15/20 [1:13:49<18:56, 227.38s/it]
Task 14, Epoch 16/20 => Loss 0.334, Loss_clf 0.215, Loss_aux 0.119, Train_accy 93.72, Test_accy 83.69:  80%|████████  | 16/20 [1:13:49<20:42, 310.51s/it]
Task 14, Epoch 17/20 => Loss 0.352, Loss_clf 0.225, Loss_aux 0.127, Train_accy 93.77:  80%|████████  | 16/20 [1:17:10<20:42, 310.51s/it]                 
Task 14, Epoch 17/20 => Loss 0.352, Loss_clf 0.225, Loss_aux 0.127, Train_accy 93.77:  85%|████████▌ | 17/20 [1:17:10<13:52, 277.65s/it]
Task 14, Epoch 18/20 => Loss 0.369, Loss_clf 0.234, Loss_aux 0.135, Train_accy 93.63:  85%|████████▌ | 17/20 [1:20:31<13:52, 277.65s/it]
Task 14, Epoch 18/20 => Loss 0.369, Loss_clf 0.234, Loss_aux 0.135, Train_accy 93.63:  90%|█████████ | 18/20 [1:20:31<08:29, 254.66s/it]
Task 14, Epoch 19/20 => Loss 0.371, Loss_clf 0.229, Loss_aux 0.142, Train_accy 93.77:  90%|█████████ | 18/20 [1:23:52<08:29, 254.66s/it]
Task 14, Epoch 19/20 => Loss 0.371, Loss_clf 0.229, Loss_aux 0.142, Train_accy 93.77:  95%|█████████▌| 19/20 [1:23:52<03:58, 238.61s/it]
Task 14, Epoch 20/20 => Loss 0.339, Loss_clf 0.214, Loss_aux 0.125, Train_accy 94.44:  95%|█████████▌| 19/20 [1:27:13<03:58, 238.61s/it]
Task 14, Epoch 20/20 => Loss 0.339, Loss_clf 0.214, Loss_aux 0.125, Train_accy 94.44: 100%|██████████| 20/20 [1:27:13<00:00, 227.37s/it]
Task 14, Epoch 20/20 => Loss 0.339, Loss_clf 0.214, Loss_aux 0.125, Train_accy 94.44: 100%|██████████| 20/20 [1:27:13<00:00, 261.70s/it]
2024-09-05 11:06:51,530 [der.py] => Task 14, Epoch 20/20 => Loss 0.339, Loss_clf 0.214, Loss_aux 0.125, Train_accy 94.44
2024-09-05 11:06:51,530 [base.py] => Reducing exemplars...(26 per classes)
2024-09-05 11:08:34,538 [base.py] => Constructing exemplars...(26 per classes)
2024-09-05 11:20:34,299 [der.py] => Exemplar size: 1950
2024-09-05 11:20:34,299 [trainer.py] => CNN: {'total': 83.12, '00-04': 77.2, '05-09': 76.0, '10-14': 75.8, '15-19': 76.4, '20-24': 92.2, '25-29': 85.8, '30-34': 85.0, '35-39': 77.8, '40-44': 85.8, '45-49': 88.0, '50-54': 94.4, '55-59': 65.2, '60-64': 72.8, '65-69': 95.4, '70-74': 99.0, 'old': 81.99, 'new': 99.0}
2024-09-05 11:20:34,299 [trainer.py] => NME: {'total': 87.51, '00-04': 90.2, '05-09': 83.8, '10-14': 79.2, '15-19': 85.4, '20-24': 95.6, '25-29': 90.2, '30-34': 90.2, '35-39': 84.8, '40-44': 89.0, '45-49': 92.2, '50-54': 91.6, '55-59': 76.2, '60-64': 78.6, '65-69': 95.0, '70-74': 90.6, 'old': 87.29, 'new': 90.6}
2024-09-05 11:20:34,299 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26, 85.71, 83.12]
2024-09-05 11:20:34,299 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63, 97.26, 96.47]
2024-09-05 11:20:34,299 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23, 89.06, 87.51]
2024-09-05 11:20:34,299 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78, 98.66, 98.39]

Average Accuracy (CNN): 91.71
Average Accuracy (NME): 93.23
2024-09-05 11:20:34,299 [trainer.py] => Average Accuracy (CNN): 91.71
2024-09-05 11:20:34,299 [trainer.py] => Average Accuracy (NME): 93.23
2024-09-05 11:20:34,307 [trainer.py] => All params: 1287848529
2024-09-05 11:20:34,314 [trainer.py] => Trainable params: 86667345
2024-09-05 11:20:35,705 [der.py] => Learning on 75-80
2024-09-05 11:20:35,720 [der.py] => All params: 1373766230
2024-09-05 11:20:35,726 [der.py] => Trainable params: 86786390

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.549, Loss_clf 1.081, Loss_aux 0.468, Train_accy 83.80, Test_accy 81.84:   0%|          | 0/20 [09:16<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.549, Loss_clf 1.081, Loss_aux 0.468, Train_accy 83.80, Test_accy 81.84:   5%|▌         | 1/20 [09:16<2:56:04, 556.02s/it]
Task 15, Epoch 2/20 => Loss 0.582, Loss_clf 0.365, Loss_aux 0.216, Train_accy 90.52:   5%|▌         | 1/20 [12:48<2:56:04, 556.02s/it]                 
Task 15, Epoch 2/20 => Loss 0.582, Loss_clf 0.365, Loss_aux 0.216, Train_accy 90.52:  10%|█         | 2/20 [12:48<1:46:12, 354.02s/it]
Task 15, Epoch 3/20 => Loss 0.541, Loss_clf 0.338, Loss_aux 0.203, Train_accy 90.49:  10%|█         | 2/20 [16:21<1:46:12, 354.02s/it]
Task 15, Epoch 3/20 => Loss 0.541, Loss_clf 0.338, Loss_aux 0.203, Train_accy 90.49:  15%|█▌        | 3/20 [16:21<1:22:00, 289.44s/it]
Task 15, Epoch 4/20 => Loss 0.513, Loss_clf 0.318, Loss_aux 0.195, Train_accy 90.79:  15%|█▌        | 3/20 [19:53<1:22:00, 289.44s/it]
Task 15, Epoch 4/20 => Loss 0.513, Loss_clf 0.318, Loss_aux 0.195, Train_accy 90.79:  20%|██        | 4/20 [19:53<1:09:06, 259.13s/it]
Task 15, Epoch 5/20 => Loss 0.473, Loss_clf 0.296, Loss_aux 0.177, Train_accy 91.33:  20%|██        | 4/20 [23:26<1:09:06, 259.13s/it]
Task 15, Epoch 5/20 => Loss 0.473, Loss_clf 0.296, Loss_aux 0.177, Train_accy 91.33:  25%|██▌       | 5/20 [23:26<1:00:35, 242.35s/it]
Task 15, Epoch 6/20 => Loss 0.487, Loss_clf 0.310, Loss_aux 0.177, Train_accy 91.26, Test_accy 80.40:  25%|██▌       | 5/20 [32:42<1:00:35, 242.35s/it]
Task 15, Epoch 6/20 => Loss 0.487, Loss_clf 0.310, Loss_aux 0.177, Train_accy 91.26, Test_accy 80.40:  30%|███       | 6/20 [32:42<1:21:27, 349.14s/it]
Task 15, Epoch 7/20 => Loss 0.444, Loss_clf 0.279, Loss_aux 0.165, Train_accy 92.61:  30%|███       | 6/20 [36:15<1:21:27, 349.14s/it]                 
Task 15, Epoch 7/20 => Loss 0.444, Loss_clf 0.279, Loss_aux 0.165, Train_accy 92.61:  35%|███▌      | 7/20 [36:15<1:05:58, 304.53s/it]
Task 15, Epoch 8/20 => Loss 0.441, Loss_clf 0.280, Loss_aux 0.161, Train_accy 92.29:  35%|███▌      | 7/20 [39:48<1:05:58, 304.53s/it]
Task 15, Epoch 8/20 => Loss 0.441, Loss_clf 0.280, Loss_aux 0.161, Train_accy 92.29:  40%|████      | 8/20 [39:48<55:03, 275.26s/it]  
Task 15, Epoch 9/20 => Loss 0.446, Loss_clf 0.277, Loss_aux 0.169, Train_accy 92.16:  40%|████      | 8/20 [43:20<55:03, 275.26s/it]
Task 15, Epoch 9/20 => Loss 0.446, Loss_clf 0.277, Loss_aux 0.169, Train_accy 92.16:  45%|████▌     | 9/20 [43:20<46:52, 255.69s/it]
Task 15, Epoch 10/20 => Loss 0.412, Loss_clf 0.264, Loss_aux 0.148, Train_accy 92.63:  45%|████▌     | 9/20 [46:53<46:52, 255.69s/it]
Task 15, Epoch 10/20 => Loss 0.412, Loss_clf 0.264, Loss_aux 0.148, Train_accy 92.63:  50%|█████     | 10/20 [46:53<40:23, 242.38s/it]
Task 15, Epoch 11/20 => Loss 0.395, Loss_clf 0.249, Loss_aux 0.146, Train_accy 92.90, Test_accy 82.71:  50%|█████     | 10/20 [56:09<40:23, 242.38s/it]
Task 15, Epoch 11/20 => Loss 0.395, Loss_clf 0.249, Loss_aux 0.146, Train_accy 92.90, Test_accy 82.71:  55%|█████▌    | 11/20 [56:09<50:46, 338.50s/it]
Task 15, Epoch 12/20 => Loss 0.364, Loss_clf 0.226, Loss_aux 0.138, Train_accy 93.37:  55%|█████▌    | 11/20 [59:42<50:46, 338.50s/it]                 
Task 15, Epoch 12/20 => Loss 0.364, Loss_clf 0.226, Loss_aux 0.138, Train_accy 93.37:  60%|██████    | 12/20 [59:42<40:01, 300.21s/it]
Task 15, Epoch 13/20 => Loss 0.401, Loss_clf 0.249, Loss_aux 0.152, Train_accy 93.12:  60%|██████    | 12/20 [1:03:15<40:01, 300.21s/it]
Task 15, Epoch 13/20 => Loss 0.401, Loss_clf 0.249, Loss_aux 0.152, Train_accy 93.12:  65%|██████▌   | 13/20 [1:03:15<31:55, 273.70s/it]
Task 15, Epoch 14/20 => Loss 0.369, Loss_clf 0.227, Loss_aux 0.142, Train_accy 94.07:  65%|██████▌   | 13/20 [1:06:47<31:55, 273.70s/it]
Task 15, Epoch 14/20 => Loss 0.369, Loss_clf 0.227, Loss_aux 0.142, Train_accy 94.07:  70%|███████   | 14/20 [1:06:47<25:31, 255.27s/it]
Task 15, Epoch 15/20 => Loss 0.367, Loss_clf 0.232, Loss_aux 0.135, Train_accy 93.73:  70%|███████   | 14/20 [1:10:20<25:31, 255.27s/it]
Task 15, Epoch 15/20 => Loss 0.367, Loss_clf 0.232, Loss_aux 0.135, Train_accy 93.73:  75%|███████▌  | 15/20 [1:10:20<20:12, 242.43s/it]
Task 15, Epoch 16/20 => Loss 0.383, Loss_clf 0.244, Loss_aux 0.138, Train_accy 93.28, Test_accy 80.35:  75%|███████▌  | 15/20 [1:19:36<20:12, 242.43s/it]
Task 15, Epoch 16/20 => Loss 0.383, Loss_clf 0.244, Loss_aux 0.138, Train_accy 93.28, Test_accy 80.35:  80%|████████  | 16/20 [1:19:36<22:27, 336.91s/it]
Task 15, Epoch 17/20 => Loss 0.364, Loss_clf 0.231, Loss_aux 0.134, Train_accy 93.62:  80%|████████  | 16/20 [1:23:09<22:27, 336.91s/it]                 
Task 15, Epoch 17/20 => Loss 0.364, Loss_clf 0.231, Loss_aux 0.134, Train_accy 93.62:  85%|████████▌ | 17/20 [1:23:09<14:58, 299.53s/it]
Task 15, Epoch 18/20 => Loss 0.380, Loss_clf 0.241, Loss_aux 0.138, Train_accy 93.30:  85%|████████▌ | 17/20 [1:26:42<14:58, 299.53s/it]
Task 15, Epoch 18/20 => Loss 0.380, Loss_clf 0.241, Loss_aux 0.138, Train_accy 93.30:  90%|█████████ | 18/20 [1:26:42<09:06, 273.42s/it]
Task 15, Epoch 19/20 => Loss 0.343, Loss_clf 0.218, Loss_aux 0.125, Train_accy 94.18:  90%|█████████ | 18/20 [1:30:14<09:06, 273.42s/it]
Task 15, Epoch 19/20 => Loss 0.343, Loss_clf 0.218, Loss_aux 0.125, Train_accy 94.18:  95%|█████████▌| 19/20 [1:30:14<04:15, 255.17s/it]
Task 15, Epoch 20/20 => Loss 0.352, Loss_clf 0.224, Loss_aux 0.127, Train_accy 93.51:  95%|█████████▌| 19/20 [1:33:47<04:15, 255.17s/it]
Task 15, Epoch 20/20 => Loss 0.352, Loss_clf 0.224, Loss_aux 0.127, Train_accy 93.51: 100%|██████████| 20/20 [1:33:47<00:00, 242.43s/it]
Task 15, Epoch 20/20 => Loss 0.352, Loss_clf 0.224, Loss_aux 0.127, Train_accy 93.51: 100%|██████████| 20/20 [1:33:47<00:00, 281.38s/it]
2024-09-05 12:54:23,377 [der.py] => Task 15, Epoch 20/20 => Loss 0.352, Loss_clf 0.224, Loss_aux 0.127, Train_accy 93.51
2024-09-05 12:54:23,378 [base.py] => Reducing exemplars...(25 per classes)
2024-09-05 12:56:14,498 [base.py] => Constructing exemplars...(25 per classes)
2024-09-05 13:09:45,197 [der.py] => Exemplar size: 2000
2024-09-05 13:09:45,197 [trainer.py] => CNN: {'total': 80.92, '00-04': 79.6, '05-09': 74.2, '10-14': 74.2, '15-19': 81.4, '20-24': 93.0, '25-29': 83.6, '30-34': 84.8, '35-39': 76.8, '40-44': 85.2, '45-49': 68.8, '50-54': 65.0, '55-59': 65.2, '60-64': 79.6, '65-69': 95.4, '70-74': 90.0, '75-79': 98.0, 'old': 79.79, 'new': 98.0}
2024-09-05 13:09:45,197 [trainer.py] => NME: {'total': 85.88, '00-04': 89.2, '05-09': 81.4, '10-14': 78.6, '15-19': 85.0, '20-24': 95.8, '25-29': 90.2, '30-34': 89.4, '35-39': 83.4, '40-44': 88.6, '45-49': 86.2, '50-54': 80.6, '55-59': 75.8, '60-64': 77.8, '65-69': 95.8, '70-74': 87.8, '75-79': 88.4, 'old': 85.71, 'new': 88.4}
2024-09-05 13:09:45,198 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26, 85.71, 83.12, 80.92]
2024-09-05 13:09:45,198 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63, 97.26, 96.47, 96.49]
2024-09-05 13:09:45,198 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23, 89.06, 87.51, 85.88]
2024-09-05 13:09:45,198 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78, 98.66, 98.39, 98.19]

Average Accuracy (CNN): 91.04
Average Accuracy (NME): 92.77
2024-09-05 13:09:45,198 [trainer.py] => Average Accuracy (CNN): 91.04
2024-09-05 13:09:45,198 [trainer.py] => Average Accuracy (NME): 92.77
2024-09-05 13:09:45,206 [trainer.py] => All params: 1373766230
2024-09-05 13:09:45,214 [trainer.py] => Trainable params: 86786390
2024-09-05 13:09:46,573 [der.py] => Learning on 80-85
2024-09-05 13:09:46,588 [der.py] => All params: 1459691611
2024-09-05 13:09:46,595 [der.py] => Trainable params: 86913115

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.545, Loss_clf 1.120, Loss_aux 0.424, Train_accy 84.36, Test_accy 81.64:   0%|          | 0/20 [10:14<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.545, Loss_clf 1.120, Loss_aux 0.424, Train_accy 84.36, Test_accy 81.64:   5%|▌         | 1/20 [10:14<3:14:30, 614.24s/it]
Task 16, Epoch 2/20 => Loss 0.467, Loss_clf 0.296, Loss_aux 0.171, Train_accy 92.38:   5%|▌         | 1/20 [14:01<3:14:30, 614.24s/it]                 
Task 16, Epoch 2/20 => Loss 0.467, Loss_clf 0.296, Loss_aux 0.171, Train_accy 92.38:  10%|█         | 2/20 [14:01<1:55:55, 386.42s/it]
Task 16, Epoch 3/20 => Loss 0.433, Loss_clf 0.281, Loss_aux 0.152, Train_accy 92.44:  10%|█         | 2/20 [17:48<1:55:55, 386.42s/it]
Task 16, Epoch 3/20 => Loss 0.433, Loss_clf 0.281, Loss_aux 0.152, Train_accy 92.44:  15%|█▌        | 3/20 [17:48<1:28:51, 313.59s/it]
Task 16, Epoch 4/20 => Loss 0.422, Loss_clf 0.280, Loss_aux 0.142, Train_accy 92.42:  15%|█▌        | 3/20 [21:35<1:28:51, 313.59s/it]
Task 16, Epoch 4/20 => Loss 0.422, Loss_clf 0.280, Loss_aux 0.142, Train_accy 92.42:  20%|██        | 4/20 [21:35<1:14:29, 279.36s/it]
Task 16, Epoch 5/20 => Loss 0.377, Loss_clf 0.246, Loss_aux 0.131, Train_accy 92.82:  20%|██        | 4/20 [25:21<1:14:29, 279.36s/it]
Task 16, Epoch 5/20 => Loss 0.377, Loss_clf 0.246, Loss_aux 0.131, Train_accy 92.82:  25%|██▌       | 5/20 [25:21<1:05:06, 260.43s/it]
Task 16, Epoch 6/20 => Loss 0.332, Loss_clf 0.218, Loss_aux 0.113, Train_accy 93.96, Test_accy 80.99:  25%|██▌       | 5/20 [35:36<1:05:06, 260.43s/it]
Task 16, Epoch 6/20 => Loss 0.332, Loss_clf 0.218, Loss_aux 0.113, Train_accy 93.96, Test_accy 80.99:  30%|███       | 6/20 [35:36<1:28:51, 380.82s/it]
Task 16, Epoch 7/20 => Loss 0.361, Loss_clf 0.240, Loss_aux 0.121, Train_accy 93.51:  30%|███       | 6/20 [39:23<1:28:51, 380.82s/it]                 
Task 16, Epoch 7/20 => Loss 0.361, Loss_clf 0.240, Loss_aux 0.121, Train_accy 93.51:  35%|███▌      | 7/20 [39:23<1:11:36, 330.47s/it]
Task 16, Epoch 8/20 => Loss 0.372, Loss_clf 0.240, Loss_aux 0.132, Train_accy 93.18:  35%|███▌      | 7/20 [43:10<1:11:36, 330.47s/it]
Task 16, Epoch 8/20 => Loss 0.372, Loss_clf 0.240, Loss_aux 0.132, Train_accy 93.18:  40%|████      | 8/20 [43:10<59:29, 297.49s/it]  
Task 16, Epoch 9/20 => Loss 0.330, Loss_clf 0.216, Loss_aux 0.113, Train_accy 94.02:  40%|████      | 8/20 [46:56<59:29, 297.49s/it]
Task 16, Epoch 9/20 => Loss 0.330, Loss_clf 0.216, Loss_aux 0.113, Train_accy 94.02:  45%|████▌     | 9/20 [46:56<50:29, 275.41s/it]
Task 16, Epoch 10/20 => Loss 0.349, Loss_clf 0.233, Loss_aux 0.116, Train_accy 93.53:  45%|████▌     | 9/20 [50:43<50:29, 275.41s/it]
Task 16, Epoch 10/20 => Loss 0.349, Loss_clf 0.233, Loss_aux 0.116, Train_accy 93.53:  50%|█████     | 10/20 [50:43<43:24, 260.46s/it]
Task 16, Epoch 11/20 => Loss 0.338, Loss_clf 0.217, Loss_aux 0.122, Train_accy 94.20, Test_accy 80.64:  50%|█████     | 10/20 [1:00:58<43:24, 260.46s/it]
Task 16, Epoch 11/20 => Loss 0.338, Loss_clf 0.217, Loss_aux 0.122, Train_accy 94.20, Test_accy 80.64:  55%|█████▌    | 11/20 [1:00:58<55:19, 368.84s/it]
Task 16, Epoch 12/20 => Loss 0.326, Loss_clf 0.214, Loss_aux 0.113, Train_accy 94.33:  55%|█████▌    | 11/20 [1:04:45<55:19, 368.84s/it]                 
Task 16, Epoch 12/20 => Loss 0.326, Loss_clf 0.214, Loss_aux 0.113, Train_accy 94.33:  60%|██████    | 12/20 [1:04:45<43:25, 325.65s/it]
Task 16, Epoch 13/20 => Loss 0.318, Loss_clf 0.217, Loss_aux 0.101, Train_accy 94.09:  60%|██████    | 12/20 [1:08:32<43:25, 325.65s/it]
Task 16, Epoch 13/20 => Loss 0.318, Loss_clf 0.217, Loss_aux 0.101, Train_accy 94.09:  65%|██████▌   | 13/20 [1:08:32<34:30, 295.76s/it]
Task 16, Epoch 14/20 => Loss 0.302, Loss_clf 0.198, Loss_aux 0.104, Train_accy 94.84:  65%|██████▌   | 13/20 [1:12:19<34:30, 295.76s/it]
Task 16, Epoch 14/20 => Loss 0.302, Loss_clf 0.198, Loss_aux 0.104, Train_accy 94.84:  70%|███████   | 14/20 [1:12:19<27:29, 274.96s/it]
Task 16, Epoch 15/20 => Loss 0.313, Loss_clf 0.197, Loss_aux 0.116, Train_accy 94.76:  70%|███████   | 14/20 [1:16:06<27:29, 274.96s/it]
Task 16, Epoch 15/20 => Loss 0.313, Loss_clf 0.197, Loss_aux 0.116, Train_accy 94.76:  75%|███████▌  | 15/20 [1:16:06<21:42, 260.54s/it]
Task 16, Epoch 16/20 => Loss 0.337, Loss_clf 0.224, Loss_aux 0.114, Train_accy 93.87, Test_accy 80.76:  75%|███████▌  | 15/20 [1:26:21<21:42, 260.54s/it]
Task 16, Epoch 16/20 => Loss 0.337, Loss_clf 0.224, Loss_aux 0.114, Train_accy 93.87, Test_accy 80.76:  80%|████████  | 16/20 [1:26:21<24:28, 367.17s/it]
Task 16, Epoch 17/20 => Loss 0.312, Loss_clf 0.207, Loss_aux 0.105, Train_accy 94.18:  80%|████████  | 16/20 [1:30:08<24:28, 367.17s/it]                 
Task 16, Epoch 17/20 => Loss 0.312, Loss_clf 0.207, Loss_aux 0.105, Train_accy 94.18:  85%|████████▌ | 17/20 [1:30:08<16:15, 325.03s/it]
Task 16, Epoch 18/20 => Loss 0.326, Loss_clf 0.214, Loss_aux 0.112, Train_accy 94.31:  85%|████████▌ | 17/20 [1:33:55<16:15, 325.03s/it]
Task 16, Epoch 18/20 => Loss 0.326, Loss_clf 0.214, Loss_aux 0.112, Train_accy 94.31:  90%|█████████ | 18/20 [1:33:55<09:51, 295.59s/it]
Task 16, Epoch 19/20 => Loss 0.277, Loss_clf 0.183, Loss_aux 0.094, Train_accy 94.96:  90%|█████████ | 18/20 [1:37:42<09:51, 295.59s/it]
Task 16, Epoch 19/20 => Loss 0.277, Loss_clf 0.183, Loss_aux 0.094, Train_accy 94.96:  95%|█████████▌| 19/20 [1:37:42<04:34, 274.97s/it]
Task 16, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.51:  95%|█████████▌| 19/20 [1:41:29<04:34, 274.97s/it]
Task 16, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.51: 100%|██████████| 20/20 [1:41:29<00:00, 260.54s/it]
Task 16, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.51: 100%|██████████| 20/20 [1:41:29<00:00, 304.45s/it]
2024-09-05 14:51:15,801 [der.py] => Task 16, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.51
2024-09-05 14:51:15,802 [base.py] => Reducing exemplars...(23 per classes)
2024-09-05 14:53:19,033 [base.py] => Constructing exemplars...(23 per classes)
2024-09-05 15:08:26,565 [der.py] => Exemplar size: 1955
2024-09-05 15:08:26,566 [trainer.py] => CNN: {'total': 79.79, '00-04': 83.8, '05-09': 69.6, '10-14': 64.6, '15-19': 77.2, '20-24': 84.0, '25-29': 79.0, '30-34': 83.0, '35-39': 76.2, '40-44': 82.0, '45-49': 63.6, '50-54': 76.4, '55-59': 69.0, '60-64': 71.0, '65-69': 94.2, '70-74': 88.6, '75-79': 95.6, '80-84': 98.6, 'old': 78.61, 'new': 98.6}
2024-09-05 15:08:26,566 [trainer.py] => NME: {'total': 84.59, '00-04': 88.4, '05-09': 79.0, '10-14': 75.2, '15-19': 83.8, '20-24': 95.0, '25-29': 87.0, '30-34': 88.2, '35-39': 82.4, '40-44': 86.8, '45-49': 78.6, '50-54': 78.6, '55-59': 74.2, '60-64': 75.6, '65-69': 96.0, '70-74': 87.8, '75-79': 90.8, '80-84': 90.6, 'old': 84.21, 'new': 90.6}
2024-09-05 15:08:26,566 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26, 85.71, 83.12, 80.92, 79.79]
2024-09-05 15:08:26,566 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63, 97.26, 96.47, 96.49, 96.06]
2024-09-05 15:08:26,566 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23, 89.06, 87.51, 85.88, 84.59]
2024-09-05 15:08:26,566 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78, 98.66, 98.39, 98.19, 98.15]

Average Accuracy (CNN): 90.38
Average Accuracy (NME): 92.29
2024-09-05 15:08:26,566 [trainer.py] => Average Accuracy (CNN): 90.38
2024-09-05 15:08:26,566 [trainer.py] => Average Accuracy (NME): 92.29
2024-09-05 15:08:26,575 [trainer.py] => All params: 1459691611
2024-09-05 15:08:26,583 [trainer.py] => Trainable params: 86913115
2024-09-05 15:08:28,139 [der.py] => Learning on 85-90
2024-09-05 15:08:28,156 [der.py] => All params: 1545624672
2024-09-05 15:08:28,164 [der.py] => Trainable params: 87047520

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.582, Loss_clf 1.033, Loss_aux 0.549, Train_accy 82.81, Test_accy 78.27:   0%|          | 0/20 [11:10<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.582, Loss_clf 1.033, Loss_aux 0.549, Train_accy 82.81, Test_accy 78.27:   5%|▌         | 1/20 [11:10<3:32:16, 670.36s/it]
Task 17, Epoch 2/20 => Loss 0.670, Loss_clf 0.402, Loss_aux 0.268, Train_accy 88.87:   5%|▌         | 1/20 [15:06<3:32:16, 670.36s/it]                 
Task 17, Epoch 2/20 => Loss 0.670, Loss_clf 0.402, Loss_aux 0.268, Train_accy 88.87:  10%|█         | 2/20 [15:06<2:04:33, 415.17s/it]
Task 17, Epoch 3/20 => Loss 0.581, Loss_clf 0.343, Loss_aux 0.238, Train_accy 89.74:  10%|█         | 2/20 [19:03<2:04:33, 415.17s/it]
Task 17, Epoch 3/20 => Loss 0.581, Loss_clf 0.343, Loss_aux 0.238, Train_accy 89.74:  15%|█▌        | 3/20 [19:03<1:34:31, 333.63s/it]
Task 17, Epoch 4/20 => Loss 0.552, Loss_clf 0.330, Loss_aux 0.222, Train_accy 90.15:  15%|█▌        | 3/20 [23:00<1:34:31, 333.63s/it]
Task 17, Epoch 4/20 => Loss 0.552, Loss_clf 0.330, Loss_aux 0.222, Train_accy 90.15:  20%|██        | 4/20 [23:00<1:18:45, 295.35s/it]
Task 17, Epoch 5/20 => Loss 0.538, Loss_clf 0.317, Loss_aux 0.220, Train_accy 90.66:  20%|██        | 4/20 [26:56<1:18:45, 295.35s/it]
Task 17, Epoch 5/20 => Loss 0.538, Loss_clf 0.317, Loss_aux 0.220, Train_accy 90.66:  25%|██▌       | 5/20 [26:56<1:08:32, 274.15s/it]
Task 17, Epoch 6/20 => Loss 0.496, Loss_clf 0.302, Loss_aux 0.194, Train_accy 91.52, Test_accy 79.44:  25%|██▌       | 5/20 [38:07<1:08:32, 274.15s/it]
Task 17, Epoch 6/20 => Loss 0.496, Loss_clf 0.302, Loss_aux 0.194, Train_accy 91.52, Test_accy 79.44:  30%|███       | 6/20 [38:07<1:35:27, 409.09s/it]
Task 17, Epoch 7/20 => Loss 0.467, Loss_clf 0.283, Loss_aux 0.184, Train_accy 91.85:  30%|███       | 6/20 [42:04<1:35:27, 409.09s/it]                 
Task 17, Epoch 7/20 => Loss 0.467, Loss_clf 0.283, Loss_aux 0.184, Train_accy 91.85:  35%|███▌      | 7/20 [42:04<1:16:25, 352.75s/it]
Task 17, Epoch 8/20 => Loss 0.482, Loss_clf 0.290, Loss_aux 0.192, Train_accy 91.92:  35%|███▌      | 7/20 [46:01<1:16:25, 352.75s/it]
Task 17, Epoch 8/20 => Loss 0.482, Loss_clf 0.290, Loss_aux 0.192, Train_accy 91.92:  40%|████      | 8/20 [46:01<1:03:09, 315.79s/it]
Task 17, Epoch 9/20 => Loss 0.441, Loss_clf 0.263, Loss_aux 0.179, Train_accy 92.35:  40%|████      | 8/20 [49:57<1:03:09, 315.79s/it]
Task 17, Epoch 9/20 => Loss 0.441, Loss_clf 0.263, Loss_aux 0.179, Train_accy 92.35:  45%|████▌     | 9/20 [49:57<53:21, 291.05s/it]  
Task 17, Epoch 10/20 => Loss 0.421, Loss_clf 0.252, Loss_aux 0.169, Train_accy 92.68:  45%|████▌     | 9/20 [53:54<53:21, 291.05s/it]
Task 17, Epoch 10/20 => Loss 0.421, Loss_clf 0.252, Loss_aux 0.169, Train_accy 92.68:  50%|█████     | 10/20 [53:54<45:42, 274.22s/it]
Task 17, Epoch 11/20 => Loss 0.449, Loss_clf 0.275, Loss_aux 0.174, Train_accy 92.14, Test_accy 77.31:  50%|█████     | 10/20 [1:05:04<45:42, 274.22s/it]
Task 17, Epoch 11/20 => Loss 0.449, Loss_clf 0.275, Loss_aux 0.174, Train_accy 92.14, Test_accy 77.31:  55%|█████▌    | 11/20 [1:05:04<59:19, 395.54s/it]
Task 17, Epoch 12/20 => Loss 0.488, Loss_clf 0.306, Loss_aux 0.182, Train_accy 91.69:  55%|█████▌    | 11/20 [1:09:01<59:19, 395.54s/it]                 
Task 17, Epoch 12/20 => Loss 0.488, Loss_clf 0.306, Loss_aux 0.182, Train_accy 91.69:  60%|██████    | 12/20 [1:09:01<46:17, 347.17s/it]
Task 17, Epoch 13/20 => Loss 0.471, Loss_clf 0.291, Loss_aux 0.180, Train_accy 92.03:  60%|██████    | 12/20 [1:12:58<46:17, 347.17s/it]
Task 17, Epoch 13/20 => Loss 0.471, Loss_clf 0.291, Loss_aux 0.180, Train_accy 92.03:  65%|██████▌   | 13/20 [1:12:58<36:35, 313.64s/it]
Task 17, Epoch 14/20 => Loss 0.452, Loss_clf 0.274, Loss_aux 0.178, Train_accy 92.39:  65%|██████▌   | 13/20 [1:16:54<36:35, 313.64s/it]
Task 17, Epoch 14/20 => Loss 0.452, Loss_clf 0.274, Loss_aux 0.178, Train_accy 92.39:  70%|███████   | 14/20 [1:16:54<29:02, 290.36s/it]
Task 17, Epoch 15/20 => Loss 0.430, Loss_clf 0.260, Loss_aux 0.170, Train_accy 92.97:  70%|███████   | 14/20 [1:20:51<29:02, 290.36s/it]
Task 17, Epoch 15/20 => Loss 0.430, Loss_clf 0.260, Loss_aux 0.170, Train_accy 92.97:  75%|███████▌  | 15/20 [1:20:51<22:50, 274.15s/it]
Task 17, Epoch 16/20 => Loss 0.406, Loss_clf 0.248, Loss_aux 0.159, Train_accy 92.93, Test_accy 79.08:  75%|███████▌  | 15/20 [1:32:02<22:50, 274.15s/it]
Task 17, Epoch 16/20 => Loss 0.406, Loss_clf 0.248, Loss_aux 0.159, Train_accy 92.93, Test_accy 79.08:  80%|████████  | 16/20 [1:32:02<26:14, 393.59s/it]
Task 17, Epoch 17/20 => Loss 0.388, Loss_clf 0.248, Loss_aux 0.141, Train_accy 92.91:  80%|████████  | 16/20 [1:35:58<26:14, 393.59s/it]                 
Task 17, Epoch 17/20 => Loss 0.388, Loss_clf 0.248, Loss_aux 0.141, Train_accy 92.91:  85%|████████▌ | 17/20 [1:35:58<17:19, 346.44s/it]
Task 17, Epoch 18/20 => Loss 0.374, Loss_clf 0.232, Loss_aux 0.142, Train_accy 93.47:  85%|████████▌ | 17/20 [1:39:55<17:19, 346.44s/it]
Task 17, Epoch 18/20 => Loss 0.374, Loss_clf 0.232, Loss_aux 0.142, Train_accy 93.47:  90%|█████████ | 18/20 [1:39:55<10:26, 313.43s/it]
Task 17, Epoch 19/20 => Loss 0.413, Loss_clf 0.249, Loss_aux 0.164, Train_accy 93.13:  90%|█████████ | 18/20 [1:43:52<10:26, 313.43s/it]
Task 17, Epoch 19/20 => Loss 0.413, Loss_clf 0.249, Loss_aux 0.164, Train_accy 93.13:  95%|█████████▌| 19/20 [1:43:52<04:50, 290.35s/it]
Task 17, Epoch 20/20 => Loss 0.397, Loss_clf 0.244, Loss_aux 0.153, Train_accy 93.42:  95%|█████████▌| 19/20 [1:47:48<04:50, 290.35s/it]
Task 17, Epoch 20/20 => Loss 0.397, Loss_clf 0.244, Loss_aux 0.153, Train_accy 93.42: 100%|██████████| 20/20 [1:47:48<00:00, 274.20s/it]
Task 17, Epoch 20/20 => Loss 0.397, Loss_clf 0.244, Loss_aux 0.153, Train_accy 93.42: 100%|██████████| 20/20 [1:47:48<00:00, 323.43s/it]
2024-09-05 16:56:16,970 [der.py] => Task 17, Epoch 20/20 => Loss 0.397, Loss_clf 0.244, Loss_aux 0.153, Train_accy 93.42
2024-09-05 16:56:16,972 [base.py] => Reducing exemplars...(22 per classes)
2024-09-05 16:58:31,285 [base.py] => Constructing exemplars...(22 per classes)
2024-09-05 17:15:20,088 [der.py] => Exemplar size: 1980
2024-09-05 17:15:20,089 [trainer.py] => CNN: {'total': 78.27, '00-04': 81.0, '05-09': 57.4, '10-14': 61.2, '15-19': 74.0, '20-24': 87.4, '25-29': 76.8, '30-34': 84.6, '35-39': 76.8, '40-44': 80.4, '45-49': 66.6, '50-54': 77.0, '55-59': 61.2, '60-64': 72.8, '65-69': 93.2, '70-74': 88.0, '75-79': 80.2, '80-84': 94.2, '85-89': 96.0, 'old': 77.22, 'new': 96.0}
2024-09-05 17:15:20,089 [trainer.py] => NME: {'total': 83.29, '00-04': 88.0, '05-09': 75.4, '10-14': 71.2, '15-19': 82.2, '20-24': 94.2, '25-29': 86.2, '30-34': 87.8, '35-39': 82.4, '40-44': 85.4, '45-49': 77.8, '50-54': 76.8, '55-59': 71.6, '60-64': 75.4, '65-69': 96.0, '70-74': 87.2, '75-79': 87.4, '80-84': 90.6, '85-89': 83.6, 'old': 83.27, 'new': 83.6}
2024-09-05 17:15:20,089 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26, 85.71, 83.12, 80.92, 79.79, 78.27]
2024-09-05 17:15:20,089 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63, 97.26, 96.47, 96.49, 96.06, 95.13]
2024-09-05 17:15:20,089 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23, 89.06, 87.51, 85.88, 84.59, 83.29]
2024-09-05 17:15:20,089 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78, 98.66, 98.39, 98.19, 98.15, 97.4]

Average Accuracy (CNN): 89.7
Average Accuracy (NME): 91.79
2024-09-05 17:15:20,089 [trainer.py] => Average Accuracy (CNN): 89.7
2024-09-05 17:15:20,089 [trainer.py] => Average Accuracy (NME): 91.79
2024-09-05 17:15:20,107 [trainer.py] => All params: 1545624672
2024-09-05 17:15:20,116 [trainer.py] => Trainable params: 87047520
2024-09-05 17:15:21,656 [der.py] => Learning on 90-95
2024-09-05 17:15:21,674 [der.py] => All params: 1631565413
2024-09-05 17:15:21,682 [der.py] => Trainable params: 87189605

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.451, Loss_clf 1.025, Loss_aux 0.425, Train_accy 84.75, Test_accy 78.53:   0%|          | 0/20 [12:13<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.451, Loss_clf 1.025, Loss_aux 0.425, Train_accy 84.75, Test_accy 78.53:   5%|▌         | 1/20 [12:13<3:52:11, 733.22s/it]
Task 18, Epoch 2/20 => Loss 0.484, Loss_clf 0.299, Loss_aux 0.185, Train_accy 91.92:   5%|▌         | 1/20 [16:23<3:52:11, 733.22s/it]                 
Task 18, Epoch 2/20 => Loss 0.484, Loss_clf 0.299, Loss_aux 0.185, Train_accy 91.92:  10%|█         | 2/20 [16:23<2:14:39, 448.88s/it]
Task 18, Epoch 3/20 => Loss 0.464, Loss_clf 0.283, Loss_aux 0.181, Train_accy 92.30:  10%|█         | 2/20 [20:33<2:14:39, 448.88s/it]
Task 18, Epoch 3/20 => Loss 0.464, Loss_clf 0.283, Loss_aux 0.181, Train_accy 92.30:  15%|█▌        | 3/20 [20:33<1:41:27, 358.08s/it]
Task 18, Epoch 4/20 => Loss 0.423, Loss_clf 0.276, Loss_aux 0.147, Train_accy 92.48:  15%|█▌        | 3/20 [24:42<1:41:27, 358.08s/it]
Task 18, Epoch 4/20 => Loss 0.423, Loss_clf 0.276, Loss_aux 0.147, Train_accy 92.48:  20%|██        | 4/20 [24:42<1:24:05, 315.33s/it]
Task 18, Epoch 5/20 => Loss 0.407, Loss_clf 0.258, Loss_aux 0.149, Train_accy 92.59:  20%|██        | 4/20 [28:52<1:24:05, 315.33s/it]
Task 18, Epoch 5/20 => Loss 0.407, Loss_clf 0.258, Loss_aux 0.149, Train_accy 92.59:  25%|██▌       | 5/20 [28:52<1:12:55, 291.71s/it]
Task 18, Epoch 6/20 => Loss 0.389, Loss_clf 0.248, Loss_aux 0.141, Train_accy 92.95, Test_accy 77.78:  25%|██▌       | 5/20 [41:06<1:12:55, 291.71s/it]
Task 18, Epoch 6/20 => Loss 0.389, Loss_clf 0.248, Loss_aux 0.141, Train_accy 92.95, Test_accy 77.78:  30%|███       | 6/20 [41:06<1:43:07, 441.93s/it]
Task 18, Epoch 7/20 => Loss 0.385, Loss_clf 0.247, Loss_aux 0.139, Train_accy 93.10:  30%|███       | 6/20 [45:16<1:43:07, 441.93s/it]                 
Task 18, Epoch 7/20 => Loss 0.385, Loss_clf 0.247, Loss_aux 0.139, Train_accy 93.10:  35%|███▌      | 7/20 [45:16<1:22:08, 379.12s/it]
Task 18, Epoch 8/20 => Loss 0.370, Loss_clf 0.231, Loss_aux 0.139, Train_accy 94.06:  35%|███▌      | 7/20 [49:25<1:22:08, 379.12s/it]
Task 18, Epoch 8/20 => Loss 0.370, Loss_clf 0.231, Loss_aux 0.139, Train_accy 94.06:  40%|████      | 8/20 [49:25<1:07:35, 337.95s/it]
Task 18, Epoch 9/20 => Loss 0.377, Loss_clf 0.248, Loss_aux 0.129, Train_accy 93.55:  40%|████      | 8/20 [53:35<1:07:35, 337.95s/it]
Task 18, Epoch 9/20 => Loss 0.377, Loss_clf 0.248, Loss_aux 0.129, Train_accy 93.55:  45%|████▌     | 9/20 [53:35<56:54, 310.38s/it]  
Task 18, Epoch 10/20 => Loss 0.355, Loss_clf 0.228, Loss_aux 0.127, Train_accy 93.62:  45%|████▌     | 9/20 [57:45<56:54, 310.38s/it]
Task 18, Epoch 10/20 => Loss 0.355, Loss_clf 0.228, Loss_aux 0.127, Train_accy 93.62:  50%|█████     | 10/20 [57:45<48:36, 291.68s/it]
Task 18, Epoch 11/20 => Loss 0.349, Loss_clf 0.226, Loss_aux 0.123, Train_accy 93.93, Test_accy 79.15:  50%|█████     | 10/20 [1:09:58<48:36, 291.68s/it]
Task 18, Epoch 11/20 => Loss 0.349, Loss_clf 0.226, Loss_aux 0.123, Train_accy 93.93, Test_accy 79.15:  55%|█████▌    | 11/20 [1:09:58<1:04:01, 426.85s/it]
Task 18, Epoch 12/20 => Loss 0.328, Loss_clf 0.213, Loss_aux 0.115, Train_accy 94.04:  55%|█████▌    | 11/20 [1:14:08<1:04:01, 426.85s/it]                 
Task 18, Epoch 12/20 => Loss 0.328, Loss_clf 0.213, Loss_aux 0.115, Train_accy 94.04:  60%|██████    | 12/20 [1:14:08<49:43, 372.97s/it]  
Task 18, Epoch 13/20 => Loss 0.326, Loss_clf 0.205, Loss_aux 0.121, Train_accy 94.31:  60%|██████    | 12/20 [1:18:18<49:43, 372.97s/it]
Task 18, Epoch 13/20 => Loss 0.326, Loss_clf 0.205, Loss_aux 0.121, Train_accy 94.31:  65%|██████▌   | 13/20 [1:18:18<39:09, 335.62s/it]
Task 18, Epoch 14/20 => Loss 0.302, Loss_clf 0.198, Loss_aux 0.103, Train_accy 94.46:  65%|██████▌   | 13/20 [1:22:27<39:09, 335.62s/it]
Task 18, Epoch 14/20 => Loss 0.302, Loss_clf 0.198, Loss_aux 0.103, Train_accy 94.46:  70%|███████   | 14/20 [1:22:27<30:58, 309.68s/it]
Task 18, Epoch 15/20 => Loss 0.339, Loss_clf 0.222, Loss_aux 0.117, Train_accy 93.68:  70%|███████   | 14/20 [1:26:37<30:58, 309.68s/it]
Task 18, Epoch 15/20 => Loss 0.339, Loss_clf 0.222, Loss_aux 0.117, Train_accy 93.68:  75%|███████▌  | 15/20 [1:26:37<24:17, 291.60s/it]
Task 18, Epoch 16/20 => Loss 0.348, Loss_clf 0.218, Loss_aux 0.131, Train_accy 94.13, Test_accy 77.58:  75%|███████▌  | 15/20 [1:38:50<24:17, 291.60s/it]
Task 18, Epoch 16/20 => Loss 0.348, Loss_clf 0.218, Loss_aux 0.131, Train_accy 94.13, Test_accy 77.58:  80%|████████  | 16/20 [1:38:50<28:18, 424.54s/it]
Task 18, Epoch 17/20 => Loss 0.339, Loss_clf 0.225, Loss_aux 0.114, Train_accy 93.75:  80%|████████  | 16/20 [1:43:00<28:18, 424.54s/it]                 
Task 18, Epoch 17/20 => Loss 0.339, Loss_clf 0.225, Loss_aux 0.114, Train_accy 93.75:  85%|████████▌ | 17/20 [1:43:00<18:35, 371.95s/it]
Task 18, Epoch 18/20 => Loss 0.313, Loss_clf 0.208, Loss_aux 0.105, Train_accy 94.31:  85%|████████▌ | 17/20 [1:47:10<18:35, 371.95s/it]
Task 18, Epoch 18/20 => Loss 0.313, Loss_clf 0.208, Loss_aux 0.105, Train_accy 94.31:  90%|█████████ | 18/20 [1:47:10<11:10, 335.21s/it]
Task 18, Epoch 19/20 => Loss 0.319, Loss_clf 0.203, Loss_aux 0.115, Train_accy 94.62:  90%|█████████ | 18/20 [1:51:19<11:10, 335.21s/it]
Task 18, Epoch 19/20 => Loss 0.319, Loss_clf 0.203, Loss_aux 0.115, Train_accy 94.62:  95%|█████████▌| 19/20 [1:51:19<05:09, 309.53s/it]
Task 18, Epoch 20/20 => Loss 0.336, Loss_clf 0.216, Loss_aux 0.119, Train_accy 93.97:  95%|█████████▌| 19/20 [1:55:29<05:09, 309.53s/it]
Task 18, Epoch 20/20 => Loss 0.336, Loss_clf 0.216, Loss_aux 0.119, Train_accy 93.97: 100%|██████████| 20/20 [1:55:29<00:00, 291.59s/it]
Task 18, Epoch 20/20 => Loss 0.336, Loss_clf 0.216, Loss_aux 0.119, Train_accy 93.97: 100%|██████████| 20/20 [1:55:29<00:00, 346.49s/it]
2024-09-05 19:10:51,535 [der.py] => Task 18, Epoch 20/20 => Loss 0.336, Loss_clf 0.216, Loss_aux 0.119, Train_accy 93.97
2024-09-05 19:10:51,535 [base.py] => Reducing exemplars...(21 per classes)
2024-09-05 19:13:09,075 [base.py] => Constructing exemplars...(21 per classes)
2024-09-05 19:31:42,475 [der.py] => Exemplar size: 1995
2024-09-05 19:31:42,476 [trainer.py] => CNN: {'total': 79.47, '00-04': 78.2, '05-09': 60.4, '10-14': 63.4, '15-19': 78.6, '20-24': 85.0, '25-29': 79.0, '30-34': 80.8, '35-39': 75.8, '40-44': 76.4, '45-49': 70.2, '50-54': 73.4, '55-59': 67.8, '60-64': 74.2, '65-69': 93.0, '70-74': 87.2, '75-79': 84.6, '80-84': 93.2, '85-89': 90.0, '90-94': 98.8, 'old': 78.4, 'new': 98.8}
2024-09-05 19:31:42,476 [trainer.py] => NME: {'total': 82.68, '00-04': 86.6, '05-09': 74.4, '10-14': 70.6, '15-19': 81.8, '20-24': 92.6, '25-29': 85.6, '30-34': 87.0, '35-39': 81.4, '40-44': 83.8, '45-49': 77.4, '50-54': 75.4, '55-59': 70.6, '60-64': 74.2, '65-69': 95.4, '70-74': 85.8, '75-79': 81.8, '80-84': 91.4, '85-89': 84.8, '90-94': 90.4, 'old': 82.26, 'new': 90.4}
2024-09-05 19:31:42,476 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26, 85.71, 83.12, 80.92, 79.79, 78.27, 79.47]
2024-09-05 19:31:42,476 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63, 97.26, 96.47, 96.49, 96.06, 95.13, 94.56]
2024-09-05 19:31:42,476 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23, 89.06, 87.51, 85.88, 84.59, 83.29, 82.68]
2024-09-05 19:31:42,476 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78, 98.66, 98.39, 98.19, 98.15, 97.4, 97.14]

Average Accuracy (CNN): 89.17
Average Accuracy (NME): 91.31
2024-09-05 19:31:42,476 [trainer.py] => Average Accuracy (CNN): 89.17
2024-09-05 19:31:42,476 [trainer.py] => Average Accuracy (NME): 91.31
2024-09-05 19:31:42,486 [trainer.py] => All params: 1631565413
2024-09-05 19:31:42,495 [trainer.py] => Trainable params: 87189605
2024-09-05 19:31:43,911 [der.py] => Learning on 95-100
2024-09-05 19:31:43,929 [der.py] => All params: 1717513834
2024-09-05 19:31:43,937 [der.py] => Trainable params: 87339370

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.611, Loss_clf 1.147, Loss_aux 0.464, Train_accy 83.03, Test_accy 75.66:   0%|          | 0/20 [13:17<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.611, Loss_clf 1.147, Loss_aux 0.464, Train_accy 83.03, Test_accy 75.66:   5%|▌         | 1/20 [13:17<4:12:35, 797.66s/it]
Task 19, Epoch 2/20 => Loss 0.641, Loss_clf 0.394, Loss_aux 0.247, Train_accy 89.05:   5%|▌         | 1/20 [17:40<4:12:35, 797.66s/it]                 
Task 19, Epoch 2/20 => Loss 0.641, Loss_clf 0.394, Loss_aux 0.247, Train_accy 89.05:  10%|█         | 2/20 [17:40<2:24:52, 482.90s/it]
Task 19, Epoch 3/20 => Loss 0.538, Loss_clf 0.349, Loss_aux 0.189, Train_accy 90.34:  10%|█         | 2/20 [22:02<2:24:52, 482.90s/it]
Task 19, Epoch 3/20 => Loss 0.538, Loss_clf 0.349, Loss_aux 0.189, Train_accy 90.34:  15%|█▌        | 3/20 [22:02<1:48:18, 382.29s/it]
Task 19, Epoch 4/20 => Loss 0.513, Loss_clf 0.321, Loss_aux 0.192, Train_accy 91.86:  15%|█▌        | 3/20 [26:25<1:48:18, 382.29s/it]
Task 19, Epoch 4/20 => Loss 0.513, Loss_clf 0.321, Loss_aux 0.192, Train_accy 91.86:  20%|██        | 4/20 [26:25<1:29:19, 334.99s/it]
Task 19, Epoch 5/20 => Loss 0.447, Loss_clf 0.275, Loss_aux 0.172, Train_accy 92.46:  20%|██        | 4/20 [30:47<1:29:19, 334.99s/it]
Task 19, Epoch 5/20 => Loss 0.447, Loss_clf 0.275, Loss_aux 0.172, Train_accy 92.46:  25%|██▌       | 5/20 [30:47<1:17:12, 308.85s/it]
Task 19, Epoch 6/20 => Loss 0.440, Loss_clf 0.270, Loss_aux 0.170, Train_accy 92.68, Test_accy 75.46:  25%|██▌       | 5/20 [44:05<1:17:12, 308.85s/it]
Task 19, Epoch 6/20 => Loss 0.440, Loss_clf 0.270, Loss_aux 0.170, Train_accy 92.68, Test_accy 75.46:  30%|███       | 6/20 [44:05<1:50:52, 475.19s/it]
Task 19, Epoch 7/20 => Loss 0.443, Loss_clf 0.266, Loss_aux 0.177, Train_accy 92.53:  30%|███       | 6/20 [48:28<1:50:52, 475.19s/it]                 
Task 19, Epoch 7/20 => Loss 0.443, Loss_clf 0.266, Loss_aux 0.177, Train_accy 92.53:  35%|███▌      | 7/20 [48:28<1:27:53, 405.66s/it]
Task 19, Epoch 8/20 => Loss 0.442, Loss_clf 0.280, Loss_aux 0.162, Train_accy 92.39:  35%|███▌      | 7/20 [52:50<1:27:53, 405.66s/it]
Task 19, Epoch 8/20 => Loss 0.442, Loss_clf 0.280, Loss_aux 0.162, Train_accy 92.39:  40%|████      | 8/20 [52:50<1:12:01, 360.11s/it]
Task 19, Epoch 9/20 => Loss 0.414, Loss_clf 0.258, Loss_aux 0.156, Train_accy 92.61:  40%|████      | 8/20 [57:13<1:12:01, 360.11s/it]
Task 19, Epoch 9/20 => Loss 0.414, Loss_clf 0.258, Loss_aux 0.156, Train_accy 92.61:  45%|████▌     | 9/20 [57:13<1:00:26, 329.67s/it]
Task 19, Epoch 10/20 => Loss 0.404, Loss_clf 0.255, Loss_aux 0.149, Train_accy 92.88:  45%|████▌     | 9/20 [1:01:36<1:00:26, 329.67s/it]
Task 19, Epoch 10/20 => Loss 0.404, Loss_clf 0.255, Loss_aux 0.149, Train_accy 92.88:  50%|█████     | 10/20 [1:01:36<51:30, 309.01s/it] 
Task 19, Epoch 11/20 => Loss 0.385, Loss_clf 0.245, Loss_aux 0.141, Train_accy 93.37, Test_accy 77.07:  50%|█████     | 10/20 [1:14:55<51:30, 309.01s/it]
Task 19, Epoch 11/20 => Loss 0.385, Loss_clf 0.245, Loss_aux 0.141, Train_accy 93.37, Test_accy 77.07:  55%|█████▌    | 11/20 [1:14:55<1:08:51, 459.09s/it]
Task 19, Epoch 12/20 => Loss 0.364, Loss_clf 0.220, Loss_aux 0.144, Train_accy 93.90:  55%|█████▌    | 11/20 [1:19:18<1:08:51, 459.09s/it]                 
Task 19, Epoch 12/20 => Loss 0.364, Loss_clf 0.220, Loss_aux 0.144, Train_accy 93.90:  60%|██████    | 12/20 [1:19:18<53:14, 399.33s/it]  
Task 19, Epoch 13/20 => Loss 0.416, Loss_clf 0.254, Loss_aux 0.162, Train_accy 92.77:  60%|██████    | 12/20 [1:23:41<53:14, 399.33s/it]
Task 19, Epoch 13/20 => Loss 0.416, Loss_clf 0.254, Loss_aux 0.162, Train_accy 92.77:  65%|██████▌   | 13/20 [1:23:41<41:46, 358.00s/it]
Task 19, Epoch 14/20 => Loss 0.359, Loss_clf 0.234, Loss_aux 0.125, Train_accy 93.39:  65%|██████▌   | 13/20 [1:28:04<41:46, 358.00s/it]
Task 19, Epoch 14/20 => Loss 0.359, Loss_clf 0.234, Loss_aux 0.125, Train_accy 93.39:  70%|███████   | 14/20 [1:28:04<32:55, 329.21s/it]
Task 19, Epoch 15/20 => Loss 0.356, Loss_clf 0.223, Loss_aux 0.133, Train_accy 93.77:  70%|███████   | 14/20 [1:32:26<32:55, 329.21s/it]
Task 19, Epoch 15/20 => Loss 0.356, Loss_clf 0.223, Loss_aux 0.133, Train_accy 93.77:  75%|███████▌  | 15/20 [1:32:26<25:45, 309.19s/it]
Task 19, Epoch 16/20 => Loss 0.394, Loss_clf 0.243, Loss_aux 0.150, Train_accy 93.50, Test_accy 76.10:  75%|███████▌  | 15/20 [1:45:45<25:45, 309.19s/it]
Task 19, Epoch 16/20 => Loss 0.394, Loss_clf 0.243, Loss_aux 0.150, Train_accy 93.50, Test_accy 76.10:  80%|████████  | 16/20 [1:45:45<30:26, 456.61s/it]
Task 19, Epoch 17/20 => Loss 0.360, Loss_clf 0.223, Loss_aux 0.136, Train_accy 93.88:  80%|████████  | 16/20 [1:50:08<30:26, 456.61s/it]                 
Task 19, Epoch 17/20 => Loss 0.360, Loss_clf 0.223, Loss_aux 0.136, Train_accy 93.88:  85%|████████▌ | 17/20 [1:50:08<19:54, 398.30s/it]
Task 19, Epoch 18/20 => Loss 0.331, Loss_clf 0.201, Loss_aux 0.130, Train_accy 94.33:  85%|████████▌ | 17/20 [1:54:31<19:54, 398.30s/it]
Task 19, Epoch 18/20 => Loss 0.331, Loss_clf 0.201, Loss_aux 0.130, Train_accy 94.33:  90%|█████████ | 18/20 [1:54:31<11:55, 357.52s/it]
Task 19, Epoch 19/20 => Loss 0.328, Loss_clf 0.198, Loss_aux 0.129, Train_accy 94.46:  90%|█████████ | 18/20 [1:58:53<11:55, 357.52s/it]
Task 19, Epoch 19/20 => Loss 0.328, Loss_clf 0.198, Loss_aux 0.129, Train_accy 94.46:  95%|█████████▌| 19/20 [1:58:53<05:28, 328.99s/it]
Task 19, Epoch 20/20 => Loss 0.354, Loss_clf 0.216, Loss_aux 0.138, Train_accy 93.77:  95%|█████████▌| 19/20 [2:03:16<05:28, 328.99s/it]
Task 19, Epoch 20/20 => Loss 0.354, Loss_clf 0.216, Loss_aux 0.138, Train_accy 93.77: 100%|██████████| 20/20 [2:03:16<00:00, 309.06s/it]
Task 19, Epoch 20/20 => Loss 0.354, Loss_clf 0.216, Loss_aux 0.138, Train_accy 93.77: 100%|██████████| 20/20 [2:03:16<00:00, 369.81s/it]
2024-09-05 21:35:00,303 [der.py] => Task 19, Epoch 20/20 => Loss 0.354, Loss_clf 0.216, Loss_aux 0.138, Train_accy 93.77
2024-09-05 21:35:00,305 [base.py] => Reducing exemplars...(20 per classes)
2024-09-05 21:37:28,082 [base.py] => Constructing exemplars...(20 per classes)
2024-09-05 21:57:55,471 [der.py] => Exemplar size: 2000
2024-09-05 21:57:55,471 [trainer.py] => CNN: {'total': 77.33, '00-04': 73.0, '05-09': 64.4, '10-14': 60.4, '15-19': 75.0, '20-24': 80.8, '25-29': 77.2, '30-34': 81.0, '35-39': 69.0, '40-44': 76.8, '45-49': 64.8, '50-54': 66.6, '55-59': 68.4, '60-64': 74.2, '65-69': 87.0, '70-74': 81.8, '75-79': 82.4, '80-84': 93.6, '85-89': 84.4, '90-94': 88.8, '95-99': 97.0, 'old': 76.29, 'new': 97.0}
2024-09-05 21:57:55,471 [trainer.py] => NME: {'total': 82.13, '00-04': 86.0, '05-09': 73.4, '10-14': 70.4, '15-19': 81.2, '20-24': 92.0, '25-29': 84.8, '30-34': 86.2, '35-39': 80.2, '40-44': 83.2, '45-49': 76.4, '50-54': 73.0, '55-59': 70.4, '60-64': 73.8, '65-69': 95.0, '70-74': 83.8, '75-79': 79.8, '80-84': 92.2, '85-89': 83.6, '90-94': 90.0, '95-99': 87.2, 'old': 81.86, 'new': 87.2}
2024-09-05 21:57:55,471 [trainer.py] => CNN top1 curve: [99.2, 97.8, 97.53, 96.05, 95.76, 93.8, 92.83, 91.85, 91.2, 88.72, 87.69, 88.18, 86.26, 85.71, 83.12, 80.92, 79.79, 78.27, 79.47, 77.33]
2024-09-05 21:57:55,471 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.5, 99.44, 99.13, 99.2, 98.82, 98.62, 98.5, 98.13, 97.75, 97.63, 97.26, 96.47, 96.49, 96.06, 95.13, 94.56, 93.9]
2024-09-05 21:57:55,471 [trainer.py] => NME top1 curve: [99.6, 97.7, 97.2, 95.85, 95.84, 95.23, 93.94, 93.25, 92.31, 91.54, 90.35, 89.9, 89.23, 89.06, 87.51, 85.88, 84.59, 83.29, 82.68, 82.13]
2024-09-05 21:57:55,471 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.73, 99.65, 99.64, 99.57, 99.54, 99.4, 99.27, 99.28, 99.15, 98.93, 98.78, 98.66, 98.39, 98.19, 98.15, 97.4, 97.14, 96.79]

Average Accuracy (CNN): 88.57
Average Accuracy (NME): 90.85
2024-09-05 21:57:55,471 [trainer.py] => Average Accuracy (CNN): 88.57
2024-09-05 21:57:55,471 [trainer.py] => Average Accuracy (NME): 90.85
Accuracy Matrix (CNN):
[[99.2 98.6 98.4 97.6 97.  97.4 95.8 93.8 94.4 91.2 83.4 88.8 88.  82.4
  77.2 79.6 83.8 81.  78.2 73. ]
 [ 0.  97.  96.  93.4 92.4 86.  82.4 84.6 83.8 78.2 79.8 77.2 79.6 76.2
  76.  74.2 69.6 57.4 60.4 64.4]
 [ 0.   0.  98.2 96.4 94.2 91.  92.  88.4 81.2 77.2 76.4 76.  77.2 73.6
  75.8 74.2 64.6 61.2 63.4 60.4]
 [ 0.   0.   0.  96.8 96.  92.  90.8 87.6 87.8 84.8 87.4 83.6 80.8 76.4
  76.4 81.4 77.2 74.  78.6 75. ]
 [ 0.   0.   0.   0.  99.2 97.2 96.2 96.  92.6 94.8 94.  93.6 94.4 92.2
  92.2 93.  84.  87.4 85.  80.8]
 [ 0.   0.   0.   0.   0.  99.2 97.  92.4 95.4 90.6 87.4 85.4 86.  84.6
  85.8 83.6 79.  76.8 79.  77.2]
 [ 0.   0.   0.   0.   0.   0.  95.6 93.8 91.6 90.8 88.8 90.6 88.4 89.
  85.  84.8 83.  84.6 80.8 81. ]
 [ 0.   0.   0.   0.   0.   0.   0.  98.2 96.4 86.  87.4 89.2 82.8 85.4
  77.8 76.8 76.2 76.8 75.8 69. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  97.6 94.8 89.6 89.8 90.4 88.6
  85.8 85.2 82.  80.4 76.4 76.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  98.8 92.  91.2 82.6 89.8
  88.  68.8 63.6 66.6 70.2 64.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  98.4 97.  97.8 95.8
  94.4 65.  76.4 77.  73.4 66.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  95.8 75.  77.8
  65.2 65.2 69.  61.2 67.8 68.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  98.4 89.
  72.8 79.6 71.  72.8 74.2 74.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  99.2
  95.4 95.4 94.2 93.2 93.  87. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  99.  90.  88.6 88.  87.2 81.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  98.  95.6 80.2 84.6 82.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  98.6 94.2 93.2 93.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  96.  90.  84.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  98.8 88.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  97. ]]
2024-09-05 21:57:55,474 [trainer.py] => Forgetting (CNN): 21.705263157894734
Accuracy Matrix (NME):
[[99.6 99.  99.8 99.2 98.8 98.8 98.6 97.8 97.2 96.8 95.  93.8 93.6 91.8
  90.2 89.2 88.4 88.  86.6 86. ]
 [ 0.  96.4 96.2 94.  93.8 90.6 89.  88.2 87.8 86.8 85.6 85.4 85.2 84.4
  83.8 81.4 79.  75.4 74.4 73.4]
 [ 0.   0.  95.6 97.4 95.  94.  93.2 92.6 89.4 87.  85.8 84.6 82.6 81.2
  79.2 78.6 75.2 71.2 70.6 70.4]
 [ 0.   0.   0.  92.8 94.2 93.2 92.4 91.  90.4 90.2 89.8 87.6 86.8 86.4
  85.4 85.  83.8 82.2 81.8 81.2]
 [ 0.   0.   0.   0.  97.4 98.2 97.6 97.6 97.  97.2 97.2 97.  97.2 96.8
  95.6 95.8 95.  94.2 92.6 92. ]
 [ 0.   0.   0.   0.   0.  96.6 97.2 95.6 95.2 93.4 92.6 91.  91.  90.8
  90.2 90.2 87.  86.2 85.6 84.8]
 [ 0.   0.   0.   0.   0.   0.  89.6 91.2 90.4 90.4 90.4 89.8 90.  89.6
  90.2 89.4 88.2 87.8 87.  86.2]
 [ 0.   0.   0.   0.   0.   0.   0.  92.  94.6 88.8 87.2 88.  87.6 87.2
  84.8 83.4 82.4 82.4 81.4 80.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  88.8 91.  90.  90.4 90.8 90.6
  89.  88.6 86.8 85.4 83.8 83.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  93.8 93.  92.8 92.4 92.8
  92.2 86.2 78.6 77.8 77.4 76.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  87.2 89.8 91.8 91.4
  91.6 80.6 78.6 76.8 75.4 73. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  88.6 79.4 79.
  76.2 75.8 74.2 71.6 70.6 70.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  91.6 90.2
  78.6 77.8 75.6 75.4 74.2 73.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  94.6
  95.  95.8 96.  96.  95.4 95. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  90.6 87.8 87.8 87.2 85.8 83.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  88.4 90.8 87.4 81.8 79.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  90.6 90.6 91.4 92.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  83.6 84.8 83.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  90.4 90. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  87.2]]
2024-09-05 21:57:55,476 [trainer.py] => Forgetting (NME): 11.326315789473682
2024-09-05 21:57:58,453 [trainer.py] => config: ./exps/der_cifar_B50_Inc5.json
2024-09-05 21:57:58,474 [trainer.py] => prefix: reproduce
2024-09-05 21:57:58,474 [trainer.py] => dataset: cifar224
2024-09-05 21:57:58,474 [trainer.py] => memory_size: 2000
2024-09-05 21:57:58,474 [trainer.py] => memory_per_class: 20
2024-09-05 21:57:58,475 [trainer.py] => fixed_memory: False
2024-09-05 21:57:58,475 [trainer.py] => shuffle: True
2024-09-05 21:57:58,475 [trainer.py] => init_cls: 50
2024-09-05 21:57:58,475 [trainer.py] => increment: 10
2024-09-05 21:57:58,475 [trainer.py] => model_name: der
2024-09-05 21:57:58,475 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 21:57:58,475 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-05 21:57:58,475 [trainer.py] => seed: 1993
2024-09-05 21:57:58,475 [trainer.py] => init_epoch: 20
2024-09-05 21:57:58,475 [trainer.py] => init_lr: 0.001
2024-09-05 21:57:58,475 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-05 21:57:58,475 [trainer.py] => init_lr_decay: 0.1
2024-09-05 21:57:58,475 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 21:57:58,475 [trainer.py] => epochs: 20
2024-09-05 21:57:58,475 [trainer.py] => lrate: 0.001
2024-09-05 21:57:58,475 [trainer.py] => milestones: [80, 120, 150]
2024-09-05 21:57:58,475 [trainer.py] => lrate_decay: 0.1
2024-09-05 21:57:58,475 [trainer.py] => batch_size: 48
2024-09-05 21:57:58,475 [trainer.py] => weight_decay: 0.0002
2024-09-05 21:57:58,475 [trainer.py] => T: 2
2024-09-05 21:57:59,577 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-05 21:57:59,963 [trainer.py] => All params: 0
2024-09-05 21:57:59,963 [trainer.py] => Trainable params: 0
2024-09-05 21:58:01,588 [der.py] => Learning on 0-50
2024-09-05 21:58:01,588 [der.py] => All params: 85876325
2024-09-05 21:58:01,589 [der.py] => Trainable params: 85876325

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.956, Train_accy 24.74, Test_accy 85.50:   0%|          | 0/20 [03:24<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.956, Train_accy 24.74, Test_accy 85.50:   5%|▌         | 1/20 [03:24<1:04:54, 204.98s/it]
Task 0, Epoch 2/20 => Loss 0.910, Train_accy 74.52:   5%|▌         | 1/20 [06:35<1:04:54, 204.98s/it]                 
Task 0, Epoch 2/20 => Loss 0.910, Train_accy 74.52:  10%|█         | 2/20 [06:35<59:00, 196.71s/it]  
Task 0, Epoch 3/20 => Loss 0.723, Train_accy 79.49:  10%|█         | 2/20 [09:46<59:00, 196.71s/it]
Task 0, Epoch 3/20 => Loss 0.723, Train_accy 79.49:  15%|█▌        | 3/20 [09:46<54:57, 193.94s/it]
Task 0, Epoch 4/20 => Loss 0.644, Train_accy 81.89:  15%|█▌        | 3/20 [12:57<54:57, 193.94s/it]
Task 0, Epoch 4/20 => Loss 0.644, Train_accy 81.89:  20%|██        | 4/20 [12:57<51:21, 192.60s/it]
Task 0, Epoch 5/20 => Loss 0.588, Train_accy 83.09:  20%|██        | 4/20 [16:07<51:21, 192.60s/it]
Task 0, Epoch 5/20 => Loss 0.588, Train_accy 83.09:  25%|██▌       | 5/20 [16:07<47:58, 191.93s/it]
Task 0, Epoch 6/20 => Loss 0.552, Train_accy 84.48, Test_accy 93.00:  25%|██▌       | 5/20 [19:32<47:58, 191.93s/it]
Task 0, Epoch 6/20 => Loss 0.552, Train_accy 84.48, Test_accy 93.00:  30%|███       | 6/20 [19:32<45:48, 196.32s/it]
Task 0, Epoch 7/20 => Loss 0.522, Train_accy 85.20:  30%|███       | 6/20 [22:43<45:48, 196.32s/it]                 
Task 0, Epoch 7/20 => Loss 0.522, Train_accy 85.20:  35%|███▌      | 7/20 [22:43<42:07, 194.43s/it]
Task 0, Epoch 8/20 => Loss 0.496, Train_accy 86.02:  35%|███▌      | 7/20 [25:53<42:07, 194.43s/it]
Task 0, Epoch 8/20 => Loss 0.496, Train_accy 86.02:  40%|████      | 8/20 [25:53<38:38, 193.18s/it]
Task 0, Epoch 9/20 => Loss 0.479, Train_accy 86.48:  40%|████      | 8/20 [29:04<38:38, 193.18s/it]
Task 0, Epoch 9/20 => Loss 0.479, Train_accy 86.48:  45%|████▌     | 9/20 [29:04<35:17, 192.48s/it]
Task 0, Epoch 10/20 => Loss 0.459, Train_accy 86.90:  45%|████▌     | 9/20 [32:15<35:17, 192.48s/it]
Task 0, Epoch 10/20 => Loss 0.459, Train_accy 86.90:  50%|█████     | 10/20 [32:15<31:58, 191.88s/it]
Task 0, Epoch 11/20 => Loss 0.452, Train_accy 87.06, Test_accy 93.40:  50%|█████     | 10/20 [35:39<31:58, 191.88s/it]
Task 0, Epoch 11/20 => Loss 0.452, Train_accy 87.06, Test_accy 93.40:  55%|█████▌    | 11/20 [35:39<29:22, 195.82s/it]
Task 0, Epoch 12/20 => Loss 0.431, Train_accy 88.07:  55%|█████▌    | 11/20 [38:50<29:22, 195.82s/it]                 
Task 0, Epoch 12/20 => Loss 0.431, Train_accy 88.07:  60%|██████    | 12/20 [38:50<25:54, 194.32s/it]
Task 0, Epoch 13/20 => Loss 0.435, Train_accy 87.68:  60%|██████    | 12/20 [42:01<25:54, 194.32s/it]
Task 0, Epoch 13/20 => Loss 0.435, Train_accy 87.68:  65%|██████▌   | 13/20 [42:01<22:32, 193.20s/it]
Task 0, Epoch 14/20 => Loss 0.417, Train_accy 88.19:  65%|██████▌   | 13/20 [45:12<22:32, 193.20s/it]
Task 0, Epoch 14/20 => Loss 0.417, Train_accy 88.19:  70%|███████   | 14/20 [45:12<19:14, 192.49s/it]
Task 0, Epoch 15/20 => Loss 0.406, Train_accy 88.52:  70%|███████   | 14/20 [48:22<19:14, 192.49s/it]
Task 0, Epoch 15/20 => Loss 0.406, Train_accy 88.52:  75%|███████▌  | 15/20 [48:22<15:59, 191.86s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.92, Test_accy 92.32:  75%|███████▌  | 15/20 [51:47<15:59, 191.86s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.92, Test_accy 92.32:  80%|████████  | 16/20 [51:47<13:03, 195.85s/it]
Task 0, Epoch 17/20 => Loss 0.374, Train_accy 89.39:  80%|████████  | 16/20 [54:58<13:03, 195.85s/it]                 
Task 0, Epoch 17/20 => Loss 0.374, Train_accy 89.39:  85%|████████▌ | 17/20 [54:58<09:42, 194.26s/it]
Task 0, Epoch 18/20 => Loss 0.376, Train_accy 89.44:  85%|████████▌ | 17/20 [58:08<09:42, 194.26s/it]
Task 0, Epoch 18/20 => Loss 0.376, Train_accy 89.44:  90%|█████████ | 18/20 [58:08<06:26, 193.07s/it]
Task 0, Epoch 19/20 => Loss 0.372, Train_accy 89.52:  90%|█████████ | 18/20 [1:01:19<06:26, 193.07s/it]
Task 0, Epoch 19/20 => Loss 0.372, Train_accy 89.52:  95%|█████████▌| 19/20 [1:01:19<03:12, 192.48s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55:  95%|█████████▌| 19/20 [1:04:31<03:12, 192.48s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55: 100%|██████████| 20/20 [1:04:31<00:00, 192.34s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55: 100%|██████████| 20/20 [1:04:31<00:00, 193.59s/it]
2024-09-05 23:02:33,965 [der.py] => Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55
2024-09-05 23:02:33,967 [base.py] => Reducing exemplars...(40 per classes)
2024-09-05 23:02:33,967 [base.py] => Constructing exemplars...(40 per classes)
2024-09-05 23:04:46,627 [der.py] => Exemplar size: 2000
2024-09-05 23:04:46,627 [trainer.py] => CNN: {'total': 92.32, '00-49': 92.32, 'old': 0, 'new': 92.32}
2024-09-05 23:04:46,627 [trainer.py] => NME: {'total': 92.82, '00-49': 92.82, 'old': 0, 'new': 92.82}
2024-09-05 23:04:46,627 [trainer.py] => CNN top1 curve: [92.32]
2024-09-05 23:04:46,627 [trainer.py] => CNN top5 curve: [99.22]
2024-09-05 23:04:46,627 [trainer.py] => NME top1 curve: [92.82]
2024-09-05 23:04:46,628 [trainer.py] => NME top5 curve: [99.46]

Average Accuracy (CNN): 92.32
Average Accuracy (NME): 92.82
2024-09-05 23:04:46,628 [trainer.py] => Average Accuracy (CNN): 92.32
2024-09-05 23:04:46,628 [trainer.py] => Average Accuracy (NME): 92.82
2024-09-05 23:04:46,628 [trainer.py] => All params: 85876325
2024-09-05 23:04:46,629 [trainer.py] => Trainable params: 85876325
2024-09-05 23:04:48,108 [der.py] => Learning on 50-60
2024-09-05 23:04:48,109 [der.py] => All params: 171697991
2024-09-05 23:04:48,110 [der.py] => Trainable params: 85899335

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.617, Loss_clf 0.952, Loss_aux 0.665, Train_accy 77.63, Test_accy 89.18:   0%|          | 0/20 [01:45<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.617, Loss_clf 0.952, Loss_aux 0.665, Train_accy 77.63, Test_accy 89.18:   5%|▌         | 1/20 [01:45<33:23, 105.43s/it]
Task 1, Epoch 2/20 => Loss 0.771, Loss_clf 0.417, Loss_aux 0.353, Train_accy 87.63:   5%|▌         | 1/20 [02:57<33:23, 105.43s/it]                 
Task 1, Epoch 2/20 => Loss 0.771, Loss_clf 0.417, Loss_aux 0.353, Train_accy 87.63:  10%|█         | 2/20 [02:57<25:45, 85.84s/it] 
Task 1, Epoch 3/20 => Loss 0.731, Loss_clf 0.404, Loss_aux 0.327, Train_accy 88.09:  10%|█         | 2/20 [04:09<25:45, 85.84s/it]
Task 1, Epoch 3/20 => Loss 0.731, Loss_clf 0.404, Loss_aux 0.327, Train_accy 88.09:  15%|█▌        | 3/20 [04:09<22:33, 79.60s/it]
Task 1, Epoch 4/20 => Loss 0.697, Loss_clf 0.381, Loss_aux 0.316, Train_accy 88.69:  15%|█▌        | 3/20 [05:21<22:33, 79.60s/it]
Task 1, Epoch 4/20 => Loss 0.697, Loss_clf 0.381, Loss_aux 0.316, Train_accy 88.69:  20%|██        | 4/20 [05:21<20:26, 76.68s/it]
Task 1, Epoch 5/20 => Loss 0.639, Loss_clf 0.353, Loss_aux 0.286, Train_accy 89.60:  20%|██        | 4/20 [06:34<20:26, 76.68s/it]
Task 1, Epoch 5/20 => Loss 0.639, Loss_clf 0.353, Loss_aux 0.286, Train_accy 89.60:  25%|██▌       | 5/20 [06:34<18:47, 75.19s/it]
Task 1, Epoch 6/20 => Loss 0.626, Loss_clf 0.340, Loss_aux 0.285, Train_accy 89.93, Test_accy 89.90:  25%|██▌       | 5/20 [08:20<18:47, 75.19s/it]
Task 1, Epoch 6/20 => Loss 0.626, Loss_clf 0.340, Loss_aux 0.285, Train_accy 89.93, Test_accy 89.90:  30%|███       | 6/20 [08:20<20:00, 85.73s/it]
Task 1, Epoch 7/20 => Loss 0.621, Loss_clf 0.343, Loss_aux 0.277, Train_accy 89.83:  30%|███       | 6/20 [09:33<20:00, 85.73s/it]                 
Task 1, Epoch 7/20 => Loss 0.621, Loss_clf 0.343, Loss_aux 0.277, Train_accy 89.83:  35%|███▌      | 7/20 [09:33<17:38, 81.41s/it]
Task 1, Epoch 8/20 => Loss 0.607, Loss_clf 0.334, Loss_aux 0.273, Train_accy 90.16:  35%|███▌      | 7/20 [10:45<17:38, 81.41s/it]
Task 1, Epoch 8/20 => Loss 0.607, Loss_clf 0.334, Loss_aux 0.273, Train_accy 90.16:  40%|████      | 8/20 [10:45<15:43, 78.61s/it]
Task 1, Epoch 9/20 => Loss 0.589, Loss_clf 0.331, Loss_aux 0.257, Train_accy 90.27:  40%|████      | 8/20 [11:58<15:43, 78.61s/it]
Task 1, Epoch 9/20 => Loss 0.589, Loss_clf 0.331, Loss_aux 0.257, Train_accy 90.27:  45%|████▌     | 9/20 [11:58<14:03, 76.64s/it]
Task 1, Epoch 10/20 => Loss 0.570, Loss_clf 0.322, Loss_aux 0.248, Train_accy 90.33:  45%|████▌     | 9/20 [13:10<14:03, 76.64s/it]
Task 1, Epoch 10/20 => Loss 0.570, Loss_clf 0.322, Loss_aux 0.248, Train_accy 90.33:  50%|█████     | 10/20 [13:10<12:32, 75.29s/it]
Task 1, Epoch 11/20 => Loss 0.542, Loss_clf 0.305, Loss_aux 0.237, Train_accy 91.03, Test_accy 89.15:  50%|█████     | 10/20 [14:56<12:32, 75.29s/it]
Task 1, Epoch 11/20 => Loss 0.542, Loss_clf 0.305, Loss_aux 0.237, Train_accy 91.03, Test_accy 89.15:  55%|█████▌    | 11/20 [14:56<12:41, 84.64s/it]
Task 1, Epoch 12/20 => Loss 0.507, Loss_clf 0.280, Loss_aux 0.226, Train_accy 92.03:  55%|█████▌    | 11/20 [16:08<12:41, 84.64s/it]                 
Task 1, Epoch 12/20 => Loss 0.507, Loss_clf 0.280, Loss_aux 0.226, Train_accy 92.03:  60%|██████    | 12/20 [16:08<10:47, 80.89s/it]
Task 1, Epoch 13/20 => Loss 0.486, Loss_clf 0.271, Loss_aux 0.215, Train_accy 92.07:  60%|██████    | 12/20 [17:20<10:47, 80.89s/it]
Task 1, Epoch 13/20 => Loss 0.486, Loss_clf 0.271, Loss_aux 0.215, Train_accy 92.07:  65%|██████▌   | 13/20 [17:20<09:07, 78.26s/it]
Task 1, Epoch 14/20 => Loss 0.514, Loss_clf 0.295, Loss_aux 0.219, Train_accy 91.67:  65%|██████▌   | 13/20 [18:32<09:07, 78.26s/it]
Task 1, Epoch 14/20 => Loss 0.514, Loss_clf 0.295, Loss_aux 0.219, Train_accy 91.67:  70%|███████   | 14/20 [18:32<07:38, 76.43s/it]
Task 1, Epoch 15/20 => Loss 0.479, Loss_clf 0.273, Loss_aux 0.206, Train_accy 92.27:  70%|███████   | 14/20 [19:45<07:38, 76.43s/it]
Task 1, Epoch 15/20 => Loss 0.479, Loss_clf 0.273, Loss_aux 0.206, Train_accy 92.27:  75%|███████▌  | 15/20 [19:45<06:15, 75.16s/it]
Task 1, Epoch 16/20 => Loss 0.502, Loss_clf 0.277, Loss_aux 0.224, Train_accy 91.93, Test_accy 89.13:  75%|███████▌  | 15/20 [21:30<06:15, 75.16s/it]
Task 1, Epoch 16/20 => Loss 0.502, Loss_clf 0.277, Loss_aux 0.224, Train_accy 91.93, Test_accy 89.13:  80%|████████  | 16/20 [21:30<05:37, 84.34s/it]
Task 1, Epoch 17/20 => Loss 0.528, Loss_clf 0.295, Loss_aux 0.233, Train_accy 91.34:  80%|████████  | 16/20 [22:43<05:37, 84.34s/it]                 
Task 1, Epoch 17/20 => Loss 0.528, Loss_clf 0.295, Loss_aux 0.233, Train_accy 91.34:  85%|████████▌ | 17/20 [22:43<04:02, 80.75s/it]
Task 1, Epoch 18/20 => Loss 0.466, Loss_clf 0.263, Loss_aux 0.203, Train_accy 92.27:  85%|████████▌ | 17/20 [23:55<04:02, 80.75s/it]
Task 1, Epoch 18/20 => Loss 0.466, Loss_clf 0.263, Loss_aux 0.203, Train_accy 92.27:  90%|█████████ | 18/20 [23:55<02:36, 78.24s/it]
Task 1, Epoch 19/20 => Loss 0.491, Loss_clf 0.283, Loss_aux 0.208, Train_accy 91.79:  90%|█████████ | 18/20 [25:07<02:36, 78.24s/it]
Task 1, Epoch 19/20 => Loss 0.491, Loss_clf 0.283, Loss_aux 0.208, Train_accy 91.79:  95%|█████████▌| 19/20 [25:07<01:16, 76.43s/it]
Task 1, Epoch 20/20 => Loss 0.499, Loss_clf 0.280, Loss_aux 0.218, Train_accy 91.87:  95%|█████████▌| 19/20 [26:20<01:16, 76.43s/it]
Task 1, Epoch 20/20 => Loss 0.499, Loss_clf 0.280, Loss_aux 0.218, Train_accy 91.87: 100%|██████████| 20/20 [26:20<00:00, 75.18s/it]
Task 1, Epoch 20/20 => Loss 0.499, Loss_clf 0.280, Loss_aux 0.218, Train_accy 91.87: 100%|██████████| 20/20 [26:20<00:00, 79.01s/it]
2024-09-05 23:31:08,317 [der.py] => Task 1, Epoch 20/20 => Loss 0.499, Loss_clf 0.280, Loss_aux 0.218, Train_accy 91.87
2024-09-05 23:31:08,319 [base.py] => Reducing exemplars...(33 per classes)
2024-09-05 23:31:28,531 [base.py] => Constructing exemplars...(33 per classes)
2024-09-05 23:33:10,733 [der.py] => Exemplar size: 1980
2024-09-05 23:33:10,733 [trainer.py] => CNN: {'total': 90.05, '00-49': 88.84, '50-59': 96.1, 'old': 88.84, 'new': 96.1}
2024-09-05 23:33:10,734 [trainer.py] => NME: {'total': 92.35, '00-49': 92.0, '50-59': 94.1, 'old': 92.0, 'new': 94.1}
2024-09-05 23:33:10,734 [trainer.py] => CNN top1 curve: [92.32, 90.05]
2024-09-05 23:33:10,734 [trainer.py] => CNN top5 curve: [99.22, 98.93]
2024-09-05 23:33:10,734 [trainer.py] => NME top1 curve: [92.82, 92.35]
2024-09-05 23:33:10,734 [trainer.py] => NME top5 curve: [99.46, 99.3]

Average Accuracy (CNN): 91.18
Average Accuracy (NME): 92.58
2024-09-05 23:33:10,734 [trainer.py] => Average Accuracy (CNN): 91.18
2024-09-05 23:33:10,734 [trainer.py] => Average Accuracy (NME): 92.58
2024-09-05 23:33:10,735 [trainer.py] => All params: 171697991
2024-09-05 23:33:10,736 [trainer.py] => Trainable params: 85899335
2024-09-05 23:33:12,251 [der.py] => Learning on 60-70
2024-09-05 23:33:12,254 [der.py] => All params: 257565777
2024-09-05 23:33:12,255 [der.py] => Trainable params: 85968465

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.489, Loss_clf 0.925, Loss_aux 0.564, Train_accy 80.66, Test_accy 88.49:   0%|          | 0/20 [02:28<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.489, Loss_clf 0.925, Loss_aux 0.564, Train_accy 80.66, Test_accy 88.49:   5%|▌         | 1/20 [02:28<46:56, 148.25s/it]
Task 2, Epoch 2/20 => Loss 0.647, Loss_clf 0.360, Loss_aux 0.287, Train_accy 89.64:   5%|▌         | 1/20 [03:59<46:56, 148.25s/it]                 
Task 2, Epoch 2/20 => Loss 0.647, Loss_clf 0.360, Loss_aux 0.287, Train_accy 89.64:  10%|█         | 2/20 [03:59<34:20, 114.47s/it]
Task 2, Epoch 3/20 => Loss 0.609, Loss_clf 0.346, Loss_aux 0.263, Train_accy 90.43:  10%|█         | 2/20 [05:29<34:20, 114.47s/it]
Task 2, Epoch 3/20 => Loss 0.609, Loss_clf 0.346, Loss_aux 0.263, Train_accy 90.43:  15%|█▌        | 3/20 [05:29<29:22, 103.65s/it]
Task 2, Epoch 4/20 => Loss 0.510, Loss_clf 0.288, Loss_aux 0.222, Train_accy 91.43:  15%|█▌        | 3/20 [07:00<29:22, 103.65s/it]
Task 2, Epoch 4/20 => Loss 0.510, Loss_clf 0.288, Loss_aux 0.222, Train_accy 91.43:  20%|██        | 4/20 [07:00<26:16, 98.52s/it] 
Task 2, Epoch 5/20 => Loss 0.545, Loss_clf 0.308, Loss_aux 0.237, Train_accy 91.23:  20%|██        | 4/20 [08:31<26:16, 98.52s/it]
Task 2, Epoch 5/20 => Loss 0.545, Loss_clf 0.308, Loss_aux 0.237, Train_accy 91.23:  25%|██▌       | 5/20 [08:31<23:56, 95.74s/it]
Task 2, Epoch 6/20 => Loss 0.509, Loss_clf 0.285, Loss_aux 0.224, Train_accy 92.21, Test_accy 89.46:  25%|██▌       | 5/20 [10:59<23:56, 95.74s/it]
Task 2, Epoch 6/20 => Loss 0.509, Loss_clf 0.285, Loss_aux 0.224, Train_accy 92.21, Test_accy 89.46:  30%|███       | 6/20 [10:59<26:31, 113.66s/it]
Task 2, Epoch 7/20 => Loss 0.479, Loss_clf 0.270, Loss_aux 0.209, Train_accy 92.61:  30%|███       | 6/20 [12:30<26:31, 113.66s/it]                 
Task 2, Epoch 7/20 => Loss 0.479, Loss_clf 0.270, Loss_aux 0.209, Train_accy 92.61:  35%|███▌      | 7/20 [12:30<22:59, 106.15s/it]
Task 2, Epoch 8/20 => Loss 0.452, Loss_clf 0.257, Loss_aux 0.195, Train_accy 92.59:  35%|███▌      | 7/20 [14:01<22:59, 106.15s/it]
Task 2, Epoch 8/20 => Loss 0.452, Loss_clf 0.257, Loss_aux 0.195, Train_accy 92.59:  40%|████      | 8/20 [14:01<20:15, 101.26s/it]
Task 2, Epoch 9/20 => Loss 0.489, Loss_clf 0.280, Loss_aux 0.209, Train_accy 92.23:  40%|████      | 8/20 [15:31<20:15, 101.26s/it]
Task 2, Epoch 9/20 => Loss 0.489, Loss_clf 0.280, Loss_aux 0.209, Train_accy 92.23:  45%|████▌     | 9/20 [15:31<17:57, 97.96s/it] 
Task 2, Epoch 10/20 => Loss 0.495, Loss_clf 0.282, Loss_aux 0.214, Train_accy 92.22:  45%|████▌     | 9/20 [17:02<17:57, 97.96s/it]
Task 2, Epoch 10/20 => Loss 0.495, Loss_clf 0.282, Loss_aux 0.214, Train_accy 92.22:  50%|█████     | 10/20 [17:02<15:56, 95.68s/it]
Task 2, Epoch 11/20 => Loss 0.464, Loss_clf 0.263, Loss_aux 0.201, Train_accy 92.97, Test_accy 89.10:  50%|█████     | 10/20 [19:30<15:56, 95.68s/it]
Task 2, Epoch 11/20 => Loss 0.464, Loss_clf 0.263, Loss_aux 0.201, Train_accy 92.97, Test_accy 89.10:  55%|█████▌    | 11/20 [19:30<16:45, 111.72s/it]
Task 2, Epoch 12/20 => Loss 0.459, Loss_clf 0.262, Loss_aux 0.197, Train_accy 92.58:  55%|█████▌    | 11/20 [21:01<16:45, 111.72s/it]                 
Task 2, Epoch 12/20 => Loss 0.459, Loss_clf 0.262, Loss_aux 0.197, Train_accy 92.58:  60%|██████    | 12/20 [21:01<14:02, 105.29s/it]
Task 2, Epoch 13/20 => Loss 0.424, Loss_clf 0.243, Loss_aux 0.181, Train_accy 93.17:  60%|██████    | 12/20 [22:31<14:02, 105.29s/it]
Task 2, Epoch 13/20 => Loss 0.424, Loss_clf 0.243, Loss_aux 0.181, Train_accy 93.17:  65%|██████▌   | 13/20 [22:31<11:46, 100.86s/it]
Task 2, Epoch 14/20 => Loss 0.436, Loss_clf 0.249, Loss_aux 0.186, Train_accy 93.01:  65%|██████▌   | 13/20 [24:02<11:46, 100.86s/it]
Task 2, Epoch 14/20 => Loss 0.436, Loss_clf 0.249, Loss_aux 0.186, Train_accy 93.01:  70%|███████   | 14/20 [24:02<09:47, 97.84s/it] 
Task 2, Epoch 15/20 => Loss 0.446, Loss_clf 0.258, Loss_aux 0.189, Train_accy 92.91:  70%|███████   | 14/20 [25:33<09:47, 97.84s/it]
Task 2, Epoch 15/20 => Loss 0.446, Loss_clf 0.258, Loss_aux 0.189, Train_accy 92.91:  75%|███████▌  | 15/20 [25:33<07:58, 95.69s/it]
Task 2, Epoch 16/20 => Loss 0.437, Loss_clf 0.250, Loss_aux 0.187, Train_accy 93.24, Test_accy 89.40:  75%|███████▌  | 15/20 [28:01<07:58, 95.69s/it]
Task 2, Epoch 16/20 => Loss 0.437, Loss_clf 0.250, Loss_aux 0.187, Train_accy 93.24, Test_accy 89.40:  80%|████████  | 16/20 [28:01<07:25, 111.49s/it]
Task 2, Epoch 17/20 => Loss 0.433, Loss_clf 0.250, Loss_aux 0.183, Train_accy 92.87:  80%|████████  | 16/20 [29:32<07:25, 111.49s/it]                 
Task 2, Epoch 17/20 => Loss 0.433, Loss_clf 0.250, Loss_aux 0.183, Train_accy 92.87:  85%|████████▌ | 17/20 [29:32<05:15, 105.22s/it]
Task 2, Epoch 18/20 => Loss 0.404, Loss_clf 0.233, Loss_aux 0.171, Train_accy 93.60:  85%|████████▌ | 17/20 [31:02<05:15, 105.22s/it]
Task 2, Epoch 18/20 => Loss 0.404, Loss_clf 0.233, Loss_aux 0.171, Train_accy 93.60:  90%|█████████ | 18/20 [31:02<03:21, 100.82s/it]
Task 2, Epoch 19/20 => Loss 0.405, Loss_clf 0.233, Loss_aux 0.173, Train_accy 93.52:  90%|█████████ | 18/20 [32:33<03:21, 100.82s/it]
Task 2, Epoch 19/20 => Loss 0.405, Loss_clf 0.233, Loss_aux 0.173, Train_accy 93.52:  95%|█████████▌| 19/20 [32:33<01:37, 97.74s/it] 
Task 2, Epoch 20/20 => Loss 0.397, Loss_clf 0.229, Loss_aux 0.168, Train_accy 93.64:  95%|█████████▌| 19/20 [34:03<01:37, 97.74s/it]
Task 2, Epoch 20/20 => Loss 0.397, Loss_clf 0.229, Loss_aux 0.168, Train_accy 93.64: 100%|██████████| 20/20 [34:03<00:00, 95.58s/it]
Task 2, Epoch 20/20 => Loss 0.397, Loss_clf 0.229, Loss_aux 0.168, Train_accy 93.64: 100%|██████████| 20/20 [34:03<00:00, 102.20s/it]
2024-09-06 00:07:16,264 [der.py] => Task 2, Epoch 20/20 => Loss 0.397, Loss_clf 0.229, Loss_aux 0.168, Train_accy 93.64
2024-09-06 00:07:16,265 [base.py] => Reducing exemplars...(28 per classes)
2024-09-06 00:07:43,060 [base.py] => Constructing exemplars...(28 per classes)
2024-09-06 00:10:27,948 [der.py] => Exemplar size: 1960
2024-09-06 00:10:27,949 [trainer.py] => CNN: {'total': 89.06, '00-49': 88.88, '50-59': 80.9, '60-69': 98.1, 'old': 87.55, 'new': 98.1}
2024-09-06 00:10:27,949 [trainer.py] => NME: {'total': 90.83, '00-49': 90.68, '50-59': 87.8, '60-69': 94.6, 'old': 90.2, 'new': 94.6}
2024-09-06 00:10:27,949 [trainer.py] => CNN top1 curve: [92.32, 90.05, 89.06]
2024-09-06 00:10:27,949 [trainer.py] => CNN top5 curve: [99.22, 98.93, 98.67]
2024-09-06 00:10:27,949 [trainer.py] => NME top1 curve: [92.82, 92.35, 90.83]
2024-09-06 00:10:27,949 [trainer.py] => NME top5 curve: [99.46, 99.3, 99.27]

Average Accuracy (CNN): 90.48
Average Accuracy (NME): 92.0
2024-09-06 00:10:27,949 [trainer.py] => Average Accuracy (CNN): 90.48
2024-09-06 00:10:27,949 [trainer.py] => Average Accuracy (NME): 92.0
2024-09-06 00:10:27,951 [trainer.py] => All params: 257565777
2024-09-06 00:10:27,952 [trainer.py] => Trainable params: 85968465
2024-09-06 00:10:29,480 [der.py] => Learning on 70-80
2024-09-06 00:10:29,484 [der.py] => All params: 343448923
2024-09-06 00:10:29,486 [der.py] => Trainable params: 86052955

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.877, Loss_clf 1.181, Loss_aux 0.696, Train_accy 78.76, Test_accy 84.45:   0%|          | 0/20 [03:15<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.877, Loss_clf 1.181, Loss_aux 0.696, Train_accy 78.76, Test_accy 84.45:   5%|▌         | 1/20 [03:15<1:02:02, 195.91s/it]
Task 3, Epoch 2/20 => Loss 0.823, Loss_clf 0.447, Loss_aux 0.376, Train_accy 86.64:   5%|▌         | 1/20 [05:04<1:02:02, 195.91s/it]                 
Task 3, Epoch 2/20 => Loss 0.823, Loss_clf 0.447, Loss_aux 0.376, Train_accy 86.64:  10%|█         | 2/20 [05:04<43:23, 144.66s/it]  
Task 3, Epoch 3/20 => Loss 0.725, Loss_clf 0.402, Loss_aux 0.324, Train_accy 88.13:  10%|█         | 2/20 [06:53<43:23, 144.66s/it]
Task 3, Epoch 3/20 => Loss 0.725, Loss_clf 0.402, Loss_aux 0.324, Train_accy 88.13:  15%|█▌        | 3/20 [06:53<36:20, 128.26s/it]
Task 3, Epoch 4/20 => Loss 0.644, Loss_clf 0.355, Loss_aux 0.288, Train_accy 88.85:  15%|█▌        | 3/20 [08:42<36:20, 128.26s/it]
Task 3, Epoch 4/20 => Loss 0.644, Loss_clf 0.355, Loss_aux 0.288, Train_accy 88.85:  20%|██        | 4/20 [08:42<32:09, 120.57s/it]
Task 3, Epoch 5/20 => Loss 0.624, Loss_clf 0.350, Loss_aux 0.274, Train_accy 89.68:  20%|██        | 4/20 [10:30<32:09, 120.57s/it]
Task 3, Epoch 5/20 => Loss 0.624, Loss_clf 0.350, Loss_aux 0.274, Train_accy 89.68:  25%|██▌       | 5/20 [10:30<29:04, 116.30s/it]
Task 3, Epoch 6/20 => Loss 0.597, Loss_clf 0.323, Loss_aux 0.273, Train_accy 90.69, Test_accy 84.44:  25%|██▌       | 5/20 [13:46<29:04, 116.30s/it]
Task 3, Epoch 6/20 => Loss 0.597, Loss_clf 0.323, Loss_aux 0.273, Train_accy 90.69, Test_accy 84.44:  30%|███       | 6/20 [13:46<33:26, 143.33s/it]
Task 3, Epoch 7/20 => Loss 0.578, Loss_clf 0.322, Loss_aux 0.256, Train_accy 90.66:  30%|███       | 6/20 [15:35<33:26, 143.33s/it]                 
Task 3, Epoch 7/20 => Loss 0.578, Loss_clf 0.322, Loss_aux 0.256, Train_accy 90.66:  35%|███▌      | 7/20 [15:35<28:36, 132.04s/it]
Task 3, Epoch 8/20 => Loss 0.572, Loss_clf 0.313, Loss_aux 0.259, Train_accy 91.03:  35%|███▌      | 7/20 [17:24<28:36, 132.04s/it]
Task 3, Epoch 8/20 => Loss 0.572, Loss_clf 0.313, Loss_aux 0.259, Train_accy 91.03:  40%|████      | 8/20 [17:24<24:55, 124.64s/it]
Task 3, Epoch 9/20 => Loss 0.546, Loss_clf 0.298, Loss_aux 0.248, Train_accy 91.47:  40%|████      | 8/20 [19:13<24:55, 124.64s/it]
Task 3, Epoch 9/20 => Loss 0.546, Loss_clf 0.298, Loss_aux 0.248, Train_accy 91.47:  45%|████▌     | 9/20 [19:13<21:56, 119.67s/it]
Task 3, Epoch 10/20 => Loss 0.543, Loss_clf 0.300, Loss_aux 0.244, Train_accy 91.80:  45%|████▌     | 9/20 [21:02<21:56, 119.67s/it]
Task 3, Epoch 10/20 => Loss 0.543, Loss_clf 0.300, Loss_aux 0.244, Train_accy 91.80:  50%|█████     | 10/20 [21:02<19:24, 116.44s/it]
Task 3, Epoch 11/20 => Loss 0.533, Loss_clf 0.293, Loss_aux 0.240, Train_accy 91.71, Test_accy 84.34:  50%|█████     | 10/20 [24:18<19:24, 116.44s/it]
Task 3, Epoch 11/20 => Loss 0.533, Loss_clf 0.293, Loss_aux 0.240, Train_accy 91.71, Test_accy 84.34:  55%|█████▌    | 11/20 [24:18<21:06, 140.75s/it]
Task 3, Epoch 12/20 => Loss 0.498, Loss_clf 0.277, Loss_aux 0.221, Train_accy 92.23:  55%|█████▌    | 11/20 [26:07<21:06, 140.75s/it]                 
Task 3, Epoch 12/20 => Loss 0.498, Loss_clf 0.277, Loss_aux 0.221, Train_accy 92.23:  60%|██████    | 12/20 [26:07<17:28, 131.05s/it]
Task 3, Epoch 13/20 => Loss 0.483, Loss_clf 0.272, Loss_aux 0.211, Train_accy 92.43:  60%|██████    | 12/20 [27:55<17:28, 131.05s/it]
Task 3, Epoch 13/20 => Loss 0.483, Loss_clf 0.272, Loss_aux 0.211, Train_accy 92.43:  65%|██████▌   | 13/20 [27:55<14:30, 124.31s/it]
Task 3, Epoch 14/20 => Loss 0.505, Loss_clf 0.284, Loss_aux 0.221, Train_accy 91.97:  65%|██████▌   | 13/20 [29:44<14:30, 124.31s/it]
Task 3, Epoch 14/20 => Loss 0.505, Loss_clf 0.284, Loss_aux 0.221, Train_accy 91.97:  70%|███████   | 14/20 [29:44<11:58, 119.70s/it]
Task 3, Epoch 15/20 => Loss 0.469, Loss_clf 0.258, Loss_aux 0.211, Train_accy 92.41:  70%|███████   | 14/20 [31:33<11:58, 119.70s/it]
Task 3, Epoch 15/20 => Loss 0.469, Loss_clf 0.258, Loss_aux 0.211, Train_accy 92.41:  75%|███████▌  | 15/20 [31:33<09:42, 116.42s/it]
Task 3, Epoch 16/20 => Loss 0.503, Loss_clf 0.284, Loss_aux 0.219, Train_accy 91.97, Test_accy 84.58:  75%|███████▌  | 15/20 [34:49<09:42, 116.42s/it]
Task 3, Epoch 16/20 => Loss 0.503, Loss_clf 0.284, Loss_aux 0.219, Train_accy 91.97, Test_accy 84.58:  80%|████████  | 16/20 [34:49<09:21, 140.31s/it]
Task 3, Epoch 17/20 => Loss 0.442, Loss_clf 0.252, Loss_aux 0.190, Train_accy 93.20:  80%|████████  | 16/20 [36:38<09:21, 140.31s/it]                 
Task 3, Epoch 17/20 => Loss 0.442, Loss_clf 0.252, Loss_aux 0.190, Train_accy 93.20:  85%|████████▌ | 17/20 [36:38<06:32, 130.86s/it]
Task 3, Epoch 18/20 => Loss 0.460, Loss_clf 0.256, Loss_aux 0.204, Train_accy 92.80:  85%|████████▌ | 17/20 [38:27<06:32, 130.86s/it]
Task 3, Epoch 18/20 => Loss 0.460, Loss_clf 0.256, Loss_aux 0.204, Train_accy 92.80:  90%|█████████ | 18/20 [38:27<04:08, 124.28s/it]
Task 3, Epoch 19/20 => Loss 0.463, Loss_clf 0.260, Loss_aux 0.203, Train_accy 92.37:  90%|█████████ | 18/20 [40:16<04:08, 124.28s/it]
Task 3, Epoch 19/20 => Loss 0.463, Loss_clf 0.260, Loss_aux 0.203, Train_accy 92.37:  95%|█████████▌| 19/20 [40:16<01:59, 119.71s/it]
Task 3, Epoch 20/20 => Loss 0.438, Loss_clf 0.251, Loss_aux 0.187, Train_accy 92.72:  95%|█████████▌| 19/20 [42:05<01:59, 119.71s/it]
Task 3, Epoch 20/20 => Loss 0.438, Loss_clf 0.251, Loss_aux 0.187, Train_accy 92.72: 100%|██████████| 20/20 [42:05<00:00, 116.44s/it]
Task 3, Epoch 20/20 => Loss 0.438, Loss_clf 0.251, Loss_aux 0.187, Train_accy 92.72: 100%|██████████| 20/20 [42:05<00:00, 126.26s/it]
2024-09-06 00:52:34,787 [der.py] => Task 3, Epoch 20/20 => Loss 0.438, Loss_clf 0.251, Loss_aux 0.187, Train_accy 92.72
2024-09-06 00:52:34,789 [base.py] => Reducing exemplars...(25 per classes)
2024-09-06 00:53:10,457 [base.py] => Constructing exemplars...(25 per classes)
2024-09-06 00:57:09,852 [der.py] => Exemplar size: 2000
2024-09-06 00:57:09,853 [trainer.py] => CNN: {'total': 84.9, '00-49': 85.3, '50-59': 70.4, '60-69': 86.7, '70-79': 95.6, 'old': 83.37, 'new': 95.6}
2024-09-06 00:57:09,853 [trainer.py] => NME: {'total': 88.26, '00-49': 88.64, '50-59': 80.4, '60-69': 90.4, '70-79': 92.1, 'old': 87.71, 'new': 92.1}
2024-09-06 00:57:09,853 [trainer.py] => CNN top1 curve: [92.32, 90.05, 89.06, 84.9]
2024-09-06 00:57:09,853 [trainer.py] => CNN top5 curve: [99.22, 98.93, 98.67, 97.9]
2024-09-06 00:57:09,853 [trainer.py] => NME top1 curve: [92.82, 92.35, 90.83, 88.26]
2024-09-06 00:57:09,853 [trainer.py] => NME top5 curve: [99.46, 99.3, 99.27, 98.94]

Average Accuracy (CNN): 89.08
Average Accuracy (NME): 91.06
2024-09-06 00:57:09,853 [trainer.py] => Average Accuracy (CNN): 89.08
2024-09-06 00:57:09,853 [trainer.py] => Average Accuracy (NME): 91.06
2024-09-06 00:57:09,856 [trainer.py] => All params: 343448923
2024-09-06 00:57:09,858 [trainer.py] => Trainable params: 86052955
2024-09-06 00:57:11,516 [der.py] => Learning on 80-90
2024-09-06 00:57:11,523 [der.py] => All params: 429347429
2024-09-06 00:57:11,525 [der.py] => Trainable params: 86152805

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.697, Loss_clf 1.055, Loss_aux 0.642, Train_accy 79.57, Test_accy 81.22:   0%|          | 0/20 [04:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.697, Loss_clf 1.055, Loss_aux 0.642, Train_accy 79.57, Test_accy 81.22:   5%|▌         | 1/20 [04:09<1:19:09, 249.99s/it]
Task 4, Epoch 2/20 => Loss 0.746, Loss_clf 0.405, Loss_aux 0.341, Train_accy 88.11:   5%|▌         | 1/20 [06:18<1:19:09, 249.99s/it]                 
Task 4, Epoch 2/20 => Loss 0.746, Loss_clf 0.405, Loss_aux 0.341, Train_accy 88.11:  10%|█         | 2/20 [06:18<53:28, 178.25s/it]  
Task 4, Epoch 3/20 => Loss 0.690, Loss_clf 0.379, Loss_aux 0.311, Train_accy 89.30:  10%|█         | 2/20 [08:26<53:28, 178.25s/it]
Task 4, Epoch 3/20 => Loss 0.690, Loss_clf 0.379, Loss_aux 0.311, Train_accy 89.30:  15%|█▌        | 3/20 [08:26<44:00, 155.35s/it]
Task 4, Epoch 4/20 => Loss 0.626, Loss_clf 0.344, Loss_aux 0.282, Train_accy 90.23:  15%|█▌        | 3/20 [10:34<44:00, 155.35s/it]
Task 4, Epoch 4/20 => Loss 0.626, Loss_clf 0.344, Loss_aux 0.282, Train_accy 90.23:  20%|██        | 4/20 [10:34<38:33, 144.62s/it]
Task 4, Epoch 5/20 => Loss 0.578, Loss_clf 0.315, Loss_aux 0.263, Train_accy 90.73:  20%|██        | 4/20 [12:42<38:33, 144.62s/it]
Task 4, Epoch 5/20 => Loss 0.578, Loss_clf 0.315, Loss_aux 0.263, Train_accy 90.73:  25%|██▌       | 5/20 [12:42<34:40, 138.70s/it]
Task 4, Epoch 6/20 => Loss 0.565, Loss_clf 0.308, Loss_aux 0.256, Train_accy 91.16, Test_accy 82.78:  25%|██▌       | 5/20 [16:52<34:40, 138.70s/it]
Task 4, Epoch 6/20 => Loss 0.565, Loss_clf 0.308, Loss_aux 0.256, Train_accy 91.16, Test_accy 82.78:  30%|███       | 6/20 [16:52<41:11, 176.53s/it]
Task 4, Epoch 7/20 => Loss 0.556, Loss_clf 0.311, Loss_aux 0.245, Train_accy 91.16:  30%|███       | 6/20 [19:00<41:11, 176.53s/it]                 
Task 4, Epoch 7/20 => Loss 0.556, Loss_clf 0.311, Loss_aux 0.245, Train_accy 91.16:  35%|███▌      | 7/20 [19:00<34:49, 160.70s/it]
Task 4, Epoch 8/20 => Loss 0.549, Loss_clf 0.306, Loss_aux 0.243, Train_accy 91.41:  35%|███▌      | 7/20 [21:08<34:49, 160.70s/it]
Task 4, Epoch 8/20 => Loss 0.549, Loss_clf 0.306, Loss_aux 0.243, Train_accy 91.41:  40%|████      | 8/20 [21:08<30:03, 150.31s/it]
Task 4, Epoch 9/20 => Loss 0.524, Loss_clf 0.287, Loss_aux 0.238, Train_accy 92.01:  40%|████      | 8/20 [23:16<30:03, 150.31s/it]
Task 4, Epoch 9/20 => Loss 0.524, Loss_clf 0.287, Loss_aux 0.238, Train_accy 92.01:  45%|████▌     | 9/20 [23:16<26:16, 143.36s/it]
Task 4, Epoch 10/20 => Loss 0.515, Loss_clf 0.285, Loss_aux 0.229, Train_accy 91.96:  45%|████▌     | 9/20 [25:24<26:16, 143.36s/it]
Task 4, Epoch 10/20 => Loss 0.515, Loss_clf 0.285, Loss_aux 0.229, Train_accy 91.96:  50%|█████     | 10/20 [25:24<23:06, 138.63s/it]
Task 4, Epoch 11/20 => Loss 0.517, Loss_clf 0.292, Loss_aux 0.225, Train_accy 91.70, Test_accy 83.13:  50%|█████     | 10/20 [29:34<23:06, 138.63s/it]
Task 4, Epoch 11/20 => Loss 0.517, Loss_clf 0.292, Loss_aux 0.225, Train_accy 91.70, Test_accy 83.13:  55%|█████▌    | 11/20 [29:34<25:54, 172.73s/it]
Task 4, Epoch 12/20 => Loss 0.487, Loss_clf 0.277, Loss_aux 0.211, Train_accy 92.33:  55%|█████▌    | 11/20 [31:42<25:54, 172.73s/it]                 
Task 4, Epoch 12/20 => Loss 0.487, Loss_clf 0.277, Loss_aux 0.211, Train_accy 92.33:  60%|██████    | 12/20 [31:42<21:12, 159.10s/it]
Task 4, Epoch 13/20 => Loss 0.487, Loss_clf 0.277, Loss_aux 0.210, Train_accy 92.29:  60%|██████    | 12/20 [33:50<21:12, 159.10s/it]
Task 4, Epoch 13/20 => Loss 0.487, Loss_clf 0.277, Loss_aux 0.210, Train_accy 92.29:  65%|██████▌   | 13/20 [33:50<17:27, 149.69s/it]
Task 4, Epoch 14/20 => Loss 0.472, Loss_clf 0.260, Loss_aux 0.212, Train_accy 92.64:  65%|██████▌   | 13/20 [35:58<17:27, 149.69s/it]
Task 4, Epoch 14/20 => Loss 0.472, Loss_clf 0.260, Loss_aux 0.212, Train_accy 92.64:  70%|███████   | 14/20 [35:58<14:19, 143.21s/it]
Task 4, Epoch 15/20 => Loss 0.491, Loss_clf 0.280, Loss_aux 0.210, Train_accy 92.30:  70%|███████   | 14/20 [38:07<14:19, 143.21s/it]
Task 4, Epoch 15/20 => Loss 0.491, Loss_clf 0.280, Loss_aux 0.210, Train_accy 92.30:  75%|███████▌  | 15/20 [38:07<11:33, 138.65s/it]
Task 4, Epoch 16/20 => Loss 0.479, Loss_clf 0.268, Loss_aux 0.212, Train_accy 92.37, Test_accy 82.57:  75%|███████▌  | 15/20 [42:17<11:33, 138.65s/it]
Task 4, Epoch 16/20 => Loss 0.479, Loss_clf 0.268, Loss_aux 0.212, Train_accy 92.37, Test_accy 82.57:  80%|████████  | 16/20 [42:17<11:28, 172.15s/it]
Task 4, Epoch 17/20 => Loss 0.450, Loss_clf 0.252, Loss_aux 0.198, Train_accy 92.81:  80%|████████  | 16/20 [44:25<11:28, 172.15s/it]                 
Task 4, Epoch 17/20 => Loss 0.450, Loss_clf 0.252, Loss_aux 0.198, Train_accy 92.81:  85%|████████▌ | 17/20 [44:25<07:56, 158.88s/it]
Task 4, Epoch 18/20 => Loss 0.444, Loss_clf 0.246, Loss_aux 0.198, Train_accy 92.76:  85%|████████▌ | 17/20 [46:33<07:56, 158.88s/it]
Task 4, Epoch 18/20 => Loss 0.444, Loss_clf 0.246, Loss_aux 0.198, Train_accy 92.76:  90%|█████████ | 18/20 [46:33<04:59, 149.61s/it]
Task 4, Epoch 19/20 => Loss 0.416, Loss_clf 0.235, Loss_aux 0.182, Train_accy 93.27:  90%|█████████ | 18/20 [48:41<04:59, 149.61s/it]
Task 4, Epoch 19/20 => Loss 0.416, Loss_clf 0.235, Loss_aux 0.182, Train_accy 93.27:  95%|█████████▌| 19/20 [48:41<02:23, 143.15s/it]
Task 4, Epoch 20/20 => Loss 0.430, Loss_clf 0.243, Loss_aux 0.187, Train_accy 93.13:  95%|█████████▌| 19/20 [50:49<02:23, 143.15s/it]
Task 4, Epoch 20/20 => Loss 0.430, Loss_clf 0.243, Loss_aux 0.187, Train_accy 93.13: 100%|██████████| 20/20 [50:49<00:00, 138.60s/it]
Task 4, Epoch 20/20 => Loss 0.430, Loss_clf 0.243, Loss_aux 0.187, Train_accy 93.13: 100%|██████████| 20/20 [50:49<00:00, 152.46s/it]
2024-09-06 01:48:00,875 [der.py] => Task 4, Epoch 20/20 => Loss 0.430, Loss_clf 0.243, Loss_aux 0.187, Train_accy 93.13
2024-09-06 01:48:00,876 [base.py] => Reducing exemplars...(22 per classes)
2024-09-06 01:48:43,995 [base.py] => Constructing exemplars...(22 per classes)
2024-09-06 01:54:05,875 [der.py] => Exemplar size: 1980
2024-09-06 01:54:05,875 [trainer.py] => CNN: {'total': 82.82, '00-49': 81.14, '50-59': 74.8, '60-69': 83.3, '70-79': 84.9, '80-89': 96.7, 'old': 81.09, 'new': 96.7}
2024-09-06 01:54:05,875 [trainer.py] => NME: {'total': 86.4, '00-49': 85.84, '50-59': 79.3, '60-69': 88.7, '70-79': 90.3, '80-89': 90.1, 'old': 85.94, 'new': 90.1}
2024-09-06 01:54:05,876 [trainer.py] => CNN top1 curve: [92.32, 90.05, 89.06, 84.9, 82.82]
2024-09-06 01:54:05,876 [trainer.py] => CNN top5 curve: [99.22, 98.93, 98.67, 97.9, 97.23]
2024-09-06 01:54:05,876 [trainer.py] => NME top1 curve: [92.82, 92.35, 90.83, 88.26, 86.4]
2024-09-06 01:54:05,876 [trainer.py] => NME top5 curve: [99.46, 99.3, 99.27, 98.94, 98.44]

Average Accuracy (CNN): 87.83
Average Accuracy (NME): 90.13
2024-09-06 01:54:05,876 [trainer.py] => Average Accuracy (CNN): 87.83
2024-09-06 01:54:05,876 [trainer.py] => Average Accuracy (NME): 90.13
2024-09-06 01:54:05,878 [trainer.py] => All params: 429347429
2024-09-06 01:54:05,881 [trainer.py] => Trainable params: 86152805
2024-09-06 01:54:07,321 [der.py] => Learning on 90-100
2024-09-06 01:54:07,326 [der.py] => All params: 515261295
2024-09-06 01:54:07,329 [der.py] => Trainable params: 86268015

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.798, Loss_clf 1.139, Loss_aux 0.659, Train_accy 79.17, Test_accy 80.97:   0%|          | 0/20 [05:08<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.798, Loss_clf 1.139, Loss_aux 0.659, Train_accy 79.17, Test_accy 80.97:   5%|▌         | 1/20 [05:08<1:37:35, 308.17s/it]
Task 5, Epoch 2/20 => Loss 0.796, Loss_clf 0.439, Loss_aux 0.357, Train_accy 87.64:   5%|▌         | 1/20 [07:34<1:37:35, 308.17s/it]                 
Task 5, Epoch 2/20 => Loss 0.796, Loss_clf 0.439, Loss_aux 0.357, Train_accy 87.64:  10%|█         | 2/20 [07:34<1:03:56, 213.15s/it]
Task 5, Epoch 3/20 => Loss 0.679, Loss_clf 0.376, Loss_aux 0.303, Train_accy 89.46:  10%|█         | 2/20 [10:01<1:03:56, 213.15s/it]
Task 5, Epoch 3/20 => Loss 0.679, Loss_clf 0.376, Loss_aux 0.303, Train_accy 89.46:  15%|█▌        | 3/20 [10:01<51:47, 182.77s/it]  
Task 5, Epoch 4/20 => Loss 0.632, Loss_clf 0.342, Loss_aux 0.291, Train_accy 90.20:  15%|█▌        | 3/20 [12:27<51:47, 182.77s/it]
Task 5, Epoch 4/20 => Loss 0.632, Loss_clf 0.342, Loss_aux 0.291, Train_accy 90.20:  20%|██        | 4/20 [12:27<44:55, 168.46s/it]
Task 5, Epoch 5/20 => Loss 0.592, Loss_clf 0.331, Loss_aux 0.261, Train_accy 90.43:  20%|██        | 4/20 [14:54<44:55, 168.46s/it]
Task 5, Epoch 5/20 => Loss 0.592, Loss_clf 0.331, Loss_aux 0.261, Train_accy 90.43:  25%|██▌       | 5/20 [14:54<40:09, 160.60s/it]
Task 5, Epoch 6/20 => Loss 0.557, Loss_clf 0.307, Loss_aux 0.250, Train_accy 90.86, Test_accy 81.34:  25%|██▌       | 5/20 [20:03<40:09, 160.60s/it]
Task 5, Epoch 6/20 => Loss 0.557, Loss_clf 0.307, Loss_aux 0.250, Train_accy 90.86, Test_accy 81.34:  30%|███       | 6/20 [20:03<49:13, 210.93s/it]
Task 5, Epoch 7/20 => Loss 0.581, Loss_clf 0.322, Loss_aux 0.259, Train_accy 90.87:  30%|███       | 6/20 [22:29<49:13, 210.93s/it]                 
Task 5, Epoch 7/20 => Loss 0.581, Loss_clf 0.322, Loss_aux 0.259, Train_accy 90.87:  35%|███▌      | 7/20 [22:29<41:08, 189.91s/it]
Task 5, Epoch 8/20 => Loss 0.564, Loss_clf 0.311, Loss_aux 0.252, Train_accy 91.03:  35%|███▌      | 7/20 [24:56<41:08, 189.91s/it]
Task 5, Epoch 8/20 => Loss 0.564, Loss_clf 0.311, Loss_aux 0.252, Train_accy 91.03:  40%|████      | 8/20 [24:56<35:13, 176.16s/it]
Task 5, Epoch 9/20 => Loss 0.541, Loss_clf 0.302, Loss_aux 0.239, Train_accy 91.39:  40%|████      | 8/20 [27:23<35:13, 176.16s/it]
Task 5, Epoch 9/20 => Loss 0.541, Loss_clf 0.302, Loss_aux 0.239, Train_accy 91.39:  45%|████▌     | 9/20 [27:23<30:36, 166.93s/it]
Task 5, Epoch 10/20 => Loss 0.463, Loss_clf 0.257, Loss_aux 0.206, Train_accy 92.56:  45%|████▌     | 9/20 [29:49<30:36, 166.93s/it]
Task 5, Epoch 10/20 => Loss 0.463, Loss_clf 0.257, Loss_aux 0.206, Train_accy 92.56:  50%|█████     | 10/20 [29:49<26:46, 160.63s/it]
Task 5, Epoch 11/20 => Loss 0.497, Loss_clf 0.284, Loss_aux 0.213, Train_accy 91.96, Test_accy 81.33:  50%|█████     | 10/20 [34:58<26:46, 160.63s/it]
Task 5, Epoch 11/20 => Loss 0.497, Loss_clf 0.284, Loss_aux 0.213, Train_accy 91.96, Test_accy 81.33:  55%|█████▌    | 11/20 [34:58<30:52, 205.86s/it]
Task 5, Epoch 12/20 => Loss 0.506, Loss_clf 0.287, Loss_aux 0.219, Train_accy 91.82:  55%|█████▌    | 11/20 [37:24<30:52, 205.86s/it]                 
Task 5, Epoch 12/20 => Loss 0.506, Loss_clf 0.287, Loss_aux 0.219, Train_accy 91.82:  60%|██████    | 12/20 [37:24<25:02, 187.82s/it]
Task 5, Epoch 13/20 => Loss 0.480, Loss_clf 0.264, Loss_aux 0.216, Train_accy 92.54:  60%|██████    | 12/20 [39:51<25:02, 187.82s/it]
Task 5, Epoch 13/20 => Loss 0.480, Loss_clf 0.264, Loss_aux 0.216, Train_accy 92.54:  65%|██████▌   | 13/20 [39:51<20:27, 175.38s/it]
Task 5, Epoch 14/20 => Loss 0.493, Loss_clf 0.277, Loss_aux 0.216, Train_accy 92.45:  65%|██████▌   | 13/20 [42:18<20:27, 175.38s/it]
Task 5, Epoch 14/20 => Loss 0.493, Loss_clf 0.277, Loss_aux 0.216, Train_accy 92.45:  70%|███████   | 14/20 [42:18<16:40, 166.67s/it]
Task 5, Epoch 15/20 => Loss 0.438, Loss_clf 0.251, Loss_aux 0.188, Train_accy 92.88:  70%|███████   | 14/20 [44:44<16:40, 166.67s/it]
Task 5, Epoch 15/20 => Loss 0.438, Loss_clf 0.251, Loss_aux 0.188, Train_accy 92.88:  75%|███████▌  | 15/20 [44:44<13:23, 160.61s/it]
Task 5, Epoch 16/20 => Loss 0.482, Loss_clf 0.279, Loss_aux 0.203, Train_accy 92.19, Test_accy 80.93:  75%|███████▌  | 15/20 [49:53<13:23, 160.61s/it]
Task 5, Epoch 16/20 => Loss 0.482, Loss_clf 0.279, Loss_aux 0.203, Train_accy 92.19, Test_accy 80.93:  80%|████████  | 16/20 [49:53<13:41, 205.25s/it]
Task 5, Epoch 17/20 => Loss 0.444, Loss_clf 0.253, Loss_aux 0.191, Train_accy 92.66:  80%|████████  | 16/20 [52:20<13:41, 205.25s/it]                 
Task 5, Epoch 17/20 => Loss 0.444, Loss_clf 0.253, Loss_aux 0.191, Train_accy 92.66:  85%|████████▌ | 17/20 [52:20<09:22, 187.63s/it]
Task 5, Epoch 18/20 => Loss 0.461, Loss_clf 0.265, Loss_aux 0.196, Train_accy 92.58:  85%|████████▌ | 17/20 [54:46<09:22, 187.63s/it]
Task 5, Epoch 18/20 => Loss 0.461, Loss_clf 0.265, Loss_aux 0.196, Train_accy 92.58:  90%|█████████ | 18/20 [54:46<05:50, 175.29s/it]
Task 5, Epoch 19/20 => Loss 0.461, Loss_clf 0.261, Loss_aux 0.200, Train_accy 92.71:  90%|█████████ | 18/20 [57:13<05:50, 175.29s/it]
Task 5, Epoch 19/20 => Loss 0.461, Loss_clf 0.261, Loss_aux 0.200, Train_accy 92.71:  95%|█████████▌| 19/20 [57:13<02:46, 166.67s/it]
Task 5, Epoch 20/20 => Loss 0.427, Loss_clf 0.242, Loss_aux 0.185, Train_accy 92.85:  95%|█████████▌| 19/20 [59:39<02:46, 166.67s/it]
Task 5, Epoch 20/20 => Loss 0.427, Loss_clf 0.242, Loss_aux 0.185, Train_accy 92.85: 100%|██████████| 20/20 [59:39<00:00, 160.64s/it]
Task 5, Epoch 20/20 => Loss 0.427, Loss_clf 0.242, Loss_aux 0.185, Train_accy 92.85: 100%|██████████| 20/20 [59:39<00:00, 179.00s/it]
2024-09-06 02:53:47,371 [der.py] => Task 5, Epoch 20/20 => Loss 0.427, Loss_clf 0.242, Loss_aux 0.185, Train_accy 92.85
2024-09-06 02:53:47,373 [base.py] => Reducing exemplars...(20 per classes)
2024-09-06 02:54:38,950 [base.py] => Constructing exemplars...(20 per classes)
2024-09-06 03:01:37,407 [der.py] => Exemplar size: 2000
2024-09-06 03:01:37,407 [trainer.py] => CNN: {'total': 81.83, '00-49': 79.66, '50-59': 68.9, '60-69': 82.6, '70-79': 82.6, '80-89': 89.4, '90-99': 96.5, 'old': 80.2, 'new': 96.5}
2024-09-06 03:01:37,407 [trainer.py] => NME: {'total': 85.6, '00-49': 84.52, '50-59': 76.7, '60-69': 88.1, '70-79': 88.1, '80-89': 91.9, '90-99': 88.6, 'old': 85.27, 'new': 88.6}
2024-09-06 03:01:37,407 [trainer.py] => CNN top1 curve: [92.32, 90.05, 89.06, 84.9, 82.82, 81.83]
2024-09-06 03:01:37,407 [trainer.py] => CNN top5 curve: [99.22, 98.93, 98.67, 97.9, 97.23, 96.34]
2024-09-06 03:01:37,407 [trainer.py] => NME top1 curve: [92.82, 92.35, 90.83, 88.26, 86.4, 85.6]
2024-09-06 03:01:37,407 [trainer.py] => NME top5 curve: [99.46, 99.3, 99.27, 98.94, 98.44, 98.09]

Average Accuracy (CNN): 86.83
Average Accuracy (NME): 89.38
2024-09-06 03:01:37,407 [trainer.py] => Average Accuracy (CNN): 86.83
2024-09-06 03:01:37,407 [trainer.py] => Average Accuracy (NME): 89.38
Accuracy Matrix (CNN):
[[92.32 88.84 88.88 85.3  81.14 79.66]
 [ 0.   96.1  80.9  70.4  74.8  68.9 ]
 [ 0.    0.   98.1  86.7  83.3  82.6 ]
 [ 0.    0.    0.   95.6  84.9  82.6 ]
 [ 0.    0.    0.    0.   96.7  89.4 ]
 [ 0.    0.    0.    0.    0.   96.5 ]]
2024-09-06 03:01:37,408 [trainer.py] => Forgetting (CNN): 15.131999999999996
Accuracy Matrix (NME):
[[92.82 92.   90.68 88.64 85.84 84.52]
 [ 0.   94.1  87.8  80.4  79.3  76.7 ]
 [ 0.    0.   94.6  90.4  88.7  88.1 ]
 [ 0.    0.    0.   92.1  90.3  88.1 ]
 [ 0.    0.    0.    0.   90.1  91.9 ]
 [ 0.    0.    0.    0.    0.   88.6 ]]
2024-09-06 03:01:37,409 [trainer.py] => Forgetting (NME): 7.2399999999999975
2024-09-06 03:01:40,254 [trainer.py] => config: ./exps/der_cifar_B50_Inc10.json
2024-09-06 03:01:40,255 [trainer.py] => prefix: reproduce
2024-09-06 03:01:40,255 [trainer.py] => dataset: cifar224
2024-09-06 03:01:40,255 [trainer.py] => memory_size: 2000
2024-09-06 03:01:40,255 [trainer.py] => memory_per_class: 20
2024-09-06 03:01:40,255 [trainer.py] => fixed_memory: False
2024-09-06 03:01:40,255 [trainer.py] => shuffle: True
2024-09-06 03:01:40,255 [trainer.py] => init_cls: 50
2024-09-06 03:01:40,255 [trainer.py] => increment: 5
2024-09-06 03:01:40,255 [trainer.py] => model_name: der
2024-09-06 03:01:40,255 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-06 03:01:40,255 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-06 03:01:40,255 [trainer.py] => seed: 1993
2024-09-06 03:01:40,255 [trainer.py] => init_epoch: 20
2024-09-06 03:01:40,255 [trainer.py] => init_lr: 0.001
2024-09-06 03:01:40,255 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-06 03:01:40,255 [trainer.py] => init_lr_decay: 0.1
2024-09-06 03:01:40,255 [trainer.py] => init_weight_decay: 0.0005
2024-09-06 03:01:40,255 [trainer.py] => epochs: 20
2024-09-06 03:01:40,255 [trainer.py] => lrate: 0.001
2024-09-06 03:01:40,255 [trainer.py] => milestones: [80, 120, 150]
2024-09-06 03:01:40,255 [trainer.py] => lrate_decay: 0.1
2024-09-06 03:01:40,255 [trainer.py] => batch_size: 48
2024-09-06 03:01:40,255 [trainer.py] => weight_decay: 0.0002
2024-09-06 03:01:40,255 [trainer.py] => T: 2
2024-09-06 03:01:41,392 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-06 03:01:41,800 [trainer.py] => All params: 0
2024-09-06 03:01:41,800 [trainer.py] => Trainable params: 0
2024-09-06 03:01:43,370 [der.py] => Learning on 0-50
2024-09-06 03:01:43,371 [der.py] => All params: 85876325
2024-09-06 03:01:43,371 [der.py] => Trainable params: 85876325

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.956, Train_accy 24.74, Test_accy 85.50:   0%|          | 0/20 [03:24<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.956, Train_accy 24.74, Test_accy 85.50:   5%|▌         | 1/20 [03:24<1:04:46, 204.54s/it]
Task 0, Epoch 2/20 => Loss 0.910, Train_accy 74.52:   5%|▌         | 1/20 [06:35<1:04:46, 204.54s/it]                 
Task 0, Epoch 2/20 => Loss 0.910, Train_accy 74.52:  10%|█         | 2/20 [06:35<58:55, 196.44s/it]  
Task 0, Epoch 3/20 => Loss 0.723, Train_accy 79.49:  10%|█         | 2/20 [09:45<58:55, 196.44s/it]
Task 0, Epoch 3/20 => Loss 0.723, Train_accy 79.49:  15%|█▌        | 3/20 [09:45<54:52, 193.67s/it]
Task 0, Epoch 4/20 => Loss 0.644, Train_accy 81.89:  15%|█▌        | 3/20 [12:56<54:52, 193.67s/it]
Task 0, Epoch 4/20 => Loss 0.644, Train_accy 81.89:  20%|██        | 4/20 [12:56<51:17, 192.37s/it]
Task 0, Epoch 5/20 => Loss 0.588, Train_accy 83.09:  20%|██        | 4/20 [16:06<51:17, 192.37s/it]
Task 0, Epoch 5/20 => Loss 0.588, Train_accy 83.09:  25%|██▌       | 5/20 [16:06<47:54, 191.65s/it]
Task 0, Epoch 6/20 => Loss 0.552, Train_accy 84.48, Test_accy 93.00:  25%|██▌       | 5/20 [19:31<47:54, 191.65s/it]
Task 0, Epoch 6/20 => Loss 0.552, Train_accy 84.48, Test_accy 93.00:  30%|███       | 6/20 [19:31<45:46, 196.15s/it]
Task 0, Epoch 7/20 => Loss 0.522, Train_accy 85.20:  30%|███       | 6/20 [22:41<45:46, 196.15s/it]                 
Task 0, Epoch 7/20 => Loss 0.522, Train_accy 85.20:  35%|███▌      | 7/20 [22:41<42:05, 194.30s/it]
Task 0, Epoch 8/20 => Loss 0.496, Train_accy 86.02:  35%|███▌      | 7/20 [25:52<42:05, 194.30s/it]
Task 0, Epoch 8/20 => Loss 0.496, Train_accy 86.02:  40%|████      | 8/20 [25:52<38:36, 193.04s/it]
Task 0, Epoch 9/20 => Loss 0.479, Train_accy 86.48:  40%|████      | 8/20 [29:03<38:36, 193.04s/it]
Task 0, Epoch 9/20 => Loss 0.479, Train_accy 86.48:  45%|████▌     | 9/20 [29:03<35:16, 192.43s/it]
Task 0, Epoch 10/20 => Loss 0.459, Train_accy 86.90:  45%|████▌     | 9/20 [32:14<35:16, 192.43s/it]
Task 0, Epoch 10/20 => Loss 0.459, Train_accy 86.90:  50%|█████     | 10/20 [32:14<32:01, 192.14s/it]
Task 0, Epoch 11/20 => Loss 0.452, Train_accy 87.06, Test_accy 93.40:  50%|█████     | 10/20 [35:40<32:01, 192.14s/it]
Task 0, Epoch 11/20 => Loss 0.452, Train_accy 87.06, Test_accy 93.40:  55%|█████▌    | 11/20 [35:40<29:26, 196.30s/it]
Task 0, Epoch 12/20 => Loss 0.431, Train_accy 88.07:  55%|█████▌    | 11/20 [38:51<29:26, 196.30s/it]                 
Task 0, Epoch 12/20 => Loss 0.431, Train_accy 88.07:  60%|██████    | 12/20 [38:51<25:57, 194.71s/it]
Task 0, Epoch 13/20 => Loss 0.435, Train_accy 87.68:  60%|██████    | 12/20 [42:03<25:57, 194.71s/it]
Task 0, Epoch 13/20 => Loss 0.435, Train_accy 87.68:  65%|██████▌   | 13/20 [42:03<22:36, 193.77s/it]
Task 0, Epoch 14/20 => Loss 0.417, Train_accy 88.19:  65%|██████▌   | 13/20 [45:14<22:36, 193.77s/it]
Task 0, Epoch 14/20 => Loss 0.417, Train_accy 88.19:  70%|███████   | 14/20 [45:14<19:17, 192.97s/it]
Task 0, Epoch 15/20 => Loss 0.406, Train_accy 88.52:  70%|███████   | 14/20 [48:25<19:17, 192.97s/it]
Task 0, Epoch 15/20 => Loss 0.406, Train_accy 88.52:  75%|███████▌  | 15/20 [48:25<16:02, 192.53s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.92, Test_accy 92.32:  75%|███████▌  | 15/20 [51:52<16:02, 192.53s/it]
Task 0, Epoch 16/20 => Loss 0.390, Train_accy 88.92, Test_accy 92.32:  80%|████████  | 16/20 [51:52<13:07, 196.88s/it]
Task 0, Epoch 17/20 => Loss 0.374, Train_accy 89.39:  80%|████████  | 16/20 [55:04<13:07, 196.88s/it]                 
Task 0, Epoch 17/20 => Loss 0.374, Train_accy 89.39:  85%|████████▌ | 17/20 [55:04<09:45, 195.21s/it]
Task 0, Epoch 18/20 => Loss 0.376, Train_accy 89.44:  85%|████████▌ | 17/20 [58:15<09:45, 195.21s/it]
Task 0, Epoch 18/20 => Loss 0.376, Train_accy 89.44:  90%|█████████ | 18/20 [58:15<06:28, 194.04s/it]
Task 0, Epoch 19/20 => Loss 0.372, Train_accy 89.52:  90%|█████████ | 18/20 [1:01:26<06:28, 194.04s/it]
Task 0, Epoch 19/20 => Loss 0.372, Train_accy 89.52:  95%|█████████▌| 19/20 [1:01:26<03:13, 193.10s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55:  95%|█████████▌| 19/20 [1:04:37<03:13, 193.10s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55: 100%|██████████| 20/20 [1:04:37<00:00, 192.61s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55: 100%|██████████| 20/20 [1:04:37<00:00, 193.89s/it]
2024-09-06 04:06:21,680 [der.py] => Task 0, Epoch 20/20 => Loss 0.366, Train_accy 89.55
2024-09-06 04:06:21,681 [base.py] => Reducing exemplars...(40 per classes)
2024-09-06 04:06:21,682 [base.py] => Constructing exemplars...(40 per classes)
2024-09-06 04:08:35,360 [der.py] => Exemplar size: 2000
2024-09-06 04:08:35,360 [trainer.py] => CNN: {'total': 92.32, '00-49': 92.32, 'old': 0, 'new': 92.32}
2024-09-06 04:08:35,360 [trainer.py] => NME: {'total': 92.82, '00-49': 92.82, 'old': 0, 'new': 92.82}
2024-09-06 04:08:35,360 [trainer.py] => CNN top1 curve: [92.32]
2024-09-06 04:08:35,360 [trainer.py] => CNN top5 curve: [99.22]
2024-09-06 04:08:35,360 [trainer.py] => NME top1 curve: [92.82]
2024-09-06 04:08:35,360 [trainer.py] => NME top5 curve: [99.46]

Average Accuracy (CNN): 92.32
Average Accuracy (NME): 92.82
2024-09-06 04:08:35,361 [trainer.py] => Average Accuracy (CNN): 92.32
2024-09-06 04:08:35,361 [trainer.py] => Average Accuracy (NME): 92.82
2024-09-06 04:08:35,361 [trainer.py] => All params: 85876325
2024-09-06 04:08:35,362 [trainer.py] => Trainable params: 85876325
2024-09-06 04:08:36,912 [der.py] => Learning on 50-55
2024-09-06 04:08:36,913 [der.py] => All params: 171686461
2024-09-06 04:08:36,914 [der.py] => Trainable params: 85887805

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.360, Loss_clf 0.855, Loss_aux 0.505, Train_accy 82.11, Test_accy 90.51:   0%|          | 0/20 [01:17<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.360, Loss_clf 0.855, Loss_aux 0.505, Train_accy 82.11, Test_accy 90.51:   5%|▌         | 1/20 [01:17<24:29, 77.33s/it]
Task 1, Epoch 2/20 => Loss 0.575, Loss_clf 0.351, Loss_aux 0.224, Train_accy 89.69:   5%|▌         | 1/20 [02:03<24:29, 77.33s/it]                 
Task 1, Epoch 2/20 => Loss 0.575, Loss_clf 0.351, Loss_aux 0.224, Train_accy 89.69:  10%|█         | 2/20 [02:03<17:46, 59.22s/it]
Task 1, Epoch 3/20 => Loss 0.549, Loss_clf 0.336, Loss_aux 0.213, Train_accy 90.13:  10%|█         | 2/20 [02:50<17:46, 59.22s/it]
Task 1, Epoch 3/20 => Loss 0.549, Loss_clf 0.336, Loss_aux 0.213, Train_accy 90.13:  15%|█▌        | 3/20 [02:50<15:08, 53.42s/it]
Task 1, Epoch 4/20 => Loss 0.510, Loss_clf 0.322, Loss_aux 0.188, Train_accy 90.96:  15%|█▌        | 3/20 [03:36<15:08, 53.42s/it]
Task 1, Epoch 4/20 => Loss 0.510, Loss_clf 0.322, Loss_aux 0.188, Train_accy 90.96:  20%|██        | 4/20 [03:36<13:31, 50.69s/it]
Task 1, Epoch 5/20 => Loss 0.484, Loss_clf 0.300, Loss_aux 0.183, Train_accy 91.00:  20%|██        | 4/20 [04:23<13:31, 50.69s/it]
Task 1, Epoch 5/20 => Loss 0.484, Loss_clf 0.300, Loss_aux 0.183, Train_accy 91.00:  25%|██▌       | 5/20 [04:23<12:17, 49.17s/it]
Task 1, Epoch 6/20 => Loss 0.480, Loss_clf 0.314, Loss_aux 0.165, Train_accy 90.82, Test_accy 90.55:  25%|██▌       | 5/20 [05:40<12:17, 49.17s/it]
Task 1, Epoch 6/20 => Loss 0.480, Loss_clf 0.314, Loss_aux 0.165, Train_accy 90.82, Test_accy 90.55:  30%|███       | 6/20 [05:40<13:41, 58.65s/it]
Task 1, Epoch 7/20 => Loss 0.477, Loss_clf 0.296, Loss_aux 0.181, Train_accy 91.38:  30%|███       | 6/20 [06:26<13:41, 58.65s/it]                 
Task 1, Epoch 7/20 => Loss 0.477, Loss_clf 0.296, Loss_aux 0.181, Train_accy 91.38:  35%|███▌      | 7/20 [06:26<11:50, 54.68s/it]
Task 1, Epoch 8/20 => Loss 0.461, Loss_clf 0.296, Loss_aux 0.165, Train_accy 91.73:  35%|███▌      | 7/20 [07:13<11:50, 54.68s/it]
Task 1, Epoch 8/20 => Loss 0.461, Loss_clf 0.296, Loss_aux 0.165, Train_accy 91.73:  40%|████      | 8/20 [07:13<10:24, 52.07s/it]
Task 1, Epoch 9/20 => Loss 0.424, Loss_clf 0.278, Loss_aux 0.146, Train_accy 91.98:  40%|████      | 8/20 [07:59<10:24, 52.07s/it]
Task 1, Epoch 9/20 => Loss 0.424, Loss_clf 0.278, Loss_aux 0.146, Train_accy 91.98:  45%|████▌     | 9/20 [07:59<09:13, 50.32s/it]
Task 1, Epoch 10/20 => Loss 0.464, Loss_clf 0.289, Loss_aux 0.175, Train_accy 91.69:  45%|████▌     | 9/20 [08:46<09:13, 50.32s/it]
Task 1, Epoch 10/20 => Loss 0.464, Loss_clf 0.289, Loss_aux 0.175, Train_accy 91.69:  50%|█████     | 10/20 [08:46<08:11, 49.13s/it]
Task 1, Epoch 11/20 => Loss 0.489, Loss_clf 0.313, Loss_aux 0.176, Train_accy 90.91, Test_accy 90.82:  50%|█████     | 10/20 [10:03<08:11, 49.13s/it]
Task 1, Epoch 11/20 => Loss 0.489, Loss_clf 0.313, Loss_aux 0.176, Train_accy 90.91, Test_accy 90.82:  55%|█████▌    | 11/20 [10:03<08:39, 57.69s/it]
Task 1, Epoch 12/20 => Loss 0.393, Loss_clf 0.259, Loss_aux 0.134, Train_accy 93.13:  55%|█████▌    | 11/20 [10:50<08:39, 57.69s/it]                 
Task 1, Epoch 12/20 => Loss 0.393, Loss_clf 0.259, Loss_aux 0.134, Train_accy 93.13:  60%|██████    | 12/20 [10:50<07:14, 54.30s/it]
Task 1, Epoch 13/20 => Loss 0.407, Loss_clf 0.268, Loss_aux 0.139, Train_accy 92.42:  60%|██████    | 12/20 [11:36<07:14, 54.30s/it]
Task 1, Epoch 13/20 => Loss 0.407, Loss_clf 0.268, Loss_aux 0.139, Train_accy 92.42:  65%|██████▌   | 13/20 [11:36<06:03, 51.94s/it]
Task 1, Epoch 14/20 => Loss 0.394, Loss_clf 0.258, Loss_aux 0.137, Train_accy 92.67:  65%|██████▌   | 13/20 [12:23<06:03, 51.94s/it]
Task 1, Epoch 14/20 => Loss 0.394, Loss_clf 0.258, Loss_aux 0.137, Train_accy 92.67:  70%|███████   | 14/20 [12:23<05:01, 50.32s/it]
Task 1, Epoch 15/20 => Loss 0.407, Loss_clf 0.261, Loss_aux 0.146, Train_accy 92.96:  70%|███████   | 14/20 [13:09<05:01, 50.32s/it]
Task 1, Epoch 15/20 => Loss 0.407, Loss_clf 0.261, Loss_aux 0.146, Train_accy 92.96:  75%|███████▌  | 15/20 [13:09<04:05, 49.17s/it]
Task 1, Epoch 16/20 => Loss 0.372, Loss_clf 0.243, Loss_aux 0.129, Train_accy 93.02, Test_accy 90.33:  75%|███████▌  | 15/20 [14:26<04:05, 49.17s/it]
Task 1, Epoch 16/20 => Loss 0.372, Loss_clf 0.243, Loss_aux 0.129, Train_accy 93.02, Test_accy 90.33:  80%|████████  | 16/20 [14:26<03:50, 57.65s/it]
Task 1, Epoch 17/20 => Loss 0.374, Loss_clf 0.249, Loss_aux 0.125, Train_accy 93.09:  80%|████████  | 16/20 [15:13<03:50, 57.65s/it]                 
Task 1, Epoch 17/20 => Loss 0.374, Loss_clf 0.249, Loss_aux 0.125, Train_accy 93.09:  85%|████████▌ | 17/20 [15:13<02:42, 54.31s/it]
Task 1, Epoch 18/20 => Loss 0.366, Loss_clf 0.244, Loss_aux 0.121, Train_accy 93.13:  85%|████████▌ | 17/20 [16:00<02:42, 54.31s/it]
Task 1, Epoch 18/20 => Loss 0.366, Loss_clf 0.244, Loss_aux 0.121, Train_accy 93.13:  90%|█████████ | 18/20 [16:00<01:43, 51.99s/it]
Task 1, Epoch 19/20 => Loss 0.359, Loss_clf 0.242, Loss_aux 0.117, Train_accy 93.16:  90%|█████████ | 18/20 [16:46<01:43, 51.99s/it]
Task 1, Epoch 19/20 => Loss 0.359, Loss_clf 0.242, Loss_aux 0.117, Train_accy 93.16:  95%|█████████▌| 19/20 [16:46<00:50, 50.35s/it]
Task 1, Epoch 20/20 => Loss 0.378, Loss_clf 0.247, Loss_aux 0.132, Train_accy 92.93:  95%|█████████▌| 19/20 [17:33<00:50, 50.35s/it]
Task 1, Epoch 20/20 => Loss 0.378, Loss_clf 0.247, Loss_aux 0.132, Train_accy 92.93: 100%|██████████| 20/20 [17:33<00:00, 49.19s/it]
Task 1, Epoch 20/20 => Loss 0.378, Loss_clf 0.247, Loss_aux 0.132, Train_accy 92.93: 100%|██████████| 20/20 [17:33<00:00, 52.66s/it]
2024-09-06 04:26:10,120 [der.py] => Task 1, Epoch 20/20 => Loss 0.378, Loss_clf 0.247, Loss_aux 0.132, Train_accy 92.93
2024-09-06 04:26:10,122 [base.py] => Reducing exemplars...(36 per classes)
2024-09-06 04:26:31,368 [base.py] => Constructing exemplars...(36 per classes)
2024-09-06 04:27:50,881 [der.py] => Exemplar size: 1980
2024-09-06 04:27:50,881 [trainer.py] => CNN: {'total': 90.02, '00-49': 89.24, '50-54': 97.8, 'old': 89.24, 'new': 97.8}
2024-09-06 04:27:50,881 [trainer.py] => NME: {'total': 91.89, '00-49': 91.72, '50-54': 93.6, 'old': 91.72, 'new': 93.6}
2024-09-06 04:27:50,881 [trainer.py] => CNN top1 curve: [92.32, 90.02]
2024-09-06 04:27:50,881 [trainer.py] => CNN top5 curve: [99.22, 99.05]
2024-09-06 04:27:50,881 [trainer.py] => NME top1 curve: [92.82, 91.89]
2024-09-06 04:27:50,881 [trainer.py] => NME top5 curve: [99.46, 99.33]

Average Accuracy (CNN): 91.17
Average Accuracy (NME): 92.35
2024-09-06 04:27:50,881 [trainer.py] => Average Accuracy (CNN): 91.17
2024-09-06 04:27:50,881 [trainer.py] => Average Accuracy (NME): 92.35
2024-09-06 04:27:50,882 [trainer.py] => All params: 171686461
2024-09-06 04:27:50,883 [trainer.py] => Trainable params: 85887805
2024-09-06 04:27:52,263 [der.py] => Learning on 55-60
2024-09-06 04:27:52,265 [der.py] => All params: 257538882
2024-09-06 04:27:52,266 [der.py] => Trainable params: 85941570

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.464, Loss_clf 0.924, Loss_aux 0.540, Train_accy 77.92, Test_accy 90.10:   0%|          | 0/20 [01:47<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.464, Loss_clf 0.924, Loss_aux 0.540, Train_accy 77.92, Test_accy 90.10:   5%|▌         | 1/20 [01:47<34:09, 107.86s/it]
Task 2, Epoch 2/20 => Loss 0.680, Loss_clf 0.395, Loss_aux 0.285, Train_accy 87.81:   5%|▌         | 1/20 [02:46<34:09, 107.86s/it]                 
Task 2, Epoch 2/20 => Loss 0.680, Loss_clf 0.395, Loss_aux 0.285, Train_accy 87.81:  10%|█         | 2/20 [02:46<23:39, 78.85s/it] 
Task 2, Epoch 3/20 => Loss 0.614, Loss_clf 0.360, Loss_aux 0.255, Train_accy 89.00:  10%|█         | 2/20 [03:44<23:39, 78.85s/it]
Task 2, Epoch 3/20 => Loss 0.614, Loss_clf 0.360, Loss_aux 0.255, Train_accy 89.00:  15%|█▌        | 3/20 [03:44<19:41, 69.49s/it]
Task 2, Epoch 4/20 => Loss 0.611, Loss_clf 0.368, Loss_aux 0.243, Train_accy 89.49:  15%|█▌        | 3/20 [04:43<19:41, 69.49s/it]
Task 2, Epoch 4/20 => Loss 0.611, Loss_clf 0.368, Loss_aux 0.243, Train_accy 89.49:  20%|██        | 4/20 [04:43<17:21, 65.09s/it]
Task 2, Epoch 5/20 => Loss 0.538, Loss_clf 0.325, Loss_aux 0.213, Train_accy 90.42:  20%|██        | 4/20 [05:41<17:21, 65.09s/it]
Task 2, Epoch 5/20 => Loss 0.538, Loss_clf 0.325, Loss_aux 0.213, Train_accy 90.42:  25%|██▌       | 5/20 [05:41<15:39, 62.64s/it]
Task 2, Epoch 6/20 => Loss 0.602, Loss_clf 0.360, Loss_aux 0.242, Train_accy 89.26, Test_accy 90.37:  25%|██▌       | 5/20 [07:28<15:39, 62.64s/it]
Task 2, Epoch 6/20 => Loss 0.602, Loss_clf 0.360, Loss_aux 0.242, Train_accy 89.26, Test_accy 90.37:  30%|███       | 6/20 [07:28<18:10, 77.89s/it]
Task 2, Epoch 7/20 => Loss 0.528, Loss_clf 0.322, Loss_aux 0.206, Train_accy 90.62:  30%|███       | 6/20 [08:27<18:10, 77.89s/it]                 
Task 2, Epoch 7/20 => Loss 0.528, Loss_clf 0.322, Loss_aux 0.206, Train_accy 90.62:  35%|███▌      | 7/20 [08:27<15:29, 71.46s/it]
Task 2, Epoch 8/20 => Loss 0.532, Loss_clf 0.320, Loss_aux 0.212, Train_accy 90.18:  35%|███▌      | 7/20 [09:25<15:29, 71.46s/it]
Task 2, Epoch 8/20 => Loss 0.532, Loss_clf 0.320, Loss_aux 0.212, Train_accy 90.18:  40%|████      | 8/20 [09:25<13:27, 67.27s/it]
Task 2, Epoch 9/20 => Loss 0.519, Loss_clf 0.308, Loss_aux 0.211, Train_accy 90.98:  40%|████      | 8/20 [10:23<13:27, 67.27s/it]
Task 2, Epoch 9/20 => Loss 0.519, Loss_clf 0.308, Loss_aux 0.211, Train_accy 90.98:  45%|████▌     | 9/20 [10:23<11:48, 64.45s/it]
Task 2, Epoch 10/20 => Loss 0.480, Loss_clf 0.302, Loss_aux 0.179, Train_accy 91.09:  45%|████▌     | 9/20 [11:21<11:48, 64.45s/it]
Task 2, Epoch 10/20 => Loss 0.480, Loss_clf 0.302, Loss_aux 0.179, Train_accy 91.09:  50%|█████     | 10/20 [11:21<10:25, 62.53s/it]
Task 2, Epoch 11/20 => Loss 0.480, Loss_clf 0.286, Loss_aux 0.193, Train_accy 91.38, Test_accy 90.12:  50%|█████     | 10/20 [13:09<10:25, 62.53s/it]
Task 2, Epoch 11/20 => Loss 0.480, Loss_clf 0.286, Loss_aux 0.193, Train_accy 91.38, Test_accy 90.12:  55%|█████▌    | 11/20 [13:09<11:26, 76.30s/it]
Task 2, Epoch 12/20 => Loss 0.470, Loss_clf 0.282, Loss_aux 0.188, Train_accy 91.12:  55%|█████▌    | 11/20 [14:07<11:26, 76.30s/it]                 
Task 2, Epoch 12/20 => Loss 0.470, Loss_clf 0.282, Loss_aux 0.188, Train_accy 91.12:  60%|██████    | 12/20 [14:07<09:26, 70.81s/it]
Task 2, Epoch 13/20 => Loss 0.494, Loss_clf 0.301, Loss_aux 0.194, Train_accy 91.43:  60%|██████    | 12/20 [15:05<09:26, 70.81s/it]
Task 2, Epoch 13/20 => Loss 0.494, Loss_clf 0.301, Loss_aux 0.194, Train_accy 91.43:  65%|██████▌   | 13/20 [15:05<07:49, 67.01s/it]
Task 2, Epoch 14/20 => Loss 0.461, Loss_clf 0.285, Loss_aux 0.176, Train_accy 91.50:  65%|██████▌   | 13/20 [16:04<07:49, 67.01s/it]
Task 2, Epoch 14/20 => Loss 0.461, Loss_clf 0.285, Loss_aux 0.176, Train_accy 91.50:  70%|███████   | 14/20 [16:04<06:26, 64.36s/it]
Task 2, Epoch 15/20 => Loss 0.458, Loss_clf 0.285, Loss_aux 0.174, Train_accy 91.81:  70%|███████   | 14/20 [17:02<06:26, 64.36s/it]
Task 2, Epoch 15/20 => Loss 0.458, Loss_clf 0.285, Loss_aux 0.174, Train_accy 91.81:  75%|███████▌  | 15/20 [17:02<05:12, 62.53s/it]
Task 2, Epoch 16/20 => Loss 0.454, Loss_clf 0.279, Loss_aux 0.174, Train_accy 91.61, Test_accy 91.12:  75%|███████▌  | 15/20 [18:50<05:12, 62.53s/it]
Task 2, Epoch 16/20 => Loss 0.454, Loss_clf 0.279, Loss_aux 0.174, Train_accy 91.61, Test_accy 91.12:  80%|████████  | 16/20 [18:50<05:04, 76.10s/it]
Task 2, Epoch 17/20 => Loss 0.452, Loss_clf 0.280, Loss_aux 0.172, Train_accy 91.90:  80%|████████  | 16/20 [19:48<05:04, 76.10s/it]                 
Task 2, Epoch 17/20 => Loss 0.452, Loss_clf 0.280, Loss_aux 0.172, Train_accy 91.90:  85%|████████▌ | 17/20 [19:48<03:32, 70.74s/it]
Task 2, Epoch 18/20 => Loss 0.421, Loss_clf 0.261, Loss_aux 0.160, Train_accy 92.19:  85%|████████▌ | 17/20 [20:46<03:32, 70.74s/it]
Task 2, Epoch 18/20 => Loss 0.421, Loss_clf 0.261, Loss_aux 0.160, Train_accy 92.19:  90%|█████████ | 18/20 [20:46<02:13, 66.99s/it]
Task 2, Epoch 19/20 => Loss 0.415, Loss_clf 0.266, Loss_aux 0.149, Train_accy 92.03:  90%|█████████ | 18/20 [21:44<02:13, 66.99s/it]
Task 2, Epoch 19/20 => Loss 0.415, Loss_clf 0.266, Loss_aux 0.149, Train_accy 92.03:  95%|█████████▌| 19/20 [21:44<01:04, 64.36s/it]
Task 2, Epoch 20/20 => Loss 0.455, Loss_clf 0.282, Loss_aux 0.174, Train_accy 91.32:  95%|█████████▌| 19/20 [22:43<01:04, 64.36s/it]
Task 2, Epoch 20/20 => Loss 0.455, Loss_clf 0.282, Loss_aux 0.174, Train_accy 91.32: 100%|██████████| 20/20 [22:43<00:00, 62.52s/it]
Task 2, Epoch 20/20 => Loss 0.455, Loss_clf 0.282, Loss_aux 0.174, Train_accy 91.32: 100%|██████████| 20/20 [22:43<00:00, 68.15s/it]
2024-09-06 04:50:35,444 [der.py] => Task 2, Epoch 20/20 => Loss 0.455, Loss_clf 0.282, Loss_aux 0.174, Train_accy 91.32
2024-09-06 04:50:35,445 [base.py] => Reducing exemplars...(33 per classes)
2024-09-06 04:51:03,277 [base.py] => Constructing exemplars...(33 per classes)
2024-09-06 04:53:07,406 [der.py] => Exemplar size: 1980
2024-09-06 04:53:07,406 [trainer.py] => CNN: {'total': 90.23, '00-49': 89.32, '50-54': 93.8, '55-59': 95.8, 'old': 89.73, 'new': 95.8}
2024-09-06 04:53:07,406 [trainer.py] => NME: {'total': 91.75, '00-49': 91.06, '50-54': 96.0, '55-59': 94.4, 'old': 91.51, 'new': 94.4}
2024-09-06 04:53:07,406 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23]
2024-09-06 04:53:07,406 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72]
2024-09-06 04:53:07,406 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75]
2024-09-06 04:53:07,406 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33]

Average Accuracy (CNN): 90.86
Average Accuracy (NME): 92.15
2024-09-06 04:53:07,406 [trainer.py] => Average Accuracy (CNN): 90.86
2024-09-06 04:53:07,407 [trainer.py] => Average Accuracy (NME): 92.15
2024-09-06 04:53:07,408 [trainer.py] => All params: 257538882
2024-09-06 04:53:07,410 [trainer.py] => Trainable params: 85941570
2024-09-06 04:53:08,834 [der.py] => Learning on 60-65
2024-09-06 04:53:08,838 [der.py] => All params: 343398983
2024-09-06 04:53:08,839 [der.py] => Trainable params: 86003015

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.370, Loss_clf 0.918, Loss_aux 0.452, Train_accy 82.92, Test_accy 87.91:   0%|          | 0/20 [02:20<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.370, Loss_clf 0.918, Loss_aux 0.452, Train_accy 82.92, Test_accy 87.91:   5%|▌         | 1/20 [02:20<44:37, 140.93s/it]
Task 3, Epoch 2/20 => Loss 0.535, Loss_clf 0.327, Loss_aux 0.209, Train_accy 90.38:   5%|▌         | 1/20 [03:31<44:37, 140.93s/it]                 
Task 3, Epoch 2/20 => Loss 0.535, Loss_clf 0.327, Loss_aux 0.209, Train_accy 90.38:  10%|█         | 2/20 [03:31<29:47, 99.30s/it] 
Task 3, Epoch 3/20 => Loss 0.480, Loss_clf 0.307, Loss_aux 0.174, Train_accy 91.34:  10%|█         | 2/20 [04:41<29:47, 99.30s/it]
Task 3, Epoch 3/20 => Loss 0.480, Loss_clf 0.307, Loss_aux 0.174, Train_accy 91.34:  15%|█▌        | 3/20 [04:41<24:21, 85.97s/it]
Task 3, Epoch 4/20 => Loss 0.442, Loss_clf 0.271, Loss_aux 0.172, Train_accy 92.03:  15%|█▌        | 3/20 [05:51<24:21, 85.97s/it]
Task 3, Epoch 4/20 => Loss 0.442, Loss_clf 0.271, Loss_aux 0.172, Train_accy 92.03:  20%|██        | 4/20 [05:51<21:15, 79.72s/it]
Task 3, Epoch 5/20 => Loss 0.445, Loss_clf 0.282, Loss_aux 0.163, Train_accy 91.61:  20%|██        | 4/20 [07:01<21:15, 79.72s/it]
Task 3, Epoch 5/20 => Loss 0.445, Loss_clf 0.282, Loss_aux 0.163, Train_accy 91.61:  25%|██▌       | 5/20 [07:01<19:04, 76.29s/it]
Task 3, Epoch 6/20 => Loss 0.449, Loss_clf 0.283, Loss_aux 0.166, Train_accy 91.94, Test_accy 88.75:  25%|██▌       | 5/20 [09:22<19:04, 76.29s/it]
Task 3, Epoch 6/20 => Loss 0.449, Loss_clf 0.283, Loss_aux 0.166, Train_accy 91.94, Test_accy 88.75:  30%|███       | 6/20 [09:22<22:55, 98.26s/it]
Task 3, Epoch 7/20 => Loss 0.417, Loss_clf 0.275, Loss_aux 0.143, Train_accy 92.19:  30%|███       | 6/20 [10:32<22:55, 98.26s/it]                 
Task 3, Epoch 7/20 => Loss 0.417, Loss_clf 0.275, Loss_aux 0.143, Train_accy 92.19:  35%|███▌      | 7/20 [10:32<19:17, 89.06s/it]
Task 3, Epoch 8/20 => Loss 0.426, Loss_clf 0.274, Loss_aux 0.152, Train_accy 92.32:  35%|███▌      | 7/20 [11:42<19:17, 89.06s/it]
Task 3, Epoch 8/20 => Loss 0.426, Loss_clf 0.274, Loss_aux 0.152, Train_accy 92.32:  40%|████      | 8/20 [11:42<16:36, 83.03s/it]
Task 3, Epoch 9/20 => Loss 0.399, Loss_clf 0.261, Loss_aux 0.139, Train_accy 92.68:  40%|████      | 8/20 [12:52<16:36, 83.03s/it]
Task 3, Epoch 9/20 => Loss 0.399, Loss_clf 0.261, Loss_aux 0.139, Train_accy 92.68:  45%|████▌     | 9/20 [12:52<14:29, 79.02s/it]
Task 3, Epoch 10/20 => Loss 0.387, Loss_clf 0.250, Loss_aux 0.137, Train_accy 93.01:  45%|████▌     | 9/20 [14:03<14:29, 79.02s/it]
Task 3, Epoch 10/20 => Loss 0.387, Loss_clf 0.250, Loss_aux 0.137, Train_accy 93.01:  50%|█████     | 10/20 [14:03<12:42, 76.28s/it]
Task 3, Epoch 11/20 => Loss 0.404, Loss_clf 0.261, Loss_aux 0.143, Train_accy 92.72, Test_accy 89.72:  50%|█████     | 10/20 [16:23<12:42, 76.28s/it]
Task 3, Epoch 11/20 => Loss 0.404, Loss_clf 0.261, Loss_aux 0.143, Train_accy 92.72, Test_accy 89.72:  55%|█████▌    | 11/20 [16:23<14:24, 96.06s/it]
Task 3, Epoch 12/20 => Loss 0.407, Loss_clf 0.265, Loss_aux 0.142, Train_accy 92.23:  55%|█████▌    | 11/20 [17:34<14:24, 96.06s/it]                 
Task 3, Epoch 12/20 => Loss 0.407, Loss_clf 0.265, Loss_aux 0.142, Train_accy 92.23:  60%|██████    | 12/20 [17:34<11:45, 88.17s/it]
Task 3, Epoch 13/20 => Loss 0.355, Loss_clf 0.227, Loss_aux 0.128, Train_accy 93.66:  60%|██████    | 12/20 [18:44<11:45, 88.17s/it]
Task 3, Epoch 13/20 => Loss 0.355, Loss_clf 0.227, Loss_aux 0.128, Train_accy 93.66:  65%|██████▌   | 13/20 [18:44<09:39, 82.72s/it]
Task 3, Epoch 14/20 => Loss 0.338, Loss_clf 0.226, Loss_aux 0.111, Train_accy 93.39:  65%|██████▌   | 13/20 [19:54<09:39, 82.72s/it]
Task 3, Epoch 14/20 => Loss 0.338, Loss_clf 0.226, Loss_aux 0.111, Train_accy 93.39:  70%|███████   | 14/20 [19:54<07:53, 78.93s/it]
Task 3, Epoch 15/20 => Loss 0.374, Loss_clf 0.241, Loss_aux 0.133, Train_accy 93.57:  70%|███████   | 14/20 [21:04<07:53, 78.93s/it]
Task 3, Epoch 15/20 => Loss 0.374, Loss_clf 0.241, Loss_aux 0.133, Train_accy 93.57:  75%|███████▌  | 15/20 [21:04<06:21, 76.28s/it]
Task 3, Epoch 16/20 => Loss 0.370, Loss_clf 0.246, Loss_aux 0.124, Train_accy 93.44, Test_accy 89.35:  75%|███████▌  | 15/20 [23:25<06:21, 76.28s/it]
Task 3, Epoch 16/20 => Loss 0.370, Loss_clf 0.246, Loss_aux 0.124, Train_accy 93.44, Test_accy 89.35:  80%|████████  | 16/20 [23:25<06:22, 95.74s/it]
Task 3, Epoch 17/20 => Loss 0.359, Loss_clf 0.227, Loss_aux 0.132, Train_accy 93.26:  80%|████████  | 16/20 [24:35<06:22, 95.74s/it]                 
Task 3, Epoch 17/20 => Loss 0.359, Loss_clf 0.227, Loss_aux 0.132, Train_accy 93.26:  85%|████████▌ | 17/20 [24:35<04:24, 88.04s/it]
Task 3, Epoch 18/20 => Loss 0.374, Loss_clf 0.242, Loss_aux 0.133, Train_accy 93.46:  85%|████████▌ | 17/20 [25:45<04:24, 88.04s/it]
Task 3, Epoch 18/20 => Loss 0.374, Loss_clf 0.242, Loss_aux 0.133, Train_accy 93.46:  90%|█████████ | 18/20 [25:45<02:45, 82.67s/it]
Task 3, Epoch 19/20 => Loss 0.317, Loss_clf 0.220, Loss_aux 0.097, Train_accy 93.68:  90%|█████████ | 18/20 [26:55<02:45, 82.67s/it]
Task 3, Epoch 19/20 => Loss 0.317, Loss_clf 0.220, Loss_aux 0.097, Train_accy 93.68:  95%|█████████▌| 19/20 [26:55<01:18, 78.91s/it]
Task 3, Epoch 20/20 => Loss 0.350, Loss_clf 0.227, Loss_aux 0.123, Train_accy 93.68:  95%|█████████▌| 19/20 [28:06<01:18, 78.91s/it]
Task 3, Epoch 20/20 => Loss 0.350, Loss_clf 0.227, Loss_aux 0.123, Train_accy 93.68: 100%|██████████| 20/20 [28:06<00:00, 76.29s/it]
Task 3, Epoch 20/20 => Loss 0.350, Loss_clf 0.227, Loss_aux 0.123, Train_accy 93.68: 100%|██████████| 20/20 [28:06<00:00, 84.31s/it]
2024-09-06 05:21:15,043 [der.py] => Task 3, Epoch 20/20 => Loss 0.350, Loss_clf 0.227, Loss_aux 0.123, Train_accy 93.68
2024-09-06 05:21:15,045 [base.py] => Reducing exemplars...(30 per classes)
2024-09-06 05:21:48,487 [base.py] => Constructing exemplars...(30 per classes)
2024-09-06 05:24:43,349 [der.py] => Exemplar size: 1950
2024-09-06 05:24:43,349 [trainer.py] => CNN: {'total': 89.92, '00-49': 89.84, '50-54': 92.8, '55-59': 81.4, '60-64': 96.4, 'old': 89.38, 'new': 96.4}
2024-09-06 05:24:43,349 [trainer.py] => NME: {'total': 90.83, '00-49': 90.64, '50-54': 95.2, '55-59': 88.0, '60-64': 91.2, 'old': 90.8, 'new': 91.2}
2024-09-06 05:24:43,349 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92]
2024-09-06 05:24:43,349 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66]
2024-09-06 05:24:43,349 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83]
2024-09-06 05:24:43,349 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22]

Average Accuracy (CNN): 90.62
Average Accuracy (NME): 91.82
2024-09-06 05:24:43,349 [trainer.py] => Average Accuracy (CNN): 90.62
2024-09-06 05:24:43,349 [trainer.py] => Average Accuracy (NME): 91.82
2024-09-06 05:24:43,352 [trainer.py] => All params: 343398983
2024-09-06 05:24:43,353 [trainer.py] => Trainable params: 86003015
2024-09-06 05:24:44,743 [der.py] => Learning on 65-70
2024-09-06 05:24:44,747 [der.py] => All params: 429266764
2024-09-06 05:24:44,749 [der.py] => Trainable params: 86072140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.332, Loss_clf 0.914, Loss_aux 0.418, Train_accy 84.09, Test_accy 87.10:   0%|          | 0/20 [02:56<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.332, Loss_clf 0.914, Loss_aux 0.418, Train_accy 84.09, Test_accy 87.10:   5%|▌         | 1/20 [02:56<55:51, 176.42s/it]
Task 4, Epoch 2/20 => Loss 0.489, Loss_clf 0.306, Loss_aux 0.183, Train_accy 91.35:   5%|▌         | 1/20 [04:17<55:51, 176.42s/it]                 
Task 4, Epoch 2/20 => Loss 0.489, Loss_clf 0.306, Loss_aux 0.183, Train_accy 91.35:  10%|█         | 2/20 [04:17<36:10, 120.60s/it]
Task 4, Epoch 3/20 => Loss 0.457, Loss_clf 0.288, Loss_aux 0.169, Train_accy 92.11:  10%|█         | 2/20 [05:39<36:10, 120.60s/it]
Task 4, Epoch 3/20 => Loss 0.457, Loss_clf 0.288, Loss_aux 0.169, Train_accy 92.11:  15%|█▌        | 3/20 [05:39<29:06, 102.76s/it]
Task 4, Epoch 4/20 => Loss 0.425, Loss_clf 0.257, Loss_aux 0.168, Train_accy 92.72:  15%|█▌        | 3/20 [07:00<29:06, 102.76s/it]
Task 4, Epoch 4/20 => Loss 0.425, Loss_clf 0.257, Loss_aux 0.168, Train_accy 92.72:  20%|██        | 4/20 [07:00<25:09, 94.37s/it] 
Task 4, Epoch 5/20 => Loss 0.406, Loss_clf 0.259, Loss_aux 0.147, Train_accy 93.08:  20%|██        | 4/20 [08:22<25:09, 94.37s/it]
Task 4, Epoch 5/20 => Loss 0.406, Loss_clf 0.259, Loss_aux 0.147, Train_accy 93.08:  25%|██▌       | 5/20 [08:22<22:25, 89.72s/it]
Task 4, Epoch 6/20 => Loss 0.367, Loss_clf 0.231, Loss_aux 0.136, Train_accy 93.53, Test_accy 87.60:  25%|██▌       | 5/20 [11:18<22:25, 89.72s/it]
Task 4, Epoch 6/20 => Loss 0.367, Loss_clf 0.231, Loss_aux 0.136, Train_accy 93.53, Test_accy 87.60:  30%|███       | 6/20 [11:18<27:48, 119.21s/it]
Task 4, Epoch 7/20 => Loss 0.362, Loss_clf 0.234, Loss_aux 0.129, Train_accy 93.87:  30%|███       | 6/20 [12:40<27:48, 119.21s/it]                 
Task 4, Epoch 7/20 => Loss 0.362, Loss_clf 0.234, Loss_aux 0.129, Train_accy 93.87:  35%|███▌      | 7/20 [12:40<23:09, 106.88s/it]
Task 4, Epoch 8/20 => Loss 0.383, Loss_clf 0.246, Loss_aux 0.136, Train_accy 93.01:  35%|███▌      | 7/20 [14:01<23:09, 106.88s/it]
Task 4, Epoch 8/20 => Loss 0.383, Loss_clf 0.246, Loss_aux 0.136, Train_accy 93.01:  40%|████      | 8/20 [14:01<19:45, 98.79s/it] 
Task 4, Epoch 9/20 => Loss 0.355, Loss_clf 0.229, Loss_aux 0.126, Train_accy 93.69:  40%|████      | 8/20 [15:23<19:45, 98.79s/it]
Task 4, Epoch 9/20 => Loss 0.355, Loss_clf 0.229, Loss_aux 0.126, Train_accy 93.69:  45%|████▌     | 9/20 [15:23<17:07, 93.39s/it]
Task 4, Epoch 10/20 => Loss 0.389, Loss_clf 0.251, Loss_aux 0.138, Train_accy 93.51:  45%|████▌     | 9/20 [16:44<17:07, 93.39s/it]
Task 4, Epoch 10/20 => Loss 0.389, Loss_clf 0.251, Loss_aux 0.138, Train_accy 93.51:  50%|█████     | 10/20 [16:44<14:57, 89.71s/it]
Task 4, Epoch 11/20 => Loss 0.352, Loss_clf 0.230, Loss_aux 0.122, Train_accy 93.33, Test_accy 88.10:  50%|█████     | 10/20 [19:41<14:57, 89.71s/it]
Task 4, Epoch 11/20 => Loss 0.352, Loss_clf 0.230, Loss_aux 0.122, Train_accy 93.33, Test_accy 88.10:  55%|█████▌    | 11/20 [19:41<17:26, 116.33s/it]
Task 4, Epoch 12/20 => Loss 0.371, Loss_clf 0.246, Loss_aux 0.124, Train_accy 93.26:  55%|█████▌    | 11/20 [21:03<17:26, 116.33s/it]                 
Task 4, Epoch 12/20 => Loss 0.371, Loss_clf 0.246, Loss_aux 0.124, Train_accy 93.26:  60%|██████    | 12/20 [21:03<14:06, 105.77s/it]
Task 4, Epoch 13/20 => Loss 0.369, Loss_clf 0.244, Loss_aux 0.125, Train_accy 92.94:  60%|██████    | 12/20 [22:24<14:06, 105.77s/it]
Task 4, Epoch 13/20 => Loss 0.369, Loss_clf 0.244, Loss_aux 0.125, Train_accy 92.94:  65%|██████▌   | 13/20 [22:24<11:29, 98.44s/it] 
Task 4, Epoch 14/20 => Loss 0.339, Loss_clf 0.224, Loss_aux 0.114, Train_accy 93.98:  65%|██████▌   | 13/20 [23:46<11:29, 98.44s/it]
Task 4, Epoch 14/20 => Loss 0.339, Loss_clf 0.224, Loss_aux 0.114, Train_accy 93.98:  70%|███████   | 14/20 [23:46<09:19, 93.33s/it]
Task 4, Epoch 15/20 => Loss 0.359, Loss_clf 0.234, Loss_aux 0.126, Train_accy 94.00:  70%|███████   | 14/20 [25:07<09:19, 93.33s/it]
Task 4, Epoch 15/20 => Loss 0.359, Loss_clf 0.234, Loss_aux 0.126, Train_accy 94.00:  75%|███████▌  | 15/20 [25:07<07:28, 89.76s/it]
Task 4, Epoch 16/20 => Loss 0.331, Loss_clf 0.219, Loss_aux 0.112, Train_accy 94.04, Test_accy 88.43:  75%|███████▌  | 15/20 [28:04<07:28, 89.76s/it]
Task 4, Epoch 16/20 => Loss 0.331, Loss_clf 0.219, Loss_aux 0.112, Train_accy 94.04, Test_accy 88.43:  80%|████████  | 16/20 [28:04<07:43, 115.84s/it]
Task 4, Epoch 17/20 => Loss 0.333, Loss_clf 0.218, Loss_aux 0.115, Train_accy 93.98:  80%|████████  | 16/20 [29:25<07:43, 115.84s/it]                 
Task 4, Epoch 17/20 => Loss 0.333, Loss_clf 0.218, Loss_aux 0.115, Train_accy 93.98:  85%|████████▌ | 17/20 [29:25<05:16, 105.55s/it]
Task 4, Epoch 18/20 => Loss 0.319, Loss_clf 0.209, Loss_aux 0.110, Train_accy 94.02:  85%|████████▌ | 17/20 [30:47<05:16, 105.55s/it]
Task 4, Epoch 18/20 => Loss 0.319, Loss_clf 0.209, Loss_aux 0.110, Train_accy 94.02:  90%|█████████ | 18/20 [30:47<03:16, 98.37s/it] 
Task 4, Epoch 19/20 => Loss 0.347, Loss_clf 0.235, Loss_aux 0.113, Train_accy 94.04:  90%|█████████ | 18/20 [32:08<03:16, 98.37s/it]
Task 4, Epoch 19/20 => Loss 0.347, Loss_clf 0.235, Loss_aux 0.113, Train_accy 94.04:  95%|█████████▌| 19/20 [32:08<01:33, 93.30s/it]
Task 4, Epoch 20/20 => Loss 0.355, Loss_clf 0.237, Loss_aux 0.118, Train_accy 93.57:  95%|█████████▌| 19/20 [33:30<01:33, 93.30s/it]
Task 4, Epoch 20/20 => Loss 0.355, Loss_clf 0.237, Loss_aux 0.118, Train_accy 93.57: 100%|██████████| 20/20 [33:30<00:00, 89.76s/it]
Task 4, Epoch 20/20 => Loss 0.355, Loss_clf 0.237, Loss_aux 0.118, Train_accy 93.57: 100%|██████████| 20/20 [33:30<00:00, 100.52s/it]
2024-09-06 05:58:15,266 [der.py] => Task 4, Epoch 20/20 => Loss 0.355, Loss_clf 0.237, Loss_aux 0.118, Train_accy 93.57
2024-09-06 05:58:15,268 [base.py] => Reducing exemplars...(28 per classes)
2024-09-06 05:58:55,554 [base.py] => Constructing exemplars...(28 per classes)
2024-09-06 06:02:45,817 [der.py] => Exemplar size: 1960
2024-09-06 06:02:45,818 [trainer.py] => CNN: {'total': 88.94, '00-49': 88.72, '50-54': 92.6, '55-59': 74.8, '60-64': 91.2, '65-69': 99.4, 'old': 88.14, 'new': 99.4}
2024-09-06 06:02:45,818 [trainer.py] => NME: {'total': 90.81, '00-49': 90.14, '50-54': 95.0, '55-59': 86.6, '60-64': 92.0, '65-69': 96.4, 'old': 90.38, 'new': 96.4}
2024-09-06 06:02:45,818 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92, 88.94]
2024-09-06 06:02:45,818 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66, 98.56]
2024-09-06 06:02:45,818 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83, 90.81]
2024-09-06 06:02:45,818 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22, 99.09]

Average Accuracy (CNN): 90.29
Average Accuracy (NME): 91.62
2024-09-06 06:02:45,818 [trainer.py] => Average Accuracy (CNN): 90.29
2024-09-06 06:02:45,818 [trainer.py] => Average Accuracy (NME): 91.62
2024-09-06 06:02:45,821 [trainer.py] => All params: 429266764
2024-09-06 06:02:45,823 [trainer.py] => Trainable params: 86072140
2024-09-06 06:02:47,224 [der.py] => Learning on 70-75
2024-09-06 06:02:47,229 [der.py] => All params: 515142225
2024-09-06 06:02:47,231 [der.py] => Trainable params: 86148945

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.526, Loss_clf 1.052, Loss_aux 0.475, Train_accy 83.41, Test_accy 86.13:   0%|          | 0/20 [03:35<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.526, Loss_clf 1.052, Loss_aux 0.475, Train_accy 83.41, Test_accy 86.13:   5%|▌         | 1/20 [03:35<1:08:11, 215.32s/it]
Task 5, Epoch 2/20 => Loss 0.523, Loss_clf 0.317, Loss_aux 0.206, Train_accy 91.12:   5%|▌         | 1/20 [05:09<1:08:11, 215.32s/it]                 
Task 5, Epoch 2/20 => Loss 0.523, Loss_clf 0.317, Loss_aux 0.206, Train_accy 91.12:  10%|█         | 2/20 [05:09<43:08, 143.83s/it]  
Task 5, Epoch 3/20 => Loss 0.488, Loss_clf 0.296, Loss_aux 0.192, Train_accy 91.64:  10%|█         | 2/20 [06:42<43:08, 143.83s/it]
Task 5, Epoch 3/20 => Loss 0.488, Loss_clf 0.296, Loss_aux 0.192, Train_accy 91.64:  15%|█▌        | 3/20 [06:42<34:16, 120.98s/it]
Task 5, Epoch 4/20 => Loss 0.479, Loss_clf 0.293, Loss_aux 0.186, Train_accy 91.64:  15%|█▌        | 3/20 [08:16<34:16, 120.98s/it]
Task 5, Epoch 4/20 => Loss 0.479, Loss_clf 0.293, Loss_aux 0.186, Train_accy 91.64:  20%|██        | 4/20 [08:16<29:23, 110.24s/it]
Task 5, Epoch 5/20 => Loss 0.456, Loss_clf 0.294, Loss_aux 0.162, Train_accy 92.15:  20%|██        | 4/20 [09:50<29:23, 110.24s/it]
Task 5, Epoch 5/20 => Loss 0.456, Loss_clf 0.294, Loss_aux 0.162, Train_accy 92.15:  25%|██▌       | 5/20 [09:50<26:04, 104.29s/it]
Task 5, Epoch 6/20 => Loss 0.426, Loss_clf 0.268, Loss_aux 0.159, Train_accy 92.42, Test_accy 86.45:  25%|██▌       | 5/20 [13:25<26:04, 104.29s/it]
Task 5, Epoch 6/20 => Loss 0.426, Loss_clf 0.268, Loss_aux 0.159, Train_accy 92.42, Test_accy 86.45:  30%|███       | 6/20 [13:25<33:09, 142.08s/it]
Task 5, Epoch 7/20 => Loss 0.424, Loss_clf 0.263, Loss_aux 0.161, Train_accy 92.65:  30%|███       | 6/20 [14:59<33:09, 142.08s/it]                 
Task 5, Epoch 7/20 => Loss 0.424, Loss_clf 0.263, Loss_aux 0.161, Train_accy 92.65:  35%|███▌      | 7/20 [14:59<27:22, 126.33s/it]
Task 5, Epoch 8/20 => Loss 0.406, Loss_clf 0.261, Loss_aux 0.145, Train_accy 92.62:  35%|███▌      | 7/20 [16:33<27:22, 126.33s/it]
Task 5, Epoch 8/20 => Loss 0.406, Loss_clf 0.261, Loss_aux 0.145, Train_accy 92.62:  40%|████      | 8/20 [16:33<23:11, 116.00s/it]
Task 5, Epoch 9/20 => Loss 0.408, Loss_clf 0.253, Loss_aux 0.155, Train_accy 92.69:  40%|████      | 8/20 [18:07<23:11, 116.00s/it]
Task 5, Epoch 9/20 => Loss 0.408, Loss_clf 0.253, Loss_aux 0.155, Train_accy 92.69:  45%|████▌     | 9/20 [18:07<19:59, 109.07s/it]
Task 5, Epoch 10/20 => Loss 0.440, Loss_clf 0.279, Loss_aux 0.160, Train_accy 92.44:  45%|████▌     | 9/20 [19:41<19:59, 109.07s/it]
Task 5, Epoch 10/20 => Loss 0.440, Loss_clf 0.279, Loss_aux 0.160, Train_accy 92.44:  50%|█████     | 10/20 [19:41<17:23, 104.37s/it]
Task 5, Epoch 11/20 => Loss 0.387, Loss_clf 0.247, Loss_aux 0.140, Train_accy 93.14, Test_accy 86.35:  50%|█████     | 10/20 [23:16<17:23, 104.37s/it]
Task 5, Epoch 11/20 => Loss 0.387, Loss_clf 0.247, Loss_aux 0.140, Train_accy 93.14, Test_accy 86.35:  55%|█████▌    | 11/20 [23:16<20:45, 138.42s/it]
Task 5, Epoch 12/20 => Loss 0.395, Loss_clf 0.253, Loss_aux 0.142, Train_accy 92.87:  55%|█████▌    | 11/20 [24:50<20:45, 138.42s/it]                 
Task 5, Epoch 12/20 => Loss 0.395, Loss_clf 0.253, Loss_aux 0.142, Train_accy 92.87:  60%|██████    | 12/20 [24:50<16:38, 124.85s/it]
Task 5, Epoch 13/20 => Loss 0.379, Loss_clf 0.233, Loss_aux 0.146, Train_accy 93.63:  60%|██████    | 12/20 [26:24<16:38, 124.85s/it]
Task 5, Epoch 13/20 => Loss 0.379, Loss_clf 0.233, Loss_aux 0.146, Train_accy 93.63:  65%|██████▌   | 13/20 [26:24<13:28, 115.44s/it]
Task 5, Epoch 14/20 => Loss 0.419, Loss_clf 0.264, Loss_aux 0.155, Train_accy 92.78:  65%|██████▌   | 13/20 [27:58<13:28, 115.44s/it]
Task 5, Epoch 14/20 => Loss 0.419, Loss_clf 0.264, Loss_aux 0.155, Train_accy 92.78:  70%|███████   | 14/20 [27:58<10:53, 108.89s/it]
Task 5, Epoch 15/20 => Loss 0.359, Loss_clf 0.235, Loss_aux 0.124, Train_accy 93.54:  70%|███████   | 14/20 [29:31<10:53, 108.89s/it]
Task 5, Epoch 15/20 => Loss 0.359, Loss_clf 0.235, Loss_aux 0.124, Train_accy 93.54:  75%|███████▌  | 15/20 [29:31<08:41, 104.32s/it]
Task 5, Epoch 16/20 => Loss 0.391, Loss_clf 0.241, Loss_aux 0.150, Train_accy 93.34, Test_accy 87.77:  75%|███████▌  | 15/20 [33:07<08:41, 104.32s/it]
Task 5, Epoch 16/20 => Loss 0.391, Loss_clf 0.241, Loss_aux 0.150, Train_accy 93.34, Test_accy 87.77:  80%|████████  | 16/20 [33:07<09:10, 137.75s/it]
Task 5, Epoch 17/20 => Loss 0.366, Loss_clf 0.233, Loss_aux 0.133, Train_accy 93.43:  80%|████████  | 16/20 [34:41<09:10, 137.75s/it]                 
Task 5, Epoch 17/20 => Loss 0.366, Loss_clf 0.233, Loss_aux 0.133, Train_accy 93.43:  85%|████████▌ | 17/20 [34:41<06:13, 124.53s/it]
Task 5, Epoch 18/20 => Loss 0.389, Loss_clf 0.250, Loss_aux 0.140, Train_accy 93.21:  85%|████████▌ | 17/20 [36:14<06:13, 124.53s/it]
Task 5, Epoch 18/20 => Loss 0.389, Loss_clf 0.250, Loss_aux 0.140, Train_accy 93.21:  90%|█████████ | 18/20 [36:14<03:50, 115.30s/it]
Task 5, Epoch 19/20 => Loss 0.348, Loss_clf 0.225, Loss_aux 0.123, Train_accy 94.10:  90%|█████████ | 18/20 [37:48<03:50, 115.30s/it]
Task 5, Epoch 19/20 => Loss 0.348, Loss_clf 0.225, Loss_aux 0.123, Train_accy 94.10:  95%|█████████▌| 19/20 [37:48<01:48, 108.83s/it]
Task 5, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.74:  95%|█████████▌| 19/20 [39:22<01:48, 108.83s/it]
Task 5, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.74: 100%|██████████| 20/20 [39:22<00:00, 104.30s/it]
Task 5, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.74: 100%|██████████| 20/20 [39:22<00:00, 118.12s/it]
2024-09-06 06:42:09,793 [der.py] => Task 5, Epoch 20/20 => Loss 0.344, Loss_clf 0.225, Loss_aux 0.119, Train_accy 93.74
2024-09-06 06:42:09,794 [base.py] => Reducing exemplars...(26 per classes)
2024-09-06 06:42:57,531 [base.py] => Constructing exemplars...(26 per classes)
2024-09-06 06:47:49,667 [der.py] => Exemplar size: 1950
2024-09-06 06:47:49,667 [trainer.py] => CNN: {'total': 86.83, '00-49': 87.32, '50-54': 91.4, '55-59': 67.0, '60-64': 79.2, '65-69': 93.4, '70-74': 98.2, 'old': 86.01, 'new': 98.2}
2024-09-06 06:47:49,667 [trainer.py] => NME: {'total': 89.52, '00-49': 89.52, '50-54': 94.8, '55-59': 81.0, '60-64': 84.2, '65-69': 95.6, '70-74': 92.0, 'old': 89.34, 'new': 92.0}
2024-09-06 06:47:49,667 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92, 88.94, 86.83]
2024-09-06 06:47:49,667 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66, 98.56, 98.12]
2024-09-06 06:47:49,667 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83, 90.81, 89.52]
2024-09-06 06:47:49,667 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22, 99.09, 98.91]

Average Accuracy (CNN): 89.71
Average Accuracy (NME): 91.27
2024-09-06 06:47:49,667 [trainer.py] => Average Accuracy (CNN): 89.71
2024-09-06 06:47:49,667 [trainer.py] => Average Accuracy (NME): 91.27
2024-09-06 06:47:49,671 [trainer.py] => All params: 515142225
2024-09-06 06:47:49,673 [trainer.py] => Trainable params: 86148945
2024-09-06 06:47:51,201 [der.py] => Learning on 75-80
2024-09-06 06:47:51,208 [der.py] => All params: 601025366
2024-09-06 06:47:51,211 [der.py] => Trainable params: 86233430

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.728, Loss_clf 1.225, Loss_aux 0.503, Train_accy 82.04, Test_accy 82.86:   0%|          | 0/20 [04:16<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.728, Loss_clf 1.225, Loss_aux 0.503, Train_accy 82.04, Test_accy 82.86:   5%|▌         | 1/20 [04:16<1:21:15, 256.59s/it]
Task 6, Epoch 2/20 => Loss 0.605, Loss_clf 0.363, Loss_aux 0.242, Train_accy 89.37:   5%|▌         | 1/20 [06:02<1:21:15, 256.59s/it]                 
Task 6, Epoch 2/20 => Loss 0.605, Loss_clf 0.363, Loss_aux 0.242, Train_accy 89.37:  10%|█         | 2/20 [06:02<50:20, 167.81s/it]  
Task 6, Epoch 3/20 => Loss 0.560, Loss_clf 0.344, Loss_aux 0.216, Train_accy 90.58:  10%|█         | 2/20 [07:47<50:20, 167.81s/it]
Task 6, Epoch 3/20 => Loss 0.560, Loss_clf 0.344, Loss_aux 0.216, Train_accy 90.58:  15%|█▌        | 3/20 [07:47<39:30, 139.45s/it]
Task 6, Epoch 4/20 => Loss 0.547, Loss_clf 0.339, Loss_aux 0.209, Train_accy 90.45:  15%|█▌        | 3/20 [09:33<39:30, 139.45s/it]
Task 6, Epoch 4/20 => Loss 0.547, Loss_clf 0.339, Loss_aux 0.209, Train_accy 90.45:  20%|██        | 4/20 [09:33<33:37, 126.11s/it]
Task 6, Epoch 5/20 => Loss 0.437, Loss_clf 0.271, Loss_aux 0.166, Train_accy 92.22:  20%|██        | 4/20 [11:19<33:37, 126.11s/it]
Task 6, Epoch 5/20 => Loss 0.437, Loss_clf 0.271, Loss_aux 0.166, Train_accy 92.22:  25%|██▌       | 5/20 [11:19<29:40, 118.73s/it]
Task 6, Epoch 6/20 => Loss 0.464, Loss_clf 0.287, Loss_aux 0.176, Train_accy 91.71, Test_accy 84.92:  25%|██▌       | 5/20 [15:36<29:40, 118.73s/it]
Task 6, Epoch 6/20 => Loss 0.464, Loss_clf 0.287, Loss_aux 0.176, Train_accy 91.71, Test_accy 84.92:  30%|███       | 6/20 [15:36<38:39, 165.68s/it]
Task 6, Epoch 7/20 => Loss 0.429, Loss_clf 0.276, Loss_aux 0.153, Train_accy 92.49:  30%|███       | 6/20 [17:21<38:39, 165.68s/it]                 
Task 6, Epoch 7/20 => Loss 0.429, Loss_clf 0.276, Loss_aux 0.153, Train_accy 92.49:  35%|███▌      | 7/20 [17:21<31:38, 146.07s/it]
Task 6, Epoch 8/20 => Loss 0.455, Loss_clf 0.293, Loss_aux 0.162, Train_accy 91.78:  35%|███▌      | 7/20 [19:07<31:38, 146.07s/it]
Task 6, Epoch 8/20 => Loss 0.455, Loss_clf 0.293, Loss_aux 0.162, Train_accy 91.78:  40%|████      | 8/20 [19:07<26:38, 133.21s/it]
Task 6, Epoch 9/20 => Loss 0.439, Loss_clf 0.275, Loss_aux 0.164, Train_accy 92.52:  40%|████      | 8/20 [20:53<26:38, 133.21s/it]
Task 6, Epoch 9/20 => Loss 0.439, Loss_clf 0.275, Loss_aux 0.164, Train_accy 92.52:  45%|████▌     | 9/20 [20:53<22:50, 124.58s/it]
Task 6, Epoch 10/20 => Loss 0.427, Loss_clf 0.273, Loss_aux 0.154, Train_accy 92.29:  45%|████▌     | 9/20 [22:38<22:50, 124.58s/it]
Task 6, Epoch 10/20 => Loss 0.427, Loss_clf 0.273, Loss_aux 0.154, Train_accy 92.29:  50%|█████     | 10/20 [22:38<19:47, 118.72s/it]
Task 6, Epoch 11/20 => Loss 0.449, Loss_clf 0.282, Loss_aux 0.167, Train_accy 92.22, Test_accy 85.22:  50%|█████     | 10/20 [26:55<19:47, 118.72s/it]
Task 6, Epoch 11/20 => Loss 0.449, Loss_clf 0.282, Loss_aux 0.167, Train_accy 92.22, Test_accy 85.22:  55%|█████▌    | 11/20 [26:55<24:08, 160.97s/it]
Task 6, Epoch 12/20 => Loss 0.402, Loss_clf 0.250, Loss_aux 0.152, Train_accy 92.74:  55%|█████▌    | 11/20 [28:41<24:08, 160.97s/it]                 
Task 6, Epoch 12/20 => Loss 0.402, Loss_clf 0.250, Loss_aux 0.152, Train_accy 92.74:  60%|██████    | 12/20 [28:41<19:13, 144.14s/it]
Task 6, Epoch 13/20 => Loss 0.412, Loss_clf 0.261, Loss_aux 0.151, Train_accy 92.81:  60%|██████    | 12/20 [30:26<19:13, 144.14s/it]
Task 6, Epoch 13/20 => Loss 0.412, Loss_clf 0.261, Loss_aux 0.151, Train_accy 92.81:  65%|██████▌   | 13/20 [30:26<15:27, 132.47s/it]
Task 6, Epoch 14/20 => Loss 0.419, Loss_clf 0.262, Loss_aux 0.157, Train_accy 92.76:  65%|██████▌   | 13/20 [32:12<15:27, 132.47s/it]
Task 6, Epoch 14/20 => Loss 0.419, Loss_clf 0.262, Loss_aux 0.157, Train_accy 92.76:  70%|███████   | 14/20 [32:12<12:26, 124.37s/it]
Task 6, Epoch 15/20 => Loss 0.376, Loss_clf 0.239, Loss_aux 0.137, Train_accy 93.42:  70%|███████   | 14/20 [33:57<12:26, 124.37s/it]
Task 6, Epoch 15/20 => Loss 0.376, Loss_clf 0.239, Loss_aux 0.137, Train_accy 93.42:  75%|███████▌  | 15/20 [33:57<09:53, 118.72s/it]
Task 6, Epoch 16/20 => Loss 0.382, Loss_clf 0.234, Loss_aux 0.148, Train_accy 93.33, Test_accy 85.16:  75%|███████▌  | 15/20 [38:14<09:53, 118.72s/it]
Task 6, Epoch 16/20 => Loss 0.382, Loss_clf 0.234, Loss_aux 0.148, Train_accy 93.33, Test_accy 85.16:  80%|████████  | 16/20 [38:14<10:41, 160.28s/it]
Task 6, Epoch 17/20 => Loss 0.368, Loss_clf 0.234, Loss_aux 0.134, Train_accy 93.60:  80%|████████  | 16/20 [40:00<10:41, 160.28s/it]                 
Task 6, Epoch 17/20 => Loss 0.368, Loss_clf 0.234, Loss_aux 0.134, Train_accy 93.60:  85%|████████▌ | 17/20 [40:00<07:11, 143.86s/it]
Task 6, Epoch 18/20 => Loss 0.431, Loss_clf 0.272, Loss_aux 0.159, Train_accy 92.36:  85%|████████▌ | 17/20 [41:46<07:11, 143.86s/it]
Task 6, Epoch 18/20 => Loss 0.431, Loss_clf 0.272, Loss_aux 0.159, Train_accy 92.36:  90%|█████████ | 18/20 [41:46<04:24, 132.38s/it]
Task 6, Epoch 19/20 => Loss 0.383, Loss_clf 0.242, Loss_aux 0.142, Train_accy 93.33:  90%|█████████ | 18/20 [43:31<04:24, 132.38s/it]
Task 6, Epoch 19/20 => Loss 0.383, Loss_clf 0.242, Loss_aux 0.142, Train_accy 93.33:  95%|█████████▌| 19/20 [43:31<02:04, 124.35s/it]
Task 6, Epoch 20/20 => Loss 0.382, Loss_clf 0.243, Loss_aux 0.139, Train_accy 93.37:  95%|█████████▌| 19/20 [45:17<02:04, 124.35s/it]
Task 6, Epoch 20/20 => Loss 0.382, Loss_clf 0.243, Loss_aux 0.139, Train_accy 93.37: 100%|██████████| 20/20 [45:17<00:00, 118.73s/it]
Task 6, Epoch 20/20 => Loss 0.382, Loss_clf 0.243, Loss_aux 0.139, Train_accy 93.37: 100%|██████████| 20/20 [45:17<00:00, 135.87s/it]
2024-09-06 07:33:08,665 [der.py] => Task 6, Epoch 20/20 => Loss 0.382, Loss_clf 0.243, Loss_aux 0.139, Train_accy 93.37
2024-09-06 07:33:08,666 [base.py] => Reducing exemplars...(25 per classes)
2024-09-06 07:34:04,282 [base.py] => Constructing exemplars...(25 per classes)
2024-09-06 07:40:02,186 [der.py] => Exemplar size: 2000
2024-09-06 07:40:02,187 [trainer.py] => CNN: {'total': 84.64, '00-49': 85.4, '50-54': 70.4, '55-59': 68.2, '60-64': 81.2, '65-69': 96.2, '70-74': 86.6, '75-79': 97.6, 'old': 83.77, 'new': 97.6}
2024-09-06 07:40:02,187 [trainer.py] => NME: {'total': 88.01, '00-49': 88.66, '50-54': 85.0, '55-59': 78.8, '60-64': 83.2, '65-69': 96.2, '70-74': 90.4, '75-79': 88.0, 'old': 88.01, 'new': 88.0}
2024-09-06 07:40:02,187 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92, 88.94, 86.83, 84.64]
2024-09-06 07:40:02,187 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66, 98.56, 98.12, 97.81]
2024-09-06 07:40:02,187 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83, 90.81, 89.52, 88.01]
2024-09-06 07:40:02,187 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22, 99.09, 98.91, 98.82]

Average Accuracy (CNN): 88.99
Average Accuracy (NME): 90.8
2024-09-06 07:40:02,187 [trainer.py] => Average Accuracy (CNN): 88.99
2024-09-06 07:40:02,187 [trainer.py] => Average Accuracy (NME): 90.8
2024-09-06 07:40:02,191 [trainer.py] => All params: 601025366
2024-09-06 07:40:02,194 [trainer.py] => Trainable params: 86233430
2024-09-06 07:40:03,843 [der.py] => Learning on 80-85
2024-09-06 07:40:03,852 [der.py] => All params: 686916187
2024-09-06 07:40:03,856 [der.py] => Trainable params: 86325595

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.414, Loss_clf 1.015, Loss_aux 0.400, Train_accy 84.02, Test_accy 83.60:   0%|          | 0/20 [05:01<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.414, Loss_clf 1.015, Loss_aux 0.400, Train_accy 84.02, Test_accy 83.60:   5%|▌         | 1/20 [05:01<1:35:35, 301.88s/it]
Task 7, Epoch 2/20 => Loss 0.496, Loss_clf 0.308, Loss_aux 0.188, Train_accy 91.67:   5%|▌         | 1/20 [07:00<1:35:35, 301.88s/it]                 
Task 7, Epoch 2/20 => Loss 0.496, Loss_clf 0.308, Loss_aux 0.188, Train_accy 91.67:  10%|█         | 2/20 [07:00<58:14, 194.17s/it]  
Task 7, Epoch 3/20 => Loss 0.444, Loss_clf 0.284, Loss_aux 0.159, Train_accy 91.98:  10%|█         | 2/20 [08:59<58:14, 194.17s/it]
Task 7, Epoch 3/20 => Loss 0.444, Loss_clf 0.284, Loss_aux 0.159, Train_accy 91.98:  15%|█▌        | 3/20 [08:59<45:15, 159.72s/it]
Task 7, Epoch 4/20 => Loss 0.429, Loss_clf 0.277, Loss_aux 0.152, Train_accy 92.40:  15%|█▌        | 3/20 [10:58<45:15, 159.72s/it]
Task 7, Epoch 4/20 => Loss 0.429, Loss_clf 0.277, Loss_aux 0.152, Train_accy 92.40:  20%|██        | 4/20 [10:58<38:16, 143.56s/it]
Task 7, Epoch 5/20 => Loss 0.441, Loss_clf 0.285, Loss_aux 0.156, Train_accy 92.11:  20%|██        | 4/20 [12:56<38:16, 143.56s/it]
Task 7, Epoch 5/20 => Loss 0.441, Loss_clf 0.285, Loss_aux 0.156, Train_accy 92.11:  25%|██▌       | 5/20 [12:56<33:39, 134.62s/it]
Task 7, Epoch 6/20 => Loss 0.385, Loss_clf 0.248, Loss_aux 0.138, Train_accy 93.07, Test_accy 83.59:  25%|██▌       | 5/20 [17:59<33:39, 134.62s/it]
Task 7, Epoch 6/20 => Loss 0.385, Loss_clf 0.248, Loss_aux 0.138, Train_accy 93.07, Test_accy 83.59:  30%|███       | 6/20 [17:59<44:42, 191.59s/it]
Task 7, Epoch 7/20 => Loss 0.384, Loss_clf 0.254, Loss_aux 0.130, Train_accy 93.22:  30%|███       | 6/20 [19:57<44:42, 191.59s/it]                 
Task 7, Epoch 7/20 => Loss 0.384, Loss_clf 0.254, Loss_aux 0.130, Train_accy 93.22:  35%|███▌      | 7/20 [19:57<36:21, 167.80s/it]
Task 7, Epoch 8/20 => Loss 0.364, Loss_clf 0.243, Loss_aux 0.120, Train_accy 93.29:  35%|███▌      | 7/20 [21:56<36:21, 167.80s/it]
Task 7, Epoch 8/20 => Loss 0.364, Loss_clf 0.243, Loss_aux 0.120, Train_accy 93.29:  40%|████      | 8/20 [21:56<30:26, 152.20s/it]
Task 7, Epoch 9/20 => Loss 0.373, Loss_clf 0.243, Loss_aux 0.130, Train_accy 93.02:  40%|████      | 8/20 [23:55<30:26, 152.20s/it]
Task 7, Epoch 9/20 => Loss 0.373, Loss_clf 0.243, Loss_aux 0.130, Train_accy 93.02:  45%|████▌     | 9/20 [23:55<25:59, 141.76s/it]
Task 7, Epoch 10/20 => Loss 0.364, Loss_clf 0.236, Loss_aux 0.129, Train_accy 93.47:  45%|████▌     | 9/20 [25:54<25:59, 141.76s/it]
Task 7, Epoch 10/20 => Loss 0.364, Loss_clf 0.236, Loss_aux 0.129, Train_accy 93.47:  50%|█████     | 10/20 [25:54<22:26, 134.66s/it]
Task 7, Epoch 11/20 => Loss 0.350, Loss_clf 0.228, Loss_aux 0.122, Train_accy 93.98, Test_accy 83.51:  50%|█████     | 10/20 [30:56<22:26, 134.66s/it]
Task 7, Epoch 11/20 => Loss 0.350, Loss_clf 0.228, Loss_aux 0.122, Train_accy 93.98, Test_accy 83.51:  55%|█████▌    | 11/20 [30:56<27:53, 185.91s/it]
Task 7, Epoch 12/20 => Loss 0.348, Loss_clf 0.229, Loss_aux 0.119, Train_accy 93.67:  55%|█████▌    | 11/20 [32:55<27:53, 185.91s/it]                 
Task 7, Epoch 12/20 => Loss 0.348, Loss_clf 0.229, Loss_aux 0.119, Train_accy 93.67:  60%|██████    | 12/20 [32:55<22:03, 165.50s/it]
Task 7, Epoch 13/20 => Loss 0.329, Loss_clf 0.217, Loss_aux 0.111, Train_accy 94.22:  60%|██████    | 12/20 [34:54<22:03, 165.50s/it]
Task 7, Epoch 13/20 => Loss 0.329, Loss_clf 0.217, Loss_aux 0.111, Train_accy 94.22:  65%|██████▌   | 13/20 [34:54<17:39, 151.39s/it]
Task 7, Epoch 14/20 => Loss 0.349, Loss_clf 0.237, Loss_aux 0.111, Train_accy 93.27:  65%|██████▌   | 13/20 [36:53<17:39, 151.39s/it]
Task 7, Epoch 14/20 => Loss 0.349, Loss_clf 0.237, Loss_aux 0.111, Train_accy 93.27:  70%|███████   | 14/20 [36:53<14:09, 141.57s/it]
Task 7, Epoch 15/20 => Loss 0.321, Loss_clf 0.210, Loss_aux 0.111, Train_accy 94.27:  70%|███████   | 14/20 [38:51<14:09, 141.57s/it]
Task 7, Epoch 15/20 => Loss 0.321, Loss_clf 0.210, Loss_aux 0.111, Train_accy 94.27:  75%|███████▌  | 15/20 [38:51<11:13, 134.75s/it]
Task 7, Epoch 16/20 => Loss 0.325, Loss_clf 0.219, Loss_aux 0.107, Train_accy 93.82, Test_accy 83.72:  75%|███████▌  | 15/20 [43:54<11:13, 134.75s/it]
Task 7, Epoch 16/20 => Loss 0.325, Loss_clf 0.219, Loss_aux 0.107, Train_accy 93.82, Test_accy 83.72:  80%|████████  | 16/20 [43:54<12:20, 185.21s/it]
Task 7, Epoch 17/20 => Loss 0.345, Loss_clf 0.233, Loss_aux 0.112, Train_accy 93.53:  80%|████████  | 16/20 [45:53<12:20, 185.21s/it]                 
Task 7, Epoch 17/20 => Loss 0.345, Loss_clf 0.233, Loss_aux 0.112, Train_accy 93.53:  85%|████████▌ | 17/20 [45:53<08:15, 165.24s/it]
Task 7, Epoch 18/20 => Loss 0.287, Loss_clf 0.190, Loss_aux 0.097, Train_accy 94.87:  85%|████████▌ | 17/20 [47:51<08:15, 165.24s/it]
Task 7, Epoch 18/20 => Loss 0.287, Loss_clf 0.190, Loss_aux 0.097, Train_accy 94.87:  90%|█████████ | 18/20 [47:51<05:02, 151.29s/it]
Task 7, Epoch 19/20 => Loss 0.293, Loss_clf 0.197, Loss_aux 0.096, Train_accy 94.51:  90%|█████████ | 18/20 [49:50<05:02, 151.29s/it]
Task 7, Epoch 19/20 => Loss 0.293, Loss_clf 0.197, Loss_aux 0.096, Train_accy 94.51:  95%|█████████▌| 19/20 [49:50<02:21, 141.52s/it]
Task 7, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.42:  95%|█████████▌| 19/20 [51:49<02:21, 141.52s/it]
Task 7, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.42: 100%|██████████| 20/20 [51:49<00:00, 134.69s/it]
Task 7, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.42: 100%|██████████| 20/20 [51:49<00:00, 155.48s/it]
2024-09-06 08:31:53,479 [der.py] => Task 7, Epoch 20/20 => Loss 0.301, Loss_clf 0.197, Loss_aux 0.104, Train_accy 94.42
2024-09-06 08:31:53,480 [base.py] => Reducing exemplars...(23 per classes)
2024-09-06 08:32:55,700 [base.py] => Constructing exemplars...(23 per classes)
2024-09-06 08:40:05,954 [der.py] => Exemplar size: 1955
2024-09-06 08:40:05,954 [trainer.py] => CNN: {'total': 84.09, '00-49': 83.5, '50-54': 77.4, '55-59': 70.8, '60-64': 71.6, '65-69': 95.6, '70-74': 86.2, '75-79': 94.0, '80-84': 99.0, 'old': 83.16, 'new': 99.0}
2024-09-06 08:40:05,954 [trainer.py] => NME: {'total': 87.12, '00-49': 86.82, '50-54': 84.6, '55-59': 78.2, '60-64': 82.0, '65-69': 96.0, '70-74': 89.8, '75-79': 91.0, '80-84': 91.2, 'old': 86.86, 'new': 91.2}
2024-09-06 08:40:05,954 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92, 88.94, 86.83, 84.64, 84.09]
2024-09-06 08:40:05,954 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66, 98.56, 98.12, 97.81, 97.81]
2024-09-06 08:40:05,954 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83, 90.81, 89.52, 88.01, 87.12]
2024-09-06 08:40:05,954 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22, 99.09, 98.91, 98.82, 98.68]

Average Accuracy (CNN): 88.37
Average Accuracy (NME): 90.34
2024-09-06 08:40:05,954 [trainer.py] => Average Accuracy (CNN): 88.37
2024-09-06 08:40:05,954 [trainer.py] => Average Accuracy (NME): 90.34
2024-09-06 08:40:05,959 [trainer.py] => All params: 686916187
2024-09-06 08:40:05,963 [trainer.py] => Trainable params: 86325595
2024-09-06 08:40:07,563 [der.py] => Learning on 85-90
2024-09-06 08:40:07,572 [der.py] => All params: 772814688
2024-09-06 08:40:07,576 [der.py] => Trainable params: 86425440

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.594, Loss_clf 1.013, Loss_aux 0.581, Train_accy 80.07, Test_accy 82.12:   0%|          | 0/20 [05:47<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.594, Loss_clf 1.013, Loss_aux 0.581, Train_accy 80.07, Test_accy 82.12:   5%|▌         | 1/20 [05:47<1:50:01, 347.47s/it]
Task 8, Epoch 2/20 => Loss 0.667, Loss_clf 0.389, Loss_aux 0.277, Train_accy 88.71:   5%|▌         | 1/20 [07:56<1:50:01, 347.47s/it]                 
Task 8, Epoch 2/20 => Loss 0.667, Loss_clf 0.389, Loss_aux 0.277, Train_accy 88.71:  10%|█         | 2/20 [07:56<1:05:45, 219.21s/it]
Task 8, Epoch 3/20 => Loss 0.639, Loss_clf 0.383, Loss_aux 0.256, Train_accy 88.69:  10%|█         | 2/20 [10:06<1:05:45, 219.21s/it]
Task 8, Epoch 3/20 => Loss 0.639, Loss_clf 0.383, Loss_aux 0.256, Train_accy 88.69:  15%|█▌        | 3/20 [10:06<50:29, 178.21s/it]  
Task 8, Epoch 4/20 => Loss 0.533, Loss_clf 0.329, Loss_aux 0.204, Train_accy 90.82:  15%|█▌        | 3/20 [12:15<50:29, 178.21s/it]
Task 8, Epoch 4/20 => Loss 0.533, Loss_clf 0.329, Loss_aux 0.204, Train_accy 90.82:  20%|██        | 4/20 [12:15<42:23, 158.95s/it]
Task 8, Epoch 5/20 => Loss 0.539, Loss_clf 0.310, Loss_aux 0.228, Train_accy 90.95:  20%|██        | 4/20 [14:25<42:23, 158.95s/it]
Task 8, Epoch 5/20 => Loss 0.539, Loss_clf 0.310, Loss_aux 0.228, Train_accy 90.95:  25%|██▌       | 5/20 [14:25<37:04, 148.31s/it]
Task 8, Epoch 6/20 => Loss 0.540, Loss_clf 0.334, Loss_aux 0.207, Train_accy 90.39, Test_accy 81.57:  25%|██▌       | 5/20 [20:12<37:04, 148.31s/it]
Task 8, Epoch 6/20 => Loss 0.540, Loss_clf 0.334, Loss_aux 0.207, Train_accy 90.39, Test_accy 81.57:  30%|███       | 6/20 [20:12<50:24, 216.06s/it]
Task 8, Epoch 7/20 => Loss 0.499, Loss_clf 0.301, Loss_aux 0.198, Train_accy 91.09:  30%|███       | 6/20 [22:22<50:24, 216.06s/it]                 
Task 8, Epoch 7/20 => Loss 0.499, Loss_clf 0.301, Loss_aux 0.198, Train_accy 91.09:  35%|███▌      | 7/20 [22:22<40:41, 187.78s/it]
Task 8, Epoch 8/20 => Loss 0.488, Loss_clf 0.293, Loss_aux 0.195, Train_accy 91.36:  35%|███▌      | 7/20 [24:31<40:41, 187.78s/it]
Task 8, Epoch 8/20 => Loss 0.488, Loss_clf 0.293, Loss_aux 0.195, Train_accy 91.36:  40%|████      | 8/20 [24:31<33:50, 169.22s/it]
Task 8, Epoch 9/20 => Loss 0.457, Loss_clf 0.276, Loss_aux 0.181, Train_accy 92.01:  40%|████      | 8/20 [26:41<33:50, 169.22s/it]
Task 8, Epoch 9/20 => Loss 0.457, Loss_clf 0.276, Loss_aux 0.181, Train_accy 92.01:  45%|████▌     | 9/20 [26:41<28:44, 156.79s/it]
Task 8, Epoch 10/20 => Loss 0.443, Loss_clf 0.263, Loss_aux 0.180, Train_accy 92.26:  45%|████▌     | 9/20 [28:50<28:44, 156.79s/it]
Task 8, Epoch 10/20 => Loss 0.443, Loss_clf 0.263, Loss_aux 0.180, Train_accy 92.26:  50%|█████     | 10/20 [28:50<24:43, 148.35s/it]
Task 8, Epoch 11/20 => Loss 0.506, Loss_clf 0.305, Loss_aux 0.201, Train_accy 91.18, Test_accy 81.49:  50%|█████     | 10/20 [34:37<24:43, 148.35s/it]
Task 8, Epoch 11/20 => Loss 0.506, Loss_clf 0.305, Loss_aux 0.201, Train_accy 91.18, Test_accy 81.49:  55%|█████▌    | 11/20 [34:37<31:23, 209.23s/it]
Task 8, Epoch 12/20 => Loss 0.458, Loss_clf 0.282, Loss_aux 0.176, Train_accy 91.99:  55%|█████▌    | 11/20 [36:47<31:23, 209.23s/it]                 
Task 8, Epoch 12/20 => Loss 0.458, Loss_clf 0.282, Loss_aux 0.176, Train_accy 91.99:  60%|██████    | 12/20 [36:47<24:39, 184.93s/it]
Task 8, Epoch 13/20 => Loss 0.444, Loss_clf 0.266, Loss_aux 0.178, Train_accy 92.73:  60%|██████    | 12/20 [38:56<24:39, 184.93s/it]
Task 8, Epoch 13/20 => Loss 0.444, Loss_clf 0.266, Loss_aux 0.178, Train_accy 92.73:  65%|██████▌   | 13/20 [38:56<19:36, 168.11s/it]
Task 8, Epoch 14/20 => Loss 0.452, Loss_clf 0.273, Loss_aux 0.180, Train_accy 92.39:  65%|██████▌   | 13/20 [41:06<19:36, 168.11s/it]
Task 8, Epoch 14/20 => Loss 0.452, Loss_clf 0.273, Loss_aux 0.180, Train_accy 92.39:  70%|███████   | 14/20 [41:06<15:38, 156.43s/it]
Task 8, Epoch 15/20 => Loss 0.434, Loss_clf 0.273, Loss_aux 0.161, Train_accy 92.14:  70%|███████   | 14/20 [43:15<15:38, 156.43s/it]
Task 8, Epoch 15/20 => Loss 0.434, Loss_clf 0.273, Loss_aux 0.161, Train_accy 92.14:  75%|███████▌  | 15/20 [43:15<12:21, 148.29s/it]
Task 8, Epoch 16/20 => Loss 0.434, Loss_clf 0.262, Loss_aux 0.172, Train_accy 92.84, Test_accy 82.98:  75%|███████▌  | 15/20 [49:03<12:21, 148.29s/it]
Task 8, Epoch 16/20 => Loss 0.434, Loss_clf 0.262, Loss_aux 0.172, Train_accy 92.84, Test_accy 82.98:  80%|████████  | 16/20 [49:03<13:53, 208.27s/it]
Task 8, Epoch 17/20 => Loss 0.413, Loss_clf 0.251, Loss_aux 0.162, Train_accy 92.97:  80%|████████  | 16/20 [51:12<13:53, 208.27s/it]                 
Task 8, Epoch 17/20 => Loss 0.413, Loss_clf 0.251, Loss_aux 0.162, Train_accy 92.97:  85%|████████▌ | 17/20 [51:12<09:13, 184.57s/it]
Task 8, Epoch 18/20 => Loss 0.436, Loss_clf 0.276, Loss_aux 0.160, Train_accy 92.50:  85%|████████▌ | 17/20 [53:22<09:13, 184.57s/it]
Task 8, Epoch 18/20 => Loss 0.436, Loss_clf 0.276, Loss_aux 0.160, Train_accy 92.50:  90%|█████████ | 18/20 [53:22<05:36, 168.01s/it]
Task 8, Epoch 19/20 => Loss 0.446, Loss_clf 0.277, Loss_aux 0.169, Train_accy 92.28:  90%|█████████ | 18/20 [55:31<05:36, 168.01s/it]
Task 8, Epoch 19/20 => Loss 0.446, Loss_clf 0.277, Loss_aux 0.169, Train_accy 92.28:  95%|█████████▌| 19/20 [55:31<02:36, 156.41s/it]
Task 8, Epoch 20/20 => Loss 0.454, Loss_clf 0.276, Loss_aux 0.178, Train_accy 92.10:  95%|█████████▌| 19/20 [57:40<02:36, 156.41s/it]
Task 8, Epoch 20/20 => Loss 0.454, Loss_clf 0.276, Loss_aux 0.178, Train_accy 92.10: 100%|██████████| 20/20 [57:40<00:00, 148.28s/it]
Task 8, Epoch 20/20 => Loss 0.454, Loss_clf 0.276, Loss_aux 0.178, Train_accy 92.10: 100%|██████████| 20/20 [57:40<00:00, 173.04s/it]
2024-09-06 09:37:48,504 [der.py] => Task 8, Epoch 20/20 => Loss 0.454, Loss_clf 0.276, Loss_aux 0.178, Train_accy 92.10
2024-09-06 09:37:48,506 [base.py] => Reducing exemplars...(22 per classes)
2024-09-06 09:38:57,934 [base.py] => Constructing exemplars...(22 per classes)
2024-09-06 09:47:25,584 [der.py] => Exemplar size: 1980
2024-09-06 09:47:25,585 [trainer.py] => CNN: {'total': 81.92, '00-49': 80.32, '50-54': 79.8, '55-59': 62.4, '60-64': 74.0, '65-69': 94.2, '70-74': 85.4, '75-79': 84.2, '80-84': 95.0, '85-89': 96.4, 'old': 81.07, 'new': 96.4}
2024-09-06 09:47:25,585 [trainer.py] => NME: {'total': 85.84, '00-49': 85.62, '50-54': 83.4, '55-59': 75.6, '60-64': 81.4, '65-69': 95.6, '70-74': 89.4, '75-79': 87.8, '80-84': 92.4, '85-89': 83.4, 'old': 85.99, 'new': 83.4}
2024-09-06 09:47:25,585 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92, 88.94, 86.83, 84.64, 84.09, 81.92]
2024-09-06 09:47:25,585 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66, 98.56, 98.12, 97.81, 97.81, 96.66]
2024-09-06 09:47:25,585 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83, 90.81, 89.52, 88.01, 87.12, 85.84]
2024-09-06 09:47:25,585 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22, 99.09, 98.91, 98.82, 98.68, 98.09]

Average Accuracy (CNN): 87.66
Average Accuracy (NME): 89.84
2024-09-06 09:47:25,585 [trainer.py] => Average Accuracy (CNN): 87.66
2024-09-06 09:47:25,585 [trainer.py] => Average Accuracy (NME): 89.84
2024-09-06 09:47:25,590 [trainer.py] => All params: 772814688
2024-09-06 09:47:25,594 [trainer.py] => Trainable params: 86425440
2024-09-06 09:47:27,157 [der.py] => Learning on 90-95
2024-09-06 09:47:27,167 [der.py] => All params: 858720869
2024-09-06 09:47:27,171 [der.py] => Trainable params: 86532965

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.414, Loss_clf 0.992, Loss_aux 0.422, Train_accy 83.46, Test_accy 81.12:   0%|          | 0/20 [06:37<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.414, Loss_clf 0.992, Loss_aux 0.422, Train_accy 83.46, Test_accy 81.12:   5%|▌         | 1/20 [06:37<2:05:48, 397.27s/it]
Task 9, Epoch 2/20 => Loss 0.542, Loss_clf 0.341, Loss_aux 0.201, Train_accy 90.40:   5%|▌         | 1/20 [08:59<2:05:48, 397.27s/it]                 
Task 9, Epoch 2/20 => Loss 0.542, Loss_clf 0.341, Loss_aux 0.201, Train_accy 90.40:  10%|█         | 2/20 [08:59<1:14:09, 247.19s/it]
Task 9, Epoch 3/20 => Loss 0.459, Loss_clf 0.289, Loss_aux 0.170, Train_accy 92.12:  10%|█         | 2/20 [11:21<1:14:09, 247.19s/it]
Task 9, Epoch 3/20 => Loss 0.459, Loss_clf 0.289, Loss_aux 0.170, Train_accy 92.12:  15%|█▌        | 3/20 [11:21<56:26, 199.21s/it]  
Task 9, Epoch 4/20 => Loss 0.447, Loss_clf 0.295, Loss_aux 0.152, Train_accy 91.67:  15%|█▌        | 3/20 [13:43<56:26, 199.21s/it]
Task 9, Epoch 4/20 => Loss 0.447, Loss_clf 0.295, Loss_aux 0.152, Train_accy 91.67:  20%|██        | 4/20 [13:43<47:06, 176.68s/it]
Task 9, Epoch 5/20 => Loss 0.389, Loss_clf 0.244, Loss_aux 0.144, Train_accy 93.17:  20%|██        | 4/20 [16:05<47:06, 176.68s/it]
Task 9, Epoch 5/20 => Loss 0.389, Loss_clf 0.244, Loss_aux 0.144, Train_accy 93.17:  25%|██▌       | 5/20 [16:05<41:03, 164.22s/it]
Task 9, Epoch 6/20 => Loss 0.406, Loss_clf 0.260, Loss_aux 0.145, Train_accy 92.75, Test_accy 81.99:  25%|██▌       | 5/20 [22:43<41:03, 164.22s/it]
Task 9, Epoch 6/20 => Loss 0.406, Loss_clf 0.260, Loss_aux 0.145, Train_accy 92.75, Test_accy 81.99:  30%|███       | 6/20 [22:43<56:49, 243.55s/it]
Task 9, Epoch 7/20 => Loss 0.423, Loss_clf 0.266, Loss_aux 0.157, Train_accy 92.75:  30%|███       | 6/20 [25:05<56:49, 243.55s/it]                 
Task 9, Epoch 7/20 => Loss 0.423, Loss_clf 0.266, Loss_aux 0.157, Train_accy 92.75:  35%|███▌      | 7/20 [25:05<45:34, 210.38s/it]
Task 9, Epoch 8/20 => Loss 0.397, Loss_clf 0.254, Loss_aux 0.144, Train_accy 93.01:  35%|███▌      | 7/20 [27:27<45:34, 210.38s/it]
Task 9, Epoch 8/20 => Loss 0.397, Loss_clf 0.254, Loss_aux 0.144, Train_accy 93.01:  40%|████      | 8/20 [27:27<37:43, 188.65s/it]
Task 9, Epoch 9/20 => Loss 0.356, Loss_clf 0.227, Loss_aux 0.128, Train_accy 93.10:  40%|████      | 8/20 [29:49<37:43, 188.65s/it]
Task 9, Epoch 9/20 => Loss 0.356, Loss_clf 0.227, Loss_aux 0.128, Train_accy 93.10:  45%|████▌     | 9/20 [29:49<31:55, 174.11s/it]
Task 9, Epoch 10/20 => Loss 0.329, Loss_clf 0.209, Loss_aux 0.120, Train_accy 94.29:  45%|████▌     | 9/20 [32:11<31:55, 174.11s/it]
Task 9, Epoch 10/20 => Loss 0.329, Loss_clf 0.209, Loss_aux 0.120, Train_accy 94.29:  50%|█████     | 10/20 [32:11<27:22, 164.23s/it]
Task 9, Epoch 11/20 => Loss 0.380, Loss_clf 0.246, Loss_aux 0.133, Train_accy 93.42, Test_accy 81.44:  50%|█████     | 10/20 [38:49<27:22, 164.23s/it]
Task 9, Epoch 11/20 => Loss 0.380, Loss_clf 0.246, Loss_aux 0.133, Train_accy 93.42, Test_accy 81.44:  55%|█████▌    | 11/20 [38:49<35:21, 235.67s/it]
Task 9, Epoch 12/20 => Loss 0.337, Loss_clf 0.220, Loss_aux 0.118, Train_accy 94.24:  55%|█████▌    | 11/20 [41:11<35:21, 235.67s/it]                 
Task 9, Epoch 12/20 => Loss 0.337, Loss_clf 0.220, Loss_aux 0.118, Train_accy 94.24:  60%|██████    | 12/20 [41:11<27:37, 207.17s/it]
Task 9, Epoch 13/20 => Loss 0.355, Loss_clf 0.222, Loss_aux 0.133, Train_accy 93.57:  60%|██████    | 12/20 [43:33<27:37, 207.17s/it]
Task 9, Epoch 13/20 => Loss 0.355, Loss_clf 0.222, Loss_aux 0.133, Train_accy 93.57:  65%|██████▌   | 13/20 [43:33<21:52, 187.48s/it]
Task 9, Epoch 14/20 => Loss 0.340, Loss_clf 0.224, Loss_aux 0.117, Train_accy 93.62:  65%|██████▌   | 13/20 [45:55<21:52, 187.48s/it]
Task 9, Epoch 14/20 => Loss 0.340, Loss_clf 0.224, Loss_aux 0.117, Train_accy 93.62:  70%|███████   | 14/20 [45:55<17:22, 173.79s/it]
Task 9, Epoch 15/20 => Loss 0.347, Loss_clf 0.223, Loss_aux 0.123, Train_accy 94.06:  70%|███████   | 14/20 [48:17<17:22, 173.79s/it]
Task 9, Epoch 15/20 => Loss 0.347, Loss_clf 0.223, Loss_aux 0.123, Train_accy 94.06:  75%|███████▌  | 15/20 [48:17<13:41, 164.24s/it]
Task 9, Epoch 16/20 => Loss 0.321, Loss_clf 0.213, Loss_aux 0.108, Train_accy 93.93, Test_accy 80.78:  75%|███████▌  | 15/20 [54:55<13:41, 164.24s/it]
Task 9, Epoch 16/20 => Loss 0.321, Loss_clf 0.213, Loss_aux 0.108, Train_accy 93.93, Test_accy 80.78:  80%|████████  | 16/20 [54:55<15:37, 234.43s/it]
Task 9, Epoch 17/20 => Loss 0.343, Loss_clf 0.226, Loss_aux 0.117, Train_accy 93.71:  80%|████████  | 16/20 [57:17<15:37, 234.43s/it]                 
Task 9, Epoch 17/20 => Loss 0.343, Loss_clf 0.226, Loss_aux 0.117, Train_accy 93.71:  85%|████████▌ | 17/20 [57:17<10:20, 206.67s/it]
Task 9, Epoch 18/20 => Loss 0.343, Loss_clf 0.231, Loss_aux 0.112, Train_accy 94.04:  85%|████████▌ | 17/20 [59:39<10:20, 206.67s/it]
Task 9, Epoch 18/20 => Loss 0.343, Loss_clf 0.231, Loss_aux 0.112, Train_accy 94.04:  90%|█████████ | 18/20 [59:39<06:14, 187.27s/it]
Task 9, Epoch 19/20 => Loss 0.289, Loss_clf 0.196, Loss_aux 0.093, Train_accy 94.64:  90%|█████████ | 18/20 [1:02:01<06:14, 187.27s/it]
Task 9, Epoch 19/20 => Loss 0.289, Loss_clf 0.196, Loss_aux 0.093, Train_accy 94.64:  95%|█████████▌| 19/20 [1:02:01<02:53, 173.78s/it]
Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.209, Loss_aux 0.120, Train_accy 94.15:  95%|█████████▌| 19/20 [1:04:24<02:53, 173.78s/it]
Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.209, Loss_aux 0.120, Train_accy 94.15: 100%|██████████| 20/20 [1:04:24<00:00, 164.29s/it]
Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.209, Loss_aux 0.120, Train_accy 94.15: 100%|██████████| 20/20 [1:04:24<00:00, 193.20s/it]
2024-09-06 10:51:51,318 [der.py] => Task 9, Epoch 20/20 => Loss 0.328, Loss_clf 0.209, Loss_aux 0.120, Train_accy 94.15
2024-09-06 10:51:51,320 [base.py] => Reducing exemplars...(21 per classes)
2024-09-06 10:53:11,159 [base.py] => Constructing exemplars...(21 per classes)
2024-09-06 11:03:00,937 [der.py] => Exemplar size: 1995
2024-09-06 11:03:00,937 [trainer.py] => CNN: {'total': 81.96, '00-49': 79.82, '50-54': 73.6, '55-59': 67.2, '60-64': 76.4, '65-69': 92.8, '70-74': 87.0, '75-79': 84.8, '80-84': 93.2, '85-89': 86.8, '90-94': 97.2, 'old': 81.11, 'new': 97.2}
2024-09-06 11:03:00,937 [trainer.py] => NME: {'total': 85.41, '00-49': 84.82, '50-54': 82.4, '55-59': 75.2, '60-64': 79.4, '65-69': 95.8, '70-74': 89.2, '75-79': 84.2, '80-84': 93.4, '85-89': 85.6, '90-94': 89.4, 'old': 85.19, 'new': 89.4}
2024-09-06 11:03:00,937 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92, 88.94, 86.83, 84.64, 84.09, 81.92, 81.96]
2024-09-06 11:03:00,937 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66, 98.56, 98.12, 97.81, 97.81, 96.66, 96.44]
2024-09-06 11:03:00,937 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83, 90.81, 89.52, 88.01, 87.12, 85.84, 85.41]
2024-09-06 11:03:00,937 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22, 99.09, 98.91, 98.82, 98.68, 98.09, 97.87]

Average Accuracy (CNN): 87.09
Average Accuracy (NME): 89.4
2024-09-06 11:03:00,937 [trainer.py] => Average Accuracy (CNN): 87.09
2024-09-06 11:03:00,937 [trainer.py] => Average Accuracy (NME): 89.4
2024-09-06 11:03:00,942 [trainer.py] => All params: 858720869
2024-09-06 11:03:00,947 [trainer.py] => Trainable params: 86532965
2024-09-06 11:03:02,603 [der.py] => Learning on 95-100
2024-09-06 11:03:02,614 [der.py] => All params: 944634730
2024-09-06 11:03:02,618 [der.py] => Trainable params: 86648170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.533, Loss_clf 1.067, Loss_aux 0.466, Train_accy 82.34, Test_accy 79.18:   0%|          | 0/20 [07:29<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.533, Loss_clf 1.067, Loss_aux 0.466, Train_accy 82.34, Test_accy 79.18:   5%|▌         | 1/20 [07:29<2:22:28, 449.94s/it]
Task 10, Epoch 2/20 => Loss 0.646, Loss_clf 0.404, Loss_aux 0.241, Train_accy 88.79:   5%|▌         | 1/20 [10:04<2:22:28, 449.94s/it]                 
Task 10, Epoch 2/20 => Loss 0.646, Loss_clf 0.404, Loss_aux 0.241, Train_accy 88.79:  10%|█         | 2/20 [10:04<1:22:49, 276.09s/it]
Task 10, Epoch 3/20 => Loss 0.551, Loss_clf 0.342, Loss_aux 0.210, Train_accy 90.30:  10%|█         | 2/20 [12:38<1:22:49, 276.09s/it]
Task 10, Epoch 3/20 => Loss 0.551, Loss_clf 0.342, Loss_aux 0.210, Train_accy 90.30:  15%|█▌        | 3/20 [12:38<1:02:29, 220.53s/it]
Task 10, Epoch 4/20 => Loss 0.468, Loss_clf 0.289, Loss_aux 0.179, Train_accy 91.64:  15%|█▌        | 3/20 [15:13<1:02:29, 220.53s/it]
Task 10, Epoch 4/20 => Loss 0.468, Loss_clf 0.289, Loss_aux 0.179, Train_accy 91.64:  20%|██        | 4/20 [15:13<51:52, 194.51s/it]  
Task 10, Epoch 5/20 => Loss 0.488, Loss_clf 0.308, Loss_aux 0.180, Train_accy 91.46:  20%|██        | 4/20 [17:47<51:52, 194.51s/it]
Task 10, Epoch 5/20 => Loss 0.488, Loss_clf 0.308, Loss_aux 0.180, Train_accy 91.46:  25%|██▌       | 5/20 [17:47<45:01, 180.12s/it]
Task 10, Epoch 6/20 => Loss 0.451, Loss_clf 0.286, Loss_aux 0.165, Train_accy 92.04, Test_accy 79.80:  25%|██▌       | 5/20 [25:17<45:01, 180.12s/it]
Task 10, Epoch 6/20 => Loss 0.451, Loss_clf 0.286, Loss_aux 0.165, Train_accy 92.04, Test_accy 79.80:  30%|███       | 6/20 [25:17<1:03:25, 271.84s/it]
Task 10, Epoch 7/20 => Loss 0.445, Loss_clf 0.281, Loss_aux 0.164, Train_accy 92.12:  30%|███       | 6/20 [27:52<1:03:25, 271.84s/it]                 
Task 10, Epoch 7/20 => Loss 0.445, Loss_clf 0.281, Loss_aux 0.164, Train_accy 92.12:  35%|███▌      | 7/20 [27:52<50:35, 233.48s/it]  
Task 10, Epoch 8/20 => Loss 0.449, Loss_clf 0.277, Loss_aux 0.172, Train_accy 92.12:  35%|███▌      | 7/20 [30:26<50:35, 233.48s/it]
Task 10, Epoch 8/20 => Loss 0.449, Loss_clf 0.277, Loss_aux 0.172, Train_accy 92.12:  40%|████      | 8/20 [30:26<41:40, 208.34s/it]
Task 10, Epoch 9/20 => Loss 0.404, Loss_clf 0.241, Loss_aux 0.163, Train_accy 93.48:  40%|████      | 8/20 [33:01<41:40, 208.34s/it]
Task 10, Epoch 9/20 => Loss 0.404, Loss_clf 0.241, Loss_aux 0.163, Train_accy 93.48:  45%|████▌     | 9/20 [33:01<35:06, 191.51s/it]
Task 10, Epoch 10/20 => Loss 0.423, Loss_clf 0.261, Loss_aux 0.162, Train_accy 92.75:  45%|████▌     | 9/20 [35:35<35:06, 191.51s/it]
Task 10, Epoch 10/20 => Loss 0.423, Loss_clf 0.261, Loss_aux 0.162, Train_accy 92.75:  50%|█████     | 10/20 [35:35<30:00, 180.09s/it]
Task 10, Epoch 11/20 => Loss 0.377, Loss_clf 0.228, Loss_aux 0.149, Train_accy 93.66, Test_accy 79.39:  50%|█████     | 10/20 [43:06<30:00, 180.09s/it]
Task 10, Epoch 11/20 => Loss 0.377, Loss_clf 0.228, Loss_aux 0.149, Train_accy 93.66, Test_accy 79.39:  55%|█████▌    | 11/20 [43:06<39:24, 262.73s/it]
Task 10, Epoch 12/20 => Loss 0.406, Loss_clf 0.256, Loss_aux 0.150, Train_accy 93.06:  55%|█████▌    | 11/20 [45:40<39:24, 262.73s/it]                 
Task 10, Epoch 12/20 => Loss 0.406, Loss_clf 0.256, Loss_aux 0.150, Train_accy 93.06:  60%|██████    | 12/20 [45:40<30:38, 229.76s/it]
Task 10, Epoch 13/20 => Loss 0.390, Loss_clf 0.236, Loss_aux 0.154, Train_accy 93.30:  60%|██████    | 12/20 [48:14<30:38, 229.76s/it]
Task 10, Epoch 13/20 => Loss 0.390, Loss_clf 0.236, Loss_aux 0.154, Train_accy 93.30:  65%|██████▌   | 13/20 [48:14<24:08, 206.96s/it]
Task 10, Epoch 14/20 => Loss 0.409, Loss_clf 0.264, Loss_aux 0.145, Train_accy 92.75:  65%|██████▌   | 13/20 [50:49<24:08, 206.96s/it]
Task 10, Epoch 14/20 => Loss 0.409, Loss_clf 0.264, Loss_aux 0.145, Train_accy 92.75:  70%|███████   | 14/20 [50:49<19:06, 191.13s/it]
Task 10, Epoch 15/20 => Loss 0.405, Loss_clf 0.260, Loss_aux 0.145, Train_accy 92.70:  70%|███████   | 14/20 [53:23<19:06, 191.13s/it]
Task 10, Epoch 15/20 => Loss 0.405, Loss_clf 0.260, Loss_aux 0.145, Train_accy 92.70:  75%|███████▌  | 15/20 [53:23<15:00, 180.10s/it]
Task 10, Epoch 16/20 => Loss 0.381, Loss_clf 0.240, Loss_aux 0.141, Train_accy 93.37, Test_accy 79.36:  75%|███████▌  | 15/20 [1:00:54<15:00, 180.10s/it]
Task 10, Epoch 16/20 => Loss 0.381, Loss_clf 0.240, Loss_aux 0.141, Train_accy 93.37, Test_accy 79.36:  80%|████████  | 16/20 [1:00:54<17:25, 261.41s/it]
Task 10, Epoch 17/20 => Loss 0.396, Loss_clf 0.247, Loss_aux 0.149, Train_accy 93.10:  80%|████████  | 16/20 [1:03:28<17:25, 261.41s/it]                 
Task 10, Epoch 17/20 => Loss 0.396, Loss_clf 0.247, Loss_aux 0.149, Train_accy 93.10:  85%|████████▌ | 17/20 [1:03:28<11:27, 229.27s/it]
Task 10, Epoch 18/20 => Loss 0.330, Loss_clf 0.210, Loss_aux 0.120, Train_accy 94.39:  85%|████████▌ | 17/20 [1:06:03<11:27, 229.27s/it]
Task 10, Epoch 18/20 => Loss 0.330, Loss_clf 0.210, Loss_aux 0.120, Train_accy 94.39:  90%|█████████ | 18/20 [1:06:03<06:53, 206.78s/it]
Task 10, Epoch 19/20 => Loss 0.368, Loss_clf 0.234, Loss_aux 0.133, Train_accy 93.75:  90%|█████████ | 18/20 [1:08:37<06:53, 206.78s/it]
Task 10, Epoch 19/20 => Loss 0.368, Loss_clf 0.234, Loss_aux 0.133, Train_accy 93.75:  95%|█████████▌| 19/20 [1:08:37<03:11, 191.08s/it]
Task 10, Epoch 20/20 => Loss 0.383, Loss_clf 0.244, Loss_aux 0.139, Train_accy 93.19:  95%|█████████▌| 19/20 [1:11:12<03:11, 191.08s/it]
Task 10, Epoch 20/20 => Loss 0.383, Loss_clf 0.244, Loss_aux 0.139, Train_accy 93.19: 100%|██████████| 20/20 [1:11:12<00:00, 180.10s/it]
Task 10, Epoch 20/20 => Loss 0.383, Loss_clf 0.244, Loss_aux 0.139, Train_accy 93.19: 100%|██████████| 20/20 [1:11:12<00:00, 213.61s/it]
2024-09-06 12:14:14,869 [der.py] => Task 10, Epoch 20/20 => Loss 0.383, Loss_clf 0.244, Loss_aux 0.139, Train_accy 93.19
2024-09-06 12:14:14,871 [base.py] => Reducing exemplars...(20 per classes)
2024-09-06 12:15:39,886 [base.py] => Constructing exemplars...(20 per classes)
2024-09-06 12:26:57,416 [der.py] => Exemplar size: 2000
2024-09-06 12:26:57,416 [trainer.py] => CNN: {'total': 81.25, '00-49': 78.04, '50-54': 68.2, '55-59': 69.0, '60-64': 80.0, '65-69': 91.6, '70-74': 86.0, '75-79': 82.0, '80-84': 93.0, '85-89': 85.6, '90-94': 92.4, '95-99': 96.8, 'old': 80.43, 'new': 96.8}
2024-09-06 12:26:57,416 [trainer.py] => NME: {'total': 84.81, '00-49': 84.02, '50-54': 81.4, '55-59': 74.2, '60-64': 78.6, '65-69': 95.4, '70-74': 88.6, '75-79': 84.2, '80-84': 93.4, '85-89': 86.0, '90-94': 90.0, '95-99': 84.2, 'old': 84.84, 'new': 84.2}
2024-09-06 12:26:57,416 [trainer.py] => CNN top1 curve: [92.32, 90.02, 90.23, 89.92, 88.94, 86.83, 84.64, 84.09, 81.92, 81.96, 81.25]
2024-09-06 12:26:57,416 [trainer.py] => CNN top5 curve: [99.22, 99.05, 98.72, 98.66, 98.56, 98.12, 97.81, 97.81, 96.66, 96.44, 95.8]
2024-09-06 12:26:57,416 [trainer.py] => NME top1 curve: [92.82, 91.89, 91.75, 90.83, 90.81, 89.52, 88.01, 87.12, 85.84, 85.41, 84.81]
2024-09-06 12:26:57,416 [trainer.py] => NME top5 curve: [99.46, 99.33, 99.33, 99.22, 99.09, 98.91, 98.82, 98.68, 98.09, 97.87, 97.69]

Average Accuracy (CNN): 86.56
Average Accuracy (NME): 88.98
2024-09-06 12:26:57,416 [trainer.py] => Average Accuracy (CNN): 86.56
2024-09-06 12:26:57,417 [trainer.py] => Average Accuracy (NME): 88.98
Accuracy Matrix (CNN):
[[92.32 89.24 89.32 89.84 88.72 87.32 85.4  83.5  80.32 79.82 78.04]
 [ 0.   97.8  93.8  92.8  92.6  91.4  70.4  77.4  79.8  73.6  68.2 ]
 [ 0.    0.   95.8  81.4  74.8  67.   68.2  70.8  62.4  67.2  69.  ]
 [ 0.    0.    0.   96.4  91.2  79.2  81.2  71.6  74.   76.4  80.  ]
 [ 0.    0.    0.    0.   99.4  93.4  96.2  95.6  94.2  92.8  91.6 ]
 [ 0.    0.    0.    0.    0.   98.2  86.6  86.2  85.4  87.   86.  ]
 [ 0.    0.    0.    0.    0.    0.   97.6  94.   84.2  84.8  82.  ]
 [ 0.    0.    0.    0.    0.    0.    0.   99.   95.   93.2  93.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   96.4  86.8  85.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   97.2  92.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   96.8 ]]
2024-09-06 12:26:57,417 [trainer.py] => Forgetting (CNN): 14.428000000000003
Accuracy Matrix (NME):
[[92.82 91.72 91.06 90.64 90.14 89.52 88.66 86.82 85.62 84.82 84.02]
 [ 0.   93.6  96.   95.2  95.   94.8  85.   84.6  83.4  82.4  81.4 ]
 [ 0.    0.   94.4  88.   86.6  81.   78.8  78.2  75.6  75.2  74.2 ]
 [ 0.    0.    0.   91.2  92.   84.2  83.2  82.   81.4  79.4  78.6 ]
 [ 0.    0.    0.    0.   96.4  95.6  96.2  96.   95.6  95.8  95.4 ]
 [ 0.    0.    0.    0.    0.   92.   90.4  89.8  89.4  89.2  88.6 ]
 [ 0.    0.    0.    0.    0.    0.   88.   91.   87.8  84.2  84.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.   91.2  92.4  93.4  93.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   83.4  85.6  86.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   89.4  90.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   84.2 ]]
2024-09-06 12:26:57,418 [trainer.py] => Forgetting (NME): 6.82

nohup: 忽略输入
2024-09-04 10:53:34,448 [trainer.py] => config: ./exps/foster_cifar_B0_Inc5.json
2024-09-04 10:53:34,448 [trainer.py] => prefix: cil
2024-09-04 10:53:34,448 [trainer.py] => dataset: cifar224
2024-09-04 10:53:34,448 [trainer.py] => memory_size: 2000
2024-09-04 10:53:34,448 [trainer.py] => memory_per_class: 20
2024-09-04 10:53:34,448 [trainer.py] => fixed_memory: True
2024-09-04 10:53:34,448 [trainer.py] => shuffle: True
2024-09-04 10:53:34,448 [trainer.py] => init_cls: 20
2024-09-04 10:53:34,448 [trainer.py] => increment: 20
2024-09-04 10:53:34,448 [trainer.py] => model_name: foster
2024-09-04 10:53:34,448 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 10:53:34,448 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-04 10:53:34,448 [trainer.py] => seed: 1993
2024-09-04 10:53:34,448 [trainer.py] => beta1: 0.96
2024-09-04 10:53:34,448 [trainer.py] => beta2: 0.97
2024-09-04 10:53:34,448 [trainer.py] => oofc: ft
2024-09-04 10:53:34,449 [trainer.py] => is_teacher_wa: False
2024-09-04 10:53:34,449 [trainer.py] => is_student_wa: False
2024-09-04 10:53:34,449 [trainer.py] => lambda_okd: 1
2024-09-04 10:53:34,449 [trainer.py] => wa_value: 1
2024-09-04 10:53:34,449 [trainer.py] => init_epochs: 20
2024-09-04 10:53:34,449 [trainer.py] => init_lr: 0.001
2024-09-04 10:53:34,449 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 10:53:34,449 [trainer.py] => boosting_epochs: 20
2024-09-04 10:53:34,449 [trainer.py] => compression_epochs: 20
2024-09-04 10:53:34,449 [trainer.py] => lr: 0.001
2024-09-04 10:53:34,449 [trainer.py] => batch_size: 48
2024-09-04 10:53:34,449 [trainer.py] => weight_decay: 0.0005
2024-09-04 10:53:34,449 [trainer.py] => num_workers: 8
2024-09-04 10:53:34,449 [trainer.py] => T: 2
2024-09-04 10:53:35,593 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 10:53:35,966 [trainer.py] => All params: 0
2024-09-04 10:53:35,966 [trainer.py] => Trainable params: 0
2024-09-04 10:53:37,951 [foster.py] => Learning on 0-20
2024-09-04 10:53:37,953 [foster.py] => All params: 85829416
2024-09-04 10:53:37,954 [foster.py] => Trainable params: 85829416

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.482, Train_accy 25.28, Test_accy 87.70:   0%|          | 0/20 [01:19<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.482, Train_accy 25.28, Test_accy 87.70:   5%|▌         | 1/20 [01:19<25:05, 79.24s/it]
Task 0, Epoch 2/20 => Loss 0.752, Train_accy 77.75:   5%|▌         | 1/20 [02:33<25:05, 79.24s/it]                 
Task 0, Epoch 2/20 => Loss 0.752, Train_accy 77.75:  10%|█         | 2/20 [02:33<22:49, 76.08s/it]
Task 0, Epoch 3/20 => Loss 0.588, Train_accy 82.22:  10%|█         | 2/20 [03:47<22:49, 76.08s/it]
Task 0, Epoch 3/20 => Loss 0.588, Train_accy 82.22:  15%|█▌        | 3/20 [03:47<21:20, 75.30s/it]
Task 0, Epoch 4/20 => Loss 0.490, Train_accy 85.25:  15%|█▌        | 3/20 [05:01<21:20, 75.30s/it]
Task 0, Epoch 4/20 => Loss 0.490, Train_accy 85.25:  20%|██        | 4/20 [05:01<19:57, 74.85s/it]
Task 0, Epoch 5/20 => Loss 0.424, Train_accy 87.14:  20%|██        | 4/20 [06:16<19:57, 74.85s/it]
Task 0, Epoch 5/20 => Loss 0.424, Train_accy 87.14:  25%|██▌       | 5/20 [06:16<18:40, 74.73s/it]
Task 0, Epoch 6/20 => Loss 0.388, Train_accy 88.27, Test_accy 96.20:  25%|██▌       | 5/20 [07:36<18:40, 74.73s/it]
Task 0, Epoch 6/20 => Loss 0.388, Train_accy 88.27, Test_accy 96.20:  30%|███       | 6/20 [07:36<17:53, 76.71s/it]
Task 0, Epoch 7/20 => Loss 0.357, Train_accy 89.29:  30%|███       | 6/20 [08:51<17:53, 76.71s/it]                 
Task 0, Epoch 7/20 => Loss 0.357, Train_accy 89.29:  35%|███▌      | 7/20 [08:51<16:27, 75.96s/it]
Task 0, Epoch 8/20 => Loss 0.333, Train_accy 89.72:  35%|███▌      | 7/20 [10:05<16:27, 75.96s/it]
Task 0, Epoch 8/20 => Loss 0.333, Train_accy 89.72:  40%|████      | 8/20 [10:05<15:05, 75.47s/it]
Task 0, Epoch 9/20 => Loss 0.298, Train_accy 90.96:  40%|████      | 8/20 [11:20<15:05, 75.47s/it]
Task 0, Epoch 9/20 => Loss 0.298, Train_accy 90.96:  45%|████▌     | 9/20 [11:20<13:46, 75.17s/it]
Task 0, Epoch 10/20 => Loss 0.293, Train_accy 91.21:  45%|████▌     | 9/20 [12:34<13:46, 75.17s/it]
Task 0, Epoch 10/20 => Loss 0.293, Train_accy 91.21:  50%|█████     | 10/20 [12:34<12:28, 74.86s/it]
Task 0, Epoch 11/20 => Loss 0.288, Train_accy 91.23, Test_accy 96.85:  50%|█████     | 10/20 [13:53<12:28, 74.86s/it]
Task 0, Epoch 11/20 => Loss 0.288, Train_accy 91.23, Test_accy 96.85:  55%|█████▌    | 11/20 [13:53<11:25, 76.11s/it]
Task 0, Epoch 12/20 => Loss 0.258, Train_accy 92.04:  55%|█████▌    | 11/20 [15:06<11:25, 76.11s/it]                 
Task 0, Epoch 12/20 => Loss 0.258, Train_accy 92.04:  60%|██████    | 12/20 [15:06<10:01, 75.14s/it]
Task 0, Epoch 13/20 => Loss 0.260, Train_accy 92.21:  60%|██████    | 12/20 [16:19<10:01, 75.14s/it]
Task 0, Epoch 13/20 => Loss 0.260, Train_accy 92.21:  65%|██████▌   | 13/20 [16:19<08:41, 74.47s/it]
Task 0, Epoch 14/20 => Loss 0.244, Train_accy 92.44:  65%|██████▌   | 13/20 [17:31<08:41, 74.47s/it]
Task 0, Epoch 14/20 => Loss 0.244, Train_accy 92.44:  70%|███████   | 14/20 [17:31<07:23, 73.99s/it]
Task 0, Epoch 15/20 => Loss 0.220, Train_accy 93.31:  70%|███████   | 14/20 [18:44<07:23, 73.99s/it]
Task 0, Epoch 15/20 => Loss 0.220, Train_accy 93.31:  75%|███████▌  | 15/20 [18:44<06:08, 73.65s/it]
Task 0, Epoch 16/20 => Loss 0.208, Train_accy 93.39, Test_accy 97.45:  75%|███████▌  | 15/20 [20:03<06:08, 73.65s/it]
Task 0, Epoch 16/20 => Loss 0.208, Train_accy 93.39, Test_accy 97.45:  80%|████████  | 16/20 [20:03<05:00, 75.15s/it]
Task 0, Epoch 17/20 => Loss 0.220, Train_accy 93.10:  80%|████████  | 16/20 [21:16<05:00, 75.15s/it]                 
Task 0, Epoch 17/20 => Loss 0.220, Train_accy 93.10:  85%|████████▌ | 17/20 [21:16<03:43, 74.47s/it]
Task 0, Epoch 18/20 => Loss 0.217, Train_accy 93.41:  85%|████████▌ | 17/20 [22:29<03:43, 74.47s/it]
Task 0, Epoch 18/20 => Loss 0.217, Train_accy 93.41:  90%|█████████ | 18/20 [22:29<02:28, 74.00s/it]
Task 0, Epoch 19/20 => Loss 0.203, Train_accy 93.75:  90%|█████████ | 18/20 [23:42<02:28, 74.00s/it]
Task 0, Epoch 19/20 => Loss 0.203, Train_accy 93.75:  95%|█████████▌| 19/20 [23:42<01:13, 73.65s/it]
Task 0, Epoch 20/20 => Loss 0.201, Train_accy 93.86:  95%|█████████▌| 19/20 [24:54<01:13, 73.65s/it]
Task 0, Epoch 20/20 => Loss 0.201, Train_accy 93.86: 100%|██████████| 20/20 [24:54<00:00, 73.41s/it]
Task 0, Epoch 20/20 => Loss 0.201, Train_accy 93.86: 100%|██████████| 20/20 [24:54<00:00, 74.74s/it]
2024-09-04 11:18:33,356 [foster.py] => Task 0, Epoch 20/20 => Loss 0.201, Train_accy 93.86
2024-09-04 11:18:33,358 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 11:19:22,798 [foster.py] => Exemplar size: 400
2024-09-04 11:19:22,798 [trainer.py] => CNN: {'total': 97.5, '00-19': 97.5, 'old': 0, 'new': 97.5}
2024-09-04 11:19:22,798 [trainer.py] => NME: {'total': 97.25, '00-19': 97.25, 'old': 0, 'new': 97.25}
2024-09-04 11:19:22,798 [trainer.py] => CNN top1 curve: [97.5]
2024-09-04 11:19:22,798 [trainer.py] => CNN top5 curve: [99.85]
2024-09-04 11:19:22,798 [trainer.py] => NME top1 curve: [97.25]
2024-09-04 11:19:22,798 [trainer.py] => NME top5 curve: [99.85]

Average Accuracy (CNN): 97.5
Average Accuracy (NME): 97.25
2024-09-04 11:19:22,798 [trainer.py] => Average Accuracy (CNN): 97.5
2024-09-04 11:19:22,798 [trainer.py] => Average Accuracy (NME): 97.25
2024-09-04 11:19:22,799 [trainer.py] => All params: 85829416
2024-09-04 11:19:22,799 [trainer.py] => Trainable params: 85829416
2024-09-04 11:19:24,378 [foster.py] => Learning on 20-40
2024-09-04 11:19:24,379 [foster.py] => All params: 171704932
2024-09-04 11:19:24,380 [foster.py] => Trainable params: 85890896
2024-09-04 11:19:24,518 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.152, Loss_clf 0.741, Loss_fe 0.930, Loss_kd 0.741, Train_accy 68.86, Test_accy 86.50:   0%|          | 0/20 [02:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.152, Loss_clf 0.741, Loss_fe 0.930, Loss_kd 0.741, Train_accy 68.86, Test_accy 86.50:   5%|▌         | 1/20 [02:04<39:18, 124.15s/it]
Task 1, Epoch 2/20 => Loss 2.432, Loss_clf 0.420, Loss_fe 0.541, Loss_kd 0.735, Train_accy 74.35:   5%|▌         | 1/20 [03:46<39:18, 124.15s/it]                 
Task 1, Epoch 2/20 => Loss 2.432, Loss_clf 0.420, Loss_fe 0.541, Loss_kd 0.735, Train_accy 74.35:  10%|█         | 2/20 [03:46<33:26, 111.49s/it]
Task 1, Epoch 3/20 => Loss 2.329, Loss_clf 0.377, Loss_fe 0.483, Loss_kd 0.734, Train_accy 76.18:  10%|█         | 2/20 [05:29<33:26, 111.49s/it]
Task 1, Epoch 3/20 => Loss 2.329, Loss_clf 0.377, Loss_fe 0.483, Loss_kd 0.734, Train_accy 76.18:  15%|█▌        | 3/20 [05:29<30:28, 107.58s/it]
Task 1, Epoch 4/20 => Loss 2.269, Loss_clf 0.349, Loss_fe 0.443, Loss_kd 0.738, Train_accy 77.06:  15%|█▌        | 3/20 [07:12<30:28, 107.58s/it]
Task 1, Epoch 4/20 => Loss 2.269, Loss_clf 0.349, Loss_fe 0.443, Loss_kd 0.738, Train_accy 77.06:  20%|██        | 4/20 [07:12<28:12, 105.75s/it]
Task 1, Epoch 5/20 => Loss 2.193, Loss_clf 0.327, Loss_fe 0.399, Loss_kd 0.733, Train_accy 79.54:  20%|██        | 4/20 [08:55<28:12, 105.75s/it]
Task 1, Epoch 5/20 => Loss 2.193, Loss_clf 0.327, Loss_fe 0.399, Loss_kd 0.733, Train_accy 79.54:  25%|██▌       | 5/20 [08:55<26:10, 104.72s/it]
Task 1, Epoch 6/20 => Loss 2.104, Loss_clf 0.297, Loss_fe 0.352, Loss_kd 0.727, Train_accy 81.83, Test_accy 91.08:  25%|██▌       | 5/20 [11:00<26:10, 104.72s/it]
Task 1, Epoch 6/20 => Loss 2.104, Loss_clf 0.297, Loss_fe 0.352, Loss_kd 0.727, Train_accy 81.83, Test_accy 91.08:  30%|███       | 6/20 [11:00<26:00, 111.48s/it]
Task 1, Epoch 7/20 => Loss 2.097, Loss_clf 0.285, Loss_fe 0.341, Loss_kd 0.735, Train_accy 82.45:  30%|███       | 6/20 [12:42<26:00, 111.48s/it]                 
Task 1, Epoch 7/20 => Loss 2.097, Loss_clf 0.285, Loss_fe 0.341, Loss_kd 0.735, Train_accy 82.45:  35%|███▌      | 7/20 [12:42<23:32, 108.63s/it]
Task 1, Epoch 8/20 => Loss 2.073, Loss_clf 0.283, Loss_fe 0.321, Loss_kd 0.735, Train_accy 83.57:  35%|███▌      | 7/20 [14:25<23:32, 108.63s/it]
Task 1, Epoch 8/20 => Loss 2.073, Loss_clf 0.283, Loss_fe 0.321, Loss_kd 0.735, Train_accy 83.57:  40%|████      | 8/20 [14:25<21:20, 106.75s/it]
Task 1, Epoch 9/20 => Loss 1.998, Loss_clf 0.255, Loss_fe 0.284, Loss_kd 0.730, Train_accy 84.30:  40%|████      | 8/20 [16:08<21:20, 106.75s/it]
Task 1, Epoch 9/20 => Loss 1.998, Loss_clf 0.255, Loss_fe 0.284, Loss_kd 0.730, Train_accy 84.30:  45%|████▌     | 9/20 [16:08<19:20, 105.49s/it]
Task 1, Epoch 10/20 => Loss 1.975, Loss_clf 0.244, Loss_fe 0.264, Loss_kd 0.733, Train_accy 84.92:  45%|████▌     | 9/20 [17:51<19:20, 105.49s/it]
Task 1, Epoch 10/20 => Loss 1.975, Loss_clf 0.244, Loss_fe 0.264, Loss_kd 0.733, Train_accy 84.92:  50%|█████     | 10/20 [17:51<17:26, 104.63s/it]
Task 1, Epoch 11/20 => Loss 1.962, Loss_clf 0.239, Loss_fe 0.259, Loss_kd 0.732, Train_accy 85.64, Test_accy 93.22:  50%|█████     | 10/20 [19:55<17:26, 104.63s/it]
Task 1, Epoch 11/20 => Loss 1.962, Loss_clf 0.239, Loss_fe 0.259, Loss_kd 0.732, Train_accy 85.64, Test_accy 93.22:  55%|█████▌    | 11/20 [19:55<16:36, 110.71s/it]
Task 1, Epoch 12/20 => Loss 1.922, Loss_clf 0.222, Loss_fe 0.237, Loss_kd 0.731, Train_accy 86.91:  55%|█████▌    | 11/20 [21:38<16:36, 110.71s/it]                 
Task 1, Epoch 12/20 => Loss 1.922, Loss_clf 0.222, Loss_fe 0.237, Loss_kd 0.731, Train_accy 86.91:  60%|██████    | 12/20 [21:38<14:26, 108.27s/it]
Task 1, Epoch 13/20 => Loss 1.944, Loss_clf 0.236, Loss_fe 0.240, Loss_kd 0.734, Train_accy 86.17:  60%|██████    | 12/20 [23:21<14:26, 108.27s/it]
Task 1, Epoch 13/20 => Loss 1.944, Loss_clf 0.236, Loss_fe 0.240, Loss_kd 0.734, Train_accy 86.17:  65%|██████▌   | 13/20 [23:21<12:26, 106.61s/it]
Task 1, Epoch 14/20 => Loss 1.875, Loss_clf 0.209, Loss_fe 0.212, Loss_kd 0.727, Train_accy 87.23:  65%|██████▌   | 13/20 [25:03<12:26, 106.61s/it]
Task 1, Epoch 14/20 => Loss 1.875, Loss_clf 0.209, Loss_fe 0.212, Loss_kd 0.727, Train_accy 87.23:  70%|███████   | 14/20 [25:03<10:32, 105.47s/it]
Task 1, Epoch 15/20 => Loss 1.847, Loss_clf 0.194, Loss_fe 0.196, Loss_kd 0.728, Train_accy 88.01:  70%|███████   | 14/20 [26:46<10:32, 105.47s/it]
Task 1, Epoch 15/20 => Loss 1.847, Loss_clf 0.194, Loss_fe 0.196, Loss_kd 0.728, Train_accy 88.01:  75%|███████▌  | 15/20 [26:46<08:43, 104.68s/it]
Task 1, Epoch 16/20 => Loss 1.866, Loss_clf 0.203, Loss_fe 0.201, Loss_kd 0.731, Train_accy 87.63, Test_accy 93.32:  75%|███████▌  | 15/20 [28:51<08:43, 104.68s/it]
Task 1, Epoch 16/20 => Loss 1.866, Loss_clf 0.203, Loss_fe 0.201, Loss_kd 0.731, Train_accy 87.63, Test_accy 93.32:  80%|████████  | 16/20 [28:51<07:22, 110.66s/it]
Task 1, Epoch 17/20 => Loss 1.862, Loss_clf 0.204, Loss_fe 0.201, Loss_kd 0.729, Train_accy 88.23:  80%|████████  | 16/20 [30:34<07:22, 110.66s/it]                 
Task 1, Epoch 17/20 => Loss 1.862, Loss_clf 0.204, Loss_fe 0.201, Loss_kd 0.729, Train_accy 88.23:  85%|████████▌ | 17/20 [30:34<05:25, 108.34s/it]
Task 1, Epoch 18/20 => Loss 1.846, Loss_clf 0.198, Loss_fe 0.189, Loss_kd 0.730, Train_accy 88.69:  85%|████████▌ | 17/20 [32:16<05:25, 108.34s/it]
Task 1, Epoch 18/20 => Loss 1.846, Loss_clf 0.198, Loss_fe 0.189, Loss_kd 0.730, Train_accy 88.69:  90%|█████████ | 18/20 [32:16<03:33, 106.64s/it]
Task 1, Epoch 19/20 => Loss 1.851, Loss_clf 0.196, Loss_fe 0.187, Loss_kd 0.734, Train_accy 89.00:  90%|█████████ | 18/20 [33:59<03:33, 106.64s/it]
Task 1, Epoch 19/20 => Loss 1.851, Loss_clf 0.196, Loss_fe 0.187, Loss_kd 0.734, Train_accy 89.00:  95%|█████████▌| 19/20 [33:59<01:45, 105.47s/it]
Task 1, Epoch 20/20 => Loss 1.843, Loss_clf 0.194, Loss_fe 0.183, Loss_kd 0.733, Train_accy 88.57:  95%|█████████▌| 19/20 [35:42<01:45, 105.47s/it]
Task 1, Epoch 20/20 => Loss 1.843, Loss_clf 0.194, Loss_fe 0.183, Loss_kd 0.733, Train_accy 88.57: 100%|██████████| 20/20 [35:42<00:00, 104.63s/it]
Task 1, Epoch 20/20 => Loss 1.843, Loss_clf 0.194, Loss_fe 0.183, Loss_kd 0.733, Train_accy 88.57: 100%|██████████| 20/20 [35:42<00:00, 107.12s/it]
2024-09-04 11:55:06,823 [foster.py] => Task 1, Epoch 20/20 => Loss 1.843, Loss_clf 0.194, Loss_fe 0.183, Loss_kd 0.733, Train_accy 88.57
2024-09-04 11:55:06,824 [foster.py] => do not weight align teacher!
2024-09-04 11:55:06,828 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.486,  Train_accy 66.03, Test_accy 92.68:   0%|          | 0/20 [02:20<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.486,  Train_accy 66.03, Test_accy 92.68:   5%|▌         | 1/20 [02:20<44:33, 140.72s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.204,  Train_accy 77.39:   5%|▌         | 1/20 [04:30<44:33, 140.72s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.204,  Train_accy 77.39:  10%|█         | 2/20 [04:30<40:14, 134.11s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.160,  Train_accy 78.58:  10%|█         | 2/20 [06:39<40:14, 134.11s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.160,  Train_accy 78.58:  15%|█▌        | 3/20 [06:39<37:23, 131.97s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.165,  Train_accy 78.94:  15%|█▌        | 3/20 [08:48<37:23, 131.97s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.165,  Train_accy 78.94:  20%|██        | 4/20 [08:48<34:55, 130.94s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.158,  Train_accy 78.94:  20%|██        | 4/20 [10:58<34:55, 130.94s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.158,  Train_accy 78.94:  25%|██▌       | 5/20 [10:58<32:35, 130.40s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.157,  Train_accy 78.91, Test_accy 91.90:  25%|██▌       | 5/20 [13:19<32:35, 130.40s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.157,  Train_accy 78.91, Test_accy 91.90:  30%|███       | 6/20 [13:19<31:14, 133.89s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.136,  Train_accy 79.88:  30%|███       | 6/20 [15:28<31:14, 133.89s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.136,  Train_accy 79.88:  35%|███▌      | 7/20 [15:28<28:41, 132.44s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.120,  Train_accy 79.93:  35%|███▌      | 7/20 [17:37<28:41, 132.44s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.120,  Train_accy 79.93:  40%|████      | 8/20 [17:37<26:17, 131.45s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.145,  Train_accy 79.61:  40%|████      | 8/20 [19:47<26:17, 131.45s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.145,  Train_accy 79.61:  45%|████▌     | 9/20 [19:47<23:58, 130.81s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.156,  Train_accy 79.32:  45%|████▌     | 9/20 [21:56<23:58, 130.81s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.156,  Train_accy 79.32:  50%|█████     | 10/20 [21:56<21:44, 130.40s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.163,  Train_accy 79.12, Test_accy 91.52:  50%|█████     | 10/20 [24:17<21:44, 130.40s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.163,  Train_accy 79.12, Test_accy 91.52:  55%|█████▌    | 11/20 [24:17<20:02, 133.57s/it]
SNet: Task 1, Epoch 12/20 => Loss 1.137,  Train_accy 79.48:  55%|█████▌    | 11/20 [26:27<20:02, 133.57s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 1.137,  Train_accy 79.48:  60%|██████    | 12/20 [26:27<17:38, 132.33s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.146,  Train_accy 80.01:  60%|██████    | 12/20 [28:36<17:38, 132.33s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.146,  Train_accy 80.01:  65%|██████▌   | 13/20 [28:36<15:20, 131.47s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.138,  Train_accy 79.99:  65%|██████▌   | 13/20 [30:45<15:20, 131.47s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.138,  Train_accy 79.99:  70%|███████   | 14/20 [30:45<13:05, 130.85s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.133,  Train_accy 80.19:  70%|███████   | 14/20 [32:55<13:05, 130.85s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.133,  Train_accy 80.19:  75%|███████▌  | 15/20 [32:55<10:52, 130.41s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.140,  Train_accy 79.42, Test_accy 91.78:  75%|███████▌  | 15/20 [35:16<10:52, 130.41s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.140,  Train_accy 79.42, Test_accy 91.78:  80%|████████  | 16/20 [35:16<08:54, 133.51s/it]
SNet: Task 1, Epoch 17/20 => Loss 1.139,  Train_accy 79.78:  80%|████████  | 16/20 [37:25<08:54, 133.51s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 1.139,  Train_accy 79.78:  85%|████████▌ | 17/20 [37:25<06:36, 132.27s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.117,  Train_accy 80.26:  85%|████████▌ | 17/20 [39:34<06:36, 132.27s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.117,  Train_accy 80.26:  90%|█████████ | 18/20 [39:34<04:22, 131.40s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.142,  Train_accy 80.05:  90%|█████████ | 18/20 [41:44<04:22, 131.40s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.142,  Train_accy 80.05:  95%|█████████▌| 19/20 [41:44<02:10, 130.80s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.129,  Train_accy 79.72:  95%|█████████▌| 19/20 [43:53<02:10, 130.80s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.129,  Train_accy 79.72: 100%|██████████| 20/20 [43:53<00:00, 130.39s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.129,  Train_accy 79.72: 100%|██████████| 20/20 [43:53<00:00, 131.68s/it]
2024-09-04 12:39:02,352 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.129,  Train_accy 79.72
2024-09-04 12:39:02,353 [foster.py] => do not weight align student!
2024-09-04 12:39:13,819 [foster.py] => darknet eval: 
2024-09-04 12:39:13,819 [foster.py] => CNN top1 curve: 91.65
2024-09-04 12:39:13,819 [foster.py] => CNN top5 curve: 99.75
2024-09-04 12:39:13,821 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 12:41:10,533 [foster.py] => Exemplar size: 800
2024-09-04 12:41:10,534 [trainer.py] => CNN: {'total': 93.45, '00-19': 96.5, '20-39': 90.4, 'old': 96.5, 'new': 90.4}
2024-09-04 12:41:10,534 [trainer.py] => NME: {'total': 95.05, '00-19': 93.55, '20-39': 96.55, 'old': 93.55, 'new': 96.55}
2024-09-04 12:41:10,534 [trainer.py] => CNN top1 curve: [97.5, 93.45]
2024-09-04 12:41:10,534 [trainer.py] => CNN top5 curve: [99.85, 99.52]
2024-09-04 12:41:10,534 [trainer.py] => NME top1 curve: [97.25, 95.05]
2024-09-04 12:41:10,534 [trainer.py] => NME top5 curve: [99.85, 99.55]

Average Accuracy (CNN): 95.48
Average Accuracy (NME): 96.15
2024-09-04 12:41:10,534 [trainer.py] => Average Accuracy (CNN): 95.48
2024-09-04 12:41:10,534 [trainer.py] => Average Accuracy (NME): 96.15
2024-09-04 12:41:10,535 [trainer.py] => All params: 171704932
2024-09-04 12:41:10,537 [trainer.py] => Trainable params: 85890896
2024-09-04 12:41:12,503 [foster.py] => Learning on 40-60
2024-09-04 12:41:12,504 [foster.py] => All params: 171766432
2024-09-04 12:41:12,505 [foster.py] => Trainable params: 85937016
2024-09-04 12:41:12,668 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.968, Loss_clf 0.824, Loss_fe 1.066, Loss_kd 1.385, Train_accy 60.81, Test_accy 84.72:   0%|          | 0/20 [02:19<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.968, Loss_clf 0.824, Loss_fe 1.066, Loss_kd 1.385, Train_accy 60.81, Test_accy 84.72:   5%|▌         | 1/20 [02:19<44:02, 139.07s/it]
Task 2, Epoch 2/20 => Loss 3.193, Loss_clf 0.498, Loss_fe 0.630, Loss_kd 1.377, Train_accy 67.15:   5%|▌         | 1/20 [04:05<44:02, 139.07s/it]                 
Task 2, Epoch 2/20 => Loss 3.193, Loss_clf 0.498, Loss_fe 0.630, Loss_kd 1.377, Train_accy 67.15:  10%|█         | 2/20 [04:05<35:59, 120.00s/it]
Task 2, Epoch 3/20 => Loss 3.072, Loss_clf 0.454, Loss_fe 0.567, Loss_kd 1.367, Train_accy 69.19:  10%|█         | 2/20 [05:52<35:59, 120.00s/it]
Task 2, Epoch 3/20 => Loss 3.072, Loss_clf 0.454, Loss_fe 0.567, Loss_kd 1.367, Train_accy 69.19:  15%|█▌        | 3/20 [05:52<32:15, 113.88s/it]
Task 2, Epoch 4/20 => Loss 2.948, Loss_clf 0.409, Loss_fe 0.484, Loss_kd 1.370, Train_accy 72.04:  15%|█▌        | 3/20 [07:38<32:15, 113.88s/it]
Task 2, Epoch 4/20 => Loss 2.948, Loss_clf 0.409, Loss_fe 0.484, Loss_kd 1.370, Train_accy 72.04:  20%|██        | 4/20 [07:38<29:36, 111.00s/it]
Task 2, Epoch 5/20 => Loss 2.879, Loss_clf 0.369, Loss_fe 0.446, Loss_kd 1.376, Train_accy 72.80:  20%|██        | 4/20 [09:25<29:36, 111.00s/it]
Task 2, Epoch 5/20 => Loss 2.879, Loss_clf 0.369, Loss_fe 0.446, Loss_kd 1.376, Train_accy 72.80:  25%|██▌       | 5/20 [09:25<27:21, 109.40s/it]
Task 2, Epoch 6/20 => Loss 2.891, Loss_clf 0.373, Loss_fe 0.434, Loss_kd 1.389, Train_accy 74.60, Test_accy 87.95:  25%|██▌       | 5/20 [11:44<27:21, 109.40s/it]
Task 2, Epoch 6/20 => Loss 2.891, Loss_clf 0.373, Loss_fe 0.434, Loss_kd 1.389, Train_accy 74.60, Test_accy 87.95:  30%|███       | 6/20 [11:44<27:53, 119.55s/it]
Task 2, Epoch 7/20 => Loss 2.832, Loss_clf 0.358, Loss_fe 0.408, Loss_kd 1.378, Train_accy 75.91:  30%|███       | 6/20 [13:31<27:53, 119.55s/it]                 
Task 2, Epoch 7/20 => Loss 2.832, Loss_clf 0.358, Loss_fe 0.408, Loss_kd 1.378, Train_accy 75.91:  35%|███▌      | 7/20 [13:31<24:59, 115.33s/it]
Task 2, Epoch 8/20 => Loss 2.770, Loss_clf 0.340, Loss_fe 0.376, Loss_kd 1.370, Train_accy 77.10:  35%|███▌      | 7/20 [15:17<24:59, 115.33s/it]
Task 2, Epoch 8/20 => Loss 2.770, Loss_clf 0.340, Loss_fe 0.376, Loss_kd 1.370, Train_accy 77.10:  40%|████      | 8/20 [15:17<22:30, 112.56s/it]
Task 2, Epoch 9/20 => Loss 2.711, Loss_clf 0.311, Loss_fe 0.341, Loss_kd 1.373, Train_accy 78.27:  40%|████      | 8/20 [17:04<22:30, 112.56s/it]
Task 2, Epoch 9/20 => Loss 2.711, Loss_clf 0.311, Loss_fe 0.341, Loss_kd 1.373, Train_accy 78.27:  45%|████▌     | 9/20 [17:04<20:17, 110.71s/it]
Task 2, Epoch 10/20 => Loss 2.695, Loss_clf 0.297, Loss_fe 0.324, Loss_kd 1.383, Train_accy 79.55:  45%|████▌     | 9/20 [18:51<20:17, 110.71s/it]
Task 2, Epoch 10/20 => Loss 2.695, Loss_clf 0.297, Loss_fe 0.324, Loss_kd 1.383, Train_accy 79.55:  50%|█████     | 10/20 [18:51<18:14, 109.45s/it]
Task 2, Epoch 11/20 => Loss 2.618, Loss_clf 0.276, Loss_fe 0.291, Loss_kd 1.367, Train_accy 79.95, Test_accy 90.12:  50%|█████     | 10/20 [21:10<18:14, 109.45s/it]
Task 2, Epoch 11/20 => Loss 2.618, Loss_clf 0.276, Loss_fe 0.291, Loss_kd 1.367, Train_accy 79.95, Test_accy 90.12:  55%|█████▌    | 11/20 [21:10<17:47, 118.64s/it]
Task 2, Epoch 12/20 => Loss 2.639, Loss_clf 0.277, Loss_fe 0.292, Loss_kd 1.380, Train_accy 80.68:  55%|█████▌    | 11/20 [22:57<17:47, 118.64s/it]                 
Task 2, Epoch 12/20 => Loss 2.639, Loss_clf 0.277, Loss_fe 0.292, Loss_kd 1.380, Train_accy 80.68:  60%|██████    | 12/20 [22:57<15:19, 115.00s/it]
Task 2, Epoch 13/20 => Loss 2.598, Loss_clf 0.264, Loss_fe 0.276, Loss_kd 1.372, Train_accy 80.24:  60%|██████    | 12/20 [24:44<15:19, 115.00s/it]
Task 2, Epoch 13/20 => Loss 2.598, Loss_clf 0.264, Loss_fe 0.276, Loss_kd 1.372, Train_accy 80.24:  65%|██████▌   | 13/20 [24:44<13:07, 112.46s/it]
Task 2, Epoch 14/20 => Loss 2.600, Loss_clf 0.261, Loss_fe 0.266, Loss_kd 1.382, Train_accy 81.63:  65%|██████▌   | 13/20 [26:30<13:07, 112.46s/it]
Task 2, Epoch 14/20 => Loss 2.600, Loss_clf 0.261, Loss_fe 0.266, Loss_kd 1.382, Train_accy 81.63:  70%|███████   | 14/20 [26:30<11:04, 110.72s/it]
Task 2, Epoch 15/20 => Loss 2.550, Loss_clf 0.249, Loss_fe 0.246, Loss_kd 1.370, Train_accy 82.06:  70%|███████   | 14/20 [28:17<11:04, 110.72s/it]
Task 2, Epoch 15/20 => Loss 2.550, Loss_clf 0.249, Loss_fe 0.246, Loss_kd 1.370, Train_accy 82.06:  75%|███████▌  | 15/20 [28:17<09:07, 109.49s/it]
Task 2, Epoch 16/20 => Loss 2.531, Loss_clf 0.236, Loss_fe 0.229, Loss_kd 1.377, Train_accy 83.40, Test_accy 90.48:  75%|███████▌  | 15/20 [30:36<09:07, 109.49s/it]
Task 2, Epoch 16/20 => Loss 2.531, Loss_clf 0.236, Loss_fe 0.229, Loss_kd 1.377, Train_accy 83.40, Test_accy 90.48:  80%|████████  | 16/20 [30:36<07:53, 118.47s/it]
Task 2, Epoch 17/20 => Loss 2.543, Loss_clf 0.239, Loss_fe 0.231, Loss_kd 1.382, Train_accy 83.19:  80%|████████  | 16/20 [32:23<07:53, 118.47s/it]                 
Task 2, Epoch 17/20 => Loss 2.543, Loss_clf 0.239, Loss_fe 0.231, Loss_kd 1.382, Train_accy 83.19:  85%|████████▌ | 17/20 [32:23<05:44, 114.94s/it]
Task 2, Epoch 18/20 => Loss 2.504, Loss_clf 0.222, Loss_fe 0.214, Loss_kd 1.378, Train_accy 84.03:  85%|████████▌ | 17/20 [34:09<05:44, 114.94s/it]
Task 2, Epoch 18/20 => Loss 2.504, Loss_clf 0.222, Loss_fe 0.214, Loss_kd 1.378, Train_accy 84.03:  90%|█████████ | 18/20 [34:09<03:44, 112.43s/it]
Task 2, Epoch 19/20 => Loss 2.488, Loss_clf 0.215, Loss_fe 0.210, Loss_kd 1.375, Train_accy 84.37:  90%|█████████ | 18/20 [35:56<03:44, 112.43s/it]
Task 2, Epoch 19/20 => Loss 2.488, Loss_clf 0.215, Loss_fe 0.210, Loss_kd 1.375, Train_accy 84.37:  95%|█████████▌| 19/20 [35:56<01:50, 110.67s/it]
Task 2, Epoch 20/20 => Loss 2.494, Loss_clf 0.220, Loss_fe 0.210, Loss_kd 1.376, Train_accy 83.72:  95%|█████████▌| 19/20 [37:43<01:50, 110.67s/it]
Task 2, Epoch 20/20 => Loss 2.494, Loss_clf 0.220, Loss_fe 0.210, Loss_kd 1.376, Train_accy 83.72: 100%|██████████| 20/20 [37:43<00:00, 109.46s/it]
Task 2, Epoch 20/20 => Loss 2.494, Loss_clf 0.220, Loss_fe 0.210, Loss_kd 1.376, Train_accy 83.72: 100%|██████████| 20/20 [37:43<00:00, 113.16s/it]
2024-09-04 13:18:55,878 [foster.py] => Task 2, Epoch 20/20 => Loss 2.494, Loss_clf 0.220, Loss_fe 0.210, Loss_kd 1.376, Train_accy 83.72
2024-09-04 13:18:55,879 [foster.py] => do not weight align teacher!
2024-09-04 13:18:55,881 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.904,  Train_accy 59.23, Test_accy 87.95:   0%|          | 0/20 [02:31<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.904,  Train_accy 59.23, Test_accy 87.95:   5%|▌         | 1/20 [02:31<47:54, 151.30s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.683,  Train_accy 68.40:   5%|▌         | 1/20 [04:45<47:54, 151.30s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.683,  Train_accy 68.40:  10%|█         | 2/20 [04:45<42:23, 141.32s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.676,  Train_accy 69.19:  10%|█         | 2/20 [07:00<42:23, 141.32s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.676,  Train_accy 69.19:  15%|█▌        | 3/20 [07:00<39:08, 138.15s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.652,  Train_accy 70.19:  15%|█▌        | 3/20 [09:14<39:08, 138.15s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.652,  Train_accy 70.19:  20%|██        | 4/20 [09:14<36:26, 136.68s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.637,  Train_accy 70.27:  20%|██        | 4/20 [11:28<36:26, 136.68s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.637,  Train_accy 70.27:  25%|██▌       | 5/20 [11:28<33:57, 135.86s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.634,  Train_accy 70.77, Test_accy 88.33:  25%|██▌       | 5/20 [14:00<33:57, 135.86s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.634,  Train_accy 70.77, Test_accy 88.33:  30%|███       | 6/20 [14:00<32:55, 141.11s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.629,  Train_accy 71.04:  30%|███       | 6/20 [16:14<32:55, 141.11s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.629,  Train_accy 71.04:  35%|███▌      | 7/20 [16:14<30:05, 138.90s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.645,  Train_accy 70.85:  35%|███▌      | 7/20 [18:28<30:05, 138.90s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.645,  Train_accy 70.85:  40%|████      | 8/20 [18:28<27:29, 137.47s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.638,  Train_accy 71.15:  40%|████      | 8/20 [20:43<27:29, 137.47s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.638,  Train_accy 71.15:  45%|████▌     | 9/20 [20:43<25:01, 136.51s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.621,  Train_accy 71.76:  45%|████▌     | 9/20 [22:57<25:01, 136.51s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.621,  Train_accy 71.76:  50%|█████     | 10/20 [22:57<22:38, 135.89s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.641,  Train_accy 70.80, Test_accy 88.77:  50%|█████     | 10/20 [25:29<22:38, 135.89s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.641,  Train_accy 70.80, Test_accy 88.77:  55%|█████▌    | 11/20 [25:29<21:05, 140.59s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.622,  Train_accy 71.22:  55%|█████▌    | 11/20 [27:43<21:05, 140.59s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.622,  Train_accy 71.22:  60%|██████    | 12/20 [27:43<18:29, 138.71s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.635,  Train_accy 71.00:  60%|██████    | 12/20 [29:57<18:29, 138.71s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.635,  Train_accy 71.00:  65%|██████▌   | 13/20 [29:57<16:01, 137.42s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.643,  Train_accy 71.05:  65%|██████▌   | 13/20 [32:12<16:01, 137.42s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.643,  Train_accy 71.05:  70%|███████   | 14/20 [32:12<13:39, 136.55s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.632,  Train_accy 71.49:  70%|███████   | 14/20 [34:26<13:39, 136.55s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.632,  Train_accy 71.49:  75%|███████▌  | 15/20 [34:26<11:19, 135.94s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.636,  Train_accy 70.72, Test_accy 88.47:  75%|███████▌  | 15/20 [36:58<11:19, 135.94s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.636,  Train_accy 70.72, Test_accy 88.47:  80%|████████  | 16/20 [36:58<09:22, 140.62s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.620,  Train_accy 71.82:  80%|████████  | 16/20 [39:12<09:22, 140.62s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.620,  Train_accy 71.82:  85%|████████▌ | 17/20 [39:12<06:56, 138.77s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.632,  Train_accy 71.45:  85%|████████▌ | 17/20 [41:27<06:56, 138.77s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.632,  Train_accy 71.45:  90%|█████████ | 18/20 [41:27<04:34, 137.49s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.638,  Train_accy 71.77:  90%|█████████ | 18/20 [43:41<04:34, 137.49s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.638,  Train_accy 71.77:  95%|█████████▌| 19/20 [43:41<02:16, 136.55s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.616,  Train_accy 71.70:  95%|█████████▌| 19/20 [45:56<02:16, 136.55s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.616,  Train_accy 71.70: 100%|██████████| 20/20 [45:56<00:00, 135.90s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.616,  Train_accy 71.70: 100%|██████████| 20/20 [45:56<00:00, 137.81s/it]
2024-09-04 14:04:53,850 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.616,  Train_accy 71.70
2024-09-04 14:04:53,851 [foster.py] => do not weight align student!
2024-09-04 14:05:10,771 [foster.py] => darknet eval: 
2024-09-04 14:05:10,771 [foster.py] => CNN top1 curve: 88.55
2024-09-04 14:05:10,771 [foster.py] => CNN top5 curve: 99.57
2024-09-04 14:05:10,773 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 14:07:36,824 [foster.py] => Exemplar size: 1200
2024-09-04 14:07:36,824 [trainer.py] => CNN: {'total': 90.68, '00-19': 95.9, '20-39': 91.2, '40-59': 84.95, 'old': 93.55, 'new': 84.95}
2024-09-04 14:07:36,824 [trainer.py] => NME: {'total': 93.0, '00-19': 92.05, '20-39': 92.75, '40-59': 94.2, 'old': 92.4, 'new': 94.2}
2024-09-04 14:07:36,824 [trainer.py] => CNN top1 curve: [97.5, 93.45, 90.68]
2024-09-04 14:07:36,824 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.47]
2024-09-04 14:07:36,824 [trainer.py] => NME top1 curve: [97.25, 95.05, 93.0]
2024-09-04 14:07:36,824 [trainer.py] => NME top5 curve: [99.85, 99.55, 99.47]

Average Accuracy (CNN): 93.88
Average Accuracy (NME): 95.1
2024-09-04 14:07:36,824 [trainer.py] => Average Accuracy (CNN): 93.88
2024-09-04 14:07:36,825 [trainer.py] => Average Accuracy (NME): 95.1
2024-09-04 14:07:36,826 [trainer.py] => All params: 171766432
2024-09-04 14:07:36,827 [trainer.py] => Trainable params: 85937016
2024-09-04 14:07:38,234 [foster.py] => Learning on 60-80
2024-09-04 14:07:38,235 [foster.py] => All params: 171827932
2024-09-04 14:07:38,236 [foster.py] => Trainable params: 85983136
2024-09-04 14:07:38,379 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.398, Loss_clf 0.902, Loss_fe 1.230, Loss_kd 1.700, Train_accy 55.27, Test_accy 83.22:   0%|          | 0/20 [02:33<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.398, Loss_clf 0.902, Loss_fe 1.230, Loss_kd 1.700, Train_accy 55.27, Test_accy 83.22:   5%|▌         | 1/20 [02:33<48:43, 153.85s/it]
Task 3, Epoch 2/20 => Loss 3.550, Loss_clf 0.558, Loss_fe 0.740, Loss_kd 1.689, Train_accy 60.61:   5%|▌         | 1/20 [04:24<48:43, 153.85s/it]                 
Task 3, Epoch 2/20 => Loss 3.550, Loss_clf 0.558, Loss_fe 0.740, Loss_kd 1.689, Train_accy 60.61:  10%|█         | 2/20 [04:24<38:31, 128.42s/it]
Task 3, Epoch 3/20 => Loss 3.354, Loss_clf 0.484, Loss_fe 0.609, Loss_kd 1.696, Train_accy 64.33:  10%|█         | 2/20 [06:15<38:31, 128.42s/it]
Task 3, Epoch 3/20 => Loss 3.354, Loss_clf 0.484, Loss_fe 0.609, Loss_kd 1.696, Train_accy 64.33:  15%|█▌        | 3/20 [06:15<34:04, 120.28s/it]
Task 3, Epoch 4/20 => Loss 3.266, Loss_clf 0.457, Loss_fe 0.555, Loss_kd 1.691, Train_accy 65.71:  15%|█▌        | 3/20 [08:05<34:04, 120.28s/it]
Task 3, Epoch 4/20 => Loss 3.266, Loss_clf 0.457, Loss_fe 0.555, Loss_kd 1.691, Train_accy 65.71:  20%|██        | 4/20 [08:05<31:02, 116.44s/it]
Task 3, Epoch 5/20 => Loss 3.205, Loss_clf 0.432, Loss_fe 0.517, Loss_kd 1.692, Train_accy 66.82:  20%|██        | 4/20 [09:56<31:02, 116.44s/it]
Task 3, Epoch 5/20 => Loss 3.205, Loss_clf 0.432, Loss_fe 0.517, Loss_kd 1.692, Train_accy 66.82:  25%|██▌       | 5/20 [09:56<28:34, 114.30s/it]
Task 3, Epoch 6/20 => Loss 3.100, Loss_clf 0.399, Loss_fe 0.456, Loss_kd 1.683, Train_accy 67.79, Test_accy 85.24:  25%|██▌       | 5/20 [12:29<28:34, 114.30s/it]
Task 3, Epoch 6/20 => Loss 3.100, Loss_clf 0.399, Loss_fe 0.456, Loss_kd 1.683, Train_accy 67.79, Test_accy 85.24:  30%|███       | 6/20 [12:29<29:47, 127.70s/it]
Task 3, Epoch 7/20 => Loss 3.011, Loss_clf 0.360, Loss_fe 0.403, Loss_kd 1.686, Train_accy 70.81:  30%|███       | 6/20 [14:20<29:47, 127.70s/it]                 
Task 3, Epoch 7/20 => Loss 3.011, Loss_clf 0.360, Loss_fe 0.403, Loss_kd 1.686, Train_accy 70.81:  35%|███▌      | 7/20 [14:20<26:27, 122.10s/it]
Task 3, Epoch 8/20 => Loss 3.031, Loss_clf 0.364, Loss_fe 0.410, Loss_kd 1.692, Train_accy 71.06:  35%|███▌      | 7/20 [16:10<26:27, 122.10s/it]
Task 3, Epoch 8/20 => Loss 3.031, Loss_clf 0.364, Loss_fe 0.410, Loss_kd 1.692, Train_accy 71.06:  40%|████      | 8/20 [16:10<23:41, 118.42s/it]
Task 3, Epoch 9/20 => Loss 2.953, Loss_clf 0.339, Loss_fe 0.368, Loss_kd 1.684, Train_accy 73.09:  40%|████      | 8/20 [18:01<23:41, 118.42s/it]
Task 3, Epoch 9/20 => Loss 2.953, Loss_clf 0.339, Loss_fe 0.368, Loss_kd 1.684, Train_accy 73.09:  45%|████▌     | 9/20 [18:01<21:15, 115.98s/it]
Task 3, Epoch 10/20 => Loss 2.953, Loss_clf 0.339, Loss_fe 0.355, Loss_kd 1.695, Train_accy 73.54:  45%|████▌     | 9/20 [19:52<21:15, 115.98s/it]
Task 3, Epoch 10/20 => Loss 2.953, Loss_clf 0.339, Loss_fe 0.355, Loss_kd 1.695, Train_accy 73.54:  50%|█████     | 10/20 [19:52<19:02, 114.29s/it]
Task 3, Epoch 11/20 => Loss 2.908, Loss_clf 0.321, Loss_fe 0.336, Loss_kd 1.689, Train_accy 74.33, Test_accy 86.55:  50%|█████     | 10/20 [22:25<19:02, 114.29s/it]
Task 3, Epoch 11/20 => Loss 2.908, Loss_clf 0.321, Loss_fe 0.336, Loss_kd 1.689, Train_accy 74.33, Test_accy 86.55:  55%|█████▌    | 11/20 [22:25<18:57, 126.42s/it]
Task 3, Epoch 12/20 => Loss 2.874, Loss_clf 0.305, Loss_fe 0.307, Loss_kd 1.697, Train_accy 75.90:  55%|█████▌    | 11/20 [24:16<18:57, 126.42s/it]                 
Task 3, Epoch 12/20 => Loss 2.874, Loss_clf 0.305, Loss_fe 0.307, Loss_kd 1.697, Train_accy 75.90:  60%|██████    | 12/20 [24:16<16:13, 121.63s/it]
Task 3, Epoch 13/20 => Loss 2.812, Loss_clf 0.276, Loss_fe 0.281, Loss_kd 1.691, Train_accy 77.08:  60%|██████    | 12/20 [26:07<16:13, 121.63s/it]
Task 3, Epoch 13/20 => Loss 2.812, Loss_clf 0.276, Loss_fe 0.281, Loss_kd 1.691, Train_accy 77.08:  65%|██████▌   | 13/20 [26:07<13:47, 118.28s/it]
Task 3, Epoch 14/20 => Loss 2.780, Loss_clf 0.268, Loss_fe 0.265, Loss_kd 1.685, Train_accy 77.88:  65%|██████▌   | 13/20 [27:57<13:47, 118.28s/it]
Task 3, Epoch 14/20 => Loss 2.780, Loss_clf 0.268, Loss_fe 0.265, Loss_kd 1.685, Train_accy 77.88:  70%|███████   | 14/20 [27:57<11:35, 115.95s/it]
Task 3, Epoch 15/20 => Loss 2.774, Loss_clf 0.269, Loss_fe 0.260, Loss_kd 1.683, Train_accy 77.89:  70%|███████   | 14/20 [29:48<11:35, 115.95s/it]
Task 3, Epoch 15/20 => Loss 2.774, Loss_clf 0.269, Loss_fe 0.260, Loss_kd 1.683, Train_accy 77.89:  75%|███████▌  | 15/20 [29:48<09:31, 114.35s/it]
Task 3, Epoch 16/20 => Loss 2.753, Loss_clf 0.254, Loss_fe 0.242, Loss_kd 1.693, Train_accy 78.83, Test_accy 87.51:  75%|███████▌  | 15/20 [32:22<09:31, 114.35s/it]
Task 3, Epoch 16/20 => Loss 2.753, Loss_clf 0.254, Loss_fe 0.242, Loss_kd 1.693, Train_accy 78.83, Test_accy 87.51:  80%|████████  | 16/20 [32:22<08:24, 126.21s/it]
Task 3, Epoch 17/20 => Loss 2.756, Loss_clf 0.255, Loss_fe 0.244, Loss_kd 1.693, Train_accy 79.12:  80%|████████  | 16/20 [34:12<08:24, 126.21s/it]                 
Task 3, Epoch 17/20 => Loss 2.756, Loss_clf 0.255, Loss_fe 0.244, Loss_kd 1.693, Train_accy 79.12:  85%|████████▌ | 17/20 [34:12<06:04, 121.49s/it]
Task 3, Epoch 18/20 => Loss 2.703, Loss_clf 0.236, Loss_fe 0.220, Loss_kd 1.686, Train_accy 80.03:  85%|████████▌ | 17/20 [36:03<06:04, 121.49s/it]
Task 3, Epoch 18/20 => Loss 2.703, Loss_clf 0.236, Loss_fe 0.220, Loss_kd 1.686, Train_accy 80.03:  90%|█████████ | 18/20 [36:03<03:56, 118.20s/it]
Task 3, Epoch 19/20 => Loss 2.696, Loss_clf 0.232, Loss_fe 0.219, Loss_kd 1.684, Train_accy 79.74:  90%|█████████ | 18/20 [37:53<03:56, 118.20s/it]
Task 3, Epoch 19/20 => Loss 2.696, Loss_clf 0.232, Loss_fe 0.219, Loss_kd 1.684, Train_accy 79.74:  95%|█████████▌| 19/20 [37:53<01:55, 115.90s/it]
Task 3, Epoch 20/20 => Loss 2.703, Loss_clf 0.242, Loss_fe 0.218, Loss_kd 1.682, Train_accy 79.79:  95%|█████████▌| 19/20 [39:44<01:55, 115.90s/it]
Task 3, Epoch 20/20 => Loss 2.703, Loss_clf 0.242, Loss_fe 0.218, Loss_kd 1.682, Train_accy 79.79: 100%|██████████| 20/20 [39:44<00:00, 114.28s/it]
Task 3, Epoch 20/20 => Loss 2.703, Loss_clf 0.242, Loss_fe 0.218, Loss_kd 1.682, Train_accy 79.79: 100%|██████████| 20/20 [39:44<00:00, 119.21s/it]
2024-09-04 14:47:22,660 [foster.py] => Task 3, Epoch 20/20 => Loss 2.703, Loss_clf 0.242, Loss_fe 0.218, Loss_kd 1.682, Train_accy 79.79
2024-09-04 14:47:22,661 [foster.py] => do not weight align teacher!
2024-09-04 14:47:22,667 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 2.180,  Train_accy 52.31, Test_accy 85.62:   0%|          | 0/20 [02:41<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 2.180,  Train_accy 52.31, Test_accy 85.62:   5%|▌         | 1/20 [02:41<51:14, 161.82s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.964,  Train_accy 60.79:   5%|▌         | 1/20 [05:01<51:14, 161.82s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.964,  Train_accy 60.79:  10%|█         | 2/20 [05:01<44:35, 148.63s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.973,  Train_accy 61.76:  10%|█         | 2/20 [07:20<44:35, 148.63s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.973,  Train_accy 61.76:  15%|█▌        | 3/20 [07:20<40:55, 144.41s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.973,  Train_accy 62.92:  15%|█▌        | 3/20 [09:39<40:55, 144.41s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.973,  Train_accy 62.92:  20%|██        | 4/20 [09:39<37:58, 142.42s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.954,  Train_accy 63.68:  20%|██        | 4/20 [11:59<37:58, 142.42s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.954,  Train_accy 63.68:  25%|██▌       | 5/20 [11:59<35:19, 141.32s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.953,  Train_accy 63.89, Test_accy 85.62:  25%|██▌       | 5/20 [14:41<35:19, 141.32s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.953,  Train_accy 63.89, Test_accy 85.62:  30%|███       | 6/20 [14:41<34:36, 148.32s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.949,  Train_accy 63.69:  30%|███       | 6/20 [17:00<34:36, 148.32s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.949,  Train_accy 63.69:  35%|███▌      | 7/20 [17:00<31:29, 145.37s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.949,  Train_accy 64.56:  35%|███▌      | 7/20 [19:19<31:29, 145.37s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.949,  Train_accy 64.56:  40%|████      | 8/20 [19:19<28:41, 143.44s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.946,  Train_accy 64.54:  40%|████      | 8/20 [21:39<28:41, 143.44s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.946,  Train_accy 64.54:  45%|████▌     | 9/20 [21:39<26:03, 142.15s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.929,  Train_accy 64.73:  45%|████▌     | 9/20 [23:58<26:03, 142.15s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.929,  Train_accy 64.73:  50%|█████     | 10/20 [23:58<23:32, 141.26s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.933,  Train_accy 64.70, Test_accy 85.65:  50%|█████     | 10/20 [26:40<23:32, 141.26s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.933,  Train_accy 64.70, Test_accy 85.65:  55%|█████▌    | 11/20 [26:40<22:07, 147.52s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.957,  Train_accy 64.15:  55%|█████▌    | 11/20 [28:59<22:07, 147.52s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.957,  Train_accy 64.15:  60%|██████    | 12/20 [28:59<19:20, 145.02s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.950,  Train_accy 64.46:  60%|██████    | 12/20 [31:18<19:20, 145.02s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.950,  Train_accy 64.46:  65%|██████▌   | 13/20 [31:18<16:43, 143.34s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.935,  Train_accy 65.09:  65%|██████▌   | 13/20 [33:38<16:43, 143.34s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.935,  Train_accy 65.09:  70%|███████   | 14/20 [33:38<14:12, 142.15s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.938,  Train_accy 64.46:  70%|███████   | 14/20 [35:57<14:12, 142.15s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.938,  Train_accy 64.46:  75%|███████▌  | 15/20 [35:57<11:46, 141.30s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.929,  Train_accy 64.92, Test_accy 85.50:  75%|███████▌  | 15/20 [38:39<11:46, 141.30s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.929,  Train_accy 64.92, Test_accy 85.50:  80%|████████  | 16/20 [38:39<09:49, 147.47s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.921,  Train_accy 65.28:  80%|████████  | 16/20 [40:58<09:49, 147.47s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.921,  Train_accy 65.28:  85%|████████▌ | 17/20 [40:58<07:15, 145.01s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.946,  Train_accy 64.85:  85%|████████▌ | 17/20 [43:18<07:15, 145.01s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.946,  Train_accy 64.85:  90%|█████████ | 18/20 [43:18<04:46, 143.31s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.952,  Train_accy 64.42:  90%|█████████ | 18/20 [45:37<04:46, 143.31s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.952,  Train_accy 64.42:  95%|█████████▌| 19/20 [45:37<02:22, 142.14s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.932,  Train_accy 65.26:  95%|█████████▌| 19/20 [47:56<02:22, 142.14s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.932,  Train_accy 65.26: 100%|██████████| 20/20 [47:56<00:00, 141.29s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.932,  Train_accy 65.26: 100%|██████████| 20/20 [47:56<00:00, 143.84s/it]
2024-09-04 15:35:20,892 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.932,  Train_accy 65.26
2024-09-04 15:35:20,892 [foster.py] => do not weight align student!
2024-09-04 15:35:43,358 [foster.py] => darknet eval: 
2024-09-04 15:35:43,358 [foster.py] => CNN top1 curve: 85.49
2024-09-04 15:35:43,358 [foster.py] => CNN top5 curve: 99.41
2024-09-04 15:35:43,360 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 15:38:38,436 [foster.py] => Exemplar size: 1600
2024-09-04 15:38:38,436 [trainer.py] => CNN: {'total': 87.55, '00-19': 94.55, '20-39': 93.3, '40-59': 84.5, '60-79': 77.85, 'old': 90.78, 'new': 77.85}
2024-09-04 15:38:38,436 [trainer.py] => NME: {'total': 90.29, '00-19': 91.05, '20-39': 92.7, '40-59': 85.0, '60-79': 92.4, 'old': 89.58, 'new': 92.4}
2024-09-04 15:38:38,436 [trainer.py] => CNN top1 curve: [97.5, 93.45, 90.68, 87.55]
2024-09-04 15:38:38,436 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.47, 99.38]
2024-09-04 15:38:38,436 [trainer.py] => NME top1 curve: [97.25, 95.05, 93.0, 90.29]
2024-09-04 15:38:38,436 [trainer.py] => NME top5 curve: [99.85, 99.55, 99.47, 99.35]

Average Accuracy (CNN): 92.3
Average Accuracy (NME): 93.9
2024-09-04 15:38:38,437 [trainer.py] => Average Accuracy (CNN): 92.3
2024-09-04 15:38:38,437 [trainer.py] => Average Accuracy (NME): 93.9
2024-09-04 15:38:38,438 [trainer.py] => All params: 171827932
2024-09-04 15:38:38,439 [trainer.py] => Trainable params: 85983136
2024-09-04 15:38:40,005 [foster.py] => Learning on 80-100
2024-09-04 15:38:40,007 [foster.py] => All params: 171889432
2024-09-04 15:38:40,008 [foster.py] => Trainable params: 86029256
2024-09-04 15:38:40,162 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.867, Loss_clf 0.930, Loss_fe 1.453, Loss_kd 1.987, Train_accy 50.50, Test_accy 81.87:   0%|          | 0/20 [02:48<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.867, Loss_clf 0.930, Loss_fe 1.453, Loss_kd 1.987, Train_accy 50.50, Test_accy 81.87:   5%|▌         | 1/20 [02:48<53:19, 168.41s/it]
Task 4, Epoch 2/20 => Loss 3.920, Loss_clf 0.590, Loss_fe 0.857, Loss_kd 1.979, Train_accy 57.75:   5%|▌         | 1/20 [04:42<53:19, 168.41s/it]                 
Task 4, Epoch 2/20 => Loss 3.920, Loss_clf 0.590, Loss_fe 0.857, Loss_kd 1.979, Train_accy 57.75:  10%|█         | 2/20 [04:42<41:01, 136.73s/it]
Task 4, Epoch 3/20 => Loss 3.664, Loss_clf 0.513, Loss_fe 0.673, Loss_kd 1.983, Train_accy 61.09:  10%|█         | 2/20 [06:37<41:01, 136.73s/it]
Task 4, Epoch 3/20 => Loss 3.664, Loss_clf 0.513, Loss_fe 0.673, Loss_kd 1.983, Train_accy 61.09:  15%|█▌        | 3/20 [06:37<35:51, 126.55s/it]
Task 4, Epoch 4/20 => Loss 3.557, Loss_clf 0.469, Loss_fe 0.609, Loss_kd 1.983, Train_accy 63.39:  15%|█▌        | 3/20 [08:31<35:51, 126.55s/it]
Task 4, Epoch 4/20 => Loss 3.557, Loss_clf 0.469, Loss_fe 0.609, Loss_kd 1.983, Train_accy 63.39:  20%|██        | 4/20 [08:31<32:28, 121.77s/it]
Task 4, Epoch 5/20 => Loss 3.463, Loss_clf 0.449, Loss_fe 0.554, Loss_kd 1.968, Train_accy 65.37:  20%|██        | 4/20 [10:26<32:28, 121.77s/it]
Task 4, Epoch 5/20 => Loss 3.463, Loss_clf 0.449, Loss_fe 0.554, Loss_kd 1.968, Train_accy 65.37:  25%|██▌       | 5/20 [10:26<29:47, 119.13s/it]
Task 4, Epoch 6/20 => Loss 3.384, Loss_clf 0.416, Loss_fe 0.508, Loss_kd 1.968, Train_accy 67.08, Test_accy 85.50:  25%|██▌       | 5/20 [13:14<29:47, 119.13s/it]
Task 4, Epoch 6/20 => Loss 3.384, Loss_clf 0.416, Loss_fe 0.508, Loss_kd 1.968, Train_accy 67.08, Test_accy 85.50:  30%|███       | 6/20 [13:14<31:42, 135.87s/it]
Task 4, Epoch 7/20 => Loss 3.323, Loss_clf 0.394, Loss_fe 0.462, Loss_kd 1.974, Train_accy 68.96:  30%|███       | 6/20 [15:09<31:42, 135.87s/it]                 
Task 4, Epoch 7/20 => Loss 3.323, Loss_clf 0.394, Loss_fe 0.462, Loss_kd 1.974, Train_accy 68.96:  35%|███▌      | 7/20 [15:09<27:55, 128.88s/it]
Task 4, Epoch 8/20 => Loss 3.278, Loss_clf 0.380, Loss_fe 0.435, Loss_kd 1.971, Train_accy 70.22:  35%|███▌      | 7/20 [17:03<27:55, 128.88s/it]
Task 4, Epoch 8/20 => Loss 3.278, Loss_clf 0.380, Loss_fe 0.435, Loss_kd 1.971, Train_accy 70.22:  40%|████      | 8/20 [17:03<24:51, 124.28s/it]
Task 4, Epoch 9/20 => Loss 3.177, Loss_clf 0.343, Loss_fe 0.381, Loss_kd 1.963, Train_accy 71.57:  40%|████      | 8/20 [18:58<24:51, 124.28s/it]
Task 4, Epoch 9/20 => Loss 3.177, Loss_clf 0.343, Loss_fe 0.381, Loss_kd 1.963, Train_accy 71.57:  45%|████▌     | 9/20 [18:58<22:13, 121.22s/it]
Task 4, Epoch 10/20 => Loss 3.173, Loss_clf 0.334, Loss_fe 0.370, Loss_kd 1.975, Train_accy 73.16:  45%|████▌     | 9/20 [20:52<22:13, 121.22s/it]
Task 4, Epoch 10/20 => Loss 3.173, Loss_clf 0.334, Loss_fe 0.370, Loss_kd 1.975, Train_accy 73.16:  50%|█████     | 10/20 [20:52<19:51, 119.14s/it]
Task 4, Epoch 11/20 => Loss 3.156, Loss_clf 0.334, Loss_fe 0.356, Loss_kd 1.973, Train_accy 74.27, Test_accy 86.42:  50%|█████     | 10/20 [23:40<19:51, 119.14s/it]
Task 4, Epoch 11/20 => Loss 3.156, Loss_clf 0.334, Loss_fe 0.356, Loss_kd 1.973, Train_accy 74.27, Test_accy 86.42:  55%|█████▌    | 11/20 [23:40<20:07, 134.15s/it]
Task 4, Epoch 12/20 => Loss 3.103, Loss_clf 0.311, Loss_fe 0.324, Loss_kd 1.974, Train_accy 74.74:  55%|█████▌    | 11/20 [25:35<20:07, 134.15s/it]                 
Task 4, Epoch 12/20 => Loss 3.103, Loss_clf 0.311, Loss_fe 0.324, Loss_kd 1.974, Train_accy 74.74:  60%|██████    | 12/20 [25:35<17:05, 128.16s/it]
Task 4, Epoch 13/20 => Loss 3.071, Loss_clf 0.296, Loss_fe 0.308, Loss_kd 1.973, Train_accy 75.49:  60%|██████    | 12/20 [27:29<17:05, 128.16s/it]
Task 4, Epoch 13/20 => Loss 3.071, Loss_clf 0.296, Loss_fe 0.308, Loss_kd 1.973, Train_accy 75.49:  65%|██████▌   | 13/20 [27:29<14:27, 123.99s/it]
Task 4, Epoch 14/20 => Loss 2.983, Loss_clf 0.269, Loss_fe 0.260, Loss_kd 1.963, Train_accy 78.83:  65%|██████▌   | 13/20 [29:24<14:27, 123.99s/it]
Task 4, Epoch 14/20 => Loss 2.983, Loss_clf 0.269, Loss_fe 0.260, Loss_kd 1.963, Train_accy 78.83:  70%|███████   | 14/20 [29:24<12:06, 121.11s/it]
Task 4, Epoch 15/20 => Loss 3.017, Loss_clf 0.279, Loss_fe 0.272, Loss_kd 1.972, Train_accy 77.88:  70%|███████   | 14/20 [31:18<12:06, 121.11s/it]
Task 4, Epoch 15/20 => Loss 3.017, Loss_clf 0.279, Loss_fe 0.272, Loss_kd 1.972, Train_accy 77.88:  75%|███████▌  | 15/20 [31:18<09:55, 119.11s/it]
Task 4, Epoch 16/20 => Loss 2.970, Loss_clf 0.270, Loss_fe 0.260, Loss_kd 1.952, Train_accy 78.18, Test_accy 87.00:  75%|███████▌  | 15/20 [34:06<09:55, 119.11s/it]
Task 4, Epoch 16/20 => Loss 2.970, Loss_clf 0.270, Loss_fe 0.260, Loss_kd 1.952, Train_accy 78.18, Test_accy 87.00:  80%|████████  | 16/20 [34:06<08:55, 133.89s/it]
Task 4, Epoch 17/20 => Loss 2.985, Loss_clf 0.268, Loss_fe 0.249, Loss_kd 1.974, Train_accy 78.57:  80%|████████  | 16/20 [36:01<08:55, 133.89s/it]                 
Task 4, Epoch 17/20 => Loss 2.985, Loss_clf 0.268, Loss_fe 0.249, Loss_kd 1.974, Train_accy 78.57:  85%|████████▌ | 17/20 [36:01<06:24, 128.04s/it]
Task 4, Epoch 18/20 => Loss 2.976, Loss_clf 0.256, Loss_fe 0.241, Loss_kd 1.983, Train_accy 79.39:  85%|████████▌ | 17/20 [37:55<06:24, 128.04s/it]
Task 4, Epoch 18/20 => Loss 2.976, Loss_clf 0.256, Loss_fe 0.241, Loss_kd 1.983, Train_accy 79.39:  90%|█████████ | 18/20 [37:55<04:07, 123.95s/it]
Task 4, Epoch 19/20 => Loss 2.966, Loss_clf 0.260, Loss_fe 0.245, Loss_kd 1.969, Train_accy 79.43:  90%|█████████ | 18/20 [39:49<04:07, 123.95s/it]
Task 4, Epoch 19/20 => Loss 2.966, Loss_clf 0.260, Loss_fe 0.245, Loss_kd 1.969, Train_accy 79.43:  95%|█████████▌| 19/20 [39:49<02:01, 121.08s/it]
Task 4, Epoch 20/20 => Loss 2.959, Loss_clf 0.259, Loss_fe 0.240, Loss_kd 1.968, Train_accy 79.76:  95%|█████████▌| 19/20 [41:44<02:01, 121.08s/it]
Task 4, Epoch 20/20 => Loss 2.959, Loss_clf 0.259, Loss_fe 0.240, Loss_kd 1.968, Train_accy 79.76: 100%|██████████| 20/20 [41:44<00:00, 119.09s/it]
Task 4, Epoch 20/20 => Loss 2.959, Loss_clf 0.259, Loss_fe 0.240, Loss_kd 1.968, Train_accy 79.76: 100%|██████████| 20/20 [41:44<00:00, 125.22s/it]
2024-09-04 16:20:24,593 [foster.py] => Task 4, Epoch 20/20 => Loss 2.959, Loss_clf 0.259, Loss_fe 0.240, Loss_kd 1.968, Train_accy 79.76
2024-09-04 16:20:24,594 [foster.py] => do not weight align teacher!
2024-09-04 16:20:24,601 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 2.293,  Train_accy 53.66, Test_accy 84.73:   0%|          | 0/20 [02:52<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 2.293,  Train_accy 53.66, Test_accy 84.73:   5%|▌         | 1/20 [02:52<54:32, 172.26s/it]
SNet: Task 4, Epoch 2/20 => Loss 2.099,  Train_accy 61.07:   5%|▌         | 1/20 [05:16<54:32, 172.26s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 2.099,  Train_accy 61.07:  10%|█         | 2/20 [05:16<46:44, 155.81s/it]
SNet: Task 4, Epoch 3/20 => Loss 2.088,  Train_accy 62.27:  10%|█         | 2/20 [07:40<46:44, 155.81s/it]
SNet: Task 4, Epoch 3/20 => Loss 2.088,  Train_accy 62.27:  15%|█▌        | 3/20 [07:40<42:38, 150.52s/it]
SNet: Task 4, Epoch 4/20 => Loss 2.089,  Train_accy 62.92:  15%|█▌        | 3/20 [10:05<42:38, 150.52s/it]
SNet: Task 4, Epoch 4/20 => Loss 2.089,  Train_accy 62.92:  20%|██        | 4/20 [10:05<39:28, 148.05s/it]
SNet: Task 4, Epoch 5/20 => Loss 2.078,  Train_accy 62.92:  20%|██        | 4/20 [12:29<39:28, 148.05s/it]
SNet: Task 4, Epoch 5/20 => Loss 2.078,  Train_accy 62.92:  25%|██▌       | 5/20 [12:29<36:39, 146.67s/it]
SNet: Task 4, Epoch 6/20 => Loss 2.053,  Train_accy 63.29, Test_accy 85.20:  25%|██▌       | 5/20 [15:21<36:39, 146.67s/it]
SNet: Task 4, Epoch 6/20 => Loss 2.053,  Train_accy 63.29, Test_accy 85.20:  30%|███       | 6/20 [15:21<36:14, 155.33s/it]
SNet: Task 4, Epoch 7/20 => Loss 2.075,  Train_accy 63.07:  30%|███       | 6/20 [17:45<36:14, 155.33s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 2.075,  Train_accy 63.07:  35%|███▌      | 7/20 [17:45<32:52, 151.70s/it]
SNet: Task 4, Epoch 8/20 => Loss 2.061,  Train_accy 63.79:  35%|███▌      | 7/20 [20:09<32:52, 151.70s/it]
SNet: Task 4, Epoch 8/20 => Loss 2.061,  Train_accy 63.79:  40%|████      | 8/20 [20:09<29:51, 149.31s/it]
SNet: Task 4, Epoch 9/20 => Loss 2.057,  Train_accy 63.74:  40%|████      | 8/20 [22:34<29:51, 149.31s/it]
SNet: Task 4, Epoch 9/20 => Loss 2.057,  Train_accy 63.74:  45%|████▌     | 9/20 [22:34<27:05, 147.76s/it]
SNet: Task 4, Epoch 10/20 => Loss 2.065,  Train_accy 63.82:  45%|████▌     | 9/20 [24:58<27:05, 147.76s/it]
SNet: Task 4, Epoch 10/20 => Loss 2.065,  Train_accy 63.82:  50%|█████     | 10/20 [24:58<24:26, 146.68s/it]
SNet: Task 4, Epoch 11/20 => Loss 2.063,  Train_accy 63.65, Test_accy 85.32:  50%|█████     | 10/20 [27:50<24:26, 146.68s/it]
SNet: Task 4, Epoch 11/20 => Loss 2.063,  Train_accy 63.65, Test_accy 85.32:  55%|█████▌    | 11/20 [27:50<23:11, 154.56s/it]
SNet: Task 4, Epoch 12/20 => Loss 2.054,  Train_accy 63.81:  55%|█████▌    | 11/20 [30:15<23:11, 154.56s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 2.054,  Train_accy 63.81:  60%|██████    | 12/20 [30:15<20:11, 151.45s/it]
SNet: Task 4, Epoch 13/20 => Loss 2.065,  Train_accy 64.02:  60%|██████    | 12/20 [32:39<20:11, 151.45s/it]
SNet: Task 4, Epoch 13/20 => Loss 2.065,  Train_accy 64.02:  65%|██████▌   | 13/20 [32:39<17:25, 149.31s/it]
SNet: Task 4, Epoch 14/20 => Loss 2.062,  Train_accy 64.01:  65%|██████▌   | 13/20 [35:03<17:25, 149.31s/it]
SNet: Task 4, Epoch 14/20 => Loss 2.062,  Train_accy 64.01:  70%|███████   | 14/20 [35:03<14:46, 147.80s/it]
SNet: Task 4, Epoch 15/20 => Loss 2.072,  Train_accy 64.16:  70%|███████   | 14/20 [37:28<14:46, 147.80s/it]
SNet: Task 4, Epoch 15/20 => Loss 2.072,  Train_accy 64.16:  75%|███████▌  | 15/20 [37:28<12:13, 146.74s/it]
SNet: Task 4, Epoch 16/20 => Loss 2.051,  Train_accy 63.69, Test_accy 85.14:  75%|███████▌  | 15/20 [40:20<12:13, 146.74s/it]
SNet: Task 4, Epoch 16/20 => Loss 2.051,  Train_accy 63.69, Test_accy 85.14:  80%|████████  | 16/20 [40:20<10:17, 154.46s/it]
SNet: Task 4, Epoch 17/20 => Loss 2.071,  Train_accy 63.59:  80%|████████  | 16/20 [42:44<10:17, 154.46s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 2.071,  Train_accy 63.59:  85%|████████▌ | 17/20 [42:44<07:34, 151.43s/it]
SNet: Task 4, Epoch 18/20 => Loss 2.059,  Train_accy 63.53:  85%|████████▌ | 17/20 [45:09<07:34, 151.43s/it]
SNet: Task 4, Epoch 18/20 => Loss 2.059,  Train_accy 63.53:  90%|█████████ | 18/20 [45:09<04:58, 149.28s/it]
SNet: Task 4, Epoch 19/20 => Loss 2.054,  Train_accy 64.13:  90%|█████████ | 18/20 [47:33<04:58, 149.28s/it]
SNet: Task 4, Epoch 19/20 => Loss 2.054,  Train_accy 64.13:  95%|█████████▌| 19/20 [47:33<02:27, 147.78s/it]
SNet: Task 4, Epoch 20/20 => Loss 2.050,  Train_accy 64.27:  95%|█████████▌| 19/20 [49:57<02:27, 147.78s/it]
SNet: Task 4, Epoch 20/20 => Loss 2.050,  Train_accy 64.27: 100%|██████████| 20/20 [49:57<00:00, 146.72s/it]
SNet: Task 4, Epoch 20/20 => Loss 2.050,  Train_accy 64.27: 100%|██████████| 20/20 [49:57<00:00, 149.89s/it]
2024-09-04 17:10:23,937 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 2.050,  Train_accy 64.27
2024-09-04 17:10:23,937 [foster.py] => do not weight align student!
2024-09-04 17:10:52,221 [foster.py] => darknet eval: 
2024-09-04 17:10:52,222 [foster.py] => CNN top1 curve: 85.18
2024-09-04 17:10:52,222 [foster.py] => CNN top5 curve: 99.03
2024-09-04 17:10:52,224 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 17:14:19,899 [foster.py] => Exemplar size: 2000
2024-09-04 17:14:19,899 [trainer.py] => CNN: {'total': 87.09, '00-19': 94.45, '20-39': 93.3, '40-59': 86.65, '60-79': 80.85, '80-99': 80.2, 'old': 88.81, 'new': 80.2}
2024-09-04 17:14:19,899 [trainer.py] => NME: {'total': 89.64, '00-19': 90.4, '20-39': 92.0, '40-59': 85.05, '60-79': 86.65, '80-99': 94.1, 'old': 88.52, 'new': 94.1}
2024-09-04 17:14:19,899 [trainer.py] => CNN top1 curve: [97.5, 93.45, 90.68, 87.55, 87.09]
2024-09-04 17:14:19,899 [trainer.py] => CNN top5 curve: [99.85, 99.52, 99.47, 99.38, 99.12]
2024-09-04 17:14:19,899 [trainer.py] => NME top1 curve: [97.25, 95.05, 93.0, 90.29, 89.64]
2024-09-04 17:14:19,899 [trainer.py] => NME top5 curve: [99.85, 99.55, 99.47, 99.35, 98.88]

Average Accuracy (CNN): 91.25
Average Accuracy (NME): 93.05
2024-09-04 17:14:19,900 [trainer.py] => Average Accuracy (CNN): 91.25
2024-09-04 17:14:19,900 [trainer.py] => Average Accuracy (NME): 93.05
Accuracy Matrix (CNN):
[[97.5  96.5  95.9  94.55 94.45]
 [ 0.   90.4  91.2  93.3  93.3 ]
 [ 0.    0.   84.95 84.5  86.65]
 [ 0.    0.    0.   77.85 80.85]
 [ 0.    0.    0.    0.   80.2 ]]
2024-09-04 17:14:19,900 [trainer.py] => Forgetting (CNN): 0.7624999999999993
Accuracy Matrix (NME):
[[97.25 93.55 92.05 91.05 90.4 ]
 [ 0.   96.55 92.75 92.7  92.  ]
 [ 0.    0.   94.2  85.   85.05]
 [ 0.    0.    0.   92.4  86.65]
 [ 0.    0.    0.    0.   94.1 ]]
2024-09-04 17:14:19,900 [trainer.py] => Forgetting (NME): 6.574999999999999
2024-09-04 17:14:22,973 [trainer.py] => config: ./exps/foster_cifar_B0_Inc10.json
2024-09-04 17:14:22,973 [trainer.py] => prefix: cil
2024-09-04 17:14:22,973 [trainer.py] => dataset: cifar224
2024-09-04 17:14:22,973 [trainer.py] => memory_size: 2000
2024-09-04 17:14:22,973 [trainer.py] => memory_per_class: 20
2024-09-04 17:14:22,973 [trainer.py] => fixed_memory: True
2024-09-04 17:14:22,974 [trainer.py] => shuffle: True
2024-09-04 17:14:22,974 [trainer.py] => init_cls: 10
2024-09-04 17:14:22,974 [trainer.py] => increment: 10
2024-09-04 17:14:22,974 [trainer.py] => model_name: foster
2024-09-04 17:14:22,974 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 17:14:22,974 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-04 17:14:22,974 [trainer.py] => seed: 1993
2024-09-04 17:14:22,974 [trainer.py] => beta1: 0.96
2024-09-04 17:14:22,974 [trainer.py] => beta2: 0.97
2024-09-04 17:14:22,974 [trainer.py] => oofc: ft
2024-09-04 17:14:22,974 [trainer.py] => is_teacher_wa: False
2024-09-04 17:14:22,974 [trainer.py] => is_student_wa: False
2024-09-04 17:14:22,974 [trainer.py] => lambda_okd: 1
2024-09-04 17:14:22,974 [trainer.py] => wa_value: 1
2024-09-04 17:14:22,974 [trainer.py] => init_epochs: 20
2024-09-04 17:14:22,974 [trainer.py] => init_lr: 0.001
2024-09-04 17:14:22,974 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 17:14:22,974 [trainer.py] => boosting_epochs: 20
2024-09-04 17:14:22,974 [trainer.py] => compression_epochs: 20
2024-09-04 17:14:22,974 [trainer.py] => lr: 0.001
2024-09-04 17:14:22,974 [trainer.py] => batch_size: 48
2024-09-04 17:14:22,974 [trainer.py] => weight_decay: 0.0005
2024-09-04 17:14:22,974 [trainer.py] => num_workers: 8
2024-09-04 17:14:22,974 [trainer.py] => T: 2
2024-09-04 17:14:24,071 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 17:14:24,458 [trainer.py] => All params: 0
2024-09-04 17:14:24,458 [trainer.py] => Trainable params: 0
2024-09-04 17:14:26,249 [foster.py] => Learning on 0-10
2024-09-04 17:14:26,250 [foster.py] => All params: 85814036
2024-09-04 17:14:26,251 [foster.py] => Trainable params: 85814036

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.279, Train_accy 18.40, Test_accy 43.60:   0%|          | 0/20 [00:39<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.279, Train_accy 18.40, Test_accy 43.60:   5%|▌         | 1/20 [00:39<12:38, 39.93s/it]
Task 0, Epoch 2/20 => Loss 0.965, Train_accy 67.88:   5%|▌         | 1/20 [01:16<12:38, 39.93s/it]                 
Task 0, Epoch 2/20 => Loss 0.965, Train_accy 67.88:  10%|█         | 2/20 [01:16<11:22, 37.91s/it]
Task 0, Epoch 3/20 => Loss 0.451, Train_accy 85.40:  10%|█         | 2/20 [01:52<11:22, 37.91s/it]
Task 0, Epoch 3/20 => Loss 0.451, Train_accy 85.40:  15%|█▌        | 3/20 [01:52<10:33, 37.28s/it]
Task 0, Epoch 4/20 => Loss 0.345, Train_accy 88.70:  15%|█▌        | 3/20 [02:29<10:33, 37.28s/it]
Task 0, Epoch 4/20 => Loss 0.345, Train_accy 88.70:  20%|██        | 4/20 [02:29<09:51, 36.99s/it]
Task 0, Epoch 5/20 => Loss 0.305, Train_accy 89.96:  20%|██        | 4/20 [03:06<09:51, 36.99s/it]
Task 0, Epoch 5/20 => Loss 0.305, Train_accy 89.96:  25%|██▌       | 5/20 [03:06<09:12, 36.83s/it]
Task 0, Epoch 6/20 => Loss 0.280, Train_accy 91.30, Test_accy 98.90:  25%|██▌       | 5/20 [03:45<09:12, 36.83s/it]
Task 0, Epoch 6/20 => Loss 0.280, Train_accy 91.30, Test_accy 98.90:  30%|███       | 6/20 [03:45<08:49, 37.79s/it]
Task 0, Epoch 7/20 => Loss 0.241, Train_accy 92.02:  30%|███       | 6/20 [04:22<08:49, 37.79s/it]                 
Task 0, Epoch 7/20 => Loss 0.241, Train_accy 92.02:  35%|███▌      | 7/20 [04:22<08:06, 37.39s/it]
Task 0, Epoch 8/20 => Loss 0.204, Train_accy 93.52:  35%|███▌      | 7/20 [04:58<08:06, 37.39s/it]
Task 0, Epoch 8/20 => Loss 0.204, Train_accy 93.52:  40%|████      | 8/20 [04:58<07:25, 37.13s/it]
Task 0, Epoch 9/20 => Loss 0.213, Train_accy 92.90:  40%|████      | 8/20 [05:35<07:25, 37.13s/it]
Task 0, Epoch 9/20 => Loss 0.213, Train_accy 92.90:  45%|████▌     | 9/20 [05:35<06:46, 36.94s/it]
Task 0, Epoch 10/20 => Loss 0.207, Train_accy 93.28:  45%|████▌     | 9/20 [06:12<06:46, 36.94s/it]
Task 0, Epoch 10/20 => Loss 0.207, Train_accy 93.28:  50%|█████     | 10/20 [06:12<06:08, 36.85s/it]
Task 0, Epoch 11/20 => Loss 0.198, Train_accy 93.24, Test_accy 98.80:  50%|█████     | 10/20 [06:51<06:08, 36.85s/it]
Task 0, Epoch 11/20 => Loss 0.198, Train_accy 93.24, Test_accy 98.80:  55%|█████▌    | 11/20 [06:51<05:39, 37.71s/it]
Task 0, Epoch 12/20 => Loss 0.175, Train_accy 93.84:  55%|█████▌    | 11/20 [07:28<05:39, 37.71s/it]                 
Task 0, Epoch 12/20 => Loss 0.175, Train_accy 93.84:  60%|██████    | 12/20 [07:28<04:58, 37.37s/it]
Task 0, Epoch 13/20 => Loss 0.165, Train_accy 94.40:  60%|██████    | 12/20 [08:04<04:58, 37.37s/it]
Task 0, Epoch 13/20 => Loss 0.165, Train_accy 94.40:  65%|██████▌   | 13/20 [08:04<04:19, 37.13s/it]
Task 0, Epoch 14/20 => Loss 0.165, Train_accy 94.78:  65%|██████▌   | 13/20 [08:41<04:19, 37.13s/it]
Task 0, Epoch 14/20 => Loss 0.165, Train_accy 94.78:  70%|███████   | 14/20 [08:41<03:41, 36.97s/it]
Task 0, Epoch 15/20 => Loss 0.152, Train_accy 94.74:  70%|███████   | 14/20 [09:18<03:41, 36.97s/it]
Task 0, Epoch 15/20 => Loss 0.152, Train_accy 94.74:  75%|███████▌  | 15/20 [09:18<03:04, 36.88s/it]
Task 0, Epoch 16/20 => Loss 0.140, Train_accy 95.44, Test_accy 99.20:  75%|███████▌  | 15/20 [09:57<03:04, 36.88s/it]
Task 0, Epoch 16/20 => Loss 0.140, Train_accy 95.44, Test_accy 99.20:  80%|████████  | 16/20 [09:57<02:30, 37.71s/it]
Task 0, Epoch 17/20 => Loss 0.123, Train_accy 95.78:  80%|████████  | 16/20 [10:34<02:30, 37.71s/it]                 
Task 0, Epoch 17/20 => Loss 0.123, Train_accy 95.78:  85%|████████▌ | 17/20 [10:34<01:52, 37.36s/it]
Task 0, Epoch 18/20 => Loss 0.147, Train_accy 95.14:  85%|████████▌ | 17/20 [11:10<01:52, 37.36s/it]
Task 0, Epoch 18/20 => Loss 0.147, Train_accy 95.14:  90%|█████████ | 18/20 [11:10<01:14, 37.14s/it]
Task 0, Epoch 19/20 => Loss 0.140, Train_accy 95.62:  90%|█████████ | 18/20 [11:47<01:14, 37.14s/it]
Task 0, Epoch 19/20 => Loss 0.140, Train_accy 95.62:  95%|█████████▌| 19/20 [11:47<00:36, 36.97s/it]
Task 0, Epoch 20/20 => Loss 0.138, Train_accy 95.54:  95%|█████████▌| 19/20 [12:24<00:36, 36.97s/it]
Task 0, Epoch 20/20 => Loss 0.138, Train_accy 95.54: 100%|██████████| 20/20 [12:24<00:00, 36.85s/it]
Task 0, Epoch 20/20 => Loss 0.138, Train_accy 95.54: 100%|██████████| 20/20 [12:24<00:00, 37.20s/it]
2024-09-04 17:26:50,799 [foster.py] => Task 0, Epoch 20/20 => Loss 0.138, Train_accy 95.54
2024-09-04 17:26:50,800 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 17:27:16,403 [foster.py] => Exemplar size: 200
2024-09-04 17:27:16,403 [trainer.py] => CNN: {'total': 99.2, '00-09': 99.2, 'old': 0, 'new': 99.2}
2024-09-04 17:27:16,403 [trainer.py] => NME: {'total': 99.2, '00-09': 99.2, 'old': 0, 'new': 99.2}
2024-09-04 17:27:16,403 [trainer.py] => CNN top1 curve: [99.2]
2024-09-04 17:27:16,403 [trainer.py] => CNN top5 curve: [100.0]
2024-09-04 17:27:16,403 [trainer.py] => NME top1 curve: [99.2]
2024-09-04 17:27:16,403 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.2
Average Accuracy (NME): 99.2
2024-09-04 17:27:16,404 [trainer.py] => Average Accuracy (CNN): 99.2
2024-09-04 17:27:16,404 [trainer.py] => Average Accuracy (NME): 99.2
2024-09-04 17:27:16,404 [trainer.py] => All params: 85814036
2024-09-04 17:27:16,405 [trainer.py] => Trainable params: 85814036
2024-09-04 17:27:17,937 [foster.py] => Learning on 10-20
2024-09-04 17:27:17,939 [foster.py] => All params: 171651122
2024-09-04 17:27:17,940 [foster.py] => Trainable params: 85844776
2024-09-04 17:27:18,027 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.223, Loss_clf 0.778, Loss_fe 1.093, Loss_kd 0.676, Train_accy 74.38, Test_accy 95.05:   0%|          | 0/20 [01:02<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.223, Loss_clf 0.778, Loss_fe 1.093, Loss_kd 0.676, Train_accy 74.38, Test_accy 95.05:   5%|▌         | 1/20 [01:02<19:47, 62.52s/it]
Task 1, Epoch 2/20 => Loss 2.337, Loss_clf 0.409, Loss_fe 0.590, Loss_kd 0.669, Train_accy 81.88:   5%|▌         | 1/20 [01:54<19:47, 62.52s/it]                 
Task 1, Epoch 2/20 => Loss 2.337, Loss_clf 0.409, Loss_fe 0.590, Loss_kd 0.669, Train_accy 81.88:  10%|█         | 2/20 [01:54<16:48, 56.04s/it]
Task 1, Epoch 3/20 => Loss 2.181, Loss_clf 0.371, Loss_fe 0.475, Loss_kd 0.667, Train_accy 83.65:  10%|█         | 2/20 [02:45<16:48, 56.04s/it]
Task 1, Epoch 3/20 => Loss 2.181, Loss_clf 0.371, Loss_fe 0.475, Loss_kd 0.667, Train_accy 83.65:  15%|█▌        | 3/20 [02:45<15:17, 53.99s/it]
Task 1, Epoch 4/20 => Loss 2.131, Loss_clf 0.348, Loss_fe 0.443, Loss_kd 0.670, Train_accy 84.94:  15%|█▌        | 3/20 [03:37<15:17, 53.99s/it]
Task 1, Epoch 4/20 => Loss 2.131, Loss_clf 0.348, Loss_fe 0.443, Loss_kd 0.670, Train_accy 84.94:  20%|██        | 4/20 [03:37<14:08, 53.06s/it]
Task 1, Epoch 5/20 => Loss 2.032, Loss_clf 0.317, Loss_fe 0.383, Loss_kd 0.666, Train_accy 86.06:  20%|██        | 4/20 [04:28<14:08, 53.06s/it]
Task 1, Epoch 5/20 => Loss 2.032, Loss_clf 0.317, Loss_fe 0.383, Loss_kd 0.666, Train_accy 86.06:  25%|██▌       | 5/20 [04:28<13:07, 52.53s/it]
Task 1, Epoch 6/20 => Loss 1.984, Loss_clf 0.292, Loss_fe 0.354, Loss_kd 0.669, Train_accy 87.50, Test_accy 96.10:  25%|██▌       | 5/20 [05:31<13:07, 52.53s/it]
Task 1, Epoch 6/20 => Loss 1.984, Loss_clf 0.292, Loss_fe 0.354, Loss_kd 0.669, Train_accy 87.50, Test_accy 96.10:  30%|███       | 6/20 [05:31<13:03, 55.96s/it]
Task 1, Epoch 7/20 => Loss 1.912, Loss_clf 0.268, Loss_fe 0.309, Loss_kd 0.668, Train_accy 88.69:  30%|███       | 6/20 [06:22<13:03, 55.96s/it]                 
Task 1, Epoch 7/20 => Loss 1.912, Loss_clf 0.268, Loss_fe 0.309, Loss_kd 0.668, Train_accy 88.69:  35%|███▌      | 7/20 [06:22<11:48, 54.49s/it]
Task 1, Epoch 8/20 => Loss 1.899, Loss_clf 0.262, Loss_fe 0.300, Loss_kd 0.669, Train_accy 89.19:  35%|███▌      | 7/20 [07:14<11:48, 54.49s/it]
Task 1, Epoch 8/20 => Loss 1.899, Loss_clf 0.262, Loss_fe 0.300, Loss_kd 0.669, Train_accy 89.19:  40%|████      | 8/20 [07:14<10:42, 53.55s/it]
Task 1, Epoch 9/20 => Loss 1.911, Loss_clf 0.266, Loss_fe 0.305, Loss_kd 0.670, Train_accy 88.65:  40%|████      | 8/20 [08:06<10:42, 53.55s/it]
Task 1, Epoch 9/20 => Loss 1.911, Loss_clf 0.266, Loss_fe 0.305, Loss_kd 0.670, Train_accy 88.65:  45%|████▌     | 9/20 [08:06<09:42, 52.94s/it]
Task 1, Epoch 10/20 => Loss 1.873, Loss_clf 0.252, Loss_fe 0.274, Loss_kd 0.674, Train_accy 89.71:  45%|████▌     | 9/20 [08:57<09:42, 52.94s/it]
Task 1, Epoch 10/20 => Loss 1.873, Loss_clf 0.252, Loss_fe 0.274, Loss_kd 0.674, Train_accy 89.71:  50%|█████     | 10/20 [08:57<08:45, 52.53s/it]
Task 1, Epoch 11/20 => Loss 1.796, Loss_clf 0.221, Loss_fe 0.242, Loss_kd 0.667, Train_accy 90.10, Test_accy 96.05:  50%|█████     | 10/20 [10:00<08:45, 52.53s/it]
Task 1, Epoch 11/20 => Loss 1.796, Loss_clf 0.221, Loss_fe 0.242, Loss_kd 0.667, Train_accy 90.10, Test_accy 96.05:  55%|█████▌    | 11/20 [10:00<08:20, 55.64s/it]
Task 1, Epoch 12/20 => Loss 1.767, Loss_clf 0.216, Loss_fe 0.231, Loss_kd 0.660, Train_accy 90.13:  55%|█████▌    | 11/20 [10:51<08:20, 55.64s/it]                 
Task 1, Epoch 12/20 => Loss 1.767, Loss_clf 0.216, Loss_fe 0.231, Loss_kd 0.660, Train_accy 90.13:  60%|██████    | 12/20 [10:51<07:15, 54.38s/it]
Task 1, Epoch 13/20 => Loss 1.773, Loss_clf 0.214, Loss_fe 0.217, Loss_kd 0.671, Train_accy 90.88:  60%|██████    | 12/20 [11:43<07:15, 54.38s/it]
Task 1, Epoch 13/20 => Loss 1.773, Loss_clf 0.214, Loss_fe 0.217, Loss_kd 0.671, Train_accy 90.88:  65%|██████▌   | 13/20 [11:43<06:14, 53.52s/it]
Task 1, Epoch 14/20 => Loss 1.756, Loss_clf 0.209, Loss_fe 0.213, Loss_kd 0.667, Train_accy 91.06:  65%|██████▌   | 13/20 [12:34<06:14, 53.52s/it]
Task 1, Epoch 14/20 => Loss 1.756, Loss_clf 0.209, Loss_fe 0.213, Loss_kd 0.667, Train_accy 91.06:  70%|███████   | 14/20 [12:34<05:17, 52.92s/it]
Task 1, Epoch 15/20 => Loss 1.702, Loss_clf 0.188, Loss_fe 0.181, Loss_kd 0.667, Train_accy 91.77:  70%|███████   | 14/20 [13:26<05:17, 52.92s/it]
Task 1, Epoch 15/20 => Loss 1.702, Loss_clf 0.188, Loss_fe 0.181, Loss_kd 0.667, Train_accy 91.77:  75%|███████▌  | 15/20 [13:26<04:22, 52.52s/it]
Task 1, Epoch 16/20 => Loss 1.732, Loss_clf 0.200, Loss_fe 0.193, Loss_kd 0.669, Train_accy 91.92, Test_accy 96.65:  75%|███████▌  | 15/20 [14:29<04:22, 52.52s/it]
Task 1, Epoch 16/20 => Loss 1.732, Loss_clf 0.200, Loss_fe 0.193, Loss_kd 0.669, Train_accy 91.92, Test_accy 96.65:  80%|████████  | 16/20 [14:29<03:42, 55.55s/it]
Task 1, Epoch 17/20 => Loss 1.726, Loss_clf 0.198, Loss_fe 0.193, Loss_kd 0.668, Train_accy 91.94:  80%|████████  | 16/20 [15:20<03:42, 55.55s/it]                 
Task 1, Epoch 17/20 => Loss 1.726, Loss_clf 0.198, Loss_fe 0.193, Loss_kd 0.668, Train_accy 91.94:  85%|████████▌ | 17/20 [15:20<02:42, 54.33s/it]
Task 1, Epoch 18/20 => Loss 1.681, Loss_clf 0.174, Loss_fe 0.171, Loss_kd 0.668, Train_accy 92.83:  85%|████████▌ | 17/20 [16:12<02:42, 54.33s/it]
Task 1, Epoch 18/20 => Loss 1.681, Loss_clf 0.174, Loss_fe 0.171, Loss_kd 0.668, Train_accy 92.83:  90%|█████████ | 18/20 [16:12<01:46, 53.49s/it]
Task 1, Epoch 19/20 => Loss 1.723, Loss_clf 0.195, Loss_fe 0.188, Loss_kd 0.670, Train_accy 92.44:  90%|█████████ | 18/20 [17:03<01:46, 53.49s/it]
Task 1, Epoch 19/20 => Loss 1.723, Loss_clf 0.195, Loss_fe 0.188, Loss_kd 0.670, Train_accy 92.44:  95%|█████████▌| 19/20 [17:03<00:52, 52.92s/it]
Task 1, Epoch 20/20 => Loss 1.670, Loss_clf 0.174, Loss_fe 0.168, Loss_kd 0.664, Train_accy 92.79:  95%|█████████▌| 19/20 [17:55<00:52, 52.92s/it]
Task 1, Epoch 20/20 => Loss 1.670, Loss_clf 0.174, Loss_fe 0.168, Loss_kd 0.664, Train_accy 92.79: 100%|██████████| 20/20 [17:55<00:00, 52.50s/it]
Task 1, Epoch 20/20 => Loss 1.670, Loss_clf 0.174, Loss_fe 0.168, Loss_kd 0.664, Train_accy 92.79: 100%|██████████| 20/20 [17:55<00:00, 53.76s/it]
2024-09-04 17:45:13,244 [foster.py] => Task 1, Epoch 20/20 => Loss 1.670, Loss_clf 0.174, Loss_fe 0.168, Loss_kd 0.664, Train_accy 92.79
2024-09-04 17:45:13,244 [foster.py] => do not weight align teacher!
2024-09-04 17:45:13,246 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.289,  Train_accy 72.67, Test_accy 95.60:   0%|          | 0/20 [01:10<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.289,  Train_accy 72.67, Test_accy 95.60:   5%|▌         | 1/20 [01:10<22:25, 70.82s/it]
SNet: Task 1, Epoch 2/20 => Loss 0.980,  Train_accy 84.90:   5%|▌         | 1/20 [02:15<22:25, 70.82s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 0.980,  Train_accy 84.90:  10%|█         | 2/20 [02:15<20:11, 67.32s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.964,  Train_accy 86.31:  10%|█         | 2/20 [03:20<20:11, 67.32s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.964,  Train_accy 86.31:  15%|█▌        | 3/20 [03:20<18:45, 66.22s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.966,  Train_accy 86.67:  15%|█▌        | 3/20 [04:25<18:45, 66.22s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.966,  Train_accy 86.67:  20%|██        | 4/20 [04:25<17:31, 65.74s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.954,  Train_accy 86.54:  20%|██        | 4/20 [05:30<17:31, 65.74s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.954,  Train_accy 86.54:  25%|██▌       | 5/20 [05:30<16:21, 65.46s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.971,  Train_accy 87.10, Test_accy 95.95:  25%|██▌       | 5/20 [06:41<16:21, 65.46s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.971,  Train_accy 87.10, Test_accy 95.95:  30%|███       | 6/20 [06:41<15:41, 67.27s/it]
SNet: Task 1, Epoch 7/20 => Loss 0.959,  Train_accy 86.92:  30%|███       | 6/20 [07:46<15:41, 67.27s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 0.959,  Train_accy 86.92:  35%|███▌      | 7/20 [07:46<14:24, 66.49s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.947,  Train_accy 88.10:  35%|███▌      | 7/20 [08:51<14:24, 66.49s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.947,  Train_accy 88.10:  40%|████      | 8/20 [08:51<13:11, 65.98s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.923,  Train_accy 88.19:  40%|████      | 8/20 [09:56<13:11, 65.98s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.923,  Train_accy 88.19:  45%|████▌     | 9/20 [09:56<12:02, 65.64s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.945,  Train_accy 87.75:  45%|████▌     | 9/20 [11:00<12:02, 65.64s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.945,  Train_accy 87.75:  50%|█████     | 10/20 [11:00<10:53, 65.39s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.925,  Train_accy 87.96, Test_accy 96.30:  50%|█████     | 10/20 [12:11<10:53, 65.39s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.925,  Train_accy 87.96, Test_accy 96.30:  55%|█████▌    | 11/20 [12:11<10:03, 67.08s/it]
SNet: Task 1, Epoch 12/20 => Loss 0.949,  Train_accy 87.87:  55%|█████▌    | 11/20 [13:16<10:03, 67.08s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 0.949,  Train_accy 87.87:  60%|██████    | 12/20 [13:16<08:51, 66.44s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.933,  Train_accy 87.69:  60%|██████    | 12/20 [14:21<08:51, 66.44s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.933,  Train_accy 87.69:  65%|██████▌   | 13/20 [14:21<07:41, 65.97s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.943,  Train_accy 88.44:  65%|██████▌   | 13/20 [15:26<07:41, 65.97s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.943,  Train_accy 88.44:  70%|███████   | 14/20 [15:26<06:33, 65.64s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.948,  Train_accy 88.04:  70%|███████   | 14/20 [16:31<06:33, 65.64s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.948,  Train_accy 88.04:  75%|███████▌  | 15/20 [16:31<05:27, 65.44s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.944,  Train_accy 88.00, Test_accy 96.30:  75%|███████▌  | 15/20 [17:42<05:27, 65.44s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.944,  Train_accy 88.00, Test_accy 96.30:  80%|████████  | 16/20 [17:42<04:28, 67.10s/it]
SNet: Task 1, Epoch 17/20 => Loss 0.938,  Train_accy 87.77:  80%|████████  | 16/20 [18:47<04:28, 67.10s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 0.938,  Train_accy 87.77:  85%|████████▌ | 17/20 [18:47<03:19, 66.45s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.953,  Train_accy 87.88:  85%|████████▌ | 17/20 [19:52<03:19, 66.45s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.953,  Train_accy 87.88:  90%|█████████ | 18/20 [19:52<02:12, 66.03s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.942,  Train_accy 87.90:  90%|█████████ | 18/20 [20:57<02:12, 66.03s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.942,  Train_accy 87.90:  95%|█████████▌| 19/20 [20:57<01:05, 65.69s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.933,  Train_accy 88.29:  95%|█████████▌| 19/20 [22:02<01:05, 65.69s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.933,  Train_accy 88.29: 100%|██████████| 20/20 [22:02<00:00, 65.45s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.933,  Train_accy 88.29: 100%|██████████| 20/20 [22:02<00:00, 66.11s/it]
2024-09-04 18:07:17,633 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.933,  Train_accy 88.29
2024-09-04 18:07:17,633 [foster.py] => do not weight align student!
2024-09-04 18:07:23,708 [foster.py] => darknet eval: 
2024-09-04 18:07:23,708 [foster.py] => CNN top1 curve: 96.3
2024-09-04 18:07:23,708 [foster.py] => CNN top5 curve: 99.85
2024-09-04 18:07:23,709 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 18:08:23,070 [foster.py] => Exemplar size: 400
2024-09-04 18:08:23,070 [trainer.py] => CNN: {'total': 96.65, '00-09': 97.3, '10-19': 96.0, 'old': 97.3, 'new': 96.0}
2024-09-04 18:08:23,070 [trainer.py] => NME: {'total': 96.65, '00-09': 97.6, '10-19': 95.7, 'old': 97.6, 'new': 95.7}
2024-09-04 18:08:23,070 [trainer.py] => CNN top1 curve: [99.2, 96.65]
2024-09-04 18:08:23,070 [trainer.py] => CNN top5 curve: [100.0, 99.7]
2024-09-04 18:08:23,070 [trainer.py] => NME top1 curve: [99.2, 96.65]
2024-09-04 18:08:23,070 [trainer.py] => NME top5 curve: [100.0, 99.65]

Average Accuracy (CNN): 97.93
Average Accuracy (NME): 97.93
2024-09-04 18:08:23,070 [trainer.py] => Average Accuracy (CNN): 97.93
2024-09-04 18:08:23,070 [trainer.py] => Average Accuracy (NME): 97.93
2024-09-04 18:08:23,071 [trainer.py] => All params: 171651122
2024-09-04 18:08:23,072 [trainer.py] => Trainable params: 85844776
2024-09-04 18:08:25,429 [foster.py] => Learning on 20-30
2024-09-04 18:08:25,432 [foster.py] => All params: 171681872
2024-09-04 18:08:25,433 [foster.py] => Trainable params: 85867836
2024-09-04 18:08:25,541 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.261, Loss_clf 0.600, Loss_fe 0.877, Loss_kd 1.189, Train_accy 71.44, Test_accy 88.53:   0%|          | 0/20 [01:10<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.261, Loss_clf 0.600, Loss_fe 0.877, Loss_kd 1.189, Train_accy 71.44, Test_accy 88.53:   5%|▌         | 1/20 [01:10<22:10, 70.02s/it]
Task 2, Epoch 2/20 => Loss 2.540, Loss_clf 0.290, Loss_fe 0.495, Loss_kd 1.170, Train_accy 75.70:   5%|▌         | 1/20 [02:03<22:10, 70.02s/it]                 
Task 2, Epoch 2/20 => Loss 2.540, Loss_clf 0.290, Loss_fe 0.495, Loss_kd 1.170, Train_accy 75.70:  10%|█         | 2/20 [02:03<18:05, 60.29s/it]
Task 2, Epoch 3/20 => Loss 2.406, Loss_clf 0.278, Loss_fe 0.384, Loss_kd 1.163, Train_accy 76.67:  10%|█         | 2/20 [02:57<18:05, 60.29s/it]
Task 2, Epoch 3/20 => Loss 2.406, Loss_clf 0.278, Loss_fe 0.384, Loss_kd 1.163, Train_accy 76.67:  15%|█▌        | 3/20 [02:57<16:12, 57.22s/it]
Task 2, Epoch 4/20 => Loss 2.311, Loss_clf 0.239, Loss_fe 0.326, Loss_kd 1.164, Train_accy 79.22:  15%|█▌        | 3/20 [03:50<16:12, 57.22s/it]
Task 2, Epoch 4/20 => Loss 2.311, Loss_clf 0.239, Loss_fe 0.326, Loss_kd 1.164, Train_accy 79.22:  20%|██        | 4/20 [03:50<14:53, 55.83s/it]
Task 2, Epoch 5/20 => Loss 2.294, Loss_clf 0.238, Loss_fe 0.301, Loss_kd 1.170, Train_accy 81.09:  20%|██        | 4/20 [04:44<14:53, 55.83s/it]
Task 2, Epoch 5/20 => Loss 2.294, Loss_clf 0.238, Loss_fe 0.301, Loss_kd 1.170, Train_accy 81.09:  25%|██▌       | 5/20 [04:44<13:45, 55.04s/it]
Task 2, Epoch 6/20 => Loss 2.266, Loss_clf 0.227, Loss_fe 0.284, Loss_kd 1.170, Train_accy 80.98, Test_accy 92.57:  25%|██▌       | 5/20 [05:54<13:45, 55.04s/it]
Task 2, Epoch 6/20 => Loss 2.266, Loss_clf 0.227, Loss_fe 0.284, Loss_kd 1.170, Train_accy 80.98, Test_accy 92.57:  30%|███       | 6/20 [05:54<14:03, 60.24s/it]
Task 2, Epoch 7/20 => Loss 2.197, Loss_clf 0.206, Loss_fe 0.257, Loss_kd 1.156, Train_accy 84.06:  30%|███       | 6/20 [06:48<14:03, 60.24s/it]                 
Task 2, Epoch 7/20 => Loss 2.197, Loss_clf 0.206, Loss_fe 0.257, Loss_kd 1.156, Train_accy 84.06:  35%|███▌      | 7/20 [06:48<12:35, 58.11s/it]
Task 2, Epoch 8/20 => Loss 2.173, Loss_clf 0.199, Loss_fe 0.231, Loss_kd 1.162, Train_accy 83.43:  35%|███▌      | 7/20 [07:42<12:35, 58.11s/it]
Task 2, Epoch 8/20 => Loss 2.173, Loss_clf 0.199, Loss_fe 0.231, Loss_kd 1.162, Train_accy 83.43:  40%|████      | 8/20 [07:42<11:20, 56.72s/it]
Task 2, Epoch 9/20 => Loss 2.158, Loss_clf 0.192, Loss_fe 0.224, Loss_kd 1.161, Train_accy 84.63:  40%|████      | 8/20 [08:35<11:20, 56.72s/it]
Task 2, Epoch 9/20 => Loss 2.158, Loss_clf 0.192, Loss_fe 0.224, Loss_kd 1.161, Train_accy 84.63:  45%|████▌     | 9/20 [08:35<10:13, 55.76s/it]
Task 2, Epoch 10/20 => Loss 2.142, Loss_clf 0.181, Loss_fe 0.210, Loss_kd 1.168, Train_accy 85.31:  45%|████▌     | 9/20 [09:29<10:13, 55.76s/it]
Task 2, Epoch 10/20 => Loss 2.142, Loss_clf 0.181, Loss_fe 0.210, Loss_kd 1.168, Train_accy 85.31:  50%|█████     | 10/20 [09:29<09:10, 55.10s/it]
Task 2, Epoch 11/20 => Loss 2.126, Loss_clf 0.182, Loss_fe 0.197, Loss_kd 1.165, Train_accy 86.85, Test_accy 94.73:  50%|█████     | 10/20 [10:39<09:10, 55.10s/it]
Task 2, Epoch 11/20 => Loss 2.126, Loss_clf 0.182, Loss_fe 0.197, Loss_kd 1.165, Train_accy 86.85, Test_accy 94.73:  55%|█████▌    | 11/20 [10:39<08:57, 59.71s/it]
Task 2, Epoch 12/20 => Loss 2.115, Loss_clf 0.176, Loss_fe 0.192, Loss_kd 1.165, Train_accy 85.87:  55%|█████▌    | 11/20 [11:33<08:57, 59.71s/it]                 
Task 2, Epoch 12/20 => Loss 2.115, Loss_clf 0.176, Loss_fe 0.192, Loss_kd 1.165, Train_accy 85.87:  60%|██████    | 12/20 [11:33<07:42, 57.86s/it]
Task 2, Epoch 13/20 => Loss 2.124, Loss_clf 0.178, Loss_fe 0.189, Loss_kd 1.171, Train_accy 86.87:  60%|██████    | 12/20 [12:26<07:42, 57.86s/it]
Task 2, Epoch 13/20 => Loss 2.124, Loss_clf 0.178, Loss_fe 0.189, Loss_kd 1.171, Train_accy 86.87:  65%|██████▌   | 13/20 [12:26<06:36, 56.60s/it]
Task 2, Epoch 14/20 => Loss 2.077, Loss_clf 0.163, Loss_fe 0.169, Loss_kd 1.164, Train_accy 86.72:  65%|██████▌   | 13/20 [13:20<06:36, 56.60s/it]
Task 2, Epoch 14/20 => Loss 2.077, Loss_clf 0.163, Loss_fe 0.169, Loss_kd 1.164, Train_accy 86.72:  70%|███████   | 14/20 [13:20<05:34, 55.70s/it]
Task 2, Epoch 15/20 => Loss 2.067, Loss_clf 0.158, Loss_fe 0.157, Loss_kd 1.169, Train_accy 86.65:  70%|███████   | 14/20 [14:14<05:34, 55.70s/it]
Task 2, Epoch 15/20 => Loss 2.067, Loss_clf 0.158, Loss_fe 0.157, Loss_kd 1.169, Train_accy 86.65:  75%|███████▌  | 15/20 [14:14<04:35, 55.05s/it]
Task 2, Epoch 16/20 => Loss 2.054, Loss_clf 0.148, Loss_fe 0.148, Loss_kd 1.171, Train_accy 88.37, Test_accy 94.33:  75%|███████▌  | 15/20 [15:24<04:35, 55.05s/it]
Task 2, Epoch 16/20 => Loss 2.054, Loss_clf 0.148, Loss_fe 0.148, Loss_kd 1.171, Train_accy 88.37, Test_accy 94.33:  80%|████████  | 16/20 [15:24<03:58, 59.61s/it]
Task 2, Epoch 17/20 => Loss 2.025, Loss_clf 0.143, Loss_fe 0.138, Loss_kd 1.163, Train_accy 88.07:  80%|████████  | 16/20 [16:17<03:58, 59.61s/it]                 
Task 2, Epoch 17/20 => Loss 2.025, Loss_clf 0.143, Loss_fe 0.138, Loss_kd 1.163, Train_accy 88.07:  85%|████████▌ | 17/20 [16:17<02:53, 57.78s/it]
Task 2, Epoch 18/20 => Loss 2.017, Loss_clf 0.141, Loss_fe 0.134, Loss_kd 1.161, Train_accy 88.13:  85%|████████▌ | 17/20 [17:11<02:53, 57.78s/it]
Task 2, Epoch 18/20 => Loss 2.017, Loss_clf 0.141, Loss_fe 0.134, Loss_kd 1.161, Train_accy 88.13:  90%|█████████ | 18/20 [17:11<01:53, 56.54s/it]
Task 2, Epoch 19/20 => Loss 2.047, Loss_clf 0.153, Loss_fe 0.140, Loss_kd 1.170, Train_accy 88.04:  90%|█████████ | 18/20 [18:05<01:53, 56.54s/it]
Task 2, Epoch 19/20 => Loss 2.047, Loss_clf 0.153, Loss_fe 0.140, Loss_kd 1.170, Train_accy 88.04:  95%|█████████▌| 19/20 [18:05<00:55, 55.67s/it]
Task 2, Epoch 20/20 => Loss 2.005, Loss_clf 0.137, Loss_fe 0.130, Loss_kd 1.159, Train_accy 88.65:  95%|█████████▌| 19/20 [18:58<00:55, 55.67s/it]
Task 2, Epoch 20/20 => Loss 2.005, Loss_clf 0.137, Loss_fe 0.130, Loss_kd 1.159, Train_accy 88.65: 100%|██████████| 20/20 [18:58<00:00, 55.08s/it]
Task 2, Epoch 20/20 => Loss 2.005, Loss_clf 0.137, Loss_fe 0.130, Loss_kd 1.159, Train_accy 88.65: 100%|██████████| 20/20 [18:58<00:00, 56.94s/it]
2024-09-04 18:27:24,392 [foster.py] => Task 2, Epoch 20/20 => Loss 2.005, Loss_clf 0.137, Loss_fe 0.130, Loss_kd 1.159, Train_accy 88.65
2024-09-04 18:27:24,393 [foster.py] => do not weight align teacher!
2024-09-04 18:27:24,394 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.503,  Train_accy 67.72, Test_accy 92.40:   0%|          | 0/20 [01:16<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.503,  Train_accy 67.72, Test_accy 92.40:   5%|▌         | 1/20 [01:16<24:10, 76.33s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.257,  Train_accy 76.09:   5%|▌         | 1/20 [02:23<24:10, 76.33s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.257,  Train_accy 76.09:  10%|█         | 2/20 [02:23<21:20, 71.16s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.267,  Train_accy 75.67:  10%|█         | 2/20 [03:31<21:20, 71.16s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.267,  Train_accy 75.67:  15%|█▌        | 3/20 [03:31<19:41, 69.50s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.260,  Train_accy 76.96:  15%|█▌        | 3/20 [04:38<19:41, 69.50s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.260,  Train_accy 76.96:  20%|██        | 4/20 [04:38<18:19, 68.71s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.263,  Train_accy 76.98:  20%|██        | 4/20 [05:46<18:19, 68.71s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.263,  Train_accy 76.98:  25%|██▌       | 5/20 [05:46<17:04, 68.27s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.242,  Train_accy 77.74, Test_accy 91.93:  25%|██▌       | 5/20 [07:02<17:04, 68.27s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.242,  Train_accy 77.74, Test_accy 91.93:  30%|███       | 6/20 [07:02<16:33, 70.93s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.241,  Train_accy 77.85:  30%|███       | 6/20 [08:09<16:33, 70.93s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.241,  Train_accy 77.85:  35%|███▌      | 7/20 [08:09<15:07, 69.79s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.236,  Train_accy 77.87:  35%|███▌      | 7/20 [09:17<15:07, 69.79s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.236,  Train_accy 77.87:  40%|████      | 8/20 [09:17<13:48, 69.06s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.258,  Train_accy 77.37:  40%|████      | 8/20 [10:25<13:48, 69.06s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.258,  Train_accy 77.37:  45%|████▌     | 9/20 [10:25<12:34, 68.62s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.261,  Train_accy 77.13:  45%|████▌     | 9/20 [11:32<12:34, 68.62s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.261,  Train_accy 77.13:  50%|█████     | 10/20 [11:32<11:22, 68.27s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.248,  Train_accy 77.09, Test_accy 92.23:  50%|█████     | 10/20 [12:49<11:22, 68.27s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.248,  Train_accy 77.09, Test_accy 92.23:  55%|█████▌    | 11/20 [12:49<10:37, 70.79s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.251,  Train_accy 77.15:  55%|█████▌    | 11/20 [13:56<10:37, 70.79s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.251,  Train_accy 77.15:  60%|██████    | 12/20 [13:56<09:18, 69.85s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.261,  Train_accy 77.74:  60%|██████    | 12/20 [15:04<09:18, 69.85s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.261,  Train_accy 77.74:  65%|██████▌   | 13/20 [15:04<08:04, 69.15s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.245,  Train_accy 77.91:  65%|██████▌   | 13/20 [16:11<08:04, 69.15s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.245,  Train_accy 77.91:  70%|███████   | 14/20 [16:11<06:52, 68.69s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.245,  Train_accy 77.78:  70%|███████   | 14/20 [17:19<06:52, 68.69s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.245,  Train_accy 77.78:  75%|███████▌  | 15/20 [17:19<05:41, 68.33s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.237,  Train_accy 77.89, Test_accy 92.27:  75%|███████▌  | 15/20 [18:35<05:41, 68.33s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.237,  Train_accy 77.89, Test_accy 92.27:  80%|████████  | 16/20 [18:35<04:42, 70.70s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.236,  Train_accy 77.30:  80%|████████  | 16/20 [19:43<04:42, 70.70s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.236,  Train_accy 77.30:  85%|████████▌ | 17/20 [19:43<03:29, 69.72s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.245,  Train_accy 77.96:  85%|████████▌ | 17/20 [20:50<03:29, 69.72s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.245,  Train_accy 77.96:  90%|█████████ | 18/20 [20:50<02:18, 69.04s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.247,  Train_accy 77.35:  90%|█████████ | 18/20 [21:58<02:18, 69.04s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.247,  Train_accy 77.35:  95%|█████████▌| 19/20 [21:58<01:08, 68.58s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.257,  Train_accy 77.19:  95%|█████████▌| 19/20 [23:05<01:08, 68.58s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.257,  Train_accy 77.19: 100%|██████████| 20/20 [23:05<00:00, 68.29s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.257,  Train_accy 77.19: 100%|██████████| 20/20 [23:05<00:00, 69.28s/it]
2024-09-04 18:50:31,814 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.257,  Train_accy 77.19
2024-09-04 18:50:31,814 [foster.py] => do not weight align student!
2024-09-04 18:50:40,598 [foster.py] => darknet eval: 
2024-09-04 18:50:40,598 [foster.py] => CNN top1 curve: 92.17
2024-09-04 18:50:40,599 [foster.py] => CNN top5 curve: 99.8
2024-09-04 18:50:40,601 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 18:51:55,616 [foster.py] => Exemplar size: 600
2024-09-04 18:51:55,616 [trainer.py] => CNN: {'total': 94.3, '00-09': 97.7, '10-19': 95.4, '20-29': 89.8, 'old': 96.55, 'new': 89.8}
2024-09-04 18:51:55,616 [trainer.py] => NME: {'total': 95.73, '00-09': 96.0, '10-19': 93.4, '20-29': 97.8, 'old': 94.7, 'new': 97.8}
2024-09-04 18:51:55,616 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3]
2024-09-04 18:51:55,616 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73]
2024-09-04 18:51:55,616 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73]
2024-09-04 18:51:55,616 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67]

Average Accuracy (CNN): 96.72
Average Accuracy (NME): 97.19
2024-09-04 18:51:55,616 [trainer.py] => Average Accuracy (CNN): 96.72
2024-09-04 18:51:55,617 [trainer.py] => Average Accuracy (NME): 97.19
2024-09-04 18:51:55,618 [trainer.py] => All params: 171681872
2024-09-04 18:51:55,619 [trainer.py] => Trainable params: 85867836
2024-09-04 18:51:58,270 [foster.py] => Learning on 30-40
2024-09-04 18:51:58,272 [foster.py] => All params: 171712622
2024-09-04 18:51:58,273 [foster.py] => Trainable params: 85890896
2024-09-04 18:51:58,396 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.736, Loss_clf 0.781, Loss_fe 1.122, Loss_kd 1.374, Train_accy 59.70, Test_accy 86.25:   0%|          | 0/20 [01:17<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.736, Loss_clf 0.781, Loss_fe 1.122, Loss_kd 1.374, Train_accy 59.70, Test_accy 86.25:   5%|▌         | 1/20 [01:17<24:32, 77.53s/it]
Task 3, Epoch 2/20 => Loss 2.878, Loss_clf 0.408, Loss_fe 0.638, Loss_kd 1.374, Train_accy 64.48:   5%|▌         | 1/20 [02:13<24:32, 77.53s/it]                 
Task 3, Epoch 2/20 => Loss 2.878, Loss_clf 0.408, Loss_fe 0.638, Loss_kd 1.374, Train_accy 64.48:  10%|█         | 2/20 [02:13<19:23, 64.67s/it]
Task 3, Epoch 3/20 => Loss 2.707, Loss_clf 0.371, Loss_fe 0.506, Loss_kd 1.372, Train_accy 67.88:  10%|█         | 2/20 [03:08<19:23, 64.67s/it]
Task 3, Epoch 3/20 => Loss 2.707, Loss_clf 0.371, Loss_fe 0.506, Loss_kd 1.372, Train_accy 67.88:  15%|█▌        | 3/20 [03:08<17:09, 60.55s/it]
Task 3, Epoch 4/20 => Loss 2.579, Loss_clf 0.334, Loss_fe 0.425, Loss_kd 1.365, Train_accy 69.52:  15%|█▌        | 3/20 [04:04<17:09, 60.55s/it]
Task 3, Epoch 4/20 => Loss 2.579, Loss_clf 0.334, Loss_fe 0.425, Loss_kd 1.365, Train_accy 69.52:  20%|██        | 4/20 [04:04<15:39, 58.69s/it]
Task 3, Epoch 5/20 => Loss 2.599, Loss_clf 0.353, Loss_fe 0.420, Loss_kd 1.370, Train_accy 68.52:  20%|██        | 4/20 [05:00<15:39, 58.69s/it]
Task 3, Epoch 5/20 => Loss 2.599, Loss_clf 0.353, Loss_fe 0.420, Loss_kd 1.370, Train_accy 68.52:  25%|██▌       | 5/20 [05:00<14:23, 57.58s/it]
Task 3, Epoch 6/20 => Loss 2.456, Loss_clf 0.292, Loss_fe 0.352, Loss_kd 1.359, Train_accy 72.39, Test_accy 90.08:  25%|██▌       | 5/20 [06:17<14:23, 57.58s/it]
Task 3, Epoch 6/20 => Loss 2.456, Loss_clf 0.292, Loss_fe 0.352, Loss_kd 1.359, Train_accy 72.39, Test_accy 90.08:  30%|███       | 6/20 [06:17<15:01, 64.39s/it]
Task 3, Epoch 7/20 => Loss 2.438, Loss_clf 0.290, Loss_fe 0.332, Loss_kd 1.362, Train_accy 73.75:  30%|███       | 6/20 [07:13<15:01, 64.39s/it]                 
Task 3, Epoch 7/20 => Loss 2.438, Loss_clf 0.290, Loss_fe 0.332, Loss_kd 1.362, Train_accy 73.75:  35%|███▌      | 7/20 [07:13<13:20, 61.54s/it]
Task 3, Epoch 8/20 => Loss 2.402, Loss_clf 0.282, Loss_fe 0.308, Loss_kd 1.359, Train_accy 74.75:  35%|███▌      | 7/20 [08:09<13:20, 61.54s/it]
Task 3, Epoch 8/20 => Loss 2.402, Loss_clf 0.282, Loss_fe 0.308, Loss_kd 1.359, Train_accy 74.75:  40%|████      | 8/20 [08:09<11:55, 59.63s/it]
Task 3, Epoch 9/20 => Loss 2.363, Loss_clf 0.262, Loss_fe 0.294, Loss_kd 1.356, Train_accy 76.11:  40%|████      | 8/20 [09:04<11:55, 59.63s/it]
Task 3, Epoch 9/20 => Loss 2.363, Loss_clf 0.262, Loss_fe 0.294, Loss_kd 1.356, Train_accy 76.11:  45%|████▌     | 9/20 [09:04<10:41, 58.36s/it]
Task 3, Epoch 10/20 => Loss 2.344, Loss_clf 0.247, Loss_fe 0.267, Loss_kd 1.372, Train_accy 78.14:  45%|████▌     | 9/20 [10:00<10:41, 58.36s/it]
Task 3, Epoch 10/20 => Loss 2.344, Loss_clf 0.247, Loss_fe 0.267, Loss_kd 1.372, Train_accy 78.14:  50%|█████     | 10/20 [10:00<09:35, 57.52s/it]
Task 3, Epoch 11/20 => Loss 2.355, Loss_clf 0.259, Loss_fe 0.271, Loss_kd 1.369, Train_accy 79.00, Test_accy 91.98:  50%|█████     | 10/20 [11:17<09:35, 57.52s/it]
Task 3, Epoch 11/20 => Loss 2.355, Loss_clf 0.259, Loss_fe 0.271, Loss_kd 1.369, Train_accy 79.00, Test_accy 91.98:  55%|█████▌    | 11/20 [11:17<09:32, 63.63s/it]
Task 3, Epoch 12/20 => Loss 2.308, Loss_clf 0.233, Loss_fe 0.245, Loss_kd 1.372, Train_accy 80.68:  55%|█████▌    | 11/20 [12:13<09:32, 63.63s/it]                 
Task 3, Epoch 12/20 => Loss 2.308, Loss_clf 0.233, Loss_fe 0.245, Loss_kd 1.372, Train_accy 80.68:  60%|██████    | 12/20 [12:13<08:09, 61.21s/it]
Task 3, Epoch 13/20 => Loss 2.223, Loss_clf 0.200, Loss_fe 0.208, Loss_kd 1.361, Train_accy 81.93:  60%|██████    | 12/20 [13:08<08:09, 61.21s/it]
Task 3, Epoch 13/20 => Loss 2.223, Loss_clf 0.200, Loss_fe 0.208, Loss_kd 1.361, Train_accy 81.93:  65%|██████▌   | 13/20 [13:08<06:56, 59.48s/it]
Task 3, Epoch 14/20 => Loss 2.241, Loss_clf 0.213, Loss_fe 0.209, Loss_kd 1.364, Train_accy 81.29:  65%|██████▌   | 13/20 [14:04<06:56, 59.48s/it]
Task 3, Epoch 14/20 => Loss 2.241, Loss_clf 0.213, Loss_fe 0.209, Loss_kd 1.364, Train_accy 81.29:  70%|███████   | 14/20 [14:04<05:49, 58.30s/it]
Task 3, Epoch 15/20 => Loss 2.203, Loss_clf 0.199, Loss_fe 0.192, Loss_kd 1.358, Train_accy 82.50:  70%|███████   | 14/20 [15:00<05:49, 58.30s/it]
Task 3, Epoch 15/20 => Loss 2.203, Loss_clf 0.199, Loss_fe 0.192, Loss_kd 1.358, Train_accy 82.50:  75%|███████▌  | 15/20 [15:00<04:47, 57.48s/it]
Task 3, Epoch 16/20 => Loss 2.189, Loss_clf 0.192, Loss_fe 0.185, Loss_kd 1.359, Train_accy 83.36, Test_accy 92.15:  75%|███████▌  | 15/20 [16:17<04:47, 57.48s/it]
Task 3, Epoch 16/20 => Loss 2.189, Loss_clf 0.192, Loss_fe 0.185, Loss_kd 1.359, Train_accy 83.36, Test_accy 92.15:  80%|████████  | 16/20 [16:17<04:14, 63.52s/it]
Task 3, Epoch 17/20 => Loss 2.200, Loss_clf 0.197, Loss_fe 0.188, Loss_kd 1.361, Train_accy 82.95:  80%|████████  | 16/20 [17:13<04:14, 63.52s/it]                 
Task 3, Epoch 17/20 => Loss 2.200, Loss_clf 0.197, Loss_fe 0.188, Loss_kd 1.361, Train_accy 82.95:  85%|████████▌ | 17/20 [17:13<03:03, 61.15s/it]
Task 3, Epoch 18/20 => Loss 2.188, Loss_clf 0.188, Loss_fe 0.181, Loss_kd 1.364, Train_accy 84.05:  85%|████████▌ | 17/20 [18:08<03:03, 61.15s/it]
Task 3, Epoch 18/20 => Loss 2.188, Loss_clf 0.188, Loss_fe 0.181, Loss_kd 1.364, Train_accy 84.05:  90%|█████████ | 18/20 [18:08<01:58, 59.47s/it]
Task 3, Epoch 19/20 => Loss 2.171, Loss_clf 0.179, Loss_fe 0.170, Loss_kd 1.366, Train_accy 83.89:  90%|█████████ | 18/20 [19:04<01:58, 59.47s/it]
Task 3, Epoch 19/20 => Loss 2.171, Loss_clf 0.179, Loss_fe 0.170, Loss_kd 1.366, Train_accy 83.89:  95%|█████████▌| 19/20 [19:04<00:58, 58.33s/it]
Task 3, Epoch 20/20 => Loss 2.153, Loss_clf 0.180, Loss_fe 0.169, Loss_kd 1.353, Train_accy 83.55:  95%|█████████▌| 19/20 [20:00<00:58, 58.33s/it]
Task 3, Epoch 20/20 => Loss 2.153, Loss_clf 0.180, Loss_fe 0.169, Loss_kd 1.353, Train_accy 83.55: 100%|██████████| 20/20 [20:00<00:00, 57.54s/it]
Task 3, Epoch 20/20 => Loss 2.153, Loss_clf 0.180, Loss_fe 0.169, Loss_kd 1.353, Train_accy 83.55: 100%|██████████| 20/20 [20:00<00:00, 60.01s/it]
2024-09-04 19:11:58,644 [foster.py] => Task 3, Epoch 20/20 => Loss 2.153, Loss_clf 0.180, Loss_fe 0.169, Loss_kd 1.353, Train_accy 83.55
2024-09-04 19:11:58,645 [foster.py] => do not weight align teacher!
2024-09-04 19:11:58,648 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.820,  Train_accy 55.88, Test_accy 90.12:   0%|          | 0/20 [01:21<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.820,  Train_accy 55.88, Test_accy 90.12:   5%|▌         | 1/20 [01:21<25:51, 81.64s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.569,  Train_accy 66.75:   5%|▌         | 1/20 [02:31<25:51, 81.64s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.569,  Train_accy 66.75:  10%|█         | 2/20 [02:31<22:26, 74.83s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.574,  Train_accy 66.88:  10%|█         | 2/20 [03:41<22:26, 74.83s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.574,  Train_accy 66.88:  15%|█▌        | 3/20 [03:41<20:34, 72.61s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.551,  Train_accy 68.59:  15%|█▌        | 3/20 [04:51<20:34, 72.61s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.551,  Train_accy 68.59:  20%|██        | 4/20 [04:51<19:05, 71.59s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.541,  Train_accy 67.95:  20%|██        | 4/20 [06:01<19:05, 71.59s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.541,  Train_accy 67.95:  25%|██▌       | 5/20 [06:01<17:45, 71.03s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.544,  Train_accy 68.57, Test_accy 90.30:  25%|██▌       | 5/20 [07:23<17:45, 71.03s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.544,  Train_accy 68.57, Test_accy 90.30:  30%|███       | 6/20 [07:23<17:25, 74.65s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.531,  Train_accy 69.18:  30%|███       | 6/20 [08:33<17:25, 74.65s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.531,  Train_accy 69.18:  35%|███▌      | 7/20 [08:33<15:50, 73.15s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.538,  Train_accy 68.95:  35%|███▌      | 7/20 [09:43<15:50, 73.15s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.538,  Train_accy 68.95:  40%|████      | 8/20 [09:43<14:26, 72.20s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.547,  Train_accy 69.43:  40%|████      | 8/20 [10:53<14:26, 72.20s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.547,  Train_accy 69.43:  45%|████▌     | 9/20 [10:53<13:06, 71.53s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.541,  Train_accy 68.61:  45%|████▌     | 9/20 [12:03<13:06, 71.53s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.541,  Train_accy 68.61:  50%|█████     | 10/20 [12:03<11:50, 71.08s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.540,  Train_accy 68.70, Test_accy 90.80:  50%|█████     | 10/20 [13:25<11:50, 71.08s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.540,  Train_accy 68.70, Test_accy 90.80:  55%|█████▌    | 11/20 [13:25<11:09, 74.34s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.530,  Train_accy 69.68:  55%|█████▌    | 11/20 [14:35<11:09, 74.34s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.530,  Train_accy 69.68:  60%|██████    | 12/20 [14:35<09:44, 73.06s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.536,  Train_accy 69.14:  60%|██████    | 12/20 [15:45<09:44, 73.06s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.536,  Train_accy 69.14:  65%|██████▌   | 13/20 [15:45<08:25, 72.17s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.521,  Train_accy 69.82:  65%|██████▌   | 13/20 [16:55<08:25, 72.17s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.521,  Train_accy 69.82:  70%|███████   | 14/20 [16:55<07:09, 71.57s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.555,  Train_accy 70.12:  70%|███████   | 14/20 [18:06<07:09, 71.57s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.555,  Train_accy 70.12:  75%|███████▌  | 15/20 [18:06<05:55, 71.14s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.528,  Train_accy 69.79, Test_accy 90.82:  75%|███████▌  | 15/20 [19:27<05:55, 71.14s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.528,  Train_accy 69.79, Test_accy 90.82:  80%|████████  | 16/20 [19:27<04:57, 74.33s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.531,  Train_accy 69.48:  80%|████████  | 16/20 [20:37<04:57, 74.33s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.531,  Train_accy 69.48:  85%|████████▌ | 17/20 [20:37<03:39, 73.05s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.542,  Train_accy 70.02:  85%|████████▌ | 17/20 [21:47<03:39, 73.05s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.542,  Train_accy 70.02:  90%|█████████ | 18/20 [21:47<02:24, 72.16s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.525,  Train_accy 69.84:  90%|█████████ | 18/20 [22:58<02:24, 72.16s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.525,  Train_accy 69.84:  95%|█████████▌| 19/20 [22:58<01:11, 71.53s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.529,  Train_accy 69.62:  95%|█████████▌| 19/20 [24:08<01:11, 71.53s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.529,  Train_accy 69.62: 100%|██████████| 20/20 [24:08<00:00, 71.11s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.529,  Train_accy 69.62: 100%|██████████| 20/20 [24:08<00:00, 72.41s/it]
2024-09-04 19:36:08,969 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.529,  Train_accy 69.62
2024-09-04 19:36:08,969 [foster.py] => do not weight align student!
2024-09-04 19:36:20,655 [foster.py] => darknet eval: 
2024-09-04 19:36:20,656 [foster.py] => CNN top1 curve: 90.68
2024-09-04 19:36:20,656 [foster.py] => CNN top5 curve: 99.65
2024-09-04 19:36:20,659 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 19:37:50,600 [foster.py] => Exemplar size: 800
2024-09-04 19:37:50,600 [trainer.py] => CNN: {'total': 92.08, '00-09': 96.9, '10-19': 94.8, '20-29': 91.9, '30-39': 84.7, 'old': 94.53, 'new': 84.7}
2024-09-04 19:37:50,600 [trainer.py] => NME: {'total': 94.68, '00-09': 94.1, '10-19': 93.2, '20-29': 95.1, '30-39': 96.3, 'old': 94.13, 'new': 96.3}
2024-09-04 19:37:50,601 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3, 92.08]
2024-09-04 19:37:50,601 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73, 99.68]
2024-09-04 19:37:50,601 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73, 94.68]
2024-09-04 19:37:50,601 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67, 99.6]

Average Accuracy (CNN): 95.56
Average Accuracy (NME): 96.57
2024-09-04 19:37:50,601 [trainer.py] => Average Accuracy (CNN): 95.56
2024-09-04 19:37:50,601 [trainer.py] => Average Accuracy (NME): 96.57
2024-09-04 19:37:50,602 [trainer.py] => All params: 171712622
2024-09-04 19:37:50,604 [trainer.py] => Trainable params: 85890896
2024-09-04 19:37:52,889 [foster.py] => Learning on 40-50
2024-09-04 19:37:52,891 [foster.py] => All params: 171743372
2024-09-04 19:37:52,892 [foster.py] => Trainable params: 85913956
2024-09-04 19:37:53,007 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.908, Loss_clf 0.703, Loss_fe 1.238, Loss_kd 1.573, Train_accy 59.38, Test_accy 86.30:   0%|          | 0/20 [01:24<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.908, Loss_clf 0.703, Loss_fe 1.238, Loss_kd 1.573, Train_accy 59.38, Test_accy 86.30:   5%|▌         | 1/20 [01:24<26:52, 84.87s/it]
Task 4, Epoch 2/20 => Loss 3.040, Loss_clf 0.389, Loss_fe 0.672, Loss_kd 1.583, Train_accy 62.34:   5%|▌         | 1/20 [02:22<26:52, 84.87s/it]                 
Task 4, Epoch 2/20 => Loss 3.040, Loss_clf 0.389, Loss_fe 0.672, Loss_kd 1.583, Train_accy 62.34:  10%|█         | 2/20 [02:22<20:38, 68.82s/it]
Task 4, Epoch 3/20 => Loss 2.821, Loss_clf 0.336, Loss_fe 0.513, Loss_kd 1.577, Train_accy 65.67:  10%|█         | 2/20 [03:20<20:38, 68.82s/it]
Task 4, Epoch 3/20 => Loss 2.821, Loss_clf 0.336, Loss_fe 0.513, Loss_kd 1.577, Train_accy 65.67:  15%|█▌        | 3/20 [03:20<18:03, 63.75s/it]
Task 4, Epoch 4/20 => Loss 2.770, Loss_clf 0.327, Loss_fe 0.461, Loss_kd 1.586, Train_accy 67.60:  15%|█▌        | 3/20 [04:17<18:03, 63.75s/it]
Task 4, Epoch 4/20 => Loss 2.770, Loss_clf 0.327, Loss_fe 0.461, Loss_kd 1.586, Train_accy 67.60:  20%|██        | 4/20 [04:17<16:21, 61.34s/it]
Task 4, Epoch 5/20 => Loss 2.637, Loss_clf 0.290, Loss_fe 0.392, Loss_kd 1.564, Train_accy 69.74:  20%|██        | 4/20 [05:15<16:21, 61.34s/it]
Task 4, Epoch 5/20 => Loss 2.637, Loss_clf 0.290, Loss_fe 0.392, Loss_kd 1.564, Train_accy 69.74:  25%|██▌       | 5/20 [05:15<15:00, 60.03s/it]
Task 4, Epoch 6/20 => Loss 2.699, Loss_clf 0.312, Loss_fe 0.397, Loss_kd 1.592, Train_accy 71.05, Test_accy 89.62:  25%|██▌       | 5/20 [06:40<15:00, 60.03s/it]
Task 4, Epoch 6/20 => Loss 2.699, Loss_clf 0.312, Loss_fe 0.397, Loss_kd 1.592, Train_accy 71.05, Test_accy 89.62:  30%|███       | 6/20 [06:40<15:59, 68.56s/it]
Task 4, Epoch 7/20 => Loss 2.511, Loss_clf 0.243, Loss_fe 0.297, Loss_kd 1.577, Train_accy 75.26:  30%|███       | 6/20 [07:38<15:59, 68.56s/it]                 
Task 4, Epoch 7/20 => Loss 2.511, Loss_clf 0.243, Loss_fe 0.297, Loss_kd 1.577, Train_accy 75.26:  35%|███▌      | 7/20 [07:38<14:04, 64.99s/it]
Task 4, Epoch 8/20 => Loss 2.505, Loss_clf 0.248, Loss_fe 0.296, Loss_kd 1.569, Train_accy 74.41:  35%|███▌      | 7/20 [08:35<14:04, 64.99s/it]
Task 4, Epoch 8/20 => Loss 2.505, Loss_clf 0.248, Loss_fe 0.296, Loss_kd 1.569, Train_accy 74.41:  40%|████      | 8/20 [08:35<12:31, 62.65s/it]
Task 4, Epoch 9/20 => Loss 2.498, Loss_clf 0.249, Loss_fe 0.288, Loss_kd 1.569, Train_accy 74.78:  40%|████      | 8/20 [09:33<12:31, 62.65s/it]
Task 4, Epoch 9/20 => Loss 2.498, Loss_clf 0.249, Loss_fe 0.288, Loss_kd 1.569, Train_accy 74.78:  45%|████▌     | 9/20 [09:33<11:11, 61.07s/it]
Task 4, Epoch 10/20 => Loss 2.501, Loss_clf 0.254, Loss_fe 0.282, Loss_kd 1.572, Train_accy 75.79:  45%|████▌     | 9/20 [10:31<11:11, 61.07s/it]
Task 4, Epoch 10/20 => Loss 2.501, Loss_clf 0.254, Loss_fe 0.282, Loss_kd 1.572, Train_accy 75.79:  50%|█████     | 10/20 [10:31<10:00, 60.01s/it]
Task 4, Epoch 11/20 => Loss 2.457, Loss_clf 0.234, Loss_fe 0.248, Loss_kd 1.580, Train_accy 78.34, Test_accy 90.36:  50%|█████     | 10/20 [11:56<10:00, 60.01s/it]
Task 4, Epoch 11/20 => Loss 2.457, Loss_clf 0.234, Loss_fe 0.248, Loss_kd 1.580, Train_accy 78.34, Test_accy 90.36:  55%|█████▌    | 11/20 [11:56<10:09, 67.68s/it]
Task 4, Epoch 12/20 => Loss 2.458, Loss_clf 0.240, Loss_fe 0.246, Loss_kd 1.577, Train_accy 77.16:  55%|█████▌    | 11/20 [12:53<10:09, 67.68s/it]                 
Task 4, Epoch 12/20 => Loss 2.458, Loss_clf 0.240, Loss_fe 0.246, Loss_kd 1.577, Train_accy 77.16:  60%|██████    | 12/20 [12:53<08:37, 64.63s/it]
Task 4, Epoch 13/20 => Loss 2.415, Loss_clf 0.216, Loss_fe 0.230, Loss_kd 1.575, Train_accy 79.19:  60%|██████    | 12/20 [13:51<08:37, 64.63s/it]
Task 4, Epoch 13/20 => Loss 2.415, Loss_clf 0.216, Loss_fe 0.230, Loss_kd 1.575, Train_accy 79.19:  65%|██████▌   | 13/20 [13:51<07:17, 62.50s/it]
Task 4, Epoch 14/20 => Loss 2.374, Loss_clf 0.203, Loss_fe 0.205, Loss_kd 1.573, Train_accy 80.34:  65%|██████▌   | 13/20 [14:49<07:17, 62.50s/it]
Task 4, Epoch 14/20 => Loss 2.374, Loss_clf 0.203, Loss_fe 0.205, Loss_kd 1.573, Train_accy 80.34:  70%|███████   | 14/20 [14:49<06:06, 61.02s/it]
Task 4, Epoch 15/20 => Loss 2.359, Loss_clf 0.196, Loss_fe 0.192, Loss_kd 1.577, Train_accy 80.88:  70%|███████   | 14/20 [15:46<06:06, 61.02s/it]
Task 4, Epoch 15/20 => Loss 2.359, Loss_clf 0.196, Loss_fe 0.192, Loss_kd 1.577, Train_accy 80.88:  75%|███████▌  | 15/20 [15:46<05:00, 60.03s/it]
Task 4, Epoch 16/20 => Loss 2.393, Loss_clf 0.215, Loss_fe 0.208, Loss_kd 1.576, Train_accy 80.50, Test_accy 90.88:  75%|███████▌  | 15/20 [17:12<05:00, 60.03s/it]
Task 4, Epoch 16/20 => Loss 2.393, Loss_clf 0.215, Loss_fe 0.208, Loss_kd 1.576, Train_accy 80.50, Test_accy 90.88:  80%|████████  | 16/20 [17:12<04:30, 67.61s/it]
Task 4, Epoch 17/20 => Loss 2.360, Loss_clf 0.205, Loss_fe 0.188, Loss_kd 1.574, Train_accy 81.28:  80%|████████  | 16/20 [18:09<04:30, 67.61s/it]                 
Task 4, Epoch 17/20 => Loss 2.360, Loss_clf 0.205, Loss_fe 0.188, Loss_kd 1.574, Train_accy 81.28:  85%|████████▌ | 17/20 [18:09<03:13, 64.66s/it]
Task 4, Epoch 18/20 => Loss 2.330, Loss_clf 0.193, Loss_fe 0.180, Loss_kd 1.566, Train_accy 81.79:  85%|████████▌ | 17/20 [19:07<03:13, 64.66s/it]
Task 4, Epoch 18/20 => Loss 2.330, Loss_clf 0.193, Loss_fe 0.180, Loss_kd 1.566, Train_accy 81.79:  90%|█████████ | 18/20 [19:07<02:05, 62.56s/it]
Task 4, Epoch 19/20 => Loss 2.368, Loss_clf 0.202, Loss_fe 0.188, Loss_kd 1.582, Train_accy 81.97:  90%|█████████ | 18/20 [20:05<02:05, 62.56s/it]
Task 4, Epoch 19/20 => Loss 2.368, Loss_clf 0.202, Loss_fe 0.188, Loss_kd 1.582, Train_accy 81.97:  95%|█████████▌| 19/20 [20:05<01:01, 61.10s/it]
Task 4, Epoch 20/20 => Loss 2.331, Loss_clf 0.195, Loss_fe 0.181, Loss_kd 1.564, Train_accy 81.72:  95%|█████████▌| 19/20 [21:02<01:01, 61.10s/it]
Task 4, Epoch 20/20 => Loss 2.331, Loss_clf 0.195, Loss_fe 0.181, Loss_kd 1.564, Train_accy 81.72: 100%|██████████| 20/20 [21:02<00:00, 60.06s/it]
Task 4, Epoch 20/20 => Loss 2.331, Loss_clf 0.195, Loss_fe 0.181, Loss_kd 1.564, Train_accy 81.72: 100%|██████████| 20/20 [21:02<00:00, 63.14s/it]
2024-09-04 19:58:55,831 [foster.py] => Task 4, Epoch 20/20 => Loss 2.331, Loss_clf 0.195, Loss_fe 0.181, Loss_kd 1.564, Train_accy 81.72
2024-09-04 19:58:55,833 [foster.py] => do not weight align teacher!
2024-09-04 19:58:55,837 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.934,  Train_accy 57.26, Test_accy 89.16:   0%|          | 0/20 [01:27<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.934,  Train_accy 57.26, Test_accy 89.16:   5%|▌         | 1/20 [01:27<27:34, 87.06s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.741,  Train_accy 65.03:   5%|▌         | 1/20 [02:39<27:34, 87.06s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.741,  Train_accy 65.03:  10%|█         | 2/20 [02:39<23:33, 78.54s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.692,  Train_accy 65.84:  10%|█         | 2/20 [03:52<23:33, 78.54s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.692,  Train_accy 65.84:  15%|█▌        | 3/20 [03:52<21:28, 75.77s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.720,  Train_accy 65.97:  15%|█▌        | 3/20 [05:04<21:28, 75.77s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.720,  Train_accy 65.97:  20%|██        | 4/20 [05:04<19:51, 74.50s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.716,  Train_accy 65.88:  20%|██        | 4/20 [06:17<19:51, 74.50s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.716,  Train_accy 65.88:  25%|██▌       | 5/20 [06:17<18:26, 73.79s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.704,  Train_accy 66.34, Test_accy 89.46:  25%|██▌       | 5/20 [07:44<18:26, 73.79s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.704,  Train_accy 66.34, Test_accy 89.46:  30%|███       | 6/20 [07:44<18:17, 78.38s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.703,  Train_accy 66.81:  30%|███       | 6/20 [08:57<18:17, 78.38s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.703,  Train_accy 66.81:  35%|███▌      | 7/20 [08:57<16:34, 76.53s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.728,  Train_accy 65.62:  35%|███▌      | 7/20 [10:09<16:34, 76.53s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.728,  Train_accy 65.62:  40%|████      | 8/20 [10:09<15:03, 75.26s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.713,  Train_accy 66.47:  40%|████      | 8/20 [11:22<15:03, 75.26s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.713,  Train_accy 66.47:  45%|████▌     | 9/20 [11:22<13:38, 74.44s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.708,  Train_accy 66.60:  45%|████▌     | 9/20 [12:34<13:38, 74.44s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.708,  Train_accy 66.60:  50%|█████     | 10/20 [12:34<12:18, 73.87s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.691,  Train_accy 66.52, Test_accy 89.24:  50%|█████     | 10/20 [14:02<12:18, 73.87s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.691,  Train_accy 66.52, Test_accy 89.24:  55%|█████▌    | 11/20 [14:02<11:41, 77.94s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.715,  Train_accy 67.07:  55%|█████▌    | 11/20 [15:14<11:41, 77.94s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.715,  Train_accy 67.07:  60%|██████    | 12/20 [15:14<10:10, 76.33s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.711,  Train_accy 66.79:  60%|██████    | 12/20 [16:27<10:10, 76.33s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.711,  Train_accy 66.79:  65%|██████▌   | 13/20 [16:27<08:46, 75.21s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.731,  Train_accy 66.66:  65%|██████▌   | 13/20 [17:39<08:46, 75.21s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.731,  Train_accy 66.66:  70%|███████   | 14/20 [17:39<07:26, 74.39s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.702,  Train_accy 66.00:  70%|███████   | 14/20 [18:52<07:26, 74.39s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.702,  Train_accy 66.00:  75%|███████▌  | 15/20 [18:52<06:09, 73.83s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.708,  Train_accy 66.86, Test_accy 89.20:  75%|███████▌  | 15/20 [20:19<06:09, 73.83s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.708,  Train_accy 66.86, Test_accy 89.20:  80%|████████  | 16/20 [20:19<05:11, 77.77s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.698,  Train_accy 67.02:  80%|████████  | 16/20 [21:32<05:11, 77.77s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.698,  Train_accy 67.02:  85%|████████▌ | 17/20 [21:32<03:48, 76.25s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.704,  Train_accy 65.98:  85%|████████▌ | 17/20 [22:44<03:48, 76.25s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.704,  Train_accy 65.98:  90%|█████████ | 18/20 [22:44<02:30, 75.14s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.717,  Train_accy 65.78:  90%|█████████ | 18/20 [23:57<02:30, 75.14s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.717,  Train_accy 65.78:  95%|█████████▌| 19/20 [23:57<01:14, 74.38s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.720,  Train_accy 65.90:  95%|█████████▌| 19/20 [25:09<01:14, 74.38s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.720,  Train_accy 65.90: 100%|██████████| 20/20 [25:09<00:00, 73.83s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.720,  Train_accy 65.90: 100%|██████████| 20/20 [25:09<00:00, 75.49s/it]
2024-09-04 20:24:09,328 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.720,  Train_accy 65.90
2024-09-04 20:24:09,328 [foster.py] => do not weight align student!
2024-09-04 20:24:23,841 [foster.py] => darknet eval: 
2024-09-04 20:24:23,841 [foster.py] => CNN top1 curve: 89.1
2024-09-04 20:24:23,841 [foster.py] => CNN top5 curve: 99.52
2024-09-04 20:24:23,843 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 20:26:08,428 [foster.py] => Exemplar size: 1000
2024-09-04 20:26:08,429 [trainer.py] => CNN: {'total': 90.88, '00-09': 95.8, '10-19': 95.3, '20-29': 93.5, '30-39': 86.8, '40-49': 83.0, 'old': 92.85, 'new': 83.0}
2024-09-04 20:26:08,429 [trainer.py] => NME: {'total': 92.4, '00-09': 94.6, '10-19': 89.1, '20-29': 94.1, '30-39': 88.5, '40-49': 95.7, 'old': 91.58, 'new': 95.7}
2024-09-04 20:26:08,429 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3, 92.08, 90.88]
2024-09-04 20:26:08,429 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73, 99.68, 99.32]
2024-09-04 20:26:08,429 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73, 94.68, 92.4]
2024-09-04 20:26:08,429 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67, 99.6, 99.48]

Average Accuracy (CNN): 94.62
Average Accuracy (NME): 95.73
2024-09-04 20:26:08,429 [trainer.py] => Average Accuracy (CNN): 94.62
2024-09-04 20:26:08,429 [trainer.py] => Average Accuracy (NME): 95.73
2024-09-04 20:26:08,430 [trainer.py] => All params: 171743372
2024-09-04 20:26:08,431 [trainer.py] => Trainable params: 85913956
2024-09-04 20:26:10,269 [foster.py] => Learning on 50-60
2024-09-04 20:26:10,271 [foster.py] => All params: 171774122
2024-09-04 20:26:10,272 [foster.py] => Trainable params: 85937016
2024-09-04 20:26:10,378 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 4.586, Loss_clf 0.791, Loss_fe 1.326, Loss_kd 2.058, Train_accy 63.37, Test_accy 88.18:   0%|          | 0/20 [01:32<?, ?it/s]
Task 5, Epoch 1/20 => Loss 4.586, Loss_clf 0.791, Loss_fe 1.326, Loss_kd 2.058, Train_accy 63.37, Test_accy 88.18:   5%|▌         | 1/20 [01:32<29:14, 92.33s/it]
Task 5, Epoch 2/20 => Loss 3.665, Loss_clf 0.451, Loss_fe 0.739, Loss_kd 2.063, Train_accy 69.20:   5%|▌         | 1/20 [02:31<29:14, 92.33s/it]                 
Task 5, Epoch 2/20 => Loss 3.665, Loss_clf 0.451, Loss_fe 0.739, Loss_kd 2.063, Train_accy 69.20:  10%|█         | 2/20 [02:31<21:55, 73.06s/it]
Task 5, Epoch 3/20 => Loss 3.479, Loss_clf 0.427, Loss_fe 0.603, Loss_kd 2.042, Train_accy 70.35:  10%|█         | 2/20 [03:31<21:55, 73.06s/it]
Task 5, Epoch 3/20 => Loss 3.479, Loss_clf 0.427, Loss_fe 0.603, Loss_kd 2.042, Train_accy 70.35:  15%|█▌        | 3/20 [03:31<18:58, 66.94s/it]
Task 5, Epoch 4/20 => Loss 3.334, Loss_clf 0.365, Loss_fe 0.500, Loss_kd 2.057, Train_accy 72.27:  15%|█▌        | 3/20 [04:31<18:58, 66.94s/it]
Task 5, Epoch 4/20 => Loss 3.334, Loss_clf 0.365, Loss_fe 0.500, Loss_kd 2.057, Train_accy 72.27:  20%|██        | 4/20 [04:31<17:04, 64.04s/it]
Task 5, Epoch 5/20 => Loss 3.245, Loss_clf 0.353, Loss_fe 0.443, Loss_kd 2.042, Train_accy 72.82:  20%|██        | 4/20 [05:30<17:04, 64.04s/it]
Task 5, Epoch 5/20 => Loss 3.245, Loss_clf 0.353, Loss_fe 0.443, Loss_kd 2.042, Train_accy 72.82:  25%|██▌       | 5/20 [05:30<15:36, 62.42s/it]
Task 5, Epoch 6/20 => Loss 3.187, Loss_clf 0.340, Loss_fe 0.406, Loss_kd 2.034, Train_accy 76.10, Test_accy 89.52:  25%|██▌       | 5/20 [07:02<15:36, 62.42s/it]
Task 5, Epoch 6/20 => Loss 3.187, Loss_clf 0.340, Loss_fe 0.406, Loss_kd 2.034, Train_accy 76.10, Test_accy 89.52:  30%|███       | 6/20 [07:02<16:55, 72.57s/it]
Task 5, Epoch 7/20 => Loss 3.177, Loss_clf 0.327, Loss_fe 0.386, Loss_kd 2.053, Train_accy 76.53:  30%|███       | 6/20 [08:02<16:55, 72.57s/it]                 
Task 5, Epoch 7/20 => Loss 3.177, Loss_clf 0.327, Loss_fe 0.386, Loss_kd 2.053, Train_accy 76.53:  35%|███▌      | 7/20 [08:02<14:47, 68.30s/it]
Task 5, Epoch 8/20 => Loss 3.115, Loss_clf 0.308, Loss_fe 0.347, Loss_kd 2.050, Train_accy 78.80:  35%|███▌      | 7/20 [09:02<14:47, 68.30s/it]
Task 5, Epoch 8/20 => Loss 3.115, Loss_clf 0.308, Loss_fe 0.347, Loss_kd 2.050, Train_accy 78.80:  40%|████      | 8/20 [09:02<13:06, 65.51s/it]
Task 5, Epoch 9/20 => Loss 3.062, Loss_clf 0.284, Loss_fe 0.320, Loss_kd 2.048, Train_accy 78.47:  40%|████      | 8/20 [10:01<13:06, 65.51s/it]
Task 5, Epoch 9/20 => Loss 3.062, Loss_clf 0.284, Loss_fe 0.320, Loss_kd 2.048, Train_accy 78.47:  45%|████▌     | 9/20 [10:01<11:40, 63.65s/it]
Task 5, Epoch 10/20 => Loss 3.058, Loss_clf 0.294, Loss_fe 0.312, Loss_kd 2.043, Train_accy 79.33:  45%|████▌     | 9/20 [11:01<11:40, 63.65s/it]
Task 5, Epoch 10/20 => Loss 3.058, Loss_clf 0.294, Loss_fe 0.312, Loss_kd 2.043, Train_accy 79.33:  50%|█████     | 10/20 [11:01<10:24, 62.41s/it]
Task 5, Epoch 11/20 => Loss 3.038, Loss_clf 0.285, Loss_fe 0.302, Loss_kd 2.042, Train_accy 78.82, Test_accy 90.42:  50%|█████     | 10/20 [12:33<10:24, 62.41s/it]
Task 5, Epoch 11/20 => Loss 3.038, Loss_clf 0.285, Loss_fe 0.302, Loss_kd 2.042, Train_accy 78.82, Test_accy 90.42:  55%|█████▌    | 11/20 [12:33<10:44, 71.61s/it]
Task 5, Epoch 12/20 => Loss 2.987, Loss_clf 0.263, Loss_fe 0.272, Loss_kd 2.044, Train_accy 81.45:  55%|█████▌    | 11/20 [13:33<10:44, 71.61s/it]                 
Task 5, Epoch 12/20 => Loss 2.987, Loss_clf 0.263, Loss_fe 0.272, Loss_kd 2.044, Train_accy 81.45:  60%|██████    | 12/20 [13:33<09:03, 67.95s/it]
Task 5, Epoch 13/20 => Loss 2.963, Loss_clf 0.253, Loss_fe 0.256, Loss_kd 2.044, Train_accy 81.90:  60%|██████    | 12/20 [14:32<09:03, 67.95s/it]
Task 5, Epoch 13/20 => Loss 2.963, Loss_clf 0.253, Loss_fe 0.256, Loss_kd 2.044, Train_accy 81.90:  65%|██████▌   | 13/20 [14:32<07:37, 65.42s/it]
Task 5, Epoch 14/20 => Loss 2.912, Loss_clf 0.236, Loss_fe 0.233, Loss_kd 2.036, Train_accy 83.63:  65%|██████▌   | 13/20 [15:32<07:37, 65.42s/it]
Task 5, Epoch 14/20 => Loss 2.912, Loss_clf 0.236, Loss_fe 0.233, Loss_kd 2.036, Train_accy 83.63:  70%|███████   | 14/20 [15:32<06:21, 63.65s/it]
Task 5, Epoch 15/20 => Loss 2.921, Loss_clf 0.233, Loss_fe 0.231, Loss_kd 2.047, Train_accy 83.10:  70%|███████   | 14/20 [16:31<06:21, 63.65s/it]
Task 5, Epoch 15/20 => Loss 2.921, Loss_clf 0.233, Loss_fe 0.231, Loss_kd 2.047, Train_accy 83.10:  75%|███████▌  | 15/20 [16:31<05:11, 62.37s/it]
Task 5, Epoch 16/20 => Loss 2.929, Loss_clf 0.238, Loss_fe 0.229, Loss_kd 2.051, Train_accy 83.22, Test_accy 90.63:  75%|███████▌  | 15/20 [18:04<05:11, 62.37s/it]
Task 5, Epoch 16/20 => Loss 2.929, Loss_clf 0.238, Loss_fe 0.229, Loss_kd 2.051, Train_accy 83.22, Test_accy 90.63:  80%|████████  | 16/20 [18:04<04:45, 71.38s/it]
Task 5, Epoch 17/20 => Loss 2.921, Loss_clf 0.234, Loss_fe 0.223, Loss_kd 2.053, Train_accy 83.03:  80%|████████  | 16/20 [19:03<04:45, 71.38s/it]                 
Task 5, Epoch 17/20 => Loss 2.921, Loss_clf 0.234, Loss_fe 0.223, Loss_kd 2.053, Train_accy 83.03:  85%|████████▌ | 17/20 [19:03<03:23, 67.82s/it]
Task 5, Epoch 18/20 => Loss 2.900, Loss_clf 0.227, Loss_fe 0.211, Loss_kd 2.052, Train_accy 83.40:  85%|████████▌ | 17/20 [20:03<03:23, 67.82s/it]
Task 5, Epoch 18/20 => Loss 2.900, Loss_clf 0.227, Loss_fe 0.211, Loss_kd 2.052, Train_accy 83.40:  90%|█████████ | 18/20 [20:03<02:10, 65.36s/it]
Task 5, Epoch 19/20 => Loss 2.840, Loss_clf 0.212, Loss_fe 0.199, Loss_kd 2.023, Train_accy 83.88:  90%|█████████ | 18/20 [21:02<02:10, 65.36s/it]
Task 5, Epoch 19/20 => Loss 2.840, Loss_clf 0.212, Loss_fe 0.199, Loss_kd 2.023, Train_accy 83.88:  95%|█████████▌| 19/20 [21:02<01:03, 63.63s/it]
Task 5, Epoch 20/20 => Loss 2.873, Loss_clf 0.217, Loss_fe 0.208, Loss_kd 2.040, Train_accy 84.23:  95%|█████████▌| 19/20 [22:02<01:03, 63.63s/it]
Task 5, Epoch 20/20 => Loss 2.873, Loss_clf 0.217, Loss_fe 0.208, Loss_kd 2.040, Train_accy 84.23: 100%|██████████| 20/20 [22:02<00:00, 62.41s/it]
Task 5, Epoch 20/20 => Loss 2.873, Loss_clf 0.217, Loss_fe 0.208, Loss_kd 2.040, Train_accy 84.23: 100%|██████████| 20/20 [22:02<00:00, 66.13s/it]
2024-09-04 20:48:12,882 [foster.py] => Task 5, Epoch 20/20 => Loss 2.873, Loss_clf 0.217, Loss_fe 0.208, Loss_kd 2.040, Train_accy 84.23
2024-09-04 20:48:12,882 [foster.py] => do not weight align teacher!
2024-09-04 20:48:12,884 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 2.186,  Train_accy 59.60, Test_accy 89.33:   0%|          | 0/20 [01:32<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 2.186,  Train_accy 59.60, Test_accy 89.33:   5%|▌         | 1/20 [01:32<29:15, 92.39s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.978,  Train_accy 68.25:   5%|▌         | 1/20 [02:47<29:15, 92.39s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.978,  Train_accy 68.25:  10%|█         | 2/20 [02:47<24:37, 82.11s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.952,  Train_accy 69.05:  10%|█         | 2/20 [04:02<24:37, 82.11s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.952,  Train_accy 69.05:  15%|█▌        | 3/20 [04:02<22:19, 78.81s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.947,  Train_accy 69.77:  15%|█▌        | 3/20 [05:17<22:19, 78.81s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.947,  Train_accy 69.77:  20%|██        | 4/20 [05:17<20:40, 77.54s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.955,  Train_accy 68.65:  20%|██        | 4/20 [06:34<20:40, 77.54s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.955,  Train_accy 68.65:  25%|██▌       | 5/20 [06:34<19:17, 77.18s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.953,  Train_accy 69.77, Test_accy 89.18:  25%|██▌       | 5/20 [08:08<19:17, 77.18s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.953,  Train_accy 69.77, Test_accy 89.18:  30%|███       | 6/20 [08:08<19:21, 82.93s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.962,  Train_accy 68.75:  30%|███       | 6/20 [09:25<19:21, 82.93s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.962,  Train_accy 68.75:  35%|███▌      | 7/20 [09:25<17:31, 80.88s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.957,  Train_accy 69.55:  35%|███▌      | 7/20 [10:41<17:31, 80.88s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.957,  Train_accy 69.55:  40%|████      | 8/20 [10:41<15:54, 79.51s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.941,  Train_accy 70.30:  40%|████      | 8/20 [11:58<15:54, 79.51s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.941,  Train_accy 70.30:  45%|████▌     | 9/20 [11:58<14:24, 78.59s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.922,  Train_accy 70.73:  45%|████▌     | 9/20 [13:14<14:24, 78.59s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.922,  Train_accy 70.73:  50%|█████     | 10/20 [13:14<12:59, 77.98s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.959,  Train_accy 69.80, Test_accy 89.37:  50%|█████     | 10/20 [14:49<12:59, 77.98s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.959,  Train_accy 69.80, Test_accy 89.37:  55%|█████▌    | 11/20 [14:49<12:26, 83.00s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.941,  Train_accy 69.93:  55%|█████▌    | 11/20 [16:05<12:26, 83.00s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.941,  Train_accy 69.93:  60%|██████    | 12/20 [16:05<10:47, 80.98s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.958,  Train_accy 70.45:  60%|██████    | 12/20 [17:22<10:47, 80.98s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.958,  Train_accy 70.45:  65%|██████▌   | 13/20 [17:22<09:17, 79.62s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.918,  Train_accy 70.83:  65%|██████▌   | 13/20 [18:38<09:17, 79.62s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.918,  Train_accy 70.83:  70%|███████   | 14/20 [18:38<07:52, 78.68s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.932,  Train_accy 70.05:  70%|███████   | 14/20 [19:55<07:52, 78.68s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.932,  Train_accy 70.05:  75%|███████▌  | 15/20 [19:55<06:30, 78.04s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.917,  Train_accy 71.47, Test_accy 89.18:  75%|███████▌  | 15/20 [21:29<06:30, 78.04s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.917,  Train_accy 71.47, Test_accy 89.18:  80%|████████  | 16/20 [21:29<05:31, 82.85s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.927,  Train_accy 71.43:  80%|████████  | 16/20 [22:45<05:31, 82.85s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.927,  Train_accy 71.43:  85%|████████▌ | 17/20 [22:45<04:02, 80.97s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.932,  Train_accy 70.40:  85%|████████▌ | 17/20 [24:02<04:02, 80.97s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.932,  Train_accy 70.40:  90%|█████████ | 18/20 [24:02<02:39, 79.65s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.938,  Train_accy 70.67:  90%|█████████ | 18/20 [25:18<02:39, 79.65s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.938,  Train_accy 70.67:  95%|█████████▌| 19/20 [25:18<01:18, 78.75s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.958,  Train_accy 69.87:  95%|█████████▌| 19/20 [26:35<01:18, 78.75s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.958,  Train_accy 69.87: 100%|██████████| 20/20 [26:35<00:00, 78.10s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.958,  Train_accy 69.87: 100%|██████████| 20/20 [26:35<00:00, 79.78s/it]
2024-09-04 21:14:50,500 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.958,  Train_accy 69.87
2024-09-04 21:14:50,500 [foster.py] => do not weight align student!
2024-09-04 21:15:08,150 [foster.py] => darknet eval: 
2024-09-04 21:15:08,150 [foster.py] => CNN top1 curve: 89.18
2024-09-04 21:15:08,150 [foster.py] => CNN top5 curve: 99.32
2024-09-04 21:15:08,152 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 21:17:09,308 [foster.py] => Exemplar size: 1200
2024-09-04 21:17:09,309 [trainer.py] => CNN: {'total': 90.52, '00-09': 95.3, '10-19': 94.9, '20-29': 94.6, '30-39': 89.7, '40-49': 84.4, '50-59': 84.2, 'old': 91.78, 'new': 84.2}
2024-09-04 21:17:09,309 [trainer.py] => NME: {'total': 92.03, '00-09': 93.8, '10-19': 91.9, '20-29': 93.6, '30-39': 90.1, '40-49': 88.5, '50-59': 94.3, 'old': 91.58, 'new': 94.3}
2024-09-04 21:17:09,309 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3, 92.08, 90.88, 90.52]
2024-09-04 21:17:09,309 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73, 99.68, 99.32, 99.33]
2024-09-04 21:17:09,309 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73, 94.68, 92.4, 92.03]
2024-09-04 21:17:09,309 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67, 99.6, 99.48, 99.45]

Average Accuracy (CNN): 93.94
Average Accuracy (NME): 95.12
2024-09-04 21:17:09,309 [trainer.py] => Average Accuracy (CNN): 93.94
2024-09-04 21:17:09,309 [trainer.py] => Average Accuracy (NME): 95.12
2024-09-04 21:17:09,310 [trainer.py] => All params: 171774122
2024-09-04 21:17:09,311 [trainer.py] => Trainable params: 85937016
2024-09-04 21:17:11,017 [foster.py] => Learning on 60-70
2024-09-04 21:17:11,018 [foster.py] => All params: 171804872
2024-09-04 21:17:11,019 [foster.py] => Trainable params: 85960076
2024-09-04 21:17:11,135 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 4.497, Loss_clf 0.748, Loss_fe 1.420, Loss_kd 1.996, Train_accy 63.52, Test_accy 88.33:   0%|          | 0/20 [01:41<?, ?it/s]
Task 6, Epoch 1/20 => Loss 4.497, Loss_clf 0.748, Loss_fe 1.420, Loss_kd 1.996, Train_accy 63.52, Test_accy 88.33:   5%|▌         | 1/20 [01:41<32:10, 101.63s/it]
Task 6, Epoch 2/20 => Loss 3.439, Loss_clf 0.412, Loss_fe 0.721, Loss_kd 1.978, Train_accy 69.55:   5%|▌         | 1/20 [02:44<32:10, 101.63s/it]                 
Task 6, Epoch 2/20 => Loss 3.439, Loss_clf 0.412, Loss_fe 0.721, Loss_kd 1.978, Train_accy 69.55:  10%|█         | 2/20 [02:44<23:38, 78.80s/it] 
Task 6, Epoch 3/20 => Loss 3.253, Loss_clf 0.384, Loss_fe 0.564, Loss_kd 1.977, Train_accy 69.90:  10%|█         | 2/20 [03:47<23:38, 78.80s/it]
Task 6, Epoch 3/20 => Loss 3.253, Loss_clf 0.384, Loss_fe 0.564, Loss_kd 1.977, Train_accy 69.90:  15%|█▌        | 3/20 [03:47<20:16, 71.56s/it]
Task 6, Epoch 4/20 => Loss 3.159, Loss_clf 0.363, Loss_fe 0.499, Loss_kd 1.968, Train_accy 72.16:  15%|█▌        | 3/20 [04:50<20:16, 71.56s/it]
Task 6, Epoch 4/20 => Loss 3.159, Loss_clf 0.363, Loss_fe 0.499, Loss_kd 1.968, Train_accy 72.16:  20%|██        | 4/20 [04:50<18:11, 68.19s/it]
Task 6, Epoch 5/20 => Loss 3.068, Loss_clf 0.335, Loss_fe 0.444, Loss_kd 1.963, Train_accy 72.03:  20%|██        | 4/20 [05:53<18:11, 68.19s/it]
Task 6, Epoch 5/20 => Loss 3.068, Loss_clf 0.335, Loss_fe 0.444, Loss_kd 1.963, Train_accy 72.03:  25%|██▌       | 5/20 [05:53<16:35, 66.36s/it]
Task 6, Epoch 6/20 => Loss 3.048, Loss_clf 0.333, Loss_fe 0.415, Loss_kd 1.971, Train_accy 72.45, Test_accy 88.86:  25%|██▌       | 5/20 [07:35<16:35, 66.36s/it]
Task 6, Epoch 6/20 => Loss 3.048, Loss_clf 0.333, Loss_fe 0.415, Loss_kd 1.971, Train_accy 72.45, Test_accy 88.86:  30%|███       | 6/20 [07:35<18:17, 78.43s/it]
Task 6, Epoch 7/20 => Loss 3.000, Loss_clf 0.314, Loss_fe 0.385, Loss_kd 1.973, Train_accy 73.98:  30%|███       | 6/20 [08:38<18:17, 78.43s/it]                 
Task 6, Epoch 7/20 => Loss 3.000, Loss_clf 0.314, Loss_fe 0.385, Loss_kd 1.973, Train_accy 73.98:  35%|███▌      | 7/20 [08:38<15:54, 73.43s/it]
Task 6, Epoch 8/20 => Loss 2.951, Loss_clf 0.298, Loss_fe 0.353, Loss_kd 1.971, Train_accy 75.45:  35%|███▌      | 7/20 [09:41<15:54, 73.43s/it]
Task 6, Epoch 8/20 => Loss 2.951, Loss_clf 0.298, Loss_fe 0.353, Loss_kd 1.971, Train_accy 75.45:  40%|████      | 8/20 [09:41<14:01, 70.15s/it]
Task 6, Epoch 9/20 => Loss 2.880, Loss_clf 0.274, Loss_fe 0.315, Loss_kd 1.964, Train_accy 77.24:  40%|████      | 8/20 [10:44<14:01, 70.15s/it]
Task 6, Epoch 9/20 => Loss 2.880, Loss_clf 0.274, Loss_fe 0.315, Loss_kd 1.964, Train_accy 77.24:  45%|████▌     | 9/20 [10:44<12:27, 67.94s/it]
Task 6, Epoch 10/20 => Loss 2.860, Loss_clf 0.269, Loss_fe 0.289, Loss_kd 1.973, Train_accy 77.73:  45%|████▌     | 9/20 [11:47<12:27, 67.94s/it]
Task 6, Epoch 10/20 => Loss 2.860, Loss_clf 0.269, Loss_fe 0.289, Loss_kd 1.973, Train_accy 77.73:  50%|█████     | 10/20 [11:47<11:04, 66.47s/it]
Task 6, Epoch 11/20 => Loss 2.873, Loss_clf 0.270, Loss_fe 0.293, Loss_kd 1.980, Train_accy 79.44, Test_accy 89.31:  50%|█████     | 10/20 [13:30<11:04, 66.47s/it]
Task 6, Epoch 11/20 => Loss 2.873, Loss_clf 0.270, Loss_fe 0.293, Loss_kd 1.980, Train_accy 79.44, Test_accy 89.31:  55%|█████▌    | 11/20 [13:30<11:36, 77.41s/it]
Task 6, Epoch 12/20 => Loss 2.818, Loss_clf 0.260, Loss_fe 0.261, Loss_kd 1.969, Train_accy 78.42:  55%|█████▌    | 11/20 [14:33<11:36, 77.41s/it]                 
Task 6, Epoch 12/20 => Loss 2.818, Loss_clf 0.260, Loss_fe 0.261, Loss_kd 1.969, Train_accy 78.42:  60%|██████    | 12/20 [14:33<09:44, 73.08s/it]
Task 6, Epoch 13/20 => Loss 2.811, Loss_clf 0.256, Loss_fe 0.253, Loss_kd 1.973, Train_accy 79.63:  60%|██████    | 12/20 [15:36<09:44, 73.08s/it]
Task 6, Epoch 13/20 => Loss 2.811, Loss_clf 0.256, Loss_fe 0.253, Loss_kd 1.973, Train_accy 79.63:  65%|██████▌   | 13/20 [15:36<08:09, 69.99s/it]
Task 6, Epoch 14/20 => Loss 2.755, Loss_clf 0.234, Loss_fe 0.230, Loss_kd 1.964, Train_accy 81.55:  65%|██████▌   | 13/20 [16:39<08:09, 69.99s/it]
Task 6, Epoch 14/20 => Loss 2.755, Loss_clf 0.234, Loss_fe 0.230, Loss_kd 1.964, Train_accy 81.55:  70%|███████   | 14/20 [16:39<06:47, 67.89s/it]
Task 6, Epoch 15/20 => Loss 2.731, Loss_clf 0.226, Loss_fe 0.218, Loss_kd 1.960, Train_accy 81.74:  70%|███████   | 14/20 [17:42<06:47, 67.89s/it]
Task 6, Epoch 15/20 => Loss 2.731, Loss_clf 0.226, Loss_fe 0.218, Loss_kd 1.960, Train_accy 81.74:  75%|███████▌  | 15/20 [17:42<05:32, 66.48s/it]
Task 6, Epoch 16/20 => Loss 2.747, Loss_clf 0.237, Loss_fe 0.224, Loss_kd 1.960, Train_accy 79.53, Test_accy 89.64:  75%|███████▌  | 15/20 [19:24<05:32, 66.48s/it]
Task 6, Epoch 16/20 => Loss 2.747, Loss_clf 0.237, Loss_fe 0.224, Loss_kd 1.960, Train_accy 79.53, Test_accy 89.64:  80%|████████  | 16/20 [19:24<05:08, 77.24s/it]
Task 6, Epoch 17/20 => Loss 2.710, Loss_clf 0.213, Loss_fe 0.200, Loss_kd 1.968, Train_accy 81.97:  80%|████████  | 16/20 [20:28<05:08, 77.24s/it]                 
Task 6, Epoch 17/20 => Loss 2.710, Loss_clf 0.213, Loss_fe 0.200, Loss_kd 1.968, Train_accy 81.97:  85%|████████▌ | 17/20 [20:28<03:39, 73.10s/it]
Task 6, Epoch 18/20 => Loss 2.741, Loss_clf 0.229, Loss_fe 0.212, Loss_kd 1.971, Train_accy 81.50:  85%|████████▌ | 17/20 [21:31<03:39, 73.10s/it]
Task 6, Epoch 18/20 => Loss 2.741, Loss_clf 0.229, Loss_fe 0.212, Loss_kd 1.971, Train_accy 81.50:  90%|█████████ | 18/20 [21:31<02:20, 70.13s/it]
Task 6, Epoch 19/20 => Loss 2.723, Loss_clf 0.216, Loss_fe 0.198, Loss_kd 1.980, Train_accy 82.29:  90%|█████████ | 18/20 [22:34<02:20, 70.13s/it]
Task 6, Epoch 19/20 => Loss 2.723, Loss_clf 0.216, Loss_fe 0.198, Loss_kd 1.980, Train_accy 82.29:  95%|█████████▌| 19/20 [22:34<01:08, 68.07s/it]
Task 6, Epoch 20/20 => Loss 2.711, Loss_clf 0.218, Loss_fe 0.196, Loss_kd 1.969, Train_accy 82.58:  95%|█████████▌| 19/20 [23:37<01:08, 68.07s/it]
Task 6, Epoch 20/20 => Loss 2.711, Loss_clf 0.218, Loss_fe 0.196, Loss_kd 1.969, Train_accy 82.58: 100%|██████████| 20/20 [23:37<00:00, 66.63s/it]
Task 6, Epoch 20/20 => Loss 2.711, Loss_clf 0.218, Loss_fe 0.196, Loss_kd 1.969, Train_accy 82.58: 100%|██████████| 20/20 [23:37<00:00, 70.89s/it]
2024-09-04 21:40:49,033 [foster.py] => Task 6, Epoch 20/20 => Loss 2.711, Loss_clf 0.218, Loss_fe 0.196, Loss_kd 1.969, Train_accy 82.58
2024-09-04 21:40:49,034 [foster.py] => do not weight align teacher!
2024-09-04 21:40:49,038 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 2.039,  Train_accy 60.76, Test_accy 88.91:   0%|          | 0/20 [01:39<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 2.039,  Train_accy 60.76, Test_accy 88.91:   5%|▌         | 1/20 [01:39<31:37, 99.87s/it]
SNet: Task 6, Epoch 2/20 => Loss 1.884,  Train_accy 66.98:   5%|▌         | 1/20 [02:59<31:37, 99.87s/it]                 
SNet: Task 6, Epoch 2/20 => Loss 1.884,  Train_accy 66.98:  10%|█         | 2/20 [02:59<26:23, 87.95s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.882,  Train_accy 67.76:  10%|█         | 2/20 [04:19<26:23, 87.95s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.882,  Train_accy 67.76:  15%|█▌        | 3/20 [04:19<23:50, 84.15s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.873,  Train_accy 67.85:  15%|█▌        | 3/20 [05:38<23:50, 84.15s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.873,  Train_accy 67.85:  20%|██        | 4/20 [05:38<21:58, 82.38s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.860,  Train_accy 68.58:  20%|██        | 4/20 [06:58<21:58, 82.38s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.860,  Train_accy 68.58:  25%|██▌       | 5/20 [06:58<20:20, 81.34s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.858,  Train_accy 68.08, Test_accy 88.70:  25%|██▌       | 5/20 [08:38<20:20, 81.34s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.858,  Train_accy 68.08, Test_accy 88.70:  30%|███       | 6/20 [08:38<20:27, 87.67s/it]
SNet: Task 6, Epoch 7/20 => Loss 1.868,  Train_accy 68.87:  30%|███       | 6/20 [09:57<20:27, 87.67s/it]                 
SNet: Task 6, Epoch 7/20 => Loss 1.868,  Train_accy 68.87:  35%|███▌      | 7/20 [09:57<18:25, 85.02s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.850,  Train_accy 69.37:  35%|███▌      | 7/20 [11:17<18:25, 85.02s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.850,  Train_accy 69.37:  40%|████      | 8/20 [11:17<16:39, 83.29s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.871,  Train_accy 67.81:  40%|████      | 8/20 [12:36<16:39, 83.29s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.871,  Train_accy 67.81:  45%|████▌     | 9/20 [12:36<15:03, 82.11s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.876,  Train_accy 68.16:  45%|████▌     | 9/20 [13:56<15:03, 82.11s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.876,  Train_accy 68.16:  50%|█████     | 10/20 [13:56<13:33, 81.33s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.869,  Train_accy 68.21, Test_accy 88.51:  50%|█████     | 10/20 [15:36<13:33, 81.33s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.869,  Train_accy 68.21, Test_accy 88.51:  55%|█████▌    | 11/20 [15:36<13:03, 87.03s/it]
SNet: Task 6, Epoch 12/20 => Loss 1.864,  Train_accy 67.94:  55%|█████▌    | 11/20 [16:55<13:03, 87.03s/it]                 
SNet: Task 6, Epoch 12/20 => Loss 1.864,  Train_accy 67.94:  60%|██████    | 12/20 [16:55<11:18, 84.76s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.855,  Train_accy 68.87:  60%|██████    | 12/20 [18:15<11:18, 84.76s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.855,  Train_accy 68.87:  65%|██████▌   | 13/20 [18:15<09:42, 83.18s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.872,  Train_accy 68.76:  65%|██████▌   | 13/20 [19:35<09:42, 83.18s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.872,  Train_accy 68.76:  70%|███████   | 14/20 [19:35<08:12, 82.08s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.845,  Train_accy 68.87:  70%|███████   | 14/20 [20:54<08:12, 82.08s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.845,  Train_accy 68.87:  75%|███████▌  | 15/20 [20:54<06:46, 81.30s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.858,  Train_accy 68.95, Test_accy 88.59:  75%|███████▌  | 15/20 [22:34<06:46, 81.30s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.858,  Train_accy 68.95, Test_accy 88.59:  80%|████████  | 16/20 [22:34<05:47, 86.87s/it]
SNet: Task 6, Epoch 17/20 => Loss 1.839,  Train_accy 69.08:  80%|████████  | 16/20 [23:53<05:47, 86.87s/it]                 
SNet: Task 6, Epoch 17/20 => Loss 1.839,  Train_accy 69.08:  85%|████████▌ | 17/20 [23:53<04:13, 84.65s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.869,  Train_accy 68.32:  85%|████████▌ | 17/20 [25:13<04:13, 84.65s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.869,  Train_accy 68.32:  90%|█████████ | 18/20 [25:13<02:46, 83.12s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.886,  Train_accy 68.15:  90%|█████████ | 18/20 [26:32<02:46, 83.12s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.886,  Train_accy 68.15:  95%|█████████▌| 19/20 [26:32<01:22, 82.05s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.858,  Train_accy 68.53:  95%|█████████▌| 19/20 [27:52<01:22, 82.05s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.858,  Train_accy 68.53: 100%|██████████| 20/20 [27:52<00:00, 81.42s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.858,  Train_accy 68.53: 100%|██████████| 20/20 [27:52<00:00, 83.65s/it]
2024-09-04 22:08:43,569 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.858,  Train_accy 68.53
2024-09-04 22:08:43,569 [foster.py] => do not weight align student!
2024-09-04 22:09:03,964 [foster.py] => darknet eval: 
2024-09-04 22:09:03,965 [foster.py] => CNN top1 curve: 88.56
2024-09-04 22:09:03,965 [foster.py] => CNN top5 curve: 99.29
2024-09-04 22:09:03,967 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 22:11:18,168 [foster.py] => Exemplar size: 1400
2024-09-04 22:11:18,168 [trainer.py] => CNN: {'total': 89.77, '00-09': 94.6, '10-19': 94.5, '20-29': 94.5, '30-39': 91.1, '40-49': 87.3, '50-59': 84.3, '60-69': 82.1, 'old': 91.05, 'new': 82.1}
2024-09-04 22:11:18,168 [trainer.py] => NME: {'total': 91.51, '00-09': 93.1, '10-19': 90.8, '20-29': 94.2, '30-39': 89.8, '40-49': 90.8, '50-59': 85.8, '60-69': 96.1, 'old': 90.75, 'new': 96.1}
2024-09-04 22:11:18,168 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3, 92.08, 90.88, 90.52, 89.77]
2024-09-04 22:11:18,168 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73, 99.68, 99.32, 99.33, 99.29]
2024-09-04 22:11:18,168 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73, 94.68, 92.4, 92.03, 91.51]
2024-09-04 22:11:18,168 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67, 99.6, 99.48, 99.45, 99.3]

Average Accuracy (CNN): 93.34
Average Accuracy (NME): 94.6
2024-09-04 22:11:18,168 [trainer.py] => Average Accuracy (CNN): 93.34
2024-09-04 22:11:18,168 [trainer.py] => Average Accuracy (NME): 94.6
2024-09-04 22:11:18,170 [trainer.py] => All params: 171804872
2024-09-04 22:11:18,171 [trainer.py] => Trainable params: 85960076
2024-09-04 22:11:19,755 [foster.py] => Learning on 70-80
2024-09-04 22:11:19,757 [foster.py] => All params: 171835622
2024-09-04 22:11:19,758 [foster.py] => Trainable params: 85983136
2024-09-04 22:11:19,861 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 4.964, Loss_clf 0.871, Loss_fe 1.697, Loss_kd 2.096, Train_accy 51.56, Test_accy 85.45:   0%|          | 0/20 [01:49<?, ?it/s]
Task 7, Epoch 1/20 => Loss 4.964, Loss_clf 0.871, Loss_fe 1.697, Loss_kd 2.096, Train_accy 51.56, Test_accy 85.45:   5%|▌         | 1/20 [01:49<34:38, 109.37s/it]
Task 7, Epoch 2/20 => Loss 3.873, Loss_clf 0.564, Loss_fe 0.923, Loss_kd 2.087, Train_accy 56.19:   5%|▌         | 1/20 [02:54<34:38, 109.37s/it]                 
Task 7, Epoch 2/20 => Loss 3.873, Loss_clf 0.564, Loss_fe 0.923, Loss_kd 2.087, Train_accy 56.19:  10%|█         | 2/20 [02:54<25:00, 83.38s/it] 
Task 7, Epoch 3/20 => Loss 3.535, Loss_clf 0.489, Loss_fe 0.676, Loss_kd 2.073, Train_accy 58.91:  10%|█         | 2/20 [03:59<25:00, 83.38s/it]
Task 7, Epoch 3/20 => Loss 3.535, Loss_clf 0.489, Loss_fe 0.676, Loss_kd 2.073, Train_accy 58.91:  15%|█▌        | 3/20 [03:59<21:15, 75.04s/it]
Task 7, Epoch 4/20 => Loss 3.390, Loss_clf 0.442, Loss_fe 0.584, Loss_kd 2.068, Train_accy 61.05:  15%|█▌        | 3/20 [05:04<21:15, 75.04s/it]
Task 7, Epoch 4/20 => Loss 3.390, Loss_clf 0.442, Loss_fe 0.584, Loss_kd 2.068, Train_accy 61.05:  20%|██        | 4/20 [05:04<18:58, 71.13s/it]
Task 7, Epoch 5/20 => Loss 3.389, Loss_clf 0.448, Loss_fe 0.560, Loss_kd 2.083, Train_accy 62.84:  20%|██        | 4/20 [06:09<18:58, 71.13s/it]
Task 7, Epoch 5/20 => Loss 3.389, Loss_clf 0.448, Loss_fe 0.560, Loss_kd 2.083, Train_accy 62.84:  25%|██▌       | 5/20 [06:09<17:14, 68.98s/it]
Task 7, Epoch 6/20 => Loss 3.190, Loss_clf 0.375, Loss_fe 0.467, Loss_kd 2.054, Train_accy 64.39, Test_accy 86.12:  25%|██▌       | 5/20 [07:59<17:14, 68.98s/it]
Task 7, Epoch 6/20 => Loss 3.190, Loss_clf 0.375, Loss_fe 0.467, Loss_kd 2.054, Train_accy 64.39, Test_accy 86.12:  30%|███       | 6/20 [07:59<19:19, 82.84s/it]
Task 7, Epoch 7/20 => Loss 3.237, Loss_clf 0.405, Loss_fe 0.465, Loss_kd 2.071, Train_accy 65.23:  30%|███       | 6/20 [09:04<19:19, 82.84s/it]                 
Task 7, Epoch 7/20 => Loss 3.237, Loss_clf 0.405, Loss_fe 0.465, Loss_kd 2.071, Train_accy 65.23:  35%|███▌      | 7/20 [09:04<16:41, 77.06s/it]
Task 7, Epoch 8/20 => Loss 3.136, Loss_clf 0.354, Loss_fe 0.413, Loss_kd 2.072, Train_accy 66.84:  35%|███▌      | 7/20 [10:10<16:41, 77.06s/it]
Task 7, Epoch 8/20 => Loss 3.136, Loss_clf 0.354, Loss_fe 0.413, Loss_kd 2.072, Train_accy 66.84:  40%|████      | 8/20 [10:10<14:39, 73.31s/it]
Task 7, Epoch 9/20 => Loss 3.085, Loss_clf 0.345, Loss_fe 0.385, Loss_kd 2.060, Train_accy 67.77:  40%|████      | 8/20 [11:15<14:39, 73.31s/it]
Task 7, Epoch 9/20 => Loss 3.085, Loss_clf 0.345, Loss_fe 0.385, Loss_kd 2.060, Train_accy 67.77:  45%|████▌     | 9/20 [11:15<12:58, 70.80s/it]
Task 7, Epoch 10/20 => Loss 3.043, Loss_clf 0.338, Loss_fe 0.349, Loss_kd 2.062, Train_accy 69.12:  45%|████▌     | 9/20 [12:20<12:58, 70.80s/it]
Task 7, Epoch 10/20 => Loss 3.043, Loss_clf 0.338, Loss_fe 0.349, Loss_kd 2.062, Train_accy 69.12:  50%|█████     | 10/20 [12:20<11:30, 69.07s/it]
Task 7, Epoch 11/20 => Loss 3.051, Loss_clf 0.328, Loss_fe 0.348, Loss_kd 2.078, Train_accy 70.05, Test_accy 87.52:  50%|█████     | 10/20 [14:11<11:30, 69.07s/it]
Task 7, Epoch 11/20 => Loss 3.051, Loss_clf 0.328, Loss_fe 0.348, Loss_kd 2.078, Train_accy 70.05, Test_accy 87.52:  55%|█████▌    | 11/20 [14:11<12:15, 81.77s/it]
Task 7, Epoch 12/20 => Loss 2.986, Loss_clf 0.295, Loss_fe 0.317, Loss_kd 2.077, Train_accy 71.69:  55%|█████▌    | 11/20 [15:16<12:15, 81.77s/it]                 
Task 7, Epoch 12/20 => Loss 2.986, Loss_clf 0.295, Loss_fe 0.317, Loss_kd 2.077, Train_accy 71.69:  60%|██████    | 12/20 [15:16<10:14, 76.77s/it]
Task 7, Epoch 13/20 => Loss 2.890, Loss_clf 0.268, Loss_fe 0.272, Loss_kd 2.056, Train_accy 73.42:  60%|██████    | 12/20 [16:21<10:14, 76.77s/it]
Task 7, Epoch 13/20 => Loss 2.890, Loss_clf 0.268, Loss_fe 0.272, Loss_kd 2.056, Train_accy 73.42:  65%|██████▌   | 13/20 [16:21<08:33, 73.30s/it]
Task 7, Epoch 14/20 => Loss 2.901, Loss_clf 0.272, Loss_fe 0.264, Loss_kd 2.069, Train_accy 73.44:  65%|██████▌   | 13/20 [17:27<08:33, 73.30s/it]
Task 7, Epoch 14/20 => Loss 2.901, Loss_clf 0.272, Loss_fe 0.264, Loss_kd 2.069, Train_accy 73.44:  70%|███████   | 14/20 [17:27<07:05, 70.84s/it]
Task 7, Epoch 15/20 => Loss 2.885, Loss_clf 0.268, Loss_fe 0.258, Loss_kd 2.064, Train_accy 74.17:  70%|███████   | 14/20 [18:32<07:05, 70.84s/it]
Task 7, Epoch 15/20 => Loss 2.885, Loss_clf 0.268, Loss_fe 0.258, Loss_kd 2.064, Train_accy 74.17:  75%|███████▌  | 15/20 [18:32<05:45, 69.14s/it]
Task 7, Epoch 16/20 => Loss 2.865, Loss_clf 0.259, Loss_fe 0.244, Loss_kd 2.067, Train_accy 75.33, Test_accy 87.60:  75%|███████▌  | 15/20 [20:21<05:45, 69.14s/it]
Task 7, Epoch 16/20 => Loss 2.865, Loss_clf 0.259, Loss_fe 0.244, Loss_kd 2.067, Train_accy 75.33, Test_accy 87.60:  80%|████████  | 16/20 [20:21<05:25, 81.30s/it]
Task 7, Epoch 17/20 => Loss 2.853, Loss_clf 0.255, Loss_fe 0.239, Loss_kd 2.064, Train_accy 75.09:  80%|████████  | 16/20 [21:26<05:25, 81.30s/it]                 
Task 7, Epoch 17/20 => Loss 2.853, Loss_clf 0.255, Loss_fe 0.239, Loss_kd 2.064, Train_accy 75.09:  85%|████████▌ | 17/20 [21:26<03:49, 76.46s/it]
Task 7, Epoch 18/20 => Loss 2.852, Loss_clf 0.257, Loss_fe 0.235, Loss_kd 2.065, Train_accy 75.41:  85%|████████▌ | 17/20 [22:32<03:49, 76.46s/it]
Task 7, Epoch 18/20 => Loss 2.852, Loss_clf 0.257, Loss_fe 0.235, Loss_kd 2.065, Train_accy 75.41:  90%|█████████ | 18/20 [22:32<02:26, 73.07s/it]
Task 7, Epoch 19/20 => Loss 2.829, Loss_clf 0.250, Loss_fe 0.221, Loss_kd 2.063, Train_accy 75.75:  90%|█████████ | 18/20 [23:37<02:26, 73.07s/it]
Task 7, Epoch 19/20 => Loss 2.829, Loss_clf 0.250, Loss_fe 0.221, Loss_kd 2.063, Train_accy 75.75:  95%|█████████▌| 19/20 [23:37<01:10, 70.72s/it]
Task 7, Epoch 20/20 => Loss 2.787, Loss_clf 0.231, Loss_fe 0.209, Loss_kd 2.053, Train_accy 77.02:  95%|█████████▌| 19/20 [24:42<01:10, 70.72s/it]
Task 7, Epoch 20/20 => Loss 2.787, Loss_clf 0.231, Loss_fe 0.209, Loss_kd 2.053, Train_accy 77.02: 100%|██████████| 20/20 [24:42<00:00, 69.07s/it]
Task 7, Epoch 20/20 => Loss 2.787, Loss_clf 0.231, Loss_fe 0.209, Loss_kd 2.053, Train_accy 77.02: 100%|██████████| 20/20 [24:42<00:00, 74.13s/it]
2024-09-04 22:36:02,464 [foster.py] => Task 7, Epoch 20/20 => Loss 2.787, Loss_clf 0.231, Loss_fe 0.209, Loss_kd 2.053, Train_accy 77.02
2024-09-04 22:36:02,464 [foster.py] => do not weight align teacher!
2024-09-04 22:36:02,466 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 2.350,  Train_accy 48.92, Test_accy 85.75:   0%|          | 0/20 [01:45<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 2.350,  Train_accy 48.92, Test_accy 85.75:   5%|▌         | 1/20 [01:45<33:15, 105.04s/it]
SNet: Task 7, Epoch 2/20 => Loss 2.200,  Train_accy 55.75:   5%|▌         | 1/20 [03:07<33:15, 105.04s/it]                 
SNet: Task 7, Epoch 2/20 => Loss 2.200,  Train_accy 55.75:  10%|█         | 2/20 [03:07<27:27, 91.54s/it] 
SNet: Task 7, Epoch 3/20 => Loss 2.193,  Train_accy 55.94:  10%|█         | 2/20 [04:29<27:27, 91.54s/it]
SNet: Task 7, Epoch 3/20 => Loss 2.193,  Train_accy 55.94:  15%|█▌        | 3/20 [04:29<24:42, 87.21s/it]
SNet: Task 7, Epoch 4/20 => Loss 2.180,  Train_accy 57.50:  15%|█▌        | 3/20 [05:51<24:42, 87.21s/it]
SNet: Task 7, Epoch 4/20 => Loss 2.180,  Train_accy 57.50:  20%|██        | 4/20 [05:51<22:44, 85.26s/it]
SNet: Task 7, Epoch 5/20 => Loss 2.174,  Train_accy 57.64:  20%|██        | 4/20 [07:13<22:44, 85.26s/it]
SNet: Task 7, Epoch 5/20 => Loss 2.174,  Train_accy 57.64:  25%|██▌       | 5/20 [07:13<21:02, 84.20s/it]
SNet: Task 7, Epoch 6/20 => Loss 2.180,  Train_accy 57.84, Test_accy 85.99:  25%|██▌       | 5/20 [08:58<21:02, 84.20s/it]
SNet: Task 7, Epoch 6/20 => Loss 2.180,  Train_accy 57.84, Test_accy 85.99:  30%|███       | 6/20 [08:58<21:18, 91.31s/it]
SNet: Task 7, Epoch 7/20 => Loss 2.189,  Train_accy 57.27:  30%|███       | 6/20 [10:20<21:18, 91.31s/it]                 
SNet: Task 7, Epoch 7/20 => Loss 2.189,  Train_accy 57.27:  35%|███▌      | 7/20 [10:20<19:07, 88.28s/it]
SNet: Task 7, Epoch 8/20 => Loss 2.173,  Train_accy 57.53:  35%|███▌      | 7/20 [11:42<19:07, 88.28s/it]
SNet: Task 7, Epoch 8/20 => Loss 2.173,  Train_accy 57.53:  40%|████      | 8/20 [11:42<17:15, 86.29s/it]
SNet: Task 7, Epoch 9/20 => Loss 2.168,  Train_accy 58.22:  40%|████      | 8/20 [13:05<17:15, 86.29s/it]
SNet: Task 7, Epoch 9/20 => Loss 2.168,  Train_accy 58.22:  45%|████▌     | 9/20 [13:05<15:34, 84.98s/it]
SNet: Task 7, Epoch 10/20 => Loss 2.178,  Train_accy 58.05:  45%|████▌     | 9/20 [14:27<15:34, 84.98s/it]
SNet: Task 7, Epoch 10/20 => Loss 2.178,  Train_accy 58.05:  50%|█████     | 10/20 [14:27<14:00, 84.08s/it]
SNet: Task 7, Epoch 11/20 => Loss 2.166,  Train_accy 57.89, Test_accy 86.35:  50%|█████     | 10/20 [16:12<14:00, 84.08s/it]
SNet: Task 7, Epoch 11/20 => Loss 2.166,  Train_accy 57.89, Test_accy 86.35:  55%|█████▌    | 11/20 [16:12<13:34, 90.54s/it]
SNet: Task 7, Epoch 12/20 => Loss 2.152,  Train_accy 58.67:  55%|█████▌    | 11/20 [17:34<13:34, 90.54s/it]                 
SNet: Task 7, Epoch 12/20 => Loss 2.152,  Train_accy 58.67:  60%|██████    | 12/20 [17:34<11:43, 87.99s/it]
SNet: Task 7, Epoch 13/20 => Loss 2.163,  Train_accy 58.67:  60%|██████    | 12/20 [18:56<11:43, 87.99s/it]
SNet: Task 7, Epoch 13/20 => Loss 2.163,  Train_accy 58.67:  65%|██████▌   | 13/20 [18:56<10:03, 86.20s/it]
SNet: Task 7, Epoch 14/20 => Loss 2.155,  Train_accy 58.55:  65%|██████▌   | 13/20 [20:18<10:03, 86.20s/it]
SNet: Task 7, Epoch 14/20 => Loss 2.155,  Train_accy 58.55:  70%|███████   | 14/20 [20:18<08:29, 84.96s/it]
SNet: Task 7, Epoch 15/20 => Loss 2.156,  Train_accy 58.95:  70%|███████   | 14/20 [21:40<08:29, 84.96s/it]
SNet: Task 7, Epoch 15/20 => Loss 2.156,  Train_accy 58.95:  75%|███████▌  | 15/20 [21:40<07:00, 84.13s/it]
SNet: Task 7, Epoch 16/20 => Loss 2.154,  Train_accy 58.61, Test_accy 86.38:  75%|███████▌  | 15/20 [23:26<07:00, 84.13s/it]
SNet: Task 7, Epoch 16/20 => Loss 2.154,  Train_accy 58.61, Test_accy 86.38:  80%|████████  | 16/20 [23:26<06:02, 90.52s/it]
SNet: Task 7, Epoch 17/20 => Loss 2.170,  Train_accy 59.08:  80%|████████  | 16/20 [24:48<06:02, 90.52s/it]                 
SNet: Task 7, Epoch 17/20 => Loss 2.170,  Train_accy 59.08:  85%|████████▌ | 17/20 [24:48<04:24, 88.03s/it]
SNet: Task 7, Epoch 18/20 => Loss 2.178,  Train_accy 58.59:  85%|████████▌ | 17/20 [26:10<04:24, 88.03s/it]
SNet: Task 7, Epoch 18/20 => Loss 2.178,  Train_accy 58.59:  90%|█████████ | 18/20 [26:10<02:52, 86.27s/it]
SNet: Task 7, Epoch 19/20 => Loss 2.165,  Train_accy 58.34:  90%|█████████ | 18/20 [27:32<02:52, 86.27s/it]
SNet: Task 7, Epoch 19/20 => Loss 2.165,  Train_accy 58.34:  95%|█████████▌| 19/20 [27:32<01:25, 85.09s/it]
SNet: Task 7, Epoch 20/20 => Loss 2.165,  Train_accy 58.55:  95%|█████████▌| 19/20 [28:55<01:25, 85.09s/it]
SNet: Task 7, Epoch 20/20 => Loss 2.165,  Train_accy 58.55: 100%|██████████| 20/20 [28:55<00:00, 84.22s/it]
SNet: Task 7, Epoch 20/20 => Loss 2.165,  Train_accy 58.55: 100%|██████████| 20/20 [28:55<00:00, 86.76s/it]
2024-09-04 23:04:59,290 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 2.165,  Train_accy 58.55
2024-09-04 23:04:59,291 [foster.py] => do not weight align student!
2024-09-04 23:05:22,408 [foster.py] => darknet eval: 
2024-09-04 23:05:22,409 [foster.py] => CNN top1 curve: 86.34
2024-09-04 23:05:22,409 [foster.py] => CNN top5 curve: 99.18
2024-09-04 23:05:22,411 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-04 23:07:50,796 [foster.py] => Exemplar size: 1600
2024-09-04 23:07:50,796 [trainer.py] => CNN: {'total': 87.75, '00-09': 93.5, '10-19': 93.9, '20-29': 94.4, '30-39': 91.9, '40-49': 88.6, '50-59': 85.7, '60-69': 81.5, '70-79': 72.5, 'old': 89.93, 'new': 72.5}
2024-09-04 23:07:50,796 [trainer.py] => NME: {'total': 88.89, '00-09': 92.4, '10-19': 89.6, '20-29': 93.9, '30-39': 89.4, '40-49': 88.1, '50-59': 78.3, '60-69': 87.8, '70-79': 91.6, 'old': 88.5, 'new': 91.6}
2024-09-04 23:07:50,797 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3, 92.08, 90.88, 90.52, 89.77, 87.75]
2024-09-04 23:07:50,797 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73, 99.68, 99.32, 99.33, 99.29, 99.15]
2024-09-04 23:07:50,797 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73, 94.68, 92.4, 92.03, 91.51, 88.89]
2024-09-04 23:07:50,797 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67, 99.6, 99.48, 99.45, 99.3, 99.21]

Average Accuracy (CNN): 92.64
Average Accuracy (NME): 93.89
2024-09-04 23:07:50,797 [trainer.py] => Average Accuracy (CNN): 92.64
2024-09-04 23:07:50,797 [trainer.py] => Average Accuracy (NME): 93.89
2024-09-04 23:07:50,798 [trainer.py] => All params: 171835622
2024-09-04 23:07:50,799 [trainer.py] => Trainable params: 85983136
2024-09-04 23:07:52,192 [foster.py] => Learning on 80-90
2024-09-04 23:07:52,194 [foster.py] => All params: 171866372
2024-09-04 23:07:52,195 [foster.py] => Trainable params: 86006196
2024-09-04 23:07:52,306 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 4.922, Loss_clf 0.870, Loss_fe 1.737, Loss_kd 2.057, Train_accy 53.11, Test_accy 84.70:   0%|          | 0/20 [01:56<?, ?it/s]
Task 8, Epoch 1/20 => Loss 4.922, Loss_clf 0.870, Loss_fe 1.737, Loss_kd 2.057, Train_accy 53.11, Test_accy 84.70:   5%|▌         | 1/20 [01:56<37:02, 116.95s/it]
Task 8, Epoch 2/20 => Loss 3.757, Loss_clf 0.513, Loss_fe 0.939, Loss_kd 2.050, Train_accy 59.30:   5%|▌         | 1/20 [03:04<37:02, 116.95s/it]                 
Task 8, Epoch 2/20 => Loss 3.757, Loss_clf 0.513, Loss_fe 0.939, Loss_kd 2.050, Train_accy 59.30:  10%|█         | 2/20 [03:04<26:18, 87.71s/it] 
Task 8, Epoch 3/20 => Loss 3.475, Loss_clf 0.478, Loss_fe 0.705, Loss_kd 2.038, Train_accy 59.56:  10%|█         | 2/20 [04:11<26:18, 87.71s/it]
Task 8, Epoch 3/20 => Loss 3.475, Loss_clf 0.478, Loss_fe 0.705, Loss_kd 2.038, Train_accy 59.56:  15%|█▌        | 3/20 [04:11<22:12, 78.38s/it]
Task 8, Epoch 4/20 => Loss 3.313, Loss_clf 0.422, Loss_fe 0.599, Loss_kd 2.037, Train_accy 62.15:  15%|█▌        | 3/20 [05:18<22:12, 78.38s/it]
Task 8, Epoch 4/20 => Loss 3.313, Loss_clf 0.422, Loss_fe 0.599, Loss_kd 2.037, Train_accy 62.15:  20%|██        | 4/20 [05:18<19:43, 73.98s/it]
Task 8, Epoch 5/20 => Loss 3.323, Loss_clf 0.436, Loss_fe 0.567, Loss_kd 2.062, Train_accy 63.48:  20%|██        | 4/20 [06:25<19:43, 73.98s/it]
Task 8, Epoch 5/20 => Loss 3.323, Loss_clf 0.436, Loss_fe 0.567, Loss_kd 2.062, Train_accy 63.48:  25%|██▌       | 5/20 [06:25<17:53, 71.57s/it]
Task 8, Epoch 6/20 => Loss 3.183, Loss_clf 0.387, Loss_fe 0.495, Loss_kd 2.044, Train_accy 64.27, Test_accy 85.77:  25%|██▌       | 5/20 [08:23<17:53, 71.57s/it]
Task 8, Epoch 6/20 => Loss 3.183, Loss_clf 0.387, Loss_fe 0.495, Loss_kd 2.044, Train_accy 64.27, Test_accy 85.77:  30%|███       | 6/20 [08:23<20:18, 87.04s/it]
Task 8, Epoch 7/20 => Loss 3.116, Loss_clf 0.363, Loss_fe 0.455, Loss_kd 2.043, Train_accy 66.38:  30%|███       | 6/20 [09:30<20:18, 87.04s/it]                 
Task 8, Epoch 7/20 => Loss 3.116, Loss_clf 0.363, Loss_fe 0.455, Loss_kd 2.043, Train_accy 66.38:  35%|███▌      | 7/20 [09:30<17:27, 80.56s/it]
Task 8, Epoch 8/20 => Loss 3.123, Loss_clf 0.370, Loss_fe 0.432, Loss_kd 2.063, Train_accy 67.71:  35%|███▌      | 7/20 [10:37<17:27, 80.56s/it]
Task 8, Epoch 8/20 => Loss 3.123, Loss_clf 0.370, Loss_fe 0.432, Loss_kd 2.063, Train_accy 67.71:  40%|████      | 8/20 [10:37<15:16, 76.34s/it]
Task 8, Epoch 9/20 => Loss 3.050, Loss_clf 0.343, Loss_fe 0.395, Loss_kd 2.055, Train_accy 70.06:  40%|████      | 8/20 [11:44<15:16, 76.34s/it]
Task 8, Epoch 9/20 => Loss 3.050, Loss_clf 0.343, Loss_fe 0.395, Loss_kd 2.055, Train_accy 70.06:  45%|████▌     | 9/20 [11:44<13:28, 73.51s/it]
Task 8, Epoch 10/20 => Loss 2.972, Loss_clf 0.324, Loss_fe 0.354, Loss_kd 2.039, Train_accy 72.42:  45%|████▌     | 9/20 [12:52<13:28, 73.51s/it]
Task 8, Epoch 10/20 => Loss 2.972, Loss_clf 0.324, Loss_fe 0.354, Loss_kd 2.039, Train_accy 72.42:  50%|█████     | 10/20 [12:52<11:55, 71.59s/it]
Task 8, Epoch 11/20 => Loss 2.977, Loss_clf 0.322, Loss_fe 0.341, Loss_kd 2.057, Train_accy 70.76, Test_accy 86.98:  50%|█████     | 10/20 [14:49<11:55, 71.59s/it]
Task 8, Epoch 11/20 => Loss 2.977, Loss_clf 0.322, Loss_fe 0.341, Loss_kd 2.057, Train_accy 70.76, Test_accy 86.98:  55%|█████▌    | 11/20 [14:49<12:49, 85.53s/it]
Task 8, Epoch 12/20 => Loss 2.906, Loss_clf 0.297, Loss_fe 0.313, Loss_kd 2.041, Train_accy 72.12:  55%|█████▌    | 11/20 [15:56<12:49, 85.53s/it]                 
Task 8, Epoch 12/20 => Loss 2.906, Loss_clf 0.297, Loss_fe 0.313, Loss_kd 2.041, Train_accy 72.12:  60%|██████    | 12/20 [15:56<10:39, 79.98s/it]
Task 8, Epoch 13/20 => Loss 2.931, Loss_clf 0.309, Loss_fe 0.312, Loss_kd 2.054, Train_accy 73.09:  60%|██████    | 12/20 [17:03<10:39, 79.98s/it]
Task 8, Epoch 13/20 => Loss 2.931, Loss_clf 0.309, Loss_fe 0.312, Loss_kd 2.054, Train_accy 73.09:  65%|██████▌   | 13/20 [17:03<08:52, 76.13s/it]
Task 8, Epoch 14/20 => Loss 2.934, Loss_clf 0.307, Loss_fe 0.313, Loss_kd 2.057, Train_accy 73.39:  65%|██████▌   | 13/20 [18:11<08:52, 76.13s/it]
Task 8, Epoch 14/20 => Loss 2.934, Loss_clf 0.307, Loss_fe 0.313, Loss_kd 2.057, Train_accy 73.39:  70%|███████   | 14/20 [18:11<07:20, 73.47s/it]
Task 8, Epoch 15/20 => Loss 2.821, Loss_clf 0.264, Loss_fe 0.260, Loss_kd 2.041, Train_accy 74.61:  70%|███████   | 14/20 [19:18<07:20, 73.47s/it]
Task 8, Epoch 15/20 => Loss 2.821, Loss_clf 0.264, Loss_fe 0.260, Loss_kd 2.041, Train_accy 74.61:  75%|███████▌  | 15/20 [19:18<05:57, 71.58s/it]
Task 8, Epoch 16/20 => Loss 2.850, Loss_clf 0.283, Loss_fe 0.264, Loss_kd 2.047, Train_accy 74.52, Test_accy 86.49:  75%|███████▌  | 15/20 [21:16<05:57, 71.58s/it]
Task 8, Epoch 16/20 => Loss 2.850, Loss_clf 0.283, Loss_fe 0.264, Loss_kd 2.047, Train_accy 74.52, Test_accy 86.49:  80%|████████  | 16/20 [21:16<05:42, 85.53s/it]
Task 8, Epoch 17/20 => Loss 2.783, Loss_clf 0.258, Loss_fe 0.241, Loss_kd 2.030, Train_accy 74.38:  80%|████████  | 16/20 [22:23<05:42, 85.53s/it]                 
Task 8, Epoch 17/20 => Loss 2.783, Loss_clf 0.258, Loss_fe 0.241, Loss_kd 2.030, Train_accy 74.38:  85%|████████▌ | 17/20 [22:23<04:00, 80.08s/it]
Task 8, Epoch 18/20 => Loss 2.782, Loss_clf 0.250, Loss_fe 0.229, Loss_kd 2.047, Train_accy 75.41:  85%|████████▌ | 17/20 [23:31<04:00, 80.08s/it]
Task 8, Epoch 18/20 => Loss 2.782, Loss_clf 0.250, Loss_fe 0.229, Loss_kd 2.047, Train_accy 75.41:  90%|█████████ | 18/20 [23:31<02:32, 76.24s/it]
Task 8, Epoch 19/20 => Loss 2.819, Loss_clf 0.267, Loss_fe 0.245, Loss_kd 2.051, Train_accy 75.02:  90%|█████████ | 18/20 [24:38<02:32, 76.24s/it]
Task 8, Epoch 19/20 => Loss 2.819, Loss_clf 0.267, Loss_fe 0.245, Loss_kd 2.051, Train_accy 75.02:  95%|█████████▌| 19/20 [24:38<01:13, 73.52s/it]
Task 8, Epoch 20/20 => Loss 2.773, Loss_clf 0.252, Loss_fe 0.228, Loss_kd 2.038, Train_accy 75.58:  95%|█████████▌| 19/20 [25:45<01:13, 73.52s/it]
Task 8, Epoch 20/20 => Loss 2.773, Loss_clf 0.252, Loss_fe 0.228, Loss_kd 2.038, Train_accy 75.58: 100%|██████████| 20/20 [25:45<00:00, 71.63s/it]
Task 8, Epoch 20/20 => Loss 2.773, Loss_clf 0.252, Loss_fe 0.228, Loss_kd 2.038, Train_accy 75.58: 100%|██████████| 20/20 [25:45<00:00, 77.27s/it]
2024-09-04 23:33:37,738 [foster.py] => Task 8, Epoch 20/20 => Loss 2.773, Loss_clf 0.252, Loss_fe 0.228, Loss_kd 2.038, Train_accy 75.58
2024-09-04 23:33:37,739 [foster.py] => do not weight align teacher!
2024-09-04 23:33:37,744 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 2.195,  Train_accy 50.88, Test_accy 85.37:   0%|          | 0/20 [01:50<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 2.195,  Train_accy 50.88, Test_accy 85.37:   5%|▌         | 1/20 [01:50<34:57, 110.40s/it]
SNet: Task 8, Epoch 2/20 => Loss 2.029,  Train_accy 56.44:   5%|▌         | 1/20 [03:15<34:57, 110.40s/it]                 
SNet: Task 8, Epoch 2/20 => Loss 2.029,  Train_accy 56.44:  10%|█         | 2/20 [03:15<28:34, 95.22s/it] 
SNet: Task 8, Epoch 3/20 => Loss 2.027,  Train_accy 57.33:  10%|█         | 2/20 [04:39<28:34, 95.22s/it]
SNet: Task 8, Epoch 3/20 => Loss 2.027,  Train_accy 57.33:  15%|█▌        | 3/20 [04:39<25:36, 90.40s/it]
SNet: Task 8, Epoch 4/20 => Loss 2.010,  Train_accy 57.35:  15%|█▌        | 3/20 [06:04<25:36, 90.40s/it]
SNet: Task 8, Epoch 4/20 => Loss 2.010,  Train_accy 57.35:  20%|██        | 4/20 [06:04<23:30, 88.13s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.992,  Train_accy 58.42:  20%|██        | 4/20 [07:28<23:30, 88.13s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.992,  Train_accy 58.42:  25%|██▌       | 5/20 [07:28<21:43, 86.87s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.992,  Train_accy 58.24, Test_accy 85.53:  25%|██▌       | 5/20 [09:19<21:43, 86.87s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.992,  Train_accy 58.24, Test_accy 85.53:  30%|███       | 6/20 [09:19<22:09, 94.98s/it]
SNet: Task 8, Epoch 7/20 => Loss 2.021,  Train_accy 57.33:  30%|███       | 6/20 [10:44<22:09, 94.98s/it]                 
SNet: Task 8, Epoch 7/20 => Loss 2.021,  Train_accy 57.33:  35%|███▌      | 7/20 [10:44<19:50, 91.61s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.976,  Train_accy 59.39:  35%|███▌      | 7/20 [12:09<19:50, 91.61s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.976,  Train_accy 59.39:  40%|████      | 8/20 [12:09<17:52, 89.41s/it]
SNet: Task 8, Epoch 9/20 => Loss 2.012,  Train_accy 58.95:  40%|████      | 8/20 [13:33<17:52, 89.41s/it]
SNet: Task 8, Epoch 9/20 => Loss 2.012,  Train_accy 58.95:  45%|████▌     | 9/20 [13:33<16:07, 87.94s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.987,  Train_accy 59.30:  45%|████▌     | 9/20 [14:58<16:07, 87.94s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.987,  Train_accy 59.30:  50%|█████     | 10/20 [14:58<14:29, 86.94s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.997,  Train_accy 58.97, Test_accy 85.57:  50%|█████     | 10/20 [16:49<14:29, 86.94s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.997,  Train_accy 58.97, Test_accy 85.57:  55%|█████▌    | 11/20 [16:49<14:07, 94.18s/it]
SNet: Task 8, Epoch 12/20 => Loss 2.010,  Train_accy 58.73:  55%|█████▌    | 11/20 [18:13<14:07, 94.18s/it]                 
SNet: Task 8, Epoch 12/20 => Loss 2.010,  Train_accy 58.73:  60%|██████    | 12/20 [18:13<12:10, 91.30s/it]
SNet: Task 8, Epoch 13/20 => Loss 2.019,  Train_accy 58.58:  60%|██████    | 12/20 [19:38<12:10, 91.30s/it]
SNet: Task 8, Epoch 13/20 => Loss 2.019,  Train_accy 58.58:  65%|██████▌   | 13/20 [19:38<10:25, 89.29s/it]
SNet: Task 8, Epoch 14/20 => Loss 2.017,  Train_accy 58.89:  65%|██████▌   | 13/20 [21:03<10:25, 89.29s/it]
SNet: Task 8, Epoch 14/20 => Loss 2.017,  Train_accy 58.89:  70%|███████   | 14/20 [21:03<08:47, 87.91s/it]
SNet: Task 8, Epoch 15/20 => Loss 2.001,  Train_accy 58.89:  70%|███████   | 14/20 [22:27<08:47, 87.91s/it]
SNet: Task 8, Epoch 15/20 => Loss 2.001,  Train_accy 58.89:  75%|███████▌  | 15/20 [22:27<07:14, 86.93s/it]
SNet: Task 8, Epoch 16/20 => Loss 2.017,  Train_accy 58.91, Test_accy 85.53:  75%|███████▌  | 15/20 [24:18<07:14, 86.93s/it]
SNet: Task 8, Epoch 16/20 => Loss 2.017,  Train_accy 58.91, Test_accy 85.53:  80%|████████  | 16/20 [24:18<06:16, 94.06s/it]
SNet: Task 8, Epoch 17/20 => Loss 1.997,  Train_accy 59.06:  80%|████████  | 16/20 [25:43<06:16, 94.06s/it]                 
SNet: Task 8, Epoch 17/20 => Loss 1.997,  Train_accy 59.06:  85%|████████▌ | 17/20 [25:43<04:33, 91.24s/it]
SNet: Task 8, Epoch 18/20 => Loss 2.001,  Train_accy 59.14:  85%|████████▌ | 17/20 [27:07<04:33, 91.24s/it]
SNet: Task 8, Epoch 18/20 => Loss 2.001,  Train_accy 59.14:  90%|█████████ | 18/20 [27:07<02:58, 89.30s/it]
SNet: Task 8, Epoch 19/20 => Loss 2.009,  Train_accy 59.58:  90%|█████████ | 18/20 [28:32<02:58, 89.30s/it]
SNet: Task 8, Epoch 19/20 => Loss 2.009,  Train_accy 59.58:  95%|█████████▌| 19/20 [28:32<01:27, 87.95s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.981,  Train_accy 59.88:  95%|█████████▌| 19/20 [29:57<01:27, 87.95s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.981,  Train_accy 59.88: 100%|██████████| 20/20 [29:57<00:00, 86.98s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.981,  Train_accy 59.88: 100%|██████████| 20/20 [29:57<00:00, 89.87s/it]
2024-09-05 00:03:36,727 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.981,  Train_accy 59.88
2024-09-05 00:03:36,728 [foster.py] => do not weight align student!
2024-09-05 00:04:02,700 [foster.py] => darknet eval: 
2024-09-05 00:04:02,700 [foster.py] => CNN top1 curve: 85.62
2024-09-05 00:04:02,700 [foster.py] => CNN top5 curve: 99.11
2024-09-05 00:04:02,702 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 00:06:45,728 [foster.py] => Exemplar size: 1800
2024-09-05 00:06:45,728 [trainer.py] => CNN: {'total': 86.89, '00-09': 94.0, '10-19': 93.4, '20-29': 94.5, '30-39': 90.5, '40-49': 88.8, '50-59': 85.5, '60-69': 86.6, '70-79': 76.3, '80-89': 72.4, 'old': 88.7, 'new': 72.4}
2024-09-05 00:06:45,728 [trainer.py] => NME: {'total': 89.22, '00-09': 92.4, '10-19': 90.1, '20-29': 93.5, '30-39': 89.1, '40-49': 87.0, '50-59': 84.0, '60-69': 89.2, '70-79': 82.9, '80-89': 94.8, 'old': 88.52, 'new': 94.8}
2024-09-05 00:06:45,728 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3, 92.08, 90.88, 90.52, 89.77, 87.75, 86.89]
2024-09-05 00:06:45,728 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73, 99.68, 99.32, 99.33, 99.29, 99.15, 99.09]
2024-09-05 00:06:45,729 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73, 94.68, 92.4, 92.03, 91.51, 88.89, 89.22]
2024-09-05 00:06:45,729 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67, 99.6, 99.48, 99.45, 99.3, 99.21, 98.84]

Average Accuracy (CNN): 92.0
Average Accuracy (NME): 93.37
2024-09-05 00:06:45,729 [trainer.py] => Average Accuracy (CNN): 92.0
2024-09-05 00:06:45,729 [trainer.py] => Average Accuracy (NME): 93.37
2024-09-05 00:06:45,730 [trainer.py] => All params: 171866372
2024-09-05 00:06:45,731 [trainer.py] => Trainable params: 86006196
2024-09-05 00:06:47,279 [foster.py] => Learning on 90-100
2024-09-05 00:06:47,281 [foster.py] => All params: 171897122
2024-09-05 00:06:47,282 [foster.py] => Trainable params: 86029256
2024-09-05 00:06:47,392 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 5.439, Loss_clf 0.910, Loss_fe 1.996, Loss_kd 2.280, Train_accy 61.13, Test_accy 86.40:   0%|          | 0/20 [02:04<?, ?it/s]
Task 9, Epoch 1/20 => Loss 5.439, Loss_clf 0.910, Loss_fe 1.996, Loss_kd 2.280, Train_accy 61.13, Test_accy 86.40:   5%|▌         | 1/20 [02:04<39:25, 124.51s/it]
Task 9, Epoch 2/20 => Loss 4.197, Loss_clf 0.573, Loss_fe 1.067, Loss_kd 2.302, Train_accy 65.79:   5%|▌         | 1/20 [03:13<39:25, 124.51s/it]                 
Task 9, Epoch 2/20 => Loss 4.197, Loss_clf 0.573, Loss_fe 1.067, Loss_kd 2.302, Train_accy 65.79:  10%|█         | 2/20 [03:13<27:36, 92.01s/it] 
Task 9, Epoch 3/20 => Loss 3.766, Loss_clf 0.494, Loss_fe 0.742, Loss_kd 2.277, Train_accy 66.69:  10%|█         | 2/20 [04:23<27:36, 92.01s/it]
Task 9, Epoch 3/20 => Loss 3.766, Loss_clf 0.494, Loss_fe 0.742, Loss_kd 2.277, Train_accy 66.69:  15%|█▌        | 3/20 [04:23<23:07, 81.63s/it]
Task 9, Epoch 4/20 => Loss 3.670, Loss_clf 0.478, Loss_fe 0.647, Loss_kd 2.291, Train_accy 68.49:  15%|█▌        | 3/20 [05:32<23:07, 81.63s/it]
Task 9, Epoch 4/20 => Loss 3.670, Loss_clf 0.478, Loss_fe 0.647, Loss_kd 2.291, Train_accy 68.49:  20%|██        | 4/20 [05:32<20:27, 76.75s/it]
Task 9, Epoch 5/20 => Loss 3.563, Loss_clf 0.442, Loss_fe 0.583, Loss_kd 2.284, Train_accy 69.16:  20%|██        | 4/20 [06:41<20:27, 76.75s/it]
Task 9, Epoch 5/20 => Loss 3.563, Loss_clf 0.442, Loss_fe 0.583, Loss_kd 2.284, Train_accy 69.16:  25%|██▌       | 5/20 [06:41<18:30, 74.06s/it]
Task 9, Epoch 6/20 => Loss 3.536, Loss_clf 0.427, Loss_fe 0.544, Loss_kd 2.308, Train_accy 71.03, Test_accy 87.40:  25%|██▌       | 5/20 [08:46<18:30, 74.06s/it]
Task 9, Epoch 6/20 => Loss 3.536, Loss_clf 0.427, Loss_fe 0.544, Loss_kd 2.308, Train_accy 71.03, Test_accy 87.40:  30%|███       | 6/20 [08:46<21:19, 91.37s/it]
Task 9, Epoch 7/20 => Loss 3.445, Loss_clf 0.405, Loss_fe 0.484, Loss_kd 2.300, Train_accy 71.49:  30%|███       | 6/20 [09:55<21:19, 91.37s/it]                 
Task 9, Epoch 7/20 => Loss 3.445, Loss_clf 0.405, Loss_fe 0.484, Loss_kd 2.300, Train_accy 71.49:  35%|███▌      | 7/20 [09:55<18:14, 84.17s/it]
Task 9, Epoch 8/20 => Loss 3.361, Loss_clf 0.373, Loss_fe 0.450, Loss_kd 2.284, Train_accy 73.37:  35%|███▌      | 7/20 [11:05<18:14, 84.17s/it]
Task 9, Epoch 8/20 => Loss 3.361, Loss_clf 0.373, Loss_fe 0.450, Loss_kd 2.284, Train_accy 73.37:  40%|████      | 8/20 [11:05<15:53, 79.44s/it]
Task 9, Epoch 9/20 => Loss 3.303, Loss_clf 0.366, Loss_fe 0.411, Loss_kd 2.273, Train_accy 74.44:  40%|████      | 8/20 [12:14<15:53, 79.44s/it]
Task 9, Epoch 9/20 => Loss 3.303, Loss_clf 0.366, Loss_fe 0.411, Loss_kd 2.273, Train_accy 74.44:  45%|████▌     | 9/20 [12:14<13:59, 76.28s/it]
Task 9, Epoch 10/20 => Loss 3.279, Loss_clf 0.343, Loss_fe 0.379, Loss_kd 2.301, Train_accy 75.41:  45%|████▌     | 9/20 [13:23<13:59, 76.28s/it]
Task 9, Epoch 10/20 => Loss 3.279, Loss_clf 0.343, Loss_fe 0.379, Loss_kd 2.301, Train_accy 75.41:  50%|█████     | 10/20 [13:23<12:21, 74.15s/it]
Task 9, Epoch 11/20 => Loss 3.222, Loss_clf 0.337, Loss_fe 0.352, Loss_kd 2.280, Train_accy 76.06, Test_accy 87.73:  50%|█████     | 10/20 [15:28<12:21, 74.15s/it]
Task 9, Epoch 11/20 => Loss 3.222, Loss_clf 0.337, Loss_fe 0.352, Loss_kd 2.280, Train_accy 76.06, Test_accy 87.73:  55%|█████▌    | 11/20 [15:28<13:26, 89.65s/it]
Task 9, Epoch 12/20 => Loss 3.199, Loss_clf 0.324, Loss_fe 0.337, Loss_kd 2.284, Train_accy 76.06:  55%|█████▌    | 11/20 [16:38<13:26, 89.65s/it]                 
Task 9, Epoch 12/20 => Loss 3.199, Loss_clf 0.324, Loss_fe 0.337, Loss_kd 2.284, Train_accy 76.06:  60%|██████    | 12/20 [16:38<11:07, 83.47s/it]
Task 9, Epoch 13/20 => Loss 3.186, Loss_clf 0.328, Loss_fe 0.329, Loss_kd 2.277, Train_accy 76.37:  60%|██████    | 12/20 [17:47<11:07, 83.47s/it]
Task 9, Epoch 13/20 => Loss 3.186, Loss_clf 0.328, Loss_fe 0.329, Loss_kd 2.277, Train_accy 76.37:  65%|██████▌   | 13/20 [17:47<09:14, 79.19s/it]
Task 9, Epoch 14/20 => Loss 3.154, Loss_clf 0.300, Loss_fe 0.303, Loss_kd 2.296, Train_accy 78.93:  65%|██████▌   | 13/20 [18:56<09:14, 79.19s/it]
Task 9, Epoch 14/20 => Loss 3.154, Loss_clf 0.300, Loss_fe 0.303, Loss_kd 2.296, Train_accy 78.93:  70%|███████   | 14/20 [18:56<07:37, 76.21s/it]
Task 9, Epoch 15/20 => Loss 3.102, Loss_clf 0.294, Loss_fe 0.275, Loss_kd 2.279, Train_accy 78.56:  70%|███████   | 14/20 [20:06<07:37, 76.21s/it]
Task 9, Epoch 15/20 => Loss 3.102, Loss_clf 0.294, Loss_fe 0.275, Loss_kd 2.279, Train_accy 78.56:  75%|███████▌  | 15/20 [20:06<06:10, 74.12s/it]
Task 9, Epoch 16/20 => Loss 3.103, Loss_clf 0.291, Loss_fe 0.280, Loss_kd 2.278, Train_accy 78.76, Test_accy 87.53:  75%|███████▌  | 15/20 [22:10<06:10, 74.12s/it]
Task 9, Epoch 16/20 => Loss 3.103, Loss_clf 0.291, Loss_fe 0.280, Loss_kd 2.278, Train_accy 78.76, Test_accy 87.53:  80%|████████  | 16/20 [22:10<05:57, 89.34s/it]
Task 9, Epoch 17/20 => Loss 3.009, Loss_clf 0.253, Loss_fe 0.230, Loss_kd 2.273, Train_accy 79.07:  80%|████████  | 16/20 [23:19<05:57, 89.34s/it]                 
Task 9, Epoch 17/20 => Loss 3.009, Loss_clf 0.253, Loss_fe 0.230, Loss_kd 2.273, Train_accy 79.07:  85%|████████▌ | 17/20 [23:19<04:09, 83.30s/it]
Task 9, Epoch 18/20 => Loss 3.114, Loss_clf 0.285, Loss_fe 0.268, Loss_kd 2.304, Train_accy 78.79:  85%|████████▌ | 17/20 [24:29<04:09, 83.30s/it]
Task 9, Epoch 18/20 => Loss 3.114, Loss_clf 0.285, Loss_fe 0.268, Loss_kd 2.304, Train_accy 78.79:  90%|█████████ | 18/20 [24:29<02:38, 79.08s/it]
Task 9, Epoch 19/20 => Loss 3.010, Loss_clf 0.253, Loss_fe 0.231, Loss_kd 2.274, Train_accy 80.09:  90%|█████████ | 18/20 [25:38<02:38, 79.08s/it]
Task 9, Epoch 19/20 => Loss 3.010, Loss_clf 0.253, Loss_fe 0.231, Loss_kd 2.274, Train_accy 80.09:  95%|█████████▌| 19/20 [25:38<01:16, 76.12s/it]
Task 9, Epoch 20/20 => Loss 3.055, Loss_clf 0.275, Loss_fe 0.245, Loss_kd 2.281, Train_accy 79.43:  95%|█████████▌| 19/20 [26:47<01:16, 76.12s/it]
Task 9, Epoch 20/20 => Loss 3.055, Loss_clf 0.275, Loss_fe 0.245, Loss_kd 2.281, Train_accy 79.43: 100%|██████████| 20/20 [26:47<00:00, 74.05s/it]
Task 9, Epoch 20/20 => Loss 3.055, Loss_clf 0.275, Loss_fe 0.245, Loss_kd 2.281, Train_accy 79.43: 100%|██████████| 20/20 [26:47<00:00, 80.38s/it]
2024-09-05 00:33:35,040 [foster.py] => Task 9, Epoch 20/20 => Loss 3.055, Loss_clf 0.275, Loss_fe 0.245, Loss_kd 2.281, Train_accy 79.43
2024-09-05 00:33:35,042 [foster.py] => do not weight align teacher!
2024-09-05 00:33:35,046 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 2.354,  Train_accy 56.41, Test_accy 86.71:   0%|          | 0/20 [01:55<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 2.354,  Train_accy 56.41, Test_accy 86.71:   5%|▌         | 1/20 [01:55<36:41, 115.89s/it]
SNet: Task 9, Epoch 2/20 => Loss 2.187,  Train_accy 63.09:   5%|▌         | 1/20 [03:23<36:41, 115.89s/it]                 
SNet: Task 9, Epoch 2/20 => Loss 2.187,  Train_accy 63.09:  10%|█         | 2/20 [03:23<29:42, 99.03s/it] 
SNet: Task 9, Epoch 3/20 => Loss 2.188,  Train_accy 63.71:  10%|█         | 2/20 [04:50<29:42, 99.03s/it]
SNet: Task 9, Epoch 3/20 => Loss 2.188,  Train_accy 63.71:  15%|█▌        | 3/20 [04:50<26:32, 93.68s/it]
SNet: Task 9, Epoch 4/20 => Loss 2.171,  Train_accy 64.46:  15%|█▌        | 3/20 [06:17<26:32, 93.68s/it]
SNet: Task 9, Epoch 4/20 => Loss 2.171,  Train_accy 64.46:  20%|██        | 4/20 [06:17<24:18, 91.16s/it]
SNet: Task 9, Epoch 5/20 => Loss 2.168,  Train_accy 64.65:  20%|██        | 4/20 [07:44<24:18, 91.16s/it]
SNet: Task 9, Epoch 5/20 => Loss 2.168,  Train_accy 64.65:  25%|██▌       | 5/20 [07:44<22:26, 89.75s/it]
SNet: Task 9, Epoch 6/20 => Loss 2.155,  Train_accy 64.41, Test_accy 86.82:  25%|██▌       | 5/20 [09:41<22:26, 89.75s/it]
SNet: Task 9, Epoch 6/20 => Loss 2.155,  Train_accy 64.41, Test_accy 86.82:  30%|███       | 6/20 [09:41<23:01, 98.70s/it]
SNet: Task 9, Epoch 7/20 => Loss 2.170,  Train_accy 64.47:  30%|███       | 6/20 [11:08<23:01, 98.70s/it]                 
SNet: Task 9, Epoch 7/20 => Loss 2.170,  Train_accy 64.47:  35%|███▌      | 7/20 [11:08<20:34, 94.97s/it]
SNet: Task 9, Epoch 8/20 => Loss 2.162,  Train_accy 65.76:  35%|███▌      | 7/20 [12:35<20:34, 94.97s/it]
SNet: Task 9, Epoch 8/20 => Loss 2.162,  Train_accy 65.76:  40%|████      | 8/20 [12:35<18:30, 92.52s/it]
SNet: Task 9, Epoch 9/20 => Loss 2.168,  Train_accy 65.09:  40%|████      | 8/20 [14:02<18:30, 92.52s/it]
SNet: Task 9, Epoch 9/20 => Loss 2.168,  Train_accy 65.09:  45%|████▌     | 9/20 [14:02<16:39, 90.87s/it]
SNet: Task 9, Epoch 10/20 => Loss 2.163,  Train_accy 65.37:  45%|████▌     | 9/20 [15:30<16:39, 90.87s/it]
SNet: Task 9, Epoch 10/20 => Loss 2.163,  Train_accy 65.37:  50%|█████     | 10/20 [15:30<14:57, 89.75s/it]
SNet: Task 9, Epoch 11/20 => Loss 2.152,  Train_accy 66.65, Test_accy 86.67:  50%|█████     | 10/20 [17:26<14:57, 89.75s/it]
SNet: Task 9, Epoch 11/20 => Loss 2.152,  Train_accy 66.65, Test_accy 86.67:  55%|█████▌    | 11/20 [17:26<14:40, 97.85s/it]
SNet: Task 9, Epoch 12/20 => Loss 2.141,  Train_accy 65.13:  55%|█████▌    | 11/20 [18:53<14:40, 97.85s/it]                 
SNet: Task 9, Epoch 12/20 => Loss 2.141,  Train_accy 65.13:  60%|██████    | 12/20 [18:53<12:37, 94.65s/it]
SNet: Task 9, Epoch 13/20 => Loss 2.170,  Train_accy 64.72:  60%|██████    | 12/20 [20:21<12:37, 94.65s/it]
SNet: Task 9, Epoch 13/20 => Loss 2.170,  Train_accy 64.72:  65%|██████▌   | 13/20 [20:21<10:47, 92.44s/it]
SNet: Task 9, Epoch 14/20 => Loss 2.160,  Train_accy 64.53:  65%|██████▌   | 13/20 [21:48<10:47, 92.44s/it]
SNet: Task 9, Epoch 14/20 => Loss 2.160,  Train_accy 64.53:  70%|███████   | 14/20 [21:48<09:05, 90.91s/it]
SNet: Task 9, Epoch 15/20 => Loss 2.156,  Train_accy 65.01:  70%|███████   | 14/20 [23:15<09:05, 90.91s/it]
SNet: Task 9, Epoch 15/20 => Loss 2.156,  Train_accy 65.01:  75%|███████▌  | 15/20 [23:15<07:29, 89.81s/it]
SNet: Task 9, Epoch 16/20 => Loss 2.166,  Train_accy 65.50, Test_accy 86.65:  75%|███████▌  | 15/20 [25:11<07:29, 89.81s/it]
SNet: Task 9, Epoch 16/20 => Loss 2.166,  Train_accy 65.50, Test_accy 86.65:  80%|████████  | 16/20 [25:11<06:31, 97.76s/it]
SNet: Task 9, Epoch 17/20 => Loss 2.152,  Train_accy 65.71:  80%|████████  | 16/20 [26:39<06:31, 97.76s/it]                 
SNet: Task 9, Epoch 17/20 => Loss 2.152,  Train_accy 65.71:  85%|████████▌ | 17/20 [26:39<04:43, 94.63s/it]
SNet: Task 9, Epoch 18/20 => Loss 2.183,  Train_accy 64.84:  85%|████████▌ | 17/20 [28:06<04:43, 94.63s/it]
SNet: Task 9, Epoch 18/20 => Loss 2.183,  Train_accy 64.84:  90%|█████████ | 18/20 [28:06<03:04, 92.39s/it]
SNet: Task 9, Epoch 19/20 => Loss 2.167,  Train_accy 65.72:  90%|█████████ | 18/20 [29:33<03:04, 92.39s/it]
SNet: Task 9, Epoch 19/20 => Loss 2.167,  Train_accy 65.72:  95%|█████████▌| 19/20 [29:33<01:30, 90.83s/it]
SNet: Task 9, Epoch 20/20 => Loss 2.151,  Train_accy 65.59:  95%|█████████▌| 19/20 [31:00<01:30, 90.83s/it]
SNet: Task 9, Epoch 20/20 => Loss 2.151,  Train_accy 65.59: 100%|██████████| 20/20 [31:00<00:00, 89.75s/it]
SNet: Task 9, Epoch 20/20 => Loss 2.151,  Train_accy 65.59: 100%|██████████| 20/20 [31:00<00:00, 93.04s/it]
2024-09-05 01:04:37,401 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 2.151,  Train_accy 65.59
2024-09-05 01:04:37,401 [foster.py] => do not weight align student!
2024-09-05 01:05:06,137 [foster.py] => darknet eval: 
2024-09-05 01:05:06,137 [foster.py] => CNN top1 curve: 86.66
2024-09-05 01:05:06,137 [foster.py] => CNN top5 curve: 98.87
2024-09-05 01:05:06,139 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 01:08:04,623 [foster.py] => Exemplar size: 2000
2024-09-05 01:08:04,624 [trainer.py] => CNN: {'total': 87.52, '00-09': 93.3, '10-19': 93.3, '20-29': 94.5, '30-39': 90.5, '40-49': 87.6, '50-59': 85.1, '60-69': 88.0, '70-79': 80.7, '80-89': 80.5, '90-99': 81.7, 'old': 88.17, 'new': 81.7}
2024-09-05 01:08:04,624 [trainer.py] => NME: {'total': 88.64, '00-09': 91.1, '10-19': 89.4, '20-29': 93.4, '30-39': 89.0, '40-49': 86.1, '50-59': 80.8, '60-69': 90.7, '70-79': 83.1, '80-89': 89.5, '90-99': 93.3, 'old': 88.12, 'new': 93.3}
2024-09-05 01:08:04,624 [trainer.py] => CNN top1 curve: [99.2, 96.65, 94.3, 92.08, 90.88, 90.52, 89.77, 87.75, 86.89, 87.52]
2024-09-05 01:08:04,624 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.73, 99.68, 99.32, 99.33, 99.29, 99.15, 99.09, 98.89]
2024-09-05 01:08:04,624 [trainer.py] => NME top1 curve: [99.2, 96.65, 95.73, 94.68, 92.4, 92.03, 91.51, 88.89, 89.22, 88.64]
2024-09-05 01:08:04,624 [trainer.py] => NME top5 curve: [100.0, 99.65, 99.67, 99.6, 99.48, 99.45, 99.3, 99.21, 98.84, 98.69]

Average Accuracy (CNN): 91.56
Average Accuracy (NME): 92.9
2024-09-05 01:08:04,624 [trainer.py] => Average Accuracy (CNN): 91.56
2024-09-05 01:08:04,624 [trainer.py] => Average Accuracy (NME): 92.9
Accuracy Matrix (CNN):
[[99.2 97.3 97.7 96.9 95.8 95.3 94.6 93.5 94.  93.3]
 [ 0.  96.  95.4 94.8 95.3 94.9 94.5 93.9 93.4 93.3]
 [ 0.   0.  89.8 91.9 93.5 94.6 94.5 94.4 94.5 94.5]
 [ 0.   0.   0.  84.7 86.8 89.7 91.1 91.9 90.5 90.5]
 [ 0.   0.   0.   0.  83.  84.4 87.3 88.6 88.8 87.6]
 [ 0.   0.   0.   0.   0.  84.2 84.3 85.7 85.5 85.1]
 [ 0.   0.   0.   0.   0.   0.  82.1 81.5 86.6 88. ]
 [ 0.   0.   0.   0.   0.   0.   0.  72.5 76.3 80.7]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  72.4 80.5]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  81.7]]
2024-09-05 01:08:04,625 [trainer.py] => Forgetting (CNN): 1.3222222222222244
Accuracy Matrix (NME):
[[99.2 97.6 96.  94.1 94.6 93.8 93.1 92.4 92.4 91.1]
 [ 0.  95.7 93.4 93.2 89.1 91.9 90.8 89.6 90.1 89.4]
 [ 0.   0.  97.8 95.1 94.1 93.6 94.2 93.9 93.5 93.4]
 [ 0.   0.   0.  96.3 88.5 90.1 89.8 89.4 89.1 89. ]
 [ 0.   0.   0.   0.  95.7 88.5 90.8 88.1 87.  86.1]
 [ 0.   0.   0.   0.   0.  94.3 85.8 78.3 84.  80.8]
 [ 0.   0.   0.   0.   0.   0.  96.1 87.8 89.2 90.7]
 [ 0.   0.   0.   0.   0.   0.   0.  91.6 82.9 83.1]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  94.8 89.5]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  93.3]]
2024-09-05 01:08:04,625 [trainer.py] => Forgetting (NME): 7.599999999999999
2024-09-05 01:08:07,483 [trainer.py] => config: ./exps/foster_cifar_B0_Inc20.json
2024-09-05 01:08:07,484 [trainer.py] => prefix: cil
2024-09-05 01:08:07,484 [trainer.py] => dataset: cifar224
2024-09-05 01:08:07,484 [trainer.py] => memory_size: 2000
2024-09-05 01:08:07,484 [trainer.py] => memory_per_class: 20
2024-09-05 01:08:07,484 [trainer.py] => fixed_memory: True
2024-09-05 01:08:07,484 [trainer.py] => shuffle: True
2024-09-05 01:08:07,484 [trainer.py] => init_cls: 5
2024-09-05 01:08:07,484 [trainer.py] => increment: 5
2024-09-05 01:08:07,484 [trainer.py] => model_name: foster
2024-09-05 01:08:07,484 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 01:08:07,484 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-05 01:08:07,484 [trainer.py] => seed: 1993
2024-09-05 01:08:07,484 [trainer.py] => beta1: 0.96
2024-09-05 01:08:07,484 [trainer.py] => beta2: 0.97
2024-09-05 01:08:07,484 [trainer.py] => oofc: ft
2024-09-05 01:08:07,484 [trainer.py] => is_teacher_wa: False
2024-09-05 01:08:07,484 [trainer.py] => is_student_wa: False
2024-09-05 01:08:07,484 [trainer.py] => lambda_okd: 1
2024-09-05 01:08:07,484 [trainer.py] => wa_value: 1
2024-09-05 01:08:07,484 [trainer.py] => init_epochs: 20
2024-09-05 01:08:07,484 [trainer.py] => init_lr: 0.001
2024-09-05 01:08:07,484 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 01:08:07,484 [trainer.py] => boosting_epochs: 20
2024-09-05 01:08:07,484 [trainer.py] => compression_epochs: 20
2024-09-05 01:08:07,484 [trainer.py] => lr: 0.001
2024-09-05 01:08:07,484 [trainer.py] => batch_size: 48
2024-09-05 01:08:07,484 [trainer.py] => weight_decay: 0.0005
2024-09-05 01:08:07,484 [trainer.py] => num_workers: 8
2024-09-05 01:08:07,484 [trainer.py] => T: 2
2024-09-05 01:08:08,582 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-05 01:08:08,945 [trainer.py] => All params: 0
2024-09-05 01:08:08,945 [trainer.py] => Trainable params: 0
2024-09-05 01:08:10,525 [foster.py] => Learning on 0-5
2024-09-05 01:08:10,526 [foster.py] => All params: 85806346
2024-09-05 01:08:10,526 [foster.py] => Trainable params: 85806346

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.906, Train_accy 68.32, Test_accy 96.00:   0%|          | 0/20 [00:20<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.906, Train_accy 68.32, Test_accy 96.00:   5%|▌         | 1/20 [00:20<06:38, 20.96s/it]
Task 0, Epoch 2/20 => Loss 0.262, Train_accy 91.32:   5%|▌         | 1/20 [00:39<06:38, 20.96s/it]                 
Task 0, Epoch 2/20 => Loss 0.262, Train_accy 91.32:  10%|█         | 2/20 [00:39<05:54, 19.68s/it]
Task 0, Epoch 3/20 => Loss 0.272, Train_accy 90.36:  10%|█         | 2/20 [00:58<05:54, 19.68s/it]
Task 0, Epoch 3/20 => Loss 0.272, Train_accy 90.36:  15%|█▌        | 3/20 [00:58<05:28, 19.31s/it]
Task 0, Epoch 4/20 => Loss 0.184, Train_accy 93.76:  15%|█▌        | 3/20 [01:17<05:28, 19.31s/it]
Task 0, Epoch 4/20 => Loss 0.184, Train_accy 93.76:  20%|██        | 4/20 [01:17<05:06, 19.13s/it]
Task 0, Epoch 5/20 => Loss 0.199, Train_accy 92.80:  20%|██        | 4/20 [01:36<05:06, 19.13s/it]
Task 0, Epoch 5/20 => Loss 0.199, Train_accy 92.80:  25%|██▌       | 5/20 [01:36<04:45, 19.04s/it]
Task 0, Epoch 6/20 => Loss 0.137, Train_accy 95.32, Test_accy 99.20:  25%|██▌       | 5/20 [01:56<04:45, 19.04s/it]
Task 0, Epoch 6/20 => Loss 0.137, Train_accy 95.32, Test_accy 99.20:  30%|███       | 6/20 [01:56<04:33, 19.56s/it]
Task 0, Epoch 7/20 => Loss 0.133, Train_accy 95.44:  30%|███       | 6/20 [02:15<04:33, 19.56s/it]                 
Task 0, Epoch 7/20 => Loss 0.133, Train_accy 95.44:  35%|███▌      | 7/20 [02:15<04:11, 19.33s/it]
Task 0, Epoch 8/20 => Loss 0.136, Train_accy 95.92:  35%|███▌      | 7/20 [02:34<04:11, 19.33s/it]
Task 0, Epoch 8/20 => Loss 0.136, Train_accy 95.92:  40%|████      | 8/20 [02:34<03:50, 19.19s/it]
Task 0, Epoch 9/20 => Loss 0.177, Train_accy 93.64:  40%|████      | 8/20 [02:53<03:50, 19.19s/it]
Task 0, Epoch 9/20 => Loss 0.177, Train_accy 93.64:  45%|████▌     | 9/20 [02:53<03:30, 19.10s/it]
Task 0, Epoch 10/20 => Loss 0.150, Train_accy 95.12:  45%|████▌     | 9/20 [03:12<03:30, 19.10s/it]
Task 0, Epoch 10/20 => Loss 0.150, Train_accy 95.12:  50%|█████     | 10/20 [03:12<03:10, 19.05s/it]
Task 0, Epoch 11/20 => Loss 0.139, Train_accy 95.56, Test_accy 99.80:  50%|█████     | 10/20 [03:33<03:10, 19.05s/it]
Task 0, Epoch 11/20 => Loss 0.139, Train_accy 95.56, Test_accy 99.80:  55%|█████▌    | 11/20 [03:33<02:55, 19.51s/it]
Task 0, Epoch 12/20 => Loss 0.105, Train_accy 95.72:  55%|█████▌    | 11/20 [03:51<02:55, 19.51s/it]                 
Task 0, Epoch 12/20 => Loss 0.105, Train_accy 95.72:  60%|██████    | 12/20 [03:51<02:34, 19.34s/it]
Task 0, Epoch 13/20 => Loss 0.109, Train_accy 96.32:  60%|██████    | 12/20 [04:10<02:34, 19.34s/it]
Task 0, Epoch 13/20 => Loss 0.109, Train_accy 96.32:  65%|██████▌   | 13/20 [04:10<02:14, 19.21s/it]
Task 0, Epoch 14/20 => Loss 0.099, Train_accy 96.56:  65%|██████▌   | 13/20 [04:29<02:14, 19.21s/it]
Task 0, Epoch 14/20 => Loss 0.099, Train_accy 96.56:  70%|███████   | 14/20 [04:29<01:54, 19.12s/it]
Task 0, Epoch 15/20 => Loss 0.091, Train_accy 96.80:  70%|███████   | 14/20 [04:48<01:54, 19.12s/it]
Task 0, Epoch 15/20 => Loss 0.091, Train_accy 96.80:  75%|███████▌  | 15/20 [04:48<01:35, 19.05s/it]
Task 0, Epoch 16/20 => Loss 0.083, Train_accy 96.96, Test_accy 99.60:  75%|███████▌  | 15/20 [05:09<01:35, 19.05s/it]
Task 0, Epoch 16/20 => Loss 0.083, Train_accy 96.96, Test_accy 99.60:  80%|████████  | 16/20 [05:09<01:18, 19.50s/it]
Task 0, Epoch 17/20 => Loss 0.081, Train_accy 97.16:  80%|████████  | 16/20 [05:28<01:18, 19.50s/it]                 
Task 0, Epoch 17/20 => Loss 0.081, Train_accy 97.16:  85%|████████▌ | 17/20 [05:28<00:57, 19.32s/it]
Task 0, Epoch 18/20 => Loss 0.091, Train_accy 97.16:  85%|████████▌ | 17/20 [05:47<00:57, 19.32s/it]
Task 0, Epoch 18/20 => Loss 0.091, Train_accy 97.16:  90%|█████████ | 18/20 [05:47<00:38, 19.20s/it]
Task 0, Epoch 19/20 => Loss 0.066, Train_accy 97.84:  90%|█████████ | 18/20 [06:06<00:38, 19.20s/it]
Task 0, Epoch 19/20 => Loss 0.066, Train_accy 97.84:  95%|█████████▌| 19/20 [06:06<00:19, 19.13s/it]
Task 0, Epoch 20/20 => Loss 0.082, Train_accy 97.36:  95%|█████████▌| 19/20 [06:24<00:19, 19.13s/it]
Task 0, Epoch 20/20 => Loss 0.082, Train_accy 97.36: 100%|██████████| 20/20 [06:24<00:00, 19.07s/it]
Task 0, Epoch 20/20 => Loss 0.082, Train_accy 97.36: 100%|██████████| 20/20 [06:24<00:00, 19.25s/it]
2024-09-05 01:14:35,945 [foster.py] => Task 0, Epoch 20/20 => Loss 0.082, Train_accy 97.36
2024-09-05 01:14:35,946 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 01:14:48,845 [foster.py] => Exemplar size: 100
2024-09-05 01:14:48,845 [trainer.py] => CNN: {'total': 99.6, '00-04': 99.6, 'old': 0, 'new': 99.6}
2024-09-05 01:14:48,845 [trainer.py] => NME: {'total': 99.8, '00-04': 99.8, 'old': 0, 'new': 99.8}
2024-09-05 01:14:48,845 [trainer.py] => CNN top1 curve: [99.6]
2024-09-05 01:14:48,846 [trainer.py] => CNN top5 curve: [100.0]
2024-09-05 01:14:48,846 [trainer.py] => NME top1 curve: [99.8]
2024-09-05 01:14:48,846 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.6
Average Accuracy (NME): 99.8
2024-09-05 01:14:48,846 [trainer.py] => Average Accuracy (CNN): 99.6
2024-09-05 01:14:48,846 [trainer.py] => Average Accuracy (NME): 99.8
2024-09-05 01:14:48,847 [trainer.py] => All params: 85806346
2024-09-05 01:14:48,848 [trainer.py] => Trainable params: 85806346
2024-09-05 01:14:50,375 [foster.py] => Learning on 5-10
2024-09-05 01:14:50,376 [foster.py] => All params: 171624217
2024-09-05 01:14:50,377 [foster.py] => Trainable params: 85821716
2024-09-05 01:14:50,440 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.501, Loss_clf 0.622, Loss_fe 0.846, Loss_kd 0.517, Train_accy 77.54, Test_accy 96.50:   0%|          | 0/20 [00:32<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.501, Loss_clf 0.622, Loss_fe 0.846, Loss_kd 0.517, Train_accy 77.54, Test_accy 96.50:   5%|▌         | 1/20 [00:32<10:15, 32.37s/it]
Task 1, Epoch 2/20 => Loss 1.665, Loss_clf 0.280, Loss_fe 0.364, Loss_kd 0.510, Train_accy 87.35:   5%|▌         | 1/20 [00:58<10:15, 32.37s/it]                 
Task 1, Epoch 2/20 => Loss 1.665, Loss_clf 0.280, Loss_fe 0.364, Loss_kd 0.510, Train_accy 87.35:  10%|█         | 2/20 [00:58<08:41, 28.97s/it]
Task 1, Epoch 3/20 => Loss 1.546, Loss_clf 0.236, Loss_fe 0.285, Loss_kd 0.513, Train_accy 90.38:  10%|█         | 2/20 [01:25<08:41, 28.97s/it]
Task 1, Epoch 3/20 => Loss 1.546, Loss_clf 0.236, Loss_fe 0.285, Loss_kd 0.513, Train_accy 90.38:  15%|█▌        | 3/20 [01:25<07:54, 27.88s/it]
Task 1, Epoch 4/20 => Loss 1.528, Loss_clf 0.232, Loss_fe 0.283, Loss_kd 0.507, Train_accy 90.15:  15%|█▌        | 3/20 [01:52<07:54, 27.88s/it]
Task 1, Epoch 4/20 => Loss 1.528, Loss_clf 0.232, Loss_fe 0.283, Loss_kd 0.507, Train_accy 90.15:  20%|██        | 4/20 [01:52<07:18, 27.43s/it]
Task 1, Epoch 5/20 => Loss 1.458, Loss_clf 0.200, Loss_fe 0.244, Loss_kd 0.507, Train_accy 91.12:  20%|██        | 4/20 [02:18<07:18, 27.43s/it]
Task 1, Epoch 5/20 => Loss 1.458, Loss_clf 0.200, Loss_fe 0.244, Loss_kd 0.507, Train_accy 91.12:  25%|██▌       | 5/20 [02:18<06:47, 27.15s/it]
Task 1, Epoch 6/20 => Loss 1.480, Loss_clf 0.213, Loss_fe 0.245, Loss_kd 0.511, Train_accy 91.54, Test_accy 98.10:  25%|██▌       | 5/20 [02:51<06:47, 27.15s/it]
Task 1, Epoch 6/20 => Loss 1.480, Loss_clf 0.213, Loss_fe 0.245, Loss_kd 0.511, Train_accy 91.54, Test_accy 98.10:  30%|███       | 6/20 [02:51<06:45, 28.95s/it]
Task 1, Epoch 7/20 => Loss 1.420, Loss_clf 0.185, Loss_fe 0.219, Loss_kd 0.508, Train_accy 92.69:  30%|███       | 6/20 [03:18<06:45, 28.95s/it]                 
Task 1, Epoch 7/20 => Loss 1.420, Loss_clf 0.185, Loss_fe 0.219, Loss_kd 0.508, Train_accy 92.69:  35%|███▌      | 7/20 [03:18<06:06, 28.22s/it]
Task 1, Epoch 8/20 => Loss 1.466, Loss_clf 0.197, Loss_fe 0.237, Loss_kd 0.516, Train_accy 91.73:  35%|███▌      | 7/20 [03:44<06:06, 28.22s/it]
Task 1, Epoch 8/20 => Loss 1.466, Loss_clf 0.197, Loss_fe 0.237, Loss_kd 0.516, Train_accy 91.73:  40%|████      | 8/20 [03:44<05:32, 27.73s/it]
Task 1, Epoch 9/20 => Loss 1.402, Loss_clf 0.177, Loss_fe 0.203, Loss_kd 0.511, Train_accy 93.00:  40%|████      | 8/20 [04:11<05:32, 27.73s/it]
Task 1, Epoch 9/20 => Loss 1.402, Loss_clf 0.177, Loss_fe 0.203, Loss_kd 0.511, Train_accy 93.00:  45%|████▌     | 9/20 [04:11<05:01, 27.40s/it]
Task 1, Epoch 10/20 => Loss 1.447, Loss_clf 0.199, Loss_fe 0.226, Loss_kd 0.511, Train_accy 92.12:  45%|████▌     | 9/20 [04:38<05:01, 27.40s/it]
Task 1, Epoch 10/20 => Loss 1.447, Loss_clf 0.199, Loss_fe 0.226, Loss_kd 0.511, Train_accy 92.12:  50%|█████     | 10/20 [04:38<04:31, 27.17s/it]
Task 1, Epoch 11/20 => Loss 1.302, Loss_clf 0.142, Loss_fe 0.151, Loss_kd 0.504, Train_accy 94.00, Test_accy 98.50:  50%|█████     | 10/20 [05:10<04:31, 27.17s/it]
Task 1, Epoch 11/20 => Loss 1.302, Loss_clf 0.142, Loss_fe 0.151, Loss_kd 0.504, Train_accy 94.00, Test_accy 98.50:  55%|█████▌    | 11/20 [05:10<04:19, 28.79s/it]
Task 1, Epoch 12/20 => Loss 1.353, Loss_clf 0.152, Loss_fe 0.174, Loss_kd 0.514, Train_accy 94.15:  55%|█████▌    | 11/20 [05:37<04:19, 28.79s/it]                 
Task 1, Epoch 12/20 => Loss 1.353, Loss_clf 0.152, Loss_fe 0.174, Loss_kd 0.514, Train_accy 94.15:  60%|██████    | 12/20 [05:37<03:45, 28.14s/it]
Task 1, Epoch 13/20 => Loss 1.338, Loss_clf 0.156, Loss_fe 0.158, Loss_kd 0.512, Train_accy 93.50:  60%|██████    | 12/20 [06:03<03:45, 28.14s/it]
Task 1, Epoch 13/20 => Loss 1.338, Loss_clf 0.156, Loss_fe 0.158, Loss_kd 0.512, Train_accy 93.50:  65%|██████▌   | 13/20 [06:03<03:13, 27.70s/it]
Task 1, Epoch 14/20 => Loss 1.278, Loss_clf 0.126, Loss_fe 0.125, Loss_kd 0.514, Train_accy 94.96:  65%|██████▌   | 13/20 [06:30<03:13, 27.70s/it]
Task 1, Epoch 14/20 => Loss 1.278, Loss_clf 0.126, Loss_fe 0.125, Loss_kd 0.514, Train_accy 94.96:  70%|███████   | 14/20 [06:30<02:44, 27.39s/it]
Task 1, Epoch 15/20 => Loss 1.271, Loss_clf 0.122, Loss_fe 0.130, Loss_kd 0.509, Train_accy 95.23:  70%|███████   | 14/20 [06:57<02:44, 27.39s/it]
Task 1, Epoch 15/20 => Loss 1.271, Loss_clf 0.122, Loss_fe 0.130, Loss_kd 0.509, Train_accy 95.23:  75%|███████▌  | 15/20 [06:57<02:15, 27.18s/it]
Task 1, Epoch 16/20 => Loss 1.276, Loss_clf 0.128, Loss_fe 0.127, Loss_kd 0.510, Train_accy 95.38, Test_accy 98.70:  75%|███████▌  | 15/20 [07:29<02:15, 27.18s/it]
Task 1, Epoch 16/20 => Loss 1.276, Loss_clf 0.128, Loss_fe 0.127, Loss_kd 0.510, Train_accy 95.38, Test_accy 98.70:  80%|████████  | 16/20 [07:29<01:55, 28.79s/it]
Task 1, Epoch 17/20 => Loss 1.270, Loss_clf 0.123, Loss_fe 0.123, Loss_kd 0.512, Train_accy 94.88:  80%|████████  | 16/20 [07:56<01:55, 28.79s/it]                 
Task 1, Epoch 17/20 => Loss 1.270, Loss_clf 0.123, Loss_fe 0.123, Loss_kd 0.512, Train_accy 94.88:  85%|████████▌ | 17/20 [07:56<01:24, 28.16s/it]
Task 1, Epoch 18/20 => Loss 1.273, Loss_clf 0.123, Loss_fe 0.123, Loss_kd 0.513, Train_accy 95.42:  85%|████████▌ | 17/20 [08:23<01:24, 28.16s/it]
Task 1, Epoch 18/20 => Loss 1.273, Loss_clf 0.123, Loss_fe 0.123, Loss_kd 0.513, Train_accy 95.42:  90%|█████████ | 18/20 [08:23<00:55, 27.73s/it]
Task 1, Epoch 19/20 => Loss 1.222, Loss_clf 0.108, Loss_fe 0.097, Loss_kd 0.508, Train_accy 95.31:  90%|█████████ | 18/20 [08:49<00:55, 27.73s/it]
Task 1, Epoch 19/20 => Loss 1.222, Loss_clf 0.108, Loss_fe 0.097, Loss_kd 0.508, Train_accy 95.31:  95%|█████████▌| 19/20 [08:49<00:27, 27.40s/it]
Task 1, Epoch 20/20 => Loss 1.266, Loss_clf 0.125, Loss_fe 0.118, Loss_kd 0.512, Train_accy 94.88:  95%|█████████▌| 19/20 [09:16<00:27, 27.40s/it]
Task 1, Epoch 20/20 => Loss 1.266, Loss_clf 0.125, Loss_fe 0.118, Loss_kd 0.512, Train_accy 94.88: 100%|██████████| 20/20 [09:16<00:00, 27.19s/it]
Task 1, Epoch 20/20 => Loss 1.266, Loss_clf 0.125, Loss_fe 0.118, Loss_kd 0.512, Train_accy 94.88: 100%|██████████| 20/20 [09:16<00:00, 27.83s/it]
2024-09-05 01:24:06,992 [foster.py] => Task 1, Epoch 20/20 => Loss 1.266, Loss_clf 0.125, Loss_fe 0.118, Loss_kd 0.512, Train_accy 94.88
2024-09-05 01:24:06,993 [foster.py] => do not weight align teacher!
2024-09-05 01:24:06,995 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.122,  Train_accy 73.81, Test_accy 97.50:   0%|          | 0/20 [00:36<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.122,  Train_accy 73.81, Test_accy 97.50:   5%|▌         | 1/20 [00:36<11:36, 36.64s/it]
SNet: Task 1, Epoch 2/20 => Loss 0.800,  Train_accy 90.81:   5%|▌         | 1/20 [01:10<11:36, 36.64s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 0.800,  Train_accy 90.81:  10%|█         | 2/20 [01:10<10:26, 34.80s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.760,  Train_accy 91.31:  10%|█         | 2/20 [01:43<10:26, 34.80s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.760,  Train_accy 91.31:  15%|█▌        | 3/20 [01:43<09:41, 34.21s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.766,  Train_accy 91.46:  15%|█▌        | 3/20 [02:17<09:41, 34.21s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.766,  Train_accy 91.46:  20%|██        | 4/20 [02:17<09:03, 33.95s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.768,  Train_accy 92.08:  20%|██        | 4/20 [02:50<09:03, 33.95s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.768,  Train_accy 92.08:  25%|██▌       | 5/20 [02:50<08:27, 33.84s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.765,  Train_accy 92.27, Test_accy 98.50:  25%|██▌       | 5/20 [03:27<08:27, 33.84s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.765,  Train_accy 92.27, Test_accy 98.50:  30%|███       | 6/20 [03:27<08:07, 34.83s/it]
SNet: Task 1, Epoch 7/20 => Loss 0.765,  Train_accy 91.77:  30%|███       | 6/20 [04:01<08:07, 34.83s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 0.765,  Train_accy 91.77:  35%|███▌      | 7/20 [04:01<07:27, 34.39s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.758,  Train_accy 92.00:  35%|███▌      | 7/20 [04:34<07:27, 34.39s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.758,  Train_accy 92.00:  40%|████      | 8/20 [04:34<06:49, 34.12s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.770,  Train_accy 92.08:  40%|████      | 8/20 [05:08<06:49, 34.12s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.770,  Train_accy 92.08:  45%|████▌     | 9/20 [05:08<06:13, 33.94s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.744,  Train_accy 92.58:  45%|████▌     | 9/20 [05:41<06:13, 33.94s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.744,  Train_accy 92.58:  50%|█████     | 10/20 [05:41<05:38, 33.82s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.742,  Train_accy 93.12, Test_accy 97.90:  50%|█████     | 10/20 [06:18<05:38, 33.82s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.742,  Train_accy 93.12, Test_accy 97.90:  55%|█████▌    | 11/20 [06:18<05:12, 34.71s/it]
SNet: Task 1, Epoch 12/20 => Loss 0.756,  Train_accy 92.58:  55%|█████▌    | 11/20 [06:52<05:12, 34.71s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 0.756,  Train_accy 92.58:  60%|██████    | 12/20 [06:52<04:35, 34.38s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.738,  Train_accy 92.69:  60%|██████    | 12/20 [07:25<04:35, 34.38s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.738,  Train_accy 92.69:  65%|██████▌   | 13/20 [07:25<03:59, 34.14s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.745,  Train_accy 93.23:  65%|██████▌   | 13/20 [07:59<03:59, 34.14s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.745,  Train_accy 93.23:  70%|███████   | 14/20 [07:59<03:23, 33.98s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.765,  Train_accy 92.65:  70%|███████   | 14/20 [08:32<03:23, 33.98s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.765,  Train_accy 92.65:  75%|███████▌  | 15/20 [08:32<02:49, 33.86s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.758,  Train_accy 92.81, Test_accy 98.10:  75%|███████▌  | 15/20 [09:09<02:49, 33.86s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.758,  Train_accy 92.81, Test_accy 98.10:  80%|████████  | 16/20 [09:09<02:18, 34.72s/it]
SNet: Task 1, Epoch 17/20 => Loss 0.752,  Train_accy 92.08:  80%|████████  | 16/20 [09:43<02:18, 34.72s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 0.752,  Train_accy 92.08:  85%|████████▌ | 17/20 [09:43<01:43, 34.38s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.773,  Train_accy 92.12:  85%|████████▌ | 17/20 [10:16<01:43, 34.38s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.773,  Train_accy 92.12:  90%|█████████ | 18/20 [10:16<01:08, 34.13s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.765,  Train_accy 93.08:  90%|█████████ | 18/20 [10:50<01:08, 34.13s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.765,  Train_accy 93.08:  95%|█████████▌| 19/20 [10:50<00:33, 33.97s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.769,  Train_accy 92.42:  95%|█████████▌| 19/20 [11:23<00:33, 33.97s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.769,  Train_accy 92.42: 100%|██████████| 20/20 [11:23<00:00, 33.86s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.769,  Train_accy 92.42: 100%|██████████| 20/20 [11:23<00:00, 34.20s/it]
2024-09-05 01:35:32,448 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.769,  Train_accy 92.42
2024-09-05 01:35:32,448 [foster.py] => do not weight align student!
2024-09-05 01:35:35,650 [foster.py] => darknet eval: 
2024-09-05 01:35:35,650 [foster.py] => CNN top1 curve: 98.0
2024-09-05 01:35:35,650 [foster.py] => CNN top5 curve: 99.9
2024-09-05 01:35:35,652 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 01:36:05,968 [foster.py] => Exemplar size: 200
2024-09-05 01:36:05,969 [trainer.py] => CNN: {'total': 98.8, '00-04': 99.0, '05-09': 98.6, 'old': 99.0, 'new': 98.6}
2024-09-05 01:36:05,969 [trainer.py] => NME: {'total': 99.1, '00-04': 99.6, '05-09': 98.6, 'old': 99.6, 'new': 98.6}
2024-09-05 01:36:05,969 [trainer.py] => CNN top1 curve: [99.6, 98.8]
2024-09-05 01:36:05,969 [trainer.py] => CNN top5 curve: [100.0, 99.9]
2024-09-05 01:36:05,969 [trainer.py] => NME top1 curve: [99.8, 99.1]
2024-09-05 01:36:05,969 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 99.2
Average Accuracy (NME): 99.45
2024-09-05 01:36:05,969 [trainer.py] => Average Accuracy (CNN): 99.2
2024-09-05 01:36:05,969 [trainer.py] => Average Accuracy (NME): 99.45
2024-09-05 01:36:05,971 [trainer.py] => All params: 171624217
2024-09-05 01:36:05,972 [trainer.py] => Trainable params: 85821716
2024-09-05 01:36:07,648 [foster.py] => Learning on 10-15
2024-09-05 01:36:07,650 [foster.py] => All params: 171639592
2024-09-05 01:36:07,651 [foster.py] => Trainable params: 85833246
2024-09-05 01:36:07,733 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.319, Loss_clf 0.851, Loss_fe 0.986, Loss_kd 0.988, Train_accy 73.04, Test_accy 94.53:   0%|          | 0/20 [00:36<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.319, Loss_clf 0.851, Loss_fe 0.986, Loss_kd 0.988, Train_accy 73.04, Test_accy 94.53:   5%|▌         | 1/20 [00:36<11:31, 36.37s/it]
Task 2, Epoch 2/20 => Loss 2.280, Loss_clf 0.323, Loss_fe 0.504, Loss_kd 0.968, Train_accy 82.04:   5%|▌         | 1/20 [01:04<11:31, 36.37s/it]                 
Task 2, Epoch 2/20 => Loss 2.280, Loss_clf 0.323, Loss_fe 0.504, Loss_kd 0.968, Train_accy 82.04:  10%|█         | 2/20 [01:04<09:22, 31.27s/it]
Task 2, Epoch 3/20 => Loss 2.168, Loss_clf 0.305, Loss_fe 0.408, Loss_kd 0.970, Train_accy 83.96:  10%|█         | 2/20 [01:31<09:22, 31.27s/it]
Task 2, Epoch 3/20 => Loss 2.168, Loss_clf 0.305, Loss_fe 0.408, Loss_kd 0.970, Train_accy 83.96:  15%|█▌        | 3/20 [01:31<08:23, 29.62s/it]
Task 2, Epoch 4/20 => Loss 2.146, Loss_clf 0.289, Loss_fe 0.383, Loss_kd 0.983, Train_accy 82.37:  15%|█▌        | 3/20 [01:59<08:23, 29.62s/it]
Task 2, Epoch 4/20 => Loss 2.146, Loss_clf 0.289, Loss_fe 0.383, Loss_kd 0.983, Train_accy 82.37:  20%|██        | 4/20 [01:59<07:41, 28.86s/it]
Task 2, Epoch 5/20 => Loss 2.028, Loss_clf 0.247, Loss_fe 0.309, Loss_kd 0.981, Train_accy 87.04:  20%|██        | 4/20 [02:27<07:41, 28.86s/it]
Task 2, Epoch 5/20 => Loss 2.028, Loss_clf 0.247, Loss_fe 0.309, Loss_kd 0.981, Train_accy 87.04:  25%|██▌       | 5/20 [02:27<07:06, 28.45s/it]
Task 2, Epoch 6/20 => Loss 1.924, Loss_clf 0.216, Loss_fe 0.255, Loss_kd 0.968, Train_accy 87.70, Test_accy 96.20:  25%|██▌       | 5/20 [03:03<07:06, 28.45s/it]
Task 2, Epoch 6/20 => Loss 1.924, Loss_clf 0.216, Loss_fe 0.255, Loss_kd 0.968, Train_accy 87.70, Test_accy 96.20:  30%|███       | 6/20 [03:03<07:15, 31.12s/it]
Task 2, Epoch 7/20 => Loss 1.855, Loss_clf 0.183, Loss_fe 0.218, Loss_kd 0.969, Train_accy 89.07:  30%|███       | 6/20 [03:31<07:15, 31.12s/it]                 
Task 2, Epoch 7/20 => Loss 1.855, Loss_clf 0.183, Loss_fe 0.218, Loss_kd 0.969, Train_accy 89.07:  35%|███▌      | 7/20 [03:31<06:30, 30.02s/it]
Task 2, Epoch 8/20 => Loss 1.849, Loss_clf 0.182, Loss_fe 0.218, Loss_kd 0.966, Train_accy 89.41:  35%|███▌      | 7/20 [03:58<06:30, 30.02s/it]
Task 2, Epoch 8/20 => Loss 1.849, Loss_clf 0.182, Loss_fe 0.218, Loss_kd 0.966, Train_accy 89.41:  40%|████      | 8/20 [03:58<05:51, 29.28s/it]
Task 2, Epoch 9/20 => Loss 1.840, Loss_clf 0.191, Loss_fe 0.199, Loss_kd 0.966, Train_accy 88.59:  40%|████      | 8/20 [04:26<05:51, 29.28s/it]
Task 2, Epoch 9/20 => Loss 1.840, Loss_clf 0.191, Loss_fe 0.199, Loss_kd 0.966, Train_accy 88.59:  45%|████▌     | 9/20 [04:26<05:16, 28.78s/it]
Task 2, Epoch 10/20 => Loss 1.840, Loss_clf 0.178, Loss_fe 0.208, Loss_kd 0.969, Train_accy 90.78:  45%|████▌     | 9/20 [04:54<05:16, 28.78s/it]
Task 2, Epoch 10/20 => Loss 1.840, Loss_clf 0.178, Loss_fe 0.208, Loss_kd 0.969, Train_accy 90.78:  50%|█████     | 10/20 [04:54<04:44, 28.45s/it]
Task 2, Epoch 11/20 => Loss 1.808, Loss_clf 0.173, Loss_fe 0.185, Loss_kd 0.967, Train_accy 90.37, Test_accy 96.60:  50%|█████     | 10/20 [05:30<04:44, 28.45s/it]
Task 2, Epoch 11/20 => Loss 1.808, Loss_clf 0.173, Loss_fe 0.185, Loss_kd 0.967, Train_accy 90.37, Test_accy 96.60:  55%|█████▌    | 11/20 [05:30<04:37, 30.86s/it]
Task 2, Epoch 12/20 => Loss 1.818, Loss_clf 0.176, Loss_fe 0.181, Loss_kd 0.974, Train_accy 90.70:  55%|█████▌    | 11/20 [05:58<04:37, 30.86s/it]                 
Task 2, Epoch 12/20 => Loss 1.818, Loss_clf 0.176, Loss_fe 0.181, Loss_kd 0.974, Train_accy 90.70:  60%|██████    | 12/20 [05:58<03:59, 29.91s/it]
Task 2, Epoch 13/20 => Loss 1.822, Loss_clf 0.180, Loss_fe 0.185, Loss_kd 0.972, Train_accy 90.15:  60%|██████    | 12/20 [06:26<03:59, 29.91s/it]
Task 2, Epoch 13/20 => Loss 1.822, Loss_clf 0.180, Loss_fe 0.185, Loss_kd 0.972, Train_accy 90.15:  65%|██████▌   | 13/20 [06:26<03:24, 29.24s/it]
Task 2, Epoch 14/20 => Loss 1.731, Loss_clf 0.139, Loss_fe 0.137, Loss_kd 0.970, Train_accy 93.07:  65%|██████▌   | 13/20 [06:53<03:24, 29.24s/it]
Task 2, Epoch 14/20 => Loss 1.731, Loss_clf 0.139, Loss_fe 0.137, Loss_kd 0.970, Train_accy 93.07:  70%|███████   | 14/20 [06:53<02:52, 28.79s/it]
Task 2, Epoch 15/20 => Loss 1.754, Loss_clf 0.152, Loss_fe 0.143, Loss_kd 0.972, Train_accy 92.04:  70%|███████   | 14/20 [07:21<02:52, 28.79s/it]
Task 2, Epoch 15/20 => Loss 1.754, Loss_clf 0.152, Loss_fe 0.143, Loss_kd 0.972, Train_accy 92.04:  75%|███████▌  | 15/20 [07:21<02:22, 28.47s/it]
Task 2, Epoch 16/20 => Loss 1.738, Loss_clf 0.150, Loss_fe 0.141, Loss_kd 0.965, Train_accy 92.37, Test_accy 97.00:  75%|███████▌  | 15/20 [07:57<02:22, 28.47s/it]
Task 2, Epoch 16/20 => Loss 1.738, Loss_clf 0.150, Loss_fe 0.141, Loss_kd 0.965, Train_accy 92.37, Test_accy 97.00:  80%|████████  | 16/20 [07:57<02:03, 30.83s/it]
Task 2, Epoch 17/20 => Loss 1.753, Loss_clf 0.142, Loss_fe 0.141, Loss_kd 0.981, Train_accy 92.41:  80%|████████  | 16/20 [08:25<02:03, 30.83s/it]                 
Task 2, Epoch 17/20 => Loss 1.753, Loss_clf 0.142, Loss_fe 0.141, Loss_kd 0.981, Train_accy 92.41:  85%|████████▌ | 17/20 [08:25<01:29, 29.88s/it]
Task 2, Epoch 18/20 => Loss 1.733, Loss_clf 0.139, Loss_fe 0.131, Loss_kd 0.975, Train_accy 92.93:  85%|████████▌ | 17/20 [08:53<01:29, 29.88s/it]
Task 2, Epoch 18/20 => Loss 1.733, Loss_clf 0.139, Loss_fe 0.131, Loss_kd 0.975, Train_accy 92.93:  90%|█████████ | 18/20 [08:53<00:58, 29.23s/it]
Task 2, Epoch 19/20 => Loss 1.719, Loss_clf 0.138, Loss_fe 0.130, Loss_kd 0.967, Train_accy 93.48:  90%|█████████ | 18/20 [09:20<00:58, 29.23s/it]
Task 2, Epoch 19/20 => Loss 1.719, Loss_clf 0.138, Loss_fe 0.130, Loss_kd 0.967, Train_accy 93.48:  95%|█████████▌| 19/20 [09:20<00:28, 28.78s/it]
Task 2, Epoch 20/20 => Loss 1.754, Loss_clf 0.157, Loss_fe 0.139, Loss_kd 0.972, Train_accy 93.00:  95%|█████████▌| 19/20 [09:48<00:28, 28.78s/it]
Task 2, Epoch 20/20 => Loss 1.754, Loss_clf 0.157, Loss_fe 0.139, Loss_kd 0.972, Train_accy 93.00: 100%|██████████| 20/20 [09:48<00:00, 28.47s/it]
Task 2, Epoch 20/20 => Loss 1.754, Loss_clf 0.157, Loss_fe 0.139, Loss_kd 0.972, Train_accy 93.00: 100%|██████████| 20/20 [09:48<00:00, 29.43s/it]
2024-09-05 01:45:56,418 [foster.py] => Task 2, Epoch 20/20 => Loss 1.754, Loss_clf 0.157, Loss_fe 0.139, Loss_kd 0.972, Train_accy 93.00
2024-09-05 01:45:56,419 [foster.py] => do not weight align teacher!
2024-09-05 01:45:56,422 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.478,  Train_accy 67.37, Test_accy 95.93:   0%|          | 0/20 [00:39<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.478,  Train_accy 67.37, Test_accy 95.93:   5%|▌         | 1/20 [00:39<12:28, 39.40s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.134,  Train_accy 82.56:   5%|▌         | 1/20 [01:14<12:28, 39.40s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.134,  Train_accy 82.56:  10%|█         | 2/20 [01:14<11:00, 36.68s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.098,  Train_accy 83.67:  10%|█         | 2/20 [01:48<11:00, 36.68s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.098,  Train_accy 83.67:  15%|█▌        | 3/20 [01:48<10:09, 35.83s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.113,  Train_accy 83.81:  15%|█▌        | 3/20 [02:23<10:09, 35.83s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.113,  Train_accy 83.81:  20%|██        | 4/20 [02:23<09:26, 35.42s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.104,  Train_accy 84.56:  20%|██        | 4/20 [02:58<09:26, 35.42s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.104,  Train_accy 84.56:  25%|██▌       | 5/20 [02:58<08:47, 35.18s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.104,  Train_accy 83.85, Test_accy 96.67:  25%|██▌       | 5/20 [03:37<08:47, 35.18s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.104,  Train_accy 83.85, Test_accy 96.67:  30%|███       | 6/20 [03:37<08:32, 36.62s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.109,  Train_accy 84.59:  30%|███       | 6/20 [04:12<08:32, 36.62s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.109,  Train_accy 84.59:  35%|███▌      | 7/20 [04:12<07:48, 36.02s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.088,  Train_accy 85.11:  35%|███▌      | 7/20 [04:47<07:48, 36.02s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.088,  Train_accy 85.11:  40%|████      | 8/20 [04:47<07:07, 35.63s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.080,  Train_accy 85.41:  40%|████      | 8/20 [05:22<07:07, 35.63s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.080,  Train_accy 85.41:  45%|████▌     | 9/20 [05:22<06:29, 35.40s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.100,  Train_accy 83.81:  45%|████▌     | 9/20 [05:57<06:29, 35.40s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.100,  Train_accy 83.81:  50%|█████     | 10/20 [05:57<05:52, 35.22s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.093,  Train_accy 85.41, Test_accy 96.67:  50%|█████     | 10/20 [06:36<05:52, 35.22s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.093,  Train_accy 85.41, Test_accy 96.67:  55%|█████▌    | 11/20 [06:36<05:28, 36.52s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.088,  Train_accy 86.04:  55%|█████▌    | 11/20 [07:11<05:28, 36.52s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.088,  Train_accy 86.04:  60%|██████    | 12/20 [07:11<04:47, 35.99s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.080,  Train_accy 85.48:  60%|██████    | 12/20 [07:46<04:47, 35.99s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.080,  Train_accy 85.48:  65%|██████▌   | 13/20 [07:46<04:09, 35.63s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.093,  Train_accy 83.74:  65%|██████▌   | 13/20 [08:21<04:09, 35.63s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.093,  Train_accy 83.74:  70%|███████   | 14/20 [08:21<03:32, 35.39s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.080,  Train_accy 86.04:  70%|███████   | 14/20 [08:55<03:32, 35.39s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.080,  Train_accy 86.04:  75%|███████▌  | 15/20 [08:55<02:56, 35.21s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.108,  Train_accy 85.22, Test_accy 96.73:  75%|███████▌  | 15/20 [09:35<02:56, 35.21s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.108,  Train_accy 85.22, Test_accy 96.73:  80%|████████  | 16/20 [09:35<02:25, 36.49s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.087,  Train_accy 86.04:  80%|████████  | 16/20 [10:10<02:25, 36.49s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.087,  Train_accy 86.04:  85%|████████▌ | 17/20 [10:10<01:47, 35.98s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.075,  Train_accy 85.85:  85%|████████▌ | 17/20 [10:45<01:47, 35.98s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.075,  Train_accy 85.85:  90%|█████████ | 18/20 [10:45<01:11, 35.64s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.079,  Train_accy 85.70:  90%|█████████ | 18/20 [11:19<01:11, 35.64s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.079,  Train_accy 85.70:  95%|█████████▌| 19/20 [11:19<00:35, 35.38s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.091,  Train_accy 86.00:  95%|█████████▌| 19/20 [11:54<00:35, 35.38s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.091,  Train_accy 86.00: 100%|██████████| 20/20 [11:54<00:00, 35.23s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.091,  Train_accy 86.00: 100%|██████████| 20/20 [11:54<00:00, 35.73s/it]
2024-09-05 01:57:52,531 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.091,  Train_accy 86.00
2024-09-05 01:57:52,531 [foster.py] => do not weight align student!
2024-09-05 01:57:57,170 [foster.py] => darknet eval: 
2024-09-05 01:57:57,171 [foster.py] => CNN top1 curve: 96.73
2024-09-05 01:57:57,171 [foster.py] => CNN top5 curve: 99.8
2024-09-05 01:57:57,174 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 01:58:34,853 [foster.py] => Exemplar size: 300
2024-09-05 01:58:34,853 [trainer.py] => CNN: {'total': 97.07, '00-04': 98.6, '05-09': 96.2, '10-14': 96.4, 'old': 97.4, 'new': 96.4}
2024-09-05 01:58:34,853 [trainer.py] => NME: {'total': 97.07, '00-04': 99.0, '05-09': 96.0, '10-14': 96.2, 'old': 97.5, 'new': 96.2}
2024-09-05 01:58:34,854 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07]
2024-09-05 01:58:34,854 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8]
2024-09-05 01:58:34,854 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07]
2024-09-05 01:58:34,854 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0]

Average Accuracy (CNN): 98.49
Average Accuracy (NME): 98.66
2024-09-05 01:58:34,854 [trainer.py] => Average Accuracy (CNN): 98.49
2024-09-05 01:58:34,854 [trainer.py] => Average Accuracy (NME): 98.66
2024-09-05 01:58:34,855 [trainer.py] => All params: 171639592
2024-09-05 01:58:34,856 [trainer.py] => Trainable params: 85833246
2024-09-05 01:58:36,235 [foster.py] => Learning on 15-20
2024-09-05 01:58:36,237 [foster.py] => All params: 171654967
2024-09-05 01:58:36,238 [foster.py] => Trainable params: 85844776
2024-09-05 01:58:36,309 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.485, Loss_clf 0.761, Loss_fe 1.032, Loss_kd 1.269, Train_accy 71.43, Test_accy 91.85:   0%|          | 0/20 [00:39<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.485, Loss_clf 0.761, Loss_fe 1.032, Loss_kd 1.269, Train_accy 71.43, Test_accy 91.85:   5%|▌         | 1/20 [00:39<12:39, 39.96s/it]
Task 3, Epoch 2/20 => Loss 2.582, Loss_clf 0.334, Loss_fe 0.598, Loss_kd 1.238, Train_accy 77.07:   5%|▌         | 1/20 [01:08<12:39, 39.96s/it]                 
Task 3, Epoch 2/20 => Loss 2.582, Loss_clf 0.334, Loss_fe 0.598, Loss_kd 1.238, Train_accy 77.07:  10%|█         | 2/20 [01:08<09:59, 33.31s/it]
Task 3, Epoch 3/20 => Loss 2.442, Loss_clf 0.317, Loss_fe 0.481, Loss_kd 1.234, Train_accy 79.25:  10%|█         | 2/20 [01:37<09:59, 33.31s/it]
Task 3, Epoch 3/20 => Loss 2.442, Loss_clf 0.317, Loss_fe 0.481, Loss_kd 1.234, Train_accy 79.25:  15%|█▌        | 3/20 [01:37<08:50, 31.21s/it]
Task 3, Epoch 4/20 => Loss 2.373, Loss_clf 0.300, Loss_fe 0.410, Loss_kd 1.248, Train_accy 79.79:  15%|█▌        | 3/20 [02:06<08:50, 31.21s/it]
Task 3, Epoch 4/20 => Loss 2.373, Loss_clf 0.300, Loss_fe 0.410, Loss_kd 1.248, Train_accy 79.79:  20%|██        | 4/20 [02:06<08:03, 30.25s/it]
Task 3, Epoch 5/20 => Loss 2.261, Loss_clf 0.264, Loss_fe 0.342, Loss_kd 1.241, Train_accy 83.32:  20%|██        | 4/20 [02:34<08:03, 30.25s/it]
Task 3, Epoch 5/20 => Loss 2.261, Loss_clf 0.264, Loss_fe 0.342, Loss_kd 1.241, Train_accy 83.32:  25%|██▌       | 5/20 [02:34<07:25, 29.70s/it]
Task 3, Epoch 6/20 => Loss 2.285, Loss_clf 0.274, Loss_fe 0.343, Loss_kd 1.251, Train_accy 82.50, Test_accy 94.40:  25%|██▌       | 5/20 [03:14<07:25, 29.70s/it]
Task 3, Epoch 6/20 => Loss 2.285, Loss_clf 0.274, Loss_fe 0.343, Loss_kd 1.251, Train_accy 82.50, Test_accy 94.40:  30%|███       | 6/20 [03:14<07:45, 33.22s/it]
Task 3, Epoch 7/20 => Loss 2.224, Loss_clf 0.253, Loss_fe 0.305, Loss_kd 1.249, Train_accy 83.96:  30%|███       | 6/20 [03:43<07:45, 33.22s/it]                 
Task 3, Epoch 7/20 => Loss 2.224, Loss_clf 0.253, Loss_fe 0.305, Loss_kd 1.249, Train_accy 83.96:  35%|███▌      | 7/20 [03:43<06:52, 31.75s/it]
Task 3, Epoch 8/20 => Loss 2.177, Loss_clf 0.228, Loss_fe 0.277, Loss_kd 1.254, Train_accy 86.32:  35%|███▌      | 7/20 [04:12<06:52, 31.75s/it]
Task 3, Epoch 8/20 => Loss 2.177, Loss_clf 0.228, Loss_fe 0.277, Loss_kd 1.254, Train_accy 86.32:  40%|████      | 8/20 [04:12<06:09, 30.81s/it]
Task 3, Epoch 9/20 => Loss 2.119, Loss_clf 0.219, Loss_fe 0.249, Loss_kd 1.238, Train_accy 86.50:  40%|████      | 8/20 [04:41<06:09, 30.81s/it]
Task 3, Epoch 9/20 => Loss 2.119, Loss_clf 0.219, Loss_fe 0.249, Loss_kd 1.238, Train_accy 86.50:  45%|████▌     | 9/20 [04:41<05:31, 30.16s/it]
Task 3, Epoch 10/20 => Loss 2.102, Loss_clf 0.217, Loss_fe 0.234, Loss_kd 1.239, Train_accy 87.36:  45%|████▌     | 9/20 [05:09<05:31, 30.16s/it]
Task 3, Epoch 10/20 => Loss 2.102, Loss_clf 0.217, Loss_fe 0.234, Loss_kd 1.239, Train_accy 87.36:  50%|█████     | 10/20 [05:09<04:57, 29.74s/it]
Task 3, Epoch 11/20 => Loss 2.083, Loss_clf 0.214, Loss_fe 0.216, Loss_kd 1.240, Train_accy 87.36, Test_accy 94.85:  50%|█████     | 10/20 [05:50<04:57, 29.74s/it]
Task 3, Epoch 11/20 => Loss 2.083, Loss_clf 0.214, Loss_fe 0.216, Loss_kd 1.240, Train_accy 87.36, Test_accy 94.85:  55%|█████▌    | 11/20 [05:50<04:56, 32.92s/it]
Task 3, Epoch 12/20 => Loss 2.049, Loss_clf 0.195, Loss_fe 0.204, Loss_kd 1.238, Train_accy 88.29:  55%|█████▌    | 11/20 [06:18<04:56, 32.92s/it]                 
Task 3, Epoch 12/20 => Loss 2.049, Loss_clf 0.195, Loss_fe 0.204, Loss_kd 1.238, Train_accy 88.29:  60%|██████    | 12/20 [06:18<04:13, 31.64s/it]
Task 3, Epoch 13/20 => Loss 2.002, Loss_clf 0.174, Loss_fe 0.170, Loss_kd 1.243, Train_accy 90.32:  60%|██████    | 12/20 [06:47<04:13, 31.64s/it]
Task 3, Epoch 13/20 => Loss 2.002, Loss_clf 0.174, Loss_fe 0.170, Loss_kd 1.243, Train_accy 90.32:  65%|██████▌   | 13/20 [06:47<03:35, 30.76s/it]
Task 3, Epoch 14/20 => Loss 2.025, Loss_clf 0.178, Loss_fe 0.185, Loss_kd 1.247, Train_accy 90.50:  65%|██████▌   | 13/20 [07:16<03:35, 30.76s/it]
Task 3, Epoch 14/20 => Loss 2.025, Loss_clf 0.178, Loss_fe 0.185, Loss_kd 1.247, Train_accy 90.50:  70%|███████   | 14/20 [07:16<03:01, 30.17s/it]
Task 3, Epoch 15/20 => Loss 2.000, Loss_clf 0.164, Loss_fe 0.170, Loss_kd 1.249, Train_accy 90.11:  70%|███████   | 14/20 [07:45<03:01, 30.17s/it]
Task 3, Epoch 15/20 => Loss 2.000, Loss_clf 0.164, Loss_fe 0.170, Loss_kd 1.249, Train_accy 90.11:  75%|███████▌  | 15/20 [07:45<02:28, 29.80s/it]
Task 3, Epoch 16/20 => Loss 2.006, Loss_clf 0.174, Loss_fe 0.181, Loss_kd 1.238, Train_accy 89.71, Test_accy 95.45:  75%|███████▌  | 15/20 [08:25<02:28, 29.80s/it]
Task 3, Epoch 16/20 => Loss 2.006, Loss_clf 0.174, Loss_fe 0.181, Loss_kd 1.238, Train_accy 89.71, Test_accy 95.45:  80%|████████  | 16/20 [08:25<02:11, 32.90s/it]
Task 3, Epoch 17/20 => Loss 1.936, Loss_clf 0.143, Loss_fe 0.144, Loss_kd 1.237, Train_accy 90.32:  80%|████████  | 16/20 [08:54<02:11, 32.90s/it]                 
Task 3, Epoch 17/20 => Loss 1.936, Loss_clf 0.143, Loss_fe 0.144, Loss_kd 1.237, Train_accy 90.32:  85%|████████▌ | 17/20 [08:54<01:34, 31.66s/it]
Task 3, Epoch 18/20 => Loss 1.995, Loss_clf 0.168, Loss_fe 0.162, Loss_kd 1.248, Train_accy 91.00:  85%|████████▌ | 17/20 [09:22<01:34, 31.66s/it]
Task 3, Epoch 18/20 => Loss 1.995, Loss_clf 0.168, Loss_fe 0.162, Loss_kd 1.248, Train_accy 91.00:  90%|█████████ | 18/20 [09:22<01:01, 30.79s/it]
Task 3, Epoch 19/20 => Loss 2.014, Loss_clf 0.177, Loss_fe 0.168, Loss_kd 1.252, Train_accy 90.36:  90%|█████████ | 18/20 [09:51<01:01, 30.79s/it]
Task 3, Epoch 19/20 => Loss 2.014, Loss_clf 0.177, Loss_fe 0.168, Loss_kd 1.252, Train_accy 90.36:  95%|█████████▌| 19/20 [09:51<00:30, 30.21s/it]
Task 3, Epoch 20/20 => Loss 1.964, Loss_clf 0.155, Loss_fe 0.150, Loss_kd 1.245, Train_accy 91.18:  95%|█████████▌| 19/20 [10:20<00:30, 30.21s/it]
Task 3, Epoch 20/20 => Loss 1.964, Loss_clf 0.155, Loss_fe 0.150, Loss_kd 1.245, Train_accy 91.18: 100%|██████████| 20/20 [10:20<00:00, 29.85s/it]
Task 3, Epoch 20/20 => Loss 1.964, Loss_clf 0.155, Loss_fe 0.150, Loss_kd 1.245, Train_accy 91.18: 100%|██████████| 20/20 [10:20<00:00, 31.04s/it]
2024-09-05 02:08:57,066 [foster.py] => Task 3, Epoch 20/20 => Loss 1.964, Loss_clf 0.155, Loss_fe 0.150, Loss_kd 1.245, Train_accy 91.18
2024-09-05 02:08:57,068 [foster.py] => do not weight align teacher!
2024-09-05 02:08:57,070 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.672,  Train_accy 65.96, Test_accy 94.85:   0%|          | 0/20 [00:42<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.672,  Train_accy 65.96, Test_accy 94.85:   5%|▌         | 1/20 [00:42<13:26, 42.43s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.313,  Train_accy 77.61:   5%|▌         | 1/20 [01:18<13:26, 42.43s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.313,  Train_accy 77.61:  10%|█         | 2/20 [01:18<11:38, 38.81s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.306,  Train_accy 78.50:  10%|█         | 2/20 [01:54<11:38, 38.81s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.306,  Train_accy 78.50:  15%|█▌        | 3/20 [01:54<10:39, 37.63s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.296,  Train_accy 80.46:  15%|█▌        | 3/20 [02:31<10:39, 37.63s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.296,  Train_accy 80.46:  20%|██        | 4/20 [02:31<09:52, 37.06s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.318,  Train_accy 79.39:  20%|██        | 4/20 [03:07<09:52, 37.06s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.318,  Train_accy 79.39:  25%|██▌       | 5/20 [03:07<09:11, 36.75s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.310,  Train_accy 78.57, Test_accy 94.20:  25%|██▌       | 5/20 [03:49<09:11, 36.75s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.310,  Train_accy 78.57, Test_accy 94.20:  30%|███       | 6/20 [03:49<09:00, 38.62s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.290,  Train_accy 79.29:  30%|███       | 6/20 [04:25<09:00, 38.62s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.290,  Train_accy 79.29:  35%|███▌      | 7/20 [04:25<08:11, 37.81s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.288,  Train_accy 79.96:  35%|███▌      | 7/20 [05:01<08:11, 37.81s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.288,  Train_accy 79.96:  40%|████      | 8/20 [05:01<07:27, 37.29s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.278,  Train_accy 80.36:  40%|████      | 8/20 [05:38<07:27, 37.29s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.278,  Train_accy 80.36:  45%|████▌     | 9/20 [05:38<06:46, 36.93s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.314,  Train_accy 79.79:  45%|████▌     | 9/20 [06:14<06:46, 36.93s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.314,  Train_accy 79.79:  50%|█████     | 10/20 [06:14<06:06, 36.70s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.302,  Train_accy 78.82, Test_accy 94.40:  50%|█████     | 10/20 [06:56<06:06, 36.70s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.302,  Train_accy 78.82, Test_accy 94.40:  55%|█████▌    | 11/20 [06:56<05:45, 38.38s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.288,  Train_accy 80.79:  55%|█████▌    | 11/20 [07:32<05:45, 38.38s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.288,  Train_accy 80.79:  60%|██████    | 12/20 [07:32<05:01, 37.70s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.275,  Train_accy 81.46:  60%|██████    | 12/20 [08:08<05:01, 37.70s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.275,  Train_accy 81.46:  65%|██████▌   | 13/20 [08:08<04:20, 37.23s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.277,  Train_accy 80.50:  65%|██████▌   | 13/20 [08:44<04:20, 37.23s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.277,  Train_accy 80.50:  70%|███████   | 14/20 [08:44<03:41, 36.91s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.284,  Train_accy 80.96:  70%|███████   | 14/20 [09:21<03:41, 36.91s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.284,  Train_accy 80.96:  75%|███████▌  | 15/20 [09:21<03:03, 36.68s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.289,  Train_accy 79.71, Test_accy 94.25:  75%|███████▌  | 15/20 [10:03<03:03, 36.68s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.289,  Train_accy 79.71, Test_accy 94.25:  80%|████████  | 16/20 [10:03<02:33, 38.35s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.286,  Train_accy 80.68:  80%|████████  | 16/20 [10:39<02:33, 38.35s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.286,  Train_accy 80.68:  85%|████████▌ | 17/20 [10:39<01:53, 37.71s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.283,  Train_accy 80.86:  85%|████████▌ | 17/20 [11:15<01:53, 37.71s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.283,  Train_accy 80.86:  90%|█████████ | 18/20 [11:15<01:14, 37.24s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.263,  Train_accy 81.04:  90%|█████████ | 18/20 [11:51<01:14, 37.24s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.263,  Train_accy 81.04:  95%|█████████▌| 19/20 [11:51<00:36, 36.90s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.279,  Train_accy 81.04:  95%|█████████▌| 19/20 [12:27<00:36, 36.90s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.279,  Train_accy 81.04: 100%|██████████| 20/20 [12:27<00:00, 36.68s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.279,  Train_accy 81.04: 100%|██████████| 20/20 [12:27<00:00, 37.39s/it]
2024-09-05 02:21:26,495 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.279,  Train_accy 81.04
2024-09-05 02:21:26,495 [foster.py] => do not weight align student!
2024-09-05 02:21:32,541 [foster.py] => darknet eval: 
2024-09-05 02:21:32,541 [foster.py] => CNN top1 curve: 94.15
2024-09-05 02:21:32,541 [foster.py] => CNN top5 curve: 99.6
2024-09-05 02:21:32,544 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 02:22:17,635 [foster.py] => Exemplar size: 400
2024-09-05 02:22:17,635 [trainer.py] => CNN: {'total': 95.45, '00-04': 98.4, '05-09': 96.4, '10-14': 95.6, '15-19': 91.4, 'old': 96.8, 'new': 91.4}
2024-09-05 02:22:17,635 [trainer.py] => NME: {'total': 95.95, '00-04': 98.4, '05-09': 94.8, '10-14': 95.4, '15-19': 95.2, 'old': 96.2, 'new': 95.2}
2024-09-05 02:22:17,636 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45]
2024-09-05 02:22:17,636 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5]
2024-09-05 02:22:17,636 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95]
2024-09-05 02:22:17,636 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7]

Average Accuracy (CNN): 97.73
Average Accuracy (NME): 97.98
2024-09-05 02:22:17,636 [trainer.py] => Average Accuracy (CNN): 97.73
2024-09-05 02:22:17,636 [trainer.py] => Average Accuracy (NME): 97.98
2024-09-05 02:22:17,637 [trainer.py] => All params: 171654967
2024-09-05 02:22:17,638 [trainer.py] => Trainable params: 85844776
2024-09-05 02:22:19,192 [foster.py] => Learning on 20-25
2024-09-05 02:22:19,194 [foster.py] => All params: 171670342
2024-09-05 02:22:19,195 [foster.py] => Trainable params: 85856306
2024-09-05 02:22:19,265 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.463, Loss_clf 0.579, Loss_fe 1.128, Loss_kd 1.405, Train_accy 72.10, Test_accy 91.28:   0%|          | 0/20 [00:43<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.463, Loss_clf 0.579, Loss_fe 1.128, Loss_kd 1.405, Train_accy 72.10, Test_accy 91.28:   5%|▌         | 1/20 [00:43<13:52, 43.80s/it]
Task 4, Epoch 2/20 => Loss 2.498, Loss_clf 0.272, Loss_fe 0.483, Loss_kd 1.395, Train_accy 79.76:   5%|▌         | 1/20 [01:13<13:52, 43.80s/it]                 
Task 4, Epoch 2/20 => Loss 2.498, Loss_clf 0.272, Loss_fe 0.483, Loss_kd 1.395, Train_accy 79.76:  10%|█         | 2/20 [01:13<10:38, 35.49s/it]
Task 4, Epoch 3/20 => Loss 2.408, Loss_clf 0.262, Loss_fe 0.383, Loss_kd 1.410, Train_accy 81.97:  10%|█         | 2/20 [01:43<10:38, 35.49s/it]
Task 4, Epoch 3/20 => Loss 2.408, Loss_clf 0.262, Loss_fe 0.383, Loss_kd 1.410, Train_accy 81.97:  15%|█▌        | 3/20 [01:43<09:18, 32.86s/it]
Task 4, Epoch 4/20 => Loss 2.214, Loss_clf 0.204, Loss_fe 0.271, Loss_kd 1.391, Train_accy 84.10:  15%|█▌        | 3/20 [02:12<09:18, 32.86s/it]
Task 4, Epoch 4/20 => Loss 2.214, Loss_clf 0.204, Loss_fe 0.271, Loss_kd 1.391, Train_accy 84.10:  20%|██        | 4/20 [02:12<08:25, 31.61s/it]
Task 4, Epoch 5/20 => Loss 2.260, Loss_clf 0.235, Loss_fe 0.286, Loss_kd 1.391, Train_accy 84.48:  20%|██        | 4/20 [02:42<08:25, 31.61s/it]
Task 4, Epoch 5/20 => Loss 2.260, Loss_clf 0.235, Loss_fe 0.286, Loss_kd 1.391, Train_accy 84.48:  25%|██▌       | 5/20 [02:42<07:44, 30.94s/it]
Task 4, Epoch 6/20 => Loss 2.153, Loss_clf 0.173, Loss_fe 0.237, Loss_kd 1.394, Train_accy 86.34, Test_accy 93.52:  25%|██▌       | 5/20 [03:26<07:44, 30.94s/it]
Task 4, Epoch 6/20 => Loss 2.153, Loss_clf 0.173, Loss_fe 0.237, Loss_kd 1.394, Train_accy 86.34, Test_accy 93.52:  30%|███       | 6/20 [03:26<08:14, 35.34s/it]
Task 4, Epoch 7/20 => Loss 2.163, Loss_clf 0.198, Loss_fe 0.222, Loss_kd 1.395, Train_accy 86.38:  30%|███       | 6/20 [03:56<08:14, 35.34s/it]                 
Task 4, Epoch 7/20 => Loss 2.163, Loss_clf 0.198, Loss_fe 0.222, Loss_kd 1.395, Train_accy 86.38:  35%|███▌      | 7/20 [03:56<07:15, 33.50s/it]
Task 4, Epoch 8/20 => Loss 2.091, Loss_clf 0.164, Loss_fe 0.199, Loss_kd 1.382, Train_accy 86.97:  35%|███▌      | 7/20 [04:25<07:15, 33.50s/it]
Task 4, Epoch 8/20 => Loss 2.091, Loss_clf 0.164, Loss_fe 0.199, Loss_kd 1.382, Train_accy 86.97:  40%|████      | 8/20 [04:25<06:27, 32.29s/it]
Task 4, Epoch 9/20 => Loss 2.160, Loss_clf 0.191, Loss_fe 0.225, Loss_kd 1.395, Train_accy 86.10:  40%|████      | 8/20 [04:55<06:27, 32.29s/it]
Task 4, Epoch 9/20 => Loss 2.160, Loss_clf 0.191, Loss_fe 0.225, Loss_kd 1.395, Train_accy 86.10:  45%|████▌     | 9/20 [04:55<05:46, 31.50s/it]
Task 4, Epoch 10/20 => Loss 2.092, Loss_clf 0.170, Loss_fe 0.191, Loss_kd 1.385, Train_accy 86.86:  45%|████▌     | 9/20 [05:25<05:46, 31.50s/it]
Task 4, Epoch 10/20 => Loss 2.092, Loss_clf 0.170, Loss_fe 0.191, Loss_kd 1.385, Train_accy 86.86:  50%|█████     | 10/20 [05:25<05:09, 30.97s/it]
Task 4, Epoch 11/20 => Loss 2.108, Loss_clf 0.176, Loss_fe 0.187, Loss_kd 1.395, Train_accy 86.86, Test_accy 94.36:  50%|█████     | 10/20 [06:09<05:09, 30.97s/it]
Task 4, Epoch 11/20 => Loss 2.108, Loss_clf 0.176, Loss_fe 0.187, Loss_kd 1.395, Train_accy 86.86, Test_accy 94.36:  55%|█████▌    | 11/20 [06:09<05:14, 34.92s/it]
Task 4, Epoch 12/20 => Loss 2.053, Loss_clf 0.153, Loss_fe 0.169, Loss_kd 1.385, Train_accy 87.66:  55%|█████▌    | 11/20 [06:39<05:14, 34.92s/it]                 
Task 4, Epoch 12/20 => Loss 2.053, Loss_clf 0.153, Loss_fe 0.169, Loss_kd 1.385, Train_accy 87.66:  60%|██████    | 12/20 [06:39<04:26, 33.34s/it]
Task 4, Epoch 13/20 => Loss 2.017, Loss_clf 0.141, Loss_fe 0.138, Loss_kd 1.390, Train_accy 90.17:  60%|██████    | 12/20 [07:08<04:26, 33.34s/it]
Task 4, Epoch 13/20 => Loss 2.017, Loss_clf 0.141, Loss_fe 0.138, Loss_kd 1.390, Train_accy 90.17:  65%|██████▌   | 13/20 [07:08<03:45, 32.26s/it]
Task 4, Epoch 14/20 => Loss 1.973, Loss_clf 0.124, Loss_fe 0.124, Loss_kd 1.379, Train_accy 90.31:  65%|██████▌   | 13/20 [07:38<03:45, 32.26s/it]
Task 4, Epoch 14/20 => Loss 1.973, Loss_clf 0.124, Loss_fe 0.124, Loss_kd 1.379, Train_accy 90.31:  70%|███████   | 14/20 [07:38<03:09, 31.50s/it]
Task 4, Epoch 15/20 => Loss 1.998, Loss_clf 0.132, Loss_fe 0.129, Loss_kd 1.390, Train_accy 90.48:  70%|███████   | 14/20 [08:08<03:09, 31.50s/it]
Task 4, Epoch 15/20 => Loss 1.998, Loss_clf 0.132, Loss_fe 0.129, Loss_kd 1.390, Train_accy 90.48:  75%|███████▌  | 15/20 [08:08<02:35, 31.00s/it]
Task 4, Epoch 16/20 => Loss 1.959, Loss_clf 0.116, Loss_fe 0.110, Loss_kd 1.386, Train_accy 90.97, Test_accy 94.60:  75%|███████▌  | 15/20 [08:52<02:35, 31.00s/it]
Task 4, Epoch 16/20 => Loss 1.959, Loss_clf 0.116, Loss_fe 0.110, Loss_kd 1.386, Train_accy 90.97, Test_accy 94.60:  80%|████████  | 16/20 [08:52<02:19, 34.88s/it]
Task 4, Epoch 17/20 => Loss 1.962, Loss_clf 0.119, Loss_fe 0.107, Loss_kd 1.389, Train_accy 92.59:  80%|████████  | 16/20 [09:22<02:19, 34.88s/it]                 
Task 4, Epoch 17/20 => Loss 1.962, Loss_clf 0.119, Loss_fe 0.107, Loss_kd 1.389, Train_accy 92.59:  85%|████████▌ | 17/20 [09:22<01:40, 33.34s/it]
Task 4, Epoch 18/20 => Loss 2.011, Loss_clf 0.134, Loss_fe 0.126, Loss_kd 1.401, Train_accy 91.48:  85%|████████▌ | 17/20 [09:51<01:40, 33.34s/it]
Task 4, Epoch 18/20 => Loss 2.011, Loss_clf 0.134, Loss_fe 0.126, Loss_kd 1.401, Train_accy 91.48:  90%|█████████ | 18/20 [09:51<01:04, 32.27s/it]
Task 4, Epoch 19/20 => Loss 1.984, Loss_clf 0.130, Loss_fe 0.122, Loss_kd 1.386, Train_accy 91.10:  90%|█████████ | 18/20 [10:21<01:04, 32.27s/it]
Task 4, Epoch 19/20 => Loss 1.984, Loss_clf 0.130, Loss_fe 0.122, Loss_kd 1.386, Train_accy 91.10:  95%|█████████▌| 19/20 [10:21<00:31, 31.52s/it]
Task 4, Epoch 20/20 => Loss 1.980, Loss_clf 0.128, Loss_fe 0.115, Loss_kd 1.389, Train_accy 90.83:  95%|█████████▌| 19/20 [10:51<00:31, 31.52s/it]
Task 4, Epoch 20/20 => Loss 1.980, Loss_clf 0.128, Loss_fe 0.115, Loss_kd 1.389, Train_accy 90.83: 100%|██████████| 20/20 [10:51<00:00, 31.00s/it]
Task 4, Epoch 20/20 => Loss 1.980, Loss_clf 0.128, Loss_fe 0.115, Loss_kd 1.389, Train_accy 90.83: 100%|██████████| 20/20 [10:51<00:00, 32.57s/it]
2024-09-05 02:33:10,716 [foster.py] => Task 4, Epoch 20/20 => Loss 1.980, Loss_clf 0.128, Loss_fe 0.115, Loss_kd 1.389, Train_accy 90.83
2024-09-05 02:33:10,718 [foster.py] => do not weight align teacher!
2024-09-05 02:33:10,720 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.576,  Train_accy 70.48, Test_accy 94.12:   0%|          | 0/20 [00:44<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.576,  Train_accy 70.48, Test_accy 94.12:   5%|▌         | 1/20 [00:44<14:10, 44.74s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.269,  Train_accy 81.45:   5%|▌         | 1/20 [01:22<14:10, 44.74s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.269,  Train_accy 81.45:  10%|█         | 2/20 [01:22<12:07, 40.41s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.256,  Train_accy 81.34:  10%|█         | 2/20 [01:59<12:07, 40.41s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.256,  Train_accy 81.34:  15%|█▌        | 3/20 [01:59<11:03, 39.03s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.264,  Train_accy 81.10:  15%|█▌        | 3/20 [02:36<11:03, 39.03s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.264,  Train_accy 81.10:  20%|██        | 4/20 [02:36<10:14, 38.42s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.281,  Train_accy 81.76:  20%|██        | 4/20 [03:14<10:14, 38.42s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.281,  Train_accy 81.76:  25%|██▌       | 5/20 [03:14<09:30, 38.06s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.252,  Train_accy 82.38, Test_accy 94.00:  25%|██▌       | 5/20 [03:59<09:30, 38.06s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.252,  Train_accy 82.38, Test_accy 94.00:  30%|███       | 6/20 [03:59<09:25, 40.38s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.240,  Train_accy 81.90:  30%|███       | 6/20 [04:36<09:25, 40.38s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.240,  Train_accy 81.90:  35%|███▌      | 7/20 [04:36<08:32, 39.42s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.243,  Train_accy 82.79:  35%|███▌      | 7/20 [05:14<08:32, 39.42s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.243,  Train_accy 82.79:  40%|████      | 8/20 [05:14<07:45, 38.77s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.247,  Train_accy 82.24:  40%|████      | 8/20 [05:51<07:45, 38.77s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.247,  Train_accy 82.24:  45%|████▌     | 9/20 [05:51<07:01, 38.34s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.286,  Train_accy 81.79:  45%|████▌     | 9/20 [06:28<07:01, 38.34s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.286,  Train_accy 81.79:  50%|█████     | 10/20 [06:28<06:20, 38.06s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.259,  Train_accy 82.45, Test_accy 93.80:  50%|█████     | 10/20 [07:13<06:20, 38.06s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.259,  Train_accy 82.45, Test_accy 93.80:  55%|█████▌    | 11/20 [07:13<06:01, 40.14s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.249,  Train_accy 81.24:  55%|█████▌    | 11/20 [07:51<06:01, 40.14s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.249,  Train_accy 81.24:  60%|██████    | 12/20 [07:51<05:14, 39.31s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.248,  Train_accy 82.31:  60%|██████    | 12/20 [08:28<05:14, 39.31s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.248,  Train_accy 82.31:  65%|██████▌   | 13/20 [08:28<04:31, 38.73s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.273,  Train_accy 81.10:  65%|██████▌   | 13/20 [09:05<04:31, 38.73s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.273,  Train_accy 81.10:  70%|███████   | 14/20 [09:05<03:49, 38.32s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.259,  Train_accy 83.14:  70%|███████   | 14/20 [09:43<03:49, 38.32s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.259,  Train_accy 83.14:  75%|███████▌  | 15/20 [09:43<03:10, 38.03s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.263,  Train_accy 83.17, Test_accy 94.00:  75%|███████▌  | 15/20 [10:28<03:10, 38.03s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.263,  Train_accy 83.17, Test_accy 94.00:  80%|████████  | 16/20 [10:28<02:40, 40.08s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.238,  Train_accy 81.93:  80%|████████  | 16/20 [11:05<02:40, 40.08s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.238,  Train_accy 81.93:  85%|████████▌ | 17/20 [11:05<01:57, 39.26s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.255,  Train_accy 81.90:  85%|████████▌ | 17/20 [11:42<01:57, 39.26s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.255,  Train_accy 81.90:  90%|█████████ | 18/20 [11:42<01:17, 38.70s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.244,  Train_accy 82.34:  90%|█████████ | 18/20 [12:20<01:17, 38.70s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.244,  Train_accy 82.34:  95%|█████████▌| 19/20 [12:20<00:38, 38.33s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.249,  Train_accy 82.07:  95%|█████████▌| 19/20 [12:57<00:38, 38.33s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.249,  Train_accy 82.07: 100%|██████████| 20/20 [12:57<00:00, 38.06s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.249,  Train_accy 82.07: 100%|██████████| 20/20 [12:57<00:00, 38.89s/it]
2024-09-05 02:46:10,102 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.249,  Train_accy 82.07
2024-09-05 02:46:10,103 [foster.py] => do not weight align student!
2024-09-05 02:46:17,647 [foster.py] => darknet eval: 
2024-09-05 02:46:17,647 [foster.py] => CNN top1 curve: 94.0
2024-09-05 02:46:17,647 [foster.py] => CNN top5 curve: 99.68
2024-09-05 02:46:17,648 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 02:47:09,915 [foster.py] => Exemplar size: 500
2024-09-05 02:47:09,916 [trainer.py] => CNN: {'total': 94.6, '00-04': 98.4, '05-09': 95.6, '10-14': 96.0, '15-19': 88.8, '20-24': 94.2, 'old': 94.7, 'new': 94.2}
2024-09-05 02:47:09,916 [trainer.py] => NME: {'total': 96.0, '00-04': 98.8, '05-09': 95.4, '10-14': 93.0, '15-19': 94.4, '20-24': 98.4, 'old': 95.4, 'new': 98.4}
2024-09-05 02:47:09,916 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6]
2024-09-05 02:47:09,916 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56]
2024-09-05 02:47:09,916 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0]
2024-09-05 02:47:09,916 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72]

Average Accuracy (CNN): 97.1
Average Accuracy (NME): 97.58
2024-09-05 02:47:09,916 [trainer.py] => Average Accuracy (CNN): 97.1
2024-09-05 02:47:09,916 [trainer.py] => Average Accuracy (NME): 97.58
2024-09-05 02:47:09,917 [trainer.py] => All params: 171670342
2024-09-05 02:47:09,918 [trainer.py] => Trainable params: 85856306
2024-09-05 02:47:11,441 [foster.py] => Learning on 25-30
2024-09-05 02:47:11,443 [foster.py] => All params: 171685717
2024-09-05 02:47:11,444 [foster.py] => Trainable params: 85867836
2024-09-05 02:47:11,514 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.774, Loss_clf 0.709, Loss_fe 1.159, Loss_kd 1.588, Train_accy 74.33, Test_accy 91.47:   0%|          | 0/20 [00:47<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.774, Loss_clf 0.709, Loss_fe 1.159, Loss_kd 1.588, Train_accy 74.33, Test_accy 91.47:   5%|▌         | 1/20 [00:47<15:00, 47.37s/it]
Task 5, Epoch 2/20 => Loss 2.813, Loss_clf 0.284, Loss_fe 0.627, Loss_kd 1.586, Train_accy 76.67:   5%|▌         | 1/20 [01:17<15:00, 47.37s/it]                 
Task 5, Epoch 2/20 => Loss 2.813, Loss_clf 0.284, Loss_fe 0.627, Loss_kd 1.586, Train_accy 76.67:  10%|█         | 2/20 [01:17<11:15, 37.52s/it]
Task 5, Epoch 3/20 => Loss 2.591, Loss_clf 0.254, Loss_fe 0.446, Loss_kd 1.576, Train_accy 79.47:  10%|█         | 2/20 [01:48<11:15, 37.52s/it]
Task 5, Epoch 3/20 => Loss 2.591, Loss_clf 0.254, Loss_fe 0.446, Loss_kd 1.576, Train_accy 79.47:  15%|█▌        | 3/20 [01:48<09:44, 34.40s/it]
Task 5, Epoch 4/20 => Loss 2.508, Loss_clf 0.238, Loss_fe 0.375, Loss_kd 1.579, Train_accy 80.60:  15%|█▌        | 3/20 [02:19<09:44, 34.40s/it]
Task 5, Epoch 4/20 => Loss 2.508, Loss_clf 0.238, Loss_fe 0.375, Loss_kd 1.579, Train_accy 80.60:  20%|██        | 4/20 [02:19<08:47, 32.94s/it]
Task 5, Epoch 5/20 => Loss 2.476, Loss_clf 0.240, Loss_fe 0.331, Loss_kd 1.587, Train_accy 81.27:  20%|██        | 4/20 [02:50<08:47, 32.94s/it]
Task 5, Epoch 5/20 => Loss 2.476, Loss_clf 0.240, Loss_fe 0.331, Loss_kd 1.587, Train_accy 81.27:  25%|██▌       | 5/20 [02:50<08:01, 32.13s/it]
Task 5, Epoch 6/20 => Loss 2.437, Loss_clf 0.237, Loss_fe 0.311, Loss_kd 1.575, Train_accy 81.90, Test_accy 93.70:  25%|██▌       | 5/20 [03:37<08:01, 32.13s/it]
Task 5, Epoch 6/20 => Loss 2.437, Loss_clf 0.237, Loss_fe 0.311, Loss_kd 1.575, Train_accy 81.90, Test_accy 93.70:  30%|███       | 6/20 [03:37<08:43, 37.40s/it]
Task 5, Epoch 7/20 => Loss 2.367, Loss_clf 0.219, Loss_fe 0.261, Loss_kd 1.573, Train_accy 83.03:  30%|███       | 6/20 [04:08<08:43, 37.40s/it]                 
Task 5, Epoch 7/20 => Loss 2.367, Loss_clf 0.219, Loss_fe 0.261, Loss_kd 1.573, Train_accy 83.03:  35%|███▌      | 7/20 [04:08<07:37, 35.23s/it]
Task 5, Epoch 8/20 => Loss 2.327, Loss_clf 0.199, Loss_fe 0.242, Loss_kd 1.572, Train_accy 83.57:  35%|███▌      | 7/20 [04:39<07:37, 35.23s/it]
Task 5, Epoch 8/20 => Loss 2.327, Loss_clf 0.199, Loss_fe 0.242, Loss_kd 1.572, Train_accy 83.57:  40%|████      | 8/20 [04:39<06:45, 33.81s/it]
Task 5, Epoch 9/20 => Loss 2.260, Loss_clf 0.178, Loss_fe 0.208, Loss_kd 1.561, Train_accy 85.93:  40%|████      | 8/20 [05:10<06:45, 33.81s/it]
Task 5, Epoch 9/20 => Loss 2.260, Loss_clf 0.178, Loss_fe 0.208, Loss_kd 1.561, Train_accy 85.93:  45%|████▌     | 9/20 [05:10<06:01, 32.89s/it]
Task 5, Epoch 10/20 => Loss 2.322, Loss_clf 0.201, Loss_fe 0.238, Loss_kd 1.570, Train_accy 85.20:  45%|████▌     | 9/20 [05:40<06:01, 32.89s/it]
Task 5, Epoch 10/20 => Loss 2.322, Loss_clf 0.201, Loss_fe 0.238, Loss_kd 1.570, Train_accy 85.20:  50%|█████     | 10/20 [05:40<05:22, 32.23s/it]
Task 5, Epoch 11/20 => Loss 2.339, Loss_clf 0.203, Loss_fe 0.234, Loss_kd 1.586, Train_accy 84.40, Test_accy 93.80:  50%|█████     | 10/20 [06:28<05:22, 32.23s/it]
Task 5, Epoch 11/20 => Loss 2.339, Loss_clf 0.203, Loss_fe 0.234, Loss_kd 1.586, Train_accy 84.40, Test_accy 93.80:  55%|█████▌    | 11/20 [06:28<05:32, 36.94s/it]
Task 5, Epoch 12/20 => Loss 2.299, Loss_clf 0.189, Loss_fe 0.204, Loss_kd 1.588, Train_accy 86.17:  55%|█████▌    | 11/20 [06:59<05:32, 36.94s/it]                 
Task 5, Epoch 12/20 => Loss 2.299, Loss_clf 0.189, Loss_fe 0.204, Loss_kd 1.588, Train_accy 86.17:  60%|██████    | 12/20 [06:59<04:40, 35.08s/it]
Task 5, Epoch 13/20 => Loss 2.273, Loss_clf 0.179, Loss_fe 0.190, Loss_kd 1.586, Train_accy 85.97:  60%|██████    | 12/20 [07:30<04:40, 35.08s/it]
Task 5, Epoch 13/20 => Loss 2.273, Loss_clf 0.179, Loss_fe 0.190, Loss_kd 1.586, Train_accy 85.97:  65%|██████▌   | 13/20 [07:30<03:56, 33.77s/it]
Task 5, Epoch 14/20 => Loss 2.217, Loss_clf 0.161, Loss_fe 0.166, Loss_kd 1.575, Train_accy 87.30:  65%|██████▌   | 13/20 [08:00<03:56, 33.77s/it]
Task 5, Epoch 14/20 => Loss 2.217, Loss_clf 0.161, Loss_fe 0.166, Loss_kd 1.575, Train_accy 87.30:  70%|███████   | 14/20 [08:00<03:17, 32.87s/it]
Task 5, Epoch 15/20 => Loss 2.184, Loss_clf 0.159, Loss_fe 0.154, Loss_kd 1.558, Train_accy 87.90:  70%|███████   | 14/20 [08:31<03:17, 32.87s/it]
Task 5, Epoch 15/20 => Loss 2.184, Loss_clf 0.159, Loss_fe 0.154, Loss_kd 1.558, Train_accy 87.90:  75%|███████▌  | 15/20 [08:31<02:41, 32.25s/it]
Task 5, Epoch 16/20 => Loss 2.223, Loss_clf 0.162, Loss_fe 0.166, Loss_kd 1.579, Train_accy 87.93, Test_accy 93.97:  75%|███████▌  | 15/20 [09:19<02:41, 32.25s/it]
Task 5, Epoch 16/20 => Loss 2.223, Loss_clf 0.162, Loss_fe 0.166, Loss_kd 1.579, Train_accy 87.93, Test_accy 93.97:  80%|████████  | 16/20 [09:19<02:27, 36.90s/it]
Task 5, Epoch 17/20 => Loss 2.225, Loss_clf 0.172, Loss_fe 0.170, Loss_kd 1.570, Train_accy 87.50:  80%|████████  | 16/20 [09:50<02:27, 36.90s/it]                 
Task 5, Epoch 17/20 => Loss 2.225, Loss_clf 0.172, Loss_fe 0.170, Loss_kd 1.570, Train_accy 87.50:  85%|████████▌ | 17/20 [09:50<01:45, 35.04s/it]
Task 5, Epoch 18/20 => Loss 2.148, Loss_clf 0.140, Loss_fe 0.138, Loss_kd 1.558, Train_accy 87.37:  85%|████████▌ | 17/20 [10:20<01:45, 35.04s/it]
Task 5, Epoch 18/20 => Loss 2.148, Loss_clf 0.140, Loss_fe 0.138, Loss_kd 1.558, Train_accy 87.37:  90%|█████████ | 18/20 [10:20<01:07, 33.75s/it]
Task 5, Epoch 19/20 => Loss 2.174, Loss_clf 0.149, Loss_fe 0.148, Loss_kd 1.564, Train_accy 87.97:  90%|█████████ | 18/20 [10:51<01:07, 33.75s/it]
Task 5, Epoch 19/20 => Loss 2.174, Loss_clf 0.149, Loss_fe 0.148, Loss_kd 1.564, Train_accy 87.97:  95%|█████████▌| 19/20 [10:51<00:32, 32.86s/it]
Task 5, Epoch 20/20 => Loss 2.189, Loss_clf 0.155, Loss_fe 0.149, Loss_kd 1.570, Train_accy 88.30:  95%|█████████▌| 19/20 [11:22<00:32, 32.86s/it]
Task 5, Epoch 20/20 => Loss 2.189, Loss_clf 0.155, Loss_fe 0.149, Loss_kd 1.570, Train_accy 88.30: 100%|██████████| 20/20 [11:22<00:00, 32.23s/it]
Task 5, Epoch 20/20 => Loss 2.189, Loss_clf 0.155, Loss_fe 0.149, Loss_kd 1.570, Train_accy 88.30: 100%|██████████| 20/20 [11:22<00:00, 34.12s/it]
2024-09-05 02:58:33,869 [foster.py] => Task 5, Epoch 20/20 => Loss 2.189, Loss_clf 0.155, Loss_fe 0.149, Loss_kd 1.570, Train_accy 88.30
2024-09-05 02:58:33,870 [foster.py] => do not weight align teacher!
2024-09-05 02:58:33,873 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.596,  Train_accy 69.60, Test_accy 92.97:   0%|          | 0/20 [00:47<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.596,  Train_accy 69.60, Test_accy 92.97:   5%|▌         | 1/20 [00:47<15:02, 47.52s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.385,  Train_accy 75.23:   5%|▌         | 1/20 [01:26<15:02, 47.52s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.385,  Train_accy 75.23:  10%|█         | 2/20 [01:26<12:41, 42.29s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.366,  Train_accy 76.13:  10%|█         | 2/20 [02:04<12:41, 42.29s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.366,  Train_accy 76.13:  15%|█▌        | 3/20 [02:04<11:31, 40.66s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.347,  Train_accy 77.53:  15%|█▌        | 3/20 [02:43<11:31, 40.66s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.347,  Train_accy 77.53:  20%|██        | 4/20 [02:43<10:38, 39.88s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.335,  Train_accy 77.83:  20%|██        | 4/20 [03:22<10:38, 39.88s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.335,  Train_accy 77.83:  25%|██▌       | 5/20 [03:22<09:51, 39.44s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.368,  Train_accy 76.47, Test_accy 92.63:  25%|██▌       | 5/20 [04:09<09:51, 39.44s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.368,  Train_accy 76.47, Test_accy 92.63:  30%|███       | 6/20 [04:09<09:51, 42.23s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.351,  Train_accy 76.73:  30%|███       | 6/20 [04:48<09:51, 42.23s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.351,  Train_accy 76.73:  35%|███▌      | 7/20 [04:48<08:54, 41.09s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.371,  Train_accy 76.70:  35%|███▌      | 7/20 [05:27<08:54, 41.09s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.371,  Train_accy 76.70:  40%|████      | 8/20 [05:27<08:03, 40.32s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.359,  Train_accy 76.87:  40%|████      | 8/20 [06:05<08:03, 40.32s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.359,  Train_accy 76.87:  45%|████▌     | 9/20 [06:05<07:17, 39.82s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.362,  Train_accy 77.07:  45%|████▌     | 9/20 [06:44<07:17, 39.82s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.362,  Train_accy 77.07:  50%|█████     | 10/20 [06:44<06:35, 39.50s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.330,  Train_accy 76.90, Test_accy 92.47:  50%|█████     | 10/20 [07:32<06:35, 39.50s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.330,  Train_accy 76.90, Test_accy 92.47:  55%|█████▌    | 11/20 [07:32<06:18, 42.00s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.359,  Train_accy 76.67:  55%|█████▌    | 11/20 [08:11<06:18, 42.00s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.359,  Train_accy 76.67:  60%|██████    | 12/20 [08:11<05:27, 40.99s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.350,  Train_accy 77.03:  60%|██████    | 12/20 [08:49<05:27, 40.99s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.350,  Train_accy 77.03:  65%|██████▌   | 13/20 [08:49<04:42, 40.29s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.333,  Train_accy 77.27:  65%|██████▌   | 13/20 [09:28<04:42, 40.29s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.333,  Train_accy 77.27:  70%|███████   | 14/20 [09:28<03:58, 39.81s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.368,  Train_accy 76.80:  70%|███████   | 14/20 [10:07<03:58, 39.81s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.368,  Train_accy 76.80:  75%|███████▌  | 15/20 [10:07<03:17, 39.47s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.347,  Train_accy 76.93, Test_accy 92.73:  75%|███████▌  | 15/20 [10:54<03:17, 39.47s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.347,  Train_accy 76.93, Test_accy 92.73:  80%|████████  | 16/20 [10:54<02:47, 41.93s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.361,  Train_accy 77.53:  80%|████████  | 16/20 [11:33<02:47, 41.93s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.361,  Train_accy 77.53:  85%|████████▌ | 17/20 [11:33<02:02, 40.97s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.332,  Train_accy 77.47:  85%|████████▌ | 17/20 [12:12<02:02, 40.97s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.332,  Train_accy 77.47:  90%|█████████ | 18/20 [12:12<01:20, 40.29s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.362,  Train_accy 76.20:  90%|█████████ | 18/20 [12:50<01:20, 40.29s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.362,  Train_accy 76.20:  95%|█████████▌| 19/20 [12:50<00:39, 39.81s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.372,  Train_accy 75.97:  95%|█████████▌| 19/20 [13:29<00:39, 39.81s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.372,  Train_accy 75.97: 100%|██████████| 20/20 [13:29<00:00, 39.49s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.372,  Train_accy 75.97: 100%|██████████| 20/20 [13:29<00:00, 40.49s/it]
2024-09-05 03:12:05,055 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.372,  Train_accy 75.97
2024-09-05 03:12:05,055 [foster.py] => do not weight align student!
2024-09-05 03:12:13,947 [foster.py] => darknet eval: 
2024-09-05 03:12:13,948 [foster.py] => CNN top1 curve: 92.67
2024-09-05 03:12:13,948 [foster.py] => CNN top5 curve: 99.53
2024-09-05 03:12:13,951 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 03:13:13,438 [foster.py] => Exemplar size: 600
2024-09-05 03:13:13,438 [trainer.py] => CNN: {'total': 93.87, '00-04': 98.4, '05-09': 95.0, '10-14': 95.8, '15-19': 90.8, '20-24': 94.6, '25-29': 88.6, 'old': 94.92, 'new': 88.6}
2024-09-05 03:13:13,438 [trainer.py] => NME: {'total': 94.5, '00-04': 98.6, '05-09': 88.8, '10-14': 92.6, '15-19': 93.0, '20-24': 96.4, '25-29': 97.6, 'old': 93.88, 'new': 97.6}
2024-09-05 03:13:13,438 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87]
2024-09-05 03:13:13,438 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6]
2024-09-05 03:13:13,438 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5]
2024-09-05 03:13:13,438 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53]

Average Accuracy (CNN): 96.56
Average Accuracy (NME): 97.07
2024-09-05 03:13:13,438 [trainer.py] => Average Accuracy (CNN): 96.56
2024-09-05 03:13:13,438 [trainer.py] => Average Accuracy (NME): 97.07
2024-09-05 03:13:13,440 [trainer.py] => All params: 171685717
2024-09-05 03:13:13,441 [trainer.py] => Trainable params: 85867836
2024-09-05 03:13:14,940 [foster.py] => Learning on 30-35
2024-09-05 03:13:14,942 [foster.py] => All params: 171701092
2024-09-05 03:13:14,943 [foster.py] => Trainable params: 85879366
2024-09-05 03:13:15,013 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 4.255, Loss_clf 0.967, Loss_fe 1.437, Loss_kd 1.586, Train_accy 61.32, Test_accy 89.74:   0%|          | 0/20 [00:51<?, ?it/s]
Task 6, Epoch 1/20 => Loss 4.255, Loss_clf 0.967, Loss_fe 1.437, Loss_kd 1.586, Train_accy 61.32, Test_accy 89.74:   5%|▌         | 1/20 [00:51<16:13, 51.23s/it]
Task 6, Epoch 2/20 => Loss 3.074, Loss_clf 0.438, Loss_fe 0.813, Loss_kd 1.562, Train_accy 66.39:   5%|▌         | 1/20 [01:22<16:13, 51.23s/it]                 
Task 6, Epoch 2/20 => Loss 3.074, Loss_clf 0.438, Loss_fe 0.813, Loss_kd 1.562, Train_accy 66.39:  10%|█         | 2/20 [01:22<11:55, 39.75s/it]
Task 6, Epoch 3/20 => Loss 2.767, Loss_clf 0.398, Loss_fe 0.567, Loss_kd 1.545, Train_accy 69.03:  10%|█         | 2/20 [01:54<11:55, 39.75s/it]
Task 6, Epoch 3/20 => Loss 2.767, Loss_clf 0.398, Loss_fe 0.567, Loss_kd 1.545, Train_accy 69.03:  15%|█▌        | 3/20 [01:54<10:13, 36.10s/it]
Task 6, Epoch 4/20 => Loss 2.640, Loss_clf 0.360, Loss_fe 0.482, Loss_kd 1.540, Train_accy 69.71:  15%|█▌        | 3/20 [02:26<10:13, 36.10s/it]
Task 6, Epoch 4/20 => Loss 2.640, Loss_clf 0.360, Loss_fe 0.482, Loss_kd 1.540, Train_accy 69.71:  20%|██        | 4/20 [02:26<09:10, 34.39s/it]
Task 6, Epoch 5/20 => Loss 2.496, Loss_clf 0.303, Loss_fe 0.389, Loss_kd 1.547, Train_accy 73.68:  20%|██        | 4/20 [02:58<09:10, 34.39s/it]
Task 6, Epoch 5/20 => Loss 2.496, Loss_clf 0.303, Loss_fe 0.389, Loss_kd 1.547, Train_accy 73.68:  25%|██▌       | 5/20 [02:58<08:21, 33.46s/it]
Task 6, Epoch 6/20 => Loss 2.488, Loss_clf 0.312, Loss_fe 0.369, Loss_kd 1.549, Train_accy 73.00, Test_accy 92.06:  25%|██▌       | 5/20 [03:49<08:21, 33.46s/it]
Task 6, Epoch 6/20 => Loss 2.488, Loss_clf 0.312, Loss_fe 0.369, Loss_kd 1.549, Train_accy 73.00, Test_accy 92.06:  30%|███       | 6/20 [03:49<09:13, 39.55s/it]
Task 6, Epoch 7/20 => Loss 2.441, Loss_clf 0.284, Loss_fe 0.335, Loss_kd 1.561, Train_accy 76.19:  30%|███       | 6/20 [04:21<09:13, 39.55s/it]                 
Task 6, Epoch 7/20 => Loss 2.441, Loss_clf 0.284, Loss_fe 0.335, Loss_kd 1.561, Train_accy 76.19:  35%|███▌      | 7/20 [04:21<08:01, 37.02s/it]
Task 6, Epoch 8/20 => Loss 2.300, Loss_clf 0.241, Loss_fe 0.273, Loss_kd 1.531, Train_accy 77.87:  35%|███▌      | 7/20 [04:53<08:01, 37.02s/it]
Task 6, Epoch 8/20 => Loss 2.300, Loss_clf 0.241, Loss_fe 0.273, Loss_kd 1.531, Train_accy 77.87:  40%|████      | 8/20 [04:53<07:04, 35.36s/it]
Task 6, Epoch 9/20 => Loss 2.352, Loss_clf 0.257, Loss_fe 0.292, Loss_kd 1.545, Train_accy 76.45:  40%|████      | 8/20 [05:24<07:04, 35.36s/it]
Task 6, Epoch 9/20 => Loss 2.352, Loss_clf 0.257, Loss_fe 0.292, Loss_kd 1.545, Train_accy 76.45:  45%|████▌     | 9/20 [05:24<06:16, 34.22s/it]
Task 6, Epoch 10/20 => Loss 2.319, Loss_clf 0.242, Loss_fe 0.275, Loss_kd 1.544, Train_accy 79.84:  45%|████▌     | 9/20 [05:56<06:16, 34.22s/it]
Task 6, Epoch 10/20 => Loss 2.319, Loss_clf 0.242, Loss_fe 0.275, Loss_kd 1.544, Train_accy 79.84:  50%|█████     | 10/20 [05:56<05:34, 33.47s/it]
Task 6, Epoch 11/20 => Loss 2.347, Loss_clf 0.253, Loss_fe 0.287, Loss_kd 1.550, Train_accy 78.61, Test_accy 92.03:  50%|█████     | 10/20 [06:48<05:34, 33.47s/it]
Task 6, Epoch 11/20 => Loss 2.347, Loss_clf 0.253, Loss_fe 0.287, Loss_kd 1.550, Train_accy 78.61, Test_accy 92.03:  55%|█████▌    | 11/20 [06:48<05:50, 38.97s/it]
Task 6, Epoch 12/20 => Loss 2.192, Loss_clf 0.202, Loss_fe 0.206, Loss_kd 1.530, Train_accy 81.87:  55%|█████▌    | 11/20 [07:19<05:50, 38.97s/it]                 
Task 6, Epoch 12/20 => Loss 2.192, Loss_clf 0.202, Loss_fe 0.206, Loss_kd 1.530, Train_accy 81.87:  60%|██████    | 12/20 [07:19<04:54, 36.77s/it]
Task 6, Epoch 13/20 => Loss 2.269, Loss_clf 0.225, Loss_fe 0.220, Loss_kd 1.563, Train_accy 79.10:  60%|██████    | 12/20 [07:51<04:54, 36.77s/it]
Task 6, Epoch 13/20 => Loss 2.269, Loss_clf 0.225, Loss_fe 0.220, Loss_kd 1.563, Train_accy 79.10:  65%|██████▌   | 13/20 [07:51<04:06, 35.24s/it]
Task 6, Epoch 14/20 => Loss 2.177, Loss_clf 0.189, Loss_fe 0.191, Loss_kd 1.541, Train_accy 81.87:  65%|██████▌   | 13/20 [08:23<04:06, 35.24s/it]
Task 6, Epoch 14/20 => Loss 2.177, Loss_clf 0.189, Loss_fe 0.191, Loss_kd 1.541, Train_accy 81.87:  70%|███████   | 14/20 [08:23<03:25, 34.18s/it]
Task 6, Epoch 15/20 => Loss 2.263, Loss_clf 0.232, Loss_fe 0.213, Loss_kd 1.559, Train_accy 82.29:  70%|███████   | 14/20 [08:55<03:25, 34.18s/it]
Task 6, Epoch 15/20 => Loss 2.263, Loss_clf 0.232, Loss_fe 0.213, Loss_kd 1.559, Train_accy 82.29:  75%|███████▌  | 15/20 [08:55<02:47, 33.46s/it]
Task 6, Epoch 16/20 => Loss 2.207, Loss_clf 0.204, Loss_fe 0.193, Loss_kd 1.551, Train_accy 82.06, Test_accy 92.40:  75%|███████▌  | 15/20 [09:46<02:47, 33.46s/it]
Task 6, Epoch 16/20 => Loss 2.207, Loss_clf 0.204, Loss_fe 0.193, Loss_kd 1.551, Train_accy 82.06, Test_accy 92.40:  80%|████████  | 16/20 [09:46<02:35, 38.85s/it]
Task 6, Epoch 17/20 => Loss 2.172, Loss_clf 0.192, Loss_fe 0.186, Loss_kd 1.538, Train_accy 82.84:  80%|████████  | 16/20 [10:18<02:35, 38.85s/it]                 
Task 6, Epoch 17/20 => Loss 2.172, Loss_clf 0.192, Loss_fe 0.186, Loss_kd 1.538, Train_accy 82.84:  85%|████████▌ | 17/20 [10:18<01:50, 36.71s/it]
Task 6, Epoch 18/20 => Loss 2.208, Loss_clf 0.198, Loss_fe 0.190, Loss_kd 1.560, Train_accy 83.68:  85%|████████▌ | 17/20 [10:50<01:50, 36.71s/it]
Task 6, Epoch 18/20 => Loss 2.208, Loss_clf 0.198, Loss_fe 0.190, Loss_kd 1.560, Train_accy 83.68:  90%|█████████ | 18/20 [10:50<01:10, 35.22s/it]
Task 6, Epoch 19/20 => Loss 2.181, Loss_clf 0.184, Loss_fe 0.181, Loss_kd 1.557, Train_accy 82.94:  90%|█████████ | 18/20 [11:21<01:10, 35.22s/it]
Task 6, Epoch 19/20 => Loss 2.181, Loss_clf 0.184, Loss_fe 0.181, Loss_kd 1.557, Train_accy 82.94:  95%|█████████▌| 19/20 [11:21<00:34, 34.19s/it]
Task 6, Epoch 20/20 => Loss 2.156, Loss_clf 0.183, Loss_fe 0.163, Loss_kd 1.552, Train_accy 82.81:  95%|█████████▌| 19/20 [11:53<00:34, 34.19s/it]
Task 6, Epoch 20/20 => Loss 2.156, Loss_clf 0.183, Loss_fe 0.163, Loss_kd 1.552, Train_accy 82.81: 100%|██████████| 20/20 [11:53<00:00, 33.45s/it]
Task 6, Epoch 20/20 => Loss 2.156, Loss_clf 0.183, Loss_fe 0.163, Loss_kd 1.552, Train_accy 82.81: 100%|██████████| 20/20 [11:53<00:00, 35.68s/it]
2024-09-05 03:25:08,584 [foster.py] => Task 6, Epoch 20/20 => Loss 2.156, Loss_clf 0.183, Loss_fe 0.163, Loss_kd 1.552, Train_accy 82.81
2024-09-05 03:25:08,585 [foster.py] => do not weight align teacher!
2024-09-05 03:25:08,588 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.691,  Train_accy 57.52, Test_accy 90.91:   0%|          | 0/20 [00:50<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.691,  Train_accy 57.52, Test_accy 90.91:   5%|▌         | 1/20 [00:50<15:53, 50.17s/it]
SNet: Task 6, Epoch 2/20 => Loss 1.522,  Train_accy 65.55:   5%|▌         | 1/20 [01:30<15:53, 50.17s/it]                 
SNet: Task 6, Epoch 2/20 => Loss 1.522,  Train_accy 65.55:  10%|█         | 2/20 [01:30<13:15, 44.18s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.482,  Train_accy 66.58:  10%|█         | 2/20 [02:10<13:15, 44.18s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.482,  Train_accy 66.58:  15%|█▌        | 3/20 [02:10<11:58, 42.25s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.486,  Train_accy 67.65:  15%|█▌        | 3/20 [02:50<11:58, 42.25s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.486,  Train_accy 67.65:  20%|██        | 4/20 [02:50<11:01, 41.32s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.482,  Train_accy 66.90:  20%|██        | 4/20 [03:30<11:01, 41.32s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.482,  Train_accy 66.90:  25%|██▌       | 5/20 [03:30<10:12, 40.85s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.466,  Train_accy 67.23, Test_accy 90.89:  25%|██▌       | 5/20 [04:20<10:12, 40.85s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.466,  Train_accy 67.23, Test_accy 90.89:  30%|███       | 6/20 [04:20<10:16, 44.06s/it]
SNet: Task 6, Epoch 7/20 => Loss 1.477,  Train_accy 67.03:  30%|███       | 6/20 [05:00<10:16, 44.06s/it]                 
SNet: Task 6, Epoch 7/20 => Loss 1.477,  Train_accy 67.03:  35%|███▌      | 7/20 [05:00<09:15, 42.72s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.473,  Train_accy 68.00:  35%|███▌      | 7/20 [05:40<09:15, 42.72s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.473,  Train_accy 68.00:  40%|████      | 8/20 [05:40<08:22, 41.85s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.477,  Train_accy 66.97:  40%|████      | 8/20 [06:20<08:22, 41.85s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.477,  Train_accy 66.97:  45%|████▌     | 9/20 [06:20<07:33, 41.26s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.468,  Train_accy 68.68:  45%|████▌     | 9/20 [07:00<07:33, 41.26s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.468,  Train_accy 68.68:  50%|█████     | 10/20 [07:00<06:48, 40.84s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.476,  Train_accy 68.19, Test_accy 90.71:  50%|█████     | 10/20 [07:50<06:48, 40.84s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.476,  Train_accy 68.19, Test_accy 90.71:  55%|█████▌    | 11/20 [07:50<06:33, 43.73s/it]
SNet: Task 6, Epoch 12/20 => Loss 1.480,  Train_accy 67.97:  55%|█████▌    | 11/20 [08:30<06:33, 43.73s/it]                 
SNet: Task 6, Epoch 12/20 => Loss 1.480,  Train_accy 67.97:  60%|██████    | 12/20 [08:30<05:40, 42.58s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.486,  Train_accy 67.19:  60%|██████    | 12/20 [09:10<05:40, 42.58s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.486,  Train_accy 67.19:  65%|██████▌   | 13/20 [09:10<04:52, 41.78s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.465,  Train_accy 68.45:  65%|██████▌   | 13/20 [09:50<04:52, 41.78s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.465,  Train_accy 68.45:  70%|███████   | 14/20 [09:50<04:07, 41.24s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.467,  Train_accy 67.68:  70%|███████   | 14/20 [10:30<04:07, 41.24s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.467,  Train_accy 67.68:  75%|███████▌  | 15/20 [10:30<03:24, 40.85s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.460,  Train_accy 68.00, Test_accy 90.89:  75%|███████▌  | 15/20 [11:20<03:24, 40.85s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.460,  Train_accy 68.00, Test_accy 90.89:  80%|████████  | 16/20 [11:20<02:54, 43.67s/it]
SNet: Task 6, Epoch 17/20 => Loss 1.478,  Train_accy 67.55:  80%|████████  | 16/20 [12:00<02:54, 43.67s/it]                 
SNet: Task 6, Epoch 17/20 => Loss 1.478,  Train_accy 67.55:  85%|████████▌ | 17/20 [12:00<02:07, 42.56s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.491,  Train_accy 68.52:  85%|████████▌ | 17/20 [12:40<02:07, 42.56s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.491,  Train_accy 68.52:  90%|█████████ | 18/20 [12:40<01:23, 41.79s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.449,  Train_accy 67.84:  90%|█████████ | 18/20 [13:20<01:23, 41.79s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.449,  Train_accy 67.84:  95%|█████████▌| 19/20 [13:20<00:41, 41.23s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.468,  Train_accy 68.32:  95%|█████████▌| 19/20 [14:00<00:41, 41.23s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.468,  Train_accy 68.32: 100%|██████████| 20/20 [14:00<00:00, 40.85s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.468,  Train_accy 68.32: 100%|██████████| 20/20 [14:00<00:00, 42.01s/it]
2024-09-05 03:39:10,423 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.468,  Train_accy 68.32
2024-09-05 03:39:10,424 [foster.py] => do not weight align student!
2024-09-05 03:39:20,696 [foster.py] => darknet eval: 
2024-09-05 03:39:20,697 [foster.py] => CNN top1 curve: 90.97
2024-09-05 03:39:20,697 [foster.py] => CNN top5 curve: 99.49
2024-09-05 03:39:20,699 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 03:40:27,277 [foster.py] => Exemplar size: 700
2024-09-05 03:40:27,277 [trainer.py] => CNN: {'total': 92.57, '00-04': 97.8, '05-09': 93.6, '10-14': 95.8, '15-19': 93.4, '20-24': 95.6, '25-29': 91.0, '30-34': 80.8, 'old': 94.53, 'new': 80.8}
2024-09-05 03:40:27,277 [trainer.py] => NME: {'total': 93.94, '00-04': 98.4, '05-09': 90.0, '10-14': 92.0, '15-19': 92.0, '20-24': 96.6, '25-29': 95.0, '30-34': 93.6, 'old': 94.0, 'new': 93.6}
2024-09-05 03:40:27,277 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57]
2024-09-05 03:40:27,277 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54]
2024-09-05 03:40:27,277 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94]
2024-09-05 03:40:27,277 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63]

Average Accuracy (CNN): 95.99
Average Accuracy (NME): 96.62
2024-09-05 03:40:27,277 [trainer.py] => Average Accuracy (CNN): 95.99
2024-09-05 03:40:27,277 [trainer.py] => Average Accuracy (NME): 96.62
2024-09-05 03:40:27,279 [trainer.py] => All params: 171701092
2024-09-05 03:40:27,280 [trainer.py] => Trainable params: 85879366
2024-09-05 03:40:28,702 [foster.py] => Learning on 35-40
2024-09-05 03:40:28,704 [foster.py] => All params: 171716467
2024-09-05 03:40:28,705 [foster.py] => Trainable params: 85890896
2024-09-05 03:40:28,782 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 4.226, Loss_clf 0.809, Loss_fe 1.436, Loss_kd 1.734, Train_accy 68.50, Test_accy 91.02:   0%|          | 0/20 [00:54<?, ?it/s]
Task 7, Epoch 1/20 => Loss 4.226, Loss_clf 0.809, Loss_fe 1.436, Loss_kd 1.734, Train_accy 68.50, Test_accy 91.02:   5%|▌         | 1/20 [00:54<17:24, 54.96s/it]
Task 7, Epoch 2/20 => Loss 3.055, Loss_clf 0.331, Loss_fe 0.769, Loss_kd 1.711, Train_accy 75.34:   5%|▌         | 1/20 [01:27<17:24, 54.96s/it]                 
Task 7, Epoch 2/20 => Loss 3.055, Loss_clf 0.331, Loss_fe 0.769, Loss_kd 1.711, Train_accy 75.34:  10%|█         | 2/20 [01:27<12:33, 41.88s/it]
Task 7, Epoch 3/20 => Loss 2.742, Loss_clf 0.291, Loss_fe 0.508, Loss_kd 1.700, Train_accy 77.34:  10%|█         | 2/20 [02:00<12:33, 41.88s/it]
Task 7, Epoch 3/20 => Loss 2.742, Loss_clf 0.291, Loss_fe 0.508, Loss_kd 1.700, Train_accy 77.34:  15%|█▌        | 3/20 [02:00<10:41, 37.73s/it]
Task 7, Epoch 4/20 => Loss 2.642, Loss_clf 0.274, Loss_fe 0.418, Loss_kd 1.706, Train_accy 78.53:  15%|█▌        | 3/20 [02:33<10:41, 37.73s/it]
Task 7, Epoch 4/20 => Loss 2.642, Loss_clf 0.274, Loss_fe 0.418, Loss_kd 1.706, Train_accy 78.53:  20%|██        | 4/20 [02:33<09:32, 35.79s/it]
Task 7, Epoch 5/20 => Loss 2.589, Loss_clf 0.261, Loss_fe 0.376, Loss_kd 1.707, Train_accy 78.81:  20%|██        | 4/20 [03:06<09:32, 35.79s/it]
Task 7, Epoch 5/20 => Loss 2.589, Loss_clf 0.261, Loss_fe 0.376, Loss_kd 1.707, Train_accy 78.81:  25%|██▌       | 5/20 [03:06<08:40, 34.70s/it]
Task 7, Epoch 6/20 => Loss 2.530, Loss_clf 0.256, Loss_fe 0.334, Loss_kd 1.698, Train_accy 79.28, Test_accy 92.32:  25%|██▌       | 5/20 [04:01<08:40, 34.70s/it]
Task 7, Epoch 6/20 => Loss 2.530, Loss_clf 0.256, Loss_fe 0.334, Loss_kd 1.698, Train_accy 79.28, Test_accy 92.32:  30%|███       | 6/20 [04:01<09:43, 41.64s/it]
Task 7, Epoch 7/20 => Loss 2.533, Loss_clf 0.253, Loss_fe 0.338, Loss_kd 1.700, Train_accy 78.56:  30%|███       | 6/20 [04:33<09:43, 41.64s/it]                 
Task 7, Epoch 7/20 => Loss 2.533, Loss_clf 0.253, Loss_fe 0.338, Loss_kd 1.700, Train_accy 78.56:  35%|███▌      | 7/20 [04:33<08:23, 38.73s/it]
Task 7, Epoch 8/20 => Loss 2.433, Loss_clf 0.222, Loss_fe 0.279, Loss_kd 1.690, Train_accy 81.44:  35%|███▌      | 7/20 [05:06<08:23, 38.73s/it]
Task 7, Epoch 8/20 => Loss 2.433, Loss_clf 0.222, Loss_fe 0.279, Loss_kd 1.690, Train_accy 81.44:  40%|████      | 8/20 [05:06<07:22, 36.84s/it]
Task 7, Epoch 9/20 => Loss 2.409, Loss_clf 0.218, Loss_fe 0.263, Loss_kd 1.688, Train_accy 81.38:  40%|████      | 8/20 [05:39<07:22, 36.84s/it]
Task 7, Epoch 9/20 => Loss 2.409, Loss_clf 0.218, Loss_fe 0.263, Loss_kd 1.688, Train_accy 81.38:  45%|████▌     | 9/20 [05:39<06:31, 35.57s/it]
Task 7, Epoch 10/20 => Loss 2.462, Loss_clf 0.231, Loss_fe 0.272, Loss_kd 1.714, Train_accy 81.28:  45%|████▌     | 9/20 [06:12<06:31, 35.57s/it]
Task 7, Epoch 10/20 => Loss 2.462, Loss_clf 0.231, Loss_fe 0.272, Loss_kd 1.714, Train_accy 81.28:  50%|█████     | 10/20 [06:12<05:47, 34.75s/it]
Task 7, Epoch 11/20 => Loss 2.407, Loss_clf 0.223, Loss_fe 0.245, Loss_kd 1.696, Train_accy 82.66, Test_accy 92.05:  50%|█████     | 10/20 [07:07<05:47, 34.75s/it]
Task 7, Epoch 11/20 => Loss 2.407, Loss_clf 0.223, Loss_fe 0.245, Loss_kd 1.696, Train_accy 82.66, Test_accy 92.05:  55%|█████▌    | 11/20 [07:07<06:09, 41.00s/it]
Task 7, Epoch 12/20 => Loss 2.384, Loss_clf 0.218, Loss_fe 0.227, Loss_kd 1.696, Train_accy 81.50:  55%|█████▌    | 11/20 [07:40<06:09, 41.00s/it]                 
Task 7, Epoch 12/20 => Loss 2.384, Loss_clf 0.218, Loss_fe 0.227, Loss_kd 1.696, Train_accy 81.50:  60%|██████    | 12/20 [07:40<05:08, 38.53s/it]
Task 7, Epoch 13/20 => Loss 2.344, Loss_clf 0.197, Loss_fe 0.197, Loss_kd 1.707, Train_accy 84.44:  60%|██████    | 12/20 [08:13<05:08, 38.53s/it]
Task 7, Epoch 13/20 => Loss 2.344, Loss_clf 0.197, Loss_fe 0.197, Loss_kd 1.707, Train_accy 84.44:  65%|██████▌   | 13/20 [08:13<04:17, 36.79s/it]
Task 7, Epoch 14/20 => Loss 2.347, Loss_clf 0.194, Loss_fe 0.210, Loss_kd 1.699, Train_accy 84.56:  65%|██████▌   | 13/20 [08:46<04:17, 36.79s/it]
Task 7, Epoch 14/20 => Loss 2.347, Loss_clf 0.194, Loss_fe 0.210, Loss_kd 1.699, Train_accy 84.56:  70%|███████   | 14/20 [08:46<03:33, 35.59s/it]
Task 7, Epoch 15/20 => Loss 2.436, Loss_clf 0.233, Loss_fe 0.236, Loss_kd 1.721, Train_accy 82.09:  70%|███████   | 14/20 [09:18<03:33, 35.59s/it]
Task 7, Epoch 15/20 => Loss 2.436, Loss_clf 0.233, Loss_fe 0.236, Loss_kd 1.721, Train_accy 82.09:  75%|███████▌  | 15/20 [09:18<02:53, 34.74s/it]
Task 7, Epoch 16/20 => Loss 2.326, Loss_clf 0.196, Loss_fe 0.185, Loss_kd 1.702, Train_accy 84.81, Test_accy 92.55:  75%|███████▌  | 15/20 [10:13<02:53, 34.74s/it]
Task 7, Epoch 16/20 => Loss 2.326, Loss_clf 0.196, Loss_fe 0.185, Loss_kd 1.702, Train_accy 84.81, Test_accy 92.55:  80%|████████  | 16/20 [10:13<02:43, 40.88s/it]
Task 7, Epoch 17/20 => Loss 2.295, Loss_clf 0.184, Loss_fe 0.165, Loss_kd 1.703, Train_accy 85.72:  80%|████████  | 16/20 [10:46<02:43, 40.88s/it]                 
Task 7, Epoch 17/20 => Loss 2.295, Loss_clf 0.184, Loss_fe 0.165, Loss_kd 1.703, Train_accy 85.72:  85%|████████▌ | 17/20 [10:46<01:55, 38.44s/it]
Task 7, Epoch 18/20 => Loss 2.274, Loss_clf 0.170, Loss_fe 0.169, Loss_kd 1.693, Train_accy 85.56:  85%|████████▌ | 17/20 [11:19<01:55, 38.44s/it]
Task 7, Epoch 18/20 => Loss 2.274, Loss_clf 0.170, Loss_fe 0.169, Loss_kd 1.693, Train_accy 85.56:  90%|█████████ | 18/20 [11:19<01:13, 36.76s/it]
Task 7, Epoch 19/20 => Loss 2.321, Loss_clf 0.203, Loss_fe 0.170, Loss_kd 1.704, Train_accy 84.75:  90%|█████████ | 18/20 [11:52<01:13, 36.76s/it]
Task 7, Epoch 19/20 => Loss 2.321, Loss_clf 0.203, Loss_fe 0.170, Loss_kd 1.704, Train_accy 84.75:  95%|█████████▌| 19/20 [11:52<00:35, 35.59s/it]
Task 7, Epoch 20/20 => Loss 2.270, Loss_clf 0.177, Loss_fe 0.159, Loss_kd 1.692, Train_accy 85.47:  95%|█████████▌| 19/20 [12:25<00:35, 35.59s/it]
Task 7, Epoch 20/20 => Loss 2.270, Loss_clf 0.177, Loss_fe 0.159, Loss_kd 1.692, Train_accy 85.47: 100%|██████████| 20/20 [12:25<00:00, 34.75s/it]
Task 7, Epoch 20/20 => Loss 2.270, Loss_clf 0.177, Loss_fe 0.159, Loss_kd 1.692, Train_accy 85.47: 100%|██████████| 20/20 [12:25<00:00, 37.26s/it]
2024-09-05 03:52:54,005 [foster.py] => Task 7, Epoch 20/20 => Loss 2.270, Loss_clf 0.177, Loss_fe 0.159, Loss_kd 1.692, Train_accy 85.47
2024-09-05 03:52:54,006 [foster.py] => do not weight align teacher!
2024-09-05 03:52:54,009 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.848,  Train_accy 64.38, Test_accy 92.30:   0%|          | 0/20 [00:52<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.848,  Train_accy 64.38, Test_accy 92.30:   5%|▌         | 1/20 [00:52<16:44, 52.88s/it]
SNet: Task 7, Epoch 2/20 => Loss 1.606,  Train_accy 72.88:   5%|▌         | 1/20 [01:34<16:44, 52.88s/it]                 
SNet: Task 7, Epoch 2/20 => Loss 1.606,  Train_accy 72.88:  10%|█         | 2/20 [01:34<13:48, 46.03s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.638,  Train_accy 71.53:  10%|█         | 2/20 [02:15<13:48, 46.03s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.638,  Train_accy 71.53:  15%|█▌        | 3/20 [02:15<12:25, 43.84s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.610,  Train_accy 72.44:  15%|█▌        | 3/20 [02:56<12:25, 43.84s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.610,  Train_accy 72.44:  20%|██        | 4/20 [02:56<11:25, 42.82s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.616,  Train_accy 72.56:  20%|██        | 4/20 [03:37<11:25, 42.82s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.616,  Train_accy 72.56:  25%|██▌       | 5/20 [03:37<10:33, 42.26s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.616,  Train_accy 72.84, Test_accy 92.28:  25%|██▌       | 5/20 [04:30<10:33, 42.26s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.616,  Train_accy 72.84, Test_accy 92.28:  30%|███       | 6/20 [04:30<10:42, 45.88s/it]
SNet: Task 7, Epoch 7/20 => Loss 1.617,  Train_accy 72.69:  30%|███       | 6/20 [05:11<10:42, 45.88s/it]                 
SNet: Task 7, Epoch 7/20 => Loss 1.617,  Train_accy 72.69:  35%|███▌      | 7/20 [05:11<09:36, 44.35s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.612,  Train_accy 73.03:  35%|███▌      | 7/20 [05:53<09:36, 44.35s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.612,  Train_accy 73.03:  40%|████      | 8/20 [05:53<08:40, 43.35s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.595,  Train_accy 72.94:  40%|████      | 8/20 [06:34<08:40, 43.35s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.595,  Train_accy 72.94:  45%|████▌     | 9/20 [06:34<07:49, 42.68s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.588,  Train_accy 72.66:  45%|████▌     | 9/20 [07:15<07:49, 42.68s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.588,  Train_accy 72.66:  50%|█████     | 10/20 [07:15<07:02, 42.23s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.596,  Train_accy 73.44, Test_accy 92.15:  50%|█████     | 10/20 [08:08<07:02, 42.23s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.596,  Train_accy 73.44, Test_accy 92.15:  55%|█████▌    | 11/20 [08:08<06:49, 45.51s/it]
SNet: Task 7, Epoch 12/20 => Loss 1.609,  Train_accy 73.53:  55%|█████▌    | 11/20 [08:49<06:49, 45.51s/it]                 
SNet: Task 7, Epoch 12/20 => Loss 1.609,  Train_accy 73.53:  60%|██████    | 12/20 [08:49<05:53, 44.20s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.603,  Train_accy 73.56:  60%|██████    | 12/20 [09:30<05:53, 44.20s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.603,  Train_accy 73.56:  65%|██████▌   | 13/20 [09:30<05:03, 43.30s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.593,  Train_accy 73.72:  65%|██████▌   | 13/20 [10:12<05:03, 43.30s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.593,  Train_accy 73.72:  70%|███████   | 14/20 [10:12<04:15, 42.66s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.601,  Train_accy 73.53:  70%|███████   | 14/20 [10:53<04:15, 42.66s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.601,  Train_accy 73.53:  75%|███████▌  | 15/20 [10:53<03:31, 42.22s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.605,  Train_accy 73.44, Test_accy 92.22:  75%|███████▌  | 15/20 [11:46<03:31, 42.22s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.605,  Train_accy 73.44, Test_accy 92.22:  80%|████████  | 16/20 [11:46<03:01, 45.44s/it]
SNet: Task 7, Epoch 17/20 => Loss 1.586,  Train_accy 73.97:  80%|████████  | 16/20 [12:27<03:01, 45.44s/it]                 
SNet: Task 7, Epoch 17/20 => Loss 1.586,  Train_accy 73.97:  85%|████████▌ | 17/20 [12:27<02:12, 44.18s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.612,  Train_accy 72.91:  85%|████████▌ | 17/20 [13:08<02:12, 44.18s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.612,  Train_accy 72.91:  90%|█████████ | 18/20 [13:08<01:26, 43.29s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.587,  Train_accy 73.41:  90%|█████████ | 18/20 [13:50<01:26, 43.29s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.587,  Train_accy 73.41:  95%|█████████▌| 19/20 [13:50<00:42, 42.69s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.590,  Train_accy 73.62:  95%|█████████▌| 19/20 [14:31<00:42, 42.69s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.590,  Train_accy 73.62: 100%|██████████| 20/20 [14:31<00:00, 42.29s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.590,  Train_accy 73.62: 100%|██████████| 20/20 [14:31<00:00, 43.57s/it]
2024-09-05 04:07:26,977 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 1.590,  Train_accy 73.62
2024-09-05 04:07:26,977 [foster.py] => do not weight align student!
2024-09-05 04:07:38,754 [foster.py] => darknet eval: 
2024-09-05 04:07:38,755 [foster.py] => CNN top1 curve: 92.22
2024-09-05 04:07:38,755 [foster.py] => CNN top5 curve: 99.52
2024-09-05 04:07:38,758 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 04:08:52,914 [foster.py] => Exemplar size: 800
2024-09-05 04:08:52,914 [trainer.py] => CNN: {'total': 92.52, '00-04': 97.6, '05-09': 93.4, '10-14': 93.6, '15-19': 94.2, '20-24': 96.0, '25-29': 92.0, '30-34': 83.4, '35-39': 90.0, 'old': 92.89, 'new': 90.0}
2024-09-05 04:08:52,914 [trainer.py] => NME: {'total': 93.65, '00-04': 96.8, '05-09': 90.8, '10-14': 92.4, '15-19': 92.4, '20-24': 96.6, '25-29': 92.4, '30-34': 90.2, '35-39': 97.6, 'old': 93.09, 'new': 97.6}
2024-09-05 04:08:52,914 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52]
2024-09-05 04:08:52,914 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48]
2024-09-05 04:08:52,914 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65]
2024-09-05 04:08:52,914 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62]

Average Accuracy (CNN): 95.56
Average Accuracy (NME): 96.25
2024-09-05 04:08:52,914 [trainer.py] => Average Accuracy (CNN): 95.56
2024-09-05 04:08:52,915 [trainer.py] => Average Accuracy (NME): 96.25
2024-09-05 04:08:52,916 [trainer.py] => All params: 171716467
2024-09-05 04:08:52,917 [trainer.py] => Trainable params: 85890896
2024-09-05 04:08:54,417 [foster.py] => Learning on 40-45
2024-09-05 04:08:54,418 [foster.py] => All params: 171731842
2024-09-05 04:08:54,419 [foster.py] => Trainable params: 85902426
2024-09-05 04:08:54,493 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 4.409, Loss_clf 0.713, Loss_fe 1.558, Loss_kd 1.900, Train_accy 68.48, Test_accy 90.89:   0%|          | 0/20 [00:58<?, ?it/s]
Task 8, Epoch 1/20 => Loss 4.409, Loss_clf 0.713, Loss_fe 1.558, Loss_kd 1.900, Train_accy 68.48, Test_accy 90.89:   5%|▌         | 1/20 [00:58<18:37, 58.81s/it]
Task 8, Epoch 2/20 => Loss 3.373, Loss_clf 0.419, Loss_fe 0.812, Loss_kd 1.903, Train_accy 73.55:   5%|▌         | 1/20 [01:32<18:37, 58.81s/it]                 
Task 8, Epoch 2/20 => Loss 3.373, Loss_clf 0.419, Loss_fe 0.812, Loss_kd 1.903, Train_accy 73.55:  10%|█         | 2/20 [01:32<13:14, 44.13s/it]
Task 8, Epoch 3/20 => Loss 3.098, Loss_clf 0.370, Loss_fe 0.590, Loss_kd 1.899, Train_accy 73.30:  10%|█         | 2/20 [02:06<13:14, 44.13s/it]
Task 8, Epoch 3/20 => Loss 3.098, Loss_clf 0.370, Loss_fe 0.590, Loss_kd 1.899, Train_accy 73.30:  15%|█▌        | 3/20 [02:06<11:10, 39.42s/it]
Task 8, Epoch 4/20 => Loss 2.894, Loss_clf 0.317, Loss_fe 0.470, Loss_kd 1.874, Train_accy 75.18:  15%|█▌        | 3/20 [02:40<11:10, 39.42s/it]
Task 8, Epoch 4/20 => Loss 2.894, Loss_clf 0.317, Loss_fe 0.470, Loss_kd 1.874, Train_accy 75.18:  20%|██        | 4/20 [02:40<09:55, 37.22s/it]
Task 8, Epoch 5/20 => Loss 2.903, Loss_clf 0.313, Loss_fe 0.475, Loss_kd 1.880, Train_accy 76.61:  20%|██        | 4/20 [03:14<09:55, 37.22s/it]
Task 8, Epoch 5/20 => Loss 2.903, Loss_clf 0.313, Loss_fe 0.475, Loss_kd 1.880, Train_accy 76.61:  25%|██▌       | 5/20 [03:14<09:00, 36.02s/it]
Task 8, Epoch 6/20 => Loss 2.749, Loss_clf 0.271, Loss_fe 0.363, Loss_kd 1.880, Train_accy 77.82, Test_accy 91.96:  25%|██▌       | 5/20 [04:13<09:00, 36.02s/it]
Task 8, Epoch 6/20 => Loss 2.749, Loss_clf 0.271, Loss_fe 0.363, Loss_kd 1.880, Train_accy 77.82, Test_accy 91.96:  30%|███       | 6/20 [04:13<10:14, 43.86s/it]
Task 8, Epoch 7/20 => Loss 2.741, Loss_clf 0.282, Loss_fe 0.359, Loss_kd 1.867, Train_accy 76.64:  30%|███       | 6/20 [04:47<10:14, 43.86s/it]                 
Task 8, Epoch 7/20 => Loss 2.741, Loss_clf 0.282, Loss_fe 0.359, Loss_kd 1.867, Train_accy 76.64:  35%|███▌      | 7/20 [04:47<08:47, 40.62s/it]
Task 8, Epoch 8/20 => Loss 2.730, Loss_clf 0.282, Loss_fe 0.328, Loss_kd 1.885, Train_accy 79.09:  35%|███▌      | 7/20 [05:21<08:47, 40.62s/it]
Task 8, Epoch 8/20 => Loss 2.730, Loss_clf 0.282, Loss_fe 0.328, Loss_kd 1.885, Train_accy 79.09:  40%|████      | 8/20 [05:21<07:41, 38.46s/it]
Task 8, Epoch 9/20 => Loss 2.686, Loss_clf 0.258, Loss_fe 0.310, Loss_kd 1.882, Train_accy 80.73:  40%|████      | 8/20 [05:54<07:41, 38.46s/it]
Task 8, Epoch 9/20 => Loss 2.686, Loss_clf 0.258, Loss_fe 0.310, Loss_kd 1.882, Train_accy 80.73:  45%|████▌     | 9/20 [05:54<06:46, 36.98s/it]
Task 8, Epoch 10/20 => Loss 2.604, Loss_clf 0.233, Loss_fe 0.277, Loss_kd 1.862, Train_accy 81.33:  45%|████▌     | 9/20 [06:28<06:46, 36.98s/it]
Task 8, Epoch 10/20 => Loss 2.604, Loss_clf 0.233, Loss_fe 0.277, Loss_kd 1.862, Train_accy 81.33:  50%|█████     | 10/20 [06:28<05:59, 35.98s/it]
Task 8, Epoch 11/20 => Loss 2.598, Loss_clf 0.236, Loss_fe 0.253, Loss_kd 1.875, Train_accy 81.09, Test_accy 92.11:  50%|█████     | 10/20 [07:27<05:59, 35.98s/it]
Task 8, Epoch 11/20 => Loss 2.598, Loss_clf 0.236, Loss_fe 0.253, Loss_kd 1.875, Train_accy 81.09, Test_accy 92.11:  55%|█████▌    | 11/20 [07:27<06:27, 43.00s/it]
Task 8, Epoch 12/20 => Loss 2.619, Loss_clf 0.246, Loss_fe 0.248, Loss_kd 1.889, Train_accy 82.24:  55%|█████▌    | 11/20 [08:01<06:27, 43.00s/it]                 
Task 8, Epoch 12/20 => Loss 2.619, Loss_clf 0.246, Loss_fe 0.248, Loss_kd 1.889, Train_accy 82.24:  60%|██████    | 12/20 [08:01<05:21, 40.20s/it]
Task 8, Epoch 13/20 => Loss 2.581, Loss_clf 0.227, Loss_fe 0.243, Loss_kd 1.876, Train_accy 81.91:  60%|██████    | 12/20 [08:35<05:21, 40.20s/it]
Task 8, Epoch 13/20 => Loss 2.581, Loss_clf 0.227, Loss_fe 0.243, Loss_kd 1.876, Train_accy 81.91:  65%|██████▌   | 13/20 [08:35<04:27, 38.27s/it]
Task 8, Epoch 14/20 => Loss 2.573, Loss_clf 0.220, Loss_fe 0.224, Loss_kd 1.893, Train_accy 83.03:  65%|██████▌   | 13/20 [09:08<04:27, 38.27s/it]
Task 8, Epoch 14/20 => Loss 2.573, Loss_clf 0.220, Loss_fe 0.224, Loss_kd 1.893, Train_accy 83.03:  70%|███████   | 14/20 [09:08<03:41, 36.93s/it]
Task 8, Epoch 15/20 => Loss 2.540, Loss_clf 0.218, Loss_fe 0.216, Loss_kd 1.872, Train_accy 82.52:  70%|███████   | 14/20 [09:42<03:41, 36.93s/it]
Task 8, Epoch 15/20 => Loss 2.540, Loss_clf 0.218, Loss_fe 0.216, Loss_kd 1.872, Train_accy 82.52:  75%|███████▌  | 15/20 [09:42<02:59, 35.98s/it]
Task 8, Epoch 16/20 => Loss 2.552, Loss_clf 0.219, Loss_fe 0.227, Loss_kd 1.872, Train_accy 82.42, Test_accy 92.38:  75%|███████▌  | 15/20 [10:41<02:59, 35.98s/it]
Task 8, Epoch 16/20 => Loss 2.552, Loss_clf 0.219, Loss_fe 0.227, Loss_kd 1.872, Train_accy 82.42, Test_accy 92.38:  80%|████████  | 16/20 [10:41<02:51, 42.89s/it]
Task 8, Epoch 17/20 => Loss 2.493, Loss_clf 0.200, Loss_fe 0.181, Loss_kd 1.877, Train_accy 83.79:  80%|████████  | 16/20 [11:15<02:51, 42.89s/it]                 
Task 8, Epoch 17/20 => Loss 2.493, Loss_clf 0.200, Loss_fe 0.181, Loss_kd 1.877, Train_accy 83.79:  85%|████████▌ | 17/20 [11:15<02:00, 40.15s/it]
Task 8, Epoch 18/20 => Loss 2.506, Loss_clf 0.197, Loss_fe 0.182, Loss_kd 1.891, Train_accy 84.33:  85%|████████▌ | 17/20 [11:49<02:00, 40.15s/it]
Task 8, Epoch 18/20 => Loss 2.506, Loss_clf 0.197, Loss_fe 0.182, Loss_kd 1.891, Train_accy 84.33:  90%|█████████ | 18/20 [11:49<01:16, 38.23s/it]
Task 8, Epoch 19/20 => Loss 2.483, Loss_clf 0.200, Loss_fe 0.188, Loss_kd 1.863, Train_accy 84.88:  90%|█████████ | 18/20 [12:22<01:16, 38.23s/it]
Task 8, Epoch 19/20 => Loss 2.483, Loss_clf 0.200, Loss_fe 0.188, Loss_kd 1.863, Train_accy 84.88:  95%|█████████▌| 19/20 [12:22<00:36, 36.88s/it]
Task 8, Epoch 20/20 => Loss 2.523, Loss_clf 0.218, Loss_fe 0.199, Loss_kd 1.872, Train_accy 83.45:  95%|█████████▌| 19/20 [12:56<00:36, 36.88s/it]
Task 8, Epoch 20/20 => Loss 2.523, Loss_clf 0.218, Loss_fe 0.199, Loss_kd 1.872, Train_accy 83.45: 100%|██████████| 20/20 [12:56<00:00, 35.95s/it]
Task 8, Epoch 20/20 => Loss 2.523, Loss_clf 0.218, Loss_fe 0.199, Loss_kd 1.872, Train_accy 83.45: 100%|██████████| 20/20 [12:56<00:00, 38.83s/it]
2024-09-05 04:21:51,166 [foster.py] => Task 8, Epoch 20/20 => Loss 2.523, Loss_clf 0.218, Loss_fe 0.199, Loss_kd 1.872, Train_accy 83.45
2024-09-05 04:21:51,167 [foster.py] => do not weight align teacher!
2024-09-05 04:21:51,170 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.971,  Train_accy 61.94, Test_accy 91.29:   0%|          | 0/20 [00:55<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.971,  Train_accy 61.94, Test_accy 91.29:   5%|▌         | 1/20 [00:55<17:35, 55.53s/it]
SNet: Task 8, Epoch 2/20 => Loss 1.784,  Train_accy 69.64:   5%|▌         | 1/20 [01:37<17:35, 55.53s/it]                 
SNet: Task 8, Epoch 2/20 => Loss 1.784,  Train_accy 69.64:  10%|█         | 2/20 [01:37<14:20, 47.78s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.779,  Train_accy 70.82:  10%|█         | 2/20 [02:20<14:20, 47.78s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.779,  Train_accy 70.82:  15%|█▌        | 3/20 [02:20<12:51, 45.38s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.761,  Train_accy 71.03:  15%|█▌        | 3/20 [03:02<12:51, 45.38s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.761,  Train_accy 71.03:  20%|██        | 4/20 [03:02<11:47, 44.22s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.758,  Train_accy 70.33:  20%|██        | 4/20 [03:45<11:47, 44.22s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.758,  Train_accy 70.33:  25%|██▌       | 5/20 [03:45<10:53, 43.57s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.782,  Train_accy 70.85, Test_accy 91.60:  25%|██▌       | 5/20 [04:40<10:53, 43.57s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.782,  Train_accy 70.85, Test_accy 91.60:  30%|███       | 6/20 [04:40<11:07, 47.66s/it]
SNet: Task 8, Epoch 7/20 => Loss 1.736,  Train_accy 71.52:  30%|███       | 6/20 [05:23<11:07, 47.66s/it]                 
SNet: Task 8, Epoch 7/20 => Loss 1.736,  Train_accy 71.52:  35%|███▌      | 7/20 [05:23<09:57, 45.97s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.764,  Train_accy 71.36:  35%|███▌      | 7/20 [06:05<09:57, 45.97s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.764,  Train_accy 71.36:  40%|████      | 8/20 [06:05<08:58, 44.86s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.799,  Train_accy 68.91:  40%|████      | 8/20 [06:48<08:58, 44.86s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.799,  Train_accy 68.91:  45%|████▌     | 9/20 [06:48<08:05, 44.10s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.757,  Train_accy 71.61:  45%|████▌     | 9/20 [07:30<08:05, 44.10s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.757,  Train_accy 71.61:  50%|█████     | 10/20 [07:30<07:15, 43.59s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.764,  Train_accy 71.97, Test_accy 91.56:  50%|█████     | 10/20 [08:26<07:15, 43.59s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.764,  Train_accy 71.97, Test_accy 91.56:  55%|█████▌    | 11/20 [08:26<07:05, 47.28s/it]
SNet: Task 8, Epoch 12/20 => Loss 1.753,  Train_accy 71.91:  55%|█████▌    | 11/20 [09:08<07:05, 47.28s/it]                 
SNet: Task 8, Epoch 12/20 => Loss 1.753,  Train_accy 71.91:  60%|██████    | 12/20 [09:08<06:06, 45.81s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.744,  Train_accy 71.55:  60%|██████    | 12/20 [09:51<06:06, 45.81s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.744,  Train_accy 71.55:  65%|██████▌   | 13/20 [09:51<05:13, 44.80s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.752,  Train_accy 70.94:  65%|██████▌   | 13/20 [10:33<05:13, 44.80s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.752,  Train_accy 70.94:  70%|███████   | 14/20 [10:33<04:24, 44.08s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.750,  Train_accy 71.73:  70%|███████   | 14/20 [11:16<04:24, 44.08s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.750,  Train_accy 71.73:  75%|███████▌  | 15/20 [11:16<03:37, 43.58s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.767,  Train_accy 70.70, Test_accy 91.53:  75%|███████▌  | 15/20 [12:11<03:37, 43.58s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.767,  Train_accy 70.70, Test_accy 91.53:  80%|████████  | 16/20 [12:11<03:08, 47.18s/it]
SNet: Task 8, Epoch 17/20 => Loss 1.764,  Train_accy 71.36:  80%|████████  | 16/20 [12:54<03:08, 47.18s/it]                 
SNet: Task 8, Epoch 17/20 => Loss 1.764,  Train_accy 71.36:  85%|████████▌ | 17/20 [12:54<02:17, 45.76s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.753,  Train_accy 71.27:  85%|████████▌ | 17/20 [13:36<02:17, 45.76s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.753,  Train_accy 71.27:  90%|█████████ | 18/20 [13:36<01:29, 44.76s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.758,  Train_accy 72.09:  90%|█████████ | 18/20 [14:19<01:29, 44.76s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.758,  Train_accy 72.09:  95%|█████████▌| 19/20 [14:19<00:44, 44.09s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.732,  Train_accy 71.39:  95%|█████████▌| 19/20 [15:01<00:44, 44.09s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.732,  Train_accy 71.39: 100%|██████████| 20/20 [15:01<00:00, 43.60s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.732,  Train_accy 71.39: 100%|██████████| 20/20 [15:01<00:00, 45.08s/it]
2024-09-05 04:36:54,157 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.732,  Train_accy 71.39
2024-09-05 04:36:54,157 [foster.py] => do not weight align student!
2024-09-05 04:37:07,291 [foster.py] => darknet eval: 
2024-09-05 04:37:07,291 [foster.py] => CNN top1 curve: 91.56
2024-09-05 04:37:07,291 [foster.py] => CNN top5 curve: 99.44
2024-09-05 04:37:07,294 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 04:38:28,409 [foster.py] => Exemplar size: 900
2024-09-05 04:38:28,409 [trainer.py] => CNN: {'total': 92.33, '00-04': 97.0, '05-09': 91.8, '10-14': 92.6, '15-19': 94.2, '20-24': 96.0, '25-29': 94.6, '30-34': 89.0, '35-39': 90.8, '40-44': 85.0, 'old': 93.25, 'new': 85.0}
2024-09-05 04:38:28,409 [trainer.py] => NME: {'total': 92.71, '00-04': 97.2, '05-09': 92.4, '10-14': 87.0, '15-19': 90.8, '20-24': 96.4, '25-29': 93.8, '30-34': 89.8, '35-39': 92.2, '40-44': 94.8, 'old': 92.45, 'new': 94.8}
2024-09-05 04:38:28,409 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33]
2024-09-05 04:38:28,409 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38]
2024-09-05 04:38:28,409 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71]
2024-09-05 04:38:28,409 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53]

Average Accuracy (CNN): 95.2
Average Accuracy (NME): 95.86
2024-09-05 04:38:28,409 [trainer.py] => Average Accuracy (CNN): 95.2
2024-09-05 04:38:28,409 [trainer.py] => Average Accuracy (NME): 95.86
2024-09-05 04:38:28,410 [trainer.py] => All params: 171731842
2024-09-05 04:38:28,411 [trainer.py] => Trainable params: 85902426
2024-09-05 04:38:29,898 [foster.py] => Learning on 45-50
2024-09-05 04:38:29,899 [foster.py] => All params: 171747217
2024-09-05 04:38:29,900 [foster.py] => Trainable params: 85913956
2024-09-05 04:38:29,974 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 4.086, Loss_clf 0.656, Loss_fe 1.603, Loss_kd 1.645, Train_accy 63.21, Test_accy 89.00:   0%|          | 0/20 [01:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 4.086, Loss_clf 0.656, Loss_fe 1.603, Loss_kd 1.645, Train_accy 63.21, Test_accy 89.00:   5%|▌         | 1/20 [01:02<19:45, 62.40s/it]
Task 9, Epoch 2/20 => Loss 2.909, Loss_clf 0.322, Loss_fe 0.774, Loss_kd 1.632, Train_accy 66.32:   5%|▌         | 1/20 [01:37<19:45, 62.40s/it]                 
Task 9, Epoch 2/20 => Loss 2.909, Loss_clf 0.322, Loss_fe 0.774, Loss_kd 1.632, Train_accy 66.32:  10%|█         | 2/20 [01:37<13:50, 46.12s/it]
Task 9, Epoch 3/20 => Loss 2.618, Loss_clf 0.307, Loss_fe 0.525, Loss_kd 1.608, Train_accy 69.74:  10%|█         | 2/20 [02:11<13:50, 46.12s/it]
Task 9, Epoch 3/20 => Loss 2.618, Loss_clf 0.307, Loss_fe 0.525, Loss_kd 1.608, Train_accy 69.74:  15%|█▌        | 3/20 [02:11<11:36, 40.94s/it]
Task 9, Epoch 4/20 => Loss 2.555, Loss_clf 0.296, Loss_fe 0.464, Loss_kd 1.615, Train_accy 69.82:  15%|█▌        | 3/20 [02:46<11:36, 40.94s/it]
Task 9, Epoch 4/20 => Loss 2.555, Loss_clf 0.296, Loss_fe 0.464, Loss_kd 1.615, Train_accy 69.82:  20%|██        | 4/20 [02:46<10:16, 38.51s/it]
Task 9, Epoch 5/20 => Loss 2.446, Loss_clf 0.269, Loss_fe 0.374, Loss_kd 1.623, Train_accy 71.26:  20%|██        | 4/20 [03:21<10:16, 38.51s/it]
Task 9, Epoch 5/20 => Loss 2.446, Loss_clf 0.269, Loss_fe 0.374, Loss_kd 1.623, Train_accy 71.26:  25%|██▌       | 5/20 [03:21<09:17, 37.16s/it]
Task 9, Epoch 6/20 => Loss 2.436, Loss_clf 0.262, Loss_fe 0.359, Loss_kd 1.634, Train_accy 73.24, Test_accy 90.70:  25%|██▌       | 5/20 [04:24<09:17, 37.16s/it]
Task 9, Epoch 6/20 => Loss 2.436, Loss_clf 0.262, Loss_fe 0.359, Loss_kd 1.634, Train_accy 73.24, Test_accy 90.70:  30%|███       | 6/20 [04:24<10:41, 45.81s/it]
Task 9, Epoch 7/20 => Loss 2.356, Loss_clf 0.233, Loss_fe 0.314, Loss_kd 1.628, Train_accy 75.82:  30%|███       | 6/20 [04:58<10:41, 45.81s/it]                 
Task 9, Epoch 7/20 => Loss 2.356, Loss_clf 0.233, Loss_fe 0.314, Loss_kd 1.628, Train_accy 75.82:  35%|███▌      | 7/20 [04:58<09:09, 42.24s/it]
Task 9, Epoch 8/20 => Loss 2.345, Loss_clf 0.244, Loss_fe 0.293, Loss_kd 1.627, Train_accy 77.94:  35%|███▌      | 7/20 [05:33<09:09, 42.24s/it]
Task 9, Epoch 8/20 => Loss 2.345, Loss_clf 0.244, Loss_fe 0.293, Loss_kd 1.627, Train_accy 77.94:  40%|████      | 8/20 [05:33<07:58, 39.88s/it]
Task 9, Epoch 9/20 => Loss 2.356, Loss_clf 0.244, Loss_fe 0.291, Loss_kd 1.639, Train_accy 77.03:  40%|████      | 8/20 [06:08<07:58, 39.88s/it]
Task 9, Epoch 9/20 => Loss 2.356, Loss_clf 0.244, Loss_fe 0.291, Loss_kd 1.639, Train_accy 77.03:  45%|████▌     | 9/20 [06:08<07:01, 38.29s/it]
Task 9, Epoch 10/20 => Loss 2.297, Loss_clf 0.227, Loss_fe 0.257, Loss_kd 1.632, Train_accy 78.18:  45%|████▌     | 9/20 [06:43<07:01, 38.29s/it]
Task 9, Epoch 10/20 => Loss 2.297, Loss_clf 0.227, Loss_fe 0.257, Loss_kd 1.632, Train_accy 78.18:  50%|█████     | 10/20 [06:43<06:12, 37.21s/it]
Task 9, Epoch 11/20 => Loss 2.285, Loss_clf 0.221, Loss_fe 0.243, Loss_kd 1.639, Train_accy 79.91, Test_accy 91.12:  50%|█████     | 10/20 [07:45<06:12, 37.21s/it]
Task 9, Epoch 11/20 => Loss 2.285, Loss_clf 0.221, Loss_fe 0.243, Loss_kd 1.639, Train_accy 79.91, Test_accy 91.12:  55%|█████▌    | 11/20 [07:45<06:44, 44.99s/it]
Task 9, Epoch 12/20 => Loss 2.285, Loss_clf 0.225, Loss_fe 0.253, Loss_kd 1.626, Train_accy 78.94:  55%|█████▌    | 11/20 [08:20<06:44, 44.99s/it]                 
Task 9, Epoch 12/20 => Loss 2.285, Loss_clf 0.225, Loss_fe 0.253, Loss_kd 1.626, Train_accy 78.94:  60%|██████    | 12/20 [08:20<05:35, 41.89s/it]
Task 9, Epoch 13/20 => Loss 2.194, Loss_clf 0.194, Loss_fe 0.211, Loss_kd 1.610, Train_accy 80.26:  60%|██████    | 12/20 [08:55<05:35, 41.89s/it]
Task 9, Epoch 13/20 => Loss 2.194, Loss_clf 0.194, Loss_fe 0.211, Loss_kd 1.610, Train_accy 80.26:  65%|██████▌   | 13/20 [08:55<04:38, 39.75s/it]
Task 9, Epoch 14/20 => Loss 2.200, Loss_clf 0.197, Loss_fe 0.195, Loss_kd 1.627, Train_accy 80.50:  65%|██████▌   | 13/20 [09:30<04:38, 39.75s/it]
Task 9, Epoch 14/20 => Loss 2.200, Loss_clf 0.197, Loss_fe 0.195, Loss_kd 1.627, Train_accy 80.50:  70%|███████   | 14/20 [09:30<03:49, 38.26s/it]
Task 9, Epoch 15/20 => Loss 2.220, Loss_clf 0.197, Loss_fe 0.214, Loss_kd 1.628, Train_accy 80.53:  70%|███████   | 14/20 [10:05<03:49, 38.26s/it]
Task 9, Epoch 15/20 => Loss 2.220, Loss_clf 0.197, Loss_fe 0.214, Loss_kd 1.628, Train_accy 80.53:  75%|███████▌  | 15/20 [10:05<03:06, 37.22s/it]
Task 9, Epoch 16/20 => Loss 2.146, Loss_clf 0.171, Loss_fe 0.170, Loss_kd 1.625, Train_accy 81.97, Test_accy 91.54:  75%|███████▌  | 15/20 [11:07<03:06, 37.22s/it]
Task 9, Epoch 16/20 => Loss 2.146, Loss_clf 0.171, Loss_fe 0.170, Loss_kd 1.625, Train_accy 81.97, Test_accy 91.54:  80%|████████  | 16/20 [11:07<02:59, 44.87s/it]
Task 9, Epoch 17/20 => Loss 2.172, Loss_clf 0.189, Loss_fe 0.175, Loss_kd 1.627, Train_accy 80.18:  80%|████████  | 16/20 [11:42<02:59, 44.87s/it]                 
Task 9, Epoch 17/20 => Loss 2.172, Loss_clf 0.189, Loss_fe 0.175, Loss_kd 1.627, Train_accy 80.18:  85%|████████▌ | 17/20 [11:42<02:05, 41.83s/it]
Task 9, Epoch 18/20 => Loss 2.217, Loss_clf 0.209, Loss_fe 0.201, Loss_kd 1.626, Train_accy 80.53:  85%|████████▌ | 17/20 [12:17<02:05, 41.83s/it]
Task 9, Epoch 18/20 => Loss 2.217, Loss_clf 0.209, Loss_fe 0.201, Loss_kd 1.626, Train_accy 80.53:  90%|█████████ | 18/20 [12:17<01:19, 39.71s/it]
Task 9, Epoch 19/20 => Loss 2.128, Loss_clf 0.169, Loss_fe 0.156, Loss_kd 1.623, Train_accy 82.09:  90%|█████████ | 18/20 [12:52<01:19, 39.71s/it]
Task 9, Epoch 19/20 => Loss 2.128, Loss_clf 0.169, Loss_fe 0.156, Loss_kd 1.623, Train_accy 82.09:  95%|█████████▌| 19/20 [12:52<00:38, 38.23s/it]
Task 9, Epoch 20/20 => Loss 2.182, Loss_clf 0.199, Loss_fe 0.172, Loss_kd 1.631, Train_accy 81.47:  95%|█████████▌| 19/20 [13:27<00:38, 38.23s/it]
Task 9, Epoch 20/20 => Loss 2.182, Loss_clf 0.199, Loss_fe 0.172, Loss_kd 1.631, Train_accy 81.47: 100%|██████████| 20/20 [13:27<00:00, 37.21s/it]
Task 9, Epoch 20/20 => Loss 2.182, Loss_clf 0.199, Loss_fe 0.172, Loss_kd 1.631, Train_accy 81.47: 100%|██████████| 20/20 [13:27<00:00, 40.35s/it]
2024-09-05 04:51:57,005 [foster.py] => Task 9, Epoch 20/20 => Loss 2.182, Loss_clf 0.199, Loss_fe 0.172, Loss_kd 1.631, Train_accy 81.47
2024-09-05 04:51:57,006 [foster.py] => do not weight align teacher!
2024-09-05 04:51:57,009 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.836,  Train_accy 58.91, Test_accy 90.34:   0%|          | 0/20 [00:58<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.836,  Train_accy 58.91, Test_accy 90.34:   5%|▌         | 1/20 [00:58<18:25, 58.20s/it]
SNet: Task 9, Epoch 2/20 => Loss 1.654,  Train_accy 63.47:   5%|▌         | 1/20 [01:41<18:25, 58.20s/it]                 
SNet: Task 9, Epoch 2/20 => Loss 1.654,  Train_accy 63.47:  10%|█         | 2/20 [01:41<14:54, 49.68s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.658,  Train_accy 63.71:  10%|█         | 2/20 [02:25<14:54, 49.68s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.658,  Train_accy 63.71:  15%|█▌        | 3/20 [02:25<13:18, 46.95s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.657,  Train_accy 65.74:  15%|█▌        | 3/20 [03:09<13:18, 46.95s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.657,  Train_accy 65.74:  20%|██        | 4/20 [03:09<12:10, 45.68s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.643,  Train_accy 64.62:  20%|██        | 4/20 [03:53<12:10, 45.68s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.643,  Train_accy 64.62:  25%|██▌       | 5/20 [03:53<11:14, 44.97s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.617,  Train_accy 64.79, Test_accy 90.26:  25%|██▌       | 5/20 [04:51<11:14, 44.97s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.617,  Train_accy 64.79, Test_accy 90.26:  30%|███       | 6/20 [04:51<11:32, 49.49s/it]
SNet: Task 9, Epoch 7/20 => Loss 1.631,  Train_accy 64.38:  30%|███       | 6/20 [05:35<11:32, 49.49s/it]                 
SNet: Task 9, Epoch 7/20 => Loss 1.631,  Train_accy 64.38:  35%|███▌      | 7/20 [05:35<10:19, 47.63s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.634,  Train_accy 65.56:  35%|███▌      | 7/20 [06:18<10:19, 47.63s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.634,  Train_accy 65.56:  40%|████      | 8/20 [06:18<09:16, 46.41s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.634,  Train_accy 65.91:  40%|████      | 8/20 [07:02<09:16, 46.41s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.634,  Train_accy 65.91:  45%|████▌     | 9/20 [07:02<08:21, 45.58s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.649,  Train_accy 64.91:  45%|████▌     | 9/20 [07:46<08:21, 45.58s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.649,  Train_accy 64.91:  50%|█████     | 10/20 [07:46<07:30, 45.01s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.626,  Train_accy 65.44, Test_accy 90.18:  50%|█████     | 10/20 [08:44<07:30, 45.01s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.626,  Train_accy 65.44, Test_accy 90.18:  55%|█████▌    | 11/20 [08:44<07:21, 49.06s/it]
SNet: Task 9, Epoch 12/20 => Loss 1.639,  Train_accy 65.71:  55%|█████▌    | 11/20 [09:28<07:21, 49.06s/it]                 
SNet: Task 9, Epoch 12/20 => Loss 1.639,  Train_accy 65.71:  60%|██████    | 12/20 [09:28<06:19, 47.43s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.644,  Train_accy 64.94:  60%|██████    | 12/20 [10:12<06:19, 47.43s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.644,  Train_accy 64.94:  65%|██████▌   | 13/20 [10:12<05:24, 46.31s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.643,  Train_accy 64.35:  65%|██████▌   | 13/20 [10:55<05:24, 46.31s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.643,  Train_accy 64.35:  70%|███████   | 14/20 [10:55<04:33, 45.53s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.646,  Train_accy 65.15:  70%|███████   | 14/20 [11:39<04:33, 45.53s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.646,  Train_accy 65.15:  75%|███████▌  | 15/20 [11:39<03:45, 45.00s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.665,  Train_accy 64.38, Test_accy 90.34:  75%|███████▌  | 15/20 [12:37<03:45, 45.00s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.665,  Train_accy 64.38, Test_accy 90.34:  80%|████████  | 16/20 [12:37<03:16, 49.02s/it]
SNet: Task 9, Epoch 17/20 => Loss 1.613,  Train_accy 65.74:  80%|████████  | 16/20 [13:21<03:16, 49.02s/it]                 
SNet: Task 9, Epoch 17/20 => Loss 1.613,  Train_accy 65.74:  85%|████████▌ | 17/20 [13:21<02:22, 47.43s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.637,  Train_accy 64.82:  85%|████████▌ | 17/20 [14:05<02:22, 47.43s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.637,  Train_accy 64.82:  90%|█████████ | 18/20 [14:05<01:32, 46.32s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.604,  Train_accy 66.00:  90%|█████████ | 18/20 [14:49<01:32, 46.32s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.604,  Train_accy 66.00:  95%|█████████▌| 19/20 [14:49<00:45, 45.55s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.636,  Train_accy 65.53:  95%|█████████▌| 19/20 [15:33<00:45, 45.55s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.636,  Train_accy 65.53: 100%|██████████| 20/20 [15:33<00:00, 45.03s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.636,  Train_accy 65.53: 100%|██████████| 20/20 [15:33<00:00, 46.65s/it]
2024-09-05 05:07:31,558 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 1.636,  Train_accy 65.53
2024-09-05 05:07:31,558 [foster.py] => do not weight align student!
2024-09-05 05:07:46,092 [foster.py] => darknet eval: 
2024-09-05 05:07:46,092 [foster.py] => CNN top1 curve: 90.28
2024-09-05 05:07:46,092 [foster.py] => CNN top5 curve: 99.34
2024-09-05 05:07:46,095 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 05:09:14,800 [foster.py] => Exemplar size: 1000
2024-09-05 05:09:14,800 [trainer.py] => CNN: {'total': 91.62, '00-04': 96.6, '05-09': 91.2, '10-14': 92.0, '15-19': 94.2, '20-24': 95.8, '25-29': 94.0, '30-34': 90.8, '35-39': 91.6, '40-44': 85.4, '45-49': 84.6, 'old': 92.4, 'new': 84.6}
2024-09-05 05:09:14,800 [trainer.py] => NME: {'total': 91.66, '00-04': 96.4, '05-09': 89.2, '10-14': 88.6, '15-19': 92.4, '20-24': 97.0, '25-29': 92.0, '30-34': 90.4, '35-39': 88.0, '40-44': 87.2, '45-49': 95.4, 'old': 91.24, 'new': 95.4}
2024-09-05 05:09:14,800 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62]
2024-09-05 05:09:14,800 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36]
2024-09-05 05:09:14,800 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66]
2024-09-05 05:09:14,800 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52]

Average Accuracy (CNN): 94.84
Average Accuracy (NME): 95.44
2024-09-05 05:09:14,800 [trainer.py] => Average Accuracy (CNN): 94.84
2024-09-05 05:09:14,800 [trainer.py] => Average Accuracy (NME): 95.44
2024-09-05 05:09:14,802 [trainer.py] => All params: 171747217
2024-09-05 05:09:14,803 [trainer.py] => Trainable params: 85913956
2024-09-05 05:09:16,396 [foster.py] => Learning on 50-55
2024-09-05 05:09:16,398 [foster.py] => All params: 171762592
2024-09-05 05:09:16,399 [foster.py] => Trainable params: 85925486
2024-09-05 05:09:16,476 [foster.py] => per cls weights : [1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 0.5813577  0.5813577  0.5813577  0.5813577
 0.5813577 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 4.699, Loss_clf 0.817, Loss_fe 1.687, Loss_kd 1.995, Train_accy 66.94, Test_accy 88.78:   0%|          | 0/20 [01:06<?, ?it/s]
Task 10, Epoch 1/20 => Loss 4.699, Loss_clf 0.817, Loss_fe 1.687, Loss_kd 1.995, Train_accy 66.94, Test_accy 88.78:   5%|▌         | 1/20 [01:06<20:57, 66.17s/it]
Task 10, Epoch 2/20 => Loss 3.398, Loss_clf 0.395, Loss_fe 0.819, Loss_kd 1.985, Train_accy 70.14:   5%|▌         | 1/20 [01:41<20:57, 66.17s/it]                 
Task 10, Epoch 2/20 => Loss 3.398, Loss_clf 0.395, Loss_fe 0.819, Loss_kd 1.985, Train_accy 70.14:  10%|█         | 2/20 [01:41<14:29, 48.29s/it]
Task 10, Epoch 3/20 => Loss 3.135, Loss_clf 0.373, Loss_fe 0.597, Loss_kd 1.969, Train_accy 70.14:  10%|█         | 2/20 [02:17<14:29, 48.29s/it]
Task 10, Epoch 3/20 => Loss 3.135, Loss_clf 0.373, Loss_fe 0.597, Loss_kd 1.969, Train_accy 70.14:  15%|█▌        | 3/20 [02:17<12:03, 42.58s/it]
Task 10, Epoch 4/20 => Loss 3.010, Loss_clf 0.328, Loss_fe 0.507, Loss_kd 1.977, Train_accy 72.46:  15%|█▌        | 3/20 [02:53<12:03, 42.58s/it]
Task 10, Epoch 4/20 => Loss 3.010, Loss_clf 0.328, Loss_fe 0.507, Loss_kd 1.977, Train_accy 72.46:  20%|██        | 4/20 [02:53<10:38, 39.89s/it]
Task 10, Epoch 5/20 => Loss 2.891, Loss_clf 0.300, Loss_fe 0.414, Loss_kd 1.979, Train_accy 74.03:  20%|██        | 4/20 [03:29<10:38, 39.89s/it]
Task 10, Epoch 5/20 => Loss 2.891, Loss_clf 0.300, Loss_fe 0.414, Loss_kd 1.979, Train_accy 74.03:  25%|██▌       | 5/20 [03:29<09:36, 38.41s/it]
Task 10, Epoch 6/20 => Loss 2.914, Loss_clf 0.328, Loss_fe 0.414, Loss_kd 1.975, Train_accy 74.23, Test_accy 89.87:  25%|██▌       | 5/20 [04:35<09:36, 38.41s/it]
Task 10, Epoch 6/20 => Loss 2.914, Loss_clf 0.328, Loss_fe 0.414, Loss_kd 1.975, Train_accy 74.23, Test_accy 89.87:  30%|███       | 6/20 [04:35<11:10, 47.93s/it]
Task 10, Epoch 7/20 => Loss 2.871, Loss_clf 0.303, Loss_fe 0.387, Loss_kd 1.983, Train_accy 74.63:  30%|███       | 6/20 [05:11<11:10, 47.93s/it]                 
Task 10, Epoch 7/20 => Loss 2.871, Loss_clf 0.303, Loss_fe 0.387, Loss_kd 1.983, Train_accy 74.63:  35%|███▌      | 7/20 [05:11<09:31, 43.96s/it]
Task 10, Epoch 8/20 => Loss 2.778, Loss_clf 0.275, Loss_fe 0.335, Loss_kd 1.971, Train_accy 76.74:  35%|███▌      | 7/20 [05:47<09:31, 43.96s/it]
Task 10, Epoch 8/20 => Loss 2.778, Loss_clf 0.275, Loss_fe 0.335, Loss_kd 1.971, Train_accy 76.74:  40%|████      | 8/20 [05:47<08:16, 41.34s/it]
Task 10, Epoch 9/20 => Loss 2.741, Loss_clf 0.271, Loss_fe 0.308, Loss_kd 1.965, Train_accy 77.46:  40%|████      | 8/20 [06:22<08:16, 41.34s/it]
Task 10, Epoch 9/20 => Loss 2.741, Loss_clf 0.271, Loss_fe 0.308, Loss_kd 1.965, Train_accy 77.46:  45%|████▌     | 9/20 [06:22<07:15, 39.60s/it]
Task 10, Epoch 10/20 => Loss 2.730, Loss_clf 0.263, Loss_fe 0.298, Loss_kd 1.971, Train_accy 77.49:  45%|████▌     | 9/20 [06:58<07:15, 39.60s/it]
Task 10, Epoch 10/20 => Loss 2.730, Loss_clf 0.263, Loss_fe 0.298, Loss_kd 1.971, Train_accy 77.49:  50%|█████     | 10/20 [06:58<06:24, 38.45s/it]
Task 10, Epoch 11/20 => Loss 2.713, Loss_clf 0.262, Loss_fe 0.275, Loss_kd 1.979, Train_accy 79.49, Test_accy 90.62:  50%|█████     | 10/20 [08:05<06:24, 38.45s/it]
Task 10, Epoch 11/20 => Loss 2.713, Loss_clf 0.262, Loss_fe 0.275, Loss_kd 1.979, Train_accy 79.49, Test_accy 90.62:  55%|█████▌    | 11/20 [08:05<07:04, 47.17s/it]
Task 10, Epoch 12/20 => Loss 2.715, Loss_clf 0.255, Loss_fe 0.273, Loss_kd 1.988, Train_accy 78.29:  55%|█████▌    | 11/20 [08:41<07:04, 47.17s/it]                 
Task 10, Epoch 12/20 => Loss 2.715, Loss_clf 0.255, Loss_fe 0.273, Loss_kd 1.988, Train_accy 78.29:  60%|██████    | 12/20 [08:41<05:49, 43.72s/it]
Task 10, Epoch 13/20 => Loss 2.615, Loss_clf 0.235, Loss_fe 0.225, Loss_kd 1.959, Train_accy 81.11:  60%|██████    | 12/20 [09:17<05:49, 43.72s/it]
Task 10, Epoch 13/20 => Loss 2.615, Loss_clf 0.235, Loss_fe 0.225, Loss_kd 1.959, Train_accy 81.11:  65%|██████▌   | 13/20 [09:17<04:49, 41.34s/it]
Task 10, Epoch 14/20 => Loss 2.615, Loss_clf 0.228, Loss_fe 0.221, Loss_kd 1.969, Train_accy 80.46:  65%|██████▌   | 13/20 [09:53<04:49, 41.34s/it]
Task 10, Epoch 14/20 => Loss 2.615, Loss_clf 0.228, Loss_fe 0.221, Loss_kd 1.969, Train_accy 80.46:  70%|███████   | 14/20 [09:53<03:58, 39.67s/it]
Task 10, Epoch 15/20 => Loss 2.615, Loss_clf 0.221, Loss_fe 0.210, Loss_kd 1.986, Train_accy 83.11:  70%|███████   | 14/20 [10:29<03:58, 39.67s/it]
Task 10, Epoch 15/20 => Loss 2.615, Loss_clf 0.221, Loss_fe 0.210, Loss_kd 1.986, Train_accy 83.11:  75%|███████▌  | 15/20 [10:29<03:12, 38.53s/it]
Task 10, Epoch 16/20 => Loss 2.585, Loss_clf 0.213, Loss_fe 0.199, Loss_kd 1.975, Train_accy 81.97, Test_accy 91.24:  75%|███████▌  | 15/20 [11:35<03:12, 38.53s/it]
Task 10, Epoch 16/20 => Loss 2.585, Loss_clf 0.213, Loss_fe 0.199, Loss_kd 1.975, Train_accy 81.97, Test_accy 91.24:  80%|████████  | 16/20 [11:35<03:07, 46.99s/it]
Task 10, Epoch 17/20 => Loss 2.588, Loss_clf 0.215, Loss_fe 0.196, Loss_kd 1.979, Train_accy 82.40:  80%|████████  | 16/20 [12:11<03:07, 46.99s/it]                 
Task 10, Epoch 17/20 => Loss 2.588, Loss_clf 0.215, Loss_fe 0.196, Loss_kd 1.979, Train_accy 82.40:  85%|████████▌ | 17/20 [12:11<02:10, 43.66s/it]
Task 10, Epoch 18/20 => Loss 2.566, Loss_clf 0.214, Loss_fe 0.191, Loss_kd 1.964, Train_accy 81.94:  85%|████████▌ | 17/20 [12:47<02:10, 43.66s/it]
Task 10, Epoch 18/20 => Loss 2.566, Loss_clf 0.214, Loss_fe 0.191, Loss_kd 1.964, Train_accy 81.94:  90%|█████████ | 18/20 [12:47<01:22, 41.33s/it]
Task 10, Epoch 19/20 => Loss 2.578, Loss_clf 0.207, Loss_fe 0.192, Loss_kd 1.981, Train_accy 83.03:  90%|█████████ | 18/20 [13:23<01:22, 41.33s/it]
Task 10, Epoch 19/20 => Loss 2.578, Loss_clf 0.207, Loss_fe 0.192, Loss_kd 1.981, Train_accy 83.03:  95%|█████████▌| 19/20 [13:23<00:39, 39.69s/it]
Task 10, Epoch 20/20 => Loss 2.562, Loss_clf 0.203, Loss_fe 0.188, Loss_kd 1.974, Train_accy 82.77:  95%|█████████▌| 19/20 [13:59<00:39, 39.69s/it]
Task 10, Epoch 20/20 => Loss 2.562, Loss_clf 0.203, Loss_fe 0.188, Loss_kd 1.974, Train_accy 82.77: 100%|██████████| 20/20 [13:59<00:00, 38.53s/it]
Task 10, Epoch 20/20 => Loss 2.562, Loss_clf 0.203, Loss_fe 0.188, Loss_kd 1.974, Train_accy 82.77: 100%|██████████| 20/20 [13:59<00:00, 41.97s/it]
2024-09-05 05:23:15,797 [foster.py] => Task 10, Epoch 20/20 => Loss 2.562, Loss_clf 0.203, Loss_fe 0.188, Loss_kd 1.974, Train_accy 82.77
2024-09-05 05:23:15,798 [foster.py] => do not weight align teacher!
2024-09-05 05:23:15,801 [foster.py] => per cls weights : [1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 0.47993148 0.47993148 0.47993148 0.47993148
 0.47993148]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 2.033,  Train_accy 61.89, Test_accy 89.62:   0%|          | 0/20 [01:00<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 2.033,  Train_accy 61.89, Test_accy 89.62:   5%|▌         | 1/20 [01:00<19:17, 60.94s/it]
SNet: Task 10, Epoch 2/20 => Loss 1.894,  Train_accy 67.63:   5%|▌         | 1/20 [01:45<19:17, 60.94s/it]                 
SNet: Task 10, Epoch 2/20 => Loss 1.894,  Train_accy 67.63:  10%|█         | 2/20 [01:45<15:27, 51.54s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.886,  Train_accy 66.57:  10%|█         | 2/20 [02:30<15:27, 51.54s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.886,  Train_accy 66.57:  15%|█▌        | 3/20 [02:30<13:45, 48.57s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.873,  Train_accy 68.20:  15%|█▌        | 3/20 [03:15<13:45, 48.57s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.873,  Train_accy 68.20:  20%|██        | 4/20 [03:15<12:34, 47.14s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.875,  Train_accy 66.80:  20%|██        | 4/20 [04:00<12:34, 47.14s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.875,  Train_accy 66.80:  25%|██▌       | 5/20 [04:00<11:35, 46.38s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.872,  Train_accy 67.40, Test_accy 90.05:  25%|██▌       | 5/20 [05:01<11:35, 46.38s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.872,  Train_accy 67.40, Test_accy 90.05:  30%|███       | 6/20 [05:01<11:58, 51.34s/it]
SNet: Task 10, Epoch 7/20 => Loss 1.872,  Train_accy 68.46:  30%|███       | 6/20 [05:46<11:58, 51.34s/it]                 
SNet: Task 10, Epoch 7/20 => Loss 1.872,  Train_accy 68.46:  35%|███▌      | 7/20 [05:46<10:40, 49.28s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.841,  Train_accy 68.74:  35%|███▌      | 7/20 [06:31<10:40, 49.28s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.841,  Train_accy 68.74:  40%|████      | 8/20 [06:31<09:35, 47.92s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.869,  Train_accy 68.03:  40%|████      | 8/20 [07:16<09:35, 47.92s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.869,  Train_accy 68.03:  45%|████▌     | 9/20 [07:16<08:37, 47.01s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.870,  Train_accy 67.57:  45%|████▌     | 9/20 [08:01<08:37, 47.01s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.870,  Train_accy 67.57:  50%|█████     | 10/20 [08:01<07:43, 46.39s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.856,  Train_accy 67.74, Test_accy 90.02:  50%|█████     | 10/20 [09:02<07:43, 46.39s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.856,  Train_accy 67.74, Test_accy 90.02:  55%|█████▌    | 11/20 [09:02<07:37, 50.85s/it]
SNet: Task 10, Epoch 12/20 => Loss 1.857,  Train_accy 68.26:  55%|█████▌    | 11/20 [09:47<07:37, 50.85s/it]                 
SNet: Task 10, Epoch 12/20 => Loss 1.857,  Train_accy 68.26:  60%|██████    | 12/20 [09:47<06:32, 49.07s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.872,  Train_accy 67.49:  60%|██████    | 12/20 [10:32<06:32, 49.07s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.872,  Train_accy 67.49:  65%|██████▌   | 13/20 [10:32<05:34, 47.85s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.871,  Train_accy 67.40:  65%|██████▌   | 13/20 [11:17<05:34, 47.85s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.871,  Train_accy 67.40:  70%|███████   | 14/20 [11:17<04:41, 46.99s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.859,  Train_accy 68.20:  70%|███████   | 14/20 [12:02<04:41, 46.99s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.859,  Train_accy 68.20:  75%|███████▌  | 15/20 [12:02<03:51, 46.39s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.876,  Train_accy 68.49, Test_accy 89.89:  75%|███████▌  | 15/20 [13:03<03:51, 46.39s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.876,  Train_accy 68.49, Test_accy 89.89:  80%|████████  | 16/20 [13:03<03:23, 50.80s/it]
SNet: Task 10, Epoch 17/20 => Loss 1.874,  Train_accy 68.23:  80%|████████  | 16/20 [13:48<03:23, 50.80s/it]                 
SNet: Task 10, Epoch 17/20 => Loss 1.874,  Train_accy 68.23:  85%|████████▌ | 17/20 [13:48<02:27, 49.05s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.880,  Train_accy 67.40:  85%|████████▌ | 17/20 [14:33<02:27, 49.05s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.880,  Train_accy 67.40:  90%|█████████ | 18/20 [14:33<01:35, 47.83s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.875,  Train_accy 68.77:  90%|█████████ | 18/20 [15:18<01:35, 47.83s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.875,  Train_accy 68.77:  95%|█████████▌| 19/20 [15:18<00:46, 46.98s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.858,  Train_accy 68.43:  95%|█████████▌| 19/20 [16:03<00:46, 46.98s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.858,  Train_accy 68.43: 100%|██████████| 20/20 [16:03<00:00, 46.38s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.858,  Train_accy 68.43: 100%|██████████| 20/20 [16:03<00:00, 48.20s/it]
2024-09-05 05:39:21,274 [foster.py] => SNet: Task 10, Epoch 20/20 => Loss 1.858,  Train_accy 68.43
2024-09-05 05:39:21,274 [foster.py] => do not weight align student!
2024-09-05 05:39:37,234 [foster.py] => darknet eval: 
2024-09-05 05:39:37,235 [foster.py] => CNN top1 curve: 89.98
2024-09-05 05:39:37,235 [foster.py] => CNN top5 curve: 99.35
2024-09-05 05:39:37,237 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 05:41:12,759 [foster.py] => Exemplar size: 1100
2024-09-05 05:41:12,759 [trainer.py] => CNN: {'total': 91.24, '00-04': 96.0, '05-09': 91.2, '10-14': 90.6, '15-19': 93.4, '20-24': 95.6, '25-29': 93.4, '30-34': 92.8, '35-39': 92.8, '40-44': 87.6, '45-49': 88.0, '50-54': 82.2, 'old': 92.14, 'new': 82.2}
2024-09-05 05:41:12,759 [trainer.py] => NME: {'total': 91.44, '00-04': 94.8, '05-09': 89.4, '10-14': 90.0, '15-19': 91.8, '20-24': 96.2, '25-29': 91.0, '30-34': 91.6, '35-39': 89.6, '40-44': 85.8, '45-49': 91.8, '50-54': 93.8, 'old': 91.2, 'new': 93.8}
2024-09-05 05:41:12,759 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24]
2024-09-05 05:41:12,760 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35]
2024-09-05 05:41:12,760 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44]
2024-09-05 05:41:12,760 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53]

Average Accuracy (CNN): 94.52
Average Accuracy (NME): 95.07
2024-09-05 05:41:12,760 [trainer.py] => Average Accuracy (CNN): 94.52
2024-09-05 05:41:12,760 [trainer.py] => Average Accuracy (NME): 95.07
2024-09-05 05:41:12,761 [trainer.py] => All params: 171762592
2024-09-05 05:41:12,762 [trainer.py] => Trainable params: 85925486
2024-09-05 05:41:14,291 [foster.py] => Learning on 55-60
2024-09-05 05:41:14,292 [foster.py] => All params: 171777967
2024-09-05 05:41:14,293 [foster.py] => Trainable params: 85937016
2024-09-05 05:41:14,371 [foster.py] => per cls weights : [1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 0.57933658 0.57933658 0.57933658 0.57933658 0.57933658]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 4.911, Loss_clf 0.766, Loss_fe 1.777, Loss_kd 2.170, Train_accy 71.03, Test_accy 90.08:   0%|          | 0/20 [01:09<?, ?it/s]
Task 11, Epoch 1/20 => Loss 4.911, Loss_clf 0.766, Loss_fe 1.777, Loss_kd 2.170, Train_accy 71.03, Test_accy 90.08:   5%|▌         | 1/20 [01:09<22:09, 69.99s/it]
Task 11, Epoch 2/20 => Loss 3.737, Loss_clf 0.478, Loss_fe 0.905, Loss_kd 2.158, Train_accy 76.03:   5%|▌         | 1/20 [01:46<22:09, 69.99s/it]                 
Task 11, Epoch 2/20 => Loss 3.737, Loss_clf 0.478, Loss_fe 0.905, Loss_kd 2.158, Train_accy 76.03:  10%|█         | 2/20 [01:46<15:08, 50.45s/it]
Task 11, Epoch 3/20 => Loss 3.451, Loss_clf 0.419, Loss_fe 0.667, Loss_kd 2.168, Train_accy 78.64:  10%|█         | 2/20 [02:23<15:08, 50.45s/it]
Task 11, Epoch 3/20 => Loss 3.451, Loss_clf 0.419, Loss_fe 0.667, Loss_kd 2.168, Train_accy 78.64:  15%|█▌        | 3/20 [02:23<12:31, 44.23s/it]
Task 11, Epoch 4/20 => Loss 3.392, Loss_clf 0.432, Loss_fe 0.607, Loss_kd 2.157, Train_accy 78.08:  15%|█▌        | 3/20 [03:00<12:31, 44.23s/it]
Task 11, Epoch 4/20 => Loss 3.392, Loss_clf 0.432, Loss_fe 0.607, Loss_kd 2.157, Train_accy 78.08:  20%|██        | 4/20 [03:00<11:00, 41.29s/it]
Task 11, Epoch 5/20 => Loss 3.303, Loss_clf 0.391, Loss_fe 0.554, Loss_kd 2.162, Train_accy 79.94:  20%|██        | 4/20 [03:37<11:00, 41.29s/it]
Task 11, Epoch 5/20 => Loss 3.303, Loss_clf 0.391, Loss_fe 0.554, Loss_kd 2.162, Train_accy 79.94:  25%|██▌       | 5/20 [03:37<09:55, 39.68s/it]
Task 11, Epoch 6/20 => Loss 3.246, Loss_clf 0.394, Loss_fe 0.511, Loss_kd 2.146, Train_accy 79.00, Test_accy 90.57:  25%|██▌       | 5/20 [04:47<09:55, 39.68s/it]
Task 11, Epoch 6/20 => Loss 3.246, Loss_clf 0.394, Loss_fe 0.511, Loss_kd 2.146, Train_accy 79.00, Test_accy 90.57:  30%|███       | 6/20 [04:47<11:40, 50.06s/it]
Task 11, Epoch 7/20 => Loss 3.210, Loss_clf 0.382, Loss_fe 0.461, Loss_kd 2.170, Train_accy 80.78:  30%|███       | 6/20 [05:24<11:40, 50.06s/it]                 
Task 11, Epoch 7/20 => Loss 3.210, Loss_clf 0.382, Loss_fe 0.461, Loss_kd 2.170, Train_accy 80.78:  35%|███▌      | 7/20 [05:24<09:54, 45.73s/it]
Task 11, Epoch 8/20 => Loss 3.156, Loss_clf 0.360, Loss_fe 0.436, Loss_kd 2.164, Train_accy 82.06:  35%|███▌      | 7/20 [06:01<09:54, 45.73s/it]
Task 11, Epoch 8/20 => Loss 3.156, Loss_clf 0.360, Loss_fe 0.436, Loss_kd 2.164, Train_accy 82.06:  40%|████      | 8/20 [06:01<08:34, 42.88s/it]
Task 11, Epoch 9/20 => Loss 3.137, Loss_clf 0.365, Loss_fe 0.406, Loss_kd 2.169, Train_accy 81.92:  40%|████      | 8/20 [06:37<08:34, 42.88s/it]
Task 11, Epoch 9/20 => Loss 3.137, Loss_clf 0.365, Loss_fe 0.406, Loss_kd 2.169, Train_accy 81.92:  45%|████▌     | 9/20 [06:37<07:30, 40.98s/it]
Task 11, Epoch 10/20 => Loss 3.039, Loss_clf 0.322, Loss_fe 0.371, Loss_kd 2.150, Train_accy 83.06:  45%|████▌     | 9/20 [07:14<07:30, 40.98s/it]
Task 11, Epoch 10/20 => Loss 3.039, Loss_clf 0.322, Loss_fe 0.371, Loss_kd 2.150, Train_accy 83.06:  50%|█████     | 10/20 [07:14<06:37, 39.70s/it]
Task 11, Epoch 11/20 => Loss 2.963, Loss_clf 0.294, Loss_fe 0.321, Loss_kd 2.153, Train_accy 83.97, Test_accy 90.72:  50%|█████     | 10/20 [08:24<06:37, 39.70s/it]
Task 11, Epoch 11/20 => Loss 2.963, Loss_clf 0.294, Loss_fe 0.321, Loss_kd 2.153, Train_accy 83.97, Test_accy 90.72:  55%|█████▌    | 11/20 [08:24<07:21, 49.03s/it]
Task 11, Epoch 12/20 => Loss 2.985, Loss_clf 0.306, Loss_fe 0.322, Loss_kd 2.162, Train_accy 84.25:  55%|█████▌    | 11/20 [09:01<07:21, 49.03s/it]                 
Task 11, Epoch 12/20 => Loss 2.985, Loss_clf 0.306, Loss_fe 0.322, Loss_kd 2.162, Train_accy 84.25:  60%|██████    | 12/20 [09:01<06:02, 45.35s/it]
Task 11, Epoch 13/20 => Loss 2.980, Loss_clf 0.300, Loss_fe 0.326, Loss_kd 2.158, Train_accy 84.56:  60%|██████    | 12/20 [09:38<06:02, 45.35s/it]
Task 11, Epoch 13/20 => Loss 2.980, Loss_clf 0.300, Loss_fe 0.326, Loss_kd 2.158, Train_accy 84.56:  65%|██████▌   | 13/20 [09:38<04:59, 42.74s/it]
Task 11, Epoch 14/20 => Loss 2.954, Loss_clf 0.294, Loss_fe 0.303, Loss_kd 2.161, Train_accy 84.64:  65%|██████▌   | 13/20 [10:15<04:59, 42.74s/it]
Task 11, Epoch 14/20 => Loss 2.954, Loss_clf 0.294, Loss_fe 0.303, Loss_kd 2.161, Train_accy 84.64:  70%|███████   | 14/20 [10:15<04:05, 40.95s/it]
Task 11, Epoch 15/20 => Loss 2.883, Loss_clf 0.266, Loss_fe 0.269, Loss_kd 2.153, Train_accy 85.67:  70%|███████   | 14/20 [10:52<04:05, 40.95s/it]
Task 11, Epoch 15/20 => Loss 2.883, Loss_clf 0.266, Loss_fe 0.269, Loss_kd 2.153, Train_accy 85.67:  75%|███████▌  | 15/20 [10:52<03:18, 39.70s/it]
Task 11, Epoch 16/20 => Loss 2.857, Loss_clf 0.267, Loss_fe 0.246, Loss_kd 2.150, Train_accy 85.92, Test_accy 90.72:  75%|███████▌  | 15/20 [12:02<03:18, 39.70s/it]
Task 11, Epoch 16/20 => Loss 2.857, Loss_clf 0.267, Loss_fe 0.246, Loss_kd 2.150, Train_accy 85.92, Test_accy 90.72:  80%|████████  | 16/20 [12:02<03:15, 48.87s/it]
Task 11, Epoch 17/20 => Loss 2.849, Loss_clf 0.263, Loss_fe 0.241, Loss_kd 2.149, Train_accy 87.19:  80%|████████  | 16/20 [12:39<03:15, 48.87s/it]                 
Task 11, Epoch 17/20 => Loss 2.849, Loss_clf 0.263, Loss_fe 0.241, Loss_kd 2.149, Train_accy 87.19:  85%|████████▌ | 17/20 [12:39<02:15, 45.25s/it]
Task 11, Epoch 18/20 => Loss 2.868, Loss_clf 0.269, Loss_fe 0.243, Loss_kd 2.160, Train_accy 86.78:  85%|████████▌ | 17/20 [13:15<02:15, 45.25s/it]
Task 11, Epoch 18/20 => Loss 2.868, Loss_clf 0.269, Loss_fe 0.243, Loss_kd 2.160, Train_accy 86.78:  90%|█████████ | 18/20 [13:15<01:25, 42.73s/it]
Task 11, Epoch 19/20 => Loss 2.873, Loss_clf 0.262, Loss_fe 0.243, Loss_kd 2.170, Train_accy 87.61:  90%|█████████ | 18/20 [13:52<01:25, 42.73s/it]
Task 11, Epoch 19/20 => Loss 2.873, Loss_clf 0.262, Loss_fe 0.243, Loss_kd 2.170, Train_accy 87.61:  95%|█████████▌| 19/20 [13:52<00:40, 40.98s/it]
Task 11, Epoch 20/20 => Loss 2.890, Loss_clf 0.274, Loss_fe 0.251, Loss_kd 2.168, Train_accy 86.31:  95%|█████████▌| 19/20 [14:29<00:40, 40.98s/it]
Task 11, Epoch 20/20 => Loss 2.890, Loss_clf 0.274, Loss_fe 0.251, Loss_kd 2.168, Train_accy 86.31: 100%|██████████| 20/20 [14:29<00:00, 39.75s/it]
Task 11, Epoch 20/20 => Loss 2.890, Loss_clf 0.274, Loss_fe 0.251, Loss_kd 2.168, Train_accy 86.31: 100%|██████████| 20/20 [14:29<00:00, 43.49s/it]
2024-09-05 05:55:44,152 [foster.py] => Task 11, Epoch 20/20 => Loss 2.890, Loss_clf 0.274, Loss_fe 0.251, Loss_kd 2.168, Train_accy 86.31
2024-09-05 05:55:44,153 [foster.py] => do not weight align teacher!
2024-09-05 05:55:44,156 [foster.py] => per cls weights : [1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 0.47786048 0.47786048 0.47786048 0.47786048 0.47786048]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 11, Epoch 1/20 => Loss 1.906,  Train_accy 68.81, Test_accy 90.82:   0%|          | 0/20 [01:03<?, ?it/s]
SNet: Task 11, Epoch 1/20 => Loss 1.906,  Train_accy 68.81, Test_accy 90.82:   5%|▌         | 1/20 [01:03<20:09, 63.68s/it]
SNet: Task 11, Epoch 2/20 => Loss 1.657,  Train_accy 76.83:   5%|▌         | 1/20 [01:49<20:09, 63.68s/it]                 
SNet: Task 11, Epoch 2/20 => Loss 1.657,  Train_accy 76.83:  10%|█         | 2/20 [01:49<16:02, 53.45s/it]
SNet: Task 11, Epoch 3/20 => Loss 1.677,  Train_accy 76.86:  10%|█         | 2/20 [02:36<16:02, 53.45s/it]
SNet: Task 11, Epoch 3/20 => Loss 1.677,  Train_accy 76.86:  15%|█▌        | 3/20 [02:36<14:13, 50.20s/it]
SNet: Task 11, Epoch 4/20 => Loss 1.649,  Train_accy 78.06:  15%|█▌        | 3/20 [03:22<14:13, 50.20s/it]
SNet: Task 11, Epoch 4/20 => Loss 1.649,  Train_accy 78.06:  20%|██        | 4/20 [03:22<12:58, 48.68s/it]
SNet: Task 11, Epoch 5/20 => Loss 1.638,  Train_accy 76.92:  20%|██        | 4/20 [04:08<12:58, 48.68s/it]
SNet: Task 11, Epoch 5/20 => Loss 1.638,  Train_accy 76.92:  25%|██▌       | 5/20 [04:08<11:57, 47.82s/it]
SNet: Task 11, Epoch 6/20 => Loss 1.624,  Train_accy 78.42, Test_accy 91.00:  25%|██▌       | 5/20 [05:12<11:57, 47.82s/it]
SNet: Task 11, Epoch 6/20 => Loss 1.624,  Train_accy 78.42, Test_accy 91.00:  30%|███       | 6/20 [05:12<12:25, 53.23s/it]
SNet: Task 11, Epoch 7/20 => Loss 1.632,  Train_accy 78.36:  30%|███       | 6/20 [05:59<12:25, 53.23s/it]                 
SNet: Task 11, Epoch 7/20 => Loss 1.632,  Train_accy 78.36:  35%|███▌      | 7/20 [05:59<11:02, 50.99s/it]
SNet: Task 11, Epoch 8/20 => Loss 1.624,  Train_accy 78.06:  35%|███▌      | 7/20 [06:45<11:02, 50.99s/it]
SNet: Task 11, Epoch 8/20 => Loss 1.624,  Train_accy 78.06:  40%|████      | 8/20 [06:45<09:54, 49.50s/it]
SNet: Task 11, Epoch 9/20 => Loss 1.613,  Train_accy 78.81:  40%|████      | 8/20 [07:31<09:54, 49.50s/it]
SNet: Task 11, Epoch 9/20 => Loss 1.613,  Train_accy 78.81:  45%|████▌     | 9/20 [07:31<08:53, 48.49s/it]
SNet: Task 11, Epoch 10/20 => Loss 1.654,  Train_accy 78.97:  45%|████▌     | 9/20 [08:18<08:53, 48.49s/it]
SNet: Task 11, Epoch 10/20 => Loss 1.654,  Train_accy 78.97:  50%|█████     | 10/20 [08:18<07:58, 47.83s/it]
SNet: Task 11, Epoch 11/20 => Loss 1.649,  Train_accy 77.92, Test_accy 91.10:  50%|█████     | 10/20 [09:21<07:58, 47.83s/it]
SNet: Task 11, Epoch 11/20 => Loss 1.649,  Train_accy 77.92, Test_accy 91.10:  55%|█████▌    | 11/20 [09:21<07:54, 52.70s/it]
SNet: Task 11, Epoch 12/20 => Loss 1.623,  Train_accy 78.53:  55%|█████▌    | 11/20 [10:08<07:54, 52.70s/it]                 
SNet: Task 11, Epoch 12/20 => Loss 1.623,  Train_accy 78.53:  60%|██████    | 12/20 [10:08<06:46, 50.77s/it]
SNet: Task 11, Epoch 13/20 => Loss 1.608,  Train_accy 79.28:  60%|██████    | 12/20 [10:54<06:46, 50.77s/it]
SNet: Task 11, Epoch 13/20 => Loss 1.608,  Train_accy 79.28:  65%|██████▌   | 13/20 [10:54<05:45, 49.41s/it]
SNet: Task 11, Epoch 14/20 => Loss 1.615,  Train_accy 78.61:  65%|██████▌   | 13/20 [11:40<05:45, 49.41s/it]
SNet: Task 11, Epoch 14/20 => Loss 1.615,  Train_accy 78.61:  70%|███████   | 14/20 [11:40<04:50, 48.48s/it]
SNet: Task 11, Epoch 15/20 => Loss 1.627,  Train_accy 79.25:  70%|███████   | 14/20 [12:27<04:50, 48.48s/it]
SNet: Task 11, Epoch 15/20 => Loss 1.627,  Train_accy 79.25:  75%|███████▌  | 15/20 [12:27<03:59, 47.84s/it]
SNet: Task 11, Epoch 16/20 => Loss 1.621,  Train_accy 79.69, Test_accy 91.00:  75%|███████▌  | 15/20 [13:30<03:59, 47.84s/it]
SNet: Task 11, Epoch 16/20 => Loss 1.621,  Train_accy 79.69, Test_accy 91.00:  80%|████████  | 16/20 [13:30<03:30, 52.59s/it]
SNet: Task 11, Epoch 17/20 => Loss 1.595,  Train_accy 79.28:  80%|████████  | 16/20 [14:17<03:30, 52.59s/it]                 
SNet: Task 11, Epoch 17/20 => Loss 1.595,  Train_accy 79.28:  85%|████████▌ | 17/20 [14:17<02:32, 50.70s/it]
SNet: Task 11, Epoch 18/20 => Loss 1.632,  Train_accy 78.56:  85%|████████▌ | 17/20 [15:03<02:32, 50.70s/it]
SNet: Task 11, Epoch 18/20 => Loss 1.632,  Train_accy 78.56:  90%|█████████ | 18/20 [15:03<01:38, 49.38s/it]
SNet: Task 11, Epoch 19/20 => Loss 1.594,  Train_accy 79.75:  90%|█████████ | 18/20 [15:49<01:38, 49.38s/it]
SNet: Task 11, Epoch 19/20 => Loss 1.594,  Train_accy 79.75:  95%|█████████▌| 19/20 [15:49<00:48, 48.48s/it]
SNet: Task 11, Epoch 20/20 => Loss 1.624,  Train_accy 78.42:  95%|█████████▌| 19/20 [16:35<00:48, 48.48s/it]
SNet: Task 11, Epoch 20/20 => Loss 1.624,  Train_accy 78.42: 100%|██████████| 20/20 [16:35<00:00, 47.83s/it]
SNet: Task 11, Epoch 20/20 => Loss 1.624,  Train_accy 78.42: 100%|██████████| 20/20 [16:35<00:00, 49.80s/it]
2024-09-05 06:12:21,693 [foster.py] => SNet: Task 11, Epoch 20/20 => Loss 1.624,  Train_accy 78.42
2024-09-05 06:12:21,694 [foster.py] => do not weight align student!
2024-09-05 06:12:39,080 [foster.py] => darknet eval: 
2024-09-05 06:12:39,080 [foster.py] => CNN top1 curve: 91.02
2024-09-05 06:12:39,081 [foster.py] => CNN top5 curve: 99.2
2024-09-05 06:12:39,083 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 06:14:22,077 [foster.py] => Exemplar size: 1200
2024-09-05 06:14:22,078 [trainer.py] => CNN: {'total': 90.8, '00-04': 94.4, '05-09': 89.6, '10-14': 90.2, '15-19': 93.0, '20-24': 95.0, '25-29': 93.0, '30-34': 92.0, '35-39': 91.8, '40-44': 87.8, '45-49': 90.2, '50-54': 83.2, '55-59': 89.4, 'old': 90.93, 'new': 89.4}
2024-09-05 06:14:22,078 [trainer.py] => NME: {'total': 91.55, '00-04': 94.8, '05-09': 89.2, '10-14': 89.6, '15-19': 91.8, '20-24': 96.2, '25-29': 91.8, '30-34': 91.6, '35-39': 90.2, '40-44': 87.8, '45-49': 92.8, '50-54': 87.4, '55-59': 95.4, 'old': 91.2, 'new': 95.4}
2024-09-05 06:14:22,078 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8]
2024-09-05 06:14:22,078 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13]
2024-09-05 06:14:22,078 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55]
2024-09-05 06:14:22,078 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23]

Average Accuracy (CNN): 94.21
Average Accuracy (NME): 94.78
2024-09-05 06:14:22,078 [trainer.py] => Average Accuracy (CNN): 94.21
2024-09-05 06:14:22,078 [trainer.py] => Average Accuracy (NME): 94.78
2024-09-05 06:14:22,079 [trainer.py] => All params: 171777967
2024-09-05 06:14:22,080 [trainer.py] => Trainable params: 85937016
2024-09-05 06:14:23,429 [foster.py] => Learning on 60-65
2024-09-05 06:14:23,430 [foster.py] => All params: 171793342
2024-09-05 06:14:23,431 [foster.py] => Trainable params: 85948546
2024-09-05 06:14:23,512 [foster.py] => per cls weights : [1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 0.57763734 0.57763734 0.57763734 0.57763734 0.57763734]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 4.751, Loss_clf 0.768, Loss_fe 1.865, Loss_kd 1.954, Train_accy 71.14, Test_accy 89.26:   0%|          | 0/20 [01:13<?, ?it/s]
Task 12, Epoch 1/20 => Loss 4.751, Loss_clf 0.768, Loss_fe 1.865, Loss_kd 1.954, Train_accy 71.14, Test_accy 89.26:   5%|▌         | 1/20 [01:13<23:21, 73.77s/it]
Task 12, Epoch 2/20 => Loss 3.378, Loss_clf 0.360, Loss_fe 0.936, Loss_kd 1.921, Train_accy 72.65:   5%|▌         | 1/20 [01:51<23:21, 73.77s/it]                 
Task 12, Epoch 2/20 => Loss 3.378, Loss_clf 0.360, Loss_fe 0.936, Loss_kd 1.921, Train_accy 72.65:  10%|█         | 2/20 [01:51<15:46, 52.59s/it]
Task 12, Epoch 3/20 => Loss 3.145, Loss_clf 0.392, Loss_fe 0.657, Loss_kd 1.935, Train_accy 70.16:  10%|█         | 2/20 [02:29<15:46, 52.59s/it]
Task 12, Epoch 3/20 => Loss 3.145, Loss_clf 0.392, Loss_fe 0.657, Loss_kd 1.935, Train_accy 70.16:  15%|█▌        | 3/20 [02:29<12:59, 45.83s/it]
Task 12, Epoch 4/20 => Loss 3.055, Loss_clf 0.359, Loss_fe 0.598, Loss_kd 1.936, Train_accy 73.32:  15%|█▌        | 3/20 [03:07<12:59, 45.83s/it]
Task 12, Epoch 4/20 => Loss 3.055, Loss_clf 0.359, Loss_fe 0.598, Loss_kd 1.936, Train_accy 73.32:  20%|██        | 4/20 [03:07<11:22, 42.67s/it]
Task 12, Epoch 5/20 => Loss 2.909, Loss_clf 0.317, Loss_fe 0.484, Loss_kd 1.945, Train_accy 74.14:  20%|██        | 4/20 [03:45<11:22, 42.67s/it]
Task 12, Epoch 5/20 => Loss 2.909, Loss_clf 0.317, Loss_fe 0.484, Loss_kd 1.945, Train_accy 74.14:  25%|██▌       | 5/20 [03:45<10:14, 40.94s/it]
Task 12, Epoch 6/20 => Loss 2.817, Loss_clf 0.318, Loss_fe 0.425, Loss_kd 1.914, Train_accy 74.46, Test_accy 89.77:  25%|██▌       | 5/20 [04:59<10:14, 40.94s/it]
Task 12, Epoch 6/20 => Loss 2.817, Loss_clf 0.318, Loss_fe 0.425, Loss_kd 1.914, Train_accy 74.46, Test_accy 89.77:  30%|███       | 6/20 [04:59<12:10, 52.20s/it]
Task 12, Epoch 7/20 => Loss 2.791, Loss_clf 0.283, Loss_fe 0.393, Loss_kd 1.953, Train_accy 76.54:  30%|███       | 6/20 [05:36<12:10, 52.20s/it]                 
Task 12, Epoch 7/20 => Loss 2.791, Loss_clf 0.283, Loss_fe 0.393, Loss_kd 1.953, Train_accy 76.54:  35%|███▌      | 7/20 [05:36<10:17, 47.50s/it]
Task 12, Epoch 8/20 => Loss 2.734, Loss_clf 0.290, Loss_fe 0.356, Loss_kd 1.927, Train_accy 76.59:  35%|███▌      | 7/20 [06:14<10:17, 47.50s/it]
Task 12, Epoch 8/20 => Loss 2.734, Loss_clf 0.290, Loss_fe 0.356, Loss_kd 1.927, Train_accy 76.59:  40%|████      | 8/20 [06:14<08:53, 44.44s/it]
Task 12, Epoch 9/20 => Loss 2.682, Loss_clf 0.271, Loss_fe 0.334, Loss_kd 1.917, Train_accy 77.59:  40%|████      | 8/20 [06:52<08:53, 44.44s/it]
Task 12, Epoch 9/20 => Loss 2.682, Loss_clf 0.271, Loss_fe 0.334, Loss_kd 1.917, Train_accy 77.59:  45%|████▌     | 9/20 [06:52<07:46, 42.38s/it]
Task 12, Epoch 10/20 => Loss 2.689, Loss_clf 0.273, Loss_fe 0.337, Loss_kd 1.919, Train_accy 78.05:  45%|████▌     | 9/20 [07:30<07:46, 42.38s/it]
Task 12, Epoch 10/20 => Loss 2.689, Loss_clf 0.273, Loss_fe 0.337, Loss_kd 1.919, Train_accy 78.05:  50%|█████     | 10/20 [07:30<06:49, 40.98s/it]
Task 12, Epoch 11/20 => Loss 2.708, Loss_clf 0.282, Loss_fe 0.316, Loss_kd 1.948, Train_accy 77.73, Test_accy 89.89:  50%|█████     | 10/20 [08:44<06:49, 40.98s/it]
Task 12, Epoch 11/20 => Loss 2.708, Loss_clf 0.282, Loss_fe 0.316, Loss_kd 1.948, Train_accy 77.73, Test_accy 89.89:  55%|█████▌    | 11/20 [08:44<07:39, 51.08s/it]
Task 12, Epoch 12/20 => Loss 2.645, Loss_clf 0.252, Loss_fe 0.270, Loss_kd 1.960, Train_accy 80.32:  55%|█████▌    | 11/20 [09:22<07:39, 51.08s/it]                 
Task 12, Epoch 12/20 => Loss 2.645, Loss_clf 0.252, Loss_fe 0.270, Loss_kd 1.960, Train_accy 80.32:  60%|██████    | 12/20 [09:22<06:16, 47.06s/it]
Task 12, Epoch 13/20 => Loss 2.677, Loss_clf 0.280, Loss_fe 0.290, Loss_kd 1.944, Train_accy 79.76:  60%|██████    | 12/20 [10:00<06:16, 47.06s/it]
Task 12, Epoch 13/20 => Loss 2.677, Loss_clf 0.280, Loss_fe 0.290, Loss_kd 1.944, Train_accy 79.76:  65%|██████▌   | 13/20 [10:00<05:09, 44.27s/it]
Task 12, Epoch 14/20 => Loss 2.633, Loss_clf 0.257, Loss_fe 0.281, Loss_kd 1.933, Train_accy 79.41:  65%|██████▌   | 13/20 [10:38<05:09, 44.27s/it]
Task 12, Epoch 14/20 => Loss 2.633, Loss_clf 0.257, Loss_fe 0.281, Loss_kd 1.933, Train_accy 79.41:  70%|███████   | 14/20 [10:38<04:14, 42.33s/it]
Task 12, Epoch 15/20 => Loss 2.547, Loss_clf 0.217, Loss_fe 0.242, Loss_kd 1.928, Train_accy 82.05:  70%|███████   | 14/20 [11:15<04:14, 42.33s/it]
Task 12, Epoch 15/20 => Loss 2.547, Loss_clf 0.217, Loss_fe 0.242, Loss_kd 1.928, Train_accy 82.05:  75%|███████▌  | 15/20 [11:15<03:24, 40.99s/it]
Task 12, Epoch 16/20 => Loss 2.527, Loss_clf 0.230, Loss_fe 0.213, Loss_kd 1.924, Train_accy 82.76, Test_accy 90.12:  75%|███████▌  | 15/20 [12:29<03:24, 40.99s/it]
Task 12, Epoch 16/20 => Loss 2.527, Loss_clf 0.230, Loss_fe 0.213, Loss_kd 1.924, Train_accy 82.76, Test_accy 90.12:  80%|████████  | 16/20 [12:29<03:23, 50.92s/it]
Task 12, Epoch 17/20 => Loss 2.483, Loss_clf 0.208, Loss_fe 0.201, Loss_kd 1.915, Train_accy 82.65:  80%|████████  | 16/20 [13:07<03:23, 50.92s/it]                 
Task 12, Epoch 17/20 => Loss 2.483, Loss_clf 0.208, Loss_fe 0.201, Loss_kd 1.915, Train_accy 82.65:  85%|████████▌ | 17/20 [13:07<02:20, 46.99s/it]
Task 12, Epoch 18/20 => Loss 2.513, Loss_clf 0.220, Loss_fe 0.208, Loss_kd 1.924, Train_accy 82.19:  85%|████████▌ | 17/20 [13:45<02:20, 46.99s/it]
Task 12, Epoch 18/20 => Loss 2.513, Loss_clf 0.220, Loss_fe 0.208, Loss_kd 1.924, Train_accy 82.19:  90%|█████████ | 18/20 [13:45<01:28, 44.25s/it]
Task 12, Epoch 19/20 => Loss 2.522, Loss_clf 0.223, Loss_fe 0.211, Loss_kd 1.927, Train_accy 81.97:  90%|█████████ | 18/20 [14:23<01:28, 44.25s/it]
Task 12, Epoch 19/20 => Loss 2.522, Loss_clf 0.223, Loss_fe 0.211, Loss_kd 1.927, Train_accy 81.97:  95%|█████████▌| 19/20 [14:23<00:42, 42.34s/it]
Task 12, Epoch 20/20 => Loss 2.462, Loss_clf 0.210, Loss_fe 0.196, Loss_kd 1.898, Train_accy 82.11:  95%|█████████▌| 19/20 [15:01<00:42, 42.34s/it]
Task 12, Epoch 20/20 => Loss 2.462, Loss_clf 0.210, Loss_fe 0.196, Loss_kd 1.898, Train_accy 82.11: 100%|██████████| 20/20 [15:01<00:00, 41.00s/it]
Task 12, Epoch 20/20 => Loss 2.462, Loss_clf 0.210, Loss_fe 0.196, Loss_kd 1.898, Train_accy 82.11: 100%|██████████| 20/20 [15:01<00:00, 45.07s/it]
2024-09-05 06:29:24,873 [foster.py] => Task 12, Epoch 20/20 => Loss 2.462, Loss_clf 0.210, Loss_fe 0.196, Loss_kd 1.898, Train_accy 82.11
2024-09-05 06:29:24,874 [foster.py] => do not weight align teacher!
2024-09-05 06:29:24,875 [foster.py] => per cls weights : [1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 0.476122  0.476122  0.476122
 0.476122  0.476122 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 12, Epoch 1/20 => Loss 1.867,  Train_accy 63.59, Test_accy 89.38:   0%|          | 0/20 [01:06<?, ?it/s]
SNet: Task 12, Epoch 1/20 => Loss 1.867,  Train_accy 63.59, Test_accy 89.38:   5%|▌         | 1/20 [01:06<21:01, 66.40s/it]
SNet: Task 12, Epoch 2/20 => Loss 1.664,  Train_accy 68.65:   5%|▌         | 1/20 [01:53<21:01, 66.40s/it]                 
SNet: Task 12, Epoch 2/20 => Loss 1.664,  Train_accy 68.65:  10%|█         | 2/20 [01:53<16:35, 55.32s/it]
SNet: Task 12, Epoch 3/20 => Loss 1.693,  Train_accy 68.97:  10%|█         | 2/20 [02:41<16:35, 55.32s/it]
SNet: Task 12, Epoch 3/20 => Loss 1.693,  Train_accy 68.97:  15%|█▌        | 3/20 [02:41<14:40, 51.80s/it]
SNet: Task 12, Epoch 4/20 => Loss 1.652,  Train_accy 69.43:  15%|█▌        | 3/20 [03:29<14:40, 51.80s/it]
SNet: Task 12, Epoch 4/20 => Loss 1.652,  Train_accy 69.43:  20%|██        | 4/20 [03:29<13:23, 50.22s/it]
SNet: Task 12, Epoch 5/20 => Loss 1.639,  Train_accy 69.89:  20%|██        | 4/20 [04:17<13:23, 50.22s/it]
SNet: Task 12, Epoch 5/20 => Loss 1.639,  Train_accy 69.89:  25%|██▌       | 5/20 [04:17<12:21, 49.40s/it]
SNet: Task 12, Epoch 6/20 => Loss 1.674,  Train_accy 69.62, Test_accy 89.72:  25%|██▌       | 5/20 [05:23<12:21, 49.40s/it]
SNet: Task 12, Epoch 6/20 => Loss 1.674,  Train_accy 69.62, Test_accy 89.72:  30%|███       | 6/20 [05:23<12:53, 55.26s/it]
SNet: Task 12, Epoch 7/20 => Loss 1.649,  Train_accy 69.16:  30%|███       | 6/20 [06:11<12:53, 55.26s/it]                 
SNet: Task 12, Epoch 7/20 => Loss 1.649,  Train_accy 69.16:  35%|███▌      | 7/20 [06:11<11:26, 52.80s/it]
SNet: Task 12, Epoch 8/20 => Loss 1.632,  Train_accy 70.92:  35%|███▌      | 7/20 [06:59<11:26, 52.80s/it]
SNet: Task 12, Epoch 8/20 => Loss 1.632,  Train_accy 70.92:  40%|████      | 8/20 [06:59<10:14, 51.21s/it]
SNet: Task 12, Epoch 9/20 => Loss 1.671,  Train_accy 69.27:  40%|████      | 8/20 [07:47<10:14, 51.21s/it]
SNet: Task 12, Epoch 9/20 => Loss 1.671,  Train_accy 69.27:  45%|████▌     | 9/20 [07:47<09:11, 50.13s/it]
SNet: Task 12, Epoch 10/20 => Loss 1.658,  Train_accy 69.78:  45%|████▌     | 9/20 [08:34<09:11, 50.13s/it]
SNet: Task 12, Epoch 10/20 => Loss 1.658,  Train_accy 69.78:  50%|█████     | 10/20 [08:34<08:13, 49.39s/it]
SNet: Task 12, Epoch 11/20 => Loss 1.637,  Train_accy 68.86, Test_accy 89.51:  50%|█████     | 10/20 [09:41<08:13, 49.39s/it]
SNet: Task 12, Epoch 11/20 => Loss 1.637,  Train_accy 68.86, Test_accy 89.51:  55%|█████▌    | 11/20 [09:41<08:11, 54.60s/it]
SNet: Task 12, Epoch 12/20 => Loss 1.648,  Train_accy 69.19:  55%|█████▌    | 11/20 [10:28<08:11, 54.60s/it]                 
SNet: Task 12, Epoch 12/20 => Loss 1.648,  Train_accy 69.19:  60%|██████    | 12/20 [10:28<06:59, 52.46s/it]
SNet: Task 12, Epoch 13/20 => Loss 1.638,  Train_accy 70.27:  60%|██████    | 12/20 [11:16<06:59, 52.46s/it]
SNet: Task 12, Epoch 13/20 => Loss 1.638,  Train_accy 70.27:  65%|██████▌   | 13/20 [11:16<05:56, 50.99s/it]
SNet: Task 12, Epoch 14/20 => Loss 1.681,  Train_accy 70.11:  65%|██████▌   | 13/20 [12:04<05:56, 50.99s/it]
SNet: Task 12, Epoch 14/20 => Loss 1.681,  Train_accy 70.11:  70%|███████   | 14/20 [12:04<04:59, 49.98s/it]
SNet: Task 12, Epoch 15/20 => Loss 1.666,  Train_accy 69.38:  70%|███████   | 14/20 [12:51<04:59, 49.98s/it]
SNet: Task 12, Epoch 15/20 => Loss 1.666,  Train_accy 69.38:  75%|███████▌  | 15/20 [12:51<04:06, 49.26s/it]
SNet: Task 12, Epoch 16/20 => Loss 1.655,  Train_accy 70.05, Test_accy 89.54:  75%|███████▌  | 15/20 [13:58<04:06, 49.26s/it]
SNet: Task 12, Epoch 16/20 => Loss 1.655,  Train_accy 70.05, Test_accy 89.54:  80%|████████  | 16/20 [13:58<03:37, 54.44s/it]
SNet: Task 12, Epoch 17/20 => Loss 1.655,  Train_accy 69.57:  80%|████████  | 16/20 [14:45<03:37, 54.44s/it]                 
SNet: Task 12, Epoch 17/20 => Loss 1.655,  Train_accy 69.57:  85%|████████▌ | 17/20 [14:45<02:37, 52.37s/it]
SNet: Task 12, Epoch 18/20 => Loss 1.666,  Train_accy 70.43:  85%|████████▌ | 17/20 [15:33<02:37, 52.37s/it]
SNet: Task 12, Epoch 18/20 => Loss 1.666,  Train_accy 70.43:  90%|█████████ | 18/20 [15:33<01:41, 50.95s/it]
SNet: Task 12, Epoch 19/20 => Loss 1.633,  Train_accy 69.92:  90%|█████████ | 18/20 [16:21<01:41, 50.95s/it]
SNet: Task 12, Epoch 19/20 => Loss 1.633,  Train_accy 69.92:  95%|█████████▌| 19/20 [16:21<00:49, 49.94s/it]
SNet: Task 12, Epoch 20/20 => Loss 1.646,  Train_accy 70.92:  95%|█████████▌| 19/20 [17:08<00:49, 49.94s/it]
SNet: Task 12, Epoch 20/20 => Loss 1.646,  Train_accy 70.92: 100%|██████████| 20/20 [17:08<00:00, 49.25s/it]
SNet: Task 12, Epoch 20/20 => Loss 1.646,  Train_accy 70.92: 100%|██████████| 20/20 [17:08<00:00, 51.44s/it]
2024-09-05 06:46:35,045 [foster.py] => SNet: Task 12, Epoch 20/20 => Loss 1.646,  Train_accy 70.92
2024-09-05 06:46:35,045 [foster.py] => do not weight align student!
2024-09-05 06:46:53,839 [foster.py] => darknet eval: 
2024-09-05 06:46:53,839 [foster.py] => CNN top1 curve: 89.49
2024-09-05 06:46:53,839 [foster.py] => CNN top5 curve: 99.2
2024-09-05 06:46:53,841 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 06:48:43,879 [foster.py] => Exemplar size: 1300
2024-09-05 06:48:43,879 [trainer.py] => CNN: {'total': 90.2, '00-04': 93.6, '05-09': 90.2, '10-14': 89.4, '15-19': 92.6, '20-24': 95.2, '25-29': 92.8, '30-34': 92.6, '35-39': 92.2, '40-44': 90.8, '45-49': 92.4, '50-54': 84.6, '55-59': 88.8, '60-64': 77.4, 'old': 91.27, 'new': 77.4}
2024-09-05 06:48:43,879 [trainer.py] => NME: {'total': 90.97, '00-04': 96.0, '05-09': 90.2, '10-14': 89.0, '15-19': 90.8, '20-24': 96.6, '25-29': 92.2, '30-34': 90.8, '35-39': 89.4, '40-44': 89.0, '45-49': 93.8, '50-54': 87.0, '55-59': 83.0, '60-64': 94.8, 'old': 90.65, 'new': 94.8}
2024-09-05 06:48:43,879 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2]
2024-09-05 06:48:43,879 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17]
2024-09-05 06:48:43,879 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97]
2024-09-05 06:48:43,879 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14]

Average Accuracy (CNN): 93.9
Average Accuracy (NME): 94.49
2024-09-05 06:48:43,880 [trainer.py] => Average Accuracy (CNN): 93.9
2024-09-05 06:48:43,880 [trainer.py] => Average Accuracy (NME): 94.49
2024-09-05 06:48:43,881 [trainer.py] => All params: 171793342
2024-09-05 06:48:43,882 [trainer.py] => Trainable params: 85948546
2024-09-05 06:48:45,257 [foster.py] => Learning on 65-70
2024-09-05 06:48:45,259 [foster.py] => All params: 171808717
2024-09-05 06:48:45,259 [foster.py] => Trainable params: 85960076
2024-09-05 06:48:45,339 [foster.py] => per cls weights : [1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 0.57618877
 0.57618877 0.57618877 0.57618877 0.57618877]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 4.764, Loss_clf 0.691, Loss_fe 2.007, Loss_kd 1.918, Train_accy 71.26, Test_accy 88.79:   0%|          | 0/20 [01:17<?, ?it/s]
Task 13, Epoch 1/20 => Loss 4.764, Loss_clf 0.691, Loss_fe 2.007, Loss_kd 1.918, Train_accy 71.26, Test_accy 88.79:   5%|▌         | 1/20 [01:17<24:32, 77.51s/it]
Task 13, Epoch 2/20 => Loss 3.369, Loss_clf 0.379, Loss_fe 0.933, Loss_kd 1.911, Train_accy 76.76:   5%|▌         | 1/20 [01:56<24:32, 77.51s/it]                 
Task 13, Epoch 2/20 => Loss 3.369, Loss_clf 0.379, Loss_fe 0.933, Loss_kd 1.911, Train_accy 76.76:  10%|█         | 2/20 [01:56<16:26, 54.80s/it]
Task 13, Epoch 3/20 => Loss 3.027, Loss_clf 0.341, Loss_fe 0.642, Loss_kd 1.898, Train_accy 75.50:  10%|█         | 2/20 [02:35<16:26, 54.80s/it]
Task 13, Epoch 3/20 => Loss 3.027, Loss_clf 0.341, Loss_fe 0.642, Loss_kd 1.898, Train_accy 75.50:  15%|█▌        | 3/20 [02:35<13:27, 47.50s/it]
Task 13, Epoch 4/20 => Loss 2.927, Loss_clf 0.335, Loss_fe 0.545, Loss_kd 1.901, Train_accy 77.00:  15%|█▌        | 3/20 [03:14<13:27, 47.50s/it]
Task 13, Epoch 4/20 => Loss 2.927, Loss_clf 0.335, Loss_fe 0.545, Loss_kd 1.901, Train_accy 77.00:  20%|██        | 4/20 [03:14<11:45, 44.10s/it]
Task 13, Epoch 5/20 => Loss 2.821, Loss_clf 0.289, Loss_fe 0.471, Loss_kd 1.914, Train_accy 78.63:  20%|██        | 4/20 [03:52<11:45, 44.10s/it]
Task 13, Epoch 5/20 => Loss 2.821, Loss_clf 0.289, Loss_fe 0.471, Loss_kd 1.914, Train_accy 78.63:  25%|██▌       | 5/20 [03:52<10:32, 42.20s/it]
Task 13, Epoch 6/20 => Loss 2.732, Loss_clf 0.269, Loss_fe 0.424, Loss_kd 1.894, Train_accy 77.61, Test_accy 89.77:  25%|██▌       | 5/20 [05:10<10:32, 42.20s/it]
Task 13, Epoch 6/20 => Loss 2.732, Loss_clf 0.269, Loss_fe 0.424, Loss_kd 1.894, Train_accy 77.61, Test_accy 89.77:  30%|███       | 6/20 [05:10<12:39, 54.24s/it]
Task 13, Epoch 7/20 => Loss 2.724, Loss_clf 0.295, Loss_fe 0.395, Loss_kd 1.889, Train_accy 78.74:  30%|███       | 6/20 [05:49<12:39, 54.24s/it]                 
Task 13, Epoch 7/20 => Loss 2.724, Loss_clf 0.295, Loss_fe 0.395, Loss_kd 1.889, Train_accy 78.74:  35%|███▌      | 7/20 [05:49<10:39, 49.21s/it]
Task 13, Epoch 8/20 => Loss 2.714, Loss_clf 0.304, Loss_fe 0.377, Loss_kd 1.888, Train_accy 78.97:  35%|███▌      | 7/20 [06:28<10:39, 49.21s/it]
Task 13, Epoch 8/20 => Loss 2.714, Loss_clf 0.304, Loss_fe 0.377, Loss_kd 1.888, Train_accy 78.97:  40%|████      | 8/20 [06:28<09:10, 45.91s/it]
Task 13, Epoch 9/20 => Loss 2.678, Loss_clf 0.274, Loss_fe 0.343, Loss_kd 1.914, Train_accy 80.34:  40%|████      | 8/20 [07:07<09:10, 45.91s/it]
Task 13, Epoch 9/20 => Loss 2.678, Loss_clf 0.274, Loss_fe 0.343, Loss_kd 1.914, Train_accy 80.34:  45%|████▌     | 9/20 [07:07<08:00, 43.72s/it]
Task 13, Epoch 10/20 => Loss 2.615, Loss_clf 0.251, Loss_fe 0.310, Loss_kd 1.907, Train_accy 79.76:  45%|████▌     | 9/20 [07:46<08:00, 43.72s/it]
Task 13, Epoch 10/20 => Loss 2.615, Loss_clf 0.251, Loss_fe 0.310, Loss_kd 1.907, Train_accy 79.76:  50%|█████     | 10/20 [07:46<07:02, 42.23s/it]
Task 13, Epoch 11/20 => Loss 2.632, Loss_clf 0.271, Loss_fe 0.304, Loss_kd 1.910, Train_accy 79.63, Test_accy 89.73:  50%|█████     | 10/20 [09:03<07:02, 42.23s/it]
Task 13, Epoch 11/20 => Loss 2.632, Loss_clf 0.271, Loss_fe 0.304, Loss_kd 1.910, Train_accy 79.63, Test_accy 89.73:  55%|█████▌    | 11/20 [09:03<07:58, 53.13s/it]
Task 13, Epoch 12/20 => Loss 2.606, Loss_clf 0.257, Loss_fe 0.295, Loss_kd 1.907, Train_accy 80.74:  55%|█████▌    | 11/20 [09:42<07:58, 53.13s/it]                 
Task 13, Epoch 12/20 => Loss 2.606, Loss_clf 0.257, Loss_fe 0.295, Loss_kd 1.907, Train_accy 80.74:  60%|██████    | 12/20 [09:42<06:30, 48.78s/it]
Task 13, Epoch 13/20 => Loss 2.563, Loss_clf 0.247, Loss_fe 0.260, Loss_kd 1.910, Train_accy 81.63:  60%|██████    | 12/20 [10:21<06:30, 48.78s/it]
Task 13, Epoch 13/20 => Loss 2.563, Loss_clf 0.247, Loss_fe 0.260, Loss_kd 1.910, Train_accy 81.63:  65%|██████▌   | 13/20 [10:21<05:20, 45.77s/it]
Task 13, Epoch 14/20 => Loss 2.546, Loss_clf 0.238, Loss_fe 0.244, Loss_kd 1.916, Train_accy 81.08:  65%|██████▌   | 13/20 [11:00<05:20, 45.77s/it]
Task 13, Epoch 14/20 => Loss 2.546, Loss_clf 0.238, Loss_fe 0.244, Loss_kd 1.916, Train_accy 81.08:  70%|███████   | 14/20 [11:00<04:22, 43.67s/it]
Task 13, Epoch 15/20 => Loss 2.478, Loss_clf 0.222, Loss_fe 0.220, Loss_kd 1.890, Train_accy 81.82:  70%|███████   | 14/20 [11:39<04:22, 43.67s/it]
Task 13, Epoch 15/20 => Loss 2.478, Loss_clf 0.222, Loss_fe 0.220, Loss_kd 1.890, Train_accy 81.82:  75%|███████▌  | 15/20 [11:39<03:31, 42.23s/it]
Task 13, Epoch 16/20 => Loss 2.490, Loss_clf 0.215, Loss_fe 0.208, Loss_kd 1.920, Train_accy 83.16, Test_accy 90.10:  75%|███████▌  | 15/20 [12:57<03:31, 42.23s/it]
Task 13, Epoch 16/20 => Loss 2.490, Loss_clf 0.215, Loss_fe 0.208, Loss_kd 1.920, Train_accy 83.16, Test_accy 90.10:  80%|████████  | 16/20 [12:57<03:31, 52.93s/it]
Task 13, Epoch 17/20 => Loss 2.474, Loss_clf 0.231, Loss_fe 0.210, Loss_kd 1.887, Train_accy 81.50:  80%|████████  | 16/20 [13:35<03:31, 52.93s/it]                 
Task 13, Epoch 17/20 => Loss 2.474, Loss_clf 0.231, Loss_fe 0.210, Loss_kd 1.887, Train_accy 81.50:  85%|████████▌ | 17/20 [13:35<02:26, 48.70s/it]
Task 13, Epoch 18/20 => Loss 2.485, Loss_clf 0.227, Loss_fe 0.218, Loss_kd 1.894, Train_accy 82.87:  85%|████████▌ | 17/20 [14:14<02:26, 48.70s/it]
Task 13, Epoch 18/20 => Loss 2.485, Loss_clf 0.227, Loss_fe 0.218, Loss_kd 1.894, Train_accy 82.87:  90%|█████████ | 18/20 [14:14<01:31, 45.74s/it]
Task 13, Epoch 19/20 => Loss 2.454, Loss_clf 0.223, Loss_fe 0.203, Loss_kd 1.884, Train_accy 83.45:  90%|█████████ | 18/20 [14:53<01:31, 45.74s/it]
Task 13, Epoch 19/20 => Loss 2.454, Loss_clf 0.223, Loss_fe 0.203, Loss_kd 1.884, Train_accy 83.45:  95%|█████████▌| 19/20 [14:53<00:43, 43.68s/it]
Task 13, Epoch 20/20 => Loss 2.507, Loss_clf 0.235, Loss_fe 0.212, Loss_kd 1.913, Train_accy 82.16:  95%|█████████▌| 19/20 [15:32<00:43, 43.68s/it]
Task 13, Epoch 20/20 => Loss 2.507, Loss_clf 0.235, Loss_fe 0.212, Loss_kd 1.913, Train_accy 82.16: 100%|██████████| 20/20 [15:32<00:00, 42.24s/it]
Task 13, Epoch 20/20 => Loss 2.507, Loss_clf 0.235, Loss_fe 0.212, Loss_kd 1.913, Train_accy 82.16: 100%|██████████| 20/20 [15:32<00:00, 46.63s/it]
2024-09-05 07:04:17,854 [foster.py] => Task 13, Epoch 20/20 => Loss 2.507, Loss_clf 0.235, Loss_fe 0.212, Loss_kd 1.913, Train_accy 82.16
2024-09-05 07:04:17,856 [foster.py] => do not weight align teacher!
2024-09-05 07:04:17,859 [foster.py] => per cls weights : [1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 0.47464191
 0.47464191 0.47464191 0.47464191 0.47464191]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 13, Epoch 1/20 => Loss 1.902,  Train_accy 65.95, Test_accy 89.34:   0%|          | 0/20 [01:09<?, ?it/s]
SNet: Task 13, Epoch 1/20 => Loss 1.902,  Train_accy 65.95, Test_accy 89.34:   5%|▌         | 1/20 [01:09<21:51, 69.04s/it]
SNet: Task 13, Epoch 2/20 => Loss 1.722,  Train_accy 71.03:   5%|▌         | 1/20 [01:57<21:51, 69.04s/it]                 
SNet: Task 13, Epoch 2/20 => Loss 1.722,  Train_accy 71.03:  10%|█         | 2/20 [01:57<17:08, 57.16s/it]
SNet: Task 13, Epoch 3/20 => Loss 1.735,  Train_accy 71.13:  10%|█         | 2/20 [02:46<17:08, 57.16s/it]
SNet: Task 13, Epoch 3/20 => Loss 1.735,  Train_accy 71.13:  15%|█▌        | 3/20 [02:46<15:07, 53.40s/it]
SNet: Task 13, Epoch 4/20 => Loss 1.747,  Train_accy 71.92:  15%|█▌        | 3/20 [03:35<15:07, 53.40s/it]
SNet: Task 13, Epoch 4/20 => Loss 1.747,  Train_accy 71.92:  20%|██        | 4/20 [03:35<13:46, 51.63s/it]
SNet: Task 13, Epoch 5/20 => Loss 1.719,  Train_accy 72.29:  20%|██        | 4/20 [04:24<13:46, 51.63s/it]
SNet: Task 13, Epoch 5/20 => Loss 1.719,  Train_accy 72.29:  25%|██▌       | 5/20 [04:24<12:39, 50.65s/it]
SNet: Task 13, Epoch 6/20 => Loss 1.740,  Train_accy 71.53, Test_accy 89.94:  25%|██▌       | 5/20 [05:33<12:39, 50.65s/it]
SNet: Task 13, Epoch 6/20 => Loss 1.740,  Train_accy 71.53, Test_accy 89.94:  30%|███       | 6/20 [05:33<13:16, 56.90s/it]
SNet: Task 13, Epoch 7/20 => Loss 1.767,  Train_accy 71.47:  30%|███       | 6/20 [06:22<13:16, 56.90s/it]                 
SNet: Task 13, Epoch 7/20 => Loss 1.767,  Train_accy 71.47:  35%|███▌      | 7/20 [06:22<11:45, 54.26s/it]
SNet: Task 13, Epoch 8/20 => Loss 1.732,  Train_accy 72.03:  35%|███▌      | 7/20 [07:11<11:45, 54.26s/it]
SNet: Task 13, Epoch 8/20 => Loss 1.732,  Train_accy 72.03:  40%|████      | 8/20 [07:11<10:30, 52.55s/it]
SNet: Task 13, Epoch 9/20 => Loss 1.749,  Train_accy 71.37:  40%|████      | 8/20 [08:00<10:30, 52.55s/it]
SNet: Task 13, Epoch 9/20 => Loss 1.749,  Train_accy 71.37:  45%|████▌     | 9/20 [08:00<09:25, 51.38s/it]
SNet: Task 13, Epoch 10/20 => Loss 1.731,  Train_accy 72.58:  45%|████▌     | 9/20 [08:49<09:25, 51.38s/it]
SNet: Task 13, Epoch 10/20 => Loss 1.731,  Train_accy 72.58:  50%|█████     | 10/20 [08:49<08:25, 50.60s/it]
SNet: Task 13, Epoch 11/20 => Loss 1.729,  Train_accy 72.42, Test_accy 89.73:  50%|█████     | 10/20 [09:58<08:25, 50.60s/it]
SNet: Task 13, Epoch 11/20 => Loss 1.729,  Train_accy 72.42, Test_accy 89.73:  55%|█████▌    | 11/20 [09:58<08:26, 56.24s/it]
SNet: Task 13, Epoch 12/20 => Loss 1.706,  Train_accy 72.76:  55%|█████▌    | 11/20 [10:46<08:26, 56.24s/it]                 
SNet: Task 13, Epoch 12/20 => Loss 1.706,  Train_accy 72.76:  60%|██████    | 12/20 [10:46<07:11, 53.98s/it]
SNet: Task 13, Epoch 13/20 => Loss 1.731,  Train_accy 72.24:  60%|██████    | 12/20 [11:35<07:11, 53.98s/it]
SNet: Task 13, Epoch 13/20 => Loss 1.731,  Train_accy 72.24:  65%|██████▌   | 13/20 [11:35<06:06, 52.42s/it]
SNet: Task 13, Epoch 14/20 => Loss 1.722,  Train_accy 72.68:  65%|██████▌   | 13/20 [12:24<06:06, 52.42s/it]
SNet: Task 13, Epoch 14/20 => Loss 1.722,  Train_accy 72.68:  70%|███████   | 14/20 [12:24<05:08, 51.34s/it]
SNet: Task 13, Epoch 15/20 => Loss 1.730,  Train_accy 71.39:  70%|███████   | 14/20 [13:13<05:08, 51.34s/it]
SNet: Task 13, Epoch 15/20 => Loss 1.730,  Train_accy 71.39:  75%|███████▌  | 15/20 [13:13<04:12, 50.58s/it]
SNet: Task 13, Epoch 16/20 => Loss 1.743,  Train_accy 72.45, Test_accy 89.73:  75%|███████▌  | 15/20 [14:22<04:12, 50.58s/it]
SNet: Task 13, Epoch 16/20 => Loss 1.743,  Train_accy 72.45, Test_accy 89.73:  80%|████████  | 16/20 [14:22<03:44, 56.16s/it]
SNet: Task 13, Epoch 17/20 => Loss 1.749,  Train_accy 71.42:  80%|████████  | 16/20 [15:11<03:44, 56.16s/it]                 
SNet: Task 13, Epoch 17/20 => Loss 1.749,  Train_accy 71.42:  85%|████████▌ | 17/20 [15:11<02:41, 53.94s/it]
SNet: Task 13, Epoch 18/20 => Loss 1.711,  Train_accy 72.34:  85%|████████▌ | 17/20 [16:00<02:41, 53.94s/it]
SNet: Task 13, Epoch 18/20 => Loss 1.711,  Train_accy 72.34:  90%|█████████ | 18/20 [16:00<01:44, 52.39s/it]
SNet: Task 13, Epoch 19/20 => Loss 1.744,  Train_accy 71.97:  90%|█████████ | 18/20 [16:48<01:44, 52.39s/it]
SNet: Task 13, Epoch 19/20 => Loss 1.744,  Train_accy 71.97:  95%|█████████▌| 19/20 [16:48<00:51, 51.32s/it]
SNet: Task 13, Epoch 20/20 => Loss 1.750,  Train_accy 72.26:  95%|█████████▌| 19/20 [17:37<00:51, 51.32s/it]
SNet: Task 13, Epoch 20/20 => Loss 1.750,  Train_accy 72.26: 100%|██████████| 20/20 [17:37<00:00, 50.58s/it]
SNet: Task 13, Epoch 20/20 => Loss 1.750,  Train_accy 72.26: 100%|██████████| 20/20 [17:37<00:00, 52.89s/it]
2024-09-05 07:21:57,063 [foster.py] => SNet: Task 13, Epoch 20/20 => Loss 1.750,  Train_accy 72.26
2024-09-05 07:21:57,063 [foster.py] => do not weight align student!
2024-09-05 07:22:17,308 [foster.py] => darknet eval: 
2024-09-05 07:22:17,309 [foster.py] => CNN top1 curve: 89.74
2024-09-05 07:22:17,309 [foster.py] => CNN top5 curve: 99.13
2024-09-05 07:22:17,311 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 07:24:14,528 [foster.py] => Exemplar size: 1400
2024-09-05 07:24:14,528 [trainer.py] => CNN: {'total': 90.27, '00-04': 93.4, '05-09': 90.6, '10-14': 90.2, '15-19': 91.6, '20-24': 96.0, '25-29': 92.2, '30-34': 91.2, '35-39': 91.6, '40-44': 90.6, '45-49': 91.8, '50-54': 87.4, '55-59': 89.4, '60-64': 81.4, '65-69': 86.4, 'old': 90.57, 'new': 86.4}
2024-09-05 07:24:14,528 [trainer.py] => NME: {'total': 91.06, '00-04': 93.4, '05-09': 89.2, '10-14': 89.0, '15-19': 90.8, '20-24': 96.0, '25-29': 92.0, '30-34': 91.0, '35-39': 89.8, '40-44': 89.4, '45-49': 93.0, '50-54': 88.2, '55-59': 89.4, '60-64': 87.0, '65-69': 96.6, 'old': 90.63, 'new': 96.6}
2024-09-05 07:24:14,528 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2, 90.27]
2024-09-05 07:24:14,528 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17, 99.17]
2024-09-05 07:24:14,528 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97, 91.06]
2024-09-05 07:24:14,528 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14, 99.17]

Average Accuracy (CNN): 93.64
Average Accuracy (NME): 94.24
2024-09-05 07:24:14,528 [trainer.py] => Average Accuracy (CNN): 93.64
2024-09-05 07:24:14,528 [trainer.py] => Average Accuracy (NME): 94.24
2024-09-05 07:24:14,530 [trainer.py] => All params: 171808717
2024-09-05 07:24:14,531 [trainer.py] => Trainable params: 85960076
2024-09-05 07:24:15,901 [foster.py] => Learning on 70-75
2024-09-05 07:24:15,902 [foster.py] => All params: 171824092
2024-09-05 07:24:15,903 [foster.py] => Trainable params: 85971606
2024-09-05 07:24:15,983 [foster.py] => per cls weights : [1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 0.5749392  0.5749392
 0.5749392  0.5749392  0.5749392 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 4.975, Loss_clf 0.837, Loss_fe 2.024, Loss_kd 1.973, Train_accy 63.74, Test_accy 88.32:   0%|          | 0/20 [01:21<?, ?it/s]
Task 14, Epoch 1/20 => Loss 4.975, Loss_clf 0.837, Loss_fe 2.024, Loss_kd 1.973, Train_accy 63.74, Test_accy 88.32:   5%|▌         | 1/20 [01:21<25:46, 81.37s/it]
Task 14, Epoch 2/20 => Loss 3.462, Loss_clf 0.447, Loss_fe 0.899, Loss_kd 1.976, Train_accy 64.05:   5%|▌         | 1/20 [02:01<25:46, 81.37s/it]                 
Task 14, Epoch 2/20 => Loss 3.462, Loss_clf 0.447, Loss_fe 0.899, Loss_kd 1.976, Train_accy 64.05:  10%|█         | 2/20 [02:01<17:05, 56.95s/it]
Task 14, Epoch 3/20 => Loss 3.196, Loss_clf 0.395, Loss_fe 0.681, Loss_kd 1.978, Train_accy 65.90:  10%|█         | 2/20 [02:41<17:05, 56.95s/it]
Task 14, Epoch 3/20 => Loss 3.196, Loss_clf 0.395, Loss_fe 0.681, Loss_kd 1.978, Train_accy 65.90:  15%|█▌        | 3/20 [02:41<13:55, 49.14s/it]
Task 14, Epoch 4/20 => Loss 3.085, Loss_clf 0.371, Loss_fe 0.607, Loss_kd 1.967, Train_accy 66.64:  15%|█▌        | 3/20 [03:20<13:55, 49.14s/it]
Task 14, Epoch 4/20 => Loss 3.085, Loss_clf 0.371, Loss_fe 0.607, Loss_kd 1.967, Train_accy 66.64:  20%|██        | 4/20 [03:20<12:07, 45.48s/it]
Task 14, Epoch 5/20 => Loss 2.964, Loss_clf 0.355, Loss_fe 0.538, Loss_kd 1.933, Train_accy 68.87:  20%|██        | 4/20 [04:00<12:07, 45.48s/it]
Task 14, Epoch 5/20 => Loss 2.964, Loss_clf 0.355, Loss_fe 0.538, Loss_kd 1.933, Train_accy 68.87:  25%|██▌       | 5/20 [04:00<10:51, 43.46s/it]
Task 14, Epoch 6/20 => Loss 3.000, Loss_clf 0.367, Loss_fe 0.511, Loss_kd 1.980, Train_accy 68.59, Test_accy 89.43:  25%|██▌       | 5/20 [05:22<10:51, 43.46s/it]
Task 14, Epoch 6/20 => Loss 3.000, Loss_clf 0.367, Loss_fe 0.511, Loss_kd 1.980, Train_accy 68.59, Test_accy 89.43:  30%|███       | 6/20 [05:22<13:09, 56.40s/it]
Task 14, Epoch 7/20 => Loss 2.817, Loss_clf 0.312, Loss_fe 0.431, Loss_kd 1.935, Train_accy 71.23:  30%|███       | 6/20 [06:02<13:09, 56.40s/it]                 
Task 14, Epoch 7/20 => Loss 2.817, Loss_clf 0.312, Loss_fe 0.431, Loss_kd 1.935, Train_accy 71.23:  35%|███▌      | 7/20 [06:02<11:03, 51.00s/it]
Task 14, Epoch 8/20 => Loss 2.828, Loss_clf 0.322, Loss_fe 0.410, Loss_kd 1.957, Train_accy 71.56:  35%|███▌      | 7/20 [06:42<11:03, 51.00s/it]
Task 14, Epoch 8/20 => Loss 2.828, Loss_clf 0.322, Loss_fe 0.410, Loss_kd 1.957, Train_accy 71.56:  40%|████      | 8/20 [06:42<09:29, 47.47s/it]
Task 14, Epoch 9/20 => Loss 2.807, Loss_clf 0.328, Loss_fe 0.387, Loss_kd 1.953, Train_accy 73.03:  40%|████      | 8/20 [07:22<09:29, 47.47s/it]
Task 14, Epoch 9/20 => Loss 2.807, Loss_clf 0.328, Loss_fe 0.387, Loss_kd 1.953, Train_accy 73.03:  45%|████▌     | 9/20 [07:22<08:16, 45.10s/it]
Task 14, Epoch 10/20 => Loss 2.759, Loss_clf 0.303, Loss_fe 0.358, Loss_kd 1.959, Train_accy 74.59:  45%|████▌     | 9/20 [08:01<08:16, 45.10s/it]
Task 14, Epoch 10/20 => Loss 2.759, Loss_clf 0.303, Loss_fe 0.358, Loss_kd 1.959, Train_accy 74.59:  50%|█████     | 10/20 [08:01<07:14, 43.48s/it]
Task 14, Epoch 11/20 => Loss 2.724, Loss_clf 0.305, Loss_fe 0.334, Loss_kd 1.945, Train_accy 74.90, Test_accy 89.19:  50%|█████     | 10/20 [09:23<07:14, 43.48s/it]
Task 14, Epoch 11/20 => Loss 2.724, Loss_clf 0.305, Loss_fe 0.334, Loss_kd 1.945, Train_accy 74.90, Test_accy 89.19:  55%|█████▌    | 11/20 [09:23<08:16, 55.14s/it]
Task 14, Epoch 12/20 => Loss 2.686, Loss_clf 0.283, Loss_fe 0.308, Loss_kd 1.956, Train_accy 74.77:  55%|█████▌    | 11/20 [10:03<08:16, 55.14s/it]                 
Task 14, Epoch 12/20 => Loss 2.686, Loss_clf 0.283, Loss_fe 0.308, Loss_kd 1.956, Train_accy 74.77:  60%|██████    | 12/20 [10:03<06:44, 50.50s/it]
Task 14, Epoch 13/20 => Loss 2.716, Loss_clf 0.301, Loss_fe 0.299, Loss_kd 1.976, Train_accy 74.74:  60%|██████    | 12/20 [10:43<06:44, 50.50s/it]
Task 14, Epoch 13/20 => Loss 2.716, Loss_clf 0.301, Loss_fe 0.299, Loss_kd 1.976, Train_accy 74.74:  65%|██████▌   | 13/20 [10:43<05:30, 47.27s/it]
Task 14, Epoch 14/20 => Loss 2.694, Loss_clf 0.293, Loss_fe 0.296, Loss_kd 1.964, Train_accy 76.51:  65%|██████▌   | 13/20 [11:23<05:30, 47.27s/it]
Task 14, Epoch 14/20 => Loss 2.694, Loss_clf 0.293, Loss_fe 0.296, Loss_kd 1.964, Train_accy 76.51:  70%|███████   | 14/20 [11:23<04:30, 45.03s/it]
Task 14, Epoch 15/20 => Loss 2.619, Loss_clf 0.266, Loss_fe 0.259, Loss_kd 1.954, Train_accy 77.38:  70%|███████   | 14/20 [12:02<04:30, 45.03s/it]
Task 14, Epoch 15/20 => Loss 2.619, Loss_clf 0.266, Loss_fe 0.259, Loss_kd 1.954, Train_accy 77.38:  75%|███████▌  | 15/20 [12:02<03:37, 43.47s/it]
Task 14, Epoch 16/20 => Loss 2.600, Loss_clf 0.269, Loss_fe 0.247, Loss_kd 1.945, Train_accy 78.03, Test_accy 89.61:  75%|███████▌  | 15/20 [13:24<03:37, 43.47s/it]
Task 14, Epoch 16/20 => Loss 2.600, Loss_clf 0.269, Loss_fe 0.247, Loss_kd 1.945, Train_accy 78.03, Test_accy 89.61:  80%|████████  | 16/20 [13:24<03:39, 54.92s/it]
Task 14, Epoch 17/20 => Loss 2.541, Loss_clf 0.242, Loss_fe 0.217, Loss_kd 1.943, Train_accy 79.15:  80%|████████  | 16/20 [14:04<03:39, 54.92s/it]                 
Task 14, Epoch 17/20 => Loss 2.541, Loss_clf 0.242, Loss_fe 0.217, Loss_kd 1.943, Train_accy 79.15:  85%|████████▌ | 17/20 [14:04<02:31, 50.41s/it]
Task 14, Epoch 18/20 => Loss 2.592, Loss_clf 0.259, Loss_fe 0.239, Loss_kd 1.955, Train_accy 78.64:  85%|████████▌ | 17/20 [14:44<02:31, 50.41s/it]
Task 14, Epoch 18/20 => Loss 2.592, Loss_clf 0.259, Loss_fe 0.239, Loss_kd 1.955, Train_accy 78.64:  90%|█████████ | 18/20 [14:44<01:34, 47.26s/it]
Task 14, Epoch 19/20 => Loss 2.618, Loss_clf 0.273, Loss_fe 0.241, Loss_kd 1.964, Train_accy 78.31:  90%|█████████ | 18/20 [15:24<01:34, 47.26s/it]
Task 14, Epoch 19/20 => Loss 2.618, Loss_clf 0.273, Loss_fe 0.241, Loss_kd 1.964, Train_accy 78.31:  95%|█████████▌| 19/20 [15:24<00:45, 45.04s/it]
Task 14, Epoch 20/20 => Loss 2.624, Loss_clf 0.270, Loss_fe 0.250, Loss_kd 1.964, Train_accy 78.21:  95%|█████████▌| 19/20 [16:03<00:45, 45.04s/it]
Task 14, Epoch 20/20 => Loss 2.624, Loss_clf 0.270, Loss_fe 0.250, Loss_kd 1.964, Train_accy 78.21: 100%|██████████| 20/20 [16:03<00:00, 43.48s/it]
Task 14, Epoch 20/20 => Loss 2.624, Loss_clf 0.270, Loss_fe 0.250, Loss_kd 1.964, Train_accy 78.21: 100%|██████████| 20/20 [16:03<00:00, 48.20s/it]
2024-09-05 07:40:19,943 [foster.py] => Task 14, Epoch 20/20 => Loss 2.624, Loss_clf 0.270, Loss_fe 0.250, Loss_kd 1.964, Train_accy 78.21
2024-09-05 07:40:19,944 [foster.py] => do not weight align teacher!
2024-09-05 07:40:19,947 [foster.py] => per cls weights : [1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 0.4733666  0.4733666
 0.4733666  0.4733666  0.4733666 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 14, Epoch 1/20 => Loss 2.095,  Train_accy 57.15, Test_accy 88.76:   0%|          | 0/20 [01:11<?, ?it/s]
SNet: Task 14, Epoch 1/20 => Loss 2.095,  Train_accy 57.15, Test_accy 88.76:   5%|▌         | 1/20 [01:11<22:42, 71.71s/it]
SNet: Task 14, Epoch 2/20 => Loss 1.935,  Train_accy 63.77:   5%|▌         | 1/20 [02:01<22:42, 71.71s/it]                 
SNet: Task 14, Epoch 2/20 => Loss 1.935,  Train_accy 63.77:  10%|█         | 2/20 [02:01<17:42, 59.01s/it]
SNet: Task 14, Epoch 3/20 => Loss 1.932,  Train_accy 63.77:  10%|█         | 2/20 [02:51<17:42, 59.01s/it]
SNet: Task 14, Epoch 3/20 => Loss 1.932,  Train_accy 63.77:  15%|█▌        | 3/20 [02:51<15:34, 54.97s/it]
SNet: Task 14, Epoch 4/20 => Loss 1.920,  Train_accy 62.62:  15%|█▌        | 3/20 [03:42<15:34, 54.97s/it]
SNet: Task 14, Epoch 4/20 => Loss 1.920,  Train_accy 62.62:  20%|██        | 4/20 [03:42<14:09, 53.07s/it]
SNet: Task 14, Epoch 5/20 => Loss 1.920,  Train_accy 63.77:  20%|██        | 4/20 [04:32<14:09, 53.07s/it]
SNet: Task 14, Epoch 5/20 => Loss 1.920,  Train_accy 63.77:  25%|██▌       | 5/20 [04:32<13:00, 52.04s/it]
SNet: Task 14, Epoch 6/20 => Loss 1.932,  Train_accy 63.26, Test_accy 88.91:  25%|██▌       | 5/20 [05:44<13:00, 52.04s/it]
SNet: Task 14, Epoch 6/20 => Loss 1.932,  Train_accy 63.26, Test_accy 88.91:  30%|███       | 6/20 [05:44<13:42, 58.78s/it]
SNet: Task 14, Epoch 7/20 => Loss 1.907,  Train_accy 64.00:  30%|███       | 6/20 [06:34<13:42, 58.78s/it]                 
SNet: Task 14, Epoch 7/20 => Loss 1.907,  Train_accy 64.00:  35%|███▌      | 7/20 [06:34<12:07, 55.94s/it]
SNet: Task 14, Epoch 8/20 => Loss 1.921,  Train_accy 63.87:  35%|███▌      | 7/20 [07:24<12:07, 55.94s/it]
SNet: Task 14, Epoch 8/20 => Loss 1.921,  Train_accy 63.87:  40%|████      | 8/20 [07:24<10:49, 54.10s/it]
SNet: Task 14, Epoch 9/20 => Loss 1.887,  Train_accy 65.05:  40%|████      | 8/20 [08:14<10:49, 54.10s/it]
SNet: Task 14, Epoch 9/20 => Loss 1.887,  Train_accy 65.05:  45%|████▌     | 9/20 [08:14<09:41, 52.89s/it]
SNet: Task 14, Epoch 10/20 => Loss 1.895,  Train_accy 64.90:  45%|████▌     | 9/20 [09:04<09:41, 52.89s/it]
SNet: Task 14, Epoch 10/20 => Loss 1.895,  Train_accy 64.90:  50%|█████     | 10/20 [09:04<08:40, 52.05s/it]
SNet: Task 14, Epoch 11/20 => Loss 1.887,  Train_accy 64.64, Test_accy 88.91:  50%|█████     | 10/20 [10:16<08:40, 52.05s/it]
SNet: Task 14, Epoch 11/20 => Loss 1.887,  Train_accy 64.64, Test_accy 88.91:  55%|█████▌    | 11/20 [10:16<08:42, 58.08s/it]
SNet: Task 14, Epoch 12/20 => Loss 1.903,  Train_accy 64.64:  55%|█████▌    | 11/20 [11:06<08:42, 58.08s/it]                 
SNet: Task 14, Epoch 12/20 => Loss 1.903,  Train_accy 64.64:  60%|██████    | 12/20 [11:06<07:25, 55.68s/it]
SNet: Task 14, Epoch 13/20 => Loss 1.909,  Train_accy 65.72:  60%|██████    | 12/20 [11:57<07:25, 55.68s/it]
SNet: Task 14, Epoch 13/20 => Loss 1.909,  Train_accy 65.72:  65%|██████▌   | 13/20 [11:57<06:18, 54.01s/it]
SNet: Task 14, Epoch 14/20 => Loss 1.905,  Train_accy 64.95:  65%|██████▌   | 13/20 [12:47<06:18, 54.01s/it]
SNet: Task 14, Epoch 14/20 => Loss 1.905,  Train_accy 64.95:  70%|███████   | 14/20 [12:47<05:17, 52.85s/it]
SNet: Task 14, Epoch 15/20 => Loss 1.885,  Train_accy 64.59:  70%|███████   | 14/20 [13:37<05:17, 52.85s/it]
SNet: Task 14, Epoch 15/20 => Loss 1.885,  Train_accy 64.59:  75%|███████▌  | 15/20 [13:37<04:20, 52.05s/it]
SNet: Task 14, Epoch 16/20 => Loss 1.893,  Train_accy 64.79, Test_accy 88.97:  75%|███████▌  | 15/20 [14:49<04:20, 52.05s/it]
SNet: Task 14, Epoch 16/20 => Loss 1.893,  Train_accy 64.79, Test_accy 88.97:  80%|████████  | 16/20 [14:49<03:51, 57.98s/it]
SNet: Task 14, Epoch 17/20 => Loss 1.882,  Train_accy 65.36:  80%|████████  | 16/20 [15:39<03:51, 57.98s/it]                 
SNet: Task 14, Epoch 17/20 => Loss 1.882,  Train_accy 65.36:  85%|████████▌ | 17/20 [15:39<02:46, 55.62s/it]
SNet: Task 14, Epoch 18/20 => Loss 1.908,  Train_accy 64.87:  85%|████████▌ | 17/20 [16:29<02:46, 55.62s/it]
SNet: Task 14, Epoch 18/20 => Loss 1.908,  Train_accy 64.87:  90%|█████████ | 18/20 [16:29<01:48, 54.03s/it]
SNet: Task 14, Epoch 19/20 => Loss 1.869,  Train_accy 65.03:  90%|█████████ | 18/20 [17:20<01:48, 54.03s/it]
SNet: Task 14, Epoch 19/20 => Loss 1.869,  Train_accy 65.03:  95%|█████████▌| 19/20 [17:20<00:52, 52.95s/it]
SNet: Task 14, Epoch 20/20 => Loss 1.923,  Train_accy 63.69:  95%|█████████▌| 19/20 [18:10<00:52, 52.95s/it]
SNet: Task 14, Epoch 20/20 => Loss 1.923,  Train_accy 63.69: 100%|██████████| 20/20 [18:10<00:00, 52.13s/it]
SNet: Task 14, Epoch 20/20 => Loss 1.923,  Train_accy 63.69: 100%|██████████| 20/20 [18:10<00:00, 54.51s/it]
2024-09-05 07:58:31,697 [foster.py] => SNet: Task 14, Epoch 20/20 => Loss 1.923,  Train_accy 63.69
2024-09-05 07:58:31,697 [foster.py] => do not weight align student!
2024-09-05 07:58:53,467 [foster.py] => darknet eval: 
2024-09-05 07:58:53,467 [foster.py] => CNN top1 curve: 88.96
2024-09-05 07:58:53,468 [foster.py] => CNN top5 curve: 99.13
2024-09-05 07:58:53,470 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 08:00:58,686 [foster.py] => Exemplar size: 1500
2024-09-05 08:00:58,686 [trainer.py] => CNN: {'total': 89.73, '00-04': 91.8, '05-09': 89.8, '10-14': 89.8, '15-19': 91.8, '20-24': 95.4, '25-29': 92.0, '30-34': 91.6, '35-39': 91.8, '40-44': 89.8, '45-49': 92.8, '50-54': 87.6, '55-59': 89.4, '60-64': 83.6, '65-69': 90.6, '70-74': 78.2, 'old': 90.56, 'new': 78.2}
2024-09-05 08:00:58,686 [trainer.py] => NME: {'total': 90.28, '00-04': 95.0, '05-09': 89.8, '10-14': 87.8, '15-19': 91.4, '20-24': 96.2, '25-29': 91.4, '30-34': 91.4, '35-39': 90.2, '40-44': 87.8, '45-49': 92.6, '50-54': 87.6, '55-59': 86.0, '60-64': 78.0, '65-69': 93.6, '70-74': 95.4, 'old': 89.91, 'new': 95.4}
2024-09-05 08:00:58,686 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2, 90.27, 89.73]
2024-09-05 08:00:58,686 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17, 99.17, 99.12]
2024-09-05 08:00:58,686 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97, 91.06, 90.28]
2024-09-05 08:00:58,686 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14, 99.17, 99.16]

Average Accuracy (CNN): 93.38
Average Accuracy (NME): 93.98
2024-09-05 08:00:58,686 [trainer.py] => Average Accuracy (CNN): 93.38
2024-09-05 08:00:58,686 [trainer.py] => Average Accuracy (NME): 93.98
2024-09-05 08:00:58,687 [trainer.py] => All params: 171824092
2024-09-05 08:00:58,688 [trainer.py] => Trainable params: 85971606
2024-09-05 08:01:00,209 [foster.py] => Learning on 75-80
2024-09-05 08:01:00,211 [foster.py] => All params: 171839467
2024-09-05 08:01:00,211 [foster.py] => Trainable params: 85983136
2024-09-05 08:01:00,296 [foster.py] => per cls weights : [1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 0.57385027 0.57385027 0.57385027
 0.57385027 0.57385027]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 4.784, Loss_clf 0.758, Loss_fe 2.111, Loss_kd 1.796, Train_accy 59.02, Test_accy 87.24:   0%|          | 0/20 [01:25<?, ?it/s]
Task 15, Epoch 1/20 => Loss 4.784, Loss_clf 0.758, Loss_fe 2.111, Loss_kd 1.796, Train_accy 59.02, Test_accy 87.24:   5%|▌         | 1/20 [01:25<26:56, 85.09s/it]
Task 15, Epoch 2/20 => Loss 3.376, Loss_clf 0.481, Loss_fe 0.953, Loss_kd 1.821, Train_accy 61.32:   5%|▌         | 1/20 [02:05<26:56, 85.09s/it]                 
Task 15, Epoch 2/20 => Loss 3.376, Loss_clf 0.481, Loss_fe 0.953, Loss_kd 1.821, Train_accy 61.32:  10%|█         | 2/20 [02:05<17:43, 59.06s/it]
Task 15, Epoch 3/20 => Loss 3.088, Loss_clf 0.420, Loss_fe 0.728, Loss_kd 1.819, Train_accy 60.90:  10%|█         | 2/20 [02:46<17:43, 59.06s/it]
Task 15, Epoch 3/20 => Loss 3.088, Loss_clf 0.420, Loss_fe 0.728, Loss_kd 1.819, Train_accy 60.90:  15%|█▌        | 3/20 [02:46<14:22, 50.74s/it]
Task 15, Epoch 4/20 => Loss 3.023, Loss_clf 0.430, Loss_fe 0.656, Loss_kd 1.815, Train_accy 61.75:  15%|█▌        | 3/20 [03:27<14:22, 50.74s/it]
Task 15, Epoch 4/20 => Loss 3.023, Loss_clf 0.430, Loss_fe 0.656, Loss_kd 1.815, Train_accy 61.75:  20%|██        | 4/20 [03:27<12:29, 46.85s/it]
Task 15, Epoch 5/20 => Loss 2.816, Loss_clf 0.368, Loss_fe 0.541, Loss_kd 1.788, Train_accy 63.55:  20%|██        | 4/20 [04:08<12:29, 46.85s/it]
Task 15, Epoch 5/20 => Loss 2.816, Loss_clf 0.368, Loss_fe 0.541, Loss_kd 1.788, Train_accy 63.55:  25%|██▌       | 5/20 [04:08<11:10, 44.68s/it]
Task 15, Epoch 6/20 => Loss 2.898, Loss_clf 0.404, Loss_fe 0.536, Loss_kd 1.835, Train_accy 62.68, Test_accy 87.56:  25%|██▌       | 5/20 [05:33<11:10, 44.68s/it]
Task 15, Epoch 6/20 => Loss 2.898, Loss_clf 0.404, Loss_fe 0.536, Loss_kd 1.835, Train_accy 62.68, Test_accy 87.56:  30%|███       | 6/20 [05:33<13:38, 58.48s/it]
Task 15, Epoch 7/20 => Loss 2.698, Loss_clf 0.345, Loss_fe 0.450, Loss_kd 1.783, Train_accy 63.70:  30%|███       | 6/20 [06:14<13:38, 58.48s/it]                 
Task 15, Epoch 7/20 => Loss 2.698, Loss_clf 0.345, Loss_fe 0.450, Loss_kd 1.783, Train_accy 63.70:  35%|███▌      | 7/20 [06:14<11:25, 52.73s/it]
Task 15, Epoch 8/20 => Loss 2.652, Loss_clf 0.331, Loss_fe 0.409, Loss_kd 1.793, Train_accy 65.50:  35%|███▌      | 7/20 [06:55<11:25, 52.73s/it]
Task 15, Epoch 8/20 => Loss 2.652, Loss_clf 0.331, Loss_fe 0.409, Loss_kd 1.793, Train_accy 65.50:  40%|████      | 8/20 [06:55<09:47, 48.94s/it]
Task 15, Epoch 9/20 => Loss 2.705, Loss_clf 0.349, Loss_fe 0.401, Loss_kd 1.832, Train_accy 65.22:  40%|████      | 8/20 [07:36<09:47, 48.94s/it]
Task 15, Epoch 9/20 => Loss 2.705, Loss_clf 0.349, Loss_fe 0.401, Loss_kd 1.832, Train_accy 65.22:  45%|████▌     | 9/20 [07:36<08:30, 46.42s/it]
Task 15, Epoch 10/20 => Loss 2.665, Loss_clf 0.322, Loss_fe 0.406, Loss_kd 1.816, Train_accy 66.78:  45%|████▌     | 9/20 [08:17<08:30, 46.42s/it]
Task 15, Epoch 10/20 => Loss 2.665, Loss_clf 0.322, Loss_fe 0.406, Loss_kd 1.816, Train_accy 66.78:  50%|█████     | 10/20 [08:17<07:26, 44.69s/it]
Task 15, Epoch 11/20 => Loss 2.657, Loss_clf 0.335, Loss_fe 0.372, Loss_kd 1.828, Train_accy 67.35, Test_accy 88.05:  50%|█████     | 10/20 [09:42<07:26, 44.69s/it]
Task 15, Epoch 11/20 => Loss 2.657, Loss_clf 0.335, Loss_fe 0.372, Loss_kd 1.828, Train_accy 67.35, Test_accy 88.05:  55%|█████▌    | 11/20 [09:42<08:33, 57.08s/it]
Task 15, Epoch 12/20 => Loss 2.530, Loss_clf 0.292, Loss_fe 0.310, Loss_kd 1.807, Train_accy 69.25:  55%|█████▌    | 11/20 [10:23<08:33, 57.08s/it]                 
Task 15, Epoch 12/20 => Loss 2.530, Loss_clf 0.292, Loss_fe 0.310, Loss_kd 1.807, Train_accy 69.25:  60%|██████    | 12/20 [10:23<06:57, 52.14s/it]
Task 15, Epoch 13/20 => Loss 2.482, Loss_clf 0.285, Loss_fe 0.297, Loss_kd 1.781, Train_accy 68.53:  60%|██████    | 12/20 [11:04<06:57, 52.14s/it]
Task 15, Epoch 13/20 => Loss 2.482, Loss_clf 0.285, Loss_fe 0.297, Loss_kd 1.781, Train_accy 68.53:  65%|██████▌   | 13/20 [11:04<05:41, 48.74s/it]
Task 15, Epoch 14/20 => Loss 2.488, Loss_clf 0.286, Loss_fe 0.300, Loss_kd 1.783, Train_accy 69.32:  65%|██████▌   | 13/20 [11:45<05:41, 48.74s/it]
Task 15, Epoch 14/20 => Loss 2.488, Loss_clf 0.286, Loss_fe 0.300, Loss_kd 1.783, Train_accy 69.32:  70%|███████   | 14/20 [11:45<04:38, 46.37s/it]
Task 15, Epoch 15/20 => Loss 2.478, Loss_clf 0.291, Loss_fe 0.269, Loss_kd 1.799, Train_accy 69.65:  70%|███████   | 14/20 [12:25<04:38, 46.37s/it]
Task 15, Epoch 15/20 => Loss 2.478, Loss_clf 0.291, Loss_fe 0.269, Loss_kd 1.799, Train_accy 69.65:  75%|███████▌  | 15/20 [12:25<03:43, 44.70s/it]
Task 15, Epoch 16/20 => Loss 2.522, Loss_clf 0.300, Loss_fe 0.286, Loss_kd 1.815, Train_accy 68.55, Test_accy 88.41:  75%|███████▌  | 15/20 [13:51<03:43, 44.70s/it]
Task 15, Epoch 16/20 => Loss 2.522, Loss_clf 0.300, Loss_fe 0.286, Loss_kd 1.815, Train_accy 68.55, Test_accy 88.41:  80%|████████  | 16/20 [13:51<03:47, 56.92s/it]
Task 15, Epoch 17/20 => Loss 2.377, Loss_clf 0.248, Loss_fe 0.223, Loss_kd 1.787, Train_accy 71.88:  80%|████████  | 16/20 [14:31<03:47, 56.92s/it]                 
Task 15, Epoch 17/20 => Loss 2.377, Loss_clf 0.248, Loss_fe 0.223, Loss_kd 1.787, Train_accy 71.88:  85%|████████▌ | 17/20 [14:31<02:36, 52.08s/it]
Task 15, Epoch 18/20 => Loss 2.461, Loss_clf 0.278, Loss_fe 0.256, Loss_kd 1.806, Train_accy 72.75:  85%|████████▌ | 17/20 [15:12<02:36, 52.08s/it]
Task 15, Epoch 18/20 => Loss 2.461, Loss_clf 0.278, Loss_fe 0.256, Loss_kd 1.806, Train_accy 72.75:  90%|█████████ | 18/20 [15:12<01:37, 48.76s/it]
Task 15, Epoch 19/20 => Loss 2.434, Loss_clf 0.257, Loss_fe 0.239, Loss_kd 1.818, Train_accy 73.20:  90%|█████████ | 18/20 [15:53<01:37, 48.76s/it]
Task 15, Epoch 19/20 => Loss 2.434, Loss_clf 0.257, Loss_fe 0.239, Loss_kd 1.818, Train_accy 73.20:  95%|█████████▌| 19/20 [15:53<00:46, 46.38s/it]
Task 15, Epoch 20/20 => Loss 2.432, Loss_clf 0.267, Loss_fe 0.243, Loss_kd 1.801, Train_accy 72.03:  95%|█████████▌| 19/20 [16:34<00:46, 46.38s/it]
Task 15, Epoch 20/20 => Loss 2.432, Loss_clf 0.267, Loss_fe 0.243, Loss_kd 1.801, Train_accy 72.03: 100%|██████████| 20/20 [16:34<00:00, 44.71s/it]
Task 15, Epoch 20/20 => Loss 2.432, Loss_clf 0.267, Loss_fe 0.243, Loss_kd 1.801, Train_accy 72.03: 100%|██████████| 20/20 [16:34<00:00, 49.73s/it]
2024-09-05 08:17:34,925 [foster.py] => Task 15, Epoch 20/20 => Loss 2.432, Loss_clf 0.267, Loss_fe 0.243, Loss_kd 1.801, Train_accy 72.03
2024-09-05 08:17:34,927 [foster.py] => do not weight align teacher!
2024-09-05 08:17:34,930 [foster.py] => per cls weights : [1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 0.4722563  0.4722563  0.4722563
 0.4722563  0.4722563 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 15, Epoch 1/20 => Loss 1.905,  Train_accy 54.00, Test_accy 87.44:   0%|          | 0/20 [01:14<?, ?it/s]
SNet: Task 15, Epoch 1/20 => Loss 1.905,  Train_accy 54.00, Test_accy 87.44:   5%|▌         | 1/20 [01:14<23:36, 74.53s/it]
SNet: Task 15, Epoch 2/20 => Loss 1.828,  Train_accy 57.30:   5%|▌         | 1/20 [02:05<23:36, 74.53s/it]                 
SNet: Task 15, Epoch 2/20 => Loss 1.828,  Train_accy 57.30:  10%|█         | 2/20 [02:05<18:16, 60.93s/it]
SNet: Task 15, Epoch 3/20 => Loss 1.799,  Train_accy 56.52:  10%|█         | 2/20 [02:57<18:16, 60.93s/it]
SNet: Task 15, Epoch 3/20 => Loss 1.799,  Train_accy 56.52:  15%|█▌        | 3/20 [02:57<16:02, 56.60s/it]
SNet: Task 15, Epoch 4/20 => Loss 1.787,  Train_accy 58.25:  15%|█▌        | 3/20 [03:48<16:02, 56.60s/it]
SNet: Task 15, Epoch 4/20 => Loss 1.787,  Train_accy 58.25:  20%|██        | 4/20 [03:48<14:32, 54.55s/it]
SNet: Task 15, Epoch 5/20 => Loss 1.802,  Train_accy 57.30:  20%|██        | 4/20 [04:40<14:32, 54.55s/it]
SNet: Task 15, Epoch 5/20 => Loss 1.802,  Train_accy 57.30:  25%|██▌       | 5/20 [04:40<13:21, 53.45s/it]
SNet: Task 15, Epoch 6/20 => Loss 1.825,  Train_accy 57.80, Test_accy 87.90:  25%|██▌       | 5/20 [05:54<13:21, 53.45s/it]
SNet: Task 15, Epoch 6/20 => Loss 1.825,  Train_accy 57.80, Test_accy 87.90:  30%|███       | 6/20 [05:54<14:09, 60.65s/it]
SNet: Task 15, Epoch 7/20 => Loss 1.820,  Train_accy 58.90:  30%|███       | 6/20 [06:46<14:09, 60.65s/it]                 
SNet: Task 15, Epoch 7/20 => Loss 1.820,  Train_accy 58.90:  35%|███▌      | 7/20 [06:46<12:28, 57.61s/it]
SNet: Task 15, Epoch 8/20 => Loss 1.794,  Train_accy 58.62:  35%|███▌      | 7/20 [07:37<12:28, 57.61s/it]
SNet: Task 15, Epoch 8/20 => Loss 1.794,  Train_accy 58.62:  40%|████      | 8/20 [07:37<11:07, 55.64s/it]
SNet: Task 15, Epoch 9/20 => Loss 1.806,  Train_accy 58.52:  40%|████      | 8/20 [08:29<11:07, 55.64s/it]
SNet: Task 15, Epoch 9/20 => Loss 1.806,  Train_accy 58.52:  45%|████▌     | 9/20 [08:29<09:57, 54.34s/it]
SNet: Task 15, Epoch 10/20 => Loss 1.794,  Train_accy 57.25:  45%|████▌     | 9/20 [09:20<09:57, 54.34s/it]
SNet: Task 15, Epoch 10/20 => Loss 1.794,  Train_accy 57.25:  50%|█████     | 10/20 [09:20<08:54, 53.44s/it]
SNet: Task 15, Epoch 11/20 => Loss 1.776,  Train_accy 58.45, Test_accy 87.82:  50%|█████     | 10/20 [10:35<08:54, 53.44s/it]
SNet: Task 15, Epoch 11/20 => Loss 1.776,  Train_accy 58.45, Test_accy 87.82:  55%|█████▌    | 11/20 [10:35<08:58, 59.88s/it]
SNet: Task 15, Epoch 12/20 => Loss 1.778,  Train_accy 58.10:  55%|█████▌    | 11/20 [11:26<08:58, 59.88s/it]                 
SNet: Task 15, Epoch 12/20 => Loss 1.778,  Train_accy 58.10:  60%|██████    | 12/20 [11:26<07:38, 57.30s/it]
SNet: Task 15, Epoch 13/20 => Loss 1.790,  Train_accy 57.92:  60%|██████    | 12/20 [12:17<07:38, 57.30s/it]
SNet: Task 15, Epoch 13/20 => Loss 1.790,  Train_accy 57.92:  65%|██████▌   | 13/20 [12:17<06:28, 55.51s/it]
SNet: Task 15, Epoch 14/20 => Loss 1.805,  Train_accy 58.28:  65%|██████▌   | 13/20 [13:09<06:28, 55.51s/it]
SNet: Task 15, Epoch 14/20 => Loss 1.805,  Train_accy 58.28:  70%|███████   | 14/20 [13:09<05:25, 54.29s/it]
SNet: Task 15, Epoch 15/20 => Loss 1.809,  Train_accy 58.72:  70%|███████   | 14/20 [14:00<05:25, 54.29s/it]
SNet: Task 15, Epoch 15/20 => Loss 1.809,  Train_accy 58.72:  75%|███████▌  | 15/20 [14:00<04:27, 53.42s/it]
SNet: Task 15, Epoch 16/20 => Loss 1.794,  Train_accy 58.28, Test_accy 87.84:  75%|███████▌  | 15/20 [15:15<04:27, 53.42s/it]
SNet: Task 15, Epoch 16/20 => Loss 1.794,  Train_accy 58.28, Test_accy 87.84:  80%|████████  | 16/20 [15:15<03:59, 59.78s/it]
SNet: Task 15, Epoch 17/20 => Loss 1.786,  Train_accy 58.55:  80%|████████  | 16/20 [16:06<03:59, 59.78s/it]                 
SNet: Task 15, Epoch 17/20 => Loss 1.786,  Train_accy 58.55:  85%|████████▌ | 17/20 [16:06<02:51, 57.27s/it]
SNet: Task 15, Epoch 18/20 => Loss 1.788,  Train_accy 58.05:  85%|████████▌ | 17/20 [16:58<02:51, 57.27s/it]
SNet: Task 15, Epoch 18/20 => Loss 1.788,  Train_accy 58.05:  90%|█████████ | 18/20 [16:58<01:51, 55.52s/it]
SNet: Task 15, Epoch 19/20 => Loss 1.812,  Train_accy 58.80:  90%|█████████ | 18/20 [17:49<01:51, 55.52s/it]
SNet: Task 15, Epoch 19/20 => Loss 1.812,  Train_accy 58.80:  95%|█████████▌| 19/20 [17:49<00:54, 54.28s/it]
SNet: Task 15, Epoch 20/20 => Loss 1.827,  Train_accy 57.50:  95%|█████████▌| 19/20 [18:40<00:54, 54.28s/it]
SNet: Task 15, Epoch 20/20 => Loss 1.827,  Train_accy 57.50: 100%|██████████| 20/20 [18:40<00:00, 53.41s/it]
SNet: Task 15, Epoch 20/20 => Loss 1.827,  Train_accy 57.50: 100%|██████████| 20/20 [18:40<00:00, 56.05s/it]
2024-09-05 08:36:17,276 [foster.py] => SNet: Task 15, Epoch 20/20 => Loss 1.827,  Train_accy 57.50
2024-09-05 08:36:17,276 [foster.py] => do not weight align student!
2024-09-05 08:36:40,344 [foster.py] => darknet eval: 
2024-09-05 08:36:40,344 [foster.py] => CNN top1 curve: 87.78
2024-09-05 08:36:40,344 [foster.py] => CNN top5 curve: 99.11
2024-09-05 08:36:40,347 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 08:38:52,542 [foster.py] => Exemplar size: 1600
2024-09-05 08:38:52,542 [trainer.py] => CNN: {'total': 88.29, '00-04': 90.8, '05-09': 88.0, '10-14': 88.6, '15-19': 90.8, '20-24': 95.8, '25-29': 92.0, '30-34': 91.2, '35-39': 91.6, '40-44': 89.6, '45-49': 92.6, '50-54': 89.0, '55-59': 87.6, '60-64': 84.4, '65-69': 93.0, '70-74': 81.4, '75-79': 66.2, 'old': 89.76, 'new': 66.2}
2024-09-05 08:38:52,542 [trainer.py] => NME: {'total': 89.14, '00-04': 94.2, '05-09': 90.2, '10-14': 87.8, '15-19': 91.0, '20-24': 96.2, '25-29': 92.0, '30-34': 90.2, '35-39': 89.4, '40-44': 88.0, '45-49': 88.2, '50-54': 80.6, '55-59': 85.2, '60-64': 84.8, '65-69': 94.6, '70-74': 84.6, '75-79': 89.2, 'old': 89.13, 'new': 89.2}
2024-09-05 08:38:52,543 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2, 90.27, 89.73, 88.29]
2024-09-05 08:38:52,543 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17, 99.17, 99.12, 99.05]
2024-09-05 08:38:52,543 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97, 91.06, 90.28, 89.14]
2024-09-05 08:38:52,543 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14, 99.17, 99.16, 98.96]

Average Accuracy (CNN): 93.06
Average Accuracy (NME): 93.68
2024-09-05 08:38:52,543 [trainer.py] => Average Accuracy (CNN): 93.06
2024-09-05 08:38:52,543 [trainer.py] => Average Accuracy (NME): 93.68
2024-09-05 08:38:52,544 [trainer.py] => All params: 171839467
2024-09-05 08:38:52,545 [trainer.py] => Trainable params: 85983136
2024-09-05 08:38:53,896 [foster.py] => Learning on 80-85
2024-09-05 08:38:53,898 [foster.py] => All params: 171854842
2024-09-05 08:38:53,898 [foster.py] => Trainable params: 85994666
2024-09-05 08:38:53,982 [foster.py] => per cls weights : [1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  0.57289286 0.57289286 0.57289286 0.57289286
 0.57289286]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 4.799, Loss_clf 0.766, Loss_fe 2.213, Loss_kd 1.713, Train_accy 61.20, Test_accy 86.62:   0%|          | 0/20 [01:28<?, ?it/s]
Task 16, Epoch 1/20 => Loss 4.799, Loss_clf 0.766, Loss_fe 2.213, Loss_kd 1.713, Train_accy 61.20, Test_accy 86.62:   5%|▌         | 1/20 [01:28<28:07, 88.80s/it]
Task 16, Epoch 2/20 => Loss 3.271, Loss_clf 0.427, Loss_fe 1.029, Loss_kd 1.708, Train_accy 63.88:   5%|▌         | 1/20 [02:10<28:07, 88.80s/it]                 
Task 16, Epoch 2/20 => Loss 3.271, Loss_clf 0.427, Loss_fe 1.029, Loss_kd 1.708, Train_accy 63.88:  10%|█         | 2/20 [02:10<18:21, 61.21s/it]
Task 16, Epoch 3/20 => Loss 2.836, Loss_clf 0.350, Loss_fe 0.706, Loss_kd 1.675, Train_accy 63.88:  10%|█         | 2/20 [02:52<18:21, 61.21s/it]
Task 16, Epoch 3/20 => Loss 2.836, Loss_clf 0.350, Loss_fe 0.706, Loss_kd 1.675, Train_accy 63.88:  15%|█▌        | 3/20 [02:52<14:50, 52.40s/it]
Task 16, Epoch 4/20 => Loss 2.765, Loss_clf 0.363, Loss_fe 0.609, Loss_kd 1.687, Train_accy 63.76:  15%|█▌        | 3/20 [03:34<14:50, 52.40s/it]
Task 16, Epoch 4/20 => Loss 2.765, Loss_clf 0.363, Loss_fe 0.609, Loss_kd 1.687, Train_accy 63.76:  20%|██        | 4/20 [03:34<12:52, 48.25s/it]
Task 16, Epoch 5/20 => Loss 2.630, Loss_clf 0.345, Loss_fe 0.496, Loss_kd 1.684, Train_accy 65.05:  20%|██        | 4/20 [04:16<12:52, 48.25s/it]
Task 16, Epoch 5/20 => Loss 2.630, Loss_clf 0.345, Loss_fe 0.496, Loss_kd 1.684, Train_accy 65.05:  25%|██▌       | 5/20 [04:16<11:29, 45.94s/it]
Task 16, Epoch 6/20 => Loss 2.594, Loss_clf 0.338, Loss_fe 0.482, Loss_kd 1.669, Train_accy 64.63, Test_accy 86.51:  25%|██▌       | 5/20 [05:45<11:29, 45.94s/it]
Task 16, Epoch 6/20 => Loss 2.594, Loss_clf 0.338, Loss_fe 0.482, Loss_kd 1.669, Train_accy 64.63, Test_accy 86.51:  30%|███       | 6/20 [05:45<14:08, 60.59s/it]
Task 16, Epoch 7/20 => Loss 2.495, Loss_clf 0.314, Loss_fe 0.409, Loss_kd 1.668, Train_accy 67.71:  30%|███       | 6/20 [06:27<14:08, 60.59s/it]                 
Task 16, Epoch 7/20 => Loss 2.495, Loss_clf 0.314, Loss_fe 0.409, Loss_kd 1.668, Train_accy 67.71:  35%|███▌      | 7/20 [06:27<11:48, 54.49s/it]
Task 16, Epoch 8/20 => Loss 2.483, Loss_clf 0.313, Loss_fe 0.382, Loss_kd 1.683, Train_accy 67.39:  35%|███▌      | 7/20 [07:09<11:48, 54.49s/it]
Task 16, Epoch 8/20 => Loss 2.483, Loss_clf 0.313, Loss_fe 0.382, Loss_kd 1.683, Train_accy 67.39:  40%|████      | 8/20 [07:09<10:05, 50.48s/it]
Task 16, Epoch 9/20 => Loss 2.424, Loss_clf 0.292, Loss_fe 0.358, Loss_kd 1.669, Train_accy 68.17:  40%|████      | 8/20 [07:51<10:05, 50.48s/it]
Task 16, Epoch 9/20 => Loss 2.424, Loss_clf 0.292, Loss_fe 0.358, Loss_kd 1.669, Train_accy 68.17:  45%|████▌     | 9/20 [07:51<08:45, 47.80s/it]
Task 16, Epoch 10/20 => Loss 2.503, Loss_clf 0.325, Loss_fe 0.368, Loss_kd 1.703, Train_accy 66.85:  45%|████▌     | 9/20 [08:33<08:45, 47.80s/it]
Task 16, Epoch 10/20 => Loss 2.503, Loss_clf 0.325, Loss_fe 0.368, Loss_kd 1.703, Train_accy 66.85:  50%|█████     | 10/20 [08:33<07:39, 45.99s/it]
Task 16, Epoch 11/20 => Loss 2.440, Loss_clf 0.289, Loss_fe 0.346, Loss_kd 1.699, Train_accy 68.66, Test_accy 87.19:  50%|█████     | 10/20 [10:02<07:39, 45.99s/it]
Task 16, Epoch 11/20 => Loss 2.440, Loss_clf 0.289, Loss_fe 0.346, Loss_kd 1.699, Train_accy 68.66, Test_accy 87.19:  55%|█████▌    | 11/20 [10:02<08:52, 59.16s/it]
Task 16, Epoch 12/20 => Loss 2.379, Loss_clf 0.272, Loss_fe 0.302, Loss_kd 1.699, Train_accy 70.66:  55%|█████▌    | 11/20 [10:43<08:52, 59.16s/it]                 
Task 16, Epoch 12/20 => Loss 2.379, Loss_clf 0.272, Loss_fe 0.302, Loss_kd 1.699, Train_accy 70.66:  60%|██████    | 12/20 [10:43<07:11, 53.92s/it]
Task 16, Epoch 13/20 => Loss 2.363, Loss_clf 0.280, Loss_fe 0.298, Loss_kd 1.680, Train_accy 69.76:  60%|██████    | 12/20 [11:25<07:11, 53.92s/it]
Task 16, Epoch 13/20 => Loss 2.363, Loss_clf 0.280, Loss_fe 0.298, Loss_kd 1.680, Train_accy 69.76:  65%|██████▌   | 13/20 [11:25<05:51, 50.29s/it]
Task 16, Epoch 14/20 => Loss 2.284, Loss_clf 0.261, Loss_fe 0.257, Loss_kd 1.661, Train_accy 71.32:  65%|██████▌   | 13/20 [12:07<05:51, 50.29s/it]
Task 16, Epoch 14/20 => Loss 2.284, Loss_clf 0.261, Loss_fe 0.257, Loss_kd 1.661, Train_accy 71.32:  70%|███████   | 14/20 [12:07<04:46, 47.76s/it]
Task 16, Epoch 15/20 => Loss 2.278, Loss_clf 0.259, Loss_fe 0.250, Loss_kd 1.665, Train_accy 71.00:  70%|███████   | 14/20 [12:49<04:46, 47.76s/it]
Task 16, Epoch 15/20 => Loss 2.278, Loss_clf 0.259, Loss_fe 0.250, Loss_kd 1.665, Train_accy 71.00:  75%|███████▌  | 15/20 [12:49<03:49, 45.99s/it]
Task 16, Epoch 16/20 => Loss 2.267, Loss_clf 0.247, Loss_fe 0.234, Loss_kd 1.681, Train_accy 72.22, Test_accy 87.40:  75%|███████▌  | 15/20 [14:18<03:49, 45.99s/it]
Task 16, Epoch 16/20 => Loss 2.267, Loss_clf 0.247, Loss_fe 0.234, Loss_kd 1.681, Train_accy 72.22, Test_accy 87.40:  80%|████████  | 16/20 [14:18<03:55, 58.99s/it]
Task 16, Epoch 17/20 => Loss 2.259, Loss_clf 0.246, Loss_fe 0.236, Loss_kd 1.672, Train_accy 71.39:  80%|████████  | 16/20 [15:00<03:55, 58.99s/it]                 
Task 16, Epoch 17/20 => Loss 2.259, Loss_clf 0.246, Loss_fe 0.236, Loss_kd 1.672, Train_accy 71.39:  85%|████████▌ | 17/20 [15:00<02:41, 53.85s/it]
Task 16, Epoch 18/20 => Loss 2.376, Loss_clf 0.286, Loss_fe 0.263, Loss_kd 1.720, Train_accy 69.78:  85%|████████▌ | 17/20 [15:42<02:41, 53.85s/it]
Task 16, Epoch 18/20 => Loss 2.376, Loss_clf 0.286, Loss_fe 0.263, Loss_kd 1.720, Train_accy 69.78:  90%|█████████ | 18/20 [15:42<01:40, 50.25s/it]
Task 16, Epoch 19/20 => Loss 2.248, Loss_clf 0.251, Loss_fe 0.225, Loss_kd 1.667, Train_accy 69.49:  90%|█████████ | 18/20 [16:24<01:40, 50.25s/it]
Task 16, Epoch 19/20 => Loss 2.248, Loss_clf 0.251, Loss_fe 0.225, Loss_kd 1.667, Train_accy 69.49:  95%|█████████▌| 19/20 [16:24<00:47, 47.74s/it]
Task 16, Epoch 20/20 => Loss 2.275, Loss_clf 0.255, Loss_fe 0.231, Loss_kd 1.684, Train_accy 70.78:  95%|█████████▌| 19/20 [17:06<00:47, 47.74s/it]
Task 16, Epoch 20/20 => Loss 2.275, Loss_clf 0.255, Loss_fe 0.231, Loss_kd 1.684, Train_accy 70.78: 100%|██████████| 20/20 [17:06<00:00, 45.99s/it]
Task 16, Epoch 20/20 => Loss 2.275, Loss_clf 0.255, Loss_fe 0.231, Loss_kd 1.684, Train_accy 70.78: 100%|██████████| 20/20 [17:06<00:00, 51.32s/it]
2024-09-05 08:56:00,463 [foster.py] => Task 16, Epoch 20/20 => Loss 2.275, Loss_clf 0.255, Loss_fe 0.231, Loss_kd 1.684, Train_accy 70.78
2024-09-05 08:56:00,464 [foster.py] => do not weight align teacher!
2024-09-05 08:56:00,468 [foster.py] => per cls weights : [1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 0.47128095 0.47128095 0.47128095 0.47128095
 0.47128095]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 16, Epoch 1/20 => Loss 1.800,  Train_accy 53.49, Test_accy 86.74:   0%|          | 0/20 [01:17<?, ?it/s]
SNet: Task 16, Epoch 1/20 => Loss 1.800,  Train_accy 53.49, Test_accy 86.74:   5%|▌         | 1/20 [01:17<24:25, 77.12s/it]
SNet: Task 16, Epoch 2/20 => Loss 1.678,  Train_accy 57.00:   5%|▌         | 1/20 [02:09<24:25, 77.12s/it]                 
SNet: Task 16, Epoch 2/20 => Loss 1.678,  Train_accy 57.00:  10%|█         | 2/20 [02:09<18:48, 62.71s/it]
SNet: Task 16, Epoch 3/20 => Loss 1.649,  Train_accy 57.98:  10%|█         | 2/20 [03:02<18:48, 62.71s/it]
SNet: Task 16, Epoch 3/20 => Loss 1.649,  Train_accy 57.98:  15%|█▌        | 3/20 [03:02<16:28, 58.14s/it]
SNet: Task 16, Epoch 4/20 => Loss 1.711,  Train_accy 56.46:  15%|█▌        | 3/20 [03:55<16:28, 58.14s/it]
SNet: Task 16, Epoch 4/20 => Loss 1.711,  Train_accy 56.46:  20%|██        | 4/20 [03:55<14:55, 55.98s/it]
SNet: Task 16, Epoch 5/20 => Loss 1.670,  Train_accy 57.27:  20%|██        | 4/20 [04:47<14:55, 55.98s/it]
SNet: Task 16, Epoch 5/20 => Loss 1.670,  Train_accy 57.27:  25%|██▌       | 5/20 [04:47<13:41, 54.77s/it]
SNet: Task 16, Epoch 6/20 => Loss 1.643,  Train_accy 58.34, Test_accy 86.89:  25%|██▌       | 5/20 [06:04<13:41, 54.77s/it]
SNet: Task 16, Epoch 6/20 => Loss 1.643,  Train_accy 58.34, Test_accy 86.89:  30%|███       | 6/20 [06:04<14:33, 62.39s/it]
SNet: Task 16, Epoch 7/20 => Loss 1.656,  Train_accy 57.95:  30%|███       | 6/20 [06:57<14:33, 62.39s/it]                 
SNet: Task 16, Epoch 7/20 => Loss 1.656,  Train_accy 57.95:  35%|███▌      | 7/20 [06:57<12:49, 59.21s/it]
SNet: Task 16, Epoch 8/20 => Loss 1.644,  Train_accy 58.10:  35%|███▌      | 7/20 [07:50<12:49, 59.21s/it]
SNet: Task 16, Epoch 8/20 => Loss 1.644,  Train_accy 58.10:  40%|████      | 8/20 [07:50<11:25, 57.12s/it]
SNet: Task 16, Epoch 9/20 => Loss 1.663,  Train_accy 58.61:  40%|████      | 8/20 [08:42<11:25, 57.12s/it]
SNet: Task 16, Epoch 9/20 => Loss 1.663,  Train_accy 58.61:  45%|████▌     | 9/20 [08:42<10:13, 55.73s/it]
SNet: Task 16, Epoch 10/20 => Loss 1.688,  Train_accy 57.32:  45%|████▌     | 9/20 [09:35<10:13, 55.73s/it]
SNet: Task 16, Epoch 10/20 => Loss 1.688,  Train_accy 57.32:  50%|█████     | 10/20 [09:35<09:08, 54.81s/it]
SNet: Task 16, Epoch 11/20 => Loss 1.651,  Train_accy 58.66, Test_accy 87.04:  50%|█████     | 10/20 [10:52<09:08, 54.81s/it]
SNet: Task 16, Epoch 11/20 => Loss 1.651,  Train_accy 58.66, Test_accy 87.04:  55%|█████▌    | 11/20 [10:52<09:15, 61.67s/it]
SNet: Task 16, Epoch 12/20 => Loss 1.644,  Train_accy 58.90:  55%|█████▌    | 11/20 [11:45<09:15, 61.67s/it]                 
SNet: Task 16, Epoch 12/20 => Loss 1.644,  Train_accy 58.90:  60%|██████    | 12/20 [11:45<07:51, 58.95s/it]
SNet: Task 16, Epoch 13/20 => Loss 1.634,  Train_accy 58.51:  60%|██████    | 12/20 [12:38<07:51, 58.95s/it]
SNet: Task 16, Epoch 13/20 => Loss 1.634,  Train_accy 58.51:  65%|██████▌   | 13/20 [12:38<06:39, 57.05s/it]
SNet: Task 16, Epoch 14/20 => Loss 1.662,  Train_accy 58.17:  65%|██████▌   | 13/20 [13:30<06:39, 57.05s/it]
SNet: Task 16, Epoch 14/20 => Loss 1.662,  Train_accy 58.17:  70%|███████   | 14/20 [13:30<05:34, 55.73s/it]
SNet: Task 16, Epoch 15/20 => Loss 1.634,  Train_accy 59.15:  70%|███████   | 14/20 [14:23<05:34, 55.73s/it]
SNet: Task 16, Epoch 15/20 => Loss 1.634,  Train_accy 59.15:  75%|███████▌  | 15/20 [14:23<04:34, 54.81s/it]
SNet: Task 16, Epoch 16/20 => Loss 1.639,  Train_accy 58.15, Test_accy 87.00:  75%|███████▌  | 15/20 [15:40<04:34, 54.81s/it]
SNet: Task 16, Epoch 16/20 => Loss 1.639,  Train_accy 58.15, Test_accy 87.00:  80%|████████  | 16/20 [15:40<04:06, 61.53s/it]
SNet: Task 16, Epoch 17/20 => Loss 1.691,  Train_accy 56.85:  80%|████████  | 16/20 [16:33<04:06, 61.53s/it]                 
SNet: Task 16, Epoch 17/20 => Loss 1.691,  Train_accy 56.85:  85%|████████▌ | 17/20 [16:33<02:56, 58.88s/it]
SNet: Task 16, Epoch 18/20 => Loss 1.620,  Train_accy 58.76:  85%|████████▌ | 17/20 [17:26<02:56, 58.88s/it]
SNet: Task 16, Epoch 18/20 => Loss 1.620,  Train_accy 58.76:  90%|█████████ | 18/20 [17:26<01:54, 57.01s/it]
SNet: Task 16, Epoch 19/20 => Loss 1.657,  Train_accy 57.56:  90%|█████████ | 18/20 [18:18<01:54, 57.01s/it]
SNet: Task 16, Epoch 19/20 => Loss 1.657,  Train_accy 57.56:  95%|█████████▌| 19/20 [18:18<00:55, 55.72s/it]
SNet: Task 16, Epoch 20/20 => Loss 1.664,  Train_accy 57.63:  95%|█████████▌| 19/20 [19:11<00:55, 55.72s/it]
SNet: Task 16, Epoch 20/20 => Loss 1.664,  Train_accy 57.63: 100%|██████████| 20/20 [19:11<00:00, 54.82s/it]
SNet: Task 16, Epoch 20/20 => Loss 1.664,  Train_accy 57.63: 100%|██████████| 20/20 [19:11<00:00, 57.58s/it]
2024-09-05 09:15:13,618 [foster.py] => SNet: Task 16, Epoch 20/20 => Loss 1.664,  Train_accy 57.63
2024-09-05 09:15:13,618 [foster.py] => do not weight align student!
2024-09-05 09:15:38,133 [foster.py] => darknet eval: 
2024-09-05 09:15:38,133 [foster.py] => CNN top1 curve: 86.98
2024-09-05 09:15:38,134 [foster.py] => CNN top5 curve: 98.98
2024-09-05 09:15:38,136 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 09:17:57,371 [foster.py] => Exemplar size: 1700
2024-09-05 09:17:57,371 [trainer.py] => CNN: {'total': 87.45, '00-04': 91.4, '05-09': 88.6, '10-14': 88.4, '15-19': 90.2, '20-24': 95.8, '25-29': 90.8, '30-34': 92.2, '35-39': 91.8, '40-44': 90.2, '45-49': 89.0, '50-54': 88.0, '55-59': 87.0, '60-64': 84.6, '65-69': 95.2, '70-74': 87.6, '75-79': 78.6, '80-84': 57.2, 'old': 89.34, 'new': 57.2}
2024-09-05 09:17:57,372 [trainer.py] => NME: {'total': 89.22, '00-04': 94.2, '05-09': 88.8, '10-14': 87.8, '15-19': 90.0, '20-24': 96.0, '25-29': 89.6, '30-34': 91.0, '35-39': 90.0, '40-44': 88.6, '45-49': 85.4, '50-54': 85.6, '55-59': 85.8, '60-64': 81.6, '65-69': 95.8, '70-74': 86.8, '75-79': 84.8, '80-84': 95.0, 'old': 88.86, 'new': 95.0}
2024-09-05 09:17:57,372 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2, 90.27, 89.73, 88.29, 87.45]
2024-09-05 09:17:57,372 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17, 99.17, 99.12, 99.05, 99.06]
2024-09-05 09:17:57,372 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97, 91.06, 90.28, 89.14, 89.22]
2024-09-05 09:17:57,372 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14, 99.17, 99.16, 98.96, 99.0]

Average Accuracy (CNN): 92.73
Average Accuracy (NME): 93.41
2024-09-05 09:17:57,372 [trainer.py] => Average Accuracy (CNN): 92.73
2024-09-05 09:17:57,372 [trainer.py] => Average Accuracy (NME): 93.41
2024-09-05 09:17:57,373 [trainer.py] => All params: 171854842
2024-09-05 09:17:57,374 [trainer.py] => Trainable params: 85994666
2024-09-05 09:17:58,905 [foster.py] => Learning on 85-90
2024-09-05 09:17:58,907 [foster.py] => All params: 171870217
2024-09-05 09:17:58,908 [foster.py] => Trainable params: 86006196
2024-09-05 09:17:58,995 [foster.py] => per cls weights : [1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 0.57204451 0.57204451 0.57204451 0.57204451 0.57204451]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 5.386, Loss_clf 0.854, Loss_fe 2.383, Loss_kd 2.030, Train_accy 61.95, Test_accy 87.18:   0%|          | 0/20 [01:32<?, ?it/s]
Task 17, Epoch 1/20 => Loss 5.386, Loss_clf 0.854, Loss_fe 2.383, Loss_kd 2.030, Train_accy 61.95, Test_accy 87.18:   5%|▌         | 1/20 [01:32<29:21, 92.69s/it]
Task 17, Epoch 2/20 => Loss 3.896, Loss_clf 0.580, Loss_fe 1.152, Loss_kd 2.043, Train_accy 64.02:   5%|▌         | 1/20 [02:15<29:21, 92.69s/it]                 
Task 17, Epoch 2/20 => Loss 3.896, Loss_clf 0.580, Loss_fe 1.152, Loss_kd 2.043, Train_accy 64.02:  10%|█         | 2/20 [02:15<19:00, 63.35s/it]
Task 17, Epoch 3/20 => Loss 3.527, Loss_clf 0.513, Loss_fe 0.863, Loss_kd 2.031, Train_accy 66.74:  10%|█         | 2/20 [02:58<19:00, 63.35s/it]
Task 17, Epoch 3/20 => Loss 3.527, Loss_clf 0.513, Loss_fe 0.863, Loss_kd 2.031, Train_accy 66.74:  15%|█▌        | 3/20 [02:58<15:18, 54.02s/it]
Task 17, Epoch 4/20 => Loss 3.291, Loss_clf 0.463, Loss_fe 0.698, Loss_kd 2.011, Train_accy 69.14:  15%|█▌        | 3/20 [03:41<15:18, 54.02s/it]
Task 17, Epoch 4/20 => Loss 3.291, Loss_clf 0.463, Loss_fe 0.698, Loss_kd 2.011, Train_accy 69.14:  20%|██        | 4/20 [03:41<13:14, 49.66s/it]
Task 17, Epoch 5/20 => Loss 3.163, Loss_clf 0.408, Loss_fe 0.625, Loss_kd 2.011, Train_accy 70.57:  20%|██        | 4/20 [04:24<13:14, 49.66s/it]
Task 17, Epoch 5/20 => Loss 3.163, Loss_clf 0.408, Loss_fe 0.625, Loss_kd 2.011, Train_accy 70.57:  25%|██▌       | 5/20 [04:24<11:48, 47.23s/it]
Task 17, Epoch 6/20 => Loss 3.124, Loss_clf 0.415, Loss_fe 0.583, Loss_kd 2.007, Train_accy 70.83, Test_accy 87.63:  25%|██▌       | 5/20 [05:57<11:48, 47.23s/it]
Task 17, Epoch 6/20 => Loss 3.124, Loss_clf 0.415, Loss_fe 0.583, Loss_kd 2.007, Train_accy 70.83, Test_accy 87.63:  30%|███       | 6/20 [05:57<14:39, 62.82s/it]
Task 17, Epoch 7/20 => Loss 3.136, Loss_clf 0.413, Loss_fe 0.563, Loss_kd 2.040, Train_accy 72.12:  30%|███       | 6/20 [06:40<14:39, 62.82s/it]                 
Task 17, Epoch 7/20 => Loss 3.136, Loss_clf 0.413, Loss_fe 0.563, Loss_kd 2.040, Train_accy 72.12:  35%|███▌      | 7/20 [06:40<12:12, 56.34s/it]
Task 17, Epoch 8/20 => Loss 3.082, Loss_clf 0.414, Loss_fe 0.521, Loss_kd 2.028, Train_accy 72.52:  35%|███▌      | 7/20 [07:23<12:12, 56.34s/it]
Task 17, Epoch 8/20 => Loss 3.082, Loss_clf 0.414, Loss_fe 0.521, Loss_kd 2.028, Train_accy 72.52:  40%|████      | 8/20 [07:23<10:25, 52.09s/it]
Task 17, Epoch 9/20 => Loss 2.961, Loss_clf 0.374, Loss_fe 0.458, Loss_kd 2.011, Train_accy 71.98:  40%|████      | 8/20 [08:06<10:25, 52.09s/it]
Task 17, Epoch 9/20 => Loss 2.961, Loss_clf 0.374, Loss_fe 0.458, Loss_kd 2.011, Train_accy 71.98:  45%|████▌     | 9/20 [08:06<09:01, 49.24s/it]
Task 17, Epoch 10/20 => Loss 2.872, Loss_clf 0.337, Loss_fe 0.392, Loss_kd 2.024, Train_accy 76.62:  45%|████▌     | 9/20 [08:49<09:01, 49.24s/it]
Task 17, Epoch 10/20 => Loss 2.872, Loss_clf 0.337, Loss_fe 0.392, Loss_kd 2.024, Train_accy 76.62:  50%|█████     | 10/20 [08:49<07:52, 47.30s/it]
Task 17, Epoch 11/20 => Loss 2.912, Loss_clf 0.369, Loss_fe 0.411, Loss_kd 2.013, Train_accy 73.48, Test_accy 87.73:  50%|█████     | 10/20 [10:22<07:52, 47.30s/it]
Task 17, Epoch 11/20 => Loss 2.912, Loss_clf 0.369, Loss_fe 0.411, Loss_kd 2.013, Train_accy 73.48, Test_accy 87.73:  55%|█████▌    | 11/20 [10:22<09:12, 61.35s/it]
Task 17, Epoch 12/20 => Loss 2.828, Loss_clf 0.340, Loss_fe 0.365, Loss_kd 2.006, Train_accy 75.69:  55%|█████▌    | 11/20 [11:05<09:12, 61.35s/it]                 
Task 17, Epoch 12/20 => Loss 2.828, Loss_clf 0.340, Loss_fe 0.365, Loss_kd 2.006, Train_accy 75.69:  60%|██████    | 12/20 [11:05<07:26, 55.83s/it]
Task 17, Epoch 13/20 => Loss 2.872, Loss_clf 0.356, Loss_fe 0.357, Loss_kd 2.039, Train_accy 76.64:  60%|██████    | 12/20 [11:48<07:26, 55.83s/it]
Task 17, Epoch 13/20 => Loss 2.872, Loss_clf 0.356, Loss_fe 0.357, Loss_kd 2.039, Train_accy 76.64:  65%|██████▌   | 13/20 [11:48<06:03, 51.97s/it]
Task 17, Epoch 14/20 => Loss 2.787, Loss_clf 0.324, Loss_fe 0.327, Loss_kd 2.017, Train_accy 78.48:  65%|██████▌   | 13/20 [12:31<06:03, 51.97s/it]
Task 17, Epoch 14/20 => Loss 2.787, Loss_clf 0.324, Loss_fe 0.327, Loss_kd 2.017, Train_accy 78.48:  70%|███████   | 14/20 [12:31<04:55, 49.29s/it]
Task 17, Epoch 15/20 => Loss 2.872, Loss_clf 0.351, Loss_fe 0.352, Loss_kd 2.048, Train_accy 77.21:  70%|███████   | 14/20 [13:14<04:55, 49.29s/it]
Task 17, Epoch 15/20 => Loss 2.872, Loss_clf 0.351, Loss_fe 0.352, Loss_kd 2.048, Train_accy 77.21:  75%|███████▌  | 15/20 [13:14<03:57, 47.40s/it]
Task 17, Epoch 16/20 => Loss 2.800, Loss_clf 0.327, Loss_fe 0.309, Loss_kd 2.044, Train_accy 77.43, Test_accy 87.70:  75%|███████▌  | 15/20 [14:48<03:57, 47.40s/it]
Task 17, Epoch 16/20 => Loss 2.800, Loss_clf 0.327, Loss_fe 0.309, Loss_kd 2.044, Train_accy 77.43, Test_accy 87.70:  80%|████████  | 16/20 [14:48<04:04, 61.16s/it]
Task 17, Epoch 17/20 => Loss 2.726, Loss_clf 0.295, Loss_fe 0.286, Loss_kd 2.026, Train_accy 79.52:  80%|████████  | 16/20 [15:31<04:04, 61.16s/it]                 
Task 17, Epoch 17/20 => Loss 2.726, Loss_clf 0.295, Loss_fe 0.286, Loss_kd 2.026, Train_accy 79.52:  85%|████████▌ | 17/20 [15:31<02:47, 55.76s/it]
Task 17, Epoch 18/20 => Loss 2.710, Loss_clf 0.300, Loss_fe 0.276, Loss_kd 2.016, Train_accy 77.57:  85%|████████▌ | 17/20 [16:14<02:47, 55.76s/it]
Task 17, Epoch 18/20 => Loss 2.710, Loss_clf 0.300, Loss_fe 0.276, Loss_kd 2.016, Train_accy 77.57:  90%|█████████ | 18/20 [16:14<01:43, 51.94s/it]
Task 17, Epoch 19/20 => Loss 2.724, Loss_clf 0.301, Loss_fe 0.285, Loss_kd 2.019, Train_accy 78.74:  90%|█████████ | 18/20 [16:57<01:43, 51.94s/it]
Task 17, Epoch 19/20 => Loss 2.724, Loss_clf 0.301, Loss_fe 0.285, Loss_kd 2.019, Train_accy 78.74:  95%|█████████▌| 19/20 [16:57<00:49, 49.27s/it]
Task 17, Epoch 20/20 => Loss 2.723, Loss_clf 0.304, Loss_fe 0.273, Loss_kd 2.028, Train_accy 79.19:  95%|█████████▌| 19/20 [17:40<00:49, 49.27s/it]
Task 17, Epoch 20/20 => Loss 2.723, Loss_clf 0.304, Loss_fe 0.273, Loss_kd 2.028, Train_accy 79.19: 100%|██████████| 20/20 [17:40<00:00, 47.38s/it]
Task 17, Epoch 20/20 => Loss 2.723, Loss_clf 0.304, Loss_fe 0.273, Loss_kd 2.028, Train_accy 79.19: 100%|██████████| 20/20 [17:40<00:00, 53.02s/it]
2024-09-05 09:35:39,313 [foster.py] => Task 17, Epoch 20/20 => Loss 2.723, Loss_clf 0.304, Loss_fe 0.273, Loss_kd 2.028, Train_accy 79.19
2024-09-05 09:35:39,314 [foster.py] => do not weight align teacher!
2024-09-05 09:35:39,318 [foster.py] => per cls weights : [1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 0.47041734 0.47041734 0.47041734 0.47041734 0.47041734]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 17, Epoch 1/20 => Loss 2.025,  Train_accy 58.83, Test_accy 87.03:   0%|          | 0/20 [01:19<?, ?it/s]
SNet: Task 17, Epoch 1/20 => Loss 2.025,  Train_accy 58.83, Test_accy 87.03:   5%|▌         | 1/20 [01:19<25:18, 79.91s/it]
SNet: Task 17, Epoch 2/20 => Loss 1.879,  Train_accy 64.43:   5%|▌         | 1/20 [02:13<25:18, 79.91s/it]                 
SNet: Task 17, Epoch 2/20 => Loss 1.879,  Train_accy 64.43:  10%|█         | 2/20 [02:13<19:24, 64.70s/it]
SNet: Task 17, Epoch 3/20 => Loss 1.857,  Train_accy 65.62:  10%|█         | 2/20 [03:07<19:24, 64.70s/it]
SNet: Task 17, Epoch 3/20 => Loss 1.857,  Train_accy 65.62:  15%|█▌        | 3/20 [03:07<16:56, 59.81s/it]
SNet: Task 17, Epoch 4/20 => Loss 1.816,  Train_accy 66.31:  15%|█▌        | 3/20 [04:01<16:56, 59.81s/it]
SNet: Task 17, Epoch 4/20 => Loss 1.816,  Train_accy 66.31:  20%|██        | 4/20 [04:01<15:20, 57.53s/it]
SNet: Task 17, Epoch 5/20 => Loss 1.806,  Train_accy 67.12:  20%|██        | 4/20 [04:55<15:20, 57.53s/it]
SNet: Task 17, Epoch 5/20 => Loss 1.806,  Train_accy 67.12:  25%|██▌       | 5/20 [04:55<14:03, 56.26s/it]
SNet: Task 17, Epoch 6/20 => Loss 1.798,  Train_accy 66.45, Test_accy 87.49:  25%|██▌       | 5/20 [06:16<14:03, 56.26s/it]
SNet: Task 17, Epoch 6/20 => Loss 1.798,  Train_accy 66.45, Test_accy 87.49:  30%|███       | 6/20 [06:16<15:00, 64.34s/it]
SNet: Task 17, Epoch 7/20 => Loss 1.819,  Train_accy 67.43:  30%|███       | 6/20 [07:10<15:00, 64.34s/it]                 
SNet: Task 17, Epoch 7/20 => Loss 1.819,  Train_accy 67.43:  35%|███▌      | 7/20 [07:10<13:12, 60.97s/it]
SNet: Task 17, Epoch 8/20 => Loss 1.825,  Train_accy 66.29:  35%|███▌      | 7/20 [08:04<13:12, 60.97s/it]
SNet: Task 17, Epoch 8/20 => Loss 1.825,  Train_accy 66.29:  40%|████      | 8/20 [08:04<11:45, 58.77s/it]
SNet: Task 17, Epoch 9/20 => Loss 1.799,  Train_accy 67.69:  40%|████      | 8/20 [08:58<11:45, 58.77s/it]
SNet: Task 17, Epoch 9/20 => Loss 1.799,  Train_accy 67.69:  45%|████▌     | 9/20 [08:58<10:30, 57.29s/it]
SNet: Task 17, Epoch 10/20 => Loss 1.833,  Train_accy 65.55:  45%|████▌     | 9/20 [09:52<10:30, 57.29s/it]
SNet: Task 17, Epoch 10/20 => Loss 1.833,  Train_accy 65.55:  50%|█████     | 10/20 [09:52<09:22, 56.28s/it]
SNet: Task 17, Epoch 11/20 => Loss 1.798,  Train_accy 66.88, Test_accy 87.54:  50%|█████     | 10/20 [11:12<09:22, 56.28s/it]
SNet: Task 17, Epoch 11/20 => Loss 1.798,  Train_accy 66.88, Test_accy 87.54:  55%|█████▌    | 11/20 [11:12<09:31, 63.52s/it]
SNet: Task 17, Epoch 12/20 => Loss 1.831,  Train_accy 66.86:  55%|█████▌    | 11/20 [12:06<09:31, 63.52s/it]                 
SNet: Task 17, Epoch 12/20 => Loss 1.831,  Train_accy 66.86:  60%|██████    | 12/20 [12:06<08:05, 60.64s/it]
SNet: Task 17, Epoch 13/20 => Loss 1.832,  Train_accy 66.67:  60%|██████    | 12/20 [13:00<08:05, 60.64s/it]
SNet: Task 17, Epoch 13/20 => Loss 1.832,  Train_accy 66.67:  65%|██████▌   | 13/20 [13:00<06:50, 58.64s/it]
SNet: Task 17, Epoch 14/20 => Loss 1.833,  Train_accy 66.83:  65%|██████▌   | 13/20 [13:54<06:50, 58.64s/it]
SNet: Task 17, Epoch 14/20 => Loss 1.833,  Train_accy 66.83:  70%|███████   | 14/20 [13:54<05:43, 57.25s/it]
SNet: Task 17, Epoch 15/20 => Loss 1.818,  Train_accy 68.38:  70%|███████   | 14/20 [14:48<05:43, 57.25s/it]
SNet: Task 17, Epoch 15/20 => Loss 1.818,  Train_accy 68.38:  75%|███████▌  | 15/20 [14:48<04:41, 56.25s/it]
SNet: Task 17, Epoch 16/20 => Loss 1.800,  Train_accy 67.64, Test_accy 87.54:  75%|███████▌  | 15/20 [16:08<04:41, 56.25s/it]
SNet: Task 17, Epoch 16/20 => Loss 1.800,  Train_accy 67.64, Test_accy 87.54:  80%|████████  | 16/20 [16:08<04:13, 63.40s/it]
SNet: Task 17, Epoch 17/20 => Loss 1.829,  Train_accy 66.95:  80%|████████  | 16/20 [17:02<04:13, 63.40s/it]                 
SNet: Task 17, Epoch 17/20 => Loss 1.829,  Train_accy 66.95:  85%|████████▌ | 17/20 [17:02<03:01, 60.59s/it]
SNet: Task 17, Epoch 18/20 => Loss 1.825,  Train_accy 67.71:  85%|████████▌ | 17/20 [17:56<03:01, 60.59s/it]
SNet: Task 17, Epoch 18/20 => Loss 1.825,  Train_accy 67.71:  90%|█████████ | 18/20 [17:56<01:57, 58.62s/it]
SNet: Task 17, Epoch 19/20 => Loss 1.839,  Train_accy 66.81:  90%|█████████ | 18/20 [18:50<01:57, 58.62s/it]
SNet: Task 17, Epoch 19/20 => Loss 1.839,  Train_accy 66.81:  95%|█████████▌| 19/20 [18:50<00:57, 57.23s/it]
SNet: Task 17, Epoch 20/20 => Loss 1.831,  Train_accy 67.19:  95%|█████████▌| 19/20 [19:44<00:57, 57.23s/it]
SNet: Task 17, Epoch 20/20 => Loss 1.831,  Train_accy 67.19: 100%|██████████| 20/20 [19:44<00:00, 56.26s/it]
SNet: Task 17, Epoch 20/20 => Loss 1.831,  Train_accy 67.19: 100%|██████████| 20/20 [19:44<00:00, 59.21s/it]
2024-09-05 09:55:25,080 [foster.py] => SNet: Task 17, Epoch 20/20 => Loss 1.831,  Train_accy 67.19
2024-09-05 09:55:25,080 [foster.py] => do not weight align student!
2024-09-05 09:55:50,979 [foster.py] => darknet eval: 
2024-09-05 09:55:50,979 [foster.py] => CNN top1 curve: 87.5
2024-09-05 09:55:50,980 [foster.py] => CNN top5 curve: 98.8
2024-09-05 09:55:50,982 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 09:58:20,989 [foster.py] => Exemplar size: 1800
2024-09-05 09:58:20,989 [trainer.py] => CNN: {'total': 87.84, '00-04': 90.6, '05-09': 88.2, '10-14': 89.6, '15-19': 90.2, '20-24': 96.2, '25-29': 91.2, '30-34': 92.4, '35-39': 90.6, '40-44': 89.4, '45-49': 87.2, '50-54': 87.8, '55-59': 85.8, '60-64': 81.8, '65-69': 95.8, '70-74': 88.2, '75-79': 83.2, '80-84': 74.6, '85-89': 78.4, 'old': 88.4, 'new': 78.4}
2024-09-05 09:58:20,989 [trainer.py] => NME: {'total': 89.1, '00-04': 94.8, '05-09': 88.0, '10-14': 86.6, '15-19': 91.4, '20-24': 96.0, '25-29': 90.8, '30-34': 90.2, '35-39': 89.2, '40-44': 88.0, '45-49': 86.0, '50-54': 86.6, '55-59': 84.6, '60-64': 83.2, '65-69': 94.6, '70-74': 87.6, '75-79': 83.0, '80-84': 90.4, '85-89': 92.8, 'old': 88.88, 'new': 92.8}
2024-09-05 09:58:20,989 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2, 90.27, 89.73, 88.29, 87.45, 87.84]
2024-09-05 09:58:20,989 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17, 99.17, 99.12, 99.05, 99.06, 98.92]
2024-09-05 09:58:20,989 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97, 91.06, 90.28, 89.14, 89.22, 89.1]
2024-09-05 09:58:20,990 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14, 99.17, 99.16, 98.96, 99.0, 98.8]

Average Accuracy (CNN): 92.46
Average Accuracy (NME): 93.17
2024-09-05 09:58:20,990 [trainer.py] => Average Accuracy (CNN): 92.46
2024-09-05 09:58:20,990 [trainer.py] => Average Accuracy (NME): 93.17
2024-09-05 09:58:20,991 [trainer.py] => All params: 171870217
2024-09-05 09:58:20,992 [trainer.py] => Trainable params: 86006196
2024-09-05 09:58:22,569 [foster.py] => Learning on 90-95
2024-09-05 09:58:22,570 [foster.py] => All params: 171885592
2024-09-05 09:58:22,571 [foster.py] => Trainable params: 86017726
2024-09-05 09:58:22,679 [foster.py] => per cls weights : [1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 0.57128759 0.57128759 0.57128759 0.57128759 0.57128759]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 5.179, Loss_clf 0.754, Loss_fe 2.357, Loss_kd 1.959, Train_accy 66.79, Test_accy 87.82:   0%|          | 0/20 [01:36<?, ?it/s]
Task 18, Epoch 1/20 => Loss 5.179, Loss_clf 0.754, Loss_fe 2.357, Loss_kd 1.959, Train_accy 66.79, Test_accy 87.82:   5%|▌         | 1/20 [01:36<30:29, 96.27s/it]
Task 18, Epoch 2/20 => Loss 3.595, Loss_clf 0.455, Loss_fe 1.070, Loss_kd 1.961, Train_accy 72.93:   5%|▌         | 1/20 [02:20<30:29, 96.27s/it]                 
Task 18, Epoch 2/20 => Loss 3.595, Loss_clf 0.455, Loss_fe 1.070, Loss_kd 1.961, Train_accy 72.93:  10%|█         | 2/20 [02:20<19:37, 65.44s/it]
Task 18, Epoch 3/20 => Loss 3.201, Loss_clf 0.409, Loss_fe 0.757, Loss_kd 1.927, Train_accy 73.12:  10%|█         | 2/20 [03:04<19:37, 65.44s/it]
Task 18, Epoch 3/20 => Loss 3.201, Loss_clf 0.409, Loss_fe 0.757, Loss_kd 1.927, Train_accy 73.12:  15%|█▌        | 3/20 [03:04<15:45, 55.62s/it]
Task 18, Epoch 4/20 => Loss 2.998, Loss_clf 0.366, Loss_fe 0.602, Loss_kd 1.923, Train_accy 72.98:  15%|█▌        | 3/20 [03:48<15:45, 55.62s/it]
Task 18, Epoch 4/20 => Loss 2.998, Loss_clf 0.366, Loss_fe 0.602, Loss_kd 1.923, Train_accy 72.98:  20%|██        | 4/20 [03:48<13:36, 51.01s/it]
Task 18, Epoch 5/20 => Loss 3.005, Loss_clf 0.381, Loss_fe 0.577, Loss_kd 1.940, Train_accy 74.74:  20%|██        | 4/20 [04:31<13:36, 51.01s/it]
Task 18, Epoch 5/20 => Loss 3.005, Loss_clf 0.381, Loss_fe 0.577, Loss_kd 1.940, Train_accy 74.74:  25%|██▌       | 5/20 [04:31<12:06, 48.47s/it]
Task 18, Epoch 6/20 => Loss 2.963, Loss_clf 0.380, Loss_fe 0.542, Loss_kd 1.933, Train_accy 75.26, Test_accy 87.71:  25%|██▌       | 5/20 [06:08<12:06, 48.47s/it]
Task 18, Epoch 6/20 => Loss 2.963, Loss_clf 0.380, Loss_fe 0.542, Loss_kd 1.933, Train_accy 75.26, Test_accy 87.71:  30%|███       | 6/20 [06:08<15:07, 64.80s/it]
Task 18, Epoch 7/20 => Loss 2.863, Loss_clf 0.360, Loss_fe 0.459, Loss_kd 1.937, Train_accy 75.53:  30%|███       | 6/20 [06:52<15:07, 64.80s/it]                 
Task 18, Epoch 7/20 => Loss 2.863, Loss_clf 0.360, Loss_fe 0.459, Loss_kd 1.937, Train_accy 75.53:  35%|███▌      | 7/20 [06:52<12:33, 57.99s/it]
Task 18, Epoch 8/20 => Loss 2.854, Loss_clf 0.358, Loss_fe 0.452, Loss_kd 1.936, Train_accy 76.53:  35%|███▌      | 7/20 [07:36<12:33, 57.99s/it]
Task 18, Epoch 8/20 => Loss 2.854, Loss_clf 0.358, Loss_fe 0.452, Loss_kd 1.936, Train_accy 76.53:  40%|████      | 8/20 [07:36<10:42, 53.53s/it]
Task 18, Epoch 9/20 => Loss 2.740, Loss_clf 0.309, Loss_fe 0.386, Loss_kd 1.937, Train_accy 78.16:  40%|████      | 8/20 [08:20<10:42, 53.53s/it]
Task 18, Epoch 9/20 => Loss 2.740, Loss_clf 0.309, Loss_fe 0.386, Loss_kd 1.937, Train_accy 78.16:  45%|████▌     | 9/20 [08:20<09:16, 50.55s/it]
Task 18, Epoch 10/20 => Loss 2.726, Loss_clf 0.325, Loss_fe 0.362, Loss_kd 1.932, Train_accy 77.16:  45%|████▌     | 9/20 [09:04<09:16, 50.55s/it]
Task 18, Epoch 10/20 => Loss 2.726, Loss_clf 0.325, Loss_fe 0.362, Loss_kd 1.932, Train_accy 77.16:  50%|█████     | 10/20 [09:04<08:05, 48.52s/it]
Task 18, Epoch 11/20 => Loss 2.689, Loss_clf 0.301, Loss_fe 0.333, Loss_kd 1.947, Train_accy 78.21, Test_accy 88.22:  50%|█████     | 10/20 [10:40<08:05, 48.52s/it]
Task 18, Epoch 11/20 => Loss 2.689, Loss_clf 0.301, Loss_fe 0.333, Loss_kd 1.947, Train_accy 78.21, Test_accy 88.22:  55%|█████▌    | 11/20 [10:41<09:29, 63.24s/it]
Task 18, Epoch 12/20 => Loss 2.671, Loss_clf 0.296, Loss_fe 0.331, Loss_kd 1.937, Train_accy 79.28:  55%|█████▌    | 11/20 [11:24<09:29, 63.24s/it]                 
Task 18, Epoch 12/20 => Loss 2.671, Loss_clf 0.296, Loss_fe 0.331, Loss_kd 1.937, Train_accy 79.28:  60%|██████    | 12/20 [11:24<07:38, 57.37s/it]
Task 18, Epoch 13/20 => Loss 2.632, Loss_clf 0.294, Loss_fe 0.297, Loss_kd 1.934, Train_accy 79.60:  60%|██████    | 12/20 [12:08<07:38, 57.37s/it]
Task 18, Epoch 13/20 => Loss 2.632, Loss_clf 0.294, Loss_fe 0.297, Loss_kd 1.934, Train_accy 79.60:  65%|██████▌   | 13/20 [12:08<06:13, 53.29s/it]
Task 18, Epoch 14/20 => Loss 2.695, Loss_clf 0.305, Loss_fe 0.312, Loss_kd 1.968, Train_accy 79.70:  65%|██████▌   | 13/20 [12:52<06:13, 53.29s/it]
Task 18, Epoch 14/20 => Loss 2.695, Loss_clf 0.305, Loss_fe 0.312, Loss_kd 1.968, Train_accy 79.70:  70%|███████   | 14/20 [12:52<05:02, 50.47s/it]
Task 18, Epoch 15/20 => Loss 2.563, Loss_clf 0.262, Loss_fe 0.261, Loss_kd 1.932, Train_accy 81.12:  70%|███████   | 14/20 [13:36<05:02, 50.47s/it]
Task 18, Epoch 15/20 => Loss 2.563, Loss_clf 0.262, Loss_fe 0.261, Loss_kd 1.932, Train_accy 81.12:  75%|███████▌  | 15/20 [13:36<04:02, 48.50s/it]
Task 18, Epoch 16/20 => Loss 2.618, Loss_clf 0.304, Loss_fe 0.281, Loss_kd 1.925, Train_accy 79.67, Test_accy 88.59:  75%|███████▌  | 15/20 [15:13<04:02, 48.50s/it]
Task 18, Epoch 16/20 => Loss 2.618, Loss_clf 0.304, Loss_fe 0.281, Loss_kd 1.925, Train_accy 79.67, Test_accy 88.59:  80%|████████  | 16/20 [15:13<04:11, 62.95s/it]
Task 18, Epoch 17/20 => Loss 2.537, Loss_clf 0.253, Loss_fe 0.233, Loss_kd 1.942, Train_accy 81.23:  80%|████████  | 16/20 [15:57<04:11, 62.95s/it]                 
Task 18, Epoch 17/20 => Loss 2.537, Loss_clf 0.253, Loss_fe 0.233, Loss_kd 1.942, Train_accy 81.23:  85%|████████▌ | 17/20 [15:57<02:51, 57.22s/it]
Task 18, Epoch 18/20 => Loss 2.577, Loss_clf 0.274, Loss_fe 0.247, Loss_kd 1.947, Train_accy 81.35:  85%|████████▌ | 17/20 [16:41<02:51, 57.22s/it]
Task 18, Epoch 18/20 => Loss 2.577, Loss_clf 0.274, Loss_fe 0.247, Loss_kd 1.947, Train_accy 81.35:  90%|█████████ | 18/20 [16:41<01:46, 53.22s/it]
Task 18, Epoch 19/20 => Loss 2.666, Loss_clf 0.308, Loss_fe 0.285, Loss_kd 1.964, Train_accy 79.44:  90%|█████████ | 18/20 [17:24<01:46, 53.22s/it]
Task 18, Epoch 19/20 => Loss 2.666, Loss_clf 0.308, Loss_fe 0.285, Loss_kd 1.964, Train_accy 79.44:  95%|█████████▌| 19/20 [17:24<00:50, 50.42s/it]
Task 18, Epoch 20/20 => Loss 2.556, Loss_clf 0.270, Loss_fe 0.240, Loss_kd 1.938, Train_accy 81.26:  95%|█████████▌| 19/20 [18:08<00:50, 50.42s/it]
Task 18, Epoch 20/20 => Loss 2.556, Loss_clf 0.270, Loss_fe 0.240, Loss_kd 1.938, Train_accy 81.26: 100%|██████████| 20/20 [18:08<00:00, 48.47s/it]
Task 18, Epoch 20/20 => Loss 2.556, Loss_clf 0.270, Loss_fe 0.240, Loss_kd 1.938, Train_accy 81.26: 100%|██████████| 20/20 [18:08<00:00, 54.44s/it]
2024-09-05 10:16:31,547 [foster.py] => Task 18, Epoch 20/20 => Loss 2.556, Loss_clf 0.270, Loss_fe 0.240, Loss_kd 1.938, Train_accy 81.26
2024-09-05 10:16:31,548 [foster.py] => do not weight align teacher!
2024-09-05 10:16:31,552 [foster.py] => per cls weights : [1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 0.46964732 0.46964732 0.46964732 0.46964732 0.46964732]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 18, Epoch 1/20 => Loss 1.822,  Train_accy 65.35, Test_accy 87.72:   0%|          | 0/20 [01:22<?, ?it/s]
SNet: Task 18, Epoch 1/20 => Loss 1.822,  Train_accy 65.35, Test_accy 87.72:   5%|▌         | 1/20 [01:22<26:07, 82.48s/it]
SNet: Task 18, Epoch 2/20 => Loss 1.695,  Train_accy 70.19:   5%|▌         | 1/20 [02:17<26:07, 82.48s/it]                 
SNet: Task 18, Epoch 2/20 => Loss 1.695,  Train_accy 70.19:  10%|█         | 2/20 [02:17<19:56, 66.45s/it]
SNet: Task 18, Epoch 3/20 => Loss 1.679,  Train_accy 69.88:  10%|█         | 2/20 [03:12<19:56, 66.45s/it]
SNet: Task 18, Epoch 3/20 => Loss 1.679,  Train_accy 69.88:  15%|█▌        | 3/20 [03:12<17:22, 61.35s/it]
SNet: Task 18, Epoch 4/20 => Loss 1.652,  Train_accy 70.42:  15%|█▌        | 3/20 [04:08<17:22, 61.35s/it]
SNet: Task 18, Epoch 4/20 => Loss 1.652,  Train_accy 70.42:  20%|██        | 4/20 [04:08<15:43, 58.94s/it]
SNet: Task 18, Epoch 5/20 => Loss 1.641,  Train_accy 71.33:  20%|██        | 4/20 [05:03<15:43, 58.94s/it]
SNet: Task 18, Epoch 5/20 => Loss 1.641,  Train_accy 71.33:  25%|██▌       | 5/20 [05:03<14:24, 57.61s/it]
SNet: Task 18, Epoch 6/20 => Loss 1.670,  Train_accy 70.23, Test_accy 88.02:  25%|██▌       | 5/20 [06:26<14:24, 57.61s/it]
SNet: Task 18, Epoch 6/20 => Loss 1.670,  Train_accy 70.23, Test_accy 88.02:  30%|███       | 6/20 [06:26<15:25, 66.12s/it]
SNet: Task 18, Epoch 7/20 => Loss 1.699,  Train_accy 70.44:  30%|███       | 6/20 [07:21<15:25, 66.12s/it]                 
SNet: Task 18, Epoch 7/20 => Loss 1.699,  Train_accy 70.44:  35%|███▌      | 7/20 [07:21<13:33, 62.57s/it]
SNet: Task 18, Epoch 8/20 => Loss 1.648,  Train_accy 70.49:  35%|███▌      | 7/20 [08:16<13:33, 62.57s/it]
SNet: Task 18, Epoch 8/20 => Loss 1.648,  Train_accy 70.49:  40%|████      | 8/20 [08:16<12:02, 60.25s/it]
SNet: Task 18, Epoch 9/20 => Loss 1.688,  Train_accy 69.88:  40%|████      | 8/20 [09:11<12:02, 60.25s/it]
SNet: Task 18, Epoch 9/20 => Loss 1.688,  Train_accy 69.88:  45%|████▌     | 9/20 [09:11<10:45, 58.68s/it]
SNet: Task 18, Epoch 10/20 => Loss 1.652,  Train_accy 71.00:  45%|████▌     | 9/20 [10:07<10:45, 58.68s/it]
SNet: Task 18, Epoch 10/20 => Loss 1.652,  Train_accy 71.00:  50%|█████     | 10/20 [10:07<09:36, 57.63s/it]
SNet: Task 18, Epoch 11/20 => Loss 1.652,  Train_accy 71.07, Test_accy 88.03:  50%|█████     | 10/20 [11:29<09:36, 57.63s/it]
SNet: Task 18, Epoch 11/20 => Loss 1.652,  Train_accy 71.07, Test_accy 88.03:  55%|█████▌    | 11/20 [11:29<09:47, 65.29s/it]
SNet: Task 18, Epoch 12/20 => Loss 1.679,  Train_accy 69.67:  55%|█████▌    | 11/20 [12:25<09:47, 65.29s/it]                 
SNet: Task 18, Epoch 12/20 => Loss 1.679,  Train_accy 69.67:  60%|██████    | 12/20 [12:25<08:18, 62.25s/it]
SNet: Task 18, Epoch 13/20 => Loss 1.650,  Train_accy 71.19:  60%|██████    | 12/20 [13:20<08:18, 62.25s/it]
SNet: Task 18, Epoch 13/20 => Loss 1.650,  Train_accy 71.19:  65%|██████▌   | 13/20 [13:20<07:00, 60.14s/it]
SNet: Task 18, Epoch 14/20 => Loss 1.664,  Train_accy 71.09:  65%|██████▌   | 13/20 [14:15<07:00, 60.14s/it]
SNet: Task 18, Epoch 14/20 => Loss 1.664,  Train_accy 71.09:  70%|███████   | 14/20 [14:15<05:52, 58.68s/it]
SNet: Task 18, Epoch 15/20 => Loss 1.670,  Train_accy 71.26:  70%|███████   | 14/20 [15:10<05:52, 58.68s/it]
SNet: Task 18, Epoch 15/20 => Loss 1.670,  Train_accy 71.26:  75%|███████▌  | 15/20 [15:10<04:48, 57.64s/it]
SNet: Task 18, Epoch 16/20 => Loss 1.645,  Train_accy 71.12, Test_accy 88.12:  75%|███████▌  | 15/20 [16:33<04:48, 57.64s/it]
SNet: Task 18, Epoch 16/20 => Loss 1.645,  Train_accy 71.12, Test_accy 88.12:  80%|████████  | 16/20 [16:33<04:20, 65.16s/it]
SNet: Task 18, Epoch 17/20 => Loss 1.654,  Train_accy 71.00:  80%|████████  | 16/20 [17:28<04:20, 65.16s/it]                 
SNet: Task 18, Epoch 17/20 => Loss 1.654,  Train_accy 71.00:  85%|████████▌ | 17/20 [17:28<03:06, 62.19s/it]
SNet: Task 18, Epoch 18/20 => Loss 1.642,  Train_accy 71.28:  85%|████████▌ | 17/20 [18:24<03:06, 62.19s/it]
SNet: Task 18, Epoch 18/20 => Loss 1.642,  Train_accy 71.28:  90%|█████████ | 18/20 [18:24<02:00, 60.11s/it]
SNet: Task 18, Epoch 19/20 => Loss 1.664,  Train_accy 71.12:  90%|█████████ | 18/20 [19:19<02:00, 60.11s/it]
SNet: Task 18, Epoch 19/20 => Loss 1.664,  Train_accy 71.12:  95%|█████████▌| 19/20 [19:19<00:58, 58.65s/it]
SNet: Task 18, Epoch 20/20 => Loss 1.672,  Train_accy 70.93:  95%|█████████▌| 19/20 [20:14<00:58, 58.65s/it]
SNet: Task 18, Epoch 20/20 => Loss 1.672,  Train_accy 70.93: 100%|██████████| 20/20 [20:14<00:00, 57.64s/it]
SNet: Task 18, Epoch 20/20 => Loss 1.672,  Train_accy 70.93: 100%|██████████| 20/20 [20:14<00:00, 60.73s/it]
2024-09-05 10:36:47,747 [foster.py] => SNet: Task 18, Epoch 20/20 => Loss 1.672,  Train_accy 70.93
2024-09-05 10:36:47,747 [foster.py] => do not weight align student!
2024-09-05 10:37:14,979 [foster.py] => darknet eval: 
2024-09-05 10:37:14,979 [foster.py] => CNN top1 curve: 88.14
2024-09-05 10:37:14,979 [foster.py] => CNN top5 curve: 98.81
2024-09-05 10:37:14,981 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 10:39:52,017 [foster.py] => Exemplar size: 1900
2024-09-05 10:39:52,017 [trainer.py] => CNN: {'total': 88.48, '00-04': 90.0, '05-09': 88.4, '10-14': 87.4, '15-19': 92.2, '20-24': 94.8, '25-29': 91.0, '30-34': 91.8, '35-39': 91.6, '40-44': 89.6, '45-49': 84.4, '50-54': 86.8, '55-59': 84.0, '60-64': 86.0, '65-69': 95.0, '70-74': 88.8, '75-79': 85.6, '80-84': 85.0, '85-89': 84.0, '90-94': 84.8, 'old': 88.69, 'new': 84.8}
2024-09-05 10:39:52,017 [trainer.py] => NME: {'total': 89.02, '00-04': 93.0, '05-09': 88.6, '10-14': 85.2, '15-19': 91.2, '20-24': 97.0, '25-29': 90.6, '30-34': 90.6, '35-39': 90.4, '40-44': 88.0, '45-49': 86.0, '50-54': 82.2, '55-59': 85.0, '60-64': 84.0, '65-69': 95.0, '70-74': 87.0, '75-79': 82.8, '80-84': 91.6, '85-89': 86.8, '90-94': 96.4, 'old': 88.61, 'new': 96.4}
2024-09-05 10:39:52,017 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2, 90.27, 89.73, 88.29, 87.45, 87.84, 88.48]
2024-09-05 10:39:52,017 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17, 99.17, 99.12, 99.05, 99.06, 98.92, 98.71]
2024-09-05 10:39:52,017 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97, 91.06, 90.28, 89.14, 89.22, 89.1, 89.02]
2024-09-05 10:39:52,017 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14, 99.17, 99.16, 98.96, 99.0, 98.8, 98.79]

Average Accuracy (CNN): 92.25
Average Accuracy (NME): 92.96
2024-09-05 10:39:52,017 [trainer.py] => Average Accuracy (CNN): 92.25
2024-09-05 10:39:52,017 [trainer.py] => Average Accuracy (NME): 92.96
2024-09-05 10:39:52,018 [trainer.py] => All params: 171885592
2024-09-05 10:39:52,019 [trainer.py] => Trainable params: 86017726
2024-09-05 10:39:53,577 [foster.py] => Learning on 95-100
2024-09-05 10:39:53,579 [foster.py] => All params: 171900967
2024-09-05 10:39:53,580 [foster.py] => Trainable params: 86029256
2024-09-05 10:39:53,685 [foster.py] => per cls weights : [1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 0.57060807
 0.57060807 0.57060807 0.57060807 0.57060807]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 5.508, Loss_clf 0.861, Loss_fe 2.560, Loss_kd 1.982, Train_accy 65.50, Test_accy 86.94:   0%|          | 0/20 [01:39<?, ?it/s]
Task 19, Epoch 1/20 => Loss 5.508, Loss_clf 0.861, Loss_fe 2.560, Loss_kd 1.982, Train_accy 65.50, Test_accy 86.94:   5%|▌         | 1/20 [01:39<31:39, 99.98s/it]
Task 19, Epoch 2/20 => Loss 3.794, Loss_clf 0.518, Loss_fe 1.168, Loss_kd 2.002, Train_accy 68.30:   5%|▌         | 1/20 [02:24<31:39, 99.98s/it]                 
Task 19, Epoch 2/20 => Loss 3.794, Loss_clf 0.518, Loss_fe 1.168, Loss_kd 2.002, Train_accy 68.30:  10%|█         | 2/20 [02:24<20:16, 67.61s/it]
Task 19, Epoch 3/20 => Loss 3.434, Loss_clf 0.490, Loss_fe 0.833, Loss_kd 2.007, Train_accy 70.05:  10%|█         | 2/20 [03:09<20:16, 67.61s/it]
Task 19, Epoch 3/20 => Loss 3.434, Loss_clf 0.490, Loss_fe 0.833, Loss_kd 2.007, Train_accy 70.05:  15%|█▌        | 3/20 [03:09<16:13, 57.24s/it]
Task 19, Epoch 4/20 => Loss 3.286, Loss_clf 0.470, Loss_fe 0.702, Loss_kd 2.009, Train_accy 69.11:  15%|█▌        | 3/20 [03:54<16:13, 57.24s/it]
Task 19, Epoch 4/20 => Loss 3.286, Loss_clf 0.470, Loss_fe 0.702, Loss_kd 2.009, Train_accy 69.11:  20%|██        | 4/20 [03:54<13:57, 52.37s/it]
Task 19, Epoch 5/20 => Loss 3.118, Loss_clf 0.412, Loss_fe 0.603, Loss_kd 1.998, Train_accy 72.93:  20%|██        | 4/20 [04:39<13:57, 52.37s/it]
Task 19, Epoch 5/20 => Loss 3.118, Loss_clf 0.412, Loss_fe 0.603, Loss_kd 1.998, Train_accy 72.93:  25%|██▌       | 5/20 [04:39<12:25, 49.68s/it]
Task 19, Epoch 6/20 => Loss 3.072, Loss_clf 0.411, Loss_fe 0.562, Loss_kd 1.994, Train_accy 72.64, Test_accy 87.39:  25%|██▌       | 5/20 [06:19<12:25, 49.68s/it]
Task 19, Epoch 6/20 => Loss 3.072, Loss_clf 0.411, Loss_fe 0.562, Loss_kd 1.994, Train_accy 72.64, Test_accy 87.39:  30%|███       | 6/20 [06:19<15:36, 66.91s/it]
Task 19, Epoch 7/20 => Loss 3.026, Loss_clf 0.412, Loss_fe 0.513, Loss_kd 1.996, Train_accy 72.66:  30%|███       | 6/20 [07:04<15:36, 66.91s/it]                 
Task 19, Epoch 7/20 => Loss 3.026, Loss_clf 0.412, Loss_fe 0.513, Loss_kd 1.996, Train_accy 72.66:  35%|███▌      | 7/20 [07:04<12:56, 59.74s/it]
Task 19, Epoch 8/20 => Loss 3.005, Loss_clf 0.406, Loss_fe 0.493, Loss_kd 2.001, Train_accy 72.89:  35%|███▌      | 7/20 [07:49<12:56, 59.74s/it]
Task 19, Epoch 8/20 => Loss 3.005, Loss_clf 0.406, Loss_fe 0.493, Loss_kd 2.001, Train_accy 72.89:  40%|████      | 8/20 [07:49<11:00, 55.05s/it]
Task 19, Epoch 9/20 => Loss 2.919, Loss_clf 0.360, Loss_fe 0.445, Loss_kd 2.008, Train_accy 74.73:  40%|████      | 8/20 [08:34<11:00, 55.05s/it]
Task 19, Epoch 9/20 => Loss 2.919, Loss_clf 0.360, Loss_fe 0.445, Loss_kd 2.008, Train_accy 74.73:  45%|████▌     | 9/20 [08:34<09:30, 51.88s/it]
Task 19, Epoch 10/20 => Loss 2.878, Loss_clf 0.359, Loss_fe 0.427, Loss_kd 1.988, Train_accy 74.93:  45%|████▌     | 9/20 [09:19<09:30, 51.88s/it]
Task 19, Epoch 10/20 => Loss 2.878, Loss_clf 0.359, Loss_fe 0.427, Loss_kd 1.988, Train_accy 74.93:  50%|█████     | 10/20 [09:19<08:17, 49.77s/it]
Task 19, Epoch 11/20 => Loss 2.812, Loss_clf 0.333, Loss_fe 0.376, Loss_kd 1.998, Train_accy 76.95, Test_accy 87.74:  50%|█████     | 10/20 [11:00<08:17, 49.77s/it]
Task 19, Epoch 11/20 => Loss 2.812, Loss_clf 0.333, Loss_fe 0.376, Loss_kd 1.998, Train_accy 76.95, Test_accy 87.74:  55%|█████▌    | 11/20 [11:00<09:47, 65.23s/it]
Task 19, Epoch 12/20 => Loss 2.733, Loss_clf 0.313, Loss_fe 0.346, Loss_kd 1.970, Train_accy 77.00:  55%|█████▌    | 11/20 [11:45<09:47, 65.23s/it]                 
Task 19, Epoch 12/20 => Loss 2.733, Loss_clf 0.313, Loss_fe 0.346, Loss_kd 1.970, Train_accy 77.00:  60%|██████    | 12/20 [11:45<07:52, 59.08s/it]
Task 19, Epoch 13/20 => Loss 2.745, Loss_clf 0.324, Loss_fe 0.327, Loss_kd 1.989, Train_accy 76.02:  60%|██████    | 12/20 [12:30<07:52, 59.08s/it]
Task 19, Epoch 13/20 => Loss 2.745, Loss_clf 0.324, Loss_fe 0.327, Loss_kd 1.989, Train_accy 76.02:  65%|██████▌   | 13/20 [12:30<06:23, 54.79s/it]
Task 19, Epoch 14/20 => Loss 2.746, Loss_clf 0.321, Loss_fe 0.322, Loss_kd 1.998, Train_accy 77.23:  65%|██████▌   | 13/20 [13:15<06:23, 54.79s/it]
Task 19, Epoch 14/20 => Loss 2.746, Loss_clf 0.321, Loss_fe 0.322, Loss_kd 1.998, Train_accy 77.23:  70%|███████   | 14/20 [13:15<05:10, 51.82s/it]
Task 19, Epoch 15/20 => Loss 2.738, Loss_clf 0.332, Loss_fe 0.314, Loss_kd 1.988, Train_accy 76.86:  70%|███████   | 14/20 [14:00<05:10, 51.82s/it]
Task 19, Epoch 15/20 => Loss 2.738, Loss_clf 0.332, Loss_fe 0.314, Loss_kd 1.988, Train_accy 76.86:  75%|███████▌  | 15/20 [14:00<04:08, 49.77s/it]
Task 19, Epoch 16/20 => Loss 2.664, Loss_clf 0.299, Loss_fe 0.278, Loss_kd 1.983, Train_accy 77.95, Test_accy 87.63:  75%|███████▌  | 15/20 [15:40<04:08, 49.77s/it]
Task 19, Epoch 16/20 => Loss 2.664, Loss_clf 0.299, Loss_fe 0.278, Loss_kd 1.983, Train_accy 77.95, Test_accy 87.63:  80%|████████  | 16/20 [15:40<04:19, 64.98s/it]
Task 19, Epoch 17/20 => Loss 2.703, Loss_clf 0.316, Loss_fe 0.290, Loss_kd 1.992, Train_accy 78.55:  80%|████████  | 16/20 [16:25<04:19, 64.98s/it]                 
Task 19, Epoch 17/20 => Loss 2.703, Loss_clf 0.316, Loss_fe 0.290, Loss_kd 1.992, Train_accy 78.55:  85%|████████▌ | 17/20 [16:25<02:56, 58.96s/it]
Task 19, Epoch 18/20 => Loss 2.689, Loss_clf 0.309, Loss_fe 0.270, Loss_kd 2.004, Train_accy 77.98:  85%|████████▌ | 17/20 [17:10<02:56, 58.96s/it]
Task 19, Epoch 18/20 => Loss 2.689, Loss_clf 0.309, Loss_fe 0.270, Loss_kd 2.004, Train_accy 77.98:  90%|█████████ | 18/20 [17:10<01:49, 54.75s/it]
Task 19, Epoch 19/20 => Loss 2.655, Loss_clf 0.292, Loss_fe 0.254, Loss_kd 2.004, Train_accy 78.95:  90%|█████████ | 18/20 [17:55<01:49, 54.75s/it]
Task 19, Epoch 19/20 => Loss 2.655, Loss_clf 0.292, Loss_fe 0.254, Loss_kd 2.004, Train_accy 78.95:  95%|█████████▌| 19/20 [17:55<00:51, 51.80s/it]
Task 19, Epoch 20/20 => Loss 2.658, Loss_clf 0.300, Loss_fe 0.272, Loss_kd 1.981, Train_accy 79.09:  95%|█████████▌| 19/20 [18:40<00:51, 51.80s/it]
Task 19, Epoch 20/20 => Loss 2.658, Loss_clf 0.300, Loss_fe 0.272, Loss_kd 1.981, Train_accy 79.09: 100%|██████████| 20/20 [18:40<00:00, 49.74s/it]
Task 19, Epoch 20/20 => Loss 2.658, Loss_clf 0.300, Loss_fe 0.272, Loss_kd 1.981, Train_accy 79.09: 100%|██████████| 20/20 [18:40<00:00, 56.01s/it]
2024-09-05 10:58:33,891 [foster.py] => Task 19, Epoch 20/20 => Loss 2.658, Loss_clf 0.300, Loss_fe 0.272, Loss_kd 1.981, Train_accy 79.09
2024-09-05 10:58:33,892 [foster.py] => do not weight align teacher!
2024-09-05 10:58:33,896 [foster.py] => per cls weights : [1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 0.46895645
 0.46895645 0.46895645 0.46895645 0.46895645]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 19, Epoch 1/20 => Loss 1.987,  Train_accy 61.55, Test_accy 87.34:   0%|          | 0/20 [01:25<?, ?it/s]
SNet: Task 19, Epoch 1/20 => Loss 1.987,  Train_accy 61.55, Test_accy 87.34:   5%|▌         | 1/20 [01:25<26:57, 85.15s/it]
SNet: Task 19, Epoch 2/20 => Loss 1.866,  Train_accy 65.98:   5%|▌         | 1/20 [02:21<26:57, 85.15s/it]                 
SNet: Task 19, Epoch 2/20 => Loss 1.866,  Train_accy 65.98:  10%|█         | 2/20 [02:21<20:29, 68.33s/it]
SNet: Task 19, Epoch 3/20 => Loss 1.887,  Train_accy 66.11:  10%|█         | 2/20 [03:18<20:29, 68.33s/it]
SNet: Task 19, Epoch 3/20 => Loss 1.887,  Train_accy 66.11:  15%|█▌        | 3/20 [03:18<17:50, 62.96s/it]
SNet: Task 19, Epoch 4/20 => Loss 1.862,  Train_accy 66.18:  15%|█▌        | 3/20 [04:14<17:50, 62.96s/it]
SNet: Task 19, Epoch 4/20 => Loss 1.862,  Train_accy 66.18:  20%|██        | 4/20 [04:14<16:06, 60.40s/it]
SNet: Task 19, Epoch 5/20 => Loss 1.841,  Train_accy 66.34:  20%|██        | 4/20 [05:11<16:06, 60.40s/it]
SNet: Task 19, Epoch 5/20 => Loss 1.841,  Train_accy 66.34:  25%|██▌       | 5/20 [05:11<14:44, 58.99s/it]
SNet: Task 19, Epoch 6/20 => Loss 1.897,  Train_accy 66.75, Test_accy 87.67:  25%|██▌       | 5/20 [06:36<14:44, 58.99s/it]
SNet: Task 19, Epoch 6/20 => Loss 1.897,  Train_accy 66.75, Test_accy 87.67:  30%|███       | 6/20 [06:36<15:50, 67.91s/it]
SNet: Task 19, Epoch 7/20 => Loss 1.872,  Train_accy 66.75:  30%|███       | 6/20 [07:32<15:50, 67.91s/it]                 
SNet: Task 19, Epoch 7/20 => Loss 1.872,  Train_accy 66.75:  35%|███▌      | 7/20 [07:32<13:54, 64.18s/it]
SNet: Task 19, Epoch 8/20 => Loss 1.851,  Train_accy 66.77:  35%|███▌      | 7/20 [08:29<13:54, 64.18s/it]
SNet: Task 19, Epoch 8/20 => Loss 1.851,  Train_accy 66.77:  40%|████      | 8/20 [08:29<12:20, 61.75s/it]
SNet: Task 19, Epoch 9/20 => Loss 1.877,  Train_accy 66.93:  40%|████      | 8/20 [09:26<12:20, 61.75s/it]
SNet: Task 19, Epoch 9/20 => Loss 1.877,  Train_accy 66.93:  45%|████▌     | 9/20 [09:26<11:02, 60.20s/it]
SNet: Task 19, Epoch 10/20 => Loss 1.876,  Train_accy 67.25:  45%|████▌     | 9/20 [10:23<11:02, 60.20s/it]
SNet: Task 19, Epoch 10/20 => Loss 1.876,  Train_accy 67.25:  50%|█████     | 10/20 [10:23<09:51, 59.12s/it]
SNet: Task 19, Epoch 11/20 => Loss 1.890,  Train_accy 66.89, Test_accy 87.64:  50%|█████     | 10/20 [11:48<09:51, 59.12s/it]
SNet: Task 19, Epoch 11/20 => Loss 1.890,  Train_accy 66.89, Test_accy 87.64:  55%|█████▌    | 11/20 [11:48<10:04, 67.19s/it]
SNet: Task 19, Epoch 12/20 => Loss 1.855,  Train_accy 66.82:  55%|█████▌    | 11/20 [12:45<10:04, 67.19s/it]                 
SNet: Task 19, Epoch 12/20 => Loss 1.855,  Train_accy 66.82:  60%|██████    | 12/20 [12:45<08:31, 63.98s/it]
SNet: Task 19, Epoch 13/20 => Loss 1.857,  Train_accy 67.32:  60%|██████    | 12/20 [13:41<08:31, 63.98s/it]
SNet: Task 19, Epoch 13/20 => Loss 1.857,  Train_accy 67.32:  65%|██████▌   | 13/20 [13:41<07:12, 61.74s/it]
SNet: Task 19, Epoch 14/20 => Loss 1.845,  Train_accy 67.23:  65%|██████▌   | 13/20 [14:38<07:12, 61.74s/it]
SNet: Task 19, Epoch 14/20 => Loss 1.845,  Train_accy 67.23:  70%|███████   | 14/20 [14:38<06:01, 60.21s/it]
SNet: Task 19, Epoch 15/20 => Loss 1.867,  Train_accy 66.32:  70%|███████   | 14/20 [15:35<06:01, 60.21s/it]
SNet: Task 19, Epoch 15/20 => Loss 1.867,  Train_accy 66.32:  75%|███████▌  | 15/20 [15:35<04:55, 59.14s/it]
SNet: Task 19, Epoch 16/20 => Loss 1.874,  Train_accy 66.39, Test_accy 87.77:  75%|███████▌  | 15/20 [17:00<04:55, 59.14s/it]
SNet: Task 19, Epoch 16/20 => Loss 1.874,  Train_accy 66.39, Test_accy 87.77:  80%|████████  | 16/20 [17:00<04:28, 67.03s/it]
SNet: Task 19, Epoch 17/20 => Loss 1.853,  Train_accy 66.61:  80%|████████  | 16/20 [17:57<04:28, 67.03s/it]                 
SNet: Task 19, Epoch 17/20 => Loss 1.853,  Train_accy 66.61:  85%|████████▌ | 17/20 [17:57<03:11, 63.91s/it]
SNet: Task 19, Epoch 18/20 => Loss 1.865,  Train_accy 67.61:  85%|████████▌ | 17/20 [18:53<03:11, 63.91s/it]
SNet: Task 19, Epoch 18/20 => Loss 1.865,  Train_accy 67.61:  90%|█████████ | 18/20 [18:53<02:03, 61.72s/it]
SNet: Task 19, Epoch 19/20 => Loss 1.838,  Train_accy 66.57:  90%|█████████ | 18/20 [19:50<02:03, 61.72s/it]
SNet: Task 19, Epoch 19/20 => Loss 1.838,  Train_accy 66.57:  95%|█████████▌| 19/20 [19:50<01:00, 60.18s/it]
SNet: Task 19, Epoch 20/20 => Loss 1.860,  Train_accy 67.61:  95%|█████████▌| 19/20 [20:46<01:00, 60.18s/it]
SNet: Task 19, Epoch 20/20 => Loss 1.860,  Train_accy 67.61: 100%|██████████| 20/20 [20:46<00:00, 59.09s/it]
SNet: Task 19, Epoch 20/20 => Loss 1.860,  Train_accy 67.61: 100%|██████████| 20/20 [20:46<00:00, 62.34s/it]
2024-09-05 11:19:22,131 [foster.py] => SNet: Task 19, Epoch 20/20 => Loss 1.860,  Train_accy 67.61
2024-09-05 11:19:22,132 [foster.py] => do not weight align student!
2024-09-05 11:19:50,944 [foster.py] => darknet eval: 
2024-09-05 11:19:50,945 [foster.py] => CNN top1 curve: 87.68
2024-09-05 11:19:50,945 [foster.py] => CNN top5 curve: 98.74
2024-09-05 11:19:50,948 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 11:22:35,145 [foster.py] => Exemplar size: 2000
2024-09-05 11:22:35,145 [trainer.py] => CNN: {'total': 87.75, '00-04': 90.0, '05-09': 86.6, '10-14': 87.0, '15-19': 90.0, '20-24': 95.0, '25-29': 90.6, '30-34': 91.6, '35-39': 91.2, '40-44': 89.0, '45-49': 86.6, '50-54': 83.8, '55-59': 83.2, '60-64': 84.4, '65-69': 95.0, '70-74': 88.2, '75-79': 85.2, '80-84': 87.8, '85-89': 86.4, '90-94': 88.6, '95-99': 74.8, 'old': 88.43, 'new': 74.8}
2024-09-05 11:22:35,145 [trainer.py] => NME: {'total': 88.77, '00-04': 92.8, '05-09': 88.2, '10-14': 86.2, '15-19': 90.8, '20-24': 96.4, '25-29': 90.0, '30-34': 91.0, '35-39': 89.0, '40-44': 88.6, '45-49': 86.8, '50-54': 81.8, '55-59': 84.8, '60-64': 84.2, '65-69': 93.8, '70-74': 87.8, '75-79': 82.4, '80-84': 90.0, '85-89': 86.4, '90-94': 92.6, '95-99': 91.8, 'old': 88.61, 'new': 91.8}
2024-09-05 11:22:35,145 [trainer.py] => CNN top1 curve: [99.6, 98.8, 97.07, 95.45, 94.6, 93.87, 92.57, 92.52, 92.33, 91.62, 91.24, 90.8, 90.2, 90.27, 89.73, 88.29, 87.45, 87.84, 88.48, 87.75]
2024-09-05 11:22:35,145 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.56, 99.6, 99.54, 99.48, 99.38, 99.36, 99.35, 99.13, 99.17, 99.17, 99.12, 99.05, 99.06, 98.92, 98.71, 98.67]
2024-09-05 11:22:35,145 [trainer.py] => NME top1 curve: [99.8, 99.1, 97.07, 95.95, 96.0, 94.5, 93.94, 93.65, 92.71, 91.66, 91.44, 91.55, 90.97, 91.06, 90.28, 89.14, 89.22, 89.1, 89.02, 88.77]
2024-09-05 11:22:35,145 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.7, 99.72, 99.53, 99.63, 99.62, 99.53, 99.52, 99.53, 99.23, 99.14, 99.17, 99.16, 98.96, 99.0, 98.8, 98.79, 98.69]

Average Accuracy (CNN): 92.02
Average Accuracy (NME): 92.75
2024-09-05 11:22:35,145 [trainer.py] => Average Accuracy (CNN): 92.02
2024-09-05 11:22:35,145 [trainer.py] => Average Accuracy (NME): 92.75
Accuracy Matrix (CNN):
[[99.6 99.  98.6 98.4 98.4 98.4 97.8 97.6 97.  96.6 96.  94.4 93.6 93.4
  91.8 90.8 91.4 90.6 90.  90. ]
 [ 0.  98.6 96.2 96.4 95.6 95.  93.6 93.4 91.8 91.2 91.2 89.6 90.2 90.6
  89.8 88.  88.6 88.2 88.4 86.6]
 [ 0.   0.  96.4 95.6 96.  95.8 95.8 93.6 92.6 92.  90.6 90.2 89.4 90.2
  89.8 88.6 88.4 89.6 87.4 87. ]
 [ 0.   0.   0.  91.4 88.8 90.8 93.4 94.2 94.2 94.2 93.4 93.  92.6 91.6
  91.8 90.8 90.2 90.2 92.2 90. ]
 [ 0.   0.   0.   0.  94.2 94.6 95.6 96.  96.  95.8 95.6 95.  95.2 96.
  95.4 95.8 95.8 96.2 94.8 95. ]
 [ 0.   0.   0.   0.   0.  88.6 91.  92.  94.6 94.  93.4 93.  92.8 92.2
  92.  92.  90.8 91.2 91.  90.6]
 [ 0.   0.   0.   0.   0.   0.  80.8 83.4 89.  90.8 92.8 92.  92.6 91.2
  91.6 91.2 92.2 92.4 91.8 91.6]
 [ 0.   0.   0.   0.   0.   0.   0.  90.  90.8 91.6 92.8 91.8 92.2 91.6
  91.8 91.6 91.8 90.6 91.6 91.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  85.  85.4 87.6 87.8 90.8 90.6
  89.8 89.6 90.2 89.4 89.6 89. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  84.6 88.  90.2 92.4 91.8
  92.8 92.6 89.  87.2 84.4 86.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  82.2 83.2 84.6 87.4
  87.6 89.  88.  87.8 86.8 83.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  89.4 88.8 89.4
  89.4 87.6 87.  85.8 84.  83.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  77.4 81.4
  83.6 84.4 84.6 81.8 86.  84.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  86.4
  90.6 93.  95.2 95.8 95.  95. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  78.2 81.4 87.6 88.2 88.8 88.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  66.2 78.6 83.2 85.6 85.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  57.2 74.6 85.  87.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  78.4 84.  86.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  84.8 88.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  74.8]]
2024-09-05 11:22:35,147 [trainer.py] => Forgetting (CNN): 3.473684210526315
Accuracy Matrix (NME):
[[99.8 99.6 99.  98.4 98.8 98.6 98.4 96.8 97.2 96.4 94.8 94.8 96.  93.4
  95.  94.2 94.2 94.8 93.  92.8]
 [ 0.  98.6 96.  94.8 95.4 88.8 90.  90.8 92.4 89.2 89.4 89.2 90.2 89.2
  89.8 90.2 88.8 88.  88.6 88.2]
 [ 0.   0.  96.2 95.4 93.  92.6 92.  92.4 87.  88.6 90.  89.6 89.  89.
  87.8 87.8 87.8 86.6 85.2 86.2]
 [ 0.   0.   0.  95.2 94.4 93.  92.  92.4 90.8 92.4 91.8 91.8 90.8 90.8
  91.4 91.  90.  91.4 91.2 90.8]
 [ 0.   0.   0.   0.  98.4 96.4 96.6 96.6 96.4 97.  96.2 96.2 96.6 96.
  96.2 96.2 96.  96.  97.  96.4]
 [ 0.   0.   0.   0.   0.  97.6 95.  92.4 93.8 92.  91.  91.8 92.2 92.
  91.4 92.  89.6 90.8 90.6 90. ]
 [ 0.   0.   0.   0.   0.   0.  93.6 90.2 89.8 90.4 91.6 91.6 90.8 91.
  91.4 90.2 91.  90.2 90.6 91. ]
 [ 0.   0.   0.   0.   0.   0.   0.  97.6 92.2 88.  89.6 90.2 89.4 89.8
  90.2 89.4 90.  89.2 90.4 89. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  94.8 87.2 85.8 87.8 89.  89.4
  87.8 88.  88.6 88.  88.  88.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  95.4 91.8 92.8 93.8 93.
  92.6 88.2 85.4 86.  86.  86.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.8 87.4 87.  88.2
  87.6 80.6 85.6 86.6 82.2 81.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  95.4 83.  89.4
  86.  85.2 85.8 84.6 85.  84.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  94.8 87.
  78.  84.8 81.6 83.2 84.  84.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  96.6
  93.6 94.6 95.8 94.6 95.  93.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  95.4 84.6 86.8 87.6 87.  87.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  89.2 84.8 83.  82.8 82.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  95.  90.4 91.6 90. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  92.8 86.8 86.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  96.4 92.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  91.8]]
2024-09-05 11:22:35,149 [trainer.py] => Forgetting (NME): 7.0
2024-09-05 11:22:38,118 [trainer.py] => config: ./exps/foster_cifar_B50_Inc5.json
2024-09-05 11:22:38,118 [trainer.py] => prefix: cil
2024-09-05 11:22:38,118 [trainer.py] => dataset: cifar224
2024-09-05 11:22:38,118 [trainer.py] => memory_size: 2000
2024-09-05 11:22:38,118 [trainer.py] => memory_per_class: 20
2024-09-05 11:22:38,118 [trainer.py] => fixed_memory: True
2024-09-05 11:22:38,118 [trainer.py] => shuffle: True
2024-09-05 11:22:38,118 [trainer.py] => init_cls: 50
2024-09-05 11:22:38,118 [trainer.py] => increment: 10
2024-09-05 11:22:38,118 [trainer.py] => model_name: foster
2024-09-05 11:22:38,118 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 11:22:38,118 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-05 11:22:38,118 [trainer.py] => seed: 1993
2024-09-05 11:22:38,119 [trainer.py] => beta1: 0.96
2024-09-05 11:22:38,119 [trainer.py] => beta2: 0.97
2024-09-05 11:22:38,119 [trainer.py] => oofc: ft
2024-09-05 11:22:38,119 [trainer.py] => is_teacher_wa: False
2024-09-05 11:22:38,119 [trainer.py] => is_student_wa: False
2024-09-05 11:22:38,119 [trainer.py] => lambda_okd: 1
2024-09-05 11:22:38,119 [trainer.py] => wa_value: 1
2024-09-05 11:22:38,119 [trainer.py] => init_epochs: 20
2024-09-05 11:22:38,119 [trainer.py] => init_lr: 0.001
2024-09-05 11:22:38,119 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 11:22:38,119 [trainer.py] => boosting_epochs: 20
2024-09-05 11:22:38,119 [trainer.py] => compression_epochs: 20
2024-09-05 11:22:38,119 [trainer.py] => lr: 0.001
2024-09-05 11:22:38,119 [trainer.py] => batch_size: 48
2024-09-05 11:22:38,119 [trainer.py] => weight_decay: 0.0005
2024-09-05 11:22:38,119 [trainer.py] => num_workers: 8
2024-09-05 11:22:38,119 [trainer.py] => T: 2
2024-09-05 11:22:39,219 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-05 11:22:39,584 [trainer.py] => All params: 0
2024-09-05 11:22:39,584 [trainer.py] => Trainable params: 0
2024-09-05 11:22:41,160 [foster.py] => Learning on 0-50
2024-09-05 11:22:41,161 [foster.py] => All params: 85875556
2024-09-05 11:22:41,161 [foster.py] => Trainable params: 85875556

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.447, Train_accy 37.26, Test_accy 89.30:   0%|          | 0/20 [03:20<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.447, Train_accy 37.26, Test_accy 89.30:   5%|▌         | 1/20 [03:20<1:03:30, 200.55s/it]
Task 0, Epoch 2/20 => Loss 0.846, Train_accy 76.19:   5%|▌         | 1/20 [06:26<1:03:30, 200.55s/it]                 
Task 0, Epoch 2/20 => Loss 0.846, Train_accy 76.19:  10%|█         | 2/20 [06:26<57:38, 192.12s/it]  
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 79.80:  10%|█         | 2/20 [09:33<57:38, 192.12s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 79.80:  15%|█▌        | 3/20 [09:33<53:40, 189.43s/it]
Task 0, Epoch 4/20 => Loss 0.625, Train_accy 82.48:  15%|█▌        | 3/20 [12:39<53:40, 189.43s/it]
Task 0, Epoch 4/20 => Loss 0.625, Train_accy 82.48:  20%|██        | 4/20 [12:39<50:10, 188.16s/it]
Task 0, Epoch 5/20 => Loss 0.570, Train_accy 83.64:  20%|██        | 4/20 [15:45<50:10, 188.16s/it]
Task 0, Epoch 5/20 => Loss 0.570, Train_accy 83.64:  25%|██▌       | 5/20 [15:45<46:52, 187.49s/it]
Task 0, Epoch 6/20 => Loss 0.519, Train_accy 85.11, Test_accy 93.44:  25%|██▌       | 5/20 [19:06<46:52, 187.49s/it]
Task 0, Epoch 6/20 => Loss 0.519, Train_accy 85.11, Test_accy 93.44:  30%|███       | 6/20 [19:06<44:47, 191.99s/it]
Task 0, Epoch 7/20 => Loss 0.495, Train_accy 85.58:  30%|███       | 6/20 [22:12<44:47, 191.99s/it]                 
Task 0, Epoch 7/20 => Loss 0.495, Train_accy 85.58:  35%|███▌      | 7/20 [22:12<41:11, 190.14s/it]
Task 0, Epoch 8/20 => Loss 0.451, Train_accy 87.03:  35%|███▌      | 7/20 [25:18<41:11, 190.14s/it]
Task 0, Epoch 8/20 => Loss 0.451, Train_accy 87.03:  40%|████      | 8/20 [25:18<37:47, 188.93s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 87.73:  40%|████      | 8/20 [28:25<37:47, 188.93s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 87.73:  45%|████▌     | 9/20 [28:25<34:29, 188.13s/it]
Task 0, Epoch 10/20 => Loss 0.402, Train_accy 88.54:  45%|████▌     | 9/20 [31:31<34:29, 188.13s/it]
Task 0, Epoch 10/20 => Loss 0.402, Train_accy 88.54:  50%|█████     | 10/20 [31:31<31:15, 187.56s/it]
Task 0, Epoch 11/20 => Loss 0.377, Train_accy 89.20, Test_accy 94.36:  50%|█████     | 10/20 [34:52<31:15, 187.56s/it]
Task 0, Epoch 11/20 => Loss 0.377, Train_accy 89.20, Test_accy 94.36:  55%|█████▌    | 11/20 [34:52<28:44, 191.57s/it]
Task 0, Epoch 12/20 => Loss 0.359, Train_accy 89.74:  55%|█████▌    | 11/20 [37:58<28:44, 191.57s/it]                 
Task 0, Epoch 12/20 => Loss 0.359, Train_accy 89.74:  60%|██████    | 12/20 [37:58<25:19, 189.93s/it]
Task 0, Epoch 13/20 => Loss 0.335, Train_accy 90.50:  60%|██████    | 12/20 [41:04<25:19, 189.93s/it]
Task 0, Epoch 13/20 => Loss 0.335, Train_accy 90.50:  65%|██████▌   | 13/20 [41:04<22:01, 188.81s/it]
Task 0, Epoch 14/20 => Loss 0.335, Train_accy 90.54:  65%|██████▌   | 13/20 [44:10<22:01, 188.81s/it]
Task 0, Epoch 14/20 => Loss 0.335, Train_accy 90.54:  70%|███████   | 14/20 [44:10<18:48, 188.03s/it]
Task 0, Epoch 15/20 => Loss 0.308, Train_accy 91.26:  70%|███████   | 14/20 [47:17<18:48, 188.03s/it]
Task 0, Epoch 15/20 => Loss 0.308, Train_accy 91.26:  75%|███████▌  | 15/20 [47:17<15:37, 187.51s/it]
Task 0, Epoch 16/20 => Loss 0.295, Train_accy 91.69, Test_accy 94.96:  75%|███████▌  | 15/20 [50:37<15:37, 187.51s/it]
Task 0, Epoch 16/20 => Loss 0.295, Train_accy 91.69, Test_accy 94.96:  80%|████████  | 16/20 [50:37<12:45, 191.50s/it]
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.78:  80%|████████  | 16/20 [53:44<12:45, 191.50s/it]                 
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.78:  85%|████████▌ | 17/20 [53:44<09:29, 189.93s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 91.87:  85%|████████▌ | 17/20 [56:50<09:29, 189.93s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 91.87:  90%|█████████ | 18/20 [56:50<06:17, 188.84s/it]
Task 0, Epoch 19/20 => Loss 0.275, Train_accy 92.10:  90%|█████████ | 18/20 [59:56<06:17, 188.84s/it]
Task 0, Epoch 19/20 => Loss 0.275, Train_accy 92.10:  95%|█████████▌| 19/20 [59:56<03:08, 188.06s/it]
Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08:  95%|█████████▌| 19/20 [1:03:02<03:08, 188.06s/it]
Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08: 100%|██████████| 20/20 [1:03:02<00:00, 187.50s/it]
Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08: 100%|██████████| 20/20 [1:03:02<00:00, 189.15s/it]
2024-09-05 12:25:44,642 [foster.py] => Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08
2024-09-05 12:25:44,643 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 12:27:48,585 [foster.py] => Exemplar size: 1000
2024-09-05 12:27:48,585 [trainer.py] => CNN: {'total': 94.9, '00-49': 94.9, 'old': 0, 'new': 94.9}
2024-09-05 12:27:48,585 [trainer.py] => NME: {'total': 94.84, '00-49': 94.84, 'old': 0, 'new': 94.84}
2024-09-05 12:27:48,586 [trainer.py] => CNN top1 curve: [94.9]
2024-09-05 12:27:48,586 [trainer.py] => CNN top5 curve: [99.58]
2024-09-05 12:27:48,586 [trainer.py] => NME top1 curve: [94.84]
2024-09-05 12:27:48,586 [trainer.py] => NME top5 curve: [99.58]

Average Accuracy (CNN): 94.9
Average Accuracy (NME): 94.84
2024-09-05 12:27:48,586 [trainer.py] => Average Accuracy (CNN): 94.9
2024-09-05 12:27:48,586 [trainer.py] => Average Accuracy (NME): 94.84
2024-09-05 12:27:48,587 [trainer.py] => All params: 85875556
2024-09-05 12:27:48,587 [trainer.py] => Trainable params: 85875556
2024-09-05 12:27:50,121 [foster.py] => Learning on 50-60
2024-09-05 12:27:50,122 [foster.py] => All params: 171774122
2024-09-05 12:27:50,123 [foster.py] => Trainable params: 85937016
2024-09-05 12:27:50,218 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.088, Loss_clf 0.811, Loss_fe 1.279, Loss_kd 1.665, Train_accy 66.38, Test_accy 92.15:   0%|          | 0/20 [01:33<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.088, Loss_clf 0.811, Loss_fe 1.279, Loss_kd 1.665, Train_accy 66.38, Test_accy 92.15:   5%|▌         | 1/20 [01:33<29:44, 93.93s/it]
Task 1, Epoch 2/20 => Loss 2.924, Loss_clf 0.385, Loss_fe 0.562, Loss_kd 1.647, Train_accy 73.00:   5%|▌         | 1/20 [02:34<29:44, 93.93s/it]                 
Task 1, Epoch 2/20 => Loss 2.924, Loss_clf 0.385, Loss_fe 0.562, Loss_kd 1.647, Train_accy 73.00:  10%|█         | 2/20 [02:34<22:22, 74.56s/it]
Task 1, Epoch 3/20 => Loss 2.822, Loss_clf 0.355, Loss_fe 0.478, Loss_kd 1.657, Train_accy 73.22:  10%|█         | 2/20 [03:35<22:22, 74.56s/it]
Task 1, Epoch 3/20 => Loss 2.822, Loss_clf 0.355, Loss_fe 0.478, Loss_kd 1.657, Train_accy 73.22:  15%|█▌        | 3/20 [03:35<19:22, 68.36s/it]
Task 1, Epoch 4/20 => Loss 2.739, Loss_clf 0.338, Loss_fe 0.422, Loss_kd 1.649, Train_accy 74.02:  15%|█▌        | 3/20 [04:36<19:22, 68.36s/it]
Task 1, Epoch 4/20 => Loss 2.739, Loss_clf 0.338, Loss_fe 0.422, Loss_kd 1.649, Train_accy 74.02:  20%|██        | 4/20 [04:36<17:27, 65.45s/it]
Task 1, Epoch 5/20 => Loss 2.639, Loss_clf 0.297, Loss_fe 0.365, Loss_kd 1.648, Train_accy 76.32:  20%|██        | 4/20 [05:37<17:27, 65.45s/it]
Task 1, Epoch 5/20 => Loss 2.639, Loss_clf 0.297, Loss_fe 0.365, Loss_kd 1.648, Train_accy 76.32:  25%|██▌       | 5/20 [05:37<15:58, 63.88s/it]
Task 1, Epoch 6/20 => Loss 2.586, Loss_clf 0.276, Loss_fe 0.344, Loss_kd 1.639, Train_accy 76.22, Test_accy 92.10:  25%|██▌       | 5/20 [07:12<15:58, 63.88s/it]
Task 1, Epoch 6/20 => Loss 2.586, Loss_clf 0.276, Loss_fe 0.344, Loss_kd 1.639, Train_accy 76.22, Test_accy 92.10:  30%|███       | 6/20 [07:12<17:19, 74.25s/it]
Task 1, Epoch 7/20 => Loss 2.547, Loss_clf 0.265, Loss_fe 0.326, Loss_kd 1.630, Train_accy 77.20:  30%|███       | 6/20 [08:13<17:19, 74.25s/it]                 
Task 1, Epoch 7/20 => Loss 2.547, Loss_clf 0.265, Loss_fe 0.326, Loss_kd 1.630, Train_accy 77.20:  35%|███▌      | 7/20 [08:13<15:09, 69.97s/it]
Task 1, Epoch 8/20 => Loss 2.513, Loss_clf 0.260, Loss_fe 0.301, Loss_kd 1.626, Train_accy 77.53:  35%|███▌      | 7/20 [09:14<15:09, 69.97s/it]
Task 1, Epoch 8/20 => Loss 2.513, Loss_clf 0.260, Loss_fe 0.301, Loss_kd 1.626, Train_accy 77.53:  40%|████      | 8/20 [09:14<13:25, 67.12s/it]
Task 1, Epoch 9/20 => Loss 2.494, Loss_clf 0.250, Loss_fe 0.285, Loss_kd 1.632, Train_accy 77.88:  40%|████      | 8/20 [10:15<13:25, 67.12s/it]
Task 1, Epoch 9/20 => Loss 2.494, Loss_clf 0.250, Loss_fe 0.285, Loss_kd 1.632, Train_accy 77.88:  45%|████▌     | 9/20 [10:15<11:57, 65.23s/it]
Task 1, Epoch 10/20 => Loss 2.465, Loss_clf 0.234, Loss_fe 0.260, Loss_kd 1.642, Train_accy 78.83:  45%|████▌     | 9/20 [11:16<11:57, 65.23s/it]
Task 1, Epoch 10/20 => Loss 2.465, Loss_clf 0.234, Loss_fe 0.260, Loss_kd 1.642, Train_accy 78.83:  50%|█████     | 10/20 [11:16<10:39, 63.93s/it]
Task 1, Epoch 11/20 => Loss 2.419, Loss_clf 0.216, Loss_fe 0.245, Loss_kd 1.631, Train_accy 79.93, Test_accy 92.67:  50%|█████     | 10/20 [12:50<10:39, 63.93s/it]
Task 1, Epoch 11/20 => Loss 2.419, Loss_clf 0.216, Loss_fe 0.245, Loss_kd 1.631, Train_accy 79.93, Test_accy 92.67:  55%|█████▌    | 11/20 [12:50<10:59, 73.23s/it]
Task 1, Epoch 12/20 => Loss 2.404, Loss_clf 0.221, Loss_fe 0.237, Loss_kd 1.622, Train_accy 80.02:  55%|█████▌    | 11/20 [13:52<10:59, 73.23s/it]                 
Task 1, Epoch 12/20 => Loss 2.404, Loss_clf 0.221, Loss_fe 0.237, Loss_kd 1.622, Train_accy 80.02:  60%|██████    | 12/20 [13:52<09:16, 69.53s/it]
Task 1, Epoch 13/20 => Loss 2.391, Loss_clf 0.212, Loss_fe 0.218, Loss_kd 1.634, Train_accy 80.25:  60%|██████    | 12/20 [14:53<09:16, 69.53s/it]
Task 1, Epoch 13/20 => Loss 2.391, Loss_clf 0.212, Loss_fe 0.218, Loss_kd 1.634, Train_accy 80.25:  65%|██████▌   | 13/20 [14:53<07:48, 66.96s/it]
Task 1, Epoch 14/20 => Loss 2.385, Loss_clf 0.205, Loss_fe 0.211, Loss_kd 1.641, Train_accy 81.73:  65%|██████▌   | 13/20 [15:54<07:48, 66.96s/it]
Task 1, Epoch 14/20 => Loss 2.385, Loss_clf 0.205, Loss_fe 0.211, Loss_kd 1.641, Train_accy 81.73:  70%|███████   | 14/20 [15:54<06:31, 65.17s/it]
Task 1, Epoch 15/20 => Loss 2.358, Loss_clf 0.202, Loss_fe 0.207, Loss_kd 1.625, Train_accy 80.13:  70%|███████   | 14/20 [16:55<06:31, 65.17s/it]
Task 1, Epoch 15/20 => Loss 2.358, Loss_clf 0.202, Loss_fe 0.207, Loss_kd 1.625, Train_accy 80.13:  75%|███████▌  | 15/20 [16:55<05:19, 63.92s/it]
Task 1, Epoch 16/20 => Loss 2.354, Loss_clf 0.199, Loss_fe 0.205, Loss_kd 1.625, Train_accy 81.67, Test_accy 93.10:  75%|███████▌  | 15/20 [18:29<05:19, 63.92s/it]
Task 1, Epoch 16/20 => Loss 2.354, Loss_clf 0.199, Loss_fe 0.205, Loss_kd 1.625, Train_accy 81.67, Test_accy 93.10:  80%|████████  | 16/20 [18:29<04:52, 73.10s/it]
Task 1, Epoch 17/20 => Loss 2.362, Loss_clf 0.200, Loss_fe 0.199, Loss_kd 1.635, Train_accy 82.18:  80%|████████  | 16/20 [19:30<04:52, 73.10s/it]                 
Task 1, Epoch 17/20 => Loss 2.362, Loss_clf 0.200, Loss_fe 0.199, Loss_kd 1.635, Train_accy 82.18:  85%|████████▌ | 17/20 [19:30<03:28, 69.48s/it]
Task 1, Epoch 18/20 => Loss 2.312, Loss_clf 0.175, Loss_fe 0.173, Loss_kd 1.636, Train_accy 82.92:  85%|████████▌ | 17/20 [20:31<03:28, 69.48s/it]
Task 1, Epoch 18/20 => Loss 2.312, Loss_clf 0.175, Loss_fe 0.173, Loss_kd 1.636, Train_accy 82.92:  90%|█████████ | 18/20 [20:31<02:13, 66.96s/it]
Task 1, Epoch 19/20 => Loss 2.342, Loss_clf 0.194, Loss_fe 0.191, Loss_kd 1.630, Train_accy 83.20:  90%|█████████ | 18/20 [21:32<02:13, 66.96s/it]
Task 1, Epoch 19/20 => Loss 2.342, Loss_clf 0.194, Loss_fe 0.191, Loss_kd 1.630, Train_accy 83.20:  95%|█████████▌| 19/20 [21:32<01:05, 65.20s/it]
Task 1, Epoch 20/20 => Loss 2.360, Loss_clf 0.199, Loss_fe 0.197, Loss_kd 1.636, Train_accy 82.70:  95%|█████████▌| 19/20 [22:33<01:05, 65.20s/it]
Task 1, Epoch 20/20 => Loss 2.360, Loss_clf 0.199, Loss_fe 0.197, Loss_kd 1.636, Train_accy 82.70: 100%|██████████| 20/20 [22:33<00:00, 63.95s/it]
Task 1, Epoch 20/20 => Loss 2.360, Loss_clf 0.199, Loss_fe 0.197, Loss_kd 1.636, Train_accy 82.70: 100%|██████████| 20/20 [22:33<00:00, 67.69s/it]
2024-09-05 12:50:24,035 [foster.py] => Task 1, Epoch 20/20 => Loss 2.360, Loss_clf 0.199, Loss_fe 0.197, Loss_kd 1.636, Train_accy 82.70
2024-09-05 12:50:24,036 [foster.py] => do not weight align teacher!
2024-09-05 12:50:24,039 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.779,  Train_accy 60.77, Test_accy 91.62:   0%|          | 0/20 [01:34<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.779,  Train_accy 60.77, Test_accy 91.62:   5%|▌         | 1/20 [01:34<29:48, 94.14s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.510,  Train_accy 69.42:   5%|▌         | 1/20 [02:50<29:48, 94.14s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.510,  Train_accy 69.42:  10%|█         | 2/20 [02:50<25:10, 83.93s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.482,  Train_accy 70.58:  10%|█         | 2/20 [04:07<25:10, 83.93s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.482,  Train_accy 70.58:  15%|█▌        | 3/20 [04:07<22:51, 80.68s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.495,  Train_accy 69.68:  15%|█▌        | 3/20 [05:24<22:51, 80.68s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.495,  Train_accy 69.68:  20%|██        | 4/20 [05:24<21:09, 79.32s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.472,  Train_accy 70.32:  20%|██        | 4/20 [06:41<21:09, 79.32s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.472,  Train_accy 70.32:  25%|██▌       | 5/20 [06:41<19:37, 78.49s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.448,  Train_accy 71.22, Test_accy 92.07:  25%|██▌       | 5/20 [08:16<19:37, 78.49s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.448,  Train_accy 71.22, Test_accy 92.07:  30%|███       | 6/20 [08:16<19:34, 83.89s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.481,  Train_accy 69.85:  30%|███       | 6/20 [09:33<19:34, 83.89s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.481,  Train_accy 69.85:  35%|███▌      | 7/20 [09:33<17:40, 81.61s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.481,  Train_accy 70.80:  35%|███▌      | 7/20 [10:50<17:40, 81.61s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.481,  Train_accy 70.80:  40%|████      | 8/20 [10:50<16:01, 80.15s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.490,  Train_accy 70.58:  40%|████      | 8/20 [12:07<16:01, 80.15s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.490,  Train_accy 70.58:  45%|████▌     | 9/20 [12:07<14:30, 79.17s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.479,  Train_accy 70.22:  45%|████▌     | 9/20 [13:24<14:30, 79.17s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.479,  Train_accy 70.22:  50%|█████     | 10/20 [13:24<13:05, 78.51s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.449,  Train_accy 71.52, Test_accy 92.25:  50%|█████     | 10/20 [14:58<13:05, 78.51s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.449,  Train_accy 71.52, Test_accy 92.25:  55%|█████▌    | 11/20 [14:58<12:30, 83.34s/it]
SNet: Task 1, Epoch 12/20 => Loss 1.443,  Train_accy 71.35:  55%|█████▌    | 11/20 [16:15<12:30, 83.34s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 1.443,  Train_accy 71.35:  60%|██████    | 12/20 [16:15<10:51, 81.38s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.474,  Train_accy 71.17:  60%|██████    | 12/20 [17:32<10:51, 81.38s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.474,  Train_accy 71.17:  65%|██████▌   | 13/20 [17:32<09:20, 80.02s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.474,  Train_accy 70.77:  65%|██████▌   | 13/20 [18:49<09:20, 80.02s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.474,  Train_accy 70.77:  70%|███████   | 14/20 [18:49<07:54, 79.05s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.469,  Train_accy 71.07:  70%|███████   | 14/20 [20:06<07:54, 79.05s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.469,  Train_accy 71.07:  75%|███████▌  | 15/20 [20:06<06:31, 78.38s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.478,  Train_accy 70.75, Test_accy 92.17:  75%|███████▌  | 15/20 [21:40<06:31, 78.38s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.478,  Train_accy 70.75, Test_accy 92.17:  80%|████████  | 16/20 [21:40<05:32, 83.12s/it]
SNet: Task 1, Epoch 17/20 => Loss 1.476,  Train_accy 70.82:  80%|████████  | 16/20 [22:56<05:32, 83.12s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 1.476,  Train_accy 70.82:  85%|████████▌ | 17/20 [22:56<04:03, 81.21s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.459,  Train_accy 71.43:  85%|████████▌ | 17/20 [24:13<04:03, 81.21s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.459,  Train_accy 71.43:  90%|█████████ | 18/20 [24:13<02:39, 79.91s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.464,  Train_accy 71.40:  90%|█████████ | 18/20 [25:30<02:39, 79.91s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.464,  Train_accy 71.40:  95%|█████████▌| 19/20 [25:30<01:18, 78.99s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.461,  Train_accy 71.35:  95%|█████████▌| 19/20 [26:47<01:18, 78.99s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.461,  Train_accy 71.35: 100%|██████████| 20/20 [26:47<00:00, 78.35s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.461,  Train_accy 71.35: 100%|██████████| 20/20 [26:47<00:00, 80.38s/it]
2024-09-05 13:17:13,136 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.461,  Train_accy 71.35
2024-09-05 13:17:13,136 [foster.py] => do not weight align student!
2024-09-05 13:17:30,459 [foster.py] => darknet eval: 
2024-09-05 13:17:30,460 [foster.py] => CNN top1 curve: 92.23
2024-09-05 13:17:30,460 [foster.py] => CNN top5 curve: 99.5
2024-09-05 13:17:30,462 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 13:19:26,714 [foster.py] => Exemplar size: 1200
2024-09-05 13:19:26,714 [trainer.py] => CNN: {'total': 93.05, '00-49': 94.78, '50-59': 84.4, 'old': 94.78, 'new': 84.4}
2024-09-05 13:19:26,714 [trainer.py] => NME: {'total': 93.55, '00-49': 93.34, '50-59': 94.6, 'old': 93.34, 'new': 94.6}
2024-09-05 13:19:26,714 [trainer.py] => CNN top1 curve: [94.9, 93.05]
2024-09-05 13:19:26,714 [trainer.py] => CNN top5 curve: [99.58, 99.43]
2024-09-05 13:19:26,714 [trainer.py] => NME top1 curve: [94.84, 93.55]
2024-09-05 13:19:26,714 [trainer.py] => NME top5 curve: [99.58, 99.55]

Average Accuracy (CNN): 93.98
Average Accuracy (NME): 94.2
2024-09-05 13:19:26,714 [trainer.py] => Average Accuracy (CNN): 93.98
2024-09-05 13:19:26,714 [trainer.py] => Average Accuracy (NME): 94.2
2024-09-05 13:19:26,715 [trainer.py] => All params: 171774122
2024-09-05 13:19:26,716 [trainer.py] => Trainable params: 85937016
2024-09-05 13:19:28,232 [foster.py] => Learning on 60-70
2024-09-05 13:19:28,234 [foster.py] => All params: 171804872
2024-09-05 13:19:28,235 [foster.py] => Trainable params: 85960076
2024-09-05 13:19:28,331 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.994, Loss_clf 0.723, Loss_fe 1.335, Loss_kd 1.660, Train_accy 67.73, Test_accy 89.49:   0%|          | 0/20 [01:41<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.994, Loss_clf 0.723, Loss_fe 1.335, Loss_kd 1.660, Train_accy 67.73, Test_accy 89.49:   5%|▌         | 1/20 [01:41<32:14, 101.81s/it]
Task 2, Epoch 2/20 => Loss 2.835, Loss_clf 0.345, Loss_fe 0.567, Loss_kd 1.648, Train_accy 72.47:   5%|▌         | 1/20 [02:44<32:14, 101.81s/it]                 
Task 2, Epoch 2/20 => Loss 2.835, Loss_clf 0.345, Loss_fe 0.567, Loss_kd 1.648, Train_accy 72.47:  10%|█         | 2/20 [02:44<23:42, 79.04s/it] 
Task 2, Epoch 3/20 => Loss 2.691, Loss_clf 0.322, Loss_fe 0.442, Loss_kd 1.652, Train_accy 71.98:  10%|█         | 2/20 [03:48<23:42, 79.04s/it]
Task 2, Epoch 3/20 => Loss 2.691, Loss_clf 0.322, Loss_fe 0.442, Loss_kd 1.652, Train_accy 71.98:  15%|█▌        | 3/20 [03:48<20:19, 71.76s/it]
Task 2, Epoch 4/20 => Loss 2.592, Loss_clf 0.300, Loss_fe 0.382, Loss_kd 1.637, Train_accy 73.63:  15%|█▌        | 3/20 [04:51<20:19, 71.76s/it]
Task 2, Epoch 4/20 => Loss 2.592, Loss_clf 0.300, Loss_fe 0.382, Loss_kd 1.637, Train_accy 73.63:  20%|██        | 4/20 [04:51<18:14, 68.39s/it]
Task 2, Epoch 5/20 => Loss 2.545, Loss_clf 0.277, Loss_fe 0.344, Loss_kd 1.649, Train_accy 74.47:  20%|██        | 4/20 [05:54<18:14, 68.39s/it]
Task 2, Epoch 5/20 => Loss 2.545, Loss_clf 0.277, Loss_fe 0.344, Loss_kd 1.649, Train_accy 74.47:  25%|██▌       | 5/20 [05:54<16:37, 66.48s/it]
Task 2, Epoch 6/20 => Loss 2.498, Loss_clf 0.260, Loss_fe 0.321, Loss_kd 1.643, Train_accy 74.85, Test_accy 90.14:  25%|██▌       | 5/20 [07:36<16:37, 66.48s/it]
Task 2, Epoch 6/20 => Loss 2.498, Loss_clf 0.260, Loss_fe 0.321, Loss_kd 1.643, Train_accy 74.85, Test_accy 90.14:  30%|███       | 6/20 [07:36<18:19, 78.57s/it]
Task 2, Epoch 7/20 => Loss 2.459, Loss_clf 0.246, Loss_fe 0.287, Loss_kd 1.651, Train_accy 75.73:  30%|███       | 6/20 [08:39<18:19, 78.57s/it]                 
Task 2, Epoch 7/20 => Loss 2.459, Loss_clf 0.246, Loss_fe 0.287, Loss_kd 1.651, Train_accy 75.73:  35%|███▌      | 7/20 [08:39<15:55, 73.53s/it]
Task 2, Epoch 8/20 => Loss 2.442, Loss_clf 0.237, Loss_fe 0.281, Loss_kd 1.650, Train_accy 77.39:  35%|███▌      | 7/20 [09:42<15:55, 73.53s/it]
Task 2, Epoch 8/20 => Loss 2.442, Loss_clf 0.237, Loss_fe 0.281, Loss_kd 1.650, Train_accy 77.39:  40%|████      | 8/20 [09:42<14:02, 70.21s/it]
Task 2, Epoch 9/20 => Loss 2.416, Loss_clf 0.219, Loss_fe 0.264, Loss_kd 1.657, Train_accy 78.50:  40%|████      | 8/20 [10:45<14:02, 70.21s/it]
Task 2, Epoch 9/20 => Loss 2.416, Loss_clf 0.219, Loss_fe 0.264, Loss_kd 1.657, Train_accy 78.50:  45%|████▌     | 9/20 [10:45<12:27, 67.98s/it]
Task 2, Epoch 10/20 => Loss 2.398, Loss_clf 0.229, Loss_fe 0.260, Loss_kd 1.637, Train_accy 78.23:  45%|████▌     | 9/20 [11:48<12:27, 67.98s/it]
Task 2, Epoch 10/20 => Loss 2.398, Loss_clf 0.229, Loss_fe 0.260, Loss_kd 1.637, Train_accy 78.23:  50%|█████     | 10/20 [11:48<11:04, 66.48s/it]
Task 2, Epoch 11/20 => Loss 2.340, Loss_clf 0.209, Loss_fe 0.232, Loss_kd 1.627, Train_accy 79.37, Test_accy 91.31:  50%|█████     | 10/20 [13:30<11:04, 66.48s/it]
Task 2, Epoch 11/20 => Loss 2.340, Loss_clf 0.209, Loss_fe 0.232, Loss_kd 1.627, Train_accy 79.37, Test_accy 91.31:  55%|█████▌    | 11/20 [13:30<11:35, 77.33s/it]
Task 2, Epoch 12/20 => Loss 2.369, Loss_clf 0.221, Loss_fe 0.230, Loss_kd 1.645, Train_accy 78.82:  55%|█████▌    | 11/20 [14:33<11:35, 77.33s/it]                 
Task 2, Epoch 12/20 => Loss 2.369, Loss_clf 0.221, Loss_fe 0.230, Loss_kd 1.645, Train_accy 78.82:  60%|██████    | 12/20 [14:33<09:44, 73.01s/it]
Task 2, Epoch 13/20 => Loss 2.341, Loss_clf 0.209, Loss_fe 0.215, Loss_kd 1.644, Train_accy 79.45:  60%|██████    | 12/20 [15:37<09:44, 73.01s/it]
Task 2, Epoch 13/20 => Loss 2.341, Loss_clf 0.209, Loss_fe 0.215, Loss_kd 1.644, Train_accy 79.45:  65%|██████▌   | 13/20 [15:37<08:10, 70.01s/it]
Task 2, Epoch 14/20 => Loss 2.350, Loss_clf 0.206, Loss_fe 0.215, Loss_kd 1.654, Train_accy 79.61:  65%|██████▌   | 13/20 [16:40<08:10, 70.01s/it]
Task 2, Epoch 14/20 => Loss 2.350, Loss_clf 0.206, Loss_fe 0.215, Loss_kd 1.654, Train_accy 79.61:  70%|███████   | 14/20 [16:40<06:47, 67.93s/it]
Task 2, Epoch 15/20 => Loss 2.302, Loss_clf 0.184, Loss_fe 0.195, Loss_kd 1.649, Train_accy 80.71:  70%|███████   | 14/20 [17:43<06:47, 67.93s/it]
Task 2, Epoch 15/20 => Loss 2.302, Loss_clf 0.184, Loss_fe 0.195, Loss_kd 1.649, Train_accy 80.71:  75%|███████▌  | 15/20 [17:43<05:32, 66.50s/it]
Task 2, Epoch 16/20 => Loss 2.317, Loss_clf 0.188, Loss_fe 0.199, Loss_kd 1.654, Train_accy 80.44, Test_accy 91.61:  75%|███████▌  | 15/20 [19:25<05:32, 66.50s/it]
Task 2, Epoch 16/20 => Loss 2.317, Loss_clf 0.188, Loss_fe 0.199, Loss_kd 1.654, Train_accy 80.44, Test_accy 91.61:  80%|████████  | 16/20 [19:25<05:08, 77.18s/it]
Task 2, Epoch 17/20 => Loss 2.296, Loss_clf 0.196, Loss_fe 0.185, Loss_kd 1.641, Train_accy 81.47:  80%|████████  | 16/20 [20:28<05:08, 77.18s/it]                 
Task 2, Epoch 17/20 => Loss 2.296, Loss_clf 0.196, Loss_fe 0.185, Loss_kd 1.641, Train_accy 81.47:  85%|████████▌ | 17/20 [20:28<03:38, 72.94s/it]
Task 2, Epoch 18/20 => Loss 2.275, Loss_clf 0.184, Loss_fe 0.176, Loss_kd 1.641, Train_accy 81.34:  85%|████████▌ | 17/20 [21:31<03:38, 72.94s/it]
Task 2, Epoch 18/20 => Loss 2.275, Loss_clf 0.184, Loss_fe 0.176, Loss_kd 1.641, Train_accy 81.34:  90%|█████████ | 18/20 [21:31<02:19, 69.99s/it]
Task 2, Epoch 19/20 => Loss 2.310, Loss_clf 0.195, Loss_fe 0.186, Loss_kd 1.654, Train_accy 81.73:  90%|█████████ | 18/20 [22:34<02:19, 69.99s/it]
Task 2, Epoch 19/20 => Loss 2.310, Loss_clf 0.195, Loss_fe 0.186, Loss_kd 1.654, Train_accy 81.73:  95%|█████████▌| 19/20 [22:34<01:07, 67.93s/it]
Task 2, Epoch 20/20 => Loss 2.287, Loss_clf 0.186, Loss_fe 0.184, Loss_kd 1.643, Train_accy 81.87:  95%|█████████▌| 19/20 [23:37<01:07, 67.93s/it]
Task 2, Epoch 20/20 => Loss 2.287, Loss_clf 0.186, Loss_fe 0.184, Loss_kd 1.643, Train_accy 81.87: 100%|██████████| 20/20 [23:37<00:00, 66.51s/it]
Task 2, Epoch 20/20 => Loss 2.287, Loss_clf 0.186, Loss_fe 0.184, Loss_kd 1.643, Train_accy 81.87: 100%|██████████| 20/20 [23:37<00:00, 70.89s/it]
2024-09-05 13:43:06,145 [foster.py] => Task 2, Epoch 20/20 => Loss 2.287, Loss_clf 0.186, Loss_fe 0.184, Loss_kd 1.643, Train_accy 81.87
2024-09-05 13:43:06,145 [foster.py] => do not weight align teacher!
2024-09-05 13:43:06,147 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.791,  Train_accy 60.16, Test_accy 90.59:   0%|          | 0/20 [01:39<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.791,  Train_accy 60.16, Test_accy 90.59:   5%|▌         | 1/20 [01:39<31:30, 99.51s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.543,  Train_accy 67.73:   5%|▌         | 1/20 [02:58<31:30, 99.51s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.543,  Train_accy 67.73:  10%|█         | 2/20 [02:58<26:18, 87.70s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.510,  Train_accy 69.31:  10%|█         | 2/20 [04:18<26:18, 87.70s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.510,  Train_accy 69.31:  15%|█▌        | 3/20 [04:18<23:46, 83.94s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.523,  Train_accy 68.84:  15%|█▌        | 3/20 [05:37<23:46, 83.94s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.523,  Train_accy 68.84:  20%|██        | 4/20 [05:37<21:54, 82.16s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.523,  Train_accy 69.34:  20%|██        | 4/20 [06:57<21:54, 82.16s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.523,  Train_accy 69.34:  25%|██▌       | 5/20 [06:57<20:17, 81.19s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.512,  Train_accy 70.27, Test_accy 90.14:  25%|██▌       | 5/20 [08:37<20:17, 81.19s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.512,  Train_accy 70.27, Test_accy 90.14:  30%|███       | 6/20 [08:37<20:24, 87.48s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.511,  Train_accy 69.58:  30%|███       | 6/20 [09:56<20:24, 87.48s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.511,  Train_accy 69.58:  35%|███▌      | 7/20 [09:56<18:23, 84.87s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.507,  Train_accy 70.32:  35%|███▌      | 7/20 [11:15<18:23, 84.87s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.507,  Train_accy 70.32:  40%|████      | 8/20 [11:15<16:37, 83.15s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.480,  Train_accy 69.95:  40%|████      | 8/20 [12:35<16:37, 83.15s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.480,  Train_accy 69.95:  45%|████▌     | 9/20 [12:35<15:01, 82.00s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.519,  Train_accy 69.45:  45%|████▌     | 9/20 [13:54<15:01, 82.00s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.519,  Train_accy 69.45:  50%|█████     | 10/20 [13:54<13:32, 81.23s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.516,  Train_accy 70.40, Test_accy 90.34:  50%|█████     | 10/20 [15:34<13:32, 81.23s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.516,  Train_accy 70.40, Test_accy 90.34:  55%|█████▌    | 11/20 [15:34<13:02, 86.89s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.500,  Train_accy 69.85:  55%|█████▌    | 11/20 [16:54<13:02, 86.89s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.500,  Train_accy 69.85:  60%|██████    | 12/20 [16:54<11:17, 84.64s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.536,  Train_accy 69.89:  60%|██████    | 12/20 [18:13<11:17, 84.64s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.536,  Train_accy 69.89:  65%|██████▌   | 13/20 [18:13<09:41, 83.06s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.524,  Train_accy 69.47:  65%|██████▌   | 13/20 [19:32<09:41, 83.06s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.524,  Train_accy 69.47:  70%|███████   | 14/20 [19:32<08:11, 81.95s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.517,  Train_accy 69.90:  70%|███████   | 14/20 [20:52<08:11, 81.95s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.517,  Train_accy 69.90:  75%|███████▌  | 15/20 [20:52<06:45, 81.18s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.489,  Train_accy 70.00, Test_accy 90.30:  75%|███████▌  | 15/20 [22:31<06:45, 81.18s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.489,  Train_accy 70.00, Test_accy 90.30:  80%|████████  | 16/20 [22:31<05:46, 86.71s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.497,  Train_accy 70.10:  80%|████████  | 16/20 [23:51<05:46, 86.71s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.497,  Train_accy 70.10:  85%|████████▌ | 17/20 [23:51<04:13, 84.50s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.491,  Train_accy 70.47:  85%|████████▌ | 17/20 [25:10<04:13, 84.50s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.491,  Train_accy 70.47:  90%|█████████ | 18/20 [25:10<02:45, 82.99s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.514,  Train_accy 69.58:  90%|█████████ | 18/20 [26:30<02:45, 82.99s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.514,  Train_accy 69.58:  95%|█████████▌| 19/20 [26:30<01:21, 81.92s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.510,  Train_accy 70.02:  95%|█████████▌| 19/20 [27:49<01:21, 81.92s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.510,  Train_accy 70.02: 100%|██████████| 20/20 [27:49<00:00, 81.16s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.510,  Train_accy 70.02: 100%|██████████| 20/20 [27:49<00:00, 83.48s/it]
2024-09-05 14:10:57,273 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.510,  Train_accy 70.02
2024-09-05 14:10:57,273 [foster.py] => do not weight align student!
2024-09-05 14:11:17,495 [foster.py] => darknet eval: 
2024-09-05 14:11:17,495 [foster.py] => CNN top1 curve: 90.39
2024-09-05 14:11:17,495 [foster.py] => CNN top5 curve: 99.44
2024-09-05 14:11:17,498 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 14:13:29,242 [foster.py] => Exemplar size: 1400
2024-09-05 14:13:29,242 [trainer.py] => CNN: {'total': 91.7, '00-49': 94.58, '50-59': 87.2, '60-69': 81.8, 'old': 93.35, 'new': 81.8}
2024-09-05 14:13:29,242 [trainer.py] => NME: {'total': 92.67, '00-49': 93.26, '50-59': 86.8, '60-69': 95.6, 'old': 92.18, 'new': 95.6}
2024-09-05 14:13:29,242 [trainer.py] => CNN top1 curve: [94.9, 93.05, 91.7]
2024-09-05 14:13:29,242 [trainer.py] => CNN top5 curve: [99.58, 99.43, 99.47]
2024-09-05 14:13:29,242 [trainer.py] => NME top1 curve: [94.84, 93.55, 92.67]
2024-09-05 14:13:29,242 [trainer.py] => NME top5 curve: [99.58, 99.55, 99.43]

Average Accuracy (CNN): 93.22
Average Accuracy (NME): 93.69
2024-09-05 14:13:29,242 [trainer.py] => Average Accuracy (CNN): 93.22
2024-09-05 14:13:29,242 [trainer.py] => Average Accuracy (NME): 93.69
2024-09-05 14:13:29,243 [trainer.py] => All params: 171804872
2024-09-05 14:13:29,244 [trainer.py] => Trainable params: 85960076
2024-09-05 14:13:30,790 [foster.py] => Learning on 70-80
2024-09-05 14:13:30,791 [foster.py] => All params: 171835622
2024-09-05 14:13:30,792 [foster.py] => Trainable params: 85983136
2024-09-05 14:13:30,905 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.451, Loss_clf 0.895, Loss_fe 1.560, Loss_kd 1.746, Train_accy 56.12, Test_accy 85.85:   0%|          | 0/20 [01:49<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.451, Loss_clf 0.895, Loss_fe 1.560, Loss_kd 1.746, Train_accy 56.12, Test_accy 85.85:   5%|▌         | 1/20 [01:49<34:35, 109.26s/it]
Task 3, Epoch 2/20 => Loss 3.120, Loss_clf 0.472, Loss_fe 0.682, Loss_kd 1.720, Train_accy 58.78:   5%|▌         | 1/20 [02:54<34:35, 109.26s/it]                 
Task 3, Epoch 2/20 => Loss 3.120, Loss_clf 0.472, Loss_fe 0.682, Loss_kd 1.720, Train_accy 58.78:  10%|█         | 2/20 [02:54<24:59, 83.28s/it] 
Task 3, Epoch 3/20 => Loss 2.924, Loss_clf 0.423, Loss_fe 0.530, Loss_kd 1.725, Train_accy 61.11:  10%|█         | 2/20 [03:59<24:59, 83.28s/it]
Task 3, Epoch 3/20 => Loss 2.924, Loss_clf 0.423, Loss_fe 0.530, Loss_kd 1.725, Train_accy 61.11:  15%|█▌        | 3/20 [03:59<21:15, 75.03s/it]
Task 3, Epoch 4/20 => Loss 2.842, Loss_clf 0.396, Loss_fe 0.471, Loss_kd 1.729, Train_accy 60.95:  15%|█▌        | 3/20 [05:04<21:15, 75.03s/it]
Task 3, Epoch 4/20 => Loss 2.842, Loss_clf 0.396, Loss_fe 0.471, Loss_kd 1.729, Train_accy 60.95:  20%|██        | 4/20 [05:04<18:57, 71.12s/it]
Task 3, Epoch 5/20 => Loss 2.861, Loss_clf 0.401, Loss_fe 0.475, Loss_kd 1.737, Train_accy 60.61:  20%|██        | 4/20 [06:09<18:57, 71.12s/it]
Task 3, Epoch 5/20 => Loss 2.861, Loss_clf 0.401, Loss_fe 0.475, Loss_kd 1.737, Train_accy 60.61:  25%|██▌       | 5/20 [06:09<17:14, 68.96s/it]
Task 3, Epoch 6/20 => Loss 2.715, Loss_clf 0.340, Loss_fe 0.399, Loss_kd 1.729, Train_accy 60.67, Test_accy 87.92:  25%|██▌       | 5/20 [07:59<17:14, 68.96s/it]
Task 3, Epoch 6/20 => Loss 2.715, Loss_clf 0.340, Loss_fe 0.399, Loss_kd 1.729, Train_accy 60.67, Test_accy 87.92:  30%|███       | 6/20 [07:59<19:18, 82.74s/it]
Task 3, Epoch 7/20 => Loss 2.649, Loss_clf 0.325, Loss_fe 0.367, Loss_kd 1.712, Train_accy 63.47:  30%|███       | 6/20 [09:04<19:18, 82.74s/it]                 
Task 3, Epoch 7/20 => Loss 2.649, Loss_clf 0.325, Loss_fe 0.367, Loss_kd 1.712, Train_accy 63.47:  35%|███▌      | 7/20 [09:04<16:40, 76.99s/it]
Task 3, Epoch 8/20 => Loss 2.611, Loss_clf 0.303, Loss_fe 0.340, Loss_kd 1.722, Train_accy 65.64:  35%|███▌      | 7/20 [10:09<16:40, 76.99s/it]
Task 3, Epoch 8/20 => Loss 2.611, Loss_clf 0.303, Loss_fe 0.340, Loss_kd 1.722, Train_accy 65.64:  40%|████      | 8/20 [10:09<14:38, 73.23s/it]
Task 3, Epoch 9/20 => Loss 2.573, Loss_clf 0.288, Loss_fe 0.312, Loss_kd 1.727, Train_accy 67.70:  40%|████      | 8/20 [11:14<14:38, 73.23s/it]
Task 3, Epoch 9/20 => Loss 2.573, Loss_clf 0.288, Loss_fe 0.312, Loss_kd 1.727, Train_accy 67.70:  45%|████▌     | 9/20 [11:14<12:57, 70.71s/it]
Task 3, Epoch 10/20 => Loss 2.559, Loss_clf 0.285, Loss_fe 0.308, Loss_kd 1.720, Train_accy 66.73:  45%|████▌     | 9/20 [12:20<12:57, 70.71s/it]
Task 3, Epoch 10/20 => Loss 2.559, Loss_clf 0.285, Loss_fe 0.308, Loss_kd 1.720, Train_accy 66.73:  50%|█████     | 10/20 [12:20<11:30, 69.02s/it]
Task 3, Epoch 11/20 => Loss 2.510, Loss_clf 0.258, Loss_fe 0.273, Loss_kd 1.732, Train_accy 69.36, Test_accy 88.49:  50%|█████     | 10/20 [14:09<11:30, 69.02s/it]
Task 3, Epoch 11/20 => Loss 2.510, Loss_clf 0.258, Loss_fe 0.273, Loss_kd 1.732, Train_accy 69.36, Test_accy 88.49:  55%|█████▌    | 11/20 [14:09<12:12, 81.43s/it]
Task 3, Epoch 12/20 => Loss 2.501, Loss_clf 0.263, Loss_fe 0.277, Loss_kd 1.716, Train_accy 68.81:  55%|█████▌    | 11/20 [15:14<12:12, 81.43s/it]                 
Task 3, Epoch 12/20 => Loss 2.501, Loss_clf 0.263, Loss_fe 0.277, Loss_kd 1.716, Train_accy 68.81:  60%|██████    | 12/20 [15:14<10:12, 76.50s/it]
Task 3, Epoch 13/20 => Loss 2.468, Loss_clf 0.243, Loss_fe 0.254, Loss_kd 1.725, Train_accy 72.22:  60%|██████    | 12/20 [16:20<10:12, 76.50s/it]
Task 3, Epoch 13/20 => Loss 2.468, Loss_clf 0.243, Loss_fe 0.254, Loss_kd 1.725, Train_accy 72.22:  65%|██████▌   | 13/20 [16:20<08:31, 73.07s/it]
Task 3, Epoch 14/20 => Loss 2.459, Loss_clf 0.236, Loss_fe 0.242, Loss_kd 1.733, Train_accy 70.95:  65%|██████▌   | 13/20 [17:25<08:31, 73.07s/it]
Task 3, Epoch 14/20 => Loss 2.459, Loss_clf 0.236, Loss_fe 0.242, Loss_kd 1.733, Train_accy 70.95:  70%|███████   | 14/20 [17:25<07:04, 70.69s/it]
Task 3, Epoch 15/20 => Loss 2.455, Loss_clf 0.246, Loss_fe 0.246, Loss_kd 1.718, Train_accy 70.98:  70%|███████   | 14/20 [18:30<07:04, 70.69s/it]
Task 3, Epoch 15/20 => Loss 2.455, Loss_clf 0.246, Loss_fe 0.246, Loss_kd 1.718, Train_accy 70.98:  75%|███████▌  | 15/20 [18:30<05:45, 69.03s/it]
Task 3, Epoch 16/20 => Loss 2.451, Loss_clf 0.243, Loss_fe 0.237, Loss_kd 1.724, Train_accy 72.58, Test_accy 88.55:  75%|███████▌  | 15/20 [20:20<05:45, 69.03s/it]
Task 3, Epoch 16/20 => Loss 2.451, Loss_clf 0.243, Loss_fe 0.237, Loss_kd 1.724, Train_accy 72.58, Test_accy 88.55:  80%|████████  | 16/20 [20:20<05:24, 81.25s/it]
Task 3, Epoch 17/20 => Loss 2.418, Loss_clf 0.224, Loss_fe 0.220, Loss_kd 1.727, Train_accy 73.16:  80%|████████  | 16/20 [21:25<05:24, 81.25s/it]                 
Task 3, Epoch 17/20 => Loss 2.418, Loss_clf 0.224, Loss_fe 0.220, Loss_kd 1.727, Train_accy 73.16:  85%|████████▌ | 17/20 [21:25<03:49, 76.40s/it]
Task 3, Epoch 18/20 => Loss 2.393, Loss_clf 0.220, Loss_fe 0.209, Loss_kd 1.719, Train_accy 73.17:  85%|████████▌ | 17/20 [22:30<03:49, 76.40s/it]
Task 3, Epoch 18/20 => Loss 2.393, Loss_clf 0.220, Loss_fe 0.209, Loss_kd 1.719, Train_accy 73.17:  90%|█████████ | 18/20 [22:30<02:26, 73.03s/it]
Task 3, Epoch 19/20 => Loss 2.439, Loss_clf 0.237, Loss_fe 0.231, Loss_kd 1.725, Train_accy 72.75:  90%|█████████ | 18/20 [23:35<02:26, 73.03s/it]
Task 3, Epoch 19/20 => Loss 2.439, Loss_clf 0.237, Loss_fe 0.231, Loss_kd 1.725, Train_accy 72.75:  95%|█████████▌| 19/20 [23:35<01:10, 70.67s/it]
Task 3, Epoch 20/20 => Loss 2.401, Loss_clf 0.221, Loss_fe 0.213, Loss_kd 1.721, Train_accy 74.22:  95%|█████████▌| 19/20 [24:40<01:10, 70.67s/it]
Task 3, Epoch 20/20 => Loss 2.401, Loss_clf 0.221, Loss_fe 0.213, Loss_kd 1.721, Train_accy 74.22: 100%|██████████| 20/20 [24:40<00:00, 69.02s/it]
Task 3, Epoch 20/20 => Loss 2.401, Loss_clf 0.221, Loss_fe 0.213, Loss_kd 1.721, Train_accy 74.22: 100%|██████████| 20/20 [24:40<00:00, 74.03s/it]
2024-09-05 14:38:11,577 [foster.py] => Task 3, Epoch 20/20 => Loss 2.401, Loss_clf 0.221, Loss_fe 0.213, Loss_kd 1.721, Train_accy 74.22
2024-09-05 14:38:11,578 [foster.py] => do not weight align teacher!
2024-09-05 14:38:11,579 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 2.022,  Train_accy 48.17, Test_accy 87.26:   0%|          | 0/20 [01:44<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 2.022,  Train_accy 48.17, Test_accy 87.26:   5%|▌         | 1/20 [01:44<33:12, 104.86s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.857,  Train_accy 54.83:   5%|▌         | 1/20 [03:06<33:12, 104.86s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.857,  Train_accy 54.83:  10%|█         | 2/20 [03:06<27:25, 91.41s/it] 
SNet: Task 3, Epoch 3/20 => Loss 1.818,  Train_accy 55.47:  10%|█         | 2/20 [04:28<27:25, 91.41s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.818,  Train_accy 55.47:  15%|█▌        | 3/20 [04:28<24:41, 87.12s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.825,  Train_accy 56.86:  15%|█▌        | 3/20 [05:50<24:41, 87.12s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.825,  Train_accy 56.86:  20%|██        | 4/20 [05:50<22:41, 85.09s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.822,  Train_accy 57.02:  20%|██        | 4/20 [07:12<22:41, 85.09s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.822,  Train_accy 57.02:  25%|██▌       | 5/20 [07:12<20:59, 83.99s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.803,  Train_accy 57.25, Test_accy 87.45:  25%|██▌       | 5/20 [08:57<20:59, 83.99s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.803,  Train_accy 57.25, Test_accy 87.45:  30%|███       | 6/20 [08:57<21:16, 91.15s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.800,  Train_accy 57.02:  30%|███       | 6/20 [10:19<21:16, 91.15s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.800,  Train_accy 57.02:  35%|███▌      | 7/20 [10:19<19:06, 88.17s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.821,  Train_accy 56.88:  35%|███▌      | 7/20 [11:41<19:06, 88.17s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.821,  Train_accy 56.88:  40%|████      | 8/20 [11:41<17:14, 86.21s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.822,  Train_accy 56.98:  40%|████      | 8/20 [13:04<17:14, 86.21s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.822,  Train_accy 56.98:  45%|████▌     | 9/20 [13:04<15:33, 84.90s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.823,  Train_accy 57.48:  45%|████▌     | 9/20 [14:26<15:33, 84.90s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.823,  Train_accy 57.48:  50%|█████     | 10/20 [14:26<14:01, 84.17s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.824,  Train_accy 57.45, Test_accy 87.21:  50%|█████     | 10/20 [16:11<14:01, 84.17s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.824,  Train_accy 57.45, Test_accy 87.21:  55%|█████▌    | 11/20 [16:11<13:35, 90.64s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.810,  Train_accy 58.06:  55%|█████▌    | 11/20 [17:34<13:35, 90.64s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.810,  Train_accy 58.06:  60%|██████    | 12/20 [17:34<11:44, 88.07s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.831,  Train_accy 57.25:  60%|██████    | 12/20 [18:56<11:44, 88.07s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.831,  Train_accy 57.25:  65%|██████▌   | 13/20 [18:56<10:03, 86.28s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.801,  Train_accy 57.91:  65%|██████▌   | 13/20 [20:18<10:03, 86.28s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.801,  Train_accy 57.91:  70%|███████   | 14/20 [20:18<08:30, 85.02s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.805,  Train_accy 57.62:  70%|███████   | 14/20 [21:40<08:30, 85.02s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.805,  Train_accy 57.62:  75%|███████▌  | 15/20 [21:40<07:00, 84.15s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.815,  Train_accy 57.30, Test_accy 87.39:  75%|███████▌  | 15/20 [23:25<07:00, 84.15s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.815,  Train_accy 57.30, Test_accy 87.39:  80%|████████  | 16/20 [23:25<06:02, 90.50s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.794,  Train_accy 57.67:  80%|████████  | 16/20 [24:47<06:02, 90.50s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.794,  Train_accy 57.67:  85%|████████▌ | 17/20 [24:47<04:23, 87.99s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.806,  Train_accy 57.66:  85%|████████▌ | 17/20 [26:09<04:23, 87.99s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.806,  Train_accy 57.66:  90%|█████████ | 18/20 [26:09<02:52, 86.20s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.830,  Train_accy 57.62:  90%|█████████ | 18/20 [27:31<02:52, 86.20s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.830,  Train_accy 57.62:  95%|█████████▌| 19/20 [27:31<01:24, 84.96s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.815,  Train_accy 56.84:  95%|█████████▌| 19/20 [28:53<01:24, 84.96s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.815,  Train_accy 56.84: 100%|██████████| 20/20 [28:53<00:00, 84.07s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.815,  Train_accy 56.84: 100%|██████████| 20/20 [28:53<00:00, 86.70s/it]
2024-09-05 15:07:07,341 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.815,  Train_accy 56.84
2024-09-05 15:07:07,342 [foster.py] => do not weight align student!
2024-09-05 15:07:30,559 [foster.py] => darknet eval: 
2024-09-05 15:07:30,560 [foster.py] => CNN top1 curve: 87.29
2024-09-05 15:07:30,560 [foster.py] => CNN top5 curve: 99.35
2024-09-05 15:07:30,562 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 15:09:59,014 [foster.py] => Exemplar size: 1600
2024-09-05 15:09:59,014 [trainer.py] => CNN: {'total': 88.7, '00-49': 94.12, '50-59': 87.1, '60-69': 84.0, '70-79': 67.9, 'old': 91.67, 'new': 67.9}
2024-09-05 15:09:59,014 [trainer.py] => NME: {'total': 90.49, '00-49': 92.2, '50-59': 81.6, '60-69': 89.0, '70-79': 92.3, 'old': 90.23, 'new': 92.3}
2024-09-05 15:09:59,014 [trainer.py] => CNN top1 curve: [94.9, 93.05, 91.7, 88.7]
2024-09-05 15:09:59,014 [trainer.py] => CNN top5 curve: [99.58, 99.43, 99.47, 99.31]
2024-09-05 15:09:59,014 [trainer.py] => NME top1 curve: [94.84, 93.55, 92.67, 90.49]
2024-09-05 15:09:59,014 [trainer.py] => NME top5 curve: [99.58, 99.55, 99.43, 99.29]

Average Accuracy (CNN): 92.09
Average Accuracy (NME): 92.89
2024-09-05 15:09:59,015 [trainer.py] => Average Accuracy (CNN): 92.09
2024-09-05 15:09:59,015 [trainer.py] => Average Accuracy (NME): 92.89
2024-09-05 15:09:59,016 [trainer.py] => All params: 171835622
2024-09-05 15:09:59,017 [trainer.py] => Trainable params: 85983136
2024-09-05 15:10:00,556 [foster.py] => Learning on 80-90
2024-09-05 15:10:00,557 [foster.py] => All params: 171866372
2024-09-05 15:10:00,558 [foster.py] => Trainable params: 86006196
2024-09-05 15:10:00,676 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.602, Loss_clf 0.901, Loss_fe 1.685, Loss_kd 1.793, Train_accy 56.35, Test_accy 85.29:   0%|          | 0/20 [01:56<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.602, Loss_clf 0.901, Loss_fe 1.685, Loss_kd 1.793, Train_accy 56.35, Test_accy 85.29:   5%|▌         | 1/20 [01:56<36:59, 116.84s/it]
Task 4, Epoch 2/20 => Loss 3.205, Loss_clf 0.457, Loss_fe 0.773, Loss_kd 1.756, Train_accy 61.12:   5%|▌         | 1/20 [03:04<36:59, 116.84s/it]                 
Task 4, Epoch 2/20 => Loss 3.205, Loss_clf 0.457, Loss_fe 0.773, Loss_kd 1.756, Train_accy 61.12:  10%|█         | 2/20 [03:04<26:17, 87.62s/it] 
Task 4, Epoch 3/20 => Loss 2.982, Loss_clf 0.414, Loss_fe 0.573, Loss_kd 1.774, Train_accy 63.29:  10%|█         | 2/20 [04:11<26:17, 87.62s/it]
Task 4, Epoch 3/20 => Loss 2.982, Loss_clf 0.414, Loss_fe 0.573, Loss_kd 1.774, Train_accy 63.29:  15%|█▌        | 3/20 [04:11<22:10, 78.29s/it]
Task 4, Epoch 4/20 => Loss 2.821, Loss_clf 0.361, Loss_fe 0.476, Loss_kd 1.764, Train_accy 64.79:  15%|█▌        | 3/20 [05:18<22:10, 78.29s/it]
Task 4, Epoch 4/20 => Loss 2.821, Loss_clf 0.361, Loss_fe 0.476, Loss_kd 1.764, Train_accy 64.79:  20%|██        | 4/20 [05:18<19:42, 73.90s/it]
Task 4, Epoch 5/20 => Loss 2.779, Loss_clf 0.339, Loss_fe 0.444, Loss_kd 1.774, Train_accy 65.62:  20%|██        | 4/20 [06:25<19:42, 73.90s/it]
Task 4, Epoch 5/20 => Loss 2.779, Loss_clf 0.339, Loss_fe 0.444, Loss_kd 1.774, Train_accy 65.62:  25%|██▌       | 5/20 [06:25<17:52, 71.48s/it]
Task 4, Epoch 6/20 => Loss 2.782, Loss_clf 0.342, Loss_fe 0.432, Loss_kd 1.785, Train_accy 65.12, Test_accy 86.84:  25%|██▌       | 5/20 [08:22<17:52, 71.48s/it]
Task 4, Epoch 6/20 => Loss 2.782, Loss_clf 0.342, Loss_fe 0.432, Loss_kd 1.785, Train_accy 65.12, Test_accy 86.84:  30%|███       | 6/20 [08:22<20:17, 86.95s/it]
Task 4, Epoch 7/20 => Loss 2.674, Loss_clf 0.321, Loss_fe 0.377, Loss_kd 1.756, Train_accy 67.52:  30%|███       | 6/20 [09:29<20:17, 86.95s/it]                 
Task 4, Epoch 7/20 => Loss 2.674, Loss_clf 0.321, Loss_fe 0.377, Loss_kd 1.756, Train_accy 67.52:  35%|███▌      | 7/20 [09:29<17:25, 80.46s/it]
Task 4, Epoch 8/20 => Loss 2.659, Loss_clf 0.312, Loss_fe 0.354, Loss_kd 1.772, Train_accy 67.32:  35%|███▌      | 7/20 [10:36<17:25, 80.46s/it]
Task 4, Epoch 8/20 => Loss 2.659, Loss_clf 0.312, Loss_fe 0.354, Loss_kd 1.772, Train_accy 67.32:  40%|████      | 8/20 [10:36<15:14, 76.24s/it]
Task 4, Epoch 9/20 => Loss 2.619, Loss_clf 0.285, Loss_fe 0.343, Loss_kd 1.770, Train_accy 67.77:  40%|████      | 8/20 [11:43<15:14, 76.24s/it]
Task 4, Epoch 9/20 => Loss 2.619, Loss_clf 0.285, Loss_fe 0.343, Loss_kd 1.770, Train_accy 67.77:  45%|████▌     | 9/20 [11:43<13:27, 73.39s/it]
Task 4, Epoch 10/20 => Loss 2.617, Loss_clf 0.294, Loss_fe 0.329, Loss_kd 1.772, Train_accy 68.82:  45%|████▌     | 9/20 [12:51<13:27, 73.39s/it]
Task 4, Epoch 10/20 => Loss 2.617, Loss_clf 0.294, Loss_fe 0.329, Loss_kd 1.772, Train_accy 68.82:  50%|█████     | 10/20 [12:51<11:54, 71.46s/it]
Task 4, Epoch 11/20 => Loss 2.558, Loss_clf 0.274, Loss_fe 0.296, Loss_kd 1.767, Train_accy 69.24, Test_accy 86.93:  50%|█████     | 10/20 [14:48<11:54, 71.46s/it]
Task 4, Epoch 11/20 => Loss 2.558, Loss_clf 0.274, Loss_fe 0.296, Loss_kd 1.767, Train_accy 69.24, Test_accy 86.93:  55%|█████▌    | 11/20 [14:48<12:48, 85.40s/it]
Task 4, Epoch 12/20 => Loss 2.547, Loss_clf 0.268, Loss_fe 0.283, Loss_kd 1.774, Train_accy 71.06:  55%|█████▌    | 11/20 [15:55<12:48, 85.40s/it]                 
Task 4, Epoch 12/20 => Loss 2.547, Loss_clf 0.268, Loss_fe 0.283, Loss_kd 1.774, Train_accy 71.06:  60%|██████    | 12/20 [15:55<10:38, 79.87s/it]
Task 4, Epoch 13/20 => Loss 2.508, Loss_clf 0.257, Loss_fe 0.277, Loss_kd 1.754, Train_accy 70.27:  60%|██████    | 12/20 [17:02<10:38, 79.87s/it]
Task 4, Epoch 13/20 => Loss 2.508, Loss_clf 0.257, Loss_fe 0.277, Loss_kd 1.754, Train_accy 70.27:  65%|██████▌   | 13/20 [17:02<08:52, 76.01s/it]
Task 4, Epoch 14/20 => Loss 2.484, Loss_clf 0.249, Loss_fe 0.258, Loss_kd 1.758, Train_accy 71.33:  65%|██████▌   | 13/20 [18:09<08:52, 76.01s/it]
Task 4, Epoch 14/20 => Loss 2.484, Loss_clf 0.249, Loss_fe 0.258, Loss_kd 1.758, Train_accy 71.33:  70%|███████   | 14/20 [18:09<07:20, 73.35s/it]
Task 4, Epoch 15/20 => Loss 2.463, Loss_clf 0.240, Loss_fe 0.235, Loss_kd 1.768, Train_accy 72.24:  70%|███████   | 14/20 [19:16<07:20, 73.35s/it]
Task 4, Epoch 15/20 => Loss 2.463, Loss_clf 0.240, Loss_fe 0.235, Loss_kd 1.768, Train_accy 72.24:  75%|███████▌  | 15/20 [19:16<05:57, 71.50s/it]
Task 4, Epoch 16/20 => Loss 2.479, Loss_clf 0.251, Loss_fe 0.248, Loss_kd 1.760, Train_accy 71.42, Test_accy 86.98:  75%|███████▌  | 15/20 [21:14<05:57, 71.50s/it]
Task 4, Epoch 16/20 => Loss 2.479, Loss_clf 0.251, Loss_fe 0.248, Loss_kd 1.760, Train_accy 71.42, Test_accy 86.98:  80%|████████  | 16/20 [21:14<05:41, 85.29s/it]
Task 4, Epoch 17/20 => Loss 2.470, Loss_clf 0.239, Loss_fe 0.237, Loss_kd 1.772, Train_accy 72.14:  80%|████████  | 16/20 [22:21<05:41, 85.29s/it]                 
Task 4, Epoch 17/20 => Loss 2.470, Loss_clf 0.239, Loss_fe 0.237, Loss_kd 1.772, Train_accy 72.14:  85%|████████▌ | 17/20 [22:21<03:59, 79.84s/it]
Task 4, Epoch 18/20 => Loss 2.467, Loss_clf 0.237, Loss_fe 0.222, Loss_kd 1.784, Train_accy 73.62:  85%|████████▌ | 17/20 [23:28<03:59, 79.84s/it]
Task 4, Epoch 18/20 => Loss 2.467, Loss_clf 0.237, Loss_fe 0.222, Loss_kd 1.784, Train_accy 73.62:  90%|█████████ | 18/20 [23:28<02:32, 76.04s/it]
Task 4, Epoch 19/20 => Loss 2.457, Loss_clf 0.239, Loss_fe 0.231, Loss_kd 1.766, Train_accy 73.82:  90%|█████████ | 18/20 [24:35<02:32, 76.04s/it]
Task 4, Epoch 19/20 => Loss 2.457, Loss_clf 0.239, Loss_fe 0.231, Loss_kd 1.766, Train_accy 73.82:  95%|█████████▌| 19/20 [24:35<01:13, 73.38s/it]
Task 4, Epoch 20/20 => Loss 2.441, Loss_clf 0.235, Loss_fe 0.214, Loss_kd 1.771, Train_accy 72.64:  95%|█████████▌| 19/20 [25:42<01:13, 73.38s/it]
Task 4, Epoch 20/20 => Loss 2.441, Loss_clf 0.235, Loss_fe 0.214, Loss_kd 1.771, Train_accy 72.64: 100%|██████████| 20/20 [25:42<00:00, 71.51s/it]
Task 4, Epoch 20/20 => Loss 2.441, Loss_clf 0.235, Loss_fe 0.214, Loss_kd 1.771, Train_accy 72.64: 100%|██████████| 20/20 [25:42<00:00, 77.14s/it]
2024-09-05 15:35:43,563 [foster.py] => Task 4, Epoch 20/20 => Loss 2.441, Loss_clf 0.235, Loss_fe 0.214, Loss_kd 1.771, Train_accy 72.64
2024-09-05 15:35:43,565 [foster.py] => do not weight align teacher!
2024-09-05 15:35:43,569 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.972,  Train_accy 50.50, Test_accy 85.44:   0%|          | 0/20 [01:50<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.972,  Train_accy 50.50, Test_accy 85.44:   5%|▌         | 1/20 [01:50<35:00, 110.55s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.793,  Train_accy 55.67:   5%|▌         | 1/20 [03:15<35:00, 110.55s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.793,  Train_accy 55.67:  10%|█         | 2/20 [03:15<28:36, 95.34s/it] 
SNet: Task 4, Epoch 3/20 => Loss 1.802,  Train_accy 56.11:  10%|█         | 2/20 [04:39<28:36, 95.34s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.802,  Train_accy 56.11:  15%|█▌        | 3/20 [04:39<25:38, 90.48s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.788,  Train_accy 55.94:  15%|█▌        | 3/20 [06:04<25:38, 90.48s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.788,  Train_accy 55.94:  20%|██        | 4/20 [06:04<23:30, 88.19s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.754,  Train_accy 57.48:  20%|██        | 4/20 [07:29<23:30, 88.19s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.754,  Train_accy 57.48:  25%|██▌       | 5/20 [07:29<21:43, 86.91s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.773,  Train_accy 57.32, Test_accy 85.98:  25%|██▌       | 5/20 [09:19<21:43, 86.91s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.773,  Train_accy 57.32, Test_accy 85.98:  30%|███       | 6/20 [09:19<22:09, 94.99s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.767,  Train_accy 56.33:  30%|███       | 6/20 [10:44<22:09, 94.99s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.767,  Train_accy 56.33:  35%|███▌      | 7/20 [10:44<19:50, 91.60s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.773,  Train_accy 56.95:  35%|███▌      | 7/20 [12:09<19:50, 91.60s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.773,  Train_accy 56.95:  40%|████      | 8/20 [12:09<17:52, 89.38s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.755,  Train_accy 58.24:  40%|████      | 8/20 [13:33<17:52, 89.38s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.755,  Train_accy 58.24:  45%|████▌     | 9/20 [13:33<16:06, 87.88s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.771,  Train_accy 57.74:  45%|████▌     | 9/20 [14:58<16:06, 87.88s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.771,  Train_accy 57.74:  50%|█████     | 10/20 [14:58<14:28, 86.85s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.775,  Train_accy 57.21, Test_accy 86.13:  50%|█████     | 10/20 [16:48<14:28, 86.85s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.775,  Train_accy 57.21, Test_accy 86.13:  55%|█████▌    | 11/20 [16:48<14:06, 94.08s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.745,  Train_accy 57.30:  55%|█████▌    | 11/20 [18:13<14:06, 94.08s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.745,  Train_accy 57.30:  60%|██████    | 12/20 [18:13<12:09, 91.19s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.754,  Train_accy 58.02:  60%|██████    | 12/20 [19:37<12:09, 91.19s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.754,  Train_accy 58.02:  65%|██████▌   | 13/20 [19:37<10:24, 89.18s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.763,  Train_accy 57.76:  65%|██████▌   | 13/20 [21:02<10:24, 89.18s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.763,  Train_accy 57.76:  70%|███████   | 14/20 [21:02<08:46, 87.83s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.763,  Train_accy 57.61:  70%|███████   | 14/20 [22:27<08:46, 87.83s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.763,  Train_accy 57.61:  75%|███████▌  | 15/20 [22:27<07:14, 86.84s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.738,  Train_accy 58.06, Test_accy 86.08:  75%|███████▌  | 15/20 [24:17<07:14, 86.84s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.738,  Train_accy 58.06, Test_accy 86.08:  80%|████████  | 16/20 [24:17<06:16, 94.00s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.776,  Train_accy 56.89:  80%|████████  | 16/20 [25:42<06:16, 94.00s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.776,  Train_accy 56.89:  85%|████████▌ | 17/20 [25:42<04:33, 91.17s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.779,  Train_accy 57.42:  85%|████████▌ | 17/20 [27:07<04:33, 91.17s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.779,  Train_accy 57.42:  90%|█████████ | 18/20 [27:07<02:58, 89.20s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.776,  Train_accy 57.59:  90%|█████████ | 18/20 [28:31<02:58, 89.20s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.776,  Train_accy 57.59:  95%|█████████▌| 19/20 [28:31<01:27, 87.82s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.755,  Train_accy 58.03:  95%|█████████▌| 19/20 [29:56<01:27, 87.82s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.755,  Train_accy 58.03: 100%|██████████| 20/20 [29:56<00:00, 86.84s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.755,  Train_accy 58.03: 100%|██████████| 20/20 [29:56<00:00, 89.81s/it]
2024-09-05 16:05:41,305 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.755,  Train_accy 58.03
2024-09-05 16:05:41,305 [foster.py] => do not weight align student!
2024-09-05 16:06:07,246 [foster.py] => darknet eval: 
2024-09-05 16:06:07,247 [foster.py] => CNN top1 curve: 86.1
2024-09-05 16:06:07,247 [foster.py] => CNN top5 curve: 99.13
2024-09-05 16:06:07,250 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 16:08:53,951 [foster.py] => Exemplar size: 1800
2024-09-05 16:08:53,952 [trainer.py] => CNN: {'total': 87.17, '00-49': 93.8, '50-59': 86.7, '60-69': 87.7, '70-79': 75.5, '80-89': 65.6, 'old': 89.86, 'new': 65.6}
2024-09-05 16:08:53,952 [trainer.py] => NME: {'total': 90.07, '00-49': 91.2, '50-59': 86.1, '60-69': 90.6, '70-79': 83.6, '80-89': 94.3, 'old': 89.54, 'new': 94.3}
2024-09-05 16:08:53,952 [trainer.py] => CNN top1 curve: [94.9, 93.05, 91.7, 88.7, 87.17]
2024-09-05 16:08:53,952 [trainer.py] => CNN top5 curve: [99.58, 99.43, 99.47, 99.31, 99.27]
2024-09-05 16:08:53,952 [trainer.py] => NME top1 curve: [94.84, 93.55, 92.67, 90.49, 90.07]
2024-09-05 16:08:53,952 [trainer.py] => NME top5 curve: [99.58, 99.55, 99.43, 99.29, 99.09]

Average Accuracy (CNN): 91.1
Average Accuracy (NME): 92.32
2024-09-05 16:08:53,952 [trainer.py] => Average Accuracy (CNN): 91.1
2024-09-05 16:08:53,952 [trainer.py] => Average Accuracy (NME): 92.32
2024-09-05 16:08:53,953 [trainer.py] => All params: 171866372
2024-09-05 16:08:53,954 [trainer.py] => Trainable params: 86006196
2024-09-05 16:08:55,535 [foster.py] => Learning on 90-100
2024-09-05 16:08:55,536 [foster.py] => All params: 171897122
2024-09-05 16:08:55,537 [foster.py] => Trainable params: 86029256
2024-09-05 16:08:55,676 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 4.924, Loss_clf 0.883, Loss_fe 1.777, Loss_kd 2.037, Train_accy 60.66, Test_accy 86.81:   0%|          | 0/20 [02:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 4.924, Loss_clf 0.883, Loss_fe 1.777, Loss_kd 2.037, Train_accy 60.66, Test_accy 86.81:   5%|▌         | 1/20 [02:04<39:25, 124.51s/it]
Task 5, Epoch 2/20 => Loss 3.449, Loss_clf 0.466, Loss_fe 0.768, Loss_kd 1.994, Train_accy 68.37:   5%|▌         | 1/20 [03:13<39:25, 124.51s/it]                 
Task 5, Epoch 2/20 => Loss 3.449, Loss_clf 0.466, Loss_fe 0.768, Loss_kd 1.994, Train_accy 68.37:  10%|█         | 2/20 [03:13<27:35, 91.99s/it] 
Task 5, Epoch 3/20 => Loss 3.289, Loss_clf 0.446, Loss_fe 0.604, Loss_kd 2.015, Train_accy 67.29:  10%|█         | 2/20 [04:23<27:35, 91.99s/it]
Task 5, Epoch 3/20 => Loss 3.289, Loss_clf 0.446, Loss_fe 0.604, Loss_kd 2.015, Train_accy 67.29:  15%|█▌        | 3/20 [04:23<23:07, 81.63s/it]
Task 5, Epoch 4/20 => Loss 3.170, Loss_clf 0.402, Loss_fe 0.530, Loss_kd 2.014, Train_accy 67.13:  15%|█▌        | 3/20 [05:32<23:07, 81.63s/it]
Task 5, Epoch 4/20 => Loss 3.170, Loss_clf 0.402, Loss_fe 0.530, Loss_kd 2.014, Train_accy 67.13:  20%|██        | 4/20 [05:32<20:27, 76.72s/it]
Task 5, Epoch 5/20 => Loss 3.100, Loss_clf 0.379, Loss_fe 0.477, Loss_kd 2.019, Train_accy 69.12:  20%|██        | 4/20 [06:41<20:27, 76.72s/it]
Task 5, Epoch 5/20 => Loss 3.100, Loss_clf 0.379, Loss_fe 0.477, Loss_kd 2.019, Train_accy 69.12:  25%|██▌       | 5/20 [06:41<18:30, 74.06s/it]
Task 5, Epoch 6/20 => Loss 3.029, Loss_clf 0.363, Loss_fe 0.429, Loss_kd 2.013, Train_accy 69.66, Test_accy 87.61:  25%|██▌       | 5/20 [08:46<18:30, 74.06s/it]
Task 5, Epoch 6/20 => Loss 3.029, Loss_clf 0.363, Loss_fe 0.429, Loss_kd 2.013, Train_accy 69.66, Test_accy 87.61:  30%|███       | 6/20 [08:46<21:17, 91.28s/it]
Task 5, Epoch 7/20 => Loss 2.996, Loss_clf 0.348, Loss_fe 0.406, Loss_kd 2.017, Train_accy 70.79:  30%|███       | 6/20 [09:55<21:17, 91.28s/it]                 
Task 5, Epoch 7/20 => Loss 2.996, Loss_clf 0.348, Loss_fe 0.406, Loss_kd 2.017, Train_accy 70.79:  35%|███▌      | 7/20 [09:55<18:13, 84.09s/it]
Task 5, Epoch 8/20 => Loss 2.961, Loss_clf 0.339, Loss_fe 0.382, Loss_kd 2.016, Train_accy 71.96:  35%|███▌      | 7/20 [11:04<18:13, 84.09s/it]
Task 5, Epoch 8/20 => Loss 2.961, Loss_clf 0.339, Loss_fe 0.382, Loss_kd 2.016, Train_accy 71.96:  40%|████      | 8/20 [11:04<15:52, 79.34s/it]
Task 5, Epoch 9/20 => Loss 2.889, Loss_clf 0.319, Loss_fe 0.358, Loss_kd 1.991, Train_accy 72.65:  40%|████      | 8/20 [12:13<15:52, 79.34s/it]
Task 5, Epoch 9/20 => Loss 2.889, Loss_clf 0.319, Loss_fe 0.358, Loss_kd 1.991, Train_accy 72.65:  45%|████▌     | 9/20 [12:13<13:57, 76.15s/it]
Task 5, Epoch 10/20 => Loss 2.852, Loss_clf 0.300, Loss_fe 0.330, Loss_kd 2.000, Train_accy 73.94:  45%|████▌     | 9/20 [13:23<13:57, 76.15s/it]
Task 5, Epoch 10/20 => Loss 2.852, Loss_clf 0.300, Loss_fe 0.330, Loss_kd 2.000, Train_accy 73.94:  50%|█████     | 10/20 [13:23<12:20, 74.00s/it]
Task 5, Epoch 11/20 => Loss 2.835, Loss_clf 0.293, Loss_fe 0.310, Loss_kd 2.010, Train_accy 73.57, Test_accy 87.54:  50%|█████     | 10/20 [15:27<12:20, 74.00s/it]
Task 5, Epoch 11/20 => Loss 2.835, Loss_clf 0.293, Loss_fe 0.310, Loss_kd 2.010, Train_accy 73.57, Test_accy 87.54:  55%|█████▌    | 11/20 [15:27<13:25, 89.50s/it]
Task 5, Epoch 12/20 => Loss 2.837, Loss_clf 0.296, Loss_fe 0.309, Loss_kd 2.008, Train_accy 74.57:  55%|█████▌    | 11/20 [16:36<13:25, 89.50s/it]                 
Task 5, Epoch 12/20 => Loss 2.837, Loss_clf 0.296, Loss_fe 0.309, Loss_kd 2.008, Train_accy 74.57:  60%|██████    | 12/20 [16:36<11:06, 83.33s/it]
Task 5, Epoch 13/20 => Loss 2.774, Loss_clf 0.269, Loss_fe 0.282, Loss_kd 2.000, Train_accy 74.10:  60%|██████    | 12/20 [17:46<11:06, 83.33s/it]
Task 5, Epoch 13/20 => Loss 2.774, Loss_clf 0.269, Loss_fe 0.282, Loss_kd 2.000, Train_accy 74.10:  65%|██████▌   | 13/20 [17:46<09:13, 79.06s/it]
Task 5, Epoch 14/20 => Loss 2.801, Loss_clf 0.276, Loss_fe 0.280, Loss_kd 2.021, Train_accy 75.16:  65%|██████▌   | 13/20 [18:55<09:13, 79.06s/it]
Task 5, Epoch 14/20 => Loss 2.801, Loss_clf 0.276, Loss_fe 0.280, Loss_kd 2.021, Train_accy 75.16:  70%|███████   | 14/20 [18:55<07:36, 76.10s/it]
Task 5, Epoch 15/20 => Loss 2.763, Loss_clf 0.264, Loss_fe 0.255, Loss_kd 2.019, Train_accy 77.03:  70%|███████   | 14/20 [20:04<07:36, 76.10s/it]
Task 5, Epoch 15/20 => Loss 2.763, Loss_clf 0.264, Loss_fe 0.255, Loss_kd 2.019, Train_accy 77.03:  75%|███████▌  | 15/20 [20:04<06:10, 74.01s/it]
Task 5, Epoch 16/20 => Loss 2.710, Loss_clf 0.246, Loss_fe 0.234, Loss_kd 2.006, Train_accy 77.15, Test_accy 87.63:  75%|███████▌  | 15/20 [22:09<06:10, 74.01s/it]
Task 5, Epoch 16/20 => Loss 2.710, Loss_clf 0.246, Loss_fe 0.234, Loss_kd 2.006, Train_accy 77.15, Test_accy 87.63:  80%|████████  | 16/20 [22:09<05:56, 89.24s/it]
Task 5, Epoch 17/20 => Loss 2.725, Loss_clf 0.253, Loss_fe 0.246, Loss_kd 2.003, Train_accy 76.01:  80%|████████  | 16/20 [23:18<05:56, 89.24s/it]                 
Task 5, Epoch 17/20 => Loss 2.725, Loss_clf 0.253, Loss_fe 0.246, Loss_kd 2.003, Train_accy 76.01:  85%|████████▌ | 17/20 [23:18<04:09, 83.23s/it]
Task 5, Epoch 18/20 => Loss 2.710, Loss_clf 0.255, Loss_fe 0.240, Loss_kd 1.993, Train_accy 76.35:  85%|████████▌ | 17/20 [24:27<04:09, 83.23s/it]
Task 5, Epoch 18/20 => Loss 2.710, Loss_clf 0.255, Loss_fe 0.240, Loss_kd 1.993, Train_accy 76.35:  90%|█████████ | 18/20 [24:27<02:38, 79.04s/it]
Task 5, Epoch 19/20 => Loss 2.724, Loss_clf 0.257, Loss_fe 0.239, Loss_kd 2.005, Train_accy 76.63:  90%|█████████ | 18/20 [25:36<02:38, 79.04s/it]
Task 5, Epoch 19/20 => Loss 2.724, Loss_clf 0.257, Loss_fe 0.239, Loss_kd 2.005, Train_accy 76.63:  95%|█████████▌| 19/20 [25:36<01:16, 76.09s/it]
Task 5, Epoch 20/20 => Loss 2.674, Loss_clf 0.232, Loss_fe 0.219, Loss_kd 2.000, Train_accy 78.49:  95%|█████████▌| 19/20 [26:46<01:16, 76.09s/it]
Task 5, Epoch 20/20 => Loss 2.674, Loss_clf 0.232, Loss_fe 0.219, Loss_kd 2.000, Train_accy 78.49: 100%|██████████| 20/20 [26:46<00:00, 74.03s/it]
Task 5, Epoch 20/20 => Loss 2.674, Loss_clf 0.232, Loss_fe 0.219, Loss_kd 2.000, Train_accy 78.49: 100%|██████████| 20/20 [26:46<00:00, 80.31s/it]
2024-09-05 16:35:41,836 [foster.py] => Task 5, Epoch 20/20 => Loss 2.674, Loss_clf 0.232, Loss_fe 0.219, Loss_kd 2.000, Train_accy 78.49
2024-09-05 16:35:41,837 [foster.py] => do not weight align teacher!
2024-09-05 16:35:41,842 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 2.159,  Train_accy 54.44, Test_accy 86.91:   0%|          | 0/20 [01:56<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 2.159,  Train_accy 54.44, Test_accy 86.91:   5%|▌         | 1/20 [01:56<36:45, 116.07s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.992,  Train_accy 59.82:   5%|▌         | 1/20 [03:23<36:45, 116.07s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.992,  Train_accy 59.82:  10%|█         | 2/20 [03:23<29:42, 99.04s/it] 
SNet: Task 5, Epoch 3/20 => Loss 1.953,  Train_accy 60.50:  10%|█         | 2/20 [04:50<29:42, 99.04s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.953,  Train_accy 60.50:  15%|█▌        | 3/20 [04:50<26:31, 93.61s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.947,  Train_accy 61.59:  15%|█▌        | 3/20 [06:17<26:31, 93.61s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.947,  Train_accy 61.59:  20%|██        | 4/20 [06:17<24:16, 91.06s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.958,  Train_accy 61.54:  20%|██        | 4/20 [07:44<24:16, 91.06s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.958,  Train_accy 61.54:  25%|██▌       | 5/20 [07:44<22:24, 89.66s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.917,  Train_accy 62.65, Test_accy 87.25:  25%|██▌       | 5/20 [09:40<22:24, 89.66s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.917,  Train_accy 62.65, Test_accy 87.25:  30%|███       | 6/20 [09:40<22:59, 98.57s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.940,  Train_accy 62.71:  30%|███       | 6/20 [11:07<22:59, 98.57s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.940,  Train_accy 62.71:  35%|███▌      | 7/20 [11:07<20:32, 94.83s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.974,  Train_accy 61.37:  35%|███▌      | 7/20 [12:34<20:32, 94.83s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.974,  Train_accy 61.37:  40%|████      | 8/20 [12:34<18:28, 92.40s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.940,  Train_accy 61.87:  40%|████      | 8/20 [14:02<18:28, 92.40s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.940,  Train_accy 61.87:  45%|████▌     | 9/20 [14:02<16:38, 90.76s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.942,  Train_accy 61.74:  45%|████▌     | 9/20 [15:29<16:38, 90.76s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.942,  Train_accy 61.74:  50%|█████     | 10/20 [15:29<14:56, 89.64s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.934,  Train_accy 62.60, Test_accy 87.17:  50%|█████     | 10/20 [17:24<14:56, 89.64s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.934,  Train_accy 62.60, Test_accy 87.17:  55%|█████▌    | 11/20 [17:24<14:38, 97.66s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.947,  Train_accy 62.35:  55%|█████▌    | 11/20 [18:52<14:38, 97.66s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.947,  Train_accy 62.35:  60%|██████    | 12/20 [18:52<12:35, 94.45s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.964,  Train_accy 62.18:  60%|██████    | 12/20 [20:19<12:35, 94.45s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.964,  Train_accy 62.18:  65%|██████▌   | 13/20 [20:19<10:45, 92.23s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.945,  Train_accy 61.99:  65%|██████▌   | 13/20 [21:46<10:45, 92.23s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.945,  Train_accy 61.99:  70%|███████   | 14/20 [21:46<09:04, 90.80s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.937,  Train_accy 63.12:  70%|███████   | 14/20 [23:14<09:04, 90.80s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.937,  Train_accy 63.12:  75%|███████▌  | 15/20 [23:14<07:28, 89.78s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.914,  Train_accy 62.78, Test_accy 87.23:  75%|███████▌  | 15/20 [25:10<07:28, 89.78s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.914,  Train_accy 62.78, Test_accy 87.23:  80%|████████  | 16/20 [25:10<06:30, 97.71s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.930,  Train_accy 62.31:  80%|████████  | 16/20 [26:37<06:30, 97.71s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.930,  Train_accy 62.31:  85%|████████▌ | 17/20 [26:37<04:43, 94.58s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.931,  Train_accy 62.00:  85%|████████▌ | 17/20 [28:04<04:43, 94.58s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.931,  Train_accy 62.00:  90%|█████████ | 18/20 [28:04<03:04, 92.39s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.940,  Train_accy 62.29:  90%|█████████ | 18/20 [29:32<03:04, 92.39s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.940,  Train_accy 62.29:  95%|█████████▌| 19/20 [29:32<01:30, 90.87s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.953,  Train_accy 62.51:  95%|█████████▌| 19/20 [30:59<01:30, 90.87s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.953,  Train_accy 62.51: 100%|██████████| 20/20 [30:59<00:00, 89.79s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.953,  Train_accy 62.51: 100%|██████████| 20/20 [30:59<00:00, 92.97s/it]
2024-09-05 17:06:42,766 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.953,  Train_accy 62.51
2024-09-05 17:06:42,767 [foster.py] => do not weight align student!
2024-09-05 17:07:11,467 [foster.py] => darknet eval: 
2024-09-05 17:07:11,468 [foster.py] => CNN top1 curve: 87.17
2024-09-05 17:07:11,468 [foster.py] => CNN top5 curve: 98.89
2024-09-05 17:07:11,470 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 17:10:11,502 [foster.py] => Exemplar size: 2000
2024-09-05 17:10:11,503 [trainer.py] => CNN: {'total': 87.81, '00-49': 93.22, '50-59': 86.3, '60-69': 89.6, '70-79': 80.2, '80-89': 78.7, '90-99': 77.2, 'old': 88.99, 'new': 77.2}
2024-09-05 17:10:11,503 [trainer.py] => NME: {'total': 89.82, '00-49': 91.5, '50-59': 84.4, '60-69': 90.9, '70-79': 84.5, '80-89': 88.3, '90-99': 92.6, 'old': 89.51, 'new': 92.6}
2024-09-05 17:10:11,503 [trainer.py] => CNN top1 curve: [94.9, 93.05, 91.7, 88.7, 87.17, 87.81]
2024-09-05 17:10:11,503 [trainer.py] => CNN top5 curve: [99.58, 99.43, 99.47, 99.31, 99.27, 98.91]
2024-09-05 17:10:11,503 [trainer.py] => NME top1 curve: [94.84, 93.55, 92.67, 90.49, 90.07, 89.82]
2024-09-05 17:10:11,503 [trainer.py] => NME top5 curve: [99.58, 99.55, 99.43, 99.29, 99.09, 98.81]

Average Accuracy (CNN): 90.56
Average Accuracy (NME): 91.91
2024-09-05 17:10:11,503 [trainer.py] => Average Accuracy (CNN): 90.56
2024-09-05 17:10:11,503 [trainer.py] => Average Accuracy (NME): 91.91
Accuracy Matrix (CNN):
[[94.9  94.78 94.58 94.12 93.8  93.22]
 [ 0.   84.4  87.2  87.1  86.7  86.3 ]
 [ 0.    0.   81.8  84.   87.7  89.6 ]
 [ 0.    0.    0.   67.9  75.5  80.2 ]
 [ 0.    0.    0.    0.   65.6  78.7 ]
 [ 0.    0.    0.    0.    0.   77.2 ]]
2024-09-05 17:10:11,504 [trainer.py] => Forgetting (CNN): 0.5160000000000025
Accuracy Matrix (NME):
[[94.84 93.34 93.26 92.2  91.2  91.5 ]
 [ 0.   94.6  86.8  81.6  86.1  84.4 ]
 [ 0.    0.   95.6  89.   90.6  90.9 ]
 [ 0.    0.    0.   92.3  83.6  84.5 ]
 [ 0.    0.    0.    0.   94.3  88.3 ]
 [ 0.    0.    0.    0.    0.   92.6 ]]
2024-09-05 17:10:11,504 [trainer.py] => Forgetting (NME): 6.407999999999996
2024-09-05 17:10:14,423 [trainer.py] => config: ./exps/foster_cifar_B50_Inc10.json
2024-09-05 17:10:14,423 [trainer.py] => prefix: cil
2024-09-05 17:10:14,423 [trainer.py] => dataset: cifar224
2024-09-05 17:10:14,423 [trainer.py] => memory_size: 2000
2024-09-05 17:10:14,423 [trainer.py] => memory_per_class: 20
2024-09-05 17:10:14,423 [trainer.py] => fixed_memory: True
2024-09-05 17:10:14,423 [trainer.py] => shuffle: True
2024-09-05 17:10:14,423 [trainer.py] => init_cls: 50
2024-09-05 17:10:14,423 [trainer.py] => increment: 5
2024-09-05 17:10:14,423 [trainer.py] => model_name: foster
2024-09-05 17:10:14,423 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 17:10:14,423 [trainer.py] => device: [device(type='cuda', index=7)]
2024-09-05 17:10:14,423 [trainer.py] => seed: 1993
2024-09-05 17:10:14,423 [trainer.py] => beta1: 0.96
2024-09-05 17:10:14,423 [trainer.py] => beta2: 0.97
2024-09-05 17:10:14,423 [trainer.py] => oofc: ft
2024-09-05 17:10:14,423 [trainer.py] => is_teacher_wa: False
2024-09-05 17:10:14,423 [trainer.py] => is_student_wa: False
2024-09-05 17:10:14,423 [trainer.py] => lambda_okd: 1
2024-09-05 17:10:14,423 [trainer.py] => wa_value: 1
2024-09-05 17:10:14,424 [trainer.py] => init_epochs: 20
2024-09-05 17:10:14,424 [trainer.py] => init_lr: 0.001
2024-09-05 17:10:14,424 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 17:10:14,424 [trainer.py] => boosting_epochs: 20
2024-09-05 17:10:14,424 [trainer.py] => compression_epochs: 20
2024-09-05 17:10:14,424 [trainer.py] => lr: 0.001
2024-09-05 17:10:14,424 [trainer.py] => batch_size: 48
2024-09-05 17:10:14,424 [trainer.py] => weight_decay: 0.0005
2024-09-05 17:10:14,424 [trainer.py] => num_workers: 8
2024-09-05 17:10:14,424 [trainer.py] => T: 2
2024-09-05 17:10:15,523 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-05 17:10:15,935 [trainer.py] => All params: 0
2024-09-05 17:10:15,935 [trainer.py] => Trainable params: 0
2024-09-05 17:10:17,574 [foster.py] => Learning on 0-50
2024-09-05 17:10:17,575 [foster.py] => All params: 85875556
2024-09-05 17:10:17,575 [foster.py] => Trainable params: 85875556

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.447, Train_accy 37.26, Test_accy 89.30:   0%|          | 0/20 [03:20<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.447, Train_accy 37.26, Test_accy 89.30:   5%|▌         | 1/20 [03:20<1:03:34, 200.74s/it]
Task 0, Epoch 2/20 => Loss 0.846, Train_accy 76.19:   5%|▌         | 1/20 [06:27<1:03:34, 200.74s/it]                 
Task 0, Epoch 2/20 => Loss 0.846, Train_accy 76.19:  10%|█         | 2/20 [06:27<57:41, 192.29s/it]  
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 79.80:  10%|█         | 2/20 [09:33<57:41, 192.29s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 79.80:  15%|█▌        | 3/20 [09:33<53:43, 189.63s/it]
Task 0, Epoch 4/20 => Loss 0.625, Train_accy 82.48:  15%|█▌        | 3/20 [12:40<53:43, 189.63s/it]
Task 0, Epoch 4/20 => Loss 0.625, Train_accy 82.48:  20%|██        | 4/20 [12:40<50:14, 188.38s/it]
Task 0, Epoch 5/20 => Loss 0.570, Train_accy 83.64:  20%|██        | 4/20 [15:46<50:14, 188.38s/it]
Task 0, Epoch 5/20 => Loss 0.570, Train_accy 83.64:  25%|██▌       | 5/20 [15:46<46:55, 187.67s/it]
Task 0, Epoch 6/20 => Loss 0.519, Train_accy 85.11, Test_accy 93.44:  25%|██▌       | 5/20 [19:07<46:55, 187.67s/it]
Task 0, Epoch 6/20 => Loss 0.519, Train_accy 85.11, Test_accy 93.44:  30%|███       | 6/20 [19:07<44:50, 192.16s/it]
Task 0, Epoch 7/20 => Loss 0.495, Train_accy 85.58:  30%|███       | 6/20 [22:13<44:50, 192.16s/it]                 
Task 0, Epoch 7/20 => Loss 0.495, Train_accy 85.58:  35%|███▌      | 7/20 [22:13<41:13, 190.27s/it]
Task 0, Epoch 8/20 => Loss 0.451, Train_accy 87.03:  35%|███▌      | 7/20 [25:20<41:13, 190.27s/it]
Task 0, Epoch 8/20 => Loss 0.451, Train_accy 87.03:  40%|████      | 8/20 [25:20<37:48, 189.01s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 87.73:  40%|████      | 8/20 [28:26<37:48, 189.01s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 87.73:  45%|████▌     | 9/20 [28:26<34:29, 188.17s/it]
Task 0, Epoch 10/20 => Loss 0.402, Train_accy 88.54:  45%|████▌     | 9/20 [31:32<34:29, 188.17s/it]
Task 0, Epoch 10/20 => Loss 0.402, Train_accy 88.54:  50%|█████     | 10/20 [31:32<31:15, 187.58s/it]
Task 0, Epoch 11/20 => Loss 0.377, Train_accy 89.20, Test_accy 94.36:  50%|█████     | 10/20 [34:53<31:15, 187.58s/it]
Task 0, Epoch 11/20 => Loss 0.377, Train_accy 89.20, Test_accy 94.36:  55%|█████▌    | 11/20 [34:53<28:44, 191.59s/it]
Task 0, Epoch 12/20 => Loss 0.359, Train_accy 89.74:  55%|█████▌    | 11/20 [37:59<28:44, 191.59s/it]                 
Task 0, Epoch 12/20 => Loss 0.359, Train_accy 89.74:  60%|██████    | 12/20 [37:59<25:19, 189.96s/it]
Task 0, Epoch 13/20 => Loss 0.335, Train_accy 90.50:  60%|██████    | 12/20 [41:05<25:19, 189.96s/it]
Task 0, Epoch 13/20 => Loss 0.335, Train_accy 90.50:  65%|██████▌   | 13/20 [41:05<22:02, 188.87s/it]
Task 0, Epoch 14/20 => Loss 0.335, Train_accy 90.54:  65%|██████▌   | 13/20 [44:12<22:02, 188.87s/it]
Task 0, Epoch 14/20 => Loss 0.335, Train_accy 90.54:  70%|███████   | 14/20 [44:12<18:48, 188.06s/it]
Task 0, Epoch 15/20 => Loss 0.308, Train_accy 91.26:  70%|███████   | 14/20 [47:18<18:48, 188.06s/it]
Task 0, Epoch 15/20 => Loss 0.308, Train_accy 91.26:  75%|███████▌  | 15/20 [47:18<15:37, 187.53s/it]
Task 0, Epoch 16/20 => Loss 0.295, Train_accy 91.69, Test_accy 94.96:  75%|███████▌  | 15/20 [50:39<15:37, 187.53s/it]
Task 0, Epoch 16/20 => Loss 0.295, Train_accy 91.69, Test_accy 94.96:  80%|████████  | 16/20 [50:39<12:45, 191.50s/it]
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.78:  80%|████████  | 16/20 [53:45<12:45, 191.50s/it]                 
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.78:  85%|████████▌ | 17/20 [53:45<09:29, 189.93s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 91.87:  85%|████████▌ | 17/20 [56:51<09:29, 189.93s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 91.87:  90%|█████████ | 18/20 [56:51<06:17, 188.83s/it]
Task 0, Epoch 19/20 => Loss 0.275, Train_accy 92.10:  90%|█████████ | 18/20 [59:58<06:17, 188.83s/it]
Task 0, Epoch 19/20 => Loss 0.275, Train_accy 92.10:  95%|█████████▌| 19/20 [59:58<03:08, 188.09s/it]
Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08:  95%|█████████▌| 19/20 [1:03:04<03:08, 188.09s/it]
Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08: 100%|██████████| 20/20 [1:03:04<00:00, 187.54s/it]
Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08: 100%|██████████| 20/20 [1:03:04<00:00, 189.21s/it]
2024-09-05 18:13:22,387 [foster.py] => Task 0, Epoch 20/20 => Loss 0.277, Train_accy 92.08
2024-09-05 18:13:22,389 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 18:15:26,359 [foster.py] => Exemplar size: 1000
2024-09-05 18:15:26,359 [trainer.py] => CNN: {'total': 94.9, '00-49': 94.9, 'old': 0, 'new': 94.9}
2024-09-05 18:15:26,359 [trainer.py] => NME: {'total': 94.84, '00-49': 94.84, 'old': 0, 'new': 94.84}
2024-09-05 18:15:26,359 [trainer.py] => CNN top1 curve: [94.9]
2024-09-05 18:15:26,359 [trainer.py] => CNN top5 curve: [99.58]
2024-09-05 18:15:26,359 [trainer.py] => NME top1 curve: [94.84]
2024-09-05 18:15:26,359 [trainer.py] => NME top5 curve: [99.58]

Average Accuracy (CNN): 94.9
Average Accuracy (NME): 94.84
2024-09-05 18:15:26,359 [trainer.py] => Average Accuracy (CNN): 94.9
2024-09-05 18:15:26,359 [trainer.py] => Average Accuracy (NME): 94.84
2024-09-05 18:15:26,360 [trainer.py] => All params: 85875556
2024-09-05 18:15:26,361 [trainer.py] => Trainable params: 85875556
2024-09-05 18:15:27,897 [foster.py] => Learning on 50-55
2024-09-05 18:15:27,898 [foster.py] => All params: 171762592
2024-09-05 18:15:27,899 [foster.py] => Trainable params: 85925486
2024-09-05 18:15:27,971 [foster.py] => per cls weights : [1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 0.5813577  0.5813577  0.5813577  0.5813577
 0.5813577 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.872, Loss_clf 0.679, Loss_fe 1.574, Loss_kd 1.472, Train_accy 69.69, Test_accy 92.31:   0%|          | 0/20 [01:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.872, Loss_clf 0.679, Loss_fe 1.574, Loss_kd 1.472, Train_accy 69.69, Test_accy 92.31:   5%|▌         | 1/20 [01:05<20:52, 65.91s/it]
Task 1, Epoch 2/20 => Loss 2.608, Loss_clf 0.324, Loss_fe 0.626, Loss_kd 1.507, Train_accy 73.14:   5%|▌         | 1/20 [01:41<20:52, 65.91s/it]                 
Task 1, Epoch 2/20 => Loss 2.608, Loss_clf 0.324, Loss_fe 0.626, Loss_kd 1.507, Train_accy 73.14:  10%|█         | 2/20 [01:41<14:25, 48.10s/it]
Task 1, Epoch 3/20 => Loss 2.311, Loss_clf 0.295, Loss_fe 0.391, Loss_kd 1.476, Train_accy 74.17:  10%|█         | 2/20 [02:17<14:25, 48.10s/it]
Task 1, Epoch 3/20 => Loss 2.311, Loss_clf 0.295, Loss_fe 0.391, Loss_kd 1.476, Train_accy 74.17:  15%|█▌        | 3/20 [02:17<12:01, 42.43s/it]
Task 1, Epoch 4/20 => Loss 2.291, Loss_clf 0.262, Loss_fe 0.369, Loss_kd 1.510, Train_accy 72.63:  15%|█▌        | 3/20 [02:52<12:01, 42.43s/it]
Task 1, Epoch 4/20 => Loss 2.291, Loss_clf 0.262, Loss_fe 0.369, Loss_kd 1.510, Train_accy 72.63:  20%|██        | 4/20 [02:52<10:36, 39.76s/it]
Task 1, Epoch 5/20 => Loss 2.150, Loss_clf 0.243, Loss_fe 0.296, Loss_kd 1.464, Train_accy 72.74:  20%|██        | 4/20 [03:28<10:36, 39.76s/it]
Task 1, Epoch 5/20 => Loss 2.150, Loss_clf 0.243, Loss_fe 0.296, Loss_kd 1.464, Train_accy 72.74:  25%|██▌       | 5/20 [03:28<09:34, 38.28s/it]
Task 1, Epoch 6/20 => Loss 2.118, Loss_clf 0.215, Loss_fe 0.290, Loss_kd 1.466, Train_accy 73.34, Test_accy 92.33:  25%|██▌       | 5/20 [04:34<09:34, 38.28s/it]
Task 1, Epoch 6/20 => Loss 2.118, Loss_clf 0.215, Loss_fe 0.290, Loss_kd 1.466, Train_accy 73.34, Test_accy 92.33:  30%|███       | 6/20 [04:34<11:08, 47.78s/it]
Task 1, Epoch 7/20 => Loss 2.135, Loss_clf 0.230, Loss_fe 0.275, Loss_kd 1.482, Train_accy 75.83:  30%|███       | 6/20 [05:10<11:08, 47.78s/it]                 
Task 1, Epoch 7/20 => Loss 2.135, Loss_clf 0.230, Loss_fe 0.275, Loss_kd 1.482, Train_accy 75.83:  35%|███▌      | 7/20 [05:10<09:30, 43.85s/it]
Task 1, Epoch 8/20 => Loss 2.130, Loss_clf 0.227, Loss_fe 0.268, Loss_kd 1.486, Train_accy 76.17:  35%|███▌      | 7/20 [05:46<09:30, 43.85s/it]
Task 1, Epoch 8/20 => Loss 2.130, Loss_clf 0.227, Loss_fe 0.268, Loss_kd 1.486, Train_accy 76.17:  40%|████      | 8/20 [05:46<08:15, 41.27s/it]
Task 1, Epoch 9/20 => Loss 2.078, Loss_clf 0.200, Loss_fe 0.240, Loss_kd 1.489, Train_accy 77.43:  40%|████      | 8/20 [06:21<08:15, 41.27s/it]
Task 1, Epoch 9/20 => Loss 2.078, Loss_clf 0.200, Loss_fe 0.240, Loss_kd 1.489, Train_accy 77.43:  45%|████▌     | 9/20 [06:21<07:14, 39.52s/it]
Task 1, Epoch 10/20 => Loss 2.052, Loss_clf 0.206, Loss_fe 0.238, Loss_kd 1.462, Train_accy 77.94:  45%|████▌     | 9/20 [06:57<07:14, 39.52s/it]
Task 1, Epoch 10/20 => Loss 2.052, Loss_clf 0.206, Loss_fe 0.238, Loss_kd 1.462, Train_accy 77.94:  50%|█████     | 10/20 [06:57<06:23, 38.34s/it]
Task 1, Epoch 11/20 => Loss 2.033, Loss_clf 0.193, Loss_fe 0.216, Loss_kd 1.477, Train_accy 78.03, Test_accy 93.07:  50%|█████     | 10/20 [08:03<06:23, 38.34s/it]
Task 1, Epoch 11/20 => Loss 2.033, Loss_clf 0.193, Loss_fe 0.216, Loss_kd 1.477, Train_accy 78.03, Test_accy 93.07:  55%|█████▌    | 11/20 [08:03<07:01, 46.86s/it]
Task 1, Epoch 12/20 => Loss 2.028, Loss_clf 0.179, Loss_fe 0.212, Loss_kd 1.488, Train_accy 78.37:  55%|█████▌    | 11/20 [08:39<07:01, 46.86s/it]                 
Task 1, Epoch 12/20 => Loss 2.028, Loss_clf 0.179, Loss_fe 0.212, Loss_kd 1.488, Train_accy 78.37:  60%|██████    | 12/20 [08:39<05:47, 43.47s/it]
Task 1, Epoch 13/20 => Loss 2.027, Loss_clf 0.187, Loss_fe 0.213, Loss_kd 1.480, Train_accy 79.09:  60%|██████    | 12/20 [09:15<05:47, 43.47s/it]
Task 1, Epoch 13/20 => Loss 2.027, Loss_clf 0.187, Loss_fe 0.213, Loss_kd 1.480, Train_accy 79.09:  65%|██████▌   | 13/20 [09:15<04:47, 41.12s/it]
Task 1, Epoch 14/20 => Loss 2.023, Loss_clf 0.182, Loss_fe 0.198, Loss_kd 1.493, Train_accy 78.83:  65%|██████▌   | 13/20 [09:50<04:47, 41.12s/it]
Task 1, Epoch 14/20 => Loss 2.023, Loss_clf 0.182, Loss_fe 0.198, Loss_kd 1.493, Train_accy 78.83:  70%|███████   | 14/20 [09:50<03:56, 39.48s/it]
Task 1, Epoch 15/20 => Loss 1.978, Loss_clf 0.175, Loss_fe 0.180, Loss_kd 1.476, Train_accy 80.37:  70%|███████   | 14/20 [10:26<03:56, 39.48s/it]
Task 1, Epoch 15/20 => Loss 1.978, Loss_clf 0.175, Loss_fe 0.180, Loss_kd 1.476, Train_accy 80.37:  75%|███████▌  | 15/20 [10:26<03:11, 38.36s/it]
Task 1, Epoch 16/20 => Loss 1.949, Loss_clf 0.164, Loss_fe 0.171, Loss_kd 1.467, Train_accy 79.91, Test_accy 93.02:  75%|███████▌  | 15/20 [11:32<03:11, 38.36s/it]
Task 1, Epoch 16/20 => Loss 1.949, Loss_clf 0.164, Loss_fe 0.171, Loss_kd 1.467, Train_accy 79.91, Test_accy 93.02:  80%|████████  | 16/20 [11:32<03:07, 46.76s/it]
Task 1, Epoch 17/20 => Loss 1.959, Loss_clf 0.166, Loss_fe 0.167, Loss_kd 1.479, Train_accy 78.57:  80%|████████  | 16/20 [12:08<03:07, 46.76s/it]                 
Task 1, Epoch 17/20 => Loss 1.959, Loss_clf 0.166, Loss_fe 0.167, Loss_kd 1.479, Train_accy 78.57:  85%|████████▌ | 17/20 [12:08<02:10, 43.45s/it]
Task 1, Epoch 18/20 => Loss 1.929, Loss_clf 0.160, Loss_fe 0.153, Loss_kd 1.470, Train_accy 79.94:  85%|████████▌ | 17/20 [12:44<02:10, 43.45s/it]
Task 1, Epoch 18/20 => Loss 1.929, Loss_clf 0.160, Loss_fe 0.153, Loss_kd 1.470, Train_accy 79.94:  90%|█████████ | 18/20 [12:44<01:22, 41.13s/it]
Task 1, Epoch 19/20 => Loss 1.998, Loss_clf 0.183, Loss_fe 0.180, Loss_kd 1.487, Train_accy 80.14:  90%|█████████ | 18/20 [13:20<01:22, 41.13s/it]
Task 1, Epoch 19/20 => Loss 1.998, Loss_clf 0.183, Loss_fe 0.180, Loss_kd 1.487, Train_accy 80.14:  95%|█████████▌| 19/20 [13:20<00:39, 39.50s/it]
Task 1, Epoch 20/20 => Loss 1.954, Loss_clf 0.163, Loss_fe 0.165, Loss_kd 1.478, Train_accy 81.11:  95%|█████████▌| 19/20 [13:55<00:39, 39.50s/it]
Task 1, Epoch 20/20 => Loss 1.954, Loss_clf 0.163, Loss_fe 0.165, Loss_kd 1.478, Train_accy 81.11: 100%|██████████| 20/20 [13:55<00:00, 38.37s/it]
Task 1, Epoch 20/20 => Loss 1.954, Loss_clf 0.163, Loss_fe 0.165, Loss_kd 1.478, Train_accy 81.11: 100%|██████████| 20/20 [13:55<00:00, 41.79s/it]
2024-09-05 18:29:23,868 [foster.py] => Task 1, Epoch 20/20 => Loss 1.954, Loss_clf 0.163, Loss_fe 0.165, Loss_kd 1.478, Train_accy 81.11
2024-09-05 18:29:23,869 [foster.py] => do not weight align teacher!
2024-09-05 18:29:23,872 [foster.py] => per cls weights : [1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 0.47993148 0.47993148 0.47993148 0.47993148
 0.47993148]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.635,  Train_accy 61.74, Test_accy 92.35:   0%|          | 0/20 [01:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.635,  Train_accy 61.74, Test_accy 92.35:   5%|▌         | 1/20 [01:00<19:14, 60.78s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.399,  Train_accy 68.91:   5%|▌         | 1/20 [01:45<19:14, 60.78s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.399,  Train_accy 68.91:  10%|█         | 2/20 [01:45<15:26, 51.46s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.380,  Train_accy 68.71:  10%|█         | 2/20 [02:30<15:26, 51.46s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.380,  Train_accy 68.71:  15%|█▌        | 3/20 [02:30<13:43, 48.47s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.389,  Train_accy 68.91:  15%|█▌        | 3/20 [03:15<13:43, 48.47s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.389,  Train_accy 68.91:  20%|██        | 4/20 [03:15<12:33, 47.10s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.374,  Train_accy 68.40:  20%|██        | 4/20 [04:00<12:33, 47.10s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.374,  Train_accy 68.40:  25%|██▌       | 5/20 [04:00<11:34, 46.31s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.381,  Train_accy 68.83, Test_accy 92.69:  25%|██▌       | 5/20 [05:01<11:34, 46.31s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.381,  Train_accy 68.83, Test_accy 92.69:  30%|███       | 6/20 [05:01<11:57, 51.26s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.376,  Train_accy 68.49:  30%|███       | 6/20 [05:46<11:57, 51.26s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.376,  Train_accy 68.49:  35%|███▌      | 7/20 [05:46<10:39, 49.20s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.337,  Train_accy 68.51:  35%|███▌      | 7/20 [06:31<10:39, 49.20s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.337,  Train_accy 68.51:  40%|████      | 8/20 [06:31<09:34, 47.84s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.370,  Train_accy 69.49:  40%|████      | 8/20 [07:16<09:34, 47.84s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.370,  Train_accy 69.49:  45%|████▌     | 9/20 [07:16<08:36, 46.97s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.354,  Train_accy 68.60:  45%|████▌     | 9/20 [08:01<08:36, 46.97s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.354,  Train_accy 68.60:  50%|█████     | 10/20 [08:01<07:43, 46.34s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.370,  Train_accy 68.43, Test_accy 92.55:  50%|█████     | 10/20 [09:02<07:43, 46.34s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.370,  Train_accy 68.43, Test_accy 92.55:  55%|█████▌    | 11/20 [09:02<07:37, 50.80s/it]
SNet: Task 1, Epoch 12/20 => Loss 1.377,  Train_accy 68.00:  55%|█████▌    | 11/20 [09:47<07:37, 50.80s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 1.377,  Train_accy 68.00:  60%|██████    | 12/20 [09:47<06:32, 49.04s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.332,  Train_accy 68.71:  60%|██████    | 12/20 [10:32<06:32, 49.04s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.332,  Train_accy 68.71:  65%|██████▌   | 13/20 [10:32<05:34, 47.79s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.376,  Train_accy 68.40:  65%|██████▌   | 13/20 [11:16<05:34, 47.79s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.376,  Train_accy 68.40:  70%|███████   | 14/20 [11:16<04:41, 46.91s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.359,  Train_accy 68.34:  70%|███████   | 14/20 [12:01<04:41, 46.91s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.359,  Train_accy 68.34:  75%|███████▌  | 15/20 [12:01<03:51, 46.30s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.359,  Train_accy 68.40, Test_accy 92.45:  75%|███████▌  | 15/20 [13:02<03:51, 46.30s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.359,  Train_accy 68.40, Test_accy 92.45:  80%|████████  | 16/20 [13:02<03:22, 50.70s/it]
SNet: Task 1, Epoch 17/20 => Loss 1.346,  Train_accy 68.74:  80%|████████  | 16/20 [13:47<03:22, 50.70s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 1.346,  Train_accy 68.74:  85%|████████▌ | 17/20 [13:47<02:26, 48.97s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.376,  Train_accy 69.74:  85%|████████▌ | 17/20 [14:32<02:26, 48.97s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.376,  Train_accy 69.74:  90%|█████████ | 18/20 [14:32<01:35, 47.77s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.374,  Train_accy 68.46:  90%|█████████ | 18/20 [15:17<01:35, 47.77s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.374,  Train_accy 68.46:  95%|█████████▌| 19/20 [15:17<00:46, 46.91s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.362,  Train_accy 69.11:  95%|█████████▌| 19/20 [16:02<00:46, 46.91s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.362,  Train_accy 69.11: 100%|██████████| 20/20 [16:02<00:00, 46.32s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.362,  Train_accy 69.11: 100%|██████████| 20/20 [16:02<00:00, 48.13s/it]
2024-09-05 18:45:27,994 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.362,  Train_accy 69.11
2024-09-05 18:45:27,995 [foster.py] => do not weight align student!
2024-09-05 18:45:43,900 [foster.py] => darknet eval: 
2024-09-05 18:45:43,901 [foster.py] => CNN top1 curve: 92.53
2024-09-05 18:45:43,901 [foster.py] => CNN top5 curve: 99.53
2024-09-05 18:45:43,903 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 18:47:17,704 [foster.py] => Exemplar size: 1100
2024-09-05 18:47:17,704 [trainer.py] => CNN: {'total': 93.15, '00-49': 94.68, '50-54': 77.8, 'old': 94.68, 'new': 77.8}
2024-09-05 18:47:17,705 [trainer.py] => NME: {'total': 93.53, '00-49': 93.46, '50-54': 94.2, 'old': 93.46, 'new': 94.2}
2024-09-05 18:47:17,705 [trainer.py] => CNN top1 curve: [94.9, 93.15]
2024-09-05 18:47:17,705 [trainer.py] => CNN top5 curve: [99.58, 99.51]
2024-09-05 18:47:17,705 [trainer.py] => NME top1 curve: [94.84, 93.53]
2024-09-05 18:47:17,705 [trainer.py] => NME top5 curve: [99.58, 99.58]

Average Accuracy (CNN): 94.02
Average Accuracy (NME): 94.18
2024-09-05 18:47:17,705 [trainer.py] => Average Accuracy (CNN): 94.02
2024-09-05 18:47:17,705 [trainer.py] => Average Accuracy (NME): 94.18
2024-09-05 18:47:17,706 [trainer.py] => All params: 171762592
2024-09-05 18:47:17,707 [trainer.py] => Trainable params: 85925486
2024-09-05 18:47:19,309 [foster.py] => Learning on 55-60
2024-09-05 18:47:19,311 [foster.py] => All params: 171777967
2024-09-05 18:47:19,312 [foster.py] => Trainable params: 85937016
2024-09-05 18:47:19,393 [foster.py] => per cls weights : [1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 0.57933658 0.57933658 0.57933658 0.57933658 0.57933658]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 4.521, Loss_clf 0.771, Loss_fe 1.728, Loss_kd 1.853, Train_accy 74.33, Test_accy 92.43:   0%|          | 0/20 [01:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 4.521, Loss_clf 0.771, Loss_fe 1.728, Loss_kd 1.853, Train_accy 74.33, Test_accy 92.43:   5%|▌         | 1/20 [01:09<22:08, 69.94s/it]
Task 2, Epoch 2/20 => Loss 3.094, Loss_clf 0.417, Loss_fe 0.659, Loss_kd 1.851, Train_accy 79.86:   5%|▌         | 1/20 [01:46<22:08, 69.94s/it]                 
Task 2, Epoch 2/20 => Loss 3.094, Loss_clf 0.417, Loss_fe 0.659, Loss_kd 1.851, Train_accy 79.86:  10%|█         | 2/20 [01:46<15:07, 50.41s/it]
Task 2, Epoch 3/20 => Loss 2.923, Loss_clf 0.384, Loss_fe 0.514, Loss_kd 1.856, Train_accy 79.06:  10%|█         | 2/20 [02:23<15:07, 50.41s/it]
Task 2, Epoch 3/20 => Loss 2.923, Loss_clf 0.384, Loss_fe 0.514, Loss_kd 1.856, Train_accy 79.06:  15%|█▌        | 3/20 [02:23<12:30, 44.16s/it]
Task 2, Epoch 4/20 => Loss 2.777, Loss_clf 0.340, Loss_fe 0.428, Loss_kd 1.841, Train_accy 80.81:  15%|█▌        | 3/20 [03:00<12:30, 44.16s/it]
Task 2, Epoch 4/20 => Loss 2.777, Loss_clf 0.340, Loss_fe 0.428, Loss_kd 1.841, Train_accy 80.81:  20%|██        | 4/20 [03:00<11:00, 41.25s/it]
Task 2, Epoch 5/20 => Loss 2.631, Loss_clf 0.273, Loss_fe 0.362, Loss_kd 1.829, Train_accy 82.47:  20%|██        | 4/20 [03:36<11:00, 41.25s/it]
Task 2, Epoch 5/20 => Loss 2.631, Loss_clf 0.273, Loss_fe 0.362, Loss_kd 1.829, Train_accy 82.47:  25%|██▌       | 5/20 [03:36<09:54, 39.62s/it]
Task 2, Epoch 6/20 => Loss 2.669, Loss_clf 0.303, Loss_fe 0.362, Loss_kd 1.837, Train_accy 82.39, Test_accy 93.18:  25%|██▌       | 5/20 [04:47<09:54, 39.62s/it]
Task 2, Epoch 6/20 => Loss 2.669, Loss_clf 0.303, Loss_fe 0.362, Loss_kd 1.837, Train_accy 82.39, Test_accy 93.18:  30%|███       | 6/20 [04:47<11:40, 50.01s/it]
Task 2, Epoch 7/20 => Loss 2.605, Loss_clf 0.266, Loss_fe 0.322, Loss_kd 1.849, Train_accy 84.42:  30%|███       | 6/20 [05:23<11:40, 50.01s/it]                 
Task 2, Epoch 7/20 => Loss 2.605, Loss_clf 0.266, Loss_fe 0.322, Loss_kd 1.849, Train_accy 84.42:  35%|███▌      | 7/20 [05:23<09:54, 45.70s/it]
Task 2, Epoch 8/20 => Loss 2.579, Loss_clf 0.280, Loss_fe 0.322, Loss_kd 1.813, Train_accy 83.78:  35%|███▌      | 7/20 [06:00<09:54, 45.70s/it]
Task 2, Epoch 8/20 => Loss 2.579, Loss_clf 0.280, Loss_fe 0.322, Loss_kd 1.813, Train_accy 83.78:  40%|████      | 8/20 [06:00<08:34, 42.85s/it]
Task 2, Epoch 9/20 => Loss 2.618, Loss_clf 0.281, Loss_fe 0.322, Loss_kd 1.847, Train_accy 82.75:  40%|████      | 8/20 [06:37<08:34, 42.85s/it]
Task 2, Epoch 9/20 => Loss 2.618, Loss_clf 0.281, Loss_fe 0.322, Loss_kd 1.847, Train_accy 82.75:  45%|████▌     | 9/20 [06:37<07:30, 40.95s/it]
Task 2, Epoch 10/20 => Loss 2.495, Loss_clf 0.249, Loss_fe 0.273, Loss_kd 1.808, Train_accy 84.42:  45%|████▌     | 9/20 [07:14<07:30, 40.95s/it]
Task 2, Epoch 10/20 => Loss 2.495, Loss_clf 0.249, Loss_fe 0.273, Loss_kd 1.808, Train_accy 84.42:  50%|█████     | 10/20 [07:14<06:36, 39.66s/it]
Task 2, Epoch 11/20 => Loss 2.465, Loss_clf 0.225, Loss_fe 0.257, Loss_kd 1.818, Train_accy 85.50, Test_accy 93.07:  50%|█████     | 10/20 [08:24<06:36, 39.66s/it]
Task 2, Epoch 11/20 => Loss 2.465, Loss_clf 0.225, Loss_fe 0.257, Loss_kd 1.818, Train_accy 85.50, Test_accy 93.07:  55%|█████▌    | 11/20 [08:24<07:21, 49.00s/it]
Task 2, Epoch 12/20 => Loss 2.506, Loss_clf 0.237, Loss_fe 0.269, Loss_kd 1.834, Train_accy 85.86:  55%|█████▌    | 11/20 [09:01<07:21, 49.00s/it]                 
Task 2, Epoch 12/20 => Loss 2.506, Loss_clf 0.237, Loss_fe 0.269, Loss_kd 1.834, Train_accy 85.86:  60%|██████    | 12/20 [09:01<06:02, 45.31s/it]
Task 2, Epoch 13/20 => Loss 2.493, Loss_clf 0.240, Loss_fe 0.249, Loss_kd 1.837, Train_accy 84.50:  60%|██████    | 12/20 [09:38<06:02, 45.31s/it]
Task 2, Epoch 13/20 => Loss 2.493, Loss_clf 0.240, Loss_fe 0.249, Loss_kd 1.837, Train_accy 84.50:  65%|██████▌   | 13/20 [09:38<04:59, 42.72s/it]
Task 2, Epoch 14/20 => Loss 2.510, Loss_clf 0.246, Loss_fe 0.257, Loss_kd 1.840, Train_accy 85.11:  65%|██████▌   | 13/20 [10:14<04:59, 42.72s/it]
Task 2, Epoch 14/20 => Loss 2.510, Loss_clf 0.246, Loss_fe 0.257, Loss_kd 1.840, Train_accy 85.11:  70%|███████   | 14/20 [10:14<04:05, 40.94s/it]
Task 2, Epoch 15/20 => Loss 2.449, Loss_clf 0.225, Loss_fe 0.224, Loss_kd 1.833, Train_accy 86.67:  70%|███████   | 14/20 [10:51<04:05, 40.94s/it]
Task 2, Epoch 15/20 => Loss 2.449, Loss_clf 0.225, Loss_fe 0.224, Loss_kd 1.833, Train_accy 86.67:  75%|███████▌  | 15/20 [10:51<03:18, 39.69s/it]
Task 2, Epoch 16/20 => Loss 2.474, Loss_clf 0.224, Loss_fe 0.233, Loss_kd 1.848, Train_accy 86.64, Test_accy 93.32:  75%|███████▌  | 15/20 [12:01<03:18, 39.69s/it]
Task 2, Epoch 16/20 => Loss 2.474, Loss_clf 0.224, Loss_fe 0.233, Loss_kd 1.848, Train_accy 86.64, Test_accy 93.32:  80%|████████  | 16/20 [12:01<03:15, 48.88s/it]
Task 2, Epoch 17/20 => Loss 2.401, Loss_clf 0.200, Loss_fe 0.204, Loss_kd 1.830, Train_accy 86.39:  80%|████████  | 16/20 [12:38<03:15, 48.88s/it]                 
Task 2, Epoch 17/20 => Loss 2.401, Loss_clf 0.200, Loss_fe 0.204, Loss_kd 1.830, Train_accy 86.39:  85%|████████▌ | 17/20 [12:38<02:15, 45.24s/it]
Task 2, Epoch 18/20 => Loss 2.418, Loss_clf 0.214, Loss_fe 0.212, Loss_kd 1.826, Train_accy 86.86:  85%|████████▌ | 17/20 [13:15<02:15, 45.24s/it]
Task 2, Epoch 18/20 => Loss 2.418, Loss_clf 0.214, Loss_fe 0.212, Loss_kd 1.826, Train_accy 86.86:  90%|█████████ | 18/20 [13:15<01:25, 42.71s/it]
Task 2, Epoch 19/20 => Loss 2.436, Loss_clf 0.211, Loss_fe 0.219, Loss_kd 1.839, Train_accy 86.81:  90%|█████████ | 18/20 [13:52<01:25, 42.71s/it]
Task 2, Epoch 19/20 => Loss 2.436, Loss_clf 0.211, Loss_fe 0.219, Loss_kd 1.839, Train_accy 86.81:  95%|█████████▌| 19/20 [13:52<00:40, 40.93s/it]
Task 2, Epoch 20/20 => Loss 2.489, Loss_clf 0.233, Loss_fe 0.233, Loss_kd 1.854, Train_accy 86.89:  95%|█████████▌| 19/20 [14:29<00:40, 40.93s/it]
Task 2, Epoch 20/20 => Loss 2.489, Loss_clf 0.233, Loss_fe 0.233, Loss_kd 1.854, Train_accy 86.89: 100%|██████████| 20/20 [14:29<00:00, 39.70s/it]
Task 2, Epoch 20/20 => Loss 2.489, Loss_clf 0.233, Loss_fe 0.233, Loss_kd 1.854, Train_accy 86.89: 100%|██████████| 20/20 [14:29<00:00, 43.46s/it]
2024-09-05 19:01:48,502 [foster.py] => Task 2, Epoch 20/20 => Loss 2.489, Loss_clf 0.233, Loss_fe 0.233, Loss_kd 1.854, Train_accy 86.89
2024-09-05 19:01:48,503 [foster.py] => do not weight align teacher!
2024-09-05 19:01:48,506 [foster.py] => per cls weights : [1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 0.47786048 0.47786048 0.47786048 0.47786048 0.47786048]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.578,  Train_accy 69.25, Test_accy 93.07:   0%|          | 0/20 [01:03<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.578,  Train_accy 69.25, Test_accy 93.07:   5%|▌         | 1/20 [01:03<20:07, 63.56s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.303,  Train_accy 77.22:   5%|▌         | 1/20 [01:49<20:07, 63.56s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.303,  Train_accy 77.22:  10%|█         | 2/20 [01:49<16:00, 53.39s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.290,  Train_accy 78.42:  10%|█         | 2/20 [02:36<16:00, 53.39s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.290,  Train_accy 78.42:  15%|█▌        | 3/20 [02:36<14:12, 50.15s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.292,  Train_accy 78.89:  15%|█▌        | 3/20 [03:22<14:12, 50.15s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.292,  Train_accy 78.89:  20%|██        | 4/20 [03:22<12:58, 48.63s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.304,  Train_accy 77.75:  20%|██        | 4/20 [04:08<12:58, 48.63s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.304,  Train_accy 77.75:  25%|██▌       | 5/20 [04:08<11:56, 47.79s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.299,  Train_accy 78.92, Test_accy 92.92:  25%|██▌       | 5/20 [05:12<11:56, 47.79s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.299,  Train_accy 78.92, Test_accy 92.92:  30%|███       | 6/20 [05:12<12:24, 53.21s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.289,  Train_accy 78.19:  30%|███       | 6/20 [05:58<12:24, 53.21s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.289,  Train_accy 78.19:  35%|███▌      | 7/20 [05:58<11:02, 50.97s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.279,  Train_accy 79.64:  35%|███▌      | 7/20 [06:45<11:02, 50.97s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.279,  Train_accy 79.64:  40%|████      | 8/20 [06:45<09:54, 49.50s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.273,  Train_accy 79.72:  40%|████      | 8/20 [07:31<09:54, 49.50s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.273,  Train_accy 79.72:  45%|████▌     | 9/20 [07:31<08:53, 48.49s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.262,  Train_accy 78.89:  45%|████▌     | 9/20 [08:17<08:53, 48.49s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.262,  Train_accy 78.89:  50%|█████     | 10/20 [08:17<07:58, 47.84s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.306,  Train_accy 78.31, Test_accy 92.90:  50%|█████     | 10/20 [09:21<07:58, 47.84s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.306,  Train_accy 78.31, Test_accy 92.90:  55%|█████▌    | 11/20 [09:21<07:54, 52.70s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.285,  Train_accy 78.94:  55%|█████▌    | 11/20 [10:08<07:54, 52.70s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.285,  Train_accy 78.94:  60%|██████    | 12/20 [10:08<06:46, 50.86s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.296,  Train_accy 78.58:  60%|██████    | 12/20 [10:54<06:46, 50.86s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.296,  Train_accy 78.58:  65%|██████▌   | 13/20 [10:54<05:46, 49.55s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.286,  Train_accy 79.61:  65%|██████▌   | 13/20 [11:41<05:46, 49.55s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.286,  Train_accy 79.61:  70%|███████   | 14/20 [11:41<04:51, 48.62s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.303,  Train_accy 79.22:  70%|███████   | 14/20 [12:27<04:51, 48.62s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.303,  Train_accy 79.22:  75%|███████▌  | 15/20 [12:27<03:59, 47.94s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.246,  Train_accy 79.94, Test_accy 93.03:  75%|███████▌  | 15/20 [13:31<03:59, 47.94s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.246,  Train_accy 79.94, Test_accy 93.03:  80%|████████  | 16/20 [13:31<03:30, 52.72s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.273,  Train_accy 78.81:  80%|████████  | 16/20 [14:17<03:30, 52.72s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.273,  Train_accy 78.81:  85%|████████▌ | 17/20 [14:17<02:32, 50.80s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.264,  Train_accy 79.31:  85%|████████▌ | 17/20 [15:04<02:32, 50.80s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.264,  Train_accy 79.31:  90%|█████████ | 18/20 [15:04<01:38, 49.48s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.249,  Train_accy 79.78:  90%|█████████ | 18/20 [15:50<01:38, 49.48s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.249,  Train_accy 79.78:  95%|█████████▌| 19/20 [15:50<00:48, 48.55s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.269,  Train_accy 79.75:  95%|█████████▌| 19/20 [16:36<00:48, 48.55s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.269,  Train_accy 79.75: 100%|██████████| 20/20 [16:36<00:00, 47.90s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.269,  Train_accy 79.75: 100%|██████████| 20/20 [16:36<00:00, 49.84s/it]
2024-09-05 19:18:26,940 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.269,  Train_accy 79.75
2024-09-05 19:18:26,941 [foster.py] => do not weight align student!
2024-09-05 19:18:44,350 [foster.py] => darknet eval: 
2024-09-05 19:18:44,351 [foster.py] => CNN top1 curve: 93.02
2024-09-05 19:18:44,351 [foster.py] => CNN top5 curve: 99.53
2024-09-05 19:18:44,353 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 19:20:26,909 [foster.py] => Exemplar size: 1200
2024-09-05 19:20:26,909 [trainer.py] => CNN: {'total': 93.27, '00-49': 94.56, '50-54': 84.4, '55-59': 89.2, 'old': 93.64, 'new': 89.2}
2024-09-05 19:20:26,909 [trainer.py] => NME: {'total': 93.5, '00-49': 93.72, '50-54': 90.4, '55-59': 94.4, 'old': 93.42, 'new': 94.4}
2024-09-05 19:20:26,909 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27]
2024-09-05 19:20:26,910 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43]
2024-09-05 19:20:26,910 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5]
2024-09-05 19:20:26,910 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5]

Average Accuracy (CNN): 93.77
Average Accuracy (NME): 93.96
2024-09-05 19:20:26,910 [trainer.py] => Average Accuracy (CNN): 93.77
2024-09-05 19:20:26,910 [trainer.py] => Average Accuracy (NME): 93.96
2024-09-05 19:20:26,911 [trainer.py] => All params: 171777967
2024-09-05 19:20:26,912 [trainer.py] => Trainable params: 85937016
2024-09-05 19:20:28,453 [foster.py] => Learning on 60-65
2024-09-05 19:20:28,455 [foster.py] => All params: 171793342
2024-09-05 19:20:28,456 [foster.py] => Trainable params: 85948546
2024-09-05 19:20:28,539 [foster.py] => per cls weights : [1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 0.57763734 0.57763734 0.57763734 0.57763734 0.57763734]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.233, Loss_clf 0.698, Loss_fe 1.780, Loss_kd 1.620, Train_accy 72.08, Test_accy 90.75:   0%|          | 0/20 [01:13<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.233, Loss_clf 0.698, Loss_fe 1.780, Loss_kd 1.620, Train_accy 72.08, Test_accy 90.75:   5%|▌         | 1/20 [01:13<23:23, 73.88s/it]
Task 3, Epoch 2/20 => Loss 2.785, Loss_clf 0.358, Loss_fe 0.685, Loss_kd 1.608, Train_accy 73.76:   5%|▌         | 1/20 [01:51<23:23, 73.88s/it]                 
Task 3, Epoch 2/20 => Loss 2.785, Loss_clf 0.358, Loss_fe 0.685, Loss_kd 1.608, Train_accy 73.76:  10%|█         | 2/20 [01:51<15:47, 52.66s/it]
Task 3, Epoch 3/20 => Loss 2.490, Loss_clf 0.303, Loss_fe 0.462, Loss_kd 1.593, Train_accy 73.22:  10%|█         | 2/20 [02:29<15:47, 52.66s/it]
Task 3, Epoch 3/20 => Loss 2.490, Loss_clf 0.303, Loss_fe 0.462, Loss_kd 1.593, Train_accy 73.22:  15%|█▌        | 3/20 [02:29<13:00, 45.89s/it]
Task 3, Epoch 4/20 => Loss 2.482, Loss_clf 0.296, Loss_fe 0.419, Loss_kd 1.631, Train_accy 73.43:  15%|█▌        | 3/20 [03:07<13:00, 45.89s/it]
Task 3, Epoch 4/20 => Loss 2.482, Loss_clf 0.296, Loss_fe 0.419, Loss_kd 1.631, Train_accy 73.43:  20%|██        | 4/20 [03:07<11:23, 42.71s/it]
Task 3, Epoch 5/20 => Loss 2.438, Loss_clf 0.290, Loss_fe 0.379, Loss_kd 1.632, Train_accy 72.76:  20%|██        | 4/20 [03:45<11:23, 42.71s/it]
Task 3, Epoch 5/20 => Loss 2.438, Loss_clf 0.290, Loss_fe 0.379, Loss_kd 1.632, Train_accy 72.76:  25%|██▌       | 5/20 [03:45<10:14, 40.99s/it]
Task 3, Epoch 6/20 => Loss 2.297, Loss_clf 0.254, Loss_fe 0.323, Loss_kd 1.588, Train_accy 75.38, Test_accy 91.06:  25%|██▌       | 5/20 [04:59<10:14, 40.99s/it]
Task 3, Epoch 6/20 => Loss 2.297, Loss_clf 0.254, Loss_fe 0.323, Loss_kd 1.588, Train_accy 75.38, Test_accy 91.06:  30%|███       | 6/20 [04:59<12:11, 52.23s/it]
Task 3, Epoch 7/20 => Loss 2.293, Loss_clf 0.257, Loss_fe 0.311, Loss_kd 1.592, Train_accy 75.54:  30%|███       | 6/20 [05:37<12:11, 52.23s/it]                 
Task 3, Epoch 7/20 => Loss 2.293, Loss_clf 0.257, Loss_fe 0.311, Loss_kd 1.592, Train_accy 75.54:  35%|███▌      | 7/20 [05:37<10:18, 47.54s/it]
Task 3, Epoch 8/20 => Loss 2.318, Loss_clf 0.249, Loss_fe 0.300, Loss_kd 1.633, Train_accy 76.68:  35%|███▌      | 7/20 [06:15<10:18, 47.54s/it]
Task 3, Epoch 8/20 => Loss 2.318, Loss_clf 0.249, Loss_fe 0.300, Loss_kd 1.633, Train_accy 76.68:  40%|████      | 8/20 [06:15<08:53, 44.45s/it]
Task 3, Epoch 9/20 => Loss 2.193, Loss_clf 0.211, Loss_fe 0.255, Loss_kd 1.594, Train_accy 77.32:  40%|████      | 8/20 [06:53<08:53, 44.45s/it]
Task 3, Epoch 9/20 => Loss 2.193, Loss_clf 0.211, Loss_fe 0.255, Loss_kd 1.594, Train_accy 77.32:  45%|████▌     | 9/20 [06:53<07:46, 42.42s/it]
Task 3, Epoch 10/20 => Loss 2.280, Loss_clf 0.251, Loss_fe 0.281, Loss_kd 1.613, Train_accy 77.24:  45%|████▌     | 9/20 [07:30<07:46, 42.42s/it]
Task 3, Epoch 10/20 => Loss 2.280, Loss_clf 0.251, Loss_fe 0.281, Loss_kd 1.613, Train_accy 77.24:  50%|█████     | 10/20 [07:30<06:50, 41.04s/it]
Task 3, Epoch 11/20 => Loss 2.189, Loss_clf 0.217, Loss_fe 0.263, Loss_kd 1.579, Train_accy 76.92, Test_accy 91.46:  50%|█████     | 10/20 [08:44<06:50, 41.04s/it]
Task 3, Epoch 11/20 => Loss 2.189, Loss_clf 0.217, Loss_fe 0.263, Loss_kd 1.579, Train_accy 76.92, Test_accy 91.46:  55%|█████▌    | 11/20 [08:44<07:40, 51.12s/it]
Task 3, Epoch 12/20 => Loss 2.161, Loss_clf 0.202, Loss_fe 0.229, Loss_kd 1.597, Train_accy 79.27:  55%|█████▌    | 11/20 [09:22<07:40, 51.12s/it]                 
Task 3, Epoch 12/20 => Loss 2.161, Loss_clf 0.202, Loss_fe 0.229, Loss_kd 1.597, Train_accy 79.27:  60%|██████    | 12/20 [09:22<06:16, 47.07s/it]
Task 3, Epoch 13/20 => Loss 2.178, Loss_clf 0.215, Loss_fe 0.234, Loss_kd 1.595, Train_accy 78.43:  60%|██████    | 12/20 [10:00<06:16, 47.07s/it]
Task 3, Epoch 13/20 => Loss 2.178, Loss_clf 0.215, Loss_fe 0.234, Loss_kd 1.595, Train_accy 78.43:  65%|██████▌   | 13/20 [10:00<05:09, 44.28s/it]
Task 3, Epoch 14/20 => Loss 2.166, Loss_clf 0.209, Loss_fe 0.227, Loss_kd 1.597, Train_accy 77.76:  65%|██████▌   | 13/20 [10:38<05:09, 44.28s/it]
Task 3, Epoch 14/20 => Loss 2.166, Loss_clf 0.209, Loss_fe 0.227, Loss_kd 1.597, Train_accy 77.76:  70%|███████   | 14/20 [10:38<04:14, 42.34s/it]
Task 3, Epoch 15/20 => Loss 2.102, Loss_clf 0.191, Loss_fe 0.189, Loss_kd 1.589, Train_accy 78.51:  70%|███████   | 14/20 [11:16<04:14, 42.34s/it]
Task 3, Epoch 15/20 => Loss 2.102, Loss_clf 0.191, Loss_fe 0.189, Loss_kd 1.589, Train_accy 78.51:  75%|███████▌  | 15/20 [11:16<03:24, 40.98s/it]
Task 3, Epoch 16/20 => Loss 2.149, Loss_clf 0.204, Loss_fe 0.201, Loss_kd 1.609, Train_accy 78.95, Test_accy 91.74:  75%|███████▌  | 15/20 [12:30<03:24, 40.98s/it]
Task 3, Epoch 16/20 => Loss 2.149, Loss_clf 0.204, Loss_fe 0.201, Loss_kd 1.609, Train_accy 78.95, Test_accy 91.74:  80%|████████  | 16/20 [12:30<03:23, 50.93s/it]
Task 3, Epoch 17/20 => Loss 2.099, Loss_clf 0.190, Loss_fe 0.188, Loss_kd 1.588, Train_accy 80.27:  80%|████████  | 16/20 [13:08<03:23, 50.93s/it]                 
Task 3, Epoch 17/20 => Loss 2.099, Loss_clf 0.190, Loss_fe 0.188, Loss_kd 1.588, Train_accy 80.27:  85%|████████▌ | 17/20 [13:08<02:20, 46.99s/it]
Task 3, Epoch 18/20 => Loss 2.105, Loss_clf 0.192, Loss_fe 0.185, Loss_kd 1.596, Train_accy 80.97:  85%|████████▌ | 17/20 [13:46<02:20, 46.99s/it]
Task 3, Epoch 18/20 => Loss 2.105, Loss_clf 0.192, Loss_fe 0.185, Loss_kd 1.596, Train_accy 80.97:  90%|█████████ | 18/20 [13:46<01:28, 44.25s/it]
Task 3, Epoch 19/20 => Loss 2.076, Loss_clf 0.179, Loss_fe 0.179, Loss_kd 1.586, Train_accy 79.92:  90%|█████████ | 18/20 [14:23<01:28, 44.25s/it]
Task 3, Epoch 19/20 => Loss 2.076, Loss_clf 0.179, Loss_fe 0.179, Loss_kd 1.586, Train_accy 79.92:  95%|█████████▌| 19/20 [14:23<00:42, 42.35s/it]
Task 3, Epoch 20/20 => Loss 2.103, Loss_clf 0.191, Loss_fe 0.180, Loss_kd 1.599, Train_accy 80.16:  95%|█████████▌| 19/20 [15:01<00:42, 42.35s/it]
Task 3, Epoch 20/20 => Loss 2.103, Loss_clf 0.191, Loss_fe 0.180, Loss_kd 1.599, Train_accy 80.16: 100%|██████████| 20/20 [15:01<00:00, 41.02s/it]
Task 3, Epoch 20/20 => Loss 2.103, Loss_clf 0.191, Loss_fe 0.180, Loss_kd 1.599, Train_accy 80.16: 100%|██████████| 20/20 [15:01<00:00, 45.09s/it]
2024-09-05 19:35:30,399 [foster.py] => Task 3, Epoch 20/20 => Loss 2.103, Loss_clf 0.191, Loss_fe 0.180, Loss_kd 1.599, Train_accy 80.16
2024-09-05 19:35:30,399 [foster.py] => do not weight align teacher!
2024-09-05 19:35:30,400 [foster.py] => per cls weights : [1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 0.476122  0.476122  0.476122
 0.476122  0.476122 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.626,  Train_accy 62.95, Test_accy 91.22:   0%|          | 0/20 [01:06<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.626,  Train_accy 62.95, Test_accy 91.22:   5%|▌         | 1/20 [01:06<21:03, 66.47s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.404,  Train_accy 68.03:   5%|▌         | 1/20 [01:54<21:03, 66.47s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.404,  Train_accy 68.03:  10%|█         | 2/20 [01:54<16:36, 55.36s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.365,  Train_accy 68.11:  10%|█         | 2/20 [02:41<16:36, 55.36s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.365,  Train_accy 68.11:  15%|█▌        | 3/20 [02:41<14:41, 51.83s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.392,  Train_accy 69.14:  15%|█▌        | 3/20 [03:29<14:41, 51.83s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.392,  Train_accy 69.14:  20%|██        | 4/20 [03:29<13:22, 50.18s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.382,  Train_accy 68.89:  20%|██        | 4/20 [04:17<13:22, 50.18s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.382,  Train_accy 68.89:  25%|██▌       | 5/20 [04:17<12:19, 49.27s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.371,  Train_accy 69.24, Test_accy 90.83:  25%|██▌       | 5/20 [05:23<12:19, 49.27s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.371,  Train_accy 69.24, Test_accy 90.83:  30%|███       | 6/20 [05:23<12:51, 55.10s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.356,  Train_accy 68.41:  30%|███       | 6/20 [06:11<12:51, 55.10s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.356,  Train_accy 68.41:  35%|███▌      | 7/20 [06:11<11:24, 52.65s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.354,  Train_accy 69.03:  35%|███▌      | 7/20 [06:58<11:24, 52.65s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.354,  Train_accy 69.03:  40%|████      | 8/20 [06:58<10:12, 51.05s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.396,  Train_accy 69.35:  40%|████      | 8/20 [07:46<10:12, 51.05s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.396,  Train_accy 69.35:  45%|████▌     | 9/20 [07:46<09:10, 50.00s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.361,  Train_accy 69.35:  45%|████▌     | 9/20 [08:33<09:10, 50.00s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.361,  Train_accy 69.35:  50%|█████     | 10/20 [08:33<08:12, 49.26s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.356,  Train_accy 69.65, Test_accy 90.95:  50%|█████     | 10/20 [09:40<08:12, 49.26s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.356,  Train_accy 69.65, Test_accy 90.95:  55%|█████▌    | 11/20 [09:40<08:10, 54.52s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.369,  Train_accy 68.03:  55%|█████▌    | 11/20 [10:28<08:10, 54.52s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.369,  Train_accy 68.03:  60%|██████    | 12/20 [10:28<06:59, 52.42s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.358,  Train_accy 69.59:  60%|██████    | 12/20 [11:15<06:59, 52.42s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.358,  Train_accy 69.59:  65%|██████▌   | 13/20 [11:15<05:56, 51.00s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.372,  Train_accy 69.62:  65%|██████▌   | 13/20 [12:03<05:56, 51.00s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.372,  Train_accy 69.62:  70%|███████   | 14/20 [12:03<04:59, 49.97s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.362,  Train_accy 69.35:  70%|███████   | 14/20 [12:50<04:59, 49.97s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.362,  Train_accy 69.35:  75%|███████▌  | 15/20 [12:50<04:06, 49.26s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.370,  Train_accy 68.73, Test_accy 90.98:  75%|███████▌  | 15/20 [13:57<04:06, 49.26s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.370,  Train_accy 68.73, Test_accy 90.98:  80%|████████  | 16/20 [13:57<03:37, 54.46s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.349,  Train_accy 69.89:  80%|████████  | 16/20 [14:45<03:37, 54.46s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.349,  Train_accy 69.89:  85%|████████▌ | 17/20 [14:45<02:37, 52.41s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.376,  Train_accy 69.30:  85%|████████▌ | 17/20 [15:32<02:37, 52.41s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.376,  Train_accy 69.30:  90%|█████████ | 18/20 [15:32<01:41, 50.95s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.371,  Train_accy 68.57:  90%|█████████ | 18/20 [16:20<01:41, 50.95s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.371,  Train_accy 68.57:  95%|█████████▌| 19/20 [16:20<00:49, 49.94s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.375,  Train_accy 68.70:  95%|█████████▌| 19/20 [17:07<00:49, 49.94s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.375,  Train_accy 68.70: 100%|██████████| 20/20 [17:07<00:00, 49.24s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.375,  Train_accy 68.70: 100%|██████████| 20/20 [17:07<00:00, 51.39s/it]
2024-09-05 19:52:39,827 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.375,  Train_accy 68.70
2024-09-05 19:52:39,828 [foster.py] => do not weight align student!
2024-09-05 19:52:58,658 [foster.py] => darknet eval: 
2024-09-05 19:52:58,658 [foster.py] => CNN top1 curve: 90.97
2024-09-05 19:52:58,659 [foster.py] => CNN top5 curve: 99.37
2024-09-05 19:52:58,661 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 19:54:49,526 [foster.py] => Exemplar size: 1300
2024-09-05 19:54:49,526 [trainer.py] => CNN: {'total': 91.77, '00-49': 94.1, '50-54': 88.8, '55-59': 90.6, '60-64': 72.6, 'old': 93.37, 'new': 72.6}
2024-09-05 19:54:49,527 [trainer.py] => NME: {'total': 92.66, '00-49': 93.56, '50-54': 90.4, '55-59': 82.2, '60-64': 96.4, 'old': 92.35, 'new': 96.4}
2024-09-05 19:54:49,527 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77]
2024-09-05 19:54:49,527 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31]
2024-09-05 19:54:49,527 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66]
2024-09-05 19:54:49,527 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42]

Average Accuracy (CNN): 93.27
Average Accuracy (NME): 93.63
2024-09-05 19:54:49,527 [trainer.py] => Average Accuracy (CNN): 93.27
2024-09-05 19:54:49,527 [trainer.py] => Average Accuracy (NME): 93.63
2024-09-05 19:54:49,528 [trainer.py] => All params: 171793342
2024-09-05 19:54:49,529 [trainer.py] => Trainable params: 85948546
2024-09-05 19:54:51,009 [foster.py] => Learning on 65-70
2024-09-05 19:54:51,010 [foster.py] => All params: 171808717
2024-09-05 19:54:51,011 [foster.py] => Trainable params: 85960076
2024-09-05 19:54:51,091 [foster.py] => per cls weights : [1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 0.57618877
 0.57618877 0.57618877 0.57618877 0.57618877]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.255, Loss_clf 0.679, Loss_fe 1.832, Loss_kd 1.619, Train_accy 71.68, Test_accy 90.66:   0%|          | 0/20 [01:17<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.255, Loss_clf 0.679, Loss_fe 1.832, Loss_kd 1.619, Train_accy 71.68, Test_accy 90.66:   5%|▌         | 1/20 [01:17<24:32, 77.48s/it]
Task 4, Epoch 2/20 => Loss 2.812, Loss_clf 0.310, Loss_fe 0.762, Loss_kd 1.616, Train_accy 75.34:   5%|▌         | 1/20 [01:56<24:32, 77.48s/it]                 
Task 4, Epoch 2/20 => Loss 2.812, Loss_clf 0.310, Loss_fe 0.762, Loss_kd 1.616, Train_accy 75.34:  10%|█         | 2/20 [01:56<16:25, 54.73s/it]
Task 4, Epoch 3/20 => Loss 2.403, Loss_clf 0.262, Loss_fe 0.402, Loss_kd 1.614, Train_accy 77.03:  10%|█         | 2/20 [02:35<16:25, 54.73s/it]
Task 4, Epoch 3/20 => Loss 2.403, Loss_clf 0.262, Loss_fe 0.402, Loss_kd 1.614, Train_accy 77.03:  15%|█▌        | 3/20 [02:35<13:26, 47.44s/it]
Task 4, Epoch 4/20 => Loss 2.442, Loss_clf 0.274, Loss_fe 0.393, Loss_kd 1.648, Train_accy 78.50:  15%|█▌        | 3/20 [03:13<13:26, 47.44s/it]
Task 4, Epoch 4/20 => Loss 2.442, Loss_clf 0.274, Loss_fe 0.393, Loss_kd 1.648, Train_accy 78.50:  20%|██        | 4/20 [03:13<11:44, 44.05s/it]
Task 4, Epoch 5/20 => Loss 2.339, Loss_clf 0.257, Loss_fe 0.334, Loss_kd 1.623, Train_accy 78.76:  20%|██        | 4/20 [03:52<11:44, 44.05s/it]
Task 4, Epoch 5/20 => Loss 2.339, Loss_clf 0.257, Loss_fe 0.334, Loss_kd 1.623, Train_accy 78.76:  25%|██▌       | 5/20 [03:52<10:32, 42.16s/it]
Task 4, Epoch 6/20 => Loss 2.255, Loss_clf 0.229, Loss_fe 0.295, Loss_kd 1.607, Train_accy 79.42, Test_accy 91.84:  25%|██▌       | 5/20 [05:10<10:32, 42.16s/it]
Task 4, Epoch 6/20 => Loss 2.255, Loss_clf 0.229, Loss_fe 0.295, Loss_kd 1.607, Train_accy 79.42, Test_accy 91.84:  30%|███       | 6/20 [05:10<12:39, 54.23s/it]
Task 4, Epoch 7/20 => Loss 2.241, Loss_clf 0.226, Loss_fe 0.285, Loss_kd 1.606, Train_accy 79.61:  30%|███       | 6/20 [05:49<12:39, 54.23s/it]                 
Task 4, Epoch 7/20 => Loss 2.241, Loss_clf 0.226, Loss_fe 0.285, Loss_kd 1.606, Train_accy 79.61:  35%|███▌      | 7/20 [05:49<10:39, 49.19s/it]
Task 4, Epoch 8/20 => Loss 2.334, Loss_clf 0.255, Loss_fe 0.304, Loss_kd 1.647, Train_accy 80.16:  35%|███▌      | 7/20 [06:28<10:39, 49.19s/it]
Task 4, Epoch 8/20 => Loss 2.334, Loss_clf 0.255, Loss_fe 0.304, Loss_kd 1.647, Train_accy 80.16:  40%|████      | 8/20 [06:28<09:10, 45.91s/it]
Task 4, Epoch 9/20 => Loss 2.215, Loss_clf 0.223, Loss_fe 0.262, Loss_kd 1.607, Train_accy 80.13:  40%|████      | 8/20 [07:06<09:10, 45.91s/it]
Task 4, Epoch 9/20 => Loss 2.215, Loss_clf 0.223, Loss_fe 0.262, Loss_kd 1.607, Train_accy 80.13:  45%|████▌     | 9/20 [07:06<08:00, 43.71s/it]
Task 4, Epoch 10/20 => Loss 2.225, Loss_clf 0.223, Loss_fe 0.268, Loss_kd 1.611, Train_accy 81.32:  45%|████▌     | 9/20 [07:45<08:00, 43.71s/it]
Task 4, Epoch 10/20 => Loss 2.225, Loss_clf 0.223, Loss_fe 0.268, Loss_kd 1.611, Train_accy 81.32:  50%|█████     | 10/20 [07:45<07:02, 42.21s/it]
Task 4, Epoch 11/20 => Loss 2.224, Loss_clf 0.234, Loss_fe 0.249, Loss_kd 1.617, Train_accy 80.03, Test_accy 91.73:  50%|█████     | 10/20 [09:03<07:02, 42.21s/it]
Task 4, Epoch 11/20 => Loss 2.224, Loss_clf 0.234, Loss_fe 0.249, Loss_kd 1.617, Train_accy 80.03, Test_accy 91.73:  55%|█████▌    | 11/20 [09:03<07:57, 53.09s/it]
Task 4, Epoch 12/20 => Loss 2.208, Loss_clf 0.211, Loss_fe 0.240, Loss_kd 1.631, Train_accy 80.92:  55%|█████▌    | 11/20 [09:42<07:57, 53.09s/it]                 
Task 4, Epoch 12/20 => Loss 2.208, Loss_clf 0.211, Loss_fe 0.240, Loss_kd 1.631, Train_accy 80.92:  60%|██████    | 12/20 [09:42<06:30, 48.77s/it]
Task 4, Epoch 13/20 => Loss 2.154, Loss_clf 0.202, Loss_fe 0.226, Loss_kd 1.603, Train_accy 80.58:  60%|██████    | 12/20 [10:21<06:30, 48.77s/it]
Task 4, Epoch 13/20 => Loss 2.154, Loss_clf 0.202, Loss_fe 0.226, Loss_kd 1.603, Train_accy 80.58:  65%|██████▌   | 13/20 [10:21<05:20, 45.76s/it]
Task 4, Epoch 14/20 => Loss 2.174, Loss_clf 0.206, Loss_fe 0.233, Loss_kd 1.611, Train_accy 80.24:  65%|██████▌   | 13/20 [11:00<05:20, 45.76s/it]
Task 4, Epoch 14/20 => Loss 2.174, Loss_clf 0.206, Loss_fe 0.233, Loss_kd 1.611, Train_accy 80.24:  70%|███████   | 14/20 [11:00<04:22, 43.68s/it]
Task 4, Epoch 15/20 => Loss 2.194, Loss_clf 0.212, Loss_fe 0.218, Loss_kd 1.638, Train_accy 80.92:  70%|███████   | 14/20 [11:38<04:22, 43.68s/it]
Task 4, Epoch 15/20 => Loss 2.194, Loss_clf 0.212, Loss_fe 0.218, Loss_kd 1.638, Train_accy 80.92:  75%|███████▌  | 15/20 [11:38<03:31, 42.21s/it]
Task 4, Epoch 16/20 => Loss 2.222, Loss_clf 0.222, Loss_fe 0.218, Loss_kd 1.655, Train_accy 80.32, Test_accy 92.04:  75%|███████▌  | 15/20 [12:56<03:31, 42.21s/it]
Task 4, Epoch 16/20 => Loss 2.222, Loss_clf 0.222, Loss_fe 0.218, Loss_kd 1.655, Train_accy 80.32, Test_accy 92.04:  80%|████████  | 16/20 [12:56<03:31, 52.91s/it]
Task 4, Epoch 17/20 => Loss 2.099, Loss_clf 0.189, Loss_fe 0.182, Loss_kd 1.605, Train_accy 81.24:  80%|████████  | 16/20 [13:35<03:31, 52.91s/it]                 
Task 4, Epoch 17/20 => Loss 2.099, Loss_clf 0.189, Loss_fe 0.182, Loss_kd 1.605, Train_accy 81.24:  85%|████████▌ | 17/20 [13:35<02:26, 48.68s/it]
Task 4, Epoch 18/20 => Loss 2.123, Loss_clf 0.195, Loss_fe 0.184, Loss_kd 1.619, Train_accy 81.84:  85%|████████▌ | 17/20 [14:14<02:26, 48.68s/it]
Task 4, Epoch 18/20 => Loss 2.123, Loss_clf 0.195, Loss_fe 0.184, Loss_kd 1.619, Train_accy 81.84:  90%|█████████ | 18/20 [14:14<01:31, 45.73s/it]
Task 4, Epoch 19/20 => Loss 2.104, Loss_clf 0.187, Loss_fe 0.182, Loss_kd 1.611, Train_accy 82.45:  90%|█████████ | 18/20 [14:53<01:31, 45.73s/it]
Task 4, Epoch 19/20 => Loss 2.104, Loss_clf 0.187, Loss_fe 0.182, Loss_kd 1.611, Train_accy 82.45:  95%|█████████▌| 19/20 [14:53<00:43, 43.69s/it]
Task 4, Epoch 20/20 => Loss 2.122, Loss_clf 0.185, Loss_fe 0.181, Loss_kd 1.631, Train_accy 82.63:  95%|█████████▌| 19/20 [15:32<00:43, 43.69s/it]
Task 4, Epoch 20/20 => Loss 2.122, Loss_clf 0.185, Loss_fe 0.181, Loss_kd 1.631, Train_accy 82.63: 100%|██████████| 20/20 [15:32<00:00, 42.24s/it]
Task 4, Epoch 20/20 => Loss 2.122, Loss_clf 0.185, Loss_fe 0.181, Loss_kd 1.631, Train_accy 82.63: 100%|██████████| 20/20 [15:32<00:00, 46.61s/it]
2024-09-05 20:10:23,313 [foster.py] => Task 4, Epoch 20/20 => Loss 2.122, Loss_clf 0.185, Loss_fe 0.181, Loss_kd 1.631, Train_accy 82.63
2024-09-05 20:10:23,314 [foster.py] => do not weight align teacher!
2024-09-05 20:10:23,315 [foster.py] => per cls weights : [1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 0.47464191
 0.47464191 0.47464191 0.47464191 0.47464191]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.693,  Train_accy 66.08, Test_accy 91.21:   0%|          | 0/20 [01:09<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.693,  Train_accy 66.08, Test_accy 91.21:   5%|▌         | 1/20 [01:09<21:54, 69.18s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.486,  Train_accy 71.42:   5%|▌         | 1/20 [01:58<21:54, 69.18s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.486,  Train_accy 71.42:  10%|█         | 2/20 [01:58<17:10, 57.26s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.452,  Train_accy 71.55:  10%|█         | 2/20 [02:47<17:10, 57.26s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.452,  Train_accy 71.55:  15%|█▌        | 3/20 [02:47<15:08, 53.46s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.489,  Train_accy 71.32:  15%|█▌        | 3/20 [03:35<15:08, 53.46s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.489,  Train_accy 71.32:  20%|██        | 4/20 [03:35<13:46, 51.65s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.487,  Train_accy 70.97:  20%|██        | 4/20 [04:24<13:46, 51.65s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.487,  Train_accy 70.97:  25%|██▌       | 5/20 [04:24<12:39, 50.66s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.478,  Train_accy 70.68, Test_accy 91.31:  25%|██▌       | 5/20 [05:33<12:39, 50.66s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.478,  Train_accy 70.68, Test_accy 91.31:  30%|███       | 6/20 [05:33<13:17, 56.94s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.438,  Train_accy 71.47:  30%|███       | 6/20 [06:22<13:17, 56.94s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.438,  Train_accy 71.47:  35%|███▌      | 7/20 [06:22<11:45, 54.30s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.425,  Train_accy 71.92:  35%|███▌      | 7/20 [07:11<11:45, 54.30s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.425,  Train_accy 71.92:  40%|████      | 8/20 [07:11<10:31, 52.59s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.461,  Train_accy 72.16:  40%|████      | 8/20 [08:00<10:31, 52.59s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.461,  Train_accy 72.16:  45%|████▌     | 9/20 [08:00<09:26, 51.46s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.456,  Train_accy 71.55:  45%|████▌     | 9/20 [08:49<09:26, 51.46s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.456,  Train_accy 71.55:  50%|█████     | 10/20 [08:49<08:26, 50.67s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.430,  Train_accy 71.50, Test_accy 91.41:  50%|█████     | 10/20 [09:58<08:26, 50.67s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.430,  Train_accy 71.50, Test_accy 91.41:  55%|█████▌    | 11/20 [09:58<08:26, 56.33s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.471,  Train_accy 71.16:  55%|█████▌    | 11/20 [10:47<08:26, 56.33s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.471,  Train_accy 71.16:  60%|██████    | 12/20 [10:47<07:12, 54.08s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.472,  Train_accy 72.32:  60%|██████    | 12/20 [11:36<07:12, 54.08s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.472,  Train_accy 72.32:  65%|██████▌   | 13/20 [11:36<06:07, 52.50s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.457,  Train_accy 71.45:  65%|██████▌   | 13/20 [12:25<06:07, 52.50s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.457,  Train_accy 71.45:  70%|███████   | 14/20 [12:25<05:08, 51.40s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.437,  Train_accy 71.95:  70%|███████   | 14/20 [13:14<05:08, 51.40s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.437,  Train_accy 71.95:  75%|███████▌  | 15/20 [13:14<04:13, 50.64s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.417,  Train_accy 72.55, Test_accy 91.44:  75%|███████▌  | 15/20 [14:23<04:13, 50.64s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.417,  Train_accy 72.55, Test_accy 91.44:  80%|████████  | 16/20 [14:23<03:44, 56.22s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.472,  Train_accy 71.03:  80%|████████  | 16/20 [15:12<03:44, 56.22s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.472,  Train_accy 71.03:  85%|████████▌ | 17/20 [15:12<02:42, 54.01s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.483,  Train_accy 71.29:  85%|████████▌ | 17/20 [16:01<02:42, 54.01s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.483,  Train_accy 71.29:  90%|█████████ | 18/20 [16:01<01:44, 52.47s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.414,  Train_accy 72.05:  90%|█████████ | 18/20 [16:50<01:44, 52.47s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.414,  Train_accy 72.05:  95%|█████████▌| 19/20 [16:50<00:51, 51.40s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.463,  Train_accy 73.13:  95%|█████████▌| 19/20 [17:39<00:51, 51.40s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.463,  Train_accy 73.13: 100%|██████████| 20/20 [17:39<00:00, 50.64s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.463,  Train_accy 73.13: 100%|██████████| 20/20 [17:39<00:00, 52.95s/it]
2024-09-05 20:28:03,851 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.463,  Train_accy 73.13
2024-09-05 20:28:03,852 [foster.py] => do not weight align student!
2024-09-05 20:28:24,071 [foster.py] => darknet eval: 
2024-09-05 20:28:24,071 [foster.py] => CNN top1 curve: 91.44
2024-09-05 20:28:24,071 [foster.py] => CNN top5 curve: 99.39
2024-09-05 20:28:24,074 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 20:30:22,435 [foster.py] => Exemplar size: 1400
2024-09-05 20:30:22,435 [trainer.py] => CNN: {'total': 92.09, '00-49': 93.94, '50-54': 90.6, '55-59': 92.6, '60-64': 82.0, '65-69': 84.6, 'old': 92.66, 'new': 84.6}
2024-09-05 20:30:22,435 [trainer.py] => NME: {'total': 92.7, '00-49': 93.3, '50-54': 90.4, '55-59': 87.8, '60-64': 89.0, '65-69': 97.6, 'old': 92.32, 'new': 97.6}
2024-09-05 20:30:22,435 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77, 92.09]
2024-09-05 20:30:22,435 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31, 99.31]
2024-09-05 20:30:22,435 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66, 92.7]
2024-09-05 20:30:22,435 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42, 99.44]

Average Accuracy (CNN): 93.04
Average Accuracy (NME): 93.45
2024-09-05 20:30:22,435 [trainer.py] => Average Accuracy (CNN): 93.04
2024-09-05 20:30:22,435 [trainer.py] => Average Accuracy (NME): 93.45
2024-09-05 20:30:22,437 [trainer.py] => All params: 171808717
2024-09-05 20:30:22,437 [trainer.py] => Trainable params: 85960076
2024-09-05 20:30:23,999 [foster.py] => Learning on 70-75
2024-09-05 20:30:24,001 [foster.py] => All params: 171824092
2024-09-05 20:30:24,002 [foster.py] => Trainable params: 85971606
2024-09-05 20:30:24,088 [foster.py] => per cls weights : [1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 0.5749392  0.5749392
 0.5749392  0.5749392  0.5749392 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 4.500, Loss_clf 0.776, Loss_fe 1.920, Loss_kd 1.684, Train_accy 64.46, Test_accy 89.59:   0%|          | 0/20 [01:21<?, ?it/s]
Task 5, Epoch 1/20 => Loss 4.500, Loss_clf 0.776, Loss_fe 1.920, Loss_kd 1.684, Train_accy 64.46, Test_accy 89.59:   5%|▌         | 1/20 [01:21<25:44, 81.29s/it]
Task 5, Epoch 2/20 => Loss 2.983, Loss_clf 0.423, Loss_fe 0.739, Loss_kd 1.699, Train_accy 67.95:   5%|▌         | 1/20 [02:01<25:44, 81.29s/it]                 
Task 5, Epoch 2/20 => Loss 2.983, Loss_clf 0.423, Loss_fe 0.739, Loss_kd 1.699, Train_accy 67.95:  10%|█         | 2/20 [02:01<17:03, 56.89s/it]
Task 5, Epoch 3/20 => Loss 2.725, Loss_clf 0.375, Loss_fe 0.550, Loss_kd 1.681, Train_accy 66.85:  10%|█         | 2/20 [02:40<17:03, 56.89s/it]
Task 5, Epoch 3/20 => Loss 2.725, Loss_clf 0.375, Loss_fe 0.550, Loss_kd 1.681, Train_accy 66.85:  15%|█▌        | 3/20 [02:40<13:54, 49.10s/it]
Task 5, Epoch 4/20 => Loss 2.546, Loss_clf 0.314, Loss_fe 0.454, Loss_kd 1.660, Train_accy 69.26:  15%|█▌        | 3/20 [03:20<13:54, 49.10s/it]
Task 5, Epoch 4/20 => Loss 2.546, Loss_clf 0.314, Loss_fe 0.454, Loss_kd 1.660, Train_accy 69.26:  20%|██        | 4/20 [03:20<12:07, 45.46s/it]
Task 5, Epoch 5/20 => Loss 2.452, Loss_clf 0.295, Loss_fe 0.386, Loss_kd 1.653, Train_accy 69.85:  20%|██        | 4/20 [04:00<12:07, 45.46s/it]
Task 5, Epoch 5/20 => Loss 2.452, Loss_clf 0.295, Loss_fe 0.386, Loss_kd 1.653, Train_accy 69.85:  25%|██▌       | 5/20 [04:00<10:51, 43.46s/it]
Task 5, Epoch 6/20 => Loss 2.427, Loss_clf 0.289, Loss_fe 0.364, Loss_kd 1.655, Train_accy 69.44, Test_accy 90.57:  25%|██▌       | 5/20 [05:22<10:51, 43.46s/it]
Task 5, Epoch 6/20 => Loss 2.427, Loss_clf 0.289, Loss_fe 0.364, Loss_kd 1.655, Train_accy 69.44, Test_accy 90.57:  30%|███       | 6/20 [05:22<13:09, 56.37s/it]
Task 5, Epoch 7/20 => Loss 2.415, Loss_clf 0.270, Loss_fe 0.353, Loss_kd 1.672, Train_accy 71.23:  30%|███       | 6/20 [06:02<13:09, 56.37s/it]                 
Task 5, Epoch 7/20 => Loss 2.415, Loss_clf 0.270, Loss_fe 0.353, Loss_kd 1.672, Train_accy 71.23:  35%|███▌      | 7/20 [06:02<11:02, 50.97s/it]
Task 5, Epoch 8/20 => Loss 2.401, Loss_clf 0.260, Loss_fe 0.340, Loss_kd 1.681, Train_accy 72.23:  35%|███▌      | 7/20 [06:41<11:02, 50.97s/it]
Task 5, Epoch 8/20 => Loss 2.401, Loss_clf 0.260, Loss_fe 0.340, Loss_kd 1.681, Train_accy 72.23:  40%|████      | 8/20 [06:41<09:29, 47.44s/it]
Task 5, Epoch 9/20 => Loss 2.379, Loss_clf 0.273, Loss_fe 0.320, Loss_kd 1.667, Train_accy 72.72:  40%|████      | 8/20 [07:21<09:29, 47.44s/it]
Task 5, Epoch 9/20 => Loss 2.379, Loss_clf 0.273, Loss_fe 0.320, Loss_kd 1.667, Train_accy 72.72:  45%|████▌     | 9/20 [07:21<08:15, 45.08s/it]
Task 5, Epoch 10/20 => Loss 2.350, Loss_clf 0.266, Loss_fe 0.303, Loss_kd 1.661, Train_accy 73.59:  45%|████▌     | 9/20 [08:01<08:15, 45.08s/it]
Task 5, Epoch 10/20 => Loss 2.350, Loss_clf 0.266, Loss_fe 0.303, Loss_kd 1.661, Train_accy 73.59:  50%|█████     | 10/20 [08:01<07:14, 43.47s/it]
Task 5, Epoch 11/20 => Loss 2.377, Loss_clf 0.269, Loss_fe 0.308, Loss_kd 1.680, Train_accy 72.51, Test_accy 90.77:  50%|█████     | 10/20 [09:23<07:14, 43.47s/it]
Task 5, Epoch 11/20 => Loss 2.377, Loss_clf 0.269, Loss_fe 0.308, Loss_kd 1.680, Train_accy 72.51, Test_accy 90.77:  55%|█████▌    | 11/20 [09:23<08:16, 55.12s/it]
Task 5, Epoch 12/20 => Loss 2.218, Loss_clf 0.213, Loss_fe 0.235, Loss_kd 1.653, Train_accy 76.87:  55%|█████▌    | 11/20 [10:03<08:16, 55.12s/it]                 
Task 5, Epoch 12/20 => Loss 2.218, Loss_clf 0.213, Loss_fe 0.235, Loss_kd 1.653, Train_accy 76.87:  60%|██████    | 12/20 [10:03<06:43, 50.48s/it]
Task 5, Epoch 13/20 => Loss 2.246, Loss_clf 0.236, Loss_fe 0.250, Loss_kd 1.642, Train_accy 75.15:  60%|██████    | 12/20 [10:42<06:43, 50.48s/it]
Task 5, Epoch 13/20 => Loss 2.246, Loss_clf 0.236, Loss_fe 0.250, Loss_kd 1.642, Train_accy 75.15:  65%|██████▌   | 13/20 [10:42<05:30, 47.27s/it]
Task 5, Epoch 14/20 => Loss 2.260, Loss_clf 0.233, Loss_fe 0.236, Loss_kd 1.671, Train_accy 76.13:  65%|██████▌   | 13/20 [11:22<05:30, 47.27s/it]
Task 5, Epoch 14/20 => Loss 2.260, Loss_clf 0.233, Loss_fe 0.236, Loss_kd 1.671, Train_accy 76.13:  70%|███████   | 14/20 [11:22<04:30, 45.05s/it]
Task 5, Epoch 15/20 => Loss 2.303, Loss_clf 0.247, Loss_fe 0.245, Loss_kd 1.690, Train_accy 75.51:  70%|███████   | 14/20 [12:02<04:30, 45.05s/it]
Task 5, Epoch 15/20 => Loss 2.303, Loss_clf 0.247, Loss_fe 0.245, Loss_kd 1.690, Train_accy 75.51:  75%|███████▌  | 15/20 [12:02<03:37, 43.48s/it]
Task 5, Epoch 16/20 => Loss 2.187, Loss_clf 0.210, Loss_fe 0.199, Loss_kd 1.659, Train_accy 79.03, Test_accy 91.05:  75%|███████▌  | 15/20 [13:24<03:37, 43.48s/it]
Task 5, Epoch 16/20 => Loss 2.187, Loss_clf 0.210, Loss_fe 0.199, Loss_kd 1.659, Train_accy 79.03, Test_accy 91.05:  80%|████████  | 16/20 [13:24<03:39, 54.93s/it]
Task 5, Epoch 17/20 => Loss 2.137, Loss_clf 0.197, Loss_fe 0.195, Loss_kd 1.629, Train_accy 79.44:  80%|████████  | 16/20 [14:04<03:39, 54.93s/it]                 
Task 5, Epoch 17/20 => Loss 2.137, Loss_clf 0.197, Loss_fe 0.195, Loss_kd 1.629, Train_accy 79.44:  85%|████████▌ | 17/20 [14:04<02:31, 50.40s/it]
Task 5, Epoch 18/20 => Loss 2.328, Loss_clf 0.263, Loss_fe 0.257, Loss_kd 1.688, Train_accy 77.51:  85%|████████▌ | 17/20 [14:44<02:31, 50.40s/it]
Task 5, Epoch 18/20 => Loss 2.328, Loss_clf 0.263, Loss_fe 0.257, Loss_kd 1.688, Train_accy 77.51:  90%|█████████ | 18/20 [14:44<01:34, 47.25s/it]
Task 5, Epoch 19/20 => Loss 2.261, Loss_clf 0.245, Loss_fe 0.222, Loss_kd 1.674, Train_accy 77.00:  90%|█████████ | 18/20 [15:23<01:34, 47.25s/it]
Task 5, Epoch 19/20 => Loss 2.261, Loss_clf 0.245, Loss_fe 0.222, Loss_kd 1.674, Train_accy 77.00:  95%|█████████▌| 19/20 [15:23<00:45, 45.03s/it]
Task 5, Epoch 20/20 => Loss 2.164, Loss_clf 0.195, Loss_fe 0.192, Loss_kd 1.658, Train_accy 78.41:  95%|█████████▌| 19/20 [16:03<00:45, 45.03s/it]
Task 5, Epoch 20/20 => Loss 2.164, Loss_clf 0.195, Loss_fe 0.192, Loss_kd 1.658, Train_accy 78.41: 100%|██████████| 20/20 [16:03<00:00, 43.46s/it]
Task 5, Epoch 20/20 => Loss 2.164, Loss_clf 0.195, Loss_fe 0.192, Loss_kd 1.658, Train_accy 78.41: 100%|██████████| 20/20 [16:03<00:00, 48.18s/it]
2024-09-05 20:46:27,756 [foster.py] => Task 5, Epoch 20/20 => Loss 2.164, Loss_clf 0.195, Loss_fe 0.192, Loss_kd 1.658, Train_accy 78.41
2024-09-05 20:46:27,757 [foster.py] => do not weight align teacher!
2024-09-05 20:46:27,758 [foster.py] => per cls weights : [1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 0.4733666  0.4733666
 0.4733666  0.4733666  0.4733666 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.860,  Train_accy 55.87, Test_accy 90.04:   0%|          | 0/20 [01:11<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.860,  Train_accy 55.87, Test_accy 90.04:   5%|▌         | 1/20 [01:11<22:44, 71.81s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.663,  Train_accy 61.79:   5%|▌         | 1/20 [02:01<22:44, 71.81s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.663,  Train_accy 61.79:  10%|█         | 2/20 [02:01<17:42, 59.05s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.661,  Train_accy 62.59:  10%|█         | 2/20 [02:52<17:42, 59.05s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.661,  Train_accy 62.59:  15%|█▌        | 3/20 [02:52<15:34, 54.96s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.691,  Train_accy 61.67:  15%|█▌        | 3/20 [03:42<15:34, 54.96s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.691,  Train_accy 61.67:  20%|██        | 4/20 [03:42<14:08, 53.05s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.668,  Train_accy 61.62:  20%|██        | 4/20 [04:32<14:08, 53.05s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.668,  Train_accy 61.62:  25%|██▌       | 5/20 [04:32<12:59, 51.99s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.703,  Train_accy 61.85, Test_accy 89.89:  25%|██▌       | 5/20 [05:44<12:59, 51.99s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.703,  Train_accy 61.85, Test_accy 89.89:  30%|███       | 6/20 [05:44<13:42, 58.73s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.657,  Train_accy 62.51:  30%|███       | 6/20 [06:34<13:42, 58.73s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.657,  Train_accy 62.51:  35%|███▌      | 7/20 [06:34<12:06, 55.92s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.656,  Train_accy 62.82:  35%|███▌      | 7/20 [07:24<12:06, 55.92s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.656,  Train_accy 62.82:  40%|████      | 8/20 [07:24<10:49, 54.10s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.660,  Train_accy 62.00:  40%|████      | 8/20 [08:14<10:49, 54.10s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.660,  Train_accy 62.00:  45%|████▌     | 9/20 [08:14<09:41, 52.87s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.683,  Train_accy 62.36:  45%|████▌     | 9/20 [09:04<09:41, 52.87s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.683,  Train_accy 62.36:  50%|█████     | 10/20 [09:04<08:40, 52.03s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.669,  Train_accy 62.18, Test_accy 89.93:  50%|█████     | 10/20 [10:16<08:40, 52.03s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.669,  Train_accy 62.18, Test_accy 89.93:  55%|█████▌    | 11/20 [10:16<08:42, 58.08s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.641,  Train_accy 62.85:  55%|█████▌    | 11/20 [11:06<08:42, 58.08s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.641,  Train_accy 62.85:  60%|██████    | 12/20 [11:06<07:25, 55.67s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.678,  Train_accy 61.82:  60%|██████    | 12/20 [11:56<07:25, 55.67s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.678,  Train_accy 61.82:  65%|██████▌   | 13/20 [11:56<06:18, 54.00s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.687,  Train_accy 62.59:  65%|██████▌   | 13/20 [12:46<06:18, 54.00s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.687,  Train_accy 62.59:  70%|███████   | 14/20 [12:46<05:17, 52.84s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.663,  Train_accy 63.28:  70%|███████   | 14/20 [13:37<05:17, 52.84s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.663,  Train_accy 63.28:  75%|███████▌  | 15/20 [13:37<04:20, 52.05s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.672,  Train_accy 63.03, Test_accy 89.99:  75%|███████▌  | 15/20 [14:49<04:20, 52.05s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.672,  Train_accy 63.03, Test_accy 89.99:  80%|████████  | 16/20 [14:49<03:52, 58.06s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.688,  Train_accy 62.90:  80%|████████  | 16/20 [15:39<03:52, 58.06s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.688,  Train_accy 62.90:  85%|████████▌ | 17/20 [15:39<02:47, 55.69s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.672,  Train_accy 62.10:  85%|████████▌ | 17/20 [16:29<02:47, 55.69s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.672,  Train_accy 62.10:  90%|█████████ | 18/20 [16:29<01:48, 54.04s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.656,  Train_accy 62.41:  90%|█████████ | 18/20 [17:19<01:48, 54.04s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.656,  Train_accy 62.41:  95%|█████████▌| 19/20 [17:19<00:52, 52.86s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.637,  Train_accy 61.92:  95%|█████████▌| 19/20 [18:09<00:52, 52.86s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.637,  Train_accy 61.92: 100%|██████████| 20/20 [18:09<00:00, 52.07s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.637,  Train_accy 61.92: 100%|██████████| 20/20 [18:09<00:00, 54.50s/it]
2024-09-05 21:04:39,220 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.637,  Train_accy 61.92
2024-09-05 21:04:39,221 [foster.py] => do not weight align student!
2024-09-05 21:05:00,918 [foster.py] => darknet eval: 
2024-09-05 21:05:00,919 [foster.py] => CNN top1 curve: 89.97
2024-09-05 21:05:00,919 [foster.py] => CNN top5 curve: 99.2
2024-09-05 21:05:00,921 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 21:07:06,954 [foster.py] => Exemplar size: 1500
2024-09-05 21:07:06,954 [trainer.py] => CNN: {'total': 90.83, '00-49': 93.52, '50-54': 90.4, '55-59': 91.8, '60-64': 83.8, '65-69': 89.4, '70-74': 71.8, 'old': 92.19, 'new': 71.8}
2024-09-05 21:07:06,954 [trainer.py] => NME: {'total': 91.55, '00-49': 92.74, '50-54': 89.8, '55-59': 85.0, '60-64': 81.0, '65-69': 95.4, '70-74': 94.6, 'old': 91.33, 'new': 94.6}
2024-09-05 21:07:06,954 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77, 92.09, 90.83]
2024-09-05 21:07:06,954 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31, 99.31, 99.16]
2024-09-05 21:07:06,954 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66, 92.7, 91.55]
2024-09-05 21:07:06,954 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42, 99.44, 99.28]

Average Accuracy (CNN): 92.67
Average Accuracy (NME): 93.13
2024-09-05 21:07:06,954 [trainer.py] => Average Accuracy (CNN): 92.67
2024-09-05 21:07:06,954 [trainer.py] => Average Accuracy (NME): 93.13
2024-09-05 21:07:06,955 [trainer.py] => All params: 171824092
2024-09-05 21:07:06,956 [trainer.py] => Trainable params: 85971606
2024-09-05 21:07:08,475 [foster.py] => Learning on 75-80
2024-09-05 21:07:08,477 [foster.py] => All params: 171839467
2024-09-05 21:07:08,477 [foster.py] => Trainable params: 85983136
2024-09-05 21:07:08,561 [foster.py] => per cls weights : [1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 0.57385027 0.57385027 0.57385027
 0.57385027 0.57385027]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 4.446, Loss_clf 0.804, Loss_fe 2.022, Loss_kd 1.519, Train_accy 57.10, Test_accy 87.88:   0%|          | 0/20 [01:25<?, ?it/s]
Task 6, Epoch 1/20 => Loss 4.446, Loss_clf 0.804, Loss_fe 2.022, Loss_kd 1.519, Train_accy 57.10, Test_accy 87.88:   5%|▌         | 1/20 [01:25<26:55, 85.04s/it]
Task 6, Epoch 2/20 => Loss 2.844, Loss_clf 0.421, Loss_fe 0.808, Loss_kd 1.514, Train_accy 60.92:   5%|▌         | 1/20 [02:05<26:55, 85.04s/it]                 
Task 6, Epoch 2/20 => Loss 2.844, Loss_clf 0.421, Loss_fe 0.808, Loss_kd 1.514, Train_accy 60.92:  10%|█         | 2/20 [02:05<17:43, 59.08s/it]
Task 6, Epoch 3/20 => Loss 2.563, Loss_clf 0.399, Loss_fe 0.547, Loss_kd 1.515, Train_accy 58.52:  10%|█         | 2/20 [02:46<17:43, 59.08s/it]
Task 6, Epoch 3/20 => Loss 2.563, Loss_clf 0.399, Loss_fe 0.547, Loss_kd 1.515, Train_accy 58.52:  15%|█▌        | 3/20 [02:46<14:22, 50.75s/it]
Task 6, Epoch 4/20 => Loss 2.454, Loss_clf 0.361, Loss_fe 0.466, Loss_kd 1.526, Train_accy 60.75:  15%|█▌        | 3/20 [03:27<14:22, 50.75s/it]
Task 6, Epoch 4/20 => Loss 2.454, Loss_clf 0.361, Loss_fe 0.466, Loss_kd 1.526, Train_accy 60.75:  20%|██        | 4/20 [03:27<12:29, 46.85s/it]
Task 6, Epoch 5/20 => Loss 2.364, Loss_clf 0.331, Loss_fe 0.420, Loss_kd 1.513, Train_accy 60.88:  20%|██        | 4/20 [04:08<12:29, 46.85s/it]
Task 6, Epoch 5/20 => Loss 2.364, Loss_clf 0.331, Loss_fe 0.420, Loss_kd 1.513, Train_accy 60.88:  25%|██▌       | 5/20 [04:08<11:10, 44.71s/it]
Task 6, Epoch 6/20 => Loss 2.352, Loss_clf 0.322, Loss_fe 0.399, Loss_kd 1.529, Train_accy 61.45, Test_accy 88.78:  25%|██▌       | 5/20 [05:33<11:10, 44.71s/it]
Task 6, Epoch 6/20 => Loss 2.352, Loss_clf 0.322, Loss_fe 0.399, Loss_kd 1.529, Train_accy 61.45, Test_accy 88.78:  30%|███       | 6/20 [05:33<13:38, 58.49s/it]
Task 6, Epoch 7/20 => Loss 2.227, Loss_clf 0.272, Loss_fe 0.347, Loss_kd 1.507, Train_accy 64.22:  30%|███       | 6/20 [06:14<13:38, 58.49s/it]                 
Task 6, Epoch 7/20 => Loss 2.227, Loss_clf 0.272, Loss_fe 0.347, Loss_kd 1.507, Train_accy 64.22:  35%|███▌      | 7/20 [06:14<11:25, 52.75s/it]
Task 6, Epoch 8/20 => Loss 2.318, Loss_clf 0.311, Loss_fe 0.362, Loss_kd 1.541, Train_accy 62.45:  35%|███▌      | 7/20 [06:55<11:25, 52.75s/it]
Task 6, Epoch 8/20 => Loss 2.318, Loss_clf 0.311, Loss_fe 0.362, Loss_kd 1.541, Train_accy 62.45:  40%|████      | 8/20 [06:55<09:47, 48.98s/it]
Task 6, Epoch 9/20 => Loss 2.169, Loss_clf 0.267, Loss_fe 0.300, Loss_kd 1.501, Train_accy 63.98:  40%|████      | 8/20 [07:36<09:47, 48.98s/it]
Task 6, Epoch 9/20 => Loss 2.169, Loss_clf 0.267, Loss_fe 0.300, Loss_kd 1.501, Train_accy 63.98:  45%|████▌     | 9/20 [07:36<08:31, 46.47s/it]
Task 6, Epoch 10/20 => Loss 2.222, Loss_clf 0.272, Loss_fe 0.314, Loss_kd 1.533, Train_accy 64.22:  45%|████▌     | 9/20 [08:17<08:31, 46.47s/it]
Task 6, Epoch 10/20 => Loss 2.222, Loss_clf 0.272, Loss_fe 0.314, Loss_kd 1.533, Train_accy 64.22:  50%|█████     | 10/20 [08:17<07:27, 44.75s/it]
Task 6, Epoch 11/20 => Loss 2.240, Loss_clf 0.279, Loss_fe 0.304, Loss_kd 1.553, Train_accy 64.20, Test_accy 88.68:  50%|█████     | 10/20 [09:42<07:27, 44.75s/it]
Task 6, Epoch 11/20 => Loss 2.240, Loss_clf 0.279, Loss_fe 0.304, Loss_kd 1.553, Train_accy 64.20, Test_accy 88.68:  55%|█████▌    | 11/20 [09:42<08:34, 57.16s/it]
Task 6, Epoch 12/20 => Loss 2.103, Loss_clf 0.248, Loss_fe 0.255, Loss_kd 1.499, Train_accy 65.53:  55%|█████▌    | 11/20 [10:23<08:34, 57.16s/it]                 
Task 6, Epoch 12/20 => Loss 2.103, Loss_clf 0.248, Loss_fe 0.255, Loss_kd 1.499, Train_accy 65.53:  60%|██████    | 12/20 [10:23<06:57, 52.20s/it]
Task 6, Epoch 13/20 => Loss 2.182, Loss_clf 0.259, Loss_fe 0.283, Loss_kd 1.538, Train_accy 66.90:  60%|██████    | 12/20 [11:04<06:57, 52.20s/it]
Task 6, Epoch 13/20 => Loss 2.182, Loss_clf 0.259, Loss_fe 0.283, Loss_kd 1.538, Train_accy 66.90:  65%|██████▌   | 13/20 [11:04<05:41, 48.77s/it]
Task 6, Epoch 14/20 => Loss 2.092, Loss_clf 0.238, Loss_fe 0.247, Loss_kd 1.507, Train_accy 66.12:  65%|██████▌   | 13/20 [11:45<05:41, 48.77s/it]
Task 6, Epoch 14/20 => Loss 2.092, Loss_clf 0.238, Loss_fe 0.247, Loss_kd 1.507, Train_accy 66.12:  70%|███████   | 14/20 [11:45<04:38, 46.39s/it]
Task 6, Epoch 15/20 => Loss 2.123, Loss_clf 0.258, Loss_fe 0.258, Loss_kd 1.506, Train_accy 67.70:  70%|███████   | 14/20 [12:26<04:38, 46.39s/it]
Task 6, Epoch 15/20 => Loss 2.123, Loss_clf 0.258, Loss_fe 0.258, Loss_kd 1.506, Train_accy 67.70:  75%|███████▌  | 15/20 [12:26<03:43, 44.71s/it]
Task 6, Epoch 16/20 => Loss 1.999, Loss_clf 0.205, Loss_fe 0.198, Loss_kd 1.496, Train_accy 67.45, Test_accy 88.92:  75%|███████▌  | 15/20 [13:51<03:43, 44.71s/it]
Task 6, Epoch 16/20 => Loss 1.999, Loss_clf 0.205, Loss_fe 0.198, Loss_kd 1.496, Train_accy 67.45, Test_accy 88.92:  80%|████████  | 16/20 [13:51<03:47, 56.97s/it]
Task 6, Epoch 17/20 => Loss 2.002, Loss_clf 0.214, Loss_fe 0.201, Loss_kd 1.488, Train_accy 68.85:  80%|████████  | 16/20 [14:32<03:47, 56.97s/it]                 
Task 6, Epoch 17/20 => Loss 2.002, Loss_clf 0.214, Loss_fe 0.201, Loss_kd 1.488, Train_accy 68.85:  85%|████████▌ | 17/20 [14:32<02:36, 52.15s/it]
Task 6, Epoch 18/20 => Loss 2.069, Loss_clf 0.224, Loss_fe 0.220, Loss_kd 1.524, Train_accy 68.70:  85%|████████▌ | 17/20 [15:13<02:36, 52.15s/it]
Task 6, Epoch 18/20 => Loss 2.069, Loss_clf 0.224, Loss_fe 0.220, Loss_kd 1.524, Train_accy 68.70:  90%|█████████ | 18/20 [15:13<01:37, 48.77s/it]
Task 6, Epoch 19/20 => Loss 2.011, Loss_clf 0.214, Loss_fe 0.207, Loss_kd 1.491, Train_accy 68.75:  90%|█████████ | 18/20 [15:54<01:37, 48.77s/it]
Task 6, Epoch 19/20 => Loss 2.011, Loss_clf 0.214, Loss_fe 0.207, Loss_kd 1.491, Train_accy 68.75:  95%|█████████▌| 19/20 [15:54<00:46, 46.41s/it]
Task 6, Epoch 20/20 => Loss 2.019, Loss_clf 0.213, Loss_fe 0.203, Loss_kd 1.502, Train_accy 68.75:  95%|█████████▌| 19/20 [16:35<00:46, 46.41s/it]
Task 6, Epoch 20/20 => Loss 2.019, Loss_clf 0.213, Loss_fe 0.203, Loss_kd 1.502, Train_accy 68.75: 100%|██████████| 20/20 [16:35<00:00, 44.73s/it]
Task 6, Epoch 20/20 => Loss 2.019, Loss_clf 0.213, Loss_fe 0.203, Loss_kd 1.502, Train_accy 68.75: 100%|██████████| 20/20 [16:35<00:00, 49.76s/it]
2024-09-05 21:23:43,787 [foster.py] => Task 6, Epoch 20/20 => Loss 2.019, Loss_clf 0.213, Loss_fe 0.203, Loss_kd 1.502, Train_accy 68.75
2024-09-05 21:23:43,788 [foster.py] => do not weight align teacher!
2024-09-05 21:23:43,792 [foster.py] => per cls weights : [1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 0.4722563  0.4722563  0.4722563
 0.4722563  0.4722563 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.691,  Train_accy 49.05, Test_accy 88.05:   0%|          | 0/20 [01:14<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.691,  Train_accy 49.05, Test_accy 88.05:   5%|▌         | 1/20 [01:14<23:32, 74.37s/it]
SNet: Task 6, Epoch 2/20 => Loss 1.535,  Train_accy 53.85:   5%|▌         | 1/20 [02:05<23:32, 74.37s/it]                 
SNet: Task 6, Epoch 2/20 => Loss 1.535,  Train_accy 53.85:  10%|█         | 2/20 [02:05<18:14, 60.83s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.541,  Train_accy 53.52:  10%|█         | 2/20 [02:57<18:14, 60.83s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.541,  Train_accy 53.52:  15%|█▌        | 3/20 [02:57<16:00, 56.53s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.533,  Train_accy 53.38:  15%|█▌        | 3/20 [03:48<16:00, 56.53s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.533,  Train_accy 53.38:  20%|██        | 4/20 [03:48<14:32, 54.51s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.545,  Train_accy 53.82:  20%|██        | 4/20 [04:39<14:32, 54.51s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.545,  Train_accy 53.82:  25%|██▌       | 5/20 [04:39<13:20, 53.37s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.547,  Train_accy 53.65, Test_accy 88.10:  25%|██▌       | 5/20 [05:54<13:20, 53.37s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.547,  Train_accy 53.65, Test_accy 88.10:  30%|███       | 6/20 [05:54<14:07, 60.54s/it]
SNet: Task 6, Epoch 7/20 => Loss 1.521,  Train_accy 54.82:  30%|███       | 6/20 [06:45<14:07, 60.54s/it]                 
SNet: Task 6, Epoch 7/20 => Loss 1.521,  Train_accy 54.82:  35%|███▌      | 7/20 [06:45<12:28, 57.54s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.501,  Train_accy 54.92:  35%|███▌      | 7/20 [07:37<12:28, 57.54s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.501,  Train_accy 54.92:  40%|████      | 8/20 [07:37<11:06, 55.58s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.534,  Train_accy 54.38:  40%|████      | 8/20 [08:28<11:06, 55.58s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.534,  Train_accy 54.38:  45%|████▌     | 9/20 [08:28<09:57, 54.28s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.548,  Train_accy 54.18:  45%|████▌     | 9/20 [09:19<09:57, 54.28s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.548,  Train_accy 54.18:  50%|█████     | 10/20 [09:19<08:53, 53.39s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.520,  Train_accy 55.15, Test_accy 88.15:  50%|█████     | 10/20 [10:34<08:53, 53.39s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.520,  Train_accy 55.15, Test_accy 88.15:  55%|█████▌    | 11/20 [10:34<08:58, 59.84s/it]
SNet: Task 6, Epoch 12/20 => Loss 1.537,  Train_accy 54.62:  55%|█████▌    | 11/20 [11:25<08:58, 59.84s/it]                 
SNet: Task 6, Epoch 12/20 => Loss 1.537,  Train_accy 54.62:  60%|██████    | 12/20 [11:25<07:38, 57.27s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.523,  Train_accy 54.00:  60%|██████    | 12/20 [12:17<07:38, 57.27s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.523,  Train_accy 54.00:  65%|██████▌   | 13/20 [12:17<06:29, 55.62s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.539,  Train_accy 53.62:  65%|██████▌   | 13/20 [13:09<06:29, 55.62s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.539,  Train_accy 53.62:  70%|███████   | 14/20 [13:09<05:26, 54.45s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.521,  Train_accy 54.40:  70%|███████   | 14/20 [14:01<05:26, 54.45s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.521,  Train_accy 54.40:  75%|███████▌  | 15/20 [14:01<04:28, 53.62s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.518,  Train_accy 54.65, Test_accy 88.18:  75%|███████▌  | 15/20 [15:15<04:28, 53.62s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.518,  Train_accy 54.65, Test_accy 88.18:  80%|████████  | 16/20 [15:15<03:59, 59.97s/it]
SNet: Task 6, Epoch 17/20 => Loss 1.519,  Train_accy 55.40:  80%|████████  | 16/20 [16:07<03:59, 59.97s/it]                 
SNet: Task 6, Epoch 17/20 => Loss 1.519,  Train_accy 55.40:  85%|████████▌ | 17/20 [16:07<02:52, 57.43s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.525,  Train_accy 53.75:  85%|████████▌ | 17/20 [16:58<02:52, 57.43s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.525,  Train_accy 53.75:  90%|█████████ | 18/20 [16:58<01:51, 55.67s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.545,  Train_accy 54.30:  90%|█████████ | 18/20 [17:50<01:51, 55.67s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.545,  Train_accy 54.30:  95%|█████████▌| 19/20 [17:50<00:54, 54.43s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.523,  Train_accy 54.20:  95%|█████████▌| 19/20 [18:42<00:54, 54.43s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.523,  Train_accy 54.20: 100%|██████████| 20/20 [18:42<00:00, 53.59s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.523,  Train_accy 54.20: 100%|██████████| 20/20 [18:42<00:00, 56.10s/it]
2024-09-05 21:42:27,227 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.523,  Train_accy 54.20
2024-09-05 21:42:27,228 [foster.py] => do not weight align student!
2024-09-05 21:42:50,379 [foster.py] => darknet eval: 
2024-09-05 21:42:50,379 [foster.py] => CNN top1 curve: 88.18
2024-09-05 21:42:50,379 [foster.py] => CNN top5 curve: 99.15
2024-09-05 21:42:50,381 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 21:45:03,285 [foster.py] => Exemplar size: 1600
2024-09-05 21:45:03,286 [trainer.py] => CNN: {'total': 88.85, '00-49': 93.48, '50-54': 90.4, '55-59': 92.0, '60-64': 85.4, '65-69': 93.2, '70-74': 73.8, '75-79': 52.0, 'old': 91.31, 'new': 52.0}
2024-09-05 21:45:03,286 [trainer.py] => NME: {'total': 90.2, '00-49': 92.18, '50-54': 81.2, '55-59': 84.2, '60-64': 85.0, '65-69': 96.0, '70-74': 83.4, '75-79': 91.6, 'old': 90.11, 'new': 91.6}
2024-09-05 21:45:03,286 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77, 92.09, 90.83, 88.85]
2024-09-05 21:45:03,286 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31, 99.31, 99.16, 99.02]
2024-09-05 21:45:03,286 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66, 92.7, 91.55, 90.2]
2024-09-05 21:45:03,286 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42, 99.44, 99.28, 99.21]

Average Accuracy (CNN): 92.12
Average Accuracy (NME): 92.71
2024-09-05 21:45:03,286 [trainer.py] => Average Accuracy (CNN): 92.12
2024-09-05 21:45:03,286 [trainer.py] => Average Accuracy (NME): 92.71
2024-09-05 21:45:03,287 [trainer.py] => All params: 171839467
2024-09-05 21:45:03,288 [trainer.py] => Trainable params: 85983136
2024-09-05 21:45:04,792 [foster.py] => Learning on 80-85
2024-09-05 21:45:04,793 [foster.py] => All params: 171854842
2024-09-05 21:45:04,794 [foster.py] => Trainable params: 85994666
2024-09-05 21:45:04,879 [foster.py] => per cls weights : [1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  0.57289286 0.57289286 0.57289286 0.57289286
 0.57289286]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 4.265, Loss_clf 0.681, Loss_fe 2.031, Loss_kd 1.462, Train_accy 59.41, Test_accy 87.20:   0%|          | 0/20 [01:28<?, ?it/s]
Task 7, Epoch 1/20 => Loss 4.265, Loss_clf 0.681, Loss_fe 2.031, Loss_kd 1.462, Train_accy 59.41, Test_accy 87.20:   5%|▌         | 1/20 [01:28<28:06, 88.74s/it]
Task 7, Epoch 2/20 => Loss 2.662, Loss_clf 0.371, Loss_fe 0.767, Loss_kd 1.435, Train_accy 64.17:   5%|▌         | 1/20 [02:10<28:06, 88.74s/it]                 
Task 7, Epoch 2/20 => Loss 2.662, Loss_clf 0.371, Loss_fe 0.767, Loss_kd 1.435, Train_accy 64.17:  10%|█         | 2/20 [02:10<18:20, 61.16s/it]
Task 7, Epoch 3/20 => Loss 2.382, Loss_clf 0.329, Loss_fe 0.520, Loss_kd 1.443, Train_accy 64.56:  10%|█         | 2/20 [02:52<18:20, 61.16s/it]
Task 7, Epoch 3/20 => Loss 2.382, Loss_clf 0.329, Loss_fe 0.520, Loss_kd 1.443, Train_accy 64.56:  15%|█▌        | 3/20 [02:52<14:49, 52.34s/it]
Task 7, Epoch 4/20 => Loss 2.249, Loss_clf 0.299, Loss_fe 0.431, Loss_kd 1.429, Train_accy 64.71:  15%|█▌        | 3/20 [03:34<14:49, 52.34s/it]
Task 7, Epoch 4/20 => Loss 2.249, Loss_clf 0.299, Loss_fe 0.431, Loss_kd 1.429, Train_accy 64.71:  20%|██        | 4/20 [03:34<12:51, 48.20s/it]
Task 7, Epoch 5/20 => Loss 2.217, Loss_clf 0.296, Loss_fe 0.403, Loss_kd 1.428, Train_accy 64.61:  20%|██        | 4/20 [04:16<12:51, 48.20s/it]
Task 7, Epoch 5/20 => Loss 2.217, Loss_clf 0.296, Loss_fe 0.403, Loss_kd 1.428, Train_accy 64.61:  25%|██▌       | 5/20 [04:16<11:29, 45.94s/it]
Task 7, Epoch 6/20 => Loss 2.169, Loss_clf 0.276, Loss_fe 0.375, Loss_kd 1.428, Train_accy 64.85, Test_accy 87.93:  25%|██▌       | 5/20 [05:45<11:29, 45.94s/it]
Task 7, Epoch 6/20 => Loss 2.169, Loss_clf 0.276, Loss_fe 0.375, Loss_kd 1.428, Train_accy 64.85, Test_accy 87.93:  30%|███       | 6/20 [05:45<14:08, 60.61s/it]
Task 7, Epoch 7/20 => Loss 2.066, Loss_clf 0.249, Loss_fe 0.310, Loss_kd 1.418, Train_accy 68.00:  30%|███       | 6/20 [06:27<14:08, 60.61s/it]                 
Task 7, Epoch 7/20 => Loss 2.066, Loss_clf 0.249, Loss_fe 0.310, Loss_kd 1.418, Train_accy 68.00:  35%|███▌      | 7/20 [06:27<11:48, 54.48s/it]
Task 7, Epoch 8/20 => Loss 2.132, Loss_clf 0.267, Loss_fe 0.329, Loss_kd 1.445, Train_accy 68.78:  35%|███▌      | 7/20 [07:09<11:48, 54.48s/it]
Task 7, Epoch 8/20 => Loss 2.132, Loss_clf 0.267, Loss_fe 0.329, Loss_kd 1.445, Train_accy 68.78:  40%|████      | 8/20 [07:09<10:05, 50.46s/it]
Task 7, Epoch 9/20 => Loss 2.107, Loss_clf 0.276, Loss_fe 0.309, Loss_kd 1.433, Train_accy 67.66:  40%|████      | 8/20 [07:50<10:05, 50.46s/it]
Task 7, Epoch 9/20 => Loss 2.107, Loss_clf 0.276, Loss_fe 0.309, Loss_kd 1.433, Train_accy 67.66:  45%|████▌     | 9/20 [07:50<08:45, 47.77s/it]
Task 7, Epoch 10/20 => Loss 2.019, Loss_clf 0.242, Loss_fe 0.276, Loss_kd 1.412, Train_accy 68.05:  45%|████▌     | 9/20 [08:32<08:45, 47.77s/it]
Task 7, Epoch 10/20 => Loss 2.019, Loss_clf 0.242, Loss_fe 0.276, Loss_kd 1.412, Train_accy 68.05:  50%|█████     | 10/20 [08:32<07:39, 45.96s/it]
Task 7, Epoch 11/20 => Loss 2.070, Loss_clf 0.253, Loss_fe 0.277, Loss_kd 1.449, Train_accy 68.41, Test_accy 88.09:  50%|█████     | 10/20 [10:01<07:39, 45.96s/it]
Task 7, Epoch 11/20 => Loss 2.070, Loss_clf 0.253, Loss_fe 0.277, Loss_kd 1.449, Train_accy 68.41, Test_accy 88.09:  55%|█████▌    | 11/20 [10:01<08:52, 59.16s/it]
Task 7, Epoch 12/20 => Loss 2.054, Loss_clf 0.248, Loss_fe 0.270, Loss_kd 1.445, Train_accy 70.41:  55%|█████▌    | 11/20 [10:43<08:52, 59.16s/it]                 
Task 7, Epoch 12/20 => Loss 2.054, Loss_clf 0.248, Loss_fe 0.270, Loss_kd 1.445, Train_accy 70.41:  60%|██████    | 12/20 [10:43<07:11, 53.91s/it]
Task 7, Epoch 13/20 => Loss 2.002, Loss_clf 0.238, Loss_fe 0.250, Loss_kd 1.424, Train_accy 70.41:  60%|██████    | 12/20 [11:25<07:11, 53.91s/it]
Task 7, Epoch 13/20 => Loss 2.002, Loss_clf 0.238, Loss_fe 0.250, Loss_kd 1.424, Train_accy 70.41:  65%|██████▌   | 13/20 [11:25<05:51, 50.28s/it]
Task 7, Epoch 14/20 => Loss 1.961, Loss_clf 0.229, Loss_fe 0.225, Loss_kd 1.419, Train_accy 69.56:  65%|██████▌   | 13/20 [12:07<05:51, 50.28s/it]
Task 7, Epoch 14/20 => Loss 1.961, Loss_clf 0.229, Loss_fe 0.225, Loss_kd 1.419, Train_accy 69.56:  70%|███████   | 14/20 [12:07<04:46, 47.76s/it]
Task 7, Epoch 15/20 => Loss 2.016, Loss_clf 0.244, Loss_fe 0.233, Loss_kd 1.449, Train_accy 68.88:  70%|███████   | 14/20 [12:49<04:46, 47.76s/it]
Task 7, Epoch 15/20 => Loss 2.016, Loss_clf 0.244, Loss_fe 0.233, Loss_kd 1.449, Train_accy 68.88:  75%|███████▌  | 15/20 [12:49<03:50, 46.01s/it]
Task 7, Epoch 16/20 => Loss 1.873, Loss_clf 0.201, Loss_fe 0.188, Loss_kd 1.396, Train_accy 70.22, Test_accy 87.88:  75%|███████▌  | 15/20 [14:18<03:50, 46.01s/it]
Task 7, Epoch 16/20 => Loss 1.873, Loss_clf 0.201, Loss_fe 0.188, Loss_kd 1.396, Train_accy 70.22, Test_accy 87.88:  80%|████████  | 16/20 [14:18<03:56, 59.05s/it]
Task 7, Epoch 17/20 => Loss 1.900, Loss_clf 0.209, Loss_fe 0.194, Loss_kd 1.410, Train_accy 70.78:  80%|████████  | 16/20 [15:00<03:56, 59.05s/it]                 
Task 7, Epoch 17/20 => Loss 1.900, Loss_clf 0.209, Loss_fe 0.194, Loss_kd 1.410, Train_accy 70.78:  85%|████████▌ | 17/20 [15:00<02:41, 53.92s/it]
Task 7, Epoch 18/20 => Loss 1.908, Loss_clf 0.213, Loss_fe 0.196, Loss_kd 1.411, Train_accy 71.49:  85%|████████▌ | 17/20 [15:42<02:41, 53.92s/it]
Task 7, Epoch 18/20 => Loss 1.908, Loss_clf 0.213, Loss_fe 0.196, Loss_kd 1.411, Train_accy 71.49:  90%|█████████ | 18/20 [15:42<01:40, 50.33s/it]
Task 7, Epoch 19/20 => Loss 1.941, Loss_clf 0.219, Loss_fe 0.200, Loss_kd 1.432, Train_accy 71.59:  90%|█████████ | 18/20 [16:24<01:40, 50.33s/it]
Task 7, Epoch 19/20 => Loss 1.941, Loss_clf 0.219, Loss_fe 0.200, Loss_kd 1.432, Train_accy 71.59:  95%|█████████▌| 19/20 [16:24<00:47, 47.81s/it]
Task 7, Epoch 20/20 => Loss 1.894, Loss_clf 0.199, Loss_fe 0.192, Loss_kd 1.415, Train_accy 72.37:  95%|█████████▌| 19/20 [17:06<00:47, 47.81s/it]
Task 7, Epoch 20/20 => Loss 1.894, Loss_clf 0.199, Loss_fe 0.192, Loss_kd 1.415, Train_accy 72.37: 100%|██████████| 20/20 [17:06<00:00, 46.05s/it]
Task 7, Epoch 20/20 => Loss 1.894, Loss_clf 0.199, Loss_fe 0.192, Loss_kd 1.415, Train_accy 72.37: 100%|██████████| 20/20 [17:06<00:00, 51.34s/it]
2024-09-05 22:02:11,661 [foster.py] => Task 7, Epoch 20/20 => Loss 1.894, Loss_clf 0.199, Loss_fe 0.192, Loss_kd 1.415, Train_accy 72.37
2024-09-05 22:02:11,662 [foster.py] => do not weight align teacher!
2024-09-05 22:02:11,666 [foster.py] => per cls weights : [1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 0.47128095 0.47128095 0.47128095 0.47128095
 0.47128095]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.565,  Train_accy 53.46, Test_accy 87.46:   0%|          | 0/20 [01:17<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.565,  Train_accy 53.46, Test_accy 87.46:   5%|▌         | 1/20 [01:17<24:29, 77.34s/it]
SNet: Task 7, Epoch 2/20 => Loss 1.425,  Train_accy 57.61:   5%|▌         | 1/20 [02:10<24:29, 77.34s/it]                 
SNet: Task 7, Epoch 2/20 => Loss 1.425,  Train_accy 57.61:  10%|█         | 2/20 [02:10<18:51, 62.84s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.414,  Train_accy 58.41:  10%|█         | 2/20 [03:02<18:51, 62.84s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.414,  Train_accy 58.41:  15%|█▌        | 3/20 [03:02<16:29, 58.21s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.439,  Train_accy 57.90:  15%|█▌        | 3/20 [03:55<16:29, 58.21s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.439,  Train_accy 57.90:  20%|██        | 4/20 [03:55<14:56, 56.06s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.405,  Train_accy 58.88:  20%|██        | 4/20 [04:48<14:56, 56.06s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.405,  Train_accy 58.88:  25%|██▌       | 5/20 [04:48<13:42, 54.85s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.416,  Train_accy 58.27, Test_accy 87.84:  25%|██▌       | 5/20 [06:05<13:42, 54.85s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.416,  Train_accy 58.27, Test_accy 87.84:  30%|███       | 6/20 [06:05<14:34, 62.48s/it]
SNet: Task 7, Epoch 7/20 => Loss 1.428,  Train_accy 59.15:  30%|███       | 6/20 [06:58<14:34, 62.48s/it]                 
SNet: Task 7, Epoch 7/20 => Loss 1.428,  Train_accy 59.15:  35%|███▌      | 7/20 [06:58<12:50, 59.28s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.402,  Train_accy 58.78:  35%|███▌      | 7/20 [07:50<12:50, 59.28s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.402,  Train_accy 58.78:  40%|████      | 8/20 [07:50<11:26, 57.20s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.434,  Train_accy 58.76:  40%|████      | 8/20 [08:43<11:26, 57.20s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.434,  Train_accy 58.76:  45%|████▌     | 9/20 [08:43<10:13, 55.80s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.404,  Train_accy 59.34:  45%|████▌     | 9/20 [09:36<10:13, 55.80s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.404,  Train_accy 59.34:  50%|█████     | 10/20 [09:36<09:08, 54.84s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.397,  Train_accy 59.49, Test_accy 87.74:  50%|█████     | 10/20 [10:53<09:08, 54.84s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.397,  Train_accy 59.49, Test_accy 87.74:  55%|█████▌    | 11/20 [10:53<09:15, 61.71s/it]
SNet: Task 7, Epoch 12/20 => Loss 1.427,  Train_accy 58.51:  55%|█████▌    | 11/20 [11:46<09:15, 61.71s/it]                 
SNet: Task 7, Epoch 12/20 => Loss 1.427,  Train_accy 58.51:  60%|██████    | 12/20 [11:46<07:51, 58.97s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.401,  Train_accy 59.17:  60%|██████    | 12/20 [12:39<07:51, 58.97s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.401,  Train_accy 59.17:  65%|██████▌   | 13/20 [12:39<06:39, 57.06s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.404,  Train_accy 59.27:  65%|██████▌   | 13/20 [13:31<06:39, 57.06s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.404,  Train_accy 59.27:  70%|███████   | 14/20 [13:31<05:34, 55.76s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.394,  Train_accy 59.17:  70%|███████   | 14/20 [14:24<05:34, 55.76s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.394,  Train_accy 59.17:  75%|███████▌  | 15/20 [14:24<04:34, 54.84s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.390,  Train_accy 59.24, Test_accy 87.69:  75%|███████▌  | 15/20 [15:41<04:34, 54.84s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.390,  Train_accy 59.24, Test_accy 87.69:  80%|████████  | 16/20 [15:41<04:06, 61.59s/it]
SNet: Task 7, Epoch 17/20 => Loss 1.384,  Train_accy 58.83:  80%|████████  | 16/20 [16:34<04:06, 61.59s/it]                 
SNet: Task 7, Epoch 17/20 => Loss 1.384,  Train_accy 58.83:  85%|████████▌ | 17/20 [16:34<02:56, 58.93s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.378,  Train_accy 59.17:  85%|████████▌ | 17/20 [17:27<02:56, 58.93s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.378,  Train_accy 59.17:  90%|█████████ | 18/20 [17:27<01:54, 57.06s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.397,  Train_accy 59.46:  90%|█████████ | 18/20 [18:19<01:54, 57.06s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.397,  Train_accy 59.46:  95%|█████████▌| 19/20 [18:19<00:55, 55.75s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.414,  Train_accy 59.71:  95%|█████████▌| 19/20 [19:12<00:55, 55.75s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.414,  Train_accy 59.71: 100%|██████████| 20/20 [19:12<00:00, 54.83s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.414,  Train_accy 59.71: 100%|██████████| 20/20 [19:12<00:00, 57.63s/it]
2024-09-05 22:21:25,831 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 1.414,  Train_accy 59.71
2024-09-05 22:21:25,831 [foster.py] => do not weight align student!
2024-09-05 22:21:50,435 [foster.py] => darknet eval: 
2024-09-05 22:21:50,436 [foster.py] => CNN top1 curve: 87.6
2024-09-05 22:21:50,436 [foster.py] => CNN top5 curve: 99.13
2024-09-05 22:21:50,439 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 22:24:11,100 [foster.py] => Exemplar size: 1700
2024-09-05 22:24:11,100 [trainer.py] => CNN: {'total': 87.98, '00-49': 92.8, '50-54': 90.2, '55-59': 90.0, '60-64': 87.2, '65-69': 94.8, '70-74': 80.0, '75-79': 71.0, '80-84': 54.4, 'old': 90.08, 'new': 54.4}
2024-09-05 22:24:11,100 [trainer.py] => NME: {'total': 90.51, '00-49': 91.86, '50-54': 86.0, '55-59': 86.4, '60-64': 84.6, '65-69': 96.6, '70-74': 88.0, '75-79': 82.8, '80-84': 95.6, 'old': 90.19, 'new': 95.6}
2024-09-05 22:24:11,100 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77, 92.09, 90.83, 88.85, 87.98]
2024-09-05 22:24:11,100 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31, 99.31, 99.16, 99.02, 99.2]
2024-09-05 22:24:11,101 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66, 92.7, 91.55, 90.2, 90.51]
2024-09-05 22:24:11,101 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42, 99.44, 99.28, 99.21, 99.19]

Average Accuracy (CNN): 91.6
Average Accuracy (NME): 92.44
2024-09-05 22:24:11,101 [trainer.py] => Average Accuracy (CNN): 91.6
2024-09-05 22:24:11,101 [trainer.py] => Average Accuracy (NME): 92.44
2024-09-05 22:24:11,102 [trainer.py] => All params: 171854842
2024-09-05 22:24:11,103 [trainer.py] => Trainable params: 85994666
2024-09-05 22:24:12,720 [foster.py] => Learning on 85-90
2024-09-05 22:24:12,722 [foster.py] => All params: 171870217
2024-09-05 22:24:12,723 [foster.py] => Trainable params: 86006196
2024-09-05 22:24:12,812 [foster.py] => per cls weights : [1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 0.57204451 0.57204451 0.57204451 0.57204451 0.57204451]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 5.081, Loss_clf 0.860, Loss_fe 2.281, Loss_kd 1.832, Train_accy 66.19, Test_accy 88.49:   0%|          | 0/20 [01:32<?, ?it/s]
Task 8, Epoch 1/20 => Loss 5.081, Loss_clf 0.860, Loss_fe 2.281, Loss_kd 1.832, Train_accy 66.19, Test_accy 88.49:   5%|▌         | 1/20 [01:32<29:22, 92.76s/it]
Task 8, Epoch 2/20 => Loss 3.263, Loss_clf 0.465, Loss_fe 0.870, Loss_kd 1.821, Train_accy 69.57:   5%|▌         | 1/20 [02:15<29:22, 92.76s/it]                 
Task 8, Epoch 2/20 => Loss 3.263, Loss_clf 0.465, Loss_fe 0.870, Loss_kd 1.821, Train_accy 69.57:  10%|█         | 2/20 [02:15<19:02, 63.45s/it]
Task 8, Epoch 3/20 => Loss 3.069, Loss_clf 0.472, Loss_fe 0.662, Loss_kd 1.827, Train_accy 70.19:  10%|█         | 2/20 [02:58<19:02, 63.45s/it]
Task 8, Epoch 3/20 => Loss 3.069, Loss_clf 0.472, Loss_fe 0.662, Loss_kd 1.827, Train_accy 70.19:  15%|█▌        | 3/20 [02:58<15:19, 54.07s/it]
Task 8, Epoch 4/20 => Loss 2.864, Loss_clf 0.395, Loss_fe 0.548, Loss_kd 1.815, Train_accy 71.52:  15%|█▌        | 3/20 [03:41<15:19, 54.07s/it]
Task 8, Epoch 4/20 => Loss 2.864, Loss_clf 0.395, Loss_fe 0.548, Loss_kd 1.815, Train_accy 71.52:  20%|██        | 4/20 [03:41<13:14, 49.67s/it]
Task 8, Epoch 5/20 => Loss 2.809, Loss_clf 0.380, Loss_fe 0.518, Loss_kd 1.805, Train_accy 71.57:  20%|██        | 4/20 [04:24<13:14, 49.67s/it]
Task 8, Epoch 5/20 => Loss 2.809, Loss_clf 0.380, Loss_fe 0.518, Loss_kd 1.805, Train_accy 71.57:  25%|██▌       | 5/20 [04:24<11:48, 47.24s/it]
Task 8, Epoch 6/20 => Loss 2.723, Loss_clf 0.356, Loss_fe 0.446, Loss_kd 1.814, Train_accy 72.76, Test_accy 88.69:  25%|██▌       | 5/20 [05:57<11:48, 47.24s/it]
Task 8, Epoch 6/20 => Loss 2.723, Loss_clf 0.356, Loss_fe 0.446, Loss_kd 1.814, Train_accy 72.76, Test_accy 88.69:  30%|███       | 6/20 [05:57<14:38, 62.77s/it]
Task 8, Epoch 7/20 => Loss 2.832, Loss_clf 0.389, Loss_fe 0.481, Loss_kd 1.853, Train_accy 72.00:  30%|███       | 6/20 [06:40<14:38, 62.77s/it]                 
Task 8, Epoch 7/20 => Loss 2.832, Loss_clf 0.389, Loss_fe 0.481, Loss_kd 1.853, Train_accy 72.00:  35%|███▌      | 7/20 [06:40<12:11, 56.29s/it]
Task 8, Epoch 8/20 => Loss 2.582, Loss_clf 0.310, Loss_fe 0.372, Loss_kd 1.794, Train_accy 76.76:  35%|███▌      | 7/20 [07:23<12:11, 56.29s/it]
Task 8, Epoch 8/20 => Loss 2.582, Loss_clf 0.310, Loss_fe 0.372, Loss_kd 1.794, Train_accy 76.76:  40%|████      | 8/20 [07:23<10:24, 52.05s/it]
Task 8, Epoch 9/20 => Loss 2.667, Loss_clf 0.339, Loss_fe 0.403, Loss_kd 1.818, Train_accy 73.64:  40%|████      | 8/20 [08:06<10:24, 52.05s/it]
Task 8, Epoch 9/20 => Loss 2.667, Loss_clf 0.339, Loss_fe 0.403, Loss_kd 1.818, Train_accy 73.64:  45%|████▌     | 9/20 [08:06<09:01, 49.22s/it]
Task 8, Epoch 10/20 => Loss 2.588, Loss_clf 0.314, Loss_fe 0.354, Loss_kd 1.813, Train_accy 75.43:  45%|████▌     | 9/20 [08:49<09:01, 49.22s/it]
Task 8, Epoch 10/20 => Loss 2.588, Loss_clf 0.314, Loss_fe 0.354, Loss_kd 1.813, Train_accy 75.43:  50%|█████     | 10/20 [08:49<07:52, 47.28s/it]
Task 8, Epoch 11/20 => Loss 2.548, Loss_clf 0.289, Loss_fe 0.318, Loss_kd 1.833, Train_accy 75.74, Test_accy 88.77:  50%|█████     | 10/20 [10:22<07:52, 47.28s/it]
Task 8, Epoch 11/20 => Loss 2.548, Loss_clf 0.289, Loss_fe 0.318, Loss_kd 1.833, Train_accy 75.74, Test_accy 88.77:  55%|█████▌    | 11/20 [10:22<09:11, 61.25s/it]
Task 8, Epoch 12/20 => Loss 2.518, Loss_clf 0.292, Loss_fe 0.309, Loss_kd 1.810, Train_accy 76.48:  55%|█████▌    | 11/20 [11:05<09:11, 61.25s/it]                 
Task 8, Epoch 12/20 => Loss 2.518, Loss_clf 0.292, Loss_fe 0.309, Loss_kd 1.810, Train_accy 76.48:  60%|██████    | 12/20 [11:05<07:25, 55.70s/it]
Task 8, Epoch 13/20 => Loss 2.490, Loss_clf 0.289, Loss_fe 0.292, Loss_kd 1.803, Train_accy 78.26:  60%|██████    | 12/20 [11:48<07:25, 55.70s/it]
Task 8, Epoch 13/20 => Loss 2.490, Loss_clf 0.289, Loss_fe 0.292, Loss_kd 1.803, Train_accy 78.26:  65%|██████▌   | 13/20 [11:48<06:03, 51.88s/it]
Task 8, Epoch 14/20 => Loss 2.543, Loss_clf 0.294, Loss_fe 0.309, Loss_kd 1.831, Train_accy 76.90:  65%|██████▌   | 13/20 [12:31<06:03, 51.88s/it]
Task 8, Epoch 14/20 => Loss 2.543, Loss_clf 0.294, Loss_fe 0.309, Loss_kd 1.831, Train_accy 76.90:  70%|███████   | 14/20 [12:31<04:55, 49.21s/it]
Task 8, Epoch 15/20 => Loss 2.527, Loss_clf 0.304, Loss_fe 0.305, Loss_kd 1.812, Train_accy 77.36:  70%|███████   | 14/20 [13:14<04:55, 49.21s/it]
Task 8, Epoch 15/20 => Loss 2.527, Loss_clf 0.304, Loss_fe 0.305, Loss_kd 1.812, Train_accy 77.36:  75%|███████▌  | 15/20 [13:14<03:56, 47.36s/it]
Task 8, Epoch 16/20 => Loss 2.546, Loss_clf 0.293, Loss_fe 0.292, Loss_kd 1.852, Train_accy 78.21, Test_accy 88.66:  75%|███████▌  | 15/20 [14:47<03:56, 47.36s/it]
Task 8, Epoch 16/20 => Loss 2.546, Loss_clf 0.293, Loss_fe 0.292, Loss_kd 1.852, Train_accy 78.21, Test_accy 88.66:  80%|████████  | 16/20 [14:47<04:04, 61.06s/it]
Task 8, Epoch 17/20 => Loss 2.426, Loss_clf 0.263, Loss_fe 0.261, Loss_kd 1.796, Train_accy 78.90:  80%|████████  | 16/20 [15:30<04:04, 61.06s/it]                 
Task 8, Epoch 17/20 => Loss 2.426, Loss_clf 0.263, Loss_fe 0.261, Loss_kd 1.796, Train_accy 78.90:  85%|████████▌ | 17/20 [15:30<02:46, 55.62s/it]
Task 8, Epoch 18/20 => Loss 2.433, Loss_clf 0.267, Loss_fe 0.255, Loss_kd 1.805, Train_accy 78.43:  85%|████████▌ | 17/20 [16:13<02:46, 55.62s/it]
Task 8, Epoch 18/20 => Loss 2.433, Loss_clf 0.267, Loss_fe 0.255, Loss_kd 1.805, Train_accy 78.43:  90%|█████████ | 18/20 [16:13<01:43, 51.80s/it]
Task 8, Epoch 19/20 => Loss 2.367, Loss_clf 0.243, Loss_fe 0.227, Loss_kd 1.791, Train_accy 78.43:  90%|█████████ | 18/20 [16:56<01:43, 51.80s/it]
Task 8, Epoch 19/20 => Loss 2.367, Loss_clf 0.243, Loss_fe 0.227, Loss_kd 1.791, Train_accy 78.43:  95%|█████████▌| 19/20 [16:56<00:49, 49.15s/it]
Task 8, Epoch 20/20 => Loss 2.399, Loss_clf 0.252, Loss_fe 0.243, Loss_kd 1.798, Train_accy 79.14:  95%|█████████▌| 19/20 [17:39<00:49, 49.15s/it]
Task 8, Epoch 20/20 => Loss 2.399, Loss_clf 0.252, Loss_fe 0.243, Loss_kd 1.798, Train_accy 79.14: 100%|██████████| 20/20 [17:39<00:00, 47.29s/it]
Task 8, Epoch 20/20 => Loss 2.399, Loss_clf 0.252, Loss_fe 0.243, Loss_kd 1.798, Train_accy 79.14: 100%|██████████| 20/20 [17:39<00:00, 52.95s/it]
2024-09-05 22:41:51,864 [foster.py] => Task 8, Epoch 20/20 => Loss 2.399, Loss_clf 0.252, Loss_fe 0.243, Loss_kd 1.798, Train_accy 79.14
2024-09-05 22:41:51,865 [foster.py] => do not weight align teacher!
2024-09-05 22:41:51,869 [foster.py] => per cls weights : [1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 0.47041734 0.47041734 0.47041734 0.47041734 0.47041734]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.841,  Train_accy 61.83, Test_accy 88.46:   0%|          | 0/20 [01:19<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.841,  Train_accy 61.83, Test_accy 88.46:   5%|▌         | 1/20 [01:19<25:17, 79.88s/it]
SNet: Task 8, Epoch 2/20 => Loss 1.695,  Train_accy 66.07:   5%|▌         | 1/20 [02:13<25:17, 79.88s/it]                 
SNet: Task 8, Epoch 2/20 => Loss 1.695,  Train_accy 66.07:  10%|█         | 2/20 [02:13<19:23, 64.65s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.684,  Train_accy 67.17:  10%|█         | 2/20 [03:07<19:23, 64.65s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.684,  Train_accy 67.17:  15%|█▌        | 3/20 [03:07<16:56, 59.77s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.693,  Train_accy 66.79:  15%|█▌        | 3/20 [04:01<16:56, 59.77s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.693,  Train_accy 66.79:  20%|██        | 4/20 [04:01<15:19, 57.49s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.674,  Train_accy 67.21:  20%|██        | 4/20 [04:55<15:19, 57.49s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.674,  Train_accy 67.21:  25%|██▌       | 5/20 [04:55<14:03, 56.22s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.666,  Train_accy 67.36, Test_accy 88.52:  25%|██▌       | 5/20 [06:15<14:03, 56.22s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.666,  Train_accy 67.36, Test_accy 88.52:  30%|███       | 6/20 [06:15<15:00, 64.32s/it]
SNet: Task 8, Epoch 7/20 => Loss 1.667,  Train_accy 67.86:  30%|███       | 6/20 [07:09<15:00, 64.32s/it]                 
SNet: Task 8, Epoch 7/20 => Loss 1.667,  Train_accy 67.86:  35%|███▌      | 7/20 [07:09<13:12, 60.93s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.677,  Train_accy 67.67:  35%|███▌      | 7/20 [08:03<13:12, 60.93s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.677,  Train_accy 67.67:  40%|████      | 8/20 [08:03<11:44, 58.72s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.658,  Train_accy 66.81:  40%|████      | 8/20 [08:57<11:44, 58.72s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.658,  Train_accy 66.81:  45%|████▌     | 9/20 [08:57<10:29, 57.26s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.635,  Train_accy 68.29:  45%|████▌     | 9/20 [09:51<10:29, 57.26s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.635,  Train_accy 68.29:  50%|█████     | 10/20 [09:51<09:22, 56.25s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.673,  Train_accy 67.83, Test_accy 88.43:  50%|█████     | 10/20 [11:11<09:22, 56.25s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.673,  Train_accy 67.83, Test_accy 88.43:  55%|█████▌    | 11/20 [11:11<09:31, 63.49s/it]
SNet: Task 8, Epoch 12/20 => Loss 1.672,  Train_accy 67.40:  55%|█████▌    | 11/20 [12:05<09:31, 63.49s/it]                 
SNet: Task 8, Epoch 12/20 => Loss 1.672,  Train_accy 67.40:  60%|██████    | 12/20 [12:05<08:04, 60.61s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.647,  Train_accy 67.98:  60%|██████    | 12/20 [12:59<08:04, 60.61s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.647,  Train_accy 67.98:  65%|██████▌   | 13/20 [12:59<06:50, 58.64s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.646,  Train_accy 67.50:  65%|██████▌   | 13/20 [13:53<06:50, 58.64s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.646,  Train_accy 67.50:  70%|███████   | 14/20 [13:53<05:43, 57.25s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.659,  Train_accy 66.90:  70%|███████   | 14/20 [14:47<05:43, 57.25s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.659,  Train_accy 66.90:  75%|███████▌  | 15/20 [14:47<04:41, 56.28s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.660,  Train_accy 67.83, Test_accy 88.34:  75%|███████▌  | 15/20 [16:07<04:41, 56.28s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.660,  Train_accy 67.83, Test_accy 88.34:  80%|████████  | 16/20 [16:07<04:13, 63.43s/it]
SNet: Task 8, Epoch 17/20 => Loss 1.678,  Train_accy 67.57:  80%|████████  | 16/20 [17:02<04:13, 63.43s/it]                 
SNet: Task 8, Epoch 17/20 => Loss 1.678,  Train_accy 67.57:  85%|████████▌ | 17/20 [17:02<03:01, 60.61s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.663,  Train_accy 67.67:  85%|████████▌ | 17/20 [17:56<03:01, 60.61s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.663,  Train_accy 67.67:  90%|█████████ | 18/20 [17:56<01:57, 58.66s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.659,  Train_accy 67.76:  90%|█████████ | 18/20 [18:50<01:57, 58.66s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.659,  Train_accy 67.76:  95%|█████████▌| 19/20 [18:50<00:57, 57.31s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.636,  Train_accy 68.29:  95%|█████████▌| 19/20 [19:44<00:57, 57.31s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.636,  Train_accy 68.29: 100%|██████████| 20/20 [19:44<00:00, 56.34s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.636,  Train_accy 68.29: 100%|██████████| 20/20 [19:44<00:00, 59.22s/it]
2024-09-05 23:01:37,816 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.636,  Train_accy 68.29
2024-09-05 23:01:37,817 [foster.py] => do not weight align student!
2024-09-05 23:02:03,765 [foster.py] => darknet eval: 
2024-09-05 23:02:03,766 [foster.py] => CNN top1 curve: 88.32
2024-09-05 23:02:03,766 [foster.py] => CNN top5 curve: 99.0
2024-09-05 23:02:03,769 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 23:04:35,042 [foster.py] => Exemplar size: 1800
2024-09-05 23:04:35,042 [trainer.py] => CNN: {'total': 88.7, '00-49': 92.42, '50-54': 87.4, '55-59': 89.0, '60-64': 87.8, '65-69': 94.2, '70-74': 83.0, '75-79': 82.4, '80-84': 73.8, '85-89': 74.8, 'old': 89.52, 'new': 74.8}
2024-09-05 23:04:35,042 [trainer.py] => NME: {'total': 89.76, '00-49': 91.32, '50-54': 86.0, '55-59': 85.0, '60-64': 85.2, '65-69': 95.8, '70-74': 87.0, '75-79': 83.6, '80-84': 88.8, '85-89': 91.0, 'old': 89.68, 'new': 91.0}
2024-09-05 23:04:35,042 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77, 92.09, 90.83, 88.85, 87.98, 88.7]
2024-09-05 23:04:35,042 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31, 99.31, 99.16, 99.02, 99.2, 98.97]
2024-09-05 23:04:35,042 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66, 92.7, 91.55, 90.2, 90.51, 89.76]
2024-09-05 23:04:35,042 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42, 99.44, 99.28, 99.21, 99.19, 99.14]

Average Accuracy (CNN): 91.28
Average Accuracy (NME): 92.14
2024-09-05 23:04:35,042 [trainer.py] => Average Accuracy (CNN): 91.28
2024-09-05 23:04:35,042 [trainer.py] => Average Accuracy (NME): 92.14
2024-09-05 23:04:35,044 [trainer.py] => All params: 171870217
2024-09-05 23:04:35,045 [trainer.py] => Trainable params: 86006196
2024-09-05 23:04:36,593 [foster.py] => Learning on 90-95
2024-09-05 23:04:36,594 [foster.py] => All params: 171885592
2024-09-05 23:04:36,595 [foster.py] => Trainable params: 86017726
2024-09-05 23:04:36,715 [foster.py] => per cls weights : [1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 0.57128759 0.57128759 0.57128759 0.57128759 0.57128759]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 4.890, Loss_clf 0.764, Loss_fe 2.285, Loss_kd 1.744, Train_accy 69.07, Test_accy 88.08:   0%|          | 0/20 [01:36<?, ?it/s]
Task 9, Epoch 1/20 => Loss 4.890, Loss_clf 0.764, Loss_fe 2.285, Loss_kd 1.744, Train_accy 69.07, Test_accy 88.08:   5%|▌         | 1/20 [01:36<30:34, 96.54s/it]
Task 9, Epoch 2/20 => Loss 3.077, Loss_clf 0.384, Loss_fe 0.862, Loss_kd 1.735, Train_accy 74.86:   5%|▌         | 1/20 [02:20<30:34, 96.54s/it]                 
Task 9, Epoch 2/20 => Loss 3.077, Loss_clf 0.384, Loss_fe 0.862, Loss_kd 1.735, Train_accy 74.86:  10%|█         | 2/20 [02:20<19:41, 65.66s/it]
Task 9, Epoch 3/20 => Loss 2.797, Loss_clf 0.354, Loss_fe 0.582, Loss_kd 1.763, Train_accy 74.84:  10%|█         | 2/20 [03:04<19:41, 65.66s/it]
Task 9, Epoch 3/20 => Loss 2.797, Loss_clf 0.354, Loss_fe 0.582, Loss_kd 1.763, Train_accy 74.84:  15%|█▌        | 3/20 [03:04<15:48, 55.80s/it]
Task 9, Epoch 4/20 => Loss 2.601, Loss_clf 0.302, Loss_fe 0.475, Loss_kd 1.728, Train_accy 75.84:  15%|█▌        | 3/20 [03:48<15:48, 55.80s/it]
Task 9, Epoch 4/20 => Loss 2.601, Loss_clf 0.302, Loss_fe 0.475, Loss_kd 1.728, Train_accy 75.84:  20%|██        | 4/20 [03:48<13:38, 51.16s/it]
Task 9, Epoch 5/20 => Loss 2.613, Loss_clf 0.310, Loss_fe 0.451, Loss_kd 1.754, Train_accy 77.21:  20%|██        | 4/20 [04:32<13:38, 51.16s/it]
Task 9, Epoch 5/20 => Loss 2.613, Loss_clf 0.310, Loss_fe 0.451, Loss_kd 1.754, Train_accy 77.21:  25%|██▌       | 5/20 [04:32<12:09, 48.61s/it]
Task 9, Epoch 6/20 => Loss 2.577, Loss_clf 0.317, Loss_fe 0.415, Loss_kd 1.748, Train_accy 75.12, Test_accy 88.86:  25%|██▌       | 5/20 [06:09<12:09, 48.61s/it]
Task 9, Epoch 6/20 => Loss 2.577, Loss_clf 0.317, Loss_fe 0.415, Loss_kd 1.748, Train_accy 75.12, Test_accy 88.86:  30%|███       | 6/20 [06:09<15:10, 65.02s/it]
Task 9, Epoch 7/20 => Loss 2.507, Loss_clf 0.296, Loss_fe 0.366, Loss_kd 1.747, Train_accy 76.49:  30%|███       | 6/20 [06:53<15:10, 65.02s/it]                 
Task 9, Epoch 7/20 => Loss 2.507, Loss_clf 0.296, Loss_fe 0.366, Loss_kd 1.747, Train_accy 76.49:  35%|███▌      | 7/20 [06:53<12:36, 58.22s/it]
Task 9, Epoch 8/20 => Loss 2.473, Loss_clf 0.278, Loss_fe 0.353, Loss_kd 1.745, Train_accy 76.86:  35%|███▌      | 7/20 [07:38<12:36, 58.22s/it]
Task 9, Epoch 8/20 => Loss 2.473, Loss_clf 0.278, Loss_fe 0.353, Loss_kd 1.745, Train_accy 76.86:  40%|████      | 8/20 [07:38<10:44, 53.75s/it]
Task 9, Epoch 9/20 => Loss 2.485, Loss_clf 0.292, Loss_fe 0.347, Loss_kd 1.749, Train_accy 77.58:  40%|████      | 8/20 [08:22<10:44, 53.75s/it]
Task 9, Epoch 9/20 => Loss 2.485, Loss_clf 0.292, Loss_fe 0.347, Loss_kd 1.749, Train_accy 77.58:  45%|████▌     | 9/20 [08:22<09:18, 50.73s/it]
Task 9, Epoch 10/20 => Loss 2.378, Loss_clf 0.246, Loss_fe 0.301, Loss_kd 1.735, Train_accy 78.14:  45%|████▌     | 9/20 [09:06<09:18, 50.73s/it]
Task 9, Epoch 10/20 => Loss 2.378, Loss_clf 0.246, Loss_fe 0.301, Loss_kd 1.735, Train_accy 78.14:  50%|█████     | 10/20 [09:06<08:06, 48.68s/it]
Task 9, Epoch 11/20 => Loss 2.357, Loss_clf 0.253, Loss_fe 0.283, Loss_kd 1.725, Train_accy 78.30, Test_accy 88.88:  50%|█████     | 10/20 [10:42<08:06, 48.68s/it]
Task 9, Epoch 11/20 => Loss 2.357, Loss_clf 0.253, Loss_fe 0.283, Loss_kd 1.725, Train_accy 78.30, Test_accy 88.88:  55%|█████▌    | 11/20 [10:42<09:30, 63.35s/it]
Task 9, Epoch 12/20 => Loss 2.325, Loss_clf 0.238, Loss_fe 0.263, Loss_kd 1.729, Train_accy 79.60:  55%|█████▌    | 11/20 [11:26<09:30, 63.35s/it]                 
Task 9, Epoch 12/20 => Loss 2.325, Loss_clf 0.238, Loss_fe 0.263, Loss_kd 1.729, Train_accy 79.60:  60%|██████    | 12/20 [11:26<07:39, 57.47s/it]
Task 9, Epoch 13/20 => Loss 2.387, Loss_clf 0.267, Loss_fe 0.278, Loss_kd 1.745, Train_accy 78.26:  60%|██████    | 12/20 [12:10<07:39, 57.47s/it]
Task 9, Epoch 13/20 => Loss 2.387, Loss_clf 0.267, Loss_fe 0.278, Loss_kd 1.745, Train_accy 78.26:  65%|██████▌   | 13/20 [12:10<06:13, 53.38s/it]
Task 9, Epoch 14/20 => Loss 2.414, Loss_clf 0.267, Loss_fe 0.283, Loss_kd 1.766, Train_accy 76.93:  65%|██████▌   | 13/20 [12:54<06:13, 53.38s/it]
Task 9, Epoch 14/20 => Loss 2.414, Loss_clf 0.267, Loss_fe 0.283, Loss_kd 1.766, Train_accy 76.93:  70%|███████   | 14/20 [12:54<05:03, 50.54s/it]
Task 9, Epoch 15/20 => Loss 2.334, Loss_clf 0.246, Loss_fe 0.247, Loss_kd 1.744, Train_accy 78.67:  70%|███████   | 14/20 [13:38<05:03, 50.54s/it]
Task 9, Epoch 15/20 => Loss 2.334, Loss_clf 0.246, Loss_fe 0.247, Loss_kd 1.744, Train_accy 78.67:  75%|███████▌  | 15/20 [13:38<04:02, 48.56s/it]
Task 9, Epoch 16/20 => Loss 2.271, Loss_clf 0.226, Loss_fe 0.233, Loss_kd 1.716, Train_accy 78.56, Test_accy 88.85:  75%|███████▌  | 15/20 [15:15<04:02, 48.56s/it]
Task 9, Epoch 16/20 => Loss 2.271, Loss_clf 0.226, Loss_fe 0.233, Loss_kd 1.716, Train_accy 78.56, Test_accy 88.85:  80%|████████  | 16/20 [15:15<04:12, 63.05s/it]
Task 9, Epoch 17/20 => Loss 2.301, Loss_clf 0.246, Loss_fe 0.229, Loss_kd 1.729, Train_accy 79.00:  80%|████████  | 16/20 [15:59<04:12, 63.05s/it]                 
Task 9, Epoch 17/20 => Loss 2.301, Loss_clf 0.246, Loss_fe 0.229, Loss_kd 1.729, Train_accy 79.00:  85%|████████▌ | 17/20 [15:59<02:51, 57.32s/it]
Task 9, Epoch 18/20 => Loss 2.302, Loss_clf 0.234, Loss_fe 0.223, Loss_kd 1.747, Train_accy 78.67:  85%|████████▌ | 17/20 [16:43<02:51, 57.32s/it]
Task 9, Epoch 18/20 => Loss 2.302, Loss_clf 0.234, Loss_fe 0.223, Loss_kd 1.747, Train_accy 78.67:  90%|█████████ | 18/20 [16:43<01:46, 53.31s/it]
Task 9, Epoch 19/20 => Loss 2.272, Loss_clf 0.225, Loss_fe 0.213, Loss_kd 1.737, Train_accy 79.49:  90%|█████████ | 18/20 [17:27<01:46, 53.31s/it]
Task 9, Epoch 19/20 => Loss 2.272, Loss_clf 0.225, Loss_fe 0.213, Loss_kd 1.737, Train_accy 79.49:  95%|█████████▌| 19/20 [17:27<00:50, 50.49s/it]
Task 9, Epoch 20/20 => Loss 2.278, Loss_clf 0.226, Loss_fe 0.212, Loss_kd 1.743, Train_accy 79.19:  95%|█████████▌| 19/20 [18:11<00:50, 50.49s/it]
Task 9, Epoch 20/20 => Loss 2.278, Loss_clf 0.226, Loss_fe 0.212, Loss_kd 1.743, Train_accy 79.19: 100%|██████████| 20/20 [18:11<00:00, 48.55s/it]
Task 9, Epoch 20/20 => Loss 2.278, Loss_clf 0.226, Loss_fe 0.212, Loss_kd 1.743, Train_accy 79.19: 100%|██████████| 20/20 [18:11<00:00, 54.57s/it]
2024-09-05 23:22:48,116 [foster.py] => Task 9, Epoch 20/20 => Loss 2.278, Loss_clf 0.226, Loss_fe 0.212, Loss_kd 1.743, Train_accy 79.19
2024-09-05 23:22:48,117 [foster.py] => do not weight align teacher!
2024-09-05 23:22:48,120 [foster.py] => per cls weights : [1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 0.46964732 0.46964732 0.46964732 0.46964732 0.46964732]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.667,  Train_accy 64.30, Test_accy 88.46:   0%|          | 0/20 [01:22<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.667,  Train_accy 64.30, Test_accy 88.46:   5%|▌         | 1/20 [01:22<26:09, 82.59s/it]
SNet: Task 9, Epoch 2/20 => Loss 1.517,  Train_accy 67.35:   5%|▌         | 1/20 [02:17<26:09, 82.59s/it]                 
SNet: Task 9, Epoch 2/20 => Loss 1.517,  Train_accy 67.35:  10%|█         | 2/20 [02:17<19:57, 66.52s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.510,  Train_accy 68.19:  10%|█         | 2/20 [03:13<19:57, 66.52s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.510,  Train_accy 68.19:  15%|█▌        | 3/20 [03:13<17:24, 61.43s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.513,  Train_accy 68.91:  15%|█▌        | 3/20 [04:08<17:24, 61.43s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.513,  Train_accy 68.91:  20%|██        | 4/20 [04:08<15:44, 59.03s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.506,  Train_accy 69.02:  20%|██        | 4/20 [05:04<15:44, 59.03s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.506,  Train_accy 69.02:  25%|██▌       | 5/20 [05:04<14:25, 57.73s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.505,  Train_accy 69.00, Test_accy 88.64:  25%|██▌       | 5/20 [06:26<14:25, 57.73s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.505,  Train_accy 69.00, Test_accy 88.64:  30%|███       | 6/20 [06:26<15:27, 66.22s/it]
SNet: Task 9, Epoch 7/20 => Loss 1.488,  Train_accy 69.05:  30%|███       | 6/20 [07:22<15:27, 66.22s/it]                 
SNet: Task 9, Epoch 7/20 => Loss 1.488,  Train_accy 69.05:  35%|███▌      | 7/20 [07:22<13:34, 62.68s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.493,  Train_accy 68.49:  35%|███▌      | 7/20 [08:17<13:34, 62.68s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.493,  Train_accy 68.49:  40%|████      | 8/20 [08:17<12:03, 60.32s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.508,  Train_accy 68.70:  40%|████      | 8/20 [09:13<12:03, 60.32s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.508,  Train_accy 68.70:  45%|████▌     | 9/20 [09:13<10:47, 58.86s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.494,  Train_accy 68.91:  45%|████▌     | 9/20 [10:08<10:47, 58.86s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.494,  Train_accy 68.91:  50%|█████     | 10/20 [10:08<09:38, 57.89s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.488,  Train_accy 68.53, Test_accy 88.59:  50%|█████     | 10/20 [11:31<09:38, 57.89s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.488,  Train_accy 68.53, Test_accy 88.59:  55%|█████▌    | 11/20 [11:31<09:50, 65.56s/it]
SNet: Task 9, Epoch 12/20 => Loss 1.498,  Train_accy 68.63:  55%|█████▌    | 11/20 [12:27<09:50, 65.56s/it]                 
SNet: Task 9, Epoch 12/20 => Loss 1.498,  Train_accy 68.63:  60%|██████    | 12/20 [12:27<08:19, 62.47s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.473,  Train_accy 68.98:  60%|██████    | 12/20 [13:22<08:19, 62.47s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.473,  Train_accy 68.98:  65%|██████▌   | 13/20 [13:22<07:02, 60.32s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.492,  Train_accy 68.98:  65%|██████▌   | 13/20 [14:17<07:02, 60.32s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.492,  Train_accy 68.98:  70%|███████   | 14/20 [14:17<05:52, 58.81s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.495,  Train_accy 69.19:  70%|███████   | 14/20 [15:13<05:52, 58.81s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.495,  Train_accy 69.19:  75%|███████▌  | 15/20 [15:13<04:48, 57.76s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.514,  Train_accy 69.12, Test_accy 88.57:  75%|███████▌  | 15/20 [16:35<04:48, 57.76s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.514,  Train_accy 69.12, Test_accy 88.57:  80%|████████  | 16/20 [16:35<04:21, 65.26s/it]
SNet: Task 9, Epoch 17/20 => Loss 1.476,  Train_accy 69.42:  80%|████████  | 16/20 [17:31<04:21, 65.26s/it]                 
SNet: Task 9, Epoch 17/20 => Loss 1.476,  Train_accy 69.42:  85%|████████▌ | 17/20 [17:31<03:06, 62.28s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.498,  Train_accy 69.33:  85%|████████▌ | 17/20 [18:26<03:06, 62.28s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.498,  Train_accy 69.33:  90%|█████████ | 18/20 [18:26<02:00, 60.19s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.478,  Train_accy 69.28:  90%|█████████ | 18/20 [19:21<02:00, 60.19s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.478,  Train_accy 69.28:  95%|█████████▌| 19/20 [19:21<00:58, 58.73s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.508,  Train_accy 68.98:  95%|█████████▌| 19/20 [20:17<00:58, 58.73s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.508,  Train_accy 68.98: 100%|██████████| 20/20 [20:17<00:00, 57.69s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.508,  Train_accy 68.98: 100%|██████████| 20/20 [20:17<00:00, 60.85s/it]
2024-09-05 23:43:06,723 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 1.508,  Train_accy 68.98
2024-09-05 23:43:06,723 [foster.py] => do not weight align student!
2024-09-05 23:43:34,165 [foster.py] => darknet eval: 
2024-09-05 23:43:34,166 [foster.py] => CNN top1 curve: 88.6
2024-09-05 23:43:34,166 [foster.py] => CNN top5 curve: 98.95
2024-09-05 23:43:34,168 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 23:46:11,868 [foster.py] => Exemplar size: 1900
2024-09-05 23:46:11,868 [trainer.py] => CNN: {'total': 88.97, '00-49': 92.18, '50-54': 88.2, '55-59': 88.2, '60-64': 87.6, '65-69': 95.0, '70-74': 83.8, '75-79': 84.0, '80-84': 83.4, '85-89': 80.6, '90-94': 77.8, 'old': 89.59, 'new': 77.8}
2024-09-05 23:46:11,868 [trainer.py] => NME: {'total': 89.63, '00-49': 91.3, '50-54': 83.6, '55-59': 86.2, '60-64': 84.8, '65-69': 95.8, '70-74': 87.6, '75-79': 80.8, '80-84': 89.6, '85-89': 86.2, '90-94': 95.4, 'old': 89.31, 'new': 95.4}
2024-09-05 23:46:11,869 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77, 92.09, 90.83, 88.85, 87.98, 88.7, 88.97]
2024-09-05 23:46:11,869 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31, 99.31, 99.16, 99.02, 99.2, 98.97, 98.83]
2024-09-05 23:46:11,869 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66, 92.7, 91.55, 90.2, 90.51, 89.76, 89.63]
2024-09-05 23:46:11,869 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42, 99.44, 99.28, 99.21, 99.19, 99.14, 98.94]

Average Accuracy (CNN): 91.05
Average Accuracy (NME): 91.89
2024-09-05 23:46:11,869 [trainer.py] => Average Accuracy (CNN): 91.05
2024-09-05 23:46:11,869 [trainer.py] => Average Accuracy (NME): 91.89
2024-09-05 23:46:11,870 [trainer.py] => All params: 171885592
2024-09-05 23:46:11,871 [trainer.py] => Trainable params: 86017726
2024-09-05 23:46:13,457 [foster.py] => Learning on 95-100
2024-09-05 23:46:13,458 [foster.py] => All params: 171900967
2024-09-05 23:46:13,459 [foster.py] => Trainable params: 86029256
2024-09-05 23:46:13,576 [foster.py] => per cls weights : [1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 0.57060807
 0.57060807 0.57060807 0.57060807 0.57060807]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 5.067, Loss_clf 0.815, Loss_fe 2.300, Loss_kd 1.855, Train_accy 67.86, Test_accy 88.17:   0%|          | 0/20 [01:40<?, ?it/s]
Task 10, Epoch 1/20 => Loss 5.067, Loss_clf 0.815, Loss_fe 2.300, Loss_kd 1.855, Train_accy 67.86, Test_accy 88.17:   5%|▌         | 1/20 [01:40<31:42, 100.12s/it]
Task 10, Epoch 2/20 => Loss 3.324, Loss_clf 0.475, Loss_fe 0.898, Loss_kd 1.853, Train_accy 73.36:   5%|▌         | 1/20 [02:25<31:42, 100.12s/it]                 
Task 10, Epoch 2/20 => Loss 3.324, Loss_clf 0.475, Loss_fe 0.898, Loss_kd 1.853, Train_accy 73.36:  10%|█         | 2/20 [02:25<20:18, 67.68s/it] 
Task 10, Epoch 3/20 => Loss 2.993, Loss_clf 0.422, Loss_fe 0.635, Loss_kd 1.840, Train_accy 73.48:  10%|█         | 2/20 [03:10<20:18, 67.68s/it]
Task 10, Epoch 3/20 => Loss 2.993, Loss_clf 0.422, Loss_fe 0.635, Loss_kd 1.840, Train_accy 73.48:  15%|█▌        | 3/20 [03:10<16:14, 57.32s/it]
Task 10, Epoch 4/20 => Loss 2.883, Loss_clf 0.386, Loss_fe 0.552, Loss_kd 1.848, Train_accy 73.02:  15%|█▌        | 3/20 [03:55<16:14, 57.32s/it]
Task 10, Epoch 4/20 => Loss 2.883, Loss_clf 0.386, Loss_fe 0.552, Loss_kd 1.848, Train_accy 73.02:  20%|██        | 4/20 [03:55<13:59, 52.44s/it]
Task 10, Epoch 5/20 => Loss 2.794, Loss_clf 0.375, Loss_fe 0.483, Loss_kd 1.840, Train_accy 73.75:  20%|██        | 4/20 [04:40<13:59, 52.44s/it]
Task 10, Epoch 5/20 => Loss 2.794, Loss_clf 0.375, Loss_fe 0.483, Loss_kd 1.840, Train_accy 73.75:  25%|██▌       | 5/20 [04:40<12:26, 49.75s/it]
Task 10, Epoch 6/20 => Loss 2.764, Loss_clf 0.366, Loss_fe 0.468, Loss_kd 1.834, Train_accy 73.70, Test_accy 88.57:  25%|██▌       | 5/20 [06:20<12:26, 49.75s/it]
Task 10, Epoch 6/20 => Loss 2.764, Loss_clf 0.366, Loss_fe 0.468, Loss_kd 1.834, Train_accy 73.70, Test_accy 88.57:  30%|███       | 6/20 [06:20<15:37, 66.98s/it]
Task 10, Epoch 7/20 => Loss 2.688, Loss_clf 0.343, Loss_fe 0.423, Loss_kd 1.826, Train_accy 75.07:  30%|███       | 6/20 [07:05<15:37, 66.98s/it]                 
Task 10, Epoch 7/20 => Loss 2.688, Loss_clf 0.343, Loss_fe 0.423, Loss_kd 1.826, Train_accy 75.07:  35%|███▌      | 7/20 [07:05<12:57, 59.80s/it]
Task 10, Epoch 8/20 => Loss 2.597, Loss_clf 0.316, Loss_fe 0.381, Loss_kd 1.805, Train_accy 76.75:  35%|███▌      | 7/20 [07:50<12:57, 59.80s/it]
Task 10, Epoch 8/20 => Loss 2.597, Loss_clf 0.316, Loss_fe 0.381, Loss_kd 1.805, Train_accy 76.75:  40%|████      | 8/20 [07:50<11:01, 55.08s/it]
Task 10, Epoch 9/20 => Loss 2.618, Loss_clf 0.320, Loss_fe 0.372, Loss_kd 1.830, Train_accy 76.93:  40%|████      | 8/20 [08:35<11:01, 55.08s/it]
Task 10, Epoch 9/20 => Loss 2.618, Loss_clf 0.320, Loss_fe 0.372, Loss_kd 1.830, Train_accy 76.93:  45%|████▌     | 9/20 [08:35<09:31, 51.92s/it]
Task 10, Epoch 10/20 => Loss 2.668, Loss_clf 0.340, Loss_fe 0.375, Loss_kd 1.856, Train_accy 76.57:  45%|████▌     | 9/20 [09:20<09:31, 51.92s/it]
Task 10, Epoch 10/20 => Loss 2.668, Loss_clf 0.340, Loss_fe 0.375, Loss_kd 1.856, Train_accy 76.57:  50%|█████     | 10/20 [09:20<08:17, 49.79s/it]
Task 10, Epoch 11/20 => Loss 2.594, Loss_clf 0.320, Loss_fe 0.338, Loss_kd 1.840, Train_accy 76.50, Test_accy 88.43:  50%|█████     | 10/20 [11:00<08:17, 49.79s/it]
Task 10, Epoch 11/20 => Loss 2.594, Loss_clf 0.320, Loss_fe 0.338, Loss_kd 1.840, Train_accy 76.50, Test_accy 88.43:  55%|█████▌    | 11/20 [11:00<09:47, 65.23s/it]
Task 10, Epoch 12/20 => Loss 2.556, Loss_clf 0.310, Loss_fe 0.323, Loss_kd 1.827, Train_accy 76.70:  55%|█████▌    | 11/20 [11:45<09:47, 65.23s/it]                 
Task 10, Epoch 12/20 => Loss 2.556, Loss_clf 0.310, Loss_fe 0.323, Loss_kd 1.827, Train_accy 76.70:  60%|██████    | 12/20 [11:45<07:52, 59.07s/it]
Task 10, Epoch 13/20 => Loss 2.510, Loss_clf 0.290, Loss_fe 0.298, Loss_kd 1.826, Train_accy 78.50:  60%|██████    | 12/20 [12:30<07:52, 59.07s/it]
Task 10, Epoch 13/20 => Loss 2.510, Loss_clf 0.290, Loss_fe 0.298, Loss_kd 1.826, Train_accy 78.50:  65%|██████▌   | 13/20 [12:30<06:23, 54.79s/it]
Task 10, Epoch 14/20 => Loss 2.557, Loss_clf 0.302, Loss_fe 0.303, Loss_kd 1.855, Train_accy 78.64:  65%|██████▌   | 13/20 [13:15<06:23, 54.79s/it]
Task 10, Epoch 14/20 => Loss 2.557, Loss_clf 0.302, Loss_fe 0.303, Loss_kd 1.855, Train_accy 78.64:  70%|███████   | 14/20 [13:15<05:10, 51.83s/it]
Task 10, Epoch 15/20 => Loss 2.541, Loss_clf 0.298, Loss_fe 0.294, Loss_kd 1.852, Train_accy 78.07:  70%|███████   | 14/20 [14:00<05:10, 51.83s/it]
Task 10, Epoch 15/20 => Loss 2.541, Loss_clf 0.298, Loss_fe 0.294, Loss_kd 1.852, Train_accy 78.07:  75%|███████▌  | 15/20 [14:00<04:08, 49.76s/it]
Task 10, Epoch 16/20 => Loss 2.447, Loss_clf 0.271, Loss_fe 0.253, Loss_kd 1.827, Train_accy 79.00, Test_accy 88.64:  75%|███████▌  | 15/20 [15:40<04:08, 49.76s/it]
Task 10, Epoch 16/20 => Loss 2.447, Loss_clf 0.271, Loss_fe 0.253, Loss_kd 1.827, Train_accy 79.00, Test_accy 88.64:  80%|████████  | 16/20 [15:40<04:19, 65.00s/it]
Task 10, Epoch 17/20 => Loss 2.479, Loss_clf 0.286, Loss_fe 0.261, Loss_kd 1.835, Train_accy 77.23:  80%|████████  | 16/20 [16:25<04:19, 65.00s/it]                 
Task 10, Epoch 17/20 => Loss 2.479, Loss_clf 0.286, Loss_fe 0.261, Loss_kd 1.835, Train_accy 77.23:  85%|████████▌ | 17/20 [16:25<02:56, 58.97s/it]
Task 10, Epoch 18/20 => Loss 2.438, Loss_clf 0.266, Loss_fe 0.256, Loss_kd 1.820, Train_accy 79.39:  85%|████████▌ | 17/20 [17:10<02:56, 58.97s/it]
Task 10, Epoch 18/20 => Loss 2.438, Loss_clf 0.266, Loss_fe 0.256, Loss_kd 1.820, Train_accy 79.39:  90%|█████████ | 18/20 [17:10<01:49, 54.77s/it]
Task 10, Epoch 19/20 => Loss 2.359, Loss_clf 0.240, Loss_fe 0.221, Loss_kd 1.804, Train_accy 79.84:  90%|█████████ | 18/20 [17:55<01:49, 54.77s/it]
Task 10, Epoch 19/20 => Loss 2.359, Loss_clf 0.240, Loss_fe 0.221, Loss_kd 1.804, Train_accy 79.84:  95%|█████████▌| 19/20 [17:55<00:51, 51.81s/it]
Task 10, Epoch 20/20 => Loss 2.447, Loss_clf 0.268, Loss_fe 0.248, Loss_kd 1.835, Train_accy 80.45:  95%|█████████▌| 19/20 [18:40<00:51, 51.81s/it]
Task 10, Epoch 20/20 => Loss 2.447, Loss_clf 0.268, Loss_fe 0.248, Loss_kd 1.835, Train_accy 80.45: 100%|██████████| 20/20 [18:40<00:00, 49.78s/it]
Task 10, Epoch 20/20 => Loss 2.447, Loss_clf 0.268, Loss_fe 0.248, Loss_kd 1.835, Train_accy 80.45: 100%|██████████| 20/20 [18:40<00:00, 56.04s/it]
2024-09-06 00:04:54,414 [foster.py] => Task 10, Epoch 20/20 => Loss 2.447, Loss_clf 0.268, Loss_fe 0.248, Loss_kd 1.835, Train_accy 80.45
2024-09-06 00:04:54,415 [foster.py] => do not weight align teacher!
2024-09-06 00:04:54,419 [foster.py] => per cls weights : [1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 0.46895645
 0.46895645 0.46895645 0.46895645 0.46895645]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 1.860,  Train_accy 63.68, Test_accy 88.52:   0%|          | 0/20 [01:25<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 1.860,  Train_accy 63.68, Test_accy 88.52:   5%|▌         | 1/20 [01:25<26:59, 85.22s/it]
SNet: Task 10, Epoch 2/20 => Loss 1.679,  Train_accy 68.75:   5%|▌         | 1/20 [02:21<26:59, 85.22s/it]                 
SNet: Task 10, Epoch 2/20 => Loss 1.679,  Train_accy 68.75:  10%|█         | 2/20 [02:21<20:29, 68.31s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.688,  Train_accy 68.98:  10%|█         | 2/20 [03:18<20:29, 68.31s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.688,  Train_accy 68.98:  15%|█▌        | 3/20 [03:18<17:51, 63.02s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.704,  Train_accy 68.41:  15%|█▌        | 3/20 [04:15<17:51, 63.02s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.704,  Train_accy 68.41:  20%|██        | 4/20 [04:15<16:08, 60.55s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.684,  Train_accy 69.34:  20%|██        | 4/20 [05:11<16:08, 60.55s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.684,  Train_accy 69.34:  25%|██▌       | 5/20 [05:11<14:47, 59.15s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.679,  Train_accy 69.36, Test_accy 88.74:  25%|██▌       | 5/20 [06:37<14:47, 59.15s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.679,  Train_accy 69.36, Test_accy 88.74:  30%|███       | 6/20 [06:37<15:53, 68.09s/it]
SNet: Task 10, Epoch 7/20 => Loss 1.674,  Train_accy 69.09:  30%|███       | 6/20 [07:33<15:53, 68.09s/it]                 
SNet: Task 10, Epoch 7/20 => Loss 1.674,  Train_accy 69.09:  35%|███▌      | 7/20 [07:33<13:56, 64.35s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.666,  Train_accy 69.11:  35%|███▌      | 7/20 [08:30<13:56, 64.35s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.666,  Train_accy 69.11:  40%|████      | 8/20 [08:30<12:22, 61.90s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.684,  Train_accy 69.57:  40%|████      | 8/20 [09:27<12:22, 61.90s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.684,  Train_accy 69.57:  45%|████▌     | 9/20 [09:27<11:02, 60.24s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.684,  Train_accy 69.11:  45%|████▌     | 9/20 [10:23<11:02, 60.24s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.684,  Train_accy 69.11:  50%|█████     | 10/20 [10:23<09:50, 59.08s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.697,  Train_accy 69.16, Test_accy 88.71:  50%|█████     | 10/20 [11:48<09:50, 59.08s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.697,  Train_accy 69.16, Test_accy 88.71:  55%|█████▌    | 11/20 [11:48<10:03, 67.10s/it]
SNet: Task 10, Epoch 12/20 => Loss 1.644,  Train_accy 70.57:  55%|█████▌    | 11/20 [12:45<10:03, 67.10s/it]                 
SNet: Task 10, Epoch 12/20 => Loss 1.644,  Train_accy 70.57:  60%|██████    | 12/20 [12:45<08:30, 63.87s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.692,  Train_accy 69.09:  60%|██████    | 12/20 [13:41<08:30, 63.87s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.692,  Train_accy 69.09:  65%|██████▌   | 13/20 [13:41<07:11, 61.65s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.703,  Train_accy 69.30:  65%|██████▌   | 13/20 [14:38<07:11, 61.65s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.703,  Train_accy 69.30:  70%|███████   | 14/20 [14:38<06:00, 60.09s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.680,  Train_accy 69.36:  70%|███████   | 14/20 [15:35<06:00, 60.09s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.680,  Train_accy 69.36:  75%|███████▌  | 15/20 [15:35<04:55, 59.04s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.674,  Train_accy 69.36, Test_accy 88.66:  75%|███████▌  | 15/20 [17:00<04:55, 59.04s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.674,  Train_accy 69.36, Test_accy 88.66:  80%|████████  | 16/20 [17:00<04:27, 66.92s/it]
SNet: Task 10, Epoch 17/20 => Loss 1.653,  Train_accy 69.82:  80%|████████  | 16/20 [17:56<04:27, 66.92s/it]                 
SNet: Task 10, Epoch 17/20 => Loss 1.653,  Train_accy 69.82:  85%|████████▌ | 17/20 [17:56<03:11, 63.80s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.671,  Train_accy 68.91:  85%|████████▌ | 17/20 [18:53<03:11, 63.80s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.671,  Train_accy 68.91:  90%|█████████ | 18/20 [18:53<02:03, 61.61s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.690,  Train_accy 70.11:  90%|█████████ | 18/20 [19:49<02:03, 61.61s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.690,  Train_accy 70.11:  95%|█████████▌| 19/20 [19:49<01:00, 60.08s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.686,  Train_accy 70.05:  95%|█████████▌| 19/20 [20:46<01:00, 60.08s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.686,  Train_accy 70.05: 100%|██████████| 20/20 [20:46<00:00, 59.03s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.686,  Train_accy 70.05: 100%|██████████| 20/20 [20:46<00:00, 62.32s/it]
2024-09-06 00:25:42,532 [foster.py] => SNet: Task 10, Epoch 20/20 => Loss 1.686,  Train_accy 70.05
2024-09-06 00:25:42,533 [foster.py] => do not weight align student!
2024-09-06 00:26:11,257 [foster.py] => darknet eval: 
2024-09-06 00:26:11,257 [foster.py] => CNN top1 curve: 88.68
2024-09-06 00:26:11,258 [foster.py] => CNN top5 curve: 98.81
2024-09-06 00:26:11,260 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-06 00:28:55,246 [foster.py] => Exemplar size: 2000
2024-09-06 00:28:55,246 [trainer.py] => CNN: {'total': 88.56, '00-49': 91.9, '50-54': 86.6, '55-59': 88.2, '60-64': 85.8, '65-69': 95.4, '70-74': 83.2, '75-79': 82.8, '80-84': 84.8, '85-89': 83.4, '90-94': 85.6, '95-99': 76.4, 'old': 89.2, 'new': 76.4}
2024-09-06 00:28:55,246 [trainer.py] => NME: {'total': 89.31, '00-49': 91.08, '50-54': 83.4, '55-59': 86.2, '60-64': 83.4, '65-69': 95.2, '70-74': 86.8, '75-79': 80.4, '80-84': 89.2, '85-89': 86.0, '90-94': 93.4, '95-99': 91.4, 'old': 89.2, 'new': 91.4}
2024-09-06 00:28:55,246 [trainer.py] => CNN top1 curve: [94.9, 93.15, 93.27, 91.77, 92.09, 90.83, 88.85, 87.98, 88.7, 88.97, 88.56]
2024-09-06 00:28:55,246 [trainer.py] => CNN top5 curve: [99.58, 99.51, 99.43, 99.31, 99.31, 99.16, 99.02, 99.2, 98.97, 98.83, 98.78]
2024-09-06 00:28:55,246 [trainer.py] => NME top1 curve: [94.84, 93.53, 93.5, 92.66, 92.7, 91.55, 90.2, 90.51, 89.76, 89.63, 89.31]
2024-09-06 00:28:55,246 [trainer.py] => NME top5 curve: [99.58, 99.58, 99.5, 99.42, 99.44, 99.28, 99.21, 99.19, 99.14, 98.94, 98.86]

Average Accuracy (CNN): 90.82
Average Accuracy (NME): 91.65
2024-09-06 00:28:55,246 [trainer.py] => Average Accuracy (CNN): 90.82
2024-09-06 00:28:55,247 [trainer.py] => Average Accuracy (NME): 91.65
Accuracy Matrix (CNN):
[[94.9  94.68 94.56 94.1  93.94 93.52 93.48 92.8  92.42 92.18 91.9 ]
 [ 0.   77.8  84.4  88.8  90.6  90.4  90.4  90.2  87.4  88.2  86.6 ]
 [ 0.    0.   89.2  90.6  92.6  91.8  92.   90.   89.   88.2  88.2 ]
 [ 0.    0.    0.   72.6  82.   83.8  85.4  87.2  87.8  87.6  85.8 ]
 [ 0.    0.    0.    0.   84.6  89.4  93.2  94.8  94.2  95.   95.4 ]
 [ 0.    0.    0.    0.    0.   71.8  73.8  80.   83.   83.8  83.2 ]
 [ 0.    0.    0.    0.    0.    0.   52.   71.   82.4  84.   82.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.   54.4  73.8  83.4  84.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   74.8  80.6  83.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   77.8  85.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   76.4 ]]
2024-09-06 00:28:55,248 [trainer.py] => Forgetting (CNN): 1.519999999999999
Accuracy Matrix (NME):
[[94.84 93.46 93.72 93.56 93.3  92.74 92.18 91.86 91.32 91.3  91.08]
 [ 0.   94.2  90.4  90.4  90.4  89.8  81.2  86.   86.   83.6  83.4 ]
 [ 0.    0.   94.4  82.2  87.8  85.   84.2  86.4  85.   86.2  86.2 ]
 [ 0.    0.    0.   96.4  89.   81.   85.   84.6  85.2  84.8  83.4 ]
 [ 0.    0.    0.    0.   97.6  95.4  96.   96.6  95.8  95.8  95.2 ]
 [ 0.    0.    0.    0.    0.   94.6  83.4  88.   87.   87.6  86.8 ]
 [ 0.    0.    0.    0.    0.    0.   91.6  82.8  83.6  80.8  80.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.   95.6  88.8  89.6  89.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   91.   86.2  86.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   95.4  93.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   91.4 ]]
2024-09-06 00:28:55,248 [trainer.py] => Forgetting (NME): 7.055999999999997
2024-08-23 19:25:34,477 [trainer.py] => config: ./exps/l2p_cifar_B0_Inc5.json
2024-08-23 19:25:34,478 [trainer.py] => prefix:  
2024-08-23 19:25:34,478 [trainer.py] => dataset: cifar224
2024-08-23 19:25:34,478 [trainer.py] => memory_size: 0
2024-08-23 19:25:34,478 [trainer.py] => memory_per_class: 0
2024-08-23 19:25:34,478 [trainer.py] => fixed_memory: False
2024-08-23 19:25:34,479 [trainer.py] => shuffle: True
2024-08-23 19:25:34,479 [trainer.py] => init_cls: 20
2024-08-23 19:25:34,479 [trainer.py] => increment: 20
2024-08-23 19:25:34,479 [trainer.py] => model_name: l2p
2024-08-23 19:25:34,479 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-08-23 19:25:34,484 [trainer.py] => get_original_backbone: True
2024-08-23 19:25:34,484 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-23 19:25:34,484 [trainer.py] => seed: 1993
2024-08-23 19:25:34,484 [trainer.py] => tuned_epoch: 20
2024-08-23 19:25:34,484 [trainer.py] => init_lr: 0.001875
2024-08-23 19:25:34,484 [trainer.py] => batch_size: 48
2024-08-23 19:25:34,484 [trainer.py] => weight_decay: 0
2024-08-23 19:25:34,484 [trainer.py] => min_lr: 1e-05
2024-08-23 19:25:34,484 [trainer.py] => optimizer: adam
2024-08-23 19:25:34,484 [trainer.py] => scheduler: constant
2024-08-23 19:25:34,484 [trainer.py] => reinit_optimizer: True
2024-08-23 19:25:34,484 [trainer.py] => global_pool: token
2024-08-23 19:25:34,484 [trainer.py] => head_type: prompt
2024-08-23 19:25:34,484 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-23 19:25:34,484 [trainer.py] => pretrained: True
2024-08-23 19:25:34,485 [trainer.py] => drop: 0.0
2024-08-23 19:25:34,485 [trainer.py] => drop_path: 0.0
2024-08-23 19:25:34,485 [trainer.py] => prompt_pool: True
2024-08-23 19:25:34,485 [trainer.py] => size: 10
2024-08-23 19:25:34,485 [trainer.py] => length: 5
2024-08-23 19:25:34,485 [trainer.py] => top_k: 5
2024-08-23 19:25:34,485 [trainer.py] => initializer: uniform
2024-08-23 19:25:34,485 [trainer.py] => prompt_key: True
2024-08-23 19:25:34,485 [trainer.py] => prompt_key_init: uniform
2024-08-23 19:25:34,485 [trainer.py] => use_prompt_mask: False
2024-08-23 19:25:34,485 [trainer.py] => shared_prompt_pool: False
2024-08-23 19:25:34,485 [trainer.py] => shared_prompt_key: False
2024-08-23 19:25:34,485 [trainer.py] => batchwise_prompt: True
2024-08-23 19:25:34,485 [trainer.py] => embedding_key: cls
2024-08-23 19:25:34,485 [trainer.py] => predefined_key: 
2024-08-23 19:25:34,485 [trainer.py] => pull_constraint: True
2024-08-23 19:25:34,485 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-23 19:25:36,195 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-23 19:25:39,601 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-08-23 19:25:39,602 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-08-23 19:25:44,704 [l2p.py] => 85,940,836 model total parameters.
2024-08-23 19:25:44,704 [l2p.py] => 122,980 model training parameters.
2024-08-23 19:25:44,704 [l2p.py] => prompt.prompt: 38400
2024-08-23 19:25:44,705 [l2p.py] => prompt.prompt_key: 7680
2024-08-23 19:25:44,705 [l2p.py] => head.weight: 76800
2024-08-23 19:25:44,705 [l2p.py] => head.bias: 100
2024-08-23 19:25:44,706 [trainer.py] => All params: 171816392
2024-08-23 19:25:44,707 [trainer.py] => Trainable params: 122980
2024-08-23 19:25:44,707 [l2p.py] => Learning on 0-20
2024-08-23 20:05:15,286 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.111, Train_accy 88.43, Test_accy 96.50
2024-08-23 20:05:30,698 [trainer.py] => No NME accuracy.
2024-08-23 20:05:30,700 [trainer.py] => CNN: {'total': 96.5, '00-19': 96.5, 'old': 0, 'new': 96.5}
2024-08-23 20:05:30,706 [trainer.py] => CNN top1 curve: [96.5]
2024-08-23 20:05:30,706 [trainer.py] => CNN top5 curve: [99.5]

Average Accuracy (CNN): 96.5
2024-08-23 20:05:30,706 [trainer.py] => Average Accuracy (CNN): 96.5 

2024-08-23 20:05:30,706 [trainer.py] => Train Time: 4734.82
2024-08-23 20:05:30,706 [trainer.py] => Test Time: 15.41 

2024-08-23 20:05:30,708 [trainer.py] => All params: 171816392
2024-08-23 20:05:30,709 [trainer.py] => Trainable params: 122980
2024-08-23 20:05:30,709 [l2p.py] => Learning on 20-40
2024-08-23 20:45:51,454 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.008, Train_accy 91.42, Test_accy 93.60
2024-08-23 20:46:21,612 [trainer.py] => No NME accuracy.
2024-08-23 20:46:21,613 [trainer.py] => CNN: {'total': 93.6, '00-19': 92.1, '20-39': 95.1, 'old': 92.1, 'new': 95.1}
2024-08-23 20:46:21,613 [trainer.py] => CNN top1 curve: [96.5, 93.6]
2024-08-23 20:46:21,625 [trainer.py] => CNN top5 curve: [99.5, 99.35]

Average Accuracy (CNN): 95.05
2024-08-23 20:46:21,625 [trainer.py] => Average Accuracy (CNN): 95.05 

2024-08-23 20:46:21,625 [trainer.py] => Train Time: 9576.17
2024-08-23 20:46:21,625 [trainer.py] => Test Time: 45.56 

2024-08-23 20:46:21,627 [trainer.py] => All params: 171816392
2024-08-23 20:46:21,629 [trainer.py] => Trainable params: 122980
2024-08-23 20:46:21,629 [l2p.py] => Learning on 40-60
2024-08-23 21:27:41,259 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.026, Train_accy 90.31, Test_accy 91.08
2024-08-23 21:28:26,025 [trainer.py] => No NME accuracy.
2024-08-23 21:28:26,026 [trainer.py] => CNN: {'total': 91.08, '00-19': 86.55, '20-39': 92.65, '40-59': 94.05, 'old': 89.6, 'new': 94.05}
2024-08-23 21:28:26,026 [trainer.py] => CNN top1 curve: [96.5, 93.6, 91.08]
2024-08-23 21:28:26,026 [trainer.py] => CNN top5 curve: [99.5, 99.35, 99.12]

Average Accuracy (CNN): 93.73
2024-08-23 21:28:26,027 [trainer.py] => Average Accuracy (CNN): 93.73 

2024-08-23 21:28:26,027 [trainer.py] => Train Time: 14535.259999999998
2024-08-23 21:28:26,027 [trainer.py] => Test Time: 90.32 

2024-08-23 21:28:26,030 [trainer.py] => All params: 171816392
2024-08-23 21:28:26,032 [trainer.py] => Trainable params: 122980
2024-08-23 21:28:26,032 [l2p.py] => Learning on 60-80
2024-08-23 22:10:46,685 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.014, Train_accy 90.82, Test_accy 86.86
2024-08-23 22:11:46,232 [trainer.py] => No NME accuracy.
2024-08-23 22:11:46,234 [trainer.py] => CNN: {'total': 86.86, '00-19': 82.35, '20-39': 90.9, '40-59': 82.95, '60-79': 91.25, 'old': 85.4, 'new': 91.25}
2024-08-23 22:11:46,234 [trainer.py] => CNN top1 curve: [96.5, 93.6, 91.08, 86.86]
2024-08-23 22:11:46,234 [trainer.py] => CNN top5 curve: [99.5, 99.35, 99.12, 98.89]

Average Accuracy (CNN): 92.01
2024-08-23 22:11:46,234 [trainer.py] => Average Accuracy (CNN): 92.01 

2024-08-23 22:11:46,234 [trainer.py] => Train Time: 19616.379999999997
2024-08-23 22:11:46,235 [trainer.py] => Test Time: 149.85999999999999 

2024-08-23 22:11:46,237 [trainer.py] => All params: 171816392
2024-08-23 22:11:46,239 [trainer.py] => Trainable params: 122980
2024-08-23 22:11:46,239 [l2p.py] => Learning on 80-100
2024-08-23 22:55:02,165 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.017, Train_accy 92.30, Test_accy 86.02
2024-08-23 22:56:16,046 [trainer.py] => No NME accuracy.
2024-08-23 22:56:16,046 [trainer.py] => CNN: {'total': 86.02, '00-19': 78.25, '20-39': 89.7, '40-59': 81.65, '60-79': 88.9, '80-99': 91.6, 'old': 84.62, 'new': 91.6}
2024-08-23 22:56:16,046 [trainer.py] => CNN top1 curve: [96.5, 93.6, 91.08, 86.86, 86.02]
2024-08-23 22:56:16,046 [trainer.py] => CNN top5 curve: [99.5, 99.35, 99.12, 98.89, 98.58]

Average Accuracy (CNN): 90.81
2024-08-23 22:56:16,046 [trainer.py] => Average Accuracy (CNN): 90.81 

2024-08-23 22:56:16,046 [trainer.py] => Train Time: 24807.91
2024-08-23 22:56:16,046 [trainer.py] => Test Time: 223.73999999999998 

Accuracy Matrix (CNN):
[[96.5  92.1  86.55 82.35 78.25]
 [ 0.   95.1  92.65 90.9  89.7 ]
 [ 0.    0.   94.05 82.95 81.65]
 [ 0.    0.    0.   91.25 88.9 ]
 [ 0.    0.    0.    0.   91.6 ]]
2024-08-23 22:56:16,047 [trainer.py] => Forgetting (CNN): 9.599999999999994
2024-08-23 22:56:27,101 [trainer.py] => config: ./exps/l2p_cifar_B0_Inc10.json
2024-08-23 22:56:27,102 [trainer.py] => prefix:  
2024-08-23 22:56:27,102 [trainer.py] => dataset: cifar224
2024-08-23 22:56:27,102 [trainer.py] => memory_size: 0
2024-08-23 22:56:27,102 [trainer.py] => memory_per_class: 0
2024-08-23 22:56:27,102 [trainer.py] => fixed_memory: False
2024-08-23 22:56:27,102 [trainer.py] => shuffle: True
2024-08-23 22:56:27,102 [trainer.py] => init_cls: 10
2024-08-23 22:56:27,102 [trainer.py] => increment: 10
2024-08-23 22:56:27,102 [trainer.py] => model_name: l2p
2024-08-23 22:56:27,103 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-08-23 22:56:27,111 [trainer.py] => get_original_backbone: True
2024-08-23 22:56:27,111 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-23 22:56:27,111 [trainer.py] => seed: 1993
2024-08-23 22:56:27,111 [trainer.py] => tuned_epoch: 20
2024-08-23 22:56:27,111 [trainer.py] => init_lr: 0.001875
2024-08-23 22:56:27,111 [trainer.py] => batch_size: 48
2024-08-23 22:56:27,111 [trainer.py] => weight_decay: 0
2024-08-23 22:56:27,112 [trainer.py] => min_lr: 1e-05
2024-08-23 22:56:27,112 [trainer.py] => optimizer: adam
2024-08-23 22:56:27,112 [trainer.py] => scheduler: constant
2024-08-23 22:56:27,112 [trainer.py] => reinit_optimizer: True
2024-08-23 22:56:27,112 [trainer.py] => global_pool: token
2024-08-23 22:56:27,112 [trainer.py] => head_type: prompt
2024-08-23 22:56:27,112 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-23 22:56:27,112 [trainer.py] => pretrained: True
2024-08-23 22:56:27,112 [trainer.py] => drop: 0.0
2024-08-23 22:56:27,113 [trainer.py] => drop_path: 0.0
2024-08-23 22:56:27,113 [trainer.py] => prompt_pool: True
2024-08-23 22:56:27,113 [trainer.py] => size: 10
2024-08-23 22:56:27,113 [trainer.py] => length: 5
2024-08-23 22:56:27,113 [trainer.py] => top_k: 5
2024-08-23 22:56:27,113 [trainer.py] => initializer: uniform
2024-08-23 22:56:27,113 [trainer.py] => prompt_key: True
2024-08-23 22:56:27,113 [trainer.py] => prompt_key_init: uniform
2024-08-23 22:56:27,113 [trainer.py] => use_prompt_mask: False
2024-08-23 22:56:27,114 [trainer.py] => shared_prompt_pool: False
2024-08-23 22:56:27,114 [trainer.py] => shared_prompt_key: False
2024-08-23 22:56:27,114 [trainer.py] => batchwise_prompt: True
2024-08-23 22:56:27,114 [trainer.py] => embedding_key: cls
2024-08-23 22:56:27,114 [trainer.py] => predefined_key: 
2024-08-23 22:56:27,114 [trainer.py] => pull_constraint: True
2024-08-23 22:56:27,114 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-23 22:56:29,040 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-23 22:56:35,402 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-08-23 22:56:35,403 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-08-23 22:56:40,582 [l2p.py] => 85,940,836 model total parameters.
2024-08-23 22:56:40,583 [l2p.py] => 122,980 model training parameters.
2024-08-23 22:56:40,583 [l2p.py] => prompt.prompt: 38400
2024-08-23 22:56:40,583 [l2p.py] => prompt.prompt_key: 7680
2024-08-23 22:56:40,583 [l2p.py] => head.weight: 76800
2024-08-23 22:56:40,583 [l2p.py] => head.bias: 100
2024-08-23 22:56:40,584 [trainer.py] => All params: 171816392
2024-08-23 22:56:40,585 [trainer.py] => Trainable params: 122980
2024-08-23 22:56:40,585 [l2p.py] => Learning on 0-10
2024-08-23 23:16:38,890 [l2p.py] => Task 0, Epoch 20/20 => Loss -0.031, Train_accy 91.64, Test_accy 97.00
2024-08-23 23:16:47,161 [trainer.py] => No NME accuracy.
2024-08-23 23:16:47,162 [trainer.py] => CNN: {'total': 97.0, '00-09': 97.0, 'old': 0, 'new': 97.0}
2024-08-23 23:16:47,162 [trainer.py] => CNN top1 curve: [97.0]
2024-08-23 23:16:47,162 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.0
2024-08-23 23:16:47,162 [trainer.py] => Average Accuracy (CNN): 97.0 

2024-08-23 23:16:47,162 [trainer.py] => Train Time: 2393.4300000000003
2024-08-23 23:16:47,162 [trainer.py] => Test Time: 8.27 

2024-08-23 23:16:47,165 [trainer.py] => All params: 171816392
2024-08-23 23:16:47,167 [trainer.py] => Trainable params: 122980
2024-08-23 23:16:47,167 [l2p.py] => Learning on 10-20
2024-08-23 23:37:11,211 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.008, Train_accy 91.10, Test_accy 94.90
2024-08-23 23:37:26,566 [trainer.py] => No NME accuracy.
2024-08-23 23:37:26,566 [trainer.py] => CNN: {'total': 94.9, '00-09': 96.6, '10-19': 93.2, 'old': 96.6, 'new': 93.2}
2024-08-23 23:37:26,566 [trainer.py] => CNN top1 curve: [97.0, 94.9]
2024-08-23 23:37:26,567 [trainer.py] => CNN top5 curve: [100.0, 99.65]

Average Accuracy (CNN): 95.95
2024-08-23 23:37:26,567 [trainer.py] => Average Accuracy (CNN): 95.95 

2024-08-23 23:37:26,567 [trainer.py] => Train Time: 4841.42
2024-08-23 23:37:26,567 [trainer.py] => Test Time: 23.619999999999997 

2024-08-23 23:37:26,569 [trainer.py] => All params: 171816392
2024-08-23 23:37:26,571 [trainer.py] => Trainable params: 122980
2024-08-23 23:37:26,571 [l2p.py] => Learning on 20-30
2024-08-23 23:58:16,421 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.111, Train_accy 94.62, Test_accy 93.50
2024-08-23 23:58:38,954 [trainer.py] => No NME accuracy.
2024-08-23 23:58:38,954 [trainer.py] => CNN: {'total': 93.5, '00-09': 92.4, '10-19': 91.0, '20-29': 97.1, 'old': 91.7, 'new': 97.1}
2024-08-23 23:58:38,954 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5]
2024-08-23 23:58:38,954 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3]

Average Accuracy (CNN): 95.13
2024-08-23 23:58:38,954 [trainer.py] => Average Accuracy (CNN): 95.13 

2024-08-23 23:58:38,954 [trainer.py] => Train Time: 7341.02
2024-08-23 23:58:38,955 [trainer.py] => Test Time: 46.15 

2024-08-23 23:58:38,957 [trainer.py] => All params: 171816392
2024-08-23 23:58:38,959 [trainer.py] => Trainable params: 122980
2024-08-23 23:58:38,959 [l2p.py] => Learning on 30-40
2024-08-24 00:19:59,576 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.064, Train_accy 92.42, Test_accy 92.02
2024-08-24 00:20:29,584 [trainer.py] => No NME accuracy.
2024-08-24 00:20:29,585 [trainer.py] => CNN: {'total': 92.02, '00-09': 90.0, '10-19': 89.9, '20-29': 96.2, '30-39': 92.0, 'old': 92.03, 'new': 92.0}
2024-08-24 00:20:29,585 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5, 92.02]
2024-08-24 00:20:29,585 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3, 99.2]

Average Accuracy (CNN): 94.35
2024-08-24 00:20:29,586 [trainer.py] => Average Accuracy (CNN): 94.35 

2024-08-24 00:20:29,586 [trainer.py] => Train Time: 9902.050000000001
2024-08-24 00:20:29,586 [trainer.py] => Test Time: 76.16 

2024-08-24 00:20:29,587 [trainer.py] => All params: 171816392
2024-08-24 00:20:29,588 [trainer.py] => Trainable params: 122980
2024-08-24 00:20:29,588 [l2p.py] => Learning on 40-50
2024-08-24 00:42:20,349 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.127, Train_accy 95.42, Test_accy 89.10
2024-08-24 00:42:57,588 [trainer.py] => No NME accuracy.
2024-08-24 00:42:57,589 [trainer.py] => CNN: {'total': 89.1, '00-09': 81.8, '10-19': 85.4, '20-29': 94.7, '30-39': 89.5, '40-49': 94.1, 'old': 87.85, 'new': 94.1}
2024-08-24 00:42:57,590 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5, 92.02, 89.1]
2024-08-24 00:42:57,590 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3, 99.2, 99.14]

Average Accuracy (CNN): 93.3
2024-08-24 00:42:57,590 [trainer.py] => Average Accuracy (CNN): 93.3 

2024-08-24 00:42:57,590 [trainer.py] => Train Time: 12523.480000000001
2024-08-24 00:42:57,590 [trainer.py] => Test Time: 113.4 

2024-08-24 00:42:57,591 [trainer.py] => All params: 171816392
2024-08-24 00:42:57,593 [trainer.py] => Trainable params: 122980
2024-08-24 00:42:57,593 [l2p.py] => Learning on 50-60
2024-08-24 01:05:15,915 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.100, Train_accy 93.92, Test_accy 88.20
2024-08-24 01:06:00,339 [trainer.py] => No NME accuracy.
2024-08-24 01:06:00,340 [trainer.py] => CNN: {'total': 88.2, '00-09': 79.2, '10-19': 86.0, '20-29': 92.8, '30-39': 87.3, '40-49': 91.7, '50-59': 92.2, 'old': 87.4, 'new': 92.2}
2024-08-24 01:06:00,340 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5, 92.02, 89.1, 88.2]
2024-08-24 01:06:00,340 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3, 99.2, 99.14, 98.95]

Average Accuracy (CNN): 92.45
2024-08-24 01:06:00,340 [trainer.py] => Average Accuracy (CNN): 92.45 

2024-08-24 01:06:00,340 [trainer.py] => Train Time: 15200.020000000002
2024-08-24 01:06:00,340 [trainer.py] => Test Time: 157.82 

2024-08-24 01:06:00,342 [trainer.py] => All params: 171816392
2024-08-24 01:06:00,343 [trainer.py] => Trainable params: 122980
2024-08-24 01:06:00,343 [l2p.py] => Learning on 60-70
2024-08-24 01:28:49,576 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.134, Train_accy 95.46, Test_accy 87.81
2024-08-24 01:29:41,218 [trainer.py] => No NME accuracy.
2024-08-24 01:29:41,218 [trainer.py] => CNN: {'total': 87.81, '00-09': 77.5, '10-19': 83.6, '20-29': 93.0, '30-39': 87.3, '40-49': 90.2, '50-59': 87.3, '60-69': 95.8, 'old': 86.48, 'new': 95.8}
2024-08-24 01:29:41,219 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5, 92.02, 89.1, 88.2, 87.81]
2024-08-24 01:29:41,219 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3, 99.2, 99.14, 98.95, 98.83]

Average Accuracy (CNN): 91.79
2024-08-24 01:29:41,219 [trainer.py] => Average Accuracy (CNN): 91.79 

2024-08-24 01:29:41,219 [trainer.py] => Train Time: 17938.370000000003
2024-08-24 01:29:41,219 [trainer.py] => Test Time: 209.45999999999998 

2024-08-24 01:29:41,221 [trainer.py] => All params: 171816392
2024-08-24 01:29:41,223 [trainer.py] => Trainable params: 122980
2024-08-24 01:29:41,223 [l2p.py] => Learning on 70-80
2024-08-24 01:53:00,252 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.102, Train_accy 93.78, Test_accy 85.89
2024-08-24 01:53:59,349 [trainer.py] => No NME accuracy.
2024-08-24 01:53:59,350 [trainer.py] => CNN: {'total': 85.89, '00-09': 74.7, '10-19': 82.4, '20-29': 92.8, '30-39': 85.5, '40-49': 88.0, '50-59': 85.2, '60-69': 94.7, '70-79': 83.8, 'old': 86.19, 'new': 83.8}
2024-08-24 01:53:59,350 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5, 92.02, 89.1, 88.2, 87.81, 85.89]
2024-08-24 01:53:59,350 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3, 99.2, 99.14, 98.95, 98.83, 98.68]

Average Accuracy (CNN): 91.05
2024-08-24 01:53:59,350 [trainer.py] => Average Accuracy (CNN): 91.05 

2024-08-24 01:53:59,350 [trainer.py] => Train Time: 20736.200000000004
2024-08-24 01:53:59,350 [trainer.py] => Test Time: 268.54999999999995 

2024-08-24 01:53:59,352 [trainer.py] => All params: 171816392
2024-08-24 01:53:59,353 [trainer.py] => Trainable params: 122980
2024-08-24 01:53:59,353 [l2p.py] => Learning on 80-90
2024-08-24 02:17:44,908 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.112, Train_accy 94.46, Test_accy 85.16
2024-08-24 02:18:51,341 [trainer.py] => No NME accuracy.
2024-08-24 02:18:51,341 [trainer.py] => CNN: {'total': 85.16, '00-09': 72.9, '10-19': 82.0, '20-29': 92.3, '30-39': 85.1, '40-49': 87.2, '50-59': 83.1, '60-69': 91.6, '70-79': 82.4, '80-89': 89.8, 'old': 84.58, 'new': 89.8}
2024-08-24 02:18:51,341 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5, 92.02, 89.1, 88.2, 87.81, 85.89, 85.16]
2024-08-24 02:18:51,341 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3, 99.2, 99.14, 98.95, 98.83, 98.68, 98.44]

Average Accuracy (CNN): 90.4
2024-08-24 02:18:51,341 [trainer.py] => Average Accuracy (CNN): 90.4 

2024-08-24 02:18:51,341 [trainer.py] => Train Time: 23587.190000000006
2024-08-24 02:18:51,342 [trainer.py] => Test Time: 334.97999999999996 

2024-08-24 02:18:51,344 [trainer.py] => All params: 171816392
2024-08-24 02:18:51,346 [trainer.py] => Trainable params: 122980
2024-08-24 02:18:51,346 [l2p.py] => Learning on 90-100
2024-08-24 02:43:04,897 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.082, Train_accy 93.48, Test_accy 85.01
2024-08-24 02:44:19,182 [trainer.py] => No NME accuracy.
2024-08-24 02:44:19,182 [trainer.py] => CNN: {'total': 85.01, '00-09': 70.7, '10-19': 79.9, '20-29': 92.5, '30-39': 84.9, '40-49': 86.7, '50-59': 82.7, '60-69': 90.8, '70-79': 83.2, '80-89': 89.2, '90-99': 89.5, 'old': 84.51, 'new': 89.5}
2024-08-24 02:44:19,182 [trainer.py] => CNN top1 curve: [97.0, 94.9, 93.5, 92.02, 89.1, 88.2, 87.81, 85.89, 85.16, 85.01]
2024-08-24 02:44:19,183 [trainer.py] => CNN top5 curve: [100.0, 99.65, 99.3, 99.2, 99.14, 98.95, 98.83, 98.68, 98.44, 98.2]

Average Accuracy (CNN): 89.86
2024-08-24 02:44:19,183 [trainer.py] => Average Accuracy (CNN): 89.86 

2024-08-24 02:44:19,183 [trainer.py] => Train Time: 26494.120000000006
2024-08-24 02:44:19,183 [trainer.py] => Test Time: 409.26 

Accuracy Matrix (CNN):
[[97.  96.6 92.4 90.  81.8 79.2 77.5 74.7 72.9 70.7]
 [ 0.  93.2 91.  89.9 85.4 86.  83.6 82.4 82.  79.9]
 [ 0.   0.  97.1 96.2 94.7 92.8 93.  92.8 92.3 92.5]
 [ 0.   0.   0.  92.  89.5 87.3 87.3 85.5 85.1 84.9]
 [ 0.   0.   0.   0.  94.1 91.7 90.2 88.  87.2 86.7]
 [ 0.   0.   0.   0.   0.  92.2 87.3 85.2 83.1 82.7]
 [ 0.   0.   0.   0.   0.   0.  95.8 94.7 91.6 90.8]
 [ 0.   0.   0.   0.   0.   0.   0.  83.8 82.4 83.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  89.8 89.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  89.5]]
2024-08-24 02:44:19,185 [trainer.py] => Forgetting (CNN): 8.266666666666662
2024-08-24 02:44:22,813 [trainer.py] => config: ./exps/l2p_cifar_B0_Inc20.json
2024-08-24 02:44:22,813 [trainer.py] => prefix:  
2024-08-24 02:44:22,813 [trainer.py] => dataset: cifar224
2024-08-24 02:44:22,813 [trainer.py] => memory_size: 0
2024-08-24 02:44:22,813 [trainer.py] => memory_per_class: 0
2024-08-24 02:44:22,813 [trainer.py] => fixed_memory: False
2024-08-24 02:44:22,813 [trainer.py] => shuffle: True
2024-08-24 02:44:22,813 [trainer.py] => init_cls: 5
2024-08-24 02:44:22,813 [trainer.py] => increment: 5
2024-08-24 02:44:22,813 [trainer.py] => model_name: l2p
2024-08-24 02:44:22,813 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-08-24 02:44:22,818 [trainer.py] => get_original_backbone: True
2024-08-24 02:44:22,818 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-24 02:44:22,818 [trainer.py] => seed: 1993
2024-08-24 02:44:22,818 [trainer.py] => tuned_epoch: 20
2024-08-24 02:44:22,818 [trainer.py] => init_lr: 0.001875
2024-08-24 02:44:22,818 [trainer.py] => batch_size: 48
2024-08-24 02:44:22,818 [trainer.py] => weight_decay: 0
2024-08-24 02:44:22,818 [trainer.py] => min_lr: 1e-05
2024-08-24 02:44:22,818 [trainer.py] => optimizer: adam
2024-08-24 02:44:22,818 [trainer.py] => scheduler: constant
2024-08-24 02:44:22,818 [trainer.py] => reinit_optimizer: True
2024-08-24 02:44:22,818 [trainer.py] => global_pool: token
2024-08-24 02:44:22,818 [trainer.py] => head_type: prompt
2024-08-24 02:44:22,818 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-24 02:44:22,819 [trainer.py] => pretrained: True
2024-08-24 02:44:22,819 [trainer.py] => drop: 0.0
2024-08-24 02:44:22,819 [trainer.py] => drop_path: 0.0
2024-08-24 02:44:22,819 [trainer.py] => prompt_pool: True
2024-08-24 02:44:22,819 [trainer.py] => size: 10
2024-08-24 02:44:22,819 [trainer.py] => length: 5
2024-08-24 02:44:22,819 [trainer.py] => top_k: 5
2024-08-24 02:44:22,819 [trainer.py] => initializer: uniform
2024-08-24 02:44:22,819 [trainer.py] => prompt_key: True
2024-08-24 02:44:22,819 [trainer.py] => prompt_key_init: uniform
2024-08-24 02:44:22,819 [trainer.py] => use_prompt_mask: False
2024-08-24 02:44:22,819 [trainer.py] => shared_prompt_pool: False
2024-08-24 02:44:22,819 [trainer.py] => shared_prompt_key: False
2024-08-24 02:44:22,819 [trainer.py] => batchwise_prompt: True
2024-08-24 02:44:22,819 [trainer.py] => embedding_key: cls
2024-08-24 02:44:22,819 [trainer.py] => predefined_key: 
2024-08-24 02:44:22,819 [trainer.py] => pull_constraint: True
2024-08-24 02:44:22,819 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-24 02:44:24,504 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-24 02:44:27,424 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-08-24 02:44:27,424 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-08-24 02:44:31,852 [l2p.py] => 85,940,836 model total parameters.
2024-08-24 02:44:31,853 [l2p.py] => 122,980 model training parameters.
2024-08-24 02:44:31,853 [l2p.py] => prompt.prompt: 38400
2024-08-24 02:44:31,853 [l2p.py] => prompt.prompt_key: 7680
2024-08-24 02:44:31,854 [l2p.py] => head.weight: 76800
2024-08-24 02:44:31,854 [l2p.py] => head.bias: 100
2024-08-24 02:44:31,855 [trainer.py] => All params: 171816392
2024-08-24 02:44:31,856 [trainer.py] => Trainable params: 122980
2024-08-24 02:44:31,856 [l2p.py] => Learning on 0-5
2024-08-24 02:54:43,667 [l2p.py] => Task 0, Epoch 20/20 => Loss -0.104, Train_accy 93.68, Test_accy 98.60
2024-08-24 02:54:48,172 [trainer.py] => No NME accuracy.
2024-08-24 02:54:48,173 [trainer.py] => CNN: {'total': 98.6, '00-04': 98.6, 'old': 0, 'new': 98.6}
2024-08-24 02:54:48,173 [trainer.py] => CNN top1 curve: [98.6]
2024-08-24 02:54:48,173 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.6
2024-08-24 02:54:48,173 [trainer.py] => Average Accuracy (CNN): 98.6 

2024-08-24 02:54:48,173 [trainer.py] => Train Time: 1220.48
2024-08-24 02:54:48,173 [trainer.py] => Test Time: 4.5 

2024-08-24 02:54:48,176 [trainer.py] => All params: 171816392
2024-08-24 02:54:48,177 [trainer.py] => Trainable params: 122980
2024-08-24 02:54:48,178 [l2p.py] => Learning on 5-10
2024-08-24 03:05:09,194 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.128, Train_accy 94.12, Test_accy 96.10
2024-08-24 03:05:17,331 [trainer.py] => No NME accuracy.
2024-08-24 03:05:17,332 [trainer.py] => CNN: {'total': 96.1, '00-04': 96.6, '05-09': 95.6, 'old': 96.6, 'new': 95.6}
2024-08-24 03:05:17,332 [trainer.py] => CNN top1 curve: [98.6, 96.1]
2024-08-24 03:05:17,332 [trainer.py] => CNN top5 curve: [100.0, 99.9]

Average Accuracy (CNN): 97.35
2024-08-24 03:05:17,332 [trainer.py] => Average Accuracy (CNN): 97.35 

2024-08-24 03:05:17,332 [trainer.py] => Train Time: 2462.4700000000003
2024-08-24 03:05:17,332 [trainer.py] => Test Time: 12.64 

2024-08-24 03:05:17,334 [trainer.py] => All params: 171816392
2024-08-24 03:05:17,335 [trainer.py] => Trainable params: 122980
2024-08-24 03:05:17,335 [l2p.py] => Learning on 10-15
2024-08-24 03:15:52,855 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.099, Train_accy 93.16, Test_accy 95.40
2024-08-24 03:16:04,512 [trainer.py] => No NME accuracy.
2024-08-24 03:16:04,513 [trainer.py] => CNN: {'total': 95.4, '00-04': 95.8, '05-09': 93.8, '10-14': 96.6, 'old': 94.8, 'new': 96.6}
2024-08-24 03:16:04,513 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4]
2024-08-24 03:16:04,513 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73]

Average Accuracy (CNN): 96.7
2024-08-24 03:16:04,513 [trainer.py] => Average Accuracy (CNN): 96.7 

2024-08-24 03:16:04,513 [trainer.py] => Train Time: 3733.46
2024-08-24 03:16:04,513 [trainer.py] => Test Time: 24.3 

2024-08-24 03:16:04,514 [trainer.py] => All params: 171816392
2024-08-24 03:16:04,515 [trainer.py] => Trainable params: 122980
2024-08-24 03:16:04,516 [l2p.py] => Learning on 15-20
2024-08-24 03:26:53,944 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.108, Train_accy 93.52, Test_accy 94.25
2024-08-24 03:27:09,465 [trainer.py] => No NME accuracy.
2024-08-24 03:27:09,465 [trainer.py] => CNN: {'total': 94.25, '00-04': 94.8, '05-09': 94.6, '10-14': 96.8, '15-19': 90.8, 'old': 95.4, 'new': 90.8}
2024-08-24 03:27:09,465 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25]
2024-08-24 03:27:09,465 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15]

Average Accuracy (CNN): 96.09
2024-08-24 03:27:09,465 [trainer.py] => Average Accuracy (CNN): 96.09 

2024-08-24 03:27:09,465 [trainer.py] => Train Time: 5032.2699999999995
2024-08-24 03:27:09,465 [trainer.py] => Test Time: 39.82 

2024-08-24 03:27:09,467 [trainer.py] => All params: 171816392
2024-08-24 03:27:09,468 [trainer.py] => Trainable params: 122980
2024-08-24 03:27:09,468 [l2p.py] => Learning on 20-25
2024-08-24 03:38:13,676 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.200, Train_accy 97.00, Test_accy 94.04
2024-08-24 03:38:32,708 [trainer.py] => No NME accuracy.
2024-08-24 03:38:32,709 [trainer.py] => CNN: {'total': 94.04, '00-04': 94.8, '05-09': 94.4, '10-14': 95.0, '15-19': 89.0, '20-24': 97.0, 'old': 93.3, 'new': 97.0}
2024-08-24 03:38:32,709 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04]
2024-08-24 03:38:32,710 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12]

Average Accuracy (CNN): 95.68
2024-08-24 03:38:32,710 [trainer.py] => Average Accuracy (CNN): 95.68 

2024-08-24 03:38:32,710 [trainer.py] => Train Time: 6360.639999999999
2024-08-24 03:38:32,710 [trainer.py] => Test Time: 58.85 

2024-08-24 03:38:32,712 [trainer.py] => All params: 171816392
2024-08-24 03:38:32,715 [trainer.py] => Trainable params: 122980
2024-08-24 03:38:32,715 [l2p.py] => Learning on 25-30
2024-08-24 03:49:52,790 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.206, Train_accy 97.28, Test_accy 91.50
2024-08-24 03:50:15,746 [trainer.py] => No NME accuracy.
2024-08-24 03:50:15,746 [trainer.py] => CNN: {'total': 91.5, '00-04': 94.6, '05-09': 81.8, '10-14': 92.8, '15-19': 85.8, '20-24': 97.0, '25-29': 97.0, 'old': 90.4, 'new': 97.0}
2024-08-24 03:50:15,746 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5]
2024-08-24 03:50:15,746 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93]

Average Accuracy (CNN): 94.98
2024-08-24 03:50:15,747 [trainer.py] => Average Accuracy (CNN): 94.98 

2024-08-24 03:50:15,747 [trainer.py] => Train Time: 7720.619999999999
2024-08-24 03:50:15,747 [trainer.py] => Test Time: 81.8 

2024-08-24 03:50:15,749 [trainer.py] => All params: 171816392
2024-08-24 03:50:15,751 [trainer.py] => Trainable params: 122980
2024-08-24 03:50:15,751 [l2p.py] => Learning on 30-35
2024-08-24 04:01:50,693 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.132, Train_accy 93.88, Test_accy 89.60
2024-08-24 04:02:16,955 [trainer.py] => No NME accuracy.
2024-08-24 04:02:16,956 [trainer.py] => CNN: {'total': 89.6, '00-04': 94.4, '05-09': 82.0, '10-14': 93.2, '15-19': 86.4, '20-24': 95.4, '25-29': 97.0, '30-34': 78.8, 'old': 91.4, 'new': 78.8}
2024-08-24 04:02:16,956 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6]
2024-08-24 04:02:16,956 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83]

Average Accuracy (CNN): 94.21
2024-08-24 04:02:16,956 [trainer.py] => Average Accuracy (CNN): 94.21 

2024-08-24 04:02:16,956 [trainer.py] => Train Time: 9110.389999999998
2024-08-24 04:02:16,956 [trainer.py] => Test Time: 108.06 

2024-08-24 04:02:16,957 [trainer.py] => All params: 171816392
2024-08-24 04:02:16,958 [trainer.py] => Trainable params: 122980
2024-08-24 04:02:16,958 [l2p.py] => Learning on 35-40
2024-08-24 04:14:06,588 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.194, Train_accy 97.00, Test_accy 89.35
2024-08-24 04:14:36,486 [trainer.py] => No NME accuracy.
2024-08-24 04:14:36,487 [trainer.py] => CNN: {'total': 89.35, '00-04': 90.8, '05-09': 80.8, '10-14': 91.2, '15-19': 85.2, '20-24': 95.0, '25-29': 96.6, '30-34': 78.8, '35-39': 96.4, 'old': 88.34, 'new': 96.4}
2024-08-24 04:14:36,487 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35]
2024-08-24 04:14:36,487 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65]

Average Accuracy (CNN): 93.61
2024-08-24 04:14:36,487 [trainer.py] => Average Accuracy (CNN): 93.61 

2024-08-24 04:14:36,487 [trainer.py] => Train Time: 10529.589999999998
2024-08-24 04:14:36,487 [trainer.py] => Test Time: 137.96 

2024-08-24 04:14:36,490 [trainer.py] => All params: 171816392
2024-08-24 04:14:36,491 [trainer.py] => Trainable params: 122980
2024-08-24 04:14:36,491 [l2p.py] => Learning on 40-45
2024-08-24 04:26:40,116 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.153, Train_accy 95.76, Test_accy 87.20
2024-08-24 04:27:13,616 [trainer.py] => No NME accuracy.
2024-08-24 04:27:13,616 [trainer.py] => CNN: {'total': 87.2, '00-04': 79.6, '05-09': 81.8, '10-14': 81.2, '15-19': 84.0, '20-24': 95.0, '25-29': 95.8, '30-34': 76.8, '35-39': 96.6, '40-44': 94.0, 'old': 86.35, 'new': 94.0}
2024-08-24 04:27:13,616 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2]
2024-08-24 04:27:13,616 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42]

Average Accuracy (CNN): 92.89
2024-08-24 04:27:13,616 [trainer.py] => Average Accuracy (CNN): 92.89 

2024-08-24 04:27:13,616 [trainer.py] => Train Time: 11976.669999999998
2024-08-24 04:27:13,616 [trainer.py] => Test Time: 171.46 

2024-08-24 04:27:13,618 [trainer.py] => All params: 171816392
2024-08-24 04:27:13,619 [trainer.py] => Trainable params: 122980
2024-08-24 04:27:13,619 [l2p.py] => Learning on 45-50
2024-08-24 04:39:29,819 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.210, Train_accy 97.40, Test_accy 86.28
2024-08-24 04:40:07,284 [trainer.py] => No NME accuracy.
2024-08-24 04:40:07,284 [trainer.py] => CNN: {'total': 86.28, '00-04': 79.2, '05-09': 79.8, '10-14': 78.0, '15-19': 83.4, '20-24': 94.6, '25-29': 95.0, '30-34': 75.4, '35-39': 91.8, '40-44': 92.2, '45-49': 93.4, 'old': 85.49, 'new': 93.4}
2024-08-24 04:40:07,284 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28]
2024-08-24 04:40:07,284 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54]

Average Accuracy (CNN): 92.23
2024-08-24 04:40:07,285 [trainer.py] => Average Accuracy (CNN): 92.23 

2024-08-24 04:40:07,285 [trainer.py] => Train Time: 13448.999999999998
2024-08-24 04:40:07,285 [trainer.py] => Test Time: 208.92000000000002 

2024-08-24 04:40:07,286 [trainer.py] => All params: 171816392
2024-08-24 04:40:07,287 [trainer.py] => Trainable params: 122980
2024-08-24 04:40:07,287 [l2p.py] => Learning on 50-55
2024-08-24 04:52:44,590 [l2p.py] => Task 10, Epoch 20/20 => Loss -0.198, Train_accy 96.92, Test_accy 85.62
2024-08-24 04:53:25,832 [trainer.py] => No NME accuracy.
2024-08-24 04:53:25,832 [trainer.py] => CNN: {'total': 85.62, '00-04': 75.6, '05-09': 80.6, '10-14': 76.2, '15-19': 83.8, '20-24': 93.2, '25-29': 93.8, '30-34': 75.0, '35-39': 92.0, '40-44': 92.6, '45-49': 91.8, '50-54': 87.2, 'old': 85.46, 'new': 87.2}
2024-08-24 04:53:25,832 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62]
2024-08-24 04:53:25,833 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33]

Average Accuracy (CNN): 91.63
2024-08-24 04:53:25,833 [trainer.py] => Average Accuracy (CNN): 91.63 

2024-08-24 04:53:25,833 [trainer.py] => Train Time: 14963.529999999999
2024-08-24 04:53:25,833 [trainer.py] => Test Time: 250.16000000000003 

2024-08-24 04:53:25,836 [trainer.py] => All params: 171816392
2024-08-24 04:53:25,838 [trainer.py] => Trainable params: 122980
2024-08-24 04:53:25,838 [l2p.py] => Learning on 55-60
2024-08-24 05:06:15,129 [l2p.py] => Task 11, Epoch 20/20 => Loss -0.098, Train_accy 93.00, Test_accy 85.80
2024-08-24 05:06:59,777 [trainer.py] => No NME accuracy.
2024-08-24 05:06:59,778 [trainer.py] => CNN: {'total': 85.8, '00-04': 78.2, '05-09': 80.2, '10-14': 76.0, '15-19': 83.6, '20-24': 92.6, '25-29': 93.8, '30-34': 74.6, '35-39': 92.6, '40-44': 91.4, '45-49': 90.6, '50-54': 84.8, '55-59': 91.2, 'old': 85.31, 'new': 91.2}
2024-08-24 05:06:59,778 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8]
2024-08-24 05:06:59,778 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12]

Average Accuracy (CNN): 91.15
2024-08-24 05:06:59,778 [trainer.py] => Average Accuracy (CNN): 91.15 

2024-08-24 05:06:59,778 [trainer.py] => Train Time: 16502.0
2024-08-24 05:06:59,778 [trainer.py] => Test Time: 294.81 

2024-08-24 05:06:59,781 [trainer.py] => All params: 171816392
2024-08-24 05:06:59,783 [trainer.py] => Trainable params: 122980
2024-08-24 05:06:59,783 [l2p.py] => Learning on 60-65
2024-08-24 05:20:01,445 [l2p.py] => Task 12, Epoch 20/20 => Loss -0.193, Train_accy 96.92, Test_accy 85.00
2024-08-24 05:20:49,760 [trainer.py] => No NME accuracy.
2024-08-24 05:20:49,761 [trainer.py] => CNN: {'total': 85.0, '00-04': 80.2, '05-09': 80.2, '10-14': 76.2, '15-19': 79.2, '20-24': 91.8, '25-29': 93.2, '30-34': 75.2, '35-39': 91.8, '40-44': 90.2, '45-49': 91.4, '50-54': 83.2, '55-59': 78.4, '60-64': 94.0, 'old': 84.25, 'new': 94.0}
2024-08-24 05:20:49,761 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0]
2024-08-24 05:20:49,761 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02]

Average Accuracy (CNN): 90.67
2024-08-24 05:20:49,761 [trainer.py] => Average Accuracy (CNN): 90.67 

2024-08-24 05:20:49,761 [trainer.py] => Train Time: 18065.13
2024-08-24 05:20:49,761 [trainer.py] => Test Time: 343.12 

2024-08-24 05:20:49,763 [trainer.py] => All params: 171816392
2024-08-24 05:20:49,764 [trainer.py] => Trainable params: 122980
2024-08-24 05:20:49,764 [l2p.py] => Learning on 65-70
2024-08-24 05:34:05,458 [l2p.py] => Task 13, Epoch 20/20 => Loss -0.186, Train_accy 96.92, Test_accy 84.64
2024-08-24 05:34:57,303 [trainer.py] => No NME accuracy.
2024-08-24 05:34:57,304 [trainer.py] => CNN: {'total': 84.64, '00-04': 74.0, '05-09': 78.8, '10-14': 73.6, '15-19': 77.8, '20-24': 92.2, '25-29': 91.8, '30-34': 74.6, '35-39': 91.0, '40-44': 90.8, '45-49': 90.8, '50-54': 81.6, '55-59': 77.6, '60-64': 92.6, '65-69': 97.8, 'old': 83.63, 'new': 97.8}
2024-08-24 05:34:57,304 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0, 84.64]
2024-08-24 05:34:57,304 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02, 97.79]

Average Accuracy (CNN): 90.24
2024-08-24 05:34:57,304 [trainer.py] => Average Accuracy (CNN): 90.24 

2024-08-24 05:34:57,304 [trainer.py] => Train Time: 19656.430000000004
2024-08-24 05:34:57,304 [trainer.py] => Test Time: 394.96000000000004 

2024-08-24 05:34:57,306 [trainer.py] => All params: 171816392
2024-08-24 05:34:57,308 [trainer.py] => Trainable params: 122980
2024-08-24 05:34:57,308 [l2p.py] => Learning on 70-75
2024-08-24 05:48:28,767 [l2p.py] => Task 14, Epoch 20/20 => Loss -0.192, Train_accy 96.76, Test_accy 82.77
2024-08-24 05:49:24,376 [trainer.py] => No NME accuracy.
2024-08-24 05:49:24,377 [trainer.py] => CNN: {'total': 82.77, '00-04': 72.0, '05-09': 78.4, '10-14': 73.4, '15-19': 78.8, '20-24': 93.0, '25-29': 91.8, '30-34': 75.0, '35-39': 90.0, '40-44': 90.8, '45-49': 90.8, '50-54': 81.8, '55-59': 65.8, '60-64': 80.8, '65-69': 96.8, '70-74': 82.4, 'old': 82.8, 'new': 82.4}
2024-08-24 05:49:24,377 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0, 84.64, 82.77]
2024-08-24 05:49:24,377 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02, 97.79, 98.07]

Average Accuracy (CNN): 89.74
2024-08-24 05:49:24,377 [trainer.py] => Average Accuracy (CNN): 89.74 

2024-08-24 05:49:24,377 [trainer.py] => Train Time: 21279.250000000004
2024-08-24 05:49:24,377 [trainer.py] => Test Time: 450.57000000000005 

2024-08-24 05:49:24,378 [trainer.py] => All params: 171816392
2024-08-24 05:49:24,379 [trainer.py] => Trainable params: 122980
2024-08-24 05:49:24,379 [l2p.py] => Learning on 75-80
2024-08-24 06:03:12,042 [l2p.py] => Task 15, Epoch 20/20 => Loss -0.210, Train_accy 97.28, Test_accy 81.78
2024-08-24 06:04:11,283 [trainer.py] => No NME accuracy.
2024-08-24 06:04:11,283 [trainer.py] => CNN: {'total': 81.78, '00-04': 71.0, '05-09': 80.6, '10-14': 73.2, '15-19': 78.4, '20-24': 91.4, '25-29': 91.8, '30-34': 75.2, '35-39': 89.6, '40-44': 90.2, '45-49': 90.2, '50-54': 73.8, '55-59': 67.0, '60-64': 80.6, '65-69': 96.8, '70-74': 84.2, '75-79': 74.4, 'old': 82.27, 'new': 74.4}
2024-08-24 06:04:11,283 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0, 84.64, 82.77, 81.78]
2024-08-24 06:04:11,283 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02, 97.79, 98.07, 97.95]

Average Accuracy (CNN): 89.25
2024-08-24 06:04:11,283 [trainer.py] => Average Accuracy (CNN): 89.25 

2024-08-24 06:04:11,284 [trainer.py] => Train Time: 22934.49
2024-08-24 06:04:11,284 [trainer.py] => Test Time: 509.81000000000006 

2024-08-24 06:04:11,285 [trainer.py] => All params: 171816392
2024-08-24 06:04:11,286 [trainer.py] => Trainable params: 122980
2024-08-24 06:04:11,286 [l2p.py] => Learning on 80-85
2024-08-24 06:18:09,632 [l2p.py] => Task 16, Epoch 20/20 => Loss -0.229, Train_accy 98.40, Test_accy 80.34
2024-08-24 06:19:12,050 [trainer.py] => No NME accuracy.
2024-08-24 06:19:12,050 [trainer.py] => CNN: {'total': 80.34, '00-04': 72.4, '05-09': 75.8, '10-14': 72.0, '15-19': 77.4, '20-24': 91.2, '25-29': 90.6, '30-34': 72.8, '35-39': 89.2, '40-44': 88.4, '45-49': 89.0, '50-54': 71.0, '55-59': 65.2, '60-64': 77.6, '65-69': 96.4, '70-74': 82.4, '75-79': 70.6, '80-84': 83.8, 'old': 80.12, 'new': 83.8}
2024-08-24 06:19:12,050 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0, 84.64, 82.77, 81.78, 80.34]
2024-08-24 06:19:12,051 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02, 97.79, 98.07, 97.95, 97.71]

Average Accuracy (CNN): 88.72
2024-08-24 06:19:12,051 [trainer.py] => Average Accuracy (CNN): 88.72 

2024-08-24 06:19:12,051 [trainer.py] => Train Time: 24611.100000000002
2024-08-24 06:19:12,051 [trainer.py] => Test Time: 572.23 

2024-08-24 06:19:12,053 [trainer.py] => All params: 171816392
2024-08-24 06:19:12,055 [trainer.py] => Trainable params: 122980
2024-08-24 06:19:12,055 [l2p.py] => Learning on 85-90
2024-08-24 06:33:24,658 [l2p.py] => Task 17, Epoch 20/20 => Loss -0.116, Train_accy 93.60, Test_accy 80.43
2024-08-24 06:34:30,851 [trainer.py] => No NME accuracy.
2024-08-24 06:34:30,852 [trainer.py] => CNN: {'total': 80.43, '00-04': 68.8, '05-09': 77.2, '10-14': 72.0, '15-19': 77.4, '20-24': 92.4, '25-29': 91.8, '30-34': 74.4, '35-39': 88.2, '40-44': 89.8, '45-49': 88.6, '50-54': 72.4, '55-59': 65.4, '60-64': 76.8, '65-69': 95.6, '70-74': 84.4, '75-79': 71.2, '80-84': 85.2, '85-89': 76.2, 'old': 80.68, 'new': 76.2}
2024-08-24 06:34:30,852 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0, 84.64, 82.77, 81.78, 80.34, 80.43]
2024-08-24 06:34:30,852 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02, 97.79, 98.07, 97.95, 97.71, 97.61]

Average Accuracy (CNN): 88.26
2024-08-24 06:34:30,852 [trainer.py] => Average Accuracy (CNN): 88.26 

2024-08-24 06:34:30,852 [trainer.py] => Train Time: 26316.190000000002
2024-08-24 06:34:30,852 [trainer.py] => Test Time: 638.4200000000001 

2024-08-24 06:34:30,854 [trainer.py] => All params: 171816392
2024-08-24 06:34:30,855 [trainer.py] => Trainable params: 122980
2024-08-24 06:34:30,855 [l2p.py] => Learning on 90-95
2024-08-24 06:49:01,319 [l2p.py] => Task 18, Epoch 20/20 => Loss -0.182, Train_accy 96.48, Test_accy 81.18
2024-08-24 06:50:11,767 [trainer.py] => No NME accuracy.
2024-08-24 06:50:11,767 [trainer.py] => CNN: {'total': 81.18, '00-04': 68.0, '05-09': 78.4, '10-14': 73.2, '15-19': 77.4, '20-24': 92.8, '25-29': 90.6, '30-34': 74.8, '35-39': 89.0, '40-44': 89.4, '45-49': 88.6, '50-54': 71.4, '55-59': 67.0, '60-64': 77.4, '65-69': 95.8, '70-74': 85.6, '75-79': 71.0, '80-84': 84.2, '85-89': 74.6, '90-94': 93.2, 'old': 80.51, 'new': 93.2}
2024-08-24 06:50:11,767 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0, 84.64, 82.77, 81.78, 80.34, 80.43, 81.18]
2024-08-24 06:50:11,767 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02, 97.79, 98.07, 97.95, 97.71, 97.61, 97.23]

Average Accuracy (CNN): 87.89
2024-08-24 06:50:11,767 [trainer.py] => Average Accuracy (CNN): 87.89 

2024-08-24 06:50:11,768 [trainer.py] => Train Time: 28057.02
2024-08-24 06:50:11,768 [trainer.py] => Test Time: 708.8700000000001 

2024-08-24 06:50:11,770 [trainer.py] => All params: 171816392
2024-08-24 06:50:11,771 [trainer.py] => Trainable params: 122980
2024-08-24 06:50:11,771 [l2p.py] => Learning on 95-100
2024-08-24 07:04:58,605 [l2p.py] => Task 19, Epoch 20/20 => Loss -0.184, Train_accy 96.24, Test_accy 81.66
2024-08-24 07:06:12,980 [trainer.py] => No NME accuracy.
2024-08-24 07:06:12,981 [trainer.py] => CNN: {'total': 81.66, '00-04': 68.2, '05-09': 78.0, '10-14': 73.2, '15-19': 79.8, '20-24': 92.6, '25-29': 90.6, '30-34': 76.0, '35-39': 89.2, '40-44': 91.0, '45-49': 86.6, '50-54': 74.2, '55-59': 69.0, '60-64': 76.8, '65-69': 94.8, '70-74': 87.0, '75-79': 72.2, '80-84': 86.0, '85-89': 72.2, '90-94': 92.8, '95-99': 83.0, 'old': 81.59, 'new': 83.0}
2024-08-24 07:06:12,981 [trainer.py] => CNN top1 curve: [98.6, 96.1, 95.4, 94.25, 94.04, 91.5, 89.6, 89.35, 87.2, 86.28, 85.62, 85.8, 85.0, 84.64, 82.77, 81.78, 80.34, 80.43, 81.18, 81.66]
2024-08-24 07:06:12,981 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.73, 99.15, 99.12, 98.93, 98.83, 98.65, 98.42, 98.54, 98.33, 98.12, 98.02, 97.79, 98.07, 97.95, 97.71, 97.61, 97.23, 97.25]

Average Accuracy (CNN): 87.58
2024-08-24 07:06:12,981 [trainer.py] => Average Accuracy (CNN): 87.58 

2024-08-24 07:06:12,981 [trainer.py] => Train Time: 29830.59
2024-08-24 07:06:12,981 [trainer.py] => Test Time: 783.2400000000001 

Accuracy Matrix (CNN):
[[98.6 96.6 95.8 94.8 94.8 94.6 94.4 90.8 79.6 79.2 75.6 78.2 80.2 74.
  72.  71.  72.4 68.8 68.  68.2]
 [ 0.  95.6 93.8 94.6 94.4 81.8 82.  80.8 81.8 79.8 80.6 80.2 80.2 78.8
  78.4 80.6 75.8 77.2 78.4 78. ]
 [ 0.   0.  96.6 96.8 95.  92.8 93.2 91.2 81.2 78.  76.2 76.  76.2 73.6
  73.4 73.2 72.  72.  73.2 73.2]
 [ 0.   0.   0.  90.8 89.  85.8 86.4 85.2 84.  83.4 83.8 83.6 79.2 77.8
  78.8 78.4 77.4 77.4 77.4 79.8]
 [ 0.   0.   0.   0.  97.  97.  95.4 95.  95.  94.6 93.2 92.6 91.8 92.2
  93.  91.4 91.2 92.4 92.8 92.6]
 [ 0.   0.   0.   0.   0.  97.  97.  96.6 95.8 95.  93.8 93.8 93.2 91.8
  91.8 91.8 90.6 91.8 90.6 90.6]
 [ 0.   0.   0.   0.   0.   0.  78.8 78.8 76.8 75.4 75.  74.6 75.2 74.6
  75.  75.2 72.8 74.4 74.8 76. ]
 [ 0.   0.   0.   0.   0.   0.   0.  96.4 96.6 91.8 92.  92.6 91.8 91.
  90.  89.6 89.2 88.2 89.  89.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  94.  92.2 92.6 91.4 90.2 90.8
  90.8 90.2 88.4 89.8 89.4 91. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  93.4 91.8 90.6 91.4 90.8
  90.8 90.2 89.  88.6 88.6 86.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  87.2 84.8 83.2 81.6
  81.8 73.8 71.  72.4 71.4 74.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  91.2 78.4 77.6
  65.8 67.  65.2 65.4 67.  69. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  94.  92.6
  80.8 80.6 77.6 76.8 77.4 76.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  97.8
  96.8 96.8 96.4 95.6 95.8 94.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  82.4 84.2 82.4 84.4 85.6 87. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  74.4 70.6 71.2 71.  72.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  83.8 85.2 84.2 86. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  76.2 74.6 72.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  93.2 92.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  83. ]]
2024-08-24 07:06:12,984 [trainer.py] => Forgetting (CNN): 9.23157894736842
2024-08-24 07:06:16,546 [trainer.py] => config: ./exps/l2p_cifar_B50_Inc5.json
2024-08-24 07:06:16,546 [trainer.py] => prefix:  
2024-08-24 07:06:16,546 [trainer.py] => dataset: cifar224
2024-08-24 07:06:16,546 [trainer.py] => memory_size: 0
2024-08-24 07:06:16,546 [trainer.py] => memory_per_class: 0
2024-08-24 07:06:16,546 [trainer.py] => fixed_memory: False
2024-08-24 07:06:16,546 [trainer.py] => shuffle: True
2024-08-24 07:06:16,546 [trainer.py] => init_cls: 50
2024-08-24 07:06:16,546 [trainer.py] => increment: 10
2024-08-24 07:06:16,546 [trainer.py] => model_name: l2p
2024-08-24 07:06:16,546 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-08-24 07:06:16,553 [trainer.py] => get_original_backbone: True
2024-08-24 07:06:16,553 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-24 07:06:16,553 [trainer.py] => seed: 1993
2024-08-24 07:06:16,553 [trainer.py] => tuned_epoch: 20
2024-08-24 07:06:16,553 [trainer.py] => init_lr: 0.001875
2024-08-24 07:06:16,553 [trainer.py] => batch_size: 48
2024-08-24 07:06:16,553 [trainer.py] => weight_decay: 0
2024-08-24 07:06:16,553 [trainer.py] => min_lr: 1e-05
2024-08-24 07:06:16,553 [trainer.py] => optimizer: adam
2024-08-24 07:06:16,553 [trainer.py] => scheduler: constant
2024-08-24 07:06:16,553 [trainer.py] => reinit_optimizer: True
2024-08-24 07:06:16,553 [trainer.py] => global_pool: token
2024-08-24 07:06:16,553 [trainer.py] => head_type: prompt
2024-08-24 07:06:16,553 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-24 07:06:16,553 [trainer.py] => pretrained: True
2024-08-24 07:06:16,553 [trainer.py] => drop: 0.0
2024-08-24 07:06:16,553 [trainer.py] => drop_path: 0.0
2024-08-24 07:06:16,554 [trainer.py] => prompt_pool: True
2024-08-24 07:06:16,554 [trainer.py] => size: 10
2024-08-24 07:06:16,554 [trainer.py] => length: 5
2024-08-24 07:06:16,554 [trainer.py] => top_k: 5
2024-08-24 07:06:16,554 [trainer.py] => initializer: uniform
2024-08-24 07:06:16,554 [trainer.py] => prompt_key: True
2024-08-24 07:06:16,554 [trainer.py] => prompt_key_init: uniform
2024-08-24 07:06:16,554 [trainer.py] => use_prompt_mask: False
2024-08-24 07:06:16,554 [trainer.py] => shared_prompt_pool: False
2024-08-24 07:06:16,554 [trainer.py] => shared_prompt_key: False
2024-08-24 07:06:16,554 [trainer.py] => batchwise_prompt: True
2024-08-24 07:06:16,554 [trainer.py] => embedding_key: cls
2024-08-24 07:06:16,554 [trainer.py] => predefined_key: 
2024-08-24 07:06:16,554 [trainer.py] => pull_constraint: True
2024-08-24 07:06:16,554 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-24 07:06:18,229 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-24 07:06:20,604 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-08-24 07:06:20,605 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-08-24 07:06:25,050 [l2p.py] => 85,940,836 model total parameters.
2024-08-24 07:06:25,051 [l2p.py] => 122,980 model training parameters.
2024-08-24 07:06:25,051 [l2p.py] => prompt.prompt: 38400
2024-08-24 07:06:25,051 [l2p.py] => prompt.prompt_key: 7680
2024-08-24 07:06:25,051 [l2p.py] => head.weight: 76800
2024-08-24 07:06:25,051 [l2p.py] => head.bias: 100
2024-08-24 07:06:25,052 [trainer.py] => All params: 171816392
2024-08-24 07:06:25,053 [trainer.py] => Trainable params: 122980
2024-08-24 07:06:25,053 [l2p.py] => Learning on 0-50
2024-08-24 08:44:18,499 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.252, Train_accy 84.96, Test_accy 94.24
2024-08-24 08:44:55,865 [trainer.py] => No NME accuracy.
2024-08-24 08:44:55,865 [trainer.py] => CNN: {'total': 94.24, '00-49': 94.24, 'old': 0, 'new': 94.24}
2024-08-24 08:44:55,865 [trainer.py] => CNN top1 curve: [94.24]
2024-08-24 08:44:55,865 [trainer.py] => CNN top5 curve: [99.36]

Average Accuracy (CNN): 94.24
2024-08-24 08:44:55,866 [trainer.py] => Average Accuracy (CNN): 94.24 

2024-08-24 08:44:55,866 [trainer.py] => Train Time: 11743.45
2024-08-24 08:44:55,866 [trainer.py] => Test Time: 37.36 

2024-08-24 08:44:55,868 [trainer.py] => All params: 171816392
2024-08-24 08:44:55,870 [trainer.py] => Trainable params: 122980
2024-08-24 08:44:55,870 [l2p.py] => Learning on 50-60
2024-08-24 09:07:13,999 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.104, Train_accy 93.72, Test_accy 91.75
2024-08-24 09:07:58,487 [trainer.py] => No NME accuracy.
2024-08-24 09:07:58,488 [trainer.py] => CNN: {'total': 91.75, '00-49': 93.9, '50-59': 81.0, 'old': 93.9, 'new': 81.0}
2024-08-24 09:07:58,489 [trainer.py] => CNN top1 curve: [94.24, 91.75]
2024-08-24 09:07:58,489 [trainer.py] => CNN top5 curve: [99.36, 99.15]

Average Accuracy (CNN): 93.0
2024-08-24 09:07:58,489 [trainer.py] => Average Accuracy (CNN): 93.0 

2024-08-24 09:07:58,489 [trainer.py] => Train Time: 14419.56
2024-08-24 09:07:58,489 [trainer.py] => Test Time: 81.84 

2024-08-24 09:07:58,490 [trainer.py] => All params: 171816392
2024-08-24 09:07:58,492 [trainer.py] => Trainable params: 122980
2024-08-24 09:07:58,492 [l2p.py] => Learning on 60-70
2024-08-24 09:30:47,242 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.109, Train_accy 94.80, Test_accy 89.97
2024-08-24 09:31:39,040 [trainer.py] => No NME accuracy.
2024-08-24 09:31:39,041 [trainer.py] => CNN: {'total': 89.97, '00-49': 93.74, '50-59': 79.4, '60-69': 81.7, 'old': 91.35, 'new': 81.7}
2024-08-24 09:31:39,041 [trainer.py] => CNN top1 curve: [94.24, 91.75, 89.97]
2024-08-24 09:31:39,041 [trainer.py] => CNN top5 curve: [99.36, 99.15, 99.07]

Average Accuracy (CNN): 91.99
2024-08-24 09:31:39,042 [trainer.py] => Average Accuracy (CNN): 91.99 

2024-08-24 09:31:39,042 [trainer.py] => Train Time: 17156.95
2024-08-24 09:31:39,042 [trainer.py] => Test Time: 133.64 

2024-08-24 09:31:39,045 [trainer.py] => All params: 171816392
2024-08-24 09:31:39,047 [trainer.py] => Trainable params: 122980
2024-08-24 09:31:39,047 [l2p.py] => Learning on 70-80
2024-08-24 09:54:57,144 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.095, Train_accy 93.90, Test_accy 86.11
2024-08-24 09:55:56,251 [trainer.py] => No NME accuracy.
2024-08-24 09:55:56,251 [trainer.py] => CNN: {'total': 86.11, '00-49': 93.94, '50-59': 79.4, '60-69': 77.3, '70-79': 62.5, 'old': 89.49, 'new': 62.5}
2024-08-24 09:55:56,251 [trainer.py] => CNN top1 curve: [94.24, 91.75, 89.97, 86.11]
2024-08-24 09:55:56,251 [trainer.py] => CNN top5 curve: [99.36, 99.15, 99.07, 98.94]

Average Accuracy (CNN): 90.52
2024-08-24 09:55:56,251 [trainer.py] => Average Accuracy (CNN): 90.52 

2024-08-24 09:55:56,251 [trainer.py] => Train Time: 19953.0
2024-08-24 09:55:56,251 [trainer.py] => Test Time: 192.75 

2024-08-24 09:55:56,253 [trainer.py] => All params: 171816392
2024-08-24 09:55:56,253 [trainer.py] => Trainable params: 122980
2024-08-24 09:55:56,254 [l2p.py] => Learning on 80-90
2024-08-24 10:19:41,079 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.118, Train_accy 94.54, Test_accy 82.34
2024-08-24 10:20:47,657 [trainer.py] => No NME accuracy.
2024-08-24 10:20:47,658 [trainer.py] => CNN: {'total': 82.34, '00-49': 93.6, '50-59': 77.9, '60-69': 77.0, '70-79': 59.4, '80-89': 58.8, 'old': 85.29, 'new': 58.8}
2024-08-24 10:20:47,658 [trainer.py] => CNN top1 curve: [94.24, 91.75, 89.97, 86.11, 82.34]
2024-08-24 10:20:47,658 [trainer.py] => CNN top5 curve: [99.36, 99.15, 99.07, 98.94, 98.41]

Average Accuracy (CNN): 88.88
2024-08-24 10:20:47,658 [trainer.py] => Average Accuracy (CNN): 88.88 

2024-08-24 10:20:47,658 [trainer.py] => Train Time: 22802.43
2024-08-24 10:20:47,658 [trainer.py] => Test Time: 259.33 

2024-08-24 10:20:47,661 [trainer.py] => All params: 171816392
2024-08-24 10:20:47,662 [trainer.py] => Trainable params: 122980
2024-08-24 10:20:47,663 [l2p.py] => Learning on 90-100
2024-08-24 10:45:03,070 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.085, Train_accy 93.34, Test_accy 81.22
2024-08-24 10:46:16,832 [trainer.py] => No NME accuracy.
2024-08-24 10:46:16,833 [trainer.py] => CNN: {'total': 81.22, '00-49': 93.54, '50-59': 77.0, '60-69': 77.0, '70-79': 60.2, '80-89': 58.3, '90-99': 72.0, 'old': 82.24, 'new': 72.0}
2024-08-24 10:46:16,833 [trainer.py] => CNN top1 curve: [94.24, 91.75, 89.97, 86.11, 82.34, 81.22]
2024-08-24 10:46:16,833 [trainer.py] => CNN top5 curve: [99.36, 99.15, 99.07, 98.94, 98.41, 98.05]

Average Accuracy (CNN): 87.61
2024-08-24 10:46:16,833 [trainer.py] => Average Accuracy (CNN): 87.61 

2024-08-24 10:46:16,833 [trainer.py] => Train Time: 25713.100000000002
2024-08-24 10:46:16,833 [trainer.py] => Test Time: 333.09 

Accuracy Matrix (CNN):
[[94.24 93.9  93.74 93.94 93.6  93.54]
 [ 0.   81.   79.4  79.4  77.9  77.  ]
 [ 0.    0.   81.7  77.3  77.   77.  ]
 [ 0.    0.    0.   62.5  59.4  60.2 ]
 [ 0.    0.    0.    0.   58.8  58.3 ]
 [ 0.    0.    0.    0.    0.   72.  ]]
2024-08-24 10:46:16,834 [trainer.py] => Forgetting (CNN): 2.4399999999999977
2024-08-24 10:46:19,853 [trainer.py] => config: ./exps/l2p_cifar_B50_Inc10.json
2024-08-24 10:46:19,853 [trainer.py] => prefix:  
2024-08-24 10:46:19,853 [trainer.py] => dataset: cifar224
2024-08-24 10:46:19,853 [trainer.py] => memory_size: 0
2024-08-24 10:46:19,854 [trainer.py] => memory_per_class: 0
2024-08-24 10:46:19,854 [trainer.py] => fixed_memory: False
2024-08-24 10:46:19,854 [trainer.py] => shuffle: True
2024-08-24 10:46:19,854 [trainer.py] => init_cls: 50
2024-08-24 10:46:19,854 [trainer.py] => increment: 5
2024-08-24 10:46:19,854 [trainer.py] => model_name: l2p
2024-08-24 10:46:19,854 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-08-24 10:46:19,859 [trainer.py] => get_original_backbone: True
2024-08-24 10:46:19,859 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-24 10:46:19,859 [trainer.py] => seed: 1993
2024-08-24 10:46:19,859 [trainer.py] => tuned_epoch: 20
2024-08-24 10:46:19,859 [trainer.py] => init_lr: 0.001875
2024-08-24 10:46:19,859 [trainer.py] => batch_size: 48
2024-08-24 10:46:19,859 [trainer.py] => weight_decay: 0
2024-08-24 10:46:19,859 [trainer.py] => min_lr: 1e-05
2024-08-24 10:46:19,859 [trainer.py] => optimizer: adam
2024-08-24 10:46:19,859 [trainer.py] => scheduler: constant
2024-08-24 10:46:19,859 [trainer.py] => reinit_optimizer: True
2024-08-24 10:46:19,859 [trainer.py] => global_pool: token
2024-08-24 10:46:19,859 [trainer.py] => head_type: prompt
2024-08-24 10:46:19,859 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-24 10:46:19,859 [trainer.py] => pretrained: True
2024-08-24 10:46:19,859 [trainer.py] => drop: 0.0
2024-08-24 10:46:19,859 [trainer.py] => drop_path: 0.0
2024-08-24 10:46:19,859 [trainer.py] => prompt_pool: True
2024-08-24 10:46:19,859 [trainer.py] => size: 10
2024-08-24 10:46:19,859 [trainer.py] => length: 5
2024-08-24 10:46:19,859 [trainer.py] => top_k: 5
2024-08-24 10:46:19,859 [trainer.py] => initializer: uniform
2024-08-24 10:46:19,859 [trainer.py] => prompt_key: True
2024-08-24 10:46:19,859 [trainer.py] => prompt_key_init: uniform
2024-08-24 10:46:19,859 [trainer.py] => use_prompt_mask: False
2024-08-24 10:46:19,859 [trainer.py] => shared_prompt_pool: False
2024-08-24 10:46:19,860 [trainer.py] => shared_prompt_key: False
2024-08-24 10:46:19,860 [trainer.py] => batchwise_prompt: True
2024-08-24 10:46:19,860 [trainer.py] => embedding_key: cls
2024-08-24 10:46:19,860 [trainer.py] => predefined_key: 
2024-08-24 10:46:19,860 [trainer.py] => pull_constraint: True
2024-08-24 10:46:19,860 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-24 10:46:21,550 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-24 10:46:24,244 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-08-24 10:46:24,244 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-08-24 10:46:28,629 [l2p.py] => 85,940,836 model total parameters.
2024-08-24 10:46:28,629 [l2p.py] => 122,980 model training parameters.
2024-08-24 10:46:28,629 [l2p.py] => prompt.prompt: 38400
2024-08-24 10:46:28,629 [l2p.py] => prompt.prompt_key: 7680
2024-08-24 10:46:28,630 [l2p.py] => head.weight: 76800
2024-08-24 10:46:28,630 [l2p.py] => head.bias: 100
2024-08-24 10:46:28,631 [trainer.py] => All params: 171816392
2024-08-24 10:46:28,632 [trainer.py] => Trainable params: 122980
2024-08-24 10:46:28,632 [l2p.py] => Learning on 0-50
2024-08-24 12:24:19,613 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.252, Train_accy 84.96, Test_accy 94.24
2024-08-24 12:24:56,915 [trainer.py] => No NME accuracy.
2024-08-24 12:24:56,915 [trainer.py] => CNN: {'total': 94.24, '00-49': 94.24, 'old': 0, 'new': 94.24}
2024-08-24 12:24:56,915 [trainer.py] => CNN top1 curve: [94.24]
2024-08-24 12:24:56,915 [trainer.py] => CNN top5 curve: [99.36]

Average Accuracy (CNN): 94.24
2024-08-24 12:24:56,916 [trainer.py] => Average Accuracy (CNN): 94.24 

2024-08-24 12:24:56,916 [trainer.py] => Train Time: 11738.43
2024-08-24 12:24:56,916 [trainer.py] => Test Time: 37.3 

2024-08-24 12:24:56,919 [trainer.py] => All params: 171816392
2024-08-24 12:24:56,921 [trainer.py] => Trainable params: 122980
2024-08-24 12:24:56,921 [l2p.py] => Learning on 50-55
2024-08-24 12:37:28,079 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.220, Train_accy 97.28, Test_accy 90.20
2024-08-24 12:38:08,967 [trainer.py] => No NME accuracy.
2024-08-24 12:38:08,968 [trainer.py] => CNN: {'total': 90.2, '00-49': 94.04, '50-54': 51.8, 'old': 94.04, 'new': 51.8}
2024-08-24 12:38:08,968 [trainer.py] => CNN top1 curve: [94.24, 90.2]
2024-08-24 12:38:08,968 [trainer.py] => CNN top5 curve: [99.36, 99.18]

Average Accuracy (CNN): 92.22
2024-08-24 12:38:08,968 [trainer.py] => Average Accuracy (CNN): 92.22 

2024-08-24 12:38:08,968 [trainer.py] => Train Time: 13240.650000000001
2024-08-24 12:38:08,968 [trainer.py] => Test Time: 78.19 

2024-08-24 12:38:08,970 [trainer.py] => All params: 171816392
2024-08-24 12:38:08,971 [trainer.py] => Trainable params: 122980
2024-08-24 12:38:08,971 [l2p.py] => Learning on 55-60
2024-08-24 12:50:57,744 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.120, Train_accy 92.76, Test_accy 86.67
2024-08-24 12:51:42,704 [trainer.py] => No NME accuracy.
2024-08-24 12:51:42,705 [trainer.py] => CNN: {'total': 86.67, '00-49': 93.62, '50-54': 46.6, '55-59': 57.2, 'old': 89.35, 'new': 57.2}
2024-08-24 12:51:42,705 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67]
2024-08-24 12:51:42,705 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48]

Average Accuracy (CNN): 90.37
2024-08-24 12:51:42,705 [trainer.py] => Average Accuracy (CNN): 90.37 

2024-08-24 12:51:42,705 [trainer.py] => Train Time: 14778.12
2024-08-24 12:51:42,705 [trainer.py] => Test Time: 123.15 

2024-08-24 12:51:42,707 [trainer.py] => All params: 171816392
2024-08-24 12:51:42,708 [trainer.py] => Trainable params: 122980
2024-08-24 12:51:42,708 [l2p.py] => Learning on 60-65
2024-08-24 13:04:45,529 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.179, Train_accy 96.72, Test_accy 84.23
2024-08-24 13:05:33,887 [trainer.py] => No NME accuracy.
2024-08-24 13:05:33,887 [trainer.py] => CNN: {'total': 84.23, '00-49': 93.28, '50-54': 43.8, '55-59': 54.6, '60-64': 63.8, 'old': 85.93, 'new': 63.8}
2024-08-24 13:05:33,887 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23]
2024-08-24 13:05:33,887 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22]

Average Accuracy (CNN): 88.84
2024-08-24 13:05:33,887 [trainer.py] => Average Accuracy (CNN): 88.84 

2024-08-24 13:05:33,888 [trainer.py] => Train Time: 16343.690000000002
2024-08-24 13:05:33,888 [trainer.py] => Test Time: 171.51 

2024-08-24 13:05:33,889 [trainer.py] => All params: 171816392
2024-08-24 13:05:33,890 [trainer.py] => Trainable params: 122980
2024-08-24 13:05:33,891 [l2p.py] => Learning on 65-70
2024-08-24 13:18:48,745 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.222, Train_accy 97.92, Test_accy 81.44
2024-08-24 13:19:40,959 [trainer.py] => No NME accuracy.
2024-08-24 13:19:40,960 [trainer.py] => CNN: {'total': 81.44, '00-49': 93.3, '50-54': 43.4, '55-59': 49.6, '60-64': 61.8, '65-69': 52.4, 'old': 83.68, 'new': 52.4}
2024-08-24 13:19:40,960 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23, 81.44]
2024-08-24 13:19:40,960 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22, 98.09]

Average Accuracy (CNN): 87.36
2024-08-24 13:19:40,960 [trainer.py] => Average Accuracy (CNN): 87.36 

2024-08-24 13:19:40,960 [trainer.py] => Train Time: 17933.22
2024-08-24 13:19:40,960 [trainer.py] => Test Time: 223.72 

2024-08-24 13:19:40,962 [trainer.py] => All params: 171816392
2024-08-24 13:19:40,963 [trainer.py] => Trainable params: 122980
2024-08-24 13:19:40,963 [l2p.py] => Learning on 70-75
2024-08-24 13:33:11,933 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.204, Train_accy 97.44, Test_accy 78.84
2024-08-24 13:34:07,787 [trainer.py] => No NME accuracy.
2024-08-24 13:34:07,787 [trainer.py] => CNN: {'total': 78.84, '00-49': 93.74, '50-54': 45.0, '55-59': 44.4, '60-64': 54.4, '65-69': 52.2, '70-74': 49.2, 'old': 80.96, 'new': 49.2}
2024-08-24 13:34:07,787 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23, 81.44, 78.84]
2024-08-24 13:34:07,787 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22, 98.09, 97.77]

Average Accuracy (CNN): 85.94
2024-08-24 13:34:07,787 [trainer.py] => Average Accuracy (CNN): 85.94 

2024-08-24 13:34:07,788 [trainer.py] => Train Time: 19555.09
2024-08-24 13:34:07,788 [trainer.py] => Test Time: 279.57 

2024-08-24 13:34:07,790 [trainer.py] => All params: 171816392
2024-08-24 13:34:07,791 [trainer.py] => Trainable params: 122980
2024-08-24 13:34:07,792 [l2p.py] => Learning on 75-80
2024-08-24 13:47:56,964 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.221, Train_accy 97.36, Test_accy 76.10
2024-08-24 13:48:56,105 [trainer.py] => No NME accuracy.
2024-08-24 13:48:56,107 [trainer.py] => CNN: {'total': 76.1, '00-49': 93.74, '50-54': 47.0, '55-59': 45.2, '60-64': 52.6, '65-69': 53.2, '70-74': 48.6, '75-79': 33.6, 'old': 78.93, 'new': 33.6}
2024-08-24 13:48:56,107 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23, 81.44, 78.84, 76.1]
2024-08-24 13:48:56,107 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22, 98.09, 97.77, 97.68]

Average Accuracy (CNN): 84.53
2024-08-24 13:48:56,107 [trainer.py] => Average Accuracy (CNN): 84.53 

2024-08-24 13:48:56,107 [trainer.py] => Train Time: 21213.34
2024-08-24 13:48:56,107 [trainer.py] => Test Time: 338.71 

2024-08-24 13:48:56,109 [trainer.py] => All params: 171816392
2024-08-24 13:48:56,111 [trainer.py] => Trainable params: 122980
2024-08-24 13:48:56,111 [l2p.py] => Learning on 80-85
2024-08-24 14:02:55,434 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.211, Train_accy 97.84, Test_accy 72.11
2024-08-24 14:03:58,039 [trainer.py] => No NME accuracy.
2024-08-24 14:03:58,039 [trainer.py] => CNN: {'total': 72.11, '00-49': 93.2, '50-54': 44.2, '55-59': 42.4, '60-64': 52.4, '65-69': 52.8, '70-74': 46.4, '75-79': 30.6, '80-84': 25.0, 'old': 75.05, 'new': 25.0}
2024-08-24 14:03:58,039 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23, 81.44, 78.84, 76.1, 72.11]
2024-08-24 14:03:58,039 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22, 98.09, 97.77, 97.68, 97.18]

Average Accuracy (CNN): 82.98
2024-08-24 14:03:58,040 [trainer.py] => Average Accuracy (CNN): 82.98 

2024-08-24 14:03:58,040 [trainer.py] => Train Time: 22891.83
2024-08-24 14:03:58,040 [trainer.py] => Test Time: 401.31 

2024-08-24 14:03:58,041 [trainer.py] => All params: 171816392
2024-08-24 14:03:58,042 [trainer.py] => Trainable params: 122980
2024-08-24 14:03:58,042 [l2p.py] => Learning on 85-90
2024-08-24 14:18:11,841 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.131, Train_accy 94.52, Test_accy 71.11
2024-08-24 14:19:18,629 [trainer.py] => No NME accuracy.
2024-08-24 14:19:18,630 [trainer.py] => CNN: {'total': 71.11, '00-49': 93.78, '50-54': 44.6, '55-59': 46.2, '60-64': 48.6, '65-69': 53.6, '70-74': 50.0, '75-79': 29.4, '80-84': 23.8, '85-89': 46.0, 'old': 72.59, 'new': 46.0}
2024-08-24 14:19:18,630 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23, 81.44, 78.84, 76.1, 72.11, 71.11]
2024-08-24 14:19:18,631 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22, 98.09, 97.77, 97.68, 97.18, 96.98]

Average Accuracy (CNN): 81.66
2024-08-24 14:19:18,631 [trainer.py] => Average Accuracy (CNN): 81.66 

2024-08-24 14:19:18,631 [trainer.py] => Train Time: 24599.34
2024-08-24 14:19:18,631 [trainer.py] => Test Time: 468.1 

2024-08-24 14:19:18,633 [trainer.py] => All params: 171816392
2024-08-24 14:19:18,635 [trainer.py] => Trainable params: 122980
2024-08-24 14:19:18,635 [l2p.py] => Learning on 90-95
2024-08-24 14:33:48,005 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.190, Train_accy 96.60, Test_accy 70.36
2024-08-24 14:34:57,933 [trainer.py] => No NME accuracy.
2024-08-24 14:34:57,933 [trainer.py] => CNN: {'total': 70.36, '00-49': 93.7, '50-54': 44.4, '55-59': 43.0, '60-64': 49.8, '65-69': 51.6, '70-74': 49.4, '75-79': 30.6, '80-84': 23.0, '85-89': 43.6, '90-94': 64.4, 'old': 70.69, 'new': 64.4}
2024-08-24 14:34:57,933 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23, 81.44, 78.84, 76.1, 72.11, 71.11, 70.36]
2024-08-24 14:34:57,933 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22, 98.09, 97.77, 97.68, 97.18, 96.98, 96.67]

Average Accuracy (CNN): 80.53
2024-08-24 14:34:57,934 [trainer.py] => Average Accuracy (CNN): 80.53 

2024-08-24 14:34:57,934 [trainer.py] => Train Time: 26337.81
2024-08-24 14:34:57,934 [trainer.py] => Test Time: 538.03 

2024-08-24 14:34:57,935 [trainer.py] => All params: 171816392
2024-08-24 14:34:57,937 [trainer.py] => Trainable params: 122980
2024-08-24 14:34:57,937 [l2p.py] => Learning on 95-100
2024-08-24 14:49:42,006 [l2p.py] => Task 10, Epoch 20/20 => Loss -0.166, Train_accy 95.28, Test_accy 68.29
2024-08-24 14:50:56,003 [trainer.py] => No NME accuracy.
2024-08-24 14:50:56,003 [trainer.py] => CNN: {'total': 68.29, '00-49': 94.18, '50-54': 45.8, '55-59': 42.6, '60-64': 46.0, '65-69': 52.0, '70-74': 45.8, '75-79': 29.8, '80-84': 22.0, '85-89': 42.0, '90-94': 61.2, '95-99': 36.8, 'old': 69.95, 'new': 36.8}
2024-08-24 14:50:56,003 [trainer.py] => CNN top1 curve: [94.24, 90.2, 86.67, 84.23, 81.44, 78.84, 76.1, 72.11, 71.11, 70.36, 68.29]
2024-08-24 14:50:56,003 [trainer.py] => CNN top5 curve: [99.36, 99.18, 98.48, 98.22, 98.09, 97.77, 97.68, 97.18, 96.98, 96.67, 95.96]

Average Accuracy (CNN): 79.42
2024-08-24 14:50:56,003 [trainer.py] => Average Accuracy (CNN): 79.42 

2024-08-24 14:50:56,003 [trainer.py] => Train Time: 28105.850000000002
2024-08-24 14:50:56,003 [trainer.py] => Test Time: 612.02 

Accuracy Matrix (CNN):
[[94.24 94.04 93.62 93.28 93.3  93.74 93.74 93.2  93.78 93.7  94.18]
 [ 0.   51.8  46.6  43.8  43.4  45.   47.   44.2  44.6  44.4  45.8 ]
 [ 0.    0.   57.2  54.6  49.6  44.4  45.2  42.4  46.2  43.   42.6 ]
 [ 0.    0.    0.   63.8  61.8  54.4  52.6  52.4  48.6  49.8  46.  ]
 [ 0.    0.    0.    0.   52.4  52.2  53.2  52.8  53.6  51.6  52.  ]
 [ 0.    0.    0.    0.    0.   49.2  48.6  46.4  50.   49.4  45.8 ]
 [ 0.    0.    0.    0.    0.    0.   33.6  30.6  29.4  30.6  29.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.   25.   23.8  23.   22.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   46.   43.6  42.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   64.4  61.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   36.8 ]]
2024-08-24 14:50:56,005 [trainer.py] => Forgetting (CNN): 5.825999999999999
2024-08-25 09:39:23,285 [trainer.py] => config: ./exps/dualprompt_cifar_B0_Inc5.json
2024-08-25 09:39:23,286 [trainer.py] => prefix:  
2024-08-25 09:39:23,286 [trainer.py] => dataset: cifar224
2024-08-25 09:39:23,286 [trainer.py] => memory_size: 0
2024-08-25 09:39:23,286 [trainer.py] => memory_per_class: 0
2024-08-25 09:39:23,286 [trainer.py] => fixed_memory: False
2024-08-25 09:39:23,286 [trainer.py] => shuffle: True
2024-08-25 09:39:23,286 [trainer.py] => init_cls: 20
2024-08-25 09:39:23,286 [trainer.py] => increment: 20
2024-08-25 09:39:23,286 [trainer.py] => model_name: dualprompt
2024-08-25 09:39:23,286 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-08-25 09:39:23,286 [trainer.py] => get_original_backbone: True
2024-08-25 09:39:23,286 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-25 09:39:23,286 [trainer.py] => seed: 1993
2024-08-25 09:39:23,286 [trainer.py] => tuned_epoch: 20
2024-08-25 09:39:23,286 [trainer.py] => init_lr: 0.001
2024-08-25 09:39:23,286 [trainer.py] => batch_size: 48
2024-08-25 09:39:23,286 [trainer.py] => weight_decay: 0
2024-08-25 09:39:23,286 [trainer.py] => min_lr: 1e-05
2024-08-25 09:39:23,286 [trainer.py] => optimizer: adam
2024-08-25 09:39:23,286 [trainer.py] => scheduler: constant
2024-08-25 09:39:23,286 [trainer.py] => reinit_optimizer: True
2024-08-25 09:39:23,286 [trainer.py] => global_pool: token
2024-08-25 09:39:23,286 [trainer.py] => head_type: token
2024-08-25 09:39:23,286 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-25 09:39:23,286 [trainer.py] => pretrained: True
2024-08-25 09:39:23,287 [trainer.py] => drop: 0.0
2024-08-25 09:39:23,287 [trainer.py] => drop_path: 0.0
2024-08-25 09:39:23,287 [trainer.py] => use_g_prompt: True
2024-08-25 09:39:23,287 [trainer.py] => g_prompt_length: 5
2024-08-25 09:39:23,287 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-08-25 09:39:23,287 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-08-25 09:39:23,287 [trainer.py] => use_e_prompt: True
2024-08-25 09:39:23,287 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-08-25 09:39:23,287 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-08-25 09:39:23,287 [trainer.py] => prompt_pool: True
2024-08-25 09:39:23,287 [trainer.py] => size: 10
2024-08-25 09:39:23,287 [trainer.py] => length: 5
2024-08-25 09:39:23,287 [trainer.py] => top_k: 1
2024-08-25 09:39:23,287 [trainer.py] => initializer: uniform
2024-08-25 09:39:23,287 [trainer.py] => prompt_key: True
2024-08-25 09:39:23,287 [trainer.py] => prompt_key_init: uniform
2024-08-25 09:39:23,287 [trainer.py] => use_prompt_mask: True
2024-08-25 09:39:23,287 [trainer.py] => shared_prompt_pool: True
2024-08-25 09:39:23,287 [trainer.py] => shared_prompt_key: False
2024-08-25 09:39:23,287 [trainer.py] => batchwise_prompt: True
2024-08-25 09:39:23,287 [trainer.py] => embedding_key: cls
2024-08-25 09:39:23,287 [trainer.py] => predefined_key: 
2024-08-25 09:39:23,287 [trainer.py] => pull_constraint: True
2024-08-25 09:39:23,287 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-25 09:39:23,287 [trainer.py] => same_key_value: False
2024-08-25 09:39:25,139 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-25 09:39:32,256 [dualprompt.py] => 86,128,996 model total parameters.
2024-08-25 09:39:32,256 [dualprompt.py] => 330,340 model training parameters.
2024-08-25 09:39:32,256 [dualprompt.py] => g_prompt: 15360
2024-08-25 09:39:32,256 [dualprompt.py] => e_prompt.prompt: 230400
2024-08-25 09:39:32,256 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-08-25 09:39:32,257 [dualprompt.py] => head.weight: 76800
2024-08-25 09:39:32,270 [dualprompt.py] => head.bias: 100
2024-08-25 09:39:32,271 [trainer.py] => All params: 172004552
2024-08-25 09:39:32,271 [trainer.py] => Trainable params: 330340
2024-08-25 09:39:32,271 [dualprompt.py] => Learning on 0-20
2024-08-25 10:15:07,717 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.301, Train_accy 89.22, Test_accy 96.30
2024-08-25 10:15:22,279 [trainer.py] => No NME accuracy.
2024-08-25 10:15:22,280 [trainer.py] => CNN: {'total': 96.3, '00-19': 96.3, 'old': 0, 'new': 96.3}
2024-08-25 10:15:22,280 [trainer.py] => CNN top1 curve: [96.3]
2024-08-25 10:15:22,280 [trainer.py] => CNN top5 curve: [99.55]

Average Accuracy (CNN): 96.3
2024-08-25 10:15:22,280 [trainer.py] => Average Accuracy (CNN): 96.3 

2024-08-25 10:15:22,281 [trainer.py] => All params: 172004552
2024-08-25 10:15:22,282 [trainer.py] => Trainable params: 330340
2024-08-25 10:15:22,282 [dualprompt.py] => Learning on 20-40
2024-08-25 10:51:53,601 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.207, Train_accy 91.59, Test_accy 93.52
2024-08-25 10:52:21,838 [trainer.py] => No NME accuracy.
2024-08-25 10:52:21,839 [trainer.py] => CNN: {'total': 93.52, '00-19': 92.55, '20-39': 94.5, 'old': 92.55, 'new': 94.5}
2024-08-25 10:52:21,839 [trainer.py] => CNN top1 curve: [96.3, 93.52]
2024-08-25 10:52:21,839 [trainer.py] => CNN top5 curve: [99.55, 99.2]

Average Accuracy (CNN): 94.91
2024-08-25 10:52:21,839 [trainer.py] => Average Accuracy (CNN): 94.91 

2024-08-25 10:52:21,842 [trainer.py] => All params: 172004552
2024-08-25 10:52:21,844 [trainer.py] => Trainable params: 330340
2024-08-25 10:52:21,844 [dualprompt.py] => Learning on 40-60
2024-08-25 11:29:50,667 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.231, Train_accy 90.89, Test_accy 91.27
2024-08-25 11:30:32,843 [trainer.py] => No NME accuracy.
2024-08-25 11:30:32,843 [trainer.py] => CNN: {'total': 91.27, '00-19': 90.4, '20-39': 92.6, '40-59': 90.8, 'old': 91.5, 'new': 90.8}
2024-08-25 11:30:32,843 [trainer.py] => CNN top1 curve: [96.3, 93.52, 91.27]
2024-08-25 11:30:32,844 [trainer.py] => CNN top5 curve: [99.55, 99.2, 99.03]

Average Accuracy (CNN): 93.7
2024-08-25 11:30:32,844 [trainer.py] => Average Accuracy (CNN): 93.7 

2024-08-25 11:30:32,846 [trainer.py] => All params: 172004552
2024-08-25 11:30:32,847 [trainer.py] => Trainable params: 330340
2024-08-25 11:30:32,848 [dualprompt.py] => Learning on 60-80
2024-08-25 12:08:51,661 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.214, Train_accy 91.53, Test_accy 88.44
2024-08-25 12:09:47,675 [trainer.py] => No NME accuracy.
2024-08-25 12:09:47,676 [trainer.py] => CNN: {'total': 88.44, '00-19': 88.85, '20-39': 92.15, '40-59': 86.95, '60-79': 85.8, 'old': 89.32, 'new': 85.8}
2024-08-25 12:09:47,676 [trainer.py] => CNN top1 curve: [96.3, 93.52, 91.27, 88.44]
2024-08-25 12:09:47,676 [trainer.py] => CNN top5 curve: [99.55, 99.2, 99.03, 98.7]

Average Accuracy (CNN): 92.38
2024-08-25 12:09:47,676 [trainer.py] => Average Accuracy (CNN): 92.38 

2024-08-25 12:09:47,677 [trainer.py] => All params: 172004552
2024-08-25 12:09:47,678 [trainer.py] => Trainable params: 330340
2024-08-25 12:09:47,678 [dualprompt.py] => Learning on 80-100
2024-08-25 12:48:58,790 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.212, Train_accy 91.70, Test_accy 87.46
2024-08-25 12:50:08,307 [trainer.py] => No NME accuracy.
2024-08-25 12:50:08,309 [trainer.py] => CNN: {'total': 87.46, '00-19': 87.7, '20-39': 92.0, '40-59': 85.95, '60-79': 84.1, '80-99': 87.55, 'old': 87.44, 'new': 87.55}
2024-08-25 12:50:08,309 [trainer.py] => CNN top1 curve: [96.3, 93.52, 91.27, 88.44, 87.46]
2024-08-25 12:50:08,309 [trainer.py] => CNN top5 curve: [99.55, 99.2, 99.03, 98.7, 98.34]

Average Accuracy (CNN): 91.4
2024-08-25 12:50:08,310 [trainer.py] => Average Accuracy (CNN): 91.4 

Accuracy Matrix (CNN):
[[96.3  92.55 90.4  88.85 87.7 ]
 [ 0.   94.5  92.6  92.15 92.  ]
 [ 0.    0.   90.8  86.95 85.95]
 [ 0.    0.    0.   85.8  84.1 ]
 [ 0.    0.    0.    0.   87.55]]
2024-08-25 12:50:08,311 [trainer.py] => Forgetting (CNN): 4.412499999999998
2024-08-25 12:50:11,612 [trainer.py] => config: ./exps/dualprompt_cifar_B0_Inc10.json
2024-08-25 12:50:11,612 [trainer.py] => prefix:  
2024-08-25 12:50:11,612 [trainer.py] => dataset: cifar224
2024-08-25 12:50:11,612 [trainer.py] => memory_size: 0
2024-08-25 12:50:11,612 [trainer.py] => memory_per_class: 0
2024-08-25 12:50:11,612 [trainer.py] => fixed_memory: False
2024-08-25 12:50:11,612 [trainer.py] => shuffle: True
2024-08-25 12:50:11,612 [trainer.py] => init_cls: 10
2024-08-25 12:50:11,612 [trainer.py] => increment: 10
2024-08-25 12:50:11,612 [trainer.py] => model_name: dualprompt
2024-08-25 12:50:11,612 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-08-25 12:50:11,612 [trainer.py] => get_original_backbone: True
2024-08-25 12:50:11,612 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-25 12:50:11,612 [trainer.py] => seed: 1993
2024-08-25 12:50:11,612 [trainer.py] => tuned_epoch: 20
2024-08-25 12:50:11,613 [trainer.py] => init_lr: 0.001
2024-08-25 12:50:11,613 [trainer.py] => batch_size: 48
2024-08-25 12:50:11,613 [trainer.py] => weight_decay: 0
2024-08-25 12:50:11,613 [trainer.py] => min_lr: 1e-05
2024-08-25 12:50:11,613 [trainer.py] => optimizer: adam
2024-08-25 12:50:11,613 [trainer.py] => scheduler: constant
2024-08-25 12:50:11,613 [trainer.py] => reinit_optimizer: True
2024-08-25 12:50:11,613 [trainer.py] => global_pool: token
2024-08-25 12:50:11,613 [trainer.py] => head_type: token
2024-08-25 12:50:11,613 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-25 12:50:11,613 [trainer.py] => pretrained: True
2024-08-25 12:50:11,613 [trainer.py] => drop: 0.0
2024-08-25 12:50:11,613 [trainer.py] => drop_path: 0.0
2024-08-25 12:50:11,613 [trainer.py] => use_g_prompt: True
2024-08-25 12:50:11,613 [trainer.py] => g_prompt_length: 5
2024-08-25 12:50:11,613 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-08-25 12:50:11,613 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-08-25 12:50:11,613 [trainer.py] => use_e_prompt: True
2024-08-25 12:50:11,613 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-08-25 12:50:11,613 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-08-25 12:50:11,613 [trainer.py] => prompt_pool: True
2024-08-25 12:50:11,613 [trainer.py] => size: 10
2024-08-25 12:50:11,613 [trainer.py] => length: 5
2024-08-25 12:50:11,613 [trainer.py] => top_k: 1
2024-08-25 12:50:11,613 [trainer.py] => initializer: uniform
2024-08-25 12:50:11,613 [trainer.py] => prompt_key: True
2024-08-25 12:50:11,613 [trainer.py] => prompt_key_init: uniform
2024-08-25 12:50:11,613 [trainer.py] => use_prompt_mask: True
2024-08-25 12:50:11,614 [trainer.py] => shared_prompt_pool: True
2024-08-25 12:50:11,614 [trainer.py] => shared_prompt_key: False
2024-08-25 12:50:11,614 [trainer.py] => batchwise_prompt: True
2024-08-25 12:50:11,614 [trainer.py] => embedding_key: cls
2024-08-25 12:50:11,614 [trainer.py] => predefined_key: 
2024-08-25 12:50:11,614 [trainer.py] => pull_constraint: True
2024-08-25 12:50:11,614 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-25 12:50:11,614 [trainer.py] => same_key_value: False
2024-08-25 12:50:13,287 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-25 12:50:20,796 [dualprompt.py] => 86,128,996 model total parameters.
2024-08-25 12:50:20,797 [dualprompt.py] => 330,340 model training parameters.
2024-08-25 12:50:20,797 [dualprompt.py] => g_prompt: 15360
2024-08-25 12:50:20,797 [dualprompt.py] => e_prompt.prompt: 230400
2024-08-25 12:50:20,797 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-08-25 12:50:20,797 [dualprompt.py] => head.weight: 76800
2024-08-25 12:50:20,802 [dualprompt.py] => head.bias: 100
2024-08-25 12:50:20,803 [trainer.py] => All params: 172004552
2024-08-25 12:50:20,804 [trainer.py] => Trainable params: 330340
2024-08-25 12:50:20,804 [dualprompt.py] => Learning on 0-10
2024-08-25 13:08:23,523 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.182, Train_accy 92.56, Test_accy 97.50
2024-08-25 13:08:31,250 [trainer.py] => No NME accuracy.
2024-08-25 13:08:31,251 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2024-08-25 13:08:31,251 [trainer.py] => CNN top1 curve: [97.5]
2024-08-25 13:08:31,251 [trainer.py] => CNN top5 curve: [99.9]

Average Accuracy (CNN): 97.5
2024-08-25 13:08:31,251 [trainer.py] => Average Accuracy (CNN): 97.5 

2024-08-25 13:08:31,254 [trainer.py] => All params: 172004552
2024-08-25 13:08:31,256 [trainer.py] => Trainable params: 330340
2024-08-25 13:08:31,256 [dualprompt.py] => Learning on 10-20
2024-08-25 13:26:55,393 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.218, Train_accy 91.38, Test_accy 94.95
2024-08-25 13:27:10,056 [trainer.py] => No NME accuracy.
2024-08-25 13:27:10,056 [trainer.py] => CNN: {'total': 94.95, '00-09': 97.0, '10-19': 92.9, 'old': 97.0, 'new': 92.9}
2024-08-25 13:27:10,056 [trainer.py] => CNN top1 curve: [97.5, 94.95]
2024-08-25 13:27:10,056 [trainer.py] => CNN top5 curve: [99.9, 99.45]

Average Accuracy (CNN): 96.22
2024-08-25 13:27:10,057 [trainer.py] => Average Accuracy (CNN): 96.22 

2024-08-25 13:27:10,059 [trainer.py] => All params: 172004552
2024-08-25 13:27:10,061 [trainer.py] => Trainable params: 330340
2024-08-25 13:27:10,062 [dualprompt.py] => Learning on 20-30
2024-08-25 13:46:03,319 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.084, Train_accy 95.40, Test_accy 93.67
2024-08-25 13:46:24,699 [trainer.py] => No NME accuracy.
2024-08-25 13:46:24,700 [trainer.py] => CNN: {'total': 93.67, '00-09': 94.5, '10-19': 90.5, '20-29': 96.0, 'old': 92.5, 'new': 96.0}
2024-08-25 13:46:24,700 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67]
2024-08-25 13:46:24,700 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17]

Average Accuracy (CNN): 95.37
2024-08-25 13:46:24,700 [trainer.py] => Average Accuracy (CNN): 95.37 

2024-08-25 13:46:24,703 [trainer.py] => All params: 172004552
2024-08-25 13:46:24,704 [trainer.py] => Trainable params: 330340
2024-08-25 13:46:24,705 [dualprompt.py] => Learning on 30-40
2024-08-25 14:05:47,547 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.141, Train_accy 93.14, Test_accy 91.90
2024-08-25 14:06:15,826 [trainer.py] => No NME accuracy.
2024-08-25 14:06:15,826 [trainer.py] => CNN: {'total': 91.9, '00-09': 93.6, '10-19': 88.8, '20-29': 94.5, '30-39': 90.7, 'old': 92.3, 'new': 90.7}
2024-08-25 14:06:15,826 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67, 91.9]
2024-08-25 14:06:15,826 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17, 99.08]

Average Accuracy (CNN): 94.5
2024-08-25 14:06:15,827 [trainer.py] => Average Accuracy (CNN): 94.5 

2024-08-25 14:06:15,829 [trainer.py] => All params: 172004552
2024-08-25 14:06:15,831 [trainer.py] => Trainable params: 330340
2024-08-25 14:06:15,831 [dualprompt.py] => Learning on 40-50
2024-08-25 14:26:04,089 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.083, Train_accy 95.52, Test_accy 89.94
2024-08-25 14:26:39,175 [trainer.py] => No NME accuracy.
2024-08-25 14:26:39,175 [trainer.py] => CNN: {'total': 89.94, '00-09': 91.3, '10-19': 84.1, '20-29': 93.3, '30-39': 89.6, '40-49': 91.4, 'old': 89.58, 'new': 91.4}
2024-08-25 14:26:39,175 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67, 91.9, 89.94]
2024-08-25 14:26:39,175 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17, 99.08, 98.78]

Average Accuracy (CNN): 93.59
2024-08-25 14:26:39,176 [trainer.py] => Average Accuracy (CNN): 93.59 

2024-08-25 14:26:39,178 [trainer.py] => All params: 172004552
2024-08-25 14:26:39,180 [trainer.py] => Trainable params: 330340
2024-08-25 14:26:39,180 [dualprompt.py] => Learning on 50-60
2024-08-25 14:46:54,374 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.107, Train_accy 94.38, Test_accy 89.17
2024-08-25 14:47:36,166 [trainer.py] => No NME accuracy.
2024-08-25 14:47:36,167 [trainer.py] => CNN: {'total': 89.17, '00-09': 90.3, '10-19': 83.8, '20-29': 92.9, '30-39': 89.2, '40-49': 90.4, '50-59': 88.4, 'old': 89.32, 'new': 88.4}
2024-08-25 14:47:36,167 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67, 91.9, 89.94, 89.17]
2024-08-25 14:47:36,167 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17, 99.08, 98.78, 98.55]

Average Accuracy (CNN): 92.86
2024-08-25 14:47:36,167 [trainer.py] => Average Accuracy (CNN): 92.86 

2024-08-25 14:47:36,169 [trainer.py] => All params: 172004552
2024-08-25 14:47:36,170 [trainer.py] => Trainable params: 330340
2024-08-25 14:47:36,170 [dualprompt.py] => Learning on 60-70
2024-08-25 15:08:19,158 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.089, Train_accy 95.56, Test_accy 88.80
2024-08-25 15:09:07,718 [trainer.py] => No NME accuracy.
2024-08-25 15:09:07,719 [trainer.py] => CNN: {'total': 88.8, '00-09': 89.4, '10-19': 83.3, '20-29': 92.4, '30-39': 89.0, '40-49': 90.4, '50-59': 85.4, '60-69': 91.7, 'old': 88.32, 'new': 91.7}
2024-08-25 15:09:07,719 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67, 91.9, 89.94, 89.17, 88.8]
2024-08-25 15:09:07,719 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17, 99.08, 98.78, 98.55, 98.54]

Average Accuracy (CNN): 92.28
2024-08-25 15:09:07,720 [trainer.py] => Average Accuracy (CNN): 92.28 

2024-08-25 15:09:07,722 [trainer.py] => All params: 172004552
2024-08-25 15:09:07,724 [trainer.py] => Trainable params: 330340
2024-08-25 15:09:07,724 [dualprompt.py] => Learning on 70-80
2024-08-25 15:30:23,333 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.134, Train_accy 93.84, Test_accy 86.56
2024-08-25 15:31:18,873 [trainer.py] => No NME accuracy.
2024-08-25 15:31:18,874 [trainer.py] => CNN: {'total': 86.56, '00-09': 89.4, '10-19': 83.0, '20-29': 93.1, '30-39': 88.2, '40-49': 88.3, '50-59': 82.9, '60-69': 90.0, '70-79': 77.6, 'old': 87.84, 'new': 77.6}
2024-08-25 15:31:18,874 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67, 91.9, 89.94, 89.17, 88.8, 86.56]
2024-08-25 15:31:18,874 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17, 99.08, 98.78, 98.55, 98.54, 98.3]

Average Accuracy (CNN): 91.56
2024-08-25 15:31:18,874 [trainer.py] => Average Accuracy (CNN): 91.56 

2024-08-25 15:31:18,877 [trainer.py] => All params: 172004552
2024-08-25 15:31:18,879 [trainer.py] => Trainable params: 330340
2024-08-25 15:31:18,879 [dualprompt.py] => Learning on 80-90
2024-08-25 15:52:57,495 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.121, Train_accy 94.30, Test_accy 85.51
2024-08-25 15:54:00,131 [trainer.py] => No NME accuracy.
2024-08-25 15:54:00,131 [trainer.py] => CNN: {'total': 85.51, '00-09': 88.6, '10-19': 82.1, '20-29': 92.5, '30-39': 88.1, '40-49': 87.4, '50-59': 81.9, '60-69': 89.1, '70-79': 75.7, '80-89': 84.2, 'old': 85.68, 'new': 84.2}
2024-08-25 15:54:00,131 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67, 91.9, 89.94, 89.17, 88.8, 86.56, 85.51]
2024-08-25 15:54:00,132 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17, 99.08, 98.78, 98.55, 98.54, 98.3, 98.03]

Average Accuracy (CNN): 90.89
2024-08-25 15:54:00,132 [trainer.py] => Average Accuracy (CNN): 90.89 

2024-08-25 15:54:00,134 [trainer.py] => All params: 172004552
2024-08-25 15:54:00,136 [trainer.py] => Trainable params: 330340
2024-08-25 15:54:00,136 [dualprompt.py] => Learning on 90-100
2024-08-25 16:16:05,120 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.131, Train_accy 93.78, Test_accy 85.36
2024-08-25 16:17:14,213 [trainer.py] => No NME accuracy.
2024-08-25 16:17:14,214 [trainer.py] => CNN: {'total': 85.36, '00-09': 88.3, '10-19': 82.5, '20-29': 92.7, '30-39': 87.9, '40-49': 87.1, '50-59': 82.3, '60-69': 88.0, '70-79': 75.7, '80-89': 84.5, '90-99': 84.6, 'old': 85.44, 'new': 84.6}
2024-08-25 16:17:14,214 [trainer.py] => CNN top1 curve: [97.5, 94.95, 93.67, 91.9, 89.94, 89.17, 88.8, 86.56, 85.51, 85.36]
2024-08-25 16:17:14,214 [trainer.py] => CNN top5 curve: [99.9, 99.45, 99.17, 99.08, 98.78, 98.55, 98.54, 98.3, 98.03, 97.86]

Average Accuracy (CNN): 90.34
2024-08-25 16:17:14,214 [trainer.py] => Average Accuracy (CNN): 90.34 

Accuracy Matrix (CNN):
[[97.5 97.  94.5 93.6 91.3 90.3 89.4 89.4 88.6 88.3]
 [ 0.  92.9 90.5 88.8 84.1 83.8 83.3 83.  82.1 82.5]
 [ 0.   0.  96.  94.5 93.3 92.9 92.4 93.1 92.5 92.7]
 [ 0.   0.   0.  90.7 89.6 89.2 89.  88.2 88.1 87.9]
 [ 0.   0.   0.   0.  91.4 90.4 90.4 88.3 87.4 87.1]
 [ 0.   0.   0.   0.   0.  88.4 85.4 82.9 81.9 82.3]
 [ 0.   0.   0.   0.   0.   0.  91.7 90.  89.1 88. ]
 [ 0.   0.   0.   0.   0.   0.   0.  77.6 75.7 75.7]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  84.2 84.5]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  84.6]]
2024-08-25 16:17:14,216 [trainer.py] => Forgetting (CNN): 4.6333333333333355
2024-08-25 16:17:17,841 [trainer.py] => config: ./exps/dualprompt_cifar_B0_Inc20.json
2024-08-25 16:17:17,841 [trainer.py] => prefix:  
2024-08-25 16:17:17,842 [trainer.py] => dataset: cifar224
2024-08-25 16:17:17,842 [trainer.py] => memory_size: 0
2024-08-25 16:17:17,842 [trainer.py] => memory_per_class: 0
2024-08-25 16:17:17,842 [trainer.py] => fixed_memory: False
2024-08-25 16:17:17,842 [trainer.py] => shuffle: True
2024-08-25 16:17:17,842 [trainer.py] => init_cls: 5
2024-08-25 16:17:17,842 [trainer.py] => increment: 5
2024-08-25 16:17:17,842 [trainer.py] => model_name: dualprompt
2024-08-25 16:17:17,842 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-08-25 16:17:17,842 [trainer.py] => get_original_backbone: True
2024-08-25 16:17:17,842 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-25 16:17:17,842 [trainer.py] => seed: 1993
2024-08-25 16:17:17,842 [trainer.py] => tuned_epoch: 20
2024-08-25 16:17:17,842 [trainer.py] => init_lr: 0.001
2024-08-25 16:17:17,842 [trainer.py] => batch_size: 48
2024-08-25 16:17:17,842 [trainer.py] => weight_decay: 0
2024-08-25 16:17:17,842 [trainer.py] => min_lr: 1e-05
2024-08-25 16:17:17,842 [trainer.py] => optimizer: adam
2024-08-25 16:17:17,842 [trainer.py] => scheduler: constant
2024-08-25 16:17:17,842 [trainer.py] => reinit_optimizer: True
2024-08-25 16:17:17,842 [trainer.py] => global_pool: token
2024-08-25 16:17:17,842 [trainer.py] => head_type: token
2024-08-25 16:17:17,842 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-25 16:17:17,842 [trainer.py] => pretrained: True
2024-08-25 16:17:17,842 [trainer.py] => drop: 0.0
2024-08-25 16:17:17,842 [trainer.py] => drop_path: 0.0
2024-08-25 16:17:17,842 [trainer.py] => use_g_prompt: True
2024-08-25 16:17:17,843 [trainer.py] => g_prompt_length: 5
2024-08-25 16:17:17,843 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-08-25 16:17:17,843 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-08-25 16:17:17,843 [trainer.py] => use_e_prompt: True
2024-08-25 16:17:17,843 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-08-25 16:17:17,843 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-08-25 16:17:17,843 [trainer.py] => prompt_pool: True
2024-08-25 16:17:17,843 [trainer.py] => size: 10
2024-08-25 16:17:17,843 [trainer.py] => length: 5
2024-08-25 16:17:17,843 [trainer.py] => top_k: 1
2024-08-25 16:17:17,843 [trainer.py] => initializer: uniform
2024-08-25 16:17:17,843 [trainer.py] => prompt_key: True
2024-08-25 16:17:17,843 [trainer.py] => prompt_key_init: uniform
2024-08-25 16:17:17,843 [trainer.py] => use_prompt_mask: True
2024-08-25 16:17:17,843 [trainer.py] => shared_prompt_pool: True
2024-08-25 16:17:17,843 [trainer.py] => shared_prompt_key: False
2024-08-25 16:17:17,843 [trainer.py] => batchwise_prompt: True
2024-08-25 16:17:17,843 [trainer.py] => embedding_key: cls
2024-08-25 16:17:17,843 [trainer.py] => predefined_key: 
2024-08-25 16:17:17,843 [trainer.py] => pull_constraint: True
2024-08-25 16:17:17,843 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-25 16:17:17,843 [trainer.py] => same_key_value: False
2024-08-25 16:17:19,530 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-25 16:17:27,118 [dualprompt.py] => 86,128,996 model total parameters.
2024-08-25 16:17:27,119 [dualprompt.py] => 330,340 model training parameters.
2024-08-25 16:17:27,119 [dualprompt.py] => g_prompt: 15360
2024-08-25 16:17:27,119 [dualprompt.py] => e_prompt.prompt: 230400
2024-08-25 16:17:27,119 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-08-25 16:17:27,119 [dualprompt.py] => head.weight: 76800
2024-08-25 16:17:27,124 [dualprompt.py] => head.bias: 100
2024-08-25 16:17:27,125 [trainer.py] => All params: 172004552
2024-08-25 16:17:27,126 [trainer.py] => Trainable params: 330340
2024-08-25 16:17:27,126 [dualprompt.py] => Learning on 0-5
2024-08-25 16:26:42,400 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.059, Train_accy 95.96, Test_accy 99.80
2024-08-25 16:26:46,689 [trainer.py] => No NME accuracy.
2024-08-25 16:26:46,689 [trainer.py] => CNN: {'total': 99.8, '00-04': 99.8, 'old': 0, 'new': 99.8}
2024-08-25 16:26:46,689 [trainer.py] => CNN top1 curve: [99.8]
2024-08-25 16:26:46,689 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.8
2024-08-25 16:26:46,690 [trainer.py] => Average Accuracy (CNN): 99.8 

2024-08-25 16:26:46,692 [trainer.py] => All params: 172004552
2024-08-25 16:26:46,694 [trainer.py] => Trainable params: 330340
2024-08-25 16:26:46,694 [dualprompt.py] => Learning on 5-10
2024-08-25 16:36:09,440 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.092, Train_accy 94.76, Test_accy 95.70
2024-08-25 16:36:17,120 [trainer.py] => No NME accuracy.
2024-08-25 16:36:17,120 [trainer.py] => CNN: {'total': 95.7, '00-04': 99.2, '05-09': 92.2, 'old': 99.2, 'new': 92.2}
2024-08-25 16:36:17,120 [trainer.py] => CNN top1 curve: [99.8, 95.7]
2024-08-25 16:36:17,120 [trainer.py] => CNN top5 curve: [100.0, 99.9]

Average Accuracy (CNN): 97.75
2024-08-25 16:36:17,121 [trainer.py] => Average Accuracy (CNN): 97.75 

2024-08-25 16:36:17,123 [trainer.py] => All params: 172004552
2024-08-25 16:36:17,124 [trainer.py] => Trainable params: 330340
2024-08-25 16:36:17,124 [dualprompt.py] => Learning on 10-15
2024-08-25 16:45:55,292 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.092, Train_accy 94.44, Test_accy 94.73
2024-08-25 16:46:06,449 [trainer.py] => No NME accuracy.
2024-08-25 16:46:06,450 [trainer.py] => CNN: {'total': 94.73, '00-04': 98.6, '05-09': 92.0, '10-14': 93.6, 'old': 95.3, 'new': 93.6}
2024-08-25 16:46:06,450 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73]
2024-08-25 16:46:06,450 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47]

Average Accuracy (CNN): 96.74
2024-08-25 16:46:06,450 [trainer.py] => Average Accuracy (CNN): 96.74 

2024-08-25 16:46:06,452 [trainer.py] => All params: 172004552
2024-08-25 16:46:06,453 [trainer.py] => Trainable params: 330340
2024-08-25 16:46:06,453 [dualprompt.py] => Learning on 15-20
2024-08-25 16:55:58,035 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.119, Train_accy 94.36, Test_accy 93.60
2024-08-25 16:56:12,506 [trainer.py] => No NME accuracy.
2024-08-25 16:56:12,507 [trainer.py] => CNN: {'total': 93.6, '00-04': 98.4, '05-09': 92.0, '10-14': 93.4, '15-19': 90.6, 'old': 94.6, 'new': 90.6}
2024-08-25 16:56:12,507 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6]
2024-08-25 16:56:12,507 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15]

Average Accuracy (CNN): 95.96
2024-08-25 16:56:12,507 [trainer.py] => Average Accuracy (CNN): 95.96 

2024-08-25 16:56:12,509 [trainer.py] => All params: 172004552
2024-08-25 16:56:12,511 [trainer.py] => Trainable params: 330340
2024-08-25 16:56:12,511 [dualprompt.py] => Learning on 20-25
2024-08-25 17:06:16,818 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.033, Train_accy 96.88, Test_accy 93.32
2024-08-25 17:06:34,913 [trainer.py] => No NME accuracy.
2024-08-25 17:06:34,913 [trainer.py] => CNN: {'total': 93.32, '00-04': 98.4, '05-09': 91.4, '10-14': 92.4, '15-19': 90.2, '20-24': 94.2, 'old': 93.1, 'new': 94.2}
2024-08-25 17:06:34,914 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32]
2024-08-25 17:06:34,914 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08]

Average Accuracy (CNN): 95.43
2024-08-25 17:06:34,914 [trainer.py] => Average Accuracy (CNN): 95.43 

2024-08-25 17:06:34,915 [trainer.py] => All params: 172004552
2024-08-25 17:06:34,916 [trainer.py] => Trainable params: 330340
2024-08-25 17:06:34,916 [dualprompt.py] => Learning on 25-30
2024-08-25 17:16:51,977 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.031, Train_accy 97.24, Test_accy 92.57
2024-08-25 17:17:13,448 [trainer.py] => No NME accuracy.
2024-08-25 17:17:13,449 [trainer.py] => CNN: {'total': 92.57, '00-04': 97.6, '05-09': 89.0, '10-14': 92.0, '15-19': 89.4, '20-24': 93.6, '25-29': 93.8, 'old': 92.32, 'new': 93.8}
2024-08-25 17:17:13,449 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57]
2024-08-25 17:17:13,449 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73]

Average Accuracy (CNN): 94.95
2024-08-25 17:17:13,449 [trainer.py] => Average Accuracy (CNN): 94.95 

2024-08-25 17:17:13,452 [trainer.py] => All params: 172004552
2024-08-25 17:17:13,454 [trainer.py] => Trainable params: 330340
2024-08-25 17:17:13,455 [dualprompt.py] => Learning on 30-35
2024-08-25 17:27:43,702 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.119, Train_accy 93.64, Test_accy 90.09
2024-08-25 17:28:08,609 [trainer.py] => No NME accuracy.
2024-08-25 17:28:08,609 [trainer.py] => CNN: {'total': 90.09, '00-04': 97.8, '05-09': 89.2, '10-14': 93.0, '15-19': 88.6, '20-24': 90.8, '25-29': 93.8, '30-34': 77.4, 'old': 92.2, 'new': 77.4}
2024-08-25 17:28:08,609 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09]
2024-08-25 17:28:08,609 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83]

Average Accuracy (CNN): 94.26
2024-08-25 17:28:08,609 [trainer.py] => Average Accuracy (CNN): 94.26 

2024-08-25 17:28:08,611 [trainer.py] => All params: 172004552
2024-08-25 17:28:08,611 [trainer.py] => Trainable params: 330340
2024-08-25 17:28:08,612 [dualprompt.py] => Learning on 35-40
2024-08-25 17:38:55,401 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.034, Train_accy 97.20, Test_accy 89.90
2024-08-25 17:39:23,594 [trainer.py] => No NME accuracy.
2024-08-25 17:39:23,595 [trainer.py] => CNN: {'total': 89.9, '00-04': 97.4, '05-09': 89.4, '10-14': 92.6, '15-19': 88.4, '20-24': 90.0, '25-29': 94.2, '30-34': 77.0, '35-39': 90.2, 'old': 89.86, 'new': 90.2}
2024-08-25 17:39:23,595 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9]
2024-08-25 17:39:23,595 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75]

Average Accuracy (CNN): 93.71
2024-08-25 17:39:23,595 [trainer.py] => Average Accuracy (CNN): 93.71 

2024-08-25 17:39:23,598 [trainer.py] => All params: 172004552
2024-08-25 17:39:23,600 [trainer.py] => Trainable params: 330340
2024-08-25 17:39:23,600 [dualprompt.py] => Learning on 40-45
2024-08-25 17:50:21,658 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.043, Train_accy 96.72, Test_accy 88.91
2024-08-25 17:50:52,826 [trainer.py] => No NME accuracy.
2024-08-25 17:50:52,827 [trainer.py] => CNN: {'total': 88.91, '00-04': 94.4, '05-09': 89.6, '10-14': 88.8, '15-19': 87.6, '20-24': 90.2, '25-29': 93.8, '30-34': 76.8, '35-39': 89.2, '40-44': 89.8, 'old': 88.8, 'new': 89.8}
2024-08-25 17:50:52,827 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91]
2024-08-25 17:50:52,827 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67]

Average Accuracy (CNN): 93.18
2024-08-25 17:50:52,827 [trainer.py] => Average Accuracy (CNN): 93.18 

2024-08-25 17:50:52,829 [trainer.py] => All params: 172004552
2024-08-25 17:50:52,830 [trainer.py] => Trainable params: 330340
2024-08-25 17:50:52,830 [dualprompt.py] => Learning on 45-50
2024-08-25 18:02:07,322 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.003, Train_accy 97.96, Test_accy 87.64
2024-08-25 18:02:42,651 [trainer.py] => No NME accuracy.
2024-08-25 18:02:42,651 [trainer.py] => CNN: {'total': 87.64, '00-04': 95.6, '05-09': 88.8, '10-14': 86.2, '15-19': 87.6, '20-24': 89.8, '25-29': 92.2, '30-34': 75.8, '35-39': 87.4, '40-44': 90.0, '45-49': 83.0, 'old': 88.16, 'new': 83.0}
2024-08-25 18:02:42,652 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64]
2024-08-25 18:02:42,652 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48]

Average Accuracy (CNN): 92.63
2024-08-25 18:02:42,652 [trainer.py] => Average Accuracy (CNN): 92.63 

2024-08-25 18:02:42,653 [trainer.py] => All params: 172004552
2024-08-25 18:02:42,654 [trainer.py] => Trainable params: 330340
2024-08-25 18:02:42,655 [dualprompt.py] => Learning on 50-55
2024-08-25 18:14:13,328 [dualprompt.py] => Task 10, Epoch 20/20 => Loss 0.017, Train_accy 97.32, Test_accy 86.82
2024-08-25 18:14:51,838 [trainer.py] => No NME accuracy.
2024-08-25 18:14:51,838 [trainer.py] => CNN: {'total': 86.82, '00-04': 91.2, '05-09': 89.8, '10-14': 86.0, '15-19': 87.2, '20-24': 91.2, '25-29': 92.2, '30-34': 75.6, '35-39': 89.6, '40-44': 90.4, '45-49': 80.2, '50-54': 81.6, 'old': 87.34, 'new': 81.6}
2024-08-25 18:14:51,839 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82]
2024-08-25 18:14:51,839 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4]

Average Accuracy (CNN): 92.1
2024-08-25 18:14:51,839 [trainer.py] => Average Accuracy (CNN): 92.1 

2024-08-25 18:14:51,841 [trainer.py] => All params: 172004552
2024-08-25 18:14:51,843 [trainer.py] => Trainable params: 330340
2024-08-25 18:14:51,843 [dualprompt.py] => Learning on 55-60
2024-08-25 18:26:32,153 [dualprompt.py] => Task 11, Epoch 20/20 => Loss 0.130, Train_accy 92.72, Test_accy 86.63
2024-08-25 18:27:14,103 [trainer.py] => No NME accuracy.
2024-08-25 18:27:14,104 [trainer.py] => CNN: {'total': 86.63, '00-04': 93.6, '05-09': 89.2, '10-14': 86.2, '15-19': 87.0, '20-24': 90.0, '25-29': 92.6, '30-34': 76.2, '35-39': 89.2, '40-44': 89.0, '45-49': 79.6, '50-54': 80.4, '55-59': 86.6, 'old': 86.64, 'new': 86.6}
2024-08-25 18:27:14,104 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63]
2024-08-25 18:27:14,104 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2]

Average Accuracy (CNN): 91.64
2024-08-25 18:27:14,104 [trainer.py] => Average Accuracy (CNN): 91.64 

2024-08-25 18:27:14,108 [trainer.py] => All params: 172004552
2024-08-25 18:27:14,110 [trainer.py] => Trainable params: 330340
2024-08-25 18:27:14,111 [dualprompt.py] => Learning on 60-65
2024-08-25 18:39:07,397 [dualprompt.py] => Task 12, Epoch 20/20 => Loss 0.014, Train_accy 97.68, Test_accy 85.62
2024-08-25 18:39:52,363 [trainer.py] => No NME accuracy.
2024-08-25 18:39:52,365 [trainer.py] => CNN: {'total': 85.62, '00-04': 92.4, '05-09': 89.8, '10-14': 84.2, '15-19': 85.4, '20-24': 89.8, '25-29': 92.0, '30-34': 75.4, '35-39': 89.0, '40-44': 89.0, '45-49': 81.6, '50-54': 80.2, '55-59': 71.4, '60-64': 92.8, 'old': 85.02, 'new': 92.8}
2024-08-25 18:39:52,365 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62]
2024-08-25 18:39:52,365 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03]

Average Accuracy (CNN): 91.18
2024-08-25 18:39:52,365 [trainer.py] => Average Accuracy (CNN): 91.18 

2024-08-25 18:39:52,367 [trainer.py] => All params: 172004552
2024-08-25 18:39:52,368 [trainer.py] => Trainable params: 330340
2024-08-25 18:39:52,368 [dualprompt.py] => Learning on 65-70
2024-08-25 18:51:59,879 [dualprompt.py] => Task 13, Epoch 20/20 => Loss 0.009, Train_accy 97.84, Test_accy 85.93
2024-08-25 18:52:48,705 [trainer.py] => No NME accuracy.
2024-08-25 18:52:48,706 [trainer.py] => CNN: {'total': 85.93, '00-04': 92.0, '05-09': 90.0, '10-14': 84.2, '15-19': 84.8, '20-24': 90.4, '25-29': 92.0, '30-34': 75.6, '35-39': 89.2, '40-44': 88.8, '45-49': 81.4, '50-54': 80.6, '55-59': 70.0, '60-64': 91.8, '65-69': 92.2, 'old': 85.45, 'new': 92.2}
2024-08-25 18:52:48,706 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62, 85.93]
2024-08-25 18:52:48,706 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03, 97.97]

Average Accuracy (CNN): 90.8
2024-08-25 18:52:48,706 [trainer.py] => Average Accuracy (CNN): 90.8 

2024-08-25 18:52:48,708 [trainer.py] => All params: 172004552
2024-08-25 18:52:48,710 [trainer.py] => Trainable params: 330340
2024-08-25 18:52:48,710 [dualprompt.py] => Learning on 70-75
2024-08-25 19:05:09,882 [dualprompt.py] => Task 14, Epoch 20/20 => Loss 0.034, Train_accy 96.72, Test_accy 84.97
2024-08-25 19:06:01,474 [trainer.py] => No NME accuracy.
2024-08-25 19:06:01,474 [trainer.py] => CNN: {'total': 84.97, '00-04': 93.0, '05-09': 89.2, '10-14': 84.6, '15-19': 84.0, '20-24': 90.2, '25-29': 92.0, '30-34': 75.4, '35-39': 89.2, '40-44': 88.6, '45-49': 81.0, '50-54': 80.8, '55-59': 65.0, '60-64': 88.0, '65-69': 91.4, '70-74': 82.2, 'old': 85.17, 'new': 82.2}
2024-08-25 19:06:01,474 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62, 85.93, 84.97]
2024-08-25 19:06:01,474 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03, 97.97, 97.88]

Average Accuracy (CNN): 90.42
2024-08-25 19:06:01,474 [trainer.py] => Average Accuracy (CNN): 90.42 

2024-08-25 19:06:01,476 [trainer.py] => All params: 172004552
2024-08-25 19:06:01,477 [trainer.py] => Trainable params: 330340
2024-08-25 19:06:01,477 [dualprompt.py] => Learning on 75-80
2024-08-25 19:18:35,540 [dualprompt.py] => Task 15, Epoch 20/20 => Loss 0.026, Train_accy 97.44, Test_accy 83.70
2024-08-25 19:19:31,028 [trainer.py] => No NME accuracy.
2024-08-25 19:19:31,029 [trainer.py] => CNN: {'total': 83.7, '00-04': 90.0, '05-09': 89.4, '10-14': 85.2, '15-19': 85.8, '20-24': 90.2, '25-29': 92.2, '30-34': 75.0, '35-39': 88.8, '40-44': 87.6, '45-49': 77.2, '50-54': 77.0, '55-59': 65.2, '60-64': 86.0, '65-69': 91.2, '70-74': 81.4, '75-79': 77.0, 'old': 84.15, 'new': 77.0}
2024-08-25 19:19:31,029 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62, 85.93, 84.97, 83.7]
2024-08-25 19:19:31,029 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03, 97.97, 97.88, 97.72]

Average Accuracy (CNN): 90.0
2024-08-25 19:19:31,029 [trainer.py] => Average Accuracy (CNN): 90.0 

2024-08-25 19:19:31,031 [trainer.py] => All params: 172004552
2024-08-25 19:19:31,032 [trainer.py] => Trainable params: 330340
2024-08-25 19:19:31,032 [dualprompt.py] => Learning on 80-85
2024-08-25 19:32:21,394 [dualprompt.py] => Task 16, Epoch 20/20 => Loss 0.003, Train_accy 98.08, Test_accy 83.31
2024-08-25 19:33:20,334 [trainer.py] => No NME accuracy.
2024-08-25 19:33:20,335 [trainer.py] => CNN: {'total': 83.31, '00-04': 91.6, '05-09': 90.0, '10-14': 84.6, '15-19': 84.8, '20-24': 90.0, '25-29': 91.4, '30-34': 75.8, '35-39': 89.2, '40-44': 87.6, '45-49': 75.6, '50-54': 76.0, '55-59': 64.8, '60-64': 87.6, '65-69': 91.6, '70-74': 80.6, '75-79': 76.6, '80-84': 78.4, 'old': 83.61, 'new': 78.4}
2024-08-25 19:33:20,335 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62, 85.93, 84.97, 83.7, 83.31]
2024-08-25 19:33:20,335 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03, 97.97, 97.88, 97.72, 97.65]

Average Accuracy (CNN): 89.6
2024-08-25 19:33:20,335 [trainer.py] => Average Accuracy (CNN): 89.6 

2024-08-25 19:33:20,338 [trainer.py] => All params: 172004552
2024-08-25 19:33:20,341 [trainer.py] => Trainable params: 330340
2024-08-25 19:33:20,342 [dualprompt.py] => Learning on 85-90
2024-08-25 19:46:20,671 [dualprompt.py] => Task 17, Epoch 20/20 => Loss 0.105, Train_accy 93.60, Test_accy 82.58
2024-08-25 19:47:22,164 [trainer.py] => No NME accuracy.
2024-08-25 19:47:22,166 [trainer.py] => CNN: {'total': 82.58, '00-04': 91.4, '05-09': 88.4, '10-14': 83.8, '15-19': 85.0, '20-24': 89.4, '25-29': 91.4, '30-34': 75.8, '35-39': 88.6, '40-44': 87.4, '45-49': 75.0, '50-54': 77.2, '55-59': 64.8, '60-64': 86.8, '65-69': 90.8, '70-74': 81.6, '75-79': 74.8, '80-84': 78.2, '85-89': 76.0, 'old': 82.96, 'new': 76.0}
2024-08-25 19:47:22,166 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62, 85.93, 84.97, 83.7, 83.31, 82.58]
2024-08-25 19:47:22,166 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03, 97.97, 97.88, 97.72, 97.65, 97.32]

Average Accuracy (CNN): 89.21
2024-08-25 19:47:22,166 [trainer.py] => Average Accuracy (CNN): 89.21 

2024-08-25 19:47:22,169 [trainer.py] => All params: 172004552
2024-08-25 19:47:22,170 [trainer.py] => Trainable params: 330340
2024-08-25 19:47:22,171 [dualprompt.py] => Learning on 90-95
2024-08-25 20:00:36,723 [dualprompt.py] => Task 18, Epoch 20/20 => Loss 0.026, Train_accy 96.72, Test_accy 82.54
2024-08-25 20:01:42,976 [trainer.py] => No NME accuracy.
2024-08-25 20:01:42,977 [trainer.py] => CNN: {'total': 82.54, '00-04': 91.4, '05-09': 87.6, '10-14': 83.0, '15-19': 85.6, '20-24': 89.2, '25-29': 91.0, '30-34': 76.0, '35-39': 88.2, '40-44': 87.6, '45-49': 75.6, '50-54': 76.0, '55-59': 64.8, '60-64': 86.0, '65-69': 91.0, '70-74': 80.6, '75-79': 74.2, '80-84': 77.4, '85-89': 75.6, '90-94': 87.4, 'old': 82.27, 'new': 87.4}
2024-08-25 20:01:42,977 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62, 85.93, 84.97, 83.7, 83.31, 82.58, 82.54]
2024-08-25 20:01:42,977 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03, 97.97, 97.88, 97.72, 97.65, 97.32, 97.16]

Average Accuracy (CNN): 88.86
2024-08-25 20:01:42,977 [trainer.py] => Average Accuracy (CNN): 88.86 

2024-08-25 20:01:42,980 [trainer.py] => All params: 172004552
2024-08-25 20:01:42,982 [trainer.py] => Trainable params: 330340
2024-08-25 20:01:42,982 [dualprompt.py] => Learning on 95-100
2024-08-25 20:15:14,034 [dualprompt.py] => Task 19, Epoch 20/20 => Loss 0.059, Train_accy 95.80, Test_accy 81.85
2024-08-25 20:16:22,609 [trainer.py] => No NME accuracy.
2024-08-25 20:16:22,610 [trainer.py] => CNN: {'total': 81.85, '00-04': 88.6, '05-09': 89.0, '10-14': 82.2, '15-19': 85.2, '20-24': 90.6, '25-29': 91.6, '30-34': 75.8, '35-39': 88.2, '40-44': 87.2, '45-49': 73.6, '50-54': 76.2, '55-59': 65.0, '60-64': 86.0, '65-69': 90.0, '70-74': 79.8, '75-79': 74.0, '80-84': 78.6, '85-89': 74.6, '90-94': 87.6, '95-99': 73.2, 'old': 82.31, 'new': 73.2}
2024-08-25 20:16:22,610 [trainer.py] => CNN top1 curve: [99.8, 95.7, 94.73, 93.6, 93.32, 92.57, 90.09, 89.9, 88.91, 87.64, 86.82, 86.63, 85.62, 85.93, 84.97, 83.7, 83.31, 82.58, 82.54, 81.85]
2024-08-25 20:16:22,610 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.47, 99.15, 99.08, 98.73, 98.83, 98.75, 98.67, 98.48, 98.4, 98.2, 98.03, 97.97, 97.88, 97.72, 97.65, 97.32, 97.16, 96.96]

Average Accuracy (CNN): 88.51
2024-08-25 20:16:22,610 [trainer.py] => Average Accuracy (CNN): 88.51 

Accuracy Matrix (CNN):
[[99.8 99.2 98.6 98.4 98.4 97.6 97.8 97.4 94.4 95.6 91.2 93.6 92.4 92.
  93.  90.  91.6 91.4 91.4 88.6]
 [ 0.  92.2 92.  92.  91.4 89.  89.2 89.4 89.6 88.8 89.8 89.2 89.8 90.
  89.2 89.4 90.  88.4 87.6 89. ]
 [ 0.   0.  93.6 93.4 92.4 92.  93.  92.6 88.8 86.2 86.  86.2 84.2 84.2
  84.6 85.2 84.6 83.8 83.  82.2]
 [ 0.   0.   0.  90.6 90.2 89.4 88.6 88.4 87.6 87.6 87.2 87.  85.4 84.8
  84.  85.8 84.8 85.  85.6 85.2]
 [ 0.   0.   0.   0.  94.2 93.6 90.8 90.  90.2 89.8 91.2 90.  89.8 90.4
  90.2 90.2 90.  89.4 89.2 90.6]
 [ 0.   0.   0.   0.   0.  93.8 93.8 94.2 93.8 92.2 92.2 92.6 92.  92.
  92.  92.2 91.4 91.4 91.  91.6]
 [ 0.   0.   0.   0.   0.   0.  77.4 77.  76.8 75.8 75.6 76.2 75.4 75.6
  75.4 75.  75.8 75.8 76.  75.8]
 [ 0.   0.   0.   0.   0.   0.   0.  90.2 89.2 87.4 89.6 89.2 89.  89.2
  89.2 88.8 89.2 88.6 88.2 88.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  89.8 90.  90.4 89.  89.  88.8
  88.6 87.6 87.6 87.4 87.6 87.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  83.  80.2 79.6 81.6 81.4
  81.  77.2 75.6 75.  75.6 73.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  81.6 80.4 80.2 80.6
  80.8 77.  76.  77.2 76.  76.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  86.6 71.4 70.
  65.  65.2 64.8 64.8 64.8 65. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  92.8 91.8
  88.  86.  87.6 86.8 86.  86. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  92.2
  91.4 91.2 91.6 90.8 91.  90. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  82.2 81.4 80.6 81.6 80.6 79.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  77.  76.6 74.8 74.2 74. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  78.4 78.2 77.4 78.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  76.  75.6 74.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  87.4 87.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  73.2]]
2024-08-25 20:16:22,615 [trainer.py] => Forgetting (CNN): 5.0736842105263165
2024-08-25 20:16:26,174 [trainer.py] => config: ./exps/dualprompt_cifar_B50_Inc5.json
2024-08-25 20:16:26,174 [trainer.py] => prefix:  
2024-08-25 20:16:26,174 [trainer.py] => dataset: cifar224
2024-08-25 20:16:26,174 [trainer.py] => memory_size: 0
2024-08-25 20:16:26,174 [trainer.py] => memory_per_class: 0
2024-08-25 20:16:26,174 [trainer.py] => fixed_memory: False
2024-08-25 20:16:26,174 [trainer.py] => shuffle: True
2024-08-25 20:16:26,174 [trainer.py] => init_cls: 50
2024-08-25 20:16:26,175 [trainer.py] => increment: 10
2024-08-25 20:16:26,175 [trainer.py] => model_name: dualprompt
2024-08-25 20:16:26,175 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-08-25 20:16:26,175 [trainer.py] => get_original_backbone: True
2024-08-25 20:16:26,175 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-25 20:16:26,175 [trainer.py] => seed: 1993
2024-08-25 20:16:26,175 [trainer.py] => tuned_epoch: 20
2024-08-25 20:16:26,175 [trainer.py] => init_lr: 0.001
2024-08-25 20:16:26,175 [trainer.py] => batch_size: 48
2024-08-25 20:16:26,175 [trainer.py] => weight_decay: 0
2024-08-25 20:16:26,175 [trainer.py] => min_lr: 1e-05
2024-08-25 20:16:26,175 [trainer.py] => optimizer: adam
2024-08-25 20:16:26,175 [trainer.py] => scheduler: constant
2024-08-25 20:16:26,175 [trainer.py] => reinit_optimizer: True
2024-08-25 20:16:26,175 [trainer.py] => global_pool: token
2024-08-25 20:16:26,175 [trainer.py] => head_type: token
2024-08-25 20:16:26,175 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-25 20:16:26,175 [trainer.py] => pretrained: True
2024-08-25 20:16:26,175 [trainer.py] => drop: 0.0
2024-08-25 20:16:26,175 [trainer.py] => drop_path: 0.0
2024-08-25 20:16:26,175 [trainer.py] => use_g_prompt: True
2024-08-25 20:16:26,175 [trainer.py] => g_prompt_length: 5
2024-08-25 20:16:26,175 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-08-25 20:16:26,176 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-08-25 20:16:26,176 [trainer.py] => use_e_prompt: True
2024-08-25 20:16:26,176 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-08-25 20:16:26,176 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-08-25 20:16:26,176 [trainer.py] => prompt_pool: True
2024-08-25 20:16:26,176 [trainer.py] => size: 10
2024-08-25 20:16:26,176 [trainer.py] => length: 5
2024-08-25 20:16:26,176 [trainer.py] => top_k: 1
2024-08-25 20:16:26,176 [trainer.py] => initializer: uniform
2024-08-25 20:16:26,176 [trainer.py] => prompt_key: True
2024-08-25 20:16:26,176 [trainer.py] => prompt_key_init: uniform
2024-08-25 20:16:26,176 [trainer.py] => use_prompt_mask: True
2024-08-25 20:16:26,176 [trainer.py] => shared_prompt_pool: True
2024-08-25 20:16:26,176 [trainer.py] => shared_prompt_key: False
2024-08-25 20:16:26,176 [trainer.py] => batchwise_prompt: True
2024-08-25 20:16:26,176 [trainer.py] => embedding_key: cls
2024-08-25 20:16:26,176 [trainer.py] => predefined_key: 
2024-08-25 20:16:26,176 [trainer.py] => pull_constraint: True
2024-08-25 20:16:26,176 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-25 20:16:26,176 [trainer.py] => same_key_value: False
2024-08-25 20:16:27,866 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-25 20:16:35,854 [dualprompt.py] => 86,128,996 model total parameters.
2024-08-25 20:16:35,854 [dualprompt.py] => 330,340 model training parameters.
2024-08-25 20:16:35,854 [dualprompt.py] => g_prompt: 15360
2024-08-25 20:16:35,854 [dualprompt.py] => e_prompt.prompt: 230400
2024-08-25 20:16:35,854 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-08-25 20:16:35,855 [dualprompt.py] => head.weight: 76800
2024-08-25 20:16:35,861 [dualprompt.py] => head.bias: 100
2024-08-25 20:16:35,862 [trainer.py] => All params: 172004552
2024-08-25 20:16:35,863 [trainer.py] => Trainable params: 330340
2024-08-25 20:16:35,863 [dualprompt.py] => Learning on 0-50
2024-08-25 21:44:57,874 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.458, Train_accy 85.63, Test_accy 93.92
2024-08-25 21:45:33,183 [trainer.py] => No NME accuracy.
2024-08-25 21:45:33,183 [trainer.py] => CNN: {'total': 93.92, '00-49': 93.92, 'old': 0, 'new': 93.92}
2024-08-25 21:45:33,183 [trainer.py] => CNN top1 curve: [93.92]
2024-08-25 21:45:33,183 [trainer.py] => CNN top5 curve: [99.18]

Average Accuracy (CNN): 93.92
2024-08-25 21:45:33,183 [trainer.py] => Average Accuracy (CNN): 93.92 

2024-08-25 21:45:33,185 [trainer.py] => All params: 172004552
2024-08-25 21:45:33,186 [trainer.py] => Trainable params: 330340
2024-08-25 21:45:33,186 [dualprompt.py] => Learning on 50-60
2024-08-25 22:05:48,990 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.139, Train_accy 93.44, Test_accy 91.58
2024-08-25 22:06:31,046 [trainer.py] => No NME accuracy.
2024-08-25 22:06:31,046 [trainer.py] => CNN: {'total': 91.58, '00-49': 93.58, '50-59': 81.6, 'old': 93.58, 'new': 81.6}
2024-08-25 22:06:31,046 [trainer.py] => CNN top1 curve: [93.92, 91.58]
2024-08-25 22:06:31,046 [trainer.py] => CNN top5 curve: [99.18, 98.9]

Average Accuracy (CNN): 92.75
2024-08-25 22:06:31,047 [trainer.py] => Average Accuracy (CNN): 92.75 

2024-08-25 22:06:31,048 [trainer.py] => All params: 172004552
2024-08-25 22:06:31,049 [trainer.py] => Trainable params: 330340
2024-08-25 22:06:31,050 [dualprompt.py] => Learning on 60-70
2024-08-25 22:27:20,414 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.086, Train_accy 95.06, Test_accy 89.87
2024-08-25 22:28:09,336 [trainer.py] => No NME accuracy.
2024-08-25 22:28:09,337 [trainer.py] => CNN: {'total': 89.87, '00-49': 93.36, '50-59': 78.4, '60-69': 83.9, 'old': 90.87, 'new': 83.9}
2024-08-25 22:28:09,337 [trainer.py] => CNN top1 curve: [93.92, 91.58, 89.87]
2024-08-25 22:28:09,337 [trainer.py] => CNN top5 curve: [99.18, 98.9, 98.77]

Average Accuracy (CNN): 91.79
2024-08-25 22:28:09,337 [trainer.py] => Average Accuracy (CNN): 91.79 

2024-08-25 22:28:09,340 [trainer.py] => All params: 172004552
2024-08-25 22:28:09,342 [trainer.py] => Trainable params: 330340
2024-08-25 22:28:09,342 [dualprompt.py] => Learning on 70-80
2024-08-25 22:49:21,259 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.114, Train_accy 94.46, Test_accy 86.18
2024-08-25 22:50:16,858 [trainer.py] => No NME accuracy.
2024-08-25 22:50:16,858 [trainer.py] => CNN: {'total': 86.18, '00-49': 93.42, '50-59': 77.3, '60-69': 82.9, '70-79': 62.1, 'old': 89.61, 'new': 62.1}
2024-08-25 22:50:16,858 [trainer.py] => CNN top1 curve: [93.92, 91.58, 89.87, 86.18]
2024-08-25 22:50:16,858 [trainer.py] => CNN top5 curve: [99.18, 98.9, 98.77, 98.4]

Average Accuracy (CNN): 90.39
2024-08-25 22:50:16,859 [trainer.py] => Average Accuracy (CNN): 90.39 

2024-08-25 22:50:16,860 [trainer.py] => All params: 172004552
2024-08-25 22:50:16,861 [trainer.py] => Trainable params: 330340
2024-08-25 22:50:16,861 [dualprompt.py] => Learning on 80-90
2024-08-25 23:11:50,385 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.128, Train_accy 93.84, Test_accy 82.73
2024-08-25 23:12:52,995 [trainer.py] => No NME accuracy.
2024-08-25 23:12:52,996 [trainer.py] => CNN: {'total': 82.73, '00-49': 93.4, '50-59': 75.9, '60-69': 82.2, '70-79': 61.0, '80-89': 58.5, 'old': 85.76, 'new': 58.5}
2024-08-25 23:12:52,996 [trainer.py] => CNN top1 curve: [93.92, 91.58, 89.87, 86.18, 82.73]
2024-08-25 23:12:52,996 [trainer.py] => CNN top5 curve: [99.18, 98.9, 98.77, 98.4, 97.99]

Average Accuracy (CNN): 88.86
2024-08-25 23:12:52,996 [trainer.py] => Average Accuracy (CNN): 88.86 

2024-08-25 23:12:52,999 [trainer.py] => All params: 172004552
2024-08-25 23:12:53,001 [trainer.py] => Trainable params: 330340
2024-08-25 23:12:53,001 [dualprompt.py] => Learning on 90-100
2024-08-25 23:34:58,185 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.122, Train_accy 94.10, Test_accy 80.60
2024-08-25 23:36:07,464 [trainer.py] => No NME accuracy.
2024-08-25 23:36:07,464 [trainer.py] => CNN: {'total': 80.6, '00-49': 93.4, '50-59': 75.9, '60-69': 81.8, '70-79': 61.1, '80-89': 58.0, '90-99': 62.2, 'old': 82.64, 'new': 62.2}
2024-08-25 23:36:07,465 [trainer.py] => CNN top1 curve: [93.92, 91.58, 89.87, 86.18, 82.73, 80.6]
2024-08-25 23:36:07,465 [trainer.py] => CNN top5 curve: [99.18, 98.9, 98.77, 98.4, 97.99, 97.42]

Average Accuracy (CNN): 87.48
2024-08-25 23:36:07,465 [trainer.py] => Average Accuracy (CNN): 87.48 

Accuracy Matrix (CNN):
[[93.92 93.58 93.36 93.42 93.4  93.4 ]
 [ 0.   81.6  78.4  77.3  75.9  75.9 ]
 [ 0.    0.   83.9  82.9  82.2  81.8 ]
 [ 0.    0.    0.   62.1  61.   61.1 ]
 [ 0.    0.    0.    0.   58.5  58.  ]
 [ 0.    0.    0.    0.    0.   62.2 ]]
2024-08-25 23:36:07,466 [trainer.py] => Forgetting (CNN): 1.9639999999999986
2024-08-25 23:36:10,784 [trainer.py] => config: ./exps/dualprompt_cifar_B50_Inc10.json
2024-08-25 23:36:10,784 [trainer.py] => prefix:  
2024-08-25 23:36:10,784 [trainer.py] => dataset: cifar224
2024-08-25 23:36:10,784 [trainer.py] => memory_size: 0
2024-08-25 23:36:10,784 [trainer.py] => memory_per_class: 0
2024-08-25 23:36:10,784 [trainer.py] => fixed_memory: False
2024-08-25 23:36:10,784 [trainer.py] => shuffle: True
2024-08-25 23:36:10,784 [trainer.py] => init_cls: 50
2024-08-25 23:36:10,784 [trainer.py] => increment: 5
2024-08-25 23:36:10,784 [trainer.py] => model_name: dualprompt
2024-08-25 23:36:10,784 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-08-25 23:36:10,784 [trainer.py] => get_original_backbone: True
2024-08-25 23:36:10,784 [trainer.py] => device: [device(type='cuda', index=0)]
2024-08-25 23:36:10,784 [trainer.py] => seed: 1993
2024-08-25 23:36:10,784 [trainer.py] => tuned_epoch: 20
2024-08-25 23:36:10,784 [trainer.py] => init_lr: 0.001
2024-08-25 23:36:10,785 [trainer.py] => batch_size: 48
2024-08-25 23:36:10,785 [trainer.py] => weight_decay: 0
2024-08-25 23:36:10,785 [trainer.py] => min_lr: 1e-05
2024-08-25 23:36:10,785 [trainer.py] => optimizer: adam
2024-08-25 23:36:10,785 [trainer.py] => scheduler: constant
2024-08-25 23:36:10,785 [trainer.py] => reinit_optimizer: True
2024-08-25 23:36:10,785 [trainer.py] => global_pool: token
2024-08-25 23:36:10,785 [trainer.py] => head_type: token
2024-08-25 23:36:10,785 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-08-25 23:36:10,785 [trainer.py] => pretrained: True
2024-08-25 23:36:10,785 [trainer.py] => drop: 0.0
2024-08-25 23:36:10,785 [trainer.py] => drop_path: 0.0
2024-08-25 23:36:10,785 [trainer.py] => use_g_prompt: True
2024-08-25 23:36:10,785 [trainer.py] => g_prompt_length: 5
2024-08-25 23:36:10,785 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-08-25 23:36:10,785 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-08-25 23:36:10,785 [trainer.py] => use_e_prompt: True
2024-08-25 23:36:10,785 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-08-25 23:36:10,785 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-08-25 23:36:10,785 [trainer.py] => prompt_pool: True
2024-08-25 23:36:10,785 [trainer.py] => size: 10
2024-08-25 23:36:10,785 [trainer.py] => length: 5
2024-08-25 23:36:10,785 [trainer.py] => top_k: 1
2024-08-25 23:36:10,785 [trainer.py] => initializer: uniform
2024-08-25 23:36:10,785 [trainer.py] => prompt_key: True
2024-08-25 23:36:10,785 [trainer.py] => prompt_key_init: uniform
2024-08-25 23:36:10,785 [trainer.py] => use_prompt_mask: True
2024-08-25 23:36:10,785 [trainer.py] => shared_prompt_pool: True
2024-08-25 23:36:10,785 [trainer.py] => shared_prompt_key: False
2024-08-25 23:36:10,786 [trainer.py] => batchwise_prompt: True
2024-08-25 23:36:10,786 [trainer.py] => embedding_key: cls
2024-08-25 23:36:10,786 [trainer.py] => predefined_key: 
2024-08-25 23:36:10,786 [trainer.py] => pull_constraint: True
2024-08-25 23:36:10,786 [trainer.py] => pull_constraint_coeff: 0.1
2024-08-25 23:36:10,786 [trainer.py] => same_key_value: False
2024-08-25 23:36:12,458 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-08-25 23:36:19,435 [dualprompt.py] => 86,128,996 model total parameters.
2024-08-25 23:36:19,436 [dualprompt.py] => 330,340 model training parameters.
2024-08-25 23:36:19,436 [dualprompt.py] => g_prompt: 15360
2024-08-25 23:36:19,436 [dualprompt.py] => e_prompt.prompt: 230400
2024-08-25 23:36:19,436 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-08-25 23:36:19,436 [dualprompt.py] => head.weight: 76800
2024-08-25 23:36:19,442 [dualprompt.py] => head.bias: 100
2024-08-25 23:36:19,443 [trainer.py] => All params: 172004552
2024-08-25 23:36:19,444 [trainer.py] => Trainable params: 330340
2024-08-25 23:36:19,444 [dualprompt.py] => Learning on 0-50
2024-08-26 01:04:59,730 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.458, Train_accy 85.63, Test_accy 93.92
2024-08-26 01:05:34,677 [trainer.py] => No NME accuracy.
2024-08-26 01:05:34,677 [trainer.py] => CNN: {'total': 93.92, '00-49': 93.92, 'old': 0, 'new': 93.92}
2024-08-26 01:05:34,677 [trainer.py] => CNN top1 curve: [93.92]
2024-08-26 01:05:34,677 [trainer.py] => CNN top5 curve: [99.18]

Average Accuracy (CNN): 93.92
2024-08-26 01:05:34,677 [trainer.py] => Average Accuracy (CNN): 93.92 

2024-08-26 01:05:34,679 [trainer.py] => All params: 172004552
2024-08-26 01:05:34,680 [trainer.py] => Trainable params: 330340
2024-08-26 01:05:34,680 [dualprompt.py] => Learning on 50-55
2024-08-26 01:17:04,805 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.021, Train_accy 97.88, Test_accy 91.18
2024-08-26 01:17:43,467 [trainer.py] => No NME accuracy.
2024-08-26 01:17:43,468 [trainer.py] => CNN: {'total': 91.18, '00-49': 93.96, '50-54': 63.4, 'old': 93.96, 'new': 63.4}
2024-08-26 01:17:43,468 [trainer.py] => CNN top1 curve: [93.92, 91.18]
2024-08-26 01:17:43,468 [trainer.py] => CNN top5 curve: [99.18, 99.07]

Average Accuracy (CNN): 92.55
2024-08-26 01:17:43,468 [trainer.py] => Average Accuracy (CNN): 92.55 

2024-08-26 01:17:43,471 [trainer.py] => All params: 172004552
2024-08-26 01:17:43,473 [trainer.py] => Trainable params: 330340
2024-08-26 01:17:43,474 [dualprompt.py] => Learning on 55-60
2024-08-26 01:29:22,710 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.137, Train_accy 92.16, Test_accy 88.75
2024-08-26 01:30:04,878 [trainer.py] => No NME accuracy.
2024-08-26 01:30:04,879 [trainer.py] => CNN: {'total': 88.75, '00-49': 93.66, '50-54': 63.4, '55-59': 65.0, 'old': 90.91, 'new': 65.0}
2024-08-26 01:30:04,879 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75]
2024-08-26 01:30:04,879 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52]

Average Accuracy (CNN): 91.28
2024-08-26 01:30:04,879 [trainer.py] => Average Accuracy (CNN): 91.28 

2024-08-26 01:30:04,881 [trainer.py] => All params: 172004552
2024-08-26 01:30:04,883 [trainer.py] => Trainable params: 330340
2024-08-26 01:30:04,883 [dualprompt.py] => Learning on 60-65
2024-08-26 01:42:00,599 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.020, Train_accy 97.56, Test_accy 86.45
2024-08-26 01:42:46,204 [trainer.py] => No NME accuracy.
2024-08-26 01:42:46,205 [trainer.py] => CNN: {'total': 86.45, '00-49': 93.62, '50-54': 63.6, '55-59': 59.4, '60-64': 64.6, 'old': 88.27, 'new': 64.6}
2024-08-26 01:42:46,205 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45]
2024-08-26 01:42:46,205 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35]

Average Accuracy (CNN): 90.08
2024-08-26 01:42:46,205 [trainer.py] => Average Accuracy (CNN): 90.08 

2024-08-26 01:42:46,208 [trainer.py] => All params: 172004552
2024-08-26 01:42:46,210 [trainer.py] => Trainable params: 330340
2024-08-26 01:42:46,210 [dualprompt.py] => Learning on 65-70
2024-08-26 01:54:55,553 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.017, Train_accy 97.40, Test_accy 84.74
2024-08-26 01:55:44,300 [trainer.py] => No NME accuracy.
2024-08-26 01:55:44,300 [trainer.py] => CNN: {'total': 84.74, '00-49': 93.56, '50-54': 62.4, '55-59': 58.0, '60-64': 63.6, '65-69': 66.8, 'old': 86.12, 'new': 66.8}
2024-08-26 01:55:44,300 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45, 84.74]
2024-08-26 01:55:44,300 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35, 98.17]

Average Accuracy (CNN): 89.01
2024-08-26 01:55:44,301 [trainer.py] => Average Accuracy (CNN): 89.01 

2024-08-26 01:55:44,303 [trainer.py] => All params: 172004552
2024-08-26 01:55:44,305 [trainer.py] => Trainable params: 330340
2024-08-26 01:55:44,305 [dualprompt.py] => Learning on 70-75
2024-08-26 02:08:07,435 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.045, Train_accy 96.80, Test_accy 81.36
2024-08-26 02:08:59,937 [trainer.py] => No NME accuracy.
2024-08-26 02:08:59,938 [trainer.py] => CNN: {'total': 81.36, '00-49': 93.52, '50-54': 62.8, '55-59': 51.4, '60-64': 59.4, '65-69': 65.0, '70-74': 46.6, 'old': 83.84, 'new': 46.6}
2024-08-26 02:08:59,938 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45, 84.74, 81.36]
2024-08-26 02:08:59,938 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35, 98.17, 97.72]

Average Accuracy (CNN): 87.73
2024-08-26 02:08:59,938 [trainer.py] => Average Accuracy (CNN): 87.73 

2024-08-26 02:08:59,942 [trainer.py] => All params: 172004552
2024-08-26 02:08:59,945 [trainer.py] => Trainable params: 330340
2024-08-26 02:08:59,945 [dualprompt.py] => Learning on 75-80
2024-08-26 02:21:33,446 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.025, Train_accy 97.48, Test_accy 78.32
2024-08-26 02:22:28,969 [trainer.py] => No NME accuracy.
2024-08-26 02:22:28,970 [trainer.py] => CNN: {'total': 78.32, '00-49': 93.56, '50-54': 61.4, '55-59': 51.0, '60-64': 58.4, '65-69': 65.2, '70-74': 46.6, '75-79': 35.0, 'old': 81.21, 'new': 35.0}
2024-08-26 02:22:28,970 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45, 84.74, 81.36, 78.32]
2024-08-26 02:22:28,970 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35, 98.17, 97.72, 97.19]

Average Accuracy (CNN): 86.39
2024-08-26 02:22:28,970 [trainer.py] => Average Accuracy (CNN): 86.39 

2024-08-26 02:22:28,973 [trainer.py] => All params: 172004552
2024-08-26 02:22:28,975 [trainer.py] => Trainable params: 330340
2024-08-26 02:22:28,975 [dualprompt.py] => Learning on 80-85
2024-08-26 02:35:20,659 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.019, Train_accy 97.64, Test_accy 75.40
2024-08-26 02:36:20,201 [trainer.py] => No NME accuracy.
2024-08-26 02:36:20,201 [trainer.py] => CNN: {'total': 75.4, '00-49': 93.4, '50-54': 61.2, '55-59': 51.2, '60-64': 58.4, '65-69': 64.2, '70-74': 46.6, '75-79': 34.8, '80-84': 31.4, 'old': 78.15, 'new': 31.4}
2024-08-26 02:36:20,201 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45, 84.74, 81.36, 78.32, 75.4]
2024-08-26 02:36:20,201 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35, 98.17, 97.72, 97.19, 97.04]

Average Accuracy (CNN): 85.02
2024-08-26 02:36:20,201 [trainer.py] => Average Accuracy (CNN): 85.02 

2024-08-26 02:36:20,203 [trainer.py] => All params: 172004552
2024-08-26 02:36:20,204 [trainer.py] => Trainable params: 330340
2024-08-26 02:36:20,205 [dualprompt.py] => Learning on 85-90
2024-08-26 02:49:25,113 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.084, Train_accy 94.84, Test_accy 73.02
2024-08-26 02:50:28,090 [trainer.py] => No NME accuracy.
2024-08-26 02:50:28,091 [trainer.py] => CNN: {'total': 73.02, '00-49': 93.54, '50-54': 59.6, '55-59': 48.8, '60-64': 57.4, '65-69': 63.6, '70-74': 44.2, '75-79': 33.6, '80-84': 30.0, '85-89': 41.8, 'old': 74.86, 'new': 41.8}
2024-08-26 02:50:28,091 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45, 84.74, 81.36, 78.32, 75.4, 73.02]
2024-08-26 02:50:28,091 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35, 98.17, 97.72, 97.19, 97.04, 96.01]

Average Accuracy (CNN): 83.68
2024-08-26 02:50:28,091 [trainer.py] => Average Accuracy (CNN): 83.68 

2024-08-26 02:50:28,092 [trainer.py] => All params: 172004552
2024-08-26 02:50:28,094 [trainer.py] => Trainable params: 330340
2024-08-26 02:50:28,094 [dualprompt.py] => Learning on 90-95
2024-08-26 03:03:46,351 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.042, Train_accy 97.00, Test_accy 71.32
2024-08-26 03:04:52,031 [trainer.py] => No NME accuracy.
2024-08-26 03:04:52,032 [trainer.py] => CNN: {'total': 71.32, '00-49': 93.56, '50-54': 58.4, '55-59': 48.6, '60-64': 57.2, '65-69': 64.0, '70-74': 44.6, '75-79': 33.6, '80-84': 30.8, '85-89': 42.4, '90-94': 39.8, 'old': 73.07, 'new': 39.8}
2024-08-26 03:04:52,032 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45, 84.74, 81.36, 78.32, 75.4, 73.02, 71.32]
2024-08-26 03:04:52,032 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35, 98.17, 97.72, 97.19, 97.04, 96.01, 96.01]

Average Accuracy (CNN): 82.45
2024-08-26 03:04:52,032 [trainer.py] => Average Accuracy (CNN): 82.45 

2024-08-26 03:04:52,034 [trainer.py] => All params: 172004552
2024-08-26 03:04:52,036 [trainer.py] => Trainable params: 330340
2024-08-26 03:04:52,036 [dualprompt.py] => Learning on 95-100
2024-08-26 03:18:23,230 [dualprompt.py] => Task 10, Epoch 20/20 => Loss 0.047, Train_accy 96.40, Test_accy 66.45
2024-08-26 03:19:32,626 [trainer.py] => No NME accuracy.
2024-08-26 03:19:32,627 [trainer.py] => CNN: {'total': 66.45, '00-49': 92.82, '50-54': 53.4, '55-59': 46.0, '60-64': 51.4, '65-69': 49.6, '70-74': 37.4, '75-79': 27.8, '80-84': 24.8, '85-89': 33.8, '90-94': 32.4, '95-99': 44.2, 'old': 67.62, 'new': 44.2}
2024-08-26 03:19:32,627 [trainer.py] => CNN top1 curve: [93.92, 91.18, 88.75, 86.45, 84.74, 81.36, 78.32, 75.4, 73.02, 71.32, 66.45]
2024-08-26 03:19:32,627 [trainer.py] => CNN top5 curve: [99.18, 99.07, 98.52, 98.35, 98.17, 97.72, 97.19, 97.04, 96.01, 96.01, 94.54]

Average Accuracy (CNN): 80.99
2024-08-26 03:19:32,627 [trainer.py] => Average Accuracy (CNN): 80.99 

Accuracy Matrix (CNN):
[[93.92 93.96 93.66 93.62 93.56 93.52 93.56 93.4  93.54 93.56 92.82]
 [ 0.   63.4  63.4  63.6  62.4  62.8  61.4  61.2  59.6  58.4  53.4 ]
 [ 0.    0.   65.   59.4  58.   51.4  51.   51.2  48.8  48.6  46.  ]
 [ 0.    0.    0.   64.6  63.6  59.4  58.4  58.4  57.4  57.2  51.4 ]
 [ 0.    0.    0.    0.   66.8  65.   65.2  64.2  63.6  64.   49.6 ]
 [ 0.    0.    0.    0.    0.   46.6  46.6  46.6  44.2  44.6  37.4 ]
 [ 0.    0.    0.    0.    0.    0.   35.   34.8  33.6  33.6  27.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.   31.4  30.   30.8  24.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   41.8  42.4  33.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   39.8  32.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   44.2 ]]
2024-08-26 03:19:32,630 [trainer.py] => Forgetting (CNN): 9.974
nohup: 忽略输入
2024-09-03 15:31:50,419 [trainer.py] => config: ./exps/coda_prompt_cifar_B0_Inc5.json
2024-09-03 15:31:50,419 [trainer.py] => prefix:  
2024-09-03 15:31:50,419 [trainer.py] => dataset: cifar224
2024-09-03 15:31:50,419 [trainer.py] => memory_size: 0
2024-09-03 15:31:50,419 [trainer.py] => memory_per_class: 0
2024-09-03 15:31:50,419 [trainer.py] => fixed_memory: False
2024-09-03 15:31:50,419 [trainer.py] => shuffle: True
2024-09-03 15:31:50,420 [trainer.py] => init_cls: 20
2024-09-03 15:31:50,420 [trainer.py] => increment: 20
2024-09-03 15:31:50,420 [trainer.py] => model_name: coda_prompt
2024-09-03 15:31:50,420 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-03 15:31:50,420 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-03 15:31:50,420 [trainer.py] => seed: 1993
2024-09-03 15:31:50,420 [trainer.py] => tuned_epoch: 20
2024-09-03 15:31:50,420 [trainer.py] => init_lr: 0.001
2024-09-03 15:31:50,420 [trainer.py] => batch_size: 48
2024-09-03 15:31:50,420 [trainer.py] => weight_decay: 0
2024-09-03 15:31:50,420 [trainer.py] => min_lr: 1e-05
2024-09-03 15:31:50,420 [trainer.py] => optimizer: adam
2024-09-03 15:31:50,420 [trainer.py] => scheduler: cosine
2024-09-03 15:31:50,420 [trainer.py] => reinit_optimizer: True
2024-09-03 15:31:50,420 [trainer.py] => pretrained: True
2024-09-03 15:31:50,420 [trainer.py] => drop: 0.0
2024-09-03 15:31:50,420 [trainer.py] => drop_path: 0.0
2024-09-03 15:31:50,420 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-03 15:31:51,597 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-03 15:31:57,906 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-03 15:31:57,907 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-03 15:31:57,907 [trainer.py] => All params: 89715556
2024-09-03 15:31:57,907 [trainer.py] => Trainable params: 89715556
2024-09-03 15:31:57,908 [coda_prompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.708, Train_accy 80.14:   0%|          | 0/20 [01:47<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.708, Train_accy 80.14:   5%|▌         | 1/20 [01:47<34:11, 107.96s/it]
Task 0, Epoch 2/20 => Loss 0.376, Train_accy 88.28:   5%|▌         | 1/20 [03:34<34:11, 107.96s/it]
Task 0, Epoch 2/20 => Loss 0.376, Train_accy 88.28:  10%|█         | 2/20 [03:34<32:09, 107.20s/it]
Task 0, Epoch 3/20 => Loss 0.341, Train_accy 89.79:  10%|█         | 2/20 [05:21<32:09, 107.20s/it]
Task 0, Epoch 3/20 => Loss 0.341, Train_accy 89.79:  15%|█▌        | 3/20 [05:21<30:23, 107.27s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.77:  15%|█▌        | 3/20 [07:09<30:23, 107.27s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.77:  20%|██        | 4/20 [07:09<28:37, 107.37s/it]
Task 0, Epoch 5/20 => Loss 0.305, Train_accy 90.73, Test_accy 96.95:  20%|██        | 4/20 [09:08<28:37, 107.37s/it]
Task 0, Epoch 5/20 => Loss 0.305, Train_accy 90.73, Test_accy 96.95:  25%|██▌       | 5/20 [09:08<27:51, 111.44s/it]
Task 0, Epoch 6/20 => Loss 0.286, Train_accy 91.23:  25%|██▌       | 5/20 [10:55<27:51, 111.44s/it]                 
Task 0, Epoch 6/20 => Loss 0.286, Train_accy 91.23:  30%|███       | 6/20 [10:55<25:42, 110.17s/it]
Task 0, Epoch 7/20 => Loss 0.277, Train_accy 91.70:  30%|███       | 6/20 [12:43<25:42, 110.17s/it]
Task 0, Epoch 7/20 => Loss 0.277, Train_accy 91.70:  35%|███▌      | 7/20 [12:43<23:43, 109.47s/it]
Task 0, Epoch 8/20 => Loss 0.271, Train_accy 91.68:  35%|███▌      | 7/20 [14:31<23:43, 109.47s/it]
Task 0, Epoch 8/20 => Loss 0.271, Train_accy 91.68:  40%|████      | 8/20 [14:31<21:45, 108.83s/it]
Task 0, Epoch 9/20 => Loss 0.275, Train_accy 91.60:  40%|████      | 8/20 [16:18<21:45, 108.83s/it]
Task 0, Epoch 9/20 => Loss 0.275, Train_accy 91.60:  45%|████▌     | 9/20 [16:18<19:52, 108.38s/it]
Task 0, Epoch 10/20 => Loss 0.266, Train_accy 91.96, Test_accy 97.45:  45%|████▌     | 9/20 [18:17<19:52, 108.38s/it]
Task 0, Epoch 10/20 => Loss 0.266, Train_accy 91.96, Test_accy 97.45:  50%|█████     | 10/20 [18:17<18:35, 111.54s/it]
Task 0, Epoch 11/20 => Loss 0.256, Train_accy 92.24:  50%|█████     | 10/20 [20:05<18:35, 111.54s/it]                 
Task 0, Epoch 11/20 => Loss 0.256, Train_accy 92.24:  55%|█████▌    | 11/20 [20:05<16:33, 110.41s/it]
Task 0, Epoch 12/20 => Loss 0.241, Train_accy 92.58:  55%|█████▌    | 11/20 [21:52<16:33, 110.41s/it]
Task 0, Epoch 12/20 => Loss 0.241, Train_accy 92.58:  60%|██████    | 12/20 [21:52<14:35, 109.48s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.60:  60%|██████    | 12/20 [23:39<14:35, 109.48s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.60:  65%|██████▌   | 13/20 [23:39<12:41, 108.81s/it]
Task 0, Epoch 14/20 => Loss 0.240, Train_accy 93.05:  65%|██████▌   | 13/20 [25:27<12:41, 108.81s/it]
Task 0, Epoch 14/20 => Loss 0.240, Train_accy 93.05:  70%|███████   | 14/20 [25:27<10:50, 108.42s/it]
Task 0, Epoch 15/20 => Loss 0.246, Train_accy 92.48, Test_accy 97.90:  70%|███████   | 14/20 [27:25<10:50, 108.42s/it]
Task 0, Epoch 15/20 => Loss 0.246, Train_accy 92.48, Test_accy 97.90:  75%|███████▌  | 15/20 [27:25<09:17, 111.47s/it]
Task 0, Epoch 16/20 => Loss 0.242, Train_accy 92.74:  75%|███████▌  | 15/20 [29:13<09:17, 111.47s/it]                 
Task 0, Epoch 16/20 => Loss 0.242, Train_accy 92.74:  80%|████████  | 16/20 [29:13<07:21, 110.30s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 92.83:  80%|████████  | 16/20 [31:01<07:21, 110.30s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 92.83:  85%|████████▌ | 17/20 [31:01<05:28, 109.57s/it]
Task 0, Epoch 18/20 => Loss 0.207, Train_accy 93.22:  85%|████████▌ | 17/20 [32:49<05:28, 109.57s/it]
Task 0, Epoch 18/20 => Loss 0.207, Train_accy 93.22:  90%|█████████ | 18/20 [32:49<03:38, 109.03s/it]
Task 0, Epoch 19/20 => Loss 0.219, Train_accy 93.21:  90%|█████████ | 18/20 [34:36<03:38, 109.03s/it]
Task 0, Epoch 19/20 => Loss 0.219, Train_accy 93.21:  95%|█████████▌| 19/20 [34:36<01:48, 108.65s/it]
Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65:  95%|█████████▌| 19/20 [36:35<01:48, 108.65s/it]
Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65: 100%|██████████| 20/20 [36:35<00:00, 111.68s/it]
Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65: 100%|██████████| 20/20 [36:35<00:00, 109.78s/it]
2024-09-03 16:08:34,526 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65
2024-09-03 16:08:45,855 [trainer.py] => No NME accuracy.
2024-09-03 16:08:45,856 [trainer.py] => CNN: {'total': 97.65, '00-19': 97.65, 'old': 0, 'new': 97.65}
2024-09-03 16:08:45,856 [trainer.py] => CNN top1 curve: [97.65]
2024-09-03 16:08:45,856 [trainer.py] => CNN top5 curve: [99.55]

Average Accuracy (CNN): 97.65
2024-09-03 16:08:45,857 [trainer.py] => Average Accuracy (CNN): 97.65 

2024-09-03 16:08:45,858 [trainer.py] => All params: 89715556
2024-09-03 16:08:45,859 [trainer.py] => Trainable params: 89715556
2024-09-03 16:08:47,016 [coda_prompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.476, Train_accy 85.86:   0%|          | 0/20 [01:47<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.476, Train_accy 85.86:   5%|▌         | 1/20 [01:47<34:10, 107.92s/it]
Task 1, Epoch 2/20 => Loss 0.249, Train_accy 92.13:   5%|▌         | 1/20 [03:35<34:10, 107.92s/it]
Task 1, Epoch 2/20 => Loss 0.249, Train_accy 92.13:  10%|█         | 2/20 [03:35<32:22, 107.92s/it]
Task 1, Epoch 3/20 => Loss 0.237, Train_accy 92.30:  10%|█         | 2/20 [05:23<32:22, 107.92s/it]
Task 1, Epoch 3/20 => Loss 0.237, Train_accy 92.30:  15%|█▌        | 3/20 [05:23<30:33, 107.83s/it]
Task 1, Epoch 4/20 => Loss 0.228, Train_accy 92.68:  15%|█▌        | 3/20 [07:11<30:33, 107.83s/it]
Task 1, Epoch 4/20 => Loss 0.228, Train_accy 92.68:  20%|██        | 4/20 [07:11<28:44, 107.77s/it]
Task 1, Epoch 5/20 => Loss 0.216, Train_accy 92.99, Test_accy 93.42:  20%|██        | 4/20 [09:21<28:44, 107.77s/it]
Task 1, Epoch 5/20 => Loss 0.216, Train_accy 92.99, Test_accy 93.42:  25%|██▌       | 5/20 [09:21<28:57, 115.84s/it]
Task 1, Epoch 6/20 => Loss 0.218, Train_accy 92.99:  25%|██▌       | 5/20 [11:09<28:57, 115.84s/it]                 
Task 1, Epoch 6/20 => Loss 0.218, Train_accy 92.99:  30%|███       | 6/20 [11:09<26:23, 113.10s/it]
Task 1, Epoch 7/20 => Loss 0.199, Train_accy 93.70:  30%|███       | 6/20 [12:57<26:23, 113.10s/it]
Task 1, Epoch 7/20 => Loss 0.199, Train_accy 93.70:  35%|███▌      | 7/20 [12:57<24:08, 111.40s/it]
Task 1, Epoch 8/20 => Loss 0.202, Train_accy 93.57:  35%|███▌      | 7/20 [14:45<24:08, 111.40s/it]
Task 1, Epoch 8/20 => Loss 0.202, Train_accy 93.57:  40%|████      | 8/20 [14:45<22:04, 110.34s/it]
Task 1, Epoch 9/20 => Loss 0.199, Train_accy 93.67:  40%|████      | 8/20 [16:33<22:04, 110.34s/it]
Task 1, Epoch 9/20 => Loss 0.199, Train_accy 93.67:  45%|████▌     | 9/20 [16:33<20:06, 109.66s/it]
Task 1, Epoch 10/20 => Loss 0.214, Train_accy 93.20, Test_accy 94.75:  45%|████▌     | 9/20 [18:43<20:06, 109.66s/it]
Task 1, Epoch 10/20 => Loss 0.214, Train_accy 93.20, Test_accy 94.75:  50%|█████     | 10/20 [18:43<19:19, 115.91s/it]
Task 1, Epoch 11/20 => Loss 0.193, Train_accy 93.86:  50%|█████     | 10/20 [20:31<19:19, 115.91s/it]                 
Task 1, Epoch 11/20 => Loss 0.193, Train_accy 93.86:  55%|█████▌    | 11/20 [20:31<17:00, 113.44s/it]
Task 1, Epoch 12/20 => Loss 0.188, Train_accy 94.08:  55%|█████▌    | 11/20 [22:19<17:00, 113.44s/it]
Task 1, Epoch 12/20 => Loss 0.188, Train_accy 94.08:  60%|██████    | 12/20 [22:19<14:55, 111.88s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 94.24:  60%|██████    | 12/20 [24:07<14:55, 111.88s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 94.24:  65%|██████▌   | 13/20 [24:07<12:55, 110.73s/it]
Task 1, Epoch 14/20 => Loss 0.185, Train_accy 94.19:  65%|██████▌   | 13/20 [25:55<12:55, 110.73s/it]
Task 1, Epoch 14/20 => Loss 0.185, Train_accy 94.19:  70%|███████   | 14/20 [25:55<10:59, 109.97s/it]
Task 1, Epoch 15/20 => Loss 0.167, Train_accy 94.60, Test_accy 94.50:  70%|███████   | 14/20 [28:06<10:59, 109.97s/it]
Task 1, Epoch 15/20 => Loss 0.167, Train_accy 94.60, Test_accy 94.50:  75%|███████▌  | 15/20 [28:06<09:40, 116.16s/it]
Task 1, Epoch 16/20 => Loss 0.180, Train_accy 94.26:  75%|███████▌  | 15/20 [29:53<09:40, 116.16s/it]                 
Task 1, Epoch 16/20 => Loss 0.180, Train_accy 94.26:  80%|████████  | 16/20 [29:53<07:34, 113.64s/it]
Task 1, Epoch 17/20 => Loss 0.171, Train_accy 94.54:  80%|████████  | 16/20 [31:41<07:34, 113.64s/it]
Task 1, Epoch 17/20 => Loss 0.171, Train_accy 94.54:  85%|████████▌ | 17/20 [31:41<05:35, 111.87s/it]
Task 1, Epoch 18/20 => Loss 0.171, Train_accy 94.53:  85%|████████▌ | 17/20 [33:29<05:35, 111.87s/it]
Task 1, Epoch 18/20 => Loss 0.171, Train_accy 94.53:  90%|█████████ | 18/20 [33:29<03:41, 110.63s/it]
Task 1, Epoch 19/20 => Loss 0.166, Train_accy 94.63:  90%|█████████ | 18/20 [35:17<03:41, 110.63s/it]
Task 1, Epoch 19/20 => Loss 0.166, Train_accy 94.63:  95%|█████████▌| 19/20 [35:17<01:49, 109.81s/it]
Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55:  95%|█████████▌| 19/20 [37:27<01:49, 109.81s/it]
Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55: 100%|██████████| 20/20 [37:27<00:00, 115.79s/it]
Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55: 100%|██████████| 20/20 [37:27<00:00, 112.36s/it]
2024-09-03 16:46:14,157 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55
2024-09-03 16:46:36,315 [trainer.py] => No NME accuracy.
2024-09-03 16:46:36,316 [trainer.py] => CNN: {'total': 94.55, '00-19': 94.75, '20-39': 94.35, 'old': 94.75, 'new': 94.35}
2024-09-03 16:46:36,316 [trainer.py] => CNN top1 curve: [97.65, 94.55]
2024-09-03 16:46:36,316 [trainer.py] => CNN top5 curve: [99.55, 99.35]

Average Accuracy (CNN): 96.1
2024-09-03 16:46:36,316 [trainer.py] => Average Accuracy (CNN): 96.1 

2024-09-03 16:46:36,318 [trainer.py] => All params: 89715556
2024-09-03 16:46:36,319 [trainer.py] => Trainable params: 89715556
2024-09-03 16:46:38,354 [coda_prompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.487, Train_accy 85.68:   0%|          | 0/20 [01:48<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.487, Train_accy 85.68:   5%|▌         | 1/20 [01:48<34:18, 108.32s/it]
Task 2, Epoch 2/20 => Loss 0.298, Train_accy 90.54:   5%|▌         | 1/20 [03:36<34:18, 108.32s/it]
Task 2, Epoch 2/20 => Loss 0.298, Train_accy 90.54:  10%|█         | 2/20 [03:36<32:31, 108.41s/it]
Task 2, Epoch 3/20 => Loss 0.259, Train_accy 91.56:  10%|█         | 2/20 [05:24<32:31, 108.41s/it]
Task 2, Epoch 3/20 => Loss 0.259, Train_accy 91.56:  15%|█▌        | 3/20 [05:24<30:40, 108.29s/it]
Task 2, Epoch 4/20 => Loss 0.249, Train_accy 92.10:  15%|█▌        | 3/20 [07:13<30:40, 108.29s/it]
Task 2, Epoch 4/20 => Loss 0.249, Train_accy 92.10:  20%|██        | 4/20 [07:13<28:51, 108.20s/it]
Task 2, Epoch 5/20 => Loss 0.246, Train_accy 92.09, Test_accy 91.43:  20%|██        | 4/20 [09:34<28:51, 108.20s/it]
Task 2, Epoch 5/20 => Loss 0.246, Train_accy 92.09, Test_accy 91.43:  25%|██▌       | 5/20 [09:34<30:02, 120.14s/it]
Task 2, Epoch 6/20 => Loss 0.226, Train_accy 92.78:  25%|██▌       | 5/20 [11:22<30:02, 120.14s/it]                 
Task 2, Epoch 6/20 => Loss 0.226, Train_accy 92.78:  30%|███       | 6/20 [11:22<27:04, 116.05s/it]
Task 2, Epoch 7/20 => Loss 0.230, Train_accy 92.93:  30%|███       | 6/20 [13:10<27:04, 116.05s/it]
Task 2, Epoch 7/20 => Loss 0.230, Train_accy 92.93:  35%|███▌      | 7/20 [13:10<24:35, 113.47s/it]
Task 2, Epoch 8/20 => Loss 0.218, Train_accy 92.80:  35%|███▌      | 7/20 [14:58<24:35, 113.47s/it]
Task 2, Epoch 8/20 => Loss 0.218, Train_accy 92.80:  40%|████      | 8/20 [14:58<22:21, 111.82s/it]
Task 2, Epoch 9/20 => Loss 0.228, Train_accy 92.88:  40%|████      | 8/20 [16:46<22:21, 111.82s/it]
Task 2, Epoch 9/20 => Loss 0.228, Train_accy 92.88:  45%|████▌     | 9/20 [16:46<20:16, 110.60s/it]
Task 2, Epoch 10/20 => Loss 0.209, Train_accy 93.49, Test_accy 92.10:  45%|████▌     | 9/20 [19:08<20:16, 110.60s/it]
Task 2, Epoch 10/20 => Loss 0.209, Train_accy 93.49, Test_accy 92.10:  50%|█████     | 10/20 [19:08<20:02, 120.28s/it]
Task 2, Epoch 11/20 => Loss 0.206, Train_accy 93.45:  50%|█████     | 10/20 [20:57<20:02, 120.28s/it]                 
Task 2, Epoch 11/20 => Loss 0.206, Train_accy 93.45:  55%|█████▌    | 11/20 [20:57<17:29, 116.66s/it]
Task 2, Epoch 12/20 => Loss 0.200, Train_accy 93.47:  55%|█████▌    | 11/20 [22:45<17:29, 116.66s/it]
Task 2, Epoch 12/20 => Loss 0.200, Train_accy 93.47:  60%|██████    | 12/20 [22:45<15:12, 114.04s/it]
Task 2, Epoch 13/20 => Loss 0.196, Train_accy 93.62:  60%|██████    | 12/20 [24:33<15:12, 114.04s/it]
Task 2, Epoch 13/20 => Loss 0.196, Train_accy 93.62:  65%|██████▌   | 13/20 [24:33<13:06, 112.33s/it]
Task 2, Epoch 14/20 => Loss 0.185, Train_accy 94.03:  65%|██████▌   | 13/20 [26:21<13:06, 112.33s/it]
Task 2, Epoch 14/20 => Loss 0.185, Train_accy 94.03:  70%|███████   | 14/20 [26:21<11:06, 111.13s/it]
Task 2, Epoch 15/20 => Loss 0.192, Train_accy 93.89, Test_accy 92.55:  70%|███████   | 14/20 [28:43<11:06, 111.13s/it]
Task 2, Epoch 15/20 => Loss 0.192, Train_accy 93.89, Test_accy 92.55:  75%|███████▌  | 15/20 [28:43<10:01, 120.30s/it]
Task 2, Epoch 16/20 => Loss 0.194, Train_accy 93.75:  75%|███████▌  | 15/20 [30:32<10:01, 120.30s/it]                 
Task 2, Epoch 16/20 => Loss 0.194, Train_accy 93.75:  80%|████████  | 16/20 [30:32<07:47, 116.77s/it]
Task 2, Epoch 17/20 => Loss 0.184, Train_accy 94.15:  80%|████████  | 16/20 [32:20<07:47, 116.77s/it]
Task 2, Epoch 17/20 => Loss 0.184, Train_accy 94.15:  85%|████████▌ | 17/20 [32:20<05:42, 114.31s/it]
Task 2, Epoch 18/20 => Loss 0.184, Train_accy 94.34:  85%|████████▌ | 17/20 [34:09<05:42, 114.31s/it]
Task 2, Epoch 18/20 => Loss 0.184, Train_accy 94.34:  90%|█████████ | 18/20 [34:09<03:45, 112.54s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 94.16:  90%|█████████ | 18/20 [35:57<03:45, 112.54s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 94.16:  95%|█████████▌| 19/20 [35:57<01:51, 111.22s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62:  95%|█████████▌| 19/20 [38:19<01:51, 111.22s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62: 100%|██████████| 20/20 [38:19<00:00, 120.38s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62: 100%|██████████| 20/20 [38:19<00:00, 114.95s/it]
2024-09-03 17:24:57,404 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62
2024-09-03 17:25:30,638 [trainer.py] => No NME accuracy.
2024-09-03 17:25:30,638 [trainer.py] => CNN: {'total': 92.62, '00-19': 93.0, '20-39': 92.55, '40-59': 92.3, 'old': 92.78, 'new': 92.3}
2024-09-03 17:25:30,638 [trainer.py] => CNN top1 curve: [97.65, 94.55, 92.62]
2024-09-03 17:25:30,639 [trainer.py] => CNN top5 curve: [99.55, 99.35, 99.2]

Average Accuracy (CNN): 94.94
2024-09-03 17:25:30,639 [trainer.py] => Average Accuracy (CNN): 94.94 

2024-09-03 17:25:30,639 [trainer.py] => All params: 89715556
2024-09-03 17:25:30,640 [trainer.py] => Trainable params: 89715556
2024-09-03 17:25:33,272 [coda_prompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.477, Train_accy 85.64:   0%|          | 0/20 [01:48<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.477, Train_accy 85.64:   5%|▌         | 1/20 [01:48<34:15, 108.20s/it]
Task 3, Epoch 2/20 => Loss 0.291, Train_accy 90.76:   5%|▌         | 1/20 [03:36<34:15, 108.20s/it]
Task 3, Epoch 2/20 => Loss 0.291, Train_accy 90.76:  10%|█         | 2/20 [03:36<32:30, 108.34s/it]
Task 3, Epoch 3/20 => Loss 0.256, Train_accy 91.83:  10%|█         | 2/20 [05:25<32:30, 108.34s/it]
Task 3, Epoch 3/20 => Loss 0.256, Train_accy 91.83:  15%|█▌        | 3/20 [05:25<30:43, 108.43s/it]
Task 3, Epoch 4/20 => Loss 0.234, Train_accy 92.37:  15%|█▌        | 3/20 [07:13<30:43, 108.43s/it]
Task 3, Epoch 4/20 => Loss 0.234, Train_accy 92.37:  20%|██        | 4/20 [07:13<28:53, 108.37s/it]
Task 3, Epoch 5/20 => Loss 0.236, Train_accy 92.37, Test_accy 89.16:  20%|██        | 4/20 [09:46<28:53, 108.37s/it]
Task 3, Epoch 5/20 => Loss 0.236, Train_accy 92.37, Test_accy 89.16:  25%|██▌       | 5/20 [09:46<31:04, 124.32s/it]
Task 3, Epoch 6/20 => Loss 0.223, Train_accy 92.86:  25%|██▌       | 5/20 [11:34<31:04, 124.32s/it]                 
Task 3, Epoch 6/20 => Loss 0.223, Train_accy 92.86:  30%|███       | 6/20 [11:34<27:42, 118.76s/it]
Task 3, Epoch 7/20 => Loss 0.220, Train_accy 93.16:  30%|███       | 6/20 [13:22<27:42, 118.76s/it]
Task 3, Epoch 7/20 => Loss 0.220, Train_accy 93.16:  35%|███▌      | 7/20 [13:22<24:59, 115.36s/it]
Task 3, Epoch 8/20 => Loss 0.224, Train_accy 92.39:  35%|███▌      | 7/20 [15:11<24:59, 115.36s/it]
Task 3, Epoch 8/20 => Loss 0.224, Train_accy 92.39:  40%|████      | 8/20 [15:11<22:38, 113.22s/it]
Task 3, Epoch 9/20 => Loss 0.215, Train_accy 92.93:  40%|████      | 8/20 [16:59<22:38, 113.22s/it]
Task 3, Epoch 9/20 => Loss 0.215, Train_accy 92.93:  45%|████▌     | 9/20 [16:59<20:29, 111.81s/it]
Task 3, Epoch 10/20 => Loss 0.218, Train_accy 92.75, Test_accy 90.00:  45%|████▌     | 9/20 [19:33<20:29, 111.81s/it]
Task 3, Epoch 10/20 => Loss 0.218, Train_accy 92.75, Test_accy 90.00:  50%|█████     | 10/20 [19:33<20:46, 124.66s/it]
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 93.59:  50%|█████     | 10/20 [21:21<20:46, 124.66s/it]                 
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 93.59:  55%|█████▌    | 11/20 [21:21<17:57, 119.77s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 93.65:  55%|█████▌    | 11/20 [23:10<17:57, 119.77s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 93.65:  60%|██████    | 12/20 [23:10<15:30, 116.33s/it]
Task 3, Epoch 13/20 => Loss 0.189, Train_accy 93.87:  60%|██████    | 12/20 [24:58<15:30, 116.33s/it]
Task 3, Epoch 13/20 => Loss 0.189, Train_accy 93.87:  65%|██████▌   | 13/20 [24:58<13:17, 113.98s/it]
Task 3, Epoch 14/20 => Loss 0.192, Train_accy 93.90:  65%|██████▌   | 13/20 [26:47<13:17, 113.98s/it]
Task 3, Epoch 14/20 => Loss 0.192, Train_accy 93.90:  70%|███████   | 14/20 [26:47<11:13, 112.32s/it]
Task 3, Epoch 15/20 => Loss 0.195, Train_accy 93.76, Test_accy 90.30:  70%|███████   | 14/20 [29:20<11:13, 112.32s/it]
Task 3, Epoch 15/20 => Loss 0.195, Train_accy 93.76, Test_accy 90.30:  75%|███████▌  | 15/20 [29:20<10:22, 124.57s/it]
Task 3, Epoch 16/20 => Loss 0.187, Train_accy 93.90:  75%|███████▌  | 15/20 [31:08<10:22, 124.57s/it]                 
Task 3, Epoch 16/20 => Loss 0.187, Train_accy 93.90:  80%|████████  | 16/20 [31:08<07:59, 119.79s/it]
Task 3, Epoch 17/20 => Loss 0.188, Train_accy 93.96:  80%|████████  | 16/20 [32:57<07:59, 119.79s/it]
Task 3, Epoch 17/20 => Loss 0.188, Train_accy 93.96:  85%|████████▌ | 17/20 [32:57<05:49, 116.39s/it]
Task 3, Epoch 18/20 => Loss 0.184, Train_accy 93.84:  85%|████████▌ | 17/20 [34:45<05:49, 116.39s/it]
Task 3, Epoch 18/20 => Loss 0.184, Train_accy 93.84:  90%|█████████ | 18/20 [34:45<03:47, 113.97s/it]
Task 3, Epoch 19/20 => Loss 0.184, Train_accy 94.01:  90%|█████████ | 18/20 [36:34<03:47, 113.97s/it]
Task 3, Epoch 19/20 => Loss 0.184, Train_accy 94.01:  95%|█████████▌| 19/20 [36:34<01:52, 112.32s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10:  95%|█████████▌| 19/20 [39:06<01:52, 112.32s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10: 100%|██████████| 20/20 [39:06<00:00, 124.30s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10: 100%|██████████| 20/20 [39:06<00:00, 117.32s/it]
2024-09-03 18:04:39,816 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10
2024-09-03 18:05:24,376 [trainer.py] => No NME accuracy.
2024-09-03 18:05:24,377 [trainer.py] => CNN: {'total': 90.1, '00-19': 92.0, '20-39': 91.9, '40-59': 86.35, '60-79': 90.15, 'old': 90.08, 'new': 90.15}
2024-09-03 18:05:24,377 [trainer.py] => CNN top1 curve: [97.65, 94.55, 92.62, 90.1]
2024-09-03 18:05:24,377 [trainer.py] => CNN top5 curve: [99.55, 99.35, 99.2, 99.12]

Average Accuracy (CNN): 93.73
2024-09-03 18:05:24,377 [trainer.py] => Average Accuracy (CNN): 93.73 

2024-09-03 18:05:24,378 [trainer.py] => All params: 89715556
2024-09-03 18:05:24,379 [trainer.py] => Trainable params: 89715556
2024-09-03 18:05:27,946 [coda_prompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.490, Train_accy 86.13:   0%|          | 0/20 [01:48<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.490, Train_accy 86.13:   5%|▌         | 1/20 [01:48<34:22, 108.56s/it]
Task 4, Epoch 2/20 => Loss 0.265, Train_accy 91.85:   5%|▌         | 1/20 [03:37<34:22, 108.56s/it]
Task 4, Epoch 2/20 => Loss 0.265, Train_accy 91.85:  10%|█         | 2/20 [03:37<32:34, 108.57s/it]
Task 4, Epoch 3/20 => Loss 0.252, Train_accy 92.56:  10%|█         | 2/20 [05:26<32:34, 108.57s/it]
Task 4, Epoch 3/20 => Loss 0.252, Train_accy 92.56:  15%|█▌        | 3/20 [05:26<30:48, 108.71s/it]
Task 4, Epoch 4/20 => Loss 0.240, Train_accy 92.96:  15%|█▌        | 3/20 [07:14<30:48, 108.71s/it]
Task 4, Epoch 4/20 => Loss 0.240, Train_accy 92.96:  20%|██        | 4/20 [07:14<29:00, 108.77s/it]
Task 4, Epoch 5/20 => Loss 0.213, Train_accy 93.43, Test_accy 88.25:  20%|██        | 4/20 [09:59<29:00, 108.77s/it]
Task 4, Epoch 5/20 => Loss 0.213, Train_accy 93.43, Test_accy 88.25:  25%|██▌       | 5/20 [09:59<32:11, 128.78s/it]
Task 4, Epoch 6/20 => Loss 0.221, Train_accy 93.05:  25%|██▌       | 5/20 [11:47<32:11, 128.78s/it]                 
Task 4, Epoch 6/20 => Loss 0.221, Train_accy 93.05:  30%|███       | 6/20 [11:47<28:27, 121.95s/it]
Task 4, Epoch 7/20 => Loss 0.213, Train_accy 93.35:  30%|███       | 6/20 [13:36<28:27, 121.95s/it]
Task 4, Epoch 7/20 => Loss 0.213, Train_accy 93.35:  35%|███▌      | 7/20 [13:36<25:28, 117.61s/it]
Task 4, Epoch 8/20 => Loss 0.211, Train_accy 93.31:  35%|███▌      | 7/20 [15:24<25:28, 117.61s/it]
Task 4, Epoch 8/20 => Loss 0.211, Train_accy 93.31:  40%|████      | 8/20 [15:24<22:56, 114.71s/it]
Task 4, Epoch 9/20 => Loss 0.203, Train_accy 93.84:  40%|████      | 8/20 [17:13<22:56, 114.71s/it]
Task 4, Epoch 9/20 => Loss 0.203, Train_accy 93.84:  45%|████▌     | 9/20 [17:13<20:42, 112.91s/it]
Task 4, Epoch 10/20 => Loss 0.198, Train_accy 93.97, Test_accy 89.15:  45%|████▌     | 9/20 [19:58<20:42, 112.91s/it]
Task 4, Epoch 10/20 => Loss 0.198, Train_accy 93.97, Test_accy 89.15:  50%|█████     | 10/20 [19:58<21:27, 128.71s/it]
Task 4, Epoch 11/20 => Loss 0.197, Train_accy 93.93:  50%|█████     | 10/20 [21:46<21:27, 128.71s/it]                 
Task 4, Epoch 11/20 => Loss 0.197, Train_accy 93.93:  55%|█████▌    | 11/20 [21:46<18:22, 122.51s/it]
Task 4, Epoch 12/20 => Loss 0.203, Train_accy 93.97:  55%|█████▌    | 11/20 [23:35<18:22, 122.51s/it]
Task 4, Epoch 12/20 => Loss 0.203, Train_accy 93.97:  60%|██████    | 12/20 [23:35<15:47, 118.40s/it]
Task 4, Epoch 13/20 => Loss 0.184, Train_accy 94.00:  60%|██████    | 12/20 [25:23<15:47, 118.40s/it]
Task 4, Epoch 13/20 => Loss 0.184, Train_accy 94.00:  65%|██████▌   | 13/20 [25:23<13:27, 115.33s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 94.22:  65%|██████▌   | 13/20 [27:12<13:27, 115.33s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 94.22:  70%|███████   | 14/20 [27:12<11:19, 113.33s/it]
Task 4, Epoch 15/20 => Loss 0.180, Train_accy 94.33, Test_accy 89.22:  70%|███████   | 14/20 [29:57<11:19, 113.33s/it]
Task 4, Epoch 15/20 => Loss 0.180, Train_accy 94.33, Test_accy 89.22:  75%|███████▌  | 15/20 [29:57<10:44, 128.90s/it]
Task 4, Epoch 16/20 => Loss 0.174, Train_accy 94.74:  75%|███████▌  | 15/20 [31:45<10:44, 128.90s/it]                 
Task 4, Epoch 16/20 => Loss 0.174, Train_accy 94.74:  80%|████████  | 16/20 [31:45<08:10, 122.63s/it]
Task 4, Epoch 17/20 => Loss 0.181, Train_accy 94.11:  80%|████████  | 16/20 [33:33<08:10, 122.63s/it]
Task 4, Epoch 17/20 => Loss 0.181, Train_accy 94.11:  85%|████████▌ | 17/20 [33:33<05:54, 118.33s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.43:  85%|████████▌ | 17/20 [35:22<05:54, 118.33s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.43:  90%|█████████ | 18/20 [35:22<03:50, 115.36s/it]
Task 4, Epoch 19/20 => Loss 0.172, Train_accy 94.60:  90%|█████████ | 18/20 [37:11<03:50, 115.36s/it]
Task 4, Epoch 19/20 => Loss 0.172, Train_accy 94.60:  95%|█████████▌| 19/20 [37:11<01:53, 113.41s/it]
Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33:  95%|█████████▌| 19/20 [39:55<01:53, 113.41s/it]
Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33: 100%|██████████| 20/20 [39:55<00:00, 128.80s/it]
Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33: 100%|██████████| 20/20 [39:55<00:00, 119.79s/it]
2024-09-03 18:45:23,822 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33
2024-09-03 18:46:20,080 [trainer.py] => No NME accuracy.
2024-09-03 18:46:20,081 [trainer.py] => CNN: {'total': 89.33, '00-19': 90.75, '20-39': 91.8, '40-59': 84.9, '60-79': 89.2, '80-99': 90.0, 'old': 89.16, 'new': 90.0}
2024-09-03 18:46:20,081 [trainer.py] => CNN top1 curve: [97.65, 94.55, 92.62, 90.1, 89.33]
2024-09-03 18:46:20,081 [trainer.py] => CNN top5 curve: [99.55, 99.35, 99.2, 99.12, 98.84]

Average Accuracy (CNN): 92.85
2024-09-03 18:46:20,081 [trainer.py] => Average Accuracy (CNN): 92.85 

Accuracy Matrix (CNN):
[[97.65 94.75 93.   92.   90.75]
 [ 0.   94.35 92.55 91.9  91.8 ]
 [ 0.    0.   92.3  86.35 84.9 ]
 [ 0.    0.    0.   90.15 89.2 ]
 [ 0.    0.    0.    0.   90.  ]]
2024-09-03 18:46:20,082 [trainer.py] => Forgetting (CNN): 4.449999999999999
2024-09-03 18:46:23,030 [trainer.py] => config: ./exps/coda_prompt_cifar_B0_Inc10.json
2024-09-03 18:46:23,030 [trainer.py] => prefix:  
2024-09-03 18:46:23,030 [trainer.py] => dataset: cifar224
2024-09-03 18:46:23,030 [trainer.py] => memory_size: 0
2024-09-03 18:46:23,030 [trainer.py] => memory_per_class: 0
2024-09-03 18:46:23,030 [trainer.py] => fixed_memory: False
2024-09-03 18:46:23,030 [trainer.py] => shuffle: True
2024-09-03 18:46:23,030 [trainer.py] => init_cls: 10
2024-09-03 18:46:23,030 [trainer.py] => increment: 10
2024-09-03 18:46:23,030 [trainer.py] => model_name: coda_prompt
2024-09-03 18:46:23,030 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-03 18:46:23,030 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-03 18:46:23,030 [trainer.py] => seed: 1993
2024-09-03 18:46:23,030 [trainer.py] => tuned_epoch: 20
2024-09-03 18:46:23,030 [trainer.py] => init_lr: 0.001
2024-09-03 18:46:23,030 [trainer.py] => batch_size: 48
2024-09-03 18:46:23,030 [trainer.py] => weight_decay: 0
2024-09-03 18:46:23,030 [trainer.py] => min_lr: 1e-05
2024-09-03 18:46:23,030 [trainer.py] => optimizer: adam
2024-09-03 18:46:23,030 [trainer.py] => scheduler: cosine
2024-09-03 18:46:23,030 [trainer.py] => reinit_optimizer: True
2024-09-03 18:46:23,030 [trainer.py] => pretrained: True
2024-09-03 18:46:23,030 [trainer.py] => drop: 0.0
2024-09-03 18:46:23,030 [trainer.py] => drop_path: 0.0
2024-09-03 18:46:23,030 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-03 18:46:24,131 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-03 18:46:26,451 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-03 18:46:26,451 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-03 18:46:26,452 [trainer.py] => All params: 89715556
2024-09-03 18:46:26,452 [trainer.py] => Trainable params: 89715556
2024-09-03 18:46:26,452 [coda_prompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.602, Train_accy 81.73:   0%|          | 0/20 [00:54<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.602, Train_accy 81.73:   5%|▌         | 1/20 [00:54<17:14, 54.44s/it]
Task 0, Epoch 2/20 => Loss 0.250, Train_accy 92.09:   5%|▌         | 1/20 [01:48<17:14, 54.44s/it]
Task 0, Epoch 2/20 => Loss 0.250, Train_accy 92.09:  10%|█         | 2/20 [01:48<16:14, 54.16s/it]
Task 0, Epoch 3/20 => Loss 0.220, Train_accy 92.95:  10%|█         | 2/20 [02:42<16:14, 54.16s/it]
Task 0, Epoch 3/20 => Loss 0.220, Train_accy 92.95:  15%|█▌        | 3/20 [02:42<15:22, 54.26s/it]
Task 0, Epoch 4/20 => Loss 0.193, Train_accy 93.85:  15%|█▌        | 3/20 [03:36<15:22, 54.26s/it]
Task 0, Epoch 4/20 => Loss 0.193, Train_accy 93.85:  20%|██        | 4/20 [03:36<14:26, 54.15s/it]
Task 0, Epoch 5/20 => Loss 0.184, Train_accy 93.83, Test_accy 98.20:  20%|██        | 4/20 [04:36<14:26, 54.15s/it]
Task 0, Epoch 5/20 => Loss 0.184, Train_accy 93.83, Test_accy 98.20:  25%|██▌       | 5/20 [04:36<14:04, 56.28s/it]
Task 0, Epoch 6/20 => Loss 0.176, Train_accy 94.29:  25%|██▌       | 5/20 [05:31<14:04, 56.28s/it]                 
Task 0, Epoch 6/20 => Loss 0.176, Train_accy 94.29:  30%|███       | 6/20 [05:31<12:58, 55.60s/it]
Task 0, Epoch 7/20 => Loss 0.176, Train_accy 94.55:  30%|███       | 6/20 [06:25<12:58, 55.60s/it]
Task 0, Epoch 7/20 => Loss 0.176, Train_accy 94.55:  35%|███▌      | 7/20 [06:25<11:56, 55.10s/it]
Task 0, Epoch 8/20 => Loss 0.156, Train_accy 94.67:  35%|███▌      | 7/20 [07:19<11:56, 55.10s/it]
Task 0, Epoch 8/20 => Loss 0.156, Train_accy 94.67:  40%|████      | 8/20 [07:19<10:57, 54.83s/it]
Task 0, Epoch 9/20 => Loss 0.147, Train_accy 95.17:  40%|████      | 8/20 [08:13<10:57, 54.83s/it]
Task 0, Epoch 9/20 => Loss 0.147, Train_accy 95.17:  45%|████▌     | 9/20 [08:13<10:01, 54.64s/it]
Task 0, Epoch 10/20 => Loss 0.158, Train_accy 94.85, Test_accy 98.50:  45%|████▌     | 9/20 [09:13<10:01, 54.64s/it]
Task 0, Epoch 10/20 => Loss 0.158, Train_accy 94.85, Test_accy 98.50:  50%|█████     | 10/20 [09:13<09:22, 56.24s/it]
Task 0, Epoch 11/20 => Loss 0.149, Train_accy 95.21:  50%|█████     | 10/20 [10:07<09:22, 56.24s/it]                 
Task 0, Epoch 11/20 => Loss 0.149, Train_accy 95.21:  55%|█████▌    | 11/20 [10:07<08:20, 55.63s/it]
Task 0, Epoch 12/20 => Loss 0.143, Train_accy 95.17:  55%|█████▌    | 11/20 [11:01<08:20, 55.63s/it]
Task 0, Epoch 12/20 => Loss 0.143, Train_accy 95.17:  60%|██████    | 12/20 [11:01<07:21, 55.17s/it]
Task 0, Epoch 13/20 => Loss 0.138, Train_accy 95.39:  60%|██████    | 12/20 [11:56<07:21, 55.17s/it]
Task 0, Epoch 13/20 => Loss 0.138, Train_accy 95.39:  65%|██████▌   | 13/20 [11:56<06:24, 54.87s/it]
Task 0, Epoch 14/20 => Loss 0.129, Train_accy 95.91:  65%|██████▌   | 13/20 [12:50<06:24, 54.87s/it]
Task 0, Epoch 14/20 => Loss 0.129, Train_accy 95.91:  70%|███████   | 14/20 [12:50<05:28, 54.69s/it]
Task 0, Epoch 15/20 => Loss 0.121, Train_accy 95.95, Test_accy 98.50:  70%|███████   | 14/20 [13:50<05:28, 54.69s/it]
Task 0, Epoch 15/20 => Loss 0.121, Train_accy 95.95, Test_accy 98.50:  75%|███████▌  | 15/20 [13:50<04:41, 56.31s/it]
Task 0, Epoch 16/20 => Loss 0.123, Train_accy 95.75:  75%|███████▌  | 15/20 [14:44<04:41, 56.31s/it]                 
Task 0, Epoch 16/20 => Loss 0.123, Train_accy 95.75:  80%|████████  | 16/20 [14:44<03:42, 55.65s/it]
Task 0, Epoch 17/20 => Loss 0.130, Train_accy 95.69:  80%|████████  | 16/20 [15:38<03:42, 55.65s/it]
Task 0, Epoch 17/20 => Loss 0.130, Train_accy 95.69:  85%|████████▌ | 17/20 [15:38<02:45, 55.26s/it]
Task 0, Epoch 18/20 => Loss 0.137, Train_accy 95.59:  85%|████████▌ | 17/20 [16:32<02:45, 55.26s/it]
Task 0, Epoch 18/20 => Loss 0.137, Train_accy 95.59:  90%|█████████ | 18/20 [16:32<01:49, 54.91s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 95.95:  90%|█████████ | 18/20 [17:27<01:49, 54.91s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 95.95:  95%|█████████▌| 19/20 [17:27<00:54, 54.72s/it]
Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60:  95%|█████████▌| 19/20 [18:27<00:54, 54.72s/it]
Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60: 100%|██████████| 20/20 [18:27<00:00, 56.30s/it]
Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60: 100%|██████████| 20/20 [18:27<00:00, 55.36s/it]
2024-09-03 19:04:54,154 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60
2024-09-03 19:04:59,990 [trainer.py] => No NME accuracy.
2024-09-03 19:04:59,990 [trainer.py] => CNN: {'total': 98.6, '00-09': 98.6, 'old': 0, 'new': 98.6}
2024-09-03 19:04:59,990 [trainer.py] => CNN top1 curve: [98.6]
2024-09-03 19:04:59,990 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.6
2024-09-03 19:04:59,991 [trainer.py] => Average Accuracy (CNN): 98.6 

2024-09-03 19:04:59,992 [trainer.py] => All params: 89715556
2024-09-03 19:04:59,993 [trainer.py] => Trainable params: 89715556
2024-09-03 19:05:00,298 [coda_prompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.524, Train_accy 83.07:   0%|          | 0/20 [00:54<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.524, Train_accy 83.07:   5%|▌         | 1/20 [00:54<17:09, 54.16s/it]
Task 1, Epoch 2/20 => Loss 0.279, Train_accy 90.46:   5%|▌         | 1/20 [01:48<17:09, 54.16s/it]
Task 1, Epoch 2/20 => Loss 0.279, Train_accy 90.46:  10%|█         | 2/20 [01:48<16:13, 54.11s/it]
Task 1, Epoch 3/20 => Loss 0.250, Train_accy 91.51:  10%|█         | 2/20 [02:42<16:13, 54.11s/it]
Task 1, Epoch 3/20 => Loss 0.250, Train_accy 91.51:  15%|█▌        | 3/20 [02:42<15:19, 54.08s/it]
Task 1, Epoch 4/20 => Loss 0.220, Train_accy 92.43:  15%|█▌        | 3/20 [03:36<15:19, 54.08s/it]
Task 1, Epoch 4/20 => Loss 0.220, Train_accy 92.43:  20%|██        | 4/20 [03:36<14:25, 54.09s/it]
Task 1, Epoch 5/20 => Loss 0.211, Train_accy 92.75, Test_accy 96.05:  20%|██        | 4/20 [04:41<14:25, 54.09s/it]
Task 1, Epoch 5/20 => Loss 0.211, Train_accy 92.75, Test_accy 96.05:  25%|██▌       | 5/20 [04:41<14:33, 58.24s/it]
Task 1, Epoch 6/20 => Loss 0.217, Train_accy 92.85:  25%|██▌       | 5/20 [05:36<14:33, 58.24s/it]                 
Task 1, Epoch 6/20 => Loss 0.217, Train_accy 92.85:  30%|███       | 6/20 [05:36<13:15, 56.82s/it]
Task 1, Epoch 7/20 => Loss 0.213, Train_accy 93.21:  30%|███       | 6/20 [06:30<13:15, 56.82s/it]
Task 1, Epoch 7/20 => Loss 0.213, Train_accy 93.21:  35%|███▌      | 7/20 [06:30<12:07, 55.94s/it]
Task 1, Epoch 8/20 => Loss 0.180, Train_accy 94.11:  35%|███▌      | 7/20 [07:24<12:07, 55.94s/it]
Task 1, Epoch 8/20 => Loss 0.180, Train_accy 94.11:  40%|████      | 8/20 [07:24<11:05, 55.44s/it]
Task 1, Epoch 9/20 => Loss 0.201, Train_accy 93.53:  40%|████      | 8/20 [08:18<11:05, 55.44s/it]
Task 1, Epoch 9/20 => Loss 0.201, Train_accy 93.53:  45%|████▌     | 9/20 [08:18<10:05, 55.01s/it]
Task 1, Epoch 10/20 => Loss 0.171, Train_accy 94.43, Test_accy 96.65:  45%|████▌     | 9/20 [09:24<10:05, 55.01s/it]
Task 1, Epoch 10/20 => Loss 0.171, Train_accy 94.43, Test_accy 96.65:  50%|█████     | 10/20 [09:24<09:42, 58.30s/it]
Task 1, Epoch 11/20 => Loss 0.182, Train_accy 93.81:  50%|█████     | 10/20 [10:18<09:42, 58.30s/it]                 
Task 1, Epoch 11/20 => Loss 0.182, Train_accy 93.81:  55%|█████▌    | 11/20 [10:18<08:33, 57.09s/it]
Task 1, Epoch 12/20 => Loss 0.172, Train_accy 93.91:  55%|█████▌    | 11/20 [11:12<08:33, 57.09s/it]
Task 1, Epoch 12/20 => Loss 0.172, Train_accy 93.91:  60%|██████    | 12/20 [11:12<07:29, 56.17s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 93.77:  60%|██████    | 12/20 [12:06<07:29, 56.17s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 93.77:  65%|██████▌   | 13/20 [12:06<06:29, 55.59s/it]
Task 1, Epoch 14/20 => Loss 0.173, Train_accy 94.07:  65%|██████▌   | 13/20 [13:01<06:29, 55.59s/it]
Task 1, Epoch 14/20 => Loss 0.173, Train_accy 94.07:  70%|███████   | 14/20 [13:01<05:30, 55.16s/it]
Task 1, Epoch 15/20 => Loss 0.174, Train_accy 93.81, Test_accy 96.20:  70%|███████   | 14/20 [14:06<05:30, 55.16s/it]
Task 1, Epoch 15/20 => Loss 0.174, Train_accy 93.81, Test_accy 96.20:  75%|███████▌  | 15/20 [14:06<04:51, 58.31s/it]
Task 1, Epoch 16/20 => Loss 0.181, Train_accy 94.01:  75%|███████▌  | 15/20 [15:01<04:51, 58.31s/it]                 
Task 1, Epoch 16/20 => Loss 0.181, Train_accy 94.01:  80%|████████  | 16/20 [15:01<03:48, 57.17s/it]
Task 1, Epoch 17/20 => Loss 0.175, Train_accy 93.87:  80%|████████  | 16/20 [15:55<03:48, 57.17s/it]
Task 1, Epoch 17/20 => Loss 0.175, Train_accy 93.87:  85%|████████▌ | 17/20 [15:55<02:48, 56.33s/it]
Task 1, Epoch 18/20 => Loss 0.168, Train_accy 94.29:  85%|████████▌ | 17/20 [16:49<02:48, 56.33s/it]
Task 1, Epoch 18/20 => Loss 0.168, Train_accy 94.29:  90%|█████████ | 18/20 [16:49<01:51, 55.61s/it]
Task 1, Epoch 19/20 => Loss 0.167, Train_accy 94.39:  90%|█████████ | 18/20 [17:43<01:51, 55.61s/it]
Task 1, Epoch 19/20 => Loss 0.167, Train_accy 94.39:  95%|█████████▌| 19/20 [17:43<00:55, 55.24s/it]
Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15:  95%|█████████▌| 19/20 [18:49<00:55, 55.24s/it]
Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15: 100%|██████████| 20/20 [18:49<00:00, 58.37s/it]
Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15: 100%|██████████| 20/20 [18:49<00:00, 56.48s/it]
2024-09-03 19:23:49,912 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15
2024-09-03 19:24:01,468 [trainer.py] => No NME accuracy.
2024-09-03 19:24:01,469 [trainer.py] => CNN: {'total': 96.15, '00-09': 97.6, '10-19': 94.7, 'old': 97.6, 'new': 94.7}
2024-09-03 19:24:01,469 [trainer.py] => CNN top1 curve: [98.6, 96.15]
2024-09-03 19:24:01,469 [trainer.py] => CNN top5 curve: [100.0, 99.7]

Average Accuracy (CNN): 97.38
2024-09-03 19:24:01,469 [trainer.py] => Average Accuracy (CNN): 97.38 

2024-09-03 19:24:01,470 [trainer.py] => All params: 89715556
2024-09-03 19:24:01,471 [trainer.py] => Trainable params: 89715556
2024-09-03 19:24:02,013 [coda_prompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.319, Train_accy 90.20:   0%|          | 0/20 [00:54<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.319, Train_accy 90.20:   5%|▌         | 1/20 [00:54<17:08, 54.11s/it]
Task 2, Epoch 2/20 => Loss 0.143, Train_accy 95.23:   5%|▌         | 1/20 [01:48<17:08, 54.11s/it]
Task 2, Epoch 2/20 => Loss 0.143, Train_accy 95.23:  10%|█         | 2/20 [01:48<16:14, 54.16s/it]
Task 2, Epoch 3/20 => Loss 0.121, Train_accy 95.97:  10%|█         | 2/20 [02:42<16:14, 54.16s/it]
Task 2, Epoch 3/20 => Loss 0.121, Train_accy 95.97:  15%|█▌        | 3/20 [02:42<15:21, 54.20s/it]
Task 2, Epoch 4/20 => Loss 0.118, Train_accy 96.13:  15%|█▌        | 3/20 [03:36<15:21, 54.20s/it]
Task 2, Epoch 4/20 => Loss 0.118, Train_accy 96.13:  20%|██        | 4/20 [03:36<14:25, 54.12s/it]
Task 2, Epoch 5/20 => Loss 0.093, Train_accy 97.00, Test_accy 93.90:  20%|██        | 4/20 [04:47<14:25, 54.12s/it]
Task 2, Epoch 5/20 => Loss 0.093, Train_accy 97.00, Test_accy 93.90:  25%|██▌       | 5/20 [04:47<15:04, 60.28s/it]
Task 2, Epoch 6/20 => Loss 0.107, Train_accy 96.53:  25%|██▌       | 5/20 [05:41<15:04, 60.28s/it]                 
Task 2, Epoch 6/20 => Loss 0.107, Train_accy 96.53:  30%|███       | 6/20 [05:41<13:34, 58.16s/it]
Task 2, Epoch 7/20 => Loss 0.101, Train_accy 96.83:  30%|███       | 6/20 [06:35<13:34, 58.16s/it]
Task 2, Epoch 7/20 => Loss 0.101, Train_accy 96.83:  35%|███▌      | 7/20 [06:35<12:18, 56.84s/it]
Task 2, Epoch 8/20 => Loss 0.108, Train_accy 96.47:  35%|███▌      | 7/20 [07:30<12:18, 56.84s/it]
Task 2, Epoch 8/20 => Loss 0.108, Train_accy 96.47:  40%|████      | 8/20 [07:30<11:12, 56.01s/it]
Task 2, Epoch 9/20 => Loss 0.102, Train_accy 96.55:  40%|████      | 8/20 [08:24<11:12, 56.01s/it]
Task 2, Epoch 9/20 => Loss 0.102, Train_accy 96.55:  45%|████▌     | 9/20 [08:24<10:09, 55.45s/it]
Task 2, Epoch 10/20 => Loss 0.098, Train_accy 96.71, Test_accy 95.10:  45%|████▌     | 9/20 [09:35<10:09, 55.45s/it]
Task 2, Epoch 10/20 => Loss 0.098, Train_accy 96.71, Test_accy 95.10:  50%|█████     | 10/20 [09:35<10:02, 60.25s/it]
Task 2, Epoch 11/20 => Loss 0.091, Train_accy 97.10:  50%|█████     | 10/20 [10:29<10:02, 60.25s/it]                 
Task 2, Epoch 11/20 => Loss 0.091, Train_accy 97.10:  55%|█████▌    | 11/20 [10:29<08:45, 58.44s/it]
Task 2, Epoch 12/20 => Loss 0.088, Train_accy 97.26:  55%|█████▌    | 11/20 [11:24<08:45, 58.44s/it]
Task 2, Epoch 12/20 => Loss 0.088, Train_accy 97.26:  60%|██████    | 12/20 [11:24<07:37, 57.21s/it]
Task 2, Epoch 13/20 => Loss 0.088, Train_accy 96.81:  60%|██████    | 12/20 [12:18<07:37, 57.21s/it]
Task 2, Epoch 13/20 => Loss 0.088, Train_accy 96.81:  65%|██████▌   | 13/20 [12:18<06:33, 56.24s/it]
Task 2, Epoch 14/20 => Loss 0.098, Train_accy 97.00:  65%|██████▌   | 13/20 [13:12<06:33, 56.24s/it]
Task 2, Epoch 14/20 => Loss 0.098, Train_accy 97.00:  70%|███████   | 14/20 [13:12<05:33, 55.67s/it]
Task 2, Epoch 15/20 => Loss 0.083, Train_accy 97.22, Test_accy 94.80:  70%|███████   | 14/20 [14:23<05:33, 55.67s/it]
Task 2, Epoch 15/20 => Loss 0.083, Train_accy 97.22, Test_accy 94.80:  75%|███████▌  | 15/20 [14:23<05:01, 60.38s/it]
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.08:  75%|███████▌  | 15/20 [15:17<05:01, 60.38s/it]                 
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.08:  80%|████████  | 16/20 [15:17<03:54, 58.52s/it]
Task 2, Epoch 17/20 => Loss 0.086, Train_accy 97.20:  80%|████████  | 16/20 [16:12<03:54, 58.52s/it]
Task 2, Epoch 17/20 => Loss 0.086, Train_accy 97.20:  85%|████████▌ | 17/20 [16:12<02:51, 57.29s/it]
Task 2, Epoch 18/20 => Loss 0.092, Train_accy 97.14:  85%|████████▌ | 17/20 [17:06<02:51, 57.29s/it]
Task 2, Epoch 18/20 => Loss 0.092, Train_accy 97.14:  90%|█████████ | 18/20 [17:06<01:52, 56.40s/it]
Task 2, Epoch 19/20 => Loss 0.103, Train_accy 96.59:  90%|█████████ | 18/20 [18:01<01:52, 56.40s/it]
Task 2, Epoch 19/20 => Loss 0.103, Train_accy 96.59:  95%|█████████▌| 19/20 [18:01<00:55, 55.77s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03:  95%|█████████▌| 19/20 [19:12<00:55, 55.77s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03: 100%|██████████| 20/20 [19:12<00:00, 60.45s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03: 100%|██████████| 20/20 [19:12<00:00, 57.62s/it]
2024-09-03 19:43:14,470 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03
2024-09-03 19:43:31,305 [trainer.py] => No NME accuracy.
2024-09-03 19:43:31,305 [trainer.py] => CNN: {'total': 95.03, '00-09': 96.4, '10-19': 93.3, '20-29': 95.4, 'old': 94.85, 'new': 95.4}
2024-09-03 19:43:31,305 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03]
2024-09-03 19:43:31,306 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6]

Average Accuracy (CNN): 96.59
2024-09-03 19:43:31,306 [trainer.py] => Average Accuracy (CNN): 96.59 

2024-09-03 19:43:31,307 [trainer.py] => All params: 89715556
2024-09-03 19:43:31,308 [trainer.py] => Trainable params: 89715556
2024-09-03 19:43:31,998 [coda_prompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.429, Train_accy 86.32:   0%|          | 0/20 [00:54<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.429, Train_accy 86.32:   5%|▌         | 1/20 [00:54<17:14, 54.44s/it]
Task 3, Epoch 2/20 => Loss 0.222, Train_accy 92.25:   5%|▌         | 1/20 [01:48<17:14, 54.44s/it]
Task 3, Epoch 2/20 => Loss 0.222, Train_accy 92.25:  10%|█         | 2/20 [01:48<16:18, 54.35s/it]
Task 3, Epoch 3/20 => Loss 0.191, Train_accy 93.37:  10%|█         | 2/20 [02:43<16:18, 54.35s/it]
Task 3, Epoch 3/20 => Loss 0.191, Train_accy 93.37:  15%|█▌        | 3/20 [02:43<15:23, 54.32s/it]
Task 3, Epoch 4/20 => Loss 0.167, Train_accy 94.09:  15%|█▌        | 3/20 [03:37<15:23, 54.32s/it]
Task 3, Epoch 4/20 => Loss 0.167, Train_accy 94.09:  20%|██        | 4/20 [03:37<14:28, 54.28s/it]
Task 3, Epoch 5/20 => Loss 0.185, Train_accy 93.73, Test_accy 91.85:  20%|██        | 4/20 [04:53<14:28, 54.28s/it]
Task 3, Epoch 5/20 => Loss 0.185, Train_accy 93.73, Test_accy 91.85:  25%|██▌       | 5/20 [04:53<15:35, 62.37s/it]
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 93.77:  25%|██▌       | 5/20 [05:47<15:35, 62.37s/it]                 
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 93.77:  30%|███       | 6/20 [05:47<13:52, 59.49s/it]
Task 3, Epoch 7/20 => Loss 0.162, Train_accy 94.21:  30%|███       | 6/20 [06:42<13:52, 59.49s/it]
Task 3, Epoch 7/20 => Loss 0.162, Train_accy 94.21:  35%|███▌      | 7/20 [06:42<12:32, 57.85s/it]
Task 3, Epoch 8/20 => Loss 0.162, Train_accy 94.47:  35%|███▌      | 7/20 [07:36<12:32, 57.85s/it]
Task 3, Epoch 8/20 => Loss 0.162, Train_accy 94.47:  40%|████      | 8/20 [07:36<11:20, 56.69s/it]
Task 3, Epoch 9/20 => Loss 0.146, Train_accy 95.35:  40%|████      | 8/20 [08:31<11:20, 56.69s/it]
Task 3, Epoch 9/20 => Loss 0.146, Train_accy 95.35:  45%|████▌     | 9/20 [08:31<10:16, 56.06s/it]
Task 3, Epoch 10/20 => Loss 0.137, Train_accy 95.49, Test_accy 93.00:  45%|████▌     | 9/20 [09:47<10:16, 56.06s/it]
Task 3, Epoch 10/20 => Loss 0.137, Train_accy 95.49, Test_accy 93.00:  50%|█████     | 10/20 [09:47<10:24, 62.42s/it]
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 94.99:  50%|█████     | 10/20 [10:42<10:24, 62.42s/it]                 
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 94.99:  55%|█████▌    | 11/20 [10:42<08:59, 59.94s/it]
Task 3, Epoch 12/20 => Loss 0.145, Train_accy 94.99:  55%|█████▌    | 11/20 [11:36<08:59, 59.94s/it]
Task 3, Epoch 12/20 => Loss 0.145, Train_accy 94.99:  60%|██████    | 12/20 [11:36<07:45, 58.21s/it]
Task 3, Epoch 13/20 => Loss 0.148, Train_accy 94.87:  60%|██████    | 12/20 [12:30<07:45, 58.21s/it]
Task 3, Epoch 13/20 => Loss 0.148, Train_accy 94.87:  65%|██████▌   | 13/20 [12:30<06:39, 57.08s/it]
Task 3, Epoch 14/20 => Loss 0.138, Train_accy 95.21:  65%|██████▌   | 13/20 [13:25<06:39, 57.08s/it]
Task 3, Epoch 14/20 => Loss 0.138, Train_accy 95.21:  70%|███████   | 14/20 [13:25<05:37, 56.23s/it]
Task 3, Epoch 15/20 => Loss 0.135, Train_accy 95.65, Test_accy 92.95:  70%|███████   | 14/20 [14:42<05:37, 56.23s/it]
Task 3, Epoch 15/20 => Loss 0.135, Train_accy 95.65, Test_accy 92.95:  75%|███████▌  | 15/20 [14:42<05:12, 62.44s/it]
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 95.03:  75%|███████▌  | 15/20 [15:36<05:12, 62.44s/it]                 
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 95.03:  80%|████████  | 16/20 [15:36<04:00, 60.03s/it]
Task 3, Epoch 17/20 => Loss 0.130, Train_accy 95.55:  80%|████████  | 16/20 [16:30<04:00, 60.03s/it]
Task 3, Epoch 17/20 => Loss 0.130, Train_accy 95.55:  85%|████████▌ | 17/20 [16:30<02:54, 58.29s/it]
Task 3, Epoch 18/20 => Loss 0.130, Train_accy 95.51:  85%|████████▌ | 17/20 [17:24<02:54, 58.29s/it]
Task 3, Epoch 18/20 => Loss 0.130, Train_accy 95.51:  90%|█████████ | 18/20 [17:24<01:54, 57.07s/it]
Task 3, Epoch 19/20 => Loss 0.137, Train_accy 95.37:  90%|█████████ | 18/20 [18:19<01:54, 57.07s/it]
Task 3, Epoch 19/20 => Loss 0.137, Train_accy 95.37:  95%|█████████▌| 19/20 [18:19<00:56, 56.25s/it]
Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98:  95%|█████████▌| 19/20 [19:36<00:56, 56.25s/it]
Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98: 100%|██████████| 20/20 [19:36<00:00, 62.49s/it]
Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98: 100%|██████████| 20/20 [19:36<00:00, 58.81s/it]
2024-09-03 20:03:08,324 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98
2024-09-03 20:03:30,771 [trainer.py] => No NME accuracy.
2024-09-03 20:03:30,772 [trainer.py] => CNN: {'total': 92.98, '00-09': 96.2, '10-19': 92.0, '20-29': 93.2, '30-39': 90.5, 'old': 93.8, 'new': 90.5}
2024-09-03 20:03:30,772 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98]
2024-09-03 20:03:30,772 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3]

Average Accuracy (CNN): 95.69
2024-09-03 20:03:30,773 [trainer.py] => Average Accuracy (CNN): 95.69 

2024-09-03 20:03:30,774 [trainer.py] => All params: 89715556
2024-09-03 20:03:30,775 [trainer.py] => Trainable params: 89715556
2024-09-03 20:03:31,736 [coda_prompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.362, Train_accy 89.06:   0%|          | 0/20 [00:54<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.362, Train_accy 89.06:   5%|▌         | 1/20 [00:54<17:14, 54.45s/it]
Task 4, Epoch 2/20 => Loss 0.138, Train_accy 95.83:   5%|▌         | 1/20 [01:48<17:14, 54.45s/it]
Task 4, Epoch 2/20 => Loss 0.138, Train_accy 95.83:  10%|█         | 2/20 [01:48<16:20, 54.45s/it]
Task 4, Epoch 3/20 => Loss 0.134, Train_accy 95.73:  10%|█         | 2/20 [02:43<16:20, 54.45s/it]
Task 4, Epoch 3/20 => Loss 0.134, Train_accy 95.73:  15%|█▌        | 3/20 [02:43<15:26, 54.51s/it]
Task 4, Epoch 4/20 => Loss 0.140, Train_accy 95.53:  15%|█▌        | 3/20 [03:37<15:26, 54.51s/it]
Task 4, Epoch 4/20 => Loss 0.140, Train_accy 95.53:  20%|██        | 4/20 [03:37<14:31, 54.46s/it]
Task 4, Epoch 5/20 => Loss 0.118, Train_accy 96.17, Test_accy 90.44:  20%|██        | 4/20 [05:00<14:31, 54.46s/it]
Task 4, Epoch 5/20 => Loss 0.118, Train_accy 96.17, Test_accy 90.44:  25%|██▌       | 5/20 [05:00<16:09, 64.62s/it]
Task 4, Epoch 6/20 => Loss 0.117, Train_accy 96.17:  25%|██▌       | 5/20 [05:54<16:09, 64.62s/it]                 
Task 4, Epoch 6/20 => Loss 0.117, Train_accy 96.17:  30%|███       | 6/20 [05:54<14:16, 61.18s/it]
Task 4, Epoch 7/20 => Loss 0.108, Train_accy 96.39:  30%|███       | 6/20 [06:49<14:16, 61.18s/it]
Task 4, Epoch 7/20 => Loss 0.108, Train_accy 96.39:  35%|███▌      | 7/20 [06:49<12:47, 59.06s/it]
Task 4, Epoch 8/20 => Loss 0.114, Train_accy 96.53:  35%|███▌      | 7/20 [07:43<12:47, 59.06s/it]
Task 4, Epoch 8/20 => Loss 0.114, Train_accy 96.53:  40%|████      | 8/20 [07:43<11:30, 57.52s/it]
Task 4, Epoch 9/20 => Loss 0.107, Train_accy 96.65:  40%|████      | 8/20 [08:38<11:30, 57.52s/it]
Task 4, Epoch 9/20 => Loss 0.107, Train_accy 96.65:  45%|████▌     | 9/20 [08:38<10:22, 56.59s/it]
Task 4, Epoch 10/20 => Loss 0.108, Train_accy 96.43, Test_accy 90.98:  45%|████▌     | 9/20 [10:01<10:22, 56.59s/it]
Task 4, Epoch 10/20 => Loss 0.108, Train_accy 96.43, Test_accy 90.98:  50%|█████     | 10/20 [10:01<10:46, 64.66s/it]
Task 4, Epoch 11/20 => Loss 0.108, Train_accy 96.35:  50%|█████     | 10/20 [10:55<10:46, 64.66s/it]                 
Task 4, Epoch 11/20 => Loss 0.108, Train_accy 96.35:  55%|█████▌    | 11/20 [10:55<09:13, 61.49s/it]
Task 4, Epoch 12/20 => Loss 0.098, Train_accy 96.81:  55%|█████▌    | 11/20 [11:49<09:13, 61.49s/it]
Task 4, Epoch 12/20 => Loss 0.098, Train_accy 96.81:  60%|██████    | 12/20 [11:49<07:54, 59.30s/it]
Task 4, Epoch 13/20 => Loss 0.097, Train_accy 97.02:  60%|██████    | 12/20 [12:44<07:54, 59.30s/it]
Task 4, Epoch 13/20 => Loss 0.097, Train_accy 97.02:  65%|██████▌   | 13/20 [12:44<06:44, 57.79s/it]
Task 4, Epoch 14/20 => Loss 0.104, Train_accy 96.69:  65%|██████▌   | 13/20 [13:38<06:44, 57.79s/it]
Task 4, Epoch 14/20 => Loss 0.104, Train_accy 96.69:  70%|███████   | 14/20 [13:38<05:39, 56.65s/it]
Task 4, Epoch 15/20 => Loss 0.099, Train_accy 96.59, Test_accy 91.26:  70%|███████   | 14/20 [15:00<05:39, 56.65s/it]
Task 4, Epoch 15/20 => Loss 0.099, Train_accy 96.59, Test_accy 91.26:  75%|███████▌  | 15/20 [15:00<05:21, 64.38s/it]
Task 4, Epoch 16/20 => Loss 0.107, Train_accy 96.49:  75%|███████▌  | 15/20 [15:54<05:21, 64.38s/it]                 
Task 4, Epoch 16/20 => Loss 0.107, Train_accy 96.49:  80%|████████  | 16/20 [15:54<04:05, 61.41s/it]
Task 4, Epoch 17/20 => Loss 0.103, Train_accy 96.73:  80%|████████  | 16/20 [16:49<04:05, 61.41s/it]
Task 4, Epoch 17/20 => Loss 0.103, Train_accy 96.73:  85%|████████▌ | 17/20 [16:49<02:57, 59.25s/it]
Task 4, Epoch 18/20 => Loss 0.083, Train_accy 97.28:  85%|████████▌ | 17/20 [17:43<02:57, 59.25s/it]
Task 4, Epoch 18/20 => Loss 0.083, Train_accy 97.28:  90%|█████████ | 18/20 [17:43<01:55, 57.72s/it]
Task 4, Epoch 19/20 => Loss 0.083, Train_accy 97.28:  90%|█████████ | 18/20 [18:37<01:55, 57.72s/it]
Task 4, Epoch 19/20 => Loss 0.083, Train_accy 97.28:  95%|█████████▌| 19/20 [18:37<00:56, 56.74s/it]
Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32:  95%|█████████▌| 19/20 [20:00<00:56, 56.74s/it]
Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32: 100%|██████████| 20/20 [20:00<00:00, 64.48s/it]
Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32: 100%|██████████| 20/20 [20:00<00:00, 60.01s/it]
2024-09-03 20:23:32,051 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32
2024-09-03 20:24:00,058 [trainer.py] => No NME accuracy.
2024-09-03 20:24:00,059 [trainer.py] => CNN: {'total': 91.32, '00-09': 95.8, '10-19': 90.1, '20-29': 92.3, '30-39': 89.0, '40-49': 89.4, 'old': 91.8, 'new': 89.4}
2024-09-03 20:24:00,059 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32]
2024-09-03 20:24:00,059 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24]

Average Accuracy (CNN): 94.82
2024-09-03 20:24:00,059 [trainer.py] => Average Accuracy (CNN): 94.82 

2024-09-03 20:24:00,061 [trainer.py] => All params: 89715556
2024-09-03 20:24:00,062 [trainer.py] => Trainable params: 89715556
2024-09-03 20:24:01,170 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.453, Train_accy 85.52:   0%|          | 0/20 [00:54<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.453, Train_accy 85.52:   5%|▌         | 1/20 [00:54<17:11, 54.30s/it]
Task 5, Epoch 2/20 => Loss 0.194, Train_accy 93.19:   5%|▌         | 1/20 [01:48<17:11, 54.30s/it]
Task 5, Epoch 2/20 => Loss 0.194, Train_accy 93.19:  10%|█         | 2/20 [01:48<16:15, 54.20s/it]
Task 5, Epoch 3/20 => Loss 0.173, Train_accy 93.87:  10%|█         | 2/20 [02:42<16:15, 54.20s/it]
Task 5, Epoch 3/20 => Loss 0.173, Train_accy 93.87:  15%|█▌        | 3/20 [02:42<15:23, 54.32s/it]
Task 5, Epoch 4/20 => Loss 0.168, Train_accy 94.41:  15%|█▌        | 3/20 [03:37<15:23, 54.32s/it]
Task 5, Epoch 4/20 => Loss 0.168, Train_accy 94.41:  20%|██        | 4/20 [03:37<14:31, 54.44s/it]
Task 5, Epoch 5/20 => Loss 0.161, Train_accy 94.29, Test_accy 90.03:  20%|██        | 4/20 [05:05<14:31, 54.44s/it]
Task 5, Epoch 5/20 => Loss 0.161, Train_accy 94.29, Test_accy 90.03:  25%|██▌       | 5/20 [05:05<16:37, 66.53s/it]
Task 5, Epoch 6/20 => Loss 0.159, Train_accy 94.63:  25%|██▌       | 5/20 [06:00<16:37, 66.53s/it]                 
Task 5, Epoch 6/20 => Loss 0.159, Train_accy 94.63:  30%|███       | 6/20 [06:00<14:35, 62.53s/it]
Task 5, Epoch 7/20 => Loss 0.126, Train_accy 95.63:  30%|███       | 6/20 [06:54<14:35, 62.53s/it]
Task 5, Epoch 7/20 => Loss 0.126, Train_accy 95.63:  35%|███▌      | 7/20 [06:54<12:58, 59.89s/it]
Task 5, Epoch 8/20 => Loss 0.148, Train_accy 95.25:  35%|███▌      | 7/20 [07:48<12:58, 59.89s/it]
Task 5, Epoch 8/20 => Loss 0.148, Train_accy 95.25:  40%|████      | 8/20 [07:48<11:36, 58.02s/it]
Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.21:  40%|████      | 8/20 [08:42<11:36, 58.02s/it]
Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.21:  45%|████▌     | 9/20 [08:42<10:23, 56.70s/it]
Task 5, Epoch 10/20 => Loss 0.137, Train_accy 95.35, Test_accy 90.12:  45%|████▌     | 9/20 [10:09<10:23, 56.70s/it]
Task 5, Epoch 10/20 => Loss 0.137, Train_accy 95.35, Test_accy 90.12:  50%|█████     | 10/20 [10:09<11:01, 66.20s/it]
Task 5, Epoch 11/20 => Loss 0.136, Train_accy 95.33:  50%|█████     | 10/20 [11:04<11:01, 66.20s/it]                 
Task 5, Epoch 11/20 => Loss 0.136, Train_accy 95.33:  55%|█████▌    | 11/20 [11:04<09:23, 62.58s/it]
Task 5, Epoch 12/20 => Loss 0.136, Train_accy 95.23:  55%|█████▌    | 11/20 [11:58<09:23, 62.58s/it]
Task 5, Epoch 12/20 => Loss 0.136, Train_accy 95.23:  60%|██████    | 12/20 [11:58<07:59, 60.00s/it]
Task 5, Epoch 13/20 => Loss 0.135, Train_accy 95.75:  60%|██████    | 12/20 [12:52<07:59, 60.00s/it]
Task 5, Epoch 13/20 => Loss 0.135, Train_accy 95.75:  65%|██████▌   | 13/20 [12:52<06:48, 58.33s/it]
Task 5, Epoch 14/20 => Loss 0.133, Train_accy 95.43:  65%|██████▌   | 13/20 [13:47<06:48, 58.33s/it]
Task 5, Epoch 14/20 => Loss 0.133, Train_accy 95.43:  70%|███████   | 14/20 [13:47<05:42, 57.13s/it]
Task 5, Epoch 15/20 => Loss 0.141, Train_accy 94.89, Test_accy 90.30:  70%|███████   | 14/20 [15:15<05:42, 57.13s/it]
Task 5, Epoch 15/20 => Loss 0.141, Train_accy 94.89, Test_accy 90.30:  75%|███████▌  | 15/20 [15:15<05:31, 66.39s/it]
Task 5, Epoch 16/20 => Loss 0.132, Train_accy 95.47:  75%|███████▌  | 15/20 [16:09<05:31, 66.39s/it]                 
Task 5, Epoch 16/20 => Loss 0.132, Train_accy 95.47:  80%|████████  | 16/20 [16:09<04:10, 62.73s/it]
Task 5, Epoch 17/20 => Loss 0.124, Train_accy 95.69:  80%|████████  | 16/20 [17:03<04:10, 62.73s/it]
Task 5, Epoch 17/20 => Loss 0.124, Train_accy 95.69:  85%|████████▌ | 17/20 [17:03<03:00, 60.29s/it]
Task 5, Epoch 18/20 => Loss 0.117, Train_accy 96.01:  85%|████████▌ | 17/20 [17:58<03:00, 60.29s/it]
Task 5, Epoch 18/20 => Loss 0.117, Train_accy 96.01:  90%|█████████ | 18/20 [17:58<01:57, 58.53s/it]
Task 5, Epoch 19/20 => Loss 0.117, Train_accy 95.77:  90%|█████████ | 18/20 [18:52<01:57, 58.53s/it]
Task 5, Epoch 19/20 => Loss 0.117, Train_accy 95.77:  95%|█████████▌| 19/20 [18:52<00:57, 57.28s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22:  95%|█████████▌| 19/20 [20:20<00:57, 57.28s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22: 100%|██████████| 20/20 [20:20<00:00, 66.52s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22: 100%|██████████| 20/20 [20:20<00:00, 61.04s/it]
2024-09-03 20:44:22,064 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22
2024-09-03 20:44:55,853 [trainer.py] => No NME accuracy.
2024-09-03 20:44:55,854 [trainer.py] => CNN: {'total': 90.22, '00-09': 93.3, '10-19': 90.0, '20-29': 91.0, '30-39': 87.8, '40-49': 87.7, '50-59': 91.5, 'old': 89.96, 'new': 91.5}
2024-09-03 20:44:55,854 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22]
2024-09-03 20:44:55,854 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1]

Average Accuracy (CNN): 94.05
2024-09-03 20:44:55,854 [trainer.py] => Average Accuracy (CNN): 94.05 

2024-09-03 20:44:55,855 [trainer.py] => All params: 89715556
2024-09-03 20:44:55,857 [trainer.py] => Trainable params: 89715556
2024-09-03 20:44:57,251 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.321, Train_accy 89.80:   0%|          | 0/20 [00:54<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.321, Train_accy 89.80:   5%|▌         | 1/20 [00:54<17:11, 54.31s/it]
Task 6, Epoch 2/20 => Loss 0.132, Train_accy 95.59:   5%|▌         | 1/20 [01:48<17:11, 54.31s/it]
Task 6, Epoch 2/20 => Loss 0.132, Train_accy 95.59:  10%|█         | 2/20 [01:48<16:19, 54.42s/it]
Task 6, Epoch 3/20 => Loss 0.125, Train_accy 95.75:  10%|█         | 2/20 [02:43<16:19, 54.42s/it]
Task 6, Epoch 3/20 => Loss 0.125, Train_accy 95.75:  15%|█▌        | 3/20 [02:43<15:24, 54.38s/it]
Task 6, Epoch 4/20 => Loss 0.129, Train_accy 95.91:  15%|█▌        | 3/20 [03:37<15:24, 54.38s/it]
Task 6, Epoch 4/20 => Loss 0.129, Train_accy 95.91:  20%|██        | 4/20 [03:37<14:30, 54.39s/it]
Task 6, Epoch 5/20 => Loss 0.111, Train_accy 96.21, Test_accy 89.26:  20%|██        | 4/20 [05:10<14:30, 54.39s/it]
Task 6, Epoch 5/20 => Loss 0.111, Train_accy 96.21, Test_accy 89.26:  25%|██▌       | 5/20 [05:10<17:05, 68.39s/it]
Task 6, Epoch 6/20 => Loss 0.102, Train_accy 96.59:  25%|██▌       | 5/20 [06:05<17:05, 68.39s/it]                 
Task 6, Epoch 6/20 => Loss 0.102, Train_accy 96.59:  30%|███       | 6/20 [06:05<14:51, 63.65s/it]
Task 6, Epoch 7/20 => Loss 0.103, Train_accy 96.51:  30%|███       | 6/20 [06:59<14:51, 63.65s/it]
Task 6, Epoch 7/20 => Loss 0.103, Train_accy 96.51:  35%|███▌      | 7/20 [06:59<13:06, 60.52s/it]
Task 6, Epoch 8/20 => Loss 0.098, Train_accy 96.85:  35%|███▌      | 7/20 [07:53<13:06, 60.52s/it]
Task 6, Epoch 8/20 => Loss 0.098, Train_accy 96.85:  40%|████      | 8/20 [07:53<11:42, 58.58s/it]
Task 6, Epoch 9/20 => Loss 0.109, Train_accy 96.31:  40%|████      | 8/20 [08:48<11:42, 58.58s/it]
Task 6, Epoch 9/20 => Loss 0.109, Train_accy 96.31:  45%|████▌     | 9/20 [08:48<10:30, 57.28s/it]
Task 6, Epoch 10/20 => Loss 0.108, Train_accy 96.23, Test_accy 89.56:  45%|████▌     | 9/20 [10:21<10:30, 57.28s/it]
Task 6, Epoch 10/20 => Loss 0.108, Train_accy 96.23, Test_accy 89.56:  50%|█████     | 10/20 [10:21<11:24, 68.47s/it]
Task 6, Epoch 11/20 => Loss 0.097, Train_accy 96.77:  50%|█████     | 10/20 [11:15<11:24, 68.47s/it]                 
Task 6, Epoch 11/20 => Loss 0.097, Train_accy 96.77:  55%|█████▌    | 11/20 [11:15<09:36, 64.10s/it]
Task 6, Epoch 12/20 => Loss 0.088, Train_accy 97.30:  55%|█████▌    | 11/20 [12:10<09:36, 64.10s/it]
Task 6, Epoch 12/20 => Loss 0.088, Train_accy 97.30:  60%|██████    | 12/20 [12:10<08:09, 61.19s/it]
Task 6, Epoch 13/20 => Loss 0.095, Train_accy 96.73:  60%|██████    | 12/20 [13:04<08:09, 61.19s/it]
Task 6, Epoch 13/20 => Loss 0.095, Train_accy 96.73:  65%|██████▌   | 13/20 [13:04<06:53, 59.13s/it]
Task 6, Epoch 14/20 => Loss 0.095, Train_accy 96.77:  65%|██████▌   | 13/20 [13:59<06:53, 59.13s/it]
Task 6, Epoch 14/20 => Loss 0.095, Train_accy 96.77:  70%|███████   | 14/20 [13:59<05:46, 57.68s/it]
Task 6, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 89.36:  70%|███████   | 14/20 [15:32<05:46, 57.68s/it]
Task 6, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 89.36:  75%|███████▌  | 15/20 [15:32<05:42, 68.47s/it]
Task 6, Epoch 16/20 => Loss 0.094, Train_accy 97.00:  75%|███████▌  | 15/20 [16:27<05:42, 68.47s/it]                 
Task 6, Epoch 16/20 => Loss 0.094, Train_accy 97.00:  80%|████████  | 16/20 [16:27<04:17, 64.36s/it]
Task 6, Epoch 17/20 => Loss 0.085, Train_accy 97.16:  80%|████████  | 16/20 [17:21<04:17, 64.36s/it]
Task 6, Epoch 17/20 => Loss 0.085, Train_accy 97.16:  85%|████████▌ | 17/20 [17:21<03:04, 61.40s/it]
Task 6, Epoch 18/20 => Loss 0.099, Train_accy 96.98:  85%|████████▌ | 17/20 [18:16<03:04, 61.40s/it]
Task 6, Epoch 18/20 => Loss 0.099, Train_accy 96.98:  90%|█████████ | 18/20 [18:16<01:58, 59.30s/it]
Task 6, Epoch 19/20 => Loss 0.090, Train_accy 96.94:  90%|█████████ | 18/20 [19:10<01:58, 59.30s/it]
Task 6, Epoch 19/20 => Loss 0.090, Train_accy 96.94:  95%|█████████▌| 19/20 [19:10<00:57, 57.85s/it]
Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47:  95%|█████████▌| 19/20 [20:44<00:57, 57.85s/it]
Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47: 100%|██████████| 20/20 [20:44<00:00, 68.56s/it]
Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47: 100%|██████████| 20/20 [20:44<00:00, 62.22s/it]
2024-09-03 21:05:41,606 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47
2024-09-03 21:06:20,596 [trainer.py] => No NME accuracy.
2024-09-03 21:06:20,597 [trainer.py] => CNN: {'total': 89.47, '00-09': 92.9, '10-19': 87.4, '20-29': 89.8, '30-39': 87.7, '40-49': 87.0, '50-59': 87.7, '60-69': 93.8, 'old': 88.75, 'new': 93.8}
2024-09-03 21:06:20,597 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47]
2024-09-03 21:06:20,597 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97]

Average Accuracy (CNN): 93.4
2024-09-03 21:06:20,597 [trainer.py] => Average Accuracy (CNN): 93.4 

2024-09-03 21:06:20,598 [trainer.py] => All params: 89715556
2024-09-03 21:06:20,599 [trainer.py] => Trainable params: 89715556
2024-09-03 21:06:22,091 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.421, Train_accy 86.88:   0%|          | 0/20 [00:54<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.421, Train_accy 86.88:   5%|▌         | 1/20 [00:54<17:18, 54.66s/it]
Task 7, Epoch 2/20 => Loss 0.194, Train_accy 93.33:   5%|▌         | 1/20 [01:49<17:18, 54.66s/it]
Task 7, Epoch 2/20 => Loss 0.194, Train_accy 93.33:  10%|█         | 2/20 [01:49<16:22, 54.59s/it]
Task 7, Epoch 3/20 => Loss 0.192, Train_accy 93.47:  10%|█         | 2/20 [02:43<16:22, 54.59s/it]
Task 7, Epoch 3/20 => Loss 0.192, Train_accy 93.47:  15%|█▌        | 3/20 [02:43<15:26, 54.48s/it]
Task 7, Epoch 4/20 => Loss 0.176, Train_accy 93.97:  15%|█▌        | 3/20 [03:38<15:26, 54.48s/it]
Task 7, Epoch 4/20 => Loss 0.176, Train_accy 93.97:  20%|██        | 4/20 [03:38<14:32, 54.56s/it]
Task 7, Epoch 5/20 => Loss 0.149, Train_accy 94.89, Test_accy 87.04:  20%|██        | 4/20 [05:17<14:32, 54.56s/it]
Task 7, Epoch 5/20 => Loss 0.149, Train_accy 94.89, Test_accy 87.04:  25%|██▌       | 5/20 [05:17<17:39, 70.65s/it]
Task 7, Epoch 6/20 => Loss 0.143, Train_accy 95.17:  25%|██▌       | 5/20 [06:11<17:39, 70.65s/it]                 
Task 7, Epoch 6/20 => Loss 0.143, Train_accy 95.17:  30%|███       | 6/20 [06:11<15:12, 65.18s/it]
Task 7, Epoch 7/20 => Loss 0.139, Train_accy 95.23:  30%|███       | 6/20 [07:06<15:12, 65.18s/it]
Task 7, Epoch 7/20 => Loss 0.139, Train_accy 95.23:  35%|███▌      | 7/20 [07:06<13:21, 61.66s/it]
Task 7, Epoch 8/20 => Loss 0.148, Train_accy 94.97:  35%|███▌      | 7/20 [08:00<13:21, 61.66s/it]
Task 7, Epoch 8/20 => Loss 0.148, Train_accy 94.97:  40%|████      | 8/20 [08:00<11:52, 59.39s/it]
Task 7, Epoch 9/20 => Loss 0.135, Train_accy 95.41:  40%|████      | 8/20 [08:55<11:52, 59.39s/it]
Task 7, Epoch 9/20 => Loss 0.135, Train_accy 95.41:  45%|████▌     | 9/20 [08:55<10:35, 57.75s/it]
Task 7, Epoch 10/20 => Loss 0.124, Train_accy 95.65, Test_accy 87.82:  45%|████▌     | 9/20 [10:34<10:35, 57.75s/it]
Task 7, Epoch 10/20 => Loss 0.124, Train_accy 95.65, Test_accy 87.82:  50%|█████     | 10/20 [10:34<11:46, 70.62s/it]
Task 7, Epoch 11/20 => Loss 0.127, Train_accy 95.69:  50%|█████     | 10/20 [11:29<11:46, 70.62s/it]                 
Task 7, Epoch 11/20 => Loss 0.127, Train_accy 95.69:  55%|█████▌    | 11/20 [11:29<09:51, 65.72s/it]
Task 7, Epoch 12/20 => Loss 0.127, Train_accy 95.79:  55%|█████▌    | 11/20 [12:23<09:51, 65.72s/it]
Task 7, Epoch 12/20 => Loss 0.127, Train_accy 95.79:  60%|██████    | 12/20 [12:23<08:18, 62.32s/it]
Task 7, Epoch 13/20 => Loss 0.115, Train_accy 96.23:  60%|██████    | 12/20 [13:18<08:18, 62.32s/it]
Task 7, Epoch 13/20 => Loss 0.115, Train_accy 96.23:  65%|██████▌   | 13/20 [13:18<06:59, 59.93s/it]
Task 7, Epoch 14/20 => Loss 0.125, Train_accy 95.73:  65%|██████▌   | 13/20 [14:12<06:59, 59.93s/it]
Task 7, Epoch 14/20 => Loss 0.125, Train_accy 95.73:  70%|███████   | 14/20 [14:12<05:50, 58.34s/it]
Task 7, Epoch 15/20 => Loss 0.108, Train_accy 96.03, Test_accy 87.91:  70%|███████   | 14/20 [15:51<05:50, 58.34s/it]
Task 7, Epoch 15/20 => Loss 0.108, Train_accy 96.03, Test_accy 87.91:  75%|███████▌  | 15/20 [15:51<05:53, 70.61s/it]
Task 7, Epoch 16/20 => Loss 0.119, Train_accy 95.91:  75%|███████▌  | 15/20 [16:46<05:53, 70.61s/it]                 
Task 7, Epoch 16/20 => Loss 0.119, Train_accy 95.91:  80%|████████  | 16/20 [16:46<04:23, 65.83s/it]
Task 7, Epoch 17/20 => Loss 0.119, Train_accy 95.91:  80%|████████  | 16/20 [17:40<04:23, 65.83s/it]
Task 7, Epoch 17/20 => Loss 0.119, Train_accy 95.91:  85%|████████▌ | 17/20 [17:40<03:07, 62.41s/it]
Task 7, Epoch 18/20 => Loss 0.120, Train_accy 95.75:  85%|████████▌ | 17/20 [18:35<03:07, 62.41s/it]
Task 7, Epoch 18/20 => Loss 0.120, Train_accy 95.75:  90%|█████████ | 18/20 [18:35<02:00, 60.11s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.11:  90%|█████████ | 18/20 [19:30<02:00, 60.11s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.11:  95%|█████████▌| 19/20 [19:30<00:58, 58.46s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04:  95%|█████████▌| 19/20 [21:09<00:58, 58.46s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04: 100%|██████████| 20/20 [21:09<00:00, 70.75s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04: 100%|██████████| 20/20 [21:09<00:00, 63.49s/it]
2024-09-03 21:27:31,873 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04
2024-09-03 21:28:16,639 [trainer.py] => No NME accuracy.
2024-09-03 21:28:16,639 [trainer.py] => CNN: {'total': 88.04, '00-09': 92.5, '10-19': 87.1, '20-29': 90.5, '30-39': 88.7, '40-49': 84.9, '50-59': 86.6, '60-69': 93.2, '70-79': 80.8, 'old': 89.07, 'new': 80.8}
2024-09-03 21:28:16,639 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47, 88.04]
2024-09-03 21:28:16,640 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97, 98.95]

Average Accuracy (CNN): 92.73
2024-09-03 21:28:16,640 [trainer.py] => Average Accuracy (CNN): 92.73 

2024-09-03 21:28:16,641 [trainer.py] => All params: 89715556
2024-09-03 21:28:16,642 [trainer.py] => Trainable params: 89715556
2024-09-03 21:28:18,343 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.426, Train_accy 86.70:   0%|          | 0/20 [00:54<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.426, Train_accy 86.70:   5%|▌         | 1/20 [00:54<17:22, 54.88s/it]
Task 8, Epoch 2/20 => Loss 0.187, Train_accy 94.05:   5%|▌         | 1/20 [01:49<17:22, 54.88s/it]
Task 8, Epoch 2/20 => Loss 0.187, Train_accy 94.05:  10%|█         | 2/20 [01:49<16:24, 54.70s/it]
Task 8, Epoch 3/20 => Loss 0.163, Train_accy 94.55:  10%|█         | 2/20 [02:43<16:24, 54.70s/it]
Task 8, Epoch 3/20 => Loss 0.163, Train_accy 94.55:  15%|█▌        | 3/20 [02:43<15:27, 54.55s/it]
Task 8, Epoch 4/20 => Loss 0.146, Train_accy 95.09:  15%|█▌        | 3/20 [03:38<15:27, 54.55s/it]
Task 8, Epoch 4/20 => Loss 0.146, Train_accy 95.09:  20%|██        | 4/20 [03:38<14:34, 54.67s/it]
Task 8, Epoch 5/20 => Loss 0.137, Train_accy 95.41, Test_accy 85.73:  20%|██        | 4/20 [05:23<14:34, 54.67s/it]
Task 8, Epoch 5/20 => Loss 0.137, Train_accy 95.41, Test_accy 85.73:  25%|██▌       | 5/20 [05:23<18:11, 72.76s/it]
Task 8, Epoch 6/20 => Loss 0.135, Train_accy 95.27:  25%|██▌       | 5/20 [06:18<18:11, 72.76s/it]                 
Task 8, Epoch 6/20 => Loss 0.135, Train_accy 95.27:  30%|███       | 6/20 [06:18<15:32, 66.57s/it]
Task 8, Epoch 7/20 => Loss 0.122, Train_accy 95.93:  30%|███       | 6/20 [07:12<15:32, 66.57s/it]
Task 8, Epoch 7/20 => Loss 0.122, Train_accy 95.93:  35%|███▌      | 7/20 [07:12<13:33, 62.60s/it]
Task 8, Epoch 8/20 => Loss 0.152, Train_accy 94.95:  35%|███▌      | 7/20 [08:07<13:33, 62.60s/it]
Task 8, Epoch 8/20 => Loss 0.152, Train_accy 94.95:  40%|████      | 8/20 [08:07<12:00, 60.07s/it]
Task 8, Epoch 9/20 => Loss 0.134, Train_accy 95.43:  40%|████      | 8/20 [09:01<12:00, 60.07s/it]
Task 8, Epoch 9/20 => Loss 0.134, Train_accy 95.43:  45%|████▌     | 9/20 [09:01<10:39, 58.15s/it]
Task 8, Epoch 10/20 => Loss 0.125, Train_accy 95.81, Test_accy 86.67:  45%|████▌     | 9/20 [10:46<10:39, 58.15s/it]
Task 8, Epoch 10/20 => Loss 0.125, Train_accy 95.81, Test_accy 86.67:  50%|█████     | 10/20 [10:46<12:05, 72.60s/it]
Task 8, Epoch 11/20 => Loss 0.115, Train_accy 96.27:  50%|█████     | 10/20 [11:40<12:05, 72.60s/it]                 
Task 8, Epoch 11/20 => Loss 0.115, Train_accy 96.27:  55%|█████▌    | 11/20 [11:40<10:03, 67.03s/it]
Task 8, Epoch 12/20 => Loss 0.136, Train_accy 95.37:  55%|█████▌    | 11/20 [12:35<10:03, 67.03s/it]
Task 8, Epoch 12/20 => Loss 0.136, Train_accy 95.37:  60%|██████    | 12/20 [12:35<08:26, 63.30s/it]
Task 8, Epoch 13/20 => Loss 0.120, Train_accy 95.93:  60%|██████    | 12/20 [13:29<08:26, 63.30s/it]
Task 8, Epoch 13/20 => Loss 0.120, Train_accy 95.93:  65%|██████▌   | 13/20 [13:29<07:04, 60.69s/it]
Task 8, Epoch 14/20 => Loss 0.124, Train_accy 95.55:  65%|██████▌   | 13/20 [14:24<07:04, 60.69s/it]
Task 8, Epoch 14/20 => Loss 0.124, Train_accy 95.55:  70%|███████   | 14/20 [14:24<05:53, 58.98s/it]
Task 8, Epoch 15/20 => Loss 0.116, Train_accy 96.13, Test_accy 86.66:  70%|███████   | 14/20 [16:10<05:53, 58.98s/it]
Task 8, Epoch 15/20 => Loss 0.116, Train_accy 96.13, Test_accy 86.66:  75%|███████▌  | 15/20 [16:10<06:05, 73.06s/it]
Task 8, Epoch 16/20 => Loss 0.112, Train_accy 96.39:  75%|███████▌  | 15/20 [17:05<06:05, 73.06s/it]                 
Task 8, Epoch 16/20 => Loss 0.112, Train_accy 96.39:  80%|████████  | 16/20 [17:05<04:30, 67.63s/it]
Task 8, Epoch 17/20 => Loss 0.106, Train_accy 96.71:  80%|████████  | 16/20 [18:00<04:30, 67.63s/it]
Task 8, Epoch 17/20 => Loss 0.106, Train_accy 96.71:  85%|████████▌ | 17/20 [18:00<03:11, 63.83s/it]
Task 8, Epoch 18/20 => Loss 0.108, Train_accy 96.39:  85%|████████▌ | 17/20 [18:55<03:11, 63.83s/it]
Task 8, Epoch 18/20 => Loss 0.108, Train_accy 96.39:  90%|█████████ | 18/20 [18:55<02:02, 61.16s/it]
Task 8, Epoch 19/20 => Loss 0.104, Train_accy 96.75:  90%|█████████ | 18/20 [19:50<02:02, 61.16s/it]
Task 8, Epoch 19/20 => Loss 0.104, Train_accy 96.75:  95%|█████████▌| 19/20 [19:50<00:59, 59.31s/it]
Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56:  95%|█████████▌| 19/20 [21:36<00:59, 59.31s/it]
Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56: 100%|██████████| 20/20 [21:36<00:00, 73.21s/it]
Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56: 100%|██████████| 20/20 [21:36<00:00, 64.81s/it]
2024-09-03 21:49:54,533 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56
2024-09-03 21:50:45,209 [trainer.py] => No NME accuracy.
2024-09-03 21:50:45,210 [trainer.py] => CNN: {'total': 86.56, '00-09': 92.6, '10-19': 85.9, '20-29': 90.0, '30-39': 87.6, '40-49': 84.9, '50-59': 85.6, '60-69': 92.3, '70-79': 79.8, '80-89': 80.3, 'old': 87.34, 'new': 80.3}
2024-09-03 21:50:45,210 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47, 88.04, 86.56]
2024-09-03 21:50:45,210 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97, 98.95, 98.67]

Average Accuracy (CNN): 92.04
2024-09-03 21:50:45,210 [trainer.py] => Average Accuracy (CNN): 92.04 

2024-09-03 21:50:45,211 [trainer.py] => All params: 89715556
2024-09-03 21:50:45,212 [trainer.py] => Trainable params: 89715556
2024-09-03 21:50:47,106 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.441, Train_accy 86.58:   0%|          | 0/20 [00:54<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.441, Train_accy 86.58:   5%|▌         | 1/20 [00:54<17:23, 54.94s/it]
Task 9, Epoch 2/20 => Loss 0.226, Train_accy 92.87:   5%|▌         | 1/20 [01:49<17:23, 54.94s/it]
Task 9, Epoch 2/20 => Loss 0.226, Train_accy 92.87:  10%|█         | 2/20 [01:49<16:29, 54.95s/it]
Task 9, Epoch 3/20 => Loss 0.196, Train_accy 93.31:  10%|█         | 2/20 [02:44<16:29, 54.95s/it]
Task 9, Epoch 3/20 => Loss 0.196, Train_accy 93.31:  15%|█▌        | 3/20 [02:44<15:34, 54.94s/it]
Task 9, Epoch 4/20 => Loss 0.165, Train_accy 94.41:  15%|█▌        | 3/20 [03:39<15:34, 54.94s/it]
Task 9, Epoch 4/20 => Loss 0.165, Train_accy 94.41:  20%|██        | 4/20 [03:39<14:39, 54.99s/it]
Task 9, Epoch 5/20 => Loss 0.174, Train_accy 94.41, Test_accy 86.13:  20%|██        | 4/20 [05:31<14:39, 54.99s/it]
Task 9, Epoch 5/20 => Loss 0.174, Train_accy 94.41, Test_accy 86.13:  25%|██▌       | 5/20 [05:31<18:48, 75.23s/it]
Task 9, Epoch 6/20 => Loss 0.158, Train_accy 94.59:  25%|██▌       | 5/20 [06:25<18:48, 75.23s/it]                 
Task 9, Epoch 6/20 => Loss 0.158, Train_accy 94.59:  30%|███       | 6/20 [06:25<15:56, 68.30s/it]
Task 9, Epoch 7/20 => Loss 0.167, Train_accy 94.19:  30%|███       | 6/20 [07:20<15:56, 68.30s/it]
Task 9, Epoch 7/20 => Loss 0.167, Train_accy 94.19:  35%|███▌      | 7/20 [07:20<13:50, 63.91s/it]
Task 9, Epoch 8/20 => Loss 0.150, Train_accy 95.07:  35%|███▌      | 7/20 [08:15<13:50, 63.91s/it]
Task 9, Epoch 8/20 => Loss 0.150, Train_accy 95.07:  40%|████      | 8/20 [08:15<12:12, 61.05s/it]
Task 9, Epoch 9/20 => Loss 0.137, Train_accy 95.25:  40%|████      | 8/20 [09:10<12:12, 61.05s/it]
Task 9, Epoch 9/20 => Loss 0.137, Train_accy 95.25:  45%|████▌     | 9/20 [09:10<10:50, 59.13s/it]
Task 9, Epoch 10/20 => Loss 0.134, Train_accy 95.45, Test_accy 86.32:  45%|████▌     | 9/20 [11:01<10:50, 59.13s/it]
Task 9, Epoch 10/20 => Loss 0.134, Train_accy 95.45, Test_accy 86.32:  50%|█████     | 10/20 [11:01<12:32, 75.26s/it]
Task 9, Epoch 11/20 => Loss 0.147, Train_accy 94.85:  50%|█████     | 10/20 [11:56<12:32, 75.26s/it]                 
Task 9, Epoch 11/20 => Loss 0.147, Train_accy 94.85:  55%|█████▌    | 11/20 [11:56<10:21, 69.04s/it]
Task 9, Epoch 12/20 => Loss 0.136, Train_accy 95.55:  55%|█████▌    | 11/20 [12:51<10:21, 69.04s/it]
Task 9, Epoch 12/20 => Loss 0.136, Train_accy 95.55:  60%|██████    | 12/20 [12:51<08:38, 64.79s/it]
Task 9, Epoch 13/20 => Loss 0.140, Train_accy 94.75:  60%|██████    | 12/20 [13:46<08:38, 64.79s/it]
Task 9, Epoch 13/20 => Loss 0.140, Train_accy 94.75:  65%|██████▌   | 13/20 [13:46<07:12, 61.81s/it]
Task 9, Epoch 14/20 => Loss 0.137, Train_accy 95.37:  65%|██████▌   | 13/20 [14:41<07:12, 61.81s/it]
Task 9, Epoch 14/20 => Loss 0.137, Train_accy 95.37:  70%|███████   | 14/20 [14:41<05:58, 59.74s/it]
Task 9, Epoch 15/20 => Loss 0.125, Train_accy 95.75, Test_accy 86.40:  70%|███████   | 14/20 [16:33<05:58, 59.74s/it]
Task 9, Epoch 15/20 => Loss 0.125, Train_accy 95.75, Test_accy 86.40:  75%|███████▌  | 15/20 [16:33<06:16, 75.28s/it]
Task 9, Epoch 16/20 => Loss 0.122, Train_accy 95.87:  75%|███████▌  | 15/20 [17:28<06:16, 75.28s/it]                 
Task 9, Epoch 16/20 => Loss 0.122, Train_accy 95.87:  80%|████████  | 16/20 [17:28<04:36, 69.17s/it]
Task 9, Epoch 17/20 => Loss 0.132, Train_accy 95.19:  80%|████████  | 16/20 [18:23<04:36, 69.17s/it]
Task 9, Epoch 17/20 => Loss 0.132, Train_accy 95.19:  85%|████████▌ | 17/20 [18:23<03:14, 64.92s/it]
Task 9, Epoch 18/20 => Loss 0.127, Train_accy 95.63:  85%|████████▌ | 17/20 [19:18<03:14, 64.92s/it]
Task 9, Epoch 18/20 => Loss 0.127, Train_accy 95.63:  90%|█████████ | 18/20 [19:18<02:03, 61.94s/it]
Task 9, Epoch 19/20 => Loss 0.130, Train_accy 95.65:  90%|█████████ | 18/20 [20:12<02:03, 61.94s/it]
Task 9, Epoch 19/20 => Loss 0.130, Train_accy 95.65:  95%|█████████▌| 19/20 [20:12<00:59, 59.78s/it]
Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50:  95%|█████████▌| 19/20 [22:04<00:59, 59.78s/it]
Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50: 100%|██████████| 20/20 [22:04<00:00, 75.21s/it]
Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50: 100%|██████████| 20/20 [22:04<00:00, 66.20s/it]
2024-09-03 22:12:51,219 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50
2024-09-03 22:13:47,661 [trainer.py] => No NME accuracy.
2024-09-03 22:13:47,662 [trainer.py] => CNN: {'total': 86.5, '00-09': 92.0, '10-19': 86.3, '20-29': 90.3, '30-39': 86.9, '40-49': 85.9, '50-59': 85.6, '60-69': 91.8, '70-79': 79.2, '80-89': 80.8, '90-99': 86.2, 'old': 86.53, 'new': 86.2}
2024-09-03 22:13:47,662 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47, 88.04, 86.56, 86.5]
2024-09-03 22:13:47,662 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97, 98.95, 98.67, 98.58]

Average Accuracy (CNN): 91.49
2024-09-03 22:13:47,662 [trainer.py] => Average Accuracy (CNN): 91.49 

Accuracy Matrix (CNN):
[[98.6 97.6 96.4 96.2 95.8 93.3 92.9 92.5 92.6 92. ]
 [ 0.  94.7 93.3 92.  90.1 90.  87.4 87.1 85.9 86.3]
 [ 0.   0.  95.4 93.2 92.3 91.  89.8 90.5 90.  90.3]
 [ 0.   0.   0.  90.5 89.  87.8 87.7 88.7 87.6 86.9]
 [ 0.   0.   0.   0.  89.4 87.7 87.  84.9 84.9 85.9]
 [ 0.   0.   0.   0.   0.  91.5 87.7 86.6 85.6 85.6]
 [ 0.   0.   0.   0.   0.   0.  93.8 93.2 92.3 91.8]
 [ 0.   0.   0.   0.   0.   0.   0.  80.8 79.8 79.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  80.3 80.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  86.2]]
2024-09-03 22:13:47,664 [trainer.py] => Forgetting (CNN): 4.077777777777778
2024-09-03 22:13:50,351 [trainer.py] => config: ./exps/coda_prompt_cifar_B0_Inc20.json
2024-09-03 22:13:50,351 [trainer.py] => prefix:  
2024-09-03 22:13:50,351 [trainer.py] => dataset: cifar224
2024-09-03 22:13:50,351 [trainer.py] => memory_size: 0
2024-09-03 22:13:50,351 [trainer.py] => memory_per_class: 0
2024-09-03 22:13:50,351 [trainer.py] => fixed_memory: False
2024-09-03 22:13:50,351 [trainer.py] => shuffle: True
2024-09-03 22:13:50,351 [trainer.py] => init_cls: 5
2024-09-03 22:13:50,351 [trainer.py] => increment: 5
2024-09-03 22:13:50,351 [trainer.py] => model_name: coda_prompt
2024-09-03 22:13:50,351 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-03 22:13:50,351 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-03 22:13:50,351 [trainer.py] => seed: 1993
2024-09-03 22:13:50,351 [trainer.py] => tuned_epoch: 20
2024-09-03 22:13:50,351 [trainer.py] => init_lr: 0.001
2024-09-03 22:13:50,351 [trainer.py] => batch_size: 48
2024-09-03 22:13:50,351 [trainer.py] => weight_decay: 0
2024-09-03 22:13:50,351 [trainer.py] => min_lr: 1e-05
2024-09-03 22:13:50,351 [trainer.py] => optimizer: adam
2024-09-03 22:13:50,351 [trainer.py] => scheduler: cosine
2024-09-03 22:13:50,351 [trainer.py] => reinit_optimizer: True
2024-09-03 22:13:50,351 [trainer.py] => pretrained: True
2024-09-03 22:13:50,351 [trainer.py] => drop: 0.0
2024-09-03 22:13:50,351 [trainer.py] => drop_path: 0.0
2024-09-03 22:13:50,351 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-03 22:13:51,454 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-03 22:13:53,515 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-03 22:13:53,515 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-03 22:13:53,516 [trainer.py] => All params: 89715556
2024-09-03 22:13:53,516 [trainer.py] => Trainable params: 89715556
2024-09-03 22:13:53,516 [coda_prompt.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.489, Train_accy 83.77:   0%|          | 0/20 [00:27<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.489, Train_accy 83.77:   5%|▌         | 1/20 [00:27<08:44, 27.62s/it]
Task 0, Epoch 2/20 => Loss 0.152, Train_accy 94.87:   5%|▌         | 1/20 [00:55<08:44, 27.62s/it]
Task 0, Epoch 2/20 => Loss 0.152, Train_accy 94.87:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 0, Epoch 3/20 => Loss 0.145, Train_accy 95.47:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 0, Epoch 3/20 => Loss 0.145, Train_accy 95.47:  15%|█▌        | 3/20 [01:22<07:47, 27.50s/it]
Task 0, Epoch 4/20 => Loss 0.121, Train_accy 95.99:  15%|█▌        | 3/20 [01:50<07:47, 27.50s/it]
Task 0, Epoch 4/20 => Loss 0.121, Train_accy 95.99:  20%|██        | 4/20 [01:50<07:19, 27.49s/it]
Task 0, Epoch 5/20 => Loss 0.103, Train_accy 96.63, Test_accy 99.60:  20%|██        | 4/20 [02:20<07:19, 27.49s/it]
Task 0, Epoch 5/20 => Loss 0.103, Train_accy 96.63, Test_accy 99.60:  25%|██▌       | 5/20 [02:20<07:09, 28.62s/it]
Task 0, Epoch 6/20 => Loss 0.108, Train_accy 96.43:  25%|██▌       | 5/20 [02:48<07:09, 28.62s/it]                 
Task 0, Epoch 6/20 => Loss 0.108, Train_accy 96.43:  30%|███       | 6/20 [02:48<06:34, 28.20s/it]
Task 0, Epoch 7/20 => Loss 0.089, Train_accy 96.92:  30%|███       | 6/20 [03:15<06:34, 28.20s/it]
Task 0, Epoch 7/20 => Loss 0.089, Train_accy 96.92:  35%|███▌      | 7/20 [03:15<06:03, 27.95s/it]
Task 0, Epoch 8/20 => Loss 0.091, Train_accy 96.47:  35%|███▌      | 7/20 [03:42<06:03, 27.95s/it]
Task 0, Epoch 8/20 => Loss 0.091, Train_accy 96.47:  40%|████      | 8/20 [03:42<05:33, 27.82s/it]
Task 0, Epoch 9/20 => Loss 0.097, Train_accy 96.71:  40%|████      | 8/20 [04:10<05:33, 27.82s/it]
Task 0, Epoch 9/20 => Loss 0.097, Train_accy 96.71:  45%|████▌     | 9/20 [04:10<05:05, 27.73s/it]
Task 0, Epoch 10/20 => Loss 0.079, Train_accy 97.80, Test_accy 99.80:  45%|████▌     | 9/20 [04:41<05:05, 27.73s/it]
Task 0, Epoch 10/20 => Loss 0.079, Train_accy 97.80, Test_accy 99.80:  50%|█████     | 10/20 [04:41<04:46, 28.63s/it]
Task 0, Epoch 11/20 => Loss 0.070, Train_accy 97.72:  50%|█████     | 10/20 [05:08<04:46, 28.63s/it]                 
Task 0, Epoch 11/20 => Loss 0.070, Train_accy 97.72:  55%|█████▌    | 11/20 [05:08<04:14, 28.26s/it]
Task 0, Epoch 12/20 => Loss 0.088, Train_accy 97.24:  55%|█████▌    | 11/20 [05:35<04:14, 28.26s/it]
Task 0, Epoch 12/20 => Loss 0.088, Train_accy 97.24:  60%|██████    | 12/20 [05:35<03:44, 28.00s/it]
Task 0, Epoch 13/20 => Loss 0.063, Train_accy 97.84:  60%|██████    | 12/20 [06:03<03:44, 28.00s/it]
Task 0, Epoch 13/20 => Loss 0.063, Train_accy 97.84:  65%|██████▌   | 13/20 [06:03<03:14, 27.85s/it]
Task 0, Epoch 14/20 => Loss 0.063, Train_accy 97.68:  65%|██████▌   | 13/20 [06:30<03:14, 27.85s/it]
Task 0, Epoch 14/20 => Loss 0.063, Train_accy 97.68:  70%|███████   | 14/20 [06:30<02:46, 27.74s/it]
Task 0, Epoch 15/20 => Loss 0.068, Train_accy 97.80, Test_accy 99.80:  70%|███████   | 14/20 [07:01<02:46, 27.74s/it]
Task 0, Epoch 15/20 => Loss 0.068, Train_accy 97.80, Test_accy 99.80:  75%|███████▌  | 15/20 [07:01<02:22, 28.59s/it]
Task 0, Epoch 16/20 => Loss 0.083, Train_accy 97.60:  75%|███████▌  | 15/20 [07:29<02:22, 28.59s/it]                 
Task 0, Epoch 16/20 => Loss 0.083, Train_accy 97.60:  80%|████████  | 16/20 [07:29<01:53, 28.26s/it]
Task 0, Epoch 17/20 => Loss 0.063, Train_accy 98.00:  80%|████████  | 16/20 [07:56<01:53, 28.26s/it]
Task 0, Epoch 17/20 => Loss 0.063, Train_accy 98.00:  85%|████████▌ | 17/20 [07:56<01:24, 28.03s/it]
Task 0, Epoch 18/20 => Loss 0.064, Train_accy 97.88:  85%|████████▌ | 17/20 [08:23<01:24, 28.03s/it]
Task 0, Epoch 18/20 => Loss 0.064, Train_accy 97.88:  90%|█████████ | 18/20 [08:23<00:55, 27.85s/it]
Task 0, Epoch 19/20 => Loss 0.063, Train_accy 98.12:  90%|█████████ | 18/20 [08:51<00:55, 27.85s/it]
Task 0, Epoch 19/20 => Loss 0.063, Train_accy 98.12:  95%|█████████▌| 19/20 [08:51<00:27, 27.74s/it]
Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80:  95%|█████████▌| 19/20 [09:22<00:27, 27.74s/it]
Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80: 100%|██████████| 20/20 [09:22<00:00, 28.61s/it]
Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80: 100%|██████████| 20/20 [09:22<00:00, 28.11s/it]
2024-09-03 22:23:16,110 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80
2024-09-03 22:23:19,269 [trainer.py] => No NME accuracy.
2024-09-03 22:23:19,270 [trainer.py] => CNN: {'total': 99.8, '00-04': 99.8, 'old': 0, 'new': 99.8}
2024-09-03 22:23:19,270 [trainer.py] => CNN top1 curve: [99.8]
2024-09-03 22:23:19,270 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.8
2024-09-03 22:23:19,270 [trainer.py] => Average Accuracy (CNN): 99.8 

2024-09-03 22:23:19,272 [trainer.py] => All params: 89715556
2024-09-03 22:23:19,273 [trainer.py] => Trainable params: 89715556
2024-09-03 22:23:19,368 [coda_prompt.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.425, Train_accy 84.33:   0%|          | 0/20 [00:27<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.425, Train_accy 84.33:   5%|▌         | 1/20 [00:27<08:43, 27.54s/it]
Task 1, Epoch 2/20 => Loss 0.179, Train_accy 93.63:   5%|▌         | 1/20 [00:55<08:43, 27.54s/it]
Task 1, Epoch 2/20 => Loss 0.179, Train_accy 93.63:  10%|█         | 2/20 [00:55<08:16, 27.58s/it]
Task 1, Epoch 3/20 => Loss 0.149, Train_accy 95.03:  10%|█         | 2/20 [01:22<08:16, 27.58s/it]
Task 1, Epoch 3/20 => Loss 0.149, Train_accy 95.03:  15%|█▌        | 3/20 [01:22<07:48, 27.56s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.23:  15%|█▌        | 3/20 [01:50<07:48, 27.56s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.23:  20%|██        | 4/20 [01:50<07:20, 27.56s/it]
Task 1, Epoch 5/20 => Loss 0.120, Train_accy 95.55, Test_accy 97.30:  20%|██        | 4/20 [02:23<07:20, 27.56s/it]
Task 1, Epoch 5/20 => Loss 0.120, Train_accy 95.55, Test_accy 97.30:  25%|██▌       | 5/20 [02:23<07:25, 29.67s/it]
Task 1, Epoch 6/20 => Loss 0.133, Train_accy 95.51:  25%|██▌       | 5/20 [02:51<07:25, 29.67s/it]                 
Task 1, Epoch 6/20 => Loss 0.133, Train_accy 95.51:  30%|███       | 6/20 [02:51<06:45, 28.96s/it]
Task 1, Epoch 7/20 => Loss 0.116, Train_accy 95.79:  30%|███       | 6/20 [03:18<06:45, 28.96s/it]
Task 1, Epoch 7/20 => Loss 0.116, Train_accy 95.79:  35%|███▌      | 7/20 [03:18<06:10, 28.49s/it]
Task 1, Epoch 8/20 => Loss 0.120, Train_accy 95.83:  35%|███▌      | 7/20 [03:46<06:10, 28.49s/it]
Task 1, Epoch 8/20 => Loss 0.120, Train_accy 95.83:  40%|████      | 8/20 [03:46<05:38, 28.18s/it]
Task 1, Epoch 9/20 => Loss 0.121, Train_accy 95.67:  40%|████      | 8/20 [04:13<05:38, 28.18s/it]
Task 1, Epoch 9/20 => Loss 0.121, Train_accy 95.67:  45%|████▌     | 9/20 [04:13<05:07, 27.98s/it]
Task 1, Epoch 10/20 => Loss 0.109, Train_accy 96.51, Test_accy 97.50:  45%|████▌     | 9/20 [04:47<05:07, 27.98s/it]
Task 1, Epoch 10/20 => Loss 0.109, Train_accy 96.51, Test_accy 97.50:  50%|█████     | 10/20 [04:47<04:56, 29.64s/it]
Task 1, Epoch 11/20 => Loss 0.112, Train_accy 96.07:  50%|█████     | 10/20 [05:14<04:56, 29.64s/it]                 
Task 1, Epoch 11/20 => Loss 0.112, Train_accy 96.07:  55%|█████▌    | 11/20 [05:14<04:20, 28.98s/it]
Task 1, Epoch 12/20 => Loss 0.107, Train_accy 96.11:  55%|█████▌    | 11/20 [05:42<04:20, 28.98s/it]
Task 1, Epoch 12/20 => Loss 0.107, Train_accy 96.11:  60%|██████    | 12/20 [05:42<03:48, 28.52s/it]
Task 1, Epoch 13/20 => Loss 0.097, Train_accy 96.51:  60%|██████    | 12/20 [06:09<03:48, 28.52s/it]
Task 1, Epoch 13/20 => Loss 0.097, Train_accy 96.51:  65%|██████▌   | 13/20 [06:09<03:17, 28.22s/it]
Task 1, Epoch 14/20 => Loss 0.090, Train_accy 96.96:  65%|██████▌   | 13/20 [06:37<03:17, 28.22s/it]
Task 1, Epoch 14/20 => Loss 0.090, Train_accy 96.96:  70%|███████   | 14/20 [06:37<02:47, 27.98s/it]
Task 1, Epoch 15/20 => Loss 0.103, Train_accy 96.07, Test_accy 97.70:  70%|███████   | 14/20 [07:10<02:47, 27.98s/it]
Task 1, Epoch 15/20 => Loss 0.103, Train_accy 96.07, Test_accy 97.70:  75%|███████▌  | 15/20 [07:10<02:28, 29.63s/it]
Task 1, Epoch 16/20 => Loss 0.113, Train_accy 95.91:  75%|███████▌  | 15/20 [07:38<02:28, 29.63s/it]                 
Task 1, Epoch 16/20 => Loss 0.113, Train_accy 95.91:  80%|████████  | 16/20 [07:38<01:55, 28.98s/it]
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 96.88:  80%|████████  | 16/20 [08:05<01:55, 28.98s/it]
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 96.88:  85%|████████▌ | 17/20 [08:05<01:25, 28.53s/it]
Task 1, Epoch 18/20 => Loss 0.098, Train_accy 96.51:  85%|████████▌ | 17/20 [08:32<01:25, 28.53s/it]
Task 1, Epoch 18/20 => Loss 0.098, Train_accy 96.51:  90%|█████████ | 18/20 [08:32<00:56, 28.20s/it]
Task 1, Epoch 19/20 => Loss 0.092, Train_accy 96.59:  90%|█████████ | 18/20 [09:00<00:56, 28.20s/it]
Task 1, Epoch 19/20 => Loss 0.092, Train_accy 96.59:  95%|█████████▌| 19/20 [09:00<00:27, 27.98s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00:  95%|█████████▌| 19/20 [09:33<00:27, 27.98s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00: 100%|██████████| 20/20 [09:33<00:00, 29.60s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00: 100%|██████████| 20/20 [09:33<00:00, 28.69s/it]
2024-09-03 22:32:53,203 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00
2024-09-03 22:32:59,089 [trainer.py] => No NME accuracy.
2024-09-03 22:32:59,089 [trainer.py] => CNN: {'total': 98.0, '00-04': 99.2, '05-09': 96.8, 'old': 99.2, 'new': 96.8}
2024-09-03 22:32:59,089 [trainer.py] => CNN top1 curve: [99.8, 98.0]
2024-09-03 22:32:59,090 [trainer.py] => CNN top5 curve: [100.0, 99.8]

Average Accuracy (CNN): 98.9
2024-09-03 22:32:59,090 [trainer.py] => Average Accuracy (CNN): 98.9 

2024-09-03 22:32:59,091 [trainer.py] => All params: 89715556
2024-09-03 22:32:59,092 [trainer.py] => Trainable params: 89715556
2024-09-03 22:32:59,234 [coda_prompt.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.415, Train_accy 85.10:   0%|          | 0/20 [00:27<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.415, Train_accy 85.10:   5%|▌         | 1/20 [00:27<08:44, 27.58s/it]
Task 2, Epoch 2/20 => Loss 0.179, Train_accy 93.19:   5%|▌         | 1/20 [00:55<08:44, 27.58s/it]
Task 2, Epoch 2/20 => Loss 0.179, Train_accy 93.19:  10%|█         | 2/20 [00:55<08:16, 27.58s/it]
Task 2, Epoch 3/20 => Loss 0.142, Train_accy 95.03:  10%|█         | 2/20 [01:22<08:16, 27.58s/it]
Task 2, Epoch 3/20 => Loss 0.142, Train_accy 95.03:  15%|█▌        | 3/20 [01:22<07:48, 27.56s/it]
Task 2, Epoch 4/20 => Loss 0.122, Train_accy 95.47:  15%|█▌        | 3/20 [01:50<07:48, 27.56s/it]
Task 2, Epoch 4/20 => Loss 0.122, Train_accy 95.47:  20%|██        | 4/20 [01:50<07:20, 27.54s/it]
Task 2, Epoch 5/20 => Loss 0.128, Train_accy 95.31, Test_accy 96.07:  20%|██        | 4/20 [02:26<07:20, 27.54s/it]
Task 2, Epoch 5/20 => Loss 0.128, Train_accy 95.31, Test_accy 96.07:  25%|██▌       | 5/20 [02:26<07:40, 30.70s/it]
Task 2, Epoch 6/20 => Loss 0.130, Train_accy 95.39:  25%|██▌       | 5/20 [02:53<07:40, 30.70s/it]                 
Task 2, Epoch 6/20 => Loss 0.130, Train_accy 95.39:  30%|███       | 6/20 [02:53<06:54, 29.60s/it]
Task 2, Epoch 7/20 => Loss 0.147, Train_accy 94.55:  30%|███       | 6/20 [03:21<06:54, 29.60s/it]
Task 2, Epoch 7/20 => Loss 0.147, Train_accy 94.55:  35%|███▌      | 7/20 [03:21<06:16, 28.94s/it]
Task 2, Epoch 8/20 => Loss 0.119, Train_accy 95.19:  35%|███▌      | 7/20 [03:49<06:16, 28.94s/it]
Task 2, Epoch 8/20 => Loss 0.119, Train_accy 95.19:  40%|████      | 8/20 [03:49<05:41, 28.48s/it]
Task 2, Epoch 9/20 => Loss 0.125, Train_accy 95.35:  40%|████      | 8/20 [04:16<05:41, 28.48s/it]
Task 2, Epoch 9/20 => Loss 0.125, Train_accy 95.35:  45%|████▌     | 9/20 [04:16<05:09, 28.17s/it]
Task 2, Epoch 10/20 => Loss 0.130, Train_accy 95.11, Test_accy 96.27:  45%|████▌     | 9/20 [04:52<05:09, 28.17s/it]
Task 2, Epoch 10/20 => Loss 0.130, Train_accy 95.11, Test_accy 96.27:  50%|█████     | 10/20 [04:52<05:06, 30.65s/it]
Task 2, Epoch 11/20 => Loss 0.118, Train_accy 95.71:  50%|█████     | 10/20 [05:20<05:06, 30.65s/it]                 
Task 2, Epoch 11/20 => Loss 0.118, Train_accy 95.71:  55%|█████▌    | 11/20 [05:20<04:27, 29.69s/it]
Task 2, Epoch 12/20 => Loss 0.098, Train_accy 96.35:  55%|█████▌    | 11/20 [05:47<04:27, 29.69s/it]
Task 2, Epoch 12/20 => Loss 0.098, Train_accy 96.35:  60%|██████    | 12/20 [05:47<03:52, 29.04s/it]
Task 2, Epoch 13/20 => Loss 0.121, Train_accy 95.31:  60%|██████    | 12/20 [06:15<03:52, 29.04s/it]
Task 2, Epoch 13/20 => Loss 0.121, Train_accy 95.31:  65%|██████▌   | 13/20 [06:15<03:19, 28.56s/it]
Task 2, Epoch 14/20 => Loss 0.105, Train_accy 96.03:  65%|██████▌   | 13/20 [06:42<03:19, 28.56s/it]
Task 2, Epoch 14/20 => Loss 0.105, Train_accy 96.03:  70%|███████   | 14/20 [06:42<02:49, 28.22s/it]
Task 2, Epoch 15/20 => Loss 0.095, Train_accy 96.27, Test_accy 96.40:  70%|███████   | 14/20 [07:19<02:49, 28.22s/it]
Task 2, Epoch 15/20 => Loss 0.095, Train_accy 96.27, Test_accy 96.40:  75%|███████▌  | 15/20 [07:19<02:33, 30.66s/it]
Task 2, Epoch 16/20 => Loss 0.096, Train_accy 96.19:  75%|███████▌  | 15/20 [07:46<02:33, 30.66s/it]                 
Task 2, Epoch 16/20 => Loss 0.096, Train_accy 96.19:  80%|████████  | 16/20 [07:46<01:58, 29.73s/it]
Task 2, Epoch 17/20 => Loss 0.108, Train_accy 96.31:  80%|████████  | 16/20 [08:13<01:58, 29.73s/it]
Task 2, Epoch 17/20 => Loss 0.108, Train_accy 96.31:  85%|████████▌ | 17/20 [08:13<01:27, 29.00s/it]
Task 2, Epoch 18/20 => Loss 0.100, Train_accy 96.19:  85%|████████▌ | 17/20 [08:41<01:27, 29.00s/it]
Task 2, Epoch 18/20 => Loss 0.100, Train_accy 96.19:  90%|█████████ | 18/20 [08:41<00:57, 28.53s/it]
Task 2, Epoch 19/20 => Loss 0.102, Train_accy 96.19:  90%|█████████ | 18/20 [09:08<00:57, 28.53s/it]
Task 2, Epoch 19/20 => Loss 0.102, Train_accy 96.19:  95%|█████████▌| 19/20 [09:08<00:28, 28.20s/it]
Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67:  95%|█████████▌| 19/20 [09:44<00:28, 28.20s/it]
Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67: 100%|██████████| 20/20 [09:44<00:00, 30.49s/it]
Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67: 100%|██████████| 20/20 [09:44<00:00, 29.23s/it]
2024-09-03 22:42:43,831 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67
2024-09-03 22:42:52,531 [trainer.py] => No NME accuracy.
2024-09-03 22:42:52,531 [trainer.py] => CNN: {'total': 96.67, '00-04': 98.8, '05-09': 95.4, '10-14': 95.8, 'old': 97.1, 'new': 95.8}
2024-09-03 22:42:52,531 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67]
2024-09-03 22:42:52,532 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67]

Average Accuracy (CNN): 98.16
2024-09-03 22:42:52,532 [trainer.py] => Average Accuracy (CNN): 98.16 

2024-09-03 22:42:52,534 [trainer.py] => All params: 89715556
2024-09-03 22:42:52,535 [trainer.py] => Trainable params: 89715556
2024-09-03 22:42:52,721 [coda_prompt.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.435, Train_accy 84.05:   0%|          | 0/20 [00:27<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.435, Train_accy 84.05:   5%|▌         | 1/20 [00:27<08:41, 27.46s/it]
Task 3, Epoch 2/20 => Loss 0.180, Train_accy 93.59:   5%|▌         | 1/20 [00:54<08:41, 27.46s/it]
Task 3, Epoch 2/20 => Loss 0.180, Train_accy 93.59:  10%|█         | 2/20 [00:54<08:14, 27.49s/it]
Task 3, Epoch 3/20 => Loss 0.161, Train_accy 94.35:  10%|█         | 2/20 [01:22<08:14, 27.49s/it]
Task 3, Epoch 3/20 => Loss 0.161, Train_accy 94.35:  15%|█▌        | 3/20 [01:22<07:47, 27.49s/it]
Task 3, Epoch 4/20 => Loss 0.132, Train_accy 95.07:  15%|█▌        | 3/20 [01:49<07:47, 27.49s/it]
Task 3, Epoch 4/20 => Loss 0.132, Train_accy 95.07:  20%|██        | 4/20 [01:49<07:19, 27.47s/it]
Task 3, Epoch 5/20 => Loss 0.152, Train_accy 94.47, Test_accy 94.80:  20%|██        | 4/20 [02:28<07:19, 27.47s/it]
Task 3, Epoch 5/20 => Loss 0.152, Train_accy 94.47, Test_accy 94.80:  25%|██▌       | 5/20 [02:28<07:54, 31.62s/it]
Task 3, Epoch 6/20 => Loss 0.137, Train_accy 94.99:  25%|██▌       | 5/20 [02:56<07:54, 31.62s/it]                 
Task 3, Epoch 6/20 => Loss 0.137, Train_accy 94.99:  30%|███       | 6/20 [02:56<07:02, 30.19s/it]
Task 3, Epoch 7/20 => Loss 0.130, Train_accy 95.67:  30%|███       | 6/20 [03:23<07:02, 30.19s/it]
Task 3, Epoch 7/20 => Loss 0.130, Train_accy 95.67:  35%|███▌      | 7/20 [03:23<06:20, 29.25s/it]
Task 3, Epoch 8/20 => Loss 0.132, Train_accy 94.95:  35%|███▌      | 7/20 [03:51<06:20, 29.25s/it]
Task 3, Epoch 8/20 => Loss 0.132, Train_accy 94.95:  40%|████      | 8/20 [03:51<05:43, 28.66s/it]
Task 3, Epoch 9/20 => Loss 0.115, Train_accy 95.63:  40%|████      | 8/20 [04:18<05:43, 28.66s/it]
Task 3, Epoch 9/20 => Loss 0.115, Train_accy 95.63:  45%|████▌     | 9/20 [04:18<05:11, 28.28s/it]
Task 3, Epoch 10/20 => Loss 0.120, Train_accy 95.35, Test_accy 94.80:  45%|████▌     | 9/20 [04:57<05:11, 28.28s/it]
Task 3, Epoch 10/20 => Loss 0.120, Train_accy 95.35, Test_accy 94.80:  50%|█████     | 10/20 [04:57<05:15, 31.56s/it]
Task 3, Epoch 11/20 => Loss 0.133, Train_accy 94.91:  50%|█████     | 10/20 [05:24<05:15, 31.56s/it]                 
Task 3, Epoch 11/20 => Loss 0.133, Train_accy 94.91:  55%|█████▌    | 11/20 [05:24<04:32, 30.30s/it]
Task 3, Epoch 12/20 => Loss 0.124, Train_accy 95.47:  55%|█████▌    | 11/20 [05:52<04:32, 30.30s/it]
Task 3, Epoch 12/20 => Loss 0.124, Train_accy 95.47:  60%|██████    | 12/20 [05:52<03:55, 29.43s/it]
Task 3, Epoch 13/20 => Loss 0.111, Train_accy 95.67:  60%|██████    | 12/20 [06:19<03:55, 29.43s/it]
Task 3, Epoch 13/20 => Loss 0.111, Train_accy 95.67:  65%|██████▌   | 13/20 [06:19<03:21, 28.84s/it]
Task 3, Epoch 14/20 => Loss 0.110, Train_accy 95.95:  65%|██████▌   | 13/20 [06:47<03:21, 28.84s/it]
Task 3, Epoch 14/20 => Loss 0.110, Train_accy 95.95:  70%|███████   | 14/20 [06:47<02:50, 28.43s/it]
Task 3, Epoch 15/20 => Loss 0.107, Train_accy 96.15, Test_accy 95.20:  70%|███████   | 14/20 [07:26<02:50, 28.43s/it]
Task 3, Epoch 15/20 => Loss 0.107, Train_accy 96.15, Test_accy 95.20:  75%|███████▌  | 15/20 [07:26<02:37, 31.59s/it]
Task 3, Epoch 16/20 => Loss 0.117, Train_accy 95.99:  75%|███████▌  | 15/20 [07:53<02:37, 31.59s/it]                 
Task 3, Epoch 16/20 => Loss 0.117, Train_accy 95.99:  80%|████████  | 16/20 [07:53<02:01, 30.34s/it]
Task 3, Epoch 17/20 => Loss 0.106, Train_accy 96.23:  80%|████████  | 16/20 [08:20<02:01, 30.34s/it]
Task 3, Epoch 17/20 => Loss 0.106, Train_accy 96.23:  85%|████████▌ | 17/20 [08:20<01:28, 29.46s/it]
Task 3, Epoch 18/20 => Loss 0.109, Train_accy 95.87:  85%|████████▌ | 17/20 [08:48<01:28, 29.46s/it]
Task 3, Epoch 18/20 => Loss 0.109, Train_accy 95.87:  90%|█████████ | 18/20 [08:48<00:57, 28.85s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 96.51:  90%|█████████ | 18/20 [09:15<00:57, 28.85s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 96.51:  95%|█████████▌| 19/20 [09:15<00:28, 28.42s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00:  95%|█████████▌| 19/20 [09:54<00:28, 28.42s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00: 100%|██████████| 20/20 [09:54<00:00, 31.59s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00: 100%|██████████| 20/20 [09:54<00:00, 29.74s/it]
2024-09-03 22:52:47,553 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00
2024-09-03 22:52:59,069 [trainer.py] => No NME accuracy.
2024-09-03 22:52:59,069 [trainer.py] => CNN: {'total': 95.0, '00-04': 98.6, '05-09': 94.4, '10-14': 94.6, '15-19': 92.4, 'old': 95.87, 'new': 92.4}
2024-09-03 22:52:59,069 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0]
2024-09-03 22:52:59,069 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3]

Average Accuracy (CNN): 97.37
2024-09-03 22:52:59,070 [trainer.py] => Average Accuracy (CNN): 97.37 

2024-09-03 22:52:59,071 [trainer.py] => All params: 89715556
2024-09-03 22:52:59,072 [trainer.py] => Trainable params: 89715556
2024-09-03 22:52:59,310 [coda_prompt.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.296, Train_accy 90.02:   0%|          | 0/20 [00:27<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.296, Train_accy 90.02:   5%|▌         | 1/20 [00:27<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.094, Train_accy 97.24:   5%|▌         | 1/20 [00:54<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.094, Train_accy 97.24:  10%|█         | 2/20 [00:54<08:13, 27.41s/it]
Task 4, Epoch 3/20 => Loss 0.084, Train_accy 97.24:  10%|█         | 2/20 [01:22<08:13, 27.41s/it]
Task 4, Epoch 3/20 => Loss 0.084, Train_accy 97.24:  15%|█▌        | 3/20 [01:22<07:44, 27.34s/it]
Task 4, Epoch 4/20 => Loss 0.071, Train_accy 97.28:  15%|█▌        | 3/20 [01:49<07:44, 27.34s/it]
Task 4, Epoch 4/20 => Loss 0.071, Train_accy 97.28:  20%|██        | 4/20 [01:49<07:16, 27.27s/it]
Task 4, Epoch 5/20 => Loss 0.070, Train_accy 97.20, Test_accy 94.00:  20%|██        | 4/20 [02:30<07:16, 27.27s/it]
Task 4, Epoch 5/20 => Loss 0.070, Train_accy 97.20, Test_accy 94.00:  25%|██▌       | 5/20 [02:30<08:07, 32.47s/it]
Task 4, Epoch 6/20 => Loss 0.083, Train_accy 97.20:  25%|██▌       | 5/20 [02:58<08:07, 32.47s/it]                 
Task 4, Epoch 6/20 => Loss 0.083, Train_accy 97.20:  30%|███       | 6/20 [02:58<07:10, 30.76s/it]
Task 4, Epoch 7/20 => Loss 0.056, Train_accy 97.88:  30%|███       | 6/20 [03:25<07:10, 30.76s/it]
Task 4, Epoch 7/20 => Loss 0.056, Train_accy 97.88:  35%|███▌      | 7/20 [03:25<06:25, 29.68s/it]
Task 4, Epoch 8/20 => Loss 0.066, Train_accy 97.48:  35%|███▌      | 7/20 [03:53<06:25, 29.68s/it]
Task 4, Epoch 8/20 => Loss 0.066, Train_accy 97.48:  40%|████      | 8/20 [03:53<05:47, 28.96s/it]
Task 4, Epoch 9/20 => Loss 0.071, Train_accy 97.16:  40%|████      | 8/20 [04:20<05:47, 28.96s/it]
Task 4, Epoch 9/20 => Loss 0.071, Train_accy 97.16:  45%|████▌     | 9/20 [04:20<05:13, 28.46s/it]
Task 4, Epoch 10/20 => Loss 0.054, Train_accy 98.28, Test_accy 95.04:  45%|████▌     | 9/20 [05:02<05:13, 28.46s/it]
Task 4, Epoch 10/20 => Loss 0.054, Train_accy 98.28, Test_accy 95.04:  50%|█████     | 10/20 [05:02<05:24, 32.49s/it]
Task 4, Epoch 11/20 => Loss 0.058, Train_accy 97.84:  50%|█████     | 10/20 [05:29<05:24, 32.49s/it]                 
Task 4, Epoch 11/20 => Loss 0.058, Train_accy 97.84:  55%|█████▌    | 11/20 [05:29<04:38, 30.94s/it]
Task 4, Epoch 12/20 => Loss 0.069, Train_accy 97.44:  55%|█████▌    | 11/20 [05:56<04:38, 30.94s/it]
Task 4, Epoch 12/20 => Loss 0.069, Train_accy 97.44:  60%|██████    | 12/20 [05:56<03:59, 29.88s/it]
Task 4, Epoch 13/20 => Loss 0.050, Train_accy 98.04:  60%|██████    | 12/20 [06:24<03:59, 29.88s/it]
Task 4, Epoch 13/20 => Loss 0.050, Train_accy 98.04:  65%|██████▌   | 13/20 [06:24<03:23, 29.13s/it]
Task 4, Epoch 14/20 => Loss 0.057, Train_accy 98.04:  65%|██████▌   | 13/20 [06:51<03:23, 29.13s/it]
Task 4, Epoch 14/20 => Loss 0.057, Train_accy 98.04:  70%|███████   | 14/20 [06:51<02:51, 28.62s/it]
Task 4, Epoch 15/20 => Loss 0.046, Train_accy 98.52, Test_accy 94.96:  70%|███████   | 14/20 [07:33<02:51, 28.62s/it]
Task 4, Epoch 15/20 => Loss 0.046, Train_accy 98.52, Test_accy 94.96:  75%|███████▌  | 15/20 [07:33<02:42, 32.57s/it]
Task 4, Epoch 16/20 => Loss 0.047, Train_accy 98.28:  75%|███████▌  | 15/20 [08:01<02:42, 32.57s/it]                 
Task 4, Epoch 16/20 => Loss 0.047, Train_accy 98.28:  80%|████████  | 16/20 [08:01<02:04, 31.03s/it]
Task 4, Epoch 17/20 => Loss 0.044, Train_accy 98.44:  80%|████████  | 16/20 [08:28<02:04, 31.03s/it]
Task 4, Epoch 17/20 => Loss 0.044, Train_accy 98.44:  85%|████████▌ | 17/20 [08:28<01:29, 29.94s/it]
Task 4, Epoch 18/20 => Loss 0.040, Train_accy 98.64:  85%|████████▌ | 17/20 [08:55<01:29, 29.94s/it]
Task 4, Epoch 18/20 => Loss 0.040, Train_accy 98.64:  90%|█████████ | 18/20 [08:55<00:58, 29.17s/it]
Task 4, Epoch 19/20 => Loss 0.043, Train_accy 98.48:  90%|█████████ | 18/20 [09:23<00:58, 29.17s/it]
Task 4, Epoch 19/20 => Loss 0.043, Train_accy 98.48:  95%|█████████▌| 19/20 [09:23<00:28, 28.65s/it]
Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04:  95%|█████████▌| 19/20 [10:04<00:28, 28.65s/it]
Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04: 100%|██████████| 20/20 [10:04<00:00, 32.54s/it]
Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04: 100%|██████████| 20/20 [10:04<00:00, 30.24s/it]
2024-09-03 23:03:04,184 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04
2024-09-03 23:03:18,403 [trainer.py] => No NME accuracy.
2024-09-03 23:03:18,403 [trainer.py] => CNN: {'total': 95.04, '00-04': 98.8, '05-09': 94.8, '10-14': 93.6, '15-19': 92.2, '20-24': 95.8, 'old': 94.85, 'new': 95.8}
2024-09-03 23:03:18,404 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04]
2024-09-03 23:03:18,404 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32]

Average Accuracy (CNN): 96.9
2024-09-03 23:03:18,404 [trainer.py] => Average Accuracy (CNN): 96.9 

2024-09-03 23:03:18,406 [trainer.py] => All params: 89715556
2024-09-03 23:03:18,407 [trainer.py] => Trainable params: 89715556
2024-09-03 23:03:18,698 [coda_prompt.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.248, Train_accy 90.95:   0%|          | 0/20 [00:27<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.248, Train_accy 90.95:   5%|▌         | 1/20 [00:27<08:40, 27.40s/it]
Task 5, Epoch 2/20 => Loss 0.074, Train_accy 97.28:   5%|▌         | 1/20 [00:54<08:40, 27.40s/it]
Task 5, Epoch 2/20 => Loss 0.074, Train_accy 97.28:  10%|█         | 2/20 [00:54<08:12, 27.39s/it]
Task 5, Epoch 3/20 => Loss 0.064, Train_accy 97.68:  10%|█         | 2/20 [01:22<08:12, 27.39s/it]
Task 5, Epoch 3/20 => Loss 0.064, Train_accy 97.68:  15%|█▌        | 3/20 [01:22<07:45, 27.40s/it]
Task 5, Epoch 4/20 => Loss 0.066, Train_accy 97.64:  15%|█▌        | 3/20 [01:49<07:45, 27.40s/it]
Task 5, Epoch 4/20 => Loss 0.066, Train_accy 97.64:  20%|██        | 4/20 [01:49<07:18, 27.39s/it]
Task 5, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 93.30:  20%|██        | 4/20 [02:34<07:18, 27.39s/it]
Task 5, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 93.30:  25%|██▌       | 5/20 [02:34<08:23, 33.57s/it]
Task 5, Epoch 6/20 => Loss 0.072, Train_accy 97.24:  25%|██▌       | 5/20 [03:01<08:23, 33.57s/it]                 
Task 5, Epoch 6/20 => Loss 0.072, Train_accy 97.24:  30%|███       | 6/20 [03:01<07:18, 31.32s/it]
Task 5, Epoch 7/20 => Loss 0.060, Train_accy 97.80:  30%|███       | 6/20 [03:28<07:18, 31.32s/it]
Task 5, Epoch 7/20 => Loss 0.060, Train_accy 97.80:  35%|███▌      | 7/20 [03:28<06:30, 30.00s/it]
Task 5, Epoch 8/20 => Loss 0.070, Train_accy 97.72:  35%|███▌      | 7/20 [03:55<06:30, 30.00s/it]
Task 5, Epoch 8/20 => Loss 0.070, Train_accy 97.72:  40%|████      | 8/20 [03:55<05:50, 29.19s/it]
Task 5, Epoch 9/20 => Loss 0.057, Train_accy 98.04:  40%|████      | 8/20 [04:23<05:50, 29.19s/it]
Task 5, Epoch 9/20 => Loss 0.057, Train_accy 98.04:  45%|████▌     | 9/20 [04:23<05:15, 28.65s/it]
Task 5, Epoch 10/20 => Loss 0.067, Train_accy 97.44, Test_accy 93.67:  45%|████▌     | 9/20 [05:07<05:15, 28.65s/it]
Task 5, Epoch 10/20 => Loss 0.067, Train_accy 97.44, Test_accy 93.67:  50%|█████     | 10/20 [05:07<05:35, 33.55s/it]
Task 5, Epoch 11/20 => Loss 0.043, Train_accy 98.68:  50%|█████     | 10/20 [05:35<05:35, 33.55s/it]                 
Task 5, Epoch 11/20 => Loss 0.043, Train_accy 98.68:  55%|█████▌    | 11/20 [05:35<04:45, 31.69s/it]
Task 5, Epoch 12/20 => Loss 0.055, Train_accy 98.08:  55%|█████▌    | 11/20 [06:02<04:45, 31.69s/it]
Task 5, Epoch 12/20 => Loss 0.055, Train_accy 98.08:  60%|██████    | 12/20 [06:02<04:03, 30.40s/it]
Task 5, Epoch 13/20 => Loss 0.043, Train_accy 98.60:  60%|██████    | 12/20 [06:30<04:03, 30.40s/it]
Task 5, Epoch 13/20 => Loss 0.043, Train_accy 98.60:  65%|██████▌   | 13/20 [06:30<03:26, 29.50s/it]
Task 5, Epoch 14/20 => Loss 0.053, Train_accy 98.32:  65%|██████▌   | 13/20 [06:57<03:26, 29.50s/it]
Task 5, Epoch 14/20 => Loss 0.053, Train_accy 98.32:  70%|███████   | 14/20 [06:57<02:53, 28.89s/it]
Task 5, Epoch 15/20 => Loss 0.055, Train_accy 98.00, Test_accy 93.53:  70%|███████   | 14/20 [07:42<02:53, 28.89s/it]
Task 5, Epoch 15/20 => Loss 0.055, Train_accy 98.00, Test_accy 93.53:  75%|███████▌  | 15/20 [07:42<02:48, 33.64s/it]
Task 5, Epoch 16/20 => Loss 0.048, Train_accy 98.32:  75%|███████▌  | 15/20 [08:09<02:48, 33.64s/it]                 
Task 5, Epoch 16/20 => Loss 0.048, Train_accy 98.32:  80%|████████  | 16/20 [08:09<02:07, 31.79s/it]
Task 5, Epoch 17/20 => Loss 0.046, Train_accy 98.48:  80%|████████  | 16/20 [08:37<02:07, 31.79s/it]
Task 5, Epoch 17/20 => Loss 0.046, Train_accy 98.48:  85%|████████▌ | 17/20 [08:37<01:31, 30.50s/it]
Task 5, Epoch 18/20 => Loss 0.051, Train_accy 97.96:  85%|████████▌ | 17/20 [09:04<01:31, 30.50s/it]
Task 5, Epoch 18/20 => Loss 0.051, Train_accy 97.96:  90%|█████████ | 18/20 [09:04<00:59, 29.58s/it]
Task 5, Epoch 19/20 => Loss 0.035, Train_accy 98.72:  90%|█████████ | 18/20 [09:32<00:59, 29.58s/it]
Task 5, Epoch 19/20 => Loss 0.035, Train_accy 98.72:  95%|█████████▌| 19/20 [09:32<00:28, 28.95s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43:  95%|█████████▌| 19/20 [10:16<00:28, 28.95s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43: 100%|██████████| 20/20 [10:16<00:00, 33.64s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43: 100%|██████████| 20/20 [10:16<00:00, 30.84s/it]
2024-09-03 23:13:35,470 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43
2024-09-03 23:13:52,449 [trainer.py] => No NME accuracy.
2024-09-03 23:13:52,450 [trainer.py] => CNN: {'total': 93.43, '00-04': 97.0, '05-09': 91.4, '10-14': 93.4, '15-19': 91.4, '20-24': 94.8, '25-29': 92.6, 'old': 93.6, 'new': 92.6}
2024-09-03 23:13:52,450 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43]
2024-09-03 23:13:52,450 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1]

Average Accuracy (CNN): 96.32
2024-09-03 23:13:52,450 [trainer.py] => Average Accuracy (CNN): 96.32 

2024-09-03 23:13:52,452 [trainer.py] => All params: 89715556
2024-09-03 23:13:52,453 [trainer.py] => Trainable params: 89715556
2024-09-03 23:13:52,788 [coda_prompt.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.468, Train_accy 82.69:   0%|          | 0/20 [00:27<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.468, Train_accy 82.69:   5%|▌         | 1/20 [00:27<08:41, 27.44s/it]
Task 6, Epoch 2/20 => Loss 0.216, Train_accy 91.27:   5%|▌         | 1/20 [00:54<08:41, 27.44s/it]
Task 6, Epoch 2/20 => Loss 0.216, Train_accy 91.27:  10%|█         | 2/20 [00:54<08:13, 27.43s/it]
Task 6, Epoch 3/20 => Loss 0.203, Train_accy 91.87:  10%|█         | 2/20 [01:22<08:13, 27.43s/it]
Task 6, Epoch 3/20 => Loss 0.203, Train_accy 91.87:  15%|█▌        | 3/20 [01:22<07:46, 27.47s/it]
Task 6, Epoch 4/20 => Loss 0.175, Train_accy 93.31:  15%|█▌        | 3/20 [01:49<07:46, 27.47s/it]
Task 6, Epoch 4/20 => Loss 0.175, Train_accy 93.31:  20%|██        | 4/20 [01:49<07:19, 27.46s/it]
Task 6, Epoch 5/20 => Loss 0.173, Train_accy 92.83, Test_accy 89.43:  20%|██        | 4/20 [02:37<07:19, 27.46s/it]
Task 6, Epoch 5/20 => Loss 0.173, Train_accy 92.83, Test_accy 89.43:  25%|██▌       | 5/20 [02:37<08:38, 34.59s/it]
Task 6, Epoch 6/20 => Loss 0.166, Train_accy 92.99:  25%|██▌       | 5/20 [03:04<08:38, 34.59s/it]                 
Task 6, Epoch 6/20 => Loss 0.166, Train_accy 92.99:  30%|███       | 6/20 [03:04<07:30, 32.16s/it]
Task 6, Epoch 7/20 => Loss 0.162, Train_accy 93.71:  30%|███       | 6/20 [03:31<07:30, 32.16s/it]
Task 6, Epoch 7/20 => Loss 0.162, Train_accy 93.71:  35%|███▌      | 7/20 [03:31<06:38, 30.63s/it]
Task 6, Epoch 8/20 => Loss 0.159, Train_accy 93.99:  35%|███▌      | 7/20 [03:59<06:38, 30.63s/it]
Task 6, Epoch 8/20 => Loss 0.159, Train_accy 93.99:  40%|████      | 8/20 [03:59<05:55, 29.61s/it]
Task 6, Epoch 9/20 => Loss 0.137, Train_accy 94.19:  40%|████      | 8/20 [04:26<05:55, 29.61s/it]
Task 6, Epoch 9/20 => Loss 0.137, Train_accy 94.19:  45%|████▌     | 9/20 [04:26<05:18, 28.92s/it]
Task 6, Epoch 10/20 => Loss 0.151, Train_accy 94.27, Test_accy 90.71:  45%|████▌     | 9/20 [05:13<05:18, 28.92s/it]
Task 6, Epoch 10/20 => Loss 0.151, Train_accy 94.27, Test_accy 90.71:  50%|█████     | 10/20 [05:13<05:45, 34.55s/it]
Task 6, Epoch 11/20 => Loss 0.145, Train_accy 94.27:  50%|█████     | 10/20 [05:41<05:45, 34.55s/it]                 
Task 6, Epoch 11/20 => Loss 0.145, Train_accy 94.27:  55%|█████▌    | 11/20 [05:41<04:51, 32.36s/it]
Task 6, Epoch 12/20 => Loss 0.146, Train_accy 94.11:  55%|█████▌    | 11/20 [06:08<04:51, 32.36s/it]
Task 6, Epoch 12/20 => Loss 0.146, Train_accy 94.11:  60%|██████    | 12/20 [06:08<04:06, 30.87s/it]
Task 6, Epoch 13/20 => Loss 0.134, Train_accy 94.83:  60%|██████    | 12/20 [06:36<04:06, 30.87s/it]
Task 6, Epoch 13/20 => Loss 0.134, Train_accy 94.83:  65%|██████▌   | 13/20 [06:36<03:28, 29.85s/it]
Task 6, Epoch 14/20 => Loss 0.130, Train_accy 95.19:  65%|██████▌   | 13/20 [07:03<03:28, 29.85s/it]
Task 6, Epoch 14/20 => Loss 0.130, Train_accy 95.19:  70%|███████   | 14/20 [07:03<02:54, 29.13s/it]
Task 6, Epoch 15/20 => Loss 0.132, Train_accy 94.87, Test_accy 91.20:  70%|███████   | 14/20 [07:51<02:54, 29.13s/it]
Task 6, Epoch 15/20 => Loss 0.132, Train_accy 94.87, Test_accy 91.20:  75%|███████▌  | 15/20 [07:51<02:53, 34.61s/it]
Task 6, Epoch 16/20 => Loss 0.117, Train_accy 95.39:  75%|███████▌  | 15/20 [08:18<02:53, 34.61s/it]                 
Task 6, Epoch 16/20 => Loss 0.117, Train_accy 95.39:  80%|████████  | 16/20 [08:18<02:09, 32.49s/it]
Task 6, Epoch 17/20 => Loss 0.117, Train_accy 95.07:  80%|████████  | 16/20 [08:46<02:09, 32.49s/it]
Task 6, Epoch 17/20 => Loss 0.117, Train_accy 95.07:  85%|████████▌ | 17/20 [08:46<01:32, 30.99s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 95.55:  85%|████████▌ | 17/20 [09:13<01:32, 30.99s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 95.55:  90%|█████████ | 18/20 [09:13<00:59, 29.94s/it]
Task 6, Epoch 19/20 => Loss 0.111, Train_accy 95.43:  90%|█████████ | 18/20 [09:40<00:59, 29.94s/it]
Task 6, Epoch 19/20 => Loss 0.111, Train_accy 95.43:  95%|█████████▌| 19/20 [09:40<00:29, 29.14s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14:  95%|█████████▌| 19/20 [10:28<00:29, 29.14s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14: 100%|██████████| 20/20 [10:28<00:00, 34.61s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14: 100%|██████████| 20/20 [10:28<00:00, 31.42s/it]
2024-09-03 23:24:21,148 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14
2024-09-03 23:24:41,040 [trainer.py] => No NME accuracy.
2024-09-03 23:24:41,040 [trainer.py] => CNN: {'total': 91.14, '00-04': 97.2, '05-09': 92.0, '10-14': 93.2, '15-19': 91.0, '20-24': 94.0, '25-29': 92.6, '30-34': 78.0, 'old': 93.33, 'new': 78.0}
2024-09-03 23:24:41,041 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14]
2024-09-03 23:24:41,041 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83]

Average Accuracy (CNN): 95.58
2024-09-03 23:24:41,041 [trainer.py] => Average Accuracy (CNN): 95.58 

2024-09-03 23:24:41,042 [trainer.py] => All params: 89715556
2024-09-03 23:24:41,043 [trainer.py] => Trainable params: 89715556
2024-09-03 23:24:41,424 [coda_prompt.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.319, Train_accy 89.02:   0%|          | 0/20 [00:27<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.319, Train_accy 89.02:   5%|▌         | 1/20 [00:27<08:42, 27.49s/it]
Task 7, Epoch 2/20 => Loss 0.094, Train_accy 96.96:   5%|▌         | 1/20 [00:54<08:42, 27.49s/it]
Task 7, Epoch 2/20 => Loss 0.094, Train_accy 96.96:  10%|█         | 2/20 [00:54<08:12, 27.38s/it]
Task 7, Epoch 3/20 => Loss 0.074, Train_accy 97.52:  10%|█         | 2/20 [01:22<08:12, 27.38s/it]
Task 7, Epoch 3/20 => Loss 0.074, Train_accy 97.52:  15%|█▌        | 3/20 [01:22<07:46, 27.43s/it]
Task 7, Epoch 4/20 => Loss 0.084, Train_accy 96.92:  15%|█▌        | 3/20 [01:49<07:46, 27.43s/it]
Task 7, Epoch 4/20 => Loss 0.084, Train_accy 96.92:  20%|██        | 4/20 [01:49<07:19, 27.47s/it]
Task 7, Epoch 5/20 => Loss 0.084, Train_accy 97.00, Test_accy 90.40:  20%|██        | 4/20 [02:39<07:19, 27.47s/it]
Task 7, Epoch 5/20 => Loss 0.084, Train_accy 97.00, Test_accy 90.40:  25%|██▌       | 5/20 [02:39<08:54, 35.65s/it]
Task 7, Epoch 6/20 => Loss 0.056, Train_accy 98.04:  25%|██▌       | 5/20 [03:07<08:54, 35.65s/it]                 
Task 7, Epoch 6/20 => Loss 0.056, Train_accy 98.04:  30%|███       | 6/20 [03:07<07:40, 32.87s/it]
Task 7, Epoch 7/20 => Loss 0.062, Train_accy 98.08:  30%|███       | 6/20 [03:34<07:40, 32.87s/it]
Task 7, Epoch 7/20 => Loss 0.062, Train_accy 98.08:  35%|███▌      | 7/20 [03:34<06:44, 31.12s/it]
Task 7, Epoch 8/20 => Loss 0.054, Train_accy 98.08:  35%|███▌      | 7/20 [04:02<06:44, 31.12s/it]
Task 7, Epoch 8/20 => Loss 0.054, Train_accy 98.08:  40%|████      | 8/20 [04:02<05:59, 29.95s/it]
Task 7, Epoch 9/20 => Loss 0.072, Train_accy 97.64:  40%|████      | 8/20 [04:29<05:59, 29.95s/it]
Task 7, Epoch 9/20 => Loss 0.072, Train_accy 97.64:  45%|████▌     | 9/20 [04:29<05:20, 29.16s/it]
Task 7, Epoch 10/20 => Loss 0.060, Train_accy 98.00, Test_accy 90.55:  45%|████▌     | 9/20 [05:19<05:20, 29.16s/it]
Task 7, Epoch 10/20 => Loss 0.060, Train_accy 98.00, Test_accy 90.55:  50%|█████     | 10/20 [05:19<05:55, 35.59s/it]
Task 7, Epoch 11/20 => Loss 0.057, Train_accy 98.00:  50%|█████     | 10/20 [05:47<05:55, 35.59s/it]                 
Task 7, Epoch 11/20 => Loss 0.057, Train_accy 98.00:  55%|█████▌    | 11/20 [05:47<04:57, 33.10s/it]
Task 7, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  55%|█████▌    | 11/20 [06:14<04:57, 33.10s/it]
Task 7, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  60%|██████    | 12/20 [06:14<04:11, 31.38s/it]
Task 7, Epoch 13/20 => Loss 0.066, Train_accy 97.88:  60%|██████    | 12/20 [06:42<04:11, 31.38s/it]
Task 7, Epoch 13/20 => Loss 0.066, Train_accy 97.88:  65%|██████▌   | 13/20 [06:42<03:31, 30.19s/it]
Task 7, Epoch 14/20 => Loss 0.053, Train_accy 98.08:  65%|██████▌   | 13/20 [07:09<03:31, 30.19s/it]
Task 7, Epoch 14/20 => Loss 0.053, Train_accy 98.08:  70%|███████   | 14/20 [07:09<02:56, 29.39s/it]
Task 7, Epoch 15/20 => Loss 0.056, Train_accy 98.12, Test_accy 90.58:  70%|███████   | 14/20 [07:59<02:56, 29.39s/it]
Task 7, Epoch 15/20 => Loss 0.056, Train_accy 98.12, Test_accy 90.58:  75%|███████▌  | 15/20 [07:59<02:58, 35.66s/it]
Task 7, Epoch 16/20 => Loss 0.056, Train_accy 98.04:  75%|███████▌  | 15/20 [08:27<02:58, 35.66s/it]                 
Task 7, Epoch 16/20 => Loss 0.056, Train_accy 98.04:  80%|████████  | 16/20 [08:27<02:12, 33.22s/it]
Task 7, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  80%|████████  | 16/20 [08:54<02:12, 33.22s/it]
Task 7, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  85%|████████▌ | 17/20 [08:54<01:34, 31.51s/it]
Task 7, Epoch 18/20 => Loss 0.062, Train_accy 97.84:  85%|████████▌ | 17/20 [09:22<01:34, 31.51s/it]
Task 7, Epoch 18/20 => Loss 0.062, Train_accy 97.84:  90%|█████████ | 18/20 [09:22<01:00, 30.33s/it]
Task 7, Epoch 19/20 => Loss 0.059, Train_accy 98.12:  90%|█████████ | 18/20 [09:50<01:00, 30.33s/it]
Task 7, Epoch 19/20 => Loss 0.059, Train_accy 98.12:  95%|█████████▌| 19/20 [09:50<00:29, 29.48s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50:  95%|█████████▌| 19/20 [10:40<00:29, 29.48s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50: 100%|██████████| 20/20 [10:40<00:00, 35.68s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50: 100%|██████████| 20/20 [10:40<00:00, 32.01s/it]
2024-09-03 23:35:21,632 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50
2024-09-03 23:35:44,345 [trainer.py] => No NME accuracy.
2024-09-03 23:35:44,346 [trainer.py] => CNN: {'total': 90.5, '00-04': 96.8, '05-09': 91.8, '10-14': 91.8, '15-19': 89.8, '20-24': 93.6, '25-29': 90.4, '30-34': 77.2, '35-39': 92.6, 'old': 90.2, 'new': 92.6}
2024-09-03 23:35:44,346 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5]
2024-09-03 23:35:44,346 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65]

Average Accuracy (CNN): 94.95
2024-09-03 23:35:44,346 [trainer.py] => Average Accuracy (CNN): 94.95 

2024-09-03 23:35:44,347 [trainer.py] => All params: 89715556
2024-09-03 23:35:44,349 [trainer.py] => Trainable params: 89715556
2024-09-03 23:35:44,782 [coda_prompt.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.374, Train_accy 86.78:   0%|          | 0/20 [00:27<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.374, Train_accy 86.78:   5%|▌         | 1/20 [00:27<08:42, 27.47s/it]
Task 8, Epoch 2/20 => Loss 0.115, Train_accy 95.71:   5%|▌         | 1/20 [00:54<08:42, 27.47s/it]
Task 8, Epoch 2/20 => Loss 0.115, Train_accy 95.71:  10%|█         | 2/20 [00:54<08:14, 27.48s/it]
Task 8, Epoch 3/20 => Loss 0.107, Train_accy 96.71:  10%|█         | 2/20 [01:22<08:14, 27.48s/it]
Task 8, Epoch 3/20 => Loss 0.107, Train_accy 96.71:  15%|█▌        | 3/20 [01:22<07:47, 27.50s/it]
Task 8, Epoch 4/20 => Loss 0.092, Train_accy 97.08:  15%|█▌        | 3/20 [01:50<07:47, 27.50s/it]
Task 8, Epoch 4/20 => Loss 0.092, Train_accy 97.08:  20%|██        | 4/20 [01:50<07:20, 27.52s/it]
Task 8, Epoch 5/20 => Loss 0.093, Train_accy 96.55, Test_accy 88.82:  20%|██        | 4/20 [02:42<07:20, 27.52s/it]
Task 8, Epoch 5/20 => Loss 0.093, Train_accy 96.55, Test_accy 88.82:  25%|██▌       | 5/20 [02:42<09:09, 36.61s/it]
Task 8, Epoch 6/20 => Loss 0.072, Train_accy 97.76:  25%|██▌       | 5/20 [03:10<09:09, 36.61s/it]                 
Task 8, Epoch 6/20 => Loss 0.072, Train_accy 97.76:  30%|███       | 6/20 [03:10<07:48, 33.50s/it]
Task 8, Epoch 7/20 => Loss 0.078, Train_accy 97.20:  30%|███       | 6/20 [03:37<07:48, 33.50s/it]
Task 8, Epoch 7/20 => Loss 0.078, Train_accy 97.20:  35%|███▌      | 7/20 [03:37<06:49, 31.51s/it]
Task 8, Epoch 8/20 => Loss 0.082, Train_accy 97.28:  35%|███▌      | 7/20 [04:05<06:49, 31.51s/it]
Task 8, Epoch 8/20 => Loss 0.082, Train_accy 97.28:  40%|████      | 8/20 [04:05<06:02, 30.22s/it]
Task 8, Epoch 9/20 => Loss 0.086, Train_accy 97.40:  40%|████      | 8/20 [04:32<06:02, 30.22s/it]
Task 8, Epoch 9/20 => Loss 0.086, Train_accy 97.40:  45%|████▌     | 9/20 [04:32<05:22, 29.36s/it]
Task 8, Epoch 10/20 => Loss 0.079, Train_accy 97.52, Test_accy 88.78:  45%|████▌     | 9/20 [05:25<05:22, 29.36s/it]
Task 8, Epoch 10/20 => Loss 0.079, Train_accy 97.52, Test_accy 88.78:  50%|█████     | 10/20 [05:25<06:05, 36.59s/it]
Task 8, Epoch 11/20 => Loss 0.080, Train_accy 97.04:  50%|█████     | 10/20 [05:52<06:05, 36.59s/it]                 
Task 8, Epoch 11/20 => Loss 0.080, Train_accy 97.04:  55%|█████▌    | 11/20 [05:52<05:04, 33.78s/it]
Task 8, Epoch 12/20 => Loss 0.080, Train_accy 97.60:  55%|█████▌    | 11/20 [06:20<05:04, 33.78s/it]
Task 8, Epoch 12/20 => Loss 0.080, Train_accy 97.60:  60%|██████    | 12/20 [06:20<04:14, 31.85s/it]
Task 8, Epoch 13/20 => Loss 0.082, Train_accy 97.24:  60%|██████    | 12/20 [06:47<04:14, 31.85s/it]
Task 8, Epoch 13/20 => Loss 0.082, Train_accy 97.24:  65%|██████▌   | 13/20 [06:47<03:33, 30.52s/it]
Task 8, Epoch 14/20 => Loss 0.066, Train_accy 97.60:  65%|██████▌   | 13/20 [07:15<03:33, 30.52s/it]
Task 8, Epoch 14/20 => Loss 0.066, Train_accy 97.60:  70%|███████   | 14/20 [07:15<02:57, 29.63s/it]
Task 8, Epoch 15/20 => Loss 0.068, Train_accy 97.56, Test_accy 89.07:  70%|███████   | 14/20 [08:08<02:57, 29.63s/it]
Task 8, Epoch 15/20 => Loss 0.068, Train_accy 97.56, Test_accy 89.07:  75%|███████▌  | 15/20 [08:08<03:03, 36.66s/it]
Task 8, Epoch 16/20 => Loss 0.069, Train_accy 97.64:  75%|███████▌  | 15/20 [08:35<03:03, 36.66s/it]                 
Task 8, Epoch 16/20 => Loss 0.069, Train_accy 97.64:  80%|████████  | 16/20 [08:35<02:15, 33.90s/it]
Task 8, Epoch 17/20 => Loss 0.069, Train_accy 97.92:  80%|████████  | 16/20 [09:03<02:15, 33.90s/it]
Task 8, Epoch 17/20 => Loss 0.069, Train_accy 97.92:  85%|████████▌ | 17/20 [09:03<01:35, 31.98s/it]
Task 8, Epoch 18/20 => Loss 0.075, Train_accy 97.48:  85%|████████▌ | 17/20 [09:30<01:35, 31.98s/it]
Task 8, Epoch 18/20 => Loss 0.075, Train_accy 97.48:  90%|█████████ | 18/20 [09:30<01:01, 30.64s/it]
Task 8, Epoch 19/20 => Loss 0.063, Train_accy 98.04:  90%|█████████ | 18/20 [09:58<01:01, 30.64s/it]
Task 8, Epoch 19/20 => Loss 0.063, Train_accy 98.04:  95%|█████████▌| 19/20 [09:58<00:29, 29.70s/it]
Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13:  95%|█████████▌| 19/20 [10:51<00:29, 29.70s/it]
Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13: 100%|██████████| 20/20 [10:51<00:00, 36.68s/it]
Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13: 100%|██████████| 20/20 [10:51<00:00, 32.56s/it]
2024-09-03 23:46:35,977 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13
2024-09-03 23:47:01,390 [trainer.py] => No NME accuracy.
2024-09-03 23:47:01,391 [trainer.py] => CNN: {'total': 89.13, '00-04': 93.8, '05-09': 90.6, '10-14': 87.6, '15-19': 89.4, '20-24': 94.6, '25-29': 89.6, '30-34': 76.0, '35-39': 93.0, '40-44': 87.6, 'old': 89.32, 'new': 87.6}
2024-09-03 23:47:01,391 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13]
2024-09-03 23:47:01,391 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53]

Average Accuracy (CNN): 94.3
2024-09-03 23:47:01,391 [trainer.py] => Average Accuracy (CNN): 94.3 

2024-09-03 23:47:01,393 [trainer.py] => All params: 89715556
2024-09-03 23:47:01,394 [trainer.py] => Trainable params: 89715556
2024-09-03 23:47:01,870 [coda_prompt.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.349, Train_accy 89.38:   0%|          | 0/20 [00:27<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.349, Train_accy 89.38:   5%|▌         | 1/20 [00:27<08:41, 27.47s/it]
Task 9, Epoch 2/20 => Loss 0.054, Train_accy 98.08:   5%|▌         | 1/20 [00:54<08:41, 27.47s/it]
Task 9, Epoch 2/20 => Loss 0.054, Train_accy 98.08:  10%|█         | 2/20 [00:54<08:14, 27.45s/it]
Task 9, Epoch 3/20 => Loss 0.054, Train_accy 98.08:  10%|█         | 2/20 [01:22<08:14, 27.45s/it]
Task 9, Epoch 3/20 => Loss 0.054, Train_accy 98.08:  15%|█▌        | 3/20 [01:22<07:46, 27.43s/it]
Task 9, Epoch 4/20 => Loss 0.053, Train_accy 98.20:  15%|█▌        | 3/20 [01:49<07:46, 27.43s/it]
Task 9, Epoch 4/20 => Loss 0.053, Train_accy 98.20:  20%|██        | 4/20 [01:49<07:19, 27.44s/it]
Task 9, Epoch 5/20 => Loss 0.039, Train_accy 98.84, Test_accy 87.90:  20%|██        | 4/20 [02:45<07:19, 27.44s/it]
Task 9, Epoch 5/20 => Loss 0.039, Train_accy 98.84, Test_accy 87.90:  25%|██▌       | 5/20 [02:45<09:24, 37.60s/it]
Task 9, Epoch 6/20 => Loss 0.044, Train_accy 98.40:  25%|██▌       | 5/20 [03:12<09:24, 37.60s/it]                 
Task 9, Epoch 6/20 => Loss 0.044, Train_accy 98.40:  30%|███       | 6/20 [03:12<07:58, 34.19s/it]
Task 9, Epoch 7/20 => Loss 0.044, Train_accy 98.52:  30%|███       | 6/20 [03:40<07:58, 34.19s/it]
Task 9, Epoch 7/20 => Loss 0.044, Train_accy 98.52:  35%|███▌      | 7/20 [03:40<06:56, 32.01s/it]
Task 9, Epoch 8/20 => Loss 0.053, Train_accy 98.40:  35%|███▌      | 7/20 [04:07<06:56, 32.01s/it]
Task 9, Epoch 8/20 => Loss 0.053, Train_accy 98.40:  40%|████      | 8/20 [04:07<06:06, 30.57s/it]
Task 9, Epoch 9/20 => Loss 0.052, Train_accy 98.56:  40%|████      | 8/20 [04:35<06:06, 30.57s/it]
Task 9, Epoch 9/20 => Loss 0.052, Train_accy 98.56:  45%|████▌     | 9/20 [04:35<05:25, 29.60s/it]
Task 9, Epoch 10/20 => Loss 0.037, Train_accy 98.76, Test_accy 87.92:  45%|████▌     | 9/20 [05:31<05:25, 29.60s/it]
Task 9, Epoch 10/20 => Loss 0.037, Train_accy 98.76, Test_accy 87.92:  50%|█████     | 10/20 [05:31<06:16, 37.66s/it]
Task 9, Epoch 11/20 => Loss 0.032, Train_accy 98.76:  50%|█████     | 10/20 [05:58<06:16, 37.66s/it]                 
Task 9, Epoch 11/20 => Loss 0.032, Train_accy 98.76:  55%|█████▌    | 11/20 [05:58<05:10, 34.55s/it]
Task 9, Epoch 12/20 => Loss 0.040, Train_accy 98.56:  55%|█████▌    | 11/20 [06:26<05:10, 34.55s/it]
Task 9, Epoch 12/20 => Loss 0.040, Train_accy 98.56:  60%|██████    | 12/20 [06:26<04:19, 32.41s/it]
Task 9, Epoch 13/20 => Loss 0.037, Train_accy 98.36:  60%|██████    | 12/20 [06:53<04:19, 32.41s/it]
Task 9, Epoch 13/20 => Loss 0.037, Train_accy 98.36:  65%|██████▌   | 13/20 [06:53<03:36, 30.95s/it]
Task 9, Epoch 14/20 => Loss 0.041, Train_accy 98.24:  65%|██████▌   | 13/20 [07:21<03:36, 30.95s/it]
Task 9, Epoch 14/20 => Loss 0.041, Train_accy 98.24:  70%|███████   | 14/20 [07:21<02:59, 29.91s/it]
Task 9, Epoch 15/20 => Loss 0.037, Train_accy 98.84, Test_accy 88.00:  70%|███████   | 14/20 [08:17<02:59, 29.91s/it]
Task 9, Epoch 15/20 => Loss 0.037, Train_accy 98.84, Test_accy 88.00:  75%|███████▌  | 15/20 [08:17<03:08, 37.71s/it]
Task 9, Epoch 16/20 => Loss 0.044, Train_accy 98.68:  75%|███████▌  | 15/20 [08:44<03:08, 37.71s/it]                 
Task 9, Epoch 16/20 => Loss 0.044, Train_accy 98.68:  80%|████████  | 16/20 [08:44<02:18, 34.64s/it]
Task 9, Epoch 17/20 => Loss 0.030, Train_accy 98.88:  80%|████████  | 16/20 [09:12<02:18, 34.64s/it]
Task 9, Epoch 17/20 => Loss 0.030, Train_accy 98.88:  85%|████████▌ | 17/20 [09:12<01:37, 32.50s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.36:  85%|████████▌ | 17/20 [09:39<01:37, 32.50s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.36:  90%|█████████ | 18/20 [09:39<01:02, 31.00s/it]
Task 9, Epoch 19/20 => Loss 0.039, Train_accy 98.72:  90%|█████████ | 18/20 [10:07<01:02, 31.00s/it]
Task 9, Epoch 19/20 => Loss 0.039, Train_accy 98.72:  95%|█████████▌| 19/20 [10:07<00:29, 29.96s/it]
Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08:  95%|█████████▌| 19/20 [11:02<00:29, 29.96s/it]
Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08: 100%|██████████| 20/20 [11:02<00:00, 37.69s/it]
Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08: 100%|██████████| 20/20 [11:02<00:00, 33.14s/it]
2024-09-03 23:58:04,705 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08
2024-09-03 23:58:32,927 [trainer.py] => No NME accuracy.
2024-09-03 23:58:32,928 [trainer.py] => CNN: {'total': 88.08, '00-04': 94.2, '05-09': 91.2, '10-14': 87.0, '15-19': 89.0, '20-24': 93.8, '25-29': 88.6, '30-34': 76.4, '35-39': 89.2, '40-44': 86.4, '45-49': 85.0, 'old': 88.42, 'new': 85.0}
2024-09-03 23:58:32,928 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08]
2024-09-03 23:58:32,928 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42]

Average Accuracy (CNN): 93.68
2024-09-03 23:58:32,928 [trainer.py] => Average Accuracy (CNN): 93.68 

2024-09-03 23:58:32,930 [trainer.py] => All params: 89715556
2024-09-03 23:58:32,931 [trainer.py] => Trainable params: 89715556
2024-09-03 23:58:33,473 [coda_prompt.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.292, Train_accy 89.58:   0%|          | 0/20 [00:27<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.292, Train_accy 89.58:   5%|▌         | 1/20 [00:27<08:42, 27.50s/it]
Task 10, Epoch 2/20 => Loss 0.092, Train_accy 96.92:   5%|▌         | 1/20 [00:54<08:42, 27.50s/it]
Task 10, Epoch 2/20 => Loss 0.092, Train_accy 96.92:  10%|█         | 2/20 [00:54<08:14, 27.47s/it]
Task 10, Epoch 3/20 => Loss 0.075, Train_accy 97.24:  10%|█         | 2/20 [01:22<08:14, 27.47s/it]
Task 10, Epoch 3/20 => Loss 0.075, Train_accy 97.24:  15%|█▌        | 3/20 [01:22<07:46, 27.46s/it]
Task 10, Epoch 4/20 => Loss 0.063, Train_accy 97.68:  15%|█▌        | 3/20 [01:49<07:46, 27.46s/it]
Task 10, Epoch 4/20 => Loss 0.063, Train_accy 97.68:  20%|██        | 4/20 [01:49<07:19, 27.46s/it]
Task 10, Epoch 5/20 => Loss 0.079, Train_accy 97.48, Test_accy 86.76:  20%|██        | 4/20 [02:48<07:19, 27.46s/it]
Task 10, Epoch 5/20 => Loss 0.079, Train_accy 97.48, Test_accy 86.76:  25%|██▌       | 5/20 [02:48<09:39, 38.62s/it]
Task 10, Epoch 6/20 => Loss 0.059, Train_accy 97.88:  25%|██▌       | 5/20 [03:15<09:39, 38.62s/it]                 
Task 10, Epoch 6/20 => Loss 0.059, Train_accy 97.88:  30%|███       | 6/20 [03:15<08:07, 34.82s/it]
Task 10, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  30%|███       | 6/20 [03:43<08:07, 34.82s/it]
Task 10, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  35%|███▌      | 7/20 [03:43<07:01, 32.43s/it]
Task 10, Epoch 8/20 => Loss 0.073, Train_accy 97.64:  35%|███▌      | 7/20 [04:10<07:01, 32.43s/it]
Task 10, Epoch 8/20 => Loss 0.073, Train_accy 97.64:  40%|████      | 8/20 [04:10<06:10, 30.86s/it]
Task 10, Epoch 9/20 => Loss 0.062, Train_accy 98.00:  40%|████      | 8/20 [04:38<06:10, 30.86s/it]
Task 10, Epoch 9/20 => Loss 0.062, Train_accy 98.00:  45%|████▌     | 9/20 [04:38<05:27, 29.81s/it]
Task 10, Epoch 10/20 => Loss 0.069, Train_accy 97.52, Test_accy 87.04:  45%|████▌     | 9/20 [05:36<05:27, 29.81s/it]
Task 10, Epoch 10/20 => Loss 0.069, Train_accy 97.52, Test_accy 87.04:  50%|█████     | 10/20 [05:36<06:26, 38.62s/it]
Task 10, Epoch 11/20 => Loss 0.068, Train_accy 97.76:  50%|█████     | 10/20 [06:04<06:26, 38.62s/it]                 
Task 10, Epoch 11/20 => Loss 0.068, Train_accy 97.76:  55%|█████▌    | 11/20 [06:04<05:16, 35.22s/it]
Task 10, Epoch 12/20 => Loss 0.063, Train_accy 97.84:  55%|█████▌    | 11/20 [06:31<05:16, 35.22s/it]
Task 10, Epoch 12/20 => Loss 0.063, Train_accy 97.84:  60%|██████    | 12/20 [06:31<04:22, 32.86s/it]
Task 10, Epoch 13/20 => Loss 0.054, Train_accy 97.88:  60%|██████    | 12/20 [06:59<04:22, 32.86s/it]
Task 10, Epoch 13/20 => Loss 0.054, Train_accy 97.88:  65%|██████▌   | 13/20 [06:59<03:38, 31.24s/it]
Task 10, Epoch 14/20 => Loss 0.051, Train_accy 98.12:  65%|██████▌   | 13/20 [07:26<03:38, 31.24s/it]
Task 10, Epoch 14/20 => Loss 0.051, Train_accy 98.12:  70%|███████   | 14/20 [07:26<03:00, 30.10s/it]
Task 10, Epoch 15/20 => Loss 0.055, Train_accy 98.32, Test_accy 87.02:  70%|███████   | 14/20 [08:24<03:00, 30.10s/it]
Task 10, Epoch 15/20 => Loss 0.055, Train_accy 98.32, Test_accy 87.02:  75%|███████▌  | 15/20 [08:24<03:13, 38.62s/it]
Task 10, Epoch 16/20 => Loss 0.043, Train_accy 98.36:  75%|███████▌  | 15/20 [08:52<03:13, 38.62s/it]                 
Task 10, Epoch 16/20 => Loss 0.043, Train_accy 98.36:  80%|████████  | 16/20 [08:52<02:21, 35.26s/it]
Task 10, Epoch 17/20 => Loss 0.050, Train_accy 98.28:  80%|████████  | 16/20 [09:19<02:21, 35.26s/it]
Task 10, Epoch 17/20 => Loss 0.050, Train_accy 98.28:  85%|████████▌ | 17/20 [09:19<01:38, 32.92s/it]
Task 10, Epoch 18/20 => Loss 0.050, Train_accy 98.40:  85%|████████▌ | 17/20 [09:47<01:38, 32.92s/it]
Task 10, Epoch 18/20 => Loss 0.050, Train_accy 98.40:  90%|█████████ | 18/20 [09:47<01:02, 31.27s/it]
Task 10, Epoch 19/20 => Loss 0.049, Train_accy 98.28:  90%|█████████ | 18/20 [10:14<01:02, 31.27s/it]
Task 10, Epoch 19/20 => Loss 0.049, Train_accy 98.28:  95%|█████████▌| 19/20 [10:14<00:30, 30.15s/it]
Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07:  95%|█████████▌| 19/20 [11:13<00:30, 30.15s/it]
Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07: 100%|██████████| 20/20 [11:13<00:00, 38.69s/it]
Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07: 100%|██████████| 20/20 [11:13<00:00, 33.67s/it]
2024-09-04 00:09:46,865 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07
2024-09-04 00:10:17,895 [trainer.py] => No NME accuracy.
2024-09-04 00:10:17,896 [trainer.py] => CNN: {'total': 87.07, '00-04': 92.4, '05-09': 90.8, '10-14': 87.0, '15-19': 88.8, '20-24': 93.8, '25-29': 87.2, '30-34': 74.8, '35-39': 87.4, '40-44': 86.2, '45-49': 80.8, '50-54': 88.6, 'old': 86.92, 'new': 88.6}
2024-09-04 00:10:17,896 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07]
2024-09-04 00:10:17,896 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4]

Average Accuracy (CNN): 93.08
2024-09-04 00:10:17,896 [trainer.py] => Average Accuracy (CNN): 93.08 

2024-09-04 00:10:17,897 [trainer.py] => All params: 89715556
2024-09-04 00:10:17,898 [trainer.py] => Trainable params: 89715556
2024-09-04 00:10:18,476 [coda_prompt.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.631, Train_accy 77.28:   0%|          | 0/20 [00:27<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.631, Train_accy 77.28:   5%|▌         | 1/20 [00:27<08:43, 27.55s/it]
Task 11, Epoch 2/20 => Loss 0.228, Train_accy 90.67:   5%|▌         | 1/20 [00:55<08:43, 27.55s/it]
Task 11, Epoch 2/20 => Loss 0.228, Train_accy 90.67:  10%|█         | 2/20 [00:55<08:15, 27.54s/it]
Task 11, Epoch 3/20 => Loss 0.197, Train_accy 91.99:  10%|█         | 2/20 [01:22<08:15, 27.54s/it]
Task 11, Epoch 3/20 => Loss 0.197, Train_accy 91.99:  15%|█▌        | 3/20 [01:22<07:48, 27.55s/it]
Task 11, Epoch 4/20 => Loss 0.193, Train_accy 93.19:  15%|█▌        | 3/20 [01:50<07:48, 27.55s/it]
Task 11, Epoch 4/20 => Loss 0.193, Train_accy 93.19:  20%|██        | 4/20 [01:50<07:20, 27.56s/it]
Task 11, Epoch 5/20 => Loss 0.186, Train_accy 93.15, Test_accy 86.72:  20%|██        | 4/20 [02:51<07:20, 27.56s/it]
Task 11, Epoch 5/20 => Loss 0.186, Train_accy 93.15, Test_accy 86.72:  25%|██▌       | 5/20 [02:51<09:56, 39.75s/it]
Task 11, Epoch 6/20 => Loss 0.167, Train_accy 94.03:  25%|██▌       | 5/20 [03:19<09:56, 39.75s/it]                 
Task 11, Epoch 6/20 => Loss 0.167, Train_accy 94.03:  30%|███       | 6/20 [03:19<08:18, 35.59s/it]
Task 11, Epoch 7/20 => Loss 0.188, Train_accy 92.55:  30%|███       | 6/20 [03:46<08:18, 35.59s/it]
Task 11, Epoch 7/20 => Loss 0.188, Train_accy 92.55:  35%|███▌      | 7/20 [03:46<07:08, 32.95s/it]
Task 11, Epoch 8/20 => Loss 0.154, Train_accy 94.07:  35%|███▌      | 7/20 [04:14<07:08, 32.95s/it]
Task 11, Epoch 8/20 => Loss 0.154, Train_accy 94.07:  40%|████      | 8/20 [04:14<06:14, 31.21s/it]
Task 11, Epoch 9/20 => Loss 0.178, Train_accy 93.39:  40%|████      | 8/20 [04:41<06:14, 31.21s/it]
Task 11, Epoch 9/20 => Loss 0.178, Train_accy 93.39:  45%|████▌     | 9/20 [04:41<05:30, 30.04s/it]
Task 11, Epoch 10/20 => Loss 0.173, Train_accy 93.31, Test_accy 86.87:  45%|████▌     | 9/20 [05:42<05:30, 30.04s/it]
Task 11, Epoch 10/20 => Loss 0.173, Train_accy 93.31, Test_accy 86.87:  50%|█████     | 10/20 [05:42<06:36, 39.68s/it]
Task 11, Epoch 11/20 => Loss 0.154, Train_accy 94.03:  50%|█████     | 10/20 [06:10<06:36, 39.68s/it]                 
Task 11, Epoch 11/20 => Loss 0.154, Train_accy 94.03:  55%|█████▌    | 11/20 [06:10<05:23, 35.93s/it]
Task 11, Epoch 12/20 => Loss 0.162, Train_accy 93.55:  55%|█████▌    | 11/20 [06:37<05:23, 35.93s/it]
Task 11, Epoch 12/20 => Loss 0.162, Train_accy 93.55:  60%|██████    | 12/20 [06:37<04:26, 33.36s/it]
Task 11, Epoch 13/20 => Loss 0.159, Train_accy 93.79:  60%|██████    | 12/20 [07:05<04:26, 33.36s/it]
Task 11, Epoch 13/20 => Loss 0.159, Train_accy 93.79:  65%|██████▌   | 13/20 [07:05<03:41, 31.57s/it]
Task 11, Epoch 14/20 => Loss 0.150, Train_accy 94.71:  65%|██████▌   | 13/20 [07:32<03:41, 31.57s/it]
Task 11, Epoch 14/20 => Loss 0.150, Train_accy 94.71:  70%|███████   | 14/20 [07:32<03:01, 30.31s/it]
Task 11, Epoch 15/20 => Loss 0.157, Train_accy 93.87, Test_accy 86.98:  70%|███████   | 14/20 [08:33<03:01, 30.31s/it]
Task 11, Epoch 15/20 => Loss 0.157, Train_accy 93.87, Test_accy 86.98:  75%|███████▌  | 15/20 [08:33<03:18, 39.62s/it]
Task 11, Epoch 16/20 => Loss 0.137, Train_accy 94.87:  75%|███████▌  | 15/20 [09:01<03:18, 39.62s/it]                 
Task 11, Epoch 16/20 => Loss 0.137, Train_accy 94.87:  80%|████████  | 16/20 [09:01<02:23, 35.97s/it]
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 94.59:  80%|████████  | 16/20 [09:28<02:23, 35.97s/it]
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 94.59:  85%|████████▌ | 17/20 [09:28<01:40, 33.42s/it]
Task 11, Epoch 18/20 => Loss 0.152, Train_accy 94.03:  85%|████████▌ | 17/20 [09:56<01:40, 33.42s/it]
Task 11, Epoch 18/20 => Loss 0.152, Train_accy 94.03:  90%|█████████ | 18/20 [09:56<01:03, 31.66s/it]
Task 11, Epoch 19/20 => Loss 0.158, Train_accy 94.19:  90%|█████████ | 18/20 [10:23<01:03, 31.66s/it]
Task 11, Epoch 19/20 => Loss 0.158, Train_accy 94.19:  95%|█████████▌| 19/20 [10:23<00:30, 30.43s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93:  95%|█████████▌| 19/20 [11:25<00:30, 30.43s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93: 100%|██████████| 20/20 [11:25<00:00, 39.72s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93: 100%|██████████| 20/20 [11:25<00:00, 34.26s/it]
2024-09-04 00:21:43,776 [coda_prompt.py] => Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93
2024-09-04 00:22:17,544 [trainer.py] => No NME accuracy.
2024-09-04 00:22:17,544 [trainer.py] => CNN: {'total': 86.93, '00-04': 93.4, '05-09': 91.0, '10-14': 87.8, '15-19': 88.4, '20-24': 92.0, '25-29': 89.6, '30-34': 75.4, '35-39': 87.2, '40-44': 84.6, '45-49': 80.2, '50-54': 86.4, '55-59': 87.2, 'old': 86.91, 'new': 87.2}
2024-09-04 00:22:17,544 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93]
2024-09-04 00:22:17,544 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15]

Average Accuracy (CNN): 92.57
2024-09-04 00:22:17,545 [trainer.py] => Average Accuracy (CNN): 92.57 

2024-09-04 00:22:17,545 [trainer.py] => All params: 89715556
2024-09-04 00:22:17,546 [trainer.py] => Trainable params: 89715556
2024-09-04 00:22:18,173 [coda_prompt.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.231, Train_accy 92.03:   0%|          | 0/20 [00:27<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.231, Train_accy 92.03:   5%|▌         | 1/20 [00:27<08:42, 27.52s/it]
Task 12, Epoch 2/20 => Loss 0.094, Train_accy 96.92:   5%|▌         | 1/20 [00:55<08:42, 27.52s/it]
Task 12, Epoch 2/20 => Loss 0.094, Train_accy 96.92:  10%|█         | 2/20 [00:55<08:15, 27.54s/it]
Task 12, Epoch 3/20 => Loss 0.067, Train_accy 97.88:  10%|█         | 2/20 [01:22<08:15, 27.54s/it]
Task 12, Epoch 3/20 => Loss 0.067, Train_accy 97.88:  15%|█▌        | 3/20 [01:22<07:48, 27.55s/it]
Task 12, Epoch 4/20 => Loss 0.067, Train_accy 97.76:  15%|█▌        | 3/20 [01:50<07:48, 27.55s/it]
Task 12, Epoch 4/20 => Loss 0.067, Train_accy 97.76:  20%|██        | 4/20 [01:50<07:20, 27.56s/it]
Task 12, Epoch 5/20 => Loss 0.052, Train_accy 98.00, Test_accy 85.82:  20%|██        | 4/20 [02:54<07:20, 27.56s/it]
Task 12, Epoch 5/20 => Loss 0.052, Train_accy 98.00, Test_accy 85.82:  25%|██▌       | 5/20 [02:54<10:10, 40.72s/it]
Task 12, Epoch 6/20 => Loss 0.067, Train_accy 97.56:  25%|██▌       | 5/20 [03:21<10:10, 40.72s/it]                 
Task 12, Epoch 6/20 => Loss 0.067, Train_accy 97.56:  30%|███       | 6/20 [03:21<08:27, 36.23s/it]
Task 12, Epoch 7/20 => Loss 0.070, Train_accy 97.64:  30%|███       | 6/20 [03:49<08:27, 36.23s/it]
Task 12, Epoch 7/20 => Loss 0.070, Train_accy 97.64:  35%|███▌      | 7/20 [03:49<07:13, 33.36s/it]
Task 12, Epoch 8/20 => Loss 0.048, Train_accy 98.20:  35%|███▌      | 7/20 [04:16<07:13, 33.36s/it]
Task 12, Epoch 8/20 => Loss 0.048, Train_accy 98.20:  40%|████      | 8/20 [04:16<06:18, 31.50s/it]
Task 12, Epoch 9/20 => Loss 0.058, Train_accy 97.92:  40%|████      | 8/20 [04:44<06:18, 31.50s/it]
Task 12, Epoch 9/20 => Loss 0.058, Train_accy 97.92:  45%|████▌     | 9/20 [04:44<05:32, 30.25s/it]
Task 12, Epoch 10/20 => Loss 0.070, Train_accy 97.76, Test_accy 85.80:  45%|████▌     | 9/20 [05:48<05:32, 30.25s/it]
Task 12, Epoch 10/20 => Loss 0.070, Train_accy 97.76, Test_accy 85.80:  50%|█████     | 10/20 [05:48<06:47, 40.73s/it]
Task 12, Epoch 11/20 => Loss 0.053, Train_accy 98.08:  50%|█████     | 10/20 [06:15<06:47, 40.73s/it]                 
Task 12, Epoch 11/20 => Loss 0.053, Train_accy 98.08:  55%|█████▌    | 11/20 [06:15<05:29, 36.66s/it]
Task 12, Epoch 12/20 => Loss 0.047, Train_accy 98.28:  55%|█████▌    | 11/20 [06:43<05:29, 36.66s/it]
Task 12, Epoch 12/20 => Loss 0.047, Train_accy 98.28:  60%|██████    | 12/20 [06:43<04:30, 33.86s/it]
Task 12, Epoch 13/20 => Loss 0.050, Train_accy 98.28:  60%|██████    | 12/20 [07:10<04:30, 33.86s/it]
Task 12, Epoch 13/20 => Loss 0.050, Train_accy 98.28:  65%|██████▌   | 13/20 [07:10<03:43, 31.94s/it]
Task 12, Epoch 14/20 => Loss 0.055, Train_accy 98.16:  65%|██████▌   | 13/20 [07:38<03:43, 31.94s/it]
Task 12, Epoch 14/20 => Loss 0.055, Train_accy 98.16:  70%|███████   | 14/20 [07:38<03:03, 30.63s/it]
Task 12, Epoch 15/20 => Loss 0.047, Train_accy 98.44, Test_accy 85.43:  70%|███████   | 14/20 [08:42<03:03, 30.63s/it]
Task 12, Epoch 15/20 => Loss 0.047, Train_accy 98.44, Test_accy 85.43:  75%|███████▌  | 15/20 [08:42<03:23, 40.73s/it]
Task 12, Epoch 16/20 => Loss 0.052, Train_accy 98.28:  75%|███████▌  | 15/20 [09:10<03:23, 40.73s/it]                 
Task 12, Epoch 16/20 => Loss 0.052, Train_accy 98.28:  80%|████████  | 16/20 [09:10<02:26, 36.75s/it]
Task 12, Epoch 17/20 => Loss 0.065, Train_accy 97.76:  80%|████████  | 16/20 [09:37<02:26, 36.75s/it]
Task 12, Epoch 17/20 => Loss 0.065, Train_accy 97.76:  85%|████████▌ | 17/20 [09:37<01:41, 33.96s/it]
Task 12, Epoch 18/20 => Loss 0.052, Train_accy 98.48:  85%|████████▌ | 17/20 [10:05<01:41, 33.96s/it]
Task 12, Epoch 18/20 => Loss 0.052, Train_accy 98.48:  90%|█████████ | 18/20 [10:05<01:04, 32.02s/it]
Task 12, Epoch 19/20 => Loss 0.051, Train_accy 98.08:  90%|█████████ | 18/20 [10:32<01:04, 32.02s/it]
Task 12, Epoch 19/20 => Loss 0.051, Train_accy 98.08:  95%|█████████▌| 19/20 [10:32<00:30, 30.66s/it]
Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60:  95%|█████████▌| 19/20 [11:36<00:30, 30.66s/it]
Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60: 100%|██████████| 20/20 [11:36<00:00, 40.66s/it]
Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60: 100%|██████████| 20/20 [11:36<00:00, 34.83s/it]
2024-09-04 00:33:54,730 [coda_prompt.py] => Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60
2024-09-04 00:34:31,317 [trainer.py] => No NME accuracy.
2024-09-04 00:34:31,317 [trainer.py] => CNN: {'total': 85.6, '00-04': 93.2, '05-09': 91.0, '10-14': 86.8, '15-19': 82.2, '20-24': 92.8, '25-29': 86.6, '30-34': 74.8, '35-39': 87.2, '40-44': 84.8, '45-49': 80.4, '50-54': 87.2, '55-59': 72.6, '60-64': 93.2, 'old': 84.97, 'new': 93.2}
2024-09-04 00:34:31,317 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6]
2024-09-04 00:34:31,317 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02]

Average Accuracy (CNN): 92.03
2024-09-04 00:34:31,318 [trainer.py] => Average Accuracy (CNN): 92.03 

2024-09-04 00:34:31,319 [trainer.py] => All params: 89715556
2024-09-04 00:34:31,320 [trainer.py] => Trainable params: 89715556
2024-09-04 00:34:31,996 [coda_prompt.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.295, Train_accy 89.34:   0%|          | 0/20 [00:27<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.295, Train_accy 89.34:   5%|▌         | 1/20 [00:27<08:42, 27.51s/it]
Task 13, Epoch 2/20 => Loss 0.067, Train_accy 97.92:   5%|▌         | 1/20 [00:54<08:42, 27.51s/it]
Task 13, Epoch 2/20 => Loss 0.067, Train_accy 97.92:  10%|█         | 2/20 [00:54<08:14, 27.50s/it]
Task 13, Epoch 3/20 => Loss 0.057, Train_accy 98.12:  10%|█         | 2/20 [01:22<08:14, 27.50s/it]
Task 13, Epoch 3/20 => Loss 0.057, Train_accy 98.12:  15%|█▌        | 3/20 [01:22<07:47, 27.49s/it]
Task 13, Epoch 4/20 => Loss 0.054, Train_accy 98.04:  15%|█▌        | 3/20 [01:49<07:47, 27.49s/it]
Task 13, Epoch 4/20 => Loss 0.054, Train_accy 98.04:  20%|██        | 4/20 [01:49<07:19, 27.50s/it]
Task 13, Epoch 5/20 => Loss 0.045, Train_accy 98.44, Test_accy 85.30:  20%|██        | 4/20 [02:56<07:19, 27.50s/it]
Task 13, Epoch 5/20 => Loss 0.045, Train_accy 98.44, Test_accy 85.30:  25%|██▌       | 5/20 [02:56<10:24, 41.66s/it]
Task 13, Epoch 6/20 => Loss 0.040, Train_accy 98.64:  25%|██▌       | 5/20 [03:24<10:24, 41.66s/it]                 
Task 13, Epoch 6/20 => Loss 0.040, Train_accy 98.64:  30%|███       | 6/20 [03:24<08:36, 36.88s/it]
Task 13, Epoch 7/20 => Loss 0.058, Train_accy 98.12:  30%|███       | 6/20 [03:51<08:36, 36.88s/it]
Task 13, Epoch 7/20 => Loss 0.058, Train_accy 98.12:  35%|███▌      | 7/20 [03:51<07:19, 33.82s/it]
Task 13, Epoch 8/20 => Loss 0.056, Train_accy 98.16:  35%|███▌      | 7/20 [04:19<07:19, 33.82s/it]
Task 13, Epoch 8/20 => Loss 0.056, Train_accy 98.16:  40%|████      | 8/20 [04:19<06:21, 31.83s/it]
Task 13, Epoch 9/20 => Loss 0.035, Train_accy 98.60:  40%|████      | 8/20 [04:46<06:21, 31.83s/it]
Task 13, Epoch 9/20 => Loss 0.035, Train_accy 98.60:  45%|████▌     | 9/20 [04:46<05:35, 30.49s/it]
Task 13, Epoch 10/20 => Loss 0.043, Train_accy 98.72, Test_accy 85.37:  45%|████▌     | 9/20 [05:54<05:35, 30.49s/it]
Task 13, Epoch 10/20 => Loss 0.043, Train_accy 98.72, Test_accy 85.37:  50%|█████     | 10/20 [05:54<06:57, 41.77s/it]
Task 13, Epoch 11/20 => Loss 0.036, Train_accy 98.80:  50%|█████     | 10/20 [06:21<06:57, 41.77s/it]                 
Task 13, Epoch 11/20 => Loss 0.036, Train_accy 98.80:  55%|█████▌    | 11/20 [06:21<05:36, 37.42s/it]
Task 13, Epoch 12/20 => Loss 0.039, Train_accy 98.56:  55%|█████▌    | 11/20 [06:49<05:36, 37.42s/it]
Task 13, Epoch 12/20 => Loss 0.039, Train_accy 98.56:  60%|██████    | 12/20 [06:49<04:35, 34.44s/it]
Task 13, Epoch 13/20 => Loss 0.043, Train_accy 98.52:  60%|██████    | 12/20 [07:16<04:35, 34.44s/it]
Task 13, Epoch 13/20 => Loss 0.043, Train_accy 98.52:  65%|██████▌   | 13/20 [07:16<03:46, 32.36s/it]
Task 13, Epoch 14/20 => Loss 0.039, Train_accy 98.56:  65%|██████▌   | 13/20 [07:44<03:46, 32.36s/it]
Task 13, Epoch 14/20 => Loss 0.039, Train_accy 98.56:  70%|███████   | 14/20 [07:44<03:05, 30.93s/it]
Task 13, Epoch 15/20 => Loss 0.049, Train_accy 98.48, Test_accy 85.30:  70%|███████   | 14/20 [08:51<03:05, 30.93s/it]
Task 13, Epoch 15/20 => Loss 0.049, Train_accy 98.48, Test_accy 85.30:  75%|███████▌  | 15/20 [08:51<03:28, 41.79s/it]
Task 13, Epoch 16/20 => Loss 0.031, Train_accy 98.92:  75%|███████▌  | 15/20 [09:18<03:28, 41.79s/it]                 
Task 13, Epoch 16/20 => Loss 0.031, Train_accy 98.92:  80%|████████  | 16/20 [09:18<02:30, 37.51s/it]
Task 13, Epoch 17/20 => Loss 0.042, Train_accy 98.68:  80%|████████  | 16/20 [09:46<02:30, 37.51s/it]
Task 13, Epoch 17/20 => Loss 0.042, Train_accy 98.68:  85%|████████▌ | 17/20 [09:46<01:43, 34.45s/it]
Task 13, Epoch 18/20 => Loss 0.042, Train_accy 98.60:  85%|████████▌ | 17/20 [10:13<01:43, 34.45s/it]
Task 13, Epoch 18/20 => Loss 0.042, Train_accy 98.60:  90%|█████████ | 18/20 [10:13<01:04, 32.36s/it]
Task 13, Epoch 19/20 => Loss 0.038, Train_accy 98.76:  90%|█████████ | 18/20 [10:41<01:04, 32.36s/it]
Task 13, Epoch 19/20 => Loss 0.038, Train_accy 98.76:  95%|█████████▌| 19/20 [10:41<00:30, 30.92s/it]
Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40:  95%|█████████▌| 19/20 [11:48<00:30, 30.92s/it]
Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40: 100%|██████████| 20/20 [11:48<00:00, 41.67s/it]
Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40: 100%|██████████| 20/20 [11:48<00:00, 35.40s/it]
2024-09-04 00:46:20,071 [coda_prompt.py] => Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40
2024-09-04 00:46:59,304 [trainer.py] => No NME accuracy.
2024-09-04 00:46:59,305 [trainer.py] => CNN: {'total': 85.4, '00-04': 92.4, '05-09': 90.2, '10-14': 83.4, '15-19': 82.6, '20-24': 92.8, '25-29': 86.8, '30-34': 73.6, '35-39': 87.2, '40-44': 84.6, '45-49': 80.0, '50-54': 85.8, '55-59': 71.2, '60-64': 91.8, '65-69': 93.2, 'old': 84.8, 'new': 93.2}
2024-09-04 00:46:59,305 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4]
2024-09-04 00:46:59,305 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94]

Average Accuracy (CNN): 91.56
2024-09-04 00:46:59,305 [trainer.py] => Average Accuracy (CNN): 91.56 

2024-09-04 00:46:59,306 [trainer.py] => All params: 89715556
2024-09-04 00:46:59,307 [trainer.py] => Trainable params: 89715556
2024-09-04 00:47:00,027 [coda_prompt.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.332, Train_accy 88.14:   0%|          | 0/20 [00:27<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.332, Train_accy 88.14:   5%|▌         | 1/20 [00:27<08:42, 27.52s/it]
Task 14, Epoch 2/20 => Loss 0.099, Train_accy 96.75:   5%|▌         | 1/20 [00:55<08:42, 27.52s/it]
Task 14, Epoch 2/20 => Loss 0.099, Train_accy 96.75:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 14, Epoch 3/20 => Loss 0.085, Train_accy 97.16:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 14, Epoch 3/20 => Loss 0.085, Train_accy 97.16:  15%|█▌        | 3/20 [01:22<07:47, 27.53s/it]
Task 14, Epoch 4/20 => Loss 0.084, Train_accy 97.28:  15%|█▌        | 3/20 [01:50<07:47, 27.53s/it]
Task 14, Epoch 4/20 => Loss 0.084, Train_accy 97.28:  20%|██        | 4/20 [01:50<07:20, 27.53s/it]
Task 14, Epoch 5/20 => Loss 0.078, Train_accy 97.16, Test_accy 83.15:  20%|██        | 4/20 [02:59<07:20, 27.53s/it]
Task 14, Epoch 5/20 => Loss 0.078, Train_accy 97.16, Test_accy 83.15:  25%|██▌       | 5/20 [02:59<10:40, 42.69s/it]
Task 14, Epoch 6/20 => Loss 0.077, Train_accy 97.44:  25%|██▌       | 5/20 [03:27<10:40, 42.69s/it]                 
Task 14, Epoch 6/20 => Loss 0.077, Train_accy 97.44:  30%|███       | 6/20 [03:27<08:45, 37.53s/it]
Task 14, Epoch 7/20 => Loss 0.065, Train_accy 97.80:  30%|███       | 6/20 [03:54<08:45, 37.53s/it]
Task 14, Epoch 7/20 => Loss 0.065, Train_accy 97.80:  35%|███▌      | 7/20 [03:54<07:25, 34.26s/it]
Task 14, Epoch 8/20 => Loss 0.061, Train_accy 97.72:  35%|███▌      | 7/20 [04:22<07:25, 34.26s/it]
Task 14, Epoch 8/20 => Loss 0.061, Train_accy 97.72:  40%|████      | 8/20 [04:22<06:25, 32.13s/it]
Task 14, Epoch 9/20 => Loss 0.063, Train_accy 97.92:  40%|████      | 8/20 [04:49<06:25, 32.13s/it]
Task 14, Epoch 9/20 => Loss 0.063, Train_accy 97.92:  45%|████▌     | 9/20 [04:49<05:37, 30.69s/it]
Task 14, Epoch 10/20 => Loss 0.087, Train_accy 97.32, Test_accy 83.69:  45%|████▌     | 9/20 [05:59<05:37, 30.69s/it]
Task 14, Epoch 10/20 => Loss 0.087, Train_accy 97.32, Test_accy 83.69:  50%|█████     | 10/20 [05:59<07:07, 42.72s/it]
Task 14, Epoch 11/20 => Loss 0.064, Train_accy 98.04:  50%|█████     | 10/20 [06:26<07:07, 42.72s/it]                 
Task 14, Epoch 11/20 => Loss 0.064, Train_accy 98.04:  55%|█████▌    | 11/20 [06:26<05:42, 38.07s/it]
Task 14, Epoch 12/20 => Loss 0.058, Train_accy 97.88:  55%|█████▌    | 11/20 [06:54<05:42, 38.07s/it]
Task 14, Epoch 12/20 => Loss 0.058, Train_accy 97.88:  60%|██████    | 12/20 [06:54<04:38, 34.87s/it]
Task 14, Epoch 13/20 => Loss 0.062, Train_accy 97.88:  60%|██████    | 12/20 [07:22<04:38, 34.87s/it]
Task 14, Epoch 13/20 => Loss 0.062, Train_accy 97.88:  65%|██████▌   | 13/20 [07:22<03:48, 32.63s/it]
Task 14, Epoch 14/20 => Loss 0.062, Train_accy 97.96:  65%|██████▌   | 13/20 [07:49<03:48, 32.63s/it]
Task 14, Epoch 14/20 => Loss 0.062, Train_accy 97.96:  70%|███████   | 14/20 [07:49<03:06, 31.01s/it]
Task 14, Epoch 15/20 => Loss 0.062, Train_accy 97.56, Test_accy 84.05:  70%|███████   | 14/20 [08:59<03:06, 31.01s/it]
Task 14, Epoch 15/20 => Loss 0.062, Train_accy 97.56, Test_accy 84.05:  75%|███████▌  | 15/20 [08:59<03:33, 42.70s/it]
Task 14, Epoch 16/20 => Loss 0.061, Train_accy 97.76:  75%|███████▌  | 15/20 [09:26<03:33, 42.70s/it]                 
Task 14, Epoch 16/20 => Loss 0.061, Train_accy 97.76:  80%|████████  | 16/20 [09:26<02:32, 38.14s/it]
Task 14, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  80%|████████  | 16/20 [09:54<02:32, 38.14s/it]
Task 14, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  85%|████████▌ | 17/20 [09:54<01:44, 34.95s/it]
Task 14, Epoch 18/20 => Loss 0.061, Train_accy 97.96:  85%|████████▌ | 17/20 [10:21<01:44, 34.95s/it]
Task 14, Epoch 18/20 => Loss 0.061, Train_accy 97.96:  90%|█████████ | 18/20 [10:21<01:05, 32.73s/it]
Task 14, Epoch 19/20 => Loss 0.046, Train_accy 98.52:  90%|█████████ | 18/20 [10:49<01:05, 32.73s/it]
Task 14, Epoch 19/20 => Loss 0.046, Train_accy 98.52:  95%|█████████▌| 19/20 [10:49<00:31, 31.17s/it]
Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09:  95%|█████████▌| 19/20 [11:58<00:31, 31.17s/it]
Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09: 100%|██████████| 20/20 [11:58<00:00, 42.74s/it]
Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09: 100%|██████████| 20/20 [11:58<00:00, 35.95s/it]
2024-09-04 00:58:59,021 [coda_prompt.py] => Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09
2024-09-04 00:59:41,175 [trainer.py] => No NME accuracy.
2024-09-04 00:59:41,176 [trainer.py] => CNN: {'total': 84.09, '00-04': 92.4, '05-09': 90.2, '10-14': 84.6, '15-19': 82.6, '20-24': 93.4, '25-29': 86.0, '30-34': 74.6, '35-39': 86.6, '40-44': 85.2, '45-49': 79.8, '50-54': 87.4, '55-59': 67.0, '60-64': 87.6, '65-69': 92.6, '70-74': 71.4, 'old': 85.0, 'new': 71.4}
2024-09-04 00:59:41,176 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09]
2024-09-04 00:59:41,176 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83]

Average Accuracy (CNN): 91.06
2024-09-04 00:59:41,176 [trainer.py] => Average Accuracy (CNN): 91.06 

2024-09-04 00:59:41,177 [trainer.py] => All params: 89715556
2024-09-04 00:59:41,178 [trainer.py] => Trainable params: 89715556
2024-09-04 00:59:41,959 [coda_prompt.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.310, Train_accy 89.42:   0%|          | 0/20 [00:27<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.310, Train_accy 89.42:   5%|▌         | 1/20 [00:27<08:43, 27.57s/it]
Task 15, Epoch 2/20 => Loss 0.085, Train_accy 97.28:   5%|▌         | 1/20 [00:55<08:43, 27.57s/it]
Task 15, Epoch 2/20 => Loss 0.085, Train_accy 97.28:  10%|█         | 2/20 [00:55<08:16, 27.57s/it]
Task 15, Epoch 3/20 => Loss 0.096, Train_accy 96.83:  10%|█         | 2/20 [01:22<08:16, 27.57s/it]
Task 15, Epoch 3/20 => Loss 0.096, Train_accy 96.83:  15%|█▌        | 3/20 [01:22<07:49, 27.59s/it]
Task 15, Epoch 4/20 => Loss 0.090, Train_accy 96.92:  15%|█▌        | 3/20 [01:50<07:49, 27.59s/it]
Task 15, Epoch 4/20 => Loss 0.090, Train_accy 96.92:  20%|██        | 4/20 [01:50<07:21, 27.59s/it]
Task 15, Epoch 5/20 => Loss 0.066, Train_accy 97.60, Test_accy 82.84:  20%|██        | 4/20 [03:02<07:21, 27.59s/it]
Task 15, Epoch 5/20 => Loss 0.066, Train_accy 97.60, Test_accy 82.84:  25%|██▌       | 5/20 [03:02<10:56, 43.79s/it]
Task 15, Epoch 6/20 => Loss 0.063, Train_accy 97.92:  25%|██▌       | 5/20 [03:30<10:56, 43.79s/it]                 
Task 15, Epoch 6/20 => Loss 0.063, Train_accy 97.92:  30%|███       | 6/20 [03:30<08:55, 38.27s/it]
Task 15, Epoch 7/20 => Loss 0.062, Train_accy 97.72:  30%|███       | 6/20 [03:58<08:55, 38.27s/it]
Task 15, Epoch 7/20 => Loss 0.062, Train_accy 97.72:  35%|███▌      | 7/20 [03:58<07:32, 34.80s/it]
Task 15, Epoch 8/20 => Loss 0.076, Train_accy 97.52:  35%|███▌      | 7/20 [04:25<07:32, 34.80s/it]
Task 15, Epoch 8/20 => Loss 0.076, Train_accy 97.52:  40%|████      | 8/20 [04:25<06:29, 32.49s/it]
Task 15, Epoch 9/20 => Loss 0.062, Train_accy 97.80:  40%|████      | 8/20 [04:53<06:29, 32.49s/it]
Task 15, Epoch 9/20 => Loss 0.062, Train_accy 97.80:  45%|████▌     | 9/20 [04:53<05:40, 30.96s/it]
Task 15, Epoch 10/20 => Loss 0.057, Train_accy 98.28, Test_accy 82.85:  45%|████▌     | 9/20 [06:05<05:40, 30.96s/it]
Task 15, Epoch 10/20 => Loss 0.057, Train_accy 98.28, Test_accy 82.85:  50%|█████     | 10/20 [06:05<07:17, 43.78s/it]
Task 15, Epoch 11/20 => Loss 0.060, Train_accy 98.16:  50%|█████     | 10/20 [06:33<07:17, 43.78s/it]                 
Task 15, Epoch 11/20 => Loss 0.060, Train_accy 98.16:  55%|█████▌    | 11/20 [06:33<05:49, 38.81s/it]
Task 15, Epoch 12/20 => Loss 0.053, Train_accy 98.08:  55%|█████▌    | 11/20 [07:00<05:49, 38.81s/it]
Task 15, Epoch 12/20 => Loss 0.053, Train_accy 98.08:  60%|██████    | 12/20 [07:00<04:43, 35.40s/it]
Task 15, Epoch 13/20 => Loss 0.058, Train_accy 98.08:  60%|██████    | 12/20 [07:28<04:43, 35.40s/it]
Task 15, Epoch 13/20 => Loss 0.058, Train_accy 98.08:  65%|██████▌   | 13/20 [07:28<03:51, 33.03s/it]
Task 15, Epoch 14/20 => Loss 0.052, Train_accy 98.16:  65%|██████▌   | 13/20 [07:56<03:51, 33.03s/it]
Task 15, Epoch 14/20 => Loss 0.052, Train_accy 98.16:  70%|███████   | 14/20 [07:56<03:08, 31.40s/it]
Task 15, Epoch 15/20 => Loss 0.063, Train_accy 97.84, Test_accy 82.65:  70%|███████   | 14/20 [09:08<03:08, 31.40s/it]
Task 15, Epoch 15/20 => Loss 0.063, Train_accy 97.84, Test_accy 82.65:  75%|███████▌  | 15/20 [09:08<03:39, 43.82s/it]
Task 15, Epoch 16/20 => Loss 0.064, Train_accy 97.84:  75%|███████▌  | 15/20 [09:36<03:39, 43.82s/it]                 
Task 15, Epoch 16/20 => Loss 0.064, Train_accy 97.84:  80%|████████  | 16/20 [09:36<02:35, 38.95s/it]
Task 15, Epoch 17/20 => Loss 0.053, Train_accy 98.24:  80%|████████  | 16/20 [10:03<02:35, 38.95s/it]
Task 15, Epoch 17/20 => Loss 0.053, Train_accy 98.24:  85%|████████▌ | 17/20 [10:03<01:46, 35.51s/it]
Task 15, Epoch 18/20 => Loss 0.044, Train_accy 98.52:  85%|████████▌ | 17/20 [10:31<01:46, 35.51s/it]
Task 15, Epoch 18/20 => Loss 0.044, Train_accy 98.52:  90%|█████████ | 18/20 [10:31<01:06, 33.11s/it]
Task 15, Epoch 19/20 => Loss 0.070, Train_accy 97.64:  90%|█████████ | 18/20 [10:58<01:06, 33.11s/it]
Task 15, Epoch 19/20 => Loss 0.070, Train_accy 97.64:  95%|█████████▌| 19/20 [10:58<00:31, 31.44s/it]
Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78:  95%|█████████▌| 19/20 [12:11<00:31, 31.44s/it]
Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78: 100%|██████████| 20/20 [12:11<00:00, 43.84s/it]
Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78: 100%|██████████| 20/20 [12:11<00:00, 36.58s/it]
2024-09-04 01:11:53,629 [coda_prompt.py] => Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78
2024-09-04 01:12:38,517 [trainer.py] => No NME accuracy.
2024-09-04 01:12:38,517 [trainer.py] => CNN: {'total': 82.78, '00-04': 90.6, '05-09': 89.6, '10-14': 83.8, '15-19': 82.6, '20-24': 92.8, '25-29': 86.4, '30-34': 74.2, '35-39': 86.2, '40-44': 84.6, '45-49': 72.4, '50-54': 83.6, '55-59': 65.8, '60-64': 87.2, '65-69': 92.8, '70-74': 69.8, '75-79': 82.0, 'old': 82.83, 'new': 82.0}
2024-09-04 01:12:38,517 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78]
2024-09-04 01:12:38,517 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64]

Average Accuracy (CNN): 90.54
2024-09-04 01:12:38,518 [trainer.py] => Average Accuracy (CNN): 90.54 

2024-09-04 01:12:38,519 [trainer.py] => All params: 89715556
2024-09-04 01:12:38,520 [trainer.py] => Trainable params: 89715556
2024-09-04 01:12:39,352 [coda_prompt.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.334, Train_accy 88.90:   0%|          | 0/20 [00:27<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.334, Train_accy 88.90:   5%|▌         | 1/20 [00:27<08:45, 27.65s/it]
Task 16, Epoch 2/20 => Loss 0.054, Train_accy 98.48:   5%|▌         | 1/20 [00:55<08:45, 27.65s/it]
Task 16, Epoch 2/20 => Loss 0.054, Train_accy 98.48:  10%|█         | 2/20 [00:55<08:17, 27.62s/it]
Task 16, Epoch 3/20 => Loss 0.065, Train_accy 97.84:  10%|█         | 2/20 [01:22<08:17, 27.62s/it]
Task 16, Epoch 3/20 => Loss 0.065, Train_accy 97.84:  15%|█▌        | 3/20 [01:22<07:49, 27.61s/it]
Task 16, Epoch 4/20 => Loss 0.055, Train_accy 98.24:  15%|█▌        | 3/20 [01:50<07:49, 27.61s/it]
Task 16, Epoch 4/20 => Loss 0.055, Train_accy 98.24:  20%|██        | 4/20 [01:50<07:21, 27.61s/it]
Task 16, Epoch 5/20 => Loss 0.050, Train_accy 98.32, Test_accy 81.92:  20%|██        | 4/20 [03:05<07:21, 27.61s/it]
Task 16, Epoch 5/20 => Loss 0.050, Train_accy 98.32, Test_accy 81.92:  25%|██▌       | 5/20 [03:05<11:12, 44.80s/it]
Task 16, Epoch 6/20 => Loss 0.048, Train_accy 98.32:  25%|██▌       | 5/20 [03:33<11:12, 44.80s/it]                 
Task 16, Epoch 6/20 => Loss 0.048, Train_accy 98.32:  30%|███       | 6/20 [03:33<09:05, 38.96s/it]
Task 16, Epoch 7/20 => Loss 0.048, Train_accy 98.48:  30%|███       | 6/20 [04:00<09:05, 38.96s/it]
Task 16, Epoch 7/20 => Loss 0.048, Train_accy 98.48:  35%|███▌      | 7/20 [04:00<07:38, 35.24s/it]
Task 16, Epoch 8/20 => Loss 0.043, Train_accy 98.56:  35%|███▌      | 7/20 [04:28<07:38, 35.24s/it]
Task 16, Epoch 8/20 => Loss 0.043, Train_accy 98.56:  40%|████      | 8/20 [04:28<06:33, 32.80s/it]
Task 16, Epoch 9/20 => Loss 0.043, Train_accy 98.72:  40%|████      | 8/20 [04:56<06:33, 32.80s/it]
Task 16, Epoch 9/20 => Loss 0.043, Train_accy 98.72:  45%|████▌     | 9/20 [04:56<05:42, 31.17s/it]
Task 16, Epoch 10/20 => Loss 0.045, Train_accy 98.44, Test_accy 82.12:  45%|████▌     | 9/20 [06:11<05:42, 31.17s/it]
Task 16, Epoch 10/20 => Loss 0.045, Train_accy 98.44, Test_accy 82.12:  50%|█████     | 10/20 [06:11<07:27, 44.77s/it]
Task 16, Epoch 11/20 => Loss 0.038, Train_accy 99.00:  50%|█████     | 10/20 [06:38<07:27, 44.77s/it]                 
Task 16, Epoch 11/20 => Loss 0.038, Train_accy 99.00:  55%|█████▌    | 11/20 [06:38<05:55, 39.50s/it]
Task 16, Epoch 12/20 => Loss 0.045, Train_accy 98.68:  55%|█████▌    | 11/20 [07:06<05:55, 39.50s/it]
Task 16, Epoch 12/20 => Loss 0.045, Train_accy 98.68:  60%|██████    | 12/20 [07:06<04:46, 35.87s/it]
Task 16, Epoch 13/20 => Loss 0.045, Train_accy 98.28:  60%|██████    | 12/20 [07:34<04:46, 35.87s/it]
Task 16, Epoch 13/20 => Loss 0.045, Train_accy 98.28:  65%|██████▌   | 13/20 [07:34<03:53, 33.37s/it]
Task 16, Epoch 14/20 => Loss 0.048, Train_accy 98.36:  65%|██████▌   | 13/20 [08:01<03:53, 33.37s/it]
Task 16, Epoch 14/20 => Loss 0.048, Train_accy 98.36:  70%|███████   | 14/20 [08:01<03:09, 31.63s/it]
Task 16, Epoch 15/20 => Loss 0.038, Train_accy 98.60, Test_accy 82.27:  70%|███████   | 14/20 [09:16<03:09, 31.63s/it]
Task 16, Epoch 15/20 => Loss 0.038, Train_accy 98.60, Test_accy 82.27:  75%|███████▌  | 15/20 [09:16<03:43, 44.77s/it]
Task 16, Epoch 16/20 => Loss 0.041, Train_accy 98.76:  75%|███████▌  | 15/20 [09:44<03:43, 44.77s/it]                 
Task 16, Epoch 16/20 => Loss 0.041, Train_accy 98.76:  80%|████████  | 16/20 [09:44<02:38, 39.58s/it]
Task 16, Epoch 17/20 => Loss 0.035, Train_accy 98.72:  80%|████████  | 16/20 [10:11<02:38, 39.58s/it]
Task 16, Epoch 17/20 => Loss 0.035, Train_accy 98.72:  85%|████████▌ | 17/20 [10:11<01:47, 35.96s/it]
Task 16, Epoch 18/20 => Loss 0.031, Train_accy 98.84:  85%|████████▌ | 17/20 [10:39<01:47, 35.96s/it]
Task 16, Epoch 18/20 => Loss 0.031, Train_accy 98.84:  90%|█████████ | 18/20 [10:39<01:06, 33.44s/it]
Task 16, Epoch 19/20 => Loss 0.037, Train_accy 98.68:  90%|█████████ | 18/20 [11:07<01:06, 33.44s/it]
Task 16, Epoch 19/20 => Loss 0.037, Train_accy 98.68:  95%|█████████▌| 19/20 [11:07<00:31, 31.68s/it]
Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41:  95%|█████████▌| 19/20 [12:22<00:31, 31.68s/it]
Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41: 100%|██████████| 20/20 [12:22<00:00, 44.69s/it]
Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41: 100%|██████████| 20/20 [12:22<00:00, 37.11s/it]
2024-09-04 01:25:01,517 [coda_prompt.py] => Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41
2024-09-04 01:25:49,138 [trainer.py] => No NME accuracy.
2024-09-04 01:25:49,139 [trainer.py] => CNN: {'total': 82.41, '00-04': 90.8, '05-09': 89.4, '10-14': 84.6, '15-19': 82.8, '20-24': 93.4, '25-29': 85.4, '30-34': 73.2, '35-39': 86.2, '40-44': 84.6, '45-49': 71.0, '50-54': 82.2, '55-59': 65.2, '60-64': 86.2, '65-69': 92.8, '70-74': 71.0, '75-79': 81.6, '80-84': 80.6, 'old': 82.52, 'new': 80.6}
2024-09-04 01:25:49,139 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41]
2024-09-04 01:25:49,139 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71]

Average Accuracy (CNN): 90.06
2024-09-04 01:25:49,139 [trainer.py] => Average Accuracy (CNN): 90.06 

2024-09-04 01:25:49,141 [trainer.py] => All params: 89715556
2024-09-04 01:25:49,142 [trainer.py] => Trainable params: 89715556
2024-09-04 01:25:50,010 [coda_prompt.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.435, Train_accy 83.57:   0%|          | 0/20 [00:27<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.435, Train_accy 83.57:   5%|▌         | 1/20 [00:27<08:44, 27.58s/it]
Task 17, Epoch 2/20 => Loss 0.189, Train_accy 92.95:   5%|▌         | 1/20 [00:55<08:44, 27.58s/it]
Task 17, Epoch 2/20 => Loss 0.189, Train_accy 92.95:  10%|█         | 2/20 [00:55<08:16, 27.56s/it]
Task 17, Epoch 3/20 => Loss 0.181, Train_accy 93.43:  10%|█         | 2/20 [01:22<08:16, 27.56s/it]
Task 17, Epoch 3/20 => Loss 0.181, Train_accy 93.43:  15%|█▌        | 3/20 [01:22<07:48, 27.58s/it]
Task 17, Epoch 4/20 => Loss 0.153, Train_accy 94.31:  15%|█▌        | 3/20 [01:50<07:48, 27.58s/it]
Task 17, Epoch 4/20 => Loss 0.153, Train_accy 94.31:  20%|██        | 4/20 [01:50<07:21, 27.60s/it]
Task 17, Epoch 5/20 => Loss 0.148, Train_accy 94.47, Test_accy 82.26:  20%|██        | 4/20 [03:08<07:21, 27.60s/it]
Task 17, Epoch 5/20 => Loss 0.148, Train_accy 94.47, Test_accy 82.26:  25%|██▌       | 5/20 [03:08<11:27, 45.85s/it]
Task 17, Epoch 6/20 => Loss 0.155, Train_accy 93.91:  25%|██▌       | 5/20 [03:36<11:27, 45.85s/it]                 
Task 17, Epoch 6/20 => Loss 0.155, Train_accy 93.91:  30%|███       | 6/20 [03:36<09:14, 39.64s/it]
Task 17, Epoch 7/20 => Loss 0.137, Train_accy 94.71:  30%|███       | 6/20 [04:03<09:14, 39.64s/it]
Task 17, Epoch 7/20 => Loss 0.137, Train_accy 94.71:  35%|███▌      | 7/20 [04:03<07:44, 35.71s/it]
Task 17, Epoch 8/20 => Loss 0.147, Train_accy 94.71:  35%|███▌      | 7/20 [04:31<07:44, 35.71s/it]
Task 17, Epoch 8/20 => Loss 0.147, Train_accy 94.71:  40%|████      | 8/20 [04:31<06:37, 33.12s/it]
Task 17, Epoch 9/20 => Loss 0.123, Train_accy 95.63:  40%|████      | 8/20 [04:58<06:37, 33.12s/it]
Task 17, Epoch 9/20 => Loss 0.123, Train_accy 95.63:  45%|████▌     | 9/20 [04:58<05:45, 31.40s/it]
Task 17, Epoch 10/20 => Loss 0.139, Train_accy 95.07, Test_accy 82.31:  45%|████▌     | 9/20 [06:17<05:45, 31.40s/it]
Task 17, Epoch 10/20 => Loss 0.139, Train_accy 95.07, Test_accy 82.31:  50%|█████     | 10/20 [06:17<07:38, 45.81s/it]
Task 17, Epoch 11/20 => Loss 0.143, Train_accy 95.07:  50%|█████     | 10/20 [06:44<07:38, 45.81s/it]                 
Task 17, Epoch 11/20 => Loss 0.143, Train_accy 95.07:  55%|█████▌    | 11/20 [06:44<06:02, 40.25s/it]
Task 17, Epoch 12/20 => Loss 0.119, Train_accy 95.35:  55%|█████▌    | 11/20 [07:12<06:02, 40.25s/it]
Task 17, Epoch 12/20 => Loss 0.119, Train_accy 95.35:  60%|██████    | 12/20 [07:12<04:51, 36.40s/it]
Task 17, Epoch 13/20 => Loss 0.128, Train_accy 95.11:  60%|██████    | 12/20 [07:39<04:51, 36.40s/it]
Task 17, Epoch 13/20 => Loss 0.128, Train_accy 95.11:  65%|██████▌   | 13/20 [07:39<03:56, 33.74s/it]
Task 17, Epoch 14/20 => Loss 0.115, Train_accy 95.47:  65%|██████▌   | 13/20 [08:07<03:56, 33.74s/it]
Task 17, Epoch 14/20 => Loss 0.115, Train_accy 95.47:  70%|███████   | 14/20 [08:07<03:11, 31.88s/it]
Task 17, Epoch 15/20 => Loss 0.108, Train_accy 95.83, Test_accy 82.24:  70%|███████   | 14/20 [09:25<03:11, 31.88s/it]
Task 17, Epoch 15/20 => Loss 0.108, Train_accy 95.83, Test_accy 82.24:  75%|███████▌  | 15/20 [09:25<03:48, 45.77s/it]
Task 17, Epoch 16/20 => Loss 0.125, Train_accy 95.31:  75%|███████▌  | 15/20 [09:53<03:48, 45.77s/it]                 
Task 17, Epoch 16/20 => Loss 0.125, Train_accy 95.31:  80%|████████  | 16/20 [09:53<02:41, 40.29s/it]
Task 17, Epoch 17/20 => Loss 0.120, Train_accy 95.59:  80%|████████  | 16/20 [10:20<02:41, 40.29s/it]
Task 17, Epoch 17/20 => Loss 0.120, Train_accy 95.59:  85%|████████▌ | 17/20 [10:20<01:49, 36.46s/it]
Task 17, Epoch 18/20 => Loss 0.117, Train_accy 95.71:  85%|████████▌ | 17/20 [10:48<01:49, 36.46s/it]
Task 17, Epoch 18/20 => Loss 0.117, Train_accy 95.71:  90%|█████████ | 18/20 [10:48<01:07, 33.79s/it]
Task 17, Epoch 19/20 => Loss 0.114, Train_accy 95.75:  90%|█████████ | 18/20 [11:15<01:07, 33.79s/it]
Task 17, Epoch 19/20 => Loss 0.114, Train_accy 95.75:  95%|█████████▌| 19/20 [11:15<00:31, 31.92s/it]
Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43:  95%|█████████▌| 19/20 [12:33<00:31, 31.92s/it]
Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43: 100%|██████████| 20/20 [12:33<00:00, 45.73s/it]
Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43: 100%|██████████| 20/20 [12:33<00:00, 37.68s/it]
2024-09-04 01:38:23,671 [coda_prompt.py] => Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43
2024-09-04 01:39:14,122 [trainer.py] => No NME accuracy.
2024-09-04 01:39:14,123 [trainer.py] => CNN: {'total': 82.43, '00-04': 91.0, '05-09': 89.4, '10-14': 83.2, '15-19': 82.4, '20-24': 93.8, '25-29': 85.2, '30-34': 73.4, '35-39': 86.6, '40-44': 85.6, '45-49': 71.2, '50-54': 82.4, '55-59': 65.2, '60-64': 86.0, '65-69': 92.6, '70-74': 69.2, '75-79': 79.4, '80-84': 80.6, '85-89': 86.6, 'old': 82.19, 'new': 86.6}
2024-09-04 01:39:14,123 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41, 82.43]
2024-09-04 01:39:14,123 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71, 97.51]

Average Accuracy (CNN): 89.64
2024-09-04 01:39:14,123 [trainer.py] => Average Accuracy (CNN): 89.64 

2024-09-04 01:39:14,124 [trainer.py] => All params: 89715556
2024-09-04 01:39:14,125 [trainer.py] => Trainable params: 89715556
2024-09-04 01:39:15,037 [coda_prompt.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.275, Train_accy 90.02:   0%|          | 0/20 [00:27<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.275, Train_accy 90.02:   5%|▌         | 1/20 [00:27<08:43, 27.56s/it]
Task 18, Epoch 2/20 => Loss 0.087, Train_accy 96.75:   5%|▌         | 1/20 [00:55<08:43, 27.56s/it]
Task 18, Epoch 2/20 => Loss 0.087, Train_accy 96.75:  10%|█         | 2/20 [00:55<08:16, 27.60s/it]
Task 18, Epoch 3/20 => Loss 0.080, Train_accy 97.00:  10%|█         | 2/20 [01:22<08:16, 27.60s/it]
Task 18, Epoch 3/20 => Loss 0.080, Train_accy 97.00:  15%|█▌        | 3/20 [01:22<07:49, 27.62s/it]
Task 18, Epoch 4/20 => Loss 0.072, Train_accy 97.52:  15%|█▌        | 3/20 [01:50<07:49, 27.62s/it]
Task 18, Epoch 4/20 => Loss 0.072, Train_accy 97.52:  20%|██        | 4/20 [01:50<07:22, 27.63s/it]
Task 18, Epoch 5/20 => Loss 0.083, Train_accy 97.08, Test_accy 82.41:  20%|██        | 4/20 [03:11<07:22, 27.63s/it]
Task 18, Epoch 5/20 => Loss 0.083, Train_accy 97.08, Test_accy 82.41:  25%|██▌       | 5/20 [03:11<11:43, 46.88s/it]
Task 18, Epoch 6/20 => Loss 0.065, Train_accy 98.00:  25%|██▌       | 5/20 [03:39<11:43, 46.88s/it]                 
Task 18, Epoch 6/20 => Loss 0.065, Train_accy 98.00:  30%|███       | 6/20 [03:39<09:24, 40.32s/it]
Task 18, Epoch 7/20 => Loss 0.071, Train_accy 97.40:  30%|███       | 6/20 [04:06<09:24, 40.32s/it]
Task 18, Epoch 7/20 => Loss 0.071, Train_accy 97.40:  35%|███▌      | 7/20 [04:06<07:50, 36.16s/it]
Task 18, Epoch 8/20 => Loss 0.060, Train_accy 97.80:  35%|███▌      | 7/20 [04:34<07:50, 36.16s/it]
Task 18, Epoch 8/20 => Loss 0.060, Train_accy 97.80:  40%|████      | 8/20 [04:34<06:41, 33.45s/it]
Task 18, Epoch 9/20 => Loss 0.050, Train_accy 98.24:  40%|████      | 8/20 [05:01<06:41, 33.45s/it]
Task 18, Epoch 9/20 => Loss 0.050, Train_accy 98.24:  45%|████▌     | 9/20 [05:01<05:47, 31.62s/it]
Task 18, Epoch 10/20 => Loss 0.062, Train_accy 97.96, Test_accy 82.46:  45%|████▌     | 9/20 [06:22<05:47, 31.62s/it]
Task 18, Epoch 10/20 => Loss 0.062, Train_accy 97.96, Test_accy 82.46:  50%|█████     | 10/20 [06:22<07:48, 46.86s/it]
Task 18, Epoch 11/20 => Loss 0.065, Train_accy 97.60:  50%|█████     | 10/20 [06:50<07:48, 46.86s/it]                 
Task 18, Epoch 11/20 => Loss 0.065, Train_accy 97.60:  55%|█████▌    | 11/20 [06:50<06:08, 40.96s/it]
Task 18, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  55%|█████▌    | 11/20 [07:18<06:08, 40.96s/it]
Task 18, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  60%|██████    | 12/20 [07:18<04:55, 36.89s/it]
Task 18, Epoch 13/20 => Loss 0.065, Train_accy 97.84:  60%|██████    | 12/20 [07:45<04:55, 36.89s/it]
Task 18, Epoch 13/20 => Loss 0.065, Train_accy 97.84:  65%|██████▌   | 13/20 [07:45<03:58, 34.10s/it]
Task 18, Epoch 14/20 => Loss 0.064, Train_accy 97.76:  65%|██████▌   | 13/20 [08:13<03:58, 34.10s/it]
Task 18, Epoch 14/20 => Loss 0.064, Train_accy 97.76:  70%|███████   | 14/20 [08:13<03:12, 32.17s/it]
Task 18, Epoch 15/20 => Loss 0.050, Train_accy 98.32, Test_accy 82.64:  70%|███████   | 14/20 [09:34<03:12, 32.17s/it]
Task 18, Epoch 15/20 => Loss 0.050, Train_accy 98.32, Test_accy 82.64:  75%|███████▌  | 15/20 [09:34<03:54, 46.84s/it]
Task 18, Epoch 16/20 => Loss 0.064, Train_accy 97.64:  75%|███████▌  | 15/20 [10:01<03:54, 46.84s/it]                 
Task 18, Epoch 16/20 => Loss 0.064, Train_accy 97.64:  80%|████████  | 16/20 [10:01<02:44, 41.06s/it]
Task 18, Epoch 17/20 => Loss 0.063, Train_accy 97.44:  80%|████████  | 16/20 [10:29<02:44, 41.06s/it]
Task 18, Epoch 17/20 => Loss 0.063, Train_accy 97.44:  85%|████████▌ | 17/20 [10:29<01:51, 37.01s/it]
Task 18, Epoch 18/20 => Loss 0.058, Train_accy 97.84:  85%|████████▌ | 17/20 [10:57<01:51, 37.01s/it]
Task 18, Epoch 18/20 => Loss 0.058, Train_accy 97.84:  90%|█████████ | 18/20 [10:57<01:08, 34.18s/it]
Task 18, Epoch 19/20 => Loss 0.052, Train_accy 98.32:  90%|█████████ | 18/20 [11:24<01:08, 34.18s/it]
Task 18, Epoch 19/20 => Loss 0.052, Train_accy 98.32:  95%|█████████▌| 19/20 [11:24<00:32, 32.22s/it]
Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62:  95%|█████████▌| 19/20 [12:45<00:32, 32.22s/it]
Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62: 100%|██████████| 20/20 [12:45<00:00, 46.82s/it]
Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62: 100%|██████████| 20/20 [12:45<00:00, 38.28s/it]
2024-09-04 01:52:00,702 [coda_prompt.py] => Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62
2024-09-04 01:52:53,950 [trainer.py] => No NME accuracy.
2024-09-04 01:52:53,951 [trainer.py] => CNN: {'total': 82.62, '00-04': 89.6, '05-09': 89.6, '10-14': 83.6, '15-19': 82.2, '20-24': 93.8, '25-29': 84.8, '30-34': 73.4, '35-39': 86.2, '40-44': 85.2, '45-49': 72.2, '50-54': 81.2, '55-59': 66.0, '60-64': 85.2, '65-69': 92.0, '70-74': 69.6, '75-79': 81.0, '80-84': 80.2, '85-89': 86.2, '90-94': 87.8, 'old': 82.33, 'new': 87.8}
2024-09-04 01:52:53,951 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41, 82.43, 82.62]
2024-09-04 01:52:53,951 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71, 97.51, 97.49]

Average Accuracy (CNN): 89.27
2024-09-04 01:52:53,951 [trainer.py] => Average Accuracy (CNN): 89.27 

2024-09-04 01:52:53,952 [trainer.py] => All params: 89715556
2024-09-04 01:52:53,953 [trainer.py] => Trainable params: 89715556
2024-09-04 01:52:54,918 [coda_prompt.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.363, Train_accy 86.98:   0%|          | 0/20 [00:27<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.363, Train_accy 86.98:   5%|▌         | 1/20 [00:27<08:44, 27.60s/it]
Task 19, Epoch 2/20 => Loss 0.140, Train_accy 95.19:   5%|▌         | 1/20 [00:55<08:44, 27.60s/it]
Task 19, Epoch 2/20 => Loss 0.140, Train_accy 95.19:  10%|█         | 2/20 [00:55<08:16, 27.59s/it]
Task 19, Epoch 3/20 => Loss 0.135, Train_accy 95.67:  10%|█         | 2/20 [01:22<08:16, 27.59s/it]
Task 19, Epoch 3/20 => Loss 0.135, Train_accy 95.67:  15%|█▌        | 3/20 [01:22<07:49, 27.59s/it]
Task 19, Epoch 4/20 => Loss 0.107, Train_accy 96.19:  15%|█▌        | 3/20 [01:50<07:49, 27.59s/it]
Task 19, Epoch 4/20 => Loss 0.107, Train_accy 96.19:  20%|██        | 4/20 [01:50<07:21, 27.62s/it]
Task 19, Epoch 5/20 => Loss 0.129, Train_accy 95.27, Test_accy 81.81:  20%|██        | 4/20 [03:14<07:21, 27.62s/it]
Task 19, Epoch 5/20 => Loss 0.129, Train_accy 95.27, Test_accy 81.81:  25%|██▌       | 5/20 [03:14<11:57, 47.83s/it]
Task 19, Epoch 6/20 => Loss 0.104, Train_accy 96.07:  25%|██▌       | 5/20 [03:41<11:57, 47.83s/it]                 
Task 19, Epoch 6/20 => Loss 0.104, Train_accy 96.07:  30%|███       | 6/20 [03:41<09:33, 40.96s/it]
Task 19, Epoch 7/20 => Loss 0.096, Train_accy 96.79:  30%|███       | 6/20 [04:09<09:33, 40.96s/it]
Task 19, Epoch 7/20 => Loss 0.096, Train_accy 96.79:  35%|███▌      | 7/20 [04:09<07:55, 36.58s/it]
Task 19, Epoch 8/20 => Loss 0.096, Train_accy 96.59:  35%|███▌      | 7/20 [04:36<07:55, 36.58s/it]
Task 19, Epoch 8/20 => Loss 0.096, Train_accy 96.59:  40%|████      | 8/20 [04:36<06:44, 33.71s/it]
Task 19, Epoch 9/20 => Loss 0.101, Train_accy 96.35:  40%|████      | 8/20 [05:04<06:44, 33.71s/it]
Task 19, Epoch 9/20 => Loss 0.101, Train_accy 96.35:  45%|████▌     | 9/20 [05:04<05:49, 31.81s/it]
Task 19, Epoch 10/20 => Loss 0.093, Train_accy 96.63, Test_accy 81.99:  45%|████▌     | 9/20 [06:28<05:49, 31.81s/it]
Task 19, Epoch 10/20 => Loss 0.093, Train_accy 96.63, Test_accy 81.99:  50%|█████     | 10/20 [06:28<07:57, 47.78s/it]
Task 19, Epoch 11/20 => Loss 0.091, Train_accy 96.92:  50%|█████     | 10/20 [06:55<07:57, 47.78s/it]                 
Task 19, Epoch 11/20 => Loss 0.091, Train_accy 96.92:  55%|█████▌    | 11/20 [06:55<06:14, 41.60s/it]
Task 19, Epoch 12/20 => Loss 0.091, Train_accy 96.83:  55%|█████▌    | 11/20 [07:23<06:14, 41.60s/it]
Task 19, Epoch 12/20 => Loss 0.091, Train_accy 96.83:  60%|██████    | 12/20 [07:23<04:58, 37.34s/it]
Task 19, Epoch 13/20 => Loss 0.098, Train_accy 96.51:  60%|██████    | 12/20 [07:50<04:58, 37.34s/it]
Task 19, Epoch 13/20 => Loss 0.098, Train_accy 96.51:  65%|██████▌   | 13/20 [07:50<04:00, 34.38s/it]
Task 19, Epoch 14/20 => Loss 0.095, Train_accy 96.75:  65%|██████▌   | 13/20 [08:18<04:00, 34.38s/it]
Task 19, Epoch 14/20 => Loss 0.095, Train_accy 96.75:  70%|███████   | 14/20 [08:18<03:13, 32.32s/it]
Task 19, Epoch 15/20 => Loss 0.089, Train_accy 96.75, Test_accy 82.01:  70%|███████   | 14/20 [09:41<03:13, 32.32s/it]
Task 19, Epoch 15/20 => Loss 0.089, Train_accy 96.75, Test_accy 82.01:  75%|███████▌  | 15/20 [09:41<03:58, 47.78s/it]
Task 19, Epoch 16/20 => Loss 0.084, Train_accy 97.16:  75%|███████▌  | 15/20 [10:09<03:58, 47.78s/it]                 
Task 19, Epoch 16/20 => Loss 0.084, Train_accy 97.16:  80%|████████  | 16/20 [10:09<02:46, 41.72s/it]
Task 19, Epoch 17/20 => Loss 0.084, Train_accy 96.71:  80%|████████  | 16/20 [10:37<02:46, 41.72s/it]
Task 19, Epoch 17/20 => Loss 0.084, Train_accy 96.71:  85%|████████▌ | 17/20 [10:37<01:52, 37.48s/it]
Task 19, Epoch 18/20 => Loss 0.073, Train_accy 97.52:  85%|████████▌ | 17/20 [11:04<01:52, 37.48s/it]
Task 19, Epoch 18/20 => Loss 0.073, Train_accy 97.52:  90%|█████████ | 18/20 [11:04<01:09, 34.53s/it]
Task 19, Epoch 19/20 => Loss 0.075, Train_accy 97.36:  90%|█████████ | 18/20 [11:32<01:09, 34.53s/it]
Task 19, Epoch 19/20 => Loss 0.075, Train_accy 97.36:  95%|█████████▌| 19/20 [11:32<00:32, 32.49s/it]
Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94:  95%|█████████▌| 19/20 [12:56<00:32, 32.49s/it]
Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94: 100%|██████████| 20/20 [12:56<00:00, 47.93s/it]
Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94: 100%|██████████| 20/20 [12:56<00:00, 38.83s/it]
2024-09-04 02:05:51,498 [coda_prompt.py] => Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94
2024-09-04 02:06:47,655 [trainer.py] => No NME accuracy.
2024-09-04 02:06:47,655 [trainer.py] => CNN: {'total': 81.94, '00-04': 88.8, '05-09': 90.2, '10-14': 81.6, '15-19': 83.0, '20-24': 93.0, '25-29': 83.2, '30-34': 74.4, '35-39': 86.8, '40-44': 85.0, '45-49': 69.8, '50-54': 82.8, '55-59': 64.2, '60-64': 85.8, '65-69': 90.4, '70-74': 70.4, '75-79': 79.0, '80-84': 79.2, '85-89': 85.8, '90-94': 86.8, '95-99': 78.6, 'old': 82.12, 'new': 78.6}
2024-09-04 02:06:47,655 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41, 82.43, 82.62, 81.94]
2024-09-04 02:06:47,656 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71, 97.51, 97.49, 97.43]

Average Accuracy (CNN): 88.9
2024-09-04 02:06:47,656 [trainer.py] => Average Accuracy (CNN): 88.9 

Accuracy Matrix (CNN):
[[99.8 99.2 98.8 98.6 98.8 97.  97.2 96.8 93.8 94.2 92.4 93.4 93.2 92.4
  92.4 90.6 90.8 91.  89.6 88.8]
 [ 0.  96.8 95.4 94.4 94.8 91.4 92.  91.8 90.6 91.2 90.8 91.  91.  90.2
  90.2 89.6 89.4 89.4 89.6 90.2]
 [ 0.   0.  95.8 94.6 93.6 93.4 93.2 91.8 87.6 87.  87.  87.8 86.8 83.4
  84.6 83.8 84.6 83.2 83.6 81.6]
 [ 0.   0.   0.  92.4 92.2 91.4 91.  89.8 89.4 89.  88.8 88.4 82.2 82.6
  82.6 82.6 82.8 82.4 82.2 83. ]
 [ 0.   0.   0.   0.  95.8 94.8 94.  93.6 94.6 93.8 93.8 92.  92.8 92.8
  93.4 92.8 93.4 93.8 93.8 93. ]
 [ 0.   0.   0.   0.   0.  92.6 92.6 90.4 89.6 88.6 87.2 89.6 86.6 86.8
  86.  86.4 85.4 85.2 84.8 83.2]
 [ 0.   0.   0.   0.   0.   0.  78.  77.2 76.  76.4 74.8 75.4 74.8 73.6
  74.6 74.2 73.2 73.4 73.4 74.4]
 [ 0.   0.   0.   0.   0.   0.   0.  92.6 93.  89.2 87.4 87.2 87.2 87.2
  86.6 86.2 86.2 86.6 86.2 86.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  87.6 86.4 86.2 84.6 84.8 84.6
  85.2 84.6 84.6 85.6 85.2 85. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  85.  80.8 80.2 80.4 80.
  79.8 72.4 71.  71.2 72.2 69.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  88.6 86.4 87.2 85.8
  87.4 83.6 82.2 82.4 81.2 82.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  87.2 72.6 71.2
  67.  65.8 65.2 65.2 66.  64.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.2 91.8
  87.6 87.2 86.2 86.  85.2 85.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.2
  92.6 92.8 92.8 92.6 92.  90.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  71.4 69.8 71.  69.2 69.6 70.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  82.  81.6 79.4 81.  79. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  80.6 80.6 80.2 79.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  86.6 86.2 85.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  87.8 86.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  78.6]]
2024-09-04 02:06:47,661 [trainer.py] => Forgetting (CNN): 6.694736842105262
2024-09-04 02:06:50,338 [trainer.py] => config: ./exps/coda_prompt_cifar_B50_Inc5.json
2024-09-04 02:06:50,338 [trainer.py] => prefix:  
2024-09-04 02:06:50,338 [trainer.py] => dataset: cifar224
2024-09-04 02:06:50,338 [trainer.py] => memory_size: 0
2024-09-04 02:06:50,338 [trainer.py] => memory_per_class: 0
2024-09-04 02:06:50,338 [trainer.py] => fixed_memory: False
2024-09-04 02:06:50,338 [trainer.py] => shuffle: True
2024-09-04 02:06:50,338 [trainer.py] => init_cls: 50
2024-09-04 02:06:50,338 [trainer.py] => increment: 10
2024-09-04 02:06:50,338 [trainer.py] => model_name: coda_prompt
2024-09-04 02:06:50,338 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-04 02:06:50,338 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 02:06:50,338 [trainer.py] => seed: 1993
2024-09-04 02:06:50,338 [trainer.py] => tuned_epoch: 20
2024-09-04 02:06:50,338 [trainer.py] => init_lr: 0.001
2024-09-04 02:06:50,338 [trainer.py] => batch_size: 48
2024-09-04 02:06:50,338 [trainer.py] => weight_decay: 0
2024-09-04 02:06:50,338 [trainer.py] => min_lr: 1e-05
2024-09-04 02:06:50,338 [trainer.py] => optimizer: adam
2024-09-04 02:06:50,339 [trainer.py] => scheduler: cosine
2024-09-04 02:06:50,339 [trainer.py] => reinit_optimizer: True
2024-09-04 02:06:50,339 [trainer.py] => pretrained: True
2024-09-04 02:06:50,339 [trainer.py] => drop: 0.0
2024-09-04 02:06:50,339 [trainer.py] => drop_path: 0.0
2024-09-04 02:06:50,339 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-04 02:06:51,433 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 02:06:53,555 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-04 02:06:53,555 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-04 02:06:53,555 [trainer.py] => All params: 89715556
2024-09-04 02:06:53,556 [trainer.py] => Trainable params: 89715556
2024-09-04 02:06:53,556 [coda_prompt.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.846, Train_accy 77.39:   0%|          | 0/20 [04:30<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.846, Train_accy 77.39:   5%|▌         | 1/20 [04:30<1:25:45, 270.81s/it]
Task 0, Epoch 2/20 => Loss 0.533, Train_accy 84.88:   5%|▌         | 1/20 [09:01<1:25:45, 270.81s/it]
Task 0, Epoch 2/20 => Loss 0.533, Train_accy 84.88:  10%|█         | 2/20 [09:01<1:21:13, 270.76s/it]
Task 0, Epoch 3/20 => Loss 0.497, Train_accy 85.64:  10%|█         | 2/20 [13:32<1:21:13, 270.76s/it]
Task 0, Epoch 3/20 => Loss 0.497, Train_accy 85.64:  15%|█▌        | 3/20 [13:32<1:16:42, 270.71s/it]
Task 0, Epoch 4/20 => Loss 0.477, Train_accy 86.16:  15%|█▌        | 3/20 [18:02<1:16:42, 270.71s/it]
Task 0, Epoch 4/20 => Loss 0.477, Train_accy 86.16:  20%|██        | 4/20 [18:02<1:12:12, 270.75s/it]
Task 0, Epoch 5/20 => Loss 0.456, Train_accy 86.88, Test_accy 94.96:  20%|██        | 4/20 [23:02<1:12:12, 270.75s/it]
Task 0, Epoch 5/20 => Loss 0.456, Train_accy 86.88, Test_accy 94.96:  25%|██▌       | 5/20 [23:02<1:10:14, 281.00s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 87.11:  25%|██▌       | 5/20 [27:32<1:10:14, 281.00s/it]                 
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 87.11:  30%|███       | 6/20 [27:32<1:04:44, 277.49s/it]
Task 0, Epoch 7/20 => Loss 0.431, Train_accy 87.69:  30%|███       | 6/20 [32:03<1:04:44, 277.49s/it]
Task 0, Epoch 7/20 => Loss 0.431, Train_accy 87.69:  35%|███▌      | 7/20 [32:03<59:39, 275.35s/it]  
Task 0, Epoch 8/20 => Loss 0.436, Train_accy 87.52:  35%|███▌      | 7/20 [36:34<59:39, 275.35s/it]
Task 0, Epoch 8/20 => Loss 0.436, Train_accy 87.52:  40%|████      | 8/20 [36:34<54:45, 273.82s/it]
Task 0, Epoch 9/20 => Loss 0.409, Train_accy 88.22:  40%|████      | 8/20 [41:04<54:45, 273.82s/it]
Task 0, Epoch 9/20 => Loss 0.409, Train_accy 88.22:  45%|████▌     | 9/20 [41:04<50:00, 272.79s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 88.06, Test_accy 94.60:  45%|████▌     | 9/20 [46:03<50:00, 272.79s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 88.06, Test_accy 94.60:  50%|█████     | 10/20 [46:03<46:49, 280.92s/it]
Task 0, Epoch 11/20 => Loss 0.403, Train_accy 88.41:  50%|█████     | 10/20 [50:34<46:49, 280.92s/it]                 
Task 0, Epoch 11/20 => Loss 0.403, Train_accy 88.41:  55%|█████▌    | 11/20 [50:34<41:40, 277.82s/it]
Task 0, Epoch 12/20 => Loss 0.379, Train_accy 88.85:  55%|█████▌    | 11/20 [55:05<41:40, 277.82s/it]
Task 0, Epoch 12/20 => Loss 0.379, Train_accy 88.85:  60%|██████    | 12/20 [55:05<36:45, 275.65s/it]
Task 0, Epoch 13/20 => Loss 0.380, Train_accy 88.95:  60%|██████    | 12/20 [59:36<36:45, 275.65s/it]
Task 0, Epoch 13/20 => Loss 0.380, Train_accy 88.95:  65%|██████▌   | 13/20 [59:36<31:58, 274.13s/it]
Task 0, Epoch 14/20 => Loss 0.372, Train_accy 88.98:  65%|██████▌   | 13/20 [1:04:06<31:58, 274.13s/it]
Task 0, Epoch 14/20 => Loss 0.372, Train_accy 88.98:  70%|███████   | 14/20 [1:04:06<27:18, 273.11s/it]
Task 0, Epoch 15/20 => Loss 0.357, Train_accy 89.52, Test_accy 94.82:  70%|███████   | 14/20 [1:09:05<27:18, 273.11s/it]
Task 0, Epoch 15/20 => Loss 0.357, Train_accy 89.52, Test_accy 94.82:  75%|███████▌  | 15/20 [1:09:05<23:24, 280.83s/it]
Task 0, Epoch 16/20 => Loss 0.349, Train_accy 89.86:  75%|███████▌  | 15/20 [1:13:36<23:24, 280.83s/it]                 
Task 0, Epoch 16/20 => Loss 0.349, Train_accy 89.86:  80%|████████  | 16/20 [1:13:36<18:31, 277.77s/it]
Task 0, Epoch 17/20 => Loss 0.344, Train_accy 89.90:  80%|████████  | 16/20 [1:18:06<18:31, 277.77s/it]
Task 0, Epoch 17/20 => Loss 0.344, Train_accy 89.90:  85%|████████▌ | 17/20 [1:18:06<13:46, 275.65s/it]
Task 0, Epoch 18/20 => Loss 0.333, Train_accy 90.06:  85%|████████▌ | 17/20 [1:22:37<13:46, 275.65s/it]
Task 0, Epoch 18/20 => Loss 0.333, Train_accy 90.06:  90%|█████████ | 18/20 [1:22:37<09:08, 274.16s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 90.01:  90%|█████████ | 18/20 [1:27:08<09:08, 274.16s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 90.01:  95%|█████████▌| 19/20 [1:27:08<04:33, 273.10s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72:  95%|█████████▌| 19/20 [1:32:06<04:33, 273.10s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72: 100%|██████████| 20/20 [1:32:06<00:00, 280.79s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72: 100%|██████████| 20/20 [1:32:06<00:00, 276.35s/it]
2024-09-04 03:39:01,052 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72
2024-09-04 03:39:29,164 [trainer.py] => No NME accuracy.
2024-09-04 03:39:29,164 [trainer.py] => CNN: {'total': 94.72, '00-49': 94.72, 'old': 0, 'new': 94.72}
2024-09-04 03:39:29,164 [trainer.py] => CNN top1 curve: [94.72]
2024-09-04 03:39:29,165 [trainer.py] => CNN top5 curve: [99.36]

Average Accuracy (CNN): 94.72
2024-09-04 03:39:29,165 [trainer.py] => Average Accuracy (CNN): 94.72 

2024-09-04 03:39:29,166 [trainer.py] => All params: 89715556
2024-09-04 03:39:29,167 [trainer.py] => Trainable params: 89715556
2024-09-04 03:39:29,928 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.447, Train_accy 86.04:   0%|          | 0/20 [00:54<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.447, Train_accy 86.04:   5%|▌         | 1/20 [00:54<17:15, 54.47s/it]
Task 1, Epoch 2/20 => Loss 0.197, Train_accy 93.55:   5%|▌         | 1/20 [01:48<17:15, 54.47s/it]
Task 1, Epoch 2/20 => Loss 0.197, Train_accy 93.55:  10%|█         | 2/20 [01:48<16:20, 54.48s/it]
Task 1, Epoch 3/20 => Loss 0.162, Train_accy 94.45:  10%|█         | 2/20 [02:43<16:20, 54.48s/it]
Task 1, Epoch 3/20 => Loss 0.162, Train_accy 94.45:  15%|█▌        | 3/20 [02:43<15:26, 54.48s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.01:  15%|█▌        | 3/20 [03:37<15:26, 54.48s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.01:  20%|██        | 4/20 [03:37<14:31, 54.46s/it]
Task 1, Epoch 5/20 => Loss 0.144, Train_accy 95.11, Test_accy 89.48:  20%|██        | 4/20 [05:05<14:31, 54.46s/it]
Task 1, Epoch 5/20 => Loss 0.144, Train_accy 95.11, Test_accy 89.48:  25%|██▌       | 5/20 [05:05<16:38, 66.59s/it]
Task 1, Epoch 6/20 => Loss 0.139, Train_accy 94.89:  25%|██▌       | 5/20 [06:00<16:38, 66.59s/it]                 
Task 1, Epoch 6/20 => Loss 0.139, Train_accy 94.89:  30%|███       | 6/20 [06:00<14:34, 62.47s/it]
Task 1, Epoch 7/20 => Loss 0.140, Train_accy 95.43:  30%|███       | 6/20 [06:54<14:34, 62.47s/it]
Task 1, Epoch 7/20 => Loss 0.140, Train_accy 95.43:  35%|███▌      | 7/20 [06:54<12:57, 59.78s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 95.57:  35%|███▌      | 7/20 [07:49<12:57, 59.78s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 95.57:  40%|████      | 8/20 [07:49<11:36, 58.07s/it]
Task 1, Epoch 9/20 => Loss 0.144, Train_accy 94.99:  40%|████      | 8/20 [08:43<11:36, 58.07s/it]
Task 1, Epoch 9/20 => Loss 0.144, Train_accy 94.99:  45%|████▌     | 9/20 [08:43<10:26, 56.93s/it]
Task 1, Epoch 10/20 => Loss 0.133, Train_accy 95.67, Test_accy 90.90:  45%|████▌     | 9/20 [10:11<10:26, 56.93s/it]
Task 1, Epoch 10/20 => Loss 0.133, Train_accy 95.67, Test_accy 90.90:  50%|█████     | 10/20 [10:11<11:05, 66.52s/it]
Task 1, Epoch 11/20 => Loss 0.126, Train_accy 95.49:  50%|█████     | 10/20 [11:05<11:05, 66.52s/it]                 
Task 1, Epoch 11/20 => Loss 0.126, Train_accy 95.49:  55%|█████▌    | 11/20 [11:05<09:25, 62.82s/it]
Task 1, Epoch 12/20 => Loss 0.122, Train_accy 95.91:  55%|█████▌    | 11/20 [12:00<09:25, 62.82s/it]
Task 1, Epoch 12/20 => Loss 0.122, Train_accy 95.91:  60%|██████    | 12/20 [12:00<08:02, 60.33s/it]
Task 1, Epoch 13/20 => Loss 0.130, Train_accy 95.51:  60%|██████    | 12/20 [12:55<08:02, 60.33s/it]
Task 1, Epoch 13/20 => Loss 0.130, Train_accy 95.51:  65%|██████▌   | 13/20 [12:55<06:50, 58.59s/it]
Task 1, Epoch 14/20 => Loss 0.112, Train_accy 96.29:  65%|██████▌   | 13/20 [13:49<06:50, 58.59s/it]
Task 1, Epoch 14/20 => Loss 0.112, Train_accy 96.29:  70%|███████   | 14/20 [13:49<05:44, 57.37s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 95.97, Test_accy 91.33:  70%|███████   | 14/20 [15:18<05:44, 57.37s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 95.97, Test_accy 91.33:  75%|███████▌  | 15/20 [15:18<05:33, 66.70s/it]
Task 1, Epoch 16/20 => Loss 0.120, Train_accy 95.63:  75%|███████▌  | 15/20 [16:12<05:33, 66.70s/it]                 
Task 1, Epoch 16/20 => Loss 0.120, Train_accy 95.63:  80%|████████  | 16/20 [16:12<04:12, 63.05s/it]
Task 1, Epoch 17/20 => Loss 0.105, Train_accy 96.47:  80%|████████  | 16/20 [17:07<04:12, 63.05s/it]
Task 1, Epoch 17/20 => Loss 0.105, Train_accy 96.47:  85%|████████▌ | 17/20 [17:07<03:01, 60.51s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 95.91:  85%|████████▌ | 17/20 [18:01<03:01, 60.51s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 95.91:  90%|█████████ | 18/20 [18:01<01:57, 58.72s/it]
Task 1, Epoch 19/20 => Loss 0.111, Train_accy 96.21:  90%|█████████ | 18/20 [18:56<01:57, 58.72s/it]
Task 1, Epoch 19/20 => Loss 0.111, Train_accy 96.21:  95%|█████████▌| 19/20 [18:56<00:57, 57.47s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25:  95%|█████████▌| 19/20 [20:24<00:57, 57.47s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25: 100%|██████████| 20/20 [20:24<00:00, 66.74s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25: 100%|██████████| 20/20 [20:24<00:00, 61.23s/it]
2024-09-04 03:59:54,635 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25
2024-09-04 04:00:28,498 [trainer.py] => No NME accuracy.
2024-09-04 04:00:28,498 [trainer.py] => CNN: {'total': 91.25, '00-49': 94.36, '50-59': 75.7, 'old': 94.36, 'new': 75.7}
2024-09-04 04:00:28,498 [trainer.py] => CNN top1 curve: [94.72, 91.25]
2024-09-04 04:00:28,498 [trainer.py] => CNN top5 curve: [99.36, 99.0]

Average Accuracy (CNN): 92.98
2024-09-04 04:00:28,498 [trainer.py] => Average Accuracy (CNN): 92.98 

2024-09-04 04:00:28,499 [trainer.py] => All params: 89715556
2024-09-04 04:00:28,500 [trainer.py] => Trainable params: 89715556
2024-09-04 04:00:29,820 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.303, Train_accy 90.56:   0%|          | 0/20 [00:54<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.303, Train_accy 90.56:   5%|▌         | 1/20 [00:54<17:19, 54.70s/it]
Task 2, Epoch 2/20 => Loss 0.130, Train_accy 95.59:   5%|▌         | 1/20 [01:49<17:19, 54.70s/it]
Task 2, Epoch 2/20 => Loss 0.130, Train_accy 95.59:  10%|█         | 2/20 [01:49<16:26, 54.78s/it]
Task 2, Epoch 3/20 => Loss 0.131, Train_accy 96.05:  10%|█         | 2/20 [02:44<16:26, 54.78s/it]
Task 2, Epoch 3/20 => Loss 0.131, Train_accy 96.05:  15%|█▌        | 3/20 [02:44<15:31, 54.82s/it]
Task 2, Epoch 4/20 => Loss 0.116, Train_accy 96.17:  15%|█▌        | 3/20 [03:39<15:31, 54.82s/it]
Task 2, Epoch 4/20 => Loss 0.116, Train_accy 96.17:  20%|██        | 4/20 [03:39<14:36, 54.81s/it]
Task 2, Epoch 5/20 => Loss 0.099, Train_accy 96.75, Test_accy 87.04:  20%|██        | 4/20 [05:13<14:36, 54.81s/it]
Task 2, Epoch 5/20 => Loss 0.099, Train_accy 96.75, Test_accy 87.04:  25%|██▌       | 5/20 [05:13<17:14, 68.99s/it]
Task 2, Epoch 6/20 => Loss 0.106, Train_accy 96.35:  25%|██▌       | 5/20 [06:07<17:14, 68.99s/it]                 
Task 2, Epoch 6/20 => Loss 0.106, Train_accy 96.35:  30%|███       | 6/20 [06:07<14:53, 63.82s/it]
Task 2, Epoch 7/20 => Loss 0.098, Train_accy 96.61:  30%|███       | 6/20 [07:01<14:53, 63.82s/it]
Task 2, Epoch 7/20 => Loss 0.098, Train_accy 96.61:  35%|███▌      | 7/20 [07:01<13:08, 60.68s/it]
Task 2, Epoch 8/20 => Loss 0.097, Train_accy 96.81:  35%|███▌      | 7/20 [07:55<13:08, 60.68s/it]
Task 2, Epoch 8/20 => Loss 0.097, Train_accy 96.81:  40%|████      | 8/20 [07:55<11:44, 58.74s/it]
Task 2, Epoch 9/20 => Loss 0.096, Train_accy 96.96:  40%|████      | 8/20 [08:50<11:44, 58.74s/it]
Task 2, Epoch 9/20 => Loss 0.096, Train_accy 96.96:  45%|████▌     | 9/20 [08:50<10:31, 57.44s/it]
Task 2, Epoch 10/20 => Loss 0.085, Train_accy 97.30, Test_accy 88.33:  45%|████▌     | 9/20 [10:24<10:31, 57.44s/it]
Task 2, Epoch 10/20 => Loss 0.085, Train_accy 97.30, Test_accy 88.33:  50%|█████     | 10/20 [10:24<11:26, 68.69s/it]
Task 2, Epoch 11/20 => Loss 0.101, Train_accy 96.85:  50%|█████     | 10/20 [11:19<11:26, 68.69s/it]                 
Task 2, Epoch 11/20 => Loss 0.101, Train_accy 96.85:  55%|█████▌    | 11/20 [11:19<09:39, 64.40s/it]
Task 2, Epoch 12/20 => Loss 0.096, Train_accy 97.08:  55%|█████▌    | 11/20 [12:13<09:39, 64.40s/it]
Task 2, Epoch 12/20 => Loss 0.096, Train_accy 97.08:  60%|██████    | 12/20 [12:13<08:11, 61.45s/it]
Task 2, Epoch 13/20 => Loss 0.098, Train_accy 96.83:  60%|██████    | 12/20 [13:08<08:11, 61.45s/it]
Task 2, Epoch 13/20 => Loss 0.098, Train_accy 96.83:  65%|██████▌   | 13/20 [13:08<06:55, 59.41s/it]
Task 2, Epoch 14/20 => Loss 0.087, Train_accy 97.02:  65%|██████▌   | 13/20 [14:03<06:55, 59.41s/it]
Task 2, Epoch 14/20 => Loss 0.087, Train_accy 97.02:  70%|███████   | 14/20 [14:03<05:48, 58.00s/it]
Task 2, Epoch 15/20 => Loss 0.088, Train_accy 97.16, Test_accy 88.77:  70%|███████   | 14/20 [15:37<05:48, 58.00s/it]
Task 2, Epoch 15/20 => Loss 0.088, Train_accy 97.16, Test_accy 88.77:  75%|███████▌  | 15/20 [15:37<05:44, 68.88s/it]
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.36:  75%|███████▌  | 15/20 [16:32<05:44, 68.88s/it]                 
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.36:  80%|████████  | 16/20 [16:32<04:18, 64.62s/it]
Task 2, Epoch 17/20 => Loss 0.088, Train_accy 96.92:  80%|████████  | 16/20 [17:26<04:18, 64.62s/it]
Task 2, Epoch 17/20 => Loss 0.088, Train_accy 96.92:  85%|████████▌ | 17/20 [17:26<03:04, 61.63s/it]
Task 2, Epoch 18/20 => Loss 0.090, Train_accy 97.02:  85%|████████▌ | 17/20 [18:21<03:04, 61.63s/it]
Task 2, Epoch 18/20 => Loss 0.090, Train_accy 97.02:  90%|█████████ | 18/20 [18:21<01:59, 59.52s/it]
Task 2, Epoch 19/20 => Loss 0.097, Train_accy 97.20:  90%|█████████ | 18/20 [19:16<01:59, 59.52s/it]
Task 2, Epoch 19/20 => Loss 0.097, Train_accy 97.20:  95%|█████████▌| 19/20 [19:16<00:58, 58.07s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01:  95%|█████████▌| 19/20 [20:50<00:58, 58.07s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01: 100%|██████████| 20/20 [20:50<00:00, 68.86s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01: 100%|██████████| 20/20 [20:50<00:00, 62.50s/it]
2024-09-04 04:21:19,887 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01
2024-09-04 04:21:59,389 [trainer.py] => No NME accuracy.
2024-09-04 04:21:59,390 [trainer.py] => CNN: {'total': 89.01, '00-49': 94.26, '50-59': 74.1, '60-69': 77.7, 'old': 90.9, 'new': 77.7}
2024-09-04 04:21:59,390 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01]
2024-09-04 04:21:59,390 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8]

Average Accuracy (CNN): 91.66
2024-09-04 04:21:59,390 [trainer.py] => Average Accuracy (CNN): 91.66 

2024-09-04 04:21:59,391 [trainer.py] => All params: 89715556
2024-09-04 04:21:59,393 [trainer.py] => Trainable params: 89715556
2024-09-04 04:22:01,168 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.414, Train_accy 86.82:   0%|          | 0/20 [00:54<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.414, Train_accy 86.82:   5%|▌         | 1/20 [00:54<17:20, 54.78s/it]
Task 3, Epoch 2/20 => Loss 0.198, Train_accy 93.19:   5%|▌         | 1/20 [01:49<17:20, 54.78s/it]
Task 3, Epoch 2/20 => Loss 0.198, Train_accy 93.19:  10%|█         | 2/20 [01:49<16:26, 54.81s/it]
Task 3, Epoch 3/20 => Loss 0.170, Train_accy 93.85:  10%|█         | 2/20 [02:44<16:26, 54.81s/it]
Task 3, Epoch 3/20 => Loss 0.170, Train_accy 93.85:  15%|█▌        | 3/20 [02:44<15:31, 54.80s/it]
Task 3, Epoch 4/20 => Loss 0.161, Train_accy 94.61:  15%|█▌        | 3/20 [03:39<15:31, 54.80s/it]
Task 3, Epoch 4/20 => Loss 0.161, Train_accy 94.61:  20%|██        | 4/20 [03:39<14:36, 54.79s/it]
Task 3, Epoch 5/20 => Loss 0.163, Train_accy 94.27, Test_accy 83.14:  20%|██        | 4/20 [05:18<14:36, 54.79s/it]
Task 3, Epoch 5/20 => Loss 0.163, Train_accy 94.27, Test_accy 83.14:  25%|██▌       | 5/20 [05:18<17:44, 70.97s/it]
Task 3, Epoch 6/20 => Loss 0.152, Train_accy 94.49:  25%|██▌       | 5/20 [06:13<17:44, 70.97s/it]                 
Task 3, Epoch 6/20 => Loss 0.152, Train_accy 94.49:  30%|███       | 6/20 [06:13<15:17, 65.52s/it]
Task 3, Epoch 7/20 => Loss 0.136, Train_accy 95.03:  30%|███       | 6/20 [07:08<15:17, 65.52s/it]
Task 3, Epoch 7/20 => Loss 0.136, Train_accy 95.03:  35%|███▌      | 7/20 [07:08<13:26, 62.00s/it]
Task 3, Epoch 8/20 => Loss 0.126, Train_accy 95.71:  35%|███▌      | 7/20 [08:03<13:26, 62.00s/it]
Task 3, Epoch 8/20 => Loss 0.126, Train_accy 95.71:  40%|████      | 8/20 [08:03<11:56, 59.71s/it]
Task 3, Epoch 9/20 => Loss 0.131, Train_accy 95.79:  40%|████      | 8/20 [08:58<11:56, 59.71s/it]
Task 3, Epoch 9/20 => Loss 0.131, Train_accy 95.79:  45%|████▌     | 9/20 [08:58<10:39, 58.16s/it]
Task 3, Epoch 10/20 => Loss 0.125, Train_accy 95.53, Test_accy 84.42:  45%|████▌     | 9/20 [10:37<10:39, 58.16s/it]
Task 3, Epoch 10/20 => Loss 0.125, Train_accy 95.53, Test_accy 84.42:  50%|█████     | 10/20 [10:37<11:49, 70.97s/it]
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 95.37:  50%|█████     | 10/20 [11:32<11:49, 70.97s/it]                 
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 95.37:  55%|█████▌    | 11/20 [11:32<09:54, 66.03s/it]
Task 3, Epoch 12/20 => Loss 0.112, Train_accy 96.29:  55%|█████▌    | 11/20 [12:27<09:54, 66.03s/it]
Task 3, Epoch 12/20 => Loss 0.112, Train_accy 96.29:  60%|██████    | 12/20 [12:27<08:20, 62.59s/it]
Task 3, Epoch 13/20 => Loss 0.117, Train_accy 96.17:  60%|██████    | 12/20 [13:21<08:20, 62.59s/it]
Task 3, Epoch 13/20 => Loss 0.117, Train_accy 96.17:  65%|██████▌   | 13/20 [13:21<07:01, 60.20s/it]
Task 3, Epoch 14/20 => Loss 0.114, Train_accy 95.99:  65%|██████▌   | 13/20 [14:16<07:01, 60.20s/it]
Task 3, Epoch 14/20 => Loss 0.114, Train_accy 95.99:  70%|███████   | 14/20 [14:16<05:51, 58.58s/it]
Task 3, Epoch 15/20 => Loss 0.118, Train_accy 95.85, Test_accy 84.55:  70%|███████   | 14/20 [15:56<05:51, 58.58s/it]
Task 3, Epoch 15/20 => Loss 0.118, Train_accy 95.85, Test_accy 84.55:  75%|███████▌  | 15/20 [15:56<05:54, 70.96s/it]
Task 3, Epoch 16/20 => Loss 0.105, Train_accy 96.41:  75%|███████▌  | 15/20 [16:51<05:54, 70.96s/it]                 
Task 3, Epoch 16/20 => Loss 0.105, Train_accy 96.41:  80%|████████  | 16/20 [16:51<04:24, 66.06s/it]
Task 3, Epoch 17/20 => Loss 0.110, Train_accy 96.35:  80%|████████  | 16/20 [17:45<04:24, 66.06s/it]
Task 3, Epoch 17/20 => Loss 0.110, Train_accy 96.35:  85%|████████▌ | 17/20 [17:45<03:07, 62.64s/it]
Task 3, Epoch 18/20 => Loss 0.097, Train_accy 96.47:  85%|████████▌ | 17/20 [18:40<03:07, 62.64s/it]
Task 3, Epoch 18/20 => Loss 0.097, Train_accy 96.47:  90%|█████████ | 18/20 [18:40<02:00, 60.25s/it]
Task 3, Epoch 19/20 => Loss 0.101, Train_accy 96.43:  90%|█████████ | 18/20 [19:35<02:00, 60.25s/it]
Task 3, Epoch 19/20 => Loss 0.101, Train_accy 96.43:  95%|█████████▌| 19/20 [19:35<00:58, 58.57s/it]
Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46:  95%|█████████▌| 19/20 [21:14<00:58, 58.57s/it]
Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46: 100%|██████████| 20/20 [21:14<00:00, 70.85s/it]
Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46: 100%|██████████| 20/20 [21:14<00:00, 63.73s/it]
2024-09-04 04:43:15,874 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46
2024-09-04 04:44:00,775 [trainer.py] => No NME accuracy.
2024-09-04 04:44:00,776 [trainer.py] => CNN: {'total': 84.46, '00-49': 94.12, '50-59': 72.0, '60-69': 75.3, '70-79': 57.8, 'old': 88.27, 'new': 57.8}
2024-09-04 04:44:00,776 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01, 84.46]
2024-09-04 04:44:00,776 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8, 98.42]

Average Accuracy (CNN): 89.86
2024-09-04 04:44:00,776 [trainer.py] => Average Accuracy (CNN): 89.86 

2024-09-04 04:44:00,777 [trainer.py] => All params: 89715556
2024-09-04 04:44:00,778 [trainer.py] => Trainable params: 89715556
2024-09-04 04:44:03,032 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.408, Train_accy 86.52:   0%|          | 0/20 [00:54<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.408, Train_accy 86.52:   5%|▌         | 1/20 [00:54<17:19, 54.69s/it]
Task 4, Epoch 2/20 => Loss 0.158, Train_accy 94.63:   5%|▌         | 1/20 [01:49<17:19, 54.69s/it]
Task 4, Epoch 2/20 => Loss 0.158, Train_accy 94.63:  10%|█         | 2/20 [01:49<16:24, 54.68s/it]
Task 4, Epoch 3/20 => Loss 0.156, Train_accy 94.83:  10%|█         | 2/20 [02:44<16:24, 54.68s/it]
Task 4, Epoch 3/20 => Loss 0.156, Train_accy 94.83:  15%|█▌        | 3/20 [02:44<15:29, 54.70s/it]
Task 4, Epoch 4/20 => Loss 0.135, Train_accy 95.55:  15%|█▌        | 3/20 [03:38<15:29, 54.70s/it]
Task 4, Epoch 4/20 => Loss 0.135, Train_accy 95.55:  20%|██        | 4/20 [03:38<14:35, 54.73s/it]
Task 4, Epoch 5/20 => Loss 0.146, Train_accy 95.01, Test_accy 78.21:  20%|██        | 4/20 [05:24<14:35, 54.73s/it]
Task 4, Epoch 5/20 => Loss 0.146, Train_accy 95.01, Test_accy 78.21:  25%|██▌       | 5/20 [05:24<18:14, 72.99s/it]
Task 4, Epoch 6/20 => Loss 0.139, Train_accy 95.27:  25%|██▌       | 5/20 [06:19<18:14, 72.99s/it]                 
Task 4, Epoch 6/20 => Loss 0.139, Train_accy 95.27:  30%|███       | 6/20 [06:19<15:35, 66.85s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 95.35:  30%|███       | 6/20 [07:13<15:35, 66.85s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 95.35:  35%|███▌      | 7/20 [07:13<13:37, 62.91s/it]
Task 4, Epoch 8/20 => Loss 0.110, Train_accy 96.23:  35%|███▌      | 7/20 [08:08<13:37, 62.91s/it]
Task 4, Epoch 8/20 => Loss 0.110, Train_accy 96.23:  40%|████      | 8/20 [08:08<12:04, 60.34s/it]
Task 4, Epoch 9/20 => Loss 0.124, Train_accy 95.91:  40%|████      | 8/20 [09:03<12:04, 60.34s/it]
Task 4, Epoch 9/20 => Loss 0.124, Train_accy 95.91:  45%|████▌     | 9/20 [09:03<10:44, 58.61s/it]
Task 4, Epoch 10/20 => Loss 0.124, Train_accy 95.55, Test_accy 79.86:  45%|████▌     | 9/20 [10:48<10:44, 58.61s/it]
Task 4, Epoch 10/20 => Loss 0.124, Train_accy 95.55, Test_accy 79.86:  50%|█████     | 10/20 [10:48<12:10, 73.03s/it]
Task 4, Epoch 11/20 => Loss 0.121, Train_accy 95.99:  50%|█████     | 10/20 [11:43<12:10, 73.03s/it]                 
Task 4, Epoch 11/20 => Loss 0.121, Train_accy 95.99:  55%|█████▌    | 11/20 [11:43<10:07, 67.46s/it]
Task 4, Epoch 12/20 => Loss 0.117, Train_accy 96.31:  55%|█████▌    | 11/20 [12:38<10:07, 67.46s/it]
Task 4, Epoch 12/20 => Loss 0.117, Train_accy 96.31:  60%|██████    | 12/20 [12:38<08:29, 63.63s/it]
Task 4, Epoch 13/20 => Loss 0.114, Train_accy 96.15:  60%|██████    | 12/20 [13:33<08:29, 63.63s/it]
Task 4, Epoch 13/20 => Loss 0.114, Train_accy 96.15:  65%|██████▌   | 13/20 [13:33<07:06, 60.99s/it]
Task 4, Epoch 14/20 => Loss 0.112, Train_accy 96.35:  65%|██████▌   | 13/20 [14:28<07:06, 60.99s/it]
Task 4, Epoch 14/20 => Loss 0.112, Train_accy 96.35:  70%|███████   | 14/20 [14:28<05:54, 59.12s/it]
Task 4, Epoch 15/20 => Loss 0.117, Train_accy 96.15, Test_accy 80.39:  70%|███████   | 14/20 [16:13<05:54, 59.12s/it]
Task 4, Epoch 15/20 => Loss 0.117, Train_accy 96.15, Test_accy 80.39:  75%|███████▌  | 15/20 [16:13<06:05, 73.05s/it]
Task 4, Epoch 16/20 => Loss 0.110, Train_accy 96.59:  75%|███████▌  | 15/20 [17:08<06:05, 73.05s/it]                 
Task 4, Epoch 16/20 => Loss 0.110, Train_accy 96.59:  80%|████████  | 16/20 [17:08<04:30, 67.61s/it]
Task 4, Epoch 17/20 => Loss 0.119, Train_accy 95.95:  80%|████████  | 16/20 [18:03<04:30, 67.61s/it]
Task 4, Epoch 17/20 => Loss 0.119, Train_accy 95.95:  85%|████████▌ | 17/20 [18:03<03:11, 63.75s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.04:  85%|████████▌ | 17/20 [18:58<03:11, 63.75s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.04:  90%|█████████ | 18/20 [18:58<02:02, 61.07s/it]
Task 4, Epoch 19/20 => Loss 0.095, Train_accy 96.73:  90%|█████████ | 18/20 [19:53<02:02, 61.07s/it]
Task 4, Epoch 19/20 => Loss 0.095, Train_accy 96.73:  95%|█████████▌| 19/20 [19:53<00:59, 59.19s/it]
Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44:  95%|█████████▌| 19/20 [21:38<00:59, 59.19s/it]
Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44: 100%|██████████| 20/20 [21:38<00:00, 73.05s/it]
Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44: 100%|██████████| 20/20 [21:38<00:00, 64.92s/it]
2024-09-04 05:05:41,487 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44
2024-09-04 05:06:32,004 [trainer.py] => No NME accuracy.
2024-09-04 05:06:32,004 [trainer.py] => CNN: {'total': 80.44, '00-49': 94.12, '50-59': 70.4, '60-69': 75.5, '70-79': 55.7, '80-89': 51.8, 'old': 84.02, 'new': 51.8}
2024-09-04 05:06:32,004 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01, 84.46, 80.44]
2024-09-04 05:06:32,004 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8, 98.42, 97.99]

Average Accuracy (CNN): 87.98
2024-09-04 05:06:32,005 [trainer.py] => Average Accuracy (CNN): 87.98 

2024-09-04 05:06:32,006 [trainer.py] => All params: 89715556
2024-09-04 05:06:32,007 [trainer.py] => Trainable params: 89715556
2024-09-04 05:06:34,770 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.416, Train_accy 87.38:   0%|          | 0/20 [00:54<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.416, Train_accy 87.38:   5%|▌         | 1/20 [00:54<17:21, 54.84s/it]
Task 5, Epoch 2/20 => Loss 0.202, Train_accy 93.49:   5%|▌         | 1/20 [01:49<17:21, 54.84s/it]
Task 5, Epoch 2/20 => Loss 0.202, Train_accy 93.49:  10%|█         | 2/20 [01:49<16:27, 54.84s/it]
Task 5, Epoch 3/20 => Loss 0.196, Train_accy 93.41:  10%|█         | 2/20 [02:44<16:27, 54.84s/it]
Task 5, Epoch 3/20 => Loss 0.196, Train_accy 93.41:  15%|█▌        | 3/20 [02:44<15:31, 54.81s/it]
Task 5, Epoch 4/20 => Loss 0.180, Train_accy 93.95:  15%|█▌        | 3/20 [03:39<15:31, 54.81s/it]
Task 5, Epoch 4/20 => Loss 0.180, Train_accy 93.95:  20%|██        | 4/20 [03:39<14:36, 54.79s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.43, Test_accy 77.18:  20%|██        | 4/20 [05:29<14:36, 54.79s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.43, Test_accy 77.18:  25%|██▌       | 5/20 [05:29<18:43, 74.91s/it]
Task 5, Epoch 6/20 => Loss 0.152, Train_accy 94.85:  25%|██▌       | 5/20 [06:23<18:43, 74.91s/it]                 
Task 5, Epoch 6/20 => Loss 0.152, Train_accy 94.85:  30%|███       | 6/20 [06:23<15:47, 67.66s/it]
Task 5, Epoch 7/20 => Loss 0.141, Train_accy 95.19:  30%|███       | 6/20 [07:17<15:47, 67.66s/it]
Task 5, Epoch 7/20 => Loss 0.141, Train_accy 95.19:  35%|███▌      | 7/20 [07:17<13:43, 63.35s/it]
Task 5, Epoch 8/20 => Loss 0.155, Train_accy 95.11:  35%|███▌      | 7/20 [08:12<13:43, 63.35s/it]
Task 5, Epoch 8/20 => Loss 0.155, Train_accy 95.11:  40%|████      | 8/20 [08:12<12:07, 60.66s/it]
Task 5, Epoch 9/20 => Loss 0.142, Train_accy 95.41:  40%|████      | 8/20 [09:07<12:07, 60.66s/it]
Task 5, Epoch 9/20 => Loss 0.142, Train_accy 95.41:  45%|████▌     | 9/20 [09:07<10:47, 58.86s/it]
Task 5, Epoch 10/20 => Loss 0.127, Train_accy 95.71, Test_accy 78.14:  45%|████▌     | 9/20 [10:58<10:47, 58.86s/it]
Task 5, Epoch 10/20 => Loss 0.127, Train_accy 95.71, Test_accy 78.14:  50%|█████     | 10/20 [10:58<12:29, 74.94s/it]
Task 5, Epoch 11/20 => Loss 0.140, Train_accy 95.15:  50%|█████     | 10/20 [11:53<12:29, 74.94s/it]                 
Task 5, Epoch 11/20 => Loss 0.140, Train_accy 95.15:  55%|█████▌    | 11/20 [11:53<10:19, 68.79s/it]
Task 5, Epoch 12/20 => Loss 0.125, Train_accy 95.99:  55%|█████▌    | 11/20 [12:48<10:19, 68.79s/it]
Task 5, Epoch 12/20 => Loss 0.125, Train_accy 95.99:  60%|██████    | 12/20 [12:48<08:36, 64.56s/it]
Task 5, Epoch 13/20 => Loss 0.120, Train_accy 95.91:  60%|██████    | 12/20 [13:43<08:36, 64.56s/it]
Task 5, Epoch 13/20 => Loss 0.120, Train_accy 95.91:  65%|██████▌   | 13/20 [13:43<07:11, 61.68s/it]
Task 5, Epoch 14/20 => Loss 0.130, Train_accy 95.57:  65%|██████▌   | 13/20 [14:38<07:11, 61.68s/it]
Task 5, Epoch 14/20 => Loss 0.130, Train_accy 95.57:  70%|███████   | 14/20 [14:38<05:57, 59.65s/it]
Task 5, Epoch 15/20 => Loss 0.133, Train_accy 95.51, Test_accy 78.50:  70%|███████   | 14/20 [16:29<05:57, 59.65s/it]
Task 5, Epoch 15/20 => Loss 0.133, Train_accy 95.51, Test_accy 78.50:  75%|███████▌  | 15/20 [16:29<06:15, 75.14s/it]
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 96.47:  75%|███████▌  | 15/20 [17:24<06:15, 75.14s/it]                 
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 96.47:  80%|████████  | 16/20 [17:24<04:36, 69.01s/it]
Task 5, Epoch 17/20 => Loss 0.117, Train_accy 95.91:  80%|████████  | 16/20 [18:18<04:36, 69.01s/it]
Task 5, Epoch 17/20 => Loss 0.117, Train_accy 95.91:  85%|████████▌ | 17/20 [18:18<03:14, 64.73s/it]
Task 5, Epoch 18/20 => Loss 0.119, Train_accy 95.93:  85%|████████▌ | 17/20 [19:13<03:14, 64.73s/it]
Task 5, Epoch 18/20 => Loss 0.119, Train_accy 95.93:  90%|█████████ | 18/20 [19:13<02:03, 61.74s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 95.89:  90%|█████████ | 18/20 [20:08<02:03, 61.74s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 95.89:  95%|█████████▌| 19/20 [20:08<00:59, 59.65s/it]
Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39:  95%|█████████▌| 19/20 [21:59<00:59, 59.65s/it]
Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39: 100%|██████████| 20/20 [21:59<00:00, 75.02s/it]
Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39: 100%|██████████| 20/20 [21:59<00:00, 65.97s/it]
2024-09-04 05:28:34,175 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39
2024-09-04 05:29:30,187 [trainer.py] => No NME accuracy.
2024-09-04 05:29:30,187 [trainer.py] => CNN: {'total': 78.39, '00-49': 94.14, '50-59': 71.5, '60-69': 76.8, '70-79': 57.0, '80-89': 52.1, '90-99': 55.8, 'old': 80.9, 'new': 55.8}
2024-09-04 05:29:30,187 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01, 84.46, 80.44, 78.39]
2024-09-04 05:29:30,188 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8, 98.42, 97.99, 97.63]

Average Accuracy (CNN): 86.38
2024-09-04 05:29:30,188 [trainer.py] => Average Accuracy (CNN): 86.38 

Accuracy Matrix (CNN):
[[94.72 94.36 94.26 94.12 94.12 94.14]
 [ 0.   75.7  74.1  72.   70.4  71.5 ]
 [ 0.    0.   77.7  75.3  75.5  76.8 ]
 [ 0.    0.    0.   57.8  55.7  57.  ]
 [ 0.    0.    0.    0.   51.8  52.1 ]
 [ 0.    0.    0.    0.    0.   55.8 ]]
2024-09-04 05:29:30,189 [trainer.py] => Forgetting (CNN): 1.2960000000000007
2024-09-04 05:29:32,903 [trainer.py] => config: ./exps/coda_prompt_cifar_B50_Inc10.json
2024-09-04 05:29:32,903 [trainer.py] => prefix:  
2024-09-04 05:29:32,903 [trainer.py] => dataset: cifar224
2024-09-04 05:29:32,903 [trainer.py] => memory_size: 0
2024-09-04 05:29:32,903 [trainer.py] => memory_per_class: 0
2024-09-04 05:29:32,903 [trainer.py] => fixed_memory: False
2024-09-04 05:29:32,903 [trainer.py] => shuffle: True
2024-09-04 05:29:32,903 [trainer.py] => init_cls: 50
2024-09-04 05:29:32,903 [trainer.py] => increment: 5
2024-09-04 05:29:32,903 [trainer.py] => model_name: coda_prompt
2024-09-04 05:29:32,903 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-04 05:29:32,903 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 05:29:32,903 [trainer.py] => seed: 1993
2024-09-04 05:29:32,903 [trainer.py] => tuned_epoch: 20
2024-09-04 05:29:32,903 [trainer.py] => init_lr: 0.001
2024-09-04 05:29:32,903 [trainer.py] => batch_size: 48
2024-09-04 05:29:32,903 [trainer.py] => weight_decay: 0
2024-09-04 05:29:32,903 [trainer.py] => min_lr: 1e-05
2024-09-04 05:29:32,903 [trainer.py] => optimizer: adam
2024-09-04 05:29:32,903 [trainer.py] => scheduler: cosine
2024-09-04 05:29:32,903 [trainer.py] => reinit_optimizer: True
2024-09-04 05:29:32,903 [trainer.py] => pretrained: True
2024-09-04 05:29:32,903 [trainer.py] => drop: 0.0
2024-09-04 05:29:32,903 [trainer.py] => drop_path: 0.0
2024-09-04 05:29:32,903 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-04 05:29:34,004 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 05:29:36,014 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-04 05:29:36,014 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-04 05:29:36,014 [trainer.py] => All params: 89715556
2024-09-04 05:29:36,015 [trainer.py] => Trainable params: 89715556
2024-09-04 05:29:36,015 [coda_prompt.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.865, Train_accy 76.79:   0%|          | 0/20 [04:30<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.865, Train_accy 76.79:   5%|▌         | 1/20 [04:30<1:25:34, 270.22s/it]
Task 0, Epoch 2/20 => Loss 0.550, Train_accy 84.09:   5%|▌         | 1/20 [09:01<1:25:34, 270.22s/it]
Task 0, Epoch 2/20 => Loss 0.550, Train_accy 84.09:  10%|█         | 2/20 [09:01<1:21:10, 270.56s/it]
Task 0, Epoch 3/20 => Loss 0.508, Train_accy 85.48:  10%|█         | 2/20 [13:31<1:21:10, 270.56s/it]
Task 0, Epoch 3/20 => Loss 0.508, Train_accy 85.48:  15%|█▌        | 3/20 [13:31<1:16:40, 270.65s/it]
Task 0, Epoch 4/20 => Loss 0.480, Train_accy 86.37:  15%|█▌        | 3/20 [18:02<1:16:40, 270.65s/it]
Task 0, Epoch 4/20 => Loss 0.480, Train_accy 86.37:  20%|██        | 4/20 [18:02<1:12:10, 270.67s/it]
Task 0, Epoch 5/20 => Loss 0.454, Train_accy 86.94, Test_accy 94.80:  20%|██        | 4/20 [23:01<1:12:10, 270.67s/it]
Task 0, Epoch 5/20 => Loss 0.454, Train_accy 86.94, Test_accy 94.80:  25%|██▌       | 5/20 [23:01<1:10:15, 281.03s/it]
Task 0, Epoch 6/20 => Loss 0.447, Train_accy 87.20:  25%|██▌       | 5/20 [27:33<1:10:15, 281.03s/it]                 
Task 0, Epoch 6/20 => Loss 0.447, Train_accy 87.20:  30%|███       | 6/20 [27:33<1:04:47, 277.68s/it]
Task 0, Epoch 7/20 => Loss 0.424, Train_accy 87.57:  30%|███       | 6/20 [32:04<1:04:47, 277.68s/it]
Task 0, Epoch 7/20 => Loss 0.424, Train_accy 87.57:  35%|███▌      | 7/20 [32:04<59:44, 275.74s/it]  
Task 0, Epoch 8/20 => Loss 0.422, Train_accy 87.83:  35%|███▌      | 7/20 [36:35<59:44, 275.74s/it]
Task 0, Epoch 8/20 => Loss 0.422, Train_accy 87.83:  40%|████      | 8/20 [36:35<54:50, 274.25s/it]
Task 0, Epoch 9/20 => Loss 0.417, Train_accy 87.79:  40%|████      | 8/20 [41:06<54:50, 274.25s/it]
Task 0, Epoch 9/20 => Loss 0.417, Train_accy 87.79:  45%|████▌     | 9/20 [41:06<50:05, 273.27s/it]
Task 0, Epoch 10/20 => Loss 0.407, Train_accy 88.08, Test_accy 94.66:  45%|████▌     | 9/20 [46:06<50:05, 273.27s/it]
Task 0, Epoch 10/20 => Loss 0.407, Train_accy 88.08, Test_accy 94.66:  50%|█████     | 10/20 [46:06<46:53, 281.34s/it]
Task 0, Epoch 11/20 => Loss 0.402, Train_accy 88.33:  50%|█████     | 10/20 [50:38<46:53, 281.34s/it]                 
Task 0, Epoch 11/20 => Loss 0.402, Train_accy 88.33:  55%|█████▌    | 11/20 [50:38<41:45, 278.41s/it]
Task 0, Epoch 12/20 => Loss 0.380, Train_accy 88.88:  55%|█████▌    | 11/20 [55:09<41:45, 278.41s/it]
Task 0, Epoch 12/20 => Loss 0.380, Train_accy 88.88:  60%|██████    | 12/20 [55:09<36:49, 276.21s/it]
Task 0, Epoch 13/20 => Loss 0.381, Train_accy 89.03:  60%|██████    | 12/20 [59:40<36:49, 276.21s/it]
Task 0, Epoch 13/20 => Loss 0.381, Train_accy 89.03:  65%|██████▌   | 13/20 [59:40<32:02, 274.64s/it]
Task 0, Epoch 14/20 => Loss 0.373, Train_accy 89.00:  65%|██████▌   | 13/20 [1:04:11<32:02, 274.64s/it]
Task 0, Epoch 14/20 => Loss 0.373, Train_accy 89.00:  70%|███████   | 14/20 [1:04:11<27:20, 273.44s/it]
Task 0, Epoch 15/20 => Loss 0.363, Train_accy 89.49, Test_accy 94.86:  70%|███████   | 14/20 [1:09:10<27:20, 273.44s/it]
Task 0, Epoch 15/20 => Loss 0.363, Train_accy 89.49, Test_accy 94.86:  75%|███████▌  | 15/20 [1:09:10<23:26, 281.29s/it]
Task 0, Epoch 16/20 => Loss 0.368, Train_accy 89.08:  75%|███████▌  | 15/20 [1:13:41<23:26, 281.29s/it]                 
Task 0, Epoch 16/20 => Loss 0.368, Train_accy 89.08:  80%|████████  | 16/20 [1:13:41<18:33, 278.27s/it]
Task 0, Epoch 17/20 => Loss 0.352, Train_accy 89.66:  80%|████████  | 16/20 [1:18:13<18:33, 278.27s/it]
Task 0, Epoch 17/20 => Loss 0.352, Train_accy 89.66:  85%|████████▌ | 17/20 [1:18:13<13:49, 276.41s/it]
Task 0, Epoch 18/20 => Loss 0.340, Train_accy 89.93:  85%|████████▌ | 17/20 [1:22:45<13:49, 276.41s/it]
Task 0, Epoch 18/20 => Loss 0.340, Train_accy 89.93:  90%|█████████ | 18/20 [1:22:45<09:09, 274.97s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 89.92:  90%|█████████ | 18/20 [1:27:17<09:09, 274.97s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 89.92:  95%|█████████▌| 19/20 [1:27:17<04:33, 273.95s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82:  95%|█████████▌| 19/20 [1:32:16<04:33, 273.95s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82: 100%|██████████| 20/20 [1:32:16<00:00, 281.67s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82: 100%|██████████| 20/20 [1:32:16<00:00, 276.83s/it]
2024-09-04 07:01:53,216 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82
2024-09-04 07:02:21,508 [trainer.py] => No NME accuracy.
2024-09-04 07:02:21,509 [trainer.py] => CNN: {'total': 94.82, '00-49': 94.82, 'old': 0, 'new': 94.82}
2024-09-04 07:02:21,509 [trainer.py] => CNN top1 curve: [94.82]
2024-09-04 07:02:21,509 [trainer.py] => CNN top5 curve: [99.42]

Average Accuracy (CNN): 94.82
2024-09-04 07:02:21,509 [trainer.py] => Average Accuracy (CNN): 94.82 

2024-09-04 07:02:21,510 [trainer.py] => All params: 89715556
2024-09-04 07:02:21,510 [trainer.py] => Trainable params: 89715556
2024-09-04 07:02:21,774 [coda_prompt.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.292, Train_accy 90.71:   0%|          | 0/20 [00:27<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.292, Train_accy 90.71:   5%|▌         | 1/20 [00:27<08:42, 27.48s/it]
Task 1, Epoch 2/20 => Loss 0.079, Train_accy 97.28:   5%|▌         | 1/20 [00:54<08:42, 27.48s/it]
Task 1, Epoch 2/20 => Loss 0.079, Train_accy 97.28:  10%|█         | 2/20 [00:54<08:14, 27.47s/it]
Task 1, Epoch 3/20 => Loss 0.077, Train_accy 97.40:  10%|█         | 2/20 [01:22<08:14, 27.47s/it]
Task 1, Epoch 3/20 => Loss 0.077, Train_accy 97.40:  15%|█▌        | 3/20 [01:22<07:46, 27.47s/it]
Task 1, Epoch 4/20 => Loss 0.066, Train_accy 97.84:  15%|█▌        | 3/20 [01:49<07:46, 27.47s/it]
Task 1, Epoch 4/20 => Loss 0.066, Train_accy 97.84:  20%|██        | 4/20 [01:49<07:19, 27.47s/it]
Task 1, Epoch 5/20 => Loss 0.058, Train_accy 98.28, Test_accy 88.55:  20%|██        | 4/20 [02:48<07:19, 27.47s/it]
Task 1, Epoch 5/20 => Loss 0.058, Train_accy 98.28, Test_accy 88.55:  25%|██▌       | 5/20 [02:48<09:40, 38.68s/it]
Task 1, Epoch 6/20 => Loss 0.055, Train_accy 98.24:  25%|██▌       | 5/20 [03:15<09:40, 38.68s/it]                 
Task 1, Epoch 6/20 => Loss 0.055, Train_accy 98.24:  30%|███       | 6/20 [03:15<08:07, 34.84s/it]
Task 1, Epoch 7/20 => Loss 0.056, Train_accy 98.00:  30%|███       | 6/20 [03:43<08:07, 34.84s/it]
Task 1, Epoch 7/20 => Loss 0.056, Train_accy 98.00:  35%|███▌      | 7/20 [03:43<07:01, 32.42s/it]
Task 1, Epoch 8/20 => Loss 0.058, Train_accy 98.16:  35%|███▌      | 7/20 [04:10<07:01, 32.42s/it]
Task 1, Epoch 8/20 => Loss 0.058, Train_accy 98.16:  40%|████      | 8/20 [04:10<06:10, 30.85s/it]
Task 1, Epoch 9/20 => Loss 0.057, Train_accy 98.12:  40%|████      | 8/20 [04:38<06:10, 30.85s/it]
Task 1, Epoch 9/20 => Loss 0.057, Train_accy 98.12:  45%|████▌     | 9/20 [04:38<05:27, 29.80s/it]
Task 1, Epoch 10/20 => Loss 0.052, Train_accy 98.24, Test_accy 89.16:  45%|████▌     | 9/20 [05:36<05:27, 29.80s/it]
Task 1, Epoch 10/20 => Loss 0.052, Train_accy 98.24, Test_accy 89.16:  50%|█████     | 10/20 [05:36<06:26, 38.64s/it]
Task 1, Epoch 11/20 => Loss 0.054, Train_accy 98.12:  50%|█████     | 10/20 [06:04<06:26, 38.64s/it]                 
Task 1, Epoch 11/20 => Loss 0.054, Train_accy 98.12:  55%|█████▌    | 11/20 [06:04<05:16, 35.22s/it]
Task 1, Epoch 12/20 => Loss 0.060, Train_accy 97.96:  55%|█████▌    | 11/20 [06:31<05:16, 35.22s/it]
Task 1, Epoch 12/20 => Loss 0.060, Train_accy 97.96:  60%|██████    | 12/20 [06:31<04:22, 32.85s/it]
Task 1, Epoch 13/20 => Loss 0.045, Train_accy 98.44:  60%|██████    | 12/20 [06:58<04:22, 32.85s/it]
Task 1, Epoch 13/20 => Loss 0.045, Train_accy 98.44:  65%|██████▌   | 13/20 [06:58<03:38, 31.20s/it]
Task 1, Epoch 14/20 => Loss 0.050, Train_accy 98.28:  65%|██████▌   | 13/20 [07:26<03:38, 31.20s/it]
Task 1, Epoch 14/20 => Loss 0.050, Train_accy 98.28:  70%|███████   | 14/20 [07:26<03:00, 30.06s/it]
Task 1, Epoch 15/20 => Loss 0.045, Train_accy 98.48, Test_accy 89.40:  70%|███████   | 14/20 [08:24<03:00, 30.06s/it]
Task 1, Epoch 15/20 => Loss 0.045, Train_accy 98.48, Test_accy 89.40:  75%|███████▌  | 15/20 [08:24<03:13, 38.61s/it]
Task 1, Epoch 16/20 => Loss 0.045, Train_accy 98.40:  75%|███████▌  | 15/20 [08:52<03:13, 38.61s/it]                 
Task 1, Epoch 16/20 => Loss 0.045, Train_accy 98.40:  80%|████████  | 16/20 [08:52<02:20, 35.25s/it]
Task 1, Epoch 17/20 => Loss 0.045, Train_accy 98.32:  80%|████████  | 16/20 [09:19<02:20, 35.25s/it]
Task 1, Epoch 17/20 => Loss 0.045, Train_accy 98.32:  85%|████████▌ | 17/20 [09:19<01:38, 32.89s/it]
Task 1, Epoch 18/20 => Loss 0.052, Train_accy 98.32:  85%|████████▌ | 17/20 [09:47<01:38, 32.89s/it]
Task 1, Epoch 18/20 => Loss 0.052, Train_accy 98.32:  90%|█████████ | 18/20 [09:47<01:02, 31.28s/it]
Task 1, Epoch 19/20 => Loss 0.050, Train_accy 98.28:  90%|█████████ | 18/20 [10:14<01:02, 31.28s/it]
Task 1, Epoch 19/20 => Loss 0.050, Train_accy 98.28:  95%|█████████▌| 19/20 [10:14<00:30, 30.11s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71:  95%|█████████▌| 19/20 [11:13<00:30, 30.11s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71: 100%|██████████| 20/20 [11:13<00:00, 38.61s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71: 100%|██████████| 20/20 [11:13<00:00, 33.65s/it]
2024-09-04 07:13:34,856 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71
2024-09-04 07:14:05,898 [trainer.py] => No NME accuracy.
2024-09-04 07:14:05,899 [trainer.py] => CNN: {'total': 89.71, '00-49': 94.42, '50-54': 42.6, 'old': 94.42, 'new': 42.6}
2024-09-04 07:14:05,899 [trainer.py] => CNN top1 curve: [94.82, 89.71]
2024-09-04 07:14:05,899 [trainer.py] => CNN top5 curve: [99.42, 99.11]

Average Accuracy (CNN): 92.26
2024-09-04 07:14:05,899 [trainer.py] => Average Accuracy (CNN): 92.26 

2024-09-04 07:14:05,900 [trainer.py] => All params: 89715556
2024-09-04 07:14:05,901 [trainer.py] => Trainable params: 89715556
2024-09-04 07:14:06,317 [coda_prompt.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.544, Train_accy 80.49:   0%|          | 0/20 [00:27<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.544, Train_accy 80.49:   5%|▌         | 1/20 [00:27<08:42, 27.48s/it]
Task 2, Epoch 2/20 => Loss 0.222, Train_accy 91.55:   5%|▌         | 1/20 [00:55<08:42, 27.48s/it]
Task 2, Epoch 2/20 => Loss 0.222, Train_accy 91.55:  10%|█         | 2/20 [00:55<08:15, 27.51s/it]
Task 2, Epoch 3/20 => Loss 0.206, Train_accy 91.55:  10%|█         | 2/20 [01:22<08:15, 27.51s/it]
Task 2, Epoch 3/20 => Loss 0.206, Train_accy 91.55:  15%|█▌        | 3/20 [01:22<07:47, 27.51s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 93.35:  15%|█▌        | 3/20 [01:50<07:47, 27.51s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 93.35:  20%|██        | 4/20 [01:50<07:20, 27.50s/it]
Task 2, Epoch 5/20 => Loss 0.164, Train_accy 93.27, Test_accy 85.50:  20%|██        | 4/20 [02:51<07:20, 27.50s/it]
Task 2, Epoch 5/20 => Loss 0.164, Train_accy 93.27, Test_accy 85.50:  25%|██▌       | 5/20 [02:51<09:56, 39.76s/it]
Task 2, Epoch 6/20 => Loss 0.163, Train_accy 93.43:  25%|██▌       | 5/20 [03:19<09:56, 39.76s/it]                 
Task 2, Epoch 6/20 => Loss 0.163, Train_accy 93.43:  30%|███       | 6/20 [03:19<08:18, 35.59s/it]
Task 2, Epoch 7/20 => Loss 0.137, Train_accy 94.39:  30%|███       | 6/20 [03:46<08:18, 35.59s/it]
Task 2, Epoch 7/20 => Loss 0.137, Train_accy 94.39:  35%|███▌      | 7/20 [03:46<07:08, 32.93s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 94.31:  35%|███▌      | 7/20 [04:13<07:08, 32.93s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 94.31:  40%|████      | 8/20 [04:13<06:14, 31.19s/it]
Task 2, Epoch 9/20 => Loss 0.140, Train_accy 94.27:  40%|████      | 8/20 [04:41<06:14, 31.19s/it]
Task 2, Epoch 9/20 => Loss 0.140, Train_accy 94.27:  45%|████▌     | 9/20 [04:41<05:30, 30.06s/it]
Task 2, Epoch 10/20 => Loss 0.155, Train_accy 94.23, Test_accy 86.00:  45%|████▌     | 9/20 [05:42<05:30, 30.06s/it]
Task 2, Epoch 10/20 => Loss 0.155, Train_accy 94.23, Test_accy 86.00:  50%|█████     | 10/20 [05:42<06:37, 39.73s/it]
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 93.95:  50%|█████     | 10/20 [06:10<06:37, 39.73s/it]                 
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 93.95:  55%|█████▌    | 11/20 [06:10<05:23, 35.98s/it]
Task 2, Epoch 12/20 => Loss 0.139, Train_accy 94.91:  55%|█████▌    | 11/20 [06:37<05:23, 35.98s/it]
Task 2, Epoch 12/20 => Loss 0.139, Train_accy 94.91:  60%|██████    | 12/20 [06:37<04:27, 33.40s/it]
Task 2, Epoch 13/20 => Loss 0.136, Train_accy 94.63:  60%|██████    | 12/20 [07:05<04:27, 33.40s/it]
Task 2, Epoch 13/20 => Loss 0.136, Train_accy 94.63:  65%|██████▌   | 13/20 [07:05<03:41, 31.61s/it]
Task 2, Epoch 14/20 => Loss 0.134, Train_accy 94.95:  65%|██████▌   | 13/20 [07:32<03:41, 31.61s/it]
Task 2, Epoch 14/20 => Loss 0.134, Train_accy 94.95:  70%|███████   | 14/20 [07:32<03:02, 30.39s/it]
Task 2, Epoch 15/20 => Loss 0.142, Train_accy 93.91, Test_accy 86.10:  70%|███████   | 14/20 [08:34<03:02, 30.39s/it]
Task 2, Epoch 15/20 => Loss 0.142, Train_accy 93.91, Test_accy 86.10:  75%|███████▌  | 15/20 [08:34<03:18, 39.75s/it]
Task 2, Epoch 16/20 => Loss 0.114, Train_accy 95.47:  75%|███████▌  | 15/20 [09:01<03:18, 39.75s/it]                 
Task 2, Epoch 16/20 => Loss 0.114, Train_accy 95.47:  80%|████████  | 16/20 [09:01<02:24, 36.06s/it]
Task 2, Epoch 17/20 => Loss 0.145, Train_accy 94.43:  80%|████████  | 16/20 [09:29<02:24, 36.06s/it]
Task 2, Epoch 17/20 => Loss 0.145, Train_accy 94.43:  85%|████████▌ | 17/20 [09:29<01:40, 33.48s/it]
Task 2, Epoch 18/20 => Loss 0.117, Train_accy 95.75:  85%|████████▌ | 17/20 [09:56<01:40, 33.48s/it]
Task 2, Epoch 18/20 => Loss 0.117, Train_accy 95.75:  90%|█████████ | 18/20 [09:56<01:03, 31.69s/it]
Task 2, Epoch 19/20 => Loss 0.130, Train_accy 94.75:  90%|█████████ | 18/20 [10:24<01:03, 31.69s/it]
Task 2, Epoch 19/20 => Loss 0.130, Train_accy 94.75:  95%|█████████▌| 19/20 [10:24<00:30, 30.44s/it]
Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13:  95%|█████████▌| 19/20 [11:25<00:30, 30.44s/it]
Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13: 100%|██████████| 20/20 [11:25<00:00, 39.72s/it]
Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13: 100%|██████████| 20/20 [11:25<00:00, 34.29s/it]
2024-09-04 07:25:32,045 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13
2024-09-04 07:26:05,874 [trainer.py] => No NME accuracy.
2024-09-04 07:26:05,875 [trainer.py] => CNN: {'total': 86.13, '00-49': 93.9, '50-54': 41.0, '55-59': 53.6, 'old': 89.09, 'new': 53.6}
2024-09-04 07:26:05,875 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13]
2024-09-04 07:26:05,875 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08]

Average Accuracy (CNN): 90.22
2024-09-04 07:26:05,875 [trainer.py] => Average Accuracy (CNN): 90.22 

2024-09-04 07:26:05,876 [trainer.py] => All params: 89715556
2024-09-04 07:26:05,877 [trainer.py] => Trainable params: 89715556
2024-09-04 07:26:06,443 [coda_prompt.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.240, Train_accy 91.43:   0%|          | 0/20 [00:27<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.240, Train_accy 91.43:   5%|▌         | 1/20 [00:27<08:42, 27.50s/it]
Task 3, Epoch 2/20 => Loss 0.082, Train_accy 97.36:   5%|▌         | 1/20 [00:55<08:42, 27.50s/it]
Task 3, Epoch 2/20 => Loss 0.082, Train_accy 97.36:  10%|█         | 2/20 [00:55<08:15, 27.51s/it]
Task 3, Epoch 3/20 => Loss 0.066, Train_accy 97.80:  10%|█         | 2/20 [01:22<08:15, 27.51s/it]
Task 3, Epoch 3/20 => Loss 0.066, Train_accy 97.80:  15%|█▌        | 3/20 [01:22<07:47, 27.51s/it]
Task 3, Epoch 4/20 => Loss 0.070, Train_accy 97.52:  15%|█▌        | 3/20 [01:49<07:47, 27.51s/it]
Task 3, Epoch 4/20 => Loss 0.070, Train_accy 97.52:  20%|██        | 4/20 [01:49<07:19, 27.49s/it]
Task 3, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 81.45:  20%|██        | 4/20 [02:54<07:19, 27.49s/it]
Task 3, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 81.45:  25%|██▌       | 5/20 [02:54<10:10, 40.69s/it]
Task 3, Epoch 6/20 => Loss 0.059, Train_accy 97.92:  25%|██▌       | 5/20 [03:21<10:10, 40.69s/it]                 
Task 3, Epoch 6/20 => Loss 0.059, Train_accy 97.92:  30%|███       | 6/20 [03:21<08:26, 36.21s/it]
Task 3, Epoch 7/20 => Loss 0.048, Train_accy 98.24:  30%|███       | 6/20 [03:49<08:26, 36.21s/it]
Task 3, Epoch 7/20 => Loss 0.048, Train_accy 98.24:  35%|███▌      | 7/20 [03:49<07:13, 33.36s/it]
Task 3, Epoch 8/20 => Loss 0.044, Train_accy 98.56:  35%|███▌      | 7/20 [04:16<07:13, 33.36s/it]
Task 3, Epoch 8/20 => Loss 0.044, Train_accy 98.56:  40%|████      | 8/20 [04:16<06:17, 31.50s/it]
Task 3, Epoch 9/20 => Loss 0.051, Train_accy 98.28:  40%|████      | 8/20 [04:44<06:17, 31.50s/it]
Task 3, Epoch 9/20 => Loss 0.051, Train_accy 98.28:  45%|████▌     | 9/20 [04:44<05:32, 30.25s/it]
Task 3, Epoch 10/20 => Loss 0.058, Train_accy 98.00, Test_accy 82.54:  45%|████▌     | 9/20 [05:48<05:32, 30.25s/it]
Task 3, Epoch 10/20 => Loss 0.058, Train_accy 98.00, Test_accy 82.54:  50%|█████     | 10/20 [05:48<06:47, 40.78s/it]
Task 3, Epoch 11/20 => Loss 0.061, Train_accy 98.24:  50%|█████     | 10/20 [06:15<06:47, 40.78s/it]                 
Task 3, Epoch 11/20 => Loss 0.061, Train_accy 98.24:  55%|█████▌    | 11/20 [06:15<05:30, 36.70s/it]
Task 3, Epoch 12/20 => Loss 0.052, Train_accy 98.36:  55%|█████▌    | 11/20 [06:43<05:30, 36.70s/it]
Task 3, Epoch 12/20 => Loss 0.052, Train_accy 98.36:  60%|██████    | 12/20 [06:43<04:31, 33.90s/it]
Task 3, Epoch 13/20 => Loss 0.042, Train_accy 98.56:  60%|██████    | 12/20 [07:10<04:31, 33.90s/it]
Task 3, Epoch 13/20 => Loss 0.042, Train_accy 98.56:  65%|██████▌   | 13/20 [07:10<03:43, 31.97s/it]
Task 3, Epoch 14/20 => Loss 0.054, Train_accy 98.00:  65%|██████▌   | 13/20 [07:38<03:43, 31.97s/it]
Task 3, Epoch 14/20 => Loss 0.054, Train_accy 98.00:  70%|███████   | 14/20 [07:38<03:03, 30.61s/it]
Task 3, Epoch 15/20 => Loss 0.032, Train_accy 98.72, Test_accy 83.23:  70%|███████   | 14/20 [08:42<03:03, 30.61s/it]
Task 3, Epoch 15/20 => Loss 0.032, Train_accy 98.72, Test_accy 83.23:  75%|███████▌  | 15/20 [08:42<03:23, 40.71s/it]
Task 3, Epoch 16/20 => Loss 0.052, Train_accy 97.96:  75%|███████▌  | 15/20 [09:09<03:23, 40.71s/it]                 
Task 3, Epoch 16/20 => Loss 0.052, Train_accy 97.96:  80%|████████  | 16/20 [09:09<02:26, 36.73s/it]
Task 3, Epoch 17/20 => Loss 0.047, Train_accy 98.52:  80%|████████  | 16/20 [09:37<02:26, 36.73s/it]
Task 3, Epoch 17/20 => Loss 0.047, Train_accy 98.52:  85%|████████▌ | 17/20 [09:37<01:41, 33.94s/it]
Task 3, Epoch 18/20 => Loss 0.035, Train_accy 98.80:  85%|████████▌ | 17/20 [10:04<01:41, 33.94s/it]
Task 3, Epoch 18/20 => Loss 0.035, Train_accy 98.80:  90%|█████████ | 18/20 [10:04<01:03, 31.98s/it]
Task 3, Epoch 19/20 => Loss 0.049, Train_accy 98.24:  90%|█████████ | 18/20 [10:32<01:03, 31.98s/it]
Task 3, Epoch 19/20 => Loss 0.049, Train_accy 98.24:  95%|█████████▌| 19/20 [10:32<00:30, 30.65s/it]
Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26:  95%|█████████▌| 19/20 [11:36<00:30, 30.65s/it]
Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26: 100%|██████████| 20/20 [11:36<00:00, 40.61s/it]
Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26: 100%|██████████| 20/20 [11:36<00:00, 34.81s/it]
2024-09-04 07:37:42,701 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26
2024-09-04 07:38:19,158 [trainer.py] => No NME accuracy.
2024-09-04 07:38:19,158 [trainer.py] => CNN: {'total': 83.26, '00-49': 94.04, '50-54': 40.2, '55-59': 45.8, '60-64': 56.0, 'old': 85.53, 'new': 56.0}
2024-09-04 07:38:19,158 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26]
2024-09-04 07:38:19,158 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72]

Average Accuracy (CNN): 88.48
2024-09-04 07:38:19,159 [trainer.py] => Average Accuracy (CNN): 88.48 

2024-09-04 07:38:19,160 [trainer.py] => All params: 89715556
2024-09-04 07:38:19,161 [trainer.py] => Trainable params: 89715556
2024-09-04 07:38:19,887 [coda_prompt.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.308, Train_accy 89.58:   0%|          | 0/20 [00:27<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.308, Train_accy 89.58:   5%|▌         | 1/20 [00:27<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.049, Train_accy 98.32:   5%|▌         | 1/20 [00:54<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.049, Train_accy 98.32:  10%|█         | 2/20 [00:54<08:13, 27.44s/it]
Task 4, Epoch 3/20 => Loss 0.066, Train_accy 98.20:  10%|█         | 2/20 [01:22<08:13, 27.44s/it]
Task 4, Epoch 3/20 => Loss 0.066, Train_accy 98.20:  15%|█▌        | 3/20 [01:22<07:46, 27.43s/it]
Task 4, Epoch 4/20 => Loss 0.045, Train_accy 98.44:  15%|█▌        | 3/20 [01:49<07:46, 27.43s/it]
Task 4, Epoch 4/20 => Loss 0.045, Train_accy 98.44:  20%|██        | 4/20 [01:49<07:18, 27.41s/it]
Task 4, Epoch 5/20 => Loss 0.062, Train_accy 97.84, Test_accy 79.31:  20%|██        | 4/20 [02:56<07:18, 27.41s/it]
Task 4, Epoch 5/20 => Loss 0.062, Train_accy 97.84, Test_accy 79.31:  25%|██▌       | 5/20 [02:56<10:24, 41.61s/it]
Task 4, Epoch 6/20 => Loss 0.052, Train_accy 98.36:  25%|██▌       | 5/20 [03:23<10:24, 41.61s/it]                 
Task 4, Epoch 6/20 => Loss 0.052, Train_accy 98.36:  30%|███       | 6/20 [03:23<08:35, 36.81s/it]
Task 4, Epoch 7/20 => Loss 0.053, Train_accy 98.24:  30%|███       | 6/20 [03:51<08:35, 36.81s/it]
Task 4, Epoch 7/20 => Loss 0.053, Train_accy 98.24:  35%|███▌      | 7/20 [03:51<07:19, 33.78s/it]
Task 4, Epoch 8/20 => Loss 0.034, Train_accy 99.00:  35%|███▌      | 7/20 [04:18<07:19, 33.78s/it]
Task 4, Epoch 8/20 => Loss 0.034, Train_accy 99.00:  40%|████      | 8/20 [04:18<06:21, 31.78s/it]
Task 4, Epoch 9/20 => Loss 0.050, Train_accy 98.52:  40%|████      | 8/20 [04:46<06:21, 31.78s/it]
Task 4, Epoch 9/20 => Loss 0.050, Train_accy 98.52:  45%|████▌     | 9/20 [04:46<05:34, 30.44s/it]
Task 4, Epoch 10/20 => Loss 0.052, Train_accy 98.28, Test_accy 79.93:  45%|████▌     | 9/20 [05:53<05:34, 30.44s/it]
Task 4, Epoch 10/20 => Loss 0.052, Train_accy 98.28, Test_accy 79.93:  50%|█████     | 10/20 [05:53<06:56, 41.68s/it]
Task 4, Epoch 11/20 => Loss 0.033, Train_accy 98.88:  50%|█████     | 10/20 [06:20<06:56, 41.68s/it]                 
Task 4, Epoch 11/20 => Loss 0.033, Train_accy 98.88:  55%|█████▌    | 11/20 [06:20<05:36, 37.35s/it]
Task 4, Epoch 12/20 => Loss 0.045, Train_accy 98.36:  55%|█████▌    | 11/20 [06:48<05:36, 37.35s/it]
Task 4, Epoch 12/20 => Loss 0.045, Train_accy 98.36:  60%|██████    | 12/20 [06:48<04:34, 34.37s/it]
Task 4, Epoch 13/20 => Loss 0.034, Train_accy 98.72:  60%|██████    | 12/20 [07:15<04:34, 34.37s/it]
Task 4, Epoch 13/20 => Loss 0.034, Train_accy 98.72:  65%|██████▌   | 13/20 [07:15<03:46, 32.29s/it]
Task 4, Epoch 14/20 => Loss 0.037, Train_accy 98.80:  65%|██████▌   | 13/20 [07:43<03:46, 32.29s/it]
Task 4, Epoch 14/20 => Loss 0.037, Train_accy 98.80:  70%|███████   | 14/20 [07:43<03:05, 30.85s/it]
Task 4, Epoch 15/20 => Loss 0.044, Train_accy 98.56, Test_accy 80.26:  70%|███████   | 14/20 [08:50<03:05, 30.85s/it]
Task 4, Epoch 15/20 => Loss 0.044, Train_accy 98.56, Test_accy 80.26:  75%|███████▌  | 15/20 [08:50<03:28, 41.69s/it]
Task 4, Epoch 16/20 => Loss 0.032, Train_accy 98.92:  75%|███████▌  | 15/20 [09:17<03:28, 41.69s/it]                 
Task 4, Epoch 16/20 => Loss 0.032, Train_accy 98.92:  80%|████████  | 16/20 [09:17<02:29, 37.41s/it]
Task 4, Epoch 17/20 => Loss 0.030, Train_accy 98.80:  80%|████████  | 16/20 [09:45<02:29, 37.41s/it]
Task 4, Epoch 17/20 => Loss 0.030, Train_accy 98.80:  85%|████████▌ | 17/20 [09:45<01:43, 34.42s/it]
Task 4, Epoch 18/20 => Loss 0.042, Train_accy 98.40:  85%|████████▌ | 17/20 [10:12<01:43, 34.42s/it]
Task 4, Epoch 18/20 => Loss 0.042, Train_accy 98.40:  90%|█████████ | 18/20 [10:12<01:04, 32.34s/it]
Task 4, Epoch 19/20 => Loss 0.032, Train_accy 99.04:  90%|█████████ | 18/20 [10:40<01:04, 32.34s/it]
Task 4, Epoch 19/20 => Loss 0.032, Train_accy 99.04:  95%|█████████▌| 19/20 [10:40<00:30, 30.87s/it]
Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39:  95%|█████████▌| 19/20 [11:47<00:30, 30.87s/it]
Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39: 100%|██████████| 20/20 [11:47<00:00, 41.72s/it]
Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39: 100%|██████████| 20/20 [11:47<00:00, 35.36s/it]
2024-09-04 07:50:07,077 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39
2024-09-04 07:50:46,480 [trainer.py] => No NME accuracy.
2024-09-04 07:50:46,480 [trainer.py] => CNN: {'total': 80.39, '00-49': 94.08, '50-54': 42.0, '55-59': 45.8, '60-64': 55.2, '65-69': 41.6, 'old': 83.37, 'new': 41.6}
2024-09-04 07:50:46,480 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39]
2024-09-04 07:50:46,480 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51]

Average Accuracy (CNN): 86.86
2024-09-04 07:50:46,481 [trainer.py] => Average Accuracy (CNN): 86.86 

2024-09-04 07:50:46,482 [trainer.py] => All params: 89715556
2024-09-04 07:50:46,483 [trainer.py] => Trainable params: 89715556
2024-09-04 07:50:47,367 [coda_prompt.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.331, Train_accy 88.46:   0%|          | 0/20 [00:27<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.331, Train_accy 88.46:   5%|▌         | 1/20 [00:27<08:43, 27.53s/it]
Task 5, Epoch 2/20 => Loss 0.096, Train_accy 96.79:   5%|▌         | 1/20 [00:55<08:43, 27.53s/it]
Task 5, Epoch 2/20 => Loss 0.096, Train_accy 96.79:  10%|█         | 2/20 [00:55<08:15, 27.53s/it]
Task 5, Epoch 3/20 => Loss 0.086, Train_accy 96.92:  10%|█         | 2/20 [01:22<08:15, 27.53s/it]
Task 5, Epoch 3/20 => Loss 0.086, Train_accy 96.92:  15%|█▌        | 3/20 [01:22<07:48, 27.54s/it]
Task 5, Epoch 4/20 => Loss 0.073, Train_accy 97.40:  15%|█▌        | 3/20 [01:50<07:48, 27.54s/it]
Task 5, Epoch 4/20 => Loss 0.073, Train_accy 97.40:  20%|██        | 4/20 [01:50<07:20, 27.53s/it]
Task 5, Epoch 5/20 => Loss 0.064, Train_accy 98.00, Test_accy 75.81:  20%|██        | 4/20 [03:00<07:20, 27.53s/it]
Task 5, Epoch 5/20 => Loss 0.064, Train_accy 98.00, Test_accy 75.81:  25%|██▌       | 5/20 [03:00<10:42, 42.81s/it]
Task 5, Epoch 6/20 => Loss 0.058, Train_accy 98.16:  25%|██▌       | 5/20 [03:27<10:42, 42.81s/it]                 
Task 5, Epoch 6/20 => Loss 0.058, Train_accy 98.16:  30%|███       | 6/20 [03:27<08:46, 37.62s/it]
Task 5, Epoch 7/20 => Loss 0.059, Train_accy 98.04:  30%|███       | 6/20 [03:55<08:46, 37.62s/it]
Task 5, Epoch 7/20 => Loss 0.059, Train_accy 98.04:  35%|███▌      | 7/20 [03:55<07:26, 34.33s/it]
Task 5, Epoch 8/20 => Loss 0.066, Train_accy 97.60:  35%|███▌      | 7/20 [04:22<07:26, 34.33s/it]
Task 5, Epoch 8/20 => Loss 0.066, Train_accy 97.60:  40%|████      | 8/20 [04:22<06:25, 32.16s/it]
Task 5, Epoch 9/20 => Loss 0.050, Train_accy 98.20:  40%|████      | 8/20 [04:50<06:25, 32.16s/it]
Task 5, Epoch 9/20 => Loss 0.050, Train_accy 98.20:  45%|████▌     | 9/20 [04:50<05:37, 30.69s/it]
Task 5, Epoch 10/20 => Loss 0.068, Train_accy 97.88, Test_accy 76.72:  45%|████▌     | 9/20 [05:59<05:37, 30.69s/it]
Task 5, Epoch 10/20 => Loss 0.068, Train_accy 97.88, Test_accy 76.72:  50%|█████     | 10/20 [05:59<07:07, 42.75s/it]
Task 5, Epoch 11/20 => Loss 0.051, Train_accy 98.20:  50%|█████     | 10/20 [06:27<07:07, 42.75s/it]                 
Task 5, Epoch 11/20 => Loss 0.051, Train_accy 98.20:  55%|█████▌    | 11/20 [06:27<05:42, 38.09s/it]
Task 5, Epoch 12/20 => Loss 0.060, Train_accy 97.92:  55%|█████▌    | 11/20 [06:54<05:42, 38.09s/it]
Task 5, Epoch 12/20 => Loss 0.060, Train_accy 97.92:  60%|██████    | 12/20 [06:54<04:38, 34.86s/it]
Task 5, Epoch 13/20 => Loss 0.067, Train_accy 97.76:  60%|██████    | 12/20 [07:22<04:38, 34.86s/it]
Task 5, Epoch 13/20 => Loss 0.067, Train_accy 97.76:  65%|██████▌   | 13/20 [07:22<03:48, 32.63s/it]
Task 5, Epoch 14/20 => Loss 0.051, Train_accy 98.20:  65%|██████▌   | 13/20 [07:49<03:48, 32.63s/it]
Task 5, Epoch 14/20 => Loss 0.051, Train_accy 98.20:  70%|███████   | 14/20 [07:49<03:06, 31.09s/it]
Task 5, Epoch 15/20 => Loss 0.047, Train_accy 98.36, Test_accy 76.85:  70%|███████   | 14/20 [08:59<03:06, 31.09s/it]
Task 5, Epoch 15/20 => Loss 0.047, Train_accy 98.36, Test_accy 76.85:  75%|███████▌  | 15/20 [08:59<03:33, 42.73s/it]
Task 5, Epoch 16/20 => Loss 0.047, Train_accy 98.44:  75%|███████▌  | 15/20 [09:27<03:33, 42.73s/it]                 
Task 5, Epoch 16/20 => Loss 0.047, Train_accy 98.44:  80%|████████  | 16/20 [09:27<02:32, 38.15s/it]
Task 5, Epoch 17/20 => Loss 0.058, Train_accy 98.20:  80%|████████  | 16/20 [09:54<02:32, 38.15s/it]
Task 5, Epoch 17/20 => Loss 0.058, Train_accy 98.20:  85%|████████▌ | 17/20 [09:54<01:44, 34.94s/it]
Task 5, Epoch 18/20 => Loss 0.056, Train_accy 98.08:  85%|████████▌ | 17/20 [10:22<01:44, 34.94s/it]
Task 5, Epoch 18/20 => Loss 0.056, Train_accy 98.08:  90%|█████████ | 18/20 [10:22<01:05, 32.72s/it]
Task 5, Epoch 19/20 => Loss 0.044, Train_accy 98.44:  90%|█████████ | 18/20 [10:49<01:05, 32.72s/it]
Task 5, Epoch 19/20 => Loss 0.044, Train_accy 98.44:  95%|█████████▌| 19/20 [10:49<00:31, 31.16s/it]
Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84:  95%|█████████▌| 19/20 [11:59<00:31, 31.16s/it]
Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84: 100%|██████████| 20/20 [11:59<00:00, 42.70s/it]
Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84: 100%|██████████| 20/20 [11:59<00:00, 35.96s/it]
2024-09-04 08:02:46,643 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84
2024-09-04 08:03:28,768 [trainer.py] => No NME accuracy.
2024-09-04 08:03:28,769 [trainer.py] => CNN: {'total': 76.84, '00-49': 93.96, '50-54': 42.8, '55-59': 43.0, '60-64': 52.6, '65-69': 39.4, '70-74': 35.2, 'old': 79.81, 'new': 35.2}
2024-09-04 08:03:28,769 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84]
2024-09-04 08:03:28,769 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72]

Average Accuracy (CNN): 85.19
2024-09-04 08:03:28,769 [trainer.py] => Average Accuracy (CNN): 85.19 

2024-09-04 08:03:28,771 [trainer.py] => All params: 89715556
2024-09-04 08:03:28,772 [trainer.py] => Trainable params: 89715556
2024-09-04 08:03:29,818 [coda_prompt.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.326, Train_accy 88.98:   0%|          | 0/20 [00:27<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.326, Train_accy 88.98:   5%|▌         | 1/20 [00:27<08:43, 27.55s/it]
Task 6, Epoch 2/20 => Loss 0.088, Train_accy 96.59:   5%|▌         | 1/20 [00:55<08:43, 27.55s/it]
Task 6, Epoch 2/20 => Loss 0.088, Train_accy 96.59:  10%|█         | 2/20 [00:55<08:15, 27.55s/it]
Task 6, Epoch 3/20 => Loss 0.069, Train_accy 97.88:  10%|█         | 2/20 [01:22<08:15, 27.55s/it]
Task 6, Epoch 3/20 => Loss 0.069, Train_accy 97.88:  15%|█▌        | 3/20 [01:22<07:48, 27.56s/it]
Task 6, Epoch 4/20 => Loss 0.069, Train_accy 97.64:  15%|█▌        | 3/20 [01:50<07:48, 27.56s/it]
Task 6, Epoch 4/20 => Loss 0.069, Train_accy 97.64:  20%|██        | 4/20 [01:50<07:21, 27.60s/it]
Task 6, Epoch 5/20 => Loss 0.073, Train_accy 97.68, Test_accy 73.35:  20%|██        | 4/20 [03:02<07:21, 27.60s/it]
Task 6, Epoch 5/20 => Loss 0.073, Train_accy 97.68, Test_accy 73.35:  25%|██▌       | 5/20 [03:02<10:56, 43.78s/it]
Task 6, Epoch 6/20 => Loss 0.058, Train_accy 98.00:  25%|██▌       | 5/20 [03:30<10:56, 43.78s/it]                 
Task 6, Epoch 6/20 => Loss 0.058, Train_accy 98.00:  30%|███       | 6/20 [03:30<08:55, 38.26s/it]
Task 6, Epoch 7/20 => Loss 0.072, Train_accy 97.68:  30%|███       | 6/20 [03:57<08:55, 38.26s/it]
Task 6, Epoch 7/20 => Loss 0.072, Train_accy 97.68:  35%|███▌      | 7/20 [03:57<07:31, 34.74s/it]
Task 6, Epoch 8/20 => Loss 0.053, Train_accy 98.20:  35%|███▌      | 7/20 [04:25<07:31, 34.74s/it]
Task 6, Epoch 8/20 => Loss 0.053, Train_accy 98.20:  40%|████      | 8/20 [04:25<06:29, 32.44s/it]
Task 6, Epoch 9/20 => Loss 0.072, Train_accy 97.80:  40%|████      | 8/20 [04:52<06:29, 32.44s/it]
Task 6, Epoch 9/20 => Loss 0.072, Train_accy 97.80:  45%|████▌     | 9/20 [04:52<05:39, 30.90s/it]
Task 6, Epoch 10/20 => Loss 0.053, Train_accy 98.28, Test_accy 73.99:  45%|████▌     | 9/20 [06:05<05:39, 30.90s/it]
Task 6, Epoch 10/20 => Loss 0.053, Train_accy 98.28, Test_accy 73.99:  50%|█████     | 10/20 [06:05<07:17, 43.73s/it]
Task 6, Epoch 11/20 => Loss 0.056, Train_accy 98.24:  50%|█████     | 10/20 [06:32<07:17, 43.73s/it]                 
Task 6, Epoch 11/20 => Loss 0.056, Train_accy 98.24:  55%|█████▌    | 11/20 [06:32<05:48, 38.76s/it]
Task 6, Epoch 12/20 => Loss 0.060, Train_accy 98.16:  55%|█████▌    | 11/20 [07:00<05:48, 38.76s/it]
Task 6, Epoch 12/20 => Loss 0.060, Train_accy 98.16:  60%|██████    | 12/20 [07:00<04:42, 35.35s/it]
Task 6, Epoch 13/20 => Loss 0.049, Train_accy 98.36:  60%|██████    | 12/20 [07:27<04:42, 35.35s/it]
Task 6, Epoch 13/20 => Loss 0.049, Train_accy 98.36:  65%|██████▌   | 13/20 [07:27<03:50, 32.98s/it]
Task 6, Epoch 14/20 => Loss 0.062, Train_accy 98.04:  65%|██████▌   | 13/20 [07:55<03:50, 32.98s/it]
Task 6, Epoch 14/20 => Loss 0.062, Train_accy 98.04:  70%|███████   | 14/20 [07:55<03:07, 31.33s/it]
Task 6, Epoch 15/20 => Loss 0.056, Train_accy 98.28, Test_accy 74.15:  70%|███████   | 14/20 [09:07<03:07, 31.33s/it]
Task 6, Epoch 15/20 => Loss 0.056, Train_accy 98.28, Test_accy 74.15:  75%|███████▌  | 15/20 [09:07<03:38, 43.73s/it]
Task 6, Epoch 16/20 => Loss 0.056, Train_accy 98.12:  75%|███████▌  | 15/20 [09:35<03:38, 43.73s/it]                 
Task 6, Epoch 16/20 => Loss 0.056, Train_accy 98.12:  80%|████████  | 16/20 [09:35<02:35, 38.83s/it]
Task 6, Epoch 17/20 => Loss 0.043, Train_accy 98.60:  80%|████████  | 16/20 [10:02<02:35, 38.83s/it]
Task 6, Epoch 17/20 => Loss 0.043, Train_accy 98.60:  85%|████████▌ | 17/20 [10:02<01:46, 35.42s/it]
Task 6, Epoch 18/20 => Loss 0.046, Train_accy 98.32:  85%|████████▌ | 17/20 [10:30<01:46, 35.42s/it]
Task 6, Epoch 18/20 => Loss 0.046, Train_accy 98.32:  90%|█████████ | 18/20 [10:30<01:06, 33.03s/it]
Task 6, Epoch 19/20 => Loss 0.064, Train_accy 97.72:  90%|█████████ | 18/20 [10:57<01:06, 33.03s/it]
Task 6, Epoch 19/20 => Loss 0.064, Train_accy 97.72:  95%|█████████▌| 19/20 [10:57<00:31, 31.37s/it]
Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08:  95%|█████████▌| 19/20 [12:10<00:31, 31.37s/it]
Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08: 100%|██████████| 20/20 [12:10<00:00, 43.66s/it]
Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08: 100%|██████████| 20/20 [12:10<00:00, 36.50s/it]
2024-09-04 08:15:39,915 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08
2024-09-04 08:16:24,859 [trainer.py] => No NME accuracy.
2024-09-04 08:16:24,860 [trainer.py] => CNN: {'total': 74.08, '00-49': 94.16, '50-54': 42.4, '55-59': 44.2, '60-64': 52.4, '65-69': 42.8, '70-74': 36.6, '75-79': 25.2, 'old': 77.33, 'new': 25.2}
2024-09-04 08:16:24,860 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08]
2024-09-04 08:16:24,860 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39]

Average Accuracy (CNN): 83.6
2024-09-04 08:16:24,860 [trainer.py] => Average Accuracy (CNN): 83.6 

2024-09-04 08:16:24,861 [trainer.py] => All params: 89715556
2024-09-04 08:16:24,862 [trainer.py] => Trainable params: 89715556
2024-09-04 08:16:26,068 [coda_prompt.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.321, Train_accy 89.86:   0%|          | 0/20 [00:27<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.321, Train_accy 89.86:   5%|▌         | 1/20 [00:27<08:42, 27.51s/it]
Task 7, Epoch 2/20 => Loss 0.055, Train_accy 98.36:   5%|▌         | 1/20 [00:55<08:42, 27.51s/it]
Task 7, Epoch 2/20 => Loss 0.055, Train_accy 98.36:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 7, Epoch 3/20 => Loss 0.057, Train_accy 98.24:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 7, Epoch 3/20 => Loss 0.057, Train_accy 98.24:  15%|█▌        | 3/20 [01:22<07:48, 27.54s/it]
Task 7, Epoch 4/20 => Loss 0.044, Train_accy 98.76:  15%|█▌        | 3/20 [01:50<07:48, 27.54s/it]
Task 7, Epoch 4/20 => Loss 0.044, Train_accy 98.76:  20%|██        | 4/20 [01:50<07:20, 27.52s/it]
Task 7, Epoch 5/20 => Loss 0.049, Train_accy 98.32, Test_accy 70.12:  20%|██        | 4/20 [03:05<07:20, 27.52s/it]
Task 7, Epoch 5/20 => Loss 0.049, Train_accy 98.32, Test_accy 70.12:  25%|██▌       | 5/20 [03:05<11:11, 44.74s/it]
Task 7, Epoch 6/20 => Loss 0.042, Train_accy 98.72:  25%|██▌       | 5/20 [03:32<11:11, 44.74s/it]                 
Task 7, Epoch 6/20 => Loss 0.042, Train_accy 98.72:  30%|███       | 6/20 [03:32<09:04, 38.88s/it]
Task 7, Epoch 7/20 => Loss 0.038, Train_accy 98.80:  30%|███       | 6/20 [04:00<09:04, 38.88s/it]
Task 7, Epoch 7/20 => Loss 0.038, Train_accy 98.80:  35%|███▌      | 7/20 [04:00<07:37, 35.16s/it]
Task 7, Epoch 8/20 => Loss 0.037, Train_accy 98.88:  35%|███▌      | 7/20 [04:27<07:37, 35.16s/it]
Task 7, Epoch 8/20 => Loss 0.037, Train_accy 98.88:  40%|████      | 8/20 [04:27<06:33, 32.75s/it]
Task 7, Epoch 9/20 => Loss 0.047, Train_accy 98.48:  40%|████      | 8/20 [04:55<06:33, 32.75s/it]
Task 7, Epoch 9/20 => Loss 0.047, Train_accy 98.48:  45%|████▌     | 9/20 [04:55<05:42, 31.13s/it]
Task 7, Epoch 10/20 => Loss 0.039, Train_accy 98.52, Test_accy 70.24:  45%|████▌     | 9/20 [06:10<05:42, 31.13s/it]
Task 7, Epoch 10/20 => Loss 0.039, Train_accy 98.52, Test_accy 70.24:  50%|█████     | 10/20 [06:10<07:27, 44.76s/it]
Task 7, Epoch 11/20 => Loss 0.045, Train_accy 98.52:  50%|█████     | 10/20 [06:38<07:27, 44.76s/it]                 
Task 7, Epoch 11/20 => Loss 0.045, Train_accy 98.52:  55%|█████▌    | 11/20 [06:38<05:55, 39.48s/it]
Task 7, Epoch 12/20 => Loss 0.038, Train_accy 98.84:  55%|█████▌    | 11/20 [07:05<05:55, 39.48s/it]
Task 7, Epoch 12/20 => Loss 0.038, Train_accy 98.84:  60%|██████    | 12/20 [07:05<04:46, 35.84s/it]
Task 7, Epoch 13/20 => Loss 0.032, Train_accy 98.80:  60%|██████    | 12/20 [07:33<04:46, 35.84s/it]
Task 7, Epoch 13/20 => Loss 0.032, Train_accy 98.80:  65%|██████▌   | 13/20 [07:33<03:53, 33.33s/it]
Task 7, Epoch 14/20 => Loss 0.039, Train_accy 98.60:  65%|██████▌   | 13/20 [08:00<03:53, 33.33s/it]
Task 7, Epoch 14/20 => Loss 0.039, Train_accy 98.60:  70%|███████   | 14/20 [08:00<03:09, 31.58s/it]
Task 7, Epoch 15/20 => Loss 0.044, Train_accy 98.48, Test_accy 70.29:  70%|███████   | 14/20 [09:16<03:09, 31.58s/it]
Task 7, Epoch 15/20 => Loss 0.044, Train_accy 98.48, Test_accy 70.29:  75%|███████▌  | 15/20 [09:16<03:44, 44.83s/it]
Task 7, Epoch 16/20 => Loss 0.031, Train_accy 98.84:  75%|███████▌  | 15/20 [09:44<03:44, 44.83s/it]                 
Task 7, Epoch 16/20 => Loss 0.031, Train_accy 98.84:  80%|████████  | 16/20 [09:44<02:38, 39.64s/it]
Task 7, Epoch 17/20 => Loss 0.034, Train_accy 98.60:  80%|████████  | 16/20 [10:11<02:38, 39.64s/it]
Task 7, Epoch 17/20 => Loss 0.034, Train_accy 98.60:  85%|████████▌ | 17/20 [10:11<01:48, 36.02s/it]
Task 7, Epoch 18/20 => Loss 0.043, Train_accy 98.72:  85%|████████▌ | 17/20 [10:39<01:48, 36.02s/it]
Task 7, Epoch 18/20 => Loss 0.043, Train_accy 98.72:  90%|█████████ | 18/20 [10:39<01:06, 33.46s/it]
Task 7, Epoch 19/20 => Loss 0.028, Train_accy 99.04:  90%|█████████ | 18/20 [11:06<01:06, 33.46s/it]
Task 7, Epoch 19/20 => Loss 0.028, Train_accy 99.04:  95%|█████████▌| 19/20 [11:06<00:31, 31.68s/it]
Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31:  95%|█████████▌| 19/20 [12:22<00:31, 31.68s/it]
Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31: 100%|██████████| 20/20 [12:22<00:00, 44.81s/it]
Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31: 100%|██████████| 20/20 [12:22<00:00, 37.11s/it]
2024-09-04 08:28:48,199 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31
2024-09-04 08:29:35,910 [trainer.py] => No NME accuracy.
2024-09-04 08:29:35,911 [trainer.py] => CNN: {'total': 70.31, '00-49': 94.3, '50-54': 42.4, '55-59': 43.0, '60-64': 51.6, '65-69': 38.2, '70-74': 34.2, '75-79': 24.8, '80-84': 18.0, 'old': 73.58, 'new': 18.0}
2024-09-04 08:29:35,911 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31]
2024-09-04 08:29:35,911 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8]

Average Accuracy (CNN): 81.94
2024-09-04 08:29:35,912 [trainer.py] => Average Accuracy (CNN): 81.94 

2024-09-04 08:29:35,913 [trainer.py] => All params: 89715556
2024-09-04 08:29:35,915 [trainer.py] => Trainable params: 89715556
2024-09-04 08:29:37,265 [coda_prompt.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.423, Train_accy 84.70:   0%|          | 0/20 [00:27<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.423, Train_accy 84.70:   5%|▌         | 1/20 [00:27<08:42, 27.52s/it]
Task 8, Epoch 2/20 => Loss 0.174, Train_accy 93.39:   5%|▌         | 1/20 [00:55<08:42, 27.52s/it]
Task 8, Epoch 2/20 => Loss 0.174, Train_accy 93.39:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 8, Epoch 3/20 => Loss 0.160, Train_accy 93.83:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 8, Epoch 3/20 => Loss 0.160, Train_accy 93.83:  15%|█▌        | 3/20 [01:22<07:47, 27.52s/it]
Task 8, Epoch 4/20 => Loss 0.153, Train_accy 93.95:  15%|█▌        | 3/20 [01:50<07:47, 27.52s/it]
Task 8, Epoch 4/20 => Loss 0.153, Train_accy 93.95:  20%|██        | 4/20 [01:50<07:20, 27.55s/it]
Task 8, Epoch 5/20 => Loss 0.135, Train_accy 94.91, Test_accy 68.54:  20%|██        | 4/20 [03:08<07:20, 27.55s/it]
Task 8, Epoch 5/20 => Loss 0.135, Train_accy 94.91, Test_accy 68.54:  25%|██▌       | 5/20 [03:08<11:25, 45.73s/it]
Task 8, Epoch 6/20 => Loss 0.114, Train_accy 95.43:  25%|██▌       | 5/20 [03:35<11:25, 45.73s/it]                 
Task 8, Epoch 6/20 => Loss 0.114, Train_accy 95.43:  30%|███       | 6/20 [03:35<09:13, 39.56s/it]
Task 8, Epoch 7/20 => Loss 0.146, Train_accy 94.31:  30%|███       | 6/20 [04:03<09:13, 39.56s/it]
Task 8, Epoch 7/20 => Loss 0.146, Train_accy 94.31:  35%|███▌      | 7/20 [04:03<07:43, 35.65s/it]
Task 8, Epoch 8/20 => Loss 0.124, Train_accy 95.31:  35%|███▌      | 7/20 [04:30<07:43, 35.65s/it]
Task 8, Epoch 8/20 => Loss 0.124, Train_accy 95.31:  40%|████      | 8/20 [04:30<06:36, 33.08s/it]
Task 8, Epoch 9/20 => Loss 0.132, Train_accy 95.19:  40%|████      | 8/20 [04:58<06:36, 33.08s/it]
Task 8, Epoch 9/20 => Loss 0.132, Train_accy 95.19:  45%|████▌     | 9/20 [04:58<05:44, 31.36s/it]
Task 8, Epoch 10/20 => Loss 0.113, Train_accy 95.83, Test_accy 68.34:  45%|████▌     | 9/20 [06:16<05:44, 31.36s/it]
Task 8, Epoch 10/20 => Loss 0.113, Train_accy 95.83, Test_accy 68.34:  50%|█████     | 10/20 [06:16<07:38, 45.83s/it]
Task 8, Epoch 11/20 => Loss 0.116, Train_accy 95.59:  50%|█████     | 10/20 [06:44<07:38, 45.83s/it]                 
Task 8, Epoch 11/20 => Loss 0.116, Train_accy 95.59:  55%|█████▌    | 11/20 [06:44<06:02, 40.26s/it]
Task 8, Epoch 12/20 => Loss 0.131, Train_accy 95.07:  55%|█████▌    | 11/20 [07:11<06:02, 40.26s/it]
Task 8, Epoch 12/20 => Loss 0.131, Train_accy 95.07:  60%|██████    | 12/20 [07:11<04:51, 36.39s/it]
Task 8, Epoch 13/20 => Loss 0.117, Train_accy 95.71:  60%|██████    | 12/20 [07:39<04:51, 36.39s/it]
Task 8, Epoch 13/20 => Loss 0.117, Train_accy 95.71:  65%|██████▌   | 13/20 [07:39<03:55, 33.71s/it]
Task 8, Epoch 14/20 => Loss 0.126, Train_accy 95.63:  65%|██████▌   | 13/20 [08:06<03:55, 33.71s/it]
Task 8, Epoch 14/20 => Loss 0.126, Train_accy 95.63:  70%|███████   | 14/20 [08:06<03:11, 31.84s/it]
Task 8, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 68.72:  70%|███████   | 14/20 [09:24<03:11, 31.84s/it]
Task 8, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 68.72:  75%|███████▌  | 15/20 [09:24<03:48, 45.73s/it]
Task 8, Epoch 16/20 => Loss 0.109, Train_accy 95.91:  75%|███████▌  | 15/20 [09:52<03:48, 45.73s/it]                 
Task 8, Epoch 16/20 => Loss 0.109, Train_accy 95.91:  80%|████████  | 16/20 [09:52<02:41, 40.25s/it]
Task 8, Epoch 17/20 => Loss 0.097, Train_accy 96.35:  80%|████████  | 16/20 [10:19<02:41, 40.25s/it]
Task 8, Epoch 17/20 => Loss 0.097, Train_accy 96.35:  85%|████████▌ | 17/20 [10:19<01:49, 36.44s/it]
Task 8, Epoch 18/20 => Loss 0.116, Train_accy 95.75:  85%|████████▌ | 17/20 [10:47<01:49, 36.44s/it]
Task 8, Epoch 18/20 => Loss 0.116, Train_accy 95.75:  90%|█████████ | 18/20 [10:47<01:07, 33.78s/it]
Task 8, Epoch 19/20 => Loss 0.100, Train_accy 96.27:  90%|█████████ | 18/20 [11:15<01:07, 33.78s/it]
Task 8, Epoch 19/20 => Loss 0.100, Train_accy 96.27:  95%|█████████▌| 19/20 [11:15<00:31, 31.93s/it]
Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86:  95%|█████████▌| 19/20 [12:33<00:31, 31.93s/it]
Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86: 100%|██████████| 20/20 [12:33<00:00, 45.80s/it]
Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86: 100%|██████████| 20/20 [12:33<00:00, 37.66s/it]
2024-09-04 08:42:10,584 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86
2024-09-04 08:43:01,139 [trainer.py] => No NME accuracy.
2024-09-04 08:43:01,139 [trainer.py] => CNN: {'total': 68.86, '00-49': 94.3, '50-54': 44.0, '55-59': 44.8, '60-64': 54.0, '65-69': 41.8, '70-74': 35.2, '75-79': 26.4, '80-84': 18.8, '85-89': 31.4, 'old': 71.06, 'new': 31.4}
2024-09-04 08:43:01,139 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31, 68.86]
2024-09-04 08:43:01,139 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8, 95.46]

Average Accuracy (CNN): 80.49
2024-09-04 08:43:01,139 [trainer.py] => Average Accuracy (CNN): 80.49 

2024-09-04 08:43:01,140 [trainer.py] => All params: 89715556
2024-09-04 08:43:01,140 [trainer.py] => Trainable params: 89715556
2024-09-04 08:43:02,645 [coda_prompt.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.263, Train_accy 90.87:   0%|          | 0/20 [00:27<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.263, Train_accy 90.87:   5%|▌         | 1/20 [00:27<08:43, 27.57s/it]
Task 9, Epoch 2/20 => Loss 0.086, Train_accy 96.59:   5%|▌         | 1/20 [00:55<08:43, 27.57s/it]
Task 9, Epoch 2/20 => Loss 0.086, Train_accy 96.59:  10%|█         | 2/20 [00:55<08:16, 27.56s/it]
Task 9, Epoch 3/20 => Loss 0.081, Train_accy 97.04:  10%|█         | 2/20 [01:22<08:16, 27.56s/it]
Task 9, Epoch 3/20 => Loss 0.081, Train_accy 97.04:  15%|█▌        | 3/20 [01:22<07:48, 27.55s/it]
Task 9, Epoch 4/20 => Loss 0.081, Train_accy 97.40:  15%|█▌        | 3/20 [01:50<07:48, 27.55s/it]
Task 9, Epoch 4/20 => Loss 0.081, Train_accy 97.40:  20%|██        | 4/20 [01:50<07:20, 27.55s/it]
Task 9, Epoch 5/20 => Loss 0.058, Train_accy 98.12, Test_accy 65.93:  20%|██        | 4/20 [03:11<07:20, 27.55s/it]
Task 9, Epoch 5/20 => Loss 0.058, Train_accy 98.12, Test_accy 65.93:  25%|██▌       | 5/20 [03:11<11:41, 46.78s/it]
Task 9, Epoch 6/20 => Loss 0.060, Train_accy 98.16:  25%|██▌       | 5/20 [03:38<11:41, 46.78s/it]                 
Task 9, Epoch 6/20 => Loss 0.060, Train_accy 98.16:  30%|███       | 6/20 [03:38<09:23, 40.24s/it]
Task 9, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  30%|███       | 6/20 [04:06<09:23, 40.24s/it]
Task 9, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  35%|███▌      | 7/20 [04:06<07:49, 36.09s/it]
Task 9, Epoch 8/20 => Loss 0.064, Train_accy 97.48:  35%|███▌      | 7/20 [04:33<07:49, 36.09s/it]
Task 9, Epoch 8/20 => Loss 0.064, Train_accy 97.48:  40%|████      | 8/20 [04:33<06:40, 33.36s/it]
Task 9, Epoch 9/20 => Loss 0.071, Train_accy 97.48:  40%|████      | 8/20 [05:01<06:40, 33.36s/it]
Task 9, Epoch 9/20 => Loss 0.071, Train_accy 97.48:  45%|████▌     | 9/20 [05:01<05:46, 31.54s/it]
Task 9, Epoch 10/20 => Loss 0.052, Train_accy 98.20, Test_accy 66.58:  45%|████▌     | 9/20 [06:21<05:46, 31.54s/it]
Task 9, Epoch 10/20 => Loss 0.052, Train_accy 98.20, Test_accy 66.58:  50%|█████     | 10/20 [06:21<07:47, 46.73s/it]
Task 9, Epoch 11/20 => Loss 0.059, Train_accy 97.76:  50%|█████     | 10/20 [06:49<07:47, 46.73s/it]                 
Task 9, Epoch 11/20 => Loss 0.059, Train_accy 97.76:  55%|█████▌    | 11/20 [06:49<06:07, 40.86s/it]
Task 9, Epoch 12/20 => Loss 0.064, Train_accy 97.72:  55%|█████▌    | 11/20 [07:17<06:07, 40.86s/it]
Task 9, Epoch 12/20 => Loss 0.064, Train_accy 97.72:  60%|██████    | 12/20 [07:17<04:54, 36.81s/it]
Task 9, Epoch 13/20 => Loss 0.055, Train_accy 98.04:  60%|██████    | 12/20 [07:44<04:54, 36.81s/it]
Task 9, Epoch 13/20 => Loss 0.055, Train_accy 98.04:  65%|██████▌   | 13/20 [07:44<03:57, 34.00s/it]
Task 9, Epoch 14/20 => Loss 0.040, Train_accy 98.76:  65%|██████▌   | 13/20 [08:12<03:57, 34.00s/it]
Task 9, Epoch 14/20 => Loss 0.040, Train_accy 98.76:  70%|███████   | 14/20 [08:12<03:12, 32.06s/it]
Task 9, Epoch 15/20 => Loss 0.042, Train_accy 98.40, Test_accy 66.54:  70%|███████   | 14/20 [09:33<03:12, 32.06s/it]
Task 9, Epoch 15/20 => Loss 0.042, Train_accy 98.40, Test_accy 66.54:  75%|███████▌  | 15/20 [09:33<03:54, 46.81s/it]
Task 9, Epoch 16/20 => Loss 0.047, Train_accy 98.40:  75%|███████▌  | 15/20 [10:00<03:54, 46.81s/it]                 
Task 9, Epoch 16/20 => Loss 0.047, Train_accy 98.40:  80%|████████  | 16/20 [10:00<02:44, 41.04s/it]
Task 9, Epoch 17/20 => Loss 0.052, Train_accy 98.28:  80%|████████  | 16/20 [10:28<02:44, 41.04s/it]
Task 9, Epoch 17/20 => Loss 0.052, Train_accy 98.28:  85%|████████▌ | 17/20 [10:28<01:51, 37.01s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.44:  85%|████████▌ | 17/20 [10:56<01:51, 37.01s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.44:  90%|█████████ | 18/20 [10:56<01:08, 34.19s/it]
Task 9, Epoch 19/20 => Loss 0.060, Train_accy 97.92:  90%|█████████ | 18/20 [11:23<01:08, 34.19s/it]
Task 9, Epoch 19/20 => Loss 0.060, Train_accy 97.92:  95%|█████████▌| 19/20 [11:23<00:32, 32.20s/it]
Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69:  95%|█████████▌| 19/20 [12:44<00:32, 32.20s/it]
Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69: 100%|██████████| 20/20 [12:44<00:00, 46.80s/it]
Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69: 100%|██████████| 20/20 [12:44<00:00, 38.22s/it]
2024-09-04 08:55:47,141 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69
2024-09-04 08:56:40,750 [trainer.py] => No NME accuracy.
2024-09-04 08:56:40,751 [trainer.py] => CNN: {'total': 66.69, '00-49': 94.22, '50-54': 41.6, '55-59': 42.2, '60-64': 53.2, '65-69': 39.8, '70-74': 35.0, '75-79': 24.8, '80-84': 17.4, '85-89': 30.0, '90-94': 41.0, 'old': 68.12, 'new': 41.0}
2024-09-04 08:56:40,751 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31, 68.86, 66.69]
2024-09-04 08:56:40,751 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8, 95.46, 95.01]

Average Accuracy (CNN): 79.11
2024-09-04 08:56:40,751 [trainer.py] => Average Accuracy (CNN): 79.11 

2024-09-04 08:56:40,752 [trainer.py] => All params: 89715556
2024-09-04 08:56:40,753 [trainer.py] => Trainable params: 89715556
2024-09-04 08:56:42,421 [coda_prompt.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.394, Train_accy 86.50:   0%|          | 0/20 [00:27<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.394, Train_accy 86.50:   5%|▌         | 1/20 [00:27<08:44, 27.59s/it]
Task 10, Epoch 2/20 => Loss 0.135, Train_accy 95.39:   5%|▌         | 1/20 [00:55<08:44, 27.59s/it]
Task 10, Epoch 2/20 => Loss 0.135, Train_accy 95.39:  10%|█         | 2/20 [00:55<08:17, 27.62s/it]
Task 10, Epoch 3/20 => Loss 0.130, Train_accy 95.35:  10%|█         | 2/20 [01:22<08:17, 27.62s/it]
Task 10, Epoch 3/20 => Loss 0.130, Train_accy 95.35:  15%|█▌        | 3/20 [01:22<07:49, 27.63s/it]
Task 10, Epoch 4/20 => Loss 0.110, Train_accy 96.63:  15%|█▌        | 3/20 [01:50<07:49, 27.63s/it]
Task 10, Epoch 4/20 => Loss 0.110, Train_accy 96.63:  20%|██        | 4/20 [01:50<07:21, 27.62s/it]
Task 10, Epoch 5/20 => Loss 0.092, Train_accy 96.88, Test_accy 64.52:  20%|██        | 4/20 [03:14<07:21, 27.62s/it]
Task 10, Epoch 5/20 => Loss 0.092, Train_accy 96.88, Test_accy 64.52:  25%|██▌       | 5/20 [03:14<11:58, 47.87s/it]
Task 10, Epoch 6/20 => Loss 0.104, Train_accy 96.51:  25%|██▌       | 5/20 [03:41<11:58, 47.87s/it]                 
Task 10, Epoch 6/20 => Loss 0.104, Train_accy 96.51:  30%|███       | 6/20 [03:41<09:33, 40.99s/it]
Task 10, Epoch 7/20 => Loss 0.101, Train_accy 96.23:  30%|███       | 6/20 [04:09<09:33, 40.99s/it]
Task 10, Epoch 7/20 => Loss 0.101, Train_accy 96.23:  35%|███▌      | 7/20 [04:09<07:55, 36.61s/it]
Task 10, Epoch 8/20 => Loss 0.090, Train_accy 96.39:  35%|███▌      | 7/20 [04:37<07:55, 36.61s/it]
Task 10, Epoch 8/20 => Loss 0.090, Train_accy 96.39:  40%|████      | 8/20 [04:37<06:44, 33.74s/it]
Task 10, Epoch 9/20 => Loss 0.094, Train_accy 96.55:  40%|████      | 8/20 [05:04<06:44, 33.74s/it]
Task 10, Epoch 9/20 => Loss 0.094, Train_accy 96.55:  45%|████▌     | 9/20 [05:04<05:50, 31.82s/it]
Task 10, Epoch 10/20 => Loss 0.096, Train_accy 96.51, Test_accy 64.82:  45%|████▌     | 9/20 [06:28<05:50, 31.82s/it]
Task 10, Epoch 10/20 => Loss 0.096, Train_accy 96.51, Test_accy 64.82:  50%|█████     | 10/20 [06:28<07:58, 47.85s/it]
Task 10, Epoch 11/20 => Loss 0.086, Train_accy 97.24:  50%|█████     | 10/20 [06:55<07:58, 47.85s/it]                 
Task 10, Epoch 11/20 => Loss 0.086, Train_accy 97.24:  55%|█████▌    | 11/20 [06:55<06:14, 41.64s/it]
Task 10, Epoch 12/20 => Loss 0.081, Train_accy 97.24:  55%|█████▌    | 11/20 [07:23<06:14, 41.64s/it]
Task 10, Epoch 12/20 => Loss 0.081, Train_accy 97.24:  60%|██████    | 12/20 [07:23<04:58, 37.36s/it]
Task 10, Epoch 13/20 => Loss 0.087, Train_accy 96.75:  60%|██████    | 12/20 [07:51<04:58, 37.36s/it]
Task 10, Epoch 13/20 => Loss 0.087, Train_accy 96.75:  65%|██████▌   | 13/20 [07:51<04:00, 34.39s/it]
Task 10, Epoch 14/20 => Loss 0.074, Train_accy 97.36:  65%|██████▌   | 13/20 [08:18<04:00, 34.39s/it]
Task 10, Epoch 14/20 => Loss 0.074, Train_accy 97.36:  70%|███████   | 14/20 [08:18<03:14, 32.34s/it]
Task 10, Epoch 15/20 => Loss 0.078, Train_accy 97.32, Test_accy 64.65:  70%|███████   | 14/20 [09:42<03:14, 32.34s/it]
Task 10, Epoch 15/20 => Loss 0.078, Train_accy 97.32, Test_accy 64.65:  75%|███████▌  | 15/20 [09:42<03:58, 47.77s/it]
Task 10, Epoch 16/20 => Loss 0.070, Train_accy 97.60:  75%|███████▌  | 15/20 [10:09<03:58, 47.77s/it]                 
Task 10, Epoch 16/20 => Loss 0.070, Train_accy 97.60:  80%|████████  | 16/20 [10:09<02:46, 41.69s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 96.92:  80%|████████  | 16/20 [10:37<02:46, 41.69s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 96.92:  85%|████████▌ | 17/20 [10:37<01:52, 37.44s/it]
Task 10, Epoch 18/20 => Loss 0.068, Train_accy 97.72:  85%|████████▌ | 17/20 [11:04<01:52, 37.44s/it]
Task 10, Epoch 18/20 => Loss 0.068, Train_accy 97.72:  90%|█████████ | 18/20 [11:04<01:08, 34.47s/it]
Task 10, Epoch 19/20 => Loss 0.072, Train_accy 97.60:  90%|█████████ | 18/20 [11:32<01:08, 34.47s/it]
Task 10, Epoch 19/20 => Loss 0.072, Train_accy 97.60:  95%|█████████▌| 19/20 [11:32<00:32, 32.40s/it]
Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79:  95%|█████████▌| 19/20 [12:56<00:32, 32.40s/it]
Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79: 100%|██████████| 20/20 [12:56<00:00, 47.76s/it]
Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79: 100%|██████████| 20/20 [12:56<00:00, 38.80s/it]
2024-09-04 09:09:38,533 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79
2024-09-04 09:10:34,612 [trainer.py] => No NME accuracy.
2024-09-04 09:10:34,613 [trainer.py] => CNN: {'total': 64.79, '00-49': 94.22, '50-54': 41.0, '55-59': 42.0, '60-64': 54.0, '65-69': 39.2, '70-74': 35.2, '75-79': 24.2, '80-84': 17.4, '85-89': 27.8, '90-94': 40.6, '95-99': 32.2, 'old': 66.51, 'new': 32.2}
2024-09-04 09:10:34,613 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31, 68.86, 66.69, 64.79]
2024-09-04 09:10:34,613 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8, 95.46, 95.01, 94.1]

Average Accuracy (CNN): 77.81
2024-09-04 09:10:34,613 [trainer.py] => Average Accuracy (CNN): 77.81 

Accuracy Matrix (CNN):
[[94.82 94.42 93.9  94.04 94.08 93.96 94.16 94.3  94.3  94.22 94.22]
 [ 0.   42.6  41.   40.2  42.   42.8  42.4  42.4  44.   41.6  41.  ]
 [ 0.    0.   53.6  45.8  45.8  43.   44.2  43.   44.8  42.2  42.  ]
 [ 0.    0.    0.   56.   55.2  52.6  52.4  51.6  54.   53.2  54.  ]
 [ 0.    0.    0.    0.   41.6  39.4  42.8  38.2  41.8  39.8  39.2 ]
 [ 0.    0.    0.    0.    0.   35.2  36.6  34.2  35.2  35.   35.2 ]
 [ 0.    0.    0.    0.    0.    0.   25.2  24.8  26.4  24.8  24.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.   18.   18.8  17.4  17.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   31.4  30.   27.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   41.   40.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   32.2 ]]
2024-09-04 09:10:34,616 [trainer.py] => Forgetting (CNN): 2.9799999999999986
nohup: 忽略输入
2024-09-04 11:05:23,469 [trainer.py] => config: ./exps/ease_cifar_B0_Inc5.json
2024-09-04 11:05:23,469 [trainer.py] => prefix:  
2024-09-04 11:05:23,469 [trainer.py] => dataset: cifar224
2024-09-04 11:05:23,469 [trainer.py] => memory_size: 0
2024-09-04 11:05:23,469 [trainer.py] => memory_per_class: 0
2024-09-04 11:05:23,469 [trainer.py] => fixed_memory: False
2024-09-04 11:05:23,469 [trainer.py] => shuffle: True
2024-09-04 11:05:23,469 [trainer.py] => init_cls: 20
2024-09-04 11:05:23,469 [trainer.py] => increment: 20
2024-09-04 11:05:23,469 [trainer.py] => model_name: ease
2024-09-04 11:05:23,469 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-04 11:05:23,469 [trainer.py] => device: [device(type='cuda', index=3)]
2024-09-04 11:05:23,470 [trainer.py] => seed: 1993
2024-09-04 11:05:23,470 [trainer.py] => init_epochs: 20
2024-09-04 11:05:23,470 [trainer.py] => init_lr: 0.025
2024-09-04 11:05:23,470 [trainer.py] => later_epochs: 20
2024-09-04 11:05:23,470 [trainer.py] => later_lr: 0.025
2024-09-04 11:05:23,470 [trainer.py] => batch_size: 48
2024-09-04 11:05:23,470 [trainer.py] => weight_decay: 0.0005
2024-09-04 11:05:23,470 [trainer.py] => min_lr: 0
2024-09-04 11:05:23,470 [trainer.py] => optimizer: sgd
2024-09-04 11:05:23,470 [trainer.py] => scheduler: cosine
2024-09-04 11:05:23,470 [trainer.py] => pretrained: True
2024-09-04 11:05:23,470 [trainer.py] => vpt_type: Deep
2024-09-04 11:05:23,470 [trainer.py] => prompt_token_num: 5
2024-09-04 11:05:23,470 [trainer.py] => ffn_num: 16
2024-09-04 11:05:23,470 [trainer.py] => use_diagonal: False
2024-09-04 11:05:23,470 [trainer.py] => recalc_sim: True
2024-09-04 11:05:23,470 [trainer.py] => alpha: 0.1
2024-09-04 11:05:23,470 [trainer.py] => use_init_ptm: False
2024-09-04 11:05:23,470 [trainer.py] => beta: 0
2024-09-04 11:05:23,470 [trainer.py] => use_old_data: False
2024-09-04 11:05:23,470 [trainer.py] => use_reweight: True
2024-09-04 11:05:23,470 [trainer.py] => moni_adam: False
2024-09-04 11:05:23,470 [trainer.py] => adapter_num: -1
2024-09-04 11:05:24,598 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-04 11:05:28,030 [trainer.py] => All params: 86102976
2024-09-04 11:05:28,032 [trainer.py] => Trainable params: 304320
2024-09-04 11:05:28,039 [ease.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.763, Train_accy 68.58:   0%|          | 0/20 [00:49<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.763, Train_accy 68.58:   5%|▌         | 1/20 [00:49<15:45, 49.75s/it]
Task 0, Epoch 2/20 => Loss 0.514, Train_accy 86.90:   5%|▌         | 1/20 [01:40<15:45, 49.75s/it]
Task 0, Epoch 2/20 => Loss 0.514, Train_accy 86.90:  10%|█         | 2/20 [01:40<15:06, 50.37s/it]
Task 0, Epoch 3/20 => Loss 0.430, Train_accy 87.91:  10%|█         | 2/20 [02:32<15:06, 50.37s/it]
Task 0, Epoch 3/20 => Loss 0.430, Train_accy 87.91:  15%|█▌        | 3/20 [02:32<14:27, 51.02s/it]
Task 0, Epoch 4/20 => Loss 0.406, Train_accy 88.81:  15%|█▌        | 3/20 [03:23<14:27, 51.02s/it]
Task 0, Epoch 4/20 => Loss 0.406, Train_accy 88.81:  20%|██        | 4/20 [03:23<13:36, 51.06s/it]
Task 0, Epoch 5/20 => Loss 0.382, Train_accy 88.94:  20%|██        | 4/20 [04:14<13:36, 51.06s/it]
Task 0, Epoch 5/20 => Loss 0.382, Train_accy 88.94:  25%|██▌       | 5/20 [04:14<12:46, 51.11s/it]
Task 0, Epoch 6/20 => Loss 0.365, Train_accy 89.42:  25%|██▌       | 5/20 [05:05<12:46, 51.11s/it]
Task 0, Epoch 6/20 => Loss 0.365, Train_accy 89.42:  30%|███       | 6/20 [05:05<11:56, 51.17s/it]
Task 0, Epoch 7/20 => Loss 0.384, Train_accy 88.59:  30%|███       | 6/20 [05:57<11:56, 51.17s/it]
Task 0, Epoch 7/20 => Loss 0.384, Train_accy 88.59:  35%|███▌      | 7/20 [05:57<11:06, 51.26s/it]
Task 0, Epoch 8/20 => Loss 0.356, Train_accy 89.40:  35%|███▌      | 7/20 [06:48<11:06, 51.26s/it]
Task 0, Epoch 8/20 => Loss 0.356, Train_accy 89.40:  40%|████      | 8/20 [06:48<10:14, 51.22s/it]
Task 0, Epoch 9/20 => Loss 0.353, Train_accy 89.78:  40%|████      | 8/20 [07:39<10:14, 51.22s/it]
Task 0, Epoch 9/20 => Loss 0.353, Train_accy 89.78:  45%|████▌     | 9/20 [07:39<09:22, 51.16s/it]
Task 0, Epoch 10/20 => Loss 0.352, Train_accy 89.58:  45%|████▌     | 9/20 [08:30<09:22, 51.16s/it]
Task 0, Epoch 10/20 => Loss 0.352, Train_accy 89.58:  50%|█████     | 10/20 [08:30<08:31, 51.14s/it]
Task 0, Epoch 11/20 => Loss 0.353, Train_accy 89.44:  50%|█████     | 10/20 [09:21<08:31, 51.14s/it]
Task 0, Epoch 11/20 => Loss 0.353, Train_accy 89.44:  55%|█████▌    | 11/20 [09:21<07:39, 51.11s/it]
Task 0, Epoch 12/20 => Loss 0.340, Train_accy 90.16:  55%|█████▌    | 11/20 [10:12<07:39, 51.11s/it]
Task 0, Epoch 12/20 => Loss 0.340, Train_accy 90.16:  60%|██████    | 12/20 [10:12<06:48, 51.04s/it]
Task 0, Epoch 13/20 => Loss 0.330, Train_accy 90.16:  60%|██████    | 12/20 [11:03<06:48, 51.04s/it]
Task 0, Epoch 13/20 => Loss 0.330, Train_accy 90.16:  65%|██████▌   | 13/20 [11:03<05:57, 51.00s/it]
Task 0, Epoch 14/20 => Loss 0.315, Train_accy 90.66:  65%|██████▌   | 13/20 [11:54<05:57, 51.00s/it]
Task 0, Epoch 14/20 => Loss 0.315, Train_accy 90.66:  70%|███████   | 14/20 [11:54<05:06, 51.07s/it]
Task 0, Epoch 15/20 => Loss 0.324, Train_accy 90.25:  70%|███████   | 14/20 [12:45<05:06, 51.07s/it]
Task 0, Epoch 15/20 => Loss 0.324, Train_accy 90.25:  75%|███████▌  | 15/20 [12:45<04:15, 51.11s/it]
Task 0, Epoch 16/20 => Loss 0.314, Train_accy 90.79:  75%|███████▌  | 15/20 [13:37<04:15, 51.11s/it]
Task 0, Epoch 16/20 => Loss 0.314, Train_accy 90.79:  80%|████████  | 16/20 [13:37<03:24, 51.17s/it]
Task 0, Epoch 17/20 => Loss 0.323, Train_accy 90.32:  80%|████████  | 16/20 [14:28<03:24, 51.17s/it]
Task 0, Epoch 17/20 => Loss 0.323, Train_accy 90.32:  85%|████████▌ | 17/20 [14:28<02:33, 51.14s/it]
Task 0, Epoch 18/20 => Loss 0.310, Train_accy 90.95:  85%|████████▌ | 17/20 [15:19<02:33, 51.14s/it]
Task 0, Epoch 18/20 => Loss 0.310, Train_accy 90.95:  90%|█████████ | 18/20 [15:19<01:42, 51.13s/it]
Task 0, Epoch 19/20 => Loss 0.317, Train_accy 90.55:  90%|█████████ | 18/20 [16:10<01:42, 51.13s/it]
Task 0, Epoch 19/20 => Loss 0.317, Train_accy 90.55:  95%|█████████▌| 19/20 [16:10<00:51, 51.15s/it]
Task 0, Epoch 20/20 => Loss 0.305, Train_accy 90.80:  95%|█████████▌| 19/20 [17:01<00:51, 51.15s/it]
Task 0, Epoch 20/20 => Loss 0.305, Train_accy 90.80: 100%|██████████| 20/20 [17:01<00:00, 51.10s/it]
Task 0, Epoch 20/20 => Loss 0.305, Train_accy 90.80: 100%|██████████| 20/20 [17:01<00:00, 51.08s/it]
2024-09-04 11:22:29,725 [ease.py] => Task 0, Epoch 20/20 => Loss 0.305, Train_accy 90.80
2024-09-04 11:23:02,182 [ease.py] => Task correct: 100.0
2024-09-04 11:23:02,182 [ease.py] => Task acc: 97.65
2024-09-04 11:23:02,199 [trainer.py] => No NME accuracy.
2024-09-04 11:23:02,199 [trainer.py] => CNN: {'total': 97.65, '00-19': 97.65, 'old': 0, 'new': 97.65}
2024-09-04 11:23:02,199 [trainer.py] => CNN top1 curve: [97.65]
2024-09-04 11:23:02,199 [trainer.py] => CNN top5 curve: [99.85]

Average Accuracy (CNN): 97.65
2024-09-04 11:23:02,199 [trainer.py] => Average Accuracy (CNN): 97.65 

2024-09-04 11:23:02,200 [trainer.py] => All params: 86133698
2024-09-04 11:23:02,201 [trainer.py] => Trainable params: 304320
2024-09-04 11:23:02,202 [ease.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.587, Train_accy 73.66:   0%|          | 0/20 [00:50<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.587, Train_accy 73.66:   5%|▌         | 1/20 [00:50<16:03, 50.71s/it]
Task 1, Epoch 2/20 => Loss 0.414, Train_accy 88.61:   5%|▌         | 1/20 [01:41<16:03, 50.71s/it]
Task 1, Epoch 2/20 => Loss 0.414, Train_accy 88.61:  10%|█         | 2/20 [01:41<15:14, 50.82s/it]
Task 1, Epoch 3/20 => Loss 0.359, Train_accy 89.44:  10%|█         | 2/20 [02:32<15:14, 50.82s/it]
Task 1, Epoch 3/20 => Loss 0.359, Train_accy 89.44:  15%|█▌        | 3/20 [02:32<14:24, 50.85s/it]
Task 1, Epoch 4/20 => Loss 0.332, Train_accy 90.14:  15%|█▌        | 3/20 [03:23<14:24, 50.85s/it]
Task 1, Epoch 4/20 => Loss 0.332, Train_accy 90.14:  20%|██        | 4/20 [03:23<13:34, 50.89s/it]
Task 1, Epoch 5/20 => Loss 0.318, Train_accy 90.27:  20%|██        | 4/20 [04:14<13:34, 50.89s/it]
Task 1, Epoch 5/20 => Loss 0.318, Train_accy 90.27:  25%|██▌       | 5/20 [04:14<12:43, 50.91s/it]
Task 1, Epoch 6/20 => Loss 0.310, Train_accy 90.78:  25%|██▌       | 5/20 [05:05<12:43, 50.91s/it]
Task 1, Epoch 6/20 => Loss 0.310, Train_accy 90.78:  30%|███       | 6/20 [05:05<11:52, 50.91s/it]
Task 1, Epoch 7/20 => Loss 0.304, Train_accy 90.71:  30%|███       | 6/20 [05:56<11:52, 50.91s/it]
Task 1, Epoch 7/20 => Loss 0.304, Train_accy 90.71:  35%|███▌      | 7/20 [05:56<11:00, 50.84s/it]
Task 1, Epoch 8/20 => Loss 0.298, Train_accy 90.96:  35%|███▌      | 7/20 [06:46<11:00, 50.84s/it]
Task 1, Epoch 8/20 => Loss 0.298, Train_accy 90.96:  40%|████      | 8/20 [06:46<10:10, 50.86s/it]
Task 1, Epoch 9/20 => Loss 0.295, Train_accy 90.82:  40%|████      | 8/20 [07:38<10:10, 50.86s/it]
Task 1, Epoch 9/20 => Loss 0.295, Train_accy 90.82:  45%|████▌     | 9/20 [07:38<09:21, 51.01s/it]
Task 1, Epoch 10/20 => Loss 0.278, Train_accy 91.33:  45%|████▌     | 9/20 [08:29<09:21, 51.01s/it]
Task 1, Epoch 10/20 => Loss 0.278, Train_accy 91.33:  50%|█████     | 10/20 [08:29<08:30, 51.06s/it]
Task 1, Epoch 11/20 => Loss 0.274, Train_accy 91.46:  50%|█████     | 10/20 [09:20<08:30, 51.06s/it]
Task 1, Epoch 11/20 => Loss 0.274, Train_accy 91.46:  55%|█████▌    | 11/20 [09:20<07:39, 51.01s/it]
Task 1, Epoch 12/20 => Loss 0.273, Train_accy 91.61:  55%|█████▌    | 11/20 [10:11<07:39, 51.01s/it]
Task 1, Epoch 12/20 => Loss 0.273, Train_accy 91.61:  60%|██████    | 12/20 [10:11<06:48, 51.06s/it]
Task 1, Epoch 13/20 => Loss 0.271, Train_accy 91.43:  60%|██████    | 12/20 [11:02<06:48, 51.06s/it]
Task 1, Epoch 13/20 => Loss 0.271, Train_accy 91.43:  65%|██████▌   | 13/20 [11:02<05:57, 51.11s/it]
Task 1, Epoch 14/20 => Loss 0.269, Train_accy 91.38:  65%|██████▌   | 13/20 [11:53<05:57, 51.11s/it]
Task 1, Epoch 14/20 => Loss 0.269, Train_accy 91.38:  70%|███████   | 14/20 [11:53<05:06, 51.04s/it]
Task 1, Epoch 15/20 => Loss 0.272, Train_accy 91.64:  70%|███████   | 14/20 [12:44<05:06, 51.04s/it]
Task 1, Epoch 15/20 => Loss 0.272, Train_accy 91.64:  75%|███████▌  | 15/20 [12:44<04:15, 51.03s/it]
Task 1, Epoch 16/20 => Loss 0.270, Train_accy 91.66:  75%|███████▌  | 15/20 [13:35<04:15, 51.03s/it]
Task 1, Epoch 16/20 => Loss 0.270, Train_accy 91.66:  80%|████████  | 16/20 [13:35<03:24, 51.02s/it]
Task 1, Epoch 17/20 => Loss 0.262, Train_accy 92.23:  80%|████████  | 16/20 [14:26<03:24, 51.02s/it]
Task 1, Epoch 17/20 => Loss 0.262, Train_accy 92.23:  85%|████████▌ | 17/20 [14:26<02:33, 51.00s/it]
Task 1, Epoch 18/20 => Loss 0.250, Train_accy 92.35:  85%|████████▌ | 17/20 [15:17<02:33, 51.00s/it]
Task 1, Epoch 18/20 => Loss 0.250, Train_accy 92.35:  90%|█████████ | 18/20 [15:17<01:41, 50.98s/it]
Task 1, Epoch 19/20 => Loss 0.258, Train_accy 92.12:  90%|█████████ | 18/20 [16:08<01:41, 50.98s/it]
Task 1, Epoch 19/20 => Loss 0.258, Train_accy 92.12:  95%|█████████▌| 19/20 [16:08<00:50, 50.88s/it]
Task 1, Epoch 20/20 => Loss 0.257, Train_accy 92.14:  95%|█████████▌| 19/20 [16:58<00:50, 50.88s/it]
Task 1, Epoch 20/20 => Loss 0.257, Train_accy 92.14: 100%|██████████| 20/20 [16:58<00:00, 50.79s/it]
Task 1, Epoch 20/20 => Loss 0.257, Train_accy 92.14: 100%|██████████| 20/20 [16:58<00:00, 50.93s/it]
2024-09-04 11:40:00,994 [ease.py] => Task 1, Epoch 20/20 => Loss 0.257, Train_accy 92.14
2024-09-04 11:41:15,587 [ease.py] => Task correct: 96.35
2024-09-04 11:41:15,587 [ease.py] => Task acc: 97.95
2024-09-04 11:41:15,615 [trainer.py] => No NME accuracy.
2024-09-04 11:41:15,615 [trainer.py] => CNN: {'total': 94.88, '00-19': 92.75, '20-39': 97.0, 'old': 92.75, 'new': 97.0}
2024-09-04 11:41:15,615 [trainer.py] => CNN top1 curve: [97.65, 94.88]
2024-09-04 11:41:15,615 [trainer.py] => CNN top5 curve: [99.85, 99.72]

Average Accuracy (CNN): 96.26
2024-09-04 11:41:15,615 [trainer.py] => Average Accuracy (CNN): 96.26 

2024-09-04 11:41:15,616 [trainer.py] => All params: 86179778
2024-09-04 11:41:15,617 [trainer.py] => Trainable params: 304320
2024-09-04 11:41:15,619 [ease.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.615, Train_accy 71.57:   0%|          | 0/20 [00:51<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.615, Train_accy 71.57:   5%|▌         | 1/20 [00:51<16:13, 51.25s/it]
Task 2, Epoch 2/20 => Loss 0.462, Train_accy 87.51:   5%|▌         | 1/20 [01:41<16:13, 51.25s/it]
Task 2, Epoch 2/20 => Loss 0.462, Train_accy 87.51:  10%|█         | 2/20 [01:41<15:16, 50.91s/it]
Task 2, Epoch 3/20 => Loss 0.397, Train_accy 88.71:  10%|█         | 2/20 [02:32<15:16, 50.91s/it]
Task 2, Epoch 3/20 => Loss 0.397, Train_accy 88.71:  15%|█▌        | 3/20 [02:32<14:22, 50.73s/it]
Task 2, Epoch 4/20 => Loss 0.370, Train_accy 88.98:  15%|█▌        | 3/20 [03:22<14:22, 50.73s/it]
Task 2, Epoch 4/20 => Loss 0.370, Train_accy 88.98:  20%|██        | 4/20 [03:22<13:30, 50.65s/it]
Task 2, Epoch 5/20 => Loss 0.333, Train_accy 89.95:  20%|██        | 4/20 [04:13<13:30, 50.65s/it]
Task 2, Epoch 5/20 => Loss 0.333, Train_accy 89.95:  25%|██▌       | 5/20 [04:13<12:39, 50.66s/it]
Task 2, Epoch 6/20 => Loss 0.335, Train_accy 90.00:  25%|██▌       | 5/20 [05:04<12:39, 50.66s/it]
Task 2, Epoch 6/20 => Loss 0.335, Train_accy 90.00:  30%|███       | 6/20 [05:04<11:48, 50.64s/it]
Task 2, Epoch 7/20 => Loss 0.327, Train_accy 90.10:  30%|███       | 6/20 [05:54<11:48, 50.64s/it]
Task 2, Epoch 7/20 => Loss 0.327, Train_accy 90.10:  35%|███▌      | 7/20 [05:54<10:58, 50.62s/it]
Task 2, Epoch 8/20 => Loss 0.336, Train_accy 89.80:  35%|███▌      | 7/20 [06:45<10:58, 50.62s/it]
Task 2, Epoch 8/20 => Loss 0.336, Train_accy 89.80:  40%|████      | 8/20 [06:45<10:08, 50.70s/it]
Task 2, Epoch 9/20 => Loss 0.320, Train_accy 90.09:  40%|████      | 8/20 [07:36<10:08, 50.70s/it]
Task 2, Epoch 9/20 => Loss 0.320, Train_accy 90.09:  45%|████▌     | 9/20 [07:36<09:17, 50.69s/it]
Task 2, Epoch 10/20 => Loss 0.324, Train_accy 89.96:  45%|████▌     | 9/20 [08:26<09:17, 50.69s/it]
Task 2, Epoch 10/20 => Loss 0.324, Train_accy 89.96:  50%|█████     | 10/20 [08:26<08:26, 50.65s/it]
Task 2, Epoch 11/20 => Loss 0.323, Train_accy 90.26:  50%|█████     | 10/20 [09:17<08:26, 50.65s/it]
Task 2, Epoch 11/20 => Loss 0.323, Train_accy 90.26:  55%|█████▌    | 11/20 [09:17<07:36, 50.67s/it]
Task 2, Epoch 12/20 => Loss 0.306, Train_accy 90.80:  55%|█████▌    | 11/20 [10:08<07:36, 50.67s/it]
Task 2, Epoch 12/20 => Loss 0.306, Train_accy 90.80:  60%|██████    | 12/20 [10:08<06:45, 50.64s/it]
Task 2, Epoch 13/20 => Loss 0.287, Train_accy 91.37:  60%|██████    | 12/20 [10:58<06:45, 50.64s/it]
Task 2, Epoch 13/20 => Loss 0.287, Train_accy 91.37:  65%|██████▌   | 13/20 [10:58<05:54, 50.67s/it]
Task 2, Epoch 14/20 => Loss 0.295, Train_accy 91.12:  65%|██████▌   | 13/20 [11:49<05:54, 50.67s/it]
Task 2, Epoch 14/20 => Loss 0.295, Train_accy 91.12:  70%|███████   | 14/20 [11:49<05:04, 50.69s/it]
Task 2, Epoch 15/20 => Loss 0.290, Train_accy 91.21:  70%|███████   | 14/20 [12:40<05:04, 50.69s/it]
Task 2, Epoch 15/20 => Loss 0.290, Train_accy 91.21:  75%|███████▌  | 15/20 [12:40<04:13, 50.72s/it]
Task 2, Epoch 16/20 => Loss 0.291, Train_accy 90.91:  75%|███████▌  | 15/20 [13:31<04:13, 50.72s/it]
Task 2, Epoch 16/20 => Loss 0.291, Train_accy 90.91:  80%|████████  | 16/20 [13:31<03:22, 50.70s/it]
Task 2, Epoch 17/20 => Loss 0.281, Train_accy 91.62:  80%|████████  | 16/20 [14:22<03:22, 50.70s/it]
Task 2, Epoch 17/20 => Loss 0.281, Train_accy 91.62:  85%|████████▌ | 17/20 [14:22<02:32, 50.77s/it]
Task 2, Epoch 18/20 => Loss 0.277, Train_accy 91.50:  85%|████████▌ | 17/20 [15:12<02:32, 50.77s/it]
Task 2, Epoch 18/20 => Loss 0.277, Train_accy 91.50:  90%|█████████ | 18/20 [15:12<01:41, 50.80s/it]
Task 2, Epoch 19/20 => Loss 0.288, Train_accy 91.02:  90%|█████████ | 18/20 [16:03<01:41, 50.80s/it]
Task 2, Epoch 19/20 => Loss 0.288, Train_accy 91.02:  95%|█████████▌| 19/20 [16:03<00:50, 50.79s/it]
Task 2, Epoch 20/20 => Loss 0.296, Train_accy 90.66:  95%|█████████▌| 19/20 [16:54<00:50, 50.79s/it]
Task 2, Epoch 20/20 => Loss 0.296, Train_accy 90.66: 100%|██████████| 20/20 [16:54<00:00, 50.72s/it]
Task 2, Epoch 20/20 => Loss 0.296, Train_accy 90.66: 100%|██████████| 20/20 [16:54<00:00, 50.71s/it]
2024-09-04 11:58:09,948 [ease.py] => Task 2, Epoch 20/20 => Loss 0.296, Train_accy 90.66
2024-09-04 12:00:15,916 [ease.py] => Task correct: 94.3
2024-09-04 12:00:15,917 [ease.py] => Task acc: 97.65
2024-09-04 12:00:15,943 [trainer.py] => No NME accuracy.
2024-09-04 12:00:15,943 [trainer.py] => CNN: {'total': 92.85, '00-19': 90.65, '20-39': 94.25, '40-59': 93.65, 'old': 92.45, 'new': 93.65}
2024-09-04 12:00:15,943 [trainer.py] => CNN top1 curve: [97.65, 94.88, 92.85]
2024-09-04 12:00:15,943 [trainer.py] => CNN top5 curve: [99.85, 99.72, 99.43]

Average Accuracy (CNN): 95.13
2024-09-04 12:00:15,943 [trainer.py] => Average Accuracy (CNN): 95.13 

2024-09-04 12:00:15,944 [trainer.py] => All params: 86256578
2024-09-04 12:00:15,945 [trainer.py] => Trainable params: 304320
2024-09-04 12:00:15,948 [ease.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.621, Train_accy 69.75:   0%|          | 0/20 [00:50<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.621, Train_accy 69.75:   5%|▌         | 1/20 [00:50<16:05, 50.80s/it]
Task 3, Epoch 2/20 => Loss 0.483, Train_accy 86.56:   5%|▌         | 1/20 [01:41<16:05, 50.80s/it]
Task 3, Epoch 2/20 => Loss 0.483, Train_accy 86.56:  10%|█         | 2/20 [01:41<15:14, 50.79s/it]
Task 3, Epoch 3/20 => Loss 0.399, Train_accy 88.42:  10%|█         | 2/20 [02:32<15:14, 50.79s/it]
Task 3, Epoch 3/20 => Loss 0.399, Train_accy 88.42:  15%|█▌        | 3/20 [02:32<14:24, 50.83s/it]
Task 3, Epoch 4/20 => Loss 0.364, Train_accy 89.32:  15%|█▌        | 3/20 [03:23<14:24, 50.83s/it]
Task 3, Epoch 4/20 => Loss 0.364, Train_accy 89.32:  20%|██        | 4/20 [03:23<13:32, 50.76s/it]
Task 3, Epoch 5/20 => Loss 0.356, Train_accy 89.40:  20%|██        | 4/20 [04:13<13:32, 50.76s/it]
Task 3, Epoch 5/20 => Loss 0.356, Train_accy 89.40:  25%|██▌       | 5/20 [04:13<12:41, 50.76s/it]
Task 3, Epoch 6/20 => Loss 0.334, Train_accy 90.20:  25%|██▌       | 5/20 [05:04<12:41, 50.76s/it]
Task 3, Epoch 6/20 => Loss 0.334, Train_accy 90.20:  30%|███       | 6/20 [05:04<11:51, 50.81s/it]
Task 3, Epoch 7/20 => Loss 0.339, Train_accy 89.90:  30%|███       | 6/20 [05:55<11:51, 50.81s/it]
Task 3, Epoch 7/20 => Loss 0.339, Train_accy 89.90:  35%|███▌      | 7/20 [05:55<10:59, 50.77s/it]
Task 3, Epoch 8/20 => Loss 0.320, Train_accy 90.31:  35%|███▌      | 7/20 [06:46<10:59, 50.77s/it]
Task 3, Epoch 8/20 => Loss 0.320, Train_accy 90.31:  40%|████      | 8/20 [06:46<10:08, 50.72s/it]
Task 3, Epoch 9/20 => Loss 0.324, Train_accy 90.22:  40%|████      | 8/20 [07:36<10:08, 50.72s/it]
Task 3, Epoch 9/20 => Loss 0.324, Train_accy 90.22:  45%|████▌     | 9/20 [07:36<09:17, 50.68s/it]
Task 3, Epoch 10/20 => Loss 0.313, Train_accy 90.16:  45%|████▌     | 9/20 [08:27<09:17, 50.68s/it]
Task 3, Epoch 10/20 => Loss 0.313, Train_accy 90.16:  50%|█████     | 10/20 [08:27<08:25, 50.57s/it]
Task 3, Epoch 11/20 => Loss 0.296, Train_accy 91.20:  50%|█████     | 10/20 [09:17<08:25, 50.57s/it]
Task 3, Epoch 11/20 => Loss 0.296, Train_accy 91.20:  55%|█████▌    | 11/20 [09:17<07:34, 50.50s/it]
Task 3, Epoch 12/20 => Loss 0.303, Train_accy 90.80:  55%|█████▌    | 11/20 [10:07<07:34, 50.50s/it]
Task 3, Epoch 12/20 => Loss 0.303, Train_accy 90.80:  60%|██████    | 12/20 [10:07<06:43, 50.45s/it]
Task 3, Epoch 13/20 => Loss 0.307, Train_accy 90.45:  60%|██████    | 12/20 [10:58<06:43, 50.45s/it]
Task 3, Epoch 13/20 => Loss 0.307, Train_accy 90.45:  65%|██████▌   | 13/20 [10:58<05:53, 50.45s/it]
Task 3, Epoch 14/20 => Loss 0.294, Train_accy 91.09:  65%|██████▌   | 13/20 [11:48<05:53, 50.45s/it]
Task 3, Epoch 14/20 => Loss 0.294, Train_accy 91.09:  70%|███████   | 14/20 [11:48<05:03, 50.51s/it]
Task 3, Epoch 15/20 => Loss 0.298, Train_accy 90.87:  70%|███████   | 14/20 [12:39<05:03, 50.51s/it]
Task 3, Epoch 15/20 => Loss 0.298, Train_accy 90.87:  75%|███████▌  | 15/20 [12:39<04:12, 50.58s/it]
Task 3, Epoch 16/20 => Loss 0.289, Train_accy 91.32:  75%|███████▌  | 15/20 [13:30<04:12, 50.58s/it]
Task 3, Epoch 16/20 => Loss 0.289, Train_accy 91.32:  80%|████████  | 16/20 [13:30<03:22, 50.60s/it]
Task 3, Epoch 17/20 => Loss 0.281, Train_accy 91.30:  80%|████████  | 16/20 [14:20<03:22, 50.60s/it]
Task 3, Epoch 17/20 => Loss 0.281, Train_accy 91.30:  85%|████████▌ | 17/20 [14:20<02:31, 50.62s/it]
Task 3, Epoch 18/20 => Loss 0.288, Train_accy 91.10:  85%|████████▌ | 17/20 [15:11<02:31, 50.62s/it]
Task 3, Epoch 18/20 => Loss 0.288, Train_accy 91.10:  90%|█████████ | 18/20 [15:11<01:41, 50.64s/it]
Task 3, Epoch 19/20 => Loss 0.280, Train_accy 91.49:  90%|█████████ | 18/20 [16:02<01:41, 50.64s/it]
Task 3, Epoch 19/20 => Loss 0.280, Train_accy 91.49:  95%|█████████▌| 19/20 [16:02<00:50, 50.64s/it]
Task 3, Epoch 20/20 => Loss 0.295, Train_accy 91.16:  95%|█████████▌| 19/20 [16:52<00:50, 50.64s/it]
Task 3, Epoch 20/20 => Loss 0.295, Train_accy 91.16: 100%|██████████| 20/20 [16:52<00:00, 50.61s/it]
Task 3, Epoch 20/20 => Loss 0.295, Train_accy 91.16: 100%|██████████| 20/20 [16:52<00:00, 50.63s/it]
2024-09-04 12:17:08,769 [ease.py] => Task 3, Epoch 20/20 => Loss 0.295, Train_accy 91.16
2024-09-04 12:20:15,209 [ease.py] => Task correct: 92.1
2024-09-04 12:20:15,210 [ease.py] => Task acc: 97.55
2024-09-04 12:20:15,239 [trainer.py] => No NME accuracy.
2024-09-04 12:20:15,239 [trainer.py] => CNN: {'total': 90.66, '00-19': 89.4, '20-39': 93.65, '40-59': 90.7, '60-79': 88.9, 'old': 91.25, 'new': 88.9}
2024-09-04 12:20:15,239 [trainer.py] => CNN top1 curve: [97.65, 94.88, 92.85, 90.66]
2024-09-04 12:20:15,239 [trainer.py] => CNN top5 curve: [99.85, 99.72, 99.43, 99.31]

Average Accuracy (CNN): 94.01
2024-09-04 12:20:15,239 [trainer.py] => Average Accuracy (CNN): 94.01 

2024-09-04 12:20:15,240 [trainer.py] => All params: 86364098
2024-09-04 12:20:15,241 [trainer.py] => Trainable params: 304320
2024-09-04 12:20:15,244 [ease.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.650, Train_accy 72.86:   0%|          | 0/20 [00:50<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.650, Train_accy 72.86:   5%|▌         | 1/20 [00:50<16:07, 50.90s/it]
Task 4, Epoch 2/20 => Loss 0.481, Train_accy 86.99:   5%|▌         | 1/20 [01:41<16:07, 50.90s/it]
Task 4, Epoch 2/20 => Loss 0.481, Train_accy 86.99:  10%|█         | 2/20 [01:41<15:14, 50.79s/it]
Task 4, Epoch 3/20 => Loss 0.392, Train_accy 88.74:  10%|█         | 2/20 [02:32<15:14, 50.79s/it]
Task 4, Epoch 3/20 => Loss 0.392, Train_accy 88.74:  15%|█▌        | 3/20 [02:32<14:21, 50.69s/it]
Task 4, Epoch 4/20 => Loss 0.355, Train_accy 89.69:  15%|█▌        | 3/20 [03:22<14:21, 50.69s/it]
Task 4, Epoch 4/20 => Loss 0.355, Train_accy 89.69:  20%|██        | 4/20 [03:22<13:30, 50.66s/it]
Task 4, Epoch 5/20 => Loss 0.333, Train_accy 90.07:  20%|██        | 4/20 [04:13<13:30, 50.66s/it]
Task 4, Epoch 5/20 => Loss 0.333, Train_accy 90.07:  25%|██▌       | 5/20 [04:13<12:41, 50.79s/it]
Task 4, Epoch 6/20 => Loss 0.334, Train_accy 89.94:  25%|██▌       | 5/20 [05:04<12:41, 50.79s/it]
Task 4, Epoch 6/20 => Loss 0.334, Train_accy 89.94:  30%|███       | 6/20 [05:04<11:49, 50.67s/it]
Task 4, Epoch 7/20 => Loss 0.320, Train_accy 90.63:  30%|███       | 6/20 [05:55<11:49, 50.67s/it]
Task 4, Epoch 7/20 => Loss 0.320, Train_accy 90.63:  35%|███▌      | 7/20 [05:55<10:59, 50.70s/it]
Task 4, Epoch 8/20 => Loss 0.323, Train_accy 90.30:  35%|███▌      | 7/20 [06:45<10:59, 50.70s/it]
Task 4, Epoch 8/20 => Loss 0.323, Train_accy 90.30:  40%|████      | 8/20 [06:45<10:07, 50.62s/it]
Task 4, Epoch 9/20 => Loss 0.311, Train_accy 91.15:  40%|████      | 8/20 [07:35<10:07, 50.62s/it]
Task 4, Epoch 9/20 => Loss 0.311, Train_accy 91.15:  45%|████▌     | 9/20 [07:35<09:16, 50.57s/it]
Task 4, Epoch 10/20 => Loss 0.301, Train_accy 90.71:  45%|████▌     | 9/20 [08:26<09:16, 50.57s/it]
Task 4, Epoch 10/20 => Loss 0.301, Train_accy 90.71:  50%|█████     | 10/20 [08:26<08:25, 50.57s/it]
Task 4, Epoch 11/20 => Loss 0.308, Train_accy 90.96:  50%|█████     | 10/20 [09:16<08:25, 50.57s/it]
Task 4, Epoch 11/20 => Loss 0.308, Train_accy 90.96:  55%|█████▌    | 11/20 [09:16<07:34, 50.53s/it]
Task 4, Epoch 12/20 => Loss 0.293, Train_accy 91.38:  55%|█████▌    | 11/20 [10:07<07:34, 50.53s/it]
Task 4, Epoch 12/20 => Loss 0.293, Train_accy 91.38:  60%|██████    | 12/20 [10:07<06:44, 50.56s/it]
Task 4, Epoch 13/20 => Loss 0.289, Train_accy 91.21:  60%|██████    | 12/20 [10:58<06:44, 50.56s/it]
Task 4, Epoch 13/20 => Loss 0.289, Train_accy 91.21:  65%|██████▌   | 13/20 [10:58<05:54, 50.59s/it]
Task 4, Epoch 14/20 => Loss 0.301, Train_accy 91.21:  65%|██████▌   | 13/20 [11:49<05:54, 50.59s/it]
Task 4, Epoch 14/20 => Loss 0.301, Train_accy 91.21:  70%|███████   | 14/20 [11:49<05:04, 50.68s/it]
Task 4, Epoch 15/20 => Loss 0.272, Train_accy 91.79:  70%|███████   | 14/20 [12:39<05:04, 50.68s/it]
Task 4, Epoch 15/20 => Loss 0.272, Train_accy 91.79:  75%|███████▌  | 15/20 [12:39<04:13, 50.67s/it]
Task 4, Epoch 16/20 => Loss 0.278, Train_accy 91.65:  75%|███████▌  | 15/20 [13:30<04:13, 50.67s/it]
Task 4, Epoch 16/20 => Loss 0.278, Train_accy 91.65:  80%|████████  | 16/20 [13:30<03:22, 50.64s/it]
Task 4, Epoch 17/20 => Loss 0.287, Train_accy 91.47:  80%|████████  | 16/20 [14:20<03:22, 50.64s/it]
Task 4, Epoch 17/20 => Loss 0.287, Train_accy 91.47:  85%|████████▌ | 17/20 [14:20<02:31, 50.63s/it]
Task 4, Epoch 18/20 => Loss 0.289, Train_accy 91.36:  85%|████████▌ | 17/20 [15:11<02:31, 50.63s/it]
Task 4, Epoch 18/20 => Loss 0.289, Train_accy 91.36:  90%|█████████ | 18/20 [15:11<01:41, 50.62s/it]
Task 4, Epoch 19/20 => Loss 0.269, Train_accy 91.95:  90%|█████████ | 18/20 [16:02<01:41, 50.62s/it]
Task 4, Epoch 19/20 => Loss 0.269, Train_accy 91.95:  95%|█████████▌| 19/20 [16:02<00:50, 50.63s/it]
Task 4, Epoch 20/20 => Loss 0.261, Train_accy 91.95:  95%|█████████▌| 19/20 [16:52<00:50, 50.63s/it]
Task 4, Epoch 20/20 => Loss 0.261, Train_accy 91.95: 100%|██████████| 20/20 [16:52<00:00, 50.61s/it]
Task 4, Epoch 20/20 => Loss 0.261, Train_accy 91.95: 100%|██████████| 20/20 [16:52<00:00, 50.64s/it]
2024-09-04 12:37:08,078 [ease.py] => Task 4, Epoch 20/20 => Loss 0.261, Train_accy 91.95
2024-09-04 12:41:25,652 [ease.py] => Task correct: 90.78
2024-09-04 12:41:25,653 [ease.py] => Task acc: 97.53
2024-09-04 12:41:25,680 [trainer.py] => No NME accuracy.
2024-09-04 12:41:25,680 [trainer.py] => CNN: {'total': 89.5, '00-19': 87.4, '20-39': 93.1, '40-59': 88.55, '60-79': 87.1, '80-99': 91.35, 'old': 89.04, 'new': 91.35}
2024-09-04 12:41:25,681 [trainer.py] => CNN top1 curve: [97.65, 94.88, 92.85, 90.66, 89.5]
2024-09-04 12:41:25,681 [trainer.py] => CNN top5 curve: [99.85, 99.72, 99.43, 99.31, 99.03]

Average Accuracy (CNN): 93.11
2024-09-04 12:41:25,681 [trainer.py] => Average Accuracy (CNN): 93.11 

Accuracy Matrix (CNN):
[[97.65 92.75 90.65 89.4  87.4 ]
 [ 0.   97.   94.25 93.65 93.1 ]
 [ 0.    0.   93.65 90.7  88.55]
 [ 0.    0.    0.   88.9  87.1 ]
 [ 0.    0.    0.    0.   91.35]]
2024-09-04 12:41:25,681 [trainer.py] => Forgetting (CNN): 5.262500000000006
2024-09-04 12:41:28,336 [trainer.py] => config: ./exps/ease_cifar_B0_Inc10.json
2024-09-04 12:41:28,336 [trainer.py] => prefix:  
2024-09-04 12:41:28,336 [trainer.py] => dataset: cifar224
2024-09-04 12:41:28,336 [trainer.py] => memory_size: 0
2024-09-04 12:41:28,336 [trainer.py] => memory_per_class: 0
2024-09-04 12:41:28,336 [trainer.py] => fixed_memory: False
2024-09-04 12:41:28,336 [trainer.py] => shuffle: True
2024-09-04 12:41:28,336 [trainer.py] => init_cls: 10
2024-09-04 12:41:28,336 [trainer.py] => increment: 10
2024-09-04 12:41:28,336 [trainer.py] => model_name: ease
2024-09-04 12:41:28,336 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-04 12:41:28,336 [trainer.py] => device: [device(type='cuda', index=3)]
2024-09-04 12:41:28,336 [trainer.py] => seed: 1993
2024-09-04 12:41:28,336 [trainer.py] => init_epochs: 20
2024-09-04 12:41:28,336 [trainer.py] => init_lr: 0.025
2024-09-04 12:41:28,336 [trainer.py] => later_epochs: 20
2024-09-04 12:41:28,336 [trainer.py] => later_lr: 0.025
2024-09-04 12:41:28,336 [trainer.py] => batch_size: 48
2024-09-04 12:41:28,336 [trainer.py] => weight_decay: 0.0005
2024-09-04 12:41:28,337 [trainer.py] => min_lr: 0
2024-09-04 12:41:28,337 [trainer.py] => optimizer: sgd
2024-09-04 12:41:28,337 [trainer.py] => scheduler: cosine
2024-09-04 12:41:28,337 [trainer.py] => pretrained: True
2024-09-04 12:41:28,337 [trainer.py] => vpt_type: Deep
2024-09-04 12:41:28,337 [trainer.py] => prompt_token_num: 5
2024-09-04 12:41:28,337 [trainer.py] => ffn_num: 16
2024-09-04 12:41:28,337 [trainer.py] => use_diagonal: False
2024-09-04 12:41:28,337 [trainer.py] => recalc_sim: True
2024-09-04 12:41:28,337 [trainer.py] => alpha: 0.1
2024-09-04 12:41:28,337 [trainer.py] => use_init_ptm: False
2024-09-04 12:41:28,337 [trainer.py] => beta: 0
2024-09-04 12:41:28,337 [trainer.py] => use_old_data: False
2024-09-04 12:41:28,337 [trainer.py] => use_reweight: True
2024-09-04 12:41:28,337 [trainer.py] => moni_adam: False
2024-09-04 12:41:28,337 [trainer.py] => adapter_num: -1
2024-09-04 12:41:29,437 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-04 12:41:32,285 [trainer.py] => All params: 86102976
2024-09-04 12:41:32,286 [trainer.py] => Trainable params: 304320
2024-09-04 12:41:32,293 [ease.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.713, Train_accy 71.90:   0%|          | 0/20 [00:25<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.713, Train_accy 71.90:   5%|▌         | 1/20 [00:25<08:01, 25.36s/it]
Task 0, Epoch 2/20 => Loss 0.563, Train_accy 88.06:   5%|▌         | 1/20 [00:50<08:01, 25.36s/it]
Task 0, Epoch 2/20 => Loss 0.563, Train_accy 88.06:  10%|█         | 2/20 [00:50<07:36, 25.34s/it]
Task 0, Epoch 3/20 => Loss 0.358, Train_accy 90.40:  10%|█         | 2/20 [01:16<07:36, 25.34s/it]
Task 0, Epoch 3/20 => Loss 0.358, Train_accy 90.40:  15%|█▌        | 3/20 [01:16<07:11, 25.40s/it]
Task 0, Epoch 4/20 => Loss 0.290, Train_accy 91.74:  15%|█▌        | 3/20 [01:41<07:11, 25.40s/it]
Task 0, Epoch 4/20 => Loss 0.290, Train_accy 91.74:  20%|██        | 4/20 [01:41<06:46, 25.39s/it]
Task 0, Epoch 5/20 => Loss 0.256, Train_accy 92.66:  20%|██        | 4/20 [02:06<06:46, 25.39s/it]
Task 0, Epoch 5/20 => Loss 0.256, Train_accy 92.66:  25%|██▌       | 5/20 [02:06<06:20, 25.38s/it]
Task 0, Epoch 6/20 => Loss 0.238, Train_accy 92.96:  25%|██▌       | 5/20 [02:32<06:20, 25.38s/it]
Task 0, Epoch 6/20 => Loss 0.238, Train_accy 92.96:  30%|███       | 6/20 [02:32<05:54, 25.34s/it]
Task 0, Epoch 7/20 => Loss 0.240, Train_accy 92.64:  30%|███       | 6/20 [02:57<05:54, 25.34s/it]
Task 0, Epoch 7/20 => Loss 0.240, Train_accy 92.64:  35%|███▌      | 7/20 [02:57<05:29, 25.36s/it]
Task 0, Epoch 8/20 => Loss 0.232, Train_accy 93.08:  35%|███▌      | 7/20 [03:22<05:29, 25.36s/it]
Task 0, Epoch 8/20 => Loss 0.232, Train_accy 93.08:  40%|████      | 8/20 [03:22<05:03, 25.30s/it]
Task 0, Epoch 9/20 => Loss 0.218, Train_accy 93.60:  40%|████      | 8/20 [03:47<05:03, 25.30s/it]
Task 0, Epoch 9/20 => Loss 0.218, Train_accy 93.60:  45%|████▌     | 9/20 [03:47<04:38, 25.28s/it]
Task 0, Epoch 10/20 => Loss 0.215, Train_accy 93.46:  45%|████▌     | 9/20 [04:13<04:38, 25.28s/it]
Task 0, Epoch 10/20 => Loss 0.215, Train_accy 93.46:  50%|█████     | 10/20 [04:13<04:13, 25.32s/it]
Task 0, Epoch 11/20 => Loss 0.216, Train_accy 93.38:  50%|█████     | 10/20 [04:38<04:13, 25.32s/it]
Task 0, Epoch 11/20 => Loss 0.216, Train_accy 93.38:  55%|█████▌    | 11/20 [04:38<03:48, 25.34s/it]
Task 0, Epoch 12/20 => Loss 0.203, Train_accy 93.80:  55%|█████▌    | 11/20 [05:04<03:48, 25.34s/it]
Task 0, Epoch 12/20 => Loss 0.203, Train_accy 93.80:  60%|██████    | 12/20 [05:04<03:22, 25.37s/it]
Task 0, Epoch 13/20 => Loss 0.200, Train_accy 93.72:  60%|██████    | 12/20 [05:29<03:22, 25.37s/it]
Task 0, Epoch 13/20 => Loss 0.200, Train_accy 93.72:  65%|██████▌   | 13/20 [05:29<02:57, 25.37s/it]
Task 0, Epoch 14/20 => Loss 0.197, Train_accy 94.00:  65%|██████▌   | 13/20 [05:54<02:57, 25.37s/it]
Task 0, Epoch 14/20 => Loss 0.197, Train_accy 94.00:  70%|███████   | 14/20 [05:54<02:32, 25.34s/it]
Task 0, Epoch 15/20 => Loss 0.201, Train_accy 93.88:  70%|███████   | 14/20 [06:20<02:32, 25.34s/it]
Task 0, Epoch 15/20 => Loss 0.201, Train_accy 93.88:  75%|███████▌  | 15/20 [06:20<02:06, 25.35s/it]
Task 0, Epoch 16/20 => Loss 0.194, Train_accy 93.90:  75%|███████▌  | 15/20 [06:45<02:06, 25.35s/it]
Task 0, Epoch 16/20 => Loss 0.194, Train_accy 93.90:  80%|████████  | 16/20 [06:45<01:41, 25.38s/it]
Task 0, Epoch 17/20 => Loss 0.189, Train_accy 94.06:  80%|████████  | 16/20 [07:10<01:41, 25.38s/it]
Task 0, Epoch 17/20 => Loss 0.189, Train_accy 94.06:  85%|████████▌ | 17/20 [07:10<01:16, 25.36s/it]
Task 0, Epoch 18/20 => Loss 0.199, Train_accy 93.96:  85%|████████▌ | 17/20 [07:36<01:16, 25.36s/it]
Task 0, Epoch 18/20 => Loss 0.199, Train_accy 93.96:  90%|█████████ | 18/20 [07:36<00:50, 25.34s/it]
Task 0, Epoch 19/20 => Loss 0.182, Train_accy 94.60:  90%|█████████ | 18/20 [08:01<00:50, 25.34s/it]
Task 0, Epoch 19/20 => Loss 0.182, Train_accy 94.60:  95%|█████████▌| 19/20 [08:01<00:25, 25.38s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.26:  95%|█████████▌| 19/20 [08:27<00:25, 25.38s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.26: 100%|██████████| 20/20 [08:27<00:00, 25.38s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.26: 100%|██████████| 20/20 [08:27<00:00, 25.35s/it]
2024-09-04 12:49:59,434 [ease.py] => Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.26
2024-09-04 12:50:15,954 [ease.py] => Task correct: 100.0
2024-09-04 12:50:15,955 [ease.py] => Task acc: 99.0
2024-09-04 12:50:15,979 [trainer.py] => No NME accuracy.
2024-09-04 12:50:15,979 [trainer.py] => CNN: {'total': 99.0, '00-09': 99.0, 'old': 0, 'new': 99.0}
2024-09-04 12:50:15,979 [trainer.py] => CNN top1 curve: [99.0]
2024-09-04 12:50:15,979 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.0
2024-09-04 12:50:15,979 [trainer.py] => Average Accuracy (CNN): 99.0 

2024-09-04 12:50:15,981 [trainer.py] => All params: 86118338
2024-09-04 12:50:15,981 [trainer.py] => Trainable params: 304320
2024-09-04 12:50:15,983 [ease.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.714, Train_accy 68.92:   0%|          | 0/20 [00:25<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.714, Train_accy 68.92:   5%|▌         | 1/20 [00:25<08:00, 25.30s/it]
Task 1, Epoch 2/20 => Loss 0.593, Train_accy 86.90:   5%|▌         | 1/20 [00:50<08:00, 25.30s/it]
Task 1, Epoch 2/20 => Loss 0.593, Train_accy 86.90:  10%|█         | 2/20 [00:50<07:34, 25.24s/it]
Task 1, Epoch 3/20 => Loss 0.397, Train_accy 88.48:  10%|█         | 2/20 [01:15<07:34, 25.24s/it]
Task 1, Epoch 3/20 => Loss 0.397, Train_accy 88.48:  15%|█▌        | 3/20 [01:15<07:09, 25.26s/it]
Task 1, Epoch 4/20 => Loss 0.331, Train_accy 90.10:  15%|█▌        | 3/20 [01:41<07:09, 25.26s/it]
Task 1, Epoch 4/20 => Loss 0.331, Train_accy 90.10:  20%|██        | 4/20 [01:41<06:44, 25.27s/it]
Task 1, Epoch 5/20 => Loss 0.320, Train_accy 90.26:  20%|██        | 4/20 [02:06<06:44, 25.27s/it]
Task 1, Epoch 5/20 => Loss 0.320, Train_accy 90.26:  25%|██▌       | 5/20 [02:06<06:18, 25.23s/it]
Task 1, Epoch 6/20 => Loss 0.292, Train_accy 90.64:  25%|██▌       | 5/20 [02:31<06:18, 25.23s/it]
Task 1, Epoch 6/20 => Loss 0.292, Train_accy 90.64:  30%|███       | 6/20 [02:31<05:53, 25.26s/it]
Task 1, Epoch 7/20 => Loss 0.292, Train_accy 91.06:  30%|███       | 6/20 [02:56<05:53, 25.26s/it]
Task 1, Epoch 7/20 => Loss 0.292, Train_accy 91.06:  35%|███▌      | 7/20 [02:56<05:28, 25.28s/it]
Task 1, Epoch 8/20 => Loss 0.286, Train_accy 90.98:  35%|███▌      | 7/20 [03:22<05:28, 25.28s/it]
Task 1, Epoch 8/20 => Loss 0.286, Train_accy 90.98:  40%|████      | 8/20 [03:22<05:03, 25.26s/it]
Task 1, Epoch 9/20 => Loss 0.284, Train_accy 90.92:  40%|████      | 8/20 [03:47<05:03, 25.26s/it]
Task 1, Epoch 9/20 => Loss 0.284, Train_accy 90.92:  45%|████▌     | 9/20 [03:47<04:37, 25.27s/it]
Task 1, Epoch 10/20 => Loss 0.269, Train_accy 91.72:  45%|████▌     | 9/20 [04:12<04:37, 25.27s/it]
Task 1, Epoch 10/20 => Loss 0.269, Train_accy 91.72:  50%|█████     | 10/20 [04:12<04:12, 25.27s/it]
Task 1, Epoch 11/20 => Loss 0.246, Train_accy 92.54:  50%|█████     | 10/20 [04:38<04:12, 25.27s/it]
Task 1, Epoch 11/20 => Loss 0.246, Train_accy 92.54:  55%|█████▌    | 11/20 [04:38<03:47, 25.30s/it]
Task 1, Epoch 12/20 => Loss 0.259, Train_accy 91.94:  55%|█████▌    | 11/20 [05:03<03:47, 25.30s/it]
Task 1, Epoch 12/20 => Loss 0.259, Train_accy 91.94:  60%|██████    | 12/20 [05:03<03:22, 25.32s/it]
Task 1, Epoch 13/20 => Loss 0.254, Train_accy 91.72:  60%|██████    | 12/20 [05:28<03:22, 25.32s/it]
Task 1, Epoch 13/20 => Loss 0.254, Train_accy 91.72:  65%|██████▌   | 13/20 [05:28<02:56, 25.28s/it]
Task 1, Epoch 14/20 => Loss 0.247, Train_accy 91.76:  65%|██████▌   | 13/20 [05:53<02:56, 25.28s/it]
Task 1, Epoch 14/20 => Loss 0.247, Train_accy 91.76:  70%|███████   | 14/20 [05:53<02:31, 25.27s/it]
Task 1, Epoch 15/20 => Loss 0.251, Train_accy 92.02:  70%|███████   | 14/20 [06:19<02:31, 25.27s/it]
Task 1, Epoch 15/20 => Loss 0.251, Train_accy 92.02:  75%|███████▌  | 15/20 [06:19<02:06, 25.32s/it]
Task 1, Epoch 16/20 => Loss 0.245, Train_accy 92.08:  75%|███████▌  | 15/20 [06:44<02:06, 25.32s/it]
Task 1, Epoch 16/20 => Loss 0.245, Train_accy 92.08:  80%|████████  | 16/20 [06:44<01:41, 25.32s/it]
Task 1, Epoch 17/20 => Loss 0.237, Train_accy 92.36:  80%|████████  | 16/20 [07:09<01:41, 25.32s/it]
Task 1, Epoch 17/20 => Loss 0.237, Train_accy 92.36:  85%|████████▌ | 17/20 [07:09<01:15, 25.31s/it]
Task 1, Epoch 18/20 => Loss 0.254, Train_accy 91.52:  85%|████████▌ | 17/20 [07:35<01:15, 25.31s/it]
Task 1, Epoch 18/20 => Loss 0.254, Train_accy 91.52:  90%|█████████ | 18/20 [07:35<00:50, 25.32s/it]
Task 1, Epoch 19/20 => Loss 0.232, Train_accy 92.72:  90%|█████████ | 18/20 [08:00<00:50, 25.32s/it]
Task 1, Epoch 19/20 => Loss 0.232, Train_accy 92.72:  95%|█████████▌| 19/20 [08:00<00:25, 25.30s/it]
Task 1, Epoch 20/20 => Loss 0.255, Train_accy 91.60:  95%|█████████▌| 19/20 [08:25<00:25, 25.30s/it]
Task 1, Epoch 20/20 => Loss 0.255, Train_accy 91.60: 100%|██████████| 20/20 [08:25<00:00, 25.29s/it]
Task 1, Epoch 20/20 => Loss 0.255, Train_accy 91.60: 100%|██████████| 20/20 [08:25<00:00, 25.29s/it]
2024-09-04 12:58:41,756 [ease.py] => Task 1, Epoch 20/20 => Loss 0.255, Train_accy 91.60
2024-09-04 12:59:19,064 [ease.py] => Task correct: 97.65
2024-09-04 12:59:19,064 [ease.py] => Task acc: 98.5
2024-09-04 12:59:19,091 [trainer.py] => No NME accuracy.
2024-09-04 12:59:19,091 [trainer.py] => CNN: {'total': 96.75, '00-09': 97.2, '10-19': 96.3, 'old': 97.2, 'new': 96.3}
2024-09-04 12:59:19,091 [trainer.py] => CNN top1 curve: [99.0, 96.75]
2024-09-04 12:59:19,091 [trainer.py] => CNN top5 curve: [100.0, 99.9]

Average Accuracy (CNN): 97.88
2024-09-04 12:59:19,091 [trainer.py] => Average Accuracy (CNN): 97.88 

2024-09-04 12:59:19,092 [trainer.py] => All params: 86141378
2024-09-04 12:59:19,092 [trainer.py] => Trainable params: 304320
2024-09-04 12:59:19,094 [ease.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.523, Train_accy 78.74:   0%|          | 0/20 [00:25<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.523, Train_accy 78.74:   5%|▌         | 1/20 [00:25<08:03, 25.45s/it]
Task 2, Epoch 2/20 => Loss 0.366, Train_accy 91.96:   5%|▌         | 1/20 [00:50<08:03, 25.45s/it]
Task 2, Epoch 2/20 => Loss 0.366, Train_accy 91.96:  10%|█         | 2/20 [00:50<07:36, 25.36s/it]
Task 2, Epoch 3/20 => Loss 0.252, Train_accy 92.76:  10%|█         | 2/20 [01:15<07:36, 25.36s/it]
Task 2, Epoch 3/20 => Loss 0.252, Train_accy 92.76:  15%|█▌        | 3/20 [01:15<07:10, 25.31s/it]
Task 2, Epoch 4/20 => Loss 0.230, Train_accy 92.98:  15%|█▌        | 3/20 [01:41<07:10, 25.31s/it]
Task 2, Epoch 4/20 => Loss 0.230, Train_accy 92.98:  20%|██        | 4/20 [01:41<06:44, 25.31s/it]
Task 2, Epoch 5/20 => Loss 0.195, Train_accy 94.24:  20%|██        | 4/20 [02:06<06:44, 25.31s/it]
Task 2, Epoch 5/20 => Loss 0.195, Train_accy 94.24:  25%|██▌       | 5/20 [02:06<06:19, 25.28s/it]
Task 2, Epoch 6/20 => Loss 0.171, Train_accy 94.66:  25%|██▌       | 5/20 [02:31<06:19, 25.28s/it]
Task 2, Epoch 6/20 => Loss 0.171, Train_accy 94.66:  30%|███       | 6/20 [02:31<05:53, 25.25s/it]
Task 2, Epoch 7/20 => Loss 0.167, Train_accy 94.82:  30%|███       | 6/20 [02:57<05:53, 25.25s/it]
Task 2, Epoch 7/20 => Loss 0.167, Train_accy 94.82:  35%|███▌      | 7/20 [02:57<05:29, 25.32s/it]
Task 2, Epoch 8/20 => Loss 0.177, Train_accy 94.56:  35%|███▌      | 7/20 [03:22<05:29, 25.32s/it]
Task 2, Epoch 8/20 => Loss 0.177, Train_accy 94.56:  40%|████      | 8/20 [03:22<05:04, 25.35s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 95.32:  40%|████      | 8/20 [03:47<05:04, 25.35s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 95.32:  45%|████▌     | 9/20 [03:47<04:38, 25.35s/it]
Task 2, Epoch 10/20 => Loss 0.150, Train_accy 95.60:  45%|████▌     | 9/20 [04:13<04:38, 25.35s/it]
Task 2, Epoch 10/20 => Loss 0.150, Train_accy 95.60:  50%|█████     | 10/20 [04:13<04:13, 25.32s/it]
Task 2, Epoch 11/20 => Loss 0.157, Train_accy 95.38:  50%|█████     | 10/20 [04:38<04:13, 25.32s/it]
Task 2, Epoch 11/20 => Loss 0.157, Train_accy 95.38:  55%|█████▌    | 11/20 [04:38<03:47, 25.31s/it]
Task 2, Epoch 12/20 => Loss 0.151, Train_accy 95.18:  55%|█████▌    | 11/20 [05:03<03:47, 25.31s/it]
Task 2, Epoch 12/20 => Loss 0.151, Train_accy 95.18:  60%|██████    | 12/20 [05:03<03:22, 25.30s/it]
Task 2, Epoch 13/20 => Loss 0.144, Train_accy 95.46:  60%|██████    | 12/20 [05:29<03:22, 25.30s/it]
Task 2, Epoch 13/20 => Loss 0.144, Train_accy 95.46:  65%|██████▌   | 13/20 [05:29<02:57, 25.29s/it]
Task 2, Epoch 14/20 => Loss 0.153, Train_accy 95.56:  65%|██████▌   | 13/20 [05:54<02:57, 25.29s/it]
Task 2, Epoch 14/20 => Loss 0.153, Train_accy 95.56:  70%|███████   | 14/20 [05:54<02:31, 25.30s/it]
Task 2, Epoch 15/20 => Loss 0.135, Train_accy 95.68:  70%|███████   | 14/20 [06:19<02:31, 25.30s/it]
Task 2, Epoch 15/20 => Loss 0.135, Train_accy 95.68:  75%|███████▌  | 15/20 [06:19<02:06, 25.30s/it]
Task 2, Epoch 16/20 => Loss 0.147, Train_accy 95.54:  75%|███████▌  | 15/20 [06:45<02:06, 25.30s/it]
Task 2, Epoch 16/20 => Loss 0.147, Train_accy 95.54:  80%|████████  | 16/20 [06:45<01:41, 25.32s/it]
Task 2, Epoch 17/20 => Loss 0.155, Train_accy 95.14:  80%|████████  | 16/20 [07:10<01:41, 25.32s/it]
Task 2, Epoch 17/20 => Loss 0.155, Train_accy 95.14:  85%|████████▌ | 17/20 [07:10<01:15, 25.29s/it]
Task 2, Epoch 18/20 => Loss 0.149, Train_accy 95.30:  85%|████████▌ | 17/20 [07:35<01:15, 25.29s/it]
Task 2, Epoch 18/20 => Loss 0.149, Train_accy 95.30:  90%|█████████ | 18/20 [07:35<00:50, 25.29s/it]
Task 2, Epoch 19/20 => Loss 0.147, Train_accy 95.18:  90%|█████████ | 18/20 [08:00<00:50, 25.29s/it]
Task 2, Epoch 19/20 => Loss 0.147, Train_accy 95.18:  95%|█████████▌| 19/20 [08:00<00:25, 25.30s/it]
Task 2, Epoch 20/20 => Loss 0.140, Train_accy 95.48:  95%|█████████▌| 19/20 [08:26<00:25, 25.30s/it]
Task 2, Epoch 20/20 => Loss 0.140, Train_accy 95.48: 100%|██████████| 20/20 [08:26<00:00, 25.28s/it]
Task 2, Epoch 20/20 => Loss 0.140, Train_accy 95.48: 100%|██████████| 20/20 [08:26<00:00, 25.30s/it]
2024-09-04 13:07:45,274 [ease.py] => Task 2, Epoch 20/20 => Loss 0.140, Train_accy 95.48
2024-09-04 13:08:48,552 [ease.py] => Task correct: 95.76666666666667
2024-09-04 13:08:48,552 [ease.py] => Task acc: 98.8
2024-09-04 13:08:48,565 [trainer.py] => No NME accuracy.
2024-09-04 13:08:48,565 [trainer.py] => CNN: {'total': 95.27, '00-09': 93.8, '10-19': 94.3, '20-29': 97.7, 'old': 94.05, 'new': 97.7}
2024-09-04 13:08:48,565 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27]
2024-09-04 13:08:48,566 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63]

Average Accuracy (CNN): 97.01
2024-09-04 13:08:48,566 [trainer.py] => Average Accuracy (CNN): 97.01 

2024-09-04 13:08:48,566 [trainer.py] => All params: 86179778
2024-09-04 13:08:48,567 [trainer.py] => Trainable params: 304320
2024-09-04 13:08:48,569 [ease.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.614, Train_accy 72.42:   0%|          | 0/20 [00:25<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.614, Train_accy 72.42:   5%|▌         | 1/20 [00:25<08:03, 25.44s/it]
Task 3, Epoch 2/20 => Loss 0.523, Train_accy 86.90:   5%|▌         | 1/20 [00:50<08:03, 25.44s/it]
Task 3, Epoch 2/20 => Loss 0.523, Train_accy 86.90:  10%|█         | 2/20 [00:50<07:36, 25.36s/it]
Task 3, Epoch 3/20 => Loss 0.342, Train_accy 89.68:  10%|█         | 2/20 [01:16<07:36, 25.36s/it]
Task 3, Epoch 3/20 => Loss 0.342, Train_accy 89.68:  15%|█▌        | 3/20 [01:16<07:10, 25.35s/it]
Task 3, Epoch 4/20 => Loss 0.304, Train_accy 90.40:  15%|█▌        | 3/20 [01:41<07:10, 25.35s/it]
Task 3, Epoch 4/20 => Loss 0.304, Train_accy 90.40:  20%|██        | 4/20 [01:41<06:44, 25.29s/it]
Task 3, Epoch 5/20 => Loss 0.283, Train_accy 91.06:  20%|██        | 4/20 [02:06<06:44, 25.29s/it]
Task 3, Epoch 5/20 => Loss 0.283, Train_accy 91.06:  25%|██▌       | 5/20 [02:06<06:18, 25.26s/it]
Task 3, Epoch 6/20 => Loss 0.246, Train_accy 91.98:  25%|██▌       | 5/20 [02:31<06:18, 25.26s/it]
Task 3, Epoch 6/20 => Loss 0.246, Train_accy 91.98:  30%|███       | 6/20 [02:31<05:53, 25.26s/it]
Task 3, Epoch 7/20 => Loss 0.242, Train_accy 91.92:  30%|███       | 6/20 [02:56<05:53, 25.26s/it]
Task 3, Epoch 7/20 => Loss 0.242, Train_accy 91.92:  35%|███▌      | 7/20 [02:56<05:28, 25.24s/it]
Task 3, Epoch 8/20 => Loss 0.237, Train_accy 92.38:  35%|███▌      | 7/20 [03:22<05:28, 25.24s/it]
Task 3, Epoch 8/20 => Loss 0.237, Train_accy 92.38:  40%|████      | 8/20 [03:22<05:02, 25.23s/it]
Task 3, Epoch 9/20 => Loss 0.219, Train_accy 92.76:  40%|████      | 8/20 [03:47<05:02, 25.23s/it]
Task 3, Epoch 9/20 => Loss 0.219, Train_accy 92.76:  45%|████▌     | 9/20 [03:47<04:37, 25.23s/it]
Task 3, Epoch 10/20 => Loss 0.214, Train_accy 93.02:  45%|████▌     | 9/20 [04:12<04:37, 25.23s/it]
Task 3, Epoch 10/20 => Loss 0.214, Train_accy 93.02:  50%|█████     | 10/20 [04:12<04:12, 25.23s/it]
Task 3, Epoch 11/20 => Loss 0.212, Train_accy 93.52:  50%|█████     | 10/20 [04:37<04:12, 25.23s/it]
Task 3, Epoch 11/20 => Loss 0.212, Train_accy 93.52:  55%|█████▌    | 11/20 [04:37<03:47, 25.24s/it]
Task 3, Epoch 12/20 => Loss 0.222, Train_accy 93.10:  55%|█████▌    | 11/20 [05:03<03:47, 25.24s/it]
Task 3, Epoch 12/20 => Loss 0.222, Train_accy 93.10:  60%|██████    | 12/20 [05:03<03:21, 25.24s/it]
Task 3, Epoch 13/20 => Loss 0.222, Train_accy 92.94:  60%|██████    | 12/20 [05:28<03:21, 25.24s/it]
Task 3, Epoch 13/20 => Loss 0.222, Train_accy 92.94:  65%|██████▌   | 13/20 [05:28<02:56, 25.26s/it]
Task 3, Epoch 14/20 => Loss 0.211, Train_accy 93.02:  65%|██████▌   | 13/20 [05:53<02:56, 25.26s/it]
Task 3, Epoch 14/20 => Loss 0.211, Train_accy 93.02:  70%|███████   | 14/20 [05:53<02:31, 25.22s/it]
Task 3, Epoch 15/20 => Loss 0.225, Train_accy 92.42:  70%|███████   | 14/20 [06:18<02:31, 25.22s/it]
Task 3, Epoch 15/20 => Loss 0.225, Train_accy 92.42:  75%|███████▌  | 15/20 [06:18<02:06, 25.24s/it]
Task 3, Epoch 16/20 => Loss 0.207, Train_accy 93.08:  75%|███████▌  | 15/20 [06:44<02:06, 25.24s/it]
Task 3, Epoch 16/20 => Loss 0.207, Train_accy 93.08:  80%|████████  | 16/20 [06:44<01:40, 25.25s/it]
Task 3, Epoch 17/20 => Loss 0.204, Train_accy 93.22:  80%|████████  | 16/20 [07:09<01:40, 25.25s/it]
Task 3, Epoch 17/20 => Loss 0.204, Train_accy 93.22:  85%|████████▌ | 17/20 [07:09<01:15, 25.29s/it]
Task 3, Epoch 18/20 => Loss 0.194, Train_accy 93.68:  85%|████████▌ | 17/20 [07:34<01:15, 25.29s/it]
Task 3, Epoch 18/20 => Loss 0.194, Train_accy 93.68:  90%|█████████ | 18/20 [07:34<00:50, 25.26s/it]
Task 3, Epoch 19/20 => Loss 0.197, Train_accy 93.72:  90%|█████████ | 18/20 [07:59<00:50, 25.26s/it]
Task 3, Epoch 19/20 => Loss 0.197, Train_accy 93.72:  95%|█████████▌| 19/20 [07:59<00:25, 25.26s/it]
Task 3, Epoch 20/20 => Loss 0.216, Train_accy 92.92:  95%|█████████▌| 19/20 [08:25<00:25, 25.26s/it]
Task 3, Epoch 20/20 => Loss 0.216, Train_accy 92.92: 100%|██████████| 20/20 [08:25<00:00, 25.25s/it]
Task 3, Epoch 20/20 => Loss 0.216, Train_accy 92.92: 100%|██████████| 20/20 [08:25<00:00, 25.26s/it]
2024-09-04 13:17:13,781 [ease.py] => Task 3, Epoch 20/20 => Loss 0.216, Train_accy 92.92
2024-09-04 13:18:46,708 [ease.py] => Task correct: 94.6
2024-09-04 13:18:46,708 [ease.py] => Task acc: 98.675
2024-09-04 13:18:46,732 [trainer.py] => No NME accuracy.
2024-09-04 13:18:46,733 [trainer.py] => CNN: {'total': 94.0, '00-09': 92.3, '10-19': 92.8, '20-29': 97.1, '30-39': 93.8, 'old': 94.07, 'new': 93.8}
2024-09-04 13:18:46,733 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27, 94.0]
2024-09-04 13:18:46,733 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63, 99.52]

Average Accuracy (CNN): 96.26
2024-09-04 13:18:46,733 [trainer.py] => Average Accuracy (CNN): 96.26 

2024-09-04 13:18:46,734 [trainer.py] => All params: 86233538
2024-09-04 13:18:46,734 [trainer.py] => Trainable params: 304320
2024-09-04 13:18:46,737 [ease.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.570, Train_accy 77.60:   0%|          | 0/20 [00:25<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.570, Train_accy 77.60:   5%|▌         | 1/20 [00:25<07:57, 25.14s/it]
Task 4, Epoch 2/20 => Loss 0.431, Train_accy 90.48:   5%|▌         | 1/20 [00:50<07:57, 25.14s/it]
Task 4, Epoch 2/20 => Loss 0.431, Train_accy 90.48:  10%|█         | 2/20 [00:50<07:33, 25.19s/it]
Task 4, Epoch 3/20 => Loss 0.276, Train_accy 92.64:  10%|█         | 2/20 [01:15<07:33, 25.19s/it]
Task 4, Epoch 3/20 => Loss 0.276, Train_accy 92.64:  15%|█▌        | 3/20 [01:15<07:07, 25.14s/it]
Task 4, Epoch 4/20 => Loss 0.242, Train_accy 93.20:  15%|█▌        | 3/20 [01:40<07:07, 25.14s/it]
Task 4, Epoch 4/20 => Loss 0.242, Train_accy 93.20:  20%|██        | 4/20 [01:40<06:42, 25.14s/it]
Task 4, Epoch 5/20 => Loss 0.237, Train_accy 93.30:  20%|██        | 4/20 [02:05<06:42, 25.14s/it]
Task 4, Epoch 5/20 => Loss 0.237, Train_accy 93.30:  25%|██▌       | 5/20 [02:05<06:17, 25.18s/it]
Task 4, Epoch 6/20 => Loss 0.206, Train_accy 94.36:  25%|██▌       | 5/20 [02:31<06:17, 25.18s/it]
Task 4, Epoch 6/20 => Loss 0.206, Train_accy 94.36:  30%|███       | 6/20 [02:31<05:52, 25.20s/it]
Task 4, Epoch 7/20 => Loss 0.190, Train_accy 94.40:  30%|███       | 6/20 [02:56<05:52, 25.20s/it]
Task 4, Epoch 7/20 => Loss 0.190, Train_accy 94.40:  35%|███▌      | 7/20 [02:56<05:27, 25.18s/it]
Task 4, Epoch 8/20 => Loss 0.185, Train_accy 94.64:  35%|███▌      | 7/20 [03:21<05:27, 25.18s/it]
Task 4, Epoch 8/20 => Loss 0.185, Train_accy 94.64:  40%|████      | 8/20 [03:21<05:01, 25.16s/it]
Task 4, Epoch 9/20 => Loss 0.178, Train_accy 95.16:  40%|████      | 8/20 [03:46<05:01, 25.16s/it]
Task 4, Epoch 9/20 => Loss 0.178, Train_accy 95.16:  45%|████▌     | 9/20 [03:46<04:36, 25.16s/it]
Task 4, Epoch 10/20 => Loss 0.182, Train_accy 94.54:  45%|████▌     | 9/20 [04:11<04:36, 25.16s/it]
Task 4, Epoch 10/20 => Loss 0.182, Train_accy 94.54:  50%|█████     | 10/20 [04:11<04:11, 25.19s/it]
Task 4, Epoch 11/20 => Loss 0.165, Train_accy 94.70:  50%|█████     | 10/20 [04:36<04:11, 25.19s/it]
Task 4, Epoch 11/20 => Loss 0.165, Train_accy 94.70:  55%|█████▌    | 11/20 [04:36<03:46, 25.20s/it]
Task 4, Epoch 12/20 => Loss 0.168, Train_accy 95.06:  55%|█████▌    | 11/20 [05:02<03:46, 25.20s/it]
Task 4, Epoch 12/20 => Loss 0.168, Train_accy 95.06:  60%|██████    | 12/20 [05:02<03:21, 25.20s/it]
Task 4, Epoch 13/20 => Loss 0.158, Train_accy 95.56:  60%|██████    | 12/20 [05:27<03:21, 25.20s/it]
Task 4, Epoch 13/20 => Loss 0.158, Train_accy 95.56:  65%|██████▌   | 13/20 [05:27<02:56, 25.15s/it]
Task 4, Epoch 14/20 => Loss 0.166, Train_accy 94.90:  65%|██████▌   | 13/20 [05:52<02:56, 25.15s/it]
Task 4, Epoch 14/20 => Loss 0.166, Train_accy 94.90:  70%|███████   | 14/20 [05:52<02:30, 25.11s/it]
Task 4, Epoch 15/20 => Loss 0.162, Train_accy 95.00:  70%|███████   | 14/20 [06:17<02:30, 25.11s/it]
Task 4, Epoch 15/20 => Loss 0.162, Train_accy 95.00:  75%|███████▌  | 15/20 [06:17<02:05, 25.08s/it]
Task 4, Epoch 16/20 => Loss 0.158, Train_accy 95.20:  75%|███████▌  | 15/20 [06:42<02:05, 25.08s/it]
Task 4, Epoch 16/20 => Loss 0.158, Train_accy 95.20:  80%|████████  | 16/20 [06:42<01:40, 25.13s/it]
Task 4, Epoch 17/20 => Loss 0.153, Train_accy 95.58:  80%|████████  | 16/20 [07:07<01:40, 25.13s/it]
Task 4, Epoch 17/20 => Loss 0.153, Train_accy 95.58:  85%|████████▌ | 17/20 [07:07<01:15, 25.13s/it]
Task 4, Epoch 18/20 => Loss 0.157, Train_accy 95.30:  85%|████████▌ | 17/20 [07:32<01:15, 25.13s/it]
Task 4, Epoch 18/20 => Loss 0.157, Train_accy 95.30:  90%|█████████ | 18/20 [07:32<00:50, 25.14s/it]
Task 4, Epoch 19/20 => Loss 0.161, Train_accy 95.20:  90%|█████████ | 18/20 [07:57<00:50, 25.14s/it]
Task 4, Epoch 19/20 => Loss 0.161, Train_accy 95.20:  95%|█████████▌| 19/20 [07:57<00:25, 25.13s/it]
Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.68:  95%|█████████▌| 19/20 [08:23<00:25, 25.13s/it]
Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.68: 100%|██████████| 20/20 [08:23<00:00, 25.15s/it]
Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.68: 100%|██████████| 20/20 [08:23<00:00, 25.15s/it]
2024-09-04 13:27:09,920 [ease.py] => Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.68
2024-09-04 13:29:17,757 [ease.py] => Task correct: 92.74
2024-09-04 13:29:17,757 [ease.py] => Task acc: 98.8
2024-09-04 13:29:17,781 [trainer.py] => No NME accuracy.
2024-09-04 13:29:17,782 [trainer.py] => CNN: {'total': 92.3, '00-09': 91.4, '10-19': 89.3, '20-29': 95.7, '30-39': 90.4, '40-49': 94.7, 'old': 91.7, 'new': 94.7}
2024-09-04 13:29:17,782 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27, 94.0, 92.3]
2024-09-04 13:29:17,782 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63, 99.52, 99.44]

Average Accuracy (CNN): 95.46
2024-09-04 13:29:17,782 [trainer.py] => Average Accuracy (CNN): 95.46 

2024-09-04 13:29:17,783 [trainer.py] => All params: 86302658
2024-09-04 13:29:17,783 [trainer.py] => Trainable params: 304320
2024-09-04 13:29:17,786 [ease.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.646, Train_accy 72.46:   0%|          | 0/20 [00:25<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.646, Train_accy 72.46:   5%|▌         | 1/20 [00:25<07:59, 25.25s/it]
Task 5, Epoch 2/20 => Loss 0.508, Train_accy 88.24:   5%|▌         | 1/20 [00:50<07:59, 25.25s/it]
Task 5, Epoch 2/20 => Loss 0.508, Train_accy 88.24:  10%|█         | 2/20 [00:50<07:33, 25.22s/it]
Task 5, Epoch 3/20 => Loss 0.344, Train_accy 89.64:  10%|█         | 2/20 [01:15<07:33, 25.22s/it]
Task 5, Epoch 3/20 => Loss 0.344, Train_accy 89.64:  15%|█▌        | 3/20 [01:15<07:08, 25.21s/it]
Task 5, Epoch 4/20 => Loss 0.287, Train_accy 91.64:  15%|█▌        | 3/20 [01:40<07:08, 25.21s/it]
Task 5, Epoch 4/20 => Loss 0.287, Train_accy 91.64:  20%|██        | 4/20 [01:40<06:43, 25.19s/it]
Task 5, Epoch 5/20 => Loss 0.251, Train_accy 92.32:  20%|██        | 4/20 [02:05<06:43, 25.19s/it]
Task 5, Epoch 5/20 => Loss 0.251, Train_accy 92.32:  25%|██▌       | 5/20 [02:05<06:17, 25.17s/it]
Task 5, Epoch 6/20 => Loss 0.251, Train_accy 92.22:  25%|██▌       | 5/20 [02:31<06:17, 25.17s/it]
Task 5, Epoch 6/20 => Loss 0.251, Train_accy 92.22:  30%|███       | 6/20 [02:31<05:51, 25.13s/it]
Task 5, Epoch 7/20 => Loss 0.243, Train_accy 92.22:  30%|███       | 6/20 [02:56<05:51, 25.13s/it]
Task 5, Epoch 7/20 => Loss 0.243, Train_accy 92.22:  35%|███▌      | 7/20 [02:56<05:26, 25.14s/it]
Task 5, Epoch 8/20 => Loss 0.232, Train_accy 93.02:  35%|███▌      | 7/20 [03:21<05:26, 25.14s/it]
Task 5, Epoch 8/20 => Loss 0.232, Train_accy 93.02:  40%|████      | 8/20 [03:21<05:01, 25.15s/it]
Task 5, Epoch 9/20 => Loss 0.222, Train_accy 92.90:  40%|████      | 8/20 [03:46<05:01, 25.15s/it]
Task 5, Epoch 9/20 => Loss 0.222, Train_accy 92.90:  45%|████▌     | 9/20 [03:46<04:36, 25.14s/it]
Task 5, Epoch 10/20 => Loss 0.227, Train_accy 92.84:  45%|████▌     | 9/20 [04:11<04:36, 25.14s/it]
Task 5, Epoch 10/20 => Loss 0.227, Train_accy 92.84:  50%|█████     | 10/20 [04:11<04:11, 25.11s/it]
Task 5, Epoch 11/20 => Loss 0.204, Train_accy 93.56:  50%|█████     | 10/20 [04:36<04:11, 25.11s/it]
Task 5, Epoch 11/20 => Loss 0.204, Train_accy 93.56:  55%|█████▌    | 11/20 [04:36<03:45, 25.08s/it]
Task 5, Epoch 12/20 => Loss 0.211, Train_accy 93.14:  55%|█████▌    | 11/20 [05:01<03:45, 25.08s/it]
Task 5, Epoch 12/20 => Loss 0.211, Train_accy 93.14:  60%|██████    | 12/20 [05:01<03:20, 25.09s/it]
Task 5, Epoch 13/20 => Loss 0.206, Train_accy 93.14:  60%|██████    | 12/20 [05:26<03:20, 25.09s/it]
Task 5, Epoch 13/20 => Loss 0.206, Train_accy 93.14:  65%|██████▌   | 13/20 [05:26<02:55, 25.13s/it]
Task 5, Epoch 14/20 => Loss 0.206, Train_accy 93.34:  65%|██████▌   | 13/20 [05:52<02:55, 25.13s/it]
Task 5, Epoch 14/20 => Loss 0.206, Train_accy 93.34:  70%|███████   | 14/20 [05:52<02:31, 25.18s/it]
Task 5, Epoch 15/20 => Loss 0.190, Train_accy 93.90:  70%|███████   | 14/20 [06:17<02:31, 25.18s/it]
Task 5, Epoch 15/20 => Loss 0.190, Train_accy 93.90:  75%|███████▌  | 15/20 [06:17<02:05, 25.18s/it]
Task 5, Epoch 16/20 => Loss 0.198, Train_accy 93.52:  75%|███████▌  | 15/20 [06:42<02:05, 25.18s/it]
Task 5, Epoch 16/20 => Loss 0.198, Train_accy 93.52:  80%|████████  | 16/20 [06:42<01:40, 25.18s/it]
Task 5, Epoch 17/20 => Loss 0.196, Train_accy 93.60:  80%|████████  | 16/20 [07:07<01:40, 25.18s/it]
Task 5, Epoch 17/20 => Loss 0.196, Train_accy 93.60:  85%|████████▌ | 17/20 [07:07<01:15, 25.20s/it]
Task 5, Epoch 18/20 => Loss 0.194, Train_accy 93.94:  85%|████████▌ | 17/20 [07:32<01:15, 25.20s/it]
Task 5, Epoch 18/20 => Loss 0.194, Train_accy 93.94:  90%|█████████ | 18/20 [07:32<00:50, 25.21s/it]
Task 5, Epoch 19/20 => Loss 0.195, Train_accy 93.38:  90%|█████████ | 18/20 [07:58<00:50, 25.21s/it]
Task 5, Epoch 19/20 => Loss 0.195, Train_accy 93.38:  95%|█████████▌| 19/20 [07:58<00:25, 25.20s/it]
Task 5, Epoch 20/20 => Loss 0.196, Train_accy 93.76:  95%|█████████▌| 19/20 [08:23<00:25, 25.20s/it]
Task 5, Epoch 20/20 => Loss 0.196, Train_accy 93.76: 100%|██████████| 20/20 [08:23<00:00, 25.16s/it]
Task 5, Epoch 20/20 => Loss 0.196, Train_accy 93.76: 100%|██████████| 20/20 [08:23<00:00, 25.16s/it]
2024-09-04 13:37:41,031 [ease.py] => Task 5, Epoch 20/20 => Loss 0.196, Train_accy 93.76
2024-09-04 13:40:28,656 [ease.py] => Task correct: 91.9
2024-09-04 13:40:28,656 [ease.py] => Task acc: 98.85
2024-09-04 13:40:28,681 [trainer.py] => No NME accuracy.
2024-09-04 13:40:28,682 [trainer.py] => CNN: {'total': 91.48, '00-09': 90.4, '10-19': 89.0, '20-29': 95.0, '30-39': 89.7, '40-49': 93.5, '50-59': 91.3, 'old': 91.52, 'new': 91.3}
2024-09-04 13:40:28,682 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27, 94.0, 92.3, 91.48]
2024-09-04 13:40:28,682 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63, 99.52, 99.44, 99.23]

Average Accuracy (CNN): 94.8
2024-09-04 13:40:28,682 [trainer.py] => Average Accuracy (CNN): 94.8 

2024-09-04 13:40:28,684 [trainer.py] => All params: 86387138
2024-09-04 13:40:28,686 [trainer.py] => Trainable params: 304320
2024-09-04 13:40:28,698 [ease.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.536, Train_accy 79.30:   0%|          | 0/20 [00:25<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.536, Train_accy 79.30:   5%|▌         | 1/20 [00:25<07:56, 25.10s/it]
Task 6, Epoch 2/20 => Loss 0.415, Train_accy 91.64:   5%|▌         | 1/20 [00:50<07:56, 25.10s/it]
Task 6, Epoch 2/20 => Loss 0.415, Train_accy 91.64:  10%|█         | 2/20 [00:50<07:33, 25.19s/it]
Task 6, Epoch 3/20 => Loss 0.277, Train_accy 92.74:  10%|█         | 2/20 [01:15<07:33, 25.19s/it]
Task 6, Epoch 3/20 => Loss 0.277, Train_accy 92.74:  15%|█▌        | 3/20 [01:15<07:08, 25.22s/it]
Task 6, Epoch 4/20 => Loss 0.230, Train_accy 93.84:  15%|█▌        | 3/20 [01:40<07:08, 25.22s/it]
Task 6, Epoch 4/20 => Loss 0.230, Train_accy 93.84:  20%|██        | 4/20 [01:40<06:43, 25.22s/it]
Task 6, Epoch 5/20 => Loss 0.215, Train_accy 93.78:  20%|██        | 4/20 [02:06<06:43, 25.22s/it]
Task 6, Epoch 5/20 => Loss 0.215, Train_accy 93.78:  25%|██▌       | 5/20 [02:06<06:18, 25.21s/it]
Task 6, Epoch 6/20 => Loss 0.189, Train_accy 94.54:  25%|██▌       | 5/20 [02:31<06:18, 25.21s/it]
Task 6, Epoch 6/20 => Loss 0.189, Train_accy 94.54:  30%|███       | 6/20 [02:31<05:52, 25.20s/it]
Task 6, Epoch 7/20 => Loss 0.178, Train_accy 94.46:  30%|███       | 6/20 [02:56<05:52, 25.20s/it]
Task 6, Epoch 7/20 => Loss 0.178, Train_accy 94.46:  35%|███▌      | 7/20 [02:56<05:27, 25.16s/it]
Task 6, Epoch 8/20 => Loss 0.177, Train_accy 94.48:  35%|███▌      | 7/20 [03:21<05:27, 25.16s/it]
Task 6, Epoch 8/20 => Loss 0.177, Train_accy 94.48:  40%|████      | 8/20 [03:21<05:01, 25.15s/it]
Task 6, Epoch 9/20 => Loss 0.174, Train_accy 94.76:  40%|████      | 8/20 [03:46<05:01, 25.15s/it]
Task 6, Epoch 9/20 => Loss 0.174, Train_accy 94.76:  45%|████▌     | 9/20 [03:46<04:36, 25.17s/it]
Task 6, Epoch 10/20 => Loss 0.166, Train_accy 94.84:  45%|████▌     | 9/20 [04:11<04:36, 25.17s/it]
Task 6, Epoch 10/20 => Loss 0.166, Train_accy 94.84:  50%|█████     | 10/20 [04:11<04:11, 25.16s/it]
Task 6, Epoch 11/20 => Loss 0.158, Train_accy 95.36:  50%|█████     | 10/20 [04:36<04:11, 25.16s/it]
Task 6, Epoch 11/20 => Loss 0.158, Train_accy 95.36:  55%|█████▌    | 11/20 [04:36<03:46, 25.17s/it]
Task 6, Epoch 12/20 => Loss 0.163, Train_accy 95.04:  55%|█████▌    | 11/20 [05:02<03:46, 25.17s/it]
Task 6, Epoch 12/20 => Loss 0.163, Train_accy 95.04:  60%|██████    | 12/20 [05:02<03:21, 25.14s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 95.30:  60%|██████    | 12/20 [05:27<03:21, 25.14s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 95.30:  65%|██████▌   | 13/20 [05:27<02:55, 25.13s/it]
Task 6, Epoch 14/20 => Loss 0.167, Train_accy 94.92:  65%|██████▌   | 13/20 [05:52<02:55, 25.13s/it]
Task 6, Epoch 14/20 => Loss 0.167, Train_accy 94.92:  70%|███████   | 14/20 [05:52<02:30, 25.10s/it]
Task 6, Epoch 15/20 => Loss 0.161, Train_accy 95.28:  70%|███████   | 14/20 [06:17<02:30, 25.10s/it]
Task 6, Epoch 15/20 => Loss 0.161, Train_accy 95.28:  75%|███████▌  | 15/20 [06:17<02:05, 25.09s/it]
Task 6, Epoch 16/20 => Loss 0.160, Train_accy 95.18:  75%|███████▌  | 15/20 [06:42<02:05, 25.09s/it]
Task 6, Epoch 16/20 => Loss 0.160, Train_accy 95.18:  80%|████████  | 16/20 [06:42<01:40, 25.13s/it]
Task 6, Epoch 17/20 => Loss 0.167, Train_accy 94.72:  80%|████████  | 16/20 [07:07<01:40, 25.13s/it]
Task 6, Epoch 17/20 => Loss 0.167, Train_accy 94.72:  85%|████████▌ | 17/20 [07:07<01:15, 25.15s/it]
Task 6, Epoch 18/20 => Loss 0.138, Train_accy 96.10:  85%|████████▌ | 17/20 [07:32<01:15, 25.15s/it]
Task 6, Epoch 18/20 => Loss 0.138, Train_accy 96.10:  90%|█████████ | 18/20 [07:32<00:50, 25.17s/it]
Task 6, Epoch 19/20 => Loss 0.163, Train_accy 94.74:  90%|█████████ | 18/20 [07:57<00:50, 25.17s/it]
Task 6, Epoch 19/20 => Loss 0.163, Train_accy 94.74:  95%|█████████▌| 19/20 [07:57<00:25, 25.15s/it]
Task 6, Epoch 20/20 => Loss 0.165, Train_accy 95.22:  95%|█████████▌| 19/20 [08:23<00:25, 25.15s/it]
Task 6, Epoch 20/20 => Loss 0.165, Train_accy 95.22: 100%|██████████| 20/20 [08:23<00:00, 25.17s/it]
Task 6, Epoch 20/20 => Loss 0.165, Train_accy 95.22: 100%|██████████| 20/20 [08:23<00:00, 25.16s/it]
2024-09-04 13:48:51,965 [ease.py] => Task 6, Epoch 20/20 => Loss 0.165, Train_accy 95.22
2024-09-04 13:52:23,998 [ease.py] => Task correct: 91.61428571428571
2024-09-04 13:52:23,999 [ease.py] => Task acc: 98.87142857142857
2024-09-04 13:52:24,023 [trainer.py] => No NME accuracy.
2024-09-04 13:52:24,023 [trainer.py] => CNN: {'total': 91.19, '00-09': 89.1, '10-19': 87.8, '20-29': 94.9, '30-39': 89.2, '40-49': 93.3, '50-59': 90.4, '60-69': 93.6, 'old': 90.78, 'new': 93.6}
2024-09-04 13:52:24,023 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27, 94.0, 92.3, 91.48, 91.19]
2024-09-04 13:52:24,023 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63, 99.52, 99.44, 99.23, 99.3]

Average Accuracy (CNN): 94.28
2024-09-04 13:52:24,024 [trainer.py] => Average Accuracy (CNN): 94.28 

2024-09-04 13:52:24,024 [trainer.py] => All params: 86486978
2024-09-04 13:52:24,025 [trainer.py] => Trainable params: 304320
2024-09-04 13:52:24,030 [ease.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.644, Train_accy 73.22:   0%|          | 0/20 [00:25<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.644, Train_accy 73.22:   5%|▌         | 1/20 [00:25<07:59, 25.24s/it]
Task 7, Epoch 2/20 => Loss 0.509, Train_accy 87.88:   5%|▌         | 1/20 [00:50<07:59, 25.24s/it]
Task 7, Epoch 2/20 => Loss 0.509, Train_accy 87.88:  10%|█         | 2/20 [00:50<07:33, 25.21s/it]
Task 7, Epoch 3/20 => Loss 0.331, Train_accy 90.88:  10%|█         | 2/20 [01:15<07:33, 25.21s/it]
Task 7, Epoch 3/20 => Loss 0.331, Train_accy 90.88:  15%|█▌        | 3/20 [01:15<07:08, 25.20s/it]
Task 7, Epoch 4/20 => Loss 0.271, Train_accy 92.00:  15%|█▌        | 3/20 [01:40<07:08, 25.20s/it]
Task 7, Epoch 4/20 => Loss 0.271, Train_accy 92.00:  20%|██        | 4/20 [01:40<06:42, 25.18s/it]
Task 7, Epoch 5/20 => Loss 0.260, Train_accy 91.82:  20%|██        | 4/20 [02:05<06:42, 25.18s/it]
Task 7, Epoch 5/20 => Loss 0.260, Train_accy 91.82:  25%|██▌       | 5/20 [02:05<06:17, 25.16s/it]
Task 7, Epoch 6/20 => Loss 0.252, Train_accy 91.98:  25%|██▌       | 5/20 [02:31<06:17, 25.16s/it]
Task 7, Epoch 6/20 => Loss 0.252, Train_accy 91.98:  30%|███       | 6/20 [02:31<05:52, 25.15s/it]
Task 7, Epoch 7/20 => Loss 0.248, Train_accy 92.14:  30%|███       | 6/20 [02:56<05:52, 25.15s/it]
Task 7, Epoch 7/20 => Loss 0.248, Train_accy 92.14:  35%|███▌      | 7/20 [02:56<05:26, 25.12s/it]
Task 7, Epoch 8/20 => Loss 0.220, Train_accy 93.28:  35%|███▌      | 7/20 [03:21<05:26, 25.12s/it]
Task 7, Epoch 8/20 => Loss 0.220, Train_accy 93.28:  40%|████      | 8/20 [03:21<05:02, 25.17s/it]
Task 7, Epoch 9/20 => Loss 0.220, Train_accy 93.10:  40%|████      | 8/20 [03:46<05:02, 25.17s/it]
Task 7, Epoch 9/20 => Loss 0.220, Train_accy 93.10:  45%|████▌     | 9/20 [03:46<04:36, 25.15s/it]
Task 7, Epoch 10/20 => Loss 0.216, Train_accy 93.32:  45%|████▌     | 9/20 [04:11<04:36, 25.15s/it]
Task 7, Epoch 10/20 => Loss 0.216, Train_accy 93.32:  50%|█████     | 10/20 [04:11<04:11, 25.17s/it]
Task 7, Epoch 11/20 => Loss 0.205, Train_accy 93.66:  50%|█████     | 10/20 [04:36<04:11, 25.17s/it]
Task 7, Epoch 11/20 => Loss 0.205, Train_accy 93.66:  55%|█████▌    | 11/20 [04:36<03:46, 25.14s/it]
Task 7, Epoch 12/20 => Loss 0.208, Train_accy 93.36:  55%|█████▌    | 11/20 [05:01<03:46, 25.14s/it]
Task 7, Epoch 12/20 => Loss 0.208, Train_accy 93.36:  60%|██████    | 12/20 [05:01<03:21, 25.14s/it]
Task 7, Epoch 13/20 => Loss 0.213, Train_accy 92.96:  60%|██████    | 12/20 [05:27<03:21, 25.14s/it]
Task 7, Epoch 13/20 => Loss 0.213, Train_accy 92.96:  65%|██████▌   | 13/20 [05:27<02:56, 25.18s/it]
Task 7, Epoch 14/20 => Loss 0.195, Train_accy 93.72:  65%|██████▌   | 13/20 [05:52<02:56, 25.18s/it]
Task 7, Epoch 14/20 => Loss 0.195, Train_accy 93.72:  70%|███████   | 14/20 [05:52<02:31, 25.17s/it]
Task 7, Epoch 15/20 => Loss 0.200, Train_accy 93.34:  70%|███████   | 14/20 [06:17<02:31, 25.17s/it]
Task 7, Epoch 15/20 => Loss 0.200, Train_accy 93.34:  75%|███████▌  | 15/20 [06:17<02:05, 25.16s/it]
Task 7, Epoch 16/20 => Loss 0.202, Train_accy 93.60:  75%|███████▌  | 15/20 [06:42<02:05, 25.16s/it]
Task 7, Epoch 16/20 => Loss 0.202, Train_accy 93.60:  80%|████████  | 16/20 [06:42<01:40, 25.13s/it]
Task 7, Epoch 17/20 => Loss 0.203, Train_accy 93.42:  80%|████████  | 16/20 [07:07<01:40, 25.13s/it]
Task 7, Epoch 17/20 => Loss 0.203, Train_accy 93.42:  85%|████████▌ | 17/20 [07:07<01:15, 25.11s/it]
Task 7, Epoch 18/20 => Loss 0.197, Train_accy 93.50:  85%|████████▌ | 17/20 [07:32<01:15, 25.11s/it]
Task 7, Epoch 18/20 => Loss 0.197, Train_accy 93.50:  90%|█████████ | 18/20 [07:32<00:50, 25.10s/it]
Task 7, Epoch 19/20 => Loss 0.199, Train_accy 93.56:  90%|█████████ | 18/20 [07:57<00:50, 25.10s/it]
Task 7, Epoch 19/20 => Loss 0.199, Train_accy 93.56:  95%|█████████▌| 19/20 [07:57<00:25, 25.09s/it]
Task 7, Epoch 20/20 => Loss 0.199, Train_accy 93.50:  95%|█████████▌| 19/20 [08:22<00:25, 25.09s/it]
Task 7, Epoch 20/20 => Loss 0.199, Train_accy 93.50: 100%|██████████| 20/20 [08:22<00:00, 25.12s/it]
Task 7, Epoch 20/20 => Loss 0.199, Train_accy 93.50: 100%|██████████| 20/20 [08:22<00:00, 25.14s/it]
2024-09-04 14:00:46,966 [ease.py] => Task 7, Epoch 20/20 => Loss 0.199, Train_accy 93.50
2024-09-04 14:05:07,509 [ease.py] => Task correct: 89.65
2024-09-04 14:05:07,510 [ease.py] => Task acc: 98.7375
2024-09-04 14:05:07,535 [trainer.py] => No NME accuracy.
2024-09-04 14:05:07,535 [trainer.py] => CNN: {'total': 89.11, '00-09': 88.6, '10-19': 87.1, '20-29': 94.9, '30-39': 88.3, '40-49': 91.3, '50-59': 85.5, '60-69': 89.6, '70-79': 87.6, 'old': 89.33, 'new': 87.6}
2024-09-04 14:05:07,535 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27, 94.0, 92.3, 91.48, 91.19, 89.11]
2024-09-04 14:05:07,536 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63, 99.52, 99.44, 99.23, 99.3, 99.16]

Average Accuracy (CNN): 93.64
2024-09-04 14:05:07,536 [trainer.py] => Average Accuracy (CNN): 93.64 

2024-09-04 14:05:07,536 [trainer.py] => All params: 86602178
2024-09-04 14:05:07,537 [trainer.py] => Trainable params: 304320
2024-09-04 14:05:07,543 [ease.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.659, Train_accy 73.40:   0%|          | 0/20 [00:25<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.659, Train_accy 73.40:   5%|▌         | 1/20 [00:25<07:56, 25.08s/it]
Task 8, Epoch 2/20 => Loss 0.497, Train_accy 89.94:   5%|▌         | 1/20 [00:50<07:56, 25.08s/it]
Task 8, Epoch 2/20 => Loss 0.497, Train_accy 89.94:  10%|█         | 2/20 [00:50<07:30, 25.05s/it]
Task 8, Epoch 3/20 => Loss 0.334, Train_accy 90.78:  10%|█         | 2/20 [01:15<07:30, 25.05s/it]
Task 8, Epoch 3/20 => Loss 0.334, Train_accy 90.78:  15%|█▌        | 3/20 [01:15<07:05, 25.04s/it]
Task 8, Epoch 4/20 => Loss 0.280, Train_accy 92.34:  15%|█▌        | 3/20 [01:40<07:05, 25.04s/it]
Task 8, Epoch 4/20 => Loss 0.280, Train_accy 92.34:  20%|██        | 4/20 [01:40<06:40, 25.03s/it]
Task 8, Epoch 5/20 => Loss 0.257, Train_accy 92.18:  20%|██        | 4/20 [02:05<06:40, 25.03s/it]
Task 8, Epoch 5/20 => Loss 0.257, Train_accy 92.18:  25%|██▌       | 5/20 [02:05<06:15, 25.02s/it]
Task 8, Epoch 6/20 => Loss 0.249, Train_accy 92.70:  25%|██▌       | 5/20 [02:30<06:15, 25.02s/it]
Task 8, Epoch 6/20 => Loss 0.249, Train_accy 92.70:  30%|███       | 6/20 [02:30<05:50, 25.03s/it]
Task 8, Epoch 7/20 => Loss 0.238, Train_accy 92.54:  30%|███       | 6/20 [02:55<05:50, 25.03s/it]
Task 8, Epoch 7/20 => Loss 0.238, Train_accy 92.54:  35%|███▌      | 7/20 [02:55<05:25, 25.03s/it]
Task 8, Epoch 8/20 => Loss 0.218, Train_accy 93.46:  35%|███▌      | 7/20 [03:20<05:25, 25.03s/it]
Task 8, Epoch 8/20 => Loss 0.218, Train_accy 93.46:  40%|████      | 8/20 [03:20<05:00, 25.01s/it]
Task 8, Epoch 9/20 => Loss 0.212, Train_accy 93.24:  40%|████      | 8/20 [03:45<05:00, 25.01s/it]
Task 8, Epoch 9/20 => Loss 0.212, Train_accy 93.24:  45%|████▌     | 9/20 [03:45<04:35, 25.01s/it]
Task 8, Epoch 10/20 => Loss 0.205, Train_accy 93.50:  45%|████▌     | 9/20 [04:10<04:35, 25.01s/it]
Task 8, Epoch 10/20 => Loss 0.205, Train_accy 93.50:  50%|█████     | 10/20 [04:10<04:10, 25.02s/it]
Task 8, Epoch 11/20 => Loss 0.218, Train_accy 93.34:  50%|█████     | 10/20 [04:35<04:10, 25.02s/it]
Task 8, Epoch 11/20 => Loss 0.218, Train_accy 93.34:  55%|█████▌    | 11/20 [04:35<03:45, 25.05s/it]
Task 8, Epoch 12/20 => Loss 0.211, Train_accy 93.54:  55%|█████▌    | 11/20 [05:00<03:45, 25.05s/it]
Task 8, Epoch 12/20 => Loss 0.211, Train_accy 93.54:  60%|██████    | 12/20 [05:00<03:20, 25.06s/it]
Task 8, Epoch 13/20 => Loss 0.194, Train_accy 94.22:  60%|██████    | 12/20 [05:25<03:20, 25.06s/it]
Task 8, Epoch 13/20 => Loss 0.194, Train_accy 94.22:  65%|██████▌   | 13/20 [05:25<02:55, 25.08s/it]
Task 8, Epoch 14/20 => Loss 0.210, Train_accy 93.12:  65%|██████▌   | 13/20 [05:50<02:55, 25.08s/it]
Task 8, Epoch 14/20 => Loss 0.210, Train_accy 93.12:  70%|███████   | 14/20 [05:50<02:30, 25.09s/it]
Task 8, Epoch 15/20 => Loss 0.198, Train_accy 94.10:  70%|███████   | 14/20 [06:15<02:30, 25.09s/it]
Task 8, Epoch 15/20 => Loss 0.198, Train_accy 94.10:  75%|███████▌  | 15/20 [06:15<02:05, 25.11s/it]
Task 8, Epoch 16/20 => Loss 0.194, Train_accy 93.88:  75%|███████▌  | 15/20 [06:40<02:05, 25.11s/it]
Task 8, Epoch 16/20 => Loss 0.194, Train_accy 93.88:  80%|████████  | 16/20 [06:40<01:40, 25.09s/it]
Task 8, Epoch 17/20 => Loss 0.182, Train_accy 94.62:  80%|████████  | 16/20 [07:05<01:40, 25.09s/it]
Task 8, Epoch 17/20 => Loss 0.182, Train_accy 94.62:  85%|████████▌ | 17/20 [07:06<01:15, 25.09s/it]
Task 8, Epoch 18/20 => Loss 0.191, Train_accy 94.04:  85%|████████▌ | 17/20 [07:31<01:15, 25.09s/it]
Task 8, Epoch 18/20 => Loss 0.191, Train_accy 94.04:  90%|█████████ | 18/20 [07:31<00:50, 25.09s/it]
Task 8, Epoch 19/20 => Loss 0.172, Train_accy 94.54:  90%|█████████ | 18/20 [07:56<00:50, 25.09s/it]
Task 8, Epoch 19/20 => Loss 0.172, Train_accy 94.54:  95%|█████████▌| 19/20 [07:56<00:25, 25.12s/it]
Task 8, Epoch 20/20 => Loss 0.177, Train_accy 94.20:  95%|█████████▌| 19/20 [08:21<00:25, 25.12s/it]
Task 8, Epoch 20/20 => Loss 0.177, Train_accy 94.20: 100%|██████████| 20/20 [08:21<00:00, 25.13s/it]
Task 8, Epoch 20/20 => Loss 0.177, Train_accy 94.20: 100%|██████████| 20/20 [08:21<00:00, 25.07s/it]
2024-09-04 14:13:29,005 [ease.py] => Task 8, Epoch 20/20 => Loss 0.177, Train_accy 94.20
2024-09-04 14:18:45,085 [ease.py] => Task correct: 88.86666666666666
2024-09-04 14:18:45,086 [ease.py] => Task acc: 98.72222222222223
2024-09-04 14:18:45,109 [trainer.py] => No NME accuracy.
2024-09-04 14:18:45,110 [trainer.py] => CNN: {'total': 88.39, '00-09': 87.8, '10-19': 85.8, '20-29': 94.6, '30-39': 87.9, '40-49': 89.8, '50-59': 84.9, '60-69': 88.3, '70-79': 86.8, '80-89': 89.6, 'old': 88.24, 'new': 89.6}
2024-09-04 14:18:45,110 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27, 94.0, 92.3, 91.48, 91.19, 89.11, 88.39]
2024-09-04 14:18:45,110 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63, 99.52, 99.44, 99.23, 99.3, 99.16, 99.01]

Average Accuracy (CNN): 93.05
2024-09-04 14:18:45,110 [trainer.py] => Average Accuracy (CNN): 93.05 

2024-09-04 14:18:45,110 [trainer.py] => All params: 86732738
2024-09-04 14:18:45,111 [trainer.py] => Trainable params: 304320
2024-09-04 14:18:45,118 [ease.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.654, Train_accy 70.90:   0%|          | 0/20 [00:25<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.654, Train_accy 70.90:   5%|▌         | 1/20 [00:25<07:58, 25.16s/it]
Task 9, Epoch 2/20 => Loss 0.541, Train_accy 86.74:   5%|▌         | 1/20 [00:50<07:58, 25.16s/it]
Task 9, Epoch 2/20 => Loss 0.541, Train_accy 86.74:  10%|█         | 2/20 [00:50<07:31, 25.11s/it]
Task 9, Epoch 3/20 => Loss 0.361, Train_accy 89.78:  10%|█         | 2/20 [01:15<07:31, 25.11s/it]
Task 9, Epoch 3/20 => Loss 0.361, Train_accy 89.78:  15%|█▌        | 3/20 [01:15<07:07, 25.12s/it]
Task 9, Epoch 4/20 => Loss 0.290, Train_accy 91.50:  15%|█▌        | 3/20 [01:40<07:07, 25.12s/it]
Task 9, Epoch 4/20 => Loss 0.290, Train_accy 91.50:  20%|██        | 4/20 [01:40<06:41, 25.10s/it]
Task 9, Epoch 5/20 => Loss 0.284, Train_accy 91.30:  20%|██        | 4/20 [02:05<06:41, 25.10s/it]
Task 9, Epoch 5/20 => Loss 0.284, Train_accy 91.30:  25%|██▌       | 5/20 [02:05<06:16, 25.12s/it]
Task 9, Epoch 6/20 => Loss 0.263, Train_accy 91.80:  25%|██▌       | 5/20 [02:30<06:16, 25.12s/it]
Task 9, Epoch 6/20 => Loss 0.263, Train_accy 91.80:  30%|███       | 6/20 [02:30<05:52, 25.16s/it]
Task 9, Epoch 7/20 => Loss 0.260, Train_accy 91.94:  30%|███       | 6/20 [02:56<05:52, 25.16s/it]
Task 9, Epoch 7/20 => Loss 0.260, Train_accy 91.94:  35%|███▌      | 7/20 [02:56<05:27, 25.17s/it]
Task 9, Epoch 8/20 => Loss 0.252, Train_accy 92.10:  35%|███▌      | 7/20 [03:21<05:27, 25.17s/it]
Task 9, Epoch 8/20 => Loss 0.252, Train_accy 92.10:  40%|████      | 8/20 [03:21<05:02, 25.18s/it]
Task 9, Epoch 9/20 => Loss 0.260, Train_accy 91.64:  40%|████      | 8/20 [03:46<05:02, 25.18s/it]
Task 9, Epoch 9/20 => Loss 0.260, Train_accy 91.64:  45%|████▌     | 9/20 [03:46<04:36, 25.15s/it]
Task 9, Epoch 10/20 => Loss 0.232, Train_accy 92.74:  45%|████▌     | 9/20 [04:11<04:36, 25.15s/it]
Task 9, Epoch 10/20 => Loss 0.232, Train_accy 92.74:  50%|█████     | 10/20 [04:11<04:11, 25.19s/it]
Task 9, Epoch 11/20 => Loss 0.239, Train_accy 92.32:  50%|█████     | 10/20 [04:36<04:11, 25.19s/it]
Task 9, Epoch 11/20 => Loss 0.239, Train_accy 92.32:  55%|█████▌    | 11/20 [04:36<03:46, 25.18s/it]
Task 9, Epoch 12/20 => Loss 0.226, Train_accy 92.60:  55%|█████▌    | 11/20 [05:01<03:46, 25.18s/it]
Task 9, Epoch 12/20 => Loss 0.226, Train_accy 92.60:  60%|██████    | 12/20 [05:01<03:21, 25.13s/it]
Task 9, Epoch 13/20 => Loss 0.234, Train_accy 92.28:  60%|██████    | 12/20 [05:26<03:21, 25.13s/it]
Task 9, Epoch 13/20 => Loss 0.234, Train_accy 92.28:  65%|██████▌   | 13/20 [05:26<02:56, 25.15s/it]
Task 9, Epoch 14/20 => Loss 0.220, Train_accy 93.08:  65%|██████▌   | 13/20 [05:52<02:56, 25.15s/it]
Task 9, Epoch 14/20 => Loss 0.220, Train_accy 93.08:  70%|███████   | 14/20 [05:52<02:30, 25.15s/it]
Task 9, Epoch 15/20 => Loss 0.210, Train_accy 93.66:  70%|███████   | 14/20 [06:17<02:30, 25.15s/it]
Task 9, Epoch 15/20 => Loss 0.210, Train_accy 93.66:  75%|███████▌  | 15/20 [06:17<02:05, 25.15s/it]
Task 9, Epoch 16/20 => Loss 0.224, Train_accy 92.70:  75%|███████▌  | 15/20 [06:42<02:05, 25.15s/it]
Task 9, Epoch 16/20 => Loss 0.224, Train_accy 92.70:  80%|████████  | 16/20 [06:42<01:40, 25.14s/it]
Task 9, Epoch 17/20 => Loss 0.205, Train_accy 93.62:  80%|████████  | 16/20 [07:07<01:40, 25.14s/it]
Task 9, Epoch 17/20 => Loss 0.205, Train_accy 93.62:  85%|████████▌ | 17/20 [07:07<01:15, 25.15s/it]
Task 9, Epoch 18/20 => Loss 0.203, Train_accy 93.64:  85%|████████▌ | 17/20 [07:32<01:15, 25.15s/it]
Task 9, Epoch 18/20 => Loss 0.203, Train_accy 93.64:  90%|█████████ | 18/20 [07:32<00:50, 25.18s/it]
Task 9, Epoch 19/20 => Loss 0.202, Train_accy 93.70:  90%|█████████ | 18/20 [07:57<00:50, 25.18s/it]
Task 9, Epoch 19/20 => Loss 0.202, Train_accy 93.70:  95%|█████████▌| 19/20 [07:57<00:25, 25.18s/it]
Task 9, Epoch 20/20 => Loss 0.211, Train_accy 93.06:  95%|█████████▌| 19/20 [08:23<00:25, 25.18s/it]
Task 9, Epoch 20/20 => Loss 0.211, Train_accy 93.06: 100%|██████████| 20/20 [08:23<00:00, 25.17s/it]
Task 9, Epoch 20/20 => Loss 0.211, Train_accy 93.06: 100%|██████████| 20/20 [08:23<00:00, 25.16s/it]
2024-09-04 14:27:08,306 [ease.py] => Task 9, Epoch 20/20 => Loss 0.211, Train_accy 93.06
2024-09-04 14:33:22,659 [ease.py] => Task correct: 88.6
2024-09-04 14:33:22,659 [ease.py] => Task acc: 98.64
2024-09-04 14:33:22,687 [trainer.py] => No NME accuracy.
2024-09-04 14:33:22,687 [trainer.py] => CNN: {'total': 88.09, '00-09': 86.9, '10-19': 85.4, '20-29': 94.3, '30-39': 87.7, '40-49': 89.2, '50-59': 84.0, '60-69': 88.4, '70-79': 86.1, '80-89': 89.3, '90-99': 89.6, 'old': 87.92, 'new': 89.6}
2024-09-04 14:33:22,688 [trainer.py] => CNN top1 curve: [99.0, 96.75, 95.27, 94.0, 92.3, 91.48, 91.19, 89.11, 88.39, 88.09]
2024-09-04 14:33:22,688 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.63, 99.52, 99.44, 99.23, 99.3, 99.16, 99.01, 98.87]

Average Accuracy (CNN): 92.56
2024-09-04 14:33:22,688 [trainer.py] => Average Accuracy (CNN): 92.56 

Accuracy Matrix (CNN):
[[99.  97.2 93.8 92.3 91.4 90.4 89.1 88.6 87.8 86.9]
 [ 0.  96.3 94.3 92.8 89.3 89.  87.8 87.1 85.8 85.4]
 [ 0.   0.  97.7 97.1 95.7 95.  94.9 94.9 94.6 94.3]
 [ 0.   0.   0.  93.8 90.4 89.7 89.2 88.3 87.9 87.7]
 [ 0.   0.   0.   0.  94.7 93.5 93.3 91.3 89.8 89.2]
 [ 0.   0.   0.   0.   0.  91.3 90.4 85.5 84.9 84. ]
 [ 0.   0.   0.   0.   0.   0.  93.6 89.6 88.3 88.4]
 [ 0.   0.   0.   0.   0.   0.   0.  87.6 86.8 86.1]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  89.6 89.3]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  89.6]]
2024-09-04 14:33:22,689 [trainer.py] => Forgetting (CNN): 5.811111111111107
2024-09-04 14:33:25,365 [trainer.py] => config: ./exps/ease_cifar_B0_Inc20.json
2024-09-04 14:33:25,365 [trainer.py] => prefix:  
2024-09-04 14:33:25,365 [trainer.py] => dataset: cifar224
2024-09-04 14:33:25,365 [trainer.py] => memory_size: 0
2024-09-04 14:33:25,365 [trainer.py] => memory_per_class: 0
2024-09-04 14:33:25,365 [trainer.py] => fixed_memory: False
2024-09-04 14:33:25,365 [trainer.py] => shuffle: True
2024-09-04 14:33:25,365 [trainer.py] => init_cls: 5
2024-09-04 14:33:25,365 [trainer.py] => increment: 5
2024-09-04 14:33:25,365 [trainer.py] => model_name: ease
2024-09-04 14:33:25,365 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-04 14:33:25,366 [trainer.py] => device: [device(type='cuda', index=3)]
2024-09-04 14:33:25,366 [trainer.py] => seed: 1993
2024-09-04 14:33:25,366 [trainer.py] => init_epochs: 20
2024-09-04 14:33:25,366 [trainer.py] => init_lr: 0.025
2024-09-04 14:33:25,366 [trainer.py] => later_epochs: 20
2024-09-04 14:33:25,366 [trainer.py] => later_lr: 0.025
2024-09-04 14:33:25,366 [trainer.py] => batch_size: 48
2024-09-04 14:33:25,366 [trainer.py] => weight_decay: 0.0005
2024-09-04 14:33:25,366 [trainer.py] => min_lr: 0
2024-09-04 14:33:25,366 [trainer.py] => optimizer: sgd
2024-09-04 14:33:25,366 [trainer.py] => scheduler: cosine
2024-09-04 14:33:25,366 [trainer.py] => pretrained: True
2024-09-04 14:33:25,366 [trainer.py] => vpt_type: Deep
2024-09-04 14:33:25,366 [trainer.py] => prompt_token_num: 5
2024-09-04 14:33:25,366 [trainer.py] => ffn_num: 16
2024-09-04 14:33:25,366 [trainer.py] => use_diagonal: False
2024-09-04 14:33:25,366 [trainer.py] => recalc_sim: True
2024-09-04 14:33:25,366 [trainer.py] => alpha: 0.1
2024-09-04 14:33:25,366 [trainer.py] => use_init_ptm: False
2024-09-04 14:33:25,366 [trainer.py] => beta: 0
2024-09-04 14:33:25,366 [trainer.py] => use_old_data: False
2024-09-04 14:33:25,366 [trainer.py] => use_reweight: True
2024-09-04 14:33:25,366 [trainer.py] => moni_adam: False
2024-09-04 14:33:25,366 [trainer.py] => adapter_num: -1
2024-09-04 14:33:26,461 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-04 14:33:29,354 [trainer.py] => All params: 86102976
2024-09-04 14:33:29,355 [trainer.py] => Trainable params: 304320
2024-09-04 14:33:29,361 [ease.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.312, Train_accy 80.04:   0%|          | 0/20 [00:12<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.312, Train_accy 80.04:   5%|▌         | 1/20 [00:12<04:05, 12.91s/it]
Task 0, Epoch 2/20 => Loss 0.672, Train_accy 91.40:   5%|▌         | 1/20 [00:25<04:05, 12.91s/it]
Task 0, Epoch 2/20 => Loss 0.672, Train_accy 91.40:  10%|█         | 2/20 [00:25<03:49, 12.74s/it]
Task 0, Epoch 3/20 => Loss 0.360, Train_accy 93.16:  10%|█         | 2/20 [00:38<03:49, 12.74s/it]
Task 0, Epoch 3/20 => Loss 0.360, Train_accy 93.16:  15%|█▌        | 3/20 [00:38<03:36, 12.73s/it]
Task 0, Epoch 4/20 => Loss 0.243, Train_accy 94.44:  15%|█▌        | 3/20 [00:51<03:36, 12.73s/it]
Task 0, Epoch 4/20 => Loss 0.243, Train_accy 94.44:  20%|██        | 4/20 [00:51<03:24, 12.76s/it]
Task 0, Epoch 5/20 => Loss 0.203, Train_accy 94.48:  20%|██        | 4/20 [01:03<03:24, 12.76s/it]
Task 0, Epoch 5/20 => Loss 0.203, Train_accy 94.48:  25%|██▌       | 5/20 [01:03<03:11, 12.75s/it]
Task 0, Epoch 6/20 => Loss 0.170, Train_accy 95.32:  25%|██▌       | 5/20 [01:16<03:11, 12.75s/it]
Task 0, Epoch 6/20 => Loss 0.170, Train_accy 95.32:  30%|███       | 6/20 [01:16<02:58, 12.75s/it]
Task 0, Epoch 7/20 => Loss 0.153, Train_accy 96.40:  30%|███       | 6/20 [01:29<02:58, 12.75s/it]
Task 0, Epoch 7/20 => Loss 0.153, Train_accy 96.40:  35%|███▌      | 7/20 [01:29<02:46, 12.77s/it]
Task 0, Epoch 8/20 => Loss 0.150, Train_accy 95.52:  35%|███▌      | 7/20 [01:42<02:46, 12.77s/it]
Task 0, Epoch 8/20 => Loss 0.150, Train_accy 95.52:  40%|████      | 8/20 [01:42<02:33, 12.77s/it]
Task 0, Epoch 9/20 => Loss 0.137, Train_accy 95.68:  40%|████      | 8/20 [01:54<02:33, 12.77s/it]
Task 0, Epoch 9/20 => Loss 0.137, Train_accy 95.68:  45%|████▌     | 9/20 [01:54<02:20, 12.74s/it]
Task 0, Epoch 10/20 => Loss 0.128, Train_accy 96.24:  45%|████▌     | 9/20 [02:07<02:20, 12.74s/it]
Task 0, Epoch 10/20 => Loss 0.128, Train_accy 96.24:  50%|█████     | 10/20 [02:07<02:07, 12.74s/it]
Task 0, Epoch 11/20 => Loss 0.136, Train_accy 95.80:  50%|█████     | 10/20 [02:20<02:07, 12.74s/it]
Task 0, Epoch 11/20 => Loss 0.136, Train_accy 95.80:  55%|█████▌    | 11/20 [02:20<01:54, 12.75s/it]
Task 0, Epoch 12/20 => Loss 0.135, Train_accy 95.52:  55%|█████▌    | 11/20 [02:33<01:54, 12.75s/it]
Task 0, Epoch 12/20 => Loss 0.135, Train_accy 95.52:  60%|██████    | 12/20 [02:33<01:42, 12.75s/it]
Task 0, Epoch 13/20 => Loss 0.124, Train_accy 96.36:  60%|██████    | 12/20 [02:45<01:42, 12.75s/it]
Task 0, Epoch 13/20 => Loss 0.124, Train_accy 96.36:  65%|██████▌   | 13/20 [02:45<01:29, 12.75s/it]
Task 0, Epoch 14/20 => Loss 0.111, Train_accy 96.56:  65%|██████▌   | 13/20 [02:58<01:29, 12.75s/it]
Task 0, Epoch 14/20 => Loss 0.111, Train_accy 96.56:  70%|███████   | 14/20 [02:58<01:16, 12.76s/it]
Task 0, Epoch 15/20 => Loss 0.125, Train_accy 96.28:  70%|███████   | 14/20 [03:11<01:16, 12.76s/it]
Task 0, Epoch 15/20 => Loss 0.125, Train_accy 96.28:  75%|███████▌  | 15/20 [03:11<01:03, 12.75s/it]
Task 0, Epoch 16/20 => Loss 0.111, Train_accy 96.84:  75%|███████▌  | 15/20 [03:24<01:03, 12.75s/it]
Task 0, Epoch 16/20 => Loss 0.111, Train_accy 96.84:  80%|████████  | 16/20 [03:24<00:51, 12.76s/it]
Task 0, Epoch 17/20 => Loss 0.125, Train_accy 95.88:  80%|████████  | 16/20 [03:36<00:51, 12.76s/it]
Task 0, Epoch 17/20 => Loss 0.125, Train_accy 95.88:  85%|████████▌ | 17/20 [03:36<00:38, 12.78s/it]
Task 0, Epoch 18/20 => Loss 0.130, Train_accy 96.60:  85%|████████▌ | 17/20 [03:49<00:38, 12.78s/it]
Task 0, Epoch 18/20 => Loss 0.130, Train_accy 96.60:  90%|█████████ | 18/20 [03:49<00:25, 12.78s/it]
Task 0, Epoch 19/20 => Loss 0.128, Train_accy 96.28:  90%|█████████ | 18/20 [04:02<00:25, 12.78s/it]
Task 0, Epoch 19/20 => Loss 0.128, Train_accy 96.28:  95%|█████████▌| 19/20 [04:02<00:12, 12.77s/it]
Task 0, Epoch 20/20 => Loss 0.113, Train_accy 96.44:  95%|█████████▌| 19/20 [04:15<00:12, 12.77s/it]
Task 0, Epoch 20/20 => Loss 0.113, Train_accy 96.44: 100%|██████████| 20/20 [04:15<00:00, 12.77s/it]
Task 0, Epoch 20/20 => Loss 0.113, Train_accy 96.44: 100%|██████████| 20/20 [04:15<00:00, 12.76s/it]
2024-09-04 14:37:44,647 [ease.py] => Task 0, Epoch 20/20 => Loss 0.113, Train_accy 96.44
2024-09-04 14:37:53,240 [ease.py] => Task correct: 100.0
2024-09-04 14:37:53,240 [ease.py] => Task acc: 99.2
2024-09-04 14:37:53,265 [trainer.py] => No NME accuracy.
2024-09-04 14:37:53,265 [trainer.py] => CNN: {'total': 99.2, '00-04': 99.2, 'old': 0, 'new': 99.2}
2024-09-04 14:37:53,265 [trainer.py] => CNN top1 curve: [99.2]
2024-09-04 14:37:53,266 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.2
2024-09-04 14:37:53,266 [trainer.py] => Average Accuracy (CNN): 99.2 

2024-09-04 14:37:53,267 [trainer.py] => All params: 86110658
2024-09-04 14:37:53,267 [trainer.py] => Trainable params: 304320
2024-09-04 14:37:53,268 [ease.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.364, Train_accy 74.60:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.364, Train_accy 74.60:   5%|▌         | 1/20 [00:12<03:59, 12.63s/it]
Task 1, Epoch 2/20 => Loss 0.797, Train_accy 87.76:   5%|▌         | 1/20 [00:25<03:59, 12.63s/it]
Task 1, Epoch 2/20 => Loss 0.797, Train_accy 87.76:  10%|█         | 2/20 [00:25<03:47, 12.65s/it]
Task 1, Epoch 3/20 => Loss 0.451, Train_accy 90.40:  10%|█         | 2/20 [00:37<03:47, 12.65s/it]
Task 1, Epoch 3/20 => Loss 0.451, Train_accy 90.40:  15%|█▌        | 3/20 [00:37<03:35, 12.67s/it]
Task 1, Epoch 4/20 => Loss 0.301, Train_accy 91.92:  15%|█▌        | 3/20 [00:50<03:35, 12.67s/it]
Task 1, Epoch 4/20 => Loss 0.301, Train_accy 91.92:  20%|██        | 4/20 [00:50<03:22, 12.66s/it]
Task 1, Epoch 5/20 => Loss 0.253, Train_accy 92.80:  20%|██        | 4/20 [01:03<03:22, 12.66s/it]
Task 1, Epoch 5/20 => Loss 0.253, Train_accy 92.80:  25%|██▌       | 5/20 [01:03<03:10, 12.69s/it]
Task 1, Epoch 6/20 => Loss 0.218, Train_accy 94.04:  25%|██▌       | 5/20 [01:16<03:10, 12.69s/it]
Task 1, Epoch 6/20 => Loss 0.218, Train_accy 94.04:  30%|███       | 6/20 [01:16<02:57, 12.71s/it]
Task 1, Epoch 7/20 => Loss 0.192, Train_accy 94.00:  30%|███       | 6/20 [01:28<02:57, 12.71s/it]
Task 1, Epoch 7/20 => Loss 0.192, Train_accy 94.00:  35%|███▌      | 7/20 [01:28<02:45, 12.70s/it]
Task 1, Epoch 8/20 => Loss 0.198, Train_accy 93.84:  35%|███▌      | 7/20 [01:41<02:45, 12.70s/it]
Task 1, Epoch 8/20 => Loss 0.198, Train_accy 93.84:  40%|████      | 8/20 [01:41<02:32, 12.74s/it]
Task 1, Epoch 9/20 => Loss 0.183, Train_accy 93.68:  40%|████      | 8/20 [01:54<02:32, 12.74s/it]
Task 1, Epoch 9/20 => Loss 0.183, Train_accy 93.68:  45%|████▌     | 9/20 [01:54<02:20, 12.75s/it]
Task 1, Epoch 10/20 => Loss 0.171, Train_accy 94.64:  45%|████▌     | 9/20 [02:07<02:20, 12.75s/it]
Task 1, Epoch 10/20 => Loss 0.171, Train_accy 94.64:  50%|█████     | 10/20 [02:07<02:07, 12.75s/it]
Task 1, Epoch 11/20 => Loss 0.168, Train_accy 94.80:  50%|█████     | 10/20 [02:19<02:07, 12.75s/it]
Task 1, Epoch 11/20 => Loss 0.168, Train_accy 94.80:  55%|█████▌    | 11/20 [02:19<01:54, 12.76s/it]
Task 1, Epoch 12/20 => Loss 0.192, Train_accy 93.84:  55%|█████▌    | 11/20 [02:32<01:54, 12.76s/it]
Task 1, Epoch 12/20 => Loss 0.192, Train_accy 93.84:  60%|██████    | 12/20 [02:32<01:42, 12.78s/it]
Task 1, Epoch 13/20 => Loss 0.158, Train_accy 95.12:  60%|██████    | 12/20 [02:45<01:42, 12.78s/it]
Task 1, Epoch 13/20 => Loss 0.158, Train_accy 95.12:  65%|██████▌   | 13/20 [02:45<01:29, 12.76s/it]
Task 1, Epoch 14/20 => Loss 0.150, Train_accy 95.24:  65%|██████▌   | 13/20 [02:58<01:29, 12.76s/it]
Task 1, Epoch 14/20 => Loss 0.150, Train_accy 95.24:  70%|███████   | 14/20 [02:58<01:16, 12.76s/it]
Task 1, Epoch 15/20 => Loss 0.155, Train_accy 95.12:  70%|███████   | 14/20 [03:11<01:16, 12.76s/it]
Task 1, Epoch 15/20 => Loss 0.155, Train_accy 95.12:  75%|███████▌  | 15/20 [03:11<01:03, 12.76s/it]
Task 1, Epoch 16/20 => Loss 0.161, Train_accy 95.00:  75%|███████▌  | 15/20 [03:23<01:03, 12.76s/it]
Task 1, Epoch 16/20 => Loss 0.161, Train_accy 95.00:  80%|████████  | 16/20 [03:23<00:51, 12.78s/it]
Task 1, Epoch 17/20 => Loss 0.153, Train_accy 94.96:  80%|████████  | 16/20 [03:36<00:51, 12.78s/it]
Task 1, Epoch 17/20 => Loss 0.153, Train_accy 94.96:  85%|████████▌ | 17/20 [03:36<00:38, 12.77s/it]
Task 1, Epoch 18/20 => Loss 0.142, Train_accy 95.28:  85%|████████▌ | 17/20 [03:49<00:38, 12.77s/it]
Task 1, Epoch 18/20 => Loss 0.142, Train_accy 95.28:  90%|█████████ | 18/20 [03:49<00:25, 12.76s/it]
Task 1, Epoch 19/20 => Loss 0.159, Train_accy 94.52:  90%|█████████ | 18/20 [04:02<00:25, 12.76s/it]
Task 1, Epoch 19/20 => Loss 0.159, Train_accy 94.52:  95%|█████████▌| 19/20 [04:02<00:12, 12.75s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 94.84:  95%|█████████▌| 19/20 [04:14<00:12, 12.75s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 94.84: 100%|██████████| 20/20 [04:14<00:00, 12.75s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 94.84: 100%|██████████| 20/20 [04:14<00:00, 12.74s/it]
2024-09-04 14:42:08,081 [ease.py] => Task 1, Epoch 20/20 => Loss 0.154, Train_accy 94.84
2024-09-04 14:42:27,059 [ease.py] => Task correct: 99.1
2024-09-04 14:42:27,060 [ease.py] => Task acc: 99.0
2024-09-04 14:42:27,081 [trainer.py] => No NME accuracy.
2024-09-04 14:42:27,081 [trainer.py] => CNN: {'total': 98.2, '00-04': 98.2, '05-09': 98.2, 'old': 98.2, 'new': 98.2}
2024-09-04 14:42:27,081 [trainer.py] => CNN top1 curve: [99.2, 98.2]
2024-09-04 14:42:27,081 [trainer.py] => CNN top5 curve: [100.0, 99.9]

Average Accuracy (CNN): 98.7
2024-09-04 14:42:27,081 [trainer.py] => Average Accuracy (CNN): 98.7 

2024-09-04 14:42:27,082 [trainer.py] => All params: 86122178
2024-09-04 14:42:27,083 [trainer.py] => Trainable params: 304320
2024-09-04 14:42:27,084 [ease.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.325, Train_accy 74.88:   0%|          | 0/20 [00:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.325, Train_accy 74.88:   5%|▌         | 1/20 [00:12<04:02, 12.78s/it]
Task 2, Epoch 2/20 => Loss 0.738, Train_accy 87.40:   5%|▌         | 1/20 [00:25<04:02, 12.78s/it]
Task 2, Epoch 2/20 => Loss 0.738, Train_accy 87.40:  10%|█         | 2/20 [00:25<03:49, 12.74s/it]
Task 2, Epoch 3/20 => Loss 0.447, Train_accy 88.96:  10%|█         | 2/20 [00:38<03:49, 12.74s/it]
Task 2, Epoch 3/20 => Loss 0.447, Train_accy 88.96:  15%|█▌        | 3/20 [00:38<03:37, 12.78s/it]
Task 2, Epoch 4/20 => Loss 0.305, Train_accy 91.16:  15%|█▌        | 3/20 [00:51<03:37, 12.78s/it]
Task 2, Epoch 4/20 => Loss 0.305, Train_accy 91.16:  20%|██        | 4/20 [00:51<03:24, 12.77s/it]
Task 2, Epoch 5/20 => Loss 0.257, Train_accy 92.36:  20%|██        | 4/20 [01:03<03:24, 12.77s/it]
Task 2, Epoch 5/20 => Loss 0.257, Train_accy 92.36:  25%|██▌       | 5/20 [01:03<03:11, 12.77s/it]
Task 2, Epoch 6/20 => Loss 0.239, Train_accy 92.20:  25%|██▌       | 5/20 [01:16<03:11, 12.77s/it]
Task 2, Epoch 6/20 => Loss 0.239, Train_accy 92.20:  30%|███       | 6/20 [01:16<02:58, 12.73s/it]
Task 2, Epoch 7/20 => Loss 0.212, Train_accy 93.28:  30%|███       | 6/20 [01:29<02:58, 12.73s/it]
Task 2, Epoch 7/20 => Loss 0.212, Train_accy 93.28:  35%|███▌      | 7/20 [01:29<02:45, 12.72s/it]
Task 2, Epoch 8/20 => Loss 0.205, Train_accy 93.76:  35%|███▌      | 7/20 [01:41<02:45, 12.72s/it]
Task 2, Epoch 8/20 => Loss 0.205, Train_accy 93.76:  40%|████      | 8/20 [01:41<02:32, 12.73s/it]
Task 2, Epoch 9/20 => Loss 0.195, Train_accy 93.08:  40%|████      | 8/20 [01:54<02:32, 12.73s/it]
Task 2, Epoch 9/20 => Loss 0.195, Train_accy 93.08:  45%|████▌     | 9/20 [01:54<02:20, 12.75s/it]
Task 2, Epoch 10/20 => Loss 0.204, Train_accy 93.16:  45%|████▌     | 9/20 [02:07<02:20, 12.75s/it]
Task 2, Epoch 10/20 => Loss 0.204, Train_accy 93.16:  50%|█████     | 10/20 [02:07<02:07, 12.74s/it]
Task 2, Epoch 11/20 => Loss 0.211, Train_accy 93.60:  50%|█████     | 10/20 [02:20<02:07, 12.74s/it]
Task 2, Epoch 11/20 => Loss 0.211, Train_accy 93.60:  55%|█████▌    | 11/20 [02:20<01:54, 12.74s/it]
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 93.96:  55%|█████▌    | 11/20 [02:32<01:54, 12.74s/it]
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 93.96:  60%|██████    | 12/20 [02:32<01:41, 12.74s/it]
Task 2, Epoch 13/20 => Loss 0.174, Train_accy 94.16:  60%|██████    | 12/20 [02:45<01:41, 12.74s/it]
Task 2, Epoch 13/20 => Loss 0.174, Train_accy 94.16:  65%|██████▌   | 13/20 [02:45<01:29, 12.73s/it]
Task 2, Epoch 14/20 => Loss 0.181, Train_accy 93.64:  65%|██████▌   | 13/20 [02:58<01:29, 12.73s/it]
Task 2, Epoch 14/20 => Loss 0.181, Train_accy 93.64:  70%|███████   | 14/20 [02:58<01:16, 12.72s/it]
Task 2, Epoch 15/20 => Loss 0.167, Train_accy 94.44:  70%|███████   | 14/20 [03:11<01:16, 12.72s/it]
Task 2, Epoch 15/20 => Loss 0.167, Train_accy 94.44:  75%|███████▌  | 15/20 [03:11<01:03, 12.71s/it]
Task 2, Epoch 16/20 => Loss 0.161, Train_accy 94.64:  75%|███████▌  | 15/20 [03:23<01:03, 12.71s/it]
Task 2, Epoch 16/20 => Loss 0.161, Train_accy 94.64:  80%|████████  | 16/20 [03:23<00:50, 12.71s/it]
Task 2, Epoch 17/20 => Loss 0.164, Train_accy 94.88:  80%|████████  | 16/20 [03:36<00:50, 12.71s/it]
Task 2, Epoch 17/20 => Loss 0.164, Train_accy 94.88:  85%|████████▌ | 17/20 [03:36<00:38, 12.71s/it]
Task 2, Epoch 18/20 => Loss 0.175, Train_accy 94.36:  85%|████████▌ | 17/20 [03:49<00:38, 12.71s/it]
Task 2, Epoch 18/20 => Loss 0.175, Train_accy 94.36:  90%|█████████ | 18/20 [03:49<00:25, 12.71s/it]
Task 2, Epoch 19/20 => Loss 0.173, Train_accy 94.28:  90%|█████████ | 18/20 [04:01<00:25, 12.71s/it]
Task 2, Epoch 19/20 => Loss 0.173, Train_accy 94.28:  95%|█████████▌| 19/20 [04:01<00:12, 12.73s/it]
Task 2, Epoch 20/20 => Loss 0.168, Train_accy 94.76:  95%|█████████▌| 19/20 [04:14<00:12, 12.73s/it]
Task 2, Epoch 20/20 => Loss 0.168, Train_accy 94.76: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 2, Epoch 20/20 => Loss 0.168, Train_accy 94.76: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
2024-09-04 14:46:41,802 [ease.py] => Task 2, Epoch 20/20 => Loss 0.168, Train_accy 94.76
2024-09-04 14:47:13,729 [ease.py] => Task correct: 97.86666666666666
2024-09-04 14:47:13,730 [ease.py] => Task acc: 99.0
2024-09-04 14:47:13,758 [trainer.py] => No NME accuracy.
2024-09-04 14:47:13,758 [trainer.py] => CNN: {'total': 97.27, '00-04': 98.0, '05-09': 96.8, '10-14': 97.0, 'old': 97.4, 'new': 97.0}
2024-09-04 14:47:13,758 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27]
2024-09-04 14:47:13,758 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8]

Average Accuracy (CNN): 98.22
2024-09-04 14:47:13,758 [trainer.py] => Average Accuracy (CNN): 98.22 

2024-09-04 14:47:13,759 [trainer.py] => All params: 86141378
2024-09-04 14:47:13,760 [trainer.py] => Trainable params: 304320
2024-09-04 14:47:13,762 [ease.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.321, Train_accy 73.16:   0%|          | 0/20 [00:12<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.321, Train_accy 73.16:   5%|▌         | 1/20 [00:12<04:02, 12.77s/it]
Task 3, Epoch 2/20 => Loss 0.733, Train_accy 87.20:   5%|▌         | 1/20 [00:25<04:02, 12.77s/it]
Task 3, Epoch 2/20 => Loss 0.733, Train_accy 87.20:  10%|█         | 2/20 [00:25<03:49, 12.78s/it]
Task 3, Epoch 3/20 => Loss 0.414, Train_accy 91.16:  10%|█         | 2/20 [00:38<03:49, 12.78s/it]
Task 3, Epoch 3/20 => Loss 0.414, Train_accy 91.16:  15%|█▌        | 3/20 [00:38<03:36, 12.75s/it]
Task 3, Epoch 4/20 => Loss 0.276, Train_accy 92.32:  15%|█▌        | 3/20 [00:51<03:36, 12.75s/it]
Task 3, Epoch 4/20 => Loss 0.276, Train_accy 92.32:  20%|██        | 4/20 [00:51<03:24, 12.77s/it]
Task 3, Epoch 5/20 => Loss 0.241, Train_accy 92.64:  20%|██        | 4/20 [01:03<03:24, 12.77s/it]
Task 3, Epoch 5/20 => Loss 0.241, Train_accy 92.64:  25%|██▌       | 5/20 [01:03<03:11, 12.80s/it]
Task 3, Epoch 6/20 => Loss 0.203, Train_accy 93.72:  25%|██▌       | 5/20 [01:16<03:11, 12.80s/it]
Task 3, Epoch 6/20 => Loss 0.203, Train_accy 93.72:  30%|███       | 6/20 [01:16<02:58, 12.77s/it]
Task 3, Epoch 7/20 => Loss 0.208, Train_accy 92.88:  30%|███       | 6/20 [01:29<02:58, 12.77s/it]
Task 3, Epoch 7/20 => Loss 0.208, Train_accy 92.88:  35%|███▌      | 7/20 [01:29<02:45, 12.76s/it]
Task 3, Epoch 8/20 => Loss 0.188, Train_accy 94.04:  35%|███▌      | 7/20 [01:42<02:45, 12.76s/it]
Task 3, Epoch 8/20 => Loss 0.188, Train_accy 94.04:  40%|████      | 8/20 [01:42<02:32, 12.74s/it]
Task 3, Epoch 9/20 => Loss 0.192, Train_accy 93.60:  40%|████      | 8/20 [01:54<02:32, 12.74s/it]
Task 3, Epoch 9/20 => Loss 0.192, Train_accy 93.60:  45%|████▌     | 9/20 [01:54<02:20, 12.73s/it]
Task 3, Epoch 10/20 => Loss 0.181, Train_accy 93.76:  45%|████▌     | 9/20 [02:07<02:20, 12.73s/it]
Task 3, Epoch 10/20 => Loss 0.181, Train_accy 93.76:  50%|█████     | 10/20 [02:07<02:07, 12.73s/it]
Task 3, Epoch 11/20 => Loss 0.178, Train_accy 94.12:  50%|█████     | 10/20 [02:20<02:07, 12.73s/it]
Task 3, Epoch 11/20 => Loss 0.178, Train_accy 94.12:  55%|█████▌    | 11/20 [02:20<01:54, 12.74s/it]
Task 3, Epoch 12/20 => Loss 0.169, Train_accy 94.76:  55%|█████▌    | 11/20 [02:33<01:54, 12.74s/it]
Task 3, Epoch 12/20 => Loss 0.169, Train_accy 94.76:  60%|██████    | 12/20 [02:33<01:41, 12.74s/it]
Task 3, Epoch 13/20 => Loss 0.174, Train_accy 94.08:  60%|██████    | 12/20 [02:45<01:41, 12.74s/it]
Task 3, Epoch 13/20 => Loss 0.174, Train_accy 94.08:  65%|██████▌   | 13/20 [02:45<01:29, 12.72s/it]
Task 3, Epoch 14/20 => Loss 0.196, Train_accy 93.68:  65%|██████▌   | 13/20 [02:58<01:29, 12.72s/it]
Task 3, Epoch 14/20 => Loss 0.196, Train_accy 93.68:  70%|███████   | 14/20 [02:58<01:16, 12.73s/it]
Task 3, Epoch 15/20 => Loss 0.175, Train_accy 93.56:  70%|███████   | 14/20 [03:11<01:16, 12.73s/it]
Task 3, Epoch 15/20 => Loss 0.175, Train_accy 93.56:  75%|███████▌  | 15/20 [03:11<01:03, 12.73s/it]
Task 3, Epoch 16/20 => Loss 0.178, Train_accy 93.72:  75%|███████▌  | 15/20 [03:23<01:03, 12.73s/it]
Task 3, Epoch 16/20 => Loss 0.178, Train_accy 93.72:  80%|████████  | 16/20 [03:23<00:50, 12.73s/it]
Task 3, Epoch 17/20 => Loss 0.162, Train_accy 94.48:  80%|████████  | 16/20 [03:36<00:50, 12.73s/it]
Task 3, Epoch 17/20 => Loss 0.162, Train_accy 94.48:  85%|████████▌ | 17/20 [03:36<00:38, 12.73s/it]
Task 3, Epoch 18/20 => Loss 0.159, Train_accy 94.52:  85%|████████▌ | 17/20 [03:49<00:38, 12.73s/it]
Task 3, Epoch 18/20 => Loss 0.159, Train_accy 94.52:  90%|█████████ | 18/20 [03:49<00:25, 12.73s/it]
Task 3, Epoch 19/20 => Loss 0.184, Train_accy 93.60:  90%|█████████ | 18/20 [04:02<00:25, 12.73s/it]
Task 3, Epoch 19/20 => Loss 0.184, Train_accy 93.60:  95%|█████████▌| 19/20 [04:02<00:12, 12.72s/it]
Task 3, Epoch 20/20 => Loss 0.150, Train_accy 94.56:  95%|█████████▌| 19/20 [04:14<00:12, 12.72s/it]
Task 3, Epoch 20/20 => Loss 0.150, Train_accy 94.56: 100%|██████████| 20/20 [04:14<00:00, 12.75s/it]
Task 3, Epoch 20/20 => Loss 0.150, Train_accy 94.56: 100%|██████████| 20/20 [04:14<00:00, 12.74s/it]
2024-09-04 14:51:28,676 [ease.py] => Task 3, Epoch 20/20 => Loss 0.150, Train_accy 94.56
2024-09-04 14:52:15,559 [ease.py] => Task correct: 96.95
2024-09-04 14:52:15,560 [ease.py] => Task acc: 98.9
2024-09-04 14:52:15,584 [trainer.py] => No NME accuracy.
2024-09-04 14:52:15,584 [trainer.py] => CNN: {'total': 96.35, '00-04': 98.0, '05-09': 95.8, '10-14': 96.8, '15-19': 94.8, 'old': 96.87, 'new': 94.8}
2024-09-04 14:52:15,584 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35]
2024-09-04 14:52:15,584 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5]

Average Accuracy (CNN): 97.76
2024-09-04 14:52:15,584 [trainer.py] => Average Accuracy (CNN): 97.76 

2024-09-04 14:52:15,585 [trainer.py] => All params: 86168258
2024-09-04 14:52:15,585 [trainer.py] => Trainable params: 304320
2024-09-04 14:52:15,587 [ease.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.263, Train_accy 80.48:   0%|          | 0/20 [00:12<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.263, Train_accy 80.48:   5%|▌         | 1/20 [00:12<04:00, 12.65s/it]
Task 4, Epoch 2/20 => Loss 0.561, Train_accy 93.56:   5%|▌         | 1/20 [00:25<04:00, 12.65s/it]
Task 4, Epoch 2/20 => Loss 0.561, Train_accy 93.56:  10%|█         | 2/20 [00:25<03:48, 12.67s/it]
Task 4, Epoch 3/20 => Loss 0.287, Train_accy 93.40:  10%|█         | 2/20 [00:38<03:48, 12.67s/it]
Task 4, Epoch 3/20 => Loss 0.287, Train_accy 93.40:  15%|█▌        | 3/20 [00:38<03:36, 12.72s/it]
Task 4, Epoch 4/20 => Loss 0.184, Train_accy 95.92:  15%|█▌        | 3/20 [00:50<03:36, 12.72s/it]
Task 4, Epoch 4/20 => Loss 0.184, Train_accy 95.92:  20%|██        | 4/20 [00:50<03:23, 12.75s/it]
Task 4, Epoch 5/20 => Loss 0.144, Train_accy 95.76:  20%|██        | 4/20 [01:03<03:23, 12.75s/it]
Task 4, Epoch 5/20 => Loss 0.144, Train_accy 95.76:  25%|██▌       | 5/20 [01:03<03:10, 12.72s/it]
Task 4, Epoch 6/20 => Loss 0.143, Train_accy 95.72:  25%|██▌       | 5/20 [01:16<03:10, 12.72s/it]
Task 4, Epoch 6/20 => Loss 0.143, Train_accy 95.72:  30%|███       | 6/20 [01:16<02:58, 12.73s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 96.00:  30%|███       | 6/20 [01:29<02:58, 12.73s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 96.00:  35%|███▌      | 7/20 [01:29<02:45, 12.72s/it]
Task 4, Epoch 8/20 => Loss 0.128, Train_accy 96.08:  35%|███▌      | 7/20 [01:41<02:45, 12.72s/it]
Task 4, Epoch 8/20 => Loss 0.128, Train_accy 96.08:  40%|████      | 8/20 [01:41<02:32, 12.73s/it]
Task 4, Epoch 9/20 => Loss 0.109, Train_accy 96.76:  40%|████      | 8/20 [01:54<02:32, 12.73s/it]
Task 4, Epoch 9/20 => Loss 0.109, Train_accy 96.76:  45%|████▌     | 9/20 [01:54<02:19, 12.72s/it]
Task 4, Epoch 10/20 => Loss 0.095, Train_accy 96.96:  45%|████▌     | 9/20 [02:07<02:19, 12.72s/it]
Task 4, Epoch 10/20 => Loss 0.095, Train_accy 96.96:  50%|█████     | 10/20 [02:07<02:07, 12.73s/it]
Task 4, Epoch 11/20 => Loss 0.114, Train_accy 96.52:  50%|█████     | 10/20 [02:19<02:07, 12.73s/it]
Task 4, Epoch 11/20 => Loss 0.114, Train_accy 96.52:  55%|█████▌    | 11/20 [02:19<01:54, 12.74s/it]
Task 4, Epoch 12/20 => Loss 0.120, Train_accy 96.00:  55%|█████▌    | 11/20 [02:32<01:54, 12.74s/it]
Task 4, Epoch 12/20 => Loss 0.120, Train_accy 96.00:  60%|██████    | 12/20 [02:32<01:41, 12.73s/it]
Task 4, Epoch 13/20 => Loss 0.119, Train_accy 96.08:  60%|██████    | 12/20 [02:45<01:41, 12.73s/it]
Task 4, Epoch 13/20 => Loss 0.119, Train_accy 96.08:  65%|██████▌   | 13/20 [02:45<01:29, 12.72s/it]
Task 4, Epoch 14/20 => Loss 0.101, Train_accy 96.60:  65%|██████▌   | 13/20 [02:58<01:29, 12.72s/it]
Task 4, Epoch 14/20 => Loss 0.101, Train_accy 96.60:  70%|███████   | 14/20 [02:58<01:16, 12.73s/it]
Task 4, Epoch 15/20 => Loss 0.109, Train_accy 96.44:  70%|███████   | 14/20 [03:10<01:16, 12.73s/it]
Task 4, Epoch 15/20 => Loss 0.109, Train_accy 96.44:  75%|███████▌  | 15/20 [03:10<01:03, 12.73s/it]
Task 4, Epoch 16/20 => Loss 0.092, Train_accy 96.96:  75%|███████▌  | 15/20 [03:23<01:03, 12.73s/it]
Task 4, Epoch 16/20 => Loss 0.092, Train_accy 96.96:  80%|████████  | 16/20 [03:23<00:50, 12.73s/it]
Task 4, Epoch 17/20 => Loss 0.126, Train_accy 96.16:  80%|████████  | 16/20 [03:36<00:50, 12.73s/it]
Task 4, Epoch 17/20 => Loss 0.126, Train_accy 96.16:  85%|████████▌ | 17/20 [03:36<00:38, 12.72s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 96.88:  85%|████████▌ | 17/20 [03:49<00:38, 12.72s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 96.88:  90%|█████████ | 18/20 [03:49<00:25, 12.73s/it]
Task 4, Epoch 19/20 => Loss 0.102, Train_accy 96.72:  90%|█████████ | 18/20 [04:01<00:25, 12.73s/it]
Task 4, Epoch 19/20 => Loss 0.102, Train_accy 96.72:  95%|█████████▌| 19/20 [04:01<00:12, 12.72s/it]
Task 4, Epoch 20/20 => Loss 0.093, Train_accy 96.64:  95%|█████████▌| 19/20 [04:14<00:12, 12.72s/it]
Task 4, Epoch 20/20 => Loss 0.093, Train_accy 96.64: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 4, Epoch 20/20 => Loss 0.093, Train_accy 96.64: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
2024-09-04 14:56:30,175 [ease.py] => Task 4, Epoch 20/20 => Loss 0.093, Train_accy 96.64
2024-09-04 14:57:34,826 [ease.py] => Task correct: 96.72
2024-09-04 14:57:34,827 [ease.py] => Task acc: 99.12
2024-09-04 14:57:34,856 [trainer.py] => No NME accuracy.
2024-09-04 14:57:34,856 [trainer.py] => CNN: {'total': 96.28, '00-04': 98.0, '05-09': 95.2, '10-14': 95.2, '15-19': 94.8, '20-24': 98.2, 'old': 95.8, 'new': 98.2}
2024-09-04 14:57:34,856 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28]
2024-09-04 14:57:34,856 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44]

Average Accuracy (CNN): 97.46
2024-09-04 14:57:34,856 [trainer.py] => Average Accuracy (CNN): 97.46 

2024-09-04 14:57:34,857 [trainer.py] => All params: 86202818
2024-09-04 14:57:34,858 [trainer.py] => Trainable params: 304320
2024-09-04 14:57:34,861 [ease.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.263, Train_accy 80.16:   0%|          | 0/20 [00:12<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.263, Train_accy 80.16:   5%|▌         | 1/20 [00:12<04:00, 12.67s/it]
Task 5, Epoch 2/20 => Loss 0.548, Train_accy 94.24:   5%|▌         | 1/20 [00:25<04:00, 12.67s/it]
Task 5, Epoch 2/20 => Loss 0.548, Train_accy 94.24:  10%|█         | 2/20 [00:25<03:48, 12.69s/it]
Task 5, Epoch 3/20 => Loss 0.249, Train_accy 95.12:  10%|█         | 2/20 [00:38<03:48, 12.69s/it]
Task 5, Epoch 3/20 => Loss 0.249, Train_accy 95.12:  15%|█▌        | 3/20 [00:38<03:35, 12.70s/it]
Task 5, Epoch 4/20 => Loss 0.176, Train_accy 95.44:  15%|█▌        | 3/20 [00:50<03:35, 12.70s/it]
Task 5, Epoch 4/20 => Loss 0.176, Train_accy 95.44:  20%|██        | 4/20 [00:50<03:23, 12.71s/it]
Task 5, Epoch 5/20 => Loss 0.150, Train_accy 95.76:  20%|██        | 4/20 [01:03<03:23, 12.71s/it]
Task 5, Epoch 5/20 => Loss 0.150, Train_accy 95.76:  25%|██▌       | 5/20 [01:03<03:11, 12.74s/it]
Task 5, Epoch 6/20 => Loss 0.133, Train_accy 96.08:  25%|██▌       | 5/20 [01:16<03:11, 12.74s/it]
Task 5, Epoch 6/20 => Loss 0.133, Train_accy 96.08:  30%|███       | 6/20 [01:16<02:58, 12.74s/it]
Task 5, Epoch 7/20 => Loss 0.124, Train_accy 96.24:  30%|███       | 6/20 [01:29<02:58, 12.74s/it]
Task 5, Epoch 7/20 => Loss 0.124, Train_accy 96.24:  35%|███▌      | 7/20 [01:29<02:45, 12.73s/it]
Task 5, Epoch 8/20 => Loss 0.115, Train_accy 96.76:  35%|███▌      | 7/20 [01:41<02:45, 12.73s/it]
Task 5, Epoch 8/20 => Loss 0.115, Train_accy 96.76:  40%|████      | 8/20 [01:41<02:32, 12.73s/it]
Task 5, Epoch 9/20 => Loss 0.122, Train_accy 96.08:  40%|████      | 8/20 [01:54<02:32, 12.73s/it]
Task 5, Epoch 9/20 => Loss 0.122, Train_accy 96.08:  45%|████▌     | 9/20 [01:54<02:20, 12.74s/it]
Task 5, Epoch 10/20 => Loss 0.125, Train_accy 96.12:  45%|████▌     | 9/20 [02:07<02:20, 12.74s/it]
Task 5, Epoch 10/20 => Loss 0.125, Train_accy 96.12:  50%|█████     | 10/20 [02:07<02:07, 12.72s/it]
Task 5, Epoch 11/20 => Loss 0.125, Train_accy 95.96:  50%|█████     | 10/20 [02:19<02:07, 12.72s/it]
Task 5, Epoch 11/20 => Loss 0.125, Train_accy 95.96:  55%|█████▌    | 11/20 [02:19<01:54, 12.72s/it]
Task 5, Epoch 12/20 => Loss 0.117, Train_accy 96.32:  55%|█████▌    | 11/20 [02:32<01:54, 12.72s/it]
Task 5, Epoch 12/20 => Loss 0.117, Train_accy 96.32:  60%|██████    | 12/20 [02:32<01:41, 12.72s/it]
Task 5, Epoch 13/20 => Loss 0.103, Train_accy 96.44:  60%|██████    | 12/20 [02:45<01:41, 12.72s/it]
Task 5, Epoch 13/20 => Loss 0.103, Train_accy 96.44:  65%|██████▌   | 13/20 [02:45<01:28, 12.70s/it]
Task 5, Epoch 14/20 => Loss 0.103, Train_accy 97.16:  65%|██████▌   | 13/20 [02:57<01:28, 12.70s/it]
Task 5, Epoch 14/20 => Loss 0.103, Train_accy 97.16:  70%|███████   | 14/20 [02:57<01:16, 12.69s/it]
Task 5, Epoch 15/20 => Loss 0.097, Train_accy 96.84:  70%|███████   | 14/20 [03:10<01:16, 12.69s/it]
Task 5, Epoch 15/20 => Loss 0.097, Train_accy 96.84:  75%|███████▌  | 15/20 [03:10<01:03, 12.71s/it]
Task 5, Epoch 16/20 => Loss 0.102, Train_accy 96.68:  75%|███████▌  | 15/20 [03:23<01:03, 12.71s/it]
Task 5, Epoch 16/20 => Loss 0.102, Train_accy 96.68:  80%|████████  | 16/20 [03:23<00:50, 12.71s/it]
Task 5, Epoch 17/20 => Loss 0.097, Train_accy 96.84:  80%|████████  | 16/20 [03:36<00:50, 12.71s/it]
Task 5, Epoch 17/20 => Loss 0.097, Train_accy 96.84:  85%|████████▌ | 17/20 [03:36<00:38, 12.73s/it]
Task 5, Epoch 18/20 => Loss 0.103, Train_accy 96.56:  85%|████████▌ | 17/20 [03:48<00:38, 12.73s/it]
Task 5, Epoch 18/20 => Loss 0.103, Train_accy 96.56:  90%|█████████ | 18/20 [03:48<00:25, 12.73s/it]
Task 5, Epoch 19/20 => Loss 0.095, Train_accy 97.04:  90%|█████████ | 18/20 [04:01<00:25, 12.73s/it]
Task 5, Epoch 19/20 => Loss 0.095, Train_accy 97.04:  95%|█████████▌| 19/20 [04:01<00:12, 12.75s/it]
Task 5, Epoch 20/20 => Loss 0.094, Train_accy 96.56:  95%|█████████▌| 19/20 [04:14<00:12, 12.75s/it]
Task 5, Epoch 20/20 => Loss 0.094, Train_accy 96.56: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 5, Epoch 20/20 => Loss 0.094, Train_accy 96.56: 100%|██████████| 20/20 [04:14<00:00, 12.72s/it]
2024-09-04 15:01:49,326 [ease.py] => Task 5, Epoch 20/20 => Loss 0.094, Train_accy 96.56
2024-09-04 15:03:13,668 [ease.py] => Task correct: 95.3
2024-09-04 15:03:13,668 [ease.py] => Task acc: 99.2
2024-09-04 15:03:13,694 [trainer.py] => No NME accuracy.
2024-09-04 15:03:13,694 [trainer.py] => CNN: {'total': 94.93, '00-04': 97.0, '05-09': 90.0, '10-14': 94.0, '15-19': 93.4, '20-24': 98.2, '25-29': 97.0, 'old': 94.52, 'new': 97.0}
2024-09-04 15:03:13,694 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93]
2024-09-04 15:03:13,694 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47]

Average Accuracy (CNN): 97.04
2024-09-04 15:03:13,694 [trainer.py] => Average Accuracy (CNN): 97.04 

2024-09-04 15:03:13,695 [trainer.py] => All params: 86245058
2024-09-04 15:03:13,696 [trainer.py] => Trainable params: 304320
2024-09-04 15:03:13,698 [ease.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.295, Train_accy 72.00:   0%|          | 0/20 [00:12<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.295, Train_accy 72.00:   5%|▌         | 1/20 [00:12<04:00, 12.68s/it]
Task 6, Epoch 2/20 => Loss 0.713, Train_accy 85.28:   5%|▌         | 1/20 [00:25<04:00, 12.68s/it]
Task 6, Epoch 2/20 => Loss 0.713, Train_accy 85.28:  10%|█         | 2/20 [00:25<03:48, 12.71s/it]
Task 6, Epoch 3/20 => Loss 0.439, Train_accy 87.88:  10%|█         | 2/20 [00:38<03:48, 12.71s/it]
Task 6, Epoch 3/20 => Loss 0.439, Train_accy 87.88:  15%|█▌        | 3/20 [00:38<03:36, 12.75s/it]
Task 6, Epoch 4/20 => Loss 0.328, Train_accy 88.84:  15%|█▌        | 3/20 [00:50<03:36, 12.75s/it]
Task 6, Epoch 4/20 => Loss 0.328, Train_accy 88.84:  20%|██        | 4/20 [00:50<03:24, 12.76s/it]
Task 6, Epoch 5/20 => Loss 0.306, Train_accy 89.16:  20%|██        | 4/20 [01:03<03:24, 12.76s/it]
Task 6, Epoch 5/20 => Loss 0.306, Train_accy 89.16:  25%|██▌       | 5/20 [01:03<03:11, 12.74s/it]
Task 6, Epoch 6/20 => Loss 0.269, Train_accy 89.84:  25%|██▌       | 5/20 [01:16<03:11, 12.74s/it]
Task 6, Epoch 6/20 => Loss 0.269, Train_accy 89.84:  30%|███       | 6/20 [01:16<02:58, 12.75s/it]
Task 6, Epoch 7/20 => Loss 0.251, Train_accy 91.36:  30%|███       | 6/20 [01:29<02:58, 12.75s/it]
Task 6, Epoch 7/20 => Loss 0.251, Train_accy 91.36:  35%|███▌      | 7/20 [01:29<02:45, 12.75s/it]
Task 6, Epoch 8/20 => Loss 0.231, Train_accy 91.56:  35%|███▌      | 7/20 [01:41<02:45, 12.75s/it]
Task 6, Epoch 8/20 => Loss 0.231, Train_accy 91.56:  40%|████      | 8/20 [01:41<02:32, 12.74s/it]
Task 6, Epoch 9/20 => Loss 0.243, Train_accy 91.16:  40%|████      | 8/20 [01:54<02:32, 12.74s/it]
Task 6, Epoch 9/20 => Loss 0.243, Train_accy 91.16:  45%|████▌     | 9/20 [01:54<02:20, 12.74s/it]
Task 6, Epoch 10/20 => Loss 0.226, Train_accy 92.00:  45%|████▌     | 9/20 [02:07<02:20, 12.74s/it]
Task 6, Epoch 10/20 => Loss 0.226, Train_accy 92.00:  50%|█████     | 10/20 [02:07<02:07, 12.73s/it]
Task 6, Epoch 11/20 => Loss 0.236, Train_accy 91.12:  50%|█████     | 10/20 [02:20<02:07, 12.73s/it]
Task 6, Epoch 11/20 => Loss 0.236, Train_accy 91.12:  55%|█████▌    | 11/20 [02:20<01:54, 12.72s/it]
Task 6, Epoch 12/20 => Loss 0.213, Train_accy 91.48:  55%|█████▌    | 11/20 [02:32<01:54, 12.72s/it]
Task 6, Epoch 12/20 => Loss 0.213, Train_accy 91.48:  60%|██████    | 12/20 [02:32<01:41, 12.71s/it]
Task 6, Epoch 13/20 => Loss 0.215, Train_accy 91.84:  60%|██████    | 12/20 [02:45<01:41, 12.71s/it]
Task 6, Epoch 13/20 => Loss 0.215, Train_accy 91.84:  65%|██████▌   | 13/20 [02:45<01:28, 12.71s/it]
Task 6, Epoch 14/20 => Loss 0.206, Train_accy 91.92:  65%|██████▌   | 13/20 [02:58<01:28, 12.71s/it]
Task 6, Epoch 14/20 => Loss 0.206, Train_accy 91.92:  70%|███████   | 14/20 [02:58<01:16, 12.71s/it]
Task 6, Epoch 15/20 => Loss 0.206, Train_accy 92.36:  70%|███████   | 14/20 [03:10<01:16, 12.71s/it]
Task 6, Epoch 15/20 => Loss 0.206, Train_accy 92.36:  75%|███████▌  | 15/20 [03:10<01:03, 12.71s/it]
Task 6, Epoch 16/20 => Loss 0.208, Train_accy 91.96:  75%|███████▌  | 15/20 [03:23<01:03, 12.71s/it]
Task 6, Epoch 16/20 => Loss 0.208, Train_accy 91.96:  80%|████████  | 16/20 [03:23<00:50, 12.71s/it]
Task 6, Epoch 17/20 => Loss 0.207, Train_accy 92.56:  80%|████████  | 16/20 [03:36<00:50, 12.71s/it]
Task 6, Epoch 17/20 => Loss 0.207, Train_accy 92.56:  85%|████████▌ | 17/20 [03:36<00:38, 12.73s/it]
Task 6, Epoch 18/20 => Loss 0.195, Train_accy 93.44:  85%|████████▌ | 17/20 [03:49<00:38, 12.73s/it]
Task 6, Epoch 18/20 => Loss 0.195, Train_accy 93.44:  90%|█████████ | 18/20 [03:49<00:25, 12.73s/it]
Task 6, Epoch 19/20 => Loss 0.201, Train_accy 92.88:  90%|█████████ | 18/20 [04:01<00:25, 12.73s/it]
Task 6, Epoch 19/20 => Loss 0.201, Train_accy 92.88:  95%|█████████▌| 19/20 [04:01<00:12, 12.72s/it]
Task 6, Epoch 20/20 => Loss 0.201, Train_accy 92.68:  95%|█████████▌| 19/20 [04:14<00:12, 12.72s/it]
Task 6, Epoch 20/20 => Loss 0.201, Train_accy 92.68: 100%|██████████| 20/20 [04:14<00:00, 12.71s/it]
Task 6, Epoch 20/20 => Loss 0.201, Train_accy 92.68: 100%|██████████| 20/20 [04:14<00:00, 12.72s/it]
2024-09-04 15:07:28,226 [ease.py] => Task 6, Epoch 20/20 => Loss 0.201, Train_accy 92.68
2024-09-04 15:09:14,884 [ease.py] => Task correct: 94.11428571428571
2024-09-04 15:09:14,885 [ease.py] => Task acc: 98.97142857142858
2024-09-04 15:09:14,904 [trainer.py] => No NME accuracy.
2024-09-04 15:09:14,904 [trainer.py] => CNN: {'total': 93.6, '00-04': 97.0, '05-09': 89.8, '10-14': 94.0, '15-19': 91.6, '20-24': 98.0, '25-29': 97.0, '30-34': 87.8, 'old': 94.57, 'new': 87.8}
2024-09-04 15:09:14,904 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6]
2024-09-04 15:09:14,904 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46]

Average Accuracy (CNN): 96.55
2024-09-04 15:09:14,904 [trainer.py] => Average Accuracy (CNN): 96.55 

2024-09-04 15:09:14,905 [trainer.py] => All params: 86294978
2024-09-04 15:09:14,906 [trainer.py] => Trainable params: 304320
2024-09-04 15:09:14,908 [ease.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.274, Train_accy 82.24:   0%|          | 0/20 [00:12<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.274, Train_accy 82.24:   5%|▌         | 1/20 [00:12<04:01, 12.72s/it]
Task 7, Epoch 2/20 => Loss 0.602, Train_accy 93.48:   5%|▌         | 1/20 [00:25<04:01, 12.72s/it]
Task 7, Epoch 2/20 => Loss 0.602, Train_accy 93.48:  10%|█         | 2/20 [00:25<03:49, 12.73s/it]
Task 7, Epoch 3/20 => Loss 0.319, Train_accy 93.40:  10%|█         | 2/20 [00:38<03:49, 12.73s/it]
Task 7, Epoch 3/20 => Loss 0.319, Train_accy 93.40:  15%|█▌        | 3/20 [00:38<03:36, 12.75s/it]
Task 7, Epoch 4/20 => Loss 0.205, Train_accy 94.96:  15%|█▌        | 3/20 [00:50<03:36, 12.75s/it]
Task 7, Epoch 4/20 => Loss 0.205, Train_accy 94.96:  20%|██        | 4/20 [00:50<03:23, 12.74s/it]
Task 7, Epoch 5/20 => Loss 0.164, Train_accy 95.32:  20%|██        | 4/20 [01:03<03:23, 12.74s/it]
Task 7, Epoch 5/20 => Loss 0.164, Train_accy 95.32:  25%|██▌       | 5/20 [01:03<03:10, 12.72s/it]
Task 7, Epoch 6/20 => Loss 0.153, Train_accy 95.84:  25%|██▌       | 5/20 [01:16<03:10, 12.72s/it]
Task 7, Epoch 6/20 => Loss 0.153, Train_accy 95.84:  30%|███       | 6/20 [01:16<02:57, 12.71s/it]
Task 7, Epoch 7/20 => Loss 0.156, Train_accy 95.16:  30%|███       | 6/20 [01:29<02:57, 12.71s/it]
Task 7, Epoch 7/20 => Loss 0.156, Train_accy 95.16:  35%|███▌      | 7/20 [01:29<02:45, 12.73s/it]
Task 7, Epoch 8/20 => Loss 0.152, Train_accy 95.92:  35%|███▌      | 7/20 [01:41<02:45, 12.73s/it]
Task 7, Epoch 8/20 => Loss 0.152, Train_accy 95.92:  40%|████      | 8/20 [01:41<02:32, 12.74s/it]
Task 7, Epoch 9/20 => Loss 0.135, Train_accy 95.32:  40%|████      | 8/20 [01:54<02:32, 12.74s/it]
Task 7, Epoch 9/20 => Loss 0.135, Train_accy 95.32:  45%|████▌     | 9/20 [01:54<02:20, 12.73s/it]
Task 7, Epoch 10/20 => Loss 0.115, Train_accy 96.56:  45%|████▌     | 9/20 [02:07<02:20, 12.73s/it]
Task 7, Epoch 10/20 => Loss 0.115, Train_accy 96.56:  50%|█████     | 10/20 [02:07<02:07, 12.71s/it]
Task 7, Epoch 11/20 => Loss 0.139, Train_accy 95.56:  50%|█████     | 10/20 [02:19<02:07, 12.71s/it]
Task 7, Epoch 11/20 => Loss 0.139, Train_accy 95.56:  55%|█████▌    | 11/20 [02:19<01:54, 12.71s/it]
Task 7, Epoch 12/20 => Loss 0.119, Train_accy 96.16:  55%|█████▌    | 11/20 [02:32<01:54, 12.71s/it]
Task 7, Epoch 12/20 => Loss 0.119, Train_accy 96.16:  60%|██████    | 12/20 [02:32<01:41, 12.73s/it]
Task 7, Epoch 13/20 => Loss 0.112, Train_accy 97.04:  60%|██████    | 12/20 [02:45<01:41, 12.73s/it]
Task 7, Epoch 13/20 => Loss 0.112, Train_accy 97.04:  65%|██████▌   | 13/20 [02:45<01:29, 12.72s/it]
Task 7, Epoch 14/20 => Loss 0.120, Train_accy 96.16:  65%|██████▌   | 13/20 [02:58<01:29, 12.72s/it]
Task 7, Epoch 14/20 => Loss 0.120, Train_accy 96.16:  70%|███████   | 14/20 [02:58<01:16, 12.72s/it]
Task 7, Epoch 15/20 => Loss 0.112, Train_accy 96.76:  70%|███████   | 14/20 [03:10<01:16, 12.72s/it]
Task 7, Epoch 15/20 => Loss 0.112, Train_accy 96.76:  75%|███████▌  | 15/20 [03:10<01:03, 12.72s/it]
Task 7, Epoch 16/20 => Loss 0.106, Train_accy 96.60:  75%|███████▌  | 15/20 [03:23<01:03, 12.72s/it]
Task 7, Epoch 16/20 => Loss 0.106, Train_accy 96.60:  80%|████████  | 16/20 [03:23<00:50, 12.71s/it]
Task 7, Epoch 17/20 => Loss 0.116, Train_accy 96.24:  80%|████████  | 16/20 [03:36<00:50, 12.71s/it]
Task 7, Epoch 17/20 => Loss 0.116, Train_accy 96.24:  85%|████████▌ | 17/20 [03:36<00:38, 12.74s/it]
Task 7, Epoch 18/20 => Loss 0.116, Train_accy 96.36:  85%|████████▌ | 17/20 [03:49<00:38, 12.74s/it]
Task 7, Epoch 18/20 => Loss 0.116, Train_accy 96.36:  90%|█████████ | 18/20 [03:49<00:25, 12.73s/it]
Task 7, Epoch 19/20 => Loss 0.117, Train_accy 96.32:  90%|█████████ | 18/20 [04:01<00:25, 12.73s/it]
Task 7, Epoch 19/20 => Loss 0.117, Train_accy 96.32:  95%|█████████▌| 19/20 [04:01<00:12, 12.73s/it]
Task 7, Epoch 20/20 => Loss 0.105, Train_accy 96.88:  95%|█████████▌| 19/20 [04:14<00:12, 12.73s/it]
Task 7, Epoch 20/20 => Loss 0.105, Train_accy 96.88: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 7, Epoch 20/20 => Loss 0.105, Train_accy 96.88: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
2024-09-04 15:13:29,440 [ease.py] => Task 7, Epoch 20/20 => Loss 0.105, Train_accy 96.88
2024-09-04 15:15:40,959 [ease.py] => Task correct: 93.55
2024-09-04 15:15:40,959 [ease.py] => Task acc: 99.025
2024-09-04 15:15:40,982 [trainer.py] => No NME accuracy.
2024-09-04 15:15:40,982 [trainer.py] => CNN: {'total': 93.15, '00-04': 94.0, '05-09': 89.4, '10-14': 93.2, '15-19': 91.0, '20-24': 97.6, '25-29': 96.4, '30-34': 87.6, '35-39': 96.0, 'old': 92.74, 'new': 96.0}
2024-09-04 15:15:40,982 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15]
2024-09-04 15:15:40,982 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25]

Average Accuracy (CNN): 96.12
2024-09-04 15:15:40,982 [trainer.py] => Average Accuracy (CNN): 96.12 

2024-09-04 15:15:40,983 [trainer.py] => All params: 86352578
2024-09-04 15:15:40,984 [trainer.py] => Trainable params: 304320
2024-09-04 15:15:40,988 [ease.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.321, Train_accy 75.28:   0%|          | 0/20 [00:12<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.321, Train_accy 75.28:   5%|▌         | 1/20 [00:12<04:00, 12.64s/it]
Task 8, Epoch 2/20 => Loss 0.686, Train_accy 91.08:   5%|▌         | 1/20 [00:25<04:00, 12.64s/it]
Task 8, Epoch 2/20 => Loss 0.686, Train_accy 91.08:  10%|█         | 2/20 [00:25<03:47, 12.63s/it]
Task 8, Epoch 3/20 => Loss 0.352, Train_accy 92.96:  10%|█         | 2/20 [00:37<03:47, 12.63s/it]
Task 8, Epoch 3/20 => Loss 0.352, Train_accy 92.96:  15%|█▌        | 3/20 [00:37<03:34, 12.63s/it]
Task 8, Epoch 4/20 => Loss 0.245, Train_accy 93.60:  15%|█▌        | 3/20 [00:50<03:34, 12.63s/it]
Task 8, Epoch 4/20 => Loss 0.245, Train_accy 93.60:  20%|██        | 4/20 [00:50<03:22, 12.64s/it]
Task 8, Epoch 5/20 => Loss 0.207, Train_accy 94.24:  20%|██        | 4/20 [01:03<03:22, 12.64s/it]
Task 8, Epoch 5/20 => Loss 0.207, Train_accy 94.24:  25%|██▌       | 5/20 [01:03<03:09, 12.67s/it]
Task 8, Epoch 6/20 => Loss 0.190, Train_accy 94.80:  25%|██▌       | 5/20 [01:15<03:09, 12.67s/it]
Task 8, Epoch 6/20 => Loss 0.190, Train_accy 94.80:  30%|███       | 6/20 [01:15<02:57, 12.69s/it]
Task 8, Epoch 7/20 => Loss 0.168, Train_accy 95.20:  30%|███       | 6/20 [01:28<02:57, 12.69s/it]
Task 8, Epoch 7/20 => Loss 0.168, Train_accy 95.20:  35%|███▌      | 7/20 [01:28<02:45, 12.72s/it]
Task 8, Epoch 8/20 => Loss 0.163, Train_accy 95.24:  35%|███▌      | 7/20 [01:41<02:45, 12.72s/it]
Task 8, Epoch 8/20 => Loss 0.163, Train_accy 95.24:  40%|████      | 8/20 [01:41<02:32, 12.73s/it]
Task 8, Epoch 9/20 => Loss 0.154, Train_accy 95.52:  40%|████      | 8/20 [01:54<02:32, 12.73s/it]
Task 8, Epoch 9/20 => Loss 0.154, Train_accy 95.52:  45%|████▌     | 9/20 [01:54<02:19, 12.72s/it]
Task 8, Epoch 10/20 => Loss 0.144, Train_accy 95.44:  45%|████▌     | 9/20 [02:06<02:19, 12.72s/it]
Task 8, Epoch 10/20 => Loss 0.144, Train_accy 95.44:  50%|█████     | 10/20 [02:06<02:07, 12.72s/it]
Task 8, Epoch 11/20 => Loss 0.151, Train_accy 95.08:  50%|█████     | 10/20 [02:19<02:07, 12.72s/it]
Task 8, Epoch 11/20 => Loss 0.151, Train_accy 95.08:  55%|█████▌    | 11/20 [02:19<01:54, 12.72s/it]
Task 8, Epoch 12/20 => Loss 0.130, Train_accy 96.24:  55%|█████▌    | 11/20 [02:32<01:54, 12.72s/it]
Task 8, Epoch 12/20 => Loss 0.130, Train_accy 96.24:  60%|██████    | 12/20 [02:32<01:41, 12.72s/it]
Task 8, Epoch 13/20 => Loss 0.135, Train_accy 95.76:  60%|██████    | 12/20 [02:45<01:41, 12.72s/it]
Task 8, Epoch 13/20 => Loss 0.135, Train_accy 95.76:  65%|██████▌   | 13/20 [02:45<01:29, 12.72s/it]
Task 8, Epoch 14/20 => Loss 0.135, Train_accy 95.76:  65%|██████▌   | 13/20 [02:57<01:29, 12.72s/it]
Task 8, Epoch 14/20 => Loss 0.135, Train_accy 95.76:  70%|███████   | 14/20 [02:57<01:16, 12.72s/it]
Task 8, Epoch 15/20 => Loss 0.143, Train_accy 95.60:  70%|███████   | 14/20 [03:10<01:16, 12.72s/it]
Task 8, Epoch 15/20 => Loss 0.143, Train_accy 95.60:  75%|███████▌  | 15/20 [03:10<01:03, 12.72s/it]
Task 8, Epoch 16/20 => Loss 0.129, Train_accy 95.72:  75%|███████▌  | 15/20 [03:23<01:03, 12.72s/it]
Task 8, Epoch 16/20 => Loss 0.129, Train_accy 95.72:  80%|████████  | 16/20 [03:23<00:50, 12.73s/it]
Task 8, Epoch 17/20 => Loss 0.136, Train_accy 95.52:  80%|████████  | 16/20 [03:36<00:50, 12.73s/it]
Task 8, Epoch 17/20 => Loss 0.136, Train_accy 95.52:  85%|████████▌ | 17/20 [03:36<00:38, 12.72s/it]
Task 8, Epoch 18/20 => Loss 0.128, Train_accy 95.56:  85%|████████▌ | 17/20 [03:48<00:38, 12.72s/it]
Task 8, Epoch 18/20 => Loss 0.128, Train_accy 95.56:  90%|█████████ | 18/20 [03:48<00:25, 12.73s/it]
Task 8, Epoch 19/20 => Loss 0.142, Train_accy 95.40:  90%|█████████ | 18/20 [04:01<00:25, 12.73s/it]
Task 8, Epoch 19/20 => Loss 0.142, Train_accy 95.40:  95%|█████████▌| 19/20 [04:01<00:12, 12.72s/it]
Task 8, Epoch 20/20 => Loss 0.129, Train_accy 96.20:  95%|█████████▌| 19/20 [04:14<00:12, 12.72s/it]
Task 8, Epoch 20/20 => Loss 0.129, Train_accy 96.20: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 8, Epoch 20/20 => Loss 0.129, Train_accy 96.20: 100%|██████████| 20/20 [04:14<00:00, 12.71s/it]
2024-09-04 15:19:55,214 [ease.py] => Task 8, Epoch 20/20 => Loss 0.129, Train_accy 96.20
2024-09-04 15:22:34,165 [ease.py] => Task correct: 92.71111111111111
2024-09-04 15:22:34,166 [ease.py] => Task acc: 99.08888888888889
2024-09-04 15:22:34,190 [trainer.py] => No NME accuracy.
2024-09-04 15:22:34,190 [trainer.py] => CNN: {'total': 92.38, '00-04': 92.2, '05-09': 89.6, '10-14': 88.2, '15-19': 90.4, '20-24': 97.6, '25-29': 96.4, '30-34': 86.8, '35-39': 95.4, '40-44': 94.8, 'old': 92.08, 'new': 94.8}
2024-09-04 15:22:34,190 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38]
2024-09-04 15:22:34,190 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13]

Average Accuracy (CNN): 95.71
2024-09-04 15:22:34,190 [trainer.py] => Average Accuracy (CNN): 95.71 

2024-09-04 15:22:34,191 [trainer.py] => All params: 86417858
2024-09-04 15:22:34,191 [trainer.py] => Trainable params: 304320
2024-09-04 15:22:34,195 [ease.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.227, Train_accy 83.24:   0%|          | 0/20 [00:12<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.227, Train_accy 83.24:   5%|▌         | 1/20 [00:12<04:02, 12.75s/it]
Task 9, Epoch 2/20 => Loss 0.512, Train_accy 94.56:   5%|▌         | 1/20 [00:25<04:02, 12.75s/it]
Task 9, Epoch 2/20 => Loss 0.512, Train_accy 94.56:  10%|█         | 2/20 [00:25<03:49, 12.74s/it]
Task 9, Epoch 3/20 => Loss 0.236, Train_accy 96.44:  10%|█         | 2/20 [00:38<03:49, 12.74s/it]
Task 9, Epoch 3/20 => Loss 0.236, Train_accy 96.44:  15%|█▌        | 3/20 [00:38<03:37, 12.80s/it]
Task 9, Epoch 4/20 => Loss 0.157, Train_accy 95.92:  15%|█▌        | 3/20 [00:51<03:37, 12.80s/it]
Task 9, Epoch 4/20 => Loss 0.157, Train_accy 95.92:  20%|██        | 4/20 [00:51<03:24, 12.78s/it]
Task 9, Epoch 5/20 => Loss 0.129, Train_accy 96.64:  20%|██        | 4/20 [01:03<03:24, 12.78s/it]
Task 9, Epoch 5/20 => Loss 0.129, Train_accy 96.64:  25%|██▌       | 5/20 [01:03<03:11, 12.78s/it]
Task 9, Epoch 6/20 => Loss 0.110, Train_accy 96.92:  25%|██▌       | 5/20 [01:16<03:11, 12.78s/it]
Task 9, Epoch 6/20 => Loss 0.110, Train_accy 96.92:  30%|███       | 6/20 [01:16<02:58, 12.76s/it]
Task 9, Epoch 7/20 => Loss 0.101, Train_accy 97.16:  30%|███       | 6/20 [01:29<02:58, 12.76s/it]
Task 9, Epoch 7/20 => Loss 0.101, Train_accy 97.16:  35%|███▌      | 7/20 [01:29<02:45, 12.75s/it]
Task 9, Epoch 8/20 => Loss 0.104, Train_accy 97.08:  35%|███▌      | 7/20 [01:42<02:45, 12.75s/it]
Task 9, Epoch 8/20 => Loss 0.104, Train_accy 97.08:  40%|████      | 8/20 [01:42<02:33, 12.76s/it]
Task 9, Epoch 9/20 => Loss 0.106, Train_accy 96.72:  40%|████      | 8/20 [01:54<02:33, 12.76s/it]
Task 9, Epoch 9/20 => Loss 0.106, Train_accy 96.72:  45%|████▌     | 9/20 [01:54<02:20, 12.75s/it]
Task 9, Epoch 10/20 => Loss 0.093, Train_accy 97.40:  45%|████▌     | 9/20 [02:07<02:20, 12.75s/it]
Task 9, Epoch 10/20 => Loss 0.093, Train_accy 97.40:  50%|█████     | 10/20 [02:07<02:07, 12.76s/it]
Task 9, Epoch 11/20 => Loss 0.080, Train_accy 97.68:  50%|█████     | 10/20 [02:20<02:07, 12.76s/it]
Task 9, Epoch 11/20 => Loss 0.080, Train_accy 97.68:  55%|█████▌    | 11/20 [02:20<01:54, 12.75s/it]
Task 9, Epoch 12/20 => Loss 0.088, Train_accy 97.40:  55%|█████▌    | 11/20 [02:33<01:54, 12.75s/it]
Task 9, Epoch 12/20 => Loss 0.088, Train_accy 97.40:  60%|██████    | 12/20 [02:33<01:41, 12.74s/it]
Task 9, Epoch 13/20 => Loss 0.081, Train_accy 97.96:  60%|██████    | 12/20 [02:45<01:41, 12.74s/it]
Task 9, Epoch 13/20 => Loss 0.081, Train_accy 97.96:  65%|██████▌   | 13/20 [02:45<01:29, 12.73s/it]
Task 9, Epoch 14/20 => Loss 0.094, Train_accy 97.04:  65%|██████▌   | 13/20 [02:58<01:29, 12.73s/it]
Task 9, Epoch 14/20 => Loss 0.094, Train_accy 97.04:  70%|███████   | 14/20 [02:58<01:16, 12.73s/it]
Task 9, Epoch 15/20 => Loss 0.072, Train_accy 97.60:  70%|███████   | 14/20 [03:11<01:16, 12.73s/it]
Task 9, Epoch 15/20 => Loss 0.072, Train_accy 97.60:  75%|███████▌  | 15/20 [03:11<01:03, 12.73s/it]
Task 9, Epoch 16/20 => Loss 0.073, Train_accy 97.92:  75%|███████▌  | 15/20 [03:23<01:03, 12.73s/it]
Task 9, Epoch 16/20 => Loss 0.073, Train_accy 97.92:  80%|████████  | 16/20 [03:23<00:50, 12.74s/it]
Task 9, Epoch 17/20 => Loss 0.081, Train_accy 97.40:  80%|████████  | 16/20 [03:36<00:50, 12.74s/it]
Task 9, Epoch 17/20 => Loss 0.081, Train_accy 97.40:  85%|████████▌ | 17/20 [03:36<00:38, 12.77s/it]
Task 9, Epoch 18/20 => Loss 0.093, Train_accy 97.00:  85%|████████▌ | 17/20 [03:49<00:38, 12.77s/it]
Task 9, Epoch 18/20 => Loss 0.093, Train_accy 97.00:  90%|█████████ | 18/20 [03:49<00:25, 12.75s/it]
Task 9, Epoch 19/20 => Loss 0.084, Train_accy 97.16:  90%|█████████ | 18/20 [04:02<00:25, 12.75s/it]
Task 9, Epoch 19/20 => Loss 0.084, Train_accy 97.16:  95%|█████████▌| 19/20 [04:02<00:12, 12.74s/it]
Task 9, Epoch 20/20 => Loss 0.079, Train_accy 97.60:  95%|█████████▌| 19/20 [04:14<00:12, 12.74s/it]
Task 9, Epoch 20/20 => Loss 0.079, Train_accy 97.60: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 9, Epoch 20/20 => Loss 0.079, Train_accy 97.60: 100%|██████████| 20/20 [04:14<00:00, 12.75s/it]
2024-09-04 15:26:49,174 [ease.py] => Task 9, Epoch 20/20 => Loss 0.079, Train_accy 97.60
2024-09-04 15:29:57,778 [ease.py] => Task correct: 91.42
2024-09-04 15:29:57,779 [ease.py] => Task acc: 99.16
2024-09-04 15:29:57,805 [trainer.py] => No NME accuracy.
2024-09-04 15:29:57,805 [trainer.py] => CNN: {'total': 91.16, '00-04': 92.0, '05-09': 88.2, '10-14': 85.8, '15-19': 89.8, '20-24': 97.4, '25-29': 92.8, '30-34': 86.0, '35-39': 90.4, '40-44': 94.4, '45-49': 94.8, 'old': 90.76, 'new': 94.8}
2024-09-04 15:29:57,805 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16]
2024-09-04 15:29:57,805 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98]

Average Accuracy (CNN): 95.25
2024-09-04 15:29:57,805 [trainer.py] => Average Accuracy (CNN): 95.25 

2024-09-04 15:29:57,806 [trainer.py] => All params: 86490818
2024-09-04 15:29:57,807 [trainer.py] => Trainable params: 304320
2024-09-04 15:29:57,812 [ease.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.317, Train_accy 75.68:   0%|          | 0/20 [00:12<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.317, Train_accy 75.68:   5%|▌         | 1/20 [00:12<04:02, 12.77s/it]
Task 10, Epoch 2/20 => Loss 0.674, Train_accy 90.92:   5%|▌         | 1/20 [00:25<04:02, 12.77s/it]
Task 10, Epoch 2/20 => Loss 0.674, Train_accy 90.92:  10%|█         | 2/20 [00:25<03:50, 12.82s/it]
Task 10, Epoch 3/20 => Loss 0.353, Train_accy 93.48:  10%|█         | 2/20 [00:38<03:50, 12.82s/it]
Task 10, Epoch 3/20 => Loss 0.353, Train_accy 93.48:  15%|█▌        | 3/20 [00:38<03:37, 12.80s/it]
Task 10, Epoch 4/20 => Loss 0.229, Train_accy 94.44:  15%|█▌        | 3/20 [00:51<03:37, 12.80s/it]
Task 10, Epoch 4/20 => Loss 0.229, Train_accy 94.44:  20%|██        | 4/20 [00:51<03:24, 12.79s/it]
Task 10, Epoch 5/20 => Loss 0.178, Train_accy 95.92:  20%|██        | 4/20 [01:03<03:24, 12.79s/it]
Task 10, Epoch 5/20 => Loss 0.178, Train_accy 95.92:  25%|██▌       | 5/20 [01:03<03:11, 12.77s/it]
Task 10, Epoch 6/20 => Loss 0.164, Train_accy 95.48:  25%|██▌       | 5/20 [01:16<03:11, 12.77s/it]
Task 10, Epoch 6/20 => Loss 0.164, Train_accy 95.48:  30%|███       | 6/20 [01:16<02:58, 12.78s/it]
Task 10, Epoch 7/20 => Loss 0.141, Train_accy 95.84:  30%|███       | 6/20 [01:29<02:58, 12.78s/it]
Task 10, Epoch 7/20 => Loss 0.141, Train_accy 95.84:  35%|███▌      | 7/20 [01:29<02:46, 12.81s/it]
Task 10, Epoch 8/20 => Loss 0.146, Train_accy 95.44:  35%|███▌      | 7/20 [01:42<02:46, 12.81s/it]
Task 10, Epoch 8/20 => Loss 0.146, Train_accy 95.44:  40%|████      | 8/20 [01:42<02:33, 12.81s/it]
Task 10, Epoch 9/20 => Loss 0.123, Train_accy 96.36:  40%|████      | 8/20 [01:55<02:33, 12.81s/it]
Task 10, Epoch 9/20 => Loss 0.123, Train_accy 96.36:  45%|████▌     | 9/20 [01:55<02:20, 12.81s/it]
Task 10, Epoch 10/20 => Loss 0.128, Train_accy 96.28:  45%|████▌     | 9/20 [02:07<02:20, 12.81s/it]
Task 10, Epoch 10/20 => Loss 0.128, Train_accy 96.28:  50%|█████     | 10/20 [02:07<02:07, 12.79s/it]
Task 10, Epoch 11/20 => Loss 0.121, Train_accy 95.92:  50%|█████     | 10/20 [02:20<02:07, 12.79s/it]
Task 10, Epoch 11/20 => Loss 0.121, Train_accy 95.92:  55%|█████▌    | 11/20 [02:20<01:55, 12.78s/it]
Task 10, Epoch 12/20 => Loss 0.113, Train_accy 96.84:  55%|█████▌    | 11/20 [02:33<01:55, 12.78s/it]
Task 10, Epoch 12/20 => Loss 0.113, Train_accy 96.84:  60%|██████    | 12/20 [02:33<01:42, 12.76s/it]
Task 10, Epoch 13/20 => Loss 0.102, Train_accy 96.96:  60%|██████    | 12/20 [02:46<01:42, 12.76s/it]
Task 10, Epoch 13/20 => Loss 0.102, Train_accy 96.96:  65%|██████▌   | 13/20 [02:46<01:29, 12.78s/it]
Task 10, Epoch 14/20 => Loss 0.108, Train_accy 96.72:  65%|██████▌   | 13/20 [02:59<01:29, 12.78s/it]
Task 10, Epoch 14/20 => Loss 0.108, Train_accy 96.72:  70%|███████   | 14/20 [02:59<01:16, 12.78s/it]
Task 10, Epoch 15/20 => Loss 0.109, Train_accy 96.88:  70%|███████   | 14/20 [03:11<01:16, 12.78s/it]
Task 10, Epoch 15/20 => Loss 0.109, Train_accy 96.88:  75%|███████▌  | 15/20 [03:11<01:04, 12.81s/it]
Task 10, Epoch 16/20 => Loss 0.105, Train_accy 96.96:  75%|███████▌  | 15/20 [03:24<01:04, 12.81s/it]
Task 10, Epoch 16/20 => Loss 0.105, Train_accy 96.96:  80%|████████  | 16/20 [03:24<00:51, 12.82s/it]
Task 10, Epoch 17/20 => Loss 0.111, Train_accy 96.44:  80%|████████  | 16/20 [03:37<00:51, 12.82s/it]
Task 10, Epoch 17/20 => Loss 0.111, Train_accy 96.44:  85%|████████▌ | 17/20 [03:37<00:38, 12.78s/it]
Task 10, Epoch 18/20 => Loss 0.107, Train_accy 96.76:  85%|████████▌ | 17/20 [03:50<00:38, 12.78s/it]
Task 10, Epoch 18/20 => Loss 0.107, Train_accy 96.76:  90%|█████████ | 18/20 [03:50<00:25, 12.75s/it]
Task 10, Epoch 19/20 => Loss 0.102, Train_accy 96.96:  90%|█████████ | 18/20 [04:02<00:25, 12.75s/it]
Task 10, Epoch 19/20 => Loss 0.102, Train_accy 96.96:  95%|█████████▌| 19/20 [04:02<00:12, 12.75s/it]
Task 10, Epoch 20/20 => Loss 0.100, Train_accy 96.88:  95%|█████████▌| 19/20 [04:15<00:12, 12.75s/it]
Task 10, Epoch 20/20 => Loss 0.100, Train_accy 96.88: 100%|██████████| 20/20 [04:15<00:00, 12.75s/it]
Task 10, Epoch 20/20 => Loss 0.100, Train_accy 96.88: 100%|██████████| 20/20 [04:15<00:00, 12.78s/it]
2024-09-04 15:34:13,455 [ease.py] => Task 10, Epoch 20/20 => Loss 0.100, Train_accy 96.88
2024-09-04 15:37:54,172 [ease.py] => Task correct: 90.52727272727273
2024-09-04 15:37:54,173 [ease.py] => Task acc: 99.14545454545454
2024-09-04 15:37:54,199 [trainer.py] => No NME accuracy.
2024-09-04 15:37:54,199 [trainer.py] => CNN: {'total': 90.25, '00-04': 89.8, '05-09': 88.4, '10-14': 85.6, '15-19': 89.8, '20-24': 97.2, '25-29': 91.8, '30-34': 85.0, '35-39': 89.4, '40-44': 93.2, '45-49': 92.8, '50-54': 89.8, 'old': 90.3, 'new': 89.8}
2024-09-04 15:37:54,199 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25]
2024-09-04 15:37:54,200 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91]

Average Accuracy (CNN): 94.8
2024-09-04 15:37:54,200 [trainer.py] => Average Accuracy (CNN): 94.8 

2024-09-04 15:37:54,201 [trainer.py] => All params: 86571458
2024-09-04 15:37:54,201 [trainer.py] => Trainable params: 304320
2024-09-04 15:37:54,208 [ease.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.345, Train_accy 70.12:   0%|          | 0/20 [00:12<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.345, Train_accy 70.12:   5%|▌         | 1/20 [00:12<04:01, 12.70s/it]
Task 11, Epoch 2/20 => Loss 0.791, Train_accy 85.52:   5%|▌         | 1/20 [00:25<04:01, 12.70s/it]
Task 11, Epoch 2/20 => Loss 0.791, Train_accy 85.52:  10%|█         | 2/20 [00:25<03:48, 12.72s/it]
Task 11, Epoch 3/20 => Loss 0.490, Train_accy 87.56:  10%|█         | 2/20 [00:38<03:48, 12.72s/it]
Task 11, Epoch 3/20 => Loss 0.490, Train_accy 87.56:  15%|█▌        | 3/20 [00:38<03:36, 12.72s/it]
Task 11, Epoch 4/20 => Loss 0.372, Train_accy 88.44:  15%|█▌        | 3/20 [00:50<03:36, 12.72s/it]
Task 11, Epoch 4/20 => Loss 0.372, Train_accy 88.44:  20%|██        | 4/20 [00:50<03:23, 12.71s/it]
Task 11, Epoch 5/20 => Loss 0.313, Train_accy 90.04:  20%|██        | 4/20 [01:03<03:23, 12.71s/it]
Task 11, Epoch 5/20 => Loss 0.313, Train_accy 90.04:  25%|██▌       | 5/20 [01:03<03:10, 12.69s/it]
Task 11, Epoch 6/20 => Loss 0.280, Train_accy 90.52:  25%|██▌       | 5/20 [01:16<03:10, 12.69s/it]
Task 11, Epoch 6/20 => Loss 0.280, Train_accy 90.52:  30%|███       | 6/20 [01:16<02:57, 12.68s/it]
Task 11, Epoch 7/20 => Loss 0.277, Train_accy 90.00:  30%|███       | 6/20 [01:28<02:57, 12.68s/it]
Task 11, Epoch 7/20 => Loss 0.277, Train_accy 90.00:  35%|███▌      | 7/20 [01:28<02:45, 12.70s/it]
Task 11, Epoch 8/20 => Loss 0.244, Train_accy 91.24:  35%|███▌      | 7/20 [01:41<02:45, 12.70s/it]
Task 11, Epoch 8/20 => Loss 0.244, Train_accy 91.24:  40%|████      | 8/20 [01:41<02:32, 12.69s/it]
Task 11, Epoch 9/20 => Loss 0.238, Train_accy 91.60:  40%|████      | 8/20 [01:54<02:32, 12.69s/it]
Task 11, Epoch 9/20 => Loss 0.238, Train_accy 91.60:  45%|████▌     | 9/20 [01:54<02:19, 12.68s/it]
Task 11, Epoch 10/20 => Loss 0.229, Train_accy 91.32:  45%|████▌     | 9/20 [02:06<02:19, 12.68s/it]
Task 11, Epoch 10/20 => Loss 0.229, Train_accy 91.32:  50%|█████     | 10/20 [02:06<02:06, 12.68s/it]
Task 11, Epoch 11/20 => Loss 0.218, Train_accy 92.44:  50%|█████     | 10/20 [02:19<02:06, 12.68s/it]
Task 11, Epoch 11/20 => Loss 0.218, Train_accy 92.44:  55%|█████▌    | 11/20 [02:19<01:54, 12.70s/it]
Task 11, Epoch 12/20 => Loss 0.236, Train_accy 91.80:  55%|█████▌    | 11/20 [02:32<01:54, 12.70s/it]
Task 11, Epoch 12/20 => Loss 0.236, Train_accy 91.80:  60%|██████    | 12/20 [02:32<01:41, 12.70s/it]
Task 11, Epoch 13/20 => Loss 0.216, Train_accy 92.16:  60%|██████    | 12/20 [02:45<01:41, 12.70s/it]
Task 11, Epoch 13/20 => Loss 0.216, Train_accy 92.16:  65%|██████▌   | 13/20 [02:45<01:29, 12.72s/it]
Task 11, Epoch 14/20 => Loss 0.214, Train_accy 92.24:  65%|██████▌   | 13/20 [02:57<01:29, 12.72s/it]
Task 11, Epoch 14/20 => Loss 0.214, Train_accy 92.24:  70%|███████   | 14/20 [02:57<01:16, 12.70s/it]
Task 11, Epoch 15/20 => Loss 0.212, Train_accy 92.68:  70%|███████   | 14/20 [03:10<01:16, 12.70s/it]
Task 11, Epoch 15/20 => Loss 0.212, Train_accy 92.68:  75%|███████▌  | 15/20 [03:10<01:03, 12.69s/it]
Task 11, Epoch 16/20 => Loss 0.203, Train_accy 92.68:  75%|███████▌  | 15/20 [03:23<01:03, 12.69s/it]
Task 11, Epoch 16/20 => Loss 0.203, Train_accy 92.68:  80%|████████  | 16/20 [03:23<00:50, 12.70s/it]
Task 11, Epoch 17/20 => Loss 0.220, Train_accy 91.68:  80%|████████  | 16/20 [03:35<00:50, 12.70s/it]
Task 11, Epoch 17/20 => Loss 0.220, Train_accy 91.68:  85%|████████▌ | 17/20 [03:35<00:38, 12.72s/it]
Task 11, Epoch 18/20 => Loss 0.234, Train_accy 92.04:  85%|████████▌ | 17/20 [03:48<00:38, 12.72s/it]
Task 11, Epoch 18/20 => Loss 0.234, Train_accy 92.04:  90%|█████████ | 18/20 [03:48<00:25, 12.71s/it]
Task 11, Epoch 19/20 => Loss 0.238, Train_accy 90.68:  90%|█████████ | 18/20 [04:01<00:25, 12.71s/it]
Task 11, Epoch 19/20 => Loss 0.238, Train_accy 90.68:  95%|█████████▌| 19/20 [04:01<00:12, 12.72s/it]
Task 11, Epoch 20/20 => Loss 0.222, Train_accy 91.76:  95%|█████████▌| 19/20 [04:14<00:12, 12.72s/it]
Task 11, Epoch 20/20 => Loss 0.222, Train_accy 91.76: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 11, Epoch 20/20 => Loss 0.222, Train_accy 91.76: 100%|██████████| 20/20 [04:14<00:00, 12.70s/it]
2024-09-04 15:42:08,329 [ease.py] => Task 11, Epoch 20/20 => Loss 0.222, Train_accy 91.76
2024-09-04 15:46:23,309 [ease.py] => Task correct: 90.38333333333334
2024-09-04 15:46:23,310 [ease.py] => Task acc: 99.11666666666666
2024-09-04 15:46:23,332 [trainer.py] => No NME accuracy.
2024-09-04 15:46:23,333 [trainer.py] => CNN: {'total': 90.08, '00-04': 89.4, '05-09': 88.2, '10-14': 85.2, '15-19': 89.8, '20-24': 97.0, '25-29': 91.6, '30-34': 85.0, '35-39': 89.4, '40-44': 93.0, '45-49': 92.6, '50-54': 89.8, '55-59': 90.0, 'old': 90.09, 'new': 90.0}
2024-09-04 15:46:23,333 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08]
2024-09-04 15:46:23,333 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67]

Average Accuracy (CNN): 94.4
2024-09-04 15:46:23,333 [trainer.py] => Average Accuracy (CNN): 94.4 

2024-09-04 15:46:23,333 [trainer.py] => All params: 86659778
2024-09-04 15:46:23,334 [trainer.py] => Trainable params: 304320
2024-09-04 15:46:23,341 [ease.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.262, Train_accy 81.28:   0%|          | 0/20 [00:12<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.262, Train_accy 81.28:   5%|▌         | 1/20 [00:12<04:02, 12.75s/it]
Task 12, Epoch 2/20 => Loss 0.574, Train_accy 92.72:   5%|▌         | 1/20 [00:25<04:02, 12.75s/it]
Task 12, Epoch 2/20 => Loss 0.574, Train_accy 92.72:  10%|█         | 2/20 [00:25<03:50, 12.78s/it]
Task 12, Epoch 3/20 => Loss 0.291, Train_accy 94.32:  10%|█         | 2/20 [00:38<03:50, 12.78s/it]
Task 12, Epoch 3/20 => Loss 0.291, Train_accy 94.32:  15%|█▌        | 3/20 [00:38<03:37, 12.77s/it]
Task 12, Epoch 4/20 => Loss 0.191, Train_accy 95.60:  15%|█▌        | 3/20 [00:51<03:37, 12.77s/it]
Task 12, Epoch 4/20 => Loss 0.191, Train_accy 95.60:  20%|██        | 4/20 [00:51<03:24, 12.78s/it]
Task 12, Epoch 5/20 => Loss 0.175, Train_accy 95.24:  20%|██        | 4/20 [01:03<03:24, 12.78s/it]
Task 12, Epoch 5/20 => Loss 0.175, Train_accy 95.24:  25%|██▌       | 5/20 [01:03<03:11, 12.78s/it]
Task 12, Epoch 6/20 => Loss 0.149, Train_accy 95.76:  25%|██▌       | 5/20 [01:16<03:11, 12.78s/it]
Task 12, Epoch 6/20 => Loss 0.149, Train_accy 95.76:  30%|███       | 6/20 [01:16<02:58, 12.76s/it]
Task 12, Epoch 7/20 => Loss 0.131, Train_accy 96.12:  30%|███       | 6/20 [01:29<02:58, 12.76s/it]
Task 12, Epoch 7/20 => Loss 0.131, Train_accy 96.12:  35%|███▌      | 7/20 [01:29<02:45, 12.76s/it]
Task 12, Epoch 8/20 => Loss 0.120, Train_accy 96.88:  35%|███▌      | 7/20 [01:42<02:45, 12.76s/it]
Task 12, Epoch 8/20 => Loss 0.120, Train_accy 96.88:  40%|████      | 8/20 [01:42<02:33, 12.76s/it]
Task 12, Epoch 9/20 => Loss 0.127, Train_accy 96.24:  40%|████      | 8/20 [01:54<02:33, 12.76s/it]
Task 12, Epoch 9/20 => Loss 0.127, Train_accy 96.24:  45%|████▌     | 9/20 [01:54<02:20, 12.75s/it]
Task 12, Epoch 10/20 => Loss 0.118, Train_accy 96.56:  45%|████▌     | 9/20 [02:07<02:20, 12.75s/it]
Task 12, Epoch 10/20 => Loss 0.118, Train_accy 96.56:  50%|█████     | 10/20 [02:07<02:07, 12.73s/it]
Task 12, Epoch 11/20 => Loss 0.112, Train_accy 96.72:  50%|█████     | 10/20 [02:20<02:07, 12.73s/it]
Task 12, Epoch 11/20 => Loss 0.112, Train_accy 96.72:  55%|█████▌    | 11/20 [02:20<01:54, 12.72s/it]
Task 12, Epoch 12/20 => Loss 0.114, Train_accy 96.12:  55%|█████▌    | 11/20 [02:32<01:54, 12.72s/it]
Task 12, Epoch 12/20 => Loss 0.114, Train_accy 96.12:  60%|██████    | 12/20 [02:32<01:41, 12.72s/it]
Task 12, Epoch 13/20 => Loss 0.112, Train_accy 96.52:  60%|██████    | 12/20 [02:45<01:41, 12.72s/it]
Task 12, Epoch 13/20 => Loss 0.112, Train_accy 96.52:  65%|██████▌   | 13/20 [02:45<01:29, 12.73s/it]
Task 12, Epoch 14/20 => Loss 0.114, Train_accy 96.40:  65%|██████▌   | 13/20 [02:58<01:29, 12.73s/it]
Task 12, Epoch 14/20 => Loss 0.114, Train_accy 96.40:  70%|███████   | 14/20 [02:58<01:16, 12.74s/it]
Task 12, Epoch 15/20 => Loss 0.106, Train_accy 96.64:  70%|███████   | 14/20 [03:11<01:16, 12.74s/it]
Task 12, Epoch 15/20 => Loss 0.106, Train_accy 96.64:  75%|███████▌  | 15/20 [03:11<01:03, 12.73s/it]
Task 12, Epoch 16/20 => Loss 0.130, Train_accy 96.40:  75%|███████▌  | 15/20 [03:23<01:03, 12.73s/it]
Task 12, Epoch 16/20 => Loss 0.130, Train_accy 96.40:  80%|████████  | 16/20 [03:23<00:50, 12.75s/it]
Task 12, Epoch 17/20 => Loss 0.112, Train_accy 96.48:  80%|████████  | 16/20 [03:36<00:50, 12.75s/it]
Task 12, Epoch 17/20 => Loss 0.112, Train_accy 96.48:  85%|████████▌ | 17/20 [03:36<00:38, 12.76s/it]
Task 12, Epoch 18/20 => Loss 0.117, Train_accy 96.24:  85%|████████▌ | 17/20 [03:49<00:38, 12.76s/it]
Task 12, Epoch 18/20 => Loss 0.117, Train_accy 96.24:  90%|█████████ | 18/20 [03:49<00:25, 12.77s/it]
Task 12, Epoch 19/20 => Loss 0.108, Train_accy 96.64:  90%|█████████ | 18/20 [04:02<00:25, 12.77s/it]
Task 12, Epoch 19/20 => Loss 0.108, Train_accy 96.64:  95%|█████████▌| 19/20 [04:02<00:12, 12.76s/it]
Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.60:  95%|█████████▌| 19/20 [04:15<00:12, 12.76s/it]
Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.60: 100%|██████████| 20/20 [04:15<00:00, 12.75s/it]
Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.60: 100%|██████████| 20/20 [04:15<00:00, 12.75s/it]
2024-09-04 15:50:38,388 [ease.py] => Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.60
2024-09-04 15:55:30,451 [ease.py] => Task correct: 89.66153846153846
2024-09-04 15:55:30,452 [ease.py] => Task acc: 99.16923076923077
2024-09-04 15:55:30,479 [trainer.py] => No NME accuracy.
2024-09-04 15:55:30,479 [trainer.py] => CNN: {'total': 89.4, '00-04': 89.4, '05-09': 87.2, '10-14': 84.4, '15-19': 88.4, '20-24': 97.0, '25-29': 91.4, '30-34': 84.6, '35-39': 88.8, '40-44': 93.0, '45-49': 92.4, '50-54': 89.8, '55-59': 81.8, '60-64': 94.0, 'old': 89.02, 'new': 94.0}
2024-09-04 15:55:30,479 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4]
2024-09-04 15:55:30,479 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69]

Average Accuracy (CNN): 94.02
2024-09-04 15:55:30,479 [trainer.py] => Average Accuracy (CNN): 94.02 

2024-09-04 15:55:30,480 [trainer.py] => All params: 86755778
2024-09-04 15:55:30,481 [trainer.py] => Trainable params: 304320
2024-09-04 15:55:30,488 [ease.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.229, Train_accy 84.00:   0%|          | 0/20 [00:12<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.229, Train_accy 84.00:   5%|▌         | 1/20 [00:12<04:02, 12.76s/it]
Task 13, Epoch 2/20 => Loss 0.507, Train_accy 95.56:   5%|▌         | 1/20 [00:25<04:02, 12.76s/it]
Task 13, Epoch 2/20 => Loss 0.507, Train_accy 95.56:  10%|█         | 2/20 [00:25<03:49, 12.76s/it]
Task 13, Epoch 3/20 => Loss 0.237, Train_accy 96.40:  10%|█         | 2/20 [00:38<03:49, 12.76s/it]
Task 13, Epoch 3/20 => Loss 0.237, Train_accy 96.40:  15%|█▌        | 3/20 [00:38<03:37, 12.79s/it]
Task 13, Epoch 4/20 => Loss 0.154, Train_accy 96.28:  15%|█▌        | 3/20 [00:51<03:37, 12.79s/it]
Task 13, Epoch 4/20 => Loss 0.154, Train_accy 96.28:  20%|██        | 4/20 [00:51<03:24, 12.77s/it]
Task 13, Epoch 5/20 => Loss 0.133, Train_accy 96.56:  20%|██        | 4/20 [01:03<03:24, 12.77s/it]
Task 13, Epoch 5/20 => Loss 0.133, Train_accy 96.56:  25%|██▌       | 5/20 [01:03<03:11, 12.76s/it]
Task 13, Epoch 6/20 => Loss 0.130, Train_accy 96.44:  25%|██▌       | 5/20 [01:16<03:11, 12.76s/it]
Task 13, Epoch 6/20 => Loss 0.130, Train_accy 96.44:  30%|███       | 6/20 [01:16<02:58, 12.76s/it]
Task 13, Epoch 7/20 => Loss 0.122, Train_accy 96.48:  30%|███       | 6/20 [01:29<02:58, 12.76s/it]
Task 13, Epoch 7/20 => Loss 0.122, Train_accy 96.48:  35%|███▌      | 7/20 [01:29<02:45, 12.76s/it]
Task 13, Epoch 8/20 => Loss 0.122, Train_accy 96.56:  35%|███▌      | 7/20 [01:42<02:45, 12.76s/it]
Task 13, Epoch 8/20 => Loss 0.122, Train_accy 96.56:  40%|████      | 8/20 [01:42<02:33, 12.76s/it]
Task 13, Epoch 9/20 => Loss 0.106, Train_accy 96.76:  40%|████      | 8/20 [01:54<02:33, 12.76s/it]
Task 13, Epoch 9/20 => Loss 0.106, Train_accy 96.76:  45%|████▌     | 9/20 [01:54<02:20, 12.77s/it]
Task 13, Epoch 10/20 => Loss 0.103, Train_accy 97.24:  45%|████▌     | 9/20 [02:07<02:20, 12.77s/it]
Task 13, Epoch 10/20 => Loss 0.103, Train_accy 97.24:  50%|█████     | 10/20 [02:07<02:07, 12.77s/it]
Task 13, Epoch 11/20 => Loss 0.105, Train_accy 96.88:  50%|█████     | 10/20 [02:20<02:07, 12.77s/it]
Task 13, Epoch 11/20 => Loss 0.105, Train_accy 96.88:  55%|█████▌    | 11/20 [02:20<01:55, 12.78s/it]
Task 13, Epoch 12/20 => Loss 0.098, Train_accy 97.24:  55%|█████▌    | 11/20 [02:33<01:55, 12.78s/it]
Task 13, Epoch 12/20 => Loss 0.098, Train_accy 97.24:  60%|██████    | 12/20 [02:33<01:42, 12.76s/it]
Task 13, Epoch 13/20 => Loss 0.094, Train_accy 97.32:  60%|██████    | 12/20 [02:46<01:42, 12.76s/it]
Task 13, Epoch 13/20 => Loss 0.094, Train_accy 97.32:  65%|██████▌   | 13/20 [02:46<01:29, 12.78s/it]
Task 13, Epoch 14/20 => Loss 0.096, Train_accy 97.08:  65%|██████▌   | 13/20 [02:58<01:29, 12.78s/it]
Task 13, Epoch 14/20 => Loss 0.096, Train_accy 97.08:  70%|███████   | 14/20 [02:58<01:16, 12.76s/it]
Task 13, Epoch 15/20 => Loss 0.101, Train_accy 97.08:  70%|███████   | 14/20 [03:11<01:16, 12.76s/it]
Task 13, Epoch 15/20 => Loss 0.101, Train_accy 97.08:  75%|███████▌  | 15/20 [03:11<01:03, 12.76s/it]
Task 13, Epoch 16/20 => Loss 0.087, Train_accy 97.40:  75%|███████▌  | 15/20 [03:24<01:03, 12.76s/it]
Task 13, Epoch 16/20 => Loss 0.087, Train_accy 97.40:  80%|████████  | 16/20 [03:24<00:50, 12.74s/it]
Task 13, Epoch 17/20 => Loss 0.073, Train_accy 98.08:  80%|████████  | 16/20 [03:36<00:50, 12.74s/it]
Task 13, Epoch 17/20 => Loss 0.073, Train_accy 98.08:  85%|████████▌ | 17/20 [03:36<00:38, 12.74s/it]
Task 13, Epoch 18/20 => Loss 0.082, Train_accy 97.48:  85%|████████▌ | 17/20 [03:49<00:38, 12.74s/it]
Task 13, Epoch 18/20 => Loss 0.082, Train_accy 97.48:  90%|█████████ | 18/20 [03:49<00:25, 12.76s/it]
Task 13, Epoch 19/20 => Loss 0.087, Train_accy 97.12:  90%|█████████ | 18/20 [04:02<00:25, 12.76s/it]
Task 13, Epoch 19/20 => Loss 0.087, Train_accy 97.12:  95%|█████████▌| 19/20 [04:02<00:12, 12.78s/it]
Task 13, Epoch 20/20 => Loss 0.099, Train_accy 97.12:  95%|█████████▌| 19/20 [04:15<00:12, 12.78s/it]
Task 13, Epoch 20/20 => Loss 0.099, Train_accy 97.12: 100%|██████████| 20/20 [04:15<00:00, 12.79s/it]
Task 13, Epoch 20/20 => Loss 0.099, Train_accy 97.12: 100%|██████████| 20/20 [04:15<00:00, 12.77s/it]
2024-09-04 15:59:45,893 [ease.py] => Task 13, Epoch 20/20 => Loss 0.099, Train_accy 97.12
2024-09-04 16:05:17,849 [ease.py] => Task correct: 89.62857142857143
2024-09-04 16:05:17,850 [ease.py] => Task acc: 99.22857142857143
2024-09-04 16:05:17,874 [trainer.py] => No NME accuracy.
2024-09-04 16:05:17,874 [trainer.py] => CNN: {'total': 89.39, '00-04': 87.6, '05-09': 87.4, '10-14': 83.4, '15-19': 88.4, '20-24': 97.0, '25-29': 91.2, '30-34': 84.2, '35-39': 88.6, '40-44': 92.8, '45-49': 91.8, '50-54': 89.4, '55-59': 81.6, '60-64': 93.0, '65-69': 95.0, 'old': 88.95, 'new': 95.0}
2024-09-04 16:05:17,874 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4, 89.39]
2024-09-04 16:05:17,874 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69, 98.61]

Average Accuracy (CNN): 93.69
2024-09-04 16:05:17,874 [trainer.py] => Average Accuracy (CNN): 93.69 

2024-09-04 16:05:17,875 [trainer.py] => All params: 86859458
2024-09-04 16:05:17,876 [trainer.py] => Trainable params: 304320
2024-09-04 16:05:17,884 [ease.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.302, Train_accy 79.40:   0%|          | 0/20 [00:12<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.302, Train_accy 79.40:   5%|▌         | 1/20 [00:12<04:00, 12.68s/it]
Task 14, Epoch 2/20 => Loss 0.651, Train_accy 91.88:   5%|▌         | 1/20 [00:25<04:00, 12.68s/it]
Task 14, Epoch 2/20 => Loss 0.651, Train_accy 91.88:  10%|█         | 2/20 [00:25<03:49, 12.74s/it]
Task 14, Epoch 3/20 => Loss 0.323, Train_accy 93.64:  10%|█         | 2/20 [00:38<03:49, 12.74s/it]
Task 14, Epoch 3/20 => Loss 0.323, Train_accy 93.64:  15%|█▌        | 3/20 [00:38<03:36, 12.76s/it]
Task 14, Epoch 4/20 => Loss 0.237, Train_accy 93.60:  15%|█▌        | 3/20 [00:50<03:36, 12.76s/it]
Task 14, Epoch 4/20 => Loss 0.237, Train_accy 93.60:  20%|██        | 4/20 [00:50<03:24, 12.76s/it]
Task 14, Epoch 5/20 => Loss 0.206, Train_accy 94.72:  20%|██        | 4/20 [01:03<03:24, 12.76s/it]
Task 14, Epoch 5/20 => Loss 0.206, Train_accy 94.72:  25%|██▌       | 5/20 [01:03<03:11, 12.79s/it]
Task 14, Epoch 6/20 => Loss 0.183, Train_accy 94.96:  25%|██▌       | 5/20 [01:16<03:11, 12.79s/it]
Task 14, Epoch 6/20 => Loss 0.183, Train_accy 94.96:  30%|███       | 6/20 [01:16<02:58, 12.78s/it]
Task 14, Epoch 7/20 => Loss 0.174, Train_accy 94.88:  30%|███       | 6/20 [01:29<02:58, 12.78s/it]
Task 14, Epoch 7/20 => Loss 0.174, Train_accy 94.88:  35%|███▌      | 7/20 [01:29<02:45, 12.77s/it]
Task 14, Epoch 8/20 => Loss 0.166, Train_accy 95.12:  35%|███▌      | 7/20 [01:42<02:45, 12.77s/it]
Task 14, Epoch 8/20 => Loss 0.166, Train_accy 95.12:  40%|████      | 8/20 [01:42<02:33, 12.76s/it]
Task 14, Epoch 9/20 => Loss 0.137, Train_accy 95.88:  40%|████      | 8/20 [01:54<02:33, 12.76s/it]
Task 14, Epoch 9/20 => Loss 0.137, Train_accy 95.88:  45%|████▌     | 9/20 [01:54<02:20, 12.74s/it]
Task 14, Epoch 10/20 => Loss 0.131, Train_accy 95.88:  45%|████▌     | 9/20 [02:07<02:20, 12.74s/it]
Task 14, Epoch 10/20 => Loss 0.131, Train_accy 95.88:  50%|█████     | 10/20 [02:07<02:07, 12.75s/it]
Task 14, Epoch 11/20 => Loss 0.143, Train_accy 95.60:  50%|█████     | 10/20 [02:20<02:07, 12.75s/it]
Task 14, Epoch 11/20 => Loss 0.143, Train_accy 95.60:  55%|█████▌    | 11/20 [02:20<01:54, 12.74s/it]
Task 14, Epoch 12/20 => Loss 0.140, Train_accy 95.40:  55%|█████▌    | 11/20 [02:33<01:54, 12.74s/it]
Task 14, Epoch 12/20 => Loss 0.140, Train_accy 95.40:  60%|██████    | 12/20 [02:33<01:41, 12.74s/it]
Task 14, Epoch 13/20 => Loss 0.125, Train_accy 96.08:  60%|██████    | 12/20 [02:45<01:41, 12.74s/it]
Task 14, Epoch 13/20 => Loss 0.125, Train_accy 96.08:  65%|██████▌   | 13/20 [02:45<01:29, 12.76s/it]
Task 14, Epoch 14/20 => Loss 0.125, Train_accy 96.08:  65%|██████▌   | 13/20 [02:58<01:29, 12.76s/it]
Task 14, Epoch 14/20 => Loss 0.125, Train_accy 96.08:  70%|███████   | 14/20 [02:58<01:16, 12.75s/it]
Task 14, Epoch 15/20 => Loss 0.117, Train_accy 96.56:  70%|███████   | 14/20 [03:11<01:16, 12.75s/it]
Task 14, Epoch 15/20 => Loss 0.117, Train_accy 96.56:  75%|███████▌  | 15/20 [03:11<01:03, 12.75s/it]
Task 14, Epoch 16/20 => Loss 0.128, Train_accy 96.00:  75%|███████▌  | 15/20 [03:24<01:03, 12.75s/it]
Task 14, Epoch 16/20 => Loss 0.128, Train_accy 96.00:  80%|████████  | 16/20 [03:24<00:51, 12.77s/it]
Task 14, Epoch 17/20 => Loss 0.126, Train_accy 96.04:  80%|████████  | 16/20 [03:36<00:51, 12.77s/it]
Task 14, Epoch 17/20 => Loss 0.126, Train_accy 96.04:  85%|████████▌ | 17/20 [03:36<00:38, 12.78s/it]
Task 14, Epoch 18/20 => Loss 0.116, Train_accy 96.20:  85%|████████▌ | 17/20 [03:49<00:38, 12.78s/it]
Task 14, Epoch 18/20 => Loss 0.116, Train_accy 96.20:  90%|█████████ | 18/20 [03:49<00:25, 12.80s/it]
Task 14, Epoch 19/20 => Loss 0.116, Train_accy 96.52:  90%|█████████ | 18/20 [04:02<00:25, 12.80s/it]
Task 14, Epoch 19/20 => Loss 0.116, Train_accy 96.52:  95%|█████████▌| 19/20 [04:02<00:12, 12.78s/it]
Task 14, Epoch 20/20 => Loss 0.140, Train_accy 95.92:  95%|█████████▌| 19/20 [04:15<00:12, 12.78s/it]
Task 14, Epoch 20/20 => Loss 0.140, Train_accy 95.92: 100%|██████████| 20/20 [04:15<00:00, 12.77s/it]
Task 14, Epoch 20/20 => Loss 0.140, Train_accy 95.92: 100%|██████████| 20/20 [04:15<00:00, 12.76s/it]
2024-09-04 16:09:33,192 [ease.py] => Task 14, Epoch 20/20 => Loss 0.140, Train_accy 95.92
2024-09-04 16:15:46,516 [ease.py] => Task correct: 88.72
2024-09-04 16:15:46,517 [ease.py] => Task acc: 99.24
2024-09-04 16:15:46,546 [trainer.py] => No NME accuracy.
2024-09-04 16:15:46,546 [trainer.py] => CNN: {'total': 88.52, '00-04': 87.4, '05-09': 87.0, '10-14': 82.8, '15-19': 88.4, '20-24': 97.0, '25-29': 91.2, '30-34': 84.2, '35-39': 88.4, '40-44': 92.6, '45-49': 91.6, '50-54': 89.4, '55-59': 77.8, '60-64': 87.4, '65-69': 94.2, '70-74': 88.4, 'old': 88.53, 'new': 88.4}
2024-09-04 16:15:46,546 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4, 89.39, 88.52]
2024-09-04 16:15:46,546 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69, 98.61, 98.63]

Average Accuracy (CNN): 93.34
2024-09-04 16:15:46,546 [trainer.py] => Average Accuracy (CNN): 93.34 

2024-09-04 16:15:46,548 [trainer.py] => All params: 86970818
2024-09-04 16:15:46,548 [trainer.py] => Trainable params: 304320
2024-09-04 16:15:46,557 [ease.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.273, Train_accy 81.08:   0%|          | 0/20 [00:12<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.273, Train_accy 81.08:   5%|▌         | 1/20 [00:12<04:01, 12.70s/it]
Task 15, Epoch 2/20 => Loss 0.601, Train_accy 92.52:   5%|▌         | 1/20 [00:25<04:01, 12.70s/it]
Task 15, Epoch 2/20 => Loss 0.601, Train_accy 92.52:  10%|█         | 2/20 [00:25<03:48, 12.68s/it]
Task 15, Epoch 3/20 => Loss 0.324, Train_accy 92.12:  10%|█         | 2/20 [00:38<03:48, 12.68s/it]
Task 15, Epoch 3/20 => Loss 0.324, Train_accy 92.12:  15%|█▌        | 3/20 [00:38<03:35, 12.70s/it]
Task 15, Epoch 4/20 => Loss 0.215, Train_accy 94.16:  15%|█▌        | 3/20 [00:50<03:35, 12.70s/it]
Task 15, Epoch 4/20 => Loss 0.215, Train_accy 94.16:  20%|██        | 4/20 [00:50<03:23, 12.73s/it]
Task 15, Epoch 5/20 => Loss 0.167, Train_accy 95.28:  20%|██        | 4/20 [01:03<03:23, 12.73s/it]
Task 15, Epoch 5/20 => Loss 0.167, Train_accy 95.28:  25%|██▌       | 5/20 [01:03<03:10, 12.72s/it]
Task 15, Epoch 6/20 => Loss 0.173, Train_accy 94.68:  25%|██▌       | 5/20 [01:16<03:10, 12.72s/it]
Task 15, Epoch 6/20 => Loss 0.173, Train_accy 94.68:  30%|███       | 6/20 [01:16<02:58, 12.74s/it]
Task 15, Epoch 7/20 => Loss 0.136, Train_accy 96.08:  30%|███       | 6/20 [01:29<02:58, 12.74s/it]
Task 15, Epoch 7/20 => Loss 0.136, Train_accy 96.08:  35%|███▌      | 7/20 [01:29<02:45, 12.74s/it]
Task 15, Epoch 8/20 => Loss 0.143, Train_accy 95.60:  35%|███▌      | 7/20 [01:41<02:45, 12.74s/it]
Task 15, Epoch 8/20 => Loss 0.143, Train_accy 95.60:  40%|████      | 8/20 [01:41<02:32, 12.73s/it]
Task 15, Epoch 9/20 => Loss 0.127, Train_accy 96.32:  40%|████      | 8/20 [01:54<02:32, 12.73s/it]
Task 15, Epoch 9/20 => Loss 0.127, Train_accy 96.32:  45%|████▌     | 9/20 [01:54<02:20, 12.73s/it]
Task 15, Epoch 10/20 => Loss 0.124, Train_accy 96.40:  45%|████▌     | 9/20 [02:07<02:20, 12.73s/it]
Task 15, Epoch 10/20 => Loss 0.124, Train_accy 96.40:  50%|█████     | 10/20 [02:07<02:07, 12.72s/it]
Task 15, Epoch 11/20 => Loss 0.124, Train_accy 96.12:  50%|█████     | 10/20 [02:19<02:07, 12.72s/it]
Task 15, Epoch 11/20 => Loss 0.124, Train_accy 96.12:  55%|█████▌    | 11/20 [02:19<01:54, 12.70s/it]
Task 15, Epoch 12/20 => Loss 0.131, Train_accy 96.48:  55%|█████▌    | 11/20 [02:32<01:54, 12.70s/it]
Task 15, Epoch 12/20 => Loss 0.131, Train_accy 96.48:  60%|██████    | 12/20 [02:32<01:41, 12.72s/it]
Task 15, Epoch 13/20 => Loss 0.116, Train_accy 96.16:  60%|██████    | 12/20 [02:45<01:41, 12.72s/it]
Task 15, Epoch 13/20 => Loss 0.116, Train_accy 96.16:  65%|██████▌   | 13/20 [02:45<01:29, 12.72s/it]
Task 15, Epoch 14/20 => Loss 0.116, Train_accy 96.20:  65%|██████▌   | 13/20 [02:58<01:29, 12.72s/it]
Task 15, Epoch 14/20 => Loss 0.116, Train_accy 96.20:  70%|███████   | 14/20 [02:58<01:16, 12.71s/it]
Task 15, Epoch 15/20 => Loss 0.114, Train_accy 96.28:  70%|███████   | 14/20 [03:10<01:16, 12.71s/it]
Task 15, Epoch 15/20 => Loss 0.114, Train_accy 96.28:  75%|███████▌  | 15/20 [03:10<01:03, 12.71s/it]
Task 15, Epoch 16/20 => Loss 0.109, Train_accy 96.68:  75%|███████▌  | 15/20 [03:23<01:03, 12.71s/it]
Task 15, Epoch 16/20 => Loss 0.109, Train_accy 96.68:  80%|████████  | 16/20 [03:23<00:50, 12.70s/it]
Task 15, Epoch 17/20 => Loss 0.108, Train_accy 96.72:  80%|████████  | 16/20 [03:36<00:50, 12.70s/it]
Task 15, Epoch 17/20 => Loss 0.108, Train_accy 96.72:  85%|████████▌ | 17/20 [03:36<00:38, 12.71s/it]
Task 15, Epoch 18/20 => Loss 0.107, Train_accy 96.76:  85%|████████▌ | 17/20 [03:48<00:38, 12.71s/it]
Task 15, Epoch 18/20 => Loss 0.107, Train_accy 96.76:  90%|█████████ | 18/20 [03:48<00:25, 12.69s/it]
Task 15, Epoch 19/20 => Loss 0.102, Train_accy 97.20:  90%|█████████ | 18/20 [04:01<00:25, 12.69s/it]
Task 15, Epoch 19/20 => Loss 0.102, Train_accy 97.20:  95%|█████████▌| 19/20 [04:01<00:12, 12.70s/it]
Task 15, Epoch 20/20 => Loss 0.101, Train_accy 97.04:  95%|█████████▌| 19/20 [04:14<00:12, 12.70s/it]
Task 15, Epoch 20/20 => Loss 0.101, Train_accy 97.04: 100%|██████████| 20/20 [04:14<00:00, 12.70s/it]
Task 15, Epoch 20/20 => Loss 0.101, Train_accy 97.04: 100%|██████████| 20/20 [04:14<00:00, 12.71s/it]
2024-09-04 16:20:00,821 [ease.py] => Task 15, Epoch 20/20 => Loss 0.101, Train_accy 97.04
2024-09-04 16:26:58,273 [ease.py] => Task correct: 87.1375
2024-09-04 16:26:58,274 [ease.py] => Task acc: 99.25
2024-09-04 16:26:58,301 [trainer.py] => No NME accuracy.
2024-09-04 16:26:58,301 [trainer.py] => CNN: {'total': 86.96, '00-04': 87.6, '05-09': 85.8, '10-14': 83.0, '15-19': 88.4, '20-24': 97.0, '25-29': 91.2, '30-34': 84.0, '35-39': 87.6, '40-44': 92.0, '45-49': 83.0, '50-54': 83.4, '55-59': 74.6, '60-64': 86.4, '65-69': 93.6, '70-74': 85.0, '75-79': 88.8, 'old': 86.84, 'new': 88.8}
2024-09-04 16:26:58,301 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4, 89.39, 88.52, 86.96]
2024-09-04 16:26:58,301 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69, 98.61, 98.63, 98.58]

Average Accuracy (CNN): 92.94
2024-09-04 16:26:58,301 [trainer.py] => Average Accuracy (CNN): 92.94 

2024-09-04 16:26:58,302 [trainer.py] => All params: 87089858
2024-09-04 16:26:58,303 [trainer.py] => Trainable params: 304320
2024-09-04 16:26:58,312 [ease.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.251, Train_accy 84.12:   0%|          | 0/20 [00:12<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.251, Train_accy 84.12:   5%|▌         | 1/20 [00:12<04:00, 12.67s/it]
Task 16, Epoch 2/20 => Loss 0.552, Train_accy 94.88:   5%|▌         | 1/20 [00:25<04:00, 12.67s/it]
Task 16, Epoch 2/20 => Loss 0.552, Train_accy 94.88:  10%|█         | 2/20 [00:25<03:47, 12.66s/it]
Task 16, Epoch 3/20 => Loss 0.256, Train_accy 96.36:  10%|█         | 2/20 [00:38<03:47, 12.66s/it]
Task 16, Epoch 3/20 => Loss 0.256, Train_accy 96.36:  15%|█▌        | 3/20 [00:38<03:35, 12.67s/it]
Task 16, Epoch 4/20 => Loss 0.166, Train_accy 96.72:  15%|█▌        | 3/20 [00:50<03:35, 12.67s/it]
Task 16, Epoch 4/20 => Loss 0.166, Train_accy 96.72:  20%|██        | 4/20 [00:50<03:22, 12.66s/it]
Task 16, Epoch 5/20 => Loss 0.157, Train_accy 95.76:  20%|██        | 4/20 [01:03<03:22, 12.66s/it]
Task 16, Epoch 5/20 => Loss 0.157, Train_accy 95.76:  25%|██▌       | 5/20 [01:03<03:09, 12.66s/it]
Task 16, Epoch 6/20 => Loss 0.136, Train_accy 96.56:  25%|██▌       | 5/20 [01:15<03:09, 12.66s/it]
Task 16, Epoch 6/20 => Loss 0.136, Train_accy 96.56:  30%|███       | 6/20 [01:15<02:57, 12.66s/it]
Task 16, Epoch 7/20 => Loss 0.112, Train_accy 97.12:  30%|███       | 6/20 [01:28<02:57, 12.66s/it]
Task 16, Epoch 7/20 => Loss 0.112, Train_accy 97.12:  35%|███▌      | 7/20 [01:28<02:44, 12.66s/it]
Task 16, Epoch 8/20 => Loss 0.104, Train_accy 97.00:  35%|███▌      | 7/20 [01:41<02:44, 12.66s/it]
Task 16, Epoch 8/20 => Loss 0.104, Train_accy 97.00:  40%|████      | 8/20 [01:41<02:31, 12.65s/it]
Task 16, Epoch 9/20 => Loss 0.106, Train_accy 96.84:  40%|████      | 8/20 [01:54<02:31, 12.65s/it]
Task 16, Epoch 9/20 => Loss 0.106, Train_accy 96.84:  45%|████▌     | 9/20 [01:54<02:19, 12.69s/it]
Task 16, Epoch 10/20 => Loss 0.093, Train_accy 97.48:  45%|████▌     | 9/20 [02:06<02:19, 12.69s/it]
Task 16, Epoch 10/20 => Loss 0.093, Train_accy 97.48:  50%|█████     | 10/20 [02:06<02:06, 12.70s/it]
Task 16, Epoch 11/20 => Loss 0.090, Train_accy 97.40:  50%|█████     | 10/20 [02:19<02:06, 12.70s/it]
Task 16, Epoch 11/20 => Loss 0.090, Train_accy 97.40:  55%|█████▌    | 11/20 [02:19<01:54, 12.73s/it]
Task 16, Epoch 12/20 => Loss 0.100, Train_accy 97.00:  55%|█████▌    | 11/20 [02:32<01:54, 12.73s/it]
Task 16, Epoch 12/20 => Loss 0.100, Train_accy 97.00:  60%|██████    | 12/20 [02:32<01:42, 12.75s/it]
Task 16, Epoch 13/20 => Loss 0.090, Train_accy 97.32:  60%|██████    | 12/20 [02:45<01:42, 12.75s/it]
Task 16, Epoch 13/20 => Loss 0.090, Train_accy 97.32:  65%|██████▌   | 13/20 [02:45<01:29, 12.75s/it]
Task 16, Epoch 14/20 => Loss 0.081, Train_accy 97.52:  65%|██████▌   | 13/20 [02:57<01:29, 12.75s/it]
Task 16, Epoch 14/20 => Loss 0.081, Train_accy 97.52:  70%|███████   | 14/20 [02:57<01:16, 12.73s/it]
Task 16, Epoch 15/20 => Loss 0.071, Train_accy 98.04:  70%|███████   | 14/20 [03:10<01:16, 12.73s/it]
Task 16, Epoch 15/20 => Loss 0.071, Train_accy 98.04:  75%|███████▌  | 15/20 [03:10<01:03, 12.71s/it]
Task 16, Epoch 16/20 => Loss 0.087, Train_accy 97.64:  75%|███████▌  | 15/20 [03:23<01:03, 12.71s/it]
Task 16, Epoch 16/20 => Loss 0.087, Train_accy 97.64:  80%|████████  | 16/20 [03:23<00:50, 12.70s/it]
Task 16, Epoch 17/20 => Loss 0.073, Train_accy 97.68:  80%|████████  | 16/20 [03:35<00:50, 12.70s/it]
Task 16, Epoch 17/20 => Loss 0.073, Train_accy 97.68:  85%|████████▌ | 17/20 [03:35<00:38, 12.71s/it]
Task 16, Epoch 18/20 => Loss 0.074, Train_accy 97.84:  85%|████████▌ | 17/20 [03:48<00:38, 12.71s/it]
Task 16, Epoch 18/20 => Loss 0.074, Train_accy 97.84:  90%|█████████ | 18/20 [03:48<00:25, 12.72s/it]
Task 16, Epoch 19/20 => Loss 0.093, Train_accy 97.24:  90%|█████████ | 18/20 [04:01<00:25, 12.72s/it]
Task 16, Epoch 19/20 => Loss 0.093, Train_accy 97.24:  95%|█████████▌| 19/20 [04:01<00:12, 12.73s/it]
Task 16, Epoch 20/20 => Loss 0.075, Train_accy 98.00:  95%|█████████▌| 19/20 [04:14<00:12, 12.73s/it]
Task 16, Epoch 20/20 => Loss 0.075, Train_accy 98.00: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
Task 16, Epoch 20/20 => Loss 0.075, Train_accy 98.00: 100%|██████████| 20/20 [04:14<00:00, 12.71s/it]
2024-09-04 16:31:12,497 [ease.py] => Task 16, Epoch 20/20 => Loss 0.075, Train_accy 98.00
2024-09-04 16:38:56,778 [ease.py] => Task correct: 86.68235294117648
2024-09-04 16:38:56,778 [ease.py] => Task acc: 99.25882352941177
2024-09-04 16:38:56,808 [trainer.py] => No NME accuracy.
2024-09-04 16:38:56,808 [trainer.py] => CNN: {'total': 86.53, '00-04': 87.0, '05-09': 84.0, '10-14': 82.0, '15-19': 88.4, '20-24': 97.2, '25-29': 90.4, '30-34': 83.2, '35-39': 87.8, '40-44': 91.6, '45-49': 81.0, '50-54': 82.2, '55-59': 73.6, '60-64': 85.2, '65-69': 93.6, '70-74': 84.8, '75-79': 89.0, '80-84': 90.0, 'old': 86.31, 'new': 90.0}
2024-09-04 16:38:56,809 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4, 89.39, 88.52, 86.96, 86.53]
2024-09-04 16:38:56,809 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69, 98.61, 98.63, 98.58, 98.55]

Average Accuracy (CNN): 92.57
2024-09-04 16:38:56,809 [trainer.py] => Average Accuracy (CNN): 92.57 

2024-09-04 16:38:56,810 [trainer.py] => All params: 87216578
2024-09-04 16:38:56,810 [trainer.py] => Trainable params: 304320
2024-09-04 16:38:56,821 [ease.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.381, Train_accy 68.20:   0%|          | 0/20 [00:12<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.381, Train_accy 68.20:   5%|▌         | 1/20 [00:12<04:01, 12.70s/it]
Task 17, Epoch 2/20 => Loss 0.838, Train_accy 84.68:   5%|▌         | 1/20 [00:25<04:01, 12.70s/it]
Task 17, Epoch 2/20 => Loss 0.838, Train_accy 84.68:  10%|█         | 2/20 [00:25<03:49, 12.75s/it]
Task 17, Epoch 3/20 => Loss 0.522, Train_accy 87.76:  10%|█         | 2/20 [00:38<03:49, 12.75s/it]
Task 17, Epoch 3/20 => Loss 0.522, Train_accy 87.76:  15%|█▌        | 3/20 [00:38<03:36, 12.74s/it]
Task 17, Epoch 4/20 => Loss 0.366, Train_accy 90.04:  15%|█▌        | 3/20 [00:50<03:36, 12.74s/it]
Task 17, Epoch 4/20 => Loss 0.366, Train_accy 90.04:  20%|██        | 4/20 [00:50<03:23, 12.73s/it]
Task 17, Epoch 5/20 => Loss 0.308, Train_accy 90.28:  20%|██        | 4/20 [01:03<03:23, 12.73s/it]
Task 17, Epoch 5/20 => Loss 0.308, Train_accy 90.28:  25%|██▌       | 5/20 [01:03<03:10, 12.71s/it]
Task 17, Epoch 6/20 => Loss 0.259, Train_accy 92.12:  25%|██▌       | 5/20 [01:16<03:10, 12.71s/it]
Task 17, Epoch 6/20 => Loss 0.259, Train_accy 92.12:  30%|███       | 6/20 [01:16<02:57, 12.71s/it]
Task 17, Epoch 7/20 => Loss 0.261, Train_accy 91.32:  30%|███       | 6/20 [01:29<02:57, 12.71s/it]
Task 17, Epoch 7/20 => Loss 0.261, Train_accy 91.32:  35%|███▌      | 7/20 [01:29<02:45, 12.72s/it]
Task 17, Epoch 8/20 => Loss 0.236, Train_accy 92.08:  35%|███▌      | 7/20 [01:41<02:45, 12.72s/it]
Task 17, Epoch 8/20 => Loss 0.236, Train_accy 92.08:  40%|████      | 8/20 [01:41<02:32, 12.73s/it]
Task 17, Epoch 9/20 => Loss 0.234, Train_accy 92.64:  40%|████      | 8/20 [01:54<02:32, 12.73s/it]
Task 17, Epoch 9/20 => Loss 0.234, Train_accy 92.64:  45%|████▌     | 9/20 [01:54<02:19, 12.72s/it]
Task 17, Epoch 10/20 => Loss 0.222, Train_accy 92.64:  45%|████▌     | 9/20 [02:07<02:19, 12.72s/it]
Task 17, Epoch 10/20 => Loss 0.222, Train_accy 92.64:  50%|█████     | 10/20 [02:07<02:07, 12.70s/it]
Task 17, Epoch 11/20 => Loss 0.221, Train_accy 91.92:  50%|█████     | 10/20 [02:19<02:07, 12.70s/it]
Task 17, Epoch 11/20 => Loss 0.221, Train_accy 91.92:  55%|█████▌    | 11/20 [02:19<01:54, 12.71s/it]
Task 17, Epoch 12/20 => Loss 0.227, Train_accy 92.96:  55%|█████▌    | 11/20 [02:32<01:54, 12.71s/it]
Task 17, Epoch 12/20 => Loss 0.227, Train_accy 92.96:  60%|██████    | 12/20 [02:32<01:41, 12.72s/it]
Task 17, Epoch 13/20 => Loss 0.218, Train_accy 93.04:  60%|██████    | 12/20 [02:45<01:41, 12.72s/it]
Task 17, Epoch 13/20 => Loss 0.218, Train_accy 93.04:  65%|██████▌   | 13/20 [02:45<01:29, 12.72s/it]
Task 17, Epoch 14/20 => Loss 0.202, Train_accy 93.00:  65%|██████▌   | 13/20 [02:58<01:29, 12.72s/it]
Task 17, Epoch 14/20 => Loss 0.202, Train_accy 93.00:  70%|███████   | 14/20 [02:58<01:16, 12.71s/it]
Task 17, Epoch 15/20 => Loss 0.208, Train_accy 93.20:  70%|███████   | 14/20 [03:10<01:16, 12.71s/it]
Task 17, Epoch 15/20 => Loss 0.208, Train_accy 93.20:  75%|███████▌  | 15/20 [03:10<01:03, 12.73s/it]
Task 17, Epoch 16/20 => Loss 0.220, Train_accy 92.80:  75%|███████▌  | 15/20 [03:23<01:03, 12.73s/it]
Task 17, Epoch 16/20 => Loss 0.220, Train_accy 92.80:  80%|████████  | 16/20 [03:23<00:50, 12.72s/it]
Task 17, Epoch 17/20 => Loss 0.199, Train_accy 93.04:  80%|████████  | 16/20 [03:36<00:50, 12.72s/it]
Task 17, Epoch 17/20 => Loss 0.199, Train_accy 93.04:  85%|████████▌ | 17/20 [03:36<00:38, 12.72s/it]
Task 17, Epoch 18/20 => Loss 0.187, Train_accy 93.68:  85%|████████▌ | 17/20 [03:49<00:38, 12.72s/it]
Task 17, Epoch 18/20 => Loss 0.187, Train_accy 93.68:  90%|█████████ | 18/20 [03:49<00:25, 12.75s/it]
Task 17, Epoch 19/20 => Loss 0.192, Train_accy 93.64:  90%|█████████ | 18/20 [04:01<00:25, 12.75s/it]
Task 17, Epoch 19/20 => Loss 0.192, Train_accy 93.64:  95%|█████████▌| 19/20 [04:01<00:12, 12.74s/it]
Task 17, Epoch 20/20 => Loss 0.200, Train_accy 93.20:  95%|█████████▌| 19/20 [04:14<00:12, 12.74s/it]
Task 17, Epoch 20/20 => Loss 0.200, Train_accy 93.20: 100%|██████████| 20/20 [04:14<00:00, 12.75s/it]
Task 17, Epoch 20/20 => Loss 0.200, Train_accy 93.20: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
2024-09-04 16:43:11,418 [ease.py] => Task 17, Epoch 20/20 => Loss 0.200, Train_accy 93.20
2024-09-04 16:51:46,661 [ease.py] => Task correct: 86.54444444444445
2024-09-04 16:51:46,661 [ease.py] => Task acc: 99.17777777777778
2024-09-04 16:51:46,687 [trainer.py] => No NME accuracy.
2024-09-04 16:51:46,688 [trainer.py] => CNN: {'total': 86.37, '00-04': 86.6, '05-09': 84.2, '10-14': 81.4, '15-19': 88.4, '20-24': 97.4, '25-29': 90.4, '30-34': 83.0, '35-39': 87.6, '40-44': 91.6, '45-49': 80.4, '50-54': 82.0, '55-59': 73.6, '60-64': 85.0, '65-69': 93.6, '70-74': 85.0, '75-79': 88.2, '80-84': 90.4, '85-89': 85.8, 'old': 86.4, 'new': 85.8}
2024-09-04 16:51:46,688 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4, 89.39, 88.52, 86.96, 86.53, 86.37]
2024-09-04 16:51:46,688 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69, 98.61, 98.63, 98.58, 98.55, 98.36]

Average Accuracy (CNN): 92.22
2024-09-04 16:51:46,688 [trainer.py] => Average Accuracy (CNN): 92.22 

2024-09-04 16:51:46,689 [trainer.py] => All params: 87350978
2024-09-04 16:51:46,689 [trainer.py] => Trainable params: 304320
2024-09-04 16:51:46,701 [ease.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.284, Train_accy 80.40:   0%|          | 0/20 [00:12<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.284, Train_accy 80.40:   5%|▌         | 1/20 [00:12<04:02, 12.74s/it]
Task 18, Epoch 2/20 => Loss 0.621, Train_accy 91.76:   5%|▌         | 1/20 [00:25<04:02, 12.74s/it]
Task 18, Epoch 2/20 => Loss 0.621, Train_accy 91.76:  10%|█         | 2/20 [00:25<03:49, 12.76s/it]
Task 18, Epoch 3/20 => Loss 0.306, Train_accy 94.04:  10%|█         | 2/20 [00:38<03:49, 12.76s/it]
Task 18, Epoch 3/20 => Loss 0.306, Train_accy 94.04:  15%|█▌        | 3/20 [00:38<03:36, 12.74s/it]
Task 18, Epoch 4/20 => Loss 0.219, Train_accy 93.92:  15%|█▌        | 3/20 [00:50<03:36, 12.74s/it]
Task 18, Epoch 4/20 => Loss 0.219, Train_accy 93.92:  20%|██        | 4/20 [00:50<03:23, 12.74s/it]
Task 18, Epoch 5/20 => Loss 0.177, Train_accy 95.32:  20%|██        | 4/20 [01:03<03:23, 12.74s/it]
Task 18, Epoch 5/20 => Loss 0.177, Train_accy 95.32:  25%|██▌       | 5/20 [01:03<03:11, 12.75s/it]
Task 18, Epoch 6/20 => Loss 0.167, Train_accy 95.32:  25%|██▌       | 5/20 [01:16<03:11, 12.75s/it]
Task 18, Epoch 6/20 => Loss 0.167, Train_accy 95.32:  30%|███       | 6/20 [01:16<02:58, 12.73s/it]
Task 18, Epoch 7/20 => Loss 0.152, Train_accy 95.24:  30%|███       | 6/20 [01:29<02:58, 12.73s/it]
Task 18, Epoch 7/20 => Loss 0.152, Train_accy 95.24:  35%|███▌      | 7/20 [01:29<02:45, 12.76s/it]
Task 18, Epoch 8/20 => Loss 0.159, Train_accy 95.08:  35%|███▌      | 7/20 [01:42<02:45, 12.76s/it]
Task 18, Epoch 8/20 => Loss 0.159, Train_accy 95.08:  40%|████      | 8/20 [01:42<02:33, 12.77s/it]
Task 18, Epoch 9/20 => Loss 0.135, Train_accy 95.68:  40%|████      | 8/20 [01:54<02:33, 12.77s/it]
Task 18, Epoch 9/20 => Loss 0.135, Train_accy 95.68:  45%|████▌     | 9/20 [01:54<02:20, 12.76s/it]
Task 18, Epoch 10/20 => Loss 0.128, Train_accy 95.56:  45%|████▌     | 9/20 [02:07<02:20, 12.76s/it]
Task 18, Epoch 10/20 => Loss 0.128, Train_accy 95.56:  50%|█████     | 10/20 [02:07<02:07, 12.76s/it]
Task 18, Epoch 11/20 => Loss 0.121, Train_accy 96.12:  50%|█████     | 10/20 [02:20<02:07, 12.76s/it]
Task 18, Epoch 11/20 => Loss 0.121, Train_accy 96.12:  55%|█████▌    | 11/20 [02:20<01:55, 12.78s/it]
Task 18, Epoch 12/20 => Loss 0.128, Train_accy 95.40:  55%|█████▌    | 11/20 [02:33<01:55, 12.78s/it]
Task 18, Epoch 12/20 => Loss 0.128, Train_accy 95.40:  60%|██████    | 12/20 [02:33<01:42, 12.77s/it]
Task 18, Epoch 13/20 => Loss 0.122, Train_accy 95.80:  60%|██████    | 12/20 [02:45<01:42, 12.77s/it]
Task 18, Epoch 13/20 => Loss 0.122, Train_accy 95.80:  65%|██████▌   | 13/20 [02:45<01:29, 12.75s/it]
Task 18, Epoch 14/20 => Loss 0.107, Train_accy 96.44:  65%|██████▌   | 13/20 [02:58<01:29, 12.75s/it]
Task 18, Epoch 14/20 => Loss 0.107, Train_accy 96.44:  70%|███████   | 14/20 [02:58<01:16, 12.73s/it]
Task 18, Epoch 15/20 => Loss 0.114, Train_accy 96.08:  70%|███████   | 14/20 [03:11<01:16, 12.73s/it]
Task 18, Epoch 15/20 => Loss 0.114, Train_accy 96.08:  75%|███████▌  | 15/20 [03:11<01:03, 12.73s/it]
Task 18, Epoch 16/20 => Loss 0.125, Train_accy 95.72:  75%|███████▌  | 15/20 [03:23<01:03, 12.73s/it]
Task 18, Epoch 16/20 => Loss 0.125, Train_accy 95.72:  80%|████████  | 16/20 [03:23<00:50, 12.73s/it]
Task 18, Epoch 17/20 => Loss 0.109, Train_accy 96.16:  80%|████████  | 16/20 [03:36<00:50, 12.73s/it]
Task 18, Epoch 17/20 => Loss 0.109, Train_accy 96.16:  85%|████████▌ | 17/20 [03:36<00:38, 12.73s/it]
Task 18, Epoch 18/20 => Loss 0.114, Train_accy 96.28:  85%|████████▌ | 17/20 [03:49<00:38, 12.73s/it]
Task 18, Epoch 18/20 => Loss 0.114, Train_accy 96.28:  90%|█████████ | 18/20 [03:49<00:25, 12.74s/it]
Task 18, Epoch 19/20 => Loss 0.113, Train_accy 96.08:  90%|█████████ | 18/20 [04:02<00:25, 12.74s/it]
Task 18, Epoch 19/20 => Loss 0.113, Train_accy 96.08:  95%|█████████▌| 19/20 [04:02<00:12, 12.76s/it]
Task 18, Epoch 20/20 => Loss 0.112, Train_accy 95.96:  95%|█████████▌| 19/20 [04:14<00:12, 12.76s/it]
Task 18, Epoch 20/20 => Loss 0.112, Train_accy 95.96: 100%|██████████| 20/20 [04:14<00:00, 12.74s/it]
Task 18, Epoch 20/20 => Loss 0.112, Train_accy 95.96: 100%|██████████| 20/20 [04:14<00:00, 12.75s/it]
2024-09-04 16:56:01,692 [ease.py] => Task 18, Epoch 20/20 => Loss 0.112, Train_accy 95.96
2024-09-04 17:05:29,083 [ease.py] => Task correct: 86.58947368421053
2024-09-04 17:05:29,083 [ease.py] => Task acc: 99.21052631578948
2024-09-04 17:05:29,108 [trainer.py] => No NME accuracy.
2024-09-04 17:05:29,108 [trainer.py] => CNN: {'total': 86.42, '00-04': 85.6, '05-09': 83.6, '10-14': 81.4, '15-19': 88.2, '20-24': 96.6, '25-29': 90.4, '30-34': 82.8, '35-39': 87.4, '40-44': 90.8, '45-49': 80.4, '50-54': 81.8, '55-59': 73.6, '60-64': 85.0, '65-69': 93.2, '70-74': 84.6, '75-79': 88.2, '80-84': 90.2, '85-89': 85.6, '90-94': 92.6, 'old': 86.08, 'new': 92.6}
2024-09-04 17:05:29,108 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4, 89.39, 88.52, 86.96, 86.53, 86.37, 86.42]
2024-09-04 17:05:29,108 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69, 98.61, 98.63, 98.58, 98.55, 98.36, 98.35]

Average Accuracy (CNN): 91.92
2024-09-04 17:05:29,108 [trainer.py] => Average Accuracy (CNN): 91.92 

2024-09-04 17:05:29,109 [trainer.py] => All params: 87493058
2024-09-04 17:05:29,110 [trainer.py] => Trainable params: 304320
2024-09-04 17:05:29,122 [ease.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.313, Train_accy 75.76:   0%|          | 0/20 [00:12<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.313, Train_accy 75.76:   5%|▌         | 1/20 [00:12<04:01, 12.73s/it]
Task 19, Epoch 2/20 => Loss 0.709, Train_accy 89.28:   5%|▌         | 1/20 [00:25<04:01, 12.73s/it]
Task 19, Epoch 2/20 => Loss 0.709, Train_accy 89.28:  10%|█         | 2/20 [00:25<03:48, 12.71s/it]
Task 19, Epoch 3/20 => Loss 0.425, Train_accy 90.12:  10%|█         | 2/20 [00:38<03:48, 12.71s/it]
Task 19, Epoch 3/20 => Loss 0.425, Train_accy 90.12:  15%|█▌        | 3/20 [00:38<03:36, 12.74s/it]
Task 19, Epoch 4/20 => Loss 0.302, Train_accy 92.12:  15%|█▌        | 3/20 [00:50<03:36, 12.74s/it]
Task 19, Epoch 4/20 => Loss 0.302, Train_accy 92.12:  20%|██        | 4/20 [00:50<03:23, 12.73s/it]
Task 19, Epoch 5/20 => Loss 0.251, Train_accy 92.92:  20%|██        | 4/20 [01:03<03:23, 12.73s/it]
Task 19, Epoch 5/20 => Loss 0.251, Train_accy 92.92:  25%|██▌       | 5/20 [01:03<03:10, 12.72s/it]
Task 19, Epoch 6/20 => Loss 0.222, Train_accy 93.28:  25%|██▌       | 5/20 [01:16<03:10, 12.72s/it]
Task 19, Epoch 6/20 => Loss 0.222, Train_accy 93.28:  30%|███       | 6/20 [01:16<02:58, 12.72s/it]
Task 19, Epoch 7/20 => Loss 0.227, Train_accy 93.80:  30%|███       | 6/20 [01:29<02:58, 12.72s/it]
Task 19, Epoch 7/20 => Loss 0.227, Train_accy 93.80:  35%|███▌      | 7/20 [01:29<02:45, 12.73s/it]
Task 19, Epoch 8/20 => Loss 0.199, Train_accy 93.88:  35%|███▌      | 7/20 [01:41<02:45, 12.73s/it]
Task 19, Epoch 8/20 => Loss 0.199, Train_accy 93.88:  40%|████      | 8/20 [01:41<02:32, 12.73s/it]
Task 19, Epoch 9/20 => Loss 0.185, Train_accy 94.28:  40%|████      | 8/20 [01:54<02:32, 12.73s/it]
Task 19, Epoch 9/20 => Loss 0.185, Train_accy 94.28:  45%|████▌     | 9/20 [01:54<02:20, 12.75s/it]
Task 19, Epoch 10/20 => Loss 0.185, Train_accy 94.12:  45%|████▌     | 9/20 [02:07<02:20, 12.75s/it]
Task 19, Epoch 10/20 => Loss 0.185, Train_accy 94.12:  50%|█████     | 10/20 [02:07<02:07, 12.74s/it]
Task 19, Epoch 11/20 => Loss 0.168, Train_accy 94.68:  50%|█████     | 10/20 [02:20<02:07, 12.74s/it]
Task 19, Epoch 11/20 => Loss 0.168, Train_accy 94.68:  55%|█████▌    | 11/20 [02:20<01:54, 12.76s/it]
Task 19, Epoch 12/20 => Loss 0.171, Train_accy 94.32:  55%|█████▌    | 11/20 [02:32<01:54, 12.76s/it]
Task 19, Epoch 12/20 => Loss 0.171, Train_accy 94.32:  60%|██████    | 12/20 [02:32<01:41, 12.75s/it]
Task 19, Epoch 13/20 => Loss 0.167, Train_accy 94.52:  60%|██████    | 12/20 [02:45<01:41, 12.75s/it]
Task 19, Epoch 13/20 => Loss 0.167, Train_accy 94.52:  65%|██████▌   | 13/20 [02:45<01:29, 12.76s/it]
Task 19, Epoch 14/20 => Loss 0.153, Train_accy 95.40:  65%|██████▌   | 13/20 [02:58<01:29, 12.76s/it]
Task 19, Epoch 14/20 => Loss 0.153, Train_accy 95.40:  70%|███████   | 14/20 [02:58<01:16, 12.76s/it]
Task 19, Epoch 15/20 => Loss 0.140, Train_accy 95.64:  70%|███████   | 14/20 [03:11<01:16, 12.76s/it]
Task 19, Epoch 15/20 => Loss 0.140, Train_accy 95.64:  75%|███████▌  | 15/20 [03:11<01:03, 12.76s/it]
Task 19, Epoch 16/20 => Loss 0.166, Train_accy 94.32:  75%|███████▌  | 15/20 [03:23<01:03, 12.76s/it]
Task 19, Epoch 16/20 => Loss 0.166, Train_accy 94.32:  80%|████████  | 16/20 [03:23<00:51, 12.77s/it]
Task 19, Epoch 17/20 => Loss 0.158, Train_accy 95.36:  80%|████████  | 16/20 [03:36<00:51, 12.77s/it]
Task 19, Epoch 17/20 => Loss 0.158, Train_accy 95.36:  85%|████████▌ | 17/20 [03:36<00:38, 12.77s/it]
Task 19, Epoch 18/20 => Loss 0.164, Train_accy 94.36:  85%|████████▌ | 17/20 [03:49<00:38, 12.77s/it]
Task 19, Epoch 18/20 => Loss 0.164, Train_accy 94.36:  90%|█████████ | 18/20 [03:49<00:25, 12.75s/it]
Task 19, Epoch 19/20 => Loss 0.143, Train_accy 95.44:  90%|█████████ | 18/20 [04:02<00:25, 12.75s/it]
Task 19, Epoch 19/20 => Loss 0.143, Train_accy 95.44:  95%|█████████▌| 19/20 [04:02<00:12, 12.75s/it]
Task 19, Epoch 20/20 => Loss 0.138, Train_accy 95.32:  95%|█████████▌| 19/20 [04:14<00:12, 12.75s/it]
Task 19, Epoch 20/20 => Loss 0.138, Train_accy 95.32: 100%|██████████| 20/20 [04:14<00:00, 12.77s/it]
Task 19, Epoch 20/20 => Loss 0.138, Train_accy 95.32: 100%|██████████| 20/20 [04:14<00:00, 12.75s/it]
2024-09-04 17:09:44,135 [ease.py] => Task 19, Epoch 20/20 => Loss 0.138, Train_accy 95.32
2024-09-04 17:20:06,631 [ease.py] => Task correct: 86.03
2024-09-04 17:20:06,631 [ease.py] => Task acc: 99.14
2024-09-04 17:20:06,666 [trainer.py] => No NME accuracy.
2024-09-04 17:20:06,666 [trainer.py] => CNN: {'total': 85.83, '00-04': 84.4, '05-09': 83.6, '10-14': 81.0, '15-19': 88.2, '20-24': 96.6, '25-29': 90.2, '30-34': 83.0, '35-39': 87.4, '40-44': 90.6, '45-49': 80.4, '50-54': 81.6, '55-59': 73.6, '60-64': 84.8, '65-69': 93.2, '70-74': 84.2, '75-79': 86.4, '80-84': 90.0, '85-89': 85.2, '90-94': 92.0, '95-99': 80.2, 'old': 86.13, 'new': 80.2}
2024-09-04 17:20:06,666 [trainer.py] => CNN top1 curve: [99.2, 98.2, 97.27, 96.35, 96.28, 94.93, 93.6, 93.15, 92.38, 91.16, 90.25, 90.08, 89.4, 89.39, 88.52, 86.96, 86.53, 86.37, 86.42, 85.83]
2024-09-04 17:20:06,666 [trainer.py] => CNN top5 curve: [100.0, 99.9, 99.8, 99.5, 99.44, 99.47, 99.46, 99.25, 99.13, 98.98, 98.91, 98.67, 98.69, 98.61, 98.63, 98.58, 98.55, 98.36, 98.35, 98.15]

Average Accuracy (CNN): 91.61
2024-09-04 17:20:06,666 [trainer.py] => Average Accuracy (CNN): 91.61 

Accuracy Matrix (CNN):
[[99.2 98.2 98.  98.  98.  97.  97.  94.  92.2 92.  89.8 89.4 89.4 87.6
  87.4 87.6 87.  86.6 85.6 84.4]
 [ 0.  98.2 96.8 95.8 95.2 90.  89.8 89.4 89.6 88.2 88.4 88.2 87.2 87.4
  87.  85.8 84.  84.2 83.6 83.6]
 [ 0.   0.  97.  96.8 95.2 94.  94.  93.2 88.2 85.8 85.6 85.2 84.4 83.4
  82.8 83.  82.  81.4 81.4 81. ]
 [ 0.   0.   0.  94.8 94.8 93.4 91.6 91.  90.4 89.8 89.8 89.8 88.4 88.4
  88.4 88.4 88.4 88.4 88.2 88.2]
 [ 0.   0.   0.   0.  98.2 98.2 98.  97.6 97.6 97.4 97.2 97.  97.  97.
  97.  97.  97.2 97.4 96.6 96.6]
 [ 0.   0.   0.   0.   0.  97.  97.  96.4 96.4 92.8 91.8 91.6 91.4 91.2
  91.2 91.2 90.4 90.4 90.4 90.2]
 [ 0.   0.   0.   0.   0.   0.  87.8 87.6 86.8 86.  85.  85.  84.6 84.2
  84.2 84.  83.2 83.  82.8 83. ]
 [ 0.   0.   0.   0.   0.   0.   0.  96.  95.4 90.4 89.4 89.4 88.8 88.6
  88.4 87.6 87.8 87.6 87.4 87.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  94.8 94.4 93.2 93.  93.  92.8
  92.6 92.  91.6 91.6 90.8 90.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  94.8 92.8 92.6 92.4 91.8
  91.6 83.  81.  80.4 80.4 80.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  89.8 89.8 89.8 89.4
  89.4 83.4 82.2 82.  81.8 81.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  90.  81.8 81.6
  77.8 74.6 73.6 73.6 73.6 73.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  94.  93.
  87.4 86.4 85.2 85.  85.  84.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  95.
  94.2 93.6 93.6 93.6 93.2 93.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  88.4 85.  84.8 85.  84.6 84.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  88.8 89.  88.2 88.2 86.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  90.  90.4 90.2 90. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  85.8 85.6 85.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  92.6 92. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  80.2]]
2024-09-04 17:20:06,670 [trainer.py] => Forgetting (CNN): 7.178947368421053
2024-09-04 17:20:09,428 [trainer.py] => config: ./exps/ease_cifar_B50_Inc5.json
2024-09-04 17:20:09,439 [trainer.py] => prefix:  
2024-09-04 17:20:09,439 [trainer.py] => dataset: cifar224
2024-09-04 17:20:09,439 [trainer.py] => memory_size: 0
2024-09-04 17:20:09,439 [trainer.py] => memory_per_class: 0
2024-09-04 17:20:09,439 [trainer.py] => fixed_memory: False
2024-09-04 17:20:09,439 [trainer.py] => shuffle: True
2024-09-04 17:20:09,439 [trainer.py] => init_cls: 50
2024-09-04 17:20:09,439 [trainer.py] => increment: 10
2024-09-04 17:20:09,440 [trainer.py] => model_name: ease
2024-09-04 17:20:09,440 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-04 17:20:09,440 [trainer.py] => device: [device(type='cuda', index=3)]
2024-09-04 17:20:09,440 [trainer.py] => seed: 1993
2024-09-04 17:20:09,440 [trainer.py] => init_epochs: 20
2024-09-04 17:20:09,440 [trainer.py] => init_lr: 0.025
2024-09-04 17:20:09,440 [trainer.py] => later_epochs: 20
2024-09-04 17:20:09,440 [trainer.py] => later_lr: 0.025
2024-09-04 17:20:09,440 [trainer.py] => batch_size: 48
2024-09-04 17:20:09,440 [trainer.py] => weight_decay: 0.0005
2024-09-04 17:20:09,440 [trainer.py] => min_lr: 0
2024-09-04 17:20:09,440 [trainer.py] => optimizer: sgd
2024-09-04 17:20:09,440 [trainer.py] => scheduler: cosine
2024-09-04 17:20:09,440 [trainer.py] => pretrained: True
2024-09-04 17:20:09,440 [trainer.py] => vpt_type: Deep
2024-09-04 17:20:09,440 [trainer.py] => prompt_token_num: 5
2024-09-04 17:20:09,440 [trainer.py] => ffn_num: 16
2024-09-04 17:20:09,440 [trainer.py] => use_diagonal: False
2024-09-04 17:20:09,440 [trainer.py] => recalc_sim: True
2024-09-04 17:20:09,440 [trainer.py] => alpha: 0.1
2024-09-04 17:20:09,440 [trainer.py] => use_init_ptm: False
2024-09-04 17:20:09,440 [trainer.py] => beta: 0
2024-09-04 17:20:09,440 [trainer.py] => use_old_data: False
2024-09-04 17:20:09,440 [trainer.py] => use_reweight: True
2024-09-04 17:20:09,440 [trainer.py] => moni_adam: False
2024-09-04 17:20:09,440 [trainer.py] => adapter_num: -1
2024-09-04 17:20:10,555 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-04 17:20:13,707 [trainer.py] => All params: 86102976
2024-09-04 17:20:13,708 [trainer.py] => Trainable params: 304320
2024-09-04 17:20:13,716 [ease.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.631, Train_accy 68.26:   0%|          | 0/20 [02:04<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.631, Train_accy 68.26:   5%|▌         | 1/20 [02:04<39:20, 124.24s/it]
Task 0, Epoch 2/20 => Loss 0.634, Train_accy 82.68:   5%|▌         | 1/20 [04:09<39:20, 124.24s/it]
Task 0, Epoch 2/20 => Loss 0.634, Train_accy 82.68:  10%|█         | 2/20 [04:09<37:24, 124.68s/it]
Task 0, Epoch 3/20 => Loss 0.588, Train_accy 83.84:  10%|█         | 2/20 [06:14<37:24, 124.68s/it]
Task 0, Epoch 3/20 => Loss 0.588, Train_accy 83.84:  15%|█▌        | 3/20 [06:14<35:22, 124.83s/it]
Task 0, Epoch 4/20 => Loss 0.557, Train_accy 84.54:  15%|█▌        | 3/20 [08:18<35:22, 124.83s/it]
Task 0, Epoch 4/20 => Loss 0.557, Train_accy 84.54:  20%|██        | 4/20 [08:18<33:14, 124.65s/it]
Task 0, Epoch 5/20 => Loss 0.549, Train_accy 84.84:  20%|██        | 4/20 [10:23<33:14, 124.65s/it]
Task 0, Epoch 5/20 => Loss 0.549, Train_accy 84.84:  25%|██▌       | 5/20 [10:23<31:09, 124.66s/it]
Task 0, Epoch 6/20 => Loss 0.542, Train_accy 84.97:  25%|██▌       | 5/20 [12:27<31:09, 124.66s/it]
Task 0, Epoch 6/20 => Loss 0.542, Train_accy 84.97:  30%|███       | 6/20 [12:27<29:04, 124.62s/it]
Task 0, Epoch 7/20 => Loss 0.531, Train_accy 85.16:  30%|███       | 6/20 [14:32<29:04, 124.62s/it]
Task 0, Epoch 7/20 => Loss 0.531, Train_accy 85.16:  35%|███▌      | 7/20 [14:32<27:01, 124.72s/it]
Task 0, Epoch 8/20 => Loss 0.527, Train_accy 85.32:  35%|███▌      | 7/20 [16:37<27:01, 124.72s/it]
Task 0, Epoch 8/20 => Loss 0.527, Train_accy 85.32:  40%|████      | 8/20 [16:37<24:58, 124.87s/it]
Task 0, Epoch 9/20 => Loss 0.516, Train_accy 85.47:  40%|████      | 8/20 [18:42<24:58, 124.87s/it]
Task 0, Epoch 9/20 => Loss 0.516, Train_accy 85.47:  45%|████▌     | 9/20 [18:42<22:53, 124.82s/it]
Task 0, Epoch 10/20 => Loss 0.511, Train_accy 85.81:  45%|████▌     | 9/20 [20:47<22:53, 124.82s/it]
Task 0, Epoch 10/20 => Loss 0.511, Train_accy 85.81:  50%|█████     | 10/20 [20:47<20:47, 124.79s/it]
Task 0, Epoch 11/20 => Loss 0.507, Train_accy 85.85:  50%|█████     | 10/20 [22:51<20:47, 124.79s/it]
Task 0, Epoch 11/20 => Loss 0.507, Train_accy 85.85:  55%|█████▌    | 11/20 [22:51<18:42, 124.73s/it]
Task 0, Epoch 12/20 => Loss 0.493, Train_accy 86.09:  55%|█████▌    | 11/20 [24:56<18:42, 124.73s/it]
Task 0, Epoch 12/20 => Loss 0.493, Train_accy 86.09:  60%|██████    | 12/20 [24:56<16:38, 124.77s/it]
Task 0, Epoch 13/20 => Loss 0.495, Train_accy 86.10:  60%|██████    | 12/20 [27:01<16:38, 124.77s/it]
Task 0, Epoch 13/20 => Loss 0.495, Train_accy 86.10:  65%|██████▌   | 13/20 [27:01<14:32, 124.68s/it]
Task 0, Epoch 14/20 => Loss 0.490, Train_accy 86.06:  65%|██████▌   | 13/20 [29:06<14:32, 124.68s/it]
Task 0, Epoch 14/20 => Loss 0.490, Train_accy 86.06:  70%|███████   | 14/20 [29:06<12:28, 124.73s/it]
Task 0, Epoch 15/20 => Loss 0.482, Train_accy 86.44:  70%|███████   | 14/20 [31:10<12:28, 124.73s/it]
Task 0, Epoch 15/20 => Loss 0.482, Train_accy 86.44:  75%|███████▌  | 15/20 [31:10<10:23, 124.76s/it]
Task 0, Epoch 16/20 => Loss 0.477, Train_accy 86.51:  75%|███████▌  | 15/20 [33:15<10:23, 124.76s/it]
Task 0, Epoch 16/20 => Loss 0.477, Train_accy 86.51:  80%|████████  | 16/20 [33:15<08:19, 124.83s/it]
Task 0, Epoch 17/20 => Loss 0.468, Train_accy 86.74:  80%|████████  | 16/20 [35:20<08:19, 124.83s/it]
Task 0, Epoch 17/20 => Loss 0.468, Train_accy 86.74:  85%|████████▌ | 17/20 [35:20<06:14, 124.80s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 86.69:  85%|████████▌ | 17/20 [37:25<06:14, 124.80s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 86.69:  90%|█████████ | 18/20 [37:25<04:09, 124.74s/it]
Task 0, Epoch 19/20 => Loss 0.457, Train_accy 87.02:  90%|█████████ | 18/20 [39:30<04:09, 124.74s/it]
Task 0, Epoch 19/20 => Loss 0.457, Train_accy 87.02:  95%|█████████▌| 19/20 [39:30<02:04, 124.81s/it]
Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08:  95%|█████████▌| 19/20 [41:34<02:04, 124.81s/it]
Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08: 100%|██████████| 20/20 [41:34<00:00, 124.73s/it]
Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08: 100%|██████████| 20/20 [41:34<00:00, 124.74s/it]
2024-09-04 18:01:48,658 [ease.py] => Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08
2024-09-04 18:03:08,204 [ease.py] => Task correct: 95.5
2024-09-04 18:03:08,204 [ease.py] => Task acc: 97.92
2024-09-04 18:03:08,218 [trainer.py] => No NME accuracy.
2024-09-04 18:03:08,218 [trainer.py] => CNN: {'total': 94.84, '00-49': 94.84, 'old': 0, 'new': 94.84}
2024-09-04 18:03:08,218 [trainer.py] => CNN top1 curve: [94.84]
2024-09-04 18:03:08,218 [trainer.py] => CNN top5 curve: [99.62]

Average Accuracy (CNN): 94.84
2024-09-04 18:03:08,218 [trainer.py] => Average Accuracy (CNN): 94.84 

2024-09-04 18:03:08,219 [trainer.py] => All params: 86179778
2024-09-04 18:03:08,220 [trainer.py] => Trainable params: 304320
2024-09-04 18:03:08,222 [ease.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.636, Train_accy 73.72:   0%|          | 0/20 [00:25<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.636, Train_accy 73.72:   5%|▌         | 1/20 [00:25<08:01, 25.32s/it]
Task 1, Epoch 2/20 => Loss 0.490, Train_accy 88.98:   5%|▌         | 1/20 [00:50<08:01, 25.32s/it]
Task 1, Epoch 2/20 => Loss 0.490, Train_accy 88.98:  10%|█         | 2/20 [00:50<07:35, 25.28s/it]
Task 1, Epoch 3/20 => Loss 0.338, Train_accy 90.88:  10%|█         | 2/20 [01:16<07:35, 25.28s/it]
Task 1, Epoch 3/20 => Loss 0.338, Train_accy 90.88:  15%|█▌        | 3/20 [01:16<07:11, 25.36s/it]
Task 1, Epoch 4/20 => Loss 0.287, Train_accy 91.62:  15%|█▌        | 3/20 [01:41<07:11, 25.36s/it]
Task 1, Epoch 4/20 => Loss 0.287, Train_accy 91.62:  20%|██        | 4/20 [01:41<06:45, 25.33s/it]
Task 1, Epoch 5/20 => Loss 0.264, Train_accy 91.90:  20%|██        | 4/20 [02:06<06:45, 25.33s/it]
Task 1, Epoch 5/20 => Loss 0.264, Train_accy 91.90:  25%|██▌       | 5/20 [02:06<06:20, 25.39s/it]
Task 1, Epoch 6/20 => Loss 0.256, Train_accy 92.08:  25%|██▌       | 5/20 [02:32<06:20, 25.39s/it]
Task 1, Epoch 6/20 => Loss 0.256, Train_accy 92.08:  30%|███       | 6/20 [02:32<05:55, 25.42s/it]
Task 1, Epoch 7/20 => Loss 0.233, Train_accy 93.10:  30%|███       | 6/20 [02:57<05:55, 25.42s/it]
Task 1, Epoch 7/20 => Loss 0.233, Train_accy 93.10:  35%|███▌      | 7/20 [02:57<05:31, 25.47s/it]
Task 1, Epoch 8/20 => Loss 0.232, Train_accy 92.72:  35%|███▌      | 7/20 [03:23<05:31, 25.47s/it]
Task 1, Epoch 8/20 => Loss 0.232, Train_accy 92.72:  40%|████      | 8/20 [03:23<05:05, 25.49s/it]
Task 1, Epoch 9/20 => Loss 0.228, Train_accy 92.36:  40%|████      | 8/20 [03:48<05:05, 25.49s/it]
Task 1, Epoch 9/20 => Loss 0.228, Train_accy 92.36:  45%|████▌     | 9/20 [03:48<04:40, 25.47s/it]
Task 1, Epoch 10/20 => Loss 0.216, Train_accy 93.24:  45%|████▌     | 9/20 [04:14<04:40, 25.47s/it]
Task 1, Epoch 10/20 => Loss 0.216, Train_accy 93.24:  50%|█████     | 10/20 [04:14<04:14, 25.47s/it]
Task 1, Epoch 11/20 => Loss 0.219, Train_accy 93.18:  50%|█████     | 10/20 [04:39<04:14, 25.47s/it]
Task 1, Epoch 11/20 => Loss 0.219, Train_accy 93.18:  55%|█████▌    | 11/20 [04:39<03:49, 25.48s/it]
Task 1, Epoch 12/20 => Loss 0.208, Train_accy 93.58:  55%|█████▌    | 11/20 [05:05<03:49, 25.48s/it]
Task 1, Epoch 12/20 => Loss 0.208, Train_accy 93.58:  60%|██████    | 12/20 [05:05<03:23, 25.42s/it]
Task 1, Epoch 13/20 => Loss 0.204, Train_accy 93.14:  60%|██████    | 12/20 [05:30<03:23, 25.42s/it]
Task 1, Epoch 13/20 => Loss 0.204, Train_accy 93.14:  65%|██████▌   | 13/20 [05:30<02:57, 25.41s/it]
Task 1, Epoch 14/20 => Loss 0.197, Train_accy 93.92:  65%|██████▌   | 13/20 [05:55<02:57, 25.41s/it]
Task 1, Epoch 14/20 => Loss 0.197, Train_accy 93.92:  70%|███████   | 14/20 [05:55<02:32, 25.43s/it]
Task 1, Epoch 15/20 => Loss 0.199, Train_accy 93.20:  70%|███████   | 14/20 [06:21<02:32, 25.43s/it]
Task 1, Epoch 15/20 => Loss 0.199, Train_accy 93.20:  75%|███████▌  | 15/20 [06:21<02:06, 25.40s/it]
Task 1, Epoch 16/20 => Loss 0.208, Train_accy 93.36:  75%|███████▌  | 15/20 [06:46<02:06, 25.40s/it]
Task 1, Epoch 16/20 => Loss 0.208, Train_accy 93.36:  80%|████████  | 16/20 [06:46<01:41, 25.40s/it]
Task 1, Epoch 17/20 => Loss 0.200, Train_accy 93.44:  80%|████████  | 16/20 [07:11<01:41, 25.40s/it]
Task 1, Epoch 17/20 => Loss 0.200, Train_accy 93.44:  85%|████████▌ | 17/20 [07:11<01:16, 25.38s/it]
Task 1, Epoch 18/20 => Loss 0.203, Train_accy 93.52:  85%|████████▌ | 17/20 [07:37<01:16, 25.38s/it]
Task 1, Epoch 18/20 => Loss 0.203, Train_accy 93.52:  90%|█████████ | 18/20 [07:37<00:50, 25.40s/it]
Task 1, Epoch 19/20 => Loss 0.197, Train_accy 93.56:  90%|█████████ | 18/20 [08:02<00:50, 25.40s/it]
Task 1, Epoch 19/20 => Loss 0.197, Train_accy 93.56:  95%|█████████▌| 19/20 [08:02<00:25, 25.40s/it]
Task 1, Epoch 20/20 => Loss 0.205, Train_accy 93.48:  95%|█████████▌| 19/20 [08:28<00:25, 25.40s/it]
Task 1, Epoch 20/20 => Loss 0.205, Train_accy 93.48: 100%|██████████| 20/20 [08:28<00:00, 25.41s/it]
Task 1, Epoch 20/20 => Loss 0.205, Train_accy 93.48: 100%|██████████| 20/20 [08:28<00:00, 25.41s/it]
2024-09-04 18:11:36,544 [ease.py] => Task 1, Epoch 20/20 => Loss 0.205, Train_accy 93.48
2024-09-04 18:12:34,293 [ease.py] => Task correct: 92.68333333333334
2024-09-04 18:12:34,293 [ease.py] => Task acc: 98.11666666666666
2024-09-04 18:12:34,311 [trainer.py] => No NME accuracy.
2024-09-04 18:12:34,311 [trainer.py] => CNN: {'total': 92.12, '00-49': 91.1, '50-59': 97.2, 'old': 91.1, 'new': 97.2}
2024-09-04 18:12:34,311 [trainer.py] => CNN top1 curve: [94.84, 92.12]
2024-09-04 18:12:34,311 [trainer.py] => CNN top5 curve: [99.62, 99.53]

Average Accuracy (CNN): 93.48
2024-09-04 18:12:34,311 [trainer.py] => Average Accuracy (CNN): 93.48 

2024-09-04 18:12:34,312 [trainer.py] => All params: 86202818
2024-09-04 18:12:34,312 [trainer.py] => Trainable params: 304320
2024-09-04 18:12:34,315 [ease.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.556, Train_accy 77.90:   0%|          | 0/20 [00:25<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.556, Train_accy 77.90:   5%|▌         | 1/20 [00:25<08:04, 25.48s/it]
Task 2, Epoch 2/20 => Loss 0.409, Train_accy 91.92:   5%|▌         | 1/20 [00:50<08:04, 25.48s/it]
Task 2, Epoch 2/20 => Loss 0.409, Train_accy 91.92:  10%|█         | 2/20 [00:50<07:37, 25.40s/it]
Task 2, Epoch 3/20 => Loss 0.260, Train_accy 93.12:  10%|█         | 2/20 [01:16<07:37, 25.40s/it]
Task 2, Epoch 3/20 => Loss 0.260, Train_accy 93.12:  15%|█▌        | 3/20 [01:16<07:11, 25.38s/it]
Task 2, Epoch 4/20 => Loss 0.228, Train_accy 93.64:  15%|█▌        | 3/20 [01:41<07:11, 25.38s/it]
Task 2, Epoch 4/20 => Loss 0.228, Train_accy 93.64:  20%|██        | 4/20 [01:41<06:46, 25.40s/it]
Task 2, Epoch 5/20 => Loss 0.191, Train_accy 94.34:  20%|██        | 4/20 [02:07<06:46, 25.40s/it]
Task 2, Epoch 5/20 => Loss 0.191, Train_accy 94.34:  25%|██▌       | 5/20 [02:07<06:21, 25.41s/it]
Task 2, Epoch 6/20 => Loss 0.201, Train_accy 94.08:  25%|██▌       | 5/20 [02:32<06:21, 25.41s/it]
Task 2, Epoch 6/20 => Loss 0.201, Train_accy 94.08:  30%|███       | 6/20 [02:32<05:55, 25.40s/it]
Task 2, Epoch 7/20 => Loss 0.189, Train_accy 94.32:  30%|███       | 6/20 [02:57<05:55, 25.40s/it]
Task 2, Epoch 7/20 => Loss 0.189, Train_accy 94.32:  35%|███▌      | 7/20 [02:57<05:29, 25.36s/it]
Task 2, Epoch 8/20 => Loss 0.189, Train_accy 94.32:  35%|███▌      | 7/20 [03:23<05:29, 25.36s/it]
Task 2, Epoch 8/20 => Loss 0.189, Train_accy 94.32:  40%|████      | 8/20 [03:23<05:04, 25.36s/it]
Task 2, Epoch 9/20 => Loss 0.177, Train_accy 94.38:  40%|████      | 8/20 [03:48<05:04, 25.36s/it]
Task 2, Epoch 9/20 => Loss 0.177, Train_accy 94.38:  45%|████▌     | 9/20 [03:48<04:39, 25.42s/it]
Task 2, Epoch 10/20 => Loss 0.169, Train_accy 95.10:  45%|████▌     | 9/20 [04:13<04:39, 25.42s/it]
Task 2, Epoch 10/20 => Loss 0.169, Train_accy 95.10:  50%|█████     | 10/20 [04:13<04:14, 25.41s/it]
Task 2, Epoch 11/20 => Loss 0.157, Train_accy 95.22:  50%|█████     | 10/20 [04:39<04:14, 25.41s/it]
Task 2, Epoch 11/20 => Loss 0.157, Train_accy 95.22:  55%|█████▌    | 11/20 [04:39<03:48, 25.42s/it]
Task 2, Epoch 12/20 => Loss 0.176, Train_accy 94.46:  55%|█████▌    | 11/20 [05:04<03:48, 25.42s/it]
Task 2, Epoch 12/20 => Loss 0.176, Train_accy 94.46:  60%|██████    | 12/20 [05:04<03:23, 25.39s/it]
Task 2, Epoch 13/20 => Loss 0.162, Train_accy 95.10:  60%|██████    | 12/20 [05:30<03:23, 25.39s/it]
Task 2, Epoch 13/20 => Loss 0.162, Train_accy 95.10:  65%|██████▌   | 13/20 [05:30<02:57, 25.36s/it]
Task 2, Epoch 14/20 => Loss 0.158, Train_accy 95.02:  65%|██████▌   | 13/20 [05:55<02:57, 25.36s/it]
Task 2, Epoch 14/20 => Loss 0.158, Train_accy 95.02:  70%|███████   | 14/20 [05:55<02:32, 25.36s/it]
Task 2, Epoch 15/20 => Loss 0.150, Train_accy 95.58:  70%|███████   | 14/20 [06:20<02:32, 25.36s/it]
Task 2, Epoch 15/20 => Loss 0.150, Train_accy 95.58:  75%|███████▌  | 15/20 [06:20<02:06, 25.37s/it]
Task 2, Epoch 16/20 => Loss 0.150, Train_accy 95.44:  75%|███████▌  | 15/20 [06:46<02:06, 25.37s/it]
Task 2, Epoch 16/20 => Loss 0.150, Train_accy 95.44:  80%|████████  | 16/20 [06:46<01:41, 25.34s/it]
Task 2, Epoch 17/20 => Loss 0.148, Train_accy 95.60:  80%|████████  | 16/20 [07:11<01:41, 25.34s/it]
Task 2, Epoch 17/20 => Loss 0.148, Train_accy 95.60:  85%|████████▌ | 17/20 [07:11<01:16, 25.36s/it]
Task 2, Epoch 18/20 => Loss 0.164, Train_accy 95.10:  85%|████████▌ | 17/20 [07:37<01:16, 25.36s/it]
Task 2, Epoch 18/20 => Loss 0.164, Train_accy 95.10:  90%|█████████ | 18/20 [07:37<00:50, 25.42s/it]
Task 2, Epoch 19/20 => Loss 0.161, Train_accy 95.02:  90%|█████████ | 18/20 [08:02<00:50, 25.42s/it]
Task 2, Epoch 19/20 => Loss 0.161, Train_accy 95.02:  95%|█████████▌| 19/20 [08:02<00:25, 25.36s/it]
Task 2, Epoch 20/20 => Loss 0.150, Train_accy 95.34:  95%|█████████▌| 19/20 [08:27<00:25, 25.36s/it]
Task 2, Epoch 20/20 => Loss 0.150, Train_accy 95.34: 100%|██████████| 20/20 [08:27<00:00, 25.42s/it]
Task 2, Epoch 20/20 => Loss 0.150, Train_accy 95.34: 100%|██████████| 20/20 [08:27<00:00, 25.39s/it]
2024-09-04 18:21:02,242 [ease.py] => Task 2, Epoch 20/20 => Loss 0.150, Train_accy 95.34
2024-09-04 18:22:35,312 [ease.py] => Task correct: 91.92857142857143
2024-09-04 18:22:35,312 [ease.py] => Task acc: 98.21428571428571
2024-09-04 18:22:35,334 [trainer.py] => No NME accuracy.
2024-09-04 18:22:35,334 [trainer.py] => CNN: {'total': 91.49, '00-49': 89.84, '50-59': 95.7, '60-69': 95.5, 'old': 90.82, 'new': 95.5}
2024-09-04 18:22:35,334 [trainer.py] => CNN top1 curve: [94.84, 92.12, 91.49]
2024-09-04 18:22:35,334 [trainer.py] => CNN top5 curve: [99.62, 99.53, 99.43]

Average Accuracy (CNN): 92.82
2024-09-04 18:22:35,334 [trainer.py] => Average Accuracy (CNN): 92.82 

2024-09-04 18:22:35,335 [trainer.py] => All params: 86271938
2024-09-04 18:22:35,336 [trainer.py] => Trainable params: 304320
2024-09-04 18:22:35,340 [ease.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.634, Train_accy 73.38:   0%|          | 0/20 [00:25<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.634, Train_accy 73.38:   5%|▌         | 1/20 [00:25<08:02, 25.40s/it]
Task 3, Epoch 2/20 => Loss 0.504, Train_accy 88.10:   5%|▌         | 1/20 [00:50<08:02, 25.40s/it]
Task 3, Epoch 2/20 => Loss 0.504, Train_accy 88.10:  10%|█         | 2/20 [00:50<07:35, 25.32s/it]
Task 3, Epoch 3/20 => Loss 0.342, Train_accy 90.24:  10%|█         | 2/20 [01:15<07:35, 25.32s/it]
Task 3, Epoch 3/20 => Loss 0.342, Train_accy 90.24:  15%|█▌        | 3/20 [01:15<07:09, 25.28s/it]
Task 3, Epoch 4/20 => Loss 0.287, Train_accy 91.42:  15%|█▌        | 3/20 [01:41<07:09, 25.28s/it]
Task 3, Epoch 4/20 => Loss 0.287, Train_accy 91.42:  20%|██        | 4/20 [01:41<06:44, 25.29s/it]
Task 3, Epoch 5/20 => Loss 0.262, Train_accy 91.70:  20%|██        | 4/20 [02:06<06:44, 25.29s/it]
Task 3, Epoch 5/20 => Loss 0.262, Train_accy 91.70:  25%|██▌       | 5/20 [02:06<06:20, 25.34s/it]
Task 3, Epoch 6/20 => Loss 0.240, Train_accy 92.50:  25%|██▌       | 5/20 [02:31<06:20, 25.34s/it]
Task 3, Epoch 6/20 => Loss 0.240, Train_accy 92.50:  30%|███       | 6/20 [02:31<05:54, 25.35s/it]
Task 3, Epoch 7/20 => Loss 0.243, Train_accy 92.54:  30%|███       | 6/20 [02:57<05:54, 25.35s/it]
Task 3, Epoch 7/20 => Loss 0.243, Train_accy 92.54:  35%|███▌      | 7/20 [02:57<05:29, 25.36s/it]
Task 3, Epoch 8/20 => Loss 0.235, Train_accy 92.18:  35%|███▌      | 7/20 [03:22<05:29, 25.36s/it]
Task 3, Epoch 8/20 => Loss 0.235, Train_accy 92.18:  40%|████      | 8/20 [03:22<05:04, 25.39s/it]
Task 3, Epoch 9/20 => Loss 0.208, Train_accy 93.46:  40%|████      | 8/20 [03:47<05:04, 25.39s/it]
Task 3, Epoch 9/20 => Loss 0.208, Train_accy 93.46:  45%|████▌     | 9/20 [03:47<04:38, 25.31s/it]
Task 3, Epoch 10/20 => Loss 0.216, Train_accy 93.16:  45%|████▌     | 9/20 [04:13<04:38, 25.31s/it]
Task 3, Epoch 10/20 => Loss 0.216, Train_accy 93.16:  50%|█████     | 10/20 [04:13<04:13, 25.35s/it]
Task 3, Epoch 11/20 => Loss 0.207, Train_accy 93.54:  50%|█████     | 10/20 [04:38<04:13, 25.35s/it]
Task 3, Epoch 11/20 => Loss 0.207, Train_accy 93.54:  55%|█████▌    | 11/20 [04:38<03:48, 25.34s/it]
Task 3, Epoch 12/20 => Loss 0.206, Train_accy 93.22:  55%|█████▌    | 11/20 [05:04<03:48, 25.34s/it]
Task 3, Epoch 12/20 => Loss 0.206, Train_accy 93.22:  60%|██████    | 12/20 [05:04<03:22, 25.34s/it]
Task 3, Epoch 13/20 => Loss 0.204, Train_accy 93.26:  60%|██████    | 12/20 [05:29<03:22, 25.34s/it]
Task 3, Epoch 13/20 => Loss 0.204, Train_accy 93.26:  65%|██████▌   | 13/20 [05:29<02:57, 25.35s/it]
Task 3, Epoch 14/20 => Loss 0.203, Train_accy 93.00:  65%|██████▌   | 13/20 [05:54<02:57, 25.35s/it]
Task 3, Epoch 14/20 => Loss 0.203, Train_accy 93.00:  70%|███████   | 14/20 [05:54<02:32, 25.40s/it]
Task 3, Epoch 15/20 => Loss 0.204, Train_accy 93.32:  70%|███████   | 14/20 [06:20<02:32, 25.40s/it]
Task 3, Epoch 15/20 => Loss 0.204, Train_accy 93.32:  75%|███████▌  | 15/20 [06:20<02:06, 25.38s/it]
Task 3, Epoch 16/20 => Loss 0.203, Train_accy 93.44:  75%|███████▌  | 15/20 [06:45<02:06, 25.38s/it]
Task 3, Epoch 16/20 => Loss 0.203, Train_accy 93.44:  80%|████████  | 16/20 [06:45<01:41, 25.35s/it]
Task 3, Epoch 17/20 => Loss 0.193, Train_accy 93.74:  80%|████████  | 16/20 [07:11<01:41, 25.35s/it]
Task 3, Epoch 17/20 => Loss 0.193, Train_accy 93.74:  85%|████████▌ | 17/20 [07:11<01:16, 25.40s/it]
Task 3, Epoch 18/20 => Loss 0.185, Train_accy 93.90:  85%|████████▌ | 17/20 [07:36<01:16, 25.40s/it]
Task 3, Epoch 18/20 => Loss 0.185, Train_accy 93.90:  90%|█████████ | 18/20 [07:36<00:50, 25.39s/it]
Task 3, Epoch 19/20 => Loss 0.188, Train_accy 93.56:  90%|█████████ | 18/20 [08:01<00:50, 25.39s/it]
Task 3, Epoch 19/20 => Loss 0.188, Train_accy 93.56:  95%|█████████▌| 19/20 [08:01<00:25, 25.32s/it]
Task 3, Epoch 20/20 => Loss 0.191, Train_accy 94.16:  95%|█████████▌| 19/20 [08:26<00:25, 25.32s/it]
Task 3, Epoch 20/20 => Loss 0.191, Train_accy 94.16: 100%|██████████| 20/20 [08:26<00:00, 25.33s/it]
Task 3, Epoch 20/20 => Loss 0.191, Train_accy 94.16: 100%|██████████| 20/20 [08:26<00:00, 25.35s/it]
2024-09-04 18:31:02,377 [ease.py] => Task 3, Epoch 20/20 => Loss 0.191, Train_accy 94.16
2024-09-04 18:33:14,825 [ease.py] => Task correct: 89.125
2024-09-04 18:33:14,825 [ease.py] => Task acc: 98.175
2024-09-04 18:33:14,848 [trainer.py] => No NME accuracy.
2024-09-04 18:33:14,848 [trainer.py] => CNN: {'total': 88.55, '00-49': 87.16, '50-59': 88.4, '60-69': 90.3, '70-79': 93.9, 'old': 87.79, 'new': 93.9}
2024-09-04 18:33:14,848 [trainer.py] => CNN top1 curve: [94.84, 92.12, 91.49, 88.55]
2024-09-04 18:33:14,848 [trainer.py] => CNN top5 curve: [99.62, 99.53, 99.43, 99.16]

Average Accuracy (CNN): 91.75
2024-09-04 18:33:14,848 [trainer.py] => Average Accuracy (CNN): 91.75 

2024-09-04 18:33:14,849 [trainer.py] => All params: 86356418
2024-09-04 18:33:14,849 [trainer.py] => Trainable params: 304320
2024-09-04 18:33:14,853 [ease.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.650, Train_accy 74.62:   0%|          | 0/20 [00:25<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.650, Train_accy 74.62:   5%|▌         | 1/20 [00:25<08:00, 25.29s/it]
Task 4, Epoch 2/20 => Loss 0.503, Train_accy 89.14:   5%|▌         | 1/20 [00:50<08:00, 25.29s/it]
Task 4, Epoch 2/20 => Loss 0.503, Train_accy 89.14:  10%|█         | 2/20 [00:50<07:35, 25.29s/it]
Task 4, Epoch 3/20 => Loss 0.317, Train_accy 91.18:  10%|█         | 2/20 [01:16<07:35, 25.29s/it]
Task 4, Epoch 3/20 => Loss 0.317, Train_accy 91.18:  15%|█▌        | 3/20 [01:16<07:11, 25.36s/it]
Task 4, Epoch 4/20 => Loss 0.278, Train_accy 92.08:  15%|█▌        | 3/20 [01:41<07:11, 25.36s/it]
Task 4, Epoch 4/20 => Loss 0.278, Train_accy 92.08:  20%|██        | 4/20 [01:41<06:45, 25.32s/it]
Task 4, Epoch 5/20 => Loss 0.254, Train_accy 92.16:  20%|██        | 4/20 [02:06<06:45, 25.32s/it]
Task 4, Epoch 5/20 => Loss 0.254, Train_accy 92.16:  25%|██▌       | 5/20 [02:06<06:19, 25.30s/it]
Task 4, Epoch 6/20 => Loss 0.241, Train_accy 92.66:  25%|██▌       | 5/20 [02:31<06:19, 25.30s/it]
Task 4, Epoch 6/20 => Loss 0.241, Train_accy 92.66:  30%|███       | 6/20 [02:31<05:54, 25.30s/it]
Task 4, Epoch 7/20 => Loss 0.229, Train_accy 93.10:  30%|███       | 6/20 [02:57<05:54, 25.30s/it]
Task 4, Epoch 7/20 => Loss 0.229, Train_accy 93.10:  35%|███▌      | 7/20 [02:57<05:29, 25.32s/it]
Task 4, Epoch 8/20 => Loss 0.211, Train_accy 93.36:  35%|███▌      | 7/20 [03:22<05:29, 25.32s/it]
Task 4, Epoch 8/20 => Loss 0.211, Train_accy 93.36:  40%|████      | 8/20 [03:22<05:03, 25.31s/it]
Task 4, Epoch 9/20 => Loss 0.203, Train_accy 93.80:  40%|████      | 8/20 [03:47<05:03, 25.31s/it]
Task 4, Epoch 9/20 => Loss 0.203, Train_accy 93.80:  45%|████▌     | 9/20 [03:47<04:38, 25.33s/it]
Task 4, Epoch 10/20 => Loss 0.206, Train_accy 93.82:  45%|████▌     | 9/20 [04:13<04:38, 25.33s/it]
Task 4, Epoch 10/20 => Loss 0.206, Train_accy 93.82:  50%|█████     | 10/20 [04:13<04:13, 25.34s/it]
Task 4, Epoch 11/20 => Loss 0.206, Train_accy 93.46:  50%|█████     | 10/20 [04:38<04:13, 25.34s/it]
Task 4, Epoch 11/20 => Loss 0.206, Train_accy 93.46:  55%|█████▌    | 11/20 [04:38<03:48, 25.33s/it]
Task 4, Epoch 12/20 => Loss 0.206, Train_accy 93.54:  55%|█████▌    | 11/20 [05:04<03:48, 25.33s/it]
Task 4, Epoch 12/20 => Loss 0.206, Train_accy 93.54:  60%|██████    | 12/20 [05:04<03:23, 25.38s/it]
Task 4, Epoch 13/20 => Loss 0.190, Train_accy 93.80:  60%|██████    | 12/20 [05:29<03:23, 25.38s/it]
Task 4, Epoch 13/20 => Loss 0.190, Train_accy 93.80:  65%|██████▌   | 13/20 [05:29<02:57, 25.39s/it]
Task 4, Epoch 14/20 => Loss 0.197, Train_accy 93.96:  65%|██████▌   | 13/20 [05:54<02:57, 25.39s/it]
Task 4, Epoch 14/20 => Loss 0.197, Train_accy 93.96:  70%|███████   | 14/20 [05:54<02:32, 25.36s/it]
Task 4, Epoch 15/20 => Loss 0.181, Train_accy 94.10:  70%|███████   | 14/20 [06:20<02:32, 25.36s/it]
Task 4, Epoch 15/20 => Loss 0.181, Train_accy 94.10:  75%|███████▌  | 15/20 [06:20<02:06, 25.35s/it]
Task 4, Epoch 16/20 => Loss 0.183, Train_accy 94.38:  75%|███████▌  | 15/20 [06:45<02:06, 25.35s/it]
Task 4, Epoch 16/20 => Loss 0.183, Train_accy 94.38:  80%|████████  | 16/20 [06:45<01:41, 25.34s/it]
Task 4, Epoch 17/20 => Loss 0.200, Train_accy 93.74:  80%|████████  | 16/20 [07:10<01:41, 25.34s/it]
Task 4, Epoch 17/20 => Loss 0.200, Train_accy 93.74:  85%|████████▌ | 17/20 [07:10<01:16, 25.38s/it]
Task 4, Epoch 18/20 => Loss 0.172, Train_accy 94.32:  85%|████████▌ | 17/20 [07:36<01:16, 25.38s/it]
Task 4, Epoch 18/20 => Loss 0.172, Train_accy 94.32:  90%|█████████ | 18/20 [07:36<00:50, 25.32s/it]
Task 4, Epoch 19/20 => Loss 0.183, Train_accy 94.24:  90%|█████████ | 18/20 [08:01<00:50, 25.32s/it]
Task 4, Epoch 19/20 => Loss 0.183, Train_accy 94.24:  95%|█████████▌| 19/20 [08:01<00:25, 25.34s/it]
Task 4, Epoch 20/20 => Loss 0.179, Train_accy 94.64:  95%|█████████▌| 19/20 [08:26<00:25, 25.34s/it]
Task 4, Epoch 20/20 => Loss 0.179, Train_accy 94.64: 100%|██████████| 20/20 [08:26<00:00, 25.34s/it]
Task 4, Epoch 20/20 => Loss 0.179, Train_accy 94.64: 100%|██████████| 20/20 [08:26<00:00, 25.34s/it]
2024-09-04 18:41:41,726 [ease.py] => Task 4, Epoch 20/20 => Loss 0.179, Train_accy 94.64
2024-09-04 18:44:39,236 [ease.py] => Task correct: 88.24444444444444
2024-09-04 18:44:39,236 [ease.py] => Task acc: 98.21111111111111
2024-09-04 18:44:39,256 [trainer.py] => No NME accuracy.
2024-09-04 18:44:39,256 [trainer.py] => CNN: {'total': 87.73, '00-49': 85.36, '50-59': 87.6, '60-69': 88.6, '70-79': 92.6, '80-89': 94.0, 'old': 86.95, 'new': 94.0}
2024-09-04 18:44:39,256 [trainer.py] => CNN top1 curve: [94.84, 92.12, 91.49, 88.55, 87.73]
2024-09-04 18:44:39,256 [trainer.py] => CNN top5 curve: [99.62, 99.53, 99.43, 99.16, 99.04]

Average Accuracy (CNN): 90.95
2024-09-04 18:44:39,256 [trainer.py] => Average Accuracy (CNN): 90.95 

2024-09-04 18:44:39,257 [trainer.py] => All params: 86456258
2024-09-04 18:44:39,258 [trainer.py] => Trainable params: 304320
2024-09-04 18:44:39,264 [ease.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.656, Train_accy 70.82:   0%|          | 0/20 [00:25<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.656, Train_accy 70.82:   5%|▌         | 1/20 [00:25<08:00, 25.28s/it]
Task 5, Epoch 2/20 => Loss 0.529, Train_accy 87.48:   5%|▌         | 1/20 [00:50<08:00, 25.28s/it]
Task 5, Epoch 2/20 => Loss 0.529, Train_accy 87.48:  10%|█         | 2/20 [00:50<07:35, 25.30s/it]
Task 5, Epoch 3/20 => Loss 0.338, Train_accy 90.16:  10%|█         | 2/20 [01:15<07:35, 25.30s/it]
Task 5, Epoch 3/20 => Loss 0.338, Train_accy 90.16:  15%|█▌        | 3/20 [01:15<07:10, 25.32s/it]
Task 5, Epoch 4/20 => Loss 0.308, Train_accy 90.74:  15%|█▌        | 3/20 [01:41<07:10, 25.32s/it]
Task 5, Epoch 4/20 => Loss 0.308, Train_accy 90.74:  20%|██        | 4/20 [01:41<06:45, 25.35s/it]
Task 5, Epoch 5/20 => Loss 0.260, Train_accy 92.28:  20%|██        | 4/20 [02:06<06:45, 25.35s/it]
Task 5, Epoch 5/20 => Loss 0.260, Train_accy 92.28:  25%|██▌       | 5/20 [02:06<06:20, 25.35s/it]
Task 5, Epoch 6/20 => Loss 0.260, Train_accy 92.12:  25%|██▌       | 5/20 [02:32<06:20, 25.35s/it]
Task 5, Epoch 6/20 => Loss 0.260, Train_accy 92.12:  30%|███       | 6/20 [02:32<05:54, 25.35s/it]
Task 5, Epoch 7/20 => Loss 0.250, Train_accy 92.12:  30%|███       | 6/20 [02:57<05:54, 25.35s/it]
Task 5, Epoch 7/20 => Loss 0.250, Train_accy 92.12:  35%|███▌      | 7/20 [02:57<05:29, 25.35s/it]
Task 5, Epoch 8/20 => Loss 0.262, Train_accy 91.62:  35%|███▌      | 7/20 [03:22<05:29, 25.35s/it]
Task 5, Epoch 8/20 => Loss 0.262, Train_accy 91.62:  40%|████      | 8/20 [03:22<05:03, 25.31s/it]
Task 5, Epoch 9/20 => Loss 0.236, Train_accy 92.88:  40%|████      | 8/20 [03:47<05:03, 25.31s/it]
Task 5, Epoch 9/20 => Loss 0.236, Train_accy 92.88:  45%|████▌     | 9/20 [03:47<04:38, 25.31s/it]
Task 5, Epoch 10/20 => Loss 0.242, Train_accy 92.14:  45%|████▌     | 9/20 [04:13<04:38, 25.31s/it]
Task 5, Epoch 10/20 => Loss 0.242, Train_accy 92.14:  50%|█████     | 10/20 [04:13<04:12, 25.29s/it]
Task 5, Epoch 11/20 => Loss 0.238, Train_accy 92.40:  50%|█████     | 10/20 [04:38<04:12, 25.29s/it]
Task 5, Epoch 11/20 => Loss 0.238, Train_accy 92.40:  55%|█████▌    | 11/20 [04:38<03:47, 25.27s/it]
Task 5, Epoch 12/20 => Loss 0.239, Train_accy 92.38:  55%|█████▌    | 11/20 [05:03<03:47, 25.27s/it]
Task 5, Epoch 12/20 => Loss 0.239, Train_accy 92.38:  60%|██████    | 12/20 [05:03<03:22, 25.34s/it]
Task 5, Epoch 13/20 => Loss 0.219, Train_accy 93.02:  60%|██████    | 12/20 [05:29<03:22, 25.34s/it]
Task 5, Epoch 13/20 => Loss 0.219, Train_accy 93.02:  65%|██████▌   | 13/20 [05:29<02:57, 25.36s/it]
Task 5, Epoch 14/20 => Loss 0.211, Train_accy 93.30:  65%|██████▌   | 13/20 [05:54<02:57, 25.36s/it]
Task 5, Epoch 14/20 => Loss 0.211, Train_accy 93.30:  70%|███████   | 14/20 [05:54<02:31, 25.30s/it]
Task 5, Epoch 15/20 => Loss 0.210, Train_accy 93.54:  70%|███████   | 14/20 [06:19<02:31, 25.30s/it]
Task 5, Epoch 15/20 => Loss 0.210, Train_accy 93.54:  75%|███████▌  | 15/20 [06:19<02:06, 25.33s/it]
Task 5, Epoch 16/20 => Loss 0.226, Train_accy 92.78:  75%|███████▌  | 15/20 [06:45<02:06, 25.33s/it]
Task 5, Epoch 16/20 => Loss 0.226, Train_accy 92.78:  80%|████████  | 16/20 [06:45<01:41, 25.38s/it]
Task 5, Epoch 17/20 => Loss 0.202, Train_accy 93.64:  80%|████████  | 16/20 [07:10<01:41, 25.38s/it]
Task 5, Epoch 17/20 => Loss 0.202, Train_accy 93.64:  85%|████████▌ | 17/20 [07:10<01:16, 25.37s/it]
Task 5, Epoch 18/20 => Loss 0.207, Train_accy 92.98:  85%|████████▌ | 17/20 [07:36<01:16, 25.37s/it]
Task 5, Epoch 18/20 => Loss 0.207, Train_accy 92.98:  90%|█████████ | 18/20 [07:36<00:50, 25.40s/it]
Task 5, Epoch 19/20 => Loss 0.216, Train_accy 93.18:  90%|█████████ | 18/20 [08:01<00:50, 25.40s/it]
Task 5, Epoch 19/20 => Loss 0.216, Train_accy 93.18:  95%|█████████▌| 19/20 [08:01<00:25, 25.35s/it]
Task 5, Epoch 20/20 => Loss 0.217, Train_accy 92.86:  95%|█████████▌| 19/20 [08:26<00:25, 25.35s/it]
Task 5, Epoch 20/20 => Loss 0.217, Train_accy 92.86: 100%|██████████| 20/20 [08:26<00:00, 25.34s/it]
Task 5, Epoch 20/20 => Loss 0.217, Train_accy 92.86: 100%|██████████| 20/20 [08:26<00:00, 25.34s/it]
2024-09-04 18:53:06,054 [ease.py] => Task 5, Epoch 20/20 => Loss 0.217, Train_accy 92.86
2024-09-04 18:56:53,119 [ease.py] => Task correct: 87.92
2024-09-04 18:56:53,120 [ease.py] => Task acc: 98.23
2024-09-04 18:56:53,133 [trainer.py] => No NME accuracy.
2024-09-04 18:56:53,133 [trainer.py] => CNN: {'total': 87.38, '00-49': 84.24, '50-59': 86.5, '60-69': 88.5, '70-79': 90.9, '80-89': 93.7, '90-99': 93.0, 'old': 86.76, 'new': 93.0}
2024-09-04 18:56:53,134 [trainer.py] => CNN top1 curve: [94.84, 92.12, 91.49, 88.55, 87.73, 87.38]
2024-09-04 18:56:53,134 [trainer.py] => CNN top5 curve: [99.62, 99.53, 99.43, 99.16, 99.04, 98.86]

Average Accuracy (CNN): 90.35
2024-09-04 18:56:53,134 [trainer.py] => Average Accuracy (CNN): 90.35 

Accuracy Matrix (CNN):
[[94.84 91.1  89.84 87.16 85.36 84.24]
 [ 0.   97.2  95.7  88.4  87.6  86.5 ]
 [ 0.    0.   95.5  90.3  88.6  88.5 ]
 [ 0.    0.    0.   93.9  92.6  90.9 ]
 [ 0.    0.    0.    0.   94.   93.7 ]
 [ 0.    0.    0.    0.    0.   93.  ]]
2024-09-04 18:56:53,134 [trainer.py] => Forgetting (CNN): 6.320000000000002
2024-09-04 18:56:56,277 [trainer.py] => config: ./exps/ease_cifar_B50_Inc10.json
2024-09-04 18:56:56,277 [trainer.py] => prefix:  
2024-09-04 18:56:56,277 [trainer.py] => dataset: cifar224
2024-09-04 18:56:56,277 [trainer.py] => memory_size: 0
2024-09-04 18:56:56,277 [trainer.py] => memory_per_class: 0
2024-09-04 18:56:56,277 [trainer.py] => fixed_memory: False
2024-09-04 18:56:56,277 [trainer.py] => shuffle: True
2024-09-04 18:56:56,277 [trainer.py] => init_cls: 50
2024-09-04 18:56:56,277 [trainer.py] => increment: 5
2024-09-04 18:56:56,277 [trainer.py] => model_name: ease
2024-09-04 18:56:56,277 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-04 18:56:56,277 [trainer.py] => device: [device(type='cuda', index=3)]
2024-09-04 18:56:56,277 [trainer.py] => seed: 1993
2024-09-04 18:56:56,277 [trainer.py] => init_epochs: 20
2024-09-04 18:56:56,278 [trainer.py] => init_lr: 0.025
2024-09-04 18:56:56,278 [trainer.py] => later_epochs: 20
2024-09-04 18:56:56,278 [trainer.py] => later_lr: 0.025
2024-09-04 18:56:56,278 [trainer.py] => batch_size: 48
2024-09-04 18:56:56,278 [trainer.py] => weight_decay: 0.0005
2024-09-04 18:56:56,278 [trainer.py] => min_lr: 0
2024-09-04 18:56:56,278 [trainer.py] => optimizer: sgd
2024-09-04 18:56:56,278 [trainer.py] => scheduler: cosine
2024-09-04 18:56:56,278 [trainer.py] => pretrained: True
2024-09-04 18:56:56,278 [trainer.py] => vpt_type: Deep
2024-09-04 18:56:56,278 [trainer.py] => prompt_token_num: 5
2024-09-04 18:56:56,278 [trainer.py] => ffn_num: 16
2024-09-04 18:56:56,278 [trainer.py] => use_diagonal: False
2024-09-04 18:56:56,278 [trainer.py] => recalc_sim: True
2024-09-04 18:56:56,278 [trainer.py] => alpha: 0.1
2024-09-04 18:56:56,278 [trainer.py] => use_init_ptm: False
2024-09-04 18:56:56,278 [trainer.py] => beta: 0
2024-09-04 18:56:56,278 [trainer.py] => use_old_data: False
2024-09-04 18:56:56,278 [trainer.py] => use_reweight: True
2024-09-04 18:56:56,278 [trainer.py] => moni_adam: False
2024-09-04 18:56:56,278 [trainer.py] => adapter_num: -1
2024-09-04 18:56:57,454 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-04 18:57:01,224 [trainer.py] => All params: 86102976
2024-09-04 18:57:01,225 [trainer.py] => Trainable params: 304320
2024-09-04 18:57:01,232 [ease.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.631, Train_accy 68.26:   0%|          | 0/20 [02:05<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.631, Train_accy 68.26:   5%|▌         | 1/20 [02:05<39:36, 125.08s/it]
Task 0, Epoch 2/20 => Loss 0.634, Train_accy 82.68:   5%|▌         | 1/20 [04:09<39:36, 125.08s/it]
Task 0, Epoch 2/20 => Loss 0.634, Train_accy 82.68:  10%|█         | 2/20 [04:09<37:27, 124.86s/it]
Task 0, Epoch 3/20 => Loss 0.588, Train_accy 83.84:  10%|█         | 2/20 [06:15<37:27, 124.86s/it]
Task 0, Epoch 3/20 => Loss 0.588, Train_accy 83.84:  15%|█▌        | 3/20 [06:15<35:26, 125.09s/it]
Task 0, Epoch 4/20 => Loss 0.557, Train_accy 84.54:  15%|█▌        | 3/20 [08:19<35:26, 125.09s/it]
Task 0, Epoch 4/20 => Loss 0.557, Train_accy 84.54:  20%|██        | 4/20 [08:19<33:18, 124.92s/it]
Task 0, Epoch 5/20 => Loss 0.549, Train_accy 84.84:  20%|██        | 4/20 [10:24<33:18, 124.92s/it]
Task 0, Epoch 5/20 => Loss 0.549, Train_accy 84.84:  25%|██▌       | 5/20 [10:24<31:13, 124.88s/it]
Task 0, Epoch 6/20 => Loss 0.542, Train_accy 84.97:  25%|██▌       | 5/20 [12:29<31:13, 124.88s/it]
Task 0, Epoch 6/20 => Loss 0.542, Train_accy 84.97:  30%|███       | 6/20 [12:29<29:08, 124.91s/it]
Task 0, Epoch 7/20 => Loss 0.531, Train_accy 85.16:  30%|███       | 6/20 [14:34<29:08, 124.91s/it]
Task 0, Epoch 7/20 => Loss 0.531, Train_accy 85.16:  35%|███▌      | 7/20 [14:34<27:04, 124.98s/it]
Task 0, Epoch 8/20 => Loss 0.527, Train_accy 85.32:  35%|███▌      | 7/20 [16:39<27:04, 124.98s/it]
Task 0, Epoch 8/20 => Loss 0.527, Train_accy 85.32:  40%|████      | 8/20 [16:39<24:59, 124.93s/it]
Task 0, Epoch 9/20 => Loss 0.516, Train_accy 85.47:  40%|████      | 8/20 [18:44<24:59, 124.93s/it]
Task 0, Epoch 9/20 => Loss 0.516, Train_accy 85.47:  45%|████▌     | 9/20 [18:44<22:53, 124.88s/it]
Task 0, Epoch 10/20 => Loss 0.511, Train_accy 85.81:  45%|████▌     | 9/20 [20:49<22:53, 124.88s/it]
Task 0, Epoch 10/20 => Loss 0.511, Train_accy 85.81:  50%|█████     | 10/20 [20:49<20:48, 124.82s/it]
Task 0, Epoch 11/20 => Loss 0.507, Train_accy 85.85:  50%|█████     | 10/20 [22:53<20:48, 124.82s/it]
Task 0, Epoch 11/20 => Loss 0.507, Train_accy 85.85:  55%|█████▌    | 11/20 [22:53<18:42, 124.77s/it]
Task 0, Epoch 12/20 => Loss 0.493, Train_accy 86.09:  55%|█████▌    | 11/20 [24:58<18:42, 124.77s/it]
Task 0, Epoch 12/20 => Loss 0.493, Train_accy 86.09:  60%|██████    | 12/20 [24:58<16:38, 124.87s/it]
Task 0, Epoch 13/20 => Loss 0.495, Train_accy 86.10:  60%|██████    | 12/20 [27:03<16:38, 124.87s/it]
Task 0, Epoch 13/20 => Loss 0.495, Train_accy 86.10:  65%|██████▌   | 13/20 [27:03<14:34, 124.86s/it]
Task 0, Epoch 14/20 => Loss 0.490, Train_accy 86.06:  65%|██████▌   | 13/20 [29:08<14:34, 124.86s/it]
Task 0, Epoch 14/20 => Loss 0.490, Train_accy 86.06:  70%|███████   | 14/20 [29:08<12:30, 125.00s/it]
Task 0, Epoch 15/20 => Loss 0.482, Train_accy 86.44:  70%|███████   | 14/20 [31:13<12:30, 125.00s/it]
Task 0, Epoch 15/20 => Loss 0.482, Train_accy 86.44:  75%|███████▌  | 15/20 [31:13<10:24, 124.87s/it]
Task 0, Epoch 16/20 => Loss 0.477, Train_accy 86.51:  75%|███████▌  | 15/20 [33:18<10:24, 124.87s/it]
Task 0, Epoch 16/20 => Loss 0.477, Train_accy 86.51:  80%|████████  | 16/20 [33:18<08:19, 124.80s/it]
Task 0, Epoch 17/20 => Loss 0.468, Train_accy 86.74:  80%|████████  | 16/20 [35:23<08:19, 124.80s/it]
Task 0, Epoch 17/20 => Loss 0.468, Train_accy 86.74:  85%|████████▌ | 17/20 [35:23<06:15, 125.12s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 86.69:  85%|████████▌ | 17/20 [37:28<06:15, 125.12s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 86.69:  90%|█████████ | 18/20 [37:28<04:10, 125.03s/it]
Task 0, Epoch 19/20 => Loss 0.457, Train_accy 87.02:  90%|█████████ | 18/20 [39:33<04:10, 125.03s/it]
Task 0, Epoch 19/20 => Loss 0.457, Train_accy 87.02:  95%|█████████▌| 19/20 [39:33<02:04, 124.96s/it]
Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08:  95%|█████████▌| 19/20 [41:38<02:04, 124.96s/it]
Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08: 100%|██████████| 20/20 [41:38<00:00, 124.97s/it]
Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08: 100%|██████████| 20/20 [41:38<00:00, 124.93s/it]
2024-09-04 19:38:39,966 [ease.py] => Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.08
2024-09-04 19:39:59,099 [ease.py] => Task correct: 95.16
2024-09-04 19:39:59,100 [ease.py] => Task acc: 98.88
2024-09-04 19:39:59,132 [trainer.py] => No NME accuracy.
2024-09-04 19:39:59,132 [trainer.py] => CNN: {'total': 94.84, '00-49': 94.84, 'old': 0, 'new': 94.84}
2024-09-04 19:39:59,132 [trainer.py] => CNN top1 curve: [94.84]
2024-09-04 19:39:59,132 [trainer.py] => CNN top5 curve: [99.62]

Average Accuracy (CNN): 94.84
2024-09-04 19:39:59,132 [trainer.py] => Average Accuracy (CNN): 94.84 

2024-09-04 19:39:59,133 [trainer.py] => All params: 86179778
2024-09-04 19:39:59,133 [trainer.py] => Trainable params: 304320
2024-09-04 19:39:59,135 [ease.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.310, Train_accy 77.44:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.310, Train_accy 77.44:   5%|▌         | 1/20 [00:12<04:04, 12.87s/it]
Task 1, Epoch 2/20 => Loss 0.668, Train_accy 91.76:   5%|▌         | 1/20 [00:25<04:04, 12.87s/it]
Task 1, Epoch 2/20 => Loss 0.668, Train_accy 91.76:  10%|█         | 2/20 [00:25<03:52, 12.92s/it]
Task 1, Epoch 3/20 => Loss 0.351, Train_accy 92.32:  10%|█         | 2/20 [00:38<03:52, 12.92s/it]
Task 1, Epoch 3/20 => Loss 0.351, Train_accy 92.32:  15%|█▌        | 3/20 [00:38<03:39, 12.92s/it]
Task 1, Epoch 4/20 => Loss 0.216, Train_accy 94.68:  15%|█▌        | 3/20 [00:51<03:39, 12.92s/it]
Task 1, Epoch 4/20 => Loss 0.216, Train_accy 94.68:  20%|██        | 4/20 [00:51<03:26, 12.88s/it]
Task 1, Epoch 5/20 => Loss 0.178, Train_accy 95.16:  20%|██        | 4/20 [01:04<03:26, 12.88s/it]
Task 1, Epoch 5/20 => Loss 0.178, Train_accy 95.16:  25%|██▌       | 5/20 [01:04<03:12, 12.84s/it]
Task 1, Epoch 6/20 => Loss 0.167, Train_accy 95.36:  25%|██▌       | 5/20 [01:17<03:12, 12.84s/it]
Task 1, Epoch 6/20 => Loss 0.167, Train_accy 95.36:  30%|███       | 6/20 [01:17<02:59, 12.82s/it]
Task 1, Epoch 7/20 => Loss 0.142, Train_accy 96.32:  30%|███       | 6/20 [01:29<02:59, 12.82s/it]
Task 1, Epoch 7/20 => Loss 0.142, Train_accy 96.32:  35%|███▌      | 7/20 [01:29<02:46, 12.83s/it]
Task 1, Epoch 8/20 => Loss 0.143, Train_accy 95.96:  35%|███▌      | 7/20 [01:42<02:46, 12.83s/it]
Task 1, Epoch 8/20 => Loss 0.143, Train_accy 95.96:  40%|████      | 8/20 [01:42<02:34, 12.84s/it]
Task 1, Epoch 9/20 => Loss 0.131, Train_accy 95.88:  40%|████      | 8/20 [01:55<02:34, 12.84s/it]
Task 1, Epoch 9/20 => Loss 0.131, Train_accy 95.88:  45%|████▌     | 9/20 [01:55<02:21, 12.84s/it]
Task 1, Epoch 10/20 => Loss 0.124, Train_accy 96.00:  45%|████▌     | 9/20 [02:08<02:21, 12.84s/it]
Task 1, Epoch 10/20 => Loss 0.124, Train_accy 96.00:  50%|█████     | 10/20 [02:08<02:08, 12.84s/it]
Task 1, Epoch 11/20 => Loss 0.121, Train_accy 96.44:  50%|█████     | 10/20 [02:21<02:08, 12.84s/it]
Task 1, Epoch 11/20 => Loss 0.121, Train_accy 96.44:  55%|█████▌    | 11/20 [02:21<01:55, 12.83s/it]
Task 1, Epoch 12/20 => Loss 0.116, Train_accy 96.68:  55%|█████▌    | 11/20 [02:34<01:55, 12.83s/it]
Task 1, Epoch 12/20 => Loss 0.116, Train_accy 96.68:  60%|██████    | 12/20 [02:34<01:42, 12.84s/it]
Task 1, Epoch 13/20 => Loss 0.128, Train_accy 96.16:  60%|██████    | 12/20 [02:46<01:42, 12.84s/it]
Task 1, Epoch 13/20 => Loss 0.128, Train_accy 96.16:  65%|██████▌   | 13/20 [02:46<01:29, 12.82s/it]
Task 1, Epoch 14/20 => Loss 0.115, Train_accy 96.68:  65%|██████▌   | 13/20 [02:59<01:29, 12.82s/it]
Task 1, Epoch 14/20 => Loss 0.115, Train_accy 96.68:  70%|███████   | 14/20 [02:59<01:17, 12.85s/it]
Task 1, Epoch 15/20 => Loss 0.122, Train_accy 96.28:  70%|███████   | 14/20 [03:12<01:17, 12.85s/it]
Task 1, Epoch 15/20 => Loss 0.122, Train_accy 96.28:  75%|███████▌  | 15/20 [03:12<01:04, 12.86s/it]
Task 1, Epoch 16/20 => Loss 0.109, Train_accy 97.04:  75%|███████▌  | 15/20 [03:25<01:04, 12.86s/it]
Task 1, Epoch 16/20 => Loss 0.109, Train_accy 97.04:  80%|████████  | 16/20 [03:25<00:51, 12.85s/it]
Task 1, Epoch 17/20 => Loss 0.120, Train_accy 96.32:  80%|████████  | 16/20 [03:38<00:51, 12.85s/it]
Task 1, Epoch 17/20 => Loss 0.120, Train_accy 96.32:  85%|████████▌ | 17/20 [03:38<00:38, 12.87s/it]
Task 1, Epoch 18/20 => Loss 0.116, Train_accy 96.56:  85%|████████▌ | 17/20 [03:51<00:38, 12.87s/it]
Task 1, Epoch 18/20 => Loss 0.116, Train_accy 96.56:  90%|█████████ | 18/20 [03:51<00:25, 12.86s/it]
Task 1, Epoch 19/20 => Loss 0.116, Train_accy 96.56:  90%|█████████ | 18/20 [04:04<00:25, 12.86s/it]
Task 1, Epoch 19/20 => Loss 0.116, Train_accy 96.56:  95%|█████████▌| 19/20 [04:04<00:12, 12.84s/it]
Task 1, Epoch 20/20 => Loss 0.128, Train_accy 96.60:  95%|█████████▌| 19/20 [04:16<00:12, 12.84s/it]
Task 1, Epoch 20/20 => Loss 0.128, Train_accy 96.60: 100%|██████████| 20/20 [04:16<00:00, 12.81s/it]
Task 1, Epoch 20/20 => Loss 0.128, Train_accy 96.60: 100%|██████████| 20/20 [04:16<00:00, 12.84s/it]
2024-09-04 19:44:16,042 [ease.py] => Task 1, Epoch 20/20 => Loss 0.128, Train_accy 96.60
2024-09-04 19:44:58,061 [ease.py] => Task correct: 92.76363636363637
2024-09-04 19:44:58,061 [ease.py] => Task acc: 98.89090909090909
2024-09-04 19:44:58,082 [trainer.py] => No NME accuracy.
2024-09-04 19:44:58,083 [trainer.py] => CNN: {'total': 92.42, '00-49': 91.96, '50-54': 97.0, 'old': 91.96, 'new': 97.0}
2024-09-04 19:44:58,083 [trainer.py] => CNN top1 curve: [94.84, 92.42]
2024-09-04 19:44:58,083 [trainer.py] => CNN top5 curve: [99.62, 99.51]

Average Accuracy (CNN): 93.63
2024-09-04 19:44:58,083 [trainer.py] => Average Accuracy (CNN): 93.63 

2024-09-04 19:44:58,084 [trainer.py] => All params: 86191298
2024-09-04 19:44:58,084 [trainer.py] => Trainable params: 304320
2024-09-04 19:44:58,086 [ease.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.349, Train_accy 68.96:   0%|          | 0/20 [00:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.349, Train_accy 68.96:   5%|▌         | 1/20 [00:12<04:04, 12.85s/it]
Task 2, Epoch 2/20 => Loss 0.808, Train_accy 83.92:   5%|▌         | 1/20 [00:25<04:04, 12.85s/it]
Task 2, Epoch 2/20 => Loss 0.808, Train_accy 83.92:  10%|█         | 2/20 [00:25<03:50, 12.80s/it]
Task 2, Epoch 3/20 => Loss 0.517, Train_accy 87.20:  10%|█         | 2/20 [00:38<03:50, 12.80s/it]
Task 2, Epoch 3/20 => Loss 0.517, Train_accy 87.20:  15%|█▌        | 3/20 [00:38<03:37, 12.82s/it]
Task 2, Epoch 4/20 => Loss 0.370, Train_accy 88.88:  15%|█▌        | 3/20 [00:51<03:37, 12.82s/it]
Task 2, Epoch 4/20 => Loss 0.370, Train_accy 88.88:  20%|██        | 4/20 [00:51<03:25, 12.84s/it]
Task 2, Epoch 5/20 => Loss 0.315, Train_accy 89.92:  20%|██        | 4/20 [01:04<03:25, 12.84s/it]
Task 2, Epoch 5/20 => Loss 0.315, Train_accy 89.92:  25%|██▌       | 5/20 [01:04<03:12, 12.86s/it]
Task 2, Epoch 6/20 => Loss 0.279, Train_accy 90.32:  25%|██▌       | 5/20 [01:17<03:12, 12.86s/it]
Task 2, Epoch 6/20 => Loss 0.279, Train_accy 90.32:  30%|███       | 6/20 [01:17<03:00, 12.87s/it]
Task 2, Epoch 7/20 => Loss 0.263, Train_accy 91.16:  30%|███       | 6/20 [01:29<03:00, 12.87s/it]
Task 2, Epoch 7/20 => Loss 0.263, Train_accy 91.16:  35%|███▌      | 7/20 [01:29<02:47, 12.88s/it]
Task 2, Epoch 8/20 => Loss 0.253, Train_accy 91.28:  35%|███▌      | 7/20 [01:42<02:47, 12.88s/it]
Task 2, Epoch 8/20 => Loss 0.253, Train_accy 91.28:  40%|████      | 8/20 [01:42<02:34, 12.87s/it]
Task 2, Epoch 9/20 => Loss 0.240, Train_accy 91.40:  40%|████      | 8/20 [01:55<02:34, 12.87s/it]
Task 2, Epoch 9/20 => Loss 0.240, Train_accy 91.40:  45%|████▌     | 9/20 [01:55<02:22, 12.93s/it]
Task 2, Epoch 10/20 => Loss 0.256, Train_accy 91.00:  45%|████▌     | 9/20 [02:08<02:22, 12.93s/it]
Task 2, Epoch 10/20 => Loss 0.256, Train_accy 91.00:  50%|█████     | 10/20 [02:08<02:09, 12.91s/it]
Task 2, Epoch 11/20 => Loss 0.234, Train_accy 91.80:  50%|█████     | 10/20 [02:21<02:09, 12.91s/it]
Task 2, Epoch 11/20 => Loss 0.234, Train_accy 91.80:  55%|█████▌    | 11/20 [02:21<01:56, 12.89s/it]
Task 2, Epoch 12/20 => Loss 0.222, Train_accy 92.24:  55%|█████▌    | 11/20 [02:34<01:56, 12.89s/it]
Task 2, Epoch 12/20 => Loss 0.222, Train_accy 92.24:  60%|██████    | 12/20 [02:34<01:43, 12.88s/it]
Task 2, Epoch 13/20 => Loss 0.251, Train_accy 91.08:  60%|██████    | 12/20 [02:47<01:43, 12.88s/it]
Task 2, Epoch 13/20 => Loss 0.251, Train_accy 91.08:  65%|██████▌   | 13/20 [02:47<01:30, 12.89s/it]
Task 2, Epoch 14/20 => Loss 0.225, Train_accy 91.52:  65%|██████▌   | 13/20 [03:00<01:30, 12.89s/it]
Task 2, Epoch 14/20 => Loss 0.225, Train_accy 91.52:  70%|███████   | 14/20 [03:00<01:17, 12.90s/it]
Task 2, Epoch 15/20 => Loss 0.222, Train_accy 91.80:  70%|███████   | 14/20 [03:13<01:17, 12.90s/it]
Task 2, Epoch 15/20 => Loss 0.222, Train_accy 91.80:  75%|███████▌  | 15/20 [03:13<01:04, 12.89s/it]
Task 2, Epoch 16/20 => Loss 0.231, Train_accy 91.32:  75%|███████▌  | 15/20 [03:25<01:04, 12.89s/it]
Task 2, Epoch 16/20 => Loss 0.231, Train_accy 91.32:  80%|████████  | 16/20 [03:25<00:51, 12.85s/it]
Task 2, Epoch 17/20 => Loss 0.212, Train_accy 92.08:  80%|████████  | 16/20 [03:38<00:51, 12.85s/it]
Task 2, Epoch 17/20 => Loss 0.212, Train_accy 92.08:  85%|████████▌ | 17/20 [03:38<00:38, 12.86s/it]
Task 2, Epoch 18/20 => Loss 0.211, Train_accy 92.32:  85%|████████▌ | 17/20 [03:51<00:38, 12.86s/it]
Task 2, Epoch 18/20 => Loss 0.211, Train_accy 92.32:  90%|█████████ | 18/20 [03:51<00:25, 12.85s/it]
Task 2, Epoch 19/20 => Loss 0.220, Train_accy 92.16:  90%|█████████ | 18/20 [04:04<00:25, 12.85s/it]
Task 2, Epoch 19/20 => Loss 0.220, Train_accy 92.16:  95%|█████████▌| 19/20 [04:04<00:12, 12.89s/it]
Task 2, Epoch 20/20 => Loss 0.217, Train_accy 91.80:  95%|█████████▌| 19/20 [04:17<00:12, 12.89s/it]
Task 2, Epoch 20/20 => Loss 0.217, Train_accy 91.80: 100%|██████████| 20/20 [04:17<00:00, 12.94s/it]
Task 2, Epoch 20/20 => Loss 0.217, Train_accy 91.80: 100%|██████████| 20/20 [04:17<00:00, 12.89s/it]
2024-09-04 19:49:15,872 [ease.py] => Task 2, Epoch 20/20 => Loss 0.217, Train_accy 91.80
2024-09-04 19:50:21,090 [ease.py] => Task correct: 92.45
2024-09-04 19:50:21,091 [ease.py] => Task acc: 98.86666666666666
2024-09-04 19:50:21,115 [trainer.py] => No NME accuracy.
2024-09-04 19:50:21,115 [trainer.py] => CNN: {'total': 92.03, '00-49': 91.48, '50-54': 96.6, '55-59': 93.0, 'old': 91.95, 'new': 93.0}
2024-09-04 19:50:21,115 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03]
2024-09-04 19:50:21,115 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3]

Average Accuracy (CNN): 93.1
2024-09-04 19:50:21,115 [trainer.py] => Average Accuracy (CNN): 93.1 

2024-09-04 19:50:21,116 [trainer.py] => All params: 86245058
2024-09-04 19:50:21,116 [trainer.py] => Trainable params: 304320
2024-09-04 19:50:21,119 [ease.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.260, Train_accy 83.44:   0%|          | 0/20 [00:12<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.260, Train_accy 83.44:   5%|▌         | 1/20 [00:12<04:02, 12.77s/it]
Task 3, Epoch 2/20 => Loss 0.581, Train_accy 93.64:   5%|▌         | 1/20 [00:25<04:02, 12.77s/it]
Task 3, Epoch 2/20 => Loss 0.581, Train_accy 93.64:  10%|█         | 2/20 [00:25<03:50, 12.78s/it]
Task 3, Epoch 3/20 => Loss 0.290, Train_accy 94.72:  10%|█         | 2/20 [00:38<03:50, 12.78s/it]
Task 3, Epoch 3/20 => Loss 0.290, Train_accy 94.72:  15%|█▌        | 3/20 [00:38<03:37, 12.79s/it]
Task 3, Epoch 4/20 => Loss 0.192, Train_accy 95.00:  15%|█▌        | 3/20 [00:51<03:37, 12.79s/it]
Task 3, Epoch 4/20 => Loss 0.192, Train_accy 95.00:  20%|██        | 4/20 [00:51<03:24, 12.76s/it]
Task 3, Epoch 5/20 => Loss 0.159, Train_accy 95.92:  20%|██        | 4/20 [01:03<03:24, 12.76s/it]
Task 3, Epoch 5/20 => Loss 0.159, Train_accy 95.92:  25%|██▌       | 5/20 [01:03<03:11, 12.74s/it]
Task 3, Epoch 6/20 => Loss 0.152, Train_accy 95.48:  25%|██▌       | 5/20 [01:16<03:11, 12.74s/it]
Task 3, Epoch 6/20 => Loss 0.152, Train_accy 95.48:  30%|███       | 6/20 [01:16<02:58, 12.75s/it]
Task 3, Epoch 7/20 => Loss 0.149, Train_accy 95.84:  30%|███       | 6/20 [01:29<02:58, 12.75s/it]
Task 3, Epoch 7/20 => Loss 0.149, Train_accy 95.84:  35%|███▌      | 7/20 [01:29<02:45, 12.75s/it]
Task 3, Epoch 8/20 => Loss 0.138, Train_accy 95.64:  35%|███▌      | 7/20 [01:42<02:45, 12.75s/it]
Task 3, Epoch 8/20 => Loss 0.138, Train_accy 95.64:  40%|████      | 8/20 [01:42<02:33, 12.78s/it]
Task 3, Epoch 9/20 => Loss 0.132, Train_accy 96.12:  40%|████      | 8/20 [01:54<02:33, 12.78s/it]
Task 3, Epoch 9/20 => Loss 0.132, Train_accy 96.12:  45%|████▌     | 9/20 [01:54<02:20, 12.79s/it]
Task 3, Epoch 10/20 => Loss 0.116, Train_accy 96.92:  45%|████▌     | 9/20 [02:07<02:20, 12.79s/it]
Task 3, Epoch 10/20 => Loss 0.116, Train_accy 96.92:  50%|█████     | 10/20 [02:07<02:07, 12.78s/it]
Task 3, Epoch 11/20 => Loss 0.146, Train_accy 95.44:  50%|█████     | 10/20 [02:20<02:07, 12.78s/it]
Task 3, Epoch 11/20 => Loss 0.146, Train_accy 95.44:  55%|█████▌    | 11/20 [02:20<01:55, 12.80s/it]
Task 3, Epoch 12/20 => Loss 0.116, Train_accy 96.48:  55%|█████▌    | 11/20 [02:33<01:55, 12.80s/it]
Task 3, Epoch 12/20 => Loss 0.116, Train_accy 96.48:  60%|██████    | 12/20 [02:33<01:42, 12.84s/it]
Task 3, Epoch 13/20 => Loss 0.109, Train_accy 96.88:  60%|██████    | 12/20 [02:46<01:42, 12.84s/it]
Task 3, Epoch 13/20 => Loss 0.109, Train_accy 96.88:  65%|██████▌   | 13/20 [02:46<01:30, 12.89s/it]
Task 3, Epoch 14/20 => Loss 0.112, Train_accy 96.60:  65%|██████▌   | 13/20 [02:59<01:30, 12.89s/it]
Task 3, Epoch 14/20 => Loss 0.112, Train_accy 96.60:  70%|███████   | 14/20 [02:59<01:17, 12.89s/it]
Task 3, Epoch 15/20 => Loss 0.110, Train_accy 96.68:  70%|███████   | 14/20 [03:12<01:17, 12.89s/it]
Task 3, Epoch 15/20 => Loss 0.110, Train_accy 96.68:  75%|███████▌  | 15/20 [03:12<01:04, 12.89s/it]
Task 3, Epoch 16/20 => Loss 0.128, Train_accy 96.08:  75%|███████▌  | 15/20 [03:25<01:04, 12.89s/it]
Task 3, Epoch 16/20 => Loss 0.128, Train_accy 96.08:  80%|████████  | 16/20 [03:25<00:51, 12.88s/it]
Task 3, Epoch 17/20 => Loss 0.094, Train_accy 97.24:  80%|████████  | 16/20 [03:37<00:51, 12.88s/it]
Task 3, Epoch 17/20 => Loss 0.094, Train_accy 97.24:  85%|████████▌ | 17/20 [03:37<00:38, 12.87s/it]
Task 3, Epoch 18/20 => Loss 0.108, Train_accy 96.64:  85%|████████▌ | 17/20 [03:50<00:38, 12.87s/it]
Task 3, Epoch 18/20 => Loss 0.108, Train_accy 96.64:  90%|█████████ | 18/20 [03:50<00:25, 12.85s/it]
Task 3, Epoch 19/20 => Loss 0.105, Train_accy 96.80:  90%|█████████ | 18/20 [04:03<00:25, 12.85s/it]
Task 3, Epoch 19/20 => Loss 0.105, Train_accy 96.80:  95%|█████████▌| 19/20 [04:03<00:12, 12.86s/it]
Task 3, Epoch 20/20 => Loss 0.108, Train_accy 96.44:  95%|█████████▌| 19/20 [04:16<00:12, 12.86s/it]
Task 3, Epoch 20/20 => Loss 0.108, Train_accy 96.44: 100%|██████████| 20/20 [04:16<00:00, 12.86s/it]
Task 3, Epoch 20/20 => Loss 0.108, Train_accy 96.44: 100%|██████████| 20/20 [04:16<00:00, 12.83s/it]
2024-09-04 19:54:37,670 [ease.py] => Task 3, Epoch 20/20 => Loss 0.108, Train_accy 96.44
2024-09-04 19:56:09,590 [ease.py] => Task correct: 90.96923076923076
2024-09-04 19:56:09,591 [ease.py] => Task acc: 98.9076923076923
2024-09-04 19:56:09,618 [trainer.py] => No NME accuracy.
2024-09-04 19:56:09,618 [trainer.py] => CNN: {'total': 90.65, '00-49': 90.3, '50-54': 96.4, '55-59': 82.6, '60-64': 96.4, 'old': 90.17, 'new': 96.4}
2024-09-04 19:56:09,618 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65]
2024-09-04 19:56:09,618 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29]

Average Accuracy (CNN): 92.48
2024-09-04 19:56:09,618 [trainer.py] => Average Accuracy (CNN): 92.48 

2024-09-04 19:56:09,619 [trainer.py] => All params: 86306498
2024-09-04 19:56:09,620 [trainer.py] => Trainable params: 304320
2024-09-04 19:56:09,624 [ease.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.217, Train_accy 83.40:   0%|          | 0/20 [00:12<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.217, Train_accy 83.40:   5%|▌         | 1/20 [00:12<04:04, 12.86s/it]
Task 4, Epoch 2/20 => Loss 0.501, Train_accy 95.60:   5%|▌         | 1/20 [00:25<04:04, 12.86s/it]
Task 4, Epoch 2/20 => Loss 0.501, Train_accy 95.60:  10%|█         | 2/20 [00:25<03:51, 12.84s/it]
Task 4, Epoch 3/20 => Loss 0.244, Train_accy 96.00:  10%|█         | 2/20 [00:38<03:51, 12.84s/it]
Task 4, Epoch 3/20 => Loss 0.244, Train_accy 96.00:  15%|█▌        | 3/20 [00:38<03:38, 12.84s/it]
Task 4, Epoch 4/20 => Loss 0.171, Train_accy 96.12:  15%|█▌        | 3/20 [00:51<03:38, 12.84s/it]
Task 4, Epoch 4/20 => Loss 0.171, Train_accy 96.12:  20%|██        | 4/20 [00:51<03:25, 12.85s/it]
Task 4, Epoch 5/20 => Loss 0.148, Train_accy 95.96:  20%|██        | 4/20 [01:04<03:25, 12.85s/it]
Task 4, Epoch 5/20 => Loss 0.148, Train_accy 95.96:  25%|██▌       | 5/20 [01:04<03:13, 12.87s/it]
Task 4, Epoch 6/20 => Loss 0.117, Train_accy 97.40:  25%|██▌       | 5/20 [01:17<03:13, 12.87s/it]
Task 4, Epoch 6/20 => Loss 0.117, Train_accy 97.40:  30%|███       | 6/20 [01:17<03:00, 12.87s/it]
Task 4, Epoch 7/20 => Loss 0.113, Train_accy 96.88:  30%|███       | 6/20 [01:30<03:00, 12.87s/it]
Task 4, Epoch 7/20 => Loss 0.113, Train_accy 96.88:  35%|███▌      | 7/20 [01:30<02:47, 12.88s/it]
Task 4, Epoch 8/20 => Loss 0.114, Train_accy 96.80:  35%|███▌      | 7/20 [01:42<02:47, 12.88s/it]
Task 4, Epoch 8/20 => Loss 0.114, Train_accy 96.80:  40%|████      | 8/20 [01:42<02:34, 12.87s/it]
Task 4, Epoch 9/20 => Loss 0.111, Train_accy 96.48:  40%|████      | 8/20 [01:55<02:34, 12.87s/it]
Task 4, Epoch 9/20 => Loss 0.111, Train_accy 96.48:  45%|████▌     | 9/20 [01:55<02:21, 12.85s/it]
Task 4, Epoch 10/20 => Loss 0.097, Train_accy 97.08:  45%|████▌     | 9/20 [02:08<02:21, 12.85s/it]
Task 4, Epoch 10/20 => Loss 0.097, Train_accy 97.08:  50%|█████     | 10/20 [02:08<02:08, 12.84s/it]
Task 4, Epoch 11/20 => Loss 0.101, Train_accy 96.76:  50%|█████     | 10/20 [02:21<02:08, 12.84s/it]
Task 4, Epoch 11/20 => Loss 0.101, Train_accy 96.76:  55%|█████▌    | 11/20 [02:21<01:55, 12.86s/it]
Task 4, Epoch 12/20 => Loss 0.088, Train_accy 97.36:  55%|█████▌    | 11/20 [02:34<01:55, 12.86s/it]
Task 4, Epoch 12/20 => Loss 0.088, Train_accy 97.36:  60%|██████    | 12/20 [02:34<01:42, 12.86s/it]
Task 4, Epoch 13/20 => Loss 0.098, Train_accy 96.92:  60%|██████    | 12/20 [02:47<01:42, 12.86s/it]
Task 4, Epoch 13/20 => Loss 0.098, Train_accy 96.92:  65%|██████▌   | 13/20 [02:47<01:29, 12.86s/it]
Task 4, Epoch 14/20 => Loss 0.087, Train_accy 97.20:  65%|██████▌   | 13/20 [03:00<01:29, 12.86s/it]
Task 4, Epoch 14/20 => Loss 0.087, Train_accy 97.20:  70%|███████   | 14/20 [03:00<01:17, 12.90s/it]
Task 4, Epoch 15/20 => Loss 0.088, Train_accy 97.36:  70%|███████   | 14/20 [03:13<01:17, 12.90s/it]
Task 4, Epoch 15/20 => Loss 0.088, Train_accy 97.36:  75%|███████▌  | 15/20 [03:13<01:04, 12.89s/it]
Task 4, Epoch 16/20 => Loss 0.078, Train_accy 97.72:  75%|███████▌  | 15/20 [03:25<01:04, 12.89s/it]
Task 4, Epoch 16/20 => Loss 0.078, Train_accy 97.72:  80%|████████  | 16/20 [03:25<00:51, 12.88s/it]
Task 4, Epoch 17/20 => Loss 0.093, Train_accy 97.08:  80%|████████  | 16/20 [03:38<00:51, 12.88s/it]
Task 4, Epoch 17/20 => Loss 0.093, Train_accy 97.08:  85%|████████▌ | 17/20 [03:38<00:38, 12.86s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.32:  85%|████████▌ | 17/20 [03:51<00:38, 12.86s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.32:  90%|█████████ | 18/20 [03:51<00:25, 12.86s/it]
Task 4, Epoch 19/20 => Loss 0.092, Train_accy 97.16:  90%|█████████ | 18/20 [04:04<00:25, 12.86s/it]
Task 4, Epoch 19/20 => Loss 0.092, Train_accy 97.16:  95%|█████████▌| 19/20 [04:04<00:12, 12.91s/it]
Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.32:  95%|█████████▌| 19/20 [04:17<00:12, 12.91s/it]
Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.32: 100%|██████████| 20/20 [04:17<00:00, 12.90s/it]
Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.32: 100%|██████████| 20/20 [04:17<00:00, 12.87s/it]
2024-09-04 20:00:27,148 [ease.py] => Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.32
2024-09-04 20:02:27,181 [ease.py] => Task correct: 90.54285714285714
2024-09-04 20:02:27,181 [ease.py] => Task acc: 99.0
2024-09-04 20:02:27,195 [trainer.py] => No NME accuracy.
2024-09-04 20:02:27,195 [trainer.py] => CNN: {'total': 90.26, '00-49': 89.52, '50-54': 95.6, '55-59': 81.6, '60-64': 95.0, '65-69': 96.2, 'old': 89.8, 'new': 96.2}
2024-09-04 20:02:27,195 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65, 90.26]
2024-09-04 20:02:27,195 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29, 99.2]

Average Accuracy (CNN): 92.04
2024-09-04 20:02:27,195 [trainer.py] => Average Accuracy (CNN): 92.04 

2024-09-04 20:02:27,195 [trainer.py] => All params: 86375618
2024-09-04 20:02:27,196 [trainer.py] => Trainable params: 304320
2024-09-04 20:02:27,199 [ease.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.314, Train_accy 71.36:   0%|          | 0/20 [00:12<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.314, Train_accy 71.36:   5%|▌         | 1/20 [00:12<04:03, 12.80s/it]
Task 5, Epoch 2/20 => Loss 0.661, Train_accy 92.36:   5%|▌         | 1/20 [00:25<04:03, 12.80s/it]
Task 5, Epoch 2/20 => Loss 0.661, Train_accy 92.36:  10%|█         | 2/20 [00:25<03:51, 12.85s/it]
Task 5, Epoch 3/20 => Loss 0.331, Train_accy 94.24:  10%|█         | 2/20 [00:38<03:51, 12.85s/it]
Task 5, Epoch 3/20 => Loss 0.331, Train_accy 94.24:  15%|█▌        | 3/20 [00:38<03:38, 12.84s/it]
Task 5, Epoch 4/20 => Loss 0.241, Train_accy 93.96:  15%|█▌        | 3/20 [00:51<03:38, 12.84s/it]
Task 5, Epoch 4/20 => Loss 0.241, Train_accy 93.96:  20%|██        | 4/20 [00:51<03:25, 12.83s/it]
Task 5, Epoch 5/20 => Loss 0.187, Train_accy 94.88:  20%|██        | 4/20 [01:04<03:25, 12.83s/it]
Task 5, Epoch 5/20 => Loss 0.187, Train_accy 94.88:  25%|██▌       | 5/20 [01:04<03:12, 12.84s/it]
Task 5, Epoch 6/20 => Loss 0.181, Train_accy 94.72:  25%|██▌       | 5/20 [01:17<03:12, 12.84s/it]
Task 5, Epoch 6/20 => Loss 0.181, Train_accy 94.72:  30%|███       | 6/20 [01:17<03:00, 12.86s/it]
Task 5, Epoch 7/20 => Loss 0.183, Train_accy 94.96:  30%|███       | 6/20 [01:30<03:00, 12.86s/it]
Task 5, Epoch 7/20 => Loss 0.183, Train_accy 94.96:  35%|███▌      | 7/20 [01:30<02:47, 12.88s/it]
Task 5, Epoch 8/20 => Loss 0.148, Train_accy 95.52:  35%|███▌      | 7/20 [01:42<02:47, 12.88s/it]
Task 5, Epoch 8/20 => Loss 0.148, Train_accy 95.52:  40%|████      | 8/20 [01:42<02:34, 12.90s/it]
Task 5, Epoch 9/20 => Loss 0.141, Train_accy 95.84:  40%|████      | 8/20 [01:55<02:34, 12.90s/it]
Task 5, Epoch 9/20 => Loss 0.141, Train_accy 95.84:  45%|████▌     | 9/20 [01:55<02:21, 12.89s/it]
Task 5, Epoch 10/20 => Loss 0.143, Train_accy 95.56:  45%|████▌     | 9/20 [02:08<02:21, 12.89s/it]
Task 5, Epoch 10/20 => Loss 0.143, Train_accy 95.56:  50%|█████     | 10/20 [02:08<02:08, 12.90s/it]
Task 5, Epoch 11/20 => Loss 0.133, Train_accy 96.36:  50%|█████     | 10/20 [02:21<02:08, 12.90s/it]
Task 5, Epoch 11/20 => Loss 0.133, Train_accy 96.36:  55%|█████▌    | 11/20 [02:21<01:55, 12.88s/it]
Task 5, Epoch 12/20 => Loss 0.125, Train_accy 96.04:  55%|█████▌    | 11/20 [02:34<01:55, 12.88s/it]
Task 5, Epoch 12/20 => Loss 0.125, Train_accy 96.04:  60%|██████    | 12/20 [02:34<01:42, 12.87s/it]
Task 5, Epoch 13/20 => Loss 0.122, Train_accy 96.28:  60%|██████    | 12/20 [02:47<01:42, 12.87s/it]
Task 5, Epoch 13/20 => Loss 0.122, Train_accy 96.28:  65%|██████▌   | 13/20 [02:47<01:30, 12.87s/it]
Task 5, Epoch 14/20 => Loss 0.123, Train_accy 96.28:  65%|██████▌   | 13/20 [03:00<01:30, 12.87s/it]
Task 5, Epoch 14/20 => Loss 0.123, Train_accy 96.28:  70%|███████   | 14/20 [03:00<01:17, 12.88s/it]
Task 5, Epoch 15/20 => Loss 0.122, Train_accy 96.16:  70%|███████   | 14/20 [03:13<01:17, 12.88s/it]
Task 5, Epoch 15/20 => Loss 0.122, Train_accy 96.16:  75%|███████▌  | 15/20 [03:13<01:04, 12.89s/it]
Task 5, Epoch 16/20 => Loss 0.124, Train_accy 96.28:  75%|███████▌  | 15/20 [03:26<01:04, 12.89s/it]
Task 5, Epoch 16/20 => Loss 0.124, Train_accy 96.28:  80%|████████  | 16/20 [03:26<00:51, 12.90s/it]
Task 5, Epoch 17/20 => Loss 0.116, Train_accy 96.20:  80%|████████  | 16/20 [03:38<00:51, 12.90s/it]
Task 5, Epoch 17/20 => Loss 0.116, Train_accy 96.20:  85%|████████▌ | 17/20 [03:38<00:38, 12.88s/it]
Task 5, Epoch 18/20 => Loss 0.109, Train_accy 96.84:  85%|████████▌ | 17/20 [03:51<00:38, 12.88s/it]
Task 5, Epoch 18/20 => Loss 0.109, Train_accy 96.84:  90%|█████████ | 18/20 [03:51<00:25, 12.86s/it]
Task 5, Epoch 19/20 => Loss 0.111, Train_accy 96.56:  90%|█████████ | 18/20 [04:04<00:25, 12.86s/it]
Task 5, Epoch 19/20 => Loss 0.111, Train_accy 96.56:  95%|█████████▌| 19/20 [04:04<00:12, 12.86s/it]
Task 5, Epoch 20/20 => Loss 0.119, Train_accy 96.32:  95%|█████████▌| 19/20 [04:17<00:12, 12.86s/it]
Task 5, Epoch 20/20 => Loss 0.119, Train_accy 96.32: 100%|██████████| 20/20 [04:17<00:00, 12.86s/it]
Task 5, Epoch 20/20 => Loss 0.119, Train_accy 96.32: 100%|██████████| 20/20 [04:17<00:00, 12.87s/it]
2024-09-04 20:06:44,670 [ease.py] => Task 5, Epoch 20/20 => Loss 0.119, Train_accy 96.32
2024-09-04 20:09:15,781 [ease.py] => Task correct: 89.56
2024-09-04 20:09:15,781 [ease.py] => Task acc: 99.01333333333334
2024-09-04 20:09:15,798 [trainer.py] => No NME accuracy.
2024-09-04 20:09:15,798 [trainer.py] => CNN: {'total': 89.32, '00-49': 89.14, '50-54': 95.0, '55-59': 78.0, '60-64': 89.8, '65-69': 95.0, '70-74': 90.6, 'old': 89.23, 'new': 90.6}
2024-09-04 20:09:15,798 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65, 90.26, 89.32]
2024-09-04 20:09:15,798 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29, 99.2, 99.04]

Average Accuracy (CNN): 91.59
2024-09-04 20:09:15,799 [trainer.py] => Average Accuracy (CNN): 91.59 

2024-09-04 20:09:15,799 [trainer.py] => All params: 86452418
2024-09-04 20:09:15,800 [trainer.py] => Trainable params: 304320
2024-09-04 20:09:15,804 [ease.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.287, Train_accy 78.20:   0%|          | 0/20 [00:12<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.287, Train_accy 78.20:   5%|▌         | 1/20 [00:12<04:03, 12.80s/it]
Task 6, Epoch 2/20 => Loss 0.623, Train_accy 91.40:   5%|▌         | 1/20 [00:25<04:03, 12.80s/it]
Task 6, Epoch 2/20 => Loss 0.623, Train_accy 91.40:  10%|█         | 2/20 [00:25<03:51, 12.89s/it]
Task 6, Epoch 3/20 => Loss 0.307, Train_accy 93.32:  10%|█         | 2/20 [00:38<03:51, 12.89s/it]
Task 6, Epoch 3/20 => Loss 0.307, Train_accy 93.32:  15%|█▌        | 3/20 [00:38<03:38, 12.86s/it]
Task 6, Epoch 4/20 => Loss 0.211, Train_accy 94.00:  15%|█▌        | 3/20 [00:51<03:38, 12.86s/it]
Task 6, Epoch 4/20 => Loss 0.211, Train_accy 94.00:  20%|██        | 4/20 [00:51<03:25, 12.84s/it]
Task 6, Epoch 5/20 => Loss 0.172, Train_accy 95.08:  20%|██        | 4/20 [01:04<03:25, 12.84s/it]
Task 6, Epoch 5/20 => Loss 0.172, Train_accy 95.08:  25%|██▌       | 5/20 [01:04<03:12, 12.83s/it]
Task 6, Epoch 6/20 => Loss 0.177, Train_accy 94.64:  25%|██▌       | 5/20 [01:17<03:12, 12.83s/it]
Task 6, Epoch 6/20 => Loss 0.177, Train_accy 94.64:  30%|███       | 6/20 [01:17<02:59, 12.84s/it]
Task 6, Epoch 7/20 => Loss 0.144, Train_accy 95.68:  30%|███       | 6/20 [01:29<02:59, 12.84s/it]
Task 6, Epoch 7/20 => Loss 0.144, Train_accy 95.68:  35%|███▌      | 7/20 [01:29<02:46, 12.81s/it]
Task 6, Epoch 8/20 => Loss 0.140, Train_accy 95.60:  35%|███▌      | 7/20 [01:42<02:46, 12.81s/it]
Task 6, Epoch 8/20 => Loss 0.140, Train_accy 95.60:  40%|████      | 8/20 [01:42<02:33, 12.82s/it]
Task 6, Epoch 9/20 => Loss 0.133, Train_accy 96.00:  40%|████      | 8/20 [01:55<02:33, 12.82s/it]
Task 6, Epoch 9/20 => Loss 0.133, Train_accy 96.00:  45%|████▌     | 9/20 [01:55<02:21, 12.82s/it]
Task 6, Epoch 10/20 => Loss 0.119, Train_accy 96.20:  45%|████▌     | 9/20 [02:08<02:21, 12.82s/it]
Task 6, Epoch 10/20 => Loss 0.119, Train_accy 96.20:  50%|█████     | 10/20 [02:08<02:08, 12.82s/it]
Task 6, Epoch 11/20 => Loss 0.109, Train_accy 96.56:  50%|█████     | 10/20 [02:21<02:08, 12.82s/it]
Task 6, Epoch 11/20 => Loss 0.109, Train_accy 96.56:  55%|█████▌    | 11/20 [02:21<01:55, 12.81s/it]
Task 6, Epoch 12/20 => Loss 0.098, Train_accy 97.16:  55%|█████▌    | 11/20 [02:33<01:55, 12.81s/it]
Task 6, Epoch 12/20 => Loss 0.098, Train_accy 97.16:  60%|██████    | 12/20 [02:33<01:42, 12.81s/it]
Task 6, Epoch 13/20 => Loss 0.096, Train_accy 97.00:  60%|██████    | 12/20 [02:46<01:42, 12.81s/it]
Task 6, Epoch 13/20 => Loss 0.096, Train_accy 97.00:  65%|██████▌   | 13/20 [02:46<01:29, 12.81s/it]
Task 6, Epoch 14/20 => Loss 0.113, Train_accy 96.36:  65%|██████▌   | 13/20 [02:59<01:29, 12.81s/it]
Task 6, Epoch 14/20 => Loss 0.113, Train_accy 96.36:  70%|███████   | 14/20 [02:59<01:16, 12.82s/it]
Task 6, Epoch 15/20 => Loss 0.107, Train_accy 96.56:  70%|███████   | 14/20 [03:12<01:16, 12.82s/it]
Task 6, Epoch 15/20 => Loss 0.107, Train_accy 96.56:  75%|███████▌  | 15/20 [03:12<01:04, 12.80s/it]
Task 6, Epoch 16/20 => Loss 0.106, Train_accy 96.72:  75%|███████▌  | 15/20 [03:25<01:04, 12.80s/it]
Task 6, Epoch 16/20 => Loss 0.106, Train_accy 96.72:  80%|████████  | 16/20 [03:25<00:51, 12.84s/it]
Task 6, Epoch 17/20 => Loss 0.116, Train_accy 96.40:  80%|████████  | 16/20 [03:38<00:51, 12.84s/it]
Task 6, Epoch 17/20 => Loss 0.116, Train_accy 96.40:  85%|████████▌ | 17/20 [03:38<00:38, 12.87s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 96.60:  85%|████████▌ | 17/20 [03:51<00:38, 12.87s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 96.60:  90%|█████████ | 18/20 [03:51<00:25, 12.89s/it]
Task 6, Epoch 19/20 => Loss 0.107, Train_accy 96.68:  90%|█████████ | 18/20 [04:03<00:25, 12.89s/it]
Task 6, Epoch 19/20 => Loss 0.107, Train_accy 96.68:  95%|█████████▌| 19/20 [04:03<00:12, 12.87s/it]
Task 6, Epoch 20/20 => Loss 0.099, Train_accy 96.68:  95%|█████████▌| 19/20 [04:16<00:12, 12.87s/it]
Task 6, Epoch 20/20 => Loss 0.099, Train_accy 96.68: 100%|██████████| 20/20 [04:16<00:00, 12.88s/it]
Task 6, Epoch 20/20 => Loss 0.099, Train_accy 96.68: 100%|██████████| 20/20 [04:16<00:00, 12.84s/it]
2024-09-04 20:13:32,656 [ease.py] => Task 6, Epoch 20/20 => Loss 0.099, Train_accy 96.68
2024-09-04 20:16:37,019 [ease.py] => Task correct: 87.2375
2024-09-04 20:16:37,020 [ease.py] => Task acc: 99.05
2024-09-04 20:16:37,037 [trainer.py] => No NME accuracy.
2024-09-04 20:16:37,037 [trainer.py] => CNN: {'total': 87.05, '00-49': 86.78, '50-54': 84.0, '55-59': 75.4, '60-64': 89.0, '65-69': 94.8, '70-74': 86.4, '75-79': 95.4, 'old': 86.49, 'new': 95.4}
2024-09-04 20:16:37,037 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65, 90.26, 89.32, 87.05]
2024-09-04 20:16:37,037 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29, 99.2, 99.04, 98.94]

Average Accuracy (CNN): 90.94
2024-09-04 20:16:37,037 [trainer.py] => Average Accuracy (CNN): 90.94 

2024-09-04 20:16:37,037 [trainer.py] => All params: 86536898
2024-09-04 20:16:37,038 [trainer.py] => Trainable params: 304320
2024-09-04 20:16:37,042 [ease.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.256, Train_accy 81.64:   0%|          | 0/20 [00:12<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.256, Train_accy 81.64:   5%|▌         | 1/20 [00:12<04:02, 12.78s/it]
Task 7, Epoch 2/20 => Loss 0.567, Train_accy 94.16:   5%|▌         | 1/20 [00:25<04:02, 12.78s/it]
Task 7, Epoch 2/20 => Loss 0.567, Train_accy 94.16:  10%|█         | 2/20 [00:25<03:51, 12.87s/it]
Task 7, Epoch 3/20 => Loss 0.276, Train_accy 95.40:  10%|█         | 2/20 [00:38<03:51, 12.87s/it]
Task 7, Epoch 3/20 => Loss 0.276, Train_accy 95.40:  15%|█▌        | 3/20 [00:38<03:38, 12.86s/it]
Task 7, Epoch 4/20 => Loss 0.185, Train_accy 95.76:  15%|█▌        | 3/20 [00:51<03:38, 12.86s/it]
Task 7, Epoch 4/20 => Loss 0.185, Train_accy 95.76:  20%|██        | 4/20 [00:51<03:25, 12.86s/it]
Task 7, Epoch 5/20 => Loss 0.141, Train_accy 96.56:  20%|██        | 4/20 [01:04<03:25, 12.86s/it]
Task 7, Epoch 5/20 => Loss 0.141, Train_accy 96.56:  25%|██▌       | 5/20 [01:04<03:12, 12.86s/it]
Task 7, Epoch 6/20 => Loss 0.125, Train_accy 96.76:  25%|██▌       | 5/20 [01:17<03:12, 12.86s/it]
Task 7, Epoch 6/20 => Loss 0.125, Train_accy 96.76:  30%|███       | 6/20 [01:17<02:59, 12.82s/it]
Task 7, Epoch 7/20 => Loss 0.122, Train_accy 96.80:  30%|███       | 6/20 [01:30<02:59, 12.82s/it]
Task 7, Epoch 7/20 => Loss 0.122, Train_accy 96.80:  35%|███▌      | 7/20 [01:30<02:47, 12.87s/it]
Task 7, Epoch 8/20 => Loss 0.112, Train_accy 97.32:  35%|███▌      | 7/20 [01:42<02:47, 12.87s/it]
Task 7, Epoch 8/20 => Loss 0.112, Train_accy 97.32:  40%|████      | 8/20 [01:42<02:34, 12.90s/it]
Task 7, Epoch 9/20 => Loss 0.101, Train_accy 97.00:  40%|████      | 8/20 [01:55<02:34, 12.90s/it]
Task 7, Epoch 9/20 => Loss 0.101, Train_accy 97.00:  45%|████▌     | 9/20 [01:55<02:21, 12.89s/it]
Task 7, Epoch 10/20 => Loss 0.103, Train_accy 97.08:  45%|████▌     | 9/20 [02:08<02:21, 12.89s/it]
Task 7, Epoch 10/20 => Loss 0.103, Train_accy 97.08:  50%|█████     | 10/20 [02:08<02:08, 12.85s/it]
Task 7, Epoch 11/20 => Loss 0.106, Train_accy 97.04:  50%|█████     | 10/20 [02:21<02:08, 12.85s/it]
Task 7, Epoch 11/20 => Loss 0.106, Train_accy 97.04:  55%|█████▌    | 11/20 [02:21<01:55, 12.82s/it]
Task 7, Epoch 12/20 => Loss 0.107, Train_accy 97.48:  55%|█████▌    | 11/20 [02:34<01:55, 12.82s/it]
Task 7, Epoch 12/20 => Loss 0.107, Train_accy 97.48:  60%|██████    | 12/20 [02:34<01:42, 12.87s/it]
Task 7, Epoch 13/20 => Loss 0.096, Train_accy 97.40:  60%|██████    | 12/20 [02:47<01:42, 12.87s/it]
Task 7, Epoch 13/20 => Loss 0.096, Train_accy 97.40:  65%|██████▌   | 13/20 [02:47<01:30, 12.88s/it]
Task 7, Epoch 14/20 => Loss 0.085, Train_accy 97.36:  65%|██████▌   | 13/20 [03:00<01:30, 12.88s/it]
Task 7, Epoch 14/20 => Loss 0.085, Train_accy 97.36:  70%|███████   | 14/20 [03:00<01:17, 12.88s/it]
Task 7, Epoch 15/20 => Loss 0.085, Train_accy 97.60:  70%|███████   | 14/20 [03:12<01:17, 12.88s/it]
Task 7, Epoch 15/20 => Loss 0.085, Train_accy 97.60:  75%|███████▌  | 15/20 [03:12<01:04, 12.88s/it]
Task 7, Epoch 16/20 => Loss 0.091, Train_accy 97.48:  75%|███████▌  | 15/20 [03:25<01:04, 12.88s/it]
Task 7, Epoch 16/20 => Loss 0.091, Train_accy 97.48:  80%|████████  | 16/20 [03:25<00:51, 12.86s/it]
Task 7, Epoch 17/20 => Loss 0.089, Train_accy 97.48:  80%|████████  | 16/20 [03:38<00:51, 12.86s/it]
Task 7, Epoch 17/20 => Loss 0.089, Train_accy 97.48:  85%|████████▌ | 17/20 [03:38<00:38, 12.87s/it]
Task 7, Epoch 18/20 => Loss 0.082, Train_accy 97.80:  85%|████████▌ | 17/20 [03:51<00:38, 12.87s/it]
Task 7, Epoch 18/20 => Loss 0.082, Train_accy 97.80:  90%|█████████ | 18/20 [03:51<00:25, 12.88s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.88:  90%|█████████ | 18/20 [04:04<00:25, 12.88s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.88:  95%|█████████▌| 19/20 [04:04<00:12, 12.86s/it]
Task 7, Epoch 20/20 => Loss 0.075, Train_accy 98.16:  95%|█████████▌| 19/20 [04:17<00:12, 12.86s/it]
Task 7, Epoch 20/20 => Loss 0.075, Train_accy 98.16: 100%|██████████| 20/20 [04:17<00:00, 12.85s/it]
Task 7, Epoch 20/20 => Loss 0.075, Train_accy 98.16: 100%|██████████| 20/20 [04:17<00:00, 12.86s/it]
2024-09-04 20:20:54,326 [ease.py] => Task 7, Epoch 20/20 => Loss 0.075, Train_accy 98.16
2024-09-04 20:24:34,409 [ease.py] => Task correct: 86.37647058823529
2024-09-04 20:24:34,409 [ease.py] => Task acc: 99.09411764705882
2024-09-04 20:24:34,424 [trainer.py] => No NME accuracy.
2024-09-04 20:24:34,424 [trainer.py] => CNN: {'total': 86.24, '00-49': 85.06, '50-54': 83.2, '55-59': 74.0, '60-64': 86.6, '65-69': 94.8, '70-74': 86.2, '75-79': 95.6, '80-84': 95.0, 'old': 85.69, 'new': 95.0}
2024-09-04 20:24:34,424 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65, 90.26, 89.32, 87.05, 86.24]
2024-09-04 20:24:34,424 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29, 99.2, 99.04, 98.94, 98.76]

Average Accuracy (CNN): 90.35
2024-09-04 20:24:34,424 [trainer.py] => Average Accuracy (CNN): 90.35 

2024-09-04 20:24:34,425 [trainer.py] => All params: 86629058
2024-09-04 20:24:34,425 [trainer.py] => Trainable params: 304320
2024-09-04 20:24:34,431 [ease.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.380, Train_accy 69.56:   0%|          | 0/20 [00:12<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.380, Train_accy 69.56:   5%|▌         | 1/20 [00:12<04:04, 12.87s/it]
Task 8, Epoch 2/20 => Loss 0.841, Train_accy 84.28:   5%|▌         | 1/20 [00:25<04:04, 12.87s/it]
Task 8, Epoch 2/20 => Loss 0.841, Train_accy 84.28:  10%|█         | 2/20 [00:25<03:51, 12.86s/it]
Task 8, Epoch 3/20 => Loss 0.525, Train_accy 87.24:  10%|█         | 2/20 [00:38<03:51, 12.86s/it]
Task 8, Epoch 3/20 => Loss 0.525, Train_accy 87.24:  15%|█▌        | 3/20 [00:38<03:38, 12.85s/it]
Task 8, Epoch 4/20 => Loss 0.374, Train_accy 88.72:  15%|█▌        | 3/20 [00:51<03:38, 12.85s/it]
Task 8, Epoch 4/20 => Loss 0.374, Train_accy 88.72:  20%|██        | 4/20 [00:51<03:25, 12.84s/it]
Task 8, Epoch 5/20 => Loss 0.304, Train_accy 91.00:  20%|██        | 4/20 [01:04<03:25, 12.84s/it]
Task 8, Epoch 5/20 => Loss 0.304, Train_accy 91.00:  25%|██▌       | 5/20 [01:04<03:12, 12.85s/it]
Task 8, Epoch 6/20 => Loss 0.265, Train_accy 91.48:  25%|██▌       | 5/20 [01:17<03:12, 12.85s/it]
Task 8, Epoch 6/20 => Loss 0.265, Train_accy 91.48:  30%|███       | 6/20 [01:17<03:00, 12.89s/it]
Task 8, Epoch 7/20 => Loss 0.250, Train_accy 91.52:  30%|███       | 6/20 [01:29<03:00, 12.89s/it]
Task 8, Epoch 7/20 => Loss 0.250, Train_accy 91.52:  35%|███▌      | 7/20 [01:29<02:46, 12.84s/it]
Task 8, Epoch 8/20 => Loss 0.233, Train_accy 92.04:  35%|███▌      | 7/20 [01:42<02:46, 12.84s/it]
Task 8, Epoch 8/20 => Loss 0.233, Train_accy 92.04:  40%|████      | 8/20 [01:42<02:34, 12.85s/it]
Task 8, Epoch 9/20 => Loss 0.217, Train_accy 92.64:  40%|████      | 8/20 [01:55<02:34, 12.85s/it]
Task 8, Epoch 9/20 => Loss 0.217, Train_accy 92.64:  45%|████▌     | 9/20 [01:55<02:21, 12.84s/it]
Task 8, Epoch 10/20 => Loss 0.227, Train_accy 91.80:  45%|████▌     | 9/20 [02:08<02:21, 12.84s/it]
Task 8, Epoch 10/20 => Loss 0.227, Train_accy 91.80:  50%|█████     | 10/20 [02:08<02:08, 12.84s/it]
Task 8, Epoch 11/20 => Loss 0.221, Train_accy 92.84:  50%|█████     | 10/20 [02:21<02:08, 12.84s/it]
Task 8, Epoch 11/20 => Loss 0.221, Train_accy 92.84:  55%|█████▌    | 11/20 [02:21<01:55, 12.87s/it]
Task 8, Epoch 12/20 => Loss 0.215, Train_accy 92.60:  55%|█████▌    | 11/20 [02:34<01:55, 12.87s/it]
Task 8, Epoch 12/20 => Loss 0.215, Train_accy 92.60:  60%|██████    | 12/20 [02:34<01:42, 12.84s/it]
Task 8, Epoch 13/20 => Loss 0.204, Train_accy 92.80:  60%|██████    | 12/20 [02:47<01:42, 12.84s/it]
Task 8, Epoch 13/20 => Loss 0.204, Train_accy 92.80:  65%|██████▌   | 13/20 [02:47<01:29, 12.83s/it]
Task 8, Epoch 14/20 => Loss 0.205, Train_accy 92.88:  65%|██████▌   | 13/20 [02:59<01:29, 12.83s/it]
Task 8, Epoch 14/20 => Loss 0.205, Train_accy 92.88:  70%|███████   | 14/20 [02:59<01:16, 12.83s/it]
Task 8, Epoch 15/20 => Loss 0.203, Train_accy 93.24:  70%|███████   | 14/20 [03:12<01:16, 12.83s/it]
Task 8, Epoch 15/20 => Loss 0.203, Train_accy 93.24:  75%|███████▌  | 15/20 [03:12<01:04, 12.86s/it]
Task 8, Epoch 16/20 => Loss 0.197, Train_accy 92.96:  75%|███████▌  | 15/20 [03:25<01:04, 12.86s/it]
Task 8, Epoch 16/20 => Loss 0.197, Train_accy 92.96:  80%|████████  | 16/20 [03:25<00:51, 12.86s/it]
Task 8, Epoch 17/20 => Loss 0.204, Train_accy 92.56:  80%|████████  | 16/20 [03:38<00:51, 12.86s/it]
Task 8, Epoch 17/20 => Loss 0.204, Train_accy 92.56:  85%|████████▌ | 17/20 [03:38<00:38, 12.87s/it]
Task 8, Epoch 18/20 => Loss 0.198, Train_accy 93.20:  85%|████████▌ | 17/20 [03:51<00:38, 12.87s/it]
Task 8, Epoch 18/20 => Loss 0.198, Train_accy 93.20:  90%|█████████ | 18/20 [03:51<00:25, 12.89s/it]
Task 8, Epoch 19/20 => Loss 0.216, Train_accy 92.32:  90%|█████████ | 18/20 [04:04<00:25, 12.89s/it]
Task 8, Epoch 19/20 => Loss 0.216, Train_accy 92.32:  95%|█████████▌| 19/20 [04:04<00:12, 12.86s/it]
Task 8, Epoch 20/20 => Loss 0.189, Train_accy 93.92:  95%|█████████▌| 19/20 [04:17<00:12, 12.86s/it]
Task 8, Epoch 20/20 => Loss 0.189, Train_accy 93.92: 100%|██████████| 20/20 [04:17<00:00, 12.84s/it]
Task 8, Epoch 20/20 => Loss 0.189, Train_accy 93.92: 100%|██████████| 20/20 [04:17<00:00, 12.85s/it]
2024-09-04 20:28:51,534 [ease.py] => Task 8, Epoch 20/20 => Loss 0.189, Train_accy 93.92
2024-09-04 20:33:09,460 [ease.py] => Task correct: 86.32222222222222
2024-09-04 20:33:09,461 [ease.py] => Task acc: 99.0111111111111
2024-09-04 20:33:09,488 [trainer.py] => No NME accuracy.
2024-09-04 20:33:09,489 [trainer.py] => CNN: {'total': 86.16, '00-49': 84.78, '50-54': 83.4, '55-59': 74.0, '60-64': 86.2, '65-69': 94.8, '70-74': 85.6, '75-79': 94.2, '80-84': 95.2, '85-89': 89.6, 'old': 85.95, 'new': 89.6}
2024-09-04 20:33:09,489 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65, 90.26, 89.32, 87.05, 86.24, 86.16]
2024-09-04 20:33:09,489 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29, 99.2, 99.04, 98.94, 98.76, 98.66]

Average Accuracy (CNN): 89.89
2024-09-04 20:33:09,489 [trainer.py] => Average Accuracy (CNN): 89.89 

2024-09-04 20:33:09,490 [trainer.py] => All params: 86728898
2024-09-04 20:33:09,491 [trainer.py] => Trainable params: 304320
2024-09-04 20:33:09,497 [ease.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.280, Train_accy 79.60:   0%|          | 0/20 [00:12<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.280, Train_accy 79.60:   5%|▌         | 1/20 [00:12<04:03, 12.82s/it]
Task 9, Epoch 2/20 => Loss 0.625, Train_accy 91.84:   5%|▌         | 1/20 [00:25<04:03, 12.82s/it]
Task 9, Epoch 2/20 => Loss 0.625, Train_accy 91.84:  10%|█         | 2/20 [00:25<03:50, 12.80s/it]
Task 9, Epoch 3/20 => Loss 0.324, Train_accy 92.96:  10%|█         | 2/20 [00:38<03:50, 12.80s/it]
Task 9, Epoch 3/20 => Loss 0.324, Train_accy 92.96:  15%|█▌        | 3/20 [00:38<03:37, 12.78s/it]
Task 9, Epoch 4/20 => Loss 0.211, Train_accy 95.00:  15%|█▌        | 3/20 [00:51<03:37, 12.78s/it]
Task 9, Epoch 4/20 => Loss 0.211, Train_accy 95.00:  20%|██        | 4/20 [00:51<03:25, 12.83s/it]
Task 9, Epoch 5/20 => Loss 0.190, Train_accy 94.08:  20%|██        | 4/20 [01:04<03:25, 12.83s/it]
Task 9, Epoch 5/20 => Loss 0.190, Train_accy 94.08:  25%|██▌       | 5/20 [01:04<03:12, 12.85s/it]
Task 9, Epoch 6/20 => Loss 0.175, Train_accy 94.88:  25%|██▌       | 5/20 [01:16<03:12, 12.85s/it]
Task 9, Epoch 6/20 => Loss 0.175, Train_accy 94.88:  30%|███       | 6/20 [01:16<02:59, 12.82s/it]
Task 9, Epoch 7/20 => Loss 0.159, Train_accy 95.40:  30%|███       | 6/20 [01:29<02:59, 12.82s/it]
Task 9, Epoch 7/20 => Loss 0.159, Train_accy 95.40:  35%|███▌      | 7/20 [01:29<02:46, 12.83s/it]
Task 9, Epoch 8/20 => Loss 0.142, Train_accy 95.68:  35%|███▌      | 7/20 [01:42<02:46, 12.83s/it]
Task 9, Epoch 8/20 => Loss 0.142, Train_accy 95.68:  40%|████      | 8/20 [01:42<02:33, 12.81s/it]
Task 9, Epoch 9/20 => Loss 0.139, Train_accy 95.88:  40%|████      | 8/20 [01:55<02:33, 12.81s/it]
Task 9, Epoch 9/20 => Loss 0.139, Train_accy 95.88:  45%|████▌     | 9/20 [01:55<02:20, 12.81s/it]
Task 9, Epoch 10/20 => Loss 0.137, Train_accy 95.68:  45%|████▌     | 9/20 [02:08<02:20, 12.81s/it]
Task 9, Epoch 10/20 => Loss 0.137, Train_accy 95.68:  50%|█████     | 10/20 [02:08<02:08, 12.82s/it]
Task 9, Epoch 11/20 => Loss 0.123, Train_accy 96.36:  50%|█████     | 10/20 [02:21<02:08, 12.82s/it]
Task 9, Epoch 11/20 => Loss 0.123, Train_accy 96.36:  55%|█████▌    | 11/20 [02:21<01:55, 12.86s/it]
Task 9, Epoch 12/20 => Loss 0.121, Train_accy 95.92:  55%|█████▌    | 11/20 [02:34<01:55, 12.86s/it]
Task 9, Epoch 12/20 => Loss 0.121, Train_accy 95.92:  60%|██████    | 12/20 [02:34<01:42, 12.86s/it]
Task 9, Epoch 13/20 => Loss 0.111, Train_accy 96.44:  60%|██████    | 12/20 [02:46<01:42, 12.86s/it]
Task 9, Epoch 13/20 => Loss 0.111, Train_accy 96.44:  65%|██████▌   | 13/20 [02:46<01:30, 12.86s/it]
Task 9, Epoch 14/20 => Loss 0.126, Train_accy 96.12:  65%|██████▌   | 13/20 [02:59<01:30, 12.86s/it]
Task 9, Epoch 14/20 => Loss 0.126, Train_accy 96.12:  70%|███████   | 14/20 [02:59<01:17, 12.88s/it]
Task 9, Epoch 15/20 => Loss 0.105, Train_accy 96.44:  70%|███████   | 14/20 [03:12<01:17, 12.88s/it]
Task 9, Epoch 15/20 => Loss 0.105, Train_accy 96.44:  75%|███████▌  | 15/20 [03:12<01:04, 12.88s/it]
Task 9, Epoch 16/20 => Loss 0.129, Train_accy 95.72:  75%|███████▌  | 15/20 [03:25<01:04, 12.88s/it]
Task 9, Epoch 16/20 => Loss 0.129, Train_accy 95.72:  80%|████████  | 16/20 [03:25<00:51, 12.88s/it]
Task 9, Epoch 17/20 => Loss 0.123, Train_accy 95.16:  80%|████████  | 16/20 [03:38<00:51, 12.88s/it]
Task 9, Epoch 17/20 => Loss 0.123, Train_accy 95.16:  85%|████████▌ | 17/20 [03:38<00:38, 12.87s/it]
Task 9, Epoch 18/20 => Loss 0.120, Train_accy 96.44:  85%|████████▌ | 17/20 [03:51<00:38, 12.87s/it]
Task 9, Epoch 18/20 => Loss 0.120, Train_accy 96.44:  90%|█████████ | 18/20 [03:51<00:25, 12.90s/it]
Task 9, Epoch 19/20 => Loss 0.105, Train_accy 96.84:  90%|█████████ | 18/20 [04:04<00:25, 12.90s/it]
Task 9, Epoch 19/20 => Loss 0.105, Train_accy 96.84:  95%|█████████▌| 19/20 [04:04<00:12, 12.89s/it]
Task 9, Epoch 20/20 => Loss 0.116, Train_accy 96.20:  95%|█████████▌| 19/20 [04:17<00:12, 12.89s/it]
Task 9, Epoch 20/20 => Loss 0.116, Train_accy 96.20: 100%|██████████| 20/20 [04:17<00:00, 12.90s/it]
Task 9, Epoch 20/20 => Loss 0.116, Train_accy 96.20: 100%|██████████| 20/20 [04:17<00:00, 12.86s/it]
2024-09-04 20:37:26,722 [ease.py] => Task 9, Epoch 20/20 => Loss 0.116, Train_accy 96.20
2024-09-04 20:42:24,843 [ease.py] => Task correct: 86.5578947368421
2024-09-04 20:42:24,843 [ease.py] => Task acc: 99.02105263157895
2024-09-04 20:42:24,866 [trainer.py] => No NME accuracy.
2024-09-04 20:42:24,867 [trainer.py] => CNN: {'total': 86.38, '00-49': 84.46, '50-54': 83.2, '55-59': 74.0, '60-64': 86.0, '65-69': 94.6, '70-74': 85.2, '75-79': 94.2, '80-84': 95.2, '85-89': 89.4, '90-94': 94.8, 'old': 85.91, 'new': 94.8}
2024-09-04 20:42:24,867 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65, 90.26, 89.32, 87.05, 86.24, 86.16, 86.38]
2024-09-04 20:42:24,867 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29, 99.2, 99.04, 98.94, 98.76, 98.66, 98.58]

Average Accuracy (CNN): 89.54
2024-09-04 20:42:24,867 [trainer.py] => Average Accuracy (CNN): 89.54 

2024-09-04 20:42:24,868 [trainer.py] => All params: 86836418
2024-09-04 20:42:24,868 [trainer.py] => Trainable params: 304320
2024-09-04 20:42:24,879 [ease.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.317, Train_accy 73.84:   0%|          | 0/20 [00:12<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.317, Train_accy 73.84:   5%|▌         | 1/20 [00:12<04:03, 12.83s/it]
Task 10, Epoch 2/20 => Loss 0.710, Train_accy 88.60:   5%|▌         | 1/20 [00:25<04:03, 12.83s/it]
Task 10, Epoch 2/20 => Loss 0.710, Train_accy 88.60:  10%|█         | 2/20 [00:25<03:50, 12.83s/it]
Task 10, Epoch 3/20 => Loss 0.419, Train_accy 90.56:  10%|█         | 2/20 [00:38<03:50, 12.83s/it]
Task 10, Epoch 3/20 => Loss 0.419, Train_accy 90.56:  15%|█▌        | 3/20 [00:38<03:39, 12.89s/it]
Task 10, Epoch 4/20 => Loss 0.298, Train_accy 92.24:  15%|█▌        | 3/20 [00:51<03:39, 12.89s/it]
Task 10, Epoch 4/20 => Loss 0.298, Train_accy 92.24:  20%|██        | 4/20 [00:51<03:25, 12.87s/it]
Task 10, Epoch 5/20 => Loss 0.277, Train_accy 91.84:  20%|██        | 4/20 [01:04<03:25, 12.87s/it]
Task 10, Epoch 5/20 => Loss 0.277, Train_accy 91.84:  25%|██▌       | 5/20 [01:04<03:12, 12.83s/it]
Task 10, Epoch 6/20 => Loss 0.236, Train_accy 92.72:  25%|██▌       | 5/20 [01:17<03:12, 12.83s/it]
Task 10, Epoch 6/20 => Loss 0.236, Train_accy 92.72:  30%|███       | 6/20 [01:17<03:00, 12.86s/it]
Task 10, Epoch 7/20 => Loss 0.188, Train_accy 94.16:  30%|███       | 6/20 [01:29<03:00, 12.86s/it]
Task 10, Epoch 7/20 => Loss 0.188, Train_accy 94.16:  35%|███▌      | 7/20 [01:29<02:46, 12.84s/it]
Task 10, Epoch 8/20 => Loss 0.204, Train_accy 93.20:  35%|███▌      | 7/20 [01:42<02:46, 12.84s/it]
Task 10, Epoch 8/20 => Loss 0.204, Train_accy 93.20:  40%|████      | 8/20 [01:42<02:33, 12.83s/it]
Task 10, Epoch 9/20 => Loss 0.182, Train_accy 93.96:  40%|████      | 8/20 [01:55<02:33, 12.83s/it]
Task 10, Epoch 9/20 => Loss 0.182, Train_accy 93.96:  45%|████▌     | 9/20 [01:55<02:21, 12.85s/it]
Task 10, Epoch 10/20 => Loss 0.181, Train_accy 93.52:  45%|████▌     | 9/20 [02:08<02:21, 12.85s/it]
Task 10, Epoch 10/20 => Loss 0.181, Train_accy 93.52:  50%|█████     | 10/20 [02:08<02:08, 12.85s/it]
Task 10, Epoch 11/20 => Loss 0.152, Train_accy 95.20:  50%|█████     | 10/20 [02:21<02:08, 12.85s/it]
Task 10, Epoch 11/20 => Loss 0.152, Train_accy 95.20:  55%|█████▌    | 11/20 [02:21<01:55, 12.88s/it]
Task 10, Epoch 12/20 => Loss 0.168, Train_accy 94.28:  55%|█████▌    | 11/20 [02:34<01:55, 12.88s/it]
Task 10, Epoch 12/20 => Loss 0.168, Train_accy 94.28:  60%|██████    | 12/20 [02:34<01:43, 12.88s/it]
Task 10, Epoch 13/20 => Loss 0.148, Train_accy 95.00:  60%|██████    | 12/20 [02:47<01:43, 12.88s/it]
Task 10, Epoch 13/20 => Loss 0.148, Train_accy 95.00:  65%|██████▌   | 13/20 [02:47<01:30, 12.89s/it]
Task 10, Epoch 14/20 => Loss 0.177, Train_accy 94.08:  65%|██████▌   | 13/20 [03:00<01:30, 12.89s/it]
Task 10, Epoch 14/20 => Loss 0.177, Train_accy 94.08:  70%|███████   | 14/20 [03:00<01:17, 12.91s/it]
Task 10, Epoch 15/20 => Loss 0.157, Train_accy 95.00:  70%|███████   | 14/20 [03:13<01:17, 12.91s/it]
Task 10, Epoch 15/20 => Loss 0.157, Train_accy 95.00:  75%|███████▌  | 15/20 [03:13<01:04, 12.90s/it]
Task 10, Epoch 16/20 => Loss 0.155, Train_accy 94.68:  75%|███████▌  | 15/20 [03:26<01:04, 12.90s/it]
Task 10, Epoch 16/20 => Loss 0.155, Train_accy 94.68:  80%|████████  | 16/20 [03:26<00:51, 12.92s/it]
Task 10, Epoch 17/20 => Loss 0.156, Train_accy 95.20:  80%|████████  | 16/20 [03:38<00:51, 12.92s/it]
Task 10, Epoch 17/20 => Loss 0.156, Train_accy 95.20:  85%|████████▌ | 17/20 [03:38<00:38, 12.89s/it]
Task 10, Epoch 18/20 => Loss 0.164, Train_accy 94.96:  85%|████████▌ | 17/20 [03:51<00:38, 12.89s/it]
Task 10, Epoch 18/20 => Loss 0.164, Train_accy 94.96:  90%|█████████ | 18/20 [03:51<00:25, 12.85s/it]
Task 10, Epoch 19/20 => Loss 0.153, Train_accy 94.52:  90%|█████████ | 18/20 [04:04<00:25, 12.85s/it]
Task 10, Epoch 19/20 => Loss 0.153, Train_accy 94.52:  95%|█████████▌| 19/20 [04:04<00:12, 12.88s/it]
Task 10, Epoch 20/20 => Loss 0.166, Train_accy 94.24:  95%|█████████▌| 19/20 [04:17<00:12, 12.88s/it]
Task 10, Epoch 20/20 => Loss 0.166, Train_accy 94.24: 100%|██████████| 20/20 [04:17<00:00, 12.90s/it]
Task 10, Epoch 20/20 => Loss 0.166, Train_accy 94.24: 100%|██████████| 20/20 [04:17<00:00, 12.88s/it]
2024-09-04 20:46:42,436 [ease.py] => Task 10, Epoch 20/20 => Loss 0.166, Train_accy 94.24
2024-09-04 20:52:23,638 [ease.py] => Task correct: 86.11
2024-09-04 20:52:23,639 [ease.py] => Task acc: 98.97
2024-09-04 20:52:23,665 [trainer.py] => No NME accuracy.
2024-09-04 20:52:23,665 [trainer.py] => CNN: {'total': 85.9, '00-49': 83.92, '50-54': 81.6, '55-59': 73.8, '60-64': 85.4, '65-69': 93.8, '70-74': 85.0, '75-79': 92.8, '80-84': 95.2, '85-89': 88.8, '90-94': 94.6, '95-99': 87.8, 'old': 85.8, 'new': 87.8}
2024-09-04 20:52:23,665 [trainer.py] => CNN top1 curve: [94.84, 92.42, 92.03, 90.65, 90.26, 89.32, 87.05, 86.24, 86.16, 86.38, 85.9]
2024-09-04 20:52:23,665 [trainer.py] => CNN top5 curve: [99.62, 99.51, 99.3, 99.29, 99.2, 99.04, 98.94, 98.76, 98.66, 98.58, 98.39]

Average Accuracy (CNN): 89.2
2024-09-04 20:52:23,665 [trainer.py] => Average Accuracy (CNN): 89.2 

Accuracy Matrix (CNN):
[[94.84 91.96 91.48 90.3  89.52 89.14 86.78 85.06 84.78 84.46 83.92]
 [ 0.   97.   96.6  96.4  95.6  95.   84.   83.2  83.4  83.2  81.6 ]
 [ 0.    0.   93.   82.6  81.6  78.   75.4  74.   74.   74.   73.8 ]
 [ 0.    0.    0.   96.4  95.   89.8  89.   86.6  86.2  86.   85.4 ]
 [ 0.    0.    0.    0.   96.2  95.   94.8  94.8  94.8  94.6  93.8 ]
 [ 0.    0.    0.    0.    0.   90.6  86.4  86.2  85.6  85.2  85.  ]
 [ 0.    0.    0.    0.    0.    0.   95.4  95.6  94.2  94.2  92.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.   95.   95.2  95.2  95.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   89.6  89.4  88.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   94.8  94.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   87.8 ]]
2024-09-04 20:52:23,666 [trainer.py] => Forgetting (CNN): 6.832000000000001
