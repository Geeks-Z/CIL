nohup: 忽略输入
2024-09-07 08:40:16,443 [trainer.py] => config: ./exps/finetune_ina_B0_Inc5.json
2024-09-07 08:40:16,443 [trainer.py] => prefix: reproduce
2024-09-07 08:40:16,443 [trainer.py] => dataset: imageneta
2024-09-07 08:40:16,443 [trainer.py] => memory_size: 0
2024-09-07 08:40:16,443 [trainer.py] => memory_per_class: 0
2024-09-07 08:40:16,443 [trainer.py] => fixed_memory: False
2024-09-07 08:40:16,443 [trainer.py] => shuffle: True
2024-09-07 08:40:16,443 [trainer.py] => init_cls: 40
2024-09-07 08:40:16,444 [trainer.py] => increment: 40
2024-09-07 08:40:16,444 [trainer.py] => model_name: finetune
2024-09-07 08:40:16,444 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 08:40:16,444 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 08:40:16,444 [trainer.py] => seed: 1993
2024-09-07 08:40:16,444 [trainer.py] => init_epoch: 20
2024-09-07 08:40:16,444 [trainer.py] => init_lr: 0.001
2024-09-07 08:40:16,444 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 08:40:16,444 [trainer.py] => init_lr_decay: 0.1
2024-09-07 08:40:16,444 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 08:40:16,444 [trainer.py] => epochs: 20
2024-09-07 08:40:16,444 [trainer.py] => lrate: 0.001
2024-09-07 08:40:16,444 [trainer.py] => milestones: [40, 70]
2024-09-07 08:40:16,444 [trainer.py] => lrate_decay: 0.1
2024-09-07 08:40:16,444 [trainer.py] => batch_size: 48
2024-09-07 08:40:16,444 [trainer.py] => weight_decay: 0.0002
2024-09-07 08:40:16,471 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 08:40:18,289 [trainer.py] => All params: 85798656
2024-09-07 08:40:18,290 [trainer.py] => Trainable params: 85798656
2024-09-07 08:40:18,290 [finetune.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.711, Train_accy 5.71, Test_accy 7.22:   0%|          | 0/20 [00:12<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.711, Train_accy 5.71, Test_accy 7.22:   5%|▌         | 1/20 [00:12<04:05, 12.92s/it]
Task 0, Epoch 2/20 => Loss 3.476, Train_accy 7.00:   5%|▌         | 1/20 [00:24<04:05, 12.92s/it]                
Task 0, Epoch 2/20 => Loss 3.476, Train_accy 7.00:  10%|█         | 2/20 [00:24<03:36, 12.01s/it]
Task 0, Epoch 3/20 => Loss 3.415, Train_accy 8.36:  10%|█         | 2/20 [00:35<03:36, 12.01s/it]
Task 0, Epoch 3/20 => Loss 3.415, Train_accy 8.36:  15%|█▌        | 3/20 [00:35<03:19, 11.71s/it]
Task 0, Epoch 4/20 => Loss 3.336, Train_accy 10.13:  15%|█▌        | 3/20 [00:47<03:19, 11.71s/it]
Task 0, Epoch 4/20 => Loss 3.336, Train_accy 10.13:  20%|██        | 4/20 [00:47<03:05, 11.59s/it]
Task 0, Epoch 5/20 => Loss 2.722, Train_accy 26.44:  20%|██        | 4/20 [00:58<03:05, 11.59s/it]
Task 0, Epoch 5/20 => Loss 2.722, Train_accy 26.44:  25%|██▌       | 5/20 [00:58<02:52, 11.52s/it]
Task 0, Epoch 6/20 => Loss 1.987, Train_accy 44.53, Test_accy 46.94:  25%|██▌       | 5/20 [01:11<02:52, 11.52s/it]
Task 0, Epoch 6/20 => Loss 1.987, Train_accy 44.53, Test_accy 46.94:  30%|███       | 6/20 [01:11<02:48, 12.00s/it]
Task 0, Epoch 7/20 => Loss 1.456, Train_accy 57.92:  30%|███       | 6/20 [01:22<02:48, 12.00s/it]                 
Task 0, Epoch 7/20 => Loss 1.456, Train_accy 57.92:  35%|███▌      | 7/20 [01:22<02:34, 11.86s/it]
Task 0, Epoch 8/20 => Loss 1.067, Train_accy 68.12:  35%|███▌      | 7/20 [01:34<02:34, 11.86s/it]
Task 0, Epoch 8/20 => Loss 1.067, Train_accy 68.12:  40%|████      | 8/20 [01:34<02:21, 11.79s/it]
Task 0, Epoch 9/20 => Loss 0.837, Train_accy 74.71:  40%|████      | 8/20 [01:46<02:21, 11.79s/it]
Task 0, Epoch 9/20 => Loss 0.837, Train_accy 74.71:  45%|████▌     | 9/20 [01:46<02:09, 11.75s/it]
Task 0, Epoch 10/20 => Loss 0.754, Train_accy 78.31:  45%|████▌     | 9/20 [01:57<02:09, 11.75s/it]
Task 0, Epoch 10/20 => Loss 0.754, Train_accy 78.31:  50%|█████     | 10/20 [01:57<01:57, 11.74s/it]
Task 0, Epoch 11/20 => Loss 0.528, Train_accy 84.91, Test_accy 60.56:  50%|█████     | 10/20 [02:11<01:57, 11.74s/it]
Task 0, Epoch 11/20 => Loss 0.528, Train_accy 84.91, Test_accy 60.56:  55%|█████▌    | 11/20 [02:11<01:49, 12.19s/it]
Task 0, Epoch 12/20 => Loss 0.543, Train_accy 84.43:  55%|█████▌    | 11/20 [02:22<01:49, 12.19s/it]                 
Task 0, Epoch 12/20 => Loss 0.543, Train_accy 84.43:  60%|██████    | 12/20 [02:22<01:36, 12.04s/it]
Task 0, Epoch 13/20 => Loss 0.457, Train_accy 87.83:  60%|██████    | 12/20 [02:34<01:36, 12.04s/it]
Task 0, Epoch 13/20 => Loss 0.457, Train_accy 87.83:  65%|██████▌   | 13/20 [02:34<01:23, 11.93s/it]
Task 0, Epoch 14/20 => Loss 0.346, Train_accy 89.33:  65%|██████▌   | 13/20 [02:46<01:23, 11.93s/it]
Task 0, Epoch 14/20 => Loss 0.346, Train_accy 89.33:  70%|███████   | 14/20 [02:46<01:11, 11.86s/it]
Task 0, Epoch 15/20 => Loss 0.438, Train_accy 87.56:  70%|███████   | 14/20 [02:57<01:11, 11.86s/it]
Task 0, Epoch 15/20 => Loss 0.438, Train_accy 87.56:  75%|███████▌  | 15/20 [02:57<00:59, 11.83s/it]
Task 0, Epoch 16/20 => Loss 0.400, Train_accy 89.06, Test_accy 59.44:  75%|███████▌  | 15/20 [03:11<00:59, 11.83s/it]
Task 0, Epoch 16/20 => Loss 0.400, Train_accy 89.06, Test_accy 59.44:  80%|████████  | 16/20 [03:11<00:48, 12.25s/it]
Task 0, Epoch 17/20 => Loss 0.357, Train_accy 90.21:  80%|████████  | 16/20 [03:22<00:48, 12.25s/it]                 
Task 0, Epoch 17/20 => Loss 0.357, Train_accy 90.21:  85%|████████▌ | 17/20 [03:22<00:36, 12.05s/it]
Task 0, Epoch 18/20 => Loss 0.322, Train_accy 90.89:  85%|████████▌ | 17/20 [03:34<00:36, 12.05s/it]
Task 0, Epoch 18/20 => Loss 0.322, Train_accy 90.89:  90%|█████████ | 18/20 [03:34<00:23, 11.95s/it]
Task 0, Epoch 19/20 => Loss 0.334, Train_accy 89.94:  90%|█████████ | 18/20 [03:46<00:23, 11.95s/it]
Task 0, Epoch 19/20 => Loss 0.334, Train_accy 89.94:  95%|█████████▌| 19/20 [03:46<00:11, 11.87s/it]
Task 0, Epoch 20/20 => Loss 0.274, Train_accy 91.50:  95%|█████████▌| 19/20 [03:57<00:11, 11.87s/it]
Task 0, Epoch 20/20 => Loss 0.274, Train_accy 91.50: 100%|██████████| 20/20 [03:57<00:00, 11.82s/it]
Task 0, Epoch 20/20 => Loss 0.274, Train_accy 91.50: 100%|██████████| 20/20 [03:57<00:00, 11.90s/it]
2024-09-07 08:44:16,679 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.274, Train_accy 91.50
2024-09-07 08:44:18,186 [trainer.py] => No NME accuracy.
2024-09-07 08:44:18,187 [trainer.py] => CNN: {'total': 59.72, '00-39': 59.72, 'old': 0, 'new': 59.72}
2024-09-07 08:44:18,187 [trainer.py] => CNN top1 curve: [59.72]
2024-09-07 08:44:18,187 [trainer.py] => CNN top5 curve: [86.39]

Average Accuracy (CNN): 59.72
2024-09-07 08:44:18,187 [trainer.py] => Average Accuracy (CNN): 59.72 

2024-09-07 08:44:18,188 [trainer.py] => All params: 85829416
2024-09-07 08:44:18,189 [trainer.py] => Trainable params: 85829416
2024-09-07 08:44:18,191 [finetune.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.394, Train_accy 6.95, Test_accy 25.93:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.394, Train_accy 6.95, Test_accy 25.93:   5%|▌         | 1/20 [00:12<04:01, 12.74s/it]
Task 1, Epoch 2/20 => Loss 1.991, Train_accy 26.41:   5%|▌         | 1/20 [00:23<04:01, 12.74s/it]                
Task 1, Epoch 2/20 => Loss 1.991, Train_accy 26.41:  10%|█         | 2/20 [00:23<03:23, 11.33s/it]
Task 1, Epoch 3/20 => Loss 1.339, Train_accy 43.09:  10%|█         | 2/20 [00:33<03:23, 11.33s/it]
Task 1, Epoch 3/20 => Loss 1.339, Train_accy 43.09:  15%|█▌        | 3/20 [00:33<03:04, 10.87s/it]
Task 1, Epoch 4/20 => Loss 0.935, Train_accy 57.22:  15%|█▌        | 3/20 [00:43<03:04, 10.87s/it]
Task 1, Epoch 4/20 => Loss 0.935, Train_accy 57.22:  20%|██        | 4/20 [00:43<02:50, 10.66s/it]
Task 1, Epoch 5/20 => Loss 0.636, Train_accy 67.03:  20%|██        | 4/20 [00:54<02:50, 10.66s/it]
Task 1, Epoch 5/20 => Loss 0.636, Train_accy 67.03:  25%|██▌       | 5/20 [00:54<02:37, 10.52s/it]
Task 1, Epoch 6/20 => Loss 0.585, Train_accy 73.05, Test_accy 47.28:  25%|██▌       | 5/20 [01:06<02:37, 10.52s/it]
Task 1, Epoch 6/20 => Loss 0.585, Train_accy 73.05, Test_accy 47.28:  30%|███       | 6/20 [01:06<02:38, 11.31s/it]
Task 1, Epoch 7/20 => Loss 0.455, Train_accy 77.99:  30%|███       | 6/20 [01:17<02:38, 11.31s/it]                 
Task 1, Epoch 7/20 => Loss 0.455, Train_accy 77.99:  35%|███▌      | 7/20 [01:17<02:22, 10.99s/it]
Task 1, Epoch 8/20 => Loss 0.447, Train_accy 81.47:  35%|███▌      | 7/20 [01:27<02:22, 10.99s/it]
Task 1, Epoch 8/20 => Loss 0.447, Train_accy 81.47:  40%|████      | 8/20 [01:27<02:09, 10.78s/it]
Task 1, Epoch 9/20 => Loss 0.359, Train_accy 83.32:  40%|████      | 8/20 [01:37<02:09, 10.78s/it]
Task 1, Epoch 9/20 => Loss 0.359, Train_accy 83.32:  45%|████▌     | 9/20 [01:37<01:56, 10.64s/it]
Task 1, Epoch 10/20 => Loss 0.329, Train_accy 85.25:  45%|████▌     | 9/20 [01:48<01:56, 10.64s/it]
Task 1, Epoch 10/20 => Loss 0.329, Train_accy 85.25:  50%|█████     | 10/20 [01:48<01:45, 10.54s/it]
Task 1, Epoch 11/20 => Loss 0.277, Train_accy 87.18, Test_accy 47.85:  50%|█████     | 10/20 [02:00<01:45, 10.54s/it]
Task 1, Epoch 11/20 => Loss 0.277, Train_accy 87.18, Test_accy 47.85:  55%|█████▌    | 11/20 [02:00<01:40, 11.20s/it]
Task 1, Epoch 12/20 => Loss 0.278, Train_accy 87.80:  55%|█████▌    | 11/20 [02:11<01:40, 11.20s/it]                 
Task 1, Epoch 12/20 => Loss 0.278, Train_accy 87.80:  60%|██████    | 12/20 [02:11<01:27, 10.93s/it]
Task 1, Epoch 13/20 => Loss 0.309, Train_accy 87.80:  60%|██████    | 12/20 [02:21<01:27, 10.93s/it]
Task 1, Epoch 13/20 => Loss 0.309, Train_accy 87.80:  65%|██████▌   | 13/20 [02:21<01:15, 10.73s/it]
Task 1, Epoch 14/20 => Loss 0.259, Train_accy 87.34:  65%|██████▌   | 13/20 [02:31<01:15, 10.73s/it]
Task 1, Epoch 14/20 => Loss 0.259, Train_accy 87.34:  70%|███████   | 14/20 [02:31<01:03, 10.62s/it]
Task 1, Epoch 15/20 => Loss 0.241, Train_accy 88.96:  70%|███████   | 14/20 [02:42<01:03, 10.62s/it]
Task 1, Epoch 15/20 => Loss 0.241, Train_accy 88.96:  75%|███████▌  | 15/20 [02:42<00:52, 10.52s/it]
Task 1, Epoch 16/20 => Loss 0.246, Train_accy 90.66, Test_accy 47.28:  75%|███████▌  | 15/20 [02:54<00:52, 10.52s/it]
Task 1, Epoch 16/20 => Loss 0.246, Train_accy 90.66, Test_accy 47.28:  80%|████████  | 16/20 [02:54<00:44, 11.21s/it]
Task 1, Epoch 17/20 => Loss 0.229, Train_accy 89.19:  80%|████████  | 16/20 [03:05<00:44, 11.21s/it]                 
Task 1, Epoch 17/20 => Loss 0.229, Train_accy 89.19:  85%|████████▌ | 17/20 [03:05<00:32, 10.96s/it]
Task 1, Epoch 18/20 => Loss 0.249, Train_accy 89.73:  85%|████████▌ | 17/20 [03:15<00:32, 10.96s/it]
Task 1, Epoch 18/20 => Loss 0.249, Train_accy 89.73:  90%|█████████ | 18/20 [03:15<00:21, 10.77s/it]
Task 1, Epoch 19/20 => Loss 0.219, Train_accy 89.42:  90%|█████████ | 18/20 [03:25<00:21, 10.77s/it]
Task 1, Epoch 19/20 => Loss 0.219, Train_accy 89.42:  95%|█████████▌| 19/20 [03:25<00:10, 10.63s/it]
Task 1, Epoch 20/20 => Loss 0.171, Train_accy 91.27:  95%|█████████▌| 19/20 [03:36<00:10, 10.63s/it]
Task 1, Epoch 20/20 => Loss 0.171, Train_accy 91.27: 100%|██████████| 20/20 [03:36<00:00, 10.53s/it]
Task 1, Epoch 20/20 => Loss 0.171, Train_accy 91.27: 100%|██████████| 20/20 [03:36<00:00, 10.81s/it]
2024-09-07 08:47:54,421 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.171, Train_accy 91.27
2024-09-07 08:47:56,924 [trainer.py] => No NME accuracy.
2024-09-07 08:47:56,925 [trainer.py] => CNN: {'total': 48.14, '00-39': 38.89, '40-79': 57.99, 'old': 38.89, 'new': 57.99}
2024-09-07 08:47:56,925 [trainer.py] => CNN top1 curve: [59.72, 48.14]
2024-09-07 08:47:56,925 [trainer.py] => CNN top5 curve: [86.39, 75.79]

Average Accuracy (CNN): 53.93
2024-09-07 08:47:56,925 [trainer.py] => Average Accuracy (CNN): 53.93 

2024-09-07 08:47:56,927 [trainer.py] => All params: 85860176
2024-09-07 08:47:56,928 [trainer.py] => Trainable params: 85860176
2024-09-07 08:47:56,931 [finetune.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.364, Train_accy 3.92, Test_accy 26.97:   0%|          | 0/20 [00:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.364, Train_accy 3.92, Test_accy 26.97:   5%|▌         | 1/20 [00:11<03:42, 11.70s/it]
Task 2, Epoch 2/20 => Loss 1.785, Train_accy 32.86:   5%|▌         | 1/20 [00:20<03:42, 11.70s/it]                
Task 2, Epoch 2/20 => Loss 1.785, Train_accy 32.86:  10%|█         | 2/20 [00:20<02:55,  9.76s/it]
Task 2, Epoch 3/20 => Loss 1.272, Train_accy 48.52:  10%|█         | 2/20 [00:28<02:55,  9.76s/it]
Task 2, Epoch 3/20 => Loss 1.272, Train_accy 48.52:  15%|█▌        | 3/20 [00:28<02:35,  9.15s/it]
Task 2, Epoch 4/20 => Loss 0.844, Train_accy 59.31:  15%|█▌        | 3/20 [00:36<02:35,  9.15s/it]
Task 2, Epoch 4/20 => Loss 0.844, Train_accy 59.31:  20%|██        | 4/20 [00:36<02:21,  8.86s/it]
Task 2, Epoch 5/20 => Loss 0.633, Train_accy 67.14:  20%|██        | 4/20 [00:45<02:21,  8.86s/it]
Task 2, Epoch 5/20 => Loss 0.633, Train_accy 67.14:  25%|██▌       | 5/20 [00:45<02:10,  8.69s/it]
Task 2, Epoch 6/20 => Loss 0.468, Train_accy 73.26, Test_accy 38.67:  25%|██▌       | 5/20 [00:57<02:10,  8.69s/it]
Task 2, Epoch 6/20 => Loss 0.468, Train_accy 73.26, Test_accy 38.67:  30%|███       | 6/20 [00:57<02:16,  9.72s/it]
Task 2, Epoch 7/20 => Loss 0.364, Train_accy 76.79:  30%|███       | 6/20 [01:05<02:16,  9.72s/it]                 
Task 2, Epoch 7/20 => Loss 0.364, Train_accy 76.79:  35%|███▌      | 7/20 [01:05<02:00,  9.30s/it]
Task 2, Epoch 8/20 => Loss 0.352, Train_accy 77.84:  35%|███▌      | 7/20 [01:13<02:00,  9.30s/it]
Task 2, Epoch 8/20 => Loss 0.352, Train_accy 77.84:  40%|████      | 8/20 [01:13<01:48,  9.02s/it]
Task 2, Epoch 9/20 => Loss 0.401, Train_accy 78.89:  40%|████      | 8/20 [01:22<01:48,  9.02s/it]
Task 2, Epoch 9/20 => Loss 0.401, Train_accy 78.89:  45%|████▌     | 9/20 [01:22<01:37,  8.83s/it]
Task 2, Epoch 10/20 => Loss 0.265, Train_accy 85.29:  45%|████▌     | 9/20 [01:30<01:37,  8.83s/it]
Task 2, Epoch 10/20 => Loss 0.265, Train_accy 85.29:  50%|█████     | 10/20 [01:30<01:26,  8.69s/it]
Task 2, Epoch 11/20 => Loss 0.336, Train_accy 81.57, Test_accy 37.33:  50%|█████     | 10/20 [01:42<01:26,  8.69s/it]
Task 2, Epoch 11/20 => Loss 0.336, Train_accy 81.57, Test_accy 37.33:  55%|█████▌    | 11/20 [01:42<01:26,  9.60s/it]
Task 2, Epoch 12/20 => Loss 0.213, Train_accy 86.34:  55%|█████▌    | 11/20 [01:50<01:26,  9.60s/it]                 
Task 2, Epoch 12/20 => Loss 0.213, Train_accy 86.34:  60%|██████    | 12/20 [01:50<01:13,  9.23s/it]
Task 2, Epoch 13/20 => Loss 0.210, Train_accy 86.44:  60%|██████    | 12/20 [01:59<01:13,  9.23s/it]
Task 2, Epoch 13/20 => Loss 0.210, Train_accy 86.44:  65%|██████▌   | 13/20 [01:59<01:02,  8.99s/it]
Task 2, Epoch 14/20 => Loss 0.238, Train_accy 86.34:  65%|██████▌   | 13/20 [02:07<01:02,  8.99s/it]
Task 2, Epoch 14/20 => Loss 0.238, Train_accy 86.34:  70%|███████   | 14/20 [02:07<00:52,  8.81s/it]
Task 2, Epoch 15/20 => Loss 0.242, Train_accy 86.63:  70%|███████   | 14/20 [02:15<00:52,  8.81s/it]
Task 2, Epoch 15/20 => Loss 0.242, Train_accy 86.63:  75%|███████▌  | 15/20 [02:15<00:43,  8.70s/it]
Task 2, Epoch 16/20 => Loss 0.185, Train_accy 88.25, Test_accy 36.62:  75%|███████▌  | 15/20 [02:27<00:43,  8.70s/it]
Task 2, Epoch 16/20 => Loss 0.185, Train_accy 88.25, Test_accy 36.62:  80%|████████  | 16/20 [02:27<00:38,  9.58s/it]
Task 2, Epoch 17/20 => Loss 0.244, Train_accy 88.44:  80%|████████  | 16/20 [02:36<00:38,  9.58s/it]                 
Task 2, Epoch 17/20 => Loss 0.244, Train_accy 88.44:  85%|████████▌ | 17/20 [02:36<00:27,  9.23s/it]
Task 2, Epoch 18/20 => Loss 0.203, Train_accy 89.21:  85%|████████▌ | 17/20 [02:44<00:27,  9.23s/it]
Task 2, Epoch 18/20 => Loss 0.203, Train_accy 89.21:  90%|█████████ | 18/20 [02:44<00:17,  8.99s/it]
Task 2, Epoch 19/20 => Loss 0.169, Train_accy 89.40:  90%|█████████ | 18/20 [02:52<00:17,  8.99s/it]
Task 2, Epoch 19/20 => Loss 0.169, Train_accy 89.40:  95%|█████████▌| 19/20 [02:52<00:08,  8.82s/it]
Task 2, Epoch 20/20 => Loss 0.236, Train_accy 88.44:  95%|█████████▌| 19/20 [03:01<00:08,  8.82s/it]
Task 2, Epoch 20/20 => Loss 0.236, Train_accy 88.44: 100%|██████████| 20/20 [03:01<00:00,  8.69s/it]
Task 2, Epoch 20/20 => Loss 0.236, Train_accy 88.44: 100%|██████████| 20/20 [03:01<00:00,  9.06s/it]
2024-09-07 08:50:58,240 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.236, Train_accy 88.44
2024-09-07 08:51:01,525 [trainer.py] => No NME accuracy.
2024-09-07 08:51:01,525 [trainer.py] => CNN: {'total': 35.59, '00-39': 25.0, '40-79': 35.21, '80-119': 49.82, 'old': 29.94, 'new': 49.82}
2024-09-07 08:51:01,525 [trainer.py] => CNN top1 curve: [59.72, 48.14, 35.59]
2024-09-07 08:51:01,525 [trainer.py] => CNN top5 curve: [86.39, 75.79, 68.51]

Average Accuracy (CNN): 47.82
2024-09-07 08:51:01,525 [trainer.py] => Average Accuracy (CNN): 47.82 

2024-09-07 08:51:01,527 [trainer.py] => All params: 85890936
2024-09-07 08:51:01,528 [trainer.py] => Trainable params: 85890936
2024-09-07 08:51:01,531 [finetune.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.584, Train_accy 1.87, Test_accy 19.39:   0%|          | 0/20 [00:12<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.584, Train_accy 1.87, Test_accy 19.39:   5%|▌         | 1/20 [00:12<04:00, 12.64s/it]
Task 3, Epoch 2/20 => Loss 2.094, Train_accy 17.48:   5%|▌         | 1/20 [00:21<04:00, 12.64s/it]                
Task 3, Epoch 2/20 => Loss 2.094, Train_accy 17.48:  10%|█         | 2/20 [00:21<03:04, 10.24s/it]
Task 3, Epoch 3/20 => Loss 1.500, Train_accy 33.83:  10%|█         | 2/20 [00:29<03:04, 10.24s/it]
Task 3, Epoch 3/20 => Loss 1.500, Train_accy 33.83:  15%|█▌        | 3/20 [00:29<02:41,  9.50s/it]
Task 3, Epoch 4/20 => Loss 1.063, Train_accy 50.56:  15%|█▌        | 3/20 [00:38<02:41,  9.50s/it]
Task 3, Epoch 4/20 => Loss 1.063, Train_accy 50.56:  20%|██        | 4/20 [00:38<02:26,  9.14s/it]
Task 3, Epoch 5/20 => Loss 0.715, Train_accy 60.28:  20%|██        | 4/20 [00:47<02:26,  9.14s/it]
Task 3, Epoch 5/20 => Loss 0.715, Train_accy 60.28:  25%|██▌       | 5/20 [00:47<02:14,  8.94s/it]
Task 3, Epoch 6/20 => Loss 0.646, Train_accy 63.08, Test_accy 32.21:  25%|██▌       | 5/20 [00:59<02:14,  8.94s/it]
Task 3, Epoch 6/20 => Loss 0.646, Train_accy 63.08, Test_accy 32.21:  30%|███       | 6/20 [00:59<02:22, 10.19s/it]
Task 3, Epoch 7/20 => Loss 0.461, Train_accy 70.37:  30%|███       | 6/20 [01:08<02:22, 10.19s/it]                 
Task 3, Epoch 7/20 => Loss 0.461, Train_accy 70.37:  35%|███▌      | 7/20 [01:08<02:05,  9.67s/it]
Task 3, Epoch 8/20 => Loss 0.387, Train_accy 76.54:  35%|███▌      | 7/20 [01:16<02:05,  9.67s/it]
Task 3, Epoch 8/20 => Loss 0.387, Train_accy 76.54:  40%|████      | 8/20 [01:16<01:52,  9.36s/it]
Task 3, Epoch 9/20 => Loss 0.398, Train_accy 75.51:  40%|████      | 8/20 [01:25<01:52,  9.36s/it]
Task 3, Epoch 9/20 => Loss 0.398, Train_accy 75.51:  45%|████▌     | 9/20 [01:25<01:41,  9.21s/it]
Task 3, Epoch 10/20 => Loss 0.427, Train_accy 78.13:  45%|████▌     | 9/20 [01:34<01:41,  9.21s/it]
Task 3, Epoch 10/20 => Loss 0.427, Train_accy 78.13:  50%|█████     | 10/20 [01:34<01:30,  9.04s/it]
Task 3, Epoch 11/20 => Loss 0.329, Train_accy 82.24, Test_accy 30.45:  50%|█████     | 10/20 [01:47<01:30,  9.04s/it]
Task 3, Epoch 11/20 => Loss 0.329, Train_accy 82.24, Test_accy 30.45:  55%|█████▌    | 11/20 [01:47<01:31, 10.13s/it]
Task 3, Epoch 12/20 => Loss 0.314, Train_accy 80.93:  55%|█████▌    | 11/20 [01:55<01:31, 10.13s/it]                 
Task 3, Epoch 12/20 => Loss 0.314, Train_accy 80.93:  60%|██████    | 12/20 [01:55<01:17,  9.66s/it]
Task 3, Epoch 13/20 => Loss 0.272, Train_accy 84.02:  60%|██████    | 12/20 [02:04<01:17,  9.66s/it]
Task 3, Epoch 13/20 => Loss 0.272, Train_accy 84.02:  65%|██████▌   | 13/20 [02:04<01:05,  9.34s/it]
Task 3, Epoch 14/20 => Loss 0.260, Train_accy 85.61:  65%|██████▌   | 13/20 [02:12<01:05,  9.34s/it]
Task 3, Epoch 14/20 => Loss 0.260, Train_accy 85.61:  70%|███████   | 14/20 [02:12<00:54,  9.11s/it]
Task 3, Epoch 15/20 => Loss 0.220, Train_accy 86.26:  70%|███████   | 14/20 [02:21<00:54,  9.11s/it]
Task 3, Epoch 15/20 => Loss 0.220, Train_accy 86.26:  75%|███████▌  | 15/20 [02:21<00:44,  8.94s/it]
Task 3, Epoch 16/20 => Loss 0.242, Train_accy 87.66, Test_accy 30.45:  75%|███████▌  | 15/20 [02:34<00:44,  8.94s/it]
Task 3, Epoch 16/20 => Loss 0.242, Train_accy 87.66, Test_accy 30.45:  80%|████████  | 16/20 [02:34<00:40, 10.06s/it]
Task 3, Epoch 17/20 => Loss 0.252, Train_accy 86.92:  80%|████████  | 16/20 [02:42<00:40, 10.06s/it]                 
Task 3, Epoch 17/20 => Loss 0.252, Train_accy 86.92:  85%|████████▌ | 17/20 [02:42<00:28,  9.62s/it]
Task 3, Epoch 18/20 => Loss 0.205, Train_accy 89.07:  85%|████████▌ | 17/20 [02:51<00:28,  9.62s/it]
Task 3, Epoch 18/20 => Loss 0.205, Train_accy 89.07:  90%|█████████ | 18/20 [02:51<00:18,  9.32s/it]
Task 3, Epoch 19/20 => Loss 0.183, Train_accy 90.19:  90%|█████████ | 18/20 [02:59<00:18,  9.32s/it]
Task 3, Epoch 19/20 => Loss 0.183, Train_accy 90.19:  95%|█████████▌| 19/20 [02:59<00:09,  9.08s/it]
Task 3, Epoch 20/20 => Loss 0.200, Train_accy 89.72:  95%|█████████▌| 19/20 [03:08<00:09,  9.08s/it]
Task 3, Epoch 20/20 => Loss 0.200, Train_accy 89.72: 100%|██████████| 20/20 [03:08<00:00,  8.93s/it]
Task 3, Epoch 20/20 => Loss 0.200, Train_accy 89.72: 100%|██████████| 20/20 [03:08<00:00,  9.42s/it]
2024-09-07 08:54:09,888 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.200, Train_accy 89.72
2024-09-07 08:54:13,986 [trainer.py] => No NME accuracy.
2024-09-07 08:54:13,987 [trainer.py] => CNN: {'total': 27.16, '00-39': 17.78, '40-79': 22.49, '80-119': 33.57, '120-159': 38.83, 'old': 23.9, 'new': 38.83}
2024-09-07 08:54:13,987 [trainer.py] => CNN top1 curve: [59.72, 48.14, 35.59, 27.16]
2024-09-07 08:54:13,987 [trainer.py] => CNN top5 curve: [86.39, 75.79, 68.51, 56.01]

Average Accuracy (CNN): 42.65
2024-09-07 08:54:13,987 [trainer.py] => Average Accuracy (CNN): 42.65 

2024-09-07 08:54:13,989 [trainer.py] => All params: 85921696
2024-09-07 08:54:13,990 [trainer.py] => Trainable params: 85921696
2024-09-07 08:54:13,993 [finetune.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.672, Train_accy 0.82, Test_accy 13.30:   0%|          | 0/20 [00:13<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.672, Train_accy 0.82, Test_accy 13.30:   5%|▌         | 1/20 [00:13<04:19, 13.65s/it]
Task 4, Epoch 2/20 => Loss 2.094, Train_accy 17.76:   5%|▌         | 1/20 [00:22<04:19, 13.65s/it]                
Task 4, Epoch 2/20 => Loss 2.094, Train_accy 17.76:  10%|█         | 2/20 [00:22<03:15, 10.85s/it]
Task 4, Epoch 3/20 => Loss 1.536, Train_accy 30.15:  10%|█         | 2/20 [00:31<03:15, 10.85s/it]
Task 4, Epoch 3/20 => Loss 1.536, Train_accy 30.15:  15%|█▌        | 3/20 [00:31<02:48,  9.90s/it]
Task 4, Epoch 4/20 => Loss 1.012, Train_accy 44.08:  15%|█▌        | 3/20 [00:40<02:48,  9.90s/it]
Task 4, Epoch 4/20 => Loss 1.012, Train_accy 44.08:  20%|██        | 4/20 [00:40<02:31,  9.47s/it]
Task 4, Epoch 5/20 => Loss 0.716, Train_accy 56.38:  20%|██        | 4/20 [00:48<02:31,  9.47s/it]
Task 4, Epoch 5/20 => Loss 0.716, Train_accy 56.38:  25%|██▌       | 5/20 [00:48<02:18,  9.22s/it]
Task 4, Epoch 6/20 => Loss 0.557, Train_accy 62.57, Test_accy 25.21:  25%|██▌       | 5/20 [01:02<02:18,  9.22s/it]
Task 4, Epoch 6/20 => Loss 0.557, Train_accy 62.57, Test_accy 25.21:  30%|███       | 6/20 [01:02<02:30, 10.72s/it]
Task 4, Epoch 7/20 => Loss 0.501, Train_accy 67.03:  30%|███       | 6/20 [01:11<02:30, 10.72s/it]                 
Task 4, Epoch 7/20 => Loss 0.501, Train_accy 67.03:  35%|███▌      | 7/20 [01:11<02:11, 10.10s/it]
Task 4, Epoch 8/20 => Loss 0.367, Train_accy 72.31:  35%|███▌      | 7/20 [01:20<02:11, 10.10s/it]
Task 4, Epoch 8/20 => Loss 0.367, Train_accy 72.31:  40%|████      | 8/20 [01:20<01:56,  9.68s/it]
Task 4, Epoch 9/20 => Loss 0.359, Train_accy 74.23:  40%|████      | 8/20 [01:28<01:56,  9.68s/it]
Task 4, Epoch 9/20 => Loss 0.359, Train_accy 74.23:  45%|████▌     | 9/20 [01:28<01:43,  9.42s/it]
Task 4, Epoch 10/20 => Loss 0.365, Train_accy 76.87:  45%|████▌     | 9/20 [01:37<01:43,  9.42s/it]
Task 4, Epoch 10/20 => Loss 0.365, Train_accy 76.87:  50%|█████     | 10/20 [01:37<01:32,  9.23s/it]
Task 4, Epoch 11/20 => Loss 0.306, Train_accy 79.69, Test_accy 24.88:  50%|█████     | 10/20 [01:51<01:32,  9.23s/it]
Task 4, Epoch 11/20 => Loss 0.306, Train_accy 79.69, Test_accy 24.88:  55%|█████▌    | 11/20 [01:51<01:35, 10.59s/it]
Task 4, Epoch 12/20 => Loss 0.268, Train_accy 81.60:  55%|█████▌    | 11/20 [02:00<01:35, 10.59s/it]                 
Task 4, Epoch 12/20 => Loss 0.268, Train_accy 81.60:  60%|██████    | 12/20 [02:00<01:20, 10.04s/it]
Task 4, Epoch 13/20 => Loss 0.205, Train_accy 83.97:  60%|██████    | 12/20 [02:09<01:20, 10.04s/it]
Task 4, Epoch 13/20 => Loss 0.205, Train_accy 83.97:  65%|██████▌   | 13/20 [02:09<01:07,  9.67s/it]
Task 4, Epoch 14/20 => Loss 0.245, Train_accy 83.70:  65%|██████▌   | 13/20 [02:17<01:07,  9.67s/it]
Task 4, Epoch 14/20 => Loss 0.245, Train_accy 83.70:  70%|███████   | 14/20 [02:17<00:56,  9.41s/it]
Task 4, Epoch 15/20 => Loss 0.210, Train_accy 83.97:  70%|███████   | 14/20 [02:26<00:56,  9.41s/it]
Task 4, Epoch 15/20 => Loss 0.210, Train_accy 83.97:  75%|███████▌  | 15/20 [02:26<00:46,  9.23s/it]
Task 4, Epoch 16/20 => Loss 0.213, Train_accy 82.24, Test_accy 23.83:  75%|███████▌  | 15/20 [02:40<00:46,  9.23s/it]
Task 4, Epoch 16/20 => Loss 0.213, Train_accy 82.24, Test_accy 23.83:  80%|████████  | 16/20 [02:40<00:42, 10.56s/it]
Task 4, Epoch 17/20 => Loss 0.219, Train_accy 85.34:  80%|████████  | 16/20 [02:49<00:42, 10.56s/it]                 
Task 4, Epoch 17/20 => Loss 0.219, Train_accy 85.34:  85%|████████▌ | 17/20 [02:49<00:30, 10.02s/it]
Task 4, Epoch 18/20 => Loss 0.281, Train_accy 84.61:  85%|████████▌ | 17/20 [02:57<00:30, 10.02s/it]
Task 4, Epoch 18/20 => Loss 0.281, Train_accy 84.61:  90%|█████████ | 18/20 [02:57<00:19,  9.64s/it]
Task 4, Epoch 19/20 => Loss 0.178, Train_accy 87.43:  90%|█████████ | 18/20 [03:06<00:19,  9.64s/it]
Task 4, Epoch 19/20 => Loss 0.178, Train_accy 87.43:  95%|█████████▌| 19/20 [03:06<00:09,  9.42s/it]
Task 4, Epoch 20/20 => Loss 0.187, Train_accy 89.80:  95%|█████████▌| 19/20 [03:15<00:09,  9.42s/it]
Task 4, Epoch 20/20 => Loss 0.187, Train_accy 89.80: 100%|██████████| 20/20 [03:15<00:00,  9.22s/it]
Task 4, Epoch 20/20 => Loss 0.187, Train_accy 89.80: 100%|██████████| 20/20 [03:15<00:00,  9.77s/it]
2024-09-07 08:57:29,490 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.187, Train_accy 89.80
2024-09-07 08:57:34,277 [trainer.py] => No NME accuracy.
2024-09-07 08:57:34,277 [trainer.py] => CNN: {'total': 22.05, '00-39': 13.89, '40-79': 12.43, '80-119': 22.38, '120-159': 26.01, '160-199': 40.59, 'old': 18.03, 'new': 40.59}
2024-09-07 08:57:34,278 [trainer.py] => CNN top1 curve: [59.72, 48.14, 35.59, 27.16, 22.05]
2024-09-07 08:57:34,278 [trainer.py] => CNN top5 curve: [86.39, 75.79, 68.51, 56.01, 47.73]

Average Accuracy (CNN): 38.53
2024-09-07 08:57:34,278 [trainer.py] => Average Accuracy (CNN): 38.53 

Accuracy Matrix (CNN):
[[59.72 38.89 25.   17.78 13.89]
 [ 0.   57.99 35.21 22.49 12.43]
 [ 0.    0.   49.82 33.57 22.38]
 [ 0.    0.    0.   38.83 26.01]
 [ 0.    0.    0.    0.   40.59]]
2024-09-07 08:57:34,279 [trainer.py] => Forgetting (CNN): 32.9125
2024-09-07 08:57:37,036 [trainer.py] => config: ./exps/finetune_ina_B0_Inc10.json
2024-09-07 08:57:37,036 [trainer.py] => prefix: reproduce
2024-09-07 08:57:37,036 [trainer.py] => dataset: imageneta
2024-09-07 08:57:37,036 [trainer.py] => memory_size: 0
2024-09-07 08:57:37,037 [trainer.py] => memory_per_class: 0
2024-09-07 08:57:37,037 [trainer.py] => fixed_memory: False
2024-09-07 08:57:37,037 [trainer.py] => shuffle: True
2024-09-07 08:57:37,037 [trainer.py] => init_cls: 20
2024-09-07 08:57:37,037 [trainer.py] => increment: 20
2024-09-07 08:57:37,037 [trainer.py] => model_name: finetune
2024-09-07 08:57:37,037 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 08:57:37,037 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 08:57:37,037 [trainer.py] => seed: 1993
2024-09-07 08:57:37,037 [trainer.py] => init_epoch: 20
2024-09-07 08:57:37,037 [trainer.py] => init_lr: 0.001
2024-09-07 08:57:37,037 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 08:57:37,037 [trainer.py] => init_lr_decay: 0.1
2024-09-07 08:57:37,037 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 08:57:37,037 [trainer.py] => epochs: 20
2024-09-07 08:57:37,037 [trainer.py] => lrate: 0.001
2024-09-07 08:57:37,037 [trainer.py] => milestones: [40, 70]
2024-09-07 08:57:37,037 [trainer.py] => lrate_decay: 0.1
2024-09-07 08:57:37,037 [trainer.py] => batch_size: 48
2024-09-07 08:57:37,037 [trainer.py] => weight_decay: 0.0002
2024-09-07 08:57:37,063 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 08:57:38,821 [trainer.py] => All params: 85798656
2024-09-07 08:57:38,822 [trainer.py] => Trainable params: 85798656
2024-09-07 08:57:38,822 [finetune.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.040, Train_accy 8.23, Test_accy 12.00:   0%|          | 0/20 [00:06<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.040, Train_accy 8.23, Test_accy 12.00:   5%|▌         | 1/20 [00:06<02:11,  6.93s/it]
Task 0, Epoch 2/20 => Loss 2.858, Train_accy 9.08:   5%|▌         | 1/20 [00:12<02:11,  6.93s/it]                 
Task 0, Epoch 2/20 => Loss 2.858, Train_accy 9.08:  10%|█         | 2/20 [00:12<01:52,  6.22s/it]
Task 0, Epoch 3/20 => Loss 2.784, Train_accy 12.34:  10%|█         | 2/20 [00:18<01:52,  6.22s/it]
Task 0, Epoch 3/20 => Loss 2.784, Train_accy 12.34:  15%|█▌        | 3/20 [00:18<01:41,  6.00s/it]
Task 0, Epoch 4/20 => Loss 2.800, Train_accy 12.48:  15%|█▌        | 3/20 [00:24<01:41,  6.00s/it]
Task 0, Epoch 4/20 => Loss 2.800, Train_accy 12.48:  20%|██        | 4/20 [00:24<01:34,  5.90s/it]
Task 0, Epoch 5/20 => Loss 2.727, Train_accy 16.74:  20%|██        | 4/20 [00:29<01:34,  5.90s/it]
Task 0, Epoch 5/20 => Loss 2.727, Train_accy 16.74:  25%|██▌       | 5/20 [00:29<01:27,  5.85s/it]
Task 0, Epoch 6/20 => Loss 2.708, Train_accy 15.32, Test_accy 14.86:  25%|██▌       | 5/20 [00:36<01:27,  5.85s/it]
Task 0, Epoch 6/20 => Loss 2.708, Train_accy 15.32, Test_accy 14.86:  30%|███       | 6/20 [00:36<01:25,  6.14s/it]
Task 0, Epoch 7/20 => Loss 2.662, Train_accy 17.45:  30%|███       | 6/20 [00:42<01:25,  6.14s/it]                 
Task 0, Epoch 7/20 => Loss 2.662, Train_accy 17.45:  35%|███▌      | 7/20 [00:42<01:18,  6.01s/it]
Task 0, Epoch 8/20 => Loss 2.651, Train_accy 15.04:  35%|███▌      | 7/20 [00:48<01:18,  6.01s/it]
Task 0, Epoch 8/20 => Loss 2.651, Train_accy 15.04:  40%|████      | 8/20 [00:48<01:11,  5.93s/it]
Task 0, Epoch 9/20 => Loss 2.560, Train_accy 20.00:  40%|████      | 8/20 [00:53<01:11,  5.93s/it]
Task 0, Epoch 9/20 => Loss 2.560, Train_accy 20.00:  45%|████▌     | 9/20 [00:53<01:04,  5.87s/it]
Task 0, Epoch 10/20 => Loss 2.563, Train_accy 20.71:  45%|████▌     | 9/20 [00:59<01:04,  5.87s/it]
Task 0, Epoch 10/20 => Loss 2.563, Train_accy 20.71:  50%|█████     | 10/20 [00:59<00:58,  5.83s/it]
Task 0, Epoch 11/20 => Loss 2.436, Train_accy 24.68, Test_accy 18.29:  50%|█████     | 10/20 [01:06<00:58,  5.83s/it]
Task 0, Epoch 11/20 => Loss 2.436, Train_accy 24.68, Test_accy 18.29:  55%|█████▌    | 11/20 [01:06<00:54,  6.10s/it]
Task 0, Epoch 12/20 => Loss 2.430, Train_accy 22.70:  55%|█████▌    | 11/20 [01:12<00:54,  6.10s/it]                 
Task 0, Epoch 12/20 => Loss 2.430, Train_accy 22.70:  60%|██████    | 12/20 [01:12<00:47,  5.99s/it]
Task 0, Epoch 13/20 => Loss 2.119, Train_accy 33.62:  60%|██████    | 12/20 [01:17<00:47,  5.99s/it]
Task 0, Epoch 13/20 => Loss 2.119, Train_accy 33.62:  65%|██████▌   | 13/20 [01:17<00:41,  5.92s/it]
Task 0, Epoch 14/20 => Loss 1.793, Train_accy 44.40:  65%|██████▌   | 13/20 [01:23<00:41,  5.92s/it]
Task 0, Epoch 14/20 => Loss 1.793, Train_accy 44.40:  70%|███████   | 14/20 [01:23<00:35,  5.87s/it]
Task 0, Epoch 15/20 => Loss 1.302, Train_accy 59.86:  70%|███████   | 14/20 [01:29<00:35,  5.87s/it]
Task 0, Epoch 15/20 => Loss 1.302, Train_accy 59.86:  75%|███████▌  | 15/20 [01:29<00:29,  5.84s/it]
Task 0, Epoch 16/20 => Loss 1.027, Train_accy 67.23, Test_accy 59.43:  75%|███████▌  | 15/20 [01:36<00:29,  5.84s/it]
Task 0, Epoch 16/20 => Loss 1.027, Train_accy 67.23, Test_accy 59.43:  80%|████████  | 16/20 [01:36<00:24,  6.11s/it]
Task 0, Epoch 17/20 => Loss 0.724, Train_accy 77.16:  80%|████████  | 16/20 [01:41<00:24,  6.11s/it]                 
Task 0, Epoch 17/20 => Loss 0.724, Train_accy 77.16:  85%|████████▌ | 17/20 [01:41<00:17,  6.00s/it]
Task 0, Epoch 18/20 => Loss 0.515, Train_accy 82.13:  85%|████████▌ | 17/20 [01:47<00:17,  6.00s/it]
Task 0, Epoch 18/20 => Loss 0.515, Train_accy 82.13:  90%|█████████ | 18/20 [01:47<00:11,  5.94s/it]
Task 0, Epoch 19/20 => Loss 0.471, Train_accy 86.10:  90%|█████████ | 18/20 [01:53<00:11,  5.94s/it]
Task 0, Epoch 19/20 => Loss 0.471, Train_accy 86.10:  95%|█████████▌| 19/20 [01:53<00:05,  5.90s/it]
Task 0, Epoch 20/20 => Loss 0.452, Train_accy 86.95:  95%|█████████▌| 19/20 [01:59<00:05,  5.90s/it]
Task 0, Epoch 20/20 => Loss 0.452, Train_accy 86.95: 100%|██████████| 20/20 [01:59<00:00,  5.86s/it]
Task 0, Epoch 20/20 => Loss 0.452, Train_accy 86.95: 100%|██████████| 20/20 [01:59<00:00,  5.96s/it]
2024-09-07 08:59:38,476 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.452, Train_accy 86.95
2024-09-07 08:59:39,435 [trainer.py] => No NME accuracy.
2024-09-07 08:59:39,435 [trainer.py] => CNN: {'total': 62.86, '00-19': 62.86, 'old': 0, 'new': 62.86}
2024-09-07 08:59:39,436 [trainer.py] => CNN top1 curve: [62.86]
2024-09-07 08:59:39,436 [trainer.py] => CNN top5 curve: [89.71]

Average Accuracy (CNN): 62.86
2024-09-07 08:59:39,436 [trainer.py] => Average Accuracy (CNN): 62.86 

2024-09-07 08:59:39,437 [trainer.py] => All params: 85814036
2024-09-07 08:59:39,438 [trainer.py] => Trainable params: 85814036
2024-09-07 08:59:39,440 [finetune.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.130, Train_accy 6.01, Test_accy 26.67:   0%|          | 0/20 [00:07<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.130, Train_accy 6.01, Test_accy 26.67:   5%|▌         | 1/20 [00:07<02:26,  7.72s/it]
Task 1, Epoch 2/20 => Loss 2.051, Train_accy 25.98:   5%|▌         | 1/20 [00:13<02:26,  7.72s/it]                
Task 1, Epoch 2/20 => Loss 2.051, Train_accy 25.98:  10%|█         | 2/20 [00:13<02:03,  6.85s/it]
Task 1, Epoch 3/20 => Loss 1.478, Train_accy 46.08:  10%|█         | 2/20 [00:20<02:03,  6.85s/it]
Task 1, Epoch 3/20 => Loss 1.478, Train_accy 46.08:  15%|█▌        | 3/20 [00:20<01:52,  6.59s/it]
Task 1, Epoch 4/20 => Loss 1.100, Train_accy 60.31:  15%|█▌        | 3/20 [00:26<01:52,  6.59s/it]
Task 1, Epoch 4/20 => Loss 1.100, Train_accy 60.31:  20%|██        | 4/20 [00:26<01:43,  6.46s/it]
Task 1, Epoch 5/20 => Loss 0.813, Train_accy 68.02:  20%|██        | 4/20 [00:32<01:43,  6.46s/it]
Task 1, Epoch 5/20 => Loss 0.813, Train_accy 68.02:  25%|██▌       | 5/20 [00:32<01:35,  6.38s/it]
Task 1, Epoch 6/20 => Loss 0.684, Train_accy 74.67, Test_accy 50.28:  25%|██▌       | 5/20 [00:40<01:35,  6.38s/it]
Task 1, Epoch 6/20 => Loss 0.684, Train_accy 74.67, Test_accy 50.28:  30%|███       | 6/20 [00:40<01:35,  6.84s/it]
Task 1, Epoch 7/20 => Loss 0.509, Train_accy 80.29:  30%|███       | 6/20 [00:46<01:35,  6.84s/it]                 
Task 1, Epoch 7/20 => Loss 0.509, Train_accy 80.29:  35%|███▌      | 7/20 [00:46<01:26,  6.66s/it]
Task 1, Epoch 8/20 => Loss 0.457, Train_accy 82.51:  35%|███▌      | 7/20 [00:52<01:26,  6.66s/it]
Task 1, Epoch 8/20 => Loss 0.457, Train_accy 82.51:  40%|████      | 8/20 [00:52<01:18,  6.51s/it]
Task 1, Epoch 9/20 => Loss 0.519, Train_accy 81.98:  40%|████      | 8/20 [00:59<01:18,  6.51s/it]
Task 1, Epoch 9/20 => Loss 0.519, Train_accy 81.98:  45%|████▌     | 9/20 [00:59<01:10,  6.43s/it]
Task 1, Epoch 10/20 => Loss 0.405, Train_accy 81.85:  45%|████▌     | 9/20 [01:05<01:10,  6.43s/it]
Task 1, Epoch 10/20 => Loss 0.405, Train_accy 81.85:  50%|█████     | 10/20 [01:05<01:03,  6.38s/it]
Task 1, Epoch 11/20 => Loss 0.347, Train_accy 85.64, Test_accy 49.44:  50%|█████     | 10/20 [01:13<01:03,  6.38s/it]
Task 1, Epoch 11/20 => Loss 0.347, Train_accy 85.64, Test_accy 49.44:  55%|█████▌    | 11/20 [01:13<01:01,  6.78s/it]
Task 1, Epoch 12/20 => Loss 0.389, Train_accy 83.81:  55%|█████▌    | 11/20 [01:19<01:01,  6.78s/it]                 
Task 1, Epoch 12/20 => Loss 0.389, Train_accy 83.81:  60%|██████    | 12/20 [01:19<00:52,  6.62s/it]
Task 1, Epoch 13/20 => Loss 0.277, Train_accy 89.03:  60%|██████    | 12/20 [01:25<00:52,  6.62s/it]
Task 1, Epoch 13/20 => Loss 0.277, Train_accy 89.03:  65%|██████▌   | 13/20 [01:25<00:45,  6.51s/it]
Task 1, Epoch 14/20 => Loss 0.327, Train_accy 86.42:  65%|██████▌   | 13/20 [01:31<00:45,  6.51s/it]
Task 1, Epoch 14/20 => Loss 0.327, Train_accy 86.42:  70%|███████   | 14/20 [01:31<00:38,  6.43s/it]
Task 1, Epoch 15/20 => Loss 0.266, Train_accy 88.77:  70%|███████   | 14/20 [01:38<00:38,  6.43s/it]
Task 1, Epoch 15/20 => Loss 0.266, Train_accy 88.77:  75%|███████▌  | 15/20 [01:38<00:31,  6.38s/it]
Task 1, Epoch 16/20 => Loss 0.257, Train_accy 90.21, Test_accy 46.11:  75%|███████▌  | 15/20 [01:45<00:31,  6.38s/it]
Task 1, Epoch 16/20 => Loss 0.257, Train_accy 90.21, Test_accy 46.11:  80%|████████  | 16/20 [01:45<00:27,  6.78s/it]
Task 1, Epoch 17/20 => Loss 0.253, Train_accy 90.21:  80%|████████  | 16/20 [01:52<00:27,  6.78s/it]                 
Task 1, Epoch 17/20 => Loss 0.253, Train_accy 90.21:  85%|████████▌ | 17/20 [01:52<00:19,  6.62s/it]
Task 1, Epoch 18/20 => Loss 0.253, Train_accy 90.60:  85%|████████▌ | 17/20 [01:58<00:19,  6.62s/it]
Task 1, Epoch 18/20 => Loss 0.253, Train_accy 90.60:  90%|█████████ | 18/20 [01:58<00:13,  6.51s/it]
Task 1, Epoch 19/20 => Loss 0.215, Train_accy 90.08:  90%|█████████ | 18/20 [02:04<00:13,  6.51s/it]
Task 1, Epoch 19/20 => Loss 0.215, Train_accy 90.08:  95%|█████████▌| 19/20 [02:04<00:06,  6.44s/it]
Task 1, Epoch 20/20 => Loss 0.204, Train_accy 91.25:  95%|█████████▌| 19/20 [02:10<00:06,  6.44s/it]
Task 1, Epoch 20/20 => Loss 0.204, Train_accy 91.25: 100%|██████████| 20/20 [02:10<00:00,  6.37s/it]
Task 1, Epoch 20/20 => Loss 0.204, Train_accy 91.25: 100%|██████████| 20/20 [02:10<00:00,  6.54s/it]
2024-09-07 09:01:50,346 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.204, Train_accy 91.25
2024-09-07 09:01:51,826 [trainer.py] => No NME accuracy.
2024-09-07 09:01:51,826 [trainer.py] => CNN: {'total': 46.94, '00-19': 35.43, '20-39': 57.84, 'old': 35.43, 'new': 57.84}
2024-09-07 09:01:51,826 [trainer.py] => CNN top1 curve: [62.86, 46.94]
2024-09-07 09:01:51,827 [trainer.py] => CNN top5 curve: [89.71, 82.5]

Average Accuracy (CNN): 54.9
2024-09-07 09:01:51,827 [trainer.py] => Average Accuracy (CNN): 54.9 

2024-09-07 09:01:51,828 [trainer.py] => All params: 85829416
2024-09-07 09:01:51,829 [trainer.py] => Trainable params: 85829416
2024-09-07 09:01:51,831 [finetune.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.905, Train_accy 1.76, Test_accy 26.89:   0%|          | 0/20 [00:06<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.905, Train_accy 1.76, Test_accy 26.89:   5%|▌         | 1/20 [00:06<01:55,  6.09s/it]
Task 2, Epoch 2/20 => Loss 1.601, Train_accy 18.40:   5%|▌         | 1/20 [00:10<01:55,  6.09s/it]                
Task 2, Epoch 2/20 => Loss 1.601, Train_accy 18.40:  10%|█         | 2/20 [00:10<01:30,  5.02s/it]
Task 2, Epoch 3/20 => Loss 0.987, Train_accy 40.31:  10%|█         | 2/20 [00:14<01:30,  5.02s/it]
Task 2, Epoch 3/20 => Loss 0.987, Train_accy 40.31:  15%|█▌        | 3/20 [00:14<01:19,  4.68s/it]
Task 2, Epoch 4/20 => Loss 0.701, Train_accy 54.99:  15%|█▌        | 3/20 [00:19<01:19,  4.68s/it]
Task 2, Epoch 4/20 => Loss 0.701, Train_accy 54.99:  20%|██        | 4/20 [00:19<01:12,  4.56s/it]
Task 2, Epoch 5/20 => Loss 0.496, Train_accy 62.23:  20%|██        | 4/20 [00:23<01:12,  4.56s/it]
Task 2, Epoch 5/20 => Loss 0.496, Train_accy 62.23:  25%|██▌       | 5/20 [00:23<01:06,  4.46s/it]
Task 2, Epoch 6/20 => Loss 0.390, Train_accy 70.25, Test_accy 38.24:  25%|██▌       | 5/20 [00:29<01:06,  4.46s/it]
Task 2, Epoch 6/20 => Loss 0.390, Train_accy 70.25, Test_accy 38.24:  30%|███       | 6/20 [00:29<01:10,  5.02s/it]
Task 2, Epoch 7/20 => Loss 0.255, Train_accy 79.65:  30%|███       | 6/20 [00:33<01:10,  5.02s/it]                 
Task 2, Epoch 7/20 => Loss 0.255, Train_accy 79.65:  35%|███▌      | 7/20 [00:33<01:02,  4.77s/it]
Task 2, Epoch 8/20 => Loss 0.274, Train_accy 82.00:  35%|███▌      | 7/20 [00:37<01:02,  4.77s/it]
Task 2, Epoch 8/20 => Loss 0.274, Train_accy 82.00:  40%|████      | 8/20 [00:37<00:55,  4.62s/it]
Task 2, Epoch 9/20 => Loss 0.222, Train_accy 82.19:  40%|████      | 8/20 [00:42<00:55,  4.62s/it]
Task 2, Epoch 9/20 => Loss 0.222, Train_accy 82.19:  45%|████▌     | 9/20 [00:42<00:49,  4.51s/it]
Task 2, Epoch 10/20 => Loss 0.184, Train_accy 82.19:  45%|████▌     | 9/20 [00:46<00:49,  4.51s/it]
Task 2, Epoch 10/20 => Loss 0.184, Train_accy 82.19:  50%|█████     | 10/20 [00:46<00:44,  4.44s/it]
Task 2, Epoch 11/20 => Loss 0.176, Train_accy 84.15, Test_accy 39.92:  50%|█████     | 10/20 [00:52<00:44,  4.44s/it]
Task 2, Epoch 11/20 => Loss 0.176, Train_accy 84.15, Test_accy 39.92:  55%|█████▌    | 11/20 [00:52<00:44,  4.96s/it]
Task 2, Epoch 12/20 => Loss 0.218, Train_accy 83.37:  55%|█████▌    | 11/20 [00:56<00:44,  4.96s/it]                 
Task 2, Epoch 12/20 => Loss 0.218, Train_accy 83.37:  60%|██████    | 12/20 [00:56<00:38,  4.75s/it]
Task 2, Epoch 13/20 => Loss 0.204, Train_accy 83.76:  60%|██████    | 12/20 [01:01<00:38,  4.75s/it]
Task 2, Epoch 13/20 => Loss 0.204, Train_accy 83.76:  65%|██████▌   | 13/20 [01:01<00:32,  4.61s/it]
Task 2, Epoch 14/20 => Loss 0.220, Train_accy 79.65:  65%|██████▌   | 13/20 [01:05<00:32,  4.61s/it]
Task 2, Epoch 14/20 => Loss 0.220, Train_accy 79.65:  70%|███████   | 14/20 [01:05<00:27,  4.51s/it]
Task 2, Epoch 15/20 => Loss 0.191, Train_accy 82.97:  70%|███████   | 14/20 [01:09<00:27,  4.51s/it]
Task 2, Epoch 15/20 => Loss 0.191, Train_accy 82.97:  75%|███████▌  | 15/20 [01:09<00:22,  4.44s/it]
Task 2, Epoch 16/20 => Loss 0.171, Train_accy 86.89, Test_accy 38.24:  75%|███████▌  | 15/20 [01:15<00:22,  4.44s/it]
Task 2, Epoch 16/20 => Loss 0.171, Train_accy 86.89, Test_accy 38.24:  80%|████████  | 16/20 [01:15<00:19,  4.94s/it]
Task 2, Epoch 17/20 => Loss 0.185, Train_accy 86.69:  80%|████████  | 16/20 [01:20<00:19,  4.94s/it]                 
Task 2, Epoch 17/20 => Loss 0.185, Train_accy 86.69:  85%|████████▌ | 17/20 [01:20<00:14,  4.74s/it]
Task 2, Epoch 18/20 => Loss 0.122, Train_accy 86.50:  85%|████████▌ | 17/20 [01:24<00:14,  4.74s/it]
Task 2, Epoch 18/20 => Loss 0.122, Train_accy 86.50:  90%|█████████ | 18/20 [01:24<00:09,  4.60s/it]
Task 2, Epoch 19/20 => Loss 0.148, Train_accy 88.65:  90%|█████████ | 18/20 [01:28<00:09,  4.60s/it]
Task 2, Epoch 19/20 => Loss 0.148, Train_accy 88.65:  95%|█████████▌| 19/20 [01:28<00:04,  4.51s/it]
Task 2, Epoch 20/20 => Loss 0.135, Train_accy 86.30:  95%|█████████▌| 19/20 [01:32<00:04,  4.51s/it]
Task 2, Epoch 20/20 => Loss 0.135, Train_accy 86.30: 100%|██████████| 20/20 [01:32<00:00,  4.44s/it]
Task 2, Epoch 20/20 => Loss 0.135, Train_accy 86.30: 100%|██████████| 20/20 [01:32<00:00,  4.65s/it]
2024-09-07 09:03:24,825 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.135, Train_accy 86.30
2024-09-07 09:03:26,634 [trainer.py] => No NME accuracy.
2024-09-07 09:03:26,634 [trainer.py] => CNN: {'total': 38.03, '00-19': 28.0, '20-39': 37.84, '40-59': 53.45, 'old': 33.06, 'new': 53.45}
2024-09-07 09:03:26,634 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03]
2024-09-07 09:03:26,634 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16]

Average Accuracy (CNN): 49.28
2024-09-07 09:03:26,634 [trainer.py] => Average Accuracy (CNN): 49.28 

2024-09-07 09:03:26,636 [trainer.py] => All params: 85844796
2024-09-07 09:03:26,637 [trainer.py] => Trainable params: 85844796
2024-09-07 09:03:26,639 [finetune.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.896, Train_accy 2.68, Test_accy 19.34:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.896, Train_accy 2.68, Test_accy 19.34:   5%|▌         | 1/20 [00:08<02:47,  8.81s/it]
Task 3, Epoch 2/20 => Loss 1.481, Train_accy 25.38:   5%|▌         | 1/20 [00:15<02:47,  8.81s/it]                
Task 3, Epoch 2/20 => Loss 1.481, Train_accy 25.38:  10%|█         | 2/20 [00:15<02:12,  7.38s/it]
Task 3, Epoch 3/20 => Loss 0.952, Train_accy 44.77:  10%|█         | 2/20 [00:21<02:12,  7.38s/it]
Task 3, Epoch 3/20 => Loss 0.952, Train_accy 44.77:  15%|█▌        | 3/20 [00:21<01:58,  6.95s/it]
Task 3, Epoch 4/20 => Loss 0.630, Train_accy 56.63:  15%|█▌        | 3/20 [00:28<01:58,  6.95s/it]
Task 3, Epoch 4/20 => Loss 0.630, Train_accy 56.63:  20%|██        | 4/20 [00:28<01:47,  6.73s/it]
Task 3, Epoch 5/20 => Loss 0.462, Train_accy 65.94:  20%|██        | 4/20 [00:34<01:47,  6.73s/it]
Task 3, Epoch 5/20 => Loss 0.462, Train_accy 65.94:  25%|██▌       | 5/20 [00:34<01:39,  6.63s/it]
Task 3, Epoch 6/20 => Loss 0.357, Train_accy 70.28, Test_accy 37.25:  25%|██▌       | 5/20 [00:43<01:39,  6.63s/it]
Task 3, Epoch 6/20 => Loss 0.357, Train_accy 70.28, Test_accy 37.25:  30%|███       | 6/20 [00:43<01:43,  7.39s/it]
Task 3, Epoch 7/20 => Loss 0.301, Train_accy 76.79:  30%|███       | 6/20 [00:49<01:43,  7.39s/it]                 
Task 3, Epoch 7/20 => Loss 0.301, Train_accy 76.79:  35%|███▌      | 7/20 [00:49<01:31,  7.06s/it]
Task 3, Epoch 8/20 => Loss 0.382, Train_accy 74.62:  35%|███▌      | 7/20 [00:56<01:31,  7.06s/it]
Task 3, Epoch 8/20 => Loss 0.382, Train_accy 74.62:  40%|████      | 8/20 [00:56<01:22,  6.84s/it]
Task 3, Epoch 9/20 => Loss 0.352, Train_accy 76.91:  40%|████      | 8/20 [01:02<01:22,  6.84s/it]
Task 3, Epoch 9/20 => Loss 0.352, Train_accy 76.91:  45%|████▌     | 9/20 [01:02<01:13,  6.71s/it]
Task 3, Epoch 10/20 => Loss 0.262, Train_accy 81.38:  45%|████▌     | 9/20 [01:08<01:13,  6.71s/it]
Task 3, Epoch 10/20 => Loss 0.262, Train_accy 81.38:  50%|█████     | 10/20 [01:08<01:06,  6.62s/it]
Task 3, Epoch 11/20 => Loss 0.236, Train_accy 83.80, Test_accy 39.11:  50%|█████     | 10/20 [01:17<01:06,  6.62s/it]
Task 3, Epoch 11/20 => Loss 0.236, Train_accy 83.80, Test_accy 39.11:  55%|█████▌    | 11/20 [01:17<01:05,  7.32s/it]
Task 3, Epoch 12/20 => Loss 0.194, Train_accy 83.16:  55%|█████▌    | 11/20 [01:24<01:05,  7.32s/it]                 
Task 3, Epoch 12/20 => Loss 0.194, Train_accy 83.16:  60%|██████    | 12/20 [01:24<00:56,  7.03s/it]
Task 3, Epoch 13/20 => Loss 0.213, Train_accy 84.06:  60%|██████    | 12/20 [01:30<00:56,  7.03s/it]
Task 3, Epoch 13/20 => Loss 0.213, Train_accy 84.06:  65%|██████▌   | 13/20 [01:30<00:47,  6.83s/it]
Task 3, Epoch 14/20 => Loss 0.235, Train_accy 84.44:  65%|██████▌   | 13/20 [01:37<00:47,  6.83s/it]
Task 3, Epoch 14/20 => Loss 0.235, Train_accy 84.44:  70%|███████   | 14/20 [01:37<00:40,  6.74s/it]
Task 3, Epoch 15/20 => Loss 0.250, Train_accy 82.27:  70%|███████   | 14/20 [01:43<00:40,  6.74s/it]
Task 3, Epoch 15/20 => Loss 0.250, Train_accy 82.27:  75%|███████▌  | 15/20 [01:43<00:33,  6.71s/it]
Task 3, Epoch 16/20 => Loss 0.155, Train_accy 85.71, Test_accy 38.11:  75%|███████▌  | 15/20 [01:52<00:33,  6.71s/it]
Task 3, Epoch 16/20 => Loss 0.155, Train_accy 85.71, Test_accy 38.11:  80%|████████  | 16/20 [01:52<00:29,  7.36s/it]
Task 3, Epoch 17/20 => Loss 0.154, Train_accy 86.61:  80%|████████  | 16/20 [01:59<00:29,  7.36s/it]                 
Task 3, Epoch 17/20 => Loss 0.154, Train_accy 86.61:  85%|████████▌ | 17/20 [01:59<00:21,  7.07s/it]
Task 3, Epoch 18/20 => Loss 0.226, Train_accy 88.14:  85%|████████▌ | 17/20 [02:05<00:21,  7.07s/it]
Task 3, Epoch 18/20 => Loss 0.226, Train_accy 88.14:  90%|█████████ | 18/20 [02:05<00:13,  6.86s/it]
Task 3, Epoch 19/20 => Loss 0.161, Train_accy 87.24:  90%|█████████ | 18/20 [02:11<00:13,  6.86s/it]
Task 3, Epoch 19/20 => Loss 0.161, Train_accy 87.24:  95%|█████████▌| 19/20 [02:11<00:06,  6.72s/it]
Task 3, Epoch 20/20 => Loss 0.184, Train_accy 86.86:  95%|█████████▌| 19/20 [02:18<00:06,  6.72s/it]
Task 3, Epoch 20/20 => Loss 0.184, Train_accy 86.86: 100%|██████████| 20/20 [02:18<00:00,  6.63s/it]
Task 3, Epoch 20/20 => Loss 0.184, Train_accy 86.86: 100%|██████████| 20/20 [02:18<00:00,  6.91s/it]
2024-09-07 09:05:44,841 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.184, Train_accy 86.86
2024-09-07 09:05:47,293 [trainer.py] => No NME accuracy.
2024-09-07 09:05:47,293 [trainer.py] => CNN: {'total': 35.24, '00-19': 17.14, '20-39': 25.95, '40-59': 38.79, '60-79': 55.41, 'old': 25.84, 'new': 55.41}
2024-09-07 09:05:47,293 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03, 35.24]
2024-09-07 09:05:47,293 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16, 66.91]

Average Accuracy (CNN): 45.77
2024-09-07 09:05:47,293 [trainer.py] => Average Accuracy (CNN): 45.77 

2024-09-07 09:05:47,295 [trainer.py] => All params: 85860176
2024-09-07 09:05:47,296 [trainer.py] => Trainable params: 85860176
2024-09-07 09:05:47,299 [finetune.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.113, Train_accy 3.44, Test_accy 19.86:   0%|          | 0/20 [00:07<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.113, Train_accy 3.44, Test_accy 19.86:   5%|▌         | 1/20 [00:07<02:18,  7.29s/it]
Task 4, Epoch 2/20 => Loss 1.323, Train_accy 32.82:   5%|▌         | 1/20 [00:11<02:18,  7.29s/it]                
Task 4, Epoch 2/20 => Loss 1.323, Train_accy 32.82:  10%|█         | 2/20 [00:11<01:40,  5.58s/it]
Task 4, Epoch 3/20 => Loss 0.870, Train_accy 51.53:  10%|█         | 2/20 [00:16<01:40,  5.58s/it]
Task 4, Epoch 3/20 => Loss 0.870, Train_accy 51.53:  15%|█▌        | 3/20 [00:16<01:25,  5.03s/it]
Task 4, Epoch 4/20 => Loss 0.583, Train_accy 64.12:  15%|█▌        | 3/20 [00:20<01:25,  5.03s/it]
Task 4, Epoch 4/20 => Loss 0.583, Train_accy 64.12:  20%|██        | 4/20 [00:20<01:16,  4.78s/it]
Task 4, Epoch 5/20 => Loss 0.430, Train_accy 66.98:  20%|██        | 4/20 [00:24<01:16,  4.78s/it]
Task 4, Epoch 5/20 => Loss 0.430, Train_accy 66.98:  25%|██▌       | 5/20 [00:24<01:10,  4.68s/it]
Task 4, Epoch 6/20 => Loss 0.297, Train_accy 73.28, Test_accy 26.04:  25%|██▌       | 5/20 [00:32<01:10,  4.68s/it]
Task 4, Epoch 6/20 => Loss 0.297, Train_accy 73.28, Test_accy 26.04:  30%|███       | 6/20 [00:32<01:17,  5.53s/it]
Task 4, Epoch 7/20 => Loss 0.266, Train_accy 77.67:  30%|███       | 6/20 [00:36<01:17,  5.53s/it]                 
Task 4, Epoch 7/20 => Loss 0.266, Train_accy 77.67:  35%|███▌      | 7/20 [00:36<01:07,  5.16s/it]
Task 4, Epoch 8/20 => Loss 0.278, Train_accy 79.39:  35%|███▌      | 7/20 [00:40<01:07,  5.16s/it]
Task 4, Epoch 8/20 => Loss 0.278, Train_accy 79.39:  40%|████      | 8/20 [00:40<00:58,  4.91s/it]
Task 4, Epoch 9/20 => Loss 0.186, Train_accy 81.30:  40%|████      | 8/20 [00:45<00:58,  4.91s/it]
Task 4, Epoch 9/20 => Loss 0.186, Train_accy 81.30:  45%|████▌     | 9/20 [00:45<00:52,  4.75s/it]
Task 4, Epoch 10/20 => Loss 0.190, Train_accy 79.39:  45%|████▌     | 9/20 [00:49<00:52,  4.75s/it]
Task 4, Epoch 10/20 => Loss 0.190, Train_accy 79.39:  50%|█████     | 10/20 [00:49<00:46,  4.64s/it]
Task 4, Epoch 11/20 => Loss 0.163, Train_accy 80.34, Test_accy 27.71:  50%|█████     | 10/20 [00:56<00:46,  4.64s/it]
Task 4, Epoch 11/20 => Loss 0.163, Train_accy 80.34, Test_accy 27.71:  55%|█████▌    | 11/20 [00:56<00:48,  5.44s/it]
Task 4, Epoch 12/20 => Loss 0.189, Train_accy 79.77:  55%|█████▌    | 11/20 [01:01<00:48,  5.44s/it]                 
Task 4, Epoch 12/20 => Loss 0.189, Train_accy 79.77:  60%|██████    | 12/20 [01:01<00:40,  5.12s/it]
Task 4, Epoch 13/20 => Loss 0.211, Train_accy 82.63:  60%|██████    | 12/20 [01:05<00:40,  5.12s/it]
Task 4, Epoch 13/20 => Loss 0.211, Train_accy 82.63:  65%|██████▌   | 13/20 [01:05<00:34,  4.89s/it]
Task 4, Epoch 14/20 => Loss 0.154, Train_accy 85.88:  65%|██████▌   | 13/20 [01:10<00:34,  4.89s/it]
Task 4, Epoch 14/20 => Loss 0.154, Train_accy 85.88:  70%|███████   | 14/20 [01:10<00:28,  4.74s/it]
Task 4, Epoch 15/20 => Loss 0.140, Train_accy 81.30:  70%|███████   | 14/20 [01:14<00:28,  4.74s/it]
Task 4, Epoch 15/20 => Loss 0.140, Train_accy 81.30:  75%|███████▌  | 15/20 [01:14<00:23,  4.63s/it]
Task 4, Epoch 16/20 => Loss 0.170, Train_accy 86.64, Test_accy 26.40:  75%|███████▌  | 15/20 [01:21<00:23,  4.63s/it]
Task 4, Epoch 16/20 => Loss 0.170, Train_accy 86.64, Test_accy 26.40:  80%|████████  | 16/20 [01:21<00:21,  5.45s/it]
Task 4, Epoch 17/20 => Loss 0.150, Train_accy 88.17:  80%|████████  | 16/20 [01:26<00:21,  5.45s/it]                 
Task 4, Epoch 17/20 => Loss 0.150, Train_accy 88.17:  85%|████████▌ | 17/20 [01:26<00:15,  5.13s/it]
Task 4, Epoch 18/20 => Loss 0.113, Train_accy 87.02:  85%|████████▌ | 17/20 [01:30<00:15,  5.13s/it]
Task 4, Epoch 18/20 => Loss 0.113, Train_accy 87.02:  90%|█████████ | 18/20 [01:30<00:09,  4.92s/it]
Task 4, Epoch 19/20 => Loss 0.142, Train_accy 88.55:  90%|█████████ | 18/20 [01:35<00:09,  4.92s/it]
Task 4, Epoch 19/20 => Loss 0.142, Train_accy 88.55:  95%|█████████▌| 19/20 [01:35<00:04,  4.76s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 86.45:  95%|█████████▌| 19/20 [01:39<00:04,  4.76s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 86.45: 100%|██████████| 20/20 [01:39<00:00,  4.65s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 86.45: 100%|██████████| 20/20 [01:39<00:00,  4.97s/it]
2024-09-07 09:07:26,715 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.131, Train_accy 86.45
2024-09-07 09:07:29,587 [trainer.py] => No NME accuracy.
2024-09-07 09:07:29,587 [trainer.py] => CNN: {'total': 28.18, '00-19': 6.29, '20-39': 19.46, '40-59': 29.31, '60-79': 33.78, '80-99': 56.64, 'old': 22.35, 'new': 56.64}
2024-09-07 09:07:29,588 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03, 35.24, 28.18]
2024-09-07 09:07:29,588 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16, 66.91, 58.5]

Average Accuracy (CNN): 42.25
2024-09-07 09:07:29,588 [trainer.py] => Average Accuracy (CNN): 42.25 

2024-09-07 09:07:29,589 [trainer.py] => All params: 85875556
2024-09-07 09:07:29,590 [trainer.py] => Trainable params: 85875556
2024-09-07 09:07:29,596 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.802, Train_accy 4.78, Test_accy 19.49:   0%|          | 0/20 [00:07<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.802, Train_accy 4.78, Test_accy 19.49:   5%|▌         | 1/20 [00:07<02:27,  7.77s/it]
Task 5, Epoch 2/20 => Loss 1.275, Train_accy 23.90:   5%|▌         | 1/20 [00:12<02:27,  7.77s/it]                
Task 5, Epoch 2/20 => Loss 1.275, Train_accy 23.90:  10%|█         | 2/20 [00:12<01:44,  5.80s/it]
Task 5, Epoch 3/20 => Loss 0.778, Train_accy 42.83:  10%|█         | 2/20 [00:16<01:44,  5.80s/it]
Task 5, Epoch 3/20 => Loss 0.778, Train_accy 42.83:  15%|█▌        | 3/20 [00:16<01:27,  5.16s/it]
Task 5, Epoch 4/20 => Loss 0.495, Train_accy 55.07:  15%|█▌        | 3/20 [00:20<01:27,  5.16s/it]
Task 5, Epoch 4/20 => Loss 0.495, Train_accy 55.07:  20%|██        | 4/20 [00:20<01:17,  4.86s/it]
Task 5, Epoch 5/20 => Loss 0.382, Train_accy 60.04:  20%|██        | 4/20 [00:25<01:17,  4.86s/it]
Task 5, Epoch 5/20 => Loss 0.382, Train_accy 60.04:  25%|██▌       | 5/20 [00:25<01:10,  4.69s/it]
Task 5, Epoch 6/20 => Loss 0.301, Train_accy 66.92, Test_accy 22.87:  25%|██▌       | 5/20 [00:33<01:10,  4.69s/it]
Task 5, Epoch 6/20 => Loss 0.301, Train_accy 66.92, Test_accy 22.87:  30%|███       | 6/20 [00:33<01:19,  5.70s/it]
Task 5, Epoch 7/20 => Loss 0.183, Train_accy 71.13:  30%|███       | 6/20 [00:37<01:19,  5.70s/it]                 
Task 5, Epoch 7/20 => Loss 0.183, Train_accy 71.13:  35%|███▌      | 7/20 [00:37<01:08,  5.29s/it]
Task 5, Epoch 8/20 => Loss 0.237, Train_accy 70.55:  35%|███▌      | 7/20 [00:41<01:08,  5.29s/it]
Task 5, Epoch 8/20 => Loss 0.237, Train_accy 70.55:  40%|████      | 8/20 [00:41<00:59,  4.99s/it]
Task 5, Epoch 9/20 => Loss 0.182, Train_accy 74.00:  40%|████      | 8/20 [00:46<00:59,  4.99s/it]
Task 5, Epoch 9/20 => Loss 0.182, Train_accy 74.00:  45%|████▌     | 9/20 [00:46<00:52,  4.81s/it]
Task 5, Epoch 10/20 => Loss 0.145, Train_accy 77.44:  45%|████▌     | 9/20 [00:50<00:52,  4.81s/it]
Task 5, Epoch 10/20 => Loss 0.145, Train_accy 77.44:  50%|█████     | 10/20 [00:50<00:46,  4.68s/it]
Task 5, Epoch 11/20 => Loss 0.189, Train_accy 77.25, Test_accy 23.90:  50%|█████     | 10/20 [00:58<00:46,  4.68s/it]
Task 5, Epoch 11/20 => Loss 0.189, Train_accy 77.25, Test_accy 23.90:  55%|█████▌    | 11/20 [00:58<00:50,  5.61s/it]
Task 5, Epoch 12/20 => Loss 0.153, Train_accy 78.20:  55%|█████▌    | 11/20 [01:02<00:50,  5.61s/it]                 
Task 5, Epoch 12/20 => Loss 0.153, Train_accy 78.20:  60%|██████    | 12/20 [01:02<00:42,  5.27s/it]
Task 5, Epoch 13/20 => Loss 0.123, Train_accy 77.82:  60%|██████    | 12/20 [01:07<00:42,  5.27s/it]
Task 5, Epoch 13/20 => Loss 0.123, Train_accy 77.82:  65%|██████▌   | 13/20 [01:07<00:34,  5.00s/it]
Task 5, Epoch 14/20 => Loss 0.131, Train_accy 80.50:  65%|██████▌   | 13/20 [01:11<00:34,  5.00s/it]
Task 5, Epoch 14/20 => Loss 0.131, Train_accy 80.50:  70%|███████   | 14/20 [01:11<00:28,  4.81s/it]
Task 5, Epoch 15/20 => Loss 0.127, Train_accy 81.64:  70%|███████   | 14/20 [01:15<00:28,  4.81s/it]
Task 5, Epoch 15/20 => Loss 0.127, Train_accy 81.64:  75%|███████▌  | 15/20 [01:15<00:23,  4.68s/it]
Task 5, Epoch 16/20 => Loss 0.156, Train_accy 81.07, Test_accy 23.90:  75%|███████▌  | 15/20 [01:23<00:23,  4.68s/it]
Task 5, Epoch 16/20 => Loss 0.156, Train_accy 81.07, Test_accy 23.90:  80%|████████  | 16/20 [01:23<00:22,  5.58s/it]
Task 5, Epoch 17/20 => Loss 0.113, Train_accy 78.59:  80%|████████  | 16/20 [01:28<00:22,  5.58s/it]                 
Task 5, Epoch 17/20 => Loss 0.113, Train_accy 78.59:  85%|████████▌ | 17/20 [01:28<00:15,  5.22s/it]
Task 5, Epoch 18/20 => Loss 0.119, Train_accy 82.22:  85%|████████▌ | 17/20 [01:32<00:15,  5.22s/it]
Task 5, Epoch 18/20 => Loss 0.119, Train_accy 82.22:  90%|█████████ | 18/20 [01:32<00:09,  4.96s/it]
Task 5, Epoch 19/20 => Loss 0.115, Train_accy 81.64:  90%|█████████ | 18/20 [01:36<00:09,  4.96s/it]
Task 5, Epoch 19/20 => Loss 0.115, Train_accy 81.64:  95%|█████████▌| 19/20 [01:36<00:04,  4.78s/it]
Task 5, Epoch 20/20 => Loss 0.114, Train_accy 82.60:  95%|█████████▌| 19/20 [01:41<00:04,  4.78s/it]
Task 5, Epoch 20/20 => Loss 0.114, Train_accy 82.60: 100%|██████████| 20/20 [01:41<00:00,  4.66s/it]
Task 5, Epoch 20/20 => Loss 0.114, Train_accy 82.60: 100%|██████████| 20/20 [01:41<00:00,  5.06s/it]
2024-09-07 09:09:10,714 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.114, Train_accy 82.60
2024-09-07 09:09:13,943 [trainer.py] => No NME accuracy.
2024-09-07 09:09:13,943 [trainer.py] => CNN: {'total': 24.82, '00-19': 6.29, '20-39': 15.68, '40-59': 23.28, '60-79': 26.13, '80-99': 34.97, '100-119': 50.0, 'old': 20.81, 'new': 50.0}
2024-09-07 09:09:13,943 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03, 35.24, 28.18, 24.82]
2024-09-07 09:09:13,943 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16, 66.91, 58.5, 53.23]

Average Accuracy (CNN): 39.34
2024-09-07 09:09:13,944 [trainer.py] => Average Accuracy (CNN): 39.34 

2024-09-07 09:09:13,945 [trainer.py] => All params: 85890936
2024-09-07 09:09:13,946 [trainer.py] => Trainable params: 85890936
2024-09-07 09:09:13,949 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.400, Train_accy 1.67, Test_accy 15.97:   0%|          | 0/20 [00:08<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.400, Train_accy 1.67, Test_accy 15.97:   5%|▌         | 1/20 [00:08<02:34,  8.13s/it]
Task 6, Epoch 2/20 => Loss 1.470, Train_accy 18.55:   5%|▌         | 1/20 [00:12<02:34,  8.13s/it]                
Task 6, Epoch 2/20 => Loss 1.470, Train_accy 18.55:  10%|█         | 2/20 [00:12<01:47,  6.00s/it]
Task 6, Epoch 3/20 => Loss 0.953, Train_accy 43.23:  10%|█         | 2/20 [00:17<01:47,  6.00s/it]
Task 6, Epoch 3/20 => Loss 0.953, Train_accy 43.23:  15%|█▌        | 3/20 [00:17<01:30,  5.32s/it]
Task 6, Epoch 4/20 => Loss 0.763, Train_accy 52.88:  15%|█▌        | 3/20 [00:21<01:30,  5.32s/it]
Task 6, Epoch 4/20 => Loss 0.763, Train_accy 52.88:  20%|██        | 4/20 [00:21<01:19,  4.99s/it]
Task 6, Epoch 5/20 => Loss 0.477, Train_accy 64.56:  20%|██        | 4/20 [00:26<01:19,  4.99s/it]
Task 6, Epoch 5/20 => Loss 0.477, Train_accy 64.56:  25%|██▌       | 5/20 [00:26<01:12,  4.82s/it]
Task 6, Epoch 6/20 => Loss 0.433, Train_accy 70.69, Test_accy 23.73:  25%|██▌       | 5/20 [00:34<01:12,  4.82s/it]
Task 6, Epoch 6/20 => Loss 0.433, Train_accy 70.69, Test_accy 23.73:  30%|███       | 6/20 [00:34<01:23,  5.97s/it]
Task 6, Epoch 7/20 => Loss 0.288, Train_accy 77.74:  30%|███       | 6/20 [00:38<01:23,  5.97s/it]                 
Task 6, Epoch 7/20 => Loss 0.288, Train_accy 77.74:  35%|███▌      | 7/20 [00:38<01:11,  5.49s/it]
Task 6, Epoch 8/20 => Loss 0.306, Train_accy 80.15:  35%|███▌      | 7/20 [00:43<01:11,  5.49s/it]
Task 6, Epoch 8/20 => Loss 0.306, Train_accy 80.15:  40%|████      | 8/20 [00:43<01:02,  5.18s/it]
Task 6, Epoch 9/20 => Loss 0.297, Train_accy 79.04:  40%|████      | 8/20 [00:47<01:02,  5.18s/it]
Task 6, Epoch 9/20 => Loss 0.297, Train_accy 79.04:  45%|████▌     | 9/20 [00:47<00:54,  4.98s/it]
Task 6, Epoch 10/20 => Loss 0.234, Train_accy 82.00:  45%|████▌     | 9/20 [00:52<00:54,  4.98s/it]
Task 6, Epoch 10/20 => Loss 0.234, Train_accy 82.00:  50%|█████     | 10/20 [00:52<00:48,  4.84s/it]
Task 6, Epoch 11/20 => Loss 0.189, Train_accy 82.56, Test_accy 24.71:  50%|█████     | 10/20 [01:00<00:48,  4.84s/it]
Task 6, Epoch 11/20 => Loss 0.189, Train_accy 82.56, Test_accy 24.71:  55%|█████▌    | 11/20 [01:00<00:52,  5.88s/it]
Task 6, Epoch 12/20 => Loss 0.214, Train_accy 84.60:  55%|█████▌    | 11/20 [01:05<00:52,  5.88s/it]                 
Task 6, Epoch 12/20 => Loss 0.214, Train_accy 84.60:  60%|██████    | 12/20 [01:05<00:43,  5.48s/it]
Task 6, Epoch 13/20 => Loss 0.211, Train_accy 83.12:  60%|██████    | 12/20 [01:09<00:43,  5.48s/it]
Task 6, Epoch 13/20 => Loss 0.211, Train_accy 83.12:  65%|██████▌   | 13/20 [01:09<00:36,  5.19s/it]
Task 6, Epoch 14/20 => Loss 0.185, Train_accy 80.89:  65%|██████▌   | 13/20 [01:14<00:36,  5.19s/it]
Task 6, Epoch 14/20 => Loss 0.185, Train_accy 80.89:  70%|███████   | 14/20 [01:14<00:30,  5.00s/it]
Task 6, Epoch 15/20 => Loss 0.134, Train_accy 87.76:  70%|███████   | 14/20 [01:18<00:30,  5.00s/it]
Task 6, Epoch 15/20 => Loss 0.134, Train_accy 87.76:  75%|███████▌  | 15/20 [01:18<00:24,  4.86s/it]
Task 6, Epoch 16/20 => Loss 0.139, Train_accy 88.68, Test_accy 24.26:  75%|███████▌  | 15/20 [01:26<00:24,  4.86s/it]
Task 6, Epoch 16/20 => Loss 0.139, Train_accy 88.68, Test_accy 24.26:  80%|████████  | 16/20 [01:26<00:23,  5.85s/it]
Task 6, Epoch 17/20 => Loss 0.175, Train_accy 84.79:  80%|████████  | 16/20 [01:31<00:23,  5.85s/it]                 
Task 6, Epoch 17/20 => Loss 0.175, Train_accy 84.79:  85%|████████▌ | 17/20 [01:31<00:16,  5.45s/it]
Task 6, Epoch 18/20 => Loss 0.229, Train_accy 83.86:  85%|████████▌ | 17/20 [01:36<00:16,  5.45s/it]
Task 6, Epoch 18/20 => Loss 0.229, Train_accy 83.86:  90%|█████████ | 18/20 [01:36<00:10,  5.16s/it]
Task 6, Epoch 19/20 => Loss 0.154, Train_accy 86.46:  90%|█████████ | 18/20 [01:40<00:10,  5.16s/it]
Task 6, Epoch 19/20 => Loss 0.154, Train_accy 86.46:  95%|█████████▌| 19/20 [01:40<00:04,  4.97s/it]
Task 6, Epoch 20/20 => Loss 0.198, Train_accy 81.82:  95%|█████████▌| 19/20 [01:45<00:04,  4.97s/it]
Task 6, Epoch 20/20 => Loss 0.198, Train_accy 81.82: 100%|██████████| 20/20 [01:45<00:00,  4.83s/it]
Task 6, Epoch 20/20 => Loss 0.198, Train_accy 81.82: 100%|██████████| 20/20 [01:45<00:00,  5.25s/it]
2024-09-07 09:10:59,010 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.198, Train_accy 81.82
2024-09-07 09:11:02,738 [trainer.py] => No NME accuracy.
2024-09-07 09:11:02,738 [trainer.py] => CNN: {'total': 24.44, '00-19': 8.57, '20-39': 12.97, '40-59': 19.83, '60-79': 22.97, '80-99': 30.77, '100-119': 41.04, '120-139': 42.47, 'old': 21.74, 'new': 42.47}
2024-09-07 09:11:02,739 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03, 35.24, 28.18, 24.82, 24.44]
2024-09-07 09:11:02,739 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16, 66.91, 58.5, 53.23, 50.76]

Average Accuracy (CNN): 37.22
2024-09-07 09:11:02,739 [trainer.py] => Average Accuracy (CNN): 37.22 

2024-09-07 09:11:02,740 [trainer.py] => All params: 85906316
2024-09-07 09:11:02,742 [trainer.py] => Trainable params: 85906316
2024-09-07 09:11:02,746 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.983, Train_accy 0.75, Test_accy 20.67:   0%|          | 0/20 [00:08<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.983, Train_accy 0.75, Test_accy 20.67:   5%|▌         | 1/20 [00:08<02:42,  8.54s/it]
Task 7, Epoch 2/20 => Loss 1.518, Train_accy 19.02:   5%|▌         | 1/20 [00:12<02:42,  8.54s/it]                
Task 7, Epoch 2/20 => Loss 1.518, Train_accy 19.02:  10%|█         | 2/20 [00:12<01:50,  6.13s/it]
Task 7, Epoch 3/20 => Loss 1.086, Train_accy 40.49:  10%|█         | 2/20 [00:17<01:50,  6.13s/it]
Task 7, Epoch 3/20 => Loss 1.086, Train_accy 40.49:  15%|█▌        | 3/20 [00:17<01:31,  5.36s/it]
Task 7, Epoch 4/20 => Loss 0.977, Train_accy 49.72:  15%|█▌        | 3/20 [00:21<01:31,  5.36s/it]
Task 7, Epoch 4/20 => Loss 0.977, Train_accy 49.72:  20%|██        | 4/20 [00:21<01:19,  5.00s/it]
Task 7, Epoch 5/20 => Loss 0.788, Train_accy 48.21:  20%|██        | 4/20 [00:26<01:19,  5.00s/it]
Task 7, Epoch 5/20 => Loss 0.788, Train_accy 48.21:  25%|██▌       | 5/20 [00:26<01:12,  4.81s/it]
Task 7, Epoch 6/20 => Loss 0.500, Train_accy 63.09, Test_accy 24.04:  25%|██▌       | 5/20 [00:34<01:12,  4.81s/it]
Task 7, Epoch 6/20 => Loss 0.500, Train_accy 63.09, Test_accy 24.04:  30%|███       | 6/20 [00:34<01:24,  6.06s/it]
Task 7, Epoch 7/20 => Loss 0.383, Train_accy 65.35:  30%|███       | 6/20 [00:39<01:24,  6.06s/it]                 
Task 7, Epoch 7/20 => Loss 0.383, Train_accy 65.35:  35%|███▌      | 7/20 [00:39<01:11,  5.53s/it]
Task 7, Epoch 8/20 => Loss 0.307, Train_accy 74.58:  35%|███▌      | 7/20 [00:43<01:11,  5.53s/it]
Task 7, Epoch 8/20 => Loss 0.307, Train_accy 74.58:  40%|████      | 8/20 [00:43<01:02,  5.20s/it]
Task 7, Epoch 9/20 => Loss 0.216, Train_accy 77.21:  40%|████      | 8/20 [00:48<01:02,  5.20s/it]
Task 7, Epoch 9/20 => Loss 0.216, Train_accy 77.21:  45%|████▌     | 9/20 [00:48<00:54,  4.97s/it]
Task 7, Epoch 10/20 => Loss 0.199, Train_accy 79.10:  45%|████▌     | 9/20 [00:52<00:54,  4.97s/it]
Task 7, Epoch 10/20 => Loss 0.199, Train_accy 79.10:  50%|█████     | 10/20 [00:52<00:48,  4.81s/it]
Task 7, Epoch 11/20 => Loss 0.265, Train_accy 77.78, Test_accy 21.71:  50%|█████     | 10/20 [01:01<00:48,  4.81s/it]
Task 7, Epoch 11/20 => Loss 0.265, Train_accy 77.78, Test_accy 21.71:  55%|█████▌    | 11/20 [01:01<00:53,  5.95s/it]
Task 7, Epoch 12/20 => Loss 0.290, Train_accy 78.53:  55%|█████▌    | 11/20 [01:05<00:53,  5.95s/it]                 
Task 7, Epoch 12/20 => Loss 0.290, Train_accy 78.53:  60%|██████    | 12/20 [01:05<00:43,  5.48s/it]
Task 7, Epoch 13/20 => Loss 0.204, Train_accy 80.04:  60%|██████    | 12/20 [01:10<00:43,  5.48s/it]
Task 7, Epoch 13/20 => Loss 0.204, Train_accy 80.04:  65%|██████▌   | 13/20 [01:10<00:36,  5.17s/it]
Task 7, Epoch 14/20 => Loss 0.166, Train_accy 78.91:  65%|██████▌   | 13/20 [01:14<00:36,  5.17s/it]
Task 7, Epoch 14/20 => Loss 0.166, Train_accy 78.91:  70%|███████   | 14/20 [01:14<00:29,  4.95s/it]
Task 7, Epoch 15/20 => Loss 0.182, Train_accy 82.86:  70%|███████   | 14/20 [01:18<00:29,  4.95s/it]
Task 7, Epoch 15/20 => Loss 0.182, Train_accy 82.86:  75%|███████▌  | 15/20 [01:18<00:24,  4.80s/it]
Task 7, Epoch 16/20 => Loss 0.147, Train_accy 84.37, Test_accy 21.55:  75%|███████▌  | 15/20 [01:27<00:24,  4.80s/it]
Task 7, Epoch 16/20 => Loss 0.147, Train_accy 84.37, Test_accy 21.55:  80%|████████  | 16/20 [01:27<00:23,  5.94s/it]
Task 7, Epoch 17/20 => Loss 0.169, Train_accy 87.01:  80%|████████  | 16/20 [01:32<00:23,  5.94s/it]                 
Task 7, Epoch 17/20 => Loss 0.169, Train_accy 87.01:  85%|████████▌ | 17/20 [01:32<00:16,  5.50s/it]
Task 7, Epoch 18/20 => Loss 0.170, Train_accy 83.24:  85%|████████▌ | 17/20 [01:36<00:16,  5.50s/it]
Task 7, Epoch 18/20 => Loss 0.170, Train_accy 83.24:  90%|█████████ | 18/20 [01:36<00:10,  5.18s/it]
Task 7, Epoch 19/20 => Loss 0.210, Train_accy 82.49:  90%|█████████ | 18/20 [01:40<00:10,  5.18s/it]
Task 7, Epoch 19/20 => Loss 0.210, Train_accy 82.49:  95%|█████████▌| 19/20 [01:40<00:04,  4.95s/it]
Task 7, Epoch 20/20 => Loss 0.197, Train_accy 80.04:  95%|█████████▌| 19/20 [01:45<00:04,  4.95s/it]
Task 7, Epoch 20/20 => Loss 0.197, Train_accy 80.04: 100%|██████████| 20/20 [01:45<00:00,  4.81s/it]
Task 7, Epoch 20/20 => Loss 0.197, Train_accy 80.04: 100%|██████████| 20/20 [01:45<00:00,  5.27s/it]
2024-09-07 09:12:48,136 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.197, Train_accy 80.04
2024-09-07 09:12:52,206 [trainer.py] => No NME accuracy.
2024-09-07 09:12:52,206 [trainer.py] => CNN: {'total': 22.2, '00-19': 5.71, '20-39': 14.59, '40-59': 21.55, '60-79': 19.82, '80-99': 25.87, '100-119': 35.82, '120-139': 25.34, '140-159': 38.58, 'old': 20.34, 'new': 38.58}
2024-09-07 09:12:52,206 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03, 35.24, 28.18, 24.82, 24.44, 22.2]
2024-09-07 09:12:52,207 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16, 66.91, 58.5, 53.23, 50.76, 47.68]

Average Accuracy (CNN): 35.34
2024-09-07 09:12:52,207 [trainer.py] => Average Accuracy (CNN): 35.34 

2024-09-07 09:12:52,208 [trainer.py] => All params: 85921696
2024-09-07 09:12:52,210 [trainer.py] => Trainable params: 85921696
2024-09-07 09:12:52,213 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.284, Train_accy 1.75, Test_accy 14.84:   0%|          | 0/20 [00:09<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.284, Train_accy 1.75, Test_accy 14.84:   5%|▌         | 1/20 [00:09<02:55,  9.25s/it]
Task 8, Epoch 2/20 => Loss 1.789, Train_accy 10.68:   5%|▌         | 1/20 [00:14<02:55,  9.25s/it]                
Task 8, Epoch 2/20 => Loss 1.789, Train_accy 10.68:  10%|█         | 2/20 [00:14<01:59,  6.63s/it]
Task 8, Epoch 3/20 => Loss 1.192, Train_accy 29.25:  10%|█         | 2/20 [00:18<01:59,  6.63s/it]
Task 8, Epoch 3/20 => Loss 1.192, Train_accy 29.25:  15%|█▌        | 3/20 [00:18<01:38,  5.81s/it]
Task 8, Epoch 4/20 => Loss 0.814, Train_accy 43.08:  15%|█▌        | 3/20 [00:23<01:38,  5.81s/it]
Task 8, Epoch 4/20 => Loss 0.814, Train_accy 43.08:  20%|██        | 4/20 [00:23<01:26,  5.38s/it]
Task 8, Epoch 5/20 => Loss 0.589, Train_accy 53.42:  20%|██        | 4/20 [00:28<01:26,  5.38s/it]
Task 8, Epoch 5/20 => Loss 0.589, Train_accy 53.42:  25%|██▌       | 5/20 [00:28<01:17,  5.15s/it]
Task 8, Epoch 6/20 => Loss 0.411, Train_accy 63.92, Test_accy 21.79:  25%|██▌       | 5/20 [00:37<01:17,  5.15s/it]
Task 8, Epoch 6/20 => Loss 0.411, Train_accy 63.92, Test_accy 21.79:  30%|███       | 6/20 [00:37<01:31,  6.52s/it]
Task 8, Epoch 7/20 => Loss 0.344, Train_accy 64.10:  30%|███       | 6/20 [00:42<01:31,  6.52s/it]                 
Task 8, Epoch 7/20 => Loss 0.344, Train_accy 64.10:  35%|███▌      | 7/20 [00:42<01:17,  5.94s/it]
Task 8, Epoch 8/20 => Loss 0.323, Train_accy 69.88:  35%|███▌      | 7/20 [00:47<01:17,  5.94s/it]
Task 8, Epoch 8/20 => Loss 0.323, Train_accy 69.88:  40%|████      | 8/20 [00:47<01:06,  5.56s/it]
Task 8, Epoch 9/20 => Loss 0.368, Train_accy 70.93:  40%|████      | 8/20 [00:51<01:06,  5.56s/it]
Task 8, Epoch 9/20 => Loss 0.368, Train_accy 70.93:  45%|████▌     | 9/20 [00:51<00:58,  5.30s/it]
Task 8, Epoch 10/20 => Loss 0.269, Train_accy 73.73:  45%|████▌     | 9/20 [00:56<00:58,  5.30s/it]
Task 8, Epoch 10/20 => Loss 0.269, Train_accy 73.73:  50%|█████     | 10/20 [00:56<00:51,  5.12s/it]
Task 8, Epoch 11/20 => Loss 0.245, Train_accy 74.43, Test_accy 20.86:  50%|█████     | 10/20 [01:05<00:51,  5.12s/it]
Task 8, Epoch 11/20 => Loss 0.245, Train_accy 74.43, Test_accy 20.86:  55%|█████▌    | 11/20 [01:05<00:57,  6.38s/it]
Task 8, Epoch 12/20 => Loss 0.199, Train_accy 77.23:  55%|█████▌    | 11/20 [01:10<00:57,  6.38s/it]                 
Task 8, Epoch 12/20 => Loss 0.199, Train_accy 77.23:  60%|██████    | 12/20 [01:10<00:47,  5.89s/it]
Task 8, Epoch 13/20 => Loss 0.163, Train_accy 80.91:  60%|██████    | 12/20 [01:15<00:47,  5.89s/it]
Task 8, Epoch 13/20 => Loss 0.163, Train_accy 80.91:  65%|██████▌   | 13/20 [01:15<00:38,  5.56s/it]
Task 8, Epoch 14/20 => Loss 0.174, Train_accy 82.31:  65%|██████▌   | 13/20 [01:20<00:38,  5.56s/it]
Task 8, Epoch 14/20 => Loss 0.174, Train_accy 82.31:  70%|███████   | 14/20 [01:20<00:31,  5.32s/it]
Task 8, Epoch 15/20 => Loss 0.219, Train_accy 79.51:  70%|███████   | 14/20 [01:24<00:31,  5.32s/it]
Task 8, Epoch 15/20 => Loss 0.219, Train_accy 79.51:  75%|███████▌  | 15/20 [01:24<00:25,  5.15s/it]
Task 8, Epoch 16/20 => Loss 0.137, Train_accy 79.51, Test_accy 21.29:  75%|███████▌  | 15/20 [01:34<00:25,  5.15s/it]
Task 8, Epoch 16/20 => Loss 0.137, Train_accy 79.51, Test_accy 21.29:  80%|████████  | 16/20 [01:34<00:25,  6.40s/it]
Task 8, Epoch 17/20 => Loss 0.163, Train_accy 83.54:  80%|████████  | 16/20 [01:38<00:25,  6.40s/it]                 
Task 8, Epoch 17/20 => Loss 0.163, Train_accy 83.54:  85%|████████▌ | 17/20 [01:38<00:17,  5.90s/it]
Task 8, Epoch 18/20 => Loss 0.135, Train_accy 82.84:  85%|████████▌ | 17/20 [01:43<00:17,  5.90s/it]
Task 8, Epoch 18/20 => Loss 0.135, Train_accy 82.84:  90%|█████████ | 18/20 [01:43<00:11,  5.55s/it]
Task 8, Epoch 19/20 => Loss 0.132, Train_accy 83.71:  90%|█████████ | 18/20 [01:48<00:11,  5.55s/it]
Task 8, Epoch 19/20 => Loss 0.132, Train_accy 83.71:  95%|█████████▌| 19/20 [01:48<00:05,  5.31s/it]
Task 8, Epoch 20/20 => Loss 0.157, Train_accy 81.96:  95%|█████████▌| 19/20 [01:53<00:05,  5.31s/it]
Task 8, Epoch 20/20 => Loss 0.157, Train_accy 81.96: 100%|██████████| 20/20 [01:53<00:00,  5.14s/it]
Task 8, Epoch 20/20 => Loss 0.157, Train_accy 81.96: 100%|██████████| 20/20 [01:53<00:00,  5.65s/it]
2024-09-07 09:14:45,303 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.157, Train_accy 81.96
2024-09-07 09:14:49,777 [trainer.py] => No NME accuracy.
2024-09-07 09:14:49,778 [trainer.py] => CNN: {'total': 19.0, '00-19': 4.57, '20-39': 8.65, '40-59': 16.38, '60-79': 13.96, '80-99': 20.98, '100-119': 29.1, '120-139': 17.81, '140-159': 33.86, '160-179': 36.05, 'old': 16.99, 'new': 36.05}
2024-09-07 09:14:49,778 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03, 35.24, 28.18, 24.82, 24.44, 22.2, 19.0]
2024-09-07 09:14:49,778 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16, 66.91, 58.5, 53.23, 50.76, 47.68, 43.51]

Average Accuracy (CNN): 33.52
2024-09-07 09:14:49,778 [trainer.py] => Average Accuracy (CNN): 33.52 

2024-09-07 09:14:49,779 [trainer.py] => All params: 85937076
2024-09-07 09:14:49,780 [trainer.py] => Trainable params: 85937076
2024-09-07 09:14:49,783 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.102, Train_accy 1.52, Test_accy 14.75:   0%|          | 0/20 [00:09<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.102, Train_accy 1.52, Test_accy 14.75:   5%|▌         | 1/20 [00:09<02:54,  9.20s/it]
Task 9, Epoch 2/20 => Loss 1.239, Train_accy 22.77:   5%|▌         | 1/20 [00:13<02:54,  9.20s/it]                
Task 9, Epoch 2/20 => Loss 1.239, Train_accy 22.77:  10%|█         | 2/20 [00:13<01:55,  6.40s/it]
Task 9, Epoch 3/20 => Loss 0.814, Train_accy 46.68:  10%|█         | 2/20 [00:18<01:55,  6.40s/it]
Task 9, Epoch 3/20 => Loss 0.814, Train_accy 46.68:  15%|█▌        | 3/20 [00:18<01:33,  5.51s/it]
Task 9, Epoch 4/20 => Loss 0.581, Train_accy 56.36:  15%|█▌        | 3/20 [00:22<01:33,  5.51s/it]
Task 9, Epoch 4/20 => Loss 0.581, Train_accy 56.36:  20%|██        | 4/20 [00:22<01:21,  5.08s/it]
Task 9, Epoch 5/20 => Loss 0.367, Train_accy 68.31:  20%|██        | 4/20 [00:26<01:21,  5.08s/it]
Task 9, Epoch 5/20 => Loss 0.367, Train_accy 68.31:  25%|██▌       | 5/20 [00:26<01:12,  4.83s/it]
Task 9, Epoch 6/20 => Loss 0.320, Train_accy 76.85, Test_accy 18.76:  25%|██▌       | 5/20 [00:36<01:12,  4.83s/it]
Task 9, Epoch 6/20 => Loss 0.320, Train_accy 76.85, Test_accy 18.76:  30%|███       | 6/20 [00:36<01:28,  6.34s/it]
Task 9, Epoch 7/20 => Loss 0.296, Train_accy 77.80:  30%|███       | 6/20 [00:40<01:28,  6.34s/it]                 
Task 9, Epoch 7/20 => Loss 0.296, Train_accy 77.80:  35%|███▌      | 7/20 [00:40<01:14,  5.73s/it]
Task 9, Epoch 8/20 => Loss 0.224, Train_accy 78.56:  35%|███▌      | 7/20 [00:45<01:14,  5.73s/it]
Task 9, Epoch 8/20 => Loss 0.224, Train_accy 78.56:  40%|████      | 8/20 [00:45<01:03,  5.30s/it]
Task 9, Epoch 9/20 => Loss 0.240, Train_accy 80.65:  40%|████      | 8/20 [00:49<01:03,  5.30s/it]
Task 9, Epoch 9/20 => Loss 0.240, Train_accy 80.65:  45%|████▌     | 9/20 [00:49<00:55,  5.03s/it]
Task 9, Epoch 10/20 => Loss 0.194, Train_accy 84.44:  45%|████▌     | 9/20 [00:53<00:55,  5.03s/it]
Task 9, Epoch 10/20 => Loss 0.194, Train_accy 84.44:  50%|█████     | 10/20 [00:53<00:48,  4.84s/it]
Task 9, Epoch 11/20 => Loss 0.169, Train_accy 83.30, Test_accy 19.22:  50%|█████     | 10/20 [01:03<00:48,  4.84s/it]
Task 9, Epoch 11/20 => Loss 0.169, Train_accy 83.30, Test_accy 19.22:  55%|█████▌    | 11/20 [01:03<00:55,  6.19s/it]
Task 9, Epoch 12/20 => Loss 0.141, Train_accy 85.01:  55%|█████▌    | 11/20 [01:07<00:55,  6.19s/it]                 
Task 9, Epoch 12/20 => Loss 0.141, Train_accy 85.01:  60%|██████    | 12/20 [01:07<00:45,  5.65s/it]
Task 9, Epoch 13/20 => Loss 0.126, Train_accy 84.25:  60%|██████    | 12/20 [01:11<00:45,  5.65s/it]
Task 9, Epoch 13/20 => Loss 0.126, Train_accy 84.25:  65%|██████▌   | 13/20 [01:11<00:36,  5.28s/it]
Task 9, Epoch 14/20 => Loss 0.141, Train_accy 85.96:  65%|██████▌   | 13/20 [01:16<00:36,  5.28s/it]
Task 9, Epoch 14/20 => Loss 0.141, Train_accy 85.96:  70%|███████   | 14/20 [01:16<00:30,  5.01s/it]
Task 9, Epoch 15/20 => Loss 0.134, Train_accy 87.86:  70%|███████   | 14/20 [01:20<00:30,  5.01s/it]
Task 9, Epoch 15/20 => Loss 0.134, Train_accy 87.86:  75%|███████▌  | 15/20 [01:20<00:24,  4.82s/it]
Task 9, Epoch 16/20 => Loss 0.184, Train_accy 86.72, Test_accy 18.04:  75%|███████▌  | 15/20 [01:30<00:24,  4.82s/it]
Task 9, Epoch 16/20 => Loss 0.184, Train_accy 86.72, Test_accy 18.04:  80%|████████  | 16/20 [01:30<00:24,  6.16s/it]
Task 9, Epoch 17/20 => Loss 0.146, Train_accy 87.86:  80%|████████  | 16/20 [01:34<00:24,  6.16s/it]                 
Task 9, Epoch 17/20 => Loss 0.146, Train_accy 87.86:  85%|████████▌ | 17/20 [01:34<00:16,  5.63s/it]
Task 9, Epoch 18/20 => Loss 0.153, Train_accy 83.49:  85%|████████▌ | 17/20 [01:38<00:16,  5.63s/it]
Task 9, Epoch 18/20 => Loss 0.153, Train_accy 83.49:  90%|█████████ | 18/20 [01:38<00:10,  5.26s/it]
Task 9, Epoch 19/20 => Loss 0.100, Train_accy 85.77:  90%|█████████ | 18/20 [01:43<00:10,  5.26s/it]
Task 9, Epoch 19/20 => Loss 0.100, Train_accy 85.77:  95%|█████████▌| 19/20 [01:43<00:05,  5.01s/it]
Task 9, Epoch 20/20 => Loss 0.138, Train_accy 84.63:  95%|█████████▌| 19/20 [01:47<00:05,  5.01s/it]
Task 9, Epoch 20/20 => Loss 0.138, Train_accy 84.63: 100%|██████████| 20/20 [01:47<00:00,  4.82s/it]
Task 9, Epoch 20/20 => Loss 0.138, Train_accy 84.63: 100%|██████████| 20/20 [01:47<00:00,  5.38s/it]
2024-09-07 09:16:37,421 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.138, Train_accy 84.63
2024-09-07 09:16:42,296 [trainer.py] => No NME accuracy.
2024-09-07 09:16:42,296 [trainer.py] => CNN: {'total': 18.56, '00-19': 5.14, '20-39': 7.57, '40-59': 17.24, '60-79': 11.71, '80-99': 25.17, '100-119': 23.13, '120-139': 13.7, '140-159': 32.28, '160-179': 23.81, '180-199': 40.32, 'old': 16.63, 'new': 40.32}
2024-09-07 09:16:42,296 [trainer.py] => CNN top1 curve: [62.86, 46.94, 38.03, 35.24, 28.18, 24.82, 24.44, 22.2, 19.0, 18.56]
2024-09-07 09:16:42,297 [trainer.py] => CNN top5 curve: [89.71, 82.5, 74.16, 66.91, 58.5, 53.23, 50.76, 47.68, 43.51, 41.34]

Average Accuracy (CNN): 32.03
2024-09-07 09:16:42,297 [trainer.py] => Average Accuracy (CNN): 32.03 

Accuracy Matrix (CNN):
[[62.86 35.43 28.   17.14  6.29  6.29  8.57  5.71  4.57  5.14]
 [ 0.   57.84 37.84 25.95 19.46 15.68 12.97 14.59  8.65  7.57]
 [ 0.    0.   53.45 38.79 29.31 23.28 19.83 21.55 16.38 17.24]
 [ 0.    0.    0.   55.41 33.78 26.13 22.97 19.82 13.96 11.71]
 [ 0.    0.    0.    0.   56.64 34.97 30.77 25.87 20.98 25.17]
 [ 0.    0.    0.    0.    0.   50.   41.04 35.82 29.1  23.13]
 [ 0.    0.    0.    0.    0.    0.   42.47 25.34 17.81 13.7 ]
 [ 0.    0.    0.    0.    0.    0.    0.   38.58 33.86 32.28]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   36.05 23.81]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   40.32]]
2024-09-07 09:16:42,300 [trainer.py] => Forgetting (CNN): 32.61666666666667
2024-09-07 09:16:45,053 [trainer.py] => config: ./exps/finetune_ina_B0_Inc20.json
2024-09-07 09:16:45,073 [trainer.py] => prefix: reproduce
2024-09-07 09:16:45,073 [trainer.py] => dataset: imageneta
2024-09-07 09:16:45,073 [trainer.py] => memory_size: 0
2024-09-07 09:16:45,073 [trainer.py] => memory_per_class: 0
2024-09-07 09:16:45,074 [trainer.py] => fixed_memory: False
2024-09-07 09:16:45,074 [trainer.py] => shuffle: True
2024-09-07 09:16:45,074 [trainer.py] => init_cls: 10
2024-09-07 09:16:45,074 [trainer.py] => increment: 10
2024-09-07 09:16:45,074 [trainer.py] => model_name: finetune
2024-09-07 09:16:45,074 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 09:16:45,074 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 09:16:45,074 [trainer.py] => seed: 1993
2024-09-07 09:16:45,074 [trainer.py] => init_epoch: 20
2024-09-07 09:16:45,074 [trainer.py] => init_lr: 0.001
2024-09-07 09:16:45,074 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 09:16:45,074 [trainer.py] => init_lr_decay: 0.1
2024-09-07 09:16:45,074 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 09:16:45,074 [trainer.py] => epochs: 20
2024-09-07 09:16:45,074 [trainer.py] => lrate: 0.001
2024-09-07 09:16:45,074 [trainer.py] => milestones: [40, 70]
2024-09-07 09:16:45,074 [trainer.py] => lrate_decay: 0.1
2024-09-07 09:16:45,074 [trainer.py] => batch_size: 48
2024-09-07 09:16:45,074 [trainer.py] => weight_decay: 0.0002
2024-09-07 09:16:45,105 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 09:16:46,797 [trainer.py] => All params: 85798656
2024-09-07 09:16:46,798 [trainer.py] => Trainable params: 85798656
2024-09-07 09:16:46,798 [finetune.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.228, Train_accy 32.89, Test_accy 28.57:   0%|          | 0/20 [00:03<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.228, Train_accy 32.89, Test_accy 28.57:   5%|▌         | 1/20 [00:03<01:07,  3.57s/it]
Task 0, Epoch 2/20 => Loss 1.570, Train_accy 48.50:   5%|▌         | 1/20 [00:06<01:07,  3.57s/it]                 
Task 0, Epoch 2/20 => Loss 1.570, Train_accy 48.50:  10%|█         | 2/20 [00:06<00:54,  3.02s/it]
Task 0, Epoch 3/20 => Loss 6.946, Train_accy 14.29:  10%|█         | 2/20 [00:08<00:54,  3.02s/it]
Task 0, Epoch 3/20 => Loss 6.946, Train_accy 14.29:  15%|█▌        | 3/20 [00:08<00:48,  2.85s/it]
Task 0, Epoch 4/20 => Loss 3.715, Train_accy 17.28:  15%|█▌        | 3/20 [00:11<00:48,  2.85s/it]
Task 0, Epoch 4/20 => Loss 3.715, Train_accy 17.28:  20%|██        | 4/20 [00:11<00:44,  2.77s/it]
Task 0, Epoch 5/20 => Loss 3.141, Train_accy 16.28:  20%|██        | 4/20 [00:14<00:44,  2.77s/it]
Task 0, Epoch 5/20 => Loss 3.141, Train_accy 16.28:  25%|██▌       | 5/20 [00:14<00:40,  2.72s/it]
Task 0, Epoch 6/20 => Loss 2.873, Train_accy 22.26, Test_accy 20.78:  25%|██▌       | 5/20 [00:17<00:40,  2.72s/it]
Task 0, Epoch 6/20 => Loss 2.873, Train_accy 22.26, Test_accy 20.78:  30%|███       | 6/20 [00:17<00:40,  2.91s/it]
Task 0, Epoch 7/20 => Loss 2.532, Train_accy 17.94:  30%|███       | 6/20 [00:20<00:40,  2.91s/it]                 
Task 0, Epoch 7/20 => Loss 2.532, Train_accy 17.94:  35%|███▌      | 7/20 [00:20<00:36,  2.83s/it]
Task 0, Epoch 8/20 => Loss 2.445, Train_accy 25.91:  35%|███▌      | 7/20 [00:22<00:36,  2.83s/it]
Task 0, Epoch 8/20 => Loss 2.445, Train_accy 25.91:  40%|████      | 8/20 [00:22<00:33,  2.77s/it]
Task 0, Epoch 9/20 => Loss 2.373, Train_accy 21.26:  40%|████      | 8/20 [00:25<00:33,  2.77s/it]
Task 0, Epoch 9/20 => Loss 2.373, Train_accy 21.26:  45%|████▌     | 9/20 [00:25<00:30,  2.75s/it]
Task 0, Epoch 10/20 => Loss 2.186, Train_accy 25.58:  45%|████▌     | 9/20 [00:28<00:30,  2.75s/it]
Task 0, Epoch 10/20 => Loss 2.186, Train_accy 25.58:  50%|█████     | 10/20 [00:28<00:27,  2.73s/it]
Task 0, Epoch 11/20 => Loss 2.130, Train_accy 25.25, Test_accy 27.27:  50%|█████     | 10/20 [00:31<00:27,  2.73s/it]
Task 0, Epoch 11/20 => Loss 2.130, Train_accy 25.25, Test_accy 27.27:  55%|█████▌    | 11/20 [00:31<00:26,  2.92s/it]
Task 0, Epoch 12/20 => Loss 2.058, Train_accy 23.92:  55%|█████▌    | 11/20 [00:34<00:26,  2.92s/it]                 
Task 0, Epoch 12/20 => Loss 2.058, Train_accy 23.92:  60%|██████    | 12/20 [00:34<00:22,  2.83s/it]
Task 0, Epoch 13/20 => Loss 2.133, Train_accy 22.26:  60%|██████    | 12/20 [00:36<00:22,  2.83s/it]
Task 0, Epoch 13/20 => Loss 2.133, Train_accy 22.26:  65%|██████▌   | 13/20 [00:36<00:19,  2.77s/it]
Task 0, Epoch 14/20 => Loss 2.033, Train_accy 29.90:  65%|██████▌   | 13/20 [00:39<00:19,  2.77s/it]
Task 0, Epoch 14/20 => Loss 2.033, Train_accy 29.90:  70%|███████   | 14/20 [00:39<00:16,  2.74s/it]
Task 0, Epoch 15/20 => Loss 2.140, Train_accy 23.59:  70%|███████   | 14/20 [00:42<00:16,  2.74s/it]
Task 0, Epoch 15/20 => Loss 2.140, Train_accy 23.59:  75%|███████▌  | 15/20 [00:42<00:13,  2.72s/it]
Task 0, Epoch 16/20 => Loss 2.067, Train_accy 23.26, Test_accy 23.38:  75%|███████▌  | 15/20 [00:45<00:13,  2.72s/it]
Task 0, Epoch 16/20 => Loss 2.067, Train_accy 23.26, Test_accy 23.38:  80%|████████  | 16/20 [00:45<00:11,  2.89s/it]
Task 0, Epoch 17/20 => Loss 2.054, Train_accy 30.23:  80%|████████  | 16/20 [00:48<00:11,  2.89s/it]                 
Task 0, Epoch 17/20 => Loss 2.054, Train_accy 30.23:  85%|████████▌ | 17/20 [00:48<00:08,  2.82s/it]
Task 0, Epoch 18/20 => Loss 2.116, Train_accy 25.58:  85%|████████▌ | 17/20 [00:50<00:08,  2.82s/it]
Task 0, Epoch 18/20 => Loss 2.116, Train_accy 25.58:  90%|█████████ | 18/20 [00:50<00:05,  2.77s/it]
Task 0, Epoch 19/20 => Loss 2.135, Train_accy 21.93:  90%|█████████ | 18/20 [00:53<00:05,  2.77s/it]
Task 0, Epoch 19/20 => Loss 2.135, Train_accy 21.93:  95%|█████████▌| 19/20 [00:53<00:02,  2.75s/it]
Task 0, Epoch 20/20 => Loss 2.096, Train_accy 26.91:  95%|█████████▌| 19/20 [00:55<00:02,  2.75s/it]
Task 0, Epoch 20/20 => Loss 2.096, Train_accy 26.91: 100%|██████████| 20/20 [00:55<00:00,  2.72s/it]
Task 0, Epoch 20/20 => Loss 2.096, Train_accy 26.91: 100%|██████████| 20/20 [00:55<00:00,  2.80s/it]
2024-09-07 09:17:43,247 [finetune.py] => Task 0, Epoch 20/20 => Loss 2.096, Train_accy 26.91
2024-09-07 09:17:43,889 [trainer.py] => No NME accuracy.
2024-09-07 09:17:43,890 [trainer.py] => CNN: {'total': 18.18, '00-09': 18.18, 'old': 0, 'new': 18.18}
2024-09-07 09:17:43,890 [trainer.py] => CNN top1 curve: [18.18]
2024-09-07 09:17:43,890 [trainer.py] => CNN top5 curve: [70.13]

Average Accuracy (CNN): 18.18
2024-09-07 09:17:43,890 [trainer.py] => Average Accuracy (CNN): 18.18 

2024-09-07 09:17:43,892 [trainer.py] => All params: 85806346
2024-09-07 09:17:43,893 [trainer.py] => Trainable params: 85806346
2024-09-07 09:17:43,895 [finetune.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.296, Train_accy 8.17, Test_accy 10.86:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.296, Train_accy 8.17, Test_accy 10.86:   5%|▌         | 1/20 [00:04<01:22,  4.36s/it]
Task 1, Epoch 2/20 => Loss 2.270, Train_accy 14.60:   5%|▌         | 1/20 [00:07<01:22,  4.36s/it]                
Task 1, Epoch 2/20 => Loss 2.270, Train_accy 14.60:  10%|█         | 2/20 [00:07<01:08,  3.80s/it]
Task 1, Epoch 3/20 => Loss 2.118, Train_accy 0.25:  10%|█         | 2/20 [00:11<01:08,  3.80s/it] 
Task 1, Epoch 3/20 => Loss 2.118, Train_accy 0.25:  15%|█▌        | 3/20 [00:11<01:01,  3.63s/it]
Task 1, Epoch 4/20 => Loss 2.086, Train_accy 8.17:  15%|█▌        | 3/20 [00:14<01:01,  3.63s/it]
Task 1, Epoch 4/20 => Loss 2.086, Train_accy 8.17:  20%|██        | 4/20 [00:14<00:56,  3.55s/it]
Task 1, Epoch 5/20 => Loss 2.038, Train_accy 5.69:  20%|██        | 4/20 [00:18<00:56,  3.55s/it]
Task 1, Epoch 5/20 => Loss 2.038, Train_accy 5.69:  25%|██▌       | 5/20 [00:18<00:52,  3.52s/it]
Task 1, Epoch 6/20 => Loss 2.019, Train_accy 6.44, Test_accy 8.57:  25%|██▌       | 5/20 [00:22<00:52,  3.52s/it]
Task 1, Epoch 6/20 => Loss 2.019, Train_accy 6.44, Test_accy 8.57:  30%|███       | 6/20 [00:22<00:53,  3.80s/it]
Task 1, Epoch 7/20 => Loss 2.007, Train_accy 0.99:  30%|███       | 6/20 [00:25<00:53,  3.80s/it]                
Task 1, Epoch 7/20 => Loss 2.007, Train_accy 0.99:  35%|███▌      | 7/20 [00:25<00:47,  3.69s/it]
Task 1, Epoch 8/20 => Loss 2.074, Train_accy 15.84:  35%|███▌      | 7/20 [00:29<00:47,  3.69s/it]
Task 1, Epoch 8/20 => Loss 2.074, Train_accy 15.84:  40%|████      | 8/20 [00:29<00:43,  3.60s/it]
Task 1, Epoch 9/20 => Loss 2.119, Train_accy 8.66:  40%|████      | 8/20 [00:32<00:43,  3.60s/it] 
Task 1, Epoch 9/20 => Loss 2.119, Train_accy 8.66:  45%|████▌     | 9/20 [00:32<00:39,  3.58s/it]
Task 1, Epoch 10/20 => Loss 2.020, Train_accy 17.08:  45%|████▌     | 9/20 [00:36<00:39,  3.58s/it]
Task 1, Epoch 10/20 => Loss 2.020, Train_accy 17.08:  50%|█████     | 10/20 [00:36<00:35,  3.53s/it]
Task 1, Epoch 11/20 => Loss 2.045, Train_accy 16.83, Test_accy 11.43:  50%|█████     | 10/20 [00:40<00:35,  3.53s/it]
Task 1, Epoch 11/20 => Loss 2.045, Train_accy 16.83, Test_accy 11.43:  55%|█████▌    | 11/20 [00:40<00:33,  3.78s/it]
Task 1, Epoch 12/20 => Loss 2.046, Train_accy 11.14:  55%|█████▌    | 11/20 [00:44<00:33,  3.78s/it]                 
Task 1, Epoch 12/20 => Loss 2.046, Train_accy 11.14:  60%|██████    | 12/20 [00:44<00:29,  3.67s/it]
Task 1, Epoch 13/20 => Loss 2.020, Train_accy 20.30:  60%|██████    | 12/20 [00:47<00:29,  3.67s/it]
Task 1, Epoch 13/20 => Loss 2.020, Train_accy 20.30:  65%|██████▌   | 13/20 [00:47<00:25,  3.61s/it]
Task 1, Epoch 14/20 => Loss 1.980, Train_accy 10.64:  65%|██████▌   | 13/20 [00:50<00:25,  3.61s/it]
Task 1, Epoch 14/20 => Loss 1.980, Train_accy 10.64:  70%|███████   | 14/20 [00:50<00:21,  3.56s/it]
Task 1, Epoch 15/20 => Loss 1.996, Train_accy 21.53:  70%|███████   | 14/20 [00:54<00:21,  3.56s/it]
Task 1, Epoch 15/20 => Loss 1.996, Train_accy 21.53:  75%|███████▌  | 15/20 [00:54<00:17,  3.52s/it]
Task 1, Epoch 16/20 => Loss 1.988, Train_accy 18.56, Test_accy 14.86:  75%|███████▌  | 15/20 [00:58<00:17,  3.52s/it]
Task 1, Epoch 16/20 => Loss 1.988, Train_accy 18.56, Test_accy 14.86:  80%|████████  | 16/20 [00:58<00:15,  3.78s/it]
Task 1, Epoch 17/20 => Loss 2.003, Train_accy 18.81:  80%|████████  | 16/20 [01:02<00:15,  3.78s/it]                 
Task 1, Epoch 17/20 => Loss 2.003, Train_accy 18.81:  85%|████████▌ | 17/20 [01:02<00:11,  3.67s/it]
Task 1, Epoch 18/20 => Loss 1.982, Train_accy 21.29:  85%|████████▌ | 17/20 [01:05<00:11,  3.67s/it]
Task 1, Epoch 18/20 => Loss 1.982, Train_accy 21.29:  90%|█████████ | 18/20 [01:05<00:07,  3.61s/it]
Task 1, Epoch 19/20 => Loss 1.966, Train_accy 20.05:  90%|█████████ | 18/20 [01:09<00:07,  3.61s/it]
Task 1, Epoch 19/20 => Loss 1.966, Train_accy 20.05:  95%|█████████▌| 19/20 [01:09<00:03,  3.57s/it]
Task 1, Epoch 20/20 => Loss 1.975, Train_accy 20.79:  95%|█████████▌| 19/20 [01:12<00:03,  3.57s/it]
Task 1, Epoch 20/20 => Loss 1.975, Train_accy 20.79: 100%|██████████| 20/20 [01:12<00:00,  3.53s/it]
Task 1, Epoch 20/20 => Loss 1.975, Train_accy 20.79: 100%|██████████| 20/20 [01:12<00:00,  3.63s/it]
2024-09-07 09:18:56,450 [finetune.py] => Task 1, Epoch 20/20 => Loss 1.975, Train_accy 20.79
2024-09-07 09:18:57,394 [trainer.py] => No NME accuracy.
2024-09-07 09:18:57,395 [trainer.py] => CNN: {'total': 12.0, '00-09': 1.3, '10-19': 20.41, 'old': 1.3, 'new': 20.41}
2024-09-07 09:18:57,395 [trainer.py] => CNN top1 curve: [18.18, 12.0]
2024-09-07 09:18:57,395 [trainer.py] => CNN top5 curve: [70.13, 50.29]

Average Accuracy (CNN): 15.09
2024-09-07 09:18:57,395 [trainer.py] => Average Accuracy (CNN): 15.09 

2024-09-07 09:18:57,397 [trainer.py] => All params: 85814036
2024-09-07 09:18:57,399 [trainer.py] => Trainable params: 85814036
2024-09-07 09:18:57,401 [finetune.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.437, Train_accy 0.83, Test_accy 9.12:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.437, Train_accy 0.83, Test_accy 9.12:   5%|▌         | 1/20 [00:04<01:22,  4.35s/it]
Task 2, Epoch 2/20 => Loss 2.240, Train_accy 2.48:   5%|▌         | 1/20 [00:07<01:22,  4.35s/it]                
Task 2, Epoch 2/20 => Loss 2.240, Train_accy 2.48:  10%|█         | 2/20 [00:07<01:05,  3.62s/it]
Task 2, Epoch 3/20 => Loss 2.197, Train_accy 1.10:  10%|█         | 2/20 [00:10<01:05,  3.62s/it]
Task 2, Epoch 3/20 => Loss 2.197, Train_accy 1.10:  15%|█▌        | 3/20 [00:10<00:57,  3.39s/it]
Task 2, Epoch 4/20 => Loss 2.183, Train_accy 1.38:  15%|█▌        | 3/20 [00:13<00:57,  3.39s/it]
Task 2, Epoch 4/20 => Loss 2.183, Train_accy 1.38:  20%|██        | 4/20 [00:13<00:52,  3.30s/it]
Task 2, Epoch 5/20 => Loss 2.136, Train_accy 2.75:  20%|██        | 4/20 [00:16<00:52,  3.30s/it]
Task 2, Epoch 5/20 => Loss 2.136, Train_accy 2.75:  25%|██▌       | 5/20 [00:16<00:48,  3.25s/it]
Task 2, Epoch 6/20 => Loss 2.139, Train_accy 2.75, Test_accy 8.03:  25%|██▌       | 5/20 [00:21<00:48,  3.25s/it]
Task 2, Epoch 6/20 => Loss 2.139, Train_accy 2.75, Test_accy 8.03:  30%|███       | 6/20 [00:21<00:51,  3.64s/it]
Task 2, Epoch 7/20 => Loss 2.139, Train_accy 3.31:  30%|███       | 6/20 [00:24<00:51,  3.64s/it]                
Task 2, Epoch 7/20 => Loss 2.139, Train_accy 3.31:  35%|███▌      | 7/20 [00:24<00:45,  3.48s/it]
Task 2, Epoch 8/20 => Loss 2.111, Train_accy 1.10:  35%|███▌      | 7/20 [00:27<00:45,  3.48s/it]
Task 2, Epoch 8/20 => Loss 2.111, Train_accy 1.10:  40%|████      | 8/20 [00:27<00:40,  3.38s/it]
Task 2, Epoch 9/20 => Loss 2.097, Train_accy 1.93:  40%|████      | 8/20 [00:30<00:40,  3.38s/it]
Task 2, Epoch 9/20 => Loss 2.097, Train_accy 1.93:  45%|████▌     | 9/20 [00:30<00:36,  3.30s/it]
Task 2, Epoch 10/20 => Loss 2.093, Train_accy 3.58:  45%|████▌     | 9/20 [00:33<00:36,  3.30s/it]
Task 2, Epoch 10/20 => Loss 2.093, Train_accy 3.58:  50%|█████     | 10/20 [00:33<00:32,  3.25s/it]
Task 2, Epoch 11/20 => Loss 2.103, Train_accy 5.23, Test_accy 8.76:  50%|█████     | 10/20 [00:38<00:32,  3.25s/it]
Task 2, Epoch 11/20 => Loss 2.103, Train_accy 5.23, Test_accy 8.76:  55%|█████▌    | 11/20 [00:38<00:32,  3.57s/it]
Task 2, Epoch 12/20 => Loss 2.100, Train_accy 5.23:  55%|█████▌    | 11/20 [00:41<00:32,  3.57s/it]                
Task 2, Epoch 12/20 => Loss 2.100, Train_accy 5.23:  60%|██████    | 12/20 [00:41<00:27,  3.46s/it]
Task 2, Epoch 13/20 => Loss 2.077, Train_accy 1.65:  60%|██████    | 12/20 [00:44<00:27,  3.46s/it]
Task 2, Epoch 13/20 => Loss 2.077, Train_accy 1.65:  65%|██████▌   | 13/20 [00:44<00:23,  3.37s/it]
Task 2, Epoch 14/20 => Loss 2.057, Train_accy 2.20:  65%|██████▌   | 13/20 [00:47<00:23,  3.37s/it]
Task 2, Epoch 14/20 => Loss 2.057, Train_accy 2.20:  70%|███████   | 14/20 [00:47<00:19,  3.30s/it]
Task 2, Epoch 15/20 => Loss 2.124, Train_accy 3.58:  70%|███████   | 14/20 [00:50<00:19,  3.30s/it]
Task 2, Epoch 15/20 => Loss 2.124, Train_accy 3.58:  75%|███████▌  | 15/20 [00:50<00:16,  3.26s/it]
Task 2, Epoch 16/20 => Loss 2.106, Train_accy 3.03, Test_accy 8.39:  75%|███████▌  | 15/20 [00:55<00:16,  3.26s/it]
Task 2, Epoch 16/20 => Loss 2.106, Train_accy 3.03, Test_accy 8.39:  80%|████████  | 16/20 [00:55<00:14,  3.59s/it]
Task 2, Epoch 17/20 => Loss 2.091, Train_accy 4.96:  80%|████████  | 16/20 [00:58<00:14,  3.59s/it]                
Task 2, Epoch 17/20 => Loss 2.091, Train_accy 4.96:  85%|████████▌ | 17/20 [00:58<00:10,  3.45s/it]
Task 2, Epoch 18/20 => Loss 2.100, Train_accy 3.86:  85%|████████▌ | 17/20 [01:01<00:10,  3.45s/it]
Task 2, Epoch 18/20 => Loss 2.100, Train_accy 3.86:  90%|█████████ | 18/20 [01:01<00:06,  3.36s/it]
Task 2, Epoch 19/20 => Loss 2.053, Train_accy 1.38:  90%|█████████ | 18/20 [01:04<00:06,  3.36s/it]
Task 2, Epoch 19/20 => Loss 2.053, Train_accy 1.38:  95%|█████████▌| 19/20 [01:04<00:03,  3.29s/it]
Task 2, Epoch 20/20 => Loss 2.050, Train_accy 8.82:  95%|█████████▌| 19/20 [01:07<00:03,  3.29s/it]
Task 2, Epoch 20/20 => Loss 2.050, Train_accy 8.82: 100%|██████████| 20/20 [01:07<00:00,  3.25s/it]
Task 2, Epoch 20/20 => Loss 2.050, Train_accy 8.82: 100%|██████████| 20/20 [01:07<00:00,  3.39s/it]
2024-09-07 09:20:05,167 [finetune.py] => Task 2, Epoch 20/20 => Loss 2.050, Train_accy 8.82
2024-09-07 09:20:06,390 [trainer.py] => No NME accuracy.
2024-09-07 09:20:06,391 [trainer.py] => CNN: {'total': 6.2, '00-09': 1.3, '10-19': 11.22, '20-29': 5.05, 'old': 6.86, 'new': 5.05}
2024-09-07 09:20:06,391 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2]
2024-09-07 09:20:06,391 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12]

Average Accuracy (CNN): 12.13
2024-09-07 09:20:06,391 [trainer.py] => Average Accuracy (CNN): 12.13 

2024-09-07 09:20:06,394 [trainer.py] => All params: 85821726
2024-09-07 09:20:06,395 [trainer.py] => Trainable params: 85821726
2024-09-07 09:20:06,398 [finetune.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.194, Train_accy 3.23, Test_accy 7.50:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.194, Train_accy 3.23, Test_accy 7.50:   5%|▌         | 1/20 [00:04<01:33,  4.93s/it]
Task 3, Epoch 2/20 => Loss 2.022, Train_accy 11.91:   5%|▌         | 1/20 [00:08<01:33,  4.93s/it]               
Task 3, Epoch 2/20 => Loss 2.022, Train_accy 11.91:  10%|█         | 2/20 [00:08<01:12,  4.05s/it]
Task 3, Epoch 3/20 => Loss 1.994, Train_accy 9.68:  10%|█         | 2/20 [00:11<01:12,  4.05s/it] 
Task 3, Epoch 3/20 => Loss 1.994, Train_accy 9.68:  15%|█▌        | 3/20 [00:11<01:04,  3.78s/it]
Task 3, Epoch 4/20 => Loss 1.976, Train_accy 8.19:  15%|█▌        | 3/20 [00:15<01:04,  3.78s/it]
Task 3, Epoch 4/20 => Loss 1.976, Train_accy 8.19:  20%|██        | 4/20 [00:15<00:58,  3.65s/it]
Task 3, Epoch 5/20 => Loss 1.956, Train_accy 14.64:  20%|██        | 4/20 [00:18<00:58,  3.65s/it]
Task 3, Epoch 5/20 => Loss 1.956, Train_accy 14.64:  25%|██▌       | 5/20 [00:18<00:53,  3.57s/it]
Task 3, Epoch 6/20 => Loss 1.939, Train_accy 14.64, Test_accy 8.61:  25%|██▌       | 5/20 [00:23<00:53,  3.57s/it]
Task 3, Epoch 6/20 => Loss 1.939, Train_accy 14.64, Test_accy 8.61:  30%|███       | 6/20 [00:23<00:56,  4.06s/it]
Task 3, Epoch 7/20 => Loss 1.911, Train_accy 13.65:  30%|███       | 6/20 [00:27<00:56,  4.06s/it]                
Task 3, Epoch 7/20 => Loss 1.911, Train_accy 13.65:  35%|███▌      | 7/20 [00:27<00:50,  3.86s/it]
Task 3, Epoch 8/20 => Loss 1.929, Train_accy 11.41:  35%|███▌      | 7/20 [00:30<00:50,  3.86s/it]
Task 3, Epoch 8/20 => Loss 1.929, Train_accy 11.41:  40%|████      | 8/20 [00:30<00:44,  3.72s/it]
Task 3, Epoch 9/20 => Loss 1.922, Train_accy 19.60:  40%|████      | 8/20 [00:34<00:44,  3.72s/it]
Task 3, Epoch 9/20 => Loss 1.922, Train_accy 19.60:  45%|████▌     | 9/20 [00:34<00:39,  3.63s/it]
Task 3, Epoch 10/20 => Loss 2.008, Train_accy 15.88:  45%|████▌     | 9/20 [00:37<00:39,  3.63s/it]
Task 3, Epoch 10/20 => Loss 2.008, Train_accy 15.88:  50%|█████     | 10/20 [00:37<00:35,  3.57s/it]
Task 3, Epoch 11/20 => Loss 2.023, Train_accy 22.08, Test_accy 8.33:  50%|█████     | 10/20 [00:42<00:35,  3.57s/it]
Task 3, Epoch 11/20 => Loss 2.023, Train_accy 22.08, Test_accy 8.33:  55%|█████▌    | 11/20 [00:42<00:35,  3.97s/it]
Task 3, Epoch 12/20 => Loss 2.004, Train_accy 21.09:  55%|█████▌    | 11/20 [00:45<00:35,  3.97s/it]                
Task 3, Epoch 12/20 => Loss 2.004, Train_accy 21.09:  60%|██████    | 12/20 [00:45<00:30,  3.80s/it]
Task 3, Epoch 13/20 => Loss 1.933, Train_accy 16.87:  60%|██████    | 12/20 [00:49<00:30,  3.80s/it]
Task 3, Epoch 13/20 => Loss 1.933, Train_accy 16.87:  65%|██████▌   | 13/20 [00:49<00:25,  3.70s/it]
Task 3, Epoch 14/20 => Loss 1.880, Train_accy 20.35:  65%|██████▌   | 13/20 [00:52<00:25,  3.70s/it]
Task 3, Epoch 14/20 => Loss 1.880, Train_accy 20.35:  70%|███████   | 14/20 [00:52<00:21,  3.62s/it]
Task 3, Epoch 15/20 => Loss 1.899, Train_accy 19.60:  70%|███████   | 14/20 [00:56<00:21,  3.62s/it]
Task 3, Epoch 15/20 => Loss 1.899, Train_accy 19.60:  75%|███████▌  | 15/20 [00:56<00:17,  3.59s/it]
Task 3, Epoch 16/20 => Loss 1.907, Train_accy 18.61, Test_accy 6.67:  75%|███████▌  | 15/20 [01:01<00:17,  3.59s/it]
Task 3, Epoch 16/20 => Loss 1.907, Train_accy 18.61, Test_accy 6.67:  80%|████████  | 16/20 [01:01<00:16,  4.04s/it]
Task 3, Epoch 17/20 => Loss 1.860, Train_accy 21.84:  80%|████████  | 16/20 [01:04<00:16,  4.04s/it]                
Task 3, Epoch 17/20 => Loss 1.860, Train_accy 21.84:  85%|████████▌ | 17/20 [01:04<00:11,  3.86s/it]
Task 3, Epoch 18/20 => Loss 1.820, Train_accy 16.63:  85%|████████▌ | 17/20 [01:08<00:11,  3.86s/it]
Task 3, Epoch 18/20 => Loss 1.820, Train_accy 16.63:  90%|█████████ | 18/20 [01:08<00:07,  3.78s/it]
Task 3, Epoch 19/20 => Loss 1.856, Train_accy 20.10:  90%|█████████ | 18/20 [01:11<00:07,  3.78s/it]
Task 3, Epoch 19/20 => Loss 1.856, Train_accy 20.10:  95%|█████████▌| 19/20 [01:11<00:03,  3.68s/it]
Task 3, Epoch 20/20 => Loss 1.855, Train_accy 18.86:  95%|█████████▌| 19/20 [01:15<00:03,  3.68s/it]
Task 3, Epoch 20/20 => Loss 1.855, Train_accy 18.86: 100%|██████████| 20/20 [01:15<00:00,  3.61s/it]
Task 3, Epoch 20/20 => Loss 1.855, Train_accy 18.86: 100%|██████████| 20/20 [01:15<00:00,  3.76s/it]
2024-09-07 09:21:21,586 [finetune.py] => Task 3, Epoch 20/20 => Loss 1.855, Train_accy 18.86
2024-09-07 09:21:23,047 [trainer.py] => No NME accuracy.
2024-09-07 09:21:23,048 [trainer.py] => CNN: {'total': 6.94, '00-09': 11.69, '10-19': 1.02, '20-29': 5.05, '30-39': 11.63, 'old': 5.47, 'new': 11.63}
2024-09-07 09:21:23,048 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94]
2024-09-07 09:21:23,048 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39]

Average Accuracy (CNN): 10.83
2024-09-07 09:21:23,048 [trainer.py] => Average Accuracy (CNN): 10.83 

2024-09-07 09:21:23,050 [trainer.py] => All params: 85829416
2024-09-07 09:21:23,052 [trainer.py] => Trainable params: 85829416
2024-09-07 09:21:23,054 [finetune.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.065, Train_accy 5.54, Test_accy 5.42:   0%|          | 0/20 [00:04<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.065, Train_accy 5.54, Test_accy 5.42:   5%|▌         | 1/20 [00:04<01:16,  4.04s/it]
Task 4, Epoch 2/20 => Loss 1.979, Train_accy 19.56:   5%|▌         | 1/20 [00:06<01:16,  4.04s/it]               
Task 4, Epoch 2/20 => Loss 1.979, Train_accy 19.56:  10%|█         | 2/20 [00:06<00:55,  3.08s/it]
Task 4, Epoch 3/20 => Loss 1.911, Train_accy 11.07:  10%|█         | 2/20 [00:08<00:55,  3.08s/it]
Task 4, Epoch 3/20 => Loss 1.911, Train_accy 11.07:  15%|█▌        | 3/20 [00:08<00:47,  2.79s/it]
Task 4, Epoch 4/20 => Loss 1.915, Train_accy 19.93:  15%|█▌        | 3/20 [00:11<00:47,  2.79s/it]
Task 4, Epoch 4/20 => Loss 1.915, Train_accy 19.93:  20%|██        | 4/20 [00:11<00:42,  2.65s/it]
Task 4, Epoch 5/20 => Loss 1.883, Train_accy 20.30:  20%|██        | 4/20 [00:13<00:42,  2.65s/it]
Task 4, Epoch 5/20 => Loss 1.883, Train_accy 20.30:  25%|██▌       | 5/20 [00:13<00:38,  2.57s/it]
Task 4, Epoch 6/20 => Loss 1.837, Train_accy 20.30, Test_accy 7.31:  25%|██▌       | 5/20 [00:17<00:38,  2.57s/it]
Task 4, Epoch 6/20 => Loss 1.837, Train_accy 20.30, Test_accy 7.31:  30%|███       | 6/20 [00:17<00:43,  3.08s/it]
Task 4, Epoch 7/20 => Loss 1.833, Train_accy 22.51:  30%|███       | 6/20 [00:20<00:43,  3.08s/it]                
Task 4, Epoch 7/20 => Loss 1.833, Train_accy 22.51:  35%|███▌      | 7/20 [00:20<00:37,  2.86s/it]
Task 4, Epoch 8/20 => Loss 1.866, Train_accy 16.61:  35%|███▌      | 7/20 [00:22<00:37,  2.86s/it]
Task 4, Epoch 8/20 => Loss 1.866, Train_accy 16.61:  40%|████      | 8/20 [00:22<00:32,  2.72s/it]
Task 4, Epoch 9/20 => Loss 1.771, Train_accy 19.93:  40%|████      | 8/20 [00:25<00:32,  2.72s/it]
Task 4, Epoch 9/20 => Loss 1.771, Train_accy 19.93:  45%|████▌     | 9/20 [00:25<00:28,  2.63s/it]
Task 4, Epoch 10/20 => Loss 1.752, Train_accy 27.68:  45%|████▌     | 9/20 [00:27<00:28,  2.63s/it]
Task 4, Epoch 10/20 => Loss 1.752, Train_accy 27.68:  50%|█████     | 10/20 [00:27<00:25,  2.57s/it]
Task 4, Epoch 11/20 => Loss 1.732, Train_accy 23.25, Test_accy 8.02:  50%|█████     | 10/20 [00:31<00:25,  2.57s/it]
Task 4, Epoch 11/20 => Loss 1.732, Train_accy 23.25, Test_accy 8.02:  55%|█████▌    | 11/20 [00:31<00:27,  3.03s/it]
Task 4, Epoch 12/20 => Loss 1.701, Train_accy 27.68:  55%|█████▌    | 11/20 [00:34<00:27,  3.03s/it]                
Task 4, Epoch 12/20 => Loss 1.701, Train_accy 27.68:  60%|██████    | 12/20 [00:34<00:22,  2.85s/it]
Task 4, Epoch 13/20 => Loss 1.712, Train_accy 27.31:  60%|██████    | 12/20 [00:36<00:22,  2.85s/it]
Task 4, Epoch 13/20 => Loss 1.712, Train_accy 27.31:  65%|██████▌   | 13/20 [00:36<00:19,  2.72s/it]
Task 4, Epoch 14/20 => Loss 1.688, Train_accy 31.00:  65%|██████▌   | 13/20 [00:38<00:19,  2.72s/it]
Task 4, Epoch 14/20 => Loss 1.688, Train_accy 31.00:  70%|███████   | 14/20 [00:38<00:15,  2.64s/it]
Task 4, Epoch 15/20 => Loss 1.691, Train_accy 35.06:  70%|███████   | 14/20 [00:41<00:15,  2.64s/it]
Task 4, Epoch 15/20 => Loss 1.691, Train_accy 35.06:  75%|███████▌  | 15/20 [00:41<00:12,  2.58s/it]
Task 4, Epoch 16/20 => Loss 1.714, Train_accy 25.46, Test_accy 6.37:  75%|███████▌  | 15/20 [00:45<00:12,  2.58s/it]
Task 4, Epoch 16/20 => Loss 1.714, Train_accy 25.46, Test_accy 6.37:  80%|████████  | 16/20 [00:45<00:12,  3.02s/it]
Task 4, Epoch 17/20 => Loss 1.638, Train_accy 28.78:  80%|████████  | 16/20 [00:47<00:12,  3.02s/it]                
Task 4, Epoch 17/20 => Loss 1.638, Train_accy 28.78:  85%|████████▌ | 17/20 [00:47<00:08,  2.84s/it]
Task 4, Epoch 18/20 => Loss 1.613, Train_accy 40.59:  85%|████████▌ | 17/20 [00:50<00:08,  2.84s/it]
Task 4, Epoch 18/20 => Loss 1.613, Train_accy 40.59:  90%|█████████ | 18/20 [00:50<00:05,  2.71s/it]
Task 4, Epoch 19/20 => Loss 1.615, Train_accy 38.75:  90%|█████████ | 18/20 [00:52<00:05,  2.71s/it]
Task 4, Epoch 19/20 => Loss 1.615, Train_accy 38.75:  95%|█████████▌| 19/20 [00:52<00:02,  2.62s/it]
Task 4, Epoch 20/20 => Loss 1.629, Train_accy 37.27:  95%|█████████▌| 19/20 [00:55<00:02,  2.62s/it]
Task 4, Epoch 20/20 => Loss 1.629, Train_accy 37.27: 100%|██████████| 20/20 [00:55<00:00,  2.56s/it]
Task 4, Epoch 20/20 => Loss 1.629, Train_accy 37.27: 100%|██████████| 20/20 [00:55<00:00,  2.75s/it]
2024-09-07 09:22:18,113 [finetune.py] => Task 4, Epoch 20/20 => Loss 1.629, Train_accy 37.27
2024-09-07 09:22:19,757 [trainer.py] => No NME accuracy.
2024-09-07 09:22:19,757 [trainer.py] => CNN: {'total': 7.31, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 6.98, '40-49': 39.06, 'old': 1.67, 'new': 39.06}
2024-09-07 09:22:19,757 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31]
2024-09-07 09:22:19,757 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7]

Average Accuracy (CNN): 10.13
2024-09-07 09:22:19,757 [trainer.py] => Average Accuracy (CNN): 10.13 

2024-09-07 09:22:19,759 [trainer.py] => All params: 85837106
2024-09-07 09:22:19,760 [trainer.py] => Trainable params: 85837106
2024-09-07 09:22:19,762 [finetune.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.131, Train_accy 0.00, Test_accy 5.04:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.131, Train_accy 0.00, Test_accy 5.04:   5%|▌         | 1/20 [00:03<01:15,  3.98s/it]
Task 5, Epoch 2/20 => Loss 1.950, Train_accy 13.33:   5%|▌         | 1/20 [00:06<01:15,  3.98s/it]               
Task 5, Epoch 2/20 => Loss 1.950, Train_accy 13.33:  10%|█         | 2/20 [00:06<00:52,  2.91s/it]
Task 5, Epoch 3/20 => Loss 1.848, Train_accy 7.92:  10%|█         | 2/20 [00:08<00:52,  2.91s/it] 
Task 5, Epoch 3/20 => Loss 1.848, Train_accy 7.92:  15%|█▌        | 3/20 [00:08<00:43,  2.57s/it]
Task 5, Epoch 4/20 => Loss 1.739, Train_accy 25.00:  15%|█▌        | 3/20 [00:10<00:43,  2.57s/it]
Task 5, Epoch 4/20 => Loss 1.739, Train_accy 25.00:  20%|██        | 4/20 [00:10<00:38,  2.41s/it]
Task 5, Epoch 5/20 => Loss 1.716, Train_accy 24.17:  20%|██        | 4/20 [00:12<00:38,  2.41s/it]
Task 5, Epoch 5/20 => Loss 1.716, Train_accy 24.17:  25%|██▌       | 5/20 [00:12<00:34,  2.32s/it]
Task 5, Epoch 6/20 => Loss 1.694, Train_accy 20.42, Test_accy 6.09:  25%|██▌       | 5/20 [00:16<00:34,  2.32s/it]
Task 5, Epoch 6/20 => Loss 1.694, Train_accy 20.42, Test_accy 6.09:  30%|███       | 6/20 [00:16<00:40,  2.87s/it]
Task 5, Epoch 7/20 => Loss 1.640, Train_accy 30.42:  30%|███       | 6/20 [00:18<00:40,  2.87s/it]                
Task 5, Epoch 7/20 => Loss 1.640, Train_accy 30.42:  35%|███▌      | 7/20 [00:18<00:34,  2.64s/it]
Task 5, Epoch 8/20 => Loss 1.654, Train_accy 23.33:  35%|███▌      | 7/20 [00:20<00:34,  2.64s/it]
Task 5, Epoch 8/20 => Loss 1.654, Train_accy 23.33:  40%|████      | 8/20 [00:20<00:29,  2.49s/it]
Task 5, Epoch 9/20 => Loss 1.596, Train_accy 25.83:  40%|████      | 8/20 [00:23<00:29,  2.49s/it]
Task 5, Epoch 9/20 => Loss 1.596, Train_accy 25.83:  45%|████▌     | 9/20 [00:23<00:26,  2.41s/it]
Task 5, Epoch 10/20 => Loss 1.627, Train_accy 17.08:  45%|████▌     | 9/20 [00:25<00:26,  2.41s/it]
Task 5, Epoch 10/20 => Loss 1.627, Train_accy 17.08:  50%|█████     | 10/20 [00:25<00:23,  2.34s/it]
Task 5, Epoch 11/20 => Loss 1.628, Train_accy 29.17, Test_accy 7.14:  50%|█████     | 10/20 [00:29<00:23,  2.34s/it]
Task 5, Epoch 11/20 => Loss 1.628, Train_accy 29.17, Test_accy 7.14:  55%|█████▌    | 11/20 [00:29<00:25,  2.84s/it]
Task 5, Epoch 12/20 => Loss 1.633, Train_accy 21.25:  55%|█████▌    | 11/20 [00:31<00:25,  2.84s/it]                
Task 5, Epoch 12/20 => Loss 1.633, Train_accy 21.25:  60%|██████    | 12/20 [00:31<00:21,  2.63s/it]
Task 5, Epoch 13/20 => Loss 1.509, Train_accy 30.00:  60%|██████    | 12/20 [00:33<00:21,  2.63s/it]
Task 5, Epoch 13/20 => Loss 1.509, Train_accy 30.00:  65%|██████▌   | 13/20 [00:33<00:17,  2.49s/it]
Task 5, Epoch 14/20 => Loss 1.511, Train_accy 22.92:  65%|██████▌   | 13/20 [00:35<00:17,  2.49s/it]
Task 5, Epoch 14/20 => Loss 1.511, Train_accy 22.92:  70%|███████   | 14/20 [00:35<00:14,  2.40s/it]
Task 5, Epoch 15/20 => Loss 1.450, Train_accy 28.33:  70%|███████   | 14/20 [00:37<00:14,  2.40s/it]
Task 5, Epoch 15/20 => Loss 1.450, Train_accy 28.33:  75%|███████▌  | 15/20 [00:37<00:11,  2.33s/it]
Task 5, Epoch 16/20 => Loss 1.475, Train_accy 27.08, Test_accy 7.14:  75%|███████▌  | 15/20 [00:41<00:11,  2.33s/it]
Task 5, Epoch 16/20 => Loss 1.475, Train_accy 27.08, Test_accy 7.14:  80%|████████  | 16/20 [00:41<00:11,  2.82s/it]
Task 5, Epoch 17/20 => Loss 1.445, Train_accy 26.67:  80%|████████  | 16/20 [00:44<00:11,  2.82s/it]                
Task 5, Epoch 17/20 => Loss 1.445, Train_accy 26.67:  85%|████████▌ | 17/20 [00:44<00:07,  2.64s/it]
Task 5, Epoch 18/20 => Loss 1.452, Train_accy 25.83:  85%|████████▌ | 17/20 [00:46<00:07,  2.64s/it]
Task 5, Epoch 18/20 => Loss 1.452, Train_accy 25.83:  90%|█████████ | 18/20 [00:46<00:05,  2.51s/it]
Task 5, Epoch 19/20 => Loss 1.339, Train_accy 26.67:  90%|█████████ | 18/20 [00:48<00:05,  2.51s/it]
Task 5, Epoch 19/20 => Loss 1.339, Train_accy 26.67:  95%|█████████▌| 19/20 [00:48<00:02,  2.40s/it]
Task 5, Epoch 20/20 => Loss 1.260, Train_accy 32.92:  95%|█████████▌| 19/20 [00:50<00:02,  2.40s/it]
Task 5, Epoch 20/20 => Loss 1.260, Train_accy 32.92: 100%|██████████| 20/20 [00:50<00:00,  2.34s/it]
Task 5, Epoch 20/20 => Loss 1.260, Train_accy 32.92: 100%|██████████| 20/20 [00:50<00:00,  2.53s/it]
2024-09-07 09:23:10,465 [finetune.py] => Task 5, Epoch 20/20 => Loss 1.260, Train_accy 32.92
2024-09-07 09:23:12,260 [trainer.py] => No NME accuracy.
2024-09-07 09:23:12,261 [trainer.py] => CNN: {'total': 7.35, '00-09': 3.9, '10-19': 0.0, '20-29': 1.01, '30-39': 4.65, '40-49': 20.31, '50-59': 26.92, 'old': 4.95, 'new': 26.92}
2024-09-07 09:23:12,261 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35]
2024-09-07 09:23:12,261 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43]

Average Accuracy (CNN): 9.66
2024-09-07 09:23:12,261 [trainer.py] => Average Accuracy (CNN): 9.66 

2024-09-07 09:23:12,262 [trainer.py] => All params: 85844796
2024-09-07 09:23:12,264 [trainer.py] => Trainable params: 85844796
2024-09-07 09:23:12,266 [finetune.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.133, Train_accy 0.46, Test_accy 4.98:   0%|          | 0/20 [00:05<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.133, Train_accy 0.46, Test_accy 4.98:   5%|▌         | 1/20 [00:05<01:52,  5.93s/it]
Task 6, Epoch 2/20 => Loss 2.078, Train_accy 8.03:   5%|▌         | 1/20 [00:09<01:52,  5.93s/it]                
Task 6, Epoch 2/20 => Loss 2.078, Train_accy 8.03:  10%|█         | 2/20 [00:09<01:23,  4.63s/it]
Task 6, Epoch 3/20 => Loss 1.967, Train_accy 7.57:  10%|█         | 2/20 [00:13<01:23,  4.63s/it]
Task 6, Epoch 3/20 => Loss 1.967, Train_accy 7.57:  15%|█▌        | 3/20 [00:13<01:11,  4.21s/it]
Task 6, Epoch 4/20 => Loss 1.984, Train_accy 9.86:  15%|█▌        | 3/20 [00:17<01:11,  4.21s/it]
Task 6, Epoch 4/20 => Loss 1.984, Train_accy 9.86:  20%|██        | 4/20 [00:17<01:04,  4.02s/it]
Task 6, Epoch 5/20 => Loss 1.926, Train_accy 7.11:  20%|██        | 4/20 [00:20<01:04,  4.02s/it]
Task 6, Epoch 5/20 => Loss 1.926, Train_accy 7.11:  25%|██▌       | 5/20 [00:20<00:58,  3.90s/it]
Task 6, Epoch 6/20 => Loss 1.981, Train_accy 12.39, Test_accy 5.48:  25%|██▌       | 5/20 [00:26<00:58,  3.90s/it]
Task 6, Epoch 6/20 => Loss 1.981, Train_accy 12.39, Test_accy 5.48:  30%|███       | 6/20 [00:26<01:03,  4.56s/it]
Task 6, Epoch 7/20 => Loss 1.963, Train_accy 16.74:  30%|███       | 6/20 [00:30<01:03,  4.56s/it]                
Task 6, Epoch 7/20 => Loss 1.963, Train_accy 16.74:  35%|███▌      | 7/20 [00:30<00:55,  4.27s/it]
Task 6, Epoch 8/20 => Loss 1.810, Train_accy 20.18:  35%|███▌      | 7/20 [00:33<00:55,  4.27s/it]
Task 6, Epoch 8/20 => Loss 1.810, Train_accy 20.18:  40%|████      | 8/20 [00:33<00:48,  4.08s/it]
Task 6, Epoch 9/20 => Loss 1.806, Train_accy 16.74:  40%|████      | 8/20 [00:37<00:48,  4.08s/it]
Task 6, Epoch 9/20 => Loss 1.806, Train_accy 16.74:  45%|████▌     | 9/20 [00:37<00:43,  3.98s/it]
Task 6, Epoch 10/20 => Loss 1.792, Train_accy 19.72:  45%|████▌     | 9/20 [00:41<00:43,  3.98s/it]
Task 6, Epoch 10/20 => Loss 1.792, Train_accy 19.72:  50%|█████     | 10/20 [00:41<00:39,  3.91s/it]
Task 6, Epoch 11/20 => Loss 1.808, Train_accy 19.27, Test_accy 4.32:  50%|█████     | 10/20 [00:47<00:39,  3.91s/it]
Task 6, Epoch 11/20 => Loss 1.808, Train_accy 19.27, Test_accy 4.32:  55%|█████▌    | 11/20 [00:47<00:40,  4.52s/it]
Task 6, Epoch 12/20 => Loss 1.696, Train_accy 22.25:  55%|█████▌    | 11/20 [00:51<00:40,  4.52s/it]                
Task 6, Epoch 12/20 => Loss 1.696, Train_accy 22.25:  60%|██████    | 12/20 [00:51<00:34,  4.27s/it]
Task 6, Epoch 13/20 => Loss 1.813, Train_accy 23.62:  60%|██████    | 12/20 [00:54<00:34,  4.27s/it]
Task 6, Epoch 13/20 => Loss 1.813, Train_accy 23.62:  65%|██████▌   | 13/20 [00:54<00:28,  4.11s/it]
Task 6, Epoch 14/20 => Loss 1.752, Train_accy 25.46:  65%|██████▌   | 13/20 [00:58<00:28,  4.11s/it]
Task 6, Epoch 14/20 => Loss 1.752, Train_accy 25.46:  70%|███████   | 14/20 [00:58<00:24,  4.01s/it]
Task 6, Epoch 15/20 => Loss 1.545, Train_accy 26.83:  70%|███████   | 14/20 [01:02<00:24,  4.01s/it]
Task 6, Epoch 15/20 => Loss 1.545, Train_accy 26.83:  75%|███████▌  | 15/20 [01:02<00:19,  3.91s/it]
Task 6, Epoch 16/20 => Loss 1.609, Train_accy 31.88, Test_accy 6.81:  75%|███████▌  | 15/20 [01:08<00:19,  3.91s/it]
Task 6, Epoch 16/20 => Loss 1.609, Train_accy 31.88, Test_accy 6.81:  80%|████████  | 16/20 [01:08<00:18,  4.50s/it]
Task 6, Epoch 17/20 => Loss 1.631, Train_accy 28.67:  80%|████████  | 16/20 [01:11<00:18,  4.50s/it]                
Task 6, Epoch 17/20 => Loss 1.631, Train_accy 28.67:  85%|████████▌ | 17/20 [01:11<00:12,  4.26s/it]
Task 6, Epoch 18/20 => Loss 1.666, Train_accy 29.59:  85%|████████▌ | 17/20 [01:15<00:12,  4.26s/it]
Task 6, Epoch 18/20 => Loss 1.666, Train_accy 29.59:  90%|█████████ | 18/20 [01:15<00:08,  4.10s/it]
Task 6, Epoch 19/20 => Loss 1.466, Train_accy 37.16:  90%|█████████ | 18/20 [01:19<00:08,  4.10s/it]
Task 6, Epoch 19/20 => Loss 1.466, Train_accy 37.16:  95%|█████████▌| 19/20 [01:19<00:04,  4.01s/it]
Task 6, Epoch 20/20 => Loss 1.473, Train_accy 35.32:  95%|█████████▌| 19/20 [01:23<00:04,  4.01s/it]
Task 6, Epoch 20/20 => Loss 1.473, Train_accy 35.32: 100%|██████████| 20/20 [01:23<00:00,  3.93s/it]
Task 6, Epoch 20/20 => Loss 1.473, Train_accy 35.32: 100%|██████████| 20/20 [01:23<00:00,  4.16s/it]
2024-09-07 09:24:35,410 [finetune.py] => Task 6, Epoch 20/20 => Loss 1.473, Train_accy 35.32
2024-09-07 09:24:37,598 [trainer.py] => No NME accuracy.
2024-09-07 09:24:37,598 [trainer.py] => CNN: {'total': 6.81, '00-09': 2.6, '10-19': 0.0, '20-29': 1.01, '30-39': 1.16, '40-49': 14.06, '50-59': 3.85, '60-69': 20.63, 'old': 3.15, 'new': 20.63}
2024-09-07 09:24:37,598 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81]
2024-09-07 09:24:37,598 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26]

Average Accuracy (CNN): 9.26
2024-09-07 09:24:37,598 [trainer.py] => Average Accuracy (CNN): 9.26 

2024-09-07 09:24:37,600 [trainer.py] => All params: 85852486
2024-09-07 09:24:37,601 [trainer.py] => Trainable params: 85852486
2024-09-07 09:24:37,603 [finetune.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.261, Train_accy 2.30, Test_accy 3.72:   0%|          | 0/20 [00:05<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.261, Train_accy 2.30, Test_accy 3.72:   5%|▌         | 1/20 [00:05<01:44,  5.48s/it]
Task 7, Epoch 2/20 => Loss 1.822, Train_accy 10.34:   5%|▌         | 1/20 [00:08<01:44,  5.48s/it]               
Task 7, Epoch 2/20 => Loss 1.822, Train_accy 10.34:  10%|█         | 2/20 [00:08<01:12,  4.05s/it]
Task 7, Epoch 3/20 => Loss 1.627, Train_accy 27.87:  10%|█         | 2/20 [00:11<01:12,  4.05s/it]
Task 7, Epoch 3/20 => Loss 1.627, Train_accy 27.87:  15%|█▌        | 3/20 [00:11<01:01,  3.59s/it]
Task 7, Epoch 4/20 => Loss 1.535, Train_accy 28.74:  15%|█▌        | 3/20 [00:14<01:01,  3.59s/it]
Task 7, Epoch 4/20 => Loss 1.535, Train_accy 28.74:  20%|██        | 4/20 [00:14<00:54,  3.39s/it]
Task 7, Epoch 5/20 => Loss 1.341, Train_accy 40.80:  20%|██        | 4/20 [00:17<00:54,  3.39s/it]
Task 7, Epoch 5/20 => Loss 1.341, Train_accy 40.80:  25%|██▌       | 5/20 [00:17<00:48,  3.25s/it]
Task 7, Epoch 6/20 => Loss 1.269, Train_accy 43.10, Test_accy 6.30:  25%|██▌       | 5/20 [00:23<00:48,  3.25s/it]
Task 7, Epoch 6/20 => Loss 1.269, Train_accy 43.10, Test_accy 6.30:  30%|███       | 6/20 [00:23<00:55,  4.00s/it]
Task 7, Epoch 7/20 => Loss 1.219, Train_accy 47.70:  30%|███       | 6/20 [00:26<00:55,  4.00s/it]                
Task 7, Epoch 7/20 => Loss 1.219, Train_accy 47.70:  35%|███▌      | 7/20 [00:26<00:47,  3.68s/it]
Task 7, Epoch 8/20 => Loss 1.109, Train_accy 56.90:  35%|███▌      | 7/20 [00:29<00:47,  3.68s/it]
Task 7, Epoch 8/20 => Loss 1.109, Train_accy 56.90:  40%|████      | 8/20 [00:29<00:41,  3.49s/it]
Task 7, Epoch 9/20 => Loss 1.030, Train_accy 58.33:  40%|████      | 8/20 [00:32<00:41,  3.49s/it]
Task 7, Epoch 9/20 => Loss 1.030, Train_accy 58.33:  45%|████▌     | 9/20 [00:32<00:36,  3.34s/it]
Task 7, Epoch 10/20 => Loss 0.927, Train_accy 58.62:  45%|████▌     | 9/20 [00:35<00:36,  3.34s/it]
Task 7, Epoch 10/20 => Loss 0.927, Train_accy 58.62:  50%|█████     | 10/20 [00:35<00:32,  3.23s/it]
Task 7, Epoch 11/20 => Loss 0.804, Train_accy 65.23, Test_accy 5.59:  50%|█████     | 10/20 [00:40<00:32,  3.23s/it]
Task 7, Epoch 11/20 => Loss 0.804, Train_accy 65.23, Test_accy 5.59:  55%|█████▌    | 11/20 [00:40<00:35,  3.91s/it]
Task 7, Epoch 12/20 => Loss 0.779, Train_accy 67.82:  55%|█████▌    | 11/20 [00:43<00:35,  3.91s/it]                
Task 7, Epoch 12/20 => Loss 0.779, Train_accy 67.82:  60%|██████    | 12/20 [00:43<00:29,  3.64s/it]
Task 7, Epoch 13/20 => Loss 0.842, Train_accy 68.97:  60%|██████    | 12/20 [00:46<00:29,  3.64s/it]
Task 7, Epoch 13/20 => Loss 0.842, Train_accy 68.97:  65%|██████▌   | 13/20 [00:46<00:24,  3.48s/it]
Task 7, Epoch 14/20 => Loss 0.875, Train_accy 62.07:  65%|██████▌   | 13/20 [00:49<00:24,  3.48s/it]
Task 7, Epoch 14/20 => Loss 0.875, Train_accy 62.07:  70%|███████   | 14/20 [00:49<00:20,  3.34s/it]
Task 7, Epoch 15/20 => Loss 0.784, Train_accy 69.54:  70%|███████   | 14/20 [00:52<00:20,  3.34s/it]
Task 7, Epoch 15/20 => Loss 0.784, Train_accy 69.54:  75%|███████▌  | 15/20 [00:52<00:16,  3.25s/it]
Task 7, Epoch 16/20 => Loss 0.671, Train_accy 75.00, Test_accy 7.88:  75%|███████▌  | 15/20 [00:58<00:16,  3.25s/it]
Task 7, Epoch 16/20 => Loss 0.671, Train_accy 75.00, Test_accy 7.88:  80%|████████  | 16/20 [00:58<00:15,  3.93s/it]
Task 7, Epoch 17/20 => Loss 0.709, Train_accy 75.29:  80%|████████  | 16/20 [01:01<00:15,  3.93s/it]                
Task 7, Epoch 17/20 => Loss 0.709, Train_accy 75.29:  85%|████████▌ | 17/20 [01:01<00:10,  3.66s/it]
Task 7, Epoch 18/20 => Loss 0.602, Train_accy 74.43:  85%|████████▌ | 17/20 [01:04<00:10,  3.66s/it]
Task 7, Epoch 18/20 => Loss 0.602, Train_accy 74.43:  90%|█████████ | 18/20 [01:04<00:06,  3.47s/it]
Task 7, Epoch 19/20 => Loss 0.591, Train_accy 77.87:  90%|█████████ | 18/20 [01:07<00:06,  3.47s/it]
Task 7, Epoch 19/20 => Loss 0.591, Train_accy 77.87:  95%|█████████▌| 19/20 [01:07<00:03,  3.35s/it]
Task 7, Epoch 20/20 => Loss 0.414, Train_accy 83.91:  95%|█████████▌| 19/20 [01:10<00:03,  3.35s/it]
Task 7, Epoch 20/20 => Loss 0.414, Train_accy 83.91: 100%|██████████| 20/20 [01:10<00:00,  3.26s/it]
Task 7, Epoch 20/20 => Loss 0.414, Train_accy 83.91: 100%|██████████| 20/20 [01:10<00:00,  3.53s/it]
2024-09-07 09:25:48,135 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.414, Train_accy 83.91
2024-09-07 09:25:50,597 [trainer.py] => No NME accuracy.
2024-09-07 09:25:50,598 [trainer.py] => CNN: {'total': 6.3, '00-09': 0.0, '10-19': 0.0, '20-29': 1.01, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.79, '70-79': 43.75, 'old': 0.33, 'new': 43.75}
2024-09-07 09:25:50,598 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3]
2024-09-07 09:25:50,598 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34]

Average Accuracy (CNN): 8.89
2024-09-07 09:25:50,598 [trainer.py] => Average Accuracy (CNN): 8.89 

2024-09-07 09:25:50,599 [trainer.py] => All params: 85860176
2024-09-07 09:25:50,600 [trainer.py] => Trainable params: 85860176
2024-09-07 09:25:50,603 [finetune.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.156, Train_accy 3.11, Test_accy 5.26:   0%|          | 0/20 [00:05<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.156, Train_accy 3.11, Test_accy 5.26:   5%|▌         | 1/20 [00:05<01:41,  5.35s/it]
Task 8, Epoch 2/20 => Loss 1.817, Train_accy 10.38:   5%|▌         | 1/20 [00:07<01:41,  5.35s/it]               
Task 8, Epoch 2/20 => Loss 1.817, Train_accy 10.38:  10%|█         | 2/20 [00:07<01:07,  3.74s/it]
Task 8, Epoch 3/20 => Loss 1.975, Train_accy 10.73:  10%|█         | 2/20 [00:10<01:07,  3.74s/it]
Task 8, Epoch 3/20 => Loss 1.975, Train_accy 10.73:  15%|█▌        | 3/20 [00:10<00:55,  3.24s/it]
Task 8, Epoch 4/20 => Loss 2.032, Train_accy 16.96:  15%|█▌        | 3/20 [00:13<00:55,  3.24s/it]
Task 8, Epoch 4/20 => Loss 2.032, Train_accy 16.96:  20%|██        | 4/20 [00:13<00:48,  3.01s/it]
Task 8, Epoch 5/20 => Loss 2.364, Train_accy 13.84:  20%|██        | 4/20 [00:15<00:48,  3.01s/it]
Task 8, Epoch 5/20 => Loss 2.364, Train_accy 13.84:  25%|██▌       | 5/20 [00:15<00:42,  2.86s/it]
Task 8, Epoch 6/20 => Loss 2.305, Train_accy 2.42, Test_accy 3.72:  25%|██▌       | 5/20 [00:21<00:42,  2.86s/it]
Task 8, Epoch 6/20 => Loss 2.305, Train_accy 2.42, Test_accy 3.72:  30%|███       | 6/20 [00:21<00:51,  3.68s/it]
Task 8, Epoch 7/20 => Loss 1.829, Train_accy 16.96:  30%|███       | 6/20 [00:23<00:51,  3.68s/it]               
Task 8, Epoch 7/20 => Loss 1.829, Train_accy 16.96:  35%|███▌      | 7/20 [00:23<00:43,  3.33s/it]
Task 8, Epoch 8/20 => Loss 1.910, Train_accy 35.29:  35%|███▌      | 7/20 [00:26<00:43,  3.33s/it]
Task 8, Epoch 8/20 => Loss 1.910, Train_accy 35.29:  40%|████      | 8/20 [00:26<00:37,  3.09s/it]
Task 8, Epoch 9/20 => Loss 1.906, Train_accy 32.87:  40%|████      | 8/20 [00:28<00:37,  3.09s/it]
Task 8, Epoch 9/20 => Loss 1.906, Train_accy 32.87:  45%|████▌     | 9/20 [00:28<00:32,  2.93s/it]
Task 8, Epoch 10/20 => Loss 2.053, Train_accy 25.61:  45%|████▌     | 9/20 [00:31<00:32,  2.93s/it]
Task 8, Epoch 10/20 => Loss 2.053, Train_accy 25.61:  50%|█████     | 10/20 [00:31<00:28,  2.83s/it]
Task 8, Epoch 11/20 => Loss 2.023, Train_accy 26.64, Test_accy 1.41:  50%|█████     | 10/20 [00:36<00:28,  2.83s/it]
Task 8, Epoch 11/20 => Loss 2.023, Train_accy 26.64, Test_accy 1.41:  55%|█████▌    | 11/20 [00:36<00:32,  3.58s/it]
Task 8, Epoch 12/20 => Loss 1.808, Train_accy 19.72:  55%|█████▌    | 11/20 [00:39<00:32,  3.58s/it]                
Task 8, Epoch 12/20 => Loss 1.808, Train_accy 19.72:  60%|██████    | 12/20 [00:39<00:26,  3.27s/it]
Task 8, Epoch 13/20 => Loss 1.735, Train_accy 35.64:  60%|██████    | 12/20 [00:42<00:26,  3.27s/it]
Task 8, Epoch 13/20 => Loss 1.735, Train_accy 35.64:  65%|██████▌   | 13/20 [00:42<00:21,  3.09s/it]
Task 8, Epoch 14/20 => Loss 1.455, Train_accy 34.95:  65%|██████▌   | 13/20 [00:44<00:21,  3.09s/it]
Task 8, Epoch 14/20 => Loss 1.455, Train_accy 34.95:  70%|███████   | 14/20 [00:44<00:17,  2.94s/it]
Task 8, Epoch 15/20 => Loss 1.622, Train_accy 40.48:  70%|███████   | 14/20 [00:47<00:17,  2.94s/it]
Task 8, Epoch 15/20 => Loss 1.622, Train_accy 40.48:  75%|███████▌  | 15/20 [00:47<00:14,  2.83s/it]
Task 8, Epoch 16/20 => Loss 1.335, Train_accy 49.13, Test_accy 5.91:  75%|███████▌  | 15/20 [00:52<00:14,  2.83s/it]
Task 8, Epoch 16/20 => Loss 1.335, Train_accy 49.13, Test_accy 5.91:  80%|████████  | 16/20 [00:52<00:14,  3.59s/it]
Task 8, Epoch 17/20 => Loss 1.217, Train_accy 48.10:  80%|████████  | 16/20 [00:55<00:14,  3.59s/it]                
Task 8, Epoch 17/20 => Loss 1.217, Train_accy 48.10:  85%|████████▌ | 17/20 [00:55<00:09,  3.28s/it]
Task 8, Epoch 18/20 => Loss 1.335, Train_accy 53.29:  85%|████████▌ | 17/20 [00:57<00:09,  3.28s/it]
Task 8, Epoch 18/20 => Loss 1.335, Train_accy 53.29:  90%|█████████ | 18/20 [00:57<00:06,  3.09s/it]
Task 8, Epoch 19/20 => Loss 1.303, Train_accy 48.10:  90%|█████████ | 18/20 [01:00<00:06,  3.09s/it]
Task 8, Epoch 19/20 => Loss 1.303, Train_accy 48.10:  95%|█████████▌| 19/20 [01:00<00:02,  2.93s/it]
Task 8, Epoch 20/20 => Loss 1.551, Train_accy 46.71:  95%|█████████▌| 19/20 [01:02<00:02,  2.93s/it]
Task 8, Epoch 20/20 => Loss 1.551, Train_accy 46.71: 100%|██████████| 20/20 [01:02<00:00,  2.83s/it]
Task 8, Epoch 20/20 => Loss 1.551, Train_accy 46.71: 100%|██████████| 20/20 [01:02<00:00,  3.15s/it]
2024-09-07 09:26:53,535 [finetune.py] => Task 8, Epoch 20/20 => Loss 1.551, Train_accy 46.71
2024-09-07 09:26:56,280 [trainer.py] => No NME accuracy.
2024-09-07 09:26:56,280 [trainer.py] => CNN: {'total': 3.72, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 3.12, '80-89': 32.1, 'old': 0.43, 'new': 32.1}
2024-09-07 09:26:56,280 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72]
2024-09-07 09:26:56,280 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2]

Average Accuracy (CNN): 8.31
2024-09-07 09:26:56,280 [trainer.py] => Average Accuracy (CNN): 8.31 

2024-09-07 09:26:56,282 [trainer.py] => All params: 85867866
2024-09-07 09:26:56,283 [trainer.py] => Trainable params: 85867866
2024-09-07 09:26:56,286 [finetune.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.148, Train_accy 1.70, Test_accy 3.69:   0%|          | 0/20 [00:05<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.148, Train_accy 1.70, Test_accy 3.69:   5%|▌         | 1/20 [00:05<01:35,  5.02s/it]
Task 9, Epoch 2/20 => Loss 1.818, Train_accy 18.30:   5%|▌         | 1/20 [00:07<01:35,  5.02s/it]               
Task 9, Epoch 2/20 => Loss 1.818, Train_accy 18.30:  10%|█         | 2/20 [00:07<01:00,  3.33s/it]
Task 9, Epoch 3/20 => Loss 1.637, Train_accy 29.36:  10%|█         | 2/20 [00:09<01:00,  3.33s/it]
Task 9, Epoch 3/20 => Loss 1.637, Train_accy 29.36:  15%|█▌        | 3/20 [00:09<00:47,  2.80s/it]
Task 9, Epoch 4/20 => Loss 1.470, Train_accy 25.96:  15%|█▌        | 3/20 [00:11<00:47,  2.80s/it]
Task 9, Epoch 4/20 => Loss 1.470, Train_accy 25.96:  20%|██        | 4/20 [00:11<00:40,  2.55s/it]
Task 9, Epoch 5/20 => Loss 1.321, Train_accy 32.34:  20%|██        | 4/20 [00:13<00:40,  2.55s/it]
Task 9, Epoch 5/20 => Loss 1.321, Train_accy 32.34:  25%|██▌       | 5/20 [00:13<00:36,  2.41s/it]
Task 9, Epoch 6/20 => Loss 1.228, Train_accy 35.74, Test_accy 5.47:  25%|██▌       | 5/20 [00:18<00:36,  2.41s/it]
Task 9, Epoch 6/20 => Loss 1.228, Train_accy 35.74, Test_accy 5.47:  30%|███       | 6/20 [00:18<00:46,  3.33s/it]
Task 9, Epoch 7/20 => Loss 1.145, Train_accy 31.06:  30%|███       | 6/20 [00:20<00:46,  3.33s/it]                
Task 9, Epoch 7/20 => Loss 1.145, Train_accy 31.06:  35%|███▌      | 7/20 [00:20<00:38,  2.95s/it]
Task 9, Epoch 8/20 => Loss 1.065, Train_accy 34.04:  35%|███▌      | 7/20 [00:23<00:38,  2.95s/it]
Task 9, Epoch 8/20 => Loss 1.065, Train_accy 34.04:  40%|████      | 8/20 [00:23<00:32,  2.70s/it]
Task 9, Epoch 9/20 => Loss 0.980, Train_accy 40.43:  40%|████      | 8/20 [00:25<00:32,  2.70s/it]
Task 9, Epoch 9/20 => Loss 0.980, Train_accy 40.43:  45%|████▌     | 9/20 [00:25<00:27,  2.53s/it]
Task 9, Epoch 10/20 => Loss 0.847, Train_accy 41.28:  45%|████▌     | 9/20 [00:27<00:27,  2.53s/it]
Task 9, Epoch 10/20 => Loss 0.847, Train_accy 41.28:  50%|█████     | 10/20 [00:27<00:24,  2.42s/it]
Task 9, Epoch 11/20 => Loss 0.692, Train_accy 44.26, Test_accy 6.78:  50%|█████     | 10/20 [00:32<00:24,  2.42s/it]
Task 9, Epoch 11/20 => Loss 0.692, Train_accy 44.26, Test_accy 6.78:  55%|█████▌    | 11/20 [00:32<00:28,  3.20s/it]
Task 9, Epoch 12/20 => Loss 0.607, Train_accy 49.79:  55%|█████▌    | 11/20 [00:34<00:28,  3.20s/it]                
Task 9, Epoch 12/20 => Loss 0.607, Train_accy 49.79:  60%|██████    | 12/20 [00:34<00:23,  2.90s/it]
Task 9, Epoch 13/20 => Loss 0.555, Train_accy 57.45:  60%|██████    | 12/20 [00:36<00:23,  2.90s/it]
Task 9, Epoch 13/20 => Loss 0.555, Train_accy 57.45:  65%|██████▌   | 13/20 [00:36<00:18,  2.68s/it]
Task 9, Epoch 14/20 => Loss 0.462, Train_accy 45.11:  65%|██████▌   | 13/20 [00:38<00:18,  2.68s/it]
Task 9, Epoch 14/20 => Loss 0.462, Train_accy 45.11:  70%|███████   | 14/20 [00:38<00:15,  2.52s/it]
Task 9, Epoch 15/20 => Loss 0.466, Train_accy 56.17:  70%|███████   | 14/20 [00:41<00:15,  2.52s/it]
Task 9, Epoch 15/20 => Loss 0.466, Train_accy 56.17:  75%|███████▌  | 15/20 [00:41<00:12,  2.41s/it]
Task 9, Epoch 16/20 => Loss 0.442, Train_accy 52.34, Test_accy 6.18:  75%|███████▌  | 15/20 [00:46<00:12,  2.41s/it]
Task 9, Epoch 16/20 => Loss 0.442, Train_accy 52.34, Test_accy 6.18:  80%|████████  | 16/20 [00:46<00:12,  3.19s/it]
Task 9, Epoch 17/20 => Loss 0.326, Train_accy 60.43:  80%|████████  | 16/20 [00:48<00:12,  3.19s/it]                
Task 9, Epoch 17/20 => Loss 0.326, Train_accy 60.43:  85%|████████▌ | 17/20 [00:48<00:08,  2.87s/it]
Task 9, Epoch 18/20 => Loss 0.212, Train_accy 60.00:  85%|████████▌ | 17/20 [00:50<00:08,  2.87s/it]
Task 9, Epoch 18/20 => Loss 0.212, Train_accy 60.00:  90%|█████████ | 18/20 [00:50<00:05,  2.65s/it]
Task 9, Epoch 19/20 => Loss 0.227, Train_accy 61.70:  90%|█████████ | 18/20 [00:52<00:05,  2.65s/it]
Task 9, Epoch 19/20 => Loss 0.227, Train_accy 61.70:  95%|█████████▌| 19/20 [00:52<00:02,  2.50s/it]
Task 9, Epoch 20/20 => Loss 0.209, Train_accy 57.45:  95%|█████████▌| 19/20 [00:54<00:02,  2.50s/it]
Task 9, Epoch 20/20 => Loss 0.209, Train_accy 57.45: 100%|██████████| 20/20 [00:54<00:00,  2.39s/it]
Task 9, Epoch 20/20 => Loss 0.209, Train_accy 57.45: 100%|██████████| 20/20 [00:54<00:00,  2.73s/it]
2024-09-07 09:27:50,945 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.209, Train_accy 57.45
2024-09-07 09:27:53,776 [trainer.py] => No NME accuracy.
2024-09-07 09:27:53,777 [trainer.py] => CNN: {'total': 5.59, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 9.38, '80-89': 33.33, '90-99': 17.74, 'old': 4.62, 'new': 17.74}
2024-09-07 09:27:53,777 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59]
2024-09-07 09:27:53,777 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81]

Average Accuracy (CNN): 8.04
2024-09-07 09:27:53,777 [trainer.py] => Average Accuracy (CNN): 8.04 

2024-09-07 09:27:53,778 [trainer.py] => All params: 85875556
2024-09-07 09:27:53,779 [trainer.py] => Trainable params: 85875556
2024-09-07 09:27:53,781 [finetune.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.673, Train_accy 0.00, Test_accy 5.22:   0%|          | 0/20 [00:05<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.673, Train_accy 0.00, Test_accy 5.22:   5%|▌         | 1/20 [00:05<01:40,  5.28s/it]
Task 10, Epoch 2/20 => Loss 1.732, Train_accy 0.82:   5%|▌         | 1/20 [00:07<01:40,  5.28s/it]                
Task 10, Epoch 2/20 => Loss 1.732, Train_accy 0.82:  10%|█         | 2/20 [00:07<01:02,  3.49s/it]
Task 10, Epoch 3/20 => Loss 1.627, Train_accy 22.04:  10%|█         | 2/20 [00:09<01:02,  3.49s/it]
Task 10, Epoch 3/20 => Loss 1.627, Train_accy 22.04:  15%|█▌        | 3/20 [00:09<00:49,  2.93s/it]
Task 10, Epoch 4/20 => Loss 1.304, Train_accy 17.55:  15%|█▌        | 3/20 [00:12<00:49,  2.93s/it]
Task 10, Epoch 4/20 => Loss 1.304, Train_accy 17.55:  20%|██        | 4/20 [00:12<00:42,  2.67s/it]
Task 10, Epoch 5/20 => Loss 1.274, Train_accy 38.37:  20%|██        | 4/20 [00:14<00:42,  2.67s/it]
Task 10, Epoch 5/20 => Loss 1.274, Train_accy 38.37:  25%|██▌       | 5/20 [00:14<00:37,  2.52s/it]
Task 10, Epoch 6/20 => Loss 1.240, Train_accy 38.78, Test_accy 5.77:  25%|██▌       | 5/20 [00:19<00:37,  2.52s/it]
Task 10, Epoch 6/20 => Loss 1.240, Train_accy 38.78, Test_accy 5.77:  30%|███       | 6/20 [00:19<00:48,  3.47s/it]
Task 10, Epoch 7/20 => Loss 0.837, Train_accy 44.08:  30%|███       | 6/20 [00:21<00:48,  3.47s/it]                
Task 10, Epoch 7/20 => Loss 0.837, Train_accy 44.08:  35%|███▌      | 7/20 [00:21<00:39,  3.07s/it]
Task 10, Epoch 8/20 => Loss 0.757, Train_accy 48.16:  35%|███▌      | 7/20 [00:24<00:39,  3.07s/it]
Task 10, Epoch 8/20 => Loss 0.757, Train_accy 48.16:  40%|████      | 8/20 [00:24<00:33,  2.81s/it]
Task 10, Epoch 9/20 => Loss 0.731, Train_accy 52.65:  40%|████      | 8/20 [00:26<00:33,  2.81s/it]
Task 10, Epoch 9/20 => Loss 0.731, Train_accy 52.65:  45%|████▌     | 9/20 [00:26<00:28,  2.63s/it]
Task 10, Epoch 10/20 => Loss 0.568, Train_accy 55.51:  45%|████▌     | 9/20 [00:28<00:28,  2.63s/it]
Task 10, Epoch 10/20 => Loss 0.568, Train_accy 55.51:  50%|█████     | 10/20 [00:28<00:25,  2.54s/it]
Task 10, Epoch 11/20 => Loss 0.649, Train_accy 55.10, Test_accy 6.33:  50%|█████     | 10/20 [00:34<00:25,  2.54s/it]
Task 10, Epoch 11/20 => Loss 0.649, Train_accy 55.10, Test_accy 6.33:  55%|█████▌    | 11/20 [00:34<00:30,  3.39s/it]
Task 10, Epoch 12/20 => Loss 0.669, Train_accy 59.59:  55%|█████▌    | 11/20 [00:36<00:30,  3.39s/it]                
Task 10, Epoch 12/20 => Loss 0.669, Train_accy 59.59:  60%|██████    | 12/20 [00:36<00:24,  3.05s/it]
Task 10, Epoch 13/20 => Loss 0.535, Train_accy 65.31:  60%|██████    | 12/20 [00:38<00:24,  3.05s/it]
Task 10, Epoch 13/20 => Loss 0.535, Train_accy 65.31:  65%|██████▌   | 13/20 [00:38<00:19,  2.81s/it]
Task 10, Epoch 14/20 => Loss 0.440, Train_accy 61.63:  65%|██████▌   | 13/20 [00:40<00:19,  2.81s/it]
Task 10, Epoch 14/20 => Loss 0.440, Train_accy 61.63:  70%|███████   | 14/20 [00:40<00:15,  2.64s/it]
Task 10, Epoch 15/20 => Loss 0.383, Train_accy 73.06:  70%|███████   | 14/20 [00:43<00:15,  2.64s/it]
Task 10, Epoch 15/20 => Loss 0.383, Train_accy 73.06:  75%|███████▌  | 15/20 [00:43<00:12,  2.53s/it]
Task 10, Epoch 16/20 => Loss 0.390, Train_accy 71.43, Test_accy 6.66:  75%|███████▌  | 15/20 [00:48<00:12,  2.53s/it]
Task 10, Epoch 16/20 => Loss 0.390, Train_accy 71.43, Test_accy 6.66:  80%|████████  | 16/20 [00:48<00:13,  3.37s/it]
Task 10, Epoch 17/20 => Loss 0.357, Train_accy 75.10:  80%|████████  | 16/20 [00:50<00:13,  3.37s/it]                
Task 10, Epoch 17/20 => Loss 0.357, Train_accy 75.10:  85%|████████▌ | 17/20 [00:50<00:09,  3.04s/it]
Task 10, Epoch 18/20 => Loss 0.284, Train_accy 79.18:  85%|████████▌ | 17/20 [00:52<00:09,  3.04s/it]
Task 10, Epoch 18/20 => Loss 0.284, Train_accy 79.18:  90%|█████████ | 18/20 [00:52<00:05,  2.80s/it]
Task 10, Epoch 19/20 => Loss 0.326, Train_accy 71.84:  90%|█████████ | 18/20 [00:55<00:05,  2.80s/it]
Task 10, Epoch 19/20 => Loss 0.326, Train_accy 71.84:  95%|█████████▌| 19/20 [00:55<00:02,  2.63s/it]
Task 10, Epoch 20/20 => Loss 0.268, Train_accy 77.14:  95%|█████████▌| 19/20 [00:57<00:02,  2.63s/it]
Task 10, Epoch 20/20 => Loss 0.268, Train_accy 77.14: 100%|██████████| 20/20 [00:57<00:00,  2.52s/it]
Task 10, Epoch 20/20 => Loss 0.268, Train_accy 77.14: 100%|██████████| 20/20 [00:57<00:00,  2.87s/it]
2024-09-07 09:28:51,200 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.268, Train_accy 77.14
2024-09-07 09:28:54,254 [trainer.py] => No NME accuracy.
2024-09-07 09:28:54,254 [trainer.py] => CNN: {'total': 6.22, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.79, '70-79': 6.25, '80-89': 23.46, '90-99': 11.29, '100-109': 38.33, 'old': 3.92, 'new': 38.33}
2024-09-07 09:28:54,254 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22]
2024-09-07 09:28:54,255 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31]

Average Accuracy (CNN): 7.87
2024-09-07 09:28:54,255 [trainer.py] => Average Accuracy (CNN): 7.87 

2024-09-07 09:28:54,256 [trainer.py] => All params: 85883246
2024-09-07 09:28:54,257 [trainer.py] => Trainable params: 85883246
2024-09-07 09:28:54,259 [finetune.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.366, Train_accy 1.08, Test_accy 5.54:   0%|          | 0/20 [00:05<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.366, Train_accy 1.08, Test_accy 5.54:   5%|▌         | 1/20 [00:05<01:50,  5.81s/it]
Task 11, Epoch 2/20 => Loss 1.473, Train_accy 24.10:   5%|▌         | 1/20 [00:08<01:50,  5.81s/it]               
Task 11, Epoch 2/20 => Loss 1.473, Train_accy 24.10:  10%|█         | 2/20 [00:08<01:09,  3.87s/it]
Task 11, Epoch 3/20 => Loss 1.113, Train_accy 30.22:  10%|█         | 2/20 [00:10<01:09,  3.87s/it]
Task 11, Epoch 3/20 => Loss 1.113, Train_accy 30.22:  15%|█▌        | 3/20 [00:10<00:55,  3.24s/it]
Task 11, Epoch 4/20 => Loss 0.957, Train_accy 40.65:  15%|█▌        | 3/20 [00:13<00:55,  3.24s/it]
Task 11, Epoch 4/20 => Loss 0.957, Train_accy 40.65:  20%|██        | 4/20 [00:13<00:47,  2.95s/it]
Task 11, Epoch 5/20 => Loss 0.800, Train_accy 48.56:  20%|██        | 4/20 [00:15<00:47,  2.95s/it]
Task 11, Epoch 5/20 => Loss 0.800, Train_accy 48.56:  25%|██▌       | 5/20 [00:15<00:41,  2.78s/it]
Task 11, Epoch 6/20 => Loss 0.639, Train_accy 55.04, Test_accy 7.18:  25%|██▌       | 5/20 [00:21<00:41,  2.78s/it]
Task 11, Epoch 6/20 => Loss 0.639, Train_accy 55.04, Test_accy 7.18:  30%|███       | 6/20 [00:21<00:53,  3.82s/it]
Task 11, Epoch 7/20 => Loss 0.500, Train_accy 56.83:  30%|███       | 6/20 [00:24<00:53,  3.82s/it]                
Task 11, Epoch 7/20 => Loss 0.500, Train_accy 56.83:  35%|███▌      | 7/20 [00:24<00:44,  3.40s/it]
Task 11, Epoch 8/20 => Loss 0.401, Train_accy 63.67:  35%|███▌      | 7/20 [00:26<00:44,  3.40s/it]
Task 11, Epoch 8/20 => Loss 0.401, Train_accy 63.67:  40%|████      | 8/20 [00:26<00:37,  3.12s/it]
Task 11, Epoch 9/20 => Loss 0.322, Train_accy 67.63:  40%|████      | 8/20 [00:29<00:37,  3.12s/it]
Task 11, Epoch 9/20 => Loss 0.322, Train_accy 67.63:  45%|████▌     | 9/20 [00:29<00:32,  2.93s/it]
Task 11, Epoch 10/20 => Loss 0.359, Train_accy 66.19:  45%|████▌     | 9/20 [00:31<00:32,  2.93s/it]
Task 11, Epoch 10/20 => Loss 0.359, Train_accy 66.19:  50%|█████     | 10/20 [00:31<00:28,  2.81s/it]
Task 11, Epoch 11/20 => Loss 0.314, Train_accy 69.78, Test_accy 6.56:  50%|█████     | 10/20 [00:37<00:28,  2.81s/it]
Task 11, Epoch 11/20 => Loss 0.314, Train_accy 69.78, Test_accy 6.56:  55%|█████▌    | 11/20 [00:37<00:33,  3.70s/it]
Task 11, Epoch 12/20 => Loss 0.243, Train_accy 69.78:  55%|█████▌    | 11/20 [00:39<00:33,  3.70s/it]                
Task 11, Epoch 12/20 => Loss 0.243, Train_accy 69.78:  60%|██████    | 12/20 [00:39<00:26,  3.33s/it]
Task 11, Epoch 13/20 => Loss 0.225, Train_accy 74.46:  60%|██████    | 12/20 [00:42<00:26,  3.33s/it]
Task 11, Epoch 13/20 => Loss 0.225, Train_accy 74.46:  65%|██████▌   | 13/20 [00:42<00:21,  3.08s/it]
Task 11, Epoch 14/20 => Loss 0.272, Train_accy 70.50:  65%|██████▌   | 13/20 [00:44<00:21,  3.08s/it]
Task 11, Epoch 14/20 => Loss 0.272, Train_accy 70.50:  70%|███████   | 14/20 [00:44<00:17,  2.91s/it]
Task 11, Epoch 15/20 => Loss 0.245, Train_accy 70.86:  70%|███████   | 14/20 [00:47<00:17,  2.91s/it]
Task 11, Epoch 15/20 => Loss 0.245, Train_accy 70.86:  75%|███████▌  | 15/20 [00:47<00:13,  2.79s/it]
Task 11, Epoch 16/20 => Loss 0.224, Train_accy 76.26, Test_accy 6.67:  75%|███████▌  | 15/20 [00:53<00:13,  2.79s/it]
Task 11, Epoch 16/20 => Loss 0.224, Train_accy 76.26, Test_accy 6.67:  80%|████████  | 16/20 [00:53<00:14,  3.67s/it]
Task 11, Epoch 17/20 => Loss 0.204, Train_accy 79.86:  80%|████████  | 16/20 [00:55<00:14,  3.67s/it]                
Task 11, Epoch 17/20 => Loss 0.204, Train_accy 79.86:  85%|████████▌ | 17/20 [00:55<00:09,  3.32s/it]
Task 11, Epoch 18/20 => Loss 0.156, Train_accy 75.18:  85%|████████▌ | 17/20 [00:58<00:09,  3.32s/it]
Task 11, Epoch 18/20 => Loss 0.156, Train_accy 75.18:  90%|█████████ | 18/20 [00:58<00:06,  3.08s/it]
Task 11, Epoch 19/20 => Loss 0.180, Train_accy 75.54:  90%|█████████ | 18/20 [01:00<00:06,  3.08s/it]
Task 11, Epoch 19/20 => Loss 0.180, Train_accy 75.54:  95%|█████████▌| 19/20 [01:00<00:02,  2.92s/it]
Task 11, Epoch 20/20 => Loss 0.225, Train_accy 73.74:  95%|█████████▌| 19/20 [01:03<00:02,  2.92s/it]
Task 11, Epoch 20/20 => Loss 0.225, Train_accy 73.74: 100%|██████████| 20/20 [01:03<00:00,  2.81s/it]
Task 11, Epoch 20/20 => Loss 0.225, Train_accy 73.74: 100%|██████████| 20/20 [01:03<00:00,  3.17s/it]
2024-09-07 09:29:57,605 [finetune.py] => Task 11, Epoch 20/20 => Loss 0.225, Train_accy 73.74
2024-09-07 09:30:00,865 [trainer.py] => No NME accuracy.
2024-09-07 09:30:00,866 [trainer.py] => CNN: {'total': 6.77, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 8.33, '80-89': 12.35, '90-99': 3.23, '100-109': 23.33, '110-119': 43.24, 'old': 3.77, 'new': 43.24}
2024-09-07 09:30:00,866 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77]
2024-09-07 09:30:00,866 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15]

Average Accuracy (CNN): 7.78
2024-09-07 09:30:00,866 [trainer.py] => Average Accuracy (CNN): 7.78 

2024-09-07 09:30:00,868 [trainer.py] => All params: 85890936
2024-09-07 09:30:00,869 [trainer.py] => Trainable params: 85890936
2024-09-07 09:30:00,872 [finetune.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 3.021, Train_accy 0.00, Test_accy 6.57:   0%|          | 0/20 [00:05<?, ?it/s]
Task 12, Epoch 1/20 => Loss 3.021, Train_accy 0.00, Test_accy 6.57:   5%|▌         | 1/20 [00:05<01:46,  5.60s/it]
Task 12, Epoch 2/20 => Loss 1.934, Train_accy 1.30:   5%|▌         | 1/20 [00:07<01:46,  5.60s/it]                
Task 12, Epoch 2/20 => Loss 1.934, Train_accy 1.30:  10%|█         | 2/20 [00:07<01:03,  3.55s/it]
Task 12, Epoch 3/20 => Loss 1.446, Train_accy 8.70:  10%|█         | 2/20 [00:09<01:03,  3.55s/it]
Task 12, Epoch 3/20 => Loss 1.446, Train_accy 8.70:  15%|█▌        | 3/20 [00:09<00:49,  2.92s/it]
Task 12, Epoch 4/20 => Loss 1.210, Train_accy 11.74:  15%|█▌        | 3/20 [00:11<00:49,  2.92s/it]
Task 12, Epoch 4/20 => Loss 1.210, Train_accy 11.74:  20%|██        | 4/20 [00:11<00:41,  2.60s/it]
Task 12, Epoch 5/20 => Loss 0.962, Train_accy 28.26:  20%|██        | 4/20 [00:14<00:41,  2.60s/it]
Task 12, Epoch 5/20 => Loss 0.962, Train_accy 28.26:  25%|██▌       | 5/20 [00:14<00:36,  2.43s/it]
Task 12, Epoch 6/20 => Loss 0.791, Train_accy 41.30, Test_accy 6.76:  25%|██▌       | 5/20 [00:19<00:36,  2.43s/it]
Task 12, Epoch 6/20 => Loss 0.791, Train_accy 41.30, Test_accy 6.76:  30%|███       | 6/20 [00:19<00:48,  3.48s/it]
Task 12, Epoch 7/20 => Loss 0.589, Train_accy 48.70:  30%|███       | 6/20 [00:21<00:48,  3.48s/it]                
Task 12, Epoch 7/20 => Loss 0.589, Train_accy 48.70:  35%|███▌      | 7/20 [00:21<00:39,  3.04s/it]
Task 12, Epoch 8/20 => Loss 0.482, Train_accy 57.39:  35%|███▌      | 7/20 [00:23<00:39,  3.04s/it]
Task 12, Epoch 8/20 => Loss 0.482, Train_accy 57.39:  40%|████      | 8/20 [00:23<00:32,  2.74s/it]
Task 12, Epoch 9/20 => Loss 0.365, Train_accy 67.83:  40%|████      | 8/20 [00:26<00:32,  2.74s/it]
Task 12, Epoch 9/20 => Loss 0.365, Train_accy 67.83:  45%|████▌     | 9/20 [00:26<00:28,  2.56s/it]
Task 12, Epoch 10/20 => Loss 0.318, Train_accy 67.39:  45%|████▌     | 9/20 [00:28<00:28,  2.56s/it]
Task 12, Epoch 10/20 => Loss 0.318, Train_accy 67.39:  50%|█████     | 10/20 [00:28<00:24,  2.42s/it]
Task 12, Epoch 11/20 => Loss 0.273, Train_accy 66.09, Test_accy 6.67:  50%|█████     | 10/20 [00:33<00:24,  2.42s/it]
Task 12, Epoch 11/20 => Loss 0.273, Train_accy 66.09, Test_accy 6.67:  55%|█████▌    | 11/20 [00:33<00:30,  3.39s/it]
Task 12, Epoch 12/20 => Loss 0.203, Train_accy 73.48:  55%|█████▌    | 11/20 [00:35<00:30,  3.39s/it]                
Task 12, Epoch 12/20 => Loss 0.203, Train_accy 73.48:  60%|██████    | 12/20 [00:35<00:24,  3.00s/it]
Task 12, Epoch 13/20 => Loss 0.304, Train_accy 74.35:  60%|██████    | 12/20 [00:37<00:24,  3.00s/it]
Task 12, Epoch 13/20 => Loss 0.304, Train_accy 74.35:  65%|██████▌   | 13/20 [00:37<00:19,  2.73s/it]
Task 12, Epoch 14/20 => Loss 0.223, Train_accy 71.30:  65%|██████▌   | 13/20 [00:40<00:19,  2.73s/it]
Task 12, Epoch 14/20 => Loss 0.223, Train_accy 71.30:  70%|███████   | 14/20 [00:40<00:15,  2.55s/it]
Task 12, Epoch 15/20 => Loss 0.167, Train_accy 68.26:  70%|███████   | 14/20 [00:42<00:15,  2.55s/it]
Task 12, Epoch 15/20 => Loss 0.167, Train_accy 68.26:  75%|███████▌  | 15/20 [00:42<00:12,  2.41s/it]
Task 12, Epoch 16/20 => Loss 0.207, Train_accy 75.65, Test_accy 6.09:  75%|███████▌  | 15/20 [00:47<00:12,  2.41s/it]
Task 12, Epoch 16/20 => Loss 0.207, Train_accy 75.65, Test_accy 6.09:  80%|████████  | 16/20 [00:47<00:13,  3.35s/it]
Task 12, Epoch 17/20 => Loss 0.206, Train_accy 79.13:  80%|████████  | 16/20 [00:49<00:13,  3.35s/it]                
Task 12, Epoch 17/20 => Loss 0.206, Train_accy 79.13:  85%|████████▌ | 17/20 [00:49<00:08,  2.99s/it]
Task 12, Epoch 18/20 => Loss 0.271, Train_accy 74.78:  85%|████████▌ | 17/20 [00:51<00:08,  2.99s/it]
Task 12, Epoch 18/20 => Loss 0.271, Train_accy 74.78:  90%|█████████ | 18/20 [00:51<00:05,  2.72s/it]
Task 12, Epoch 19/20 => Loss 0.134, Train_accy 78.26:  90%|█████████ | 18/20 [00:54<00:05,  2.72s/it]
Task 12, Epoch 19/20 => Loss 0.134, Train_accy 78.26:  95%|█████████▌| 19/20 [00:54<00:02,  2.54s/it]
Task 12, Epoch 20/20 => Loss 0.176, Train_accy 76.96:  95%|█████████▌| 19/20 [00:56<00:02,  2.54s/it]
Task 12, Epoch 20/20 => Loss 0.176, Train_accy 76.96: 100%|██████████| 20/20 [00:56<00:00,  2.41s/it]
Task 12, Epoch 20/20 => Loss 0.176, Train_accy 76.96: 100%|██████████| 20/20 [00:56<00:00,  2.81s/it]
2024-09-07 09:30:57,056 [finetune.py] => Task 12, Epoch 20/20 => Loss 0.176, Train_accy 76.96
2024-09-07 09:31:00,458 [trainer.py] => No NME accuracy.
2024-09-07 09:31:00,459 [trainer.py] => CNN: {'total': 6.38, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 4.17, '80-89': 3.7, '90-99': 8.06, '100-109': 15.0, '110-119': 43.24, '120-129': 21.67, 'old': 5.44, 'new': 21.67}
2024-09-07 09:31:00,459 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38]
2024-09-07 09:31:00,460 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55]

Average Accuracy (CNN): 7.67
2024-09-07 09:31:00,460 [trainer.py] => Average Accuracy (CNN): 7.67 

2024-09-07 09:31:00,461 [trainer.py] => All params: 85898626
2024-09-07 09:31:00,463 [trainer.py] => Trainable params: 85898626
2024-09-07 09:31:00,466 [finetune.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.611, Train_accy 0.00, Test_accy 5.71:   0%|          | 0/20 [00:06<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.611, Train_accy 0.00, Test_accy 5.71:   5%|▌         | 1/20 [00:06<02:02,  6.45s/it]
Task 13, Epoch 2/20 => Loss 1.388, Train_accy 2.27:   5%|▌         | 1/20 [00:09<02:02,  6.45s/it]                
Task 13, Epoch 2/20 => Loss 1.388, Train_accy 2.27:  10%|█         | 2/20 [00:09<01:17,  4.31s/it]
Task 13, Epoch 3/20 => Loss 1.010, Train_accy 11.00:  10%|█         | 2/20 [00:12<01:17,  4.31s/it]
Task 13, Epoch 3/20 => Loss 1.010, Train_accy 11.00:  15%|█▌        | 3/20 [00:12<01:01,  3.60s/it]
Task 13, Epoch 4/20 => Loss 0.859, Train_accy 28.16:  15%|█▌        | 3/20 [00:14<01:01,  3.60s/it]
Task 13, Epoch 4/20 => Loss 0.859, Train_accy 28.16:  20%|██        | 4/20 [00:14<00:52,  3.27s/it]
Task 13, Epoch 5/20 => Loss 0.601, Train_accy 35.92:  20%|██        | 4/20 [00:17<00:52,  3.27s/it]
Task 13, Epoch 5/20 => Loss 0.601, Train_accy 35.92:  25%|██▌       | 5/20 [00:17<00:46,  3.08s/it]
Task 13, Epoch 6/20 => Loss 0.420, Train_accy 54.69, Test_accy 7.31:  25%|██▌       | 5/20 [00:23<00:46,  3.08s/it]
Task 13, Epoch 6/20 => Loss 0.420, Train_accy 54.69, Test_accy 7.31:  30%|███       | 6/20 [00:23<00:59,  4.22s/it]
Task 13, Epoch 7/20 => Loss 0.389, Train_accy 56.96:  30%|███       | 6/20 [00:26<00:59,  4.22s/it]                
Task 13, Epoch 7/20 => Loss 0.389, Train_accy 56.96:  35%|███▌      | 7/20 [00:26<00:48,  3.76s/it]
Task 13, Epoch 8/20 => Loss 0.297, Train_accy 62.78:  35%|███▌      | 7/20 [00:29<00:48,  3.76s/it]
Task 13, Epoch 8/20 => Loss 0.297, Train_accy 62.78:  40%|████      | 8/20 [00:29<00:41,  3.46s/it]
Task 13, Epoch 9/20 => Loss 0.260, Train_accy 65.70:  40%|████      | 8/20 [00:32<00:41,  3.46s/it]
Task 13, Epoch 9/20 => Loss 0.260, Train_accy 65.70:  45%|████▌     | 9/20 [00:32<00:35,  3.24s/it]
Task 13, Epoch 10/20 => Loss 0.262, Train_accy 70.55:  45%|████▌     | 9/20 [00:35<00:35,  3.24s/it]
Task 13, Epoch 10/20 => Loss 0.262, Train_accy 70.55:  50%|█████     | 10/20 [00:35<00:30,  3.09s/it]
Task 13, Epoch 11/20 => Loss 0.296, Train_accy 69.58, Test_accy 7.58:  50%|█████     | 10/20 [00:41<00:30,  3.09s/it]
Task 13, Epoch 11/20 => Loss 0.296, Train_accy 69.58, Test_accy 7.58:  55%|█████▌    | 11/20 [00:41<00:37,  4.14s/it]
Task 13, Epoch 12/20 => Loss 0.267, Train_accy 69.90:  55%|█████▌    | 11/20 [00:44<00:37,  4.14s/it]                
Task 13, Epoch 12/20 => Loss 0.267, Train_accy 69.90:  60%|██████    | 12/20 [00:44<00:29,  3.74s/it]
Task 13, Epoch 13/20 => Loss 0.207, Train_accy 77.35:  60%|██████    | 12/20 [00:47<00:29,  3.74s/it]
Task 13, Epoch 13/20 => Loss 0.207, Train_accy 77.35:  65%|██████▌   | 13/20 [00:47<00:24,  3.44s/it]
Task 13, Epoch 14/20 => Loss 0.217, Train_accy 75.73:  65%|██████▌   | 13/20 [00:49<00:24,  3.44s/it]
Task 13, Epoch 14/20 => Loss 0.217, Train_accy 75.73:  70%|███████   | 14/20 [00:49<00:19,  3.23s/it]
Task 13, Epoch 15/20 => Loss 0.202, Train_accy 75.08:  70%|███████   | 14/20 [00:52<00:19,  3.23s/it]
Task 13, Epoch 15/20 => Loss 0.202, Train_accy 75.08:  75%|███████▌  | 15/20 [00:52<00:15,  3.08s/it]
Task 13, Epoch 16/20 => Loss 0.177, Train_accy 77.02, Test_accy 7.49:  75%|███████▌  | 15/20 [00:59<00:15,  3.08s/it]
Task 13, Epoch 16/20 => Loss 0.177, Train_accy 77.02, Test_accy 7.49:  80%|████████  | 16/20 [00:59<00:16,  4.08s/it]
Task 13, Epoch 17/20 => Loss 0.150, Train_accy 79.61:  80%|████████  | 16/20 [01:01<00:16,  4.08s/it]                
Task 13, Epoch 17/20 => Loss 0.150, Train_accy 79.61:  85%|████████▌ | 17/20 [01:01<00:11,  3.68s/it]
Task 13, Epoch 18/20 => Loss 0.199, Train_accy 74.76:  85%|████████▌ | 17/20 [01:04<00:11,  3.68s/it]
Task 13, Epoch 18/20 => Loss 0.199, Train_accy 74.76:  90%|█████████ | 18/20 [01:04<00:06,  3.39s/it]
Task 13, Epoch 19/20 => Loss 0.189, Train_accy 76.38:  90%|█████████ | 18/20 [01:07<00:06,  3.39s/it]
Task 13, Epoch 19/20 => Loss 0.189, Train_accy 76.38:  95%|█████████▌| 19/20 [01:07<00:03,  3.19s/it]
Task 13, Epoch 20/20 => Loss 0.227, Train_accy 77.35:  95%|█████████▌| 19/20 [01:09<00:03,  3.19s/it]
Task 13, Epoch 20/20 => Loss 0.227, Train_accy 77.35: 100%|██████████| 20/20 [01:09<00:00,  3.05s/it]
Task 13, Epoch 20/20 => Loss 0.227, Train_accy 77.35: 100%|██████████| 20/20 [01:09<00:00,  3.50s/it]
2024-09-07 09:32:10,462 [finetune.py] => Task 13, Epoch 20/20 => Loss 0.227, Train_accy 77.35
2024-09-07 09:32:14,132 [trainer.py] => No NME accuracy.
2024-09-07 09:32:14,133 [trainer.py] => CNN: {'total': 7.67, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 2.08, '80-89': 4.94, '90-99': 1.61, '100-109': 10.0, '110-119': 39.19, '120-129': 13.33, '130-139': 41.86, 'old': 4.83, 'new': 41.86}
2024-09-07 09:32:14,133 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38, 7.67]
2024-09-07 09:32:14,133 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55, 18.38]

Average Accuracy (CNN): 7.67
2024-09-07 09:32:14,133 [trainer.py] => Average Accuracy (CNN): 7.67 

2024-09-07 09:32:14,135 [trainer.py] => All params: 85906316
2024-09-07 09:32:14,136 [trainer.py] => Trainable params: 85906316
2024-09-07 09:32:14,140 [finetune.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.402, Train_accy 0.00, Test_accy 6.77:   0%|          | 0/20 [00:06<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.402, Train_accy 0.00, Test_accy 6.77:   5%|▌         | 1/20 [00:06<02:08,  6.75s/it]
Task 14, Epoch 2/20 => Loss 1.388, Train_accy 7.01:   5%|▌         | 1/20 [00:09<02:08,  6.75s/it]                
Task 14, Epoch 2/20 => Loss 1.388, Train_accy 7.01:  10%|█         | 2/20 [00:09<01:20,  4.47s/it]
Task 14, Epoch 3/20 => Loss 0.914, Train_accy 19.82:  10%|█         | 2/20 [00:12<01:20,  4.47s/it]
Task 14, Epoch 3/20 => Loss 0.914, Train_accy 19.82:  15%|█▌        | 3/20 [00:12<01:03,  3.75s/it]
Task 14, Epoch 4/20 => Loss 0.674, Train_accy 32.32:  15%|█▌        | 3/20 [00:15<01:03,  3.75s/it]
Task 14, Epoch 4/20 => Loss 0.674, Train_accy 32.32:  20%|██        | 4/20 [00:15<00:54,  3.40s/it]
Task 14, Epoch 5/20 => Loss 0.500, Train_accy 43.90:  20%|██        | 4/20 [00:18<00:54,  3.40s/it]
Task 14, Epoch 5/20 => Loss 0.500, Train_accy 43.90:  25%|██▌       | 5/20 [00:18<00:48,  3.25s/it]
Task 14, Epoch 6/20 => Loss 0.360, Train_accy 50.00, Test_accy 7.94:  25%|██▌       | 5/20 [00:25<00:48,  3.25s/it]
Task 14, Epoch 6/20 => Loss 0.360, Train_accy 50.00, Test_accy 7.94:  30%|███       | 6/20 [00:25<01:02,  4.45s/it]
Task 14, Epoch 7/20 => Loss 0.363, Train_accy 54.88:  30%|███       | 6/20 [00:28<01:02,  4.45s/it]                
Task 14, Epoch 7/20 => Loss 0.363, Train_accy 54.88:  35%|███▌      | 7/20 [00:28<00:51,  3.94s/it]
Task 14, Epoch 8/20 => Loss 0.246, Train_accy 57.01:  35%|███▌      | 7/20 [00:30<00:51,  3.94s/it]
Task 14, Epoch 8/20 => Loss 0.246, Train_accy 57.01:  40%|████      | 8/20 [00:30<00:43,  3.61s/it]
Task 14, Epoch 9/20 => Loss 0.225, Train_accy 59.45:  40%|████      | 8/20 [00:33<00:43,  3.61s/it]
Task 14, Epoch 9/20 => Loss 0.225, Train_accy 59.45:  45%|████▌     | 9/20 [00:33<00:37,  3.39s/it]
Task 14, Epoch 10/20 => Loss 0.201, Train_accy 62.80:  45%|████▌     | 9/20 [00:36<00:37,  3.39s/it]
Task 14, Epoch 10/20 => Loss 0.201, Train_accy 62.80:  50%|█████     | 10/20 [00:36<00:32,  3.23s/it]
Task 14, Epoch 11/20 => Loss 0.267, Train_accy 58.23, Test_accy 7.69:  50%|█████     | 10/20 [00:43<00:32,  3.23s/it]
Task 14, Epoch 11/20 => Loss 0.267, Train_accy 58.23, Test_accy 7.69:  55%|█████▌    | 11/20 [00:43<00:38,  4.31s/it]
Task 14, Epoch 12/20 => Loss 0.190, Train_accy 62.20:  55%|█████▌    | 11/20 [00:46<00:38,  4.31s/it]                
Task 14, Epoch 12/20 => Loss 0.190, Train_accy 62.20:  60%|██████    | 12/20 [00:46<00:31,  3.88s/it]
Task 14, Epoch 13/20 => Loss 0.183, Train_accy 63.11:  60%|██████    | 12/20 [00:49<00:31,  3.88s/it]
Task 14, Epoch 13/20 => Loss 0.183, Train_accy 63.11:  65%|██████▌   | 13/20 [00:49<00:25,  3.58s/it]
Task 14, Epoch 14/20 => Loss 0.159, Train_accy 61.89:  65%|██████▌   | 13/20 [00:52<00:25,  3.58s/it]
Task 14, Epoch 14/20 => Loss 0.159, Train_accy 61.89:  70%|███████   | 14/20 [00:52<00:20,  3.36s/it]
Task 14, Epoch 15/20 => Loss 0.150, Train_accy 65.85:  70%|███████   | 14/20 [00:55<00:20,  3.36s/it]
Task 14, Epoch 15/20 => Loss 0.150, Train_accy 65.85:  75%|███████▌  | 15/20 [00:55<00:16,  3.22s/it]
Task 14, Epoch 16/20 => Loss 0.193, Train_accy 70.12, Test_accy 7.94:  75%|███████▌  | 15/20 [01:01<00:16,  3.22s/it]
Task 14, Epoch 16/20 => Loss 0.193, Train_accy 70.12, Test_accy 7.94:  80%|████████  | 16/20 [01:01<00:17,  4.28s/it]
Task 14, Epoch 17/20 => Loss 0.124, Train_accy 69.21:  80%|████████  | 16/20 [01:04<00:17,  4.28s/it]                
Task 14, Epoch 17/20 => Loss 0.124, Train_accy 69.21:  85%|████████▌ | 17/20 [01:04<00:11,  3.86s/it]
Task 14, Epoch 18/20 => Loss 0.123, Train_accy 72.26:  85%|████████▌ | 17/20 [01:07<00:11,  3.86s/it]
Task 14, Epoch 18/20 => Loss 0.123, Train_accy 72.26:  90%|█████████ | 18/20 [01:07<00:07,  3.56s/it]
Task 14, Epoch 19/20 => Loss 0.167, Train_accy 69.21:  90%|█████████ | 18/20 [01:10<00:07,  3.56s/it]
Task 14, Epoch 19/20 => Loss 0.167, Train_accy 69.21:  95%|█████████▌| 19/20 [01:10<00:03,  3.35s/it]
Task 14, Epoch 20/20 => Loss 0.119, Train_accy 70.73:  95%|█████████▌| 19/20 [01:13<00:03,  3.35s/it]
Task 14, Epoch 20/20 => Loss 0.119, Train_accy 70.73: 100%|██████████| 20/20 [01:13<00:00,  3.23s/it]
Task 14, Epoch 20/20 => Loss 0.119, Train_accy 70.73: 100%|██████████| 20/20 [01:13<00:00,  3.67s/it]
2024-09-07 09:33:27,458 [finetune.py] => Task 14, Epoch 20/20 => Loss 0.119, Train_accy 70.73
2024-09-07 09:33:31,396 [trainer.py] => No NME accuracy.
2024-09-07 09:33:31,396 [trainer.py] => CNN: {'total': 8.52, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 5.21, '80-89': 6.17, '90-99': 1.61, '100-109': 10.0, '110-119': 32.43, '120-129': 13.33, '130-139': 38.37, '140-149': 26.32, 'old': 7.31, 'new': 26.32}
2024-09-07 09:33:31,396 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38, 7.67, 8.52]
2024-09-07 09:33:31,396 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55, 18.38, 19.3]

Average Accuracy (CNN): 7.73
2024-09-07 09:33:31,397 [trainer.py] => Average Accuracy (CNN): 7.73 

2024-09-07 09:33:31,398 [trainer.py] => All params: 85914006
2024-09-07 09:33:31,399 [trainer.py] => Trainable params: 85914006
2024-09-07 09:33:31,404 [finetune.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 3.366, Train_accy 0.49, Test_accy 5.37:   0%|          | 0/20 [00:05<?, ?it/s]
Task 15, Epoch 1/20 => Loss 3.366, Train_accy 0.49, Test_accy 5.37:   5%|▌         | 1/20 [00:05<01:52,  5.94s/it]
Task 15, Epoch 2/20 => Loss 1.511, Train_accy 8.37:   5%|▌         | 1/20 [00:07<01:52,  5.94s/it]                
Task 15, Epoch 2/20 => Loss 1.511, Train_accy 8.37:  10%|█         | 2/20 [00:07<01:04,  3.58s/it]
Task 15, Epoch 3/20 => Loss 1.193, Train_accy 27.59:  10%|█         | 2/20 [00:09<01:04,  3.58s/it]
Task 15, Epoch 3/20 => Loss 1.193, Train_accy 27.59:  15%|█▌        | 3/20 [00:09<00:47,  2.81s/it]
Task 15, Epoch 4/20 => Loss 0.927, Train_accy 46.80:  15%|█▌        | 3/20 [00:11<00:47,  2.81s/it]
Task 15, Epoch 4/20 => Loss 0.927, Train_accy 46.80:  20%|██        | 4/20 [00:11<00:39,  2.46s/it]
Task 15, Epoch 5/20 => Loss 0.657, Train_accy 54.19:  20%|██        | 4/20 [00:13<00:39,  2.46s/it]
Task 15, Epoch 5/20 => Loss 0.657, Train_accy 54.19:  25%|██▌       | 5/20 [00:13<00:33,  2.26s/it]
Task 15, Epoch 6/20 => Loss 0.602, Train_accy 58.62, Test_accy 5.93:  25%|██▌       | 5/20 [00:19<00:33,  2.26s/it]
Task 15, Epoch 6/20 => Loss 0.602, Train_accy 58.62, Test_accy 5.93:  30%|███       | 6/20 [00:19<00:49,  3.53s/it]
Task 15, Epoch 7/20 => Loss 0.351, Train_accy 72.91:  30%|███       | 6/20 [00:21<00:49,  3.53s/it]                
Task 15, Epoch 7/20 => Loss 0.351, Train_accy 72.91:  35%|███▌      | 7/20 [00:21<00:39,  3.01s/it]
Task 15, Epoch 8/20 => Loss 0.295, Train_accy 76.85:  35%|███▌      | 7/20 [00:23<00:39,  3.01s/it]
Task 15, Epoch 8/20 => Loss 0.295, Train_accy 76.85:  40%|████      | 8/20 [00:23<00:31,  2.66s/it]
Task 15, Epoch 9/20 => Loss 0.222, Train_accy 80.30:  40%|████      | 8/20 [00:25<00:31,  2.66s/it]
Task 15, Epoch 9/20 => Loss 0.222, Train_accy 80.30:  45%|████▌     | 9/20 [00:25<00:26,  2.43s/it]
Task 15, Epoch 10/20 => Loss 0.237, Train_accy 79.31:  45%|████▌     | 9/20 [00:27<00:26,  2.43s/it]
Task 15, Epoch 10/20 => Loss 0.237, Train_accy 79.31:  50%|█████     | 10/20 [00:27<00:22,  2.27s/it]
Task 15, Epoch 11/20 => Loss 0.137, Train_accy 86.21, Test_accy 5.93:  50%|█████     | 10/20 [00:33<00:22,  2.27s/it]
Task 15, Epoch 11/20 => Loss 0.137, Train_accy 86.21, Test_accy 5.93:  55%|█████▌    | 11/20 [00:33<00:30,  3.39s/it]
Task 15, Epoch 12/20 => Loss 0.229, Train_accy 83.74:  55%|█████▌    | 11/20 [00:35<00:30,  3.39s/it]                
Task 15, Epoch 12/20 => Loss 0.229, Train_accy 83.74:  60%|██████    | 12/20 [00:35<00:23,  2.94s/it]
Task 15, Epoch 13/20 => Loss 0.172, Train_accy 87.68:  60%|██████    | 12/20 [00:37<00:23,  2.94s/it]
Task 15, Epoch 13/20 => Loss 0.172, Train_accy 87.68:  65%|██████▌   | 13/20 [00:37<00:18,  2.63s/it]
Task 15, Epoch 14/20 => Loss 0.220, Train_accy 83.25:  65%|██████▌   | 13/20 [00:38<00:18,  2.63s/it]
Task 15, Epoch 14/20 => Loss 0.220, Train_accy 83.25:  70%|███████   | 14/20 [00:38<00:14,  2.43s/it]
Task 15, Epoch 15/20 => Loss 0.164, Train_accy 90.15:  70%|███████   | 14/20 [00:40<00:14,  2.43s/it]
Task 15, Epoch 15/20 => Loss 0.164, Train_accy 90.15:  75%|███████▌  | 15/20 [00:40<00:11,  2.27s/it]
Task 15, Epoch 16/20 => Loss 0.223, Train_accy 83.25, Test_accy 5.69:  75%|███████▌  | 15/20 [00:46<00:11,  2.27s/it]
Task 15, Epoch 16/20 => Loss 0.223, Train_accy 83.25, Test_accy 5.69:  80%|████████  | 16/20 [00:46<00:13,  3.41s/it]
Task 15, Epoch 17/20 => Loss 0.121, Train_accy 85.71:  80%|████████  | 16/20 [00:48<00:13,  3.41s/it]                
Task 15, Epoch 17/20 => Loss 0.121, Train_accy 85.71:  85%|████████▌ | 17/20 [00:48<00:08,  2.96s/it]
Task 15, Epoch 18/20 => Loss 0.111, Train_accy 91.13:  85%|████████▌ | 17/20 [00:50<00:08,  2.96s/it]
Task 15, Epoch 18/20 => Loss 0.111, Train_accy 91.13:  90%|█████████ | 18/20 [00:50<00:05,  2.65s/it]
Task 15, Epoch 19/20 => Loss 0.071, Train_accy 91.63:  90%|█████████ | 18/20 [00:52<00:05,  2.65s/it]
Task 15, Epoch 19/20 => Loss 0.071, Train_accy 91.63:  95%|█████████▌| 19/20 [00:52<00:02,  2.43s/it]
Task 15, Epoch 20/20 => Loss 0.091, Train_accy 91.63:  95%|█████████▌| 19/20 [00:54<00:02,  2.43s/it]
Task 15, Epoch 20/20 => Loss 0.091, Train_accy 91.63: 100%|██████████| 20/20 [00:54<00:00,  2.28s/it]
Task 15, Epoch 20/20 => Loss 0.091, Train_accy 91.63: 100%|██████████| 20/20 [00:54<00:00,  2.73s/it]
2024-09-07 09:34:26,073 [finetune.py] => Task 15, Epoch 20/20 => Loss 0.091, Train_accy 91.63
2024-09-07 09:34:30,135 [trainer.py] => No NME accuracy.
2024-09-07 09:34:30,136 [trainer.py] => CNN: {'total': 5.77, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 4.17, '80-89': 6.17, '90-99': 3.23, '100-109': 11.67, '110-119': 14.86, '120-129': 3.33, '130-139': 17.44, '140-149': 13.16, '150-159': 31.37, 'old': 4.68, 'new': 31.37}
2024-09-07 09:34:30,136 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38, 7.67, 8.52, 5.77]
2024-09-07 09:34:30,136 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55, 18.38, 19.3, 16.59]

Average Accuracy (CNN): 7.61
2024-09-07 09:34:30,136 [trainer.py] => Average Accuracy (CNN): 7.61 

2024-09-07 09:34:30,138 [trainer.py] => All params: 85921696
2024-09-07 09:34:30,139 [trainer.py] => Trainable params: 85921696
2024-09-07 09:34:30,142 [finetune.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.707, Train_accy 0.00, Test_accy 6.08:   0%|          | 0/20 [00:07<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.707, Train_accy 0.00, Test_accy 6.08:   5%|▌         | 1/20 [00:07<02:16,  7.21s/it]
Task 16, Epoch 2/20 => Loss 1.495, Train_accy 6.29:   5%|▌         | 1/20 [00:10<02:16,  7.21s/it]                
Task 16, Epoch 2/20 => Loss 1.495, Train_accy 6.29:  10%|█         | 2/20 [00:10<01:24,  4.69s/it]
Task 16, Epoch 3/20 => Loss 1.093, Train_accy 21.86:  10%|█         | 2/20 [00:13<01:24,  4.69s/it]
Task 16, Epoch 3/20 => Loss 1.093, Train_accy 21.86:  15%|█▌        | 3/20 [00:13<01:05,  3.87s/it]
Task 16, Epoch 4/20 => Loss 0.810, Train_accy 32.93:  15%|█▌        | 3/20 [00:15<01:05,  3.87s/it]
Task 16, Epoch 4/20 => Loss 0.810, Train_accy 32.93:  20%|██        | 4/20 [00:15<00:55,  3.50s/it]
Task 16, Epoch 5/20 => Loss 0.643, Train_accy 46.71:  20%|██        | 4/20 [00:18<00:55,  3.50s/it]
Task 16, Epoch 5/20 => Loss 0.643, Train_accy 46.71:  25%|██▌       | 5/20 [00:18<00:49,  3.28s/it]
Task 16, Epoch 6/20 => Loss 0.504, Train_accy 52.99, Test_accy 6.83:  25%|██▌       | 5/20 [00:26<00:49,  3.28s/it]
Task 16, Epoch 6/20 => Loss 0.504, Train_accy 52.99, Test_accy 6.83:  30%|███       | 6/20 [00:26<01:04,  4.63s/it]
Task 16, Epoch 7/20 => Loss 0.409, Train_accy 57.49:  30%|███       | 6/20 [00:29<01:04,  4.63s/it]                
Task 16, Epoch 7/20 => Loss 0.409, Train_accy 57.49:  35%|███▌      | 7/20 [00:29<00:53,  4.08s/it]
Task 16, Epoch 8/20 => Loss 0.318, Train_accy 65.27:  35%|███▌      | 7/20 [00:32<00:53,  4.08s/it]
Task 16, Epoch 8/20 => Loss 0.318, Train_accy 65.27:  40%|████      | 8/20 [00:32<00:44,  3.72s/it]
Task 16, Epoch 9/20 => Loss 0.372, Train_accy 66.17:  40%|████      | 8/20 [00:34<00:44,  3.72s/it]
Task 16, Epoch 9/20 => Loss 0.372, Train_accy 66.17:  45%|████▌     | 9/20 [00:34<00:38,  3.47s/it]
Task 16, Epoch 10/20 => Loss 0.248, Train_accy 68.56:  45%|████▌     | 9/20 [00:37<00:38,  3.47s/it]
Task 16, Epoch 10/20 => Loss 0.248, Train_accy 68.56:  50%|█████     | 10/20 [00:37<00:33,  3.31s/it]
Task 16, Epoch 11/20 => Loss 0.209, Train_accy 67.07, Test_accy 6.38:  50%|█████     | 10/20 [00:45<00:33,  3.31s/it]
Task 16, Epoch 11/20 => Loss 0.209, Train_accy 67.07, Test_accy 6.38:  55%|█████▌    | 11/20 [00:45<00:40,  4.51s/it]
Task 16, Epoch 12/20 => Loss 0.192, Train_accy 70.96:  55%|█████▌    | 11/20 [00:48<00:40,  4.51s/it]                
Task 16, Epoch 12/20 => Loss 0.192, Train_accy 70.96:  60%|██████    | 12/20 [00:48<00:32,  4.04s/it]
Task 16, Epoch 13/20 => Loss 0.222, Train_accy 70.96:  60%|██████    | 12/20 [00:50<00:32,  4.04s/it]
Task 16, Epoch 13/20 => Loss 0.222, Train_accy 70.96:  65%|██████▌   | 13/20 [00:50<00:25,  3.70s/it]
Task 16, Epoch 14/20 => Loss 0.247, Train_accy 71.56:  65%|██████▌   | 13/20 [00:53<00:25,  3.70s/it]
Task 16, Epoch 14/20 => Loss 0.247, Train_accy 71.56:  70%|███████   | 14/20 [00:53<00:20,  3.46s/it]
Task 16, Epoch 15/20 => Loss 0.216, Train_accy 68.26:  70%|███████   | 14/20 [00:56<00:20,  3.46s/it]
Task 16, Epoch 15/20 => Loss 0.216, Train_accy 68.26:  75%|███████▌  | 15/20 [00:56<00:16,  3.30s/it]
Task 16, Epoch 16/20 => Loss 0.202, Train_accy 72.16, Test_accy 6.90:  75%|███████▌  | 15/20 [01:04<00:16,  3.30s/it]
Task 16, Epoch 16/20 => Loss 0.202, Train_accy 72.16, Test_accy 6.90:  80%|████████  | 16/20 [01:04<00:17,  4.48s/it]
Task 16, Epoch 17/20 => Loss 0.152, Train_accy 77.54:  80%|████████  | 16/20 [01:06<00:17,  4.48s/it]                
Task 16, Epoch 17/20 => Loss 0.152, Train_accy 77.54:  85%|████████▌ | 17/20 [01:06<00:12,  4.02s/it]
Task 16, Epoch 18/20 => Loss 0.201, Train_accy 75.75:  85%|████████▌ | 17/20 [01:09<00:12,  4.02s/it]
Task 16, Epoch 18/20 => Loss 0.201, Train_accy 75.75:  90%|█████████ | 18/20 [01:09<00:07,  3.70s/it]
Task 16, Epoch 19/20 => Loss 0.152, Train_accy 79.04:  90%|█████████ | 18/20 [01:12<00:07,  3.70s/it]
Task 16, Epoch 19/20 => Loss 0.152, Train_accy 79.04:  95%|█████████▌| 19/20 [01:12<00:03,  3.47s/it]
Task 16, Epoch 20/20 => Loss 0.148, Train_accy 76.65:  95%|█████████▌| 19/20 [01:15<00:03,  3.47s/it]
Task 16, Epoch 20/20 => Loss 0.148, Train_accy 76.65: 100%|██████████| 20/20 [01:15<00:00,  3.32s/it]
Task 16, Epoch 20/20 => Loss 0.148, Train_accy 76.65: 100%|██████████| 20/20 [01:15<00:00,  3.79s/it]
2024-09-07 09:35:46,020 [finetune.py] => Task 16, Epoch 20/20 => Loss 0.148, Train_accy 76.65
2024-09-07 09:35:50,334 [trainer.py] => No NME accuracy.
2024-09-07 09:35:50,334 [trainer.py] => CNN: {'total': 6.38, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 2.08, '80-89': 3.7, '90-99': 3.23, '100-109': 6.67, '110-119': 16.22, '120-129': 0.0, '130-139': 16.28, '140-149': 11.84, '150-159': 33.33, '160-169': 25.88, 'old': 5.05, 'new': 25.88}
2024-09-07 09:35:50,334 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38, 7.67, 8.52, 5.77, 6.38]
2024-09-07 09:35:50,335 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55, 18.38, 19.3, 16.59, 18.6]

Average Accuracy (CNN): 7.54
2024-09-07 09:35:50,335 [trainer.py] => Average Accuracy (CNN): 7.54 

2024-09-07 09:35:50,336 [trainer.py] => All params: 85929386
2024-09-07 09:35:50,337 [trainer.py] => Trainable params: 85929386
2024-09-07 09:35:50,340 [finetune.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.902, Train_accy 0.00, Test_accy 6.81:   0%|          | 0/20 [00:06<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.902, Train_accy 0.00, Test_accy 6.81:   5%|▌         | 1/20 [00:06<02:07,  6.72s/it]
Task 17, Epoch 2/20 => Loss 1.624, Train_accy 7.59:   5%|▌         | 1/20 [00:08<02:07,  6.72s/it]                
Task 17, Epoch 2/20 => Loss 1.624, Train_accy 7.59:  10%|█         | 2/20 [00:08<01:12,  4.03s/it]
Task 17, Epoch 3/20 => Loss 1.120, Train_accy 17.30:  10%|█         | 2/20 [00:11<01:12,  4.03s/it]
Task 17, Epoch 3/20 => Loss 1.120, Train_accy 17.30:  15%|█▌        | 3/20 [00:11<00:54,  3.18s/it]
Task 17, Epoch 4/20 => Loss 0.781, Train_accy 37.97:  15%|█▌        | 3/20 [00:13<00:54,  3.18s/it]
Task 17, Epoch 4/20 => Loss 0.781, Train_accy 37.97:  20%|██        | 4/20 [00:13<00:44,  2.77s/it]
Task 17, Epoch 5/20 => Loss 0.582, Train_accy 50.63:  20%|██        | 4/20 [00:15<00:44,  2.77s/it]
Task 17, Epoch 5/20 => Loss 0.582, Train_accy 50.63:  25%|██▌       | 5/20 [00:15<00:38,  2.55s/it]
Task 17, Epoch 6/20 => Loss 0.388, Train_accy 59.49, Test_accy 6.38:  25%|██▌       | 5/20 [00:21<00:38,  2.55s/it]
Task 17, Epoch 6/20 => Loss 0.388, Train_accy 59.49, Test_accy 6.38:  30%|███       | 6/20 [00:21<00:54,  3.92s/it]
Task 17, Epoch 7/20 => Loss 0.285, Train_accy 64.14:  30%|███       | 6/20 [00:24<00:54,  3.92s/it]                
Task 17, Epoch 7/20 => Loss 0.285, Train_accy 64.14:  35%|███▌      | 7/20 [00:24<00:43,  3.35s/it]
Task 17, Epoch 8/20 => Loss 0.304, Train_accy 70.89:  35%|███▌      | 7/20 [00:26<00:43,  3.35s/it]
Task 17, Epoch 8/20 => Loss 0.304, Train_accy 70.89:  40%|████      | 8/20 [00:26<00:35,  2.98s/it]
Task 17, Epoch 9/20 => Loss 0.275, Train_accy 73.00:  40%|████      | 8/20 [00:28<00:35,  2.98s/it]
Task 17, Epoch 9/20 => Loss 0.275, Train_accy 73.00:  45%|████▌     | 9/20 [00:28<00:29,  2.72s/it]
Task 17, Epoch 10/20 => Loss 0.224, Train_accy 73.00:  45%|████▌     | 9/20 [00:30<00:29,  2.72s/it]
Task 17, Epoch 10/20 => Loss 0.224, Train_accy 73.00:  50%|█████     | 10/20 [00:30<00:25,  2.55s/it]
Task 17, Epoch 11/20 => Loss 0.225, Train_accy 75.95, Test_accy 6.45:  50%|█████     | 10/20 [00:37<00:25,  2.55s/it]
Task 17, Epoch 11/20 => Loss 0.225, Train_accy 75.95, Test_accy 6.45:  55%|█████▌    | 11/20 [00:37<00:34,  3.80s/it]
Task 17, Epoch 12/20 => Loss 0.122, Train_accy 81.86:  55%|█████▌    | 11/20 [00:39<00:34,  3.80s/it]                
Task 17, Epoch 12/20 => Loss 0.122, Train_accy 81.86:  60%|██████    | 12/20 [00:39<00:26,  3.30s/it]
Task 17, Epoch 13/20 => Loss 0.140, Train_accy 78.90:  60%|██████    | 12/20 [00:41<00:26,  3.30s/it]
Task 17, Epoch 13/20 => Loss 0.140, Train_accy 78.90:  65%|██████▌   | 13/20 [00:41<00:20,  2.96s/it]
Task 17, Epoch 14/20 => Loss 0.201, Train_accy 78.06:  65%|██████▌   | 13/20 [00:43<00:20,  2.96s/it]
Task 17, Epoch 14/20 => Loss 0.201, Train_accy 78.06:  70%|███████   | 14/20 [00:43<00:16,  2.74s/it]
Task 17, Epoch 15/20 => Loss 0.138, Train_accy 82.70:  70%|███████   | 14/20 [00:45<00:16,  2.74s/it]
Task 17, Epoch 15/20 => Loss 0.138, Train_accy 82.70:  75%|███████▌  | 15/20 [00:45<00:12,  2.56s/it]
Task 17, Epoch 16/20 => Loss 0.129, Train_accy 75.95, Test_accy 6.59:  75%|███████▌  | 15/20 [00:52<00:12,  2.56s/it]
Task 17, Epoch 16/20 => Loss 0.129, Train_accy 75.95, Test_accy 6.59:  80%|████████  | 16/20 [00:52<00:15,  3.79s/it]
Task 17, Epoch 17/20 => Loss 0.193, Train_accy 79.75:  80%|████████  | 16/20 [00:54<00:15,  3.79s/it]                
Task 17, Epoch 17/20 => Loss 0.193, Train_accy 79.75:  85%|████████▌ | 17/20 [00:54<00:09,  3.31s/it]
Task 17, Epoch 18/20 => Loss 0.082, Train_accy 82.28:  85%|████████▌ | 17/20 [00:56<00:09,  3.31s/it]
Task 17, Epoch 18/20 => Loss 0.082, Train_accy 82.28:  90%|█████████ | 18/20 [00:56<00:05,  2.96s/it]
Task 17, Epoch 19/20 => Loss 0.082, Train_accy 82.70:  90%|█████████ | 18/20 [00:59<00:05,  2.96s/it]
Task 17, Epoch 19/20 => Loss 0.082, Train_accy 82.70:  95%|█████████▌| 19/20 [00:59<00:02,  2.72s/it]
Task 17, Epoch 20/20 => Loss 0.145, Train_accy 85.23:  95%|█████████▌| 19/20 [01:01<00:02,  2.72s/it]
Task 17, Epoch 20/20 => Loss 0.145, Train_accy 85.23: 100%|██████████| 20/20 [01:01<00:00,  2.55s/it]
Task 17, Epoch 20/20 => Loss 0.145, Train_accy 85.23: 100%|██████████| 20/20 [01:01<00:00,  3.06s/it]
2024-09-07 09:36:51,614 [finetune.py] => Task 17, Epoch 20/20 => Loss 0.145, Train_accy 85.23
2024-09-07 09:36:56,146 [trainer.py] => No NME accuracy.
2024-09-07 09:36:56,146 [trainer.py] => CNN: {'total': 5.73, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 1.04, '80-89': 0.0, '90-99': 1.61, '100-109': 5.0, '110-119': 10.81, '120-129': 0.0, '130-139': 12.79, '140-149': 11.84, '150-159': 33.33, '160-169': 14.12, '170-179': 29.03, 'old': 4.65, 'new': 29.03}
2024-09-07 09:36:56,147 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38, 7.67, 8.52, 5.77, 6.38, 5.73]
2024-09-07 09:36:56,147 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55, 18.38, 19.3, 16.59, 18.6, 17.35]

Average Accuracy (CNN): 7.44
2024-09-07 09:36:56,147 [trainer.py] => Average Accuracy (CNN): 7.44 

2024-09-07 09:36:56,149 [trainer.py] => All params: 85937076
2024-09-07 09:36:56,150 [trainer.py] => Trainable params: 85937076
2024-09-07 09:36:56,158 [finetune.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.541, Train_accy 0.00, Test_accy 5.65:   0%|          | 0/20 [00:06<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.541, Train_accy 0.00, Test_accy 5.65:   5%|▌         | 1/20 [00:06<02:01,  6.41s/it]
Task 18, Epoch 2/20 => Loss 1.433, Train_accy 3.70:   5%|▌         | 1/20 [00:08<02:01,  6.41s/it]                
Task 18, Epoch 2/20 => Loss 1.433, Train_accy 3.70:  10%|█         | 2/20 [00:08<01:07,  3.77s/it]
Task 18, Epoch 3/20 => Loss 0.910, Train_accy 11.11:  10%|█         | 2/20 [00:10<01:07,  3.77s/it]
Task 18, Epoch 3/20 => Loss 0.910, Train_accy 11.11:  15%|█▌        | 3/20 [00:10<00:49,  2.89s/it]
Task 18, Epoch 4/20 => Loss 0.566, Train_accy 34.92:  15%|█▌        | 3/20 [00:11<00:49,  2.89s/it]
Task 18, Epoch 4/20 => Loss 0.566, Train_accy 34.92:  20%|██        | 4/20 [00:11<00:39,  2.46s/it]
Task 18, Epoch 5/20 => Loss 0.436, Train_accy 46.56:  20%|██        | 4/20 [00:13<00:39,  2.46s/it]
Task 18, Epoch 5/20 => Loss 0.436, Train_accy 46.56:  25%|██▌       | 5/20 [00:13<00:33,  2.22s/it]
Task 18, Epoch 6/20 => Loss 0.359, Train_accy 54.50, Test_accy 6.42:  25%|██▌       | 5/20 [00:20<00:33,  2.22s/it]
Task 18, Epoch 6/20 => Loss 0.359, Train_accy 54.50, Test_accy 6.42:  30%|███       | 6/20 [00:20<00:51,  3.65s/it]
Task 18, Epoch 7/20 => Loss 0.231, Train_accy 68.25:  30%|███       | 6/20 [00:22<00:51,  3.65s/it]                
Task 18, Epoch 7/20 => Loss 0.231, Train_accy 68.25:  35%|███▌      | 7/20 [00:22<00:39,  3.06s/it]
Task 18, Epoch 8/20 => Loss 0.231, Train_accy 75.13:  35%|███▌      | 7/20 [00:23<00:39,  3.06s/it]
Task 18, Epoch 8/20 => Loss 0.231, Train_accy 75.13:  40%|████      | 8/20 [00:23<00:31,  2.66s/it]
Task 18, Epoch 9/20 => Loss 0.179, Train_accy 75.66:  40%|████      | 8/20 [00:25<00:31,  2.66s/it]
Task 18, Epoch 9/20 => Loss 0.179, Train_accy 75.66:  45%|████▌     | 9/20 [00:25<00:26,  2.39s/it]
Task 18, Epoch 10/20 => Loss 0.183, Train_accy 73.54:  45%|████▌     | 9/20 [00:27<00:26,  2.39s/it]
Task 18, Epoch 10/20 => Loss 0.183, Train_accy 73.54:  50%|█████     | 10/20 [00:27<00:22,  2.21s/it]
Task 18, Epoch 11/20 => Loss 0.115, Train_accy 78.84, Test_accy 5.79:  50%|█████     | 10/20 [00:33<00:22,  2.21s/it]
Task 18, Epoch 11/20 => Loss 0.115, Train_accy 78.84, Test_accy 5.79:  55%|█████▌    | 11/20 [00:33<00:31,  3.48s/it]
Task 18, Epoch 12/20 => Loss 0.161, Train_accy 78.84:  55%|█████▌    | 11/20 [00:35<00:31,  3.48s/it]                
Task 18, Epoch 12/20 => Loss 0.161, Train_accy 78.84:  60%|██████    | 12/20 [00:35<00:23,  2.96s/it]
Task 18, Epoch 13/20 => Loss 0.125, Train_accy 84.66:  60%|██████    | 12/20 [00:37<00:23,  2.96s/it]
Task 18, Epoch 13/20 => Loss 0.125, Train_accy 84.66:  65%|██████▌   | 13/20 [00:37<00:18,  2.61s/it]
Task 18, Epoch 14/20 => Loss 0.152, Train_accy 83.07:  65%|██████▌   | 13/20 [00:39<00:18,  2.61s/it]
Task 18, Epoch 14/20 => Loss 0.152, Train_accy 83.07:  70%|███████   | 14/20 [00:39<00:14,  2.36s/it]
Task 18, Epoch 15/20 => Loss 0.027, Train_accy 89.95:  70%|███████   | 14/20 [00:40<00:14,  2.36s/it]
Task 18, Epoch 15/20 => Loss 0.027, Train_accy 89.95:  75%|███████▌  | 15/20 [00:40<00:10,  2.19s/it]
Task 18, Epoch 16/20 => Loss 0.102, Train_accy 85.71, Test_accy 5.65:  75%|███████▌  | 15/20 [00:47<00:10,  2.19s/it]
Task 18, Epoch 16/20 => Loss 0.102, Train_accy 85.71, Test_accy 5.65:  80%|████████  | 16/20 [00:47<00:13,  3.42s/it]
Task 18, Epoch 17/20 => Loss 0.050, Train_accy 89.95:  80%|████████  | 16/20 [00:49<00:13,  3.42s/it]                
Task 18, Epoch 17/20 => Loss 0.050, Train_accy 89.95:  85%|████████▌ | 17/20 [00:49<00:08,  2.94s/it]
Task 18, Epoch 18/20 => Loss 0.111, Train_accy 86.77:  85%|████████▌ | 17/20 [00:50<00:08,  2.94s/it]
Task 18, Epoch 18/20 => Loss 0.111, Train_accy 86.77:  90%|█████████ | 18/20 [00:50<00:05,  2.60s/it]
Task 18, Epoch 19/20 => Loss 0.092, Train_accy 90.48:  90%|█████████ | 18/20 [00:52<00:05,  2.60s/it]
Task 18, Epoch 19/20 => Loss 0.092, Train_accy 90.48:  95%|█████████▌| 19/20 [00:52<00:02,  2.36s/it]
Task 18, Epoch 20/20 => Loss 0.120, Train_accy 86.77:  95%|█████████▌| 19/20 [00:54<00:02,  2.36s/it]
Task 18, Epoch 20/20 => Loss 0.120, Train_accy 86.77: 100%|██████████| 20/20 [00:54<00:00,  2.21s/it]
Task 18, Epoch 20/20 => Loss 0.120, Train_accy 86.77: 100%|██████████| 20/20 [00:54<00:00,  2.73s/it]
2024-09-07 09:37:50,692 [finetune.py] => Task 18, Epoch 20/20 => Loss 0.120, Train_accy 86.77
2024-09-07 09:37:55,228 [trainer.py] => No NME accuracy.
2024-09-07 09:37:55,228 [trainer.py] => CNN: {'total': 5.79, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 1.04, '80-89': 1.23, '90-99': 4.84, '100-109': 6.67, '110-119': 4.05, '120-129': 0.0, '130-139': 13.95, '140-149': 11.84, '150-159': 25.49, '160-169': 11.76, '170-179': 25.81, '180-189': 28.21, 'old': 5.16, 'new': 28.21}
2024-09-07 09:37:55,228 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38, 7.67, 8.52, 5.77, 6.38, 5.73, 5.79]
2024-09-07 09:37:55,228 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55, 18.38, 19.3, 16.59, 18.6, 17.35, 14.64]

Average Accuracy (CNN): 7.35
2024-09-07 09:37:55,228 [trainer.py] => Average Accuracy (CNN): 7.35 

2024-09-07 09:37:55,230 [trainer.py] => All params: 85944766
2024-09-07 09:37:55,230 [trainer.py] => Trainable params: 85944766
2024-09-07 09:37:55,234 [finetune.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.752, Train_accy 0.00, Test_accy 4.28:   0%|          | 0/20 [00:07<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.752, Train_accy 0.00, Test_accy 4.28:   5%|▌         | 1/20 [00:07<02:28,  7.80s/it]
Task 19, Epoch 2/20 => Loss 1.285, Train_accy 17.16:   5%|▌         | 1/20 [00:10<02:28,  7.80s/it]               
Task 19, Epoch 2/20 => Loss 1.285, Train_accy 17.16:  10%|█         | 2/20 [00:10<01:29,  4.95s/it]
Task 19, Epoch 3/20 => Loss 0.988, Train_accy 31.07:  10%|█         | 2/20 [00:13<01:29,  4.95s/it]
Task 19, Epoch 3/20 => Loss 0.988, Train_accy 31.07:  15%|█▌        | 3/20 [00:13<01:08,  4.04s/it]
Task 19, Epoch 4/20 => Loss 0.831, Train_accy 46.75:  15%|█▌        | 3/20 [00:16<01:08,  4.04s/it]
Task 19, Epoch 4/20 => Loss 0.831, Train_accy 46.75:  20%|██        | 4/20 [00:16<00:58,  3.63s/it]
Task 19, Epoch 5/20 => Loss 0.682, Train_accy 53.55:  20%|██        | 4/20 [00:19<00:58,  3.63s/it]
Task 19, Epoch 5/20 => Loss 0.682, Train_accy 53.55:  25%|██▌       | 5/20 [00:19<00:50,  3.39s/it]
Task 19, Epoch 6/20 => Loss 0.573, Train_accy 65.98, Test_accy 5.27:  25%|██▌       | 5/20 [00:27<00:50,  3.39s/it]
Task 19, Epoch 6/20 => Loss 0.573, Train_accy 65.98, Test_accy 5.27:  30%|███       | 6/20 [00:27<01:08,  4.90s/it]
Task 19, Epoch 7/20 => Loss 0.415, Train_accy 70.41:  30%|███       | 6/20 [00:30<01:08,  4.90s/it]                
Task 19, Epoch 7/20 => Loss 0.415, Train_accy 70.41:  35%|███▌      | 7/20 [00:30<00:55,  4.28s/it]
Task 19, Epoch 8/20 => Loss 0.285, Train_accy 78.70:  35%|███▌      | 7/20 [00:33<00:55,  4.28s/it]
Task 19, Epoch 8/20 => Loss 0.285, Train_accy 78.70:  40%|████      | 8/20 [00:33<00:46,  3.87s/it]
Task 19, Epoch 9/20 => Loss 0.227, Train_accy 80.47:  40%|████      | 8/20 [00:36<00:46,  3.87s/it]
Task 19, Epoch 9/20 => Loss 0.227, Train_accy 80.47:  45%|████▌     | 9/20 [00:36<00:39,  3.60s/it]
Task 19, Epoch 10/20 => Loss 0.148, Train_accy 85.50:  45%|████▌     | 9/20 [00:39<00:39,  3.60s/it]
Task 19, Epoch 10/20 => Loss 0.148, Train_accy 85.50:  50%|█████     | 10/20 [00:39<00:34,  3.40s/it]
Task 19, Epoch 11/20 => Loss 0.135, Train_accy 86.69, Test_accy 6.19:  50%|█████     | 10/20 [00:47<00:34,  3.40s/it]
Task 19, Epoch 11/20 => Loss 0.135, Train_accy 86.69, Test_accy 6.19:  55%|█████▌    | 11/20 [00:47<00:42,  4.76s/it]
Task 19, Epoch 12/20 => Loss 0.191, Train_accy 86.09:  55%|█████▌    | 11/20 [00:50<00:42,  4.76s/it]                
Task 19, Epoch 12/20 => Loss 0.191, Train_accy 86.09:  60%|██████    | 12/20 [00:50<00:33,  4.21s/it]
Task 19, Epoch 13/20 => Loss 0.170, Train_accy 85.21:  60%|██████    | 12/20 [00:53<00:33,  4.21s/it]
Task 19, Epoch 13/20 => Loss 0.170, Train_accy 85.21:  65%|██████▌   | 13/20 [00:53<00:26,  3.84s/it]
Task 19, Epoch 14/20 => Loss 0.188, Train_accy 86.69:  65%|██████▌   | 13/20 [00:56<00:26,  3.84s/it]
Task 19, Epoch 14/20 => Loss 0.188, Train_accy 86.69:  70%|███████   | 14/20 [00:56<00:21,  3.59s/it]
Task 19, Epoch 15/20 => Loss 0.231, Train_accy 83.14:  70%|███████   | 14/20 [00:59<00:21,  3.59s/it]
Task 19, Epoch 15/20 => Loss 0.231, Train_accy 83.14:  75%|███████▌  | 15/20 [00:59<00:16,  3.40s/it]
Task 19, Epoch 16/20 => Loss 0.301, Train_accy 75.74, Test_accy 6.32:  75%|███████▌  | 15/20 [01:06<00:16,  3.40s/it]
Task 19, Epoch 16/20 => Loss 0.301, Train_accy 75.74, Test_accy 6.32:  80%|████████  | 16/20 [01:06<00:18,  4.69s/it]
Task 19, Epoch 17/20 => Loss 0.630, Train_accy 60.65:  80%|████████  | 16/20 [01:09<00:18,  4.69s/it]                
Task 19, Epoch 17/20 => Loss 0.630, Train_accy 60.65:  85%|████████▌ | 17/20 [01:09<00:12,  4.17s/it]
Task 19, Epoch 18/20 => Loss 0.372, Train_accy 74.56:  85%|████████▌ | 17/20 [01:12<00:12,  4.17s/it]
Task 19, Epoch 18/20 => Loss 0.372, Train_accy 74.56:  90%|█████████ | 18/20 [01:12<00:07,  3.80s/it]
Task 19, Epoch 19/20 => Loss 0.301, Train_accy 75.74:  90%|█████████ | 18/20 [01:15<00:07,  3.80s/it]
Task 19, Epoch 19/20 => Loss 0.301, Train_accy 75.74:  95%|█████████▌| 19/20 [01:15<00:03,  3.55s/it]
Task 19, Epoch 20/20 => Loss 0.188, Train_accy 79.59:  95%|█████████▌| 19/20 [01:18<00:03,  3.55s/it]
Task 19, Epoch 20/20 => Loss 0.188, Train_accy 79.59: 100%|██████████| 20/20 [01:18<00:00,  3.37s/it]
Task 19, Epoch 20/20 => Loss 0.188, Train_accy 79.59: 100%|██████████| 20/20 [01:18<00:00,  3.94s/it]
2024-09-07 09:39:13,988 [finetune.py] => Task 19, Epoch 20/20 => Loss 0.188, Train_accy 79.59
2024-09-07 09:39:18,855 [trainer.py] => No NME accuracy.
2024-09-07 09:39:18,855 [trainer.py] => CNN: {'total': 6.06, '00-09': 0.0, '10-19': 0.0, '20-29': 0.0, '30-39': 0.0, '40-49': 0.0, '50-59': 0.0, '60-69': 0.0, '70-79': 0.0, '80-89': 0.0, '90-99': 1.61, '100-109': 6.67, '110-119': 5.41, '120-129': 1.67, '130-139': 3.49, '140-149': 13.16, '150-159': 21.57, '160-169': 11.76, '170-179': 11.29, '180-189': 10.26, '190-199': 43.53, 'old': 3.84, 'new': 43.53}
2024-09-07 09:39:18,855 [trainer.py] => CNN top1 curve: [18.18, 12.0, 6.2, 6.94, 7.31, 7.35, 6.81, 6.3, 3.72, 5.59, 6.22, 6.77, 6.38, 7.67, 8.52, 5.77, 6.38, 5.73, 5.79, 6.06]
2024-09-07 09:39:18,856 [trainer.py] => CNN top5 curve: [70.13, 50.29, 32.12, 26.39, 21.7, 21.43, 21.26, 19.34, 17.2, 15.81, 18.31, 18.15, 18.55, 18.38, 19.3, 16.59, 18.6, 17.35, 14.64, 16.59]

Average Accuracy (CNN): 7.28
2024-09-07 09:39:18,856 [trainer.py] => Average Accuracy (CNN): 7.28 

Accuracy Matrix (CNN):
[[18.18  1.3   1.3  11.69  0.    3.9   2.6   0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.    0.  ]
 [ 0.   20.41 11.22  1.02  0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.    0.  ]
 [ 0.    0.    5.05  5.05  0.    1.01  1.01  1.01  0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.   11.63  6.98  4.65  1.16  0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.   39.06 20.31 14.06  0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.   26.92  3.85  0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.    0.   20.63  0.79  0.    0.    0.79  0.
   0.    0.    0.    0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.    0.    0.   43.75  3.12  9.38  6.25  8.33
   4.17  2.08  5.21  4.17  2.08  1.04  1.04  0.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   32.1  33.33 23.46 12.35
   3.7   4.94  6.17  6.17  3.7   0.    1.23  0.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   17.74 11.29  3.23
   8.06  1.61  1.61  3.23  3.23  1.61  4.84  1.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   38.33 23.33
  15.   10.   10.   11.67  6.67  5.    6.67  6.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   43.24
  43.24 39.19 32.43 14.86 16.22 10.81  4.05  5.41]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  21.67 13.33 13.33  3.33  0.    0.    0.    1.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   41.86 38.37 17.44 16.28 12.79 13.95  3.49]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   26.32 13.16 11.84 11.84 11.84 13.16]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   31.37 33.33 33.33 25.49 21.57]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   25.88 14.12 11.76 11.76]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   29.03 25.81 11.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   28.21 10.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   43.53]]
2024-09-07 09:39:18,861 [trainer.py] => Forgetting (CNN): 23.035789473684208
2024-09-07 09:39:21,621 [trainer.py] => config: ./exps/finetune_ina_B100_Inc5.json
2024-09-07 09:39:21,637 [trainer.py] => prefix: reproduce
2024-09-07 09:39:21,637 [trainer.py] => dataset: imageneta
2024-09-07 09:39:21,637 [trainer.py] => memory_size: 0
2024-09-07 09:39:21,637 [trainer.py] => memory_per_class: 0
2024-09-07 09:39:21,637 [trainer.py] => fixed_memory: False
2024-09-07 09:39:21,637 [trainer.py] => shuffle: True
2024-09-07 09:39:21,637 [trainer.py] => init_cls: 100
2024-09-07 09:39:21,637 [trainer.py] => increment: 20
2024-09-07 09:39:21,637 [trainer.py] => model_name: finetune
2024-09-07 09:39:21,637 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 09:39:21,638 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 09:39:21,638 [trainer.py] => seed: 1993
2024-09-07 09:39:21,638 [trainer.py] => init_epoch: 20
2024-09-07 09:39:21,638 [trainer.py] => init_lr: 0.001
2024-09-07 09:39:21,638 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 09:39:21,638 [trainer.py] => init_lr_decay: 0.1
2024-09-07 09:39:21,638 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 09:39:21,638 [trainer.py] => epochs: 20
2024-09-07 09:39:21,638 [trainer.py] => lrate: 0.001
2024-09-07 09:39:21,638 [trainer.py] => milestones: [40, 70]
2024-09-07 09:39:21,638 [trainer.py] => lrate_decay: 0.1
2024-09-07 09:39:21,638 [trainer.py] => batch_size: 48
2024-09-07 09:39:21,638 [trainer.py] => weight_decay: 0.0002
2024-09-07 09:39:21,668 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 09:39:23,357 [trainer.py] => All params: 85798656
2024-09-07 09:39:23,358 [trainer.py] => Trainable params: 85798656
2024-09-07 09:39:23,359 [finetune.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.512, Train_accy 2.04, Test_accy 2.02:   0%|          | 0/20 [00:28<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.512, Train_accy 2.04, Test_accy 2.02:   5%|▌         | 1/20 [00:28<09:00, 28.47s/it]
Task 0, Epoch 2/20 => Loss 4.337, Train_accy 3.65:   5%|▌         | 1/20 [00:53<09:00, 28.47s/it]                
Task 0, Epoch 2/20 => Loss 4.337, Train_accy 3.65:  10%|█         | 2/20 [00:53<08:00, 26.71s/it]
Task 0, Epoch 3/20 => Loss 4.125, Train_accy 7.26:  10%|█         | 2/20 [01:19<08:00, 26.71s/it]
Task 0, Epoch 3/20 => Loss 4.125, Train_accy 7.26:  15%|█▌        | 3/20 [01:19<07:25, 26.18s/it]
Task 0, Epoch 4/20 => Loss 3.424, Train_accy 19.42:  15%|█▌        | 3/20 [01:45<07:25, 26.18s/it]
Task 0, Epoch 4/20 => Loss 3.424, Train_accy 19.42:  20%|██        | 4/20 [01:45<06:55, 25.98s/it]
Task 0, Epoch 5/20 => Loss 2.583, Train_accy 36.87:  20%|██        | 4/20 [02:10<06:55, 25.98s/it]
Task 0, Epoch 5/20 => Loss 2.583, Train_accy 36.87:  25%|██▌       | 5/20 [02:10<06:28, 25.87s/it]
Task 0, Epoch 6/20 => Loss 2.075, Train_accy 48.21, Test_accy 42.93:  25%|██▌       | 5/20 [02:39<06:28, 25.87s/it]
Task 0, Epoch 6/20 => Loss 2.075, Train_accy 48.21, Test_accy 42.93:  30%|███       | 6/20 [02:39<06:14, 26.77s/it]
Task 0, Epoch 7/20 => Loss 1.619, Train_accy 57.54:  30%|███       | 6/20 [03:05<06:14, 26.77s/it]                 
Task 0, Epoch 7/20 => Loss 1.619, Train_accy 57.54:  35%|███▌      | 7/20 [03:05<05:43, 26.43s/it]
Task 0, Epoch 8/20 => Loss 1.430, Train_accy 62.46:  35%|███▌      | 7/20 [03:30<05:43, 26.43s/it]
Task 0, Epoch 8/20 => Loss 1.430, Train_accy 62.46:  40%|████      | 8/20 [03:30<05:14, 26.17s/it]
Task 0, Epoch 9/20 => Loss 1.091, Train_accy 70.73:  40%|████      | 8/20 [03:56<05:14, 26.17s/it]
Task 0, Epoch 9/20 => Loss 1.091, Train_accy 70.73:  45%|████▌     | 9/20 [03:56<04:45, 25.98s/it]
Task 0, Epoch 10/20 => Loss 0.902, Train_accy 76.50:  45%|████▌     | 9/20 [04:21<04:45, 25.98s/it]
Task 0, Epoch 10/20 => Loss 0.902, Train_accy 76.50:  50%|█████     | 10/20 [04:21<04:18, 25.87s/it]
Task 0, Epoch 11/20 => Loss 0.808, Train_accy 78.60, Test_accy 45.78:  50%|█████     | 10/20 [04:50<04:18, 25.87s/it]
Task 0, Epoch 11/20 => Loss 0.808, Train_accy 78.60, Test_accy 45.78:  55%|█████▌    | 11/20 [04:50<03:59, 26.65s/it]
Task 0, Epoch 12/20 => Loss 0.650, Train_accy 82.43:  55%|█████▌    | 11/20 [05:16<03:59, 26.65s/it]                 
Task 0, Epoch 12/20 => Loss 0.650, Train_accy 82.43:  60%|██████    | 12/20 [05:16<03:30, 26.36s/it]
Task 0, Epoch 13/20 => Loss 0.624, Train_accy 83.34:  60%|██████    | 12/20 [05:41<03:30, 26.36s/it]
Task 0, Epoch 13/20 => Loss 0.624, Train_accy 83.34:  65%|██████▌   | 13/20 [05:41<03:02, 26.11s/it]
Task 0, Epoch 14/20 => Loss 0.566, Train_accy 84.95:  65%|██████▌   | 13/20 [06:07<03:02, 26.11s/it]
Task 0, Epoch 14/20 => Loss 0.566, Train_accy 84.95:  70%|███████   | 14/20 [06:07<02:35, 25.95s/it]
Task 0, Epoch 15/20 => Loss 0.527, Train_accy 86.02:  70%|███████   | 14/20 [06:32<02:35, 25.95s/it]
Task 0, Epoch 15/20 => Loss 0.527, Train_accy 86.02:  75%|███████▌  | 15/20 [06:32<02:09, 25.87s/it]
Task 0, Epoch 16/20 => Loss 0.455, Train_accy 87.69, Test_accy 46.73:  75%|███████▌  | 15/20 [07:01<02:09, 25.87s/it]
Task 0, Epoch 16/20 => Loss 0.455, Train_accy 87.69, Test_accy 46.73:  80%|████████  | 16/20 [07:01<01:46, 26.65s/it]
Task 0, Epoch 17/20 => Loss 0.420, Train_accy 88.48:  80%|████████  | 16/20 [07:26<01:46, 26.65s/it]                 
Task 0, Epoch 17/20 => Loss 0.420, Train_accy 88.48:  85%|████████▌ | 17/20 [07:26<01:19, 26.35s/it]
Task 0, Epoch 18/20 => Loss 0.398, Train_accy 89.21:  85%|████████▌ | 17/20 [07:52<01:19, 26.35s/it]
Task 0, Epoch 18/20 => Loss 0.398, Train_accy 89.21:  90%|█████████ | 18/20 [07:52<00:52, 26.19s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.82:  90%|█████████ | 18/20 [08:18<00:52, 26.19s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.82:  95%|█████████▌| 19/20 [08:18<00:26, 26.08s/it]
Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12:  95%|█████████▌| 19/20 [08:44<00:26, 26.08s/it]
Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12: 100%|██████████| 20/20 [08:44<00:00, 25.97s/it]
Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12: 100%|██████████| 20/20 [08:44<00:00, 26.21s/it]
2024-09-07 09:48:08,088 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12
2024-09-07 09:48:10,970 [trainer.py] => No NME accuracy.
2024-09-07 09:48:10,970 [trainer.py] => CNN: {'total': 51.13, '00-99': 51.13, 'old': 0, 'new': 51.13}
2024-09-07 09:48:10,970 [trainer.py] => CNN top1 curve: [51.13]
2024-09-07 09:48:10,971 [trainer.py] => CNN top5 curve: [74.79]

Average Accuracy (CNN): 51.13
2024-09-07 09:48:10,971 [trainer.py] => Average Accuracy (CNN): 51.13 

2024-09-07 09:48:10,972 [trainer.py] => All params: 85875556
2024-09-07 09:48:10,974 [trainer.py] => Trainable params: 85875556
2024-09-07 09:48:10,977 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.984, Train_accy 6.12, Test_accy 30.77:   0%|          | 0/20 [00:07<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.984, Train_accy 6.12, Test_accy 30.77:   5%|▌         | 1/20 [00:07<02:25,  7.65s/it]
Task 1, Epoch 2/20 => Loss 1.573, Train_accy 33.08:   5%|▌         | 1/20 [00:12<02:25,  7.65s/it]                
Task 1, Epoch 2/20 => Loss 1.573, Train_accy 33.08:  10%|█         | 2/20 [00:12<01:43,  5.75s/it]
Task 1, Epoch 3/20 => Loss 1.012, Train_accy 51.82:  10%|█         | 2/20 [00:16<01:43,  5.75s/it]
Task 1, Epoch 3/20 => Loss 1.012, Train_accy 51.82:  15%|█▌        | 3/20 [00:16<01:27,  5.13s/it]
Task 1, Epoch 4/20 => Loss 0.663, Train_accy 60.61:  15%|█▌        | 3/20 [00:20<01:27,  5.13s/it]
Task 1, Epoch 4/20 => Loss 0.663, Train_accy 60.61:  20%|██        | 4/20 [00:20<01:17,  4.84s/it]
Task 1, Epoch 5/20 => Loss 0.416, Train_accy 72.28:  20%|██        | 4/20 [00:25<01:17,  4.84s/it]
Task 1, Epoch 5/20 => Loss 0.416, Train_accy 72.28:  25%|██▌       | 5/20 [00:25<01:10,  4.67s/it]
Task 1, Epoch 6/20 => Loss 0.312, Train_accy 75.91, Test_accy 40.92:  25%|██▌       | 5/20 [00:32<01:10,  4.67s/it]
Task 1, Epoch 6/20 => Loss 0.312, Train_accy 75.91, Test_accy 40.92:  30%|███       | 6/20 [00:32<01:19,  5.70s/it]
Task 1, Epoch 7/20 => Loss 0.213, Train_accy 81.26:  30%|███       | 6/20 [00:37<01:19,  5.70s/it]                 
Task 1, Epoch 7/20 => Loss 0.213, Train_accy 81.26:  35%|███▌      | 7/20 [00:37<01:08,  5.27s/it]
Task 1, Epoch 8/20 => Loss 0.191, Train_accy 81.26:  35%|███▌      | 7/20 [00:41<01:08,  5.27s/it]
Task 1, Epoch 8/20 => Loss 0.191, Train_accy 81.26:  40%|████      | 8/20 [00:41<00:59,  4.99s/it]
Task 1, Epoch 9/20 => Loss 0.192, Train_accy 83.37:  40%|████      | 8/20 [00:46<00:59,  4.99s/it]
Task 1, Epoch 9/20 => Loss 0.192, Train_accy 83.37:  45%|████▌     | 9/20 [00:46<00:52,  4.80s/it]
Task 1, Epoch 10/20 => Loss 0.157, Train_accy 84.51:  45%|████▌     | 9/20 [00:50<00:52,  4.80s/it]
Task 1, Epoch 10/20 => Loss 0.157, Train_accy 84.51:  50%|█████     | 10/20 [00:50<00:46,  4.67s/it]
Task 1, Epoch 11/20 => Loss 0.166, Train_accy 89.10, Test_accy 38.97:  50%|█████     | 10/20 [00:58<00:46,  4.67s/it]
Task 1, Epoch 11/20 => Loss 0.166, Train_accy 89.10, Test_accy 38.97:  55%|█████▌    | 11/20 [00:58<00:50,  5.58s/it]
Task 1, Epoch 12/20 => Loss 0.142, Train_accy 86.42:  55%|█████▌    | 11/20 [01:02<00:50,  5.58s/it]                 
Task 1, Epoch 12/20 => Loss 0.142, Train_accy 86.42:  60%|██████    | 12/20 [01:02<00:41,  5.23s/it]
Task 1, Epoch 13/20 => Loss 0.239, Train_accy 87.19:  60%|██████    | 12/20 [01:06<00:41,  5.23s/it]
Task 1, Epoch 13/20 => Loss 0.239, Train_accy 87.19:  65%|██████▌   | 13/20 [01:06<00:34,  4.98s/it]
Task 1, Epoch 14/20 => Loss 0.182, Train_accy 85.85:  65%|██████▌   | 13/20 [01:11<00:34,  4.98s/it]
Task 1, Epoch 14/20 => Loss 0.182, Train_accy 85.85:  70%|███████   | 14/20 [01:11<00:28,  4.80s/it]
Task 1, Epoch 15/20 => Loss 0.130, Train_accy 86.81:  70%|███████   | 14/20 [01:15<00:28,  4.80s/it]
Task 1, Epoch 15/20 => Loss 0.130, Train_accy 86.81:  75%|███████▌  | 15/20 [01:15<00:23,  4.67s/it]
Task 1, Epoch 16/20 => Loss 0.170, Train_accy 85.85, Test_accy 38.97:  75%|███████▌  | 15/20 [01:23<00:23,  4.67s/it]
Task 1, Epoch 16/20 => Loss 0.170, Train_accy 85.85, Test_accy 38.97:  80%|████████  | 16/20 [01:23<00:22,  5.58s/it]
Task 1, Epoch 17/20 => Loss 0.125, Train_accy 90.82:  80%|████████  | 16/20 [01:27<00:22,  5.58s/it]                 
Task 1, Epoch 17/20 => Loss 0.125, Train_accy 90.82:  85%|████████▌ | 17/20 [01:27<00:15,  5.22s/it]
Task 1, Epoch 18/20 => Loss 0.137, Train_accy 87.38:  85%|████████▌ | 17/20 [01:32<00:15,  5.22s/it]
Task 1, Epoch 18/20 => Loss 0.137, Train_accy 87.38:  90%|█████████ | 18/20 [01:32<00:09,  4.97s/it]
Task 1, Epoch 19/20 => Loss 0.127, Train_accy 89.48:  90%|█████████ | 18/20 [01:36<00:09,  4.97s/it]
Task 1, Epoch 19/20 => Loss 0.127, Train_accy 89.48:  95%|█████████▌| 19/20 [01:36<00:04,  4.80s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 90.44:  95%|█████████▌| 19/20 [01:40<00:04,  4.80s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 90.44: 100%|██████████| 20/20 [01:40<00:00,  4.68s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 90.44: 100%|██████████| 20/20 [01:40<00:00,  5.05s/it]
2024-09-07 09:49:51,948 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.130, Train_accy 90.44
2024-09-07 09:49:55,232 [trainer.py] => No NME accuracy.
2024-09-07 09:49:55,232 [trainer.py] => CNN: {'total': 38.56, '00-99': 36.03, '100-119': 54.48, 'old': 36.03, 'new': 54.48}
2024-09-07 09:49:55,232 [trainer.py] => CNN top1 curve: [51.13, 38.56]
2024-09-07 09:49:55,233 [trainer.py] => CNN top5 curve: [74.79, 67.28]

Average Accuracy (CNN): 44.84
2024-09-07 09:49:55,233 [trainer.py] => Average Accuracy (CNN): 44.84 

2024-09-07 09:49:55,234 [trainer.py] => All params: 85890936
2024-09-07 09:49:55,236 [trainer.py] => Trainable params: 85890936
2024-09-07 09:49:55,239 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.032, Train_accy 1.30, Test_accy 29.88:   0%|          | 0/20 [00:08<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.032, Train_accy 1.30, Test_accy 29.88:   5%|▌         | 1/20 [00:08<02:36,  8.21s/it]
Task 2, Epoch 2/20 => Loss 1.525, Train_accy 28.39:   5%|▌         | 1/20 [00:12<02:36,  8.21s/it]                
Task 2, Epoch 2/20 => Loss 1.525, Train_accy 28.39:  10%|█         | 2/20 [00:12<01:49,  6.11s/it]
Task 2, Epoch 3/20 => Loss 1.041, Train_accy 41.93:  10%|█         | 2/20 [00:17<01:49,  6.11s/it]
Task 2, Epoch 3/20 => Loss 1.041, Train_accy 41.93:  15%|█▌        | 3/20 [00:17<01:31,  5.39s/it]
Task 2, Epoch 4/20 => Loss 0.681, Train_accy 53.62:  15%|█▌        | 3/20 [00:21<01:31,  5.39s/it]
Task 2, Epoch 4/20 => Loss 0.681, Train_accy 53.62:  20%|██        | 4/20 [00:21<01:21,  5.06s/it]
Task 2, Epoch 5/20 => Loss 0.491, Train_accy 66.23:  20%|██        | 4/20 [00:26<01:21,  5.06s/it]
Task 2, Epoch 5/20 => Loss 0.491, Train_accy 66.23:  25%|██▌       | 5/20 [00:26<01:13,  4.88s/it]
Task 2, Epoch 6/20 => Loss 0.335, Train_accy 70.32, Test_accy 33.54:  25%|██▌       | 5/20 [00:34<01:13,  4.88s/it]
Task 2, Epoch 6/20 => Loss 0.335, Train_accy 70.32, Test_accy 33.54:  30%|███       | 6/20 [00:34<01:24,  6.02s/it]
Task 2, Epoch 7/20 => Loss 0.307, Train_accy 71.06:  30%|███       | 6/20 [00:39<01:24,  6.02s/it]                 
Task 2, Epoch 7/20 => Loss 0.307, Train_accy 71.06:  35%|███▌      | 7/20 [00:39<01:11,  5.53s/it]
Task 2, Epoch 8/20 => Loss 0.291, Train_accy 74.21:  35%|███▌      | 7/20 [00:43<01:11,  5.53s/it]
Task 2, Epoch 8/20 => Loss 0.291, Train_accy 74.21:  40%|████      | 8/20 [00:43<01:02,  5.21s/it]
Task 2, Epoch 9/20 => Loss 0.278, Train_accy 77.92:  40%|████      | 8/20 [00:48<01:02,  5.21s/it]
Task 2, Epoch 9/20 => Loss 0.278, Train_accy 77.92:  45%|████▌     | 9/20 [00:48<00:54,  4.99s/it]
Task 2, Epoch 10/20 => Loss 0.197, Train_accy 80.89:  45%|████▌     | 9/20 [00:52<00:54,  4.99s/it]
Task 2, Epoch 10/20 => Loss 0.197, Train_accy 80.89:  50%|█████     | 10/20 [00:52<00:48,  4.85s/it]
Task 2, Epoch 11/20 => Loss 0.168, Train_accy 81.08, Test_accy 32.74:  50%|█████     | 10/20 [01:01<00:48,  4.85s/it]
Task 2, Epoch 11/20 => Loss 0.168, Train_accy 81.08, Test_accy 32.74:  55%|█████▌    | 11/20 [01:01<00:52,  5.88s/it]
Task 2, Epoch 12/20 => Loss 0.198, Train_accy 84.42:  55%|█████▌    | 11/20 [01:05<00:52,  5.88s/it]                 
Task 2, Epoch 12/20 => Loss 0.198, Train_accy 84.42:  60%|██████    | 12/20 [01:05<00:43,  5.48s/it]
Task 2, Epoch 13/20 => Loss 0.307, Train_accy 80.89:  60%|██████    | 12/20 [01:10<00:43,  5.48s/it]
Task 2, Epoch 13/20 => Loss 0.307, Train_accy 80.89:  65%|██████▌   | 13/20 [01:10<00:36,  5.18s/it]
Task 2, Epoch 14/20 => Loss 0.253, Train_accy 81.82:  65%|██████▌   | 13/20 [01:14<00:36,  5.18s/it]
Task 2, Epoch 14/20 => Loss 0.253, Train_accy 81.82:  70%|███████   | 14/20 [01:14<00:29,  4.98s/it]
Task 2, Epoch 15/20 => Loss 0.269, Train_accy 81.08:  70%|███████   | 14/20 [01:19<00:29,  4.98s/it]
Task 2, Epoch 15/20 => Loss 0.269, Train_accy 81.08:  75%|███████▌  | 15/20 [01:19<00:24,  4.83s/it]
Task 2, Epoch 16/20 => Loss 0.236, Train_accy 82.19, Test_accy 31.49:  75%|███████▌  | 15/20 [01:27<00:24,  4.83s/it]
Task 2, Epoch 16/20 => Loss 0.236, Train_accy 82.19, Test_accy 31.49:  80%|████████  | 16/20 [01:27<00:23,  5.82s/it]
Task 2, Epoch 17/20 => Loss 0.226, Train_accy 81.63:  80%|████████  | 16/20 [01:31<00:23,  5.82s/it]                 
Task 2, Epoch 17/20 => Loss 0.226, Train_accy 81.63:  85%|████████▌ | 17/20 [01:31<00:16,  5.44s/it]
Task 2, Epoch 18/20 => Loss 0.156, Train_accy 85.34:  85%|████████▌ | 17/20 [01:36<00:16,  5.44s/it]
Task 2, Epoch 18/20 => Loss 0.156, Train_accy 85.34:  90%|█████████ | 18/20 [01:36<00:10,  5.16s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 87.20:  90%|█████████ | 18/20 [01:40<00:10,  5.16s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 87.20:  95%|█████████▌| 19/20 [01:40<00:04,  4.97s/it]
Task 2, Epoch 20/20 => Loss 0.145, Train_accy 88.13:  95%|█████████▌| 19/20 [01:45<00:04,  4.97s/it]
Task 2, Epoch 20/20 => Loss 0.145, Train_accy 88.13: 100%|██████████| 20/20 [01:45<00:00,  4.84s/it]
Task 2, Epoch 20/20 => Loss 0.145, Train_accy 88.13: 100%|██████████| 20/20 [01:45<00:00,  5.27s/it]
2024-09-07 09:51:40,611 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.145, Train_accy 88.13
2024-09-07 09:51:44,366 [trainer.py] => No NME accuracy.
2024-09-07 09:51:44,367 [trainer.py] => CNN: {'total': 29.71, '00-99': 24.61, '100-119': 43.28, '120-139': 46.58, 'old': 27.18, 'new': 46.58}
2024-09-07 09:51:44,367 [trainer.py] => CNN top1 curve: [51.13, 38.56, 29.71]
2024-09-07 09:51:44,367 [trainer.py] => CNN top5 curve: [74.79, 67.28, 58.88]

Average Accuracy (CNN): 39.8
2024-09-07 09:51:44,367 [trainer.py] => Average Accuracy (CNN): 39.8 

2024-09-07 09:51:44,369 [trainer.py] => All params: 85906316
2024-09-07 09:51:44,370 [trainer.py] => Trainable params: 85906316
2024-09-07 09:51:44,375 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.169, Train_accy 1.51, Test_accy 21.31:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.169, Train_accy 1.51, Test_accy 21.31:   5%|▌         | 1/20 [00:08<02:43,  8.61s/it]
Task 3, Epoch 2/20 => Loss 1.574, Train_accy 20.15:   5%|▌         | 1/20 [00:13<02:43,  8.61s/it]                
Task 3, Epoch 2/20 => Loss 1.574, Train_accy 20.15:  10%|█         | 2/20 [00:13<01:51,  6.17s/it]
Task 3, Epoch 3/20 => Loss 1.102, Train_accy 38.98:  10%|█         | 2/20 [00:17<01:51,  6.17s/it]
Task 3, Epoch 3/20 => Loss 1.102, Train_accy 38.98:  15%|█▌        | 3/20 [00:17<01:32,  5.42s/it]
Task 3, Epoch 4/20 => Loss 0.882, Train_accy 52.92:  15%|█▌        | 3/20 [00:22<01:32,  5.42s/it]
Task 3, Epoch 4/20 => Loss 0.882, Train_accy 52.92:  20%|██        | 4/20 [00:22<01:20,  5.04s/it]
Task 3, Epoch 5/20 => Loss 0.707, Train_accy 59.51:  20%|██        | 4/20 [00:26<01:20,  5.04s/it]
Task 3, Epoch 5/20 => Loss 0.707, Train_accy 59.51:  25%|██▌       | 5/20 [00:26<01:12,  4.83s/it]
Task 3, Epoch 6/20 => Loss 0.777, Train_accy 59.89, Test_accy 23.40:  25%|██▌       | 5/20 [00:35<01:12,  4.83s/it]
Task 3, Epoch 6/20 => Loss 0.777, Train_accy 59.89, Test_accy 23.40:  30%|███       | 6/20 [00:35<01:25,  6.08s/it]
Task 3, Epoch 7/20 => Loss 0.690, Train_accy 63.28:  30%|███       | 6/20 [00:39<01:25,  6.08s/it]                 
Task 3, Epoch 7/20 => Loss 0.690, Train_accy 63.28:  35%|███▌      | 7/20 [00:39<01:12,  5.54s/it]
Task 3, Epoch 8/20 => Loss 0.509, Train_accy 67.42:  35%|███▌      | 7/20 [00:43<01:12,  5.54s/it]
Task 3, Epoch 8/20 => Loss 0.509, Train_accy 67.42:  40%|████      | 8/20 [00:43<01:02,  5.20s/it]
Task 3, Epoch 9/20 => Loss 0.333, Train_accy 73.45:  40%|████      | 8/20 [00:48<01:02,  5.20s/it]
Task 3, Epoch 9/20 => Loss 0.333, Train_accy 73.45:  45%|████▌     | 9/20 [00:48<00:54,  5.00s/it]
Task 3, Epoch 10/20 => Loss 0.297, Train_accy 77.97:  45%|████▌     | 9/20 [00:53<00:54,  5.00s/it]
Task 3, Epoch 10/20 => Loss 0.297, Train_accy 77.97:  50%|█████     | 10/20 [00:53<00:49,  4.91s/it]
Task 3, Epoch 11/20 => Loss 0.217, Train_accy 78.15, Test_accy 24.20:  50%|█████     | 10/20 [01:01<00:49,  4.91s/it]
Task 3, Epoch 11/20 => Loss 0.217, Train_accy 78.15, Test_accy 24.20:  55%|█████▌    | 11/20 [01:01<00:54,  6.02s/it]
Task 3, Epoch 12/20 => Loss 0.184, Train_accy 84.37:  55%|█████▌    | 11/20 [01:06<00:54,  6.02s/it]                 
Task 3, Epoch 12/20 => Loss 0.184, Train_accy 84.37:  60%|██████    | 12/20 [01:06<00:44,  5.54s/it]
Task 3, Epoch 13/20 => Loss 0.184, Train_accy 82.30:  60%|██████    | 12/20 [01:10<00:44,  5.54s/it]
Task 3, Epoch 13/20 => Loss 0.184, Train_accy 82.30:  65%|██████▌   | 13/20 [01:10<00:36,  5.22s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 83.24:  65%|██████▌   | 13/20 [01:15<00:36,  5.22s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 83.24:  70%|███████   | 14/20 [01:15<00:29,  4.99s/it]
Task 3, Epoch 15/20 => Loss 0.160, Train_accy 86.06:  70%|███████   | 14/20 [01:19<00:29,  4.99s/it]
Task 3, Epoch 15/20 => Loss 0.160, Train_accy 86.06:  75%|███████▌  | 15/20 [01:19<00:24,  4.83s/it]
Task 3, Epoch 16/20 => Loss 0.137, Train_accy 87.01, Test_accy 24.20:  75%|███████▌  | 15/20 [01:28<00:24,  4.83s/it]
Task 3, Epoch 16/20 => Loss 0.137, Train_accy 87.01, Test_accy 24.20:  80%|████████  | 16/20 [01:28<00:23,  5.95s/it]
Task 3, Epoch 17/20 => Loss 0.167, Train_accy 84.75:  80%|████████  | 16/20 [01:32<00:23,  5.95s/it]                 
Task 3, Epoch 17/20 => Loss 0.167, Train_accy 84.75:  85%|████████▌ | 17/20 [01:32<00:16,  5.49s/it]
Task 3, Epoch 18/20 => Loss 0.281, Train_accy 83.80:  85%|████████▌ | 17/20 [01:37<00:16,  5.49s/it]
Task 3, Epoch 18/20 => Loss 0.281, Train_accy 83.80:  90%|█████████ | 18/20 [01:37<00:10,  5.19s/it]
Task 3, Epoch 19/20 => Loss 0.154, Train_accy 84.56:  90%|█████████ | 18/20 [01:41<00:10,  5.19s/it]
Task 3, Epoch 19/20 => Loss 0.154, Train_accy 84.56:  95%|█████████▌| 19/20 [01:41<00:04,  4.97s/it]
Task 3, Epoch 20/20 => Loss 0.131, Train_accy 87.38:  95%|█████████▌| 19/20 [01:45<00:04,  4.97s/it]
Task 3, Epoch 20/20 => Loss 0.131, Train_accy 87.38: 100%|██████████| 20/20 [01:45<00:00,  4.82s/it]
Task 3, Epoch 20/20 => Loss 0.131, Train_accy 87.38: 100%|██████████| 20/20 [01:45<00:00,  5.30s/it]
2024-09-07 09:53:30,343 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.131, Train_accy 87.38
2024-09-07 09:53:34,402 [trainer.py] => No NME accuracy.
2024-09-07 09:53:34,402 [trainer.py] => CNN: {'total': 22.28, '00-99': 17.72, '100-119': 32.09, '120-139': 25.34, '140-159': 38.58, 'old': 20.43, 'new': 38.58}
2024-09-07 09:53:34,403 [trainer.py] => CNN top1 curve: [51.13, 38.56, 29.71, 22.28]
2024-09-07 09:53:34,403 [trainer.py] => CNN top5 curve: [74.79, 67.28, 58.88, 48.0]

Average Accuracy (CNN): 35.42
2024-09-07 09:53:34,403 [trainer.py] => Average Accuracy (CNN): 35.42 

2024-09-07 09:53:34,404 [trainer.py] => All params: 85921696
2024-09-07 09:53:34,405 [trainer.py] => Trainable params: 85921696
2024-09-07 09:53:34,409 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.266, Train_accy 0.18, Test_accy 14.12:   0%|          | 0/20 [00:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.266, Train_accy 0.18, Test_accy 14.12:   5%|▌         | 1/20 [00:09<02:54,  9.18s/it]
Task 4, Epoch 2/20 => Loss 1.957, Train_accy 5.25:   5%|▌         | 1/20 [00:13<02:54,  9.18s/it]                 
Task 4, Epoch 2/20 => Loss 1.957, Train_accy 5.25:  10%|█         | 2/20 [00:13<01:58,  6.58s/it]
Task 4, Epoch 3/20 => Loss 1.368, Train_accy 19.96:  10%|█         | 2/20 [00:18<01:58,  6.58s/it]
Task 4, Epoch 3/20 => Loss 1.368, Train_accy 19.96:  15%|█▌        | 3/20 [00:18<01:37,  5.74s/it]
Task 4, Epoch 4/20 => Loss 0.891, Train_accy 30.65:  15%|█▌        | 3/20 [00:23<01:37,  5.74s/it]
Task 4, Epoch 4/20 => Loss 0.891, Train_accy 30.65:  20%|██        | 4/20 [00:23<01:25,  5.35s/it]
Task 4, Epoch 5/20 => Loss 0.651, Train_accy 40.28:  20%|██        | 4/20 [00:28<01:25,  5.35s/it]
Task 4, Epoch 5/20 => Loss 0.651, Train_accy 40.28:  25%|██▌       | 5/20 [00:28<01:16,  5.13s/it]
Task 4, Epoch 6/20 => Loss 0.487, Train_accy 46.41, Test_accy 22.58:  25%|██▌       | 5/20 [00:37<01:16,  5.13s/it]
Task 4, Epoch 6/20 => Loss 0.487, Train_accy 46.41, Test_accy 22.58:  30%|███       | 6/20 [00:37<01:31,  6.55s/it]
Task 4, Epoch 7/20 => Loss 0.399, Train_accy 49.21:  30%|███       | 6/20 [00:42<01:31,  6.55s/it]                 
Task 4, Epoch 7/20 => Loss 0.399, Train_accy 49.21:  35%|███▌      | 7/20 [00:42<01:17,  5.97s/it]
Task 4, Epoch 8/20 => Loss 0.249, Train_accy 56.74:  35%|███▌      | 7/20 [00:47<01:17,  5.97s/it]
Task 4, Epoch 8/20 => Loss 0.249, Train_accy 56.74:  40%|████      | 8/20 [00:47<01:07,  5.59s/it]
Task 4, Epoch 9/20 => Loss 0.249, Train_accy 57.62:  40%|████      | 8/20 [00:51<01:07,  5.59s/it]
Task 4, Epoch 9/20 => Loss 0.249, Train_accy 57.62:  45%|████▌     | 9/20 [00:51<00:58,  5.33s/it]
Task 4, Epoch 10/20 => Loss 0.269, Train_accy 62.70:  45%|████▌     | 9/20 [00:56<00:58,  5.33s/it]
Task 4, Epoch 10/20 => Loss 0.269, Train_accy 62.70:  50%|█████     | 10/20 [00:56<00:51,  5.16s/it]
Task 4, Epoch 11/20 => Loss 0.213, Train_accy 66.90, Test_accy 22.58:  50%|█████     | 10/20 [01:05<00:51,  5.16s/it]
Task 4, Epoch 11/20 => Loss 0.213, Train_accy 66.90, Test_accy 22.58:  55%|█████▌    | 11/20 [01:05<00:57,  6.43s/it]
Task 4, Epoch 12/20 => Loss 0.237, Train_accy 69.70:  55%|█████▌    | 11/20 [01:10<00:57,  6.43s/it]                 
Task 4, Epoch 12/20 => Loss 0.237, Train_accy 69.70:  60%|██████    | 12/20 [01:10<00:47,  5.93s/it]
Task 4, Epoch 13/20 => Loss 0.225, Train_accy 66.37:  60%|██████    | 12/20 [01:15<00:47,  5.93s/it]
Task 4, Epoch 13/20 => Loss 0.225, Train_accy 66.37:  65%|██████▌   | 13/20 [01:15<00:38,  5.57s/it]
Task 4, Epoch 14/20 => Loss 0.220, Train_accy 65.50:  65%|██████▌   | 13/20 [01:20<00:38,  5.57s/it]
Task 4, Epoch 14/20 => Loss 0.220, Train_accy 65.50:  70%|███████   | 14/20 [01:20<00:31,  5.32s/it]
Task 4, Epoch 15/20 => Loss 0.211, Train_accy 69.88:  70%|███████   | 14/20 [01:24<00:31,  5.32s/it]
Task 4, Epoch 15/20 => Loss 0.211, Train_accy 69.88:  75%|███████▌  | 15/20 [01:24<00:25,  5.15s/it]
Task 4, Epoch 16/20 => Loss 0.181, Train_accy 72.68, Test_accy 22.22:  75%|███████▌  | 15/20 [01:34<00:25,  5.15s/it]
Task 4, Epoch 16/20 => Loss 0.181, Train_accy 72.68, Test_accy 22.22:  80%|████████  | 16/20 [01:34<00:25,  6.39s/it]
Task 4, Epoch 17/20 => Loss 0.188, Train_accy 73.73:  80%|████████  | 16/20 [01:38<00:25,  6.39s/it]                 
Task 4, Epoch 17/20 => Loss 0.188, Train_accy 73.73:  85%|████████▌ | 17/20 [01:38<00:17,  5.91s/it]
Task 4, Epoch 18/20 => Loss 0.187, Train_accy 72.68:  85%|████████▌ | 17/20 [01:43<00:17,  5.91s/it]
Task 4, Epoch 18/20 => Loss 0.187, Train_accy 72.68:  90%|█████████ | 18/20 [01:43<00:11,  5.56s/it]
Task 4, Epoch 19/20 => Loss 0.151, Train_accy 76.36:  90%|█████████ | 18/20 [01:48<00:11,  5.56s/it]
Task 4, Epoch 19/20 => Loss 0.151, Train_accy 76.36:  95%|█████████▌| 19/20 [01:48<00:05,  5.31s/it]
Task 4, Epoch 20/20 => Loss 0.158, Train_accy 75.48:  95%|█████████▌| 19/20 [01:53<00:05,  5.31s/it]
Task 4, Epoch 20/20 => Loss 0.158, Train_accy 75.48: 100%|██████████| 20/20 [01:53<00:00,  5.14s/it]
Task 4, Epoch 20/20 => Loss 0.158, Train_accy 75.48: 100%|██████████| 20/20 [01:53<00:00,  5.66s/it]
2024-09-07 09:55:27,605 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.158, Train_accy 75.48
2024-09-07 09:55:32,103 [trainer.py] => No NME accuracy.
2024-09-07 09:55:32,104 [trainer.py] => CNN: {'total': 23.87, '00-99': 17.36, '100-119': 32.84, '120-139': 30.14, '140-159': 43.31, '160-179': 29.93, 'old': 23.16, 'new': 29.93}
2024-09-07 09:55:32,104 [trainer.py] => CNN top1 curve: [51.13, 38.56, 29.71, 22.28, 23.87]
2024-09-07 09:55:32,104 [trainer.py] => CNN top5 curve: [74.79, 67.28, 58.88, 48.0, 50.25]

Average Accuracy (CNN): 33.11
2024-09-07 09:55:32,104 [trainer.py] => Average Accuracy (CNN): 33.11 

2024-09-07 09:55:32,105 [trainer.py] => All params: 85937076
2024-09-07 09:55:32,106 [trainer.py] => Trainable params: 85937076
2024-09-07 09:55:32,111 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.132, Train_accy 1.90, Test_accy 17.51:   0%|          | 0/20 [00:09<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.132, Train_accy 1.90, Test_accy 17.51:   5%|▌         | 1/20 [00:09<02:55,  9.22s/it]
Task 5, Epoch 2/20 => Loss 1.445, Train_accy 19.54:   5%|▌         | 1/20 [00:13<02:55,  9.22s/it]                
Task 5, Epoch 2/20 => Loss 1.445, Train_accy 19.54:  10%|█         | 2/20 [00:13<01:55,  6.40s/it]
Task 5, Epoch 3/20 => Loss 0.889, Train_accy 42.13:  10%|█         | 2/20 [00:18<01:55,  6.40s/it]
Task 5, Epoch 3/20 => Loss 0.889, Train_accy 42.13:  15%|█▌        | 3/20 [00:18<01:33,  5.50s/it]
Task 5, Epoch 4/20 => Loss 0.656, Train_accy 55.79:  15%|█▌        | 3/20 [00:22<01:33,  5.50s/it]
Task 5, Epoch 4/20 => Loss 0.656, Train_accy 55.79:  20%|██        | 4/20 [00:22<01:21,  5.07s/it]
Task 5, Epoch 5/20 => Loss 0.452, Train_accy 64.33:  20%|██        | 4/20 [00:26<01:21,  5.07s/it]
Task 5, Epoch 5/20 => Loss 0.452, Train_accy 64.33:  25%|██▌       | 5/20 [00:26<01:12,  4.83s/it]
Task 5, Epoch 6/20 => Loss 0.395, Train_accy 70.59, Test_accy 19.22:  25%|██▌       | 5/20 [00:36<01:12,  4.83s/it]
Task 5, Epoch 6/20 => Loss 0.395, Train_accy 70.59, Test_accy 19.22:  30%|███       | 6/20 [00:36<01:28,  6.33s/it]
Task 5, Epoch 7/20 => Loss 0.250, Train_accy 74.95:  30%|███       | 6/20 [00:40<01:28,  6.33s/it]                 
Task 5, Epoch 7/20 => Loss 0.250, Train_accy 74.95:  35%|███▌      | 7/20 [00:40<01:14,  5.70s/it]
Task 5, Epoch 8/20 => Loss 0.244, Train_accy 76.85:  35%|███▌      | 7/20 [00:44<01:14,  5.70s/it]
Task 5, Epoch 8/20 => Loss 0.244, Train_accy 76.85:  40%|████      | 8/20 [00:44<01:03,  5.29s/it]
Task 5, Epoch 9/20 => Loss 0.229, Train_accy 80.65:  40%|████      | 8/20 [00:49<01:03,  5.29s/it]
Task 5, Epoch 9/20 => Loss 0.229, Train_accy 80.65:  45%|████▌     | 9/20 [00:49<00:55,  5.02s/it]
Task 5, Epoch 10/20 => Loss 0.177, Train_accy 80.83:  45%|████▌     | 9/20 [00:53<00:55,  5.02s/it]
Task 5, Epoch 10/20 => Loss 0.177, Train_accy 80.83:  50%|█████     | 10/20 [00:53<00:48,  4.83s/it]
Task 5, Epoch 11/20 => Loss 0.175, Train_accy 84.25, Test_accy 19.82:  50%|█████     | 10/20 [01:03<00:48,  4.83s/it]
Task 5, Epoch 11/20 => Loss 0.175, Train_accy 84.25, Test_accy 19.82:  55%|█████▌    | 11/20 [01:03<00:55,  6.19s/it]
Task 5, Epoch 12/20 => Loss 0.168, Train_accy 84.44:  55%|█████▌    | 11/20 [01:07<00:55,  6.19s/it]                 
Task 5, Epoch 12/20 => Loss 0.168, Train_accy 84.44:  60%|██████    | 12/20 [01:07<00:45,  5.64s/it]
Task 5, Epoch 13/20 => Loss 0.207, Train_accy 81.21:  60%|██████    | 12/20 [01:11<00:45,  5.64s/it]
Task 5, Epoch 13/20 => Loss 0.207, Train_accy 81.21:  65%|██████▌   | 13/20 [01:11<00:37,  5.30s/it]
Task 5, Epoch 14/20 => Loss 0.166, Train_accy 83.30:  65%|██████▌   | 13/20 [01:16<00:37,  5.30s/it]
Task 5, Epoch 14/20 => Loss 0.166, Train_accy 83.30:  70%|███████   | 14/20 [01:16<00:30,  5.04s/it]
Task 5, Epoch 15/20 => Loss 0.138, Train_accy 83.11:  70%|███████   | 14/20 [01:20<00:30,  5.04s/it]
Task 5, Epoch 15/20 => Loss 0.138, Train_accy 83.11:  75%|███████▌  | 15/20 [01:20<00:24,  4.86s/it]
Task 5, Epoch 16/20 => Loss 0.163, Train_accy 83.30, Test_accy 20.41:  75%|███████▌  | 15/20 [01:30<00:24,  4.86s/it]
Task 5, Epoch 16/20 => Loss 0.163, Train_accy 83.30, Test_accy 20.41:  80%|████████  | 16/20 [01:30<00:24,  6.19s/it]
Task 5, Epoch 17/20 => Loss 0.180, Train_accy 81.97:  80%|████████  | 16/20 [01:34<00:24,  6.19s/it]                 
Task 5, Epoch 17/20 => Loss 0.180, Train_accy 81.97:  85%|████████▌ | 17/20 [01:34<00:16,  5.66s/it]
Task 5, Epoch 18/20 => Loss 0.103, Train_accy 87.29:  85%|████████▌ | 17/20 [01:38<00:16,  5.66s/it]
Task 5, Epoch 18/20 => Loss 0.103, Train_accy 87.29:  90%|█████████ | 18/20 [01:38<00:10,  5.29s/it]
Task 5, Epoch 19/20 => Loss 0.140, Train_accy 88.05:  90%|█████████ | 18/20 [01:43<00:10,  5.29s/it]
Task 5, Epoch 19/20 => Loss 0.140, Train_accy 88.05:  95%|█████████▌| 19/20 [01:43<00:05,  5.03s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 86.15:  95%|█████████▌| 19/20 [01:47<00:05,  5.03s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 86.15: 100%|██████████| 20/20 [01:47<00:00,  4.85s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 86.15: 100%|██████████| 20/20 [01:47<00:00,  5.39s/it]
2024-09-07 09:57:19,959 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.092, Train_accy 86.15
2024-09-07 09:57:24,852 [trainer.py] => No NME accuracy.
2024-09-07 09:57:24,853 [trainer.py] => CNN: {'total': 21.4, '00-99': 15.22, '100-119': 26.87, '120-139': 21.92, '140-159': 34.65, '160-179': 17.69, '180-199': 47.58, 'old': 19.07, 'new': 47.58}
2024-09-07 09:57:24,853 [trainer.py] => CNN top1 curve: [51.13, 38.56, 29.71, 22.28, 23.87, 21.4]
2024-09-07 09:57:24,853 [trainer.py] => CNN top5 curve: [74.79, 67.28, 58.88, 48.0, 50.25, 47.47]

Average Accuracy (CNN): 31.16
2024-09-07 09:57:24,853 [trainer.py] => Average Accuracy (CNN): 31.16 

Accuracy Matrix (CNN):
[[51.13 36.03 24.61 17.72 17.36 15.22]
 [ 0.   54.48 43.28 32.09 32.84 26.87]
 [ 0.    0.   46.58 25.34 30.14 21.92]
 [ 0.    0.    0.   38.58 43.31 34.65]
 [ 0.    0.    0.    0.   29.93 17.69]
 [ 0.    0.    0.    0.    0.   47.58]]
2024-09-07 09:57:24,855 [trainer.py] => Forgetting (CNN): 21.816
2024-09-07 09:57:27,574 [trainer.py] => config: ./exps/finetune_ina_B100_Inc10.json
2024-09-07 09:57:27,574 [trainer.py] => prefix: reproduce
2024-09-07 09:57:27,575 [trainer.py] => dataset: imageneta
2024-09-07 09:57:27,575 [trainer.py] => memory_size: 0
2024-09-07 09:57:27,575 [trainer.py] => memory_per_class: 0
2024-09-07 09:57:27,575 [trainer.py] => fixed_memory: False
2024-09-07 09:57:27,575 [trainer.py] => shuffle: True
2024-09-07 09:57:27,575 [trainer.py] => init_cls: 100
2024-09-07 09:57:27,575 [trainer.py] => increment: 10
2024-09-07 09:57:27,575 [trainer.py] => model_name: finetune
2024-09-07 09:57:27,575 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 09:57:27,575 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 09:57:27,575 [trainer.py] => seed: 1993
2024-09-07 09:57:27,575 [trainer.py] => init_epoch: 20
2024-09-07 09:57:27,575 [trainer.py] => init_lr: 0.001
2024-09-07 09:57:27,575 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 09:57:27,575 [trainer.py] => init_lr_decay: 0.1
2024-09-07 09:57:27,575 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 09:57:27,575 [trainer.py] => epochs: 20
2024-09-07 09:57:27,575 [trainer.py] => lrate: 0.001
2024-09-07 09:57:27,575 [trainer.py] => milestones: [40, 70]
2024-09-07 09:57:27,575 [trainer.py] => lrate_decay: 0.1
2024-09-07 09:57:27,575 [trainer.py] => batch_size: 48
2024-09-07 09:57:27,575 [trainer.py] => weight_decay: 0.0002
2024-09-07 09:57:27,601 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 09:57:29,304 [trainer.py] => All params: 85798656
2024-09-07 09:57:29,305 [trainer.py] => Trainable params: 85798656
2024-09-07 09:57:29,306 [finetune.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.512, Train_accy 2.04, Test_accy 2.02:   0%|          | 0/20 [00:28<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.512, Train_accy 2.04, Test_accy 2.02:   5%|▌         | 1/20 [00:28<09:04, 28.64s/it]
Task 0, Epoch 2/20 => Loss 4.337, Train_accy 3.65:   5%|▌         | 1/20 [00:54<09:04, 28.64s/it]                
Task 0, Epoch 2/20 => Loss 4.337, Train_accy 3.65:  10%|█         | 2/20 [00:54<08:05, 26.98s/it]
Task 0, Epoch 3/20 => Loss 4.125, Train_accy 7.26:  10%|█         | 2/20 [01:20<08:05, 26.98s/it]
Task 0, Epoch 3/20 => Loss 4.125, Train_accy 7.26:  15%|█▌        | 3/20 [01:20<07:28, 26.41s/it]
Task 0, Epoch 4/20 => Loss 3.424, Train_accy 19.42:  15%|█▌        | 3/20 [01:45<07:28, 26.41s/it]
Task 0, Epoch 4/20 => Loss 3.424, Train_accy 19.42:  20%|██        | 4/20 [01:45<06:58, 26.13s/it]
Task 0, Epoch 5/20 => Loss 2.583, Train_accy 36.87:  20%|██        | 4/20 [02:11<06:58, 26.13s/it]
Task 0, Epoch 5/20 => Loss 2.583, Train_accy 36.87:  25%|██▌       | 5/20 [02:11<06:29, 25.94s/it]
Task 0, Epoch 6/20 => Loss 2.075, Train_accy 48.21, Test_accy 42.93:  25%|██▌       | 5/20 [02:39<06:29, 25.94s/it]
Task 0, Epoch 6/20 => Loss 2.075, Train_accy 48.21, Test_accy 42.93:  30%|███       | 6/20 [02:39<06:15, 26.80s/it]
Task 0, Epoch 7/20 => Loss 1.619, Train_accy 57.54:  30%|███       | 6/20 [03:05<06:15, 26.80s/it]                 
Task 0, Epoch 7/20 => Loss 1.619, Train_accy 57.54:  35%|███▌      | 7/20 [03:05<05:43, 26.44s/it]
Task 0, Epoch 8/20 => Loss 1.430, Train_accy 62.46:  35%|███▌      | 7/20 [03:31<05:43, 26.44s/it]
Task 0, Epoch 8/20 => Loss 1.430, Train_accy 62.46:  40%|████      | 8/20 [03:31<05:14, 26.17s/it]
Task 0, Epoch 9/20 => Loss 1.091, Train_accy 70.73:  40%|████      | 8/20 [03:56<05:14, 26.17s/it]
Task 0, Epoch 9/20 => Loss 1.091, Train_accy 70.73:  45%|████▌     | 9/20 [03:56<04:45, 25.97s/it]
Task 0, Epoch 10/20 => Loss 0.902, Train_accy 76.50:  45%|████▌     | 9/20 [04:22<04:45, 25.97s/it]
Task 0, Epoch 10/20 => Loss 0.902, Train_accy 76.50:  50%|█████     | 10/20 [04:22<04:18, 25.85s/it]
Task 0, Epoch 11/20 => Loss 0.808, Train_accy 78.60, Test_accy 45.78:  50%|█████     | 10/20 [04:50<04:18, 25.85s/it]
Task 0, Epoch 11/20 => Loss 0.808, Train_accy 78.60, Test_accy 45.78:  55%|█████▌    | 11/20 [04:50<03:59, 26.66s/it]
Task 0, Epoch 12/20 => Loss 0.650, Train_accy 82.43:  55%|█████▌    | 11/20 [05:16<03:59, 26.66s/it]                 
Task 0, Epoch 12/20 => Loss 0.650, Train_accy 82.43:  60%|██████    | 12/20 [05:16<03:30, 26.36s/it]
Task 0, Epoch 13/20 => Loss 0.624, Train_accy 83.34:  60%|██████    | 12/20 [05:42<03:30, 26.36s/it]
Task 0, Epoch 13/20 => Loss 0.624, Train_accy 83.34:  65%|██████▌   | 13/20 [05:42<03:03, 26.15s/it]
Task 0, Epoch 14/20 => Loss 0.566, Train_accy 84.95:  65%|██████▌   | 13/20 [06:07<03:03, 26.15s/it]
Task 0, Epoch 14/20 => Loss 0.566, Train_accy 84.95:  70%|███████   | 14/20 [06:07<02:35, 25.98s/it]
Task 0, Epoch 15/20 => Loss 0.527, Train_accy 86.02:  70%|███████   | 14/20 [06:33<02:35, 25.98s/it]
Task 0, Epoch 15/20 => Loss 0.527, Train_accy 86.02:  75%|███████▌  | 15/20 [06:33<02:09, 25.87s/it]
Task 0, Epoch 16/20 => Loss 0.455, Train_accy 87.69, Test_accy 46.73:  75%|███████▌  | 15/20 [07:01<02:09, 25.87s/it]
Task 0, Epoch 16/20 => Loss 0.455, Train_accy 87.69, Test_accy 46.73:  80%|████████  | 16/20 [07:01<01:46, 26.66s/it]
Task 0, Epoch 17/20 => Loss 0.420, Train_accy 88.48:  80%|████████  | 16/20 [07:27<01:46, 26.66s/it]                 
Task 0, Epoch 17/20 => Loss 0.420, Train_accy 88.48:  85%|████████▌ | 17/20 [07:27<01:19, 26.36s/it]
Task 0, Epoch 18/20 => Loss 0.398, Train_accy 89.21:  85%|████████▌ | 17/20 [07:53<01:19, 26.36s/it]
Task 0, Epoch 18/20 => Loss 0.398, Train_accy 89.21:  90%|█████████ | 18/20 [07:53<00:52, 26.15s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.82:  90%|█████████ | 18/20 [08:18<00:52, 26.15s/it]
Task 0, Epoch 19/20 => Loss 0.381, Train_accy 89.82:  95%|█████████▌| 19/20 [08:18<00:25, 26.00s/it]
Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12:  95%|█████████▌| 19/20 [08:44<00:25, 26.00s/it]
Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12: 100%|██████████| 20/20 [08:44<00:00, 25.88s/it]
Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12: 100%|██████████| 20/20 [08:44<00:00, 26.22s/it]
2024-09-07 10:06:14,234 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.374, Train_accy 90.12
2024-09-07 10:06:17,203 [trainer.py] => No NME accuracy.
2024-09-07 10:06:17,203 [trainer.py] => CNN: {'total': 51.13, '00-99': 51.13, 'old': 0, 'new': 51.13}
2024-09-07 10:06:17,203 [trainer.py] => CNN top1 curve: [51.13]
2024-09-07 10:06:17,203 [trainer.py] => CNN top5 curve: [74.79]

Average Accuracy (CNN): 51.13
2024-09-07 10:06:17,204 [trainer.py] => Average Accuracy (CNN): 51.13 

2024-09-07 10:06:17,205 [trainer.py] => All params: 85875556
2024-09-07 10:06:17,205 [trainer.py] => Trainable params: 85875556
2024-09-07 10:06:17,208 [finetune.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.656, Train_accy 3.67, Test_accy 41.95:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.656, Train_accy 3.67, Test_accy 41.95:   5%|▌         | 1/20 [00:05<01:40,  5.29s/it]
Task 1, Epoch 2/20 => Loss 1.040, Train_accy 33.06:   5%|▌         | 1/20 [00:07<01:40,  5.29s/it]                
Task 1, Epoch 2/20 => Loss 1.040, Train_accy 33.06:  10%|█         | 2/20 [00:07<01:03,  3.51s/it]
Task 1, Epoch 3/20 => Loss 0.661, Train_accy 56.73:  10%|█         | 2/20 [00:09<01:03,  3.51s/it]
Task 1, Epoch 3/20 => Loss 0.661, Train_accy 56.73:  15%|█▌        | 3/20 [00:09<00:49,  2.93s/it]
Task 1, Epoch 4/20 => Loss 0.546, Train_accy 65.71:  15%|█▌        | 3/20 [00:12<00:49,  2.93s/it]
Task 1, Epoch 4/20 => Loss 0.546, Train_accy 65.71:  20%|██        | 4/20 [00:12<00:42,  2.65s/it]
Task 1, Epoch 5/20 => Loss 0.535, Train_accy 75.92:  20%|██        | 4/20 [00:14<00:42,  2.65s/it]
Task 1, Epoch 5/20 => Loss 0.535, Train_accy 75.92:  25%|██▌       | 5/20 [00:14<00:37,  2.53s/it]
Task 1, Epoch 6/20 => Loss 0.424, Train_accy 79.59, Test_accy 26.97:  25%|██▌       | 5/20 [00:19<00:37,  2.53s/it]
Task 1, Epoch 6/20 => Loss 0.424, Train_accy 79.59, Test_accy 26.97:  30%|███       | 6/20 [00:19<00:48,  3.47s/it]
Task 1, Epoch 7/20 => Loss 0.394, Train_accy 77.14:  30%|███       | 6/20 [00:21<00:48,  3.47s/it]                 
Task 1, Epoch 7/20 => Loss 0.394, Train_accy 77.14:  35%|███▌      | 7/20 [00:21<00:39,  3.08s/it]
Task 1, Epoch 8/20 => Loss 0.205, Train_accy 89.39:  35%|███▌      | 7/20 [00:24<00:39,  3.08s/it]
Task 1, Epoch 8/20 => Loss 0.205, Train_accy 89.39:  40%|████      | 8/20 [00:24<00:33,  2.82s/it]
Task 1, Epoch 9/20 => Loss 0.264, Train_accy 86.94:  40%|████      | 8/20 [00:26<00:33,  2.82s/it]
Task 1, Epoch 9/20 => Loss 0.264, Train_accy 86.94:  45%|████▌     | 9/20 [00:26<00:28,  2.64s/it]
Task 1, Epoch 10/20 => Loss 0.211, Train_accy 84.49:  45%|████▌     | 9/20 [00:28<00:28,  2.64s/it]
Task 1, Epoch 10/20 => Loss 0.211, Train_accy 84.49:  50%|█████     | 10/20 [00:28<00:25,  2.53s/it]
Task 1, Epoch 11/20 => Loss 0.196, Train_accy 86.94, Test_accy 27.52:  50%|█████     | 10/20 [00:33<00:25,  2.53s/it]
Task 1, Epoch 11/20 => Loss 0.196, Train_accy 86.94, Test_accy 27.52:  55%|█████▌    | 11/20 [00:33<00:30,  3.37s/it]
Task 1, Epoch 12/20 => Loss 0.264, Train_accy 86.12:  55%|█████▌    | 11/20 [00:36<00:30,  3.37s/it]                 
Task 1, Epoch 12/20 => Loss 0.264, Train_accy 86.12:  60%|██████    | 12/20 [00:36<00:24,  3.03s/it]
Task 1, Epoch 13/20 => Loss 0.176, Train_accy 89.39:  60%|██████    | 12/20 [00:38<00:24,  3.03s/it]
Task 1, Epoch 13/20 => Loss 0.176, Train_accy 89.39:  65%|██████▌   | 13/20 [00:38<00:19,  2.80s/it]
Task 1, Epoch 14/20 => Loss 0.107, Train_accy 90.61:  65%|██████▌   | 13/20 [00:40<00:19,  2.80s/it]
Task 1, Epoch 14/20 => Loss 0.107, Train_accy 90.61:  70%|███████   | 14/20 [00:40<00:15,  2.63s/it]
Task 1, Epoch 15/20 => Loss 0.066, Train_accy 93.47:  70%|███████   | 14/20 [00:42<00:15,  2.63s/it]
Task 1, Epoch 15/20 => Loss 0.066, Train_accy 93.47:  75%|███████▌  | 15/20 [00:42<00:12,  2.51s/it]
Task 1, Epoch 16/20 => Loss 0.106, Train_accy 92.24, Test_accy 27.64:  75%|███████▌  | 15/20 [00:48<00:12,  2.51s/it]
Task 1, Epoch 16/20 => Loss 0.106, Train_accy 92.24, Test_accy 27.64:  80%|████████  | 16/20 [00:48<00:13,  3.33s/it]
Task 1, Epoch 17/20 => Loss 0.083, Train_accy 93.47:  80%|████████  | 16/20 [00:50<00:13,  3.33s/it]                 
Task 1, Epoch 17/20 => Loss 0.083, Train_accy 93.47:  85%|████████▌ | 17/20 [00:50<00:09,  3.01s/it]
Task 1, Epoch 18/20 => Loss 0.047, Train_accy 95.92:  85%|████████▌ | 17/20 [00:52<00:09,  3.01s/it]
Task 1, Epoch 18/20 => Loss 0.047, Train_accy 95.92:  90%|█████████ | 18/20 [00:52<00:05,  2.79s/it]
Task 1, Epoch 19/20 => Loss 0.043, Train_accy 94.29:  90%|█████████ | 18/20 [00:54<00:05,  2.79s/it]
Task 1, Epoch 19/20 => Loss 0.043, Train_accy 94.29:  95%|█████████▌| 19/20 [00:54<00:02,  2.63s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 94.69:  95%|█████████▌| 19/20 [00:57<00:02,  2.63s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 94.69: 100%|██████████| 20/20 [00:57<00:00,  2.52s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 94.69: 100%|██████████| 20/20 [00:57<00:00,  2.86s/it]
2024-09-07 10:07:14,454 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.083, Train_accy 94.69
2024-09-07 10:07:17,498 [trainer.py] => No NME accuracy.
2024-09-07 10:07:17,498 [trainer.py] => CNN: {'total': 29.3, '00-99': 26.52, '100-109': 68.33, 'old': 26.52, 'new': 68.33}
2024-09-07 10:07:17,499 [trainer.py] => CNN top1 curve: [51.13, 29.3]
2024-09-07 10:07:17,499 [trainer.py] => CNN top5 curve: [74.79, 65.59]

Average Accuracy (CNN): 40.22
2024-09-07 10:07:17,499 [trainer.py] => Average Accuracy (CNN): 40.22 

2024-09-07 10:07:17,500 [trainer.py] => All params: 85883246
2024-09-07 10:07:17,501 [trainer.py] => Trainable params: 85883246
2024-09-07 10:07:17,504 [finetune.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.232, Train_accy 1.44, Test_accy 25.85:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.232, Train_accy 1.44, Test_accy 25.85:   5%|▌         | 1/20 [00:05<01:49,  5.78s/it]
Task 2, Epoch 2/20 => Loss 1.056, Train_accy 17.27:   5%|▌         | 1/20 [00:08<01:49,  5.78s/it]                
Task 2, Epoch 2/20 => Loss 1.056, Train_accy 17.27:  10%|█         | 2/20 [00:08<01:10,  3.89s/it]
Task 2, Epoch 3/20 => Loss 0.682, Train_accy 41.37:  10%|█         | 2/20 [00:10<01:10,  3.89s/it]
Task 2, Epoch 3/20 => Loss 0.682, Train_accy 41.37:  15%|█▌        | 3/20 [00:10<00:55,  3.26s/it]
Task 2, Epoch 4/20 => Loss 0.484, Train_accy 60.07:  15%|█▌        | 3/20 [00:13<00:55,  3.26s/it]
Task 2, Epoch 4/20 => Loss 0.484, Train_accy 60.07:  20%|██        | 4/20 [00:13<00:47,  2.97s/it]
Task 2, Epoch 5/20 => Loss 0.311, Train_accy 66.91:  20%|██        | 4/20 [00:15<00:47,  2.97s/it]
Task 2, Epoch 5/20 => Loss 0.311, Train_accy 66.91:  25%|██▌       | 5/20 [00:15<00:41,  2.80s/it]
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 71.58, Test_accy 31.59:  25%|██▌       | 5/20 [00:21<00:41,  2.80s/it]
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 71.58, Test_accy 31.59:  30%|███       | 6/20 [00:21<00:53,  3.81s/it]
Task 2, Epoch 7/20 => Loss 0.229, Train_accy 73.02:  30%|███       | 6/20 [00:24<00:53,  3.81s/it]                 
Task 2, Epoch 7/20 => Loss 0.229, Train_accy 73.02:  35%|███▌      | 7/20 [00:24<00:44,  3.38s/it]
Task 2, Epoch 8/20 => Loss 0.146, Train_accy 79.14:  35%|███▌      | 7/20 [00:26<00:44,  3.38s/it]
Task 2, Epoch 8/20 => Loss 0.146, Train_accy 79.14:  40%|████      | 8/20 [00:26<00:37,  3.11s/it]
Task 2, Epoch 9/20 => Loss 0.182, Train_accy 76.26:  40%|████      | 8/20 [00:29<00:37,  3.11s/it]
Task 2, Epoch 9/20 => Loss 0.182, Train_accy 76.26:  45%|████▌     | 9/20 [00:29<00:32,  2.93s/it]
Task 2, Epoch 10/20 => Loss 0.094, Train_accy 82.37:  45%|████▌     | 9/20 [00:31<00:32,  2.93s/it]
Task 2, Epoch 10/20 => Loss 0.094, Train_accy 82.37:  50%|█████     | 10/20 [00:31<00:27,  2.80s/it]
Task 2, Epoch 11/20 => Loss 0.077, Train_accy 80.22, Test_accy 31.49:  50%|█████     | 10/20 [00:37<00:27,  2.80s/it]
Task 2, Epoch 11/20 => Loss 0.077, Train_accy 80.22, Test_accy 31.49:  55%|█████▌    | 11/20 [00:37<00:33,  3.69s/it]
Task 2, Epoch 12/20 => Loss 0.099, Train_accy 79.86:  55%|█████▌    | 11/20 [00:39<00:33,  3.69s/it]                 
Task 2, Epoch 12/20 => Loss 0.099, Train_accy 79.86:  60%|██████    | 12/20 [00:39<00:26,  3.33s/it]
Task 2, Epoch 13/20 => Loss 0.097, Train_accy 79.50:  60%|██████    | 12/20 [00:42<00:26,  3.33s/it]
Task 2, Epoch 13/20 => Loss 0.097, Train_accy 79.50:  65%|██████▌   | 13/20 [00:42<00:21,  3.07s/it]
Task 2, Epoch 14/20 => Loss 0.102, Train_accy 77.34:  65%|██████▌   | 13/20 [00:44<00:21,  3.07s/it]
Task 2, Epoch 14/20 => Loss 0.102, Train_accy 77.34:  70%|███████   | 14/20 [00:44<00:17,  2.90s/it]
Task 2, Epoch 15/20 => Loss 0.098, Train_accy 80.22:  70%|███████   | 14/20 [00:47<00:17,  2.90s/it]
Task 2, Epoch 15/20 => Loss 0.098, Train_accy 80.22:  75%|███████▌  | 15/20 [00:47<00:13,  2.80s/it]
Task 2, Epoch 16/20 => Loss 0.073, Train_accy 80.58, Test_accy 29.95:  75%|███████▌  | 15/20 [00:53<00:13,  2.80s/it]
Task 2, Epoch 16/20 => Loss 0.073, Train_accy 80.58, Test_accy 29.95:  80%|████████  | 16/20 [00:53<00:14,  3.69s/it]
Task 2, Epoch 17/20 => Loss 0.086, Train_accy 77.34:  80%|████████  | 16/20 [00:55<00:14,  3.69s/it]                 
Task 2, Epoch 17/20 => Loss 0.086, Train_accy 77.34:  85%|████████▌ | 17/20 [00:55<00:09,  3.33s/it]
Task 2, Epoch 18/20 => Loss 0.137, Train_accy 82.73:  85%|████████▌ | 17/20 [00:58<00:09,  3.33s/it]
Task 2, Epoch 18/20 => Loss 0.137, Train_accy 82.73:  90%|█████████ | 18/20 [00:58<00:06,  3.07s/it]
Task 2, Epoch 19/20 => Loss 0.057, Train_accy 81.29:  90%|█████████ | 18/20 [01:00<00:06,  3.07s/it]
Task 2, Epoch 19/20 => Loss 0.057, Train_accy 81.29:  95%|█████████▌| 19/20 [01:00<00:02,  2.89s/it]
Task 2, Epoch 20/20 => Loss 0.112, Train_accy 85.25:  95%|█████████▌| 19/20 [01:03<00:02,  2.89s/it]
Task 2, Epoch 20/20 => Loss 0.112, Train_accy 85.25: 100%|██████████| 20/20 [01:03<00:00,  2.77s/it]
Task 2, Epoch 20/20 => Loss 0.112, Train_accy 85.25: 100%|██████████| 20/20 [01:03<00:00,  3.16s/it]
2024-09-07 10:08:20,687 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.112, Train_accy 85.25
2024-09-07 10:08:23,918 [trainer.py] => No NME accuracy.
2024-09-07 10:08:23,918 [trainer.py] => CNN: {'total': 28.82, '00-99': 24.14, '100-109': 61.67, '110-119': 55.41, 'old': 26.64, 'new': 55.41}
2024-09-07 10:08:23,918 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82]
2024-09-07 10:08:23,918 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67]

Average Accuracy (CNN): 36.42
2024-09-07 10:08:23,918 [trainer.py] => Average Accuracy (CNN): 36.42 

2024-09-07 10:08:23,919 [trainer.py] => All params: 85890936
2024-09-07 10:08:23,919 [trainer.py] => Trainable params: 85890936
2024-09-07 10:08:23,921 [finetune.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.190, Train_accy 0.00, Test_accy 25.31:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.190, Train_accy 0.00, Test_accy 25.31:   5%|▌         | 1/20 [00:05<01:44,  5.51s/it]
Task 3, Epoch 2/20 => Loss 1.614, Train_accy 1.30:   5%|▌         | 1/20 [00:07<01:44,  5.51s/it]                 
Task 3, Epoch 2/20 => Loss 1.614, Train_accy 1.30:  10%|█         | 2/20 [00:07<01:03,  3.52s/it]
Task 3, Epoch 3/20 => Loss 1.054, Train_accy 5.65:  10%|█         | 2/20 [00:09<01:03,  3.52s/it]
Task 3, Epoch 3/20 => Loss 1.054, Train_accy 5.65:  15%|█▌        | 3/20 [00:09<00:49,  2.89s/it]
Task 3, Epoch 4/20 => Loss 0.778, Train_accy 17.83:  15%|█▌        | 3/20 [00:11<00:49,  2.89s/it]
Task 3, Epoch 4/20 => Loss 0.778, Train_accy 17.83:  20%|██        | 4/20 [00:11<00:41,  2.60s/it]
Task 3, Epoch 5/20 => Loss 0.515, Train_accy 31.30:  20%|██        | 4/20 [00:14<00:41,  2.60s/it]
Task 3, Epoch 5/20 => Loss 0.515, Train_accy 31.30:  25%|██▌       | 5/20 [00:14<00:36,  2.42s/it]
Task 3, Epoch 6/20 => Loss 0.457, Train_accy 41.30, Test_accy 25.41:  25%|██▌       | 5/20 [00:19<00:36,  2.42s/it]
Task 3, Epoch 6/20 => Loss 0.457, Train_accy 41.30, Test_accy 25.41:  30%|███       | 6/20 [00:19<00:48,  3.48s/it]
Task 3, Epoch 7/20 => Loss 0.314, Train_accy 46.09:  30%|███       | 6/20 [00:21<00:48,  3.48s/it]                 
Task 3, Epoch 7/20 => Loss 0.314, Train_accy 46.09:  35%|███▌      | 7/20 [00:21<00:39,  3.03s/it]
Task 3, Epoch 8/20 => Loss 0.298, Train_accy 60.43:  35%|███▌      | 7/20 [00:23<00:39,  3.03s/it]
Task 3, Epoch 8/20 => Loss 0.298, Train_accy 60.43:  40%|████      | 8/20 [00:23<00:32,  2.73s/it]
Task 3, Epoch 9/20 => Loss 0.176, Train_accy 67.83:  40%|████      | 8/20 [00:25<00:32,  2.73s/it]
Task 3, Epoch 9/20 => Loss 0.176, Train_accy 67.83:  45%|████▌     | 9/20 [00:25<00:27,  2.54s/it]
Task 3, Epoch 10/20 => Loss 0.150, Train_accy 66.09:  45%|████▌     | 9/20 [00:28<00:27,  2.54s/it]
Task 3, Epoch 10/20 => Loss 0.150, Train_accy 66.09:  50%|█████     | 10/20 [00:28<00:24,  2.41s/it]
Task 3, Epoch 11/20 => Loss 0.153, Train_accy 66.52, Test_accy 25.51:  50%|█████     | 10/20 [00:33<00:24,  2.41s/it]
Task 3, Epoch 11/20 => Loss 0.153, Train_accy 66.52, Test_accy 25.51:  55%|█████▌    | 11/20 [00:33<00:31,  3.48s/it]
Task 3, Epoch 12/20 => Loss 0.141, Train_accy 66.52:  55%|█████▌    | 11/20 [00:36<00:31,  3.48s/it]                 
Task 3, Epoch 12/20 => Loss 0.141, Train_accy 66.52:  60%|██████    | 12/20 [00:36<00:24,  3.07s/it]
Task 3, Epoch 13/20 => Loss 0.152, Train_accy 71.30:  60%|██████    | 12/20 [00:38<00:24,  3.07s/it]
Task 3, Epoch 13/20 => Loss 0.152, Train_accy 71.30:  65%|██████▌   | 13/20 [00:38<00:19,  2.78s/it]
Task 3, Epoch 14/20 => Loss 0.094, Train_accy 71.74:  65%|██████▌   | 13/20 [00:40<00:19,  2.78s/it]
Task 3, Epoch 14/20 => Loss 0.094, Train_accy 71.74:  70%|███████   | 14/20 [00:40<00:15,  2.57s/it]
Task 3, Epoch 15/20 => Loss 0.129, Train_accy 70.87:  70%|███████   | 14/20 [00:42<00:15,  2.57s/it]
Task 3, Epoch 15/20 => Loss 0.129, Train_accy 70.87:  75%|███████▌  | 15/20 [00:42<00:12,  2.42s/it]
Task 3, Epoch 16/20 => Loss 0.093, Train_accy 73.48, Test_accy 25.99:  75%|███████▌  | 15/20 [00:47<00:12,  2.42s/it]
Task 3, Epoch 16/20 => Loss 0.093, Train_accy 73.48, Test_accy 25.99:  80%|████████  | 16/20 [00:47<00:13,  3.34s/it]
Task 3, Epoch 17/20 => Loss 0.087, Train_accy 73.48:  80%|████████  | 16/20 [00:49<00:13,  3.34s/it]                 
Task 3, Epoch 17/20 => Loss 0.087, Train_accy 73.48:  85%|████████▌ | 17/20 [00:49<00:08,  2.97s/it]
Task 3, Epoch 18/20 => Loss 0.098, Train_accy 71.74:  85%|████████▌ | 17/20 [00:52<00:08,  2.97s/it]
Task 3, Epoch 18/20 => Loss 0.098, Train_accy 71.74:  90%|█████████ | 18/20 [00:52<00:05,  2.71s/it]
Task 3, Epoch 19/20 => Loss 0.145, Train_accy 73.91:  90%|█████████ | 18/20 [00:54<00:05,  2.71s/it]
Task 3, Epoch 19/20 => Loss 0.145, Train_accy 73.91:  95%|█████████▌| 19/20 [00:54<00:02,  2.52s/it]
Task 3, Epoch 20/20 => Loss 0.093, Train_accy 78.26:  95%|█████████▌| 19/20 [00:56<00:02,  2.52s/it]
Task 3, Epoch 20/20 => Loss 0.093, Train_accy 78.26: 100%|██████████| 20/20 [00:56<00:00,  2.40s/it]
Task 3, Epoch 20/20 => Loss 0.093, Train_accy 78.26: 100%|██████████| 20/20 [00:56<00:00,  2.81s/it]
2024-09-07 10:09:20,147 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.093, Train_accy 78.26
2024-09-07 10:09:23,608 [trainer.py] => No NME accuracy.
2024-09-07 10:09:23,608 [trainer.py] => CNN: {'total': 26.47, '00-99': 21.64, '100-109': 55.0, '110-119': 50.0, '120-129': 36.67, 'old': 25.85, 'new': 36.67}
2024-09-07 10:09:23,609 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47]
2024-09-07 10:09:23,609 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36]

Average Accuracy (CNN): 33.93
2024-09-07 10:09:23,609 [trainer.py] => Average Accuracy (CNN): 33.93 

2024-09-07 10:09:23,610 [trainer.py] => All params: 85898626
2024-09-07 10:09:23,611 [trainer.py] => Trainable params: 85898626
2024-09-07 10:09:23,615 [finetune.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.435, Train_accy 0.97, Test_accy 23.64:   0%|          | 0/20 [00:06<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.435, Train_accy 0.97, Test_accy 23.64:   5%|▌         | 1/20 [00:06<02:01,  6.39s/it]
Task 4, Epoch 2/20 => Loss 0.840, Train_accy 5.83:   5%|▌         | 1/20 [00:09<02:01,  6.39s/it]                 
Task 4, Epoch 2/20 => Loss 0.840, Train_accy 5.83:  10%|█         | 2/20 [00:09<01:16,  4.24s/it]
Task 4, Epoch 3/20 => Loss 0.588, Train_accy 26.21:  10%|█         | 2/20 [00:11<01:16,  4.24s/it]
Task 4, Epoch 3/20 => Loss 0.588, Train_accy 26.21:  15%|█▌        | 3/20 [00:11<01:00,  3.56s/it]
Task 4, Epoch 4/20 => Loss 0.438, Train_accy 44.66:  15%|█▌        | 3/20 [00:14<01:00,  3.56s/it]
Task 4, Epoch 4/20 => Loss 0.438, Train_accy 44.66:  20%|██        | 4/20 [00:14<00:51,  3.24s/it]
Task 4, Epoch 5/20 => Loss 0.319, Train_accy 53.40:  20%|██        | 4/20 [00:17<00:51,  3.24s/it]
Task 4, Epoch 5/20 => Loss 0.319, Train_accy 53.40:  25%|██▌       | 5/20 [00:17<00:45,  3.06s/it]
Task 4, Epoch 6/20 => Loss 0.223, Train_accy 58.58, Test_accy 23.10:  25%|██▌       | 5/20 [00:23<00:45,  3.06s/it]
Task 4, Epoch 6/20 => Loss 0.223, Train_accy 58.58, Test_accy 23.10:  30%|███       | 6/20 [00:23<00:58,  4.19s/it]
Task 4, Epoch 7/20 => Loss 0.179, Train_accy 67.31:  30%|███       | 6/20 [00:26<00:58,  4.19s/it]                 
Task 4, Epoch 7/20 => Loss 0.179, Train_accy 67.31:  35%|███▌      | 7/20 [00:26<00:48,  3.71s/it]
Task 4, Epoch 8/20 => Loss 0.203, Train_accy 71.20:  35%|███▌      | 7/20 [00:29<00:48,  3.71s/it]
Task 4, Epoch 8/20 => Loss 0.203, Train_accy 71.20:  40%|████      | 8/20 [00:29<00:40,  3.40s/it]
Task 4, Epoch 9/20 => Loss 0.243, Train_accy 72.17:  40%|████      | 8/20 [00:31<00:40,  3.40s/it]
Task 4, Epoch 9/20 => Loss 0.243, Train_accy 72.17:  45%|████▌     | 9/20 [00:31<00:35,  3.19s/it]
Task 4, Epoch 10/20 => Loss 0.134, Train_accy 70.23:  45%|████▌     | 9/20 [00:34<00:35,  3.19s/it]
Task 4, Epoch 10/20 => Loss 0.134, Train_accy 70.23:  50%|█████     | 10/20 [00:34<00:30,  3.05s/it]
Task 4, Epoch 11/20 => Loss 0.135, Train_accy 74.11, Test_accy 23.10:  50%|█████     | 10/20 [00:41<00:30,  3.05s/it]
Task 4, Epoch 11/20 => Loss 0.135, Train_accy 74.11, Test_accy 23.10:  55%|█████▌    | 11/20 [00:41<00:36,  4.07s/it]
Task 4, Epoch 12/20 => Loss 0.124, Train_accy 70.87:  55%|█████▌    | 11/20 [00:43<00:36,  4.07s/it]                 
Task 4, Epoch 12/20 => Loss 0.124, Train_accy 70.87:  60%|██████    | 12/20 [00:43<00:29,  3.66s/it]
Task 4, Epoch 13/20 => Loss 0.075, Train_accy 72.49:  60%|██████    | 12/20 [00:46<00:29,  3.66s/it]
Task 4, Epoch 13/20 => Loss 0.075, Train_accy 72.49:  65%|██████▌   | 13/20 [00:46<00:23,  3.40s/it]
Task 4, Epoch 14/20 => Loss 0.143, Train_accy 75.08:  65%|██████▌   | 13/20 [00:49<00:23,  3.40s/it]
Task 4, Epoch 14/20 => Loss 0.143, Train_accy 75.08:  70%|███████   | 14/20 [00:49<00:19,  3.20s/it]
Task 4, Epoch 15/20 => Loss 0.100, Train_accy 73.79:  70%|███████   | 14/20 [00:52<00:19,  3.20s/it]
Task 4, Epoch 15/20 => Loss 0.100, Train_accy 73.79:  75%|███████▌  | 15/20 [00:52<00:15,  3.08s/it]
Task 4, Epoch 16/20 => Loss 0.107, Train_accy 77.67, Test_accy 22.39:  75%|███████▌  | 15/20 [00:58<00:15,  3.08s/it]
Task 4, Epoch 16/20 => Loss 0.107, Train_accy 77.67, Test_accy 22.39:  80%|████████  | 16/20 [00:58<00:16,  4.12s/it]
Task 4, Epoch 17/20 => Loss 0.120, Train_accy 73.14:  80%|████████  | 16/20 [01:01<00:16,  4.12s/it]                 
Task 4, Epoch 17/20 => Loss 0.120, Train_accy 73.14:  85%|████████▌ | 17/20 [01:01<00:11,  3.70s/it]
Task 4, Epoch 18/20 => Loss 0.075, Train_accy 77.35:  85%|████████▌ | 17/20 [01:04<00:11,  3.70s/it]
Task 4, Epoch 18/20 => Loss 0.075, Train_accy 77.35:  90%|█████████ | 18/20 [01:04<00:06,  3.42s/it]
Task 4, Epoch 19/20 => Loss 0.111, Train_accy 78.96:  90%|█████████ | 18/20 [01:06<00:06,  3.42s/it]
Task 4, Epoch 19/20 => Loss 0.111, Train_accy 78.96:  95%|█████████▌| 19/20 [01:06<00:03,  3.22s/it]
Task 4, Epoch 20/20 => Loss 0.088, Train_accy 83.50:  95%|█████████▌| 19/20 [01:09<00:03,  3.22s/it]
Task 4, Epoch 20/20 => Loss 0.088, Train_accy 83.50: 100%|██████████| 20/20 [01:09<00:00,  3.07s/it]
Task 4, Epoch 20/20 => Loss 0.088, Train_accy 83.50: 100%|██████████| 20/20 [01:09<00:00,  3.48s/it]
2024-09-07 10:10:33,239 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.088, Train_accy 83.50
2024-09-07 10:10:36,877 [trainer.py] => No NME accuracy.
2024-09-07 10:10:36,877 [trainer.py] => CNN: {'total': 23.64, '00-99': 18.31, '100-109': 48.33, '110-119': 37.84, '120-129': 26.67, '130-139': 44.19, 'old': 21.93, 'new': 44.19}
2024-09-07 10:10:36,877 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47, 23.64]
2024-09-07 10:10:36,877 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36, 54.68]

Average Accuracy (CNN): 31.87
2024-09-07 10:10:36,877 [trainer.py] => Average Accuracy (CNN): 31.87 

2024-09-07 10:10:36,878 [trainer.py] => All params: 85906316
2024-09-07 10:10:36,879 [trainer.py] => Trainable params: 85906316
2024-09-07 10:10:36,883 [finetune.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.679, Train_accy 0.00, Test_accy 17.63:   0%|          | 0/20 [00:06<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.679, Train_accy 0.00, Test_accy 17.63:   5%|▌         | 1/20 [00:06<02:08,  6.78s/it]
Task 5, Epoch 2/20 => Loss 1.102, Train_accy 4.88:   5%|▌         | 1/20 [00:09<02:08,  6.78s/it]                 
Task 5, Epoch 2/20 => Loss 1.102, Train_accy 4.88:  10%|█         | 2/20 [00:09<01:20,  4.47s/it]
Task 5, Epoch 3/20 => Loss 0.701, Train_accy 23.17:  10%|█         | 2/20 [00:12<01:20,  4.47s/it]
Task 5, Epoch 3/20 => Loss 0.701, Train_accy 23.17:  15%|█▌        | 3/20 [00:12<01:04,  3.77s/it]
Task 5, Epoch 4/20 => Loss 0.491, Train_accy 41.46:  15%|█▌        | 3/20 [00:15<01:04,  3.77s/it]
Task 5, Epoch 4/20 => Loss 0.491, Train_accy 41.46:  20%|██        | 4/20 [00:15<00:54,  3.40s/it]
Task 5, Epoch 5/20 => Loss 0.308, Train_accy 57.93:  20%|██        | 4/20 [00:18<00:54,  3.40s/it]
Task 5, Epoch 5/20 => Loss 0.308, Train_accy 57.93:  25%|██▌       | 5/20 [00:18<00:48,  3.21s/it]
Task 5, Epoch 6/20 => Loss 0.286, Train_accy 64.63, Test_accy 22.47:  25%|██▌       | 5/20 [00:24<00:48,  3.21s/it]
Task 5, Epoch 6/20 => Loss 0.286, Train_accy 64.63, Test_accy 22.47:  30%|███       | 6/20 [00:24<01:01,  4.40s/it]
Task 5, Epoch 7/20 => Loss 0.217, Train_accy 70.12:  30%|███       | 6/20 [00:27<01:01,  4.40s/it]                 
Task 5, Epoch 7/20 => Loss 0.217, Train_accy 70.12:  35%|███▌      | 7/20 [00:27<00:50,  3.90s/it]
Task 5, Epoch 8/20 => Loss 0.175, Train_accy 76.22:  35%|███▌      | 7/20 [00:30<00:50,  3.90s/it]
Task 5, Epoch 8/20 => Loss 0.175, Train_accy 76.22:  40%|████      | 8/20 [00:30<00:42,  3.57s/it]
Task 5, Epoch 9/20 => Loss 0.177, Train_accy 78.05:  40%|████      | 8/20 [00:33<00:42,  3.57s/it]
Task 5, Epoch 9/20 => Loss 0.177, Train_accy 78.05:  45%|████▌     | 9/20 [00:33<00:37,  3.38s/it]
Task 5, Epoch 10/20 => Loss 0.181, Train_accy 77.44:  45%|████▌     | 9/20 [00:36<00:37,  3.38s/it]
Task 5, Epoch 10/20 => Loss 0.181, Train_accy 77.44:  50%|█████     | 10/20 [00:36<00:32,  3.21s/it]
Task 5, Epoch 11/20 => Loss 0.097, Train_accy 81.10, Test_accy 22.31:  50%|█████     | 10/20 [00:43<00:32,  3.21s/it]
Task 5, Epoch 11/20 => Loss 0.097, Train_accy 81.10, Test_accy 22.31:  55%|█████▌    | 11/20 [00:43<00:38,  4.29s/it]
Task 5, Epoch 12/20 => Loss 0.143, Train_accy 81.71:  55%|█████▌    | 11/20 [00:46<00:38,  4.29s/it]                 
Task 5, Epoch 12/20 => Loss 0.143, Train_accy 81.71:  60%|██████    | 12/20 [00:46<00:30,  3.86s/it]
Task 5, Epoch 13/20 => Loss 0.175, Train_accy 76.52:  60%|██████    | 12/20 [00:48<00:30,  3.86s/it]
Task 5, Epoch 13/20 => Loss 0.175, Train_accy 76.52:  65%|██████▌   | 13/20 [00:48<00:24,  3.56s/it]
Task 5, Epoch 14/20 => Loss 0.083, Train_accy 81.40:  65%|██████▌   | 13/20 [00:51<00:24,  3.56s/it]
Task 5, Epoch 14/20 => Loss 0.083, Train_accy 81.40:  70%|███████   | 14/20 [00:51<00:20,  3.35s/it]
Task 5, Epoch 15/20 => Loss 0.115, Train_accy 82.93:  70%|███████   | 14/20 [00:54<00:20,  3.35s/it]
Task 5, Epoch 15/20 => Loss 0.115, Train_accy 82.93:  75%|███████▌  | 15/20 [00:54<00:16,  3.21s/it]
Task 5, Epoch 16/20 => Loss 0.094, Train_accy 80.79, Test_accy 21.64:  75%|███████▌  | 15/20 [01:01<00:16,  3.21s/it]
Task 5, Epoch 16/20 => Loss 0.094, Train_accy 80.79, Test_accy 21.64:  80%|████████  | 16/20 [01:01<00:17,  4.29s/it]
Task 5, Epoch 17/20 => Loss 0.112, Train_accy 80.79:  80%|████████  | 16/20 [01:04<00:17,  4.29s/it]                 
Task 5, Epoch 17/20 => Loss 0.112, Train_accy 80.79:  85%|████████▌ | 17/20 [01:04<00:11,  3.86s/it]
Task 5, Epoch 18/20 => Loss 0.062, Train_accy 82.93:  85%|████████▌ | 17/20 [01:07<00:11,  3.86s/it]
Task 5, Epoch 18/20 => Loss 0.062, Train_accy 82.93:  90%|█████████ | 18/20 [01:07<00:07,  3.56s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 81.40:  90%|█████████ | 18/20 [01:10<00:07,  3.56s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 81.40:  95%|█████████▌| 19/20 [01:10<00:03,  3.35s/it]
Task 5, Epoch 20/20 => Loss 0.086, Train_accy 82.01:  95%|█████████▌| 19/20 [01:13<00:03,  3.35s/it]
Task 5, Epoch 20/20 => Loss 0.086, Train_accy 82.01: 100%|██████████| 20/20 [01:13<00:00,  3.23s/it]
Task 5, Epoch 20/20 => Loss 0.086, Train_accy 82.01: 100%|██████████| 20/20 [01:13<00:00,  3.65s/it]
2024-09-07 10:11:49,965 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.086, Train_accy 82.01
2024-09-07 10:11:53,837 [trainer.py] => No NME accuracy.
2024-09-07 10:11:53,837 [trainer.py] => CNN: {'total': 21.89, '00-99': 15.81, '100-109': 41.67, '110-119': 28.38, '120-129': 28.33, '130-139': 34.88, '140-149': 47.37, 'old': 20.16, 'new': 47.37}
2024-09-07 10:11:53,837 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47, 23.64, 21.89]
2024-09-07 10:11:53,837 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36, 54.68, 51.63]

Average Accuracy (CNN): 30.21
2024-09-07 10:11:53,837 [trainer.py] => Average Accuracy (CNN): 30.21 

2024-09-07 10:11:53,839 [trainer.py] => All params: 85914006
2024-09-07 10:11:53,840 [trainer.py] => Trainable params: 85914006
2024-09-07 10:11:53,843 [finetune.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.068, Train_accy 0.00, Test_accy 20.51:   0%|          | 0/20 [00:06<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.068, Train_accy 0.00, Test_accy 20.51:   5%|▌         | 1/20 [00:06<01:54,  6.02s/it]
Task 6, Epoch 2/20 => Loss 1.128, Train_accy 6.90:   5%|▌         | 1/20 [00:07<01:54,  6.02s/it]                 
Task 6, Epoch 2/20 => Loss 1.128, Train_accy 6.90:  10%|█         | 2/20 [00:07<01:04,  3.61s/it]
Task 6, Epoch 3/20 => Loss 0.761, Train_accy 19.70:  10%|█         | 2/20 [00:09<01:04,  3.61s/it]
Task 6, Epoch 3/20 => Loss 0.761, Train_accy 19.70:  15%|█▌        | 3/20 [00:09<00:48,  2.83s/it]
Task 6, Epoch 4/20 => Loss 0.593, Train_accy 47.29:  15%|█▌        | 3/20 [00:11<00:48,  2.83s/it]
Task 6, Epoch 4/20 => Loss 0.593, Train_accy 47.29:  20%|██        | 4/20 [00:11<00:39,  2.47s/it]
Task 6, Epoch 5/20 => Loss 0.443, Train_accy 54.68:  20%|██        | 4/20 [00:13<00:39,  2.47s/it]
Task 6, Epoch 5/20 => Loss 0.443, Train_accy 54.68:  25%|██▌       | 5/20 [00:13<00:34,  2.28s/it]
Task 6, Epoch 6/20 => Loss 0.285, Train_accy 65.02, Test_accy 21.31:  25%|██▌       | 5/20 [00:19<00:34,  2.28s/it]
Task 6, Epoch 6/20 => Loss 0.285, Train_accy 65.02, Test_accy 21.31:  30%|███       | 6/20 [00:19<00:49,  3.51s/it]
Task 6, Epoch 7/20 => Loss 0.178, Train_accy 70.94:  30%|███       | 6/20 [00:21<00:49,  3.51s/it]                 
Task 6, Epoch 7/20 => Loss 0.178, Train_accy 70.94:  35%|███▌      | 7/20 [00:21<00:38,  3.00s/it]
Task 6, Epoch 8/20 => Loss 0.101, Train_accy 79.80:  35%|███▌      | 7/20 [00:23<00:38,  3.00s/it]
Task 6, Epoch 8/20 => Loss 0.101, Train_accy 79.80:  40%|████      | 8/20 [00:23<00:31,  2.65s/it]
Task 6, Epoch 9/20 => Loss 0.181, Train_accy 81.77:  40%|████      | 8/20 [00:25<00:31,  2.65s/it]
Task 6, Epoch 9/20 => Loss 0.181, Train_accy 81.77:  45%|████▌     | 9/20 [00:25<00:26,  2.44s/it]
Task 6, Epoch 10/20 => Loss 0.103, Train_accy 78.82:  45%|████▌     | 9/20 [00:27<00:26,  2.44s/it]
Task 6, Epoch 10/20 => Loss 0.103, Train_accy 78.82:  50%|█████     | 10/20 [00:27<00:22,  2.27s/it]
Task 6, Epoch 11/20 => Loss 0.102, Train_accy 80.30, Test_accy 20.67:  50%|█████     | 10/20 [00:33<00:22,  2.27s/it]
Task 6, Epoch 11/20 => Loss 0.102, Train_accy 80.30, Test_accy 20.67:  55%|█████▌    | 11/20 [00:33<00:30,  3.39s/it]
Task 6, Epoch 12/20 => Loss 0.072, Train_accy 85.71:  55%|█████▌    | 11/20 [00:35<00:30,  3.39s/it]                 
Task 6, Epoch 12/20 => Loss 0.072, Train_accy 85.71:  60%|██████    | 12/20 [00:35<00:23,  2.94s/it]
Task 6, Epoch 13/20 => Loss 0.036, Train_accy 84.24:  60%|██████    | 12/20 [00:37<00:23,  2.94s/it]
Task 6, Epoch 13/20 => Loss 0.036, Train_accy 84.24:  65%|██████▌   | 13/20 [00:37<00:18,  2.64s/it]
Task 6, Epoch 14/20 => Loss 0.120, Train_accy 86.70:  65%|██████▌   | 13/20 [00:39<00:18,  2.64s/it]
Task 6, Epoch 14/20 => Loss 0.120, Train_accy 86.70:  70%|███████   | 14/20 [00:39<00:14,  2.41s/it]
Task 6, Epoch 15/20 => Loss 0.095, Train_accy 85.22:  70%|███████   | 14/20 [00:40<00:14,  2.41s/it]
Task 6, Epoch 15/20 => Loss 0.095, Train_accy 85.22:  75%|███████▌  | 15/20 [00:40<00:11,  2.27s/it]
Task 6, Epoch 16/20 => Loss 0.073, Train_accy 87.19, Test_accy 20.11:  75%|███████▌  | 15/20 [00:46<00:11,  2.27s/it]
Task 6, Epoch 16/20 => Loss 0.073, Train_accy 87.19, Test_accy 20.11:  80%|████████  | 16/20 [00:46<00:13,  3.39s/it]
Task 6, Epoch 17/20 => Loss 0.047, Train_accy 88.67:  80%|████████  | 16/20 [00:48<00:13,  3.39s/it]                 
Task 6, Epoch 17/20 => Loss 0.047, Train_accy 88.67:  85%|████████▌ | 17/20 [00:48<00:08,  2.96s/it]
Task 6, Epoch 18/20 => Loss 0.064, Train_accy 91.63:  85%|████████▌ | 17/20 [00:50<00:08,  2.96s/it]
Task 6, Epoch 18/20 => Loss 0.064, Train_accy 91.63:  90%|█████████ | 18/20 [00:50<00:05,  2.64s/it]
Task 6, Epoch 19/20 => Loss 0.127, Train_accy 88.67:  90%|█████████ | 18/20 [00:52<00:05,  2.64s/it]
Task 6, Epoch 19/20 => Loss 0.127, Train_accy 88.67:  95%|█████████▌| 19/20 [00:52<00:02,  2.42s/it]
Task 6, Epoch 20/20 => Loss 0.130, Train_accy 90.15:  95%|█████████▌| 19/20 [00:54<00:02,  2.42s/it]
Task 6, Epoch 20/20 => Loss 0.130, Train_accy 90.15: 100%|██████████| 20/20 [00:54<00:00,  2.26s/it]
Task 6, Epoch 20/20 => Loss 0.130, Train_accy 90.15: 100%|██████████| 20/20 [00:54<00:00,  2.73s/it]
2024-09-07 10:12:48,445 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.130, Train_accy 90.15
2024-09-07 10:12:52,442 [trainer.py] => No NME accuracy.
2024-09-07 10:12:52,443 [trainer.py] => CNN: {'total': 19.87, '00-99': 15.58, '100-109': 18.33, '110-119': 27.03, '120-129': 13.33, '130-139': 23.26, '140-149': 39.47, '150-159': 54.9, 'old': 18.38, 'new': 54.9}
2024-09-07 10:12:52,443 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47, 23.64, 21.89, 19.87]
2024-09-07 10:12:52,443 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36, 54.68, 51.63, 45.99]

Average Accuracy (CNN): 28.73
2024-09-07 10:12:52,443 [trainer.py] => Average Accuracy (CNN): 28.73 

2024-09-07 10:12:52,444 [trainer.py] => All params: 85921696
2024-09-07 10:12:52,445 [trainer.py] => Trainable params: 85921696
2024-09-07 10:12:52,448 [finetune.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.508, Train_accy 0.30, Test_accy 18.83:   0%|          | 0/20 [00:07<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.508, Train_accy 0.30, Test_accy 18.83:   5%|▌         | 1/20 [00:07<02:16,  7.17s/it]
Task 7, Epoch 2/20 => Loss 1.122, Train_accy 6.59:   5%|▌         | 1/20 [00:10<02:16,  7.17s/it]                 
Task 7, Epoch 2/20 => Loss 1.122, Train_accy 6.59:  10%|█         | 2/20 [00:10<01:24,  4.67s/it]
Task 7, Epoch 3/20 => Loss 0.714, Train_accy 26.95:  10%|█         | 2/20 [00:13<01:24,  4.67s/it]
Task 7, Epoch 3/20 => Loss 0.714, Train_accy 26.95:  15%|█▌        | 3/20 [00:13<01:05,  3.87s/it]
Task 7, Epoch 4/20 => Loss 0.525, Train_accy 33.83:  15%|█▌        | 3/20 [00:15<01:05,  3.87s/it]
Task 7, Epoch 4/20 => Loss 0.525, Train_accy 33.83:  20%|██        | 4/20 [00:15<00:55,  3.50s/it]
Task 7, Epoch 5/20 => Loss 0.375, Train_accy 44.01:  20%|██        | 4/20 [00:18<00:55,  3.50s/it]
Task 7, Epoch 5/20 => Loss 0.375, Train_accy 44.01:  25%|██▌       | 5/20 [00:18<00:49,  3.28s/it]
Task 7, Epoch 6/20 => Loss 0.362, Train_accy 51.80, Test_accy 20.86:  25%|██▌       | 5/20 [00:25<00:49,  3.28s/it]
Task 7, Epoch 6/20 => Loss 0.362, Train_accy 51.80, Test_accy 20.86:  30%|███       | 6/20 [00:25<01:04,  4.59s/it]
Task 7, Epoch 7/20 => Loss 0.220, Train_accy 56.29:  30%|███       | 6/20 [00:28<01:04,  4.59s/it]                 
Task 7, Epoch 7/20 => Loss 0.220, Train_accy 56.29:  35%|███▌      | 7/20 [00:28<00:52,  4.04s/it]
Task 7, Epoch 8/20 => Loss 0.210, Train_accy 57.19:  35%|███▌      | 7/20 [00:31<00:52,  4.04s/it]
Task 7, Epoch 8/20 => Loss 0.210, Train_accy 57.19:  40%|████      | 8/20 [00:31<00:44,  3.69s/it]
Task 7, Epoch 9/20 => Loss 0.193, Train_accy 61.08:  40%|████      | 8/20 [00:34<00:44,  3.69s/it]
Task 7, Epoch 9/20 => Loss 0.193, Train_accy 61.08:  45%|████▌     | 9/20 [00:34<00:38,  3.46s/it]
Task 7, Epoch 10/20 => Loss 0.167, Train_accy 63.77:  45%|████▌     | 9/20 [00:37<00:38,  3.46s/it]
Task 7, Epoch 10/20 => Loss 0.167, Train_accy 63.77:  50%|█████     | 10/20 [00:37<00:32,  3.30s/it]
Task 7, Epoch 11/20 => Loss 0.106, Train_accy 66.77, Test_accy 19.65:  50%|█████     | 10/20 [00:45<00:32,  3.30s/it]
Task 7, Epoch 11/20 => Loss 0.106, Train_accy 66.77, Test_accy 19.65:  55%|█████▌    | 11/20 [00:45<00:40,  4.53s/it]
Task 7, Epoch 12/20 => Loss 0.135, Train_accy 67.96:  55%|█████▌    | 11/20 [00:47<00:40,  4.53s/it]                 
Task 7, Epoch 12/20 => Loss 0.135, Train_accy 67.96:  60%|██████    | 12/20 [00:47<00:32,  4.04s/it]
Task 7, Epoch 13/20 => Loss 0.187, Train_accy 64.37:  60%|██████    | 12/20 [00:50<00:32,  4.04s/it]
Task 7, Epoch 13/20 => Loss 0.187, Train_accy 64.37:  65%|██████▌   | 13/20 [00:50<00:25,  3.70s/it]
Task 7, Epoch 14/20 => Loss 0.163, Train_accy 62.87:  65%|██████▌   | 13/20 [00:53<00:25,  3.70s/it]
Task 7, Epoch 14/20 => Loss 0.163, Train_accy 62.87:  70%|███████   | 14/20 [00:53<00:20,  3.46s/it]
Task 7, Epoch 15/20 => Loss 0.096, Train_accy 69.16:  70%|███████   | 14/20 [00:56<00:20,  3.46s/it]
Task 7, Epoch 15/20 => Loss 0.096, Train_accy 69.16:  75%|███████▌  | 15/20 [00:56<00:16,  3.31s/it]
Task 7, Epoch 16/20 => Loss 0.144, Train_accy 68.56, Test_accy 20.26:  75%|███████▌  | 15/20 [01:03<00:16,  3.31s/it]
Task 7, Epoch 16/20 => Loss 0.144, Train_accy 68.56, Test_accy 20.26:  80%|████████  | 16/20 [01:03<00:17,  4.49s/it]
Task 7, Epoch 17/20 => Loss 0.107, Train_accy 70.06:  80%|████████  | 16/20 [01:06<00:17,  4.49s/it]                 
Task 7, Epoch 17/20 => Loss 0.107, Train_accy 70.06:  85%|████████▌ | 17/20 [01:06<00:12,  4.02s/it]
Task 7, Epoch 18/20 => Loss 0.102, Train_accy 69.76:  85%|████████▌ | 17/20 [01:09<00:12,  4.02s/it]
Task 7, Epoch 18/20 => Loss 0.102, Train_accy 69.76:  90%|█████████ | 18/20 [01:09<00:07,  3.68s/it]
Task 7, Epoch 19/20 => Loss 0.158, Train_accy 68.56:  90%|█████████ | 18/20 [01:12<00:07,  3.68s/it]
Task 7, Epoch 19/20 => Loss 0.158, Train_accy 68.56:  95%|█████████▌| 19/20 [01:12<00:03,  3.45s/it]
Task 7, Epoch 20/20 => Loss 0.100, Train_accy 72.16:  95%|█████████▌| 19/20 [01:15<00:03,  3.45s/it]
Task 7, Epoch 20/20 => Loss 0.100, Train_accy 72.16: 100%|██████████| 20/20 [01:15<00:00,  3.29s/it]
Task 7, Epoch 20/20 => Loss 0.100, Train_accy 72.16: 100%|██████████| 20/20 [01:15<00:00,  3.78s/it]
2024-09-07 10:14:08,050 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.100, Train_accy 72.16
2024-09-07 10:14:12,346 [trainer.py] => No NME accuracy.
2024-09-07 10:14:12,346 [trainer.py] => CNN: {'total': 21.16, '00-99': 14.39, '100-109': 25.0, '110-119': 33.78, '120-129': 13.33, '130-139': 22.09, '140-149': 39.47, '150-159': 45.1, '160-169': 48.24, 'old': 19.31, 'new': 48.24}
2024-09-07 10:14:12,346 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47, 23.64, 21.89, 19.87, 21.16]
2024-09-07 10:14:12,347 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36, 54.68, 51.63, 45.99, 48.84]

Average Accuracy (CNN): 27.78
2024-09-07 10:14:12,347 [trainer.py] => Average Accuracy (CNN): 27.78 

2024-09-07 10:14:12,348 [trainer.py] => All params: 85929386
2024-09-07 10:14:12,349 [trainer.py] => Trainable params: 85929386
2024-09-07 10:14:12,352 [finetune.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.638, Train_accy 0.42, Test_accy 19.50:   0%|          | 0/20 [00:06<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.638, Train_accy 0.42, Test_accy 19.50:   5%|▌         | 1/20 [00:06<02:06,  6.65s/it]
Task 8, Epoch 2/20 => Loss 1.354, Train_accy 5.49:   5%|▌         | 1/20 [00:08<02:06,  6.65s/it]                 
Task 8, Epoch 2/20 => Loss 1.354, Train_accy 5.49:  10%|█         | 2/20 [00:08<01:12,  4.03s/it]
Task 8, Epoch 3/20 => Loss 0.890, Train_accy 13.08:  10%|█         | 2/20 [00:10<01:12,  4.03s/it]
Task 8, Epoch 3/20 => Loss 0.890, Train_accy 13.08:  15%|█▌        | 3/20 [00:10<00:53,  3.17s/it]
Task 8, Epoch 4/20 => Loss 0.535, Train_accy 38.40:  15%|█▌        | 3/20 [00:13<00:53,  3.17s/it]
Task 8, Epoch 4/20 => Loss 0.535, Train_accy 38.40:  20%|██        | 4/20 [00:13<00:44,  2.77s/it]
Task 8, Epoch 5/20 => Loss 0.377, Train_accy 36.29:  20%|██        | 4/20 [00:15<00:44,  2.77s/it]
Task 8, Epoch 5/20 => Loss 0.377, Train_accy 36.29:  25%|██▌       | 5/20 [00:15<00:38,  2.54s/it]
Task 8, Epoch 6/20 => Loss 0.329, Train_accy 41.35, Test_accy 19.21:  25%|██▌       | 5/20 [00:21<00:38,  2.54s/it]
Task 8, Epoch 6/20 => Loss 0.329, Train_accy 41.35, Test_accy 19.21:  30%|███       | 6/20 [00:21<00:54,  3.93s/it]
Task 8, Epoch 7/20 => Loss 0.223, Train_accy 57.38:  30%|███       | 6/20 [00:24<00:54,  3.93s/it]                 
Task 8, Epoch 7/20 => Loss 0.223, Train_accy 57.38:  35%|███▌      | 7/20 [00:24<00:43,  3.35s/it]
Task 8, Epoch 8/20 => Loss 0.197, Train_accy 57.81:  35%|███▌      | 7/20 [00:26<00:43,  3.35s/it]
Task 8, Epoch 8/20 => Loss 0.197, Train_accy 57.81:  40%|████      | 8/20 [00:26<00:35,  2.98s/it]
Task 8, Epoch 9/20 => Loss 0.153, Train_accy 65.82:  40%|████      | 8/20 [00:28<00:35,  2.98s/it]
Task 8, Epoch 9/20 => Loss 0.153, Train_accy 65.82:  45%|████▌     | 9/20 [00:28<00:29,  2.72s/it]
Task 8, Epoch 10/20 => Loss 0.089, Train_accy 73.84:  45%|████▌     | 9/20 [00:30<00:29,  2.72s/it]
Task 8, Epoch 10/20 => Loss 0.089, Train_accy 73.84:  50%|█████     | 10/20 [00:30<00:25,  2.56s/it]
Task 8, Epoch 11/20 => Loss 0.125, Train_accy 70.46, Test_accy 18.71:  50%|█████     | 10/20 [00:37<00:25,  2.56s/it]
Task 8, Epoch 11/20 => Loss 0.125, Train_accy 70.46, Test_accy 18.71:  55%|█████▌    | 11/20 [00:37<00:34,  3.79s/it]
Task 8, Epoch 12/20 => Loss 0.098, Train_accy 73.00:  55%|█████▌    | 11/20 [00:39<00:34,  3.79s/it]                 
Task 8, Epoch 12/20 => Loss 0.098, Train_accy 73.00:  60%|██████    | 12/20 [00:39<00:26,  3.30s/it]
Task 8, Epoch 13/20 => Loss 0.083, Train_accy 71.73:  60%|██████    | 12/20 [00:41<00:26,  3.30s/it]
Task 8, Epoch 13/20 => Loss 0.083, Train_accy 71.73:  65%|██████▌   | 13/20 [00:41<00:20,  2.97s/it]
Task 8, Epoch 14/20 => Loss 0.061, Train_accy 75.95:  65%|██████▌   | 13/20 [00:43<00:20,  2.97s/it]
Task 8, Epoch 14/20 => Loss 0.061, Train_accy 75.95:  70%|███████   | 14/20 [00:43<00:16,  2.72s/it]
Task 8, Epoch 15/20 => Loss 0.084, Train_accy 73.84:  70%|███████   | 14/20 [00:45<00:16,  2.72s/it]
Task 8, Epoch 15/20 => Loss 0.084, Train_accy 73.84:  75%|███████▌  | 15/20 [00:45<00:12,  2.55s/it]
Task 8, Epoch 16/20 => Loss 0.076, Train_accy 79.75, Test_accy 17.92:  75%|███████▌  | 15/20 [00:52<00:12,  2.55s/it]
Task 8, Epoch 16/20 => Loss 0.076, Train_accy 79.75, Test_accy 17.92:  80%|████████  | 16/20 [00:52<00:15,  3.77s/it]
Task 8, Epoch 17/20 => Loss 0.068, Train_accy 83.97:  80%|████████  | 16/20 [00:54<00:15,  3.77s/it]                 
Task 8, Epoch 17/20 => Loss 0.068, Train_accy 83.97:  85%|████████▌ | 17/20 [00:54<00:09,  3.29s/it]
Task 8, Epoch 18/20 => Loss 0.114, Train_accy 83.97:  85%|████████▌ | 17/20 [00:56<00:09,  3.29s/it]
Task 8, Epoch 18/20 => Loss 0.114, Train_accy 83.97:  90%|█████████ | 18/20 [00:56<00:05,  2.95s/it]
Task 8, Epoch 19/20 => Loss 0.081, Train_accy 76.79:  90%|█████████ | 18/20 [00:58<00:05,  2.95s/it]
Task 8, Epoch 19/20 => Loss 0.081, Train_accy 76.79:  95%|█████████▌| 19/20 [00:58<00:02,  2.72s/it]
Task 8, Epoch 20/20 => Loss 0.131, Train_accy 78.06:  95%|█████████▌| 19/20 [01:01<00:02,  2.72s/it]
Task 8, Epoch 20/20 => Loss 0.131, Train_accy 78.06: 100%|██████████| 20/20 [01:01<00:00,  2.55s/it]
Task 8, Epoch 20/20 => Loss 0.131, Train_accy 78.06: 100%|██████████| 20/20 [01:01<00:00,  3.06s/it]
2024-09-07 10:15:13,499 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.131, Train_accy 78.06
2024-09-07 10:15:17,918 [trainer.py] => No NME accuracy.
2024-09-07 10:15:17,919 [trainer.py] => CNN: {'total': 18.85, '00-99': 12.49, '100-109': 20.0, '110-119': 27.03, '120-129': 10.0, '130-139': 19.77, '140-149': 28.95, '150-159': 39.22, '160-169': 41.18, '170-179': 41.94, 'old': 17.78, 'new': 41.94}
2024-09-07 10:15:17,919 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47, 23.64, 21.89, 19.87, 21.16, 18.85]
2024-09-07 10:15:17,919 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36, 54.68, 51.63, 45.99, 48.84, 42.37]

Average Accuracy (CNN): 26.79
2024-09-07 10:15:17,919 [trainer.py] => Average Accuracy (CNN): 26.79 

2024-09-07 10:15:17,921 [trainer.py] => All params: 85937076
2024-09-07 10:15:17,922 [trainer.py] => Trainable params: 85937076
2024-09-07 10:15:17,926 [finetune.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.941, Train_accy 0.00, Test_accy 17.22:   0%|          | 0/20 [00:06<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.941, Train_accy 0.00, Test_accy 17.22:   5%|▌         | 1/20 [00:06<02:00,  6.32s/it]
Task 9, Epoch 2/20 => Loss 1.312, Train_accy 8.99:   5%|▌         | 1/20 [00:08<02:00,  6.32s/it]                 
Task 9, Epoch 2/20 => Loss 1.312, Train_accy 8.99:  10%|█         | 2/20 [00:08<01:05,  3.64s/it]
Task 9, Epoch 3/20 => Loss 0.677, Train_accy 19.58:  10%|█         | 2/20 [00:09<01:05,  3.64s/it]
Task 9, Epoch 3/20 => Loss 0.677, Train_accy 19.58:  15%|█▌        | 3/20 [00:09<00:47,  2.80s/it]
Task 9, Epoch 4/20 => Loss 0.422, Train_accy 32.80:  15%|█▌        | 3/20 [00:11<00:47,  2.80s/it]
Task 9, Epoch 4/20 => Loss 0.422, Train_accy 32.80:  20%|██        | 4/20 [00:11<00:38,  2.39s/it]
Task 9, Epoch 5/20 => Loss 0.398, Train_accy 47.09:  20%|██        | 4/20 [00:13<00:38,  2.39s/it]
Task 9, Epoch 5/20 => Loss 0.398, Train_accy 47.09:  25%|██▌       | 5/20 [00:13<00:32,  2.17s/it]
Task 9, Epoch 6/20 => Loss 0.215, Train_accy 55.56, Test_accy 18.06:  25%|██▌       | 5/20 [00:19<00:32,  2.17s/it]
Task 9, Epoch 6/20 => Loss 0.215, Train_accy 55.56, Test_accy 18.06:  30%|███       | 6/20 [00:19<00:50,  3.59s/it]
Task 9, Epoch 7/20 => Loss 0.153, Train_accy 64.55:  30%|███       | 6/20 [00:21<00:50,  3.59s/it]                 
Task 9, Epoch 7/20 => Loss 0.153, Train_accy 64.55:  35%|███▌      | 7/20 [00:21<00:39,  3.01s/it]
Task 9, Epoch 8/20 => Loss 0.138, Train_accy 74.07:  35%|███▌      | 7/20 [00:23<00:39,  3.01s/it]
Task 9, Epoch 8/20 => Loss 0.138, Train_accy 74.07:  40%|████      | 8/20 [00:23<00:31,  2.62s/it]
Task 9, Epoch 9/20 => Loss 0.125, Train_accy 75.66:  40%|████      | 8/20 [00:25<00:31,  2.62s/it]
Task 9, Epoch 9/20 => Loss 0.125, Train_accy 75.66:  45%|████▌     | 9/20 [00:25<00:25,  2.36s/it]
Task 9, Epoch 10/20 => Loss 0.071, Train_accy 82.54:  45%|████▌     | 9/20 [00:26<00:25,  2.36s/it]
Task 9, Epoch 10/20 => Loss 0.071, Train_accy 82.54:  50%|█████     | 10/20 [00:26<00:21,  2.19s/it]
Task 9, Epoch 11/20 => Loss 0.142, Train_accy 80.42, Test_accy 16.67:  50%|█████     | 10/20 [00:33<00:21,  2.19s/it]
Task 9, Epoch 11/20 => Loss 0.142, Train_accy 80.42, Test_accy 16.67:  55%|█████▌    | 11/20 [00:33<00:31,  3.46s/it]
Task 9, Epoch 12/20 => Loss 0.058, Train_accy 83.07:  55%|█████▌    | 11/20 [00:35<00:31,  3.46s/it]                 
Task 9, Epoch 12/20 => Loss 0.058, Train_accy 83.07:  60%|██████    | 12/20 [00:35<00:23,  2.96s/it]
Task 9, Epoch 13/20 => Loss 0.039, Train_accy 85.71:  60%|██████    | 12/20 [00:36<00:23,  2.96s/it]
Task 9, Epoch 13/20 => Loss 0.039, Train_accy 85.71:  65%|██████▌   | 13/20 [00:36<00:18,  2.61s/it]
Task 9, Epoch 14/20 => Loss 0.034, Train_accy 82.54:  65%|██████▌   | 13/20 [00:38<00:18,  2.61s/it]
Task 9, Epoch 14/20 => Loss 0.034, Train_accy 82.54:  70%|███████   | 14/20 [00:38<00:14,  2.37s/it]
Task 9, Epoch 15/20 => Loss 0.064, Train_accy 83.60:  70%|███████   | 14/20 [00:40<00:14,  2.37s/it]
Task 9, Epoch 15/20 => Loss 0.064, Train_accy 83.60:  75%|███████▌  | 15/20 [00:40<00:10,  2.19s/it]
Task 9, Epoch 16/20 => Loss 0.085, Train_accy 83.07, Test_accy 16.95:  75%|███████▌  | 15/20 [00:46<00:10,  2.19s/it]
Task 9, Epoch 16/20 => Loss 0.085, Train_accy 83.07, Test_accy 16.95:  80%|████████  | 16/20 [00:46<00:13,  3.46s/it]
Task 9, Epoch 17/20 => Loss 0.021, Train_accy 88.36:  80%|████████  | 16/20 [00:48<00:13,  3.46s/it]                 
Task 9, Epoch 17/20 => Loss 0.021, Train_accy 88.36:  85%|████████▌ | 17/20 [00:48<00:08,  2.96s/it]
Task 9, Epoch 18/20 => Loss 0.065, Train_accy 86.77:  85%|████████▌ | 17/20 [00:50<00:08,  2.96s/it]
Task 9, Epoch 18/20 => Loss 0.065, Train_accy 86.77:  90%|█████████ | 18/20 [00:50<00:05,  2.62s/it]
Task 9, Epoch 19/20 => Loss 0.110, Train_accy 83.07:  90%|█████████ | 18/20 [00:52<00:05,  2.62s/it]
Task 9, Epoch 19/20 => Loss 0.110, Train_accy 83.07:  95%|█████████▌| 19/20 [00:52<00:02,  2.38s/it]
Task 9, Epoch 20/20 => Loss 0.052, Train_accy 87.30:  95%|█████████▌| 19/20 [00:54<00:02,  2.38s/it]
Task 9, Epoch 20/20 => Loss 0.052, Train_accy 87.30: 100%|██████████| 20/20 [00:54<00:00,  2.21s/it]
Task 9, Epoch 20/20 => Loss 0.052, Train_accy 87.30: 100%|██████████| 20/20 [00:54<00:00,  2.71s/it]
2024-09-07 10:16:12,137 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.052, Train_accy 87.30
2024-09-07 10:16:16,661 [trainer.py] => No NME accuracy.
2024-09-07 10:16:16,661 [trainer.py] => CNN: {'total': 16.67, '00-99': 9.75, '100-109': 21.67, '110-119': 29.73, '120-129': 8.33, '130-139': 18.6, '140-149': 31.58, '150-159': 41.18, '160-169': 31.76, '170-179': 19.35, '180-189': 43.59, 'old': 15.91, 'new': 43.59}
2024-09-07 10:16:16,662 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47, 23.64, 21.89, 19.87, 21.16, 18.85, 16.67]
2024-09-07 10:16:16,662 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36, 54.68, 51.63, 45.99, 48.84, 42.37, 38.77]

Average Accuracy (CNN): 25.78
2024-09-07 10:16:16,662 [trainer.py] => Average Accuracy (CNN): 25.78 

2024-09-07 10:16:16,663 [trainer.py] => All params: 85944766
2024-09-07 10:16:16,664 [trainer.py] => Trainable params: 85944766
2024-09-07 10:16:16,668 [finetune.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.827, Train_accy 0.00, Test_accy 14.42:   0%|          | 0/20 [00:07<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.827, Train_accy 0.00, Test_accy 14.42:   5%|▌         | 1/20 [00:07<02:27,  7.78s/it]
Task 10, Epoch 2/20 => Loss 1.455, Train_accy 9.76:   5%|▌         | 1/20 [00:10<02:27,  7.78s/it]                 
Task 10, Epoch 2/20 => Loss 1.455, Train_accy 9.76:  10%|█         | 2/20 [00:10<01:29,  4.96s/it]
Task 10, Epoch 3/20 => Loss 1.030, Train_accy 23.96:  10%|█         | 2/20 [00:13<01:29,  4.96s/it]
Task 10, Epoch 3/20 => Loss 1.030, Train_accy 23.96:  15%|█▌        | 3/20 [00:13<01:08,  4.05s/it]
Task 10, Epoch 4/20 => Loss 0.738, Train_accy 43.79:  15%|█▌        | 3/20 [00:16<01:08,  4.05s/it]
Task 10, Epoch 4/20 => Loss 0.738, Train_accy 43.79:  20%|██        | 4/20 [00:16<00:58,  3.63s/it]
Task 10, Epoch 5/20 => Loss 0.873, Train_accy 50.30:  20%|██        | 4/20 [00:19<00:58,  3.63s/it]
Task 10, Epoch 5/20 => Loss 0.873, Train_accy 50.30:  25%|██▌       | 5/20 [00:19<00:51,  3.40s/it]
Task 10, Epoch 6/20 => Loss 0.622, Train_accy 57.10, Test_accy 13.69:  25%|██▌       | 5/20 [00:27<00:51,  3.40s/it]
Task 10, Epoch 6/20 => Loss 0.622, Train_accy 57.10, Test_accy 13.69:  30%|███       | 6/20 [00:27<01:08,  4.92s/it]
Task 10, Epoch 7/20 => Loss 0.421, Train_accy 61.54:  30%|███       | 6/20 [00:30<01:08,  4.92s/it]                 
Task 10, Epoch 7/20 => Loss 0.421, Train_accy 61.54:  35%|███▌      | 7/20 [00:30<00:56,  4.31s/it]
Task 10, Epoch 8/20 => Loss 0.341, Train_accy 65.98:  35%|███▌      | 7/20 [00:33<00:56,  4.31s/it]
Task 10, Epoch 8/20 => Loss 0.341, Train_accy 65.98:  40%|████      | 8/20 [00:33<00:46,  3.89s/it]
Task 10, Epoch 9/20 => Loss 0.189, Train_accy 78.11:  40%|████      | 8/20 [00:36<00:46,  3.89s/it]
Task 10, Epoch 9/20 => Loss 0.189, Train_accy 78.11:  45%|████▌     | 9/20 [00:36<00:39,  3.61s/it]
Task 10, Epoch 10/20 => Loss 0.204, Train_accy 81.36:  45%|████▌     | 9/20 [00:39<00:39,  3.61s/it]
Task 10, Epoch 10/20 => Loss 0.204, Train_accy 81.36:  50%|█████     | 10/20 [00:39<00:34,  3.41s/it]
Task 10, Epoch 11/20 => Loss 0.240, Train_accy 76.33, Test_accy 13.23:  50%|█████     | 10/20 [00:47<00:34,  3.41s/it]
Task 10, Epoch 11/20 => Loss 0.240, Train_accy 76.33, Test_accy 13.23:  55%|█████▌    | 11/20 [00:47<00:43,  4.80s/it]
Task 10, Epoch 12/20 => Loss 0.181, Train_accy 81.66:  55%|█████▌    | 11/20 [00:50<00:43,  4.80s/it]                 
Task 10, Epoch 12/20 => Loss 0.181, Train_accy 81.66:  60%|██████    | 12/20 [00:50<00:33,  4.24s/it]
Task 10, Epoch 13/20 => Loss 0.204, Train_accy 85.21:  60%|██████    | 12/20 [00:53<00:33,  4.24s/it]
Task 10, Epoch 13/20 => Loss 0.204, Train_accy 85.21:  65%|██████▌   | 13/20 [00:53<00:26,  3.86s/it]
Task 10, Epoch 14/20 => Loss 0.140, Train_accy 84.32:  65%|██████▌   | 13/20 [00:56<00:26,  3.86s/it]
Task 10, Epoch 14/20 => Loss 0.140, Train_accy 84.32:  70%|███████   | 14/20 [00:56<00:21,  3.61s/it]
Task 10, Epoch 15/20 => Loss 0.307, Train_accy 84.32:  70%|███████   | 14/20 [00:59<00:21,  3.61s/it]
Task 10, Epoch 15/20 => Loss 0.307, Train_accy 84.32:  75%|███████▌  | 15/20 [00:59<00:17,  3.43s/it]
Task 10, Epoch 16/20 => Loss 0.389, Train_accy 82.25, Test_accy 11.72:  75%|███████▌  | 15/20 [01:07<00:17,  3.43s/it]
Task 10, Epoch 16/20 => Loss 0.389, Train_accy 82.25, Test_accy 11.72:  80%|████████  | 16/20 [01:07<00:18,  4.74s/it]
Task 10, Epoch 17/20 => Loss 0.629, Train_accy 70.71:  80%|████████  | 16/20 [01:10<00:18,  4.74s/it]                 
Task 10, Epoch 17/20 => Loss 0.629, Train_accy 70.71:  85%|████████▌ | 17/20 [01:10<00:12,  4.21s/it]
Task 10, Epoch 18/20 => Loss 0.393, Train_accy 71.30:  85%|████████▌ | 17/20 [01:13<00:12,  4.21s/it]
Task 10, Epoch 18/20 => Loss 0.393, Train_accy 71.30:  90%|█████████ | 18/20 [01:13<00:07,  3.85s/it]
Task 10, Epoch 19/20 => Loss 0.240, Train_accy 77.51:  90%|█████████ | 18/20 [01:16<00:07,  3.85s/it]
Task 10, Epoch 19/20 => Loss 0.240, Train_accy 77.51:  95%|█████████▌| 19/20 [01:16<00:03,  3.59s/it]
Task 10, Epoch 20/20 => Loss 0.223, Train_accy 79.88:  95%|█████████▌| 19/20 [01:19<00:03,  3.59s/it]
Task 10, Epoch 20/20 => Loss 0.223, Train_accy 79.88: 100%|██████████| 20/20 [01:19<00:00,  3.40s/it]
Task 10, Epoch 20/20 => Loss 0.223, Train_accy 79.88: 100%|██████████| 20/20 [01:19<00:00,  3.96s/it]
2024-09-07 10:17:35,917 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.223, Train_accy 79.88
2024-09-07 10:17:40,742 [trainer.py] => No NME accuracy.
2024-09-07 10:17:40,743 [trainer.py] => CNN: {'total': 12.18, '00-99': 5.47, '100-109': 23.33, '110-119': 6.76, '120-129': 5.0, '130-139': 16.28, '140-149': 23.68, '150-159': 37.25, '160-169': 20.0, '170-179': 6.45, '180-189': 7.69, '190-199': 49.41, 'old': 9.97, 'new': 49.41}
2024-09-07 10:17:40,743 [trainer.py] => CNN top1 curve: [51.13, 29.3, 28.82, 26.47, 23.64, 21.89, 19.87, 21.16, 18.85, 16.67, 12.18]
2024-09-07 10:17:40,743 [trainer.py] => CNN top5 curve: [74.79, 65.59, 66.67, 58.36, 54.68, 51.63, 45.99, 48.84, 42.37, 38.77, 32.92]

Average Accuracy (CNN): 24.54
2024-09-07 10:17:40,743 [trainer.py] => Average Accuracy (CNN): 24.54 

Accuracy Matrix (CNN):
[[51.13 26.52 24.14 21.64 18.31 15.81 15.58 14.39 12.49  9.75  5.47]
 [ 0.   68.33 61.67 55.   48.33 41.67 18.33 25.   20.   21.67 23.33]
 [ 0.    0.   55.41 50.   37.84 28.38 27.03 33.78 27.03 29.73  6.76]
 [ 0.    0.    0.   36.67 26.67 28.33 13.33 13.33 10.    8.33  5.  ]
 [ 0.    0.    0.    0.   44.19 34.88 23.26 22.09 19.77 18.6  16.28]
 [ 0.    0.    0.    0.    0.   47.37 39.47 39.47 28.95 31.58 23.68]
 [ 0.    0.    0.    0.    0.    0.   54.9  45.1  39.22 41.18 37.25]
 [ 0.    0.    0.    0.    0.    0.    0.   48.24 41.18 31.76 20.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   41.94 19.35  6.45]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   43.59  7.69]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   49.41]]
2024-09-07 10:17:40,745 [trainer.py] => Forgetting (CNN): 33.986000000000004
2024-09-07 10:17:43,518 [trainer.py] => config: ./exps/simplecil_ina_B0_Inc5.json
2024-09-07 10:17:43,518 [trainer.py] => prefix:  
2024-09-07 10:17:43,518 [trainer.py] => dataset: imageneta
2024-09-07 10:17:43,518 [trainer.py] => memory_size: 0
2024-09-07 10:17:43,518 [trainer.py] => memory_per_class: 0
2024-09-07 10:17:43,518 [trainer.py] => fixed_memory: False
2024-09-07 10:17:43,518 [trainer.py] => shuffle: True
2024-09-07 10:17:43,518 [trainer.py] => init_cls: 40
2024-09-07 10:17:43,518 [trainer.py] => increment: 40
2024-09-07 10:17:43,518 [trainer.py] => model_name: simplecil
2024-09-07 10:17:43,518 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 10:17:43,518 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 10:17:43,518 [trainer.py] => seed: 1993
2024-09-07 10:17:43,518 [trainer.py] => tuned_epoch: 0
2024-09-07 10:17:43,518 [trainer.py] => init_lr: 0.01
2024-09-07 10:17:43,518 [trainer.py] => batch_size: 48
2024-09-07 10:17:43,518 [trainer.py] => weight_decay: 0.05
2024-09-07 10:17:43,518 [trainer.py] => min_lr: 1e-08
2024-09-07 10:17:43,518 [trainer.py] => optimizer: sgd
2024-09-07 10:17:43,518 [trainer.py] => vpt_type: shallow
2024-09-07 10:17:43,518 [trainer.py] => prompt_token_num: 3
2024-09-07 10:17:43,544 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 10:17:45,479 [trainer.py] => All params: 85798656
2024-09-07 10:17:45,480 [trainer.py] => Trainable params: 85798656
2024-09-07 10:17:45,899 [simplecil.py] => Learning on 0-40
2024-09-07 10:17:53,085 [trainer.py] => No NME accuracy.
2024-09-07 10:17:53,086 [trainer.py] => CNN: {'total': 70.83, '00-39': 70.83, 'old': 0, 'new': 70.83}
2024-09-07 10:17:53,086 [trainer.py] => CNN top1 curve: [70.83]
2024-09-07 10:17:53,086 [trainer.py] => CNN top5 curve: [91.39]

Average Accuracy (CNN): 70.83
2024-09-07 10:17:53,086 [trainer.py] => Average Accuracy (CNN): 70.83 

2024-09-07 10:17:53,087 [trainer.py] => All params: 85829377
2024-09-07 10:17:53,088 [trainer.py] => Trainable params: 85829377
2024-09-07 10:17:53,090 [simplecil.py] => Learning on 40-80
2024-09-07 10:18:00,389 [trainer.py] => No NME accuracy.
2024-09-07 10:18:00,389 [trainer.py] => CNN: {'total': 61.6, '00-39': 62.22, '40-79': 60.95, 'old': 62.22, 'new': 60.95}
2024-09-07 10:18:00,389 [trainer.py] => CNN top1 curve: [70.83, 61.6]
2024-09-07 10:18:00,389 [trainer.py] => CNN top5 curve: [91.39, 86.68]

Average Accuracy (CNN): 66.22
2024-09-07 10:18:00,389 [trainer.py] => Average Accuracy (CNN): 66.22 

2024-09-07 10:18:00,390 [trainer.py] => All params: 85860097
2024-09-07 10:18:00,390 [trainer.py] => Trainable params: 85860097
2024-09-07 10:18:00,392 [simplecil.py] => Learning on 80-120
2024-09-07 10:18:07,810 [trainer.py] => No NME accuracy.
2024-09-07 10:18:07,811 [trainer.py] => CNN: {'total': 56.92, '00-39': 54.72, '40-79': 56.51, '80-119': 60.29, 'old': 55.59, 'new': 60.29}
2024-09-07 10:18:07,811 [trainer.py] => CNN top1 curve: [70.83, 61.6, 56.92]
2024-09-07 10:18:07,811 [trainer.py] => CNN top5 curve: [91.39, 86.68, 81.74]

Average Accuracy (CNN): 63.12
2024-09-07 10:18:07,811 [trainer.py] => Average Accuracy (CNN): 63.12 

2024-09-07 10:18:07,812 [trainer.py] => All params: 85890817
2024-09-07 10:18:07,813 [trainer.py] => Trainable params: 85890817
2024-09-07 10:18:07,816 [simplecil.py] => Learning on 120-160
2024-09-07 10:18:16,000 [trainer.py] => No NME accuracy.
2024-09-07 10:18:16,000 [trainer.py] => CNN: {'total': 51.84, '00-39': 50.0, '40-79': 53.55, '80-119': 57.4, '120-159': 46.52, 'old': 53.33, 'new': 46.52}
2024-09-07 10:18:16,000 [trainer.py] => CNN top1 curve: [70.83, 61.6, 56.92, 51.84]
2024-09-07 10:18:16,000 [trainer.py] => CNN top5 curve: [91.39, 86.68, 81.74, 78.37]

Average Accuracy (CNN): 60.3
2024-09-07 10:18:16,000 [trainer.py] => Average Accuracy (CNN): 60.3 

2024-09-07 10:18:16,001 [trainer.py] => All params: 85921537
2024-09-07 10:18:16,002 [trainer.py] => Trainable params: 85921537
2024-09-07 10:18:16,004 [simplecil.py] => Learning on 160-200
2024-09-07 10:18:25,047 [trainer.py] => No NME accuracy.
2024-09-07 10:18:25,048 [trainer.py] => CNN: {'total': 49.24, '00-39': 48.89, '40-79': 51.48, '80-119': 54.51, '120-159': 45.79, '160-199': 45.02, 'old': 50.16, 'new': 45.02}
2024-09-07 10:18:25,048 [trainer.py] => CNN top1 curve: [70.83, 61.6, 56.92, 51.84, 49.24]
2024-09-07 10:18:25,048 [trainer.py] => CNN top5 curve: [91.39, 86.68, 81.74, 78.37, 74.79]

Average Accuracy (CNN): 58.09
2024-09-07 10:18:25,048 [trainer.py] => Average Accuracy (CNN): 58.09 

Accuracy Matrix (CNN):
[[70.83 62.22 54.72 50.   48.89]
 [ 0.   60.95 56.51 53.55 51.48]
 [ 0.    0.   60.29 57.4  54.51]
 [ 0.    0.    0.   46.52 45.79]
 [ 0.    0.    0.    0.   45.02]]
2024-09-07 10:18:25,049 [trainer.py] => Forgetting (CNN): 9.480000000000002
2024-09-07 10:18:27,701 [trainer.py] => config: ./exps/simplecil_ina_B0_Inc10.json
2024-09-07 10:18:27,701 [trainer.py] => prefix:  
2024-09-07 10:18:27,701 [trainer.py] => dataset: imageneta
2024-09-07 10:18:27,701 [trainer.py] => memory_size: 0
2024-09-07 10:18:27,701 [trainer.py] => memory_per_class: 0
2024-09-07 10:18:27,701 [trainer.py] => fixed_memory: False
2024-09-07 10:18:27,701 [trainer.py] => shuffle: True
2024-09-07 10:18:27,701 [trainer.py] => init_cls: 20
2024-09-07 10:18:27,701 [trainer.py] => increment: 20
2024-09-07 10:18:27,701 [trainer.py] => model_name: simplecil
2024-09-07 10:18:27,701 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 10:18:27,702 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 10:18:27,702 [trainer.py] => seed: 1993
2024-09-07 10:18:27,702 [trainer.py] => tuned_epoch: 0
2024-09-07 10:18:27,702 [trainer.py] => init_lr: 0.01
2024-09-07 10:18:27,702 [trainer.py] => batch_size: 48
2024-09-07 10:18:27,702 [trainer.py] => weight_decay: 0.05
2024-09-07 10:18:27,702 [trainer.py] => min_lr: 1e-08
2024-09-07 10:18:27,702 [trainer.py] => optimizer: sgd
2024-09-07 10:18:27,702 [trainer.py] => vpt_type: shallow
2024-09-07 10:18:27,702 [trainer.py] => prompt_token_num: 3
2024-09-07 10:18:27,728 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 10:18:29,467 [trainer.py] => All params: 85798656
2024-09-07 10:18:29,467 [trainer.py] => Trainable params: 85798656
2024-09-07 10:18:29,830 [simplecil.py] => Learning on 0-20
2024-09-07 10:18:34,270 [trainer.py] => No NME accuracy.
2024-09-07 10:18:34,270 [trainer.py] => CNN: {'total': 76.0, '00-19': 76.0, 'old': 0, 'new': 76.0}
2024-09-07 10:18:34,270 [trainer.py] => CNN top1 curve: [76.0]
2024-09-07 10:18:34,270 [trainer.py] => CNN top5 curve: [96.57]

Average Accuracy (CNN): 76.0
2024-09-07 10:18:34,271 [trainer.py] => Average Accuracy (CNN): 76.0 

2024-09-07 10:18:34,272 [trainer.py] => All params: 85814017
2024-09-07 10:18:34,273 [trainer.py] => Trainable params: 85814017
2024-09-07 10:18:34,275 [simplecil.py] => Learning on 20-40
2024-09-07 10:18:39,218 [trainer.py] => No NME accuracy.
2024-09-07 10:18:39,219 [trainer.py] => CNN: {'total': 70.83, '00-19': 69.71, '20-39': 71.89, 'old': 69.71, 'new': 71.89}
2024-09-07 10:18:39,219 [trainer.py] => CNN top1 curve: [76.0, 70.83]
2024-09-07 10:18:39,219 [trainer.py] => CNN top5 curve: [96.57, 91.39]

Average Accuracy (CNN): 73.41
2024-09-07 10:18:39,219 [trainer.py] => Average Accuracy (CNN): 73.41 

2024-09-07 10:18:39,220 [trainer.py] => All params: 85829377
2024-09-07 10:18:39,220 [trainer.py] => Trainable params: 85829377
2024-09-07 10:18:39,222 [simplecil.py] => Learning on 40-60
2024-09-07 10:18:43,718 [trainer.py] => No NME accuracy.
2024-09-07 10:18:43,718 [trainer.py] => CNN: {'total': 65.13, '00-19': 68.0, '20-39': 64.86, '40-59': 61.21, 'old': 66.39, 'new': 61.21}
2024-09-07 10:18:43,718 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13]
2024-09-07 10:18:43,719 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71]

Average Accuracy (CNN): 70.65
2024-09-07 10:18:43,719 [trainer.py] => Average Accuracy (CNN): 70.65 

2024-09-07 10:18:43,720 [trainer.py] => All params: 85844737
2024-09-07 10:18:43,720 [trainer.py] => Trainable params: 85844737
2024-09-07 10:18:43,722 [simplecil.py] => Learning on 60-80
2024-09-07 10:18:49,738 [trainer.py] => No NME accuracy.
2024-09-07 10:18:49,738 [trainer.py] => CNN: {'total': 61.6, '00-19': 61.14, '20-39': 63.24, '40-59': 58.62, '60-79': 62.16, 'old': 61.34, 'new': 62.16}
2024-09-07 10:18:49,738 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13, 61.6]
2024-09-07 10:18:49,738 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71, 86.68]

Average Accuracy (CNN): 68.39
2024-09-07 10:18:49,739 [trainer.py] => Average Accuracy (CNN): 68.39 

2024-09-07 10:18:49,740 [trainer.py] => All params: 85860097
2024-09-07 10:18:49,741 [trainer.py] => Trainable params: 85860097
2024-09-07 10:18:49,744 [simplecil.py] => Learning on 80-100
2024-09-07 10:18:55,309 [trainer.py] => No NME accuracy.
2024-09-07 10:18:55,310 [trainer.py] => CNN: {'total': 58.03, '00-19': 54.86, '20-39': 59.46, '40-59': 56.9, '60-79': 60.36, '80-99': 57.34, 'old': 58.17, 'new': 57.34}
2024-09-07 10:18:55,310 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13, 61.6, 58.03]
2024-09-07 10:18:55,310 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71, 86.68, 83.35]

Average Accuracy (CNN): 66.32
2024-09-07 10:18:55,310 [trainer.py] => Average Accuracy (CNN): 66.32 

2024-09-07 10:18:55,311 [trainer.py] => All params: 85875457
2024-09-07 10:18:55,313 [trainer.py] => Trainable params: 85875457
2024-09-07 10:18:55,315 [simplecil.py] => Learning on 100-120
2024-09-07 10:19:01,306 [trainer.py] => No NME accuracy.
2024-09-07 10:19:01,307 [trainer.py] => CNN: {'total': 56.92, '00-19': 53.71, '20-39': 55.68, '40-59': 53.45, '60-79': 58.11, '80-99': 55.94, '100-119': 64.93, 'old': 55.65, 'new': 64.93}
2024-09-07 10:19:01,307 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13, 61.6, 58.03, 56.92]
2024-09-07 10:19:01,307 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71, 86.68, 83.35, 81.74]

Average Accuracy (CNN): 64.75
2024-09-07 10:19:01,307 [trainer.py] => Average Accuracy (CNN): 64.75 

2024-09-07 10:19:01,308 [trainer.py] => All params: 85890817
2024-09-07 10:19:01,309 [trainer.py] => Trainable params: 85890817
2024-09-07 10:19:01,311 [simplecil.py] => Learning on 120-140
2024-09-07 10:19:07,660 [trainer.py] => No NME accuracy.
2024-09-07 10:19:07,661 [trainer.py] => CNN: {'total': 54.06, '00-19': 49.71, '20-39': 54.05, '40-59': 52.59, '60-79': 55.41, '80-99': 53.85, '100-119': 63.43, '120-139': 50.0, 'old': 54.67, 'new': 50.0}
2024-09-07 10:19:07,661 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13, 61.6, 58.03, 56.92, 54.06]
2024-09-07 10:19:07,661 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71, 86.68, 83.35, 81.74, 79.66]

Average Accuracy (CNN): 63.22
2024-09-07 10:19:07,661 [trainer.py] => Average Accuracy (CNN): 63.22 

2024-09-07 10:19:07,662 [trainer.py] => All params: 85906177
2024-09-07 10:19:07,663 [trainer.py] => Trainable params: 85906177
2024-09-07 10:19:07,666 [simplecil.py] => Learning on 140-160
2024-09-07 10:19:14,370 [trainer.py] => No NME accuracy.
2024-09-07 10:19:14,370 [trainer.py] => CNN: {'total': 51.84, '00-19': 47.43, '20-39': 52.43, '40-59': 52.59, '60-79': 54.05, '80-99': 52.45, '100-119': 62.69, '120-139': 48.63, '140-159': 44.09, 'old': 52.72, 'new': 44.09}
2024-09-07 10:19:14,370 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13, 61.6, 58.03, 56.92, 54.06, 51.84]
2024-09-07 10:19:14,370 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71, 86.68, 83.35, 81.74, 79.66, 78.37]

Average Accuracy (CNN): 61.8
2024-09-07 10:19:14,371 [trainer.py] => Average Accuracy (CNN): 61.8 

2024-09-07 10:19:14,372 [trainer.py] => All params: 85921537
2024-09-07 10:19:14,373 [trainer.py] => Trainable params: 85921537
2024-09-07 10:19:14,375 [simplecil.py] => Learning on 160-180
2024-09-07 10:19:21,623 [trainer.py] => No NME accuracy.
2024-09-07 10:19:21,624 [trainer.py] => CNN: {'total': 49.68, '00-19': 46.86, '20-39': 51.35, '40-59': 50.0, '60-79': 53.15, '80-99': 51.05, '100-119': 61.19, '120-139': 47.95, '140-159': 44.09, '160-179': 40.14, 'old': 50.8, 'new': 40.14}
2024-09-07 10:19:21,624 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13, 61.6, 58.03, 56.92, 54.06, 51.84, 49.68]
2024-09-07 10:19:21,624 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71, 86.68, 83.35, 81.74, 79.66, 78.37, 76.49]

Average Accuracy (CNN): 60.45
2024-09-07 10:19:21,624 [trainer.py] => Average Accuracy (CNN): 60.45 

2024-09-07 10:19:21,625 [trainer.py] => All params: 85936897
2024-09-07 10:19:21,625 [trainer.py] => Trainable params: 85936897
2024-09-07 10:19:21,628 [simplecil.py] => Learning on 180-200
2024-09-07 10:19:29,129 [trainer.py] => No NME accuracy.
2024-09-07 10:19:29,129 [trainer.py] => CNN: {'total': 49.24, '00-19': 46.86, '20-39': 50.81, '40-59': 50.0, '60-79': 52.25, '80-99': 49.65, '100-119': 59.7, '120-139': 47.95, '140-159': 43.31, '160-179': 40.14, '180-199': 50.81, 'old': 49.1, 'new': 50.81}
2024-09-07 10:19:29,129 [trainer.py] => CNN top1 curve: [76.0, 70.83, 65.13, 61.6, 58.03, 56.92, 54.06, 51.84, 49.68, 49.24]
2024-09-07 10:19:29,129 [trainer.py] => CNN top5 curve: [96.57, 91.39, 89.71, 86.68, 83.35, 81.74, 79.66, 78.37, 76.49, 74.79]

Average Accuracy (CNN): 59.33
2024-09-07 10:19:29,129 [trainer.py] => Average Accuracy (CNN): 59.33 

Accuracy Matrix (CNN):
[[76.   69.71 68.   61.14 54.86 53.71 49.71 47.43 46.86 46.86]
 [ 0.   71.89 64.86 63.24 59.46 55.68 54.05 52.43 51.35 50.81]
 [ 0.    0.   61.21 58.62 56.9  53.45 52.59 52.59 50.   50.  ]
 [ 0.    0.    0.   62.16 60.36 58.11 55.41 54.05 53.15 52.25]
 [ 0.    0.    0.    0.   57.34 55.94 53.85 52.45 51.05 49.65]
 [ 0.    0.    0.    0.    0.   64.93 63.43 62.69 61.19 59.7 ]
 [ 0.    0.    0.    0.    0.    0.   50.   48.63 47.95 47.95]
 [ 0.    0.    0.    0.    0.    0.    0.   44.09 44.09 43.31]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   40.14 40.14]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   50.81]]
2024-09-07 10:19:29,130 [trainer.py] => Forgetting (CNN): 9.676666666666668
2024-09-07 10:19:31,835 [trainer.py] => config: ./exps/simplecil_ina_B0_Inc20.json
2024-09-07 10:19:31,849 [trainer.py] => prefix:  
2024-09-07 10:19:31,849 [trainer.py] => dataset: imageneta
2024-09-07 10:19:31,849 [trainer.py] => memory_size: 0
2024-09-07 10:19:31,849 [trainer.py] => memory_per_class: 0
2024-09-07 10:19:31,849 [trainer.py] => fixed_memory: False
2024-09-07 10:19:31,849 [trainer.py] => shuffle: True
2024-09-07 10:19:31,849 [trainer.py] => init_cls: 10
2024-09-07 10:19:31,849 [trainer.py] => increment: 10
2024-09-07 10:19:31,849 [trainer.py] => model_name: simplecil
2024-09-07 10:19:31,849 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 10:19:31,849 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 10:19:31,849 [trainer.py] => seed: 1993
2024-09-07 10:19:31,849 [trainer.py] => tuned_epoch: 20
2024-09-07 10:19:31,849 [trainer.py] => init_lr: 0.01
2024-09-07 10:19:31,849 [trainer.py] => batch_size: 48
2024-09-07 10:19:31,849 [trainer.py] => weight_decay: 0.05
2024-09-07 10:19:31,849 [trainer.py] => min_lr: 1e-08
2024-09-07 10:19:31,849 [trainer.py] => optimizer: sgd
2024-09-07 10:19:31,849 [trainer.py] => vpt_type: shallow
2024-09-07 10:19:31,849 [trainer.py] => prompt_token_num: 3
2024-09-07 10:19:31,888 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 10:19:33,646 [trainer.py] => All params: 85798656
2024-09-07 10:19:33,648 [trainer.py] => Trainable params: 85798656
2024-09-07 10:19:34,038 [simplecil.py] => Learning on 0-10
2024-09-07 10:19:36,913 [trainer.py] => No NME accuracy.
2024-09-07 10:19:36,913 [trainer.py] => CNN: {'total': 76.62, '00-09': 76.62, 'old': 0, 'new': 76.62}
2024-09-07 10:19:36,913 [trainer.py] => CNN top1 curve: [76.62]
2024-09-07 10:19:36,913 [trainer.py] => CNN top5 curve: [94.81]

Average Accuracy (CNN): 76.62
2024-09-07 10:19:36,913 [trainer.py] => Average Accuracy (CNN): 76.62 

2024-09-07 10:19:36,914 [trainer.py] => All params: 85806337
2024-09-07 10:19:36,915 [trainer.py] => Trainable params: 85806337
2024-09-07 10:19:36,917 [simplecil.py] => Learning on 10-20
2024-09-07 10:19:40,381 [trainer.py] => No NME accuracy.
2024-09-07 10:19:40,381 [trainer.py] => CNN: {'total': 76.0, '00-09': 67.53, '10-19': 82.65, 'old': 67.53, 'new': 82.65}
2024-09-07 10:19:40,381 [trainer.py] => CNN top1 curve: [76.62, 76.0]
2024-09-07 10:19:40,381 [trainer.py] => CNN top5 curve: [94.81, 96.57]

Average Accuracy (CNN): 76.31
2024-09-07 10:19:40,381 [trainer.py] => Average Accuracy (CNN): 76.31 

2024-09-07 10:19:40,382 [trainer.py] => All params: 85814017
2024-09-07 10:19:40,383 [trainer.py] => Trainable params: 85814017
2024-09-07 10:19:40,384 [simplecil.py] => Learning on 20-30
2024-09-07 10:19:43,946 [trainer.py] => No NME accuracy.
2024-09-07 10:19:43,946 [trainer.py] => CNN: {'total': 74.45, '00-09': 61.04, '10-19': 80.61, '20-29': 78.79, 'old': 72.0, 'new': 78.79}
2024-09-07 10:19:43,947 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45]
2024-09-07 10:19:43,947 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26]

Average Accuracy (CNN): 75.69
2024-09-07 10:19:43,947 [trainer.py] => Average Accuracy (CNN): 75.69 

2024-09-07 10:19:43,949 [trainer.py] => All params: 85821697
2024-09-07 10:19:43,950 [trainer.py] => Trainable params: 85821697
2024-09-07 10:19:43,952 [simplecil.py] => Learning on 30-40
2024-09-07 10:19:47,810 [trainer.py] => No NME accuracy.
2024-09-07 10:19:47,811 [trainer.py] => CNN: {'total': 70.83, '00-09': 57.14, '10-19': 79.59, '20-29': 74.75, '30-39': 68.6, 'old': 71.53, 'new': 68.6}
2024-09-07 10:19:47,811 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83]
2024-09-07 10:19:47,811 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39]

Average Accuracy (CNN): 74.47
2024-09-07 10:19:47,811 [trainer.py] => Average Accuracy (CNN): 74.47 

2024-09-07 10:19:47,812 [trainer.py] => All params: 85829377
2024-09-07 10:19:47,812 [trainer.py] => Trainable params: 85829377
2024-09-07 10:19:47,814 [simplecil.py] => Learning on 40-50
2024-09-07 10:19:51,577 [trainer.py] => No NME accuracy.
2024-09-07 10:19:51,577 [trainer.py] => CNN: {'total': 66.51, '00-09': 54.55, '10-19': 78.57, '20-29': 70.71, '30-39': 65.12, '40-49': 57.81, 'old': 68.06, 'new': 57.81}
2024-09-07 10:19:51,577 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51]
2024-09-07 10:19:51,577 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57]

Average Accuracy (CNN): 72.88
2024-09-07 10:19:51,577 [trainer.py] => Average Accuracy (CNN): 72.88 

2024-09-07 10:19:51,579 [trainer.py] => All params: 85837057
2024-09-07 10:19:51,580 [trainer.py] => Trainable params: 85837057
2024-09-07 10:19:51,582 [simplecil.py] => Learning on 50-60
2024-09-07 10:19:55,309 [trainer.py] => No NME accuracy.
2024-09-07 10:19:55,309 [trainer.py] => CNN: {'total': 65.13, '00-09': 54.55, '10-19': 78.57, '20-29': 64.65, '30-39': 65.12, '40-49': 54.69, '50-59': 69.23, 'old': 64.62, 'new': 69.23}
2024-09-07 10:19:55,309 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13]
2024-09-07 10:19:55,309 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71]

Average Accuracy (CNN): 71.59
2024-09-07 10:19:55,309 [trainer.py] => Average Accuracy (CNN): 71.59 

2024-09-07 10:19:55,311 [trainer.py] => All params: 85844737
2024-09-07 10:19:55,312 [trainer.py] => Trainable params: 85844737
2024-09-07 10:19:55,314 [simplecil.py] => Learning on 60-70
2024-09-07 10:20:00,017 [trainer.py] => No NME accuracy.
2024-09-07 10:20:00,018 [trainer.py] => CNN: {'total': 63.12, '00-09': 53.25, '10-19': 75.51, '20-29': 64.65, '30-39': 62.79, '40-49': 50.0, '50-59': 69.23, '60-69': 62.7, 'old': 63.24, 'new': 62.7}
2024-09-07 10:20:00,018 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12]
2024-09-07 10:20:00,018 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87]

Average Accuracy (CNN): 70.38
2024-09-07 10:20:00,018 [trainer.py] => Average Accuracy (CNN): 70.38 

2024-09-07 10:20:00,019 [trainer.py] => All params: 85852417
2024-09-07 10:20:00,020 [trainer.py] => Trainable params: 85852417
2024-09-07 10:20:00,022 [simplecil.py] => Learning on 70-80
2024-09-07 10:20:04,637 [trainer.py] => No NME accuracy.
2024-09-07 10:20:04,637 [trainer.py] => CNN: {'total': 61.6, '00-09': 48.05, '10-19': 71.43, '20-29': 64.65, '30-39': 61.63, '40-49': 50.0, '50-59': 69.23, '60-69': 61.9, '70-79': 62.5, 'old': 61.46, 'new': 62.5}
2024-09-07 10:20:04,638 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6]
2024-09-07 10:20:04,638 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68]

Average Accuracy (CNN): 69.28
2024-09-07 10:20:04,638 [trainer.py] => Average Accuracy (CNN): 69.28 

2024-09-07 10:20:04,639 [trainer.py] => All params: 85860097
2024-09-07 10:20:04,640 [trainer.py] => Trainable params: 85860097
2024-09-07 10:20:04,642 [simplecil.py] => Learning on 80-90
2024-09-07 10:20:09,328 [trainer.py] => No NME accuracy.
2024-09-07 10:20:09,328 [trainer.py] => CNN: {'total': 61.36, '00-09': 45.45, '10-19': 69.39, '20-29': 63.64, '30-39': 59.3, '40-49': 50.0, '50-59': 69.23, '60-69': 61.9, '70-79': 61.46, '80-89': 69.14, 'old': 60.46, 'new': 69.14}
2024-09-07 10:20:09,328 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36]
2024-09-07 10:20:09,328 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88]

Average Accuracy (CNN): 68.4
2024-09-07 10:20:09,329 [trainer.py] => Average Accuracy (CNN): 68.4 

2024-09-07 10:20:09,330 [trainer.py] => All params: 85867777
2024-09-07 10:20:09,331 [trainer.py] => Trainable params: 85867777
2024-09-07 10:20:09,334 [simplecil.py] => Learning on 90-100
2024-09-07 10:20:14,033 [trainer.py] => No NME accuracy.
2024-09-07 10:20:14,034 [trainer.py] => CNN: {'total': 58.03, '00-09': 37.66, '10-19': 68.37, '20-29': 59.6, '30-39': 59.3, '40-49': 48.44, '50-59': 67.31, '60-69': 61.9, '70-79': 58.33, '80-89': 65.43, '90-99': 46.77, 'old': 58.92, 'new': 46.77}
2024-09-07 10:20:14,034 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03]
2024-09-07 10:20:14,034 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35]

Average Accuracy (CNN): 67.36
2024-09-07 10:20:14,034 [trainer.py] => Average Accuracy (CNN): 67.36 

2024-09-07 10:20:14,035 [trainer.py] => All params: 85875457
2024-09-07 10:20:14,036 [trainer.py] => Trainable params: 85875457
2024-09-07 10:20:14,038 [simplecil.py] => Learning on 100-110
2024-09-07 10:20:19,025 [trainer.py] => No NME accuracy.
2024-09-07 10:20:19,026 [trainer.py] => CNN: {'total': 57.38, '00-09': 37.66, '10-19': 67.35, '20-29': 57.58, '30-39': 58.14, '40-49': 48.44, '50-59': 63.46, '60-69': 59.52, '70-79': 56.25, '80-89': 64.2, '90-99': 46.77, '100-109': 68.33, 'old': 56.6, 'new': 68.33}
2024-09-07 10:20:19,026 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38]
2024-09-07 10:20:19,026 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57]

Average Accuracy (CNN): 66.46
2024-09-07 10:20:19,026 [trainer.py] => Average Accuracy (CNN): 66.46 

2024-09-07 10:20:19,027 [trainer.py] => All params: 85883137
2024-09-07 10:20:19,028 [trainer.py] => Trainable params: 85883137
2024-09-07 10:20:19,031 [simplecil.py] => Learning on 110-120
2024-09-07 10:20:24,245 [trainer.py] => No NME accuracy.
2024-09-07 10:20:24,246 [trainer.py] => CNN: {'total': 56.92, '00-09': 37.66, '10-19': 66.33, '20-29': 55.56, '30-39': 55.81, '40-49': 46.88, '50-59': 61.54, '60-69': 59.52, '70-79': 56.25, '80-89': 64.2, '90-99': 45.16, '100-109': 68.33, '110-119': 62.16, 'old': 56.49, 'new': 62.16}
2024-09-07 10:20:24,246 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92]
2024-09-07 10:20:24,246 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74]

Average Accuracy (CNN): 65.66
2024-09-07 10:20:24,246 [trainer.py] => Average Accuracy (CNN): 65.66 

2024-09-07 10:20:24,247 [trainer.py] => All params: 85890817
2024-09-07 10:20:24,248 [trainer.py] => Trainable params: 85890817
2024-09-07 10:20:24,250 [simplecil.py] => Learning on 120-130
2024-09-07 10:20:29,522 [trainer.py] => No NME accuracy.
2024-09-07 10:20:29,523 [trainer.py] => CNN: {'total': 55.27, '00-09': 36.36, '10-19': 64.29, '20-29': 55.56, '30-39': 54.65, '40-49': 46.88, '50-59': 59.62, '60-69': 59.52, '70-79': 55.21, '80-89': 62.96, '90-99': 43.55, '100-109': 66.67, '110-119': 62.16, '120-129': 43.33, 'old': 56.0, 'new': 43.33}
2024-09-07 10:20:29,523 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27]
2024-09-07 10:20:29,523 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39]

Average Accuracy (CNN): 64.86
2024-09-07 10:20:29,523 [trainer.py] => Average Accuracy (CNN): 64.86 

2024-09-07 10:20:29,525 [trainer.py] => All params: 85898497
2024-09-07 10:20:29,526 [trainer.py] => Trainable params: 85898497
2024-09-07 10:20:29,531 [simplecil.py] => Learning on 130-140
2024-09-07 10:20:35,288 [trainer.py] => No NME accuracy.
2024-09-07 10:20:35,289 [trainer.py] => CNN: {'total': 54.06, '00-09': 36.36, '10-19': 60.2, '20-29': 53.54, '30-39': 54.65, '40-49': 46.88, '50-59': 59.62, '60-69': 56.35, '70-79': 54.17, '80-89': 61.73, '90-99': 43.55, '100-109': 66.67, '110-119': 60.81, '120-129': 41.67, '130-139': 55.81, 'old': 53.91, 'new': 55.81}
2024-09-07 10:20:35,289 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27, 54.06]
2024-09-07 10:20:35,289 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39, 79.66]

Average Accuracy (CNN): 64.09
2024-09-07 10:20:35,289 [trainer.py] => Average Accuracy (CNN): 64.09 

2024-09-07 10:20:35,290 [trainer.py] => All params: 85906177
2024-09-07 10:20:35,291 [trainer.py] => Trainable params: 85906177
2024-09-07 10:20:35,293 [simplecil.py] => Learning on 140-150
2024-09-07 10:20:41,223 [trainer.py] => No NME accuracy.
2024-09-07 10:20:41,223 [trainer.py] => CNN: {'total': 53.05, '00-09': 36.36, '10-19': 59.18, '20-29': 51.52, '30-39': 53.49, '40-49': 46.88, '50-59': 59.62, '60-69': 55.56, '70-79': 53.12, '80-89': 60.49, '90-99': 43.55, '100-109': 65.0, '110-119': 60.81, '120-129': 41.67, '130-139': 54.65, '140-149': 50.0, 'old': 53.26, 'new': 50.0}
2024-09-07 10:20:41,223 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27, 54.06, 53.05]
2024-09-07 10:20:41,224 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39, 79.66, 79.28]

Average Accuracy (CNN): 63.36
2024-09-07 10:20:41,224 [trainer.py] => Average Accuracy (CNN): 63.36 

2024-09-07 10:20:41,225 [trainer.py] => All params: 85913857
2024-09-07 10:20:41,226 [trainer.py] => Trainable params: 85913857
2024-09-07 10:20:41,228 [simplecil.py] => Learning on 150-160
2024-09-07 10:20:47,025 [trainer.py] => No NME accuracy.
2024-09-07 10:20:47,025 [trainer.py] => CNN: {'total': 51.84, '00-09': 35.06, '10-19': 57.14, '20-29': 51.52, '30-39': 53.49, '40-49': 46.88, '50-59': 59.62, '60-69': 55.56, '70-79': 52.08, '80-89': 60.49, '90-99': 41.94, '100-109': 65.0, '110-119': 60.81, '120-129': 40.0, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, 'old': 52.55, 'new': 35.29}
2024-09-07 10:20:47,025 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84]
2024-09-07 10:20:47,026 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37]

Average Accuracy (CNN): 62.64
2024-09-07 10:20:47,026 [trainer.py] => Average Accuracy (CNN): 62.64 

2024-09-07 10:20:47,027 [trainer.py] => All params: 85921537
2024-09-07 10:20:47,027 [trainer.py] => Trainable params: 85921537
2024-09-07 10:20:47,029 [simplecil.py] => Learning on 160-170
2024-09-07 10:20:53,403 [trainer.py] => No NME accuracy.
2024-09-07 10:20:53,403 [trainer.py] => CNN: {'total': 50.49, '00-09': 33.77, '10-19': 57.14, '20-29': 50.51, '30-39': 53.49, '40-49': 43.75, '50-59': 57.69, '60-69': 55.56, '70-79': 52.08, '80-89': 60.49, '90-99': 41.94, '100-109': 65.0, '110-119': 60.81, '120-129': 40.0, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, '160-169': 36.47, 'old': 51.44, 'new': 36.47}
2024-09-07 10:20:53,403 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49]
2024-09-07 10:20:53,403 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27]

Average Accuracy (CNN): 61.92
2024-09-07 10:20:53,403 [trainer.py] => Average Accuracy (CNN): 61.92 

2024-09-07 10:20:53,404 [trainer.py] => All params: 85929217
2024-09-07 10:20:53,405 [trainer.py] => Trainable params: 85929217
2024-09-07 10:20:53,409 [simplecil.py] => Learning on 170-180
2024-09-07 10:20:59,641 [trainer.py] => No NME accuracy.
2024-09-07 10:20:59,641 [trainer.py] => CNN: {'total': 49.68, '00-09': 33.77, '10-19': 57.14, '20-29': 50.51, '30-39': 52.33, '40-49': 43.75, '50-59': 57.69, '60-69': 54.76, '70-79': 51.04, '80-89': 60.49, '90-99': 38.71, '100-109': 65.0, '110-119': 58.11, '120-129': 38.33, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, '160-169': 36.47, '170-179': 45.16, 'old': 49.89, 'new': 45.16}
2024-09-07 10:20:59,641 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49, 49.68]
2024-09-07 10:20:59,641 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27, 76.49]

Average Accuracy (CNN): 61.24
2024-09-07 10:20:59,641 [trainer.py] => Average Accuracy (CNN): 61.24 

2024-09-07 10:20:59,642 [trainer.py] => All params: 85936897
2024-09-07 10:20:59,643 [trainer.py] => Trainable params: 85936897
2024-09-07 10:20:59,646 [simplecil.py] => Learning on 180-190
2024-09-07 10:21:05,926 [trainer.py] => No NME accuracy.
2024-09-07 10:21:05,927 [trainer.py] => CNN: {'total': 49.37, '00-09': 33.77, '10-19': 57.14, '20-29': 49.49, '30-39': 52.33, '40-49': 43.75, '50-59': 57.69, '60-69': 53.17, '70-79': 51.04, '80-89': 60.49, '90-99': 38.71, '100-109': 65.0, '110-119': 58.11, '120-129': 38.33, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, '160-169': 36.47, '170-179': 45.16, '180-189': 46.15, 'old': 49.46, 'new': 46.15}
2024-09-07 10:21:05,927 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49, 49.68, 49.37]
2024-09-07 10:21:05,927 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27, 76.49, 75.87]

Average Accuracy (CNN): 60.62
2024-09-07 10:21:05,928 [trainer.py] => Average Accuracy (CNN): 60.62 

2024-09-07 10:21:05,929 [trainer.py] => All params: 85944577
2024-09-07 10:21:05,930 [trainer.py] => Trainable params: 85944577
2024-09-07 10:21:05,934 [simplecil.py] => Learning on 190-200
2024-09-07 10:21:12,798 [trainer.py] => No NME accuracy.
2024-09-07 10:21:12,798 [trainer.py] => CNN: {'total': 49.24, '00-09': 33.77, '10-19': 57.14, '20-29': 49.49, '30-39': 52.33, '40-49': 43.75, '50-59': 57.69, '60-69': 53.17, '70-79': 51.04, '80-89': 59.26, '90-99': 37.1, '100-109': 63.33, '110-119': 56.76, '120-129': 38.33, '130-139': 54.65, '140-149': 50.0, '150-159': 33.33, '160-169': 36.47, '170-179': 45.16, '180-189': 46.15, '190-199': 52.94, 'old': 49.02, 'new': 52.94}
2024-09-07 10:21:12,798 [trainer.py] => CNN top1 curve: [76.62, 76.0, 74.45, 70.83, 66.51, 65.13, 63.12, 61.6, 61.36, 58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49, 49.68, 49.37, 49.24]
2024-09-07 10:21:12,798 [trainer.py] => CNN top5 curve: [94.81, 96.57, 95.26, 91.39, 90.57, 89.71, 87.87, 86.68, 85.88, 83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27, 76.49, 75.87, 74.79]

Average Accuracy (CNN): 60.05
2024-09-07 10:21:12,798 [trainer.py] => Average Accuracy (CNN): 60.05 

Accuracy Matrix (CNN):
[[76.62 67.53 61.04 57.14 54.55 54.55 53.25 48.05 45.45 37.66 37.66 37.66
  36.36 36.36 36.36 35.06 33.77 33.77 33.77 33.77]
 [ 0.   82.65 80.61 79.59 78.57 78.57 75.51 71.43 69.39 68.37 67.35 66.33
  64.29 60.2  59.18 57.14 57.14 57.14 57.14 57.14]
 [ 0.    0.   78.79 74.75 70.71 64.65 64.65 64.65 63.64 59.6  57.58 55.56
  55.56 53.54 51.52 51.52 50.51 50.51 49.49 49.49]
 [ 0.    0.    0.   68.6  65.12 65.12 62.79 61.63 59.3  59.3  58.14 55.81
  54.65 54.65 53.49 53.49 53.49 52.33 52.33 52.33]
 [ 0.    0.    0.    0.   57.81 54.69 50.   50.   50.   48.44 48.44 46.88
  46.88 46.88 46.88 46.88 43.75 43.75 43.75 43.75]
 [ 0.    0.    0.    0.    0.   69.23 69.23 69.23 69.23 67.31 63.46 61.54
  59.62 59.62 59.62 59.62 57.69 57.69 57.69 57.69]
 [ 0.    0.    0.    0.    0.    0.   62.7  61.9  61.9  61.9  59.52 59.52
  59.52 56.35 55.56 55.56 55.56 54.76 53.17 53.17]
 [ 0.    0.    0.    0.    0.    0.    0.   62.5  61.46 58.33 56.25 56.25
  55.21 54.17 53.12 52.08 52.08 51.04 51.04 51.04]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   69.14 65.43 64.2  64.2
  62.96 61.73 60.49 60.49 60.49 60.49 60.49 59.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   46.77 46.77 45.16
  43.55 43.55 43.55 41.94 41.94 38.71 38.71 37.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   68.33 68.33
  66.67 66.67 65.   65.   65.   65.   65.   63.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   62.16
  62.16 60.81 60.81 60.81 60.81 58.11 58.11 56.76]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  43.33 41.67 41.67 40.   40.   38.33 38.33 38.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   55.81 54.65 54.65 54.65 54.65 54.65 54.65]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   50.   50.   50.   50.   50.   50.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   35.29 35.29 35.29 35.29 33.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   36.47 36.47 36.47 36.47]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   45.16 45.16 45.16]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   46.15 46.15]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   52.94]]
2024-09-07 10:21:12,800 [trainer.py] => Forgetting (CNN): 10.452105263157895
2024-09-07 10:21:15,455 [trainer.py] => config: ./exps/simplecil_ina_B100_Inc5.json
2024-09-07 10:21:15,467 [trainer.py] => prefix:  
2024-09-07 10:21:15,467 [trainer.py] => dataset: imageneta
2024-09-07 10:21:15,467 [trainer.py] => memory_size: 0
2024-09-07 10:21:15,467 [trainer.py] => memory_per_class: 0
2024-09-07 10:21:15,467 [trainer.py] => fixed_memory: False
2024-09-07 10:21:15,467 [trainer.py] => shuffle: True
2024-09-07 10:21:15,467 [trainer.py] => init_cls: 100
2024-09-07 10:21:15,467 [trainer.py] => increment: 20
2024-09-07 10:21:15,467 [trainer.py] => model_name: simplecil
2024-09-07 10:21:15,467 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 10:21:15,467 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 10:21:15,467 [trainer.py] => seed: 1993
2024-09-07 10:21:15,467 [trainer.py] => tuned_epoch: 0
2024-09-07 10:21:15,467 [trainer.py] => init_lr: 0.01
2024-09-07 10:21:15,467 [trainer.py] => batch_size: 48
2024-09-07 10:21:15,467 [trainer.py] => weight_decay: 0.05
2024-09-07 10:21:15,467 [trainer.py] => min_lr: 1e-08
2024-09-07 10:21:15,467 [trainer.py] => optimizer: sgd
2024-09-07 10:21:15,467 [trainer.py] => vpt_type: shallow
2024-09-07 10:21:15,467 [trainer.py] => prompt_token_num: 3
2024-09-07 10:21:15,493 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 10:21:17,213 [trainer.py] => All params: 85798656
2024-09-07 10:21:17,214 [trainer.py] => Trainable params: 85798656
2024-09-07 10:21:17,628 [simplecil.py] => Learning on 0-100
2024-09-07 10:21:31,135 [trainer.py] => No NME accuracy.
2024-09-07 10:21:31,135 [trainer.py] => CNN: {'total': 58.03, '00-99': 58.03, 'old': 0, 'new': 58.03}
2024-09-07 10:21:31,135 [trainer.py] => CNN top1 curve: [58.03]
2024-09-07 10:21:31,135 [trainer.py] => CNN top5 curve: [83.35]

Average Accuracy (CNN): 58.03
2024-09-07 10:21:31,136 [trainer.py] => Average Accuracy (CNN): 58.03 

2024-09-07 10:21:31,137 [trainer.py] => All params: 85875457
2024-09-07 10:21:31,138 [trainer.py] => Trainable params: 85875457
2024-09-07 10:21:31,140 [simplecil.py] => Learning on 100-120
2024-09-07 10:21:37,059 [trainer.py] => No NME accuracy.
2024-09-07 10:21:37,060 [trainer.py] => CNN: {'total': 56.92, '00-99': 55.65, '100-119': 64.93, 'old': 55.65, 'new': 64.93}
2024-09-07 10:21:37,060 [trainer.py] => CNN top1 curve: [58.03, 56.92]
2024-09-07 10:21:37,060 [trainer.py] => CNN top5 curve: [83.35, 81.74]

Average Accuracy (CNN): 57.48
2024-09-07 10:21:37,060 [trainer.py] => Average Accuracy (CNN): 57.48 

2024-09-07 10:21:37,061 [trainer.py] => All params: 85890817
2024-09-07 10:21:37,062 [trainer.py] => Trainable params: 85890817
2024-09-07 10:21:37,065 [simplecil.py] => Learning on 120-140
2024-09-07 10:21:43,393 [trainer.py] => No NME accuracy.
2024-09-07 10:21:43,393 [trainer.py] => CNN: {'total': 54.06, '00-99': 53.27, '100-119': 63.43, '120-139': 50.0, 'old': 54.67, 'new': 50.0}
2024-09-07 10:21:43,394 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06]
2024-09-07 10:21:43,394 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66]

Average Accuracy (CNN): 56.34
2024-09-07 10:21:43,394 [trainer.py] => Average Accuracy (CNN): 56.34 

2024-09-07 10:21:43,395 [trainer.py] => All params: 85906177
2024-09-07 10:21:43,396 [trainer.py] => Trainable params: 85906177
2024-09-07 10:21:43,398 [simplecil.py] => Learning on 140-160
2024-09-07 10:21:50,030 [trainer.py] => No NME accuracy.
2024-09-07 10:21:50,030 [trainer.py] => CNN: {'total': 51.84, '00-99': 51.84, '100-119': 62.69, '120-139': 48.63, '140-159': 44.09, 'old': 52.72, 'new': 44.09}
2024-09-07 10:21:50,030 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06, 51.84]
2024-09-07 10:21:50,030 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66, 78.37]

Average Accuracy (CNN): 55.21
2024-09-07 10:21:50,030 [trainer.py] => Average Accuracy (CNN): 55.21 

2024-09-07 10:21:50,031 [trainer.py] => All params: 85921537
2024-09-07 10:21:50,032 [trainer.py] => Trainable params: 85921537
2024-09-07 10:21:50,034 [simplecil.py] => Learning on 160-180
2024-09-07 10:21:57,227 [trainer.py] => No NME accuracy.
2024-09-07 10:21:57,227 [trainer.py] => CNN: {'total': 49.68, '00-99': 50.65, '100-119': 61.19, '120-139': 47.95, '140-159': 44.09, '160-179': 40.14, 'old': 50.8, 'new': 40.14}
2024-09-07 10:21:57,227 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06, 51.84, 49.68]
2024-09-07 10:21:57,227 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66, 78.37, 76.49]

Average Accuracy (CNN): 54.11
2024-09-07 10:21:57,227 [trainer.py] => Average Accuracy (CNN): 54.11 

2024-09-07 10:21:57,228 [trainer.py] => All params: 85936897
2024-09-07 10:21:57,229 [trainer.py] => Trainable params: 85936897
2024-09-07 10:21:57,231 [simplecil.py] => Learning on 180-200
2024-09-07 10:22:04,703 [trainer.py] => No NME accuracy.
2024-09-07 10:22:04,704 [trainer.py] => CNN: {'total': 49.24, '00-99': 50.06, '100-119': 59.7, '120-139': 47.95, '140-159': 43.31, '160-179': 40.14, '180-199': 50.81, 'old': 49.1, 'new': 50.81}
2024-09-07 10:22:04,704 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06, 51.84, 49.68, 49.24]
2024-09-07 10:22:04,704 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66, 78.37, 76.49, 74.79]

Average Accuracy (CNN): 53.29
2024-09-07 10:22:04,704 [trainer.py] => Average Accuracy (CNN): 53.29 

Accuracy Matrix (CNN):
[[58.03 55.65 53.27 51.84 50.65 50.06]
 [ 0.   64.93 63.43 62.69 61.19 59.7 ]
 [ 0.    0.   50.   48.63 47.95 47.95]
 [ 0.    0.    0.   44.09 44.09 43.31]
 [ 0.    0.    0.    0.   40.14 40.14]
 [ 0.    0.    0.    0.    0.   50.81]]
2024-09-07 10:22:04,705 [trainer.py] => Forgetting (CNN): 3.2060000000000004
2024-09-07 10:22:07,360 [trainer.py] => config: ./exps/simplecil_ina_B100_Inc10.json
2024-09-07 10:22:07,361 [trainer.py] => prefix:  
2024-09-07 10:22:07,361 [trainer.py] => dataset: imageneta
2024-09-07 10:22:07,361 [trainer.py] => memory_size: 0
2024-09-07 10:22:07,361 [trainer.py] => memory_per_class: 0
2024-09-07 10:22:07,361 [trainer.py] => fixed_memory: False
2024-09-07 10:22:07,361 [trainer.py] => shuffle: True
2024-09-07 10:22:07,361 [trainer.py] => init_cls: 100
2024-09-07 10:22:07,361 [trainer.py] => increment: 10
2024-09-07 10:22:07,361 [trainer.py] => model_name: simplecil
2024-09-07 10:22:07,361 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 10:22:07,361 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 10:22:07,361 [trainer.py] => seed: 1993
2024-09-07 10:22:07,361 [trainer.py] => tuned_epoch: 0
2024-09-07 10:22:07,361 [trainer.py] => init_lr: 0.01
2024-09-07 10:22:07,361 [trainer.py] => batch_size: 48
2024-09-07 10:22:07,361 [trainer.py] => weight_decay: 0.05
2024-09-07 10:22:07,361 [trainer.py] => min_lr: 1e-08
2024-09-07 10:22:07,361 [trainer.py] => optimizer: sgd
2024-09-07 10:22:07,361 [trainer.py] => vpt_type: shallow
2024-09-07 10:22:07,361 [trainer.py] => prompt_token_num: 3
2024-09-07 10:22:07,387 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 10:22:09,093 [trainer.py] => All params: 85798656
2024-09-07 10:22:09,094 [trainer.py] => Trainable params: 85798656
2024-09-07 10:22:09,500 [simplecil.py] => Learning on 0-100
2024-09-07 10:22:23,084 [trainer.py] => No NME accuracy.
2024-09-07 10:22:23,084 [trainer.py] => CNN: {'total': 58.03, '00-99': 58.03, 'old': 0, 'new': 58.03}
2024-09-07 10:22:23,085 [trainer.py] => CNN top1 curve: [58.03]
2024-09-07 10:22:23,085 [trainer.py] => CNN top5 curve: [83.35]

Average Accuracy (CNN): 58.03
2024-09-07 10:22:23,085 [trainer.py] => Average Accuracy (CNN): 58.03 

2024-09-07 10:22:23,086 [trainer.py] => All params: 85875457
2024-09-07 10:22:23,087 [trainer.py] => Trainable params: 85875457
2024-09-07 10:22:23,089 [simplecil.py] => Learning on 100-110
2024-09-07 10:22:28,022 [trainer.py] => No NME accuracy.
2024-09-07 10:22:28,023 [trainer.py] => CNN: {'total': 57.38, '00-99': 56.6, '100-109': 68.33, 'old': 56.6, 'new': 68.33}
2024-09-07 10:22:28,023 [trainer.py] => CNN top1 curve: [58.03, 57.38]
2024-09-07 10:22:28,023 [trainer.py] => CNN top5 curve: [83.35, 82.57]

Average Accuracy (CNN): 57.7
2024-09-07 10:22:28,023 [trainer.py] => Average Accuracy (CNN): 57.7 

2024-09-07 10:22:28,025 [trainer.py] => All params: 85883137
2024-09-07 10:22:28,027 [trainer.py] => Trainable params: 85883137
2024-09-07 10:22:28,030 [simplecil.py] => Learning on 110-120
2024-09-07 10:22:33,284 [trainer.py] => No NME accuracy.
2024-09-07 10:22:33,284 [trainer.py] => CNN: {'total': 56.92, '00-99': 55.65, '100-109': 68.33, '110-119': 62.16, 'old': 56.49, 'new': 62.16}
2024-09-07 10:22:33,284 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92]
2024-09-07 10:22:33,284 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74]

Average Accuracy (CNN): 57.44
2024-09-07 10:22:33,284 [trainer.py] => Average Accuracy (CNN): 57.44 

2024-09-07 10:22:33,285 [trainer.py] => All params: 85890817
2024-09-07 10:22:33,286 [trainer.py] => Trainable params: 85890817
2024-09-07 10:22:33,288 [simplecil.py] => Learning on 120-130
2024-09-07 10:22:38,512 [trainer.py] => No NME accuracy.
2024-09-07 10:22:38,513 [trainer.py] => CNN: {'total': 55.27, '00-99': 54.7, '100-109': 66.67, '110-119': 62.16, '120-129': 43.33, 'old': 56.0, 'new': 43.33}
2024-09-07 10:22:38,513 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27]
2024-09-07 10:22:38,513 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39]

Average Accuracy (CNN): 56.9
2024-09-07 10:22:38,513 [trainer.py] => Average Accuracy (CNN): 56.9 

2024-09-07 10:22:38,514 [trainer.py] => All params: 85898497
2024-09-07 10:22:38,516 [trainer.py] => Trainable params: 85898497
2024-09-07 10:22:38,519 [simplecil.py] => Learning on 130-140
2024-09-07 10:22:44,258 [trainer.py] => No NME accuracy.
2024-09-07 10:22:44,258 [trainer.py] => CNN: {'total': 54.06, '00-99': 53.27, '100-109': 66.67, '110-119': 60.81, '120-129': 41.67, '130-139': 55.81, 'old': 53.91, 'new': 55.81}
2024-09-07 10:22:44,259 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27, 54.06]
2024-09-07 10:22:44,259 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39, 79.66]

Average Accuracy (CNN): 56.33
2024-09-07 10:22:44,259 [trainer.py] => Average Accuracy (CNN): 56.33 

2024-09-07 10:22:44,260 [trainer.py] => All params: 85906177
2024-09-07 10:22:44,261 [trainer.py] => Trainable params: 85906177
2024-09-07 10:22:44,263 [simplecil.py] => Learning on 140-150
2024-09-07 10:22:50,188 [trainer.py] => No NME accuracy.
2024-09-07 10:22:50,188 [trainer.py] => CNN: {'total': 53.05, '00-99': 52.44, '100-109': 65.0, '110-119': 60.81, '120-129': 41.67, '130-139': 54.65, '140-149': 50.0, 'old': 53.26, 'new': 50.0}
2024-09-07 10:22:50,189 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27, 54.06, 53.05]
2024-09-07 10:22:50,189 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39, 79.66, 79.28]

Average Accuracy (CNN): 55.78
2024-09-07 10:22:50,189 [trainer.py] => Average Accuracy (CNN): 55.78 

2024-09-07 10:22:50,190 [trainer.py] => All params: 85913857
2024-09-07 10:22:50,191 [trainer.py] => Trainable params: 85913857
2024-09-07 10:22:50,194 [simplecil.py] => Learning on 150-160
2024-09-07 10:22:56,030 [trainer.py] => No NME accuracy.
2024-09-07 10:22:56,030 [trainer.py] => CNN: {'total': 51.84, '00-99': 51.84, '100-109': 65.0, '110-119': 60.81, '120-129': 40.0, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, 'old': 52.55, 'new': 35.29}
2024-09-07 10:22:56,030 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84]
2024-09-07 10:22:56,030 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37]

Average Accuracy (CNN): 55.22
2024-09-07 10:22:56,030 [trainer.py] => Average Accuracy (CNN): 55.22 

2024-09-07 10:22:56,031 [trainer.py] => All params: 85921537
2024-09-07 10:22:56,032 [trainer.py] => Trainable params: 85921537
2024-09-07 10:22:56,034 [simplecil.py] => Learning on 160-170
2024-09-07 10:23:02,431 [trainer.py] => No NME accuracy.
2024-09-07 10:23:02,431 [trainer.py] => CNN: {'total': 50.49, '00-99': 51.25, '100-109': 65.0, '110-119': 60.81, '120-129': 40.0, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, '160-169': 36.47, 'old': 51.44, 'new': 36.47}
2024-09-07 10:23:02,431 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49]
2024-09-07 10:23:02,431 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27]

Average Accuracy (CNN): 54.63
2024-09-07 10:23:02,431 [trainer.py] => Average Accuracy (CNN): 54.63 

2024-09-07 10:23:02,432 [trainer.py] => All params: 85929217
2024-09-07 10:23:02,433 [trainer.py] => Trainable params: 85929217
2024-09-07 10:23:02,436 [simplecil.py] => Learning on 170-180
2024-09-07 10:23:08,672 [trainer.py] => No NME accuracy.
2024-09-07 10:23:08,672 [trainer.py] => CNN: {'total': 49.68, '00-99': 50.65, '100-109': 65.0, '110-119': 58.11, '120-129': 38.33, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, '160-169': 36.47, '170-179': 45.16, 'old': 49.89, 'new': 45.16}
2024-09-07 10:23:08,672 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49, 49.68]
2024-09-07 10:23:08,672 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27, 76.49]

Average Accuracy (CNN): 54.08
2024-09-07 10:23:08,673 [trainer.py] => Average Accuracy (CNN): 54.08 

2024-09-07 10:23:08,674 [trainer.py] => All params: 85936897
2024-09-07 10:23:08,674 [trainer.py] => Trainable params: 85936897
2024-09-07 10:23:08,677 [simplecil.py] => Learning on 180-190
2024-09-07 10:23:14,944 [trainer.py] => No NME accuracy.
2024-09-07 10:23:14,945 [trainer.py] => CNN: {'total': 49.37, '00-99': 50.3, '100-109': 65.0, '110-119': 58.11, '120-129': 38.33, '130-139': 54.65, '140-149': 50.0, '150-159': 35.29, '160-169': 36.47, '170-179': 45.16, '180-189': 46.15, 'old': 49.46, 'new': 46.15}
2024-09-07 10:23:14,945 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49, 49.68, 49.37]
2024-09-07 10:23:14,945 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27, 76.49, 75.87]

Average Accuracy (CNN): 53.61
2024-09-07 10:23:14,945 [trainer.py] => Average Accuracy (CNN): 53.61 

2024-09-07 10:23:14,946 [trainer.py] => All params: 85944577
2024-09-07 10:23:14,948 [trainer.py] => Trainable params: 85944577
2024-09-07 10:23:14,952 [simplecil.py] => Learning on 190-200
2024-09-07 10:23:21,888 [trainer.py] => No NME accuracy.
2024-09-07 10:23:21,888 [trainer.py] => CNN: {'total': 49.24, '00-99': 50.06, '100-109': 63.33, '110-119': 56.76, '120-129': 38.33, '130-139': 54.65, '140-149': 50.0, '150-159': 33.33, '160-169': 36.47, '170-179': 45.16, '180-189': 46.15, '190-199': 52.94, 'old': 49.02, 'new': 52.94}
2024-09-07 10:23:21,888 [trainer.py] => CNN top1 curve: [58.03, 57.38, 56.92, 55.27, 54.06, 53.05, 51.84, 50.49, 49.68, 49.37, 49.24]
2024-09-07 10:23:21,888 [trainer.py] => CNN top5 curve: [83.35, 82.57, 81.74, 80.39, 79.66, 79.28, 78.37, 77.27, 76.49, 75.87, 74.79]

Average Accuracy (CNN): 53.21
2024-09-07 10:23:21,888 [trainer.py] => Average Accuracy (CNN): 53.21 

Accuracy Matrix (CNN):
[[58.03 56.6  55.65 54.7  53.27 52.44 51.84 51.25 50.65 50.3  50.06]
 [ 0.   68.33 68.33 66.67 66.67 65.   65.   65.   65.   65.   63.33]
 [ 0.    0.   62.16 62.16 60.81 60.81 60.81 60.81 58.11 58.11 56.76]
 [ 0.    0.    0.   43.33 41.67 41.67 40.   40.   38.33 38.33 38.33]
 [ 0.    0.    0.    0.   55.81 54.65 54.65 54.65 54.65 54.65 54.65]
 [ 0.    0.    0.    0.    0.   50.   50.   50.   50.   50.   50.  ]
 [ 0.    0.    0.    0.    0.    0.   35.29 35.29 35.29 35.29 33.33]
 [ 0.    0.    0.    0.    0.    0.    0.   36.47 36.47 36.47 36.47]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   45.16 45.16 45.16]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   46.15 46.15]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   52.94]]
2024-09-07 10:23:21,890 [trainer.py] => Forgetting (CNN): 2.649
2024-09-07 10:23:24,522 [trainer.py] => config: ./exps/l2p_ina_B0_Inc5.json
2024-09-07 10:23:24,522 [trainer.py] => prefix:  
2024-09-07 10:23:24,522 [trainer.py] => dataset: imageneta
2024-09-07 10:23:24,522 [trainer.py] => memory_size: 0
2024-09-07 10:23:24,523 [trainer.py] => memory_per_class: 0
2024-09-07 10:23:24,523 [trainer.py] => fixed_memory: False
2024-09-07 10:23:24,523 [trainer.py] => shuffle: True
2024-09-07 10:23:24,523 [trainer.py] => init_cls: 40
2024-09-07 10:23:24,523 [trainer.py] => increment: 40
2024-09-07 10:23:24,523 [trainer.py] => model_name: l2p
2024-09-07 10:23:24,523 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 10:23:24,523 [trainer.py] => get_original_backbone: True
2024-09-07 10:23:24,523 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 10:23:24,523 [trainer.py] => seed: 1993
2024-09-07 10:23:24,523 [trainer.py] => tuned_epoch: 20
2024-09-07 10:23:24,523 [trainer.py] => init_lr: 0.001875
2024-09-07 10:23:24,523 [trainer.py] => batch_size: 48
2024-09-07 10:23:24,523 [trainer.py] => weight_decay: 0
2024-09-07 10:23:24,523 [trainer.py] => min_lr: 1e-05
2024-09-07 10:23:24,523 [trainer.py] => optimizer: adam
2024-09-07 10:23:24,523 [trainer.py] => scheduler: constant
2024-09-07 10:23:24,523 [trainer.py] => reinit_optimizer: True
2024-09-07 10:23:24,523 [trainer.py] => global_pool: token
2024-09-07 10:23:24,523 [trainer.py] => head_type: prompt
2024-09-07 10:23:24,523 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 10:23:24,523 [trainer.py] => pretrained: True
2024-09-07 10:23:24,523 [trainer.py] => drop: 0.0
2024-09-07 10:23:24,523 [trainer.py] => drop_path: 0.0
2024-09-07 10:23:24,523 [trainer.py] => prompt_pool: True
2024-09-07 10:23:24,523 [trainer.py] => size: 10
2024-09-07 10:23:24,523 [trainer.py] => length: 5
2024-09-07 10:23:24,523 [trainer.py] => top_k: 5
2024-09-07 10:23:24,523 [trainer.py] => initializer: uniform
2024-09-07 10:23:24,523 [trainer.py] => prompt_key: True
2024-09-07 10:23:24,523 [trainer.py] => prompt_key_init: uniform
2024-09-07 10:23:24,523 [trainer.py] => use_prompt_mask: False
2024-09-07 10:23:24,523 [trainer.py] => shared_prompt_pool: False
2024-09-07 10:23:24,523 [trainer.py] => shared_prompt_key: False
2024-09-07 10:23:24,524 [trainer.py] => batchwise_prompt: True
2024-09-07 10:23:24,524 [trainer.py] => embedding_key: cls
2024-09-07 10:23:24,524 [trainer.py] => predefined_key: 
2024-09-07 10:23:24,524 [trainer.py] => pull_constraint: True
2024-09-07 10:23:24,524 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 10:23:24,550 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 10:23:25,907 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 10:23:25,907 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 10:23:27,632 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 10:23:27,633 [l2p.py] => 199,880 model training parameters.
2024-09-07 10:23:27,633 [l2p.py] => prompt.prompt: 38400
2024-09-07 10:23:27,633 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 10:23:27,633 [l2p.py] => head.weight: 153600
2024-09-07 10:23:27,633 [l2p.py] => head.bias: 200
2024-09-07 10:23:27,634 [trainer.py] => All params: 171970192
2024-09-07 10:23:27,635 [trainer.py] => Trainable params: 199880
2024-09-07 10:23:27,635 [l2p.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.229, Train_accy 20.12:   0%|          | 0/20 [00:14<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.229, Train_accy 20.12:   5%|▌         | 1/20 [00:14<04:26, 14.04s/it]
Task 0, Epoch 2/20 => Loss 1.755, Train_accy 49.08:   5%|▌         | 1/20 [00:27<04:26, 14.04s/it]
Task 0, Epoch 2/20 => Loss 1.755, Train_accy 49.08:  10%|█         | 2/20 [00:27<04:09, 13.84s/it]
Task 0, Epoch 3/20 => Loss 1.183, Train_accy 64.58:  10%|█         | 2/20 [00:41<04:09, 13.84s/it]
Task 0, Epoch 3/20 => Loss 1.183, Train_accy 64.58:  15%|█▌        | 3/20 [00:41<03:54, 13.78s/it]
Task 0, Epoch 4/20 => Loss 0.940, Train_accy 71.52:  15%|█▌        | 3/20 [00:55<03:54, 13.78s/it]
Task 0, Epoch 4/20 => Loss 0.940, Train_accy 71.52:  20%|██        | 4/20 [00:55<03:40, 13.78s/it]
Task 0, Epoch 5/20 => Loss 0.768, Train_accy 76.55, Test_accy 60.28:  20%|██        | 4/20 [01:11<03:40, 13.78s/it]
Task 0, Epoch 5/20 => Loss 0.768, Train_accy 76.55, Test_accy 60.28:  25%|██▌       | 5/20 [01:11<03:41, 14.76s/it]
Task 0, Epoch 6/20 => Loss 0.705, Train_accy 78.31:  25%|██▌       | 5/20 [01:25<03:41, 14.76s/it]                 
Task 0, Epoch 6/20 => Loss 0.705, Train_accy 78.31:  30%|███       | 6/20 [01:25<03:22, 14.44s/it]
Task 0, Epoch 7/20 => Loss 0.583, Train_accy 80.42:  30%|███       | 6/20 [01:39<03:22, 14.44s/it]
Task 0, Epoch 7/20 => Loss 0.583, Train_accy 80.42:  35%|███▌      | 7/20 [01:39<03:05, 14.24s/it]
Task 0, Epoch 8/20 => Loss 0.468, Train_accy 84.84:  35%|███▌      | 7/20 [01:53<03:05, 14.24s/it]
Task 0, Epoch 8/20 => Loss 0.468, Train_accy 84.84:  40%|████      | 8/20 [01:53<02:49, 14.15s/it]
Task 0, Epoch 9/20 => Loss 0.457, Train_accy 83.96:  40%|████      | 8/20 [02:07<02:49, 14.15s/it]
Task 0, Epoch 9/20 => Loss 0.457, Train_accy 83.96:  45%|████▌     | 9/20 [02:07<02:34, 14.06s/it]
Task 0, Epoch 10/20 => Loss 0.428, Train_accy 84.09, Test_accy 67.22:  45%|████▌     | 9/20 [02:23<02:34, 14.06s/it]
Task 0, Epoch 10/20 => Loss 0.428, Train_accy 84.09, Test_accy 67.22:  50%|█████     | 10/20 [02:23<02:28, 14.84s/it]
Task 0, Epoch 11/20 => Loss 0.363, Train_accy 86.68:  50%|█████     | 10/20 [02:37<02:28, 14.84s/it]                 
Task 0, Epoch 11/20 => Loss 0.363, Train_accy 86.68:  55%|█████▌    | 11/20 [02:37<02:10, 14.55s/it]
Task 0, Epoch 12/20 => Loss 0.310, Train_accy 87.63:  55%|█████▌    | 11/20 [02:51<02:10, 14.55s/it]
Task 0, Epoch 12/20 => Loss 0.310, Train_accy 87.63:  60%|██████    | 12/20 [02:51<01:54, 14.36s/it]
Task 0, Epoch 13/20 => Loss 0.298, Train_accy 88.24:  60%|██████    | 12/20 [03:05<01:54, 14.36s/it]
Task 0, Epoch 13/20 => Loss 0.298, Train_accy 88.24:  65%|██████▌   | 13/20 [03:05<01:39, 14.23s/it]
Task 0, Epoch 14/20 => Loss 0.285, Train_accy 88.31:  65%|██████▌   | 13/20 [03:19<01:39, 14.23s/it]
Task 0, Epoch 14/20 => Loss 0.285, Train_accy 88.31:  70%|███████   | 14/20 [03:19<01:24, 14.15s/it]
Task 0, Epoch 15/20 => Loss 0.227, Train_accy 90.07, Test_accy 66.11:  70%|███████   | 14/20 [03:36<01:24, 14.15s/it]
Task 0, Epoch 15/20 => Loss 0.227, Train_accy 90.07, Test_accy 66.11:  75%|███████▌  | 15/20 [03:36<01:14, 14.89s/it]
Task 0, Epoch 16/20 => Loss 0.248, Train_accy 88.72:  75%|███████▌  | 15/20 [03:50<01:14, 14.89s/it]                 
Task 0, Epoch 16/20 => Loss 0.248, Train_accy 88.72:  80%|████████  | 16/20 [03:50<00:58, 14.61s/it]
Task 0, Epoch 17/20 => Loss 0.220, Train_accy 89.39:  80%|████████  | 16/20 [04:03<00:58, 14.61s/it]
Task 0, Epoch 17/20 => Loss 0.220, Train_accy 89.39:  85%|████████▌ | 17/20 [04:03<00:43, 14.40s/it]
Task 0, Epoch 18/20 => Loss 0.180, Train_accy 89.53:  85%|████████▌ | 17/20 [04:17<00:43, 14.40s/it]
Task 0, Epoch 18/20 => Loss 0.180, Train_accy 89.53:  90%|█████████ | 18/20 [04:17<00:28, 14.26s/it]
Task 0, Epoch 19/20 => Loss 0.159, Train_accy 90.62:  90%|█████████ | 18/20 [04:31<00:28, 14.26s/it]
Task 0, Epoch 19/20 => Loss 0.159, Train_accy 90.62:  95%|█████████▌| 19/20 [04:31<00:14, 14.16s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 89.67, Test_accy 65.83:  95%|█████████▌| 19/20 [04:48<00:14, 14.16s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 89.67, Test_accy 65.83: 100%|██████████| 20/20 [04:48<00:00, 14.88s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 89.67, Test_accy 65.83: 100%|██████████| 20/20 [04:48<00:00, 14.42s/it]
2024-09-07 10:28:16,556 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.203, Train_accy 89.67, Test_accy 65.83
2024-09-07 10:28:19,260 [trainer.py] => No NME accuracy.
2024-09-07 10:28:19,260 [trainer.py] => CNN: {'total': 65.83, '00-39': 65.83, 'old': 0, 'new': 65.83}
2024-09-07 10:28:19,260 [trainer.py] => CNN top1 curve: [65.83]
2024-09-07 10:28:19,260 [trainer.py] => CNN top5 curve: [89.72]

Average Accuracy (CNN): 65.83
2024-09-07 10:28:19,260 [trainer.py] => Average Accuracy (CNN): 65.83 

2024-09-07 10:28:19,261 [trainer.py] => All params: 171970192
2024-09-07 10:28:19,262 [trainer.py] => Trainable params: 199880
2024-09-07 10:28:19,262 [l2p.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.445, Train_accy 34.90:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.445, Train_accy 34.90:   5%|▌         | 1/20 [00:12<03:53, 12.31s/it]
Task 1, Epoch 2/20 => Loss 0.864, Train_accy 68.80:   5%|▌         | 1/20 [00:24<03:53, 12.31s/it]
Task 1, Epoch 2/20 => Loss 0.864, Train_accy 68.80:  10%|█         | 2/20 [00:24<03:42, 12.35s/it]
Task 1, Epoch 3/20 => Loss 0.604, Train_accy 77.14:  10%|█         | 2/20 [00:37<03:42, 12.35s/it]
Task 1, Epoch 3/20 => Loss 0.604, Train_accy 77.14:  15%|█▌        | 3/20 [00:37<03:30, 12.38s/it]
Task 1, Epoch 4/20 => Loss 0.462, Train_accy 81.31:  15%|█▌        | 3/20 [00:49<03:30, 12.38s/it]
Task 1, Epoch 4/20 => Loss 0.462, Train_accy 81.31:  20%|██        | 4/20 [00:49<03:17, 12.37s/it]
Task 1, Epoch 5/20 => Loss 0.343, Train_accy 86.18, Test_accy 48.85:  20%|██        | 4/20 [01:06<03:17, 12.37s/it]
Task 1, Epoch 5/20 => Loss 0.343, Train_accy 86.18, Test_accy 48.85:  25%|██▌       | 5/20 [01:06<03:30, 14.04s/it]
Task 1, Epoch 6/20 => Loss 0.346, Train_accy 84.40:  25%|██▌       | 5/20 [01:18<03:30, 14.04s/it]                 
Task 1, Epoch 6/20 => Loss 0.346, Train_accy 84.40:  30%|███       | 6/20 [01:18<03:08, 13.45s/it]
Task 1, Epoch 7/20 => Loss 0.209, Train_accy 89.03:  30%|███       | 6/20 [01:31<03:08, 13.45s/it]
Task 1, Epoch 7/20 => Loss 0.209, Train_accy 89.03:  35%|███▌      | 7/20 [01:31<02:49, 13.07s/it]
Task 1, Epoch 8/20 => Loss 0.216, Train_accy 88.65:  35%|███▌      | 7/20 [01:43<02:49, 13.07s/it]
Task 1, Epoch 8/20 => Loss 0.216, Train_accy 88.65:  40%|████      | 8/20 [01:43<02:33, 12.83s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 89.65:  40%|████      | 8/20 [01:55<02:33, 12.83s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 89.65:  45%|████▌     | 9/20 [01:55<02:19, 12.66s/it]
Task 1, Epoch 10/20 => Loss 0.202, Train_accy 88.26, Test_accy 52.58:  45%|████▌     | 9/20 [02:12<02:19, 12.66s/it]
Task 1, Epoch 10/20 => Loss 0.202, Train_accy 88.26, Test_accy 52.58:  50%|█████     | 10/20 [02:12<02:19, 13.98s/it]
Task 1, Epoch 11/20 => Loss 0.162, Train_accy 90.12:  50%|█████     | 10/20 [02:24<02:19, 13.98s/it]                 
Task 1, Epoch 11/20 => Loss 0.162, Train_accy 90.12:  55%|█████▌    | 11/20 [02:24<02:01, 13.46s/it]
Task 1, Epoch 12/20 => Loss 0.135, Train_accy 90.81:  55%|█████▌    | 11/20 [02:37<02:01, 13.46s/it]
Task 1, Epoch 12/20 => Loss 0.135, Train_accy 90.81:  60%|██████    | 12/20 [02:37<01:44, 13.10s/it]
Task 1, Epoch 13/20 => Loss 0.158, Train_accy 90.81:  60%|██████    | 12/20 [02:49<01:44, 13.10s/it]
Task 1, Epoch 13/20 => Loss 0.158, Train_accy 90.81:  65%|██████▌   | 13/20 [02:49<01:30, 12.86s/it]
Task 1, Epoch 14/20 => Loss 0.136, Train_accy 90.19:  65%|██████▌   | 13/20 [03:01<01:30, 12.86s/it]
Task 1, Epoch 14/20 => Loss 0.136, Train_accy 90.19:  70%|███████   | 14/20 [03:01<01:16, 12.70s/it]
Task 1, Epoch 15/20 => Loss 0.110, Train_accy 91.81, Test_accy 56.02:  70%|███████   | 14/20 [03:18<01:16, 12.70s/it]
Task 1, Epoch 15/20 => Loss 0.110, Train_accy 91.81, Test_accy 56.02:  75%|███████▌  | 15/20 [03:18<01:09, 13.99s/it]
Task 1, Epoch 16/20 => Loss 0.060, Train_accy 92.66:  75%|███████▌  | 15/20 [03:31<01:09, 13.99s/it]                 
Task 1, Epoch 16/20 => Loss 0.060, Train_accy 92.66:  80%|████████  | 16/20 [03:31<00:53, 13.48s/it]
Task 1, Epoch 17/20 => Loss 0.053, Train_accy 93.05:  80%|████████  | 16/20 [03:43<00:53, 13.48s/it]
Task 1, Epoch 17/20 => Loss 0.053, Train_accy 93.05:  85%|████████▌ | 17/20 [03:43<00:39, 13.14s/it]
Task 1, Epoch 18/20 => Loss 0.105, Train_accy 90.89:  85%|████████▌ | 17/20 [03:55<00:39, 13.14s/it]
Task 1, Epoch 18/20 => Loss 0.105, Train_accy 90.89:  90%|█████████ | 18/20 [03:55<00:25, 12.89s/it]
Task 1, Epoch 19/20 => Loss 0.057, Train_accy 93.44:  90%|█████████ | 18/20 [04:08<00:25, 12.89s/it]
Task 1, Epoch 19/20 => Loss 0.057, Train_accy 93.44:  95%|█████████▌| 19/20 [04:08<00:12, 12.72s/it]
Task 1, Epoch 20/20 => Loss 0.109, Train_accy 92.05, Test_accy 57.02:  95%|█████████▌| 19/20 [04:24<00:12, 12.72s/it]
Task 1, Epoch 20/20 => Loss 0.109, Train_accy 92.05, Test_accy 57.02: 100%|██████████| 20/20 [04:24<00:00, 13.97s/it]
Task 1, Epoch 20/20 => Loss 0.109, Train_accy 92.05, Test_accy 57.02: 100%|██████████| 20/20 [04:24<00:00, 13.25s/it]
2024-09-07 10:32:44,193 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.109, Train_accy 92.05, Test_accy 57.02
2024-09-07 10:32:48,840 [trainer.py] => No NME accuracy.
2024-09-07 10:32:48,841 [trainer.py] => CNN: {'total': 57.02, '00-39': 63.33, '40-79': 50.3, 'old': 63.33, 'new': 50.3}
2024-09-07 10:32:48,841 [trainer.py] => CNN top1 curve: [65.83, 57.02]
2024-09-07 10:32:48,841 [trainer.py] => CNN top5 curve: [89.72, 84.81]

Average Accuracy (CNN): 61.42
2024-09-07 10:32:48,841 [trainer.py] => Average Accuracy (CNN): 61.42 

2024-09-07 10:32:48,844 [trainer.py] => All params: 171970192
2024-09-07 10:32:48,847 [trainer.py] => Trainable params: 199880
2024-09-07 10:32:48,847 [l2p.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.340, Train_accy 39.54:   0%|          | 0/20 [00:10<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.340, Train_accy 39.54:   5%|▌         | 1/20 [00:10<03:10, 10.00s/it]
Task 2, Epoch 2/20 => Loss 0.645, Train_accy 76.03:   5%|▌         | 1/20 [00:20<03:10, 10.00s/it]
Task 2, Epoch 2/20 => Loss 0.645, Train_accy 76.03:  10%|█         | 2/20 [00:20<03:00, 10.01s/it]
Task 2, Epoch 3/20 => Loss 0.421, Train_accy 82.71:  10%|█         | 2/20 [00:30<03:00, 10.01s/it]
Task 2, Epoch 3/20 => Loss 0.421, Train_accy 82.71:  15%|█▌        | 3/20 [00:30<02:50, 10.02s/it]
Task 2, Epoch 4/20 => Loss 0.251, Train_accy 87.87:  15%|█▌        | 3/20 [00:40<02:50, 10.02s/it]
Task 2, Epoch 4/20 => Loss 0.251, Train_accy 87.87:  20%|██        | 4/20 [00:40<02:40, 10.02s/it]
Task 2, Epoch 5/20 => Loss 0.218, Train_accy 87.97, Test_accy 48.41:  20%|██        | 4/20 [00:56<02:40, 10.02s/it]
Task 2, Epoch 5/20 => Loss 0.218, Train_accy 87.97, Test_accy 48.41:  25%|██▌       | 5/20 [00:56<03:04, 12.29s/it]
Task 2, Epoch 6/20 => Loss 0.234, Train_accy 88.25:  25%|██▌       | 5/20 [01:06<03:04, 12.29s/it]                 
Task 2, Epoch 6/20 => Loss 0.234, Train_accy 88.25:  30%|███       | 6/20 [01:06<02:41, 11.54s/it]
Task 2, Epoch 7/20 => Loss 0.150, Train_accy 91.31:  30%|███       | 6/20 [01:16<02:41, 11.54s/it]
Task 2, Epoch 7/20 => Loss 0.150, Train_accy 91.31:  35%|███▌      | 7/20 [01:16<02:23, 11.05s/it]
Task 2, Epoch 8/20 => Loss 0.112, Train_accy 91.21:  35%|███▌      | 7/20 [01:26<02:23, 11.05s/it]
Task 2, Epoch 8/20 => Loss 0.112, Train_accy 91.21:  40%|████      | 8/20 [01:26<02:08, 10.71s/it]
Task 2, Epoch 9/20 => Loss 0.121, Train_accy 91.69:  40%|████      | 8/20 [01:36<02:08, 10.71s/it]
Task 2, Epoch 9/20 => Loss 0.121, Train_accy 91.69:  45%|████▌     | 9/20 [01:36<01:55, 10.50s/it]
Task 2, Epoch 10/20 => Loss 0.053, Train_accy 93.70, Test_accy 49.13:  45%|████▌     | 9/20 [01:52<01:55, 10.50s/it]
Task 2, Epoch 10/20 => Loss 0.053, Train_accy 93.70, Test_accy 49.13:  50%|█████     | 10/20 [01:52<02:03, 12.34s/it]
Task 2, Epoch 11/20 => Loss 0.076, Train_accy 92.26:  50%|█████     | 10/20 [02:03<02:03, 12.34s/it]                 
Task 2, Epoch 11/20 => Loss 0.076, Train_accy 92.26:  55%|█████▌    | 11/20 [02:03<01:44, 11.67s/it]
Task 2, Epoch 12/20 => Loss 0.062, Train_accy 92.55:  55%|█████▌    | 11/20 [02:13<01:44, 11.67s/it]
Task 2, Epoch 12/20 => Loss 0.062, Train_accy 92.55:  60%|██████    | 12/20 [02:13<01:29, 11.24s/it]
Task 2, Epoch 13/20 => Loss 0.037, Train_accy 94.08:  60%|██████    | 12/20 [02:23<01:29, 11.24s/it]
Task 2, Epoch 13/20 => Loss 0.037, Train_accy 94.08:  65%|██████▌   | 13/20 [02:23<01:16, 10.89s/it]
Task 2, Epoch 14/20 => Loss 0.047, Train_accy 93.60:  65%|██████▌   | 13/20 [02:33<01:16, 10.89s/it]
Task 2, Epoch 14/20 => Loss 0.047, Train_accy 93.60:  70%|███████   | 14/20 [02:33<01:03, 10.62s/it]
Task 2, Epoch 15/20 => Loss 0.045, Train_accy 94.94, Test_accy 50.15:  70%|███████   | 14/20 [02:49<01:03, 10.62s/it]
Task 2, Epoch 15/20 => Loss 0.045, Train_accy 94.94, Test_accy 50.15:  75%|███████▌  | 15/20 [02:49<01:01, 12.34s/it]
Task 2, Epoch 16/20 => Loss 0.028, Train_accy 94.36:  75%|███████▌  | 15/20 [02:59<01:01, 12.34s/it]                 
Task 2, Epoch 16/20 => Loss 0.028, Train_accy 94.36:  80%|████████  | 16/20 [02:59<00:46, 11.65s/it]
Task 2, Epoch 17/20 => Loss -0.008, Train_accy 94.46:  80%|████████  | 16/20 [03:09<00:46, 11.65s/it]
Task 2, Epoch 17/20 => Loss -0.008, Train_accy 94.46:  85%|████████▌ | 17/20 [03:09<00:33, 11.17s/it]
Task 2, Epoch 18/20 => Loss 0.031, Train_accy 93.98:  85%|████████▌ | 17/20 [03:19<00:33, 11.17s/it] 
Task 2, Epoch 18/20 => Loss 0.031, Train_accy 93.98:  90%|█████████ | 18/20 [03:19<00:21, 10.84s/it]
Task 2, Epoch 19/20 => Loss 0.055, Train_accy 93.31:  90%|█████████ | 18/20 [03:29<00:21, 10.84s/it]
Task 2, Epoch 19/20 => Loss 0.055, Train_accy 93.31:  95%|█████████▌| 19/20 [03:29<00:10, 10.60s/it]
Task 2, Epoch 20/20 => Loss 0.050, Train_accy 93.98, Test_accy 50.46:  95%|█████████▌| 19/20 [03:46<00:10, 10.60s/it]
Task 2, Epoch 20/20 => Loss 0.050, Train_accy 93.98, Test_accy 50.46: 100%|██████████| 20/20 [03:46<00:00, 12.30s/it]
Task 2, Epoch 20/20 => Loss 0.050, Train_accy 93.98, Test_accy 50.46: 100%|██████████| 20/20 [03:46<00:00, 11.31s/it]
2024-09-07 10:36:35,124 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.050, Train_accy 93.98, Test_accy 50.46
2024-09-07 10:36:41,416 [trainer.py] => No NME accuracy.
2024-09-07 10:36:41,417 [trainer.py] => CNN: {'total': 50.46, '00-39': 60.56, '40-79': 51.18, '80-119': 36.46, 'old': 56.02, 'new': 36.46}
2024-09-07 10:36:41,417 [trainer.py] => CNN top1 curve: [65.83, 57.02, 50.46]
2024-09-07 10:36:41,417 [trainer.py] => CNN top5 curve: [89.72, 84.81, 78.97]

Average Accuracy (CNN): 57.77
2024-09-07 10:36:41,418 [trainer.py] => Average Accuracy (CNN): 57.77 

2024-09-07 10:36:41,421 [trainer.py] => All params: 171970192
2024-09-07 10:36:41,423 [trainer.py] => Trainable params: 199880
2024-09-07 10:36:41,423 [l2p.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.577, Train_accy 35.05:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.577, Train_accy 35.05:   5%|▌         | 1/20 [00:10<03:14, 10.23s/it]
Task 3, Epoch 2/20 => Loss 0.820, Train_accy 74.30:   5%|▌         | 1/20 [00:20<03:14, 10.23s/it]
Task 3, Epoch 2/20 => Loss 0.820, Train_accy 74.30:  10%|█         | 2/20 [00:20<03:04, 10.24s/it]
Task 3, Epoch 3/20 => Loss 0.465, Train_accy 82.90:  10%|█         | 2/20 [00:30<03:04, 10.24s/it]
Task 3, Epoch 3/20 => Loss 0.465, Train_accy 82.90:  15%|█▌        | 3/20 [00:30<02:54, 10.25s/it]
Task 3, Epoch 4/20 => Loss 0.303, Train_accy 87.29:  15%|█▌        | 3/20 [00:40<02:54, 10.25s/it]
Task 3, Epoch 4/20 => Loss 0.303, Train_accy 87.29:  20%|██        | 4/20 [00:40<02:43, 10.25s/it]
Task 3, Epoch 5/20 => Loss 0.267, Train_accy 88.04, Test_accy 45.19:  20%|██        | 4/20 [00:59<02:43, 10.25s/it]
Task 3, Epoch 5/20 => Loss 0.267, Train_accy 88.04, Test_accy 45.19:  25%|██▌       | 5/20 [00:59<03:16, 13.09s/it]
Task 3, Epoch 6/20 => Loss 0.208, Train_accy 89.81:  25%|██▌       | 5/20 [01:09<03:16, 13.09s/it]                 
Task 3, Epoch 6/20 => Loss 0.208, Train_accy 89.81:  30%|███       | 6/20 [01:09<02:49, 12.13s/it]
Task 3, Epoch 7/20 => Loss 0.184, Train_accy 90.09:  30%|███       | 6/20 [01:19<02:49, 12.13s/it]
Task 3, Epoch 7/20 => Loss 0.184, Train_accy 90.09:  35%|███▌      | 7/20 [01:19<02:29, 11.51s/it]
Task 3, Epoch 8/20 => Loss 0.157, Train_accy 91.31:  35%|███▌      | 7/20 [01:29<02:29, 11.51s/it]
Task 3, Epoch 8/20 => Loss 0.157, Train_accy 91.31:  40%|████      | 8/20 [01:29<02:13, 11.11s/it]
Task 3, Epoch 9/20 => Loss 0.108, Train_accy 91.59:  40%|████      | 8/20 [01:40<02:13, 11.11s/it]
Task 3, Epoch 9/20 => Loss 0.108, Train_accy 91.59:  45%|████▌     | 9/20 [01:40<01:59, 10.85s/it]
Task 3, Epoch 10/20 => Loss 0.120, Train_accy 91.68, Test_accy 47.12:  45%|████▌     | 9/20 [01:58<01:59, 10.85s/it]
Task 3, Epoch 10/20 => Loss 0.120, Train_accy 91.68, Test_accy 47.12:  50%|█████     | 10/20 [01:58<02:10, 13.08s/it]
Task 3, Epoch 11/20 => Loss 0.075, Train_accy 92.71:  50%|█████     | 10/20 [02:08<02:10, 13.08s/it]                 
Task 3, Epoch 11/20 => Loss 0.075, Train_accy 92.71:  55%|█████▌    | 11/20 [02:08<01:49, 12.20s/it]
Task 3, Epoch 12/20 => Loss 0.093, Train_accy 92.34:  55%|█████▌    | 11/20 [02:18<01:49, 12.20s/it]
Task 3, Epoch 12/20 => Loss 0.093, Train_accy 92.34:  60%|██████    | 12/20 [02:18<01:32, 11.61s/it]
Task 3, Epoch 13/20 => Loss 0.033, Train_accy 94.49:  60%|██████    | 12/20 [02:28<01:32, 11.61s/it]
Task 3, Epoch 13/20 => Loss 0.033, Train_accy 94.49:  65%|██████▌   | 13/20 [02:28<01:18, 11.21s/it]
Task 3, Epoch 14/20 => Loss 0.004, Train_accy 95.05:  65%|██████▌   | 13/20 [02:39<01:18, 11.21s/it]
Task 3, Epoch 14/20 => Loss 0.004, Train_accy 95.05:  70%|███████   | 14/20 [02:39<01:05, 10.95s/it]
Task 3, Epoch 15/20 => Loss 0.009, Train_accy 95.14, Test_accy 46.96:  70%|███████   | 14/20 [02:57<01:05, 10.95s/it]
Task 3, Epoch 15/20 => Loss 0.009, Train_accy 95.14, Test_accy 46.96:  75%|███████▌  | 15/20 [02:57<01:05, 13.12s/it]
Task 3, Epoch 16/20 => Loss 0.070, Train_accy 93.27:  75%|███████▌  | 15/20 [03:07<01:05, 13.12s/it]                 
Task 3, Epoch 16/20 => Loss 0.070, Train_accy 93.27:  80%|████████  | 16/20 [03:07<00:49, 12.26s/it]
Task 3, Epoch 17/20 => Loss 0.042, Train_accy 93.08:  80%|████████  | 16/20 [03:17<00:49, 12.26s/it]
Task 3, Epoch 17/20 => Loss 0.042, Train_accy 93.08:  85%|████████▌ | 17/20 [03:17<00:34, 11.65s/it]
Task 3, Epoch 18/20 => Loss 0.006, Train_accy 95.14:  85%|████████▌ | 17/20 [03:28<00:34, 11.65s/it]
Task 3, Epoch 18/20 => Loss 0.006, Train_accy 95.14:  90%|█████████ | 18/20 [03:28<00:22, 11.24s/it]
Task 3, Epoch 19/20 => Loss 0.007, Train_accy 95.33:  90%|█████████ | 18/20 [03:38<00:22, 11.24s/it]
Task 3, Epoch 19/20 => Loss 0.007, Train_accy 95.33:  95%|█████████▌| 19/20 [03:38<00:10, 10.96s/it]
Task 3, Epoch 20/20 => Loss -0.016, Train_accy 95.61, Test_accy 47.68:  95%|█████████▌| 19/20 [03:56<00:10, 10.96s/it]
Task 3, Epoch 20/20 => Loss -0.016, Train_accy 95.61, Test_accy 47.68: 100%|██████████| 20/20 [03:56<00:00, 13.14s/it]
Task 3, Epoch 20/20 => Loss -0.016, Train_accy 95.61, Test_accy 47.68: 100%|██████████| 20/20 [03:56<00:00, 11.84s/it]
2024-09-07 10:40:38,213 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.016, Train_accy 95.61, Test_accy 47.68
2024-09-07 10:40:46,113 [trainer.py] => No NME accuracy.
2024-09-07 10:40:46,114 [trainer.py] => CNN: {'total': 47.68, '00-39': 56.94, '40-79': 50.3, '80-119': 37.91, '120-159': 42.12, 'old': 49.23, 'new': 42.12}
2024-09-07 10:40:46,114 [trainer.py] => CNN top1 curve: [65.83, 57.02, 50.46, 47.68]
2024-09-07 10:40:46,114 [trainer.py] => CNN top5 curve: [89.72, 84.81, 78.97, 74.92]

Average Accuracy (CNN): 55.25
2024-09-07 10:40:46,114 [trainer.py] => Average Accuracy (CNN): 55.25 

2024-09-07 10:40:46,117 [trainer.py] => All params: 171970192
2024-09-07 10:40:46,118 [trainer.py] => Trainable params: 199880
2024-09-07 10:40:46,119 [l2p.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.567, Train_accy 32.33:   0%|          | 0/20 [00:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.567, Train_accy 32.33:   5%|▌         | 1/20 [00:10<03:19, 10.51s/it]
Task 4, Epoch 2/20 => Loss 0.843, Train_accy 70.13:   5%|▌         | 1/20 [00:21<03:19, 10.51s/it]
Task 4, Epoch 2/20 => Loss 0.843, Train_accy 70.13:  10%|█         | 2/20 [00:21<03:09, 10.50s/it]
Task 4, Epoch 3/20 => Loss 0.563, Train_accy 78.78:  10%|█         | 2/20 [00:31<03:09, 10.50s/it]
Task 4, Epoch 3/20 => Loss 0.563, Train_accy 78.78:  15%|█▌        | 3/20 [00:31<02:59, 10.53s/it]
Task 4, Epoch 4/20 => Loss 0.386, Train_accy 83.06:  15%|█▌        | 3/20 [00:42<02:59, 10.53s/it]
Task 4, Epoch 4/20 => Loss 0.386, Train_accy 83.06:  20%|██        | 4/20 [00:42<02:48, 10.54s/it]
Task 4, Epoch 5/20 => Loss 0.277, Train_accy 87.70, Test_accy 44.11:  20%|██        | 4/20 [01:02<02:48, 10.54s/it]
Task 4, Epoch 5/20 => Loss 0.277, Train_accy 87.70, Test_accy 44.11:  25%|██▌       | 5/20 [01:02<03:29, 13.97s/it]
Task 4, Epoch 6/20 => Loss 0.209, Train_accy 89.98:  25%|██▌       | 5/20 [01:12<03:29, 13.97s/it]                 
Task 4, Epoch 6/20 => Loss 0.209, Train_accy 89.98:  30%|███       | 6/20 [01:12<02:59, 12.80s/it]
Task 4, Epoch 7/20 => Loss 0.178, Train_accy 89.89:  30%|███       | 6/20 [01:23<02:59, 12.80s/it]
Task 4, Epoch 7/20 => Loss 0.178, Train_accy 89.89:  35%|███▌      | 7/20 [01:23<02:36, 12.07s/it]
Task 4, Epoch 8/20 => Loss 0.116, Train_accy 92.08:  35%|███▌      | 7/20 [01:33<02:36, 12.07s/it]
Task 4, Epoch 8/20 => Loss 0.116, Train_accy 92.08:  40%|████      | 8/20 [01:33<02:18, 11.58s/it]
Task 4, Epoch 9/20 => Loss 0.120, Train_accy 92.62:  40%|████      | 8/20 [01:44<02:18, 11.58s/it]
Task 4, Epoch 9/20 => Loss 0.120, Train_accy 92.62:  45%|████▌     | 9/20 [01:44<02:03, 11.25s/it]
Task 4, Epoch 10/20 => Loss 0.139, Train_accy 91.35, Test_accy 44.63:  45%|████▌     | 9/20 [02:04<02:03, 11.25s/it]
Task 4, Epoch 10/20 => Loss 0.139, Train_accy 91.35, Test_accy 44.63:  50%|█████     | 10/20 [02:04<02:19, 13.97s/it]
Task 4, Epoch 11/20 => Loss 0.068, Train_accy 93.72:  50%|█████     | 10/20 [02:14<02:19, 13.97s/it]                 
Task 4, Epoch 11/20 => Loss 0.068, Train_accy 93.72:  55%|█████▌    | 11/20 [02:14<01:56, 12.93s/it]
Task 4, Epoch 12/20 => Loss 0.053, Train_accy 93.53:  55%|█████▌    | 11/20 [02:25<01:56, 12.93s/it]
Task 4, Epoch 12/20 => Loss 0.053, Train_accy 93.53:  60%|██████    | 12/20 [02:25<01:37, 12.21s/it]
Task 4, Epoch 13/20 => Loss 0.071, Train_accy 92.62:  60%|██████    | 12/20 [02:36<01:37, 12.21s/it]
Task 4, Epoch 13/20 => Loss 0.071, Train_accy 92.62:  65%|██████▌   | 13/20 [02:36<01:22, 11.71s/it]
Task 4, Epoch 14/20 => Loss 0.053, Train_accy 94.17:  65%|██████▌   | 13/20 [02:46<01:22, 11.71s/it]
Task 4, Epoch 14/20 => Loss 0.053, Train_accy 94.17:  70%|███████   | 14/20 [02:46<01:08, 11.36s/it]
Task 4, Epoch 15/20 => Loss 0.035, Train_accy 94.35, Test_accy 45.49:  70%|███████   | 14/20 [03:06<01:08, 11.36s/it]
Task 4, Epoch 15/20 => Loss 0.035, Train_accy 94.35, Test_accy 45.49:  75%|███████▌  | 15/20 [03:06<01:09, 13.98s/it]
Task 4, Epoch 16/20 => Loss 0.066, Train_accy 92.62:  75%|███████▌  | 15/20 [03:17<01:09, 13.98s/it]                 
Task 4, Epoch 16/20 => Loss 0.066, Train_accy 92.62:  80%|████████  | 16/20 [03:17<00:51, 12.92s/it]
Task 4, Epoch 17/20 => Loss -0.023, Train_accy 95.81:  80%|████████  | 16/20 [03:27<00:51, 12.92s/it]
Task 4, Epoch 17/20 => Loss -0.023, Train_accy 95.81:  85%|████████▌ | 17/20 [03:27<00:36, 12.18s/it]
Task 4, Epoch 18/20 => Loss 0.017, Train_accy 95.36:  85%|████████▌ | 17/20 [03:38<00:36, 12.18s/it] 
Task 4, Epoch 18/20 => Loss 0.017, Train_accy 95.36:  90%|█████████ | 18/20 [03:38<00:23, 11.67s/it]
Task 4, Epoch 19/20 => Loss -0.000, Train_accy 95.26:  90%|█████████ | 18/20 [03:48<00:23, 11.67s/it]
Task 4, Epoch 19/20 => Loss -0.000, Train_accy 95.26:  95%|█████████▌| 19/20 [03:48<00:11, 11.33s/it]
Task 4, Epoch 20/20 => Loss -0.023, Train_accy 96.36, Test_accy 45.23:  95%|█████████▌| 19/20 [04:08<00:11, 11.33s/it]
Task 4, Epoch 20/20 => Loss -0.023, Train_accy 96.36, Test_accy 45.23: 100%|██████████| 20/20 [04:08<00:00, 13.93s/it]
Task 4, Epoch 20/20 => Loss -0.023, Train_accy 96.36, Test_accy 45.23: 100%|██████████| 20/20 [04:08<00:00, 12.43s/it]
2024-09-07 10:44:54,795 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.023, Train_accy 96.36, Test_accy 45.23
2024-09-07 10:45:04,293 [trainer.py] => No NME accuracy.
2024-09-07 10:45:04,293 [trainer.py] => CNN: {'total': 45.23, '00-39': 55.28, '40-79': 48.82, '80-119': 33.94, '120-159': 39.19, '160-199': 45.02, 'old': 45.27, 'new': 45.02}
2024-09-07 10:45:04,293 [trainer.py] => CNN top1 curve: [65.83, 57.02, 50.46, 47.68, 45.23]
2024-09-07 10:45:04,294 [trainer.py] => CNN top5 curve: [89.72, 84.81, 78.97, 74.92, 72.55]

Average Accuracy (CNN): 53.24
2024-09-07 10:45:04,294 [trainer.py] => Average Accuracy (CNN): 53.24 

Accuracy Matrix (CNN):
[[65.83 63.33 60.56 56.94 55.28]
 [ 0.   50.3  51.18 50.3  48.82]
 [ 0.    0.   36.46 37.91 33.94]
 [ 0.    0.    0.   42.12 39.19]
 [ 0.    0.    0.    0.   45.02]]
2024-09-07 10:45:04,296 [trainer.py] => Forgetting (CNN): 4.952499999999999
2024-09-07 10:45:07,061 [trainer.py] => config: ./exps/l2p_ina_B0_Inc10.json
2024-09-07 10:45:07,061 [trainer.py] => prefix:  
2024-09-07 10:45:07,061 [trainer.py] => dataset: imageneta
2024-09-07 10:45:07,061 [trainer.py] => memory_size: 0
2024-09-07 10:45:07,061 [trainer.py] => memory_per_class: 0
2024-09-07 10:45:07,061 [trainer.py] => fixed_memory: False
2024-09-07 10:45:07,061 [trainer.py] => shuffle: True
2024-09-07 10:45:07,061 [trainer.py] => init_cls: 20
2024-09-07 10:45:07,061 [trainer.py] => increment: 20
2024-09-07 10:45:07,061 [trainer.py] => model_name: l2p
2024-09-07 10:45:07,061 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 10:45:07,061 [trainer.py] => get_original_backbone: True
2024-09-07 10:45:07,061 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 10:45:07,062 [trainer.py] => seed: 1993
2024-09-07 10:45:07,062 [trainer.py] => tuned_epoch: 20
2024-09-07 10:45:07,062 [trainer.py] => init_lr: 0.001875
2024-09-07 10:45:07,062 [trainer.py] => batch_size: 48
2024-09-07 10:45:07,062 [trainer.py] => weight_decay: 0
2024-09-07 10:45:07,062 [trainer.py] => min_lr: 1e-05
2024-09-07 10:45:07,062 [trainer.py] => optimizer: adam
2024-09-07 10:45:07,062 [trainer.py] => scheduler: constant
2024-09-07 10:45:07,062 [trainer.py] => reinit_optimizer: True
2024-09-07 10:45:07,062 [trainer.py] => global_pool: token
2024-09-07 10:45:07,062 [trainer.py] => head_type: prompt
2024-09-07 10:45:07,062 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 10:45:07,062 [trainer.py] => pretrained: True
2024-09-07 10:45:07,062 [trainer.py] => drop: 0.0
2024-09-07 10:45:07,062 [trainer.py] => drop_path: 0.0
2024-09-07 10:45:07,062 [trainer.py] => prompt_pool: True
2024-09-07 10:45:07,062 [trainer.py] => size: 10
2024-09-07 10:45:07,062 [trainer.py] => length: 5
2024-09-07 10:45:07,062 [trainer.py] => top_k: 5
2024-09-07 10:45:07,062 [trainer.py] => initializer: uniform
2024-09-07 10:45:07,062 [trainer.py] => prompt_key: True
2024-09-07 10:45:07,062 [trainer.py] => prompt_key_init: uniform
2024-09-07 10:45:07,062 [trainer.py] => use_prompt_mask: False
2024-09-07 10:45:07,062 [trainer.py] => shared_prompt_pool: False
2024-09-07 10:45:07,062 [trainer.py] => shared_prompt_key: False
2024-09-07 10:45:07,062 [trainer.py] => batchwise_prompt: True
2024-09-07 10:45:07,062 [trainer.py] => embedding_key: cls
2024-09-07 10:45:07,062 [trainer.py] => predefined_key: 
2024-09-07 10:45:07,062 [trainer.py] => pull_constraint: True
2024-09-07 10:45:07,062 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 10:45:07,088 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 10:45:08,469 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 10:45:08,470 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 10:45:10,572 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 10:45:10,572 [l2p.py] => 199,880 model training parameters.
2024-09-07 10:45:10,572 [l2p.py] => prompt.prompt: 38400
2024-09-07 10:45:10,572 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 10:45:10,573 [l2p.py] => head.weight: 153600
2024-09-07 10:45:10,573 [l2p.py] => head.bias: 200
2024-09-07 10:45:10,574 [trainer.py] => All params: 171970192
2024-09-07 10:45:10,575 [trainer.py] => Trainable params: 199880
2024-09-07 10:45:10,575 [l2p.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.795, Train_accy 21.13:   0%|          | 0/20 [00:07<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.795, Train_accy 21.13:   5%|▌         | 1/20 [00:07<02:17,  7.23s/it]
Task 0, Epoch 2/20 => Loss 1.542, Train_accy 50.92:   5%|▌         | 1/20 [00:14<02:17,  7.23s/it]
Task 0, Epoch 2/20 => Loss 1.542, Train_accy 50.92:  10%|█         | 2/20 [00:14<02:06,  7.01s/it]
Task 0, Epoch 3/20 => Loss 1.071, Train_accy 63.55:  10%|█         | 2/20 [00:20<02:06,  7.01s/it]
Task 0, Epoch 3/20 => Loss 1.071, Train_accy 63.55:  15%|█▌        | 3/20 [00:20<01:57,  6.92s/it]
Task 0, Epoch 4/20 => Loss 0.826, Train_accy 74.61:  15%|█▌        | 3/20 [00:27<01:57,  6.92s/it]
Task 0, Epoch 4/20 => Loss 0.826, Train_accy 74.61:  20%|██        | 4/20 [00:27<01:50,  6.89s/it]
Task 0, Epoch 5/20 => Loss 0.616, Train_accy 80.14, Test_accy 69.71:  20%|██        | 4/20 [00:36<01:50,  6.89s/it]
Task 0, Epoch 5/20 => Loss 0.616, Train_accy 80.14, Test_accy 69.71:  25%|██▌       | 5/20 [00:36<01:51,  7.42s/it]
Task 0, Epoch 6/20 => Loss 0.532, Train_accy 81.99:  25%|██▌       | 5/20 [00:42<01:51,  7.42s/it]                 
Task 0, Epoch 6/20 => Loss 0.532, Train_accy 81.99:  30%|███       | 6/20 [00:42<01:41,  7.22s/it]
Task 0, Epoch 7/20 => Loss 0.442, Train_accy 84.26:  30%|███       | 6/20 [00:49<01:41,  7.22s/it]
Task 0, Epoch 7/20 => Loss 0.442, Train_accy 84.26:  35%|███▌      | 7/20 [00:49<01:32,  7.11s/it]
Task 0, Epoch 8/20 => Loss 0.419, Train_accy 85.67:  35%|███▌      | 7/20 [00:56<01:32,  7.11s/it]
Task 0, Epoch 8/20 => Loss 0.419, Train_accy 85.67:  40%|████      | 8/20 [00:56<01:24,  7.05s/it]
Task 0, Epoch 9/20 => Loss 0.343, Train_accy 87.80:  40%|████      | 8/20 [01:03<01:24,  7.05s/it]
Task 0, Epoch 9/20 => Loss 0.343, Train_accy 87.80:  45%|████▌     | 9/20 [01:03<01:16,  7.00s/it]
Task 0, Epoch 10/20 => Loss 0.329, Train_accy 87.80, Test_accy 66.86:  45%|████▌     | 9/20 [01:12<01:16,  7.00s/it]
Task 0, Epoch 10/20 => Loss 0.329, Train_accy 87.80, Test_accy 66.86:  50%|█████     | 10/20 [01:12<01:14,  7.45s/it]
Task 0, Epoch 11/20 => Loss 0.271, Train_accy 89.93:  50%|█████     | 10/20 [01:18<01:14,  7.45s/it]                 
Task 0, Epoch 11/20 => Loss 0.271, Train_accy 89.93:  55%|█████▌    | 11/20 [01:18<01:05,  7.26s/it]
Task 0, Epoch 12/20 => Loss 0.281, Train_accy 90.50:  55%|█████▌    | 11/20 [01:25<01:05,  7.26s/it]
Task 0, Epoch 12/20 => Loss 0.281, Train_accy 90.50:  60%|██████    | 12/20 [01:25<00:57,  7.15s/it]
Task 0, Epoch 13/20 => Loss 0.202, Train_accy 92.77:  60%|██████    | 12/20 [01:32<00:57,  7.15s/it]
Task 0, Epoch 13/20 => Loss 0.202, Train_accy 92.77:  65%|██████▌   | 13/20 [01:32<00:49,  7.06s/it]
Task 0, Epoch 14/20 => Loss 0.218, Train_accy 91.21:  65%|██████▌   | 13/20 [01:39<00:49,  7.06s/it]
Task 0, Epoch 14/20 => Loss 0.218, Train_accy 91.21:  70%|███████   | 14/20 [01:39<00:42,  7.01s/it]
Task 0, Epoch 15/20 => Loss 0.191, Train_accy 91.21, Test_accy 67.43:  70%|███████   | 14/20 [01:47<00:42,  7.01s/it]
Task 0, Epoch 15/20 => Loss 0.191, Train_accy 91.21, Test_accy 67.43:  75%|███████▌  | 15/20 [01:47<00:37,  7.43s/it]
Task 0, Epoch 16/20 => Loss 0.170, Train_accy 92.48:  75%|███████▌  | 15/20 [01:54<00:37,  7.43s/it]                 
Task 0, Epoch 16/20 => Loss 0.170, Train_accy 92.48:  80%|████████  | 16/20 [01:54<00:29,  7.26s/it]
Task 0, Epoch 17/20 => Loss 0.160, Train_accy 92.77:  80%|████████  | 16/20 [02:01<00:29,  7.26s/it]
Task 0, Epoch 17/20 => Loss 0.160, Train_accy 92.77:  85%|████████▌ | 17/20 [02:01<00:21,  7.14s/it]
Task 0, Epoch 18/20 => Loss 0.154, Train_accy 92.62:  85%|████████▌ | 17/20 [02:08<00:21,  7.14s/it]
Task 0, Epoch 18/20 => Loss 0.154, Train_accy 92.62:  90%|█████████ | 18/20 [02:08<00:14,  7.08s/it]
Task 0, Epoch 19/20 => Loss 0.166, Train_accy 91.35:  90%|█████████ | 18/20 [02:15<00:14,  7.08s/it]
Task 0, Epoch 19/20 => Loss 0.166, Train_accy 91.35:  95%|█████████▌| 19/20 [02:15<00:07,  7.02s/it]
Task 0, Epoch 20/20 => Loss 0.131, Train_accy 93.76, Test_accy 69.14:  95%|█████████▌| 19/20 [02:23<00:07,  7.02s/it]
Task 0, Epoch 20/20 => Loss 0.131, Train_accy 93.76, Test_accy 69.14: 100%|██████████| 20/20 [02:23<00:00,  7.43s/it]
Task 0, Epoch 20/20 => Loss 0.131, Train_accy 93.76, Test_accy 69.14: 100%|██████████| 20/20 [02:23<00:00,  7.20s/it]
2024-09-07 10:47:35,093 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.131, Train_accy 93.76, Test_accy 69.14
2024-09-07 10:47:36,596 [trainer.py] => No NME accuracy.
2024-09-07 10:47:36,597 [trainer.py] => CNN: {'total': 69.14, '00-19': 69.14, 'old': 0, 'new': 69.14}
2024-09-07 10:47:36,597 [trainer.py] => CNN top1 curve: [69.14]
2024-09-07 10:47:36,597 [trainer.py] => CNN top5 curve: [93.71]

Average Accuracy (CNN): 69.14
2024-09-07 10:47:36,597 [trainer.py] => Average Accuracy (CNN): 69.14 

2024-09-07 10:47:36,598 [trainer.py] => All params: 171970192
2024-09-07 10:47:36,599 [trainer.py] => Trainable params: 199880
2024-09-07 10:47:36,599 [l2p.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.250, Train_accy 33.55:   0%|          | 0/20 [00:07<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.250, Train_accy 33.55:   5%|▌         | 1/20 [00:07<02:20,  7.40s/it]
Task 1, Epoch 2/20 => Loss 1.004, Train_accy 64.49:   5%|▌         | 1/20 [00:14<02:20,  7.40s/it]
Task 1, Epoch 2/20 => Loss 1.004, Train_accy 64.49:  10%|█         | 2/20 [00:14<02:13,  7.44s/it]
Task 1, Epoch 3/20 => Loss 0.692, Train_accy 74.41:  10%|█         | 2/20 [00:22<02:13,  7.44s/it]
Task 1, Epoch 3/20 => Loss 0.692, Train_accy 74.41:  15%|█▌        | 3/20 [00:22<02:06,  7.44s/it]
Task 1, Epoch 4/20 => Loss 0.531, Train_accy 80.81:  15%|█▌        | 3/20 [00:29<02:06,  7.44s/it]
Task 1, Epoch 4/20 => Loss 0.531, Train_accy 80.81:  20%|██        | 4/20 [00:29<01:59,  7.45s/it]
Task 1, Epoch 5/20 => Loss 0.427, Train_accy 82.90, Test_accy 56.39:  20%|██        | 4/20 [00:39<01:59,  7.45s/it]
Task 1, Epoch 5/20 => Loss 0.427, Train_accy 82.90, Test_accy 56.39:  25%|██▌       | 5/20 [00:39<02:06,  8.41s/it]
Task 1, Epoch 6/20 => Loss 0.412, Train_accy 82.90:  25%|██▌       | 5/20 [00:47<02:06,  8.41s/it]                 
Task 1, Epoch 6/20 => Loss 0.412, Train_accy 82.90:  30%|███       | 6/20 [00:47<01:53,  8.07s/it]
Task 1, Epoch 7/20 => Loss 0.292, Train_accy 87.99:  30%|███       | 6/20 [00:54<01:53,  8.07s/it]
Task 1, Epoch 7/20 => Loss 0.292, Train_accy 87.99:  35%|███▌      | 7/20 [00:54<01:42,  7.87s/it]
Task 1, Epoch 8/20 => Loss 0.238, Train_accy 88.64:  35%|███▌      | 7/20 [01:02<01:42,  7.87s/it]
Task 1, Epoch 8/20 => Loss 0.238, Train_accy 88.64:  40%|████      | 8/20 [01:02<01:32,  7.73s/it]
Task 1, Epoch 9/20 => Loss 0.275, Train_accy 88.38:  40%|████      | 8/20 [01:09<01:32,  7.73s/it]
Task 1, Epoch 9/20 => Loss 0.275, Train_accy 88.38:  45%|████▌     | 9/20 [01:09<01:24,  7.64s/it]
Task 1, Epoch 10/20 => Loss 0.222, Train_accy 90.60, Test_accy 59.17:  45%|████▌     | 9/20 [01:19<01:24,  7.64s/it]
Task 1, Epoch 10/20 => Loss 0.222, Train_accy 90.60, Test_accy 59.17:  50%|█████     | 10/20 [01:19<01:24,  8.40s/it]
Task 1, Epoch 11/20 => Loss 0.271, Train_accy 88.12:  50%|█████     | 10/20 [01:27<01:24,  8.40s/it]                 
Task 1, Epoch 11/20 => Loss 0.271, Train_accy 88.12:  55%|█████▌    | 11/20 [01:27<01:13,  8.12s/it]
Task 1, Epoch 12/20 => Loss 0.173, Train_accy 91.12:  55%|█████▌    | 11/20 [01:34<01:13,  8.12s/it]
Task 1, Epoch 12/20 => Loss 0.173, Train_accy 91.12:  60%|██████    | 12/20 [01:34<01:03,  7.92s/it]
Task 1, Epoch 13/20 => Loss 0.189, Train_accy 89.16:  60%|██████    | 12/20 [01:42<01:03,  7.92s/it]
Task 1, Epoch 13/20 => Loss 0.189, Train_accy 89.16:  65%|██████▌   | 13/20 [01:42<00:54,  7.78s/it]
Task 1, Epoch 14/20 => Loss 0.145, Train_accy 91.51:  65%|██████▌   | 13/20 [01:49<00:54,  7.78s/it]
Task 1, Epoch 14/20 => Loss 0.145, Train_accy 91.51:  70%|███████   | 14/20 [01:49<00:46,  7.68s/it]
Task 1, Epoch 15/20 => Loss 0.128, Train_accy 91.51, Test_accy 61.94:  70%|███████   | 14/20 [01:59<00:46,  7.68s/it]
Task 1, Epoch 15/20 => Loss 0.128, Train_accy 91.51, Test_accy 61.94:  75%|███████▌  | 15/20 [01:59<00:41,  8.40s/it]
Task 1, Epoch 16/20 => Loss 0.069, Train_accy 93.34:  75%|███████▌  | 15/20 [02:07<00:41,  8.40s/it]                 
Task 1, Epoch 16/20 => Loss 0.069, Train_accy 93.34:  80%|████████  | 16/20 [02:07<00:32,  8.11s/it]
Task 1, Epoch 17/20 => Loss 0.128, Train_accy 92.69:  80%|████████  | 16/20 [02:14<00:32,  8.11s/it]
Task 1, Epoch 17/20 => Loss 0.128, Train_accy 92.69:  85%|████████▌ | 17/20 [02:14<00:23,  7.91s/it]
Task 1, Epoch 18/20 => Loss 0.115, Train_accy 92.56:  85%|████████▌ | 17/20 [02:21<00:23,  7.91s/it]
Task 1, Epoch 18/20 => Loss 0.115, Train_accy 92.56:  90%|█████████ | 18/20 [02:21<00:15,  7.77s/it]
Task 1, Epoch 19/20 => Loss 0.062, Train_accy 93.21:  90%|█████████ | 18/20 [02:29<00:15,  7.77s/it]
Task 1, Epoch 19/20 => Loss 0.062, Train_accy 93.21:  95%|█████████▌| 19/20 [02:29<00:07,  7.68s/it]
Task 1, Epoch 20/20 => Loss 0.036, Train_accy 94.13, Test_accy 63.33:  95%|█████████▌| 19/20 [02:39<00:07,  7.68s/it]
Task 1, Epoch 20/20 => Loss 0.036, Train_accy 94.13, Test_accy 63.33: 100%|██████████| 20/20 [02:39<00:00,  8.39s/it]
Task 1, Epoch 20/20 => Loss 0.036, Train_accy 94.13, Test_accy 63.33: 100%|██████████| 20/20 [02:39<00:00,  7.97s/it]
2024-09-07 10:50:16,080 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.036, Train_accy 94.13, Test_accy 63.33
2024-09-07 10:50:18,723 [trainer.py] => No NME accuracy.
2024-09-07 10:50:18,724 [trainer.py] => CNN: {'total': 63.33, '00-19': 68.0, '20-39': 58.92, 'old': 68.0, 'new': 58.92}
2024-09-07 10:50:18,724 [trainer.py] => CNN top1 curve: [69.14, 63.33]
2024-09-07 10:50:18,724 [trainer.py] => CNN top5 curve: [93.71, 89.72]

Average Accuracy (CNN): 66.24
2024-09-07 10:50:18,724 [trainer.py] => Average Accuracy (CNN): 66.24 

2024-09-07 10:50:18,728 [trainer.py] => All params: 171970192
2024-09-07 10:50:18,730 [trainer.py] => Trainable params: 199880
2024-09-07 10:50:18,730 [l2p.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.514, Train_accy 30.72:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.514, Train_accy 30.72:   5%|▌         | 1/20 [00:05<01:37,  5.11s/it]
Task 2, Epoch 2/20 => Loss 0.730, Train_accy 72.41:   5%|▌         | 1/20 [00:10<01:37,  5.11s/it]
Task 2, Epoch 2/20 => Loss 0.730, Train_accy 72.41:  10%|█         | 2/20 [00:10<01:32,  5.12s/it]
Task 2, Epoch 3/20 => Loss 0.315, Train_accy 85.32:  10%|█         | 2/20 [00:15<01:32,  5.12s/it]
Task 2, Epoch 3/20 => Loss 0.315, Train_accy 85.32:  15%|█▌        | 3/20 [00:15<01:27,  5.12s/it]
Task 2, Epoch 4/20 => Loss 0.241, Train_accy 88.85:  15%|█▌        | 3/20 [00:20<01:27,  5.12s/it]
Task 2, Epoch 4/20 => Loss 0.241, Train_accy 88.85:  20%|██        | 4/20 [00:20<01:22,  5.13s/it]
Task 2, Epoch 5/20 => Loss 0.144, Train_accy 90.22, Test_accy 58.40:  20%|██        | 4/20 [00:28<01:22,  5.13s/it]
Task 2, Epoch 5/20 => Loss 0.144, Train_accy 90.22, Test_accy 58.40:  25%|██▌       | 5/20 [00:28<01:35,  6.33s/it]
Task 2, Epoch 6/20 => Loss 0.098, Train_accy 92.37:  25%|██▌       | 5/20 [00:34<01:35,  6.33s/it]                 
Task 2, Epoch 6/20 => Loss 0.098, Train_accy 92.37:  30%|███       | 6/20 [00:34<01:23,  5.93s/it]
Task 2, Epoch 7/20 => Loss 0.083, Train_accy 92.56:  30%|███       | 6/20 [00:39<01:23,  5.93s/it]
Task 2, Epoch 7/20 => Loss 0.083, Train_accy 92.56:  35%|███▌      | 7/20 [00:39<01:13,  5.69s/it]
Task 2, Epoch 8/20 => Loss 0.049, Train_accy 93.35:  35%|███▌      | 7/20 [00:44<01:13,  5.69s/it]
Task 2, Epoch 8/20 => Loss 0.049, Train_accy 93.35:  40%|████      | 8/20 [00:44<01:05,  5.49s/it]
Task 2, Epoch 9/20 => Loss 0.033, Train_accy 95.89:  40%|████      | 8/20 [00:49<01:05,  5.49s/it]
Task 2, Epoch 9/20 => Loss 0.033, Train_accy 95.89:  45%|████▌     | 9/20 [00:49<00:59,  5.37s/it]
Task 2, Epoch 10/20 => Loss 0.003, Train_accy 95.89, Test_accy 58.40:  45%|████▌     | 9/20 [00:57<00:59,  5.37s/it]
Task 2, Epoch 10/20 => Loss 0.003, Train_accy 95.89, Test_accy 58.40:  50%|█████     | 10/20 [00:57<01:03,  6.32s/it]
Task 2, Epoch 11/20 => Loss 0.040, Train_accy 93.54:  50%|█████     | 10/20 [01:03<01:03,  6.32s/it]                 
Task 2, Epoch 11/20 => Loss 0.040, Train_accy 93.54:  55%|█████▌    | 11/20 [01:03<00:53,  5.95s/it]
Task 2, Epoch 12/20 => Loss 0.005, Train_accy 94.72:  55%|█████▌    | 11/20 [01:08<00:53,  5.95s/it]
Task 2, Epoch 12/20 => Loss 0.005, Train_accy 94.72:  60%|██████    | 12/20 [01:08<00:45,  5.69s/it]
Task 2, Epoch 13/20 => Loss 0.024, Train_accy 94.13:  60%|██████    | 12/20 [01:13<00:45,  5.69s/it]
Task 2, Epoch 13/20 => Loss 0.024, Train_accy 94.13:  65%|██████▌   | 13/20 [01:13<00:38,  5.51s/it]
Task 2, Epoch 14/20 => Loss -0.011, Train_accy 96.48:  65%|██████▌   | 13/20 [01:18<00:38,  5.51s/it]
Task 2, Epoch 14/20 => Loss -0.011, Train_accy 96.48:  70%|███████   | 14/20 [01:18<00:32,  5.39s/it]
Task 2, Epoch 15/20 => Loss -0.046, Train_accy 95.69, Test_accy 57.98:  70%|███████   | 14/20 [01:26<00:32,  5.39s/it]
Task 2, Epoch 15/20 => Loss -0.046, Train_accy 95.69, Test_accy 57.98:  75%|███████▌  | 15/20 [01:26<00:31,  6.29s/it]
Task 2, Epoch 16/20 => Loss -0.020, Train_accy 95.30:  75%|███████▌  | 15/20 [01:31<00:31,  6.29s/it]                 
Task 2, Epoch 16/20 => Loss -0.020, Train_accy 95.30:  80%|████████  | 16/20 [01:31<00:23,  5.93s/it]
Task 2, Epoch 17/20 => Loss -0.081, Train_accy 97.85:  80%|████████  | 16/20 [01:36<00:23,  5.93s/it]
Task 2, Epoch 17/20 => Loss -0.081, Train_accy 97.85:  85%|████████▌ | 17/20 [01:36<00:17,  5.68s/it]
Task 2, Epoch 18/20 => Loss -0.073, Train_accy 96.28:  85%|████████▌ | 17/20 [01:42<00:17,  5.68s/it]
Task 2, Epoch 18/20 => Loss -0.073, Train_accy 96.28:  90%|█████████ | 18/20 [01:42<00:11,  5.62s/it]
Task 2, Epoch 19/20 => Loss -0.008, Train_accy 94.32:  90%|█████████ | 18/20 [01:47<00:11,  5.62s/it]
Task 2, Epoch 19/20 => Loss -0.008, Train_accy 94.32:  95%|█████████▌| 19/20 [01:47<00:05,  5.51s/it]
Task 2, Epoch 20/20 => Loss -0.031, Train_accy 96.09, Test_accy 57.98:  95%|█████████▌| 19/20 [01:56<00:05,  5.51s/it]
Task 2, Epoch 20/20 => Loss -0.031, Train_accy 96.09, Test_accy 57.98: 100%|██████████| 20/20 [01:56<00:00,  6.47s/it]
Task 2, Epoch 20/20 => Loss -0.031, Train_accy 96.09, Test_accy 57.98: 100%|██████████| 20/20 [01:56<00:00,  5.82s/it]
2024-09-07 10:52:15,118 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.031, Train_accy 96.09, Test_accy 57.98
2024-09-07 10:52:18,437 [trainer.py] => No NME accuracy.
2024-09-07 10:52:18,437 [trainer.py] => CNN: {'total': 57.98, '00-19': 64.57, '20-39': 52.43, '40-59': 56.9, 'old': 58.33, 'new': 56.9}
2024-09-07 10:52:18,438 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98]
2024-09-07 10:52:18,438 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66]

Average Accuracy (CNN): 63.48
2024-09-07 10:52:18,438 [trainer.py] => Average Accuracy (CNN): 63.48 

2024-09-07 10:52:18,440 [trainer.py] => All params: 171970192
2024-09-07 10:52:18,442 [trainer.py] => Trainable params: 199880
2024-09-07 10:52:18,442 [l2p.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.859, Train_accy 40.56:   0%|          | 0/20 [00:07<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.859, Train_accy 40.56:   5%|▌         | 1/20 [00:07<02:24,  7.60s/it]
Task 3, Epoch 2/20 => Loss 0.668, Train_accy 75.38:   5%|▌         | 1/20 [00:15<02:24,  7.60s/it]
Task 3, Epoch 2/20 => Loss 0.668, Train_accy 75.38:  10%|█         | 2/20 [00:15<02:16,  7.58s/it]
Task 3, Epoch 3/20 => Loss 0.368, Train_accy 83.29:  10%|█         | 2/20 [00:22<02:16,  7.58s/it]
Task 3, Epoch 3/20 => Loss 0.368, Train_accy 83.29:  15%|█▌        | 3/20 [00:22<02:09,  7.60s/it]
Task 3, Epoch 4/20 => Loss 0.311, Train_accy 84.95:  15%|█▌        | 3/20 [00:30<02:09,  7.60s/it]
Task 3, Epoch 4/20 => Loss 0.311, Train_accy 84.95:  20%|██        | 4/20 [00:30<02:01,  7.60s/it]
Task 3, Epoch 5/20 => Loss 0.217, Train_accy 88.01, Test_accy 47.85:  20%|██        | 4/20 [00:42<02:01,  7.60s/it]
Task 3, Epoch 5/20 => Loss 0.217, Train_accy 88.01, Test_accy 47.85:  25%|██▌       | 5/20 [00:42<02:18,  9.26s/it]
Task 3, Epoch 6/20 => Loss 0.223, Train_accy 88.39:  25%|██▌       | 5/20 [00:50<02:18,  9.26s/it]                 
Task 3, Epoch 6/20 => Loss 0.223, Train_accy 88.39:  30%|███       | 6/20 [00:50<02:02,  8.72s/it]
Task 3, Epoch 7/20 => Loss 0.209, Train_accy 87.37:  30%|███       | 6/20 [00:57<02:02,  8.72s/it]
Task 3, Epoch 7/20 => Loss 0.209, Train_accy 87.37:  35%|███▌      | 7/20 [00:57<01:48,  8.36s/it]
Task 3, Epoch 8/20 => Loss 0.125, Train_accy 90.82:  35%|███▌      | 7/20 [01:05<01:48,  8.36s/it]
Task 3, Epoch 8/20 => Loss 0.125, Train_accy 90.82:  40%|████      | 8/20 [01:05<01:37,  8.13s/it]
Task 3, Epoch 9/20 => Loss 0.102, Train_accy 91.07:  40%|████      | 8/20 [01:13<01:37,  8.13s/it]
Task 3, Epoch 9/20 => Loss 0.102, Train_accy 91.07:  45%|████▌     | 9/20 [01:13<01:27,  7.96s/it]
Task 3, Epoch 10/20 => Loss 0.095, Train_accy 92.09, Test_accy 50.14:  45%|████▌     | 9/20 [01:25<01:27,  7.96s/it]
Task 3, Epoch 10/20 => Loss 0.095, Train_accy 92.09, Test_accy 50.14:  50%|█████     | 10/20 [01:25<01:32,  9.30s/it]
Task 3, Epoch 11/20 => Loss 0.064, Train_accy 93.24:  50%|█████     | 10/20 [01:33<01:32,  9.30s/it]                 
Task 3, Epoch 11/20 => Loss 0.064, Train_accy 93.24:  55%|█████▌    | 11/20 [01:33<01:19,  8.78s/it]
Task 3, Epoch 12/20 => Loss 0.081, Train_accy 92.98:  55%|█████▌    | 11/20 [01:40<01:19,  8.78s/it]
Task 3, Epoch 12/20 => Loss 0.081, Train_accy 92.98:  60%|██████    | 12/20 [01:40<01:07,  8.44s/it]
Task 3, Epoch 13/20 => Loss 0.069, Train_accy 92.60:  60%|██████    | 12/20 [01:48<01:07,  8.44s/it]
Task 3, Epoch 13/20 => Loss 0.069, Train_accy 92.60:  65%|██████▌   | 13/20 [01:48<00:57,  8.19s/it]
Task 3, Epoch 14/20 => Loss 0.047, Train_accy 92.98:  65%|██████▌   | 13/20 [01:55<00:57,  8.19s/it]
Task 3, Epoch 14/20 => Loss 0.047, Train_accy 92.98:  70%|███████   | 14/20 [01:55<00:48,  8.01s/it]
Task 3, Epoch 15/20 => Loss 0.023, Train_accy 94.13, Test_accy 50.86:  70%|███████   | 14/20 [02:08<00:48,  8.01s/it]
Task 3, Epoch 15/20 => Loss 0.023, Train_accy 94.13, Test_accy 50.86:  75%|███████▌  | 15/20 [02:08<00:46,  9.30s/it]
Task 3, Epoch 16/20 => Loss 0.002, Train_accy 94.77:  75%|███████▌  | 15/20 [02:15<00:46,  9.30s/it]                 
Task 3, Epoch 16/20 => Loss 0.002, Train_accy 94.77:  80%|████████  | 16/20 [02:15<00:35,  8.80s/it]
Task 3, Epoch 17/20 => Loss 0.030, Train_accy 93.75:  80%|████████  | 16/20 [02:23<00:35,  8.80s/it]
Task 3, Epoch 17/20 => Loss 0.030, Train_accy 93.75:  85%|████████▌ | 17/20 [02:23<00:25,  8.45s/it]
Task 3, Epoch 18/20 => Loss 0.066, Train_accy 92.35:  85%|████████▌ | 17/20 [02:31<00:25,  8.45s/it]
Task 3, Epoch 18/20 => Loss 0.066, Train_accy 92.35:  90%|█████████ | 18/20 [02:31<00:16,  8.21s/it]
Task 3, Epoch 19/20 => Loss 0.010, Train_accy 92.86:  90%|█████████ | 18/20 [02:38<00:16,  8.21s/it]
Task 3, Epoch 19/20 => Loss 0.010, Train_accy 92.86:  95%|█████████▌| 19/20 [02:38<00:08,  8.02s/it]
Task 3, Epoch 20/20 => Loss 0.019, Train_accy 93.37, Test_accy 51.86:  95%|█████████▌| 19/20 [02:51<00:08,  8.02s/it]
Task 3, Epoch 20/20 => Loss 0.019, Train_accy 93.37, Test_accy 51.86: 100%|██████████| 20/20 [02:51<00:00,  9.33s/it]
Task 3, Epoch 20/20 => Loss 0.019, Train_accy 93.37, Test_accy 51.86: 100%|██████████| 20/20 [02:51<00:00,  8.55s/it]
2024-09-07 10:55:09,518 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.019, Train_accy 93.37, Test_accy 51.86
2024-09-07 10:55:14,116 [trainer.py] => No NME accuracy.
2024-09-07 10:55:14,117 [trainer.py] => CNN: {'total': 51.86, '00-19': 62.29, '20-39': 54.59, '40-59': 56.03, '60-79': 39.19, 'old': 57.77, 'new': 39.19}
2024-09-07 10:55:14,117 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98, 51.86]
2024-09-07 10:55:14,117 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66, 81.38]

Average Accuracy (CNN): 60.58
2024-09-07 10:55:14,117 [trainer.py] => Average Accuracy (CNN): 60.58 

2024-09-07 10:55:14,120 [trainer.py] => All params: 171970192
2024-09-07 10:55:14,122 [trainer.py] => Trainable params: 199880
2024-09-07 10:55:14,122 [l2p.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.000, Train_accy 41.60:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.000, Train_accy 41.60:   5%|▌         | 1/20 [00:05<01:39,  5.24s/it]
Task 4, Epoch 2/20 => Loss 0.617, Train_accy 77.67:   5%|▌         | 1/20 [00:10<01:39,  5.24s/it]
Task 4, Epoch 2/20 => Loss 0.617, Train_accy 77.67:  10%|█         | 2/20 [00:10<01:34,  5.23s/it]
Task 4, Epoch 3/20 => Loss 0.335, Train_accy 83.59:  10%|█         | 2/20 [00:15<01:34,  5.23s/it]
Task 4, Epoch 3/20 => Loss 0.335, Train_accy 83.59:  15%|█▌        | 3/20 [00:15<01:28,  5.23s/it]
Task 4, Epoch 4/20 => Loss 0.154, Train_accy 88.74:  15%|█▌        | 3/20 [00:20<01:28,  5.23s/it]
Task 4, Epoch 4/20 => Loss 0.154, Train_accy 88.74:  20%|██        | 4/20 [00:20<01:23,  5.22s/it]
Task 4, Epoch 5/20 => Loss 0.068, Train_accy 92.75, Test_accy 47.09:  20%|██        | 4/20 [00:31<01:23,  5.22s/it]
Task 4, Epoch 5/20 => Loss 0.068, Train_accy 92.75, Test_accy 47.09:  25%|██▌       | 5/20 [00:31<01:48,  7.21s/it]
Task 4, Epoch 6/20 => Loss 0.088, Train_accy 91.41:  25%|██▌       | 5/20 [00:36<01:48,  7.21s/it]                 
Task 4, Epoch 6/20 => Loss 0.088, Train_accy 91.41:  30%|███       | 6/20 [00:36<01:31,  6.54s/it]
Task 4, Epoch 7/20 => Loss 0.110, Train_accy 91.22:  30%|███       | 6/20 [00:42<01:31,  6.54s/it]
Task 4, Epoch 7/20 => Loss 0.110, Train_accy 91.22:  35%|███▌      | 7/20 [00:42<01:19,  6.12s/it]
Task 4, Epoch 8/20 => Loss 0.065, Train_accy 92.94:  35%|███▌      | 7/20 [00:47<01:19,  6.12s/it]
Task 4, Epoch 8/20 => Loss 0.065, Train_accy 92.94:  40%|████      | 8/20 [00:47<01:10,  5.85s/it]
Task 4, Epoch 9/20 => Loss 0.028, Train_accy 93.51:  40%|████      | 8/20 [00:52<01:10,  5.85s/it]
Task 4, Epoch 9/20 => Loss 0.028, Train_accy 93.51:  45%|████▌     | 9/20 [00:52<01:02,  5.66s/it]
Task 4, Epoch 10/20 => Loss -0.007, Train_accy 95.23, Test_accy 48.16:  45%|████▌     | 9/20 [01:03<01:02,  5.66s/it]
Task 4, Epoch 10/20 => Loss -0.007, Train_accy 95.23, Test_accy 48.16:  50%|█████     | 10/20 [01:03<01:12,  7.23s/it]
Task 4, Epoch 11/20 => Loss -0.003, Train_accy 94.66:  50%|█████     | 10/20 [01:08<01:12,  7.23s/it]                 
Task 4, Epoch 11/20 => Loss -0.003, Train_accy 94.66:  55%|█████▌    | 11/20 [01:08<00:59,  6.63s/it]
Task 4, Epoch 12/20 => Loss 0.002, Train_accy 94.47:  55%|█████▌    | 11/20 [01:13<00:59,  6.63s/it] 
Task 4, Epoch 12/20 => Loss 0.002, Train_accy 94.47:  60%|██████    | 12/20 [01:13<00:49,  6.22s/it]
Task 4, Epoch 13/20 => Loss 0.012, Train_accy 94.85:  60%|██████    | 12/20 [01:19<00:49,  6.22s/it]
Task 4, Epoch 13/20 => Loss 0.012, Train_accy 94.85:  65%|██████▌   | 13/20 [01:19<00:41,  5.92s/it]
Task 4, Epoch 14/20 => Loss -0.018, Train_accy 95.99:  65%|██████▌   | 13/20 [01:24<00:41,  5.92s/it]
Task 4, Epoch 14/20 => Loss -0.018, Train_accy 95.99:  70%|███████   | 14/20 [01:24<00:34,  5.72s/it]
Task 4, Epoch 15/20 => Loss 0.007, Train_accy 95.04, Test_accy 48.75:  70%|███████   | 14/20 [01:35<00:34,  5.72s/it]
Task 4, Epoch 15/20 => Loss 0.007, Train_accy 95.04, Test_accy 48.75:  75%|███████▌  | 15/20 [01:35<00:36,  7.23s/it]
Task 4, Epoch 16/20 => Loss -0.016, Train_accy 94.27:  75%|███████▌  | 15/20 [01:40<00:36,  7.23s/it]                
Task 4, Epoch 16/20 => Loss -0.016, Train_accy 94.27:  80%|████████  | 16/20 [01:40<00:26,  6.64s/it]
Task 4, Epoch 17/20 => Loss -0.039, Train_accy 96.18:  80%|████████  | 16/20 [01:45<00:26,  6.64s/it]
Task 4, Epoch 17/20 => Loss -0.039, Train_accy 96.18:  85%|████████▌ | 17/20 [01:45<00:18,  6.21s/it]
Task 4, Epoch 18/20 => Loss -0.069, Train_accy 97.14:  85%|████████▌ | 17/20 [01:50<00:18,  6.21s/it]
Task 4, Epoch 18/20 => Loss -0.069, Train_accy 97.14:  90%|█████████ | 18/20 [01:50<00:11,  5.92s/it]
Task 4, Epoch 19/20 => Loss -0.069, Train_accy 96.76:  90%|█████████ | 18/20 [01:56<00:11,  5.92s/it]
Task 4, Epoch 19/20 => Loss -0.069, Train_accy 96.76:  95%|█████████▌| 19/20 [01:56<00:05,  5.73s/it]
Task 4, Epoch 20/20 => Loss -0.080, Train_accy 97.33, Test_accy 49.82:  95%|█████████▌| 19/20 [02:06<00:05,  5.73s/it]
Task 4, Epoch 20/20 => Loss -0.080, Train_accy 97.33, Test_accy 49.82: 100%|██████████| 20/20 [02:06<00:00,  7.23s/it]
Task 4, Epoch 20/20 => Loss -0.080, Train_accy 97.33, Test_accy 49.82: 100%|██████████| 20/20 [02:06<00:00,  6.34s/it]
2024-09-07 10:57:21,023 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.080, Train_accy 97.33, Test_accy 49.82
2024-09-07 10:57:26,487 [trainer.py] => No NME accuracy.
2024-09-07 10:57:26,487 [trainer.py] => CNN: {'total': 49.82, '00-19': 61.71, '20-39': 56.76, '40-59': 56.03, '60-79': 38.29, '80-99': 39.16, 'old': 52.01, 'new': 39.16}
2024-09-07 10:57:26,488 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98, 51.86, 49.82]
2024-09-07 10:57:26,488 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66, 81.38, 78.72]

Average Accuracy (CNN): 58.43
2024-09-07 10:57:26,488 [trainer.py] => Average Accuracy (CNN): 58.43 

2024-09-07 10:57:26,491 [trainer.py] => All params: 171970192
2024-09-07 10:57:26,493 [trainer.py] => Trainable params: 199880
2024-09-07 10:57:26,493 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.211, Train_accy 41.11:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.211, Train_accy 41.11:   5%|▌         | 1/20 [00:05<01:39,  5.22s/it]
Task 5, Epoch 2/20 => Loss 0.604, Train_accy 77.25:   5%|▌         | 1/20 [00:10<01:39,  5.22s/it]
Task 5, Epoch 2/20 => Loss 0.604, Train_accy 77.25:  10%|█         | 2/20 [00:10<01:33,  5.22s/it]
Task 5, Epoch 3/20 => Loss 0.264, Train_accy 87.76:  10%|█         | 2/20 [00:15<01:33,  5.22s/it]
Task 5, Epoch 3/20 => Loss 0.264, Train_accy 87.76:  15%|█▌        | 3/20 [00:15<01:28,  5.21s/it]
Task 5, Epoch 4/20 => Loss 0.117, Train_accy 90.25:  15%|█▌        | 3/20 [00:20<01:28,  5.21s/it]
Task 5, Epoch 4/20 => Loss 0.117, Train_accy 90.25:  20%|██        | 4/20 [00:20<01:23,  5.22s/it]
Task 5, Epoch 5/20 => Loss 0.096, Train_accy 91.20, Test_accy 47.08:  20%|██        | 4/20 [00:32<01:23,  5.22s/it]
Task 5, Epoch 5/20 => Loss 0.096, Train_accy 91.20, Test_accy 47.08:  25%|██▌       | 5/20 [00:32<01:52,  7.50s/it]
Task 5, Epoch 6/20 => Loss 0.101, Train_accy 93.12:  25%|██▌       | 5/20 [00:37<01:52,  7.50s/it]                 
Task 5, Epoch 6/20 => Loss 0.101, Train_accy 93.12:  30%|███       | 6/20 [00:37<01:34,  6.72s/it]
Task 5, Epoch 7/20 => Loss 0.028, Train_accy 94.07:  30%|███       | 6/20 [00:42<01:34,  6.72s/it]
Task 5, Epoch 7/20 => Loss 0.028, Train_accy 94.07:  35%|███▌      | 7/20 [00:42<01:21,  6.24s/it]
Task 5, Epoch 8/20 => Loss 0.068, Train_accy 92.93:  35%|███▌      | 7/20 [00:48<01:21,  6.24s/it]
Task 5, Epoch 8/20 => Loss 0.068, Train_accy 92.93:  40%|████      | 8/20 [00:48<01:11,  5.92s/it]
Task 5, Epoch 9/20 => Loss 0.039, Train_accy 93.50:  40%|████      | 8/20 [00:53<01:11,  5.92s/it]
Task 5, Epoch 9/20 => Loss 0.039, Train_accy 93.50:  45%|████▌     | 9/20 [00:53<01:02,  5.70s/it]
Task 5, Epoch 10/20 => Loss -0.036, Train_accy 96.94, Test_accy 47.49:  45%|████▌     | 9/20 [01:04<01:02,  5.70s/it]
Task 5, Epoch 10/20 => Loss -0.036, Train_accy 96.94, Test_accy 47.49:  50%|█████     | 10/20 [01:04<01:15,  7.51s/it]
Task 5, Epoch 11/20 => Loss 0.015, Train_accy 94.07:  50%|█████     | 10/20 [01:10<01:15,  7.51s/it]                  
Task 5, Epoch 11/20 => Loss 0.015, Train_accy 94.07:  55%|█████▌    | 11/20 [01:10<01:01,  6.82s/it]
Task 5, Epoch 12/20 => Loss -0.023, Train_accy 95.60:  55%|█████▌    | 11/20 [01:15<01:01,  6.82s/it]
Task 5, Epoch 12/20 => Loss -0.023, Train_accy 95.60:  60%|██████    | 12/20 [01:15<00:50,  6.34s/it]
Task 5, Epoch 13/20 => Loss -0.024, Train_accy 95.79:  60%|██████    | 12/20 [01:20<00:50,  6.34s/it]
Task 5, Epoch 13/20 => Loss -0.024, Train_accy 95.79:  65%|██████▌   | 13/20 [01:20<00:42,  6.00s/it]
Task 5, Epoch 14/20 => Loss -0.062, Train_accy 96.75:  65%|██████▌   | 13/20 [01:25<00:42,  6.00s/it]
Task 5, Epoch 14/20 => Loss -0.062, Train_accy 96.75:  70%|███████   | 14/20 [01:25<00:34,  5.78s/it]
Task 5, Epoch 15/20 => Loss -0.049, Train_accy 96.18, Test_accy 48.31:  70%|███████   | 14/20 [01:37<00:34,  5.78s/it]
Task 5, Epoch 15/20 => Loss -0.049, Train_accy 96.18, Test_accy 48.31:  75%|███████▌  | 15/20 [01:37<00:37,  7.55s/it]
Task 5, Epoch 16/20 => Loss 0.002, Train_accy 95.60:  75%|███████▌  | 15/20 [01:42<00:37,  7.55s/it]                  
Task 5, Epoch 16/20 => Loss 0.002, Train_accy 95.60:  80%|████████  | 16/20 [01:42<00:27,  6.85s/it]
Task 5, Epoch 17/20 => Loss -0.085, Train_accy 97.13:  80%|████████  | 16/20 [01:47<00:27,  6.85s/it]
Task 5, Epoch 17/20 => Loss -0.085, Train_accy 97.13:  85%|████████▌ | 17/20 [01:47<00:19,  6.36s/it]
Task 5, Epoch 18/20 => Loss -0.058, Train_accy 96.56:  85%|████████▌ | 17/20 [01:53<00:19,  6.36s/it]
Task 5, Epoch 18/20 => Loss -0.058, Train_accy 96.56:  90%|█████████ | 18/20 [01:53<00:12,  6.01s/it]
Task 5, Epoch 19/20 => Loss -0.044, Train_accy 96.37:  90%|█████████ | 18/20 [01:58<00:12,  6.01s/it]
Task 5, Epoch 19/20 => Loss -0.044, Train_accy 96.37:  95%|█████████▌| 19/20 [01:58<00:05,  5.77s/it]
Task 5, Epoch 20/20 => Loss -0.058, Train_accy 96.75, Test_accy 49.03:  95%|█████████▌| 19/20 [02:09<00:05,  5.77s/it]
Task 5, Epoch 20/20 => Loss -0.058, Train_accy 96.75, Test_accy 49.03: 100%|██████████| 20/20 [02:09<00:00,  7.47s/it]
Task 5, Epoch 20/20 => Loss -0.058, Train_accy 96.75, Test_accy 49.03: 100%|██████████| 20/20 [02:09<00:00,  6.49s/it]
2024-09-07 10:59:36,327 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.058, Train_accy 96.75, Test_accy 49.03
2024-09-07 10:59:42,579 [trainer.py] => No NME accuracy.
2024-09-07 10:59:42,579 [trainer.py] => CNN: {'total': 49.03, '00-19': 61.71, '20-39': 58.38, '40-59': 56.03, '60-79': 38.74, '80-99': 39.16, '100-119': 41.04, 'old': 50.3, 'new': 41.04}
2024-09-07 10:59:42,579 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98, 51.86, 49.82, 49.03]
2024-09-07 10:59:42,580 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66, 81.38, 78.72, 78.36]

Average Accuracy (CNN): 56.86
2024-09-07 10:59:42,580 [trainer.py] => Average Accuracy (CNN): 56.86 

2024-09-07 10:59:42,582 [trainer.py] => All params: 171970192
2024-09-07 10:59:42,585 [trainer.py] => Trainable params: 199880
2024-09-07 10:59:42,585 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.379, Train_accy 26.16:   0%|          | 0/20 [00:05<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.379, Train_accy 26.16:   5%|▌         | 1/20 [00:05<01:41,  5.36s/it]
Task 6, Epoch 2/20 => Loss 0.789, Train_accy 72.73:   5%|▌         | 1/20 [00:10<01:41,  5.36s/it]
Task 6, Epoch 2/20 => Loss 0.789, Train_accy 72.73:  10%|█         | 2/20 [00:10<01:36,  5.35s/it]
Task 6, Epoch 3/20 => Loss 0.408, Train_accy 81.26:  10%|█         | 2/20 [00:16<01:36,  5.35s/it]
Task 6, Epoch 3/20 => Loss 0.408, Train_accy 81.26:  15%|█▌        | 3/20 [00:16<01:30,  5.35s/it]
Task 6, Epoch 4/20 => Loss 0.199, Train_accy 89.24:  15%|█▌        | 3/20 [00:21<01:30,  5.35s/it]
Task 6, Epoch 4/20 => Loss 0.199, Train_accy 89.24:  20%|██        | 4/20 [00:21<01:25,  5.36s/it]
Task 6, Epoch 5/20 => Loss 0.130, Train_accy 91.28, Test_accy 46.39:  20%|██        | 4/20 [00:33<01:25,  5.36s/it]
Task 6, Epoch 5/20 => Loss 0.130, Train_accy 91.28, Test_accy 46.39:  25%|██▌       | 5/20 [00:33<01:59,  7.95s/it]
Task 6, Epoch 6/20 => Loss 0.181, Train_accy 88.50:  25%|██▌       | 5/20 [00:39<01:59,  7.95s/it]                 
Task 6, Epoch 6/20 => Loss 0.181, Train_accy 88.50:  30%|███       | 6/20 [00:39<01:39,  7.10s/it]
Task 6, Epoch 7/20 => Loss 0.128, Train_accy 90.35:  30%|███       | 6/20 [00:44<01:39,  7.10s/it]
Task 6, Epoch 7/20 => Loss 0.128, Train_accy 90.35:  35%|███▌      | 7/20 [00:44<01:25,  6.54s/it]
Task 6, Epoch 8/20 => Loss 0.146, Train_accy 90.17:  35%|███▌      | 7/20 [00:50<01:25,  6.54s/it]
Task 6, Epoch 8/20 => Loss 0.146, Train_accy 90.17:  40%|████      | 8/20 [00:50<01:14,  6.18s/it]
Task 6, Epoch 9/20 => Loss 0.077, Train_accy 91.84:  40%|████      | 8/20 [00:55<01:14,  6.18s/it]
Task 6, Epoch 9/20 => Loss 0.077, Train_accy 91.84:  45%|████▌     | 9/20 [00:55<01:05,  5.93s/it]
Task 6, Epoch 10/20 => Loss 0.008, Train_accy 94.25, Test_accy 47.01:  45%|████▌     | 9/20 [01:08<01:05,  5.93s/it]
Task 6, Epoch 10/20 => Loss 0.008, Train_accy 94.25, Test_accy 47.01:  50%|█████     | 10/20 [01:08<01:19,  7.95s/it]
Task 6, Epoch 11/20 => Loss 0.045, Train_accy 93.32:  50%|█████     | 10/20 [01:13<01:19,  7.95s/it]                 
Task 6, Epoch 11/20 => Loss 0.045, Train_accy 93.32:  55%|█████▌    | 11/20 [01:13<01:04,  7.17s/it]
Task 6, Epoch 12/20 => Loss -0.025, Train_accy 95.55:  55%|█████▌    | 11/20 [01:18<01:04,  7.17s/it]
Task 6, Epoch 12/20 => Loss -0.025, Train_accy 95.55:  60%|██████    | 12/20 [01:18<00:53,  6.63s/it]
Task 6, Epoch 13/20 => Loss 0.007, Train_accy 94.62:  60%|██████    | 12/20 [01:24<00:53,  6.63s/it] 
Task 6, Epoch 13/20 => Loss 0.007, Train_accy 94.62:  65%|██████▌   | 13/20 [01:24<00:43,  6.28s/it]
Task 6, Epoch 14/20 => Loss -0.033, Train_accy 96.29:  65%|██████▌   | 13/20 [01:29<00:43,  6.28s/it]
Task 6, Epoch 14/20 => Loss -0.033, Train_accy 96.29:  70%|███████   | 14/20 [01:29<00:36,  6.01s/it]
Task 6, Epoch 15/20 => Loss -0.020, Train_accy 95.18, Test_accy 48.08:  70%|███████   | 14/20 [01:42<00:36,  6.01s/it]
Task 6, Epoch 15/20 => Loss -0.020, Train_accy 95.18, Test_accy 48.08:  75%|███████▌  | 15/20 [01:42<00:39,  7.96s/it]
Task 6, Epoch 16/20 => Loss -0.045, Train_accy 96.10:  75%|███████▌  | 15/20 [01:47<00:39,  7.96s/it]                 
Task 6, Epoch 16/20 => Loss -0.045, Train_accy 96.10:  80%|████████  | 16/20 [01:47<00:28,  7.19s/it]
Task 6, Epoch 17/20 => Loss -0.033, Train_accy 96.29:  80%|████████  | 16/20 [01:52<00:28,  7.19s/it]
Task 6, Epoch 17/20 => Loss -0.033, Train_accy 96.29:  85%|████████▌ | 17/20 [01:52<00:19,  6.63s/it]
Task 6, Epoch 18/20 => Loss -0.043, Train_accy 96.85:  85%|████████▌ | 17/20 [01:58<00:19,  6.63s/it]
Task 6, Epoch 18/20 => Loss -0.043, Train_accy 96.85:  90%|█████████ | 18/20 [01:58<00:12,  6.26s/it]
Task 6, Epoch 19/20 => Loss -0.027, Train_accy 95.92:  90%|█████████ | 18/20 [02:03<00:12,  6.26s/it]
Task 6, Epoch 19/20 => Loss -0.027, Train_accy 95.92:  95%|█████████▌| 19/20 [02:03<00:05,  5.98s/it]
Task 6, Epoch 20/20 => Loss -0.021, Train_accy 95.55, Test_accy 48.17:  95%|█████████▌| 19/20 [02:16<00:05,  5.98s/it]
Task 6, Epoch 20/20 => Loss -0.021, Train_accy 95.55, Test_accy 48.17: 100%|██████████| 20/20 [02:16<00:00,  7.93s/it]
Task 6, Epoch 20/20 => Loss -0.021, Train_accy 95.55, Test_accy 48.17: 100%|██████████| 20/20 [02:16<00:00,  6.81s/it]
2024-09-07 11:01:58,733 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.021, Train_accy 95.55, Test_accy 48.17
2024-09-07 11:02:05,883 [trainer.py] => No NME accuracy.
2024-09-07 11:02:05,884 [trainer.py] => CNN: {'total': 48.17, '00-19': 57.14, '20-39': 57.84, '40-59': 56.03, '60-79': 40.54, '80-99': 41.26, '100-119': 41.79, '120-139': 43.15, 'old': 48.92, 'new': 43.15}
2024-09-07 11:02:05,884 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98, 51.86, 49.82, 49.03, 48.17]
2024-09-07 11:02:05,884 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66, 81.38, 78.72, 78.36, 76.54]

Average Accuracy (CNN): 55.62
2024-09-07 11:02:05,884 [trainer.py] => Average Accuracy (CNN): 55.62 

2024-09-07 11:02:05,887 [trainer.py] => All params: 171970192
2024-09-07 11:02:05,889 [trainer.py] => Trainable params: 199880
2024-09-07 11:02:05,889 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.136, Train_accy 34.84:   0%|          | 0/20 [00:05<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.136, Train_accy 34.84:   5%|▌         | 1/20 [00:05<01:40,  5.28s/it]
Task 7, Epoch 2/20 => Loss 0.788, Train_accy 76.84:   5%|▌         | 1/20 [00:10<01:40,  5.28s/it]
Task 7, Epoch 2/20 => Loss 0.788, Train_accy 76.84:  10%|█         | 2/20 [00:10<01:35,  5.29s/it]
Task 7, Epoch 3/20 => Loss 0.345, Train_accy 85.31:  10%|█         | 2/20 [00:15<01:35,  5.29s/it]
Task 7, Epoch 3/20 => Loss 0.345, Train_accy 85.31:  15%|█▌        | 3/20 [00:15<01:29,  5.29s/it]
Task 7, Epoch 4/20 => Loss 0.284, Train_accy 88.51:  15%|█▌        | 3/20 [00:21<01:29,  5.29s/it]
Task 7, Epoch 4/20 => Loss 0.284, Train_accy 88.51:  20%|██        | 4/20 [00:21<01:24,  5.28s/it]
Task 7, Epoch 5/20 => Loss 0.149, Train_accy 89.64, Test_accy 46.23:  20%|██        | 4/20 [00:34<01:24,  5.28s/it]
Task 7, Epoch 5/20 => Loss 0.149, Train_accy 89.64, Test_accy 46.23:  25%|██▌       | 5/20 [00:34<02:01,  8.12s/it]
Task 7, Epoch 6/20 => Loss 0.114, Train_accy 92.09:  25%|██▌       | 5/20 [00:39<02:01,  8.12s/it]                 
Task 7, Epoch 6/20 => Loss 0.114, Train_accy 92.09:  30%|███       | 6/20 [00:39<01:40,  7.15s/it]
Task 7, Epoch 7/20 => Loss 0.089, Train_accy 93.03:  30%|███       | 6/20 [00:44<01:40,  7.15s/it]
Task 7, Epoch 7/20 => Loss 0.089, Train_accy 93.03:  35%|███▌      | 7/20 [00:44<01:24,  6.54s/it]
Task 7, Epoch 8/20 => Loss 0.104, Train_accy 92.09:  35%|███▌      | 7/20 [00:50<01:24,  6.54s/it]
Task 7, Epoch 8/20 => Loss 0.104, Train_accy 92.09:  40%|████      | 8/20 [00:50<01:13,  6.14s/it]
Task 7, Epoch 9/20 => Loss 0.169, Train_accy 92.47:  40%|████      | 8/20 [00:55<01:13,  6.14s/it]
Task 7, Epoch 9/20 => Loss 0.169, Train_accy 92.47:  45%|████▌     | 9/20 [00:55<01:04,  5.87s/it]
Task 7, Epoch 10/20 => Loss 0.048, Train_accy 94.73, Test_accy 46.47:  45%|████▌     | 9/20 [01:08<01:04,  5.87s/it]
Task 7, Epoch 10/20 => Loss 0.048, Train_accy 94.73, Test_accy 46.47:  50%|█████     | 10/20 [01:08<01:21,  8.15s/it]
Task 7, Epoch 11/20 => Loss 0.092, Train_accy 92.09:  50%|█████     | 10/20 [01:13<01:21,  8.15s/it]                 
Task 7, Epoch 11/20 => Loss 0.092, Train_accy 92.09:  55%|█████▌    | 11/20 [01:13<01:05,  7.27s/it]
Task 7, Epoch 12/20 => Loss 0.002, Train_accy 94.54:  55%|█████▌    | 11/20 [01:19<01:05,  7.27s/it]
Task 7, Epoch 12/20 => Loss 0.002, Train_accy 94.54:  60%|██████    | 12/20 [01:19<00:53,  6.67s/it]
Task 7, Epoch 13/20 => Loss -0.022, Train_accy 94.54:  60%|██████    | 12/20 [01:24<00:53,  6.67s/it]
Task 7, Epoch 13/20 => Loss -0.022, Train_accy 94.54:  65%|██████▌   | 13/20 [01:24<00:43,  6.26s/it]
Task 7, Epoch 14/20 => Loss -0.003, Train_accy 95.48:  65%|██████▌   | 13/20 [01:29<00:43,  6.26s/it]
Task 7, Epoch 14/20 => Loss -0.003, Train_accy 95.48:  70%|███████   | 14/20 [01:29<00:35,  5.97s/it]
Task 7, Epoch 15/20 => Loss -0.030, Train_accy 96.61, Test_accy 46.88:  70%|███████   | 14/20 [01:43<00:35,  5.97s/it]
Task 7, Epoch 15/20 => Loss -0.030, Train_accy 96.61, Test_accy 46.88:  75%|███████▌  | 15/20 [01:43<00:40,  8.15s/it]
Task 7, Epoch 16/20 => Loss -0.001, Train_accy 94.16:  75%|███████▌  | 15/20 [01:48<00:40,  8.15s/it]                 
Task 7, Epoch 16/20 => Loss -0.001, Train_accy 94.16:  80%|████████  | 16/20 [01:48<00:29,  7.29s/it]
Task 7, Epoch 17/20 => Loss -0.047, Train_accy 95.48:  80%|████████  | 16/20 [01:53<00:29,  7.29s/it]
Task 7, Epoch 17/20 => Loss -0.047, Train_accy 95.48:  85%|████████▌ | 17/20 [01:53<00:20,  6.69s/it]
Task 7, Epoch 18/20 => Loss -0.001, Train_accy 93.97:  85%|████████▌ | 17/20 [01:58<00:20,  6.69s/it]
Task 7, Epoch 18/20 => Loss -0.001, Train_accy 93.97:  90%|█████████ | 18/20 [01:58<00:12,  6.27s/it]
Task 7, Epoch 19/20 => Loss -0.020, Train_accy 96.05:  90%|█████████ | 18/20 [02:04<00:12,  6.27s/it]
Task 7, Epoch 19/20 => Loss -0.020, Train_accy 96.05:  95%|█████████▌| 19/20 [02:04<00:06,  6.00s/it]
Task 7, Epoch 20/20 => Loss -0.042, Train_accy 96.05, Test_accy 47.04:  95%|█████████▌| 19/20 [02:17<00:06,  6.00s/it]
Task 7, Epoch 20/20 => Loss -0.042, Train_accy 96.05, Test_accy 47.04: 100%|██████████| 20/20 [02:17<00:00,  8.17s/it]
Task 7, Epoch 20/20 => Loss -0.042, Train_accy 96.05, Test_accy 47.04: 100%|██████████| 20/20 [02:17<00:00,  6.88s/it]
2024-09-07 11:04:23,443 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.042, Train_accy 96.05, Test_accy 47.04
2024-09-07 11:04:31,376 [trainer.py] => No NME accuracy.
2024-09-07 11:04:31,376 [trainer.py] => CNN: {'total': 47.04, '00-19': 57.71, '20-39': 57.3, '40-59': 53.45, '60-79': 40.54, '80-99': 39.16, '100-119': 41.79, '120-139': 44.52, '140-159': 40.16, 'old': 47.81, 'new': 40.16}
2024-09-07 11:04:31,376 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98, 51.86, 49.82, 49.03, 48.17, 47.04]
2024-09-07 11:04:31,376 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66, 81.38, 78.72, 78.36, 76.54, 75.16]

Average Accuracy (CNN): 54.55
2024-09-07 11:04:31,377 [trainer.py] => Average Accuracy (CNN): 54.55 

2024-09-07 11:04:31,379 [trainer.py] => All params: 171970192
2024-09-07 11:04:31,381 [trainer.py] => Trainable params: 199880
2024-09-07 11:04:31,381 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.579, Train_accy 25.39:   0%|          | 0/20 [00:05<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.579, Train_accy 25.39:   5%|▌         | 1/20 [00:05<01:47,  5.68s/it]
Task 8, Epoch 2/20 => Loss 0.888, Train_accy 66.37:   5%|▌         | 1/20 [00:11<01:47,  5.68s/it]
Task 8, Epoch 2/20 => Loss 0.888, Train_accy 66.37:  10%|█         | 2/20 [00:11<01:42,  5.70s/it]
Task 8, Epoch 3/20 => Loss 0.490, Train_accy 81.79:  10%|█         | 2/20 [00:17<01:42,  5.70s/it]
Task 8, Epoch 3/20 => Loss 0.490, Train_accy 81.79:  15%|█▌        | 3/20 [00:17<01:37,  5.71s/it]
Task 8, Epoch 4/20 => Loss 0.316, Train_accy 83.89:  15%|█▌        | 3/20 [00:22<01:37,  5.71s/it]
Task 8, Epoch 4/20 => Loss 0.316, Train_accy 83.89:  20%|██        | 4/20 [00:22<01:31,  5.70s/it]
Task 8, Epoch 5/20 => Loss 0.234, Train_accy 87.74, Test_accy 43.58:  20%|██        | 4/20 [00:37<01:31,  5.70s/it]
Task 8, Epoch 5/20 => Loss 0.234, Train_accy 87.74, Test_accy 43.58:  25%|██▌       | 5/20 [00:37<02:13,  8.89s/it]
Task 8, Epoch 6/20 => Loss 0.169, Train_accy 89.32:  25%|██▌       | 5/20 [00:42<02:13,  8.89s/it]                 
Task 8, Epoch 6/20 => Loss 0.169, Train_accy 89.32:  30%|███       | 6/20 [00:43<01:49,  7.79s/it]
Task 8, Epoch 7/20 => Loss 0.160, Train_accy 89.14:  30%|███       | 6/20 [00:48<01:49,  7.79s/it]
Task 8, Epoch 7/20 => Loss 0.160, Train_accy 89.14:  35%|███▌      | 7/20 [00:48<01:32,  7.11s/it]
Task 8, Epoch 8/20 => Loss 0.067, Train_accy 91.77:  35%|███▌      | 7/20 [00:54<01:32,  7.11s/it]
Task 8, Epoch 8/20 => Loss 0.067, Train_accy 91.77:  40%|████      | 8/20 [00:54<01:19,  6.65s/it]
Task 8, Epoch 9/20 => Loss 0.122, Train_accy 91.24:  40%|████      | 8/20 [01:00<01:19,  6.65s/it]
Task 8, Epoch 9/20 => Loss 0.122, Train_accy 91.24:  45%|████▌     | 9/20 [01:00<01:09,  6.33s/it]
Task 8, Epoch 10/20 => Loss 0.052, Train_accy 94.22, Test_accy 44.30:  45%|████▌     | 9/20 [01:14<01:09,  6.33s/it]
Task 8, Epoch 10/20 => Loss 0.052, Train_accy 94.22, Test_accy 44.30:  50%|█████     | 10/20 [01:14<01:28,  8.85s/it]
Task 8, Epoch 11/20 => Loss 0.039, Train_accy 93.52:  50%|█████     | 10/20 [01:20<01:28,  8.85s/it]                 
Task 8, Epoch 11/20 => Loss 0.039, Train_accy 93.52:  55%|█████▌    | 11/20 [01:20<01:11,  7.92s/it]
Task 8, Epoch 12/20 => Loss 0.085, Train_accy 93.17:  55%|█████▌    | 11/20 [01:25<01:11,  7.92s/it]
Task 8, Epoch 12/20 => Loss 0.085, Train_accy 93.17:  60%|██████    | 12/20 [01:25<00:57,  7.23s/it]
Task 8, Epoch 13/20 => Loss -0.006, Train_accy 95.62:  60%|██████    | 12/20 [01:31<00:57,  7.23s/it]
Task 8, Epoch 13/20 => Loss -0.006, Train_accy 95.62:  65%|██████▌   | 13/20 [01:31<00:47,  6.77s/it]
Task 8, Epoch 14/20 => Loss 0.026, Train_accy 93.70:  65%|██████▌   | 13/20 [01:37<00:47,  6.77s/it] 
Task 8, Epoch 14/20 => Loss 0.026, Train_accy 93.70:  70%|███████   | 14/20 [01:37<00:38,  6.46s/it]
Task 8, Epoch 15/20 => Loss -0.020, Train_accy 95.80, Test_accy 44.59:  70%|███████   | 14/20 [01:51<00:38,  6.46s/it]
Task 8, Epoch 15/20 => Loss -0.020, Train_accy 95.80, Test_accy 44.59:  75%|███████▌  | 15/20 [01:51<00:44,  8.90s/it]
Task 8, Epoch 16/20 => Loss -0.013, Train_accy 95.45:  75%|███████▌  | 15/20 [01:57<00:44,  8.90s/it]                 
Task 8, Epoch 16/20 => Loss -0.013, Train_accy 95.45:  80%|████████  | 16/20 [01:57<00:31,  7.93s/it]
Task 8, Epoch 17/20 => Loss -0.048, Train_accy 96.15:  80%|████████  | 16/20 [02:03<00:31,  7.93s/it]
Task 8, Epoch 17/20 => Loss -0.048, Train_accy 96.15:  85%|████████▌ | 17/20 [02:03<00:21,  7.26s/it]
Task 8, Epoch 18/20 => Loss -0.018, Train_accy 95.10:  85%|████████▌ | 17/20 [02:09<00:21,  7.26s/it]
Task 8, Epoch 18/20 => Loss -0.018, Train_accy 95.10:  90%|█████████ | 18/20 [02:09<00:13,  6.79s/it]
Task 8, Epoch 19/20 => Loss -0.015, Train_accy 94.75:  90%|█████████ | 18/20 [02:14<00:13,  6.79s/it]
Task 8, Epoch 19/20 => Loss -0.015, Train_accy 94.75:  95%|█████████▌| 19/20 [02:14<00:06,  6.45s/it]
Task 8, Epoch 20/20 => Loss -0.031, Train_accy 95.45, Test_accy 44.66:  95%|█████████▌| 19/20 [02:29<00:06,  6.45s/it]
Task 8, Epoch 20/20 => Loss -0.031, Train_accy 95.45, Test_accy 44.66: 100%|██████████| 20/20 [02:29<00:00,  8.86s/it]
Task 8, Epoch 20/20 => Loss -0.031, Train_accy 95.45, Test_accy 44.66: 100%|██████████| 20/20 [02:29<00:00,  7.46s/it]
2024-09-07 11:07:00,557 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.031, Train_accy 95.45, Test_accy 44.66
2024-09-07 11:07:09,398 [trainer.py] => No NME accuracy.
2024-09-07 11:07:09,398 [trainer.py] => CNN: {'total': 44.66, '00-19': 56.0, '20-39': 54.05, '40-59': 50.0, '60-79': 38.29, '80-99': 36.36, '100-119': 42.54, '120-139': 45.21, '140-159': 40.16, '160-179': 38.1, 'old': 45.43, 'new': 38.1}
2024-09-07 11:07:09,399 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98, 51.86, 49.82, 49.03, 48.17, 47.04, 44.66]
2024-09-07 11:07:09,399 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66, 81.38, 78.72, 78.36, 76.54, 75.16, 73.26]

Average Accuracy (CNN): 53.45
2024-09-07 11:07:09,399 [trainer.py] => Average Accuracy (CNN): 53.45 

2024-09-07 11:07:09,402 [trainer.py] => All params: 171970192
2024-09-07 11:07:09,404 [trainer.py] => Trainable params: 199880
2024-09-07 11:07:09,404 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.170, Train_accy 35.86:   0%|          | 0/20 [00:05<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.170, Train_accy 35.86:   5%|▌         | 1/20 [00:05<01:40,  5.27s/it]
Task 9, Epoch 2/20 => Loss 0.694, Train_accy 74.19:   5%|▌         | 1/20 [00:10<01:40,  5.27s/it]
Task 9, Epoch 2/20 => Loss 0.694, Train_accy 74.19:  10%|█         | 2/20 [00:10<01:34,  5.27s/it]
Task 9, Epoch 3/20 => Loss 0.313, Train_accy 87.10:  10%|█         | 2/20 [00:15<01:34,  5.27s/it]
Task 9, Epoch 3/20 => Loss 0.313, Train_accy 87.10:  15%|█▌        | 3/20 [00:15<01:29,  5.25s/it]
Task 9, Epoch 4/20 => Loss 0.188, Train_accy 89.75:  15%|█▌        | 3/20 [00:21<01:29,  5.25s/it]
Task 9, Epoch 4/20 => Loss 0.188, Train_accy 89.75:  20%|██        | 4/20 [00:21<01:23,  5.25s/it]
Task 9, Epoch 5/20 => Loss 0.145, Train_accy 90.70, Test_accy 44.37:  20%|██        | 4/20 [00:35<01:23,  5.25s/it]
Task 9, Epoch 5/20 => Loss 0.145, Train_accy 90.70, Test_accy 44.37:  25%|██▌       | 5/20 [00:35<02:10,  8.70s/it]
Task 9, Epoch 6/20 => Loss 0.122, Train_accy 91.27:  25%|██▌       | 5/20 [00:41<02:10,  8.70s/it]                 
Task 9, Epoch 6/20 => Loss 0.122, Train_accy 91.27:  30%|███       | 6/20 [00:41<01:45,  7.53s/it]
Task 9, Epoch 7/20 => Loss 0.092, Train_accy 93.74:  30%|███       | 6/20 [00:46<01:45,  7.53s/it]
Task 9, Epoch 7/20 => Loss 0.092, Train_accy 93.74:  35%|███▌      | 7/20 [00:46<01:28,  6.80s/it]
Task 9, Epoch 8/20 => Loss 0.053, Train_accy 93.74:  35%|███▌      | 7/20 [00:51<01:28,  6.80s/it]
Task 9, Epoch 8/20 => Loss 0.053, Train_accy 93.74:  40%|████      | 8/20 [00:51<01:15,  6.31s/it]
Task 9, Epoch 9/20 => Loss 0.025, Train_accy 94.31:  40%|████      | 8/20 [00:56<01:15,  6.31s/it]
Task 9, Epoch 9/20 => Loss 0.025, Train_accy 94.31:  45%|████▌     | 9/20 [00:56<01:05,  5.98s/it]
Task 9, Epoch 10/20 => Loss 0.006, Train_accy 94.50, Test_accy 44.11:  45%|████▌     | 9/20 [01:11<01:05,  5.98s/it]
Task 9, Epoch 10/20 => Loss 0.006, Train_accy 94.50, Test_accy 44.11:  50%|█████     | 10/20 [01:11<01:26,  8.69s/it]
Task 9, Epoch 11/20 => Loss -0.036, Train_accy 96.39:  50%|█████     | 10/20 [01:16<01:26,  8.69s/it]                
Task 9, Epoch 11/20 => Loss -0.036, Train_accy 96.39:  55%|█████▌    | 11/20 [01:16<01:08,  7.64s/it]
Task 9, Epoch 12/20 => Loss -0.030, Train_accy 95.45:  55%|█████▌    | 11/20 [01:22<01:08,  7.64s/it]
Task 9, Epoch 12/20 => Loss -0.030, Train_accy 95.45:  60%|██████    | 12/20 [01:22<00:55,  6.92s/it]
Task 9, Epoch 13/20 => Loss -0.032, Train_accy 96.58:  60%|██████    | 12/20 [01:27<00:55,  6.92s/it]
Task 9, Epoch 13/20 => Loss -0.032, Train_accy 96.58:  65%|██████▌   | 13/20 [01:27<00:44,  6.43s/it]
Task 9, Epoch 14/20 => Loss -0.014, Train_accy 95.07:  65%|██████▌   | 13/20 [01:32<00:44,  6.43s/it]
Task 9, Epoch 14/20 => Loss -0.014, Train_accy 95.07:  70%|███████   | 14/20 [01:32<00:36,  6.07s/it]
Task 9, Epoch 15/20 => Loss -0.003, Train_accy 94.88, Test_accy 44.37:  70%|███████   | 14/20 [01:47<00:36,  6.07s/it]
Task 9, Epoch 15/20 => Loss -0.003, Train_accy 94.88, Test_accy 44.37:  75%|███████▌  | 15/20 [01:47<00:43,  8.72s/it]
Task 9, Epoch 16/20 => Loss -0.047, Train_accy 96.77:  75%|███████▌  | 15/20 [01:52<00:43,  8.72s/it]                 
Task 9, Epoch 16/20 => Loss -0.047, Train_accy 96.77:  80%|████████  | 16/20 [01:52<00:30,  7.68s/it]
Task 9, Epoch 17/20 => Loss 0.011, Train_accy 95.26:  80%|████████  | 16/20 [01:58<00:30,  7.68s/it] 
Task 9, Epoch 17/20 => Loss 0.011, Train_accy 95.26:  85%|████████▌ | 17/20 [01:58<00:20,  6.96s/it]
Task 9, Epoch 18/20 => Loss -0.047, Train_accy 96.58:  85%|████████▌ | 17/20 [02:03<00:20,  6.96s/it]
Task 9, Epoch 18/20 => Loss -0.047, Train_accy 96.58:  90%|█████████ | 18/20 [02:03<00:12,  6.45s/it]
Task 9, Epoch 19/20 => Loss -0.042, Train_accy 95.83:  90%|█████████ | 18/20 [02:08<00:12,  6.45s/it]
Task 9, Epoch 19/20 => Loss -0.042, Train_accy 95.83:  95%|█████████▌| 19/20 [02:08<00:06,  6.09s/it]
Task 9, Epoch 20/20 => Loss -0.088, Train_accy 98.10, Test_accy 44.63:  95%|█████████▌| 19/20 [02:23<00:06,  6.09s/it]
Task 9, Epoch 20/20 => Loss -0.088, Train_accy 98.10, Test_accy 44.63: 100%|██████████| 20/20 [02:23<00:00,  8.69s/it]
Task 9, Epoch 20/20 => Loss -0.088, Train_accy 98.10, Test_accy 44.63: 100%|██████████| 20/20 [02:23<00:00,  7.17s/it]
2024-09-07 11:09:32,854 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.088, Train_accy 98.10, Test_accy 44.63
2024-09-07 11:09:42,354 [trainer.py] => No NME accuracy.
2024-09-07 11:09:42,355 [trainer.py] => CNN: {'total': 44.63, '00-19': 56.57, '20-39': 53.51, '40-59': 50.0, '60-79': 38.74, '80-99': 37.06, '100-119': 41.79, '120-139': 43.84, '140-159': 40.16, '160-179': 38.1, '180-199': 45.16, 'old': 44.59, 'new': 45.16}
2024-09-07 11:09:42,355 [trainer.py] => CNN top1 curve: [69.14, 63.33, 57.98, 51.86, 49.82, 49.03, 48.17, 47.04, 44.66, 44.63]
2024-09-07 11:09:42,355 [trainer.py] => CNN top5 curve: [93.71, 89.72, 84.66, 81.38, 78.72, 78.36, 76.54, 75.16, 73.26, 71.82]

Average Accuracy (CNN): 52.57
2024-09-07 11:09:42,355 [trainer.py] => Average Accuracy (CNN): 52.57 

Accuracy Matrix (CNN):
[[69.14 68.   64.57 62.29 61.71 61.71 57.14 57.71 56.   56.57]
 [ 0.   58.92 52.43 54.59 56.76 58.38 57.84 57.3  54.05 53.51]
 [ 0.    0.   56.9  56.03 56.03 56.03 56.03 53.45 50.   50.  ]
 [ 0.    0.    0.   39.19 38.29 38.74 40.54 40.54 38.29 38.74]
 [ 0.    0.    0.    0.   39.16 39.16 41.26 39.16 36.36 37.06]
 [ 0.    0.    0.    0.    0.   41.04 41.79 41.79 42.54 41.79]
 [ 0.    0.    0.    0.    0.    0.   43.15 44.52 45.21 43.84]
 [ 0.    0.    0.    0.    0.    0.    0.   40.16 40.16 40.16]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   38.1  38.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   45.16]]
2024-09-07 11:09:42,358 [trainer.py] => Forgetting (CNN): 3.666666666666666
2024-09-07 11:09:45,111 [trainer.py] => config: ./exps/l2p_ina_B0_Inc20.json
2024-09-07 11:09:45,132 [trainer.py] => prefix:  
2024-09-07 11:09:45,132 [trainer.py] => dataset: imageneta
2024-09-07 11:09:45,132 [trainer.py] => memory_size: 0
2024-09-07 11:09:45,132 [trainer.py] => memory_per_class: 0
2024-09-07 11:09:45,132 [trainer.py] => fixed_memory: False
2024-09-07 11:09:45,132 [trainer.py] => shuffle: True
2024-09-07 11:09:45,132 [trainer.py] => init_cls: 10
2024-09-07 11:09:45,132 [trainer.py] => increment: 10
2024-09-07 11:09:45,132 [trainer.py] => model_name: l2p
2024-09-07 11:09:45,132 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 11:09:45,132 [trainer.py] => get_original_backbone: True
2024-09-07 11:09:45,132 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 11:09:45,132 [trainer.py] => seed: 1993
2024-09-07 11:09:45,132 [trainer.py] => tuned_epoch: 20
2024-09-07 11:09:45,132 [trainer.py] => init_lr: 0.001875
2024-09-07 11:09:45,132 [trainer.py] => batch_size: 48
2024-09-07 11:09:45,133 [trainer.py] => weight_decay: 0
2024-09-07 11:09:45,133 [trainer.py] => min_lr: 1e-05
2024-09-07 11:09:45,133 [trainer.py] => optimizer: adam
2024-09-07 11:09:45,133 [trainer.py] => scheduler: constant
2024-09-07 11:09:45,133 [trainer.py] => reinit_optimizer: True
2024-09-07 11:09:45,133 [trainer.py] => global_pool: token
2024-09-07 11:09:45,133 [trainer.py] => head_type: prompt
2024-09-07 11:09:45,133 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 11:09:45,133 [trainer.py] => pretrained: True
2024-09-07 11:09:45,133 [trainer.py] => drop: 0.0
2024-09-07 11:09:45,133 [trainer.py] => drop_path: 0.0
2024-09-07 11:09:45,133 [trainer.py] => prompt_pool: True
2024-09-07 11:09:45,133 [trainer.py] => size: 10
2024-09-07 11:09:45,133 [trainer.py] => length: 5
2024-09-07 11:09:45,133 [trainer.py] => top_k: 5
2024-09-07 11:09:45,133 [trainer.py] => initializer: uniform
2024-09-07 11:09:45,133 [trainer.py] => prompt_key: True
2024-09-07 11:09:45,133 [trainer.py] => prompt_key_init: uniform
2024-09-07 11:09:45,133 [trainer.py] => use_prompt_mask: False
2024-09-07 11:09:45,133 [trainer.py] => shared_prompt_pool: False
2024-09-07 11:09:45,133 [trainer.py] => shared_prompt_key: False
2024-09-07 11:09:45,133 [trainer.py] => batchwise_prompt: True
2024-09-07 11:09:45,133 [trainer.py] => embedding_key: cls
2024-09-07 11:09:45,134 [trainer.py] => predefined_key: 
2024-09-07 11:09:45,134 [trainer.py] => pull_constraint: True
2024-09-07 11:09:45,134 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 11:09:45,165 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 11:09:46,505 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 11:09:46,506 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 11:09:48,263 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 11:09:48,263 [l2p.py] => 199,880 model training parameters.
2024-09-07 11:09:48,263 [l2p.py] => prompt.prompt: 38400
2024-09-07 11:09:48,263 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 11:09:48,264 [l2p.py] => head.weight: 153600
2024-09-07 11:09:48,264 [l2p.py] => head.bias: 200
2024-09-07 11:09:48,265 [trainer.py] => All params: 171970192
2024-09-07 11:09:48,265 [trainer.py] => Trainable params: 199880
2024-09-07 11:09:48,265 [l2p.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.639, Train_accy 22.92:   0%|          | 0/20 [00:03<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.639, Train_accy 22.92:   5%|▌         | 1/20 [00:03<01:07,  3.55s/it]
Task 0, Epoch 2/20 => Loss 1.575, Train_accy 49.17:   5%|▌         | 1/20 [00:06<01:07,  3.55s/it]
Task 0, Epoch 2/20 => Loss 1.575, Train_accy 49.17:  10%|█         | 2/20 [00:06<00:59,  3.32s/it]
Task 0, Epoch 3/20 => Loss 1.165, Train_accy 64.78:  10%|█         | 2/20 [00:09<00:59,  3.32s/it]
Task 0, Epoch 3/20 => Loss 1.165, Train_accy 64.78:  15%|█▌        | 3/20 [00:09<00:55,  3.27s/it]
Task 0, Epoch 4/20 => Loss 0.769, Train_accy 74.09:  15%|█▌        | 3/20 [00:13<00:55,  3.27s/it]
Task 0, Epoch 4/20 => Loss 0.769, Train_accy 74.09:  20%|██        | 4/20 [00:13<00:51,  3.23s/it]
Task 0, Epoch 5/20 => Loss 0.602, Train_accy 78.74, Test_accy 66.23:  20%|██        | 4/20 [00:17<00:51,  3.23s/it]
Task 0, Epoch 5/20 => Loss 0.602, Train_accy 78.74, Test_accy 66.23:  25%|██▌       | 5/20 [00:17<00:53,  3.59s/it]
Task 0, Epoch 6/20 => Loss 0.589, Train_accy 80.40:  25%|██▌       | 5/20 [00:20<00:53,  3.59s/it]                 
Task 0, Epoch 6/20 => Loss 0.589, Train_accy 80.40:  30%|███       | 6/20 [00:20<00:48,  3.43s/it]
Task 0, Epoch 7/20 => Loss 0.414, Train_accy 87.38:  30%|███       | 6/20 [00:23<00:48,  3.43s/it]
Task 0, Epoch 7/20 => Loss 0.414, Train_accy 87.38:  35%|███▌      | 7/20 [00:23<00:43,  3.34s/it]
Task 0, Epoch 8/20 => Loss 0.415, Train_accy 83.39:  35%|███▌      | 7/20 [00:26<00:43,  3.34s/it]
Task 0, Epoch 8/20 => Loss 0.415, Train_accy 83.39:  40%|████      | 8/20 [00:26<00:39,  3.28s/it]
Task 0, Epoch 9/20 => Loss 0.316, Train_accy 90.03:  40%|████      | 8/20 [00:29<00:39,  3.28s/it]
Task 0, Epoch 9/20 => Loss 0.316, Train_accy 90.03:  45%|████▌     | 9/20 [00:29<00:35,  3.23s/it]
Task 0, Epoch 10/20 => Loss 0.279, Train_accy 90.37, Test_accy 70.13:  45%|████▌     | 9/20 [00:33<00:35,  3.23s/it]
Task 0, Epoch 10/20 => Loss 0.279, Train_accy 90.37, Test_accy 70.13:  50%|█████     | 10/20 [00:33<00:34,  3.49s/it]
Task 0, Epoch 11/20 => Loss 0.299, Train_accy 90.70:  50%|█████     | 10/20 [00:37<00:34,  3.49s/it]                 
Task 0, Epoch 11/20 => Loss 0.299, Train_accy 90.70:  55%|█████▌    | 11/20 [00:37<00:30,  3.38s/it]
Task 0, Epoch 12/20 => Loss 0.225, Train_accy 92.03:  55%|█████▌    | 11/20 [00:40<00:30,  3.38s/it]
Task 0, Epoch 12/20 => Loss 0.225, Train_accy 92.03:  60%|██████    | 12/20 [00:40<00:26,  3.35s/it]
Task 0, Epoch 13/20 => Loss 0.218, Train_accy 94.68:  60%|██████    | 12/20 [00:43<00:26,  3.35s/it]
Task 0, Epoch 13/20 => Loss 0.218, Train_accy 94.68:  65%|██████▌   | 13/20 [00:43<00:23,  3.30s/it]
Task 0, Epoch 14/20 => Loss 0.175, Train_accy 92.69:  65%|██████▌   | 13/20 [00:46<00:23,  3.30s/it]
Task 0, Epoch 14/20 => Loss 0.175, Train_accy 92.69:  70%|███████   | 14/20 [00:46<00:19,  3.25s/it]
Task 0, Epoch 15/20 => Loss 0.184, Train_accy 95.35, Test_accy 76.62:  70%|███████   | 14/20 [00:50<00:19,  3.25s/it]
Task 0, Epoch 15/20 => Loss 0.184, Train_accy 95.35, Test_accy 76.62:  75%|███████▌  | 15/20 [00:50<00:17,  3.51s/it]
Task 0, Epoch 16/20 => Loss 0.108, Train_accy 97.67:  75%|███████▌  | 15/20 [00:53<00:17,  3.51s/it]                 
Task 0, Epoch 16/20 => Loss 0.108, Train_accy 97.67:  80%|████████  | 16/20 [00:53<00:13,  3.40s/it]
Task 0, Epoch 17/20 => Loss 0.128, Train_accy 95.35:  80%|████████  | 16/20 [00:57<00:13,  3.40s/it]
Task 0, Epoch 17/20 => Loss 0.128, Train_accy 95.35:  85%|████████▌ | 17/20 [00:57<00:09,  3.33s/it]
Task 0, Epoch 18/20 => Loss 0.150, Train_accy 94.35:  85%|████████▌ | 17/20 [01:00<00:09,  3.33s/it]
Task 0, Epoch 18/20 => Loss 0.150, Train_accy 94.35:  90%|█████████ | 18/20 [01:00<00:06,  3.27s/it]
Task 0, Epoch 19/20 => Loss 0.164, Train_accy 95.35:  90%|█████████ | 18/20 [01:03<00:06,  3.27s/it]
Task 0, Epoch 19/20 => Loss 0.164, Train_accy 95.35:  95%|█████████▌| 19/20 [01:03<00:03,  3.27s/it]
Task 0, Epoch 20/20 => Loss 0.170, Train_accy 92.36, Test_accy 71.43:  95%|█████████▌| 19/20 [01:07<00:03,  3.27s/it]
Task 0, Epoch 20/20 => Loss 0.170, Train_accy 92.36, Test_accy 71.43: 100%|██████████| 20/20 [01:07<00:00,  3.53s/it]
Task 0, Epoch 20/20 => Loss 0.170, Train_accy 92.36, Test_accy 71.43: 100%|██████████| 20/20 [01:07<00:00,  3.38s/it]
2024-09-07 11:10:56,463 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.170, Train_accy 92.36, Test_accy 71.43
2024-09-07 11:10:57,380 [trainer.py] => No NME accuracy.
2024-09-07 11:10:57,380 [trainer.py] => CNN: {'total': 71.43, '00-09': 71.43, 'old': 0, 'new': 71.43}
2024-09-07 11:10:57,380 [trainer.py] => CNN top1 curve: [71.43]
2024-09-07 11:10:57,380 [trainer.py] => CNN top5 curve: [89.61]

Average Accuracy (CNN): 71.43
2024-09-07 11:10:57,380 [trainer.py] => Average Accuracy (CNN): 71.43 

2024-09-07 11:10:57,381 [trainer.py] => All params: 171970192
2024-09-07 11:10:57,383 [trainer.py] => Trainable params: 199880
2024-09-07 11:10:57,383 [l2p.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.977, Train_accy 36.88:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.977, Train_accy 36.88:   5%|▌         | 1/20 [00:04<01:17,  4.09s/it]
Task 1, Epoch 2/20 => Loss 0.823, Train_accy 68.07:   5%|▌         | 1/20 [00:08<01:17,  4.09s/it]
Task 1, Epoch 2/20 => Loss 0.823, Train_accy 68.07:  10%|█         | 2/20 [00:08<01:15,  4.18s/it]
Task 1, Epoch 3/20 => Loss 0.524, Train_accy 80.69:  10%|█         | 2/20 [00:12<01:15,  4.18s/it]
Task 1, Epoch 3/20 => Loss 0.524, Train_accy 80.69:  15%|█▌        | 3/20 [00:12<01:10,  4.16s/it]
Task 1, Epoch 4/20 => Loss 0.388, Train_accy 85.89:  15%|█▌        | 3/20 [00:16<01:10,  4.16s/it]
Task 1, Epoch 4/20 => Loss 0.388, Train_accy 85.89:  20%|██        | 4/20 [00:16<01:06,  4.17s/it]
Task 1, Epoch 5/20 => Loss 0.283, Train_accy 89.60, Test_accy 49.14:  20%|██        | 4/20 [00:22<01:06,  4.17s/it]
Task 1, Epoch 5/20 => Loss 0.283, Train_accy 89.60, Test_accy 49.14:  25%|██▌       | 5/20 [00:22<01:10,  4.73s/it]
Task 1, Epoch 6/20 => Loss 0.261, Train_accy 90.35:  25%|██▌       | 5/20 [00:26<01:10,  4.73s/it]                 
Task 1, Epoch 6/20 => Loss 0.261, Train_accy 90.35:  30%|███       | 6/20 [00:26<01:03,  4.52s/it]
Task 1, Epoch 7/20 => Loss 0.190, Train_accy 92.57:  30%|███       | 6/20 [00:30<01:03,  4.52s/it]
Task 1, Epoch 7/20 => Loss 0.190, Train_accy 92.57:  35%|███▌      | 7/20 [00:30<00:57,  4.39s/it]
Task 1, Epoch 8/20 => Loss 0.159, Train_accy 92.57:  35%|███▌      | 7/20 [00:34<00:57,  4.39s/it]
Task 1, Epoch 8/20 => Loss 0.159, Train_accy 92.57:  40%|████      | 8/20 [00:34<00:51,  4.30s/it]
Task 1, Epoch 9/20 => Loss 0.157, Train_accy 93.56:  40%|████      | 8/20 [00:38<00:51,  4.30s/it]
Task 1, Epoch 9/20 => Loss 0.157, Train_accy 93.56:  45%|████▌     | 9/20 [00:38<00:46,  4.26s/it]
Task 1, Epoch 10/20 => Loss 0.143, Train_accy 93.32, Test_accy 54.86:  45%|████▌     | 9/20 [00:44<00:46,  4.26s/it]
Task 1, Epoch 10/20 => Loss 0.143, Train_accy 93.32, Test_accy 54.86:  50%|█████     | 10/20 [00:44<00:47,  4.73s/it]
Task 1, Epoch 11/20 => Loss 0.148, Train_accy 92.57:  50%|█████     | 10/20 [00:48<00:47,  4.73s/it]                 
Task 1, Epoch 11/20 => Loss 0.148, Train_accy 92.57:  55%|█████▌    | 11/20 [00:48<00:40,  4.54s/it]
Task 1, Epoch 12/20 => Loss 0.103, Train_accy 94.80:  55%|█████▌    | 11/20 [00:52<00:40,  4.54s/it]
Task 1, Epoch 12/20 => Loss 0.103, Train_accy 94.80:  60%|██████    | 12/20 [00:52<00:35,  4.43s/it]
Task 1, Epoch 13/20 => Loss 0.078, Train_accy 95.79:  60%|██████    | 12/20 [00:57<00:35,  4.43s/it]
Task 1, Epoch 13/20 => Loss 0.078, Train_accy 95.79:  65%|██████▌   | 13/20 [00:57<00:30,  4.34s/it]
Task 1, Epoch 14/20 => Loss 0.093, Train_accy 94.80:  65%|██████▌   | 13/20 [01:01<00:30,  4.34s/it]
Task 1, Epoch 14/20 => Loss 0.093, Train_accy 94.80:  70%|███████   | 14/20 [01:01<00:25,  4.27s/it]
Task 1, Epoch 15/20 => Loss 0.078, Train_accy 96.04, Test_accy 56.00:  70%|███████   | 14/20 [01:06<00:25,  4.27s/it]
Task 1, Epoch 15/20 => Loss 0.078, Train_accy 96.04, Test_accy 56.00:  75%|███████▌  | 15/20 [01:06<00:23,  4.71s/it]
Task 1, Epoch 16/20 => Loss 0.055, Train_accy 95.79:  75%|███████▌  | 15/20 [01:11<00:23,  4.71s/it]                 
Task 1, Epoch 16/20 => Loss 0.055, Train_accy 95.79:  80%|████████  | 16/20 [01:11<00:18,  4.53s/it]
Task 1, Epoch 17/20 => Loss 0.094, Train_accy 95.05:  80%|████████  | 16/20 [01:15<00:18,  4.53s/it]
Task 1, Epoch 17/20 => Loss 0.094, Train_accy 95.05:  85%|████████▌ | 17/20 [01:15<00:13,  4.42s/it]
Task 1, Epoch 18/20 => Loss 0.036, Train_accy 95.54:  85%|████████▌ | 17/20 [01:19<00:13,  4.42s/it]
Task 1, Epoch 18/20 => Loss 0.036, Train_accy 95.54:  90%|█████████ | 18/20 [01:19<00:08,  4.33s/it]
Task 1, Epoch 19/20 => Loss 0.073, Train_accy 93.32:  90%|█████████ | 18/20 [01:23<00:08,  4.33s/it]
Task 1, Epoch 19/20 => Loss 0.073, Train_accy 93.32:  95%|█████████▌| 19/20 [01:23<00:04,  4.28s/it]
Task 1, Epoch 20/20 => Loss 0.018, Train_accy 96.04, Test_accy 52.57:  95%|█████████▌| 19/20 [01:29<00:04,  4.28s/it]
Task 1, Epoch 20/20 => Loss 0.018, Train_accy 96.04, Test_accy 52.57: 100%|██████████| 20/20 [01:29<00:00,  4.69s/it]
Task 1, Epoch 20/20 => Loss 0.018, Train_accy 96.04, Test_accy 52.57: 100%|██████████| 20/20 [01:29<00:00,  4.46s/it]
2024-09-07 11:12:26,510 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.018, Train_accy 96.04, Test_accy 52.57
2024-09-07 11:12:28,028 [trainer.py] => No NME accuracy.
2024-09-07 11:12:28,028 [trainer.py] => CNN: {'total': 52.57, '00-09': 59.74, '10-19': 46.94, 'old': 59.74, 'new': 46.94}
2024-09-07 11:12:28,028 [trainer.py] => CNN top1 curve: [71.43, 52.57]
2024-09-07 11:12:28,028 [trainer.py] => CNN top5 curve: [89.61, 91.43]

Average Accuracy (CNN): 62.0
2024-09-07 11:12:28,028 [trainer.py] => Average Accuracy (CNN): 62.0 

2024-09-07 11:12:28,029 [trainer.py] => All params: 171970192
2024-09-07 11:12:28,030 [trainer.py] => Trainable params: 199880
2024-09-07 11:12:28,030 [l2p.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.913, Train_accy 36.64:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.913, Train_accy 36.64:   5%|▌         | 1/20 [00:03<01:12,  3.81s/it]
Task 2, Epoch 2/20 => Loss 1.017, Train_accy 64.46:   5%|▌         | 1/20 [00:07<01:12,  3.81s/it]
Task 2, Epoch 2/20 => Loss 1.017, Train_accy 64.46:  10%|█         | 2/20 [00:07<01:08,  3.78s/it]
Task 2, Epoch 3/20 => Loss 0.573, Train_accy 79.61:  10%|█         | 2/20 [00:11<01:08,  3.78s/it]
Task 2, Epoch 3/20 => Loss 0.573, Train_accy 79.61:  15%|█▌        | 3/20 [00:11<01:04,  3.76s/it]
Task 2, Epoch 4/20 => Loss 0.405, Train_accy 83.75:  15%|█▌        | 3/20 [00:15<01:04,  3.76s/it]
Task 2, Epoch 4/20 => Loss 0.405, Train_accy 83.75:  20%|██        | 4/20 [00:15<01:00,  3.76s/it]
Task 2, Epoch 5/20 => Loss 0.404, Train_accy 82.37, Test_accy 44.89:  20%|██        | 4/20 [00:20<01:00,  3.76s/it]
Task 2, Epoch 5/20 => Loss 0.404, Train_accy 82.37, Test_accy 44.89:  25%|██▌       | 5/20 [00:20<01:07,  4.50s/it]
Task 2, Epoch 6/20 => Loss 0.289, Train_accy 86.23:  25%|██▌       | 5/20 [00:24<01:07,  4.50s/it]                 
Task 2, Epoch 6/20 => Loss 0.289, Train_accy 86.23:  30%|███       | 6/20 [00:24<00:59,  4.23s/it]
Task 2, Epoch 7/20 => Loss 0.274, Train_accy 86.50:  30%|███       | 6/20 [00:28<00:59,  4.23s/it]
Task 2, Epoch 7/20 => Loss 0.274, Train_accy 86.50:  35%|███▌      | 7/20 [00:28<00:53,  4.08s/it]
Task 2, Epoch 8/20 => Loss 0.200, Train_accy 89.53:  35%|███▌      | 7/20 [00:32<00:53,  4.08s/it]
Task 2, Epoch 8/20 => Loss 0.200, Train_accy 89.53:  40%|████      | 8/20 [00:32<00:47,  3.96s/it]
Task 2, Epoch 9/20 => Loss 0.179, Train_accy 91.46:  40%|████      | 8/20 [00:35<00:47,  3.96s/it]
Task 2, Epoch 9/20 => Loss 0.179, Train_accy 91.46:  45%|████▌     | 9/20 [00:35<00:42,  3.90s/it]
Task 2, Epoch 10/20 => Loss 0.171, Train_accy 91.74, Test_accy 48.54:  45%|████▌     | 9/20 [00:41<00:42,  3.90s/it]
Task 2, Epoch 10/20 => Loss 0.171, Train_accy 91.74, Test_accy 48.54:  50%|█████     | 10/20 [00:41<00:45,  4.51s/it]
Task 2, Epoch 11/20 => Loss 0.147, Train_accy 92.56:  50%|█████     | 10/20 [00:45<00:45,  4.51s/it]                 
Task 2, Epoch 11/20 => Loss 0.147, Train_accy 92.56:  55%|█████▌    | 11/20 [00:45<00:38,  4.29s/it]
Task 2, Epoch 12/20 => Loss 0.130, Train_accy 93.39:  55%|█████▌    | 11/20 [00:49<00:38,  4.29s/it]
Task 2, Epoch 12/20 => Loss 0.130, Train_accy 93.39:  60%|██████    | 12/20 [00:49<00:32,  4.12s/it]
Task 2, Epoch 13/20 => Loss 0.115, Train_accy 94.21:  60%|██████    | 12/20 [00:52<00:32,  4.12s/it]
Task 2, Epoch 13/20 => Loss 0.115, Train_accy 94.21:  65%|██████▌   | 13/20 [00:52<00:28,  4.01s/it]
Task 2, Epoch 14/20 => Loss 0.088, Train_accy 93.94:  65%|██████▌   | 13/20 [00:56<00:28,  4.01s/it]
Task 2, Epoch 14/20 => Loss 0.088, Train_accy 93.94:  70%|███████   | 14/20 [00:56<00:23,  3.93s/it]
Task 2, Epoch 15/20 => Loss 0.112, Train_accy 92.84, Test_accy 50.00:  70%|███████   | 14/20 [01:02<00:23,  3.93s/it]
Task 2, Epoch 15/20 => Loss 0.112, Train_accy 92.84, Test_accy 50.00:  75%|███████▌  | 15/20 [01:02<00:22,  4.51s/it]
Task 2, Epoch 16/20 => Loss 0.086, Train_accy 93.66:  75%|███████▌  | 15/20 [01:06<00:22,  4.51s/it]                 
Task 2, Epoch 16/20 => Loss 0.086, Train_accy 93.66:  80%|████████  | 16/20 [01:06<00:17,  4.31s/it]
Task 2, Epoch 17/20 => Loss 0.107, Train_accy 92.84:  80%|████████  | 16/20 [01:10<00:17,  4.31s/it]
Task 2, Epoch 17/20 => Loss 0.107, Train_accy 92.84:  85%|████████▌ | 17/20 [01:10<00:12,  4.15s/it]
Task 2, Epoch 18/20 => Loss 0.063, Train_accy 94.49:  85%|████████▌ | 17/20 [01:13<00:12,  4.15s/it]
Task 2, Epoch 18/20 => Loss 0.063, Train_accy 94.49:  90%|█████████ | 18/20 [01:13<00:08,  4.03s/it]
Task 2, Epoch 19/20 => Loss 0.024, Train_accy 95.87:  90%|█████████ | 18/20 [01:17<00:08,  4.03s/it]
Task 2, Epoch 19/20 => Loss 0.024, Train_accy 95.87:  95%|█████████▌| 19/20 [01:17<00:03,  3.95s/it]
Task 2, Epoch 20/20 => Loss 0.061, Train_accy 94.21, Test_accy 48.91:  95%|█████████▌| 19/20 [01:23<00:03,  3.95s/it]
Task 2, Epoch 20/20 => Loss 0.061, Train_accy 94.21, Test_accy 48.91: 100%|██████████| 20/20 [01:23<00:00,  4.55s/it]
Task 2, Epoch 20/20 => Loss 0.061, Train_accy 94.21, Test_accy 48.91: 100%|██████████| 20/20 [01:23<00:00,  4.18s/it]
2024-09-07 11:13:51,716 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.061, Train_accy 94.21, Test_accy 48.91
2024-09-07 11:13:53,835 [trainer.py] => No NME accuracy.
2024-09-07 11:13:53,835 [trainer.py] => CNN: {'total': 48.91, '00-09': 61.04, '10-19': 47.96, '20-29': 40.4, 'old': 53.71, 'new': 40.4}
2024-09-07 11:13:53,835 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91]
2024-09-07 11:13:53,835 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13]

Average Accuracy (CNN): 57.64
2024-09-07 11:13:53,835 [trainer.py] => Average Accuracy (CNN): 57.64 

2024-09-07 11:13:53,838 [trainer.py] => All params: 171970192
2024-09-07 11:13:53,840 [trainer.py] => Trainable params: 199880
2024-09-07 11:13:53,840 [l2p.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.962, Train_accy 28.78:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.962, Train_accy 28.78:   5%|▌         | 1/20 [00:04<01:20,  4.22s/it]
Task 3, Epoch 2/20 => Loss 0.723, Train_accy 69.48:   5%|▌         | 1/20 [00:08<01:20,  4.22s/it]
Task 3, Epoch 2/20 => Loss 0.723, Train_accy 69.48:  10%|█         | 2/20 [00:08<01:17,  4.32s/it]
Task 3, Epoch 3/20 => Loss 0.461, Train_accy 82.13:  10%|█         | 2/20 [00:12<01:17,  4.32s/it]
Task 3, Epoch 3/20 => Loss 0.461, Train_accy 82.13:  15%|█▌        | 3/20 [00:12<01:11,  4.22s/it]
Task 3, Epoch 4/20 => Loss 0.358, Train_accy 83.62:  15%|█▌        | 3/20 [00:16<01:11,  4.22s/it]
Task 3, Epoch 4/20 => Loss 0.358, Train_accy 83.62:  20%|██        | 4/20 [00:16<01:06,  4.18s/it]
Task 3, Epoch 5/20 => Loss 0.246, Train_accy 85.86, Test_accy 46.11:  20%|██        | 4/20 [00:23<01:06,  4.18s/it]
Task 3, Epoch 5/20 => Loss 0.246, Train_accy 85.86, Test_accy 46.11:  25%|██▌       | 5/20 [00:23<01:17,  5.17s/it]
Task 3, Epoch 6/20 => Loss 0.211, Train_accy 86.60:  25%|██▌       | 5/20 [00:27<01:17,  5.17s/it]                 
Task 3, Epoch 6/20 => Loss 0.211, Train_accy 86.60:  30%|███       | 6/20 [00:27<01:07,  4.82s/it]
Task 3, Epoch 7/20 => Loss 0.134, Train_accy 91.07:  30%|███       | 6/20 [00:32<01:07,  4.82s/it]
Task 3, Epoch 7/20 => Loss 0.134, Train_accy 91.07:  35%|███▌      | 7/20 [00:32<00:59,  4.61s/it]
Task 3, Epoch 8/20 => Loss 0.202, Train_accy 87.84:  35%|███▌      | 7/20 [00:36<00:59,  4.61s/it]
Task 3, Epoch 8/20 => Loss 0.202, Train_accy 87.84:  40%|████      | 8/20 [00:36<00:53,  4.47s/it]
Task 3, Epoch 9/20 => Loss 0.103, Train_accy 91.81:  40%|████      | 8/20 [00:40<00:53,  4.47s/it]
Task 3, Epoch 9/20 => Loss 0.103, Train_accy 91.81:  45%|████▌     | 9/20 [00:40<00:47,  4.36s/it]
Task 3, Epoch 10/20 => Loss 0.102, Train_accy 90.82, Test_accy 48.89:  45%|████▌     | 9/20 [00:47<00:47,  4.36s/it]
Task 3, Epoch 10/20 => Loss 0.102, Train_accy 90.82, Test_accy 48.89:  50%|█████     | 10/20 [00:47<00:51,  5.10s/it]
Task 3, Epoch 11/20 => Loss 0.080, Train_accy 93.30:  50%|█████     | 10/20 [00:51<00:51,  5.10s/it]                 
Task 3, Epoch 11/20 => Loss 0.080, Train_accy 93.30:  55%|█████▌    | 11/20 [00:51<00:43,  4.80s/it]
Task 3, Epoch 12/20 => Loss 0.183, Train_accy 88.83:  55%|█████▌    | 11/20 [00:55<00:43,  4.80s/it]
Task 3, Epoch 12/20 => Loss 0.183, Train_accy 88.83:  60%|██████    | 12/20 [00:55<00:36,  4.59s/it]
Task 3, Epoch 13/20 => Loss 0.118, Train_accy 91.81:  60%|██████    | 12/20 [00:59<00:36,  4.59s/it]
Task 3, Epoch 13/20 => Loss 0.118, Train_accy 91.81:  65%|██████▌   | 13/20 [00:59<00:31,  4.44s/it]
Task 3, Epoch 14/20 => Loss 0.059, Train_accy 93.05:  65%|██████▌   | 13/20 [01:03<00:31,  4.44s/it]
Task 3, Epoch 14/20 => Loss 0.059, Train_accy 93.05:  70%|███████   | 14/20 [01:03<00:26,  4.34s/it]
Task 3, Epoch 15/20 => Loss 0.021, Train_accy 94.54, Test_accy 50.56:  70%|███████   | 14/20 [01:10<00:26,  4.34s/it]
Task 3, Epoch 15/20 => Loss 0.021, Train_accy 94.54, Test_accy 50.56:  75%|███████▌  | 15/20 [01:10<00:25,  5.08s/it]
Task 3, Epoch 16/20 => Loss 0.029, Train_accy 93.55:  75%|███████▌  | 15/20 [01:14<00:25,  5.08s/it]                 
Task 3, Epoch 16/20 => Loss 0.029, Train_accy 93.55:  80%|████████  | 16/20 [01:14<00:19,  4.79s/it]
Task 3, Epoch 17/20 => Loss 0.002, Train_accy 94.29:  80%|████████  | 16/20 [01:18<00:19,  4.79s/it]
Task 3, Epoch 17/20 => Loss 0.002, Train_accy 94.29:  85%|████████▌ | 17/20 [01:18<00:13,  4.59s/it]
Task 3, Epoch 18/20 => Loss 0.010, Train_accy 95.29:  85%|████████▌ | 17/20 [01:22<00:13,  4.59s/it]
Task 3, Epoch 18/20 => Loss 0.010, Train_accy 95.29:  90%|█████████ | 18/20 [01:22<00:08,  4.44s/it]
Task 3, Epoch 19/20 => Loss -0.029, Train_accy 95.78:  90%|█████████ | 18/20 [01:26<00:08,  4.44s/it]
Task 3, Epoch 19/20 => Loss -0.029, Train_accy 95.78:  95%|█████████▌| 19/20 [01:26<00:04,  4.35s/it]
Task 3, Epoch 20/20 => Loss 0.003, Train_accy 96.03, Test_accy 51.39:  95%|█████████▌| 19/20 [01:33<00:04,  4.35s/it]
Task 3, Epoch 20/20 => Loss 0.003, Train_accy 96.03, Test_accy 51.39: 100%|██████████| 20/20 [01:33<00:00,  5.08s/it]
Task 3, Epoch 20/20 => Loss 0.003, Train_accy 96.03, Test_accy 51.39: 100%|██████████| 20/20 [01:33<00:00,  4.68s/it]
2024-09-07 11:15:27,443 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.003, Train_accy 96.03, Test_accy 51.39
2024-09-07 11:15:30,067 [trainer.py] => No NME accuracy.
2024-09-07 11:15:30,067 [trainer.py] => CNN: {'total': 51.39, '00-09': 62.34, '10-19': 46.94, '20-29': 48.48, '30-39': 50.0, 'old': 51.82, 'new': 50.0}
2024-09-07 11:15:30,067 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39]
2024-09-07 11:15:30,068 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83]

Average Accuracy (CNN): 56.08
2024-09-07 11:15:30,068 [trainer.py] => Average Accuracy (CNN): 56.08 

2024-09-07 11:15:30,069 [trainer.py] => All params: 171970192
2024-09-07 11:15:30,071 [trainer.py] => Trainable params: 199880
2024-09-07 11:15:30,071 [l2p.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.210, Train_accy 31.73:   0%|          | 0/20 [00:02<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.210, Train_accy 31.73:   5%|▌         | 1/20 [00:02<00:54,  2.89s/it]
Task 4, Epoch 2/20 => Loss 0.910, Train_accy 63.47:   5%|▌         | 1/20 [00:05<00:54,  2.89s/it]
Task 4, Epoch 2/20 => Loss 0.910, Train_accy 63.47:  10%|█         | 2/20 [00:05<00:52,  2.90s/it]
Task 4, Epoch 3/20 => Loss 0.352, Train_accy 83.03:  10%|█         | 2/20 [00:08<00:52,  2.90s/it]
Task 4, Epoch 3/20 => Loss 0.352, Train_accy 83.03:  15%|█▌        | 3/20 [00:08<00:49,  2.91s/it]
Task 4, Epoch 4/20 => Loss 0.243, Train_accy 89.30:  15%|█▌        | 3/20 [00:11<00:49,  2.91s/it]
Task 4, Epoch 4/20 => Loss 0.243, Train_accy 89.30:  20%|██        | 4/20 [00:11<00:46,  2.91s/it]
Task 4, Epoch 5/20 => Loss 0.084, Train_accy 91.88, Test_accy 47.41:  20%|██        | 4/20 [00:17<00:46,  2.91s/it]
Task 4, Epoch 5/20 => Loss 0.084, Train_accy 91.88, Test_accy 47.41:  25%|██▌       | 5/20 [00:17<00:59,  3.99s/it]
Task 4, Epoch 6/20 => Loss 0.078, Train_accy 91.14:  25%|██▌       | 5/20 [00:20<00:59,  3.99s/it]                 
Task 4, Epoch 6/20 => Loss 0.078, Train_accy 91.14:  30%|███       | 6/20 [00:20<00:50,  3.62s/it]
Task 4, Epoch 7/20 => Loss 0.049, Train_accy 94.46:  30%|███       | 6/20 [00:23<00:50,  3.62s/it]
Task 4, Epoch 7/20 => Loss 0.049, Train_accy 94.46:  35%|███▌      | 7/20 [00:23<00:44,  3.40s/it]
Task 4, Epoch 8/20 => Loss 0.041, Train_accy 93.73:  35%|███▌      | 7/20 [00:26<00:44,  3.40s/it]
Task 4, Epoch 8/20 => Loss 0.041, Train_accy 93.73:  40%|████      | 8/20 [00:26<00:38,  3.24s/it]
Task 4, Epoch 9/20 => Loss 0.026, Train_accy 93.73:  40%|████      | 8/20 [00:29<00:38,  3.24s/it]
Task 4, Epoch 9/20 => Loss 0.026, Train_accy 93.73:  45%|████▌     | 9/20 [00:29<00:34,  3.15s/it]
Task 4, Epoch 10/20 => Loss 0.004, Train_accy 94.83, Test_accy 48.58:  45%|████▌     | 9/20 [00:35<00:34,  3.15s/it]
Task 4, Epoch 10/20 => Loss 0.004, Train_accy 94.83, Test_accy 48.58:  50%|█████     | 10/20 [00:35<00:39,  3.99s/it]
Task 4, Epoch 11/20 => Loss -0.037, Train_accy 97.05:  50%|█████     | 10/20 [00:37<00:39,  3.99s/it]                
Task 4, Epoch 11/20 => Loss -0.037, Train_accy 97.05:  55%|█████▌    | 11/20 [00:37<00:32,  3.65s/it]
Task 4, Epoch 12/20 => Loss 0.051, Train_accy 92.99:  55%|█████▌    | 11/20 [00:40<00:32,  3.65s/it] 
Task 4, Epoch 12/20 => Loss 0.051, Train_accy 92.99:  60%|██████    | 12/20 [00:40<00:27,  3.42s/it]
Task 4, Epoch 13/20 => Loss -0.019, Train_accy 95.94:  60%|██████    | 12/20 [00:43<00:27,  3.42s/it]
Task 4, Epoch 13/20 => Loss -0.019, Train_accy 95.94:  65%|██████▌   | 13/20 [00:43<00:22,  3.27s/it]
Task 4, Epoch 14/20 => Loss -0.017, Train_accy 94.46:  65%|██████▌   | 13/20 [00:46<00:22,  3.27s/it]
Task 4, Epoch 14/20 => Loss -0.017, Train_accy 94.46:  70%|███████   | 14/20 [00:46<00:18,  3.16s/it]
Task 4, Epoch 15/20 => Loss -0.071, Train_accy 97.79, Test_accy 49.76:  70%|███████   | 14/20 [00:52<00:18,  3.16s/it]
Task 4, Epoch 15/20 => Loss -0.071, Train_accy 97.79, Test_accy 49.76:  75%|███████▌  | 15/20 [00:52<00:19,  3.98s/it]
Task 4, Epoch 16/20 => Loss -0.064, Train_accy 95.94:  75%|███████▌  | 15/20 [00:55<00:19,  3.98s/it]                 
Task 4, Epoch 16/20 => Loss -0.064, Train_accy 95.94:  80%|████████  | 16/20 [00:55<00:14,  3.66s/it]
Task 4, Epoch 17/20 => Loss -0.090, Train_accy 97.05:  80%|████████  | 16/20 [00:58<00:14,  3.66s/it]
Task 4, Epoch 17/20 => Loss -0.090, Train_accy 97.05:  85%|████████▌ | 17/20 [00:58<00:10,  3.44s/it]
Task 4, Epoch 18/20 => Loss -0.098, Train_accy 98.89:  85%|████████▌ | 17/20 [01:01<00:10,  3.44s/it]
Task 4, Epoch 18/20 => Loss -0.098, Train_accy 98.89:  90%|█████████ | 18/20 [01:01<00:06,  3.28s/it]
Task 4, Epoch 19/20 => Loss -0.034, Train_accy 96.31:  90%|█████████ | 18/20 [01:04<00:06,  3.28s/it]
Task 4, Epoch 19/20 => Loss -0.034, Train_accy 96.31:  95%|█████████▌| 19/20 [01:04<00:03,  3.17s/it]
Task 4, Epoch 20/20 => Loss -0.081, Train_accy 97.79, Test_accy 51.65:  95%|█████████▌| 19/20 [01:10<00:03,  3.17s/it]
Task 4, Epoch 20/20 => Loss -0.081, Train_accy 97.79, Test_accy 51.65: 100%|██████████| 20/20 [01:10<00:00,  3.97s/it]
Task 4, Epoch 20/20 => Loss -0.081, Train_accy 97.79, Test_accy 51.65: 100%|██████████| 20/20 [01:10<00:00,  3.50s/it]
2024-09-07 11:16:40,172 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.081, Train_accy 97.79, Test_accy 51.65
2024-09-07 11:16:43,142 [trainer.py] => No NME accuracy.
2024-09-07 11:16:43,142 [trainer.py] => CNN: {'total': 51.65, '00-09': 62.34, '10-19': 51.02, '20-29': 47.47, '30-39': 51.16, '40-49': 46.88, 'old': 52.5, 'new': 46.88}
2024-09-07 11:16:43,142 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65]
2024-09-07 11:16:43,142 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43]

Average Accuracy (CNN): 55.19
2024-09-07 11:16:43,142 [trainer.py] => Average Accuracy (CNN): 55.19 

2024-09-07 11:16:43,144 [trainer.py] => All params: 171970192
2024-09-07 11:16:43,146 [trainer.py] => Trainable params: 199880
2024-09-07 11:16:43,146 [l2p.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.498, Train_accy 27.50:   0%|          | 0/20 [00:02<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.498, Train_accy 27.50:   5%|▌         | 1/20 [00:02<00:49,  2.58s/it]
Task 5, Epoch 2/20 => Loss 0.990, Train_accy 63.33:   5%|▌         | 1/20 [00:05<00:49,  2.58s/it]
Task 5, Epoch 2/20 => Loss 0.990, Train_accy 63.33:  10%|█         | 2/20 [00:05<00:46,  2.60s/it]
Task 5, Epoch 3/20 => Loss 0.402, Train_accy 82.08:  10%|█         | 2/20 [00:07<00:46,  2.60s/it]
Task 5, Epoch 3/20 => Loss 0.402, Train_accy 82.08:  15%|█▌        | 3/20 [00:07<00:44,  2.60s/it]
Task 5, Epoch 4/20 => Loss 0.206, Train_accy 90.00:  15%|█▌        | 3/20 [00:10<00:44,  2.60s/it]
Task 5, Epoch 4/20 => Loss 0.206, Train_accy 90.00:  20%|██        | 4/20 [00:10<00:41,  2.60s/it]
Task 5, Epoch 5/20 => Loss 0.079, Train_accy 91.67, Test_accy 49.37:  20%|██        | 4/20 [00:16<00:41,  2.60s/it]
Task 5, Epoch 5/20 => Loss 0.079, Train_accy 91.67, Test_accy 49.37:  25%|██▌       | 5/20 [00:16<00:56,  3.79s/it]
Task 5, Epoch 6/20 => Loss -0.008, Train_accy 95.42:  25%|██▌       | 5/20 [00:18<00:56,  3.79s/it]                
Task 5, Epoch 6/20 => Loss -0.008, Train_accy 95.42:  30%|███       | 6/20 [00:18<00:47,  3.38s/it]
Task 5, Epoch 7/20 => Loss -0.060, Train_accy 97.50:  30%|███       | 6/20 [00:21<00:47,  3.38s/it]
Task 5, Epoch 7/20 => Loss -0.060, Train_accy 97.50:  35%|███▌      | 7/20 [00:21<00:40,  3.13s/it]
Task 5, Epoch 8/20 => Loss -0.022, Train_accy 93.75:  35%|███▌      | 7/20 [00:24<00:40,  3.13s/it]
Task 5, Epoch 8/20 => Loss -0.022, Train_accy 93.75:  40%|████      | 8/20 [00:24<00:35,  2.96s/it]
Task 5, Epoch 9/20 => Loss -0.074, Train_accy 97.08:  40%|████      | 8/20 [00:26<00:35,  2.96s/it]
Task 5, Epoch 9/20 => Loss -0.074, Train_accy 97.08:  45%|████▌     | 9/20 [00:26<00:31,  2.84s/it]
Task 5, Epoch 10/20 => Loss -0.052, Train_accy 96.67, Test_accy 50.42:  45%|████▌     | 9/20 [00:32<00:31,  2.84s/it]
Task 5, Epoch 10/20 => Loss -0.052, Train_accy 96.67, Test_accy 50.42:  50%|█████     | 10/20 [00:32<00:37,  3.79s/it]
Task 5, Epoch 11/20 => Loss -0.058, Train_accy 95.42:  50%|█████     | 10/20 [00:35<00:37,  3.79s/it]                 
Task 5, Epoch 11/20 => Loss -0.058, Train_accy 95.42:  55%|█████▌    | 11/20 [00:35<00:30,  3.44s/it]
Task 5, Epoch 12/20 => Loss -0.094, Train_accy 97.50:  55%|█████▌    | 11/20 [00:37<00:30,  3.44s/it]
Task 5, Epoch 12/20 => Loss -0.094, Train_accy 97.50:  60%|██████    | 12/20 [00:37<00:25,  3.18s/it]
Task 5, Epoch 13/20 => Loss -0.081, Train_accy 97.08:  60%|██████    | 12/20 [00:40<00:25,  3.18s/it]
Task 5, Epoch 13/20 => Loss -0.081, Train_accy 97.08:  65%|██████▌   | 13/20 [00:40<00:20,  3.00s/it]
Task 5, Epoch 14/20 => Loss -0.116, Train_accy 97.92:  65%|██████▌   | 13/20 [00:42<00:20,  3.00s/it]
Task 5, Epoch 14/20 => Loss -0.116, Train_accy 97.92:  70%|███████   | 14/20 [00:42<00:17,  2.87s/it]
Task 5, Epoch 15/20 => Loss -0.087, Train_accy 97.08, Test_accy 51.47:  70%|███████   | 14/20 [00:48<00:17,  2.87s/it]
Task 5, Epoch 15/20 => Loss -0.087, Train_accy 97.08, Test_accy 51.47:  75%|███████▌  | 15/20 [00:48<00:19,  3.80s/it]
Task 5, Epoch 16/20 => Loss -0.139, Train_accy 98.75:  75%|███████▌  | 15/20 [00:51<00:19,  3.80s/it]                 
Task 5, Epoch 16/20 => Loss -0.139, Train_accy 98.75:  80%|████████  | 16/20 [00:51<00:13,  3.44s/it]
Task 5, Epoch 17/20 => Loss -0.084, Train_accy 96.25:  80%|████████  | 16/20 [00:54<00:13,  3.44s/it]
Task 5, Epoch 17/20 => Loss -0.084, Train_accy 96.25:  85%|████████▌ | 17/20 [00:54<00:09,  3.20s/it]
Task 5, Epoch 18/20 => Loss -0.084, Train_accy 96.67:  85%|████████▌ | 17/20 [00:56<00:09,  3.20s/it]
Task 5, Epoch 18/20 => Loss -0.084, Train_accy 96.67:  90%|█████████ | 18/20 [00:56<00:06,  3.01s/it]
Task 5, Epoch 19/20 => Loss -0.108, Train_accy 97.50:  90%|█████████ | 18/20 [00:59<00:06,  3.01s/it]
Task 5, Epoch 19/20 => Loss -0.108, Train_accy 97.50:  95%|█████████▌| 19/20 [00:59<00:02,  2.89s/it]
Task 5, Epoch 20/20 => Loss -0.074, Train_accy 95.83, Test_accy 51.05:  95%|█████████▌| 19/20 [01:05<00:02,  2.89s/it]
Task 5, Epoch 20/20 => Loss -0.074, Train_accy 95.83, Test_accy 51.05: 100%|██████████| 20/20 [01:05<00:00,  3.81s/it]
Task 5, Epoch 20/20 => Loss -0.074, Train_accy 95.83, Test_accy 51.05: 100%|██████████| 20/20 [01:05<00:00,  3.26s/it]
2024-09-07 11:17:48,449 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.074, Train_accy 95.83, Test_accy 51.05
2024-09-07 11:17:51,758 [trainer.py] => No NME accuracy.
2024-09-07 11:17:51,758 [trainer.py] => CNN: {'total': 51.05, '00-09': 62.34, '10-19': 48.98, '20-29': 48.48, '30-39': 52.33, '40-49': 45.31, '50-59': 48.08, 'old': 51.42, 'new': 48.08}
2024-09-07 11:17:51,759 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05]
2024-09-07 11:17:51,759 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14]

Average Accuracy (CNN): 54.5
2024-09-07 11:17:51,759 [trainer.py] => Average Accuracy (CNN): 54.5 

2024-09-07 11:17:51,761 [trainer.py] => All params: 171970192
2024-09-07 11:17:51,763 [trainer.py] => Trainable params: 199880
2024-09-07 11:17:51,763 [l2p.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.506, Train_accy 45.64:   0%|          | 0/20 [00:04<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.506, Train_accy 45.64:   5%|▌         | 1/20 [00:04<01:25,  4.51s/it]
Task 6, Epoch 2/20 => Loss 0.516, Train_accy 76.38:   5%|▌         | 1/20 [00:08<01:25,  4.51s/it]
Task 6, Epoch 2/20 => Loss 0.516, Train_accy 76.38:  10%|█         | 2/20 [00:08<01:20,  4.49s/it]
Task 6, Epoch 3/20 => Loss 0.304, Train_accy 80.73:  10%|█         | 2/20 [00:13<01:20,  4.49s/it]
Task 6, Epoch 3/20 => Loss 0.304, Train_accy 80.73:  15%|█▌        | 3/20 [00:13<01:16,  4.49s/it]
Task 6, Epoch 4/20 => Loss 0.183, Train_accy 86.47:  15%|█▌        | 3/20 [00:17<01:16,  4.49s/it]
Task 6, Epoch 4/20 => Loss 0.183, Train_accy 86.47:  20%|██        | 4/20 [00:17<01:11,  4.46s/it]
Task 6, Epoch 5/20 => Loss 0.187, Train_accy 93.35, Test_accy 45.85:  20%|██        | 4/20 [00:26<01:11,  4.46s/it]
Task 6, Epoch 5/20 => Loss 0.187, Train_accy 93.35, Test_accy 45.85:  25%|██▌       | 5/20 [00:26<01:29,  5.95s/it]
Task 6, Epoch 6/20 => Loss 0.119, Train_accy 90.83:  25%|██▌       | 5/20 [00:30<01:29,  5.95s/it]                 
Task 6, Epoch 6/20 => Loss 0.119, Train_accy 90.83:  30%|███       | 6/20 [00:30<01:16,  5.43s/it]
Task 6, Epoch 7/20 => Loss 0.054, Train_accy 93.12:  30%|███       | 6/20 [00:35<01:16,  5.43s/it]
Task 6, Epoch 7/20 => Loss 0.054, Train_accy 93.12:  35%|███▌      | 7/20 [00:35<01:06,  5.10s/it]
Task 6, Epoch 8/20 => Loss 0.102, Train_accy 90.83:  35%|███▌      | 7/20 [00:39<01:06,  5.10s/it]
Task 6, Epoch 8/20 => Loss 0.102, Train_accy 90.83:  40%|████      | 8/20 [00:39<00:58,  4.89s/it]
Task 6, Epoch 9/20 => Loss 0.057, Train_accy 93.58:  40%|████      | 8/20 [00:44<00:58,  4.89s/it]
Task 6, Epoch 9/20 => Loss 0.057, Train_accy 93.58:  45%|████▌     | 9/20 [00:44<00:52,  4.75s/it]
Task 6, Epoch 10/20 => Loss 0.038, Train_accy 91.97, Test_accy 46.68:  45%|████▌     | 9/20 [00:52<00:52,  4.75s/it]
Task 6, Epoch 10/20 => Loss 0.038, Train_accy 91.97, Test_accy 46.68:  50%|█████     | 10/20 [00:52<00:58,  5.88s/it]
Task 6, Epoch 11/20 => Loss -0.006, Train_accy 93.35:  50%|█████     | 10/20 [00:56<00:58,  5.88s/it]                
Task 6, Epoch 11/20 => Loss -0.006, Train_accy 93.35:  55%|█████▌    | 11/20 [00:56<00:48,  5.42s/it]
Task 6, Epoch 12/20 => Loss -0.009, Train_accy 94.50:  55%|█████▌    | 11/20 [01:01<00:48,  5.42s/it]
Task 6, Epoch 12/20 => Loss -0.009, Train_accy 94.50:  60%|██████    | 12/20 [01:01<00:41,  5.13s/it]
Task 6, Epoch 13/20 => Loss -0.003, Train_accy 94.27:  60%|██████    | 12/20 [01:05<00:41,  5.13s/it]
Task 6, Epoch 13/20 => Loss -0.003, Train_accy 94.27:  65%|██████▌   | 13/20 [01:05<00:34,  4.90s/it]
Task 6, Epoch 14/20 => Loss -0.047, Train_accy 95.64:  65%|██████▌   | 13/20 [01:10<00:34,  4.90s/it]
Task 6, Epoch 14/20 => Loss -0.047, Train_accy 95.64:  70%|███████   | 14/20 [01:10<00:28,  4.75s/it]
Task 6, Epoch 15/20 => Loss -0.043, Train_accy 94.04, Test_accy 47.01:  70%|███████   | 14/20 [01:18<00:28,  4.75s/it]
Task 6, Epoch 15/20 => Loss -0.043, Train_accy 94.04, Test_accy 47.01:  75%|███████▌  | 15/20 [01:18<00:29,  5.88s/it]
Task 6, Epoch 16/20 => Loss -0.058, Train_accy 95.64:  75%|███████▌  | 15/20 [01:23<00:29,  5.88s/it]                 
Task 6, Epoch 16/20 => Loss -0.058, Train_accy 95.64:  80%|████████  | 16/20 [01:23<00:21,  5.45s/it]
Task 6, Epoch 17/20 => Loss -0.055, Train_accy 96.33:  80%|████████  | 16/20 [01:27<00:21,  5.45s/it]
Task 6, Epoch 17/20 => Loss -0.055, Train_accy 96.33:  85%|████████▌ | 17/20 [01:27<00:15,  5.14s/it]
Task 6, Epoch 18/20 => Loss -0.024, Train_accy 94.27:  85%|████████▌ | 17/20 [01:32<00:15,  5.14s/it]
Task 6, Epoch 18/20 => Loss -0.024, Train_accy 94.27:  90%|█████████ | 18/20 [01:32<00:09,  4.92s/it]
Task 6, Epoch 19/20 => Loss -0.060, Train_accy 95.18:  90%|█████████ | 18/20 [01:36<00:09,  4.92s/it]
Task 6, Epoch 19/20 => Loss -0.060, Train_accy 95.18:  95%|█████████▌| 19/20 [01:36<00:04,  4.78s/it]
Task 6, Epoch 20/20 => Loss -0.028, Train_accy 95.41, Test_accy 48.34:  95%|█████████▌| 19/20 [01:44<00:04,  4.78s/it]
Task 6, Epoch 20/20 => Loss -0.028, Train_accy 95.41, Test_accy 48.34: 100%|██████████| 20/20 [01:44<00:00,  5.91s/it]
Task 6, Epoch 20/20 => Loss -0.028, Train_accy 95.41, Test_accy 48.34: 100%|██████████| 20/20 [01:44<00:00,  5.25s/it]
2024-09-07 11:19:36,774 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.028, Train_accy 95.41, Test_accy 48.34
2024-09-07 11:19:40,830 [trainer.py] => No NME accuracy.
2024-09-07 11:19:40,830 [trainer.py] => CNN: {'total': 48.34, '00-09': 61.04, '10-19': 50.0, '20-29': 49.49, '30-39': 46.51, '40-49': 40.62, '50-59': 48.08, '60-69': 43.65, 'old': 49.58, 'new': 43.65}
2024-09-07 11:19:40,830 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34]
2024-09-07 11:19:40,830 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9]

Average Accuracy (CNN): 53.62
2024-09-07 11:19:40,831 [trainer.py] => Average Accuracy (CNN): 53.62 

2024-09-07 11:19:40,833 [trainer.py] => All params: 171970192
2024-09-07 11:19:40,836 [trainer.py] => Trainable params: 199880
2024-09-07 11:19:40,836 [l2p.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.412, Train_accy 46.55:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.412, Train_accy 46.55:   5%|▌         | 1/20 [00:03<01:08,  3.61s/it]
Task 7, Epoch 2/20 => Loss 0.364, Train_accy 81.03:   5%|▌         | 1/20 [00:07<01:08,  3.61s/it]
Task 7, Epoch 2/20 => Loss 0.364, Train_accy 81.03:  10%|█         | 2/20 [00:07<01:06,  3.68s/it]
Task 7, Epoch 3/20 => Loss 0.218, Train_accy 86.49:  10%|█         | 2/20 [00:10<01:06,  3.68s/it]
Task 7, Epoch 3/20 => Loss 0.218, Train_accy 86.49:  15%|█▌        | 3/20 [00:10<01:01,  3.64s/it]
Task 7, Epoch 4/20 => Loss 0.114, Train_accy 90.23:  15%|█▌        | 3/20 [00:14<01:01,  3.64s/it]
Task 7, Epoch 4/20 => Loss 0.114, Train_accy 90.23:  20%|██        | 4/20 [00:14<00:57,  3.62s/it]
Task 7, Epoch 5/20 => Loss 0.007, Train_accy 93.39, Test_accy 43.98:  20%|██        | 4/20 [00:22<00:57,  3.62s/it]
Task 7, Epoch 5/20 => Loss 0.007, Train_accy 93.39, Test_accy 43.98:  25%|██▌       | 5/20 [00:22<01:19,  5.28s/it]
Task 7, Epoch 6/20 => Loss 0.039, Train_accy 92.82:  25%|██▌       | 5/20 [00:26<01:19,  5.28s/it]                 
Task 7, Epoch 6/20 => Loss 0.039, Train_accy 92.82:  30%|███       | 6/20 [00:26<01:06,  4.72s/it]
Task 7, Epoch 7/20 => Loss -0.014, Train_accy 93.97:  30%|███       | 6/20 [00:29<01:06,  4.72s/it]
Task 7, Epoch 7/20 => Loss -0.014, Train_accy 93.97:  35%|███▌      | 7/20 [00:29<00:56,  4.35s/it]
Task 7, Epoch 8/20 => Loss -0.009, Train_accy 95.40:  35%|███▌      | 7/20 [00:33<00:56,  4.35s/it]
Task 7, Epoch 8/20 => Loss -0.009, Train_accy 95.40:  40%|████      | 8/20 [00:33<00:49,  4.11s/it]
Task 7, Epoch 9/20 => Loss -0.019, Train_accy 94.83:  40%|████      | 8/20 [00:37<00:49,  4.11s/it]
Task 7, Epoch 9/20 => Loss -0.019, Train_accy 94.83:  45%|████▌     | 9/20 [00:37<00:43,  3.95s/it]
Task 7, Epoch 10/20 => Loss -0.024, Train_accy 95.11, Test_accy 44.56:  45%|████▌     | 9/20 [00:45<00:43,  3.95s/it]
Task 7, Epoch 10/20 => Loss -0.024, Train_accy 95.11, Test_accy 44.56:  50%|█████     | 10/20 [00:45<00:52,  5.27s/it]
Task 7, Epoch 11/20 => Loss -0.023, Train_accy 94.54:  50%|█████     | 10/20 [00:49<00:52,  5.27s/it]                 
Task 7, Epoch 11/20 => Loss -0.023, Train_accy 94.54:  55%|█████▌    | 11/20 [00:49<00:42,  4.77s/it]
Task 7, Epoch 12/20 => Loss -0.072, Train_accy 96.55:  55%|█████▌    | 11/20 [00:52<00:42,  4.77s/it]
Task 7, Epoch 12/20 => Loss -0.072, Train_accy 96.55:  60%|██████    | 12/20 [00:52<00:35,  4.42s/it]
Task 7, Epoch 13/20 => Loss -0.057, Train_accy 97.41:  60%|██████    | 12/20 [00:56<00:35,  4.42s/it]
Task 7, Epoch 13/20 => Loss -0.057, Train_accy 97.41:  65%|██████▌   | 13/20 [00:56<00:29,  4.18s/it]
Task 7, Epoch 14/20 => Loss 0.038, Train_accy 93.68:  65%|██████▌   | 13/20 [00:59<00:29,  4.18s/it] 
Task 7, Epoch 14/20 => Loss 0.038, Train_accy 93.68:  70%|███████   | 14/20 [00:59<00:24,  4.02s/it]
Task 7, Epoch 15/20 => Loss -0.033, Train_accy 96.55, Test_accy 45.56:  70%|███████   | 14/20 [01:08<00:24,  4.02s/it]
Task 7, Epoch 15/20 => Loss -0.033, Train_accy 96.55, Test_accy 45.56:  75%|███████▌  | 15/20 [01:08<00:26,  5.29s/it]
Task 7, Epoch 16/20 => Loss -0.065, Train_accy 95.98:  75%|███████▌  | 15/20 [01:11<00:26,  5.29s/it]                 
Task 7, Epoch 16/20 => Loss -0.065, Train_accy 95.98:  80%|████████  | 16/20 [01:11<00:19,  4.79s/it]
Task 7, Epoch 17/20 => Loss -0.042, Train_accy 94.83:  80%|████████  | 16/20 [01:15<00:19,  4.79s/it]
Task 7, Epoch 17/20 => Loss -0.042, Train_accy 94.83:  85%|████████▌ | 17/20 [01:15<00:13,  4.43s/it]
Task 7, Epoch 18/20 => Loss -0.064, Train_accy 95.40:  85%|████████▌ | 17/20 [01:19<00:13,  4.43s/it]
Task 7, Epoch 18/20 => Loss -0.064, Train_accy 95.40:  90%|█████████ | 18/20 [01:19<00:08,  4.19s/it]
Task 7, Epoch 19/20 => Loss -0.019, Train_accy 95.98:  90%|█████████ | 18/20 [01:22<00:08,  4.19s/it]
Task 7, Epoch 19/20 => Loss -0.019, Train_accy 95.98:  95%|█████████▌| 19/20 [01:22<00:04,  4.01s/it]
Task 7, Epoch 20/20 => Loss -0.111, Train_accy 98.28, Test_accy 45.70:  95%|█████████▌| 19/20 [01:30<00:04,  4.01s/it]
Task 7, Epoch 20/20 => Loss -0.111, Train_accy 98.28, Test_accy 45.70: 100%|██████████| 20/20 [01:30<00:00,  5.28s/it]
Task 7, Epoch 20/20 => Loss -0.111, Train_accy 98.28, Test_accy 45.70: 100%|██████████| 20/20 [01:30<00:00,  4.54s/it]
2024-09-07 11:21:11,679 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.111, Train_accy 98.28, Test_accy 45.70
2024-09-07 11:21:16,305 [trainer.py] => No NME accuracy.
2024-09-07 11:21:16,305 [trainer.py] => CNN: {'total': 45.7, '00-09': 59.74, '10-19': 48.98, '20-29': 47.47, '30-39': 47.67, '40-49': 43.75, '50-59': 46.15, '60-69': 42.86, '70-79': 32.29, 'old': 47.84, 'new': 32.29}
2024-09-07 11:21:16,305 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7]
2024-09-07 11:21:16,305 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94]

Average Accuracy (CNN): 52.63
2024-09-07 11:21:16,306 [trainer.py] => Average Accuracy (CNN): 52.63 

2024-09-07 11:21:16,308 [trainer.py] => All params: 171970192
2024-09-07 11:21:16,310 [trainer.py] => Trainable params: 199880
2024-09-07 11:21:16,310 [l2p.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.267, Train_accy 47.40:   0%|          | 0/20 [00:03<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.267, Train_accy 47.40:   5%|▌         | 1/20 [00:03<00:59,  3.13s/it]
Task 8, Epoch 2/20 => Loss 0.312, Train_accy 81.66:   5%|▌         | 1/20 [00:06<00:59,  3.13s/it]
Task 8, Epoch 2/20 => Loss 0.312, Train_accy 81.66:  10%|█         | 2/20 [00:06<00:56,  3.11s/it]
Task 8, Epoch 3/20 => Loss 0.070, Train_accy 91.00:  10%|█         | 2/20 [00:09<00:56,  3.11s/it]
Task 8, Epoch 3/20 => Loss 0.070, Train_accy 91.00:  15%|█▌        | 3/20 [00:09<00:52,  3.10s/it]
Task 8, Epoch 4/20 => Loss 0.031, Train_accy 91.35:  15%|█▌        | 3/20 [00:12<00:52,  3.10s/it]
Task 8, Epoch 4/20 => Loss 0.031, Train_accy 91.35:  20%|██        | 4/20 [00:12<00:49,  3.08s/it]
Task 8, Epoch 5/20 => Loss -0.010, Train_accy 93.43, Test_accy 43.26:  20%|██        | 4/20 [00:20<00:49,  3.08s/it]
Task 8, Epoch 5/20 => Loss -0.010, Train_accy 93.43, Test_accy 43.26:  25%|██▌       | 5/20 [00:20<01:13,  4.91s/it]
Task 8, Epoch 6/20 => Loss -0.069, Train_accy 96.19:  25%|██▌       | 5/20 [00:23<01:13,  4.91s/it]                 
Task 8, Epoch 6/20 => Loss -0.069, Train_accy 96.19:  30%|███       | 6/20 [00:23<01:00,  4.30s/it]
Task 8, Epoch 7/20 => Loss -0.047, Train_accy 96.54:  30%|███       | 6/20 [00:26<01:00,  4.30s/it]
Task 8, Epoch 7/20 => Loss -0.047, Train_accy 96.54:  35%|███▌      | 7/20 [00:26<00:50,  3.92s/it]
Task 8, Epoch 8/20 => Loss -0.103, Train_accy 98.27:  35%|███▌      | 7/20 [00:29<00:50,  3.92s/it]
Task 8, Epoch 8/20 => Loss -0.103, Train_accy 98.27:  40%|████      | 8/20 [00:29<00:43,  3.64s/it]
Task 8, Epoch 9/20 => Loss -0.071, Train_accy 96.19:  40%|████      | 8/20 [00:32<00:43,  3.64s/it]
Task 8, Epoch 9/20 => Loss -0.071, Train_accy 96.19:  45%|████▌     | 9/20 [00:32<00:38,  3.47s/it]
Task 8, Epoch 10/20 => Loss -0.101, Train_accy 97.92, Test_accy 44.42:  45%|████▌     | 9/20 [00:41<00:38,  3.47s/it]
Task 8, Epoch 10/20 => Loss -0.101, Train_accy 97.92, Test_accy 44.42:  50%|█████     | 10/20 [00:41<00:49,  4.93s/it]
Task 8, Epoch 11/20 => Loss -0.070, Train_accy 96.19:  50%|█████     | 10/20 [00:44<00:49,  4.93s/it]                 
Task 8, Epoch 11/20 => Loss -0.070, Train_accy 96.19:  55%|█████▌    | 11/20 [00:44<00:39,  4.37s/it]
Task 8, Epoch 12/20 => Loss -0.029, Train_accy 97.58:  55%|█████▌    | 11/20 [00:47<00:39,  4.37s/it]
Task 8, Epoch 12/20 => Loss -0.029, Train_accy 97.58:  60%|██████    | 12/20 [00:47<00:31,  3.98s/it]
Task 8, Epoch 13/20 => Loss -0.068, Train_accy 96.19:  60%|██████    | 12/20 [00:50<00:31,  3.98s/it]
Task 8, Epoch 13/20 => Loss -0.068, Train_accy 96.19:  65%|██████▌   | 13/20 [00:50<00:26,  3.72s/it]
Task 8, Epoch 14/20 => Loss -0.071, Train_accy 95.50:  65%|██████▌   | 13/20 [00:53<00:26,  3.72s/it]
Task 8, Epoch 14/20 => Loss -0.071, Train_accy 95.50:  70%|███████   | 14/20 [00:53<00:21,  3.53s/it]
Task 8, Epoch 15/20 => Loss -0.137, Train_accy 98.62, Test_accy 45.70:  70%|███████   | 14/20 [01:01<00:21,  3.53s/it]
Task 8, Epoch 15/20 => Loss -0.137, Train_accy 98.62, Test_accy 45.70:  75%|███████▌  | 15/20 [01:01<00:24,  4.97s/it]
Task 8, Epoch 16/20 => Loss -0.114, Train_accy 98.27:  75%|███████▌  | 15/20 [01:04<00:24,  4.97s/it]                 
Task 8, Epoch 16/20 => Loss -0.114, Train_accy 98.27:  80%|████████  | 16/20 [01:04<00:17,  4.40s/it]
Task 8, Epoch 17/20 => Loss -0.112, Train_accy 97.23:  80%|████████  | 16/20 [01:08<00:17,  4.40s/it]
Task 8, Epoch 17/20 => Loss -0.112, Train_accy 97.23:  85%|████████▌ | 17/20 [01:08<00:12,  4.02s/it]
Task 8, Epoch 18/20 => Loss -0.125, Train_accy 97.58:  85%|████████▌ | 17/20 [01:11<00:12,  4.02s/it]
Task 8, Epoch 18/20 => Loss -0.125, Train_accy 97.58:  90%|█████████ | 18/20 [01:11<00:07,  3.75s/it]
Task 8, Epoch 19/20 => Loss -0.142, Train_accy 98.27:  90%|█████████ | 18/20 [01:14<00:07,  3.75s/it]
Task 8, Epoch 19/20 => Loss -0.142, Train_accy 98.27:  95%|█████████▌| 19/20 [01:14<00:03,  3.55s/it]
Task 8, Epoch 20/20 => Loss -0.137, Train_accy 98.27, Test_accy 45.70:  95%|█████████▌| 19/20 [01:22<00:03,  3.55s/it]
Task 8, Epoch 20/20 => Loss -0.137, Train_accy 98.27, Test_accy 45.70: 100%|██████████| 20/20 [01:22<00:00,  4.94s/it]
Task 8, Epoch 20/20 => Loss -0.137, Train_accy 98.27, Test_accy 45.70: 100%|██████████| 20/20 [01:22<00:00,  4.12s/it]
2024-09-07 11:22:38,744 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.137, Train_accy 98.27, Test_accy 45.70
2024-09-07 11:22:43,837 [trainer.py] => No NME accuracy.
2024-09-07 11:22:43,837 [trainer.py] => CNN: {'total': 45.7, '00-09': 58.44, '10-19': 46.94, '20-29': 49.49, '30-39': 48.84, '40-49': 42.19, '50-59': 46.15, '60-69': 40.48, '70-79': 32.29, '80-89': 50.62, 'old': 45.13, 'new': 50.62}
2024-09-07 11:22:43,838 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7]
2024-09-07 11:22:43,838 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2]

Average Accuracy (CNN): 51.86
2024-09-07 11:22:43,838 [trainer.py] => Average Accuracy (CNN): 51.86 

2024-09-07 11:22:43,841 [trainer.py] => All params: 171970192
2024-09-07 11:22:43,844 [trainer.py] => Trainable params: 199880
2024-09-07 11:22:43,844 [l2p.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.064, Train_accy 32.34:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.064, Train_accy 32.34:   5%|▌         | 1/20 [00:02<00:48,  2.56s/it]
Task 9, Epoch 2/20 => Loss 0.878, Train_accy 68.94:   5%|▌         | 1/20 [00:05<00:48,  2.56s/it]
Task 9, Epoch 2/20 => Loss 0.878, Train_accy 68.94:  10%|█         | 2/20 [00:05<00:46,  2.57s/it]
Task 9, Epoch 3/20 => Loss 0.370, Train_accy 84.26:  10%|█         | 2/20 [00:07<00:46,  2.57s/it]
Task 9, Epoch 3/20 => Loss 0.370, Train_accy 84.26:  15%|█▌        | 3/20 [00:07<00:43,  2.56s/it]
Task 9, Epoch 4/20 => Loss 0.159, Train_accy 91.06:  15%|█▌        | 3/20 [00:10<00:43,  2.56s/it]
Task 9, Epoch 4/20 => Loss 0.159, Train_accy 91.06:  20%|██        | 4/20 [00:10<00:40,  2.55s/it]
Task 9, Epoch 5/20 => Loss 0.052, Train_accy 92.77, Test_accy 43.64:  20%|██        | 4/20 [00:18<00:40,  2.55s/it]
Task 9, Epoch 5/20 => Loss 0.052, Train_accy 92.77, Test_accy 43.64:  25%|██▌       | 5/20 [00:18<01:08,  4.53s/it]
Task 9, Epoch 6/20 => Loss 0.003, Train_accy 94.04:  25%|██▌       | 5/20 [00:20<01:08,  4.53s/it]                 
Task 9, Epoch 6/20 => Loss 0.003, Train_accy 94.04:  30%|███       | 6/20 [00:20<00:54,  3.88s/it]
Task 9, Epoch 7/20 => Loss -0.036, Train_accy 95.32:  30%|███       | 6/20 [00:23<00:54,  3.88s/it]
Task 9, Epoch 7/20 => Loss -0.036, Train_accy 95.32:  35%|███▌      | 7/20 [00:23<00:44,  3.46s/it]
Task 9, Epoch 8/20 => Loss -0.035, Train_accy 95.74:  35%|███▌      | 7/20 [00:26<00:44,  3.46s/it]
Task 9, Epoch 8/20 => Loss -0.035, Train_accy 95.74:  40%|████      | 8/20 [00:26<00:38,  3.18s/it]
Task 9, Epoch 9/20 => Loss 0.009, Train_accy 94.89:  40%|████      | 8/20 [00:28<00:38,  3.18s/it] 
Task 9, Epoch 9/20 => Loss 0.009, Train_accy 94.89:  45%|████▌     | 9/20 [00:28<00:32,  2.99s/it]
Task 9, Epoch 10/20 => Loss -0.066, Train_accy 97.87, Test_accy 44.23:  45%|████▌     | 9/20 [00:36<00:32,  2.99s/it]
Task 9, Epoch 10/20 => Loss -0.066, Train_accy 97.87, Test_accy 44.23:  50%|█████     | 10/20 [00:36<00:45,  4.54s/it]
Task 9, Epoch 11/20 => Loss -0.025, Train_accy 94.89:  50%|█████     | 10/20 [00:39<00:45,  4.54s/it]                 
Task 9, Epoch 11/20 => Loss -0.025, Train_accy 94.89:  55%|█████▌    | 11/20 [00:39<00:35,  3.95s/it]
Task 9, Epoch 12/20 => Loss -0.069, Train_accy 97.45:  55%|█████▌    | 11/20 [00:41<00:35,  3.95s/it]
Task 9, Epoch 12/20 => Loss -0.069, Train_accy 97.45:  60%|██████    | 12/20 [00:41<00:28,  3.53s/it]
Task 9, Epoch 13/20 => Loss -0.084, Train_accy 97.45:  60%|██████    | 12/20 [00:44<00:28,  3.53s/it]
Task 9, Epoch 13/20 => Loss -0.084, Train_accy 97.45:  65%|██████▌   | 13/20 [00:44<00:22,  3.23s/it]
Task 9, Epoch 14/20 => Loss -0.085, Train_accy 97.45:  65%|██████▌   | 13/20 [00:46<00:22,  3.23s/it]
Task 9, Epoch 14/20 => Loss -0.085, Train_accy 97.45:  70%|███████   | 14/20 [00:46<00:18,  3.03s/it]
Task 9, Epoch 15/20 => Loss -0.039, Train_accy 95.32, Test_accy 44.11:  70%|███████   | 14/20 [00:54<00:18,  3.03s/it]
Task 9, Epoch 15/20 => Loss -0.039, Train_accy 95.32, Test_accy 44.11:  75%|███████▌  | 15/20 [00:54<00:22,  4.55s/it]
Task 9, Epoch 16/20 => Loss -0.083, Train_accy 97.87:  75%|███████▌  | 15/20 [00:57<00:22,  4.55s/it]                 
Task 9, Epoch 16/20 => Loss -0.083, Train_accy 97.87:  80%|████████  | 16/20 [00:57<00:15,  3.96s/it]
Task 9, Epoch 17/20 => Loss -0.098, Train_accy 98.30:  80%|████████  | 16/20 [01:00<00:15,  3.96s/it]
Task 9, Epoch 17/20 => Loss -0.098, Train_accy 98.30:  85%|████████▌ | 17/20 [01:00<00:10,  3.54s/it]
Task 9, Epoch 18/20 => Loss -0.118, Train_accy 97.87:  85%|████████▌ | 17/20 [01:02<00:10,  3.54s/it]
Task 9, Epoch 18/20 => Loss -0.118, Train_accy 97.87:  90%|█████████ | 18/20 [01:02<00:06,  3.25s/it]
Task 9, Epoch 19/20 => Loss -0.092, Train_accy 97.45:  90%|█████████ | 18/20 [01:05<00:06,  3.25s/it]
Task 9, Epoch 19/20 => Loss -0.092, Train_accy 97.45:  95%|█████████▌| 19/20 [01:05<00:03,  3.05s/it]
Task 9, Epoch 20/20 => Loss -0.114, Train_accy 98.30, Test_accy 44.00:  95%|█████████▌| 19/20 [01:13<00:03,  3.05s/it]
Task 9, Epoch 20/20 => Loss -0.114, Train_accy 98.30, Test_accy 44.00: 100%|██████████| 20/20 [01:13<00:00,  4.55s/it]
Task 9, Epoch 20/20 => Loss -0.114, Train_accy 98.30, Test_accy 44.00: 100%|██████████| 20/20 [01:13<00:00,  3.67s/it]
2024-09-07 11:23:57,211 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.114, Train_accy 98.30, Test_accy 44.00
2024-09-07 11:24:02,681 [trainer.py] => No NME accuracy.
2024-09-07 11:24:02,682 [trainer.py] => CNN: {'total': 44.0, '00-09': 57.14, '10-19': 46.94, '20-29': 48.48, '30-39': 46.51, '40-49': 43.75, '50-59': 48.08, '60-69': 40.48, '70-79': 32.29, '80-89': 50.62, '90-99': 25.81, 'old': 45.44, 'new': 25.81}
2024-09-07 11:24:02,682 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0]
2024-09-07 11:24:02,682 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34]

Average Accuracy (CNN): 51.07
2024-09-07 11:24:02,683 [trainer.py] => Average Accuracy (CNN): 51.07 

2024-09-07 11:24:02,685 [trainer.py] => All params: 171970192
2024-09-07 11:24:02,686 [trainer.py] => Trainable params: 199880
2024-09-07 11:24:02,686 [l2p.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.618, Train_accy 45.31:   0%|          | 0/20 [00:02<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.618, Train_accy 45.31:   5%|▌         | 1/20 [00:02<00:51,  2.71s/it]
Task 10, Epoch 2/20 => Loss 0.427, Train_accy 83.27:   5%|▌         | 1/20 [00:05<00:51,  2.71s/it]
Task 10, Epoch 2/20 => Loss 0.427, Train_accy 83.27:  10%|█         | 2/20 [00:05<00:48,  2.71s/it]
Task 10, Epoch 3/20 => Loss 0.216, Train_accy 88.57:  10%|█         | 2/20 [00:08<00:48,  2.71s/it]
Task 10, Epoch 3/20 => Loss 0.216, Train_accy 88.57:  15%|█▌        | 3/20 [00:08<00:45,  2.70s/it]
Task 10, Epoch 4/20 => Loss 0.067, Train_accy 91.43:  15%|█▌        | 3/20 [00:10<00:45,  2.70s/it]
Task 10, Epoch 4/20 => Loss 0.067, Train_accy 91.43:  20%|██        | 4/20 [00:10<00:42,  2.69s/it]
Task 10, Epoch 5/20 => Loss -0.015, Train_accy 94.69, Test_accy 42.73:  20%|██        | 4/20 [00:19<00:42,  2.69s/it]
Task 10, Epoch 5/20 => Loss -0.015, Train_accy 94.69, Test_accy 42.73:  25%|██▌       | 5/20 [00:19<01:11,  4.80s/it]
Task 10, Epoch 6/20 => Loss 0.023, Train_accy 93.47:  25%|██▌       | 5/20 [00:21<01:11,  4.80s/it]                  
Task 10, Epoch 6/20 => Loss 0.023, Train_accy 93.47:  30%|███       | 6/20 [00:21<00:56,  4.06s/it]
Task 10, Epoch 7/20 => Loss -0.043, Train_accy 94.29:  30%|███       | 6/20 [00:24<00:56,  4.06s/it]
Task 10, Epoch 7/20 => Loss -0.043, Train_accy 94.29:  35%|███▌      | 7/20 [00:24<00:46,  3.59s/it]
Task 10, Epoch 8/20 => Loss -0.044, Train_accy 95.92:  35%|███▌      | 7/20 [00:27<00:46,  3.59s/it]
Task 10, Epoch 8/20 => Loss -0.044, Train_accy 95.92:  40%|████      | 8/20 [00:27<00:39,  3.29s/it]
Task 10, Epoch 9/20 => Loss 0.028, Train_accy 95.92:  40%|████      | 8/20 [00:29<00:39,  3.29s/it] 
Task 10, Epoch 9/20 => Loss 0.028, Train_accy 95.92:  45%|████▌     | 9/20 [00:29<00:34,  3.10s/it]
Task 10, Epoch 10/20 => Loss -0.093, Train_accy 97.55, Test_accy 43.17:  45%|████▌     | 9/20 [00:38<00:34,  3.10s/it]
Task 10, Epoch 10/20 => Loss -0.093, Train_accy 97.55, Test_accy 43.17:  50%|█████     | 10/20 [00:38<00:47,  4.75s/it]
Task 10, Epoch 11/20 => Loss -0.083, Train_accy 97.14:  50%|█████     | 10/20 [00:40<00:47,  4.75s/it]                 
Task 10, Epoch 11/20 => Loss -0.083, Train_accy 97.14:  55%|█████▌    | 11/20 [00:40<00:36,  4.10s/it]
Task 10, Epoch 12/20 => Loss -0.104, Train_accy 97.96:  55%|█████▌    | 11/20 [00:43<00:36,  4.10s/it]
Task 10, Epoch 12/20 => Loss -0.104, Train_accy 97.96:  60%|██████    | 12/20 [00:43<00:29,  3.66s/it]
Task 10, Epoch 13/20 => Loss -0.112, Train_accy 97.96:  60%|██████    | 12/20 [00:46<00:29,  3.66s/it]
Task 10, Epoch 13/20 => Loss -0.112, Train_accy 97.96:  65%|██████▌   | 13/20 [00:46<00:23,  3.36s/it]
Task 10, Epoch 14/20 => Loss 0.023, Train_accy 94.29:  65%|██████▌   | 13/20 [00:48<00:23,  3.36s/it] 
Task 10, Epoch 14/20 => Loss 0.023, Train_accy 94.29:  70%|███████   | 14/20 [00:48<00:18,  3.16s/it]
Task 10, Epoch 15/20 => Loss -0.083, Train_accy 97.96, Test_accy 43.06:  70%|███████   | 14/20 [00:57<00:18,  3.16s/it]
Task 10, Epoch 15/20 => Loss -0.083, Train_accy 97.96, Test_accy 43.06:  75%|███████▌  | 15/20 [00:57<00:23,  4.75s/it]
Task 10, Epoch 16/20 => Loss -0.080, Train_accy 95.51:  75%|███████▌  | 15/20 [01:00<00:23,  4.75s/it]                 
Task 10, Epoch 16/20 => Loss -0.080, Train_accy 95.51:  80%|████████  | 16/20 [01:00<00:16,  4.13s/it]
Task 10, Epoch 17/20 => Loss -0.097, Train_accy 96.73:  80%|████████  | 16/20 [01:02<00:16,  4.13s/it]
Task 10, Epoch 17/20 => Loss -0.097, Train_accy 96.73:  85%|████████▌ | 17/20 [01:02<00:11,  3.70s/it]
Task 10, Epoch 18/20 => Loss -0.095, Train_accy 96.33:  85%|████████▌ | 17/20 [01:05<00:11,  3.70s/it]
Task 10, Epoch 18/20 => Loss -0.095, Train_accy 96.33:  90%|█████████ | 18/20 [01:05<00:06,  3.39s/it]
Task 10, Epoch 19/20 => Loss 0.003, Train_accy 93.88:  90%|█████████ | 18/20 [01:08<00:06,  3.39s/it] 
Task 10, Epoch 19/20 => Loss 0.003, Train_accy 93.88:  95%|█████████▌| 19/20 [01:08<00:03,  3.17s/it]
Task 10, Epoch 20/20 => Loss -0.092, Train_accy 97.14, Test_accy 43.51:  95%|█████████▌| 19/20 [01:16<00:03,  3.17s/it]
Task 10, Epoch 20/20 => Loss -0.092, Train_accy 97.14, Test_accy 43.51: 100%|██████████| 20/20 [01:16<00:00,  4.79s/it]
Task 10, Epoch 20/20 => Loss -0.092, Train_accy 97.14, Test_accy 43.51: 100%|██████████| 20/20 [01:16<00:00,  3.83s/it]
2024-09-07 11:25:19,394 [l2p.py] => Task 10, Epoch 20/20 => Loss -0.092, Train_accy 97.14, Test_accy 43.51
2024-09-07 11:25:25,224 [trainer.py] => No NME accuracy.
2024-09-07 11:25:25,224 [trainer.py] => CNN: {'total': 43.51, '00-09': 57.14, '10-19': 43.88, '20-29': 48.48, '30-39': 44.19, '40-49': 42.19, '50-59': 48.08, '60-69': 41.27, '70-79': 31.25, '80-89': 50.62, '90-99': 25.81, '100-109': 46.67, 'old': 43.28, 'new': 46.67}
2024-09-07 11:25:25,225 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51]
2024-09-07 11:25:25,225 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25]

Average Accuracy (CNN): 50.39
2024-09-07 11:25:25,225 [trainer.py] => Average Accuracy (CNN): 50.39 

2024-09-07 11:25:25,227 [trainer.py] => All params: 171970192
2024-09-07 11:25:25,229 [trainer.py] => Trainable params: 199880
2024-09-07 11:25:25,229 [l2p.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.837, Train_accy 41.37:   0%|          | 0/20 [00:02<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.837, Train_accy 41.37:   5%|▌         | 1/20 [00:02<00:56,  2.97s/it]
Task 11, Epoch 2/20 => Loss 0.581, Train_accy 76.98:   5%|▌         | 1/20 [00:05<00:56,  2.97s/it]
Task 11, Epoch 2/20 => Loss 0.581, Train_accy 76.98:  10%|█         | 2/20 [00:05<00:53,  2.96s/it]
Task 11, Epoch 3/20 => Loss 0.222, Train_accy 89.93:  10%|█         | 2/20 [00:08<00:53,  2.96s/it]
Task 11, Epoch 3/20 => Loss 0.222, Train_accy 89.93:  15%|█▌        | 3/20 [00:08<00:50,  2.95s/it]
Task 11, Epoch 4/20 => Loss 0.111, Train_accy 91.01:  15%|█▌        | 3/20 [00:11<00:50,  2.95s/it]
Task 11, Epoch 4/20 => Loss 0.111, Train_accy 91.01:  20%|██        | 4/20 [00:11<00:47,  2.96s/it]
Task 11, Epoch 5/20 => Loss 0.008, Train_accy 94.96, Test_accy 42.36:  20%|██        | 4/20 [00:21<00:47,  2.96s/it]
Task 11, Epoch 5/20 => Loss 0.008, Train_accy 94.96, Test_accy 42.36:  25%|██▌       | 5/20 [00:21<01:18,  5.26s/it]
Task 11, Epoch 6/20 => Loss -0.041, Train_accy 95.68:  25%|██▌       | 5/20 [00:24<01:18,  5.26s/it]                
Task 11, Epoch 6/20 => Loss -0.041, Train_accy 95.68:  30%|███       | 6/20 [00:24<01:02,  4.48s/it]
Task 11, Epoch 7/20 => Loss -0.061, Train_accy 96.40:  30%|███       | 6/20 [00:27<01:02,  4.48s/it]
Task 11, Epoch 7/20 => Loss -0.061, Train_accy 96.40:  35%|███▌      | 7/20 [00:27<00:51,  3.99s/it]
Task 11, Epoch 8/20 => Loss -0.052, Train_accy 95.68:  35%|███▌      | 7/20 [00:30<00:51,  3.99s/it]
Task 11, Epoch 8/20 => Loss -0.052, Train_accy 95.68:  40%|████      | 8/20 [00:30<00:43,  3.66s/it]
Task 11, Epoch 9/20 => Loss -0.015, Train_accy 94.24:  40%|████      | 8/20 [00:33<00:43,  3.66s/it]
Task 11, Epoch 9/20 => Loss -0.015, Train_accy 94.24:  45%|████▌     | 9/20 [00:33<00:37,  3.45s/it]
Task 11, Epoch 10/20 => Loss -0.080, Train_accy 96.04, Test_accy 42.77:  45%|████▌     | 9/20 [00:42<00:37,  3.45s/it]
Task 11, Epoch 10/20 => Loss -0.080, Train_accy 96.04, Test_accy 42.77:  50%|█████     | 10/20 [00:42<00:52,  5.23s/it]
Task 11, Epoch 11/20 => Loss -0.019, Train_accy 94.96:  50%|█████     | 10/20 [00:45<00:52,  5.23s/it]                 
Task 11, Epoch 11/20 => Loss -0.019, Train_accy 94.96:  55%|█████▌    | 11/20 [00:45<00:41,  4.56s/it]
Task 11, Epoch 12/20 => Loss -0.083, Train_accy 98.20:  55%|█████▌    | 11/20 [00:48<00:41,  4.56s/it]
Task 11, Epoch 12/20 => Loss -0.083, Train_accy 98.20:  60%|██████    | 12/20 [00:48<00:32,  4.08s/it]
Task 11, Epoch 13/20 => Loss -0.052, Train_accy 93.88:  60%|██████    | 12/20 [00:51<00:32,  4.08s/it]
Task 11, Epoch 13/20 => Loss -0.052, Train_accy 93.88:  65%|██████▌   | 13/20 [00:51<00:26,  3.75s/it]
Task 11, Epoch 14/20 => Loss -0.109, Train_accy 97.84:  65%|██████▌   | 13/20 [00:54<00:26,  3.75s/it]
Task 11, Epoch 14/20 => Loss -0.109, Train_accy 97.84:  70%|███████   | 14/20 [00:54<00:21,  3.51s/it]
Task 11, Epoch 15/20 => Loss -0.087, Train_accy 96.76, Test_accy 42.77:  70%|███████   | 14/20 [01:03<00:21,  3.51s/it]
Task 11, Epoch 15/20 => Loss -0.087, Train_accy 96.76, Test_accy 42.77:  75%|███████▌  | 15/20 [01:03<00:26,  5.22s/it]
Task 11, Epoch 16/20 => Loss -0.111, Train_accy 98.56:  75%|███████▌  | 15/20 [01:06<00:26,  5.22s/it]                 
Task 11, Epoch 16/20 => Loss -0.111, Train_accy 98.56:  80%|████████  | 16/20 [01:06<00:18,  4.54s/it]
Task 11, Epoch 17/20 => Loss -0.110, Train_accy 97.84:  80%|████████  | 16/20 [01:09<00:18,  4.54s/it]
Task 11, Epoch 17/20 => Loss -0.110, Train_accy 97.84:  85%|████████▌ | 17/20 [01:09<00:12,  4.06s/it]
Task 11, Epoch 18/20 => Loss -0.094, Train_accy 96.76:  85%|████████▌ | 17/20 [01:12<00:12,  4.06s/it]
Task 11, Epoch 18/20 => Loss -0.094, Train_accy 96.76:  90%|█████████ | 18/20 [01:12<00:07,  3.74s/it]
Task 11, Epoch 19/20 => Loss -0.102, Train_accy 98.20:  90%|█████████ | 18/20 [01:15<00:07,  3.74s/it]
Task 11, Epoch 19/20 => Loss -0.102, Train_accy 98.20:  95%|█████████▌| 19/20 [01:15<00:03,  3.50s/it]
Task 11, Epoch 20/20 => Loss -0.118, Train_accy 98.20, Test_accy 42.67:  95%|█████████▌| 19/20 [01:24<00:03,  3.50s/it]
Task 11, Epoch 20/20 => Loss -0.118, Train_accy 98.20, Test_accy 42.67: 100%|██████████| 20/20 [01:24<00:00,  5.21s/it]
Task 11, Epoch 20/20 => Loss -0.118, Train_accy 98.20, Test_accy 42.67: 100%|██████████| 20/20 [01:24<00:00,  4.22s/it]
2024-09-07 11:26:49,733 [l2p.py] => Task 11, Epoch 20/20 => Loss -0.118, Train_accy 98.20, Test_accy 42.67
2024-09-07 11:26:55,986 [trainer.py] => No NME accuracy.
2024-09-07 11:26:55,986 [trainer.py] => CNN: {'total': 42.67, '00-09': 55.84, '10-19': 43.88, '20-29': 47.47, '30-39': 44.19, '40-49': 42.19, '50-59': 46.15, '60-69': 40.48, '70-79': 31.25, '80-89': 49.38, '90-99': 25.81, '100-109': 48.33, '110-119': 37.84, 'old': 43.06, 'new': 37.84}
2024-09-07 11:26:55,987 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67]
2024-09-07 11:26:55,987 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08]

Average Accuracy (CNN): 49.74
2024-09-07 11:26:55,987 [trainer.py] => Average Accuracy (CNN): 49.74 

2024-09-07 11:26:55,990 [trainer.py] => All params: 171970192
2024-09-07 11:26:55,993 [trainer.py] => Trainable params: 199880
2024-09-07 11:26:55,993 [l2p.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.138, Train_accy 26.96:   0%|          | 0/20 [00:02<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.138, Train_accy 26.96:   5%|▌         | 1/20 [00:02<00:47,  2.52s/it]
Task 12, Epoch 2/20 => Loss 0.849, Train_accy 65.65:   5%|▌         | 1/20 [00:05<00:47,  2.52s/it]
Task 12, Epoch 2/20 => Loss 0.849, Train_accy 65.65:  10%|█         | 2/20 [00:05<00:45,  2.53s/it]
Task 12, Epoch 3/20 => Loss 0.391, Train_accy 82.17:  10%|█         | 2/20 [00:07<00:45,  2.53s/it]
Task 12, Epoch 3/20 => Loss 0.391, Train_accy 82.17:  15%|█▌        | 3/20 [00:07<00:42,  2.52s/it]
Task 12, Epoch 4/20 => Loss 0.254, Train_accy 87.39:  15%|█▌        | 3/20 [00:10<00:42,  2.52s/it]
Task 12, Epoch 4/20 => Loss 0.254, Train_accy 87.39:  20%|██        | 4/20 [00:10<00:40,  2.53s/it]
Task 12, Epoch 5/20 => Loss 0.106, Train_accy 91.30, Test_accy 40.77:  20%|██        | 4/20 [00:19<00:40,  2.53s/it]
Task 12, Epoch 5/20 => Loss 0.106, Train_accy 91.30, Test_accy 40.77:  25%|██▌       | 5/20 [00:19<01:13,  4.90s/it]
Task 12, Epoch 6/20 => Loss 0.020, Train_accy 93.48:  25%|██▌       | 5/20 [00:21<01:13,  4.90s/it]                 
Task 12, Epoch 6/20 => Loss 0.020, Train_accy 93.48:  30%|███       | 6/20 [00:21<00:57,  4.09s/it]
Task 12, Epoch 7/20 => Loss 0.001, Train_accy 93.91:  30%|███       | 6/20 [00:24<00:57,  4.09s/it]
Task 12, Epoch 7/20 => Loss 0.001, Train_accy 93.91:  35%|███▌      | 7/20 [00:24<00:46,  3.58s/it]
Task 12, Epoch 8/20 => Loss -0.026, Train_accy 96.96:  35%|███▌      | 7/20 [00:26<00:46,  3.58s/it]
Task 12, Epoch 8/20 => Loss -0.026, Train_accy 96.96:  40%|████      | 8/20 [00:26<00:39,  3.25s/it]
Task 12, Epoch 9/20 => Loss 0.027, Train_accy 94.35:  40%|████      | 8/20 [00:29<00:39,  3.25s/it] 
Task 12, Epoch 9/20 => Loss 0.027, Train_accy 94.35:  45%|████▌     | 9/20 [00:29<00:33,  3.02s/it]
Task 12, Epoch 10/20 => Loss 0.019, Train_accy 94.35, Test_accy 41.55:  45%|████▌     | 9/20 [00:38<00:33,  3.02s/it]
Task 12, Epoch 10/20 => Loss 0.019, Train_accy 94.35, Test_accy 41.55:  50%|█████     | 10/20 [00:38<00:49,  4.91s/it]
Task 12, Epoch 11/20 => Loss 0.008, Train_accy 94.78:  50%|█████     | 10/20 [00:40<00:49,  4.91s/it]                 
Task 12, Epoch 11/20 => Loss 0.008, Train_accy 94.78:  55%|█████▌    | 11/20 [00:40<00:37,  4.17s/it]
Task 12, Epoch 12/20 => Loss -0.056, Train_accy 96.52:  55%|█████▌    | 11/20 [00:43<00:37,  4.17s/it]
Task 12, Epoch 12/20 => Loss -0.056, Train_accy 96.52:  60%|██████    | 12/20 [00:43<00:29,  3.66s/it]
Task 12, Epoch 13/20 => Loss -0.042, Train_accy 95.65:  60%|██████    | 12/20 [00:46<00:29,  3.66s/it]
Task 12, Epoch 13/20 => Loss -0.042, Train_accy 95.65:  65%|██████▌   | 13/20 [00:46<00:23,  3.33s/it]
Task 12, Epoch 14/20 => Loss -0.053, Train_accy 96.52:  65%|██████▌   | 13/20 [00:48<00:23,  3.33s/it]
Task 12, Epoch 14/20 => Loss -0.053, Train_accy 96.52:  70%|███████   | 14/20 [00:48<00:18,  3.08s/it]
Task 12, Epoch 15/20 => Loss -0.087, Train_accy 97.83, Test_accy 41.74:  70%|███████   | 14/20 [00:57<00:18,  3.08s/it]
Task 12, Epoch 15/20 => Loss -0.087, Train_accy 97.83, Test_accy 41.74:  75%|███████▌  | 15/20 [00:57<00:24,  4.90s/it]
Task 12, Epoch 16/20 => Loss -0.044, Train_accy 96.09:  75%|███████▌  | 15/20 [01:00<00:24,  4.90s/it]                 
Task 12, Epoch 16/20 => Loss -0.044, Train_accy 96.09:  80%|████████  | 16/20 [01:00<00:16,  4.19s/it]
Task 12, Epoch 17/20 => Loss -0.046, Train_accy 95.22:  80%|████████  | 16/20 [01:02<00:16,  4.19s/it]
Task 12, Epoch 17/20 => Loss -0.046, Train_accy 95.22:  85%|████████▌ | 17/20 [01:02<00:11,  3.68s/it]
Task 12, Epoch 18/20 => Loss -0.079, Train_accy 96.96:  85%|████████▌ | 17/20 [01:05<00:11,  3.68s/it]
Task 12, Epoch 18/20 => Loss -0.079, Train_accy 96.96:  90%|█████████ | 18/20 [01:05<00:06,  3.33s/it]
Task 12, Epoch 19/20 => Loss -0.074, Train_accy 97.39:  90%|█████████ | 18/20 [01:07<00:06,  3.33s/it]
Task 12, Epoch 19/20 => Loss -0.074, Train_accy 97.39:  95%|█████████▌| 19/20 [01:07<00:03,  3.07s/it]
Task 12, Epoch 20/20 => Loss -0.102, Train_accy 97.83, Test_accy 41.93:  95%|█████████▌| 19/20 [01:16<00:03,  3.07s/it]
Task 12, Epoch 20/20 => Loss -0.102, Train_accy 97.83, Test_accy 41.93: 100%|██████████| 20/20 [01:16<00:00,  4.88s/it]
Task 12, Epoch 20/20 => Loss -0.102, Train_accy 97.83, Test_accy 41.93: 100%|██████████| 20/20 [01:16<00:00,  3.84s/it]
2024-09-07 11:28:12,761 [l2p.py] => Task 12, Epoch 20/20 => Loss -0.102, Train_accy 97.83, Test_accy 41.93
2024-09-07 11:28:19,367 [trainer.py] => No NME accuracy.
2024-09-07 11:28:19,367 [trainer.py] => CNN: {'total': 41.93, '00-09': 53.25, '10-19': 42.86, '20-29': 48.48, '30-39': 44.19, '40-49': 40.62, '50-59': 44.23, '60-69': 38.89, '70-79': 32.29, '80-89': 50.62, '90-99': 24.19, '100-109': 50.0, '110-119': 37.84, '120-129': 36.67, 'old': 42.26, 'new': 36.67}
2024-09-07 11:28:19,368 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93]
2024-09-07 11:28:19,368 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95]

Average Accuracy (CNN): 49.14
2024-09-07 11:28:19,368 [trainer.py] => Average Accuracy (CNN): 49.14 

2024-09-07 11:28:19,370 [trainer.py] => All params: 171970192
2024-09-07 11:28:19,373 [trainer.py] => Trainable params: 199880
2024-09-07 11:28:19,373 [l2p.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.964, Train_accy 28.80:   0%|          | 0/20 [00:03<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.964, Train_accy 28.80:   5%|▌         | 1/20 [00:03<01:01,  3.25s/it]
Task 13, Epoch 2/20 => Loss 0.666, Train_accy 72.49:   5%|▌         | 1/20 [00:06<01:01,  3.25s/it]
Task 13, Epoch 2/20 => Loss 0.666, Train_accy 72.49:  10%|█         | 2/20 [00:06<00:58,  3.25s/it]
Task 13, Epoch 3/20 => Loss 0.240, Train_accy 85.76:  10%|█         | 2/20 [00:09<00:58,  3.25s/it]
Task 13, Epoch 3/20 => Loss 0.240, Train_accy 85.76:  15%|█▌        | 3/20 [00:09<00:55,  3.25s/it]
Task 13, Epoch 4/20 => Loss 0.118, Train_accy 90.94:  15%|█▌        | 3/20 [00:12<00:55,  3.25s/it]
Task 13, Epoch 4/20 => Loss 0.118, Train_accy 90.94:  20%|██        | 4/20 [00:12<00:51,  3.24s/it]
Task 13, Epoch 5/20 => Loss 0.068, Train_accy 90.94, Test_accy 40.59:  20%|██        | 4/20 [00:23<00:51,  3.24s/it]
Task 13, Epoch 5/20 => Loss 0.068, Train_accy 90.94, Test_accy 40.59:  25%|██▌       | 5/20 [00:23<01:27,  5.81s/it]
Task 13, Epoch 6/20 => Loss 0.058, Train_accy 91.26:  25%|██▌       | 5/20 [00:26<01:27,  5.81s/it]                 
Task 13, Epoch 6/20 => Loss 0.058, Train_accy 91.26:  30%|███       | 6/20 [00:26<01:09,  4.94s/it]
Task 13, Epoch 7/20 => Loss 0.059, Train_accy 94.50:  30%|███       | 6/20 [00:29<01:09,  4.94s/it]
Task 13, Epoch 7/20 => Loss 0.059, Train_accy 94.50:  35%|███▌      | 7/20 [00:29<00:57,  4.39s/it]
Task 13, Epoch 8/20 => Loss -0.038, Train_accy 94.17:  35%|███▌      | 7/20 [00:33<00:57,  4.39s/it]
Task 13, Epoch 8/20 => Loss -0.038, Train_accy 94.17:  40%|████      | 8/20 [00:33<00:48,  4.02s/it]
Task 13, Epoch 9/20 => Loss -0.019, Train_accy 95.79:  40%|████      | 8/20 [00:36<00:48,  4.02s/it]
Task 13, Epoch 9/20 => Loss -0.019, Train_accy 95.79:  45%|████▌     | 9/20 [00:36<00:42,  3.82s/it]
Task 13, Epoch 10/20 => Loss -0.064, Train_accy 95.47, Test_accy 40.59:  45%|████▌     | 9/20 [00:46<00:42,  3.82s/it]
Task 13, Epoch 10/20 => Loss -0.064, Train_accy 95.47, Test_accy 40.59:  50%|█████     | 10/20 [00:46<00:58,  5.84s/it]
Task 13, Epoch 11/20 => Loss -0.058, Train_accy 95.47:  50%|█████     | 10/20 [00:50<00:58,  5.84s/it]                 
Task 13, Epoch 11/20 => Loss -0.058, Train_accy 95.47:  55%|█████▌    | 11/20 [00:50<00:45,  5.05s/it]
Task 13, Epoch 12/20 => Loss -0.063, Train_accy 94.82:  55%|█████▌    | 11/20 [00:53<00:45,  5.05s/it]
Task 13, Epoch 12/20 => Loss -0.063, Train_accy 94.82:  60%|██████    | 12/20 [00:53<00:36,  4.52s/it]
Task 13, Epoch 13/20 => Loss -0.064, Train_accy 97.09:  60%|██████    | 12/20 [00:56<00:36,  4.52s/it]
Task 13, Epoch 13/20 => Loss -0.064, Train_accy 97.09:  65%|██████▌   | 13/20 [00:56<00:29,  4.15s/it]
Task 13, Epoch 14/20 => Loss -0.097, Train_accy 97.41:  65%|██████▌   | 13/20 [00:59<00:29,  4.15s/it]
Task 13, Epoch 14/20 => Loss -0.097, Train_accy 97.41:  70%|███████   | 14/20 [00:59<00:23,  3.87s/it]
Task 13, Epoch 15/20 => Loss -0.049, Train_accy 92.88, Test_accy 41.21:  70%|███████   | 14/20 [01:10<00:23,  3.87s/it]
Task 13, Epoch 15/20 => Loss -0.049, Train_accy 92.88, Test_accy 41.21:  75%|███████▌  | 15/20 [01:10<00:29,  5.82s/it]
Task 13, Epoch 16/20 => Loss -0.078, Train_accy 96.76:  75%|███████▌  | 15/20 [01:13<00:29,  5.82s/it]                 
Task 13, Epoch 16/20 => Loss -0.078, Train_accy 96.76:  80%|████████  | 16/20 [01:13<00:20,  5.05s/it]
Task 13, Epoch 17/20 => Loss -0.074, Train_accy 96.12:  80%|████████  | 16/20 [01:16<00:20,  5.05s/it]
Task 13, Epoch 17/20 => Loss -0.074, Train_accy 96.12:  85%|████████▌ | 17/20 [01:16<00:13,  4.51s/it]
Task 13, Epoch 18/20 => Loss -0.089, Train_accy 96.76:  85%|████████▌ | 17/20 [01:20<00:13,  4.51s/it]
Task 13, Epoch 18/20 => Loss -0.089, Train_accy 96.76:  90%|█████████ | 18/20 [01:20<00:08,  4.13s/it]
Task 13, Epoch 19/20 => Loss -0.084, Train_accy 97.73:  90%|█████████ | 18/20 [01:23<00:08,  4.13s/it]
Task 13, Epoch 19/20 => Loss -0.084, Train_accy 97.73:  95%|█████████▌| 19/20 [01:23<00:03,  3.87s/it]
Task 13, Epoch 20/20 => Loss -0.082, Train_accy 96.76, Test_accy 41.39:  95%|█████████▌| 19/20 [01:33<00:03,  3.87s/it]
Task 13, Epoch 20/20 => Loss -0.082, Train_accy 96.76, Test_accy 41.39: 100%|██████████| 20/20 [01:33<00:00,  5.83s/it]
Task 13, Epoch 20/20 => Loss -0.082, Train_accy 96.76, Test_accy 41.39: 100%|██████████| 20/20 [01:33<00:00,  4.68s/it]
2024-09-07 11:29:53,072 [l2p.py] => Task 13, Epoch 20/20 => Loss -0.082, Train_accy 96.76, Test_accy 41.39
2024-09-07 11:30:00,178 [trainer.py] => No NME accuracy.
2024-09-07 11:30:00,179 [trainer.py] => CNN: {'total': 41.39, '00-09': 53.25, '10-19': 39.8, '20-29': 47.47, '30-39': 45.35, '40-49': 40.62, '50-59': 46.15, '60-69': 38.1, '70-79': 34.38, '80-89': 49.38, '90-99': 22.58, '100-109': 48.33, '110-119': 37.84, '120-129': 35.0, '130-139': 40.7, 'old': 41.45, 'new': 40.7}
2024-09-07 11:30:00,179 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93, 41.39]
2024-09-07 11:30:00,179 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95, 73.15]

Average Accuracy (CNN): 48.59
2024-09-07 11:30:00,179 [trainer.py] => Average Accuracy (CNN): 48.59 

2024-09-07 11:30:00,182 [trainer.py] => All params: 171970192
2024-09-07 11:30:00,184 [trainer.py] => Trainable params: 199880
2024-09-07 11:30:00,184 [l2p.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.025, Train_accy 30.79:   0%|          | 0/20 [00:03<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.025, Train_accy 30.79:   5%|▌         | 1/20 [00:03<01:05,  3.43s/it]
Task 14, Epoch 2/20 => Loss 0.686, Train_accy 70.12:   5%|▌         | 1/20 [00:06<01:05,  3.43s/it]
Task 14, Epoch 2/20 => Loss 0.686, Train_accy 70.12:  10%|█         | 2/20 [00:06<01:01,  3.41s/it]
Task 14, Epoch 3/20 => Loss 0.352, Train_accy 83.84:  10%|█         | 2/20 [00:10<01:01,  3.41s/it]
Task 14, Epoch 3/20 => Loss 0.352, Train_accy 83.84:  15%|█▌        | 3/20 [00:10<00:57,  3.40s/it]
Task 14, Epoch 4/20 => Loss 0.195, Train_accy 89.63:  15%|█▌        | 3/20 [00:13<00:57,  3.40s/it]
Task 14, Epoch 4/20 => Loss 0.195, Train_accy 89.63:  20%|██        | 4/20 [00:13<00:54,  3.39s/it]
Task 14, Epoch 5/20 => Loss 0.082, Train_accy 92.07, Test_accy 40.85:  20%|██        | 4/20 [00:24<00:54,  3.39s/it]
Task 14, Epoch 5/20 => Loss 0.082, Train_accy 92.07, Test_accy 40.85:  25%|██▌       | 5/20 [00:24<01:31,  6.11s/it]
Task 14, Epoch 6/20 => Loss 0.041, Train_accy 94.21:  25%|██▌       | 5/20 [00:27<01:31,  6.11s/it]                 
Task 14, Epoch 6/20 => Loss 0.041, Train_accy 94.21:  30%|███       | 6/20 [00:27<01:12,  5.19s/it]
Task 14, Epoch 7/20 => Loss 0.046, Train_accy 93.29:  30%|███       | 6/20 [00:31<01:12,  5.19s/it]
Task 14, Epoch 7/20 => Loss 0.046, Train_accy 93.29:  35%|███▌      | 7/20 [00:31<00:59,  4.60s/it]
Task 14, Epoch 8/20 => Loss -0.008, Train_accy 95.73:  35%|███▌      | 7/20 [00:34<00:59,  4.60s/it]
Task 14, Epoch 8/20 => Loss -0.008, Train_accy 95.73:  40%|████      | 8/20 [00:34<00:50,  4.24s/it]
Task 14, Epoch 9/20 => Loss 0.014, Train_accy 92.99:  40%|████      | 8/20 [00:38<00:50,  4.24s/it] 
Task 14, Epoch 9/20 => Loss 0.014, Train_accy 92.99:  45%|████▌     | 9/20 [00:38<00:43,  3.99s/it]
Task 14, Epoch 10/20 => Loss 0.025, Train_accy 92.99, Test_accy 40.94:  45%|████▌     | 9/20 [00:49<00:43,  3.99s/it]
Task 14, Epoch 10/20 => Loss 0.025, Train_accy 92.99, Test_accy 40.94:  50%|█████     | 10/20 [00:49<01:01,  6.18s/it]
Task 14, Epoch 11/20 => Loss -0.039, Train_accy 96.04:  50%|█████     | 10/20 [00:52<01:01,  6.18s/it]                
Task 14, Epoch 11/20 => Loss -0.039, Train_accy 96.04:  55%|█████▌    | 11/20 [00:52<00:48,  5.34s/it]
Task 14, Epoch 12/20 => Loss -0.051, Train_accy 95.73:  55%|█████▌    | 11/20 [00:56<00:48,  5.34s/it]
Task 14, Epoch 12/20 => Loss -0.051, Train_accy 95.73:  60%|██████    | 12/20 [00:56<00:38,  4.75s/it]
Task 14, Epoch 13/20 => Loss 0.010, Train_accy 93.90:  60%|██████    | 12/20 [00:59<00:38,  4.75s/it] 
Task 14, Epoch 13/20 => Loss 0.010, Train_accy 93.90:  65%|██████▌   | 13/20 [00:59<00:30,  4.34s/it]
Task 14, Epoch 14/20 => Loss -0.066, Train_accy 96.65:  65%|██████▌   | 13/20 [01:02<00:30,  4.34s/it]
Task 14, Epoch 14/20 => Loss -0.066, Train_accy 96.65:  70%|███████   | 14/20 [01:02<00:24,  4.06s/it]
Task 14, Epoch 15/20 => Loss -0.053, Train_accy 96.95, Test_accy 41.60:  70%|███████   | 14/20 [01:13<00:24,  4.06s/it]
Task 14, Epoch 15/20 => Loss -0.053, Train_accy 96.95, Test_accy 41.60:  75%|███████▌  | 15/20 [01:13<00:30,  6.13s/it]
Task 14, Epoch 16/20 => Loss -0.060, Train_accy 95.73:  75%|███████▌  | 15/20 [01:17<00:30,  6.13s/it]                 
Task 14, Epoch 16/20 => Loss -0.060, Train_accy 95.73:  80%|████████  | 16/20 [01:17<00:21,  5.31s/it]
Task 14, Epoch 17/20 => Loss -0.082, Train_accy 97.26:  80%|████████  | 16/20 [01:20<00:21,  5.31s/it]
Task 14, Epoch 17/20 => Loss -0.082, Train_accy 97.26:  85%|████████▌ | 17/20 [01:20<00:14,  4.73s/it]
Task 14, Epoch 18/20 => Loss -0.081, Train_accy 96.65:  85%|████████▌ | 17/20 [01:24<00:14,  4.73s/it]
Task 14, Epoch 18/20 => Loss -0.081, Train_accy 96.65:  90%|█████████ | 18/20 [01:24<00:08,  4.33s/it]
Task 14, Epoch 19/20 => Loss -0.059, Train_accy 96.34:  90%|█████████ | 18/20 [01:27<00:08,  4.33s/it]
Task 14, Epoch 19/20 => Loss -0.059, Train_accy 96.34:  95%|█████████▌| 19/20 [01:27<00:04,  4.05s/it]
Task 14, Epoch 20/20 => Loss -0.068, Train_accy 95.73, Test_accy 41.10:  95%|█████████▌| 19/20 [01:38<00:04,  4.05s/it]
Task 14, Epoch 20/20 => Loss -0.068, Train_accy 95.73, Test_accy 41.10: 100%|██████████| 20/20 [01:38<00:00,  6.10s/it]
Task 14, Epoch 20/20 => Loss -0.068, Train_accy 95.73, Test_accy 41.10: 100%|██████████| 20/20 [01:38<00:00,  4.92s/it]
2024-09-07 11:31:38,556 [l2p.py] => Task 14, Epoch 20/20 => Loss -0.068, Train_accy 95.73, Test_accy 41.10
2024-09-07 11:31:46,089 [trainer.py] => No NME accuracy.
2024-09-07 11:31:46,089 [trainer.py] => CNN: {'total': 41.1, '00-09': 50.65, '10-19': 40.82, '20-29': 46.46, '30-39': 43.02, '40-49': 40.62, '50-59': 46.15, '60-69': 37.3, '70-79': 35.42, '80-89': 49.38, '90-99': 24.19, '100-109': 50.0, '110-119': 40.54, '120-129': 38.33, '130-139': 40.7, '140-149': 34.21, 'old': 41.57, 'new': 34.21}
2024-09-07 11:31:46,089 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93, 41.39, 41.1]
2024-09-07 11:31:46,089 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95, 73.15, 72.26]

Average Accuracy (CNN): 48.09
2024-09-07 11:31:46,090 [trainer.py] => Average Accuracy (CNN): 48.09 

2024-09-07 11:31:46,092 [trainer.py] => All params: 171970192
2024-09-07 11:31:46,093 [trainer.py] => Trainable params: 199880
2024-09-07 11:31:46,093 [l2p.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.000, Train_accy 33.00:   0%|          | 0/20 [00:02<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.000, Train_accy 33.00:   5%|▌         | 1/20 [00:02<00:42,  2.26s/it]
Task 15, Epoch 2/20 => Loss 0.718, Train_accy 72.41:   5%|▌         | 1/20 [00:04<00:42,  2.26s/it]
Task 15, Epoch 2/20 => Loss 0.718, Train_accy 72.41:  10%|█         | 2/20 [00:04<00:40,  2.27s/it]
Task 15, Epoch 3/20 => Loss 0.387, Train_accy 80.79:  10%|█         | 2/20 [00:06<00:40,  2.27s/it]
Task 15, Epoch 3/20 => Loss 0.387, Train_accy 80.79:  15%|█▌        | 3/20 [00:06<00:38,  2.28s/it]
Task 15, Epoch 4/20 => Loss 0.214, Train_accy 90.15:  15%|█▌        | 3/20 [00:09<00:38,  2.28s/it]
Task 15, Epoch 4/20 => Loss 0.214, Train_accy 90.15:  20%|██        | 4/20 [00:09<00:36,  2.30s/it]
Task 15, Epoch 5/20 => Loss 0.053, Train_accy 93.10, Test_accy 40.30:  20%|██        | 4/20 [00:19<00:36,  2.30s/it]
Task 15, Epoch 5/20 => Loss 0.053, Train_accy 93.10, Test_accy 40.30:  25%|██▌       | 5/20 [00:19<01:17,  5.17s/it]
Task 15, Epoch 6/20 => Loss -0.007, Train_accy 95.07:  25%|██▌       | 5/20 [00:21<01:17,  5.17s/it]                
Task 15, Epoch 6/20 => Loss -0.007, Train_accy 95.07:  30%|███       | 6/20 [00:21<00:58,  4.20s/it]
Task 15, Epoch 7/20 => Loss 0.015, Train_accy 94.58:  30%|███       | 6/20 [00:24<00:58,  4.20s/it] 
Task 15, Epoch 7/20 => Loss 0.015, Train_accy 94.58:  35%|███▌      | 7/20 [00:24<00:46,  3.57s/it]
Task 15, Epoch 8/20 => Loss -0.068, Train_accy 96.55:  35%|███▌      | 7/20 [00:26<00:46,  3.57s/it]
Task 15, Epoch 8/20 => Loss -0.068, Train_accy 96.55:  40%|████      | 8/20 [00:26<00:37,  3.16s/it]
Task 15, Epoch 9/20 => Loss -0.028, Train_accy 95.57:  40%|████      | 8/20 [00:28<00:37,  3.16s/it]
Task 15, Epoch 9/20 => Loss -0.028, Train_accy 95.57:  45%|████▌     | 9/20 [00:28<00:31,  2.89s/it]
Task 15, Epoch 10/20 => Loss -0.079, Train_accy 97.04, Test_accy 39.90:  45%|████▌     | 9/20 [00:38<00:31,  2.89s/it]
Task 15, Epoch 10/20 => Loss -0.079, Train_accy 97.04, Test_accy 39.90:  50%|█████     | 10/20 [00:38<00:51,  5.14s/it]
Task 15, Epoch 11/20 => Loss -0.059, Train_accy 97.04:  50%|█████     | 10/20 [00:41<00:51,  5.14s/it]                 
Task 15, Epoch 11/20 => Loss -0.059, Train_accy 97.04:  55%|█████▌    | 11/20 [00:41<00:38,  4.27s/it]
Task 15, Epoch 12/20 => Loss -0.045, Train_accy 97.04:  55%|█████▌    | 11/20 [00:43<00:38,  4.27s/it]
Task 15, Epoch 12/20 => Loss -0.045, Train_accy 97.04:  60%|██████    | 12/20 [00:43<00:29,  3.68s/it]
Task 15, Epoch 13/20 => Loss -0.084, Train_accy 97.04:  60%|██████    | 12/20 [00:45<00:29,  3.68s/it]
Task 15, Epoch 13/20 => Loss -0.084, Train_accy 97.04:  65%|██████▌   | 13/20 [00:45<00:22,  3.26s/it]
Task 15, Epoch 14/20 => Loss -0.090, Train_accy 97.54:  65%|██████▌   | 13/20 [00:47<00:22,  3.26s/it]
Task 15, Epoch 14/20 => Loss -0.090, Train_accy 97.54:  70%|███████   | 14/20 [00:47<00:17,  2.97s/it]
Task 15, Epoch 15/20 => Loss -0.088, Train_accy 96.06, Test_accy 39.90:  70%|███████   | 14/20 [00:58<00:17,  2.97s/it]
Task 15, Epoch 15/20 => Loss -0.088, Train_accy 96.06, Test_accy 39.90:  75%|███████▌  | 15/20 [00:58<00:25,  5.13s/it]
Task 15, Epoch 16/20 => Loss -0.121, Train_accy 97.54:  75%|███████▌  | 15/20 [01:00<00:25,  5.13s/it]                 
Task 15, Epoch 16/20 => Loss -0.121, Train_accy 97.54:  80%|████████  | 16/20 [01:00<00:17,  4.30s/it]
Task 15, Epoch 17/20 => Loss -0.114, Train_accy 98.03:  80%|████████  | 16/20 [01:02<00:17,  4.30s/it]
Task 15, Epoch 17/20 => Loss -0.114, Train_accy 98.03:  85%|████████▌ | 17/20 [01:02<00:11,  3.68s/it]
Task 15, Epoch 18/20 => Loss -0.121, Train_accy 98.52:  85%|████████▌ | 17/20 [01:05<00:11,  3.68s/it]
Task 15, Epoch 18/20 => Loss -0.121, Train_accy 98.52:  90%|█████████ | 18/20 [01:05<00:06,  3.27s/it]
Task 15, Epoch 19/20 => Loss -0.157, Train_accy 100.00:  90%|█████████ | 18/20 [01:07<00:06,  3.27s/it]
Task 15, Epoch 19/20 => Loss -0.157, Train_accy 100.00:  95%|█████████▌| 19/20 [01:07<00:02,  2.97s/it]
Task 15, Epoch 20/20 => Loss -0.121, Train_accy 98.52, Test_accy 39.74:  95%|█████████▌| 19/20 [01:17<00:02,  2.97s/it]
Task 15, Epoch 20/20 => Loss -0.121, Train_accy 98.52, Test_accy 39.74: 100%|██████████| 20/20 [01:17<00:00,  5.12s/it]
Task 15, Epoch 20/20 => Loss -0.121, Train_accy 98.52, Test_accy 39.74: 100%|██████████| 20/20 [01:17<00:00,  3.87s/it]
2024-09-07 11:33:03,539 [l2p.py] => Task 15, Epoch 20/20 => Loss -0.121, Train_accy 98.52, Test_accy 39.74
2024-09-07 11:33:11,439 [trainer.py] => No NME accuracy.
2024-09-07 11:33:11,439 [trainer.py] => CNN: {'total': 39.74, '00-09': 49.35, '10-19': 37.76, '20-29': 46.46, '30-39': 41.86, '40-49': 42.19, '50-59': 46.15, '60-69': 35.71, '70-79': 33.33, '80-89': 50.62, '90-99': 24.19, '100-109': 48.33, '110-119': 39.19, '120-129': 35.0, '130-139': 40.7, '140-149': 34.21, '150-159': 29.41, 'old': 40.18, 'new': 29.41}
2024-09-07 11:33:11,439 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93, 41.39, 41.1, 39.74]
2024-09-07 11:33:11,439 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95, 73.15, 72.26, 71.07]

Average Accuracy (CNN): 47.57
2024-09-07 11:33:11,440 [trainer.py] => Average Accuracy (CNN): 47.57 

2024-09-07 11:33:11,442 [trainer.py] => All params: 171970192
2024-09-07 11:33:11,444 [trainer.py] => Trainable params: 199880
2024-09-07 11:33:11,444 [l2p.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.110, Train_accy 30.84:   0%|          | 0/20 [00:03<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.110, Train_accy 30.84:   5%|▌         | 1/20 [00:03<01:05,  3.46s/it]
Task 16, Epoch 2/20 => Loss 0.747, Train_accy 67.37:   5%|▌         | 1/20 [00:06<01:05,  3.46s/it]
Task 16, Epoch 2/20 => Loss 0.747, Train_accy 67.37:  10%|█         | 2/20 [00:06<01:02,  3.48s/it]
Task 16, Epoch 3/20 => Loss 0.411, Train_accy 80.54:  10%|█         | 2/20 [00:10<01:02,  3.48s/it]
Task 16, Epoch 3/20 => Loss 0.411, Train_accy 80.54:  15%|█▌        | 3/20 [00:10<00:58,  3.46s/it]
Task 16, Epoch 4/20 => Loss 0.178, Train_accy 87.72:  15%|█▌        | 3/20 [00:13<00:58,  3.46s/it]
Task 16, Epoch 4/20 => Loss 0.178, Train_accy 87.72:  20%|██        | 4/20 [00:13<00:55,  3.49s/it]
Task 16, Epoch 5/20 => Loss 0.130, Train_accy 89.82, Test_accy 39.16:  20%|██        | 4/20 [00:25<00:55,  3.49s/it]
Task 16, Epoch 5/20 => Loss 0.130, Train_accy 89.82, Test_accy 39.16:  25%|██▌       | 5/20 [00:25<01:38,  6.54s/it]
Task 16, Epoch 6/20 => Loss 0.088, Train_accy 92.22:  25%|██▌       | 5/20 [00:29<01:38,  6.54s/it]                 
Task 16, Epoch 6/20 => Loss 0.088, Train_accy 92.22:  30%|███       | 6/20 [00:29<01:16,  5.50s/it]
Task 16, Epoch 7/20 => Loss 0.107, Train_accy 88.92:  30%|███       | 6/20 [00:32<01:16,  5.50s/it]
Task 16, Epoch 7/20 => Loss 0.107, Train_accy 88.92:  35%|███▌      | 7/20 [00:32<01:02,  4.83s/it]
Task 16, Epoch 8/20 => Loss 0.063, Train_accy 92.22:  35%|███▌      | 7/20 [00:36<01:02,  4.83s/it]
Task 16, Epoch 8/20 => Loss 0.063, Train_accy 92.22:  40%|████      | 8/20 [00:36<00:52,  4.40s/it]
Task 16, Epoch 9/20 => Loss 0.112, Train_accy 91.02:  40%|████      | 8/20 [00:39<00:52,  4.40s/it]
Task 16, Epoch 9/20 => Loss 0.112, Train_accy 91.02:  45%|████▌     | 9/20 [00:39<00:45,  4.11s/it]
Task 16, Epoch 10/20 => Loss 0.084, Train_accy 90.42, Test_accy 38.71:  45%|████▌     | 9/20 [00:51<00:45,  4.11s/it]
Task 16, Epoch 10/20 => Loss 0.084, Train_accy 90.42, Test_accy 38.71:  50%|█████     | 10/20 [00:51<01:05,  6.52s/it]
Task 16, Epoch 11/20 => Loss 0.004, Train_accy 93.71:  50%|█████     | 10/20 [00:55<01:05,  6.52s/it]                 
Task 16, Epoch 11/20 => Loss 0.004, Train_accy 93.71:  55%|█████▌    | 11/20 [00:55<00:50,  5.60s/it]
Task 16, Epoch 12/20 => Loss -0.011, Train_accy 95.21:  55%|█████▌    | 11/20 [00:58<00:50,  5.60s/it]
Task 16, Epoch 12/20 => Loss -0.011, Train_accy 95.21:  60%|██████    | 12/20 [00:58<00:39,  4.95s/it]
Task 16, Epoch 13/20 => Loss -0.074, Train_accy 96.71:  60%|██████    | 12/20 [01:02<00:39,  4.95s/it]
Task 16, Epoch 13/20 => Loss -0.074, Train_accy 96.71:  65%|██████▌   | 13/20 [01:02<00:31,  4.51s/it]
Task 16, Epoch 14/20 => Loss -0.072, Train_accy 96.71:  65%|██████▌   | 13/20 [01:05<00:31,  4.51s/it]
Task 16, Epoch 14/20 => Loss -0.072, Train_accy 96.71:  70%|███████   | 14/20 [01:05<00:25,  4.21s/it]
Task 16, Epoch 15/20 => Loss -0.035, Train_accy 95.81, Test_accy 38.63:  70%|███████   | 14/20 [01:17<00:25,  4.21s/it]
Task 16, Epoch 15/20 => Loss -0.035, Train_accy 95.81, Test_accy 38.63:  75%|███████▌  | 15/20 [01:17<00:32,  6.52s/it]
Task 16, Epoch 16/20 => Loss -0.009, Train_accy 94.91:  75%|███████▌  | 15/20 [01:21<00:32,  6.52s/it]                 
Task 16, Epoch 16/20 => Loss -0.009, Train_accy 94.91:  80%|████████  | 16/20 [01:21<00:22,  5.61s/it]
Task 16, Epoch 17/20 => Loss -0.060, Train_accy 96.41:  80%|████████  | 16/20 [01:24<00:22,  5.61s/it]
Task 16, Epoch 17/20 => Loss -0.060, Train_accy 96.41:  85%|████████▌ | 17/20 [01:24<00:14,  4.97s/it]
Task 16, Epoch 18/20 => Loss -0.063, Train_accy 95.21:  85%|████████▌ | 17/20 [01:28<00:14,  4.97s/it]
Task 16, Epoch 18/20 => Loss -0.063, Train_accy 95.21:  90%|█████████ | 18/20 [01:28<00:09,  4.53s/it]
Task 16, Epoch 19/20 => Loss -0.047, Train_accy 94.91:  90%|█████████ | 18/20 [01:31<00:09,  4.53s/it]
Task 16, Epoch 19/20 => Loss -0.047, Train_accy 94.91:  95%|█████████▌| 19/20 [01:31<00:04,  4.21s/it]
Task 16, Epoch 20/20 => Loss -0.060, Train_accy 95.81, Test_accy 38.63:  95%|█████████▌| 19/20 [01:43<00:04,  4.21s/it]
Task 16, Epoch 20/20 => Loss -0.060, Train_accy 95.81, Test_accy 38.63: 100%|██████████| 20/20 [01:43<00:00,  6.53s/it]
Task 16, Epoch 20/20 => Loss -0.060, Train_accy 95.81, Test_accy 38.63: 100%|██████████| 20/20 [01:43<00:00,  5.17s/it]
2024-09-07 11:34:54,878 [l2p.py] => Task 16, Epoch 20/20 => Loss -0.060, Train_accy 95.81, Test_accy 38.63
2024-09-07 11:35:03,303 [trainer.py] => No NME accuracy.
2024-09-07 11:35:03,303 [trainer.py] => CNN: {'total': 38.63, '00-09': 49.35, '10-19': 37.76, '20-29': 45.45, '30-39': 40.7, '40-49': 39.06, '50-59': 46.15, '60-69': 36.51, '70-79': 35.42, '80-89': 48.15, '90-99': 24.19, '100-109': 48.33, '110-119': 39.19, '120-129': 36.67, '130-139': 40.7, '140-149': 32.89, '150-159': 31.37, '160-169': 24.71, 'old': 39.58, 'new': 24.71}
2024-09-07 11:35:03,304 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93, 41.39, 41.1, 39.74, 38.63]
2024-09-07 11:35:03,304 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95, 73.15, 72.26, 71.07, 69.84]

Average Accuracy (CNN): 47.04
2024-09-07 11:35:03,304 [trainer.py] => Average Accuracy (CNN): 47.04 

2024-09-07 11:35:03,307 [trainer.py] => All params: 171970192
2024-09-07 11:35:03,309 [trainer.py] => Trainable params: 199880
2024-09-07 11:35:03,309 [l2p.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.331, Train_accy 21.94:   0%|          | 0/20 [00:02<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.331, Train_accy 21.94:   5%|▌         | 1/20 [00:02<00:49,  2.59s/it]
Task 17, Epoch 2/20 => Loss 0.814, Train_accy 73.00:   5%|▌         | 1/20 [00:05<00:49,  2.59s/it]
Task 17, Epoch 2/20 => Loss 0.814, Train_accy 73.00:  10%|█         | 2/20 [00:05<00:46,  2.59s/it]
Task 17, Epoch 3/20 => Loss 0.418, Train_accy 83.97:  10%|█         | 2/20 [00:07<00:46,  2.59s/it]
Task 17, Epoch 3/20 => Loss 0.418, Train_accy 83.97:  15%|█▌        | 3/20 [00:07<00:43,  2.59s/it]
Task 17, Epoch 4/20 => Loss 0.238, Train_accy 88.19:  15%|█▌        | 3/20 [00:10<00:43,  2.59s/it]
Task 17, Epoch 4/20 => Loss 0.238, Train_accy 88.19:  20%|██        | 4/20 [00:10<00:41,  2.58s/it]
Task 17, Epoch 5/20 => Loss 0.136, Train_accy 90.30, Test_accy 38.49:  20%|██        | 4/20 [00:21<00:41,  2.58s/it]
Task 17, Epoch 5/20 => Loss 0.136, Train_accy 90.30, Test_accy 38.49:  25%|██▌       | 5/20 [00:21<01:26,  5.76s/it]
Task 17, Epoch 6/20 => Loss 0.061, Train_accy 92.83:  25%|██▌       | 5/20 [00:24<01:26,  5.76s/it]                 
Task 17, Epoch 6/20 => Loss 0.061, Train_accy 92.83:  30%|███       | 6/20 [00:24<01:05,  4.69s/it]
Task 17, Epoch 7/20 => Loss -0.030, Train_accy 95.78:  30%|███       | 6/20 [00:26<01:05,  4.69s/it]
Task 17, Epoch 7/20 => Loss -0.030, Train_accy 95.78:  35%|███▌      | 7/20 [00:26<00:52,  4.00s/it]
Task 17, Epoch 8/20 => Loss 0.008, Train_accy 94.51:  35%|███▌      | 7/20 [00:29<00:52,  4.00s/it] 
Task 17, Epoch 8/20 => Loss 0.008, Train_accy 94.51:  40%|████      | 8/20 [00:29<00:42,  3.55s/it]
Task 17, Epoch 9/20 => Loss -0.029, Train_accy 96.20:  40%|████      | 8/20 [00:32<00:42,  3.55s/it]
Task 17, Epoch 9/20 => Loss -0.029, Train_accy 96.20:  45%|████▌     | 9/20 [00:32<00:35,  3.24s/it]
Task 17, Epoch 10/20 => Loss -0.057, Train_accy 97.89, Test_accy 38.57:  45%|████▌     | 9/20 [00:43<00:35,  3.24s/it]
Task 17, Epoch 10/20 => Loss -0.057, Train_accy 97.89, Test_accy 38.57:  50%|█████     | 10/20 [00:43<00:57,  5.75s/it]
Task 17, Epoch 11/20 => Loss -0.018, Train_accy 95.36:  50%|█████     | 10/20 [00:46<00:57,  5.75s/it]                 
Task 17, Epoch 11/20 => Loss -0.018, Train_accy 95.36:  55%|█████▌    | 11/20 [00:46<00:42,  4.78s/it]
Task 17, Epoch 12/20 => Loss -0.045, Train_accy 96.62:  55%|█████▌    | 11/20 [00:48<00:42,  4.78s/it]
Task 17, Epoch 12/20 => Loss -0.045, Train_accy 96.62:  60%|██████    | 12/20 [00:48<00:32,  4.11s/it]
Task 17, Epoch 13/20 => Loss -0.056, Train_accy 96.62:  60%|██████    | 12/20 [00:51<00:32,  4.11s/it]
Task 17, Epoch 13/20 => Loss -0.056, Train_accy 96.62:  65%|██████▌   | 13/20 [00:51<00:25,  3.65s/it]
Task 17, Epoch 14/20 => Loss -0.065, Train_accy 97.47:  65%|██████▌   | 13/20 [00:53<00:25,  3.65s/it]
Task 17, Epoch 14/20 => Loss -0.065, Train_accy 97.47:  70%|███████   | 14/20 [00:53<00:19,  3.32s/it]
Task 17, Epoch 15/20 => Loss -0.089, Train_accy 97.47, Test_accy 37.92:  70%|███████   | 14/20 [01:05<00:19,  3.32s/it]
Task 17, Epoch 15/20 => Loss -0.089, Train_accy 97.47, Test_accy 37.92:  75%|███████▌  | 15/20 [01:05<00:28,  5.72s/it]
Task 17, Epoch 16/20 => Loss -0.068, Train_accy 97.89:  75%|███████▌  | 15/20 [01:07<00:28,  5.72s/it]                 
Task 17, Epoch 16/20 => Loss -0.068, Train_accy 97.89:  80%|████████  | 16/20 [01:07<00:19,  4.78s/it]
Task 17, Epoch 17/20 => Loss -0.044, Train_accy 96.20:  80%|████████  | 16/20 [01:10<00:19,  4.78s/it]
Task 17, Epoch 17/20 => Loss -0.044, Train_accy 96.20:  85%|████████▌ | 17/20 [01:10<00:12,  4.11s/it]
Task 17, Epoch 18/20 => Loss -0.090, Train_accy 97.89:  85%|████████▌ | 17/20 [01:12<00:12,  4.11s/it]
Task 17, Epoch 18/20 => Loss -0.090, Train_accy 97.89:  90%|█████████ | 18/20 [01:12<00:07,  3.64s/it]
Task 17, Epoch 19/20 => Loss -0.077, Train_accy 97.05:  90%|█████████ | 18/20 [01:15<00:07,  3.64s/it]
Task 17, Epoch 19/20 => Loss -0.077, Train_accy 97.05:  95%|█████████▌| 19/20 [01:15<00:03,  3.31s/it]
Task 17, Epoch 20/20 => Loss -0.087, Train_accy 96.62, Test_accy 37.71:  95%|█████████▌| 19/20 [01:26<00:03,  3.31s/it]
Task 17, Epoch 20/20 => Loss -0.087, Train_accy 96.62, Test_accy 37.71: 100%|██████████| 20/20 [01:26<00:00,  5.73s/it]
Task 17, Epoch 20/20 => Loss -0.087, Train_accy 96.62, Test_accy 37.71: 100%|██████████| 20/20 [01:26<00:00,  4.33s/it]
2024-09-07 11:36:29,952 [l2p.py] => Task 17, Epoch 20/20 => Loss -0.087, Train_accy 96.62, Test_accy 37.71
2024-09-07 11:36:38,699 [trainer.py] => No NME accuracy.
2024-09-07 11:36:38,700 [trainer.py] => CNN: {'total': 37.71, '00-09': 48.05, '10-19': 36.73, '20-29': 43.43, '30-39': 40.7, '40-49': 39.06, '50-59': 46.15, '60-69': 37.3, '70-79': 34.38, '80-89': 45.68, '90-99': 22.58, '100-109': 48.33, '110-119': 39.19, '120-129': 35.0, '130-139': 37.21, '140-149': 32.89, '150-159': 31.37, '160-169': 24.71, '170-179': 35.48, 'old': 37.81, 'new': 35.48}
2024-09-07 11:36:38,700 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93, 41.39, 41.1, 39.74, 38.63, 37.71]
2024-09-07 11:36:38,700 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95, 73.15, 72.26, 71.07, 69.84, 69.39]

Average Accuracy (CNN): 46.52
2024-09-07 11:36:38,701 [trainer.py] => Average Accuracy (CNN): 46.52 

2024-09-07 11:36:38,704 [trainer.py] => All params: 171970192
2024-09-07 11:36:38,706 [trainer.py] => Trainable params: 199880
2024-09-07 11:36:38,707 [l2p.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.380, Train_accy 24.34:   0%|          | 0/20 [00:02<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.380, Train_accy 24.34:   5%|▌         | 1/20 [00:02<00:41,  2.19s/it]
Task 18, Epoch 2/20 => Loss 0.986, Train_accy 64.55:   5%|▌         | 1/20 [00:04<00:41,  2.19s/it]
Task 18, Epoch 2/20 => Loss 0.986, Train_accy 64.55:  10%|█         | 2/20 [00:04<00:39,  2.17s/it]
Task 18, Epoch 3/20 => Loss 0.441, Train_accy 80.95:  10%|█         | 2/20 [00:06<00:39,  2.17s/it]
Task 18, Epoch 3/20 => Loss 0.441, Train_accy 80.95:  15%|█▌        | 3/20 [00:06<00:36,  2.17s/it]
Task 18, Epoch 4/20 => Loss 0.221, Train_accy 89.42:  15%|█▌        | 3/20 [00:08<00:36,  2.17s/it]
Task 18, Epoch 4/20 => Loss 0.221, Train_accy 89.42:  20%|██        | 4/20 [00:08<00:34,  2.15s/it]
Task 18, Epoch 5/20 => Loss 0.101, Train_accy 93.12, Test_accy 37.66:  20%|██        | 4/20 [00:19<00:34,  2.15s/it]
Task 18, Epoch 5/20 => Loss 0.101, Train_accy 93.12, Test_accy 37.66:  25%|██▌       | 5/20 [00:19<01:21,  5.41s/it]
Task 18, Epoch 6/20 => Loss 0.016, Train_accy 94.71:  25%|██▌       | 5/20 [00:22<01:21,  5.41s/it]                 
Task 18, Epoch 6/20 => Loss 0.016, Train_accy 94.71:  30%|███       | 6/20 [00:22<01:00,  4.32s/it]
Task 18, Epoch 7/20 => Loss 0.078, Train_accy 93.12:  30%|███       | 6/20 [00:24<01:00,  4.32s/it]
Task 18, Epoch 7/20 => Loss 0.078, Train_accy 93.12:  35%|███▌      | 7/20 [00:24<00:46,  3.61s/it]
Task 18, Epoch 8/20 => Loss -0.057, Train_accy 97.35:  35%|███▌      | 7/20 [00:26<00:46,  3.61s/it]
Task 18, Epoch 8/20 => Loss -0.057, Train_accy 97.35:  40%|████      | 8/20 [00:26<00:37,  3.15s/it]
Task 18, Epoch 9/20 => Loss -0.066, Train_accy 97.88:  40%|████      | 8/20 [00:28<00:37,  3.15s/it]
Task 18, Epoch 9/20 => Loss -0.066, Train_accy 97.88:  45%|████▌     | 9/20 [00:28<00:31,  2.83s/it]
Task 18, Epoch 10/20 => Loss -0.008, Train_accy 95.24, Test_accy 38.21:  45%|████▌     | 9/20 [00:39<00:31,  2.83s/it]
Task 18, Epoch 10/20 => Loss -0.008, Train_accy 95.24, Test_accy 38.21:  50%|█████     | 10/20 [00:39<00:54,  5.41s/it]
Task 18, Epoch 11/20 => Loss -0.055, Train_accy 95.77:  50%|█████     | 10/20 [00:41<00:54,  5.41s/it]                 
Task 18, Epoch 11/20 => Loss -0.055, Train_accy 95.77:  55%|█████▌    | 11/20 [00:41<00:39,  4.43s/it]
Task 18, Epoch 12/20 => Loss -0.054, Train_accy 96.30:  55%|█████▌    | 11/20 [00:44<00:39,  4.43s/it]
Task 18, Epoch 12/20 => Loss -0.054, Train_accy 96.30:  60%|██████    | 12/20 [00:44<00:29,  3.74s/it]
Task 18, Epoch 13/20 => Loss -0.064, Train_accy 97.35:  60%|██████    | 12/20 [00:46<00:29,  3.74s/it]
Task 18, Epoch 13/20 => Loss -0.064, Train_accy 97.35:  65%|██████▌   | 13/20 [00:46<00:22,  3.27s/it]
Task 18, Epoch 14/20 => Loss -0.062, Train_accy 97.35:  65%|██████▌   | 13/20 [00:48<00:22,  3.27s/it]
Task 18, Epoch 14/20 => Loss -0.062, Train_accy 97.35:  70%|███████   | 14/20 [00:48<00:17,  2.94s/it]
Task 18, Epoch 15/20 => Loss -0.075, Train_accy 97.88, Test_accy 38.01:  70%|███████   | 14/20 [00:59<00:17,  2.94s/it]
Task 18, Epoch 15/20 => Loss -0.075, Train_accy 97.88, Test_accy 38.01:  75%|███████▌  | 15/20 [00:59<00:27,  5.40s/it]
Task 18, Epoch 16/20 => Loss -0.111, Train_accy 98.94:  75%|███████▌  | 15/20 [01:01<00:27,  5.40s/it]                 
Task 18, Epoch 16/20 => Loss -0.111, Train_accy 98.94:  80%|████████  | 16/20 [01:01<00:17,  4.43s/it]
Task 18, Epoch 17/20 => Loss -0.073, Train_accy 97.88:  80%|████████  | 16/20 [01:03<00:17,  4.43s/it]
Task 18, Epoch 17/20 => Loss -0.073, Train_accy 97.88:  85%|████████▌ | 17/20 [01:03<00:11,  3.74s/it]
Task 18, Epoch 18/20 => Loss -0.141, Train_accy 99.47:  85%|████████▌ | 17/20 [01:05<00:11,  3.74s/it]
Task 18, Epoch 18/20 => Loss -0.141, Train_accy 99.47:  90%|█████████ | 18/20 [01:05<00:06,  3.27s/it]
Task 18, Epoch 19/20 => Loss -0.112, Train_accy 98.94:  90%|█████████ | 18/20 [01:08<00:06,  3.27s/it]
Task 18, Epoch 19/20 => Loss -0.112, Train_accy 98.94:  95%|█████████▌| 19/20 [01:08<00:02,  2.95s/it]
Task 18, Epoch 20/20 => Loss -0.116, Train_accy 97.88, Test_accy 38.08:  95%|█████████▌| 19/20 [01:19<00:02,  2.95s/it]
Task 18, Epoch 20/20 => Loss -0.116, Train_accy 97.88, Test_accy 38.08: 100%|██████████| 20/20 [01:19<00:00,  5.40s/it]
Task 18, Epoch 20/20 => Loss -0.116, Train_accy 97.88, Test_accy 38.08: 100%|██████████| 20/20 [01:19<00:00,  3.97s/it]
2024-09-07 11:37:58,044 [l2p.py] => Task 18, Epoch 20/20 => Loss -0.116, Train_accy 97.88, Test_accy 38.08
2024-09-07 11:38:07,029 [trainer.py] => No NME accuracy.
2024-09-07 11:38:07,030 [trainer.py] => CNN: {'total': 38.08, '00-09': 48.05, '10-19': 37.76, '20-29': 43.43, '30-39': 41.86, '40-49': 42.19, '50-59': 44.23, '60-69': 38.1, '70-79': 35.42, '80-89': 45.68, '90-99': 22.58, '100-109': 48.33, '110-119': 37.84, '120-129': 33.33, '130-139': 38.37, '140-149': 34.21, '150-159': 31.37, '160-169': 27.06, '170-179': 35.48, '180-189': 33.33, 'old': 38.21, 'new': 33.33}
2024-09-07 11:38:07,030 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93, 41.39, 41.1, 39.74, 38.63, 37.71, 38.08]
2024-09-07 11:38:07,030 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95, 73.15, 72.26, 71.07, 69.84, 69.39, 69.39]

Average Accuracy (CNN): 46.08
2024-09-07 11:38:07,031 [trainer.py] => Average Accuracy (CNN): 46.08 

2024-09-07 11:38:07,033 [trainer.py] => All params: 171970192
2024-09-07 11:38:07,035 [trainer.py] => Trainable params: 199880
2024-09-07 11:38:07,035 [l2p.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.799, Train_accy 34.02:   0%|          | 0/20 [00:03<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.799, Train_accy 34.02:   5%|▌         | 1/20 [00:03<01:07,  3.54s/it]
Task 19, Epoch 2/20 => Loss 0.445, Train_accy 75.44:   5%|▌         | 1/20 [00:07<01:07,  3.54s/it]
Task 19, Epoch 2/20 => Loss 0.445, Train_accy 75.44:  10%|█         | 2/20 [00:07<01:03,  3.54s/it]
Task 19, Epoch 3/20 => Loss 0.291, Train_accy 90.53:  10%|█         | 2/20 [00:10<01:03,  3.54s/it]
Task 19, Epoch 3/20 => Loss 0.291, Train_accy 90.53:  15%|█▌        | 3/20 [00:10<01:00,  3.53s/it]
Task 19, Epoch 4/20 => Loss 0.130, Train_accy 88.76:  15%|█▌        | 3/20 [00:14<01:00,  3.53s/it]
Task 19, Epoch 4/20 => Loss 0.130, Train_accy 88.76:  20%|██        | 4/20 [00:14<00:56,  3.53s/it]
Task 19, Epoch 5/20 => Loss 0.444, Train_accy 87.87, Test_accy 37.85:  20%|██        | 4/20 [00:27<00:56,  3.53s/it]
Task 19, Epoch 5/20 => Loss 0.444, Train_accy 87.87, Test_accy 37.85:  25%|██▌       | 5/20 [00:27<01:44,  6.97s/it]
Task 19, Epoch 6/20 => Loss 0.066, Train_accy 91.72:  25%|██▌       | 5/20 [00:30<01:44,  6.97s/it]                 
Task 19, Epoch 6/20 => Loss 0.066, Train_accy 91.72:  30%|███       | 6/20 [00:30<01:21,  5.81s/it]
Task 19, Epoch 7/20 => Loss 0.075, Train_accy 90.83:  30%|███       | 6/20 [00:34<01:21,  5.81s/it]
Task 19, Epoch 7/20 => Loss 0.075, Train_accy 90.83:  35%|███▌      | 7/20 [00:34<01:05,  5.06s/it]
Task 19, Epoch 8/20 => Loss 0.021, Train_accy 93.79:  35%|███▌      | 7/20 [00:37<01:05,  5.06s/it]
Task 19, Epoch 8/20 => Loss 0.021, Train_accy 93.79:  40%|████      | 8/20 [00:37<00:55,  4.60s/it]
Task 19, Epoch 9/20 => Loss 0.025, Train_accy 95.27:  40%|████      | 8/20 [00:41<00:55,  4.60s/it]
Task 19, Epoch 9/20 => Loss 0.025, Train_accy 95.27:  45%|████▌     | 9/20 [00:41<00:46,  4.26s/it]
Task 19, Epoch 10/20 => Loss 0.009, Train_accy 93.20, Test_accy 38.25:  45%|████▌     | 9/20 [00:54<00:46,  4.26s/it]
Task 19, Epoch 10/20 => Loss 0.009, Train_accy 93.20, Test_accy 38.25:  50%|█████     | 10/20 [00:54<01:09,  6.95s/it]
Task 19, Epoch 11/20 => Loss 0.018, Train_accy 93.49:  50%|█████     | 10/20 [00:57<01:09,  6.95s/it]                 
Task 19, Epoch 11/20 => Loss 0.018, Train_accy 93.49:  55%|█████▌    | 11/20 [00:57<00:53,  5.90s/it]
Task 19, Epoch 12/20 => Loss -0.028, Train_accy 94.08:  55%|█████▌    | 11/20 [01:01<00:53,  5.90s/it]
Task 19, Epoch 12/20 => Loss -0.028, Train_accy 94.08:  60%|██████    | 12/20 [01:01<00:41,  5.18s/it]
Task 19, Epoch 13/20 => Loss -0.012, Train_accy 96.45:  60%|██████    | 12/20 [01:04<00:41,  5.18s/it]
Task 19, Epoch 13/20 => Loss -0.012, Train_accy 96.45:  65%|██████▌   | 13/20 [01:04<00:32,  4.68s/it]
Task 19, Epoch 14/20 => Loss -0.037, Train_accy 94.67:  65%|██████▌   | 13/20 [01:08<00:32,  4.68s/it]
Task 19, Epoch 14/20 => Loss -0.037, Train_accy 94.67:  70%|███████   | 14/20 [01:08<00:25,  4.32s/it]
Task 19, Epoch 15/20 => Loss -0.072, Train_accy 97.34, Test_accy 38.31:  70%|███████   | 14/20 [01:21<00:25,  4.32s/it]
Task 19, Epoch 15/20 => Loss -0.072, Train_accy 97.34, Test_accy 38.31:  75%|███████▌  | 15/20 [01:21<00:34,  6.94s/it]
Task 19, Epoch 16/20 => Loss -0.029, Train_accy 94.38:  75%|███████▌  | 15/20 [01:24<00:34,  6.94s/it]                 
Task 19, Epoch 16/20 => Loss -0.029, Train_accy 94.38:  80%|████████  | 16/20 [01:24<00:23,  5.92s/it]
Task 19, Epoch 17/20 => Loss -0.066, Train_accy 97.93:  80%|████████  | 16/20 [01:28<00:23,  5.92s/it]
Task 19, Epoch 17/20 => Loss -0.066, Train_accy 97.93:  85%|████████▌ | 17/20 [01:28<00:15,  5.19s/it]
Task 19, Epoch 18/20 => Loss -0.073, Train_accy 97.93:  85%|████████▌ | 17/20 [01:32<00:15,  5.19s/it]
Task 19, Epoch 18/20 => Loss -0.073, Train_accy 97.93:  90%|█████████ | 18/20 [01:32<00:09,  4.69s/it]
Task 19, Epoch 19/20 => Loss -0.086, Train_accy 97.34:  90%|█████████ | 18/20 [01:35<00:09,  4.69s/it]
Task 19, Epoch 19/20 => Loss -0.086, Train_accy 97.34:  95%|█████████▌| 19/20 [01:35<00:04,  4.35s/it]
Task 19, Epoch 20/20 => Loss -0.070, Train_accy 97.04, Test_accy 38.12:  95%|█████████▌| 19/20 [01:48<00:04,  4.35s/it]
Task 19, Epoch 20/20 => Loss -0.070, Train_accy 97.04, Test_accy 38.12: 100%|██████████| 20/20 [01:48<00:00,  6.95s/it]
Task 19, Epoch 20/20 => Loss -0.070, Train_accy 97.04, Test_accy 38.12: 100%|██████████| 20/20 [01:48<00:00,  5.43s/it]
2024-09-07 11:39:55,650 [l2p.py] => Task 19, Epoch 20/20 => Loss -0.070, Train_accy 97.04, Test_accy 38.12
2024-09-07 11:40:05,171 [trainer.py] => No NME accuracy.
2024-09-07 11:40:05,171 [trainer.py] => CNN: {'total': 38.12, '00-09': 48.05, '10-19': 36.73, '20-29': 41.41, '30-39': 41.86, '40-49': 42.19, '50-59': 42.31, '60-69': 35.71, '70-79': 35.42, '80-89': 45.68, '90-99': 20.97, '100-109': 48.33, '110-119': 37.84, '120-129': 31.67, '130-139': 38.37, '140-149': 35.53, '150-159': 31.37, '160-169': 27.06, '170-179': 37.1, '180-189': 35.9, '190-199': 45.88, 'old': 37.66, 'new': 45.88}
2024-09-07 11:40:05,171 [trainer.py] => CNN top1 curve: [71.43, 52.57, 48.91, 51.39, 51.65, 51.05, 48.34, 45.7, 45.7, 44.0, 43.51, 42.67, 41.93, 41.39, 41.1, 39.74, 38.63, 37.71, 38.08, 38.12]
2024-09-07 11:40:05,172 [trainer.py] => CNN top5 curve: [89.61, 91.43, 86.13, 85.83, 84.43, 82.14, 80.9, 79.94, 79.2, 76.34, 76.25, 75.08, 72.95, 73.15, 72.26, 71.07, 69.84, 69.39, 69.39, 68.47]

Average Accuracy (CNN): 45.68
2024-09-07 11:40:05,172 [trainer.py] => Average Accuracy (CNN): 45.68 

Accuracy Matrix (CNN):
[[71.43 59.74 61.04 62.34 62.34 62.34 61.04 59.74 58.44 57.14 57.14 55.84
  53.25 53.25 50.65 49.35 49.35 48.05 48.05 48.05]
 [ 0.   46.94 47.96 46.94 51.02 48.98 50.   48.98 46.94 46.94 43.88 43.88
  42.86 39.8  40.82 37.76 37.76 36.73 37.76 36.73]
 [ 0.    0.   40.4  48.48 47.47 48.48 49.49 47.47 49.49 48.48 48.48 47.47
  48.48 47.47 46.46 46.46 45.45 43.43 43.43 41.41]
 [ 0.    0.    0.   50.   51.16 52.33 46.51 47.67 48.84 46.51 44.19 44.19
  44.19 45.35 43.02 41.86 40.7  40.7  41.86 41.86]
 [ 0.    0.    0.    0.   46.88 45.31 40.62 43.75 42.19 43.75 42.19 42.19
  40.62 40.62 40.62 42.19 39.06 39.06 42.19 42.19]
 [ 0.    0.    0.    0.    0.   48.08 48.08 46.15 46.15 48.08 48.08 46.15
  44.23 46.15 46.15 46.15 46.15 46.15 44.23 42.31]
 [ 0.    0.    0.    0.    0.    0.   43.65 42.86 40.48 40.48 41.27 40.48
  38.89 38.1  37.3  35.71 36.51 37.3  38.1  35.71]
 [ 0.    0.    0.    0.    0.    0.    0.   32.29 32.29 32.29 31.25 31.25
  32.29 34.38 35.42 33.33 35.42 34.38 35.42 35.42]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   50.62 50.62 50.62 49.38
  50.62 49.38 49.38 50.62 48.15 45.68 45.68 45.68]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   25.81 25.81 25.81
  24.19 22.58 24.19 24.19 24.19 22.58 22.58 20.97]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   46.67 48.33
  50.   48.33 50.   48.33 48.33 48.33 48.33 48.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   37.84
  37.84 37.84 40.54 39.19 39.19 39.19 37.84 37.84]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  36.67 35.   38.33 35.   36.67 35.   33.33 31.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   40.7  40.7  40.7  40.7  37.21 38.37 38.37]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   34.21 34.21 32.89 32.89 34.21 35.53]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   29.41 31.37 31.37 31.37 31.37]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   24.71 24.71 27.06 27.06]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   35.48 35.48 37.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   33.33 35.9 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   45.88]]
2024-09-07 11:40:05,177 [trainer.py] => Forgetting (CNN): 5.145263157894738
2024-09-07 11:40:07,998 [trainer.py] => config: ./exps/l2p_ina_B100_Inc5.json
2024-09-07 11:40:08,009 [trainer.py] => prefix:  
2024-09-07 11:40:08,009 [trainer.py] => dataset: imageneta
2024-09-07 11:40:08,009 [trainer.py] => memory_size: 0
2024-09-07 11:40:08,009 [trainer.py] => memory_per_class: 0
2024-09-07 11:40:08,009 [trainer.py] => fixed_memory: False
2024-09-07 11:40:08,009 [trainer.py] => shuffle: True
2024-09-07 11:40:08,009 [trainer.py] => init_cls: 100
2024-09-07 11:40:08,009 [trainer.py] => increment: 20
2024-09-07 11:40:08,009 [trainer.py] => model_name: l2p
2024-09-07 11:40:08,009 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 11:40:08,009 [trainer.py] => get_original_backbone: True
2024-09-07 11:40:08,009 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 11:40:08,009 [trainer.py] => seed: 1993
2024-09-07 11:40:08,009 [trainer.py] => tuned_epoch: 20
2024-09-07 11:40:08,009 [trainer.py] => init_lr: 0.001875
2024-09-07 11:40:08,009 [trainer.py] => batch_size: 48
2024-09-07 11:40:08,009 [trainer.py] => weight_decay: 0
2024-09-07 11:40:08,009 [trainer.py] => min_lr: 1e-05
2024-09-07 11:40:08,009 [trainer.py] => optimizer: adam
2024-09-07 11:40:08,009 [trainer.py] => scheduler: constant
2024-09-07 11:40:08,009 [trainer.py] => reinit_optimizer: True
2024-09-07 11:40:08,009 [trainer.py] => global_pool: token
2024-09-07 11:40:08,009 [trainer.py] => head_type: prompt
2024-09-07 11:40:08,009 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 11:40:08,009 [trainer.py] => pretrained: True
2024-09-07 11:40:08,009 [trainer.py] => drop: 0.0
2024-09-07 11:40:08,009 [trainer.py] => drop_path: 0.0
2024-09-07 11:40:08,009 [trainer.py] => prompt_pool: True
2024-09-07 11:40:08,009 [trainer.py] => size: 10
2024-09-07 11:40:08,010 [trainer.py] => length: 5
2024-09-07 11:40:08,010 [trainer.py] => top_k: 5
2024-09-07 11:40:08,010 [trainer.py] => initializer: uniform
2024-09-07 11:40:08,010 [trainer.py] => prompt_key: True
2024-09-07 11:40:08,010 [trainer.py] => prompt_key_init: uniform
2024-09-07 11:40:08,010 [trainer.py] => use_prompt_mask: False
2024-09-07 11:40:08,010 [trainer.py] => shared_prompt_pool: False
2024-09-07 11:40:08,010 [trainer.py] => shared_prompt_key: False
2024-09-07 11:40:08,010 [trainer.py] => batchwise_prompt: True
2024-09-07 11:40:08,010 [trainer.py] => embedding_key: cls
2024-09-07 11:40:08,010 [trainer.py] => predefined_key: 
2024-09-07 11:40:08,010 [trainer.py] => pull_constraint: True
2024-09-07 11:40:08,010 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 11:40:08,037 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 11:40:09,390 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 11:40:09,390 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 11:40:11,105 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 11:40:11,105 [l2p.py] => 199,880 model training parameters.
2024-09-07 11:40:11,105 [l2p.py] => prompt.prompt: 38400
2024-09-07 11:40:11,105 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 11:40:11,106 [l2p.py] => head.weight: 153600
2024-09-07 11:40:11,106 [l2p.py] => head.bias: 200
2024-09-07 11:40:11,107 [trainer.py] => All params: 171970192
2024-09-07 11:40:11,108 [trainer.py] => Trainable params: 199880
2024-09-07 11:40:11,108 [l2p.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.867, Train_accy 18.97:   0%|          | 0/20 [00:30<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.867, Train_accy 18.97:   5%|▌         | 1/20 [00:30<09:44, 30.75s/it]
Task 0, Epoch 2/20 => Loss 1.944, Train_accy 48.21:   5%|▌         | 1/20 [01:01<09:44, 30.75s/it]
Task 0, Epoch 2/20 => Loss 1.944, Train_accy 48.21:  10%|█         | 2/20 [01:01<09:10, 30.56s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 61.31:  10%|█         | 2/20 [01:31<09:10, 30.56s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 61.31:  15%|█▌        | 3/20 [01:31<08:39, 30.55s/it]
Task 0, Epoch 4/20 => Loss 1.097, Train_accy 68.09:  15%|█▌        | 3/20 [02:02<08:39, 30.55s/it]
Task 0, Epoch 4/20 => Loss 1.097, Train_accy 68.09:  20%|██        | 4/20 [02:02<08:08, 30.55s/it]
Task 0, Epoch 5/20 => Loss 0.906, Train_accy 72.28, Test_accy 55.05:  20%|██        | 4/20 [02:38<08:08, 30.55s/it]
Task 0, Epoch 5/20 => Loss 0.906, Train_accy 72.28, Test_accy 55.05:  25%|██▌       | 5/20 [02:38<08:07, 32.50s/it]
Task 0, Epoch 6/20 => Loss 0.750, Train_accy 76.47:  25%|██▌       | 5/20 [03:08<08:07, 32.50s/it]                 
Task 0, Epoch 6/20 => Loss 0.750, Train_accy 76.47:  30%|███       | 6/20 [03:08<07:26, 31.86s/it]
Task 0, Epoch 7/20 => Loss 0.618, Train_accy 79.76:  30%|███       | 6/20 [03:39<07:26, 31.86s/it]
Task 0, Epoch 7/20 => Loss 0.618, Train_accy 79.76:  35%|███▌      | 7/20 [03:39<06:49, 31.48s/it]
Task 0, Epoch 8/20 => Loss 0.635, Train_accy 78.66:  35%|███▌      | 7/20 [04:10<06:49, 31.48s/it]
Task 0, Epoch 8/20 => Loss 0.635, Train_accy 78.66:  40%|████      | 8/20 [04:10<06:14, 31.18s/it]
Task 0, Epoch 9/20 => Loss 0.490, Train_accy 82.71:  40%|████      | 8/20 [04:40<06:14, 31.18s/it]
Task 0, Epoch 9/20 => Loss 0.490, Train_accy 82.71:  45%|████▌     | 9/20 [04:40<05:40, 30.97s/it]
Task 0, Epoch 10/20 => Loss 0.466, Train_accy 82.37, Test_accy 55.53:  45%|████▌     | 9/20 [05:16<05:40, 30.97s/it]
Task 0, Epoch 10/20 => Loss 0.466, Train_accy 82.37, Test_accy 55.53:  50%|█████     | 10/20 [05:16<05:25, 32.55s/it]
Task 0, Epoch 11/20 => Loss 0.451, Train_accy 83.22:  50%|█████     | 10/20 [05:47<05:25, 32.55s/it]                 
Task 0, Epoch 11/20 => Loss 0.451, Train_accy 83.22:  55%|█████▌    | 11/20 [05:47<04:47, 32.00s/it]
Task 0, Epoch 12/20 => Loss 0.368, Train_accy 84.71:  55%|█████▌    | 11/20 [06:18<04:47, 32.00s/it]
Task 0, Epoch 12/20 => Loss 0.368, Train_accy 84.71:  60%|██████    | 12/20 [06:18<04:12, 31.58s/it]
Task 0, Epoch 13/20 => Loss 0.397, Train_accy 83.95:  60%|██████    | 12/20 [06:48<04:12, 31.58s/it]
Task 0, Epoch 13/20 => Loss 0.397, Train_accy 83.95:  65%|██████▌   | 13/20 [06:48<03:39, 31.30s/it]
Task 0, Epoch 14/20 => Loss 0.348, Train_accy 86.38:  65%|██████▌   | 13/20 [07:19<03:39, 31.30s/it]
Task 0, Epoch 14/20 => Loss 0.348, Train_accy 86.38:  70%|███████   | 14/20 [07:19<03:06, 31.07s/it]
Task 0, Epoch 15/20 => Loss 0.325, Train_accy 86.26, Test_accy 57.55:  70%|███████   | 14/20 [07:55<03:06, 31.07s/it]
Task 0, Epoch 15/20 => Loss 0.325, Train_accy 86.26, Test_accy 57.55:  75%|███████▌  | 15/20 [07:55<02:42, 32.56s/it]
Task 0, Epoch 16/20 => Loss 0.272, Train_accy 87.51:  75%|███████▌  | 15/20 [08:25<02:42, 32.56s/it]                 
Task 0, Epoch 16/20 => Loss 0.272, Train_accy 87.51:  80%|████████  | 16/20 [08:25<02:07, 31.95s/it]
Task 0, Epoch 17/20 => Loss 0.310, Train_accy 87.08:  80%|████████  | 16/20 [08:56<02:07, 31.95s/it]
Task 0, Epoch 17/20 => Loss 0.310, Train_accy 87.08:  85%|████████▌ | 17/20 [08:56<01:34, 31.52s/it]
Task 0, Epoch 18/20 => Loss 0.294, Train_accy 87.48:  85%|████████▌ | 17/20 [09:26<01:34, 31.52s/it]
Task 0, Epoch 18/20 => Loss 0.294, Train_accy 87.48:  90%|█████████ | 18/20 [09:26<01:02, 31.21s/it]
Task 0, Epoch 19/20 => Loss 0.294, Train_accy 86.53:  90%|█████████ | 18/20 [09:57<01:02, 31.21s/it]
Task 0, Epoch 19/20 => Loss 0.294, Train_accy 86.53:  95%|█████████▌| 19/20 [09:57<00:31, 31.01s/it]
Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60:  95%|█████████▌| 19/20 [10:33<00:31, 31.01s/it]
Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60: 100%|██████████| 20/20 [10:33<00:00, 32.52s/it]
Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60: 100%|██████████| 20/20 [10:33<00:00, 31.67s/it]
2024-09-07 11:50:45,045 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60
2024-09-07 11:50:50,505 [trainer.py] => No NME accuracy.
2024-09-07 11:50:50,506 [trainer.py] => CNN: {'total': 56.6, '00-99': 56.6, 'old': 0, 'new': 56.6}
2024-09-07 11:50:50,506 [trainer.py] => CNN top1 curve: [56.6]
2024-09-07 11:50:50,506 [trainer.py] => CNN top5 curve: [80.86]

Average Accuracy (CNN): 56.6
2024-09-07 11:50:50,506 [trainer.py] => Average Accuracy (CNN): 56.6 

2024-09-07 11:50:50,509 [trainer.py] => All params: 171970192
2024-09-07 11:50:50,511 [trainer.py] => Trainable params: 199880
2024-09-07 11:50:50,511 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.947, Train_accy 42.45:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.947, Train_accy 42.45:   5%|▌         | 1/20 [00:05<01:38,  5.21s/it]
Task 1, Epoch 2/20 => Loss 0.569, Train_accy 80.31:   5%|▌         | 1/20 [00:10<01:38,  5.21s/it]
Task 1, Epoch 2/20 => Loss 0.569, Train_accy 80.31:  10%|█         | 2/20 [00:10<01:33,  5.21s/it]
Task 1, Epoch 3/20 => Loss 0.257, Train_accy 89.48:  10%|█         | 2/20 [00:15<01:33,  5.21s/it]
Task 1, Epoch 3/20 => Loss 0.257, Train_accy 89.48:  15%|█▌        | 3/20 [00:15<01:28,  5.23s/it]
Task 1, Epoch 4/20 => Loss 0.109, Train_accy 91.78:  15%|█▌        | 3/20 [00:20<01:28,  5.23s/it]
Task 1, Epoch 4/20 => Loss 0.109, Train_accy 91.78:  20%|██        | 4/20 [00:20<01:23,  5.23s/it]
Task 1, Epoch 5/20 => Loss 0.064, Train_accy 93.31, Test_accy 51.49:  20%|██        | 4/20 [00:32<01:23,  5.23s/it]
Task 1, Epoch 5/20 => Loss 0.064, Train_accy 93.31, Test_accy 51.49:  25%|██▌       | 5/20 [00:32<01:52,  7.49s/it]
Task 1, Epoch 6/20 => Loss 0.074, Train_accy 92.73:  25%|██▌       | 5/20 [00:37<01:52,  7.49s/it]                 
Task 1, Epoch 6/20 => Loss 0.074, Train_accy 92.73:  30%|███       | 6/20 [00:37<01:34,  6.72s/it]
Task 1, Epoch 7/20 => Loss 0.024, Train_accy 93.88:  30%|███       | 6/20 [00:42<01:34,  6.72s/it]
Task 1, Epoch 7/20 => Loss 0.024, Train_accy 93.88:  35%|███▌      | 7/20 [00:42<01:21,  6.23s/it]
Task 1, Epoch 8/20 => Loss 0.022, Train_accy 95.03:  35%|███▌      | 7/20 [00:48<01:21,  6.23s/it]
Task 1, Epoch 8/20 => Loss 0.022, Train_accy 95.03:  40%|████      | 8/20 [00:48<01:11,  5.92s/it]
Task 1, Epoch 9/20 => Loss -0.013, Train_accy 95.22:  40%|████      | 8/20 [00:53<01:11,  5.92s/it]
Task 1, Epoch 9/20 => Loss -0.013, Train_accy 95.22:  45%|████▌     | 9/20 [00:53<01:02,  5.70s/it]
Task 1, Epoch 10/20 => Loss -0.031, Train_accy 96.37, Test_accy 52.31:  45%|████▌     | 9/20 [01:04<01:02,  5.70s/it]
Task 1, Epoch 10/20 => Loss -0.031, Train_accy 96.37, Test_accy 52.31:  50%|█████     | 10/20 [01:04<01:15,  7.51s/it]
Task 1, Epoch 11/20 => Loss -0.060, Train_accy 96.37:  50%|█████     | 10/20 [01:10<01:15,  7.51s/it]                 
Task 1, Epoch 11/20 => Loss -0.060, Train_accy 96.37:  55%|█████▌    | 11/20 [01:10<01:01,  6.81s/it]
Task 1, Epoch 12/20 => Loss -0.043, Train_accy 96.75:  55%|█████▌    | 11/20 [01:15<01:01,  6.81s/it]
Task 1, Epoch 12/20 => Loss -0.043, Train_accy 96.75:  60%|██████    | 12/20 [01:15<00:50,  6.33s/it]
Task 1, Epoch 13/20 => Loss -0.033, Train_accy 96.37:  60%|██████    | 12/20 [01:20<00:50,  6.33s/it]
Task 1, Epoch 13/20 => Loss -0.033, Train_accy 96.37:  65%|██████▌   | 13/20 [01:20<00:42,  6.01s/it]
Task 1, Epoch 14/20 => Loss -0.033, Train_accy 95.79:  65%|██████▌   | 13/20 [01:25<00:42,  6.01s/it]
Task 1, Epoch 14/20 => Loss -0.033, Train_accy 95.79:  70%|███████   | 14/20 [01:25<00:34,  5.77s/it]
Task 1, Epoch 15/20 => Loss -0.037, Train_accy 95.03, Test_accy 53.23:  70%|███████   | 14/20 [01:37<00:34,  5.77s/it]
Task 1, Epoch 15/20 => Loss -0.037, Train_accy 95.03, Test_accy 53.23:  75%|███████▌  | 15/20 [01:37<00:37,  7.51s/it]
Task 1, Epoch 16/20 => Loss -0.058, Train_accy 95.79:  75%|███████▌  | 15/20 [01:42<00:37,  7.51s/it]                 
Task 1, Epoch 16/20 => Loss -0.058, Train_accy 95.79:  80%|████████  | 16/20 [01:42<00:27,  6.82s/it]
Task 1, Epoch 17/20 => Loss -0.037, Train_accy 95.60:  80%|████████  | 16/20 [01:47<00:27,  6.82s/it]
Task 1, Epoch 17/20 => Loss -0.037, Train_accy 95.60:  85%|████████▌ | 17/20 [01:47<00:19,  6.34s/it]
Task 1, Epoch 18/20 => Loss -0.095, Train_accy 97.71:  85%|████████▌ | 17/20 [01:53<00:19,  6.34s/it]
Task 1, Epoch 18/20 => Loss -0.095, Train_accy 97.71:  90%|█████████ | 18/20 [01:53<00:12,  6.00s/it]
Task 1, Epoch 19/20 => Loss -0.081, Train_accy 97.32:  90%|█████████ | 18/20 [01:58<00:12,  6.00s/it]
Task 1, Epoch 19/20 => Loss -0.081, Train_accy 97.32:  95%|█████████▌| 19/20 [01:58<00:05,  5.77s/it]
Task 1, Epoch 20/20 => Loss -0.056, Train_accy 96.56, Test_accy 53.13:  95%|█████████▌| 19/20 [02:09<00:05,  5.77s/it]
Task 1, Epoch 20/20 => Loss -0.056, Train_accy 96.56, Test_accy 53.13: 100%|██████████| 20/20 [02:09<00:00,  7.49s/it]
Task 1, Epoch 20/20 => Loss -0.056, Train_accy 96.56, Test_accy 53.13: 100%|██████████| 20/20 [02:09<00:00,  6.49s/it]
2024-09-07 11:53:00,285 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.056, Train_accy 96.56, Test_accy 53.13
2024-09-07 11:53:06,628 [trainer.py] => No NME accuracy.
2024-09-07 11:53:06,629 [trainer.py] => CNN: {'total': 53.13, '00-99': 56.0, '100-119': 35.07, 'old': 56.0, 'new': 35.07}
2024-09-07 11:53:06,629 [trainer.py] => CNN top1 curve: [56.6, 53.13]
2024-09-07 11:53:06,629 [trainer.py] => CNN top5 curve: [80.86, 79.79]

Average Accuracy (CNN): 54.86
2024-09-07 11:53:06,629 [trainer.py] => Average Accuracy (CNN): 54.86 

2024-09-07 11:53:06,632 [trainer.py] => All params: 171970192
2024-09-07 11:53:06,634 [trainer.py] => Trainable params: 199880
2024-09-07 11:53:06,635 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.321, Train_accy 28.94:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.321, Train_accy 28.94:   5%|▌         | 1/20 [00:05<01:41,  5.33s/it]
Task 2, Epoch 2/20 => Loss 0.741, Train_accy 73.84:   5%|▌         | 1/20 [00:10<01:41,  5.33s/it]
Task 2, Epoch 2/20 => Loss 0.741, Train_accy 73.84:  10%|█         | 2/20 [00:10<01:36,  5.38s/it]
Task 2, Epoch 3/20 => Loss 0.387, Train_accy 82.56:  10%|█         | 2/20 [00:16<01:36,  5.38s/it]
Task 2, Epoch 3/20 => Loss 0.387, Train_accy 82.56:  15%|█▌        | 3/20 [00:16<01:31,  5.37s/it]
Task 2, Epoch 4/20 => Loss 0.200, Train_accy 90.54:  15%|█▌        | 3/20 [00:21<01:31,  5.37s/it]
Task 2, Epoch 4/20 => Loss 0.200, Train_accy 90.54:  20%|██        | 4/20 [00:21<01:26,  5.38s/it]
Task 2, Epoch 5/20 => Loss 0.169, Train_accy 91.28, Test_accy 48.53:  20%|██        | 4/20 [00:34<01:26,  5.38s/it]
Task 2, Epoch 5/20 => Loss 0.169, Train_accy 91.28, Test_accy 48.53:  25%|██▌       | 5/20 [00:34<01:59,  7.96s/it]
Task 2, Epoch 6/20 => Loss 0.201, Train_accy 89.05:  25%|██▌       | 5/20 [00:39<01:59,  7.96s/it]                 
Task 2, Epoch 6/20 => Loss 0.201, Train_accy 89.05:  30%|███       | 6/20 [00:39<01:39,  7.09s/it]
Task 2, Epoch 7/20 => Loss 0.139, Train_accy 91.28:  30%|███       | 6/20 [00:44<01:39,  7.09s/it]
Task 2, Epoch 7/20 => Loss 0.139, Train_accy 91.28:  35%|███▌      | 7/20 [00:44<01:24,  6.54s/it]
Task 2, Epoch 8/20 => Loss 0.080, Train_accy 93.51:  35%|███▌      | 7/20 [00:50<01:24,  6.54s/it]
Task 2, Epoch 8/20 => Loss 0.080, Train_accy 93.51:  40%|████      | 8/20 [00:50<01:14,  6.18s/it]
Task 2, Epoch 9/20 => Loss 0.070, Train_accy 93.32:  40%|████      | 8/20 [00:55<01:14,  6.18s/it]
Task 2, Epoch 9/20 => Loss 0.070, Train_accy 93.32:  45%|████▌     | 9/20 [00:55<01:05,  5.94s/it]
Task 2, Epoch 10/20 => Loss -0.032, Train_accy 96.29, Test_accy 48.71:  45%|████▌     | 9/20 [01:08<01:05,  5.94s/it]
Task 2, Epoch 10/20 => Loss -0.032, Train_accy 96.29, Test_accy 48.71:  50%|█████     | 10/20 [01:08<01:19,  7.99s/it]
Task 2, Epoch 11/20 => Loss 0.037, Train_accy 93.32:  50%|█████     | 10/20 [01:13<01:19,  7.99s/it]                  
Task 2, Epoch 11/20 => Loss 0.037, Train_accy 93.32:  55%|█████▌    | 11/20 [01:13<01:04,  7.20s/it]
Task 2, Epoch 12/20 => Loss 0.027, Train_accy 94.06:  55%|█████▌    | 11/20 [01:19<01:04,  7.20s/it]
Task 2, Epoch 12/20 => Loss 0.027, Train_accy 94.06:  60%|██████    | 12/20 [01:19<00:53,  6.66s/it]
Task 2, Epoch 13/20 => Loss -0.026, Train_accy 95.36:  60%|██████    | 12/20 [01:24<00:53,  6.66s/it]
Task 2, Epoch 13/20 => Loss -0.026, Train_accy 95.36:  65%|██████▌   | 13/20 [01:24<00:44,  6.29s/it]
Task 2, Epoch 14/20 => Loss 0.023, Train_accy 93.88:  65%|██████▌   | 13/20 [01:30<00:44,  6.29s/it] 
Task 2, Epoch 14/20 => Loss 0.023, Train_accy 93.88:  70%|███████   | 14/20 [01:30<00:36,  6.06s/it]
Task 2, Epoch 15/20 => Loss -0.026, Train_accy 95.92, Test_accy 49.51:  70%|███████   | 14/20 [01:42<00:36,  6.06s/it]
Task 2, Epoch 15/20 => Loss -0.026, Train_accy 95.92, Test_accy 49.51:  75%|███████▌  | 15/20 [01:42<00:40,  8.12s/it]
Task 2, Epoch 16/20 => Loss -0.011, Train_accy 95.55:  75%|███████▌  | 15/20 [01:48<00:40,  8.12s/it]                 
Task 2, Epoch 16/20 => Loss -0.011, Train_accy 95.55:  80%|████████  | 16/20 [01:48<00:29,  7.30s/it]
Task 2, Epoch 17/20 => Loss -0.039, Train_accy 96.47:  80%|████████  | 16/20 [01:53<00:29,  7.30s/it]
Task 2, Epoch 17/20 => Loss -0.039, Train_accy 96.47:  85%|████████▌ | 17/20 [01:53<00:20,  6.74s/it]
Task 2, Epoch 18/20 => Loss -0.001, Train_accy 96.10:  85%|████████▌ | 17/20 [01:59<00:20,  6.74s/it]
Task 2, Epoch 18/20 => Loss -0.001, Train_accy 96.10:  90%|█████████ | 18/20 [01:59<00:12,  6.34s/it]
Task 2, Epoch 19/20 => Loss -0.060, Train_accy 97.59:  90%|█████████ | 18/20 [02:04<00:12,  6.34s/it]
Task 2, Epoch 19/20 => Loss -0.060, Train_accy 97.59:  95%|█████████▌| 19/20 [02:04<00:06,  6.06s/it]
Task 2, Epoch 20/20 => Loss -0.049, Train_accy 97.03, Test_accy 49.24:  95%|█████████▌| 19/20 [02:17<00:06,  6.06s/it]
Task 2, Epoch 20/20 => Loss -0.049, Train_accy 97.03, Test_accy 49.24: 100%|██████████| 20/20 [02:17<00:00,  8.02s/it]
Task 2, Epoch 20/20 => Loss -0.049, Train_accy 97.03, Test_accy 49.24: 100%|██████████| 20/20 [02:17<00:00,  6.86s/it]
2024-09-07 11:55:23,820 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.049, Train_accy 97.03, Test_accy 49.24
2024-09-07 11:55:31,018 [trainer.py] => No NME accuracy.
2024-09-07 11:55:31,018 [trainer.py] => CNN: {'total': 49.24, '00-99': 55.77, '100-119': 34.33, '120-139': 25.34, 'old': 52.82, 'new': 25.34}
2024-09-07 11:55:31,019 [trainer.py] => CNN top1 curve: [56.6, 53.13, 49.24]
2024-09-07 11:55:31,019 [trainer.py] => CNN top5 curve: [80.86, 79.79, 77.07]

Average Accuracy (CNN): 52.99
2024-09-07 11:55:31,019 [trainer.py] => Average Accuracy (CNN): 52.99 

2024-09-07 11:55:31,022 [trainer.py] => All params: 171970192
2024-09-07 11:55:31,024 [trainer.py] => Trainable params: 199880
2024-09-07 11:55:31,024 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.209, Train_accy 34.84:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.209, Train_accy 34.84:   5%|▌         | 1/20 [00:05<01:41,  5.35s/it]
Task 3, Epoch 2/20 => Loss 0.663, Train_accy 77.78:   5%|▌         | 1/20 [00:10<01:41,  5.35s/it]
Task 3, Epoch 2/20 => Loss 0.663, Train_accy 77.78:  10%|█         | 2/20 [00:10<01:35,  5.33s/it]
Task 3, Epoch 3/20 => Loss 0.366, Train_accy 85.12:  10%|█         | 2/20 [00:15<01:35,  5.33s/it]
Task 3, Epoch 3/20 => Loss 0.366, Train_accy 85.12:  15%|█▌        | 3/20 [00:15<01:30,  5.33s/it]
Task 3, Epoch 4/20 => Loss 0.199, Train_accy 89.27:  15%|█▌        | 3/20 [00:21<01:30,  5.33s/it]
Task 3, Epoch 4/20 => Loss 0.199, Train_accy 89.27:  20%|██        | 4/20 [00:21<01:25,  5.33s/it]
Task 3, Epoch 5/20 => Loss 0.149, Train_accy 89.45, Test_accy 46.88:  20%|██        | 4/20 [00:34<01:25,  5.33s/it]
Task 3, Epoch 5/20 => Loss 0.149, Train_accy 89.45, Test_accy 46.88:  25%|██▌       | 5/20 [00:34<02:02,  8.19s/it]
Task 3, Epoch 6/20 => Loss 0.117, Train_accy 90.21:  25%|██▌       | 5/20 [00:39<02:02,  8.19s/it]                 
Task 3, Epoch 6/20 => Loss 0.117, Train_accy 90.21:  30%|███       | 6/20 [00:39<01:41,  7.22s/it]
Task 3, Epoch 7/20 => Loss 0.081, Train_accy 93.22:  30%|███       | 6/20 [00:45<01:41,  7.22s/it]
Task 3, Epoch 7/20 => Loss 0.081, Train_accy 93.22:  35%|███▌      | 7/20 [00:45<01:25,  6.59s/it]
Task 3, Epoch 8/20 => Loss 0.030, Train_accy 94.54:  35%|███▌      | 7/20 [00:50<01:25,  6.59s/it]
Task 3, Epoch 8/20 => Loss 0.030, Train_accy 94.54:  40%|████      | 8/20 [00:50<01:14,  6.21s/it]
Task 3, Epoch 9/20 => Loss 0.002, Train_accy 94.54:  40%|████      | 8/20 [00:55<01:14,  6.21s/it]
Task 3, Epoch 9/20 => Loss 0.002, Train_accy 94.54:  45%|████▌     | 9/20 [00:55<01:05,  5.93s/it]
Task 3, Epoch 10/20 => Loss -0.022, Train_accy 96.05, Test_accy 47.52:  45%|████▌     | 9/20 [01:09<01:05,  5.93s/it]
Task 3, Epoch 10/20 => Loss -0.022, Train_accy 96.05, Test_accy 47.52:  50%|█████     | 10/20 [01:09<01:21,  8.20s/it]
Task 3, Epoch 11/20 => Loss -0.029, Train_accy 95.29:  50%|█████     | 10/20 [01:14<01:21,  8.20s/it]                 
Task 3, Epoch 11/20 => Loss -0.029, Train_accy 95.29:  55%|█████▌    | 11/20 [01:14<01:05,  7.31s/it]
Task 3, Epoch 12/20 => Loss 0.024, Train_accy 93.41:  55%|█████▌    | 11/20 [01:19<01:05,  7.31s/it] 
Task 3, Epoch 12/20 => Loss 0.024, Train_accy 93.41:  60%|██████    | 12/20 [01:19<00:53,  6.71s/it]
Task 3, Epoch 13/20 => Loss -0.029, Train_accy 96.23:  60%|██████    | 12/20 [01:25<00:53,  6.71s/it]
Task 3, Epoch 13/20 => Loss -0.029, Train_accy 96.23:  65%|██████▌   | 13/20 [01:25<00:43,  6.28s/it]
Task 3, Epoch 14/20 => Loss -0.021, Train_accy 95.67:  65%|██████▌   | 13/20 [01:30<00:43,  6.28s/it]
Task 3, Epoch 14/20 => Loss -0.021, Train_accy 95.67:  70%|███████   | 14/20 [01:30<00:35,  5.99s/it]
Task 3, Epoch 15/20 => Loss -0.048, Train_accy 96.05, Test_accy 47.20:  70%|███████   | 14/20 [01:43<00:35,  5.99s/it]
Task 3, Epoch 15/20 => Loss -0.048, Train_accy 96.05, Test_accy 47.20:  75%|███████▌  | 15/20 [01:43<00:40,  8.19s/it]
Task 3, Epoch 16/20 => Loss -0.068, Train_accy 97.18:  75%|███████▌  | 15/20 [01:49<00:40,  8.19s/it]                 
Task 3, Epoch 16/20 => Loss -0.068, Train_accy 97.18:  80%|████████  | 16/20 [01:49<00:29,  7.35s/it]
Task 3, Epoch 17/20 => Loss -0.035, Train_accy 94.16:  80%|████████  | 16/20 [01:54<00:29,  7.35s/it]
Task 3, Epoch 17/20 => Loss -0.035, Train_accy 94.16:  85%|████████▌ | 17/20 [01:54<00:20,  6.74s/it]
Task 3, Epoch 18/20 => Loss -0.026, Train_accy 95.10:  85%|████████▌ | 17/20 [01:59<00:20,  6.74s/it]
Task 3, Epoch 18/20 => Loss -0.026, Train_accy 95.10:  90%|█████████ | 18/20 [01:59<00:12,  6.32s/it]
Task 3, Epoch 19/20 => Loss 0.010, Train_accy 94.35:  90%|█████████ | 18/20 [02:05<00:12,  6.32s/it] 
Task 3, Epoch 19/20 => Loss 0.010, Train_accy 94.35:  95%|█████████▌| 19/20 [02:05<00:06,  6.02s/it]
Task 3, Epoch 20/20 => Loss -0.055, Train_accy 96.05, Test_accy 47.12:  95%|█████████▌| 19/20 [02:18<00:06,  6.02s/it]
Task 3, Epoch 20/20 => Loss -0.055, Train_accy 96.05, Test_accy 47.12: 100%|██████████| 20/20 [02:18<00:00,  8.20s/it]
Task 3, Epoch 20/20 => Loss -0.055, Train_accy 96.05, Test_accy 47.12: 100%|██████████| 20/20 [02:18<00:00,  6.92s/it]
2024-09-07 11:57:49,440 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.055, Train_accy 96.05, Test_accy 47.12
2024-09-07 11:57:57,391 [trainer.py] => No NME accuracy.
2024-09-07 11:57:57,392 [trainer.py] => CNN: {'total': 47.12, '00-99': 55.29, '100-119': 34.33, '120-139': 25.34, '140-159': 31.5, 'old': 48.88, 'new': 31.5}
2024-09-07 11:57:57,392 [trainer.py] => CNN top1 curve: [56.6, 53.13, 49.24, 47.12]
2024-09-07 11:57:57,392 [trainer.py] => CNN top5 curve: [80.86, 79.79, 77.07, 75.48]

Average Accuracy (CNN): 51.52
2024-09-07 11:57:57,392 [trainer.py] => Average Accuracy (CNN): 51.52 

2024-09-07 11:57:57,395 [trainer.py] => All params: 171970192
2024-09-07 11:57:57,397 [trainer.py] => Trainable params: 199880
2024-09-07 11:57:57,397 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.616, Train_accy 25.04:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.616, Train_accy 25.04:   5%|▌         | 1/20 [00:05<01:48,  5.70s/it]
Task 4, Epoch 2/20 => Loss 0.952, Train_accy 65.67:   5%|▌         | 1/20 [00:11<01:48,  5.70s/it]
Task 4, Epoch 2/20 => Loss 0.952, Train_accy 65.67:  10%|█         | 2/20 [00:11<01:42,  5.70s/it]
Task 4, Epoch 3/20 => Loss 0.508, Train_accy 78.63:  10%|█         | 2/20 [00:17<01:42,  5.70s/it]
Task 4, Epoch 3/20 => Loss 0.508, Train_accy 78.63:  15%|█▌        | 3/20 [00:17<01:36,  5.68s/it]
Task 4, Epoch 4/20 => Loss 0.286, Train_accy 85.29:  15%|█▌        | 3/20 [00:22<01:36,  5.68s/it]
Task 4, Epoch 4/20 => Loss 0.286, Train_accy 85.29:  20%|██        | 4/20 [00:22<01:30,  5.68s/it]
Task 4, Epoch 5/20 => Loss 0.219, Train_accy 88.27, Test_accy 43.66:  20%|██        | 4/20 [00:37<01:30,  5.68s/it]
Task 4, Epoch 5/20 => Loss 0.219, Train_accy 88.27, Test_accy 43.66:  25%|██▌       | 5/20 [00:37<02:12,  8.87s/it]
Task 4, Epoch 6/20 => Loss 0.160, Train_accy 90.19:  25%|██▌       | 5/20 [00:42<02:12,  8.87s/it]                 
Task 4, Epoch 6/20 => Loss 0.160, Train_accy 90.19:  30%|███       | 6/20 [00:42<01:48,  7.79s/it]
Task 4, Epoch 7/20 => Loss 0.112, Train_accy 90.37:  30%|███       | 6/20 [00:48<01:48,  7.79s/it]
Task 4, Epoch 7/20 => Loss 0.112, Train_accy 90.37:  35%|███▌      | 7/20 [00:48<01:32,  7.11s/it]
Task 4, Epoch 8/20 => Loss 0.104, Train_accy 92.29:  35%|███▌      | 7/20 [00:54<01:32,  7.11s/it]
Task 4, Epoch 8/20 => Loss 0.104, Train_accy 92.29:  40%|████      | 8/20 [00:54<01:19,  6.65s/it]
Task 4, Epoch 9/20 => Loss 0.052, Train_accy 92.99:  40%|████      | 8/20 [00:59<01:19,  6.65s/it]
Task 4, Epoch 9/20 => Loss 0.052, Train_accy 92.99:  45%|████▌     | 9/20 [00:59<01:09,  6.34s/it]
Task 4, Epoch 10/20 => Loss 0.033, Train_accy 93.87, Test_accy 44.44:  45%|████▌     | 9/20 [01:14<01:09,  6.34s/it]
Task 4, Epoch 10/20 => Loss 0.033, Train_accy 93.87, Test_accy 44.44:  50%|█████     | 10/20 [01:14<01:28,  8.86s/it]
Task 4, Epoch 11/20 => Loss 0.036, Train_accy 93.87:  50%|█████     | 10/20 [01:20<01:28,  8.86s/it]                 
Task 4, Epoch 11/20 => Loss 0.036, Train_accy 93.87:  55%|█████▌    | 11/20 [01:20<01:10,  7.88s/it]
Task 4, Epoch 12/20 => Loss 0.041, Train_accy 94.22:  55%|█████▌    | 11/20 [01:25<01:10,  7.88s/it]
Task 4, Epoch 12/20 => Loss 0.041, Train_accy 94.22:  60%|██████    | 12/20 [01:25<00:57,  7.22s/it]
Task 4, Epoch 13/20 => Loss 0.019, Train_accy 93.52:  60%|██████    | 12/20 [01:31<00:57,  7.22s/it]
Task 4, Epoch 13/20 => Loss 0.019, Train_accy 93.52:  65%|██████▌   | 13/20 [01:31<00:47,  6.75s/it]
Task 4, Epoch 14/20 => Loss 0.016, Train_accy 93.17:  65%|██████▌   | 13/20 [01:37<00:47,  6.75s/it]
Task 4, Epoch 14/20 => Loss 0.016, Train_accy 93.17:  70%|███████   | 14/20 [01:37<00:38,  6.43s/it]
Task 4, Epoch 15/20 => Loss 0.006, Train_accy 95.27, Test_accy 44.59:  70%|███████   | 14/20 [01:51<00:38,  6.43s/it]
Task 4, Epoch 15/20 => Loss 0.006, Train_accy 95.27, Test_accy 44.59:  75%|███████▌  | 15/20 [01:51<00:44,  8.87s/it]
Task 4, Epoch 16/20 => Loss 0.011, Train_accy 94.92:  75%|███████▌  | 15/20 [01:57<00:44,  8.87s/it]                 
Task 4, Epoch 16/20 => Loss 0.011, Train_accy 94.92:  80%|████████  | 16/20 [01:57<00:31,  7.91s/it]
Task 4, Epoch 17/20 => Loss -0.002, Train_accy 94.05:  80%|████████  | 16/20 [02:03<00:31,  7.91s/it]
Task 4, Epoch 17/20 => Loss -0.002, Train_accy 94.05:  85%|████████▌ | 17/20 [02:03<00:21,  7.24s/it]
Task 4, Epoch 18/20 => Loss -0.032, Train_accy 95.10:  85%|████████▌ | 17/20 [02:08<00:21,  7.24s/it]
Task 4, Epoch 18/20 => Loss -0.032, Train_accy 95.10:  90%|█████████ | 18/20 [02:08<00:13,  6.77s/it]
Task 4, Epoch 19/20 => Loss -0.004, Train_accy 93.35:  90%|█████████ | 18/20 [02:14<00:13,  6.77s/it]
Task 4, Epoch 19/20 => Loss -0.004, Train_accy 93.35:  95%|█████████▌| 19/20 [02:14<00:06,  6.44s/it]
Task 4, Epoch 20/20 => Loss -0.026, Train_accy 95.62, Test_accy 44.80:  95%|█████████▌| 19/20 [02:28<00:06,  6.44s/it]
Task 4, Epoch 20/20 => Loss -0.026, Train_accy 95.62, Test_accy 44.80: 100%|██████████| 20/20 [02:28<00:00,  8.85s/it]
Task 4, Epoch 20/20 => Loss -0.026, Train_accy 95.62, Test_accy 44.80: 100%|██████████| 20/20 [02:28<00:00,  7.44s/it]
2024-09-07 12:00:26,293 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.026, Train_accy 95.62, Test_accy 44.80
2024-09-07 12:00:35,057 [trainer.py] => No NME accuracy.
2024-09-07 12:00:35,058 [trainer.py] => CNN: {'total': 44.8, '00-99': 56.24, '100-119': 32.84, '120-139': 25.34, '140-159': 32.28, '160-179': 20.41, 'old': 47.68, 'new': 20.41}
2024-09-07 12:00:35,058 [trainer.py] => CNN top1 curve: [56.6, 53.13, 49.24, 47.12, 44.8]
2024-09-07 12:00:35,058 [trainer.py] => CNN top5 curve: [80.86, 79.79, 77.07, 75.48, 73.33]

Average Accuracy (CNN): 50.18
2024-09-07 12:00:35,059 [trainer.py] => Average Accuracy (CNN): 50.18 

2024-09-07 12:00:35,062 [trainer.py] => All params: 171970192
2024-09-07 12:00:35,064 [trainer.py] => Trainable params: 199880
2024-09-07 12:00:35,065 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.112, Train_accy 39.47:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.112, Train_accy 39.47:   5%|▌         | 1/20 [00:05<01:39,  5.25s/it]
Task 5, Epoch 2/20 => Loss 0.590, Train_accy 77.23:   5%|▌         | 1/20 [00:10<01:39,  5.25s/it]
Task 5, Epoch 2/20 => Loss 0.590, Train_accy 77.23:  10%|█         | 2/20 [00:10<01:34,  5.26s/it]
Task 5, Epoch 3/20 => Loss 0.305, Train_accy 86.53:  10%|█         | 2/20 [00:15<01:34,  5.26s/it]
Task 5, Epoch 3/20 => Loss 0.305, Train_accy 86.53:  15%|█▌        | 3/20 [00:15<01:29,  5.27s/it]
Task 5, Epoch 4/20 => Loss 0.164, Train_accy 90.13:  15%|█▌        | 3/20 [00:21<01:29,  5.27s/it]
Task 5, Epoch 4/20 => Loss 0.164, Train_accy 90.13:  20%|██        | 4/20 [00:21<01:24,  5.27s/it]
Task 5, Epoch 5/20 => Loss 0.072, Train_accy 92.98, Test_accy 43.52:  20%|██        | 4/20 [00:36<01:24,  5.27s/it]
Task 5, Epoch 5/20 => Loss 0.072, Train_accy 92.98, Test_accy 43.52:  25%|██▌       | 5/20 [00:36<02:11,  8.75s/it]
Task 5, Epoch 6/20 => Loss 0.081, Train_accy 93.36:  25%|██▌       | 5/20 [00:41<02:11,  8.75s/it]                 
Task 5, Epoch 6/20 => Loss 0.081, Train_accy 93.36:  30%|███       | 6/20 [00:41<01:46,  7.58s/it]
Task 5, Epoch 7/20 => Loss 0.008, Train_accy 95.64:  30%|███       | 6/20 [00:46<01:46,  7.58s/it]
Task 5, Epoch 7/20 => Loss 0.008, Train_accy 95.64:  35%|███▌      | 7/20 [00:46<01:28,  6.83s/it]
Task 5, Epoch 8/20 => Loss 0.046, Train_accy 94.69:  35%|███▌      | 7/20 [00:51<01:28,  6.83s/it]
Task 5, Epoch 8/20 => Loss 0.046, Train_accy 94.69:  40%|████      | 8/20 [00:51<01:16,  6.34s/it]
Task 5, Epoch 9/20 => Loss 0.035, Train_accy 94.31:  40%|████      | 8/20 [00:57<01:16,  6.34s/it]
Task 5, Epoch 9/20 => Loss 0.035, Train_accy 94.31:  45%|████▌     | 9/20 [00:57<01:06,  6.02s/it]
Task 5, Epoch 10/20 => Loss -0.004, Train_accy 94.88, Test_accy 43.98:  45%|████▌     | 9/20 [01:12<01:06,  6.02s/it]
Task 5, Epoch 10/20 => Loss -0.004, Train_accy 94.88, Test_accy 43.98:  50%|█████     | 10/20 [01:12<01:27,  8.75s/it]
Task 5, Epoch 11/20 => Loss 0.024, Train_accy 94.69:  50%|█████     | 10/20 [01:17<01:27,  8.75s/it]                  
Task 5, Epoch 11/20 => Loss 0.024, Train_accy 94.69:  55%|█████▌    | 11/20 [01:17<01:09,  7.69s/it]
Task 5, Epoch 12/20 => Loss -0.024, Train_accy 96.58:  55%|█████▌    | 11/20 [01:22<01:09,  7.69s/it]
Task 5, Epoch 12/20 => Loss -0.024, Train_accy 96.58:  60%|██████    | 12/20 [01:22<00:55,  6.96s/it]
Task 5, Epoch 13/20 => Loss -0.030, Train_accy 97.34:  60%|██████    | 12/20 [01:27<00:55,  6.96s/it]
Task 5, Epoch 13/20 => Loss -0.030, Train_accy 97.34:  65%|██████▌   | 13/20 [01:27<00:45,  6.47s/it]
Task 5, Epoch 14/20 => Loss -0.004, Train_accy 95.64:  65%|██████▌   | 13/20 [01:33<00:45,  6.47s/it]
Task 5, Epoch 14/20 => Loss -0.004, Train_accy 95.64:  70%|███████   | 14/20 [01:33<00:36,  6.10s/it]
Task 5, Epoch 15/20 => Loss -0.063, Train_accy 96.39, Test_accy 43.91:  70%|███████   | 14/20 [01:48<00:36,  6.10s/it]
Task 5, Epoch 15/20 => Loss -0.063, Train_accy 96.39, Test_accy 43.91:  75%|███████▌  | 15/20 [01:48<00:43,  8.72s/it]
Task 5, Epoch 16/20 => Loss -0.059, Train_accy 97.34:  75%|███████▌  | 15/20 [01:53<00:43,  8.72s/it]                 
Task 5, Epoch 16/20 => Loss -0.059, Train_accy 97.34:  80%|████████  | 16/20 [01:53<00:30,  7.68s/it]
Task 5, Epoch 17/20 => Loss 0.001, Train_accy 94.50:  80%|████████  | 16/20 [01:58<00:30,  7.68s/it] 
Task 5, Epoch 17/20 => Loss 0.001, Train_accy 94.50:  85%|████████▌ | 17/20 [01:58<00:20,  6.97s/it]
Task 5, Epoch 18/20 => Loss -0.029, Train_accy 95.26:  85%|████████▌ | 17/20 [02:03<00:20,  6.97s/it]
Task 5, Epoch 18/20 => Loss -0.029, Train_accy 95.26:  90%|█████████ | 18/20 [02:03<00:12,  6.46s/it]
Task 5, Epoch 19/20 => Loss -0.016, Train_accy 96.39:  90%|█████████ | 18/20 [02:09<00:12,  6.46s/it]
Task 5, Epoch 19/20 => Loss -0.016, Train_accy 96.39:  95%|█████████▌| 19/20 [02:09<00:06,  6.11s/it]
Task 5, Epoch 20/20 => Loss -0.043, Train_accy 96.20, Test_accy 43.84:  95%|█████████▌| 19/20 [02:23<00:06,  6.11s/it]
Task 5, Epoch 20/20 => Loss -0.043, Train_accy 96.20, Test_accy 43.84: 100%|██████████| 20/20 [02:23<00:00,  8.73s/it]
Task 5, Epoch 20/20 => Loss -0.043, Train_accy 96.20, Test_accy 43.84: 100%|██████████| 20/20 [02:23<00:00,  7.20s/it]
2024-09-07 12:02:59,065 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.043, Train_accy 96.20, Test_accy 43.84
2024-09-07 12:03:08,570 [trainer.py] => No NME accuracy.
2024-09-07 12:03:08,571 [trainer.py] => CNN: {'total': 43.84, '00-99': 57.31, '100-119': 32.09, '120-139': 23.97, '140-159': 33.86, '160-179': 20.41, '180-199': 26.61, 'old': 45.38, 'new': 26.61}
2024-09-07 12:03:08,571 [trainer.py] => CNN top1 curve: [56.6, 53.13, 49.24, 47.12, 44.8, 43.84]
2024-09-07 12:03:08,571 [trainer.py] => CNN top5 curve: [80.86, 79.79, 77.07, 75.48, 73.33, 71.82]

Average Accuracy (CNN): 49.12
2024-09-07 12:03:08,571 [trainer.py] => Average Accuracy (CNN): 49.12 

Accuracy Matrix (CNN):
[[56.6  56.   55.77 55.29 56.24 57.31]
 [ 0.   35.07 34.33 34.33 32.84 32.09]
 [ 0.    0.   25.34 25.34 25.34 23.97]
 [ 0.    0.    0.   31.5  32.28 33.86]
 [ 0.    0.    0.    0.   20.41 20.41]
 [ 0.    0.    0.    0.    0.   26.61]]
2024-09-07 12:03:08,573 [trainer.py] => Forgetting (CNN): 0.8699999999999996
2024-09-07 12:03:11,383 [trainer.py] => config: ./exps/l2p_ina_B100_Inc10.json
2024-09-07 12:03:11,383 [trainer.py] => prefix:  
2024-09-07 12:03:11,383 [trainer.py] => dataset: imageneta
2024-09-07 12:03:11,383 [trainer.py] => memory_size: 0
2024-09-07 12:03:11,383 [trainer.py] => memory_per_class: 0
2024-09-07 12:03:11,383 [trainer.py] => fixed_memory: False
2024-09-07 12:03:11,383 [trainer.py] => shuffle: True
2024-09-07 12:03:11,383 [trainer.py] => init_cls: 100
2024-09-07 12:03:11,383 [trainer.py] => increment: 10
2024-09-07 12:03:11,383 [trainer.py] => model_name: l2p
2024-09-07 12:03:11,383 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 12:03:11,383 [trainer.py] => get_original_backbone: True
2024-09-07 12:03:11,383 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 12:03:11,383 [trainer.py] => seed: 1993
2024-09-07 12:03:11,383 [trainer.py] => tuned_epoch: 20
2024-09-07 12:03:11,383 [trainer.py] => init_lr: 0.001875
2024-09-07 12:03:11,383 [trainer.py] => batch_size: 48
2024-09-07 12:03:11,383 [trainer.py] => weight_decay: 0
2024-09-07 12:03:11,383 [trainer.py] => min_lr: 1e-05
2024-09-07 12:03:11,383 [trainer.py] => optimizer: adam
2024-09-07 12:03:11,383 [trainer.py] => scheduler: constant
2024-09-07 12:03:11,383 [trainer.py] => reinit_optimizer: True
2024-09-07 12:03:11,383 [trainer.py] => global_pool: token
2024-09-07 12:03:11,383 [trainer.py] => head_type: prompt
2024-09-07 12:03:11,383 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 12:03:11,384 [trainer.py] => pretrained: True
2024-09-07 12:03:11,384 [trainer.py] => drop: 0.0
2024-09-07 12:03:11,384 [trainer.py] => drop_path: 0.0
2024-09-07 12:03:11,384 [trainer.py] => prompt_pool: True
2024-09-07 12:03:11,384 [trainer.py] => size: 10
2024-09-07 12:03:11,384 [trainer.py] => length: 5
2024-09-07 12:03:11,384 [trainer.py] => top_k: 5
2024-09-07 12:03:11,384 [trainer.py] => initializer: uniform
2024-09-07 12:03:11,384 [trainer.py] => prompt_key: True
2024-09-07 12:03:11,384 [trainer.py] => prompt_key_init: uniform
2024-09-07 12:03:11,384 [trainer.py] => use_prompt_mask: False
2024-09-07 12:03:11,384 [trainer.py] => shared_prompt_pool: False
2024-09-07 12:03:11,384 [trainer.py] => shared_prompt_key: False
2024-09-07 12:03:11,384 [trainer.py] => batchwise_prompt: True
2024-09-07 12:03:11,384 [trainer.py] => embedding_key: cls
2024-09-07 12:03:11,384 [trainer.py] => predefined_key: 
2024-09-07 12:03:11,384 [trainer.py] => pull_constraint: True
2024-09-07 12:03:11,384 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 12:03:11,410 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 12:03:12,801 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 12:03:12,802 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 12:03:14,664 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 12:03:14,664 [l2p.py] => 199,880 model training parameters.
2024-09-07 12:03:14,664 [l2p.py] => prompt.prompt: 38400
2024-09-07 12:03:14,664 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 12:03:14,665 [l2p.py] => head.weight: 153600
2024-09-07 12:03:14,665 [l2p.py] => head.bias: 200
2024-09-07 12:03:14,666 [trainer.py] => All params: 171970192
2024-09-07 12:03:14,666 [trainer.py] => Trainable params: 199880
2024-09-07 12:03:14,666 [l2p.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.867, Train_accy 18.97:   0%|          | 0/20 [00:30<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.867, Train_accy 18.97:   5%|▌         | 1/20 [00:30<09:45, 30.79s/it]
Task 0, Epoch 2/20 => Loss 1.944, Train_accy 48.21:   5%|▌         | 1/20 [01:01<09:45, 30.79s/it]
Task 0, Epoch 2/20 => Loss 1.944, Train_accy 48.21:  10%|█         | 2/20 [01:01<09:12, 30.71s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 61.31:  10%|█         | 2/20 [01:32<09:12, 30.71s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 61.31:  15%|█▌        | 3/20 [01:32<08:40, 30.65s/it]
Task 0, Epoch 4/20 => Loss 1.097, Train_accy 68.09:  15%|█▌        | 3/20 [02:02<08:40, 30.65s/it]
Task 0, Epoch 4/20 => Loss 1.097, Train_accy 68.09:  20%|██        | 4/20 [02:02<08:09, 30.59s/it]
Task 0, Epoch 5/20 => Loss 0.906, Train_accy 72.28, Test_accy 55.05:  20%|██        | 4/20 [02:38<08:09, 30.59s/it]
Task 0, Epoch 5/20 => Loss 0.906, Train_accy 72.28, Test_accy 55.05:  25%|██▌       | 5/20 [02:38<08:08, 32.60s/it]
Task 0, Epoch 6/20 => Loss 0.750, Train_accy 76.47:  25%|██▌       | 5/20 [03:09<08:08, 32.60s/it]                 
Task 0, Epoch 6/20 => Loss 0.750, Train_accy 76.47:  30%|███       | 6/20 [03:09<07:26, 31.89s/it]
Task 0, Epoch 7/20 => Loss 0.618, Train_accy 79.76:  30%|███       | 6/20 [03:39<07:26, 31.89s/it]
Task 0, Epoch 7/20 => Loss 0.618, Train_accy 79.76:  35%|███▌      | 7/20 [03:39<06:49, 31.51s/it]
Task 0, Epoch 8/20 => Loss 0.635, Train_accy 78.66:  35%|███▌      | 7/20 [04:10<06:49, 31.51s/it]
Task 0, Epoch 8/20 => Loss 0.635, Train_accy 78.66:  40%|████      | 8/20 [04:10<06:14, 31.19s/it]
Task 0, Epoch 9/20 => Loss 0.490, Train_accy 82.71:  40%|████      | 8/20 [04:40<06:14, 31.19s/it]
Task 0, Epoch 9/20 => Loss 0.490, Train_accy 82.71:  45%|████▌     | 9/20 [04:40<05:40, 30.97s/it]
Task 0, Epoch 10/20 => Loss 0.466, Train_accy 82.37, Test_accy 55.53:  45%|████▌     | 9/20 [05:17<05:40, 30.97s/it]
Task 0, Epoch 10/20 => Loss 0.466, Train_accy 82.37, Test_accy 55.53:  50%|█████     | 10/20 [05:17<05:25, 32.56s/it]
Task 0, Epoch 11/20 => Loss 0.451, Train_accy 83.22:  50%|█████     | 10/20 [05:47<05:25, 32.56s/it]                 
Task 0, Epoch 11/20 => Loss 0.451, Train_accy 83.22:  55%|█████▌    | 11/20 [05:47<04:47, 31.98s/it]
Task 0, Epoch 12/20 => Loss 0.368, Train_accy 84.71:  55%|█████▌    | 11/20 [06:18<04:47, 31.98s/it]
Task 0, Epoch 12/20 => Loss 0.368, Train_accy 84.71:  60%|██████    | 12/20 [06:18<04:12, 31.59s/it]
Task 0, Epoch 13/20 => Loss 0.397, Train_accy 83.95:  60%|██████    | 12/20 [06:49<04:12, 31.59s/it]
Task 0, Epoch 13/20 => Loss 0.397, Train_accy 83.95:  65%|██████▌   | 13/20 [06:49<03:39, 31.34s/it]
Task 0, Epoch 14/20 => Loss 0.348, Train_accy 86.38:  65%|██████▌   | 13/20 [07:19<03:39, 31.34s/it]
Task 0, Epoch 14/20 => Loss 0.348, Train_accy 86.38:  70%|███████   | 14/20 [07:19<03:06, 31.14s/it]
Task 0, Epoch 15/20 => Loss 0.325, Train_accy 86.26, Test_accy 57.55:  70%|███████   | 14/20 [07:56<03:06, 31.14s/it]
Task 0, Epoch 15/20 => Loss 0.325, Train_accy 86.26, Test_accy 57.55:  75%|███████▌  | 15/20 [07:56<02:43, 32.67s/it]
Task 0, Epoch 16/20 => Loss 0.272, Train_accy 87.51:  75%|███████▌  | 15/20 [08:26<02:43, 32.67s/it]                 
Task 0, Epoch 16/20 => Loss 0.272, Train_accy 87.51:  80%|████████  | 16/20 [08:26<02:08, 32.08s/it]
Task 0, Epoch 17/20 => Loss 0.310, Train_accy 87.08:  80%|████████  | 16/20 [08:57<02:08, 32.08s/it]
Task 0, Epoch 17/20 => Loss 0.310, Train_accy 87.08:  85%|████████▌ | 17/20 [08:57<01:34, 31.64s/it]
Task 0, Epoch 18/20 => Loss 0.294, Train_accy 87.48:  85%|████████▌ | 17/20 [09:27<01:34, 31.64s/it]
Task 0, Epoch 18/20 => Loss 0.294, Train_accy 87.48:  90%|█████████ | 18/20 [09:27<01:02, 31.33s/it]
Task 0, Epoch 19/20 => Loss 0.294, Train_accy 86.53:  90%|█████████ | 18/20 [09:58<01:02, 31.33s/it]
Task 0, Epoch 19/20 => Loss 0.294, Train_accy 86.53:  95%|█████████▌| 19/20 [09:58<00:31, 31.14s/it]
Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60:  95%|█████████▌| 19/20 [10:34<00:31, 31.14s/it]
Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60: 100%|██████████| 20/20 [10:34<00:00, 32.65s/it]
Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60: 100%|██████████| 20/20 [10:34<00:00, 31.74s/it]
2024-09-07 12:13:50,052 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.287, Train_accy 87.42, Test_accy 56.60
2024-09-07 12:13:55,591 [trainer.py] => No NME accuracy.
2024-09-07 12:13:55,591 [trainer.py] => CNN: {'total': 56.6, '00-99': 56.6, 'old': 0, 'new': 56.6}
2024-09-07 12:13:55,592 [trainer.py] => CNN top1 curve: [56.6]
2024-09-07 12:13:55,592 [trainer.py] => CNN top5 curve: [80.86]

Average Accuracy (CNN): 56.6
2024-09-07 12:13:55,592 [trainer.py] => Average Accuracy (CNN): 56.6 

2024-09-07 12:13:55,595 [trainer.py] => All params: 171970192
2024-09-07 12:13:55,597 [trainer.py] => Trainable params: 199880
2024-09-07 12:13:55,597 [l2p.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.597, Train_accy 42.86:   0%|          | 0/20 [00:02<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.597, Train_accy 42.86:   5%|▌         | 1/20 [00:02<00:52,  2.75s/it]
Task 1, Epoch 2/20 => Loss 0.437, Train_accy 80.82:   5%|▌         | 1/20 [00:05<00:52,  2.75s/it]
Task 1, Epoch 2/20 => Loss 0.437, Train_accy 80.82:  10%|█         | 2/20 [00:05<00:48,  2.72s/it]
Task 1, Epoch 3/20 => Loss 0.158, Train_accy 89.39:  10%|█         | 2/20 [00:08<00:48,  2.72s/it]
Task 1, Epoch 3/20 => Loss 0.158, Train_accy 89.39:  15%|█▌        | 3/20 [00:08<00:46,  2.72s/it]
Task 1, Epoch 4/20 => Loss 0.053, Train_accy 91.43:  15%|█▌        | 3/20 [00:10<00:46,  2.72s/it]
Task 1, Epoch 4/20 => Loss 0.053, Train_accy 91.43:  20%|██        | 4/20 [00:10<00:43,  2.70s/it]
Task 1, Epoch 5/20 => Loss 0.028, Train_accy 93.47, Test_accy 53.50:  20%|██        | 4/20 [00:19<00:43,  2.70s/it]
Task 1, Epoch 5/20 => Loss 0.028, Train_accy 93.47, Test_accy 53.50:  25%|██▌       | 5/20 [00:19<01:12,  4.83s/it]
Task 1, Epoch 6/20 => Loss 0.068, Train_accy 92.24:  25%|██▌       | 5/20 [00:22<01:12,  4.83s/it]                 
Task 1, Epoch 6/20 => Loss 0.068, Train_accy 92.24:  30%|███       | 6/20 [00:22<00:57,  4.11s/it]
Task 1, Epoch 7/20 => Loss -0.014, Train_accy 97.14:  30%|███       | 6/20 [00:24<00:57,  4.11s/it]
Task 1, Epoch 7/20 => Loss -0.014, Train_accy 97.14:  35%|███▌      | 7/20 [00:24<00:47,  3.65s/it]
Task 1, Epoch 8/20 => Loss -0.045, Train_accy 94.69:  35%|███▌      | 7/20 [00:27<00:47,  3.65s/it]
Task 1, Epoch 8/20 => Loss -0.045, Train_accy 94.69:  40%|████      | 8/20 [00:27<00:40,  3.35s/it]
Task 1, Epoch 9/20 => Loss -0.090, Train_accy 96.73:  40%|████      | 8/20 [00:30<00:40,  3.35s/it]
Task 1, Epoch 9/20 => Loss -0.090, Train_accy 96.73:  45%|████▌     | 9/20 [00:30<00:34,  3.15s/it]
Task 1, Epoch 10/20 => Loss 0.060, Train_accy 94.69, Test_accy 53.61:  45%|████▌     | 9/20 [00:38<00:34,  3.15s/it]
Task 1, Epoch 10/20 => Loss 0.060, Train_accy 94.69, Test_accy 53.61:  50%|█████     | 10/20 [00:38<00:48,  4.85s/it]
Task 1, Epoch 11/20 => Loss -0.118, Train_accy 97.14:  50%|█████     | 10/20 [00:41<00:48,  4.85s/it]                
Task 1, Epoch 11/20 => Loss -0.118, Train_accy 97.14:  55%|█████▌    | 11/20 [00:41<00:37,  4.20s/it]
Task 1, Epoch 12/20 => Loss 0.128, Train_accy 94.69:  55%|█████▌    | 11/20 [00:44<00:37,  4.20s/it] 
Task 1, Epoch 12/20 => Loss 0.128, Train_accy 94.69:  60%|██████    | 12/20 [00:44<00:30,  3.76s/it]
Task 1, Epoch 13/20 => Loss -0.001, Train_accy 96.33:  60%|██████    | 12/20 [00:47<00:30,  3.76s/it]
Task 1, Epoch 13/20 => Loss -0.001, Train_accy 96.33:  65%|██████▌   | 13/20 [00:47<00:24,  3.45s/it]
Task 1, Epoch 14/20 => Loss -0.052, Train_accy 96.33:  65%|██████▌   | 13/20 [00:49<00:24,  3.45s/it]
Task 1, Epoch 14/20 => Loss -0.052, Train_accy 96.33:  70%|███████   | 14/20 [00:49<00:19,  3.25s/it]
Task 1, Epoch 15/20 => Loss -0.080, Train_accy 96.33, Test_accy 54.05:  70%|███████   | 14/20 [00:58<00:19,  3.25s/it]
Task 1, Epoch 15/20 => Loss -0.080, Train_accy 96.33, Test_accy 54.05:  75%|███████▌  | 15/20 [00:58<00:24,  4.88s/it]
Task 1, Epoch 16/20 => Loss -0.009, Train_accy 95.51:  75%|███████▌  | 15/20 [01:01<00:24,  4.88s/it]                 
Task 1, Epoch 16/20 => Loss -0.009, Train_accy 95.51:  80%|████████  | 16/20 [01:01<00:16,  4.23s/it]
Task 1, Epoch 17/20 => Loss -0.091, Train_accy 96.73:  80%|████████  | 16/20 [01:04<00:16,  4.23s/it]
Task 1, Epoch 17/20 => Loss -0.091, Train_accy 96.73:  85%|████████▌ | 17/20 [01:04<00:11,  3.77s/it]
Task 1, Epoch 18/20 => Loss -0.067, Train_accy 96.33:  85%|████████▌ | 17/20 [01:06<00:11,  3.77s/it]
Task 1, Epoch 18/20 => Loss -0.067, Train_accy 96.33:  90%|█████████ | 18/20 [01:06<00:06,  3.48s/it]
Task 1, Epoch 19/20 => Loss -0.098, Train_accy 96.73:  90%|█████████ | 18/20 [01:09<00:06,  3.48s/it]
Task 1, Epoch 19/20 => Loss -0.098, Train_accy 96.73:  95%|█████████▌| 19/20 [01:09<00:03,  3.25s/it]
Task 1, Epoch 20/20 => Loss -0.089, Train_accy 95.92, Test_accy 54.94:  95%|█████████▌| 19/20 [01:18<00:03,  3.25s/it]
Task 1, Epoch 20/20 => Loss -0.089, Train_accy 95.92, Test_accy 54.94: 100%|██████████| 20/20 [01:18<00:00,  4.84s/it]
Task 1, Epoch 20/20 => Loss -0.089, Train_accy 95.92, Test_accy 54.94: 100%|██████████| 20/20 [01:18<00:00,  3.90s/it]
2024-09-07 12:15:13,684 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.089, Train_accy 95.92, Test_accy 54.94
2024-09-07 12:15:19,573 [trainer.py] => No NME accuracy.
2024-09-07 12:15:19,574 [trainer.py] => CNN: {'total': 54.94, '00-99': 56.72, '100-109': 30.0, 'old': 56.72, 'new': 30.0}
2024-09-07 12:15:19,574 [trainer.py] => CNN top1 curve: [56.6, 54.94]
2024-09-07 12:15:19,574 [trainer.py] => CNN top5 curve: [80.86, 80.58]

Average Accuracy (CNN): 55.77
2024-09-07 12:15:19,574 [trainer.py] => Average Accuracy (CNN): 55.77 

2024-09-07 12:15:19,577 [trainer.py] => All params: 171970192
2024-09-07 12:15:19,579 [trainer.py] => Trainable params: 199880
2024-09-07 12:15:19,579 [l2p.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.760, Train_accy 38.85:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.760, Train_accy 38.85:   5%|▌         | 1/20 [00:03<00:57,  3.01s/it]
Task 2, Epoch 2/20 => Loss 0.557, Train_accy 80.58:   5%|▌         | 1/20 [00:05<00:57,  3.01s/it]
Task 2, Epoch 2/20 => Loss 0.557, Train_accy 80.58:  10%|█         | 2/20 [00:05<00:53,  2.99s/it]
Task 2, Epoch 3/20 => Loss 0.269, Train_accy 87.41:  10%|█         | 2/20 [00:09<00:53,  2.99s/it]
Task 2, Epoch 3/20 => Loss 0.269, Train_accy 87.41:  15%|█▌        | 3/20 [00:09<00:51,  3.02s/it]
Task 2, Epoch 4/20 => Loss 0.055, Train_accy 93.17:  15%|█▌        | 3/20 [00:12<00:51,  3.02s/it]
Task 2, Epoch 4/20 => Loss 0.055, Train_accy 93.17:  20%|██        | 4/20 [00:12<00:48,  3.00s/it]
Task 2, Epoch 5/20 => Loss 0.045, Train_accy 93.53, Test_accy 51.18:  20%|██        | 4/20 [00:21<00:48,  3.00s/it]
Task 2, Epoch 5/20 => Loss 0.045, Train_accy 93.53, Test_accy 51.18:  25%|██▌       | 5/20 [00:21<01:19,  5.30s/it]
Task 2, Epoch 6/20 => Loss -0.036, Train_accy 95.68:  25%|██▌       | 5/20 [00:24<01:19,  5.30s/it]                
Task 2, Epoch 6/20 => Loss -0.036, Train_accy 95.68:  30%|███       | 6/20 [00:24<01:03,  4.52s/it]
Task 2, Epoch 7/20 => Loss -0.041, Train_accy 96.40:  30%|███       | 6/20 [00:27<01:03,  4.52s/it]
Task 2, Epoch 7/20 => Loss -0.041, Train_accy 96.40:  35%|███▌      | 7/20 [00:27<00:52,  4.04s/it]
Task 2, Epoch 8/20 => Loss -0.082, Train_accy 97.84:  35%|███▌      | 7/20 [00:30<00:52,  4.04s/it]
Task 2, Epoch 8/20 => Loss -0.082, Train_accy 97.84:  40%|████      | 8/20 [00:30<00:44,  3.71s/it]
Task 2, Epoch 9/20 => Loss -0.105, Train_accy 97.48:  40%|████      | 8/20 [00:33<00:44,  3.71s/it]
Task 2, Epoch 9/20 => Loss -0.105, Train_accy 97.48:  45%|████▌     | 9/20 [00:33<00:38,  3.49s/it]
Task 2, Epoch 10/20 => Loss -0.065, Train_accy 97.48, Test_accy 51.69:  45%|████▌     | 9/20 [00:42<00:38,  3.49s/it]
Task 2, Epoch 10/20 => Loss -0.065, Train_accy 97.48, Test_accy 51.69:  50%|█████     | 10/20 [00:42<00:52,  5.29s/it]
Task 2, Epoch 11/20 => Loss -0.093, Train_accy 97.12:  50%|█████     | 10/20 [00:45<00:52,  5.29s/it]                 
Task 2, Epoch 11/20 => Loss -0.093, Train_accy 97.12:  55%|█████▌    | 11/20 [00:45<00:41,  4.59s/it]
Task 2, Epoch 12/20 => Loss -0.117, Train_accy 97.84:  55%|█████▌    | 11/20 [00:48<00:41,  4.59s/it]
Task 2, Epoch 12/20 => Loss -0.117, Train_accy 97.84:  60%|██████    | 12/20 [00:48<00:32,  4.11s/it]
Task 2, Epoch 13/20 => Loss -0.087, Train_accy 97.48:  60%|██████    | 12/20 [00:51<00:32,  4.11s/it]
Task 2, Epoch 13/20 => Loss -0.087, Train_accy 97.48:  65%|██████▌   | 13/20 [00:51<00:26,  3.77s/it]
Task 2, Epoch 14/20 => Loss -0.109, Train_accy 98.56:  65%|██████▌   | 13/20 [00:54<00:26,  3.77s/it]
Task 2, Epoch 14/20 => Loss -0.109, Train_accy 98.56:  70%|███████   | 14/20 [00:54<00:21,  3.59s/it]
Task 2, Epoch 15/20 => Loss -0.123, Train_accy 97.84, Test_accy 51.69:  70%|███████   | 14/20 [01:04<00:21,  3.59s/it]
Task 2, Epoch 15/20 => Loss -0.123, Train_accy 97.84, Test_accy 51.69:  75%|███████▌  | 15/20 [01:04<00:26,  5.35s/it]
Task 2, Epoch 16/20 => Loss -0.108, Train_accy 98.20:  75%|███████▌  | 15/20 [01:07<00:26,  5.35s/it]                 
Task 2, Epoch 16/20 => Loss -0.108, Train_accy 98.20:  80%|████████  | 16/20 [01:07<00:18,  4.64s/it]
Task 2, Epoch 17/20 => Loss -0.110, Train_accy 97.84:  80%|████████  | 16/20 [01:10<00:18,  4.64s/it]
Task 2, Epoch 17/20 => Loss -0.110, Train_accy 97.84:  85%|████████▌ | 17/20 [01:10<00:12,  4.17s/it]
Task 2, Epoch 18/20 => Loss -0.108, Train_accy 97.48:  85%|████████▌ | 17/20 [01:13<00:12,  4.17s/it]
Task 2, Epoch 18/20 => Loss -0.108, Train_accy 97.48:  90%|█████████ | 18/20 [01:13<00:07,  3.82s/it]
Task 2, Epoch 19/20 => Loss -0.100, Train_accy 97.48:  90%|█████████ | 18/20 [01:16<00:07,  3.82s/it]
Task 2, Epoch 19/20 => Loss -0.100, Train_accy 97.48:  95%|█████████▌| 19/20 [01:16<00:03,  3.57s/it]
Task 2, Epoch 20/20 => Loss -0.106, Train_accy 97.84, Test_accy 51.38:  95%|█████████▌| 19/20 [01:25<00:03,  3.57s/it]
Task 2, Epoch 20/20 => Loss -0.106, Train_accy 97.84, Test_accy 51.38: 100%|██████████| 20/20 [01:25<00:00,  5.29s/it]
Task 2, Epoch 20/20 => Loss -0.106, Train_accy 97.84, Test_accy 51.38: 100%|██████████| 20/20 [01:25<00:00,  4.29s/it]
2024-09-07 12:16:45,335 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.106, Train_accy 97.84, Test_accy 51.38
2024-09-07 12:16:51,632 [trainer.py] => No NME accuracy.
2024-09-07 12:16:51,632 [trainer.py] => CNN: {'total': 51.38, '00-99': 55.65, '100-109': 25.0, '110-119': 24.32, 'old': 53.61, 'new': 24.32}
2024-09-07 12:16:51,632 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38]
2024-09-07 12:16:51,633 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0]

Average Accuracy (CNN): 54.31
2024-09-07 12:16:51,633 [trainer.py] => Average Accuracy (CNN): 54.31 

2024-09-07 12:16:51,635 [trainer.py] => All params: 171970192
2024-09-07 12:16:51,637 [trainer.py] => Trainable params: 199880
2024-09-07 12:16:51,637 [l2p.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.167, Train_accy 26.09:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.167, Train_accy 26.09:   5%|▌         | 1/20 [00:02<00:49,  2.58s/it]
Task 3, Epoch 2/20 => Loss 0.826, Train_accy 68.70:   5%|▌         | 1/20 [00:05<00:49,  2.58s/it]
Task 3, Epoch 2/20 => Loss 0.826, Train_accy 68.70:  10%|█         | 2/20 [00:05<00:46,  2.57s/it]
Task 3, Epoch 3/20 => Loss 0.390, Train_accy 86.52:  10%|█         | 2/20 [00:07<00:46,  2.57s/it]
Task 3, Epoch 3/20 => Loss 0.390, Train_accy 86.52:  15%|█▌        | 3/20 [00:07<00:43,  2.56s/it]
Task 3, Epoch 4/20 => Loss 0.209, Train_accy 89.57:  15%|█▌        | 3/20 [00:10<00:43,  2.56s/it]
Task 3, Epoch 4/20 => Loss 0.209, Train_accy 89.57:  20%|██        | 4/20 [00:10<00:41,  2.58s/it]
Task 3, Epoch 5/20 => Loss 0.107, Train_accy 93.48, Test_accy 48.79:  20%|██        | 4/20 [00:19<00:41,  2.58s/it]
Task 3, Epoch 5/20 => Loss 0.107, Train_accy 93.48, Test_accy 48.79:  25%|██▌       | 5/20 [00:19<01:14,  4.98s/it]
Task 3, Epoch 6/20 => Loss 0.071, Train_accy 94.78:  25%|██▌       | 5/20 [00:22<01:14,  4.98s/it]                 
Task 3, Epoch 6/20 => Loss 0.071, Train_accy 94.78:  30%|███       | 6/20 [00:22<00:58,  4.15s/it]
Task 3, Epoch 7/20 => Loss 0.045, Train_accy 95.65:  30%|███       | 6/20 [00:24<00:58,  4.15s/it]
Task 3, Epoch 7/20 => Loss 0.045, Train_accy 95.65:  35%|███▌      | 7/20 [00:24<00:47,  3.63s/it]
Task 3, Epoch 8/20 => Loss -0.029, Train_accy 96.09:  35%|███▌      | 7/20 [00:27<00:47,  3.63s/it]
Task 3, Epoch 8/20 => Loss -0.029, Train_accy 96.09:  40%|████      | 8/20 [00:27<00:39,  3.28s/it]
Task 3, Epoch 9/20 => Loss 0.013, Train_accy 93.48:  40%|████      | 8/20 [00:29<00:39,  3.28s/it] 
Task 3, Epoch 9/20 => Loss 0.013, Train_accy 93.48:  45%|████▌     | 9/20 [00:29<00:33,  3.06s/it]
Task 3, Epoch 10/20 => Loss -0.017, Train_accy 96.96, Test_accy 48.60:  45%|████▌     | 9/20 [00:38<00:33,  3.06s/it]
Task 3, Epoch 10/20 => Loss -0.017, Train_accy 96.96, Test_accy 48.60:  50%|█████     | 10/20 [00:38<00:49,  4.93s/it]
Task 3, Epoch 11/20 => Loss -0.024, Train_accy 94.78:  50%|█████     | 10/20 [00:41<00:49,  4.93s/it]                 
Task 3, Epoch 11/20 => Loss -0.024, Train_accy 94.78:  55%|█████▌    | 11/20 [00:41<00:38,  4.23s/it]
Task 3, Epoch 12/20 => Loss 0.044, Train_accy 94.78:  55%|█████▌    | 11/20 [00:44<00:38,  4.23s/it] 
Task 3, Epoch 12/20 => Loss 0.044, Train_accy 94.78:  60%|██████    | 12/20 [00:44<00:29,  3.72s/it]
Task 3, Epoch 13/20 => Loss -0.038, Train_accy 96.52:  60%|██████    | 12/20 [00:46<00:29,  3.72s/it]
Task 3, Epoch 13/20 => Loss -0.038, Train_accy 96.52:  65%|██████▌   | 13/20 [00:46<00:23,  3.36s/it]
Task 3, Epoch 14/20 => Loss -0.059, Train_accy 95.65:  65%|██████▌   | 13/20 [00:49<00:23,  3.36s/it]
Task 3, Epoch 14/20 => Loss -0.059, Train_accy 95.65:  70%|███████   | 14/20 [00:49<00:18,  3.12s/it]
Task 3, Epoch 15/20 => Loss -0.068, Train_accy 97.39, Test_accy 48.70:  70%|███████   | 14/20 [00:58<00:18,  3.12s/it]
Task 3, Epoch 15/20 => Loss -0.068, Train_accy 97.39, Test_accy 48.70:  75%|███████▌  | 15/20 [00:58<00:24,  4.96s/it]
Task 3, Epoch 16/20 => Loss -0.075, Train_accy 97.83:  75%|███████▌  | 15/20 [01:00<00:24,  4.96s/it]                 
Task 3, Epoch 16/20 => Loss -0.075, Train_accy 97.83:  80%|████████  | 16/20 [01:00<00:16,  4.24s/it]
Task 3, Epoch 17/20 => Loss -0.081, Train_accy 96.96:  80%|████████  | 16/20 [01:03<00:16,  4.24s/it]
Task 3, Epoch 17/20 => Loss -0.081, Train_accy 96.96:  85%|████████▌ | 17/20 [01:03<00:11,  3.73s/it]
Task 3, Epoch 18/20 => Loss -0.075, Train_accy 97.39:  85%|████████▌ | 17/20 [01:06<00:11,  3.73s/it]
Task 3, Epoch 18/20 => Loss -0.075, Train_accy 97.39:  90%|█████████ | 18/20 [01:06<00:06,  3.38s/it]
Task 3, Epoch 19/20 => Loss -0.123, Train_accy 99.13:  90%|█████████ | 18/20 [01:08<00:06,  3.38s/it]
Task 3, Epoch 19/20 => Loss -0.123, Train_accy 99.13:  95%|█████████▌| 19/20 [01:08<00:03,  3.12s/it]
Task 3, Epoch 20/20 => Loss -0.100, Train_accy 97.39, Test_accy 48.60:  95%|█████████▌| 19/20 [01:17<00:03,  3.12s/it]
Task 3, Epoch 20/20 => Loss -0.100, Train_accy 97.39, Test_accy 48.60: 100%|██████████| 20/20 [01:17<00:00,  4.95s/it]
Task 3, Epoch 20/20 => Loss -0.100, Train_accy 97.39, Test_accy 48.60: 100%|██████████| 20/20 [01:17<00:00,  3.89s/it]
2024-09-07 12:18:09,457 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.100, Train_accy 97.39, Test_accy 48.60
2024-09-07 12:18:16,055 [trainer.py] => No NME accuracy.
2024-09-07 12:18:16,055 [trainer.py] => CNN: {'total': 48.6, '00-99': 55.17, '100-109': 25.0, '110-119': 24.32, '120-129': 10.0, 'old': 50.97, 'new': 10.0}
2024-09-07 12:18:16,055 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6]
2024-09-07 12:18:16,055 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87]

Average Accuracy (CNN): 52.88
2024-09-07 12:18:16,056 [trainer.py] => Average Accuracy (CNN): 52.88 

2024-09-07 12:18:16,058 [trainer.py] => All params: 171970192
2024-09-07 12:18:16,060 [trainer.py] => Trainable params: 199880
2024-09-07 12:18:16,060 [l2p.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.964, Train_accy 28.16:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.964, Train_accy 28.16:   5%|▌         | 1/20 [00:03<01:01,  3.26s/it]
Task 4, Epoch 2/20 => Loss 0.591, Train_accy 75.73:   5%|▌         | 1/20 [00:06<01:01,  3.26s/it]
Task 4, Epoch 2/20 => Loss 0.591, Train_accy 75.73:  10%|█         | 2/20 [00:06<00:58,  3.27s/it]
Task 4, Epoch 3/20 => Loss 0.210, Train_accy 88.03:  10%|█         | 2/20 [00:09<00:58,  3.27s/it]
Task 4, Epoch 3/20 => Loss 0.210, Train_accy 88.03:  15%|█▌        | 3/20 [00:09<00:55,  3.26s/it]
Task 4, Epoch 4/20 => Loss 0.113, Train_accy 89.32:  15%|█▌        | 3/20 [00:13<00:55,  3.26s/it]
Task 4, Epoch 4/20 => Loss 0.113, Train_accy 89.32:  20%|██        | 4/20 [00:13<00:52,  3.27s/it]
Task 4, Epoch 5/20 => Loss 0.021, Train_accy 93.85, Test_accy 45.67:  20%|██        | 4/20 [00:23<00:52,  3.27s/it]
Task 4, Epoch 5/20 => Loss 0.021, Train_accy 93.85, Test_accy 45.67:  25%|██▌       | 5/20 [00:23<01:27,  5.85s/it]
Task 4, Epoch 6/20 => Loss -0.017, Train_accy 94.82:  25%|██▌       | 5/20 [00:26<01:27,  5.85s/it]                
Task 4, Epoch 6/20 => Loss -0.017, Train_accy 94.82:  30%|███       | 6/20 [00:26<01:09,  4.98s/it]
Task 4, Epoch 7/20 => Loss 0.052, Train_accy 92.56:  30%|███       | 6/20 [00:30<01:09,  4.98s/it] 
Task 4, Epoch 7/20 => Loss 0.052, Train_accy 92.56:  35%|███▌      | 7/20 [00:30<00:57,  4.42s/it]
Task 4, Epoch 8/20 => Loss -0.029, Train_accy 94.82:  35%|███▌      | 7/20 [00:33<00:57,  4.42s/it]
Task 4, Epoch 8/20 => Loss -0.029, Train_accy 94.82:  40%|████      | 8/20 [00:33<00:48,  4.05s/it]
Task 4, Epoch 9/20 => Loss -0.016, Train_accy 94.82:  40%|████      | 8/20 [00:36<00:48,  4.05s/it]
Task 4, Epoch 9/20 => Loss -0.016, Train_accy 94.82:  45%|████▌     | 9/20 [00:36<00:42,  3.82s/it]
Task 4, Epoch 10/20 => Loss -0.093, Train_accy 96.76, Test_accy 46.39:  45%|████▌     | 9/20 [00:47<00:42,  3.82s/it]
Task 4, Epoch 10/20 => Loss -0.093, Train_accy 96.76, Test_accy 46.39:  50%|█████     | 10/20 [00:47<00:58,  5.87s/it]
Task 4, Epoch 11/20 => Loss -0.028, Train_accy 97.09:  50%|█████     | 10/20 [00:50<00:58,  5.87s/it]                 
Task 4, Epoch 11/20 => Loss -0.028, Train_accy 97.09:  55%|█████▌    | 11/20 [00:50<00:45,  5.07s/it]
Task 4, Epoch 12/20 => Loss -0.039, Train_accy 95.47:  55%|█████▌    | 11/20 [00:53<00:45,  5.07s/it]
Task 4, Epoch 12/20 => Loss -0.039, Train_accy 95.47:  60%|██████    | 12/20 [00:53<00:36,  4.53s/it]
Task 4, Epoch 13/20 => Loss -0.061, Train_accy 95.47:  60%|██████    | 12/20 [00:56<00:36,  4.53s/it]
Task 4, Epoch 13/20 => Loss -0.061, Train_accy 95.47:  65%|██████▌   | 13/20 [00:56<00:29,  4.15s/it]
Task 4, Epoch 14/20 => Loss -0.055, Train_accy 96.76:  65%|██████▌   | 13/20 [01:00<00:29,  4.15s/it]
Task 4, Epoch 14/20 => Loss -0.055, Train_accy 96.76:  70%|███████   | 14/20 [01:00<00:23,  3.89s/it]
Task 4, Epoch 15/20 => Loss -0.082, Train_accy 97.73, Test_accy 47.10:  70%|███████   | 14/20 [01:10<00:23,  3.89s/it]
Task 4, Epoch 15/20 => Loss -0.082, Train_accy 97.73, Test_accy 47.10:  75%|███████▌  | 15/20 [01:10<00:29,  5.85s/it]
Task 4, Epoch 16/20 => Loss -0.087, Train_accy 97.09:  75%|███████▌  | 15/20 [01:13<00:29,  5.85s/it]                 
Task 4, Epoch 16/20 => Loss -0.087, Train_accy 97.09:  80%|████████  | 16/20 [01:13<00:20,  5.09s/it]
Task 4, Epoch 17/20 => Loss -0.064, Train_accy 96.44:  80%|████████  | 16/20 [01:17<00:20,  5.09s/it]
Task 4, Epoch 17/20 => Loss -0.064, Train_accy 96.44:  85%|████████▌ | 17/20 [01:17<00:13,  4.54s/it]
Task 4, Epoch 18/20 => Loss -0.105, Train_accy 97.41:  85%|████████▌ | 17/20 [01:20<00:13,  4.54s/it]
Task 4, Epoch 18/20 => Loss -0.105, Train_accy 97.41:  90%|█████████ | 18/20 [01:20<00:08,  4.16s/it]
Task 4, Epoch 19/20 => Loss -0.086, Train_accy 97.41:  90%|█████████ | 18/20 [01:23<00:08,  4.16s/it]
Task 4, Epoch 19/20 => Loss -0.086, Train_accy 97.41:  95%|█████████▌| 19/20 [01:23<00:03,  3.89s/it]
Task 4, Epoch 20/20 => Loss -0.093, Train_accy 98.06, Test_accy 46.92:  95%|█████████▌| 19/20 [01:34<00:03,  3.89s/it]
Task 4, Epoch 20/20 => Loss -0.093, Train_accy 98.06, Test_accy 46.92: 100%|██████████| 20/20 [01:34<00:00,  5.86s/it]
Task 4, Epoch 20/20 => Loss -0.093, Train_accy 98.06, Test_accy 46.92: 100%|██████████| 20/20 [01:34<00:00,  4.71s/it]
2024-09-07 12:19:50,246 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.093, Train_accy 98.06, Test_accy 46.92
2024-09-07 12:19:57,451 [trainer.py] => No NME accuracy.
2024-09-07 12:19:57,452 [trainer.py] => CNN: {'total': 46.92, '00-99': 55.77, '100-109': 23.33, '110-119': 22.97, '120-129': 11.67, '130-139': 22.09, 'old': 48.99, 'new': 22.09}
2024-09-07 12:19:57,452 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6, 46.92]
2024-09-07 12:19:57,452 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87, 77.16]

Average Accuracy (CNN): 51.69
2024-09-07 12:19:57,453 [trainer.py] => Average Accuracy (CNN): 51.69 

2024-09-07 12:19:57,456 [trainer.py] => All params: 171970192
2024-09-07 12:19:57,459 [trainer.py] => Trainable params: 199880
2024-09-07 12:19:57,459 [l2p.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.834, Train_accy 34.15:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.834, Train_accy 34.15:   5%|▌         | 1/20 [00:03<01:05,  3.45s/it]
Task 5, Epoch 2/20 => Loss 0.638, Train_accy 72.26:   5%|▌         | 1/20 [00:06<01:05,  3.45s/it]
Task 5, Epoch 2/20 => Loss 0.638, Train_accy 72.26:  10%|█         | 2/20 [00:06<01:01,  3.44s/it]
Task 5, Epoch 3/20 => Loss 0.272, Train_accy 85.67:  10%|█         | 2/20 [00:10<01:01,  3.44s/it]
Task 5, Epoch 3/20 => Loss 0.272, Train_accy 85.67:  15%|█▌        | 3/20 [00:10<00:58,  3.43s/it]
Task 5, Epoch 4/20 => Loss 0.153, Train_accy 89.33:  15%|█▌        | 3/20 [00:13<00:58,  3.43s/it]
Task 5, Epoch 4/20 => Loss 0.153, Train_accy 89.33:  20%|██        | 4/20 [00:13<00:55,  3.46s/it]
Task 5, Epoch 5/20 => Loss 0.047, Train_accy 91.46, Test_accy 45.45:  20%|██        | 4/20 [00:24<00:55,  3.46s/it]
Task 5, Epoch 5/20 => Loss 0.047, Train_accy 91.46, Test_accy 45.45:  25%|██▌       | 5/20 [00:24<01:32,  6.19s/it]
Task 5, Epoch 6/20 => Loss 0.009, Train_accy 94.51:  25%|██▌       | 5/20 [00:28<01:32,  6.19s/it]                 
Task 5, Epoch 6/20 => Loss 0.009, Train_accy 94.51:  30%|███       | 6/20 [00:28<01:13,  5.25s/it]
Task 5, Epoch 7/20 => Loss 0.032, Train_accy 93.90:  30%|███       | 6/20 [00:31<01:13,  5.25s/it]
Task 5, Epoch 7/20 => Loss 0.032, Train_accy 93.90:  35%|███▌      | 7/20 [00:31<01:00,  4.67s/it]
Task 5, Epoch 8/20 => Loss 0.040, Train_accy 92.99:  35%|███▌      | 7/20 [00:35<01:00,  4.67s/it]
Task 5, Epoch 8/20 => Loss 0.040, Train_accy 92.99:  40%|████      | 8/20 [00:35<00:51,  4.28s/it]
Task 5, Epoch 9/20 => Loss -0.024, Train_accy 96.34:  40%|████      | 8/20 [00:38<00:51,  4.28s/it]
Task 5, Epoch 9/20 => Loss -0.024, Train_accy 96.34:  45%|████▌     | 9/20 [00:38<00:44,  4.02s/it]
Task 5, Epoch 10/20 => Loss -0.052, Train_accy 95.43, Test_accy 45.36:  45%|████▌     | 9/20 [00:49<00:44,  4.02s/it]
Task 5, Epoch 10/20 => Loss -0.052, Train_accy 95.43, Test_accy 45.36:  50%|█████     | 10/20 [00:49<01:01,  6.17s/it]
Task 5, Epoch 11/20 => Loss -0.086, Train_accy 97.56:  50%|█████     | 10/20 [00:53<01:01,  6.17s/it]                 
Task 5, Epoch 11/20 => Loss -0.086, Train_accy 97.56:  55%|█████▌    | 11/20 [00:53<00:48,  5.35s/it]
Task 5, Epoch 12/20 => Loss -0.077, Train_accy 97.87:  55%|█████▌    | 11/20 [00:56<00:48,  5.35s/it]
Task 5, Epoch 12/20 => Loss -0.077, Train_accy 97.87:  60%|██████    | 12/20 [00:56<00:38,  4.76s/it]
Task 5, Epoch 13/20 => Loss -0.056, Train_accy 96.34:  60%|██████    | 12/20 [00:59<00:38,  4.76s/it]
Task 5, Epoch 13/20 => Loss -0.056, Train_accy 96.34:  65%|██████▌   | 13/20 [00:59<00:30,  4.35s/it]
Task 5, Epoch 14/20 => Loss -0.045, Train_accy 95.73:  65%|██████▌   | 13/20 [01:03<00:30,  4.35s/it]
Task 5, Epoch 14/20 => Loss -0.045, Train_accy 95.73:  70%|███████   | 14/20 [01:03<00:24,  4.10s/it]
Task 5, Epoch 15/20 => Loss -0.050, Train_accy 96.34, Test_accy 45.03:  70%|███████   | 14/20 [01:14<00:24,  4.10s/it]
Task 5, Epoch 15/20 => Loss -0.050, Train_accy 96.34, Test_accy 45.03:  75%|███████▌  | 15/20 [01:14<00:30,  6.15s/it]
Task 5, Epoch 16/20 => Loss -0.074, Train_accy 96.34:  75%|███████▌  | 15/20 [01:17<00:30,  6.15s/it]                 
Task 5, Epoch 16/20 => Loss -0.074, Train_accy 96.34:  80%|████████  | 16/20 [01:17<00:21,  5.33s/it]
Task 5, Epoch 17/20 => Loss -0.057, Train_accy 95.73:  80%|████████  | 16/20 [01:21<00:21,  5.33s/it]
Task 5, Epoch 17/20 => Loss -0.057, Train_accy 95.73:  85%|████████▌ | 17/20 [01:21<00:14,  4.77s/it]
Task 5, Epoch 18/20 => Loss -0.072, Train_accy 97.26:  85%|████████▌ | 17/20 [01:24<00:14,  4.77s/it]
Task 5, Epoch 18/20 => Loss -0.072, Train_accy 97.26:  90%|█████████ | 18/20 [01:24<00:08,  4.36s/it]
Task 5, Epoch 19/20 => Loss -0.040, Train_accy 96.34:  90%|█████████ | 18/20 [01:28<00:08,  4.36s/it]
Task 5, Epoch 19/20 => Loss -0.040, Train_accy 96.34:  95%|█████████▌| 19/20 [01:28<00:04,  4.09s/it]
Task 5, Epoch 20/20 => Loss -0.069, Train_accy 96.34, Test_accy 45.53:  95%|█████████▌| 19/20 [01:39<00:04,  4.09s/it]
Task 5, Epoch 20/20 => Loss -0.069, Train_accy 96.34, Test_accy 45.53: 100%|██████████| 20/20 [01:39<00:00,  6.17s/it]
Task 5, Epoch 20/20 => Loss -0.069, Train_accy 96.34, Test_accy 45.53: 100%|██████████| 20/20 [01:39<00:00,  4.96s/it]
2024-09-07 12:21:36,610 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.069, Train_accy 96.34, Test_accy 45.53
2024-09-07 12:21:44,228 [trainer.py] => No NME accuracy.
2024-09-07 12:21:44,229 [trainer.py] => CNN: {'total': 45.53, '00-99': 55.53, '100-109': 21.67, '110-119': 22.97, '120-129': 11.67, '130-139': 22.09, '140-149': 28.95, 'old': 46.65, 'new': 28.95}
2024-09-07 12:21:44,229 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6, 46.92, 45.53]
2024-09-07 12:21:44,229 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87, 77.16, 76.11]

Average Accuracy (CNN): 50.66
2024-09-07 12:21:44,229 [trainer.py] => Average Accuracy (CNN): 50.66 

2024-09-07 12:21:44,231 [trainer.py] => All params: 171970192
2024-09-07 12:21:44,232 [trainer.py] => Trainable params: 199880
2024-09-07 12:21:44,233 [l2p.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.883, Train_accy 34.98:   0%|          | 0/20 [00:02<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.883, Train_accy 34.98:   5%|▌         | 1/20 [00:02<00:43,  2.31s/it]
Task 6, Epoch 2/20 => Loss 0.771, Train_accy 69.95:   5%|▌         | 1/20 [00:04<00:43,  2.31s/it]
Task 6, Epoch 2/20 => Loss 0.771, Train_accy 69.95:  10%|█         | 2/20 [00:04<00:41,  2.32s/it]
Task 6, Epoch 3/20 => Loss 0.268, Train_accy 88.18:  10%|█         | 2/20 [00:06<00:41,  2.32s/it]
Task 6, Epoch 3/20 => Loss 0.268, Train_accy 88.18:  15%|█▌        | 3/20 [00:06<00:39,  2.31s/it]
Task 6, Epoch 4/20 => Loss 0.113, Train_accy 91.63:  15%|█▌        | 3/20 [00:09<00:39,  2.31s/it]
Task 6, Epoch 4/20 => Loss 0.113, Train_accy 91.63:  20%|██        | 4/20 [00:09<00:36,  2.30s/it]
Task 6, Epoch 5/20 => Loss 0.082, Train_accy 91.63, Test_accy 43.83:  20%|██        | 4/20 [00:19<00:36,  2.30s/it]
Task 6, Epoch 5/20 => Loss 0.082, Train_accy 91.63, Test_accy 43.83:  25%|██▌       | 5/20 [00:19<01:17,  5.17s/it]
Task 6, Epoch 6/20 => Loss -0.025, Train_accy 97.04:  25%|██▌       | 5/20 [00:21<01:17,  5.17s/it]                
Task 6, Epoch 6/20 => Loss -0.025, Train_accy 97.04:  30%|███       | 6/20 [00:21<00:58,  4.20s/it]
Task 6, Epoch 7/20 => Loss 0.024, Train_accy 94.58:  30%|███       | 6/20 [00:24<00:58,  4.20s/it] 
Task 6, Epoch 7/20 => Loss 0.024, Train_accy 94.58:  35%|███▌      | 7/20 [00:24<00:46,  3.57s/it]
Task 6, Epoch 8/20 => Loss -0.033, Train_accy 96.06:  35%|███▌      | 7/20 [00:26<00:46,  3.57s/it]
Task 6, Epoch 8/20 => Loss -0.033, Train_accy 96.06:  40%|████      | 8/20 [00:26<00:37,  3.16s/it]
Task 6, Epoch 9/20 => Loss -0.030, Train_accy 96.06:  40%|████      | 8/20 [00:28<00:37,  3.16s/it]
Task 6, Epoch 9/20 => Loss -0.030, Train_accy 96.06:  45%|████▌     | 9/20 [00:28<00:31,  2.88s/it]
Task 6, Epoch 10/20 => Loss -0.110, Train_accy 98.52, Test_accy 44.15:  45%|████▌     | 9/20 [00:38<00:31,  2.88s/it]
Task 6, Epoch 10/20 => Loss -0.110, Train_accy 98.52, Test_accy 44.15:  50%|█████     | 10/20 [00:38<00:51,  5.15s/it]
Task 6, Epoch 11/20 => Loss -0.041, Train_accy 95.07:  50%|█████     | 10/20 [00:41<00:51,  5.15s/it]                 
Task 6, Epoch 11/20 => Loss -0.041, Train_accy 95.07:  55%|█████▌    | 11/20 [00:41<00:38,  4.28s/it]
Task 6, Epoch 12/20 => Loss -0.109, Train_accy 99.01:  55%|█████▌    | 11/20 [00:43<00:38,  4.28s/it]
Task 6, Epoch 12/20 => Loss -0.109, Train_accy 99.01:  60%|██████    | 12/20 [00:43<00:29,  3.67s/it]
Task 6, Epoch 13/20 => Loss -0.092, Train_accy 99.01:  60%|██████    | 12/20 [00:45<00:29,  3.67s/it]
Task 6, Epoch 13/20 => Loss -0.092, Train_accy 99.01:  65%|██████▌   | 13/20 [00:45<00:22,  3.26s/it]
Task 6, Epoch 14/20 => Loss -0.110, Train_accy 98.03:  65%|██████▌   | 13/20 [00:48<00:22,  3.26s/it]
Task 6, Epoch 14/20 => Loss -0.110, Train_accy 98.03:  70%|███████   | 14/20 [00:48<00:17,  2.98s/it]
Task 6, Epoch 15/20 => Loss -0.144, Train_accy 100.00, Test_accy 44.31:  70%|███████   | 14/20 [00:58<00:17,  2.98s/it]
Task 6, Epoch 15/20 => Loss -0.144, Train_accy 100.00, Test_accy 44.31:  75%|███████▌  | 15/20 [00:58<00:25,  5.15s/it]
Task 6, Epoch 16/20 => Loss -0.098, Train_accy 97.04:  75%|███████▌  | 15/20 [01:00<00:25,  5.15s/it]                  
Task 6, Epoch 16/20 => Loss -0.098, Train_accy 97.04:  80%|████████  | 16/20 [01:00<00:17,  4.29s/it]
Task 6, Epoch 17/20 => Loss -0.103, Train_accy 98.52:  80%|████████  | 16/20 [01:02<00:17,  4.29s/it]
Task 6, Epoch 17/20 => Loss -0.103, Train_accy 98.52:  85%|████████▌ | 17/20 [01:02<00:11,  3.70s/it]
Task 6, Epoch 18/20 => Loss -0.084, Train_accy 97.04:  85%|████████▌ | 17/20 [01:05<00:11,  3.70s/it]
Task 6, Epoch 18/20 => Loss -0.084, Train_accy 97.04:  90%|█████████ | 18/20 [01:05<00:06,  3.28s/it]
Task 6, Epoch 19/20 => Loss -0.114, Train_accy 98.03:  90%|█████████ | 18/20 [01:07<00:06,  3.28s/it]
Task 6, Epoch 19/20 => Loss -0.114, Train_accy 98.03:  95%|█████████▌| 19/20 [01:07<00:02,  2.98s/it]
Task 6, Epoch 20/20 => Loss -0.135, Train_accy 99.51, Test_accy 44.23:  95%|█████████▌| 19/20 [01:17<00:02,  2.98s/it]
Task 6, Epoch 20/20 => Loss -0.135, Train_accy 99.51, Test_accy 44.23: 100%|██████████| 20/20 [01:17<00:00,  5.14s/it]
Task 6, Epoch 20/20 => Loss -0.135, Train_accy 99.51, Test_accy 44.23: 100%|██████████| 20/20 [01:17<00:00,  3.88s/it]
2024-09-07 12:23:01,897 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.135, Train_accy 99.51, Test_accy 44.23
2024-09-07 12:23:09,759 [trainer.py] => No NME accuracy.
2024-09-07 12:23:09,759 [trainer.py] => CNN: {'total': 44.23, '00-99': 55.53, '100-109': 21.67, '110-119': 24.32, '120-129': 10.0, '130-139': 20.93, '140-149': 26.32, '150-159': 19.61, 'old': 45.28, 'new': 19.61}
2024-09-07 12:23:09,760 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6, 46.92, 45.53, 44.23]
2024-09-07 12:23:09,760 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87, 77.16, 76.11, 75.24]

Average Accuracy (CNN): 49.74
2024-09-07 12:23:09,760 [trainer.py] => Average Accuracy (CNN): 49.74 

2024-09-07 12:23:09,762 [trainer.py] => All params: 171970192
2024-09-07 12:23:09,765 [trainer.py] => Trainable params: 199880
2024-09-07 12:23:09,765 [l2p.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.056, Train_accy 29.94:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.056, Train_accy 29.94:   5%|▌         | 1/20 [00:03<01:07,  3.54s/it]
Task 7, Epoch 2/20 => Loss 0.767, Train_accy 68.26:   5%|▌         | 1/20 [00:07<01:07,  3.54s/it]
Task 7, Epoch 2/20 => Loss 0.767, Train_accy 68.26:  10%|█         | 2/20 [00:07<01:03,  3.51s/it]
Task 7, Epoch 3/20 => Loss 0.445, Train_accy 80.24:  10%|█         | 2/20 [00:10<01:03,  3.51s/it]
Task 7, Epoch 3/20 => Loss 0.445, Train_accy 80.24:  15%|█▌        | 3/20 [00:10<00:59,  3.50s/it]
Task 7, Epoch 4/20 => Loss 0.227, Train_accy 86.53:  15%|█▌        | 3/20 [00:14<00:59,  3.50s/it]
Task 7, Epoch 4/20 => Loss 0.227, Train_accy 86.53:  20%|██        | 4/20 [00:14<00:56,  3.50s/it]
Task 7, Epoch 5/20 => Loss 0.125, Train_accy 89.22, Test_accy 41.11:  20%|██        | 4/20 [00:25<00:56,  3.50s/it]
Task 7, Epoch 5/20 => Loss 0.125, Train_accy 89.22, Test_accy 41.11:  25%|██▌       | 5/20 [00:25<01:37,  6.53s/it]
Task 7, Epoch 6/20 => Loss 0.092, Train_accy 90.42:  25%|██▌       | 5/20 [00:29<01:37,  6.53s/it]                 
Task 7, Epoch 6/20 => Loss 0.092, Train_accy 90.42:  30%|███       | 6/20 [00:29<01:16,  5.49s/it]
Task 7, Epoch 7/20 => Loss 0.085, Train_accy 91.02:  30%|███       | 6/20 [00:32<01:16,  5.49s/it]
Task 7, Epoch 7/20 => Loss 0.085, Train_accy 91.02:  35%|███▌      | 7/20 [00:32<01:02,  4.83s/it]
Task 7, Epoch 8/20 => Loss 0.041, Train_accy 94.01:  35%|███▌      | 7/20 [00:36<01:02,  4.83s/it]
Task 7, Epoch 8/20 => Loss 0.041, Train_accy 94.01:  40%|████      | 8/20 [00:36<00:52,  4.40s/it]
Task 7, Epoch 9/20 => Loss 0.051, Train_accy 93.71:  40%|████      | 8/20 [00:39<00:52,  4.40s/it]
Task 7, Epoch 9/20 => Loss 0.051, Train_accy 93.71:  45%|████▌     | 9/20 [00:39<00:45,  4.12s/it]
Task 7, Epoch 10/20 => Loss 0.025, Train_accy 92.81, Test_accy 41.71:  45%|████▌     | 9/20 [00:51<00:45,  4.12s/it]
Task 7, Epoch 10/20 => Loss 0.025, Train_accy 92.81, Test_accy 41.71:  50%|█████     | 10/20 [00:51<01:04,  6.48s/it]
Task 7, Epoch 11/20 => Loss -0.007, Train_accy 94.61:  50%|█████     | 10/20 [00:55<01:04,  6.48s/it]                
Task 7, Epoch 11/20 => Loss -0.007, Train_accy 94.61:  55%|█████▌    | 11/20 [00:55<00:50,  5.57s/it]
Task 7, Epoch 12/20 => Loss -0.046, Train_accy 96.11:  55%|█████▌    | 11/20 [00:58<00:50,  5.57s/it]
Task 7, Epoch 12/20 => Loss -0.046, Train_accy 96.11:  60%|██████    | 12/20 [00:58<00:39,  4.96s/it]
Task 7, Epoch 13/20 => Loss -0.037, Train_accy 94.61:  60%|██████    | 12/20 [01:02<00:39,  4.96s/it]
Task 7, Epoch 13/20 => Loss -0.037, Train_accy 94.61:  65%|██████▌   | 13/20 [01:02<00:31,  4.52s/it]
Task 7, Epoch 14/20 => Loss -0.042, Train_accy 95.51:  65%|██████▌   | 13/20 [01:05<00:31,  4.52s/it]
Task 7, Epoch 14/20 => Loss -0.042, Train_accy 95.51:  70%|███████   | 14/20 [01:05<00:25,  4.23s/it]
Task 7, Epoch 15/20 => Loss -0.047, Train_accy 95.51, Test_accy 42.46:  70%|███████   | 14/20 [01:17<00:25,  4.23s/it]
Task 7, Epoch 15/20 => Loss -0.047, Train_accy 95.51, Test_accy 42.46:  75%|███████▌  | 15/20 [01:17<00:32,  6.54s/it]
Task 7, Epoch 16/20 => Loss -0.034, Train_accy 94.91:  75%|███████▌  | 15/20 [01:21<00:32,  6.54s/it]                 
Task 7, Epoch 16/20 => Loss -0.034, Train_accy 94.91:  80%|████████  | 16/20 [01:21<00:22,  5.64s/it]
Task 7, Epoch 17/20 => Loss -0.072, Train_accy 97.01:  80%|████████  | 16/20 [01:24<00:22,  5.64s/it]
Task 7, Epoch 17/20 => Loss -0.072, Train_accy 97.01:  85%|████████▌ | 17/20 [01:24<00:14,  4.99s/it]
Task 7, Epoch 18/20 => Loss -0.046, Train_accy 95.21:  85%|████████▌ | 17/20 [01:28<00:14,  4.99s/it]
Task 7, Epoch 18/20 => Loss -0.046, Train_accy 95.21:  90%|█████████ | 18/20 [01:28<00:09,  4.53s/it]
Task 7, Epoch 19/20 => Loss -0.054, Train_accy 94.91:  90%|█████████ | 18/20 [01:31<00:09,  4.53s/it]
Task 7, Epoch 19/20 => Loss -0.054, Train_accy 94.91:  95%|█████████▌| 19/20 [01:31<00:04,  4.23s/it]
Task 7, Epoch 20/20 => Loss -0.111, Train_accy 97.60, Test_accy 42.91:  95%|█████████▌| 19/20 [01:43<00:04,  4.23s/it]
Task 7, Epoch 20/20 => Loss -0.111, Train_accy 97.60, Test_accy 42.91: 100%|██████████| 20/20 [01:43<00:00,  6.55s/it]
Task 7, Epoch 20/20 => Loss -0.111, Train_accy 97.60, Test_accy 42.91: 100%|██████████| 20/20 [01:43<00:00,  5.18s/it]
2024-09-07 12:24:53,406 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.111, Train_accy 97.60, Test_accy 42.91
2024-09-07 12:25:01,836 [trainer.py] => No NME accuracy.
2024-09-07 12:25:01,836 [trainer.py] => CNN: {'total': 42.91, '00-99': 56.0, '100-109': 21.67, '110-119': 21.62, '120-129': 10.0, '130-139': 19.77, '140-149': 28.95, '150-159': 19.61, '160-169': 20.0, 'old': 44.47, 'new': 20.0}
2024-09-07 12:25:01,837 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6, 46.92, 45.53, 44.23, 42.91]
2024-09-07 12:25:01,837 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87, 77.16, 76.11, 75.24, 73.14]

Average Accuracy (CNN): 48.89
2024-09-07 12:25:01,837 [trainer.py] => Average Accuracy (CNN): 48.89 

2024-09-07 12:25:01,839 [trainer.py] => All params: 171970192
2024-09-07 12:25:01,841 [trainer.py] => Trainable params: 199880
2024-09-07 12:25:01,841 [l2p.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.402, Train_accy 22.78:   0%|          | 0/20 [00:02<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.402, Train_accy 22.78:   5%|▌         | 1/20 [00:02<00:49,  2.61s/it]
Task 8, Epoch 2/20 => Loss 0.938, Train_accy 65.82:   5%|▌         | 1/20 [00:05<00:49,  2.61s/it]
Task 8, Epoch 2/20 => Loss 0.938, Train_accy 65.82:  10%|█         | 2/20 [00:05<00:46,  2.60s/it]
Task 8, Epoch 3/20 => Loss 0.445, Train_accy 83.97:  10%|█         | 2/20 [00:07<00:46,  2.60s/it]
Task 8, Epoch 3/20 => Loss 0.445, Train_accy 83.97:  15%|█▌        | 3/20 [00:07<00:44,  2.61s/it]
Task 8, Epoch 4/20 => Loss 0.301, Train_accy 86.92:  15%|█▌        | 3/20 [00:10<00:44,  2.61s/it]
Task 8, Epoch 4/20 => Loss 0.301, Train_accy 86.92:  20%|██        | 4/20 [00:10<00:41,  2.60s/it]
Task 8, Epoch 5/20 => Loss 0.068, Train_accy 92.41, Test_accy 41.22:  20%|██        | 4/20 [00:21<00:41,  2.60s/it]
Task 8, Epoch 5/20 => Loss 0.068, Train_accy 92.41, Test_accy 41.22:  25%|██▌       | 5/20 [00:21<01:26,  5.76s/it]
Task 8, Epoch 6/20 => Loss 0.031, Train_accy 94.94:  25%|██▌       | 5/20 [00:24<01:26,  5.76s/it]                 
Task 8, Epoch 6/20 => Loss 0.031, Train_accy 94.94:  30%|███       | 6/20 [00:24<01:05,  4.70s/it]
Task 8, Epoch 7/20 => Loss 0.015, Train_accy 95.78:  30%|███       | 6/20 [00:27<01:05,  4.70s/it]
Task 8, Epoch 7/20 => Loss 0.015, Train_accy 95.78:  35%|███▌      | 7/20 [00:27<00:52,  4.01s/it]
Task 8, Epoch 8/20 => Loss -0.032, Train_accy 96.20:  35%|███▌      | 7/20 [00:29<00:52,  4.01s/it]
Task 8, Epoch 8/20 => Loss -0.032, Train_accy 96.20:  40%|████      | 8/20 [00:29<00:42,  3.56s/it]
Task 8, Epoch 9/20 => Loss -0.037, Train_accy 95.78:  40%|████      | 8/20 [00:32<00:42,  3.56s/it]
Task 8, Epoch 9/20 => Loss -0.037, Train_accy 95.78:  45%|████▌     | 9/20 [00:32<00:35,  3.26s/it]
Task 8, Epoch 10/20 => Loss -0.025, Train_accy 95.36, Test_accy 41.58:  45%|████▌     | 9/20 [00:43<00:35,  3.26s/it]
Task 8, Epoch 10/20 => Loss -0.025, Train_accy 95.36, Test_accy 41.58:  50%|█████     | 10/20 [00:43<00:57,  5.77s/it]
Task 8, Epoch 11/20 => Loss -0.085, Train_accy 97.05:  50%|█████     | 10/20 [00:46<00:57,  5.77s/it]                 
Task 8, Epoch 11/20 => Loss -0.085, Train_accy 97.05:  55%|█████▌    | 11/20 [00:46<00:43,  4.80s/it]
Task 8, Epoch 12/20 => Loss -0.033, Train_accy 97.05:  55%|█████▌    | 11/20 [00:48<00:43,  4.80s/it]
Task 8, Epoch 12/20 => Loss -0.033, Train_accy 97.05:  60%|██████    | 12/20 [00:48<00:33,  4.13s/it]
Task 8, Epoch 13/20 => Loss -0.047, Train_accy 96.20:  60%|██████    | 12/20 [00:51<00:33,  4.13s/it]
Task 8, Epoch 13/20 => Loss -0.047, Train_accy 96.20:  65%|██████▌   | 13/20 [00:51<00:25,  3.67s/it]
Task 8, Epoch 14/20 => Loss -0.070, Train_accy 97.05:  65%|██████▌   | 13/20 [00:54<00:25,  3.67s/it]
Task 8, Epoch 14/20 => Loss -0.070, Train_accy 97.05:  70%|███████   | 14/20 [00:54<00:20,  3.35s/it]
Task 8, Epoch 15/20 => Loss -0.065, Train_accy 95.36, Test_accy 41.58:  70%|███████   | 14/20 [01:05<00:20,  3.35s/it]
Task 8, Epoch 15/20 => Loss -0.065, Train_accy 95.36, Test_accy 41.58:  75%|███████▌  | 15/20 [01:05<00:28,  5.76s/it]
Task 8, Epoch 16/20 => Loss -0.042, Train_accy 97.05:  75%|███████▌  | 15/20 [01:07<00:28,  5.76s/it]                 
Task 8, Epoch 16/20 => Loss -0.042, Train_accy 97.05:  80%|████████  | 16/20 [01:07<00:19,  4.81s/it]
Task 8, Epoch 17/20 => Loss -0.067, Train_accy 96.62:  80%|████████  | 16/20 [01:10<00:19,  4.81s/it]
Task 8, Epoch 17/20 => Loss -0.067, Train_accy 96.62:  85%|████████▌ | 17/20 [01:10<00:12,  4.14s/it]
Task 8, Epoch 18/20 => Loss -0.071, Train_accy 96.20:  85%|████████▌ | 17/20 [01:13<00:12,  4.14s/it]
Task 8, Epoch 18/20 => Loss -0.071, Train_accy 96.20:  90%|█████████ | 18/20 [01:13<00:07,  3.67s/it]
Task 8, Epoch 19/20 => Loss -0.085, Train_accy 96.62:  90%|█████████ | 18/20 [01:15<00:07,  3.67s/it]
Task 8, Epoch 19/20 => Loss -0.085, Train_accy 96.62:  95%|█████████▌| 19/20 [01:15<00:03,  3.34s/it]
Task 8, Epoch 20/20 => Loss -0.093, Train_accy 97.47, Test_accy 41.58:  95%|█████████▌| 19/20 [01:27<00:03,  3.34s/it]
Task 8, Epoch 20/20 => Loss -0.093, Train_accy 97.47, Test_accy 41.58: 100%|██████████| 20/20 [01:27<00:00,  5.73s/it]
Task 8, Epoch 20/20 => Loss -0.093, Train_accy 97.47, Test_accy 41.58: 100%|██████████| 20/20 [01:27<00:00,  4.35s/it]
2024-09-07 12:26:28,874 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.093, Train_accy 97.47, Test_accy 41.58
2024-09-07 12:26:37,612 [trainer.py] => No NME accuracy.
2024-09-07 12:26:37,613 [trainer.py] => CNN: {'total': 41.58, '00-99': 55.41, '100-109': 21.67, '110-119': 24.32, '120-129': 10.0, '130-139': 18.6, '140-149': 27.63, '150-159': 19.61, '160-169': 22.35, '170-179': 17.74, 'old': 42.69, 'new': 17.74}
2024-09-07 12:26:37,613 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6, 46.92, 45.53, 44.23, 42.91, 41.58]
2024-09-07 12:26:37,613 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87, 77.16, 76.11, 75.24, 73.14, 72.26]

Average Accuracy (CNN): 48.08
2024-09-07 12:26:37,613 [trainer.py] => Average Accuracy (CNN): 48.08 

2024-09-07 12:26:37,616 [trainer.py] => All params: 171970192
2024-09-07 12:26:37,619 [trainer.py] => Trainable params: 199880
2024-09-07 12:26:37,619 [l2p.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.175, Train_accy 26.46:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.175, Train_accy 26.46:   5%|▌         | 1/20 [00:02<00:40,  2.15s/it]
Task 9, Epoch 2/20 => Loss 1.080, Train_accy 60.85:   5%|▌         | 1/20 [00:04<00:40,  2.15s/it]
Task 9, Epoch 2/20 => Loss 1.080, Train_accy 60.85:  10%|█         | 2/20 [00:04<00:39,  2.19s/it]
Task 9, Epoch 3/20 => Loss 0.467, Train_accy 81.48:  10%|█         | 2/20 [00:06<00:39,  2.19s/it]
Task 9, Epoch 3/20 => Loss 0.467, Train_accy 81.48:  15%|█▌        | 3/20 [00:06<00:37,  2.19s/it]
Task 9, Epoch 4/20 => Loss 0.200, Train_accy 90.48:  15%|█▌        | 3/20 [00:08<00:37,  2.19s/it]
Task 9, Epoch 4/20 => Loss 0.200, Train_accy 90.48:  20%|██        | 4/20 [00:08<00:35,  2.19s/it]
Task 9, Epoch 5/20 => Loss 0.161, Train_accy 90.48, Test_accy 40.59:  20%|██        | 4/20 [00:19<00:35,  2.19s/it]
Task 9, Epoch 5/20 => Loss 0.161, Train_accy 90.48, Test_accy 40.59:  25%|██▌       | 5/20 [00:19<01:20,  5.39s/it]
Task 9, Epoch 6/20 => Loss 0.070, Train_accy 93.12:  25%|██▌       | 5/20 [00:22<01:20,  5.39s/it]                 
Task 9, Epoch 6/20 => Loss 0.070, Train_accy 93.12:  30%|███       | 6/20 [00:22<01:00,  4.31s/it]
Task 9, Epoch 7/20 => Loss 0.016, Train_accy 94.71:  30%|███       | 6/20 [00:24<01:00,  4.31s/it]
Task 9, Epoch 7/20 => Loss 0.016, Train_accy 94.71:  35%|███▌      | 7/20 [00:24<00:47,  3.62s/it]
Task 9, Epoch 8/20 => Loss -0.019, Train_accy 96.30:  35%|███▌      | 7/20 [00:26<00:47,  3.62s/it]
Task 9, Epoch 8/20 => Loss -0.019, Train_accy 96.30:  40%|████      | 8/20 [00:26<00:38,  3.17s/it]
Task 9, Epoch 9/20 => Loss -0.054, Train_accy 96.83:  40%|████      | 8/20 [00:28<00:38,  3.17s/it]
Task 9, Epoch 9/20 => Loss -0.054, Train_accy 96.83:  45%|████▌     | 9/20 [00:28<00:31,  2.88s/it]
Task 9, Epoch 10/20 => Loss -0.061, Train_accy 96.30, Test_accy 40.45:  45%|████▌     | 9/20 [00:39<00:31,  2.88s/it]
Task 9, Epoch 10/20 => Loss -0.061, Train_accy 96.30, Test_accy 40.45:  50%|█████     | 10/20 [00:39<00:54,  5.42s/it]
Task 9, Epoch 11/20 => Loss -0.111, Train_accy 98.41:  50%|█████     | 10/20 [00:41<00:54,  5.42s/it]                 
Task 9, Epoch 11/20 => Loss -0.111, Train_accy 98.41:  55%|█████▌    | 11/20 [00:41<00:39,  4.43s/it]
Task 9, Epoch 12/20 => Loss -0.064, Train_accy 97.35:  55%|█████▌    | 11/20 [00:44<00:39,  4.43s/it]
Task 9, Epoch 12/20 => Loss -0.064, Train_accy 97.35:  60%|██████    | 12/20 [00:44<00:29,  3.74s/it]
Task 9, Epoch 13/20 => Loss -0.060, Train_accy 97.35:  60%|██████    | 12/20 [00:46<00:29,  3.74s/it]
Task 9, Epoch 13/20 => Loss -0.060, Train_accy 97.35:  65%|██████▌   | 13/20 [00:46<00:22,  3.26s/it]
Task 9, Epoch 14/20 => Loss -0.088, Train_accy 96.83:  65%|██████▌   | 13/20 [00:48<00:22,  3.26s/it]
Task 9, Epoch 14/20 => Loss -0.088, Train_accy 96.83:  70%|███████   | 14/20 [00:48<00:17,  2.94s/it]
Task 9, Epoch 15/20 => Loss -0.109, Train_accy 97.88, Test_accy 40.59:  70%|███████   | 14/20 [00:59<00:17,  2.94s/it]
Task 9, Epoch 15/20 => Loss -0.109, Train_accy 97.88, Test_accy 40.59:  75%|███████▌  | 15/20 [00:59<00:27,  5.43s/it]
Task 9, Epoch 16/20 => Loss -0.085, Train_accy 96.83:  75%|███████▌  | 15/20 [01:01<00:27,  5.43s/it]                 
Task 9, Epoch 16/20 => Loss -0.085, Train_accy 96.83:  80%|████████  | 16/20 [01:01<00:17,  4.46s/it]
Task 9, Epoch 17/20 => Loss -0.132, Train_accy 99.47:  80%|████████  | 16/20 [01:04<00:17,  4.46s/it]
Task 9, Epoch 17/20 => Loss -0.132, Train_accy 99.47:  85%|████████▌ | 17/20 [01:04<00:11,  3.80s/it]
Task 9, Epoch 18/20 => Loss -0.095, Train_accy 97.88:  85%|████████▌ | 17/20 [01:06<00:11,  3.80s/it]
Task 9, Epoch 18/20 => Loss -0.095, Train_accy 97.88:  90%|█████████ | 18/20 [01:06<00:06,  3.30s/it]
Task 9, Epoch 19/20 => Loss -0.134, Train_accy 98.41:  90%|█████████ | 18/20 [01:08<00:06,  3.30s/it]
Task 9, Epoch 19/20 => Loss -0.134, Train_accy 98.41:  95%|█████████▌| 19/20 [01:08<00:02,  2.97s/it]
Task 9, Epoch 20/20 => Loss -0.112, Train_accy 97.35, Test_accy 40.79:  95%|█████████▌| 19/20 [01:19<00:02,  2.97s/it]
Task 9, Epoch 20/20 => Loss -0.112, Train_accy 97.35, Test_accy 40.79: 100%|██████████| 20/20 [01:19<00:00,  5.44s/it]
Task 9, Epoch 20/20 => Loss -0.112, Train_accy 97.35, Test_accy 40.79: 100%|██████████| 20/20 [01:19<00:00,  3.99s/it]
2024-09-07 12:27:57,357 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.112, Train_accy 97.35, Test_accy 40.79
2024-09-07 12:28:06,366 [trainer.py] => No NME accuracy.
2024-09-07 12:28:06,367 [trainer.py] => CNN: {'total': 40.79, '00-99': 55.65, '100-109': 21.67, '110-119': 24.32, '120-129': 10.0, '130-139': 19.77, '140-149': 27.63, '150-159': 19.61, '160-169': 21.18, '170-179': 16.13, '180-189': 10.26, 'old': 41.65, 'new': 10.26}
2024-09-07 12:28:06,367 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6, 46.92, 45.53, 44.23, 42.91, 41.58, 40.79]
2024-09-07 12:28:06,367 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87, 77.16, 76.11, 75.24, 73.14, 72.26, 71.83]

Average Accuracy (CNN): 47.35
2024-09-07 12:28:06,367 [trainer.py] => Average Accuracy (CNN): 47.35 

2024-09-07 12:28:06,369 [trainer.py] => All params: 171970192
2024-09-07 12:28:06,371 [trainer.py] => Trainable params: 199880
2024-09-07 12:28:06,372 [l2p.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.676, Train_accy 39.35:   0%|          | 0/20 [00:03<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.676, Train_accy 39.35:   5%|▌         | 1/20 [00:03<01:07,  3.56s/it]
Task 10, Epoch 2/20 => Loss 0.494, Train_accy 76.33:   5%|▌         | 1/20 [00:07<01:07,  3.56s/it]
Task 10, Epoch 2/20 => Loss 0.494, Train_accy 76.33:  10%|█         | 2/20 [00:07<01:03,  3.55s/it]
Task 10, Epoch 3/20 => Loss 0.172, Train_accy 86.98:  10%|█         | 2/20 [00:10<01:03,  3.55s/it]
Task 10, Epoch 3/20 => Loss 0.172, Train_accy 86.98:  15%|█▌        | 3/20 [00:10<01:00,  3.56s/it]
Task 10, Epoch 4/20 => Loss 0.212, Train_accy 89.35:  15%|█▌        | 3/20 [00:14<01:00,  3.56s/it]
Task 10, Epoch 4/20 => Loss 0.212, Train_accy 89.35:  20%|██        | 4/20 [00:14<00:56,  3.56s/it]
Task 10, Epoch 5/20 => Loss 0.097, Train_accy 93.49, Test_accy 39.70:  20%|██        | 4/20 [00:27<00:56,  3.56s/it]
Task 10, Epoch 5/20 => Loss 0.097, Train_accy 93.49, Test_accy 39.70:  25%|██▌       | 5/20 [00:27<01:44,  6.98s/it]
Task 10, Epoch 6/20 => Loss 0.022, Train_accy 92.90:  25%|██▌       | 5/20 [00:30<01:44,  6.98s/it]                 
Task 10, Epoch 6/20 => Loss 0.022, Train_accy 92.90:  30%|███       | 6/20 [00:30<01:21,  5.81s/it]
Task 10, Epoch 7/20 => Loss 0.008, Train_accy 93.79:  30%|███       | 6/20 [00:34<01:21,  5.81s/it]
Task 10, Epoch 7/20 => Loss 0.008, Train_accy 93.79:  35%|███▌      | 7/20 [00:34<01:06,  5.09s/it]
Task 10, Epoch 8/20 => Loss 0.054, Train_accy 94.38:  35%|███▌      | 7/20 [00:37<01:06,  5.09s/it]
Task 10, Epoch 8/20 => Loss 0.054, Train_accy 94.38:  40%|████      | 8/20 [00:37<00:55,  4.60s/it]
Task 10, Epoch 9/20 => Loss 0.001, Train_accy 94.67:  40%|████      | 8/20 [00:41<00:55,  4.60s/it]
Task 10, Epoch 9/20 => Loss 0.001, Train_accy 94.67:  45%|████▌     | 9/20 [00:41<00:46,  4.27s/it]
Task 10, Epoch 10/20 => Loss 0.019, Train_accy 95.86, Test_accy 40.36:  45%|████▌     | 9/20 [00:54<00:46,  4.27s/it]
Task 10, Epoch 10/20 => Loss 0.019, Train_accy 95.86, Test_accy 40.36:  50%|█████     | 10/20 [00:54<01:09,  6.99s/it]
Task 10, Epoch 11/20 => Loss -0.037, Train_accy 94.67:  50%|█████     | 10/20 [00:58<01:09,  6.99s/it]                
Task 10, Epoch 11/20 => Loss -0.037, Train_accy 94.67:  55%|█████▌    | 11/20 [00:58<00:53,  5.93s/it]
Task 10, Epoch 12/20 => Loss -0.035, Train_accy 95.27:  55%|█████▌    | 11/20 [01:01<00:53,  5.93s/it]
Task 10, Epoch 12/20 => Loss -0.035, Train_accy 95.27:  60%|██████    | 12/20 [01:01<00:41,  5.21s/it]
Task 10, Epoch 13/20 => Loss -0.086, Train_accy 97.63:  60%|██████    | 12/20 [01:05<00:41,  5.21s/it]
Task 10, Epoch 13/20 => Loss -0.086, Train_accy 97.63:  65%|██████▌   | 13/20 [01:05<00:32,  4.71s/it]
Task 10, Epoch 14/20 => Loss -0.056, Train_accy 96.15:  65%|██████▌   | 13/20 [01:08<00:32,  4.71s/it]
Task 10, Epoch 14/20 => Loss -0.056, Train_accy 96.15:  70%|███████   | 14/20 [01:08<00:26,  4.36s/it]
Task 10, Epoch 15/20 => Loss -0.059, Train_accy 96.15, Test_accy 40.42:  70%|███████   | 14/20 [01:21<00:26,  4.36s/it]
Task 10, Epoch 15/20 => Loss -0.059, Train_accy 96.15, Test_accy 40.42:  75%|███████▌  | 15/20 [01:21<00:34,  6.98s/it]
Task 10, Epoch 16/20 => Loss -0.076, Train_accy 97.63:  75%|███████▌  | 15/20 [01:25<00:34,  6.98s/it]                 
Task 10, Epoch 16/20 => Loss -0.076, Train_accy 97.63:  80%|████████  | 16/20 [01:25<00:23,  5.95s/it]
Task 10, Epoch 17/20 => Loss -0.078, Train_accy 96.75:  80%|████████  | 16/20 [01:29<00:23,  5.95s/it]
Task 10, Epoch 17/20 => Loss -0.078, Train_accy 96.75:  85%|████████▌ | 17/20 [01:29<00:15,  5.25s/it]
Task 10, Epoch 18/20 => Loss -0.058, Train_accy 94.97:  85%|████████▌ | 17/20 [01:32<00:15,  5.25s/it]
Task 10, Epoch 18/20 => Loss -0.058, Train_accy 94.97:  90%|█████████ | 18/20 [01:32<00:09,  4.74s/it]
Task 10, Epoch 19/20 => Loss 0.128, Train_accy 94.67:  90%|█████████ | 18/20 [01:36<00:09,  4.74s/it] 
Task 10, Epoch 19/20 => Loss 0.128, Train_accy 94.67:  95%|█████████▌| 19/20 [01:36<00:04,  4.38s/it]
Task 10, Epoch 20/20 => Loss 0.003, Train_accy 94.67, Test_accy 40.68:  95%|█████████▌| 19/20 [01:49<00:04,  4.38s/it]
Task 10, Epoch 20/20 => Loss 0.003, Train_accy 94.67, Test_accy 40.68: 100%|██████████| 20/20 [01:49<00:00,  6.98s/it]
Task 10, Epoch 20/20 => Loss 0.003, Train_accy 94.67, Test_accy 40.68: 100%|██████████| 20/20 [01:49<00:00,  5.46s/it]
2024-09-07 12:29:55,553 [l2p.py] => Task 10, Epoch 20/20 => Loss 0.003, Train_accy 94.67, Test_accy 40.68
2024-09-07 12:30:05,108 [trainer.py] => No NME accuracy.
2024-09-07 12:30:05,109 [trainer.py] => CNN: {'total': 40.68, '00-99': 56.24, '100-109': 21.67, '110-119': 22.97, '120-129': 10.0, '130-139': 22.09, '140-149': 27.63, '150-159': 17.65, '160-169': 20.0, '170-179': 16.13, '180-189': 10.26, '190-199': 34.12, 'old': 41.07, 'new': 34.12}
2024-09-07 12:30:05,109 [trainer.py] => CNN top1 curve: [56.6, 54.94, 51.38, 48.6, 46.92, 45.53, 44.23, 42.91, 41.58, 40.79, 40.68]
2024-09-07 12:30:05,109 [trainer.py] => CNN top5 curve: [80.86, 80.58, 80.0, 77.87, 77.16, 76.11, 75.24, 73.14, 72.26, 71.83, 70.9]

Average Accuracy (CNN): 46.74
2024-09-07 12:30:05,109 [trainer.py] => Average Accuracy (CNN): 46.74 

Accuracy Matrix (CNN):
[[56.6  56.72 55.65 55.17 55.77 55.53 55.53 56.   55.41 55.65 56.24]
 [ 0.   30.   25.   25.   23.33 21.67 21.67 21.67 21.67 21.67 21.67]
 [ 0.    0.   24.32 24.32 22.97 22.97 24.32 21.62 24.32 24.32 22.97]
 [ 0.    0.    0.   10.   11.67 11.67 10.   10.   10.   10.   10.  ]
 [ 0.    0.    0.    0.   22.09 22.09 20.93 19.77 18.6  19.77 22.09]
 [ 0.    0.    0.    0.    0.   28.95 26.32 28.95 27.63 27.63 27.63]
 [ 0.    0.    0.    0.    0.    0.   19.61 19.61 19.61 19.61 17.65]
 [ 0.    0.    0.    0.    0.    0.    0.   20.   22.35 21.18 20.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   17.74 16.13 16.13]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   10.26 10.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   34.12]]
2024-09-07 12:30:05,113 [trainer.py] => Forgetting (CNN): 1.907
nohup: 忽略输入
2024-09-12 08:59:09,039 [trainer.py] => config: ./exps/dualprompt_ina_B0_Inc5.json
2024-09-12 08:59:09,039 [trainer.py] => prefix:  
2024-09-12 08:59:09,039 [trainer.py] => dataset: imageneta
2024-09-12 08:59:09,039 [trainer.py] => memory_size: 0
2024-09-12 08:59:09,039 [trainer.py] => memory_per_class: 0
2024-09-12 08:59:09,039 [trainer.py] => fixed_memory: False
2024-09-12 08:59:09,039 [trainer.py] => shuffle: True
2024-09-12 08:59:09,039 [trainer.py] => init_cls: 40
2024-09-12 08:59:09,039 [trainer.py] => increment: 40
2024-09-12 08:59:09,039 [trainer.py] => model_name: dualprompt
2024-09-12 08:59:09,039 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 08:59:09,040 [trainer.py] => get_original_backbone: True
2024-09-12 08:59:09,040 [trainer.py] => device: [device(type='cuda', index=5)]
2024-09-12 08:59:09,040 [trainer.py] => seed: 1993
2024-09-12 08:59:09,040 [trainer.py] => tuned_epoch: 20
2024-09-12 08:59:09,040 [trainer.py] => init_lr: 0.001
2024-09-12 08:59:09,040 [trainer.py] => batch_size: 48
2024-09-12 08:59:09,040 [trainer.py] => weight_decay: 0
2024-09-12 08:59:09,040 [trainer.py] => min_lr: 1e-05
2024-09-12 08:59:09,040 [trainer.py] => optimizer: adam
2024-09-12 08:59:09,040 [trainer.py] => scheduler: constant
2024-09-12 08:59:09,040 [trainer.py] => reinit_optimizer: True
2024-09-12 08:59:09,040 [trainer.py] => global_pool: token
2024-09-12 08:59:09,040 [trainer.py] => head_type: token
2024-09-12 08:59:09,040 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 08:59:09,040 [trainer.py] => pretrained: True
2024-09-12 08:59:09,040 [trainer.py] => drop: 0.0
2024-09-12 08:59:09,040 [trainer.py] => drop_path: 0.0
2024-09-12 08:59:09,041 [trainer.py] => use_g_prompt: True
2024-09-12 08:59:09,041 [trainer.py] => g_prompt_length: 5
2024-09-12 08:59:09,041 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 08:59:09,041 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 08:59:09,041 [trainer.py] => use_e_prompt: True
2024-09-12 08:59:09,041 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 08:59:09,041 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 08:59:09,041 [trainer.py] => prompt_pool: True
2024-09-12 08:59:09,041 [trainer.py] => size: 10
2024-09-12 08:59:09,041 [trainer.py] => length: 5
2024-09-12 08:59:09,041 [trainer.py] => top_k: 1
2024-09-12 08:59:09,041 [trainer.py] => initializer: uniform
2024-09-12 08:59:09,041 [trainer.py] => prompt_key: True
2024-09-12 08:59:09,041 [trainer.py] => prompt_key_init: uniform
2024-09-12 08:59:09,041 [trainer.py] => use_prompt_mask: True
2024-09-12 08:59:09,041 [trainer.py] => shared_prompt_pool: True
2024-09-12 08:59:09,041 [trainer.py] => shared_prompt_key: False
2024-09-12 08:59:09,041 [trainer.py] => batchwise_prompt: True
2024-09-12 08:59:09,042 [trainer.py] => embedding_key: cls
2024-09-12 08:59:09,042 [trainer.py] => predefined_key: 
2024-09-12 08:59:09,042 [trainer.py] => pull_constraint: True
2024-09-12 08:59:09,042 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 08:59:09,042 [trainer.py] => same_key_value: False
2024-09-12 08:59:09,782 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 08:59:12,910 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 08:59:12,911 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 08:59:12,911 [dualprompt.py] => g_prompt: 15360
2024-09-12 08:59:12,911 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 08:59:12,911 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 08:59:12,911 [dualprompt.py] => head.weight: 153600
2024-09-12 08:59:12,911 [dualprompt.py] => head.bias: 200
2024-09-12 08:59:12,912 [trainer.py] => All params: 172158352
2024-09-12 08:59:12,913 [trainer.py] => Trainable params: 407240
2024-09-12 08:59:12,913 [dualprompt.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.847, Train_accy 30.73:   0%|          | 0/20 [00:16<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.847, Train_accy 30.73:   5%|▌         | 1/20 [00:16<05:04, 16.03s/it]
Task 0, Epoch 2/20 => Loss 1.331, Train_accy 64.79:   5%|▌         | 1/20 [00:29<05:04, 16.03s/it]
Task 0, Epoch 2/20 => Loss 1.331, Train_accy 64.79:  10%|█         | 2/20 [00:29<04:25, 14.76s/it]
Task 0, Epoch 3/20 => Loss 0.886, Train_accy 77.84:  10%|█         | 2/20 [00:43<04:25, 14.76s/it]
Task 0, Epoch 3/20 => Loss 0.886, Train_accy 77.84:  15%|█▌        | 3/20 [00:43<04:01, 14.20s/it]
Task 0, Epoch 4/20 => Loss 0.655, Train_accy 82.87:  15%|█▌        | 3/20 [00:56<04:01, 14.20s/it]
Task 0, Epoch 4/20 => Loss 0.655, Train_accy 82.87:  20%|██        | 4/20 [00:56<03:39, 13.71s/it]
Task 0, Epoch 5/20 => Loss 0.592, Train_accy 84.57, Test_accy 69.72:  20%|██        | 4/20 [01:13<03:39, 13.71s/it]
Task 0, Epoch 5/20 => Loss 0.592, Train_accy 84.57, Test_accy 69.72:  25%|██▌       | 5/20 [01:13<03:44, 14.98s/it]
Task 0, Epoch 6/20 => Loss 0.488, Train_accy 87.49:  25%|██▌       | 5/20 [01:26<03:44, 14.98s/it]                 
Task 0, Epoch 6/20 => Loss 0.488, Train_accy 87.49:  30%|███       | 6/20 [01:26<03:17, 14.10s/it]
Task 0, Epoch 7/20 => Loss 0.412, Train_accy 88.85:  30%|███       | 6/20 [01:39<03:17, 14.10s/it]
Task 0, Epoch 7/20 => Loss 0.412, Train_accy 88.85:  35%|███▌      | 7/20 [01:39<02:58, 13.77s/it]
Task 0, Epoch 8/20 => Loss 0.373, Train_accy 89.60:  35%|███▌      | 7/20 [01:52<02:58, 13.77s/it]
Task 0, Epoch 8/20 => Loss 0.373, Train_accy 89.60:  40%|████      | 8/20 [01:52<02:42, 13.55s/it]
Task 0, Epoch 9/20 => Loss 0.305, Train_accy 91.84:  40%|████      | 8/20 [02:05<02:42, 13.55s/it]
Task 0, Epoch 9/20 => Loss 0.305, Train_accy 91.84:  45%|████▌     | 9/20 [02:05<02:27, 13.42s/it]
Task 0, Epoch 10/20 => Loss 0.350, Train_accy 90.41, Test_accy 69.44:  45%|████▌     | 9/20 [02:20<02:27, 13.42s/it]
Task 0, Epoch 10/20 => Loss 0.350, Train_accy 90.41, Test_accy 69.44:  50%|█████     | 10/20 [02:20<02:20, 14.04s/it]
Task 0, Epoch 11/20 => Loss 0.280, Train_accy 92.59:  50%|█████     | 10/20 [02:33<02:20, 14.04s/it]                 
Task 0, Epoch 11/20 => Loss 0.280, Train_accy 92.59:  55%|█████▌    | 11/20 [02:33<02:03, 13.70s/it]
Task 0, Epoch 12/20 => Loss 0.237, Train_accy 93.75:  55%|█████▌    | 11/20 [02:46<02:03, 13.70s/it]
Task 0, Epoch 12/20 => Loss 0.237, Train_accy 93.75:  60%|██████    | 12/20 [02:46<01:48, 13.50s/it]
Task 0, Epoch 13/20 => Loss 0.251, Train_accy 93.34:  60%|██████    | 12/20 [02:59<01:48, 13.50s/it]
Task 0, Epoch 13/20 => Loss 0.251, Train_accy 93.34:  65%|██████▌   | 13/20 [02:59<01:33, 13.35s/it]
Task 0, Epoch 14/20 => Loss 0.227, Train_accy 93.75:  65%|██████▌   | 13/20 [03:12<01:33, 13.35s/it]
Task 0, Epoch 14/20 => Loss 0.227, Train_accy 93.75:  70%|███████   | 14/20 [03:12<01:19, 13.21s/it]
Task 0, Epoch 15/20 => Loss 0.215, Train_accy 93.41, Test_accy 68.33:  70%|███████   | 14/20 [03:28<01:19, 13.21s/it]
Task 0, Epoch 15/20 => Loss 0.215, Train_accy 93.41, Test_accy 68.33:  75%|███████▌  | 15/20 [03:28<01:09, 13.89s/it]
Task 0, Epoch 16/20 => Loss 0.218, Train_accy 93.88:  75%|███████▌  | 15/20 [03:41<01:09, 13.89s/it]                 
Task 0, Epoch 16/20 => Loss 0.218, Train_accy 93.88:  80%|████████  | 16/20 [03:41<00:54, 13.62s/it]
Task 0, Epoch 17/20 => Loss 0.182, Train_accy 94.22:  80%|████████  | 16/20 [03:53<00:54, 13.62s/it]
Task 0, Epoch 17/20 => Loss 0.182, Train_accy 94.22:  85%|████████▌ | 17/20 [03:53<00:39, 13.33s/it]
Task 0, Epoch 18/20 => Loss 0.186, Train_accy 94.15:  85%|████████▌ | 17/20 [04:05<00:39, 13.33s/it]
Task 0, Epoch 18/20 => Loss 0.186, Train_accy 94.15:  90%|█████████ | 18/20 [04:05<00:25, 12.90s/it]
Task 0, Epoch 19/20 => Loss 0.221, Train_accy 93.88:  90%|█████████ | 18/20 [04:17<00:25, 12.90s/it]
Task 0, Epoch 19/20 => Loss 0.221, Train_accy 93.88:  95%|█████████▌| 19/20 [04:17<00:12, 12.58s/it]
Task 0, Epoch 20/20 => Loss 0.198, Train_accy 93.95, Test_accy 69.44:  95%|█████████▌| 19/20 [04:32<00:12, 12.58s/it]
Task 0, Epoch 20/20 => Loss 0.198, Train_accy 93.95, Test_accy 69.44: 100%|██████████| 20/20 [04:32<00:00, 13.31s/it]
Task 0, Epoch 20/20 => Loss 0.198, Train_accy 93.95, Test_accy 69.44: 100%|██████████| 20/20 [04:32<00:00, 13.62s/it]
2024-09-12 09:03:45,942 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.198, Train_accy 93.95, Test_accy 69.44
2024-09-12 09:03:48,495 [trainer.py] => No NME accuracy.
2024-09-12 09:03:48,495 [trainer.py] => CNN: {'total': 69.44, '00-39': 69.44, 'old': 0, 'new': 69.44}
2024-09-12 09:03:48,495 [trainer.py] => CNN top1 curve: [69.44]
2024-09-12 09:03:48,495 [trainer.py] => CNN top5 curve: [89.72]

Average Accuracy (CNN): 69.44
2024-09-12 09:03:48,496 [trainer.py] => Average Accuracy (CNN): 69.44 

2024-09-12 09:03:48,497 [trainer.py] => All params: 172158352
2024-09-12 09:03:48,498 [trainer.py] => Trainable params: 407240
2024-09-12 09:03:48,498 [dualprompt.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.837, Train_accy 30.19:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.837, Train_accy 30.19:   5%|▌         | 1/20 [00:12<03:52, 12.22s/it]
Task 1, Epoch 2/20 => Loss 1.148, Train_accy 69.50:   5%|▌         | 1/20 [00:23<03:52, 12.22s/it]
Task 1, Epoch 2/20 => Loss 1.148, Train_accy 69.50:  10%|█         | 2/20 [00:23<03:30, 11.70s/it]
Task 1, Epoch 3/20 => Loss 0.739, Train_accy 79.46:  10%|█         | 2/20 [00:34<03:30, 11.70s/it]
Task 1, Epoch 3/20 => Loss 0.739, Train_accy 79.46:  15%|█▌        | 3/20 [00:34<03:16, 11.58s/it]
Task 1, Epoch 4/20 => Loss 0.537, Train_accy 84.86:  15%|█▌        | 3/20 [00:46<03:16, 11.58s/it]
Task 1, Epoch 4/20 => Loss 0.537, Train_accy 84.86:  20%|██        | 4/20 [00:46<03:04, 11.54s/it]
Task 1, Epoch 5/20 => Loss 0.386, Train_accy 90.12, Test_accy 53.15:  20%|██        | 4/20 [01:02<03:04, 11.54s/it]
Task 1, Epoch 5/20 => Loss 0.386, Train_accy 90.12, Test_accy 53.15:  25%|██▌       | 5/20 [01:02<03:16, 13.12s/it]
Task 1, Epoch 6/20 => Loss 0.317, Train_accy 91.81:  25%|██▌       | 5/20 [01:13<03:16, 13.12s/it]                 
Task 1, Epoch 6/20 => Loss 0.317, Train_accy 91.81:  30%|███       | 6/20 [01:13<02:56, 12.58s/it]
Task 1, Epoch 7/20 => Loss 0.337, Train_accy 90.73:  30%|███       | 6/20 [01:25<02:56, 12.58s/it]
Task 1, Epoch 7/20 => Loss 0.337, Train_accy 90.73:  35%|███▌      | 7/20 [01:25<02:38, 12.23s/it]
Task 1, Epoch 8/20 => Loss 0.281, Train_accy 91.97:  35%|███▌      | 7/20 [01:36<02:38, 12.23s/it]
Task 1, Epoch 8/20 => Loss 0.281, Train_accy 91.97:  40%|████      | 8/20 [01:36<02:23, 11.98s/it]
Task 1, Epoch 9/20 => Loss 0.248, Train_accy 93.75:  40%|████      | 8/20 [01:48<02:23, 11.98s/it]
Task 1, Epoch 9/20 => Loss 0.248, Train_accy 93.75:  45%|████▌     | 9/20 [01:48<02:10, 11.82s/it]
Task 1, Epoch 10/20 => Loss 0.218, Train_accy 93.67, Test_accy 56.73:  45%|████▌     | 9/20 [02:04<02:10, 11.82s/it]
Task 1, Epoch 10/20 => Loss 0.218, Train_accy 93.67, Test_accy 56.73:  50%|█████     | 10/20 [02:04<02:10, 13.07s/it]
Task 1, Epoch 11/20 => Loss 0.221, Train_accy 94.44:  50%|█████     | 10/20 [02:15<02:10, 13.07s/it]                 
Task 1, Epoch 11/20 => Loss 0.221, Train_accy 94.44:  55%|█████▌    | 11/20 [02:15<01:52, 12.54s/it]
Task 1, Epoch 12/20 => Loss 0.217, Train_accy 93.90:  55%|█████▌    | 11/20 [02:26<01:52, 12.54s/it]
Task 1, Epoch 12/20 => Loss 0.217, Train_accy 93.90:  60%|██████    | 12/20 [02:26<01:35, 11.93s/it]
Task 1, Epoch 13/20 => Loss 0.196, Train_accy 94.98:  60%|██████    | 12/20 [02:36<01:35, 11.93s/it]
Task 1, Epoch 13/20 => Loss 0.196, Train_accy 94.98:  65%|██████▌   | 13/20 [02:36<01:20, 11.56s/it]
Task 1, Epoch 14/20 => Loss 0.189, Train_accy 94.52:  65%|██████▌   | 13/20 [02:47<01:20, 11.56s/it]
Task 1, Epoch 14/20 => Loss 0.189, Train_accy 94.52:  70%|███████   | 14/20 [02:47<01:07, 11.26s/it]
Task 1, Epoch 15/20 => Loss 0.194, Train_accy 94.21, Test_accy 58.17:  70%|███████   | 14/20 [03:03<01:07, 11.26s/it]
Task 1, Epoch 15/20 => Loss 0.194, Train_accy 94.21, Test_accy 58.17:  75%|███████▌  | 15/20 [03:03<01:03, 12.66s/it]
Task 1, Epoch 16/20 => Loss 0.177, Train_accy 94.90:  75%|███████▌  | 15/20 [03:14<01:03, 12.66s/it]                 
Task 1, Epoch 16/20 => Loss 0.177, Train_accy 94.90:  80%|████████  | 16/20 [03:14<00:49, 12.31s/it]
Task 1, Epoch 17/20 => Loss 0.164, Train_accy 95.44:  80%|████████  | 16/20 [03:26<00:49, 12.31s/it]
Task 1, Epoch 17/20 => Loss 0.164, Train_accy 95.44:  85%|████████▌ | 17/20 [03:26<00:36, 12.06s/it]
Task 1, Epoch 18/20 => Loss 0.178, Train_accy 94.52:  85%|████████▌ | 17/20 [03:37<00:36, 12.06s/it]
Task 1, Epoch 18/20 => Loss 0.178, Train_accy 94.52:  90%|█████████ | 18/20 [03:37<00:23, 11.90s/it]
Task 1, Epoch 19/20 => Loss 0.160, Train_accy 95.14:  90%|█████████ | 18/20 [03:49<00:23, 11.90s/it]
Task 1, Epoch 19/20 => Loss 0.160, Train_accy 95.14:  95%|█████████▌| 19/20 [03:49<00:11, 11.79s/it]
Task 1, Epoch 20/20 => Loss 0.122, Train_accy 96.22, Test_accy 58.60:  95%|█████████▌| 19/20 [04:05<00:11, 11.79s/it]
Task 1, Epoch 20/20 => Loss 0.122, Train_accy 96.22, Test_accy 58.60: 100%|██████████| 20/20 [04:05<00:00, 13.03s/it]
Task 1, Epoch 20/20 => Loss 0.122, Train_accy 96.22, Test_accy 58.60: 100%|██████████| 20/20 [04:05<00:00, 12.26s/it]
2024-09-12 09:07:53,721 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.122, Train_accy 96.22, Test_accy 58.60
2024-09-12 09:07:58,156 [trainer.py] => No NME accuracy.
2024-09-12 09:07:58,156 [trainer.py] => CNN: {'total': 58.6, '00-39': 66.11, '40-79': 50.59, 'old': 66.11, 'new': 50.59}
2024-09-12 09:07:58,156 [trainer.py] => CNN top1 curve: [69.44, 58.6]
2024-09-12 09:07:58,156 [trainer.py] => CNN top5 curve: [89.72, 84.38]

Average Accuracy (CNN): 64.02
2024-09-12 09:07:58,156 [trainer.py] => Average Accuracy (CNN): 64.02 

2024-09-12 09:07:58,158 [trainer.py] => All params: 172158352
2024-09-12 09:07:58,160 [trainer.py] => Trainable params: 407240
2024-09-12 09:07:58,160 [dualprompt.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.059, Train_accy 27.51:   0%|          | 0/20 [00:10<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.059, Train_accy 27.51:   5%|▌         | 1/20 [00:10<03:14, 10.22s/it]
Task 2, Epoch 2/20 => Loss 1.089, Train_accy 69.25:   5%|▌         | 1/20 [00:19<03:14, 10.22s/it]
Task 2, Epoch 2/20 => Loss 1.089, Train_accy 69.25:  10%|█         | 2/20 [00:19<02:53,  9.64s/it]
Task 2, Epoch 3/20 => Loss 0.589, Train_accy 84.24:  10%|█         | 2/20 [00:28<02:53,  9.64s/it]
Task 2, Epoch 3/20 => Loss 0.589, Train_accy 84.24:  15%|█▌        | 3/20 [00:28<02:41,  9.53s/it]
Task 2, Epoch 4/20 => Loss 0.423, Train_accy 88.73:  15%|█▌        | 3/20 [00:38<02:41,  9.53s/it]
Task 2, Epoch 4/20 => Loss 0.423, Train_accy 88.73:  20%|██        | 4/20 [00:38<02:31,  9.46s/it]
Task 2, Epoch 5/20 => Loss 0.376, Train_accy 90.16, Test_accy 49.03:  20%|██        | 4/20 [00:53<02:31,  9.46s/it]
Task 2, Epoch 5/20 => Loss 0.376, Train_accy 90.16, Test_accy 49.03:  25%|██▌       | 5/20 [00:53<02:53, 11.55s/it]
Task 2, Epoch 6/20 => Loss 0.351, Train_accy 91.12:  25%|██▌       | 5/20 [01:02<02:53, 11.55s/it]                 
Task 2, Epoch 6/20 => Loss 0.351, Train_accy 91.12:  30%|███       | 6/20 [01:02<02:31, 10.79s/it]
Task 2, Epoch 7/20 => Loss 0.275, Train_accy 92.55:  30%|███       | 6/20 [01:11<02:31, 10.79s/it]
Task 2, Epoch 7/20 => Loss 0.275, Train_accy 92.55:  35%|███▌      | 7/20 [01:11<02:11, 10.15s/it]
Task 2, Epoch 8/20 => Loss 0.238, Train_accy 93.41:  35%|███▌      | 7/20 [01:20<02:11, 10.15s/it]
Task 2, Epoch 8/20 => Loss 0.238, Train_accy 93.41:  40%|████      | 8/20 [01:20<01:55,  9.63s/it]
Task 2, Epoch 9/20 => Loss 0.215, Train_accy 94.36:  40%|████      | 8/20 [01:28<01:55,  9.63s/it]
Task 2, Epoch 9/20 => Loss 0.215, Train_accy 94.36:  45%|████▌     | 9/20 [01:28<01:42,  9.30s/it]
Task 2, Epoch 10/20 => Loss 0.217, Train_accy 94.46, Test_accy 50.36:  45%|████▌     | 9/20 [01:43<01:42,  9.30s/it]
Task 2, Epoch 10/20 => Loss 0.217, Train_accy 94.46, Test_accy 50.36:  50%|█████     | 10/20 [01:43<01:49, 10.91s/it]
Task 2, Epoch 11/20 => Loss 0.205, Train_accy 94.27:  50%|█████     | 10/20 [01:52<01:49, 10.91s/it]                 
Task 2, Epoch 11/20 => Loss 0.205, Train_accy 94.27:  55%|█████▌    | 11/20 [01:52<01:33, 10.40s/it]
Task 2, Epoch 12/20 => Loss 0.202, Train_accy 94.46:  55%|█████▌    | 11/20 [02:01<01:33, 10.40s/it]
Task 2, Epoch 12/20 => Loss 0.202, Train_accy 94.46:  60%|██████    | 12/20 [02:01<01:20, 10.07s/it]
Task 2, Epoch 13/20 => Loss 0.187, Train_accy 94.36:  60%|██████    | 12/20 [02:11<01:20, 10.07s/it]
Task 2, Epoch 13/20 => Loss 0.187, Train_accy 94.36:  65%|██████▌   | 13/20 [02:11<01:09,  9.87s/it]
Task 2, Epoch 14/20 => Loss 0.134, Train_accy 96.28:  65%|██████▌   | 13/20 [02:20<01:09,  9.87s/it]
Task 2, Epoch 14/20 => Loss 0.134, Train_accy 96.28:  70%|███████   | 14/20 [02:20<00:58,  9.74s/it]
Task 2, Epoch 15/20 => Loss 0.151, Train_accy 95.51, Test_accy 51.59:  70%|███████   | 14/20 [02:36<00:58,  9.74s/it]
Task 2, Epoch 15/20 => Loss 0.151, Train_accy 95.51, Test_accy 51.59:  75%|███████▌  | 15/20 [02:36<00:57, 11.47s/it]
Task 2, Epoch 16/20 => Loss 0.156, Train_accy 95.22:  75%|███████▌  | 15/20 [02:45<00:57, 11.47s/it]                 
Task 2, Epoch 16/20 => Loss 0.156, Train_accy 95.22:  80%|████████  | 16/20 [02:45<00:43, 10.84s/it]
Task 2, Epoch 17/20 => Loss 0.144, Train_accy 95.51:  80%|████████  | 16/20 [02:54<00:43, 10.84s/it]
Task 2, Epoch 17/20 => Loss 0.144, Train_accy 95.51:  85%|████████▌ | 17/20 [02:54<00:31, 10.40s/it]
Task 2, Epoch 18/20 => Loss 0.135, Train_accy 96.08:  85%|████████▌ | 17/20 [03:04<00:31, 10.40s/it]
Task 2, Epoch 18/20 => Loss 0.135, Train_accy 96.08:  90%|█████████ | 18/20 [03:04<00:20, 10.12s/it]
Task 2, Epoch 19/20 => Loss 0.137, Train_accy 95.51:  90%|█████████ | 18/20 [03:13<00:20, 10.12s/it]
Task 2, Epoch 19/20 => Loss 0.137, Train_accy 95.51:  95%|█████████▌| 19/20 [03:13<00:09,  9.90s/it]
Task 2, Epoch 20/20 => Loss 0.136, Train_accy 95.51, Test_accy 52.00:  95%|█████████▌| 19/20 [03:29<00:09,  9.90s/it]
Task 2, Epoch 20/20 => Loss 0.136, Train_accy 95.51, Test_accy 52.00: 100%|██████████| 20/20 [03:29<00:00, 11.54s/it]
Task 2, Epoch 20/20 => Loss 0.136, Train_accy 95.51, Test_accy 52.00: 100%|██████████| 20/20 [03:29<00:00, 10.45s/it]
2024-09-12 09:11:27,236 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.136, Train_accy 95.51, Test_accy 52.00
2024-09-12 09:11:33,198 [trainer.py] => No NME accuracy.
2024-09-12 09:11:33,199 [trainer.py] => CNN: {'total': 52.0, '00-39': 65.0, '40-79': 45.86, '80-119': 42.6, 'old': 55.73, 'new': 42.6}
2024-09-12 09:11:33,199 [trainer.py] => CNN top1 curve: [69.44, 58.6, 52.0]
2024-09-12 09:11:33,199 [trainer.py] => CNN top5 curve: [89.72, 84.38, 79.49]

Average Accuracy (CNN): 60.01
2024-09-12 09:11:33,199 [trainer.py] => Average Accuracy (CNN): 60.01 

2024-09-12 09:11:33,202 [trainer.py] => All params: 172158352
2024-09-12 09:11:33,204 [trainer.py] => Trainable params: 407240
2024-09-12 09:11:33,204 [dualprompt.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.530, Train_accy 18.79:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.530, Train_accy 18.79:   5%|▌         | 1/20 [00:10<03:13, 10.18s/it]
Task 3, Epoch 2/20 => Loss 1.310, Train_accy 65.42:   5%|▌         | 1/20 [00:19<03:13, 10.18s/it]
Task 3, Epoch 2/20 => Loss 1.310, Train_accy 65.42:  10%|█         | 2/20 [00:19<02:56,  9.83s/it]
Task 3, Epoch 3/20 => Loss 0.763, Train_accy 79.07:  10%|█         | 2/20 [00:29<02:56,  9.83s/it]
Task 3, Epoch 3/20 => Loss 0.763, Train_accy 79.07:  15%|█▌        | 3/20 [00:29<02:44,  9.67s/it]
Task 3, Epoch 4/20 => Loss 0.524, Train_accy 85.98:  15%|█▌        | 3/20 [00:38<02:44,  9.67s/it]
Task 3, Epoch 4/20 => Loss 0.524, Train_accy 85.98:  20%|██        | 4/20 [00:38<02:29,  9.37s/it]
Task 3, Epoch 5/20 => Loss 0.391, Train_accy 89.44, Test_accy 45.59:  20%|██        | 4/20 [00:53<02:29,  9.37s/it]
Task 3, Epoch 5/20 => Loss 0.391, Train_accy 89.44, Test_accy 45.59:  25%|██▌       | 5/20 [00:53<02:55, 11.69s/it]
Task 3, Epoch 6/20 => Loss 0.311, Train_accy 91.78:  25%|██▌       | 5/20 [01:02<02:55, 11.69s/it]                 
Task 3, Epoch 6/20 => Loss 0.311, Train_accy 91.78:  30%|███       | 6/20 [01:02<02:29, 10.68s/it]
Task 3, Epoch 7/20 => Loss 0.297, Train_accy 92.34:  30%|███       | 6/20 [01:12<02:29, 10.68s/it]
Task 3, Epoch 7/20 => Loss 0.297, Train_accy 92.34:  35%|███▌      | 7/20 [01:12<02:13, 10.30s/it]
Task 3, Epoch 8/20 => Loss 0.254, Train_accy 93.83:  35%|███▌      | 7/20 [01:21<02:13, 10.30s/it]
Task 3, Epoch 8/20 => Loss 0.254, Train_accy 93.83:  40%|████      | 8/20 [01:21<02:00, 10.05s/it]
Task 3, Epoch 9/20 => Loss 0.250, Train_accy 93.74:  40%|████      | 8/20 [01:31<02:00, 10.05s/it]
Task 3, Epoch 9/20 => Loss 0.250, Train_accy 93.74:  45%|████▌     | 9/20 [01:31<01:48,  9.89s/it]
Task 3, Epoch 10/20 => Loss 0.227, Train_accy 94.77, Test_accy 46.47:  45%|████▌     | 9/20 [01:48<01:48,  9.89s/it]
Task 3, Epoch 10/20 => Loss 0.227, Train_accy 94.77, Test_accy 46.47:  50%|█████     | 10/20 [01:48<02:01, 12.12s/it]
Task 3, Epoch 11/20 => Loss 0.202, Train_accy 94.30:  50%|█████     | 10/20 [01:57<02:01, 12.12s/it]                 
Task 3, Epoch 11/20 => Loss 0.202, Train_accy 94.30:  55%|█████▌    | 11/20 [01:57<01:41, 11.31s/it]
Task 3, Epoch 12/20 => Loss 0.193, Train_accy 95.33:  55%|█████▌    | 11/20 [02:07<01:41, 11.31s/it]
Task 3, Epoch 12/20 => Loss 0.193, Train_accy 95.33:  60%|██████    | 12/20 [02:07<01:26, 10.76s/it]
Task 3, Epoch 13/20 => Loss 0.193, Train_accy 95.61:  60%|██████    | 12/20 [02:16<01:26, 10.76s/it]
Task 3, Epoch 13/20 => Loss 0.193, Train_accy 95.61:  65%|██████▌   | 13/20 [02:16<01:12, 10.35s/it]
Task 3, Epoch 14/20 => Loss 0.172, Train_accy 95.05:  65%|██████▌   | 13/20 [02:26<01:12, 10.35s/it]
Task 3, Epoch 14/20 => Loss 0.172, Train_accy 95.05:  70%|███████   | 14/20 [02:26<01:01, 10.18s/it]
Task 3, Epoch 15/20 => Loss 0.198, Train_accy 94.39, Test_accy 46.88:  70%|███████   | 14/20 [02:43<01:01, 10.18s/it]
Task 3, Epoch 15/20 => Loss 0.198, Train_accy 94.39, Test_accy 46.88:  75%|███████▌  | 15/20 [02:43<01:01, 12.29s/it]
Task 3, Epoch 16/20 => Loss 0.154, Train_accy 95.23:  75%|███████▌  | 15/20 [02:53<01:01, 12.29s/it]                 
Task 3, Epoch 16/20 => Loss 0.154, Train_accy 95.23:  80%|████████  | 16/20 [02:53<00:45, 11.43s/it]
Task 3, Epoch 17/20 => Loss 0.158, Train_accy 94.95:  80%|████████  | 16/20 [03:02<00:45, 11.43s/it]
Task 3, Epoch 17/20 => Loss 0.158, Train_accy 94.95:  85%|████████▌ | 17/20 [03:02<00:32, 10.85s/it]
Task 3, Epoch 18/20 => Loss 0.151, Train_accy 95.79:  85%|████████▌ | 17/20 [03:12<00:32, 10.85s/it]
Task 3, Epoch 18/20 => Loss 0.151, Train_accy 95.79:  90%|█████████ | 18/20 [03:12<00:20, 10.45s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 96.07:  90%|█████████ | 18/20 [03:21<00:20, 10.45s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 96.07:  95%|█████████▌| 19/20 [03:21<00:10, 10.22s/it]
Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.07, Test_accy 46.55:  95%|█████████▌| 19/20 [03:38<00:10, 10.22s/it]
Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.07, Test_accy 46.55: 100%|██████████| 20/20 [03:38<00:00, 12.18s/it]
Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.07, Test_accy 46.55: 100%|██████████| 20/20 [03:38<00:00, 10.93s/it]
2024-09-12 09:15:11,798 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.07, Test_accy 46.55
2024-09-12 09:15:19,102 [trainer.py] => No NME accuracy.
2024-09-12 09:15:19,102 [trainer.py] => CNN: {'total': 46.55, '00-39': 62.22, '40-79': 43.79, '80-119': 41.16, '120-159': 34.8, 'old': 49.85, 'new': 34.8}
2024-09-12 09:15:19,102 [trainer.py] => CNN top1 curve: [69.44, 58.6, 52.0, 46.55]
2024-09-12 09:15:19,102 [trainer.py] => CNN top5 curve: [89.72, 84.38, 79.49, 73.96]

Average Accuracy (CNN): 56.65
2024-09-12 09:15:19,102 [trainer.py] => Average Accuracy (CNN): 56.65 

2024-09-12 09:15:19,104 [trainer.py] => All params: 172158352
2024-09-12 09:15:19,106 [trainer.py] => Trainable params: 407240
2024-09-12 09:15:19,106 [dualprompt.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.414, Train_accy 21.13:   0%|          | 0/20 [00:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.414, Train_accy 21.13:   5%|▌         | 1/20 [00:09<03:07,  9.86s/it]
Task 4, Epoch 2/20 => Loss 1.231, Train_accy 65.12:   5%|▌         | 1/20 [00:18<03:07,  9.86s/it]
Task 4, Epoch 2/20 => Loss 1.231, Train_accy 65.12:  10%|█         | 2/20 [00:18<02:48,  9.35s/it]
Task 4, Epoch 3/20 => Loss 0.718, Train_accy 79.69:  10%|█         | 2/20 [00:28<02:48,  9.35s/it]
Task 4, Epoch 3/20 => Loss 0.718, Train_accy 79.69:  15%|█▌        | 3/20 [00:28<02:41,  9.47s/it]
Task 4, Epoch 4/20 => Loss 0.479, Train_accy 87.43:  15%|█▌        | 3/20 [00:38<02:41,  9.47s/it]
Task 4, Epoch 4/20 => Loss 0.479, Train_accy 87.43:  20%|██        | 4/20 [00:38<02:34,  9.63s/it]
Task 4, Epoch 5/20 => Loss 0.366, Train_accy 90.89, Test_accy 41.08:  20%|██        | 4/20 [00:57<02:34,  9.63s/it]
Task 4, Epoch 5/20 => Loss 0.366, Train_accy 90.89, Test_accy 41.08:  25%|██▌       | 5/20 [00:57<03:15, 13.00s/it]
Task 4, Epoch 6/20 => Loss 0.337, Train_accy 91.71:  25%|██▌       | 5/20 [01:07<03:15, 13.00s/it]                 
Task 4, Epoch 6/20 => Loss 0.337, Train_accy 91.71:  30%|███       | 6/20 [01:07<02:46, 11.88s/it]
Task 4, Epoch 7/20 => Loss 0.299, Train_accy 92.26:  30%|███       | 6/20 [01:16<02:46, 11.88s/it]
Task 4, Epoch 7/20 => Loss 0.299, Train_accy 92.26:  35%|███▌      | 7/20 [01:16<02:25, 11.22s/it]
Task 4, Epoch 8/20 => Loss 0.258, Train_accy 92.99:  35%|███▌      | 7/20 [01:26<02:25, 11.22s/it]
Task 4, Epoch 8/20 => Loss 0.258, Train_accy 92.99:  40%|████      | 8/20 [01:26<02:09, 10.83s/it]
Task 4, Epoch 9/20 => Loss 0.288, Train_accy 92.53:  40%|████      | 8/20 [01:36<02:09, 10.83s/it]
Task 4, Epoch 9/20 => Loss 0.288, Train_accy 92.53:  45%|████▌     | 9/20 [01:36<01:55, 10.51s/it]
Task 4, Epoch 10/20 => Loss 0.189, Train_accy 95.72, Test_accy 42.00:  45%|████▌     | 9/20 [01:55<01:55, 10.51s/it]
Task 4, Epoch 10/20 => Loss 0.189, Train_accy 95.72, Test_accy 42.00:  50%|█████     | 10/20 [01:55<02:10, 13.05s/it]
Task 4, Epoch 11/20 => Loss 0.174, Train_accy 94.90:  50%|█████     | 10/20 [02:05<02:10, 13.05s/it]                 
Task 4, Epoch 11/20 => Loss 0.174, Train_accy 94.90:  55%|█████▌    | 11/20 [02:05<01:48, 12.06s/it]
Task 4, Epoch 12/20 => Loss 0.196, Train_accy 93.99:  55%|█████▌    | 11/20 [02:15<01:48, 12.06s/it]
Task 4, Epoch 12/20 => Loss 0.196, Train_accy 93.99:  60%|██████    | 12/20 [02:15<01:31, 11.39s/it]
Task 4, Epoch 13/20 => Loss 0.172, Train_accy 95.63:  60%|██████    | 12/20 [02:25<01:31, 11.39s/it]
Task 4, Epoch 13/20 => Loss 0.172, Train_accy 95.63:  65%|██████▌   | 13/20 [02:25<01:16, 10.96s/it]
Task 4, Epoch 14/20 => Loss 0.189, Train_accy 94.99:  65%|██████▌   | 13/20 [02:34<01:16, 10.96s/it]
Task 4, Epoch 14/20 => Loss 0.189, Train_accy 94.99:  70%|███████   | 14/20 [02:34<01:03, 10.63s/it]
Task 4, Epoch 15/20 => Loss 0.156, Train_accy 95.36, Test_accy 42.66:  70%|███████   | 14/20 [02:54<01:03, 10.63s/it]
Task 4, Epoch 15/20 => Loss 0.156, Train_accy 95.36, Test_accy 42.66:  75%|███████▌  | 15/20 [02:54<01:06, 13.21s/it]
Task 4, Epoch 16/20 => Loss 0.163, Train_accy 94.99:  75%|███████▌  | 15/20 [03:03<01:06, 13.21s/it]                 
Task 4, Epoch 16/20 => Loss 0.163, Train_accy 94.99:  80%|████████  | 16/20 [03:03<00:48, 12.07s/it]
Task 4, Epoch 17/20 => Loss 0.137, Train_accy 95.99:  80%|████████  | 16/20 [03:12<00:48, 12.07s/it]
Task 4, Epoch 17/20 => Loss 0.137, Train_accy 95.99:  85%|████████▌ | 17/20 [03:12<00:33, 11.14s/it]
Task 4, Epoch 18/20 => Loss 0.128, Train_accy 96.54:  85%|████████▌ | 17/20 [03:21<00:33, 11.14s/it]
Task 4, Epoch 18/20 => Loss 0.128, Train_accy 96.54:  90%|█████████ | 18/20 [03:21<00:21, 10.55s/it]
Task 4, Epoch 19/20 => Loss 0.114, Train_accy 95.99:  90%|█████████ | 18/20 [03:30<00:21, 10.55s/it]
Task 4, Epoch 19/20 => Loss 0.114, Train_accy 95.99:  95%|█████████▌| 19/20 [03:30<00:10, 10.09s/it]
Task 4, Epoch 20/20 => Loss 0.123, Train_accy 95.72, Test_accy 43.45:  95%|█████████▌| 19/20 [03:49<00:10, 10.09s/it]
Task 4, Epoch 20/20 => Loss 0.123, Train_accy 95.72, Test_accy 43.45: 100%|██████████| 20/20 [03:49<00:00, 12.77s/it]
Task 4, Epoch 20/20 => Loss 0.123, Train_accy 95.72, Test_accy 43.45: 100%|██████████| 20/20 [03:49<00:00, 11.49s/it]
2024-09-12 09:19:08,856 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.123, Train_accy 95.72, Test_accy 43.45
2024-09-12 09:19:18,046 [trainer.py] => No NME accuracy.
2024-09-12 09:19:18,047 [trainer.py] => CNN: {'total': 43.45, '00-39': 63.06, '40-79': 41.42, '80-119': 38.63, '120-159': 33.33, '160-199': 35.06, 'old': 45.27, 'new': 35.06}
2024-09-12 09:19:18,047 [trainer.py] => CNN top1 curve: [69.44, 58.6, 52.0, 46.55, 43.45]
2024-09-12 09:19:18,047 [trainer.py] => CNN top5 curve: [89.72, 84.38, 79.49, 73.96, 71.3]

Average Accuracy (CNN): 54.01
2024-09-12 09:19:18,047 [trainer.py] => Average Accuracy (CNN): 54.01 

Accuracy Matrix (CNN):
[[69.44 66.11 65.   62.22 63.06]
 [ 0.   50.59 45.86 43.79 41.42]
 [ 0.    0.   42.6  41.16 38.63]
 [ 0.    0.    0.   34.8  33.33]
 [ 0.    0.    0.    0.   35.06]]
2024-09-12 09:19:18,049 [trainer.py] => Forgetting (CNN): 5.247499999999999
2024-09-12 09:19:21,007 [trainer.py] => config: ./exps/dualprompt_ina_B0_Inc10.json
2024-09-12 09:19:21,007 [trainer.py] => prefix:  
2024-09-12 09:19:21,007 [trainer.py] => dataset: imageneta
2024-09-12 09:19:21,007 [trainer.py] => memory_size: 0
2024-09-12 09:19:21,007 [trainer.py] => memory_per_class: 0
2024-09-12 09:19:21,007 [trainer.py] => fixed_memory: False
2024-09-12 09:19:21,007 [trainer.py] => shuffle: True
2024-09-12 09:19:21,007 [trainer.py] => init_cls: 20
2024-09-12 09:19:21,007 [trainer.py] => increment: 20
2024-09-12 09:19:21,007 [trainer.py] => model_name: dualprompt
2024-09-12 09:19:21,007 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 09:19:21,007 [trainer.py] => get_original_backbone: True
2024-09-12 09:19:21,007 [trainer.py] => device: [device(type='cuda', index=5)]
2024-09-12 09:19:21,007 [trainer.py] => seed: 1993
2024-09-12 09:19:21,007 [trainer.py] => tuned_epoch: 20
2024-09-12 09:19:21,007 [trainer.py] => init_lr: 0.001
2024-09-12 09:19:21,007 [trainer.py] => batch_size: 48
2024-09-12 09:19:21,007 [trainer.py] => weight_decay: 0
2024-09-12 09:19:21,007 [trainer.py] => min_lr: 1e-05
2024-09-12 09:19:21,007 [trainer.py] => optimizer: adam
2024-09-12 09:19:21,007 [trainer.py] => scheduler: constant
2024-09-12 09:19:21,007 [trainer.py] => reinit_optimizer: True
2024-09-12 09:19:21,007 [trainer.py] => global_pool: token
2024-09-12 09:19:21,007 [trainer.py] => head_type: token
2024-09-12 09:19:21,007 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 09:19:21,007 [trainer.py] => pretrained: True
2024-09-12 09:19:21,008 [trainer.py] => drop: 0.0
2024-09-12 09:19:21,008 [trainer.py] => drop_path: 0.0
2024-09-12 09:19:21,008 [trainer.py] => use_g_prompt: True
2024-09-12 09:19:21,008 [trainer.py] => g_prompt_length: 5
2024-09-12 09:19:21,008 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 09:19:21,008 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 09:19:21,008 [trainer.py] => use_e_prompt: True
2024-09-12 09:19:21,008 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 09:19:21,008 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 09:19:21,008 [trainer.py] => prompt_pool: True
2024-09-12 09:19:21,008 [trainer.py] => size: 10
2024-09-12 09:19:21,008 [trainer.py] => length: 5
2024-09-12 09:19:21,008 [trainer.py] => top_k: 1
2024-09-12 09:19:21,008 [trainer.py] => initializer: uniform
2024-09-12 09:19:21,008 [trainer.py] => prompt_key: True
2024-09-12 09:19:21,008 [trainer.py] => prompt_key_init: uniform
2024-09-12 09:19:21,008 [trainer.py] => use_prompt_mask: True
2024-09-12 09:19:21,008 [trainer.py] => shared_prompt_pool: True
2024-09-12 09:19:21,008 [trainer.py] => shared_prompt_key: False
2024-09-12 09:19:21,008 [trainer.py] => batchwise_prompt: True
2024-09-12 09:19:21,008 [trainer.py] => embedding_key: cls
2024-09-12 09:19:21,008 [trainer.py] => predefined_key: 
2024-09-12 09:19:21,008 [trainer.py] => pull_constraint: True
2024-09-12 09:19:21,008 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 09:19:21,008 [trainer.py] => same_key_value: False
2024-09-12 09:19:21,035 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 09:19:25,126 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 09:19:25,126 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 09:19:25,126 [dualprompt.py] => g_prompt: 15360
2024-09-12 09:19:25,126 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 09:19:25,126 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 09:19:25,127 [dualprompt.py] => head.weight: 153600
2024-09-12 09:19:25,127 [dualprompt.py] => head.bias: 200
2024-09-12 09:19:25,128 [trainer.py] => All params: 172158352
2024-09-12 09:19:25,128 [trainer.py] => Trainable params: 407240
2024-09-12 09:19:25,129 [dualprompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.430, Train_accy 32.48:   0%|          | 0/20 [00:06<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.430, Train_accy 32.48:   5%|▌         | 1/20 [00:06<02:07,  6.69s/it]
Task 0, Epoch 2/20 => Loss 1.172, Train_accy 65.96:   5%|▌         | 1/20 [00:13<02:07,  6.69s/it]
Task 0, Epoch 2/20 => Loss 1.172, Train_accy 65.96:  10%|█         | 2/20 [00:13<01:57,  6.50s/it]
Task 0, Epoch 3/20 => Loss 0.703, Train_accy 80.85:  10%|█         | 2/20 [00:19<01:57,  6.50s/it]
Task 0, Epoch 3/20 => Loss 0.703, Train_accy 80.85:  15%|█▌        | 3/20 [00:19<01:49,  6.46s/it]
Task 0, Epoch 4/20 => Loss 0.480, Train_accy 88.51:  15%|█▌        | 3/20 [00:25<01:49,  6.46s/it]
Task 0, Epoch 4/20 => Loss 0.480, Train_accy 88.51:  20%|██        | 4/20 [00:25<01:43,  6.46s/it]
Task 0, Epoch 5/20 => Loss 0.438, Train_accy 88.23, Test_accy 75.43:  20%|██        | 4/20 [00:33<01:43,  6.46s/it]
Task 0, Epoch 5/20 => Loss 0.438, Train_accy 88.23, Test_accy 75.43:  25%|██▌       | 5/20 [00:33<01:44,  6.94s/it]
Task 0, Epoch 6/20 => Loss 0.331, Train_accy 91.06:  25%|██▌       | 5/20 [00:40<01:44,  6.94s/it]                 
Task 0, Epoch 6/20 => Loss 0.331, Train_accy 91.06:  30%|███       | 6/20 [00:40<01:34,  6.75s/it]
Task 0, Epoch 7/20 => Loss 0.325, Train_accy 92.20:  30%|███       | 6/20 [00:46<01:34,  6.75s/it]
Task 0, Epoch 7/20 => Loss 0.325, Train_accy 92.20:  35%|███▌      | 7/20 [00:46<01:26,  6.63s/it]
Task 0, Epoch 8/20 => Loss 0.254, Train_accy 94.18:  35%|███▌      | 7/20 [00:52<01:26,  6.63s/it]
Task 0, Epoch 8/20 => Loss 0.254, Train_accy 94.18:  40%|████      | 8/20 [00:52<01:18,  6.57s/it]
Task 0, Epoch 9/20 => Loss 0.268, Train_accy 92.48:  40%|████      | 8/20 [00:59<01:18,  6.57s/it]
Task 0, Epoch 9/20 => Loss 0.268, Train_accy 92.48:  45%|████▌     | 9/20 [00:59<01:11,  6.53s/it]
Task 0, Epoch 10/20 => Loss 0.226, Train_accy 94.33, Test_accy 76.57:  45%|████▌     | 9/20 [01:07<01:11,  6.53s/it]
Task 0, Epoch 10/20 => Loss 0.226, Train_accy 94.33, Test_accy 76.57:  50%|█████     | 10/20 [01:07<01:09,  6.95s/it]
Task 0, Epoch 11/20 => Loss 0.196, Train_accy 95.18:  50%|█████     | 10/20 [01:13<01:09,  6.95s/it]                 
Task 0, Epoch 11/20 => Loss 0.196, Train_accy 95.18:  55%|█████▌    | 11/20 [01:13<01:01,  6.81s/it]
Task 0, Epoch 12/20 => Loss 0.192, Train_accy 94.61:  55%|█████▌    | 11/20 [01:20<01:01,  6.81s/it]
Task 0, Epoch 12/20 => Loss 0.192, Train_accy 94.61:  60%|██████    | 12/20 [01:20<00:53,  6.71s/it]
Task 0, Epoch 13/20 => Loss 0.186, Train_accy 94.47:  60%|██████    | 12/20 [01:26<00:53,  6.71s/it]
Task 0, Epoch 13/20 => Loss 0.186, Train_accy 94.47:  65%|██████▌   | 13/20 [01:26<00:46,  6.63s/it]
Task 0, Epoch 14/20 => Loss 0.182, Train_accy 93.62:  65%|██████▌   | 13/20 [01:33<00:46,  6.63s/it]
Task 0, Epoch 14/20 => Loss 0.182, Train_accy 93.62:  70%|███████   | 14/20 [01:33<00:39,  6.57s/it]
Task 0, Epoch 15/20 => Loss 0.174, Train_accy 95.18, Test_accy 76.57:  70%|███████   | 14/20 [01:41<00:39,  6.57s/it]
Task 0, Epoch 15/20 => Loss 0.174, Train_accy 95.18, Test_accy 76.57:  75%|███████▌  | 15/20 [01:41<00:34,  6.99s/it]
Task 0, Epoch 16/20 => Loss 0.159, Train_accy 95.89:  75%|███████▌  | 15/20 [01:47<00:34,  6.99s/it]                 
Task 0, Epoch 16/20 => Loss 0.159, Train_accy 95.89:  80%|████████  | 16/20 [01:47<00:27,  6.81s/it]
Task 0, Epoch 17/20 => Loss 0.157, Train_accy 94.89:  80%|████████  | 16/20 [01:53<00:27,  6.81s/it]
Task 0, Epoch 17/20 => Loss 0.157, Train_accy 94.89:  85%|████████▌ | 17/20 [01:53<00:20,  6.69s/it]
Task 0, Epoch 18/20 => Loss 0.135, Train_accy 96.31:  85%|████████▌ | 17/20 [01:59<00:20,  6.69s/it]
Task 0, Epoch 18/20 => Loss 0.135, Train_accy 96.31:  90%|█████████ | 18/20 [01:59<00:12,  6.46s/it]
Task 0, Epoch 19/20 => Loss 0.114, Train_accy 96.45:  90%|█████████ | 18/20 [02:05<00:12,  6.46s/it]
Task 0, Epoch 19/20 => Loss 0.114, Train_accy 96.45:  95%|█████████▌| 19/20 [02:05<00:06,  6.32s/it]
Task 0, Epoch 20/20 => Loss 0.111, Train_accy 96.17, Test_accy 76.00:  95%|█████████▌| 19/20 [02:13<00:06,  6.32s/it]
Task 0, Epoch 20/20 => Loss 0.111, Train_accy 96.17, Test_accy 76.00: 100%|██████████| 20/20 [02:13<00:00,  6.64s/it]
Task 0, Epoch 20/20 => Loss 0.111, Train_accy 96.17, Test_accy 76.00: 100%|██████████| 20/20 [02:13<00:00,  6.66s/it]
2024-09-12 09:21:38,845 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.111, Train_accy 96.17, Test_accy 76.00
2024-09-12 09:21:40,208 [trainer.py] => No NME accuracy.
2024-09-12 09:21:40,208 [trainer.py] => CNN: {'total': 76.0, '00-19': 76.0, 'old': 0, 'new': 76.0}
2024-09-12 09:21:40,208 [trainer.py] => CNN top1 curve: [76.0]
2024-09-12 09:21:40,208 [trainer.py] => CNN top5 curve: [92.57]

Average Accuracy (CNN): 76.0
2024-09-12 09:21:40,208 [trainer.py] => Average Accuracy (CNN): 76.0 

2024-09-12 09:21:40,211 [trainer.py] => All params: 172158352
2024-09-12 09:21:40,212 [trainer.py] => Trainable params: 407240
2024-09-12 09:21:40,213 [dualprompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.844, Train_accy 21.67:   0%|          | 0/20 [00:06<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.844, Train_accy 21.67:   5%|▌         | 1/20 [00:06<02:02,  6.47s/it]
Task 1, Epoch 2/20 => Loss 1.316, Train_accy 62.40:   5%|▌         | 1/20 [00:13<02:02,  6.47s/it]
Task 1, Epoch 2/20 => Loss 1.316, Train_accy 62.40:  10%|█         | 2/20 [00:13<01:57,  6.52s/it]
Task 1, Epoch 3/20 => Loss 0.801, Train_accy 77.42:  10%|█         | 2/20 [00:20<01:57,  6.52s/it]
Task 1, Epoch 3/20 => Loss 0.801, Train_accy 77.42:  15%|█▌        | 3/20 [00:20<01:55,  6.77s/it]
Task 1, Epoch 4/20 => Loss 0.623, Train_accy 82.77:  15%|█▌        | 3/20 [00:27<01:55,  6.77s/it]
Task 1, Epoch 4/20 => Loss 0.623, Train_accy 82.77:  20%|██        | 4/20 [00:27<01:49,  6.86s/it]
Task 1, Epoch 5/20 => Loss 0.476, Train_accy 86.55, Test_accy 64.17:  20%|██        | 4/20 [00:36<01:49,  6.86s/it]
Task 1, Epoch 5/20 => Loss 0.476, Train_accy 86.55, Test_accy 64.17:  25%|██▌       | 5/20 [00:36<01:57,  7.86s/it]
Task 1, Epoch 6/20 => Loss 0.459, Train_accy 86.42:  25%|██▌       | 5/20 [00:43<01:57,  7.86s/it]                 
Task 1, Epoch 6/20 => Loss 0.459, Train_accy 86.42:  30%|███       | 6/20 [00:43<01:45,  7.56s/it]
Task 1, Epoch 7/20 => Loss 0.391, Train_accy 88.90:  30%|███       | 6/20 [00:50<01:45,  7.56s/it]
Task 1, Epoch 7/20 => Loss 0.391, Train_accy 88.90:  35%|███▌      | 7/20 [00:50<01:35,  7.38s/it]
Task 1, Epoch 8/20 => Loss 0.309, Train_accy 91.51:  35%|███▌      | 7/20 [00:57<01:35,  7.38s/it]
Task 1, Epoch 8/20 => Loss 0.309, Train_accy 91.51:  40%|████      | 8/20 [00:57<01:27,  7.26s/it]
Task 1, Epoch 9/20 => Loss 0.306, Train_accy 92.17:  40%|████      | 8/20 [01:04<01:27,  7.26s/it]
Task 1, Epoch 9/20 => Loss 0.306, Train_accy 92.17:  45%|████▌     | 9/20 [01:04<01:18,  7.17s/it]
Task 1, Epoch 10/20 => Loss 0.305, Train_accy 92.04, Test_accy 67.50:  45%|████▌     | 9/20 [01:14<01:18,  7.17s/it]
Task 1, Epoch 10/20 => Loss 0.305, Train_accy 92.04, Test_accy 67.50:  50%|█████     | 10/20 [01:14<01:18,  7.89s/it]
Task 1, Epoch 11/20 => Loss 0.244, Train_accy 93.47:  50%|█████     | 10/20 [01:21<01:18,  7.89s/it]                 
Task 1, Epoch 11/20 => Loss 0.244, Train_accy 93.47:  55%|█████▌    | 11/20 [01:21<01:08,  7.60s/it]
Task 1, Epoch 12/20 => Loss 0.226, Train_accy 93.34:  55%|█████▌    | 11/20 [01:28<01:08,  7.60s/it]
Task 1, Epoch 12/20 => Loss 0.226, Train_accy 93.34:  60%|██████    | 12/20 [01:28<00:59,  7.40s/it]
Task 1, Epoch 13/20 => Loss 0.246, Train_accy 92.30:  60%|██████    | 12/20 [01:35<00:59,  7.40s/it]
Task 1, Epoch 13/20 => Loss 0.246, Train_accy 92.30:  65%|██████▌   | 13/20 [01:35<00:51,  7.30s/it]
Task 1, Epoch 14/20 => Loss 0.190, Train_accy 95.04:  65%|██████▌   | 13/20 [01:42<00:51,  7.30s/it]
Task 1, Epoch 14/20 => Loss 0.190, Train_accy 95.04:  70%|███████   | 14/20 [01:42<00:43,  7.25s/it]
Task 1, Epoch 15/20 => Loss 0.232, Train_accy 92.82, Test_accy 66.39:  70%|███████   | 14/20 [01:51<00:43,  7.25s/it]
Task 1, Epoch 15/20 => Loss 0.232, Train_accy 92.82, Test_accy 66.39:  75%|███████▌  | 15/20 [01:51<00:39,  7.96s/it]
Task 1, Epoch 16/20 => Loss 0.182, Train_accy 94.91:  75%|███████▌  | 15/20 [01:58<00:39,  7.96s/it]                 
Task 1, Epoch 16/20 => Loss 0.182, Train_accy 94.91:  80%|████████  | 16/20 [01:58<00:30,  7.62s/it]
Task 1, Epoch 17/20 => Loss 0.201, Train_accy 94.78:  80%|████████  | 16/20 [02:05<00:30,  7.62s/it]
Task 1, Epoch 17/20 => Loss 0.201, Train_accy 94.78:  85%|████████▌ | 17/20 [02:05<00:22,  7.45s/it]
Task 1, Epoch 18/20 => Loss 0.203, Train_accy 94.13:  85%|████████▌ | 17/20 [02:12<00:22,  7.45s/it]
Task 1, Epoch 18/20 => Loss 0.203, Train_accy 94.13:  90%|█████████ | 18/20 [02:12<00:14,  7.31s/it]
Task 1, Epoch 19/20 => Loss 0.173, Train_accy 94.91:  90%|█████████ | 18/20 [02:19<00:14,  7.31s/it]
Task 1, Epoch 19/20 => Loss 0.173, Train_accy 94.91:  95%|█████████▌| 19/20 [02:19<00:07,  7.20s/it]
Task 1, Epoch 20/20 => Loss 0.156, Train_accy 95.95, Test_accy 67.22:  95%|█████████▌| 19/20 [02:29<00:07,  7.20s/it]
Task 1, Epoch 20/20 => Loss 0.156, Train_accy 95.95, Test_accy 67.22: 100%|██████████| 20/20 [02:29<00:00,  7.93s/it]
Task 1, Epoch 20/20 => Loss 0.156, Train_accy 95.95, Test_accy 67.22: 100%|██████████| 20/20 [02:29<00:00,  7.47s/it]
2024-09-12 09:24:09,530 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.156, Train_accy 95.95, Test_accy 67.22
2024-09-12 09:24:12,051 [trainer.py] => No NME accuracy.
2024-09-12 09:24:12,052 [trainer.py] => CNN: {'total': 67.22, '00-19': 71.43, '20-39': 63.24, 'old': 71.43, 'new': 63.24}
2024-09-12 09:24:12,052 [trainer.py] => CNN top1 curve: [76.0, 67.22]
2024-09-12 09:24:12,052 [trainer.py] => CNN top5 curve: [92.57, 89.17]

Average Accuracy (CNN): 71.61
2024-09-12 09:24:12,052 [trainer.py] => Average Accuracy (CNN): 71.61 

2024-09-12 09:24:12,055 [trainer.py] => All params: 172158352
2024-09-12 09:24:12,057 [trainer.py] => Trainable params: 407240
2024-09-12 09:24:12,058 [dualprompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.679, Train_accy 25.44:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.679, Train_accy 25.44:   5%|▌         | 1/20 [00:04<01:29,  4.73s/it]
Task 2, Epoch 2/20 => Loss 1.125, Train_accy 68.49:   5%|▌         | 1/20 [00:09<01:29,  4.73s/it]
Task 2, Epoch 2/20 => Loss 1.125, Train_accy 68.49:  10%|█         | 2/20 [00:09<01:24,  4.67s/it]
Task 2, Epoch 3/20 => Loss 0.575, Train_accy 84.74:  10%|█         | 2/20 [00:13<01:24,  4.67s/it]
Task 2, Epoch 3/20 => Loss 0.575, Train_accy 84.74:  15%|█▌        | 3/20 [00:13<01:17,  4.54s/it]
Task 2, Epoch 4/20 => Loss 0.429, Train_accy 89.63:  15%|█▌        | 3/20 [00:18<01:17,  4.54s/it]
Task 2, Epoch 4/20 => Loss 0.429, Train_accy 89.63:  20%|██        | 4/20 [00:18<01:11,  4.49s/it]
Task 2, Epoch 5/20 => Loss 0.324, Train_accy 91.98, Test_accy 57.77:  20%|██        | 4/20 [00:25<01:11,  4.49s/it]
Task 2, Epoch 5/20 => Loss 0.324, Train_accy 91.98, Test_accy 57.77:  25%|██▌       | 5/20 [00:25<01:23,  5.55s/it]
Task 2, Epoch 6/20 => Loss 0.247, Train_accy 94.52:  25%|██▌       | 5/20 [00:30<01:23,  5.55s/it]                 
Task 2, Epoch 6/20 => Loss 0.247, Train_accy 94.52:  30%|███       | 6/20 [00:30<01:12,  5.17s/it]
Task 2, Epoch 7/20 => Loss 0.189, Train_accy 94.91:  30%|███       | 6/20 [00:34<01:12,  5.17s/it]
Task 2, Epoch 7/20 => Loss 0.189, Train_accy 94.91:  35%|███▌      | 7/20 [00:34<01:03,  4.92s/it]
Task 2, Epoch 8/20 => Loss 0.185, Train_accy 94.91:  35%|███▌      | 7/20 [00:38<01:03,  4.92s/it]
Task 2, Epoch 8/20 => Loss 0.185, Train_accy 94.91:  40%|████      | 8/20 [00:38<00:57,  4.79s/it]
Task 2, Epoch 9/20 => Loss 0.172, Train_accy 95.69:  40%|████      | 8/20 [00:43<00:57,  4.79s/it]
Task 2, Epoch 9/20 => Loss 0.172, Train_accy 95.69:  45%|████▌     | 9/20 [00:43<00:52,  4.79s/it]
Task 2, Epoch 10/20 => Loss 0.190, Train_accy 95.89, Test_accy 61.13:  45%|████▌     | 9/20 [00:51<00:52,  4.79s/it]
Task 2, Epoch 10/20 => Loss 0.190, Train_accy 95.89, Test_accy 61.13:  50%|█████     | 10/20 [00:51<00:57,  5.74s/it]
Task 2, Epoch 11/20 => Loss 0.149, Train_accy 96.48:  50%|█████     | 10/20 [00:56<00:57,  5.74s/it]                 
Task 2, Epoch 11/20 => Loss 0.149, Train_accy 96.48:  55%|█████▌    | 11/20 [00:56<00:48,  5.44s/it]
Task 2, Epoch 12/20 => Loss 0.130, Train_accy 96.28:  55%|█████▌    | 11/20 [01:01<00:48,  5.44s/it]
Task 2, Epoch 12/20 => Loss 0.130, Train_accy 96.28:  60%|██████    | 12/20 [01:01<00:42,  5.28s/it]
Task 2, Epoch 13/20 => Loss 0.138, Train_accy 95.69:  60%|██████    | 12/20 [01:05<00:42,  5.28s/it]
Task 2, Epoch 13/20 => Loss 0.138, Train_accy 95.69:  65%|██████▌   | 13/20 [01:05<00:35,  5.12s/it]
Task 2, Epoch 14/20 => Loss 0.116, Train_accy 98.04:  65%|██████▌   | 13/20 [01:10<00:35,  5.12s/it]
Task 2, Epoch 14/20 => Loss 0.116, Train_accy 98.04:  70%|███████   | 14/20 [01:10<00:29,  5.00s/it]
Task 2, Epoch 15/20 => Loss 0.116, Train_accy 96.87, Test_accy 60.50:  70%|███████   | 14/20 [01:18<00:29,  5.00s/it]
Task 2, Epoch 15/20 => Loss 0.116, Train_accy 96.87, Test_accy 60.50:  75%|███████▌  | 15/20 [01:18<00:29,  5.91s/it]
Task 2, Epoch 16/20 => Loss 0.135, Train_accy 95.69:  75%|███████▌  | 15/20 [01:23<00:29,  5.91s/it]                 
Task 2, Epoch 16/20 => Loss 0.135, Train_accy 95.69:  80%|████████  | 16/20 [01:23<00:22,  5.57s/it]
Task 2, Epoch 17/20 => Loss 0.101, Train_accy 97.06:  80%|████████  | 16/20 [01:28<00:22,  5.57s/it]
Task 2, Epoch 17/20 => Loss 0.101, Train_accy 97.06:  85%|████████▌ | 17/20 [01:28<00:16,  5.42s/it]
Task 2, Epoch 18/20 => Loss 0.118, Train_accy 96.87:  85%|████████▌ | 17/20 [01:33<00:16,  5.42s/it]
Task 2, Epoch 18/20 => Loss 0.118, Train_accy 96.87:  90%|█████████ | 18/20 [01:33<00:10,  5.31s/it]
Task 2, Epoch 19/20 => Loss 0.065, Train_accy 98.24:  90%|█████████ | 18/20 [01:38<00:10,  5.31s/it]
Task 2, Epoch 19/20 => Loss 0.065, Train_accy 98.24:  95%|█████████▌| 19/20 [01:38<00:05,  5.14s/it]
Task 2, Epoch 20/20 => Loss 0.077, Train_accy 97.85, Test_accy 60.92:  95%|█████████▌| 19/20 [01:46<00:05,  5.14s/it]
Task 2, Epoch 20/20 => Loss 0.077, Train_accy 97.85, Test_accy 60.92: 100%|██████████| 20/20 [01:46<00:00,  5.97s/it]
Task 2, Epoch 20/20 => Loss 0.077, Train_accy 97.85, Test_accy 60.92: 100%|██████████| 20/20 [01:46<00:00,  5.31s/it]
2024-09-12 09:25:58,357 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.077, Train_accy 97.85, Test_accy 60.92
2024-09-12 09:26:01,495 [trainer.py] => No NME accuracy.
2024-09-12 09:26:01,495 [trainer.py] => CNN: {'total': 60.92, '00-19': 69.71, '20-39': 57.84, '40-59': 52.59, 'old': 63.61, 'new': 52.59}
2024-09-12 09:26:01,496 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92]
2024-09-12 09:26:01,496 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97]

Average Accuracy (CNN): 68.05
2024-09-12 09:26:01,496 [trainer.py] => Average Accuracy (CNN): 68.05 

2024-09-12 09:26:01,498 [trainer.py] => All params: 172158352
2024-09-12 09:26:01,500 [trainer.py] => Trainable params: 407240
2024-09-12 09:26:01,500 [dualprompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.421, Train_accy 33.42:   0%|          | 0/20 [00:07<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.421, Train_accy 33.42:   5%|▌         | 1/20 [00:07<02:16,  7.16s/it]
Task 3, Epoch 2/20 => Loss 1.012, Train_accy 69.01:   5%|▌         | 1/20 [00:14<02:16,  7.16s/it]
Task 3, Epoch 2/20 => Loss 1.012, Train_accy 69.01:  10%|█         | 2/20 [00:14<02:08,  7.16s/it]
Task 3, Epoch 3/20 => Loss 0.626, Train_accy 81.63:  10%|█         | 2/20 [00:21<02:08,  7.16s/it]
Task 3, Epoch 3/20 => Loss 0.626, Train_accy 81.63:  15%|█▌        | 3/20 [00:21<02:01,  7.14s/it]
Task 3, Epoch 4/20 => Loss 0.419, Train_accy 88.14:  15%|█▌        | 3/20 [00:28<02:01,  7.14s/it]
Task 3, Epoch 4/20 => Loss 0.419, Train_accy 88.14:  20%|██        | 4/20 [00:28<01:54,  7.14s/it]
Task 3, Epoch 5/20 => Loss 0.435, Train_accy 88.01, Test_accy 47.99:  20%|██        | 4/20 [00:40<01:54,  7.14s/it]
Task 3, Epoch 5/20 => Loss 0.435, Train_accy 88.01, Test_accy 47.99:  25%|██▌       | 5/20 [00:40<02:11,  8.76s/it]
Task 3, Epoch 6/20 => Loss 0.327, Train_accy 91.07:  25%|██▌       | 5/20 [00:47<02:11,  8.76s/it]                 
Task 3, Epoch 6/20 => Loss 0.327, Train_accy 91.07:  30%|███       | 6/20 [00:47<01:54,  8.19s/it]
Task 3, Epoch 7/20 => Loss 0.304, Train_accy 90.69:  30%|███       | 6/20 [00:54<01:54,  8.19s/it]
Task 3, Epoch 7/20 => Loss 0.304, Train_accy 90.69:  35%|███▌      | 7/20 [00:54<01:41,  7.83s/it]
Task 3, Epoch 8/20 => Loss 0.221, Train_accy 95.15:  35%|███▌      | 7/20 [01:01<01:41,  7.83s/it]
Task 3, Epoch 8/20 => Loss 0.221, Train_accy 95.15:  40%|████      | 8/20 [01:01<01:31,  7.63s/it]
Task 3, Epoch 9/20 => Loss 0.252, Train_accy 93.11:  40%|████      | 8/20 [01:08<01:31,  7.63s/it]
Task 3, Epoch 9/20 => Loss 0.252, Train_accy 93.11:  45%|████▌     | 9/20 [01:08<01:22,  7.48s/it]
Task 3, Epoch 10/20 => Loss 0.232, Train_accy 93.49, Test_accy 50.57:  45%|████▌     | 9/20 [01:20<01:22,  7.48s/it]
Task 3, Epoch 10/20 => Loss 0.232, Train_accy 93.49, Test_accy 50.57:  50%|█████     | 10/20 [01:20<01:27,  8.71s/it]
Task 3, Epoch 11/20 => Loss 0.208, Train_accy 94.13:  50%|█████     | 10/20 [01:26<01:27,  8.71s/it]                 
Task 3, Epoch 11/20 => Loss 0.208, Train_accy 94.13:  55%|█████▌    | 11/20 [01:26<01:12,  8.05s/it]
Task 3, Epoch 12/20 => Loss 0.207, Train_accy 94.13:  55%|█████▌    | 11/20 [01:33<01:12,  8.05s/it]
Task 3, Epoch 12/20 => Loss 0.207, Train_accy 94.13:  60%|██████    | 12/20 [01:33<01:00,  7.61s/it]
Task 3, Epoch 13/20 => Loss 0.204, Train_accy 94.01:  60%|██████    | 12/20 [01:39<01:00,  7.61s/it]
Task 3, Epoch 13/20 => Loss 0.204, Train_accy 94.01:  65%|██████▌   | 13/20 [01:39<00:51,  7.30s/it]
Task 3, Epoch 14/20 => Loss 0.187, Train_accy 94.01:  65%|██████▌   | 13/20 [01:46<00:51,  7.30s/it]
Task 3, Epoch 14/20 => Loss 0.187, Train_accy 94.01:  70%|███████   | 14/20 [01:46<00:42,  7.07s/it]
Task 3, Epoch 15/20 => Loss 0.209, Train_accy 93.11, Test_accy 52.58:  70%|███████   | 14/20 [01:57<00:42,  7.07s/it]
Task 3, Epoch 15/20 => Loss 0.209, Train_accy 93.11, Test_accy 52.58:  75%|███████▌  | 15/20 [01:57<00:41,  8.33s/it]
Task 3, Epoch 16/20 => Loss 0.162, Train_accy 95.15:  75%|███████▌  | 15/20 [02:04<00:41,  8.33s/it]                 
Task 3, Epoch 16/20 => Loss 0.162, Train_accy 95.15:  80%|████████  | 16/20 [02:04<00:31,  7.97s/it]
Task 3, Epoch 17/20 => Loss 0.106, Train_accy 97.45:  80%|████████  | 16/20 [02:11<00:31,  7.97s/it]
Task 3, Epoch 17/20 => Loss 0.106, Train_accy 97.45:  85%|████████▌ | 17/20 [02:11<00:23,  7.71s/it]
Task 3, Epoch 18/20 => Loss 0.150, Train_accy 96.17:  85%|████████▌ | 17/20 [02:19<00:23,  7.71s/it]
Task 3, Epoch 18/20 => Loss 0.150, Train_accy 96.17:  90%|█████████ | 18/20 [02:19<00:15,  7.54s/it]
Task 3, Epoch 19/20 => Loss 0.116, Train_accy 96.81:  90%|█████████ | 18/20 [02:26<00:15,  7.54s/it]
Task 3, Epoch 19/20 => Loss 0.116, Train_accy 96.81:  95%|█████████▌| 19/20 [02:26<00:07,  7.42s/it]
Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.03, Test_accy 53.58:  95%|█████████▌| 19/20 [02:37<00:07,  7.42s/it]
Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.03, Test_accy 53.58: 100%|██████████| 20/20 [02:37<00:00,  8.67s/it]
Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.03, Test_accy 53.58: 100%|██████████| 20/20 [02:37<00:00,  7.89s/it]
2024-09-12 09:28:39,329 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.03, Test_accy 53.58
2024-09-12 09:28:43,779 [trainer.py] => No NME accuracy.
2024-09-12 09:28:43,780 [trainer.py] => CNN: {'total': 53.58, '00-19': 66.86, '20-39': 56.22, '40-59': 47.41, '60-79': 44.14, 'old': 57.98, 'new': 44.14}
2024-09-12 09:28:43,780 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92, 53.58]
2024-09-12 09:28:43,780 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97, 82.66]

Average Accuracy (CNN): 64.43
2024-09-12 09:28:43,780 [trainer.py] => Average Accuracy (CNN): 64.43 

2024-09-12 09:28:43,784 [trainer.py] => All params: 172158352
2024-09-12 09:28:43,786 [trainer.py] => Trainable params: 407240
2024-09-12 09:28:43,786 [dualprompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.964, Train_accy 21.56:   0%|          | 0/20 [00:04<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.964, Train_accy 21.56:   5%|▌         | 1/20 [00:04<01:32,  4.88s/it]
Task 4, Epoch 2/20 => Loss 1.146, Train_accy 63.36:   5%|▌         | 1/20 [00:09<01:32,  4.88s/it]
Task 4, Epoch 2/20 => Loss 1.146, Train_accy 63.36:  10%|█         | 2/20 [00:09<01:28,  4.92s/it]
Task 4, Epoch 3/20 => Loss 0.687, Train_accy 79.20:  10%|█         | 2/20 [00:14<01:28,  4.92s/it]
Task 4, Epoch 3/20 => Loss 0.687, Train_accy 79.20:  15%|█▌        | 3/20 [00:14<01:23,  4.89s/it]
Task 4, Epoch 4/20 => Loss 0.417, Train_accy 87.98:  15%|█▌        | 3/20 [00:19<01:23,  4.89s/it]
Task 4, Epoch 4/20 => Loss 0.417, Train_accy 87.98:  20%|██        | 4/20 [00:19<01:18,  4.90s/it]
Task 4, Epoch 5/20 => Loss 0.331, Train_accy 90.27, Test_accy 48.04:  20%|██        | 4/20 [00:29<01:18,  4.90s/it]
Task 4, Epoch 5/20 => Loss 0.331, Train_accy 90.27, Test_accy 48.04:  25%|██▌       | 5/20 [00:29<01:41,  6.75s/it]
Task 4, Epoch 6/20 => Loss 0.289, Train_accy 92.18:  25%|██▌       | 5/20 [00:34<01:41,  6.75s/it]                 
Task 4, Epoch 6/20 => Loss 0.289, Train_accy 92.18:  30%|███       | 6/20 [00:34<01:25,  6.13s/it]
Task 4, Epoch 7/20 => Loss 0.211, Train_accy 95.04:  30%|███       | 6/20 [00:39<01:25,  6.13s/it]
Task 4, Epoch 7/20 => Loss 0.211, Train_accy 95.04:  35%|███▌      | 7/20 [00:39<01:14,  5.75s/it]
Task 4, Epoch 8/20 => Loss 0.213, Train_accy 93.70:  35%|███▌      | 7/20 [00:44<01:14,  5.75s/it]
Task 4, Epoch 8/20 => Loss 0.213, Train_accy 93.70:  40%|████      | 8/20 [00:44<01:06,  5.50s/it]
Task 4, Epoch 9/20 => Loss 0.121, Train_accy 97.14:  40%|████      | 8/20 [00:49<01:06,  5.50s/it]
Task 4, Epoch 9/20 => Loss 0.121, Train_accy 97.14:  45%|████▌     | 9/20 [00:49<00:58,  5.29s/it]
Task 4, Epoch 10/20 => Loss 0.147, Train_accy 94.27, Test_accy 48.63:  45%|████▌     | 9/20 [00:59<00:58,  5.29s/it]
Task 4, Epoch 10/20 => Loss 0.147, Train_accy 94.27, Test_accy 48.63:  50%|█████     | 10/20 [00:59<01:07,  6.75s/it]
Task 4, Epoch 11/20 => Loss 0.170, Train_accy 94.47:  50%|█████     | 10/20 [01:04<01:07,  6.75s/it]                 
Task 4, Epoch 11/20 => Loss 0.170, Train_accy 94.47:  55%|█████▌    | 11/20 [01:04<00:55,  6.19s/it]
Task 4, Epoch 12/20 => Loss 0.127, Train_accy 96.76:  55%|█████▌    | 11/20 [01:09<00:55,  6.19s/it]
Task 4, Epoch 12/20 => Loss 0.127, Train_accy 96.76:  60%|██████    | 12/20 [01:09<00:46,  5.80s/it]
Task 4, Epoch 13/20 => Loss 0.116, Train_accy 97.14:  60%|██████    | 12/20 [01:14<00:46,  5.80s/it]
Task 4, Epoch 13/20 => Loss 0.116, Train_accy 97.14:  65%|██████▌   | 13/20 [01:14<00:38,  5.52s/it]
Task 4, Epoch 14/20 => Loss 0.125, Train_accy 95.80:  65%|██████▌   | 13/20 [01:18<00:38,  5.52s/it]
Task 4, Epoch 14/20 => Loss 0.125, Train_accy 95.80:  70%|███████   | 14/20 [01:18<00:31,  5.33s/it]
Task 4, Epoch 15/20 => Loss 0.113, Train_accy 97.14, Test_accy 48.87:  70%|███████   | 14/20 [01:29<00:31,  5.33s/it]
Task 4, Epoch 15/20 => Loss 0.113, Train_accy 97.14, Test_accy 48.87:  75%|███████▌  | 15/20 [01:29<00:33,  6.79s/it]
Task 4, Epoch 16/20 => Loss 0.115, Train_accy 96.18:  75%|███████▌  | 15/20 [01:33<00:33,  6.79s/it]                 
Task 4, Epoch 16/20 => Loss 0.115, Train_accy 96.18:  80%|████████  | 16/20 [01:33<00:24,  6.20s/it]
Task 4, Epoch 17/20 => Loss 0.105, Train_accy 96.95:  80%|████████  | 16/20 [01:38<00:24,  6.20s/it]
Task 4, Epoch 17/20 => Loss 0.105, Train_accy 96.95:  85%|████████▌ | 17/20 [01:38<00:17,  5.79s/it]
Task 4, Epoch 18/20 => Loss 0.090, Train_accy 97.52:  85%|████████▌ | 17/20 [01:43<00:17,  5.79s/it]
Task 4, Epoch 18/20 => Loss 0.090, Train_accy 97.52:  90%|█████████ | 18/20 [01:43<00:10,  5.40s/it]
Task 4, Epoch 19/20 => Loss 0.113, Train_accy 96.18:  90%|█████████ | 18/20 [01:47<00:10,  5.40s/it]
Task 4, Epoch 19/20 => Loss 0.113, Train_accy 96.18:  95%|█████████▌| 19/20 [01:47<00:05,  5.13s/it]
Task 4, Epoch 20/20 => Loss 0.112, Train_accy 95.99, Test_accy 49.82:  95%|█████████▌| 19/20 [01:57<00:05,  5.13s/it]
Task 4, Epoch 20/20 => Loss 0.112, Train_accy 95.99, Test_accy 49.82: 100%|██████████| 20/20 [01:57<00:00,  6.47s/it]
Task 4, Epoch 20/20 => Loss 0.112, Train_accy 95.99, Test_accy 49.82: 100%|██████████| 20/20 [01:57<00:00,  5.87s/it]
2024-09-12 09:30:41,170 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.112, Train_accy 95.99, Test_accy 49.82
2024-09-12 09:30:45,993 [trainer.py] => No NME accuracy.
2024-09-12 09:30:45,993 [trainer.py] => CNN: {'total': 49.82, '00-19': 62.86, '20-39': 56.22, '40-59': 49.14, '60-79': 41.44, '80-99': 39.16, 'old': 52.01, 'new': 39.16}
2024-09-12 09:30:45,993 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92, 53.58, 49.82]
2024-09-12 09:30:45,994 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97, 82.66, 79.19]

Average Accuracy (CNN): 61.51
2024-09-12 09:30:45,994 [trainer.py] => Average Accuracy (CNN): 61.51 

2024-09-12 09:30:45,996 [trainer.py] => All params: 172158352
2024-09-12 09:30:45,998 [trainer.py] => Trainable params: 407240
2024-09-12 09:30:45,998 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.780, Train_accy 24.28:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.780, Train_accy 24.28:   5%|▌         | 1/20 [00:04<01:24,  4.46s/it]
Task 5, Epoch 2/20 => Loss 1.063, Train_accy 68.07:   5%|▌         | 1/20 [00:09<01:24,  4.46s/it]
Task 5, Epoch 2/20 => Loss 1.063, Train_accy 68.07:  10%|█         | 2/20 [00:09<01:22,  4.58s/it]
Task 5, Epoch 3/20 => Loss 0.541, Train_accy 85.47:  10%|█         | 2/20 [00:13<01:22,  4.58s/it]
Task 5, Epoch 3/20 => Loss 0.541, Train_accy 85.47:  15%|█▌        | 3/20 [00:13<01:19,  4.67s/it]
Task 5, Epoch 4/20 => Loss 0.377, Train_accy 90.44:  15%|█▌        | 3/20 [00:18<01:19,  4.67s/it]
Task 5, Epoch 4/20 => Loss 0.377, Train_accy 90.44:  20%|██        | 4/20 [00:18<01:15,  4.74s/it]
Task 5, Epoch 5/20 => Loss 0.302, Train_accy 92.16, Test_accy 45.85:  20%|██        | 4/20 [00:29<01:15,  4.74s/it]
Task 5, Epoch 5/20 => Loss 0.302, Train_accy 92.16, Test_accy 45.85:  25%|██▌       | 5/20 [00:29<01:43,  6.93s/it]
Task 5, Epoch 6/20 => Loss 0.242, Train_accy 92.93:  25%|██▌       | 5/20 [00:34<01:43,  6.93s/it]                 
Task 5, Epoch 6/20 => Loss 0.242, Train_accy 92.93:  30%|███       | 6/20 [00:34<01:26,  6.21s/it]
Task 5, Epoch 7/20 => Loss 0.184, Train_accy 94.26:  30%|███       | 6/20 [00:39<01:26,  6.21s/it]
Task 5, Epoch 7/20 => Loss 0.184, Train_accy 94.26:  35%|███▌      | 7/20 [00:39<01:15,  5.78s/it]
Task 5, Epoch 8/20 => Loss 0.198, Train_accy 94.46:  35%|███▌      | 7/20 [00:44<01:15,  5.78s/it]
Task 5, Epoch 8/20 => Loss 0.198, Train_accy 94.46:  40%|████      | 8/20 [00:44<01:05,  5.47s/it]
Task 5, Epoch 9/20 => Loss 0.149, Train_accy 96.56:  40%|████      | 8/20 [00:48<01:05,  5.47s/it]
Task 5, Epoch 9/20 => Loss 0.149, Train_accy 96.56:  45%|████▌     | 9/20 [00:48<00:58,  5.28s/it]
Task 5, Epoch 10/20 => Loss 0.178, Train_accy 95.22, Test_accy 46.46:  45%|████▌     | 9/20 [00:59<00:58,  5.28s/it]
Task 5, Epoch 10/20 => Loss 0.178, Train_accy 95.22, Test_accy 46.46:  50%|█████     | 10/20 [00:59<01:09,  6.99s/it]
Task 5, Epoch 11/20 => Loss 0.146, Train_accy 96.94:  50%|█████     | 10/20 [01:04<01:09,  6.99s/it]                 
Task 5, Epoch 11/20 => Loss 0.146, Train_accy 96.94:  55%|█████▌    | 11/20 [01:04<00:56,  6.32s/it]
Task 5, Epoch 12/20 => Loss 0.101, Train_accy 97.71:  55%|█████▌    | 11/20 [01:09<00:56,  6.32s/it]
Task 5, Epoch 12/20 => Loss 0.101, Train_accy 97.71:  60%|██████    | 12/20 [01:09<00:46,  5.87s/it]
Task 5, Epoch 13/20 => Loss 0.104, Train_accy 97.51:  60%|██████    | 12/20 [01:14<00:46,  5.87s/it]
Task 5, Epoch 13/20 => Loss 0.104, Train_accy 97.51:  65%|██████▌   | 13/20 [01:14<00:38,  5.55s/it]
Task 5, Epoch 14/20 => Loss 0.109, Train_accy 96.75:  65%|██████▌   | 13/20 [01:19<00:38,  5.55s/it]
Task 5, Epoch 14/20 => Loss 0.109, Train_accy 96.75:  70%|███████   | 14/20 [01:19<00:31,  5.33s/it]
Task 5, Epoch 15/20 => Loss 0.103, Train_accy 96.75, Test_accy 47.18:  70%|███████   | 14/20 [01:29<00:31,  5.33s/it]
Task 5, Epoch 15/20 => Loss 0.103, Train_accy 96.75, Test_accy 47.18:  75%|███████▌  | 15/20 [01:29<00:35,  7.02s/it]
Task 5, Epoch 16/20 => Loss 0.112, Train_accy 97.32:  75%|███████▌  | 15/20 [01:34<00:35,  7.02s/it]                 
Task 5, Epoch 16/20 => Loss 0.112, Train_accy 97.32:  80%|████████  | 16/20 [01:34<00:25,  6.35s/it]
Task 5, Epoch 17/20 => Loss 0.098, Train_accy 96.37:  80%|████████  | 16/20 [01:39<00:25,  6.35s/it]
Task 5, Epoch 17/20 => Loss 0.098, Train_accy 96.37:  85%|████████▌ | 17/20 [01:39<00:17,  5.91s/it]
Task 5, Epoch 18/20 => Loss 0.112, Train_accy 95.79:  85%|████████▌ | 17/20 [01:44<00:17,  5.91s/it]
Task 5, Epoch 18/20 => Loss 0.112, Train_accy 95.79:  90%|█████████ | 18/20 [01:44<00:11,  5.57s/it]
Task 5, Epoch 19/20 => Loss 0.119, Train_accy 96.18:  90%|█████████ | 18/20 [01:49<00:11,  5.57s/it]
Task 5, Epoch 19/20 => Loss 0.119, Train_accy 96.18:  95%|█████████▌| 19/20 [01:49<00:05,  5.34s/it]
Task 5, Epoch 20/20 => Loss 0.099, Train_accy 96.75, Test_accy 47.38:  95%|█████████▌| 19/20 [02:00<00:05,  5.34s/it]
Task 5, Epoch 20/20 => Loss 0.099, Train_accy 96.75, Test_accy 47.38: 100%|██████████| 20/20 [02:00<00:00,  6.97s/it]
Task 5, Epoch 20/20 => Loss 0.099, Train_accy 96.75, Test_accy 47.38: 100%|██████████| 20/20 [02:00<00:00,  6.00s/it]
2024-09-12 09:32:46,014 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.099, Train_accy 96.75, Test_accy 47.38
2024-09-12 09:32:51,971 [trainer.py] => No NME accuracy.
2024-09-12 09:32:51,972 [trainer.py] => CNN: {'total': 47.38, '00-19': 63.43, '20-39': 55.14, '40-59': 48.28, '60-79': 39.64, '80-99': 39.16, '100-119': 36.57, 'old': 49.11, 'new': 36.57}
2024-09-12 09:32:51,972 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92, 53.58, 49.82, 47.38]
2024-09-12 09:32:51,972 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97, 82.66, 79.19, 77.03]

Average Accuracy (CNN): 59.15
2024-09-12 09:32:51,972 [trainer.py] => Average Accuracy (CNN): 59.15 

2024-09-12 09:32:51,975 [trainer.py] => All params: 172158352
2024-09-12 09:32:51,977 [trainer.py] => Trainable params: 407240
2024-09-12 09:32:51,977 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.319, Train_accy 17.25:   0%|          | 0/20 [00:04<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.319, Train_accy 17.25:   5%|▌         | 1/20 [00:04<01:34,  4.99s/it]
Task 6, Epoch 2/20 => Loss 1.427, Train_accy 58.07:   5%|▌         | 1/20 [00:09<01:34,  4.99s/it]
Task 6, Epoch 2/20 => Loss 1.427, Train_accy 58.07:  10%|█         | 2/20 [00:09<01:29,  4.95s/it]
Task 6, Epoch 3/20 => Loss 0.765, Train_accy 78.11:  10%|█         | 2/20 [00:14<01:29,  4.95s/it]
Task 6, Epoch 3/20 => Loss 0.765, Train_accy 78.11:  15%|█▌        | 3/20 [00:14<01:24,  4.98s/it]
Task 6, Epoch 4/20 => Loss 0.526, Train_accy 85.16:  15%|█▌        | 3/20 [00:19<01:24,  4.98s/it]
Task 6, Epoch 4/20 => Loss 0.526, Train_accy 85.16:  20%|██        | 4/20 [00:19<01:20,  5.01s/it]
Task 6, Epoch 5/20 => Loss 0.409, Train_accy 88.13, Test_accy 43.18:  20%|██        | 4/20 [00:31<01:20,  5.01s/it]
Task 6, Epoch 5/20 => Loss 0.409, Train_accy 88.13, Test_accy 43.18:  25%|██▌       | 5/20 [00:31<01:50,  7.39s/it]
Task 6, Epoch 6/20 => Loss 0.311, Train_accy 91.09:  25%|██▌       | 5/20 [00:36<01:50,  7.39s/it]                 
Task 6, Epoch 6/20 => Loss 0.311, Train_accy 91.09:  30%|███       | 6/20 [00:36<01:30,  6.45s/it]
Task 6, Epoch 7/20 => Loss 0.300, Train_accy 92.39:  30%|███       | 6/20 [00:40<01:30,  6.45s/it]
Task 6, Epoch 7/20 => Loss 0.300, Train_accy 92.39:  35%|███▌      | 7/20 [00:40<01:15,  5.84s/it]
Task 6, Epoch 8/20 => Loss 0.211, Train_accy 95.73:  35%|███▌      | 7/20 [00:45<01:15,  5.84s/it]
Task 6, Epoch 8/20 => Loss 0.211, Train_accy 95.73:  40%|████      | 8/20 [00:45<01:05,  5.47s/it]
Task 6, Epoch 9/20 => Loss 0.199, Train_accy 94.81:  40%|████      | 8/20 [00:50<01:05,  5.47s/it]
Task 6, Epoch 9/20 => Loss 0.199, Train_accy 94.81:  45%|████▌     | 9/20 [00:50<00:57,  5.22s/it]
Task 6, Epoch 10/20 => Loss 0.213, Train_accy 94.81, Test_accy 44.16:  45%|████▌     | 9/20 [01:01<00:57,  5.22s/it]
Task 6, Epoch 10/20 => Loss 0.213, Train_accy 94.81, Test_accy 44.16:  50%|█████     | 10/20 [01:01<01:09,  6.97s/it]
Task 6, Epoch 11/20 => Loss 0.155, Train_accy 95.73:  50%|█████     | 10/20 [01:06<01:09,  6.97s/it]                 
Task 6, Epoch 11/20 => Loss 0.155, Train_accy 95.73:  55%|█████▌    | 11/20 [01:06<00:57,  6.36s/it]
Task 6, Epoch 12/20 => Loss 0.189, Train_accy 94.62:  55%|█████▌    | 11/20 [01:10<00:57,  6.36s/it]
Task 6, Epoch 12/20 => Loss 0.189, Train_accy 94.62:  60%|██████    | 12/20 [01:10<00:47,  5.94s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 96.29:  60%|██████    | 12/20 [01:16<00:47,  5.94s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 96.29:  65%|██████▌   | 13/20 [01:16<00:39,  5.69s/it]
Task 6, Epoch 14/20 => Loss 0.142, Train_accy 96.66:  65%|██████▌   | 13/20 [01:21<00:39,  5.69s/it]
Task 6, Epoch 14/20 => Loss 0.142, Train_accy 96.66:  70%|███████   | 14/20 [01:21<00:32,  5.49s/it]
Task 6, Epoch 15/20 => Loss 0.119, Train_accy 96.85, Test_accy 44.42:  70%|███████   | 14/20 [01:32<00:32,  5.49s/it]
Task 6, Epoch 15/20 => Loss 0.119, Train_accy 96.85, Test_accy 44.42:  75%|███████▌  | 15/20 [01:32<00:36,  7.36s/it]
Task 6, Epoch 16/20 => Loss 0.102, Train_accy 97.22:  75%|███████▌  | 15/20 [01:37<00:36,  7.36s/it]                 
Task 6, Epoch 16/20 => Loss 0.102, Train_accy 97.22:  80%|████████  | 16/20 [01:37<00:26,  6.66s/it]
Task 6, Epoch 17/20 => Loss 0.162, Train_accy 95.55:  80%|████████  | 16/20 [01:42<00:26,  6.66s/it]
Task 6, Epoch 17/20 => Loss 0.162, Train_accy 95.55:  85%|████████▌ | 17/20 [01:42<00:18,  6.18s/it]
Task 6, Epoch 18/20 => Loss 0.122, Train_accy 97.03:  85%|████████▌ | 17/20 [01:47<00:18,  6.18s/it]
Task 6, Epoch 18/20 => Loss 0.122, Train_accy 97.03:  90%|█████████ | 18/20 [01:47<00:11,  5.84s/it]
Task 6, Epoch 19/20 => Loss 0.129, Train_accy 95.92:  90%|█████████ | 18/20 [01:52<00:11,  5.84s/it]
Task 6, Epoch 19/20 => Loss 0.129, Train_accy 95.92:  95%|█████████▌| 19/20 [01:52<00:05,  5.59s/it]
Task 6, Epoch 20/20 => Loss 0.123, Train_accy 96.29, Test_accy 45.41:  95%|█████████▌| 19/20 [02:04<00:05,  5.59s/it]
Task 6, Epoch 20/20 => Loss 0.123, Train_accy 96.29, Test_accy 45.41: 100%|██████████| 20/20 [02:04<00:00,  7.50s/it]
Task 6, Epoch 20/20 => Loss 0.123, Train_accy 96.29, Test_accy 45.41: 100%|██████████| 20/20 [02:04<00:00,  6.25s/it]
2024-09-12 09:34:56,909 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.123, Train_accy 96.29, Test_accy 45.41
2024-09-12 09:35:03,740 [trainer.py] => No NME accuracy.
2024-09-12 09:35:03,741 [trainer.py] => CNN: {'total': 45.41, '00-19': 62.86, '20-39': 55.14, '40-59': 47.41, '60-79': 38.29, '80-99': 39.16, '100-119': 37.31, '120-139': 34.93, 'old': 46.97, 'new': 34.93}
2024-09-12 09:35:03,741 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92, 53.58, 49.82, 47.38, 45.41]
2024-09-12 09:35:03,741 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97, 82.66, 79.19, 77.03, 74.4]

Average Accuracy (CNN): 57.19
2024-09-12 09:35:03,741 [trainer.py] => Average Accuracy (CNN): 57.19 

2024-09-12 09:35:03,744 [trainer.py] => All params: 172158352
2024-09-12 09:35:03,747 [trainer.py] => Trainable params: 407240
2024-09-12 09:35:03,747 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.968, Train_accy 22.98:   0%|          | 0/20 [00:04<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.968, Train_accy 22.98:   5%|▌         | 1/20 [00:04<01:32,  4.88s/it]
Task 7, Epoch 2/20 => Loss 1.170, Train_accy 65.16:   5%|▌         | 1/20 [00:09<01:32,  4.88s/it]
Task 7, Epoch 2/20 => Loss 1.170, Train_accy 65.16:  10%|█         | 2/20 [00:09<01:27,  4.88s/it]
Task 7, Epoch 3/20 => Loss 0.705, Train_accy 81.54:  10%|█         | 2/20 [00:14<01:27,  4.88s/it]
Task 7, Epoch 3/20 => Loss 0.705, Train_accy 81.54:  15%|█▌        | 3/20 [00:14<01:23,  4.92s/it]
Task 7, Epoch 4/20 => Loss 0.420, Train_accy 86.44:  15%|█▌        | 3/20 [00:19<01:23,  4.92s/it]
Task 7, Epoch 4/20 => Loss 0.420, Train_accy 86.44:  20%|██        | 4/20 [00:19<01:18,  4.92s/it]
Task 7, Epoch 5/20 => Loss 0.340, Train_accy 89.83, Test_accy 42.39:  20%|██        | 4/20 [00:32<01:18,  4.92s/it]
Task 7, Epoch 5/20 => Loss 0.340, Train_accy 89.83, Test_accy 42.39:  25%|██▌       | 5/20 [00:32<01:55,  7.67s/it]
Task 7, Epoch 6/20 => Loss 0.307, Train_accy 92.66:  25%|██▌       | 5/20 [00:37<01:55,  7.67s/it]                 
Task 7, Epoch 6/20 => Loss 0.307, Train_accy 92.66:  30%|███       | 6/20 [00:37<01:34,  6.72s/it]
Task 7, Epoch 7/20 => Loss 0.241, Train_accy 92.84:  30%|███       | 6/20 [00:42<01:34,  6.72s/it]
Task 7, Epoch 7/20 => Loss 0.241, Train_accy 92.84:  35%|███▌      | 7/20 [00:42<01:19,  6.13s/it]
Task 7, Epoch 8/20 => Loss 0.224, Train_accy 93.97:  35%|███▌      | 7/20 [00:46<01:19,  6.13s/it]
Task 7, Epoch 8/20 => Loss 0.224, Train_accy 93.97:  40%|████      | 8/20 [00:46<01:09,  5.76s/it]
Task 7, Epoch 9/20 => Loss 0.194, Train_accy 93.79:  40%|████      | 8/20 [00:51<01:09,  5.76s/it]
Task 7, Epoch 9/20 => Loss 0.194, Train_accy 93.79:  45%|████▌     | 9/20 [00:51<01:00,  5.52s/it]
Task 7, Epoch 10/20 => Loss 0.146, Train_accy 96.05, Test_accy 43.03:  45%|████▌     | 9/20 [01:04<01:00,  5.52s/it]
Task 7, Epoch 10/20 => Loss 0.146, Train_accy 96.05, Test_accy 43.03:  50%|█████     | 10/20 [01:04<01:16,  7.68s/it]
Task 7, Epoch 11/20 => Loss 0.151, Train_accy 95.10:  50%|█████     | 10/20 [01:09<01:16,  7.68s/it]                 
Task 7, Epoch 11/20 => Loss 0.151, Train_accy 95.10:  55%|█████▌    | 11/20 [01:09<01:01,  6.84s/it]
Task 7, Epoch 12/20 => Loss 0.145, Train_accy 96.05:  55%|█████▌    | 11/20 [01:14<01:01,  6.84s/it]
Task 7, Epoch 12/20 => Loss 0.145, Train_accy 96.05:  60%|██████    | 12/20 [01:14<00:50,  6.28s/it]
Task 7, Epoch 13/20 => Loss 0.109, Train_accy 97.18:  60%|██████    | 12/20 [01:19<00:50,  6.28s/it]
Task 7, Epoch 13/20 => Loss 0.109, Train_accy 97.18:  65%|██████▌   | 13/20 [01:19<00:40,  5.85s/it]
Task 7, Epoch 14/20 => Loss 0.139, Train_accy 96.61:  65%|██████▌   | 13/20 [01:23<00:40,  5.85s/it]
Task 7, Epoch 14/20 => Loss 0.139, Train_accy 96.61:  70%|███████   | 14/20 [01:23<00:32,  5.45s/it]
Task 7, Epoch 15/20 => Loss 0.122, Train_accy 96.42, Test_accy 43.59:  70%|███████   | 14/20 [01:35<00:32,  5.45s/it]
Task 7, Epoch 15/20 => Loss 0.122, Train_accy 96.42, Test_accy 43.59:  75%|███████▌  | 15/20 [01:35<00:36,  7.28s/it]
Task 7, Epoch 16/20 => Loss 0.098, Train_accy 97.18:  75%|███████▌  | 15/20 [01:39<00:36,  7.28s/it]                 
Task 7, Epoch 16/20 => Loss 0.098, Train_accy 97.18:  80%|████████  | 16/20 [01:39<00:25,  6.45s/it]
Task 7, Epoch 17/20 => Loss 0.115, Train_accy 96.80:  80%|████████  | 16/20 [01:44<00:25,  6.45s/it]
Task 7, Epoch 17/20 => Loss 0.115, Train_accy 96.80:  85%|████████▌ | 17/20 [01:44<00:17,  5.88s/it]
Task 7, Epoch 18/20 => Loss 0.111, Train_accy 96.42:  85%|████████▌ | 17/20 [01:48<00:17,  5.88s/it]
Task 7, Epoch 18/20 => Loss 0.111, Train_accy 96.42:  90%|█████████ | 18/20 [01:48<00:10,  5.48s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.23:  90%|█████████ | 18/20 [01:53<00:10,  5.48s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.23:  95%|█████████▌| 19/20 [01:53<00:05,  5.29s/it]
Task 7, Epoch 20/20 => Loss 0.099, Train_accy 97.36, Test_accy 43.27:  95%|█████████▌| 19/20 [02:06<00:05,  5.29s/it]
Task 7, Epoch 20/20 => Loss 0.099, Train_accy 97.36, Test_accy 43.27: 100%|██████████| 20/20 [02:06<00:00,  7.43s/it]
Task 7, Epoch 20/20 => Loss 0.099, Train_accy 97.36, Test_accy 43.27: 100%|██████████| 20/20 [02:06<00:00,  6.31s/it]
2024-09-12 09:37:09,951 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.099, Train_accy 97.36, Test_accy 43.27
2024-09-12 09:37:17,432 [trainer.py] => No NME accuracy.
2024-09-12 09:37:17,432 [trainer.py] => CNN: {'total': 43.27, '00-19': 61.71, '20-39': 54.59, '40-59': 44.83, '60-79': 38.74, '80-99': 37.76, '100-119': 36.57, '120-139': 33.56, '140-159': 32.28, 'old': 44.51, 'new': 32.28}
2024-09-12 09:37:17,433 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92, 53.58, 49.82, 47.38, 45.41, 43.27]
2024-09-12 09:37:17,433 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97, 82.66, 79.19, 77.03, 74.4, 71.55]

Average Accuracy (CNN): 55.45
2024-09-12 09:37:17,433 [trainer.py] => Average Accuracy (CNN): 55.45 

2024-09-12 09:37:17,434 [trainer.py] => All params: 172158352
2024-09-12 09:37:17,435 [trainer.py] => Trainable params: 407240
2024-09-12 09:37:17,435 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.130, Train_accy 17.16:   0%|          | 0/20 [00:05<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.130, Train_accy 17.16:   5%|▌         | 1/20 [00:05<01:40,  5.30s/it]
Task 8, Epoch 2/20 => Loss 1.520, Train_accy 55.17:   5%|▌         | 1/20 [00:10<01:40,  5.30s/it]
Task 8, Epoch 2/20 => Loss 1.520, Train_accy 55.17:  10%|█         | 2/20 [00:10<01:35,  5.32s/it]
Task 8, Epoch 3/20 => Loss 0.876, Train_accy 74.43:  10%|█         | 2/20 [00:15<01:35,  5.32s/it]
Task 8, Epoch 3/20 => Loss 0.876, Train_accy 74.43:  15%|█▌        | 3/20 [00:15<01:30,  5.31s/it]
Task 8, Epoch 4/20 => Loss 0.578, Train_accy 82.31:  15%|█▌        | 3/20 [00:21<01:30,  5.31s/it]
Task 8, Epoch 4/20 => Loss 0.578, Train_accy 82.31:  20%|██        | 4/20 [00:21<01:24,  5.29s/it]
Task 8, Epoch 5/20 => Loss 0.474, Train_accy 84.41, Test_accy 40.29:  20%|██        | 4/20 [00:34<01:24,  5.29s/it]
Task 8, Epoch 5/20 => Loss 0.474, Train_accy 84.41, Test_accy 40.29:  25%|██▌       | 5/20 [00:34<02:04,  8.28s/it]
Task 8, Epoch 6/20 => Loss 0.348, Train_accy 89.84:  25%|██▌       | 5/20 [00:40<02:04,  8.28s/it]                 
Task 8, Epoch 6/20 => Loss 0.348, Train_accy 89.84:  30%|███       | 6/20 [00:40<01:41,  7.28s/it]
Task 8, Epoch 7/20 => Loss 0.300, Train_accy 92.47:  30%|███       | 6/20 [00:45<01:41,  7.28s/it]
Task 8, Epoch 7/20 => Loss 0.300, Train_accy 92.47:  35%|███▌      | 7/20 [00:45<01:26,  6.62s/it]
Task 8, Epoch 8/20 => Loss 0.275, Train_accy 92.12:  35%|███▌      | 7/20 [00:50<01:26,  6.62s/it]
Task 8, Epoch 8/20 => Loss 0.275, Train_accy 92.12:  40%|████      | 8/20 [00:50<01:14,  6.19s/it]
Task 8, Epoch 9/20 => Loss 0.239, Train_accy 94.40:  40%|████      | 8/20 [00:55<01:14,  6.19s/it]
Task 8, Epoch 9/20 => Loss 0.239, Train_accy 94.40:  45%|████▌     | 9/20 [00:55<01:04,  5.88s/it]
Task 8, Epoch 10/20 => Loss 0.220, Train_accy 93.70, Test_accy 40.65:  45%|████▌     | 9/20 [01:09<01:04,  5.88s/it]
Task 8, Epoch 10/20 => Loss 0.220, Train_accy 93.70, Test_accy 40.65:  50%|█████     | 10/20 [01:09<01:22,  8.29s/it]
Task 8, Epoch 11/20 => Loss 0.181, Train_accy 95.10:  50%|█████     | 10/20 [01:14<01:22,  8.29s/it]                 
Task 8, Epoch 11/20 => Loss 0.181, Train_accy 95.10:  55%|█████▌    | 11/20 [01:14<01:06,  7.35s/it]
Task 8, Epoch 12/20 => Loss 0.185, Train_accy 94.75:  55%|█████▌    | 11/20 [01:19<01:06,  7.35s/it]
Task 8, Epoch 12/20 => Loss 0.185, Train_accy 94.75:  60%|██████    | 12/20 [01:19<00:53,  6.71s/it]
Task 8, Epoch 13/20 => Loss 0.178, Train_accy 95.27:  60%|██████    | 12/20 [01:25<00:53,  6.71s/it]
Task 8, Epoch 13/20 => Loss 0.178, Train_accy 95.27:  65%|██████▌   | 13/20 [01:25<00:43,  6.28s/it]
Task 8, Epoch 14/20 => Loss 0.159, Train_accy 95.62:  65%|██████▌   | 13/20 [01:30<00:43,  6.28s/it]
Task 8, Epoch 14/20 => Loss 0.159, Train_accy 95.62:  70%|███████   | 14/20 [01:30<00:35,  5.96s/it]
Task 8, Epoch 15/20 => Loss 0.133, Train_accy 96.67, Test_accy 40.86:  70%|███████   | 14/20 [01:44<00:35,  5.96s/it]
Task 8, Epoch 15/20 => Loss 0.133, Train_accy 96.67, Test_accy 40.86:  75%|███████▌  | 15/20 [01:44<00:41,  8.30s/it]
Task 8, Epoch 16/20 => Loss 0.149, Train_accy 96.32:  75%|███████▌  | 15/20 [01:49<00:41,  8.30s/it]                 
Task 8, Epoch 16/20 => Loss 0.149, Train_accy 96.32:  80%|████████  | 16/20 [01:49<00:29,  7.38s/it]
Task 8, Epoch 17/20 => Loss 0.126, Train_accy 96.32:  80%|████████  | 16/20 [01:54<00:29,  7.38s/it]
Task 8, Epoch 17/20 => Loss 0.126, Train_accy 96.32:  85%|████████▌ | 17/20 [01:54<00:20,  6.72s/it]
Task 8, Epoch 18/20 => Loss 0.132, Train_accy 96.15:  85%|████████▌ | 17/20 [01:59<00:20,  6.72s/it]
Task 8, Epoch 18/20 => Loss 0.132, Train_accy 96.15:  90%|█████████ | 18/20 [01:59<00:12,  6.26s/it]
Task 8, Epoch 19/20 => Loss 0.156, Train_accy 96.32:  90%|█████████ | 18/20 [02:05<00:12,  6.26s/it]
Task 8, Epoch 19/20 => Loss 0.156, Train_accy 96.32:  95%|█████████▌| 19/20 [02:05<00:05,  5.99s/it]
Task 8, Epoch 20/20 => Loss 0.128, Train_accy 96.85, Test_accy 40.86:  95%|█████████▌| 19/20 [02:17<00:05,  5.99s/it]
Task 8, Epoch 20/20 => Loss 0.128, Train_accy 96.85, Test_accy 40.86: 100%|██████████| 20/20 [02:17<00:00,  7.99s/it]
Task 8, Epoch 20/20 => Loss 0.128, Train_accy 96.85, Test_accy 40.86: 100%|██████████| 20/20 [02:17<00:00,  6.89s/it]
2024-09-12 09:39:35,310 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.128, Train_accy 96.85, Test_accy 40.86
2024-09-12 09:39:43,050 [trainer.py] => No NME accuracy.
2024-09-12 09:39:43,050 [trainer.py] => CNN: {'total': 40.86, '00-19': 60.0, '20-39': 54.59, '40-59': 41.38, '60-79': 37.84, '80-99': 39.16, '100-119': 34.33, '120-139': 32.19, '140-159': 31.5, '160-179': 29.25, 'old': 42.23, 'new': 29.25}
2024-09-12 09:39:43,050 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92, 53.58, 49.82, 47.38, 45.41, 43.27, 40.86]
2024-09-12 09:39:43,050 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97, 82.66, 79.19, 77.03, 74.4, 71.55, 69.61]

Average Accuracy (CNN): 53.83
2024-09-12 09:39:43,050 [trainer.py] => Average Accuracy (CNN): 53.83 

2024-09-12 09:39:43,051 [trainer.py] => All params: 172158352
2024-09-12 09:39:43,052 [trainer.py] => Trainable params: 407240
2024-09-12 09:39:43,052 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.087, Train_accy 20.49:   0%|          | 0/20 [00:04<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.087, Train_accy 20.49:   5%|▌         | 1/20 [00:04<01:25,  4.52s/it]
Task 9, Epoch 2/20 => Loss 1.216, Train_accy 65.84:   5%|▌         | 1/20 [00:09<01:25,  4.52s/it]
Task 9, Epoch 2/20 => Loss 1.216, Train_accy 65.84:  10%|█         | 2/20 [00:09<01:21,  4.55s/it]
Task 9, Epoch 3/20 => Loss 0.641, Train_accy 82.35:  10%|█         | 2/20 [00:13<01:21,  4.55s/it]
Task 9, Epoch 3/20 => Loss 0.641, Train_accy 82.35:  15%|█▌        | 3/20 [00:13<01:17,  4.57s/it]
Task 9, Epoch 4/20 => Loss 0.426, Train_accy 88.05:  15%|█▌        | 3/20 [00:18<01:17,  4.57s/it]
Task 9, Epoch 4/20 => Loss 0.426, Train_accy 88.05:  20%|██        | 4/20 [00:18<01:15,  4.71s/it]
Task 9, Epoch 5/20 => Loss 0.305, Train_accy 91.84, Test_accy 39.30:  20%|██        | 4/20 [00:32<01:15,  4.71s/it]
Task 9, Epoch 5/20 => Loss 0.305, Train_accy 91.84, Test_accy 39.30:  25%|██▌       | 5/20 [00:32<02:00,  8.00s/it]
Task 9, Epoch 6/20 => Loss 0.242, Train_accy 92.60:  25%|██▌       | 5/20 [00:37<02:00,  8.00s/it]                 
Task 9, Epoch 6/20 => Loss 0.242, Train_accy 92.60:  30%|███       | 6/20 [00:37<01:37,  6.95s/it]
Task 9, Epoch 7/20 => Loss 0.192, Train_accy 95.64:  30%|███       | 6/20 [00:42<01:37,  6.95s/it]
Task 9, Epoch 7/20 => Loss 0.192, Train_accy 95.64:  35%|███▌      | 7/20 [00:42<01:21,  6.28s/it]
Task 9, Epoch 8/20 => Loss 0.237, Train_accy 93.93:  35%|███▌      | 7/20 [00:47<01:21,  6.28s/it]
Task 9, Epoch 8/20 => Loss 0.237, Train_accy 93.93:  40%|████      | 8/20 [00:47<01:10,  5.84s/it]
Task 9, Epoch 9/20 => Loss 0.198, Train_accy 95.07:  40%|████      | 8/20 [00:52<01:10,  5.84s/it]
Task 9, Epoch 9/20 => Loss 0.198, Train_accy 95.07:  45%|████▌     | 9/20 [00:52<01:00,  5.54s/it]
Task 9, Epoch 10/20 => Loss 0.178, Train_accy 94.88, Test_accy 40.16:  45%|████▌     | 9/20 [01:05<01:00,  5.54s/it]
Task 9, Epoch 10/20 => Loss 0.178, Train_accy 94.88, Test_accy 40.16:  50%|█████     | 10/20 [01:05<01:20,  8.10s/it]
Task 9, Epoch 11/20 => Loss 0.171, Train_accy 95.26:  50%|█████     | 10/20 [01:10<01:20,  8.10s/it]                 
Task 9, Epoch 11/20 => Loss 0.171, Train_accy 95.26:  55%|█████▌    | 11/20 [01:10<01:04,  7.13s/it]
Task 9, Epoch 12/20 => Loss 0.150, Train_accy 95.83:  55%|█████▌    | 11/20 [01:15<01:04,  7.13s/it]
Task 9, Epoch 12/20 => Loss 0.150, Train_accy 95.83:  60%|██████    | 12/20 [01:15<00:51,  6.48s/it]
Task 9, Epoch 13/20 => Loss 0.149, Train_accy 95.83:  60%|██████    | 12/20 [01:20<00:51,  6.48s/it]
Task 9, Epoch 13/20 => Loss 0.149, Train_accy 95.83:  65%|██████▌   | 13/20 [01:20<00:42,  6.02s/it]
Task 9, Epoch 14/20 => Loss 0.120, Train_accy 96.39:  65%|██████▌   | 13/20 [01:25<00:42,  6.02s/it]
Task 9, Epoch 14/20 => Loss 0.120, Train_accy 96.39:  70%|███████   | 14/20 [01:25<00:34,  5.67s/it]
Task 9, Epoch 15/20 => Loss 0.117, Train_accy 97.34, Test_accy 40.09:  70%|███████   | 14/20 [01:39<00:34,  5.67s/it]
Task 9, Epoch 15/20 => Loss 0.117, Train_accy 97.34, Test_accy 40.09:  75%|███████▌  | 15/20 [01:39<00:41,  8.21s/it]
Task 9, Epoch 16/20 => Loss 0.120, Train_accy 96.20:  75%|███████▌  | 15/20 [01:44<00:41,  8.21s/it]                 
Task 9, Epoch 16/20 => Loss 0.120, Train_accy 96.20:  80%|████████  | 16/20 [01:44<00:28,  7.22s/it]
Task 9, Epoch 17/20 => Loss 0.115, Train_accy 97.15:  80%|████████  | 16/20 [01:49<00:28,  7.22s/it]
Task 9, Epoch 17/20 => Loss 0.115, Train_accy 97.15:  85%|████████▌ | 17/20 [01:49<00:19,  6.52s/it]
Task 9, Epoch 18/20 => Loss 0.078, Train_accy 98.29:  85%|████████▌ | 17/20 [01:54<00:19,  6.52s/it]
Task 9, Epoch 18/20 => Loss 0.078, Train_accy 98.29:  90%|█████████ | 18/20 [01:54<00:12,  6.05s/it]
Task 9, Epoch 19/20 => Loss 0.087, Train_accy 96.58:  90%|█████████ | 18/20 [01:59<00:12,  6.05s/it]
Task 9, Epoch 19/20 => Loss 0.087, Train_accy 96.58:  95%|█████████▌| 19/20 [01:59<00:05,  5.70s/it]
Task 9, Epoch 20/20 => Loss 0.109, Train_accy 97.53, Test_accy 40.29:  95%|█████████▌| 19/20 [02:13<00:05,  5.70s/it]
Task 9, Epoch 20/20 => Loss 0.109, Train_accy 97.53, Test_accy 40.29: 100%|██████████| 20/20 [02:13<00:00,  8.17s/it]
Task 9, Epoch 20/20 => Loss 0.109, Train_accy 97.53, Test_accy 40.29: 100%|██████████| 20/20 [02:13<00:00,  6.66s/it]
2024-09-12 09:41:56,328 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.109, Train_accy 97.53, Test_accy 40.29
2024-09-12 09:42:05,306 [trainer.py] => No NME accuracy.
2024-09-12 09:42:05,307 [trainer.py] => CNN: {'total': 40.29, '00-19': 61.71, '20-39': 56.22, '40-59': 40.52, '60-79': 36.04, '80-99': 37.06, '100-119': 34.33, '120-139': 29.45, '140-159': 32.28, '160-179': 29.25, '180-199': 37.9, 'old': 40.5, 'new': 37.9}
2024-09-12 09:42:05,307 [trainer.py] => CNN top1 curve: [76.0, 67.22, 60.92, 53.58, 49.82, 47.38, 45.41, 43.27, 40.86, 40.29]
2024-09-12 09:42:05,307 [trainer.py] => CNN top5 curve: [92.57, 89.17, 86.97, 82.66, 79.19, 77.03, 74.4, 71.55, 69.61, 68.33]

Average Accuracy (CNN): 52.47
2024-09-12 09:42:05,307 [trainer.py] => Average Accuracy (CNN): 52.47 

Accuracy Matrix (CNN):
[[76.   71.43 69.71 66.86 62.86 63.43 62.86 61.71 60.   61.71]
 [ 0.   63.24 57.84 56.22 56.22 55.14 55.14 54.59 54.59 56.22]
 [ 0.    0.   52.59 47.41 49.14 48.28 47.41 44.83 41.38 40.52]
 [ 0.    0.    0.   44.14 41.44 39.64 38.29 38.74 37.84 36.04]
 [ 0.    0.    0.    0.   39.16 39.16 39.16 37.76 39.16 37.06]
 [ 0.    0.    0.    0.    0.   36.57 37.31 36.57 34.33 34.33]
 [ 0.    0.    0.    0.    0.    0.   34.93 33.56 32.19 29.45]
 [ 0.    0.    0.    0.    0.    0.    0.   32.28 31.5  32.28]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   29.25 29.25]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   37.9 ]]
2024-09-12 09:42:05,309 [trainer.py] => Forgetting (CNN): 5.782222222222223
2024-09-12 09:42:08,117 [trainer.py] => config: ./exps/dualprompt_ina_B0_Inc20.json
2024-09-12 09:42:08,148 [trainer.py] => prefix:  
2024-09-12 09:42:08,148 [trainer.py] => dataset: imageneta
2024-09-12 09:42:08,148 [trainer.py] => memory_size: 0
2024-09-12 09:42:08,148 [trainer.py] => memory_per_class: 0
2024-09-12 09:42:08,148 [trainer.py] => fixed_memory: False
2024-09-12 09:42:08,148 [trainer.py] => shuffle: True
2024-09-12 09:42:08,148 [trainer.py] => init_cls: 10
2024-09-12 09:42:08,148 [trainer.py] => increment: 10
2024-09-12 09:42:08,148 [trainer.py] => model_name: dualprompt
2024-09-12 09:42:08,148 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 09:42:08,148 [trainer.py] => get_original_backbone: True
2024-09-12 09:42:08,148 [trainer.py] => device: [device(type='cuda', index=5)]
2024-09-12 09:42:08,148 [trainer.py] => seed: 1993
2024-09-12 09:42:08,149 [trainer.py] => tuned_epoch: 20
2024-09-12 09:42:08,149 [trainer.py] => init_lr: 0.001
2024-09-12 09:42:08,149 [trainer.py] => batch_size: 48
2024-09-12 09:42:08,149 [trainer.py] => weight_decay: 0
2024-09-12 09:42:08,149 [trainer.py] => min_lr: 1e-05
2024-09-12 09:42:08,149 [trainer.py] => optimizer: adam
2024-09-12 09:42:08,149 [trainer.py] => scheduler: constant
2024-09-12 09:42:08,149 [trainer.py] => reinit_optimizer: True
2024-09-12 09:42:08,149 [trainer.py] => global_pool: token
2024-09-12 09:42:08,149 [trainer.py] => head_type: token
2024-09-12 09:42:08,149 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 09:42:08,149 [trainer.py] => pretrained: True
2024-09-12 09:42:08,149 [trainer.py] => drop: 0.0
2024-09-12 09:42:08,149 [trainer.py] => drop_path: 0.0
2024-09-12 09:42:08,149 [trainer.py] => use_g_prompt: True
2024-09-12 09:42:08,149 [trainer.py] => g_prompt_length: 5
2024-09-12 09:42:08,149 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 09:42:08,149 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 09:42:08,150 [trainer.py] => use_e_prompt: True
2024-09-12 09:42:08,150 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 09:42:08,150 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 09:42:08,150 [trainer.py] => prompt_pool: True
2024-09-12 09:42:08,150 [trainer.py] => size: 10
2024-09-12 09:42:08,150 [trainer.py] => length: 5
2024-09-12 09:42:08,150 [trainer.py] => top_k: 1
2024-09-12 09:42:08,150 [trainer.py] => initializer: uniform
2024-09-12 09:42:08,150 [trainer.py] => prompt_key: True
2024-09-12 09:42:08,150 [trainer.py] => prompt_key_init: uniform
2024-09-12 09:42:08,150 [trainer.py] => use_prompt_mask: True
2024-09-12 09:42:08,150 [trainer.py] => shared_prompt_pool: True
2024-09-12 09:42:08,150 [trainer.py] => shared_prompt_key: False
2024-09-12 09:42:08,150 [trainer.py] => batchwise_prompt: True
2024-09-12 09:42:08,150 [trainer.py] => embedding_key: cls
2024-09-12 09:42:08,150 [trainer.py] => predefined_key: 
2024-09-12 09:42:08,150 [trainer.py] => pull_constraint: True
2024-09-12 09:42:08,150 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 09:42:08,151 [trainer.py] => same_key_value: False
2024-09-12 09:42:08,186 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 09:42:11,836 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 09:42:11,836 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 09:42:11,836 [dualprompt.py] => g_prompt: 15360
2024-09-12 09:42:11,836 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 09:42:11,836 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 09:42:11,837 [dualprompt.py] => head.weight: 153600
2024-09-12 09:42:11,837 [dualprompt.py] => head.bias: 200
2024-09-12 09:42:11,838 [trainer.py] => All params: 172158352
2024-09-12 09:42:11,839 [trainer.py] => Trainable params: 407240
2024-09-12 09:42:11,839 [dualprompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.135, Train_accy 30.90:   0%|          | 0/20 [00:03<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.135, Train_accy 30.90:   5%|▌         | 1/20 [00:03<01:01,  3.23s/it]
Task 0, Epoch 2/20 => Loss 1.252, Train_accy 62.13:   5%|▌         | 1/20 [00:06<01:01,  3.23s/it]
Task 0, Epoch 2/20 => Loss 1.252, Train_accy 62.13:  10%|█         | 2/20 [00:06<00:54,  3.01s/it]
Task 0, Epoch 3/20 => Loss 0.853, Train_accy 73.75:  10%|█         | 2/20 [00:08<00:54,  3.01s/it]
Task 0, Epoch 3/20 => Loss 0.853, Train_accy 73.75:  15%|█▌        | 3/20 [00:08<00:49,  2.93s/it]
Task 0, Epoch 4/20 => Loss 0.601, Train_accy 82.72:  15%|█▌        | 3/20 [00:11<00:49,  2.93s/it]
Task 0, Epoch 4/20 => Loss 0.601, Train_accy 82.72:  20%|██        | 4/20 [00:11<00:46,  2.94s/it]
Task 0, Epoch 5/20 => Loss 0.449, Train_accy 89.04, Test_accy 67.53:  20%|██        | 4/20 [00:15<00:46,  2.94s/it]
Task 0, Epoch 5/20 => Loss 0.449, Train_accy 89.04, Test_accy 67.53:  25%|██▌       | 5/20 [00:15<00:47,  3.14s/it]
Task 0, Epoch 6/20 => Loss 0.351, Train_accy 93.36:  25%|██▌       | 5/20 [00:18<00:47,  3.14s/it]                 
Task 0, Epoch 6/20 => Loss 0.351, Train_accy 93.36:  30%|███       | 6/20 [00:18<00:41,  2.98s/it]
Task 0, Epoch 7/20 => Loss 0.372, Train_accy 89.04:  30%|███       | 6/20 [00:20<00:41,  2.98s/it]
Task 0, Epoch 7/20 => Loss 0.372, Train_accy 89.04:  35%|███▌      | 7/20 [00:20<00:37,  2.90s/it]
Task 0, Epoch 8/20 => Loss 0.300, Train_accy 93.36:  35%|███▌      | 7/20 [00:23<00:37,  2.90s/it]
Task 0, Epoch 8/20 => Loss 0.300, Train_accy 93.36:  40%|████      | 8/20 [00:23<00:34,  2.85s/it]
Task 0, Epoch 9/20 => Loss 0.237, Train_accy 95.02:  40%|████      | 8/20 [00:26<00:34,  2.85s/it]
Task 0, Epoch 9/20 => Loss 0.237, Train_accy 95.02:  45%|████▌     | 9/20 [00:26<00:30,  2.79s/it]
Task 0, Epoch 10/20 => Loss 0.209, Train_accy 95.35, Test_accy 71.43:  45%|████▌     | 9/20 [00:29<00:30,  2.79s/it]
Task 0, Epoch 10/20 => Loss 0.209, Train_accy 95.35, Test_accy 71.43:  50%|█████     | 10/20 [00:29<00:30,  3.07s/it]
Task 0, Epoch 11/20 => Loss 0.182, Train_accy 97.34:  50%|█████     | 10/20 [00:32<00:30,  3.07s/it]                 
Task 0, Epoch 11/20 => Loss 0.182, Train_accy 97.34:  55%|█████▌    | 11/20 [00:32<00:26,  2.97s/it]
Task 0, Epoch 12/20 => Loss 0.186, Train_accy 96.01:  55%|█████▌    | 11/20 [00:35<00:26,  2.97s/it]
Task 0, Epoch 12/20 => Loss 0.186, Train_accy 96.01:  60%|██████    | 12/20 [00:35<00:23,  2.89s/it]
Task 0, Epoch 13/20 => Loss 0.137, Train_accy 97.01:  60%|██████    | 12/20 [00:38<00:23,  2.89s/it]
Task 0, Epoch 13/20 => Loss 0.137, Train_accy 97.01:  65%|██████▌   | 13/20 [00:38<00:19,  2.83s/it]
Task 0, Epoch 14/20 => Loss 0.168, Train_accy 97.34:  65%|██████▌   | 13/20 [00:40<00:19,  2.83s/it]
Task 0, Epoch 14/20 => Loss 0.168, Train_accy 97.34:  70%|███████   | 14/20 [00:40<00:16,  2.79s/it]
Task 0, Epoch 15/20 => Loss 0.133, Train_accy 97.34, Test_accy 74.03:  70%|███████   | 14/20 [00:44<00:16,  2.79s/it]
Task 0, Epoch 15/20 => Loss 0.133, Train_accy 97.34, Test_accy 74.03:  75%|███████▌  | 15/20 [00:44<00:15,  3.05s/it]
Task 0, Epoch 16/20 => Loss 0.151, Train_accy 96.68:  75%|███████▌  | 15/20 [00:47<00:15,  3.05s/it]                 
Task 0, Epoch 16/20 => Loss 0.151, Train_accy 96.68:  80%|████████  | 16/20 [00:47<00:12,  3.02s/it]
Task 0, Epoch 17/20 => Loss 0.124, Train_accy 96.01:  80%|████████  | 16/20 [00:50<00:12,  3.02s/it]
Task 0, Epoch 17/20 => Loss 0.124, Train_accy 96.01:  85%|████████▌ | 17/20 [00:50<00:09,  3.00s/it]
Task 0, Epoch 18/20 => Loss 0.111, Train_accy 97.34:  85%|████████▌ | 17/20 [00:53<00:09,  3.00s/it]
Task 0, Epoch 18/20 => Loss 0.111, Train_accy 97.34:  90%|█████████ | 18/20 [00:53<00:06,  3.02s/it]
Task 0, Epoch 19/20 => Loss 0.086, Train_accy 97.67:  90%|█████████ | 18/20 [00:56<00:06,  3.02s/it]
Task 0, Epoch 19/20 => Loss 0.086, Train_accy 97.67:  95%|█████████▌| 19/20 [00:56<00:02,  2.99s/it]
Task 0, Epoch 20/20 => Loss 0.093, Train_accy 98.67, Test_accy 75.32:  95%|█████████▌| 19/20 [01:00<00:02,  2.99s/it]
Task 0, Epoch 20/20 => Loss 0.093, Train_accy 98.67, Test_accy 75.32: 100%|██████████| 20/20 [01:00<00:00,  3.26s/it]
Task 0, Epoch 20/20 => Loss 0.093, Train_accy 98.67, Test_accy 75.32: 100%|██████████| 20/20 [01:00<00:00,  3.01s/it]
2024-09-12 09:43:12,489 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.093, Train_accy 98.67, Test_accy 75.32
2024-09-12 09:43:13,359 [trainer.py] => No NME accuracy.
2024-09-12 09:43:13,359 [trainer.py] => CNN: {'total': 75.32, '00-09': 75.32, 'old': 0, 'new': 75.32}
2024-09-12 09:43:13,359 [trainer.py] => CNN top1 curve: [75.32]
2024-09-12 09:43:13,359 [trainer.py] => CNN top5 curve: [93.51]

Average Accuracy (CNN): 75.32
2024-09-12 09:43:13,360 [trainer.py] => Average Accuracy (CNN): 75.32 

2024-09-12 09:43:13,363 [trainer.py] => All params: 172158352
2024-09-12 09:43:13,365 [trainer.py] => Trainable params: 407240
2024-09-12 09:43:13,366 [dualprompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.925, Train_accy 38.12:   0%|          | 0/20 [00:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.925, Train_accy 38.12:   5%|▌         | 1/20 [00:03<01:10,  3.73s/it]
Task 1, Epoch 2/20 => Loss 0.861, Train_accy 71.04:   5%|▌         | 1/20 [00:07<01:10,  3.73s/it]
Task 1, Epoch 2/20 => Loss 0.861, Train_accy 71.04:  10%|█         | 2/20 [00:07<01:07,  3.77s/it]
Task 1, Epoch 3/20 => Loss 0.509, Train_accy 84.65:  10%|█         | 2/20 [00:11<01:07,  3.77s/it]
Task 1, Epoch 3/20 => Loss 0.509, Train_accy 84.65:  15%|█▌        | 3/20 [00:11<01:04,  3.79s/it]
Task 1, Epoch 4/20 => Loss 0.344, Train_accy 89.60:  15%|█▌        | 3/20 [00:15<01:04,  3.79s/it]
Task 1, Epoch 4/20 => Loss 0.344, Train_accy 89.60:  20%|██        | 4/20 [00:15<01:00,  3.79s/it]
Task 1, Epoch 5/20 => Loss 0.301, Train_accy 90.84, Test_accy 66.86:  20%|██        | 4/20 [00:20<01:00,  3.79s/it]
Task 1, Epoch 5/20 => Loss 0.301, Train_accy 90.84, Test_accy 66.86:  25%|██▌       | 5/20 [00:20<01:04,  4.33s/it]
Task 1, Epoch 6/20 => Loss 0.212, Train_accy 94.55:  25%|██▌       | 5/20 [00:24<01:04,  4.33s/it]                 
Task 1, Epoch 6/20 => Loss 0.212, Train_accy 94.55:  30%|███       | 6/20 [00:24<00:58,  4.16s/it]
Task 1, Epoch 7/20 => Loss 0.283, Train_accy 92.33:  30%|███       | 6/20 [00:28<00:58,  4.16s/it]
Task 1, Epoch 7/20 => Loss 0.283, Train_accy 92.33:  35%|███▌      | 7/20 [00:28<00:52,  4.03s/it]
Task 1, Epoch 8/20 => Loss 0.162, Train_accy 96.53:  35%|███▌      | 7/20 [00:31<00:52,  4.03s/it]
Task 1, Epoch 8/20 => Loss 0.162, Train_accy 96.53:  40%|████      | 8/20 [00:31<00:47,  3.96s/it]
Task 1, Epoch 9/20 => Loss 0.167, Train_accy 95.05:  40%|████      | 8/20 [00:35<00:47,  3.96s/it]
Task 1, Epoch 9/20 => Loss 0.167, Train_accy 95.05:  45%|████▌     | 9/20 [00:35<00:43,  3.92s/it]
Task 1, Epoch 10/20 => Loss 0.116, Train_accy 97.03, Test_accy 71.43:  45%|████▌     | 9/20 [00:40<00:43,  3.92s/it]
Task 1, Epoch 10/20 => Loss 0.116, Train_accy 97.03, Test_accy 71.43:  50%|█████     | 10/20 [00:40<00:43,  4.34s/it]
Task 1, Epoch 11/20 => Loss 0.188, Train_accy 94.31:  50%|█████     | 10/20 [00:44<00:43,  4.34s/it]                 
Task 1, Epoch 11/20 => Loss 0.188, Train_accy 94.31:  55%|█████▌    | 11/20 [00:44<00:37,  4.18s/it]
Task 1, Epoch 12/20 => Loss 0.112, Train_accy 97.28:  55%|█████▌    | 11/20 [00:48<00:37,  4.18s/it]
Task 1, Epoch 12/20 => Loss 0.112, Train_accy 97.28:  60%|██████    | 12/20 [00:48<00:32,  4.06s/it]
Task 1, Epoch 13/20 => Loss 0.126, Train_accy 96.29:  60%|██████    | 12/20 [00:52<00:32,  4.06s/it]
Task 1, Epoch 13/20 => Loss 0.126, Train_accy 96.29:  65%|██████▌   | 13/20 [00:52<00:27,  4.00s/it]
Task 1, Epoch 14/20 => Loss 0.119, Train_accy 97.03:  65%|██████▌   | 13/20 [00:56<00:27,  4.00s/it]
Task 1, Epoch 14/20 => Loss 0.119, Train_accy 97.03:  70%|███████   | 14/20 [00:56<00:23,  3.96s/it]
Task 1, Epoch 15/20 => Loss 0.110, Train_accy 96.29, Test_accy 73.71:  70%|███████   | 14/20 [01:01<00:23,  3.96s/it]
Task 1, Epoch 15/20 => Loss 0.110, Train_accy 96.29, Test_accy 73.71:  75%|███████▌  | 15/20 [01:01<00:21,  4.37s/it]
Task 1, Epoch 16/20 => Loss 0.088, Train_accy 96.78:  75%|███████▌  | 15/20 [01:05<00:21,  4.37s/it]                 
Task 1, Epoch 16/20 => Loss 0.088, Train_accy 96.78:  80%|████████  | 16/20 [01:05<00:16,  4.23s/it]
Task 1, Epoch 17/20 => Loss 0.083, Train_accy 98.27:  80%|████████  | 16/20 [01:09<00:16,  4.23s/it]
Task 1, Epoch 17/20 => Loss 0.083, Train_accy 98.27:  85%|████████▌ | 17/20 [01:09<00:12,  4.08s/it]
Task 1, Epoch 18/20 => Loss 0.088, Train_accy 98.27:  85%|████████▌ | 17/20 [01:13<00:12,  4.08s/it]
Task 1, Epoch 18/20 => Loss 0.088, Train_accy 98.27:  90%|█████████ | 18/20 [01:13<00:08,  4.03s/it]
Task 1, Epoch 19/20 => Loss 0.072, Train_accy 98.02:  90%|█████████ | 18/20 [01:16<00:08,  4.03s/it]
Task 1, Epoch 19/20 => Loss 0.072, Train_accy 98.02:  95%|█████████▌| 19/20 [01:16<00:03,  3.98s/it]
Task 1, Epoch 20/20 => Loss 0.084, Train_accy 98.02, Test_accy 73.71:  95%|█████████▌| 19/20 [01:22<00:03,  3.98s/it]
Task 1, Epoch 20/20 => Loss 0.084, Train_accy 98.02, Test_accy 73.71: 100%|██████████| 20/20 [01:22<00:00,  4.35s/it]
Task 1, Epoch 20/20 => Loss 0.084, Train_accy 98.02, Test_accy 73.71: 100%|██████████| 20/20 [01:22<00:00,  4.11s/it]
2024-09-12 09:44:35,568 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.084, Train_accy 98.02, Test_accy 73.71
2024-09-12 09:44:37,104 [trainer.py] => No NME accuracy.
2024-09-12 09:44:37,105 [trainer.py] => CNN: {'total': 73.71, '00-09': 67.53, '10-19': 78.57, 'old': 67.53, 'new': 78.57}
2024-09-12 09:44:37,105 [trainer.py] => CNN top1 curve: [75.32, 73.71]
2024-09-12 09:44:37,105 [trainer.py] => CNN top5 curve: [93.51, 92.0]

Average Accuracy (CNN): 74.51
2024-09-12 09:44:37,105 [trainer.py] => Average Accuracy (CNN): 74.51 

2024-09-12 09:44:37,108 [trainer.py] => All params: 172158352
2024-09-12 09:44:37,110 [trainer.py] => Trainable params: 407240
2024-09-12 09:44:37,110 [dualprompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.608, Train_accy 16.53:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.608, Train_accy 16.53:   5%|▌         | 1/20 [00:03<01:06,  3.51s/it]
Task 2, Epoch 2/20 => Loss 1.373, Train_accy 50.96:   5%|▌         | 1/20 [00:06<01:06,  3.51s/it]
Task 2, Epoch 2/20 => Loss 1.373, Train_accy 50.96:  10%|█         | 2/20 [00:06<01:02,  3.49s/it]
Task 2, Epoch 3/20 => Loss 0.887, Train_accy 71.63:  10%|█         | 2/20 [00:10<01:02,  3.49s/it]
Task 2, Epoch 3/20 => Loss 0.887, Train_accy 71.63:  15%|█▌        | 3/20 [00:10<00:59,  3.48s/it]
Task 2, Epoch 4/20 => Loss 0.642, Train_accy 79.89:  15%|█▌        | 3/20 [00:13<00:59,  3.48s/it]
Task 2, Epoch 4/20 => Loss 0.642, Train_accy 79.89:  20%|██        | 4/20 [00:13<00:55,  3.49s/it]
Task 2, Epoch 5/20 => Loss 0.486, Train_accy 83.75, Test_accy 65.69:  20%|██        | 4/20 [00:19<00:55,  3.49s/it]
Task 2, Epoch 5/20 => Loss 0.486, Train_accy 83.75, Test_accy 65.69:  25%|██▌       | 5/20 [00:19<01:04,  4.28s/it]
Task 2, Epoch 6/20 => Loss 0.376, Train_accy 92.29:  25%|██▌       | 5/20 [00:23<01:04,  4.28s/it]                 
Task 2, Epoch 6/20 => Loss 0.376, Train_accy 92.29:  30%|███       | 6/20 [00:23<00:56,  4.03s/it]
Task 2, Epoch 7/20 => Loss 0.333, Train_accy 90.91:  30%|███       | 6/20 [00:26<00:56,  4.03s/it]
Task 2, Epoch 7/20 => Loss 0.333, Train_accy 90.91:  35%|███▌      | 7/20 [00:26<00:50,  3.89s/it]
Task 2, Epoch 8/20 => Loss 0.305, Train_accy 92.56:  35%|███▌      | 7/20 [00:30<00:50,  3.89s/it]
Task 2, Epoch 8/20 => Loss 0.305, Train_accy 92.56:  40%|████      | 8/20 [00:30<00:45,  3.79s/it]
Task 2, Epoch 9/20 => Loss 0.265, Train_accy 92.84:  40%|████      | 8/20 [00:33<00:45,  3.79s/it]
Task 2, Epoch 9/20 => Loss 0.265, Train_accy 92.84:  45%|████▌     | 9/20 [00:33<00:40,  3.69s/it]
Task 2, Epoch 10/20 => Loss 0.275, Train_accy 91.74, Test_accy 67.15:  45%|████▌     | 9/20 [00:39<00:40,  3.69s/it]
Task 2, Epoch 10/20 => Loss 0.275, Train_accy 91.74, Test_accy 67.15:  50%|█████     | 10/20 [00:39<00:42,  4.27s/it]
Task 2, Epoch 11/20 => Loss 0.223, Train_accy 95.32:  50%|█████     | 10/20 [00:42<00:42,  4.27s/it]                 
Task 2, Epoch 11/20 => Loss 0.223, Train_accy 95.32:  55%|█████▌    | 11/20 [00:42<00:36,  4.03s/it]
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 95.32:  55%|█████▌    | 11/20 [00:46<00:36,  4.03s/it]
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 95.32:  60%|██████    | 12/20 [00:46<00:31,  3.89s/it]
Task 2, Epoch 13/20 => Loss 0.156, Train_accy 96.42:  60%|██████    | 12/20 [00:50<00:31,  3.89s/it]
Task 2, Epoch 13/20 => Loss 0.156, Train_accy 96.42:  65%|██████▌   | 13/20 [00:50<00:26,  3.79s/it]
Task 2, Epoch 14/20 => Loss 0.176, Train_accy 93.66:  65%|██████▌   | 13/20 [00:53<00:26,  3.79s/it]
Task 2, Epoch 14/20 => Loss 0.176, Train_accy 93.66:  70%|███████   | 14/20 [00:53<00:21,  3.62s/it]
Task 2, Epoch 15/20 => Loss 0.164, Train_accy 94.77, Test_accy 67.52:  70%|███████   | 14/20 [00:58<00:21,  3.62s/it]
Task 2, Epoch 15/20 => Loss 0.164, Train_accy 94.77, Test_accy 67.52:  75%|███████▌  | 15/20 [00:58<00:20,  4.11s/it]
Task 2, Epoch 16/20 => Loss 0.168, Train_accy 95.87:  75%|███████▌  | 15/20 [01:01<00:20,  4.11s/it]                 
Task 2, Epoch 16/20 => Loss 0.168, Train_accy 95.87:  80%|████████  | 16/20 [01:01<00:15,  3.85s/it]
Task 2, Epoch 17/20 => Loss 0.130, Train_accy 96.69:  80%|████████  | 16/20 [01:04<00:15,  3.85s/it]
Task 2, Epoch 17/20 => Loss 0.130, Train_accy 96.69:  85%|████████▌ | 17/20 [01:04<00:10,  3.67s/it]
Task 2, Epoch 18/20 => Loss 0.131, Train_accy 96.14:  85%|████████▌ | 17/20 [01:08<00:10,  3.67s/it]
Task 2, Epoch 18/20 => Loss 0.131, Train_accy 96.14:  90%|█████████ | 18/20 [01:08<00:07,  3.55s/it]
Task 2, Epoch 19/20 => Loss 0.084, Train_accy 98.07:  90%|█████████ | 18/20 [01:11<00:07,  3.55s/it]
Task 2, Epoch 19/20 => Loss 0.084, Train_accy 98.07:  95%|█████████▌| 19/20 [01:11<00:03,  3.48s/it]
Task 2, Epoch 20/20 => Loss 0.100, Train_accy 97.80, Test_accy 68.25:  95%|█████████▌| 19/20 [01:16<00:03,  3.48s/it]
Task 2, Epoch 20/20 => Loss 0.100, Train_accy 97.80, Test_accy 68.25: 100%|██████████| 20/20 [01:16<00:00,  4.02s/it]
Task 2, Epoch 20/20 => Loss 0.100, Train_accy 97.80, Test_accy 68.25: 100%|██████████| 20/20 [01:16<00:00,  3.84s/it]
2024-09-12 09:45:53,995 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.100, Train_accy 97.80, Test_accy 68.25
2024-09-12 09:45:56,000 [trainer.py] => No NME accuracy.
2024-09-12 09:45:56,000 [trainer.py] => CNN: {'total': 68.25, '00-09': 55.84, '10-19': 75.51, '20-29': 70.71, 'old': 66.86, 'new': 70.71}
2024-09-12 09:45:56,000 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25]
2024-09-12 09:45:56,000 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88]

Average Accuracy (CNN): 72.43
2024-09-12 09:45:56,001 [trainer.py] => Average Accuracy (CNN): 72.43 

2024-09-12 09:45:56,004 [trainer.py] => All params: 172158352
2024-09-12 09:45:56,006 [trainer.py] => Trainable params: 407240
2024-09-12 09:45:56,006 [dualprompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.377, Train_accy 22.58:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.377, Train_accy 22.58:   5%|▌         | 1/20 [00:03<01:10,  3.69s/it]
Task 3, Epoch 2/20 => Loss 1.150, Train_accy 61.54:   5%|▌         | 1/20 [00:07<01:10,  3.69s/it]
Task 3, Epoch 2/20 => Loss 1.150, Train_accy 61.54:  10%|█         | 2/20 [00:07<01:09,  3.88s/it]
Task 3, Epoch 3/20 => Loss 0.740, Train_accy 74.69:  10%|█         | 2/20 [00:11<01:09,  3.88s/it]
Task 3, Epoch 3/20 => Loss 0.740, Train_accy 74.69:  15%|█▌        | 3/20 [00:11<01:05,  3.84s/it]
Task 3, Epoch 4/20 => Loss 0.513, Train_accy 83.62:  15%|█▌        | 3/20 [00:15<01:05,  3.84s/it]
Task 3, Epoch 4/20 => Loss 0.513, Train_accy 83.62:  20%|██        | 4/20 [00:15<01:01,  3.84s/it]
Task 3, Epoch 5/20 => Loss 0.436, Train_accy 86.10, Test_accy 61.39:  20%|██        | 4/20 [00:21<01:01,  3.84s/it]
Task 3, Epoch 5/20 => Loss 0.436, Train_accy 86.10, Test_accy 61.39:  25%|██▌       | 5/20 [00:21<01:11,  4.75s/it]
Task 3, Epoch 6/20 => Loss 0.373, Train_accy 86.85:  25%|██▌       | 5/20 [00:25<01:11,  4.75s/it]                 
Task 3, Epoch 6/20 => Loss 0.373, Train_accy 86.85:  30%|███       | 6/20 [00:25<01:02,  4.46s/it]
Task 3, Epoch 7/20 => Loss 0.307, Train_accy 91.07:  30%|███       | 6/20 [00:29<01:02,  4.46s/it]
Task 3, Epoch 7/20 => Loss 0.307, Train_accy 91.07:  35%|███▌      | 7/20 [00:29<00:55,  4.25s/it]
Task 3, Epoch 8/20 => Loss 0.258, Train_accy 92.80:  35%|███▌      | 7/20 [00:33<00:55,  4.25s/it]
Task 3, Epoch 8/20 => Loss 0.258, Train_accy 92.80:  40%|████      | 8/20 [00:33<00:49,  4.14s/it]
Task 3, Epoch 9/20 => Loss 0.290, Train_accy 90.82:  40%|████      | 8/20 [00:37<00:49,  4.14s/it]
Task 3, Epoch 9/20 => Loss 0.290, Train_accy 90.82:  45%|████▌     | 9/20 [00:37<00:44,  4.06s/it]
Task 3, Epoch 10/20 => Loss 0.248, Train_accy 92.31, Test_accy 64.17:  45%|████▌     | 9/20 [00:43<00:44,  4.06s/it]
Task 3, Epoch 10/20 => Loss 0.248, Train_accy 92.31, Test_accy 64.17:  50%|█████     | 10/20 [00:43<00:47,  4.79s/it]
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 93.80:  50%|█████     | 10/20 [00:47<00:47,  4.79s/it]                 
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 93.80:  55%|█████▌    | 11/20 [00:47<00:40,  4.49s/it]
Task 3, Epoch 12/20 => Loss 0.234, Train_accy 93.05:  55%|█████▌    | 11/20 [00:51<00:40,  4.49s/it]
Task 3, Epoch 12/20 => Loss 0.234, Train_accy 93.05:  60%|██████    | 12/20 [00:51<00:34,  4.30s/it]
Task 3, Epoch 13/20 => Loss 0.237, Train_accy 90.57:  60%|██████    | 12/20 [00:55<00:34,  4.30s/it]
Task 3, Epoch 13/20 => Loss 0.237, Train_accy 90.57:  65%|██████▌   | 13/20 [00:55<00:29,  4.17s/it]
Task 3, Epoch 14/20 => Loss 0.233, Train_accy 91.07:  65%|██████▌   | 13/20 [00:58<00:29,  4.17s/it]
Task 3, Epoch 14/20 => Loss 0.233, Train_accy 91.07:  70%|███████   | 14/20 [00:58<00:24,  4.07s/it]
Task 3, Epoch 15/20 => Loss 0.198, Train_accy 93.55, Test_accy 62.78:  70%|███████   | 14/20 [01:05<00:24,  4.07s/it]
Task 3, Epoch 15/20 => Loss 0.198, Train_accy 93.55, Test_accy 62.78:  75%|███████▌  | 15/20 [01:05<00:23,  4.75s/it]
Task 3, Epoch 16/20 => Loss 0.201, Train_accy 93.30:  75%|███████▌  | 15/20 [01:09<00:23,  4.75s/it]                 
Task 3, Epoch 16/20 => Loss 0.201, Train_accy 93.30:  80%|████████  | 16/20 [01:09<00:17,  4.49s/it]
Task 3, Epoch 17/20 => Loss 0.128, Train_accy 96.77:  80%|████████  | 16/20 [01:13<00:17,  4.49s/it]
Task 3, Epoch 17/20 => Loss 0.128, Train_accy 96.77:  85%|████████▌ | 17/20 [01:13<00:12,  4.28s/it]
Task 3, Epoch 18/20 => Loss 0.176, Train_accy 93.80:  85%|████████▌ | 17/20 [01:16<00:12,  4.28s/it]
Task 3, Epoch 18/20 => Loss 0.176, Train_accy 93.80:  90%|█████████ | 18/20 [01:16<00:08,  4.16s/it]
Task 3, Epoch 19/20 => Loss 0.142, Train_accy 96.28:  90%|█████████ | 18/20 [01:20<00:08,  4.16s/it]
Task 3, Epoch 19/20 => Loss 0.142, Train_accy 96.28:  95%|█████████▌| 19/20 [01:20<00:04,  4.09s/it]
Task 3, Epoch 20/20 => Loss 0.156, Train_accy 95.04, Test_accy 63.61:  95%|█████████▌| 19/20 [01:27<00:04,  4.09s/it]
Task 3, Epoch 20/20 => Loss 0.156, Train_accy 95.04, Test_accy 63.61: 100%|██████████| 20/20 [01:27<00:00,  4.84s/it]
Task 3, Epoch 20/20 => Loss 0.156, Train_accy 95.04, Test_accy 63.61: 100%|██████████| 20/20 [01:27<00:00,  4.37s/it]
2024-09-12 09:47:23,415 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.156, Train_accy 95.04, Test_accy 63.61
2024-09-12 09:47:25,927 [trainer.py] => No NME accuracy.
2024-09-12 09:47:25,927 [trainer.py] => CNN: {'total': 63.61, '00-09': 55.84, '10-19': 72.45, '20-29': 65.66, '30-39': 58.14, 'old': 65.33, 'new': 58.14}
2024-09-12 09:47:25,928 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61]
2024-09-12 09:47:25,928 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5]

Average Accuracy (CNN): 70.22
2024-09-12 09:47:25,928 [trainer.py] => Average Accuracy (CNN): 70.22 

2024-09-12 09:47:25,930 [trainer.py] => All params: 172158352
2024-09-12 09:47:25,933 [trainer.py] => Trainable params: 407240
2024-09-12 09:47:25,933 [dualprompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.603, Train_accy 18.45:   0%|          | 0/20 [00:02<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.603, Train_accy 18.45:   5%|▌         | 1/20 [00:02<00:51,  2.71s/it]
Task 4, Epoch 2/20 => Loss 1.230, Train_accy 58.30:   5%|▌         | 1/20 [00:05<00:51,  2.71s/it]
Task 4, Epoch 2/20 => Loss 1.230, Train_accy 58.30:  10%|█         | 2/20 [00:05<00:49,  2.74s/it]
Task 4, Epoch 3/20 => Loss 0.702, Train_accy 76.75:  10%|█         | 2/20 [00:08<00:49,  2.74s/it]
Task 4, Epoch 3/20 => Loss 0.702, Train_accy 76.75:  15%|█▌        | 3/20 [00:08<00:46,  2.75s/it]
Task 4, Epoch 4/20 => Loss 0.477, Train_accy 86.35:  15%|█▌        | 3/20 [00:11<00:46,  2.75s/it]
Task 4, Epoch 4/20 => Loss 0.477, Train_accy 86.35:  20%|██        | 4/20 [00:11<00:44,  2.77s/it]
Task 4, Epoch 5/20 => Loss 0.313, Train_accy 91.88, Test_accy 57.78:  20%|██        | 4/20 [00:16<00:44,  2.77s/it]
Task 4, Epoch 5/20 => Loss 0.313, Train_accy 91.88, Test_accy 57.78:  25%|██▌       | 5/20 [00:16<00:57,  3.80s/it]
Task 4, Epoch 6/20 => Loss 0.299, Train_accy 91.88:  25%|██▌       | 5/20 [00:19<00:57,  3.80s/it]                 
Task 4, Epoch 6/20 => Loss 0.299, Train_accy 91.88:  30%|███       | 6/20 [00:19<00:48,  3.44s/it]
Task 4, Epoch 7/20 => Loss 0.231, Train_accy 93.36:  30%|███       | 6/20 [00:22<00:48,  3.44s/it]
Task 4, Epoch 7/20 => Loss 0.231, Train_accy 93.36:  35%|███▌      | 7/20 [00:22<00:42,  3.23s/it]
Task 4, Epoch 8/20 => Loss 0.227, Train_accy 92.99:  35%|███▌      | 7/20 [00:24<00:42,  3.23s/it]
Task 4, Epoch 8/20 => Loss 0.227, Train_accy 92.99:  40%|████      | 8/20 [00:24<00:37,  3.09s/it]
Task 4, Epoch 9/20 => Loss 0.215, Train_accy 94.10:  40%|████      | 8/20 [00:27<00:37,  3.09s/it]
Task 4, Epoch 9/20 => Loss 0.215, Train_accy 94.10:  45%|████▌     | 9/20 [00:27<00:32,  2.94s/it]
Task 4, Epoch 10/20 => Loss 0.142, Train_accy 97.42, Test_accy 58.02:  45%|████▌     | 9/20 [00:33<00:32,  2.94s/it]
Task 4, Epoch 10/20 => Loss 0.142, Train_accy 97.42, Test_accy 58.02:  50%|█████     | 10/20 [00:33<00:37,  3.78s/it]
Task 4, Epoch 11/20 => Loss 0.124, Train_accy 95.94:  50%|█████     | 10/20 [00:36<00:37,  3.78s/it]                 
Task 4, Epoch 11/20 => Loss 0.124, Train_accy 95.94:  55%|█████▌    | 11/20 [00:36<00:31,  3.46s/it]
Task 4, Epoch 12/20 => Loss 0.118, Train_accy 96.68:  55%|█████▌    | 11/20 [00:38<00:31,  3.46s/it]
Task 4, Epoch 12/20 => Loss 0.118, Train_accy 96.68:  60%|██████    | 12/20 [00:38<00:25,  3.24s/it]
Task 4, Epoch 13/20 => Loss 0.117, Train_accy 95.94:  60%|██████    | 12/20 [00:41<00:25,  3.24s/it]
Task 4, Epoch 13/20 => Loss 0.117, Train_accy 95.94:  65%|██████▌   | 13/20 [00:41<00:21,  3.10s/it]
Task 4, Epoch 14/20 => Loss 0.075, Train_accy 97.79:  65%|██████▌   | 13/20 [00:44<00:21,  3.10s/it]
Task 4, Epoch 14/20 => Loss 0.075, Train_accy 97.79:  70%|███████   | 14/20 [00:44<00:17,  2.98s/it]
Task 4, Epoch 15/20 => Loss 0.087, Train_accy 97.42, Test_accy 58.49:  70%|███████   | 14/20 [00:49<00:17,  2.98s/it]
Task 4, Epoch 15/20 => Loss 0.087, Train_accy 97.42, Test_accy 58.49:  75%|███████▌  | 15/20 [00:49<00:18,  3.79s/it]
Task 4, Epoch 16/20 => Loss 0.103, Train_accy 97.79:  75%|███████▌  | 15/20 [00:52<00:18,  3.79s/it]                 
Task 4, Epoch 16/20 => Loss 0.103, Train_accy 97.79:  80%|████████  | 16/20 [00:52<00:13,  3.48s/it]
Task 4, Epoch 17/20 => Loss 0.089, Train_accy 98.15:  80%|████████  | 16/20 [00:55<00:13,  3.48s/it]
Task 4, Epoch 17/20 => Loss 0.089, Train_accy 98.15:  85%|████████▌ | 17/20 [00:55<00:09,  3.25s/it]
Task 4, Epoch 18/20 => Loss 0.089, Train_accy 97.42:  85%|████████▌ | 17/20 [00:58<00:09,  3.25s/it]
Task 4, Epoch 18/20 => Loss 0.089, Train_accy 97.42:  90%|█████████ | 18/20 [00:58<00:06,  3.10s/it]
Task 4, Epoch 19/20 => Loss 0.103, Train_accy 97.05:  90%|█████████ | 18/20 [01:00<00:06,  3.10s/it]
Task 4, Epoch 19/20 => Loss 0.103, Train_accy 97.05:  95%|█████████▌| 19/20 [01:00<00:03,  3.00s/it]
Task 4, Epoch 20/20 => Loss 0.076, Train_accy 98.15, Test_accy 58.73:  95%|█████████▌| 19/20 [01:06<00:03,  3.00s/it]
Task 4, Epoch 20/20 => Loss 0.076, Train_accy 98.15, Test_accy 58.73: 100%|██████████| 20/20 [01:06<00:00,  3.79s/it]
Task 4, Epoch 20/20 => Loss 0.076, Train_accy 98.15, Test_accy 58.73: 100%|██████████| 20/20 [01:06<00:00,  3.32s/it]
2024-09-12 09:48:32,438 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.076, Train_accy 98.15, Test_accy 58.73
2024-09-12 09:48:35,194 [trainer.py] => No NME accuracy.
2024-09-12 09:48:35,194 [trainer.py] => CNN: {'total': 58.73, '00-09': 46.75, '10-19': 71.43, '20-29': 60.61, '30-39': 55.81, '40-49': 54.69, 'old': 59.44, 'new': 54.69}
2024-09-12 09:48:35,194 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73]
2024-09-12 09:48:35,194 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32]

Average Accuracy (CNN): 67.92
2024-09-12 09:48:35,195 [trainer.py] => Average Accuracy (CNN): 67.92 

2024-09-12 09:48:35,196 [trainer.py] => All params: 172158352
2024-09-12 09:48:35,198 [trainer.py] => Trainable params: 407240
2024-09-12 09:48:35,198 [dualprompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.357, Train_accy 29.17:   0%|          | 0/20 [00:02<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.357, Train_accy 29.17:   5%|▌         | 1/20 [00:02<00:42,  2.25s/it]
Task 5, Epoch 2/20 => Loss 1.057, Train_accy 64.17:   5%|▌         | 1/20 [00:04<00:42,  2.25s/it]
Task 5, Epoch 2/20 => Loss 1.057, Train_accy 64.17:  10%|█         | 2/20 [00:04<00:40,  2.24s/it]
Task 5, Epoch 3/20 => Loss 0.701, Train_accy 78.75:  10%|█         | 2/20 [00:06<00:40,  2.24s/it]
Task 5, Epoch 3/20 => Loss 0.701, Train_accy 78.75:  15%|█▌        | 3/20 [00:06<00:38,  2.24s/it]
Task 5, Epoch 4/20 => Loss 0.421, Train_accy 89.17:  15%|█▌        | 3/20 [00:09<00:38,  2.24s/it]
Task 5, Epoch 4/20 => Loss 0.421, Train_accy 89.17:  20%|██        | 4/20 [00:09<00:36,  2.29s/it]
Task 5, Epoch 5/20 => Loss 0.313, Train_accy 93.33, Test_accy 54.83:  20%|██        | 4/20 [00:14<00:36,  2.29s/it]
Task 5, Epoch 5/20 => Loss 0.313, Train_accy 93.33, Test_accy 54.83:  25%|██▌       | 5/20 [00:14<00:51,  3.41s/it]
Task 5, Epoch 6/20 => Loss 0.196, Train_accy 95.83:  25%|██▌       | 5/20 [00:16<00:51,  3.41s/it]                 
Task 5, Epoch 6/20 => Loss 0.196, Train_accy 95.83:  30%|███       | 6/20 [00:16<00:42,  3.01s/it]
Task 5, Epoch 7/20 => Loss 0.174, Train_accy 95.83:  30%|███       | 6/20 [00:18<00:42,  3.01s/it]
Task 5, Epoch 7/20 => Loss 0.174, Train_accy 95.83:  35%|███▌      | 7/20 [00:18<00:35,  2.75s/it]
Task 5, Epoch 8/20 => Loss 0.189, Train_accy 94.17:  35%|███▌      | 7/20 [00:21<00:35,  2.75s/it]
Task 5, Epoch 8/20 => Loss 0.189, Train_accy 94.17:  40%|████      | 8/20 [00:21<00:31,  2.60s/it]
Task 5, Epoch 9/20 => Loss 0.119, Train_accy 97.08:  40%|████      | 8/20 [00:23<00:31,  2.60s/it]
Task 5, Epoch 9/20 => Loss 0.119, Train_accy 97.08:  45%|████▌     | 9/20 [00:23<00:27,  2.49s/it]
Task 5, Epoch 10/20 => Loss 0.150, Train_accy 95.42, Test_accy 55.04:  45%|████▌     | 9/20 [00:28<00:27,  2.49s/it]
Task 5, Epoch 10/20 => Loss 0.150, Train_accy 95.42, Test_accy 55.04:  50%|█████     | 10/20 [00:28<00:33,  3.33s/it]
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 97.92:  50%|█████     | 10/20 [00:30<00:33,  3.33s/it]                 
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 97.92:  55%|█████▌    | 11/20 [00:30<00:27,  3.00s/it]
Task 5, Epoch 12/20 => Loss 0.115, Train_accy 96.25:  55%|█████▌    | 11/20 [00:33<00:27,  3.00s/it]
Task 5, Epoch 12/20 => Loss 0.115, Train_accy 96.25:  60%|██████    | 12/20 [00:33<00:22,  2.84s/it]
Task 5, Epoch 13/20 => Loss 0.091, Train_accy 97.08:  60%|██████    | 12/20 [00:35<00:22,  2.84s/it]
Task 5, Epoch 13/20 => Loss 0.091, Train_accy 97.08:  65%|██████▌   | 13/20 [00:35<00:18,  2.70s/it]
Task 5, Epoch 14/20 => Loss 0.092, Train_accy 97.92:  65%|██████▌   | 13/20 [00:38<00:18,  2.70s/it]
Task 5, Epoch 14/20 => Loss 0.092, Train_accy 97.92:  70%|███████   | 14/20 [00:38<00:15,  2.61s/it]
Task 5, Epoch 15/20 => Loss 0.096, Train_accy 96.67, Test_accy 55.04:  70%|███████   | 14/20 [00:43<00:15,  2.61s/it]
Task 5, Epoch 15/20 => Loss 0.096, Train_accy 96.67, Test_accy 55.04:  75%|███████▌  | 15/20 [00:43<00:17,  3.51s/it]
Task 5, Epoch 16/20 => Loss 0.062, Train_accy 98.75:  75%|███████▌  | 15/20 [00:46<00:17,  3.51s/it]                 
Task 5, Epoch 16/20 => Loss 0.062, Train_accy 98.75:  80%|████████  | 16/20 [00:46<00:12,  3.18s/it]
Task 5, Epoch 17/20 => Loss 0.081, Train_accy 97.92:  80%|████████  | 16/20 [00:48<00:12,  3.18s/it]
Task 5, Epoch 17/20 => Loss 0.081, Train_accy 97.92:  85%|████████▌ | 17/20 [00:48<00:08,  2.96s/it]
Task 5, Epoch 18/20 => Loss 0.087, Train_accy 97.08:  85%|████████▌ | 17/20 [00:51<00:08,  2.96s/it]
Task 5, Epoch 18/20 => Loss 0.087, Train_accy 97.08:  90%|█████████ | 18/20 [00:51<00:05,  2.79s/it]
Task 5, Epoch 19/20 => Loss 0.076, Train_accy 97.50:  90%|█████████ | 18/20 [00:53<00:05,  2.79s/it]
Task 5, Epoch 19/20 => Loss 0.076, Train_accy 97.50:  95%|█████████▌| 19/20 [00:53<00:02,  2.67s/it]
Task 5, Epoch 20/20 => Loss 0.050, Train_accy 99.17, Test_accy 53.99:  95%|█████████▌| 19/20 [00:59<00:02,  2.67s/it]
Task 5, Epoch 20/20 => Loss 0.050, Train_accy 99.17, Test_accy 53.99: 100%|██████████| 20/20 [00:59<00:00,  3.59s/it]
Task 5, Epoch 20/20 => Loss 0.050, Train_accy 99.17, Test_accy 53.99: 100%|██████████| 20/20 [00:59<00:00,  2.96s/it]
2024-09-12 09:49:34,364 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.050, Train_accy 99.17, Test_accy 53.99
2024-09-12 09:49:37,515 [trainer.py] => No NME accuracy.
2024-09-12 09:49:37,516 [trainer.py] => CNN: {'total': 53.99, '00-09': 42.86, '10-19': 70.41, '20-29': 57.58, '30-39': 50.0, '40-49': 50.0, '50-59': 44.23, 'old': 55.19, 'new': 44.23}
2024-09-12 09:49:37,516 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99]
2024-09-12 09:49:37,516 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24]

Average Accuracy (CNN): 65.6
2024-09-12 09:49:37,516 [trainer.py] => Average Accuracy (CNN): 65.6 

2024-09-12 09:49:37,519 [trainer.py] => All params: 172158352
2024-09-12 09:49:37,521 [trainer.py] => Trainable params: 407240
2024-09-12 09:49:37,521 [dualprompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.949, Train_accy 34.63:   0%|          | 0/20 [00:04<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.949, Train_accy 34.63:   5%|▌         | 1/20 [00:04<01:18,  4.14s/it]
Task 6, Epoch 2/20 => Loss 0.904, Train_accy 66.28:   5%|▌         | 1/20 [00:08<01:18,  4.14s/it]
Task 6, Epoch 2/20 => Loss 0.904, Train_accy 66.28:  10%|█         | 2/20 [00:08<01:15,  4.20s/it]
Task 6, Epoch 3/20 => Loss 0.566, Train_accy 80.73:  10%|█         | 2/20 [00:12<01:15,  4.20s/it]
Task 6, Epoch 3/20 => Loss 0.566, Train_accy 80.73:  15%|█▌        | 3/20 [00:12<01:11,  4.21s/it]
Task 6, Epoch 4/20 => Loss 0.483, Train_accy 85.09:  15%|█▌        | 3/20 [00:16<01:11,  4.21s/it]
Task 6, Epoch 4/20 => Loss 0.483, Train_accy 85.09:  20%|██        | 4/20 [00:16<01:06,  4.16s/it]
Task 6, Epoch 5/20 => Loss 0.255, Train_accy 93.35, Test_accy 49.00:  20%|██        | 4/20 [00:24<01:06,  4.16s/it]
Task 6, Epoch 5/20 => Loss 0.255, Train_accy 93.35, Test_accy 49.00:  25%|██▌       | 5/20 [00:24<01:23,  5.55s/it]
Task 6, Epoch 6/20 => Loss 0.263, Train_accy 93.35:  25%|██▌       | 5/20 [00:28<01:23,  5.55s/it]                 
Task 6, Epoch 6/20 => Loss 0.263, Train_accy 93.35:  30%|███       | 6/20 [00:28<01:11,  5.08s/it]
Task 6, Epoch 7/20 => Loss 0.269, Train_accy 92.43:  30%|███       | 6/20 [00:33<01:11,  5.08s/it]
Task 6, Epoch 7/20 => Loss 0.269, Train_accy 92.43:  35%|███▌      | 7/20 [00:33<01:02,  4.77s/it]
Task 6, Epoch 8/20 => Loss 0.242, Train_accy 93.12:  35%|███▌      | 7/20 [00:37<01:02,  4.77s/it]
Task 6, Epoch 8/20 => Loss 0.242, Train_accy 93.12:  40%|████      | 8/20 [00:37<00:54,  4.58s/it]
Task 6, Epoch 9/20 => Loss 0.223, Train_accy 92.66:  40%|████      | 8/20 [00:41<00:54,  4.58s/it]
Task 6, Epoch 9/20 => Loss 0.223, Train_accy 92.66:  45%|████▌     | 9/20 [00:41<00:48,  4.44s/it]
Task 6, Epoch 10/20 => Loss 0.145, Train_accy 95.18, Test_accy 50.00:  45%|████▌     | 9/20 [00:49<00:48,  4.44s/it]
Task 6, Epoch 10/20 => Loss 0.145, Train_accy 95.18, Test_accy 50.00:  50%|█████     | 10/20 [00:49<00:55,  5.59s/it]
Task 6, Epoch 11/20 => Loss 0.171, Train_accy 95.87:  50%|█████     | 10/20 [00:53<00:55,  5.59s/it]                 
Task 6, Epoch 11/20 => Loss 0.171, Train_accy 95.87:  55%|█████▌    | 11/20 [00:53<00:46,  5.16s/it]
Task 6, Epoch 12/20 => Loss 0.129, Train_accy 95.18:  55%|█████▌    | 11/20 [00:57<00:46,  5.16s/it]
Task 6, Epoch 12/20 => Loss 0.129, Train_accy 95.18:  60%|██████    | 12/20 [00:57<00:38,  4.84s/it]
Task 6, Epoch 13/20 => Loss 0.199, Train_accy 95.64:  60%|██████    | 12/20 [01:01<00:38,  4.84s/it]
Task 6, Epoch 13/20 => Loss 0.199, Train_accy 95.64:  65%|██████▌   | 13/20 [01:01<00:32,  4.62s/it]
Task 6, Epoch 14/20 => Loss 0.120, Train_accy 96.10:  65%|██████▌   | 13/20 [01:05<00:32,  4.62s/it]
Task 6, Epoch 14/20 => Loss 0.120, Train_accy 96.10:  70%|███████   | 14/20 [01:05<00:26,  4.47s/it]
Task 6, Epoch 15/20 => Loss 0.124, Train_accy 94.95, Test_accy 51.33:  70%|███████   | 14/20 [01:13<00:26,  4.47s/it]
Task 6, Epoch 15/20 => Loss 0.124, Train_accy 94.95, Test_accy 51.33:  75%|███████▌  | 15/20 [01:13<00:27,  5.52s/it]
Task 6, Epoch 16/20 => Loss 0.137, Train_accy 95.41:  75%|███████▌  | 15/20 [01:18<00:27,  5.52s/it]                 
Task 6, Epoch 16/20 => Loss 0.137, Train_accy 95.41:  80%|████████  | 16/20 [01:18<00:20,  5.11s/it]
Task 6, Epoch 17/20 => Loss 0.121, Train_accy 96.56:  80%|████████  | 16/20 [01:22<00:20,  5.11s/it]
Task 6, Epoch 17/20 => Loss 0.121, Train_accy 96.56:  85%|████████▌ | 17/20 [01:22<00:14,  4.82s/it]
Task 6, Epoch 18/20 => Loss 0.117, Train_accy 96.10:  85%|████████▌ | 17/20 [01:26<00:14,  4.82s/it]
Task 6, Epoch 18/20 => Loss 0.117, Train_accy 96.10:  90%|█████████ | 18/20 [01:26<00:09,  4.63s/it]
Task 6, Epoch 19/20 => Loss 0.116, Train_accy 96.79:  90%|█████████ | 18/20 [01:30<00:09,  4.63s/it]
Task 6, Epoch 19/20 => Loss 0.116, Train_accy 96.79:  95%|█████████▌| 19/20 [01:30<00:04,  4.47s/it]
Task 6, Epoch 20/20 => Loss 0.105, Train_accy 97.48, Test_accy 50.83:  95%|█████████▌| 19/20 [01:38<00:04,  4.47s/it]
Task 6, Epoch 20/20 => Loss 0.105, Train_accy 97.48, Test_accy 50.83: 100%|██████████| 20/20 [01:38<00:00,  5.55s/it]
Task 6, Epoch 20/20 => Loss 0.105, Train_accy 97.48, Test_accy 50.83: 100%|██████████| 20/20 [01:38<00:00,  4.93s/it]
2024-09-12 09:51:16,146 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.105, Train_accy 97.48, Test_accy 50.83
2024-09-12 09:51:20,008 [trainer.py] => No NME accuracy.
2024-09-12 09:51:20,008 [trainer.py] => CNN: {'total': 50.83, '00-09': 42.86, '10-19': 67.35, '20-29': 59.6, '30-39': 47.67, '40-49': 45.31, '50-59': 42.31, '60-69': 44.44, 'old': 52.52, 'new': 44.44}
2024-09-12 09:51:20,008 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83]
2024-09-12 09:51:20,008 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39]

Average Accuracy (CNN): 63.49
2024-09-12 09:51:20,008 [trainer.py] => Average Accuracy (CNN): 63.49 

2024-09-12 09:51:20,010 [trainer.py] => All params: 172158352
2024-09-12 09:51:20,011 [trainer.py] => Trainable params: 407240
2024-09-12 09:51:20,011 [dualprompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.995, Train_accy 36.78:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.995, Train_accy 36.78:   5%|▌         | 1/20 [00:03<01:07,  3.54s/it]
Task 7, Epoch 2/20 => Loss 0.924, Train_accy 69.25:   5%|▌         | 1/20 [00:06<01:07,  3.54s/it]
Task 7, Epoch 2/20 => Loss 0.924, Train_accy 69.25:  10%|█         | 2/20 [00:06<01:02,  3.48s/it]
Task 7, Epoch 3/20 => Loss 0.532, Train_accy 83.33:  10%|█         | 2/20 [00:10<01:02,  3.48s/it]
Task 7, Epoch 3/20 => Loss 0.532, Train_accy 83.33:  15%|█▌        | 3/20 [00:10<00:58,  3.46s/it]
Task 7, Epoch 4/20 => Loss 0.317, Train_accy 91.95:  15%|█▌        | 3/20 [00:13<00:58,  3.46s/it]
Task 7, Epoch 4/20 => Loss 0.317, Train_accy 91.95:  20%|██        | 4/20 [00:13<00:55,  3.46s/it]
Task 7, Epoch 5/20 => Loss 0.234, Train_accy 93.10, Test_accy 46.70:  20%|██        | 4/20 [00:21<00:55,  3.46s/it]
Task 7, Epoch 5/20 => Loss 0.234, Train_accy 93.10, Test_accy 46.70:  25%|██▌       | 5/20 [00:21<01:13,  4.88s/it]
Task 7, Epoch 6/20 => Loss 0.190, Train_accy 95.40:  25%|██▌       | 5/20 [00:24<01:13,  4.88s/it]                 
Task 7, Epoch 6/20 => Loss 0.190, Train_accy 95.40:  30%|███       | 6/20 [00:24<01:00,  4.29s/it]
Task 7, Epoch 7/20 => Loss 0.206, Train_accy 94.83:  30%|███       | 6/20 [00:27<01:00,  4.29s/it]
Task 7, Epoch 7/20 => Loss 0.206, Train_accy 94.83:  35%|███▌      | 7/20 [00:27<00:51,  3.94s/it]
Task 7, Epoch 8/20 => Loss 0.156, Train_accy 95.11:  35%|███▌      | 7/20 [00:30<00:51,  3.94s/it]
Task 7, Epoch 8/20 => Loss 0.156, Train_accy 95.11:  40%|████      | 8/20 [00:30<00:44,  3.71s/it]
Task 7, Epoch 9/20 => Loss 0.143, Train_accy 95.98:  40%|████      | 8/20 [00:33<00:44,  3.71s/it]
Task 7, Epoch 9/20 => Loss 0.143, Train_accy 95.98:  45%|████▌     | 9/20 [00:33<00:38,  3.52s/it]
Task 7, Epoch 10/20 => Loss 0.118, Train_accy 95.69, Test_accy 47.42:  45%|████▌     | 9/20 [00:41<00:38,  3.52s/it]
Task 7, Epoch 10/20 => Loss 0.118, Train_accy 95.69, Test_accy 47.42:  50%|█████     | 10/20 [00:41<00:46,  4.66s/it]
Task 7, Epoch 11/20 => Loss 0.095, Train_accy 97.70:  50%|█████     | 10/20 [00:44<00:46,  4.66s/it]                 
Task 7, Epoch 11/20 => Loss 0.095, Train_accy 97.70:  55%|█████▌    | 11/20 [00:44<00:37,  4.19s/it]
Task 7, Epoch 12/20 => Loss 0.116, Train_accy 96.84:  55%|█████▌    | 11/20 [00:47<00:37,  4.19s/it]
Task 7, Epoch 12/20 => Loss 0.116, Train_accy 96.84:  60%|██████    | 12/20 [00:47<00:31,  3.89s/it]
Task 7, Epoch 13/20 => Loss 0.115, Train_accy 97.70:  60%|██████    | 12/20 [00:50<00:31,  3.89s/it]
Task 7, Epoch 13/20 => Loss 0.115, Train_accy 97.70:  65%|██████▌   | 13/20 [00:50<00:26,  3.73s/it]
Task 7, Epoch 14/20 => Loss 0.098, Train_accy 97.13:  65%|██████▌   | 13/20 [00:54<00:26,  3.73s/it]
Task 7, Epoch 14/20 => Loss 0.098, Train_accy 97.13:  70%|███████   | 14/20 [00:54<00:21,  3.63s/it]
Task 7, Epoch 15/20 => Loss 0.121, Train_accy 96.26, Test_accy 49.00:  70%|███████   | 14/20 [01:02<00:21,  3.63s/it]
Task 7, Epoch 15/20 => Loss 0.121, Train_accy 96.26, Test_accy 49.00:  75%|███████▌  | 15/20 [01:02<00:24,  4.90s/it]
Task 7, Epoch 16/20 => Loss 0.103, Train_accy 96.26:  75%|███████▌  | 15/20 [01:05<00:24,  4.90s/it]                 
Task 7, Epoch 16/20 => Loss 0.103, Train_accy 96.26:  80%|████████  | 16/20 [01:05<00:17,  4.46s/it]
Task 7, Epoch 17/20 => Loss 0.075, Train_accy 97.13:  80%|████████  | 16/20 [01:08<00:17,  4.46s/it]
Task 7, Epoch 17/20 => Loss 0.075, Train_accy 97.13:  85%|████████▌ | 17/20 [01:08<00:12,  4.13s/it]
Task 7, Epoch 18/20 => Loss 0.073, Train_accy 97.41:  85%|████████▌ | 17/20 [01:12<00:12,  4.13s/it]
Task 7, Epoch 18/20 => Loss 0.073, Train_accy 97.41:  90%|█████████ | 18/20 [01:12<00:07,  3.90s/it]
Task 7, Epoch 19/20 => Loss 0.104, Train_accy 96.84:  90%|█████████ | 18/20 [01:15<00:07,  3.90s/it]
Task 7, Epoch 19/20 => Loss 0.104, Train_accy 96.84:  95%|█████████▌| 19/20 [01:15<00:03,  3.73s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.56, Test_accy 48.71:  95%|█████████▌| 19/20 [01:23<00:03,  3.73s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.56, Test_accy 48.71: 100%|██████████| 20/20 [01:23<00:00,  4.95s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.56, Test_accy 48.71: 100%|██████████| 20/20 [01:23<00:00,  4.17s/it]
2024-09-12 09:52:43,411 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.56, Test_accy 48.71
2024-09-12 09:52:47,831 [trainer.py] => No NME accuracy.
2024-09-12 09:52:47,832 [trainer.py] => CNN: {'total': 48.71, '00-09': 42.86, '10-19': 67.35, '20-29': 54.55, '30-39': 47.67, '40-49': 45.31, '50-59': 40.38, '60-69': 43.65, '70-79': 42.71, 'old': 49.67, 'new': 42.71}
2024-09-12 09:52:47,832 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71]
2024-09-12 09:52:47,832 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37]

Average Accuracy (CNN): 61.64
2024-09-12 09:52:47,832 [trainer.py] => Average Accuracy (CNN): 61.64 

2024-09-12 09:52:47,834 [trainer.py] => All params: 172158352
2024-09-12 09:52:47,836 [trainer.py] => Trainable params: 407240
2024-09-12 09:52:47,836 [dualprompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.135, Train_accy 29.76:   0%|          | 0/20 [00:02<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.135, Train_accy 29.76:   5%|▌         | 1/20 [00:02<00:55,  2.92s/it]
Task 8, Epoch 2/20 => Loss 1.074, Train_accy 67.13:   5%|▌         | 1/20 [00:05<00:55,  2.92s/it]
Task 8, Epoch 2/20 => Loss 1.074, Train_accy 67.13:  10%|█         | 2/20 [00:05<00:52,  2.92s/it]
Task 8, Epoch 3/20 => Loss 0.507, Train_accy 79.58:  10%|█         | 2/20 [00:08<00:52,  2.92s/it]
Task 8, Epoch 3/20 => Loss 0.507, Train_accy 79.58:  15%|█▌        | 3/20 [00:08<00:49,  2.94s/it]
Task 8, Epoch 4/20 => Loss 0.337, Train_accy 87.89:  15%|█▌        | 3/20 [00:11<00:49,  2.94s/it]
Task 8, Epoch 4/20 => Loss 0.337, Train_accy 87.89:  20%|██        | 4/20 [00:11<00:46,  2.91s/it]
Task 8, Epoch 5/20 => Loss 0.226, Train_accy 92.04, Test_accy 45.31:  20%|██        | 4/20 [00:19<00:46,  2.91s/it]
Task 8, Epoch 5/20 => Loss 0.226, Train_accy 92.04, Test_accy 45.31:  25%|██▌       | 5/20 [00:19<01:10,  4.70s/it]
Task 8, Epoch 6/20 => Loss 0.242, Train_accy 93.77:  25%|██▌       | 5/20 [00:22<01:10,  4.70s/it]                 
Task 8, Epoch 6/20 => Loss 0.242, Train_accy 93.77:  30%|███       | 6/20 [00:22<00:57,  4.09s/it]
Task 8, Epoch 7/20 => Loss 0.184, Train_accy 93.77:  30%|███       | 6/20 [00:25<00:57,  4.09s/it]
Task 8, Epoch 7/20 => Loss 0.184, Train_accy 93.77:  35%|███▌      | 7/20 [00:25<00:48,  3.71s/it]
Task 8, Epoch 8/20 => Loss 0.126, Train_accy 96.19:  35%|███▌      | 7/20 [00:28<00:48,  3.71s/it]
Task 8, Epoch 8/20 => Loss 0.126, Train_accy 96.19:  40%|████      | 8/20 [00:28<00:41,  3.46s/it]
Task 8, Epoch 9/20 => Loss 0.090, Train_accy 96.89:  40%|████      | 8/20 [00:31<00:41,  3.46s/it]
Task 8, Epoch 9/20 => Loss 0.090, Train_accy 96.89:  45%|████▌     | 9/20 [00:31<00:36,  3.28s/it]
Task 8, Epoch 10/20 => Loss 0.077, Train_accy 97.23, Test_accy 46.47:  45%|████▌     | 9/20 [00:38<00:36,  3.28s/it]
Task 8, Epoch 10/20 => Loss 0.077, Train_accy 97.23, Test_accy 46.47:  50%|█████     | 10/20 [00:38<00:46,  4.65s/it]
Task 8, Epoch 11/20 => Loss 0.140, Train_accy 95.85:  50%|█████     | 10/20 [00:41<00:46,  4.65s/it]                 
Task 8, Epoch 11/20 => Loss 0.140, Train_accy 95.85:  55%|█████▌    | 11/20 [00:41<00:37,  4.11s/it]
Task 8, Epoch 12/20 => Loss 0.078, Train_accy 98.27:  55%|█████▌    | 11/20 [00:44<00:37,  4.11s/it]
Task 8, Epoch 12/20 => Loss 0.078, Train_accy 98.27:  60%|██████    | 12/20 [00:44<00:29,  3.75s/it]
Task 8, Epoch 13/20 => Loss 0.088, Train_accy 98.27:  60%|██████    | 12/20 [00:47<00:29,  3.75s/it]
Task 8, Epoch 13/20 => Loss 0.088, Train_accy 98.27:  65%|██████▌   | 13/20 [00:47<00:24,  3.47s/it]
Task 8, Epoch 14/20 => Loss 0.073, Train_accy 98.27:  65%|██████▌   | 13/20 [00:50<00:24,  3.47s/it]
Task 8, Epoch 14/20 => Loss 0.073, Train_accy 98.27:  70%|███████   | 14/20 [00:50<00:19,  3.28s/it]
Task 8, Epoch 15/20 => Loss 0.136, Train_accy 97.23, Test_accy 45.83:  70%|███████   | 14/20 [00:58<00:19,  3.28s/it]
Task 8, Epoch 15/20 => Loss 0.136, Train_accy 97.23, Test_accy 45.83:  75%|███████▌  | 15/20 [00:58<00:23,  4.63s/it]
Task 8, Epoch 16/20 => Loss 0.103, Train_accy 96.54:  75%|███████▌  | 15/20 [01:01<00:23,  4.63s/it]                 
Task 8, Epoch 16/20 => Loss 0.103, Train_accy 96.54:  80%|████████  | 16/20 [01:01<00:16,  4.10s/it]
Task 8, Epoch 17/20 => Loss 0.067, Train_accy 97.23:  80%|████████  | 16/20 [01:03<00:16,  4.10s/it]
Task 8, Epoch 17/20 => Loss 0.067, Train_accy 97.23:  85%|████████▌ | 17/20 [01:03<00:11,  3.74s/it]
Task 8, Epoch 18/20 => Loss 0.085, Train_accy 96.89:  85%|████████▌ | 17/20 [01:06<00:11,  3.74s/it]
Task 8, Epoch 18/20 => Loss 0.085, Train_accy 96.89:  90%|█████████ | 18/20 [01:06<00:06,  3.48s/it]
Task 8, Epoch 19/20 => Loss 0.063, Train_accy 97.92:  90%|█████████ | 18/20 [01:09<00:06,  3.48s/it]
Task 8, Epoch 19/20 => Loss 0.063, Train_accy 97.92:  95%|█████████▌| 19/20 [01:09<00:03,  3.31s/it]
Task 8, Epoch 20/20 => Loss 0.076, Train_accy 97.23, Test_accy 46.08:  95%|█████████▌| 19/20 [01:17<00:03,  3.31s/it]
Task 8, Epoch 20/20 => Loss 0.076, Train_accy 97.23, Test_accy 46.08: 100%|██████████| 20/20 [01:17<00:00,  4.67s/it]
Task 8, Epoch 20/20 => Loss 0.076, Train_accy 97.23, Test_accy 46.08: 100%|██████████| 20/20 [01:17<00:00,  3.88s/it]
2024-09-12 09:54:05,403 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.076, Train_accy 97.23, Test_accy 46.08
2024-09-12 09:54:10,268 [trainer.py] => No NME accuracy.
2024-09-12 09:54:10,269 [trainer.py] => CNN: {'total': 46.08, '00-09': 42.86, '10-19': 67.35, '20-29': 52.53, '30-39': 47.67, '40-49': 42.19, '50-59': 40.38, '60-69': 41.27, '70-79': 40.62, '80-89': 34.57, 'old': 47.42, 'new': 34.57}
2024-09-12 09:54:10,269 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08]
2024-09-12 09:54:10,269 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95]

Average Accuracy (CNN): 59.91
2024-09-12 09:54:10,269 [trainer.py] => Average Accuracy (CNN): 59.91 

2024-09-12 09:54:10,272 [trainer.py] => All params: 172158352
2024-09-12 09:54:10,275 [trainer.py] => Trainable params: 407240
2024-09-12 09:54:10,275 [dualprompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.588, Train_accy 18.30:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.588, Train_accy 18.30:   5%|▌         | 1/20 [00:02<00:45,  2.40s/it]
Task 9, Epoch 2/20 => Loss 1.308, Train_accy 54.89:   5%|▌         | 1/20 [00:04<00:45,  2.40s/it]
Task 9, Epoch 2/20 => Loss 1.308, Train_accy 54.89:  10%|█         | 2/20 [00:04<00:42,  2.39s/it]
Task 9, Epoch 3/20 => Loss 0.864, Train_accy 67.23:  10%|█         | 2/20 [00:07<00:42,  2.39s/it]
Task 9, Epoch 3/20 => Loss 0.864, Train_accy 67.23:  15%|█▌        | 3/20 [00:07<00:40,  2.40s/it]
Task 9, Epoch 4/20 => Loss 0.448, Train_accy 85.11:  15%|█▌        | 3/20 [00:09<00:40,  2.40s/it]
Task 9, Epoch 4/20 => Loss 0.448, Train_accy 85.11:  20%|██        | 4/20 [00:09<00:38,  2.39s/it]
Task 9, Epoch 5/20 => Loss 0.396, Train_accy 88.94, Test_accy 44.00:  20%|██        | 4/20 [00:17<00:38,  2.39s/it]
Task 9, Epoch 5/20 => Loss 0.396, Train_accy 88.94, Test_accy 44.00:  25%|██▌       | 5/20 [00:17<01:04,  4.28s/it]
Task 9, Epoch 6/20 => Loss 0.200, Train_accy 95.74:  25%|██▌       | 5/20 [00:19<01:04,  4.28s/it]                 
Task 9, Epoch 6/20 => Loss 0.200, Train_accy 95.74:  30%|███       | 6/20 [00:19<00:51,  3.65s/it]
Task 9, Epoch 7/20 => Loss 0.136, Train_accy 98.30:  30%|███       | 6/20 [00:22<00:51,  3.65s/it]
Task 9, Epoch 7/20 => Loss 0.136, Train_accy 98.30:  35%|███▌      | 7/20 [00:22<00:42,  3.27s/it]
Task 9, Epoch 8/20 => Loss 0.193, Train_accy 94.89:  35%|███▌      | 7/20 [00:24<00:42,  3.27s/it]
Task 9, Epoch 8/20 => Loss 0.193, Train_accy 94.89:  40%|████      | 8/20 [00:24<00:36,  3.02s/it]
Task 9, Epoch 9/20 => Loss 0.168, Train_accy 96.17:  40%|████      | 8/20 [00:26<00:36,  3.02s/it]
Task 9, Epoch 9/20 => Loss 0.168, Train_accy 96.17:  45%|████▌     | 9/20 [00:26<00:30,  2.76s/it]
Task 9, Epoch 10/20 => Loss 0.148, Train_accy 97.02, Test_accy 43.88:  45%|████▌     | 9/20 [00:33<00:30,  2.76s/it]
Task 9, Epoch 10/20 => Loss 0.148, Train_accy 97.02, Test_accy 43.88:  50%|█████     | 10/20 [00:33<00:40,  4.06s/it]
Task 9, Epoch 11/20 => Loss 0.110, Train_accy 97.02:  50%|█████     | 10/20 [00:36<00:40,  4.06s/it]                 
Task 9, Epoch 11/20 => Loss 0.110, Train_accy 97.02:  55%|█████▌    | 11/20 [00:36<00:31,  3.51s/it]
Task 9, Epoch 12/20 => Loss 0.109, Train_accy 97.87:  55%|█████▌    | 11/20 [00:38<00:31,  3.51s/it]
Task 9, Epoch 12/20 => Loss 0.109, Train_accy 97.87:  60%|██████    | 12/20 [00:38<00:24,  3.10s/it]
Task 9, Epoch 13/20 => Loss 0.113, Train_accy 96.17:  60%|██████    | 12/20 [00:40<00:24,  3.10s/it]
Task 9, Epoch 13/20 => Loss 0.113, Train_accy 96.17:  65%|██████▌   | 13/20 [00:40<00:20,  2.87s/it]
Task 9, Epoch 14/20 => Loss 0.103, Train_accy 97.45:  65%|██████▌   | 13/20 [00:42<00:20,  2.87s/it]
Task 9, Epoch 14/20 => Loss 0.103, Train_accy 97.45:  70%|███████   | 14/20 [00:42<00:16,  2.68s/it]
Task 9, Epoch 15/20 => Loss 0.104, Train_accy 97.87, Test_accy 43.88:  70%|███████   | 14/20 [00:49<00:16,  2.68s/it]
Task 9, Epoch 15/20 => Loss 0.104, Train_accy 97.87, Test_accy 43.88:  75%|███████▌  | 15/20 [00:49<00:19,  3.98s/it]
Task 9, Epoch 16/20 => Loss 0.073, Train_accy 97.45:  75%|███████▌  | 15/20 [00:51<00:19,  3.98s/it]                 
Task 9, Epoch 16/20 => Loss 0.073, Train_accy 97.45:  80%|████████  | 16/20 [00:51<00:13,  3.46s/it]
Task 9, Epoch 17/20 => Loss 0.090, Train_accy 96.60:  80%|████████  | 16/20 [00:54<00:13,  3.46s/it]
Task 9, Epoch 17/20 => Loss 0.090, Train_accy 96.60:  85%|████████▌ | 17/20 [00:54<00:09,  3.09s/it]
Task 9, Epoch 18/20 => Loss 0.053, Train_accy 99.15:  85%|████████▌ | 17/20 [00:56<00:09,  3.09s/it]
Task 9, Epoch 18/20 => Loss 0.053, Train_accy 99.15:  90%|█████████ | 18/20 [00:56<00:05,  2.84s/it]
Task 9, Epoch 19/20 => Loss 0.056, Train_accy 99.15:  90%|█████████ | 18/20 [00:58<00:05,  2.84s/it]
Task 9, Epoch 19/20 => Loss 0.056, Train_accy 99.15:  95%|█████████▌| 19/20 [00:58<00:02,  2.69s/it]
Task 9, Epoch 20/20 => Loss 0.094, Train_accy 97.02, Test_accy 43.88:  95%|█████████▌| 19/20 [01:06<00:02,  2.69s/it]
Task 9, Epoch 20/20 => Loss 0.094, Train_accy 97.02, Test_accy 43.88: 100%|██████████| 20/20 [01:06<00:00,  4.19s/it]
Task 9, Epoch 20/20 => Loss 0.094, Train_accy 97.02, Test_accy 43.88: 100%|██████████| 20/20 [01:06<00:00,  3.33s/it]
2024-09-12 09:55:16,804 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.094, Train_accy 97.02, Test_accy 43.88
2024-09-12 09:55:22,130 [trainer.py] => No NME accuracy.
2024-09-12 09:55:22,130 [trainer.py] => CNN: {'total': 43.88, '00-09': 40.26, '10-19': 65.31, '20-29': 52.53, '30-39': 44.19, '40-49': 42.19, '50-59': 42.31, '60-69': 42.06, '70-79': 38.54, '80-89': 32.1, '90-99': 30.65, 'old': 44.93, 'new': 30.65}
2024-09-12 09:55:22,131 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88]
2024-09-12 09:55:22,131 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46]

Average Accuracy (CNN): 58.31
2024-09-12 09:55:22,131 [trainer.py] => Average Accuracy (CNN): 58.31 

2024-09-12 09:55:22,134 [trainer.py] => All params: 172158352
2024-09-12 09:55:22,136 [trainer.py] => Trainable params: 407240
2024-09-12 09:55:22,136 [dualprompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.322, Train_accy 26.12:   0%|          | 0/20 [00:02<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.322, Train_accy 26.12:   5%|▌         | 1/20 [00:02<00:46,  2.45s/it]
Task 10, Epoch 2/20 => Loss 1.213, Train_accy 62.04:   5%|▌         | 1/20 [00:04<00:46,  2.45s/it]
Task 10, Epoch 2/20 => Loss 1.213, Train_accy 62.04:  10%|█         | 2/20 [00:04<00:43,  2.43s/it]
Task 10, Epoch 3/20 => Loss 0.587, Train_accy 77.96:  10%|█         | 2/20 [00:07<00:43,  2.43s/it]
Task 10, Epoch 3/20 => Loss 0.587, Train_accy 77.96:  15%|█▌        | 3/20 [00:07<00:41,  2.45s/it]
Task 10, Epoch 4/20 => Loss 0.362, Train_accy 89.80:  15%|█▌        | 3/20 [00:09<00:41,  2.45s/it]
Task 10, Epoch 4/20 => Loss 0.362, Train_accy 89.80:  20%|██        | 4/20 [00:09<00:39,  2.46s/it]
Task 10, Epoch 5/20 => Loss 0.262, Train_accy 91.43, Test_accy 41.84:  20%|██        | 4/20 [00:17<00:39,  2.46s/it]
Task 10, Epoch 5/20 => Loss 0.262, Train_accy 91.43, Test_accy 41.84:  25%|██▌       | 5/20 [00:18<01:07,  4.53s/it]
Task 10, Epoch 6/20 => Loss 0.184, Train_accy 95.10:  25%|██▌       | 5/20 [00:20<01:07,  4.53s/it]                 
Task 10, Epoch 6/20 => Loss 0.184, Train_accy 95.10:  30%|███       | 6/20 [00:20<00:53,  3.82s/it]
Task 10, Epoch 7/20 => Loss 0.245, Train_accy 95.10:  30%|███       | 6/20 [00:22<00:53,  3.82s/it]
Task 10, Epoch 7/20 => Loss 0.245, Train_accy 95.10:  35%|███▌      | 7/20 [00:22<00:43,  3.37s/it]
Task 10, Epoch 8/20 => Loss 0.157, Train_accy 95.92:  35%|███▌      | 7/20 [00:25<00:43,  3.37s/it]
Task 10, Epoch 8/20 => Loss 0.157, Train_accy 95.92:  40%|████      | 8/20 [00:25<00:37,  3.10s/it]
Task 10, Epoch 9/20 => Loss 0.100, Train_accy 97.55:  40%|████      | 8/20 [00:27<00:37,  3.10s/it]
Task 10, Epoch 9/20 => Loss 0.100, Train_accy 97.55:  45%|████▌     | 9/20 [00:27<00:32,  2.91s/it]
Task 10, Epoch 10/20 => Loss 0.091, Train_accy 96.73, Test_accy 42.18:  45%|████▌     | 9/20 [00:35<00:32,  2.91s/it]
Task 10, Epoch 10/20 => Loss 0.091, Train_accy 96.73, Test_accy 42.18:  50%|█████     | 10/20 [00:35<00:44,  4.48s/it]
Task 10, Epoch 11/20 => Loss 0.088, Train_accy 97.55:  50%|█████     | 10/20 [00:38<00:44,  4.48s/it]                 
Task 10, Epoch 11/20 => Loss 0.088, Train_accy 97.55:  55%|█████▌    | 11/20 [00:38<00:34,  3.86s/it]
Task 10, Epoch 12/20 => Loss 0.211, Train_accy 96.33:  55%|█████▌    | 11/20 [00:40<00:34,  3.86s/it]
Task 10, Epoch 12/20 => Loss 0.211, Train_accy 96.33:  60%|██████    | 12/20 [00:40<00:27,  3.44s/it]
Task 10, Epoch 13/20 => Loss 0.088, Train_accy 95.51:  60%|██████    | 12/20 [00:43<00:27,  3.44s/it]
Task 10, Epoch 13/20 => Loss 0.088, Train_accy 95.51:  65%|██████▌   | 13/20 [00:43<00:21,  3.13s/it]
Task 10, Epoch 14/20 => Loss 0.098, Train_accy 98.37:  65%|██████▌   | 13/20 [00:45<00:21,  3.13s/it]
Task 10, Epoch 14/20 => Loss 0.098, Train_accy 98.37:  70%|███████   | 14/20 [00:45<00:17,  2.95s/it]
Task 10, Epoch 15/20 => Loss 0.085, Train_accy 97.55, Test_accy 42.84:  70%|███████   | 14/20 [00:53<00:17,  2.95s/it]
Task 10, Epoch 15/20 => Loss 0.085, Train_accy 97.55, Test_accy 42.84:  75%|███████▌  | 15/20 [00:53<00:22,  4.50s/it]
Task 10, Epoch 16/20 => Loss 0.077, Train_accy 97.14:  75%|███████▌  | 15/20 [00:56<00:22,  4.50s/it]                 
Task 10, Epoch 16/20 => Loss 0.077, Train_accy 97.14:  80%|████████  | 16/20 [00:56<00:15,  3.88s/it]
Task 10, Epoch 17/20 => Loss 0.043, Train_accy 98.37:  80%|████████  | 16/20 [00:58<00:15,  3.88s/it]
Task 10, Epoch 17/20 => Loss 0.043, Train_accy 98.37:  85%|████████▌ | 17/20 [00:58<00:10,  3.45s/it]
Task 10, Epoch 18/20 => Loss 0.055, Train_accy 97.96:  85%|████████▌ | 17/20 [01:01<00:10,  3.45s/it]
Task 10, Epoch 18/20 => Loss 0.055, Train_accy 97.96:  90%|█████████ | 18/20 [01:01<00:06,  3.14s/it]
Task 10, Epoch 19/20 => Loss 0.043, Train_accy 97.96:  90%|█████████ | 18/20 [01:03<00:06,  3.14s/it]
Task 10, Epoch 19/20 => Loss 0.043, Train_accy 97.96:  95%|█████████▌| 19/20 [01:03<00:02,  2.94s/it]
Task 10, Epoch 20/20 => Loss 0.041, Train_accy 98.78, Test_accy 43.29:  95%|█████████▌| 19/20 [01:11<00:02,  2.94s/it]
Task 10, Epoch 20/20 => Loss 0.041, Train_accy 98.78, Test_accy 43.29: 100%|██████████| 20/20 [01:11<00:00,  4.50s/it]
Task 10, Epoch 20/20 => Loss 0.041, Train_accy 98.78, Test_accy 43.29: 100%|██████████| 20/20 [01:11<00:00,  3.59s/it]
2024-09-12 09:56:33,948 [dualprompt.py] => Task 10, Epoch 20/20 => Loss 0.041, Train_accy 98.78, Test_accy 43.29
2024-09-12 09:56:39,454 [trainer.py] => No NME accuracy.
2024-09-12 09:56:39,455 [trainer.py] => CNN: {'total': 43.29, '00-09': 40.26, '10-19': 67.35, '20-29': 54.55, '30-39': 43.02, '40-49': 42.19, '50-59': 40.38, '60-69': 41.27, '70-79': 38.54, '80-89': 33.33, '90-99': 30.65, '100-109': 31.67, 'old': 44.11, 'new': 31.67}
2024-09-12 09:56:39,455 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29]
2024-09-12 09:56:39,455 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14]

Average Accuracy (CNN): 56.95
2024-09-12 09:56:39,455 [trainer.py] => Average Accuracy (CNN): 56.95 

2024-09-12 09:56:39,458 [trainer.py] => All params: 172158352
2024-09-12 09:56:39,460 [trainer.py] => Trainable params: 407240
2024-09-12 09:56:39,460 [dualprompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.054, Train_accy 31.65:   0%|          | 0/20 [00:02<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.054, Train_accy 31.65:   5%|▌         | 1/20 [00:02<00:52,  2.74s/it]
Task 11, Epoch 2/20 => Loss 0.958, Train_accy 68.35:   5%|▌         | 1/20 [00:05<00:52,  2.74s/it]
Task 11, Epoch 2/20 => Loss 0.958, Train_accy 68.35:  10%|█         | 2/20 [00:05<00:49,  2.73s/it]
Task 11, Epoch 3/20 => Loss 0.610, Train_accy 79.86:  10%|█         | 2/20 [00:08<00:49,  2.73s/it]
Task 11, Epoch 3/20 => Loss 0.610, Train_accy 79.86:  15%|█▌        | 3/20 [00:08<00:46,  2.74s/it]
Task 11, Epoch 4/20 => Loss 0.345, Train_accy 88.49:  15%|█▌        | 3/20 [00:10<00:46,  2.74s/it]
Task 11, Epoch 4/20 => Loss 0.345, Train_accy 88.49:  20%|██        | 4/20 [00:10<00:43,  2.72s/it]
Task 11, Epoch 5/20 => Loss 0.256, Train_accy 92.09, Test_accy 41.95:  20%|██        | 4/20 [00:19<00:43,  2.72s/it]
Task 11, Epoch 5/20 => Loss 0.256, Train_accy 92.09, Test_accy 41.95:  25%|██▌       | 5/20 [00:19<01:12,  4.87s/it]
Task 11, Epoch 6/20 => Loss 0.172, Train_accy 95.68:  25%|██▌       | 5/20 [00:22<01:12,  4.87s/it]                 
Task 11, Epoch 6/20 => Loss 0.172, Train_accy 95.68:  30%|███       | 6/20 [00:22<00:58,  4.15s/it]
Task 11, Epoch 7/20 => Loss 0.190, Train_accy 94.24:  30%|███       | 6/20 [00:25<00:58,  4.15s/it]
Task 11, Epoch 7/20 => Loss 0.190, Train_accy 94.24:  35%|███▌      | 7/20 [00:25<00:47,  3.69s/it]
Task 11, Epoch 8/20 => Loss 0.134, Train_accy 96.76:  35%|███▌      | 7/20 [00:27<00:47,  3.69s/it]
Task 11, Epoch 8/20 => Loss 0.134, Train_accy 96.76:  40%|████      | 8/20 [00:27<00:41,  3.42s/it]
Task 11, Epoch 9/20 => Loss 0.117, Train_accy 96.40:  40%|████      | 8/20 [00:30<00:41,  3.42s/it]
Task 11, Epoch 9/20 => Loss 0.117, Train_accy 96.40:  45%|████▌     | 9/20 [00:30<00:35,  3.22s/it]
Task 11, Epoch 10/20 => Loss 0.123, Train_accy 95.32, Test_accy 42.15:  45%|████▌     | 9/20 [00:39<00:35,  3.22s/it]
Task 11, Epoch 10/20 => Loss 0.123, Train_accy 95.32, Test_accy 42.15:  50%|█████     | 10/20 [00:39<00:49,  4.91s/it]
Task 11, Epoch 11/20 => Loss 0.074, Train_accy 98.20:  50%|█████     | 10/20 [00:42<00:49,  4.91s/it]                 
Task 11, Epoch 11/20 => Loss 0.074, Train_accy 98.20:  55%|█████▌    | 11/20 [00:42<00:38,  4.25s/it]
Task 11, Epoch 12/20 => Loss 0.100, Train_accy 95.68:  55%|█████▌    | 11/20 [00:44<00:38,  4.25s/it]
Task 11, Epoch 12/20 => Loss 0.100, Train_accy 95.68:  60%|██████    | 12/20 [00:44<00:30,  3.80s/it]
Task 11, Epoch 13/20 => Loss 0.084, Train_accy 97.48:  60%|██████    | 12/20 [00:47<00:30,  3.80s/it]
Task 11, Epoch 13/20 => Loss 0.084, Train_accy 97.48:  65%|██████▌   | 13/20 [00:47<00:24,  3.48s/it]
Task 11, Epoch 14/20 => Loss 0.126, Train_accy 96.76:  65%|██████▌   | 13/20 [00:50<00:24,  3.48s/it]
Task 11, Epoch 14/20 => Loss 0.126, Train_accy 96.76:  70%|███████   | 14/20 [00:50<00:19,  3.26s/it]
Task 11, Epoch 15/20 => Loss 0.052, Train_accy 98.20, Test_accy 42.26:  70%|███████   | 14/20 [00:58<00:19,  3.26s/it]
Task 11, Epoch 15/20 => Loss 0.052, Train_accy 98.20, Test_accy 42.26:  75%|███████▌  | 15/20 [00:58<00:24,  4.84s/it]
Task 11, Epoch 16/20 => Loss 0.079, Train_accy 97.48:  75%|███████▌  | 15/20 [01:01<00:24,  4.84s/it]                 
Task 11, Epoch 16/20 => Loss 0.079, Train_accy 97.48:  80%|████████  | 16/20 [01:01<00:16,  4.15s/it]
Task 11, Epoch 17/20 => Loss 0.079, Train_accy 96.76:  80%|████████  | 16/20 [01:04<00:16,  4.15s/it]
Task 11, Epoch 17/20 => Loss 0.079, Train_accy 96.76:  85%|████████▌ | 17/20 [01:04<00:11,  3.67s/it]
Task 11, Epoch 18/20 => Loss 0.080, Train_accy 97.12:  85%|████████▌ | 17/20 [01:06<00:11,  3.67s/it]
Task 11, Epoch 18/20 => Loss 0.080, Train_accy 97.12:  90%|█████████ | 18/20 [01:06<00:06,  3.34s/it]
Task 11, Epoch 19/20 => Loss 0.030, Train_accy 99.64:  90%|█████████ | 18/20 [01:09<00:06,  3.34s/it]
Task 11, Epoch 19/20 => Loss 0.030, Train_accy 99.64:  95%|█████████▌| 19/20 [01:09<00:03,  3.11s/it]
Task 11, Epoch 20/20 => Loss 0.055, Train_accy 97.84, Test_accy 42.46:  95%|█████████▌| 19/20 [01:17<00:03,  3.11s/it]
Task 11, Epoch 20/20 => Loss 0.055, Train_accy 97.84, Test_accy 42.46: 100%|██████████| 20/20 [01:17<00:00,  4.64s/it]
Task 11, Epoch 20/20 => Loss 0.055, Train_accy 97.84, Test_accy 42.46: 100%|██████████| 20/20 [01:17<00:00,  3.87s/it]
2024-09-12 09:57:56,838 [dualprompt.py] => Task 11, Epoch 20/20 => Loss 0.055, Train_accy 97.84, Test_accy 42.46
2024-09-12 09:58:02,273 [trainer.py] => No NME accuracy.
2024-09-12 09:58:02,273 [trainer.py] => CNN: {'total': 42.46, '00-09': 40.26, '10-19': 67.35, '20-29': 51.52, '30-39': 45.35, '40-49': 40.62, '50-59': 36.54, '60-69': 40.48, '70-79': 39.58, '80-89': 34.57, '90-99': 30.65, '100-109': 30.0, '110-119': 37.84, 'old': 42.84, 'new': 37.84}
2024-09-12 09:58:02,273 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46]
2024-09-12 09:58:02,274 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97]

Average Accuracy (CNN): 55.74
2024-09-12 09:58:02,274 [trainer.py] => Average Accuracy (CNN): 55.74 

2024-09-12 09:58:02,276 [trainer.py] => All params: 172158352
2024-09-12 09:58:02,278 [trainer.py] => Trainable params: 407240
2024-09-12 09:58:02,279 [dualprompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.767, Train_accy 20.43:   0%|          | 0/20 [00:02<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.767, Train_accy 20.43:   5%|▌         | 1/20 [00:02<00:40,  2.14s/it]
Task 12, Epoch 2/20 => Loss 1.552, Train_accy 48.70:   5%|▌         | 1/20 [00:04<00:40,  2.14s/it]
Task 12, Epoch 2/20 => Loss 1.552, Train_accy 48.70:  10%|█         | 2/20 [00:04<00:38,  2.14s/it]
Task 12, Epoch 3/20 => Loss 1.061, Train_accy 64.35:  10%|█         | 2/20 [00:06<00:38,  2.14s/it]
Task 12, Epoch 3/20 => Loss 1.061, Train_accy 64.35:  15%|█▌        | 3/20 [00:06<00:38,  2.24s/it]
Task 12, Epoch 4/20 => Loss 0.624, Train_accy 79.57:  15%|█▌        | 3/20 [00:08<00:38,  2.24s/it]
Task 12, Epoch 4/20 => Loss 0.624, Train_accy 79.57:  20%|██        | 4/20 [00:08<00:36,  2.27s/it]
Task 12, Epoch 5/20 => Loss 0.490, Train_accy 86.09, Test_accy 40.29:  20%|██        | 4/20 [00:17<00:36,  2.27s/it]
Task 12, Epoch 5/20 => Loss 0.490, Train_accy 86.09, Test_accy 40.29:  25%|██▌       | 5/20 [00:17<01:08,  4.56s/it]
Task 12, Epoch 6/20 => Loss 0.322, Train_accy 90.43:  25%|██▌       | 5/20 [00:19<01:08,  4.56s/it]                 
Task 12, Epoch 6/20 => Loss 0.322, Train_accy 90.43:  30%|███       | 6/20 [00:19<00:53,  3.81s/it]
Task 12, Epoch 7/20 => Loss 0.274, Train_accy 92.61:  30%|███       | 6/20 [00:22<00:53,  3.81s/it]
Task 12, Epoch 7/20 => Loss 0.274, Train_accy 92.61:  35%|███▌      | 7/20 [00:22<00:43,  3.33s/it]
Task 12, Epoch 8/20 => Loss 0.185, Train_accy 94.35:  35%|███▌      | 7/20 [00:24<00:43,  3.33s/it]
Task 12, Epoch 8/20 => Loss 0.185, Train_accy 94.35:  40%|████      | 8/20 [00:24<00:36,  3.04s/it]
Task 12, Epoch 9/20 => Loss 0.140, Train_accy 96.09:  40%|████      | 8/20 [00:27<00:36,  3.04s/it]
Task 12, Epoch 9/20 => Loss 0.140, Train_accy 96.09:  45%|████▌     | 9/20 [00:27<00:30,  2.81s/it]
Task 12, Epoch 10/20 => Loss 0.187, Train_accy 95.65, Test_accy 40.58:  45%|████▌     | 9/20 [00:35<00:30,  2.81s/it]
Task 12, Epoch 10/20 => Loss 0.187, Train_accy 95.65, Test_accy 40.58:  50%|█████     | 10/20 [00:35<00:46,  4.65s/it]
Task 12, Epoch 11/20 => Loss 0.154, Train_accy 95.22:  50%|█████     | 10/20 [00:38<00:46,  4.65s/it]                 
Task 12, Epoch 11/20 => Loss 0.154, Train_accy 95.22:  55%|█████▌    | 11/20 [00:38<00:35,  3.96s/it]
Task 12, Epoch 12/20 => Loss 0.164, Train_accy 93.91:  55%|█████▌    | 11/20 [00:40<00:35,  3.96s/it]
Task 12, Epoch 12/20 => Loss 0.164, Train_accy 93.91:  60%|██████    | 12/20 [00:40<00:27,  3.46s/it]
Task 12, Epoch 13/20 => Loss 0.134, Train_accy 95.65:  60%|██████    | 12/20 [00:42<00:27,  3.46s/it]
Task 12, Epoch 13/20 => Loss 0.134, Train_accy 95.65:  65%|██████▌   | 13/20 [00:42<00:21,  3.12s/it]
Task 12, Epoch 14/20 => Loss 0.106, Train_accy 97.83:  65%|██████▌   | 13/20 [00:45<00:21,  3.12s/it]
Task 12, Epoch 14/20 => Loss 0.106, Train_accy 97.83:  70%|███████   | 14/20 [00:45<00:17,  2.90s/it]
Task 12, Epoch 15/20 => Loss 0.073, Train_accy 98.26, Test_accy 40.29:  70%|███████   | 14/20 [00:53<00:17,  2.90s/it]
Task 12, Epoch 15/20 => Loss 0.073, Train_accy 98.26, Test_accy 40.29:  75%|███████▌  | 15/20 [00:53<00:23,  4.63s/it]
Task 12, Epoch 16/20 => Loss 0.083, Train_accy 98.26:  75%|███████▌  | 15/20 [00:56<00:23,  4.63s/it]                 
Task 12, Epoch 16/20 => Loss 0.083, Train_accy 98.26:  80%|████████  | 16/20 [00:56<00:15,  3.94s/it]
Task 12, Epoch 17/20 => Loss 0.074, Train_accy 98.70:  80%|████████  | 16/20 [00:58<00:15,  3.94s/it]
Task 12, Epoch 17/20 => Loss 0.074, Train_accy 98.70:  85%|████████▌ | 17/20 [00:58<00:10,  3.46s/it]
Task 12, Epoch 18/20 => Loss 0.072, Train_accy 97.39:  85%|████████▌ | 17/20 [01:00<00:10,  3.46s/it]
Task 12, Epoch 18/20 => Loss 0.072, Train_accy 97.39:  90%|█████████ | 18/20 [01:00<00:06,  3.13s/it]
Task 12, Epoch 19/20 => Loss 0.069, Train_accy 97.39:  90%|█████████ | 18/20 [01:03<00:06,  3.13s/it]
Task 12, Epoch 19/20 => Loss 0.069, Train_accy 97.39:  95%|█████████▌| 19/20 [01:03<00:02,  2.89s/it]
Task 12, Epoch 20/20 => Loss 0.080, Train_accy 96.96, Test_accy 40.19:  95%|█████████▌| 19/20 [01:11<00:02,  2.89s/it]
Task 12, Epoch 20/20 => Loss 0.080, Train_accy 96.96, Test_accy 40.19: 100%|██████████| 20/20 [01:11<00:00,  4.60s/it]
Task 12, Epoch 20/20 => Loss 0.080, Train_accy 96.96, Test_accy 40.19: 100%|██████████| 20/20 [01:11<00:00,  3.59s/it]
2024-09-12 09:59:14,092 [dualprompt.py] => Task 12, Epoch 20/20 => Loss 0.080, Train_accy 96.96, Test_accy 40.19
2024-09-12 09:59:20,426 [trainer.py] => No NME accuracy.
2024-09-12 09:59:20,427 [trainer.py] => CNN: {'total': 40.19, '00-09': 38.96, '10-19': 65.31, '20-29': 51.52, '30-39': 44.19, '40-49': 40.62, '50-59': 36.54, '60-69': 39.68, '70-79': 37.5, '80-89': 34.57, '90-99': 29.03, '100-109': 31.67, '110-119': 37.84, '120-129': 15.0, 'old': 41.74, 'new': 15.0}
2024-09-12 09:59:20,427 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19]
2024-09-12 09:59:20,427 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17]

Average Accuracy (CNN): 54.54
2024-09-12 09:59:20,427 [trainer.py] => Average Accuracy (CNN): 54.54 

2024-09-12 09:59:20,430 [trainer.py] => All params: 172158352
2024-09-12 09:59:20,432 [trainer.py] => Trainable params: 407240
2024-09-12 09:59:20,432 [dualprompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.891, Train_accy 19.09:   0%|          | 0/20 [00:03<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.891, Train_accy 19.09:   5%|▌         | 1/20 [00:03<00:57,  3.01s/it]
Task 13, Epoch 2/20 => Loss 1.294, Train_accy 54.69:   5%|▌         | 1/20 [00:06<00:57,  3.01s/it]
Task 13, Epoch 2/20 => Loss 1.294, Train_accy 54.69:  10%|█         | 2/20 [00:06<00:54,  3.02s/it]
Task 13, Epoch 3/20 => Loss 0.748, Train_accy 75.40:  10%|█         | 2/20 [00:09<00:54,  3.02s/it]
Task 13, Epoch 3/20 => Loss 0.748, Train_accy 75.40:  15%|█▌        | 3/20 [00:09<00:51,  3.03s/it]
Task 13, Epoch 4/20 => Loss 0.483, Train_accy 84.14:  15%|█▌        | 3/20 [00:12<00:51,  3.03s/it]
Task 13, Epoch 4/20 => Loss 0.483, Train_accy 84.14:  20%|██        | 4/20 [00:12<00:48,  3.04s/it]
Task 13, Epoch 5/20 => Loss 0.365, Train_accy 88.03, Test_accy 38.54:  20%|██        | 4/20 [00:21<00:48,  3.04s/it]
Task 13, Epoch 5/20 => Loss 0.365, Train_accy 88.03, Test_accy 38.54:  25%|██▌       | 5/20 [00:21<01:22,  5.48s/it]
Task 13, Epoch 6/20 => Loss 0.255, Train_accy 90.61:  25%|██▌       | 5/20 [00:24<01:22,  5.48s/it]                 
Task 13, Epoch 6/20 => Loss 0.255, Train_accy 90.61:  30%|███       | 6/20 [00:24<01:04,  4.64s/it]
Task 13, Epoch 7/20 => Loss 0.232, Train_accy 94.17:  30%|███       | 6/20 [00:27<01:04,  4.64s/it]
Task 13, Epoch 7/20 => Loss 0.232, Train_accy 94.17:  35%|███▌      | 7/20 [00:27<00:53,  4.09s/it]
Task 13, Epoch 8/20 => Loss 0.201, Train_accy 93.53:  35%|███▌      | 7/20 [00:30<00:53,  4.09s/it]
Task 13, Epoch 8/20 => Loss 0.201, Train_accy 93.53:  40%|████      | 8/20 [00:30<00:44,  3.74s/it]
Task 13, Epoch 9/20 => Loss 0.166, Train_accy 94.50:  40%|████      | 8/20 [00:33<00:44,  3.74s/it]
Task 13, Epoch 9/20 => Loss 0.166, Train_accy 94.50:  45%|████▌     | 9/20 [00:33<00:38,  3.51s/it]
Task 13, Epoch 10/20 => Loss 0.139, Train_accy 94.82, Test_accy 39.16:  45%|████▌     | 9/20 [00:43<00:38,  3.51s/it]
Task 13, Epoch 10/20 => Loss 0.139, Train_accy 94.82, Test_accy 39.16:  50%|█████     | 10/20 [00:43<00:54,  5.42s/it]
Task 13, Epoch 11/20 => Loss 0.125, Train_accy 96.44:  50%|█████     | 10/20 [00:46<00:54,  5.42s/it]                 
Task 13, Epoch 11/20 => Loss 0.125, Train_accy 96.44:  55%|█████▌    | 11/20 [00:46<00:42,  4.69s/it]
Task 13, Epoch 12/20 => Loss 0.122, Train_accy 95.79:  55%|█████▌    | 11/20 [00:49<00:42,  4.69s/it]
Task 13, Epoch 12/20 => Loss 0.122, Train_accy 95.79:  60%|██████    | 12/20 [00:49<00:33,  4.18s/it]
Task 13, Epoch 13/20 => Loss 0.114, Train_accy 96.12:  60%|██████    | 12/20 [00:52<00:33,  4.18s/it]
Task 13, Epoch 13/20 => Loss 0.114, Train_accy 96.12:  65%|██████▌   | 13/20 [00:52<00:27,  3.87s/it]
Task 13, Epoch 14/20 => Loss 0.118, Train_accy 97.09:  65%|██████▌   | 13/20 [00:55<00:27,  3.87s/it]
Task 13, Epoch 14/20 => Loss 0.118, Train_accy 97.09:  70%|███████   | 14/20 [00:55<00:21,  3.61s/it]
Task 13, Epoch 15/20 => Loss 0.121, Train_accy 95.79, Test_accy 39.07:  70%|███████   | 14/20 [01:05<00:21,  3.61s/it]
Task 13, Epoch 15/20 => Loss 0.121, Train_accy 95.79, Test_accy 39.07:  75%|███████▌  | 15/20 [01:05<00:27,  5.47s/it]
Task 13, Epoch 16/20 => Loss 0.117, Train_accy 95.47:  75%|███████▌  | 15/20 [01:08<00:27,  5.47s/it]                 
Task 13, Epoch 16/20 => Loss 0.117, Train_accy 95.47:  80%|████████  | 16/20 [01:08<00:18,  4.74s/it]
Task 13, Epoch 17/20 => Loss 0.161, Train_accy 94.17:  80%|████████  | 16/20 [01:11<00:18,  4.74s/it]
Task 13, Epoch 17/20 => Loss 0.161, Train_accy 94.17:  85%|████████▌ | 17/20 [01:11<00:12,  4.23s/it]
Task 13, Epoch 18/20 => Loss 0.078, Train_accy 97.73:  85%|████████▌ | 17/20 [01:14<00:12,  4.23s/it]
Task 13, Epoch 18/20 => Loss 0.078, Train_accy 97.73:  90%|█████████ | 18/20 [01:14<00:07,  3.87s/it]
Task 13, Epoch 19/20 => Loss 0.155, Train_accy 96.44:  90%|█████████ | 18/20 [01:17<00:07,  3.87s/it]
Task 13, Epoch 19/20 => Loss 0.155, Train_accy 96.44:  95%|█████████▌| 19/20 [01:17<00:03,  3.60s/it]
Task 13, Epoch 20/20 => Loss 0.062, Train_accy 97.09, Test_accy 39.07:  95%|█████████▌| 19/20 [01:26<00:03,  3.60s/it]
Task 13, Epoch 20/20 => Loss 0.062, Train_accy 97.09, Test_accy 39.07: 100%|██████████| 20/20 [01:26<00:00,  5.25s/it]
Task 13, Epoch 20/20 => Loss 0.062, Train_accy 97.09, Test_accy 39.07: 100%|██████████| 20/20 [01:26<00:00,  4.34s/it]
2024-09-12 10:00:47,249 [dualprompt.py] => Task 13, Epoch 20/20 => Loss 0.062, Train_accy 97.09, Test_accy 39.07
2024-09-12 10:00:53,536 [trainer.py] => No NME accuracy.
2024-09-12 10:00:53,537 [trainer.py] => CNN: {'total': 39.07, '00-09': 38.96, '10-19': 65.31, '20-29': 51.52, '30-39': 45.35, '40-49': 42.19, '50-59': 34.62, '60-69': 38.89, '70-79': 38.54, '80-89': 34.57, '90-99': 27.42, '100-109': 30.0, '110-119': 37.84, '120-129': 16.67, '130-139': 25.58, 'old': 40.19, 'new': 25.58}
2024-09-12 10:00:53,537 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19, 39.07]
2024-09-12 10:00:53,537 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17, 70.92]

Average Accuracy (CNN): 53.44
2024-09-12 10:00:53,537 [trainer.py] => Average Accuracy (CNN): 53.44 

2024-09-12 10:00:53,540 [trainer.py] => All params: 172158352
2024-09-12 10:00:53,542 [trainer.py] => Trainable params: 407240
2024-09-12 10:00:53,542 [dualprompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.450, Train_accy 24.09:   0%|          | 0/20 [00:02<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.450, Train_accy 24.09:   5%|▌         | 1/20 [00:02<00:55,  2.95s/it]
Task 14, Epoch 2/20 => Loss 1.292, Train_accy 54.27:   5%|▌         | 1/20 [00:05<00:55,  2.95s/it]
Task 14, Epoch 2/20 => Loss 1.292, Train_accy 54.27:  10%|█         | 2/20 [00:05<00:53,  2.95s/it]
Task 14, Epoch 3/20 => Loss 0.685, Train_accy 75.91:  10%|█         | 2/20 [00:08<00:53,  2.95s/it]
Task 14, Epoch 3/20 => Loss 0.685, Train_accy 75.91:  15%|█▌        | 3/20 [00:08<00:50,  2.94s/it]
Task 14, Epoch 4/20 => Loss 0.471, Train_accy 83.23:  15%|█▌        | 3/20 [00:11<00:50,  2.94s/it]
Task 14, Epoch 4/20 => Loss 0.471, Train_accy 83.23:  20%|██        | 4/20 [00:11<00:47,  2.96s/it]
Task 14, Epoch 5/20 => Loss 0.335, Train_accy 90.85, Test_accy 37.68:  20%|██        | 4/20 [00:21<00:47,  2.96s/it]
Task 14, Epoch 5/20 => Loss 0.335, Train_accy 90.85, Test_accy 37.68:  25%|██▌       | 5/20 [00:21<01:22,  5.50s/it]
Task 14, Epoch 6/20 => Loss 0.284, Train_accy 90.85:  25%|██▌       | 5/20 [00:24<01:22,  5.50s/it]                 
Task 14, Epoch 6/20 => Loss 0.284, Train_accy 90.85:  30%|███       | 6/20 [00:24<01:05,  4.71s/it]
Task 14, Epoch 7/20 => Loss 0.205, Train_accy 92.99:  30%|███       | 6/20 [00:28<01:05,  4.71s/it]
Task 14, Epoch 7/20 => Loss 0.205, Train_accy 92.99:  35%|███▌      | 7/20 [00:28<00:55,  4.25s/it]
Task 14, Epoch 8/20 => Loss 0.170, Train_accy 95.43:  35%|███▌      | 7/20 [00:31<00:55,  4.25s/it]
Task 14, Epoch 8/20 => Loss 0.170, Train_accy 95.43:  40%|████      | 8/20 [00:31<00:46,  3.91s/it]
Task 14, Epoch 9/20 => Loss 0.134, Train_accy 95.73:  40%|████      | 8/20 [00:34<00:46,  3.91s/it]
Task 14, Epoch 9/20 => Loss 0.134, Train_accy 95.73:  45%|████▌     | 9/20 [00:34<00:40,  3.67s/it]
Task 14, Epoch 10/20 => Loss 0.135, Train_accy 96.34, Test_accy 38.18:  45%|████▌     | 9/20 [00:45<00:40,  3.67s/it]
Task 14, Epoch 10/20 => Loss 0.135, Train_accy 96.34, Test_accy 38.18:  50%|█████     | 10/20 [00:45<00:58,  5.84s/it]
Task 14, Epoch 11/20 => Loss 0.153, Train_accy 94.82:  50%|█████     | 10/20 [00:48<00:58,  5.84s/it]                 
Task 14, Epoch 11/20 => Loss 0.153, Train_accy 94.82:  55%|█████▌    | 11/20 [00:48<00:45,  5.02s/it]
Task 14, Epoch 12/20 => Loss 0.129, Train_accy 96.65:  55%|█████▌    | 11/20 [00:51<00:45,  5.02s/it]
Task 14, Epoch 12/20 => Loss 0.129, Train_accy 96.65:  60%|██████    | 12/20 [00:51<00:35,  4.44s/it]
Task 14, Epoch 13/20 => Loss 0.116, Train_accy 95.73:  60%|██████    | 12/20 [00:54<00:35,  4.44s/it]
Task 14, Epoch 13/20 => Loss 0.116, Train_accy 95.73:  65%|██████▌   | 13/20 [00:54<00:28,  4.07s/it]
Task 14, Epoch 14/20 => Loss 0.170, Train_accy 93.90:  65%|██████▌   | 13/20 [00:57<00:28,  4.07s/it]
Task 14, Epoch 14/20 => Loss 0.170, Train_accy 93.90:  70%|███████   | 14/20 [00:57<00:22,  3.79s/it]
Task 14, Epoch 15/20 => Loss 0.072, Train_accy 98.17, Test_accy 38.43:  70%|███████   | 14/20 [01:08<00:22,  3.79s/it]
Task 14, Epoch 15/20 => Loss 0.072, Train_accy 98.17, Test_accy 38.43:  75%|███████▌  | 15/20 [01:08<00:28,  5.76s/it]
Task 14, Epoch 16/20 => Loss 0.117, Train_accy 97.26:  75%|███████▌  | 15/20 [01:11<00:28,  5.76s/it]                 
Task 14, Epoch 16/20 => Loss 0.117, Train_accy 97.26:  80%|████████  | 16/20 [01:11<00:19,  4.99s/it]
Task 14, Epoch 17/20 => Loss 0.063, Train_accy 98.17:  80%|████████  | 16/20 [01:14<00:19,  4.99s/it]
Task 14, Epoch 17/20 => Loss 0.063, Train_accy 98.17:  85%|████████▌ | 17/20 [01:14<00:13,  4.46s/it]
Task 14, Epoch 18/20 => Loss 0.079, Train_accy 96.04:  85%|████████▌ | 17/20 [01:17<00:13,  4.46s/it]
Task 14, Epoch 18/20 => Loss 0.079, Train_accy 96.04:  90%|█████████ | 18/20 [01:17<00:08,  4.09s/it]
Task 14, Epoch 19/20 => Loss 0.070, Train_accy 96.65:  90%|█████████ | 18/20 [01:21<00:08,  4.09s/it]
Task 14, Epoch 19/20 => Loss 0.070, Train_accy 96.65:  95%|█████████▌| 19/20 [01:21<00:03,  3.84s/it]
Task 14, Epoch 20/20 => Loss 0.055, Train_accy 97.87, Test_accy 38.51:  95%|█████████▌| 19/20 [01:31<00:03,  3.84s/it]
Task 14, Epoch 20/20 => Loss 0.055, Train_accy 97.87, Test_accy 38.51: 100%|██████████| 20/20 [01:31<00:00,  5.83s/it]
Task 14, Epoch 20/20 => Loss 0.055, Train_accy 97.87, Test_accy 38.51: 100%|██████████| 20/20 [01:31<00:00,  4.58s/it]
2024-09-12 10:02:25,218 [dualprompt.py] => Task 14, Epoch 20/20 => Loss 0.055, Train_accy 97.87, Test_accy 38.51
2024-09-12 10:02:32,495 [trainer.py] => No NME accuracy.
2024-09-12 10:02:32,495 [trainer.py] => CNN: {'total': 38.51, '00-09': 38.96, '10-19': 63.27, '20-29': 52.53, '30-39': 45.35, '40-49': 40.62, '50-59': 32.69, '60-69': 40.48, '70-79': 36.46, '80-89': 34.57, '90-99': 29.03, '100-109': 31.67, '110-119': 36.49, '120-129': 15.0, '130-139': 24.42, '140-149': 35.53, 'old': 38.72, 'new': 35.53}
2024-09-12 10:02:32,496 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19, 39.07, 38.51]
2024-09-12 10:02:32,496 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17, 70.92, 69.17]

Average Accuracy (CNN): 52.44
2024-09-12 10:02:32,496 [trainer.py] => Average Accuracy (CNN): 52.44 

2024-09-12 10:02:32,498 [trainer.py] => All params: 172158352
2024-09-12 10:02:32,501 [trainer.py] => Trainable params: 407240
2024-09-12 10:02:32,501 [dualprompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.520, Train_accy 22.66:   0%|          | 0/20 [00:02<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.520, Train_accy 22.66:   5%|▌         | 1/20 [00:02<00:40,  2.12s/it]
Task 15, Epoch 2/20 => Loss 1.217, Train_accy 57.64:   5%|▌         | 1/20 [00:04<00:40,  2.12s/it]
Task 15, Epoch 2/20 => Loss 1.217, Train_accy 57.64:  10%|█         | 2/20 [00:04<00:38,  2.12s/it]
Task 15, Epoch 3/20 => Loss 0.883, Train_accy 73.40:  10%|█         | 2/20 [00:06<00:38,  2.12s/it]
Task 15, Epoch 3/20 => Loss 0.883, Train_accy 73.40:  15%|█▌        | 3/20 [00:06<00:36,  2.12s/it]
Task 15, Epoch 4/20 => Loss 0.620, Train_accy 81.28:  15%|█▌        | 3/20 [00:08<00:36,  2.12s/it]
Task 15, Epoch 4/20 => Loss 0.620, Train_accy 81.28:  20%|██        | 4/20 [00:08<00:34,  2.17s/it]
Task 15, Epoch 5/20 => Loss 0.352, Train_accy 89.66, Test_accy 37.66:  20%|██        | 4/20 [00:18<00:34,  2.17s/it]
Task 15, Epoch 5/20 => Loss 0.352, Train_accy 89.66, Test_accy 37.66:  25%|██▌       | 5/20 [00:18<01:14,  4.94s/it]
Task 15, Epoch 6/20 => Loss 0.240, Train_accy 92.61:  25%|██▌       | 5/20 [00:20<01:14,  4.94s/it]                 
Task 15, Epoch 6/20 => Loss 0.240, Train_accy 92.61:  30%|███       | 6/20 [00:20<00:55,  3.98s/it]
Task 15, Epoch 7/20 => Loss 0.186, Train_accy 95.07:  30%|███       | 6/20 [00:22<00:55,  3.98s/it]
Task 15, Epoch 7/20 => Loss 0.186, Train_accy 95.07:  35%|███▌      | 7/20 [00:22<00:44,  3.39s/it]
Task 15, Epoch 8/20 => Loss 0.138, Train_accy 95.57:  35%|███▌      | 7/20 [00:24<00:44,  3.39s/it]
Task 15, Epoch 8/20 => Loss 0.138, Train_accy 95.57:  40%|████      | 8/20 [00:24<00:35,  2.99s/it]
Task 15, Epoch 9/20 => Loss 0.124, Train_accy 97.04:  40%|████      | 8/20 [00:27<00:35,  2.99s/it]
Task 15, Epoch 9/20 => Loss 0.124, Train_accy 97.04:  45%|████▌     | 9/20 [00:27<00:30,  2.75s/it]
Task 15, Epoch 10/20 => Loss 0.135, Train_accy 95.07, Test_accy 37.42:  45%|████▌     | 9/20 [00:36<00:30,  2.75s/it]
Task 15, Epoch 10/20 => Loss 0.135, Train_accy 95.07, Test_accy 37.42:  50%|█████     | 10/20 [00:36<00:48,  4.88s/it]
Task 15, Epoch 11/20 => Loss 0.067, Train_accy 99.01:  50%|█████     | 10/20 [00:38<00:48,  4.88s/it]                 
Task 15, Epoch 11/20 => Loss 0.067, Train_accy 99.01:  55%|█████▌    | 11/20 [00:38<00:36,  4.04s/it]
Task 15, Epoch 12/20 => Loss 0.083, Train_accy 96.55:  55%|█████▌    | 11/20 [00:41<00:36,  4.04s/it]
Task 15, Epoch 12/20 => Loss 0.083, Train_accy 96.55:  60%|██████    | 12/20 [00:41<00:27,  3.47s/it]
Task 15, Epoch 13/20 => Loss 0.081, Train_accy 99.51:  60%|██████    | 12/20 [00:43<00:27,  3.47s/it]
Task 15, Epoch 13/20 => Loss 0.081, Train_accy 99.51:  65%|██████▌   | 13/20 [00:43<00:21,  3.06s/it]
Task 15, Epoch 14/20 => Loss 0.083, Train_accy 95.57:  65%|██████▌   | 13/20 [00:45<00:21,  3.06s/it]
Task 15, Epoch 14/20 => Loss 0.083, Train_accy 95.57:  70%|███████   | 14/20 [00:45<00:16,  2.77s/it]
Task 15, Epoch 15/20 => Loss 0.042, Train_accy 98.52, Test_accy 37.74:  70%|███████   | 14/20 [00:54<00:16,  2.77s/it]
Task 15, Epoch 15/20 => Loss 0.042, Train_accy 98.52, Test_accy 37.74:  75%|███████▌  | 15/20 [00:54<00:24,  4.86s/it]
Task 15, Epoch 16/20 => Loss 0.064, Train_accy 97.54:  75%|███████▌  | 15/20 [00:57<00:24,  4.86s/it]                 
Task 15, Epoch 16/20 => Loss 0.064, Train_accy 97.54:  80%|████████  | 16/20 [00:57<00:16,  4.04s/it]
Task 15, Epoch 17/20 => Loss 0.054, Train_accy 97.54:  80%|████████  | 16/20 [00:59<00:16,  4.04s/it]
Task 15, Epoch 17/20 => Loss 0.054, Train_accy 97.54:  85%|████████▌ | 17/20 [00:59<00:10,  3.53s/it]
Task 15, Epoch 18/20 => Loss 0.052, Train_accy 97.54:  85%|████████▌ | 17/20 [01:01<00:10,  3.53s/it]
Task 15, Epoch 18/20 => Loss 0.052, Train_accy 97.54:  90%|█████████ | 18/20 [01:01<00:06,  3.11s/it]
Task 15, Epoch 19/20 => Loss 0.088, Train_accy 98.03:  90%|█████████ | 18/20 [01:03<00:06,  3.11s/it]
Task 15, Epoch 19/20 => Loss 0.088, Train_accy 98.03:  95%|█████████▌| 19/20 [01:03<00:02,  2.81s/it]
Task 15, Epoch 20/20 => Loss 0.045, Train_accy 98.52, Test_accy 37.74:  95%|█████████▌| 19/20 [01:12<00:02,  2.81s/it]
Task 15, Epoch 20/20 => Loss 0.045, Train_accy 98.52, Test_accy 37.74: 100%|██████████| 20/20 [01:12<00:00,  4.69s/it]
Task 15, Epoch 20/20 => Loss 0.045, Train_accy 98.52, Test_accy 37.74: 100%|██████████| 20/20 [01:12<00:00,  3.64s/it]
2024-09-12 10:03:45,304 [dualprompt.py] => Task 15, Epoch 20/20 => Loss 0.045, Train_accy 98.52, Test_accy 37.74
2024-09-12 10:03:52,229 [trainer.py] => No NME accuracy.
2024-09-12 10:03:52,229 [trainer.py] => CNN: {'total': 37.74, '00-09': 37.66, '10-19': 61.22, '20-29': 50.51, '30-39': 45.35, '40-49': 37.5, '50-59': 32.69, '60-69': 38.1, '70-79': 36.46, '80-89': 34.57, '90-99': 30.65, '100-109': 30.0, '110-119': 37.84, '120-129': 15.0, '130-139': 26.74, '140-149': 35.53, '150-159': 33.33, 'old': 37.93, 'new': 33.33}
2024-09-12 10:03:52,230 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19, 39.07, 38.51, 37.74]
2024-09-12 10:03:52,230 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17, 70.92, 69.17, 67.95]

Average Accuracy (CNN): 51.52
2024-09-12 10:03:52,230 [trainer.py] => Average Accuracy (CNN): 51.52 

2024-09-12 10:03:52,232 [trainer.py] => All params: 172158352
2024-09-12 10:03:52,234 [trainer.py] => Trainable params: 407240
2024-09-12 10:03:52,234 [dualprompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.501, Train_accy 26.65:   0%|          | 0/20 [00:03<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.501, Train_accy 26.65:   5%|▌         | 1/20 [00:03<00:58,  3.11s/it]
Task 16, Epoch 2/20 => Loss 1.417, Train_accy 47.90:   5%|▌         | 1/20 [00:06<00:58,  3.11s/it]
Task 16, Epoch 2/20 => Loss 1.417, Train_accy 47.90:  10%|█         | 2/20 [00:06<00:55,  3.07s/it]
Task 16, Epoch 3/20 => Loss 0.905, Train_accy 69.16:  10%|█         | 2/20 [00:09<00:55,  3.07s/it]
Task 16, Epoch 3/20 => Loss 0.905, Train_accy 69.16:  15%|█▌        | 3/20 [00:09<00:51,  3.03s/it]
Task 16, Epoch 4/20 => Loss 0.513, Train_accy 83.53:  15%|█▌        | 3/20 [00:12<00:51,  3.03s/it]
Task 16, Epoch 4/20 => Loss 0.513, Train_accy 83.53:  20%|██        | 4/20 [00:12<00:49,  3.07s/it]
Task 16, Epoch 5/20 => Loss 0.405, Train_accy 88.32, Test_accy 36.23:  20%|██        | 4/20 [00:22<00:49,  3.07s/it]
Task 16, Epoch 5/20 => Loss 0.405, Train_accy 88.32, Test_accy 36.23:  25%|██▌       | 5/20 [00:22<01:27,  5.83s/it]
Task 16, Epoch 6/20 => Loss 0.304, Train_accy 90.72:  25%|██▌       | 5/20 [00:26<01:27,  5.83s/it]                 
Task 16, Epoch 6/20 => Loss 0.304, Train_accy 90.72:  30%|███       | 6/20 [00:26<01:09,  4.99s/it]
Task 16, Epoch 7/20 => Loss 0.273, Train_accy 90.12:  30%|███       | 6/20 [00:29<01:09,  4.99s/it]
Task 16, Epoch 7/20 => Loss 0.273, Train_accy 90.12:  35%|███▌      | 7/20 [00:29<00:57,  4.41s/it]
Task 16, Epoch 8/20 => Loss 0.265, Train_accy 92.51:  35%|███▌      | 7/20 [00:32<00:57,  4.41s/it]
Task 16, Epoch 8/20 => Loss 0.265, Train_accy 92.51:  40%|████      | 8/20 [00:32<00:48,  4.07s/it]
Task 16, Epoch 9/20 => Loss 0.187, Train_accy 93.11:  40%|████      | 8/20 [00:36<00:48,  4.07s/it]
Task 16, Epoch 9/20 => Loss 0.187, Train_accy 93.11:  45%|████▌     | 9/20 [00:36<00:42,  3.83s/it]
Task 16, Epoch 10/20 => Loss 0.272, Train_accy 92.81, Test_accy 36.31:  45%|████▌     | 9/20 [00:47<00:42,  3.83s/it]
Task 16, Epoch 10/20 => Loss 0.272, Train_accy 92.81, Test_accy 36.31:  50%|█████     | 10/20 [00:47<01:01,  6.15s/it]
Task 16, Epoch 11/20 => Loss 0.164, Train_accy 94.01:  50%|█████     | 10/20 [00:50<01:01,  6.15s/it]                 
Task 16, Epoch 11/20 => Loss 0.164, Train_accy 94.01:  55%|█████▌    | 11/20 [00:50<00:47,  5.27s/it]
Task 16, Epoch 12/20 => Loss 0.158, Train_accy 95.81:  55%|█████▌    | 11/20 [00:54<00:47,  5.27s/it]
Task 16, Epoch 12/20 => Loss 0.158, Train_accy 95.81:  60%|██████    | 12/20 [00:54<00:37,  4.65s/it]
Task 16, Epoch 13/20 => Loss 0.107, Train_accy 97.90:  60%|██████    | 12/20 [00:57<00:37,  4.65s/it]
Task 16, Epoch 13/20 => Loss 0.107, Train_accy 97.90:  65%|██████▌   | 13/20 [00:57<00:29,  4.22s/it]
Task 16, Epoch 14/20 => Loss 0.109, Train_accy 96.41:  65%|██████▌   | 13/20 [01:00<00:29,  4.22s/it]
Task 16, Epoch 14/20 => Loss 0.109, Train_accy 96.41:  70%|███████   | 14/20 [01:00<00:23,  3.94s/it]
Task 16, Epoch 15/20 => Loss 0.112, Train_accy 96.11, Test_accy 36.53:  70%|███████   | 14/20 [01:11<00:23,  3.94s/it]
Task 16, Epoch 15/20 => Loss 0.112, Train_accy 96.11, Test_accy 36.53:  75%|███████▌  | 15/20 [01:11<00:30,  6.14s/it]
Task 16, Epoch 16/20 => Loss 0.130, Train_accy 95.51:  75%|███████▌  | 15/20 [01:15<00:30,  6.14s/it]                 
Task 16, Epoch 16/20 => Loss 0.130, Train_accy 95.51:  80%|████████  | 16/20 [01:15<00:21,  5.29s/it]
Task 16, Epoch 17/20 => Loss 0.139, Train_accy 96.11:  80%|████████  | 16/20 [01:18<00:21,  5.29s/it]
Task 16, Epoch 17/20 => Loss 0.139, Train_accy 96.11:  85%|████████▌ | 17/20 [01:18<00:14,  4.69s/it]
Task 16, Epoch 18/20 => Loss 0.106, Train_accy 96.11:  85%|████████▌ | 17/20 [01:21<00:14,  4.69s/it]
Task 16, Epoch 18/20 => Loss 0.106, Train_accy 96.11:  90%|█████████ | 18/20 [01:21<00:08,  4.25s/it]
Task 16, Epoch 19/20 => Loss 0.088, Train_accy 97.01:  90%|█████████ | 18/20 [01:24<00:08,  4.25s/it]
Task 16, Epoch 19/20 => Loss 0.088, Train_accy 97.01:  95%|█████████▌| 19/20 [01:24<00:03,  3.95s/it]
Task 16, Epoch 20/20 => Loss 0.100, Train_accy 96.71, Test_accy 37.21:  95%|█████████▌| 19/20 [01:36<00:03,  3.95s/it]
Task 16, Epoch 20/20 => Loss 0.100, Train_accy 96.71, Test_accy 37.21: 100%|██████████| 20/20 [01:36<00:00,  6.18s/it]
Task 16, Epoch 20/20 => Loss 0.100, Train_accy 96.71, Test_accy 37.21: 100%|██████████| 20/20 [01:36<00:00,  4.81s/it]
2024-09-12 10:05:28,532 [dualprompt.py] => Task 16, Epoch 20/20 => Loss 0.100, Train_accy 96.71, Test_accy 37.21
2024-09-12 10:05:36,547 [trainer.py] => No NME accuracy.
2024-09-12 10:05:36,548 [trainer.py] => CNN: {'total': 37.21, '00-09': 38.96, '10-19': 61.22, '20-29': 52.53, '30-39': 45.35, '40-49': 32.81, '50-59': 36.54, '60-69': 38.89, '70-79': 34.38, '80-89': 34.57, '90-99': 32.26, '100-109': 30.0, '110-119': 37.84, '120-129': 13.33, '130-139': 24.42, '140-149': 32.89, '150-159': 33.33, '160-169': 32.94, 'old': 37.5, 'new': 32.94}
2024-09-12 10:05:36,548 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19, 39.07, 38.51, 37.74, 37.21]
2024-09-12 10:05:36,548 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17, 70.92, 69.17, 67.95, 66.39]

Average Accuracy (CNN): 50.68
2024-09-12 10:05:36,548 [trainer.py] => Average Accuracy (CNN): 50.68 

2024-09-12 10:05:36,551 [trainer.py] => All params: 172158352
2024-09-12 10:05:36,553 [trainer.py] => Trainable params: 407240
2024-09-12 10:05:36,553 [dualprompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.779, Train_accy 15.19:   0%|          | 0/20 [00:02<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.779, Train_accy 15.19:   5%|▌         | 1/20 [00:02<00:47,  2.47s/it]
Task 17, Epoch 2/20 => Loss 1.495, Train_accy 48.52:   5%|▌         | 1/20 [00:04<00:47,  2.47s/it]
Task 17, Epoch 2/20 => Loss 1.495, Train_accy 48.52:  10%|█         | 2/20 [00:04<00:44,  2.47s/it]
Task 17, Epoch 3/20 => Loss 0.879, Train_accy 71.31:  10%|█         | 2/20 [00:07<00:44,  2.47s/it]
Task 17, Epoch 3/20 => Loss 0.879, Train_accy 71.31:  15%|█▌        | 3/20 [00:07<00:41,  2.47s/it]
Task 17, Epoch 4/20 => Loss 0.477, Train_accy 86.92:  15%|█▌        | 3/20 [00:09<00:41,  2.47s/it]
Task 17, Epoch 4/20 => Loss 0.477, Train_accy 86.92:  20%|██        | 4/20 [00:09<00:39,  2.45s/it]
Task 17, Epoch 5/20 => Loss 0.362, Train_accy 89.87, Test_accy 36.06:  20%|██        | 4/20 [00:20<00:39,  2.45s/it]
Task 17, Epoch 5/20 => Loss 0.362, Train_accy 89.87, Test_accy 36.06:  25%|██▌       | 5/20 [00:20<01:22,  5.47s/it]
Task 17, Epoch 6/20 => Loss 0.222, Train_accy 94.09:  25%|██▌       | 5/20 [00:23<01:22,  5.47s/it]                 
Task 17, Epoch 6/20 => Loss 0.222, Train_accy 94.09:  30%|███       | 6/20 [00:23<01:02,  4.45s/it]
Task 17, Epoch 7/20 => Loss 0.127, Train_accy 97.05:  30%|███       | 6/20 [00:25<01:02,  4.45s/it]
Task 17, Epoch 7/20 => Loss 0.127, Train_accy 97.05:  35%|███▌      | 7/20 [00:25<00:49,  3.79s/it]
Task 17, Epoch 8/20 => Loss 0.174, Train_accy 91.98:  35%|███▌      | 7/20 [00:28<00:49,  3.79s/it]
Task 17, Epoch 8/20 => Loss 0.174, Train_accy 91.98:  40%|████      | 8/20 [00:28<00:40,  3.37s/it]
Task 17, Epoch 9/20 => Loss 0.163, Train_accy 96.20:  40%|████      | 8/20 [00:30<00:40,  3.37s/it]
Task 17, Epoch 9/20 => Loss 0.163, Train_accy 96.20:  45%|████▌     | 9/20 [00:30<00:34,  3.10s/it]
Task 17, Epoch 10/20 => Loss 0.065, Train_accy 98.73, Test_accy 36.42:  45%|████▌     | 9/20 [00:41<00:34,  3.10s/it]
Task 17, Epoch 10/20 => Loss 0.065, Train_accy 98.73, Test_accy 36.42:  50%|█████     | 10/20 [00:41<00:55,  5.51s/it]
Task 17, Epoch 11/20 => Loss 0.128, Train_accy 95.78:  50%|█████     | 10/20 [00:43<00:55,  5.51s/it]                 
Task 17, Epoch 11/20 => Loss 0.128, Train_accy 95.78:  55%|█████▌    | 11/20 [00:43<00:41,  4.59s/it]
Task 17, Epoch 12/20 => Loss 0.139, Train_accy 95.78:  55%|█████▌    | 11/20 [00:46<00:41,  4.59s/it]
Task 17, Epoch 12/20 => Loss 0.139, Train_accy 95.78:  60%|██████    | 12/20 [00:46<00:31,  3.95s/it]
Task 17, Epoch 13/20 => Loss 0.083, Train_accy 97.05:  60%|██████    | 12/20 [00:48<00:31,  3.95s/it]
Task 17, Epoch 13/20 => Loss 0.083, Train_accy 97.05:  65%|██████▌   | 13/20 [00:48<00:24,  3.49s/it]
Task 17, Epoch 14/20 => Loss 0.082, Train_accy 97.47:  65%|██████▌   | 13/20 [00:51<00:24,  3.49s/it]
Task 17, Epoch 14/20 => Loss 0.082, Train_accy 97.47:  70%|███████   | 14/20 [00:51<00:18,  3.16s/it]
Task 17, Epoch 15/20 => Loss 0.068, Train_accy 97.89, Test_accy 36.34:  70%|███████   | 14/20 [01:02<00:18,  3.16s/it]
Task 17, Epoch 15/20 => Loss 0.068, Train_accy 97.89, Test_accy 36.34:  75%|███████▌  | 15/20 [01:02<00:27,  5.55s/it]
Task 17, Epoch 16/20 => Loss 0.118, Train_accy 95.78:  75%|███████▌  | 15/20 [01:04<00:27,  5.55s/it]                 
Task 17, Epoch 16/20 => Loss 0.118, Train_accy 95.78:  80%|████████  | 16/20 [01:04<00:18,  4.57s/it]
Task 17, Epoch 17/20 => Loss 0.051, Train_accy 98.73:  80%|████████  | 16/20 [01:06<00:18,  4.57s/it]
Task 17, Epoch 17/20 => Loss 0.051, Train_accy 98.73:  85%|████████▌ | 17/20 [01:06<00:11,  3.90s/it]
Task 17, Epoch 18/20 => Loss 0.020, Train_accy 99.58:  85%|████████▌ | 17/20 [01:09<00:11,  3.90s/it]
Task 17, Epoch 18/20 => Loss 0.020, Train_accy 99.58:  90%|█████████ | 18/20 [01:09<00:06,  3.38s/it]
Task 17, Epoch 19/20 => Loss 0.150, Train_accy 94.94:  90%|█████████ | 18/20 [01:11<00:06,  3.38s/it]
Task 17, Epoch 19/20 => Loss 0.150, Train_accy 94.94:  95%|█████████▌| 19/20 [01:11<00:03,  3.06s/it]
Task 17, Epoch 20/20 => Loss 0.060, Train_accy 97.05, Test_accy 36.13:  95%|█████████▌| 19/20 [01:21<00:03,  3.06s/it]
Task 17, Epoch 20/20 => Loss 0.060, Train_accy 97.05, Test_accy 36.13: 100%|██████████| 20/20 [01:21<00:00,  5.17s/it]
Task 17, Epoch 20/20 => Loss 0.060, Train_accy 97.05, Test_accy 36.13: 100%|██████████| 20/20 [01:21<00:00,  4.08s/it]
2024-09-12 10:06:58,103 [dualprompt.py] => Task 17, Epoch 20/20 => Loss 0.060, Train_accy 97.05, Test_accy 36.13
2024-09-12 10:07:05,756 [trainer.py] => No NME accuracy.
2024-09-12 10:07:05,756 [trainer.py] => CNN: {'total': 36.13, '00-09': 38.96, '10-19': 60.2, '20-29': 51.52, '30-39': 44.19, '40-49': 31.25, '50-59': 38.46, '60-69': 38.1, '70-79': 33.33, '80-89': 35.8, '90-99': 30.65, '100-109': 30.0, '110-119': 37.84, '120-129': 11.67, '130-139': 24.42, '140-149': 32.89, '150-159': 31.37, '160-169': 32.94, '170-179': 24.19, 'old': 36.68, 'new': 24.19}
2024-09-12 10:07:05,757 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19, 39.07, 38.51, 37.74, 37.21, 36.13]
2024-09-12 10:07:05,757 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17, 70.92, 69.17, 67.95, 66.39, 65.09]

Average Accuracy (CNN): 49.87
2024-09-12 10:07:05,757 [trainer.py] => Average Accuracy (CNN): 49.87 

2024-09-12 10:07:05,759 [trainer.py] => All params: 172158352
2024-09-12 10:07:05,761 [trainer.py] => Trainable params: 407240
2024-09-12 10:07:05,762 [dualprompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 3.236, Train_accy 13.76:   0%|          | 0/20 [00:01<?, ?it/s]
Task 18, Epoch 1/20 => Loss 3.236, Train_accy 13.76:   5%|▌         | 1/20 [00:01<00:35,  1.89s/it]
Task 18, Epoch 2/20 => Loss 1.549, Train_accy 46.56:   5%|▌         | 1/20 [00:03<00:35,  1.89s/it]
Task 18, Epoch 2/20 => Loss 1.549, Train_accy 46.56:  10%|█         | 2/20 [00:03<00:33,  1.87s/it]
Task 18, Epoch 3/20 => Loss 0.932, Train_accy 73.02:  10%|█         | 2/20 [00:05<00:33,  1.87s/it]
Task 18, Epoch 3/20 => Loss 0.932, Train_accy 73.02:  15%|█▌        | 3/20 [00:05<00:32,  1.90s/it]
Task 18, Epoch 4/20 => Loss 0.587, Train_accy 79.89:  15%|█▌        | 3/20 [00:07<00:32,  1.90s/it]
Task 18, Epoch 4/20 => Loss 0.587, Train_accy 79.89:  20%|██        | 4/20 [00:07<00:30,  1.92s/it]
Task 18, Epoch 5/20 => Loss 0.373, Train_accy 89.42, Test_accy 35.50:  20%|██        | 4/20 [00:18<00:30,  1.92s/it]
Task 18, Epoch 5/20 => Loss 0.373, Train_accy 89.42, Test_accy 35.50:  25%|██▌       | 5/20 [00:18<01:15,  5.05s/it]
Task 18, Epoch 6/20 => Loss 0.307, Train_accy 89.95:  25%|██▌       | 5/20 [00:20<01:15,  5.05s/it]                 
Task 18, Epoch 6/20 => Loss 0.307, Train_accy 89.95:  30%|███       | 6/20 [00:20<00:56,  4.04s/it]
Task 18, Epoch 7/20 => Loss 0.200, Train_accy 94.71:  30%|███       | 6/20 [00:22<00:56,  4.04s/it]
Task 18, Epoch 7/20 => Loss 0.200, Train_accy 94.71:  35%|███▌      | 7/20 [00:22<00:43,  3.38s/it]
Task 18, Epoch 8/20 => Loss 0.129, Train_accy 96.83:  35%|███▌      | 7/20 [00:24<00:43,  3.38s/it]
Task 18, Epoch 8/20 => Loss 0.129, Train_accy 96.83:  40%|████      | 8/20 [00:24<00:35,  2.95s/it]
Task 18, Epoch 9/20 => Loss 0.115, Train_accy 97.35:  40%|████      | 8/20 [00:26<00:35,  2.95s/it]
Task 18, Epoch 9/20 => Loss 0.115, Train_accy 97.35:  45%|████▌     | 9/20 [00:26<00:29,  2.67s/it]
Task 18, Epoch 10/20 => Loss 0.089, Train_accy 97.35, Test_accy 35.63:  45%|████▌     | 9/20 [00:37<00:29,  2.67s/it]
Task 18, Epoch 10/20 => Loss 0.089, Train_accy 97.35, Test_accy 35.63:  50%|█████     | 10/20 [00:37<00:51,  5.14s/it]
Task 18, Epoch 11/20 => Loss 0.093, Train_accy 96.83:  50%|█████     | 10/20 [00:39<00:51,  5.14s/it]                 
Task 18, Epoch 11/20 => Loss 0.093, Train_accy 96.83:  55%|█████▌    | 11/20 [00:39<00:37,  4.20s/it]
Task 18, Epoch 12/20 => Loss 0.030, Train_accy 98.94:  55%|█████▌    | 11/20 [00:41<00:37,  4.20s/it]
Task 18, Epoch 12/20 => Loss 0.030, Train_accy 98.94:  60%|██████    | 12/20 [00:41<00:28,  3.59s/it]
Task 18, Epoch 13/20 => Loss 0.045, Train_accy 97.88:  60%|██████    | 12/20 [00:43<00:28,  3.59s/it]
Task 18, Epoch 13/20 => Loss 0.045, Train_accy 97.88:  65%|██████▌   | 13/20 [00:43<00:21,  3.13s/it]
Task 18, Epoch 14/20 => Loss 0.051, Train_accy 97.88:  65%|██████▌   | 13/20 [00:45<00:21,  3.13s/it]
Task 18, Epoch 14/20 => Loss 0.051, Train_accy 97.88:  70%|███████   | 14/20 [00:45<00:16,  2.78s/it]
Task 18, Epoch 15/20 => Loss 0.046, Train_accy 97.88, Test_accy 35.70:  70%|███████   | 14/20 [00:55<00:16,  2.78s/it]
Task 18, Epoch 15/20 => Loss 0.046, Train_accy 97.88, Test_accy 35.70:  75%|███████▌  | 15/20 [00:55<00:25,  5.13s/it]
Task 18, Epoch 16/20 => Loss 0.073, Train_accy 97.35:  75%|███████▌  | 15/20 [00:58<00:25,  5.13s/it]                 
Task 18, Epoch 16/20 => Loss 0.073, Train_accy 97.35:  80%|████████  | 16/20 [00:58<00:16,  4.21s/it]
Task 18, Epoch 17/20 => Loss 0.043, Train_accy 97.35:  80%|████████  | 16/20 [01:00<00:16,  4.21s/it]
Task 18, Epoch 17/20 => Loss 0.043, Train_accy 97.35:  85%|████████▌ | 17/20 [01:00<00:10,  3.55s/it]
Task 18, Epoch 18/20 => Loss 0.027, Train_accy 98.41:  85%|████████▌ | 17/20 [01:02<00:10,  3.55s/it]
Task 18, Epoch 18/20 => Loss 0.027, Train_accy 98.41:  90%|█████████ | 18/20 [01:02<00:06,  3.07s/it]
Task 18, Epoch 19/20 => Loss 0.014, Train_accy 98.94:  90%|█████████ | 18/20 [01:04<00:06,  3.07s/it]
Task 18, Epoch 19/20 => Loss 0.014, Train_accy 98.94:  95%|█████████▌| 19/20 [01:04<00:02,  2.79s/it]
Task 18, Epoch 20/20 => Loss 0.065, Train_accy 97.35, Test_accy 35.84:  95%|█████████▌| 19/20 [01:14<00:02,  2.79s/it]
Task 18, Epoch 20/20 => Loss 0.065, Train_accy 97.35, Test_accy 35.84: 100%|██████████| 20/20 [01:14<00:00,  5.11s/it]
Task 18, Epoch 20/20 => Loss 0.065, Train_accy 97.35, Test_accy 35.84: 100%|██████████| 20/20 [01:14<00:00,  3.73s/it]
2024-09-12 10:08:20,431 [dualprompt.py] => Task 18, Epoch 20/20 => Loss 0.065, Train_accy 97.35, Test_accy 35.84
2024-09-12 10:08:29,103 [trainer.py] => No NME accuracy.
2024-09-12 10:08:29,103 [trainer.py] => CNN: {'total': 35.84, '00-09': 38.96, '10-19': 60.2, '20-29': 54.55, '30-39': 45.35, '40-49': 29.69, '50-59': 34.62, '60-69': 36.51, '70-79': 31.25, '80-89': 34.57, '90-99': 32.26, '100-109': 31.67, '110-119': 37.84, '120-129': 13.33, '130-139': 25.58, '140-149': 32.89, '150-159': 31.37, '160-169': 34.12, '170-179': 24.19, '180-189': 23.08, 'old': 36.2, 'new': 23.08}
2024-09-12 10:08:29,104 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19, 39.07, 38.51, 37.74, 37.21, 36.13, 35.84]
2024-09-12 10:08:29,104 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17, 70.92, 69.17, 67.95, 66.39, 65.09, 64.85]

Average Accuracy (CNN): 49.13
2024-09-12 10:08:29,104 [trainer.py] => Average Accuracy (CNN): 49.13 

2024-09-12 10:08:29,106 [trainer.py] => All params: 172158352
2024-09-12 10:08:29,108 [trainer.py] => Trainable params: 407240
2024-09-12 10:08:29,108 [dualprompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.875, Train_accy 21.89:   0%|          | 0/20 [00:03<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.875, Train_accy 21.89:   5%|▌         | 1/20 [00:03<01:04,  3.39s/it]
Task 19, Epoch 2/20 => Loss 1.147, Train_accy 62.13:   5%|▌         | 1/20 [00:06<01:04,  3.39s/it]
Task 19, Epoch 2/20 => Loss 1.147, Train_accy 62.13:  10%|█         | 2/20 [00:06<00:59,  3.32s/it]
Task 19, Epoch 3/20 => Loss 0.577, Train_accy 79.59:  10%|█         | 2/20 [00:10<00:59,  3.32s/it]
Task 19, Epoch 3/20 => Loss 0.577, Train_accy 79.59:  15%|█▌        | 3/20 [00:10<00:56,  3.33s/it]
Task 19, Epoch 4/20 => Loss 0.390, Train_accy 86.39:  15%|█▌        | 3/20 [00:13<00:56,  3.33s/it]
Task 19, Epoch 4/20 => Loss 0.390, Train_accy 86.39:  20%|██        | 4/20 [00:13<00:53,  3.32s/it]
Task 19, Epoch 5/20 => Loss 0.266, Train_accy 89.64, Test_accy 34.89:  20%|██        | 4/20 [00:25<00:53,  3.32s/it]
Task 19, Epoch 5/20 => Loss 0.266, Train_accy 89.64, Test_accy 34.89:  25%|██▌       | 5/20 [00:25<01:39,  6.61s/it]
Task 19, Epoch 6/20 => Loss 0.258, Train_accy 90.53:  25%|██▌       | 5/20 [00:29<01:39,  6.61s/it]                 
Task 19, Epoch 6/20 => Loss 0.258, Train_accy 90.53:  30%|███       | 6/20 [00:29<01:16,  5.49s/it]
Task 19, Epoch 7/20 => Loss 0.178, Train_accy 94.08:  30%|███       | 6/20 [00:32<01:16,  5.49s/it]
Task 19, Epoch 7/20 => Loss 0.178, Train_accy 94.08:  35%|███▌      | 7/20 [00:32<01:02,  4.79s/it]
Task 19, Epoch 8/20 => Loss 0.277, Train_accy 94.08:  35%|███▌      | 7/20 [00:35<01:02,  4.79s/it]
Task 19, Epoch 8/20 => Loss 0.277, Train_accy 94.08:  40%|████      | 8/20 [00:35<00:51,  4.29s/it]
Task 19, Epoch 9/20 => Loss 0.123, Train_accy 95.86:  40%|████      | 8/20 [00:38<00:51,  4.29s/it]
Task 19, Epoch 9/20 => Loss 0.123, Train_accy 95.86:  45%|████▌     | 9/20 [00:38<00:43,  3.99s/it]
Task 19, Epoch 10/20 => Loss 0.167, Train_accy 94.08, Test_accy 35.42:  45%|████▌     | 9/20 [00:51<00:43,  3.99s/it]
Task 19, Epoch 10/20 => Loss 0.167, Train_accy 94.08, Test_accy 35.42:  50%|█████     | 10/20 [00:51<01:06,  6.62s/it]
Task 19, Epoch 11/20 => Loss 0.498, Train_accy 95.56:  50%|█████     | 10/20 [00:54<01:06,  6.62s/it]                 
Task 19, Epoch 11/20 => Loss 0.498, Train_accy 95.56:  55%|█████▌    | 11/20 [00:54<00:50,  5.60s/it]
Task 19, Epoch 12/20 => Loss 0.125, Train_accy 94.97:  55%|█████▌    | 11/20 [00:58<00:50,  5.60s/it]
Task 19, Epoch 12/20 => Loss 0.125, Train_accy 94.97:  60%|██████    | 12/20 [00:58<00:39,  4.90s/it]
Task 19, Epoch 13/20 => Loss 0.079, Train_accy 97.04:  60%|██████    | 12/20 [01:01<00:39,  4.90s/it]
Task 19, Epoch 13/20 => Loss 0.079, Train_accy 97.04:  65%|██████▌   | 13/20 [01:01<00:30,  4.43s/it]
Task 19, Epoch 14/20 => Loss 0.071, Train_accy 97.34:  65%|██████▌   | 13/20 [01:04<00:30,  4.43s/it]
Task 19, Epoch 14/20 => Loss 0.071, Train_accy 97.34:  70%|███████   | 14/20 [01:04<00:24,  4.10s/it]
Task 19, Epoch 15/20 => Loss 0.089, Train_accy 97.63, Test_accy 34.96:  70%|███████   | 14/20 [01:16<00:24,  4.10s/it]
Task 19, Epoch 15/20 => Loss 0.089, Train_accy 97.63, Test_accy 34.96:  75%|███████▌  | 15/20 [01:16<00:32,  6.50s/it]
Task 19, Epoch 16/20 => Loss 0.092, Train_accy 97.04:  75%|███████▌  | 15/20 [01:19<00:32,  6.50s/it]                 
Task 19, Epoch 16/20 => Loss 0.092, Train_accy 97.04:  80%|████████  | 16/20 [01:19<00:21,  5.48s/it]
Task 19, Epoch 17/20 => Loss 0.079, Train_accy 96.45:  80%|████████  | 16/20 [01:22<00:21,  5.48s/it]
Task 19, Epoch 17/20 => Loss 0.079, Train_accy 96.45:  85%|████████▌ | 17/20 [01:22<00:14,  4.75s/it]
Task 19, Epoch 18/20 => Loss 0.054, Train_accy 98.22:  85%|████████▌ | 17/20 [01:26<00:14,  4.75s/it]
Task 19, Epoch 18/20 => Loss 0.054, Train_accy 98.22:  90%|█████████ | 18/20 [01:26<00:08,  4.25s/it]
Task 19, Epoch 19/20 => Loss 0.080, Train_accy 97.04:  90%|█████████ | 18/20 [01:29<00:08,  4.25s/it]
Task 19, Epoch 19/20 => Loss 0.080, Train_accy 97.04:  95%|█████████▌| 19/20 [01:29<00:03,  3.90s/it]
Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.04, Test_accy 35.15:  95%|█████████▌| 19/20 [01:40<00:03,  3.90s/it]
Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.04, Test_accy 35.15: 100%|██████████| 20/20 [01:40<00:00,  6.18s/it]
Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.04, Test_accy 35.15: 100%|██████████| 20/20 [01:40<00:00,  5.03s/it]
2024-09-12 10:10:09,755 [dualprompt.py] => Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.04, Test_accy 35.15
2024-09-12 10:10:18,504 [trainer.py] => No NME accuracy.
2024-09-12 10:10:18,505 [trainer.py] => CNN: {'total': 35.15, '00-09': 38.96, '10-19': 59.18, '20-29': 52.53, '30-39': 44.19, '40-49': 29.69, '50-59': 38.46, '60-69': 37.3, '70-79': 31.25, '80-89': 34.57, '90-99': 30.65, '100-109': 28.33, '110-119': 36.49, '120-129': 11.67, '130-139': 25.58, '140-149': 32.89, '150-159': 33.33, '160-169': 32.94, '170-179': 24.19, '180-189': 20.51, '190-199': 31.76, 'old': 35.36, 'new': 31.76}
2024-09-12 10:10:18,505 [trainer.py] => CNN top1 curve: [75.32, 73.71, 68.25, 63.61, 58.73, 53.99, 50.83, 48.71, 46.08, 43.88, 43.29, 42.46, 40.19, 39.07, 38.51, 37.74, 37.21, 36.13, 35.84, 35.15]
2024-09-12 10:10:18,505 [trainer.py] => CNN top5 curve: [93.51, 92.0, 90.88, 87.5, 86.32, 84.24, 82.39, 80.37, 78.95, 76.46, 76.14, 74.97, 72.17, 70.92, 69.17, 67.95, 66.39, 65.09, 64.85, 63.66]

Average Accuracy (CNN): 48.44
2024-09-12 10:10:18,505 [trainer.py] => Average Accuracy (CNN): 48.44 

Accuracy Matrix (CNN):
[[75.32 67.53 55.84 55.84 46.75 42.86 42.86 42.86 42.86 40.26 40.26 40.26
  38.96 38.96 38.96 37.66 38.96 38.96 38.96 38.96]
 [ 0.   78.57 75.51 72.45 71.43 70.41 67.35 67.35 67.35 65.31 67.35 67.35
  65.31 65.31 63.27 61.22 61.22 60.2  60.2  59.18]
 [ 0.    0.   70.71 65.66 60.61 57.58 59.6  54.55 52.53 52.53 54.55 51.52
  51.52 51.52 52.53 50.51 52.53 51.52 54.55 52.53]
 [ 0.    0.    0.   58.14 55.81 50.   47.67 47.67 47.67 44.19 43.02 45.35
  44.19 45.35 45.35 45.35 45.35 44.19 45.35 44.19]
 [ 0.    0.    0.    0.   54.69 50.   45.31 45.31 42.19 42.19 42.19 40.62
  40.62 42.19 40.62 37.5  32.81 31.25 29.69 29.69]
 [ 0.    0.    0.    0.    0.   44.23 42.31 40.38 40.38 42.31 40.38 36.54
  36.54 34.62 32.69 32.69 36.54 38.46 34.62 38.46]
 [ 0.    0.    0.    0.    0.    0.   44.44 43.65 41.27 42.06 41.27 40.48
  39.68 38.89 40.48 38.1  38.89 38.1  36.51 37.3 ]
 [ 0.    0.    0.    0.    0.    0.    0.   42.71 40.62 38.54 38.54 39.58
  37.5  38.54 36.46 36.46 34.38 33.33 31.25 31.25]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   34.57 32.1  33.33 34.57
  34.57 34.57 34.57 34.57 34.57 35.8  34.57 34.57]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   30.65 30.65 30.65
  29.03 27.42 29.03 30.65 32.26 30.65 32.26 30.65]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   31.67 30.
  31.67 30.   31.67 30.   30.   30.   31.67 28.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   37.84
  37.84 37.84 36.49 37.84 37.84 37.84 37.84 36.49]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  15.   16.67 15.   15.   13.33 11.67 13.33 11.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   25.58 24.42 26.74 24.42 24.42 25.58 25.58]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   35.53 35.53 32.89 32.89 32.89 32.89]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   33.33 33.33 31.37 31.37 33.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   32.94 32.94 34.12 32.94]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   24.19 24.19 24.19]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   23.08 20.51]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   31.76]]
2024-09-12 10:10:18,511 [trainer.py] => Forgetting (CNN): 8.280526315789473
2024-09-12 10:10:21,732 [trainer.py] => config: ./exps/dualprompt_ina_B100_Inc5.json
2024-09-12 10:10:21,738 [trainer.py] => prefix:  
2024-09-12 10:10:21,738 [trainer.py] => dataset: imageneta
2024-09-12 10:10:21,738 [trainer.py] => memory_size: 0
2024-09-12 10:10:21,738 [trainer.py] => memory_per_class: 0
2024-09-12 10:10:21,738 [trainer.py] => fixed_memory: False
2024-09-12 10:10:21,738 [trainer.py] => shuffle: True
2024-09-12 10:10:21,738 [trainer.py] => init_cls: 100
2024-09-12 10:10:21,738 [trainer.py] => increment: 20
2024-09-12 10:10:21,738 [trainer.py] => model_name: dualprompt
2024-09-12 10:10:21,738 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 10:10:21,738 [trainer.py] => get_original_backbone: True
2024-09-12 10:10:21,739 [trainer.py] => device: [device(type='cuda', index=5)]
2024-09-12 10:10:21,739 [trainer.py] => seed: 1993
2024-09-12 10:10:21,739 [trainer.py] => tuned_epoch: 20
2024-09-12 10:10:21,739 [trainer.py] => init_lr: 0.001
2024-09-12 10:10:21,739 [trainer.py] => batch_size: 48
2024-09-12 10:10:21,739 [trainer.py] => weight_decay: 0
2024-09-12 10:10:21,739 [trainer.py] => min_lr: 1e-05
2024-09-12 10:10:21,739 [trainer.py] => optimizer: adam
2024-09-12 10:10:21,739 [trainer.py] => scheduler: constant
2024-09-12 10:10:21,739 [trainer.py] => reinit_optimizer: True
2024-09-12 10:10:21,739 [trainer.py] => global_pool: token
2024-09-12 10:10:21,739 [trainer.py] => head_type: token
2024-09-12 10:10:21,739 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 10:10:21,739 [trainer.py] => pretrained: True
2024-09-12 10:10:21,739 [trainer.py] => drop: 0.0
2024-09-12 10:10:21,739 [trainer.py] => drop_path: 0.0
2024-09-12 10:10:21,739 [trainer.py] => use_g_prompt: True
2024-09-12 10:10:21,739 [trainer.py] => g_prompt_length: 5
2024-09-12 10:10:21,739 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 10:10:21,739 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 10:10:21,739 [trainer.py] => use_e_prompt: True
2024-09-12 10:10:21,739 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 10:10:21,739 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 10:10:21,739 [trainer.py] => prompt_pool: True
2024-09-12 10:10:21,739 [trainer.py] => size: 10
2024-09-12 10:10:21,739 [trainer.py] => length: 5
2024-09-12 10:10:21,739 [trainer.py] => top_k: 1
2024-09-12 10:10:21,739 [trainer.py] => initializer: uniform
2024-09-12 10:10:21,740 [trainer.py] => prompt_key: True
2024-09-12 10:10:21,740 [trainer.py] => prompt_key_init: uniform
2024-09-12 10:10:21,740 [trainer.py] => use_prompt_mask: True
2024-09-12 10:10:21,740 [trainer.py] => shared_prompt_pool: True
2024-09-12 10:10:21,740 [trainer.py] => shared_prompt_key: False
2024-09-12 10:10:21,740 [trainer.py] => batchwise_prompt: True
2024-09-12 10:10:21,740 [trainer.py] => embedding_key: cls
2024-09-12 10:10:21,740 [trainer.py] => predefined_key: 
2024-09-12 10:10:21,740 [trainer.py] => pull_constraint: True
2024-09-12 10:10:21,740 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 10:10:21,740 [trainer.py] => same_key_value: False
2024-09-12 10:10:21,770 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 10:10:25,051 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 10:10:25,052 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 10:10:25,052 [dualprompt.py] => g_prompt: 15360
2024-09-12 10:10:25,052 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 10:10:25,052 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 10:10:25,053 [dualprompt.py] => head.weight: 153600
2024-09-12 10:10:25,053 [dualprompt.py] => head.bias: 200
2024-09-12 10:10:25,053 [trainer.py] => All params: 172158352
2024-09-12 10:10:25,054 [trainer.py] => Trainable params: 407240
2024-09-12 10:10:25,054 [dualprompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.310, Train_accy 27.20:   0%|          | 0/20 [00:28<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.310, Train_accy 27.20:   5%|▌         | 1/20 [00:28<08:58, 28.35s/it]
Task 0, Epoch 2/20 => Loss 1.522, Train_accy 62.98:   5%|▌         | 1/20 [00:56<08:58, 28.35s/it]
Task 0, Epoch 2/20 => Loss 1.522, Train_accy 62.98:  10%|█         | 2/20 [00:56<08:29, 28.28s/it]
Task 0, Epoch 3/20 => Loss 1.029, Train_accy 74.65:  10%|█         | 2/20 [01:24<08:29, 28.28s/it]
Task 0, Epoch 3/20 => Loss 1.029, Train_accy 74.65:  15%|█▌        | 3/20 [01:24<07:59, 28.21s/it]
Task 0, Epoch 4/20 => Loss 0.781, Train_accy 79.82:  15%|█▌        | 3/20 [01:52<07:59, 28.21s/it]
Task 0, Epoch 4/20 => Loss 0.781, Train_accy 79.82:  20%|██        | 4/20 [01:52<07:31, 28.22s/it]
Task 0, Epoch 5/20 => Loss 0.669, Train_accy 82.89, Test_accy 60.76:  20%|██        | 4/20 [02:25<07:31, 28.22s/it]
Task 0, Epoch 5/20 => Loss 0.669, Train_accy 82.89, Test_accy 60.76:  25%|██▌       | 5/20 [02:25<07:29, 29.96s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 85.02:  25%|██▌       | 5/20 [02:52<07:29, 29.96s/it]                 
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 85.02:  30%|███       | 6/20 [02:52<06:41, 28.71s/it]
Task 0, Epoch 7/20 => Loss 0.506, Train_accy 87.02:  30%|███       | 6/20 [03:20<06:41, 28.71s/it]
Task 0, Epoch 7/20 => Loss 0.506, Train_accy 87.02:  35%|███▌      | 7/20 [03:20<06:11, 28.57s/it]
Task 0, Epoch 8/20 => Loss 0.449, Train_accy 87.05:  35%|███▌      | 7/20 [03:49<06:11, 28.57s/it]
Task 0, Epoch 8/20 => Loss 0.449, Train_accy 87.05:  40%|████      | 8/20 [03:49<05:42, 28.53s/it]
Task 0, Epoch 9/20 => Loss 0.394, Train_accy 89.21:  40%|████      | 8/20 [04:17<05:42, 28.53s/it]
Task 0, Epoch 9/20 => Loss 0.394, Train_accy 89.21:  45%|████▌     | 9/20 [04:17<05:13, 28.47s/it]
Task 0, Epoch 10/20 => Loss 0.401, Train_accy 88.69, Test_accy 57.55:  45%|████▌     | 9/20 [04:51<05:13, 28.47s/it]
Task 0, Epoch 10/20 => Loss 0.401, Train_accy 88.69, Test_accy 57.55:  50%|█████     | 10/20 [04:51<05:00, 30.08s/it]
Task 0, Epoch 11/20 => Loss 0.378, Train_accy 89.27:  50%|█████     | 10/20 [05:19<05:00, 30.08s/it]                 
Task 0, Epoch 11/20 => Loss 0.378, Train_accy 89.27:  55%|█████▌    | 11/20 [05:19<04:26, 29.56s/it]
Task 0, Epoch 12/20 => Loss 0.362, Train_accy 89.88:  55%|█████▌    | 11/20 [05:45<04:26, 29.56s/it]
Task 0, Epoch 12/20 => Loss 0.362, Train_accy 89.88:  60%|██████    | 12/20 [05:45<03:48, 28.61s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.54:  60%|██████    | 12/20 [06:13<03:48, 28.61s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.54:  65%|██████▌   | 13/20 [06:13<03:18, 28.32s/it]
Task 0, Epoch 14/20 => Loss 0.327, Train_accy 90.67:  65%|██████▌   | 13/20 [06:42<03:18, 28.32s/it]
Task 0, Epoch 14/20 => Loss 0.327, Train_accy 90.67:  70%|███████   | 14/20 [06:42<02:50, 28.39s/it]
Task 0, Epoch 15/20 => Loss 0.322, Train_accy 90.49, Test_accy 58.38:  70%|███████   | 14/20 [07:15<02:50, 28.39s/it]
Task 0, Epoch 15/20 => Loss 0.322, Train_accy 90.49, Test_accy 58.38:  75%|███████▌  | 15/20 [07:15<02:29, 29.99s/it]
Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.16:  75%|███████▌  | 15/20 [07:43<02:29, 29.99s/it]                 
Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.16:  80%|████████  | 16/20 [07:43<01:57, 29.44s/it]
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.16:  80%|████████  | 16/20 [08:12<01:57, 29.44s/it]
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.16:  85%|████████▌ | 17/20 [08:12<01:27, 29.09s/it]
Task 0, Epoch 18/20 => Loss 0.261, Train_accy 92.37:  85%|████████▌ | 17/20 [08:39<01:27, 29.09s/it]
Task 0, Epoch 18/20 => Loss 0.261, Train_accy 92.37:  90%|█████████ | 18/20 [08:39<00:56, 28.46s/it]
Task 0, Epoch 19/20 => Loss 0.250, Train_accy 92.52:  90%|█████████ | 18/20 [09:05<00:56, 28.46s/it]
Task 0, Epoch 19/20 => Loss 0.250, Train_accy 92.52:  95%|█████████▌| 19/20 [09:05<00:27, 27.96s/it]
Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48:  95%|█████████▌| 19/20 [09:39<00:27, 27.96s/it]
Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48: 100%|██████████| 20/20 [09:39<00:00, 29.63s/it]
Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48: 100%|██████████| 20/20 [09:39<00:00, 28.97s/it]
2024-09-12 10:20:05,037 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48
2024-09-12 10:20:10,473 [trainer.py] => No NME accuracy.
2024-09-12 10:20:10,473 [trainer.py] => CNN: {'total': 56.48, '00-99': 56.48, 'old': 0, 'new': 56.48}
2024-09-12 10:20:10,473 [trainer.py] => CNN top1 curve: [56.48]
2024-09-12 10:20:10,473 [trainer.py] => CNN top5 curve: [81.81]

Average Accuracy (CNN): 56.48
2024-09-12 10:20:10,473 [trainer.py] => Average Accuracy (CNN): 56.48 

2024-09-12 10:20:10,475 [trainer.py] => All params: 172158352
2024-09-12 10:20:10,477 [trainer.py] => Trainable params: 407240
2024-09-12 10:20:10,477 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.605, Train_accy 27.53:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.605, Train_accy 27.53:   5%|▌         | 1/20 [00:04<01:34,  4.98s/it]
Task 1, Epoch 2/20 => Loss 1.059, Train_accy 70.75:   5%|▌         | 1/20 [00:09<01:34,  4.98s/it]
Task 1, Epoch 2/20 => Loss 1.059, Train_accy 70.75:  10%|█         | 2/20 [00:09<01:28,  4.92s/it]
Task 1, Epoch 3/20 => Loss 0.556, Train_accy 83.94:  10%|█         | 2/20 [00:14<01:28,  4.92s/it]
Task 1, Epoch 3/20 => Loss 0.556, Train_accy 83.94:  15%|█▌        | 3/20 [00:14<01:23,  4.91s/it]
Task 1, Epoch 4/20 => Loss 0.439, Train_accy 88.15:  15%|█▌        | 3/20 [00:19<01:23,  4.91s/it]
Task 1, Epoch 4/20 => Loss 0.439, Train_accy 88.15:  20%|██        | 4/20 [00:19<01:18,  4.89s/it]
Task 1, Epoch 5/20 => Loss 0.240, Train_accy 94.46, Test_accy 50.67:  20%|██        | 4/20 [00:30<01:18,  4.89s/it]
Task 1, Epoch 5/20 => Loss 0.240, Train_accy 94.46, Test_accy 50.67:  25%|██▌       | 5/20 [00:30<01:45,  7.01s/it]
Task 1, Epoch 6/20 => Loss 0.225, Train_accy 94.07:  25%|██▌       | 5/20 [00:35<01:45,  7.01s/it]                 
Task 1, Epoch 6/20 => Loss 0.225, Train_accy 94.07:  30%|███       | 6/20 [00:35<01:27,  6.28s/it]
Task 1, Epoch 7/20 => Loss 0.211, Train_accy 94.07:  30%|███       | 6/20 [00:40<01:27,  6.28s/it]
Task 1, Epoch 7/20 => Loss 0.211, Train_accy 94.07:  35%|███▌      | 7/20 [00:40<01:15,  5.84s/it]
Task 1, Epoch 8/20 => Loss 0.177, Train_accy 95.41:  35%|███▌      | 7/20 [00:44<01:15,  5.84s/it]
Task 1, Epoch 8/20 => Loss 0.177, Train_accy 95.41:  40%|████      | 8/20 [00:44<01:06,  5.51s/it]
Task 1, Epoch 9/20 => Loss 0.228, Train_accy 92.73:  40%|████      | 8/20 [00:49<01:06,  5.51s/it]
Task 1, Epoch 9/20 => Loss 0.228, Train_accy 92.73:  45%|████▌     | 9/20 [00:49<00:58,  5.30s/it]
Task 1, Epoch 10/20 => Loss 0.144, Train_accy 96.75, Test_accy 51.38:  45%|████▌     | 9/20 [01:00<00:58,  5.30s/it]
Task 1, Epoch 10/20 => Loss 0.144, Train_accy 96.75, Test_accy 51.38:  50%|█████     | 10/20 [01:00<01:10,  7.07s/it]
Task 1, Epoch 11/20 => Loss 0.137, Train_accy 95.79:  50%|█████     | 10/20 [01:05<01:10,  7.07s/it]                 
Task 1, Epoch 11/20 => Loss 0.137, Train_accy 95.79:  55%|█████▌    | 11/20 [01:05<00:57,  6.40s/it]
Task 1, Epoch 12/20 => Loss 0.115, Train_accy 96.56:  55%|█████▌    | 11/20 [01:10<00:57,  6.40s/it]
Task 1, Epoch 12/20 => Loss 0.115, Train_accy 96.56:  60%|██████    | 12/20 [01:10<00:47,  5.94s/it]
Task 1, Epoch 13/20 => Loss 0.090, Train_accy 96.37:  60%|██████    | 12/20 [01:15<00:47,  5.94s/it]
Task 1, Epoch 13/20 => Loss 0.090, Train_accy 96.37:  65%|██████▌   | 13/20 [01:15<00:39,  5.66s/it]
Task 1, Epoch 14/20 => Loss 0.105, Train_accy 97.32:  65%|██████▌   | 13/20 [01:20<00:39,  5.66s/it]
Task 1, Epoch 14/20 => Loss 0.105, Train_accy 97.32:  70%|███████   | 14/20 [01:20<00:32,  5.42s/it]
Task 1, Epoch 15/20 => Loss 0.102, Train_accy 96.94, Test_accy 51.59:  70%|███████   | 14/20 [01:31<00:32,  5.42s/it]
Task 1, Epoch 15/20 => Loss 0.102, Train_accy 96.94, Test_accy 51.59:  75%|███████▌  | 15/20 [01:31<00:35,  7.13s/it]
Task 1, Epoch 16/20 => Loss 0.141, Train_accy 95.79:  75%|███████▌  | 15/20 [01:36<00:35,  7.13s/it]                 
Task 1, Epoch 16/20 => Loss 0.141, Train_accy 95.79:  80%|████████  | 16/20 [01:36<00:25,  6.45s/it]
Task 1, Epoch 17/20 => Loss 0.109, Train_accy 97.71:  80%|████████  | 16/20 [01:41<00:25,  6.45s/it]
Task 1, Epoch 17/20 => Loss 0.109, Train_accy 97.71:  85%|████████▌ | 17/20 [01:41<00:17,  5.95s/it]
Task 1, Epoch 18/20 => Loss 0.095, Train_accy 97.13:  85%|████████▌ | 17/20 [01:45<00:17,  5.95s/it]
Task 1, Epoch 18/20 => Loss 0.095, Train_accy 97.13:  90%|█████████ | 18/20 [01:45<00:11,  5.51s/it]
Task 1, Epoch 19/20 => Loss 0.111, Train_accy 96.94:  90%|█████████ | 18/20 [01:50<00:11,  5.51s/it]
Task 1, Epoch 19/20 => Loss 0.111, Train_accy 96.94:  95%|█████████▌| 19/20 [01:50<00:05,  5.20s/it]
Task 1, Epoch 20/20 => Loss 0.091, Train_accy 96.94, Test_accy 52.10:  95%|█████████▌| 19/20 [02:00<00:05,  5.20s/it]
Task 1, Epoch 20/20 => Loss 0.091, Train_accy 96.94, Test_accy 52.10: 100%|██████████| 20/20 [02:00<00:00,  6.74s/it]
Task 1, Epoch 20/20 => Loss 0.091, Train_accy 96.94, Test_accy 52.10: 100%|██████████| 20/20 [02:00<00:00,  6.03s/it]
2024-09-12 10:22:11,021 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.091, Train_accy 96.94, Test_accy 52.10
2024-09-12 10:22:16,589 [trainer.py] => No NME accuracy.
2024-09-12 10:22:16,589 [trainer.py] => CNN: {'total': 52.1, '00-99': 56.36, '100-119': 25.37, 'old': 56.36, 'new': 25.37}
2024-09-12 10:22:16,589 [trainer.py] => CNN top1 curve: [56.48, 52.1]
2024-09-12 10:22:16,589 [trainer.py] => CNN top5 curve: [81.81, 80.1]

Average Accuracy (CNN): 54.29
2024-09-12 10:22:16,589 [trainer.py] => Average Accuracy (CNN): 54.29 

2024-09-12 10:22:16,591 [trainer.py] => All params: 172158352
2024-09-12 10:22:16,592 [trainer.py] => Trainable params: 407240
2024-09-12 10:22:16,592 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.208, Train_accy 14.29:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.208, Train_accy 14.29:   5%|▌         | 1/20 [00:04<01:28,  4.67s/it]
Task 2, Epoch 2/20 => Loss 1.423, Train_accy 57.33:   5%|▌         | 1/20 [00:09<01:28,  4.67s/it]
Task 2, Epoch 2/20 => Loss 1.423, Train_accy 57.33:  10%|█         | 2/20 [00:09<01:26,  4.80s/it]
Task 2, Epoch 3/20 => Loss 0.821, Train_accy 77.18:  10%|█         | 2/20 [00:14<01:26,  4.80s/it]
Task 2, Epoch 3/20 => Loss 0.821, Train_accy 77.18:  15%|█▌        | 3/20 [00:14<01:24,  4.95s/it]
Task 2, Epoch 4/20 => Loss 0.510, Train_accy 86.09:  15%|█▌        | 3/20 [00:19<01:24,  4.95s/it]
Task 2, Epoch 4/20 => Loss 0.510, Train_accy 86.09:  20%|██        | 4/20 [00:19<01:19,  4.96s/it]
Task 2, Epoch 5/20 => Loss 0.392, Train_accy 89.42, Test_accy 46.30:  20%|██        | 4/20 [00:31<01:19,  4.96s/it]
Task 2, Epoch 5/20 => Loss 0.392, Train_accy 89.42, Test_accy 46.30:  25%|██▌       | 5/20 [00:31<01:52,  7.49s/it]
Task 2, Epoch 6/20 => Loss 0.365, Train_accy 90.72:  25%|██▌       | 5/20 [00:36<01:52,  7.49s/it]                 
Task 2, Epoch 6/20 => Loss 0.365, Train_accy 90.72:  30%|███       | 6/20 [00:36<01:33,  6.67s/it]
Task 2, Epoch 7/20 => Loss 0.259, Train_accy 93.51:  30%|███       | 6/20 [00:41<01:33,  6.67s/it]
Task 2, Epoch 7/20 => Loss 0.259, Train_accy 93.51:  35%|███▌      | 7/20 [00:41<01:19,  6.13s/it]
Task 2, Epoch 8/20 => Loss 0.294, Train_accy 91.65:  35%|███▌      | 7/20 [00:46<01:19,  6.13s/it]
Task 2, Epoch 8/20 => Loss 0.294, Train_accy 91.65:  40%|████      | 8/20 [00:46<01:09,  5.78s/it]
Task 2, Epoch 9/20 => Loss 0.176, Train_accy 95.92:  40%|████      | 8/20 [00:51<01:09,  5.78s/it]
Task 2, Epoch 9/20 => Loss 0.176, Train_accy 95.92:  45%|████▌     | 9/20 [00:51<01:00,  5.54s/it]
Task 2, Epoch 10/20 => Loss 0.191, Train_accy 95.18, Test_accy 47.01:  45%|████▌     | 9/20 [01:03<01:00,  5.54s/it]
Task 2, Epoch 10/20 => Loss 0.191, Train_accy 95.18, Test_accy 47.01:  50%|█████     | 10/20 [01:03<01:15,  7.51s/it]
Task 2, Epoch 11/20 => Loss 0.180, Train_accy 95.36:  50%|█████     | 10/20 [01:08<01:15,  7.51s/it]                 
Task 2, Epoch 11/20 => Loss 0.180, Train_accy 95.36:  55%|█████▌    | 11/20 [01:08<01:00,  6.77s/it]
Task 2, Epoch 12/20 => Loss 0.180, Train_accy 94.43:  55%|█████▌    | 11/20 [01:13<01:00,  6.77s/it]
Task 2, Epoch 12/20 => Loss 0.180, Train_accy 94.43:  60%|██████    | 12/20 [01:13<00:50,  6.27s/it]
Task 2, Epoch 13/20 => Loss 0.170, Train_accy 95.73:  60%|██████    | 12/20 [01:19<00:50,  6.27s/it]
Task 2, Epoch 13/20 => Loss 0.170, Train_accy 95.73:  65%|██████▌   | 13/20 [01:19<00:41,  5.98s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 96.66:  65%|██████▌   | 13/20 [01:24<00:41,  5.98s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 96.66:  70%|███████   | 14/20 [01:24<00:34,  5.69s/it]
Task 2, Epoch 15/20 => Loss 0.127, Train_accy 96.29, Test_accy 46.92:  70%|███████   | 14/20 [01:36<00:34,  5.69s/it]
Task 2, Epoch 15/20 => Loss 0.127, Train_accy 96.29, Test_accy 46.92:  75%|███████▌  | 15/20 [01:36<00:37,  7.56s/it]
Task 2, Epoch 16/20 => Loss 0.082, Train_accy 97.40:  75%|███████▌  | 15/20 [01:41<00:37,  7.56s/it]                 
Task 2, Epoch 16/20 => Loss 0.082, Train_accy 97.40:  80%|████████  | 16/20 [01:41<00:27,  6.83s/it]
Task 2, Epoch 17/20 => Loss 0.128, Train_accy 95.92:  80%|████████  | 16/20 [01:46<00:27,  6.83s/it]
Task 2, Epoch 17/20 => Loss 0.128, Train_accy 95.92:  85%|████████▌ | 17/20 [01:46<00:18,  6.30s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 96.10:  85%|████████▌ | 17/20 [01:51<00:18,  6.30s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 96.10:  90%|█████████ | 18/20 [01:51<00:11,  5.94s/it]
Task 2, Epoch 19/20 => Loss 0.070, Train_accy 98.33:  90%|█████████ | 18/20 [01:56<00:11,  5.94s/it]
Task 2, Epoch 19/20 => Loss 0.070, Train_accy 98.33:  95%|█████████▌| 19/20 [01:56<00:05,  5.68s/it]
Task 2, Epoch 20/20 => Loss 0.098, Train_accy 97.77, Test_accy 47.46:  95%|█████████▌| 19/20 [02:08<00:05,  5.68s/it]
Task 2, Epoch 20/20 => Loss 0.098, Train_accy 97.77, Test_accy 47.46: 100%|██████████| 20/20 [02:08<00:00,  7.56s/it]
Task 2, Epoch 20/20 => Loss 0.098, Train_accy 97.77, Test_accy 47.46: 100%|██████████| 20/20 [02:08<00:00,  6.42s/it]
2024-09-12 10:24:25,058 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.098, Train_accy 97.77, Test_accy 47.46
2024-09-12 10:24:31,878 [trainer.py] => No NME accuracy.
2024-09-12 10:24:31,878 [trainer.py] => CNN: {'total': 47.46, '00-99': 56.36, '100-119': 24.63, '120-139': 17.12, 'old': 52.0, 'new': 17.12}
2024-09-12 10:24:31,878 [trainer.py] => CNN top1 curve: [56.48, 52.1, 47.46]
2024-09-12 10:24:31,878 [trainer.py] => CNN top5 curve: [81.81, 80.1, 76.45]

Average Accuracy (CNN): 52.01
2024-09-12 10:24:31,879 [trainer.py] => Average Accuracy (CNN): 52.01 

2024-09-12 10:24:31,881 [trainer.py] => All params: 172158352
2024-09-12 10:24:31,884 [trainer.py] => Trainable params: 407240
2024-09-12 10:24:31,884 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.981, Train_accy 16.95:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.981, Train_accy 16.95:   5%|▌         | 1/20 [00:04<01:33,  4.91s/it]
Task 3, Epoch 2/20 => Loss 1.226, Train_accy 62.90:   5%|▌         | 1/20 [00:09<01:33,  4.91s/it]
Task 3, Epoch 2/20 => Loss 1.226, Train_accy 62.90:  10%|█         | 2/20 [00:09<01:28,  4.94s/it]
Task 3, Epoch 3/20 => Loss 0.731, Train_accy 76.84:  10%|█         | 2/20 [00:14<01:28,  4.94s/it]
Task 3, Epoch 3/20 => Loss 0.731, Train_accy 76.84:  15%|█▌        | 3/20 [00:14<01:24,  4.99s/it]
Task 3, Epoch 4/20 => Loss 0.369, Train_accy 89.27:  15%|█▌        | 3/20 [00:19<01:24,  4.99s/it]
Task 3, Epoch 4/20 => Loss 0.369, Train_accy 89.27:  20%|██        | 4/20 [00:19<01:19,  4.98s/it]
Task 3, Epoch 5/20 => Loss 0.352, Train_accy 89.08, Test_accy 44.07:  20%|██        | 4/20 [00:31<01:19,  4.98s/it]
Task 3, Epoch 5/20 => Loss 0.352, Train_accy 89.08, Test_accy 44.07:  25%|██▌       | 5/20 [00:31<01:50,  7.39s/it]
Task 3, Epoch 6/20 => Loss 0.296, Train_accy 91.71:  25%|██▌       | 5/20 [00:36<01:50,  7.39s/it]                 
Task 3, Epoch 6/20 => Loss 0.296, Train_accy 91.71:  30%|███       | 6/20 [00:36<01:30,  6.47s/it]
Task 3, Epoch 7/20 => Loss 0.240, Train_accy 93.60:  30%|███       | 6/20 [00:40<01:30,  6.47s/it]
Task 3, Epoch 7/20 => Loss 0.240, Train_accy 93.60:  35%|███▌      | 7/20 [00:40<01:16,  5.87s/it]
Task 3, Epoch 8/20 => Loss 0.248, Train_accy 93.03:  35%|███▌      | 7/20 [00:45<01:16,  5.87s/it]
Task 3, Epoch 8/20 => Loss 0.248, Train_accy 93.03:  40%|████      | 8/20 [00:45<01:05,  5.46s/it]
Task 3, Epoch 9/20 => Loss 0.224, Train_accy 93.41:  40%|████      | 8/20 [00:50<01:05,  5.46s/it]
Task 3, Epoch 9/20 => Loss 0.224, Train_accy 93.41:  45%|████▌     | 9/20 [00:50<00:57,  5.23s/it]
Task 3, Epoch 10/20 => Loss 0.142, Train_accy 96.42, Test_accy 44.55:  45%|████▌     | 9/20 [01:02<00:57,  5.23s/it]
Task 3, Epoch 10/20 => Loss 0.142, Train_accy 96.42, Test_accy 44.55:  50%|█████     | 10/20 [01:02<01:14,  7.43s/it]
Task 3, Epoch 11/20 => Loss 0.175, Train_accy 94.73:  50%|█████     | 10/20 [01:07<01:14,  7.43s/it]                 
Task 3, Epoch 11/20 => Loss 0.175, Train_accy 94.73:  55%|█████▌    | 11/20 [01:07<01:00,  6.68s/it]
Task 3, Epoch 12/20 => Loss 0.155, Train_accy 95.48:  55%|█████▌    | 11/20 [01:12<01:00,  6.68s/it]
Task 3, Epoch 12/20 => Loss 0.155, Train_accy 95.48:  60%|██████    | 12/20 [01:12<00:49,  6.16s/it]
Task 3, Epoch 13/20 => Loss 0.124, Train_accy 96.42:  60%|██████    | 12/20 [01:17<00:49,  6.16s/it]
Task 3, Epoch 13/20 => Loss 0.124, Train_accy 96.42:  65%|██████▌   | 13/20 [01:17<00:40,  5.79s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 94.35:  65%|██████▌   | 13/20 [01:22<00:40,  5.79s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 94.35:  70%|███████   | 14/20 [01:22<00:33,  5.54s/it]
Task 3, Epoch 15/20 => Loss 0.088, Train_accy 96.80, Test_accy 44.71:  70%|███████   | 14/20 [01:35<00:33,  5.54s/it]
Task 3, Epoch 15/20 => Loss 0.088, Train_accy 96.80, Test_accy 44.71:  75%|███████▌  | 15/20 [01:35<00:38,  7.67s/it]
Task 3, Epoch 16/20 => Loss 0.102, Train_accy 96.99:  75%|███████▌  | 15/20 [01:40<00:38,  7.67s/it]                 
Task 3, Epoch 16/20 => Loss 0.102, Train_accy 96.99:  80%|████████  | 16/20 [01:40<00:27,  6.88s/it]
Task 3, Epoch 17/20 => Loss 0.079, Train_accy 97.36:  80%|████████  | 16/20 [01:44<00:27,  6.88s/it]
Task 3, Epoch 17/20 => Loss 0.079, Train_accy 97.36:  85%|████████▌ | 17/20 [01:44<00:18,  6.30s/it]
Task 3, Epoch 18/20 => Loss 0.088, Train_accy 97.36:  85%|████████▌ | 17/20 [01:49<00:18,  6.30s/it]
Task 3, Epoch 18/20 => Loss 0.088, Train_accy 97.36:  90%|█████████ | 18/20 [01:49<00:11,  5.90s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 97.36:  90%|█████████ | 18/20 [01:54<00:11,  5.90s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 97.36:  95%|█████████▌| 19/20 [01:54<00:05,  5.62s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 95.48, Test_accy 44.87:  95%|█████████▌| 19/20 [02:07<00:05,  5.62s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 95.48, Test_accy 44.87: 100%|██████████| 20/20 [02:07<00:00,  7.71s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 95.48, Test_accy 44.87: 100%|██████████| 20/20 [02:07<00:00,  6.38s/it]
2024-09-12 10:26:39,411 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.172, Train_accy 95.48, Test_accy 44.87
2024-09-12 10:26:47,119 [trainer.py] => No NME accuracy.
2024-09-12 10:26:47,119 [trainer.py] => CNN: {'total': 44.87, '00-99': 56.48, '100-119': 24.63, '120-139': 16.44, '140-159': 22.05, 'old': 47.46, 'new': 22.05}
2024-09-12 10:26:47,119 [trainer.py] => CNN top1 curve: [56.48, 52.1, 47.46, 44.87]
2024-09-12 10:26:47,119 [trainer.py] => CNN top5 curve: [81.81, 80.1, 76.45, 73.24]

Average Accuracy (CNN): 50.23
2024-09-12 10:26:47,119 [trainer.py] => Average Accuracy (CNN): 50.23 

2024-09-12 10:26:47,122 [trainer.py] => All params: 172158352
2024-09-12 10:26:47,124 [trainer.py] => Trainable params: 407240
2024-09-12 10:26:47,124 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.091, Train_accy 17.86:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.091, Train_accy 17.86:   5%|▌         | 1/20 [00:05<01:41,  5.32s/it]
Task 4, Epoch 2/20 => Loss 1.388, Train_accy 57.09:   5%|▌         | 1/20 [00:10<01:41,  5.32s/it]
Task 4, Epoch 2/20 => Loss 1.388, Train_accy 57.09:  10%|█         | 2/20 [00:10<01:36,  5.38s/it]
Task 4, Epoch 3/20 => Loss 0.770, Train_accy 77.76:  10%|█         | 2/20 [00:16<01:36,  5.38s/it]
Task 4, Epoch 3/20 => Loss 0.770, Train_accy 77.76:  15%|█▌        | 3/20 [00:16<01:31,  5.39s/it]
Task 4, Epoch 4/20 => Loss 0.517, Train_accy 85.29:  15%|█▌        | 3/20 [00:21<01:31,  5.39s/it]
Task 4, Epoch 4/20 => Loss 0.517, Train_accy 85.29:  20%|██        | 4/20 [00:21<01:25,  5.36s/it]
Task 4, Epoch 5/20 => Loss 0.423, Train_accy 87.22, Test_accy 40.65:  20%|██        | 4/20 [00:35<01:25,  5.36s/it]
Task 4, Epoch 5/20 => Loss 0.423, Train_accy 87.22, Test_accy 40.65:  25%|██▌       | 5/20 [00:35<02:06,  8.40s/it]
Task 4, Epoch 6/20 => Loss 0.383, Train_accy 88.97:  25%|██▌       | 5/20 [00:40<02:06,  8.40s/it]                 
Task 4, Epoch 6/20 => Loss 0.383, Train_accy 88.97:  30%|███       | 6/20 [00:40<01:42,  7.34s/it]
Task 4, Epoch 7/20 => Loss 0.333, Train_accy 90.54:  30%|███       | 6/20 [00:45<01:42,  7.34s/it]
Task 4, Epoch 7/20 => Loss 0.333, Train_accy 90.54:  35%|███▌      | 7/20 [00:45<01:26,  6.66s/it]
Task 4, Epoch 8/20 => Loss 0.269, Train_accy 92.29:  35%|███▌      | 7/20 [00:51<01:26,  6.66s/it]
Task 4, Epoch 8/20 => Loss 0.269, Train_accy 92.29:  40%|████      | 8/20 [00:51<01:14,  6.20s/it]
Task 4, Epoch 9/20 => Loss 0.202, Train_accy 94.05:  40%|████      | 8/20 [00:56<01:14,  6.20s/it]
Task 4, Epoch 9/20 => Loss 0.202, Train_accy 94.05:  45%|████▌     | 9/20 [00:56<01:05,  5.92s/it]
Task 4, Epoch 10/20 => Loss 0.254, Train_accy 92.47, Test_accy 40.79:  45%|████▌     | 9/20 [01:09<01:05,  5.92s/it]
Task 4, Epoch 10/20 => Loss 0.254, Train_accy 92.47, Test_accy 40.79:  50%|█████     | 10/20 [01:09<01:22,  8.27s/it]
Task 4, Epoch 11/20 => Loss 0.192, Train_accy 95.27:  50%|█████     | 10/20 [01:14<01:22,  8.27s/it]                 
Task 4, Epoch 11/20 => Loss 0.192, Train_accy 95.27:  55%|█████▌    | 11/20 [01:14<01:05,  7.27s/it]
Task 4, Epoch 12/20 => Loss 0.177, Train_accy 94.92:  55%|█████▌    | 11/20 [01:19<01:05,  7.27s/it]
Task 4, Epoch 12/20 => Loss 0.177, Train_accy 94.92:  60%|██████    | 12/20 [01:19<00:52,  6.55s/it]
Task 4, Epoch 13/20 => Loss 0.145, Train_accy 96.67:  60%|██████    | 12/20 [01:24<00:52,  6.55s/it]
Task 4, Epoch 13/20 => Loss 0.145, Train_accy 96.67:  65%|██████▌   | 13/20 [01:24<00:42,  6.07s/it]
Task 4, Epoch 14/20 => Loss 0.179, Train_accy 94.92:  65%|██████▌   | 13/20 [01:29<00:42,  6.07s/it]
Task 4, Epoch 14/20 => Loss 0.179, Train_accy 94.92:  70%|███████   | 14/20 [01:29<00:34,  5.73s/it]
Task 4, Epoch 15/20 => Loss 0.168, Train_accy 94.57, Test_accy 40.93:  70%|███████   | 14/20 [01:42<00:34,  5.73s/it]
Task 4, Epoch 15/20 => Loss 0.168, Train_accy 94.57, Test_accy 40.93:  75%|███████▌  | 15/20 [01:42<00:39,  8.00s/it]
Task 4, Epoch 16/20 => Loss 0.152, Train_accy 95.80:  75%|███████▌  | 15/20 [01:48<00:39,  8.00s/it]                 
Task 4, Epoch 16/20 => Loss 0.152, Train_accy 95.80:  80%|████████  | 16/20 [01:48<00:28,  7.20s/it]
Task 4, Epoch 17/20 => Loss 0.162, Train_accy 94.92:  80%|████████  | 16/20 [01:53<00:28,  7.20s/it]
Task 4, Epoch 17/20 => Loss 0.162, Train_accy 94.92:  85%|████████▌ | 17/20 [01:53<00:19,  6.62s/it]
Task 4, Epoch 18/20 => Loss 0.150, Train_accy 95.97:  85%|████████▌ | 17/20 [01:58<00:19,  6.62s/it]
Task 4, Epoch 18/20 => Loss 0.150, Train_accy 95.97:  90%|█████████ | 18/20 [01:58<00:12,  6.24s/it]
Task 4, Epoch 19/20 => Loss 0.147, Train_accy 95.62:  90%|█████████ | 18/20 [02:04<00:12,  6.24s/it]
Task 4, Epoch 19/20 => Loss 0.147, Train_accy 95.62:  95%|█████████▌| 19/20 [02:04<00:06,  6.02s/it]
Task 4, Epoch 20/20 => Loss 0.126, Train_accy 96.50, Test_accy 41.00:  95%|█████████▌| 19/20 [02:18<00:06,  6.02s/it]
Task 4, Epoch 20/20 => Loss 0.126, Train_accy 96.50, Test_accy 41.00: 100%|██████████| 20/20 [02:18<00:00,  8.33s/it]
Task 4, Epoch 20/20 => Loss 0.126, Train_accy 96.50, Test_accy 41.00: 100%|██████████| 20/20 [02:18<00:00,  6.91s/it]
2024-09-12 10:29:05,265 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.126, Train_accy 96.50, Test_accy 41.00
2024-09-12 10:29:13,690 [trainer.py] => No NME accuracy.
2024-09-12 10:29:13,691 [trainer.py] => CNN: {'total': 41.0, '00-99': 56.24, '100-119': 23.88, '120-139': 15.75, '140-159': 20.47, '160-179': 12.24, 'old': 44.39, 'new': 12.24}
2024-09-12 10:29:13,691 [trainer.py] => CNN top1 curve: [56.48, 52.1, 47.46, 44.87, 41.0]
2024-09-12 10:29:13,692 [trainer.py] => CNN top5 curve: [81.81, 80.1, 76.45, 73.24, 69.61]

Average Accuracy (CNN): 48.38
2024-09-12 10:29:13,692 [trainer.py] => Average Accuracy (CNN): 48.38 

2024-09-12 10:29:13,697 [trainer.py] => All params: 172158352
2024-09-12 10:29:13,700 [trainer.py] => Trainable params: 407240
2024-09-12 10:29:13,700 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.099, Train_accy 21.25:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.099, Train_accy 21.25:   5%|▌         | 1/20 [00:04<01:33,  4.95s/it]
Task 5, Epoch 2/20 => Loss 1.227, Train_accy 63.19:   5%|▌         | 1/20 [00:09<01:33,  4.95s/it]
Task 5, Epoch 2/20 => Loss 1.227, Train_accy 63.19:  10%|█         | 2/20 [00:09<01:28,  4.91s/it]
Task 5, Epoch 3/20 => Loss 0.653, Train_accy 81.78:  10%|█         | 2/20 [00:14<01:28,  4.91s/it]
Task 5, Epoch 3/20 => Loss 0.653, Train_accy 81.78:  15%|█▌        | 3/20 [00:14<01:23,  4.90s/it]
Task 5, Epoch 4/20 => Loss 0.428, Train_accy 88.43:  15%|█▌        | 3/20 [00:19<01:23,  4.90s/it]
Task 5, Epoch 4/20 => Loss 0.428, Train_accy 88.43:  20%|██        | 4/20 [00:19<01:18,  4.90s/it]
Task 5, Epoch 5/20 => Loss 0.298, Train_accy 92.03, Test_accy 38.18:  20%|██        | 4/20 [00:33<01:18,  4.90s/it]
Task 5, Epoch 5/20 => Loss 0.298, Train_accy 92.03, Test_accy 38.18:  25%|██▌       | 5/20 [00:33<02:03,  8.26s/it]
Task 5, Epoch 6/20 => Loss 0.253, Train_accy 93.36:  25%|██▌       | 5/20 [00:38<02:03,  8.26s/it]                 
Task 5, Epoch 6/20 => Loss 0.253, Train_accy 93.36:  30%|███       | 6/20 [00:38<01:39,  7.13s/it]
Task 5, Epoch 7/20 => Loss 0.191, Train_accy 94.12:  30%|███       | 6/20 [00:43<01:39,  7.13s/it]
Task 5, Epoch 7/20 => Loss 0.191, Train_accy 94.12:  35%|███▌      | 7/20 [00:43<01:23,  6.41s/it]
Task 5, Epoch 8/20 => Loss 0.195, Train_accy 95.07:  35%|███▌      | 7/20 [00:48<01:23,  6.41s/it]
Task 5, Epoch 8/20 => Loss 0.195, Train_accy 95.07:  40%|████      | 8/20 [00:48<01:11,  5.93s/it]
Task 5, Epoch 9/20 => Loss 0.157, Train_accy 96.39:  40%|████      | 8/20 [00:53<01:11,  5.93s/it]
Task 5, Epoch 9/20 => Loss 0.157, Train_accy 96.39:  45%|████▌     | 9/20 [00:53<01:01,  5.63s/it]
Task 5, Epoch 10/20 => Loss 0.158, Train_accy 96.58, Test_accy 39.17:  45%|████▌     | 9/20 [01:07<01:01,  5.63s/it]
Task 5, Epoch 10/20 => Loss 0.158, Train_accy 96.58, Test_accy 39.17:  50%|█████     | 10/20 [01:07<01:22,  8.28s/it]
Task 5, Epoch 11/20 => Loss 0.157, Train_accy 95.07:  50%|█████     | 10/20 [01:12<01:22,  8.28s/it]                 
Task 5, Epoch 11/20 => Loss 0.157, Train_accy 95.07:  55%|█████▌    | 11/20 [01:12<01:05,  7.26s/it]
Task 5, Epoch 12/20 => Loss 0.175, Train_accy 95.07:  55%|█████▌    | 11/20 [01:17<01:05,  7.26s/it]
Task 5, Epoch 12/20 => Loss 0.175, Train_accy 95.07:  60%|██████    | 12/20 [01:17<00:52,  6.54s/it]
Task 5, Epoch 13/20 => Loss 0.136, Train_accy 95.45:  60%|██████    | 12/20 [01:22<00:52,  6.54s/it]
Task 5, Epoch 13/20 => Loss 0.136, Train_accy 95.45:  65%|██████▌   | 13/20 [01:22<00:42,  6.05s/it]
Task 5, Epoch 14/20 => Loss 0.115, Train_accy 97.34:  65%|██████▌   | 13/20 [01:27<00:42,  6.05s/it]
Task 5, Epoch 14/20 => Loss 0.115, Train_accy 97.34:  70%|███████   | 14/20 [01:27<00:34,  5.71s/it]
Task 5, Epoch 15/20 => Loss 0.122, Train_accy 96.39, Test_accy 39.43:  70%|███████   | 14/20 [01:41<00:34,  5.71s/it]
Task 5, Epoch 15/20 => Loss 0.122, Train_accy 96.39, Test_accy 39.43:  75%|███████▌  | 15/20 [01:41<00:41,  8.23s/it]
Task 5, Epoch 16/20 => Loss 0.100, Train_accy 96.96:  75%|███████▌  | 15/20 [01:46<00:41,  8.23s/it]                 
Task 5, Epoch 16/20 => Loss 0.100, Train_accy 96.96:  80%|████████  | 16/20 [01:46<00:28,  7.12s/it]
Task 5, Epoch 17/20 => Loss 0.106, Train_accy 96.96:  80%|████████  | 16/20 [01:50<00:28,  7.12s/it]
Task 5, Epoch 17/20 => Loss 0.106, Train_accy 96.96:  85%|████████▌ | 17/20 [01:50<00:19,  6.36s/it]
Task 5, Epoch 18/20 => Loss 0.089, Train_accy 97.53:  85%|████████▌ | 17/20 [01:55<00:19,  6.36s/it]
Task 5, Epoch 18/20 => Loss 0.089, Train_accy 97.53:  90%|█████████ | 18/20 [01:55<00:11,  5.83s/it]
Task 5, Epoch 19/20 => Loss 0.122, Train_accy 95.83:  90%|█████████ | 18/20 [01:59<00:11,  5.83s/it]
Task 5, Epoch 19/20 => Loss 0.122, Train_accy 95.83:  95%|█████████▌| 19/20 [01:59<00:05,  5.45s/it]
Task 5, Epoch 20/20 => Loss 0.097, Train_accy 97.72, Test_accy 39.30:  95%|█████████▌| 19/20 [02:13<00:05,  5.45s/it]
Task 5, Epoch 20/20 => Loss 0.097, Train_accy 97.72, Test_accy 39.30: 100%|██████████| 20/20 [02:13<00:00,  7.79s/it]
Task 5, Epoch 20/20 => Loss 0.097, Train_accy 97.72, Test_accy 39.30: 100%|██████████| 20/20 [02:13<00:00,  6.65s/it]
2024-09-12 10:31:26,803 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.097, Train_accy 97.72, Test_accy 39.30
2024-09-12 10:31:36,073 [trainer.py] => No NME accuracy.
2024-09-12 10:31:36,073 [trainer.py] => CNN: {'total': 39.3, '00-99': 56.6, '100-119': 23.88, '120-139': 15.07, '140-159': 20.47, '160-179': 12.24, '180-199': 18.55, 'old': 41.15, 'new': 18.55}
2024-09-12 10:31:36,073 [trainer.py] => CNN top1 curve: [56.48, 52.1, 47.46, 44.87, 41.0, 39.3]
2024-09-12 10:31:36,073 [trainer.py] => CNN top5 curve: [81.81, 80.1, 76.45, 73.24, 69.61, 68.01]

Average Accuracy (CNN): 46.87
2024-09-12 10:31:36,074 [trainer.py] => Average Accuracy (CNN): 46.87 

Accuracy Matrix (CNN):
[[56.48 56.36 56.36 56.48 56.24 56.6 ]
 [ 0.   25.37 24.63 24.63 23.88 23.88]
 [ 0.    0.   17.12 16.44 15.75 15.07]
 [ 0.    0.    0.   22.05 20.47 20.47]
 [ 0.    0.    0.    0.   12.24 12.24]
 [ 0.    0.    0.    0.    0.   18.55]]
2024-09-12 10:31:36,075 [trainer.py] => Forgetting (CNN): 1.024000000000001
2024-09-12 10:31:39,230 [trainer.py] => config: ./exps/dualprompt_ina_B100_Inc10.json
2024-09-12 10:31:39,230 [trainer.py] => prefix:  
2024-09-12 10:31:39,230 [trainer.py] => dataset: imageneta
2024-09-12 10:31:39,230 [trainer.py] => memory_size: 0
2024-09-12 10:31:39,230 [trainer.py] => memory_per_class: 0
2024-09-12 10:31:39,230 [trainer.py] => fixed_memory: False
2024-09-12 10:31:39,230 [trainer.py] => shuffle: True
2024-09-12 10:31:39,231 [trainer.py] => init_cls: 100
2024-09-12 10:31:39,231 [trainer.py] => increment: 10
2024-09-12 10:31:39,231 [trainer.py] => model_name: dualprompt
2024-09-12 10:31:39,231 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 10:31:39,231 [trainer.py] => get_original_backbone: True
2024-09-12 10:31:39,231 [trainer.py] => device: [device(type='cuda', index=5)]
2024-09-12 10:31:39,231 [trainer.py] => seed: 1993
2024-09-12 10:31:39,231 [trainer.py] => tuned_epoch: 20
2024-09-12 10:31:39,231 [trainer.py] => init_lr: 0.001
2024-09-12 10:31:39,231 [trainer.py] => batch_size: 48
2024-09-12 10:31:39,231 [trainer.py] => weight_decay: 0
2024-09-12 10:31:39,231 [trainer.py] => min_lr: 1e-05
2024-09-12 10:31:39,231 [trainer.py] => optimizer: adam
2024-09-12 10:31:39,231 [trainer.py] => scheduler: constant
2024-09-12 10:31:39,231 [trainer.py] => reinit_optimizer: True
2024-09-12 10:31:39,231 [trainer.py] => global_pool: token
2024-09-12 10:31:39,231 [trainer.py] => head_type: token
2024-09-12 10:31:39,231 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 10:31:39,231 [trainer.py] => pretrained: True
2024-09-12 10:31:39,231 [trainer.py] => drop: 0.0
2024-09-12 10:31:39,231 [trainer.py] => drop_path: 0.0
2024-09-12 10:31:39,231 [trainer.py] => use_g_prompt: True
2024-09-12 10:31:39,231 [trainer.py] => g_prompt_length: 5
2024-09-12 10:31:39,231 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 10:31:39,231 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 10:31:39,231 [trainer.py] => use_e_prompt: True
2024-09-12 10:31:39,231 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 10:31:39,231 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 10:31:39,231 [trainer.py] => prompt_pool: True
2024-09-12 10:31:39,231 [trainer.py] => size: 10
2024-09-12 10:31:39,231 [trainer.py] => length: 5
2024-09-12 10:31:39,231 [trainer.py] => top_k: 1
2024-09-12 10:31:39,231 [trainer.py] => initializer: uniform
2024-09-12 10:31:39,231 [trainer.py] => prompt_key: True
2024-09-12 10:31:39,232 [trainer.py] => prompt_key_init: uniform
2024-09-12 10:31:39,232 [trainer.py] => use_prompt_mask: True
2024-09-12 10:31:39,232 [trainer.py] => shared_prompt_pool: True
2024-09-12 10:31:39,232 [trainer.py] => shared_prompt_key: False
2024-09-12 10:31:39,232 [trainer.py] => batchwise_prompt: True
2024-09-12 10:31:39,232 [trainer.py] => embedding_key: cls
2024-09-12 10:31:39,232 [trainer.py] => predefined_key: 
2024-09-12 10:31:39,232 [trainer.py] => pull_constraint: True
2024-09-12 10:31:39,232 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 10:31:39,232 [trainer.py] => same_key_value: False
2024-09-12 10:31:39,259 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 10:31:42,778 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 10:31:42,778 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 10:31:42,778 [dualprompt.py] => g_prompt: 15360
2024-09-12 10:31:42,778 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 10:31:42,778 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 10:31:42,779 [dualprompt.py] => head.weight: 153600
2024-09-12 10:31:42,779 [dualprompt.py] => head.bias: 200
2024-09-12 10:31:42,780 [trainer.py] => All params: 172158352
2024-09-12 10:31:42,781 [trainer.py] => Trainable params: 407240
2024-09-12 10:31:42,781 [dualprompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.310, Train_accy 27.20:   0%|          | 0/20 [00:28<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.310, Train_accy 27.20:   5%|▌         | 1/20 [00:28<08:58, 28.32s/it]
Task 0, Epoch 2/20 => Loss 1.522, Train_accy 62.98:   5%|▌         | 1/20 [00:56<08:58, 28.32s/it]
Task 0, Epoch 2/20 => Loss 1.522, Train_accy 62.98:  10%|█         | 2/20 [00:56<08:31, 28.42s/it]
Task 0, Epoch 3/20 => Loss 1.029, Train_accy 74.65:  10%|█         | 2/20 [01:25<08:31, 28.42s/it]
Task 0, Epoch 3/20 => Loss 1.029, Train_accy 74.65:  15%|█▌        | 3/20 [01:25<08:05, 28.53s/it]
Task 0, Epoch 4/20 => Loss 0.781, Train_accy 79.82:  15%|█▌        | 3/20 [01:54<08:05, 28.53s/it]
Task 0, Epoch 4/20 => Loss 0.781, Train_accy 79.82:  20%|██        | 4/20 [01:54<07:36, 28.55s/it]
Task 0, Epoch 5/20 => Loss 0.669, Train_accy 82.89, Test_accy 60.76:  20%|██        | 4/20 [02:26<07:36, 28.55s/it]
Task 0, Epoch 5/20 => Loss 0.669, Train_accy 82.89, Test_accy 60.76:  25%|██▌       | 5/20 [02:26<07:30, 30.01s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 85.02:  25%|██▌       | 5/20 [02:53<07:30, 30.01s/it]                 
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 85.02:  30%|███       | 6/20 [02:53<06:45, 28.96s/it]
Task 0, Epoch 7/20 => Loss 0.506, Train_accy 87.02:  30%|███       | 6/20 [03:22<06:45, 28.96s/it]
Task 0, Epoch 7/20 => Loss 0.506, Train_accy 87.02:  35%|███▌      | 7/20 [03:22<06:14, 28.82s/it]
Task 0, Epoch 8/20 => Loss 0.449, Train_accy 87.05:  35%|███▌      | 7/20 [03:50<06:14, 28.82s/it]
Task 0, Epoch 8/20 => Loss 0.449, Train_accy 87.05:  40%|████      | 8/20 [03:50<05:45, 28.77s/it]
Task 0, Epoch 9/20 => Loss 0.394, Train_accy 89.21:  40%|████      | 8/20 [04:19<05:45, 28.77s/it]
Task 0, Epoch 9/20 => Loss 0.394, Train_accy 89.21:  45%|████▌     | 9/20 [04:19<05:15, 28.72s/it]
Task 0, Epoch 10/20 => Loss 0.401, Train_accy 88.69, Test_accy 57.55:  45%|████▌     | 9/20 [04:53<05:15, 28.72s/it]
Task 0, Epoch 10/20 => Loss 0.401, Train_accy 88.69, Test_accy 57.55:  50%|█████     | 10/20 [04:53<05:03, 30.33s/it]
Task 0, Epoch 11/20 => Loss 0.378, Train_accy 89.27:  50%|█████     | 10/20 [05:21<05:03, 30.33s/it]                 
Task 0, Epoch 11/20 => Loss 0.378, Train_accy 89.27:  55%|█████▌    | 11/20 [05:21<04:26, 29.63s/it]
Task 0, Epoch 12/20 => Loss 0.362, Train_accy 89.88:  55%|█████▌    | 11/20 [05:47<04:26, 29.63s/it]
Task 0, Epoch 12/20 => Loss 0.362, Train_accy 89.88:  60%|██████    | 12/20 [05:47<03:49, 28.70s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.54:  60%|██████    | 12/20 [06:16<03:49, 28.70s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.54:  65%|██████▌   | 13/20 [06:16<03:20, 28.65s/it]
Task 0, Epoch 14/20 => Loss 0.327, Train_accy 90.67:  65%|██████▌   | 13/20 [06:44<03:20, 28.65s/it]
Task 0, Epoch 14/20 => Loss 0.327, Train_accy 90.67:  70%|███████   | 14/20 [06:44<02:51, 28.61s/it]
Task 0, Epoch 15/20 => Loss 0.322, Train_accy 90.49, Test_accy 58.38:  70%|███████   | 14/20 [07:18<02:51, 28.61s/it]
Task 0, Epoch 15/20 => Loss 0.322, Train_accy 90.49, Test_accy 58.38:  75%|███████▌  | 15/20 [07:18<02:30, 30.18s/it]
Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.16:  75%|███████▌  | 15/20 [07:47<02:30, 30.18s/it]                 
Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.16:  80%|████████  | 16/20 [07:47<01:58, 29.64s/it]
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.16:  80%|████████  | 16/20 [08:15<01:58, 29.64s/it]
Task 0, Epoch 17/20 => Loss 0.288, Train_accy 91.16:  85%|████████▌ | 17/20 [08:15<01:27, 29.30s/it]
Task 0, Epoch 18/20 => Loss 0.261, Train_accy 92.37:  85%|████████▌ | 17/20 [08:41<01:27, 29.30s/it]
Task 0, Epoch 18/20 => Loss 0.261, Train_accy 92.37:  90%|█████████ | 18/20 [08:41<00:56, 28.35s/it]
Task 0, Epoch 19/20 => Loss 0.250, Train_accy 92.52:  90%|█████████ | 18/20 [09:09<00:56, 28.35s/it]
Task 0, Epoch 19/20 => Loss 0.250, Train_accy 92.52:  95%|█████████▌| 19/20 [09:09<00:28, 28.22s/it]
Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48:  95%|█████████▌| 19/20 [09:43<00:28, 28.22s/it]
Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48: 100%|██████████| 20/20 [09:43<00:00, 29.84s/it]
Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48: 100%|██████████| 20/20 [09:43<00:00, 29.17s/it]
2024-09-12 10:41:26,701 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.255, Train_accy 92.37, Test_accy 56.48
2024-09-12 10:41:31,894 [trainer.py] => No NME accuracy.
2024-09-12 10:41:31,895 [trainer.py] => CNN: {'total': 56.48, '00-99': 56.48, 'old': 0, 'new': 56.48}
2024-09-12 10:41:31,895 [trainer.py] => CNN top1 curve: [56.48]
2024-09-12 10:41:31,895 [trainer.py] => CNN top5 curve: [81.81]

Average Accuracy (CNN): 56.48
2024-09-12 10:41:31,895 [trainer.py] => Average Accuracy (CNN): 56.48 

2024-09-12 10:41:31,898 [trainer.py] => All params: 172158352
2024-09-12 10:41:31,900 [trainer.py] => Trainable params: 407240
2024-09-12 10:41:31,900 [dualprompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.341, Train_accy 17.55:   0%|          | 0/20 [00:02<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.341, Train_accy 17.55:   5%|▌         | 1/20 [00:02<00:46,  2.46s/it]
Task 1, Epoch 2/20 => Loss 1.397, Train_accy 60.41:   5%|▌         | 1/20 [00:04<00:46,  2.46s/it]
Task 1, Epoch 2/20 => Loss 1.397, Train_accy 60.41:  10%|█         | 2/20 [00:04<00:44,  2.48s/it]
Task 1, Epoch 3/20 => Loss 0.767, Train_accy 77.55:  10%|█         | 2/20 [00:07<00:44,  2.48s/it]
Task 1, Epoch 3/20 => Loss 0.767, Train_accy 77.55:  15%|█▌        | 3/20 [00:07<00:42,  2.51s/it]
Task 1, Epoch 4/20 => Loss 0.406, Train_accy 86.94:  15%|█▌        | 3/20 [00:10<00:42,  2.51s/it]
Task 1, Epoch 4/20 => Loss 0.406, Train_accy 86.94:  20%|██        | 4/20 [00:10<00:40,  2.52s/it]
Task 1, Epoch 5/20 => Loss 0.230, Train_accy 93.47, Test_accy 53.16:  20%|██        | 4/20 [00:18<00:40,  2.52s/it]
Task 1, Epoch 5/20 => Loss 0.230, Train_accy 93.47, Test_accy 53.16:  25%|██▌       | 5/20 [00:18<01:08,  4.54s/it]
Task 1, Epoch 6/20 => Loss 0.267, Train_accy 92.24:  25%|██▌       | 5/20 [00:20<01:08,  4.54s/it]                 
Task 1, Epoch 6/20 => Loss 0.267, Train_accy 92.24:  30%|███       | 6/20 [00:20<00:53,  3.83s/it]
Task 1, Epoch 7/20 => Loss 0.281, Train_accy 92.65:  30%|███       | 6/20 [00:23<00:53,  3.83s/it]
Task 1, Epoch 7/20 => Loss 0.281, Train_accy 92.65:  35%|███▌      | 7/20 [00:23<00:43,  3.37s/it]
Task 1, Epoch 8/20 => Loss 0.166, Train_accy 95.92:  35%|███▌      | 7/20 [00:25<00:43,  3.37s/it]
Task 1, Epoch 8/20 => Loss 0.166, Train_accy 95.92:  40%|████      | 8/20 [00:25<00:37,  3.10s/it]
Task 1, Epoch 9/20 => Loss 0.157, Train_accy 96.73:  40%|████      | 8/20 [00:28<00:37,  3.10s/it]
Task 1, Epoch 9/20 => Loss 0.157, Train_accy 96.73:  45%|████▌     | 9/20 [00:28<00:31,  2.91s/it]
Task 1, Epoch 10/20 => Loss 0.119, Train_accy 95.92, Test_accy 52.94:  45%|████▌     | 9/20 [00:36<00:31,  2.91s/it]
Task 1, Epoch 10/20 => Loss 0.119, Train_accy 95.92, Test_accy 52.94:  50%|█████     | 10/20 [00:36<00:44,  4.48s/it]
Task 1, Epoch 11/20 => Loss 0.124, Train_accy 96.33:  50%|█████     | 10/20 [00:38<00:44,  4.48s/it]                 
Task 1, Epoch 11/20 => Loss 0.124, Train_accy 96.33:  55%|█████▌    | 11/20 [00:38<00:34,  3.88s/it]
Task 1, Epoch 12/20 => Loss 0.096, Train_accy 98.37:  55%|█████▌    | 11/20 [00:41<00:34,  3.88s/it]
Task 1, Epoch 12/20 => Loss 0.096, Train_accy 98.37:  60%|██████    | 12/20 [00:41<00:27,  3.48s/it]
Task 1, Epoch 13/20 => Loss 0.086, Train_accy 97.96:  60%|██████    | 12/20 [00:43<00:27,  3.48s/it]
Task 1, Epoch 13/20 => Loss 0.086, Train_accy 97.96:  65%|██████▌   | 13/20 [00:43<00:22,  3.21s/it]
Task 1, Epoch 14/20 => Loss 0.067, Train_accy 97.96:  65%|██████▌   | 13/20 [00:46<00:22,  3.21s/it]
Task 1, Epoch 14/20 => Loss 0.067, Train_accy 97.96:  70%|███████   | 14/20 [00:46<00:17,  2.99s/it]
Task 1, Epoch 15/20 => Loss 0.101, Train_accy 96.73, Test_accy 52.83:  70%|███████   | 14/20 [00:54<00:17,  2.99s/it]
Task 1, Epoch 15/20 => Loss 0.101, Train_accy 96.73, Test_accy 52.83:  75%|███████▌  | 15/20 [00:54<00:22,  4.54s/it]
Task 1, Epoch 16/20 => Loss 0.080, Train_accy 97.14:  75%|███████▌  | 15/20 [00:56<00:22,  4.54s/it]                 
Task 1, Epoch 16/20 => Loss 0.080, Train_accy 97.14:  80%|████████  | 16/20 [00:56<00:15,  3.92s/it]
Task 1, Epoch 17/20 => Loss 0.131, Train_accy 98.37:  80%|████████  | 16/20 [00:59<00:15,  3.92s/it]
Task 1, Epoch 17/20 => Loss 0.131, Train_accy 98.37:  85%|████████▌ | 17/20 [00:59<00:10,  3.51s/it]
Task 1, Epoch 18/20 => Loss 0.081, Train_accy 97.14:  85%|████████▌ | 17/20 [01:01<00:10,  3.51s/it]
Task 1, Epoch 18/20 => Loss 0.081, Train_accy 97.14:  90%|█████████ | 18/20 [01:01<00:06,  3.21s/it]
Task 1, Epoch 19/20 => Loss 0.054, Train_accy 99.59:  90%|█████████ | 18/20 [01:04<00:06,  3.21s/it]
Task 1, Epoch 19/20 => Loss 0.054, Train_accy 99.59:  95%|█████████▌| 19/20 [01:04<00:03,  3.01s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 96.73, Test_accy 52.61:  95%|█████████▌| 19/20 [01:12<00:03,  3.01s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 96.73, Test_accy 52.61: 100%|██████████| 20/20 [01:12<00:00,  4.50s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 96.73, Test_accy 52.61: 100%|██████████| 20/20 [01:12<00:00,  3.62s/it]
2024-09-12 10:42:44,320 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.083, Train_accy 96.73, Test_accy 52.61
2024-09-12 10:42:49,946 [trainer.py] => No NME accuracy.
2024-09-12 10:42:49,947 [trainer.py] => CNN: {'total': 52.61, '00-99': 56.12, '100-109': 3.33, 'old': 56.12, 'new': 3.33}
2024-09-12 10:42:49,947 [trainer.py] => CNN top1 curve: [56.48, 52.61]
2024-09-12 10:42:49,947 [trainer.py] => CNN top5 curve: [81.81, 80.47]

Average Accuracy (CNN): 54.54
2024-09-12 10:42:49,947 [trainer.py] => Average Accuracy (CNN): 54.54 

2024-09-12 10:42:49,950 [trainer.py] => All params: 172158352
2024-09-12 10:42:49,952 [trainer.py] => Trainable params: 407240
2024-09-12 10:42:49,952 [dualprompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.051, Train_accy 30.94:   0%|          | 0/20 [00:02<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.051, Train_accy 30.94:   5%|▌         | 1/20 [00:02<00:54,  2.88s/it]
Task 2, Epoch 2/20 => Loss 0.961, Train_accy 69.06:   5%|▌         | 1/20 [00:05<00:54,  2.88s/it]
Task 2, Epoch 2/20 => Loss 0.961, Train_accy 69.06:  10%|█         | 2/20 [00:05<00:50,  2.82s/it]
Task 2, Epoch 3/20 => Loss 0.533, Train_accy 81.65:  10%|█         | 2/20 [00:08<00:50,  2.82s/it]
Task 2, Epoch 3/20 => Loss 0.533, Train_accy 81.65:  15%|█▌        | 3/20 [00:08<00:47,  2.81s/it]
Task 2, Epoch 4/20 => Loss 0.322, Train_accy 90.65:  15%|█▌        | 3/20 [00:11<00:47,  2.81s/it]
Task 2, Epoch 4/20 => Loss 0.322, Train_accy 90.65:  20%|██        | 4/20 [00:11<00:43,  2.73s/it]
Task 2, Epoch 5/20 => Loss 0.222, Train_accy 94.24, Test_accy 49.85:  20%|██        | 4/20 [00:19<00:43,  2.73s/it]
Task 2, Epoch 5/20 => Loss 0.222, Train_accy 94.24, Test_accy 49.85:  25%|██▌       | 5/20 [00:19<01:10,  4.72s/it]
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 91.37:  25%|██▌       | 5/20 [00:21<01:10,  4.72s/it]                 
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 91.37:  30%|███       | 6/20 [00:21<00:56,  4.01s/it]
Task 2, Epoch 7/20 => Loss 0.221, Train_accy 92.81:  30%|███       | 6/20 [00:24<00:56,  4.01s/it]
Task 2, Epoch 7/20 => Loss 0.221, Train_accy 92.81:  35%|███▌      | 7/20 [00:24<00:46,  3.55s/it]
Task 2, Epoch 8/20 => Loss 0.129, Train_accy 95.68:  35%|███▌      | 7/20 [00:27<00:46,  3.55s/it]
Task 2, Epoch 8/20 => Loss 0.129, Train_accy 95.68:  40%|████      | 8/20 [00:27<00:38,  3.24s/it]
Task 2, Epoch 9/20 => Loss 0.097, Train_accy 97.48:  40%|████      | 8/20 [00:29<00:38,  3.24s/it]
Task 2, Epoch 9/20 => Loss 0.097, Train_accy 97.48:  45%|████▌     | 9/20 [00:29<00:34,  3.10s/it]
Task 2, Epoch 10/20 => Loss 0.092, Train_accy 98.20, Test_accy 49.95:  45%|████▌     | 9/20 [00:38<00:34,  3.10s/it]
Task 2, Epoch 10/20 => Loss 0.092, Train_accy 98.20, Test_accy 49.95:  50%|█████     | 10/20 [00:38<00:47,  4.73s/it]
Task 2, Epoch 11/20 => Loss 0.124, Train_accy 96.40:  50%|█████     | 10/20 [00:40<00:47,  4.73s/it]                 
Task 2, Epoch 11/20 => Loss 0.124, Train_accy 96.40:  55%|█████▌    | 11/20 [00:40<00:36,  4.06s/it]
Task 2, Epoch 12/20 => Loss 0.096, Train_accy 96.76:  55%|█████▌    | 11/20 [00:43<00:36,  4.06s/it]
Task 2, Epoch 12/20 => Loss 0.096, Train_accy 96.76:  60%|██████    | 12/20 [00:43<00:29,  3.69s/it]
Task 2, Epoch 13/20 => Loss 0.099, Train_accy 97.12:  60%|██████    | 12/20 [00:46<00:29,  3.69s/it]
Task 2, Epoch 13/20 => Loss 0.099, Train_accy 97.12:  65%|██████▌   | 13/20 [00:46<00:23,  3.42s/it]
Task 2, Epoch 14/20 => Loss 0.119, Train_accy 96.04:  65%|██████▌   | 13/20 [00:49<00:23,  3.42s/it]
Task 2, Epoch 14/20 => Loss 0.119, Train_accy 96.04:  70%|███████   | 14/20 [00:49<00:19,  3.21s/it]
Task 2, Epoch 15/20 => Loss 0.097, Train_accy 96.40, Test_accy 50.77:  70%|███████   | 14/20 [00:58<00:19,  3.21s/it]
Task 2, Epoch 15/20 => Loss 0.097, Train_accy 96.40, Test_accy 50.77:  75%|███████▌  | 15/20 [00:58<00:24,  5.00s/it]
Task 2, Epoch 16/20 => Loss 0.056, Train_accy 98.20:  75%|███████▌  | 15/20 [01:01<00:24,  5.00s/it]                 
Task 2, Epoch 16/20 => Loss 0.056, Train_accy 98.20:  80%|████████  | 16/20 [01:01<00:17,  4.35s/it]
Task 2, Epoch 17/20 => Loss 0.070, Train_accy 97.84:  80%|████████  | 16/20 [01:04<00:17,  4.35s/it]
Task 2, Epoch 17/20 => Loss 0.070, Train_accy 97.84:  85%|████████▌ | 17/20 [01:04<00:11,  3.89s/it]
Task 2, Epoch 18/20 => Loss 0.074, Train_accy 98.20:  85%|████████▌ | 17/20 [01:06<00:11,  3.89s/it]
Task 2, Epoch 18/20 => Loss 0.074, Train_accy 98.20:  90%|█████████ | 18/20 [01:06<00:07,  3.57s/it]
Task 2, Epoch 19/20 => Loss 0.072, Train_accy 98.20:  90%|█████████ | 18/20 [01:09<00:07,  3.57s/it]
Task 2, Epoch 19/20 => Loss 0.072, Train_accy 98.20:  95%|█████████▌| 19/20 [01:09<00:03,  3.35s/it]
Task 2, Epoch 20/20 => Loss 0.068, Train_accy 97.48, Test_accy 50.97:  95%|█████████▌| 19/20 [01:18<00:03,  3.35s/it]
Task 2, Epoch 20/20 => Loss 0.068, Train_accy 97.48, Test_accy 50.97: 100%|██████████| 20/20 [01:18<00:00,  4.97s/it]
Task 2, Epoch 20/20 => Loss 0.068, Train_accy 97.48, Test_accy 50.97: 100%|██████████| 20/20 [01:18<00:00,  3.92s/it]
2024-09-12 10:44:08,369 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.068, Train_accy 97.48, Test_accy 50.97
2024-09-12 10:44:14,365 [trainer.py] => No NME accuracy.
2024-09-12 10:44:14,366 [trainer.py] => CNN: {'total': 50.97, '00-99': 56.96, '100-109': 3.33, '110-119': 21.62, 'old': 53.39, 'new': 21.62}
2024-09-12 10:44:14,366 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97]
2024-09-12 10:44:14,366 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56]

Average Accuracy (CNN): 53.35
2024-09-12 10:44:14,366 [trainer.py] => Average Accuracy (CNN): 53.35 

2024-09-12 10:44:14,367 [trainer.py] => All params: 172158352
2024-09-12 10:44:14,369 [trainer.py] => Trainable params: 407240
2024-09-12 10:44:14,369 [dualprompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.873, Train_accy 16.09:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.873, Train_accy 16.09:   5%|▌         | 1/20 [00:02<00:45,  2.41s/it]
Task 3, Epoch 2/20 => Loss 1.491, Train_accy 49.57:   5%|▌         | 1/20 [00:04<00:45,  2.41s/it]
Task 3, Epoch 2/20 => Loss 1.491, Train_accy 49.57:  10%|█         | 2/20 [00:04<00:43,  2.41s/it]
Task 3, Epoch 3/20 => Loss 0.885, Train_accy 72.61:  10%|█         | 2/20 [00:07<00:43,  2.41s/it]
Task 3, Epoch 3/20 => Loss 0.885, Train_accy 72.61:  15%|█▌        | 3/20 [00:07<00:40,  2.39s/it]
Task 3, Epoch 4/20 => Loss 0.613, Train_accy 81.30:  15%|█▌        | 3/20 [00:09<00:40,  2.39s/it]
Task 3, Epoch 4/20 => Loss 0.613, Train_accy 81.30:  20%|██        | 4/20 [00:09<00:37,  2.37s/it]
Task 3, Epoch 5/20 => Loss 0.412, Train_accy 87.39, Test_accy 47.92:  20%|██        | 4/20 [00:18<00:37,  2.37s/it]
Task 3, Epoch 5/20 => Loss 0.412, Train_accy 87.39, Test_accy 47.92:  25%|██▌       | 5/20 [00:18<01:10,  4.70s/it]
Task 3, Epoch 6/20 => Loss 0.343, Train_accy 90.43:  25%|██▌       | 5/20 [00:20<01:10,  4.70s/it]                 
Task 3, Epoch 6/20 => Loss 0.343, Train_accy 90.43:  30%|███       | 6/20 [00:20<00:54,  3.93s/it]
Task 3, Epoch 7/20 => Loss 0.256, Train_accy 93.91:  30%|███       | 6/20 [00:23<00:54,  3.93s/it]
Task 3, Epoch 7/20 => Loss 0.256, Train_accy 93.91:  35%|███▌      | 7/20 [00:23<00:44,  3.43s/it]
Task 3, Epoch 8/20 => Loss 0.234, Train_accy 95.22:  35%|███▌      | 7/20 [00:25<00:44,  3.43s/it]
Task 3, Epoch 8/20 => Loss 0.234, Train_accy 95.22:  40%|████      | 8/20 [00:25<00:37,  3.09s/it]
Task 3, Epoch 9/20 => Loss 0.231, Train_accy 93.48:  40%|████      | 8/20 [00:27<00:37,  3.09s/it]
Task 3, Epoch 9/20 => Loss 0.231, Train_accy 93.48:  45%|████▌     | 9/20 [00:27<00:31,  2.89s/it]
Task 3, Epoch 10/20 => Loss 0.151, Train_accy 96.96, Test_accy 48.12:  45%|████▌     | 9/20 [00:36<00:31,  2.89s/it]
Task 3, Epoch 10/20 => Loss 0.151, Train_accy 96.96, Test_accy 48.12:  50%|█████     | 10/20 [00:36<00:46,  4.70s/it]
Task 3, Epoch 11/20 => Loss 0.109, Train_accy 98.26:  50%|█████     | 10/20 [00:39<00:46,  4.70s/it]                 
Task 3, Epoch 11/20 => Loss 0.109, Train_accy 98.26:  55%|█████▌    | 11/20 [00:39<00:35,  3.98s/it]
Task 3, Epoch 12/20 => Loss 0.121, Train_accy 97.83:  55%|█████▌    | 11/20 [00:41<00:35,  3.98s/it]
Task 3, Epoch 12/20 => Loss 0.121, Train_accy 97.83:  60%|██████    | 12/20 [00:41<00:27,  3.48s/it]
Task 3, Epoch 13/20 => Loss 0.145, Train_accy 96.09:  60%|██████    | 12/20 [00:43<00:27,  3.48s/it]
Task 3, Epoch 13/20 => Loss 0.145, Train_accy 96.09:  65%|██████▌   | 13/20 [00:43<00:22,  3.15s/it]
Task 3, Epoch 14/20 => Loss 0.163, Train_accy 94.78:  65%|██████▌   | 13/20 [00:46<00:22,  3.15s/it]
Task 3, Epoch 14/20 => Loss 0.163, Train_accy 94.78:  70%|███████   | 14/20 [00:46<00:17,  2.91s/it]
Task 3, Epoch 15/20 => Loss 0.159, Train_accy 95.65, Test_accy 47.92:  70%|███████   | 14/20 [00:55<00:17,  2.91s/it]
Task 3, Epoch 15/20 => Loss 0.159, Train_accy 95.65, Test_accy 47.92:  75%|███████▌  | 15/20 [00:55<00:23,  4.70s/it]
Task 3, Epoch 16/20 => Loss 0.105, Train_accy 96.09:  75%|███████▌  | 15/20 [00:57<00:23,  4.70s/it]                 
Task 3, Epoch 16/20 => Loss 0.105, Train_accy 96.09:  80%|████████  | 16/20 [00:57<00:15,  4.00s/it]
Task 3, Epoch 17/20 => Loss 0.072, Train_accy 98.70:  80%|████████  | 16/20 [00:59<00:15,  4.00s/it]
Task 3, Epoch 17/20 => Loss 0.072, Train_accy 98.70:  85%|████████▌ | 17/20 [00:59<00:10,  3.49s/it]
Task 3, Epoch 18/20 => Loss 0.044, Train_accy 99.13:  85%|████████▌ | 17/20 [01:02<00:10,  3.49s/it]
Task 3, Epoch 18/20 => Loss 0.044, Train_accy 99.13:  90%|█████████ | 18/20 [01:02<00:06,  3.15s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 97.39:  90%|█████████ | 18/20 [01:04<00:06,  3.15s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 97.39:  95%|█████████▌| 19/20 [01:04<00:02,  2.91s/it]
Task 3, Epoch 20/20 => Loss 0.087, Train_accy 96.52, Test_accy 47.83:  95%|█████████▌| 19/20 [01:13<00:02,  2.91s/it]
Task 3, Epoch 20/20 => Loss 0.087, Train_accy 96.52, Test_accy 47.83: 100%|██████████| 20/20 [01:13<00:00,  4.63s/it]
Task 3, Epoch 20/20 => Loss 0.087, Train_accy 96.52, Test_accy 47.83: 100%|██████████| 20/20 [01:13<00:00,  3.65s/it]
2024-09-12 10:45:27,428 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.087, Train_accy 96.52, Test_accy 47.83
2024-09-12 10:45:33,726 [trainer.py] => No NME accuracy.
2024-09-12 10:45:33,727 [trainer.py] => CNN: {'total': 47.83, '00-99': 56.48, '100-109': 3.33, '110-119': 21.62, '120-129': 3.33, 'old': 50.56, 'new': 3.33}
2024-09-12 10:45:33,727 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83]
2024-09-12 10:45:33,727 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94]

Average Accuracy (CNN): 51.97
2024-09-12 10:45:33,727 [trainer.py] => Average Accuracy (CNN): 51.97 

2024-09-12 10:45:33,728 [trainer.py] => All params: 172158352
2024-09-12 10:45:33,730 [trainer.py] => Trainable params: 407240
2024-09-12 10:45:33,730 [dualprompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.857, Train_accy 20.39:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.857, Train_accy 20.39:   5%|▌         | 1/20 [00:03<00:59,  3.14s/it]
Task 4, Epoch 2/20 => Loss 1.248, Train_accy 55.66:   5%|▌         | 1/20 [00:06<00:59,  3.14s/it]
Task 4, Epoch 2/20 => Loss 1.248, Train_accy 55.66:  10%|█         | 2/20 [00:06<00:55,  3.09s/it]
Task 4, Epoch 3/20 => Loss 0.736, Train_accy 76.05:  10%|█         | 2/20 [00:09<00:55,  3.09s/it]
Task 4, Epoch 3/20 => Loss 0.736, Train_accy 76.05:  15%|█▌        | 3/20 [00:09<00:52,  3.11s/it]
Task 4, Epoch 4/20 => Loss 0.450, Train_accy 84.47:  15%|█▌        | 3/20 [00:12<00:52,  3.11s/it]
Task 4, Epoch 4/20 => Loss 0.450, Train_accy 84.47:  20%|██        | 4/20 [00:12<00:49,  3.09s/it]
Task 4, Epoch 5/20 => Loss 0.339, Train_accy 89.97, Test_accy 44.25:  20%|██        | 4/20 [00:22<00:49,  3.09s/it]
Task 4, Epoch 5/20 => Loss 0.339, Train_accy 89.97, Test_accy 44.25:  25%|██▌       | 5/20 [00:22<01:22,  5.50s/it]
Task 4, Epoch 6/20 => Loss 0.249, Train_accy 93.20:  25%|██▌       | 5/20 [00:25<01:22,  5.50s/it]                 
Task 4, Epoch 6/20 => Loss 0.249, Train_accy 93.20:  30%|███       | 6/20 [00:25<01:05,  4.69s/it]
Task 4, Epoch 7/20 => Loss 0.246, Train_accy 93.85:  30%|███       | 6/20 [00:28<01:05,  4.69s/it]
Task 4, Epoch 7/20 => Loss 0.246, Train_accy 93.85:  35%|███▌      | 7/20 [00:28<00:53,  4.09s/it]
Task 4, Epoch 8/20 => Loss 0.233, Train_accy 96.12:  35%|███▌      | 7/20 [00:30<00:53,  4.09s/it]
Task 4, Epoch 8/20 => Loss 0.233, Train_accy 96.12:  40%|████      | 8/20 [00:30<00:44,  3.69s/it]
Task 4, Epoch 9/20 => Loss 0.195, Train_accy 93.20:  40%|████      | 8/20 [00:33<00:44,  3.69s/it]
Task 4, Epoch 9/20 => Loss 0.195, Train_accy 93.20:  45%|████▌     | 9/20 [00:33<00:37,  3.43s/it]
Task 4, Epoch 10/20 => Loss 0.147, Train_accy 97.41, Test_accy 44.78:  45%|████▌     | 9/20 [00:42<00:37,  3.43s/it]
Task 4, Epoch 10/20 => Loss 0.147, Train_accy 97.41, Test_accy 44.78:  50%|█████     | 10/20 [00:43<00:52,  5.20s/it]
Task 4, Epoch 11/20 => Loss 0.119, Train_accy 96.76:  50%|█████     | 10/20 [00:45<00:52,  5.20s/it]                 
Task 4, Epoch 11/20 => Loss 0.119, Train_accy 96.76:  55%|█████▌    | 11/20 [00:45<00:40,  4.48s/it]
Task 4, Epoch 12/20 => Loss 0.169, Train_accy 94.82:  55%|█████▌    | 11/20 [00:48<00:40,  4.48s/it]
Task 4, Epoch 12/20 => Loss 0.169, Train_accy 94.82:  60%|██████    | 12/20 [00:48<00:31,  3.97s/it]
Task 4, Epoch 13/20 => Loss 0.086, Train_accy 98.38:  60%|██████    | 12/20 [00:51<00:31,  3.97s/it]
Task 4, Epoch 13/20 => Loss 0.086, Train_accy 98.38:  65%|██████▌   | 13/20 [00:51<00:25,  3.63s/it]
Task 4, Epoch 14/20 => Loss 0.155, Train_accy 95.15:  65%|██████▌   | 13/20 [00:54<00:25,  3.63s/it]
Task 4, Epoch 14/20 => Loss 0.155, Train_accy 95.15:  70%|███████   | 14/20 [00:54<00:20,  3.46s/it]
Task 4, Epoch 15/20 => Loss 0.129, Train_accy 94.82, Test_accy 45.23:  70%|███████   | 14/20 [01:04<00:20,  3.46s/it]
Task 4, Epoch 15/20 => Loss 0.129, Train_accy 94.82, Test_accy 45.23:  75%|███████▌  | 15/20 [01:04<00:26,  5.36s/it]
Task 4, Epoch 16/20 => Loss 0.070, Train_accy 98.38:  75%|███████▌  | 15/20 [01:07<00:26,  5.36s/it]                 
Task 4, Epoch 16/20 => Loss 0.070, Train_accy 98.38:  80%|████████  | 16/20 [01:07<00:18,  4.66s/it]
Task 4, Epoch 17/20 => Loss 0.117, Train_accy 96.12:  80%|████████  | 16/20 [01:10<00:18,  4.66s/it]
Task 4, Epoch 17/20 => Loss 0.117, Train_accy 96.12:  85%|████████▌ | 17/20 [01:10<00:12,  4.16s/it]
Task 4, Epoch 18/20 => Loss 0.082, Train_accy 97.73:  85%|████████▌ | 17/20 [01:13<00:12,  4.16s/it]
Task 4, Epoch 18/20 => Loss 0.082, Train_accy 97.73:  90%|█████████ | 18/20 [01:13<00:07,  3.85s/it]
Task 4, Epoch 19/20 => Loss 0.068, Train_accy 98.06:  90%|█████████ | 18/20 [01:16<00:07,  3.85s/it]
Task 4, Epoch 19/20 => Loss 0.068, Train_accy 98.06:  95%|█████████▌| 19/20 [01:16<00:03,  3.61s/it]
Task 4, Epoch 20/20 => Loss 0.065, Train_accy 98.06, Test_accy 45.14:  95%|█████████▌| 19/20 [01:26<00:03,  3.61s/it]
Task 4, Epoch 20/20 => Loss 0.065, Train_accy 98.06, Test_accy 45.14: 100%|██████████| 20/20 [01:26<00:00,  5.47s/it]
Task 4, Epoch 20/20 => Loss 0.065, Train_accy 98.06, Test_accy 45.14: 100%|██████████| 20/20 [01:26<00:00,  4.32s/it]
2024-09-12 10:47:00,076 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.065, Train_accy 98.06, Test_accy 45.14
2024-09-12 10:47:06,868 [trainer.py] => No NME accuracy.
2024-09-12 10:47:06,869 [trainer.py] => CNN: {'total': 45.14, '00-99': 56.72, '100-109': 3.33, '110-119': 21.62, '120-129': 3.33, '130-139': 10.47, 'old': 48.02, 'new': 10.47}
2024-09-12 10:47:06,869 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83, 45.14]
2024-09-12 10:47:06,869 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94, 73.95]

Average Accuracy (CNN): 50.61
2024-09-12 10:47:06,869 [trainer.py] => Average Accuracy (CNN): 50.61 

2024-09-12 10:47:06,872 [trainer.py] => All params: 172158352
2024-09-12 10:47:06,875 [trainer.py] => Trainable params: 407240
2024-09-12 10:47:06,875 [dualprompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.475, Train_accy 19.21:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.475, Train_accy 19.21:   5%|▌         | 1/20 [00:03<01:01,  3.23s/it]
Task 5, Epoch 2/20 => Loss 1.262, Train_accy 55.18:   5%|▌         | 1/20 [00:06<01:01,  3.23s/it]
Task 5, Epoch 2/20 => Loss 1.262, Train_accy 55.18:  10%|█         | 2/20 [00:06<00:57,  3.21s/it]
Task 5, Epoch 3/20 => Loss 0.631, Train_accy 82.01:  10%|█         | 2/20 [00:09<00:57,  3.21s/it]
Task 5, Epoch 3/20 => Loss 0.631, Train_accy 82.01:  15%|█▌        | 3/20 [00:09<00:54,  3.20s/it]
Task 5, Epoch 4/20 => Loss 0.478, Train_accy 86.89:  15%|█▌        | 3/20 [00:12<00:54,  3.20s/it]
Task 5, Epoch 4/20 => Loss 0.478, Train_accy 86.89:  20%|██        | 4/20 [00:12<00:51,  3.19s/it]
Task 5, Epoch 5/20 => Loss 0.337, Train_accy 91.46, Test_accy 42.69:  20%|██        | 4/20 [00:23<00:51,  3.19s/it]
Task 5, Epoch 5/20 => Loss 0.337, Train_accy 91.46, Test_accy 42.69:  25%|██▌       | 5/20 [00:23<01:27,  5.80s/it]
Task 5, Epoch 6/20 => Loss 0.277, Train_accy 93.29:  25%|██▌       | 5/20 [00:26<01:27,  5.80s/it]                 
Task 5, Epoch 6/20 => Loss 0.277, Train_accy 93.29:  30%|███       | 6/20 [00:26<01:09,  4.93s/it]
Task 5, Epoch 7/20 => Loss 0.220, Train_accy 92.99:  30%|███       | 6/20 [00:29<01:09,  4.93s/it]
Task 5, Epoch 7/20 => Loss 0.220, Train_accy 92.99:  35%|███▌      | 7/20 [00:29<00:56,  4.37s/it]
Task 5, Epoch 8/20 => Loss 0.147, Train_accy 96.34:  35%|███▌      | 7/20 [00:32<00:56,  4.37s/it]
Task 5, Epoch 8/20 => Loss 0.147, Train_accy 96.34:  40%|████      | 8/20 [00:32<00:47,  4.00s/it]
Task 5, Epoch 9/20 => Loss 0.183, Train_accy 93.90:  40%|████      | 8/20 [00:36<00:47,  4.00s/it]
Task 5, Epoch 9/20 => Loss 0.183, Train_accy 93.90:  45%|████▌     | 9/20 [00:36<00:41,  3.77s/it]
Task 5, Epoch 10/20 => Loss 0.169, Train_accy 96.04, Test_accy 42.86:  45%|████▌     | 9/20 [00:46<00:41,  3.77s/it]
Task 5, Epoch 10/20 => Loss 0.169, Train_accy 96.04, Test_accy 42.86:  50%|█████     | 10/20 [00:46<00:58,  5.82s/it]
Task 5, Epoch 11/20 => Loss 0.142, Train_accy 96.95:  50%|█████     | 10/20 [00:49<00:58,  5.82s/it]                 
Task 5, Epoch 11/20 => Loss 0.142, Train_accy 96.95:  55%|█████▌    | 11/20 [00:49<00:45,  5.04s/it]
Task 5, Epoch 12/20 => Loss 0.126, Train_accy 96.34:  55%|█████▌    | 11/20 [00:53<00:45,  5.04s/it]
Task 5, Epoch 12/20 => Loss 0.126, Train_accy 96.34:  60%|██████    | 12/20 [00:53<00:36,  4.50s/it]
Task 5, Epoch 13/20 => Loss 0.162, Train_accy 95.73:  60%|██████    | 12/20 [00:56<00:36,  4.50s/it]
Task 5, Epoch 13/20 => Loss 0.162, Train_accy 95.73:  65%|██████▌   | 13/20 [00:56<00:28,  4.11s/it]
Task 5, Epoch 14/20 => Loss 0.118, Train_accy 96.65:  65%|██████▌   | 13/20 [00:59<00:28,  4.11s/it]
Task 5, Epoch 14/20 => Loss 0.118, Train_accy 96.65:  70%|███████   | 14/20 [00:59<00:23,  3.84s/it]
Task 5, Epoch 15/20 => Loss 0.109, Train_accy 97.26, Test_accy 42.86:  70%|███████   | 14/20 [01:09<00:23,  3.84s/it]
Task 5, Epoch 15/20 => Loss 0.109, Train_accy 97.26, Test_accy 42.86:  75%|███████▌  | 15/20 [01:09<00:29,  5.81s/it]
Task 5, Epoch 16/20 => Loss 0.101, Train_accy 96.95:  75%|███████▌  | 15/20 [01:13<00:29,  5.81s/it]                 
Task 5, Epoch 16/20 => Loss 0.101, Train_accy 96.95:  80%|████████  | 16/20 [01:13<00:20,  5.03s/it]
Task 5, Epoch 17/20 => Loss 0.105, Train_accy 97.26:  80%|████████  | 16/20 [01:16<00:20,  5.03s/it]
Task 5, Epoch 17/20 => Loss 0.105, Train_accy 97.26:  85%|████████▌ | 17/20 [01:16<00:13,  4.46s/it]
Task 5, Epoch 18/20 => Loss 0.108, Train_accy 96.65:  85%|████████▌ | 17/20 [01:19<00:13,  4.46s/it]
Task 5, Epoch 18/20 => Loss 0.108, Train_accy 96.65:  90%|█████████ | 18/20 [01:19<00:08,  4.06s/it]
Task 5, Epoch 19/20 => Loss 0.101, Train_accy 97.26:  90%|█████████ | 18/20 [01:22<00:08,  4.06s/it]
Task 5, Epoch 19/20 => Loss 0.101, Train_accy 97.26:  95%|█████████▌| 19/20 [01:22<00:03,  3.79s/it]
Task 5, Epoch 20/20 => Loss 0.091, Train_accy 97.87, Test_accy 42.94:  95%|█████████▌| 19/20 [01:32<00:03,  3.79s/it]
Task 5, Epoch 20/20 => Loss 0.091, Train_accy 97.87, Test_accy 42.94: 100%|██████████| 20/20 [01:32<00:00,  5.77s/it]
Task 5, Epoch 20/20 => Loss 0.091, Train_accy 97.87, Test_accy 42.94: 100%|██████████| 20/20 [01:32<00:00,  4.65s/it]
2024-09-12 10:48:39,818 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.091, Train_accy 97.87, Test_accy 42.94
2024-09-12 10:48:46,984 [trainer.py] => No NME accuracy.
2024-09-12 10:48:46,984 [trainer.py] => CNN: {'total': 42.94, '00-99': 56.24, '100-109': 3.33, '110-119': 18.92, '120-129': 3.33, '130-139': 10.47, '140-149': 18.42, 'old': 44.6, 'new': 18.42}
2024-09-12 10:48:46,984 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83, 45.14, 42.94]
2024-09-12 10:48:46,984 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94, 73.95, 72.43]

Average Accuracy (CNN): 49.33
2024-09-12 10:48:46,984 [trainer.py] => Average Accuracy (CNN): 49.33 

2024-09-12 10:48:46,986 [trainer.py] => All params: 172158352
2024-09-12 10:48:46,987 [trainer.py] => Trainable params: 407240
2024-09-12 10:48:46,987 [dualprompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.630, Train_accy 22.66:   0%|          | 0/20 [00:02<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.630, Train_accy 22.66:   5%|▌         | 1/20 [00:02<00:42,  2.22s/it]
Task 6, Epoch 2/20 => Loss 1.349, Train_accy 54.19:   5%|▌         | 1/20 [00:04<00:42,  2.22s/it]
Task 6, Epoch 2/20 => Loss 1.349, Train_accy 54.19:  10%|█         | 2/20 [00:04<00:39,  2.19s/it]
Task 6, Epoch 3/20 => Loss 0.835, Train_accy 73.40:  10%|█         | 2/20 [00:06<00:39,  2.19s/it]
Task 6, Epoch 3/20 => Loss 0.835, Train_accy 73.40:  15%|█▌        | 3/20 [00:06<00:36,  2.17s/it]
Task 6, Epoch 4/20 => Loss 0.440, Train_accy 85.71:  15%|█▌        | 3/20 [00:08<00:36,  2.17s/it]
Task 6, Epoch 4/20 => Loss 0.440, Train_accy 85.71:  20%|██        | 4/20 [00:08<00:34,  2.14s/it]
Task 6, Epoch 5/20 => Loss 0.322, Train_accy 90.64, Test_accy 41.83:  20%|██        | 4/20 [00:17<00:34,  2.14s/it]
Task 6, Epoch 5/20 => Loss 0.322, Train_accy 90.64, Test_accy 41.83:  25%|██▌       | 5/20 [00:17<01:10,  4.67s/it]
Task 6, Epoch 6/20 => Loss 0.273, Train_accy 91.13:  25%|██▌       | 5/20 [00:19<01:10,  4.67s/it]                 
Task 6, Epoch 6/20 => Loss 0.273, Train_accy 91.13:  30%|███       | 6/20 [00:19<00:52,  3.75s/it]
Task 6, Epoch 7/20 => Loss 0.231, Train_accy 94.58:  30%|███       | 6/20 [00:21<00:52,  3.75s/it]
Task 6, Epoch 7/20 => Loss 0.231, Train_accy 94.58:  35%|███▌      | 7/20 [00:21<00:41,  3.18s/it]
Task 6, Epoch 8/20 => Loss 0.145, Train_accy 98.03:  35%|███▌      | 7/20 [00:23<00:41,  3.18s/it]
Task 6, Epoch 8/20 => Loss 0.145, Train_accy 98.03:  40%|████      | 8/20 [00:23<00:33,  2.80s/it]
Task 6, Epoch 9/20 => Loss 0.119, Train_accy 96.06:  40%|████      | 8/20 [00:25<00:33,  2.80s/it]
Task 6, Epoch 9/20 => Loss 0.119, Train_accy 96.06:  45%|████▌     | 9/20 [00:25<00:27,  2.54s/it]
Task 6, Epoch 10/20 => Loss 0.096, Train_accy 98.03, Test_accy 41.99:  45%|████▌     | 9/20 [00:34<00:27,  2.54s/it]
Task 6, Epoch 10/20 => Loss 0.096, Train_accy 98.03, Test_accy 41.99:  50%|█████     | 10/20 [00:34<00:45,  4.54s/it]
Task 6, Epoch 11/20 => Loss 0.059, Train_accy 99.51:  50%|█████     | 10/20 [00:36<00:45,  4.54s/it]                 
Task 6, Epoch 11/20 => Loss 0.059, Train_accy 99.51:  55%|█████▌    | 11/20 [00:36<00:33,  3.76s/it]
Task 6, Epoch 12/20 => Loss 0.069, Train_accy 99.01:  55%|█████▌    | 11/20 [00:38<00:33,  3.76s/it]
Task 6, Epoch 12/20 => Loss 0.069, Train_accy 99.01:  60%|██████    | 12/20 [00:38<00:25,  3.23s/it]
Task 6, Epoch 13/20 => Loss 0.139, Train_accy 98.03:  60%|██████    | 12/20 [00:40<00:25,  3.23s/it]
Task 6, Epoch 13/20 => Loss 0.139, Train_accy 98.03:  65%|██████▌   | 13/20 [00:40<00:20,  2.86s/it]
Task 6, Epoch 14/20 => Loss 0.064, Train_accy 98.03:  65%|██████▌   | 13/20 [00:42<00:20,  2.86s/it]
Task 6, Epoch 14/20 => Loss 0.064, Train_accy 98.03:  70%|███████   | 14/20 [00:42<00:15,  2.60s/it]
Task 6, Epoch 15/20 => Loss 0.083, Train_accy 97.54, Test_accy 42.15:  70%|███████   | 14/20 [00:52<00:15,  2.60s/it]
Task 6, Epoch 15/20 => Loss 0.083, Train_accy 97.54, Test_accy 42.15:  75%|███████▌  | 15/20 [00:52<00:23,  4.71s/it]
Task 6, Epoch 16/20 => Loss 0.072, Train_accy 98.03:  75%|███████▌  | 15/20 [00:54<00:23,  4.71s/it]                 
Task 6, Epoch 16/20 => Loss 0.072, Train_accy 98.03:  80%|████████  | 16/20 [00:54<00:15,  3.95s/it]
Task 6, Epoch 17/20 => Loss 0.043, Train_accy 99.51:  80%|████████  | 16/20 [00:56<00:15,  3.95s/it]
Task 6, Epoch 17/20 => Loss 0.043, Train_accy 99.51:  85%|████████▌ | 17/20 [00:56<00:10,  3.42s/it]
Task 6, Epoch 18/20 => Loss 0.032, Train_accy 99.51:  85%|████████▌ | 17/20 [00:58<00:10,  3.42s/it]
Task 6, Epoch 18/20 => Loss 0.032, Train_accy 99.51:  90%|█████████ | 18/20 [00:58<00:06,  3.03s/it]
Task 6, Epoch 19/20 => Loss 0.077, Train_accy 98.52:  90%|█████████ | 18/20 [01:00<00:06,  3.03s/it]
Task 6, Epoch 19/20 => Loss 0.077, Train_accy 98.52:  95%|█████████▌| 19/20 [01:00<00:02,  2.75s/it]
Task 6, Epoch 20/20 => Loss 0.050, Train_accy 98.52, Test_accy 42.07:  95%|█████████▌| 19/20 [01:10<00:02,  2.75s/it]
Task 6, Epoch 20/20 => Loss 0.050, Train_accy 98.52, Test_accy 42.07: 100%|██████████| 20/20 [01:10<00:00,  4.84s/it]
Task 6, Epoch 20/20 => Loss 0.050, Train_accy 98.52, Test_accy 42.07: 100%|██████████| 20/20 [01:10<00:00,  3.53s/it]
2024-09-12 10:49:57,652 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.050, Train_accy 98.52, Test_accy 42.07
2024-09-12 10:50:05,403 [trainer.py] => No NME accuracy.
2024-09-12 10:50:05,403 [trainer.py] => CNN: {'total': 42.07, '00-99': 56.72, '100-109': 3.33, '110-119': 20.27, '120-129': 3.33, '130-139': 10.47, '140-149': 15.79, '150-159': 15.69, 'old': 43.19, 'new': 15.69}
2024-09-12 10:50:05,403 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83, 45.14, 42.94, 42.07]
2024-09-12 10:50:05,404 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94, 73.95, 72.43, 70.99]

Average Accuracy (CNN): 48.29
2024-09-12 10:50:05,404 [trainer.py] => Average Accuracy (CNN): 48.29 

2024-09-12 10:50:05,406 [trainer.py] => All params: 172158352
2024-09-12 10:50:05,408 [trainer.py] => Trainable params: 407240
2024-09-12 10:50:05,408 [dualprompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.465, Train_accy 23.35:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.465, Train_accy 23.35:   5%|▌         | 1/20 [00:03<01:01,  3.22s/it]
Task 7, Epoch 2/20 => Loss 1.314, Train_accy 54.49:   5%|▌         | 1/20 [00:06<01:01,  3.22s/it]
Task 7, Epoch 2/20 => Loss 1.314, Train_accy 54.49:  10%|█         | 2/20 [00:06<00:58,  3.24s/it]
Task 7, Epoch 3/20 => Loss 0.784, Train_accy 76.05:  10%|█         | 2/20 [00:09<00:58,  3.24s/it]
Task 7, Epoch 3/20 => Loss 0.784, Train_accy 76.05:  15%|█▌        | 3/20 [00:09<00:54,  3.21s/it]
Task 7, Epoch 4/20 => Loss 0.541, Train_accy 82.04:  15%|█▌        | 3/20 [00:12<00:54,  3.21s/it]
Task 7, Epoch 4/20 => Loss 0.541, Train_accy 82.04:  20%|██        | 4/20 [00:12<00:51,  3.24s/it]
Task 7, Epoch 5/20 => Loss 0.425, Train_accy 84.43, Test_accy 39.53:  20%|██        | 4/20 [00:24<00:51,  3.24s/it]
Task 7, Epoch 5/20 => Loss 0.425, Train_accy 84.43, Test_accy 39.53:  25%|██▌       | 5/20 [00:24<01:32,  6.14s/it]
Task 7, Epoch 6/20 => Loss 0.315, Train_accy 91.62:  25%|██▌       | 5/20 [00:27<01:32,  6.14s/it]                 
Task 7, Epoch 6/20 => Loss 0.315, Train_accy 91.62:  30%|███       | 6/20 [00:27<01:12,  5.15s/it]
Task 7, Epoch 7/20 => Loss 0.306, Train_accy 89.82:  30%|███       | 6/20 [00:30<01:12,  5.15s/it]
Task 7, Epoch 7/20 => Loss 0.306, Train_accy 89.82:  35%|███▌      | 7/20 [00:30<00:59,  4.55s/it]
Task 7, Epoch 8/20 => Loss 0.262, Train_accy 92.22:  35%|███▌      | 7/20 [00:34<00:59,  4.55s/it]
Task 7, Epoch 8/20 => Loss 0.262, Train_accy 92.22:  40%|████      | 8/20 [00:34<00:49,  4.14s/it]
Task 7, Epoch 9/20 => Loss 0.211, Train_accy 94.01:  40%|████      | 8/20 [00:37<00:49,  4.14s/it]
Task 7, Epoch 9/20 => Loss 0.211, Train_accy 94.01:  45%|████▌     | 9/20 [00:37<00:42,  3.85s/it]
Task 7, Epoch 10/20 => Loss 0.249, Train_accy 92.51, Test_accy 39.68:  45%|████▌     | 9/20 [00:48<00:42,  3.85s/it]
Task 7, Epoch 10/20 => Loss 0.249, Train_accy 92.51, Test_accy 39.68:  50%|█████     | 10/20 [00:48<01:01,  6.17s/it]
Task 7, Epoch 11/20 => Loss 0.186, Train_accy 94.31:  50%|█████     | 10/20 [00:51<01:01,  6.17s/it]                 
Task 7, Epoch 11/20 => Loss 0.186, Train_accy 94.31:  55%|█████▌    | 11/20 [00:51<00:47,  5.29s/it]
Task 7, Epoch 12/20 => Loss 0.180, Train_accy 94.31:  55%|█████▌    | 11/20 [00:55<00:47,  5.29s/it]
Task 7, Epoch 12/20 => Loss 0.180, Train_accy 94.31:  60%|██████    | 12/20 [00:55<00:37,  4.66s/it]
Task 7, Epoch 13/20 => Loss 0.136, Train_accy 96.11:  60%|██████    | 12/20 [00:58<00:37,  4.66s/it]
Task 7, Epoch 13/20 => Loss 0.136, Train_accy 96.11:  65%|██████▌   | 13/20 [00:58<00:29,  4.26s/it]
Task 7, Epoch 14/20 => Loss 0.158, Train_accy 95.51:  65%|██████▌   | 13/20 [01:01<00:29,  4.26s/it]
Task 7, Epoch 14/20 => Loss 0.158, Train_accy 95.51:  70%|███████   | 14/20 [01:01<00:23,  3.95s/it]
Task 7, Epoch 15/20 => Loss 0.134, Train_accy 94.91, Test_accy 39.98:  70%|███████   | 14/20 [01:13<00:23,  3.95s/it]
Task 7, Epoch 15/20 => Loss 0.134, Train_accy 94.91, Test_accy 39.98:  75%|███████▌  | 15/20 [01:13<00:30,  6.18s/it]
Task 7, Epoch 16/20 => Loss 0.160, Train_accy 94.91:  75%|███████▌  | 15/20 [01:16<00:30,  6.18s/it]                 
Task 7, Epoch 16/20 => Loss 0.160, Train_accy 94.91:  80%|████████  | 16/20 [01:16<00:21,  5.32s/it]
Task 7, Epoch 17/20 => Loss 0.122, Train_accy 96.41:  80%|████████  | 16/20 [01:19<00:21,  5.32s/it]
Task 7, Epoch 17/20 => Loss 0.122, Train_accy 96.41:  85%|████████▌ | 17/20 [01:19<00:14,  4.71s/it]
Task 7, Epoch 18/20 => Loss 0.164, Train_accy 94.31:  85%|████████▌ | 17/20 [01:22<00:14,  4.71s/it]
Task 7, Epoch 18/20 => Loss 0.164, Train_accy 94.31:  90%|█████████ | 18/20 [01:22<00:08,  4.27s/it]
Task 7, Epoch 19/20 => Loss 0.115, Train_accy 96.11:  90%|█████████ | 18/20 [01:26<00:08,  4.27s/it]
Task 7, Epoch 19/20 => Loss 0.115, Train_accy 96.11:  95%|█████████▌| 19/20 [01:26<00:03,  3.97s/it]
Task 7, Epoch 20/20 => Loss 0.105, Train_accy 97.01, Test_accy 40.21:  95%|█████████▌| 19/20 [01:37<00:03,  3.97s/it]
Task 7, Epoch 20/20 => Loss 0.105, Train_accy 97.01, Test_accy 40.21: 100%|██████████| 20/20 [01:37<00:00,  6.18s/it]
Task 7, Epoch 20/20 => Loss 0.105, Train_accy 97.01, Test_accy 40.21: 100%|██████████| 20/20 [01:37<00:00,  4.87s/it]
2024-09-12 10:51:42,920 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.105, Train_accy 97.01, Test_accy 40.21
2024-09-12 10:51:50,994 [trainer.py] => No NME accuracy.
2024-09-12 10:51:50,995 [trainer.py] => CNN: {'total': 40.21, '00-99': 56.72, '100-109': 3.33, '110-119': 20.27, '120-129': 3.33, '130-139': 10.47, '140-149': 17.11, '150-159': 15.69, '160-169': 11.76, 'old': 42.15, 'new': 11.76}
2024-09-12 10:51:50,995 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83, 45.14, 42.94, 42.07, 40.21]
2024-09-12 10:51:50,995 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94, 73.95, 72.43, 70.99, 69.39]

Average Accuracy (CNN): 47.28
2024-09-12 10:51:50,995 [trainer.py] => Average Accuracy (CNN): 47.28 

2024-09-12 10:51:50,999 [trainer.py] => All params: 172158352
2024-09-12 10:51:51,001 [trainer.py] => Trainable params: 407240
2024-09-12 10:51:51,002 [dualprompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.887, Train_accy 13.92:   0%|          | 0/20 [00:02<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.887, Train_accy 13.92:   5%|▌         | 1/20 [00:02<00:45,  2.39s/it]
Task 8, Epoch 2/20 => Loss 1.469, Train_accy 51.48:   5%|▌         | 1/20 [00:04<00:45,  2.39s/it]
Task 8, Epoch 2/20 => Loss 1.469, Train_accy 51.48:  10%|█         | 2/20 [00:04<00:43,  2.41s/it]
Task 8, Epoch 3/20 => Loss 0.895, Train_accy 73.00:  10%|█         | 2/20 [00:07<00:43,  2.41s/it]
Task 8, Epoch 3/20 => Loss 0.895, Train_accy 73.00:  15%|█▌        | 3/20 [00:07<00:40,  2.40s/it]
Task 8, Epoch 4/20 => Loss 0.610, Train_accy 81.43:  15%|█▌        | 3/20 [00:09<00:40,  2.40s/it]
Task 8, Epoch 4/20 => Loss 0.610, Train_accy 81.43:  20%|██        | 4/20 [00:09<00:37,  2.33s/it]
Task 8, Epoch 5/20 => Loss 0.350, Train_accy 89.87, Test_accy 38.42:  20%|██        | 4/20 [00:19<00:37,  2.33s/it]
Task 8, Epoch 5/20 => Loss 0.350, Train_accy 89.87, Test_accy 38.42:  25%|██▌       | 5/20 [00:19<01:17,  5.15s/it]
Task 8, Epoch 6/20 => Loss 0.262, Train_accy 94.09:  25%|██▌       | 5/20 [00:21<01:17,  5.15s/it]                 
Task 8, Epoch 6/20 => Loss 0.262, Train_accy 94.09:  30%|███       | 6/20 [00:21<00:58,  4.18s/it]
Task 8, Epoch 7/20 => Loss 0.229, Train_accy 94.09:  30%|███       | 6/20 [00:24<00:58,  4.18s/it]
Task 8, Epoch 7/20 => Loss 0.229, Train_accy 94.09:  35%|███▌      | 7/20 [00:24<00:46,  3.57s/it]
Task 8, Epoch 8/20 => Loss 0.206, Train_accy 94.94:  35%|███▌      | 7/20 [00:26<00:46,  3.57s/it]
Task 8, Epoch 8/20 => Loss 0.206, Train_accy 94.94:  40%|████      | 8/20 [00:26<00:37,  3.14s/it]
Task 8, Epoch 9/20 => Loss 0.153, Train_accy 95.78:  40%|████      | 8/20 [00:28<00:37,  3.14s/it]
Task 8, Epoch 9/20 => Loss 0.153, Train_accy 95.78:  45%|████▌     | 9/20 [00:28<00:31,  2.86s/it]
Task 8, Epoch 10/20 => Loss 0.139, Train_accy 97.47, Test_accy 38.28:  45%|████▌     | 9/20 [00:38<00:31,  2.86s/it]
Task 8, Epoch 10/20 => Loss 0.139, Train_accy 97.47, Test_accy 38.28:  50%|█████     | 10/20 [00:38<00:50,  5.07s/it]
Task 8, Epoch 11/20 => Loss 0.117, Train_accy 97.47:  50%|█████     | 10/20 [00:41<00:50,  5.07s/it]                 
Task 8, Epoch 11/20 => Loss 0.117, Train_accy 97.47:  55%|█████▌    | 11/20 [00:41<00:38,  4.24s/it]
Task 8, Epoch 12/20 => Loss 0.119, Train_accy 97.47:  55%|█████▌    | 11/20 [00:43<00:38,  4.24s/it]
Task 8, Epoch 12/20 => Loss 0.119, Train_accy 97.47:  60%|██████    | 12/20 [00:43<00:29,  3.70s/it]
Task 8, Epoch 13/20 => Loss 0.131, Train_accy 96.62:  60%|██████    | 12/20 [00:45<00:29,  3.70s/it]
Task 8, Epoch 13/20 => Loss 0.131, Train_accy 96.62:  65%|██████▌   | 13/20 [00:45<00:23,  3.33s/it]
Task 8, Epoch 14/20 => Loss 0.094, Train_accy 98.31:  65%|██████▌   | 13/20 [00:48<00:23,  3.33s/it]
Task 8, Epoch 14/20 => Loss 0.094, Train_accy 98.31:  70%|███████   | 14/20 [00:48<00:18,  3.07s/it]
Task 8, Epoch 15/20 => Loss 0.066, Train_accy 98.73, Test_accy 38.28:  70%|███████   | 14/20 [00:59<00:18,  3.07s/it]
Task 8, Epoch 15/20 => Loss 0.066, Train_accy 98.73, Test_accy 38.28:  75%|███████▌  | 15/20 [00:59<00:27,  5.46s/it]
Task 8, Epoch 16/20 => Loss 0.111, Train_accy 97.05:  75%|███████▌  | 15/20 [01:01<00:27,  5.46s/it]                 
Task 8, Epoch 16/20 => Loss 0.111, Train_accy 97.05:  80%|████████  | 16/20 [01:01<00:18,  4.58s/it]
Task 8, Epoch 17/20 => Loss 0.078, Train_accy 98.31:  80%|████████  | 16/20 [01:04<00:18,  4.58s/it]
Task 8, Epoch 17/20 => Loss 0.078, Train_accy 98.31:  85%|████████▌ | 17/20 [01:04<00:11,  3.94s/it]
Task 8, Epoch 18/20 => Loss 0.092, Train_accy 97.47:  85%|████████▌ | 17/20 [01:06<00:11,  3.94s/it]
Task 8, Epoch 18/20 => Loss 0.092, Train_accy 97.47:  90%|█████████ | 18/20 [01:06<00:06,  3.48s/it]
Task 8, Epoch 19/20 => Loss 0.057, Train_accy 98.73:  90%|█████████ | 18/20 [01:09<00:06,  3.48s/it]
Task 8, Epoch 19/20 => Loss 0.057, Train_accy 98.73:  95%|█████████▌| 19/20 [01:09<00:03,  3.17s/it]
Task 8, Epoch 20/20 => Loss 0.080, Train_accy 98.31, Test_accy 38.64:  95%|█████████▌| 19/20 [01:20<00:03,  3.17s/it]
Task 8, Epoch 20/20 => Loss 0.080, Train_accy 98.31, Test_accy 38.64: 100%|██████████| 20/20 [01:20<00:00,  5.53s/it]
Task 8, Epoch 20/20 => Loss 0.080, Train_accy 98.31, Test_accy 38.64: 100%|██████████| 20/20 [01:20<00:00,  4.02s/it]
2024-09-12 10:53:11,324 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.080, Train_accy 98.31, Test_accy 38.64
2024-09-12 10:53:19,778 [trainer.py] => No NME accuracy.
2024-09-12 10:53:19,779 [trainer.py] => CNN: {'total': 38.64, '00-99': 57.19, '100-109': 3.33, '110-119': 18.92, '120-129': 3.33, '130-139': 10.47, '140-149': 15.79, '150-159': 15.69, '160-169': 11.76, '170-179': 1.61, 'old': 40.36, 'new': 1.61}
2024-09-12 10:53:19,779 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83, 45.14, 42.94, 42.07, 40.21, 38.64]
2024-09-12 10:53:19,779 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94, 73.95, 72.43, 70.99, 69.39, 67.24]

Average Accuracy (CNN): 46.32
2024-09-12 10:53:19,780 [trainer.py] => Average Accuracy (CNN): 46.32 

2024-09-12 10:53:19,783 [trainer.py] => All params: 172158352
2024-09-12 10:53:19,786 [trainer.py] => Trainable params: 407240
2024-09-12 10:53:19,786 [dualprompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.242, Train_accy 12.17:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.242, Train_accy 12.17:   5%|▌         | 1/20 [00:02<00:38,  2.05s/it]
Task 9, Epoch 2/20 => Loss 1.563, Train_accy 47.09:   5%|▌         | 1/20 [00:04<00:38,  2.05s/it]
Task 9, Epoch 2/20 => Loss 1.563, Train_accy 47.09:  10%|█         | 2/20 [00:04<00:36,  2.04s/it]
Task 9, Epoch 3/20 => Loss 0.882, Train_accy 74.07:  10%|█         | 2/20 [00:06<00:36,  2.04s/it]
Task 9, Epoch 3/20 => Loss 0.882, Train_accy 74.07:  15%|█▌        | 3/20 [00:06<00:34,  2.01s/it]
Task 9, Epoch 4/20 => Loss 0.534, Train_accy 83.07:  15%|█▌        | 3/20 [00:08<00:34,  2.01s/it]
Task 9, Epoch 4/20 => Loss 0.534, Train_accy 83.07:  20%|██        | 4/20 [00:08<00:32,  2.03s/it]
Task 9, Epoch 5/20 => Loss 0.453, Train_accy 86.77, Test_accy 37.45:  20%|██        | 4/20 [00:18<00:32,  2.03s/it]
Task 9, Epoch 5/20 => Loss 0.453, Train_accy 86.77, Test_accy 37.45:  25%|██▌       | 5/20 [00:18<01:17,  5.16s/it]
Task 9, Epoch 6/20 => Loss 0.279, Train_accy 92.59:  25%|██▌       | 5/20 [00:20<01:17,  5.16s/it]                 
Task 9, Epoch 6/20 => Loss 0.279, Train_accy 92.59:  30%|███       | 6/20 [00:20<00:57,  4.13s/it]
Task 9, Epoch 7/20 => Loss 0.158, Train_accy 96.30:  30%|███       | 6/20 [00:23<00:57,  4.13s/it]
Task 9, Epoch 7/20 => Loss 0.158, Train_accy 96.30:  35%|███▌      | 7/20 [00:23<00:45,  3.49s/it]
Task 9, Epoch 8/20 => Loss 0.213, Train_accy 95.77:  35%|███▌      | 7/20 [00:25<00:45,  3.49s/it]
Task 9, Epoch 8/20 => Loss 0.213, Train_accy 95.77:  40%|████      | 8/20 [00:25<00:36,  3.01s/it]
Task 9, Epoch 9/20 => Loss 0.134, Train_accy 95.24:  40%|████      | 8/20 [00:27<00:36,  3.01s/it]
Task 9, Epoch 9/20 => Loss 0.134, Train_accy 95.24:  45%|████▌     | 9/20 [00:27<00:29,  2.69s/it]
Task 9, Epoch 10/20 => Loss 0.109, Train_accy 97.35, Test_accy 37.45:  45%|████▌     | 9/20 [00:37<00:29,  2.69s/it]
Task 9, Epoch 10/20 => Loss 0.109, Train_accy 97.35, Test_accy 37.45:  50%|█████     | 10/20 [00:37<00:51,  5.13s/it]
Task 9, Epoch 11/20 => Loss 0.084, Train_accy 98.94:  50%|█████     | 10/20 [00:39<00:51,  5.13s/it]                 
Task 9, Epoch 11/20 => Loss 0.084, Train_accy 98.94:  55%|█████▌    | 11/20 [00:39<00:37,  4.18s/it]
Task 9, Epoch 12/20 => Loss 0.088, Train_accy 97.35:  55%|█████▌    | 11/20 [00:41<00:37,  4.18s/it]
Task 9, Epoch 12/20 => Loss 0.088, Train_accy 97.35:  60%|██████    | 12/20 [00:41<00:28,  3.52s/it]
Task 9, Epoch 13/20 => Loss 0.110, Train_accy 97.88:  60%|██████    | 12/20 [00:43<00:28,  3.52s/it]
Task 9, Epoch 13/20 => Loss 0.110, Train_accy 97.88:  65%|██████▌   | 13/20 [00:43<00:21,  3.07s/it]
Task 9, Epoch 14/20 => Loss 0.088, Train_accy 97.35:  65%|██████▌   | 13/20 [00:45<00:21,  3.07s/it]
Task 9, Epoch 14/20 => Loss 0.088, Train_accy 97.35:  70%|███████   | 14/20 [00:45<00:16,  2.76s/it]
Task 9, Epoch 15/20 => Loss 0.094, Train_accy 97.88, Test_accy 37.45:  70%|███████   | 14/20 [00:56<00:16,  2.76s/it]
Task 9, Epoch 15/20 => Loss 0.094, Train_accy 97.88, Test_accy 37.45:  75%|███████▌  | 15/20 [00:56<00:25,  5.12s/it]
Task 9, Epoch 16/20 => Loss 0.088, Train_accy 97.35:  75%|███████▌  | 15/20 [00:58<00:25,  5.12s/it]                 
Task 9, Epoch 16/20 => Loss 0.088, Train_accy 97.35:  80%|████████  | 16/20 [00:58<00:16,  4.20s/it]
Task 9, Epoch 17/20 => Loss 0.065, Train_accy 98.41:  80%|████████  | 16/20 [01:00<00:16,  4.20s/it]
Task 9, Epoch 17/20 => Loss 0.065, Train_accy 98.41:  85%|████████▌ | 17/20 [01:00<00:10,  3.54s/it]
Task 9, Epoch 18/20 => Loss 0.052, Train_accy 98.41:  85%|████████▌ | 17/20 [01:02<00:10,  3.54s/it]
Task 9, Epoch 18/20 => Loss 0.052, Train_accy 98.41:  90%|█████████ | 18/20 [01:02<00:06,  3.09s/it]
Task 9, Epoch 19/20 => Loss 0.047, Train_accy 99.47:  90%|█████████ | 18/20 [01:04<00:06,  3.09s/it]
Task 9, Epoch 19/20 => Loss 0.047, Train_accy 99.47:  95%|█████████▌| 19/20 [01:04<00:02,  2.76s/it]
Task 9, Epoch 20/20 => Loss 0.082, Train_accy 97.35, Test_accy 37.38:  95%|█████████▌| 19/20 [01:15<00:02,  2.76s/it]
Task 9, Epoch 20/20 => Loss 0.082, Train_accy 97.35, Test_accy 37.38: 100%|██████████| 20/20 [01:15<00:00,  5.16s/it]
Task 9, Epoch 20/20 => Loss 0.082, Train_accy 97.35, Test_accy 37.38: 100%|██████████| 20/20 [01:15<00:00,  3.76s/it]
2024-09-12 10:54:35,036 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.082, Train_accy 97.35, Test_accy 37.38
2024-09-12 10:54:43,701 [trainer.py] => No NME accuracy.
2024-09-12 10:54:43,701 [trainer.py] => CNN: {'total': 37.38, '00-99': 56.24, '100-109': 5.0, '110-119': 20.27, '120-129': 3.33, '130-139': 10.47, '140-149': 14.47, '150-159': 13.73, '160-169': 11.76, '170-179': 3.23, '180-189': 10.26, 'old': 38.14, 'new': 10.26}
2024-09-12 10:54:43,701 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83, 45.14, 42.94, 42.07, 40.21, 38.64, 37.38]
2024-09-12 10:54:43,701 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94, 73.95, 72.43, 70.99, 69.39, 67.24, 67.09]

Average Accuracy (CNN): 45.43
2024-09-12 10:54:43,701 [trainer.py] => Average Accuracy (CNN): 45.43 

2024-09-12 10:54:43,702 [trainer.py] => All params: 172158352
2024-09-12 10:54:43,703 [trainer.py] => Trainable params: 407240
2024-09-12 10:54:43,704 [dualprompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.639, Train_accy 22.78:   0%|          | 0/20 [00:03<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.639, Train_accy 22.78:   5%|▌         | 1/20 [00:03<01:03,  3.33s/it]
Task 10, Epoch 2/20 => Loss 1.078, Train_accy 62.72:   5%|▌         | 1/20 [00:06<01:03,  3.33s/it]
Task 10, Epoch 2/20 => Loss 1.078, Train_accy 62.72:  10%|█         | 2/20 [00:06<00:59,  3.33s/it]
Task 10, Epoch 3/20 => Loss 0.553, Train_accy 78.11:  10%|█         | 2/20 [00:09<00:59,  3.33s/it]
Task 10, Epoch 3/20 => Loss 0.553, Train_accy 78.11:  15%|█▌        | 3/20 [00:09<00:56,  3.32s/it]
Task 10, Epoch 4/20 => Loss 0.387, Train_accy 87.28:  15%|█▌        | 3/20 [00:13<00:56,  3.32s/it]
Task 10, Epoch 4/20 => Loss 0.387, Train_accy 87.28:  20%|██        | 4/20 [00:13<00:53,  3.34s/it]
Task 10, Epoch 5/20 => Loss 0.215, Train_accy 92.01, Test_accy 35.75:  20%|██        | 4/20 [00:25<00:53,  3.34s/it]
Task 10, Epoch 5/20 => Loss 0.215, Train_accy 92.01, Test_accy 35.75:  25%|██▌       | 5/20 [00:25<01:36,  6.42s/it]
Task 10, Epoch 6/20 => Loss 0.262, Train_accy 91.42:  25%|██▌       | 5/20 [00:28<01:36,  6.42s/it]                 
Task 10, Epoch 6/20 => Loss 0.262, Train_accy 91.42:  30%|███       | 6/20 [00:28<01:13,  5.27s/it]
Task 10, Epoch 7/20 => Loss 0.152, Train_accy 94.67:  30%|███       | 6/20 [00:31<01:13,  5.27s/it]
Task 10, Epoch 7/20 => Loss 0.152, Train_accy 94.67:  35%|███▌      | 7/20 [00:31<00:59,  4.57s/it]
Task 10, Epoch 8/20 => Loss 0.160, Train_accy 93.79:  35%|███▌      | 7/20 [00:34<00:59,  4.57s/it]
Task 10, Epoch 8/20 => Loss 0.160, Train_accy 93.79:  40%|████      | 8/20 [00:34<00:48,  4.08s/it]
Task 10, Epoch 9/20 => Loss 0.118, Train_accy 96.15:  40%|████      | 8/20 [00:37<00:48,  4.08s/it]
Task 10, Epoch 9/20 => Loss 0.118, Train_accy 96.15:  45%|████▌     | 9/20 [00:37<00:41,  3.75s/it]
Task 10, Epoch 10/20 => Loss 0.109, Train_accy 94.97, Test_accy 35.88:  45%|████▌     | 9/20 [00:49<00:41,  3.75s/it]
Task 10, Epoch 10/20 => Loss 0.109, Train_accy 94.97, Test_accy 35.88:  50%|█████     | 10/20 [00:49<01:01,  6.17s/it]
Task 10, Epoch 11/20 => Loss 0.134, Train_accy 93.79:  50%|█████     | 10/20 [00:52<01:01,  6.17s/it]                 
Task 10, Epoch 11/20 => Loss 0.134, Train_accy 93.79:  55%|█████▌    | 11/20 [00:52<00:48,  5.36s/it]
Task 10, Epoch 12/20 => Loss 0.064, Train_accy 97.34:  55%|█████▌    | 11/20 [00:55<00:48,  5.36s/it]
Task 10, Epoch 12/20 => Loss 0.064, Train_accy 97.34:  60%|██████    | 12/20 [00:55<00:38,  4.76s/it]
Task 10, Epoch 13/20 => Loss 0.195, Train_accy 97.04:  60%|██████    | 12/20 [00:59<00:38,  4.76s/it]
Task 10, Epoch 13/20 => Loss 0.195, Train_accy 97.04:  65%|██████▌   | 13/20 [00:59<00:30,  4.31s/it]
Task 10, Epoch 14/20 => Loss 0.081, Train_accy 96.15:  65%|██████▌   | 13/20 [01:02<00:30,  4.31s/it]
Task 10, Epoch 14/20 => Loss 0.081, Train_accy 96.15:  70%|███████   | 14/20 [01:02<00:24,  4.00s/it]
Task 10, Epoch 15/20 => Loss 0.074, Train_accy 95.56, Test_accy 36.14:  70%|███████   | 14/20 [01:14<00:24,  4.00s/it]
Task 10, Epoch 15/20 => Loss 0.074, Train_accy 95.56, Test_accy 36.14:  75%|███████▌  | 15/20 [01:14<00:32,  6.53s/it]
Task 10, Epoch 16/20 => Loss 0.092, Train_accy 97.04:  75%|███████▌  | 15/20 [01:18<00:32,  6.53s/it]                 
Task 10, Epoch 16/20 => Loss 0.092, Train_accy 97.04:  80%|████████  | 16/20 [01:18<00:22,  5.59s/it]
Task 10, Epoch 17/20 => Loss 0.042, Train_accy 97.93:  80%|████████  | 16/20 [01:21<00:22,  5.59s/it]
Task 10, Epoch 17/20 => Loss 0.042, Train_accy 97.93:  85%|████████▌ | 17/20 [01:21<00:14,  4.95s/it]
Task 10, Epoch 18/20 => Loss 0.031, Train_accy 98.82:  85%|████████▌ | 17/20 [01:25<00:14,  4.95s/it]
Task 10, Epoch 18/20 => Loss 0.031, Train_accy 98.82:  90%|█████████ | 18/20 [01:25<00:08,  4.46s/it]
Task 10, Epoch 19/20 => Loss 0.057, Train_accy 97.04:  90%|█████████ | 18/20 [01:28<00:08,  4.46s/it]
Task 10, Epoch 19/20 => Loss 0.057, Train_accy 97.04:  95%|█████████▌| 19/20 [01:28<00:04,  4.11s/it]
Task 10, Epoch 20/20 => Loss 0.044, Train_accy 98.22, Test_accy 36.27:  95%|█████████▌| 19/20 [01:40<00:04,  4.11s/it]
Task 10, Epoch 20/20 => Loss 0.044, Train_accy 98.22, Test_accy 36.27: 100%|██████████| 20/20 [01:40<00:00,  6.59s/it]
Task 10, Epoch 20/20 => Loss 0.044, Train_accy 98.22, Test_accy 36.27: 100%|██████████| 20/20 [01:40<00:00,  5.04s/it]
2024-09-12 10:56:24,451 [dualprompt.py] => Task 10, Epoch 20/20 => Loss 0.044, Train_accy 98.22, Test_accy 36.27
2024-09-12 10:56:33,583 [trainer.py] => No NME accuracy.
2024-09-12 10:56:33,583 [trainer.py] => CNN: {'total': 36.27, '00-99': 56.84, '100-109': 3.33, '110-119': 20.27, '120-129': 3.33, '130-139': 10.47, '140-149': 15.79, '150-159': 13.73, '160-169': 10.59, '170-179': 1.61, '180-189': 10.26, '190-199': 14.12, 'old': 37.59, 'new': 14.12}
2024-09-12 10:56:33,584 [trainer.py] => CNN top1 curve: [56.48, 52.61, 50.97, 47.83, 45.14, 42.94, 42.07, 40.21, 38.64, 37.38, 36.27]
2024-09-12 10:56:33,584 [trainer.py] => CNN top5 curve: [81.81, 80.47, 78.56, 75.94, 73.95, 72.43, 70.99, 69.39, 67.24, 67.09, 64.85]

Average Accuracy (CNN): 44.59
2024-09-12 10:56:33,584 [trainer.py] => Average Accuracy (CNN): 44.59 

Accuracy Matrix (CNN):
[[56.48 56.12 56.96 56.48 56.72 56.24 56.72 56.72 57.19 56.24 56.84]
 [ 0.    3.33  3.33  3.33  3.33  3.33  3.33  3.33  3.33  5.    3.33]
 [ 0.    0.   21.62 21.62 21.62 18.92 20.27 20.27 18.92 20.27 20.27]
 [ 0.    0.    0.    3.33  3.33  3.33  3.33  3.33  3.33  3.33  3.33]
 [ 0.    0.    0.    0.   10.47 10.47 10.47 10.47 10.47 10.47 10.47]
 [ 0.    0.    0.    0.    0.   18.42 15.79 17.11 15.79 14.47 15.79]
 [ 0.    0.    0.    0.    0.    0.   15.69 15.69 15.69 13.73 13.73]
 [ 0.    0.    0.    0.    0.    0.    0.   11.76 11.76 11.76 10.59]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    1.61  3.23  1.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   10.26 10.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   14.12]]
2024-09-12 10:56:33,585 [trainer.py] => Forgetting (CNN): 1.0749999999999997
2024-09-07 12:30:20,179 [trainer.py] => config: ./exps/coda_prompt_ina_B0_Inc5.json
2024-09-07 12:30:20,179 [trainer.py] => prefix:  
2024-09-07 12:30:20,179 [trainer.py] => dataset: imageneta
2024-09-07 12:30:20,179 [trainer.py] => memory_size: 0
2024-09-07 12:30:20,179 [trainer.py] => memory_per_class: 0
2024-09-07 12:30:20,179 [trainer.py] => fixed_memory: False
2024-09-07 12:30:20,179 [trainer.py] => shuffle: True
2024-09-07 12:30:20,179 [trainer.py] => init_cls: 40
2024-09-07 12:30:20,179 [trainer.py] => increment: 40
2024-09-07 12:30:20,179 [trainer.py] => model_name: coda_prompt
2024-09-07 12:30:20,179 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-07 12:30:20,179 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 12:30:20,179 [trainer.py] => seed: 1993
2024-09-07 12:30:20,179 [trainer.py] => tuned_epoch: 20
2024-09-07 12:30:20,179 [trainer.py] => init_lr: 0.001
2024-09-07 12:30:20,179 [trainer.py] => batch_size: 48
2024-09-07 12:30:20,179 [trainer.py] => weight_decay: 0
2024-09-07 12:30:20,179 [trainer.py] => min_lr: 1e-05
2024-09-07 12:30:20,179 [trainer.py] => optimizer: adam
2024-09-07 12:30:20,179 [trainer.py] => scheduler: cosine
2024-09-07 12:30:20,179 [trainer.py] => reinit_optimizer: True
2024-09-07 12:30:20,179 [trainer.py] => pretrained: True
2024-09-07 12:30:20,179 [trainer.py] => drop: 0.0
2024-09-07 12:30:20,179 [trainer.py] => drop_path: 0.0
2024-09-07 12:30:20,179 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-07 12:30:20,205 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 12:30:22,086 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-07 12:30:22,087 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-07 12:30:22,087 [trainer.py] => All params: 89792456
2024-09-07 12:30:22,088 [trainer.py] => Trainable params: 89792456
2024-09-07 12:30:22,088 [coda_prompt.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.877, Train_accy 30.14:   0%|          | 0/20 [00:16<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.877, Train_accy 30.14:   5%|▌         | 1/20 [00:16<05:06, 16.13s/it]
Task 0, Epoch 2/20 => Loss 1.312, Train_accy 67.29:   5%|▌         | 1/20 [00:31<05:06, 16.13s/it]
Task 0, Epoch 2/20 => Loss 1.312, Train_accy 67.29:  10%|█         | 2/20 [00:31<04:47, 15.96s/it]
Task 0, Epoch 3/20 => Loss 0.835, Train_accy 78.54:  10%|█         | 2/20 [00:47<04:47, 15.96s/it]
Task 0, Epoch 3/20 => Loss 0.835, Train_accy 78.54:  15%|█▌        | 3/20 [00:47<04:30, 15.94s/it]
Task 0, Epoch 4/20 => Loss 0.530, Train_accy 85.00:  15%|█▌        | 3/20 [01:03<04:30, 15.94s/it]
Task 0, Epoch 4/20 => Loss 0.530, Train_accy 85.00:  20%|██        | 4/20 [01:03<04:15, 15.94s/it]
Task 0, Epoch 5/20 => Loss 0.478, Train_accy 86.32, Test_accy 73.89:  20%|██        | 4/20 [01:22<04:15, 15.94s/it]
Task 0, Epoch 5/20 => Loss 0.478, Train_accy 86.32, Test_accy 73.89:  25%|██▌       | 5/20 [01:22<04:12, 16.86s/it]
Task 0, Epoch 6/20 => Loss 0.376, Train_accy 88.47:  25%|██▌       | 5/20 [01:38<04:12, 16.86s/it]                 
Task 0, Epoch 6/20 => Loss 0.376, Train_accy 88.47:  30%|███       | 6/20 [01:38<03:51, 16.57s/it]
Task 0, Epoch 7/20 => Loss 0.337, Train_accy 90.62:  30%|███       | 6/20 [01:54<03:51, 16.57s/it]
Task 0, Epoch 7/20 => Loss 0.337, Train_accy 90.62:  35%|███▌      | 7/20 [01:54<03:33, 16.39s/it]
Task 0, Epoch 8/20 => Loss 0.305, Train_accy 91.11:  35%|███▌      | 7/20 [02:10<03:33, 16.39s/it]
Task 0, Epoch 8/20 => Loss 0.305, Train_accy 91.11:  40%|████      | 8/20 [02:10<03:15, 16.29s/it]
Task 0, Epoch 9/20 => Loss 0.308, Train_accy 91.39:  40%|████      | 8/20 [02:26<03:15, 16.29s/it]
Task 0, Epoch 9/20 => Loss 0.308, Train_accy 91.39:  45%|████▌     | 9/20 [02:26<02:58, 16.25s/it]
Task 0, Epoch 10/20 => Loss 0.218, Train_accy 94.03, Test_accy 75.83:  45%|████▌     | 9/20 [02:45<02:58, 16.25s/it]
Task 0, Epoch 10/20 => Loss 0.218, Train_accy 94.03, Test_accy 75.83:  50%|█████     | 10/20 [02:45<02:49, 16.95s/it]
Task 0, Epoch 11/20 => Loss 0.233, Train_accy 93.54:  50%|█████     | 10/20 [03:01<02:49, 16.95s/it]                 
Task 0, Epoch 11/20 => Loss 0.233, Train_accy 93.54:  55%|█████▌    | 11/20 [03:01<02:30, 16.68s/it]
Task 0, Epoch 12/20 => Loss 0.236, Train_accy 93.33:  55%|█████▌    | 11/20 [03:17<02:30, 16.68s/it]
Task 0, Epoch 12/20 => Loss 0.236, Train_accy 93.33:  60%|██████    | 12/20 [03:17<02:11, 16.49s/it]
Task 0, Epoch 13/20 => Loss 0.183, Train_accy 95.00:  60%|██████    | 12/20 [03:33<02:11, 16.49s/it]
Task 0, Epoch 13/20 => Loss 0.183, Train_accy 95.00:  65%|██████▌   | 13/20 [03:33<01:54, 16.36s/it]
Task 0, Epoch 14/20 => Loss 0.240, Train_accy 92.57:  65%|██████▌   | 13/20 [03:49<01:54, 16.36s/it]
Task 0, Epoch 14/20 => Loss 0.240, Train_accy 92.57:  70%|███████   | 14/20 [03:49<01:37, 16.27s/it]
Task 0, Epoch 15/20 => Loss 0.212, Train_accy 93.68, Test_accy 73.33:  70%|███████   | 14/20 [04:07<01:37, 16.27s/it]
Task 0, Epoch 15/20 => Loss 0.212, Train_accy 93.68, Test_accy 73.33:  75%|███████▌  | 15/20 [04:07<01:24, 16.96s/it]
Task 0, Epoch 16/20 => Loss 0.184, Train_accy 95.07:  75%|███████▌  | 15/20 [04:23<01:24, 16.96s/it]                 
Task 0, Epoch 16/20 => Loss 0.184, Train_accy 95.07:  80%|████████  | 16/20 [04:23<01:06, 16.69s/it]
Task 0, Epoch 17/20 => Loss 0.210, Train_accy 94.31:  80%|████████  | 16/20 [04:40<01:06, 16.69s/it]
Task 0, Epoch 17/20 => Loss 0.210, Train_accy 94.31:  85%|████████▌ | 17/20 [04:40<00:49, 16.52s/it]
Task 0, Epoch 18/20 => Loss 0.198, Train_accy 94.65:  85%|████████▌ | 17/20 [04:56<00:49, 16.52s/it]
Task 0, Epoch 18/20 => Loss 0.198, Train_accy 94.65:  90%|█████████ | 18/20 [04:56<00:32, 16.39s/it]
Task 0, Epoch 19/20 => Loss 0.174, Train_accy 94.93:  90%|█████████ | 18/20 [05:12<00:32, 16.39s/it]
Task 0, Epoch 19/20 => Loss 0.174, Train_accy 94.93:  95%|█████████▌| 19/20 [05:12<00:16, 16.30s/it]
Task 0, Epoch 20/20 => Loss 0.197, Train_accy 94.72, Test_accy 75.00:  95%|█████████▌| 19/20 [05:30<00:16, 16.30s/it]
Task 0, Epoch 20/20 => Loss 0.197, Train_accy 94.72, Test_accy 75.00: 100%|██████████| 20/20 [05:30<00:00, 16.98s/it]
Task 0, Epoch 20/20 => Loss 0.197, Train_accy 94.72, Test_accy 75.00: 100%|██████████| 20/20 [05:30<00:00, 16.54s/it]
2024-09-07 12:35:53,411 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.197, Train_accy 94.72, Test_accy 75.00
2024-09-07 12:35:55,952 [trainer.py] => No NME accuracy.
2024-09-07 12:35:55,953 [trainer.py] => CNN: {'total': 75.0, '00-39': 75.0, 'old': 0, 'new': 75.0}
2024-09-07 12:35:55,953 [trainer.py] => CNN top1 curve: [75.0]
2024-09-07 12:35:55,953 [trainer.py] => CNN top5 curve: [92.78]

Average Accuracy (CNN): 75.0
2024-09-07 12:35:55,954 [trainer.py] => Average Accuracy (CNN): 75.0 

2024-09-07 12:35:55,955 [trainer.py] => All params: 89792456
2024-09-07 12:35:55,957 [trainer.py] => Trainable params: 89792456
2024-09-07 12:35:57,176 [coda_prompt.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.007, Train_accy 28.53:   0%|          | 0/20 [00:14<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.007, Train_accy 28.53:   5%|▌         | 1/20 [00:14<04:26, 14.04s/it]
Task 1, Epoch 2/20 => Loss 1.046, Train_accy 71.47:   5%|▌         | 1/20 [00:28<04:26, 14.04s/it]
Task 1, Epoch 2/20 => Loss 1.046, Train_accy 71.47:  10%|█         | 2/20 [00:28<04:12, 14.03s/it]
Task 1, Epoch 3/20 => Loss 0.657, Train_accy 82.45:  10%|█         | 2/20 [00:42<04:12, 14.03s/it]
Task 1, Epoch 3/20 => Loss 0.657, Train_accy 82.45:  15%|█▌        | 3/20 [00:42<03:58, 14.03s/it]
Task 1, Epoch 4/20 => Loss 0.447, Train_accy 87.98:  15%|█▌        | 3/20 [00:56<03:58, 14.03s/it]
Task 1, Epoch 4/20 => Loss 0.447, Train_accy 87.98:  20%|██        | 4/20 [00:56<03:45, 14.12s/it]
Task 1, Epoch 5/20 => Loss 0.417, Train_accy 88.94, Test_accy 58.45:  20%|██        | 4/20 [01:14<03:45, 14.12s/it]
Task 1, Epoch 5/20 => Loss 0.417, Train_accy 88.94, Test_accy 58.45:  25%|██▌       | 5/20 [01:14<03:54, 15.67s/it]
Task 1, Epoch 6/20 => Loss 0.339, Train_accy 90.22:  25%|██▌       | 5/20 [01:28<03:54, 15.67s/it]                 
Task 1, Epoch 6/20 => Loss 0.339, Train_accy 90.22:  30%|███       | 6/20 [01:28<03:31, 15.09s/it]
Task 1, Epoch 7/20 => Loss 0.339, Train_accy 90.30:  30%|███       | 6/20 [01:42<03:31, 15.09s/it]
Task 1, Epoch 7/20 => Loss 0.339, Train_accy 90.30:  35%|███▌      | 7/20 [01:42<03:11, 14.74s/it]
Task 1, Epoch 8/20 => Loss 0.334, Train_accy 91.59:  35%|███▌      | 7/20 [01:56<03:11, 14.74s/it]
Task 1, Epoch 8/20 => Loss 0.334, Train_accy 91.59:  40%|████      | 8/20 [01:56<02:54, 14.51s/it]
Task 1, Epoch 9/20 => Loss 0.266, Train_accy 92.15:  40%|████      | 8/20 [02:10<02:54, 14.51s/it]
Task 1, Epoch 9/20 => Loss 0.266, Train_accy 92.15:  45%|████▌     | 9/20 [02:10<02:37, 14.35s/it]
Task 1, Epoch 10/20 => Loss 0.229, Train_accy 93.83, Test_accy 61.75:  45%|████▌     | 9/20 [02:29<02:37, 14.35s/it]
Task 1, Epoch 10/20 => Loss 0.229, Train_accy 93.83, Test_accy 61.75:  50%|█████     | 10/20 [02:29<02:36, 15.61s/it]
Task 1, Epoch 11/20 => Loss 0.216, Train_accy 93.91:  50%|█████     | 10/20 [02:43<02:36, 15.61s/it]                 
Task 1, Epoch 11/20 => Loss 0.216, Train_accy 93.91:  55%|█████▌    | 11/20 [02:43<02:16, 15.14s/it]
Task 1, Epoch 12/20 => Loss 0.199, Train_accy 95.03:  55%|█████▌    | 11/20 [02:57<02:16, 15.14s/it]
Task 1, Epoch 12/20 => Loss 0.199, Train_accy 95.03:  60%|██████    | 12/20 [02:57<01:58, 14.80s/it]
Task 1, Epoch 13/20 => Loss 0.242, Train_accy 93.51:  60%|██████    | 12/20 [03:11<01:58, 14.80s/it]
Task 1, Epoch 13/20 => Loss 0.242, Train_accy 93.51:  65%|██████▌   | 13/20 [03:11<01:41, 14.56s/it]
Task 1, Epoch 14/20 => Loss 0.228, Train_accy 93.67:  65%|██████▌   | 13/20 [03:25<01:41, 14.56s/it]
Task 1, Epoch 14/20 => Loss 0.228, Train_accy 93.67:  70%|███████   | 14/20 [03:25<01:26, 14.41s/it]
Task 1, Epoch 15/20 => Loss 0.223, Train_accy 93.75, Test_accy 63.90:  70%|███████   | 14/20 [03:43<01:26, 14.41s/it]
Task 1, Epoch 15/20 => Loss 0.223, Train_accy 93.75, Test_accy 63.90:  75%|███████▌  | 15/20 [03:43<01:18, 15.63s/it]
Task 1, Epoch 16/20 => Loss 0.190, Train_accy 95.11:  75%|███████▌  | 15/20 [03:57<01:18, 15.63s/it]                 
Task 1, Epoch 16/20 => Loss 0.190, Train_accy 95.11:  80%|████████  | 16/20 [03:57<01:00, 15.14s/it]
Task 1, Epoch 17/20 => Loss 0.192, Train_accy 94.47:  80%|████████  | 16/20 [04:11<01:00, 15.14s/it]
Task 1, Epoch 17/20 => Loss 0.192, Train_accy 94.47:  85%|████████▌ | 17/20 [04:11<00:44, 14.81s/it]
Task 1, Epoch 18/20 => Loss 0.199, Train_accy 95.19:  85%|████████▌ | 17/20 [04:25<00:44, 14.81s/it]
Task 1, Epoch 18/20 => Loss 0.199, Train_accy 95.19:  90%|█████████ | 18/20 [04:25<00:29, 14.57s/it]
Task 1, Epoch 19/20 => Loss 0.178, Train_accy 94.87:  90%|█████████ | 18/20 [04:39<00:29, 14.57s/it]
Task 1, Epoch 19/20 => Loss 0.178, Train_accy 94.87:  95%|█████████▌| 19/20 [04:39<00:14, 14.41s/it]
Task 1, Epoch 20/20 => Loss 0.196, Train_accy 94.47, Test_accy 64.61:  95%|█████████▌| 19/20 [04:58<00:14, 14.41s/it]
Task 1, Epoch 20/20 => Loss 0.196, Train_accy 94.47, Test_accy 64.61: 100%|██████████| 20/20 [04:58<00:00, 15.61s/it]
Task 1, Epoch 20/20 => Loss 0.196, Train_accy 94.47, Test_accy 64.61: 100%|██████████| 20/20 [04:58<00:00, 14.92s/it]
2024-09-07 12:40:55,494 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.196, Train_accy 94.47, Test_accy 64.61
2024-09-07 12:40:59,872 [trainer.py] => No NME accuracy.
2024-09-07 12:40:59,873 [trainer.py] => CNN: {'total': 64.61, '00-39': 71.11, '40-79': 57.69, 'old': 71.11, 'new': 57.69}
2024-09-07 12:40:59,873 [trainer.py] => CNN top1 curve: [75.0, 64.61]
2024-09-07 12:40:59,873 [trainer.py] => CNN top5 curve: [92.78, 87.97]

Average Accuracy (CNN): 69.81
2024-09-07 12:40:59,873 [trainer.py] => Average Accuracy (CNN): 69.81 

2024-09-07 12:40:59,874 [trainer.py] => All params: 89792456
2024-09-07 12:40:59,875 [trainer.py] => Trainable params: 89792456
2024-09-07 12:41:01,922 [coda_prompt.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.131, Train_accy 28.97:   0%|          | 0/20 [00:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.131, Train_accy 28.97:   5%|▌         | 1/20 [00:11<03:36, 11.42s/it]
Task 2, Epoch 2/20 => Loss 1.118, Train_accy 69.74:   5%|▌         | 1/20 [00:22<03:36, 11.42s/it]
Task 2, Epoch 2/20 => Loss 1.118, Train_accy 69.74:  10%|█         | 2/20 [00:22<03:25, 11.42s/it]
Task 2, Epoch 3/20 => Loss 0.568, Train_accy 84.52:  10%|█         | 2/20 [00:34<03:25, 11.42s/it]
Task 2, Epoch 3/20 => Loss 0.568, Train_accy 84.52:  15%|█▌        | 3/20 [00:34<03:13, 11.41s/it]
Task 2, Epoch 4/20 => Loss 0.502, Train_accy 85.71:  15%|█▌        | 3/20 [00:45<03:13, 11.41s/it]
Task 2, Epoch 4/20 => Loss 0.502, Train_accy 85.71:  20%|██        | 4/20 [00:45<03:02, 11.41s/it]
Task 2, Epoch 5/20 => Loss 0.390, Train_accy 89.29, Test_accy 56.72:  20%|██        | 4/20 [01:02<03:02, 11.41s/it]
Task 2, Epoch 5/20 => Loss 0.390, Train_accy 89.29, Test_accy 56.72:  25%|██▌       | 5/20 [01:02<03:23, 13.55s/it]
Task 2, Epoch 6/20 => Loss 0.334, Train_accy 90.08:  25%|██▌       | 5/20 [01:14<03:23, 13.55s/it]                 
Task 2, Epoch 6/20 => Loss 0.334, Train_accy 90.08:  30%|███       | 6/20 [01:14<02:59, 12.82s/it]
Task 2, Epoch 7/20 => Loss 0.286, Train_accy 91.37:  30%|███       | 6/20 [01:25<02:59, 12.82s/it]
Task 2, Epoch 7/20 => Loss 0.286, Train_accy 91.37:  35%|███▌      | 7/20 [01:25<02:40, 12.36s/it]
Task 2, Epoch 8/20 => Loss 0.247, Train_accy 92.96:  35%|███▌      | 7/20 [01:37<02:40, 12.36s/it]
Task 2, Epoch 8/20 => Loss 0.247, Train_accy 92.96:  40%|████      | 8/20 [01:37<02:24, 12.06s/it]
Task 2, Epoch 9/20 => Loss 0.236, Train_accy 94.05:  40%|████      | 8/20 [01:48<02:24, 12.06s/it]
Task 2, Epoch 9/20 => Loss 0.236, Train_accy 94.05:  45%|████▌     | 9/20 [01:48<02:10, 11.87s/it]
Task 2, Epoch 10/20 => Loss 0.238, Train_accy 93.06, Test_accy 57.85:  45%|████▌     | 9/20 [02:06<02:10, 11.87s/it]
Task 2, Epoch 10/20 => Loss 0.238, Train_accy 93.06, Test_accy 57.85:  50%|█████     | 10/20 [02:06<02:15, 13.56s/it]
Task 2, Epoch 11/20 => Loss 0.238, Train_accy 92.86:  50%|█████     | 10/20 [02:17<02:15, 13.56s/it]                 
Task 2, Epoch 11/20 => Loss 0.238, Train_accy 92.86:  55%|█████▌    | 11/20 [02:17<01:56, 12.93s/it]
Task 2, Epoch 12/20 => Loss 0.174, Train_accy 94.84:  55%|█████▌    | 11/20 [02:28<01:56, 12.93s/it]
Task 2, Epoch 12/20 => Loss 0.174, Train_accy 94.84:  60%|██████    | 12/20 [02:28<01:39, 12.47s/it]
Task 2, Epoch 13/20 => Loss 0.171, Train_accy 95.24:  60%|██████    | 12/20 [02:40<01:39, 12.47s/it]
Task 2, Epoch 13/20 => Loss 0.171, Train_accy 95.24:  65%|██████▌   | 13/20 [02:40<01:25, 12.16s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 95.93:  65%|██████▌   | 13/20 [02:51<01:25, 12.16s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 95.93:  70%|███████   | 14/20 [02:51<01:11, 11.94s/it]
Task 2, Epoch 15/20 => Loss 0.174, Train_accy 95.24, Test_accy 58.97:  70%|███████   | 14/20 [03:09<01:11, 11.94s/it]
Task 2, Epoch 15/20 => Loss 0.174, Train_accy 95.24, Test_accy 58.97:  75%|███████▌  | 15/20 [03:09<01:07, 13.59s/it]
Task 2, Epoch 16/20 => Loss 0.142, Train_accy 96.03:  75%|███████▌  | 15/20 [03:20<01:07, 13.59s/it]                 
Task 2, Epoch 16/20 => Loss 0.142, Train_accy 96.03:  80%|████████  | 16/20 [03:20<00:51, 12.94s/it]
Task 2, Epoch 17/20 => Loss 0.157, Train_accy 95.54:  80%|████████  | 16/20 [03:32<00:51, 12.94s/it]
Task 2, Epoch 17/20 => Loss 0.157, Train_accy 95.54:  85%|████████▌ | 17/20 [03:32<00:37, 12.48s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 96.92:  85%|████████▌ | 17/20 [03:43<00:37, 12.48s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 96.92:  90%|█████████ | 18/20 [03:43<00:24, 12.17s/it]
Task 2, Epoch 19/20 => Loss 0.146, Train_accy 95.93:  90%|█████████ | 18/20 [03:54<00:24, 12.17s/it]
Task 2, Epoch 19/20 => Loss 0.146, Train_accy 95.93:  95%|█████████▌| 19/20 [03:54<00:11, 11.95s/it]
Task 2, Epoch 20/20 => Loss 0.155, Train_accy 96.23, Test_accy 58.77:  95%|█████████▌| 19/20 [04:12<00:11, 11.95s/it]
Task 2, Epoch 20/20 => Loss 0.155, Train_accy 96.23, Test_accy 58.77: 100%|██████████| 20/20 [04:12<00:00, 13.58s/it]
Task 2, Epoch 20/20 => Loss 0.155, Train_accy 96.23, Test_accy 58.77: 100%|██████████| 20/20 [04:12<00:00, 12.62s/it]
2024-09-07 12:45:14,274 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.155, Train_accy 96.23, Test_accy 58.77
2024-09-07 12:45:20,188 [trainer.py] => No NME accuracy.
2024-09-07 12:45:20,189 [trainer.py] => CNN: {'total': 58.77, '00-39': 69.17, '40-79': 54.44, '80-119': 50.54, 'old': 62.03, 'new': 50.54}
2024-09-07 12:45:20,189 [trainer.py] => CNN top1 curve: [75.0, 64.61, 58.77]
2024-09-07 12:45:20,189 [trainer.py] => CNN top5 curve: [92.78, 87.97, 83.49]

Average Accuracy (CNN): 66.13
2024-09-07 12:45:20,189 [trainer.py] => Average Accuracy (CNN): 66.13 

2024-09-07 12:45:20,191 [trainer.py] => All params: 89792456
2024-09-07 12:45:20,192 [trainer.py] => Trainable params: 89792456
2024-09-07 12:45:22,978 [coda_prompt.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.488, Train_accy 23.30:   0%|          | 0/20 [00:11<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.488, Train_accy 23.30:   5%|▌         | 1/20 [00:11<03:46, 11.92s/it]
Task 3, Epoch 2/20 => Loss 1.248, Train_accy 67.99:   5%|▌         | 1/20 [00:23<03:46, 11.92s/it]
Task 3, Epoch 2/20 => Loss 1.248, Train_accy 67.99:  10%|█         | 2/20 [00:23<03:34, 11.90s/it]
Task 3, Epoch 3/20 => Loss 0.727, Train_accy 81.53:  10%|█         | 2/20 [00:35<03:34, 11.90s/it]
Task 3, Epoch 3/20 => Loss 0.727, Train_accy 81.53:  15%|█▌        | 3/20 [00:35<03:22, 11.93s/it]
Task 3, Epoch 4/20 => Loss 0.473, Train_accy 86.27:  15%|█▌        | 3/20 [00:47<03:22, 11.93s/it]
Task 3, Epoch 4/20 => Loss 0.473, Train_accy 86.27:  20%|██        | 4/20 [00:47<03:10, 11.93s/it]
Task 3, Epoch 5/20 => Loss 0.353, Train_accy 91.48, Test_accy 53.37:  20%|██        | 4/20 [01:07<03:10, 11.93s/it]
Task 3, Epoch 5/20 => Loss 0.353, Train_accy 91.48, Test_accy 53.37:  25%|██▌       | 5/20 [01:07<03:39, 14.66s/it]
Task 3, Epoch 6/20 => Loss 0.318, Train_accy 92.80:  25%|██▌       | 5/20 [01:19<03:39, 14.66s/it]                 
Task 3, Epoch 6/20 => Loss 0.318, Train_accy 92.80:  30%|███       | 6/20 [01:19<03:12, 13.75s/it]
Task 3, Epoch 7/20 => Loss 0.314, Train_accy 91.48:  30%|███       | 6/20 [01:31<03:12, 13.75s/it]
Task 3, Epoch 7/20 => Loss 0.314, Train_accy 91.48:  35%|███▌      | 7/20 [01:31<02:51, 13.20s/it]
Task 3, Epoch 8/20 => Loss 0.217, Train_accy 94.79:  35%|███▌      | 7/20 [01:43<02:51, 13.20s/it]
Task 3, Epoch 8/20 => Loss 0.217, Train_accy 94.79:  40%|████      | 8/20 [01:43<02:33, 12.81s/it]
Task 3, Epoch 9/20 => Loss 0.264, Train_accy 93.66:  40%|████      | 8/20 [01:55<02:33, 12.81s/it]
Task 3, Epoch 9/20 => Loss 0.264, Train_accy 93.66:  45%|████▌     | 9/20 [01:55<02:17, 12.53s/it]
Task 3, Epoch 10/20 => Loss 0.221, Train_accy 94.60, Test_accy 54.25:  45%|████▌     | 9/20 [02:14<02:17, 12.53s/it]
Task 3, Epoch 10/20 => Loss 0.221, Train_accy 94.60, Test_accy 54.25:  50%|█████     | 10/20 [02:14<02:26, 14.64s/it]
Task 3, Epoch 11/20 => Loss 0.202, Train_accy 95.36:  50%|█████     | 10/20 [02:26<02:26, 14.64s/it]                 
Task 3, Epoch 11/20 => Loss 0.202, Train_accy 95.36:  55%|█████▌    | 11/20 [02:26<02:04, 13.83s/it]
Task 3, Epoch 12/20 => Loss 0.206, Train_accy 95.36:  55%|█████▌    | 11/20 [02:38<02:04, 13.83s/it]
Task 3, Epoch 12/20 => Loss 0.206, Train_accy 95.36:  60%|██████    | 12/20 [02:38<01:46, 13.26s/it]
Task 3, Epoch 13/20 => Loss 0.158, Train_accy 96.31:  60%|██████    | 12/20 [02:50<01:46, 13.26s/it]
Task 3, Epoch 13/20 => Loss 0.158, Train_accy 96.31:  65%|██████▌   | 13/20 [02:50<01:30, 12.86s/it]
Task 3, Epoch 14/20 => Loss 0.176, Train_accy 95.74:  65%|██████▌   | 13/20 [03:02<01:30, 12.86s/it]
Task 3, Epoch 14/20 => Loss 0.176, Train_accy 95.74:  70%|███████   | 14/20 [03:02<01:15, 12.58s/it]
Task 3, Epoch 15/20 => Loss 0.165, Train_accy 95.83, Test_accy 54.57:  70%|███████   | 14/20 [03:21<01:15, 12.58s/it]
Task 3, Epoch 15/20 => Loss 0.165, Train_accy 95.83, Test_accy 54.57:  75%|███████▌  | 15/20 [03:21<01:13, 14.66s/it]
Task 3, Epoch 16/20 => Loss 0.178, Train_accy 95.93:  75%|███████▌  | 15/20 [03:33<01:13, 14.66s/it]                 
Task 3, Epoch 16/20 => Loss 0.178, Train_accy 95.93:  80%|████████  | 16/20 [03:33<00:55, 13.88s/it]
Task 3, Epoch 17/20 => Loss 0.180, Train_accy 95.64:  80%|████████  | 16/20 [03:45<00:55, 13.88s/it]
Task 3, Epoch 17/20 => Loss 0.180, Train_accy 95.64:  85%|████████▌ | 17/20 [03:45<00:39, 13.31s/it]
Task 3, Epoch 18/20 => Loss 0.146, Train_accy 96.69:  85%|████████▌ | 17/20 [03:57<00:39, 13.31s/it]
Task 3, Epoch 18/20 => Loss 0.146, Train_accy 96.69:  90%|█████████ | 18/20 [03:57<00:25, 12.88s/it]
Task 3, Epoch 19/20 => Loss 0.165, Train_accy 95.45:  90%|█████████ | 18/20 [04:09<00:25, 12.88s/it]
Task 3, Epoch 19/20 => Loss 0.165, Train_accy 95.45:  95%|█████████▌| 19/20 [04:09<00:12, 12.61s/it]
Task 3, Epoch 20/20 => Loss 0.147, Train_accy 96.50, Test_accy 54.89:  95%|█████████▌| 19/20 [04:29<00:12, 12.61s/it]
Task 3, Epoch 20/20 => Loss 0.147, Train_accy 96.50, Test_accy 54.89: 100%|██████████| 20/20 [04:29<00:00, 14.67s/it]
Task 3, Epoch 20/20 => Loss 0.147, Train_accy 96.50, Test_accy 54.89: 100%|██████████| 20/20 [04:29<00:00, 13.46s/it]
2024-09-07 12:49:52,198 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.147, Train_accy 96.50, Test_accy 54.89
2024-09-07 12:49:59,757 [trainer.py] => No NME accuracy.
2024-09-07 12:49:59,757 [trainer.py] => CNN: {'total': 54.89, '00-39': 68.89, '40-79': 54.73, '80-119': 48.74, '120-159': 42.86, 'old': 58.26, 'new': 42.86}
2024-09-07 12:49:59,757 [trainer.py] => CNN top1 curve: [75.0, 64.61, 58.77, 54.89]
2024-09-07 12:49:59,758 [trainer.py] => CNN top5 curve: [92.78, 87.97, 83.49, 79.01]

Average Accuracy (CNN): 63.32
2024-09-07 12:49:59,758 [trainer.py] => Average Accuracy (CNN): 63.32 

2024-09-07 12:49:59,759 [trainer.py] => All params: 89792456
2024-09-07 12:49:59,760 [trainer.py] => Trainable params: 89792456
2024-09-07 12:50:03,595 [coda_prompt.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.528, Train_accy 22.44:   0%|          | 0/20 [00:11<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.528, Train_accy 22.44:   5%|▌         | 1/20 [00:11<03:47, 11.95s/it]
Task 4, Epoch 2/20 => Loss 1.353, Train_accy 62.69:   5%|▌         | 1/20 [00:23<03:47, 11.95s/it]
Task 4, Epoch 2/20 => Loss 1.353, Train_accy 62.69:  10%|█         | 2/20 [00:23<03:35, 11.95s/it]
Task 4, Epoch 3/20 => Loss 0.777, Train_accy 78.79:  10%|█         | 2/20 [00:35<03:35, 11.95s/it]
Task 4, Epoch 3/20 => Loss 0.777, Train_accy 78.79:  15%|█▌        | 3/20 [00:35<03:23, 11.94s/it]
Task 4, Epoch 4/20 => Loss 0.502, Train_accy 86.17:  15%|█▌        | 3/20 [00:47<03:23, 11.94s/it]
Task 4, Epoch 4/20 => Loss 0.502, Train_accy 86.17:  20%|██        | 4/20 [00:47<03:10, 11.94s/it]
Task 4, Epoch 5/20 => Loss 0.424, Train_accy 89.39, Test_accy 50.36:  20%|██        | 4/20 [01:08<03:10, 11.94s/it]
Task 4, Epoch 5/20 => Loss 0.424, Train_accy 89.39, Test_accy 50.36:  25%|██▌       | 5/20 [01:08<03:47, 15.17s/it]
Task 4, Epoch 6/20 => Loss 0.345, Train_accy 90.53:  25%|██▌       | 5/20 [01:20<03:47, 15.17s/it]                 
Task 4, Epoch 6/20 => Loss 0.345, Train_accy 90.53:  30%|███       | 6/20 [01:20<03:17, 14.10s/it]
Task 4, Epoch 7/20 => Loss 0.296, Train_accy 91.38:  30%|███       | 6/20 [01:32<03:17, 14.10s/it]
Task 4, Epoch 7/20 => Loss 0.296, Train_accy 91.38:  35%|███▌      | 7/20 [01:32<02:54, 13.41s/it]
Task 4, Epoch 8/20 => Loss 0.248, Train_accy 94.03:  35%|███▌      | 7/20 [01:44<02:54, 13.41s/it]
Task 4, Epoch 8/20 => Loss 0.248, Train_accy 94.03:  40%|████      | 8/20 [01:44<02:35, 12.95s/it]
Task 4, Epoch 9/20 => Loss 0.294, Train_accy 91.38:  40%|████      | 8/20 [01:56<02:35, 12.95s/it]
Task 4, Epoch 9/20 => Loss 0.294, Train_accy 91.38:  45%|████▌     | 9/20 [01:56<02:19, 12.66s/it]
Task 4, Epoch 10/20 => Loss 0.257, Train_accy 92.42, Test_accy 51.68:  45%|████▌     | 9/20 [02:17<02:19, 12.66s/it]
Task 4, Epoch 10/20 => Loss 0.257, Train_accy 92.42, Test_accy 51.68:  50%|█████     | 10/20 [02:17<02:32, 15.26s/it]
Task 4, Epoch 11/20 => Loss 0.232, Train_accy 93.75:  50%|█████     | 10/20 [02:29<02:32, 15.26s/it]                 
Task 4, Epoch 11/20 => Loss 0.232, Train_accy 93.75:  55%|█████▌    | 11/20 [02:29<02:08, 14.25s/it]
Task 4, Epoch 12/20 => Loss 0.208, Train_accy 95.27:  55%|█████▌    | 11/20 [02:41<02:08, 14.25s/it]
Task 4, Epoch 12/20 => Loss 0.208, Train_accy 95.27:  60%|██████    | 12/20 [02:41<01:48, 13.57s/it]
Task 4, Epoch 13/20 => Loss 0.178, Train_accy 95.17:  60%|██████    | 12/20 [02:53<01:48, 13.57s/it]
Task 4, Epoch 13/20 => Loss 0.178, Train_accy 95.17:  65%|██████▌   | 13/20 [02:53<01:31, 13.09s/it]
Task 4, Epoch 14/20 => Loss 0.208, Train_accy 93.94:  65%|██████▌   | 13/20 [03:05<01:31, 13.09s/it]
Task 4, Epoch 14/20 => Loss 0.208, Train_accy 93.94:  70%|███████   | 14/20 [03:05<01:16, 12.76s/it]
Task 4, Epoch 15/20 => Loss 0.173, Train_accy 95.17, Test_accy 51.81:  70%|███████   | 14/20 [03:26<01:16, 12.76s/it]
Task 4, Epoch 15/20 => Loss 0.173, Train_accy 95.17, Test_accy 51.81:  75%|███████▌  | 15/20 [03:26<01:16, 15.24s/it]
Task 4, Epoch 16/20 => Loss 0.157, Train_accy 95.64:  75%|███████▌  | 15/20 [03:38<01:16, 15.24s/it]                 
Task 4, Epoch 16/20 => Loss 0.157, Train_accy 95.64:  80%|████████  | 16/20 [03:38<00:57, 14.25s/it]
Task 4, Epoch 17/20 => Loss 0.150, Train_accy 96.50:  80%|████████  | 16/20 [03:50<00:57, 14.25s/it]
Task 4, Epoch 17/20 => Loss 0.150, Train_accy 96.50:  85%|████████▌ | 17/20 [03:50<00:40, 13.56s/it]
Task 4, Epoch 18/20 => Loss 0.159, Train_accy 95.64:  85%|████████▌ | 17/20 [04:02<00:40, 13.56s/it]
Task 4, Epoch 18/20 => Loss 0.159, Train_accy 95.64:  90%|█████████ | 18/20 [04:02<00:26, 13.09s/it]
Task 4, Epoch 19/20 => Loss 0.165, Train_accy 96.12:  90%|█████████ | 18/20 [04:14<00:26, 13.09s/it]
Task 4, Epoch 19/20 => Loss 0.165, Train_accy 96.12:  95%|█████████▌| 19/20 [04:14<00:12, 12.75s/it]
Task 4, Epoch 20/20 => Loss 0.138, Train_accy 96.21, Test_accy 51.74:  95%|█████████▌| 19/20 [04:35<00:12, 12.75s/it]
Task 4, Epoch 20/20 => Loss 0.138, Train_accy 96.21, Test_accy 51.74: 100%|██████████| 20/20 [04:35<00:00, 15.22s/it]
Task 4, Epoch 20/20 => Loss 0.138, Train_accy 96.21, Test_accy 51.74: 100%|██████████| 20/20 [04:35<00:00, 13.78s/it]
2024-09-07 12:54:39,124 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.138, Train_accy 96.21, Test_accy 51.74
2024-09-07 12:54:48,212 [trainer.py] => No NME accuracy.
2024-09-07 12:54:48,212 [trainer.py] => CNN: {'total': 51.74, '00-39': 67.22, '40-79': 52.07, '80-119': 48.38, '120-159': 42.49, '160-199': 43.54, 'old': 53.53, 'new': 43.54}
2024-09-07 12:54:48,212 [trainer.py] => CNN top1 curve: [75.0, 64.61, 58.77, 54.89, 51.74]
2024-09-07 12:54:48,213 [trainer.py] => CNN top5 curve: [92.78, 87.97, 83.49, 79.01, 75.77]

Average Accuracy (CNN): 61.0
2024-09-07 12:54:48,213 [trainer.py] => Average Accuracy (CNN): 61.0 

Accuracy Matrix (CNN):
[[75.   71.11 69.17 68.89 67.22]
 [ 0.   57.69 54.44 54.73 52.07]
 [ 0.    0.   50.54 48.74 48.38]
 [ 0.    0.    0.   42.86 42.49]
 [ 0.    0.    0.    0.   43.54]]
2024-09-07 12:54:48,214 [trainer.py] => Forgetting (CNN): 3.982499999999998
2024-09-07 12:54:51,002 [trainer.py] => config: ./exps/coda_prompt_ina_B0_Inc10.json
2024-09-07 12:54:51,002 [trainer.py] => prefix:  
2024-09-07 12:54:51,002 [trainer.py] => dataset: imageneta
2024-09-07 12:54:51,002 [trainer.py] => memory_size: 0
2024-09-07 12:54:51,002 [trainer.py] => memory_per_class: 0
2024-09-07 12:54:51,002 [trainer.py] => fixed_memory: False
2024-09-07 12:54:51,002 [trainer.py] => shuffle: True
2024-09-07 12:54:51,002 [trainer.py] => init_cls: 20
2024-09-07 12:54:51,002 [trainer.py] => increment: 20
2024-09-07 12:54:51,002 [trainer.py] => model_name: coda_prompt
2024-09-07 12:54:51,002 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-07 12:54:51,002 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 12:54:51,002 [trainer.py] => seed: 1993
2024-09-07 12:54:51,002 [trainer.py] => tuned_epoch: 20
2024-09-07 12:54:51,002 [trainer.py] => init_lr: 0.001
2024-09-07 12:54:51,002 [trainer.py] => batch_size: 48
2024-09-07 12:54:51,002 [trainer.py] => weight_decay: 0
2024-09-07 12:54:51,002 [trainer.py] => min_lr: 1e-05
2024-09-07 12:54:51,002 [trainer.py] => optimizer: adam
2024-09-07 12:54:51,002 [trainer.py] => scheduler: cosine
2024-09-07 12:54:51,003 [trainer.py] => reinit_optimizer: True
2024-09-07 12:54:51,003 [trainer.py] => pretrained: True
2024-09-07 12:54:51,003 [trainer.py] => drop: 0.0
2024-09-07 12:54:51,003 [trainer.py] => drop_path: 0.0
2024-09-07 12:54:51,003 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-07 12:54:51,029 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 12:54:52,771 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-07 12:54:52,771 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-07 12:54:52,771 [trainer.py] => All params: 89792456
2024-09-07 12:54:52,772 [trainer.py] => Trainable params: 89792456
2024-09-07 12:54:52,772 [coda_prompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.632, Train_accy 28.72:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.632, Train_accy 28.72:   5%|▌         | 1/20 [00:08<02:33,  8.05s/it]
Task 0, Epoch 2/20 => Loss 1.255, Train_accy 64.73:   5%|▌         | 1/20 [00:15<02:33,  8.05s/it]
Task 0, Epoch 2/20 => Loss 1.255, Train_accy 64.73:  10%|█         | 2/20 [00:15<02:20,  7.83s/it]
Task 0, Epoch 3/20 => Loss 0.784, Train_accy 78.72:  10%|█         | 2/20 [00:23<02:20,  7.83s/it]
Task 0, Epoch 3/20 => Loss 0.784, Train_accy 78.72:  15%|█▌        | 3/20 [00:23<02:11,  7.76s/it]
Task 0, Epoch 4/20 => Loss 0.561, Train_accy 87.20:  15%|█▌        | 3/20 [00:31<02:11,  7.76s/it]
Task 0, Epoch 4/20 => Loss 0.561, Train_accy 87.20:  20%|██        | 4/20 [00:31<02:03,  7.72s/it]
Task 0, Epoch 5/20 => Loss 0.421, Train_accy 90.62, Test_accy 72.57:  20%|██        | 4/20 [00:40<02:03,  7.72s/it]
Task 0, Epoch 5/20 => Loss 0.421, Train_accy 90.62, Test_accy 72.57:  25%|██▌       | 5/20 [00:40<02:03,  8.22s/it]
Task 0, Epoch 6/20 => Loss 0.347, Train_accy 90.92:  25%|██▌       | 5/20 [00:47<02:03,  8.22s/it]                 
Task 0, Epoch 6/20 => Loss 0.347, Train_accy 90.92:  30%|███       | 6/20 [00:47<01:52,  8.03s/it]
Task 0, Epoch 7/20 => Loss 0.270, Train_accy 92.11:  30%|███       | 6/20 [00:55<01:52,  8.03s/it]
Task 0, Epoch 7/20 => Loss 0.270, Train_accy 92.11:  35%|███▌      | 7/20 [00:55<01:43,  7.93s/it]
Task 0, Epoch 8/20 => Loss 0.238, Train_accy 92.56:  35%|███▌      | 7/20 [01:03<01:43,  7.93s/it]
Task 0, Epoch 8/20 => Loss 0.238, Train_accy 92.56:  40%|████      | 8/20 [01:03<01:34,  7.85s/it]
Task 0, Epoch 9/20 => Loss 0.226, Train_accy 93.45:  40%|████      | 8/20 [01:10<01:34,  7.85s/it]
Task 0, Epoch 9/20 => Loss 0.226, Train_accy 93.45:  45%|████▌     | 9/20 [01:10<01:26,  7.82s/it]
Task 0, Epoch 10/20 => Loss 0.191, Train_accy 94.79, Test_accy 75.43:  45%|████▌     | 9/20 [01:20<01:26,  7.82s/it]
Task 0, Epoch 10/20 => Loss 0.191, Train_accy 94.79, Test_accy 75.43:  50%|█████     | 10/20 [01:20<01:22,  8.22s/it]
Task 0, Epoch 11/20 => Loss 0.173, Train_accy 94.94:  50%|█████     | 10/20 [01:27<01:22,  8.22s/it]                 
Task 0, Epoch 11/20 => Loss 0.173, Train_accy 94.94:  55%|█████▌    | 11/20 [01:27<01:12,  8.07s/it]
Task 0, Epoch 12/20 => Loss 0.142, Train_accy 96.28:  55%|█████▌    | 11/20 [01:35<01:12,  8.07s/it]
Task 0, Epoch 12/20 => Loss 0.142, Train_accy 96.28:  60%|██████    | 12/20 [01:35<01:03,  7.97s/it]
Task 0, Epoch 13/20 => Loss 0.171, Train_accy 96.13:  60%|██████    | 12/20 [01:43<01:03,  7.97s/it]
Task 0, Epoch 13/20 => Loss 0.171, Train_accy 96.13:  65%|██████▌   | 13/20 [01:43<00:55,  7.88s/it]
Task 0, Epoch 14/20 => Loss 0.124, Train_accy 97.17:  65%|██████▌   | 13/20 [01:50<00:55,  7.88s/it]
Task 0, Epoch 14/20 => Loss 0.124, Train_accy 97.17:  70%|███████   | 14/20 [01:50<00:46,  7.81s/it]
Task 0, Epoch 15/20 => Loss 0.125, Train_accy 96.13, Test_accy 77.71:  70%|███████   | 14/20 [02:00<00:46,  7.81s/it]
Task 0, Epoch 15/20 => Loss 0.125, Train_accy 96.13, Test_accy 77.71:  75%|███████▌  | 15/20 [02:00<00:41,  8.22s/it]
Task 0, Epoch 16/20 => Loss 0.149, Train_accy 94.64:  75%|███████▌  | 15/20 [02:07<00:41,  8.22s/it]                 
Task 0, Epoch 16/20 => Loss 0.149, Train_accy 94.64:  80%|████████  | 16/20 [02:07<00:32,  8.07s/it]
Task 0, Epoch 17/20 => Loss 0.107, Train_accy 97.32:  80%|████████  | 16/20 [02:15<00:32,  8.07s/it]
Task 0, Epoch 17/20 => Loss 0.107, Train_accy 97.32:  85%|████████▌ | 17/20 [02:15<00:23,  7.96s/it]
Task 0, Epoch 18/20 => Loss 0.125, Train_accy 95.83:  85%|████████▌ | 17/20 [02:23<00:23,  7.96s/it]
Task 0, Epoch 18/20 => Loss 0.125, Train_accy 95.83:  90%|█████████ | 18/20 [02:23<00:15,  7.88s/it]
Task 0, Epoch 19/20 => Loss 0.099, Train_accy 97.62:  90%|█████████ | 18/20 [02:30<00:15,  7.88s/it]
Task 0, Epoch 19/20 => Loss 0.099, Train_accy 97.62:  95%|█████████▌| 19/20 [02:30<00:07,  7.82s/it]
Task 0, Epoch 20/20 => Loss 0.102, Train_accy 96.88, Test_accy 76.00:  95%|█████████▌| 19/20 [02:39<00:07,  7.82s/it]
Task 0, Epoch 20/20 => Loss 0.102, Train_accy 96.88, Test_accy 76.00: 100%|██████████| 20/20 [02:39<00:00,  8.21s/it]
Task 0, Epoch 20/20 => Loss 0.102, Train_accy 96.88, Test_accy 76.00: 100%|██████████| 20/20 [02:39<00:00,  8.00s/it]
2024-09-07 12:57:33,226 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.102, Train_accy 96.88, Test_accy 76.00
2024-09-07 12:57:34,652 [trainer.py] => No NME accuracy.
2024-09-07 12:57:34,652 [trainer.py] => CNN: {'total': 76.0, '00-19': 76.0, 'old': 0, 'new': 76.0}
2024-09-07 12:57:34,653 [trainer.py] => CNN top1 curve: [76.0]
2024-09-07 12:57:34,653 [trainer.py] => CNN top5 curve: [94.86]

Average Accuracy (CNN): 76.0
2024-09-07 12:57:34,653 [trainer.py] => Average Accuracy (CNN): 76.0 

2024-09-07 12:57:34,655 [trainer.py] => All params: 89792456
2024-09-07 12:57:34,656 [trainer.py] => Trainable params: 89792456
2024-09-07 12:57:34,965 [coda_prompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.029, Train_accy 24.03:   0%|          | 0/20 [00:08<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.029, Train_accy 24.03:   5%|▌         | 1/20 [00:08<02:36,  8.25s/it]
Task 1, Epoch 2/20 => Loss 1.334, Train_accy 62.08:   5%|▌         | 1/20 [00:16<02:36,  8.25s/it]
Task 1, Epoch 2/20 => Loss 1.334, Train_accy 62.08:  10%|█         | 2/20 [00:16<02:28,  8.23s/it]
Task 1, Epoch 3/20 => Loss 0.760, Train_accy 77.92:  10%|█         | 2/20 [00:24<02:28,  8.23s/it]
Task 1, Epoch 3/20 => Loss 0.760, Train_accy 77.92:  15%|█▌        | 3/20 [00:24<02:19,  8.23s/it]
Task 1, Epoch 4/20 => Loss 0.559, Train_accy 84.31:  15%|█▌        | 3/20 [00:32<02:19,  8.23s/it]
Task 1, Epoch 4/20 => Loss 0.559, Train_accy 84.31:  20%|██        | 4/20 [00:32<02:11,  8.24s/it]
Task 1, Epoch 5/20 => Loss 0.499, Train_accy 85.28, Test_accy 60.83:  20%|██        | 4/20 [00:43<02:11,  8.24s/it]
Task 1, Epoch 5/20 => Loss 0.499, Train_accy 85.28, Test_accy 60.83:  25%|██▌       | 5/20 [00:43<02:16,  9.13s/it]
Task 1, Epoch 6/20 => Loss 0.327, Train_accy 91.53:  25%|██▌       | 5/20 [00:51<02:16,  9.13s/it]                 
Task 1, Epoch 6/20 => Loss 0.327, Train_accy 91.53:  30%|███       | 6/20 [00:51<02:03,  8.81s/it]
Task 1, Epoch 7/20 => Loss 0.309, Train_accy 91.53:  30%|███       | 6/20 [01:00<02:03,  8.81s/it]
Task 1, Epoch 7/20 => Loss 0.309, Train_accy 91.53:  35%|███▌      | 7/20 [01:00<01:52,  8.62s/it]
Task 1, Epoch 8/20 => Loss 0.284, Train_accy 92.50:  35%|███▌      | 7/20 [01:08<01:52,  8.62s/it]
Task 1, Epoch 8/20 => Loss 0.284, Train_accy 92.50:  40%|████      | 8/20 [01:08<01:42,  8.51s/it]
Task 1, Epoch 9/20 => Loss 0.260, Train_accy 92.50:  40%|████      | 8/20 [01:16<01:42,  8.51s/it]
Task 1, Epoch 9/20 => Loss 0.260, Train_accy 92.50:  45%|████▌     | 9/20 [01:16<01:32,  8.41s/it]
Task 1, Epoch 10/20 => Loss 0.227, Train_accy 92.92, Test_accy 66.11:  45%|████▌     | 9/20 [01:27<01:32,  8.41s/it]
Task 1, Epoch 10/20 => Loss 0.227, Train_accy 92.92, Test_accy 66.11:  50%|█████     | 10/20 [01:27<01:31,  9.12s/it]
Task 1, Epoch 11/20 => Loss 0.246, Train_accy 92.78:  50%|█████     | 10/20 [01:35<01:31,  9.12s/it]                 
Task 1, Epoch 11/20 => Loss 0.246, Train_accy 92.78:  55%|█████▌    | 11/20 [01:35<01:19,  8.83s/it]
Task 1, Epoch 12/20 => Loss 0.232, Train_accy 93.47:  55%|█████▌    | 11/20 [01:43<01:19,  8.83s/it]
Task 1, Epoch 12/20 => Loss 0.232, Train_accy 93.47:  60%|██████    | 12/20 [01:43<01:09,  8.67s/it]
Task 1, Epoch 13/20 => Loss 0.214, Train_accy 93.19:  60%|██████    | 12/20 [01:51<01:09,  8.67s/it]
Task 1, Epoch 13/20 => Loss 0.214, Train_accy 93.19:  65%|██████▌   | 13/20 [01:51<00:59,  8.54s/it]
Task 1, Epoch 14/20 => Loss 0.182, Train_accy 94.72:  65%|██████▌   | 13/20 [02:00<00:59,  8.54s/it]
Task 1, Epoch 14/20 => Loss 0.182, Train_accy 94.72:  70%|███████   | 14/20 [02:00<00:50,  8.44s/it]
Task 1, Epoch 15/20 => Loss 0.217, Train_accy 94.03, Test_accy 67.22:  70%|███████   | 14/20 [02:10<00:50,  8.44s/it]
Task 1, Epoch 15/20 => Loss 0.217, Train_accy 94.03, Test_accy 67.22:  75%|███████▌  | 15/20 [02:10<00:45,  9.13s/it]
Task 1, Epoch 16/20 => Loss 0.192, Train_accy 93.89:  75%|███████▌  | 15/20 [02:19<00:45,  9.13s/it]                 
Task 1, Epoch 16/20 => Loss 0.192, Train_accy 93.89:  80%|████████  | 16/20 [02:19<00:35,  8.85s/it]
Task 1, Epoch 17/20 => Loss 0.134, Train_accy 97.36:  80%|████████  | 16/20 [02:27<00:35,  8.85s/it]
Task 1, Epoch 17/20 => Loss 0.134, Train_accy 97.36:  85%|████████▌ | 17/20 [02:27<00:26,  8.68s/it]
Task 1, Epoch 18/20 => Loss 0.196, Train_accy 94.58:  85%|████████▌ | 17/20 [02:35<00:26,  8.68s/it]
Task 1, Epoch 18/20 => Loss 0.196, Train_accy 94.58:  90%|█████████ | 18/20 [02:35<00:17,  8.55s/it]
Task 1, Epoch 19/20 => Loss 0.178, Train_accy 95.00:  90%|█████████ | 18/20 [02:43<00:17,  8.55s/it]
Task 1, Epoch 19/20 => Loss 0.178, Train_accy 95.00:  95%|█████████▌| 19/20 [02:43<00:08,  8.46s/it]
Task 1, Epoch 20/20 => Loss 0.148, Train_accy 96.81, Test_accy 67.78:  95%|█████████▌| 19/20 [02:54<00:08,  8.46s/it]
Task 1, Epoch 20/20 => Loss 0.148, Train_accy 96.81, Test_accy 67.78: 100%|██████████| 20/20 [02:54<00:00,  9.16s/it]
Task 1, Epoch 20/20 => Loss 0.148, Train_accy 96.81, Test_accy 67.78: 100%|██████████| 20/20 [02:54<00:00,  8.73s/it]
2024-09-07 13:00:29,659 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.148, Train_accy 96.81, Test_accy 67.78
2024-09-07 13:00:32,132 [trainer.py] => No NME accuracy.
2024-09-07 13:00:32,133 [trainer.py] => CNN: {'total': 67.78, '00-19': 73.14, '20-39': 62.7, 'old': 73.14, 'new': 62.7}
2024-09-07 13:00:32,133 [trainer.py] => CNN top1 curve: [76.0, 67.78]
2024-09-07 13:00:32,133 [trainer.py] => CNN top5 curve: [94.86, 93.06]

Average Accuracy (CNN): 71.89
2024-09-07 13:00:32,133 [trainer.py] => Average Accuracy (CNN): 71.89 

2024-09-07 13:00:32,134 [trainer.py] => All params: 89792456
2024-09-07 13:00:32,135 [trainer.py] => Trainable params: 89792456
2024-09-07 13:00:32,635 [coda_prompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.080, Train_accy 24.38:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.080, Train_accy 24.38:   5%|▌         | 1/20 [00:05<01:46,  5.60s/it]
Task 2, Epoch 2/20 => Loss 1.280, Train_accy 63.12:   5%|▌         | 1/20 [00:11<01:46,  5.60s/it]
Task 2, Epoch 2/20 => Loss 1.280, Train_accy 63.12:  10%|█         | 2/20 [00:11<01:41,  5.64s/it]
Task 2, Epoch 3/20 => Loss 0.645, Train_accy 80.62:  10%|█         | 2/20 [00:16<01:41,  5.64s/it]
Task 2, Epoch 3/20 => Loss 0.645, Train_accy 80.62:  15%|█▌        | 3/20 [00:16<01:35,  5.64s/it]
Task 2, Epoch 4/20 => Loss 0.491, Train_accy 83.54:  15%|█▌        | 3/20 [00:22<01:35,  5.64s/it]
Task 2, Epoch 4/20 => Loss 0.491, Train_accy 83.54:  20%|██        | 4/20 [00:22<01:30,  5.65s/it]
Task 2, Epoch 5/20 => Loss 0.346, Train_accy 90.00, Test_accy 59.03:  20%|██        | 4/20 [00:31<01:30,  5.65s/it]
Task 2, Epoch 5/20 => Loss 0.346, Train_accy 90.00, Test_accy 59.03:  25%|██▌       | 5/20 [00:31<01:41,  6.78s/it]
Task 2, Epoch 6/20 => Loss 0.264, Train_accy 92.92:  25%|██▌       | 5/20 [00:37<01:41,  6.78s/it]                 
Task 2, Epoch 6/20 => Loss 0.264, Train_accy 92.92:  30%|███       | 6/20 [00:37<01:29,  6.40s/it]
Task 2, Epoch 7/20 => Loss 0.235, Train_accy 93.12:  30%|███       | 6/20 [00:42<01:29,  6.40s/it]
Task 2, Epoch 7/20 => Loss 0.235, Train_accy 93.12:  35%|███▌      | 7/20 [00:42<01:19,  6.15s/it]
Task 2, Epoch 8/20 => Loss 0.225, Train_accy 93.33:  35%|███▌      | 7/20 [00:48<01:19,  6.15s/it]
Task 2, Epoch 8/20 => Loss 0.225, Train_accy 93.33:  40%|████      | 8/20 [00:48<01:11,  5.99s/it]
Task 2, Epoch 9/20 => Loss 0.172, Train_accy 95.00:  40%|████      | 8/20 [00:53<01:11,  5.99s/it]
Task 2, Epoch 9/20 => Loss 0.172, Train_accy 95.00:  45%|████▌     | 9/20 [00:53<01:04,  5.87s/it]
Task 2, Epoch 10/20 => Loss 0.138, Train_accy 96.46, Test_accy 60.92:  45%|████▌     | 9/20 [01:02<01:04,  5.87s/it]
Task 2, Epoch 10/20 => Loss 0.138, Train_accy 96.46, Test_accy 60.92:  50%|█████     | 10/20 [01:02<01:07,  6.76s/it]
Task 2, Epoch 11/20 => Loss 0.144, Train_accy 95.83:  50%|█████     | 10/20 [01:08<01:07,  6.76s/it]                 
Task 2, Epoch 11/20 => Loss 0.144, Train_accy 95.83:  55%|█████▌    | 11/20 [01:08<00:57,  6.40s/it]
Task 2, Epoch 12/20 => Loss 0.118, Train_accy 97.08:  55%|█████▌    | 11/20 [01:13<00:57,  6.40s/it]
Task 2, Epoch 12/20 => Loss 0.118, Train_accy 97.08:  60%|██████    | 12/20 [01:13<00:49,  6.18s/it]
Task 2, Epoch 13/20 => Loss 0.167, Train_accy 94.58:  60%|██████    | 12/20 [01:19<00:49,  6.18s/it]
Task 2, Epoch 13/20 => Loss 0.167, Train_accy 94.58:  65%|██████▌   | 13/20 [01:19<00:42,  6.01s/it]
Task 2, Epoch 14/20 => Loss 0.147, Train_accy 96.88:  65%|██████▌   | 13/20 [01:25<00:42,  6.01s/it]
Task 2, Epoch 14/20 => Loss 0.147, Train_accy 96.88:  70%|███████   | 14/20 [01:25<00:35,  5.88s/it]
Task 2, Epoch 15/20 => Loss 0.124, Train_accy 95.83, Test_accy 61.13:  70%|███████   | 14/20 [01:33<00:35,  5.88s/it]
Task 2, Epoch 15/20 => Loss 0.124, Train_accy 95.83, Test_accy 61.13:  75%|███████▌  | 15/20 [01:33<00:33,  6.72s/it]
Task 2, Epoch 16/20 => Loss 0.129, Train_accy 96.67:  75%|███████▌  | 15/20 [01:39<00:33,  6.72s/it]                 
Task 2, Epoch 16/20 => Loss 0.129, Train_accy 96.67:  80%|████████  | 16/20 [01:39<00:25,  6.40s/it]
Task 2, Epoch 17/20 => Loss 0.108, Train_accy 97.50:  80%|████████  | 16/20 [01:45<00:25,  6.40s/it]
Task 2, Epoch 17/20 => Loss 0.108, Train_accy 97.50:  85%|████████▌ | 17/20 [01:45<00:18,  6.15s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 97.08:  85%|████████▌ | 17/20 [01:50<00:18,  6.15s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 97.08:  90%|█████████ | 18/20 [01:50<00:11,  5.98s/it]
Task 2, Epoch 19/20 => Loss 0.120, Train_accy 97.08:  90%|█████████ | 18/20 [01:56<00:11,  5.98s/it]
Task 2, Epoch 19/20 => Loss 0.120, Train_accy 97.08:  95%|█████████▌| 19/20 [01:56<00:05,  5.87s/it]
Task 2, Epoch 20/20 => Loss 0.110, Train_accy 97.92, Test_accy 60.92:  95%|█████████▌| 19/20 [02:05<00:05,  5.87s/it]
Task 2, Epoch 20/20 => Loss 0.110, Train_accy 97.92, Test_accy 60.92: 100%|██████████| 20/20 [02:05<00:00,  6.76s/it]
Task 2, Epoch 20/20 => Loss 0.110, Train_accy 97.92, Test_accy 60.92: 100%|██████████| 20/20 [02:05<00:00,  6.25s/it]
2024-09-07 13:02:37,692 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.110, Train_accy 97.92, Test_accy 60.92
2024-09-07 13:02:40,847 [trainer.py] => No NME accuracy.
2024-09-07 13:02:40,848 [trainer.py] => CNN: {'total': 60.92, '00-19': 70.29, '20-39': 60.0, '40-59': 48.28, 'old': 65.0, 'new': 48.28}
2024-09-07 13:02:40,848 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92]
2024-09-07 13:02:40,848 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61]

Average Accuracy (CNN): 68.23
2024-09-07 13:02:40,848 [trainer.py] => Average Accuracy (CNN): 68.23 

2024-09-07 13:02:40,850 [trainer.py] => All params: 89792456
2024-09-07 13:02:40,851 [trainer.py] => Trainable params: 89792456
2024-09-07 13:02:41,624 [coda_prompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.596, Train_accy 30.60:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.596, Train_accy 30.60:   5%|▌         | 1/20 [00:08<02:46,  8.75s/it]
Task 3, Epoch 2/20 => Loss 1.006, Train_accy 69.27:   5%|▌         | 1/20 [00:17<02:46,  8.75s/it]
Task 3, Epoch 2/20 => Loss 1.006, Train_accy 69.27:  10%|█         | 2/20 [00:17<02:38,  8.79s/it]
Task 3, Epoch 3/20 => Loss 0.598, Train_accy 80.99:  10%|█         | 2/20 [00:26<02:38,  8.79s/it]
Task 3, Epoch 3/20 => Loss 0.598, Train_accy 80.99:  15%|█▌        | 3/20 [00:26<02:29,  8.78s/it]
Task 3, Epoch 4/20 => Loss 0.447, Train_accy 86.33:  15%|█▌        | 3/20 [00:35<02:29,  8.78s/it]
Task 3, Epoch 4/20 => Loss 0.447, Train_accy 86.33:  20%|██        | 4/20 [00:35<02:20,  8.80s/it]
Task 3, Epoch 5/20 => Loss 0.376, Train_accy 88.28, Test_accy 54.73:  20%|██        | 4/20 [00:48<02:20,  8.80s/it]
Task 3, Epoch 5/20 => Loss 0.376, Train_accy 88.28, Test_accy 54.73:  25%|██▌       | 5/20 [00:48<02:35, 10.39s/it]
Task 3, Epoch 6/20 => Loss 0.275, Train_accy 91.54:  25%|██▌       | 5/20 [00:57<02:35, 10.39s/it]                 
Task 3, Epoch 6/20 => Loss 0.275, Train_accy 91.54:  30%|███       | 6/20 [00:57<02:17,  9.83s/it]
Task 3, Epoch 7/20 => Loss 0.255, Train_accy 92.84:  30%|███       | 6/20 [01:05<02:17,  9.83s/it]
Task 3, Epoch 7/20 => Loss 0.255, Train_accy 92.84:  35%|███▌      | 7/20 [01:05<02:03,  9.49s/it]
Task 3, Epoch 8/20 => Loss 0.225, Train_accy 92.19:  35%|███▌      | 7/20 [01:14<02:03,  9.49s/it]
Task 3, Epoch 8/20 => Loss 0.225, Train_accy 92.19:  40%|████      | 8/20 [01:14<01:51,  9.28s/it]
Task 3, Epoch 9/20 => Loss 0.281, Train_accy 92.06:  40%|████      | 8/20 [01:23<01:51,  9.28s/it]
Task 3, Epoch 9/20 => Loss 0.281, Train_accy 92.06:  45%|████▌     | 9/20 [01:23<01:40,  9.14s/it]
Task 3, Epoch 10/20 => Loss 0.213, Train_accy 94.27, Test_accy 58.02:  45%|████▌     | 9/20 [01:36<01:40,  9.14s/it]
Task 3, Epoch 10/20 => Loss 0.213, Train_accy 94.27, Test_accy 58.02:  50%|█████     | 10/20 [01:36<01:44, 10.40s/it]
Task 3, Epoch 11/20 => Loss 0.179, Train_accy 95.70:  50%|█████     | 10/20 [01:45<01:44, 10.40s/it]                 
Task 3, Epoch 11/20 => Loss 0.179, Train_accy 95.70:  55%|█████▌    | 11/20 [01:45<01:29,  9.92s/it]
Task 3, Epoch 12/20 => Loss 0.227, Train_accy 94.14:  55%|█████▌    | 11/20 [01:54<01:29,  9.92s/it]
Task 3, Epoch 12/20 => Loss 0.227, Train_accy 94.14:  60%|██████    | 12/20 [01:54<01:16,  9.58s/it]
Task 3, Epoch 13/20 => Loss 0.192, Train_accy 94.66:  60%|██████    | 12/20 [02:03<01:16,  9.58s/it]
Task 3, Epoch 13/20 => Loss 0.192, Train_accy 94.66:  65%|██████▌   | 13/20 [02:03<01:05,  9.34s/it]
Task 3, Epoch 14/20 => Loss 0.218, Train_accy 93.62:  65%|██████▌   | 13/20 [02:11<01:05,  9.34s/it]
Task 3, Epoch 14/20 => Loss 0.218, Train_accy 93.62:  70%|███████   | 14/20 [02:11<00:55,  9.17s/it]
Task 3, Epoch 15/20 => Loss 0.193, Train_accy 94.40, Test_accy 58.88:  70%|███████   | 14/20 [02:25<00:55,  9.17s/it]
Task 3, Epoch 15/20 => Loss 0.193, Train_accy 94.40, Test_accy 58.88:  75%|███████▌  | 15/20 [02:25<00:51, 10.39s/it]
Task 3, Epoch 16/20 => Loss 0.185, Train_accy 94.01:  75%|███████▌  | 15/20 [02:33<00:51, 10.39s/it]                 
Task 3, Epoch 16/20 => Loss 0.185, Train_accy 94.01:  80%|████████  | 16/20 [02:33<00:39,  9.90s/it]
Task 3, Epoch 17/20 => Loss 0.152, Train_accy 95.83:  80%|████████  | 16/20 [02:42<00:39,  9.90s/it]
Task 3, Epoch 17/20 => Loss 0.152, Train_accy 95.83:  85%|████████▌ | 17/20 [02:42<00:28,  9.55s/it]
Task 3, Epoch 18/20 => Loss 0.118, Train_accy 97.01:  85%|████████▌ | 17/20 [02:51<00:28,  9.55s/it]
Task 3, Epoch 18/20 => Loss 0.118, Train_accy 97.01:  90%|█████████ | 18/20 [02:51<00:18,  9.32s/it]
Task 3, Epoch 19/20 => Loss 0.164, Train_accy 95.18:  90%|█████████ | 18/20 [03:00<00:18,  9.32s/it]
Task 3, Epoch 19/20 => Loss 0.164, Train_accy 95.18:  95%|█████████▌| 19/20 [03:00<00:09,  9.18s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.27, Test_accy 58.31:  95%|█████████▌| 19/20 [03:13<00:09,  9.18s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.27, Test_accy 58.31: 100%|██████████| 20/20 [03:13<00:00, 10.38s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.27, Test_accy 58.31: 100%|██████████| 20/20 [03:13<00:00,  9.68s/it]
2024-09-07 13:05:55,138 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.27, Test_accy 58.31
2024-09-07 13:05:59,591 [trainer.py] => No NME accuracy.
2024-09-07 13:05:59,592 [trainer.py] => CNN: {'total': 58.31, '00-19': 69.71, '20-39': 58.38, '40-59': 46.55, '60-79': 55.41, 'old': 59.66, 'new': 55.41}
2024-09-07 13:05:59,592 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92, 58.31]
2024-09-07 13:05:59,593 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61, 86.25]

Average Accuracy (CNN): 65.75
2024-09-07 13:05:59,593 [trainer.py] => Average Accuracy (CNN): 65.75 

2024-09-07 13:05:59,594 [trainer.py] => All params: 89792456
2024-09-07 13:05:59,596 [trainer.py] => Trainable params: 89792456
2024-09-07 13:06:00,530 [coda_prompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.959, Train_accy 28.54:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.959, Train_accy 28.54:   5%|▌         | 1/20 [00:05<01:47,  5.65s/it]
Task 4, Epoch 2/20 => Loss 1.253, Train_accy 65.21:   5%|▌         | 1/20 [00:11<01:47,  5.65s/it]
Task 4, Epoch 2/20 => Loss 1.253, Train_accy 65.21:  10%|█         | 2/20 [00:11<01:41,  5.64s/it]
Task 4, Epoch 3/20 => Loss 0.765, Train_accy 76.04:  10%|█         | 2/20 [00:16<01:41,  5.64s/it]
Task 4, Epoch 3/20 => Loss 0.765, Train_accy 76.04:  15%|█▌        | 3/20 [00:16<01:35,  5.65s/it]
Task 4, Epoch 4/20 => Loss 0.499, Train_accy 84.79:  15%|█▌        | 3/20 [00:22<01:35,  5.65s/it]
Task 4, Epoch 4/20 => Loss 0.499, Train_accy 84.79:  20%|██        | 4/20 [00:22<01:30,  5.65s/it]
Task 4, Epoch 5/20 => Loss 0.357, Train_accy 89.38, Test_accy 52.68:  20%|██        | 4/20 [00:33<01:30,  5.65s/it]
Task 4, Epoch 5/20 => Loss 0.357, Train_accy 89.38, Test_accy 52.68:  25%|██▌       | 5/20 [00:33<01:53,  7.54s/it]
Task 4, Epoch 6/20 => Loss 0.273, Train_accy 93.54:  25%|██▌       | 5/20 [00:39<01:53,  7.54s/it]                 
Task 4, Epoch 6/20 => Loss 0.273, Train_accy 93.54:  30%|███       | 6/20 [00:39<01:36,  6.89s/it]
Task 4, Epoch 7/20 => Loss 0.214, Train_accy 93.33:  30%|███       | 6/20 [00:44<01:36,  6.89s/it]
Task 4, Epoch 7/20 => Loss 0.214, Train_accy 93.33:  35%|███▌      | 7/20 [00:44<01:24,  6.49s/it]
Task 4, Epoch 8/20 => Loss 0.213, Train_accy 94.38:  35%|███▌      | 7/20 [00:50<01:24,  6.49s/it]
Task 4, Epoch 8/20 => Loss 0.213, Train_accy 94.38:  40%|████      | 8/20 [00:50<01:14,  6.22s/it]
Task 4, Epoch 9/20 => Loss 0.225, Train_accy 94.17:  40%|████      | 8/20 [00:56<01:14,  6.22s/it]
Task 4, Epoch 9/20 => Loss 0.225, Train_accy 94.17:  45%|████▌     | 9/20 [00:56<01:06,  6.05s/it]
Task 4, Epoch 10/20 => Loss 0.183, Train_accy 95.83, Test_accy 54.46:  45%|████▌     | 9/20 [01:06<01:06,  6.05s/it]
Task 4, Epoch 10/20 => Loss 0.183, Train_accy 95.83, Test_accy 54.46:  50%|█████     | 10/20 [01:06<01:15,  7.51s/it]
Task 4, Epoch 11/20 => Loss 0.190, Train_accy 94.58:  50%|█████     | 10/20 [01:12<01:15,  7.51s/it]                 
Task 4, Epoch 11/20 => Loss 0.190, Train_accy 94.58:  55%|█████▌    | 11/20 [01:12<01:02,  6.94s/it]
Task 4, Epoch 12/20 => Loss 0.173, Train_accy 94.58:  55%|█████▌    | 11/20 [01:18<01:02,  6.94s/it]
Task 4, Epoch 12/20 => Loss 0.173, Train_accy 94.58:  60%|██████    | 12/20 [01:18<00:52,  6.55s/it]
Task 4, Epoch 13/20 => Loss 0.150, Train_accy 95.62:  60%|██████    | 12/20 [01:23<00:52,  6.55s/it]
Task 4, Epoch 13/20 => Loss 0.150, Train_accy 95.62:  65%|██████▌   | 13/20 [01:23<00:43,  6.27s/it]
Task 4, Epoch 14/20 => Loss 0.125, Train_accy 96.88:  65%|██████▌   | 13/20 [01:29<00:43,  6.27s/it]
Task 4, Epoch 14/20 => Loss 0.125, Train_accy 96.88:  70%|███████   | 14/20 [01:29<00:36,  6.08s/it]
Task 4, Epoch 15/20 => Loss 0.110, Train_accy 96.88, Test_accy 54.70:  70%|███████   | 14/20 [01:40<00:36,  6.08s/it]
Task 4, Epoch 15/20 => Loss 0.110, Train_accy 96.88, Test_accy 54.70:  75%|███████▌  | 15/20 [01:40<00:37,  7.51s/it]
Task 4, Epoch 16/20 => Loss 0.104, Train_accy 97.50:  75%|███████▌  | 15/20 [01:45<00:37,  7.51s/it]                 
Task 4, Epoch 16/20 => Loss 0.104, Train_accy 97.50:  80%|████████  | 16/20 [01:45<00:27,  6.95s/it]
Task 4, Epoch 17/20 => Loss 0.144, Train_accy 95.62:  80%|████████  | 16/20 [01:51<00:27,  6.95s/it]
Task 4, Epoch 17/20 => Loss 0.144, Train_accy 95.62:  85%|████████▌ | 17/20 [01:51<00:19,  6.57s/it]
Task 4, Epoch 18/20 => Loss 0.153, Train_accy 94.38:  85%|████████▌ | 17/20 [01:57<00:19,  6.57s/it]
Task 4, Epoch 18/20 => Loss 0.153, Train_accy 94.38:  90%|█████████ | 18/20 [01:57<00:12,  6.29s/it]
Task 4, Epoch 19/20 => Loss 0.117, Train_accy 97.08:  90%|█████████ | 18/20 [02:02<00:12,  6.29s/it]
Task 4, Epoch 19/20 => Loss 0.117, Train_accy 97.08:  95%|█████████▌| 19/20 [02:02<00:06,  6.08s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 95.62, Test_accy 55.05:  95%|█████████▌| 19/20 [02:13<00:06,  6.08s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 95.62, Test_accy 55.05: 100%|██████████| 20/20 [02:13<00:00,  7.48s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 95.62, Test_accy 55.05: 100%|██████████| 20/20 [02:13<00:00,  6.68s/it]
2024-09-07 13:08:14,116 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.134, Train_accy 95.62, Test_accy 55.05
2024-09-07 13:08:19,263 [trainer.py] => No NME accuracy.
2024-09-07 13:08:19,264 [trainer.py] => CNN: {'total': 55.05, '00-19': 67.43, '20-39': 57.3, '40-59': 46.55, '60-79': 55.41, '80-99': 43.36, 'old': 57.45, 'new': 43.36}
2024-09-07 13:08:19,264 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92, 58.31, 55.05]
2024-09-07 13:08:19,264 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61, 86.25, 83.23]

Average Accuracy (CNN): 63.61
2024-09-07 13:08:19,264 [trainer.py] => Average Accuracy (CNN): 63.61 

2024-09-07 13:08:19,266 [trainer.py] => All params: 89792456
2024-09-07 13:08:19,267 [trainer.py] => Trainable params: 89792456
2024-09-07 13:08:20,366 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.876, Train_accy 27.92:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.876, Train_accy 27.92:   5%|▌         | 1/20 [00:05<01:45,  5.58s/it]
Task 5, Epoch 2/20 => Loss 1.102, Train_accy 66.67:   5%|▌         | 1/20 [00:11<01:45,  5.58s/it]
Task 5, Epoch 2/20 => Loss 1.102, Train_accy 66.67:  10%|█         | 2/20 [00:11<01:40,  5.60s/it]
Task 5, Epoch 3/20 => Loss 0.582, Train_accy 83.96:  10%|█         | 2/20 [00:16<01:40,  5.60s/it]
Task 5, Epoch 3/20 => Loss 0.582, Train_accy 83.96:  15%|█▌        | 3/20 [00:16<01:35,  5.63s/it]
Task 5, Epoch 4/20 => Loss 0.399, Train_accy 87.92:  15%|█▌        | 3/20 [00:22<01:35,  5.63s/it]
Task 5, Epoch 4/20 => Loss 0.399, Train_accy 87.92:  20%|██        | 4/20 [00:22<01:30,  5.65s/it]
Task 5, Epoch 5/20 => Loss 0.350, Train_accy 91.04, Test_accy 52.62:  20%|██        | 4/20 [00:34<01:30,  5.65s/it]
Task 5, Epoch 5/20 => Loss 0.350, Train_accy 91.04, Test_accy 52.62:  25%|██▌       | 5/20 [00:34<01:56,  7.77s/it]
Task 5, Epoch 6/20 => Loss 0.236, Train_accy 92.29:  25%|██▌       | 5/20 [00:39<01:56,  7.77s/it]                 
Task 5, Epoch 6/20 => Loss 0.236, Train_accy 92.29:  30%|███       | 6/20 [00:39<01:38,  7.05s/it]
Task 5, Epoch 7/20 => Loss 0.242, Train_accy 93.12:  30%|███       | 6/20 [00:45<01:38,  7.05s/it]
Task 5, Epoch 7/20 => Loss 0.242, Train_accy 93.12:  35%|███▌      | 7/20 [00:45<01:25,  6.59s/it]
Task 5, Epoch 8/20 => Loss 0.139, Train_accy 96.04:  35%|███▌      | 7/20 [00:50<01:25,  6.59s/it]
Task 5, Epoch 8/20 => Loss 0.139, Train_accy 96.04:  40%|████      | 8/20 [00:50<01:15,  6.27s/it]
Task 5, Epoch 9/20 => Loss 0.171, Train_accy 95.62:  40%|████      | 8/20 [00:56<01:15,  6.27s/it]
Task 5, Epoch 9/20 => Loss 0.171, Train_accy 95.62:  45%|████▌     | 9/20 [00:56<01:06,  6.07s/it]
Task 5, Epoch 10/20 => Loss 0.127, Train_accy 96.67, Test_accy 53.13:  45%|████▌     | 9/20 [01:08<01:06,  6.07s/it]
Task 5, Epoch 10/20 => Loss 0.127, Train_accy 96.67, Test_accy 53.13:  50%|█████     | 10/20 [01:08<01:17,  7.75s/it]
Task 5, Epoch 11/20 => Loss 0.159, Train_accy 95.62:  50%|█████     | 10/20 [01:13<01:17,  7.75s/it]                 
Task 5, Epoch 11/20 => Loss 0.159, Train_accy 95.62:  55%|█████▌    | 11/20 [01:13<01:03,  7.11s/it]
Task 5, Epoch 12/20 => Loss 0.191, Train_accy 94.58:  55%|█████▌    | 11/20 [01:19<01:03,  7.11s/it]
Task 5, Epoch 12/20 => Loss 0.191, Train_accy 94.58:  60%|██████    | 12/20 [01:19<00:53,  6.65s/it]
Task 5, Epoch 13/20 => Loss 0.126, Train_accy 96.46:  60%|██████    | 12/20 [01:24<00:53,  6.65s/it]
Task 5, Epoch 13/20 => Loss 0.126, Train_accy 96.46:  65%|██████▌   | 13/20 [01:24<00:44,  6.34s/it]
Task 5, Epoch 14/20 => Loss 0.127, Train_accy 96.67:  65%|██████▌   | 13/20 [01:30<00:44,  6.34s/it]
Task 5, Epoch 14/20 => Loss 0.127, Train_accy 96.67:  70%|███████   | 14/20 [01:30<00:36,  6.12s/it]
Task 5, Epoch 15/20 => Loss 0.123, Train_accy 96.25, Test_accy 53.44:  70%|███████   | 14/20 [01:42<00:36,  6.12s/it]
Task 5, Epoch 15/20 => Loss 0.123, Train_accy 96.25, Test_accy 53.44:  75%|███████▌  | 15/20 [01:42<00:38,  7.79s/it]
Task 5, Epoch 16/20 => Loss 0.136, Train_accy 96.46:  75%|███████▌  | 15/20 [01:47<00:38,  7.79s/it]                 
Task 5, Epoch 16/20 => Loss 0.136, Train_accy 96.46:  80%|████████  | 16/20 [01:47<00:28,  7.14s/it]
Task 5, Epoch 17/20 => Loss 0.143, Train_accy 96.04:  80%|████████  | 16/20 [01:53<00:28,  7.14s/it]
Task 5, Epoch 17/20 => Loss 0.143, Train_accy 96.04:  85%|████████▌ | 17/20 [01:53<00:20,  6.69s/it]
Task 5, Epoch 18/20 => Loss 0.112, Train_accy 96.88:  85%|████████▌ | 17/20 [01:59<00:20,  6.69s/it]
Task 5, Epoch 18/20 => Loss 0.112, Train_accy 96.88:  90%|█████████ | 18/20 [01:59<00:12,  6.37s/it]
Task 5, Epoch 19/20 => Loss 0.104, Train_accy 97.92:  90%|█████████ | 18/20 [02:04<00:12,  6.37s/it]
Task 5, Epoch 19/20 => Loss 0.104, Train_accy 97.92:  95%|█████████▌| 19/20 [02:04<00:06,  6.13s/it]
Task 5, Epoch 20/20 => Loss 0.117, Train_accy 96.88, Test_accy 53.13:  95%|█████████▌| 19/20 [02:16<00:06,  6.13s/it]
Task 5, Epoch 20/20 => Loss 0.117, Train_accy 96.88, Test_accy 53.13: 100%|██████████| 20/20 [02:16<00:00,  7.76s/it]
Task 5, Epoch 20/20 => Loss 0.117, Train_accy 96.88, Test_accy 53.13: 100%|██████████| 20/20 [02:16<00:00,  6.81s/it]
2024-09-07 13:10:36,621 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.117, Train_accy 96.88, Test_accy 53.13
2024-09-07 13:10:42,552 [trainer.py] => No NME accuracy.
2024-09-07 13:10:42,553 [trainer.py] => CNN: {'total': 53.13, '00-19': 66.86, '20-39': 57.3, '40-59': 45.69, '60-79': 52.7, '80-99': 37.76, '100-119': 52.99, 'old': 53.15, 'new': 52.99}
2024-09-07 13:10:42,553 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92, 58.31, 55.05, 53.13]
2024-09-07 13:10:42,553 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61, 86.25, 83.23, 81.33]

Average Accuracy (CNN): 61.86
2024-09-07 13:10:42,553 [trainer.py] => Average Accuracy (CNN): 61.86 

2024-09-07 13:10:42,554 [trainer.py] => All params: 89792456
2024-09-07 13:10:42,555 [trainer.py] => Trainable params: 89792456
2024-09-07 13:10:43,913 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.239, Train_accy 23.11:   0%|          | 0/20 [00:06<?, ?it/s]
Task 6, Epoch 1/20 => Loss 3.239, Train_accy 23.11:   5%|▌         | 1/20 [00:06<01:56,  6.15s/it]
Task 6, Epoch 2/20 => Loss 1.360, Train_accy 61.55:   5%|▌         | 1/20 [00:12<01:56,  6.15s/it]
Task 6, Epoch 2/20 => Loss 1.360, Train_accy 61.55:  10%|█         | 2/20 [00:12<01:51,  6.18s/it]
Task 6, Epoch 3/20 => Loss 0.778, Train_accy 77.08:  10%|█         | 2/20 [00:18<01:51,  6.18s/it]
Task 6, Epoch 3/20 => Loss 0.778, Train_accy 77.08:  15%|█▌        | 3/20 [00:18<01:45,  6.20s/it]
Task 6, Epoch 4/20 => Loss 0.523, Train_accy 83.71:  15%|█▌        | 3/20 [00:24<01:45,  6.20s/it]
Task 6, Epoch 4/20 => Loss 0.523, Train_accy 83.71:  20%|██        | 4/20 [00:24<01:39,  6.20s/it]
Task 6, Epoch 5/20 => Loss 0.402, Train_accy 90.91, Test_accy 49.60:  20%|██        | 4/20 [00:37<01:39,  6.20s/it]
Task 6, Epoch 5/20 => Loss 0.402, Train_accy 90.91, Test_accy 49.60:  25%|██▌       | 5/20 [00:37<02:09,  8.61s/it]
Task 6, Epoch 6/20 => Loss 0.290, Train_accy 92.05:  25%|██▌       | 5/20 [00:43<02:09,  8.61s/it]                 
Task 6, Epoch 6/20 => Loss 0.290, Train_accy 92.05:  30%|███       | 6/20 [00:43<01:48,  7.76s/it]
Task 6, Epoch 7/20 => Loss 0.247, Train_accy 92.42:  30%|███       | 6/20 [00:49<01:48,  7.76s/it]
Task 6, Epoch 7/20 => Loss 0.247, Train_accy 92.42:  35%|███▌      | 7/20 [00:49<01:34,  7.23s/it]
Task 6, Epoch 8/20 => Loss 0.239, Train_accy 93.37:  35%|███▌      | 7/20 [00:56<01:34,  7.23s/it]
Task 6, Epoch 8/20 => Loss 0.239, Train_accy 93.37:  40%|████      | 8/20 [00:56<01:22,  6.90s/it]
Task 6, Epoch 9/20 => Loss 0.218, Train_accy 93.75:  40%|████      | 8/20 [01:02<01:22,  6.90s/it]
Task 6, Epoch 9/20 => Loss 0.218, Train_accy 93.75:  45%|████▌     | 9/20 [01:02<01:13,  6.67s/it]
Task 6, Epoch 10/20 => Loss 0.216, Train_accy 94.51, Test_accy 50.04:  45%|████▌     | 9/20 [01:15<01:13,  6.67s/it]
Task 6, Epoch 10/20 => Loss 0.216, Train_accy 94.51, Test_accy 50.04:  50%|█████     | 10/20 [01:15<01:25,  8.57s/it]
Task 6, Epoch 11/20 => Loss 0.164, Train_accy 95.64:  50%|█████     | 10/20 [01:21<01:25,  8.57s/it]                 
Task 6, Epoch 11/20 => Loss 0.164, Train_accy 95.64:  55%|█████▌    | 11/20 [01:21<01:10,  7.83s/it]
Task 6, Epoch 12/20 => Loss 0.160, Train_accy 96.02:  55%|█████▌    | 11/20 [01:27<01:10,  7.83s/it]
Task 6, Epoch 12/20 => Loss 0.160, Train_accy 96.02:  60%|██████    | 12/20 [01:27<00:58,  7.32s/it]
Task 6, Epoch 13/20 => Loss 0.153, Train_accy 95.64:  60%|██████    | 12/20 [01:33<00:58,  7.32s/it]
Task 6, Epoch 13/20 => Loss 0.153, Train_accy 95.64:  65%|██████▌   | 13/20 [01:33<00:48,  6.97s/it]
Task 6, Epoch 14/20 => Loss 0.114, Train_accy 97.35:  65%|██████▌   | 13/20 [01:39<00:48,  6.97s/it]
Task 6, Epoch 14/20 => Loss 0.114, Train_accy 97.35:  70%|███████   | 14/20 [01:39<00:40,  6.73s/it]
Task 6, Epoch 15/20 => Loss 0.164, Train_accy 96.40, Test_accy 50.13:  70%|███████   | 14/20 [01:52<00:40,  6.73s/it]
Task 6, Epoch 15/20 => Loss 0.164, Train_accy 96.40, Test_accy 50.13:  75%|███████▌  | 15/20 [01:52<00:42,  8.59s/it]
Task 6, Epoch 16/20 => Loss 0.122, Train_accy 97.35:  75%|███████▌  | 15/20 [01:58<00:42,  8.59s/it]                 
Task 6, Epoch 16/20 => Loss 0.122, Train_accy 97.35:  80%|████████  | 16/20 [01:58<00:31,  7.89s/it]
Task 6, Epoch 17/20 => Loss 0.112, Train_accy 97.16:  80%|████████  | 16/20 [02:04<00:31,  7.89s/it]
Task 6, Epoch 17/20 => Loss 0.112, Train_accy 97.16:  85%|████████▌ | 17/20 [02:04<00:22,  7.34s/it]
Task 6, Epoch 18/20 => Loss 0.122, Train_accy 97.54:  85%|████████▌ | 17/20 [02:11<00:22,  7.34s/it]
Task 6, Epoch 18/20 => Loss 0.122, Train_accy 97.54:  90%|█████████ | 18/20 [02:11<00:13,  7.00s/it]
Task 6, Epoch 19/20 => Loss 0.175, Train_accy 94.70:  90%|█████████ | 18/20 [02:17<00:13,  7.00s/it]
Task 6, Epoch 19/20 => Loss 0.175, Train_accy 94.70:  95%|█████████▌| 19/20 [02:17<00:06,  6.76s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 96.40, Test_accy 50.31:  95%|█████████▌| 19/20 [02:30<00:06,  6.76s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 96.40, Test_accy 50.31: 100%|██████████| 20/20 [02:30<00:00,  8.64s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 96.40, Test_accy 50.31: 100%|██████████| 20/20 [02:30<00:00,  7.52s/it]
2024-09-07 13:13:14,302 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.124, Train_accy 96.40, Test_accy 50.31
2024-09-07 13:13:21,071 [trainer.py] => No NME accuracy.
2024-09-07 13:13:21,071 [trainer.py] => CNN: {'total': 50.31, '00-19': 62.29, '20-39': 55.14, '40-59': 44.83, '60-79': 51.8, '80-99': 37.76, '100-119': 52.24, '120-139': 42.47, 'old': 51.49, 'new': 42.47}
2024-09-07 13:13:21,071 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92, 58.31, 55.05, 53.13, 50.31]
2024-09-07 13:13:21,072 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61, 86.25, 83.23, 81.33, 79.3]

Average Accuracy (CNN): 60.21
2024-09-07 13:13:21,072 [trainer.py] => Average Accuracy (CNN): 60.21 

2024-09-07 13:13:21,073 [trainer.py] => All params: 89792456
2024-09-07 13:13:21,075 [trainer.py] => Trainable params: 89792456
2024-09-07 13:13:22,579 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 3.296, Train_accy 21.78:   0%|          | 0/20 [00:06<?, ?it/s]
Task 7, Epoch 1/20 => Loss 3.296, Train_accy 21.78:   5%|▌         | 1/20 [00:06<01:57,  6.16s/it]
Task 7, Epoch 2/20 => Loss 1.285, Train_accy 62.12:   5%|▌         | 1/20 [00:12<01:57,  6.16s/it]
Task 7, Epoch 2/20 => Loss 1.285, Train_accy 62.12:  10%|█         | 2/20 [00:12<01:50,  6.15s/it]
Task 7, Epoch 3/20 => Loss 0.654, Train_accy 80.49:  10%|█         | 2/20 [00:18<01:50,  6.15s/it]
Task 7, Epoch 3/20 => Loss 0.654, Train_accy 80.49:  15%|█▌        | 3/20 [00:18<01:44,  6.14s/it]
Task 7, Epoch 4/20 => Loss 0.453, Train_accy 86.74:  15%|█▌        | 3/20 [00:24<01:44,  6.14s/it]
Task 7, Epoch 4/20 => Loss 0.453, Train_accy 86.74:  20%|██        | 4/20 [00:24<01:38,  6.14s/it]
Task 7, Epoch 5/20 => Loss 0.282, Train_accy 94.32, Test_accy 46.88:  20%|██        | 4/20 [00:38<01:38,  6.14s/it]
Task 7, Epoch 5/20 => Loss 0.282, Train_accy 94.32, Test_accy 46.88:  25%|██▌       | 5/20 [00:38<02:12,  8.86s/it]
Task 7, Epoch 6/20 => Loss 0.233, Train_accy 93.94:  25%|██▌       | 5/20 [00:44<02:12,  8.86s/it]                 
Task 7, Epoch 6/20 => Loss 0.233, Train_accy 93.94:  30%|███       | 6/20 [00:44<01:51,  7.96s/it]
Task 7, Epoch 7/20 => Loss 0.208, Train_accy 94.70:  30%|███       | 6/20 [00:50<01:51,  7.96s/it]
Task 7, Epoch 7/20 => Loss 0.208, Train_accy 94.70:  35%|███▌      | 7/20 [00:50<01:35,  7.37s/it]
Task 7, Epoch 8/20 => Loss 0.191, Train_accy 95.45:  35%|███▌      | 7/20 [00:56<01:35,  7.37s/it]
Task 7, Epoch 8/20 => Loss 0.191, Train_accy 95.45:  40%|████      | 8/20 [00:56<01:23,  6.99s/it]
Task 7, Epoch 9/20 => Loss 0.178, Train_accy 95.45:  40%|████      | 8/20 [01:02<01:23,  6.99s/it]
Task 7, Epoch 9/20 => Loss 0.178, Train_accy 95.45:  45%|████▌     | 9/20 [01:02<01:14,  6.73s/it]
Task 7, Epoch 10/20 => Loss 0.147, Train_accy 96.02, Test_accy 47.52:  45%|████▌     | 9/20 [01:16<01:14,  6.73s/it]
Task 7, Epoch 10/20 => Loss 0.147, Train_accy 96.02, Test_accy 47.52:  50%|█████     | 10/20 [01:16<01:28,  8.84s/it]
Task 7, Epoch 11/20 => Loss 0.159, Train_accy 96.97:  50%|█████     | 10/20 [01:22<01:28,  8.84s/it]                 
Task 7, Epoch 11/20 => Loss 0.159, Train_accy 96.97:  55%|█████▌    | 11/20 [01:22<01:11,  7.98s/it]
Task 7, Epoch 12/20 => Loss 0.161, Train_accy 95.64:  55%|█████▌    | 11/20 [01:28<01:11,  7.98s/it]
Task 7, Epoch 12/20 => Loss 0.161, Train_accy 95.64:  60%|██████    | 12/20 [01:28<00:59,  7.43s/it]
Task 7, Epoch 13/20 => Loss 0.125, Train_accy 96.59:  60%|██████    | 12/20 [01:34<00:59,  7.43s/it]
Task 7, Epoch 13/20 => Loss 0.125, Train_accy 96.59:  65%|██████▌   | 13/20 [01:34<00:49,  7.05s/it]
Task 7, Epoch 14/20 => Loss 0.119, Train_accy 97.16:  65%|██████▌   | 13/20 [01:41<00:49,  7.05s/it]
Task 7, Epoch 14/20 => Loss 0.119, Train_accy 97.16:  70%|███████   | 14/20 [01:41<00:40,  6.78s/it]
Task 7, Epoch 15/20 => Loss 0.146, Train_accy 95.83, Test_accy 48.00:  70%|███████   | 14/20 [01:54<00:40,  6.78s/it]
Task 7, Epoch 15/20 => Loss 0.146, Train_accy 95.83, Test_accy 48.00:  75%|███████▌  | 15/20 [01:54<00:44,  8.88s/it]
Task 7, Epoch 16/20 => Loss 0.102, Train_accy 97.35:  75%|███████▌  | 15/20 [02:00<00:44,  8.88s/it]                 
Task 7, Epoch 16/20 => Loss 0.102, Train_accy 97.35:  80%|████████  | 16/20 [02:00<00:32,  8.06s/it]
Task 7, Epoch 17/20 => Loss 0.144, Train_accy 96.40:  80%|████████  | 16/20 [02:07<00:32,  8.06s/it]
Task 7, Epoch 17/20 => Loss 0.144, Train_accy 96.40:  85%|████████▌ | 17/20 [02:07<00:22,  7.49s/it]
Task 7, Epoch 18/20 => Loss 0.126, Train_accy 96.97:  85%|████████▌ | 17/20 [02:13<00:22,  7.49s/it]
Task 7, Epoch 18/20 => Loss 0.126, Train_accy 96.97:  90%|█████████ | 18/20 [02:13<00:14,  7.06s/it]
Task 7, Epoch 19/20 => Loss 0.145, Train_accy 96.21:  90%|█████████ | 18/20 [02:19<00:14,  7.06s/it]
Task 7, Epoch 19/20 => Loss 0.145, Train_accy 96.21:  95%|█████████▌| 19/20 [02:19<00:06,  6.80s/it]
Task 7, Epoch 20/20 => Loss 0.144, Train_accy 95.83, Test_accy 47.84:  95%|█████████▌| 19/20 [02:33<00:06,  6.80s/it]
Task 7, Epoch 20/20 => Loss 0.144, Train_accy 95.83, Test_accy 47.84: 100%|██████████| 20/20 [02:33<00:00,  8.88s/it]
Task 7, Epoch 20/20 => Loss 0.144, Train_accy 95.83, Test_accy 47.84: 100%|██████████| 20/20 [02:33<00:00,  7.66s/it]
2024-09-07 13:15:55,691 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.144, Train_accy 95.83, Test_accy 47.84
2024-09-07 13:16:03,154 [trainer.py] => No NME accuracy.
2024-09-07 13:16:03,155 [trainer.py] => CNN: {'total': 47.84, '00-19': 61.71, '20-39': 54.05, '40-59': 44.83, '60-79': 50.45, '80-99': 37.06, '100-119': 51.49, '120-139': 42.47, '140-159': 32.28, 'old': 49.6, 'new': 32.28}
2024-09-07 13:16:03,155 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92, 58.31, 55.05, 53.13, 50.31, 47.84]
2024-09-07 13:16:03,155 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61, 86.25, 83.23, 81.33, 79.3, 77.32]

Average Accuracy (CNN): 58.67
2024-09-07 13:16:03,155 [trainer.py] => Average Accuracy (CNN): 58.67 

2024-09-07 13:16:03,156 [trainer.py] => All params: 89792456
2024-09-07 13:16:03,157 [trainer.py] => Trainable params: 89792456
2024-09-07 13:16:04,861 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.452, Train_accy 17.80:   0%|          | 0/20 [00:06<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.452, Train_accy 17.80:   5%|▌         | 1/20 [00:06<01:56,  6.16s/it]
Task 8, Epoch 2/20 => Loss 1.608, Train_accy 53.41:   5%|▌         | 1/20 [00:12<01:56,  6.16s/it]
Task 8, Epoch 2/20 => Loss 1.608, Train_accy 53.41:  10%|█         | 2/20 [00:12<01:51,  6.18s/it]
Task 8, Epoch 3/20 => Loss 0.903, Train_accy 71.59:  10%|█         | 2/20 [00:18<01:51,  6.18s/it]
Task 8, Epoch 3/20 => Loss 0.903, Train_accy 71.59:  15%|█▌        | 3/20 [00:18<01:45,  6.18s/it]
Task 8, Epoch 4/20 => Loss 0.635, Train_accy 80.68:  15%|█▌        | 3/20 [00:24<01:45,  6.18s/it]
Task 8, Epoch 4/20 => Loss 0.635, Train_accy 80.68:  20%|██        | 4/20 [00:24<01:38,  6.17s/it]
Task 8, Epoch 5/20 => Loss 0.497, Train_accy 86.55, Test_accy 45.16:  20%|██        | 4/20 [00:39<01:38,  6.17s/it]
Task 8, Epoch 5/20 => Loss 0.497, Train_accy 86.55, Test_accy 45.16:  25%|██▌       | 5/20 [00:39<02:17,  9.16s/it]
Task 8, Epoch 6/20 => Loss 0.339, Train_accy 89.96:  25%|██▌       | 5/20 [00:45<02:17,  9.16s/it]                 
Task 8, Epoch 6/20 => Loss 0.339, Train_accy 89.96:  30%|███       | 6/20 [00:45<01:54,  8.17s/it]
Task 8, Epoch 7/20 => Loss 0.374, Train_accy 89.39:  30%|███       | 6/20 [00:51<01:54,  8.17s/it]
Task 8, Epoch 7/20 => Loss 0.374, Train_accy 89.39:  35%|███▌      | 7/20 [00:51<01:37,  7.52s/it]
Task 8, Epoch 8/20 => Loss 0.297, Train_accy 91.29:  35%|███▌      | 7/20 [00:57<01:37,  7.52s/it]
Task 8, Epoch 8/20 => Loss 0.297, Train_accy 91.29:  40%|████      | 8/20 [00:57<01:25,  7.11s/it]
Task 8, Epoch 9/20 => Loss 0.277, Train_accy 92.23:  40%|████      | 8/20 [01:03<01:25,  7.11s/it]
Task 8, Epoch 9/20 => Loss 0.277, Train_accy 92.23:  45%|████▌     | 9/20 [01:03<01:14,  6.82s/it]
Task 8, Epoch 10/20 => Loss 0.297, Train_accy 92.80, Test_accy 45.52:  45%|████▌     | 9/20 [01:18<01:14,  6.82s/it]
Task 8, Epoch 10/20 => Loss 0.297, Train_accy 92.80, Test_accy 45.52:  50%|█████     | 10/20 [01:18<01:31,  9.19s/it]
Task 8, Epoch 11/20 => Loss 0.217, Train_accy 95.08:  50%|█████     | 10/20 [01:24<01:31,  9.19s/it]                 
Task 8, Epoch 11/20 => Loss 0.217, Train_accy 95.08:  55%|█████▌    | 11/20 [01:24<01:14,  8.27s/it]
Task 8, Epoch 12/20 => Loss 0.246, Train_accy 92.80:  55%|█████▌    | 11/20 [01:30<01:14,  8.27s/it]
Task 8, Epoch 12/20 => Loss 0.246, Train_accy 92.80:  60%|██████    | 12/20 [01:30<01:01,  7.64s/it]
Task 8, Epoch 13/20 => Loss 0.212, Train_accy 93.37:  60%|██████    | 12/20 [01:37<01:01,  7.64s/it]
Task 8, Epoch 13/20 => Loss 0.212, Train_accy 93.37:  65%|██████▌   | 13/20 [01:37<00:50,  7.21s/it]
Task 8, Epoch 14/20 => Loss 0.198, Train_accy 95.83:  65%|██████▌   | 13/20 [01:43<00:50,  7.21s/it]
Task 8, Epoch 14/20 => Loss 0.198, Train_accy 95.83:  70%|███████   | 14/20 [01:43<00:41,  6.91s/it]
Task 8, Epoch 15/20 => Loss 0.209, Train_accy 94.51, Test_accy 45.81:  70%|███████   | 14/20 [01:57<00:41,  6.91s/it]
Task 8, Epoch 15/20 => Loss 0.209, Train_accy 94.51, Test_accy 45.81:  75%|███████▌  | 15/20 [01:57<00:46,  9.21s/it]
Task 8, Epoch 16/20 => Loss 0.160, Train_accy 94.89:  75%|███████▌  | 15/20 [02:04<00:46,  9.21s/it]                 
Task 8, Epoch 16/20 => Loss 0.160, Train_accy 94.89:  80%|████████  | 16/20 [02:04<00:33,  8.29s/it]
Task 8, Epoch 17/20 => Loss 0.212, Train_accy 95.45:  80%|████████  | 16/20 [02:10<00:33,  8.29s/it]
Task 8, Epoch 17/20 => Loss 0.212, Train_accy 95.45:  85%|████████▌ | 17/20 [02:10<00:22,  7.65s/it]
Task 8, Epoch 18/20 => Loss 0.221, Train_accy 92.42:  85%|████████▌ | 17/20 [02:16<00:22,  7.65s/it]
Task 8, Epoch 18/20 => Loss 0.221, Train_accy 92.42:  90%|█████████ | 18/20 [02:16<00:14,  7.20s/it]
Task 8, Epoch 19/20 => Loss 0.176, Train_accy 96.21:  90%|█████████ | 18/20 [02:22<00:14,  7.20s/it]
Task 8, Epoch 19/20 => Loss 0.176, Train_accy 96.21:  95%|█████████▌| 19/20 [02:22<00:06,  6.90s/it]
Task 8, Epoch 20/20 => Loss 0.152, Train_accy 95.45, Test_accy 46.02:  95%|█████████▌| 19/20 [02:37<00:06,  6.90s/it]
Task 8, Epoch 20/20 => Loss 0.152, Train_accy 95.45, Test_accy 46.02: 100%|██████████| 20/20 [02:37<00:00,  9.19s/it]
Task 8, Epoch 20/20 => Loss 0.152, Train_accy 95.45, Test_accy 46.02: 100%|██████████| 20/20 [02:37<00:00,  7.85s/it]
2024-09-07 13:18:41,912 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.152, Train_accy 95.45, Test_accy 46.02
2024-09-07 13:18:50,184 [trainer.py] => No NME accuracy.
2024-09-07 13:18:50,184 [trainer.py] => CNN: {'total': 46.02, '00-19': 60.0, '20-39': 50.81, '40-59': 39.66, '60-79': 50.45, '80-99': 34.97, '100-119': 52.99, '120-139': 44.52, '140-159': 33.07, '160-179': 38.78, 'old': 46.88, 'new': 38.78}
2024-09-07 13:18:50,185 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92, 58.31, 55.05, 53.13, 50.31, 47.84, 46.02]
2024-09-07 13:18:50,185 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61, 86.25, 83.23, 81.33, 79.3, 77.32, 75.2]

Average Accuracy (CNN): 57.26
2024-09-07 13:18:50,185 [trainer.py] => Average Accuracy (CNN): 57.26 

2024-09-07 13:18:50,186 [trainer.py] => All params: 89792456
2024-09-07 13:18:50,188 [trainer.py] => Trainable params: 89792456
2024-09-07 13:18:52,076 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.254, Train_accy 21.46:   0%|          | 0/20 [00:05<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.254, Train_accy 21.46:   5%|▌         | 1/20 [00:05<01:47,  5.64s/it]
Task 9, Epoch 2/20 => Loss 1.373, Train_accy 60.42:   5%|▌         | 1/20 [00:11<01:47,  5.64s/it]
Task 9, Epoch 2/20 => Loss 1.373, Train_accy 60.42:  10%|█         | 2/20 [00:11<01:41,  5.64s/it]
Task 9, Epoch 3/20 => Loss 0.714, Train_accy 76.88:  10%|█         | 2/20 [00:16<01:41,  5.64s/it]
Task 9, Epoch 3/20 => Loss 0.714, Train_accy 76.88:  15%|█▌        | 3/20 [00:16<01:35,  5.60s/it]
Task 9, Epoch 4/20 => Loss 0.459, Train_accy 87.29:  15%|█▌        | 3/20 [00:22<01:35,  5.60s/it]
Task 9, Epoch 4/20 => Loss 0.459, Train_accy 87.29:  20%|██        | 4/20 [00:22<01:29,  5.62s/it]
Task 9, Epoch 5/20 => Loss 0.330, Train_accy 89.58, Test_accy 44.31:  20%|██        | 4/20 [00:37<01:29,  5.62s/it]
Task 9, Epoch 5/20 => Loss 0.330, Train_accy 89.58, Test_accy 44.31:  25%|██▌       | 5/20 [00:37<02:13,  8.87s/it]
Task 9, Epoch 6/20 => Loss 0.299, Train_accy 92.29:  25%|██▌       | 5/20 [00:42<02:13,  8.87s/it]                 
Task 9, Epoch 6/20 => Loss 0.299, Train_accy 92.29:  30%|███       | 6/20 [00:42<01:48,  7.78s/it]
Task 9, Epoch 7/20 => Loss 0.252, Train_accy 92.71:  30%|███       | 6/20 [00:48<01:48,  7.78s/it]
Task 9, Epoch 7/20 => Loss 0.252, Train_accy 92.71:  35%|███▌      | 7/20 [00:48<01:32,  7.09s/it]
Task 9, Epoch 8/20 => Loss 0.228, Train_accy 94.38:  35%|███▌      | 7/20 [00:54<01:32,  7.09s/it]
Task 9, Epoch 8/20 => Loss 0.228, Train_accy 94.38:  40%|████      | 8/20 [00:54<01:19,  6.64s/it]
Task 9, Epoch 9/20 => Loss 0.222, Train_accy 93.96:  40%|████      | 8/20 [00:59<01:19,  6.64s/it]
Task 9, Epoch 9/20 => Loss 0.222, Train_accy 93.96:  45%|████▌     | 9/20 [00:59<01:09,  6.33s/it]
Task 9, Epoch 10/20 => Loss 0.145, Train_accy 96.25, Test_accy 45.03:  45%|████▌     | 9/20 [01:14<01:09,  6.33s/it]
Task 9, Epoch 10/20 => Loss 0.145, Train_accy 96.25, Test_accy 45.03:  50%|█████     | 10/20 [01:14<01:29,  8.90s/it]
Task 9, Epoch 11/20 => Loss 0.151, Train_accy 96.25:  50%|█████     | 10/20 [01:20<01:29,  8.90s/it]                 
Task 9, Epoch 11/20 => Loss 0.151, Train_accy 96.25:  55%|█████▌    | 11/20 [01:20<01:11,  7.91s/it]
Task 9, Epoch 12/20 => Loss 0.200, Train_accy 94.38:  55%|█████▌    | 11/20 [01:25<01:11,  7.91s/it]
Task 9, Epoch 12/20 => Loss 0.200, Train_accy 94.38:  60%|██████    | 12/20 [01:25<00:57,  7.23s/it]
Task 9, Epoch 13/20 => Loss 0.125, Train_accy 96.88:  60%|██████    | 12/20 [01:31<00:57,  7.23s/it]
Task 9, Epoch 13/20 => Loss 0.125, Train_accy 96.88:  65%|██████▌   | 13/20 [01:31<00:47,  6.77s/it]
Task 9, Epoch 14/20 => Loss 0.169, Train_accy 95.42:  65%|██████▌   | 13/20 [01:37<00:47,  6.77s/it]
Task 9, Epoch 14/20 => Loss 0.169, Train_accy 95.42:  70%|███████   | 14/20 [01:37<00:38,  6.43s/it]
Task 9, Epoch 15/20 => Loss 0.139, Train_accy 95.62, Test_accy 45.23:  70%|███████   | 14/20 [01:51<00:38,  6.43s/it]
Task 9, Epoch 15/20 => Loss 0.139, Train_accy 95.62, Test_accy 45.23:  75%|███████▌  | 15/20 [01:51<00:44,  8.89s/it]
Task 9, Epoch 16/20 => Loss 0.128, Train_accy 97.29:  75%|███████▌  | 15/20 [01:57<00:44,  8.89s/it]                 
Task 9, Epoch 16/20 => Loss 0.128, Train_accy 97.29:  80%|████████  | 16/20 [01:57<00:31,  7.92s/it]
Task 9, Epoch 17/20 => Loss 0.172, Train_accy 94.38:  80%|████████  | 16/20 [02:03<00:31,  7.92s/it]
Task 9, Epoch 17/20 => Loss 0.172, Train_accy 94.38:  85%|████████▌ | 17/20 [02:03<00:21,  7.25s/it]
Task 9, Epoch 18/20 => Loss 0.205, Train_accy 95.00:  85%|████████▌ | 17/20 [02:08<00:21,  7.25s/it]
Task 9, Epoch 18/20 => Loss 0.205, Train_accy 95.00:  90%|█████████ | 18/20 [02:08<00:13,  6.76s/it]
Task 9, Epoch 19/20 => Loss 0.133, Train_accy 96.67:  90%|█████████ | 18/20 [02:14<00:13,  6.76s/it]
Task 9, Epoch 19/20 => Loss 0.133, Train_accy 96.67:  95%|█████████▌| 19/20 [02:14<00:06,  6.43s/it]
Task 9, Epoch 20/20 => Loss 0.118, Train_accy 97.08, Test_accy 45.23:  95%|█████████▌| 19/20 [02:28<00:06,  6.43s/it]
Task 9, Epoch 20/20 => Loss 0.118, Train_accy 97.08, Test_accy 45.23: 100%|██████████| 20/20 [02:28<00:00,  8.88s/it]
Task 9, Epoch 20/20 => Loss 0.118, Train_accy 97.08, Test_accy 45.23: 100%|██████████| 20/20 [02:28<00:00,  7.45s/it]
2024-09-07 13:21:21,040 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.118, Train_accy 97.08, Test_accy 45.23
2024-09-07 13:21:30,091 [trainer.py] => No NME accuracy.
2024-09-07 13:21:30,092 [trainer.py] => CNN: {'total': 45.23, '00-19': 58.29, '20-39': 49.73, '40-59': 39.66, '60-79': 49.55, '80-99': 34.97, '100-119': 50.75, '120-139': 43.15, '140-159': 35.43, '160-179': 38.78, '180-199': 43.55, 'old': 45.38, 'new': 43.55}
2024-09-07 13:21:30,092 [trainer.py] => CNN top1 curve: [76.0, 67.78, 60.92, 58.31, 55.05, 53.13, 50.31, 47.84, 46.02, 45.23]
2024-09-07 13:21:30,092 [trainer.py] => CNN top5 curve: [94.86, 93.06, 87.61, 86.25, 83.23, 81.33, 79.3, 77.32, 75.2, 73.14]

Average Accuracy (CNN): 56.06
2024-09-07 13:21:30,092 [trainer.py] => Average Accuracy (CNN): 56.06 

Accuracy Matrix (CNN):
[[76.   73.14 70.29 69.71 67.43 66.86 62.29 61.71 60.   58.29]
 [ 0.   62.7  60.   58.38 57.3  57.3  55.14 54.05 50.81 49.73]
 [ 0.    0.   48.28 46.55 46.55 45.69 44.83 44.83 39.66 39.66]
 [ 0.    0.    0.   55.41 55.41 52.7  51.8  50.45 50.45 49.55]
 [ 0.    0.    0.    0.   43.36 37.76 37.76 37.06 34.97 34.97]
 [ 0.    0.    0.    0.    0.   52.99 52.24 51.49 52.99 50.75]
 [ 0.    0.    0.    0.    0.    0.   42.47 42.47 44.52 43.15]
 [ 0.    0.    0.    0.    0.    0.    0.   32.28 33.07 35.43]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   38.78 38.78]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   43.55]]
2024-09-07 13:21:30,094 [trainer.py] => Forgetting (CNN): 6.351111111111113
2024-09-07 13:21:32,859 [trainer.py] => config: ./exps/coda_prompt_ina_B0_Inc20.json
2024-09-07 13:21:32,872 [trainer.py] => prefix:  
2024-09-07 13:21:32,872 [trainer.py] => dataset: imageneta
2024-09-07 13:21:32,872 [trainer.py] => memory_size: 0
2024-09-07 13:21:32,872 [trainer.py] => memory_per_class: 0
2024-09-07 13:21:32,872 [trainer.py] => fixed_memory: False
2024-09-07 13:21:32,872 [trainer.py] => shuffle: True
2024-09-07 13:21:32,872 [trainer.py] => init_cls: 10
2024-09-07 13:21:32,872 [trainer.py] => increment: 10
2024-09-07 13:21:32,872 [trainer.py] => model_name: coda_prompt
2024-09-07 13:21:32,872 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-07 13:21:32,872 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 13:21:32,872 [trainer.py] => seed: 1993
2024-09-07 13:21:32,872 [trainer.py] => tuned_epoch: 20
2024-09-07 13:21:32,872 [trainer.py] => init_lr: 0.001
2024-09-07 13:21:32,872 [trainer.py] => batch_size: 48
2024-09-07 13:21:32,872 [trainer.py] => weight_decay: 0
2024-09-07 13:21:32,873 [trainer.py] => min_lr: 1e-05
2024-09-07 13:21:32,873 [trainer.py] => optimizer: adam
2024-09-07 13:21:32,873 [trainer.py] => scheduler: cosine
2024-09-07 13:21:32,873 [trainer.py] => reinit_optimizer: True
2024-09-07 13:21:32,873 [trainer.py] => pretrained: True
2024-09-07 13:21:32,873 [trainer.py] => drop: 0.0
2024-09-07 13:21:32,873 [trainer.py] => drop_path: 0.0
2024-09-07 13:21:32,873 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-07 13:21:32,901 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 13:21:34,847 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-07 13:21:34,848 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-07 13:21:34,848 [trainer.py] => All params: 89792456
2024-09-07 13:21:34,849 [trainer.py] => Trainable params: 89792456
2024-09-07 13:21:34,849 [coda_prompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.569, Train_accy 15.28:   0%|          | 0/20 [00:03<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.569, Train_accy 15.28:   5%|▌         | 1/20 [00:03<01:15,  3.95s/it]
Task 0, Epoch 2/20 => Loss 1.463, Train_accy 51.39:   5%|▌         | 1/20 [00:07<01:15,  3.95s/it]
Task 0, Epoch 2/20 => Loss 1.463, Train_accy 51.39:  10%|█         | 2/20 [00:07<01:06,  3.67s/it]
Task 0, Epoch 3/20 => Loss 0.989, Train_accy 66.32:  10%|█         | 2/20 [00:10<01:06,  3.67s/it]
Task 0, Epoch 3/20 => Loss 0.989, Train_accy 66.32:  15%|█▌        | 3/20 [00:10<01:01,  3.59s/it]
Task 0, Epoch 4/20 => Loss 0.719, Train_accy 79.17:  15%|█▌        | 3/20 [00:14<01:01,  3.59s/it]
Task 0, Epoch 4/20 => Loss 0.719, Train_accy 79.17:  20%|██        | 4/20 [00:14<00:56,  3.56s/it]
Task 0, Epoch 5/20 => Loss 0.488, Train_accy 88.19, Test_accy 68.83:  20%|██        | 4/20 [00:18<00:56,  3.56s/it]
Task 0, Epoch 5/20 => Loss 0.488, Train_accy 88.19, Test_accy 68.83:  25%|██▌       | 5/20 [00:18<00:57,  3.86s/it]
Task 0, Epoch 6/20 => Loss 0.418, Train_accy 88.89:  25%|██▌       | 5/20 [00:22<00:57,  3.86s/it]                 
Task 0, Epoch 6/20 => Loss 0.418, Train_accy 88.89:  30%|███       | 6/20 [00:22<00:52,  3.72s/it]
Task 0, Epoch 7/20 => Loss 0.346, Train_accy 93.06:  30%|███       | 6/20 [00:25<00:52,  3.72s/it]
Task 0, Epoch 7/20 => Loss 0.346, Train_accy 93.06:  35%|███▌      | 7/20 [00:25<00:47,  3.65s/it]
Task 0, Epoch 8/20 => Loss 0.333, Train_accy 94.10:  35%|███▌      | 7/20 [00:29<00:47,  3.65s/it]
Task 0, Epoch 8/20 => Loss 0.333, Train_accy 94.10:  40%|████      | 8/20 [00:29<00:43,  3.64s/it]
Task 0, Epoch 9/20 => Loss 0.266, Train_accy 93.40:  40%|████      | 8/20 [00:32<00:43,  3.64s/it]
Task 0, Epoch 9/20 => Loss 0.266, Train_accy 93.40:  45%|████▌     | 9/20 [00:32<00:39,  3.59s/it]
Task 0, Epoch 10/20 => Loss 0.231, Train_accy 95.83, Test_accy 75.32:  45%|████▌     | 9/20 [00:37<00:39,  3.59s/it]
Task 0, Epoch 10/20 => Loss 0.231, Train_accy 95.83, Test_accy 75.32:  50%|█████     | 10/20 [00:37<00:38,  3.85s/it]
Task 0, Epoch 11/20 => Loss 0.208, Train_accy 96.53:  50%|█████     | 10/20 [00:40<00:38,  3.85s/it]                 
Task 0, Epoch 11/20 => Loss 0.208, Train_accy 96.53:  55%|█████▌    | 11/20 [00:40<00:33,  3.73s/it]
Task 0, Epoch 12/20 => Loss 0.213, Train_accy 95.14:  55%|█████▌    | 11/20 [00:44<00:33,  3.73s/it]
Task 0, Epoch 12/20 => Loss 0.213, Train_accy 95.14:  60%|██████    | 12/20 [00:44<00:29,  3.65s/it]
Task 0, Epoch 13/20 => Loss 0.210, Train_accy 95.83:  60%|██████    | 12/20 [00:47<00:29,  3.65s/it]
Task 0, Epoch 13/20 => Loss 0.210, Train_accy 95.83:  65%|██████▌   | 13/20 [00:47<00:25,  3.61s/it]
Task 0, Epoch 14/20 => Loss 0.195, Train_accy 95.83:  65%|██████▌   | 13/20 [00:51<00:25,  3.61s/it]
Task 0, Epoch 14/20 => Loss 0.195, Train_accy 95.83:  70%|███████   | 14/20 [00:51<00:21,  3.59s/it]
Task 0, Epoch 15/20 => Loss 0.153, Train_accy 96.88, Test_accy 75.32:  70%|███████   | 14/20 [00:55<00:21,  3.59s/it]
Task 0, Epoch 15/20 => Loss 0.153, Train_accy 96.88, Test_accy 75.32:  75%|███████▌  | 15/20 [00:55<00:19,  3.83s/it]
Task 0, Epoch 16/20 => Loss 0.185, Train_accy 94.79:  75%|███████▌  | 15/20 [00:59<00:19,  3.83s/it]                 
Task 0, Epoch 16/20 => Loss 0.185, Train_accy 94.79:  80%|████████  | 16/20 [00:59<00:14,  3.73s/it]
Task 0, Epoch 17/20 => Loss 0.171, Train_accy 96.53:  80%|████████  | 16/20 [01:02<00:14,  3.73s/it]
Task 0, Epoch 17/20 => Loss 0.171, Train_accy 96.53:  85%|████████▌ | 17/20 [01:02<00:11,  3.68s/it]
Task 0, Epoch 18/20 => Loss 0.148, Train_accy 97.57:  85%|████████▌ | 17/20 [01:06<00:11,  3.68s/it]
Task 0, Epoch 18/20 => Loss 0.148, Train_accy 97.57:  90%|█████████ | 18/20 [01:06<00:07,  3.62s/it]
Task 0, Epoch 19/20 => Loss 0.155, Train_accy 96.88:  90%|█████████ | 18/20 [01:09<00:07,  3.62s/it]
Task 0, Epoch 19/20 => Loss 0.155, Train_accy 96.88:  95%|█████████▌| 19/20 [01:09<00:03,  3.61s/it]
Task 0, Epoch 20/20 => Loss 0.154, Train_accy 96.18, Test_accy 75.32:  95%|█████████▌| 19/20 [01:14<00:03,  3.61s/it]
Task 0, Epoch 20/20 => Loss 0.154, Train_accy 96.18, Test_accy 75.32: 100%|██████████| 20/20 [01:14<00:00,  3.84s/it]
Task 0, Epoch 20/20 => Loss 0.154, Train_accy 96.18, Test_accy 75.32: 100%|██████████| 20/20 [01:14<00:00,  3.71s/it]
2024-09-07 13:22:49,524 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.154, Train_accy 96.18, Test_accy 75.32
2024-09-07 13:22:50,409 [trainer.py] => No NME accuracy.
2024-09-07 13:22:50,410 [trainer.py] => CNN: {'total': 75.32, '00-09': 75.32, 'old': 0, 'new': 75.32}
2024-09-07 13:22:50,410 [trainer.py] => CNN top1 curve: [75.32]
2024-09-07 13:22:50,410 [trainer.py] => CNN top5 curve: [93.51]

Average Accuracy (CNN): 75.32
2024-09-07 13:22:50,410 [trainer.py] => Average Accuracy (CNN): 75.32 

2024-09-07 13:22:50,412 [trainer.py] => All params: 89792456
2024-09-07 13:22:50,413 [trainer.py] => Trainable params: 89792456
2024-09-07 13:22:50,504 [coda_prompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.103, Train_accy 35.16:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.103, Train_accy 35.16:   5%|▌         | 1/20 [00:04<01:25,  4.50s/it]
Task 1, Epoch 2/20 => Loss 0.980, Train_accy 68.49:   5%|▌         | 1/20 [00:09<01:25,  4.50s/it]
Task 1, Epoch 2/20 => Loss 0.980, Train_accy 68.49:  10%|█         | 2/20 [00:09<01:21,  4.51s/it]
Task 1, Epoch 3/20 => Loss 0.611, Train_accy 79.95:  10%|█         | 2/20 [00:13<01:21,  4.51s/it]
Task 1, Epoch 3/20 => Loss 0.611, Train_accy 79.95:  15%|█▌        | 3/20 [00:13<01:17,  4.53s/it]
Task 1, Epoch 4/20 => Loss 0.422, Train_accy 88.28:  15%|█▌        | 3/20 [00:18<01:17,  4.53s/it]
Task 1, Epoch 4/20 => Loss 0.422, Train_accy 88.28:  20%|██        | 4/20 [00:18<01:12,  4.53s/it]
Task 1, Epoch 5/20 => Loss 0.315, Train_accy 91.67, Test_accy 67.43:  20%|██        | 4/20 [00:24<01:12,  4.53s/it]
Task 1, Epoch 5/20 => Loss 0.315, Train_accy 91.67, Test_accy 67.43:  25%|██▌       | 5/20 [00:24<01:15,  5.07s/it]
Task 1, Epoch 6/20 => Loss 0.269, Train_accy 92.71:  25%|██▌       | 5/20 [00:28<01:15,  5.07s/it]                 
Task 1, Epoch 6/20 => Loss 0.269, Train_accy 92.71:  30%|███       | 6/20 [00:28<01:08,  4.89s/it]
Task 1, Epoch 7/20 => Loss 0.259, Train_accy 93.49:  30%|███       | 6/20 [00:33<01:08,  4.89s/it]
Task 1, Epoch 7/20 => Loss 0.259, Train_accy 93.49:  35%|███▌      | 7/20 [00:33<01:02,  4.77s/it]
Task 1, Epoch 8/20 => Loss 0.201, Train_accy 95.05:  35%|███▌      | 7/20 [00:37<01:02,  4.77s/it]
Task 1, Epoch 8/20 => Loss 0.201, Train_accy 95.05:  40%|████      | 8/20 [00:37<00:56,  4.71s/it]
Task 1, Epoch 9/20 => Loss 0.204, Train_accy 94.53:  40%|████      | 8/20 [00:42<00:56,  4.71s/it]
Task 1, Epoch 9/20 => Loss 0.204, Train_accy 94.53:  45%|████▌     | 9/20 [00:42<00:51,  4.65s/it]
Task 1, Epoch 10/20 => Loss 0.121, Train_accy 98.44, Test_accy 66.86:  45%|████▌     | 9/20 [00:48<00:51,  4.65s/it]
Task 1, Epoch 10/20 => Loss 0.121, Train_accy 98.44, Test_accy 66.86:  50%|█████     | 10/20 [00:48<00:50,  5.06s/it]
Task 1, Epoch 11/20 => Loss 0.165, Train_accy 96.35:  50%|█████     | 10/20 [00:52<00:50,  5.06s/it]                 
Task 1, Epoch 11/20 => Loss 0.165, Train_accy 96.35:  55%|█████▌    | 11/20 [00:52<00:44,  4.90s/it]
Task 1, Epoch 12/20 => Loss 0.136, Train_accy 95.83:  55%|█████▌    | 11/20 [00:57<00:44,  4.90s/it]
Task 1, Epoch 12/20 => Loss 0.136, Train_accy 95.83:  60%|██████    | 12/20 [00:57<00:38,  4.79s/it]
Task 1, Epoch 13/20 => Loss 0.134, Train_accy 97.92:  60%|██████    | 12/20 [01:01<00:38,  4.79s/it]
Task 1, Epoch 13/20 => Loss 0.134, Train_accy 97.92:  65%|██████▌   | 13/20 [01:01<00:33,  4.71s/it]
Task 1, Epoch 14/20 => Loss 0.125, Train_accy 96.88:  65%|██████▌   | 13/20 [01:06<00:33,  4.71s/it]
Task 1, Epoch 14/20 => Loss 0.125, Train_accy 96.88:  70%|███████   | 14/20 [01:06<00:27,  4.66s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 97.14, Test_accy 68.57:  70%|███████   | 14/20 [01:12<00:27,  4.66s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 97.14, Test_accy 68.57:  75%|███████▌  | 15/20 [01:12<00:25,  5.06s/it]
Task 1, Epoch 16/20 => Loss 0.180, Train_accy 94.53:  75%|███████▌  | 15/20 [01:16<00:25,  5.06s/it]                 
Task 1, Epoch 16/20 => Loss 0.180, Train_accy 94.53:  80%|████████  | 16/20 [01:16<00:19,  4.88s/it]
Task 1, Epoch 17/20 => Loss 0.100, Train_accy 96.61:  80%|████████  | 16/20 [01:21<00:19,  4.88s/it]
Task 1, Epoch 17/20 => Loss 0.100, Train_accy 96.61:  85%|████████▌ | 17/20 [01:21<00:14,  4.78s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 96.88:  85%|████████▌ | 17/20 [01:25<00:14,  4.78s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 96.88:  90%|█████████ | 18/20 [01:25<00:09,  4.72s/it]
Task 1, Epoch 19/20 => Loss 0.087, Train_accy 97.92:  90%|█████████ | 18/20 [01:30<00:09,  4.72s/it]
Task 1, Epoch 19/20 => Loss 0.087, Train_accy 97.92:  95%|█████████▌| 19/20 [01:30<00:04,  4.69s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 96.09, Test_accy 69.14:  95%|█████████▌| 19/20 [01:36<00:04,  4.69s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 96.09, Test_accy 69.14: 100%|██████████| 20/20 [01:36<00:00,  5.08s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 96.09, Test_accy 69.14: 100%|██████████| 20/20 [01:36<00:00,  4.83s/it]
2024-09-07 13:24:27,108 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.130, Train_accy 96.09, Test_accy 69.14
2024-09-07 13:24:28,537 [trainer.py] => No NME accuracy.
2024-09-07 13:24:28,537 [trainer.py] => CNN: {'total': 69.14, '00-09': 55.84, '10-19': 79.59, 'old': 55.84, 'new': 79.59}
2024-09-07 13:24:28,537 [trainer.py] => CNN top1 curve: [75.32, 69.14]
2024-09-07 13:24:28,537 [trainer.py] => CNN top5 curve: [93.51, 92.0]

Average Accuracy (CNN): 72.23
2024-09-07 13:24:28,538 [trainer.py] => Average Accuracy (CNN): 72.23 

2024-09-07 13:24:28,539 [trainer.py] => All params: 89792456
2024-09-07 13:24:28,540 [trainer.py] => Trainable params: 89792456
2024-09-07 13:24:28,679 [coda_prompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.590, Train_accy 19.05:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.590, Train_accy 19.05:   5%|▌         | 1/20 [00:04<01:16,  4.02s/it]
Task 2, Epoch 2/20 => Loss 1.382, Train_accy 54.17:   5%|▌         | 1/20 [00:08<01:16,  4.02s/it]
Task 2, Epoch 2/20 => Loss 1.382, Train_accy 54.17:  10%|█         | 2/20 [00:08<01:12,  4.05s/it]
Task 2, Epoch 3/20 => Loss 0.919, Train_accy 70.83:  10%|█         | 2/20 [00:12<01:12,  4.05s/it]
Task 2, Epoch 3/20 => Loss 0.919, Train_accy 70.83:  15%|█▌        | 3/20 [00:12<01:08,  4.05s/it]
Task 2, Epoch 4/20 => Loss 0.666, Train_accy 80.06:  15%|█▌        | 3/20 [00:16<01:08,  4.05s/it]
Task 2, Epoch 4/20 => Loss 0.666, Train_accy 80.06:  20%|██        | 4/20 [00:16<01:04,  4.05s/it]
Task 2, Epoch 5/20 => Loss 0.540, Train_accy 84.23, Test_accy 61.31:  20%|██        | 4/20 [00:22<01:04,  4.05s/it]
Task 2, Epoch 5/20 => Loss 0.540, Train_accy 84.23, Test_accy 61.31:  25%|██▌       | 5/20 [00:22<01:11,  4.79s/it]
Task 2, Epoch 6/20 => Loss 0.504, Train_accy 86.31:  25%|██▌       | 5/20 [00:26<01:11,  4.79s/it]                 
Task 2, Epoch 6/20 => Loss 0.504, Train_accy 86.31:  30%|███       | 6/20 [00:26<01:03,  4.54s/it]
Task 2, Epoch 7/20 => Loss 0.312, Train_accy 93.45:  30%|███       | 6/20 [00:30<01:03,  4.54s/it]
Task 2, Epoch 7/20 => Loss 0.312, Train_accy 93.45:  35%|███▌      | 7/20 [00:30<00:56,  4.37s/it]
Task 2, Epoch 8/20 => Loss 0.299, Train_accy 93.15:  35%|███▌      | 7/20 [00:34<00:56,  4.37s/it]
Task 2, Epoch 8/20 => Loss 0.299, Train_accy 93.15:  40%|████      | 8/20 [00:34<00:51,  4.25s/it]
Task 2, Epoch 9/20 => Loss 0.267, Train_accy 94.05:  40%|████      | 8/20 [00:38<00:51,  4.25s/it]
Task 2, Epoch 9/20 => Loss 0.267, Train_accy 94.05:  45%|████▌     | 9/20 [00:38<00:46,  4.20s/it]
Task 2, Epoch 10/20 => Loss 0.213, Train_accy 96.13, Test_accy 63.50:  45%|████▌     | 9/20 [00:44<00:46,  4.20s/it]
Task 2, Epoch 10/20 => Loss 0.213, Train_accy 96.13, Test_accy 63.50:  50%|█████     | 10/20 [00:44<00:48,  4.81s/it]
Task 2, Epoch 11/20 => Loss 0.234, Train_accy 94.35:  50%|█████     | 10/20 [00:48<00:48,  4.81s/it]                 
Task 2, Epoch 11/20 => Loss 0.234, Train_accy 94.35:  55%|█████▌    | 11/20 [00:48<00:41,  4.58s/it]
Task 2, Epoch 12/20 => Loss 0.230, Train_accy 93.75:  55%|█████▌    | 11/20 [00:52<00:41,  4.58s/it]
Task 2, Epoch 12/20 => Loss 0.230, Train_accy 93.75:  60%|██████    | 12/20 [00:52<00:35,  4.41s/it]
Task 2, Epoch 13/20 => Loss 0.172, Train_accy 95.83:  60%|██████    | 12/20 [00:56<00:35,  4.41s/it]
Task 2, Epoch 13/20 => Loss 0.172, Train_accy 95.83:  65%|██████▌   | 13/20 [00:56<00:30,  4.30s/it]
Task 2, Epoch 14/20 => Loss 0.222, Train_accy 94.94:  65%|██████▌   | 13/20 [01:00<00:30,  4.30s/it]
Task 2, Epoch 14/20 => Loss 0.222, Train_accy 94.94:  70%|███████   | 14/20 [01:00<00:25,  4.22s/it]
Task 2, Epoch 15/20 => Loss 0.173, Train_accy 96.73, Test_accy 63.50:  70%|███████   | 14/20 [01:06<00:25,  4.22s/it]
Task 2, Epoch 15/20 => Loss 0.173, Train_accy 96.73, Test_accy 63.50:  75%|███████▌  | 15/20 [01:06<00:23,  4.77s/it]
Task 2, Epoch 16/20 => Loss 0.190, Train_accy 93.75:  75%|███████▌  | 15/20 [01:10<00:23,  4.77s/it]                 
Task 2, Epoch 16/20 => Loss 0.190, Train_accy 93.75:  80%|████████  | 16/20 [01:10<00:18,  4.55s/it]
Task 2, Epoch 17/20 => Loss 0.155, Train_accy 95.83:  80%|████████  | 16/20 [01:14<00:18,  4.55s/it]
Task 2, Epoch 17/20 => Loss 0.155, Train_accy 95.83:  85%|████████▌ | 17/20 [01:14<00:13,  4.41s/it]
Task 2, Epoch 18/20 => Loss 0.143, Train_accy 96.13:  85%|████████▌ | 17/20 [01:19<00:13,  4.41s/it]
Task 2, Epoch 18/20 => Loss 0.143, Train_accy 96.13:  90%|█████████ | 18/20 [01:19<00:08,  4.30s/it]
Task 2, Epoch 19/20 => Loss 0.148, Train_accy 95.83:  90%|█████████ | 18/20 [01:23<00:08,  4.30s/it]
Task 2, Epoch 19/20 => Loss 0.148, Train_accy 95.83:  95%|█████████▌| 19/20 [01:23<00:04,  4.22s/it]
Task 2, Epoch 20/20 => Loss 0.169, Train_accy 95.83, Test_accy 63.50:  95%|█████████▌| 19/20 [01:29<00:04,  4.22s/it]
Task 2, Epoch 20/20 => Loss 0.169, Train_accy 95.83, Test_accy 63.50: 100%|██████████| 20/20 [01:29<00:00,  4.79s/it]
Task 2, Epoch 20/20 => Loss 0.169, Train_accy 95.83, Test_accy 63.50: 100%|██████████| 20/20 [01:29<00:00,  4.46s/it]
2024-09-07 13:25:57,849 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.169, Train_accy 95.83, Test_accy 63.50
2024-09-07 13:25:59,824 [trainer.py] => No NME accuracy.
2024-09-07 13:25:59,824 [trainer.py] => CNN: {'total': 63.5, '00-09': 53.25, '10-19': 72.45, '20-29': 62.63, 'old': 64.0, 'new': 62.63}
2024-09-07 13:25:59,825 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5]
2024-09-07 13:25:59,825 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78]

Average Accuracy (CNN): 69.32
2024-09-07 13:25:59,825 [trainer.py] => Average Accuracy (CNN): 69.32 

2024-09-07 13:25:59,826 [trainer.py] => All params: 89792456
2024-09-07 13:25:59,827 [trainer.py] => Trainable params: 89792456
2024-09-07 13:26:00,008 [coda_prompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.416, Train_accy 25.78:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.416, Train_accy 25.78:   5%|▌         | 1/20 [00:04<01:26,  4.55s/it]
Task 3, Epoch 2/20 => Loss 1.269, Train_accy 56.25:   5%|▌         | 1/20 [00:09<01:26,  4.55s/it]
Task 3, Epoch 2/20 => Loss 1.269, Train_accy 56.25:  10%|█         | 2/20 [00:09<01:21,  4.55s/it]
Task 3, Epoch 3/20 => Loss 0.796, Train_accy 74.22:  10%|█         | 2/20 [00:13<01:21,  4.55s/it]
Task 3, Epoch 3/20 => Loss 0.796, Train_accy 74.22:  15%|█▌        | 3/20 [00:13<01:17,  4.55s/it]
Task 3, Epoch 4/20 => Loss 0.556, Train_accy 81.77:  15%|█▌        | 3/20 [00:18<01:17,  4.55s/it]
Task 3, Epoch 4/20 => Loss 0.556, Train_accy 81.77:  20%|██        | 4/20 [00:18<01:13,  4.58s/it]
Task 3, Epoch 5/20 => Loss 0.463, Train_accy 85.42, Test_accy 60.00:  20%|██        | 4/20 [00:25<01:13,  4.58s/it]
Task 3, Epoch 5/20 => Loss 0.463, Train_accy 85.42, Test_accy 60.00:  25%|██▌       | 5/20 [00:25<01:21,  5.46s/it]
Task 3, Epoch 6/20 => Loss 0.409, Train_accy 86.98:  25%|██▌       | 5/20 [00:29<01:21,  5.46s/it]                 
Task 3, Epoch 6/20 => Loss 0.409, Train_accy 86.98:  30%|███       | 6/20 [00:29<01:12,  5.17s/it]
Task 3, Epoch 7/20 => Loss 0.313, Train_accy 90.10:  30%|███       | 6/20 [00:34<01:12,  5.17s/it]
Task 3, Epoch 7/20 => Loss 0.313, Train_accy 90.10:  35%|███▌      | 7/20 [00:34<01:04,  4.96s/it]
Task 3, Epoch 8/20 => Loss 0.259, Train_accy 92.45:  35%|███▌      | 7/20 [00:39<01:04,  4.96s/it]
Task 3, Epoch 8/20 => Loss 0.259, Train_accy 92.45:  40%|████      | 8/20 [00:39<00:58,  4.84s/it]
Task 3, Epoch 9/20 => Loss 0.239, Train_accy 93.23:  40%|████      | 8/20 [00:43<00:58,  4.84s/it]
Task 3, Epoch 9/20 => Loss 0.239, Train_accy 93.23:  45%|████▌     | 9/20 [00:43<00:52,  4.75s/it]
Task 3, Epoch 10/20 => Loss 0.223, Train_accy 94.01, Test_accy 62.22:  45%|████▌     | 9/20 [00:50<00:52,  4.75s/it]
Task 3, Epoch 10/20 => Loss 0.223, Train_accy 94.01, Test_accy 62.22:  50%|█████     | 10/20 [00:50<00:54,  5.45s/it]
Task 3, Epoch 11/20 => Loss 0.236, Train_accy 92.19:  50%|█████     | 10/20 [00:55<00:54,  5.45s/it]                 
Task 3, Epoch 11/20 => Loss 0.236, Train_accy 92.19:  55%|█████▌    | 11/20 [00:55<00:46,  5.16s/it]
Task 3, Epoch 12/20 => Loss 0.201, Train_accy 94.79:  55%|█████▌    | 11/20 [00:59<00:46,  5.16s/it]
Task 3, Epoch 12/20 => Loss 0.201, Train_accy 94.79:  60%|██████    | 12/20 [00:59<00:39,  4.98s/it]
Task 3, Epoch 13/20 => Loss 0.173, Train_accy 96.61:  60%|██████    | 12/20 [01:04<00:39,  4.98s/it]
Task 3, Epoch 13/20 => Loss 0.173, Train_accy 96.61:  65%|██████▌   | 13/20 [01:04<00:33,  4.84s/it]
Task 3, Epoch 14/20 => Loss 0.180, Train_accy 93.75:  65%|██████▌   | 13/20 [01:08<00:33,  4.84s/it]
Task 3, Epoch 14/20 => Loss 0.180, Train_accy 93.75:  70%|███████   | 14/20 [01:08<00:28,  4.75s/it]
Task 3, Epoch 15/20 => Loss 0.223, Train_accy 94.53, Test_accy 62.50:  70%|███████   | 14/20 [01:15<00:28,  4.75s/it]
Task 3, Epoch 15/20 => Loss 0.223, Train_accy 94.53, Test_accy 62.50:  75%|███████▌  | 15/20 [01:15<00:27,  5.45s/it]
Task 3, Epoch 16/20 => Loss 0.207, Train_accy 93.75:  75%|███████▌  | 15/20 [01:20<00:27,  5.45s/it]                 
Task 3, Epoch 16/20 => Loss 0.207, Train_accy 93.75:  80%|████████  | 16/20 [01:20<00:20,  5.18s/it]
Task 3, Epoch 17/20 => Loss 0.152, Train_accy 96.35:  80%|████████  | 16/20 [01:24<00:20,  5.18s/it]
Task 3, Epoch 17/20 => Loss 0.152, Train_accy 96.35:  85%|████████▌ | 17/20 [01:24<00:15,  5.01s/it]
Task 3, Epoch 18/20 => Loss 0.181, Train_accy 96.35:  85%|████████▌ | 17/20 [01:29<00:15,  5.01s/it]
Task 3, Epoch 18/20 => Loss 0.181, Train_accy 96.35:  90%|█████████ | 18/20 [01:29<00:09,  4.88s/it]
Task 3, Epoch 19/20 => Loss 0.144, Train_accy 96.61:  90%|█████████ | 18/20 [01:34<00:09,  4.88s/it]
Task 3, Epoch 19/20 => Loss 0.144, Train_accy 96.61:  95%|█████████▌| 19/20 [01:34<00:04,  4.78s/it]
Task 3, Epoch 20/20 => Loss 0.178, Train_accy 95.57, Test_accy 63.33:  95%|█████████▌| 19/20 [01:41<00:04,  4.78s/it]
Task 3, Epoch 20/20 => Loss 0.178, Train_accy 95.57, Test_accy 63.33: 100%|██████████| 20/20 [01:41<00:00,  5.47s/it]
Task 3, Epoch 20/20 => Loss 0.178, Train_accy 95.57, Test_accy 63.33: 100%|██████████| 20/20 [01:41<00:00,  5.06s/it]
2024-09-07 13:27:41,180 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.178, Train_accy 95.57, Test_accy 63.33
2024-09-07 13:27:43,652 [trainer.py] => No NME accuracy.
2024-09-07 13:27:43,652 [trainer.py] => CNN: {'total': 63.33, '00-09': 55.84, '10-19': 71.43, '20-29': 61.62, '30-39': 62.79, 'old': 63.5, 'new': 62.79}
2024-09-07 13:27:43,652 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33]
2024-09-07 13:27:43,653 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06]

Average Accuracy (CNN): 67.82
2024-09-07 13:27:43,653 [trainer.py] => Average Accuracy (CNN): 67.82 

2024-09-07 13:27:43,654 [trainer.py] => All params: 89792456
2024-09-07 13:27:43,656 [trainer.py] => Trainable params: 89792456
2024-09-07 13:27:43,892 [coda_prompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.804, Train_accy 15.83:   0%|          | 0/20 [00:02<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.804, Train_accy 15.83:   5%|▌         | 1/20 [00:02<00:56,  3.00s/it]
Task 4, Epoch 2/20 => Loss 1.665, Train_accy 47.08:   5%|▌         | 1/20 [00:05<00:56,  3.00s/it]
Task 4, Epoch 2/20 => Loss 1.665, Train_accy 47.08:  10%|█         | 2/20 [00:05<00:53,  2.98s/it]
Task 4, Epoch 3/20 => Loss 1.042, Train_accy 62.92:  10%|█         | 2/20 [00:08<00:53,  2.98s/it]
Task 4, Epoch 3/20 => Loss 1.042, Train_accy 62.92:  15%|█▌        | 3/20 [00:08<00:50,  3.00s/it]
Task 4, Epoch 4/20 => Loss 0.728, Train_accy 75.42:  15%|█▌        | 3/20 [00:11<00:50,  3.00s/it]
Task 4, Epoch 4/20 => Loss 0.728, Train_accy 75.42:  20%|██        | 4/20 [00:11<00:47,  2.99s/it]
Task 4, Epoch 5/20 => Loss 0.533, Train_accy 84.17, Test_accy 55.90:  20%|██        | 4/20 [00:17<00:47,  2.99s/it]
Task 4, Epoch 5/20 => Loss 0.533, Train_accy 84.17, Test_accy 55.90:  25%|██▌       | 5/20 [00:17<01:00,  4.02s/it]
Task 4, Epoch 6/20 => Loss 0.369, Train_accy 91.67:  25%|██▌       | 5/20 [00:20<01:00,  4.02s/it]                 
Task 4, Epoch 6/20 => Loss 0.369, Train_accy 91.67:  30%|███       | 6/20 [00:20<00:51,  3.68s/it]
Task 4, Epoch 7/20 => Loss 0.342, Train_accy 88.33:  30%|███       | 6/20 [00:23<00:51,  3.68s/it]
Task 4, Epoch 7/20 => Loss 0.342, Train_accy 88.33:  35%|███▌      | 7/20 [00:23<00:44,  3.45s/it]
Task 4, Epoch 8/20 => Loss 0.225, Train_accy 93.33:  35%|███▌      | 7/20 [00:26<00:44,  3.45s/it]
Task 4, Epoch 8/20 => Loss 0.225, Train_accy 93.33:  40%|████      | 8/20 [00:26<00:39,  3.33s/it]
Task 4, Epoch 9/20 => Loss 0.173, Train_accy 95.42:  40%|████      | 8/20 [00:29<00:39,  3.33s/it]
Task 4, Epoch 9/20 => Loss 0.173, Train_accy 95.42:  45%|████▌     | 9/20 [00:29<00:35,  3.22s/it]
Task 4, Epoch 10/20 => Loss 0.157, Train_accy 96.25, Test_accy 58.73:  45%|████▌     | 9/20 [00:35<00:35,  3.22s/it]
Task 4, Epoch 10/20 => Loss 0.157, Train_accy 96.25, Test_accy 58.73:  50%|█████     | 10/20 [00:35<00:40,  4.03s/it]
Task 4, Epoch 11/20 => Loss 0.165, Train_accy 97.50:  50%|█████     | 10/20 [00:38<00:40,  4.03s/it]                 
Task 4, Epoch 11/20 => Loss 0.165, Train_accy 97.50:  55%|█████▌    | 11/20 [00:38<00:33,  3.70s/it]
Task 4, Epoch 12/20 => Loss 0.222, Train_accy 92.50:  55%|█████▌    | 11/20 [00:41<00:33,  3.70s/it]
Task 4, Epoch 12/20 => Loss 0.222, Train_accy 92.50:  60%|██████    | 12/20 [00:41<00:27,  3.49s/it]
Task 4, Epoch 13/20 => Loss 0.150, Train_accy 95.83:  60%|██████    | 12/20 [00:44<00:27,  3.49s/it]
Task 4, Epoch 13/20 => Loss 0.150, Train_accy 95.83:  65%|██████▌   | 13/20 [00:44<00:23,  3.34s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 95.00:  65%|██████▌   | 13/20 [00:47<00:23,  3.34s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 95.00:  70%|███████   | 14/20 [00:47<00:19,  3.24s/it]
Task 4, Epoch 15/20 => Loss 0.212, Train_accy 95.42, Test_accy 59.20:  70%|███████   | 14/20 [00:53<00:19,  3.24s/it]
Task 4, Epoch 15/20 => Loss 0.212, Train_accy 95.42, Test_accy 59.20:  75%|███████▌  | 15/20 [00:53<00:20,  4.01s/it]
Task 4, Epoch 16/20 => Loss 0.116, Train_accy 97.92:  75%|███████▌  | 15/20 [00:56<00:20,  4.01s/it]                 
Task 4, Epoch 16/20 => Loss 0.116, Train_accy 97.92:  80%|████████  | 16/20 [00:56<00:14,  3.70s/it]
Task 4, Epoch 17/20 => Loss 0.121, Train_accy 98.33:  80%|████████  | 16/20 [00:59<00:14,  3.70s/it]
Task 4, Epoch 17/20 => Loss 0.121, Train_accy 98.33:  85%|████████▌ | 17/20 [00:59<00:10,  3.49s/it]
Task 4, Epoch 18/20 => Loss 0.113, Train_accy 97.92:  85%|████████▌ | 17/20 [01:02<00:10,  3.49s/it]
Task 4, Epoch 18/20 => Loss 0.113, Train_accy 97.92:  90%|█████████ | 18/20 [01:02<00:06,  3.34s/it]
Task 4, Epoch 19/20 => Loss 0.148, Train_accy 96.67:  90%|█████████ | 18/20 [01:05<00:06,  3.34s/it]
Task 4, Epoch 19/20 => Loss 0.148, Train_accy 96.67:  95%|█████████▌| 19/20 [01:05<00:03,  3.24s/it]
Task 4, Epoch 20/20 => Loss 0.099, Train_accy 97.92, Test_accy 58.73:  95%|█████████▌| 19/20 [01:11<00:03,  3.24s/it]
Task 4, Epoch 20/20 => Loss 0.099, Train_accy 97.92, Test_accy 58.73: 100%|██████████| 20/20 [01:11<00:00,  4.02s/it]
Task 4, Epoch 20/20 => Loss 0.099, Train_accy 97.92, Test_accy 58.73: 100%|██████████| 20/20 [01:11<00:00,  3.56s/it]
2024-09-07 13:28:55,180 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.099, Train_accy 97.92, Test_accy 58.73
2024-09-07 13:28:58,042 [trainer.py] => No NME accuracy.
2024-09-07 13:28:58,042 [trainer.py] => CNN: {'total': 58.73, '00-09': 55.84, '10-19': 68.37, '20-29': 56.57, '30-39': 61.63, '40-49': 46.88, 'old': 60.83, 'new': 46.88}
2024-09-07 13:28:58,043 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73]
2024-09-07 13:28:58,043 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85]

Average Accuracy (CNN): 66.0
2024-09-07 13:28:58,043 [trainer.py] => Average Accuracy (CNN): 66.0 

2024-09-07 13:28:58,044 [trainer.py] => All params: 89792456
2024-09-07 13:28:58,045 [trainer.py] => Trainable params: 89792456
2024-09-07 13:28:58,318 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.368, Train_accy 25.42:   0%|          | 0/20 [00:02<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.368, Train_accy 25.42:   5%|▌         | 1/20 [00:02<00:56,  2.97s/it]
Task 5, Epoch 2/20 => Loss 1.296, Train_accy 58.75:   5%|▌         | 1/20 [00:05<00:56,  2.97s/it]
Task 5, Epoch 2/20 => Loss 1.296, Train_accy 58.75:  10%|█         | 2/20 [00:05<00:53,  2.98s/it]
Task 5, Epoch 3/20 => Loss 0.821, Train_accy 75.00:  10%|█         | 2/20 [00:08<00:53,  2.98s/it]
Task 5, Epoch 3/20 => Loss 0.821, Train_accy 75.00:  15%|█▌        | 3/20 [00:08<00:50,  2.98s/it]
Task 5, Epoch 4/20 => Loss 0.462, Train_accy 87.50:  15%|█▌        | 3/20 [00:11<00:50,  2.98s/it]
Task 5, Epoch 4/20 => Loss 0.462, Train_accy 87.50:  20%|██        | 4/20 [00:11<00:47,  2.98s/it]
Task 5, Epoch 5/20 => Loss 0.364, Train_accy 90.83, Test_accy 54.62:  20%|██        | 4/20 [00:18<00:47,  2.98s/it]
Task 5, Epoch 5/20 => Loss 0.364, Train_accy 90.83, Test_accy 54.62:  25%|██▌       | 5/20 [00:18<01:01,  4.12s/it]
Task 5, Epoch 6/20 => Loss 0.243, Train_accy 93.75:  25%|██▌       | 5/20 [00:20<01:01,  4.12s/it]                 
Task 5, Epoch 6/20 => Loss 0.243, Train_accy 93.75:  30%|███       | 6/20 [00:20<00:52,  3.72s/it]
Task 5, Epoch 7/20 => Loss 0.219, Train_accy 93.33:  30%|███       | 6/20 [00:23<00:52,  3.72s/it]
Task 5, Epoch 7/20 => Loss 0.219, Train_accy 93.33:  35%|███▌      | 7/20 [00:23<00:45,  3.48s/it]
Task 5, Epoch 8/20 => Loss 0.134, Train_accy 97.92:  35%|███▌      | 7/20 [00:26<00:45,  3.48s/it]
Task 5, Epoch 8/20 => Loss 0.134, Train_accy 97.92:  40%|████      | 8/20 [00:26<00:39,  3.32s/it]
Task 5, Epoch 9/20 => Loss 0.180, Train_accy 96.25:  40%|████      | 8/20 [00:29<00:39,  3.32s/it]
Task 5, Epoch 9/20 => Loss 0.180, Train_accy 96.25:  45%|████▌     | 9/20 [00:29<00:35,  3.21s/it]
Task 5, Epoch 10/20 => Loss 0.137, Train_accy 97.50, Test_accy 54.83:  45%|████▌     | 9/20 [00:36<00:35,  3.21s/it]
Task 5, Epoch 10/20 => Loss 0.137, Train_accy 97.50, Test_accy 54.83:  50%|█████     | 10/20 [00:36<00:40,  4.10s/it]
Task 5, Epoch 11/20 => Loss 0.136, Train_accy 96.25:  50%|█████     | 10/20 [00:38<00:40,  4.10s/it]                 
Task 5, Epoch 11/20 => Loss 0.136, Train_accy 96.25:  55%|█████▌    | 11/20 [00:38<00:33,  3.76s/it]
Task 5, Epoch 12/20 => Loss 0.094, Train_accy 98.33:  55%|█████▌    | 11/20 [00:41<00:33,  3.76s/it]
Task 5, Epoch 12/20 => Loss 0.094, Train_accy 98.33:  60%|██████    | 12/20 [00:41<00:28,  3.52s/it]
Task 5, Epoch 13/20 => Loss 0.130, Train_accy 96.25:  60%|██████    | 12/20 [00:44<00:28,  3.52s/it]
Task 5, Epoch 13/20 => Loss 0.130, Train_accy 96.25:  65%|██████▌   | 13/20 [00:44<00:23,  3.36s/it]
Task 5, Epoch 14/20 => Loss 0.089, Train_accy 98.75:  65%|██████▌   | 13/20 [00:48<00:23,  3.36s/it]
Task 5, Epoch 14/20 => Loss 0.089, Train_accy 98.75:  70%|███████   | 14/20 [00:48<00:19,  3.28s/it]
Task 5, Epoch 15/20 => Loss 0.120, Train_accy 96.25, Test_accy 54.83:  70%|███████   | 14/20 [00:54<00:19,  3.28s/it]
Task 5, Epoch 15/20 => Loss 0.120, Train_accy 96.25, Test_accy 54.83:  75%|███████▌  | 15/20 [00:54<00:21,  4.22s/it]
Task 5, Epoch 16/20 => Loss 0.058, Train_accy 99.17:  75%|███████▌  | 15/20 [00:57<00:21,  4.22s/it]                 
Task 5, Epoch 16/20 => Loss 0.058, Train_accy 99.17:  80%|████████  | 16/20 [00:57<00:15,  3.84s/it]
Task 5, Epoch 17/20 => Loss 0.088, Train_accy 97.92:  80%|████████  | 16/20 [01:00<00:15,  3.84s/it]
Task 5, Epoch 17/20 => Loss 0.088, Train_accy 97.92:  85%|████████▌ | 17/20 [01:00<00:10,  3.58s/it]
Task 5, Epoch 18/20 => Loss 0.121, Train_accy 96.25:  85%|████████▌ | 17/20 [01:03<00:10,  3.58s/it]
Task 5, Epoch 18/20 => Loss 0.121, Train_accy 96.25:  90%|█████████ | 18/20 [01:03<00:06,  3.41s/it]
Task 5, Epoch 19/20 => Loss 0.088, Train_accy 97.50:  90%|█████████ | 18/20 [01:06<00:06,  3.41s/it]
Task 5, Epoch 19/20 => Loss 0.088, Train_accy 97.50:  95%|█████████▌| 19/20 [01:06<00:03,  3.28s/it]
Task 5, Epoch 20/20 => Loss 0.085, Train_accy 97.50, Test_accy 54.83:  95%|█████████▌| 19/20 [01:12<00:03,  3.28s/it]
Task 5, Epoch 20/20 => Loss 0.085, Train_accy 97.50, Test_accy 54.83: 100%|██████████| 20/20 [01:12<00:00,  4.14s/it]
Task 5, Epoch 20/20 => Loss 0.085, Train_accy 97.50, Test_accy 54.83: 100%|██████████| 20/20 [01:12<00:00,  3.63s/it]
2024-09-07 13:30:10,869 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.085, Train_accy 97.50, Test_accy 54.83
2024-09-07 13:30:14,023 [trainer.py] => No NME accuracy.
2024-09-07 13:30:14,024 [trainer.py] => CNN: {'total': 54.83, '00-09': 53.25, '10-19': 68.37, '20-29': 52.53, '30-39': 60.47, '40-49': 45.31, '50-59': 38.46, 'old': 56.84, 'new': 38.46}
2024-09-07 13:30:14,024 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83]
2024-09-07 13:30:14,024 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82]

Average Accuracy (CNN): 64.14
2024-09-07 13:30:14,024 [trainer.py] => Average Accuracy (CNN): 64.14 

2024-09-07 13:30:14,026 [trainer.py] => All params: 89792456
2024-09-07 13:30:14,027 [trainer.py] => Trainable params: 89792456
2024-09-07 13:30:14,346 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.162, Train_accy 32.87:   0%|          | 0/20 [00:05<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.162, Train_accy 32.87:   5%|▌         | 1/20 [00:05<01:36,  5.09s/it]
Task 6, Epoch 2/20 => Loss 0.961, Train_accy 69.68:   5%|▌         | 1/20 [00:10<01:36,  5.09s/it]
Task 6, Epoch 2/20 => Loss 0.961, Train_accy 69.68:  10%|█         | 2/20 [00:10<01:32,  5.12s/it]
Task 6, Epoch 3/20 => Loss 0.559, Train_accy 81.71:  10%|█         | 2/20 [00:15<01:32,  5.12s/it]
Task 6, Epoch 3/20 => Loss 0.559, Train_accy 81.71:  15%|█▌        | 3/20 [00:15<01:26,  5.10s/it]
Task 6, Epoch 4/20 => Loss 0.361, Train_accy 87.96:  15%|█▌        | 3/20 [00:20<01:26,  5.10s/it]
Task 6, Epoch 4/20 => Loss 0.361, Train_accy 87.96:  20%|██        | 4/20 [00:20<01:21,  5.11s/it]
Task 6, Epoch 5/20 => Loss 0.303, Train_accy 91.20, Test_accy 51.00:  20%|██        | 4/20 [00:29<01:21,  5.11s/it]
Task 6, Epoch 5/20 => Loss 0.303, Train_accy 91.20, Test_accy 51.00:  25%|██▌       | 5/20 [00:29<01:37,  6.49s/it]
Task 6, Epoch 6/20 => Loss 0.226, Train_accy 91.90:  25%|██▌       | 5/20 [00:34<01:37,  6.49s/it]                 
Task 6, Epoch 6/20 => Loss 0.226, Train_accy 91.90:  30%|███       | 6/20 [00:34<01:24,  6.00s/it]
Task 6, Epoch 7/20 => Loss 0.224, Train_accy 94.68:  30%|███       | 6/20 [00:39<01:24,  6.00s/it]
Task 6, Epoch 7/20 => Loss 0.224, Train_accy 94.68:  35%|███▌      | 7/20 [00:39<01:14,  5.70s/it]
Task 6, Epoch 8/20 => Loss 0.175, Train_accy 95.37:  35%|███▌      | 7/20 [00:44<01:14,  5.70s/it]
Task 6, Epoch 8/20 => Loss 0.175, Train_accy 95.37:  40%|████      | 8/20 [00:44<01:06,  5.51s/it]
Task 6, Epoch 9/20 => Loss 0.257, Train_accy 90.74:  40%|████      | 8/20 [00:49<01:06,  5.51s/it]
Task 6, Epoch 9/20 => Loss 0.257, Train_accy 90.74:  45%|████▌     | 9/20 [00:49<00:59,  5.40s/it]
Task 6, Epoch 10/20 => Loss 0.201, Train_accy 93.75, Test_accy 51.66:  45%|████▌     | 9/20 [00:58<00:59,  5.40s/it]
Task 6, Epoch 10/20 => Loss 0.201, Train_accy 93.75, Test_accy 51.66:  50%|█████     | 10/20 [00:58<01:04,  6.50s/it]
Task 6, Epoch 11/20 => Loss 0.203, Train_accy 93.52:  50%|█████     | 10/20 [01:03<01:04,  6.50s/it]                 
Task 6, Epoch 11/20 => Loss 0.203, Train_accy 93.52:  55%|█████▌    | 11/20 [01:03<00:54,  6.08s/it]
Task 6, Epoch 12/20 => Loss 0.139, Train_accy 95.60:  55%|█████▌    | 11/20 [01:08<00:54,  6.08s/it]
Task 6, Epoch 12/20 => Loss 0.139, Train_accy 95.60:  60%|██████    | 12/20 [01:08<00:46,  5.78s/it]
Task 6, Epoch 13/20 => Loss 0.148, Train_accy 96.53:  60%|██████    | 12/20 [01:14<00:46,  5.78s/it]
Task 6, Epoch 13/20 => Loss 0.148, Train_accy 96.53:  65%|██████▌   | 13/20 [01:14<00:38,  5.57s/it]
Task 6, Epoch 14/20 => Loss 0.172, Train_accy 95.14:  65%|██████▌   | 13/20 [01:19<00:38,  5.57s/it]
Task 6, Epoch 14/20 => Loss 0.172, Train_accy 95.14:  70%|███████   | 14/20 [01:19<00:32,  5.44s/it]
Task 6, Epoch 15/20 => Loss 0.151, Train_accy 95.83, Test_accy 52.66:  70%|███████   | 14/20 [01:28<00:32,  5.44s/it]
Task 6, Epoch 15/20 => Loss 0.151, Train_accy 95.83, Test_accy 52.66:  75%|███████▌  | 15/20 [01:28<00:32,  6.48s/it]
Task 6, Epoch 16/20 => Loss 0.127, Train_accy 96.06:  75%|███████▌  | 15/20 [01:33<00:32,  6.48s/it]                 
Task 6, Epoch 16/20 => Loss 0.127, Train_accy 96.06:  80%|████████  | 16/20 [01:33<00:24,  6.07s/it]
Task 6, Epoch 17/20 => Loss 0.091, Train_accy 97.69:  80%|████████  | 16/20 [01:38<00:24,  6.07s/it]
Task 6, Epoch 17/20 => Loss 0.091, Train_accy 97.69:  85%|████████▌ | 17/20 [01:38<00:17,  5.77s/it]
Task 6, Epoch 18/20 => Loss 0.112, Train_accy 96.30:  85%|████████▌ | 17/20 [01:43<00:17,  5.77s/it]
Task 6, Epoch 18/20 => Loss 0.112, Train_accy 96.30:  90%|█████████ | 18/20 [01:43<00:11,  5.56s/it]
Task 6, Epoch 19/20 => Loss 0.104, Train_accy 97.45:  90%|█████████ | 18/20 [01:48<00:11,  5.56s/it]
Task 6, Epoch 19/20 => Loss 0.104, Train_accy 97.45:  95%|█████████▌| 19/20 [01:48<00:05,  5.42s/it]
Task 6, Epoch 20/20 => Loss 0.096, Train_accy 97.69, Test_accy 52.66:  95%|█████████▌| 19/20 [01:57<00:05,  5.42s/it]
Task 6, Epoch 20/20 => Loss 0.096, Train_accy 97.69, Test_accy 52.66: 100%|██████████| 20/20 [01:57<00:00,  6.46s/it]
Task 6, Epoch 20/20 => Loss 0.096, Train_accy 97.69, Test_accy 52.66: 100%|██████████| 20/20 [01:57<00:00,  5.87s/it]
2024-09-07 13:32:11,663 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.096, Train_accy 97.69, Test_accy 52.66
2024-09-07 13:32:15,486 [trainer.py] => No NME accuracy.
2024-09-07 13:32:15,487 [trainer.py] => CNN: {'total': 52.66, '00-09': 51.95, '10-19': 67.35, '20-29': 53.54, '30-39': 52.33, '40-49': 32.81, '50-59': 40.38, '60-69': 56.35, 'old': 51.68, 'new': 56.35}
2024-09-07 13:32:15,487 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66]
2024-09-07 13:32:15,487 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39]

Average Accuracy (CNN): 62.5
2024-09-07 13:32:15,487 [trainer.py] => Average Accuracy (CNN): 62.5 

2024-09-07 13:32:15,488 [trainer.py] => All params: 89792456
2024-09-07 13:32:15,488 [trainer.py] => Trainable params: 89792456
2024-09-07 13:32:15,860 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.682, Train_accy 21.43:   0%|          | 0/20 [00:04<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.682, Train_accy 21.43:   5%|▌         | 1/20 [00:04<01:16,  4.05s/it]
Task 7, Epoch 2/20 => Loss 1.143, Train_accy 63.10:   5%|▌         | 1/20 [00:08<01:16,  4.05s/it]
Task 7, Epoch 2/20 => Loss 1.143, Train_accy 63.10:  10%|█         | 2/20 [00:08<01:12,  4.04s/it]
Task 7, Epoch 3/20 => Loss 0.611, Train_accy 83.63:  10%|█         | 2/20 [00:12<01:12,  4.04s/it]
Task 7, Epoch 3/20 => Loss 0.611, Train_accy 83.63:  15%|█▌        | 3/20 [00:12<01:08,  4.05s/it]
Task 7, Epoch 4/20 => Loss 0.439, Train_accy 86.31:  15%|█▌        | 3/20 [00:16<01:08,  4.05s/it]
Task 7, Epoch 4/20 => Loss 0.439, Train_accy 86.31:  20%|██        | 4/20 [00:16<01:04,  4.04s/it]
Task 7, Epoch 5/20 => Loss 0.351, Train_accy 88.39, Test_accy 49.43:  20%|██        | 4/20 [00:24<01:04,  4.04s/it]
Task 7, Epoch 5/20 => Loss 0.351, Train_accy 88.39, Test_accy 49.43:  25%|██▌       | 5/20 [00:24<01:24,  5.61s/it]
Task 7, Epoch 6/20 => Loss 0.220, Train_accy 93.75:  25%|██▌       | 5/20 [00:28<01:24,  5.61s/it]                 
Task 7, Epoch 6/20 => Loss 0.220, Train_accy 93.75:  30%|███       | 6/20 [00:28<01:11,  5.08s/it]
Task 7, Epoch 7/20 => Loss 0.199, Train_accy 94.94:  30%|███       | 6/20 [00:32<01:11,  5.08s/it]
Task 7, Epoch 7/20 => Loss 0.199, Train_accy 94.94:  35%|███▌      | 7/20 [00:32<01:01,  4.74s/it]
Task 7, Epoch 8/20 => Loss 0.194, Train_accy 94.94:  35%|███▌      | 7/20 [00:36<01:01,  4.74s/it]
Task 7, Epoch 8/20 => Loss 0.194, Train_accy 94.94:  40%|████      | 8/20 [00:36<00:54,  4.52s/it]
Task 7, Epoch 9/20 => Loss 0.152, Train_accy 95.83:  40%|████      | 8/20 [00:40<00:54,  4.52s/it]
Task 7, Epoch 9/20 => Loss 0.152, Train_accy 95.83:  45%|████▌     | 9/20 [00:40<00:48,  4.37s/it]
Task 7, Epoch 10/20 => Loss 0.137, Train_accy 97.02, Test_accy 49.86:  45%|████▌     | 9/20 [00:49<00:48,  4.37s/it]
Task 7, Epoch 10/20 => Loss 0.137, Train_accy 97.02, Test_accy 49.86:  50%|█████     | 10/20 [00:49<00:56,  5.62s/it]
Task 7, Epoch 11/20 => Loss 0.163, Train_accy 94.94:  50%|█████     | 10/20 [00:53<00:56,  5.62s/it]                 
Task 7, Epoch 11/20 => Loss 0.163, Train_accy 94.94:  55%|█████▌    | 11/20 [00:53<00:46,  5.13s/it]
Task 7, Epoch 12/20 => Loss 0.134, Train_accy 96.13:  55%|█████▌    | 11/20 [00:57<00:46,  5.13s/it]
Task 7, Epoch 12/20 => Loss 0.134, Train_accy 96.13:  60%|██████    | 12/20 [00:57<00:38,  4.80s/it]
Task 7, Epoch 13/20 => Loss 0.131, Train_accy 95.54:  60%|██████    | 12/20 [01:01<00:38,  4.80s/it]
Task 7, Epoch 13/20 => Loss 0.131, Train_accy 95.54:  65%|██████▌   | 13/20 [01:01<00:32,  4.59s/it]
Task 7, Epoch 14/20 => Loss 0.119, Train_accy 96.43:  65%|██████▌   | 13/20 [01:05<00:32,  4.59s/it]
Task 7, Epoch 14/20 => Loss 0.119, Train_accy 96.43:  70%|███████   | 14/20 [01:05<00:26,  4.43s/it]
Task 7, Epoch 15/20 => Loss 0.120, Train_accy 95.54, Test_accy 50.14:  70%|███████   | 14/20 [01:13<00:26,  4.43s/it]
Task 7, Epoch 15/20 => Loss 0.120, Train_accy 95.54, Test_accy 50.14:  75%|███████▌  | 15/20 [01:13<00:28,  5.63s/it]
Task 7, Epoch 16/20 => Loss 0.114, Train_accy 96.73:  75%|███████▌  | 15/20 [01:17<00:28,  5.63s/it]                 
Task 7, Epoch 16/20 => Loss 0.114, Train_accy 96.73:  80%|████████  | 16/20 [01:17<00:20,  5.15s/it]
Task 7, Epoch 17/20 => Loss 0.112, Train_accy 97.02:  80%|████████  | 16/20 [01:21<00:20,  5.15s/it]
Task 7, Epoch 17/20 => Loss 0.112, Train_accy 97.02:  85%|████████▌ | 17/20 [01:21<00:14,  4.83s/it]
Task 7, Epoch 18/20 => Loss 0.135, Train_accy 96.43:  85%|████████▌ | 17/20 [01:25<00:14,  4.83s/it]
Task 7, Epoch 18/20 => Loss 0.135, Train_accy 96.43:  90%|█████████ | 18/20 [01:25<00:09,  4.59s/it]
Task 7, Epoch 19/20 => Loss 0.122, Train_accy 95.83:  90%|█████████ | 18/20 [01:30<00:09,  4.59s/it]
Task 7, Epoch 19/20 => Loss 0.122, Train_accy 95.83:  95%|█████████▌| 19/20 [01:30<00:04,  4.43s/it]
Task 7, Epoch 20/20 => Loss 0.097, Train_accy 97.92, Test_accy 49.57:  95%|█████████▌| 19/20 [01:38<00:04,  4.43s/it]
Task 7, Epoch 20/20 => Loss 0.097, Train_accy 97.92, Test_accy 49.57: 100%|██████████| 20/20 [01:38<00:00,  5.62s/it]
Task 7, Epoch 20/20 => Loss 0.097, Train_accy 97.92, Test_accy 49.57: 100%|██████████| 20/20 [01:38<00:00,  4.92s/it]
2024-09-07 13:33:54,283 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.097, Train_accy 97.92, Test_accy 49.57
2024-09-07 13:33:58,641 [trainer.py] => No NME accuracy.
2024-09-07 13:33:58,642 [trainer.py] => CNN: {'total': 49.57, '00-09': 51.95, '10-19': 69.39, '20-29': 49.49, '30-39': 51.16, '40-49': 32.81, '50-59': 36.54, '60-69': 53.97, '70-79': 38.54, 'old': 51.33, 'new': 38.54}
2024-09-07 13:33:58,642 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57]
2024-09-07 13:33:58,643 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51]

Average Accuracy (CNN): 60.88
2024-09-07 13:33:58,643 [trainer.py] => Average Accuracy (CNN): 60.88 

2024-09-07 13:33:58,645 [trainer.py] => All params: 89792456
2024-09-07 13:33:58,646 [trainer.py] => Trainable params: 89792456
2024-09-07 13:33:59,065 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.162, Train_accy 31.94:   0%|          | 0/20 [00:03<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.162, Train_accy 31.94:   5%|▌         | 1/20 [00:03<01:06,  3.51s/it]
Task 8, Epoch 2/20 => Loss 0.924, Train_accy 66.67:   5%|▌         | 1/20 [00:07<01:06,  3.51s/it]
Task 8, Epoch 2/20 => Loss 0.924, Train_accy 66.67:  10%|█         | 2/20 [00:07<01:03,  3.51s/it]
Task 8, Epoch 3/20 => Loss 0.435, Train_accy 85.07:  10%|█         | 2/20 [00:10<01:03,  3.51s/it]
Task 8, Epoch 3/20 => Loss 0.435, Train_accy 85.07:  15%|█▌        | 3/20 [00:10<00:59,  3.52s/it]
Task 8, Epoch 4/20 => Loss 0.286, Train_accy 91.32:  15%|█▌        | 3/20 [00:14<00:59,  3.52s/it]
Task 8, Epoch 4/20 => Loss 0.286, Train_accy 91.32:  20%|██        | 4/20 [00:14<00:56,  3.52s/it]
Task 8, Epoch 5/20 => Loss 0.169, Train_accy 95.14, Test_accy 46.98:  20%|██        | 4/20 [00:22<00:56,  3.52s/it]
Task 8, Epoch 5/20 => Loss 0.169, Train_accy 95.14, Test_accy 46.98:  25%|██▌       | 5/20 [00:22<01:18,  5.26s/it]
Task 8, Epoch 6/20 => Loss 0.148, Train_accy 95.83:  25%|██▌       | 5/20 [00:25<01:18,  5.26s/it]                 
Task 8, Epoch 6/20 => Loss 0.148, Train_accy 95.83:  30%|███       | 6/20 [00:25<01:05,  4.67s/it]
Task 8, Epoch 7/20 => Loss 0.165, Train_accy 95.14:  30%|███       | 6/20 [00:29<01:05,  4.67s/it]
Task 8, Epoch 7/20 => Loss 0.165, Train_accy 95.14:  35%|███▌      | 7/20 [00:29<00:55,  4.30s/it]
Task 8, Epoch 8/20 => Loss 0.187, Train_accy 94.44:  35%|███▌      | 7/20 [00:33<00:55,  4.30s/it]
Task 8, Epoch 8/20 => Loss 0.187, Train_accy 94.44:  40%|████      | 8/20 [00:33<00:48,  4.07s/it]
Task 8, Epoch 9/20 => Loss 0.087, Train_accy 97.22:  40%|████      | 8/20 [00:36<00:48,  4.07s/it]
Task 8, Epoch 9/20 => Loss 0.087, Train_accy 97.22:  45%|████▌     | 9/20 [00:36<00:42,  3.90s/it]
Task 8, Epoch 10/20 => Loss 0.099, Train_accy 97.57, Test_accy 46.85:  45%|████▌     | 9/20 [00:44<00:42,  3.90s/it]
Task 8, Epoch 10/20 => Loss 0.099, Train_accy 97.57, Test_accy 46.85:  50%|█████     | 10/20 [00:44<00:52,  5.28s/it]
Task 8, Epoch 11/20 => Loss 0.095, Train_accy 96.88:  50%|█████     | 10/20 [00:48<00:52,  5.28s/it]                 
Task 8, Epoch 11/20 => Loss 0.095, Train_accy 96.88:  55%|█████▌    | 11/20 [00:48<00:42,  4.74s/it]
Task 8, Epoch 12/20 => Loss 0.091, Train_accy 97.92:  55%|█████▌    | 11/20 [00:51<00:42,  4.74s/it]
Task 8, Epoch 12/20 => Loss 0.091, Train_accy 97.92:  60%|██████    | 12/20 [00:51<00:34,  4.36s/it]
Task 8, Epoch 13/20 => Loss 0.052, Train_accy 98.96:  60%|██████    | 12/20 [00:55<00:34,  4.36s/it]
Task 8, Epoch 13/20 => Loss 0.052, Train_accy 98.96:  65%|██████▌   | 13/20 [00:55<00:28,  4.10s/it]
Task 8, Epoch 14/20 => Loss 0.078, Train_accy 97.92:  65%|██████▌   | 13/20 [00:59<00:28,  4.10s/it]
Task 8, Epoch 14/20 => Loss 0.078, Train_accy 97.92:  70%|███████   | 14/20 [00:59<00:23,  3.93s/it]
Task 8, Epoch 15/20 => Loss 0.123, Train_accy 97.22, Test_accy 46.47:  70%|███████   | 14/20 [01:07<00:23,  3.93s/it]
Task 8, Epoch 15/20 => Loss 0.123, Train_accy 97.22, Test_accy 46.47:  75%|███████▌  | 15/20 [01:07<00:26,  5.26s/it]
Task 8, Epoch 16/20 => Loss 0.064, Train_accy 98.96:  75%|███████▌  | 15/20 [01:10<00:26,  5.26s/it]                 
Task 8, Epoch 16/20 => Loss 0.064, Train_accy 98.96:  80%|████████  | 16/20 [01:10<00:18,  4.74s/it]
Task 8, Epoch 17/20 => Loss 0.087, Train_accy 97.22:  80%|████████  | 16/20 [01:14<00:18,  4.74s/it]
Task 8, Epoch 17/20 => Loss 0.087, Train_accy 97.22:  85%|████████▌ | 17/20 [01:14<00:13,  4.39s/it]
Task 8, Epoch 18/20 => Loss 0.104, Train_accy 96.53:  85%|████████▌ | 17/20 [01:17<00:13,  4.39s/it]
Task 8, Epoch 18/20 => Loss 0.104, Train_accy 96.53:  90%|█████████ | 18/20 [01:17<00:08,  4.13s/it]
Task 8, Epoch 19/20 => Loss 0.066, Train_accy 98.26:  90%|█████████ | 18/20 [01:21<00:08,  4.13s/it]
Task 8, Epoch 19/20 => Loss 0.066, Train_accy 98.26:  95%|█████████▌| 19/20 [01:21<00:03,  3.94s/it]
Task 8, Epoch 20/20 => Loss 0.045, Train_accy 99.31, Test_accy 46.47:  95%|█████████▌| 19/20 [01:29<00:03,  3.94s/it]
Task 8, Epoch 20/20 => Loss 0.045, Train_accy 99.31, Test_accy 46.47: 100%|██████████| 20/20 [01:29<00:00,  5.25s/it]
Task 8, Epoch 20/20 => Loss 0.045, Train_accy 99.31, Test_accy 46.47: 100%|██████████| 20/20 [01:29<00:00,  4.49s/it]
2024-09-07 13:35:28,848 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.045, Train_accy 99.31, Test_accy 46.47
2024-09-07 13:35:33,641 [trainer.py] => No NME accuracy.
2024-09-07 13:35:33,641 [trainer.py] => CNN: {'total': 46.47, '00-09': 51.95, '10-19': 65.31, '20-29': 47.47, '30-39': 47.67, '40-49': 31.25, '50-59': 36.54, '60-69': 53.17, '70-79': 37.5, '80-89': 34.57, 'old': 47.85, 'new': 34.57}
2024-09-07 13:35:33,642 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47]
2024-09-07 13:35:33,642 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54]

Average Accuracy (CNN): 59.28
2024-09-07 13:35:33,642 [trainer.py] => Average Accuracy (CNN): 59.28 

2024-09-07 13:35:33,643 [trainer.py] => All params: 89792456
2024-09-07 13:35:33,644 [trainer.py] => Trainable params: 89792456
2024-09-07 13:35:34,107 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.124, Train_accy 17.19:   0%|          | 0/20 [00:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.124, Train_accy 17.19:   5%|▌         | 1/20 [00:02<00:46,  2.47s/it]
Task 9, Epoch 2/20 => Loss 1.622, Train_accy 45.83:   5%|▌         | 1/20 [00:04<00:46,  2.47s/it]
Task 9, Epoch 2/20 => Loss 1.622, Train_accy 45.83:  10%|█         | 2/20 [00:04<00:44,  2.48s/it]
Task 9, Epoch 3/20 => Loss 1.181, Train_accy 61.98:  10%|█         | 2/20 [00:07<00:44,  2.48s/it]
Task 9, Epoch 3/20 => Loss 1.181, Train_accy 61.98:  15%|█▌        | 3/20 [00:07<00:42,  2.49s/it]
Task 9, Epoch 4/20 => Loss 0.790, Train_accy 71.35:  15%|█▌        | 3/20 [00:09<00:42,  2.49s/it]
Task 9, Epoch 4/20 => Loss 0.790, Train_accy 71.35:  20%|██        | 4/20 [00:09<00:39,  2.49s/it]
Task 9, Epoch 5/20 => Loss 0.497, Train_accy 84.38, Test_accy 43.16:  20%|██        | 4/20 [00:17<00:39,  2.49s/it]
Task 9, Epoch 5/20 => Loss 0.497, Train_accy 84.38, Test_accy 43.16:  25%|██▌       | 5/20 [00:17<01:05,  4.37s/it]
Task 9, Epoch 6/20 => Loss 0.398, Train_accy 86.98:  25%|██▌       | 5/20 [00:20<01:05,  4.37s/it]                 
Task 9, Epoch 6/20 => Loss 0.398, Train_accy 86.98:  30%|███       | 6/20 [00:20<00:52,  3.72s/it]
Task 9, Epoch 7/20 => Loss 0.358, Train_accy 91.67:  30%|███       | 6/20 [00:22<00:52,  3.72s/it]
Task 9, Epoch 7/20 => Loss 0.358, Train_accy 91.67:  35%|███▌      | 7/20 [00:22<00:43,  3.31s/it]
Task 9, Epoch 8/20 => Loss 0.230, Train_accy 93.75:  35%|███▌      | 7/20 [00:25<00:43,  3.31s/it]
Task 9, Epoch 8/20 => Loss 0.230, Train_accy 93.75:  40%|████      | 8/20 [00:25<00:36,  3.05s/it]
Task 9, Epoch 9/20 => Loss 0.229, Train_accy 92.19:  40%|████      | 8/20 [00:27<00:36,  3.05s/it]
Task 9, Epoch 9/20 => Loss 0.229, Train_accy 92.19:  45%|████▌     | 9/20 [00:27<00:31,  2.89s/it]
Task 9, Epoch 10/20 => Loss 0.215, Train_accy 93.75, Test_accy 43.52:  45%|████▌     | 9/20 [00:35<00:31,  2.89s/it]
Task 9, Epoch 10/20 => Loss 0.215, Train_accy 93.75, Test_accy 43.52:  50%|█████     | 10/20 [00:35<00:43,  4.34s/it]
Task 9, Epoch 11/20 => Loss 0.225, Train_accy 93.23:  50%|█████     | 10/20 [00:37<00:43,  4.34s/it]                 
Task 9, Epoch 11/20 => Loss 0.225, Train_accy 93.23:  55%|█████▌    | 11/20 [00:37<00:33,  3.77s/it]
Task 9, Epoch 12/20 => Loss 0.201, Train_accy 94.79:  55%|█████▌    | 11/20 [00:40<00:33,  3.77s/it]
Task 9, Epoch 12/20 => Loss 0.201, Train_accy 94.79:  60%|██████    | 12/20 [00:40<00:27,  3.38s/it]
Task 9, Epoch 13/20 => Loss 0.121, Train_accy 97.92:  60%|██████    | 12/20 [00:42<00:27,  3.38s/it]
Task 9, Epoch 13/20 => Loss 0.121, Train_accy 97.92:  65%|██████▌   | 13/20 [00:42<00:21,  3.11s/it]
Task 9, Epoch 14/20 => Loss 0.162, Train_accy 95.83:  65%|██████▌   | 13/20 [00:45<00:21,  3.11s/it]
Task 9, Epoch 14/20 => Loss 0.162, Train_accy 95.83:  70%|███████   | 14/20 [00:45<00:17,  2.91s/it]
Task 9, Epoch 15/20 => Loss 0.123, Train_accy 97.92, Test_accy 43.52:  70%|███████   | 14/20 [00:52<00:17,  2.91s/it]
Task 9, Epoch 15/20 => Loss 0.123, Train_accy 97.92, Test_accy 43.52:  75%|███████▌  | 15/20 [00:52<00:21,  4.32s/it]
Task 9, Epoch 16/20 => Loss 0.134, Train_accy 96.88:  75%|███████▌  | 15/20 [00:55<00:21,  4.32s/it]                 
Task 9, Epoch 16/20 => Loss 0.134, Train_accy 96.88:  80%|████████  | 16/20 [00:55<00:15,  3.76s/it]
Task 9, Epoch 17/20 => Loss 0.150, Train_accy 96.35:  80%|████████  | 16/20 [00:57<00:15,  3.76s/it]
Task 9, Epoch 17/20 => Loss 0.150, Train_accy 96.35:  85%|████████▌ | 17/20 [00:57<00:10,  3.37s/it]
Task 9, Epoch 18/20 => Loss 0.137, Train_accy 96.35:  85%|████████▌ | 17/20 [01:00<00:10,  3.37s/it]
Task 9, Epoch 18/20 => Loss 0.137, Train_accy 96.35:  90%|█████████ | 18/20 [01:00<00:06,  3.10s/it]
Task 9, Epoch 19/20 => Loss 0.115, Train_accy 97.40:  90%|█████████ | 18/20 [01:02<00:06,  3.10s/it]
Task 9, Epoch 19/20 => Loss 0.115, Train_accy 97.40:  95%|█████████▌| 19/20 [01:02<00:02,  2.91s/it]
Task 9, Epoch 20/20 => Loss 0.101, Train_accy 97.40, Test_accy 43.64:  95%|█████████▌| 19/20 [01:10<00:02,  2.91s/it]
Task 9, Epoch 20/20 => Loss 0.101, Train_accy 97.40, Test_accy 43.64: 100%|██████████| 20/20 [01:10<00:00,  4.31s/it]
Task 9, Epoch 20/20 => Loss 0.101, Train_accy 97.40, Test_accy 43.64: 100%|██████████| 20/20 [01:10<00:00,  3.51s/it]
2024-09-07 13:36:44,258 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.101, Train_accy 97.40, Test_accy 43.64
2024-09-07 13:36:49,390 [trainer.py] => No NME accuracy.
2024-09-07 13:36:49,390 [trainer.py] => CNN: {'total': 43.64, '00-09': 49.35, '10-19': 64.29, '20-29': 48.48, '30-39': 48.84, '40-49': 32.81, '50-59': 36.54, '60-69': 52.38, '70-79': 36.46, '80-89': 32.1, '90-99': 14.52, 'old': 45.96, 'new': 14.52}
2024-09-07 13:36:49,390 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64]
2024-09-07 13:36:49,390 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62]

Average Accuracy (CNN): 57.72
2024-09-07 13:36:49,391 [trainer.py] => Average Accuracy (CNN): 57.72 

2024-09-07 13:36:49,392 [trainer.py] => All params: 89792456
2024-09-07 13:36:49,393 [trainer.py] => Trainable params: 89792456
2024-09-07 13:36:49,895 [coda_prompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.864, Train_accy 20.83:   0%|          | 0/20 [00:03<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.864, Train_accy 20.83:   5%|▌         | 1/20 [00:03<00:57,  3.00s/it]
Task 10, Epoch 2/20 => Loss 1.258, Train_accy 62.08:   5%|▌         | 1/20 [00:06<00:57,  3.00s/it]
Task 10, Epoch 2/20 => Loss 1.258, Train_accy 62.08:  10%|█         | 2/20 [00:06<00:54,  3.01s/it]
Task 10, Epoch 3/20 => Loss 0.748, Train_accy 75.00:  10%|█         | 2/20 [00:09<00:54,  3.01s/it]
Task 10, Epoch 3/20 => Loss 0.748, Train_accy 75.00:  15%|█▌        | 3/20 [00:09<00:51,  3.01s/it]
Task 10, Epoch 4/20 => Loss 0.402, Train_accy 88.33:  15%|█▌        | 3/20 [00:12<00:51,  3.01s/it]
Task 10, Epoch 4/20 => Loss 0.402, Train_accy 88.33:  20%|██        | 4/20 [00:12<00:48,  3.01s/it]
Task 10, Epoch 5/20 => Loss 0.296, Train_accy 91.67, Test_accy 42.29:  20%|██        | 4/20 [00:20<00:48,  3.01s/it]
Task 10, Epoch 5/20 => Loss 0.296, Train_accy 91.67, Test_accy 42.29:  25%|██▌       | 5/20 [00:20<01:14,  4.97s/it]
Task 10, Epoch 6/20 => Loss 0.227, Train_accy 92.92:  25%|██▌       | 5/20 [00:23<01:14,  4.97s/it]                 
Task 10, Epoch 6/20 => Loss 0.227, Train_accy 92.92:  30%|███       | 6/20 [00:23<01:00,  4.29s/it]
Task 10, Epoch 7/20 => Loss 0.244, Train_accy 93.75:  30%|███       | 6/20 [00:26<01:00,  4.29s/it]
Task 10, Epoch 7/20 => Loss 0.244, Train_accy 93.75:  35%|███▌      | 7/20 [00:26<00:50,  3.89s/it]
Task 10, Epoch 8/20 => Loss 0.167, Train_accy 96.25:  35%|███▌      | 7/20 [00:29<00:50,  3.89s/it]
Task 10, Epoch 8/20 => Loss 0.167, Train_accy 96.25:  40%|████      | 8/20 [00:29<00:43,  3.60s/it]
Task 10, Epoch 9/20 => Loss 0.146, Train_accy 96.25:  40%|████      | 8/20 [00:32<00:43,  3.60s/it]
Task 10, Epoch 9/20 => Loss 0.146, Train_accy 96.25:  45%|████▌     | 9/20 [00:32<00:37,  3.40s/it]
Task 10, Epoch 10/20 => Loss 0.126, Train_accy 97.08, Test_accy 43.17:  45%|████▌     | 9/20 [00:40<00:37,  3.40s/it]
Task 10, Epoch 10/20 => Loss 0.126, Train_accy 97.08, Test_accy 43.17:  50%|█████     | 10/20 [00:40<00:49,  4.96s/it]
Task 10, Epoch 11/20 => Loss 0.146, Train_accy 95.83:  50%|█████     | 10/20 [00:43<00:49,  4.96s/it]                 
Task 10, Epoch 11/20 => Loss 0.146, Train_accy 95.83:  55%|█████▌    | 11/20 [00:43<00:39,  4.35s/it]
Task 10, Epoch 12/20 => Loss 0.090, Train_accy 97.92:  55%|█████▌    | 11/20 [00:46<00:39,  4.35s/it]
Task 10, Epoch 12/20 => Loss 0.090, Train_accy 97.92:  60%|██████    | 12/20 [00:46<00:31,  3.93s/it]
Task 10, Epoch 13/20 => Loss 0.097, Train_accy 96.67:  60%|██████    | 12/20 [00:49<00:31,  3.93s/it]
Task 10, Epoch 13/20 => Loss 0.097, Train_accy 96.67:  65%|██████▌   | 13/20 [00:49<00:25,  3.64s/it]
Task 10, Epoch 14/20 => Loss 0.119, Train_accy 95.83:  65%|██████▌   | 13/20 [00:52<00:25,  3.64s/it]
Task 10, Epoch 14/20 => Loss 0.119, Train_accy 95.83:  70%|███████   | 14/20 [00:52<00:20,  3.48s/it]
Task 10, Epoch 15/20 => Loss 0.079, Train_accy 98.75, Test_accy 42.84:  70%|███████   | 14/20 [01:01<00:20,  3.48s/it]
Task 10, Epoch 15/20 => Loss 0.079, Train_accy 98.75, Test_accy 42.84:  75%|███████▌  | 15/20 [01:01<00:24,  4.97s/it]
Task 10, Epoch 16/20 => Loss 0.101, Train_accy 96.67:  75%|███████▌  | 15/20 [01:04<00:24,  4.97s/it]                 
Task 10, Epoch 16/20 => Loss 0.101, Train_accy 96.67:  80%|████████  | 16/20 [01:04<00:17,  4.37s/it]
Task 10, Epoch 17/20 => Loss 0.094, Train_accy 96.67:  80%|████████  | 16/20 [01:07<00:17,  4.37s/it]
Task 10, Epoch 17/20 => Loss 0.094, Train_accy 96.67:  85%|████████▌ | 17/20 [01:07<00:11,  3.97s/it]
Task 10, Epoch 18/20 => Loss 0.055, Train_accy 99.17:  85%|████████▌ | 17/20 [01:10<00:11,  3.97s/it]
Task 10, Epoch 18/20 => Loss 0.055, Train_accy 99.17:  90%|█████████ | 18/20 [01:10<00:07,  3.67s/it]
Task 10, Epoch 19/20 => Loss 0.061, Train_accy 99.17:  90%|█████████ | 18/20 [01:13<00:07,  3.67s/it]
Task 10, Epoch 19/20 => Loss 0.061, Train_accy 99.17:  95%|█████████▌| 19/20 [01:13<00:03,  3.48s/it]
Task 10, Epoch 20/20 => Loss 0.100, Train_accy 97.92, Test_accy 42.84:  95%|█████████▌| 19/20 [01:21<00:03,  3.48s/it]
Task 10, Epoch 20/20 => Loss 0.100, Train_accy 97.92, Test_accy 42.84: 100%|██████████| 20/20 [01:21<00:00,  4.98s/it]
Task 10, Epoch 20/20 => Loss 0.100, Train_accy 97.92, Test_accy 42.84: 100%|██████████| 20/20 [01:21<00:00,  4.09s/it]
2024-09-07 13:38:11,790 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.100, Train_accy 97.92, Test_accy 42.84
2024-09-07 13:38:17,326 [trainer.py] => No NME accuracy.
2024-09-07 13:38:17,327 [trainer.py] => CNN: {'total': 42.84, '00-09': 46.75, '10-19': 63.27, '20-29': 49.49, '30-39': 50.0, '40-49': 31.25, '50-59': 36.54, '60-69': 51.59, '70-79': 35.42, '80-89': 32.1, '90-99': 14.52, '100-109': 38.33, 'old': 43.16, 'new': 38.33}
2024-09-07 13:38:17,327 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84]
2024-09-07 13:38:17,327 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36]

Average Accuracy (CNN): 56.37
2024-09-07 13:38:17,327 [trainer.py] => Average Accuracy (CNN): 56.37 

2024-09-07 13:38:17,328 [trainer.py] => All params: 89792456
2024-09-07 13:38:17,329 [trainer.py] => Trainable params: 89792456
2024-09-07 13:38:17,880 [coda_prompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.437, Train_accy 29.17:   0%|          | 0/20 [00:03<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.437, Train_accy 29.17:   5%|▌         | 1/20 [00:03<00:57,  3.01s/it]
Task 11, Epoch 2/20 => Loss 1.172, Train_accy 60.42:   5%|▌         | 1/20 [00:06<00:57,  3.01s/it]
Task 11, Epoch 2/20 => Loss 1.172, Train_accy 60.42:  10%|█         | 2/20 [00:06<00:54,  3.05s/it]
Task 11, Epoch 3/20 => Loss 0.772, Train_accy 73.75:  10%|█         | 2/20 [00:09<00:54,  3.05s/it]
Task 11, Epoch 3/20 => Loss 0.772, Train_accy 73.75:  15%|█▌        | 3/20 [00:09<00:51,  3.01s/it]
Task 11, Epoch 4/20 => Loss 0.464, Train_accy 84.58:  15%|█▌        | 3/20 [00:12<00:51,  3.01s/it]
Task 11, Epoch 4/20 => Loss 0.464, Train_accy 84.58:  20%|██        | 4/20 [00:12<00:48,  3.02s/it]
Task 11, Epoch 5/20 => Loss 0.321, Train_accy 90.42, Test_accy 41.54:  20%|██        | 4/20 [00:20<00:48,  3.02s/it]
Task 11, Epoch 5/20 => Loss 0.321, Train_accy 90.42, Test_accy 41.54:  25%|██▌       | 5/20 [00:20<01:16,  5.12s/it]
Task 11, Epoch 6/20 => Loss 0.304, Train_accy 90.83:  25%|██▌       | 5/20 [00:23<01:16,  5.12s/it]                 
Task 11, Epoch 6/20 => Loss 0.304, Train_accy 90.83:  30%|███       | 6/20 [00:23<01:01,  4.40s/it]
Task 11, Epoch 7/20 => Loss 0.195, Train_accy 94.17:  30%|███       | 6/20 [00:26<01:01,  4.40s/it]
Task 11, Epoch 7/20 => Loss 0.195, Train_accy 94.17:  35%|███▌      | 7/20 [00:26<00:51,  3.94s/it]
Task 11, Epoch 8/20 => Loss 0.191, Train_accy 94.58:  35%|███▌      | 7/20 [00:29<00:51,  3.94s/it]
Task 11, Epoch 8/20 => Loss 0.191, Train_accy 94.58:  40%|████      | 8/20 [00:29<00:43,  3.66s/it]
Task 11, Epoch 9/20 => Loss 0.155, Train_accy 96.67:  40%|████      | 8/20 [00:32<00:43,  3.66s/it]
Task 11, Epoch 9/20 => Loss 0.155, Train_accy 96.67:  45%|████▌     | 9/20 [00:32<00:37,  3.44s/it]
Task 11, Epoch 10/20 => Loss 0.166, Train_accy 96.67, Test_accy 42.56:  45%|████▌     | 9/20 [00:41<00:37,  3.44s/it]
Task 11, Epoch 10/20 => Loss 0.166, Train_accy 96.67, Test_accy 42.56:  50%|█████     | 10/20 [00:41<00:51,  5.12s/it]
Task 11, Epoch 11/20 => Loss 0.105, Train_accy 97.92:  50%|█████     | 10/20 [00:44<00:51,  5.12s/it]                 
Task 11, Epoch 11/20 => Loss 0.105, Train_accy 97.92:  55%|█████▌    | 11/20 [00:44<00:40,  4.47s/it]
Task 11, Epoch 12/20 => Loss 0.137, Train_accy 96.25:  55%|█████▌    | 11/20 [00:47<00:40,  4.47s/it]
Task 11, Epoch 12/20 => Loss 0.137, Train_accy 96.25:  60%|██████    | 12/20 [00:47<00:32,  4.03s/it]
Task 11, Epoch 13/20 => Loss 0.076, Train_accy 98.75:  60%|██████    | 12/20 [00:50<00:32,  4.03s/it]
Task 11, Epoch 13/20 => Loss 0.076, Train_accy 98.75:  65%|██████▌   | 13/20 [00:50<00:25,  3.71s/it]
Task 11, Epoch 14/20 => Loss 0.100, Train_accy 97.08:  65%|██████▌   | 13/20 [00:53<00:25,  3.71s/it]
Task 11, Epoch 14/20 => Loss 0.100, Train_accy 97.08:  70%|███████   | 14/20 [00:53<00:20,  3.49s/it]
Task 11, Epoch 15/20 => Loss 0.093, Train_accy 97.50, Test_accy 42.26:  70%|███████   | 14/20 [01:02<00:20,  3.49s/it]
Task 11, Epoch 15/20 => Loss 0.093, Train_accy 97.50, Test_accy 42.26:  75%|███████▌  | 15/20 [01:02<00:25,  5.13s/it]
Task 11, Epoch 16/20 => Loss 0.096, Train_accy 98.75:  75%|███████▌  | 15/20 [01:05<00:25,  5.13s/it]                 
Task 11, Epoch 16/20 => Loss 0.096, Train_accy 98.75:  80%|████████  | 16/20 [01:05<00:17,  4.49s/it]
Task 11, Epoch 17/20 => Loss 0.076, Train_accy 97.50:  80%|████████  | 16/20 [01:08<00:17,  4.49s/it]
Task 11, Epoch 17/20 => Loss 0.076, Train_accy 97.50:  85%|████████▌ | 17/20 [01:08<00:12,  4.03s/it]
Task 11, Epoch 18/20 => Loss 0.120, Train_accy 95.83:  85%|████████▌ | 17/20 [01:11<00:12,  4.03s/it]
Task 11, Epoch 18/20 => Loss 0.120, Train_accy 95.83:  90%|█████████ | 18/20 [01:11<00:07,  3.72s/it]
Task 11, Epoch 19/20 => Loss 0.060, Train_accy 98.75:  90%|█████████ | 18/20 [01:14<00:07,  3.72s/it]
Task 11, Epoch 19/20 => Loss 0.060, Train_accy 98.75:  95%|█████████▌| 19/20 [01:14<00:03,  3.50s/it]
Task 11, Epoch 20/20 => Loss 0.128, Train_accy 97.08, Test_accy 42.26:  95%|█████████▌| 19/20 [01:23<00:03,  3.50s/it]
Task 11, Epoch 20/20 => Loss 0.128, Train_accy 97.08, Test_accy 42.26: 100%|██████████| 20/20 [01:23<00:00,  5.10s/it]
Task 11, Epoch 20/20 => Loss 0.128, Train_accy 97.08, Test_accy 42.26: 100%|██████████| 20/20 [01:23<00:00,  4.18s/it]
2024-09-07 13:39:41,393 [coda_prompt.py] => Task 11, Epoch 20/20 => Loss 0.128, Train_accy 97.08, Test_accy 42.26
2024-09-07 13:39:47,288 [trainer.py] => No NME accuracy.
2024-09-07 13:39:47,288 [trainer.py] => CNN: {'total': 42.26, '00-09': 46.75, '10-19': 62.24, '20-29': 49.49, '30-39': 47.67, '40-49': 31.25, '50-59': 36.54, '60-69': 50.0, '70-79': 35.42, '80-89': 32.1, '90-99': 14.52, '100-109': 36.67, '110-119': 43.24, 'old': 42.18, 'new': 43.24}
2024-09-07 13:39:47,288 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26]
2024-09-07 13:39:47,288 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62]

Average Accuracy (CNN): 55.19
2024-09-07 13:39:47,289 [trainer.py] => Average Accuracy (CNN): 55.19 

2024-09-07 13:39:47,290 [trainer.py] => All params: 89792456
2024-09-07 13:39:47,290 [trainer.py] => Trainable params: 89792456
2024-09-07 13:39:47,899 [coda_prompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 3.132, Train_accy 12.50:   0%|          | 0/20 [00:02<?, ?it/s]
Task 12, Epoch 1/20 => Loss 3.132, Train_accy 12.50:   5%|▌         | 1/20 [00:02<00:48,  2.53s/it]
Task 12, Epoch 2/20 => Loss 2.099, Train_accy 32.81:   5%|▌         | 1/20 [00:05<00:48,  2.53s/it]
Task 12, Epoch 2/20 => Loss 2.099, Train_accy 32.81:  10%|█         | 2/20 [00:05<00:45,  2.50s/it]
Task 12, Epoch 3/20 => Loss 1.299, Train_accy 56.25:  10%|█         | 2/20 [00:07<00:45,  2.50s/it]
Task 12, Epoch 3/20 => Loss 1.299, Train_accy 56.25:  15%|█▌        | 3/20 [00:07<00:42,  2.50s/it]
Task 12, Epoch 4/20 => Loss 0.887, Train_accy 71.88:  15%|█▌        | 3/20 [00:09<00:42,  2.50s/it]
Task 12, Epoch 4/20 => Loss 0.887, Train_accy 71.88:  20%|██        | 4/20 [00:09<00:39,  2.47s/it]
Task 12, Epoch 5/20 => Loss 0.700, Train_accy 79.69, Test_accy 40.48:  20%|██        | 4/20 [00:18<00:39,  2.47s/it]
Task 12, Epoch 5/20 => Loss 0.700, Train_accy 79.69, Test_accy 40.48:  25%|██▌       | 5/20 [00:18<01:10,  4.70s/it]
Task 12, Epoch 6/20 => Loss 0.518, Train_accy 84.90:  25%|██▌       | 5/20 [00:21<01:10,  4.70s/it]                 
Task 12, Epoch 6/20 => Loss 0.518, Train_accy 84.90:  30%|███       | 6/20 [00:21<00:55,  3.94s/it]
Task 12, Epoch 7/20 => Loss 0.397, Train_accy 88.02:  30%|███       | 6/20 [00:23<00:55,  3.94s/it]
Task 12, Epoch 7/20 => Loss 0.397, Train_accy 88.02:  35%|███▌      | 7/20 [00:23<00:44,  3.44s/it]
Task 12, Epoch 8/20 => Loss 0.258, Train_accy 93.75:  35%|███▌      | 7/20 [00:25<00:44,  3.44s/it]
Task 12, Epoch 8/20 => Loss 0.258, Train_accy 93.75:  40%|████      | 8/20 [00:25<00:37,  3.12s/it]
Task 12, Epoch 9/20 => Loss 0.319, Train_accy 90.10:  40%|████      | 8/20 [00:28<00:37,  3.12s/it]
Task 12, Epoch 9/20 => Loss 0.319, Train_accy 90.10:  45%|████▌     | 9/20 [00:28<00:32,  2.91s/it]
Task 12, Epoch 10/20 => Loss 0.196, Train_accy 97.40, Test_accy 40.39:  45%|████▌     | 9/20 [00:37<00:32,  2.91s/it]
Task 12, Epoch 10/20 => Loss 0.196, Train_accy 97.40, Test_accy 40.39:  50%|█████     | 10/20 [00:37<00:47,  4.71s/it]
Task 12, Epoch 11/20 => Loss 0.167, Train_accy 96.88:  50%|█████     | 10/20 [00:39<00:47,  4.71s/it]                 
Task 12, Epoch 11/20 => Loss 0.167, Train_accy 96.88:  55%|█████▌    | 11/20 [00:39<00:36,  4.02s/it]
Task 12, Epoch 12/20 => Loss 0.233, Train_accy 95.83:  55%|█████▌    | 11/20 [00:42<00:36,  4.02s/it]
Task 12, Epoch 12/20 => Loss 0.233, Train_accy 95.83:  60%|██████    | 12/20 [00:42<00:28,  3.55s/it]
Task 12, Epoch 13/20 => Loss 0.173, Train_accy 95.83:  60%|██████    | 12/20 [00:44<00:28,  3.55s/it]
Task 12, Epoch 13/20 => Loss 0.173, Train_accy 95.83:  65%|██████▌   | 13/20 [00:44<00:22,  3.22s/it]
Task 12, Epoch 14/20 => Loss 0.147, Train_accy 98.44:  65%|██████▌   | 13/20 [00:46<00:22,  3.22s/it]
Task 12, Epoch 14/20 => Loss 0.147, Train_accy 98.44:  70%|███████   | 14/20 [00:46<00:17,  2.99s/it]
Task 12, Epoch 15/20 => Loss 0.158, Train_accy 97.92, Test_accy 40.39:  70%|███████   | 14/20 [00:55<00:17,  2.99s/it]
Task 12, Epoch 15/20 => Loss 0.158, Train_accy 97.92, Test_accy 40.39:  75%|███████▌  | 15/20 [00:55<00:23,  4.70s/it]
Task 12, Epoch 16/20 => Loss 0.229, Train_accy 93.23:  75%|███████▌  | 15/20 [00:58<00:23,  4.70s/it]                 
Task 12, Epoch 16/20 => Loss 0.229, Train_accy 93.23:  80%|████████  | 16/20 [00:58<00:16,  4.03s/it]
Task 12, Epoch 17/20 => Loss 0.214, Train_accy 96.35:  80%|████████  | 16/20 [01:00<00:16,  4.03s/it]
Task 12, Epoch 17/20 => Loss 0.214, Train_accy 96.35:  85%|████████▌ | 17/20 [01:00<00:10,  3.56s/it]
Task 12, Epoch 18/20 => Loss 0.153, Train_accy 97.40:  85%|████████▌ | 17/20 [01:03<00:10,  3.56s/it]
Task 12, Epoch 18/20 => Loss 0.153, Train_accy 97.40:  90%|█████████ | 18/20 [01:03<00:06,  3.23s/it]
Task 12, Epoch 19/20 => Loss 0.158, Train_accy 95.83:  90%|█████████ | 18/20 [01:05<00:06,  3.23s/it]
Task 12, Epoch 19/20 => Loss 0.158, Train_accy 95.83:  95%|█████████▌| 19/20 [01:05<00:03,  3.00s/it]
Task 12, Epoch 20/20 => Loss 0.160, Train_accy 96.35, Test_accy 40.39:  95%|█████████▌| 19/20 [01:14<00:03,  3.00s/it]
Task 12, Epoch 20/20 => Loss 0.160, Train_accy 96.35, Test_accy 40.39: 100%|██████████| 20/20 [01:14<00:00,  4.72s/it]
Task 12, Epoch 20/20 => Loss 0.160, Train_accy 96.35, Test_accy 40.39: 100%|██████████| 20/20 [01:14<00:00,  3.71s/it]
2024-09-07 13:41:02,119 [coda_prompt.py] => Task 12, Epoch 20/20 => Loss 0.160, Train_accy 96.35, Test_accy 40.39
2024-09-07 13:41:08,363 [trainer.py] => No NME accuracy.
2024-09-07 13:41:08,363 [trainer.py] => CNN: {'total': 40.39, '00-09': 45.45, '10-19': 61.22, '20-29': 48.48, '30-39': 47.67, '40-49': 29.69, '50-59': 38.46, '60-69': 50.0, '70-79': 35.42, '80-89': 32.1, '90-99': 14.52, '100-109': 35.0, '110-119': 43.24, '120-129': 16.67, 'old': 41.85, 'new': 16.67}
2024-09-07 13:41:08,363 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39]
2024-09-07 13:41:08,364 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86]

Average Accuracy (CNN): 54.05
2024-09-07 13:41:08,364 [trainer.py] => Average Accuracy (CNN): 54.05 

2024-09-07 13:41:08,365 [trainer.py] => All params: 89792456
2024-09-07 13:41:08,366 [trainer.py] => Trainable params: 89792456
2024-09-07 13:41:09,025 [coda_prompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.600, Train_accy 23.61:   0%|          | 0/20 [00:03<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.600, Train_accy 23.61:   5%|▌         | 1/20 [00:03<01:06,  3.52s/it]
Task 13, Epoch 2/20 => Loss 1.427, Train_accy 54.17:   5%|▌         | 1/20 [00:07<01:06,  3.52s/it]
Task 13, Epoch 2/20 => Loss 1.427, Train_accy 54.17:  10%|█         | 2/20 [00:07<01:03,  3.52s/it]
Task 13, Epoch 3/20 => Loss 0.891, Train_accy 72.22:  10%|█         | 2/20 [00:10<01:03,  3.52s/it]
Task 13, Epoch 3/20 => Loss 0.891, Train_accy 72.22:  15%|█▌        | 3/20 [00:10<00:59,  3.52s/it]
Task 13, Epoch 4/20 => Loss 0.541, Train_accy 82.64:  15%|█▌        | 3/20 [00:14<00:59,  3.52s/it]
Task 13, Epoch 4/20 => Loss 0.541, Train_accy 82.64:  20%|██        | 4/20 [00:14<00:56,  3.53s/it]
Task 13, Epoch 5/20 => Loss 0.375, Train_accy 88.54, Test_accy 38.80:  20%|██        | 4/20 [00:24<00:56,  3.53s/it]
Task 13, Epoch 5/20 => Loss 0.375, Train_accy 88.54, Test_accy 38.80:  25%|██▌       | 5/20 [00:24<01:29,  5.96s/it]
Task 13, Epoch 6/20 => Loss 0.357, Train_accy 87.50:  25%|██▌       | 5/20 [00:27<01:29,  5.96s/it]                 
Task 13, Epoch 6/20 => Loss 0.357, Train_accy 87.50:  30%|███       | 6/20 [00:27<01:11,  5.12s/it]
Task 13, Epoch 7/20 => Loss 0.263, Train_accy 93.06:  30%|███       | 6/20 [00:31<01:11,  5.12s/it]
Task 13, Epoch 7/20 => Loss 0.263, Train_accy 93.06:  35%|███▌      | 7/20 [00:31<00:59,  4.60s/it]
Task 13, Epoch 8/20 => Loss 0.244, Train_accy 93.06:  35%|███▌      | 7/20 [00:34<00:59,  4.60s/it]
Task 13, Epoch 8/20 => Loss 0.244, Train_accy 93.06:  40%|████      | 8/20 [00:34<00:51,  4.25s/it]
Task 13, Epoch 9/20 => Loss 0.173, Train_accy 95.83:  40%|████      | 8/20 [00:38<00:51,  4.25s/it]
Task 13, Epoch 9/20 => Loss 0.173, Train_accy 95.83:  45%|████▌     | 9/20 [00:38<00:44,  4.02s/it]
Task 13, Epoch 10/20 => Loss 0.194, Train_accy 94.44, Test_accy 39.43:  45%|████▌     | 9/20 [00:48<00:44,  4.02s/it]
Task 13, Epoch 10/20 => Loss 0.194, Train_accy 94.44, Test_accy 39.43:  50%|█████     | 10/20 [00:48<00:59,  5.95s/it]
Task 13, Epoch 11/20 => Loss 0.138, Train_accy 96.18:  50%|█████     | 10/20 [00:52<00:59,  5.95s/it]                 
Task 13, Epoch 11/20 => Loss 0.138, Train_accy 96.18:  55%|█████▌    | 11/20 [00:52<00:46,  5.21s/it]
Task 13, Epoch 12/20 => Loss 0.173, Train_accy 94.79:  55%|█████▌    | 11/20 [00:55<00:46,  5.21s/it]
Task 13, Epoch 12/20 => Loss 0.173, Train_accy 94.79:  60%|██████    | 12/20 [00:55<00:37,  4.72s/it]
Task 13, Epoch 13/20 => Loss 0.182, Train_accy 96.18:  60%|██████    | 12/20 [00:59<00:37,  4.72s/it]
Task 13, Epoch 13/20 => Loss 0.182, Train_accy 96.18:  65%|██████▌   | 13/20 [00:59<00:30,  4.36s/it]
Task 13, Epoch 14/20 => Loss 0.160, Train_accy 95.49:  65%|██████▌   | 13/20 [01:02<00:30,  4.36s/it]
Task 13, Epoch 14/20 => Loss 0.160, Train_accy 95.49:  70%|███████   | 14/20 [01:02<00:24,  4.11s/it]
Task 13, Epoch 15/20 => Loss 0.167, Train_accy 95.49, Test_accy 39.43:  70%|███████   | 14/20 [01:13<00:24,  4.11s/it]
Task 13, Epoch 15/20 => Loss 0.167, Train_accy 95.49, Test_accy 39.43:  75%|███████▌  | 15/20 [01:13<00:29,  5.95s/it]
Task 13, Epoch 16/20 => Loss 0.113, Train_accy 96.53:  75%|███████▌  | 15/20 [01:16<00:29,  5.95s/it]                 
Task 13, Epoch 16/20 => Loss 0.113, Train_accy 96.53:  80%|████████  | 16/20 [01:16<00:20,  5.21s/it]
Task 13, Epoch 17/20 => Loss 0.118, Train_accy 96.18:  80%|████████  | 16/20 [01:20<00:20,  5.21s/it]
Task 13, Epoch 17/20 => Loss 0.118, Train_accy 96.18:  85%|████████▌ | 17/20 [01:20<00:14,  4.71s/it]
Task 13, Epoch 18/20 => Loss 0.147, Train_accy 94.44:  85%|████████▌ | 17/20 [01:23<00:14,  4.71s/it]
Task 13, Epoch 18/20 => Loss 0.147, Train_accy 94.44:  90%|█████████ | 18/20 [01:23<00:08,  4.35s/it]
Task 13, Epoch 19/20 => Loss 0.101, Train_accy 97.92:  90%|█████████ | 18/20 [01:27<00:08,  4.35s/it]
Task 13, Epoch 19/20 => Loss 0.101, Train_accy 97.92:  95%|█████████▌| 19/20 [01:27<00:04,  4.10s/it]
Task 13, Epoch 20/20 => Loss 0.091, Train_accy 98.26, Test_accy 38.89:  95%|█████████▌| 19/20 [01:37<00:04,  4.10s/it]
Task 13, Epoch 20/20 => Loss 0.091, Train_accy 98.26, Test_accy 38.89: 100%|██████████| 20/20 [01:37<00:00,  5.98s/it]
Task 13, Epoch 20/20 => Loss 0.091, Train_accy 98.26, Test_accy 38.89: 100%|██████████| 20/20 [01:37<00:00,  4.88s/it]
2024-09-07 13:42:46,546 [coda_prompt.py] => Task 13, Epoch 20/20 => Loss 0.091, Train_accy 98.26, Test_accy 38.89
2024-09-07 13:42:53,300 [trainer.py] => No NME accuracy.
2024-09-07 13:42:53,300 [trainer.py] => CNN: {'total': 38.89, '00-09': 46.75, '10-19': 58.16, '20-29': 45.45, '30-39': 44.19, '40-49': 29.69, '50-59': 36.54, '60-69': 48.41, '70-79': 34.38, '80-89': 33.33, '90-99': 14.52, '100-109': 33.33, '110-119': 44.59, '120-129': 15.0, '130-139': 34.88, 'old': 39.23, 'new': 34.88}
2024-09-07 13:42:53,300 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39, 38.89]
2024-09-07 13:42:53,300 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86, 69.05]

Average Accuracy (CNN): 52.97
2024-09-07 13:42:53,300 [trainer.py] => Average Accuracy (CNN): 52.97 

2024-09-07 13:42:53,302 [trainer.py] => All params: 89792456
2024-09-07 13:42:53,303 [trainer.py] => Trainable params: 89792456
2024-09-07 13:42:54,007 [coda_prompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.861, Train_accy 25.35:   0%|          | 0/20 [00:03<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.861, Train_accy 25.35:   5%|▌         | 1/20 [00:03<01:06,  3.50s/it]
Task 14, Epoch 2/20 => Loss 1.573, Train_accy 47.57:   5%|▌         | 1/20 [00:07<01:06,  3.50s/it]
Task 14, Epoch 2/20 => Loss 1.573, Train_accy 47.57:  10%|█         | 2/20 [00:07<01:03,  3.51s/it]
Task 14, Epoch 3/20 => Loss 0.876, Train_accy 71.53:  10%|█         | 2/20 [00:10<01:03,  3.51s/it]
Task 14, Epoch 3/20 => Loss 0.876, Train_accy 71.53:  15%|█▌        | 3/20 [00:10<00:59,  3.51s/it]
Task 14, Epoch 4/20 => Loss 0.592, Train_accy 80.90:  15%|█▌        | 3/20 [00:13<00:59,  3.51s/it]
Task 14, Epoch 4/20 => Loss 0.592, Train_accy 80.90:  20%|██        | 4/20 [00:13<00:55,  3.49s/it]
Task 14, Epoch 5/20 => Loss 0.504, Train_accy 85.76, Test_accy 37.43:  20%|██        | 4/20 [00:24<00:55,  3.49s/it]
Task 14, Epoch 5/20 => Loss 0.504, Train_accy 85.76, Test_accy 37.43:  25%|██▌       | 5/20 [00:24<01:30,  6.06s/it]
Task 14, Epoch 6/20 => Loss 0.350, Train_accy 90.28:  25%|██▌       | 5/20 [00:28<01:30,  6.06s/it]                 
Task 14, Epoch 6/20 => Loss 0.350, Train_accy 90.28:  30%|███       | 6/20 [00:28<01:12,  5.18s/it]
Task 14, Epoch 7/20 => Loss 0.297, Train_accy 92.36:  30%|███       | 6/20 [00:31<01:12,  5.18s/it]
Task 14, Epoch 7/20 => Loss 0.297, Train_accy 92.36:  35%|███▌      | 7/20 [00:31<01:00,  4.64s/it]
Task 14, Epoch 8/20 => Loss 0.204, Train_accy 94.79:  35%|███▌      | 7/20 [00:35<01:00,  4.64s/it]
Task 14, Epoch 8/20 => Loss 0.204, Train_accy 94.79:  40%|████      | 8/20 [00:35<00:51,  4.28s/it]
Task 14, Epoch 9/20 => Loss 0.218, Train_accy 94.44:  40%|████      | 8/20 [00:38<00:51,  4.28s/it]
Task 14, Epoch 9/20 => Loss 0.218, Train_accy 94.44:  45%|████▌     | 9/20 [00:38<00:44,  4.04s/it]
Task 14, Epoch 10/20 => Loss 0.156, Train_accy 96.53, Test_accy 37.51:  45%|████▌     | 9/20 [00:49<00:44,  4.04s/it]
Task 14, Epoch 10/20 => Loss 0.156, Train_accy 96.53, Test_accy 37.51:  50%|█████     | 10/20 [00:49<01:00,  6.09s/it]
Task 14, Epoch 11/20 => Loss 0.218, Train_accy 95.14:  50%|█████     | 10/20 [00:52<01:00,  6.09s/it]                 
Task 14, Epoch 11/20 => Loss 0.218, Train_accy 95.14:  55%|█████▌    | 11/20 [00:52<00:47,  5.29s/it]
Task 14, Epoch 12/20 => Loss 0.175, Train_accy 96.18:  55%|█████▌    | 11/20 [00:56<00:47,  5.29s/it]
Task 14, Epoch 12/20 => Loss 0.175, Train_accy 96.18:  60%|██████    | 12/20 [00:56<00:38,  4.76s/it]
Task 14, Epoch 13/20 => Loss 0.136, Train_accy 97.57:  60%|██████    | 12/20 [00:59<00:38,  4.76s/it]
Task 14, Epoch 13/20 => Loss 0.136, Train_accy 97.57:  65%|██████▌   | 13/20 [00:59<00:30,  4.38s/it]
Task 14, Epoch 14/20 => Loss 0.196, Train_accy 94.44:  65%|██████▌   | 13/20 [01:03<00:30,  4.38s/it]
Task 14, Epoch 14/20 => Loss 0.196, Train_accy 94.44:  70%|███████   | 14/20 [01:03<00:24,  4.15s/it]
Task 14, Epoch 15/20 => Loss 0.131, Train_accy 96.53, Test_accy 37.76:  70%|███████   | 14/20 [01:14<00:24,  4.15s/it]
Task 14, Epoch 15/20 => Loss 0.131, Train_accy 96.53, Test_accy 37.76:  75%|███████▌  | 15/20 [01:14<00:30,  6.11s/it]
Task 14, Epoch 16/20 => Loss 0.141, Train_accy 96.53:  75%|███████▌  | 15/20 [01:17<00:30,  6.11s/it]                 
Task 14, Epoch 16/20 => Loss 0.141, Train_accy 96.53:  80%|████████  | 16/20 [01:17<00:21,  5.34s/it]
Task 14, Epoch 17/20 => Loss 0.144, Train_accy 95.83:  80%|████████  | 16/20 [01:21<00:21,  5.34s/it]
Task 14, Epoch 17/20 => Loss 0.144, Train_accy 95.83:  85%|████████▌ | 17/20 [01:21<00:14,  4.80s/it]
Task 14, Epoch 18/20 => Loss 0.155, Train_accy 95.14:  85%|████████▌ | 17/20 [01:24<00:14,  4.80s/it]
Task 14, Epoch 18/20 => Loss 0.155, Train_accy 95.14:  90%|█████████ | 18/20 [01:24<00:08,  4.41s/it]
Task 14, Epoch 19/20 => Loss 0.131, Train_accy 96.53:  90%|█████████ | 18/20 [01:28<00:08,  4.41s/it]
Task 14, Epoch 19/20 => Loss 0.131, Train_accy 96.53:  95%|█████████▌| 19/20 [01:28<00:04,  4.14s/it]
Task 14, Epoch 20/20 => Loss 0.138, Train_accy 96.88, Test_accy 37.76:  95%|█████████▌| 19/20 [01:38<00:04,  4.14s/it]
Task 14, Epoch 20/20 => Loss 0.138, Train_accy 96.88, Test_accy 37.76: 100%|██████████| 20/20 [01:38<00:00,  6.11s/it]
Task 14, Epoch 20/20 => Loss 0.138, Train_accy 96.88, Test_accy 37.76: 100%|██████████| 20/20 [01:38<00:00,  4.94s/it]
2024-09-07 13:44:32,910 [coda_prompt.py] => Task 14, Epoch 20/20 => Loss 0.138, Train_accy 96.88, Test_accy 37.76
2024-09-07 13:44:40,050 [trainer.py] => No NME accuracy.
2024-09-07 13:44:40,051 [trainer.py] => CNN: {'total': 37.76, '00-09': 45.45, '10-19': 58.16, '20-29': 47.47, '30-39': 47.67, '40-49': 29.69, '50-59': 36.54, '60-69': 47.62, '70-79': 34.38, '80-89': 33.33, '90-99': 14.52, '100-109': 33.33, '110-119': 43.24, '120-129': 15.0, '130-139': 34.88, '140-149': 18.42, 'old': 39.07, 'new': 18.42}
2024-09-07 13:44:40,051 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39, 38.89, 37.76]
2024-09-07 13:44:40,051 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86, 69.05, 67.34]

Average Accuracy (CNN): 51.96
2024-09-07 13:44:40,051 [trainer.py] => Average Accuracy (CNN): 51.96 

2024-09-07 13:44:40,052 [trainer.py] => All params: 89792456
2024-09-07 13:44:40,053 [trainer.py] => Trainable params: 89792456
2024-09-07 13:44:40,800 [coda_prompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.930, Train_accy 16.15:   0%|          | 0/20 [00:02<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.930, Train_accy 16.15:   5%|▌         | 1/20 [00:02<00:47,  2.47s/it]
Task 15, Epoch 2/20 => Loss 1.566, Train_accy 46.88:   5%|▌         | 1/20 [00:05<00:47,  2.47s/it]
Task 15, Epoch 2/20 => Loss 1.566, Train_accy 46.88:  10%|█         | 2/20 [00:05<00:45,  2.51s/it]
Task 15, Epoch 3/20 => Loss 0.956, Train_accy 68.75:  10%|█         | 2/20 [00:07<00:45,  2.51s/it]
Task 15, Epoch 3/20 => Loss 0.956, Train_accy 68.75:  15%|█▌        | 3/20 [00:07<00:42,  2.48s/it]
Task 15, Epoch 4/20 => Loss 0.603, Train_accy 81.77:  15%|█▌        | 3/20 [00:09<00:42,  2.48s/it]
Task 15, Epoch 4/20 => Loss 0.603, Train_accy 81.77:  20%|██        | 4/20 [00:09<00:39,  2.48s/it]
Task 15, Epoch 5/20 => Loss 0.423, Train_accy 89.58, Test_accy 36.70:  20%|██        | 4/20 [00:19<00:39,  2.48s/it]
Task 15, Epoch 5/20 => Loss 0.423, Train_accy 89.58, Test_accy 36.70:  25%|██▌       | 5/20 [00:19<01:17,  5.17s/it]
Task 15, Epoch 6/20 => Loss 0.366, Train_accy 92.19:  25%|██▌       | 5/20 [00:22<01:17,  5.17s/it]                 
Task 15, Epoch 6/20 => Loss 0.366, Train_accy 92.19:  30%|███       | 6/20 [00:22<00:59,  4.25s/it]
Task 15, Epoch 7/20 => Loss 0.218, Train_accy 93.75:  30%|███       | 6/20 [00:24<00:59,  4.25s/it]
Task 15, Epoch 7/20 => Loss 0.218, Train_accy 93.75:  35%|███▌      | 7/20 [00:24<00:47,  3.67s/it]
Task 15, Epoch 8/20 => Loss 0.236, Train_accy 94.27:  35%|███▌      | 7/20 [00:27<00:47,  3.67s/it]
Task 15, Epoch 8/20 => Loss 0.236, Train_accy 94.27:  40%|████      | 8/20 [00:27<00:39,  3.28s/it]
Task 15, Epoch 9/20 => Loss 0.157, Train_accy 97.40:  40%|████      | 8/20 [00:29<00:39,  3.28s/it]
Task 15, Epoch 9/20 => Loss 0.157, Train_accy 97.40:  45%|████▌     | 9/20 [00:29<00:33,  3.03s/it]
Task 15, Epoch 10/20 => Loss 0.101, Train_accy 99.48, Test_accy 36.78:  45%|████▌     | 9/20 [00:39<00:33,  3.03s/it]
Task 15, Epoch 10/20 => Loss 0.101, Train_accy 99.48, Test_accy 36.78:  50%|█████     | 10/20 [00:39<00:51,  5.13s/it]
Task 15, Epoch 11/20 => Loss 0.088, Train_accy 98.96:  50%|█████     | 10/20 [00:42<00:51,  5.13s/it]                 
Task 15, Epoch 11/20 => Loss 0.088, Train_accy 98.96:  55%|█████▌    | 11/20 [00:42<00:38,  4.32s/it]
Task 15, Epoch 12/20 => Loss 0.091, Train_accy 98.96:  55%|█████▌    | 11/20 [00:44<00:38,  4.32s/it]
Task 15, Epoch 12/20 => Loss 0.091, Train_accy 98.96:  60%|██████    | 12/20 [00:44<00:29,  3.75s/it]
Task 15, Epoch 13/20 => Loss 0.100, Train_accy 97.40:  60%|██████    | 12/20 [00:46<00:29,  3.75s/it]
Task 15, Epoch 13/20 => Loss 0.100, Train_accy 97.40:  65%|██████▌   | 13/20 [00:46<00:23,  3.35s/it]
Task 15, Epoch 14/20 => Loss 0.147, Train_accy 96.35:  65%|██████▌   | 13/20 [00:49<00:23,  3.35s/it]
Task 15, Epoch 14/20 => Loss 0.147, Train_accy 96.35:  70%|███████   | 14/20 [00:49<00:18,  3.08s/it]
Task 15, Epoch 15/20 => Loss 0.060, Train_accy 100.00, Test_accy 36.78:  70%|███████   | 14/20 [00:59<00:18,  3.08s/it]
Task 15, Epoch 15/20 => Loss 0.060, Train_accy 100.00, Test_accy 36.78:  75%|███████▌  | 15/20 [00:59<00:25,  5.14s/it]
Task 15, Epoch 16/20 => Loss 0.107, Train_accy 98.96:  75%|███████▌  | 15/20 [01:01<00:25,  5.14s/it]                  
Task 15, Epoch 16/20 => Loss 0.107, Train_accy 98.96:  80%|████████  | 16/20 [01:01<00:17,  4.33s/it]
Task 15, Epoch 17/20 => Loss 0.128, Train_accy 97.92:  80%|████████  | 16/20 [01:04<00:17,  4.33s/it]
Task 15, Epoch 17/20 => Loss 0.128, Train_accy 97.92:  85%|████████▌ | 17/20 [01:04<00:11,  3.77s/it]
Task 15, Epoch 18/20 => Loss 0.120, Train_accy 96.88:  85%|████████▌ | 17/20 [01:06<00:11,  3.77s/it]
Task 15, Epoch 18/20 => Loss 0.120, Train_accy 96.88:  90%|█████████ | 18/20 [01:06<00:06,  3.39s/it]
Task 15, Epoch 19/20 => Loss 0.077, Train_accy 98.96:  90%|█████████ | 18/20 [01:09<00:06,  3.39s/it]
Task 15, Epoch 19/20 => Loss 0.077, Train_accy 98.96:  95%|█████████▌| 19/20 [01:09<00:03,  3.11s/it]
Task 15, Epoch 20/20 => Loss 0.112, Train_accy 97.40, Test_accy 37.02:  95%|█████████▌| 19/20 [01:19<00:03,  3.11s/it]
Task 15, Epoch 20/20 => Loss 0.112, Train_accy 97.40, Test_accy 37.02: 100%|██████████| 20/20 [01:19<00:00,  5.15s/it]
Task 15, Epoch 20/20 => Loss 0.112, Train_accy 97.40, Test_accy 37.02: 100%|██████████| 20/20 [01:19<00:00,  3.95s/it]
2024-09-07 13:45:59,881 [coda_prompt.py] => Task 15, Epoch 20/20 => Loss 0.112, Train_accy 97.40, Test_accy 37.02
2024-09-07 13:46:07,405 [trainer.py] => No NME accuracy.
2024-09-07 13:46:07,406 [trainer.py] => CNN: {'total': 37.02, '00-09': 41.56, '10-19': 57.14, '20-29': 47.47, '30-39': 46.51, '40-49': 29.69, '50-59': 34.62, '60-69': 47.62, '70-79': 34.38, '80-89': 34.57, '90-99': 14.52, '100-109': 33.33, '110-119': 41.89, '120-129': 15.0, '130-139': 34.88, '140-149': 19.74, '150-159': 29.41, 'old': 37.34, 'new': 29.41}
2024-09-07 13:46:07,406 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39, 38.89, 37.76, 37.02]
2024-09-07 13:46:07,406 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86, 69.05, 67.34, 66.11]

Average Accuracy (CNN): 51.02
2024-09-07 13:46:07,406 [trainer.py] => Average Accuracy (CNN): 51.02 

2024-09-07 13:46:07,407 [trainer.py] => All params: 89792456
2024-09-07 13:46:07,408 [trainer.py] => Trainable params: 89792456
2024-09-07 13:46:08,196 [coda_prompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.939, Train_accy 21.18:   0%|          | 0/20 [00:03<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.939, Train_accy 21.18:   5%|▌         | 1/20 [00:03<01:06,  3.50s/it]
Task 16, Epoch 2/20 => Loss 1.667, Train_accy 45.83:   5%|▌         | 1/20 [00:07<01:06,  3.50s/it]
Task 16, Epoch 2/20 => Loss 1.667, Train_accy 45.83:  10%|█         | 2/20 [00:07<01:03,  3.51s/it]
Task 16, Epoch 3/20 => Loss 1.204, Train_accy 57.99:  10%|█         | 2/20 [00:10<01:03,  3.51s/it]
Task 16, Epoch 3/20 => Loss 1.204, Train_accy 57.99:  15%|█▌        | 3/20 [00:10<00:59,  3.52s/it]
Task 16, Epoch 4/20 => Loss 0.711, Train_accy 77.43:  15%|█▌        | 3/20 [00:14<00:59,  3.52s/it]
Task 16, Epoch 4/20 => Loss 0.711, Train_accy 77.43:  20%|██        | 4/20 [00:14<00:56,  3.53s/it]
Task 16, Epoch 5/20 => Loss 0.586, Train_accy 81.60, Test_accy 35.18:  20%|██        | 4/20 [00:25<00:56,  3.53s/it]
Task 16, Epoch 5/20 => Loss 0.586, Train_accy 81.60, Test_accy 35.18:  25%|██▌       | 5/20 [00:25<01:35,  6.38s/it]
Task 16, Epoch 6/20 => Loss 0.511, Train_accy 84.38:  25%|██▌       | 5/20 [00:29<01:35,  6.38s/it]                 
Task 16, Epoch 6/20 => Loss 0.511, Train_accy 84.38:  30%|███       | 6/20 [00:29<01:15,  5.40s/it]
Task 16, Epoch 7/20 => Loss 0.371, Train_accy 88.54:  30%|███       | 6/20 [00:32<01:15,  5.40s/it]
Task 16, Epoch 7/20 => Loss 0.371, Train_accy 88.54:  35%|███▌      | 7/20 [00:32<01:02,  4.80s/it]
Task 16, Epoch 8/20 => Loss 0.324, Train_accy 90.28:  35%|███▌      | 7/20 [00:36<01:02,  4.80s/it]
Task 16, Epoch 8/20 => Loss 0.324, Train_accy 90.28:  40%|████      | 8/20 [00:36<00:52,  4.39s/it]
Task 16, Epoch 9/20 => Loss 0.307, Train_accy 90.97:  40%|████      | 8/20 [00:39<00:52,  4.39s/it]
Task 16, Epoch 9/20 => Loss 0.307, Train_accy 90.97:  45%|████▌     | 9/20 [00:39<00:45,  4.12s/it]
Task 16, Epoch 10/20 => Loss 0.252, Train_accy 91.67, Test_accy 35.71:  45%|████▌     | 9/20 [00:51<00:45,  4.12s/it]
Task 16, Epoch 10/20 => Loss 0.252, Train_accy 91.67, Test_accy 35.71:  50%|█████     | 10/20 [00:51<01:03,  6.39s/it]
Task 16, Epoch 11/20 => Loss 0.314, Train_accy 89.93:  50%|█████     | 10/20 [00:54<01:03,  6.39s/it]                 
Task 16, Epoch 11/20 => Loss 0.314, Train_accy 89.93:  55%|█████▌    | 11/20 [00:54<00:49,  5.51s/it]
Task 16, Epoch 12/20 => Loss 0.213, Train_accy 94.44:  55%|█████▌    | 11/20 [00:58<00:49,  5.51s/it]
Task 16, Epoch 12/20 => Loss 0.213, Train_accy 94.44:  60%|██████    | 12/20 [00:58<00:39,  4.91s/it]
Task 16, Epoch 13/20 => Loss 0.184, Train_accy 95.83:  60%|██████    | 12/20 [01:01<00:39,  4.91s/it]
Task 16, Epoch 13/20 => Loss 0.184, Train_accy 95.83:  65%|██████▌   | 13/20 [01:01<00:31,  4.50s/it]
Task 16, Epoch 14/20 => Loss 0.240, Train_accy 93.40:  65%|██████▌   | 13/20 [01:05<00:31,  4.50s/it]
Task 16, Epoch 14/20 => Loss 0.240, Train_accy 93.40:  70%|███████   | 14/20 [01:05<00:25,  4.25s/it]
Task 16, Epoch 15/20 => Loss 0.231, Train_accy 93.06, Test_accy 35.86:  70%|███████   | 14/20 [01:16<00:25,  4.25s/it]
Task 16, Epoch 15/20 => Loss 0.231, Train_accy 93.06, Test_accy 35.86:  75%|███████▌  | 15/20 [01:16<00:32,  6.42s/it]
Task 16, Epoch 16/20 => Loss 0.269, Train_accy 91.32:  75%|███████▌  | 15/20 [01:20<00:32,  6.42s/it]                 
Task 16, Epoch 16/20 => Loss 0.269, Train_accy 91.32:  80%|████████  | 16/20 [01:20<00:22,  5.55s/it]
Task 16, Epoch 17/20 => Loss 0.158, Train_accy 95.83:  80%|████████  | 16/20 [01:23<00:22,  5.55s/it]
Task 16, Epoch 17/20 => Loss 0.158, Train_accy 95.83:  85%|████████▌ | 17/20 [01:23<00:14,  4.94s/it]
Task 16, Epoch 18/20 => Loss 0.173, Train_accy 96.18:  85%|████████▌ | 17/20 [01:27<00:14,  4.94s/it]
Task 16, Epoch 18/20 => Loss 0.173, Train_accy 96.18:  90%|█████████ | 18/20 [01:27<00:09,  4.52s/it]
Task 16, Epoch 19/20 => Loss 0.163, Train_accy 95.49:  90%|█████████ | 18/20 [01:30<00:09,  4.52s/it]
Task 16, Epoch 19/20 => Loss 0.163, Train_accy 95.49:  95%|█████████▌| 19/20 [01:30<00:04,  4.23s/it]
Task 16, Epoch 20/20 => Loss 0.178, Train_accy 95.83, Test_accy 36.01:  95%|█████████▌| 19/20 [01:42<00:04,  4.23s/it]
Task 16, Epoch 20/20 => Loss 0.178, Train_accy 95.83, Test_accy 36.01: 100%|██████████| 20/20 [01:42<00:00,  6.39s/it]
Task 16, Epoch 20/20 => Loss 0.178, Train_accy 95.83, Test_accy 36.01: 100%|██████████| 20/20 [01:42<00:00,  5.12s/it]
2024-09-07 13:47:50,608 [coda_prompt.py] => Task 16, Epoch 20/20 => Loss 0.178, Train_accy 95.83, Test_accy 36.01
2024-09-07 13:47:58,481 [trainer.py] => No NME accuracy.
2024-09-07 13:47:58,481 [trainer.py] => CNN: {'total': 36.01, '00-09': 41.56, '10-19': 57.14, '20-29': 45.45, '30-39': 46.51, '40-49': 29.69, '50-59': 32.69, '60-69': 49.21, '70-79': 34.38, '80-89': 34.57, '90-99': 14.52, '100-109': 31.67, '110-119': 40.54, '120-129': 15.0, '130-139': 33.72, '140-149': 19.74, '150-159': 29.41, '160-169': 25.88, 'old': 36.7, 'new': 25.88}
2024-09-07 13:47:58,481 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39, 38.89, 37.76, 37.02, 36.01]
2024-09-07 13:47:58,482 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86, 69.05, 67.34, 66.11, 64.89]

Average Accuracy (CNN): 50.14
2024-09-07 13:47:58,482 [trainer.py] => Average Accuracy (CNN): 50.14 

2024-09-07 13:47:58,483 [trainer.py] => All params: 89792456
2024-09-07 13:47:58,484 [trainer.py] => Trainable params: 89792456
2024-09-07 13:47:59,377 [coda_prompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 3.180, Train_accy 10.42:   0%|          | 0/20 [00:02<?, ?it/s]
Task 17, Epoch 1/20 => Loss 3.180, Train_accy 10.42:   5%|▌         | 1/20 [00:02<00:46,  2.46s/it]
Task 17, Epoch 2/20 => Loss 2.174, Train_accy 31.25:   5%|▌         | 1/20 [00:04<00:46,  2.46s/it]
Task 17, Epoch 2/20 => Loss 2.174, Train_accy 31.25:  10%|█         | 2/20 [00:04<00:44,  2.46s/it]
Task 17, Epoch 3/20 => Loss 1.313, Train_accy 57.29:  10%|█         | 2/20 [00:07<00:44,  2.46s/it]
Task 17, Epoch 3/20 => Loss 1.313, Train_accy 57.29:  15%|█▌        | 3/20 [00:07<00:41,  2.45s/it]
Task 17, Epoch 4/20 => Loss 0.854, Train_accy 71.35:  15%|█▌        | 3/20 [00:09<00:41,  2.45s/it]
Task 17, Epoch 4/20 => Loss 0.854, Train_accy 71.35:  20%|██        | 4/20 [00:09<00:39,  2.46s/it]
Task 17, Epoch 5/20 => Loss 0.568, Train_accy 83.85, Test_accy 34.91:  20%|██        | 4/20 [00:20<00:39,  2.46s/it]
Task 17, Epoch 5/20 => Loss 0.568, Train_accy 83.85, Test_accy 34.91:  25%|██▌       | 5/20 [00:20<01:21,  5.45s/it]
Task 17, Epoch 6/20 => Loss 0.506, Train_accy 86.46:  25%|██▌       | 5/20 [00:23<01:21,  5.45s/it]                 
Task 17, Epoch 6/20 => Loss 0.506, Train_accy 86.46:  30%|███       | 6/20 [00:23<01:02,  4.45s/it]
Task 17, Epoch 7/20 => Loss 0.365, Train_accy 88.02:  30%|███       | 6/20 [00:25<01:02,  4.45s/it]
Task 17, Epoch 7/20 => Loss 0.365, Train_accy 88.02:  35%|███▌      | 7/20 [00:25<00:49,  3.81s/it]
Task 17, Epoch 8/20 => Loss 0.377, Train_accy 91.15:  35%|███▌      | 7/20 [00:28<00:49,  3.81s/it]
Task 17, Epoch 8/20 => Loss 0.377, Train_accy 91.15:  40%|████      | 8/20 [00:28<00:40,  3.39s/it]
Task 17, Epoch 9/20 => Loss 0.325, Train_accy 90.62:  40%|████      | 8/20 [00:30<00:40,  3.39s/it]
Task 17, Epoch 9/20 => Loss 0.325, Train_accy 90.62:  45%|████▌     | 9/20 [00:30<00:34,  3.10s/it]
Task 17, Epoch 10/20 => Loss 0.219, Train_accy 94.79, Test_accy 35.27:  45%|████▌     | 9/20 [00:41<00:34,  3.10s/it]
Task 17, Epoch 10/20 => Loss 0.219, Train_accy 94.79, Test_accy 35.27:  50%|█████     | 10/20 [00:41<00:54,  5.43s/it]
Task 17, Epoch 11/20 => Loss 0.234, Train_accy 93.23:  50%|█████     | 10/20 [00:43<00:54,  5.43s/it]                 
Task 17, Epoch 11/20 => Loss 0.234, Train_accy 93.23:  55%|█████▌    | 11/20 [00:43<00:40,  4.53s/it]
Task 17, Epoch 12/20 => Loss 0.205, Train_accy 95.83:  55%|█████▌    | 11/20 [00:46<00:40,  4.53s/it]
Task 17, Epoch 12/20 => Loss 0.205, Train_accy 95.83:  60%|██████    | 12/20 [00:46<00:31,  3.91s/it]
Task 17, Epoch 13/20 => Loss 0.180, Train_accy 94.79:  60%|██████    | 12/20 [00:48<00:31,  3.91s/it]
Task 17, Epoch 13/20 => Loss 0.180, Train_accy 94.79:  65%|██████▌   | 13/20 [00:48<00:24,  3.49s/it]
Task 17, Epoch 14/20 => Loss 0.165, Train_accy 95.31:  65%|██████▌   | 13/20 [00:51<00:24,  3.49s/it]
Task 17, Epoch 14/20 => Loss 0.165, Train_accy 95.31:  70%|███████   | 14/20 [00:51<00:19,  3.18s/it]
Task 17, Epoch 15/20 => Loss 0.155, Train_accy 95.83, Test_accy 35.20:  70%|███████   | 14/20 [01:01<00:19,  3.18s/it]
Task 17, Epoch 15/20 => Loss 0.155, Train_accy 95.83, Test_accy 35.20:  75%|███████▌  | 15/20 [01:01<00:27,  5.46s/it]
Task 17, Epoch 16/20 => Loss 0.139, Train_accy 97.92:  75%|███████▌  | 15/20 [01:04<00:27,  5.46s/it]                 
Task 17, Epoch 16/20 => Loss 0.139, Train_accy 97.92:  80%|████████  | 16/20 [01:04<00:18,  4.57s/it]
Task 17, Epoch 17/20 => Loss 0.215, Train_accy 95.83:  80%|████████  | 16/20 [01:06<00:18,  4.57s/it]
Task 17, Epoch 17/20 => Loss 0.215, Train_accy 95.83:  85%|████████▌ | 17/20 [01:06<00:11,  3.95s/it]
Task 17, Epoch 18/20 => Loss 0.188, Train_accy 93.75:  85%|████████▌ | 17/20 [01:09<00:11,  3.95s/it]
Task 17, Epoch 18/20 => Loss 0.188, Train_accy 93.75:  90%|█████████ | 18/20 [01:09<00:07,  3.51s/it]
Task 17, Epoch 19/20 => Loss 0.135, Train_accy 97.40:  90%|█████████ | 18/20 [01:11<00:07,  3.51s/it]
Task 17, Epoch 19/20 => Loss 0.135, Train_accy 97.40:  95%|█████████▌| 19/20 [01:11<00:03,  3.19s/it]
Task 17, Epoch 20/20 => Loss 0.191, Train_accy 95.83, Test_accy 35.20:  95%|█████████▌| 19/20 [01:22<00:03,  3.19s/it]
Task 17, Epoch 20/20 => Loss 0.191, Train_accy 95.83, Test_accy 35.20: 100%|██████████| 20/20 [01:22<00:00,  5.47s/it]
Task 17, Epoch 20/20 => Loss 0.191, Train_accy 95.83, Test_accy 35.20: 100%|██████████| 20/20 [01:22<00:00,  4.13s/it]
2024-09-07 13:49:21,996 [coda_prompt.py] => Task 17, Epoch 20/20 => Loss 0.191, Train_accy 95.83, Test_accy 35.20
2024-09-07 13:49:30,307 [trainer.py] => No NME accuracy.
2024-09-07 13:49:30,308 [trainer.py] => CNN: {'total': 35.2, '00-09': 41.56, '10-19': 57.14, '20-29': 45.45, '30-39': 46.51, '40-49': 29.69, '50-59': 34.62, '60-69': 49.21, '70-79': 32.29, '80-89': 37.04, '90-99': 12.9, '100-109': 31.67, '110-119': 40.54, '120-129': 15.0, '130-139': 33.72, '140-149': 19.74, '150-159': 29.41, '160-169': 25.88, '170-179': 17.74, 'old': 36.01, 'new': 17.74}
2024-09-07 13:49:30,308 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39, 38.89, 37.76, 37.02, 36.01, 35.2]
2024-09-07 13:49:30,308 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86, 69.05, 67.34, 66.11, 64.89, 63.44]

Average Accuracy (CNN): 49.31
2024-09-07 13:49:30,308 [trainer.py] => Average Accuracy (CNN): 49.31 

2024-09-07 13:49:30,310 [trainer.py] => All params: 89792456
2024-09-07 13:49:30,311 [trainer.py] => Trainable params: 89792456
2024-09-07 13:49:31,243 [coda_prompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 3.156, Train_accy 14.58:   0%|          | 0/20 [00:01<?, ?it/s]
Task 18, Epoch 1/20 => Loss 3.156, Train_accy 14.58:   5%|▌         | 1/20 [00:01<00:37,  1.98s/it]
Task 18, Epoch 2/20 => Loss 2.187, Train_accy 34.72:   5%|▌         | 1/20 [00:03<00:37,  1.98s/it]
Task 18, Epoch 2/20 => Loss 2.187, Train_accy 34.72:  10%|█         | 2/20 [00:03<00:35,  1.97s/it]
Task 18, Epoch 3/20 => Loss 1.359, Train_accy 62.50:  10%|█         | 2/20 [00:05<00:35,  1.97s/it]
Task 18, Epoch 3/20 => Loss 1.359, Train_accy 62.50:  15%|█▌        | 3/20 [00:05<00:33,  1.97s/it]
Task 18, Epoch 4/20 => Loss 1.018, Train_accy 68.06:  15%|█▌        | 3/20 [00:07<00:33,  1.97s/it]
Task 18, Epoch 4/20 => Loss 1.018, Train_accy 68.06:  20%|██        | 4/20 [00:07<00:31,  1.97s/it]
Task 18, Epoch 5/20 => Loss 0.751, Train_accy 77.78, Test_accy 34.24:  20%|██        | 4/20 [00:18<00:31,  1.97s/it]
Task 18, Epoch 5/20 => Loss 0.751, Train_accy 77.78, Test_accy 34.24:  25%|██▌       | 5/20 [00:18<01:15,  5.03s/it]
Task 18, Epoch 6/20 => Loss 0.530, Train_accy 85.42:  25%|██▌       | 5/20 [00:20<01:15,  5.03s/it]                 
Task 18, Epoch 6/20 => Loss 0.530, Train_accy 85.42:  30%|███       | 6/20 [00:20<00:55,  4.00s/it]
Task 18, Epoch 7/20 => Loss 0.361, Train_accy 88.89:  30%|███       | 6/20 [00:22<00:55,  4.00s/it]
Task 18, Epoch 7/20 => Loss 0.361, Train_accy 88.89:  35%|███▌      | 7/20 [00:22<00:43,  3.34s/it]
Task 18, Epoch 8/20 => Loss 0.388, Train_accy 87.50:  35%|███▌      | 7/20 [00:24<00:43,  3.34s/it]
Task 18, Epoch 8/20 => Loss 0.388, Train_accy 87.50:  40%|████      | 8/20 [00:24<00:35,  2.92s/it]
Task 18, Epoch 9/20 => Loss 0.296, Train_accy 93.75:  40%|████      | 8/20 [00:26<00:35,  2.92s/it]
Task 18, Epoch 9/20 => Loss 0.296, Train_accy 93.75:  45%|████▌     | 9/20 [00:26<00:28,  2.62s/it]
Task 18, Epoch 10/20 => Loss 0.186, Train_accy 97.22, Test_accy 33.96:  45%|████▌     | 9/20 [00:36<00:28,  2.62s/it]
Task 18, Epoch 10/20 => Loss 0.186, Train_accy 97.22, Test_accy 33.96:  50%|█████     | 10/20 [00:36<00:50,  5.03s/it]
Task 18, Epoch 11/20 => Loss 0.186, Train_accy 94.44:  50%|█████     | 10/20 [00:38<00:50,  5.03s/it]                 
Task 18, Epoch 11/20 => Loss 0.186, Train_accy 94.44:  55%|█████▌    | 11/20 [00:38<00:36,  4.08s/it]
Task 18, Epoch 12/20 => Loss 0.170, Train_accy 96.53:  55%|█████▌    | 11/20 [00:40<00:36,  4.08s/it]
Task 18, Epoch 12/20 => Loss 0.170, Train_accy 96.53:  60%|██████    | 12/20 [00:40<00:27,  3.44s/it]
Task 18, Epoch 13/20 => Loss 0.197, Train_accy 95.83:  60%|██████    | 12/20 [00:42<00:27,  3.44s/it]
Task 18, Epoch 13/20 => Loss 0.197, Train_accy 95.83:  65%|██████▌   | 13/20 [00:42<00:20,  2.99s/it]
Task 18, Epoch 14/20 => Loss 0.156, Train_accy 97.22:  65%|██████▌   | 13/20 [00:44<00:20,  2.99s/it]
Task 18, Epoch 14/20 => Loss 0.156, Train_accy 97.22:  70%|███████   | 14/20 [00:44<00:16,  2.68s/it]
Task 18, Epoch 15/20 => Loss 0.113, Train_accy 98.61, Test_accy 34.03:  70%|███████   | 14/20 [00:54<00:16,  2.68s/it]
Task 18, Epoch 15/20 => Loss 0.113, Train_accy 98.61, Test_accy 34.03:  75%|███████▌  | 15/20 [00:54<00:25,  5.01s/it]
Task 18, Epoch 16/20 => Loss 0.153, Train_accy 97.22:  75%|███████▌  | 15/20 [00:56<00:25,  5.01s/it]                 
Task 18, Epoch 16/20 => Loss 0.153, Train_accy 97.22:  80%|████████  | 16/20 [00:56<00:16,  4.10s/it]
Task 18, Epoch 17/20 => Loss 0.136, Train_accy 95.83:  80%|████████  | 16/20 [00:58<00:16,  4.10s/it]
Task 18, Epoch 17/20 => Loss 0.136, Train_accy 95.83:  85%|████████▌ | 17/20 [00:58<00:10,  3.45s/it]
Task 18, Epoch 18/20 => Loss 0.118, Train_accy 97.22:  85%|████████▌ | 17/20 [01:00<00:10,  3.45s/it]
Task 18, Epoch 18/20 => Loss 0.118, Train_accy 97.22:  90%|█████████ | 18/20 [01:00<00:06,  3.01s/it]
Task 18, Epoch 19/20 => Loss 0.098, Train_accy 97.22:  90%|█████████ | 18/20 [01:02<00:06,  3.01s/it]
Task 18, Epoch 19/20 => Loss 0.098, Train_accy 97.22:  95%|█████████▌| 19/20 [01:02<00:02,  2.69s/it]
Task 18, Epoch 20/20 => Loss 0.095, Train_accy 98.61, Test_accy 34.03:  95%|█████████▌| 19/20 [01:13<00:02,  2.69s/it]
Task 18, Epoch 20/20 => Loss 0.095, Train_accy 98.61, Test_accy 34.03: 100%|██████████| 20/20 [01:13<00:00,  5.00s/it]
Task 18, Epoch 20/20 => Loss 0.095, Train_accy 98.61, Test_accy 34.03: 100%|██████████| 20/20 [01:13<00:00,  3.66s/it]
2024-09-07 13:50:44,451 [coda_prompt.py] => Task 18, Epoch 20/20 => Loss 0.095, Train_accy 98.61, Test_accy 34.03
2024-09-07 13:50:52,868 [trainer.py] => No NME accuracy.
2024-09-07 13:50:52,868 [trainer.py] => CNN: {'total': 34.03, '00-09': 41.56, '10-19': 55.1, '20-29': 43.43, '30-39': 46.51, '40-49': 31.25, '50-59': 32.69, '60-69': 49.21, '70-79': 32.29, '80-89': 34.57, '90-99': 11.29, '100-109': 30.0, '110-119': 40.54, '120-129': 15.0, '130-139': 32.56, '140-149': 19.74, '150-159': 29.41, '160-169': 24.71, '170-179': 19.35, '180-189': 15.38, 'old': 34.55, 'new': 15.38}
2024-09-07 13:50:52,869 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39, 38.89, 37.76, 37.02, 36.01, 35.2, 34.03]
2024-09-07 13:50:52,869 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86, 69.05, 67.34, 66.11, 64.89, 63.44, 62.55]

Average Accuracy (CNN): 48.5
2024-09-07 13:50:52,869 [trainer.py] => Average Accuracy (CNN): 48.5 

2024-09-07 13:50:52,870 [trainer.py] => All params: 89792456
2024-09-07 13:50:52,871 [trainer.py] => Trainable params: 89792456
2024-09-07 13:50:53,843 [coda_prompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.583, Train_accy 21.43:   0%|          | 0/20 [00:04<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.583, Train_accy 21.43:   5%|▌         | 1/20 [00:04<01:16,  4.00s/it]
Task 19, Epoch 2/20 => Loss 1.271, Train_accy 58.04:   5%|▌         | 1/20 [00:08<01:16,  4.00s/it]
Task 19, Epoch 2/20 => Loss 1.271, Train_accy 58.04:  10%|█         | 2/20 [00:08<01:12,  4.02s/it]
Task 19, Epoch 3/20 => Loss 0.673, Train_accy 78.57:  10%|█         | 2/20 [00:12<01:12,  4.02s/it]
Task 19, Epoch 3/20 => Loss 0.673, Train_accy 78.57:  15%|█▌        | 3/20 [00:12<01:08,  4.05s/it]
Task 19, Epoch 4/20 => Loss 0.406, Train_accy 86.61:  15%|█▌        | 3/20 [00:16<01:08,  4.05s/it]
Task 19, Epoch 4/20 => Loss 0.406, Train_accy 86.61:  20%|██        | 4/20 [00:16<01:04,  4.04s/it]
Task 19, Epoch 5/20 => Loss 0.269, Train_accy 92.56, Test_accy 32.98:  20%|██        | 4/20 [00:29<01:04,  4.04s/it]
Task 19, Epoch 5/20 => Loss 0.269, Train_accy 92.56, Test_accy 32.98:  25%|██▌       | 5/20 [00:29<01:49,  7.30s/it]
Task 19, Epoch 6/20 => Loss 0.299, Train_accy 90.18:  25%|██▌       | 5/20 [00:33<01:49,  7.30s/it]                 
Task 19, Epoch 6/20 => Loss 0.299, Train_accy 90.18:  30%|███       | 6/20 [00:33<01:26,  6.20s/it]
Task 19, Epoch 7/20 => Loss 0.208, Train_accy 93.45:  30%|███       | 6/20 [00:37<01:26,  6.20s/it]
Task 19, Epoch 7/20 => Loss 0.208, Train_accy 93.45:  35%|███▌      | 7/20 [00:37<01:11,  5.51s/it]
Task 19, Epoch 8/20 => Loss 0.111, Train_accy 97.92:  35%|███▌      | 7/20 [00:41<01:11,  5.51s/it]
Task 19, Epoch 8/20 => Loss 0.111, Train_accy 97.92:  40%|████      | 8/20 [00:41<01:00,  5.05s/it]
Task 19, Epoch 9/20 => Loss 0.168, Train_accy 96.13:  40%|████      | 8/20 [00:45<01:00,  5.05s/it]
Task 19, Epoch 9/20 => Loss 0.168, Train_accy 96.13:  45%|████▌     | 9/20 [00:45<00:52,  4.74s/it]
Task 19, Epoch 10/20 => Loss 0.132, Train_accy 96.43, Test_accy 33.44:  45%|████▌     | 9/20 [00:58<00:52,  4.74s/it]
Task 19, Epoch 10/20 => Loss 0.132, Train_accy 96.43, Test_accy 33.44:  50%|█████     | 10/20 [00:58<01:12,  7.28s/it]
Task 19, Epoch 11/20 => Loss 0.115, Train_accy 96.43:  50%|█████     | 10/20 [01:02<01:12,  7.28s/it]                 
Task 19, Epoch 11/20 => Loss 0.115, Train_accy 96.43:  55%|█████▌    | 11/20 [01:02<00:56,  6.30s/it]
Task 19, Epoch 12/20 => Loss 0.128, Train_accy 96.13:  55%|█████▌    | 11/20 [01:06<00:56,  6.30s/it]
Task 19, Epoch 12/20 => Loss 0.128, Train_accy 96.13:  60%|██████    | 12/20 [01:06<00:45,  5.63s/it]
Task 19, Epoch 13/20 => Loss 0.123, Train_accy 96.73:  60%|██████    | 12/20 [01:10<00:45,  5.63s/it]
Task 19, Epoch 13/20 => Loss 0.123, Train_accy 96.73:  65%|██████▌   | 13/20 [01:10<00:36,  5.17s/it]
Task 19, Epoch 14/20 => Loss 0.124, Train_accy 96.43:  65%|██████▌   | 13/20 [01:14<00:36,  5.17s/it]
Task 19, Epoch 14/20 => Loss 0.124, Train_accy 96.43:  70%|███████   | 14/20 [01:14<00:29,  4.83s/it]
Task 19, Epoch 15/20 => Loss 0.097, Train_accy 97.32, Test_accy 33.77:  70%|███████   | 14/20 [01:27<00:29,  4.83s/it]
Task 19, Epoch 15/20 => Loss 0.097, Train_accy 97.32, Test_accy 33.77:  75%|███████▌  | 15/20 [01:27<00:36,  7.31s/it]
Task 19, Epoch 16/20 => Loss 0.126, Train_accy 95.24:  75%|███████▌  | 15/20 [01:31<00:36,  7.31s/it]                 
Task 19, Epoch 16/20 => Loss 0.126, Train_accy 95.24:  80%|████████  | 16/20 [01:31<00:25,  6.34s/it]
Task 19, Epoch 17/20 => Loss 0.111, Train_accy 96.43:  80%|████████  | 16/20 [01:36<00:25,  6.34s/it]
Task 19, Epoch 17/20 => Loss 0.111, Train_accy 96.43:  85%|████████▌ | 17/20 [01:36<00:17,  5.68s/it]
Task 19, Epoch 18/20 => Loss 0.083, Train_accy 97.02:  85%|████████▌ | 17/20 [01:40<00:17,  5.68s/it]
Task 19, Epoch 18/20 => Loss 0.083, Train_accy 97.02:  90%|█████████ | 18/20 [01:40<00:10,  5.19s/it]
Task 19, Epoch 19/20 => Loss 0.094, Train_accy 97.62:  90%|█████████ | 18/20 [01:44<00:10,  5.19s/it]
Task 19, Epoch 19/20 => Loss 0.094, Train_accy 97.62:  95%|█████████▌| 19/20 [01:44<00:04,  4.85s/it]
Task 19, Epoch 20/20 => Loss 0.138, Train_accy 96.13, Test_accy 33.77:  95%|█████████▌| 19/20 [01:57<00:04,  4.85s/it]
Task 19, Epoch 20/20 => Loss 0.138, Train_accy 96.13, Test_accy 33.77: 100%|██████████| 20/20 [01:57<00:00,  7.31s/it]
Task 19, Epoch 20/20 => Loss 0.138, Train_accy 96.13, Test_accy 33.77: 100%|██████████| 20/20 [01:57<00:00,  5.86s/it]
2024-09-07 13:52:51,087 [coda_prompt.py] => Task 19, Epoch 20/20 => Loss 0.138, Train_accy 96.13, Test_accy 33.77
2024-09-07 13:53:00,100 [trainer.py] => No NME accuracy.
2024-09-07 13:53:00,100 [trainer.py] => CNN: {'total': 33.77, '00-09': 41.56, '10-19': 55.1, '20-29': 42.42, '30-39': 45.35, '40-49': 28.12, '50-59': 34.62, '60-69': 48.41, '70-79': 31.25, '80-89': 38.27, '90-99': 11.29, '100-109': 31.67, '110-119': 41.89, '120-129': 13.33, '130-139': 32.56, '140-149': 18.42, '150-159': 27.45, '160-169': 23.53, '170-179': 17.74, '180-189': 15.38, '190-199': 35.29, 'old': 33.68, 'new': 35.29}
2024-09-07 13:53:00,100 [trainer.py] => CNN top1 curve: [75.32, 69.14, 63.5, 63.33, 58.73, 54.83, 52.66, 49.57, 46.47, 43.64, 42.84, 42.26, 40.39, 38.89, 37.76, 37.02, 36.01, 35.2, 34.03, 33.77]
2024-09-07 13:53:00,100 [trainer.py] => CNN top5 curve: [93.51, 92.0, 89.78, 88.06, 85.85, 83.82, 82.39, 79.51, 77.54, 75.62, 74.36, 72.62, 69.86, 69.05, 67.34, 66.11, 64.89, 63.44, 62.55, 61.88]

Average Accuracy (CNN): 47.77
2024-09-07 13:53:00,101 [trainer.py] => Average Accuracy (CNN): 47.77 

Accuracy Matrix (CNN):
[[75.32 55.84 53.25 55.84 55.84 53.25 51.95 51.95 51.95 49.35 46.75 46.75
  45.45 46.75 45.45 41.56 41.56 41.56 41.56 41.56]
 [ 0.   79.59 72.45 71.43 68.37 68.37 67.35 69.39 65.31 64.29 63.27 62.24
  61.22 58.16 58.16 57.14 57.14 57.14 55.1  55.1 ]
 [ 0.    0.   62.63 61.62 56.57 52.53 53.54 49.49 47.47 48.48 49.49 49.49
  48.48 45.45 47.47 47.47 45.45 45.45 43.43 42.42]
 [ 0.    0.    0.   62.79 61.63 60.47 52.33 51.16 47.67 48.84 50.   47.67
  47.67 44.19 47.67 46.51 46.51 46.51 46.51 45.35]
 [ 0.    0.    0.    0.   46.88 45.31 32.81 32.81 31.25 32.81 31.25 31.25
  29.69 29.69 29.69 29.69 29.69 29.69 31.25 28.12]
 [ 0.    0.    0.    0.    0.   38.46 40.38 36.54 36.54 36.54 36.54 36.54
  38.46 36.54 36.54 34.62 32.69 34.62 32.69 34.62]
 [ 0.    0.    0.    0.    0.    0.   56.35 53.97 53.17 52.38 51.59 50.
  50.   48.41 47.62 47.62 49.21 49.21 49.21 48.41]
 [ 0.    0.    0.    0.    0.    0.    0.   38.54 37.5  36.46 35.42 35.42
  35.42 34.38 34.38 34.38 34.38 32.29 32.29 31.25]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   34.57 32.1  32.1  32.1
  32.1  33.33 33.33 34.57 34.57 37.04 34.57 38.27]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   14.52 14.52 14.52
  14.52 14.52 14.52 14.52 14.52 12.9  11.29 11.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   38.33 36.67
  35.   33.33 33.33 33.33 31.67 31.67 30.   31.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   43.24
  43.24 44.59 43.24 41.89 40.54 40.54 40.54 41.89]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  16.67 15.   15.   15.   15.   15.   15.   13.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   34.88 34.88 34.88 33.72 33.72 32.56 32.56]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   18.42 19.74 19.74 19.74 19.74 18.42]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   29.41 29.41 29.41 29.41 27.45]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   25.88 25.88 24.71 23.53]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   17.74 19.35 17.74]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   15.38 15.38]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   35.29]]
2024-09-07 13:53:00,105 [trainer.py] => Forgetting (CNN): 8.481052631578947
2024-09-07 13:53:02,968 [trainer.py] => config: ./exps/coda_prompt_ina_B100_Inc5.json
2024-09-07 13:53:02,977 [trainer.py] => prefix:  
2024-09-07 13:53:02,977 [trainer.py] => dataset: imageneta
2024-09-07 13:53:02,977 [trainer.py] => memory_size: 0
2024-09-07 13:53:02,977 [trainer.py] => memory_per_class: 0
2024-09-07 13:53:02,977 [trainer.py] => fixed_memory: False
2024-09-07 13:53:02,977 [trainer.py] => shuffle: True
2024-09-07 13:53:02,977 [trainer.py] => init_cls: 100
2024-09-07 13:53:02,978 [trainer.py] => increment: 20
2024-09-07 13:53:02,978 [trainer.py] => model_name: coda_prompt
2024-09-07 13:53:02,978 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-07 13:53:02,978 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 13:53:02,978 [trainer.py] => seed: 1993
2024-09-07 13:53:02,978 [trainer.py] => tuned_epoch: 20
2024-09-07 13:53:02,978 [trainer.py] => init_lr: 0.001
2024-09-07 13:53:02,978 [trainer.py] => batch_size: 48
2024-09-07 13:53:02,978 [trainer.py] => weight_decay: 0
2024-09-07 13:53:02,978 [trainer.py] => min_lr: 1e-05
2024-09-07 13:53:02,978 [trainer.py] => optimizer: adam
2024-09-07 13:53:02,978 [trainer.py] => scheduler: cosine
2024-09-07 13:53:02,978 [trainer.py] => reinit_optimizer: True
2024-09-07 13:53:02,978 [trainer.py] => pretrained: True
2024-09-07 13:53:02,978 [trainer.py] => drop: 0.0
2024-09-07 13:53:02,978 [trainer.py] => drop_path: 0.0
2024-09-07 13:53:02,978 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-07 13:53:03,005 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 13:53:04,856 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-07 13:53:04,856 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-07 13:53:04,857 [trainer.py] => All params: 89792456
2024-09-07 13:53:04,857 [trainer.py] => Trainable params: 89792456
2024-09-07 13:53:04,857 [coda_prompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.307, Train_accy 27.82:   0%|          | 0/20 [00:36<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.307, Train_accy 27.82:   5%|▌         | 1/20 [00:36<11:25, 36.06s/it]
Task 0, Epoch 2/20 => Loss 1.405, Train_accy 65.56:   5%|▌         | 1/20 [01:11<11:25, 36.06s/it]
Task 0, Epoch 2/20 => Loss 1.405, Train_accy 65.56:  10%|█         | 2/20 [01:11<10:46, 35.90s/it]
Task 0, Epoch 3/20 => Loss 0.850, Train_accy 78.09:  10%|█         | 2/20 [01:47<10:46, 35.90s/it]
Task 0, Epoch 3/20 => Loss 0.850, Train_accy 78.09:  15%|█▌        | 3/20 [01:47<10:09, 35.88s/it]
Task 0, Epoch 4/20 => Loss 0.652, Train_accy 82.54:  15%|█▌        | 3/20 [02:23<10:09, 35.88s/it]
Task 0, Epoch 4/20 => Loss 0.652, Train_accy 82.54:  20%|██        | 4/20 [02:23<09:33, 35.87s/it]
Task 0, Epoch 5/20 => Loss 0.516, Train_accy 86.73, Test_accy 65.99:  20%|██        | 4/20 [03:04<09:33, 35.87s/it]
Task 0, Epoch 5/20 => Loss 0.516, Train_accy 86.73, Test_accy 65.99:  25%|██▌       | 5/20 [03:04<09:26, 37.77s/it]
Task 0, Epoch 6/20 => Loss 0.483, Train_accy 87.10:  25%|██▌       | 5/20 [03:40<09:26, 37.77s/it]                 
Task 0, Epoch 6/20 => Loss 0.483, Train_accy 87.10:  30%|███       | 6/20 [03:40<08:39, 37.12s/it]
Task 0, Epoch 7/20 => Loss 0.448, Train_accy 88.36:  30%|███       | 6/20 [04:16<08:39, 37.12s/it]
Task 0, Epoch 7/20 => Loss 0.448, Train_accy 88.36:  35%|███▌      | 7/20 [04:16<07:57, 36.70s/it]
Task 0, Epoch 8/20 => Loss 0.393, Train_accy 89.46:  35%|███▌      | 7/20 [04:52<07:57, 36.70s/it]
Task 0, Epoch 8/20 => Loss 0.393, Train_accy 89.46:  40%|████      | 8/20 [04:52<07:17, 36.45s/it]
Task 0, Epoch 9/20 => Loss 0.361, Train_accy 90.50:  40%|████      | 8/20 [05:28<07:17, 36.45s/it]
Task 0, Epoch 9/20 => Loss 0.361, Train_accy 90.50:  45%|████▌     | 9/20 [05:28<06:38, 36.26s/it]
Task 0, Epoch 10/20 => Loss 0.336, Train_accy 91.05, Test_accy 64.80:  45%|████▌     | 9/20 [06:09<06:38, 36.26s/it]
Task 0, Epoch 10/20 => Loss 0.336, Train_accy 91.05, Test_accy 64.80:  50%|█████     | 10/20 [06:09<06:17, 37.76s/it]
Task 0, Epoch 11/20 => Loss 0.328, Train_accy 90.93:  50%|█████     | 10/20 [06:45<06:17, 37.76s/it]                 
Task 0, Epoch 11/20 => Loss 0.328, Train_accy 90.93:  55%|█████▌    | 11/20 [06:45<05:34, 37.17s/it]
Task 0, Epoch 12/20 => Loss 0.315, Train_accy 91.97:  55%|█████▌    | 11/20 [07:21<05:34, 37.17s/it]
Task 0, Epoch 12/20 => Loss 0.315, Train_accy 91.97:  60%|██████    | 12/20 [07:21<04:54, 36.80s/it]
Task 0, Epoch 13/20 => Loss 0.303, Train_accy 91.82:  60%|██████    | 12/20 [07:56<04:54, 36.80s/it]
Task 0, Epoch 13/20 => Loss 0.303, Train_accy 91.82:  65%|██████▌   | 13/20 [07:56<04:15, 36.51s/it]
Task 0, Epoch 14/20 => Loss 0.280, Train_accy 92.43:  65%|██████▌   | 13/20 [08:32<04:15, 36.51s/it]
Task 0, Epoch 14/20 => Loss 0.280, Train_accy 92.43:  70%|███████   | 14/20 [08:32<03:38, 36.34s/it]
Task 0, Epoch 15/20 => Loss 0.299, Train_accy 92.06, Test_accy 65.16:  70%|███████   | 14/20 [09:13<03:38, 36.34s/it]
Task 0, Epoch 15/20 => Loss 0.299, Train_accy 92.06, Test_accy 65.16:  75%|███████▌  | 15/20 [09:13<03:08, 37.76s/it]
Task 0, Epoch 16/20 => Loss 0.261, Train_accy 92.86:  75%|███████▌  | 15/20 [09:49<03:08, 37.76s/it]                 
Task 0, Epoch 16/20 => Loss 0.261, Train_accy 92.86:  80%|████████  | 16/20 [09:49<02:28, 37.21s/it]
Task 0, Epoch 17/20 => Loss 0.272, Train_accy 92.46:  80%|████████  | 16/20 [10:25<02:28, 37.21s/it]
Task 0, Epoch 17/20 => Loss 0.272, Train_accy 92.46:  85%|████████▌ | 17/20 [10:25<01:50, 36.79s/it]
Task 0, Epoch 18/20 => Loss 0.235, Train_accy 93.84:  85%|████████▌ | 17/20 [11:01<01:50, 36.79s/it]
Task 0, Epoch 18/20 => Loss 0.235, Train_accy 93.84:  90%|█████████ | 18/20 [11:01<01:13, 36.52s/it]
Task 0, Epoch 19/20 => Loss 0.257, Train_accy 92.77:  90%|█████████ | 18/20 [11:37<01:13, 36.52s/it]
Task 0, Epoch 19/20 => Loss 0.257, Train_accy 92.77:  95%|█████████▌| 19/20 [11:37<00:36, 36.35s/it]
Task 0, Epoch 20/20 => Loss 0.236, Train_accy 93.63, Test_accy 65.64:  95%|█████████▌| 19/20 [12:18<00:36, 36.35s/it]
Task 0, Epoch 20/20 => Loss 0.236, Train_accy 93.63, Test_accy 65.64: 100%|██████████| 20/20 [12:18<00:00, 37.76s/it]
Task 0, Epoch 20/20 => Loss 0.236, Train_accy 93.63, Test_accy 65.64: 100%|██████████| 20/20 [12:18<00:00, 36.93s/it]
2024-09-07 14:05:23,897 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.236, Train_accy 93.63, Test_accy 65.64
2024-09-07 14:05:29,039 [trainer.py] => No NME accuracy.
2024-09-07 14:05:29,039 [trainer.py] => CNN: {'total': 65.64, '00-99': 65.64, 'old': 0, 'new': 65.64}
2024-09-07 14:05:29,040 [trainer.py] => CNN top1 curve: [65.64]
2024-09-07 14:05:29,040 [trainer.py] => CNN top5 curve: [85.85]

Average Accuracy (CNN): 65.64
2024-09-07 14:05:29,040 [trainer.py] => Average Accuracy (CNN): 65.64 

2024-09-07 14:05:29,041 [trainer.py] => All params: 89792456
2024-09-07 14:05:29,042 [trainer.py] => Trainable params: 89792456
2024-09-07 14:05:29,787 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.911, Train_accy 22.92:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.911, Train_accy 22.92:   5%|▌         | 1/20 [00:05<01:46,  5.58s/it]
Task 1, Epoch 2/20 => Loss 1.144, Train_accy 67.08:   5%|▌         | 1/20 [00:11<01:46,  5.58s/it]
Task 1, Epoch 2/20 => Loss 1.144, Train_accy 67.08:  10%|█         | 2/20 [00:11<01:41,  5.62s/it]
Task 1, Epoch 3/20 => Loss 0.639, Train_accy 82.71:  10%|█         | 2/20 [00:16<01:41,  5.62s/it]
Task 1, Epoch 3/20 => Loss 0.639, Train_accy 82.71:  15%|█▌        | 3/20 [00:16<01:35,  5.63s/it]
Task 1, Epoch 4/20 => Loss 0.374, Train_accy 90.21:  15%|█▌        | 3/20 [00:22<01:35,  5.63s/it]
Task 1, Epoch 4/20 => Loss 0.374, Train_accy 90.21:  20%|██        | 4/20 [00:22<01:29,  5.62s/it]
Task 1, Epoch 5/20 => Loss 0.271, Train_accy 92.50, Test_accy 60.21:  20%|██        | 4/20 [00:34<01:29,  5.62s/it]
Task 1, Epoch 5/20 => Loss 0.271, Train_accy 92.50, Test_accy 60.21:  25%|██▌       | 5/20 [00:34<01:56,  7.77s/it]
Task 1, Epoch 6/20 => Loss 0.284, Train_accy 93.33:  25%|██▌       | 5/20 [00:39<01:56,  7.77s/it]                 
Task 1, Epoch 6/20 => Loss 0.284, Train_accy 93.33:  30%|███       | 6/20 [00:39<01:38,  7.03s/it]
Task 1, Epoch 7/20 => Loss 0.206, Train_accy 95.83:  30%|███       | 6/20 [00:45<01:38,  7.03s/it]
Task 1, Epoch 7/20 => Loss 0.206, Train_accy 95.83:  35%|███▌      | 7/20 [00:45<01:25,  6.57s/it]
Task 1, Epoch 8/20 => Loss 0.191, Train_accy 95.62:  35%|███▌      | 7/20 [00:50<01:25,  6.57s/it]
Task 1, Epoch 8/20 => Loss 0.191, Train_accy 95.62:  40%|████      | 8/20 [00:50<01:15,  6.27s/it]
Task 1, Epoch 9/20 => Loss 0.177, Train_accy 94.58:  40%|████      | 8/20 [00:56<01:15,  6.27s/it]
Task 1, Epoch 9/20 => Loss 0.177, Train_accy 94.58:  45%|████▌     | 9/20 [00:56<01:06,  6.06s/it]
Task 1, Epoch 10/20 => Loss 0.131, Train_accy 97.50, Test_accy 61.33:  45%|████▌     | 9/20 [01:08<01:06,  6.06s/it]
Task 1, Epoch 10/20 => Loss 0.131, Train_accy 97.50, Test_accy 61.33:  50%|█████     | 10/20 [01:08<01:17,  7.77s/it]
Task 1, Epoch 11/20 => Loss 0.146, Train_accy 96.25:  50%|█████     | 10/20 [01:13<01:17,  7.77s/it]                 
Task 1, Epoch 11/20 => Loss 0.146, Train_accy 96.25:  55%|█████▌    | 11/20 [01:13<01:04,  7.12s/it]
Task 1, Epoch 12/20 => Loss 0.136, Train_accy 95.83:  55%|█████▌    | 11/20 [01:19<01:04,  7.12s/it]
Task 1, Epoch 12/20 => Loss 0.136, Train_accy 95.83:  60%|██████    | 12/20 [01:19<00:53,  6.67s/it]
Task 1, Epoch 13/20 => Loss 0.124, Train_accy 97.50:  60%|██████    | 12/20 [01:25<00:53,  6.67s/it]
Task 1, Epoch 13/20 => Loss 0.124, Train_accy 97.50:  65%|██████▌   | 13/20 [01:25<00:44,  6.36s/it]
Task 1, Epoch 14/20 => Loss 0.128, Train_accy 96.46:  65%|██████▌   | 13/20 [01:30<00:44,  6.36s/it]
Task 1, Epoch 14/20 => Loss 0.128, Train_accy 96.46:  70%|███████   | 14/20 [01:30<00:36,  6.14s/it]
Task 1, Epoch 15/20 => Loss 0.165, Train_accy 95.00, Test_accy 61.95:  70%|███████   | 14/20 [01:42<00:36,  6.14s/it]
Task 1, Epoch 15/20 => Loss 0.165, Train_accy 95.00, Test_accy 61.95:  75%|███████▌  | 15/20 [01:42<00:38,  7.78s/it]
Task 1, Epoch 16/20 => Loss 0.143, Train_accy 95.62:  75%|███████▌  | 15/20 [01:47<00:38,  7.78s/it]                 
Task 1, Epoch 16/20 => Loss 0.143, Train_accy 95.62:  80%|████████  | 16/20 [01:47<00:28,  7.12s/it]
Task 1, Epoch 17/20 => Loss 0.108, Train_accy 96.88:  80%|████████  | 16/20 [01:53<00:28,  7.12s/it]
Task 1, Epoch 17/20 => Loss 0.108, Train_accy 96.88:  85%|████████▌ | 17/20 [01:53<00:20,  6.68s/it]
Task 1, Epoch 18/20 => Loss 0.086, Train_accy 98.75:  85%|████████▌ | 17/20 [01:59<00:20,  6.68s/it]
Task 1, Epoch 18/20 => Loss 0.086, Train_accy 98.75:  90%|█████████ | 18/20 [01:59<00:12,  6.36s/it]
Task 1, Epoch 19/20 => Loss 0.118, Train_accy 96.04:  90%|█████████ | 18/20 [02:04<00:12,  6.36s/it]
Task 1, Epoch 19/20 => Loss 0.118, Train_accy 96.04:  95%|█████████▌| 19/20 [02:04<00:06,  6.14s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 95.42, Test_accy 62.26:  95%|█████████▌| 19/20 [02:16<00:06,  6.14s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 95.42, Test_accy 62.26: 100%|██████████| 20/20 [02:16<00:00,  7.78s/it]
Task 1, Epoch 20/20 => Loss 0.154, Train_accy 95.42, Test_accy 62.26: 100%|██████████| 20/20 [02:16<00:00,  6.82s/it]
2024-09-07 14:07:46,133 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.154, Train_accy 95.42, Test_accy 62.26
2024-09-07 14:07:52,145 [trainer.py] => No NME accuracy.
2024-09-07 14:07:52,145 [trainer.py] => CNN: {'total': 62.26, '00-99': 65.87, '100-119': 39.55, 'old': 65.87, 'new': 39.55}
2024-09-07 14:07:52,146 [trainer.py] => CNN top1 curve: [65.64, 62.26]
2024-09-07 14:07:52,146 [trainer.py] => CNN top5 curve: [85.85, 83.38]

Average Accuracy (CNN): 63.95
2024-09-07 14:07:52,146 [trainer.py] => Average Accuracy (CNN): 63.95 

2024-09-07 14:07:52,147 [trainer.py] => All params: 89792456
2024-09-07 14:07:52,148 [trainer.py] => Trainable params: 89792456
2024-09-07 14:07:53,410 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.213, Train_accy 18.94:   0%|          | 0/20 [00:06<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.213, Train_accy 18.94:   5%|▌         | 1/20 [00:06<01:56,  6.12s/it]
Task 2, Epoch 2/20 => Loss 1.375, Train_accy 60.04:   5%|▌         | 1/20 [00:12<01:56,  6.12s/it]
Task 2, Epoch 2/20 => Loss 1.375, Train_accy 60.04:  10%|█         | 2/20 [00:12<01:51,  6.19s/it]
Task 2, Epoch 3/20 => Loss 0.775, Train_accy 75.76:  10%|█         | 2/20 [00:18<01:51,  6.19s/it]
Task 2, Epoch 3/20 => Loss 0.775, Train_accy 75.76:  15%|█▌        | 3/20 [00:18<01:44,  6.17s/it]
Task 2, Epoch 4/20 => Loss 0.456, Train_accy 87.12:  15%|█▌        | 3/20 [00:24<01:44,  6.17s/it]
Task 2, Epoch 4/20 => Loss 0.456, Train_accy 87.12:  20%|██        | 4/20 [00:24<01:38,  6.16s/it]
Task 2, Epoch 5/20 => Loss 0.352, Train_accy 90.72, Test_accy 56.74:  20%|██        | 4/20 [00:37<01:38,  6.16s/it]
Task 2, Epoch 5/20 => Loss 0.352, Train_accy 90.72, Test_accy 56.74:  25%|██▌       | 5/20 [00:37<02:09,  8.62s/it]
Task 2, Epoch 6/20 => Loss 0.331, Train_accy 91.29:  25%|██▌       | 5/20 [00:43<02:09,  8.62s/it]                 
Task 2, Epoch 6/20 => Loss 0.331, Train_accy 91.29:  30%|███       | 6/20 [00:43<01:48,  7.77s/it]
Task 2, Epoch 7/20 => Loss 0.229, Train_accy 93.18:  30%|███       | 6/20 [00:49<01:48,  7.77s/it]
Task 2, Epoch 7/20 => Loss 0.229, Train_accy 93.18:  35%|███▌      | 7/20 [00:49<01:34,  7.24s/it]
Task 2, Epoch 8/20 => Loss 0.220, Train_accy 95.08:  35%|███▌      | 7/20 [00:56<01:34,  7.24s/it]
Task 2, Epoch 8/20 => Loss 0.220, Train_accy 95.08:  40%|████      | 8/20 [00:56<01:22,  6.90s/it]
Task 2, Epoch 9/20 => Loss 0.233, Train_accy 94.13:  40%|████      | 8/20 [01:02<01:22,  6.90s/it]
Task 2, Epoch 9/20 => Loss 0.233, Train_accy 94.13:  45%|████▌     | 9/20 [01:02<01:13,  6.70s/it]
Task 2, Epoch 10/20 => Loss 0.224, Train_accy 93.94, Test_accy 57.09:  45%|████▌     | 9/20 [01:15<01:13,  6.70s/it]
Task 2, Epoch 10/20 => Loss 0.224, Train_accy 93.94, Test_accy 57.09:  50%|█████     | 10/20 [01:15<01:27,  8.70s/it]
Task 2, Epoch 11/20 => Loss 0.195, Train_accy 94.70:  50%|█████     | 10/20 [01:21<01:27,  8.70s/it]                 
Task 2, Epoch 11/20 => Loss 0.195, Train_accy 94.70:  55%|█████▌    | 11/20 [01:21<01:11,  7.93s/it]
Task 2, Epoch 12/20 => Loss 0.176, Train_accy 94.89:  55%|█████▌    | 11/20 [01:27<01:11,  7.93s/it]
Task 2, Epoch 12/20 => Loss 0.176, Train_accy 94.89:  60%|██████    | 12/20 [01:27<00:59,  7.40s/it]
Task 2, Epoch 13/20 => Loss 0.148, Train_accy 96.21:  60%|██████    | 12/20 [01:34<00:59,  7.40s/it]
Task 2, Epoch 13/20 => Loss 0.148, Train_accy 96.21:  65%|██████▌   | 13/20 [01:34<00:49,  7.02s/it]
Task 2, Epoch 14/20 => Loss 0.139, Train_accy 97.16:  65%|██████▌   | 13/20 [01:40<00:49,  7.02s/it]
Task 2, Epoch 14/20 => Loss 0.139, Train_accy 97.16:  70%|███████   | 14/20 [01:40<00:40,  6.77s/it]
Task 2, Epoch 15/20 => Loss 0.140, Train_accy 97.16, Test_accy 57.09:  70%|███████   | 14/20 [01:53<00:40,  6.77s/it]
Task 2, Epoch 15/20 => Loss 0.140, Train_accy 97.16, Test_accy 57.09:  75%|███████▌  | 15/20 [01:53<00:43,  8.64s/it]
Task 2, Epoch 16/20 => Loss 0.144, Train_accy 96.21:  75%|███████▌  | 15/20 [01:59<00:43,  8.64s/it]                 
Task 2, Epoch 16/20 => Loss 0.144, Train_accy 96.21:  80%|████████  | 16/20 [01:59<00:31,  7.90s/it]
Task 2, Epoch 17/20 => Loss 0.152, Train_accy 96.02:  80%|████████  | 16/20 [02:05<00:31,  7.90s/it]
Task 2, Epoch 17/20 => Loss 0.152, Train_accy 96.02:  85%|████████▌ | 17/20 [02:05<00:22,  7.39s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 96.40:  85%|████████▌ | 17/20 [02:11<00:22,  7.39s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 96.40:  90%|█████████ | 18/20 [02:11<00:14,  7.03s/it]
Task 2, Epoch 19/20 => Loss 0.107, Train_accy 97.73:  90%|█████████ | 18/20 [02:18<00:14,  7.03s/it]
Task 2, Epoch 19/20 => Loss 0.107, Train_accy 97.73:  95%|█████████▌| 19/20 [02:18<00:06,  6.80s/it]
Task 2, Epoch 20/20 => Loss 0.127, Train_accy 96.02, Test_accy 57.18:  95%|█████████▌| 19/20 [02:31<00:06,  6.80s/it]
Task 2, Epoch 20/20 => Loss 0.127, Train_accy 96.02, Test_accy 57.18: 100%|██████████| 20/20 [02:31<00:00,  8.65s/it]
Task 2, Epoch 20/20 => Loss 0.127, Train_accy 96.02, Test_accy 57.18: 100%|██████████| 20/20 [02:31<00:00,  7.55s/it]
2024-09-07 14:10:24,432 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.127, Train_accy 96.02, Test_accy 57.18
2024-09-07 14:10:31,185 [trainer.py] => No NME accuracy.
2024-09-07 14:10:31,185 [trainer.py] => CNN: {'total': 57.18, '00-99': 65.28, '100-119': 38.81, '120-139': 27.4, 'old': 61.64, 'new': 27.4}
2024-09-07 14:10:31,185 [trainer.py] => CNN top1 curve: [65.64, 62.26, 57.18]
2024-09-07 14:10:31,185 [trainer.py] => CNN top5 curve: [85.85, 83.38, 79.84]

Average Accuracy (CNN): 61.69
2024-09-07 14:10:31,185 [trainer.py] => Average Accuracy (CNN): 61.69 

2024-09-07 14:10:31,186 [trainer.py] => All params: 89792456
2024-09-07 14:10:31,187 [trainer.py] => Trainable params: 89792456
2024-09-07 14:10:32,958 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.165, Train_accy 24.62:   0%|          | 0/20 [00:06<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.165, Train_accy 24.62:   5%|▌         | 1/20 [00:06<01:56,  6.15s/it]
Task 3, Epoch 2/20 => Loss 1.293, Train_accy 62.31:   5%|▌         | 1/20 [00:12<01:56,  6.15s/it]
Task 3, Epoch 2/20 => Loss 1.293, Train_accy 62.31:  10%|█         | 2/20 [00:12<01:50,  6.15s/it]
Task 3, Epoch 3/20 => Loss 0.682, Train_accy 80.87:  10%|█         | 2/20 [00:18<01:50,  6.15s/it]
Task 3, Epoch 3/20 => Loss 0.682, Train_accy 80.87:  15%|█▌        | 3/20 [00:18<01:44,  6.15s/it]
Task 3, Epoch 4/20 => Loss 0.421, Train_accy 89.58:  15%|█▌        | 3/20 [00:24<01:44,  6.15s/it]
Task 3, Epoch 4/20 => Loss 0.421, Train_accy 89.58:  20%|██        | 4/20 [00:24<01:38,  6.15s/it]
Task 3, Epoch 5/20 => Loss 0.323, Train_accy 91.48, Test_accy 53.29:  20%|██        | 4/20 [00:38<01:38,  6.15s/it]
Task 3, Epoch 5/20 => Loss 0.323, Train_accy 91.48, Test_accy 53.29:  25%|██▌       | 5/20 [00:38<02:12,  8.83s/it]
Task 3, Epoch 6/20 => Loss 0.231, Train_accy 94.32:  25%|██▌       | 5/20 [00:44<02:12,  8.83s/it]                 
Task 3, Epoch 6/20 => Loss 0.231, Train_accy 94.32:  30%|███       | 6/20 [00:44<01:50,  7.92s/it]
Task 3, Epoch 7/20 => Loss 0.196, Train_accy 94.89:  30%|███       | 6/20 [00:50<01:50,  7.92s/it]
Task 3, Epoch 7/20 => Loss 0.196, Train_accy 94.89:  35%|███▌      | 7/20 [00:50<01:35,  7.34s/it]
Task 3, Epoch 8/20 => Loss 0.206, Train_accy 95.08:  35%|███▌      | 7/20 [00:56<01:35,  7.34s/it]
Task 3, Epoch 8/20 => Loss 0.206, Train_accy 95.08:  40%|████      | 8/20 [00:56<01:23,  6.98s/it]
Task 3, Epoch 9/20 => Loss 0.175, Train_accy 95.64:  40%|████      | 8/20 [01:02<01:23,  6.98s/it]
Task 3, Epoch 9/20 => Loss 0.175, Train_accy 95.64:  45%|████▌     | 9/20 [01:02<01:13,  6.72s/it]
Task 3, Epoch 10/20 => Loss 0.152, Train_accy 96.21, Test_accy 53.85:  45%|████▌     | 9/20 [01:16<01:13,  6.72s/it]
Task 3, Epoch 10/20 => Loss 0.152, Train_accy 96.21, Test_accy 53.85:  50%|█████     | 10/20 [01:16<01:28,  8.84s/it]
Task 3, Epoch 11/20 => Loss 0.162, Train_accy 95.27:  50%|█████     | 10/20 [01:22<01:28,  8.84s/it]                 
Task 3, Epoch 11/20 => Loss 0.162, Train_accy 95.27:  55%|█████▌    | 11/20 [01:22<01:12,  8.02s/it]
Task 3, Epoch 12/20 => Loss 0.154, Train_accy 96.97:  55%|█████▌    | 11/20 [01:28<01:12,  8.02s/it]
Task 3, Epoch 12/20 => Loss 0.154, Train_accy 96.97:  60%|██████    | 12/20 [01:28<00:59,  7.46s/it]
Task 3, Epoch 13/20 => Loss 0.126, Train_accy 97.35:  60%|██████    | 12/20 [01:34<00:59,  7.46s/it]
Task 3, Epoch 13/20 => Loss 0.126, Train_accy 97.35:  65%|██████▌   | 13/20 [01:34<00:49,  7.06s/it]
Task 3, Epoch 14/20 => Loss 0.157, Train_accy 95.08:  65%|██████▌   | 13/20 [01:41<00:49,  7.06s/it]
Task 3, Epoch 14/20 => Loss 0.157, Train_accy 95.08:  70%|███████   | 14/20 [01:41<00:40,  6.79s/it]
Task 3, Epoch 15/20 => Loss 0.124, Train_accy 96.97, Test_accy 54.17:  70%|███████   | 14/20 [01:54<00:40,  6.79s/it]
Task 3, Epoch 15/20 => Loss 0.124, Train_accy 96.97, Test_accy 54.17:  75%|███████▌  | 15/20 [01:54<00:44,  8.86s/it]
Task 3, Epoch 16/20 => Loss 0.126, Train_accy 96.21:  75%|███████▌  | 15/20 [02:00<00:44,  8.86s/it]                 
Task 3, Epoch 16/20 => Loss 0.126, Train_accy 96.21:  80%|████████  | 16/20 [02:00<00:32,  8.04s/it]
Task 3, Epoch 17/20 => Loss 0.128, Train_accy 97.35:  80%|████████  | 16/20 [02:06<00:32,  8.04s/it]
Task 3, Epoch 17/20 => Loss 0.128, Train_accy 97.35:  85%|████████▌ | 17/20 [02:06<00:22,  7.46s/it]
Task 3, Epoch 18/20 => Loss 0.121, Train_accy 97.16:  85%|████████▌ | 17/20 [02:13<00:22,  7.46s/it]
Task 3, Epoch 18/20 => Loss 0.121, Train_accy 97.16:  90%|█████████ | 18/20 [02:13<00:14,  7.05s/it]
Task 3, Epoch 19/20 => Loss 0.123, Train_accy 96.40:  90%|█████████ | 18/20 [02:19<00:14,  7.05s/it]
Task 3, Epoch 19/20 => Loss 0.123, Train_accy 96.40:  95%|█████████▌| 19/20 [02:19<00:06,  6.80s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 97.54, Test_accy 54.41:  95%|█████████▌| 19/20 [02:32<00:06,  6.80s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 97.54, Test_accy 54.41: 100%|██████████| 20/20 [02:32<00:00,  8.85s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 97.54, Test_accy 54.41: 100%|██████████| 20/20 [02:32<00:00,  7.64s/it]
2024-09-07 14:13:05,858 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.104, Train_accy 97.54, Test_accy 54.41
2024-09-07 14:13:13,325 [trainer.py] => No NME accuracy.
2024-09-07 14:13:13,325 [trainer.py] => CNN: {'total': 54.41, '00-99': 65.04, '100-119': 39.55, '120-139': 31.51, '140-159': 25.98, 'old': 57.63, 'new': 25.98}
2024-09-07 14:13:13,326 [trainer.py] => CNN top1 curve: [65.64, 62.26, 57.18, 54.41]
2024-09-07 14:13:13,326 [trainer.py] => CNN top5 curve: [85.85, 83.38, 79.84, 77.24]

Average Accuracy (CNN): 59.87
2024-09-07 14:13:13,326 [trainer.py] => Average Accuracy (CNN): 59.87 

2024-09-07 14:13:13,327 [trainer.py] => All params: 89792456
2024-09-07 14:13:13,328 [trainer.py] => Trainable params: 89792456
2024-09-07 14:13:15,620 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.745, Train_accy 12.88:   0%|          | 0/20 [00:06<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.745, Train_accy 12.88:   5%|▌         | 1/20 [00:06<01:56,  6.16s/it]
Task 4, Epoch 2/20 => Loss 1.659, Train_accy 52.08:   5%|▌         | 1/20 [00:12<01:56,  6.16s/it]
Task 4, Epoch 2/20 => Loss 1.659, Train_accy 52.08:  10%|█         | 2/20 [00:12<01:51,  6.18s/it]
Task 4, Epoch 3/20 => Loss 0.973, Train_accy 71.02:  10%|█         | 2/20 [00:18<01:51,  6.18s/it]
Task 4, Epoch 3/20 => Loss 0.973, Train_accy 71.02:  15%|█▌        | 3/20 [00:18<01:45,  6.18s/it]
Task 4, Epoch 4/20 => Loss 0.574, Train_accy 83.71:  15%|█▌        | 3/20 [00:24<01:45,  6.18s/it]
Task 4, Epoch 4/20 => Loss 0.574, Train_accy 83.71:  20%|██        | 4/20 [00:24<01:39,  6.20s/it]
Task 4, Epoch 5/20 => Loss 0.448, Train_accy 87.31, Test_accy 49.68:  20%|██        | 4/20 [00:39<01:39,  6.20s/it]
Task 4, Epoch 5/20 => Loss 0.448, Train_accy 87.31, Test_accy 49.68:  25%|██▌       | 5/20 [00:39<02:18,  9.22s/it]
Task 4, Epoch 6/20 => Loss 0.400, Train_accy 88.45:  25%|██▌       | 5/20 [00:45<02:18,  9.22s/it]                 
Task 4, Epoch 6/20 => Loss 0.400, Train_accy 88.45:  30%|███       | 6/20 [00:45<01:54,  8.18s/it]
Task 4, Epoch 7/20 => Loss 0.341, Train_accy 90.53:  30%|███       | 6/20 [00:51<01:54,  8.18s/it]
Task 4, Epoch 7/20 => Loss 0.341, Train_accy 90.53:  35%|███▌      | 7/20 [00:51<01:37,  7.53s/it]
Task 4, Epoch 8/20 => Loss 0.293, Train_accy 92.61:  35%|███▌      | 7/20 [00:57<01:37,  7.53s/it]
Task 4, Epoch 8/20 => Loss 0.293, Train_accy 92.61:  40%|████      | 8/20 [00:57<01:25,  7.09s/it]
Task 4, Epoch 9/20 => Loss 0.242, Train_accy 94.70:  40%|████      | 8/20 [01:04<01:25,  7.09s/it]
Task 4, Epoch 9/20 => Loss 0.242, Train_accy 94.70:  45%|████▌     | 9/20 [01:04<01:14,  6.80s/it]
Task 4, Epoch 10/20 => Loss 0.256, Train_accy 93.75, Test_accy 50.82:  45%|████▌     | 9/20 [01:18<01:14,  6.80s/it]
Task 4, Epoch 10/20 => Loss 0.256, Train_accy 93.75, Test_accy 50.82:  50%|█████     | 10/20 [01:18<01:31,  9.16s/it]
Task 4, Epoch 11/20 => Loss 0.206, Train_accy 94.32:  50%|█████     | 10/20 [01:24<01:31,  9.16s/it]                 
Task 4, Epoch 11/20 => Loss 0.206, Train_accy 94.32:  55%|█████▌    | 11/20 [01:24<01:14,  8.26s/it]
Task 4, Epoch 12/20 => Loss 0.232, Train_accy 93.75:  55%|█████▌    | 11/20 [01:30<01:14,  8.26s/it]
Task 4, Epoch 12/20 => Loss 0.232, Train_accy 93.75:  60%|██████    | 12/20 [01:30<01:01,  7.63s/it]
Task 4, Epoch 13/20 => Loss 0.179, Train_accy 94.70:  60%|██████    | 12/20 [01:37<01:01,  7.63s/it]
Task 4, Epoch 13/20 => Loss 0.179, Train_accy 94.70:  65%|██████▌   | 13/20 [01:37<00:50,  7.18s/it]
Task 4, Epoch 14/20 => Loss 0.176, Train_accy 95.27:  65%|██████▌   | 13/20 [01:43<00:50,  7.18s/it]
Task 4, Epoch 14/20 => Loss 0.176, Train_accy 95.27:  70%|███████   | 14/20 [01:43<00:41,  6.88s/it]
Task 4, Epoch 15/20 => Loss 0.143, Train_accy 96.59, Test_accy 51.18:  70%|███████   | 14/20 [01:57<00:41,  6.88s/it]
Task 4, Epoch 15/20 => Loss 0.143, Train_accy 96.59, Test_accy 51.18:  75%|███████▌  | 15/20 [01:57<00:45,  9.16s/it]
Task 4, Epoch 16/20 => Loss 0.176, Train_accy 95.08:  75%|███████▌  | 15/20 [02:03<00:45,  9.16s/it]                 
Task 4, Epoch 16/20 => Loss 0.176, Train_accy 95.08:  80%|████████  | 16/20 [02:03<00:33,  8.27s/it]
Task 4, Epoch 17/20 => Loss 0.233, Train_accy 94.13:  80%|████████  | 16/20 [02:09<00:33,  8.27s/it]
Task 4, Epoch 17/20 => Loss 0.233, Train_accy 94.13:  85%|████████▌ | 17/20 [02:09<00:22,  7.63s/it]
Task 4, Epoch 18/20 => Loss 0.184, Train_accy 94.70:  85%|████████▌ | 17/20 [02:16<00:22,  7.63s/it]
Task 4, Epoch 18/20 => Loss 0.184, Train_accy 94.70:  90%|█████████ | 18/20 [02:16<00:14,  7.18s/it]
Task 4, Epoch 19/20 => Loss 0.141, Train_accy 95.83:  90%|█████████ | 18/20 [02:22<00:14,  7.18s/it]
Task 4, Epoch 19/20 => Loss 0.141, Train_accy 95.83:  95%|█████████▌| 19/20 [02:22<00:06,  6.88s/it]
Task 4, Epoch 20/20 => Loss 0.164, Train_accy 96.21, Test_accy 51.11:  95%|█████████▌| 19/20 [02:36<00:06,  6.88s/it]
Task 4, Epoch 20/20 => Loss 0.164, Train_accy 96.21, Test_accy 51.11: 100%|██████████| 20/20 [02:36<00:00,  9.17s/it]
Task 4, Epoch 20/20 => Loss 0.164, Train_accy 96.21, Test_accy 51.11: 100%|██████████| 20/20 [02:36<00:00,  7.84s/it]
2024-09-07 14:15:52,433 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.164, Train_accy 96.21, Test_accy 51.11
2024-09-07 14:16:00,750 [trainer.py] => No NME accuracy.
2024-09-07 14:16:00,751 [trainer.py] => CNN: {'total': 51.11, '00-99': 65.28, '100-119': 39.55, '120-139': 30.82, '140-159': 25.98, '160-179': 22.45, 'old': 54.49, 'new': 22.45}
2024-09-07 14:16:00,751 [trainer.py] => CNN top1 curve: [65.64, 62.26, 57.18, 54.41, 51.11]
2024-09-07 14:16:00,751 [trainer.py] => CNN top5 curve: [85.85, 83.38, 79.84, 77.24, 74.12]

Average Accuracy (CNN): 58.12
2024-09-07 14:16:00,751 [trainer.py] => Average Accuracy (CNN): 58.12 

2024-09-07 14:16:00,752 [trainer.py] => All params: 89792456
2024-09-07 14:16:00,752 [trainer.py] => Trainable params: 89792456
2024-09-07 14:16:03,681 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.231, Train_accy 22.71:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.231, Train_accy 22.71:   5%|▌         | 1/20 [00:05<01:47,  5.65s/it]
Task 5, Epoch 2/20 => Loss 1.375, Train_accy 61.46:   5%|▌         | 1/20 [00:11<01:47,  5.65s/it]
Task 5, Epoch 2/20 => Loss 1.375, Train_accy 61.46:  10%|█         | 2/20 [00:11<01:41,  5.65s/it]
Task 5, Epoch 3/20 => Loss 0.753, Train_accy 76.67:  10%|█         | 2/20 [00:16<01:41,  5.65s/it]
Task 5, Epoch 3/20 => Loss 0.753, Train_accy 76.67:  15%|█▌        | 3/20 [00:16<01:36,  5.65s/it]
Task 5, Epoch 4/20 => Loss 0.451, Train_accy 87.92:  15%|█▌        | 3/20 [00:22<01:36,  5.65s/it]
Task 5, Epoch 4/20 => Loss 0.451, Train_accy 87.92:  20%|██        | 4/20 [00:22<01:30,  5.65s/it]
Task 5, Epoch 5/20 => Loss 0.379, Train_accy 90.42, Test_accy 47.93:  20%|██        | 4/20 [00:37<01:30,  5.65s/it]
Task 5, Epoch 5/20 => Loss 0.379, Train_accy 90.42, Test_accy 47.93:  25%|██▌       | 5/20 [00:37<02:13,  8.93s/it]
Task 5, Epoch 6/20 => Loss 0.256, Train_accy 93.75:  25%|██▌       | 5/20 [00:42<02:13,  8.93s/it]                 
Task 5, Epoch 6/20 => Loss 0.256, Train_accy 93.75:  30%|███       | 6/20 [00:42<01:49,  7.81s/it]
Task 5, Epoch 7/20 => Loss 0.234, Train_accy 94.58:  30%|███       | 6/20 [00:48<01:49,  7.81s/it]
Task 5, Epoch 7/20 => Loss 0.234, Train_accy 94.58:  35%|███▌      | 7/20 [00:48<01:32,  7.13s/it]
Task 5, Epoch 8/20 => Loss 0.202, Train_accy 94.79:  35%|███▌      | 7/20 [00:54<01:32,  7.13s/it]
Task 5, Epoch 8/20 => Loss 0.202, Train_accy 94.79:  40%|████      | 8/20 [00:54<01:19,  6.66s/it]
Task 5, Epoch 9/20 => Loss 0.184, Train_accy 94.58:  40%|████      | 8/20 [01:00<01:19,  6.66s/it]
Task 5, Epoch 9/20 => Loss 0.184, Train_accy 94.58:  45%|████▌     | 9/20 [01:00<01:09,  6.35s/it]
Task 5, Epoch 10/20 => Loss 0.173, Train_accy 95.62, Test_accy 48.98:  45%|████▌     | 9/20 [01:14<01:09,  6.35s/it]
Task 5, Epoch 10/20 => Loss 0.173, Train_accy 95.62, Test_accy 48.98:  50%|█████     | 10/20 [01:14<01:29,  8.91s/it]
Task 5, Epoch 11/20 => Loss 0.169, Train_accy 95.42:  50%|█████     | 10/20 [01:20<01:29,  8.91s/it]                 
Task 5, Epoch 11/20 => Loss 0.169, Train_accy 95.42:  55%|█████▌    | 11/20 [01:20<01:11,  7.91s/it]
Task 5, Epoch 12/20 => Loss 0.144, Train_accy 96.67:  55%|█████▌    | 11/20 [01:25<01:11,  7.91s/it]
Task 5, Epoch 12/20 => Loss 0.144, Train_accy 96.67:  60%|██████    | 12/20 [01:25<00:57,  7.22s/it]
Task 5, Epoch 13/20 => Loss 0.114, Train_accy 97.08:  60%|██████    | 12/20 [01:31<00:57,  7.22s/it]
Task 5, Epoch 13/20 => Loss 0.114, Train_accy 97.08:  65%|██████▌   | 13/20 [01:31<00:47,  6.74s/it]
Task 5, Epoch 14/20 => Loss 0.183, Train_accy 94.58:  65%|██████▌   | 13/20 [01:37<00:47,  6.74s/it]
Task 5, Epoch 14/20 => Loss 0.183, Train_accy 94.58:  70%|███████   | 14/20 [01:37<00:38,  6.41s/it]
Task 5, Epoch 15/20 => Loss 0.109, Train_accy 97.92, Test_accy 49.11:  70%|███████   | 14/20 [01:51<00:38,  6.41s/it]
Task 5, Epoch 15/20 => Loss 0.109, Train_accy 97.92, Test_accy 49.11:  75%|███████▌  | 15/20 [01:51<00:44,  8.92s/it]
Task 5, Epoch 16/20 => Loss 0.138, Train_accy 96.67:  75%|███████▌  | 15/20 [01:57<00:44,  8.92s/it]                 
Task 5, Epoch 16/20 => Loss 0.138, Train_accy 96.67:  80%|████████  | 16/20 [01:57<00:31,  7.94s/it]
Task 5, Epoch 17/20 => Loss 0.132, Train_accy 96.25:  80%|████████  | 16/20 [02:03<00:31,  7.94s/it]
Task 5, Epoch 17/20 => Loss 0.132, Train_accy 96.25:  85%|████████▌ | 17/20 [02:03<00:21,  7.26s/it]
Task 5, Epoch 18/20 => Loss 0.156, Train_accy 95.83:  85%|████████▌ | 17/20 [02:08<00:21,  7.26s/it]
Task 5, Epoch 18/20 => Loss 0.156, Train_accy 95.83:  90%|█████████ | 18/20 [02:08<00:13,  6.78s/it]
Task 5, Epoch 19/20 => Loss 0.121, Train_accy 97.08:  90%|█████████ | 18/20 [02:14<00:13,  6.78s/it]
Task 5, Epoch 19/20 => Loss 0.121, Train_accy 97.08:  95%|█████████▌| 19/20 [02:14<00:06,  6.43s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 97.92, Test_accy 49.05:  95%|█████████▌| 19/20 [02:29<00:06,  6.43s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 97.92, Test_accy 49.05: 100%|██████████| 20/20 [02:29<00:00,  8.89s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 97.92, Test_accy 49.05: 100%|██████████| 20/20 [02:29<00:00,  7.46s/it]
2024-09-07 14:18:32,920 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.092, Train_accy 97.92, Test_accy 49.05
2024-09-07 14:18:41,921 [trainer.py] => No NME accuracy.
2024-09-07 14:18:41,921 [trainer.py] => CNN: {'total': 49.05, '00-99': 64.57, '100-119': 39.55, '120-139': 31.51, '140-159': 26.77, '160-179': 22.45, '180-199': 29.03, 'old': 50.82, 'new': 29.03}
2024-09-07 14:18:41,922 [trainer.py] => CNN top1 curve: [65.64, 62.26, 57.18, 54.41, 51.11, 49.05]
2024-09-07 14:18:41,922 [trainer.py] => CNN top5 curve: [85.85, 83.38, 79.84, 77.24, 74.12, 73.34]

Average Accuracy (CNN): 56.61
2024-09-07 14:18:41,922 [trainer.py] => Average Accuracy (CNN): 56.61 

Accuracy Matrix (CNN):
[[65.64 65.87 65.28 65.04 65.28 64.57]
 [ 0.   39.55 38.81 39.55 39.55 39.55]
 [ 0.    0.   27.4  31.51 30.82 31.51]
 [ 0.    0.    0.   25.98 25.98 26.77]
 [ 0.    0.    0.    0.   22.45 22.45]
 [ 0.    0.    0.    0.    0.   29.03]]
2024-09-07 14:18:41,923 [trainer.py] => Forgetting (CNN): 0.2600000000000023
2024-09-07 14:18:44,672 [trainer.py] => config: ./exps/coda_prompt_ina_B100_Inc10.json
2024-09-07 14:18:44,673 [trainer.py] => prefix:  
2024-09-07 14:18:44,673 [trainer.py] => dataset: imageneta
2024-09-07 14:18:44,673 [trainer.py] => memory_size: 0
2024-09-07 14:18:44,673 [trainer.py] => memory_per_class: 0
2024-09-07 14:18:44,673 [trainer.py] => fixed_memory: False
2024-09-07 14:18:44,673 [trainer.py] => shuffle: True
2024-09-07 14:18:44,673 [trainer.py] => init_cls: 100
2024-09-07 14:18:44,673 [trainer.py] => increment: 10
2024-09-07 14:18:44,673 [trainer.py] => model_name: coda_prompt
2024-09-07 14:18:44,673 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-07 14:18:44,673 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 14:18:44,673 [trainer.py] => seed: 1993
2024-09-07 14:18:44,673 [trainer.py] => tuned_epoch: 20
2024-09-07 14:18:44,673 [trainer.py] => init_lr: 0.001
2024-09-07 14:18:44,673 [trainer.py] => batch_size: 48
2024-09-07 14:18:44,673 [trainer.py] => weight_decay: 0
2024-09-07 14:18:44,673 [trainer.py] => min_lr: 1e-05
2024-09-07 14:18:44,673 [trainer.py] => optimizer: adam
2024-09-07 14:18:44,673 [trainer.py] => scheduler: cosine
2024-09-07 14:18:44,673 [trainer.py] => reinit_optimizer: True
2024-09-07 14:18:44,673 [trainer.py] => pretrained: True
2024-09-07 14:18:44,673 [trainer.py] => drop: 0.0
2024-09-07 14:18:44,673 [trainer.py] => drop_path: 0.0
2024-09-07 14:18:44,673 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-07 14:18:44,699 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 14:18:46,669 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-07 14:18:46,670 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-07 14:18:46,670 [trainer.py] => All params: 89792456
2024-09-07 14:18:46,671 [trainer.py] => Trainable params: 89792456
2024-09-07 14:18:46,671 [coda_prompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.299, Train_accy 28.40:   0%|          | 0/20 [00:36<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.299, Train_accy 28.40:   5%|▌         | 1/20 [00:36<11:25, 36.06s/it]
Task 0, Epoch 2/20 => Loss 1.437, Train_accy 64.52:   5%|▌         | 1/20 [01:11<11:25, 36.06s/it]
Task 0, Epoch 2/20 => Loss 1.437, Train_accy 64.52:  10%|█         | 2/20 [01:11<10:46, 35.91s/it]
Task 0, Epoch 3/20 => Loss 0.861, Train_accy 77.54:  10%|█         | 2/20 [01:47<10:46, 35.91s/it]
Task 0, Epoch 3/20 => Loss 0.861, Train_accy 77.54:  15%|█▌        | 3/20 [01:47<10:09, 35.88s/it]
Task 0, Epoch 4/20 => Loss 0.674, Train_accy 82.72:  15%|█▌        | 3/20 [02:23<10:09, 35.88s/it]
Task 0, Epoch 4/20 => Loss 0.674, Train_accy 82.72:  20%|██        | 4/20 [02:23<09:33, 35.86s/it]
Task 0, Epoch 5/20 => Loss 0.579, Train_accy 83.95, Test_accy 63.14:  20%|██        | 4/20 [03:04<09:33, 35.86s/it]
Task 0, Epoch 5/20 => Loss 0.579, Train_accy 83.95, Test_accy 63.14:  25%|██▌       | 5/20 [03:04<09:25, 37.69s/it]
Task 0, Epoch 6/20 => Loss 0.464, Train_accy 87.87:  25%|██▌       | 5/20 [03:40<09:25, 37.69s/it]                 
Task 0, Epoch 6/20 => Loss 0.464, Train_accy 87.87:  30%|███       | 6/20 [03:40<08:39, 37.09s/it]
Task 0, Epoch 7/20 => Loss 0.422, Train_accy 88.79:  30%|███       | 6/20 [04:16<08:39, 37.09s/it]
Task 0, Epoch 7/20 => Loss 0.422, Train_accy 88.79:  35%|███▌      | 7/20 [04:16<07:57, 36.70s/it]
Task 0, Epoch 8/20 => Loss 0.428, Train_accy 88.63:  35%|███▌      | 7/20 [04:52<07:57, 36.70s/it]
Task 0, Epoch 8/20 => Loss 0.428, Train_accy 88.63:  40%|████      | 8/20 [04:52<07:17, 36.46s/it]
Task 0, Epoch 9/20 => Loss 0.364, Train_accy 89.58:  40%|████      | 8/20 [05:28<07:17, 36.46s/it]
Task 0, Epoch 9/20 => Loss 0.364, Train_accy 89.58:  45%|████▌     | 9/20 [05:28<06:39, 36.29s/it]
Task 0, Epoch 10/20 => Loss 0.378, Train_accy 90.13, Test_accy 64.21:  45%|████▌     | 9/20 [06:09<06:39, 36.29s/it]
Task 0, Epoch 10/20 => Loss 0.378, Train_accy 90.13, Test_accy 64.21:  50%|█████     | 10/20 [06:09<06:17, 37.75s/it]
Task 0, Epoch 11/20 => Loss 0.330, Train_accy 91.54:  50%|█████     | 10/20 [06:45<06:17, 37.75s/it]                 
Task 0, Epoch 11/20 => Loss 0.330, Train_accy 91.54:  55%|█████▌    | 11/20 [06:45<05:34, 37.18s/it]
Task 0, Epoch 12/20 => Loss 0.318, Train_accy 92.22:  55%|█████▌    | 11/20 [07:20<05:34, 37.18s/it]
Task 0, Epoch 12/20 => Loss 0.318, Train_accy 92.22:  60%|██████    | 12/20 [07:20<04:54, 36.79s/it]
Task 0, Epoch 13/20 => Loss 0.294, Train_accy 91.73:  60%|██████    | 12/20 [07:56<04:54, 36.79s/it]
Task 0, Epoch 13/20 => Loss 0.294, Train_accy 91.73:  65%|██████▌   | 13/20 [07:56<04:15, 36.51s/it]
Task 0, Epoch 14/20 => Loss 0.271, Train_accy 92.59:  65%|██████▌   | 13/20 [08:32<04:15, 36.51s/it]
Task 0, Epoch 14/20 => Loss 0.271, Train_accy 92.59:  70%|███████   | 14/20 [08:32<03:37, 36.32s/it]
Task 0, Epoch 15/20 => Loss 0.281, Train_accy 92.16, Test_accy 64.09:  70%|███████   | 14/20 [09:13<03:37, 36.32s/it]
Task 0, Epoch 15/20 => Loss 0.281, Train_accy 92.16, Test_accy 64.09:  75%|███████▌  | 15/20 [09:13<03:08, 37.75s/it]
Task 0, Epoch 16/20 => Loss 0.283, Train_accy 92.40:  75%|███████▌  | 15/20 [09:49<03:08, 37.75s/it]                 
Task 0, Epoch 16/20 => Loss 0.283, Train_accy 92.40:  80%|████████  | 16/20 [09:49<02:28, 37.19s/it]
Task 0, Epoch 17/20 => Loss 0.257, Train_accy 93.29:  80%|████████  | 16/20 [10:25<02:28, 37.19s/it]
Task 0, Epoch 17/20 => Loss 0.257, Train_accy 93.29:  85%|████████▌ | 17/20 [10:25<01:50, 36.80s/it]
Task 0, Epoch 18/20 => Loss 0.246, Train_accy 93.50:  85%|████████▌ | 17/20 [11:01<01:50, 36.80s/it]
Task 0, Epoch 18/20 => Loss 0.246, Train_accy 93.50:  90%|█████████ | 18/20 [11:01<01:13, 36.53s/it]
Task 0, Epoch 19/20 => Loss 0.239, Train_accy 93.38:  90%|█████████ | 18/20 [11:37<01:13, 36.53s/it]
Task 0, Epoch 19/20 => Loss 0.239, Train_accy 93.38:  95%|█████████▌| 19/20 [11:37<00:36, 36.35s/it]
Task 0, Epoch 20/20 => Loss 0.244, Train_accy 93.96, Test_accy 64.45:  95%|█████████▌| 19/20 [12:18<00:36, 36.35s/it]
Task 0, Epoch 20/20 => Loss 0.244, Train_accy 93.96, Test_accy 64.45: 100%|██████████| 20/20 [12:18<00:00, 37.75s/it]
Task 0, Epoch 20/20 => Loss 0.244, Train_accy 93.96, Test_accy 64.45: 100%|██████████| 20/20 [12:18<00:00, 36.92s/it]
2024-09-07 14:31:05,538 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.244, Train_accy 93.96, Test_accy 64.45
2024-09-07 14:31:10,679 [trainer.py] => No NME accuracy.
2024-09-07 14:31:10,679 [trainer.py] => CNN: {'total': 64.45, '00-99': 64.45, 'old': 0, 'new': 64.45}
2024-09-07 14:31:10,680 [trainer.py] => CNN top1 curve: [64.45]
2024-09-07 14:31:10,680 [trainer.py] => CNN top5 curve: [84.54]

Average Accuracy (CNN): 64.45
2024-09-07 14:31:10,680 [trainer.py] => Average Accuracy (CNN): 64.45 

2024-09-07 14:31:10,681 [trainer.py] => All params: 89792456
2024-09-07 14:31:10,682 [trainer.py] => Trainable params: 89792456
2024-09-07 14:31:10,931 [coda_prompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.757, Train_accy 21.67:   0%|          | 0/20 [00:02<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.757, Train_accy 21.67:   5%|▌         | 1/20 [00:02<00:56,  2.95s/it]
Task 1, Epoch 2/20 => Loss 1.207, Train_accy 62.08:   5%|▌         | 1/20 [00:05<00:56,  2.95s/it]
Task 1, Epoch 2/20 => Loss 1.207, Train_accy 62.08:  10%|█         | 2/20 [00:05<00:53,  2.98s/it]
Task 1, Epoch 3/20 => Loss 0.627, Train_accy 80.83:  10%|█         | 2/20 [00:08<00:53,  2.98s/it]
Task 1, Epoch 3/20 => Loss 0.627, Train_accy 80.83:  15%|█▌        | 3/20 [00:08<00:50,  2.99s/it]
Task 1, Epoch 4/20 => Loss 0.388, Train_accy 87.92:  15%|█▌        | 3/20 [00:11<00:50,  2.99s/it]
Task 1, Epoch 4/20 => Loss 0.388, Train_accy 87.92:  20%|██        | 4/20 [00:11<00:47,  2.99s/it]
Task 1, Epoch 5/20 => Loss 0.259, Train_accy 92.50, Test_accy 61.15:  20%|██        | 4/20 [00:20<00:47,  2.99s/it]
Task 1, Epoch 5/20 => Loss 0.259, Train_accy 92.50, Test_accy 61.15:  25%|██▌       | 5/20 [00:20<01:14,  4.97s/it]
Task 1, Epoch 6/20 => Loss 0.194, Train_accy 94.58:  25%|██▌       | 5/20 [00:23<01:14,  4.97s/it]                 
Task 1, Epoch 6/20 => Loss 0.194, Train_accy 94.58:  30%|███       | 6/20 [00:23<01:00,  4.30s/it]
Task 1, Epoch 7/20 => Loss 0.100, Train_accy 97.50:  30%|███       | 6/20 [00:26<01:00,  4.30s/it]
Task 1, Epoch 7/20 => Loss 0.100, Train_accy 97.50:  35%|███▌      | 7/20 [00:26<00:50,  3.85s/it]
Task 1, Epoch 8/20 => Loss 0.185, Train_accy 94.58:  35%|███▌      | 7/20 [00:29<00:50,  3.85s/it]
Task 1, Epoch 8/20 => Loss 0.185, Train_accy 94.58:  40%|████      | 8/20 [00:29<00:42,  3.58s/it]
Task 1, Epoch 9/20 => Loss 0.122, Train_accy 95.42:  40%|████      | 8/20 [00:32<00:42,  3.58s/it]
Task 1, Epoch 9/20 => Loss 0.122, Train_accy 95.42:  45%|████▌     | 9/20 [00:32<00:37,  3.38s/it]
Task 1, Epoch 10/20 => Loss 0.078, Train_accy 97.92, Test_accy 61.71:  45%|████▌     | 9/20 [00:40<00:37,  3.38s/it]
Task 1, Epoch 10/20 => Loss 0.078, Train_accy 97.92, Test_accy 61.71:  50%|█████     | 10/20 [00:40<00:49,  4.96s/it]
Task 1, Epoch 11/20 => Loss 0.115, Train_accy 95.83:  50%|█████     | 10/20 [00:43<00:49,  4.96s/it]                 
Task 1, Epoch 11/20 => Loss 0.115, Train_accy 95.83:  55%|█████▌    | 11/20 [00:43<00:39,  4.37s/it]
Task 1, Epoch 12/20 => Loss 0.114, Train_accy 96.25:  55%|█████▌    | 11/20 [00:46<00:39,  4.37s/it]
Task 1, Epoch 12/20 => Loss 0.114, Train_accy 96.25:  60%|██████    | 12/20 [00:46<00:31,  3.94s/it]
Task 1, Epoch 13/20 => Loss 0.067, Train_accy 97.50:  60%|██████    | 12/20 [00:49<00:31,  3.94s/it]
Task 1, Epoch 13/20 => Loss 0.067, Train_accy 97.50:  65%|██████▌   | 13/20 [00:49<00:25,  3.67s/it]
Task 1, Epoch 14/20 => Loss 0.057, Train_accy 99.17:  65%|██████▌   | 13/20 [00:52<00:25,  3.67s/it]
Task 1, Epoch 14/20 => Loss 0.057, Train_accy 99.17:  70%|███████   | 14/20 [00:52<00:20,  3.47s/it]
Task 1, Epoch 15/20 => Loss 0.099, Train_accy 96.67, Test_accy 61.60:  70%|███████   | 14/20 [01:01<00:20,  3.47s/it]
Task 1, Epoch 15/20 => Loss 0.099, Train_accy 96.67, Test_accy 61.60:  75%|███████▌  | 15/20 [01:01<00:24,  4.98s/it]
Task 1, Epoch 16/20 => Loss 0.068, Train_accy 97.50:  75%|███████▌  | 15/20 [01:04<00:24,  4.98s/it]                 
Task 1, Epoch 16/20 => Loss 0.068, Train_accy 97.50:  80%|████████  | 16/20 [01:04<00:17,  4.39s/it]
Task 1, Epoch 17/20 => Loss 0.068, Train_accy 97.50:  80%|████████  | 16/20 [01:07<00:17,  4.39s/it]
Task 1, Epoch 17/20 => Loss 0.068, Train_accy 97.50:  85%|████████▌ | 17/20 [01:07<00:11,  3.97s/it]
Task 1, Epoch 18/20 => Loss 0.042, Train_accy 98.75:  85%|████████▌ | 17/20 [01:10<00:11,  3.97s/it]
Task 1, Epoch 18/20 => Loss 0.042, Train_accy 98.75:  90%|█████████ | 18/20 [01:10<00:07,  3.68s/it]
Task 1, Epoch 19/20 => Loss 0.043, Train_accy 99.17:  90%|█████████ | 18/20 [01:13<00:07,  3.68s/it]
Task 1, Epoch 19/20 => Loss 0.043, Train_accy 99.17:  95%|█████████▌| 19/20 [01:13<00:03,  3.48s/it]
Task 1, Epoch 20/20 => Loss 0.079, Train_accy 98.33, Test_accy 61.27:  95%|█████████▌| 19/20 [01:21<00:03,  3.48s/it]
Task 1, Epoch 20/20 => Loss 0.079, Train_accy 98.33, Test_accy 61.27: 100%|██████████| 20/20 [01:21<00:00,  5.01s/it]
Task 1, Epoch 20/20 => Loss 0.079, Train_accy 98.33, Test_accy 61.27: 100%|██████████| 20/20 [01:21<00:00,  4.10s/it]
2024-09-07 14:32:32,853 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.079, Train_accy 98.33, Test_accy 61.27
2024-09-07 14:32:38,423 [trainer.py] => No NME accuracy.
2024-09-07 14:32:38,423 [trainer.py] => CNN: {'total': 61.27, '00-99': 64.09, '100-109': 21.67, 'old': 64.09, 'new': 21.67}
2024-09-07 14:32:38,423 [trainer.py] => CNN top1 curve: [64.45, 61.27]
2024-09-07 14:32:38,423 [trainer.py] => CNN top5 curve: [84.54, 82.69]

Average Accuracy (CNN): 62.86
2024-09-07 14:32:38,423 [trainer.py] => Average Accuracy (CNN): 62.86 

2024-09-07 14:32:38,425 [trainer.py] => All params: 89792456
2024-09-07 14:32:38,426 [trainer.py] => Trainable params: 89792456
2024-09-07 14:32:38,821 [coda_prompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.538, Train_accy 24.17:   0%|          | 0/20 [00:02<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.538, Train_accy 24.17:   5%|▌         | 1/20 [00:02<00:56,  2.98s/it]
Task 2, Epoch 2/20 => Loss 1.319, Train_accy 57.50:   5%|▌         | 1/20 [00:05<00:56,  2.98s/it]
Task 2, Epoch 2/20 => Loss 1.319, Train_accy 57.50:  10%|█         | 2/20 [00:05<00:53,  2.98s/it]
Task 2, Epoch 3/20 => Loss 0.621, Train_accy 77.92:  10%|█         | 2/20 [00:08<00:53,  2.98s/it]
Task 2, Epoch 3/20 => Loss 0.621, Train_accy 77.92:  15%|█▌        | 3/20 [00:08<00:50,  2.98s/it]
Task 2, Epoch 4/20 => Loss 0.472, Train_accy 85.42:  15%|█▌        | 3/20 [00:11<00:50,  2.98s/it]
Task 2, Epoch 4/20 => Loss 0.472, Train_accy 85.42:  20%|██        | 4/20 [00:11<00:47,  2.98s/it]
Task 2, Epoch 5/20 => Loss 0.284, Train_accy 90.42, Test_accy 58.46:  20%|██        | 4/20 [00:20<00:47,  2.98s/it]
Task 2, Epoch 5/20 => Loss 0.284, Train_accy 90.42, Test_accy 58.46:  25%|██▌       | 5/20 [00:20<01:16,  5.11s/it]
Task 2, Epoch 6/20 => Loss 0.223, Train_accy 92.92:  25%|██▌       | 5/20 [00:23<01:16,  5.11s/it]                 
Task 2, Epoch 6/20 => Loss 0.223, Train_accy 92.92:  30%|███       | 6/20 [00:23<01:01,  4.39s/it]
Task 2, Epoch 7/20 => Loss 0.216, Train_accy 93.33:  30%|███       | 6/20 [00:26<01:01,  4.39s/it]
Task 2, Epoch 7/20 => Loss 0.216, Train_accy 93.33:  35%|███▌      | 7/20 [00:26<00:51,  3.93s/it]
Task 2, Epoch 8/20 => Loss 0.191, Train_accy 95.00:  35%|███▌      | 7/20 [00:29<00:51,  3.93s/it]
Task 2, Epoch 8/20 => Loss 0.191, Train_accy 95.00:  40%|████      | 8/20 [00:29<00:43,  3.65s/it]
Task 2, Epoch 9/20 => Loss 0.165, Train_accy 95.83:  40%|████      | 8/20 [00:32<00:43,  3.65s/it]
Task 2, Epoch 9/20 => Loss 0.165, Train_accy 95.83:  45%|████▌     | 9/20 [00:32<00:38,  3.45s/it]
Task 2, Epoch 10/20 => Loss 0.201, Train_accy 95.00, Test_accy 58.56:  45%|████▌     | 9/20 [00:41<00:38,  3.45s/it]
Task 2, Epoch 10/20 => Loss 0.201, Train_accy 95.00, Test_accy 58.56:  50%|█████     | 10/20 [00:41<00:51,  5.14s/it]
Task 2, Epoch 11/20 => Loss 0.112, Train_accy 95.83:  50%|█████     | 10/20 [00:44<00:51,  5.14s/it]                 
Task 2, Epoch 11/20 => Loss 0.112, Train_accy 95.83:  55%|█████▌    | 11/20 [00:44<00:40,  4.49s/it]
Task 2, Epoch 12/20 => Loss 0.138, Train_accy 96.25:  55%|█████▌    | 11/20 [00:47<00:40,  4.49s/it]
Task 2, Epoch 12/20 => Loss 0.138, Train_accy 96.25:  60%|██████    | 12/20 [00:47<00:32,  4.04s/it]
Task 2, Epoch 13/20 => Loss 0.079, Train_accy 99.17:  60%|██████    | 12/20 [00:50<00:32,  4.04s/it]
Task 2, Epoch 13/20 => Loss 0.079, Train_accy 99.17:  65%|██████▌   | 13/20 [00:50<00:26,  3.73s/it]
Task 2, Epoch 14/20 => Loss 0.062, Train_accy 99.17:  65%|██████▌   | 13/20 [00:53<00:26,  3.73s/it]
Task 2, Epoch 14/20 => Loss 0.062, Train_accy 99.17:  70%|███████   | 14/20 [00:53<00:21,  3.51s/it]
Task 2, Epoch 15/20 => Loss 0.111, Train_accy 96.67, Test_accy 58.77:  70%|███████   | 14/20 [01:02<00:21,  3.51s/it]
Task 2, Epoch 15/20 => Loss 0.111, Train_accy 96.67, Test_accy 58.77:  75%|███████▌  | 15/20 [01:02<00:25,  5.15s/it]
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.92:  75%|███████▌  | 15/20 [01:05<00:25,  5.15s/it]                 
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.92:  80%|████████  | 16/20 [01:05<00:18,  4.51s/it]
Task 2, Epoch 17/20 => Loss 0.062, Train_accy 98.75:  80%|████████  | 16/20 [01:08<00:18,  4.51s/it]
Task 2, Epoch 17/20 => Loss 0.062, Train_accy 98.75:  85%|████████▌ | 17/20 [01:08<00:12,  4.05s/it]
Task 2, Epoch 18/20 => Loss 0.067, Train_accy 98.75:  85%|████████▌ | 17/20 [01:11<00:12,  4.05s/it]
Task 2, Epoch 18/20 => Loss 0.067, Train_accy 98.75:  90%|█████████ | 18/20 [01:11<00:07,  3.75s/it]
Task 2, Epoch 19/20 => Loss 0.068, Train_accy 97.50:  90%|█████████ | 18/20 [01:14<00:07,  3.75s/it]
Task 2, Epoch 19/20 => Loss 0.068, Train_accy 97.50:  95%|█████████▌| 19/20 [01:14<00:03,  3.53s/it]
Task 2, Epoch 20/20 => Loss 0.125, Train_accy 97.08, Test_accy 58.87:  95%|█████████▌| 19/20 [01:23<00:03,  3.53s/it]
Task 2, Epoch 20/20 => Loss 0.125, Train_accy 97.08, Test_accy 58.87: 100%|██████████| 20/20 [01:23<00:00,  5.17s/it]
Task 2, Epoch 20/20 => Loss 0.125, Train_accy 97.08, Test_accy 58.87: 100%|██████████| 20/20 [01:23<00:00,  4.19s/it]
2024-09-07 14:34:02,656 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.125, Train_accy 97.08, Test_accy 58.87
2024-09-07 14:34:08,583 [trainer.py] => No NME accuracy.
2024-09-07 14:34:08,584 [trainer.py] => CNN: {'total': 58.87, '00-99': 64.45, '100-109': 21.67, '110-119': 25.68, 'old': 61.6, 'new': 25.68}
2024-09-07 14:34:08,584 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87]
2024-09-07 14:34:08,584 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23]

Average Accuracy (CNN): 61.53
2024-09-07 14:34:08,584 [trainer.py] => Average Accuracy (CNN): 61.53 

2024-09-07 14:34:08,586 [trainer.py] => All params: 89792456
2024-09-07 14:34:08,587 [trainer.py] => Trainable params: 89792456
2024-09-07 14:34:09,139 [coda_prompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.271, Train_accy 15.10:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.271, Train_accy 15.10:   5%|▌         | 1/20 [00:02<00:46,  2.46s/it]
Task 3, Epoch 2/20 => Loss 2.136, Train_accy 32.29:   5%|▌         | 1/20 [00:04<00:46,  2.46s/it]
Task 3, Epoch 2/20 => Loss 2.136, Train_accy 32.29:  10%|█         | 2/20 [00:04<00:44,  2.48s/it]
Task 3, Epoch 3/20 => Loss 1.217, Train_accy 60.42:  10%|█         | 2/20 [00:07<00:44,  2.48s/it]
Task 3, Epoch 3/20 => Loss 1.217, Train_accy 60.42:  15%|█▌        | 3/20 [00:07<00:42,  2.47s/it]
Task 3, Epoch 4/20 => Loss 0.863, Train_accy 69.79:  15%|█▌        | 3/20 [00:09<00:42,  2.47s/it]
Task 3, Epoch 4/20 => Loss 0.863, Train_accy 69.79:  20%|██        | 4/20 [00:09<00:39,  2.47s/it]
Task 3, Epoch 5/20 => Loss 0.541, Train_accy 83.33, Test_accy 55.75:  20%|██        | 4/20 [00:18<00:39,  2.47s/it]
Task 3, Epoch 5/20 => Loss 0.541, Train_accy 83.33, Test_accy 55.75:  25%|██▌       | 5/20 [00:18<01:10,  4.70s/it]
Task 3, Epoch 6/20 => Loss 0.416, Train_accy 86.98:  25%|██▌       | 5/20 [00:21<01:10,  4.70s/it]                 
Task 3, Epoch 6/20 => Loss 0.416, Train_accy 86.98:  30%|███       | 6/20 [00:21<00:55,  3.95s/it]
Task 3, Epoch 7/20 => Loss 0.375, Train_accy 89.06:  30%|███       | 6/20 [00:23<00:55,  3.95s/it]
Task 3, Epoch 7/20 => Loss 0.375, Train_accy 89.06:  35%|███▌      | 7/20 [00:23<00:45,  3.47s/it]
Task 3, Epoch 8/20 => Loss 0.361, Train_accy 90.62:  35%|███▌      | 7/20 [00:25<00:45,  3.47s/it]
Task 3, Epoch 8/20 => Loss 0.361, Train_accy 90.62:  40%|████      | 8/20 [00:25<00:37,  3.15s/it]
Task 3, Epoch 9/20 => Loss 0.220, Train_accy 95.31:  40%|████      | 8/20 [00:28<00:37,  3.15s/it]
Task 3, Epoch 9/20 => Loss 0.220, Train_accy 95.31:  45%|████▌     | 9/20 [00:28<00:32,  2.94s/it]
Task 3, Epoch 10/20 => Loss 0.241, Train_accy 94.27, Test_accy 55.75:  45%|████▌     | 9/20 [00:37<00:32,  2.94s/it]
Task 3, Epoch 10/20 => Loss 0.241, Train_accy 94.27, Test_accy 55.75:  50%|█████     | 10/20 [00:37<00:47,  4.73s/it]
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 96.88:  50%|█████     | 10/20 [00:39<00:47,  4.73s/it]                 
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 96.88:  55%|█████▌    | 11/20 [00:39<00:36,  4.04s/it]
Task 3, Epoch 12/20 => Loss 0.212, Train_accy 92.19:  55%|█████▌    | 11/20 [00:42<00:36,  4.04s/it]
Task 3, Epoch 12/20 => Loss 0.212, Train_accy 92.19:  60%|██████    | 12/20 [00:42<00:28,  3.56s/it]
Task 3, Epoch 13/20 => Loss 0.228, Train_accy 92.71:  60%|██████    | 12/20 [00:44<00:28,  3.56s/it]
Task 3, Epoch 13/20 => Loss 0.228, Train_accy 92.71:  65%|██████▌   | 13/20 [00:44<00:22,  3.23s/it]
Task 3, Epoch 14/20 => Loss 0.173, Train_accy 96.88:  65%|██████▌   | 13/20 [00:47<00:22,  3.23s/it]
Task 3, Epoch 14/20 => Loss 0.173, Train_accy 96.88:  70%|███████   | 14/20 [00:47<00:18,  3.01s/it]
Task 3, Epoch 15/20 => Loss 0.167, Train_accy 95.31, Test_accy 56.04:  70%|███████   | 14/20 [00:55<00:18,  3.01s/it]
Task 3, Epoch 15/20 => Loss 0.167, Train_accy 95.31, Test_accy 56.04:  75%|███████▌  | 15/20 [00:55<00:23,  4.73s/it]
Task 3, Epoch 16/20 => Loss 0.109, Train_accy 97.40:  75%|███████▌  | 15/20 [00:58<00:23,  4.73s/it]                 
Task 3, Epoch 16/20 => Loss 0.109, Train_accy 97.40:  80%|████████  | 16/20 [00:58<00:16,  4.05s/it]
Task 3, Epoch 17/20 => Loss 0.166, Train_accy 94.79:  80%|████████  | 16/20 [01:00<00:16,  4.05s/it]
Task 3, Epoch 17/20 => Loss 0.166, Train_accy 94.79:  85%|████████▌ | 17/20 [01:00<00:10,  3.57s/it]
Task 3, Epoch 18/20 => Loss 0.116, Train_accy 97.40:  85%|████████▌ | 17/20 [01:03<00:10,  3.57s/it]
Task 3, Epoch 18/20 => Loss 0.116, Train_accy 97.40:  90%|█████████ | 18/20 [01:03<00:06,  3.24s/it]
Task 3, Epoch 19/20 => Loss 0.171, Train_accy 95.31:  90%|█████████ | 18/20 [01:05<00:06,  3.24s/it]
Task 3, Epoch 19/20 => Loss 0.171, Train_accy 95.31:  95%|█████████▌| 19/20 [01:05<00:02,  3.00s/it]
Task 3, Epoch 20/20 => Loss 0.123, Train_accy 97.92, Test_accy 56.04:  95%|█████████▌| 19/20 [01:14<00:02,  3.00s/it]
Task 3, Epoch 20/20 => Loss 0.123, Train_accy 97.92, Test_accy 56.04: 100%|██████████| 20/20 [01:14<00:00,  4.79s/it]
Task 3, Epoch 20/20 => Loss 0.123, Train_accy 97.92, Test_accy 56.04: 100%|██████████| 20/20 [01:14<00:00,  3.73s/it]
2024-09-07 14:35:23,763 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.123, Train_accy 97.92, Test_accy 56.04
2024-09-07 14:35:30,063 [trainer.py] => No NME accuracy.
2024-09-07 14:35:30,063 [trainer.py] => CNN: {'total': 56.04, '00-99': 64.09, '100-109': 23.33, '110-119': 25.68, '120-129': 13.33, 'old': 58.67, 'new': 13.33}
2024-09-07 14:35:30,064 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04]
2024-09-07 14:35:30,064 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03]

Average Accuracy (CNN): 60.16
2024-09-07 14:35:30,064 [trainer.py] => Average Accuracy (CNN): 60.16 

2024-09-07 14:35:30,065 [trainer.py] => All params: 89792456
2024-09-07 14:35:30,065 [trainer.py] => Trainable params: 89792456
2024-09-07 14:35:30,790 [coda_prompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.637, Train_accy 24.65:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.637, Train_accy 24.65:   5%|▌         | 1/20 [00:03<01:07,  3.53s/it]
Task 4, Epoch 2/20 => Loss 1.412, Train_accy 54.17:   5%|▌         | 1/20 [00:07<01:07,  3.53s/it]
Task 4, Epoch 2/20 => Loss 1.412, Train_accy 54.17:  10%|█         | 2/20 [00:07<01:03,  3.54s/it]
Task 4, Epoch 3/20 => Loss 0.733, Train_accy 75.69:  10%|█         | 2/20 [00:10<01:03,  3.54s/it]
Task 4, Epoch 3/20 => Loss 0.733, Train_accy 75.69:  15%|█▌        | 3/20 [00:10<01:00,  3.55s/it]
Task 4, Epoch 4/20 => Loss 0.437, Train_accy 86.11:  15%|█▌        | 3/20 [00:14<01:00,  3.55s/it]
Task 4, Epoch 4/20 => Loss 0.437, Train_accy 86.11:  20%|██        | 4/20 [00:14<00:57,  3.57s/it]
Task 4, Epoch 5/20 => Loss 0.334, Train_accy 89.93, Test_accy 53.08:  20%|██        | 4/20 [00:24<00:57,  3.57s/it]
Task 4, Epoch 5/20 => Loss 0.334, Train_accy 89.93, Test_accy 53.08:  25%|██▌       | 5/20 [00:24<01:29,  6.00s/it]
Task 4, Epoch 6/20 => Loss 0.291, Train_accy 90.62:  25%|██▌       | 5/20 [00:28<01:29,  6.00s/it]                 
Task 4, Epoch 6/20 => Loss 0.291, Train_accy 90.62:  30%|███       | 6/20 [00:28<01:12,  5.15s/it]
Task 4, Epoch 7/20 => Loss 0.226, Train_accy 94.10:  30%|███       | 6/20 [00:31<01:12,  5.15s/it]
Task 4, Epoch 7/20 => Loss 0.226, Train_accy 94.10:  35%|███▌      | 7/20 [00:31<01:00,  4.62s/it]
Task 4, Epoch 8/20 => Loss 0.178, Train_accy 94.44:  35%|███▌      | 7/20 [00:35<01:00,  4.62s/it]
Task 4, Epoch 8/20 => Loss 0.178, Train_accy 94.44:  40%|████      | 8/20 [00:35<00:51,  4.27s/it]
Task 4, Epoch 9/20 => Loss 0.206, Train_accy 93.75:  40%|████      | 8/20 [00:38<00:51,  4.27s/it]
Task 4, Epoch 9/20 => Loss 0.206, Train_accy 93.75:  45%|████▌     | 9/20 [00:38<00:44,  4.03s/it]
Task 4, Epoch 10/20 => Loss 0.142, Train_accy 94.79, Test_accy 53.79:  45%|████▌     | 9/20 [00:48<00:44,  4.03s/it]
Task 4, Epoch 10/20 => Loss 0.142, Train_accy 94.79, Test_accy 53.79:  50%|█████     | 10/20 [00:48<00:59,  5.99s/it]
Task 4, Epoch 11/20 => Loss 0.192, Train_accy 94.44:  50%|█████     | 10/20 [00:52<00:59,  5.99s/it]                 
Task 4, Epoch 11/20 => Loss 0.192, Train_accy 94.44:  55%|█████▌    | 11/20 [00:52<00:47,  5.25s/it]
Task 4, Epoch 12/20 => Loss 0.113, Train_accy 97.57:  55%|█████▌    | 11/20 [00:56<00:47,  5.25s/it]
Task 4, Epoch 12/20 => Loss 0.113, Train_accy 97.57:  60%|██████    | 12/20 [00:56<00:37,  4.73s/it]
Task 4, Epoch 13/20 => Loss 0.129, Train_accy 95.83:  60%|██████    | 12/20 [00:59<00:37,  4.73s/it]
Task 4, Epoch 13/20 => Loss 0.129, Train_accy 95.83:  65%|██████▌   | 13/20 [00:59<00:30,  4.37s/it]
Task 4, Epoch 14/20 => Loss 0.106, Train_accy 97.92:  65%|██████▌   | 13/20 [01:03<00:30,  4.37s/it]
Task 4, Epoch 14/20 => Loss 0.106, Train_accy 97.92:  70%|███████   | 14/20 [01:03<00:24,  4.12s/it]
Task 4, Epoch 15/20 => Loss 0.122, Train_accy 97.22, Test_accy 54.24:  70%|███████   | 14/20 [01:13<00:24,  4.12s/it]
Task 4, Epoch 15/20 => Loss 0.122, Train_accy 97.22, Test_accy 54.24:  75%|███████▌  | 15/20 [01:13<00:29,  5.98s/it]
Task 4, Epoch 16/20 => Loss 0.098, Train_accy 97.92:  75%|███████▌  | 15/20 [01:16<00:29,  5.98s/it]                 
Task 4, Epoch 16/20 => Loss 0.098, Train_accy 97.92:  80%|████████  | 16/20 [01:16<00:20,  5.24s/it]
Task 4, Epoch 17/20 => Loss 0.086, Train_accy 97.57:  80%|████████  | 16/20 [01:20<00:20,  5.24s/it]
Task 4, Epoch 17/20 => Loss 0.086, Train_accy 97.57:  85%|████████▌ | 17/20 [01:20<00:14,  4.72s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.92:  85%|████████▌ | 17/20 [01:24<00:14,  4.72s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.92:  90%|█████████ | 18/20 [01:24<00:08,  4.36s/it]
Task 4, Epoch 19/20 => Loss 0.146, Train_accy 95.49:  90%|█████████ | 18/20 [01:27<00:08,  4.36s/it]
Task 4, Epoch 19/20 => Loss 0.146, Train_accy 95.49:  95%|█████████▌| 19/20 [01:27<00:04,  4.10s/it]
Task 4, Epoch 20/20 => Loss 0.117, Train_accy 96.18, Test_accy 54.33:  95%|█████████▌| 19/20 [01:37<00:04,  4.10s/it]
Task 4, Epoch 20/20 => Loss 0.117, Train_accy 96.18, Test_accy 54.33: 100%|██████████| 20/20 [01:37<00:00,  5.94s/it]
Task 4, Epoch 20/20 => Loss 0.117, Train_accy 96.18, Test_accy 54.33: 100%|██████████| 20/20 [01:37<00:00,  4.89s/it]
2024-09-07 14:37:08,526 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.117, Train_accy 96.18, Test_accy 54.33
2024-09-07 14:37:15,303 [trainer.py] => No NME accuracy.
2024-09-07 14:37:15,304 [trainer.py] => CNN: {'total': 54.33, '00-99': 63.97, '100-109': 23.33, '110-119': 25.68, '120-129': 13.33, '130-139': 34.88, 'old': 55.94, 'new': 34.88}
2024-09-07 14:37:15,305 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04, 54.33]
2024-09-07 14:37:15,305 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03, 77.52]

Average Accuracy (CNN): 58.99
2024-09-07 14:37:15,305 [trainer.py] => Average Accuracy (CNN): 58.99 

2024-09-07 14:37:15,307 [trainer.py] => All params: 89792456
2024-09-07 14:37:15,308 [trainer.py] => Trainable params: 89792456
2024-09-07 14:37:16,182 [coda_prompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.792, Train_accy 27.08:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.792, Train_accy 27.08:   5%|▌         | 1/20 [00:03<01:06,  3.51s/it]
Task 5, Epoch 2/20 => Loss 1.406, Train_accy 55.21:   5%|▌         | 1/20 [00:07<01:06,  3.51s/it]
Task 5, Epoch 2/20 => Loss 1.406, Train_accy 55.21:  10%|█         | 2/20 [00:07<01:03,  3.52s/it]
Task 5, Epoch 3/20 => Loss 0.828, Train_accy 73.61:  10%|█         | 2/20 [00:10<01:03,  3.52s/it]
Task 5, Epoch 3/20 => Loss 0.828, Train_accy 73.61:  15%|█▌        | 3/20 [00:10<00:59,  3.52s/it]
Task 5, Epoch 4/20 => Loss 0.524, Train_accy 85.76:  15%|█▌        | 3/20 [00:14<00:59,  3.52s/it]
Task 5, Epoch 4/20 => Loss 0.524, Train_accy 85.76:  20%|██        | 4/20 [00:14<00:56,  3.51s/it]
Task 5, Epoch 5/20 => Loss 0.294, Train_accy 93.06, Test_accy 51.63:  20%|██        | 4/20 [00:24<00:56,  3.51s/it]
Task 5, Epoch 5/20 => Loss 0.294, Train_accy 93.06, Test_accy 51.63:  25%|██▌       | 5/20 [00:24<01:31,  6.11s/it]
Task 5, Epoch 6/20 => Loss 0.323, Train_accy 90.62:  25%|██▌       | 5/20 [00:28<01:31,  6.11s/it]                 
Task 5, Epoch 6/20 => Loss 0.323, Train_accy 90.62:  30%|███       | 6/20 [00:28<01:13,  5.24s/it]
Task 5, Epoch 7/20 => Loss 0.279, Train_accy 92.01:  30%|███       | 6/20 [00:31<01:13,  5.24s/it]
Task 5, Epoch 7/20 => Loss 0.279, Train_accy 92.01:  35%|███▌      | 7/20 [00:31<01:00,  4.69s/it]
Task 5, Epoch 8/20 => Loss 0.208, Train_accy 94.44:  35%|███▌      | 7/20 [00:35<01:00,  4.69s/it]
Task 5, Epoch 8/20 => Loss 0.208, Train_accy 94.44:  40%|████      | 8/20 [00:35<00:51,  4.31s/it]
Task 5, Epoch 9/20 => Loss 0.249, Train_accy 92.01:  40%|████      | 8/20 [00:38<00:51,  4.31s/it]
Task 5, Epoch 9/20 => Loss 0.249, Train_accy 92.01:  45%|████▌     | 9/20 [00:38<00:44,  4.08s/it]
Task 5, Epoch 10/20 => Loss 0.165, Train_accy 94.44, Test_accy 51.80:  45%|████▌     | 9/20 [00:49<00:44,  4.08s/it]
Task 5, Epoch 10/20 => Loss 0.165, Train_accy 94.44, Test_accy 51.80:  50%|█████     | 10/20 [00:49<01:01,  6.10s/it]
Task 5, Epoch 11/20 => Loss 0.155, Train_accy 95.14:  50%|█████     | 10/20 [00:53<01:01,  6.10s/it]                 
Task 5, Epoch 11/20 => Loss 0.155, Train_accy 95.14:  55%|█████▌    | 11/20 [00:53<00:47,  5.32s/it]
Task 5, Epoch 12/20 => Loss 0.152, Train_accy 95.49:  55%|█████▌    | 11/20 [00:56<00:47,  5.32s/it]
Task 5, Epoch 12/20 => Loss 0.152, Train_accy 95.49:  60%|██████    | 12/20 [00:56<00:38,  4.78s/it]
Task 5, Epoch 13/20 => Loss 0.187, Train_accy 93.40:  60%|██████    | 12/20 [01:00<00:38,  4.78s/it]
Task 5, Epoch 13/20 => Loss 0.187, Train_accy 93.40:  65%|██████▌   | 13/20 [01:00<00:30,  4.39s/it]
Task 5, Epoch 14/20 => Loss 0.105, Train_accy 96.88:  65%|██████▌   | 13/20 [01:03<00:30,  4.39s/it]
Task 5, Epoch 14/20 => Loss 0.105, Train_accy 96.88:  70%|███████   | 14/20 [01:03<00:24,  4.12s/it]
Task 5, Epoch 15/20 => Loss 0.184, Train_accy 94.79, Test_accy 51.88:  70%|███████   | 14/20 [01:14<00:24,  4.12s/it]
Task 5, Epoch 15/20 => Loss 0.184, Train_accy 94.79, Test_accy 51.88:  75%|███████▌  | 15/20 [01:14<00:30,  6.10s/it]
Task 5, Epoch 16/20 => Loss 0.153, Train_accy 96.18:  75%|███████▌  | 15/20 [01:17<00:30,  6.10s/it]                 
Task 5, Epoch 16/20 => Loss 0.153, Train_accy 96.18:  80%|████████  | 16/20 [01:17<00:21,  5.32s/it]
Task 5, Epoch 17/20 => Loss 0.136, Train_accy 96.18:  80%|████████  | 16/20 [01:21<00:21,  5.32s/it]
Task 5, Epoch 17/20 => Loss 0.136, Train_accy 96.18:  85%|████████▌ | 17/20 [01:21<00:14,  4.78s/it]
Task 5, Epoch 18/20 => Loss 0.102, Train_accy 97.22:  85%|████████▌ | 17/20 [01:24<00:14,  4.78s/it]
Task 5, Epoch 18/20 => Loss 0.102, Train_accy 97.22:  90%|█████████ | 18/20 [01:24<00:08,  4.39s/it]
Task 5, Epoch 19/20 => Loss 0.112, Train_accy 96.18:  90%|█████████ | 18/20 [01:28<00:08,  4.39s/it]
Task 5, Epoch 19/20 => Loss 0.112, Train_accy 96.18:  95%|█████████▌| 19/20 [01:28<00:04,  4.12s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 97.92, Test_accy 51.80:  95%|█████████▌| 19/20 [01:39<00:04,  4.12s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 97.92, Test_accy 51.80: 100%|██████████| 20/20 [01:39<00:00,  6.10s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 97.92, Test_accy 51.80: 100%|██████████| 20/20 [01:39<00:00,  4.95s/it]
2024-09-07 14:38:55,260 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.113, Train_accy 97.92, Test_accy 51.80
2024-09-07 14:39:02,424 [trainer.py] => No NME accuracy.
2024-09-07 14:39:02,424 [trainer.py] => CNN: {'total': 51.8, '00-99': 64.45, '100-109': 21.67, '110-119': 25.68, '120-129': 13.33, '130-139': 33.72, '140-149': 11.84, 'old': 54.5, 'new': 11.84}
2024-09-07 14:39:02,424 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04, 54.33, 51.8]
2024-09-07 14:39:02,424 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03, 77.52, 76.19]

Average Accuracy (CNN): 57.79
2024-09-07 14:39:02,425 [trainer.py] => Average Accuracy (CNN): 57.79 

2024-09-07 14:39:02,426 [trainer.py] => All params: 89792456
2024-09-07 14:39:02,427 [trainer.py] => Trainable params: 89792456
2024-09-07 14:39:03,461 [coda_prompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.897, Train_accy 17.19:   0%|          | 0/20 [00:02<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.897, Train_accy 17.19:   5%|▌         | 1/20 [00:02<00:46,  2.44s/it]
Task 6, Epoch 2/20 => Loss 1.767, Train_accy 44.79:   5%|▌         | 1/20 [00:04<00:46,  2.44s/it]
Task 6, Epoch 2/20 => Loss 1.767, Train_accy 44.79:  10%|█         | 2/20 [00:04<00:44,  2.47s/it]
Task 6, Epoch 3/20 => Loss 0.965, Train_accy 69.79:  10%|█         | 2/20 [00:07<00:44,  2.47s/it]
Task 6, Epoch 3/20 => Loss 0.965, Train_accy 69.79:  15%|█▌        | 3/20 [00:07<00:41,  2.46s/it]
Task 6, Epoch 4/20 => Loss 0.662, Train_accy 78.65:  15%|█▌        | 3/20 [00:09<00:41,  2.46s/it]
Task 6, Epoch 4/20 => Loss 0.662, Train_accy 78.65:  20%|██        | 4/20 [00:09<00:39,  2.46s/it]
Task 6, Epoch 5/20 => Loss 0.413, Train_accy 85.94, Test_accy 50.24:  20%|██        | 4/20 [00:19<00:39,  2.46s/it]
Task 6, Epoch 5/20 => Loss 0.413, Train_accy 85.94, Test_accy 50.24:  25%|██▌       | 5/20 [00:19<01:17,  5.16s/it]
Task 6, Epoch 6/20 => Loss 0.366, Train_accy 90.10:  25%|██▌       | 5/20 [00:22<01:17,  5.16s/it]                 
Task 6, Epoch 6/20 => Loss 0.366, Train_accy 90.10:  30%|███       | 6/20 [00:22<00:59,  4.25s/it]
Task 6, Epoch 7/20 => Loss 0.212, Train_accy 94.79:  30%|███       | 6/20 [00:24<00:59,  4.25s/it]
Task 6, Epoch 7/20 => Loss 0.212, Train_accy 94.79:  35%|███▌      | 7/20 [00:24<00:47,  3.67s/it]
Task 6, Epoch 8/20 => Loss 0.127, Train_accy 97.92:  35%|███▌      | 7/20 [00:27<00:47,  3.67s/it]
Task 6, Epoch 8/20 => Loss 0.127, Train_accy 97.92:  40%|████      | 8/20 [00:27<00:39,  3.30s/it]
Task 6, Epoch 9/20 => Loss 0.160, Train_accy 96.88:  40%|████      | 8/20 [00:29<00:39,  3.30s/it]
Task 6, Epoch 9/20 => Loss 0.160, Train_accy 96.88:  45%|████▌     | 9/20 [00:29<00:33,  3.05s/it]
Task 6, Epoch 10/20 => Loss 0.127, Train_accy 96.88, Test_accy 50.48:  45%|████▌     | 9/20 [00:39<00:33,  3.05s/it]
Task 6, Epoch 10/20 => Loss 0.127, Train_accy 96.88, Test_accy 50.48:  50%|█████     | 10/20 [00:39<00:52,  5.20s/it]
Task 6, Epoch 11/20 => Loss 0.152, Train_accy 95.83:  50%|█████     | 10/20 [00:42<00:52,  5.20s/it]                 
Task 6, Epoch 11/20 => Loss 0.152, Train_accy 95.83:  55%|█████▌    | 11/20 [00:42<00:39,  4.35s/it]
Task 6, Epoch 12/20 => Loss 0.124, Train_accy 97.40:  55%|█████▌    | 11/20 [00:44<00:39,  4.35s/it]
Task 6, Epoch 12/20 => Loss 0.124, Train_accy 97.40:  60%|██████    | 12/20 [00:44<00:30,  3.78s/it]
Task 6, Epoch 13/20 => Loss 0.082, Train_accy 98.44:  60%|██████    | 12/20 [00:47<00:30,  3.78s/it]
Task 6, Epoch 13/20 => Loss 0.082, Train_accy 98.44:  65%|██████▌   | 13/20 [00:47<00:23,  3.38s/it]
Task 6, Epoch 14/20 => Loss 0.066, Train_accy 98.44:  65%|██████▌   | 13/20 [00:49<00:23,  3.38s/it]
Task 6, Epoch 14/20 => Loss 0.066, Train_accy 98.44:  70%|███████   | 14/20 [00:49<00:18,  3.11s/it]
Task 6, Epoch 15/20 => Loss 0.133, Train_accy 96.88, Test_accy 50.56:  70%|███████   | 14/20 [00:59<00:18,  3.11s/it]
Task 6, Epoch 15/20 => Loss 0.133, Train_accy 96.88, Test_accy 50.56:  75%|███████▌  | 15/20 [00:59<00:25,  5.16s/it]
Task 6, Epoch 16/20 => Loss 0.067, Train_accy 98.44:  75%|███████▌  | 15/20 [01:01<00:25,  5.16s/it]                 
Task 6, Epoch 16/20 => Loss 0.067, Train_accy 98.44:  80%|████████  | 16/20 [01:01<00:17,  4.35s/it]
Task 6, Epoch 17/20 => Loss 0.081, Train_accy 97.92:  80%|████████  | 16/20 [01:04<00:17,  4.35s/it]
Task 6, Epoch 17/20 => Loss 0.081, Train_accy 97.92:  85%|████████▌ | 17/20 [01:04<00:11,  3.79s/it]
Task 6, Epoch 18/20 => Loss 0.116, Train_accy 97.40:  85%|████████▌ | 17/20 [01:06<00:11,  3.79s/it]
Task 6, Epoch 18/20 => Loss 0.116, Train_accy 97.40:  90%|█████████ | 18/20 [01:06<00:06,  3.38s/it]
Task 6, Epoch 19/20 => Loss 0.086, Train_accy 98.96:  90%|█████████ | 18/20 [01:09<00:06,  3.38s/it]
Task 6, Epoch 19/20 => Loss 0.086, Train_accy 98.96:  95%|█████████▌| 19/20 [01:09<00:03,  3.10s/it]
Task 6, Epoch 20/20 => Loss 0.091, Train_accy 98.96, Test_accy 50.40:  95%|█████████▌| 19/20 [01:19<00:03,  3.10s/it]
Task 6, Epoch 20/20 => Loss 0.091, Train_accy 98.96, Test_accy 50.40: 100%|██████████| 20/20 [01:19<00:00,  5.17s/it]
Task 6, Epoch 20/20 => Loss 0.091, Train_accy 98.96, Test_accy 50.40: 100%|██████████| 20/20 [01:19<00:00,  3.97s/it]
2024-09-07 14:40:22,814 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.091, Train_accy 98.96, Test_accy 50.40
2024-09-07 14:40:30,246 [trainer.py] => No NME accuracy.
2024-09-07 14:40:30,246 [trainer.py] => CNN: {'total': 50.4, '00-99': 64.21, '100-109': 21.67, '110-119': 25.68, '120-129': 13.33, '130-139': 33.72, '140-149': 11.84, '150-159': 21.57, 'old': 51.63, 'new': 21.57}
2024-09-07 14:40:30,246 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04, 54.33, 51.8, 50.4]
2024-09-07 14:40:30,246 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03, 77.52, 76.19, 74.52]

Average Accuracy (CNN): 56.74
2024-09-07 14:40:30,246 [trainer.py] => Average Accuracy (CNN): 56.74 

2024-09-07 14:40:30,248 [trainer.py] => All params: 89792456
2024-09-07 14:40:30,249 [trainer.py] => Trainable params: 89792456
2024-09-07 14:40:31,437 [coda_prompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.941, Train_accy 19.79:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.941, Train_accy 19.79:   5%|▌         | 1/20 [00:03<01:06,  3.53s/it]
Task 7, Epoch 2/20 => Loss 1.576, Train_accy 49.31:   5%|▌         | 1/20 [00:07<01:06,  3.53s/it]
Task 7, Epoch 2/20 => Loss 1.576, Train_accy 49.31:  10%|█         | 2/20 [00:07<01:03,  3.55s/it]
Task 7, Epoch 3/20 => Loss 0.940, Train_accy 67.01:  10%|█         | 2/20 [00:10<01:03,  3.55s/it]
Task 7, Epoch 3/20 => Loss 0.940, Train_accy 67.01:  15%|█▌        | 3/20 [00:10<01:00,  3.55s/it]
Task 7, Epoch 4/20 => Loss 0.597, Train_accy 80.21:  15%|█▌        | 3/20 [00:14<01:00,  3.55s/it]
Task 7, Epoch 4/20 => Loss 0.597, Train_accy 80.21:  20%|██        | 4/20 [00:14<00:56,  3.53s/it]
Task 7, Epoch 5/20 => Loss 0.481, Train_accy 84.03, Test_accy 47.71:  20%|██        | 4/20 [00:25<00:56,  3.53s/it]
Task 7, Epoch 5/20 => Loss 0.481, Train_accy 84.03, Test_accy 47.71:  25%|██▌       | 5/20 [00:25<01:36,  6.41s/it]
Task 7, Epoch 6/20 => Loss 0.406, Train_accy 89.24:  25%|██▌       | 5/20 [00:29<01:36,  6.41s/it]                 
Task 7, Epoch 6/20 => Loss 0.406, Train_accy 89.24:  30%|███       | 6/20 [00:29<01:16,  5.44s/it]
Task 7, Epoch 7/20 => Loss 0.392, Train_accy 88.54:  30%|███       | 6/20 [00:32<01:16,  5.44s/it]
Task 7, Epoch 7/20 => Loss 0.392, Train_accy 88.54:  35%|███▌      | 7/20 [00:32<01:02,  4.81s/it]
Task 7, Epoch 8/20 => Loss 0.258, Train_accy 93.40:  35%|███▌      | 7/20 [00:36<01:02,  4.81s/it]
Task 7, Epoch 8/20 => Loss 0.258, Train_accy 93.40:  40%|████      | 8/20 [00:36<00:52,  4.41s/it]
Task 7, Epoch 9/20 => Loss 0.237, Train_accy 93.75:  40%|████      | 8/20 [00:39<00:52,  4.41s/it]
Task 7, Epoch 9/20 => Loss 0.237, Train_accy 93.75:  45%|████▌     | 9/20 [00:39<00:45,  4.13s/it]
Task 7, Epoch 10/20 => Loss 0.186, Train_accy 95.49, Test_accy 48.09:  45%|████▌     | 9/20 [00:51<00:45,  4.13s/it]
Task 7, Epoch 10/20 => Loss 0.186, Train_accy 95.49, Test_accy 48.09:  50%|█████     | 10/20 [00:51<01:04,  6.45s/it]
Task 7, Epoch 11/20 => Loss 0.184, Train_accy 96.18:  50%|█████     | 10/20 [00:55<01:04,  6.45s/it]                 
Task 7, Epoch 11/20 => Loss 0.184, Train_accy 96.18:  55%|█████▌    | 11/20 [00:55<00:50,  5.58s/it]
Task 7, Epoch 12/20 => Loss 0.167, Train_accy 94.10:  55%|█████▌    | 11/20 [00:58<00:50,  5.58s/it]
Task 7, Epoch 12/20 => Loss 0.167, Train_accy 94.10:  60%|██████    | 12/20 [00:58<00:39,  4.96s/it]
Task 7, Epoch 13/20 => Loss 0.203, Train_accy 94.44:  60%|██████    | 12/20 [01:02<00:39,  4.96s/it]
Task 7, Epoch 13/20 => Loss 0.203, Train_accy 94.44:  65%|██████▌   | 13/20 [01:02<00:31,  4.56s/it]
Task 7, Epoch 14/20 => Loss 0.172, Train_accy 95.83:  65%|██████▌   | 13/20 [01:05<00:31,  4.56s/it]
Task 7, Epoch 14/20 => Loss 0.172, Train_accy 95.83:  70%|███████   | 14/20 [01:05<00:25,  4.26s/it]
Task 7, Epoch 15/20 => Loss 0.123, Train_accy 97.92, Test_accy 48.24:  70%|███████   | 14/20 [01:17<00:25,  4.26s/it]
Task 7, Epoch 15/20 => Loss 0.123, Train_accy 97.92, Test_accy 48.24:  75%|███████▌  | 15/20 [01:17<00:32,  6.45s/it]
Task 7, Epoch 16/20 => Loss 0.163, Train_accy 95.49:  75%|███████▌  | 15/20 [01:20<00:32,  6.45s/it]                 
Task 7, Epoch 16/20 => Loss 0.163, Train_accy 95.49:  80%|████████  | 16/20 [01:20<00:22,  5.58s/it]
Task 7, Epoch 17/20 => Loss 0.188, Train_accy 94.79:  80%|████████  | 16/20 [01:24<00:22,  5.58s/it]
Task 7, Epoch 17/20 => Loss 0.188, Train_accy 94.79:  85%|████████▌ | 17/20 [01:24<00:14,  4.96s/it]
Task 7, Epoch 18/20 => Loss 0.165, Train_accy 94.79:  85%|████████▌ | 17/20 [01:28<00:14,  4.96s/it]
Task 7, Epoch 18/20 => Loss 0.165, Train_accy 94.79:  90%|█████████ | 18/20 [01:28<00:09,  4.55s/it]
Task 7, Epoch 19/20 => Loss 0.150, Train_accy 94.44:  90%|█████████ | 18/20 [01:31<00:09,  4.55s/it]
Task 7, Epoch 19/20 => Loss 0.150, Train_accy 94.44:  95%|█████████▌| 19/20 [01:31<00:04,  4.25s/it]
Task 7, Epoch 20/20 => Loss 0.204, Train_accy 92.01, Test_accy 48.16:  95%|█████████▌| 19/20 [01:43<00:04,  4.25s/it]
Task 7, Epoch 20/20 => Loss 0.204, Train_accy 92.01, Test_accy 48.16: 100%|██████████| 20/20 [01:43<00:00,  6.42s/it]
Task 7, Epoch 20/20 => Loss 0.204, Train_accy 92.01, Test_accy 48.16: 100%|██████████| 20/20 [01:43<00:00,  5.15s/it]
2024-09-07 14:42:14,480 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.204, Train_accy 92.01, Test_accy 48.16
2024-09-07 14:42:22,421 [trainer.py] => No NME accuracy.
2024-09-07 14:42:22,421 [trainer.py] => CNN: {'total': 48.16, '00-99': 64.33, '100-109': 21.67, '110-119': 25.68, '120-129': 13.33, '130-139': 32.56, '140-149': 13.16, '150-159': 21.57, '160-169': 14.12, 'old': 50.48, 'new': 14.12}
2024-09-07 14:42:22,421 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04, 54.33, 51.8, 50.4, 48.16]
2024-09-07 14:42:22,421 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03, 77.52, 76.19, 74.52, 73.07]

Average Accuracy (CNN): 55.66
2024-09-07 14:42:22,422 [trainer.py] => Average Accuracy (CNN): 55.66 

2024-09-07 14:42:22,423 [trainer.py] => All params: 89792456
2024-09-07 14:42:22,424 [trainer.py] => Trainable params: 89792456
2024-09-07 14:42:23,773 [coda_prompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.166, Train_accy 14.06:   0%|          | 0/20 [00:02<?, ?it/s]
Task 8, Epoch 1/20 => Loss 3.166, Train_accy 14.06:   5%|▌         | 1/20 [00:02<00:48,  2.53s/it]
Task 8, Epoch 2/20 => Loss 2.007, Train_accy 41.67:   5%|▌         | 1/20 [00:04<00:48,  2.53s/it]
Task 8, Epoch 2/20 => Loss 2.007, Train_accy 41.67:  10%|█         | 2/20 [00:04<00:44,  2.49s/it]
Task 8, Epoch 3/20 => Loss 1.293, Train_accy 56.77:  10%|█         | 2/20 [00:07<00:44,  2.49s/it]
Task 8, Epoch 3/20 => Loss 1.293, Train_accy 56.77:  15%|█▌        | 3/20 [00:07<00:42,  2.49s/it]
Task 8, Epoch 4/20 => Loss 0.863, Train_accy 69.79:  15%|█▌        | 3/20 [00:09<00:42,  2.49s/it]
Task 8, Epoch 4/20 => Loss 0.863, Train_accy 69.79:  20%|██        | 4/20 [00:09<00:39,  2.48s/it]
Task 8, Epoch 5/20 => Loss 0.626, Train_accy 81.77, Test_accy 46.45:  20%|██        | 4/20 [00:20<00:39,  2.48s/it]
Task 8, Epoch 5/20 => Loss 0.626, Train_accy 81.77, Test_accy 46.45:  25%|██▌       | 5/20 [00:20<01:21,  5.45s/it]
Task 8, Epoch 6/20 => Loss 0.383, Train_accy 89.06:  25%|██▌       | 5/20 [00:23<01:21,  5.45s/it]                 
Task 8, Epoch 6/20 => Loss 0.383, Train_accy 89.06:  30%|███       | 6/20 [00:23<01:02,  4.45s/it]
Task 8, Epoch 7/20 => Loss 0.298, Train_accy 92.19:  30%|███       | 6/20 [00:25<01:02,  4.45s/it]
Task 8, Epoch 7/20 => Loss 0.298, Train_accy 92.19:  35%|███▌      | 7/20 [00:25<00:49,  3.81s/it]
Task 8, Epoch 8/20 => Loss 0.264, Train_accy 93.23:  35%|███▌      | 7/20 [00:28<00:49,  3.81s/it]
Task 8, Epoch 8/20 => Loss 0.264, Train_accy 93.23:  40%|████      | 8/20 [00:28<00:40,  3.39s/it]
Task 8, Epoch 9/20 => Loss 0.273, Train_accy 92.71:  40%|████      | 8/20 [00:30<00:40,  3.39s/it]
Task 8, Epoch 9/20 => Loss 0.273, Train_accy 92.71:  45%|████▌     | 9/20 [00:30<00:34,  3.11s/it]
Task 8, Epoch 10/20 => Loss 0.145, Train_accy 95.83, Test_accy 46.81:  45%|████▌     | 9/20 [00:41<00:34,  3.11s/it]
Task 8, Epoch 10/20 => Loss 0.145, Train_accy 95.83, Test_accy 46.81:  50%|█████     | 10/20 [00:41<00:54,  5.48s/it]
Task 8, Epoch 11/20 => Loss 0.195, Train_accy 95.31:  50%|█████     | 10/20 [00:43<00:54,  5.48s/it]                 
Task 8, Epoch 11/20 => Loss 0.195, Train_accy 95.31:  55%|█████▌    | 11/20 [00:43<00:41,  4.57s/it]
Task 8, Epoch 12/20 => Loss 0.187, Train_accy 95.83:  55%|█████▌    | 11/20 [00:46<00:41,  4.57s/it]
Task 8, Epoch 12/20 => Loss 0.187, Train_accy 95.83:  60%|██████    | 12/20 [00:46<00:31,  3.95s/it]
Task 8, Epoch 13/20 => Loss 0.119, Train_accy 97.40:  60%|██████    | 12/20 [00:48<00:31,  3.95s/it]
Task 8, Epoch 13/20 => Loss 0.119, Train_accy 97.40:  65%|██████▌   | 13/20 [00:48<00:24,  3.50s/it]
Task 8, Epoch 14/20 => Loss 0.162, Train_accy 95.83:  65%|██████▌   | 13/20 [00:51<00:24,  3.50s/it]
Task 8, Epoch 14/20 => Loss 0.162, Train_accy 95.83:  70%|███████   | 14/20 [00:51<00:19,  3.19s/it]
Task 8, Epoch 15/20 => Loss 0.175, Train_accy 95.83, Test_accy 46.74:  70%|███████   | 14/20 [01:02<00:19,  3.19s/it]
Task 8, Epoch 15/20 => Loss 0.175, Train_accy 95.83, Test_accy 46.74:  75%|███████▌  | 15/20 [01:02<00:27,  5.47s/it]
Task 8, Epoch 16/20 => Loss 0.097, Train_accy 98.44:  75%|███████▌  | 15/20 [01:04<00:27,  5.47s/it]                 
Task 8, Epoch 16/20 => Loss 0.097, Train_accy 98.44:  80%|████████  | 16/20 [01:04<00:18,  4.57s/it]
Task 8, Epoch 17/20 => Loss 0.140, Train_accy 95.83:  80%|████████  | 16/20 [01:07<00:18,  4.57s/it]
Task 8, Epoch 17/20 => Loss 0.140, Train_accy 95.83:  85%|████████▌ | 17/20 [01:07<00:11,  3.95s/it]
Task 8, Epoch 18/20 => Loss 0.119, Train_accy 97.40:  85%|████████▌ | 17/20 [01:09<00:11,  3.95s/it]
Task 8, Epoch 18/20 => Loss 0.119, Train_accy 97.40:  90%|█████████ | 18/20 [01:09<00:07,  3.51s/it]
Task 8, Epoch 19/20 => Loss 0.168, Train_accy 96.35:  90%|█████████ | 18/20 [01:12<00:07,  3.51s/it]
Task 8, Epoch 19/20 => Loss 0.168, Train_accy 96.35:  95%|█████████▌| 19/20 [01:12<00:03,  3.21s/it]
Task 8, Epoch 20/20 => Loss 0.118, Train_accy 98.44, Test_accy 46.59:  95%|█████████▌| 19/20 [01:22<00:03,  3.21s/it]
Task 8, Epoch 20/20 => Loss 0.118, Train_accy 98.44, Test_accy 46.59: 100%|██████████| 20/20 [01:22<00:00,  5.47s/it]
Task 8, Epoch 20/20 => Loss 0.118, Train_accy 98.44, Test_accy 46.59: 100%|██████████| 20/20 [01:22<00:00,  4.14s/it]
2024-09-07 14:43:46,672 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.118, Train_accy 98.44, Test_accy 46.59
2024-09-07 14:43:54,943 [trainer.py] => No NME accuracy.
2024-09-07 14:43:54,943 [trainer.py] => CNN: {'total': 46.59, '00-99': 64.57, '100-109': 21.67, '110-119': 25.68, '120-129': 13.33, '130-139': 32.56, '140-149': 13.16, '150-159': 21.57, '160-169': 12.94, '170-179': 11.29, 'old': 48.24, 'new': 11.29}
2024-09-07 14:43:54,943 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04, 54.33, 51.8, 50.4, 48.16, 46.59]
2024-09-07 14:43:54,943 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03, 77.52, 76.19, 74.52, 73.07, 71.61]

Average Accuracy (CNN): 54.66
2024-09-07 14:43:54,943 [trainer.py] => Average Accuracy (CNN): 54.66 

2024-09-07 14:43:54,944 [trainer.py] => All params: 89792456
2024-09-07 14:43:54,945 [trainer.py] => Trainable params: 89792456
2024-09-07 14:43:56,428 [coda_prompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.386, Train_accy 9.72:   0%|          | 0/20 [00:01<?, ?it/s]
Task 9, Epoch 1/20 => Loss 3.386, Train_accy 9.72:   5%|▌         | 1/20 [00:01<00:37,  1.96s/it]
Task 9, Epoch 2/20 => Loss 2.086, Train_accy 38.19:   5%|▌         | 1/20 [00:03<00:37,  1.96s/it]
Task 9, Epoch 2/20 => Loss 2.086, Train_accy 38.19:  10%|█         | 2/20 [00:03<00:35,  1.95s/it]
Task 9, Epoch 3/20 => Loss 1.412, Train_accy 59.72:  10%|█         | 2/20 [00:05<00:35,  1.95s/it]
Task 9, Epoch 3/20 => Loss 1.412, Train_accy 59.72:  15%|█▌        | 3/20 [00:05<00:33,  1.96s/it]
Task 9, Epoch 4/20 => Loss 1.049, Train_accy 71.53:  15%|█▌        | 3/20 [00:07<00:33,  1.96s/it]
Task 9, Epoch 4/20 => Loss 1.049, Train_accy 71.53:  20%|██        | 4/20 [00:07<00:31,  1.97s/it]
Task 9, Epoch 5/20 => Loss 0.680, Train_accy 79.86, Test_accy 45.68:  20%|██        | 4/20 [00:18<00:31,  1.97s/it]
Task 9, Epoch 5/20 => Loss 0.680, Train_accy 79.86, Test_accy 45.68:  25%|██▌       | 5/20 [00:18<01:15,  5.01s/it]
Task 9, Epoch 6/20 => Loss 0.511, Train_accy 84.03:  25%|██▌       | 5/20 [00:20<01:15,  5.01s/it]                 
Task 9, Epoch 6/20 => Loss 0.511, Train_accy 84.03:  30%|███       | 6/20 [00:20<00:55,  3.97s/it]
Task 9, Epoch 7/20 => Loss 0.366, Train_accy 90.28:  30%|███       | 6/20 [00:22<00:55,  3.97s/it]
Task 9, Epoch 7/20 => Loss 0.366, Train_accy 90.28:  35%|███▌      | 7/20 [00:22<00:43,  3.33s/it]
Task 9, Epoch 8/20 => Loss 0.235, Train_accy 93.75:  35%|███▌      | 7/20 [00:24<00:43,  3.33s/it]
Task 9, Epoch 8/20 => Loss 0.235, Train_accy 93.75:  40%|████      | 8/20 [00:24<00:34,  2.90s/it]
Task 9, Epoch 9/20 => Loss 0.238, Train_accy 93.06:  40%|████      | 8/20 [00:26<00:34,  2.90s/it]
Task 9, Epoch 9/20 => Loss 0.238, Train_accy 93.06:  45%|████▌     | 9/20 [00:26<00:28,  2.61s/it]
Task 9, Epoch 10/20 => Loss 0.176, Train_accy 96.53, Test_accy 45.68:  45%|████▌     | 9/20 [00:36<00:28,  2.61s/it]
Task 9, Epoch 10/20 => Loss 0.176, Train_accy 96.53, Test_accy 45.68:  50%|█████     | 10/20 [00:36<00:50,  5.05s/it]
Task 9, Epoch 11/20 => Loss 0.215, Train_accy 94.44:  50%|█████     | 10/20 [00:38<00:50,  5.05s/it]                 
Task 9, Epoch 11/20 => Loss 0.215, Train_accy 94.44:  55%|█████▌    | 11/20 [00:38<00:36,  4.11s/it]
Task 9, Epoch 12/20 => Loss 0.143, Train_accy 97.22:  55%|█████▌    | 11/20 [00:40<00:36,  4.11s/it]
Task 9, Epoch 12/20 => Loss 0.143, Train_accy 97.22:  60%|██████    | 12/20 [00:40<00:27,  3.46s/it]
Task 9, Epoch 13/20 => Loss 0.123, Train_accy 96.53:  60%|██████    | 12/20 [00:42<00:27,  3.46s/it]
Task 9, Epoch 13/20 => Loss 0.123, Train_accy 96.53:  65%|██████▌   | 13/20 [00:42<00:21,  3.00s/it]
Task 9, Epoch 14/20 => Loss 0.169, Train_accy 95.14:  65%|██████▌   | 13/20 [00:44<00:21,  3.00s/it]
Task 9, Epoch 14/20 => Loss 0.169, Train_accy 95.14:  70%|███████   | 14/20 [00:44<00:16,  2.69s/it]
Task 9, Epoch 15/20 => Loss 0.176, Train_accy 94.44, Test_accy 45.75:  70%|███████   | 14/20 [00:55<00:16,  2.69s/it]
Task 9, Epoch 15/20 => Loss 0.176, Train_accy 94.44, Test_accy 45.75:  75%|███████▌  | 15/20 [00:55<00:25,  5.05s/it]
Task 9, Epoch 16/20 => Loss 0.099, Train_accy 97.22:  75%|███████▌  | 15/20 [00:57<00:25,  5.05s/it]                 
Task 9, Epoch 16/20 => Loss 0.099, Train_accy 97.22:  80%|████████  | 16/20 [00:57<00:16,  4.13s/it]
Task 9, Epoch 17/20 => Loss 0.092, Train_accy 97.22:  80%|████████  | 16/20 [00:59<00:16,  4.13s/it]
Task 9, Epoch 17/20 => Loss 0.092, Train_accy 97.22:  85%|████████▌ | 17/20 [00:59<00:10,  3.48s/it]
Task 9, Epoch 18/20 => Loss 0.126, Train_accy 97.22:  85%|████████▌ | 17/20 [01:00<00:10,  3.48s/it]
Task 9, Epoch 18/20 => Loss 0.126, Train_accy 97.22:  90%|█████████ | 18/20 [01:00<00:06,  3.02s/it]
Task 9, Epoch 19/20 => Loss 0.131, Train_accy 97.92:  90%|█████████ | 18/20 [01:02<00:06,  3.02s/it]
Task 9, Epoch 19/20 => Loss 0.131, Train_accy 97.92:  95%|█████████▌| 19/20 [01:02<00:02,  2.70s/it]
Task 9, Epoch 20/20 => Loss 0.157, Train_accy 95.14, Test_accy 45.75:  95%|█████████▌| 19/20 [01:13<00:02,  2.70s/it]
Task 9, Epoch 20/20 => Loss 0.157, Train_accy 95.14, Test_accy 45.75: 100%|██████████| 20/20 [01:13<00:00,  5.04s/it]
Task 9, Epoch 20/20 => Loss 0.157, Train_accy 95.14, Test_accy 45.75: 100%|██████████| 20/20 [01:13<00:00,  3.67s/it]
2024-09-07 14:45:09,882 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.157, Train_accy 95.14, Test_accy 45.75
2024-09-07 14:45:18,406 [trainer.py] => No NME accuracy.
2024-09-07 14:45:18,407 [trainer.py] => CNN: {'total': 45.75, '00-99': 64.57, '100-109': 23.33, '110-119': 25.68, '120-129': 13.33, '130-139': 33.72, '140-149': 13.16, '150-159': 21.57, '160-169': 14.12, '170-179': 11.29, '180-189': 7.69, 'old': 46.81, 'new': 7.69}
2024-09-07 14:45:18,407 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04, 54.33, 51.8, 50.4, 48.16, 46.59, 45.75]
2024-09-07 14:45:18,407 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03, 77.52, 76.19, 74.52, 73.07, 71.61, 70.57]

Average Accuracy (CNN): 53.77
2024-09-07 14:45:18,407 [trainer.py] => Average Accuracy (CNN): 53.77 

2024-09-07 14:45:18,409 [trainer.py] => All params: 89792456
2024-09-07 14:45:18,410 [trainer.py] => Trainable params: 89792456
2024-09-07 14:45:20,154 [coda_prompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.642, Train_accy 26.79:   0%|          | 0/20 [00:04<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.642, Train_accy 26.79:   5%|▌         | 1/20 [00:04<01:17,  4.05s/it]
Task 10, Epoch 2/20 => Loss 1.202, Train_accy 61.01:   5%|▌         | 1/20 [00:08<01:17,  4.05s/it]
Task 10, Epoch 2/20 => Loss 1.202, Train_accy 61.01:  10%|█         | 2/20 [00:08<01:13,  4.07s/it]
Task 10, Epoch 3/20 => Loss 0.623, Train_accy 79.46:  10%|█         | 2/20 [00:12<01:13,  4.07s/it]
Task 10, Epoch 3/20 => Loss 0.623, Train_accy 79.46:  15%|█▌        | 3/20 [00:12<01:09,  4.09s/it]
Task 10, Epoch 4/20 => Loss 0.355, Train_accy 88.69:  15%|█▌        | 3/20 [00:16<01:09,  4.09s/it]
Task 10, Epoch 4/20 => Loss 0.355, Train_accy 88.69:  20%|██        | 4/20 [00:16<01:05,  4.09s/it]
Task 10, Epoch 5/20 => Loss 0.309, Train_accy 90.18, Test_accy 43.78:  20%|██        | 4/20 [00:29<01:05,  4.09s/it]
Task 10, Epoch 5/20 => Loss 0.309, Train_accy 90.18, Test_accy 43.78:  25%|██▌       | 5/20 [00:29<01:49,  7.33s/it]
Task 10, Epoch 6/20 => Loss 0.225, Train_accy 92.86:  25%|██▌       | 5/20 [00:33<01:49,  7.33s/it]                 
Task 10, Epoch 6/20 => Loss 0.225, Train_accy 92.86:  30%|███       | 6/20 [00:33<01:27,  6.22s/it]
Task 10, Epoch 7/20 => Loss 0.157, Train_accy 95.54:  30%|███       | 6/20 [00:37<01:27,  6.22s/it]
Task 10, Epoch 7/20 => Loss 0.157, Train_accy 95.54:  35%|███▌      | 7/20 [00:37<01:11,  5.51s/it]
Task 10, Epoch 8/20 => Loss 0.159, Train_accy 95.83:  35%|███▌      | 7/20 [00:41<01:11,  5.51s/it]
Task 10, Epoch 8/20 => Loss 0.159, Train_accy 95.83:  40%|████      | 8/20 [00:41<01:00,  5.05s/it]
Task 10, Epoch 9/20 => Loss 0.154, Train_accy 96.73:  40%|████      | 8/20 [00:45<01:00,  5.05s/it]
Task 10, Epoch 9/20 => Loss 0.154, Train_accy 96.73:  45%|████▌     | 9/20 [00:45<00:52,  4.74s/it]
Task 10, Epoch 10/20 => Loss 0.150, Train_accy 95.54, Test_accy 44.17:  45%|████▌     | 9/20 [00:58<00:52,  4.74s/it]
Task 10, Epoch 10/20 => Loss 0.150, Train_accy 95.54, Test_accy 44.17:  50%|█████     | 10/20 [00:58<01:13,  7.31s/it]
Task 10, Epoch 11/20 => Loss 0.153, Train_accy 94.64:  50%|█████     | 10/20 [01:02<01:13,  7.31s/it]                 
Task 10, Epoch 11/20 => Loss 0.153, Train_accy 94.64:  55%|█████▌    | 11/20 [01:02<00:56,  6.32s/it]
Task 10, Epoch 12/20 => Loss 0.147, Train_accy 95.54:  55%|█████▌    | 11/20 [01:06<00:56,  6.32s/it]
Task 10, Epoch 12/20 => Loss 0.147, Train_accy 95.54:  60%|██████    | 12/20 [01:06<00:45,  5.66s/it]
Task 10, Epoch 13/20 => Loss 0.067, Train_accy 99.40:  60%|██████    | 12/20 [01:11<00:45,  5.66s/it]
Task 10, Epoch 13/20 => Loss 0.067, Train_accy 99.40:  65%|██████▌   | 13/20 [01:11<00:36,  5.18s/it]
Task 10, Epoch 14/20 => Loss 0.085, Train_accy 97.32:  65%|██████▌   | 13/20 [01:15<00:36,  5.18s/it]
Task 10, Epoch 14/20 => Loss 0.085, Train_accy 97.32:  70%|███████   | 14/20 [01:15<00:29,  4.84s/it]
Task 10, Epoch 15/20 => Loss 0.089, Train_accy 97.92, Test_accy 44.44:  70%|███████   | 14/20 [01:28<00:29,  4.84s/it]
Task 10, Epoch 15/20 => Loss 0.089, Train_accy 97.92, Test_accy 44.44:  75%|███████▌  | 15/20 [01:28<00:36,  7.35s/it]
Task 10, Epoch 16/20 => Loss 0.106, Train_accy 97.62:  75%|███████▌  | 15/20 [01:32<00:36,  7.35s/it]                 
Task 10, Epoch 16/20 => Loss 0.106, Train_accy 97.62:  80%|████████  | 16/20 [01:32<00:25,  6.35s/it]
Task 10, Epoch 17/20 => Loss 0.132, Train_accy 96.43:  80%|████████  | 16/20 [01:36<00:25,  6.35s/it]
Task 10, Epoch 17/20 => Loss 0.132, Train_accy 96.43:  85%|████████▌ | 17/20 [01:36<00:16,  5.67s/it]
Task 10, Epoch 18/20 => Loss 0.094, Train_accy 96.43:  85%|████████▌ | 17/20 [01:40<00:16,  5.67s/it]
Task 10, Epoch 18/20 => Loss 0.094, Train_accy 96.43:  90%|█████████ | 18/20 [01:40<00:10,  5.19s/it]
Task 10, Epoch 19/20 => Loss 0.097, Train_accy 97.32:  90%|█████████ | 18/20 [01:44<00:10,  5.19s/it]
Task 10, Epoch 19/20 => Loss 0.097, Train_accy 97.32:  95%|█████████▌| 19/20 [01:44<00:04,  4.87s/it]
Task 10, Epoch 20/20 => Loss 0.140, Train_accy 95.83, Test_accy 44.44:  95%|█████████▌| 19/20 [01:57<00:04,  4.87s/it]
Task 10, Epoch 20/20 => Loss 0.140, Train_accy 95.83, Test_accy 44.44: 100%|██████████| 20/20 [01:57<00:00,  7.33s/it]
Task 10, Epoch 20/20 => Loss 0.140, Train_accy 95.83, Test_accy 44.44: 100%|██████████| 20/20 [01:57<00:00,  5.88s/it]
2024-09-07 14:47:17,782 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.140, Train_accy 95.83, Test_accy 44.44
2024-09-07 14:47:26,822 [trainer.py] => No NME accuracy.
2024-09-07 14:47:26,823 [trainer.py] => CNN: {'total': 44.44, '00-99': 64.45, '100-109': 23.33, '110-119': 25.68, '120-129': 13.33, '130-139': 33.72, '140-149': 13.16, '150-159': 21.57, '160-169': 12.94, '170-179': 12.9, '180-189': 10.26, '190-199': 22.35, 'old': 45.75, 'new': 22.35}
2024-09-07 14:47:26,823 [trainer.py] => CNN top1 curve: [64.45, 61.27, 58.87, 56.04, 54.33, 51.8, 50.4, 48.16, 46.59, 45.75, 44.44]
2024-09-07 14:47:26,823 [trainer.py] => CNN top5 curve: [84.54, 82.69, 81.23, 79.03, 77.52, 76.19, 74.52, 73.07, 71.61, 70.57, 69.85]

Average Accuracy (CNN): 52.92
2024-09-07 14:47:26,823 [trainer.py] => Average Accuracy (CNN): 52.92 

Accuracy Matrix (CNN):
[[64.45 64.09 64.45 64.09 63.97 64.45 64.21 64.33 64.57 64.57 64.45]
 [ 0.   21.67 21.67 23.33 23.33 21.67 21.67 21.67 21.67 23.33 23.33]
 [ 0.    0.   25.68 25.68 25.68 25.68 25.68 25.68 25.68 25.68 25.68]
 [ 0.    0.    0.   13.33 13.33 13.33 13.33 13.33 13.33 13.33 13.33]
 [ 0.    0.    0.    0.   34.88 33.72 33.72 32.56 32.56 33.72 33.72]
 [ 0.    0.    0.    0.    0.   11.84 11.84 13.16 13.16 13.16 13.16]
 [ 0.    0.    0.    0.    0.    0.   21.57 21.57 21.57 21.57 21.57]
 [ 0.    0.    0.    0.    0.    0.    0.   14.12 12.94 14.12 12.94]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   11.29 11.29 12.9 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    7.69 10.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   22.35]]
2024-09-07 14:47:26,825 [trainer.py] => Forgetting (CNN): 0.24599999999999939
2024-09-07 14:47:29,698 [trainer.py] => config: ./exps/ease_ina_B0_Inc5.json
2024-09-07 14:47:29,698 [trainer.py] => prefix:  
2024-09-07 14:47:29,699 [trainer.py] => dataset: imageneta
2024-09-07 14:47:29,699 [trainer.py] => memory_size: 0
2024-09-07 14:47:29,699 [trainer.py] => memory_per_class: 0
2024-09-07 14:47:29,699 [trainer.py] => fixed_memory: False
2024-09-07 14:47:29,699 [trainer.py] => shuffle: True
2024-09-07 14:47:29,699 [trainer.py] => init_cls: 40
2024-09-07 14:47:29,699 [trainer.py] => increment: 40
2024-09-07 14:47:29,699 [trainer.py] => model_name: ease
2024-09-07 14:47:29,699 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-07 14:47:29,699 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 14:47:29,699 [trainer.py] => seed: 1993
2024-09-07 14:47:29,699 [trainer.py] => init_epochs: 20
2024-09-07 14:47:29,699 [trainer.py] => init_lr: 0.05
2024-09-07 14:47:29,699 [trainer.py] => later_epochs: 20
2024-09-07 14:47:29,699 [trainer.py] => later_lr: 0.05
2024-09-07 14:47:29,699 [trainer.py] => batch_size: 48
2024-09-07 14:47:29,699 [trainer.py] => weight_decay: 0.005
2024-09-07 14:47:29,699 [trainer.py] => min_lr: 0
2024-09-07 14:47:29,699 [trainer.py] => optimizer: sgd
2024-09-07 14:47:29,699 [trainer.py] => scheduler: cosine
2024-09-07 14:47:29,699 [trainer.py] => pretrained: True
2024-09-07 14:47:29,699 [trainer.py] => vpt_type: Deep
2024-09-07 14:47:29,699 [trainer.py] => prompt_token_num: 5
2024-09-07 14:47:29,699 [trainer.py] => ffn_num: 16
2024-09-07 14:47:29,699 [trainer.py] => use_diagonal: False
2024-09-07 14:47:29,699 [trainer.py] => recalc_sim: True
2024-09-07 14:47:29,699 [trainer.py] => alpha: 0.1
2024-09-07 14:47:29,699 [trainer.py] => use_init_ptm: False
2024-09-07 14:47:29,699 [trainer.py] => beta: 0
2024-09-07 14:47:29,699 [trainer.py] => use_old_data: False
2024-09-07 14:47:29,699 [trainer.py] => use_reweight: True
2024-09-07 14:47:29,699 [trainer.py] => moni_adam: False
2024-09-07 14:47:29,699 [trainer.py] => adapter_num: -1
2024-09-07 14:47:29,726 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-07 14:47:32,499 [trainer.py] => All params: 86102976
2024-09-07 14:47:32,500 [trainer.py] => Trainable params: 304320
2024-09-07 14:47:32,510 [ease.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.620, Train_accy 16.38:   0%|          | 0/20 [00:09<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.620, Train_accy 16.38:   5%|▌         | 1/20 [00:09<02:56,  9.29s/it]
Task 0, Epoch 2/20 => Loss 3.092, Train_accy 46.97:   5%|▌         | 1/20 [00:18<02:56,  9.29s/it]
Task 0, Epoch 2/20 => Loss 3.092, Train_accy 46.97:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]
Task 0, Epoch 3/20 => Loss 2.234, Train_accy 61.45:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]
Task 0, Epoch 3/20 => Loss 2.234, Train_accy 61.45:  15%|█▌        | 3/20 [00:27<02:35,  9.12s/it]
Task 0, Epoch 4/20 => Loss 1.531, Train_accy 73.28:  15%|█▌        | 3/20 [00:36<02:35,  9.12s/it]
Task 0, Epoch 4/20 => Loss 1.531, Train_accy 73.28:  20%|██        | 4/20 [00:36<02:25,  9.08s/it]
Task 0, Epoch 5/20 => Loss 1.159, Train_accy 75.80:  20%|██        | 4/20 [00:45<02:25,  9.08s/it]
Task 0, Epoch 5/20 => Loss 1.159, Train_accy 75.80:  25%|██▌       | 5/20 [00:45<02:16,  9.07s/it]
Task 0, Epoch 6/20 => Loss 0.999, Train_accy 79.54:  25%|██▌       | 5/20 [00:54<02:16,  9.07s/it]
Task 0, Epoch 6/20 => Loss 0.999, Train_accy 79.54:  30%|███       | 6/20 [00:54<02:06,  9.06s/it]
Task 0, Epoch 7/20 => Loss 0.917, Train_accy 80.69:  30%|███       | 6/20 [01:03<02:06,  9.06s/it]
Task 0, Epoch 7/20 => Loss 0.917, Train_accy 80.69:  35%|███▌      | 7/20 [01:03<01:57,  9.05s/it]
Task 0, Epoch 8/20 => Loss 0.841, Train_accy 82.39:  35%|███▌      | 7/20 [01:12<01:57,  9.05s/it]
Task 0, Epoch 8/20 => Loss 0.841, Train_accy 82.39:  40%|████      | 8/20 [01:12<01:48,  9.06s/it]
Task 0, Epoch 9/20 => Loss 0.839, Train_accy 81.10:  40%|████      | 8/20 [01:21<01:48,  9.06s/it]
Task 0, Epoch 9/20 => Loss 0.839, Train_accy 81.10:  45%|████▌     | 9/20 [01:21<01:39,  9.06s/it]
Task 0, Epoch 10/20 => Loss 0.777, Train_accy 84.02:  45%|████▌     | 9/20 [01:30<01:39,  9.06s/it]
Task 0, Epoch 10/20 => Loss 0.777, Train_accy 84.02:  50%|█████     | 10/20 [01:30<01:30,  9.06s/it]
Task 0, Epoch 11/20 => Loss 0.735, Train_accy 84.77:  50%|█████     | 10/20 [01:39<01:30,  9.06s/it]
Task 0, Epoch 11/20 => Loss 0.735, Train_accy 84.77:  55%|█████▌    | 11/20 [01:39<01:21,  9.08s/it]
Task 0, Epoch 12/20 => Loss 0.773, Train_accy 83.48:  55%|█████▌    | 11/20 [01:48<01:21,  9.08s/it]
Task 0, Epoch 12/20 => Loss 0.773, Train_accy 83.48:  60%|██████    | 12/20 [01:48<01:12,  9.07s/it]
Task 0, Epoch 13/20 => Loss 0.724, Train_accy 85.32:  60%|██████    | 12/20 [01:57<01:12,  9.07s/it]
Task 0, Epoch 13/20 => Loss 0.724, Train_accy 85.32:  65%|██████▌   | 13/20 [01:57<01:03,  9.06s/it]
Task 0, Epoch 14/20 => Loss 0.697, Train_accy 85.38:  65%|██████▌   | 13/20 [02:06<01:03,  9.06s/it]
Task 0, Epoch 14/20 => Loss 0.697, Train_accy 85.38:  70%|███████   | 14/20 [02:06<00:54,  9.03s/it]
Task 0, Epoch 15/20 => Loss 0.658, Train_accy 86.88:  70%|███████   | 14/20 [02:15<00:54,  9.03s/it]
Task 0, Epoch 15/20 => Loss 0.658, Train_accy 86.88:  75%|███████▌  | 15/20 [02:15<00:45,  9.04s/it]
Task 0, Epoch 16/20 => Loss 0.650, Train_accy 87.15:  75%|███████▌  | 15/20 [02:25<00:45,  9.04s/it]
Task 0, Epoch 16/20 => Loss 0.650, Train_accy 87.15:  80%|████████  | 16/20 [02:25<00:36,  9.04s/it]
Task 0, Epoch 17/20 => Loss 0.642, Train_accy 87.22:  80%|████████  | 16/20 [02:34<00:36,  9.04s/it]
Task 0, Epoch 17/20 => Loss 0.642, Train_accy 87.22:  85%|████████▌ | 17/20 [02:34<00:27,  9.03s/it]
Task 0, Epoch 18/20 => Loss 0.648, Train_accy 86.27:  85%|████████▌ | 17/20 [02:43<00:27,  9.03s/it]
Task 0, Epoch 18/20 => Loss 0.648, Train_accy 86.27:  90%|█████████ | 18/20 [02:43<00:18,  9.03s/it]
Task 0, Epoch 19/20 => Loss 0.620, Train_accy 88.17:  90%|█████████ | 18/20 [02:52<00:18,  9.03s/it]
Task 0, Epoch 19/20 => Loss 0.620, Train_accy 88.17:  95%|█████████▌| 19/20 [02:52<00:09,  9.03s/it]
Task 0, Epoch 20/20 => Loss 0.620, Train_accy 87.42:  95%|█████████▌| 19/20 [03:01<00:09,  9.03s/it]
Task 0, Epoch 20/20 => Loss 0.620, Train_accy 87.42: 100%|██████████| 20/20 [03:01<00:00,  9.04s/it]
Task 0, Epoch 20/20 => Loss 0.620, Train_accy 87.42: 100%|██████████| 20/20 [03:01<00:00,  9.06s/it]
2024-09-07 14:50:33,734 [ease.py] => Task 0, Epoch 20/20 => Loss 0.620, Train_accy 87.42
2024-09-07 14:50:40,305 [ease.py] => Task correct: 100.0
2024-09-07 14:50:40,305 [ease.py] => Task acc: 80.0
2024-09-07 14:50:40,328 [trainer.py] => No NME accuracy.
2024-09-07 14:50:40,328 [trainer.py] => CNN: {'total': 80.0, '00-39': 80.0, 'old': 0, 'new': 80.0}
2024-09-07 14:50:40,329 [trainer.py] => CNN top1 curve: [80.0]
2024-09-07 14:50:40,329 [trainer.py] => CNN top5 curve: [95.56]

Average Accuracy (CNN): 80.0
2024-09-07 14:50:40,329 [trainer.py] => Average Accuracy (CNN): 80.0 

2024-09-07 14:50:40,330 [trainer.py] => All params: 86164418
2024-09-07 14:50:40,330 [trainer.py] => Trainable params: 304320
2024-09-07 14:50:40,332 [ease.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.623, Train_accy 19.61:   0%|          | 0/20 [00:07<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.623, Train_accy 19.61:   5%|▌         | 1/20 [00:07<02:31,  7.96s/it]
Task 1, Epoch 2/20 => Loss 3.163, Train_accy 47.26:   5%|▌         | 1/20 [00:15<02:31,  7.96s/it]
Task 1, Epoch 2/20 => Loss 3.163, Train_accy 47.26:  10%|█         | 2/20 [00:15<02:23,  7.96s/it]
Task 1, Epoch 3/20 => Loss 2.381, Train_accy 58.15:  10%|█         | 2/20 [00:23<02:23,  7.96s/it]
Task 1, Epoch 3/20 => Loss 2.381, Train_accy 58.15:  15%|█▌        | 3/20 [00:23<02:15,  8.00s/it]
Task 1, Epoch 4/20 => Loss 1.720, Train_accy 70.19:  15%|█▌        | 3/20 [00:31<02:15,  8.00s/it]
Task 1, Epoch 4/20 => Loss 1.720, Train_accy 70.19:  20%|██        | 4/20 [00:31<02:07,  7.99s/it]
Task 1, Epoch 5/20 => Loss 1.258, Train_accy 76.29:  20%|██        | 4/20 [00:39<02:07,  7.99s/it]
Task 1, Epoch 5/20 => Loss 1.258, Train_accy 76.29:  25%|██▌       | 5/20 [00:39<02:00,  8.01s/it]
Task 1, Epoch 6/20 => Loss 1.006, Train_accy 79.23:  25%|██▌       | 5/20 [00:48<02:00,  8.01s/it]
Task 1, Epoch 6/20 => Loss 1.006, Train_accy 79.23:  30%|███       | 6/20 [00:48<01:52,  8.02s/it]
Task 1, Epoch 7/20 => Loss 0.891, Train_accy 82.39:  30%|███       | 6/20 [00:56<01:52,  8.02s/it]
Task 1, Epoch 7/20 => Loss 0.891, Train_accy 82.39:  35%|███▌      | 7/20 [00:56<01:44,  8.03s/it]
Task 1, Epoch 8/20 => Loss 0.824, Train_accy 83.24:  35%|███▌      | 7/20 [01:04<01:44,  8.03s/it]
Task 1, Epoch 8/20 => Loss 0.824, Train_accy 83.24:  40%|████      | 8/20 [01:04<01:36,  8.03s/it]
Task 1, Epoch 9/20 => Loss 0.757, Train_accy 84.56:  40%|████      | 8/20 [01:12<01:36,  8.03s/it]
Task 1, Epoch 9/20 => Loss 0.757, Train_accy 84.56:  45%|████▌     | 9/20 [01:12<01:28,  8.01s/it]
Task 1, Epoch 10/20 => Loss 0.720, Train_accy 84.63:  45%|████▌     | 9/20 [01:20<01:28,  8.01s/it]
Task 1, Epoch 10/20 => Loss 0.720, Train_accy 84.63:  50%|█████     | 10/20 [01:20<01:20,  8.03s/it]
Task 1, Epoch 11/20 => Loss 0.699, Train_accy 85.10:  50%|█████     | 10/20 [01:28<01:20,  8.03s/it]
Task 1, Epoch 11/20 => Loss 0.699, Train_accy 85.10:  55%|█████▌    | 11/20 [01:28<01:12,  8.02s/it]
Task 1, Epoch 12/20 => Loss 0.639, Train_accy 86.87:  55%|█████▌    | 11/20 [01:36<01:12,  8.02s/it]
Task 1, Epoch 12/20 => Loss 0.639, Train_accy 86.87:  60%|██████    | 12/20 [01:36<01:04,  8.02s/it]
Task 1, Epoch 13/20 => Loss 0.659, Train_accy 86.87:  60%|██████    | 12/20 [01:44<01:04,  8.02s/it]
Task 1, Epoch 13/20 => Loss 0.659, Train_accy 86.87:  65%|██████▌   | 13/20 [01:44<00:56,  8.03s/it]
Task 1, Epoch 14/20 => Loss 0.658, Train_accy 86.95:  65%|██████▌   | 13/20 [01:52<00:56,  8.03s/it]
Task 1, Epoch 14/20 => Loss 0.658, Train_accy 86.95:  70%|███████   | 14/20 [01:52<00:48,  8.02s/it]
Task 1, Epoch 15/20 => Loss 0.660, Train_accy 86.10:  70%|███████   | 14/20 [02:00<00:48,  8.02s/it]
Task 1, Epoch 15/20 => Loss 0.660, Train_accy 86.10:  75%|███████▌  | 15/20 [02:00<00:40,  8.02s/it]
Task 1, Epoch 16/20 => Loss 0.614, Train_accy 87.95:  75%|███████▌  | 15/20 [02:08<00:40,  8.02s/it]
Task 1, Epoch 16/20 => Loss 0.614, Train_accy 87.95:  80%|████████  | 16/20 [02:08<00:32,  8.04s/it]
Task 1, Epoch 17/20 => Loss 0.611, Train_accy 88.19:  80%|████████  | 16/20 [02:16<00:32,  8.04s/it]
Task 1, Epoch 17/20 => Loss 0.611, Train_accy 88.19:  85%|████████▌ | 17/20 [02:16<00:24,  8.02s/it]
Task 1, Epoch 18/20 => Loss 0.614, Train_accy 88.03:  85%|████████▌ | 17/20 [02:24<00:24,  8.02s/it]
Task 1, Epoch 18/20 => Loss 0.614, Train_accy 88.03:  90%|█████████ | 18/20 [02:24<00:16,  8.02s/it]
Task 1, Epoch 19/20 => Loss 0.612, Train_accy 87.88:  90%|█████████ | 18/20 [02:32<00:16,  8.02s/it]
Task 1, Epoch 19/20 => Loss 0.612, Train_accy 87.88:  95%|█████████▌| 19/20 [02:32<00:08,  8.02s/it]
Task 1, Epoch 20/20 => Loss 0.616, Train_accy 87.26:  95%|█████████▌| 19/20 [02:40<00:08,  8.02s/it]
Task 1, Epoch 20/20 => Loss 0.616, Train_accy 87.26: 100%|██████████| 20/20 [02:40<00:00,  8.03s/it]
Task 1, Epoch 20/20 => Loss 0.616, Train_accy 87.26: 100%|██████████| 20/20 [02:40<00:00,  8.02s/it]
2024-09-07 14:53:20,725 [ease.py] => Task 1, Epoch 20/20 => Loss 0.616, Train_accy 87.26
2024-09-07 14:53:34,142 [ease.py] => Task correct: 86.24641833810888
2024-09-07 14:53:34,143 [ease.py] => Task acc: 80.65902578796562
2024-09-07 14:53:34,162 [trainer.py] => No NME accuracy.
2024-09-07 14:53:34,162 [trainer.py] => CNN: {'total': 72.92, '00-39': 68.06, '40-79': 78.11, 'old': 68.06, 'new': 78.11}
2024-09-07 14:53:34,162 [trainer.py] => CNN top1 curve: [80.0, 72.92]
2024-09-07 14:53:34,162 [trainer.py] => CNN top5 curve: [95.56, 93.27]

Average Accuracy (CNN): 76.46
2024-09-07 14:53:34,162 [trainer.py] => Average Accuracy (CNN): 76.46 

2024-09-07 14:53:34,163 [trainer.py] => All params: 86256578
2024-09-07 14:53:34,164 [trainer.py] => Trainable params: 304320
2024-09-07 14:53:34,167 [ease.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.628, Train_accy 20.06:   0%|          | 0/20 [00:06<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.628, Train_accy 20.06:   5%|▌         | 1/20 [00:06<02:03,  6.51s/it]
Task 2, Epoch 2/20 => Loss 3.255, Train_accy 42.98:   5%|▌         | 1/20 [00:13<02:03,  6.51s/it]
Task 2, Epoch 2/20 => Loss 3.255, Train_accy 42.98:  10%|█         | 2/20 [00:13<01:57,  6.51s/it]
Task 2, Epoch 3/20 => Loss 2.526, Train_accy 55.40:  10%|█         | 2/20 [00:19<01:57,  6.51s/it]
Task 2, Epoch 3/20 => Loss 2.526, Train_accy 55.40:  15%|█▌        | 3/20 [00:19<01:52,  6.60s/it]
Task 2, Epoch 4/20 => Loss 1.886, Train_accy 70.49:  15%|█▌        | 3/20 [00:26<01:52,  6.60s/it]
Task 2, Epoch 4/20 => Loss 1.886, Train_accy 70.49:  20%|██        | 4/20 [00:26<01:47,  6.70s/it]
Task 2, Epoch 5/20 => Loss 1.402, Train_accy 77.75:  20%|██        | 4/20 [00:33<01:47,  6.70s/it]
Task 2, Epoch 5/20 => Loss 1.402, Train_accy 77.75:  25%|██▌       | 5/20 [00:33<01:39,  6.66s/it]
Task 2, Epoch 6/20 => Loss 1.077, Train_accy 80.32:  25%|██▌       | 5/20 [00:39<01:39,  6.66s/it]
Task 2, Epoch 6/20 => Loss 1.077, Train_accy 80.32:  30%|███       | 6/20 [00:39<01:32,  6.63s/it]
Task 2, Epoch 7/20 => Loss 0.934, Train_accy 83.00:  30%|███       | 6/20 [00:46<01:32,  6.63s/it]
Task 2, Epoch 7/20 => Loss 0.934, Train_accy 83.00:  35%|███▌      | 7/20 [00:46<01:25,  6.61s/it]
Task 2, Epoch 8/20 => Loss 0.843, Train_accy 84.72:  35%|███▌      | 7/20 [00:52<01:25,  6.61s/it]
Task 2, Epoch 8/20 => Loss 0.843, Train_accy 84.72:  40%|████      | 8/20 [00:52<01:19,  6.60s/it]
Task 2, Epoch 9/20 => Loss 0.736, Train_accy 85.58:  40%|████      | 8/20 [00:59<01:19,  6.60s/it]
Task 2, Epoch 9/20 => Loss 0.736, Train_accy 85.58:  45%|████▌     | 9/20 [00:59<01:12,  6.59s/it]
Task 2, Epoch 10/20 => Loss 0.746, Train_accy 85.86:  45%|████▌     | 9/20 [01:06<01:12,  6.59s/it]
Task 2, Epoch 10/20 => Loss 0.746, Train_accy 85.86:  50%|█████     | 10/20 [01:06<01:05,  6.59s/it]
Task 2, Epoch 11/20 => Loss 0.691, Train_accy 86.82:  50%|█████     | 10/20 [01:12<01:05,  6.59s/it]
Task 2, Epoch 11/20 => Loss 0.691, Train_accy 86.82:  55%|█████▌    | 11/20 [01:12<00:59,  6.58s/it]
Task 2, Epoch 12/20 => Loss 0.689, Train_accy 87.11:  55%|█████▌    | 11/20 [01:19<00:59,  6.58s/it]
Task 2, Epoch 12/20 => Loss 0.689, Train_accy 87.11:  60%|██████    | 12/20 [01:19<00:52,  6.57s/it]
Task 2, Epoch 13/20 => Loss 0.597, Train_accy 89.59:  60%|██████    | 12/20 [01:25<00:52,  6.57s/it]
Task 2, Epoch 13/20 => Loss 0.597, Train_accy 89.59:  65%|██████▌   | 13/20 [01:25<00:45,  6.57s/it]
Task 2, Epoch 14/20 => Loss 0.634, Train_accy 88.83:  65%|██████▌   | 13/20 [01:32<00:45,  6.57s/it]
Task 2, Epoch 14/20 => Loss 0.634, Train_accy 88.83:  70%|███████   | 14/20 [01:32<00:39,  6.56s/it]
Task 2, Epoch 15/20 => Loss 0.589, Train_accy 88.54:  70%|███████   | 14/20 [01:38<00:39,  6.56s/it]
Task 2, Epoch 15/20 => Loss 0.589, Train_accy 88.54:  75%|███████▌  | 15/20 [01:38<00:32,  6.57s/it]
Task 2, Epoch 16/20 => Loss 0.579, Train_accy 89.88:  75%|███████▌  | 15/20 [01:45<00:32,  6.57s/it]
Task 2, Epoch 16/20 => Loss 0.579, Train_accy 89.88:  80%|████████  | 16/20 [01:45<00:26,  6.57s/it]
Task 2, Epoch 17/20 => Loss 0.606, Train_accy 87.77:  80%|████████  | 16/20 [01:51<00:26,  6.57s/it]
Task 2, Epoch 17/20 => Loss 0.606, Train_accy 87.77:  85%|████████▌ | 17/20 [01:51<00:19,  6.57s/it]
Task 2, Epoch 18/20 => Loss 0.605, Train_accy 88.35:  85%|████████▌ | 17/20 [01:58<00:19,  6.57s/it]
Task 2, Epoch 18/20 => Loss 0.605, Train_accy 88.35:  90%|█████████ | 18/20 [01:58<00:13,  6.57s/it]
Task 2, Epoch 19/20 => Loss 0.555, Train_accy 89.97:  90%|█████████ | 18/20 [02:05<00:13,  6.57s/it]
Task 2, Epoch 19/20 => Loss 0.555, Train_accy 89.97:  95%|█████████▌| 19/20 [02:05<00:06,  6.56s/it]
Task 2, Epoch 20/20 => Loss 0.587, Train_accy 89.30:  95%|█████████▌| 19/20 [02:11<00:06,  6.56s/it]
Task 2, Epoch 20/20 => Loss 0.587, Train_accy 89.30: 100%|██████████| 20/20 [02:11<00:00,  6.55s/it]
Task 2, Epoch 20/20 => Loss 0.587, Train_accy 89.30: 100%|██████████| 20/20 [02:11<00:00,  6.58s/it]
2024-09-07 14:55:45,790 [ease.py] => Task 2, Epoch 20/20 => Loss 0.587, Train_accy 89.30
2024-09-07 14:56:05,938 [ease.py] => Task correct: 76.82051282051282
2024-09-07 14:56:05,939 [ease.py] => Task acc: 79.6923076923077
2024-09-07 14:56:05,966 [trainer.py] => No NME accuracy.
2024-09-07 14:56:05,966 [trainer.py] => CNN: {'total': 67.38, '00-39': 63.06, '40-79': 71.01, '80-119': 68.59, 'old': 66.91, 'new': 68.59}
2024-09-07 14:56:05,966 [trainer.py] => CNN top1 curve: [80.0, 72.92, 67.38]
2024-09-07 14:56:05,966 [trainer.py] => CNN top5 curve: [95.56, 93.27, 88.41]

Average Accuracy (CNN): 73.43
2024-09-07 14:56:05,966 [trainer.py] => Average Accuracy (CNN): 73.43 

2024-09-07 14:56:05,967 [trainer.py] => All params: 86410178
2024-09-07 14:56:05,968 [trainer.py] => Trainable params: 304320
2024-09-07 14:56:05,974 [ease.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.648, Train_accy 12.99:   0%|          | 0/20 [00:06<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.648, Train_accy 12.99:   5%|▌         | 1/20 [00:06<02:08,  6.74s/it]
Task 3, Epoch 2/20 => Loss 3.402, Train_accy 36.54:   5%|▌         | 1/20 [00:13<02:08,  6.74s/it]
Task 3, Epoch 2/20 => Loss 3.402, Train_accy 36.54:  10%|█         | 2/20 [00:13<02:00,  6.70s/it]
Task 3, Epoch 3/20 => Loss 2.837, Train_accy 50.47:  10%|█         | 2/20 [00:20<02:00,  6.70s/it]
Task 3, Epoch 3/20 => Loss 2.837, Train_accy 50.47:  15%|█▌        | 3/20 [00:20<01:53,  6.68s/it]
Task 3, Epoch 4/20 => Loss 2.200, Train_accy 65.79:  15%|█▌        | 3/20 [00:26<01:53,  6.68s/it]
Task 3, Epoch 4/20 => Loss 2.200, Train_accy 65.79:  20%|██        | 4/20 [00:26<01:46,  6.68s/it]
Task 3, Epoch 5/20 => Loss 1.650, Train_accy 75.61:  20%|██        | 4/20 [00:33<01:46,  6.68s/it]
Task 3, Epoch 5/20 => Loss 1.650, Train_accy 75.61:  25%|██▌       | 5/20 [00:33<01:39,  6.66s/it]
Task 3, Epoch 6/20 => Loss 1.366, Train_accy 77.01:  25%|██▌       | 5/20 [00:40<01:39,  6.66s/it]
Task 3, Epoch 6/20 => Loss 1.366, Train_accy 77.01:  30%|███       | 6/20 [00:40<01:33,  6.67s/it]
Task 3, Epoch 7/20 => Loss 1.125, Train_accy 80.19:  30%|███       | 6/20 [00:46<01:33,  6.67s/it]
Task 3, Epoch 7/20 => Loss 1.125, Train_accy 80.19:  35%|███▌      | 7/20 [00:46<01:26,  6.68s/it]
Task 3, Epoch 8/20 => Loss 0.972, Train_accy 82.99:  35%|███▌      | 7/20 [00:53<01:26,  6.68s/it]
Task 3, Epoch 8/20 => Loss 0.972, Train_accy 82.99:  40%|████      | 8/20 [00:53<01:20,  6.68s/it]
Task 3, Epoch 9/20 => Loss 0.894, Train_accy 85.14:  40%|████      | 8/20 [01:00<01:20,  6.68s/it]
Task 3, Epoch 9/20 => Loss 0.894, Train_accy 85.14:  45%|████▌     | 9/20 [01:00<01:13,  6.68s/it]
Task 3, Epoch 10/20 => Loss 0.867, Train_accy 84.39:  45%|████▌     | 9/20 [01:06<01:13,  6.68s/it]
Task 3, Epoch 10/20 => Loss 0.867, Train_accy 84.39:  50%|█████     | 10/20 [01:06<01:06,  6.68s/it]
Task 3, Epoch 11/20 => Loss 0.841, Train_accy 84.21:  50%|█████     | 10/20 [01:13<01:06,  6.68s/it]
Task 3, Epoch 11/20 => Loss 0.841, Train_accy 84.21:  55%|█████▌    | 11/20 [01:13<01:00,  6.69s/it]
Task 3, Epoch 12/20 => Loss 0.791, Train_accy 84.39:  55%|█████▌    | 11/20 [01:20<01:00,  6.69s/it]
Task 3, Epoch 12/20 => Loss 0.791, Train_accy 84.39:  60%|██████    | 12/20 [01:20<00:53,  6.68s/it]
Task 3, Epoch 13/20 => Loss 0.742, Train_accy 87.38:  60%|██████    | 12/20 [01:26<00:53,  6.68s/it]
Task 3, Epoch 13/20 => Loss 0.742, Train_accy 87.38:  65%|██████▌   | 13/20 [01:26<00:46,  6.68s/it]
Task 3, Epoch 14/20 => Loss 0.716, Train_accy 87.01:  65%|██████▌   | 13/20 [01:33<00:46,  6.68s/it]
Task 3, Epoch 14/20 => Loss 0.716, Train_accy 87.01:  70%|███████   | 14/20 [01:33<00:40,  6.69s/it]
Task 3, Epoch 15/20 => Loss 0.682, Train_accy 87.29:  70%|███████   | 14/20 [01:40<00:40,  6.69s/it]
Task 3, Epoch 15/20 => Loss 0.682, Train_accy 87.29:  75%|███████▌  | 15/20 [01:40<00:33,  6.69s/it]
Task 3, Epoch 16/20 => Loss 0.695, Train_accy 88.13:  75%|███████▌  | 15/20 [01:46<00:33,  6.69s/it]
Task 3, Epoch 16/20 => Loss 0.695, Train_accy 88.13:  80%|████████  | 16/20 [01:46<00:26,  6.69s/it]
Task 3, Epoch 17/20 => Loss 0.702, Train_accy 87.85:  80%|████████  | 16/20 [01:53<00:26,  6.69s/it]
Task 3, Epoch 17/20 => Loss 0.702, Train_accy 87.85:  85%|████████▌ | 17/20 [01:53<00:20,  6.68s/it]
Task 3, Epoch 18/20 => Loss 0.706, Train_accy 87.66:  85%|████████▌ | 17/20 [02:00<00:20,  6.68s/it]
Task 3, Epoch 18/20 => Loss 0.706, Train_accy 87.66:  90%|█████████ | 18/20 [02:00<00:13,  6.69s/it]
Task 3, Epoch 19/20 => Loss 0.657, Train_accy 88.88:  90%|█████████ | 18/20 [02:06<00:13,  6.69s/it]
Task 3, Epoch 19/20 => Loss 0.657, Train_accy 88.88:  95%|█████████▌| 19/20 [02:06<00:06,  6.69s/it]
Task 3, Epoch 20/20 => Loss 0.686, Train_accy 87.66:  95%|█████████▌| 19/20 [02:13<00:06,  6.69s/it]
Task 3, Epoch 20/20 => Loss 0.686, Train_accy 87.66: 100%|██████████| 20/20 [02:13<00:00,  6.69s/it]
Task 3, Epoch 20/20 => Loss 0.686, Train_accy 87.66: 100%|██████████| 20/20 [02:13<00:00,  6.68s/it]
2024-09-07 14:58:19,665 [ease.py] => Task 3, Epoch 20/20 => Loss 0.686, Train_accy 87.66
2024-09-07 14:58:49,869 [ease.py] => Task correct: 69.23076923076923
2024-09-07 14:58:49,869 [ease.py] => Task acc: 78.2051282051282
2024-09-07 14:58:49,892 [trainer.py] => No NME accuracy.
2024-09-07 14:58:49,892 [trainer.py] => CNN: {'total': 60.98, '00-39': 57.22, '40-79': 63.61, '80-119': 67.51, '120-159': 56.04, 'old': 62.36, 'new': 56.04}
2024-09-07 14:58:49,892 [trainer.py] => CNN top1 curve: [80.0, 72.92, 67.38, 60.98]
2024-09-07 14:58:49,892 [trainer.py] => CNN top5 curve: [95.56, 93.27, 88.41, 84.62]

Average Accuracy (CNN): 70.32
2024-09-07 14:58:49,892 [trainer.py] => Average Accuracy (CNN): 70.32 

2024-09-07 14:58:49,893 [trainer.py] => All params: 86625218
2024-09-07 14:58:49,894 [trainer.py] => Trainable params: 304320
2024-09-07 14:58:49,901 [ease.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.650, Train_accy 13.30:   0%|          | 0/20 [00:06<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.650, Train_accy 13.30:   5%|▌         | 1/20 [00:06<02:10,  6.85s/it]
Task 4, Epoch 2/20 => Loss 3.403, Train_accy 31.97:   5%|▌         | 1/20 [00:13<02:10,  6.85s/it]
Task 4, Epoch 2/20 => Loss 3.403, Train_accy 31.97:  10%|█         | 2/20 [00:13<02:03,  6.84s/it]
Task 4, Epoch 3/20 => Loss 2.846, Train_accy 46.45:  10%|█         | 2/20 [00:20<02:03,  6.84s/it]
Task 4, Epoch 3/20 => Loss 2.846, Train_accy 46.45:  15%|█▌        | 3/20 [00:20<01:56,  6.85s/it]
Task 4, Epoch 4/20 => Loss 2.250, Train_accy 59.93:  15%|█▌        | 3/20 [00:27<01:56,  6.85s/it]
Task 4, Epoch 4/20 => Loss 2.250, Train_accy 59.93:  20%|██        | 4/20 [00:27<01:49,  6.85s/it]
Task 4, Epoch 5/20 => Loss 1.764, Train_accy 68.21:  20%|██        | 4/20 [00:34<01:49,  6.85s/it]
Task 4, Epoch 5/20 => Loss 1.764, Train_accy 68.21:  25%|██▌       | 5/20 [00:34<01:42,  6.85s/it]
Task 4, Epoch 6/20 => Loss 1.421, Train_accy 73.50:  25%|██▌       | 5/20 [00:41<01:42,  6.85s/it]
Task 4, Epoch 6/20 => Loss 1.421, Train_accy 73.50:  30%|███       | 6/20 [00:41<01:35,  6.83s/it]
Task 4, Epoch 7/20 => Loss 1.197, Train_accy 77.69:  30%|███       | 6/20 [00:47<01:35,  6.83s/it]
Task 4, Epoch 7/20 => Loss 1.197, Train_accy 77.69:  35%|███▌      | 7/20 [00:47<01:29,  6.85s/it]
Task 4, Epoch 8/20 => Loss 1.087, Train_accy 79.78:  35%|███▌      | 7/20 [00:54<01:29,  6.85s/it]
Task 4, Epoch 8/20 => Loss 1.087, Train_accy 79.78:  40%|████      | 8/20 [00:54<01:22,  6.84s/it]
Task 4, Epoch 9/20 => Loss 0.965, Train_accy 83.42:  40%|████      | 8/20 [01:01<01:22,  6.84s/it]
Task 4, Epoch 9/20 => Loss 0.965, Train_accy 83.42:  45%|████▌     | 9/20 [01:01<01:15,  6.84s/it]
Task 4, Epoch 10/20 => Loss 0.918, Train_accy 81.88:  45%|████▌     | 9/20 [01:08<01:15,  6.84s/it]
Task 4, Epoch 10/20 => Loss 0.918, Train_accy 81.88:  50%|█████     | 10/20 [01:08<01:08,  6.84s/it]
Task 4, Epoch 11/20 => Loss 0.876, Train_accy 83.42:  50%|█████     | 10/20 [01:15<01:08,  6.84s/it]
Task 4, Epoch 11/20 => Loss 0.876, Train_accy 83.42:  55%|█████▌    | 11/20 [01:15<01:01,  6.84s/it]
Task 4, Epoch 12/20 => Loss 0.844, Train_accy 84.52:  55%|█████▌    | 11/20 [01:22<01:01,  6.84s/it]
Task 4, Epoch 12/20 => Loss 0.844, Train_accy 84.52:  60%|██████    | 12/20 [01:22<00:54,  6.85s/it]
Task 4, Epoch 13/20 => Loss 0.820, Train_accy 85.15:  60%|██████    | 12/20 [01:28<00:54,  6.85s/it]
Task 4, Epoch 13/20 => Loss 0.820, Train_accy 85.15:  65%|██████▌   | 13/20 [01:28<00:47,  6.84s/it]
Task 4, Epoch 14/20 => Loss 0.792, Train_accy 86.61:  65%|██████▌   | 13/20 [01:35<00:47,  6.84s/it]
Task 4, Epoch 14/20 => Loss 0.792, Train_accy 86.61:  70%|███████   | 14/20 [01:35<00:41,  6.84s/it]
Task 4, Epoch 15/20 => Loss 0.758, Train_accy 86.25:  70%|███████   | 14/20 [01:42<00:41,  6.84s/it]
Task 4, Epoch 15/20 => Loss 0.758, Train_accy 86.25:  75%|███████▌  | 15/20 [01:42<00:34,  6.84s/it]
Task 4, Epoch 16/20 => Loss 0.747, Train_accy 86.98:  75%|███████▌  | 15/20 [01:49<00:34,  6.84s/it]
Task 4, Epoch 16/20 => Loss 0.747, Train_accy 86.98:  80%|████████  | 16/20 [01:49<00:27,  6.85s/it]
Task 4, Epoch 17/20 => Loss 0.706, Train_accy 88.16:  80%|████████  | 16/20 [01:56<00:27,  6.85s/it]
Task 4, Epoch 17/20 => Loss 0.706, Train_accy 88.16:  85%|████████▌ | 17/20 [01:56<00:20,  6.85s/it]
Task 4, Epoch 18/20 => Loss 0.720, Train_accy 87.25:  85%|████████▌ | 17/20 [02:03<00:20,  6.85s/it]
Task 4, Epoch 18/20 => Loss 0.720, Train_accy 87.25:  90%|█████████ | 18/20 [02:03<00:13,  6.88s/it]
Task 4, Epoch 19/20 => Loss 0.691, Train_accy 87.80:  90%|█████████ | 18/20 [02:10<00:13,  6.88s/it]
Task 4, Epoch 19/20 => Loss 0.691, Train_accy 87.80:  95%|█████████▌| 19/20 [02:10<00:06,  6.87s/it]
Task 4, Epoch 20/20 => Loss 0.695, Train_accy 88.25:  95%|█████████▌| 19/20 [02:16<00:06,  6.87s/it]
Task 4, Epoch 20/20 => Loss 0.695, Train_accy 88.25: 100%|██████████| 20/20 [02:16<00:00,  6.86s/it]
Task 4, Epoch 20/20 => Loss 0.695, Train_accy 88.25: 100%|██████████| 20/20 [02:16<00:00,  6.85s/it]
2024-09-07 15:01:06,888 [ease.py] => Task 4, Epoch 20/20 => Loss 0.695, Train_accy 88.25
2024-09-07 15:01:49,204 [ease.py] => Task correct: 65.2402896642528
2024-09-07 15:01:49,205 [ease.py] => Task acc: 77.35352205398289
2024-09-07 15:01:49,228 [trainer.py] => No NME accuracy.
2024-09-07 15:01:49,228 [trainer.py] => CNN: {'total': 58.53, '00-39': 56.39, '40-79': 61.54, '80-119': 62.82, '120-159': 55.68, '160-199': 56.09, 'old': 59.05, 'new': 56.09}
2024-09-07 15:01:49,228 [trainer.py] => CNN top1 curve: [80.0, 72.92, 67.38, 60.98, 58.53]
2024-09-07 15:01:49,229 [trainer.py] => CNN top5 curve: [95.56, 93.27, 88.41, 84.62, 81.57]

Average Accuracy (CNN): 67.96
2024-09-07 15:01:49,229 [trainer.py] => Average Accuracy (CNN): 67.96 

Accuracy Matrix (CNN):
[[80.   68.06 63.06 57.22 56.39]
 [ 0.   78.11 71.01 63.61 61.54]
 [ 0.    0.   68.59 67.51 62.82]
 [ 0.    0.    0.   56.04 55.68]
 [ 0.    0.    0.    0.   56.09]]
2024-09-07 15:01:49,229 [trainer.py] => Forgetting (CNN): 11.5775
2024-09-07 15:01:52,002 [trainer.py] => config: ./exps/ease_ina_B0_Inc10.json
2024-09-07 15:01:52,002 [trainer.py] => prefix:  
2024-09-07 15:01:52,002 [trainer.py] => dataset: imageneta
2024-09-07 15:01:52,002 [trainer.py] => memory_size: 0
2024-09-07 15:01:52,002 [trainer.py] => memory_per_class: 0
2024-09-07 15:01:52,002 [trainer.py] => fixed_memory: False
2024-09-07 15:01:52,002 [trainer.py] => shuffle: True
2024-09-07 15:01:52,003 [trainer.py] => init_cls: 20
2024-09-07 15:01:52,003 [trainer.py] => increment: 20
2024-09-07 15:01:52,003 [trainer.py] => model_name: ease
2024-09-07 15:01:52,003 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-07 15:01:52,003 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 15:01:52,003 [trainer.py] => seed: 1993
2024-09-07 15:01:52,003 [trainer.py] => init_epochs: 20
2024-09-07 15:01:52,003 [trainer.py] => init_lr: 0.05
2024-09-07 15:01:52,003 [trainer.py] => later_epochs: 20
2024-09-07 15:01:52,003 [trainer.py] => later_lr: 0.05
2024-09-07 15:01:52,003 [trainer.py] => batch_size: 48
2024-09-07 15:01:52,003 [trainer.py] => weight_decay: 0.005
2024-09-07 15:01:52,003 [trainer.py] => min_lr: 0
2024-09-07 15:01:52,003 [trainer.py] => optimizer: sgd
2024-09-07 15:01:52,003 [trainer.py] => scheduler: cosine
2024-09-07 15:01:52,003 [trainer.py] => pretrained: True
2024-09-07 15:01:52,003 [trainer.py] => vpt_type: Deep
2024-09-07 15:01:52,003 [trainer.py] => prompt_token_num: 5
2024-09-07 15:01:52,003 [trainer.py] => ffn_num: 16
2024-09-07 15:01:52,003 [trainer.py] => use_diagonal: False
2024-09-07 15:01:52,003 [trainer.py] => recalc_sim: True
2024-09-07 15:01:52,003 [trainer.py] => alpha: 0.1
2024-09-07 15:01:52,003 [trainer.py] => use_init_ptm: False
2024-09-07 15:01:52,003 [trainer.py] => beta: 0
2024-09-07 15:01:52,003 [trainer.py] => use_old_data: False
2024-09-07 15:01:52,003 [trainer.py] => use_reweight: True
2024-09-07 15:01:52,003 [trainer.py] => moni_adam: False
2024-09-07 15:01:52,003 [trainer.py] => adapter_num: -1
2024-09-07 15:01:52,029 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-07 15:01:54,723 [trainer.py] => All params: 86102976
2024-09-07 15:01:54,724 [trainer.py] => Trainable params: 304320
2024-09-07 15:01:54,731 [ease.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.954, Train_accy 18.72:   0%|          | 0/20 [00:04<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.954, Train_accy 18.72:   5%|▌         | 1/20 [00:04<01:31,  4.84s/it]
Task 0, Epoch 2/20 => Loss 2.697, Train_accy 53.90:   5%|▌         | 1/20 [00:09<01:31,  4.84s/it]
Task 0, Epoch 2/20 => Loss 2.697, Train_accy 53.90:  10%|█         | 2/20 [00:09<01:23,  4.63s/it]
Task 0, Epoch 3/20 => Loss 2.231, Train_accy 62.98:  10%|█         | 2/20 [00:13<01:23,  4.63s/it]
Task 0, Epoch 3/20 => Loss 2.231, Train_accy 62.98:  15%|█▌        | 3/20 [00:13<01:17,  4.57s/it]
Task 0, Epoch 4/20 => Loss 1.791, Train_accy 66.81:  15%|█▌        | 3/20 [00:18<01:17,  4.57s/it]
Task 0, Epoch 4/20 => Loss 1.791, Train_accy 66.81:  20%|██        | 4/20 [00:18<01:12,  4.54s/it]
Task 0, Epoch 5/20 => Loss 1.419, Train_accy 77.30:  20%|██        | 4/20 [00:22<01:12,  4.54s/it]
Task 0, Epoch 5/20 => Loss 1.419, Train_accy 77.30:  25%|██▌       | 5/20 [00:22<01:07,  4.52s/it]
Task 0, Epoch 6/20 => Loss 1.156, Train_accy 84.11:  25%|██▌       | 5/20 [00:27<01:07,  4.52s/it]
Task 0, Epoch 6/20 => Loss 1.156, Train_accy 84.11:  30%|███       | 6/20 [00:27<01:03,  4.51s/it]
Task 0, Epoch 7/20 => Loss 0.949, Train_accy 86.10:  30%|███       | 6/20 [00:31<01:03,  4.51s/it]
Task 0, Epoch 7/20 => Loss 0.949, Train_accy 86.10:  35%|███▌      | 7/20 [00:31<00:58,  4.51s/it]
Task 0, Epoch 8/20 => Loss 0.806, Train_accy 85.67:  35%|███▌      | 7/20 [00:36<00:58,  4.51s/it]
Task 0, Epoch 8/20 => Loss 0.806, Train_accy 85.67:  40%|████      | 8/20 [00:36<00:54,  4.53s/it]
Task 0, Epoch 9/20 => Loss 0.735, Train_accy 86.52:  40%|████      | 8/20 [00:40<00:54,  4.53s/it]
Task 0, Epoch 9/20 => Loss 0.735, Train_accy 86.52:  45%|████▌     | 9/20 [00:40<00:49,  4.52s/it]
Task 0, Epoch 10/20 => Loss 0.678, Train_accy 88.79:  45%|████▌     | 9/20 [00:45<00:49,  4.52s/it]
Task 0, Epoch 10/20 => Loss 0.678, Train_accy 88.79:  50%|█████     | 10/20 [00:45<00:45,  4.51s/it]
Task 0, Epoch 11/20 => Loss 0.663, Train_accy 87.09:  50%|█████     | 10/20 [00:49<00:45,  4.51s/it]
Task 0, Epoch 11/20 => Loss 0.663, Train_accy 87.09:  55%|█████▌    | 11/20 [00:49<00:40,  4.52s/it]
Task 0, Epoch 12/20 => Loss 0.638, Train_accy 87.09:  55%|█████▌    | 11/20 [00:54<00:40,  4.52s/it]
Task 0, Epoch 12/20 => Loss 0.638, Train_accy 87.09:  60%|██████    | 12/20 [00:54<00:36,  4.52s/it]
Task 0, Epoch 13/20 => Loss 0.551, Train_accy 91.06:  60%|██████    | 12/20 [00:58<00:36,  4.52s/it]
Task 0, Epoch 13/20 => Loss 0.551, Train_accy 91.06:  65%|██████▌   | 13/20 [00:58<00:31,  4.53s/it]
Task 0, Epoch 14/20 => Loss 0.554, Train_accy 90.21:  65%|██████▌   | 13/20 [01:03<00:31,  4.53s/it]
Task 0, Epoch 14/20 => Loss 0.554, Train_accy 90.21:  70%|███████   | 14/20 [01:03<00:27,  4.52s/it]
Task 0, Epoch 15/20 => Loss 0.550, Train_accy 91.21:  70%|███████   | 14/20 [01:08<00:27,  4.52s/it]
Task 0, Epoch 15/20 => Loss 0.550, Train_accy 91.21:  75%|███████▌  | 15/20 [01:08<00:22,  4.52s/it]
Task 0, Epoch 16/20 => Loss 0.544, Train_accy 90.21:  75%|███████▌  | 15/20 [01:12<00:22,  4.52s/it]
Task 0, Epoch 16/20 => Loss 0.544, Train_accy 90.21:  80%|████████  | 16/20 [01:12<00:18,  4.52s/it]
Task 0, Epoch 17/20 => Loss 0.524, Train_accy 91.63:  80%|████████  | 16/20 [01:17<00:18,  4.52s/it]
Task 0, Epoch 17/20 => Loss 0.524, Train_accy 91.63:  85%|████████▌ | 17/20 [01:17<00:13,  4.54s/it]
Task 0, Epoch 18/20 => Loss 0.536, Train_accy 92.34:  85%|████████▌ | 17/20 [01:21<00:13,  4.54s/it]
Task 0, Epoch 18/20 => Loss 0.536, Train_accy 92.34:  90%|█████████ | 18/20 [01:21<00:09,  4.55s/it]
Task 0, Epoch 19/20 => Loss 0.524, Train_accy 91.91:  90%|█████████ | 18/20 [01:26<00:09,  4.55s/it]
Task 0, Epoch 19/20 => Loss 0.524, Train_accy 91.91:  95%|█████████▌| 19/20 [01:26<00:04,  4.56s/it]
Task 0, Epoch 20/20 => Loss 0.527, Train_accy 91.91:  95%|█████████▌| 19/20 [01:30<00:04,  4.56s/it]
Task 0, Epoch 20/20 => Loss 0.527, Train_accy 91.91: 100%|██████████| 20/20 [01:30<00:00,  4.56s/it]
Task 0, Epoch 20/20 => Loss 0.527, Train_accy 91.91: 100%|██████████| 20/20 [01:30<00:00,  4.54s/it]
2024-09-07 15:03:25,620 [ease.py] => Task 0, Epoch 20/20 => Loss 0.527, Train_accy 91.91
2024-09-07 15:03:29,251 [ease.py] => Task correct: 100.0
2024-09-07 15:03:29,252 [ease.py] => Task acc: 80.0
2024-09-07 15:03:29,276 [trainer.py] => No NME accuracy.
2024-09-07 15:03:29,276 [trainer.py] => CNN: {'total': 80.0, '00-19': 80.0, 'old': 0, 'new': 80.0}
2024-09-07 15:03:29,276 [trainer.py] => CNN top1 curve: [80.0]
2024-09-07 15:03:29,276 [trainer.py] => CNN top5 curve: [96.57]

Average Accuracy (CNN): 80.0
2024-09-07 15:03:29,276 [trainer.py] => Average Accuracy (CNN): 80.0 

2024-09-07 15:03:29,277 [trainer.py] => All params: 86133698
2024-09-07 15:03:29,278 [trainer.py] => Trainable params: 304320
2024-09-07 15:03:29,280 [ease.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.952, Train_accy 22.45:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.952, Train_accy 22.45:   5%|▌         | 1/20 [00:04<01:32,  4.86s/it]
Task 1, Epoch 2/20 => Loss 2.744, Train_accy 40.99:   5%|▌         | 1/20 [00:09<01:32,  4.86s/it]
Task 1, Epoch 2/20 => Loss 2.744, Train_accy 40.99:  10%|█         | 2/20 [00:09<01:27,  4.87s/it]
Task 1, Epoch 3/20 => Loss 2.354, Train_accy 54.83:  10%|█         | 2/20 [00:14<01:27,  4.87s/it]
Task 1, Epoch 3/20 => Loss 2.354, Train_accy 54.83:  15%|█▌        | 3/20 [00:14<01:22,  4.86s/it]
Task 1, Epoch 4/20 => Loss 1.924, Train_accy 64.10:  15%|█▌        | 3/20 [00:19<01:22,  4.86s/it]
Task 1, Epoch 4/20 => Loss 1.924, Train_accy 64.10:  20%|██        | 4/20 [00:19<01:18,  4.89s/it]
Task 1, Epoch 5/20 => Loss 1.606, Train_accy 72.32:  20%|██        | 4/20 [00:24<01:18,  4.89s/it]
Task 1, Epoch 5/20 => Loss 1.606, Train_accy 72.32:  25%|██▌       | 5/20 [00:24<01:13,  4.89s/it]
Task 1, Epoch 6/20 => Loss 1.338, Train_accy 79.50:  25%|██▌       | 5/20 [00:29<01:13,  4.89s/it]
Task 1, Epoch 6/20 => Loss 1.338, Train_accy 79.50:  30%|███       | 6/20 [00:29<01:08,  4.88s/it]
Task 1, Epoch 7/20 => Loss 1.113, Train_accy 82.11:  30%|███       | 6/20 [00:34<01:08,  4.88s/it]
Task 1, Epoch 7/20 => Loss 1.113, Train_accy 82.11:  35%|███▌      | 7/20 [00:34<01:03,  4.88s/it]
Task 1, Epoch 8/20 => Loss 0.916, Train_accy 83.68:  35%|███▌      | 7/20 [00:39<01:03,  4.88s/it]
Task 1, Epoch 8/20 => Loss 0.916, Train_accy 83.68:  40%|████      | 8/20 [00:39<00:58,  4.89s/it]
Task 1, Epoch 9/20 => Loss 0.880, Train_accy 84.46:  40%|████      | 8/20 [00:43<00:58,  4.89s/it]
Task 1, Epoch 9/20 => Loss 0.880, Train_accy 84.46:  45%|████▌     | 9/20 [00:43<00:53,  4.88s/it]
Task 1, Epoch 10/20 => Loss 0.801, Train_accy 83.42:  45%|████▌     | 9/20 [00:48<00:53,  4.88s/it]
Task 1, Epoch 10/20 => Loss 0.801, Train_accy 83.42:  50%|█████     | 10/20 [00:48<00:48,  4.89s/it]
Task 1, Epoch 11/20 => Loss 0.734, Train_accy 84.99:  50%|█████     | 10/20 [00:53<00:48,  4.89s/it]
Task 1, Epoch 11/20 => Loss 0.734, Train_accy 84.99:  55%|█████▌    | 11/20 [00:53<00:43,  4.89s/it]
Task 1, Epoch 12/20 => Loss 0.705, Train_accy 85.90:  55%|█████▌    | 11/20 [00:58<00:43,  4.89s/it]
Task 1, Epoch 12/20 => Loss 0.705, Train_accy 85.90:  60%|██████    | 12/20 [00:58<00:39,  4.88s/it]
Task 1, Epoch 13/20 => Loss 0.697, Train_accy 86.29:  60%|██████    | 12/20 [01:03<00:39,  4.88s/it]
Task 1, Epoch 13/20 => Loss 0.697, Train_accy 86.29:  65%|██████▌   | 13/20 [01:03<00:34,  4.88s/it]
Task 1, Epoch 14/20 => Loss 0.677, Train_accy 87.47:  65%|██████▌   | 13/20 [01:08<00:34,  4.88s/it]
Task 1, Epoch 14/20 => Loss 0.677, Train_accy 87.47:  70%|███████   | 14/20 [01:08<00:29,  4.88s/it]
Task 1, Epoch 15/20 => Loss 0.680, Train_accy 85.77:  70%|███████   | 14/20 [01:13<00:29,  4.88s/it]
Task 1, Epoch 15/20 => Loss 0.680, Train_accy 85.77:  75%|███████▌  | 15/20 [01:13<00:24,  4.89s/it]
Task 1, Epoch 16/20 => Loss 0.704, Train_accy 85.25:  75%|███████▌  | 15/20 [01:18<00:24,  4.89s/it]
Task 1, Epoch 16/20 => Loss 0.704, Train_accy 85.25:  80%|████████  | 16/20 [01:18<00:19,  4.90s/it]
Task 1, Epoch 17/20 => Loss 0.674, Train_accy 86.03:  80%|████████  | 16/20 [01:23<00:19,  4.90s/it]
Task 1, Epoch 17/20 => Loss 0.674, Train_accy 86.03:  85%|████████▌ | 17/20 [01:23<00:14,  4.89s/it]
Task 1, Epoch 18/20 => Loss 0.637, Train_accy 88.51:  85%|████████▌ | 17/20 [01:27<00:14,  4.89s/it]
Task 1, Epoch 18/20 => Loss 0.637, Train_accy 88.51:  90%|█████████ | 18/20 [01:27<00:09,  4.89s/it]
Task 1, Epoch 19/20 => Loss 0.636, Train_accy 86.95:  90%|█████████ | 18/20 [01:32<00:09,  4.89s/it]
Task 1, Epoch 19/20 => Loss 0.636, Train_accy 86.95:  95%|█████████▌| 19/20 [01:32<00:04,  4.92s/it]
Task 1, Epoch 20/20 => Loss 0.621, Train_accy 86.81:  95%|█████████▌| 19/20 [01:37<00:04,  4.92s/it]
Task 1, Epoch 20/20 => Loss 0.621, Train_accy 86.81: 100%|██████████| 20/20 [01:37<00:00,  4.96s/it]
Task 1, Epoch 20/20 => Loss 0.621, Train_accy 86.81: 100%|██████████| 20/20 [01:37<00:00,  4.90s/it]
2024-09-07 15:05:07,250 [ease.py] => Task 1, Epoch 20/20 => Loss 0.621, Train_accy 86.81
2024-09-07 15:05:15,700 [ease.py] => Task correct: 86.94444444444444
2024-09-07 15:05:15,701 [ease.py] => Task acc: 80.0
2024-09-07 15:05:15,719 [trainer.py] => No NME accuracy.
2024-09-07 15:05:15,719 [trainer.py] => CNN: {'total': 74.17, '00-19': 70.29, '20-39': 77.84, 'old': 70.29, 'new': 77.84}
2024-09-07 15:05:15,719 [trainer.py] => CNN top1 curve: [80.0, 74.17]
2024-09-07 15:05:15,719 [trainer.py] => CNN top5 curve: [96.57, 93.89]

Average Accuracy (CNN): 77.09
2024-09-07 15:05:15,719 [trainer.py] => Average Accuracy (CNN): 77.09 

2024-09-07 15:05:15,720 [trainer.py] => All params: 86179778
2024-09-07 15:05:15,721 [trainer.py] => Trainable params: 304320
2024-09-07 15:05:15,722 [ease.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.964, Train_accy 19.18:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.964, Train_accy 19.18:   5%|▌         | 1/20 [00:03<01:04,  3.38s/it]
Task 2, Epoch 2/20 => Loss 2.807, Train_accy 41.88:   5%|▌         | 1/20 [00:06<01:04,  3.38s/it]
Task 2, Epoch 2/20 => Loss 2.807, Train_accy 41.88:  10%|█         | 2/20 [00:06<01:01,  3.39s/it]
Task 2, Epoch 3/20 => Loss 2.524, Train_accy 50.88:  10%|█         | 2/20 [00:10<01:01,  3.39s/it]
Task 2, Epoch 3/20 => Loss 2.524, Train_accy 50.88:  15%|█▌        | 3/20 [00:10<00:57,  3.40s/it]
Task 2, Epoch 4/20 => Loss 2.137, Train_accy 60.08:  15%|█▌        | 3/20 [00:13<00:57,  3.40s/it]
Task 2, Epoch 4/20 => Loss 2.137, Train_accy 60.08:  20%|██        | 4/20 [00:13<00:54,  3.41s/it]
Task 2, Epoch 5/20 => Loss 1.823, Train_accy 65.75:  20%|██        | 4/20 [00:16<00:54,  3.41s/it]
Task 2, Epoch 5/20 => Loss 1.823, Train_accy 65.75:  25%|██▌       | 5/20 [00:16<00:50,  3.39s/it]
Task 2, Epoch 6/20 => Loss 1.532, Train_accy 74.17:  25%|██▌       | 5/20 [00:20<00:50,  3.39s/it]
Task 2, Epoch 6/20 => Loss 1.532, Train_accy 74.17:  30%|███       | 6/20 [00:20<00:47,  3.39s/it]
Task 2, Epoch 7/20 => Loss 1.336, Train_accy 79.65:  30%|███       | 6/20 [00:23<00:47,  3.39s/it]
Task 2, Epoch 7/20 => Loss 1.336, Train_accy 79.65:  35%|███▌      | 7/20 [00:23<00:44,  3.40s/it]
Task 2, Epoch 8/20 => Loss 1.194, Train_accy 83.76:  35%|███▌      | 7/20 [00:27<00:44,  3.40s/it]
Task 2, Epoch 8/20 => Loss 1.194, Train_accy 83.76:  40%|████      | 8/20 [00:27<00:40,  3.40s/it]
Task 2, Epoch 9/20 => Loss 1.033, Train_accy 89.24:  40%|████      | 8/20 [00:30<00:40,  3.40s/it]
Task 2, Epoch 9/20 => Loss 1.033, Train_accy 89.24:  45%|████▌     | 9/20 [00:30<00:37,  3.39s/it]
Task 2, Epoch 10/20 => Loss 0.888, Train_accy 91.59:  45%|████▌     | 9/20 [00:33<00:37,  3.39s/it]
Task 2, Epoch 10/20 => Loss 0.888, Train_accy 91.59:  50%|█████     | 10/20 [00:33<00:33,  3.39s/it]
Task 2, Epoch 11/20 => Loss 0.869, Train_accy 87.67:  50%|█████     | 10/20 [00:37<00:33,  3.39s/it]
Task 2, Epoch 11/20 => Loss 0.869, Train_accy 87.67:  55%|█████▌    | 11/20 [00:37<00:30,  3.39s/it]
Task 2, Epoch 12/20 => Loss 0.766, Train_accy 91.98:  55%|█████▌    | 11/20 [00:40<00:30,  3.39s/it]
Task 2, Epoch 12/20 => Loss 0.766, Train_accy 91.98:  60%|██████    | 12/20 [00:40<00:27,  3.38s/it]
Task 2, Epoch 13/20 => Loss 0.715, Train_accy 91.78:  60%|██████    | 12/20 [00:44<00:27,  3.38s/it]
Task 2, Epoch 13/20 => Loss 0.715, Train_accy 91.78:  65%|██████▌   | 13/20 [00:44<00:23,  3.38s/it]
Task 2, Epoch 14/20 => Loss 0.694, Train_accy 91.19:  65%|██████▌   | 13/20 [00:47<00:23,  3.38s/it]
Task 2, Epoch 14/20 => Loss 0.694, Train_accy 91.19:  70%|███████   | 14/20 [00:47<00:20,  3.38s/it]
Task 2, Epoch 15/20 => Loss 0.643, Train_accy 92.37:  70%|███████   | 14/20 [00:50<00:20,  3.38s/it]
Task 2, Epoch 15/20 => Loss 0.643, Train_accy 92.37:  75%|███████▌  | 15/20 [00:50<00:16,  3.37s/it]
Task 2, Epoch 16/20 => Loss 0.646, Train_accy 91.78:  75%|███████▌  | 15/20 [00:54<00:16,  3.37s/it]
Task 2, Epoch 16/20 => Loss 0.646, Train_accy 91.78:  80%|████████  | 16/20 [00:54<00:13,  3.37s/it]
Task 2, Epoch 17/20 => Loss 0.640, Train_accy 89.82:  80%|████████  | 16/20 [00:57<00:13,  3.37s/it]
Task 2, Epoch 17/20 => Loss 0.640, Train_accy 89.82:  85%|████████▌ | 17/20 [00:57<00:10,  3.38s/it]
Task 2, Epoch 18/20 => Loss 0.650, Train_accy 89.82:  85%|████████▌ | 17/20 [01:00<00:10,  3.38s/it]
Task 2, Epoch 18/20 => Loss 0.650, Train_accy 89.82:  90%|█████████ | 18/20 [01:00<00:06,  3.39s/it]
Task 2, Epoch 19/20 => Loss 0.647, Train_accy 91.98:  90%|█████████ | 18/20 [01:04<00:06,  3.39s/it]
Task 2, Epoch 19/20 => Loss 0.647, Train_accy 91.98:  95%|█████████▌| 19/20 [01:04<00:03,  3.39s/it]
Task 2, Epoch 20/20 => Loss 0.640, Train_accy 91.78:  95%|█████████▌| 19/20 [01:07<00:03,  3.39s/it]
Task 2, Epoch 20/20 => Loss 0.640, Train_accy 91.78: 100%|██████████| 20/20 [01:07<00:00,  3.39s/it]
Task 2, Epoch 20/20 => Loss 0.640, Train_accy 91.78: 100%|██████████| 20/20 [01:07<00:00,  3.39s/it]
2024-09-07 15:06:23,498 [ease.py] => Task 2, Epoch 20/20 => Loss 0.640, Train_accy 91.78
2024-09-07 15:06:34,233 [ease.py] => Task correct: 78.15126050420169
2024-09-07 15:06:34,234 [ease.py] => Task acc: 79.83193277310924
2024-09-07 15:06:34,257 [trainer.py] => No NME accuracy.
2024-09-07 15:06:34,257 [trainer.py] => CNN: {'total': 68.91, '00-19': 69.14, '20-39': 74.59, '40-59': 59.48, 'old': 71.94, 'new': 59.48}
2024-09-07 15:06:34,257 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91]
2024-09-07 15:06:34,257 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18]

Average Accuracy (CNN): 74.36
2024-09-07 15:06:34,257 [trainer.py] => Average Accuracy (CNN): 74.36 

2024-09-07 15:06:34,258 [trainer.py] => All params: 86256578
2024-09-07 15:06:34,259 [trainer.py] => Trainable params: 304320
2024-09-07 15:06:34,262 [ease.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.946, Train_accy 20.41:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.946, Train_accy 20.41:   5%|▌         | 1/20 [00:04<01:34,  4.96s/it]
Task 3, Epoch 2/20 => Loss 2.673, Train_accy 52.17:   5%|▌         | 1/20 [00:09<01:34,  4.96s/it]
Task 3, Epoch 2/20 => Loss 2.673, Train_accy 52.17:  10%|█         | 2/20 [00:09<01:29,  4.96s/it]
Task 3, Epoch 3/20 => Loss 2.194, Train_accy 60.59:  10%|█         | 2/20 [00:14<01:29,  4.96s/it]
Task 3, Epoch 3/20 => Loss 2.194, Train_accy 60.59:  15%|█▌        | 3/20 [00:14<01:24,  4.99s/it]
Task 3, Epoch 4/20 => Loss 1.740, Train_accy 67.22:  15%|█▌        | 3/20 [00:19<01:24,  4.99s/it]
Task 3, Epoch 4/20 => Loss 1.740, Train_accy 67.22:  20%|██        | 4/20 [00:19<01:19,  4.99s/it]
Task 3, Epoch 5/20 => Loss 1.392, Train_accy 75.89:  20%|██        | 4/20 [00:24<01:19,  4.99s/it]
Task 3, Epoch 5/20 => Loss 1.392, Train_accy 75.89:  25%|██▌       | 5/20 [00:24<01:14,  4.99s/it]
Task 3, Epoch 6/20 => Loss 1.111, Train_accy 83.16:  25%|██▌       | 5/20 [00:29<01:14,  4.99s/it]
Task 3, Epoch 6/20 => Loss 1.111, Train_accy 83.16:  30%|███       | 6/20 [00:29<01:09,  4.99s/it]
Task 3, Epoch 7/20 => Loss 0.890, Train_accy 84.31:  30%|███       | 6/20 [00:34<01:09,  4.99s/it]
Task 3, Epoch 7/20 => Loss 0.890, Train_accy 84.31:  35%|███▌      | 7/20 [00:34<01:04,  4.98s/it]
Task 3, Epoch 8/20 => Loss 0.816, Train_accy 84.44:  35%|███▌      | 7/20 [00:39<01:04,  4.98s/it]
Task 3, Epoch 8/20 => Loss 0.816, Train_accy 84.44:  40%|████      | 8/20 [00:39<00:59,  4.99s/it]
Task 3, Epoch 9/20 => Loss 0.691, Train_accy 87.12:  40%|████      | 8/20 [00:44<00:59,  4.99s/it]
Task 3, Epoch 9/20 => Loss 0.691, Train_accy 87.12:  45%|████▌     | 9/20 [00:44<00:54,  4.99s/it]
Task 3, Epoch 10/20 => Loss 0.666, Train_accy 87.63:  45%|████▌     | 9/20 [00:49<00:54,  4.99s/it]
Task 3, Epoch 10/20 => Loss 0.666, Train_accy 87.63:  50%|█████     | 10/20 [00:49<00:49,  4.98s/it]
Task 3, Epoch 11/20 => Loss 0.631, Train_accy 86.35:  50%|█████     | 10/20 [00:54<00:49,  4.98s/it]
Task 3, Epoch 11/20 => Loss 0.631, Train_accy 86.35:  55%|█████▌    | 11/20 [00:54<00:44,  4.98s/it]
Task 3, Epoch 12/20 => Loss 0.634, Train_accy 86.73:  55%|█████▌    | 11/20 [00:59<00:44,  4.98s/it]
Task 3, Epoch 12/20 => Loss 0.634, Train_accy 86.73:  60%|██████    | 12/20 [00:59<00:39,  4.99s/it]
Task 3, Epoch 13/20 => Loss 0.578, Train_accy 89.16:  60%|██████    | 12/20 [01:04<00:39,  4.99s/it]
Task 3, Epoch 13/20 => Loss 0.578, Train_accy 89.16:  65%|██████▌   | 13/20 [01:04<00:34,  4.98s/it]
Task 3, Epoch 14/20 => Loss 0.592, Train_accy 86.35:  65%|██████▌   | 13/20 [01:09<00:34,  4.98s/it]
Task 3, Epoch 14/20 => Loss 0.592, Train_accy 86.35:  70%|███████   | 14/20 [01:09<00:29,  4.99s/it]
Task 3, Epoch 15/20 => Loss 0.611, Train_accy 87.37:  70%|███████   | 14/20 [01:14<00:29,  4.99s/it]
Task 3, Epoch 15/20 => Loss 0.611, Train_accy 87.37:  75%|███████▌  | 15/20 [01:14<00:24,  4.99s/it]
Task 3, Epoch 16/20 => Loss 0.575, Train_accy 88.39:  75%|███████▌  | 15/20 [01:19<00:24,  4.99s/it]
Task 3, Epoch 16/20 => Loss 0.575, Train_accy 88.39:  80%|████████  | 16/20 [01:19<00:19,  4.99s/it]
Task 3, Epoch 17/20 => Loss 0.569, Train_accy 88.14:  80%|████████  | 16/20 [01:24<00:19,  4.99s/it]
Task 3, Epoch 17/20 => Loss 0.569, Train_accy 88.14:  85%|████████▌ | 17/20 [01:24<00:14,  4.99s/it]
Task 3, Epoch 18/20 => Loss 0.515, Train_accy 89.29:  85%|████████▌ | 17/20 [01:29<00:14,  4.99s/it]
Task 3, Epoch 18/20 => Loss 0.515, Train_accy 89.29:  90%|█████████ | 18/20 [01:29<00:09,  4.99s/it]
Task 3, Epoch 19/20 => Loss 0.544, Train_accy 88.52:  90%|█████████ | 18/20 [01:34<00:09,  4.99s/it]
Task 3, Epoch 19/20 => Loss 0.544, Train_accy 88.52:  95%|█████████▌| 19/20 [01:34<00:05,  5.01s/it]
Task 3, Epoch 20/20 => Loss 0.530, Train_accy 90.31:  95%|█████████▌| 19/20 [01:39<00:05,  5.01s/it]
Task 3, Epoch 20/20 => Loss 0.530, Train_accy 90.31: 100%|██████████| 20/20 [01:39<00:00,  5.00s/it]
Task 3, Epoch 20/20 => Loss 0.530, Train_accy 90.31: 100%|██████████| 20/20 [01:39<00:00,  4.99s/it]
2024-09-07 15:08:14,057 [ease.py] => Task 3, Epoch 20/20 => Loss 0.530, Train_accy 90.31
2024-09-07 15:08:34,236 [ease.py] => Task correct: 72.20630372492836
2024-09-07 15:08:34,236 [ease.py] => Task acc: 82.378223495702
2024-09-07 15:08:34,261 [trainer.py] => No NME accuracy.
2024-09-07 15:08:34,261 [trainer.py] => CNN: {'total': 65.76, '00-19': 58.29, '20-39': 66.49, '40-59': 50.0, '60-79': 79.28, 'old': 59.45, 'new': 79.28}
2024-09-07 15:08:34,261 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91, 65.76]
2024-09-07 15:08:34,261 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18, 88.11]

Average Accuracy (CNN): 72.21
2024-09-07 15:08:34,261 [trainer.py] => Average Accuracy (CNN): 72.21 

2024-09-07 15:08:34,262 [trainer.py] => All params: 86364098
2024-09-07 15:08:34,262 [trainer.py] => Trainable params: 304320
2024-09-07 15:08:34,267 [ease.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.955, Train_accy 23.47:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.955, Train_accy 23.47:   5%|▌         | 1/20 [00:03<01:05,  3.47s/it]
Task 4, Epoch 2/20 => Loss 2.779, Train_accy 44.27:   5%|▌         | 1/20 [00:06<01:05,  3.47s/it]
Task 4, Epoch 2/20 => Loss 2.779, Train_accy 44.27:  10%|█         | 2/20 [00:06<01:02,  3.47s/it]
Task 4, Epoch 3/20 => Loss 2.466, Train_accy 51.91:  10%|█         | 2/20 [00:10<01:02,  3.47s/it]
Task 4, Epoch 3/20 => Loss 2.466, Train_accy 51.91:  15%|█▌        | 3/20 [00:10<00:59,  3.47s/it]
Task 4, Epoch 4/20 => Loss 2.069, Train_accy 61.64:  15%|█▌        | 3/20 [00:13<00:59,  3.47s/it]
Task 4, Epoch 4/20 => Loss 2.069, Train_accy 61.64:  20%|██        | 4/20 [00:13<00:55,  3.49s/it]
Task 4, Epoch 5/20 => Loss 1.736, Train_accy 65.27:  20%|██        | 4/20 [00:17<00:55,  3.49s/it]
Task 4, Epoch 5/20 => Loss 1.736, Train_accy 65.27:  25%|██▌       | 5/20 [00:17<00:52,  3.48s/it]
Task 4, Epoch 6/20 => Loss 1.480, Train_accy 73.66:  25%|██▌       | 5/20 [00:20<00:52,  3.48s/it]
Task 4, Epoch 6/20 => Loss 1.480, Train_accy 73.66:  30%|███       | 6/20 [00:20<00:48,  3.47s/it]
Task 4, Epoch 7/20 => Loss 1.299, Train_accy 80.92:  30%|███       | 6/20 [00:24<00:48,  3.47s/it]
Task 4, Epoch 7/20 => Loss 1.299, Train_accy 80.92:  35%|███▌      | 7/20 [00:24<00:45,  3.48s/it]
Task 4, Epoch 8/20 => Loss 1.152, Train_accy 84.54:  35%|███▌      | 7/20 [00:27<00:45,  3.48s/it]
Task 4, Epoch 8/20 => Loss 1.152, Train_accy 84.54:  40%|████      | 8/20 [00:27<00:41,  3.48s/it]
Task 4, Epoch 9/20 => Loss 1.043, Train_accy 88.36:  40%|████      | 8/20 [00:31<00:41,  3.48s/it]
Task 4, Epoch 9/20 => Loss 1.043, Train_accy 88.36:  45%|████▌     | 9/20 [00:31<00:38,  3.47s/it]
Task 4, Epoch 10/20 => Loss 0.937, Train_accy 89.50:  45%|████▌     | 9/20 [00:34<00:38,  3.47s/it]
Task 4, Epoch 10/20 => Loss 0.937, Train_accy 89.50:  50%|█████     | 10/20 [00:34<00:34,  3.47s/it]
Task 4, Epoch 11/20 => Loss 0.797, Train_accy 91.60:  50%|█████     | 10/20 [00:38<00:34,  3.47s/it]
Task 4, Epoch 11/20 => Loss 0.797, Train_accy 91.60:  55%|█████▌    | 11/20 [00:38<00:31,  3.46s/it]
Task 4, Epoch 12/20 => Loss 0.782, Train_accy 90.08:  55%|█████▌    | 11/20 [00:41<00:31,  3.46s/it]
Task 4, Epoch 12/20 => Loss 0.782, Train_accy 90.08:  60%|██████    | 12/20 [00:41<00:27,  3.46s/it]
Task 4, Epoch 13/20 => Loss 0.769, Train_accy 89.12:  60%|██████    | 12/20 [00:45<00:27,  3.46s/it]
Task 4, Epoch 13/20 => Loss 0.769, Train_accy 89.12:  65%|██████▌   | 13/20 [00:45<00:24,  3.47s/it]
Task 4, Epoch 14/20 => Loss 0.683, Train_accy 91.03:  65%|██████▌   | 13/20 [00:48<00:24,  3.47s/it]
Task 4, Epoch 14/20 => Loss 0.683, Train_accy 91.03:  70%|███████   | 14/20 [00:48<00:20,  3.46s/it]
Task 4, Epoch 15/20 => Loss 0.693, Train_accy 90.46:  70%|███████   | 14/20 [00:52<00:20,  3.46s/it]
Task 4, Epoch 15/20 => Loss 0.693, Train_accy 90.46:  75%|███████▌  | 15/20 [00:52<00:17,  3.46s/it]
Task 4, Epoch 16/20 => Loss 0.654, Train_accy 91.79:  75%|███████▌  | 15/20 [00:55<00:17,  3.46s/it]
Task 4, Epoch 16/20 => Loss 0.654, Train_accy 91.79:  80%|████████  | 16/20 [00:55<00:13,  3.46s/it]
Task 4, Epoch 17/20 => Loss 0.644, Train_accy 91.79:  80%|████████  | 16/20 [00:58<00:13,  3.46s/it]
Task 4, Epoch 17/20 => Loss 0.644, Train_accy 91.79:  85%|████████▌ | 17/20 [00:58<00:10,  3.47s/it]
Task 4, Epoch 18/20 => Loss 0.644, Train_accy 89.89:  85%|████████▌ | 17/20 [01:02<00:10,  3.47s/it]
Task 4, Epoch 18/20 => Loss 0.644, Train_accy 89.89:  90%|█████████ | 18/20 [01:02<00:06,  3.47s/it]
Task 4, Epoch 19/20 => Loss 0.629, Train_accy 91.79:  90%|█████████ | 18/20 [01:05<00:06,  3.47s/it]
Task 4, Epoch 19/20 => Loss 0.629, Train_accy 91.79:  95%|█████████▌| 19/20 [01:05<00:03,  3.47s/it]
Task 4, Epoch 20/20 => Loss 0.623, Train_accy 92.37:  95%|█████████▌| 19/20 [01:09<00:03,  3.47s/it]
Task 4, Epoch 20/20 => Loss 0.623, Train_accy 92.37: 100%|██████████| 20/20 [01:09<00:00,  3.49s/it]
Task 4, Epoch 20/20 => Loss 0.623, Train_accy 92.37: 100%|██████████| 20/20 [01:09<00:00,  3.47s/it]
2024-09-07 15:09:43,710 [ease.py] => Task 4, Epoch 20/20 => Loss 0.623, Train_accy 92.37
2024-09-07 15:10:06,640 [ease.py] => Task correct: 68.01426872770512
2024-09-07 15:10:06,641 [ease.py] => Task acc: 82.52080856123662
2024-09-07 15:10:06,665 [trainer.py] => No NME accuracy.
2024-09-07 15:10:06,665 [trainer.py] => CNN: {'total': 62.66, '00-19': 57.71, '20-39': 65.41, '40-59': 49.14, '60-79': 77.03, '80-99': 53.85, 'old': 64.47, 'new': 53.85}
2024-09-07 15:10:06,665 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91, 65.76, 62.66]
2024-09-07 15:10:06,665 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18, 88.11, 85.26]

Average Accuracy (CNN): 70.3
2024-09-07 15:10:06,665 [trainer.py] => Average Accuracy (CNN): 70.3 

2024-09-07 15:10:06,666 [trainer.py] => All params: 86502338
2024-09-07 15:10:06,666 [trainer.py] => Trainable params: 304320
2024-09-07 15:10:06,672 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.961, Train_accy 23.90:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.961, Train_accy 23.90:   5%|▌         | 1/20 [00:03<01:05,  3.47s/it]
Task 5, Epoch 2/20 => Loss 2.782, Train_accy 51.63:   5%|▌         | 1/20 [00:06<01:05,  3.47s/it]
Task 5, Epoch 2/20 => Loss 2.782, Train_accy 51.63:  10%|█         | 2/20 [00:06<01:02,  3.45s/it]
Task 5, Epoch 3/20 => Loss 2.460, Train_accy 58.13:  10%|█         | 2/20 [00:10<01:02,  3.45s/it]
Task 5, Epoch 3/20 => Loss 2.460, Train_accy 58.13:  15%|█▌        | 3/20 [00:10<00:58,  3.46s/it]
Task 5, Epoch 4/20 => Loss 2.031, Train_accy 62.91:  15%|█▌        | 3/20 [00:13<00:58,  3.46s/it]
Task 5, Epoch 4/20 => Loss 2.031, Train_accy 62.91:  20%|██        | 4/20 [00:13<00:55,  3.45s/it]
Task 5, Epoch 5/20 => Loss 1.639, Train_accy 72.66:  20%|██        | 4/20 [00:17<00:55,  3.45s/it]
Task 5, Epoch 5/20 => Loss 1.639, Train_accy 72.66:  25%|██▌       | 5/20 [00:17<00:51,  3.45s/it]
Task 5, Epoch 6/20 => Loss 1.361, Train_accy 78.78:  25%|██▌       | 5/20 [00:20<00:51,  3.45s/it]
Task 5, Epoch 6/20 => Loss 1.361, Train_accy 78.78:  30%|███       | 6/20 [00:20<00:48,  3.45s/it]
Task 5, Epoch 7/20 => Loss 1.160, Train_accy 83.56:  30%|███       | 6/20 [00:24<00:48,  3.45s/it]
Task 5, Epoch 7/20 => Loss 1.160, Train_accy 83.56:  35%|███▌      | 7/20 [00:24<00:44,  3.45s/it]
Task 5, Epoch 8/20 => Loss 0.976, Train_accy 88.15:  35%|███▌      | 7/20 [00:27<00:44,  3.45s/it]
Task 5, Epoch 8/20 => Loss 0.976, Train_accy 88.15:  40%|████      | 8/20 [00:27<00:41,  3.46s/it]
Task 5, Epoch 9/20 => Loss 0.864, Train_accy 87.57:  40%|████      | 8/20 [00:31<00:41,  3.46s/it]
Task 5, Epoch 9/20 => Loss 0.864, Train_accy 87.57:  45%|████▌     | 9/20 [00:31<00:38,  3.46s/it]
Task 5, Epoch 10/20 => Loss 0.762, Train_accy 89.10:  45%|████▌     | 9/20 [00:34<00:38,  3.46s/it]
Task 5, Epoch 10/20 => Loss 0.762, Train_accy 89.10:  50%|█████     | 10/20 [00:34<00:34,  3.48s/it]
Task 5, Epoch 11/20 => Loss 0.699, Train_accy 90.06:  50%|█████     | 10/20 [00:38<00:34,  3.48s/it]
Task 5, Epoch 11/20 => Loss 0.699, Train_accy 90.06:  55%|█████▌    | 11/20 [00:38<00:31,  3.48s/it]
Task 5, Epoch 12/20 => Loss 0.667, Train_accy 89.48:  55%|█████▌    | 11/20 [00:41<00:31,  3.48s/it]
Task 5, Epoch 12/20 => Loss 0.667, Train_accy 89.48:  60%|██████    | 12/20 [00:41<00:27,  3.48s/it]
Task 5, Epoch 13/20 => Loss 0.622, Train_accy 91.01:  60%|██████    | 12/20 [00:45<00:27,  3.48s/it]
Task 5, Epoch 13/20 => Loss 0.622, Train_accy 91.01:  65%|██████▌   | 13/20 [00:45<00:24,  3.47s/it]
Task 5, Epoch 14/20 => Loss 0.579, Train_accy 90.44:  65%|██████▌   | 13/20 [00:48<00:24,  3.47s/it]
Task 5, Epoch 14/20 => Loss 0.579, Train_accy 90.44:  70%|███████   | 14/20 [00:48<00:20,  3.47s/it]
Task 5, Epoch 15/20 => Loss 0.555, Train_accy 92.54:  70%|███████   | 14/20 [00:51<00:20,  3.47s/it]
Task 5, Epoch 15/20 => Loss 0.555, Train_accy 92.54:  75%|███████▌  | 15/20 [00:51<00:17,  3.46s/it]
Task 5, Epoch 16/20 => Loss 0.622, Train_accy 87.57:  75%|███████▌  | 15/20 [00:55<00:17,  3.46s/it]
Task 5, Epoch 16/20 => Loss 0.622, Train_accy 87.57:  80%|████████  | 16/20 [00:55<00:13,  3.46s/it]
Task 5, Epoch 17/20 => Loss 0.529, Train_accy 92.73:  80%|████████  | 16/20 [00:58<00:13,  3.46s/it]
Task 5, Epoch 17/20 => Loss 0.529, Train_accy 92.73:  85%|████████▌ | 17/20 [00:58<00:10,  3.46s/it]
Task 5, Epoch 18/20 => Loss 0.547, Train_accy 91.97:  85%|████████▌ | 17/20 [01:02<00:10,  3.46s/it]
Task 5, Epoch 18/20 => Loss 0.547, Train_accy 91.97:  90%|█████████ | 18/20 [01:02<00:06,  3.46s/it]
Task 5, Epoch 19/20 => Loss 0.545, Train_accy 91.40:  90%|█████████ | 18/20 [01:05<00:06,  3.46s/it]
Task 5, Epoch 19/20 => Loss 0.545, Train_accy 91.40:  95%|█████████▌| 19/20 [01:05<00:03,  3.46s/it]
Task 5, Epoch 20/20 => Loss 0.559, Train_accy 90.06:  95%|█████████▌| 19/20 [01:09<00:03,  3.46s/it]
Task 5, Epoch 20/20 => Loss 0.559, Train_accy 90.06: 100%|██████████| 20/20 [01:09<00:00,  3.46s/it]
Task 5, Epoch 20/20 => Loss 0.559, Train_accy 90.06: 100%|██████████| 20/20 [01:09<00:00,  3.46s/it]
2024-09-07 15:11:15,933 [ease.py] => Task 5, Epoch 20/20 => Loss 0.559, Train_accy 90.06
2024-09-07 15:11:45,900 [ease.py] => Task correct: 65.53846153846153
2024-09-07 15:11:45,900 [ease.py] => Task acc: 82.76923076923077
2024-09-07 15:11:45,919 [trainer.py] => No NME accuracy.
2024-09-07 15:11:45,919 [trainer.py] => CNN: {'total': 60.92, '00-19': 58.86, '20-39': 62.7, '40-59': 45.69, '60-79': 75.23, '80-99': 52.45, '100-119': 59.7, 'old': 61.12, 'new': 59.7}
2024-09-07 15:11:45,919 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91, 65.76, 62.66, 60.92]
2024-09-07 15:11:45,920 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18, 88.11, 85.26, 84.0]

Average Accuracy (CNN): 68.74
2024-09-07 15:11:45,920 [trainer.py] => Average Accuracy (CNN): 68.74 

2024-09-07 15:11:45,920 [trainer.py] => All params: 86671298
2024-09-07 15:11:45,921 [trainer.py] => Trainable params: 304320
2024-09-07 15:11:45,928 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.975, Train_accy 12.80:   0%|          | 0/20 [00:03<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.975, Train_accy 12.80:   5%|▌         | 1/20 [00:03<01:07,  3.57s/it]
Task 6, Epoch 2/20 => Loss 2.857, Train_accy 37.85:   5%|▌         | 1/20 [00:07<01:07,  3.57s/it]
Task 6, Epoch 2/20 => Loss 2.857, Train_accy 37.85:  10%|█         | 2/20 [00:07<01:04,  3.57s/it]
Task 6, Epoch 3/20 => Loss 2.653, Train_accy 46.57:  10%|█         | 2/20 [00:10<01:04,  3.57s/it]
Task 6, Epoch 3/20 => Loss 2.653, Train_accy 46.57:  15%|█▌        | 3/20 [00:10<01:00,  3.57s/it]
Task 6, Epoch 4/20 => Loss 2.315, Train_accy 56.96:  15%|█▌        | 3/20 [00:14<01:00,  3.57s/it]
Task 6, Epoch 4/20 => Loss 2.315, Train_accy 56.96:  20%|██        | 4/20 [00:14<00:57,  3.58s/it]
Task 6, Epoch 5/20 => Loss 2.025, Train_accy 63.45:  20%|██        | 4/20 [00:17<00:57,  3.58s/it]
Task 6, Epoch 5/20 => Loss 2.025, Train_accy 63.45:  25%|██▌       | 5/20 [00:17<00:53,  3.57s/it]
Task 6, Epoch 6/20 => Loss 1.695, Train_accy 75.14:  25%|██▌       | 5/20 [00:21<00:53,  3.57s/it]
Task 6, Epoch 6/20 => Loss 1.695, Train_accy 75.14:  30%|███       | 6/20 [00:21<00:49,  3.57s/it]
Task 6, Epoch 7/20 => Loss 1.513, Train_accy 80.15:  30%|███       | 6/20 [00:24<00:49,  3.57s/it]
Task 6, Epoch 7/20 => Loss 1.513, Train_accy 80.15:  35%|███▌      | 7/20 [00:24<00:46,  3.57s/it]
Task 6, Epoch 8/20 => Loss 1.309, Train_accy 81.45:  35%|███▌      | 7/20 [00:28<00:46,  3.57s/it]
Task 6, Epoch 8/20 => Loss 1.309, Train_accy 81.45:  40%|████      | 8/20 [00:28<00:42,  3.57s/it]
Task 6, Epoch 9/20 => Loss 1.131, Train_accy 82.37:  40%|████      | 8/20 [00:32<00:42,  3.57s/it]
Task 6, Epoch 9/20 => Loss 1.131, Train_accy 82.37:  45%|████▌     | 9/20 [00:32<00:39,  3.57s/it]
Task 6, Epoch 10/20 => Loss 1.051, Train_accy 83.86:  45%|████▌     | 9/20 [00:35<00:39,  3.57s/it]
Task 6, Epoch 10/20 => Loss 1.051, Train_accy 83.86:  50%|█████     | 10/20 [00:35<00:35,  3.58s/it]
Task 6, Epoch 11/20 => Loss 0.927, Train_accy 84.23:  50%|█████     | 10/20 [00:39<00:35,  3.58s/it]
Task 6, Epoch 11/20 => Loss 0.927, Train_accy 84.23:  55%|█████▌    | 11/20 [00:39<00:32,  3.58s/it]
Task 6, Epoch 12/20 => Loss 0.862, Train_accy 86.09:  55%|█████▌    | 11/20 [00:42<00:32,  3.58s/it]
Task 6, Epoch 12/20 => Loss 0.862, Train_accy 86.09:  60%|██████    | 12/20 [00:42<00:28,  3.57s/it]
Task 6, Epoch 13/20 => Loss 0.836, Train_accy 85.34:  60%|██████    | 12/20 [00:46<00:28,  3.57s/it]
Task 6, Epoch 13/20 => Loss 0.836, Train_accy 85.34:  65%|██████▌   | 13/20 [00:46<00:24,  3.57s/it]
Task 6, Epoch 14/20 => Loss 0.791, Train_accy 87.94:  65%|██████▌   | 13/20 [00:49<00:24,  3.57s/it]
Task 6, Epoch 14/20 => Loss 0.791, Train_accy 87.94:  70%|███████   | 14/20 [00:49<00:21,  3.57s/it]
Task 6, Epoch 15/20 => Loss 0.778, Train_accy 86.64:  70%|███████   | 14/20 [00:53<00:21,  3.57s/it]
Task 6, Epoch 15/20 => Loss 0.778, Train_accy 86.64:  75%|███████▌  | 15/20 [00:53<00:17,  3.58s/it]
Task 6, Epoch 16/20 => Loss 0.752, Train_accy 86.83:  75%|███████▌  | 15/20 [00:57<00:17,  3.58s/it]
Task 6, Epoch 16/20 => Loss 0.752, Train_accy 86.83:  80%|████████  | 16/20 [00:57<00:14,  3.57s/it]
Task 6, Epoch 17/20 => Loss 0.698, Train_accy 90.17:  80%|████████  | 16/20 [01:00<00:14,  3.57s/it]
Task 6, Epoch 17/20 => Loss 0.698, Train_accy 90.17:  85%|████████▌ | 17/20 [01:00<00:10,  3.57s/it]
Task 6, Epoch 18/20 => Loss 0.749, Train_accy 85.71:  85%|████████▌ | 17/20 [01:04<00:10,  3.57s/it]
Task 6, Epoch 18/20 => Loss 0.749, Train_accy 85.71:  90%|█████████ | 18/20 [01:04<00:07,  3.56s/it]
Task 6, Epoch 19/20 => Loss 0.721, Train_accy 86.46:  90%|█████████ | 18/20 [01:07<00:07,  3.56s/it]
Task 6, Epoch 19/20 => Loss 0.721, Train_accy 86.46:  95%|█████████▌| 19/20 [01:07<00:03,  3.56s/it]
Task 6, Epoch 20/20 => Loss 0.745, Train_accy 87.57:  95%|█████████▌| 19/20 [01:11<00:03,  3.56s/it]
Task 6, Epoch 20/20 => Loss 0.745, Train_accy 87.57: 100%|██████████| 20/20 [01:11<00:00,  3.55s/it]
Task 6, Epoch 20/20 => Loss 0.745, Train_accy 87.57: 100%|██████████| 20/20 [01:11<00:00,  3.57s/it]
2024-09-07 15:12:57,268 [ease.py] => Task 6, Epoch 20/20 => Loss 0.745, Train_accy 87.57
2024-09-07 15:13:35,478 [ease.py] => Task correct: 61.10615521855486
2024-09-07 15:13:35,479 [ease.py] => Task acc: 81.6235504014273
2024-09-07 15:13:35,506 [trainer.py] => No NME accuracy.
2024-09-07 15:13:35,506 [trainer.py] => CNN: {'total': 56.91, '00-19': 56.0, '20-39': 60.54, '40-59': 42.24, '60-79': 72.07, '80-99': 51.75, '100-119': 58.21, '120-139': 45.89, 'old': 58.56, 'new': 45.89}
2024-09-07 15:13:35,506 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91, 65.76, 62.66, 60.92, 56.91]
2024-09-07 15:13:35,507 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18, 88.11, 85.26, 84.0, 81.89]

Average Accuracy (CNN): 67.05
2024-09-07 15:13:35,507 [trainer.py] => Average Accuracy (CNN): 67.05 

2024-09-07 15:13:35,508 [trainer.py] => All params: 86870978
2024-09-07 15:13:35,508 [trainer.py] => Trainable params: 304320
2024-09-07 15:13:35,517 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.973, Train_accy 14.31:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.973, Train_accy 14.31:   5%|▌         | 1/20 [00:03<01:07,  3.55s/it]
Task 7, Epoch 2/20 => Loss 2.833, Train_accy 37.66:   5%|▌         | 1/20 [00:07<01:07,  3.55s/it]
Task 7, Epoch 2/20 => Loss 2.833, Train_accy 37.66:  10%|█         | 2/20 [00:07<01:03,  3.54s/it]
Task 7, Epoch 3/20 => Loss 2.581, Train_accy 49.91:  10%|█         | 2/20 [00:10<01:03,  3.54s/it]
Task 7, Epoch 3/20 => Loss 2.581, Train_accy 49.91:  15%|█▌        | 3/20 [00:10<01:00,  3.54s/it]
Task 7, Epoch 4/20 => Loss 2.207, Train_accy 55.18:  15%|█▌        | 3/20 [00:14<01:00,  3.54s/it]
Task 7, Epoch 4/20 => Loss 2.207, Train_accy 55.18:  20%|██        | 4/20 [00:14<00:56,  3.54s/it]
Task 7, Epoch 5/20 => Loss 1.837, Train_accy 62.34:  20%|██        | 4/20 [00:17<00:56,  3.54s/it]
Task 7, Epoch 5/20 => Loss 1.837, Train_accy 62.34:  25%|██▌       | 5/20 [00:17<00:52,  3.53s/it]
Task 7, Epoch 6/20 => Loss 1.600, Train_accy 74.01:  25%|██▌       | 5/20 [00:21<00:52,  3.53s/it]
Task 7, Epoch 6/20 => Loss 1.600, Train_accy 74.01:  30%|███       | 6/20 [00:21<00:49,  3.52s/it]
Task 7, Epoch 7/20 => Loss 1.431, Train_accy 80.23:  30%|███       | 6/20 [00:24<00:49,  3.52s/it]
Task 7, Epoch 7/20 => Loss 1.431, Train_accy 80.23:  35%|███▌      | 7/20 [00:24<00:45,  3.52s/it]
Task 7, Epoch 8/20 => Loss 1.205, Train_accy 85.31:  35%|███▌      | 7/20 [00:28<00:45,  3.52s/it]
Task 7, Epoch 8/20 => Loss 1.205, Train_accy 85.31:  40%|████      | 8/20 [00:28<00:42,  3.53s/it]
Task 7, Epoch 9/20 => Loss 1.090, Train_accy 86.82:  40%|████      | 8/20 [00:31<00:42,  3.53s/it]
Task 7, Epoch 9/20 => Loss 1.090, Train_accy 86.82:  45%|████▌     | 9/20 [00:31<00:38,  3.53s/it]
Task 7, Epoch 10/20 => Loss 0.927, Train_accy 88.32:  45%|████▌     | 9/20 [00:35<00:38,  3.53s/it]
Task 7, Epoch 10/20 => Loss 0.927, Train_accy 88.32:  50%|█████     | 10/20 [00:35<00:35,  3.52s/it]
Task 7, Epoch 11/20 => Loss 0.893, Train_accy 88.32:  50%|█████     | 10/20 [00:38<00:35,  3.52s/it]
Task 7, Epoch 11/20 => Loss 0.893, Train_accy 88.32:  55%|█████▌    | 11/20 [00:38<00:31,  3.52s/it]
Task 7, Epoch 12/20 => Loss 0.842, Train_accy 88.89:  55%|█████▌    | 11/20 [00:42<00:31,  3.52s/it]
Task 7, Epoch 12/20 => Loss 0.842, Train_accy 88.89:  60%|██████    | 12/20 [00:42<00:28,  3.55s/it]
Task 7, Epoch 13/20 => Loss 0.826, Train_accy 89.45:  60%|██████    | 12/20 [00:45<00:28,  3.55s/it]
Task 7, Epoch 13/20 => Loss 0.826, Train_accy 89.45:  65%|██████▌   | 13/20 [00:45<00:24,  3.54s/it]
Task 7, Epoch 14/20 => Loss 0.772, Train_accy 90.58:  65%|██████▌   | 13/20 [00:49<00:24,  3.54s/it]
Task 7, Epoch 14/20 => Loss 0.772, Train_accy 90.58:  70%|███████   | 14/20 [00:49<00:21,  3.54s/it]
Task 7, Epoch 15/20 => Loss 0.707, Train_accy 91.71:  70%|███████   | 14/20 [00:53<00:21,  3.54s/it]
Task 7, Epoch 15/20 => Loss 0.707, Train_accy 91.71:  75%|███████▌  | 15/20 [00:53<00:17,  3.54s/it]
Task 7, Epoch 16/20 => Loss 0.700, Train_accy 88.14:  75%|███████▌  | 15/20 [00:56<00:17,  3.54s/it]
Task 7, Epoch 16/20 => Loss 0.700, Train_accy 88.14:  80%|████████  | 16/20 [00:56<00:14,  3.54s/it]
Task 7, Epoch 17/20 => Loss 0.718, Train_accy 90.02:  80%|████████  | 16/20 [01:00<00:14,  3.54s/it]
Task 7, Epoch 17/20 => Loss 0.718, Train_accy 90.02:  85%|████████▌ | 17/20 [01:00<00:10,  3.53s/it]
Task 7, Epoch 18/20 => Loss 0.712, Train_accy 90.02:  85%|████████▌ | 17/20 [01:03<00:10,  3.53s/it]
Task 7, Epoch 18/20 => Loss 0.712, Train_accy 90.02:  90%|█████████ | 18/20 [01:03<00:07,  3.54s/it]
Task 7, Epoch 19/20 => Loss 0.750, Train_accy 90.40:  90%|█████████ | 18/20 [01:07<00:07,  3.54s/it]
Task 7, Epoch 19/20 => Loss 0.750, Train_accy 90.40:  95%|█████████▌| 19/20 [01:07<00:03,  3.54s/it]
Task 7, Epoch 20/20 => Loss 0.661, Train_accy 90.77:  95%|█████████▌| 19/20 [01:10<00:03,  3.54s/it]
Task 7, Epoch 20/20 => Loss 0.661, Train_accy 90.77: 100%|██████████| 20/20 [01:10<00:00,  3.54s/it]
Task 7, Epoch 20/20 => Loss 0.661, Train_accy 90.77: 100%|██████████| 20/20 [01:10<00:00,  3.54s/it]
2024-09-07 15:14:46,243 [ease.py] => Task 7, Epoch 20/20 => Loss 0.661, Train_accy 90.77
2024-09-07 15:15:32,830 [ease.py] => Task correct: 58.25320512820513
2024-09-07 15:15:32,831 [ease.py] => Task acc: 81.3301282051282
2024-09-07 15:15:32,851 [trainer.py] => No NME accuracy.
2024-09-07 15:15:32,851 [trainer.py] => CNN: {'total': 54.41, '00-19': 54.29, '20-39': 60.54, '40-59': 41.38, '60-79': 71.62, '80-99': 50.35, '100-119': 55.97, '120-139': 45.21, '140-159': 40.94, 'old': 55.93, 'new': 40.94}
2024-09-07 15:15:32,851 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91, 65.76, 62.66, 60.92, 56.91, 54.41]
2024-09-07 15:15:32,851 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18, 88.11, 85.26, 84.0, 81.89, 79.89]

Average Accuracy (CNN): 65.47
2024-09-07 15:15:32,852 [trainer.py] => Average Accuracy (CNN): 65.47 

2024-09-07 15:15:32,852 [trainer.py] => All params: 87101378
2024-09-07 15:15:32,853 [trainer.py] => Trainable params: 304320
2024-09-07 15:15:32,862 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.973, Train_accy 13.13:   0%|          | 0/20 [00:03<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.973, Train_accy 13.13:   5%|▌         | 1/20 [00:03<01:10,  3.71s/it]
Task 8, Epoch 2/20 => Loss 2.853, Train_accy 30.65:   5%|▌         | 1/20 [00:07<01:10,  3.71s/it]
Task 8, Epoch 2/20 => Loss 2.853, Train_accy 30.65:  10%|█         | 2/20 [00:07<01:06,  3.70s/it]
Task 8, Epoch 3/20 => Loss 2.639, Train_accy 40.63:  10%|█         | 2/20 [00:11<01:06,  3.70s/it]
Task 8, Epoch 3/20 => Loss 2.639, Train_accy 40.63:  15%|█▌        | 3/20 [00:11<01:03,  3.71s/it]
Task 8, Epoch 4/20 => Loss 2.355, Train_accy 47.81:  15%|█▌        | 3/20 [00:14<01:03,  3.71s/it]
Task 8, Epoch 4/20 => Loss 2.355, Train_accy 47.81:  20%|██        | 4/20 [00:14<00:59,  3.73s/it]
Task 8, Epoch 5/20 => Loss 2.060, Train_accy 52.71:  20%|██        | 4/20 [00:18<00:59,  3.73s/it]
Task 8, Epoch 5/20 => Loss 2.060, Train_accy 52.71:  25%|██▌       | 5/20 [00:18<00:56,  3.73s/it]
Task 8, Epoch 6/20 => Loss 1.838, Train_accy 64.10:  25%|██▌       | 5/20 [00:22<00:56,  3.73s/it]
Task 8, Epoch 6/20 => Loss 1.838, Train_accy 64.10:  30%|███       | 6/20 [00:22<00:52,  3.72s/it]
Task 8, Epoch 7/20 => Loss 1.656, Train_accy 69.00:  30%|███       | 6/20 [00:26<00:52,  3.72s/it]
Task 8, Epoch 7/20 => Loss 1.656, Train_accy 69.00:  35%|███▌      | 7/20 [00:26<00:48,  3.72s/it]
Task 8, Epoch 8/20 => Loss 1.501, Train_accy 74.26:  35%|███▌      | 7/20 [00:29<00:48,  3.72s/it]
Task 8, Epoch 8/20 => Loss 1.501, Train_accy 74.26:  40%|████      | 8/20 [00:29<00:44,  3.73s/it]
Task 8, Epoch 9/20 => Loss 1.391, Train_accy 74.96:  40%|████      | 8/20 [00:33<00:44,  3.73s/it]
Task 8, Epoch 9/20 => Loss 1.391, Train_accy 74.96:  45%|████▌     | 9/20 [00:33<00:41,  3.73s/it]
Task 8, Epoch 10/20 => Loss 1.264, Train_accy 81.09:  45%|████▌     | 9/20 [00:37<00:41,  3.73s/it]
Task 8, Epoch 10/20 => Loss 1.264, Train_accy 81.09:  50%|█████     | 10/20 [00:37<00:37,  3.74s/it]
Task 8, Epoch 11/20 => Loss 1.172, Train_accy 80.21:  50%|█████     | 10/20 [00:41<00:37,  3.74s/it]
Task 8, Epoch 11/20 => Loss 1.172, Train_accy 80.21:  55%|█████▌    | 11/20 [00:41<00:33,  3.74s/it]
Task 8, Epoch 12/20 => Loss 1.122, Train_accy 81.44:  55%|█████▌    | 11/20 [00:44<00:33,  3.74s/it]
Task 8, Epoch 12/20 => Loss 1.122, Train_accy 81.44:  60%|██████    | 12/20 [00:44<00:29,  3.74s/it]
Task 8, Epoch 13/20 => Loss 1.050, Train_accy 80.74:  60%|██████    | 12/20 [00:48<00:29,  3.74s/it]
Task 8, Epoch 13/20 => Loss 1.050, Train_accy 80.74:  65%|██████▌   | 13/20 [00:48<00:26,  3.76s/it]
Task 8, Epoch 14/20 => Loss 0.996, Train_accy 83.19:  65%|██████▌   | 13/20 [00:52<00:26,  3.76s/it]
Task 8, Epoch 14/20 => Loss 0.996, Train_accy 83.19:  70%|███████   | 14/20 [00:52<00:22,  3.75s/it]
Task 8, Epoch 15/20 => Loss 0.970, Train_accy 83.36:  70%|███████   | 14/20 [00:56<00:22,  3.75s/it]
Task 8, Epoch 15/20 => Loss 0.970, Train_accy 83.36:  75%|███████▌  | 15/20 [00:56<00:18,  3.74s/it]
Task 8, Epoch 16/20 => Loss 0.959, Train_accy 83.19:  75%|███████▌  | 15/20 [00:59<00:18,  3.74s/it]
Task 8, Epoch 16/20 => Loss 0.959, Train_accy 83.19:  80%|████████  | 16/20 [00:59<00:15,  3.76s/it]
Task 8, Epoch 17/20 => Loss 0.923, Train_accy 85.46:  80%|████████  | 16/20 [01:03<00:15,  3.76s/it]
Task 8, Epoch 17/20 => Loss 0.923, Train_accy 85.46:  85%|████████▌ | 17/20 [01:03<00:11,  3.74s/it]
Task 8, Epoch 18/20 => Loss 0.905, Train_accy 84.59:  85%|████████▌ | 17/20 [01:07<00:11,  3.74s/it]
Task 8, Epoch 18/20 => Loss 0.905, Train_accy 84.59:  90%|█████████ | 18/20 [01:07<00:07,  3.74s/it]
Task 8, Epoch 19/20 => Loss 0.927, Train_accy 86.51:  90%|█████████ | 18/20 [01:10<00:07,  3.74s/it]
Task 8, Epoch 19/20 => Loss 0.927, Train_accy 86.51:  95%|█████████▌| 19/20 [01:10<00:03,  3.74s/it]
Task 8, Epoch 20/20 => Loss 0.930, Train_accy 84.41:  95%|█████████▌| 19/20 [01:14<00:03,  3.74s/it]
Task 8, Epoch 20/20 => Loss 0.930, Train_accy 84.41: 100%|██████████| 20/20 [01:14<00:00,  3.74s/it]
Task 8, Epoch 20/20 => Loss 0.930, Train_accy 84.41: 100%|██████████| 20/20 [01:14<00:00,  3.74s/it]
2024-09-07 15:16:47,620 [ease.py] => Task 8, Epoch 20/20 => Loss 0.930, Train_accy 84.41
2024-09-07 15:17:45,105 [ease.py] => Task correct: 54.76702508960574
2024-09-07 15:17:45,105 [ease.py] => Task acc: 80.14336917562724
2024-09-07 15:17:45,130 [trainer.py] => No NME accuracy.
2024-09-07 15:17:45,130 [trainer.py] => CNN: {'total': 51.25, '00-19': 54.29, '20-39': 59.46, '40-59': 38.79, '60-79': 71.17, '80-99': 50.35, '100-119': 55.97, '120-139': 44.52, '140-159': 40.16, '160-179': 29.93, 'old': 53.77, 'new': 29.93}
2024-09-07 15:17:45,130 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91, 65.76, 62.66, 60.92, 56.91, 54.41, 51.25]
2024-09-07 15:17:45,130 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18, 88.11, 85.26, 84.0, 81.89, 79.89, 77.2]

Average Accuracy (CNN): 63.89
2024-09-07 15:17:45,131 [trainer.py] => Average Accuracy (CNN): 63.89 

2024-09-07 15:17:45,132 [trainer.py] => All params: 87362498
2024-09-07 15:17:45,132 [trainer.py] => Trainable params: 304320
2024-09-07 15:17:45,144 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.970, Train_accy 16.89:   0%|          | 0/20 [00:03<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.970, Train_accy 16.89:   5%|▌         | 1/20 [00:03<01:06,  3.50s/it]
Task 9, Epoch 2/20 => Loss 2.846, Train_accy 37.76:   5%|▌         | 1/20 [00:07<01:06,  3.50s/it]
Task 9, Epoch 2/20 => Loss 2.846, Train_accy 37.76:  10%|█         | 2/20 [00:07<01:03,  3.51s/it]
Task 9, Epoch 3/20 => Loss 2.603, Train_accy 55.79:  10%|█         | 2/20 [00:10<01:03,  3.51s/it]
Task 9, Epoch 3/20 => Loss 2.603, Train_accy 55.79:  15%|█▌        | 3/20 [00:10<00:59,  3.49s/it]
Task 9, Epoch 4/20 => Loss 2.272, Train_accy 62.24:  15%|█▌        | 3/20 [00:13<00:59,  3.49s/it]
Task 9, Epoch 4/20 => Loss 2.272, Train_accy 62.24:  20%|██        | 4/20 [00:13<00:55,  3.50s/it]
Task 9, Epoch 5/20 => Loss 1.903, Train_accy 68.69:  20%|██        | 4/20 [00:17<00:55,  3.50s/it]
Task 9, Epoch 5/20 => Loss 1.903, Train_accy 68.69:  25%|██▌       | 5/20 [00:17<00:52,  3.50s/it]
Task 9, Epoch 6/20 => Loss 1.619, Train_accy 71.54:  25%|██▌       | 5/20 [00:21<00:52,  3.50s/it]
Task 9, Epoch 6/20 => Loss 1.619, Train_accy 71.54:  30%|███       | 6/20 [00:21<00:49,  3.50s/it]
Task 9, Epoch 7/20 => Loss 1.373, Train_accy 80.27:  30%|███       | 6/20 [00:24<00:49,  3.50s/it]
Task 9, Epoch 7/20 => Loss 1.373, Train_accy 80.27:  35%|███▌      | 7/20 [00:24<00:45,  3.50s/it]
Task 9, Epoch 8/20 => Loss 1.229, Train_accy 83.87:  35%|███▌      | 7/20 [00:28<00:45,  3.50s/it]
Task 9, Epoch 8/20 => Loss 1.229, Train_accy 83.87:  40%|████      | 8/20 [00:28<00:42,  3.51s/it]
Task 9, Epoch 9/20 => Loss 1.072, Train_accy 88.24:  40%|████      | 8/20 [00:31<00:42,  3.51s/it]
Task 9, Epoch 9/20 => Loss 1.072, Train_accy 88.24:  45%|████▌     | 9/20 [00:31<00:38,  3.51s/it]
Task 9, Epoch 10/20 => Loss 0.994, Train_accy 85.77:  45%|████▌     | 9/20 [00:35<00:38,  3.51s/it]
Task 9, Epoch 10/20 => Loss 0.994, Train_accy 85.77:  50%|█████     | 10/20 [00:35<00:35,  3.51s/it]
Task 9, Epoch 11/20 => Loss 0.887, Train_accy 87.10:  50%|█████     | 10/20 [00:38<00:35,  3.51s/it]
Task 9, Epoch 11/20 => Loss 0.887, Train_accy 87.10:  55%|█████▌    | 11/20 [00:38<00:31,  3.50s/it]
Task 9, Epoch 12/20 => Loss 0.872, Train_accy 86.15:  55%|█████▌    | 11/20 [00:42<00:31,  3.50s/it]
Task 9, Epoch 12/20 => Loss 0.872, Train_accy 86.15:  60%|██████    | 12/20 [00:42<00:27,  3.50s/it]
Task 9, Epoch 13/20 => Loss 0.752, Train_accy 90.13:  60%|██████    | 12/20 [00:45<00:27,  3.50s/it]
Task 9, Epoch 13/20 => Loss 0.752, Train_accy 90.13:  65%|██████▌   | 13/20 [00:45<00:24,  3.50s/it]
Task 9, Epoch 14/20 => Loss 0.789, Train_accy 87.48:  65%|██████▌   | 13/20 [00:48<00:24,  3.50s/it]
Task 9, Epoch 14/20 => Loss 0.789, Train_accy 87.48:  70%|███████   | 14/20 [00:48<00:20,  3.48s/it]
Task 9, Epoch 15/20 => Loss 0.702, Train_accy 90.89:  70%|███████   | 14/20 [00:52<00:20,  3.48s/it]
Task 9, Epoch 15/20 => Loss 0.702, Train_accy 90.89:  75%|███████▌  | 15/20 [00:52<00:17,  3.47s/it]
Task 9, Epoch 16/20 => Loss 0.709, Train_accy 90.51:  75%|███████▌  | 15/20 [00:55<00:17,  3.47s/it]
Task 9, Epoch 16/20 => Loss 0.709, Train_accy 90.51:  80%|████████  | 16/20 [00:55<00:13,  3.47s/it]
Task 9, Epoch 17/20 => Loss 0.725, Train_accy 88.61:  80%|████████  | 16/20 [00:59<00:13,  3.47s/it]
Task 9, Epoch 17/20 => Loss 0.725, Train_accy 88.61:  85%|████████▌ | 17/20 [00:59<00:10,  3.46s/it]
Task 9, Epoch 18/20 => Loss 0.696, Train_accy 88.61:  85%|████████▌ | 17/20 [01:02<00:10,  3.46s/it]
Task 9, Epoch 18/20 => Loss 0.696, Train_accy 88.61:  90%|█████████ | 18/20 [01:02<00:06,  3.46s/it]
Task 9, Epoch 19/20 => Loss 0.708, Train_accy 88.61:  90%|█████████ | 18/20 [01:06<00:06,  3.46s/it]
Task 9, Epoch 19/20 => Loss 0.708, Train_accy 88.61:  95%|█████████▌| 19/20 [01:06<00:03,  3.47s/it]
Task 9, Epoch 20/20 => Loss 0.693, Train_accy 89.94:  95%|█████████▌| 19/20 [01:09<00:03,  3.47s/it]
Task 9, Epoch 20/20 => Loss 0.693, Train_accy 89.94: 100%|██████████| 20/20 [01:09<00:00,  3.46s/it]
Task 9, Epoch 20/20 => Loss 0.693, Train_accy 89.94: 100%|██████████| 20/20 [01:09<00:00,  3.49s/it]
2024-09-07 15:18:54,855 [ease.py] => Task 9, Epoch 20/20 => Loss 0.693, Train_accy 89.94
2024-09-07 15:20:01,455 [ease.py] => Task correct: 54.114549045424624
2024-09-07 15:20:01,455 [ease.py] => Task acc: 79.98683344305464
2024-09-07 15:20:01,479 [trainer.py] => No NME accuracy.
2024-09-07 15:20:01,480 [trainer.py] => CNN: {'total': 50.82, '00-19': 55.43, '20-39': 58.92, '40-59': 38.79, '60-79': 70.27, '80-99': 48.95, '100-119': 54.48, '120-139': 43.84, '140-159': 40.16, '160-179': 29.25, '180-199': 51.61, 'old': 50.75, 'new': 51.61}
2024-09-07 15:20:01,480 [trainer.py] => CNN top1 curve: [80.0, 74.17, 68.91, 65.76, 62.66, 60.92, 56.91, 54.41, 51.25, 50.82]
2024-09-07 15:20:01,480 [trainer.py] => CNN top5 curve: [96.57, 93.89, 91.18, 88.11, 85.26, 84.0, 81.89, 79.89, 77.2, 75.97]

Average Accuracy (CNN): 62.58
2024-09-07 15:20:01,480 [trainer.py] => Average Accuracy (CNN): 62.58 

Accuracy Matrix (CNN):
[[80.   70.29 69.14 58.29 57.71 58.86 56.   54.29 54.29 55.43]
 [ 0.   77.84 74.59 66.49 65.41 62.7  60.54 60.54 59.46 58.92]
 [ 0.    0.   59.48 50.   49.14 45.69 42.24 41.38 38.79 38.79]
 [ 0.    0.    0.   79.28 77.03 75.23 72.07 71.62 71.17 70.27]
 [ 0.    0.    0.    0.   53.85 52.45 51.75 50.35 50.35 48.95]
 [ 0.    0.    0.    0.    0.   59.7  58.21 55.97 55.97 54.48]
 [ 0.    0.    0.    0.    0.    0.   45.89 45.21 44.52 43.84]
 [ 0.    0.    0.    0.    0.    0.    0.   40.94 40.16 40.16]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   29.93 29.25]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   51.61]]
2024-09-07 15:20:01,481 [trainer.py] => Forgetting (CNN): 9.646666666666667
2024-09-07 15:20:04,290 [trainer.py] => config: ./exps/ease_ina_B0_Inc20.json
2024-09-07 15:20:04,290 [trainer.py] => prefix:  
2024-09-07 15:20:04,290 [trainer.py] => dataset: imageneta
2024-09-07 15:20:04,290 [trainer.py] => memory_size: 0
2024-09-07 15:20:04,290 [trainer.py] => memory_per_class: 0
2024-09-07 15:20:04,290 [trainer.py] => fixed_memory: False
2024-09-07 15:20:04,290 [trainer.py] => shuffle: True
2024-09-07 15:20:04,290 [trainer.py] => init_cls: 10
2024-09-07 15:20:04,290 [trainer.py] => increment: 10
2024-09-07 15:20:04,290 [trainer.py] => model_name: ease
2024-09-07 15:20:04,290 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-07 15:20:04,290 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 15:20:04,290 [trainer.py] => seed: 1993
2024-09-07 15:20:04,290 [trainer.py] => init_epochs: 20
2024-09-07 15:20:04,290 [trainer.py] => init_lr: 0.05
2024-09-07 15:20:04,290 [trainer.py] => later_epochs: 20
2024-09-07 15:20:04,290 [trainer.py] => later_lr: 0.05
2024-09-07 15:20:04,290 [trainer.py] => batch_size: 48
2024-09-07 15:20:04,290 [trainer.py] => weight_decay: 0.005
2024-09-07 15:20:04,290 [trainer.py] => min_lr: 0
2024-09-07 15:20:04,290 [trainer.py] => optimizer: sgd
2024-09-07 15:20:04,290 [trainer.py] => scheduler: cosine
2024-09-07 15:20:04,291 [trainer.py] => pretrained: True
2024-09-07 15:20:04,291 [trainer.py] => vpt_type: Deep
2024-09-07 15:20:04,291 [trainer.py] => prompt_token_num: 5
2024-09-07 15:20:04,291 [trainer.py] => ffn_num: 16
2024-09-07 15:20:04,291 [trainer.py] => use_diagonal: False
2024-09-07 15:20:04,291 [trainer.py] => recalc_sim: True
2024-09-07 15:20:04,291 [trainer.py] => alpha: 0.1
2024-09-07 15:20:04,291 [trainer.py] => use_init_ptm: False
2024-09-07 15:20:04,291 [trainer.py] => beta: 0
2024-09-07 15:20:04,291 [trainer.py] => use_old_data: False
2024-09-07 15:20:04,291 [trainer.py] => use_reweight: True
2024-09-07 15:20:04,291 [trainer.py] => moni_adam: False
2024-09-07 15:20:04,291 [trainer.py] => adapter_num: -1
2024-09-07 15:20:04,317 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-07 15:20:07,018 [trainer.py] => All params: 86102976
2024-09-07 15:20:07,019 [trainer.py] => Trainable params: 304320
2024-09-07 15:20:07,025 [ease.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.285, Train_accy 20.60:   0%|          | 0/20 [00:02<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.285, Train_accy 20.60:   5%|▌         | 1/20 [00:02<00:46,  2.47s/it]
Task 0, Epoch 2/20 => Loss 2.168, Train_accy 53.49:   5%|▌         | 1/20 [00:04<00:46,  2.47s/it]
Task 0, Epoch 2/20 => Loss 2.168, Train_accy 53.49:  10%|█         | 2/20 [00:04<00:41,  2.28s/it]
Task 0, Epoch 3/20 => Loss 2.017, Train_accy 61.13:  10%|█         | 2/20 [00:06<00:41,  2.28s/it]
Task 0, Epoch 3/20 => Loss 2.017, Train_accy 61.13:  15%|█▌        | 3/20 [00:06<00:37,  2.21s/it]
Task 0, Epoch 4/20 => Loss 1.811, Train_accy 63.46:  15%|█▌        | 3/20 [00:08<00:37,  2.21s/it]
Task 0, Epoch 4/20 => Loss 1.811, Train_accy 63.46:  20%|██        | 4/20 [00:08<00:34,  2.18s/it]
Task 0, Epoch 5/20 => Loss 1.589, Train_accy 68.44:  20%|██        | 4/20 [00:10<00:34,  2.18s/it]
Task 0, Epoch 5/20 => Loss 1.589, Train_accy 68.44:  25%|██▌       | 5/20 [00:10<00:32,  2.16s/it]
Task 0, Epoch 6/20 => Loss 1.393, Train_accy 71.76:  25%|██▌       | 5/20 [00:13<00:32,  2.16s/it]
Task 0, Epoch 6/20 => Loss 1.393, Train_accy 71.76:  30%|███       | 6/20 [00:13<00:29,  2.14s/it]
Task 0, Epoch 7/20 => Loss 1.243, Train_accy 72.76:  30%|███       | 6/20 [00:15<00:29,  2.14s/it]
Task 0, Epoch 7/20 => Loss 1.243, Train_accy 72.76:  35%|███▌      | 7/20 [00:15<00:27,  2.14s/it]
Task 0, Epoch 8/20 => Loss 1.176, Train_accy 76.08:  35%|███▌      | 7/20 [00:17<00:27,  2.14s/it]
Task 0, Epoch 8/20 => Loss 1.176, Train_accy 76.08:  40%|████      | 8/20 [00:17<00:25,  2.14s/it]
Task 0, Epoch 9/20 => Loss 1.087, Train_accy 78.41:  40%|████      | 8/20 [00:19<00:25,  2.14s/it]
Task 0, Epoch 9/20 => Loss 1.087, Train_accy 78.41:  45%|████▌     | 9/20 [00:19<00:23,  2.14s/it]
Task 0, Epoch 10/20 => Loss 1.008, Train_accy 82.72:  45%|████▌     | 9/20 [00:21<00:23,  2.14s/it]
Task 0, Epoch 10/20 => Loss 1.008, Train_accy 82.72:  50%|█████     | 10/20 [00:21<00:21,  2.14s/it]
Task 0, Epoch 11/20 => Loss 0.950, Train_accy 89.04:  50%|█████     | 10/20 [00:23<00:21,  2.14s/it]
Task 0, Epoch 11/20 => Loss 0.950, Train_accy 89.04:  55%|█████▌    | 11/20 [00:23<00:19,  2.15s/it]
Task 0, Epoch 12/20 => Loss 0.897, Train_accy 88.37:  55%|█████▌    | 11/20 [00:25<00:19,  2.15s/it]
Task 0, Epoch 12/20 => Loss 0.897, Train_accy 88.37:  60%|██████    | 12/20 [00:25<00:17,  2.15s/it]
Task 0, Epoch 13/20 => Loss 0.839, Train_accy 89.70:  60%|██████    | 12/20 [00:28<00:17,  2.15s/it]
Task 0, Epoch 13/20 => Loss 0.839, Train_accy 89.70:  65%|██████▌   | 13/20 [00:28<00:15,  2.16s/it]
Task 0, Epoch 14/20 => Loss 0.843, Train_accy 90.37:  65%|██████▌   | 13/20 [00:30<00:15,  2.16s/it]
Task 0, Epoch 14/20 => Loss 0.843, Train_accy 90.37:  70%|███████   | 14/20 [00:30<00:12,  2.15s/it]
Task 0, Epoch 15/20 => Loss 0.827, Train_accy 89.70:  70%|███████   | 14/20 [00:32<00:12,  2.15s/it]
Task 0, Epoch 15/20 => Loss 0.827, Train_accy 89.70:  75%|███████▌  | 15/20 [00:32<00:10,  2.14s/it]
Task 0, Epoch 16/20 => Loss 0.760, Train_accy 91.36:  75%|███████▌  | 15/20 [00:34<00:10,  2.14s/it]
Task 0, Epoch 16/20 => Loss 0.760, Train_accy 91.36:  80%|████████  | 16/20 [00:34<00:08,  2.13s/it]
Task 0, Epoch 17/20 => Loss 0.767, Train_accy 90.70:  80%|████████  | 16/20 [00:36<00:08,  2.13s/it]
Task 0, Epoch 17/20 => Loss 0.767, Train_accy 90.70:  85%|████████▌ | 17/20 [00:36<00:06,  2.13s/it]
Task 0, Epoch 18/20 => Loss 0.747, Train_accy 92.69:  85%|████████▌ | 17/20 [00:38<00:06,  2.13s/it]
Task 0, Epoch 18/20 => Loss 0.747, Train_accy 92.69:  90%|█████████ | 18/20 [00:38<00:04,  2.12s/it]
Task 0, Epoch 19/20 => Loss 0.713, Train_accy 92.69:  90%|█████████ | 18/20 [00:40<00:04,  2.12s/it]
Task 0, Epoch 19/20 => Loss 0.713, Train_accy 92.69:  95%|█████████▌| 19/20 [00:40<00:02,  2.12s/it]
Task 0, Epoch 20/20 => Loss 0.748, Train_accy 92.03:  95%|█████████▌| 19/20 [00:42<00:02,  2.12s/it]
Task 0, Epoch 20/20 => Loss 0.748, Train_accy 92.03: 100%|██████████| 20/20 [00:42<00:00,  2.11s/it]
Task 0, Epoch 20/20 => Loss 0.748, Train_accy 92.03: 100%|██████████| 20/20 [00:42<00:00,  2.15s/it]
2024-09-07 15:20:50,070 [ease.py] => Task 0, Epoch 20/20 => Loss 0.748, Train_accy 92.03
2024-09-07 15:20:52,088 [ease.py] => Task correct: 100.0
2024-09-07 15:20:52,089 [ease.py] => Task acc: 81.81818181818181
2024-09-07 15:20:52,110 [trainer.py] => No NME accuracy.
2024-09-07 15:20:52,110 [trainer.py] => CNN: {'total': 81.82, '00-09': 81.82, 'old': 0, 'new': 81.82}
2024-09-07 15:20:52,110 [trainer.py] => CNN top1 curve: [81.82]
2024-09-07 15:20:52,110 [trainer.py] => CNN top5 curve: [96.1]

Average Accuracy (CNN): 81.82
2024-09-07 15:20:52,110 [trainer.py] => Average Accuracy (CNN): 81.82 

2024-09-07 15:20:52,111 [trainer.py] => All params: 86118338
2024-09-07 15:20:52,112 [trainer.py] => Trainable params: 304320
2024-09-07 15:20:52,113 [ease.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.250, Train_accy 32.67:   0%|          | 0/20 [00:02<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.250, Train_accy 32.67:   5%|▌         | 1/20 [00:02<00:51,  2.71s/it]
Task 1, Epoch 2/20 => Loss 2.049, Train_accy 61.63:   5%|▌         | 1/20 [00:05<00:51,  2.71s/it]
Task 1, Epoch 2/20 => Loss 2.049, Train_accy 61.63:  10%|█         | 2/20 [00:05<00:49,  2.72s/it]
Task 1, Epoch 3/20 => Loss 1.765, Train_accy 70.05:  10%|█         | 2/20 [00:08<00:49,  2.72s/it]
Task 1, Epoch 3/20 => Loss 1.765, Train_accy 70.05:  15%|█▌        | 3/20 [00:08<00:46,  2.75s/it]
Task 1, Epoch 4/20 => Loss 1.471, Train_accy 69.06:  15%|█▌        | 3/20 [00:10<00:46,  2.75s/it]
Task 1, Epoch 4/20 => Loss 1.471, Train_accy 69.06:  20%|██        | 4/20 [00:10<00:43,  2.74s/it]
Task 1, Epoch 5/20 => Loss 1.234, Train_accy 74.50:  20%|██        | 4/20 [00:13<00:43,  2.74s/it]
Task 1, Epoch 5/20 => Loss 1.234, Train_accy 74.50:  25%|██▌       | 5/20 [00:13<00:41,  2.73s/it]
Task 1, Epoch 6/20 => Loss 1.060, Train_accy 78.71:  25%|██▌       | 5/20 [00:16<00:41,  2.73s/it]
Task 1, Epoch 6/20 => Loss 1.060, Train_accy 78.71:  30%|███       | 6/20 [00:16<00:38,  2.73s/it]
Task 1, Epoch 7/20 => Loss 0.917, Train_accy 82.92:  30%|███       | 6/20 [00:19<00:38,  2.73s/it]
Task 1, Epoch 7/20 => Loss 0.917, Train_accy 82.92:  35%|███▌      | 7/20 [00:19<00:35,  2.74s/it]
Task 1, Epoch 8/20 => Loss 0.829, Train_accy 87.87:  35%|███▌      | 7/20 [00:21<00:35,  2.74s/it]
Task 1, Epoch 8/20 => Loss 0.829, Train_accy 87.87:  40%|████      | 8/20 [00:21<00:32,  2.74s/it]
Task 1, Epoch 9/20 => Loss 0.755, Train_accy 90.35:  40%|████      | 8/20 [00:24<00:32,  2.74s/it]
Task 1, Epoch 9/20 => Loss 0.755, Train_accy 90.35:  45%|████▌     | 9/20 [00:24<00:30,  2.74s/it]
Task 1, Epoch 10/20 => Loss 0.682, Train_accy 91.83:  45%|████▌     | 9/20 [00:27<00:30,  2.74s/it]
Task 1, Epoch 10/20 => Loss 0.682, Train_accy 91.83:  50%|█████     | 10/20 [00:27<00:27,  2.73s/it]
Task 1, Epoch 11/20 => Loss 0.625, Train_accy 92.33:  50%|█████     | 10/20 [00:30<00:27,  2.73s/it]
Task 1, Epoch 11/20 => Loss 0.625, Train_accy 92.33:  55%|█████▌    | 11/20 [00:30<00:24,  2.74s/it]
Task 1, Epoch 12/20 => Loss 0.597, Train_accy 90.84:  55%|█████▌    | 11/20 [00:32<00:24,  2.74s/it]
Task 1, Epoch 12/20 => Loss 0.597, Train_accy 90.84:  60%|██████    | 12/20 [00:32<00:21,  2.74s/it]
Task 1, Epoch 13/20 => Loss 0.576, Train_accy 91.09:  60%|██████    | 12/20 [00:35<00:21,  2.74s/it]
Task 1, Epoch 13/20 => Loss 0.576, Train_accy 91.09:  65%|██████▌   | 13/20 [00:35<00:19,  2.75s/it]
Task 1, Epoch 14/20 => Loss 0.549, Train_accy 91.58:  65%|██████▌   | 13/20 [00:38<00:19,  2.75s/it]
Task 1, Epoch 14/20 => Loss 0.549, Train_accy 91.58:  70%|███████   | 14/20 [00:38<00:16,  2.76s/it]
Task 1, Epoch 15/20 => Loss 0.552, Train_accy 90.10:  70%|███████   | 14/20 [00:41<00:16,  2.76s/it]
Task 1, Epoch 15/20 => Loss 0.552, Train_accy 90.10:  75%|███████▌  | 15/20 [00:41<00:13,  2.75s/it]
Task 1, Epoch 16/20 => Loss 0.513, Train_accy 92.08:  75%|███████▌  | 15/20 [00:43<00:13,  2.75s/it]
Task 1, Epoch 16/20 => Loss 0.513, Train_accy 92.08:  80%|████████  | 16/20 [00:43<00:10,  2.74s/it]
Task 1, Epoch 17/20 => Loss 0.539, Train_accy 92.08:  80%|████████  | 16/20 [00:46<00:10,  2.74s/it]
Task 1, Epoch 17/20 => Loss 0.539, Train_accy 92.08:  85%|████████▌ | 17/20 [00:46<00:08,  2.74s/it]
Task 1, Epoch 18/20 => Loss 0.558, Train_accy 90.35:  85%|████████▌ | 17/20 [00:49<00:08,  2.74s/it]
Task 1, Epoch 18/20 => Loss 0.558, Train_accy 90.35:  90%|█████████ | 18/20 [00:49<00:05,  2.74s/it]
Task 1, Epoch 19/20 => Loss 0.523, Train_accy 90.84:  90%|█████████ | 18/20 [00:52<00:05,  2.74s/it]
Task 1, Epoch 19/20 => Loss 0.523, Train_accy 90.84:  95%|█████████▌| 19/20 [00:52<00:02,  2.73s/it]
Task 1, Epoch 20/20 => Loss 0.495, Train_accy 93.07:  95%|█████████▌| 19/20 [00:54<00:02,  2.73s/it]
Task 1, Epoch 20/20 => Loss 0.495, Train_accy 93.07: 100%|██████████| 20/20 [00:54<00:00,  2.73s/it]
Task 1, Epoch 20/20 => Loss 0.495, Train_accy 93.07: 100%|██████████| 20/20 [00:54<00:00,  2.74s/it]
2024-09-07 15:21:46,901 [ease.py] => Task 1, Epoch 20/20 => Loss 0.495, Train_accy 93.07
2024-09-07 15:21:51,914 [ease.py] => Task correct: 84.0
2024-09-07 15:21:51,915 [ease.py] => Task acc: 86.85714285714286
2024-09-07 15:21:52,010 [trainer.py] => No NME accuracy.
2024-09-07 15:21:52,010 [trainer.py] => CNN: {'total': 74.86, '00-09': 62.34, '10-19': 84.69, 'old': 62.34, 'new': 84.69}
2024-09-07 15:21:52,010 [trainer.py] => CNN top1 curve: [81.82, 74.86]
2024-09-07 15:21:52,010 [trainer.py] => CNN top5 curve: [96.1, 96.0]

Average Accuracy (CNN): 78.34
2024-09-07 15:21:52,010 [trainer.py] => Average Accuracy (CNN): 78.34 

2024-09-07 15:21:52,011 [trainer.py] => All params: 86141378
2024-09-07 15:21:52,011 [trainer.py] => Trainable params: 304320
2024-09-07 15:21:52,012 [ease.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.288, Train_accy 14.60:   0%|          | 0/20 [00:02<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.288, Train_accy 14.60:   5%|▌         | 1/20 [00:02<00:47,  2.48s/it]
Task 2, Epoch 2/20 => Loss 2.204, Train_accy 51.52:   5%|▌         | 1/20 [00:05<00:47,  2.48s/it]
Task 2, Epoch 2/20 => Loss 2.204, Train_accy 51.52:  10%|█         | 2/20 [00:05<00:45,  2.51s/it]
Task 2, Epoch 3/20 => Loss 2.076, Train_accy 61.71:  10%|█         | 2/20 [00:07<00:45,  2.51s/it]
Task 2, Epoch 3/20 => Loss 2.076, Train_accy 61.71:  15%|█▌        | 3/20 [00:07<00:42,  2.53s/it]
Task 2, Epoch 4/20 => Loss 1.896, Train_accy 67.22:  15%|█▌        | 3/20 [00:10<00:42,  2.53s/it]
Task 2, Epoch 4/20 => Loss 1.896, Train_accy 67.22:  20%|██        | 4/20 [00:10<00:40,  2.53s/it]
Task 2, Epoch 5/20 => Loss 1.703, Train_accy 69.42:  20%|██        | 4/20 [00:12<00:40,  2.53s/it]
Task 2, Epoch 5/20 => Loss 1.703, Train_accy 69.42:  25%|██▌       | 5/20 [00:12<00:37,  2.52s/it]
Task 2, Epoch 6/20 => Loss 1.516, Train_accy 72.73:  25%|██▌       | 5/20 [00:15<00:37,  2.52s/it]
Task 2, Epoch 6/20 => Loss 1.516, Train_accy 72.73:  30%|███       | 6/20 [00:15<00:35,  2.52s/it]
Task 2, Epoch 7/20 => Loss 1.378, Train_accy 74.10:  30%|███       | 6/20 [00:17<00:35,  2.52s/it]
Task 2, Epoch 7/20 => Loss 1.378, Train_accy 74.10:  35%|███▌      | 7/20 [00:17<00:32,  2.52s/it]
Task 2, Epoch 8/20 => Loss 1.281, Train_accy 79.89:  35%|███▌      | 7/20 [00:20<00:32,  2.52s/it]
Task 2, Epoch 8/20 => Loss 1.281, Train_accy 79.89:  40%|████      | 8/20 [00:20<00:30,  2.52s/it]
Task 2, Epoch 9/20 => Loss 1.182, Train_accy 83.20:  40%|████      | 8/20 [00:22<00:30,  2.52s/it]
Task 2, Epoch 9/20 => Loss 1.182, Train_accy 83.20:  45%|████▌     | 9/20 [00:22<00:27,  2.51s/it]
Task 2, Epoch 10/20 => Loss 1.108, Train_accy 82.92:  45%|████▌     | 9/20 [00:25<00:27,  2.51s/it]
Task 2, Epoch 10/20 => Loss 1.108, Train_accy 82.92:  50%|█████     | 10/20 [00:25<00:25,  2.51s/it]
Task 2, Epoch 11/20 => Loss 1.059, Train_accy 84.57:  50%|█████     | 10/20 [00:27<00:25,  2.51s/it]
Task 2, Epoch 11/20 => Loss 1.059, Train_accy 84.57:  55%|█████▌    | 11/20 [00:27<00:22,  2.51s/it]
Task 2, Epoch 12/20 => Loss 0.993, Train_accy 86.23:  55%|█████▌    | 11/20 [00:30<00:22,  2.51s/it]
Task 2, Epoch 12/20 => Loss 0.993, Train_accy 86.23:  60%|██████    | 12/20 [00:30<00:20,  2.50s/it]
Task 2, Epoch 13/20 => Loss 0.960, Train_accy 87.05:  60%|██████    | 12/20 [00:32<00:20,  2.50s/it]
Task 2, Epoch 13/20 => Loss 0.960, Train_accy 87.05:  65%|██████▌   | 13/20 [00:32<00:17,  2.52s/it]
Task 2, Epoch 14/20 => Loss 0.877, Train_accy 89.26:  65%|██████▌   | 13/20 [00:35<00:17,  2.52s/it]
Task 2, Epoch 14/20 => Loss 0.877, Train_accy 89.26:  70%|███████   | 14/20 [00:35<00:15,  2.53s/it]
Task 2, Epoch 15/20 => Loss 0.925, Train_accy 85.95:  70%|███████   | 14/20 [00:37<00:15,  2.53s/it]
Task 2, Epoch 15/20 => Loss 0.925, Train_accy 85.95:  75%|███████▌  | 15/20 [00:37<00:12,  2.53s/it]
Task 2, Epoch 16/20 => Loss 0.881, Train_accy 87.60:  75%|███████▌  | 15/20 [00:40<00:12,  2.53s/it]
Task 2, Epoch 16/20 => Loss 0.881, Train_accy 87.60:  80%|████████  | 16/20 [00:40<00:10,  2.52s/it]
Task 2, Epoch 17/20 => Loss 0.889, Train_accy 87.33:  80%|████████  | 16/20 [00:42<00:10,  2.52s/it]
Task 2, Epoch 17/20 => Loss 0.889, Train_accy 87.33:  85%|████████▌ | 17/20 [00:42<00:07,  2.51s/it]
Task 2, Epoch 18/20 => Loss 0.860, Train_accy 86.78:  85%|████████▌ | 17/20 [00:45<00:07,  2.51s/it]
Task 2, Epoch 18/20 => Loss 0.860, Train_accy 86.78:  90%|█████████ | 18/20 [00:45<00:05,  2.54s/it]
Task 2, Epoch 19/20 => Loss 0.838, Train_accy 90.08:  90%|█████████ | 18/20 [00:47<00:05,  2.54s/it]
Task 2, Epoch 19/20 => Loss 0.838, Train_accy 90.08:  95%|█████████▌| 19/20 [00:47<00:02,  2.54s/it]
Task 2, Epoch 20/20 => Loss 0.840, Train_accy 90.08:  95%|█████████▌| 19/20 [00:50<00:02,  2.54s/it]
Task 2, Epoch 20/20 => Loss 0.840, Train_accy 90.08: 100%|██████████| 20/20 [00:50<00:00,  2.53s/it]
Task 2, Epoch 20/20 => Loss 0.840, Train_accy 90.08: 100%|██████████| 20/20 [00:50<00:00,  2.52s/it]
2024-09-07 15:22:42,450 [ease.py] => Task 2, Epoch 20/20 => Loss 0.840, Train_accy 90.08
2024-09-07 15:22:49,962 [ease.py] => Task correct: 78.83211678832117
2024-09-07 15:22:49,963 [ease.py] => Task acc: 87.5912408759124
2024-09-07 15:22:49,980 [trainer.py] => No NME accuracy.
2024-09-07 15:22:49,980 [trainer.py] => CNN: {'total': 73.36, '00-09': 62.34, '10-19': 82.65, '20-29': 72.73, 'old': 73.71, 'new': 72.73}
2024-09-07 15:22:49,980 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36]
2024-09-07 15:22:49,980 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43]

Average Accuracy (CNN): 76.68
2024-09-07 15:22:49,980 [trainer.py] => Average Accuracy (CNN): 76.68 

2024-09-07 15:22:49,981 [trainer.py] => All params: 86179778
2024-09-07 15:22:49,982 [trainer.py] => Trainable params: 304320
2024-09-07 15:22:49,983 [ease.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.276, Train_accy 19.60:   0%|          | 0/20 [00:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.276, Train_accy 19.60:   5%|▌         | 1/20 [00:02<00:52,  2.74s/it]
Task 3, Epoch 2/20 => Loss 2.126, Train_accy 41.94:   5%|▌         | 1/20 [00:05<00:52,  2.74s/it]
Task 3, Epoch 2/20 => Loss 2.126, Train_accy 41.94:  10%|█         | 2/20 [00:05<00:49,  2.73s/it]
Task 3, Epoch 3/20 => Loss 1.891, Train_accy 53.10:  10%|█         | 2/20 [00:08<00:49,  2.73s/it]
Task 3, Epoch 3/20 => Loss 1.891, Train_accy 53.10:  15%|█▌        | 3/20 [00:08<00:46,  2.73s/it]
Task 3, Epoch 4/20 => Loss 1.665, Train_accy 60.05:  15%|█▌        | 3/20 [00:10<00:46,  2.73s/it]
Task 3, Epoch 4/20 => Loss 1.665, Train_accy 60.05:  20%|██        | 4/20 [00:10<00:43,  2.72s/it]
Task 3, Epoch 5/20 => Loss 1.443, Train_accy 66.50:  20%|██        | 4/20 [00:13<00:43,  2.72s/it]
Task 3, Epoch 5/20 => Loss 1.443, Train_accy 66.50:  25%|██▌       | 5/20 [00:13<00:41,  2.74s/it]
Task 3, Epoch 6/20 => Loss 1.306, Train_accy 72.21:  25%|██▌       | 5/20 [00:16<00:41,  2.74s/it]
Task 3, Epoch 6/20 => Loss 1.306, Train_accy 72.21:  30%|███       | 6/20 [00:16<00:38,  2.73s/it]
Task 3, Epoch 7/20 => Loss 1.159, Train_accy 78.16:  30%|███       | 6/20 [00:19<00:38,  2.73s/it]
Task 3, Epoch 7/20 => Loss 1.159, Train_accy 78.16:  35%|███▌      | 7/20 [00:19<00:35,  2.73s/it]
Task 3, Epoch 8/20 => Loss 1.045, Train_accy 83.62:  35%|███▌      | 7/20 [00:21<00:35,  2.73s/it]
Task 3, Epoch 8/20 => Loss 1.045, Train_accy 83.62:  40%|████      | 8/20 [00:21<00:32,  2.73s/it]
Task 3, Epoch 9/20 => Loss 0.964, Train_accy 85.86:  40%|████      | 8/20 [00:24<00:32,  2.73s/it]
Task 3, Epoch 9/20 => Loss 0.964, Train_accy 85.86:  45%|████▌     | 9/20 [00:24<00:29,  2.72s/it]
Task 3, Epoch 10/20 => Loss 0.879, Train_accy 85.61:  45%|████▌     | 9/20 [00:27<00:29,  2.72s/it]
Task 3, Epoch 10/20 => Loss 0.879, Train_accy 85.61:  50%|█████     | 10/20 [00:27<00:27,  2.72s/it]
Task 3, Epoch 11/20 => Loss 0.808, Train_accy 86.85:  50%|█████     | 10/20 [00:30<00:27,  2.72s/it]
Task 3, Epoch 11/20 => Loss 0.808, Train_accy 86.85:  55%|█████▌    | 11/20 [00:30<00:24,  2.73s/it]
Task 3, Epoch 12/20 => Loss 0.780, Train_accy 89.33:  55%|█████▌    | 11/20 [00:32<00:24,  2.73s/it]
Task 3, Epoch 12/20 => Loss 0.780, Train_accy 89.33:  60%|██████    | 12/20 [00:32<00:21,  2.72s/it]
Task 3, Epoch 13/20 => Loss 0.750, Train_accy 88.09:  60%|██████    | 12/20 [00:35<00:21,  2.72s/it]
Task 3, Epoch 13/20 => Loss 0.750, Train_accy 88.09:  65%|██████▌   | 13/20 [00:35<00:19,  2.72s/it]
Task 3, Epoch 14/20 => Loss 0.722, Train_accy 87.10:  65%|██████▌   | 13/20 [00:38<00:19,  2.72s/it]
Task 3, Epoch 14/20 => Loss 0.722, Train_accy 87.10:  70%|███████   | 14/20 [00:38<00:16,  2.72s/it]
Task 3, Epoch 15/20 => Loss 0.726, Train_accy 86.10:  70%|███████   | 14/20 [00:40<00:16,  2.72s/it]
Task 3, Epoch 15/20 => Loss 0.726, Train_accy 86.10:  75%|███████▌  | 15/20 [00:40<00:13,  2.72s/it]
Task 3, Epoch 16/20 => Loss 0.676, Train_accy 89.08:  75%|███████▌  | 15/20 [00:43<00:13,  2.72s/it]
Task 3, Epoch 16/20 => Loss 0.676, Train_accy 89.08:  80%|████████  | 16/20 [00:43<00:10,  2.72s/it]
Task 3, Epoch 17/20 => Loss 0.700, Train_accy 87.84:  80%|████████  | 16/20 [00:46<00:10,  2.72s/it]
Task 3, Epoch 17/20 => Loss 0.700, Train_accy 87.84:  85%|████████▌ | 17/20 [00:46<00:08,  2.72s/it]
Task 3, Epoch 18/20 => Loss 0.637, Train_accy 90.82:  85%|████████▌ | 17/20 [00:48<00:08,  2.72s/it]
Task 3, Epoch 18/20 => Loss 0.637, Train_accy 90.82:  90%|█████████ | 18/20 [00:48<00:05,  2.71s/it]
Task 3, Epoch 19/20 => Loss 0.676, Train_accy 88.09:  90%|█████████ | 18/20 [00:51<00:05,  2.71s/it]
Task 3, Epoch 19/20 => Loss 0.676, Train_accy 88.09:  95%|█████████▌| 19/20 [00:51<00:02,  2.72s/it]
Task 3, Epoch 20/20 => Loss 0.643, Train_accy 91.07:  95%|█████████▌| 19/20 [00:54<00:02,  2.72s/it]
Task 3, Epoch 20/20 => Loss 0.643, Train_accy 91.07: 100%|██████████| 20/20 [00:54<00:00,  2.71s/it]
Task 3, Epoch 20/20 => Loss 0.643, Train_accy 91.07: 100%|██████████| 20/20 [00:54<00:00,  2.72s/it]
2024-09-07 15:23:44,417 [ease.py] => Task 3, Epoch 20/20 => Loss 0.643, Train_accy 91.07
2024-09-07 15:23:55,618 [ease.py] => Task correct: 76.38888888888889
2024-09-07 15:23:55,619 [ease.py] => Task acc: 87.22222222222223
2024-09-07 15:23:55,642 [trainer.py] => No NME accuracy.
2024-09-07 15:23:55,642 [trainer.py] => CNN: {'total': 70.56, '00-09': 57.14, '10-19': 78.57, '20-29': 71.72, '30-39': 72.09, 'old': 70.07, 'new': 72.09}
2024-09-07 15:23:55,642 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56]
2024-09-07 15:23:55,642 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5]

Average Accuracy (CNN): 75.15
2024-09-07 15:23:55,642 [trainer.py] => Average Accuracy (CNN): 75.15 

2024-09-07 15:23:55,643 [trainer.py] => All params: 86233538
2024-09-07 15:23:55,643 [trainer.py] => Trainable params: 304320
2024-09-07 15:23:55,646 [ease.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.297, Train_accy 14.02:   0%|          | 0/20 [00:01<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.297, Train_accy 14.02:   5%|▌         | 1/20 [00:01<00:37,  1.97s/it]
Task 4, Epoch 2/20 => Loss 2.206, Train_accy 46.86:   5%|▌         | 1/20 [00:03<00:37,  1.97s/it]
Task 4, Epoch 2/20 => Loss 2.206, Train_accy 46.86:  10%|█         | 2/20 [00:03<00:35,  1.95s/it]
Task 4, Epoch 3/20 => Loss 2.080, Train_accy 52.40:  10%|█         | 2/20 [00:05<00:35,  1.95s/it]
Task 4, Epoch 3/20 => Loss 2.080, Train_accy 52.40:  15%|█▌        | 3/20 [00:05<00:33,  1.95s/it]
Task 4, Epoch 4/20 => Loss 1.912, Train_accy 58.67:  15%|█▌        | 3/20 [00:07<00:33,  1.95s/it]
Task 4, Epoch 4/20 => Loss 1.912, Train_accy 58.67:  20%|██        | 4/20 [00:07<00:31,  1.96s/it]
Task 4, Epoch 5/20 => Loss 1.746, Train_accy 66.05:  20%|██        | 4/20 [00:09<00:31,  1.96s/it]
Task 4, Epoch 5/20 => Loss 1.746, Train_accy 66.05:  25%|██▌       | 5/20 [00:09<00:29,  1.96s/it]
Task 4, Epoch 6/20 => Loss 1.574, Train_accy 66.79:  25%|██▌       | 5/20 [00:11<00:29,  1.96s/it]
Task 4, Epoch 6/20 => Loss 1.574, Train_accy 66.79:  30%|███       | 6/20 [00:11<00:27,  1.97s/it]
Task 4, Epoch 7/20 => Loss 1.405, Train_accy 68.63:  30%|███       | 6/20 [00:13<00:27,  1.97s/it]
Task 4, Epoch 7/20 => Loss 1.405, Train_accy 68.63:  35%|███▌      | 7/20 [00:13<00:25,  1.97s/it]
Task 4, Epoch 8/20 => Loss 1.258, Train_accy 73.06:  35%|███▌      | 7/20 [00:15<00:25,  1.97s/it]
Task 4, Epoch 8/20 => Loss 1.258, Train_accy 73.06:  40%|████      | 8/20 [00:15<00:23,  1.99s/it]
Task 4, Epoch 9/20 => Loss 1.212, Train_accy 72.32:  40%|████      | 8/20 [00:17<00:23,  1.99s/it]
Task 4, Epoch 9/20 => Loss 1.212, Train_accy 72.32:  45%|████▌     | 9/20 [00:17<00:21,  1.99s/it]
Task 4, Epoch 10/20 => Loss 1.125, Train_accy 77.49:  45%|████▌     | 9/20 [00:19<00:21,  1.99s/it]
Task 4, Epoch 10/20 => Loss 1.125, Train_accy 77.49:  50%|█████     | 10/20 [00:19<00:19,  1.98s/it]
Task 4, Epoch 11/20 => Loss 1.024, Train_accy 83.39:  50%|█████     | 10/20 [00:21<00:19,  1.98s/it]
Task 4, Epoch 11/20 => Loss 1.024, Train_accy 83.39:  55%|█████▌    | 11/20 [00:21<00:17,  1.97s/it]
Task 4, Epoch 12/20 => Loss 1.000, Train_accy 82.29:  55%|█████▌    | 11/20 [00:23<00:17,  1.97s/it]
Task 4, Epoch 12/20 => Loss 1.000, Train_accy 82.29:  60%|██████    | 12/20 [00:23<00:15,  1.96s/it]
Task 4, Epoch 13/20 => Loss 0.986, Train_accy 81.92:  60%|██████    | 12/20 [00:25<00:15,  1.96s/it]
Task 4, Epoch 13/20 => Loss 0.986, Train_accy 81.92:  65%|██████▌   | 13/20 [00:25<00:13,  1.97s/it]
Task 4, Epoch 14/20 => Loss 0.962, Train_accy 83.39:  65%|██████▌   | 13/20 [00:27<00:13,  1.97s/it]
Task 4, Epoch 14/20 => Loss 0.962, Train_accy 83.39:  70%|███████   | 14/20 [00:27<00:11,  1.97s/it]
Task 4, Epoch 15/20 => Loss 0.906, Train_accy 85.61:  70%|███████   | 14/20 [00:29<00:11,  1.97s/it]
Task 4, Epoch 15/20 => Loss 0.906, Train_accy 85.61:  75%|███████▌  | 15/20 [00:29<00:09,  1.96s/it]
Task 4, Epoch 16/20 => Loss 0.935, Train_accy 86.72:  75%|███████▌  | 15/20 [00:31<00:09,  1.96s/it]
Task 4, Epoch 16/20 => Loss 0.935, Train_accy 86.72:  80%|████████  | 16/20 [00:31<00:07,  1.96s/it]
Task 4, Epoch 17/20 => Loss 0.875, Train_accy 88.19:  80%|████████  | 16/20 [00:33<00:07,  1.96s/it]
Task 4, Epoch 17/20 => Loss 0.875, Train_accy 88.19:  85%|████████▌ | 17/20 [00:33<00:05,  1.95s/it]
Task 4, Epoch 18/20 => Loss 0.892, Train_accy 88.56:  85%|████████▌ | 17/20 [00:35<00:05,  1.95s/it]
Task 4, Epoch 18/20 => Loss 0.892, Train_accy 88.56:  90%|█████████ | 18/20 [00:35<00:03,  1.95s/it]
Task 4, Epoch 19/20 => Loss 0.859, Train_accy 90.77:  90%|█████████ | 18/20 [00:37<00:03,  1.95s/it]
Task 4, Epoch 19/20 => Loss 0.859, Train_accy 90.77:  95%|█████████▌| 19/20 [00:37<00:01,  1.95s/it]
Task 4, Epoch 20/20 => Loss 0.888, Train_accy 89.67:  95%|█████████▌| 19/20 [00:39<00:01,  1.95s/it]
Task 4, Epoch 20/20 => Loss 0.888, Train_accy 89.67: 100%|██████████| 20/20 [00:39<00:00,  1.95s/it]
Task 4, Epoch 20/20 => Loss 0.888, Train_accy 89.67: 100%|██████████| 20/20 [00:39<00:00,  1.96s/it]
2024-09-07 15:24:34,920 [ease.py] => Task 4, Epoch 20/20 => Loss 0.888, Train_accy 89.67
2024-09-07 15:24:47,786 [ease.py] => Task correct: 68.63207547169812
2024-09-07 15:24:47,787 [ease.py] => Task acc: 87.73584905660377
2024-09-07 15:24:47,809 [trainer.py] => No NME accuracy.
2024-09-07 15:24:47,809 [trainer.py] => CNN: {'total': 63.68, '00-09': 42.86, '10-19': 77.55, '20-29': 54.55, '30-39': 65.12, '40-49': 79.69, 'old': 60.83, 'new': 79.69}
2024-09-07 15:24:47,809 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68]
2024-09-07 15:24:47,809 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44]

Average Accuracy (CNN): 72.86
2024-09-07 15:24:47,809 [trainer.py] => Average Accuracy (CNN): 72.86 

2024-09-07 15:24:47,810 [trainer.py] => All params: 86302658
2024-09-07 15:24:47,810 [trainer.py] => Trainable params: 304320
2024-09-07 15:24:47,814 [ease.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.278, Train_accy 30.42:   0%|          | 0/20 [00:01<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.278, Train_accy 30.42:   5%|▌         | 1/20 [00:01<00:33,  1.78s/it]
Task 5, Epoch 2/20 => Loss 2.186, Train_accy 51.67:   5%|▌         | 1/20 [00:03<00:33,  1.78s/it]
Task 5, Epoch 2/20 => Loss 2.186, Train_accy 51.67:  10%|█         | 2/20 [00:03<00:31,  1.76s/it]
Task 5, Epoch 3/20 => Loss 2.063, Train_accy 52.92:  10%|█         | 2/20 [00:05<00:31,  1.76s/it]
Task 5, Epoch 3/20 => Loss 2.063, Train_accy 52.92:  15%|█▌        | 3/20 [00:05<00:29,  1.75s/it]
Task 5, Epoch 4/20 => Loss 1.914, Train_accy 54.58:  15%|█▌        | 3/20 [00:07<00:29,  1.75s/it]
Task 5, Epoch 4/20 => Loss 1.914, Train_accy 54.58:  20%|██        | 4/20 [00:07<00:27,  1.75s/it]
Task 5, Epoch 5/20 => Loss 1.748, Train_accy 57.92:  20%|██        | 4/20 [00:08<00:27,  1.75s/it]
Task 5, Epoch 5/20 => Loss 1.748, Train_accy 57.92:  25%|██▌       | 5/20 [00:08<00:26,  1.75s/it]
Task 5, Epoch 6/20 => Loss 1.588, Train_accy 61.67:  25%|██▌       | 5/20 [00:10<00:26,  1.75s/it]
Task 5, Epoch 6/20 => Loss 1.588, Train_accy 61.67:  30%|███       | 6/20 [00:10<00:24,  1.75s/it]
Task 5, Epoch 7/20 => Loss 1.433, Train_accy 67.08:  30%|███       | 6/20 [00:12<00:24,  1.75s/it]
Task 5, Epoch 7/20 => Loss 1.433, Train_accy 67.08:  35%|███▌      | 7/20 [00:12<00:22,  1.75s/it]
Task 5, Epoch 8/20 => Loss 1.324, Train_accy 71.67:  35%|███▌      | 7/20 [00:13<00:22,  1.75s/it]
Task 5, Epoch 8/20 => Loss 1.324, Train_accy 71.67:  40%|████      | 8/20 [00:13<00:20,  1.75s/it]
Task 5, Epoch 9/20 => Loss 1.236, Train_accy 75.00:  40%|████      | 8/20 [00:15<00:20,  1.75s/it]
Task 5, Epoch 9/20 => Loss 1.236, Train_accy 75.00:  45%|████▌     | 9/20 [00:15<00:19,  1.75s/it]
Task 5, Epoch 10/20 => Loss 1.134, Train_accy 81.25:  45%|████▌     | 9/20 [00:17<00:19,  1.75s/it]
Task 5, Epoch 10/20 => Loss 1.134, Train_accy 81.25:  50%|█████     | 10/20 [00:17<00:17,  1.75s/it]
Task 5, Epoch 11/20 => Loss 1.057, Train_accy 81.67:  50%|█████     | 10/20 [00:19<00:17,  1.75s/it]
Task 5, Epoch 11/20 => Loss 1.057, Train_accy 81.67:  55%|█████▌    | 11/20 [00:19<00:15,  1.75s/it]
Task 5, Epoch 12/20 => Loss 1.040, Train_accy 83.75:  55%|█████▌    | 11/20 [00:20<00:15,  1.75s/it]
Task 5, Epoch 12/20 => Loss 1.040, Train_accy 83.75:  60%|██████    | 12/20 [00:20<00:13,  1.75s/it]
Task 5, Epoch 13/20 => Loss 0.980, Train_accy 84.58:  60%|██████    | 12/20 [00:22<00:13,  1.75s/it]
Task 5, Epoch 13/20 => Loss 0.980, Train_accy 84.58:  65%|██████▌   | 13/20 [00:22<00:12,  1.75s/it]
Task 5, Epoch 14/20 => Loss 0.952, Train_accy 88.33:  65%|██████▌   | 13/20 [00:24<00:12,  1.75s/it]
Task 5, Epoch 14/20 => Loss 0.952, Train_accy 88.33:  70%|███████   | 14/20 [00:24<00:10,  1.75s/it]
Task 5, Epoch 15/20 => Loss 0.940, Train_accy 89.17:  70%|███████   | 14/20 [00:26<00:10,  1.75s/it]
Task 5, Epoch 15/20 => Loss 0.940, Train_accy 89.17:  75%|███████▌  | 15/20 [00:26<00:08,  1.74s/it]
Task 5, Epoch 16/20 => Loss 0.926, Train_accy 87.08:  75%|███████▌  | 15/20 [00:28<00:08,  1.74s/it]
Task 5, Epoch 16/20 => Loss 0.926, Train_accy 87.08:  80%|████████  | 16/20 [00:28<00:07,  1.76s/it]
Task 5, Epoch 17/20 => Loss 0.909, Train_accy 88.33:  80%|████████  | 16/20 [00:29<00:07,  1.76s/it]
Task 5, Epoch 17/20 => Loss 0.909, Train_accy 88.33:  85%|████████▌ | 17/20 [00:29<00:05,  1.75s/it]
Task 5, Epoch 18/20 => Loss 0.889, Train_accy 90.00:  85%|████████▌ | 17/20 [00:31<00:05,  1.75s/it]
Task 5, Epoch 18/20 => Loss 0.889, Train_accy 90.00:  90%|█████████ | 18/20 [00:31<00:03,  1.75s/it]
Task 5, Epoch 19/20 => Loss 0.869, Train_accy 90.42:  90%|█████████ | 18/20 [00:33<00:03,  1.75s/it]
Task 5, Epoch 19/20 => Loss 0.869, Train_accy 90.42:  95%|█████████▌| 19/20 [00:33<00:01,  1.75s/it]
Task 5, Epoch 20/20 => Loss 0.895, Train_accy 87.50:  95%|█████████▌| 19/20 [00:34<00:01,  1.75s/it]
Task 5, Epoch 20/20 => Loss 0.895, Train_accy 87.50: 100%|██████████| 20/20 [00:34<00:00,  1.74s/it]
Task 5, Epoch 20/20 => Loss 0.895, Train_accy 87.50: 100%|██████████| 20/20 [00:34<00:00,  1.75s/it]
2024-09-07 15:25:22,801 [ease.py] => Task 5, Epoch 20/20 => Loss 0.895, Train_accy 87.50
2024-09-07 15:25:38,370 [ease.py] => Task correct: 66.38655462184875
2024-09-07 15:25:38,371 [ease.py] => Task acc: 87.39495798319328
2024-09-07 15:25:38,392 [trainer.py] => No NME accuracy.
2024-09-07 15:25:38,392 [trainer.py] => CNN: {'total': 61.34, '00-09': 41.56, '10-19': 71.43, '20-29': 51.52, '30-39': 61.63, '40-49': 73.44, '50-59': 75.0, 'old': 59.67, 'new': 75.0}
2024-09-07 15:25:38,392 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34]
2024-09-07 15:25:38,392 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61]

Average Accuracy (CNN): 70.94
2024-09-07 15:25:38,392 [trainer.py] => Average Accuracy (CNN): 70.94 

2024-09-07 15:25:38,393 [trainer.py] => All params: 86387138
2024-09-07 15:25:38,393 [trainer.py] => Trainable params: 304320
2024-09-07 15:25:38,398 [ease.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.258, Train_accy 33.26:   0%|          | 0/20 [00:02<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.258, Train_accy 33.26:   5%|▌         | 1/20 [00:02<00:55,  2.93s/it]
Task 6, Epoch 2/20 => Loss 2.080, Train_accy 64.68:   5%|▌         | 1/20 [00:05<00:55,  2.93s/it]
Task 6, Epoch 2/20 => Loss 2.080, Train_accy 64.68:  10%|█         | 2/20 [00:05<00:52,  2.92s/it]
Task 6, Epoch 3/20 => Loss 1.827, Train_accy 63.07:  10%|█         | 2/20 [00:08<00:52,  2.92s/it]
Task 6, Epoch 3/20 => Loss 1.827, Train_accy 63.07:  15%|█▌        | 3/20 [00:08<00:49,  2.92s/it]
Task 6, Epoch 4/20 => Loss 1.504, Train_accy 68.58:  15%|█▌        | 3/20 [00:11<00:49,  2.92s/it]
Task 6, Epoch 4/20 => Loss 1.504, Train_accy 68.58:  20%|██        | 4/20 [00:11<00:47,  2.94s/it]
Task 6, Epoch 5/20 => Loss 1.318, Train_accy 71.33:  20%|██        | 4/20 [00:14<00:47,  2.94s/it]
Task 6, Epoch 5/20 => Loss 1.318, Train_accy 71.33:  25%|██▌       | 5/20 [00:14<00:44,  2.94s/it]
Task 6, Epoch 6/20 => Loss 1.125, Train_accy 77.98:  25%|██▌       | 5/20 [00:17<00:44,  2.94s/it]
Task 6, Epoch 6/20 => Loss 1.125, Train_accy 77.98:  30%|███       | 6/20 [00:17<00:41,  2.95s/it]
Task 6, Epoch 7/20 => Loss 1.027, Train_accy 81.19:  30%|███       | 6/20 [00:20<00:41,  2.95s/it]
Task 6, Epoch 7/20 => Loss 1.027, Train_accy 81.19:  35%|███▌      | 7/20 [00:20<00:38,  2.94s/it]
Task 6, Epoch 8/20 => Loss 0.931, Train_accy 80.96:  35%|███▌      | 7/20 [00:23<00:38,  2.94s/it]
Task 6, Epoch 8/20 => Loss 0.931, Train_accy 80.96:  40%|████      | 8/20 [00:23<00:35,  2.97s/it]
Task 6, Epoch 9/20 => Loss 0.853, Train_accy 86.01:  40%|████      | 8/20 [00:26<00:35,  2.97s/it]
Task 6, Epoch 9/20 => Loss 0.853, Train_accy 86.01:  45%|████▌     | 9/20 [00:26<00:32,  2.95s/it]
Task 6, Epoch 10/20 => Loss 0.810, Train_accy 85.32:  45%|████▌     | 9/20 [00:29<00:32,  2.95s/it]
Task 6, Epoch 10/20 => Loss 0.810, Train_accy 85.32:  50%|█████     | 10/20 [00:29<00:29,  2.94s/it]
Task 6, Epoch 11/20 => Loss 0.735, Train_accy 86.93:  50%|█████     | 10/20 [00:32<00:29,  2.94s/it]
Task 6, Epoch 11/20 => Loss 0.735, Train_accy 86.93:  55%|█████▌    | 11/20 [00:32<00:26,  2.94s/it]
Task 6, Epoch 12/20 => Loss 0.722, Train_accy 89.68:  55%|█████▌    | 11/20 [00:35<00:26,  2.94s/it]
Task 6, Epoch 12/20 => Loss 0.722, Train_accy 89.68:  60%|██████    | 12/20 [00:35<00:23,  2.94s/it]
Task 6, Epoch 13/20 => Loss 0.673, Train_accy 89.68:  60%|██████    | 12/20 [00:38<00:23,  2.94s/it]
Task 6, Epoch 13/20 => Loss 0.673, Train_accy 89.68:  65%|██████▌   | 13/20 [00:38<00:20,  2.94s/it]
Task 6, Epoch 14/20 => Loss 0.714, Train_accy 90.37:  65%|██████▌   | 13/20 [00:41<00:20,  2.94s/it]
Task 6, Epoch 14/20 => Loss 0.714, Train_accy 90.37:  70%|███████   | 14/20 [00:41<00:17,  2.94s/it]
Task 6, Epoch 15/20 => Loss 0.646, Train_accy 88.07:  70%|███████   | 14/20 [00:44<00:17,  2.94s/it]
Task 6, Epoch 15/20 => Loss 0.646, Train_accy 88.07:  75%|███████▌  | 15/20 [00:44<00:14,  2.94s/it]
Task 6, Epoch 16/20 => Loss 0.556, Train_accy 91.28:  75%|███████▌  | 15/20 [00:47<00:14,  2.94s/it]
Task 6, Epoch 16/20 => Loss 0.556, Train_accy 91.28:  80%|████████  | 16/20 [00:47<00:11,  2.94s/it]
Task 6, Epoch 17/20 => Loss 0.607, Train_accy 88.53:  80%|████████  | 16/20 [00:50<00:11,  2.94s/it]
Task 6, Epoch 17/20 => Loss 0.607, Train_accy 88.53:  85%|████████▌ | 17/20 [00:50<00:08,  2.94s/it]
Task 6, Epoch 18/20 => Loss 0.616, Train_accy 90.14:  85%|████████▌ | 17/20 [00:52<00:08,  2.94s/it]
Task 6, Epoch 18/20 => Loss 0.616, Train_accy 90.14:  90%|█████████ | 18/20 [00:52<00:05,  2.94s/it]
Task 6, Epoch 19/20 => Loss 0.570, Train_accy 90.60:  90%|█████████ | 18/20 [00:55<00:05,  2.94s/it]
Task 6, Epoch 19/20 => Loss 0.570, Train_accy 90.60:  95%|█████████▌| 19/20 [00:55<00:02,  2.94s/it]
Task 6, Epoch 20/20 => Loss 0.569, Train_accy 91.06:  95%|█████████▌| 19/20 [00:58<00:02,  2.94s/it]
Task 6, Epoch 20/20 => Loss 0.569, Train_accy 91.06: 100%|██████████| 20/20 [00:58<00:00,  2.95s/it]
Task 6, Epoch 20/20 => Loss 0.569, Train_accy 91.06: 100%|██████████| 20/20 [00:58<00:00,  2.94s/it]
2024-09-07 15:26:37,267 [ease.py] => Task 6, Epoch 20/20 => Loss 0.569, Train_accy 91.06
2024-09-07 15:27:02,202 [ease.py] => Task correct: 63.95348837209303
2024-09-07 15:27:02,202 [ease.py] => Task acc: 87.20930232558139
2024-09-07 15:27:02,227 [trainer.py] => No NME accuracy.
2024-09-07 15:27:02,227 [trainer.py] => CNN: {'total': 59.97, '00-09': 40.26, '10-19': 71.43, '20-29': 48.48, '30-39': 54.65, '40-49': 65.62, '50-59': 75.0, '60-69': 66.67, 'old': 58.19, 'new': 66.67}
2024-09-07 15:27:02,227 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97]
2024-09-07 15:27:02,227 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22]

Average Accuracy (CNN): 69.37
2024-09-07 15:27:02,227 [trainer.py] => Average Accuracy (CNN): 69.37 

2024-09-07 15:27:02,228 [trainer.py] => All params: 86486978
2024-09-07 15:27:02,228 [trainer.py] => Trainable params: 304320
2024-09-07 15:27:02,234 [ease.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.278, Train_accy 26.72:   0%|          | 0/20 [00:02<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.278, Train_accy 26.72:   5%|▌         | 1/20 [00:02<00:47,  2.49s/it]
Task 7, Epoch 2/20 => Loss 2.151, Train_accy 58.62:   5%|▌         | 1/20 [00:04<00:47,  2.49s/it]
Task 7, Epoch 2/20 => Loss 2.151, Train_accy 58.62:  10%|█         | 2/20 [00:04<00:43,  2.44s/it]
Task 7, Epoch 3/20 => Loss 1.960, Train_accy 66.95:  10%|█         | 2/20 [00:07<00:43,  2.44s/it]
Task 7, Epoch 3/20 => Loss 1.960, Train_accy 66.95:  15%|█▌        | 3/20 [00:07<00:41,  2.42s/it]
Task 7, Epoch 4/20 => Loss 1.703, Train_accy 72.41:  15%|█▌        | 3/20 [00:09<00:41,  2.42s/it]
Task 7, Epoch 4/20 => Loss 1.703, Train_accy 72.41:  20%|██        | 4/20 [00:09<00:38,  2.42s/it]
Task 7, Epoch 5/20 => Loss 1.469, Train_accy 73.56:  20%|██        | 4/20 [00:12<00:38,  2.42s/it]
Task 7, Epoch 5/20 => Loss 1.469, Train_accy 73.56:  25%|██▌       | 5/20 [00:12<00:36,  2.43s/it]
Task 7, Epoch 6/20 => Loss 1.251, Train_accy 77.59:  25%|██▌       | 5/20 [00:14<00:36,  2.43s/it]
Task 7, Epoch 6/20 => Loss 1.251, Train_accy 77.59:  30%|███       | 6/20 [00:14<00:33,  2.42s/it]
Task 7, Epoch 7/20 => Loss 1.081, Train_accy 82.47:  30%|███       | 6/20 [00:16<00:33,  2.42s/it]
Task 7, Epoch 7/20 => Loss 1.081, Train_accy 82.47:  35%|███▌      | 7/20 [00:16<00:31,  2.41s/it]
Task 7, Epoch 8/20 => Loss 1.005, Train_accy 87.64:  35%|███▌      | 7/20 [00:19<00:31,  2.41s/it]
Task 7, Epoch 8/20 => Loss 1.005, Train_accy 87.64:  40%|████      | 8/20 [00:19<00:28,  2.41s/it]
Task 7, Epoch 9/20 => Loss 0.899, Train_accy 90.23:  40%|████      | 8/20 [00:21<00:28,  2.41s/it]
Task 7, Epoch 9/20 => Loss 0.899, Train_accy 90.23:  45%|████▌     | 9/20 [00:21<00:26,  2.41s/it]
Task 7, Epoch 10/20 => Loss 0.826, Train_accy 88.51:  45%|████▌     | 9/20 [00:24<00:26,  2.41s/it]
Task 7, Epoch 10/20 => Loss 0.826, Train_accy 88.51:  50%|█████     | 10/20 [00:24<00:24,  2.41s/it]
Task 7, Epoch 11/20 => Loss 0.724, Train_accy 94.25:  50%|█████     | 10/20 [00:26<00:24,  2.41s/it]
Task 7, Epoch 11/20 => Loss 0.724, Train_accy 94.25:  55%|█████▌    | 11/20 [00:26<00:21,  2.40s/it]
Task 7, Epoch 12/20 => Loss 0.707, Train_accy 91.38:  55%|█████▌    | 11/20 [00:29<00:21,  2.40s/it]
Task 7, Epoch 12/20 => Loss 0.707, Train_accy 91.38:  60%|██████    | 12/20 [00:29<00:19,  2.42s/it]
Task 7, Epoch 13/20 => Loss 0.664, Train_accy 90.80:  60%|██████    | 12/20 [00:31<00:19,  2.42s/it]
Task 7, Epoch 13/20 => Loss 0.664, Train_accy 90.80:  65%|██████▌   | 13/20 [00:31<00:16,  2.42s/it]
Task 7, Epoch 14/20 => Loss 0.654, Train_accy 92.82:  65%|██████▌   | 13/20 [00:33<00:16,  2.42s/it]
Task 7, Epoch 14/20 => Loss 0.654, Train_accy 92.82:  70%|███████   | 14/20 [00:33<00:14,  2.42s/it]
Task 7, Epoch 15/20 => Loss 0.641, Train_accy 93.10:  70%|███████   | 14/20 [00:36<00:14,  2.42s/it]
Task 7, Epoch 15/20 => Loss 0.641, Train_accy 93.10:  75%|███████▌  | 15/20 [00:36<00:12,  2.41s/it]
Task 7, Epoch 16/20 => Loss 0.644, Train_accy 93.10:  75%|███████▌  | 15/20 [00:38<00:12,  2.41s/it]
Task 7, Epoch 16/20 => Loss 0.644, Train_accy 93.10:  80%|████████  | 16/20 [00:38<00:09,  2.40s/it]
Task 7, Epoch 17/20 => Loss 0.596, Train_accy 93.39:  80%|████████  | 16/20 [00:41<00:09,  2.40s/it]
Task 7, Epoch 17/20 => Loss 0.596, Train_accy 93.39:  85%|████████▌ | 17/20 [00:41<00:07,  2.41s/it]
Task 7, Epoch 18/20 => Loss 0.606, Train_accy 91.67:  85%|████████▌ | 17/20 [00:43<00:07,  2.41s/it]
Task 7, Epoch 18/20 => Loss 0.606, Train_accy 91.67:  90%|█████████ | 18/20 [00:43<00:04,  2.40s/it]
Task 7, Epoch 19/20 => Loss 0.562, Train_accy 93.68:  90%|█████████ | 18/20 [00:45<00:04,  2.40s/it]
Task 7, Epoch 19/20 => Loss 0.562, Train_accy 93.68:  95%|█████████▌| 19/20 [00:45<00:02,  2.40s/it]
Task 7, Epoch 20/20 => Loss 0.576, Train_accy 92.24:  95%|█████████▌| 19/20 [00:48<00:02,  2.40s/it]
Task 7, Epoch 20/20 => Loss 0.576, Train_accy 92.24: 100%|██████████| 20/20 [00:48<00:00,  2.42s/it]
Task 7, Epoch 20/20 => Loss 0.576, Train_accy 92.24: 100%|██████████| 20/20 [00:48<00:00,  2.42s/it]
2024-09-07 15:27:50,543 [ease.py] => Task 7, Epoch 20/20 => Loss 0.576, Train_accy 92.24
2024-09-07 15:28:18,992 [ease.py] => Task correct: 61.46131805157593
2024-09-07 15:28:18,993 [ease.py] => Task acc: 88.25214899713467
2024-09-07 15:28:19,017 [trainer.py] => No NME accuracy.
2024-09-07 15:28:19,017 [trainer.py] => CNN: {'total': 58.02, '00-09': 32.47, '10-19': 69.39, '20-29': 47.47, '30-39': 54.65, '40-49': 65.62, '50-59': 75.0, '60-69': 66.67, '70-79': 55.21, 'old': 58.47, 'new': 55.21}
2024-09-07 15:28:19,017 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02]
2024-09-07 15:28:19,017 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81]

Average Accuracy (CNN): 67.95
2024-09-07 15:28:19,017 [trainer.py] => Average Accuracy (CNN): 67.95 

2024-09-07 15:28:19,018 [trainer.py] => All params: 86602178
2024-09-07 15:28:19,018 [trainer.py] => Trainable params: 304320
2024-09-07 15:28:19,025 [ease.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.279, Train_accy 28.37:   0%|          | 0/20 [00:02<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.279, Train_accy 28.37:   5%|▌         | 1/20 [00:02<00:39,  2.08s/it]
Task 8, Epoch 2/20 => Loss 2.111, Train_accy 61.94:   5%|▌         | 1/20 [00:04<00:39,  2.08s/it]
Task 8, Epoch 2/20 => Loss 2.111, Train_accy 61.94:  10%|█         | 2/20 [00:04<00:37,  2.08s/it]
Task 8, Epoch 3/20 => Loss 1.947, Train_accy 69.90:  10%|█         | 2/20 [00:06<00:37,  2.08s/it]
Task 8, Epoch 3/20 => Loss 1.947, Train_accy 69.90:  15%|█▌        | 3/20 [00:06<00:35,  2.10s/it]
Task 8, Epoch 4/20 => Loss 1.651, Train_accy 70.59:  15%|█▌        | 3/20 [00:08<00:35,  2.10s/it]
Task 8, Epoch 4/20 => Loss 1.651, Train_accy 70.59:  20%|██        | 4/20 [00:08<00:33,  2.10s/it]
Task 8, Epoch 5/20 => Loss 1.626, Train_accy 73.36:  20%|██        | 4/20 [00:10<00:33,  2.10s/it]
Task 8, Epoch 5/20 => Loss 1.626, Train_accy 73.36:  25%|██▌       | 5/20 [00:10<00:31,  2.10s/it]
Task 8, Epoch 6/20 => Loss 1.295, Train_accy 75.09:  25%|██▌       | 5/20 [00:12<00:31,  2.10s/it]
Task 8, Epoch 6/20 => Loss 1.295, Train_accy 75.09:  30%|███       | 6/20 [00:12<00:29,  2.09s/it]
Task 8, Epoch 7/20 => Loss 1.067, Train_accy 80.62:  30%|███       | 6/20 [00:14<00:29,  2.09s/it]
Task 8, Epoch 7/20 => Loss 1.067, Train_accy 80.62:  35%|███▌      | 7/20 [00:14<00:27,  2.09s/it]
Task 8, Epoch 8/20 => Loss 1.188, Train_accy 83.39:  35%|███▌      | 7/20 [00:16<00:27,  2.09s/it]
Task 8, Epoch 8/20 => Loss 1.188, Train_accy 83.39:  40%|████      | 8/20 [00:16<00:25,  2.09s/it]
Task 8, Epoch 9/20 => Loss 0.960, Train_accy 88.58:  40%|████      | 8/20 [00:18<00:25,  2.09s/it]
Task 8, Epoch 9/20 => Loss 0.960, Train_accy 88.58:  45%|████▌     | 9/20 [00:18<00:23,  2.09s/it]
Task 8, Epoch 10/20 => Loss 0.909, Train_accy 89.97:  45%|████▌     | 9/20 [00:20<00:23,  2.09s/it]
Task 8, Epoch 10/20 => Loss 0.909, Train_accy 89.97:  50%|█████     | 10/20 [00:20<00:20,  2.10s/it]
Task 8, Epoch 11/20 => Loss 0.805, Train_accy 88.24:  50%|█████     | 10/20 [00:22<00:20,  2.10s/it]
Task 8, Epoch 11/20 => Loss 0.805, Train_accy 88.24:  55%|█████▌    | 11/20 [00:22<00:18,  2.08s/it]
Task 8, Epoch 12/20 => Loss 0.888, Train_accy 88.93:  55%|█████▌    | 11/20 [00:25<00:18,  2.08s/it]
Task 8, Epoch 12/20 => Loss 0.888, Train_accy 88.93:  60%|██████    | 12/20 [00:25<00:16,  2.08s/it]
Task 8, Epoch 13/20 => Loss 0.779, Train_accy 87.20:  60%|██████    | 12/20 [00:27<00:16,  2.08s/it]
Task 8, Epoch 13/20 => Loss 0.779, Train_accy 87.20:  65%|██████▌   | 13/20 [00:27<00:14,  2.09s/it]
Task 8, Epoch 14/20 => Loss 0.673, Train_accy 91.00:  65%|██████▌   | 13/20 [00:29<00:14,  2.09s/it]
Task 8, Epoch 14/20 => Loss 0.673, Train_accy 91.00:  70%|███████   | 14/20 [00:29<00:12,  2.07s/it]
Task 8, Epoch 15/20 => Loss 0.754, Train_accy 89.62:  70%|███████   | 14/20 [00:31<00:12,  2.07s/it]
Task 8, Epoch 15/20 => Loss 0.754, Train_accy 89.62:  75%|███████▌  | 15/20 [00:31<00:10,  2.10s/it]
Task 8, Epoch 16/20 => Loss 0.839, Train_accy 88.93:  75%|███████▌  | 15/20 [00:33<00:10,  2.10s/it]
Task 8, Epoch 16/20 => Loss 0.839, Train_accy 88.93:  80%|████████  | 16/20 [00:33<00:08,  2.09s/it]
Task 8, Epoch 17/20 => Loss 0.700, Train_accy 90.31:  80%|████████  | 16/20 [00:35<00:08,  2.09s/it]
Task 8, Epoch 17/20 => Loss 0.700, Train_accy 90.31:  85%|████████▌ | 17/20 [00:35<00:06,  2.08s/it]
Task 8, Epoch 18/20 => Loss 0.741, Train_accy 92.04:  85%|████████▌ | 17/20 [00:37<00:06,  2.08s/it]
Task 8, Epoch 18/20 => Loss 0.741, Train_accy 92.04:  90%|█████████ | 18/20 [00:37<00:04,  2.08s/it]
Task 8, Epoch 19/20 => Loss 0.607, Train_accy 93.43:  90%|█████████ | 18/20 [00:39<00:04,  2.08s/it]
Task 8, Epoch 19/20 => Loss 0.607, Train_accy 93.43:  95%|█████████▌| 19/20 [00:39<00:02,  2.07s/it]
Task 8, Epoch 20/20 => Loss 0.967, Train_accy 92.73:  95%|█████████▌| 19/20 [00:41<00:02,  2.07s/it]
Task 8, Epoch 20/20 => Loss 0.967, Train_accy 92.73: 100%|██████████| 20/20 [00:41<00:00,  2.07s/it]
Task 8, Epoch 20/20 => Loss 0.967, Train_accy 92.73: 100%|██████████| 20/20 [00:41<00:00,  2.08s/it]
2024-09-07 15:29:00,715 [ease.py] => Task 8, Epoch 20/20 => Loss 0.967, Train_accy 92.73
2024-09-07 15:29:33,282 [ease.py] => Task correct: 60.20539152759949
2024-09-07 15:29:33,283 [ease.py] => Task acc: 88.18998716302953
2024-09-07 15:29:33,310 [trainer.py] => No NME accuracy.
2024-09-07 15:29:33,310 [trainer.py] => CNN: {'total': 57.12, '00-09': 29.87, '10-19': 67.35, '20-29': 43.43, '30-39': 53.49, '40-49': 65.62, '50-59': 71.15, '60-69': 66.67, '70-79': 51.04, '80-89': 67.9, 'old': 55.87, 'new': 67.9}
2024-09-07 15:29:33,310 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12]
2024-09-07 15:29:33,310 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06]

Average Accuracy (CNN): 66.75
2024-09-07 15:29:33,310 [trainer.py] => Average Accuracy (CNN): 66.75 

2024-09-07 15:29:33,311 [trainer.py] => All params: 86732738
2024-09-07 15:29:33,312 [trainer.py] => Trainable params: 304320
2024-09-07 15:29:33,320 [ease.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.290, Train_accy 16.60:   0%|          | 0/20 [00:01<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.290, Train_accy 16.60:   5%|▌         | 1/20 [00:01<00:33,  1.74s/it]
Task 9, Epoch 2/20 => Loss 2.207, Train_accy 49.36:   5%|▌         | 1/20 [00:03<00:33,  1.74s/it]
Task 9, Epoch 2/20 => Loss 2.207, Train_accy 49.36:  10%|█         | 2/20 [00:03<00:31,  1.73s/it]
Task 9, Epoch 3/20 => Loss 2.093, Train_accy 58.72:  10%|█         | 2/20 [00:05<00:31,  1.73s/it]
Task 9, Epoch 3/20 => Loss 2.093, Train_accy 58.72:  15%|█▌        | 3/20 [00:05<00:29,  1.73s/it]
Task 9, Epoch 4/20 => Loss 1.954, Train_accy 65.11:  15%|█▌        | 3/20 [00:06<00:29,  1.73s/it]
Task 9, Epoch 4/20 => Loss 1.954, Train_accy 65.11:  20%|██        | 4/20 [00:06<00:28,  1.76s/it]
Task 9, Epoch 5/20 => Loss 1.793, Train_accy 68.09:  20%|██        | 4/20 [00:08<00:28,  1.76s/it]
Task 9, Epoch 5/20 => Loss 1.793, Train_accy 68.09:  25%|██▌       | 5/20 [00:08<00:26,  1.75s/it]
Task 9, Epoch 6/20 => Loss 1.637, Train_accy 65.96:  25%|██▌       | 5/20 [00:10<00:26,  1.75s/it]
Task 9, Epoch 6/20 => Loss 1.637, Train_accy 65.96:  30%|███       | 6/20 [00:10<00:24,  1.74s/it]
Task 9, Epoch 7/20 => Loss 1.474, Train_accy 68.51:  30%|███       | 6/20 [00:12<00:24,  1.74s/it]
Task 9, Epoch 7/20 => Loss 1.474, Train_accy 68.51:  35%|███▌      | 7/20 [00:12<00:22,  1.74s/it]
Task 9, Epoch 8/20 => Loss 1.354, Train_accy 68.94:  35%|███▌      | 7/20 [00:13<00:22,  1.74s/it]
Task 9, Epoch 8/20 => Loss 1.354, Train_accy 68.94:  40%|████      | 8/20 [00:13<00:20,  1.74s/it]
Task 9, Epoch 9/20 => Loss 1.257, Train_accy 70.64:  40%|████      | 8/20 [00:15<00:20,  1.74s/it]
Task 9, Epoch 9/20 => Loss 1.257, Train_accy 70.64:  45%|████▌     | 9/20 [00:15<00:19,  1.75s/it]
Task 9, Epoch 10/20 => Loss 1.201, Train_accy 71.49:  45%|████▌     | 9/20 [00:17<00:19,  1.75s/it]
Task 9, Epoch 10/20 => Loss 1.201, Train_accy 71.49:  50%|█████     | 10/20 [00:17<00:17,  1.75s/it]
Task 9, Epoch 11/20 => Loss 1.116, Train_accy 76.60:  50%|█████     | 10/20 [00:19<00:17,  1.75s/it]
Task 9, Epoch 11/20 => Loss 1.116, Train_accy 76.60:  55%|█████▌    | 11/20 [00:19<00:15,  1.74s/it]
Task 9, Epoch 12/20 => Loss 1.064, Train_accy 76.60:  55%|█████▌    | 11/20 [00:20<00:15,  1.74s/it]
Task 9, Epoch 12/20 => Loss 1.064, Train_accy 76.60:  60%|██████    | 12/20 [00:20<00:13,  1.74s/it]
Task 9, Epoch 13/20 => Loss 1.026, Train_accy 79.57:  60%|██████    | 12/20 [00:22<00:13,  1.74s/it]
Task 9, Epoch 13/20 => Loss 1.026, Train_accy 79.57:  65%|██████▌   | 13/20 [00:22<00:12,  1.74s/it]
Task 9, Epoch 14/20 => Loss 1.024, Train_accy 80.43:  65%|██████▌   | 13/20 [00:24<00:12,  1.74s/it]
Task 9, Epoch 14/20 => Loss 1.024, Train_accy 80.43:  70%|███████   | 14/20 [00:24<00:10,  1.74s/it]
Task 9, Epoch 15/20 => Loss 0.992, Train_accy 84.26:  70%|███████   | 14/20 [00:26<00:10,  1.74s/it]
Task 9, Epoch 15/20 => Loss 0.992, Train_accy 84.26:  75%|███████▌  | 15/20 [00:26<00:08,  1.76s/it]
Task 9, Epoch 16/20 => Loss 0.992, Train_accy 82.55:  75%|███████▌  | 15/20 [00:27<00:08,  1.76s/it]
Task 9, Epoch 16/20 => Loss 0.992, Train_accy 82.55:  80%|████████  | 16/20 [00:27<00:07,  1.75s/it]
Task 9, Epoch 17/20 => Loss 0.960, Train_accy 80.43:  80%|████████  | 16/20 [00:29<00:07,  1.75s/it]
Task 9, Epoch 17/20 => Loss 0.960, Train_accy 80.43:  85%|████████▌ | 17/20 [00:29<00:05,  1.74s/it]
Task 9, Epoch 18/20 => Loss 0.974, Train_accy 81.28:  85%|████████▌ | 17/20 [00:31<00:05,  1.74s/it]
Task 9, Epoch 18/20 => Loss 0.974, Train_accy 81.28:  90%|█████████ | 18/20 [00:31<00:03,  1.74s/it]
Task 9, Epoch 19/20 => Loss 0.951, Train_accy 83.83:  90%|█████████ | 18/20 [00:33<00:03,  1.74s/it]
Task 9, Epoch 19/20 => Loss 0.951, Train_accy 83.83:  95%|█████████▌| 19/20 [00:33<00:01,  1.75s/it]
Task 9, Epoch 20/20 => Loss 0.952, Train_accy 82.98:  95%|█████████▌| 19/20 [00:34<00:01,  1.75s/it]
Task 9, Epoch 20/20 => Loss 0.952, Train_accy 82.98: 100%|██████████| 20/20 [00:34<00:00,  1.76s/it]
Task 9, Epoch 20/20 => Loss 0.952, Train_accy 82.98: 100%|██████████| 20/20 [00:34<00:00,  1.75s/it]
2024-09-07 15:30:08,278 [ease.py] => Task 9, Epoch 20/20 => Loss 0.952, Train_accy 82.98
2024-09-07 15:30:44,429 [ease.py] => Task correct: 57.78834720570749
2024-09-07 15:30:44,430 [ease.py] => Task acc: 87.75267538644471
2024-09-07 15:30:44,452 [trainer.py] => No NME accuracy.
2024-09-07 15:30:44,453 [trainer.py] => CNN: {'total': 54.93, '00-09': 23.38, '10-19': 65.31, '20-29': 41.41, '30-39': 53.49, '40-49': 62.5, '50-59': 67.31, '60-69': 64.29, '70-79': 46.88, '80-89': 60.49, '90-99': 69.35, 'old': 53.79, 'new': 69.35}
2024-09-07 15:30:44,453 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93]
2024-09-07 15:30:44,453 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26]

Average Accuracy (CNN): 65.57
2024-09-07 15:30:44,453 [trainer.py] => Average Accuracy (CNN): 65.57 

2024-09-07 15:30:44,453 [trainer.py] => All params: 86878658
2024-09-07 15:30:44,454 [trainer.py] => Trainable params: 304320
2024-09-07 15:30:44,462 [ease.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.285, Train_accy 14.69:   0%|          | 0/20 [00:01<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.285, Train_accy 14.69:   5%|▌         | 1/20 [00:01<00:34,  1.82s/it]
Task 10, Epoch 2/20 => Loss 2.198, Train_accy 53.47:   5%|▌         | 1/20 [00:03<00:34,  1.82s/it]
Task 10, Epoch 2/20 => Loss 2.198, Train_accy 53.47:  10%|█         | 2/20 [00:03<00:32,  1.80s/it]
Task 10, Epoch 3/20 => Loss 2.016, Train_accy 61.63:  10%|█         | 2/20 [00:05<00:32,  1.80s/it]
Task 10, Epoch 3/20 => Loss 2.016, Train_accy 61.63:  15%|█▌        | 3/20 [00:05<00:30,  1.80s/it]
Task 10, Epoch 4/20 => Loss 1.839, Train_accy 66.53:  15%|█▌        | 3/20 [00:07<00:30,  1.80s/it]
Task 10, Epoch 4/20 => Loss 1.839, Train_accy 66.53:  20%|██        | 4/20 [00:07<00:28,  1.80s/it]
Task 10, Epoch 5/20 => Loss 1.606, Train_accy 72.24:  20%|██        | 4/20 [00:09<00:28,  1.80s/it]
Task 10, Epoch 5/20 => Loss 1.606, Train_accy 72.24:  25%|██▌       | 5/20 [00:09<00:27,  1.80s/it]
Task 10, Epoch 6/20 => Loss 1.428, Train_accy 73.06:  25%|██▌       | 5/20 [00:10<00:27,  1.80s/it]
Task 10, Epoch 6/20 => Loss 1.428, Train_accy 73.06:  30%|███       | 6/20 [00:10<00:25,  1.80s/it]
Task 10, Epoch 7/20 => Loss 1.300, Train_accy 76.73:  30%|███       | 6/20 [00:12<00:25,  1.80s/it]
Task 10, Epoch 7/20 => Loss 1.300, Train_accy 76.73:  35%|███▌      | 7/20 [00:12<00:23,  1.80s/it]
Task 10, Epoch 8/20 => Loss 1.177, Train_accy 79.59:  35%|███▌      | 7/20 [00:14<00:23,  1.80s/it]
Task 10, Epoch 8/20 => Loss 1.177, Train_accy 79.59:  40%|████      | 8/20 [00:14<00:21,  1.79s/it]
Task 10, Epoch 9/20 => Loss 0.996, Train_accy 88.57:  40%|████      | 8/20 [00:16<00:21,  1.79s/it]
Task 10, Epoch 9/20 => Loss 0.996, Train_accy 88.57:  45%|████▌     | 9/20 [00:16<00:19,  1.79s/it]
Task 10, Epoch 10/20 => Loss 0.974, Train_accy 90.20:  45%|████▌     | 9/20 [00:17<00:19,  1.79s/it]
Task 10, Epoch 10/20 => Loss 0.974, Train_accy 90.20:  50%|█████     | 10/20 [00:17<00:17,  1.79s/it]
Task 10, Epoch 11/20 => Loss 0.851, Train_accy 91.43:  50%|█████     | 10/20 [00:19<00:17,  1.79s/it]
Task 10, Epoch 11/20 => Loss 0.851, Train_accy 91.43:  55%|█████▌    | 11/20 [00:19<00:16,  1.79s/it]
Task 10, Epoch 12/20 => Loss 0.929, Train_accy 88.57:  55%|█████▌    | 11/20 [00:21<00:16,  1.79s/it]
Task 10, Epoch 12/20 => Loss 0.929, Train_accy 88.57:  60%|██████    | 12/20 [00:21<00:14,  1.79s/it]
Task 10, Epoch 13/20 => Loss 0.759, Train_accy 90.61:  60%|██████    | 12/20 [00:23<00:14,  1.79s/it]
Task 10, Epoch 13/20 => Loss 0.759, Train_accy 90.61:  65%|██████▌   | 13/20 [00:23<00:12,  1.79s/it]
Task 10, Epoch 14/20 => Loss 0.760, Train_accy 91.02:  65%|██████▌   | 13/20 [00:25<00:12,  1.79s/it]
Task 10, Epoch 14/20 => Loss 0.760, Train_accy 91.02:  70%|███████   | 14/20 [00:25<00:10,  1.79s/it]
Task 10, Epoch 15/20 => Loss 0.755, Train_accy 90.61:  70%|███████   | 14/20 [00:26<00:10,  1.79s/it]
Task 10, Epoch 15/20 => Loss 0.755, Train_accy 90.61:  75%|███████▌  | 15/20 [00:26<00:08,  1.79s/it]
Task 10, Epoch 16/20 => Loss 0.753, Train_accy 91.43:  75%|███████▌  | 15/20 [00:28<00:08,  1.79s/it]
Task 10, Epoch 16/20 => Loss 0.753, Train_accy 91.43:  80%|████████  | 16/20 [00:28<00:07,  1.79s/it]
Task 10, Epoch 17/20 => Loss 0.761, Train_accy 92.65:  80%|████████  | 16/20 [00:30<00:07,  1.79s/it]
Task 10, Epoch 17/20 => Loss 0.761, Train_accy 92.65:  85%|████████▌ | 17/20 [00:30<00:05,  1.79s/it]
Task 10, Epoch 18/20 => Loss 0.671, Train_accy 92.65:  85%|████████▌ | 17/20 [00:32<00:05,  1.79s/it]
Task 10, Epoch 18/20 => Loss 0.671, Train_accy 92.65:  90%|█████████ | 18/20 [00:32<00:03,  1.79s/it]
Task 10, Epoch 19/20 => Loss 0.724, Train_accy 91.02:  90%|█████████ | 18/20 [00:34<00:03,  1.79s/it]
Task 10, Epoch 19/20 => Loss 0.724, Train_accy 91.02:  95%|█████████▌| 19/20 [00:34<00:01,  1.79s/it]
Task 10, Epoch 20/20 => Loss 0.679, Train_accy 92.65:  95%|█████████▌| 19/20 [00:35<00:01,  1.79s/it]
Task 10, Epoch 20/20 => Loss 0.679, Train_accy 92.65: 100%|██████████| 20/20 [00:35<00:00,  1.79s/it]
Task 10, Epoch 20/20 => Loss 0.679, Train_accy 92.65: 100%|██████████| 20/20 [00:35<00:00,  1.79s/it]
2024-09-07 15:31:20,351 [ease.py] => Task 10, Epoch 20/20 => Loss 0.679, Train_accy 92.65
2024-09-07 15:32:02,307 [ease.py] => Task correct: 56.82574916759157
2024-09-07 15:32:02,308 [ease.py] => Task acc: 87.90233074361821
2024-09-07 15:32:02,328 [trainer.py] => No NME accuracy.
2024-09-07 15:32:02,328 [trainer.py] => CNN: {'total': 54.16, '00-09': 22.08, '10-19': 65.31, '20-29': 41.41, '30-39': 52.33, '40-49': 62.5, '50-59': 65.38, '60-69': 62.7, '70-79': 45.83, '80-89': 58.02, '90-99': 69.35, '100-109': 56.67, 'old': 53.98, 'new': 56.67}
2024-09-07 15:32:02,328 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16]
2024-09-07 15:32:02,328 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8]

Average Accuracy (CNN): 64.53
2024-09-07 15:32:02,328 [trainer.py] => Average Accuracy (CNN): 64.53 

2024-09-07 15:32:02,329 [trainer.py] => All params: 87039938
2024-09-07 15:32:02,330 [trainer.py] => Trainable params: 304320
2024-09-07 15:32:02,339 [ease.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.282, Train_accy 26.26:   0%|          | 0/20 [00:01<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.282, Train_accy 26.26:   5%|▌         | 1/20 [00:01<00:37,  1.99s/it]
Task 11, Epoch 2/20 => Loss 2.157, Train_accy 67.99:   5%|▌         | 1/20 [00:03<00:37,  1.99s/it]
Task 11, Epoch 2/20 => Loss 2.157, Train_accy 67.99:  10%|█         | 2/20 [00:03<00:35,  1.99s/it]
Task 11, Epoch 3/20 => Loss 1.969, Train_accy 70.50:  10%|█         | 2/20 [00:05<00:35,  1.99s/it]
Task 11, Epoch 3/20 => Loss 1.969, Train_accy 70.50:  15%|█▌        | 3/20 [00:05<00:34,  2.00s/it]
Task 11, Epoch 4/20 => Loss 1.744, Train_accy 73.38:  15%|█▌        | 3/20 [00:07<00:34,  2.00s/it]
Task 11, Epoch 4/20 => Loss 1.744, Train_accy 73.38:  20%|██        | 4/20 [00:07<00:31,  1.99s/it]
Task 11, Epoch 5/20 => Loss 1.507, Train_accy 71.58:  20%|██        | 4/20 [00:09<00:31,  1.99s/it]
Task 11, Epoch 5/20 => Loss 1.507, Train_accy 71.58:  25%|██▌       | 5/20 [00:09<00:29,  1.99s/it]
Task 11, Epoch 6/20 => Loss 1.296, Train_accy 74.46:  25%|██▌       | 5/20 [00:11<00:29,  1.99s/it]
Task 11, Epoch 6/20 => Loss 1.296, Train_accy 74.46:  30%|███       | 6/20 [00:11<00:27,  1.98s/it]
Task 11, Epoch 7/20 => Loss 1.161, Train_accy 73.02:  30%|███       | 6/20 [00:13<00:27,  1.98s/it]
Task 11, Epoch 7/20 => Loss 1.161, Train_accy 73.02:  35%|███▌      | 7/20 [00:13<00:25,  1.98s/it]
Task 11, Epoch 8/20 => Loss 1.042, Train_accy 76.62:  35%|███▌      | 7/20 [00:15<00:25,  1.98s/it]
Task 11, Epoch 8/20 => Loss 1.042, Train_accy 76.62:  40%|████      | 8/20 [00:15<00:23,  1.99s/it]
Task 11, Epoch 9/20 => Loss 0.940, Train_accy 79.14:  40%|████      | 8/20 [00:17<00:23,  1.99s/it]
Task 11, Epoch 9/20 => Loss 0.940, Train_accy 79.14:  45%|████▌     | 9/20 [00:17<00:21,  1.99s/it]
Task 11, Epoch 10/20 => Loss 0.890, Train_accy 83.09:  45%|████▌     | 9/20 [00:19<00:21,  1.99s/it]
Task 11, Epoch 10/20 => Loss 0.890, Train_accy 83.09:  50%|█████     | 10/20 [00:19<00:19,  1.99s/it]
Task 11, Epoch 11/20 => Loss 0.830, Train_accy 84.17:  50%|█████     | 10/20 [00:21<00:19,  1.99s/it]
Task 11, Epoch 11/20 => Loss 0.830, Train_accy 84.17:  55%|█████▌    | 11/20 [00:21<00:17,  1.98s/it]
Task 11, Epoch 12/20 => Loss 0.816, Train_accy 86.69:  55%|█████▌    | 11/20 [00:23<00:17,  1.98s/it]
Task 11, Epoch 12/20 => Loss 0.816, Train_accy 86.69:  60%|██████    | 12/20 [00:23<00:15,  1.99s/it]
Task 11, Epoch 13/20 => Loss 0.765, Train_accy 88.49:  60%|██████    | 12/20 [00:25<00:15,  1.99s/it]
Task 11, Epoch 13/20 => Loss 0.765, Train_accy 88.49:  65%|██████▌   | 13/20 [00:25<00:13,  1.98s/it]
Task 11, Epoch 14/20 => Loss 0.748, Train_accy 88.13:  65%|██████▌   | 13/20 [00:27<00:13,  1.98s/it]
Task 11, Epoch 14/20 => Loss 0.748, Train_accy 88.13:  70%|███████   | 14/20 [00:27<00:11,  1.99s/it]
Task 11, Epoch 15/20 => Loss 0.728, Train_accy 88.49:  70%|███████   | 14/20 [00:29<00:11,  1.99s/it]
Task 11, Epoch 15/20 => Loss 0.728, Train_accy 88.49:  75%|███████▌  | 15/20 [00:29<00:09,  1.98s/it]
Task 11, Epoch 16/20 => Loss 0.729, Train_accy 90.65:  75%|███████▌  | 15/20 [00:31<00:09,  1.98s/it]
Task 11, Epoch 16/20 => Loss 0.729, Train_accy 90.65:  80%|████████  | 16/20 [00:31<00:07,  1.98s/it]
Task 11, Epoch 17/20 => Loss 0.682, Train_accy 91.37:  80%|████████  | 16/20 [00:33<00:07,  1.98s/it]
Task 11, Epoch 17/20 => Loss 0.682, Train_accy 91.37:  85%|████████▌ | 17/20 [00:33<00:05,  1.98s/it]
Task 11, Epoch 18/20 => Loss 0.723, Train_accy 88.85:  85%|████████▌ | 17/20 [00:35<00:05,  1.98s/it]
Task 11, Epoch 18/20 => Loss 0.723, Train_accy 88.85:  90%|█████████ | 18/20 [00:35<00:03,  1.98s/it]
Task 11, Epoch 19/20 => Loss 0.698, Train_accy 91.73:  90%|█████████ | 18/20 [00:37<00:03,  1.98s/it]
Task 11, Epoch 19/20 => Loss 0.698, Train_accy 91.73:  95%|█████████▌| 19/20 [00:37<00:01,  1.98s/it]
Task 11, Epoch 20/20 => Loss 0.711, Train_accy 88.49:  95%|█████████▌| 19/20 [00:39<00:01,  1.98s/it]
Task 11, Epoch 20/20 => Loss 0.711, Train_accy 88.49: 100%|██████████| 20/20 [00:39<00:00,  1.98s/it]
Task 11, Epoch 20/20 => Loss 0.711, Train_accy 88.49: 100%|██████████| 20/20 [00:39<00:00,  1.98s/it]
2024-09-07 15:32:42,026 [ease.py] => Task 11, Epoch 20/20 => Loss 0.711, Train_accy 88.49
2024-09-07 15:33:31,650 [ease.py] => Task correct: 56.30769230769231
2024-09-07 15:33:31,651 [ease.py] => Task acc: 88.3076923076923
2024-09-07 15:33:31,676 [trainer.py] => No NME accuracy.
2024-09-07 15:33:31,676 [trainer.py] => CNN: {'total': 53.95, '00-09': 23.38, '10-19': 64.29, '20-29': 39.39, '30-39': 52.33, '40-49': 60.94, '50-59': 61.54, '60-69': 62.7, '70-79': 43.75, '80-89': 58.02, '90-99': 59.68, '100-109': 56.67, '110-119': 68.92, 'old': 52.72, 'new': 68.92}
2024-09-07 15:33:31,676 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95]
2024-09-07 15:33:31,676 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87]

Average Accuracy (CNN): 63.65
2024-09-07 15:33:31,676 [trainer.py] => Average Accuracy (CNN): 63.65 

2024-09-07 15:33:31,677 [trainer.py] => All params: 87216578
2024-09-07 15:33:31,678 [trainer.py] => Trainable params: 304320
2024-09-07 15:33:31,689 [ease.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.289, Train_accy 17.83:   0%|          | 0/20 [00:01<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.289, Train_accy 17.83:   5%|▌         | 1/20 [00:01<00:32,  1.69s/it]
Task 12, Epoch 2/20 => Loss 2.249, Train_accy 33.91:   5%|▌         | 1/20 [00:03<00:32,  1.69s/it]
Task 12, Epoch 2/20 => Loss 2.249, Train_accy 33.91:  10%|█         | 2/20 [00:03<00:30,  1.70s/it]
Task 12, Epoch 3/20 => Loss 2.183, Train_accy 40.43:  10%|█         | 2/20 [00:05<00:30,  1.70s/it]
Task 12, Epoch 3/20 => Loss 2.183, Train_accy 40.43:  15%|█▌        | 3/20 [00:05<00:29,  1.71s/it]
Task 12, Epoch 4/20 => Loss 2.103, Train_accy 45.22:  15%|█▌        | 3/20 [00:06<00:29,  1.71s/it]
Task 12, Epoch 4/20 => Loss 2.103, Train_accy 45.22:  20%|██        | 4/20 [00:06<00:27,  1.71s/it]
Task 12, Epoch 5/20 => Loss 2.007, Train_accy 52.17:  20%|██        | 4/20 [00:08<00:27,  1.71s/it]
Task 12, Epoch 5/20 => Loss 2.007, Train_accy 52.17:  25%|██▌       | 5/20 [00:08<00:25,  1.70s/it]
Task 12, Epoch 6/20 => Loss 1.906, Train_accy 56.09:  25%|██▌       | 5/20 [00:10<00:25,  1.70s/it]
Task 12, Epoch 6/20 => Loss 1.906, Train_accy 56.09:  30%|███       | 6/20 [00:10<00:23,  1.70s/it]
Task 12, Epoch 7/20 => Loss 1.799, Train_accy 61.30:  30%|███       | 6/20 [00:11<00:23,  1.70s/it]
Task 12, Epoch 7/20 => Loss 1.799, Train_accy 61.30:  35%|███▌      | 7/20 [00:11<00:22,  1.71s/it]
Task 12, Epoch 8/20 => Loss 1.665, Train_accy 69.13:  35%|███▌      | 7/20 [00:13<00:22,  1.71s/it]
Task 12, Epoch 8/20 => Loss 1.665, Train_accy 69.13:  40%|████      | 8/20 [00:13<00:20,  1.72s/it]
Task 12, Epoch 9/20 => Loss 1.600, Train_accy 67.39:  40%|████      | 8/20 [00:15<00:20,  1.72s/it]
Task 12, Epoch 9/20 => Loss 1.600, Train_accy 67.39:  45%|████▌     | 9/20 [00:15<00:18,  1.71s/it]
Task 12, Epoch 10/20 => Loss 1.487, Train_accy 77.39:  45%|████▌     | 9/20 [00:17<00:18,  1.71s/it]
Task 12, Epoch 10/20 => Loss 1.487, Train_accy 77.39:  50%|█████     | 10/20 [00:17<00:17,  1.71s/it]
Task 12, Epoch 11/20 => Loss 1.434, Train_accy 76.96:  50%|█████     | 10/20 [00:18<00:17,  1.71s/it]
Task 12, Epoch 11/20 => Loss 1.434, Train_accy 76.96:  55%|█████▌    | 11/20 [00:18<00:15,  1.72s/it]
Task 12, Epoch 12/20 => Loss 1.381, Train_accy 80.87:  55%|█████▌    | 11/20 [00:20<00:15,  1.72s/it]
Task 12, Epoch 12/20 => Loss 1.381, Train_accy 80.87:  60%|██████    | 12/20 [00:20<00:13,  1.71s/it]
Task 12, Epoch 13/20 => Loss 1.320, Train_accy 82.61:  60%|██████    | 12/20 [00:22<00:13,  1.71s/it]
Task 12, Epoch 13/20 => Loss 1.320, Train_accy 82.61:  65%|██████▌   | 13/20 [00:22<00:11,  1.71s/it]
Task 12, Epoch 14/20 => Loss 1.297, Train_accy 87.39:  65%|██████▌   | 13/20 [00:23<00:11,  1.71s/it]
Task 12, Epoch 14/20 => Loss 1.297, Train_accy 87.39:  70%|███████   | 14/20 [00:23<00:10,  1.70s/it]
Task 12, Epoch 15/20 => Loss 1.276, Train_accy 86.96:  70%|███████   | 14/20 [00:25<00:10,  1.70s/it]
Task 12, Epoch 15/20 => Loss 1.276, Train_accy 86.96:  75%|███████▌  | 15/20 [00:25<00:08,  1.71s/it]
Task 12, Epoch 16/20 => Loss 1.240, Train_accy 86.09:  75%|███████▌  | 15/20 [00:27<00:08,  1.71s/it]
Task 12, Epoch 16/20 => Loss 1.240, Train_accy 86.09:  80%|████████  | 16/20 [00:27<00:06,  1.71s/it]
Task 12, Epoch 17/20 => Loss 1.227, Train_accy 86.09:  80%|████████  | 16/20 [00:29<00:06,  1.71s/it]
Task 12, Epoch 17/20 => Loss 1.227, Train_accy 86.09:  85%|████████▌ | 17/20 [00:29<00:05,  1.71s/it]
Task 12, Epoch 18/20 => Loss 1.211, Train_accy 86.96:  85%|████████▌ | 17/20 [00:30<00:05,  1.71s/it]
Task 12, Epoch 18/20 => Loss 1.211, Train_accy 86.96:  90%|█████████ | 18/20 [00:30<00:03,  1.71s/it]
Task 12, Epoch 19/20 => Loss 1.220, Train_accy 87.83:  90%|█████████ | 18/20 [00:32<00:03,  1.71s/it]
Task 12, Epoch 19/20 => Loss 1.220, Train_accy 87.83:  95%|█████████▌| 19/20 [00:32<00:01,  1.71s/it]
Task 12, Epoch 20/20 => Loss 1.207, Train_accy 89.57:  95%|█████████▌| 19/20 [00:34<00:01,  1.71s/it]
Task 12, Epoch 20/20 => Loss 1.207, Train_accy 89.57: 100%|██████████| 20/20 [00:34<00:00,  1.71s/it]
Task 12, Epoch 20/20 => Loss 1.207, Train_accy 89.57: 100%|██████████| 20/20 [00:34<00:00,  1.71s/it]
2024-09-07 15:34:05,875 [ease.py] => Task 12, Epoch 20/20 => Loss 1.207, Train_accy 89.57
2024-09-07 15:35:00,135 [ease.py] => Task correct: 54.492753623188406
2024-09-07 15:35:00,136 [ease.py] => Task acc: 87.72946859903382
2024-09-07 15:35:00,159 [trainer.py] => No NME accuracy.
2024-09-07 15:35:00,159 [trainer.py] => CNN: {'total': 52.08, '00-09': 23.38, '10-19': 60.2, '20-29': 37.37, '30-39': 52.33, '40-49': 59.38, '50-59': 59.62, '60-69': 61.9, '70-79': 40.62, '80-89': 58.02, '90-99': 58.06, '100-109': 56.67, '110-119': 68.92, '120-129': 43.33, 'old': 52.62, 'new': 43.33}
2024-09-07 15:35:00,159 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08]
2024-09-07 15:35:00,159 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97]

Average Accuracy (CNN): 62.76
2024-09-07 15:35:00,159 [trainer.py] => Average Accuracy (CNN): 62.76 

2024-09-07 15:35:00,160 [trainer.py] => All params: 87408578
2024-09-07 15:35:00,161 [trainer.py] => Trainable params: 304320
2024-09-07 15:35:00,173 [ease.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.292, Train_accy 15.21:   0%|          | 0/20 [00:02<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.292, Train_accy 15.21:   5%|▌         | 1/20 [00:02<00:41,  2.18s/it]
Task 13, Epoch 2/20 => Loss 2.201, Train_accy 51.78:   5%|▌         | 1/20 [00:04<00:41,  2.18s/it]
Task 13, Epoch 2/20 => Loss 2.201, Train_accy 51.78:  10%|█         | 2/20 [00:04<00:39,  2.18s/it]
Task 13, Epoch 3/20 => Loss 2.060, Train_accy 58.90:  10%|█         | 2/20 [00:06<00:39,  2.18s/it]
Task 13, Epoch 3/20 => Loss 2.060, Train_accy 58.90:  15%|█▌        | 3/20 [00:06<00:36,  2.18s/it]
Task 13, Epoch 4/20 => Loss 1.882, Train_accy 64.72:  15%|█▌        | 3/20 [00:08<00:36,  2.18s/it]
Task 13, Epoch 4/20 => Loss 1.882, Train_accy 64.72:  20%|██        | 4/20 [00:08<00:34,  2.17s/it]
Task 13, Epoch 5/20 => Loss 1.669, Train_accy 66.67:  20%|██        | 4/20 [00:10<00:34,  2.17s/it]
Task 13, Epoch 5/20 => Loss 1.669, Train_accy 66.67:  25%|██▌       | 5/20 [00:10<00:32,  2.18s/it]
Task 13, Epoch 6/20 => Loss 1.525, Train_accy 72.49:  25%|██▌       | 5/20 [00:13<00:32,  2.18s/it]
Task 13, Epoch 6/20 => Loss 1.525, Train_accy 72.49:  30%|███       | 6/20 [00:13<00:30,  2.19s/it]
Task 13, Epoch 7/20 => Loss 1.365, Train_accy 77.67:  30%|███       | 6/20 [00:15<00:30,  2.19s/it]
Task 13, Epoch 7/20 => Loss 1.365, Train_accy 77.67:  35%|███▌      | 7/20 [00:15<00:28,  2.18s/it]
Task 13, Epoch 8/20 => Loss 1.211, Train_accy 82.52:  35%|███▌      | 7/20 [00:17<00:28,  2.18s/it]
Task 13, Epoch 8/20 => Loss 1.211, Train_accy 82.52:  40%|████      | 8/20 [00:17<00:26,  2.18s/it]
Task 13, Epoch 9/20 => Loss 1.157, Train_accy 82.20:  40%|████      | 8/20 [00:19<00:26,  2.18s/it]
Task 13, Epoch 9/20 => Loss 1.157, Train_accy 82.20:  45%|████▌     | 9/20 [00:19<00:23,  2.18s/it]
Task 13, Epoch 10/20 => Loss 1.087, Train_accy 82.85:  45%|████▌     | 9/20 [00:21<00:23,  2.18s/it]
Task 13, Epoch 10/20 => Loss 1.087, Train_accy 82.85:  50%|█████     | 10/20 [00:21<00:21,  2.18s/it]
Task 13, Epoch 11/20 => Loss 0.966, Train_accy 87.06:  50%|█████     | 10/20 [00:24<00:21,  2.18s/it]
Task 13, Epoch 11/20 => Loss 0.966, Train_accy 87.06:  55%|█████▌    | 11/20 [00:24<00:19,  2.20s/it]
Task 13, Epoch 12/20 => Loss 0.940, Train_accy 85.76:  55%|█████▌    | 11/20 [00:26<00:19,  2.20s/it]
Task 13, Epoch 12/20 => Loss 0.940, Train_accy 85.76:  60%|██████    | 12/20 [00:26<00:17,  2.20s/it]
Task 13, Epoch 13/20 => Loss 0.906, Train_accy 90.29:  60%|██████    | 12/20 [00:28<00:17,  2.20s/it]
Task 13, Epoch 13/20 => Loss 0.906, Train_accy 90.29:  65%|██████▌   | 13/20 [00:28<00:15,  2.21s/it]
Task 13, Epoch 14/20 => Loss 0.839, Train_accy 90.61:  65%|██████▌   | 13/20 [00:30<00:15,  2.21s/it]
Task 13, Epoch 14/20 => Loss 0.839, Train_accy 90.61:  70%|███████   | 14/20 [00:30<00:13,  2.21s/it]
Task 13, Epoch 15/20 => Loss 0.818, Train_accy 92.23:  70%|███████   | 14/20 [00:32<00:13,  2.21s/it]
Task 13, Epoch 15/20 => Loss 0.818, Train_accy 92.23:  75%|███████▌  | 15/20 [00:32<00:11,  2.20s/it]
Task 13, Epoch 16/20 => Loss 0.837, Train_accy 89.32:  75%|███████▌  | 15/20 [00:35<00:11,  2.20s/it]
Task 13, Epoch 16/20 => Loss 0.837, Train_accy 89.32:  80%|████████  | 16/20 [00:35<00:08,  2.20s/it]
Task 13, Epoch 17/20 => Loss 0.819, Train_accy 89.97:  80%|████████  | 16/20 [00:37<00:08,  2.20s/it]
Task 13, Epoch 17/20 => Loss 0.819, Train_accy 89.97:  85%|████████▌ | 17/20 [00:37<00:06,  2.20s/it]
Task 13, Epoch 18/20 => Loss 0.784, Train_accy 90.29:  85%|████████▌ | 17/20 [00:39<00:06,  2.20s/it]
Task 13, Epoch 18/20 => Loss 0.784, Train_accy 90.29:  90%|█████████ | 18/20 [00:39<00:04,  2.19s/it]
Task 13, Epoch 19/20 => Loss 0.820, Train_accy 91.91:  90%|█████████ | 18/20 [00:41<00:04,  2.19s/it]
Task 13, Epoch 19/20 => Loss 0.820, Train_accy 91.91:  95%|█████████▌| 19/20 [00:41<00:02,  2.21s/it]
Task 13, Epoch 20/20 => Loss 0.800, Train_accy 89.97:  95%|█████████▌| 19/20 [00:43<00:02,  2.21s/it]
Task 13, Epoch 20/20 => Loss 0.800, Train_accy 89.97: 100%|██████████| 20/20 [00:43<00:00,  2.22s/it]
Task 13, Epoch 20/20 => Loss 0.800, Train_accy 89.97: 100%|██████████| 20/20 [00:43<00:00,  2.20s/it]
2024-09-07 15:35:44,119 [ease.py] => Task 13, Epoch 20/20 => Loss 0.800, Train_accy 89.97
2024-09-07 15:36:49,711 [ease.py] => Task correct: 53.07760927743087
2024-09-07 15:36:49,711 [ease.py] => Task acc: 87.77876895628903
2024-09-07 15:36:49,733 [trainer.py] => No NME accuracy.
2024-09-07 15:36:49,733 [trainer.py] => CNN: {'total': 50.94, '00-09': 23.38, '10-19': 59.18, '20-29': 37.37, '30-39': 52.33, '40-49': 59.38, '50-59': 57.69, '60-69': 58.73, '70-79': 39.58, '80-89': 58.02, '90-99': 58.06, '100-109': 56.67, '110-119': 68.92, '120-129': 43.33, '130-139': 45.35, 'old': 51.4, 'new': 45.35}
2024-09-07 15:36:49,734 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08, 50.94]
2024-09-07 15:36:49,734 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97, 77.07]

Average Accuracy (CNN): 61.91
2024-09-07 15:36:49,734 [trainer.py] => Average Accuracy (CNN): 61.91 

2024-09-07 15:36:49,735 [trainer.py] => All params: 87615938
2024-09-07 15:36:49,735 [trainer.py] => Trainable params: 304320
2024-09-07 15:36:49,749 [ease.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.287, Train_accy 18.29:   0%|          | 0/20 [00:02<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.287, Train_accy 18.29:   5%|▌         | 1/20 [00:02<00:43,  2.28s/it]
Task 14, Epoch 2/20 => Loss 2.187, Train_accy 40.85:   5%|▌         | 1/20 [00:04<00:43,  2.28s/it]
Task 14, Epoch 2/20 => Loss 2.187, Train_accy 40.85:  10%|█         | 2/20 [00:04<00:40,  2.27s/it]
Task 14, Epoch 3/20 => Loss 2.051, Train_accy 47.87:  10%|█         | 2/20 [00:06<00:40,  2.27s/it]
Task 14, Epoch 3/20 => Loss 2.051, Train_accy 47.87:  15%|█▌        | 3/20 [00:06<00:38,  2.27s/it]
Task 14, Epoch 4/20 => Loss 1.871, Train_accy 53.66:  15%|█▌        | 3/20 [00:09<00:38,  2.27s/it]
Task 14, Epoch 4/20 => Loss 1.871, Train_accy 53.66:  20%|██        | 4/20 [00:09<00:36,  2.26s/it]
Task 14, Epoch 5/20 => Loss 1.686, Train_accy 58.23:  20%|██        | 4/20 [00:11<00:36,  2.26s/it]
Task 14, Epoch 5/20 => Loss 1.686, Train_accy 58.23:  25%|██▌       | 5/20 [00:11<00:33,  2.26s/it]
Task 14, Epoch 6/20 => Loss 1.534, Train_accy 63.41:  25%|██▌       | 5/20 [00:13<00:33,  2.26s/it]
Task 14, Epoch 6/20 => Loss 1.534, Train_accy 63.41:  30%|███       | 6/20 [00:13<00:31,  2.28s/it]
Task 14, Epoch 7/20 => Loss 1.376, Train_accy 70.43:  30%|███       | 6/20 [00:15<00:31,  2.28s/it]
Task 14, Epoch 7/20 => Loss 1.376, Train_accy 70.43:  35%|███▌      | 7/20 [00:15<00:29,  2.28s/it]
Task 14, Epoch 8/20 => Loss 1.253, Train_accy 79.27:  35%|███▌      | 7/20 [00:18<00:29,  2.28s/it]
Task 14, Epoch 8/20 => Loss 1.253, Train_accy 79.27:  40%|████      | 8/20 [00:18<00:27,  2.30s/it]
Task 14, Epoch 9/20 => Loss 1.150, Train_accy 84.45:  40%|████      | 8/20 [00:20<00:27,  2.30s/it]
Task 14, Epoch 9/20 => Loss 1.150, Train_accy 84.45:  45%|████▌     | 9/20 [00:20<00:25,  2.30s/it]
Task 14, Epoch 10/20 => Loss 1.113, Train_accy 85.06:  45%|████▌     | 9/20 [00:22<00:25,  2.30s/it]
Task 14, Epoch 10/20 => Loss 1.113, Train_accy 85.06:  50%|█████     | 10/20 [00:22<00:22,  2.29s/it]
Task 14, Epoch 11/20 => Loss 1.020, Train_accy 88.41:  50%|█████     | 10/20 [00:25<00:22,  2.29s/it]
Task 14, Epoch 11/20 => Loss 1.020, Train_accy 88.41:  55%|█████▌    | 11/20 [00:25<00:20,  2.28s/it]
Task 14, Epoch 12/20 => Loss 0.961, Train_accy 91.77:  55%|█████▌    | 11/20 [00:27<00:20,  2.28s/it]
Task 14, Epoch 12/20 => Loss 0.961, Train_accy 91.77:  60%|██████    | 12/20 [00:27<00:18,  2.28s/it]
Task 14, Epoch 13/20 => Loss 0.992, Train_accy 87.50:  60%|██████    | 12/20 [00:29<00:18,  2.28s/it]
Task 14, Epoch 13/20 => Loss 0.992, Train_accy 87.50:  65%|██████▌   | 13/20 [00:29<00:16,  2.30s/it]
Task 14, Epoch 14/20 => Loss 0.902, Train_accy 89.63:  65%|██████▌   | 13/20 [00:31<00:16,  2.30s/it]
Task 14, Epoch 14/20 => Loss 0.902, Train_accy 89.63:  70%|███████   | 14/20 [00:31<00:13,  2.29s/it]
Task 14, Epoch 15/20 => Loss 0.930, Train_accy 88.41:  70%|███████   | 14/20 [00:34<00:13,  2.29s/it]
Task 14, Epoch 15/20 => Loss 0.930, Train_accy 88.41:  75%|███████▌  | 15/20 [00:34<00:11,  2.28s/it]
Task 14, Epoch 16/20 => Loss 0.874, Train_accy 92.07:  75%|███████▌  | 15/20 [00:36<00:11,  2.28s/it]
Task 14, Epoch 16/20 => Loss 0.874, Train_accy 92.07:  80%|████████  | 16/20 [00:36<00:09,  2.29s/it]
Task 14, Epoch 17/20 => Loss 0.883, Train_accy 88.72:  80%|████████  | 16/20 [00:38<00:09,  2.29s/it]
Task 14, Epoch 17/20 => Loss 0.883, Train_accy 88.72:  85%|████████▌ | 17/20 [00:38<00:06,  2.29s/it]
Task 14, Epoch 18/20 => Loss 0.839, Train_accy 93.29:  85%|████████▌ | 17/20 [00:41<00:06,  2.29s/it]
Task 14, Epoch 18/20 => Loss 0.839, Train_accy 93.29:  90%|█████████ | 18/20 [00:41<00:04,  2.30s/it]
Task 14, Epoch 19/20 => Loss 0.859, Train_accy 90.85:  90%|█████████ | 18/20 [00:43<00:04,  2.30s/it]
Task 14, Epoch 19/20 => Loss 0.859, Train_accy 90.85:  95%|█████████▌| 19/20 [00:43<00:02,  2.29s/it]
Task 14, Epoch 20/20 => Loss 0.854, Train_accy 92.07:  95%|█████████▌| 19/20 [00:45<00:02,  2.29s/it]
Task 14, Epoch 20/20 => Loss 0.854, Train_accy 92.07: 100%|██████████| 20/20 [00:45<00:00,  2.29s/it]
Task 14, Epoch 20/20 => Loss 0.854, Train_accy 92.07: 100%|██████████| 20/20 [00:45<00:00,  2.28s/it]
2024-09-07 15:37:35,446 [ease.py] => Task 14, Epoch 20/20 => Loss 0.854, Train_accy 92.07
2024-09-07 15:38:50,088 [ease.py] => Task correct: 52.046783625730995
2024-09-07 15:38:50,089 [ease.py] => Task acc: 87.55221386800334
2024-09-07 15:38:50,110 [trainer.py] => No NME accuracy.
2024-09-07 15:38:50,110 [trainer.py] => CNN: {'total': 49.96, '00-09': 23.38, '10-19': 59.18, '20-29': 35.35, '30-39': 51.16, '40-49': 59.38, '50-59': 55.77, '60-69': 58.73, '70-79': 39.58, '80-89': 56.79, '90-99': 58.06, '100-109': 55.0, '110-119': 68.92, '120-129': 43.33, '130-139': 45.35, '140-149': 43.42, 'old': 50.4, 'new': 43.42}
2024-09-07 15:38:50,110 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08, 50.94, 49.96]
2024-09-07 15:38:50,110 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97, 77.07, 75.94]

Average Accuracy (CNN): 61.12
2024-09-07 15:38:50,110 [trainer.py] => Average Accuracy (CNN): 61.12 

2024-09-07 15:38:50,111 [trainer.py] => All params: 87838658
2024-09-07 15:38:50,112 [trainer.py] => Trainable params: 304320
2024-09-07 15:38:50,127 [ease.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.297, Train_accy 13.79:   0%|          | 0/20 [00:01<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.297, Train_accy 13.79:   5%|▌         | 1/20 [00:01<00:29,  1.55s/it]
Task 15, Epoch 2/20 => Loss 2.226, Train_accy 51.23:   5%|▌         | 1/20 [00:03<00:29,  1.55s/it]
Task 15, Epoch 2/20 => Loss 2.226, Train_accy 51.23:  10%|█         | 2/20 [00:03<00:28,  1.56s/it]
Task 15, Epoch 3/20 => Loss 2.128, Train_accy 51.72:  10%|█         | 2/20 [00:04<00:28,  1.56s/it]
Task 15, Epoch 3/20 => Loss 2.128, Train_accy 51.72:  15%|█▌        | 3/20 [00:04<00:26,  1.56s/it]
Task 15, Epoch 4/20 => Loss 2.021, Train_accy 50.74:  15%|█▌        | 3/20 [00:06<00:26,  1.56s/it]
Task 15, Epoch 4/20 => Loss 2.021, Train_accy 50.74:  20%|██        | 4/20 [00:06<00:24,  1.55s/it]
Task 15, Epoch 5/20 => Loss 1.893, Train_accy 54.68:  20%|██        | 4/20 [00:07<00:24,  1.55s/it]
Task 15, Epoch 5/20 => Loss 1.893, Train_accy 54.68:  25%|██▌       | 5/20 [00:07<00:23,  1.55s/it]
Task 15, Epoch 6/20 => Loss 1.778, Train_accy 58.62:  25%|██▌       | 5/20 [00:09<00:23,  1.55s/it]
Task 15, Epoch 6/20 => Loss 1.778, Train_accy 58.62:  30%|███       | 6/20 [00:09<00:21,  1.55s/it]
Task 15, Epoch 7/20 => Loss 1.629, Train_accy 65.02:  30%|███       | 6/20 [00:10<00:21,  1.55s/it]
Task 15, Epoch 7/20 => Loss 1.629, Train_accy 65.02:  35%|███▌      | 7/20 [00:10<00:20,  1.55s/it]
Task 15, Epoch 8/20 => Loss 1.518, Train_accy 67.98:  35%|███▌      | 7/20 [00:12<00:20,  1.55s/it]
Task 15, Epoch 8/20 => Loss 1.518, Train_accy 67.98:  40%|████      | 8/20 [00:12<00:18,  1.55s/it]
Task 15, Epoch 9/20 => Loss 1.349, Train_accy 72.41:  40%|████      | 8/20 [00:13<00:18,  1.55s/it]
Task 15, Epoch 9/20 => Loss 1.349, Train_accy 72.41:  45%|████▌     | 9/20 [00:13<00:17,  1.55s/it]
Task 15, Epoch 10/20 => Loss 1.321, Train_accy 77.34:  45%|████▌     | 9/20 [00:15<00:17,  1.55s/it]
Task 15, Epoch 10/20 => Loss 1.321, Train_accy 77.34:  50%|█████     | 10/20 [00:15<00:15,  1.55s/it]
Task 15, Epoch 11/20 => Loss 1.155, Train_accy 82.27:  50%|█████     | 10/20 [00:17<00:15,  1.55s/it]
Task 15, Epoch 11/20 => Loss 1.155, Train_accy 82.27:  55%|█████▌    | 11/20 [00:17<00:13,  1.55s/it]
Task 15, Epoch 12/20 => Loss 1.139, Train_accy 84.73:  55%|█████▌    | 11/20 [00:18<00:13,  1.55s/it]
Task 15, Epoch 12/20 => Loss 1.139, Train_accy 84.73:  60%|██████    | 12/20 [00:18<00:12,  1.55s/it]
Task 15, Epoch 13/20 => Loss 1.081, Train_accy 86.70:  60%|██████    | 12/20 [00:20<00:12,  1.55s/it]
Task 15, Epoch 13/20 => Loss 1.081, Train_accy 86.70:  65%|██████▌   | 13/20 [00:20<00:10,  1.55s/it]
Task 15, Epoch 14/20 => Loss 1.045, Train_accy 85.22:  65%|██████▌   | 13/20 [00:21<00:10,  1.55s/it]
Task 15, Epoch 14/20 => Loss 1.045, Train_accy 85.22:  70%|███████   | 14/20 [00:21<00:09,  1.55s/it]
Task 15, Epoch 15/20 => Loss 1.033, Train_accy 87.19:  70%|███████   | 14/20 [00:23<00:09,  1.55s/it]
Task 15, Epoch 15/20 => Loss 1.033, Train_accy 87.19:  75%|███████▌  | 15/20 [00:23<00:07,  1.56s/it]
Task 15, Epoch 16/20 => Loss 1.049, Train_accy 81.77:  75%|███████▌  | 15/20 [00:24<00:07,  1.56s/it]
Task 15, Epoch 16/20 => Loss 1.049, Train_accy 81.77:  80%|████████  | 16/20 [00:24<00:06,  1.56s/it]
Task 15, Epoch 17/20 => Loss 0.984, Train_accy 90.15:  80%|████████  | 16/20 [00:26<00:06,  1.56s/it]
Task 15, Epoch 17/20 => Loss 0.984, Train_accy 90.15:  85%|████████▌ | 17/20 [00:26<00:04,  1.56s/it]
Task 15, Epoch 18/20 => Loss 1.045, Train_accy 86.21:  85%|████████▌ | 17/20 [00:27<00:04,  1.56s/it]
Task 15, Epoch 18/20 => Loss 1.045, Train_accy 86.21:  90%|█████████ | 18/20 [00:27<00:03,  1.56s/it]
Task 15, Epoch 19/20 => Loss 0.973, Train_accy 86.21:  90%|█████████ | 18/20 [00:29<00:03,  1.56s/it]
Task 15, Epoch 19/20 => Loss 0.973, Train_accy 86.21:  95%|█████████▌| 19/20 [00:29<00:01,  1.55s/it]
Task 15, Epoch 20/20 => Loss 1.020, Train_accy 88.18:  95%|█████████▌| 19/20 [00:31<00:01,  1.55s/it]
Task 15, Epoch 20/20 => Loss 1.020, Train_accy 88.18: 100%|██████████| 20/20 [00:31<00:00,  1.56s/it]
Task 15, Epoch 20/20 => Loss 1.020, Train_accy 88.18: 100%|██████████| 20/20 [00:31<00:00,  1.55s/it]
2024-09-07 15:39:21,202 [ease.py] => Task 15, Epoch 20/20 => Loss 1.020, Train_accy 88.18
2024-09-07 15:40:37,490 [ease.py] => Task correct: 50.96153846153846
2024-09-07 15:40:37,490 [ease.py] => Task acc: 87.5
2024-09-07 15:40:37,512 [trainer.py] => No NME accuracy.
2024-09-07 15:40:37,513 [trainer.py] => CNN: {'total': 48.88, '00-09': 23.38, '10-19': 58.16, '20-29': 35.35, '30-39': 51.16, '40-49': 57.81, '50-59': 53.85, '60-69': 57.94, '70-79': 39.58, '80-89': 56.79, '90-99': 56.45, '100-109': 55.0, '110-119': 68.92, '120-129': 41.67, '130-139': 45.35, '140-149': 43.42, '150-159': 35.29, 'old': 49.46, 'new': 35.29}
2024-09-07 15:40:37,513 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08, 50.94, 49.96, 48.88]
2024-09-07 15:40:37,513 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97, 77.07, 75.94, 74.68]

Average Accuracy (CNN): 60.35
2024-09-07 15:40:37,513 [trainer.py] => Average Accuracy (CNN): 60.35 

2024-09-07 15:40:37,514 [trainer.py] => All params: 88076738
2024-09-07 15:40:37,514 [trainer.py] => Trainable params: 304320
2024-09-07 15:40:37,532 [ease.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.280, Train_accy 20.36:   0%|          | 0/20 [00:02<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.280, Train_accy 20.36:   5%|▌         | 1/20 [00:02<00:45,  2.38s/it]
Task 16, Epoch 2/20 => Loss 2.184, Train_accy 38.62:   5%|▌         | 1/20 [00:04<00:45,  2.38s/it]
Task 16, Epoch 2/20 => Loss 2.184, Train_accy 38.62:  10%|█         | 2/20 [00:04<00:42,  2.34s/it]
Task 16, Epoch 3/20 => Loss 2.054, Train_accy 44.61:  10%|█         | 2/20 [00:07<00:42,  2.34s/it]
Task 16, Epoch 3/20 => Loss 2.054, Train_accy 44.61:  15%|█▌        | 3/20 [00:07<00:39,  2.34s/it]
Task 16, Epoch 4/20 => Loss 1.892, Train_accy 50.00:  15%|█▌        | 3/20 [00:09<00:39,  2.34s/it]
Task 16, Epoch 4/20 => Loss 1.892, Train_accy 50.00:  20%|██        | 4/20 [00:09<00:38,  2.39s/it]
Task 16, Epoch 5/20 => Loss 1.735, Train_accy 55.99:  20%|██        | 4/20 [00:11<00:38,  2.39s/it]
Task 16, Epoch 5/20 => Loss 1.735, Train_accy 55.99:  25%|██▌       | 5/20 [00:11<00:36,  2.42s/it]
Task 16, Epoch 6/20 => Loss 1.594, Train_accy 61.68:  25%|██▌       | 5/20 [00:14<00:36,  2.42s/it]
Task 16, Epoch 6/20 => Loss 1.594, Train_accy 61.68:  30%|███       | 6/20 [00:14<00:34,  2.47s/it]
Task 16, Epoch 7/20 => Loss 1.471, Train_accy 65.27:  30%|███       | 6/20 [00:16<00:34,  2.47s/it]
Task 16, Epoch 7/20 => Loss 1.471, Train_accy 65.27:  35%|███▌      | 7/20 [00:16<00:31,  2.42s/it]
Task 16, Epoch 8/20 => Loss 1.387, Train_accy 71.26:  35%|███▌      | 7/20 [00:19<00:31,  2.42s/it]
Task 16, Epoch 8/20 => Loss 1.387, Train_accy 71.26:  40%|████      | 8/20 [00:19<00:28,  2.39s/it]
Task 16, Epoch 9/20 => Loss 1.287, Train_accy 76.65:  40%|████      | 8/20 [00:21<00:28,  2.39s/it]
Task 16, Epoch 9/20 => Loss 1.287, Train_accy 76.65:  45%|████▌     | 9/20 [00:21<00:26,  2.37s/it]
Task 16, Epoch 10/20 => Loss 1.259, Train_accy 77.25:  45%|████▌     | 9/20 [00:23<00:26,  2.37s/it]
Task 16, Epoch 10/20 => Loss 1.259, Train_accy 77.25:  50%|█████     | 10/20 [00:23<00:23,  2.36s/it]
Task 16, Epoch 11/20 => Loss 1.195, Train_accy 80.84:  50%|█████     | 10/20 [00:26<00:23,  2.36s/it]
Task 16, Epoch 11/20 => Loss 1.195, Train_accy 80.84:  55%|█████▌    | 11/20 [00:26<00:21,  2.35s/it]
Task 16, Epoch 12/20 => Loss 1.159, Train_accy 79.34:  55%|█████▌    | 11/20 [00:28<00:21,  2.35s/it]
Task 16, Epoch 12/20 => Loss 1.159, Train_accy 79.34:  60%|██████    | 12/20 [00:28<00:18,  2.34s/it]
Task 16, Epoch 13/20 => Loss 1.116, Train_accy 81.14:  60%|██████    | 12/20 [00:30<00:18,  2.34s/it]
Task 16, Epoch 13/20 => Loss 1.116, Train_accy 81.14:  65%|██████▌   | 13/20 [00:30<00:16,  2.33s/it]
Task 16, Epoch 14/20 => Loss 1.089, Train_accy 84.73:  65%|██████▌   | 13/20 [00:33<00:16,  2.33s/it]
Task 16, Epoch 14/20 => Loss 1.089, Train_accy 84.73:  70%|███████   | 14/20 [00:33<00:13,  2.33s/it]
Task 16, Epoch 15/20 => Loss 1.073, Train_accy 84.43:  70%|███████   | 14/20 [00:35<00:13,  2.33s/it]
Task 16, Epoch 15/20 => Loss 1.073, Train_accy 84.43:  75%|███████▌  | 15/20 [00:35<00:11,  2.33s/it]
Task 16, Epoch 16/20 => Loss 1.034, Train_accy 87.43:  75%|███████▌  | 15/20 [00:37<00:11,  2.33s/it]
Task 16, Epoch 16/20 => Loss 1.034, Train_accy 87.43:  80%|████████  | 16/20 [00:37<00:09,  2.33s/it]
Task 16, Epoch 17/20 => Loss 1.045, Train_accy 85.93:  80%|████████  | 16/20 [00:40<00:09,  2.33s/it]
Task 16, Epoch 17/20 => Loss 1.045, Train_accy 85.93:  85%|████████▌ | 17/20 [00:40<00:06,  2.33s/it]
Task 16, Epoch 18/20 => Loss 1.036, Train_accy 84.73:  85%|████████▌ | 17/20 [00:42<00:06,  2.33s/it]
Task 16, Epoch 18/20 => Loss 1.036, Train_accy 84.73:  90%|█████████ | 18/20 [00:42<00:04,  2.33s/it]
Task 16, Epoch 19/20 => Loss 1.029, Train_accy 85.63:  90%|█████████ | 18/20 [00:44<00:04,  2.33s/it]
Task 16, Epoch 19/20 => Loss 1.029, Train_accy 85.63:  95%|█████████▌| 19/20 [00:44<00:02,  2.32s/it]
Task 16, Epoch 20/20 => Loss 1.032, Train_accy 84.43:  95%|█████████▌| 19/20 [00:47<00:02,  2.32s/it]
Task 16, Epoch 20/20 => Loss 1.032, Train_accy 84.43: 100%|██████████| 20/20 [00:47<00:00,  2.33s/it]
Task 16, Epoch 20/20 => Loss 1.032, Train_accy 84.43: 100%|██████████| 20/20 [00:47<00:00,  2.35s/it]
2024-09-07 15:41:24,624 [ease.py] => Task 16, Epoch 20/20 => Loss 1.032, Train_accy 84.43
2024-09-07 15:42:56,941 [ease.py] => Task correct: 49.737434358589645
2024-09-07 15:42:56,941 [ease.py] => Task acc: 86.87171792948237
2024-09-07 15:42:56,963 [trainer.py] => No NME accuracy.
2024-09-07 15:42:56,963 [trainer.py] => CNN: {'total': 47.64, '00-09': 23.38, '10-19': 58.16, '20-29': 34.34, '30-39': 50.0, '40-49': 56.25, '50-59': 53.85, '60-69': 57.14, '70-79': 38.54, '80-89': 55.56, '90-99': 54.84, '100-109': 55.0, '110-119': 68.92, '120-129': 38.33, '130-139': 45.35, '140-149': 40.79, '150-159': 35.29, '160-169': 42.35, 'old': 48.0, 'new': 42.35}
2024-09-07 15:42:56,964 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08, 50.94, 49.96, 48.88, 47.64]
2024-09-07 15:42:56,964 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97, 77.07, 75.94, 74.68, 73.14]

Average Accuracy (CNN): 59.6
2024-09-07 15:42:56,964 [trainer.py] => Average Accuracy (CNN): 59.6 

2024-09-07 15:42:56,964 [trainer.py] => All params: 88330178
2024-09-07 15:42:56,965 [trainer.py] => Trainable params: 304320
2024-09-07 15:42:57,003 [ease.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.299, Train_accy 16.03:   0%|          | 0/20 [00:01<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.299, Train_accy 16.03:   5%|▌         | 1/20 [00:01<00:33,  1.74s/it]
Task 17, Epoch 2/20 => Loss 2.255, Train_accy 45.99:   5%|▌         | 1/20 [00:03<00:33,  1.74s/it]
Task 17, Epoch 2/20 => Loss 2.255, Train_accy 45.99:  10%|█         | 2/20 [00:03<00:31,  1.75s/it]
Task 17, Epoch 3/20 => Loss 2.189, Train_accy 56.54:  10%|█         | 2/20 [00:05<00:31,  1.75s/it]
Task 17, Epoch 3/20 => Loss 2.189, Train_accy 56.54:  15%|█▌        | 3/20 [00:05<00:29,  1.75s/it]
Task 17, Epoch 4/20 => Loss 2.101, Train_accy 58.23:  15%|█▌        | 3/20 [00:07<00:29,  1.75s/it]
Task 17, Epoch 4/20 => Loss 2.101, Train_accy 58.23:  20%|██        | 4/20 [00:07<00:28,  1.75s/it]
Task 17, Epoch 5/20 => Loss 1.996, Train_accy 59.92:  20%|██        | 4/20 [00:08<00:28,  1.75s/it]
Task 17, Epoch 5/20 => Loss 1.996, Train_accy 59.92:  25%|██▌       | 5/20 [00:08<00:26,  1.75s/it]
Task 17, Epoch 6/20 => Loss 1.889, Train_accy 65.40:  25%|██▌       | 5/20 [00:10<00:26,  1.75s/it]
Task 17, Epoch 6/20 => Loss 1.889, Train_accy 65.40:  30%|███       | 6/20 [00:10<00:24,  1.75s/it]
Task 17, Epoch 7/20 => Loss 1.764, Train_accy 65.82:  30%|███       | 6/20 [00:12<00:24,  1.75s/it]
Task 17, Epoch 7/20 => Loss 1.764, Train_accy 65.82:  35%|███▌      | 7/20 [00:12<00:22,  1.75s/it]
Task 17, Epoch 8/20 => Loss 1.656, Train_accy 69.62:  35%|███▌      | 7/20 [00:13<00:22,  1.75s/it]
Task 17, Epoch 8/20 => Loss 1.656, Train_accy 69.62:  40%|████      | 8/20 [00:13<00:20,  1.75s/it]
Task 17, Epoch 9/20 => Loss 1.557, Train_accy 70.04:  40%|████      | 8/20 [00:15<00:20,  1.75s/it]
Task 17, Epoch 9/20 => Loss 1.557, Train_accy 70.04:  45%|████▌     | 9/20 [00:15<00:19,  1.74s/it]
Task 17, Epoch 10/20 => Loss 1.465, Train_accy 72.57:  45%|████▌     | 9/20 [00:17<00:19,  1.74s/it]
Task 17, Epoch 10/20 => Loss 1.465, Train_accy 72.57:  50%|█████     | 10/20 [00:17<00:17,  1.75s/it]
Task 17, Epoch 11/20 => Loss 1.380, Train_accy 75.11:  50%|█████     | 10/20 [00:19<00:17,  1.75s/it]
Task 17, Epoch 11/20 => Loss 1.380, Train_accy 75.11:  55%|█████▌    | 11/20 [00:19<00:15,  1.75s/it]
Task 17, Epoch 12/20 => Loss 1.323, Train_accy 75.11:  55%|█████▌    | 11/20 [00:20<00:15,  1.75s/it]
Task 17, Epoch 12/20 => Loss 1.323, Train_accy 75.11:  60%|██████    | 12/20 [00:20<00:14,  1.75s/it]
Task 17, Epoch 13/20 => Loss 1.282, Train_accy 75.95:  60%|██████    | 12/20 [00:22<00:14,  1.75s/it]
Task 17, Epoch 13/20 => Loss 1.282, Train_accy 75.95:  65%|██████▌   | 13/20 [00:22<00:12,  1.75s/it]
Task 17, Epoch 14/20 => Loss 1.226, Train_accy 78.48:  65%|██████▌   | 13/20 [00:24<00:12,  1.75s/it]
Task 17, Epoch 14/20 => Loss 1.226, Train_accy 78.48:  70%|███████   | 14/20 [00:24<00:10,  1.75s/it]
Task 17, Epoch 15/20 => Loss 1.241, Train_accy 79.75:  70%|███████   | 14/20 [00:26<00:10,  1.75s/it]
Task 17, Epoch 15/20 => Loss 1.241, Train_accy 79.75:  75%|███████▌  | 15/20 [00:26<00:08,  1.75s/it]
Task 17, Epoch 16/20 => Loss 1.191, Train_accy 83.54:  75%|███████▌  | 15/20 [00:28<00:08,  1.75s/it]
Task 17, Epoch 16/20 => Loss 1.191, Train_accy 83.54:  80%|████████  | 16/20 [00:28<00:07,  1.76s/it]
Task 17, Epoch 17/20 => Loss 1.202, Train_accy 80.17:  80%|████████  | 16/20 [00:29<00:07,  1.76s/it]
Task 17, Epoch 17/20 => Loss 1.202, Train_accy 80.17:  85%|████████▌ | 17/20 [00:29<00:05,  1.77s/it]
Task 17, Epoch 18/20 => Loss 1.191, Train_accy 80.17:  85%|████████▌ | 17/20 [00:31<00:05,  1.77s/it]
Task 17, Epoch 18/20 => Loss 1.191, Train_accy 80.17:  90%|█████████ | 18/20 [00:31<00:03,  1.76s/it]
Task 17, Epoch 19/20 => Loss 1.189, Train_accy 78.48:  90%|█████████ | 18/20 [00:33<00:03,  1.76s/it]
Task 17, Epoch 19/20 => Loss 1.189, Train_accy 78.48:  95%|█████████▌| 19/20 [00:33<00:01,  1.76s/it]
Task 17, Epoch 20/20 => Loss 1.186, Train_accy 79.75:  95%|█████████▌| 19/20 [00:35<00:01,  1.76s/it]
Task 17, Epoch 20/20 => Loss 1.186, Train_accy 79.75: 100%|██████████| 20/20 [00:35<00:00,  1.76s/it]
Task 17, Epoch 20/20 => Loss 1.186, Train_accy 79.75: 100%|██████████| 20/20 [00:35<00:00,  1.75s/it]
2024-09-07 15:43:32,103 [ease.py] => Task 17, Epoch 20/20 => Loss 1.186, Train_accy 79.75
2024-09-07 15:45:08,328 [ease.py] => Task correct: 49.03225806451613
2024-09-07 15:45:08,329 [ease.py] => Task acc: 86.37992831541219
2024-09-07 15:45:08,350 [trainer.py] => No NME accuracy.
2024-09-07 15:45:08,350 [trainer.py] => CNN: {'total': 47.03, '00-09': 23.38, '10-19': 58.16, '20-29': 34.34, '30-39': 50.0, '40-49': 56.25, '50-59': 53.85, '60-69': 57.94, '70-79': 37.5, '80-89': 55.56, '90-99': 53.23, '100-109': 55.0, '110-119': 67.57, '120-129': 36.67, '130-139': 45.35, '140-149': 40.79, '150-159': 35.29, '160-169': 40.0, '170-179': 41.94, 'old': 47.26, 'new': 41.94}
2024-09-07 15:45:08,350 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08, 50.94, 49.96, 48.88, 47.64, 47.03]
2024-09-07 15:45:08,350 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97, 77.07, 75.94, 74.68, 73.14, 72.19]

Average Accuracy (CNN): 58.91
2024-09-07 15:45:08,350 [trainer.py] => Average Accuracy (CNN): 58.91 

2024-09-07 15:45:08,351 [trainer.py] => All params: 88598978
2024-09-07 15:45:08,352 [trainer.py] => Trainable params: 304320
2024-09-07 15:45:08,393 [ease.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.291, Train_accy 17.46:   0%|          | 0/20 [00:01<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.291, Train_accy 17.46:   5%|▌         | 1/20 [00:01<00:29,  1.53s/it]
Task 18, Epoch 2/20 => Loss 2.239, Train_accy 43.39:   5%|▌         | 1/20 [00:03<00:29,  1.53s/it]
Task 18, Epoch 2/20 => Loss 2.239, Train_accy 43.39:  10%|█         | 2/20 [00:03<00:26,  1.50s/it]
Task 18, Epoch 3/20 => Loss 2.152, Train_accy 51.85:  10%|█         | 2/20 [00:04<00:26,  1.50s/it]
Task 18, Epoch 3/20 => Loss 2.152, Train_accy 51.85:  15%|█▌        | 3/20 [00:04<00:25,  1.49s/it]
Task 18, Epoch 4/20 => Loss 2.067, Train_accy 54.50:  15%|█▌        | 3/20 [00:05<00:25,  1.49s/it]
Task 18, Epoch 4/20 => Loss 2.067, Train_accy 54.50:  20%|██        | 4/20 [00:05<00:23,  1.48s/it]
Task 18, Epoch 5/20 => Loss 1.955, Train_accy 58.20:  20%|██        | 4/20 [00:07<00:23,  1.48s/it]
Task 18, Epoch 5/20 => Loss 1.955, Train_accy 58.20:  25%|██▌       | 5/20 [00:07<00:22,  1.49s/it]
Task 18, Epoch 6/20 => Loss 1.852, Train_accy 60.32:  25%|██▌       | 5/20 [00:08<00:22,  1.49s/it]
Task 18, Epoch 6/20 => Loss 1.852, Train_accy 60.32:  30%|███       | 6/20 [00:08<00:20,  1.48s/it]
Task 18, Epoch 7/20 => Loss 1.724, Train_accy 59.79:  30%|███       | 6/20 [00:10<00:20,  1.48s/it]
Task 18, Epoch 7/20 => Loss 1.724, Train_accy 59.79:  35%|███▌      | 7/20 [00:10<00:19,  1.48s/it]
Task 18, Epoch 8/20 => Loss 1.599, Train_accy 65.61:  35%|███▌      | 7/20 [00:11<00:19,  1.48s/it]
Task 18, Epoch 8/20 => Loss 1.599, Train_accy 65.61:  40%|████      | 8/20 [00:11<00:17,  1.47s/it]
Task 18, Epoch 9/20 => Loss 1.499, Train_accy 67.72:  40%|████      | 8/20 [00:13<00:17,  1.47s/it]
Task 18, Epoch 9/20 => Loss 1.499, Train_accy 67.72:  45%|████▌     | 9/20 [00:13<00:16,  1.48s/it]
Task 18, Epoch 10/20 => Loss 1.403, Train_accy 68.78:  45%|████▌     | 9/20 [00:14<00:16,  1.48s/it]
Task 18, Epoch 10/20 => Loss 1.403, Train_accy 68.78:  50%|█████     | 10/20 [00:14<00:14,  1.47s/it]
Task 18, Epoch 11/20 => Loss 1.338, Train_accy 73.02:  50%|█████     | 10/20 [00:16<00:14,  1.47s/it]
Task 18, Epoch 11/20 => Loss 1.338, Train_accy 73.02:  55%|█████▌    | 11/20 [00:16<00:13,  1.48s/it]
Task 18, Epoch 12/20 => Loss 1.259, Train_accy 74.60:  55%|█████▌    | 11/20 [00:17<00:13,  1.48s/it]
Task 18, Epoch 12/20 => Loss 1.259, Train_accy 74.60:  60%|██████    | 12/20 [00:17<00:11,  1.47s/it]
Task 18, Epoch 13/20 => Loss 1.237, Train_accy 77.25:  60%|██████    | 12/20 [00:19<00:11,  1.47s/it]
Task 18, Epoch 13/20 => Loss 1.237, Train_accy 77.25:  65%|██████▌   | 13/20 [00:19<00:10,  1.48s/it]
Task 18, Epoch 14/20 => Loss 1.187, Train_accy 80.95:  65%|██████▌   | 13/20 [00:20<00:10,  1.48s/it]
Task 18, Epoch 14/20 => Loss 1.187, Train_accy 80.95:  70%|███████   | 14/20 [00:20<00:08,  1.48s/it]
Task 18, Epoch 15/20 => Loss 1.174, Train_accy 83.60:  70%|███████   | 14/20 [00:22<00:08,  1.48s/it]
Task 18, Epoch 15/20 => Loss 1.174, Train_accy 83.60:  75%|███████▌  | 15/20 [00:22<00:07,  1.49s/it]
Task 18, Epoch 16/20 => Loss 1.172, Train_accy 82.01:  75%|███████▌  | 15/20 [00:23<00:07,  1.49s/it]
Task 18, Epoch 16/20 => Loss 1.172, Train_accy 82.01:  80%|████████  | 16/20 [00:23<00:05,  1.49s/it]
Task 18, Epoch 17/20 => Loss 1.136, Train_accy 82.54:  80%|████████  | 16/20 [00:25<00:05,  1.49s/it]
Task 18, Epoch 17/20 => Loss 1.136, Train_accy 82.54:  85%|████████▌ | 17/20 [00:25<00:04,  1.49s/it]
Task 18, Epoch 18/20 => Loss 1.122, Train_accy 80.95:  85%|████████▌ | 17/20 [00:26<00:04,  1.49s/it]
Task 18, Epoch 18/20 => Loss 1.122, Train_accy 80.95:  90%|█████████ | 18/20 [00:26<00:03,  1.51s/it]
Task 18, Epoch 19/20 => Loss 1.116, Train_accy 83.60:  90%|█████████ | 18/20 [00:28<00:03,  1.51s/it]
Task 18, Epoch 19/20 => Loss 1.116, Train_accy 83.60:  95%|█████████▌| 19/20 [00:28<00:01,  1.50s/it]
Task 18, Epoch 20/20 => Loss 1.110, Train_accy 81.48:  95%|█████████▌| 19/20 [00:29<00:01,  1.50s/it]
Task 18, Epoch 20/20 => Loss 1.110, Train_accy 81.48: 100%|██████████| 20/20 [00:29<00:00,  1.51s/it]
Task 18, Epoch 20/20 => Loss 1.110, Train_accy 81.48: 100%|██████████| 20/20 [00:29<00:00,  1.49s/it]
2024-09-07 15:45:38,176 [ease.py] => Task 18, Epoch 20/20 => Loss 1.110, Train_accy 81.48
2024-09-07 15:47:19,651 [ease.py] => Task correct: 48.95397489539749
2024-09-07 15:47:19,652 [ease.py] => Task acc: 86.26220362622037
2024-09-07 15:47:19,673 [trainer.py] => No NME accuracy.
2024-09-07 15:47:19,674 [trainer.py] => CNN: {'total': 46.93, '00-09': 23.38, '10-19': 58.16, '20-29': 34.34, '30-39': 50.0, '40-49': 56.25, '50-59': 53.85, '60-69': 57.94, '70-79': 35.42, '80-89': 55.56, '90-99': 53.23, '100-109': 53.33, '110-119': 67.57, '120-129': 35.0, '130-139': 45.35, '140-149': 40.79, '150-159': 35.29, '160-169': 38.82, '170-179': 41.94, '180-189': 56.41, 'old': 46.67, 'new': 56.41}
2024-09-07 15:47:19,674 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08, 50.94, 49.96, 48.88, 47.64, 47.03, 46.93]
2024-09-07 15:47:19,674 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97, 77.07, 75.94, 74.68, 73.14, 72.19, 71.41]

Average Accuracy (CNN): 58.28
2024-09-07 15:47:19,674 [trainer.py] => Average Accuracy (CNN): 58.28 

2024-09-07 15:47:19,674 [trainer.py] => All params: 88883138
2024-09-07 15:47:19,675 [trainer.py] => Trainable params: 304320
2024-09-07 15:47:19,698 [ease.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.281, Train_accy 19.23:   0%|          | 0/20 [00:02<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.281, Train_accy 19.23:   5%|▌         | 1/20 [00:02<00:44,  2.36s/it]
Task 19, Epoch 2/20 => Loss 2.173, Train_accy 51.48:   5%|▌         | 1/20 [00:04<00:44,  2.36s/it]
Task 19, Epoch 2/20 => Loss 2.173, Train_accy 51.48:  10%|█         | 2/20 [00:04<00:43,  2.41s/it]
Task 19, Epoch 3/20 => Loss 1.972, Train_accy 59.47:  10%|█         | 2/20 [00:07<00:43,  2.41s/it]
Task 19, Epoch 3/20 => Loss 1.972, Train_accy 59.47:  15%|█▌        | 3/20 [00:07<00:40,  2.38s/it]
Task 19, Epoch 4/20 => Loss 1.768, Train_accy 67.46:  15%|█▌        | 3/20 [00:09<00:40,  2.38s/it]
Task 19, Epoch 4/20 => Loss 1.768, Train_accy 67.46:  20%|██        | 4/20 [00:09<00:38,  2.38s/it]
Task 19, Epoch 5/20 => Loss 1.622, Train_accy 71.60:  20%|██        | 4/20 [00:11<00:38,  2.38s/it]
Task 19, Epoch 5/20 => Loss 1.622, Train_accy 71.60:  25%|██▌       | 5/20 [00:11<00:35,  2.38s/it]
Task 19, Epoch 6/20 => Loss 1.354, Train_accy 74.85:  25%|██▌       | 5/20 [00:14<00:35,  2.38s/it]
Task 19, Epoch 6/20 => Loss 1.354, Train_accy 74.85:  30%|███       | 6/20 [00:14<00:33,  2.38s/it]
Task 19, Epoch 7/20 => Loss 1.407, Train_accy 76.63:  30%|███       | 6/20 [00:16<00:33,  2.38s/it]
Task 19, Epoch 7/20 => Loss 1.407, Train_accy 76.63:  35%|███▌      | 7/20 [00:16<00:31,  2.40s/it]
Task 19, Epoch 8/20 => Loss 1.132, Train_accy 82.25:  35%|███▌      | 7/20 [00:19<00:31,  2.40s/it]
Task 19, Epoch 8/20 => Loss 1.132, Train_accy 82.25:  40%|████      | 8/20 [00:19<00:28,  2.39s/it]
Task 19, Epoch 9/20 => Loss 1.043, Train_accy 83.73:  40%|████      | 8/20 [00:21<00:28,  2.39s/it]
Task 19, Epoch 9/20 => Loss 1.043, Train_accy 83.73:  45%|████▌     | 9/20 [00:21<00:26,  2.39s/it]
Task 19, Epoch 10/20 => Loss 0.966, Train_accy 86.69:  45%|████▌     | 9/20 [00:23<00:26,  2.39s/it]
Task 19, Epoch 10/20 => Loss 0.966, Train_accy 86.69:  50%|█████     | 10/20 [00:23<00:23,  2.38s/it]
Task 19, Epoch 11/20 => Loss 0.918, Train_accy 88.76:  50%|█████     | 10/20 [00:26<00:23,  2.38s/it]
Task 19, Epoch 11/20 => Loss 0.918, Train_accy 88.76:  55%|█████▌    | 11/20 [00:26<00:21,  2.38s/it]
Task 19, Epoch 12/20 => Loss 0.858, Train_accy 87.87:  55%|█████▌    | 11/20 [00:28<00:21,  2.38s/it]
Task 19, Epoch 12/20 => Loss 0.858, Train_accy 87.87:  60%|██████    | 12/20 [00:28<00:18,  2.37s/it]
Task 19, Epoch 13/20 => Loss 0.893, Train_accy 86.39:  60%|██████    | 12/20 [00:30<00:18,  2.37s/it]
Task 19, Epoch 13/20 => Loss 0.893, Train_accy 86.39:  65%|██████▌   | 13/20 [00:30<00:16,  2.38s/it]
Task 19, Epoch 14/20 => Loss 0.798, Train_accy 86.98:  65%|██████▌   | 13/20 [00:33<00:16,  2.38s/it]
Task 19, Epoch 14/20 => Loss 0.798, Train_accy 86.98:  70%|███████   | 14/20 [00:33<00:14,  2.37s/it]
Task 19, Epoch 15/20 => Loss 0.788, Train_accy 87.87:  70%|███████   | 14/20 [00:35<00:14,  2.37s/it]
Task 19, Epoch 15/20 => Loss 0.788, Train_accy 87.87:  75%|███████▌  | 15/20 [00:35<00:11,  2.37s/it]
Task 19, Epoch 16/20 => Loss 0.784, Train_accy 91.12:  75%|███████▌  | 15/20 [00:38<00:11,  2.37s/it]
Task 19, Epoch 16/20 => Loss 0.784, Train_accy 91.12:  80%|████████  | 16/20 [00:38<00:09,  2.37s/it]
Task 19, Epoch 17/20 => Loss 0.823, Train_accy 85.80:  80%|████████  | 16/20 [00:40<00:09,  2.37s/it]
Task 19, Epoch 17/20 => Loss 0.823, Train_accy 85.80:  85%|████████▌ | 17/20 [00:40<00:07,  2.37s/it]
Task 19, Epoch 18/20 => Loss 0.744, Train_accy 89.35:  85%|████████▌ | 17/20 [00:42<00:07,  2.37s/it]
Task 19, Epoch 18/20 => Loss 0.744, Train_accy 89.35:  90%|█████████ | 18/20 [00:42<00:04,  2.38s/it]
Task 19, Epoch 19/20 => Loss 0.726, Train_accy 89.64:  90%|█████████ | 18/20 [00:45<00:04,  2.38s/it]
Task 19, Epoch 19/20 => Loss 0.726, Train_accy 89.64:  95%|█████████▌| 19/20 [00:45<00:02,  2.38s/it]
Task 19, Epoch 20/20 => Loss 0.775, Train_accy 91.12:  95%|█████████▌| 19/20 [00:47<00:02,  2.38s/it]
Task 19, Epoch 20/20 => Loss 0.775, Train_accy 91.12: 100%|██████████| 20/20 [00:47<00:00,  2.37s/it]
Task 19, Epoch 20/20 => Loss 0.775, Train_accy 91.12: 100%|██████████| 20/20 [00:47<00:00,  2.38s/it]
2024-09-07 15:48:07,310 [ease.py] => Task 19, Epoch 20/20 => Loss 0.775, Train_accy 91.12
2024-09-07 15:50:08,298 [ease.py] => Task correct: 48.18959842001317
2024-09-07 15:50:08,298 [ease.py] => Task acc: 85.7801184990125
2024-09-07 15:50:08,321 [trainer.py] => No NME accuracy.
2024-09-07 15:50:08,321 [trainer.py] => CNN: {'total': 46.35, '00-09': 22.08, '10-19': 58.16, '20-29': 34.34, '30-39': 50.0, '40-49': 56.25, '50-59': 53.85, '60-69': 57.94, '70-79': 35.42, '80-89': 55.56, '90-99': 53.23, '100-109': 50.0, '110-119': 66.22, '120-129': 35.0, '130-139': 45.35, '140-149': 40.79, '150-159': 35.29, '160-169': 38.82, '170-179': 37.1, '180-189': 56.41, '190-199': 44.71, 'old': 46.44, 'new': 44.71}
2024-09-07 15:50:08,321 [trainer.py] => CNN top1 curve: [81.82, 74.86, 73.36, 70.56, 63.68, 61.34, 59.97, 58.02, 57.12, 54.93, 54.16, 53.95, 52.08, 50.94, 49.96, 48.88, 47.64, 47.03, 46.93, 46.35]
2024-09-07 15:50:08,321 [trainer.py] => CNN top5 curve: [96.1, 96.0, 93.43, 92.5, 88.44, 87.61, 85.22, 84.81, 83.06, 80.26, 79.8, 78.87, 77.97, 77.07, 75.94, 74.68, 73.14, 72.19, 71.41, 70.84]

Average Accuracy (CNN): 57.68
2024-09-07 15:50:08,321 [trainer.py] => Average Accuracy (CNN): 57.68 

Accuracy Matrix (CNN):
[[81.82 62.34 62.34 57.14 42.86 41.56 40.26 32.47 29.87 23.38 22.08 23.38
  23.38 23.38 23.38 23.38 23.38 23.38 23.38 22.08]
 [ 0.   84.69 82.65 78.57 77.55 71.43 71.43 69.39 67.35 65.31 65.31 64.29
  60.2  59.18 59.18 58.16 58.16 58.16 58.16 58.16]
 [ 0.    0.   72.73 71.72 54.55 51.52 48.48 47.47 43.43 41.41 41.41 39.39
  37.37 37.37 35.35 35.35 34.34 34.34 34.34 34.34]
 [ 0.    0.    0.   72.09 65.12 61.63 54.65 54.65 53.49 53.49 52.33 52.33
  52.33 52.33 51.16 51.16 50.   50.   50.   50.  ]
 [ 0.    0.    0.    0.   79.69 73.44 65.62 65.62 65.62 62.5  62.5  60.94
  59.38 59.38 59.38 57.81 56.25 56.25 56.25 56.25]
 [ 0.    0.    0.    0.    0.   75.   75.   75.   71.15 67.31 65.38 61.54
  59.62 57.69 55.77 53.85 53.85 53.85 53.85 53.85]
 [ 0.    0.    0.    0.    0.    0.   66.67 66.67 66.67 64.29 62.7  62.7
  61.9  58.73 58.73 57.94 57.14 57.94 57.94 57.94]
 [ 0.    0.    0.    0.    0.    0.    0.   55.21 51.04 46.88 45.83 43.75
  40.62 39.58 39.58 39.58 38.54 37.5  35.42 35.42]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   67.9  60.49 58.02 58.02
  58.02 58.02 56.79 56.79 55.56 55.56 55.56 55.56]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   69.35 69.35 59.68
  58.06 58.06 58.06 56.45 54.84 53.23 53.23 53.23]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   56.67 56.67
  56.67 56.67 55.   55.   55.   55.   53.33 50.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   68.92
  68.92 68.92 68.92 68.92 68.92 67.57 67.57 66.22]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  43.33 43.33 43.33 41.67 38.33 36.67 35.   35.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   45.35 45.35 45.35 45.35 45.35 45.35 45.35]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   43.42 43.42 40.79 40.79 40.79 40.79]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   35.29 35.29 35.29 35.29 35.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   42.35 40.   38.82 38.82]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   41.94 41.94 37.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   56.41 56.41]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   44.71]]
2024-09-07 15:50:08,323 [trainer.py] => Forgetting (CNN): 14.579999999999997
2024-09-07 15:50:11,066 [trainer.py] => config: ./exps/ease_ina_B100_Inc5.json
2024-09-07 15:50:11,081 [trainer.py] => prefix:  
2024-09-07 15:50:11,081 [trainer.py] => dataset: imageneta
2024-09-07 15:50:11,081 [trainer.py] => memory_size: 0
2024-09-07 15:50:11,081 [trainer.py] => memory_per_class: 0
2024-09-07 15:50:11,081 [trainer.py] => fixed_memory: False
2024-09-07 15:50:11,081 [trainer.py] => shuffle: True
2024-09-07 15:50:11,081 [trainer.py] => init_cls: 100
2024-09-07 15:50:11,081 [trainer.py] => increment: 20
2024-09-07 15:50:11,081 [trainer.py] => model_name: ease
2024-09-07 15:50:11,081 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-07 15:50:11,082 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 15:50:11,082 [trainer.py] => seed: 1993
2024-09-07 15:50:11,082 [trainer.py] => init_epochs: 20
2024-09-07 15:50:11,082 [trainer.py] => init_lr: 0.05
2024-09-07 15:50:11,082 [trainer.py] => later_epochs: 20
2024-09-07 15:50:11,082 [trainer.py] => later_lr: 0.05
2024-09-07 15:50:11,082 [trainer.py] => batch_size: 48
2024-09-07 15:50:11,082 [trainer.py] => weight_decay: 0.005
2024-09-07 15:50:11,082 [trainer.py] => min_lr: 0
2024-09-07 15:50:11,082 [trainer.py] => optimizer: sgd
2024-09-07 15:50:11,082 [trainer.py] => scheduler: cosine
2024-09-07 15:50:11,082 [trainer.py] => pretrained: True
2024-09-07 15:50:11,082 [trainer.py] => vpt_type: Deep
2024-09-07 15:50:11,082 [trainer.py] => prompt_token_num: 5
2024-09-07 15:50:11,082 [trainer.py] => ffn_num: 16
2024-09-07 15:50:11,082 [trainer.py] => use_diagonal: False
2024-09-07 15:50:11,082 [trainer.py] => recalc_sim: True
2024-09-07 15:50:11,082 [trainer.py] => alpha: 0.1
2024-09-07 15:50:11,082 [trainer.py] => use_init_ptm: False
2024-09-07 15:50:11,082 [trainer.py] => beta: 0
2024-09-07 15:50:11,082 [trainer.py] => use_old_data: False
2024-09-07 15:50:11,082 [trainer.py] => use_reweight: True
2024-09-07 15:50:11,082 [trainer.py] => moni_adam: False
2024-09-07 15:50:11,082 [trainer.py] => adapter_num: -1
2024-09-07 15:50:11,111 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-07 15:50:13,925 [trainer.py] => All params: 86102976
2024-09-07 15:50:13,926 [trainer.py] => Trainable params: 304320
2024-09-07 15:50:13,937 [ease.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.428, Train_accy 15.81:   0%|          | 0/20 [00:19<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.428, Train_accy 15.81:   5%|▌         | 1/20 [00:19<06:18, 19.94s/it]
Task 0, Epoch 2/20 => Loss 3.052, Train_accy 47.57:   5%|▌         | 1/20 [00:39<06:18, 19.94s/it]
Task 0, Epoch 2/20 => Loss 3.052, Train_accy 47.57:  10%|█         | 2/20 [00:39<05:54, 19.71s/it]
Task 0, Epoch 3/20 => Loss 1.727, Train_accy 63.50:  10%|█         | 2/20 [00:59<05:54, 19.71s/it]
Task 0, Epoch 3/20 => Loss 1.727, Train_accy 63.50:  15%|█▌        | 3/20 [00:59<05:34, 19.66s/it]
Task 0, Epoch 4/20 => Loss 1.405, Train_accy 69.64:  15%|█▌        | 3/20 [01:18<05:34, 19.66s/it]
Task 0, Epoch 4/20 => Loss 1.405, Train_accy 69.64:  20%|██        | 4/20 [01:18<05:14, 19.65s/it]
Task 0, Epoch 5/20 => Loss 1.238, Train_accy 73.25:  20%|██        | 4/20 [01:38<05:14, 19.65s/it]
Task 0, Epoch 5/20 => Loss 1.238, Train_accy 73.25:  25%|██▌       | 5/20 [01:38<04:54, 19.65s/it]
Task 0, Epoch 6/20 => Loss 1.246, Train_accy 72.49:  25%|██▌       | 5/20 [01:58<04:54, 19.65s/it]
Task 0, Epoch 6/20 => Loss 1.246, Train_accy 72.49:  30%|███       | 6/20 [01:58<04:35, 19.67s/it]
Task 0, Epoch 7/20 => Loss 1.127, Train_accy 75.50:  30%|███       | 6/20 [02:17<04:35, 19.67s/it]
Task 0, Epoch 7/20 => Loss 1.127, Train_accy 75.50:  35%|███▌      | 7/20 [02:17<04:16, 19.70s/it]
Task 0, Epoch 8/20 => Loss 1.160, Train_accy 75.47:  35%|███▌      | 7/20 [02:37<04:16, 19.70s/it]
Task 0, Epoch 8/20 => Loss 1.160, Train_accy 75.47:  40%|████      | 8/20 [02:37<03:57, 19.75s/it]
Task 0, Epoch 9/20 => Loss 1.079, Train_accy 76.90:  40%|████      | 8/20 [02:57<03:57, 19.75s/it]
Task 0, Epoch 9/20 => Loss 1.079, Train_accy 76.90:  45%|████▌     | 9/20 [02:57<03:37, 19.74s/it]
Task 0, Epoch 10/20 => Loss 1.064, Train_accy 76.78:  45%|████▌     | 9/20 [03:17<03:37, 19.74s/it]
Task 0, Epoch 10/20 => Loss 1.064, Train_accy 76.78:  50%|█████     | 10/20 [03:17<03:17, 19.73s/it]
Task 0, Epoch 11/20 => Loss 1.024, Train_accy 78.18:  50%|█████     | 10/20 [03:36<03:17, 19.73s/it]
Task 0, Epoch 11/20 => Loss 1.024, Train_accy 78.18:  55%|█████▌    | 11/20 [03:36<02:57, 19.70s/it]
Task 0, Epoch 12/20 => Loss 1.026, Train_accy 78.45:  55%|█████▌    | 11/20 [03:56<02:57, 19.70s/it]
Task 0, Epoch 12/20 => Loss 1.026, Train_accy 78.45:  60%|██████    | 12/20 [03:56<02:37, 19.72s/it]
Task 0, Epoch 13/20 => Loss 0.970, Train_accy 79.70:  60%|██████    | 12/20 [04:16<02:37, 19.72s/it]
Task 0, Epoch 13/20 => Loss 0.970, Train_accy 79.70:  65%|██████▌   | 13/20 [04:16<02:18, 19.73s/it]
Task 0, Epoch 14/20 => Loss 0.959, Train_accy 80.12:  65%|██████▌   | 13/20 [04:36<02:18, 19.73s/it]
Task 0, Epoch 14/20 => Loss 0.959, Train_accy 80.12:  70%|███████   | 14/20 [04:36<01:58, 19.77s/it]
Task 0, Epoch 15/20 => Loss 0.951, Train_accy 80.40:  70%|███████   | 14/20 [04:55<01:58, 19.77s/it]
Task 0, Epoch 15/20 => Loss 0.951, Train_accy 80.40:  75%|███████▌  | 15/20 [04:55<01:38, 19.79s/it]
Task 0, Epoch 16/20 => Loss 0.919, Train_accy 81.22:  75%|███████▌  | 15/20 [05:15<01:38, 19.79s/it]
Task 0, Epoch 16/20 => Loss 0.919, Train_accy 81.22:  80%|████████  | 16/20 [05:15<01:19, 19.81s/it]
Task 0, Epoch 17/20 => Loss 0.931, Train_accy 80.85:  80%|████████  | 16/20 [05:35<01:19, 19.81s/it]
Task 0, Epoch 17/20 => Loss 0.931, Train_accy 80.85:  85%|████████▌ | 17/20 [05:35<00:59, 19.82s/it]
Task 0, Epoch 18/20 => Loss 0.879, Train_accy 82.31:  85%|████████▌ | 17/20 [05:55<00:59, 19.82s/it]
Task 0, Epoch 18/20 => Loss 0.879, Train_accy 82.31:  90%|█████████ | 18/20 [05:55<00:39, 19.82s/it]
Task 0, Epoch 19/20 => Loss 0.859, Train_accy 82.52:  90%|█████████ | 18/20 [06:15<00:39, 19.82s/it]
Task 0, Epoch 19/20 => Loss 0.859, Train_accy 82.52:  95%|█████████▌| 19/20 [06:15<00:19, 19.81s/it]
Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74:  95%|█████████▌| 19/20 [06:35<00:19, 19.81s/it]
Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74: 100%|██████████| 20/20 [06:35<00:00, 19.79s/it]
Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74: 100%|██████████| 20/20 [06:35<00:00, 19.75s/it]
2024-09-07 15:56:49,071 [ease.py] => Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74
2024-09-07 15:57:02,731 [ease.py] => Task correct: 77.88347205707491
2024-09-07 15:57:02,732 [ease.py] => Task acc: 85.96908442330559
2024-09-07 15:57:02,756 [trainer.py] => No NME accuracy.
2024-09-07 15:57:02,756 [trainer.py] => CNN: {'total': 73.84, '00-99': 73.84, 'old': 0, 'new': 73.84}
2024-09-07 15:57:02,757 [trainer.py] => CNN top1 curve: [73.84]
2024-09-07 15:57:02,757 [trainer.py] => CNN top5 curve: [92.15]

Average Accuracy (CNN): 73.84
2024-09-07 15:57:02,757 [trainer.py] => Average Accuracy (CNN): 73.84 

2024-09-07 15:57:02,758 [trainer.py] => All params: 86256578
2024-09-07 15:57:02,758 [trainer.py] => Trainable params: 304320
2024-09-07 15:57:02,761 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.957, Train_accy 25.43:   0%|          | 0/20 [00:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.957, Train_accy 25.43:   5%|▌         | 1/20 [00:03<01:05,  3.45s/it]
Task 1, Epoch 2/20 => Loss 2.771, Train_accy 57.17:   5%|▌         | 1/20 [00:06<01:05,  3.45s/it]
Task 1, Epoch 2/20 => Loss 2.771, Train_accy 57.17:  10%|█         | 2/20 [00:06<01:03,  3.50s/it]
Task 1, Epoch 3/20 => Loss 2.433, Train_accy 59.08:  10%|█         | 2/20 [00:10<01:03,  3.50s/it]
Task 1, Epoch 3/20 => Loss 2.433, Train_accy 59.08:  15%|█▌        | 3/20 [00:10<00:59,  3.50s/it]
Task 1, Epoch 4/20 => Loss 1.985, Train_accy 67.11:  15%|█▌        | 3/20 [00:14<00:59,  3.50s/it]
Task 1, Epoch 4/20 => Loss 1.985, Train_accy 67.11:  20%|██        | 4/20 [00:14<00:56,  3.52s/it]
Task 1, Epoch 5/20 => Loss 1.615, Train_accy 72.08:  20%|██        | 4/20 [00:17<00:56,  3.52s/it]
Task 1, Epoch 5/20 => Loss 1.615, Train_accy 72.08:  25%|██▌       | 5/20 [00:17<00:52,  3.50s/it]
Task 1, Epoch 6/20 => Loss 1.334, Train_accy 80.11:  25%|██▌       | 5/20 [00:20<00:52,  3.50s/it]
Task 1, Epoch 6/20 => Loss 1.334, Train_accy 80.11:  30%|███       | 6/20 [00:20<00:48,  3.49s/it]
Task 1, Epoch 7/20 => Loss 1.111, Train_accy 85.85:  30%|███       | 6/20 [00:24<00:48,  3.49s/it]
Task 1, Epoch 7/20 => Loss 1.111, Train_accy 85.85:  35%|███▌      | 7/20 [00:24<00:45,  3.49s/it]
Task 1, Epoch 8/20 => Loss 0.957, Train_accy 87.57:  35%|███▌      | 7/20 [00:27<00:45,  3.49s/it]
Task 1, Epoch 8/20 => Loss 0.957, Train_accy 87.57:  40%|████      | 8/20 [00:27<00:41,  3.49s/it]
Task 1, Epoch 9/20 => Loss 0.833, Train_accy 89.87:  40%|████      | 8/20 [00:31<00:41,  3.49s/it]
Task 1, Epoch 9/20 => Loss 0.833, Train_accy 89.87:  45%|████▌     | 9/20 [00:31<00:38,  3.48s/it]
Task 1, Epoch 10/20 => Loss 0.735, Train_accy 90.06:  45%|████▌     | 9/20 [00:34<00:38,  3.48s/it]
Task 1, Epoch 10/20 => Loss 0.735, Train_accy 90.06:  50%|█████     | 10/20 [00:34<00:34,  3.47s/it]
Task 1, Epoch 11/20 => Loss 0.726, Train_accy 88.15:  50%|█████     | 10/20 [00:38<00:34,  3.47s/it]
Task 1, Epoch 11/20 => Loss 0.726, Train_accy 88.15:  55%|█████▌    | 11/20 [00:38<00:31,  3.47s/it]
Task 1, Epoch 12/20 => Loss 0.670, Train_accy 90.44:  55%|█████▌    | 11/20 [00:41<00:31,  3.47s/it]
Task 1, Epoch 12/20 => Loss 0.670, Train_accy 90.44:  60%|██████    | 12/20 [00:41<00:27,  3.46s/it]
Task 1, Epoch 13/20 => Loss 0.641, Train_accy 90.06:  60%|██████    | 12/20 [00:45<00:27,  3.46s/it]
Task 1, Epoch 13/20 => Loss 0.641, Train_accy 90.06:  65%|██████▌   | 13/20 [00:45<00:24,  3.47s/it]
Task 1, Epoch 14/20 => Loss 0.595, Train_accy 91.78:  65%|██████▌   | 13/20 [00:48<00:24,  3.47s/it]
Task 1, Epoch 14/20 => Loss 0.595, Train_accy 91.78:  70%|███████   | 14/20 [00:48<00:20,  3.47s/it]
Task 1, Epoch 15/20 => Loss 0.564, Train_accy 92.54:  70%|███████   | 14/20 [00:52<00:20,  3.47s/it]
Task 1, Epoch 15/20 => Loss 0.564, Train_accy 92.54:  75%|███████▌  | 15/20 [00:52<00:17,  3.46s/it]
Task 1, Epoch 16/20 => Loss 0.582, Train_accy 91.78:  75%|███████▌  | 15/20 [00:55<00:17,  3.46s/it]
Task 1, Epoch 16/20 => Loss 0.582, Train_accy 91.78:  80%|████████  | 16/20 [00:55<00:13,  3.46s/it]
Task 1, Epoch 17/20 => Loss 0.553, Train_accy 91.78:  80%|████████  | 16/20 [00:59<00:13,  3.46s/it]
Task 1, Epoch 17/20 => Loss 0.553, Train_accy 91.78:  85%|████████▌ | 17/20 [00:59<00:10,  3.49s/it]
Task 1, Epoch 18/20 => Loss 0.538, Train_accy 92.16:  85%|████████▌ | 17/20 [01:02<00:10,  3.49s/it]
Task 1, Epoch 18/20 => Loss 0.538, Train_accy 92.16:  90%|█████████ | 18/20 [01:02<00:07,  3.54s/it]
Task 1, Epoch 19/20 => Loss 0.558, Train_accy 91.97:  90%|█████████ | 18/20 [01:06<00:07,  3.54s/it]
Task 1, Epoch 19/20 => Loss 0.558, Train_accy 91.97:  95%|█████████▌| 19/20 [01:06<00:03,  3.53s/it]
Task 1, Epoch 20/20 => Loss 0.551, Train_accy 92.54:  95%|█████████▌| 19/20 [01:09<00:03,  3.53s/it]
Task 1, Epoch 20/20 => Loss 0.551, Train_accy 92.54: 100%|██████████| 20/20 [01:09<00:00,  3.51s/it]
Task 1, Epoch 20/20 => Loss 0.551, Train_accy 92.54: 100%|██████████| 20/20 [01:09<00:00,  3.49s/it]
2024-09-07 15:58:12,569 [ease.py] => Task 1, Epoch 20/20 => Loss 0.551, Train_accy 92.54
2024-09-07 15:58:22,978 [ease.py] => Task correct: 73.02564102564102
2024-09-07 15:58:22,978 [ease.py] => Task acc: 85.84615384615384
2024-09-07 15:58:23,005 [trainer.py] => No NME accuracy.
2024-09-07 15:58:23,005 [trainer.py] => CNN: {'total': 69.13, '00-99': 68.97, '100-119': 70.15, 'old': 68.97, 'new': 70.15}
2024-09-07 15:58:23,005 [trainer.py] => CNN top1 curve: [73.84, 69.13]
2024-09-07 15:58:23,005 [trainer.py] => CNN top5 curve: [92.15, 89.95]

Average Accuracy (CNN): 71.48
2024-09-07 15:58:23,005 [trainer.py] => Average Accuracy (CNN): 71.48 

2024-09-07 15:58:23,006 [trainer.py] => All params: 86302658
2024-09-07 15:58:23,007 [trainer.py] => Trainable params: 304320
2024-09-07 15:58:23,011 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.968, Train_accy 17.25:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.968, Train_accy 17.25:   5%|▌         | 1/20 [00:03<01:07,  3.54s/it]
Task 2, Epoch 2/20 => Loss 2.852, Train_accy 41.93:   5%|▌         | 1/20 [00:07<01:07,  3.54s/it]
Task 2, Epoch 2/20 => Loss 2.852, Train_accy 41.93:  10%|█         | 2/20 [00:07<01:04,  3.56s/it]
Task 2, Epoch 3/20 => Loss 2.629, Train_accy 48.05:  10%|█         | 2/20 [00:10<01:04,  3.56s/it]
Task 2, Epoch 3/20 => Loss 2.629, Train_accy 48.05:  15%|█▌        | 3/20 [00:10<01:00,  3.56s/it]
Task 2, Epoch 4/20 => Loss 2.291, Train_accy 57.70:  15%|█▌        | 3/20 [00:14<01:00,  3.56s/it]
Task 2, Epoch 4/20 => Loss 2.291, Train_accy 57.70:  20%|██        | 4/20 [00:14<00:57,  3.57s/it]
Task 2, Epoch 5/20 => Loss 1.984, Train_accy 64.56:  20%|██        | 4/20 [00:17<00:57,  3.57s/it]
Task 2, Epoch 5/20 => Loss 1.984, Train_accy 64.56:  25%|██▌       | 5/20 [00:17<00:53,  3.58s/it]
Task 2, Epoch 6/20 => Loss 1.699, Train_accy 75.88:  25%|██▌       | 5/20 [00:21<00:53,  3.58s/it]
Task 2, Epoch 6/20 => Loss 1.699, Train_accy 75.88:  30%|███       | 6/20 [00:21<00:49,  3.57s/it]
Task 2, Epoch 7/20 => Loss 1.443, Train_accy 80.15:  30%|███       | 6/20 [00:25<00:49,  3.57s/it]
Task 2, Epoch 7/20 => Loss 1.443, Train_accy 80.15:  35%|███▌      | 7/20 [00:25<00:46,  3.59s/it]
Task 2, Epoch 8/20 => Loss 1.275, Train_accy 83.67:  35%|███▌      | 7/20 [00:28<00:46,  3.59s/it]
Task 2, Epoch 8/20 => Loss 1.275, Train_accy 83.67:  40%|████      | 8/20 [00:28<00:43,  3.58s/it]
Task 2, Epoch 9/20 => Loss 1.189, Train_accy 82.56:  40%|████      | 8/20 [00:32<00:43,  3.58s/it]
Task 2, Epoch 9/20 => Loss 1.189, Train_accy 82.56:  45%|████▌     | 9/20 [00:32<00:39,  3.59s/it]
Task 2, Epoch 10/20 => Loss 1.018, Train_accy 82.00:  45%|████▌     | 9/20 [00:35<00:39,  3.59s/it]
Task 2, Epoch 10/20 => Loss 1.018, Train_accy 82.00:  50%|█████     | 10/20 [00:35<00:35,  3.58s/it]
Task 2, Epoch 11/20 => Loss 0.919, Train_accy 87.38:  50%|█████     | 10/20 [00:39<00:35,  3.58s/it]
Task 2, Epoch 11/20 => Loss 0.919, Train_accy 87.38:  55%|█████▌    | 11/20 [00:39<00:32,  3.59s/it]
Task 2, Epoch 12/20 => Loss 0.854, Train_accy 86.27:  55%|█████▌    | 11/20 [00:42<00:32,  3.59s/it]
Task 2, Epoch 12/20 => Loss 0.854, Train_accy 86.27:  60%|██████    | 12/20 [00:42<00:28,  3.58s/it]
Task 2, Epoch 13/20 => Loss 0.857, Train_accy 85.16:  60%|██████    | 12/20 [00:46<00:28,  3.58s/it]
Task 2, Epoch 13/20 => Loss 0.857, Train_accy 85.16:  65%|██████▌   | 13/20 [00:46<00:25,  3.58s/it]
Task 2, Epoch 14/20 => Loss 0.755, Train_accy 87.76:  65%|██████▌   | 13/20 [00:50<00:25,  3.58s/it]
Task 2, Epoch 14/20 => Loss 0.755, Train_accy 87.76:  70%|███████   | 14/20 [00:50<00:21,  3.57s/it]
Task 2, Epoch 15/20 => Loss 0.788, Train_accy 86.46:  70%|███████   | 14/20 [00:53<00:21,  3.57s/it]
Task 2, Epoch 15/20 => Loss 0.788, Train_accy 86.46:  75%|███████▌  | 15/20 [00:53<00:17,  3.57s/it]
Task 2, Epoch 16/20 => Loss 0.719, Train_accy 90.54:  75%|███████▌  | 15/20 [00:57<00:17,  3.57s/it]
Task 2, Epoch 16/20 => Loss 0.719, Train_accy 90.54:  80%|████████  | 16/20 [00:57<00:14,  3.57s/it]
Task 2, Epoch 17/20 => Loss 0.801, Train_accy 84.04:  80%|████████  | 16/20 [01:00<00:14,  3.57s/it]
Task 2, Epoch 17/20 => Loss 0.801, Train_accy 84.04:  85%|████████▌ | 17/20 [01:00<00:10,  3.57s/it]
Task 2, Epoch 18/20 => Loss 0.760, Train_accy 88.13:  85%|████████▌ | 17/20 [01:04<00:10,  3.57s/it]
Task 2, Epoch 18/20 => Loss 0.760, Train_accy 88.13:  90%|█████████ | 18/20 [01:04<00:07,  3.56s/it]
Task 2, Epoch 19/20 => Loss 0.745, Train_accy 87.01:  90%|█████████ | 18/20 [01:07<00:07,  3.56s/it]
Task 2, Epoch 19/20 => Loss 0.745, Train_accy 87.01:  95%|█████████▌| 19/20 [01:07<00:03,  3.56s/it]
Task 2, Epoch 20/20 => Loss 0.756, Train_accy 86.27:  95%|█████████▌| 19/20 [01:11<00:03,  3.56s/it]
Task 2, Epoch 20/20 => Loss 0.756, Train_accy 86.27: 100%|██████████| 20/20 [01:11<00:00,  3.56s/it]
Task 2, Epoch 20/20 => Loss 0.756, Train_accy 86.27: 100%|██████████| 20/20 [01:11<00:00,  3.57s/it]
2024-09-07 15:59:34,466 [ease.py] => Task 2, Epoch 20/20 => Loss 0.756, Train_accy 86.27
2024-09-07 15:59:51,268 [ease.py] => Task correct: 67.08296164139162
2024-09-07 15:59:51,268 [ease.py] => Task acc: 84.21052631578948
2024-09-07 15:59:51,292 [trainer.py] => No NME accuracy.
2024-09-07 15:59:51,292 [trainer.py] => CNN: {'total': 63.16, '00-99': 63.38, '100-119': 63.43, '120-139': 61.64, 'old': 63.38, 'new': 61.64}
2024-09-07 15:59:51,292 [trainer.py] => CNN top1 curve: [73.84, 69.13, 63.16]
2024-09-07 15:59:51,292 [trainer.py] => CNN top5 curve: [92.15, 89.95, 85.91]

Average Accuracy (CNN): 68.71
2024-09-07 15:59:51,292 [trainer.py] => Average Accuracy (CNN): 68.71 

2024-09-07 15:59:51,293 [trainer.py] => All params: 86440898
2024-09-07 15:59:51,293 [trainer.py] => Trainable params: 304320
2024-09-07 15:59:51,299 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.968, Train_accy 16.38:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.968, Train_accy 16.38:   5%|▌         | 1/20 [00:03<01:06,  3.52s/it]
Task 3, Epoch 2/20 => Loss 2.838, Train_accy 39.74:   5%|▌         | 1/20 [00:07<01:06,  3.52s/it]
Task 3, Epoch 2/20 => Loss 2.838, Train_accy 39.74:  10%|█         | 2/20 [00:07<01:03,  3.53s/it]
Task 3, Epoch 3/20 => Loss 2.604, Train_accy 50.09:  10%|█         | 2/20 [00:10<01:03,  3.53s/it]
Task 3, Epoch 3/20 => Loss 2.604, Train_accy 50.09:  15%|█▌        | 3/20 [00:10<00:59,  3.53s/it]
Task 3, Epoch 4/20 => Loss 2.217, Train_accy 55.74:  15%|█▌        | 3/20 [00:14<00:59,  3.53s/it]
Task 3, Epoch 4/20 => Loss 2.217, Train_accy 55.74:  20%|██        | 4/20 [00:14<00:56,  3.54s/it]
Task 3, Epoch 5/20 => Loss 1.907, Train_accy 61.02:  20%|██        | 4/20 [00:17<00:56,  3.54s/it]
Task 3, Epoch 5/20 => Loss 1.907, Train_accy 61.02:  25%|██▌       | 5/20 [00:17<00:52,  3.53s/it]
Task 3, Epoch 6/20 => Loss 1.640, Train_accy 73.63:  25%|██▌       | 5/20 [00:21<00:52,  3.53s/it]
Task 3, Epoch 6/20 => Loss 1.640, Train_accy 73.63:  30%|███       | 6/20 [00:21<00:49,  3.56s/it]
Task 3, Epoch 7/20 => Loss 1.382, Train_accy 79.47:  30%|███       | 6/20 [00:24<00:49,  3.56s/it]
Task 3, Epoch 7/20 => Loss 1.382, Train_accy 79.47:  35%|███▌      | 7/20 [00:24<00:46,  3.56s/it]
Task 3, Epoch 8/20 => Loss 1.179, Train_accy 87.95:  35%|███▌      | 7/20 [00:28<00:46,  3.56s/it]
Task 3, Epoch 8/20 => Loss 1.179, Train_accy 87.95:  40%|████      | 8/20 [00:28<00:42,  3.55s/it]
Task 3, Epoch 9/20 => Loss 1.010, Train_accy 87.95:  40%|████      | 8/20 [00:31<00:42,  3.55s/it]
Task 3, Epoch 9/20 => Loss 1.010, Train_accy 87.95:  45%|████▌     | 9/20 [00:31<00:38,  3.54s/it]
Task 3, Epoch 10/20 => Loss 0.964, Train_accy 87.95:  45%|████▌     | 9/20 [00:35<00:38,  3.54s/it]
Task 3, Epoch 10/20 => Loss 0.964, Train_accy 87.95:  50%|█████     | 10/20 [00:35<00:35,  3.55s/it]
Task 3, Epoch 11/20 => Loss 0.937, Train_accy 86.82:  50%|█████     | 10/20 [00:38<00:35,  3.55s/it]
Task 3, Epoch 11/20 => Loss 0.937, Train_accy 86.82:  55%|█████▌    | 11/20 [00:38<00:31,  3.54s/it]
Task 3, Epoch 12/20 => Loss 0.833, Train_accy 88.32:  55%|█████▌    | 11/20 [00:42<00:31,  3.54s/it]
Task 3, Epoch 12/20 => Loss 0.833, Train_accy 88.32:  60%|██████    | 12/20 [00:42<00:28,  3.55s/it]
Task 3, Epoch 13/20 => Loss 0.817, Train_accy 88.32:  60%|██████    | 12/20 [00:46<00:28,  3.55s/it]
Task 3, Epoch 13/20 => Loss 0.817, Train_accy 88.32:  65%|██████▌   | 13/20 [00:46<00:24,  3.54s/it]
Task 3, Epoch 14/20 => Loss 0.793, Train_accy 87.19:  65%|██████▌   | 13/20 [00:49<00:24,  3.54s/it]
Task 3, Epoch 14/20 => Loss 0.793, Train_accy 87.19:  70%|███████   | 14/20 [00:49<00:21,  3.54s/it]
Task 3, Epoch 15/20 => Loss 0.690, Train_accy 89.45:  70%|███████   | 14/20 [00:53<00:21,  3.54s/it]
Task 3, Epoch 15/20 => Loss 0.690, Train_accy 89.45:  75%|███████▌  | 15/20 [00:53<00:17,  3.54s/it]
Task 3, Epoch 16/20 => Loss 0.708, Train_accy 90.77:  75%|███████▌  | 15/20 [00:56<00:17,  3.54s/it]
Task 3, Epoch 16/20 => Loss 0.708, Train_accy 90.77:  80%|████████  | 16/20 [00:56<00:14,  3.53s/it]
Task 3, Epoch 17/20 => Loss 0.741, Train_accy 90.58:  80%|████████  | 16/20 [01:00<00:14,  3.53s/it]
Task 3, Epoch 17/20 => Loss 0.741, Train_accy 90.58:  85%|████████▌ | 17/20 [01:00<00:10,  3.53s/it]
Task 3, Epoch 18/20 => Loss 0.730, Train_accy 89.83:  85%|████████▌ | 17/20 [01:03<00:10,  3.53s/it]
Task 3, Epoch 18/20 => Loss 0.730, Train_accy 89.83:  90%|█████████ | 18/20 [01:03<00:07,  3.53s/it]
Task 3, Epoch 19/20 => Loss 0.649, Train_accy 91.53:  90%|█████████ | 18/20 [01:07<00:07,  3.53s/it]
Task 3, Epoch 19/20 => Loss 0.649, Train_accy 91.53:  95%|█████████▌| 19/20 [01:07<00:03,  3.53s/it]
Task 3, Epoch 20/20 => Loss 0.726, Train_accy 89.27:  95%|█████████▌| 19/20 [01:10<00:03,  3.53s/it]
Task 3, Epoch 20/20 => Loss 0.726, Train_accy 89.27: 100%|██████████| 20/20 [01:10<00:00,  3.54s/it]
Task 3, Epoch 20/20 => Loss 0.726, Train_accy 89.27: 100%|██████████| 20/20 [01:10<00:00,  3.54s/it]
2024-09-07 16:01:02,100 [ease.py] => Task 3, Epoch 20/20 => Loss 0.726, Train_accy 89.27
2024-09-07 16:01:25,668 [ease.py] => Task correct: 64.34294871794872
2024-09-07 16:01:25,668 [ease.py] => Task acc: 83.73397435897436
2024-09-07 16:01:25,689 [trainer.py] => No NME accuracy.
2024-09-07 16:01:25,690 [trainer.py] => CNN: {'total': 60.1, '00-99': 62.31, '100-119': 61.19, '120-139': 57.53, '140-159': 47.24, 'old': 61.55, 'new': 47.24}
2024-09-07 16:01:25,690 [trainer.py] => CNN top1 curve: [73.84, 69.13, 63.16, 60.1]
2024-09-07 16:01:25,690 [trainer.py] => CNN top5 curve: [92.15, 89.95, 85.91, 83.65]

Average Accuracy (CNN): 66.56
2024-09-07 16:01:25,690 [trainer.py] => Average Accuracy (CNN): 66.56 

2024-09-07 16:01:25,690 [trainer.py] => All params: 86609858
2024-09-07 16:01:25,691 [trainer.py] => Trainable params: 304320
2024-09-07 16:01:25,698 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.970, Train_accy 15.06:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.970, Train_accy 15.06:   5%|▌         | 1/20 [00:03<01:11,  3.76s/it]
Task 4, Epoch 2/20 => Loss 2.846, Train_accy 31.35:   5%|▌         | 1/20 [00:07<01:11,  3.76s/it]
Task 4, Epoch 2/20 => Loss 2.846, Train_accy 31.35:  10%|█         | 2/20 [00:07<01:07,  3.75s/it]
Task 4, Epoch 3/20 => Loss 2.628, Train_accy 39.58:  10%|█         | 2/20 [00:11<01:07,  3.75s/it]
Task 4, Epoch 3/20 => Loss 2.628, Train_accy 39.58:  15%|█▌        | 3/20 [00:11<01:03,  3.74s/it]
Task 4, Epoch 4/20 => Loss 2.324, Train_accy 48.86:  15%|█▌        | 3/20 [00:14<01:03,  3.74s/it]
Task 4, Epoch 4/20 => Loss 2.324, Train_accy 48.86:  20%|██        | 4/20 [00:14<00:59,  3.73s/it]
Task 4, Epoch 5/20 => Loss 2.043, Train_accy 53.77:  20%|██        | 4/20 [00:18<00:59,  3.73s/it]
Task 4, Epoch 5/20 => Loss 2.043, Train_accy 53.77:  25%|██▌       | 5/20 [00:18<00:55,  3.73s/it]
Task 4, Epoch 6/20 => Loss 1.804, Train_accy 64.62:  25%|██▌       | 5/20 [00:22<00:55,  3.73s/it]
Task 4, Epoch 6/20 => Loss 1.804, Train_accy 64.62:  30%|███       | 6/20 [00:22<00:52,  3.72s/it]
Task 4, Epoch 7/20 => Loss 1.617, Train_accy 71.98:  30%|███       | 6/20 [00:26<00:52,  3.72s/it]
Task 4, Epoch 7/20 => Loss 1.617, Train_accy 71.98:  35%|███▌      | 7/20 [00:26<00:48,  3.72s/it]
Task 4, Epoch 8/20 => Loss 1.483, Train_accy 74.43:  35%|███▌      | 7/20 [00:29<00:48,  3.72s/it]
Task 4, Epoch 8/20 => Loss 1.483, Train_accy 74.43:  40%|████      | 8/20 [00:29<00:44,  3.74s/it]
Task 4, Epoch 9/20 => Loss 1.351, Train_accy 78.46:  40%|████      | 8/20 [00:33<00:44,  3.74s/it]
Task 4, Epoch 9/20 => Loss 1.351, Train_accy 78.46:  45%|████▌     | 9/20 [00:33<00:41,  3.74s/it]
Task 4, Epoch 10/20 => Loss 1.253, Train_accy 81.26:  45%|████▌     | 9/20 [00:37<00:41,  3.74s/it]
Task 4, Epoch 10/20 => Loss 1.253, Train_accy 81.26:  50%|█████     | 10/20 [00:37<00:37,  3.74s/it]
Task 4, Epoch 11/20 => Loss 1.190, Train_accy 79.16:  50%|█████     | 10/20 [00:41<00:37,  3.74s/it]
Task 4, Epoch 11/20 => Loss 1.190, Train_accy 79.16:  55%|█████▌    | 11/20 [00:41<00:33,  3.73s/it]
Task 4, Epoch 12/20 => Loss 1.094, Train_accy 81.79:  55%|█████▌    | 11/20 [00:44<00:33,  3.73s/it]
Task 4, Epoch 12/20 => Loss 1.094, Train_accy 81.79:  60%|██████    | 12/20 [00:44<00:29,  3.73s/it]
Task 4, Epoch 13/20 => Loss 1.044, Train_accy 82.14:  60%|██████    | 12/20 [00:48<00:29,  3.73s/it]
Task 4, Epoch 13/20 => Loss 1.044, Train_accy 82.14:  65%|██████▌   | 13/20 [00:48<00:26,  3.74s/it]
Task 4, Epoch 14/20 => Loss 0.970, Train_accy 84.59:  65%|██████▌   | 13/20 [00:52<00:26,  3.74s/it]
Task 4, Epoch 14/20 => Loss 0.970, Train_accy 84.59:  70%|███████   | 14/20 [00:52<00:22,  3.74s/it]
Task 4, Epoch 15/20 => Loss 0.966, Train_accy 83.19:  70%|███████   | 14/20 [00:56<00:22,  3.74s/it]
Task 4, Epoch 15/20 => Loss 0.966, Train_accy 83.19:  75%|███████▌  | 15/20 [00:56<00:18,  3.75s/it]
Task 4, Epoch 16/20 => Loss 0.961, Train_accy 84.06:  75%|███████▌  | 15/20 [00:59<00:18,  3.75s/it]
Task 4, Epoch 16/20 => Loss 0.961, Train_accy 84.06:  80%|████████  | 16/20 [00:59<00:15,  3.77s/it]
Task 4, Epoch 17/20 => Loss 0.953, Train_accy 83.01:  80%|████████  | 16/20 [01:03<00:15,  3.77s/it]
Task 4, Epoch 17/20 => Loss 0.953, Train_accy 83.01:  85%|████████▌ | 17/20 [01:03<00:11,  3.76s/it]
Task 4, Epoch 18/20 => Loss 0.921, Train_accy 85.64:  85%|████████▌ | 17/20 [01:07<00:11,  3.76s/it]
Task 4, Epoch 18/20 => Loss 0.921, Train_accy 85.64:  90%|█████████ | 18/20 [01:07<00:07,  3.75s/it]
Task 4, Epoch 19/20 => Loss 0.915, Train_accy 84.94:  90%|█████████ | 18/20 [01:11<00:07,  3.75s/it]
Task 4, Epoch 19/20 => Loss 0.915, Train_accy 84.94:  95%|█████████▌| 19/20 [01:11<00:03,  3.75s/it]
Task 4, Epoch 20/20 => Loss 0.917, Train_accy 84.94:  95%|█████████▌| 19/20 [01:14<00:03,  3.75s/it]
Task 4, Epoch 20/20 => Loss 0.917, Train_accy 84.94: 100%|██████████| 20/20 [01:14<00:00,  3.74s/it]
Task 4, Epoch 20/20 => Loss 0.917, Train_accy 84.94: 100%|██████████| 20/20 [01:14<00:00,  3.74s/it]
2024-09-07 16:02:40,528 [ease.py] => Task 4, Epoch 20/20 => Loss 0.917, Train_accy 84.94
2024-09-07 16:03:12,743 [ease.py] => Task correct: 60.14336917562724
2024-09-07 16:03:12,744 [ease.py] => Task acc: 82.36559139784946
2024-09-07 16:03:12,768 [trainer.py] => No NME accuracy.
2024-09-07 16:03:12,768 [trainer.py] => CNN: {'total': 56.63, '00-99': 61.36, '100-119': 60.45, '120-139': 56.85, '140-159': 44.88, '160-179': 36.05, 'old': 59.05, 'new': 36.05}
2024-09-07 16:03:12,768 [trainer.py] => CNN top1 curve: [73.84, 69.13, 63.16, 60.1, 56.63]
2024-09-07 16:03:12,768 [trainer.py] => CNN top5 curve: [92.15, 89.95, 85.91, 83.65, 81.43]

Average Accuracy (CNN): 64.57
2024-09-07 16:03:12,768 [trainer.py] => Average Accuracy (CNN): 64.57 

2024-09-07 16:03:12,769 [trainer.py] => All params: 86809538
2024-09-07 16:03:12,770 [trainer.py] => Trainable params: 304320
2024-09-07 16:03:12,779 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.972, Train_accy 15.75:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.972, Train_accy 15.75:   5%|▌         | 1/20 [00:03<01:06,  3.48s/it]
Task 5, Epoch 2/20 => Loss 2.846, Train_accy 46.68:   5%|▌         | 1/20 [00:07<01:06,  3.48s/it]
Task 5, Epoch 2/20 => Loss 2.846, Train_accy 46.68:  10%|█         | 2/20 [00:07<01:03,  3.51s/it]
Task 5, Epoch 3/20 => Loss 2.607, Train_accy 56.36:  10%|█         | 2/20 [00:10<01:03,  3.51s/it]
Task 5, Epoch 3/20 => Loss 2.607, Train_accy 56.36:  15%|█▌        | 3/20 [00:10<00:59,  3.49s/it]
Task 5, Epoch 4/20 => Loss 2.262, Train_accy 63.95:  15%|█▌        | 3/20 [00:13<00:59,  3.49s/it]
Task 5, Epoch 4/20 => Loss 2.262, Train_accy 63.95:  20%|██        | 4/20 [00:13<00:55,  3.48s/it]
Task 5, Epoch 5/20 => Loss 1.916, Train_accy 65.84:  20%|██        | 4/20 [00:17<00:55,  3.48s/it]
Task 5, Epoch 5/20 => Loss 1.916, Train_accy 65.84:  25%|██▌       | 5/20 [00:17<00:52,  3.48s/it]
Task 5, Epoch 6/20 => Loss 1.616, Train_accy 73.06:  25%|██▌       | 5/20 [00:20<00:52,  3.48s/it]
Task 5, Epoch 6/20 => Loss 1.616, Train_accy 73.06:  30%|███       | 6/20 [00:20<00:48,  3.48s/it]
Task 5, Epoch 7/20 => Loss 1.374, Train_accy 79.89:  30%|███       | 6/20 [00:24<00:48,  3.48s/it]
Task 5, Epoch 7/20 => Loss 1.374, Train_accy 79.89:  35%|███▌      | 7/20 [00:24<00:45,  3.48s/it]
Task 5, Epoch 8/20 => Loss 1.204, Train_accy 83.68:  35%|███▌      | 7/20 [00:27<00:45,  3.48s/it]
Task 5, Epoch 8/20 => Loss 1.204, Train_accy 83.68:  40%|████      | 8/20 [00:27<00:41,  3.49s/it]
Task 5, Epoch 9/20 => Loss 1.064, Train_accy 86.34:  40%|████      | 8/20 [00:31<00:41,  3.49s/it]
Task 5, Epoch 9/20 => Loss 1.064, Train_accy 86.34:  45%|████▌     | 9/20 [00:31<00:38,  3.49s/it]
Task 5, Epoch 10/20 => Loss 1.004, Train_accy 87.29:  45%|████▌     | 9/20 [00:34<00:38,  3.49s/it]
Task 5, Epoch 10/20 => Loss 1.004, Train_accy 87.29:  50%|█████     | 10/20 [00:34<00:34,  3.48s/it]
Task 5, Epoch 11/20 => Loss 0.929, Train_accy 86.15:  50%|█████     | 10/20 [00:38<00:34,  3.48s/it]
Task 5, Epoch 11/20 => Loss 0.929, Train_accy 86.15:  55%|█████▌    | 11/20 [00:38<00:31,  3.48s/it]
Task 5, Epoch 12/20 => Loss 0.845, Train_accy 88.61:  55%|█████▌    | 11/20 [00:41<00:31,  3.48s/it]
Task 5, Epoch 12/20 => Loss 0.845, Train_accy 88.61:  60%|██████    | 12/20 [00:41<00:27,  3.49s/it]
Task 5, Epoch 13/20 => Loss 0.829, Train_accy 86.91:  60%|██████    | 12/20 [00:45<00:27,  3.49s/it]
Task 5, Epoch 13/20 => Loss 0.829, Train_accy 86.91:  65%|██████▌   | 13/20 [00:45<00:24,  3.49s/it]
Task 5, Epoch 14/20 => Loss 0.766, Train_accy 89.75:  65%|██████▌   | 13/20 [00:48<00:24,  3.49s/it]
Task 5, Epoch 14/20 => Loss 0.766, Train_accy 89.75:  70%|███████   | 14/20 [00:48<00:20,  3.48s/it]
Task 5, Epoch 15/20 => Loss 0.765, Train_accy 88.99:  70%|███████   | 14/20 [00:52<00:20,  3.48s/it]
Task 5, Epoch 15/20 => Loss 0.765, Train_accy 88.99:  75%|███████▌  | 15/20 [00:52<00:17,  3.50s/it]
Task 5, Epoch 16/20 => Loss 0.701, Train_accy 88.80:  75%|███████▌  | 15/20 [00:55<00:17,  3.50s/it]
Task 5, Epoch 16/20 => Loss 0.701, Train_accy 88.80:  80%|████████  | 16/20 [00:55<00:13,  3.48s/it]
Task 5, Epoch 17/20 => Loss 0.702, Train_accy 89.37:  80%|████████  | 16/20 [00:59<00:13,  3.48s/it]
Task 5, Epoch 17/20 => Loss 0.702, Train_accy 89.37:  85%|████████▌ | 17/20 [00:59<00:10,  3.48s/it]
Task 5, Epoch 18/20 => Loss 0.729, Train_accy 88.80:  85%|████████▌ | 17/20 [01:02<00:10,  3.48s/it]
Task 5, Epoch 18/20 => Loss 0.729, Train_accy 88.80:  90%|█████████ | 18/20 [01:02<00:06,  3.47s/it]
Task 5, Epoch 19/20 => Loss 0.689, Train_accy 91.65:  90%|█████████ | 18/20 [01:06<00:06,  3.47s/it]
Task 5, Epoch 19/20 => Loss 0.689, Train_accy 91.65:  95%|█████████▌| 19/20 [01:06<00:03,  3.47s/it]
Task 5, Epoch 20/20 => Loss 0.688, Train_accy 89.18:  95%|█████████▌| 19/20 [01:09<00:03,  3.47s/it]
Task 5, Epoch 20/20 => Loss 0.688, Train_accy 89.18: 100%|██████████| 20/20 [01:09<00:00,  3.46s/it]
Task 5, Epoch 20/20 => Loss 0.688, Train_accy 89.18: 100%|██████████| 20/20 [01:09<00:00,  3.48s/it]
2024-09-07 16:04:22,371 [ease.py] => Task 5, Epoch 20/20 => Loss 0.688, Train_accy 89.18
2024-09-07 16:05:02,341 [ease.py] => Task correct: 58.78867676102699
2024-09-07 16:05:02,341 [ease.py] => Task acc: 81.96181698485846
2024-09-07 16:05:02,365 [trainer.py] => No NME accuracy.
2024-09-07 16:05:02,365 [trainer.py] => CNN: {'total': 55.5, '00-99': 60.4, '100-119': 57.46, '120-139': 54.79, '140-159': 44.09, '160-179': 34.69, '180-199': 57.26, 'old': 55.34, 'new': 57.26}
2024-09-07 16:05:02,366 [trainer.py] => CNN top1 curve: [73.84, 69.13, 63.16, 60.1, 56.63, 55.5]
2024-09-07 16:05:02,366 [trainer.py] => CNN top5 curve: [92.15, 89.95, 85.91, 83.65, 81.43, 79.66]

Average Accuracy (CNN): 63.06
2024-09-07 16:05:02,366 [trainer.py] => Average Accuracy (CNN): 63.06 

Accuracy Matrix (CNN):
[[73.84 68.97 63.38 62.31 61.36 60.4 ]
 [ 0.   70.15 63.43 61.19 60.45 57.46]
 [ 0.    0.   61.64 57.53 56.85 54.79]
 [ 0.    0.    0.   47.24 44.88 44.09]
 [ 0.    0.    0.    0.   36.05 34.69]
 [ 0.    0.    0.    0.    0.   57.26]]
2024-09-07 16:05:02,366 [trainer.py] => Forgetting (CNN): 7.498000000000002
2024-09-07 16:05:05,110 [trainer.py] => config: ./exps/ease_ina_B100_Inc10.json
2024-09-07 16:05:05,110 [trainer.py] => prefix:  
2024-09-07 16:05:05,110 [trainer.py] => dataset: imageneta
2024-09-07 16:05:05,110 [trainer.py] => memory_size: 0
2024-09-07 16:05:05,110 [trainer.py] => memory_per_class: 0
2024-09-07 16:05:05,110 [trainer.py] => fixed_memory: False
2024-09-07 16:05:05,110 [trainer.py] => shuffle: True
2024-09-07 16:05:05,110 [trainer.py] => init_cls: 100
2024-09-07 16:05:05,110 [trainer.py] => increment: 10
2024-09-07 16:05:05,110 [trainer.py] => model_name: ease
2024-09-07 16:05:05,110 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-07 16:05:05,110 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-07 16:05:05,110 [trainer.py] => seed: 1993
2024-09-07 16:05:05,110 [trainer.py] => init_epochs: 20
2024-09-07 16:05:05,110 [trainer.py] => init_lr: 0.05
2024-09-07 16:05:05,110 [trainer.py] => later_epochs: 20
2024-09-07 16:05:05,110 [trainer.py] => later_lr: 0.05
2024-09-07 16:05:05,110 [trainer.py] => batch_size: 48
2024-09-07 16:05:05,110 [trainer.py] => weight_decay: 0.005
2024-09-07 16:05:05,110 [trainer.py] => min_lr: 0
2024-09-07 16:05:05,110 [trainer.py] => optimizer: sgd
2024-09-07 16:05:05,110 [trainer.py] => scheduler: cosine
2024-09-07 16:05:05,110 [trainer.py] => pretrained: True
2024-09-07 16:05:05,110 [trainer.py] => vpt_type: Deep
2024-09-07 16:05:05,110 [trainer.py] => prompt_token_num: 5
2024-09-07 16:05:05,110 [trainer.py] => ffn_num: 16
2024-09-07 16:05:05,110 [trainer.py] => use_diagonal: False
2024-09-07 16:05:05,111 [trainer.py] => recalc_sim: True
2024-09-07 16:05:05,111 [trainer.py] => alpha: 0.1
2024-09-07 16:05:05,111 [trainer.py] => use_init_ptm: False
2024-09-07 16:05:05,111 [trainer.py] => beta: 0
2024-09-07 16:05:05,111 [trainer.py] => use_old_data: False
2024-09-07 16:05:05,111 [trainer.py] => use_reweight: True
2024-09-07 16:05:05,111 [trainer.py] => moni_adam: False
2024-09-07 16:05:05,111 [trainer.py] => adapter_num: -1
2024-09-07 16:05:05,137 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-07 16:05:07,847 [trainer.py] => All params: 86102976
2024-09-07 16:05:07,848 [trainer.py] => Trainable params: 304320
2024-09-07 16:05:07,855 [ease.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.428, Train_accy 15.81:   0%|          | 0/20 [00:19<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.428, Train_accy 15.81:   5%|▌         | 1/20 [00:19<06:19, 19.95s/it]
Task 0, Epoch 2/20 => Loss 3.052, Train_accy 47.57:   5%|▌         | 1/20 [00:39<06:19, 19.95s/it]
Task 0, Epoch 2/20 => Loss 3.052, Train_accy 47.57:  10%|█         | 2/20 [00:39<05:57, 19.83s/it]
Task 0, Epoch 3/20 => Loss 1.727, Train_accy 63.50:  10%|█         | 2/20 [00:59<05:57, 19.83s/it]
Task 0, Epoch 3/20 => Loss 1.727, Train_accy 63.50:  15%|█▌        | 3/20 [00:59<05:37, 19.84s/it]
Task 0, Epoch 4/20 => Loss 1.405, Train_accy 69.64:  15%|█▌        | 3/20 [01:19<05:37, 19.84s/it]
Task 0, Epoch 4/20 => Loss 1.405, Train_accy 69.64:  20%|██        | 4/20 [01:19<05:17, 19.82s/it]
Task 0, Epoch 5/20 => Loss 1.238, Train_accy 73.25:  20%|██        | 4/20 [01:39<05:17, 19.82s/it]
Task 0, Epoch 5/20 => Loss 1.238, Train_accy 73.25:  25%|██▌       | 5/20 [01:39<04:56, 19.79s/it]
Task 0, Epoch 6/20 => Loss 1.246, Train_accy 72.49:  25%|██▌       | 5/20 [01:58<04:56, 19.79s/it]
Task 0, Epoch 6/20 => Loss 1.246, Train_accy 72.49:  30%|███       | 6/20 [01:58<04:37, 19.81s/it]
Task 0, Epoch 7/20 => Loss 1.127, Train_accy 75.50:  30%|███       | 6/20 [02:18<04:37, 19.81s/it]
Task 0, Epoch 7/20 => Loss 1.127, Train_accy 75.50:  35%|███▌      | 7/20 [02:18<04:17, 19.79s/it]
Task 0, Epoch 8/20 => Loss 1.160, Train_accy 75.47:  35%|███▌      | 7/20 [02:38<04:17, 19.79s/it]
Task 0, Epoch 8/20 => Loss 1.160, Train_accy 75.47:  40%|████      | 8/20 [02:38<03:57, 19.82s/it]
Task 0, Epoch 9/20 => Loss 1.079, Train_accy 76.90:  40%|████      | 8/20 [02:58<03:57, 19.82s/it]
Task 0, Epoch 9/20 => Loss 1.079, Train_accy 76.90:  45%|████▌     | 9/20 [02:58<03:38, 19.83s/it]
Task 0, Epoch 10/20 => Loss 1.064, Train_accy 76.78:  45%|████▌     | 9/20 [03:18<03:38, 19.83s/it]
Task 0, Epoch 10/20 => Loss 1.064, Train_accy 76.78:  50%|█████     | 10/20 [03:18<03:18, 19.83s/it]
Task 0, Epoch 11/20 => Loss 1.024, Train_accy 78.18:  50%|█████     | 10/20 [03:38<03:18, 19.83s/it]
Task 0, Epoch 11/20 => Loss 1.024, Train_accy 78.18:  55%|█████▌    | 11/20 [03:38<02:58, 19.81s/it]
Task 0, Epoch 12/20 => Loss 1.026, Train_accy 78.45:  55%|█████▌    | 11/20 [03:57<02:58, 19.81s/it]
Task 0, Epoch 12/20 => Loss 1.026, Train_accy 78.45:  60%|██████    | 12/20 [03:57<02:38, 19.83s/it]
Task 0, Epoch 13/20 => Loss 0.970, Train_accy 79.70:  60%|██████    | 12/20 [04:17<02:38, 19.83s/it]
Task 0, Epoch 13/20 => Loss 0.970, Train_accy 79.70:  65%|██████▌   | 13/20 [04:17<02:18, 19.80s/it]
Task 0, Epoch 14/20 => Loss 0.959, Train_accy 80.12:  65%|██████▌   | 13/20 [04:37<02:18, 19.80s/it]
Task 0, Epoch 14/20 => Loss 0.959, Train_accy 80.12:  70%|███████   | 14/20 [04:37<01:58, 19.81s/it]
Task 0, Epoch 15/20 => Loss 0.951, Train_accy 80.40:  70%|███████   | 14/20 [04:57<01:58, 19.81s/it]
Task 0, Epoch 15/20 => Loss 0.951, Train_accy 80.40:  75%|███████▌  | 15/20 [04:57<01:39, 19.82s/it]
Task 0, Epoch 16/20 => Loss 0.919, Train_accy 81.22:  75%|███████▌  | 15/20 [05:17<01:39, 19.82s/it]
Task 0, Epoch 16/20 => Loss 0.919, Train_accy 81.22:  80%|████████  | 16/20 [05:17<01:19, 19.82s/it]
Task 0, Epoch 17/20 => Loss 0.931, Train_accy 80.85:  80%|████████  | 16/20 [05:36<01:19, 19.82s/it]
Task 0, Epoch 17/20 => Loss 0.931, Train_accy 80.85:  85%|████████▌ | 17/20 [05:36<00:59, 19.82s/it]
Task 0, Epoch 18/20 => Loss 0.879, Train_accy 82.31:  85%|████████▌ | 17/20 [05:56<00:59, 19.82s/it]
Task 0, Epoch 18/20 => Loss 0.879, Train_accy 82.31:  90%|█████████ | 18/20 [05:56<00:39, 19.81s/it]
Task 0, Epoch 19/20 => Loss 0.859, Train_accy 82.52:  90%|█████████ | 18/20 [06:16<00:39, 19.81s/it]
Task 0, Epoch 19/20 => Loss 0.859, Train_accy 82.52:  95%|█████████▌| 19/20 [06:16<00:19, 19.82s/it]
Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74:  95%|█████████▌| 19/20 [06:36<00:19, 19.82s/it]
Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74: 100%|██████████| 20/20 [06:36<00:00, 19.80s/it]
Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74: 100%|██████████| 20/20 [06:36<00:00, 19.82s/it]
2024-09-07 16:11:44,259 [ease.py] => Task 0, Epoch 20/20 => Loss 0.864, Train_accy 82.74
2024-09-07 16:11:57,785 [ease.py] => Task correct: 75.74316290130797
2024-09-07 16:11:57,785 [ease.py] => Task acc: 90.72532699167658
2024-09-07 16:11:57,804 [trainer.py] => No NME accuracy.
2024-09-07 16:11:57,804 [trainer.py] => CNN: {'total': 73.84, '00-99': 73.84, 'old': 0, 'new': 73.84}
2024-09-07 16:11:57,804 [trainer.py] => CNN top1 curve: [73.84]
2024-09-07 16:11:57,804 [trainer.py] => CNN top5 curve: [92.15]

Average Accuracy (CNN): 73.84
2024-09-07 16:11:57,804 [trainer.py] => Average Accuracy (CNN): 73.84 

2024-09-07 16:11:57,805 [trainer.py] => All params: 86256578
2024-09-07 16:11:57,806 [trainer.py] => Trainable params: 304320
2024-09-07 16:11:57,808 [ease.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.269, Train_accy 31.02:   0%|          | 0/20 [00:01<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.269, Train_accy 31.02:   5%|▌         | 1/20 [00:01<00:35,  1.89s/it]
Task 1, Epoch 2/20 => Loss 2.163, Train_accy 59.18:   5%|▌         | 1/20 [00:03<00:35,  1.89s/it]
Task 1, Epoch 2/20 => Loss 2.163, Train_accy 59.18:  10%|█         | 2/20 [00:03<00:33,  1.86s/it]
Task 1, Epoch 3/20 => Loss 2.008, Train_accy 64.08:  10%|█         | 2/20 [00:05<00:33,  1.86s/it]
Task 1, Epoch 3/20 => Loss 2.008, Train_accy 64.08:  15%|█▌        | 3/20 [00:05<00:31,  1.85s/it]
Task 1, Epoch 4/20 => Loss 1.841, Train_accy 64.49:  15%|█▌        | 3/20 [00:07<00:31,  1.85s/it]
Task 1, Epoch 4/20 => Loss 1.841, Train_accy 64.49:  20%|██        | 4/20 [00:07<00:29,  1.85s/it]
Task 1, Epoch 5/20 => Loss 1.643, Train_accy 69.80:  20%|██        | 4/20 [00:09<00:29,  1.85s/it]
Task 1, Epoch 5/20 => Loss 1.643, Train_accy 69.80:  25%|██▌       | 5/20 [00:09<00:27,  1.83s/it]
Task 1, Epoch 6/20 => Loss 1.479, Train_accy 73.88:  25%|██▌       | 5/20 [00:11<00:27,  1.83s/it]
Task 1, Epoch 6/20 => Loss 1.479, Train_accy 73.88:  30%|███       | 6/20 [00:11<00:25,  1.83s/it]
Task 1, Epoch 7/20 => Loss 1.338, Train_accy 76.73:  30%|███       | 6/20 [00:12<00:25,  1.83s/it]
Task 1, Epoch 7/20 => Loss 1.338, Train_accy 76.73:  35%|███▌      | 7/20 [00:12<00:23,  1.82s/it]
Task 1, Epoch 8/20 => Loss 1.101, Train_accy 81.63:  35%|███▌      | 7/20 [00:14<00:23,  1.82s/it]
Task 1, Epoch 8/20 => Loss 1.101, Train_accy 81.63:  40%|████      | 8/20 [00:14<00:21,  1.82s/it]
Task 1, Epoch 9/20 => Loss 1.125, Train_accy 84.08:  40%|████      | 8/20 [00:16<00:21,  1.82s/it]
Task 1, Epoch 9/20 => Loss 1.125, Train_accy 84.08:  45%|████▌     | 9/20 [00:16<00:20,  1.83s/it]
Task 1, Epoch 10/20 => Loss 0.916, Train_accy 92.24:  45%|████▌     | 9/20 [00:18<00:20,  1.83s/it]
Task 1, Epoch 10/20 => Loss 0.916, Train_accy 92.24:  50%|█████     | 10/20 [00:18<00:18,  1.82s/it]
Task 1, Epoch 11/20 => Loss 0.873, Train_accy 91.02:  50%|█████     | 10/20 [00:20<00:18,  1.82s/it]
Task 1, Epoch 11/20 => Loss 0.873, Train_accy 91.02:  55%|█████▌    | 11/20 [00:20<00:16,  1.81s/it]
Task 1, Epoch 12/20 => Loss 0.877, Train_accy 93.88:  55%|█████▌    | 11/20 [00:21<00:16,  1.81s/it]
Task 1, Epoch 12/20 => Loss 0.877, Train_accy 93.88:  60%|██████    | 12/20 [00:21<00:14,  1.81s/it]
Task 1, Epoch 13/20 => Loss 0.818, Train_accy 91.43:  60%|██████    | 12/20 [00:23<00:14,  1.81s/it]
Task 1, Epoch 13/20 => Loss 0.818, Train_accy 91.43:  65%|██████▌   | 13/20 [00:23<00:12,  1.82s/it]
Task 1, Epoch 14/20 => Loss 0.764, Train_accy 92.24:  65%|██████▌   | 13/20 [00:25<00:12,  1.82s/it]
Task 1, Epoch 14/20 => Loss 0.764, Train_accy 92.24:  70%|███████   | 14/20 [00:25<00:10,  1.81s/it]
Task 1, Epoch 15/20 => Loss 0.702, Train_accy 94.29:  70%|███████   | 14/20 [00:27<00:10,  1.81s/it]
Task 1, Epoch 15/20 => Loss 0.702, Train_accy 94.29:  75%|███████▌  | 15/20 [00:27<00:09,  1.81s/it]
Task 1, Epoch 16/20 => Loss 0.686, Train_accy 92.65:  75%|███████▌  | 15/20 [00:29<00:09,  1.81s/it]
Task 1, Epoch 16/20 => Loss 0.686, Train_accy 92.65:  80%|████████  | 16/20 [00:29<00:07,  1.81s/it]
Task 1, Epoch 17/20 => Loss 0.722, Train_accy 90.61:  80%|████████  | 16/20 [00:30<00:07,  1.81s/it]
Task 1, Epoch 17/20 => Loss 0.722, Train_accy 90.61:  85%|████████▌ | 17/20 [00:30<00:05,  1.81s/it]
Task 1, Epoch 18/20 => Loss 0.676, Train_accy 93.47:  85%|████████▌ | 17/20 [00:32<00:05,  1.81s/it]
Task 1, Epoch 18/20 => Loss 0.676, Train_accy 93.47:  90%|█████████ | 18/20 [00:32<00:03,  1.86s/it]
Task 1, Epoch 19/20 => Loss 0.636, Train_accy 93.47:  90%|█████████ | 18/20 [00:34<00:03,  1.86s/it]
Task 1, Epoch 19/20 => Loss 0.636, Train_accy 93.47:  95%|█████████▌| 19/20 [00:34<00:01,  1.87s/it]
Task 1, Epoch 20/20 => Loss 0.759, Train_accy 90.20:  95%|█████████▌| 19/20 [00:36<00:01,  1.87s/it]
Task 1, Epoch 20/20 => Loss 0.759, Train_accy 90.20: 100%|██████████| 20/20 [00:36<00:00,  1.85s/it]
Task 1, Epoch 20/20 => Loss 0.759, Train_accy 90.20: 100%|██████████| 20/20 [00:36<00:00,  1.83s/it]
2024-09-07 16:12:34,463 [ease.py] => Task 1, Epoch 20/20 => Loss 0.759, Train_accy 90.20
2024-09-07 16:12:42,624 [ease.py] => Task correct: 73.0299667036626
2024-09-07 16:12:42,625 [ease.py] => Task acc: 90.89900110987791
2024-09-07 16:12:42,645 [trainer.py] => No NME accuracy.
2024-09-07 16:12:42,645 [trainer.py] => CNN: {'total': 71.25, '00-99': 72.77, '100-109': 50.0, 'old': 72.77, 'new': 50.0}
2024-09-07 16:12:42,645 [trainer.py] => CNN top1 curve: [73.84, 71.25]
2024-09-07 16:12:42,645 [trainer.py] => CNN top5 curve: [92.15, 91.45]

Average Accuracy (CNN): 72.54
2024-09-07 16:12:42,645 [trainer.py] => Average Accuracy (CNN): 72.54 

2024-09-07 16:12:42,646 [trainer.py] => All params: 86279618
2024-09-07 16:12:42,647 [trainer.py] => Trainable params: 304320
2024-09-07 16:12:42,650 [ease.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.284, Train_accy 21.94:   0%|          | 0/20 [00:01<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.284, Train_accy 21.94:   5%|▌         | 1/20 [00:01<00:37,  2.00s/it]
Task 2, Epoch 2/20 => Loss 2.163, Train_accy 63.67:   5%|▌         | 1/20 [00:03<00:37,  2.00s/it]
Task 2, Epoch 2/20 => Loss 2.163, Train_accy 63.67:  10%|█         | 2/20 [00:03<00:35,  1.99s/it]
Task 2, Epoch 3/20 => Loss 1.975, Train_accy 73.38:  10%|█         | 2/20 [00:05<00:35,  1.99s/it]
Task 2, Epoch 3/20 => Loss 1.975, Train_accy 73.38:  15%|█▌        | 3/20 [00:05<00:33,  2.00s/it]
Task 2, Epoch 4/20 => Loss 1.758, Train_accy 72.30:  15%|█▌        | 3/20 [00:07<00:33,  2.00s/it]
Task 2, Epoch 4/20 => Loss 1.758, Train_accy 72.30:  20%|██        | 4/20 [00:07<00:31,  1.99s/it]
Task 2, Epoch 5/20 => Loss 1.518, Train_accy 73.02:  20%|██        | 4/20 [00:10<00:31,  1.99s/it]
Task 2, Epoch 5/20 => Loss 1.518, Train_accy 73.02:  25%|██▌       | 5/20 [00:10<00:30,  2.03s/it]
Task 2, Epoch 6/20 => Loss 1.315, Train_accy 73.74:  25%|██▌       | 5/20 [00:12<00:30,  2.03s/it]
Task 2, Epoch 6/20 => Loss 1.315, Train_accy 73.74:  30%|███       | 6/20 [00:12<00:29,  2.08s/it]
Task 2, Epoch 7/20 => Loss 1.148, Train_accy 75.90:  30%|███       | 6/20 [00:14<00:29,  2.08s/it]
Task 2, Epoch 7/20 => Loss 1.148, Train_accy 75.90:  35%|███▌      | 7/20 [00:14<00:26,  2.06s/it]
Task 2, Epoch 8/20 => Loss 1.047, Train_accy 78.06:  35%|███▌      | 7/20 [00:16<00:26,  2.06s/it]
Task 2, Epoch 8/20 => Loss 1.047, Train_accy 78.06:  40%|████      | 8/20 [00:16<00:24,  2.04s/it]
Task 2, Epoch 9/20 => Loss 0.947, Train_accy 82.37:  40%|████      | 8/20 [00:18<00:24,  2.04s/it]
Task 2, Epoch 9/20 => Loss 0.947, Train_accy 82.37:  45%|████▌     | 9/20 [00:18<00:22,  2.05s/it]
Task 2, Epoch 10/20 => Loss 0.901, Train_accy 80.94:  45%|████▌     | 9/20 [00:20<00:22,  2.05s/it]
Task 2, Epoch 10/20 => Loss 0.901, Train_accy 80.94:  50%|█████     | 10/20 [00:20<00:20,  2.04s/it]
Task 2, Epoch 11/20 => Loss 0.875, Train_accy 83.09:  50%|█████     | 10/20 [00:22<00:20,  2.04s/it]
Task 2, Epoch 11/20 => Loss 0.875, Train_accy 83.09:  55%|█████▌    | 11/20 [00:22<00:18,  2.02s/it]
Task 2, Epoch 12/20 => Loss 0.803, Train_accy 86.33:  55%|█████▌    | 11/20 [00:24<00:18,  2.02s/it]
Task 2, Epoch 12/20 => Loss 0.803, Train_accy 86.33:  60%|██████    | 12/20 [00:24<00:16,  2.01s/it]
Task 2, Epoch 13/20 => Loss 0.794, Train_accy 86.33:  60%|██████    | 12/20 [00:26<00:16,  2.01s/it]
Task 2, Epoch 13/20 => Loss 0.794, Train_accy 86.33:  65%|██████▌   | 13/20 [00:26<00:14,  2.01s/it]
Task 2, Epoch 14/20 => Loss 0.739, Train_accy 90.65:  65%|██████▌   | 13/20 [00:28<00:14,  2.01s/it]
Task 2, Epoch 14/20 => Loss 0.739, Train_accy 90.65:  70%|███████   | 14/20 [00:28<00:12,  2.02s/it]
Task 2, Epoch 15/20 => Loss 0.728, Train_accy 87.77:  70%|███████   | 14/20 [00:30<00:12,  2.02s/it]
Task 2, Epoch 15/20 => Loss 0.728, Train_accy 87.77:  75%|███████▌  | 15/20 [00:30<00:10,  2.02s/it]
Task 2, Epoch 16/20 => Loss 0.750, Train_accy 86.33:  75%|███████▌  | 15/20 [00:32<00:10,  2.02s/it]
Task 2, Epoch 16/20 => Loss 0.750, Train_accy 86.33:  80%|████████  | 16/20 [00:32<00:08,  2.03s/it]
Task 2, Epoch 17/20 => Loss 0.733, Train_accy 89.57:  80%|████████  | 16/20 [00:34<00:08,  2.03s/it]
Task 2, Epoch 17/20 => Loss 0.733, Train_accy 89.57:  85%|████████▌ | 17/20 [00:34<00:06,  2.03s/it]
Task 2, Epoch 18/20 => Loss 0.701, Train_accy 88.85:  85%|████████▌ | 17/20 [00:36<00:06,  2.03s/it]
Task 2, Epoch 18/20 => Loss 0.701, Train_accy 88.85:  90%|█████████ | 18/20 [00:36<00:04,  2.03s/it]
Task 2, Epoch 19/20 => Loss 0.691, Train_accy 89.57:  90%|█████████ | 18/20 [00:38<00:04,  2.03s/it]
Task 2, Epoch 19/20 => Loss 0.691, Train_accy 89.57:  95%|█████████▌| 19/20 [00:38<00:02,  2.03s/it]
Task 2, Epoch 20/20 => Loss 0.685, Train_accy 91.73:  95%|█████████▌| 19/20 [00:40<00:02,  2.03s/it]
Task 2, Epoch 20/20 => Loss 0.685, Train_accy 91.73: 100%|██████████| 20/20 [00:40<00:00,  2.02s/it]
Task 2, Epoch 20/20 => Loss 0.685, Train_accy 91.73: 100%|██████████| 20/20 [00:40<00:00,  2.03s/it]
2024-09-07 16:13:23,196 [ease.py] => Task 2, Epoch 20/20 => Loss 0.685, Train_accy 91.73
2024-09-07 16:13:36,051 [ease.py] => Task correct: 69.84615384615384
2024-09-07 16:13:36,052 [ease.py] => Task acc: 90.97435897435898
2024-09-07 16:13:36,074 [trainer.py] => No NME accuracy.
2024-09-07 16:13:36,074 [trainer.py] => CNN: {'total': 68.21, '00-99': 69.92, '100-109': 46.67, '110-119': 66.22, 'old': 68.37, 'new': 66.22}
2024-09-07 16:13:36,074 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21]
2024-09-07 16:13:36,074 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92]

Average Accuracy (CNN): 71.1
2024-09-07 16:13:36,074 [trainer.py] => Average Accuracy (CNN): 71.1 

2024-09-07 16:13:36,075 [trainer.py] => All params: 86387138
2024-09-07 16:13:36,076 [trainer.py] => Trainable params: 304320
2024-09-07 16:13:36,080 [ease.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.288, Train_accy 20.87:   0%|          | 0/20 [00:01<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.288, Train_accy 20.87:   5%|▌         | 1/20 [00:01<00:32,  1.70s/it]
Task 3, Epoch 2/20 => Loss 2.249, Train_accy 37.83:   5%|▌         | 1/20 [00:03<00:32,  1.70s/it]
Task 3, Epoch 2/20 => Loss 2.249, Train_accy 37.83:  10%|█         | 2/20 [00:03<00:30,  1.70s/it]
Task 3, Epoch 3/20 => Loss 2.188, Train_accy 38.70:  10%|█         | 2/20 [00:05<00:30,  1.70s/it]
Task 3, Epoch 3/20 => Loss 2.188, Train_accy 38.70:  15%|█▌        | 3/20 [00:05<00:28,  1.70s/it]
Task 3, Epoch 4/20 => Loss 2.104, Train_accy 47.39:  15%|█▌        | 3/20 [00:06<00:28,  1.70s/it]
Task 3, Epoch 4/20 => Loss 2.104, Train_accy 47.39:  20%|██        | 4/20 [00:06<00:27,  1.70s/it]
Task 3, Epoch 5/20 => Loss 2.010, Train_accy 54.35:  20%|██        | 4/20 [00:08<00:27,  1.70s/it]
Task 3, Epoch 5/20 => Loss 2.010, Train_accy 54.35:  25%|██▌       | 5/20 [00:08<00:25,  1.71s/it]
Task 3, Epoch 6/20 => Loss 1.915, Train_accy 57.83:  25%|██▌       | 5/20 [00:10<00:25,  1.71s/it]
Task 3, Epoch 6/20 => Loss 1.915, Train_accy 57.83:  30%|███       | 6/20 [00:10<00:23,  1.71s/it]
Task 3, Epoch 7/20 => Loss 1.794, Train_accy 60.43:  30%|███       | 6/20 [00:11<00:23,  1.71s/it]
Task 3, Epoch 7/20 => Loss 1.794, Train_accy 60.43:  35%|███▌      | 7/20 [00:11<00:22,  1.71s/it]
Task 3, Epoch 8/20 => Loss 1.679, Train_accy 65.22:  35%|███▌      | 7/20 [00:13<00:22,  1.71s/it]
Task 3, Epoch 8/20 => Loss 1.679, Train_accy 65.22:  40%|████      | 8/20 [00:13<00:20,  1.71s/it]
Task 3, Epoch 9/20 => Loss 1.573, Train_accy 70.00:  40%|████      | 8/20 [00:15<00:20,  1.71s/it]
Task 3, Epoch 9/20 => Loss 1.573, Train_accy 70.00:  45%|████▌     | 9/20 [00:15<00:18,  1.71s/it]
Task 3, Epoch 10/20 => Loss 1.491, Train_accy 73.91:  45%|████▌     | 9/20 [00:17<00:18,  1.71s/it]
Task 3, Epoch 10/20 => Loss 1.491, Train_accy 73.91:  50%|█████     | 10/20 [00:17<00:17,  1.71s/it]
Task 3, Epoch 11/20 => Loss 1.428, Train_accy 80.87:  50%|█████     | 10/20 [00:18<00:17,  1.71s/it]
Task 3, Epoch 11/20 => Loss 1.428, Train_accy 80.87:  55%|█████▌    | 11/20 [00:18<00:15,  1.71s/it]
Task 3, Epoch 12/20 => Loss 1.389, Train_accy 77.83:  55%|█████▌    | 11/20 [00:20<00:15,  1.71s/it]
Task 3, Epoch 12/20 => Loss 1.389, Train_accy 77.83:  60%|██████    | 12/20 [00:20<00:13,  1.71s/it]
Task 3, Epoch 13/20 => Loss 1.338, Train_accy 80.87:  60%|██████    | 12/20 [00:22<00:13,  1.71s/it]
Task 3, Epoch 13/20 => Loss 1.338, Train_accy 80.87:  65%|██████▌   | 13/20 [00:22<00:12,  1.71s/it]
Task 3, Epoch 14/20 => Loss 1.268, Train_accy 89.13:  65%|██████▌   | 13/20 [00:23<00:12,  1.71s/it]
Task 3, Epoch 14/20 => Loss 1.268, Train_accy 89.13:  70%|███████   | 14/20 [00:23<00:10,  1.71s/it]
Task 3, Epoch 15/20 => Loss 1.281, Train_accy 85.22:  70%|███████   | 14/20 [00:25<00:10,  1.71s/it]
Task 3, Epoch 15/20 => Loss 1.281, Train_accy 85.22:  75%|███████▌  | 15/20 [00:25<00:08,  1.73s/it]
Task 3, Epoch 16/20 => Loss 1.211, Train_accy 90.00:  75%|███████▌  | 15/20 [00:27<00:08,  1.73s/it]
Task 3, Epoch 16/20 => Loss 1.211, Train_accy 90.00:  80%|████████  | 16/20 [00:27<00:06,  1.73s/it]
Task 3, Epoch 17/20 => Loss 1.241, Train_accy 86.09:  80%|████████  | 16/20 [00:29<00:06,  1.73s/it]
Task 3, Epoch 17/20 => Loss 1.241, Train_accy 86.09:  85%|████████▌ | 17/20 [00:29<00:05,  1.72s/it]
Task 3, Epoch 18/20 => Loss 1.206, Train_accy 89.57:  85%|████████▌ | 17/20 [00:30<00:05,  1.72s/it]
Task 3, Epoch 18/20 => Loss 1.206, Train_accy 89.57:  90%|█████████ | 18/20 [00:30<00:03,  1.72s/it]
Task 3, Epoch 19/20 => Loss 1.217, Train_accy 86.09:  90%|█████████ | 18/20 [00:32<00:03,  1.72s/it]
Task 3, Epoch 19/20 => Loss 1.217, Train_accy 86.09:  95%|█████████▌| 19/20 [00:32<00:01,  1.71s/it]
Task 3, Epoch 20/20 => Loss 1.223, Train_accy 86.96:  95%|█████████▌| 19/20 [00:34<00:01,  1.71s/it]
Task 3, Epoch 20/20 => Loss 1.223, Train_accy 86.96: 100%|██████████| 20/20 [00:34<00:00,  1.72s/it]
Task 3, Epoch 20/20 => Loss 1.223, Train_accy 86.96: 100%|██████████| 20/20 [00:34<00:00,  1.71s/it]
2024-09-07 16:14:10,353 [ease.py] => Task 3, Epoch 20/20 => Loss 1.223, Train_accy 86.96
2024-09-07 16:14:27,468 [ease.py] => Task correct: 66.85990338164251
2024-09-07 16:14:27,468 [ease.py] => Task acc: 90.14492753623189
2024-09-07 16:14:27,489 [trainer.py] => No NME accuracy.
2024-09-07 16:14:27,489 [trainer.py] => CNN: {'total': 64.93, '00-99': 68.61, '100-109': 46.67, '110-119': 60.81, '120-129': 36.67, 'old': 66.67, 'new': 36.67}
2024-09-07 16:14:27,490 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93]
2024-09-07 16:14:27,490 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44]

Average Accuracy (CNN): 69.56
2024-09-07 16:14:27,490 [trainer.py] => Average Accuracy (CNN): 69.56 

2024-09-07 16:14:27,490 [trainer.py] => All params: 86510018
2024-09-07 16:14:27,491 [trainer.py] => Trainable params: 304320
2024-09-07 16:14:27,496 [ease.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.290, Train_accy 12.62:   0%|          | 0/20 [00:02<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.290, Train_accy 12.62:   5%|▌         | 1/20 [00:02<00:42,  2.22s/it]
Task 4, Epoch 2/20 => Loss 2.208, Train_accy 44.98:   5%|▌         | 1/20 [00:04<00:42,  2.22s/it]
Task 4, Epoch 2/20 => Loss 2.208, Train_accy 44.98:  10%|█         | 2/20 [00:04<00:40,  2.23s/it]
Task 4, Epoch 3/20 => Loss 2.063, Train_accy 55.34:  10%|█         | 2/20 [00:06<00:40,  2.23s/it]
Task 4, Epoch 3/20 => Loss 2.063, Train_accy 55.34:  15%|█▌        | 3/20 [00:06<00:37,  2.23s/it]
Task 4, Epoch 4/20 => Loss 1.898, Train_accy 65.37:  15%|█▌        | 3/20 [00:08<00:37,  2.23s/it]
Task 4, Epoch 4/20 => Loss 1.898, Train_accy 65.37:  20%|██        | 4/20 [00:08<00:35,  2.23s/it]
Task 4, Epoch 5/20 => Loss 1.677, Train_accy 69.58:  20%|██        | 4/20 [00:11<00:35,  2.23s/it]
Task 4, Epoch 5/20 => Loss 1.677, Train_accy 69.58:  25%|██▌       | 5/20 [00:11<00:33,  2.22s/it]
Task 4, Epoch 6/20 => Loss 1.515, Train_accy 68.28:  25%|██▌       | 5/20 [00:13<00:33,  2.22s/it]
Task 4, Epoch 6/20 => Loss 1.515, Train_accy 68.28:  30%|███       | 6/20 [00:13<00:30,  2.21s/it]
Task 4, Epoch 7/20 => Loss 1.350, Train_accy 73.46:  30%|███       | 6/20 [00:15<00:30,  2.21s/it]
Task 4, Epoch 7/20 => Loss 1.350, Train_accy 73.46:  35%|███▌      | 7/20 [00:15<00:28,  2.21s/it]
Task 4, Epoch 8/20 => Loss 1.227, Train_accy 79.94:  35%|███▌      | 7/20 [00:17<00:28,  2.21s/it]
Task 4, Epoch 8/20 => Loss 1.227, Train_accy 79.94:  40%|████      | 8/20 [00:17<00:26,  2.20s/it]
Task 4, Epoch 9/20 => Loss 1.145, Train_accy 83.17:  40%|████      | 8/20 [00:19<00:26,  2.20s/it]
Task 4, Epoch 9/20 => Loss 1.145, Train_accy 83.17:  45%|████▌     | 9/20 [00:19<00:24,  2.22s/it]
Task 4, Epoch 10/20 => Loss 1.056, Train_accy 89.00:  45%|████▌     | 9/20 [00:22<00:24,  2.22s/it]
Task 4, Epoch 10/20 => Loss 1.056, Train_accy 89.00:  50%|█████     | 10/20 [00:22<00:22,  2.22s/it]
Task 4, Epoch 11/20 => Loss 0.963, Train_accy 91.26:  50%|█████     | 10/20 [00:24<00:22,  2.22s/it]
Task 4, Epoch 11/20 => Loss 0.963, Train_accy 91.26:  55%|█████▌    | 11/20 [00:24<00:19,  2.21s/it]
Task 4, Epoch 12/20 => Loss 0.962, Train_accy 90.29:  55%|█████▌    | 11/20 [00:26<00:19,  2.21s/it]
Task 4, Epoch 12/20 => Loss 0.962, Train_accy 90.29:  60%|██████    | 12/20 [00:26<00:17,  2.20s/it]
Task 4, Epoch 13/20 => Loss 0.916, Train_accy 86.08:  60%|██████    | 12/20 [00:28<00:17,  2.20s/it]
Task 4, Epoch 13/20 => Loss 0.916, Train_accy 86.08:  65%|██████▌   | 13/20 [00:28<00:15,  2.22s/it]
Task 4, Epoch 14/20 => Loss 0.898, Train_accy 89.64:  65%|██████▌   | 13/20 [00:31<00:15,  2.22s/it]
Task 4, Epoch 14/20 => Loss 0.898, Train_accy 89.64:  70%|███████   | 14/20 [00:31<00:13,  2.21s/it]
Task 4, Epoch 15/20 => Loss 0.869, Train_accy 88.03:  70%|███████   | 14/20 [00:33<00:13,  2.21s/it]
Task 4, Epoch 15/20 => Loss 0.869, Train_accy 88.03:  75%|███████▌  | 15/20 [00:33<00:11,  2.21s/it]
Task 4, Epoch 16/20 => Loss 0.856, Train_accy 89.97:  75%|███████▌  | 15/20 [00:35<00:11,  2.21s/it]
Task 4, Epoch 16/20 => Loss 0.856, Train_accy 89.97:  80%|████████  | 16/20 [00:35<00:08,  2.21s/it]
Task 4, Epoch 17/20 => Loss 0.821, Train_accy 91.26:  80%|████████  | 16/20 [00:37<00:08,  2.21s/it]
Task 4, Epoch 17/20 => Loss 0.821, Train_accy 91.26:  85%|████████▌ | 17/20 [00:37<00:06,  2.20s/it]
Task 4, Epoch 18/20 => Loss 0.797, Train_accy 93.85:  85%|████████▌ | 17/20 [00:39<00:06,  2.20s/it]
Task 4, Epoch 18/20 => Loss 0.797, Train_accy 93.85:  90%|█████████ | 18/20 [00:39<00:04,  2.21s/it]
Task 4, Epoch 19/20 => Loss 0.838, Train_accy 89.00:  90%|█████████ | 18/20 [00:42<00:04,  2.21s/it]
Task 4, Epoch 19/20 => Loss 0.838, Train_accy 89.00:  95%|█████████▌| 19/20 [00:42<00:02,  2.22s/it]
Task 4, Epoch 20/20 => Loss 0.805, Train_accy 91.26:  95%|█████████▌| 19/20 [00:44<00:02,  2.22s/it]
Task 4, Epoch 20/20 => Loss 0.805, Train_accy 91.26: 100%|██████████| 20/20 [00:44<00:00,  2.21s/it]
Task 4, Epoch 20/20 => Loss 0.805, Train_accy 91.26: 100%|██████████| 20/20 [00:44<00:00,  2.21s/it]
2024-09-07 16:15:11,773 [ease.py] => Task 4, Epoch 20/20 => Loss 0.805, Train_accy 91.26
2024-09-07 16:15:35,471 [ease.py] => Task correct: 64.58519179304193
2024-09-07 16:15:35,472 [ease.py] => Task acc: 90.00892060660125
2024-09-07 16:15:35,494 [trainer.py] => No NME accuracy.
2024-09-07 16:15:35,494 [trainer.py] => CNN: {'total': 62.8, '00-99': 68.13, '100-109': 46.67, '110-119': 60.81, '120-129': 35.0, '130-139': 43.02, 'old': 64.44, 'new': 43.02}
2024-09-07 16:15:35,494 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93, 62.8]
2024-09-07 16:15:35,494 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44, 86.26]

Average Accuracy (CNN): 68.21
2024-09-07 16:15:35,494 [trainer.py] => Average Accuracy (CNN): 68.21 

2024-09-07 16:15:35,495 [trainer.py] => All params: 86648258
2024-09-07 16:15:35,495 [trainer.py] => Trainable params: 304320
2024-09-07 16:15:35,502 [ease.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.282, Train_accy 18.60:   0%|          | 0/20 [00:02<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.282, Train_accy 18.60:   5%|▌         | 1/20 [00:02<00:43,  2.28s/it]
Task 5, Epoch 2/20 => Loss 2.181, Train_accy 42.99:   5%|▌         | 1/20 [00:04<00:43,  2.28s/it]
Task 5, Epoch 2/20 => Loss 2.181, Train_accy 42.99:  10%|█         | 2/20 [00:04<00:40,  2.27s/it]
Task 5, Epoch 3/20 => Loss 2.043, Train_accy 47.56:  10%|█         | 2/20 [00:06<00:40,  2.27s/it]
Task 5, Epoch 3/20 => Loss 2.043, Train_accy 47.56:  15%|█▌        | 3/20 [00:06<00:38,  2.29s/it]
Task 5, Epoch 4/20 => Loss 1.863, Train_accy 52.13:  15%|█▌        | 3/20 [00:09<00:38,  2.29s/it]
Task 5, Epoch 4/20 => Loss 1.863, Train_accy 52.13:  20%|██        | 4/20 [00:09<00:36,  2.28s/it]
Task 5, Epoch 5/20 => Loss 1.680, Train_accy 58.54:  20%|██        | 4/20 [00:11<00:36,  2.28s/it]
Task 5, Epoch 5/20 => Loss 1.680, Train_accy 58.54:  25%|██▌       | 5/20 [00:11<00:34,  2.28s/it]
Task 5, Epoch 6/20 => Loss 1.497, Train_accy 66.77:  25%|██▌       | 5/20 [00:13<00:34,  2.28s/it]
Task 5, Epoch 6/20 => Loss 1.497, Train_accy 66.77:  30%|███       | 6/20 [00:13<00:31,  2.28s/it]
Task 5, Epoch 7/20 => Loss 1.351, Train_accy 73.78:  30%|███       | 6/20 [00:15<00:31,  2.28s/it]
Task 5, Epoch 7/20 => Loss 1.351, Train_accy 73.78:  35%|███▌      | 7/20 [00:15<00:29,  2.27s/it]
Task 5, Epoch 8/20 => Loss 1.220, Train_accy 78.05:  35%|███▌      | 7/20 [00:18<00:29,  2.27s/it]
Task 5, Epoch 8/20 => Loss 1.220, Train_accy 78.05:  40%|████      | 8/20 [00:18<00:27,  2.27s/it]
Task 5, Epoch 9/20 => Loss 1.144, Train_accy 84.45:  40%|████      | 8/20 [00:20<00:27,  2.27s/it]
Task 5, Epoch 9/20 => Loss 1.144, Train_accy 84.45:  45%|████▌     | 9/20 [00:20<00:25,  2.27s/it]
Task 5, Epoch 10/20 => Loss 1.098, Train_accy 84.76:  45%|████▌     | 9/20 [00:22<00:25,  2.27s/it]
Task 5, Epoch 10/20 => Loss 1.098, Train_accy 84.76:  50%|█████     | 10/20 [00:22<00:22,  2.28s/it]
Task 5, Epoch 11/20 => Loss 1.013, Train_accy 90.85:  50%|█████     | 10/20 [00:25<00:22,  2.28s/it]
Task 5, Epoch 11/20 => Loss 1.013, Train_accy 90.85:  55%|█████▌    | 11/20 [00:25<00:20,  2.28s/it]
Task 5, Epoch 12/20 => Loss 0.996, Train_accy 89.02:  55%|█████▌    | 11/20 [00:27<00:20,  2.28s/it]
Task 5, Epoch 12/20 => Loss 0.996, Train_accy 89.02:  60%|██████    | 12/20 [00:27<00:18,  2.29s/it]
Task 5, Epoch 13/20 => Loss 0.945, Train_accy 90.55:  60%|██████    | 12/20 [00:29<00:18,  2.29s/it]
Task 5, Epoch 13/20 => Loss 0.945, Train_accy 90.55:  65%|██████▌   | 13/20 [00:29<00:16,  2.30s/it]
Task 5, Epoch 14/20 => Loss 0.899, Train_accy 92.07:  65%|██████▌   | 13/20 [00:31<00:16,  2.30s/it]
Task 5, Epoch 14/20 => Loss 0.899, Train_accy 92.07:  70%|███████   | 14/20 [00:31<00:13,  2.30s/it]
Task 5, Epoch 15/20 => Loss 0.867, Train_accy 91.16:  70%|███████   | 14/20 [00:34<00:13,  2.30s/it]
Task 5, Epoch 15/20 => Loss 0.867, Train_accy 91.16:  75%|███████▌  | 15/20 [00:34<00:11,  2.30s/it]
Task 5, Epoch 16/20 => Loss 0.864, Train_accy 92.07:  75%|███████▌  | 15/20 [00:36<00:11,  2.30s/it]
Task 5, Epoch 16/20 => Loss 0.864, Train_accy 92.07:  80%|████████  | 16/20 [00:36<00:09,  2.30s/it]
Task 5, Epoch 17/20 => Loss 0.867, Train_accy 91.77:  80%|████████  | 16/20 [00:38<00:09,  2.30s/it]
Task 5, Epoch 17/20 => Loss 0.867, Train_accy 91.77:  85%|████████▌ | 17/20 [00:38<00:06,  2.30s/it]
Task 5, Epoch 18/20 => Loss 0.833, Train_accy 92.38:  85%|████████▌ | 17/20 [00:41<00:06,  2.30s/it]
Task 5, Epoch 18/20 => Loss 0.833, Train_accy 92.38:  90%|█████████ | 18/20 [00:41<00:04,  2.30s/it]
Task 5, Epoch 19/20 => Loss 0.860, Train_accy 90.24:  90%|█████████ | 18/20 [00:43<00:04,  2.30s/it]
Task 5, Epoch 19/20 => Loss 0.860, Train_accy 90.24:  95%|█████████▌| 19/20 [00:43<00:02,  2.31s/it]
Task 5, Epoch 20/20 => Loss 0.868, Train_accy 91.46:  95%|█████████▌| 19/20 [00:45<00:02,  2.31s/it]
Task 5, Epoch 20/20 => Loss 0.868, Train_accy 91.46: 100%|██████████| 20/20 [00:45<00:00,  2.31s/it]
Task 5, Epoch 20/20 => Loss 0.868, Train_accy 91.46: 100%|██████████| 20/20 [00:45<00:00,  2.29s/it]
2024-09-07 16:16:21,327 [ease.py] => Task 5, Epoch 20/20 => Loss 0.868, Train_accy 91.46
2024-09-07 16:16:51,424 [ease.py] => Task correct: 62.82372598162072
2024-09-07 16:16:51,424 [ease.py] => Task acc: 89.640768588137
2024-09-07 16:16:51,444 [trainer.py] => No NME accuracy.
2024-09-07 16:16:51,444 [trainer.py] => CNN: {'total': 60.99, '00-99': 67.66, '100-109': 45.0, '110-119': 59.46, '120-129': 33.33, '130-139': 41.86, '140-149': 44.74, 'old': 62.09, 'new': 44.74}
2024-09-07 16:16:51,444 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93, 62.8, 60.99]
2024-09-07 16:16:51,444 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44, 86.26, 84.96]

Average Accuracy (CNN): 67.0
2024-09-07 16:16:51,444 [trainer.py] => Average Accuracy (CNN): 67.0 

2024-09-07 16:16:51,445 [trainer.py] => All params: 86801858
2024-09-07 16:16:51,446 [trainer.py] => Trainable params: 304320
2024-09-07 16:16:51,452 [ease.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.293, Train_accy 13.79:   0%|          | 0/20 [00:01<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.293, Train_accy 13.79:   5%|▌         | 1/20 [00:01<00:29,  1.55s/it]
Task 6, Epoch 2/20 => Loss 2.242, Train_accy 45.81:   5%|▌         | 1/20 [00:03<00:29,  1.55s/it]
Task 6, Epoch 2/20 => Loss 2.242, Train_accy 45.81:  10%|█         | 2/20 [00:03<00:28,  1.60s/it]
Task 6, Epoch 3/20 => Loss 2.149, Train_accy 56.16:  10%|█         | 2/20 [00:04<00:28,  1.60s/it]
Task 6, Epoch 3/20 => Loss 2.149, Train_accy 56.16:  15%|█▌        | 3/20 [00:04<00:27,  1.61s/it]
Task 6, Epoch 4/20 => Loss 2.053, Train_accy 57.14:  15%|█▌        | 3/20 [00:06<00:27,  1.61s/it]
Task 6, Epoch 4/20 => Loss 2.053, Train_accy 57.14:  20%|██        | 4/20 [00:06<00:25,  1.60s/it]
Task 6, Epoch 5/20 => Loss 1.913, Train_accy 59.11:  20%|██        | 4/20 [00:07<00:25,  1.60s/it]
Task 6, Epoch 5/20 => Loss 1.913, Train_accy 59.11:  25%|██▌       | 5/20 [00:07<00:23,  1.59s/it]
Task 6, Epoch 6/20 => Loss 1.791, Train_accy 65.52:  25%|██▌       | 5/20 [00:09<00:23,  1.59s/it]
Task 6, Epoch 6/20 => Loss 1.791, Train_accy 65.52:  30%|███       | 6/20 [00:09<00:22,  1.59s/it]
Task 6, Epoch 7/20 => Loss 1.627, Train_accy 71.92:  30%|███       | 6/20 [00:11<00:22,  1.59s/it]
Task 6, Epoch 7/20 => Loss 1.627, Train_accy 71.92:  35%|███▌      | 7/20 [00:11<00:20,  1.59s/it]
Task 6, Epoch 8/20 => Loss 1.501, Train_accy 70.94:  35%|███▌      | 7/20 [00:12<00:20,  1.59s/it]
Task 6, Epoch 8/20 => Loss 1.501, Train_accy 70.94:  40%|████      | 8/20 [00:12<00:19,  1.59s/it]
Task 6, Epoch 9/20 => Loss 1.410, Train_accy 75.86:  40%|████      | 8/20 [00:14<00:19,  1.59s/it]
Task 6, Epoch 9/20 => Loss 1.410, Train_accy 75.86:  45%|████▌     | 9/20 [00:14<00:17,  1.59s/it]
Task 6, Epoch 10/20 => Loss 1.323, Train_accy 77.34:  45%|████▌     | 9/20 [00:15<00:17,  1.59s/it]
Task 6, Epoch 10/20 => Loss 1.323, Train_accy 77.34:  50%|█████     | 10/20 [00:15<00:15,  1.58s/it]
Task 6, Epoch 11/20 => Loss 1.204, Train_accy 78.82:  50%|█████     | 10/20 [00:17<00:15,  1.58s/it]
Task 6, Epoch 11/20 => Loss 1.204, Train_accy 78.82:  55%|█████▌    | 11/20 [00:17<00:14,  1.61s/it]
Task 6, Epoch 12/20 => Loss 1.142, Train_accy 80.30:  55%|█████▌    | 11/20 [00:19<00:14,  1.61s/it]
Task 6, Epoch 12/20 => Loss 1.142, Train_accy 80.30:  60%|██████    | 12/20 [00:19<00:12,  1.60s/it]
Task 6, Epoch 13/20 => Loss 1.132, Train_accy 82.76:  60%|██████    | 12/20 [00:20<00:12,  1.60s/it]
Task 6, Epoch 13/20 => Loss 1.132, Train_accy 82.76:  65%|██████▌   | 13/20 [00:20<00:11,  1.60s/it]
Task 6, Epoch 14/20 => Loss 1.083, Train_accy 85.71:  65%|██████▌   | 13/20 [00:22<00:11,  1.60s/it]
Task 6, Epoch 14/20 => Loss 1.083, Train_accy 85.71:  70%|███████   | 14/20 [00:22<00:09,  1.60s/it]
Task 6, Epoch 15/20 => Loss 1.086, Train_accy 86.21:  70%|███████   | 14/20 [00:23<00:09,  1.60s/it]
Task 6, Epoch 15/20 => Loss 1.086, Train_accy 86.21:  75%|███████▌  | 15/20 [00:23<00:07,  1.59s/it]
Task 6, Epoch 16/20 => Loss 0.988, Train_accy 89.66:  75%|███████▌  | 15/20 [00:25<00:07,  1.59s/it]
Task 6, Epoch 16/20 => Loss 0.988, Train_accy 89.66:  80%|████████  | 16/20 [00:25<00:06,  1.59s/it]
Task 6, Epoch 17/20 => Loss 1.018, Train_accy 88.18:  80%|████████  | 16/20 [00:27<00:06,  1.59s/it]
Task 6, Epoch 17/20 => Loss 1.018, Train_accy 88.18:  85%|████████▌ | 17/20 [00:27<00:04,  1.58s/it]
Task 6, Epoch 18/20 => Loss 1.008, Train_accy 88.18:  85%|████████▌ | 17/20 [00:28<00:04,  1.58s/it]
Task 6, Epoch 18/20 => Loss 1.008, Train_accy 88.18:  90%|█████████ | 18/20 [00:28<00:03,  1.58s/it]
Task 6, Epoch 19/20 => Loss 0.960, Train_accy 90.64:  90%|█████████ | 18/20 [00:30<00:03,  1.58s/it]
Task 6, Epoch 19/20 => Loss 0.960, Train_accy 90.64:  95%|█████████▌| 19/20 [00:30<00:01,  1.57s/it]
Task 6, Epoch 20/20 => Loss 0.993, Train_accy 88.18:  95%|█████████▌| 19/20 [00:31<00:01,  1.57s/it]
Task 6, Epoch 20/20 => Loss 0.993, Train_accy 88.18: 100%|██████████| 20/20 [00:31<00:00,  1.58s/it]
Task 6, Epoch 20/20 => Loss 0.993, Train_accy 88.18: 100%|██████████| 20/20 [00:31<00:00,  1.59s/it]
2024-09-07 16:17:23,254 [ease.py] => Task 6, Epoch 20/20 => Loss 0.993, Train_accy 88.18
2024-09-07 16:17:56,745 [ease.py] => Task correct: 61.29807692307692
2024-09-07 16:17:56,746 [ease.py] => Task acc: 89.50320512820512
2024-09-07 16:17:56,766 [trainer.py] => No NME accuracy.
2024-09-07 16:17:56,767 [trainer.py] => CNN: {'total': 59.54, '00-99': 67.54, '100-109': 41.67, '110-119': 59.46, '120-129': 30.0, '130-139': 41.86, '140-149': 44.74, '150-159': 35.29, 'old': 60.57, 'new': 35.29}
2024-09-07 16:17:56,767 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93, 62.8, 60.99, 59.54]
2024-09-07 16:17:56,767 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44, 86.26, 84.96, 83.33]

Average Accuracy (CNN): 65.94
2024-09-07 16:17:56,767 [trainer.py] => Average Accuracy (CNN): 65.94 

2024-09-07 16:17:56,768 [trainer.py] => All params: 86970818
2024-09-07 16:17:56,768 [trainer.py] => Trainable params: 304320
2024-09-07 16:17:56,777 [ease.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.285, Train_accy 17.07:   0%|          | 0/20 [00:02<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.285, Train_accy 17.07:   5%|▌         | 1/20 [00:02<00:44,  2.32s/it]
Task 7, Epoch 2/20 => Loss 2.194, Train_accy 35.03:   5%|▌         | 1/20 [00:04<00:44,  2.32s/it]
Task 7, Epoch 2/20 => Loss 2.194, Train_accy 35.03:  10%|█         | 2/20 [00:04<00:42,  2.33s/it]
Task 7, Epoch 3/20 => Loss 2.070, Train_accy 45.21:  10%|█         | 2/20 [00:06<00:42,  2.33s/it]
Task 7, Epoch 3/20 => Loss 2.070, Train_accy 45.21:  15%|█▌        | 3/20 [00:06<00:39,  2.33s/it]
Task 7, Epoch 4/20 => Loss 1.910, Train_accy 49.40:  15%|█▌        | 3/20 [00:09<00:39,  2.33s/it]
Task 7, Epoch 4/20 => Loss 1.910, Train_accy 49.40:  20%|██        | 4/20 [00:09<00:37,  2.33s/it]
Task 7, Epoch 5/20 => Loss 1.755, Train_accy 57.78:  20%|██        | 4/20 [00:11<00:37,  2.33s/it]
Task 7, Epoch 5/20 => Loss 1.755, Train_accy 57.78:  25%|██▌       | 5/20 [00:11<00:34,  2.33s/it]
Task 7, Epoch 6/20 => Loss 1.622, Train_accy 59.88:  25%|██▌       | 5/20 [00:13<00:34,  2.33s/it]
Task 7, Epoch 6/20 => Loss 1.622, Train_accy 59.88:  30%|███       | 6/20 [00:13<00:32,  2.33s/it]
Task 7, Epoch 7/20 => Loss 1.490, Train_accy 66.17:  30%|███       | 6/20 [00:16<00:32,  2.33s/it]
Task 7, Epoch 7/20 => Loss 1.490, Train_accy 66.17:  35%|███▌      | 7/20 [00:16<00:30,  2.34s/it]
Task 7, Epoch 8/20 => Loss 1.395, Train_accy 71.56:  35%|███▌      | 7/20 [00:18<00:30,  2.34s/it]
Task 7, Epoch 8/20 => Loss 1.395, Train_accy 71.56:  40%|████      | 8/20 [00:18<00:28,  2.34s/it]
Task 7, Epoch 9/20 => Loss 1.323, Train_accy 72.75:  40%|████      | 8/20 [00:20<00:28,  2.34s/it]
Task 7, Epoch 9/20 => Loss 1.323, Train_accy 72.75:  45%|████▌     | 9/20 [00:20<00:25,  2.34s/it]
Task 7, Epoch 10/20 => Loss 1.232, Train_accy 80.24:  45%|████▌     | 9/20 [00:23<00:25,  2.34s/it]
Task 7, Epoch 10/20 => Loss 1.232, Train_accy 80.24:  50%|█████     | 10/20 [00:23<00:23,  2.33s/it]
Task 7, Epoch 11/20 => Loss 1.192, Train_accy 79.64:  50%|█████     | 10/20 [00:25<00:23,  2.33s/it]
Task 7, Epoch 11/20 => Loss 1.192, Train_accy 79.64:  55%|█████▌    | 11/20 [00:25<00:20,  2.32s/it]
Task 7, Epoch 12/20 => Loss 1.154, Train_accy 81.44:  55%|█████▌    | 11/20 [00:27<00:20,  2.32s/it]
Task 7, Epoch 12/20 => Loss 1.154, Train_accy 81.44:  60%|██████    | 12/20 [00:27<00:18,  2.33s/it]
Task 7, Epoch 13/20 => Loss 1.139, Train_accy 76.95:  60%|██████    | 12/20 [00:30<00:18,  2.33s/it]
Task 7, Epoch 13/20 => Loss 1.139, Train_accy 76.95:  65%|██████▌   | 13/20 [00:30<00:16,  2.33s/it]
Task 7, Epoch 14/20 => Loss 1.093, Train_accy 82.34:  65%|██████▌   | 13/20 [00:32<00:16,  2.33s/it]
Task 7, Epoch 14/20 => Loss 1.093, Train_accy 82.34:  70%|███████   | 14/20 [00:32<00:14,  2.34s/it]
Task 7, Epoch 15/20 => Loss 1.079, Train_accy 81.74:  70%|███████   | 14/20 [00:34<00:14,  2.34s/it]
Task 7, Epoch 15/20 => Loss 1.079, Train_accy 81.74:  75%|███████▌  | 15/20 [00:34<00:11,  2.34s/it]
Task 7, Epoch 16/20 => Loss 1.082, Train_accy 82.63:  75%|███████▌  | 15/20 [00:37<00:11,  2.34s/it]
Task 7, Epoch 16/20 => Loss 1.082, Train_accy 82.63:  80%|████████  | 16/20 [00:37<00:09,  2.34s/it]
Task 7, Epoch 17/20 => Loss 1.043, Train_accy 84.73:  80%|████████  | 16/20 [00:39<00:09,  2.34s/it]
Task 7, Epoch 17/20 => Loss 1.043, Train_accy 84.73:  85%|████████▌ | 17/20 [00:39<00:07,  2.35s/it]
Task 7, Epoch 18/20 => Loss 1.043, Train_accy 84.43:  85%|████████▌ | 17/20 [00:42<00:07,  2.35s/it]
Task 7, Epoch 18/20 => Loss 1.043, Train_accy 84.43:  90%|█████████ | 18/20 [00:42<00:04,  2.33s/it]
Task 7, Epoch 19/20 => Loss 1.057, Train_accy 83.23:  90%|█████████ | 18/20 [00:44<00:04,  2.33s/it]
Task 7, Epoch 19/20 => Loss 1.057, Train_accy 83.23:  95%|█████████▌| 19/20 [00:44<00:02,  2.33s/it]
Task 7, Epoch 20/20 => Loss 1.038, Train_accy 84.73:  95%|█████████▌| 19/20 [00:46<00:02,  2.33s/it]
Task 7, Epoch 20/20 => Loss 1.038, Train_accy 84.73: 100%|██████████| 20/20 [00:46<00:00,  2.33s/it]
Task 7, Epoch 20/20 => Loss 1.038, Train_accy 84.73: 100%|██████████| 20/20 [00:46<00:00,  2.33s/it]
2024-09-07 16:18:43,440 [ease.py] => Task 7, Epoch 20/20 => Loss 1.038, Train_accy 84.73
2024-09-07 16:19:26,839 [ease.py] => Task correct: 59.039759939985
2024-09-07 16:19:26,840 [ease.py] => Task acc: 88.74718679669917
2024-09-07 16:19:26,863 [trainer.py] => No NME accuracy.
2024-09-07 16:19:26,863 [trainer.py] => CNN: {'total': 57.39, '00-99': 66.83, '100-109': 41.67, '110-119': 59.46, '120-129': 30.0, '130-139': 40.7, '140-149': 38.16, '150-159': 35.29, '160-169': 40.0, 'old': 58.57, 'new': 40.0}
2024-09-07 16:19:26,863 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93, 62.8, 60.99, 59.54, 57.39]
2024-09-07 16:19:26,863 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44, 86.26, 84.96, 83.33, 81.4]

Average Accuracy (CNN): 64.87
2024-09-07 16:19:26,864 [trainer.py] => Average Accuracy (CNN): 64.87 

2024-09-07 16:19:26,864 [trainer.py] => All params: 87155138
2024-09-07 16:19:26,865 [trainer.py] => Trainable params: 304320
2024-09-07 16:19:26,875 [ease.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.290, Train_accy 21.10:   0%|          | 0/20 [00:01<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.290, Train_accy 21.10:   5%|▌         | 1/20 [00:01<00:33,  1.74s/it]
Task 8, Epoch 2/20 => Loss 2.248, Train_accy 44.73:   5%|▌         | 1/20 [00:03<00:33,  1.74s/it]
Task 8, Epoch 2/20 => Loss 2.248, Train_accy 44.73:  10%|█         | 2/20 [00:03<00:31,  1.75s/it]
Task 8, Epoch 3/20 => Loss 2.176, Train_accy 51.90:  10%|█         | 2/20 [00:05<00:31,  1.75s/it]
Task 8, Epoch 3/20 => Loss 2.176, Train_accy 51.90:  15%|█▌        | 3/20 [00:05<00:29,  1.75s/it]
Task 8, Epoch 4/20 => Loss 2.088, Train_accy 56.12:  15%|█▌        | 3/20 [00:06<00:29,  1.75s/it]
Task 8, Epoch 4/20 => Loss 2.088, Train_accy 56.12:  20%|██        | 4/20 [00:06<00:27,  1.74s/it]
Task 8, Epoch 5/20 => Loss 1.979, Train_accy 60.34:  20%|██        | 4/20 [00:08<00:27,  1.74s/it]
Task 8, Epoch 5/20 => Loss 1.979, Train_accy 60.34:  25%|██▌       | 5/20 [00:08<00:26,  1.74s/it]
Task 8, Epoch 6/20 => Loss 1.868, Train_accy 63.71:  25%|██▌       | 5/20 [00:10<00:26,  1.74s/it]
Task 8, Epoch 6/20 => Loss 1.868, Train_accy 63.71:  30%|███       | 6/20 [00:10<00:24,  1.75s/it]
Task 8, Epoch 7/20 => Loss 1.738, Train_accy 70.04:  30%|███       | 6/20 [00:12<00:24,  1.75s/it]
Task 8, Epoch 7/20 => Loss 1.738, Train_accy 70.04:  35%|███▌      | 7/20 [00:12<00:22,  1.74s/it]
Task 8, Epoch 8/20 => Loss 1.624, Train_accy 70.04:  35%|███▌      | 7/20 [00:13<00:22,  1.74s/it]
Task 8, Epoch 8/20 => Loss 1.624, Train_accy 70.04:  40%|████      | 8/20 [00:13<00:20,  1.74s/it]
Task 8, Epoch 9/20 => Loss 1.527, Train_accy 72.57:  40%|████      | 8/20 [00:15<00:20,  1.74s/it]
Task 8, Epoch 9/20 => Loss 1.527, Train_accy 72.57:  45%|████▌     | 9/20 [00:15<00:19,  1.74s/it]
Task 8, Epoch 10/20 => Loss 1.437, Train_accy 73.42:  45%|████▌     | 9/20 [00:17<00:19,  1.74s/it]
Task 8, Epoch 10/20 => Loss 1.437, Train_accy 73.42:  50%|█████     | 10/20 [00:17<00:17,  1.75s/it]
Task 8, Epoch 11/20 => Loss 1.387, Train_accy 76.37:  50%|█████     | 10/20 [00:19<00:17,  1.75s/it]
Task 8, Epoch 11/20 => Loss 1.387, Train_accy 76.37:  55%|█████▌    | 11/20 [00:19<00:15,  1.75s/it]
Task 8, Epoch 12/20 => Loss 1.299, Train_accy 79.75:  55%|█████▌    | 11/20 [00:20<00:15,  1.75s/it]
Task 8, Epoch 12/20 => Loss 1.299, Train_accy 79.75:  60%|██████    | 12/20 [00:20<00:14,  1.75s/it]
Task 8, Epoch 13/20 => Loss 1.284, Train_accy 79.32:  60%|██████    | 12/20 [00:22<00:14,  1.75s/it]
Task 8, Epoch 13/20 => Loss 1.284, Train_accy 79.32:  65%|██████▌   | 13/20 [00:22<00:12,  1.75s/it]
Task 8, Epoch 14/20 => Loss 1.247, Train_accy 81.01:  65%|██████▌   | 13/20 [00:24<00:12,  1.75s/it]
Task 8, Epoch 14/20 => Loss 1.247, Train_accy 81.01:  70%|███████   | 14/20 [00:24<00:10,  1.74s/it]
Task 8, Epoch 15/20 => Loss 1.205, Train_accy 78.06:  70%|███████   | 14/20 [00:26<00:10,  1.74s/it]
Task 8, Epoch 15/20 => Loss 1.205, Train_accy 78.06:  75%|███████▌  | 15/20 [00:26<00:08,  1.74s/it]
Task 8, Epoch 16/20 => Loss 1.192, Train_accy 82.28:  75%|███████▌  | 15/20 [00:27<00:08,  1.74s/it]
Task 8, Epoch 16/20 => Loss 1.192, Train_accy 82.28:  80%|████████  | 16/20 [00:27<00:07,  1.76s/it]
Task 8, Epoch 17/20 => Loss 1.187, Train_accy 79.75:  80%|████████  | 16/20 [00:29<00:07,  1.76s/it]
Task 8, Epoch 17/20 => Loss 1.187, Train_accy 79.75:  85%|████████▌ | 17/20 [00:29<00:05,  1.76s/it]
Task 8, Epoch 18/20 => Loss 1.153, Train_accy 84.39:  85%|████████▌ | 17/20 [00:31<00:05,  1.76s/it]
Task 8, Epoch 18/20 => Loss 1.153, Train_accy 84.39:  90%|█████████ | 18/20 [00:31<00:03,  1.75s/it]
Task 8, Epoch 19/20 => Loss 1.158, Train_accy 81.43:  90%|█████████ | 18/20 [00:33<00:03,  1.75s/it]
Task 8, Epoch 19/20 => Loss 1.158, Train_accy 81.43:  95%|█████████▌| 19/20 [00:33<00:01,  1.76s/it]
Task 8, Epoch 20/20 => Loss 1.163, Train_accy 83.54:  95%|█████████▌| 19/20 [00:34<00:01,  1.76s/it]
Task 8, Epoch 20/20 => Loss 1.163, Train_accy 83.54: 100%|██████████| 20/20 [00:34<00:00,  1.76s/it]
Task 8, Epoch 20/20 => Loss 1.163, Train_accy 83.54: 100%|██████████| 20/20 [00:34<00:00,  1.75s/it]
2024-09-07 16:20:01,873 [ease.py] => Task 8, Epoch 20/20 => Loss 1.163, Train_accy 83.54
2024-09-07 16:20:49,713 [ease.py] => Task correct: 56.91756272401434
2024-09-07 16:20:49,714 [ease.py] => Task acc: 88.17204301075269
2024-09-07 16:20:49,737 [trainer.py] => No NME accuracy.
2024-09-07 16:20:49,737 [trainer.py] => CNN: {'total': 55.56, '00-99': 65.99, '100-109': 41.67, '110-119': 59.46, '120-129': 25.0, '130-139': 39.53, '140-149': 36.84, '150-159': 35.29, '160-169': 36.47, '170-179': 40.32, 'old': 56.26, 'new': 40.32}
2024-09-07 16:20:49,738 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93, 62.8, 60.99, 59.54, 57.39, 55.56]
2024-09-07 16:20:49,738 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44, 86.26, 84.96, 83.33, 81.4, 80.22]

Average Accuracy (CNN): 63.83
2024-09-07 16:20:49,738 [trainer.py] => Average Accuracy (CNN): 63.83 

2024-09-07 16:20:49,738 [trainer.py] => All params: 87354818
2024-09-07 16:20:49,739 [trainer.py] => Trainable params: 304320
2024-09-07 16:20:49,751 [ease.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.283, Train_accy 19.58:   0%|          | 0/20 [00:01<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.283, Train_accy 19.58:   5%|▌         | 1/20 [00:01<00:28,  1.48s/it]
Task 9, Epoch 2/20 => Loss 2.232, Train_accy 43.92:   5%|▌         | 1/20 [00:02<00:28,  1.48s/it]
Task 9, Epoch 2/20 => Loss 2.232, Train_accy 43.92:  10%|█         | 2/20 [00:02<00:26,  1.47s/it]
Task 9, Epoch 3/20 => Loss 2.153, Train_accy 48.68:  10%|█         | 2/20 [00:04<00:26,  1.47s/it]
Task 9, Epoch 3/20 => Loss 2.153, Train_accy 48.68:  15%|█▌        | 3/20 [00:04<00:25,  1.48s/it]
Task 9, Epoch 4/20 => Loss 2.052, Train_accy 52.38:  15%|█▌        | 3/20 [00:05<00:25,  1.48s/it]
Task 9, Epoch 4/20 => Loss 2.052, Train_accy 52.38:  20%|██        | 4/20 [00:05<00:23,  1.49s/it]
Task 9, Epoch 5/20 => Loss 1.946, Train_accy 55.03:  20%|██        | 4/20 [00:07<00:23,  1.49s/it]
Task 9, Epoch 5/20 => Loss 1.946, Train_accy 55.03:  25%|██▌       | 5/20 [00:07<00:22,  1.50s/it]
Task 9, Epoch 6/20 => Loss 1.842, Train_accy 61.38:  25%|██▌       | 5/20 [00:08<00:22,  1.50s/it]
Task 9, Epoch 6/20 => Loss 1.842, Train_accy 61.38:  30%|███       | 6/20 [00:08<00:21,  1.51s/it]
Task 9, Epoch 7/20 => Loss 1.706, Train_accy 64.55:  30%|███       | 6/20 [00:10<00:21,  1.51s/it]
Task 9, Epoch 7/20 => Loss 1.706, Train_accy 64.55:  35%|███▌      | 7/20 [00:10<00:19,  1.50s/it]
Task 9, Epoch 8/20 => Loss 1.609, Train_accy 61.90:  35%|███▌      | 7/20 [00:11<00:19,  1.50s/it]
Task 9, Epoch 8/20 => Loss 1.609, Train_accy 61.90:  40%|████      | 8/20 [00:11<00:17,  1.50s/it]
Task 9, Epoch 9/20 => Loss 1.482, Train_accy 69.31:  40%|████      | 8/20 [00:13<00:17,  1.50s/it]
Task 9, Epoch 9/20 => Loss 1.482, Train_accy 69.31:  45%|████▌     | 9/20 [00:13<00:16,  1.50s/it]
Task 9, Epoch 10/20 => Loss 1.399, Train_accy 66.14:  45%|████▌     | 9/20 [00:14<00:16,  1.50s/it]
Task 9, Epoch 10/20 => Loss 1.399, Train_accy 66.14:  50%|█████     | 10/20 [00:14<00:15,  1.50s/it]
Task 9, Epoch 11/20 => Loss 1.302, Train_accy 74.07:  50%|█████     | 10/20 [00:16<00:15,  1.50s/it]
Task 9, Epoch 11/20 => Loss 1.302, Train_accy 74.07:  55%|█████▌    | 11/20 [00:16<00:13,  1.49s/it]
Task 9, Epoch 12/20 => Loss 1.265, Train_accy 71.96:  55%|█████▌    | 11/20 [00:17<00:13,  1.49s/it]
Task 9, Epoch 12/20 => Loss 1.265, Train_accy 71.96:  60%|██████    | 12/20 [00:17<00:11,  1.49s/it]
Task 9, Epoch 13/20 => Loss 1.205, Train_accy 82.54:  60%|██████    | 12/20 [00:19<00:11,  1.49s/it]
Task 9, Epoch 13/20 => Loss 1.205, Train_accy 82.54:  65%|██████▌   | 13/20 [00:19<00:10,  1.50s/it]
Task 9, Epoch 14/20 => Loss 1.213, Train_accy 75.13:  65%|██████▌   | 13/20 [00:20<00:10,  1.50s/it]
Task 9, Epoch 14/20 => Loss 1.213, Train_accy 75.13:  70%|███████   | 14/20 [00:20<00:08,  1.50s/it]
Task 9, Epoch 15/20 => Loss 1.155, Train_accy 85.19:  70%|███████   | 14/20 [00:22<00:08,  1.50s/it]
Task 9, Epoch 15/20 => Loss 1.155, Train_accy 85.19:  75%|███████▌  | 15/20 [00:22<00:07,  1.49s/it]
Task 9, Epoch 16/20 => Loss 1.147, Train_accy 80.95:  75%|███████▌  | 15/20 [00:24<00:07,  1.49s/it]
Task 9, Epoch 16/20 => Loss 1.147, Train_accy 80.95:  80%|████████  | 16/20 [00:24<00:06,  1.52s/it]
Task 9, Epoch 17/20 => Loss 1.108, Train_accy 86.24:  80%|████████  | 16/20 [00:25<00:06,  1.52s/it]
Task 9, Epoch 17/20 => Loss 1.108, Train_accy 86.24:  85%|████████▌ | 17/20 [00:25<00:04,  1.52s/it]
Task 9, Epoch 18/20 => Loss 1.092, Train_accy 85.71:  85%|████████▌ | 17/20 [00:26<00:04,  1.52s/it]
Task 9, Epoch 18/20 => Loss 1.092, Train_accy 85.71:  90%|█████████ | 18/20 [00:26<00:03,  1.51s/it]
Task 9, Epoch 19/20 => Loss 1.126, Train_accy 82.01:  90%|█████████ | 18/20 [00:28<00:03,  1.51s/it]
Task 9, Epoch 19/20 => Loss 1.126, Train_accy 82.01:  95%|█████████▌| 19/20 [00:28<00:01,  1.49s/it]
Task 9, Epoch 20/20 => Loss 1.120, Train_accy 80.95:  95%|█████████▌| 19/20 [00:29<00:01,  1.49s/it]
Task 9, Epoch 20/20 => Loss 1.120, Train_accy 80.95: 100%|██████████| 20/20 [00:29<00:00,  1.49s/it]
Task 9, Epoch 20/20 => Loss 1.120, Train_accy 80.95: 100%|██████████| 20/20 [00:29<00:00,  1.50s/it]
2024-09-07 16:21:19,691 [ease.py] => Task 9, Epoch 20/20 => Loss 1.120, Train_accy 80.95
2024-09-07 16:22:12,755 [ease.py] => Task correct: 56.76429567642957
2024-09-07 16:22:12,756 [ease.py] => Task acc: 88.07531380753139
2024-09-07 16:22:12,778 [trainer.py] => No NME accuracy.
2024-09-07 16:22:12,778 [trainer.py] => CNN: {'total': 55.37, '00-99': 65.64, '100-109': 41.67, '110-119': 59.46, '120-129': 25.0, '130-139': 39.53, '140-149': 36.84, '150-159': 35.29, '160-169': 36.47, '170-179': 40.32, '180-189': 56.41, 'old': 55.34, 'new': 56.41}
2024-09-07 16:22:12,778 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93, 62.8, 60.99, 59.54, 57.39, 55.56, 55.37]
2024-09-07 16:22:12,778 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44, 86.26, 84.96, 83.33, 81.4, 80.22, 79.08]

Average Accuracy (CNN): 62.99
2024-09-07 16:22:12,778 [trainer.py] => Average Accuracy (CNN): 62.99 

2024-09-07 16:22:12,779 [trainer.py] => All params: 87569858
2024-09-07 16:22:12,780 [trainer.py] => Trainable params: 304320
2024-09-07 16:22:12,794 [ease.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.283, Train_accy 17.16:   0%|          | 0/20 [00:02<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.283, Train_accy 17.16:   5%|▌         | 1/20 [00:02<00:46,  2.43s/it]
Task 10, Epoch 2/20 => Loss 2.171, Train_accy 39.64:   5%|▌         | 1/20 [00:04<00:46,  2.43s/it]
Task 10, Epoch 2/20 => Loss 2.171, Train_accy 39.64:  10%|█         | 2/20 [00:04<00:43,  2.41s/it]
Task 10, Epoch 3/20 => Loss 2.015, Train_accy 53.55:  10%|█         | 2/20 [00:07<00:43,  2.41s/it]
Task 10, Epoch 3/20 => Loss 2.015, Train_accy 53.55:  15%|█▌        | 3/20 [00:07<00:40,  2.40s/it]
Task 10, Epoch 4/20 => Loss 1.903, Train_accy 62.72:  15%|█▌        | 3/20 [00:09<00:40,  2.40s/it]
Task 10, Epoch 4/20 => Loss 1.903, Train_accy 62.72:  20%|██        | 4/20 [00:09<00:38,  2.39s/it]
Task 10, Epoch 5/20 => Loss 1.599, Train_accy 71.30:  20%|██        | 4/20 [00:11<00:38,  2.39s/it]
Task 10, Epoch 5/20 => Loss 1.599, Train_accy 71.30:  25%|██▌       | 5/20 [00:11<00:35,  2.39s/it]
Task 10, Epoch 6/20 => Loss 1.466, Train_accy 77.22:  25%|██▌       | 5/20 [00:14<00:35,  2.39s/it]
Task 10, Epoch 6/20 => Loss 1.466, Train_accy 77.22:  30%|███       | 6/20 [00:14<00:33,  2.39s/it]
Task 10, Epoch 7/20 => Loss 1.271, Train_accy 78.11:  30%|███       | 6/20 [00:16<00:33,  2.39s/it]
Task 10, Epoch 7/20 => Loss 1.271, Train_accy 78.11:  35%|███▌      | 7/20 [00:16<00:31,  2.39s/it]
Task 10, Epoch 8/20 => Loss 1.235, Train_accy 77.81:  35%|███▌      | 7/20 [00:19<00:31,  2.39s/it]
Task 10, Epoch 8/20 => Loss 1.235, Train_accy 77.81:  40%|████      | 8/20 [00:19<00:28,  2.39s/it]
Task 10, Epoch 9/20 => Loss 1.030, Train_accy 82.54:  40%|████      | 8/20 [00:21<00:28,  2.39s/it]
Task 10, Epoch 9/20 => Loss 1.030, Train_accy 82.54:  45%|████▌     | 9/20 [00:21<00:26,  2.39s/it]
Task 10, Epoch 10/20 => Loss 1.022, Train_accy 83.73:  45%|████▌     | 9/20 [00:23<00:26,  2.39s/it]
Task 10, Epoch 10/20 => Loss 1.022, Train_accy 83.73:  50%|█████     | 10/20 [00:23<00:23,  2.39s/it]
Task 10, Epoch 11/20 => Loss 0.957, Train_accy 84.32:  50%|█████     | 10/20 [00:26<00:23,  2.39s/it]
Task 10, Epoch 11/20 => Loss 0.957, Train_accy 84.32:  55%|█████▌    | 11/20 [00:26<00:21,  2.39s/it]
Task 10, Epoch 12/20 => Loss 0.906, Train_accy 86.98:  55%|█████▌    | 11/20 [00:28<00:21,  2.39s/it]
Task 10, Epoch 12/20 => Loss 0.906, Train_accy 86.98:  60%|██████    | 12/20 [00:28<00:19,  2.40s/it]
Task 10, Epoch 13/20 => Loss 0.858, Train_accy 86.69:  60%|██████    | 12/20 [00:31<00:19,  2.40s/it]
Task 10, Epoch 13/20 => Loss 0.858, Train_accy 86.69:  65%|██████▌   | 13/20 [00:31<00:16,  2.40s/it]
Task 10, Epoch 14/20 => Loss 0.830, Train_accy 87.57:  65%|██████▌   | 13/20 [00:33<00:16,  2.40s/it]
Task 10, Epoch 14/20 => Loss 0.830, Train_accy 87.57:  70%|███████   | 14/20 [00:33<00:14,  2.39s/it]
Task 10, Epoch 15/20 => Loss 0.748, Train_accy 88.46:  70%|███████   | 14/20 [00:35<00:14,  2.39s/it]
Task 10, Epoch 15/20 => Loss 0.748, Train_accy 88.46:  75%|███████▌  | 15/20 [00:35<00:11,  2.39s/it]
Task 10, Epoch 16/20 => Loss 0.776, Train_accy 88.46:  75%|███████▌  | 15/20 [00:38<00:11,  2.39s/it]
Task 10, Epoch 16/20 => Loss 0.776, Train_accy 88.46:  80%|████████  | 16/20 [00:38<00:09,  2.40s/it]
Task 10, Epoch 17/20 => Loss 0.761, Train_accy 88.76:  80%|████████  | 16/20 [00:40<00:09,  2.40s/it]
Task 10, Epoch 17/20 => Loss 0.761, Train_accy 88.76:  85%|████████▌ | 17/20 [00:40<00:07,  2.39s/it]
Task 10, Epoch 18/20 => Loss 0.735, Train_accy 86.69:  85%|████████▌ | 17/20 [00:43<00:07,  2.39s/it]
Task 10, Epoch 18/20 => Loss 0.735, Train_accy 86.69:  90%|█████████ | 18/20 [00:43<00:04,  2.39s/it]
Task 10, Epoch 19/20 => Loss 0.750, Train_accy 91.12:  90%|█████████ | 18/20 [00:45<00:04,  2.39s/it]
Task 10, Epoch 19/20 => Loss 0.750, Train_accy 91.12:  95%|█████████▌| 19/20 [00:45<00:02,  2.39s/it]
Task 10, Epoch 20/20 => Loss 0.787, Train_accy 90.24:  95%|█████████▌| 19/20 [00:47<00:02,  2.39s/it]
Task 10, Epoch 20/20 => Loss 0.787, Train_accy 90.24: 100%|██████████| 20/20 [00:47<00:00,  2.39s/it]
Task 10, Epoch 20/20 => Loss 0.787, Train_accy 90.24: 100%|██████████| 20/20 [00:47<00:00,  2.39s/it]
2024-09-07 16:23:00,661 [ease.py] => Task 10, Epoch 20/20 => Loss 0.787, Train_accy 90.24
2024-09-07 16:24:07,154 [ease.py] => Task correct: 55.365371955233705
2024-09-07 16:24:07,155 [ease.py] => Task acc: 87.49177090190915
2024-09-07 16:24:07,176 [trainer.py] => No NME accuracy.
2024-09-07 16:24:07,176 [trainer.py] => CNN: {'total': 54.18, '00-99': 65.52, '100-109': 38.33, '110-119': 58.11, '120-129': 25.0, '130-139': 39.53, '140-149': 36.84, '150-159': 35.29, '160-169': 36.47, '170-179': 35.48, '180-189': 56.41, '190-199': 42.35, 'old': 54.88, 'new': 42.35}
2024-09-07 16:24:07,176 [trainer.py] => CNN top1 curve: [73.84, 71.25, 68.21, 64.93, 62.8, 60.99, 59.54, 57.39, 55.56, 55.37, 54.18]
2024-09-07 16:24:07,176 [trainer.py] => CNN top5 curve: [92.15, 91.45, 88.92, 87.44, 86.26, 84.96, 83.33, 81.4, 80.22, 79.08, 77.55]

Average Accuracy (CNN): 62.19
2024-09-07 16:24:07,176 [trainer.py] => Average Accuracy (CNN): 62.19 

Accuracy Matrix (CNN):
[[73.84 72.77 69.92 68.61 68.13 67.66 67.54 66.83 65.99 65.64 65.52]
 [ 0.   50.   46.67 46.67 46.67 45.   41.67 41.67 41.67 41.67 38.33]
 [ 0.    0.   66.22 60.81 60.81 59.46 59.46 59.46 59.46 59.46 58.11]
 [ 0.    0.    0.   36.67 35.   33.33 30.   30.   25.   25.   25.  ]
 [ 0.    0.    0.    0.   43.02 41.86 41.86 40.7  39.53 39.53 39.53]
 [ 0.    0.    0.    0.    0.   44.74 44.74 38.16 36.84 36.84 36.84]
 [ 0.    0.    0.    0.    0.    0.   35.29 35.29 35.29 35.29 35.29]
 [ 0.    0.    0.    0.    0.    0.    0.   40.   36.47 36.47 36.47]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   40.32 40.32 35.48]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   56.41 56.41]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   42.35]]
2024-09-07 16:24:07,177 [trainer.py] => Forgetting (CNN): 5.953000000000001
