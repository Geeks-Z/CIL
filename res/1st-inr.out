nohup: 忽略输入
2024-09-07 08:40:10,218 [trainer.py] => config: ./exps/finetune_inr_B0_Inc5.json
2024-09-07 08:40:10,235 [trainer.py] => prefix: reproduce
2024-09-07 08:40:10,235 [trainer.py] => dataset: imagenetr
2024-09-07 08:40:10,235 [trainer.py] => memory_size: 0
2024-09-07 08:40:10,235 [trainer.py] => memory_per_class: 0
2024-09-07 08:40:10,235 [trainer.py] => fixed_memory: False
2024-09-07 08:40:10,235 [trainer.py] => shuffle: True
2024-09-07 08:40:10,235 [trainer.py] => init_cls: 40
2024-09-07 08:40:10,235 [trainer.py] => increment: 40
2024-09-07 08:40:10,235 [trainer.py] => model_name: finetune
2024-09-07 08:40:10,235 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 08:40:10,236 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 08:40:10,236 [trainer.py] => seed: 1993
2024-09-07 08:40:10,236 [trainer.py] => init_epoch: 20
2024-09-07 08:40:10,236 [trainer.py] => init_lr: 0.001
2024-09-07 08:40:10,236 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 08:40:10,236 [trainer.py] => init_lr_decay: 0.1
2024-09-07 08:40:10,236 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 08:40:10,236 [trainer.py] => epochs: 20
2024-09-07 08:40:10,236 [trainer.py] => lrate: 0.001
2024-09-07 08:40:10,236 [trainer.py] => milestones: [40, 70]
2024-09-07 08:40:10,236 [trainer.py] => lrate_decay: 0.1
2024-09-07 08:40:10,236 [trainer.py] => batch_size: 48
2024-09-07 08:40:10,236 [trainer.py] => weight_decay: 0.0002
2024-09-07 08:40:10,325 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 08:40:12,106 [trainer.py] => All params: 85798656
2024-09-07 08:40:12,107 [trainer.py] => Trainable params: 85798656
2024-09-07 08:40:12,107 [finetune.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.808, Train_accy 3.65, Test_accy 4.69:   0%|          | 0/20 [00:44<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.808, Train_accy 3.65, Test_accy 4.69:   5%|▌         | 1/20 [00:44<14:04, 44.47s/it]
Task 0, Epoch 2/20 => Loss 3.659, Train_accy 4.68:   5%|▌         | 1/20 [01:24<14:04, 44.47s/it]                
Task 0, Epoch 2/20 => Loss 3.659, Train_accy 4.68:  10%|█         | 2/20 [01:24<12:37, 42.08s/it]
Task 0, Epoch 3/20 => Loss 3.631, Train_accy 4.92:  10%|█         | 2/20 [02:06<12:37, 42.08s/it]
Task 0, Epoch 3/20 => Loss 3.631, Train_accy 4.92:  15%|█▌        | 3/20 [02:06<11:48, 41.71s/it]
Task 0, Epoch 4/20 => Loss 3.595, Train_accy 5.87:  15%|█▌        | 3/20 [02:47<11:48, 41.71s/it]
Task 0, Epoch 4/20 => Loss 3.595, Train_accy 5.87:  20%|██        | 4/20 [02:47<11:03, 41.48s/it]
Task 0, Epoch 5/20 => Loss 3.477, Train_accy 9.62:  20%|██        | 4/20 [03:28<11:03, 41.48s/it]
Task 0, Epoch 5/20 => Loss 3.477, Train_accy 9.62:  25%|██▌       | 5/20 [03:28<10:20, 41.38s/it]
Task 0, Epoch 6/20 => Loss 3.173, Train_accy 16.42, Test_accy 34.67:  25%|██▌       | 5/20 [04:13<10:20, 41.38s/it]
Task 0, Epoch 6/20 => Loss 3.173, Train_accy 16.42, Test_accy 34.67:  30%|███       | 6/20 [04:13<09:58, 42.78s/it]
Task 0, Epoch 7/20 => Loss 1.482, Train_accy 60.59:  30%|███       | 6/20 [04:55<09:58, 42.78s/it]                 
Task 0, Epoch 7/20 => Loss 1.482, Train_accy 60.59:  35%|███▌      | 7/20 [04:55<09:10, 42.35s/it]
Task 0, Epoch 8/20 => Loss 0.773, Train_accy 79.37:  35%|███▌      | 7/20 [05:37<09:10, 42.35s/it]
Task 0, Epoch 8/20 => Loss 0.773, Train_accy 79.37:  40%|████      | 8/20 [05:37<08:25, 42.15s/it]
Task 0, Epoch 9/20 => Loss 0.621, Train_accy 83.13:  40%|████      | 8/20 [06:18<08:25, 42.15s/it]
Task 0, Epoch 9/20 => Loss 0.621, Train_accy 83.13:  45%|████▌     | 9/20 [06:18<07:40, 41.87s/it]
Task 0, Epoch 10/20 => Loss 0.540, Train_accy 85.11:  45%|████▌     | 9/20 [06:59<07:40, 41.87s/it]
Task 0, Epoch 10/20 => Loss 0.540, Train_accy 85.11:  50%|█████     | 10/20 [06:59<06:57, 41.77s/it]
Task 0, Epoch 11/20 => Loss 0.510, Train_accy 86.43, Test_accy 89.33:  50%|█████     | 10/20 [07:45<06:57, 41.77s/it]
Task 0, Epoch 11/20 => Loss 0.510, Train_accy 86.43, Test_accy 89.33:  55%|█████▌    | 11/20 [07:45<06:26, 42.98s/it]
Task 0, Epoch 12/20 => Loss 0.456, Train_accy 88.02:  55%|█████▌    | 11/20 [08:27<06:26, 42.98s/it]                 
Task 0, Epoch 12/20 => Loss 0.456, Train_accy 88.02:  60%|██████    | 12/20 [08:27<05:39, 42.48s/it]
Task 0, Epoch 13/20 => Loss 0.434, Train_accy 88.09:  60%|██████    | 12/20 [09:08<05:39, 42.48s/it]
Task 0, Epoch 13/20 => Loss 0.434, Train_accy 88.09:  65%|██████▌   | 13/20 [09:08<04:54, 42.14s/it]
Task 0, Epoch 14/20 => Loss 0.419, Train_accy 88.61:  65%|██████▌   | 13/20 [09:49<04:54, 42.14s/it]
Task 0, Epoch 14/20 => Loss 0.419, Train_accy 88.61:  70%|███████   | 14/20 [09:49<04:11, 41.97s/it]
Task 0, Epoch 15/20 => Loss 0.394, Train_accy 89.02:  70%|███████   | 14/20 [10:31<04:11, 41.97s/it]
Task 0, Epoch 15/20 => Loss 0.394, Train_accy 89.02:  75%|███████▌  | 15/20 [10:31<03:29, 41.81s/it]
Task 0, Epoch 16/20 => Loss 0.375, Train_accy 90.09, Test_accy 89.17:  75%|███████▌  | 15/20 [11:16<03:29, 41.81s/it]
Task 0, Epoch 16/20 => Loss 0.375, Train_accy 90.09, Test_accy 89.17:  80%|████████  | 16/20 [11:16<02:51, 42.92s/it]
Task 0, Epoch 17/20 => Loss 0.360, Train_accy 90.14:  80%|████████  | 16/20 [11:58<02:51, 42.92s/it]                 
Task 0, Epoch 17/20 => Loss 0.360, Train_accy 90.14:  85%|████████▌ | 17/20 [11:58<02:07, 42.40s/it]
Task 0, Epoch 18/20 => Loss 0.328, Train_accy 91.26:  85%|████████▌ | 17/20 [12:39<02:07, 42.40s/it]
Task 0, Epoch 18/20 => Loss 0.328, Train_accy 91.26:  90%|█████████ | 18/20 [12:39<01:24, 42.07s/it]
Task 0, Epoch 19/20 => Loss 0.367, Train_accy 90.14:  90%|█████████ | 18/20 [13:20<01:24, 42.07s/it]
Task 0, Epoch 19/20 => Loss 0.367, Train_accy 90.14:  95%|█████████▌| 19/20 [13:20<00:41, 41.86s/it]
Task 0, Epoch 20/20 => Loss 0.332, Train_accy 91.02:  95%|█████████▌| 19/20 [14:02<00:41, 41.86s/it]
Task 0, Epoch 20/20 => Loss 0.332, Train_accy 91.02: 100%|██████████| 20/20 [14:02<00:00, 41.79s/it]
Task 0, Epoch 20/20 => Loss 0.332, Train_accy 91.02: 100%|██████████| 20/20 [14:02<00:00, 42.12s/it]
2024-09-07 08:54:15,323 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.332, Train_accy 91.02
2024-09-07 08:54:19,564 [trainer.py] => No NME accuracy.
2024-09-07 08:54:19,564 [trainer.py] => CNN: {'total': 89.25, '00-39': 89.25, 'old': 0, 'new': 89.25}
2024-09-07 08:54:19,564 [trainer.py] => CNN top1 curve: [89.25]
2024-09-07 08:54:19,565 [trainer.py] => CNN top5 curve: [97.5]

Average Accuracy (CNN): 89.25
2024-09-07 08:54:19,565 [trainer.py] => Average Accuracy (CNN): 89.25 

2024-09-07 08:54:19,566 [trainer.py] => All params: 85829416
2024-09-07 08:54:19,567 [trainer.py] => Trainable params: 85829416
2024-09-07 08:54:19,570 [finetune.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.993, Train_accy 30.31, Test_accy 78.10:   0%|          | 0/20 [00:43<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.993, Train_accy 30.31, Test_accy 78.10:   5%|▌         | 1/20 [00:43<13:51, 43.74s/it]
Task 1, Epoch 2/20 => Loss 0.873, Train_accy 67.64:   5%|▌         | 1/20 [01:19<13:51, 43.74s/it]                 
Task 1, Epoch 2/20 => Loss 0.873, Train_accy 67.64:  10%|█         | 2/20 [01:19<11:45, 39.18s/it]
Task 1, Epoch 3/20 => Loss 0.704, Train_accy 74.70:  10%|█         | 2/20 [01:55<11:45, 39.18s/it]
Task 1, Epoch 3/20 => Loss 0.704, Train_accy 74.70:  15%|█▌        | 3/20 [01:55<10:40, 37.67s/it]
Task 1, Epoch 4/20 => Loss 0.582, Train_accy 79.79:  15%|█▌        | 3/20 [02:31<10:40, 37.67s/it]
Task 1, Epoch 4/20 => Loss 0.582, Train_accy 79.79:  20%|██        | 4/20 [02:31<09:51, 36.98s/it]
Task 1, Epoch 5/20 => Loss 0.554, Train_accy 79.92:  20%|██        | 4/20 [03:07<09:51, 36.98s/it]
Task 1, Epoch 5/20 => Loss 0.554, Train_accy 79.92:  25%|██▌       | 5/20 [03:07<09:08, 36.57s/it]
Task 1, Epoch 6/20 => Loss 0.509, Train_accy 82.25, Test_accy 80.26:  25%|██▌       | 5/20 [03:51<09:08, 36.57s/it]
Task 1, Epoch 6/20 => Loss 0.509, Train_accy 82.25, Test_accy 80.26:  30%|███       | 6/20 [03:51<09:06, 39.01s/it]
Task 1, Epoch 7/20 => Loss 0.500, Train_accy 82.72:  30%|███       | 6/20 [04:27<09:06, 39.01s/it]                 
Task 1, Epoch 7/20 => Loss 0.500, Train_accy 82.72:  35%|███▌      | 7/20 [04:27<08:13, 38.00s/it]
Task 1, Epoch 8/20 => Loss 0.415, Train_accy 86.43:  35%|███▌      | 7/20 [05:03<08:13, 38.00s/it]
Task 1, Epoch 8/20 => Loss 0.415, Train_accy 86.43:  40%|████      | 8/20 [05:03<07:28, 37.37s/it]
Task 1, Epoch 9/20 => Loss 0.405, Train_accy 86.13:  40%|████      | 8/20 [05:39<07:28, 37.37s/it]
Task 1, Epoch 9/20 => Loss 0.405, Train_accy 86.13:  45%|████▌     | 9/20 [05:39<06:46, 36.95s/it]
Task 1, Epoch 10/20 => Loss 0.403, Train_accy 86.11:  45%|████▌     | 9/20 [06:15<06:46, 36.95s/it]
Task 1, Epoch 10/20 => Loss 0.403, Train_accy 86.11:  50%|█████     | 10/20 [06:15<06:06, 36.63s/it]
Task 1, Epoch 11/20 => Loss 0.387, Train_accy 87.25, Test_accy 81.39:  50%|█████     | 10/20 [06:58<06:06, 36.63s/it]
Task 1, Epoch 11/20 => Loss 0.387, Train_accy 87.25, Test_accy 81.39:  55%|█████▌    | 11/20 [06:58<05:49, 38.80s/it]
Task 1, Epoch 12/20 => Loss 0.377, Train_accy 88.07:  55%|█████▌    | 11/20 [07:34<05:49, 38.80s/it]                 
Task 1, Epoch 12/20 => Loss 0.377, Train_accy 88.07:  60%|██████    | 12/20 [07:34<05:03, 37.93s/it]
Task 1, Epoch 13/20 => Loss 0.358, Train_accy 88.63:  60%|██████    | 12/20 [08:10<05:03, 37.93s/it]
Task 1, Epoch 13/20 => Loss 0.358, Train_accy 88.63:  65%|██████▌   | 13/20 [08:10<04:21, 37.32s/it]
Task 1, Epoch 14/20 => Loss 0.335, Train_accy 89.17:  65%|██████▌   | 13/20 [08:46<04:21, 37.32s/it]
Task 1, Epoch 14/20 => Loss 0.335, Train_accy 89.17:  70%|███████   | 14/20 [08:46<03:41, 36.88s/it]
Task 1, Epoch 15/20 => Loss 0.330, Train_accy 89.19:  70%|███████   | 14/20 [09:22<03:41, 36.88s/it]
Task 1, Epoch 15/20 => Loss 0.330, Train_accy 89.19:  75%|███████▌  | 15/20 [09:22<03:02, 36.54s/it]
Task 1, Epoch 16/20 => Loss 0.351, Train_accy 88.78, Test_accy 80.26:  75%|███████▌  | 15/20 [10:05<03:02, 36.54s/it]
Task 1, Epoch 16/20 => Loss 0.351, Train_accy 88.78, Test_accy 80.26:  80%|████████  | 16/20 [10:05<02:34, 38.65s/it]
Task 1, Epoch 17/20 => Loss 0.328, Train_accy 89.21:  80%|████████  | 16/20 [10:41<02:34, 38.65s/it]                 
Task 1, Epoch 17/20 => Loss 0.328, Train_accy 89.21:  85%|████████▌ | 17/20 [10:41<01:53, 37.83s/it]
Task 1, Epoch 18/20 => Loss 0.336, Train_accy 89.69:  85%|████████▌ | 17/20 [11:17<01:53, 37.83s/it]
Task 1, Epoch 18/20 => Loss 0.336, Train_accy 89.69:  90%|█████████ | 18/20 [11:17<01:14, 37.24s/it]
Task 1, Epoch 19/20 => Loss 0.295, Train_accy 90.79:  90%|█████████ | 18/20 [11:53<01:14, 37.24s/it]
Task 1, Epoch 19/20 => Loss 0.295, Train_accy 90.79:  95%|█████████▌| 19/20 [11:53<00:36, 36.87s/it]
Task 1, Epoch 20/20 => Loss 0.290, Train_accy 90.98:  95%|█████████▌| 19/20 [12:29<00:36, 36.87s/it]
Task 1, Epoch 20/20 => Loss 0.290, Train_accy 90.98: 100%|██████████| 20/20 [12:29<00:00, 36.54s/it]
Task 1, Epoch 20/20 => Loss 0.290, Train_accy 90.98: 100%|██████████| 20/20 [12:29<00:00, 37.47s/it]
2024-09-07 09:06:48,890 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.290, Train_accy 90.98
2024-09-07 09:06:56,601 [trainer.py] => No NME accuracy.
2024-09-07 09:06:56,602 [trainer.py] => CNN: {'total': 76.5, '00-39': 69.42, '40-79': 84.45, 'old': 69.42, 'new': 84.45}
2024-09-07 09:06:56,602 [trainer.py] => CNN top1 curve: [89.25, 76.5]
2024-09-07 09:06:56,602 [trainer.py] => CNN top5 curve: [97.5, 92.47]

Average Accuracy (CNN): 82.88
2024-09-07 09:06:56,602 [trainer.py] => Average Accuracy (CNN): 82.88 

2024-09-07 09:06:56,604 [trainer.py] => All params: 85860176
2024-09-07 09:06:56,605 [trainer.py] => Trainable params: 85860176
2024-09-07 09:06:56,609 [finetune.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.835, Train_accy 29.17, Test_accy 69.79:   0%|          | 0/20 [00:48<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.835, Train_accy 29.17, Test_accy 69.79:   5%|▌         | 1/20 [00:48<15:18, 48.36s/it]
Task 2, Epoch 2/20 => Loss 0.837, Train_accy 60.76:   5%|▌         | 1/20 [01:25<15:18, 48.36s/it]                 
Task 2, Epoch 2/20 => Loss 0.837, Train_accy 60.76:  10%|█         | 2/20 [01:25<12:33, 41.88s/it]
Task 2, Epoch 3/20 => Loss 0.669, Train_accy 69.61:  10%|█         | 2/20 [02:03<12:33, 41.88s/it]
Task 2, Epoch 3/20 => Loss 0.669, Train_accy 69.61:  15%|█▌        | 3/20 [02:03<11:18, 39.89s/it]
Task 2, Epoch 4/20 => Loss 0.578, Train_accy 73.99:  15%|█▌        | 3/20 [02:40<11:18, 39.89s/it]
Task 2, Epoch 4/20 => Loss 0.578, Train_accy 73.99:  20%|██        | 4/20 [02:40<10:21, 38.86s/it]
Task 2, Epoch 5/20 => Loss 0.506, Train_accy 77.40:  20%|██        | 4/20 [03:17<10:21, 38.86s/it]
Task 2, Epoch 5/20 => Loss 0.506, Train_accy 77.40:  25%|██▌       | 5/20 [03:17<09:35, 38.36s/it]
Task 2, Epoch 6/20 => Loss 0.491, Train_accy 78.74, Test_accy 71.77:  25%|██▌       | 5/20 [04:06<09:35, 38.36s/it]
Task 2, Epoch 6/20 => Loss 0.491, Train_accy 78.74, Test_accy 71.77:  30%|███       | 6/20 [04:06<09:45, 41.80s/it]
Task 2, Epoch 7/20 => Loss 0.432, Train_accy 82.05:  30%|███       | 6/20 [04:43<09:45, 41.80s/it]                 
Task 2, Epoch 7/20 => Loss 0.432, Train_accy 82.05:  35%|███▌      | 7/20 [04:43<08:44, 40.34s/it]
Task 2, Epoch 8/20 => Loss 0.378, Train_accy 84.44:  35%|███▌      | 7/20 [05:20<08:44, 40.34s/it]
Task 2, Epoch 8/20 => Loss 0.378, Train_accy 84.44:  40%|████      | 8/20 [05:20<07:52, 39.34s/it]
Task 2, Epoch 9/20 => Loss 0.387, Train_accy 84.24:  40%|████      | 8/20 [05:58<07:52, 39.34s/it]
Task 2, Epoch 9/20 => Loss 0.387, Train_accy 84.24:  45%|████▌     | 9/20 [05:58<07:05, 38.67s/it]
Task 2, Epoch 10/20 => Loss 0.374, Train_accy 85.00:  45%|████▌     | 9/20 [06:35<07:05, 38.67s/it]
Task 2, Epoch 10/20 => Loss 0.374, Train_accy 85.00:  50%|█████     | 10/20 [06:35<06:22, 38.21s/it]
Task 2, Epoch 11/20 => Loss 0.353, Train_accy 86.12, Test_accy 71.03:  50%|█████     | 10/20 [07:23<06:22, 38.21s/it]
Task 2, Epoch 11/20 => Loss 0.353, Train_accy 86.12, Test_accy 71.03:  55%|█████▌    | 11/20 [07:23<06:10, 41.20s/it]
Task 2, Epoch 12/20 => Loss 0.333, Train_accy 87.11:  55%|█████▌    | 11/20 [08:00<06:10, 41.20s/it]                 
Task 2, Epoch 12/20 => Loss 0.333, Train_accy 87.11:  60%|██████    | 12/20 [08:00<05:20, 40.01s/it]
Task 2, Epoch 13/20 => Loss 0.344, Train_accy 86.69:  60%|██████    | 12/20 [08:37<05:20, 40.01s/it]
Task 2, Epoch 13/20 => Loss 0.344, Train_accy 86.69:  65%|██████▌   | 13/20 [08:37<04:34, 39.19s/it]
Task 2, Epoch 14/20 => Loss 0.314, Train_accy 88.66:  65%|██████▌   | 13/20 [09:15<04:34, 39.19s/it]
Task 2, Epoch 14/20 => Loss 0.314, Train_accy 88.66:  70%|███████   | 14/20 [09:15<03:51, 38.59s/it]
Task 2, Epoch 15/20 => Loss 0.306, Train_accy 88.26:  70%|███████   | 14/20 [09:52<03:51, 38.59s/it]
Task 2, Epoch 15/20 => Loss 0.306, Train_accy 88.26:  75%|███████▌  | 15/20 [09:52<03:10, 38.19s/it]
Task 2, Epoch 16/20 => Loss 0.289, Train_accy 89.17, Test_accy 68.97:  75%|███████▌  | 15/20 [10:41<03:10, 38.19s/it]
Task 2, Epoch 16/20 => Loss 0.289, Train_accy 89.17, Test_accy 68.97:  80%|████████  | 16/20 [10:41<02:45, 41.35s/it]
Task 2, Epoch 17/20 => Loss 0.309, Train_accy 88.72:  80%|████████  | 16/20 [11:18<02:45, 41.35s/it]                 
Task 2, Epoch 17/20 => Loss 0.309, Train_accy 88.72:  85%|████████▌ | 17/20 [11:18<02:00, 40.16s/it]
Task 2, Epoch 18/20 => Loss 0.289, Train_accy 88.80:  85%|████████▌ | 17/20 [11:55<02:00, 40.16s/it]
Task 2, Epoch 18/20 => Loss 0.289, Train_accy 88.80:  90%|█████████ | 18/20 [11:55<01:18, 39.29s/it]
Task 2, Epoch 19/20 => Loss 0.287, Train_accy 89.42:  90%|█████████ | 18/20 [12:33<01:18, 39.29s/it]
Task 2, Epoch 19/20 => Loss 0.287, Train_accy 89.42:  95%|█████████▌| 19/20 [12:33<00:38, 38.72s/it]
Task 2, Epoch 20/20 => Loss 0.282, Train_accy 90.00:  95%|█████████▌| 19/20 [13:10<00:38, 38.72s/it]
Task 2, Epoch 20/20 => Loss 0.282, Train_accy 90.00: 100%|██████████| 20/20 [13:10<00:00, 38.34s/it]
Task 2, Epoch 20/20 => Loss 0.282, Train_accy 90.00: 100%|██████████| 20/20 [13:10<00:00, 39.53s/it]
2024-09-07 09:20:07,206 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.282, Train_accy 90.00
2024-09-07 09:20:18,316 [trainer.py] => No NME accuracy.
2024-09-07 09:20:18,316 [trainer.py] => CNN: {'total': 68.45, '00-39': 54.5, '40-79': 69.58, '80-119': 83.35, 'old': 61.61, 'new': 83.35}
2024-09-07 09:20:18,316 [trainer.py] => CNN top1 curve: [89.25, 76.5, 68.45]
2024-09-07 09:20:18,316 [trainer.py] => CNN top5 curve: [97.5, 92.47, 87.6]

Average Accuracy (CNN): 78.07
2024-09-07 09:20:18,316 [trainer.py] => Average Accuracy (CNN): 78.07 

2024-09-07 09:20:18,317 [trainer.py] => All params: 85890936
2024-09-07 09:20:18,318 [trainer.py] => Trainable params: 85890936
2024-09-07 09:20:18,321 [finetune.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.818, Train_accy 29.94, Test_accy 65.32:   0%|          | 0/20 [00:52<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.818, Train_accy 29.94, Test_accy 65.32:   5%|▌         | 1/20 [00:52<16:43, 52.80s/it]
Task 3, Epoch 2/20 => Loss 0.774, Train_accy 62.23:   5%|▌         | 1/20 [01:30<16:43, 52.80s/it]                 
Task 3, Epoch 2/20 => Loss 0.774, Train_accy 62.23:  10%|█         | 2/20 [01:30<13:14, 44.15s/it]
Task 3, Epoch 3/20 => Loss 0.610, Train_accy 69.64:  10%|█         | 2/20 [02:09<13:14, 44.15s/it]
Task 3, Epoch 3/20 => Loss 0.610, Train_accy 69.64:  15%|█▌        | 3/20 [02:09<11:44, 41.42s/it]
Task 3, Epoch 4/20 => Loss 0.535, Train_accy 76.05:  15%|█▌        | 3/20 [02:47<11:44, 41.42s/it]
Task 3, Epoch 4/20 => Loss 0.535, Train_accy 76.05:  20%|██        | 4/20 [02:47<10:41, 40.10s/it]
Task 3, Epoch 5/20 => Loss 0.449, Train_accy 79.17:  20%|██        | 4/20 [03:25<10:41, 40.10s/it]
Task 3, Epoch 5/20 => Loss 0.449, Train_accy 79.17:  25%|██▌       | 5/20 [03:25<09:50, 39.39s/it]
Task 3, Epoch 6/20 => Loss 0.426, Train_accy 81.32, Test_accy 67.43:  25%|██▌       | 5/20 [04:18<09:50, 39.39s/it]
Task 3, Epoch 6/20 => Loss 0.426, Train_accy 81.32, Test_accy 67.43:  30%|███       | 6/20 [04:18<10:16, 44.03s/it]
Task 3, Epoch 7/20 => Loss 0.370, Train_accy 83.02:  30%|███       | 6/20 [04:56<10:16, 44.03s/it]                 
Task 3, Epoch 7/20 => Loss 0.370, Train_accy 83.02:  35%|███▌      | 7/20 [04:56<09:07, 42.09s/it]
Task 3, Epoch 8/20 => Loss 0.391, Train_accy 83.26:  35%|███▌      | 7/20 [05:34<09:07, 42.09s/it]
Task 3, Epoch 8/20 => Loss 0.391, Train_accy 83.26:  40%|████      | 8/20 [05:34<08:11, 40.96s/it]
Task 3, Epoch 9/20 => Loss 0.372, Train_accy 83.93:  40%|████      | 8/20 [06:13<08:11, 40.96s/it]
Task 3, Epoch 9/20 => Loss 0.372, Train_accy 83.93:  45%|████▌     | 9/20 [06:13<07:21, 40.14s/it]
Task 3, Epoch 10/20 => Loss 0.326, Train_accy 86.34:  45%|████▌     | 9/20 [06:51<07:21, 40.14s/it]
Task 3, Epoch 10/20 => Loss 0.326, Train_accy 86.34:  50%|█████     | 10/20 [06:51<06:35, 39.58s/it]
Task 3, Epoch 11/20 => Loss 0.314, Train_accy 87.45, Test_accy 65.00:  50%|█████     | 10/20 [07:44<06:35, 39.58s/it]
Task 3, Epoch 11/20 => Loss 0.314, Train_accy 87.45, Test_accy 65.00:  55%|█████▌    | 11/20 [07:44<06:33, 43.71s/it]
Task 3, Epoch 12/20 => Loss 0.296, Train_accy 88.10:  55%|█████▌    | 11/20 [08:22<06:33, 43.71s/it]                 
Task 3, Epoch 12/20 => Loss 0.296, Train_accy 88.10:  60%|██████    | 12/20 [08:22<05:36, 42.03s/it]
Task 3, Epoch 13/20 => Loss 0.284, Train_accy 88.77:  60%|██████    | 12/20 [09:01<05:36, 42.03s/it]
Task 3, Epoch 13/20 => Loss 0.284, Train_accy 88.77:  65%|██████▌   | 13/20 [09:01<04:46, 40.88s/it]
Task 3, Epoch 14/20 => Loss 0.310, Train_accy 87.41:  65%|██████▌   | 13/20 [09:39<04:46, 40.88s/it]
Task 3, Epoch 14/20 => Loss 0.310, Train_accy 87.41:  70%|███████   | 14/20 [09:39<04:00, 40.04s/it]
Task 3, Epoch 15/20 => Loss 0.297, Train_accy 88.26:  70%|███████   | 14/20 [10:17<04:00, 40.04s/it]
Task 3, Epoch 15/20 => Loss 0.297, Train_accy 88.26:  75%|███████▌  | 15/20 [10:17<03:17, 39.46s/it]
Task 3, Epoch 16/20 => Loss 0.271, Train_accy 89.62, Test_accy 65.87:  75%|███████▌  | 15/20 [11:10<03:17, 39.46s/it]
Task 3, Epoch 16/20 => Loss 0.271, Train_accy 89.62, Test_accy 65.87:  80%|████████  | 16/20 [11:10<02:53, 43.49s/it]
Task 3, Epoch 17/20 => Loss 0.282, Train_accy 89.31:  80%|████████  | 16/20 [11:48<02:53, 43.49s/it]                 
Task 3, Epoch 17/20 => Loss 0.282, Train_accy 89.31:  85%|████████▌ | 17/20 [11:48<02:05, 41.88s/it]
Task 3, Epoch 18/20 => Loss 0.250, Train_accy 90.45:  85%|████████▌ | 17/20 [12:26<02:05, 41.88s/it]
Task 3, Epoch 18/20 => Loss 0.250, Train_accy 90.45:  90%|█████████ | 18/20 [12:26<01:21, 40.74s/it]
Task 3, Epoch 19/20 => Loss 0.239, Train_accy 90.40:  90%|█████████ | 18/20 [13:04<01:21, 40.74s/it]
Task 3, Epoch 19/20 => Loss 0.239, Train_accy 90.40:  95%|█████████▌| 19/20 [13:04<00:39, 39.97s/it]
Task 3, Epoch 20/20 => Loss 0.247, Train_accy 90.16:  95%|█████████▌| 19/20 [13:42<00:39, 39.97s/it]
Task 3, Epoch 20/20 => Loss 0.247, Train_accy 90.16: 100%|██████████| 20/20 [13:42<00:00, 39.40s/it]
Task 3, Epoch 20/20 => Loss 0.247, Train_accy 90.16: 100%|██████████| 20/20 [13:42<00:00, 41.13s/it]
2024-09-07 09:34:00,951 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.247, Train_accy 90.16
2024-09-07 09:34:15,500 [trainer.py] => No NME accuracy.
2024-09-07 09:34:15,501 [trainer.py] => CNN: {'total': 64.48, '00-39': 46.48, '40-79': 58.88, '80-119': 69.31, '120-159': 83.59, 'old': 57.67, 'new': 83.59}
2024-09-07 09:34:15,501 [trainer.py] => CNN top1 curve: [89.25, 76.5, 68.45, 64.48]
2024-09-07 09:34:15,501 [trainer.py] => CNN top5 curve: [97.5, 92.47, 87.6, 85.37]

Average Accuracy (CNN): 74.67
2024-09-07 09:34:15,501 [trainer.py] => Average Accuracy (CNN): 74.67 

2024-09-07 09:34:15,502 [trainer.py] => All params: 85921696
2024-09-07 09:34:15,503 [trainer.py] => Trainable params: 85921696
2024-09-07 09:34:15,506 [finetune.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.994, Train_accy 23.42, Test_accy 60.88:   0%|          | 0/20 [00:49<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.994, Train_accy 23.42, Test_accy 60.88:   5%|▌         | 1/20 [00:49<15:49, 49.97s/it]
Task 4, Epoch 2/20 => Loss 0.886, Train_accy 56.73:   5%|▌         | 1/20 [01:22<15:49, 49.97s/it]                 
Task 4, Epoch 2/20 => Loss 0.886, Train_accy 56.73:  10%|█         | 2/20 [01:22<11:54, 39.70s/it]
Task 4, Epoch 3/20 => Loss 0.689, Train_accy 65.98:  10%|█         | 2/20 [01:55<11:54, 39.70s/it]
Task 4, Epoch 3/20 => Loss 0.689, Train_accy 65.98:  15%|█▌        | 3/20 [01:55<10:19, 36.47s/it]
Task 4, Epoch 4/20 => Loss 0.554, Train_accy 71.76:  15%|█▌        | 3/20 [02:27<10:19, 36.47s/it]
Task 4, Epoch 4/20 => Loss 0.554, Train_accy 71.76:  20%|██        | 4/20 [02:27<09:19, 34.99s/it]
Task 4, Epoch 5/20 => Loss 0.467, Train_accy 75.82:  20%|██        | 4/20 [03:00<09:19, 34.99s/it]
Task 4, Epoch 5/20 => Loss 0.467, Train_accy 75.82:  25%|██▌       | 5/20 [03:00<08:33, 34.20s/it]
Task 4, Epoch 6/20 => Loss 0.466, Train_accy 77.52, Test_accy 61.73:  25%|██▌       | 5/20 [03:51<08:33, 34.20s/it]
Task 4, Epoch 6/20 => Loss 0.466, Train_accy 77.52, Test_accy 61.73:  30%|███       | 6/20 [03:51<09:16, 39.74s/it]
Task 4, Epoch 7/20 => Loss 0.457, Train_accy 78.69:  30%|███       | 6/20 [04:24<09:16, 39.74s/it]                 
Task 4, Epoch 7/20 => Loss 0.457, Train_accy 78.69:  35%|███▌      | 7/20 [04:24<08:07, 37.50s/it]
Task 4, Epoch 8/20 => Loss 0.398, Train_accy 80.75:  35%|███▌      | 7/20 [04:56<08:07, 37.50s/it]
Task 4, Epoch 8/20 => Loss 0.398, Train_accy 80.75:  40%|████      | 8/20 [04:56<07:11, 35.95s/it]
Task 4, Epoch 9/20 => Loss 0.377, Train_accy 82.46:  40%|████      | 8/20 [05:29<07:11, 35.95s/it]
Task 4, Epoch 9/20 => Loss 0.377, Train_accy 82.46:  45%|████▌     | 9/20 [05:29<06:23, 34.91s/it]
Task 4, Epoch 10/20 => Loss 0.344, Train_accy 84.42:  45%|████▌     | 9/20 [06:02<06:23, 34.91s/it]
Task 4, Epoch 10/20 => Loss 0.344, Train_accy 84.42:  50%|█████     | 10/20 [06:02<05:42, 34.27s/it]
Task 4, Epoch 11/20 => Loss 0.357, Train_accy 83.69, Test_accy 60.03:  50%|█████     | 10/20 [06:52<05:42, 34.27s/it]
Task 4, Epoch 11/20 => Loss 0.357, Train_accy 83.69, Test_accy 60.03:  55%|█████▌    | 11/20 [06:52<05:53, 39.27s/it]
Task 4, Epoch 12/20 => Loss 0.373, Train_accy 84.12:  55%|█████▌    | 11/20 [07:25<05:53, 39.27s/it]                 
Task 4, Epoch 12/20 => Loss 0.373, Train_accy 84.12:  60%|██████    | 12/20 [07:25<04:58, 37.32s/it]
Task 4, Epoch 13/20 => Loss 0.318, Train_accy 85.49:  60%|██████    | 12/20 [07:58<04:58, 37.32s/it]
Task 4, Epoch 13/20 => Loss 0.318, Train_accy 85.49:  65%|██████▌   | 13/20 [07:58<04:11, 35.86s/it]
Task 4, Epoch 14/20 => Loss 0.323, Train_accy 86.96:  65%|██████▌   | 13/20 [08:30<04:11, 35.86s/it]
Task 4, Epoch 14/20 => Loss 0.323, Train_accy 86.96:  70%|███████   | 14/20 [08:30<03:29, 34.86s/it]
Task 4, Epoch 15/20 => Loss 0.325, Train_accy 87.15:  70%|███████   | 14/20 [09:03<03:29, 34.86s/it]
Task 4, Epoch 15/20 => Loss 0.325, Train_accy 87.15:  75%|███████▌  | 15/20 [09:03<02:50, 34.15s/it]
Task 4, Epoch 16/20 => Loss 0.277, Train_accy 87.60, Test_accy 58.53:  75%|███████▌  | 15/20 [09:53<02:50, 34.15s/it]
Task 4, Epoch 16/20 => Loss 0.277, Train_accy 87.60, Test_accy 58.53:  80%|████████  | 16/20 [09:53<02:36, 39.07s/it]
Task 4, Epoch 17/20 => Loss 0.281, Train_accy 88.15:  80%|████████  | 16/20 [10:26<02:36, 39.07s/it]                 
Task 4, Epoch 17/20 => Loss 0.281, Train_accy 88.15:  85%|████████▌ | 17/20 [10:26<01:51, 37.10s/it]
Task 4, Epoch 18/20 => Loss 0.270, Train_accy 89.07:  85%|████████▌ | 17/20 [10:58<01:51, 37.10s/it]
Task 4, Epoch 18/20 => Loss 0.270, Train_accy 89.07:  90%|█████████ | 18/20 [10:58<01:11, 35.78s/it]
Task 4, Epoch 19/20 => Loss 0.228, Train_accy 89.73:  90%|█████████ | 18/20 [11:31<01:11, 35.78s/it]
Task 4, Epoch 19/20 => Loss 0.228, Train_accy 89.73:  95%|█████████▌| 19/20 [11:31<00:34, 34.83s/it]
Task 4, Epoch 20/20 => Loss 0.275, Train_accy 88.41:  95%|█████████▌| 19/20 [12:04<00:34, 34.83s/it]
Task 4, Epoch 20/20 => Loss 0.275, Train_accy 88.41: 100%|██████████| 20/20 [12:04<00:00, 34.18s/it]
Task 4, Epoch 20/20 => Loss 0.275, Train_accy 88.41: 100%|██████████| 20/20 [12:04<00:00, 36.21s/it]
2024-09-07 09:46:19,675 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.275, Train_accy 88.41
2024-09-07 09:46:37,601 [trainer.py] => No NME accuracy.
2024-09-07 09:46:37,601 [trainer.py] => CNN: {'total': 59.52, '00-39': 38.38, '40-79': 48.09, '80-119': 58.85, '120-159': 73.57, '160-199': 82.12, 'old': 54.68, 'new': 82.12}
2024-09-07 09:46:37,601 [trainer.py] => CNN top1 curve: [89.25, 76.5, 68.45, 64.48, 59.52]
2024-09-07 09:46:37,601 [trainer.py] => CNN top5 curve: [97.5, 92.47, 87.6, 85.37, 81.47]

Average Accuracy (CNN): 71.64
2024-09-07 09:46:37,602 [trainer.py] => Average Accuracy (CNN): 71.64 

Accuracy Matrix (CNN):
[[89.25 69.42 54.5  46.48 38.38]
 [ 0.   84.45 69.58 58.88 48.09]
 [ 0.    0.   83.35 69.31 58.85]
 [ 0.    0.    0.   83.59 73.57]
 [ 0.    0.    0.    0.   82.12]]
2024-09-07 09:46:37,603 [trainer.py] => Forgetting (CNN): 30.4375
2024-09-07 09:46:40,407 [trainer.py] => config: ./exps/finetune_inr_B0_Inc10.json
2024-09-07 09:46:40,407 [trainer.py] => prefix: reproduce
2024-09-07 09:46:40,407 [trainer.py] => dataset: imagenetr
2024-09-07 09:46:40,407 [trainer.py] => memory_size: 0
2024-09-07 09:46:40,407 [trainer.py] => memory_per_class: 0
2024-09-07 09:46:40,407 [trainer.py] => fixed_memory: False
2024-09-07 09:46:40,407 [trainer.py] => shuffle: True
2024-09-07 09:46:40,407 [trainer.py] => init_cls: 20
2024-09-07 09:46:40,407 [trainer.py] => increment: 20
2024-09-07 09:46:40,407 [trainer.py] => model_name: finetune
2024-09-07 09:46:40,407 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 09:46:40,407 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 09:46:40,407 [trainer.py] => seed: 1993
2024-09-07 09:46:40,407 [trainer.py] => init_epoch: 20
2024-09-07 09:46:40,407 [trainer.py] => init_lr: 0.001
2024-09-07 09:46:40,407 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 09:46:40,407 [trainer.py] => init_lr_decay: 0.1
2024-09-07 09:46:40,407 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 09:46:40,407 [trainer.py] => epochs: 20
2024-09-07 09:46:40,407 [trainer.py] => lrate: 0.001
2024-09-07 09:46:40,407 [trainer.py] => milestones: [40, 70]
2024-09-07 09:46:40,407 [trainer.py] => lrate_decay: 0.1
2024-09-07 09:46:40,407 [trainer.py] => batch_size: 48
2024-09-07 09:46:40,407 [trainer.py] => weight_decay: 0.0002
2024-09-07 09:46:40,490 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 09:46:42,368 [trainer.py] => All params: 85798656
2024-09-07 09:46:42,369 [trainer.py] => Trainable params: 85798656
2024-09-07 09:46:42,369 [finetune.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.289, Train_accy 34.38, Test_accy 71.70:   0%|          | 0/20 [00:24<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.289, Train_accy 34.38, Test_accy 71.70:   5%|▌         | 1/20 [00:24<07:42, 24.36s/it]
Task 0, Epoch 2/20 => Loss 0.881, Train_accy 74.39:   5%|▌         | 1/20 [00:46<07:42, 24.36s/it]                 
Task 0, Epoch 2/20 => Loss 0.881, Train_accy 74.39:  10%|█         | 2/20 [00:46<06:50, 22.83s/it]
Task 0, Epoch 3/20 => Loss 0.593, Train_accy 83.45:  10%|█         | 2/20 [01:07<06:50, 22.83s/it]
Task 0, Epoch 3/20 => Loss 0.593, Train_accy 83.45:  15%|█▌        | 3/20 [01:07<06:19, 22.34s/it]
Task 0, Epoch 4/20 => Loss 0.446, Train_accy 87.20:  15%|█▌        | 3/20 [01:29<06:19, 22.34s/it]
Task 0, Epoch 4/20 => Loss 0.446, Train_accy 87.20:  20%|██        | 4/20 [01:29<05:53, 22.10s/it]
Task 0, Epoch 5/20 => Loss 0.382, Train_accy 89.51:  20%|██        | 4/20 [01:51<05:53, 22.10s/it]
Task 0, Epoch 5/20 => Loss 0.382, Train_accy 89.51:  25%|██▌       | 5/20 [01:51<05:29, 22.00s/it]
Task 0, Epoch 6/20 => Loss 0.368, Train_accy 89.51, Test_accy 93.18:  25%|██▌       | 5/20 [02:15<05:29, 22.00s/it]
Task 0, Epoch 6/20 => Loss 0.368, Train_accy 89.51, Test_accy 93.18:  30%|███       | 6/20 [02:15<05:18, 22.78s/it]
Task 0, Epoch 7/20 => Loss 0.318, Train_accy 90.41:  30%|███       | 6/20 [02:37<05:18, 22.78s/it]                 
Task 0, Epoch 7/20 => Loss 0.318, Train_accy 90.41:  35%|███▌      | 7/20 [02:37<04:52, 22.49s/it]
Task 0, Epoch 8/20 => Loss 0.274, Train_accy 92.05:  35%|███▌      | 7/20 [02:59<04:52, 22.49s/it]
Task 0, Epoch 8/20 => Loss 0.274, Train_accy 92.05:  40%|████      | 8/20 [02:59<04:27, 22.27s/it]
Task 0, Epoch 9/20 => Loss 0.296, Train_accy 91.65:  40%|████      | 8/20 [03:21<04:27, 22.27s/it]
Task 0, Epoch 9/20 => Loss 0.296, Train_accy 91.65:  45%|████▌     | 9/20 [03:21<04:03, 22.14s/it]
Task 0, Epoch 10/20 => Loss 0.276, Train_accy 91.65:  45%|████▌     | 9/20 [03:43<04:03, 22.14s/it]
Task 0, Epoch 10/20 => Loss 0.276, Train_accy 91.65:  50%|█████     | 10/20 [03:43<03:40, 22.04s/it]
Task 0, Epoch 11/20 => Loss 0.234, Train_accy 93.54, Test_accy 92.89:  50%|█████     | 10/20 [04:07<03:40, 22.04s/it]
Task 0, Epoch 11/20 => Loss 0.234, Train_accy 93.54, Test_accy 92.89:  55%|█████▌    | 11/20 [04:07<03:24, 22.72s/it]
Task 0, Epoch 12/20 => Loss 0.288, Train_accy 91.51:  55%|█████▌    | 11/20 [04:29<03:24, 22.72s/it]                 
Task 0, Epoch 12/20 => Loss 0.288, Train_accy 91.51:  60%|██████    | 12/20 [04:29<02:59, 22.44s/it]
Task 0, Epoch 13/20 => Loss 0.232, Train_accy 93.26:  60%|██████    | 12/20 [04:50<02:59, 22.44s/it]
Task 0, Epoch 13/20 => Loss 0.232, Train_accy 93.26:  65%|██████▌   | 13/20 [04:50<02:35, 22.23s/it]
Task 0, Epoch 14/20 => Loss 0.234, Train_accy 93.01:  65%|██████▌   | 13/20 [05:12<02:35, 22.23s/it]
Task 0, Epoch 14/20 => Loss 0.234, Train_accy 93.01:  70%|███████   | 14/20 [05:12<02:12, 22.15s/it]
Task 0, Epoch 15/20 => Loss 0.203, Train_accy 94.19:  70%|███████   | 14/20 [05:34<02:12, 22.15s/it]
Task 0, Epoch 15/20 => Loss 0.203, Train_accy 94.19:  75%|███████▌  | 15/20 [05:34<01:50, 22.04s/it]
Task 0, Epoch 16/20 => Loss 0.226, Train_accy 93.69, Test_accy 93.47:  75%|███████▌  | 15/20 [05:58<01:50, 22.04s/it]
Task 0, Epoch 16/20 => Loss 0.226, Train_accy 93.69, Test_accy 93.47:  80%|████████  | 16/20 [05:58<01:30, 22.69s/it]
Task 0, Epoch 17/20 => Loss 0.195, Train_accy 94.15:  80%|████████  | 16/20 [06:20<01:30, 22.69s/it]                 
Task 0, Epoch 17/20 => Loss 0.195, Train_accy 94.15:  85%|████████▌ | 17/20 [06:20<01:07, 22.42s/it]
Task 0, Epoch 18/20 => Loss 0.211, Train_accy 93.01:  85%|████████▌ | 17/20 [06:42<01:07, 22.42s/it]
Task 0, Epoch 18/20 => Loss 0.211, Train_accy 93.01:  90%|█████████ | 18/20 [06:42<00:44, 22.21s/it]
Task 0, Epoch 19/20 => Loss 0.186, Train_accy 94.69:  90%|█████████ | 18/20 [07:04<00:44, 22.21s/it]
Task 0, Epoch 19/20 => Loss 0.186, Train_accy 94.69:  95%|█████████▌| 19/20 [07:04<00:22, 22.09s/it]
Task 0, Epoch 20/20 => Loss 0.199, Train_accy 94.01:  95%|█████████▌| 19/20 [07:26<00:22, 22.09s/it]
Task 0, Epoch 20/20 => Loss 0.199, Train_accy 94.01: 100%|██████████| 20/20 [07:26<00:00, 22.04s/it]
Task 0, Epoch 20/20 => Loss 0.199, Train_accy 94.01: 100%|██████████| 20/20 [07:26<00:00, 22.30s/it]
2024-09-07 09:54:08,925 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.199, Train_accy 94.01
2024-09-07 09:54:11,380 [trainer.py] => No NME accuracy.
2024-09-07 09:54:11,381 [trainer.py] => CNN: {'total': 93.32, '00-19': 93.32, 'old': 0, 'new': 93.32}
2024-09-07 09:54:11,381 [trainer.py] => CNN top1 curve: [93.32]
2024-09-07 09:54:11,381 [trainer.py] => CNN top5 curve: [99.13]

Average Accuracy (CNN): 93.32
2024-09-07 09:54:11,381 [trainer.py] => Average Accuracy (CNN): 93.32 

2024-09-07 09:54:11,382 [trainer.py] => All params: 85814036
2024-09-07 09:54:11,383 [trainer.py] => Trainable params: 85814036
2024-09-07 09:54:11,385 [finetune.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.435, Train_accy 38.60, Test_accy 80.09:   0%|          | 0/20 [00:24<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.435, Train_accy 38.60, Test_accy 80.09:   5%|▌         | 1/20 [00:24<07:39, 24.21s/it]
Task 1, Epoch 2/20 => Loss 0.555, Train_accy 75.80:   5%|▌         | 1/20 [00:44<07:39, 24.21s/it]                 
Task 1, Epoch 2/20 => Loss 0.555, Train_accy 75.80:  10%|█         | 2/20 [00:44<06:30, 21.70s/it]
Task 1, Epoch 3/20 => Loss 0.481, Train_accy 79.98:  10%|█         | 2/20 [01:04<06:30, 21.70s/it]
Task 1, Epoch 3/20 => Loss 0.481, Train_accy 79.98:  15%|█▌        | 3/20 [01:04<05:55, 20.90s/it]
Task 1, Epoch 4/20 => Loss 0.421, Train_accy 82.40:  15%|█▌        | 3/20 [01:23<05:55, 20.90s/it]
Task 1, Epoch 4/20 => Loss 0.421, Train_accy 82.40:  20%|██        | 4/20 [01:23<05:28, 20.50s/it]
Task 1, Epoch 5/20 => Loss 0.381, Train_accy 84.58:  20%|██        | 4/20 [01:43<05:28, 20.50s/it]
Task 1, Epoch 5/20 => Loss 0.381, Train_accy 84.58:  25%|██▌       | 5/20 [01:43<05:04, 20.30s/it]
Task 1, Epoch 6/20 => Loss 0.366, Train_accy 85.13, Test_accy 82.21:  25%|██▌       | 5/20 [02:08<05:04, 20.30s/it]
Task 1, Epoch 6/20 => Loss 0.366, Train_accy 85.13, Test_accy 82.21:  30%|███       | 6/20 [02:08<05:03, 21.66s/it]
Task 1, Epoch 7/20 => Loss 0.337, Train_accy 86.96:  30%|███       | 6/20 [02:28<05:03, 21.66s/it]                 
Task 1, Epoch 7/20 => Loss 0.337, Train_accy 86.96:  35%|███▌      | 7/20 [02:28<04:34, 21.10s/it]
Task 1, Epoch 8/20 => Loss 0.334, Train_accy 86.77:  35%|███▌      | 7/20 [02:48<04:34, 21.10s/it]
Task 1, Epoch 8/20 => Loss 0.334, Train_accy 86.77:  40%|████      | 8/20 [02:48<04:09, 20.75s/it]
Task 1, Epoch 9/20 => Loss 0.315, Train_accy 88.02:  40%|████      | 8/20 [03:08<04:09, 20.75s/it]
Task 1, Epoch 9/20 => Loss 0.315, Train_accy 88.02:  45%|████▌     | 9/20 [03:08<03:45, 20.47s/it]
Task 1, Epoch 10/20 => Loss 0.270, Train_accy 88.88:  45%|████▌     | 9/20 [03:27<03:45, 20.47s/it]
Task 1, Epoch 10/20 => Loss 0.270, Train_accy 88.88:  50%|█████     | 10/20 [03:27<03:23, 20.30s/it]
Task 1, Epoch 11/20 => Loss 0.282, Train_accy 89.50, Test_accy 85.09:  50%|█████     | 10/20 [03:52<03:23, 20.30s/it]
Task 1, Epoch 11/20 => Loss 0.282, Train_accy 89.50, Test_accy 85.09:  55%|█████▌    | 11/20 [03:52<03:13, 21.50s/it]
Task 1, Epoch 12/20 => Loss 0.244, Train_accy 90.87:  55%|█████▌    | 11/20 [04:12<03:13, 21.50s/it]                 
Task 1, Epoch 12/20 => Loss 0.244, Train_accy 90.87:  60%|██████    | 12/20 [04:12<02:48, 21.04s/it]
Task 1, Epoch 13/20 => Loss 0.251, Train_accy 90.48:  60%|██████    | 12/20 [04:32<02:48, 21.04s/it]
Task 1, Epoch 13/20 => Loss 0.251, Train_accy 90.48:  65%|██████▌   | 13/20 [04:32<02:25, 20.75s/it]
Task 1, Epoch 14/20 => Loss 0.260, Train_accy 90.55:  65%|██████▌   | 13/20 [04:52<02:25, 20.75s/it]
Task 1, Epoch 14/20 => Loss 0.260, Train_accy 90.55:  70%|███████   | 14/20 [04:52<02:03, 20.53s/it]
Task 1, Epoch 15/20 => Loss 0.236, Train_accy 91.14:  70%|███████   | 14/20 [05:12<02:03, 20.53s/it]
Task 1, Epoch 15/20 => Loss 0.236, Train_accy 91.14:  75%|███████▌  | 15/20 [05:12<01:41, 20.31s/it]
Task 1, Epoch 16/20 => Loss 0.255, Train_accy 90.28, Test_accy 84.03:  75%|███████▌  | 15/20 [05:36<01:41, 20.31s/it]
Task 1, Epoch 16/20 => Loss 0.255, Train_accy 90.28, Test_accy 84.03:  80%|████████  | 16/20 [05:36<01:25, 21.48s/it]
Task 1, Epoch 17/20 => Loss 0.236, Train_accy 91.41:  80%|████████  | 16/20 [05:56<01:25, 21.48s/it]                 
Task 1, Epoch 17/20 => Loss 0.236, Train_accy 91.41:  85%|████████▌ | 17/20 [05:56<01:02, 21.00s/it]
Task 1, Epoch 18/20 => Loss 0.209, Train_accy 92.27:  85%|████████▌ | 17/20 [06:16<01:02, 21.00s/it]
Task 1, Epoch 18/20 => Loss 0.209, Train_accy 92.27:  90%|█████████ | 18/20 [06:16<00:41, 20.71s/it]
Task 1, Epoch 19/20 => Loss 0.208, Train_accy 92.27:  90%|█████████ | 18/20 [06:36<00:41, 20.71s/it]
Task 1, Epoch 19/20 => Loss 0.208, Train_accy 92.27:  95%|█████████▌| 19/20 [06:36<00:20, 20.47s/it]
Task 1, Epoch 20/20 => Loss 0.199, Train_accy 92.66:  95%|█████████▌| 19/20 [06:56<00:20, 20.47s/it]
Task 1, Epoch 20/20 => Loss 0.199, Train_accy 92.66: 100%|██████████| 20/20 [06:56<00:00, 20.32s/it]
Task 1, Epoch 20/20 => Loss 0.199, Train_accy 92.66: 100%|██████████| 20/20 [06:56<00:00, 20.80s/it]
2024-09-07 10:01:07,439 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.199, Train_accy 92.66
2024-09-07 10:01:11,712 [trainer.py] => No NME accuracy.
2024-09-07 10:01:11,713 [trainer.py] => CNN: {'total': 84.1, '00-19': 77.94, '20-39': 90.82, 'old': 77.94, 'new': 90.82}
2024-09-07 10:01:11,713 [trainer.py] => CNN top1 curve: [93.32, 84.1]
2024-09-07 10:01:11,713 [trainer.py] => CNN top5 curve: [99.13, 95.91]

Average Accuracy (CNN): 88.71
2024-09-07 10:01:11,713 [trainer.py] => Average Accuracy (CNN): 88.71 

2024-09-07 10:01:11,715 [trainer.py] => All params: 85829416
2024-09-07 10:01:11,717 [trainer.py] => Trainable params: 85829416
2024-09-07 10:01:11,720 [finetune.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.635, Train_accy 30.30, Test_accy 78.00:   0%|          | 0/20 [00:24<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.635, Train_accy 30.30, Test_accy 78.00:   5%|▌         | 1/20 [00:24<07:40, 24.25s/it]
Task 2, Epoch 2/20 => Loss 0.691, Train_accy 67.01:   5%|▌         | 1/20 [00:42<07:40, 24.25s/it]                 
Task 2, Epoch 2/20 => Loss 0.691, Train_accy 67.01:  10%|█         | 2/20 [00:42<06:12, 20.69s/it]
Task 2, Epoch 3/20 => Loss 0.531, Train_accy 75.46:  10%|█         | 2/20 [01:00<06:12, 20.69s/it]
Task 2, Epoch 3/20 => Loss 0.531, Train_accy 75.46:  15%|█▌        | 3/20 [01:00<05:31, 19.53s/it]
Task 2, Epoch 4/20 => Loss 0.464, Train_accy 78.53:  15%|█▌        | 3/20 [01:18<05:31, 19.53s/it]
Task 2, Epoch 4/20 => Loss 0.464, Train_accy 78.53:  20%|██        | 4/20 [01:18<05:03, 18.98s/it]
Task 2, Epoch 5/20 => Loss 0.385, Train_accy 81.01:  20%|██        | 4/20 [01:37<05:03, 18.98s/it]
Task 2, Epoch 5/20 => Loss 0.385, Train_accy 81.01:  25%|██▌       | 5/20 [01:37<04:41, 18.76s/it]
Task 2, Epoch 6/20 => Loss 0.338, Train_accy 83.91, Test_accy 81.01:  25%|██▌       | 5/20 [02:01<04:41, 18.76s/it]
Task 2, Epoch 6/20 => Loss 0.338, Train_accy 83.91, Test_accy 81.01:  30%|███       | 6/20 [02:01<04:49, 20.65s/it]
Task 2, Epoch 7/20 => Loss 0.324, Train_accy 84.17:  30%|███       | 6/20 [02:19<04:49, 20.65s/it]                 
Task 2, Epoch 7/20 => Loss 0.324, Train_accy 84.17:  35%|███▌      | 7/20 [02:19<04:18, 19.86s/it]
Task 2, Epoch 8/20 => Loss 0.329, Train_accy 85.28:  35%|███▌      | 7/20 [02:37<04:18, 19.86s/it]
Task 2, Epoch 8/20 => Loss 0.329, Train_accy 85.28:  40%|████      | 8/20 [02:37<03:52, 19.37s/it]
Task 2, Epoch 9/20 => Loss 0.316, Train_accy 84.72:  40%|████      | 8/20 [02:56<03:52, 19.37s/it]
Task 2, Epoch 9/20 => Loss 0.316, Train_accy 84.72:  45%|████▌     | 9/20 [02:56<03:29, 19.02s/it]
Task 2, Epoch 10/20 => Loss 0.283, Train_accy 86.77:  45%|████▌     | 9/20 [03:14<03:29, 19.02s/it]
Task 2, Epoch 10/20 => Loss 0.283, Train_accy 86.77:  50%|█████     | 10/20 [03:14<03:08, 18.90s/it]
Task 2, Epoch 11/20 => Loss 0.269, Train_accy 87.45, Test_accy 78.26:  50%|█████     | 10/20 [03:39<03:08, 18.90s/it]
Task 2, Epoch 11/20 => Loss 0.269, Train_accy 87.45, Test_accy 78.26:  55%|█████▌    | 11/20 [03:39<03:04, 20.55s/it]
Task 2, Epoch 12/20 => Loss 0.249, Train_accy 87.79:  55%|█████▌    | 11/20 [03:57<03:04, 20.55s/it]                 
Task 2, Epoch 12/20 => Loss 0.249, Train_accy 87.79:  60%|██████    | 12/20 [03:57<02:38, 19.86s/it]
Task 2, Epoch 13/20 => Loss 0.271, Train_accy 87.28:  60%|██████    | 12/20 [04:15<02:38, 19.86s/it]
Task 2, Epoch 13/20 => Loss 0.271, Train_accy 87.28:  65%|██████▌   | 13/20 [04:15<02:15, 19.37s/it]
Task 2, Epoch 14/20 => Loss 0.242, Train_accy 89.42:  65%|██████▌   | 13/20 [04:33<02:15, 19.37s/it]
Task 2, Epoch 14/20 => Loss 0.242, Train_accy 89.42:  70%|███████   | 14/20 [04:33<01:54, 19.04s/it]
Task 2, Epoch 15/20 => Loss 0.227, Train_accy 89.63:  70%|███████   | 14/20 [04:52<01:54, 19.04s/it]
Task 2, Epoch 15/20 => Loss 0.227, Train_accy 89.63:  75%|███████▌  | 15/20 [04:52<01:34, 18.82s/it]
Task 2, Epoch 16/20 => Loss 0.231, Train_accy 89.07, Test_accy 79.97:  75%|███████▌  | 15/20 [05:16<01:34, 18.82s/it]
Task 2, Epoch 16/20 => Loss 0.231, Train_accy 89.07, Test_accy 79.97:  80%|████████  | 16/20 [05:16<01:21, 20.49s/it]
Task 2, Epoch 17/20 => Loss 0.251, Train_accy 88.69:  80%|████████  | 16/20 [05:34<01:21, 20.49s/it]                 
Task 2, Epoch 17/20 => Loss 0.251, Train_accy 88.69:  85%|████████▌ | 17/20 [05:34<00:59, 19.85s/it]
Task 2, Epoch 18/20 => Loss 0.206, Train_accy 90.40:  85%|████████▌ | 17/20 [05:53<00:59, 19.85s/it]
Task 2, Epoch 18/20 => Loss 0.206, Train_accy 90.40:  90%|█████████ | 18/20 [05:53<00:38, 19.38s/it]
Task 2, Epoch 19/20 => Loss 0.215, Train_accy 90.06:  90%|█████████ | 18/20 [06:11<00:38, 19.38s/it]
Task 2, Epoch 19/20 => Loss 0.215, Train_accy 90.06:  95%|█████████▌| 19/20 [06:11<00:19, 19.09s/it]
Task 2, Epoch 20/20 => Loss 0.202, Train_accy 90.52:  95%|█████████▌| 19/20 [06:30<00:19, 19.09s/it]
Task 2, Epoch 20/20 => Loss 0.202, Train_accy 90.52: 100%|██████████| 20/20 [06:30<00:00, 18.88s/it]
Task 2, Epoch 20/20 => Loss 0.202, Train_accy 90.52: 100%|██████████| 20/20 [06:30<00:00, 19.50s/it]
2024-09-07 10:07:41,797 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.202, Train_accy 90.52
2024-09-07 10:07:47,886 [trainer.py] => No NME accuracy.
2024-09-07 10:07:47,886 [trainer.py] => CNN: {'total': 77.48, '00-19': 70.1, '20-39': 79.27, '40-59': 83.99, 'old': 74.49, 'new': 83.99}
2024-09-07 10:07:47,886 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48]
2024-09-07 10:07:47,887 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67]

Average Accuracy (CNN): 84.97
2024-09-07 10:07:47,887 [trainer.py] => Average Accuracy (CNN): 84.97 

2024-09-07 10:07:47,888 [trainer.py] => All params: 85844796
2024-09-07 10:07:47,889 [trainer.py] => Trainable params: 85844796
2024-09-07 10:07:47,892 [finetune.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.558, Train_accy 31.44, Test_accy 71.54:   0%|          | 0/20 [00:25<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.558, Train_accy 31.44, Test_accy 71.54:   5%|▌         | 1/20 [00:25<08:04, 25.52s/it]
Task 3, Epoch 2/20 => Loss 0.647, Train_accy 64.85:   5%|▌         | 1/20 [00:43<08:04, 25.52s/it]                 
Task 3, Epoch 2/20 => Loss 0.647, Train_accy 64.85:  10%|█         | 2/20 [00:43<06:19, 21.06s/it]
Task 3, Epoch 3/20 => Loss 0.484, Train_accy 74.05:  10%|█         | 2/20 [01:01<06:19, 21.06s/it]
Task 3, Epoch 3/20 => Loss 0.484, Train_accy 74.05:  15%|█▌        | 3/20 [01:01<05:34, 19.68s/it]
Task 3, Epoch 4/20 => Loss 0.408, Train_accy 78.33:  15%|█▌        | 3/20 [01:19<05:34, 19.68s/it]
Task 3, Epoch 4/20 => Loss 0.408, Train_accy 78.33:  20%|██        | 4/20 [01:19<05:03, 18.98s/it]
Task 3, Epoch 5/20 => Loss 0.375, Train_accy 81.29:  20%|██        | 4/20 [01:37<05:03, 18.98s/it]
Task 3, Epoch 5/20 => Loss 0.375, Train_accy 81.29:  25%|██▌       | 5/20 [01:37<04:39, 18.61s/it]
Task 3, Epoch 6/20 => Loss 0.326, Train_accy 82.47, Test_accy 75.22:  25%|██▌       | 5/20 [02:02<04:39, 18.61s/it]
Task 3, Epoch 6/20 => Loss 0.326, Train_accy 82.47, Test_accy 75.22:  30%|███       | 6/20 [02:02<04:53, 20.97s/it]
Task 3, Epoch 7/20 => Loss 0.315, Train_accy 83.08:  30%|███       | 6/20 [02:20<04:53, 20.97s/it]                 
Task 3, Epoch 7/20 => Loss 0.315, Train_accy 83.08:  35%|███▌      | 7/20 [02:20<04:19, 19.97s/it]
Task 3, Epoch 8/20 => Loss 0.277, Train_accy 85.35:  35%|███▌      | 7/20 [02:39<04:19, 19.97s/it]
Task 3, Epoch 8/20 => Loss 0.277, Train_accy 85.35:  40%|████      | 8/20 [02:39<03:52, 19.41s/it]
Task 3, Epoch 9/20 => Loss 0.307, Train_accy 85.70:  40%|████      | 8/20 [02:57<03:52, 19.41s/it]
Task 3, Epoch 9/20 => Loss 0.307, Train_accy 85.70:  45%|████▌     | 9/20 [02:57<03:29, 19.04s/it]
Task 3, Epoch 10/20 => Loss 0.291, Train_accy 87.13:  45%|████▌     | 9/20 [03:15<03:29, 19.04s/it]
Task 3, Epoch 10/20 => Loss 0.291, Train_accy 87.13:  50%|█████     | 10/20 [03:15<03:06, 18.70s/it]
Task 3, Epoch 11/20 => Loss 0.273, Train_accy 86.00, Test_accy 71.62:  50%|█████     | 10/20 [03:41<03:06, 18.70s/it]
Task 3, Epoch 11/20 => Loss 0.273, Train_accy 86.00, Test_accy 71.62:  55%|█████▌    | 11/20 [03:41<03:07, 20.88s/it]
Task 3, Epoch 12/20 => Loss 0.246, Train_accy 87.22:  55%|█████▌    | 11/20 [03:59<03:07, 20.88s/it]                 
Task 3, Epoch 12/20 => Loss 0.246, Train_accy 87.22:  60%|██████    | 12/20 [03:59<02:40, 20.03s/it]
Task 3, Epoch 13/20 => Loss 0.241, Train_accy 88.88:  60%|██████    | 12/20 [04:16<02:40, 20.03s/it]
Task 3, Epoch 13/20 => Loss 0.241, Train_accy 88.88:  65%|██████▌   | 13/20 [04:16<02:15, 19.38s/it]
Task 3, Epoch 14/20 => Loss 0.219, Train_accy 89.23:  65%|██████▌   | 13/20 [04:34<02:15, 19.38s/it]
Task 3, Epoch 14/20 => Loss 0.219, Train_accy 89.23:  70%|███████   | 14/20 [04:34<01:53, 18.94s/it]
Task 3, Epoch 15/20 => Loss 0.231, Train_accy 89.05:  70%|███████   | 14/20 [04:52<01:53, 18.94s/it]
Task 3, Epoch 15/20 => Loss 0.231, Train_accy 89.05:  75%|███████▌  | 15/20 [04:52<01:33, 18.65s/it]
Task 3, Epoch 16/20 => Loss 0.236, Train_accy 89.05, Test_accy 73.22:  75%|███████▌  | 15/20 [05:18<01:33, 18.65s/it]
Task 3, Epoch 16/20 => Loss 0.236, Train_accy 89.05, Test_accy 73.22:  80%|████████  | 16/20 [05:18<01:22, 20.74s/it]
Task 3, Epoch 17/20 => Loss 0.240, Train_accy 88.75:  80%|████████  | 16/20 [05:36<01:22, 20.74s/it]                 
Task 3, Epoch 17/20 => Loss 0.240, Train_accy 88.75:  85%|████████▌ | 17/20 [05:36<00:59, 19.90s/it]
Task 3, Epoch 18/20 => Loss 0.212, Train_accy 89.97:  85%|████████▌ | 17/20 [05:54<00:59, 19.90s/it]
Task 3, Epoch 18/20 => Loss 0.212, Train_accy 89.97:  90%|█████████ | 18/20 [05:54<00:38, 19.31s/it]
Task 3, Epoch 19/20 => Loss 0.202, Train_accy 90.27:  90%|█████████ | 18/20 [06:12<00:38, 19.31s/it]
Task 3, Epoch 19/20 => Loss 0.202, Train_accy 90.27:  95%|█████████▌| 19/20 [06:12<00:18, 18.89s/it]
Task 3, Epoch 20/20 => Loss 0.212, Train_accy 89.80:  95%|█████████▌| 19/20 [06:30<00:18, 18.89s/it]
Task 3, Epoch 20/20 => Loss 0.212, Train_accy 89.80: 100%|██████████| 20/20 [06:30<00:00, 18.59s/it]
Task 3, Epoch 20/20 => Loss 0.212, Train_accy 89.80: 100%|██████████| 20/20 [06:30<00:00, 19.51s/it]
2024-09-07 10:14:18,055 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.212, Train_accy 89.80
2024-09-07 10:14:25,740 [trainer.py] => No NME accuracy.
2024-09-07 10:14:25,741 [trainer.py] => CNN: {'total': 72.06, '00-19': 60.38, '20-39': 72.31, '40-59': 72.61, '60-79': 85.29, 'old': 68.14, 'new': 85.29}
2024-09-07 10:14:25,741 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48, 72.06]
2024-09-07 10:14:25,741 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67, 89.91]

Average Accuracy (CNN): 81.74
2024-09-07 10:14:25,741 [trainer.py] => Average Accuracy (CNN): 81.74 

2024-09-07 10:14:25,742 [trainer.py] => All params: 85860176
2024-09-07 10:14:25,743 [trainer.py] => Trainable params: 85860176
2024-09-07 10:14:25,746 [finetune.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.633, Train_accy 28.14, Test_accy 68.41:   0%|          | 0/20 [00:26<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.633, Train_accy 28.14, Test_accy 68.41:   5%|▌         | 1/20 [00:26<08:15, 26.06s/it]
Task 4, Epoch 2/20 => Loss 0.680, Train_accy 59.91:   5%|▌         | 1/20 [00:43<08:15, 26.06s/it]                 
Task 4, Epoch 2/20 => Loss 0.680, Train_accy 59.91:  10%|█         | 2/20 [00:43<06:13, 20.76s/it]
Task 4, Epoch 3/20 => Loss 0.508, Train_accy 68.28:  10%|█         | 2/20 [01:00<06:13, 20.76s/it]
Task 4, Epoch 3/20 => Loss 0.508, Train_accy 68.28:  15%|█▌        | 3/20 [01:00<05:24, 19.07s/it]
Task 4, Epoch 4/20 => Loss 0.472, Train_accy 74.07:  15%|█▌        | 3/20 [01:17<05:24, 19.07s/it]
Task 4, Epoch 4/20 => Loss 0.472, Train_accy 74.07:  20%|██        | 4/20 [01:17<04:52, 18.25s/it]
Task 4, Epoch 5/20 => Loss 0.380, Train_accy 76.64:  20%|██        | 4/20 [01:34<04:52, 18.25s/it]
Task 4, Epoch 5/20 => Loss 0.380, Train_accy 76.64:  25%|██▌       | 5/20 [01:34<04:27, 17.82s/it]
Task 4, Epoch 6/20 => Loss 0.377, Train_accy 77.89, Test_accy 68.58:  25%|██▌       | 5/20 [02:00<04:27, 17.82s/it]
Task 4, Epoch 6/20 => Loss 0.377, Train_accy 77.89, Test_accy 68.58:  30%|███       | 6/20 [02:00<04:48, 20.64s/it]
Task 4, Epoch 7/20 => Loss 0.321, Train_accy 79.95:  30%|███       | 6/20 [02:17<04:48, 20.64s/it]                 
Task 4, Epoch 7/20 => Loss 0.321, Train_accy 79.95:  35%|███▌      | 7/20 [02:17<04:12, 19.45s/it]
Task 4, Epoch 8/20 => Loss 0.308, Train_accy 82.44:  35%|███▌      | 7/20 [02:34<04:12, 19.45s/it]
Task 4, Epoch 8/20 => Loss 0.308, Train_accy 82.44:  40%|████      | 8/20 [02:34<03:44, 18.71s/it]
Task 4, Epoch 9/20 => Loss 0.285, Train_accy 82.48:  40%|████      | 8/20 [02:51<03:44, 18.71s/it]
Task 4, Epoch 9/20 => Loss 0.285, Train_accy 82.48:  45%|████▌     | 9/20 [02:51<03:19, 18.17s/it]
Task 4, Epoch 10/20 => Loss 0.292, Train_accy 84.09:  45%|████▌     | 9/20 [03:08<03:19, 18.17s/it]
Task 4, Epoch 10/20 => Loss 0.292, Train_accy 84.09:  50%|█████     | 10/20 [03:08<02:58, 17.81s/it]
Task 4, Epoch 11/20 => Loss 0.261, Train_accy 84.37, Test_accy 69.41:  50%|█████     | 10/20 [03:34<02:58, 17.81s/it]
Task 4, Epoch 11/20 => Loss 0.261, Train_accy 84.37, Test_accy 69.41:  55%|█████▌    | 11/20 [03:34<03:02, 20.32s/it]
Task 4, Epoch 12/20 => Loss 0.259, Train_accy 84.32:  55%|█████▌    | 11/20 [03:51<03:02, 20.32s/it]                 
Task 4, Epoch 12/20 => Loss 0.259, Train_accy 84.32:  60%|██████    | 12/20 [03:51<02:34, 19.32s/it]
Task 4, Epoch 13/20 => Loss 0.230, Train_accy 85.38:  60%|██████    | 12/20 [04:08<02:34, 19.32s/it]
Task 4, Epoch 13/20 => Loss 0.230, Train_accy 85.38:  65%|██████▌   | 13/20 [04:08<02:10, 18.62s/it]
Task 4, Epoch 14/20 => Loss 0.235, Train_accy 86.16:  65%|██████▌   | 13/20 [04:25<02:10, 18.62s/it]
Task 4, Epoch 14/20 => Loss 0.235, Train_accy 86.16:  70%|███████   | 14/20 [04:25<01:48, 18.14s/it]
Task 4, Epoch 15/20 => Loss 0.241, Train_accy 86.25:  70%|███████   | 14/20 [04:42<01:48, 18.14s/it]
Task 4, Epoch 15/20 => Loss 0.241, Train_accy 86.25:  75%|███████▌  | 15/20 [04:42<01:28, 17.79s/it]
Task 4, Epoch 16/20 => Loss 0.223, Train_accy 86.16, Test_accy 67.57:  75%|███████▌  | 15/20 [05:08<01:28, 17.79s/it]
Task 4, Epoch 16/20 => Loss 0.223, Train_accy 86.16, Test_accy 67.57:  80%|████████  | 16/20 [05:08<01:21, 20.33s/it]
Task 4, Epoch 17/20 => Loss 0.211, Train_accy 86.39:  80%|████████  | 16/20 [05:25<01:21, 20.33s/it]                 
Task 4, Epoch 17/20 => Loss 0.211, Train_accy 86.39:  85%|████████▌ | 17/20 [05:25<00:58, 19.37s/it]
Task 4, Epoch 18/20 => Loss 0.201, Train_accy 87.13:  85%|████████▌ | 17/20 [05:42<00:58, 19.37s/it]
Task 4, Epoch 18/20 => Loss 0.201, Train_accy 87.13:  90%|█████████ | 18/20 [05:42<00:37, 18.68s/it]
Task 4, Epoch 19/20 => Loss 0.206, Train_accy 88.00:  90%|█████████ | 18/20 [06:00<00:37, 18.68s/it]
Task 4, Epoch 19/20 => Loss 0.206, Train_accy 88.00:  95%|█████████▌| 19/20 [06:00<00:18, 18.20s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 88.64:  95%|█████████▌| 19/20 [06:17<00:18, 18.20s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 88.64: 100%|██████████| 20/20 [06:17<00:00, 17.85s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 88.64: 100%|██████████| 20/20 [06:17<00:00, 18.85s/it]
2024-09-07 10:20:42,833 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.202, Train_accy 88.64
2024-09-07 10:20:51,943 [trainer.py] => No NME accuracy.
2024-09-07 10:20:51,944 [trainer.py] => CNN: {'total': 68.44, '00-19': 55.44, '20-39': 67.56, '40-59': 67.49, '60-79': 75.48, '80-99': 80.9, 'old': 66.01, 'new': 80.9}
2024-09-07 10:20:51,944 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48, 72.06, 68.44]
2024-09-07 10:20:51,944 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67, 89.91, 87.24]

Average Accuracy (CNN): 79.08
2024-09-07 10:20:51,944 [trainer.py] => Average Accuracy (CNN): 79.08 

2024-09-07 10:20:51,946 [trainer.py] => All params: 85875556
2024-09-07 10:20:51,947 [trainer.py] => Trainable params: 85875556
2024-09-07 10:20:51,951 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.402, Train_accy 36.59, Test_accy 66.15:   0%|          | 0/20 [00:31<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.402, Train_accy 36.59, Test_accy 66.15:   5%|▌         | 1/20 [00:31<10:02, 31.70s/it]
Task 5, Epoch 2/20 => Loss 0.552, Train_accy 68.03:   5%|▌         | 1/20 [00:52<10:02, 31.70s/it]                 
Task 5, Epoch 2/20 => Loss 0.552, Train_accy 68.03:  10%|█         | 2/20 [00:52<07:35, 25.29s/it]
Task 5, Epoch 3/20 => Loss 0.428, Train_accy 74.93:  10%|█         | 2/20 [01:13<07:35, 25.29s/it]
Task 5, Epoch 3/20 => Loss 0.428, Train_accy 74.93:  15%|█▌        | 3/20 [01:13<06:35, 23.24s/it]
Task 5, Epoch 4/20 => Loss 0.345, Train_accy 79.02:  15%|█▌        | 3/20 [01:34<06:35, 23.24s/it]
Task 5, Epoch 4/20 => Loss 0.345, Train_accy 79.02:  20%|██        | 4/20 [01:34<05:56, 22.26s/it]
Task 5, Epoch 5/20 => Loss 0.314, Train_accy 81.39:  20%|██        | 4/20 [01:54<05:56, 22.26s/it]
Task 5, Epoch 5/20 => Loss 0.314, Train_accy 81.39:  25%|██▌       | 5/20 [01:54<05:25, 21.72s/it]
Task 5, Epoch 6/20 => Loss 0.297, Train_accy 83.64, Test_accy 66.47:  25%|██▌       | 5/20 [02:26<05:25, 21.72s/it]
Task 5, Epoch 6/20 => Loss 0.297, Train_accy 83.64, Test_accy 66.47:  30%|███       | 6/20 [02:26<05:51, 25.13s/it]
Task 5, Epoch 7/20 => Loss 0.288, Train_accy 83.68:  30%|███       | 6/20 [02:47<05:51, 25.13s/it]                 
Task 5, Epoch 7/20 => Loss 0.288, Train_accy 83.68:  35%|███▌      | 7/20 [02:47<05:08, 23.74s/it]
Task 5, Epoch 8/20 => Loss 0.295, Train_accy 83.90:  35%|███▌      | 7/20 [03:08<05:08, 23.74s/it]
Task 5, Epoch 8/20 => Loss 0.295, Train_accy 83.90:  40%|████      | 8/20 [03:08<04:33, 22.77s/it]
Task 5, Epoch 9/20 => Loss 0.241, Train_accy 86.23:  40%|████      | 8/20 [03:28<04:33, 22.77s/it]
Task 5, Epoch 9/20 => Loss 0.241, Train_accy 86.23:  45%|████▌     | 9/20 [03:28<04:03, 22.11s/it]
Task 5, Epoch 10/20 => Loss 0.251, Train_accy 86.53:  45%|████▌     | 9/20 [03:49<04:03, 22.11s/it]
Task 5, Epoch 10/20 => Loss 0.251, Train_accy 86.53:  50%|█████     | 10/20 [03:49<03:37, 21.70s/it]
Task 5, Epoch 11/20 => Loss 0.231, Train_accy 87.47, Test_accy 65.46:  50%|█████     | 10/20 [04:21<03:37, 21.70s/it]
Task 5, Epoch 11/20 => Loss 0.231, Train_accy 87.47, Test_accy 65.46:  55%|█████▌    | 11/20 [04:21<03:42, 24.72s/it]
Task 5, Epoch 12/20 => Loss 0.221, Train_accy 87.58:  55%|█████▌    | 11/20 [04:41<03:42, 24.72s/it]                 
Task 5, Epoch 12/20 => Loss 0.221, Train_accy 87.58:  60%|██████    | 12/20 [04:41<03:08, 23.54s/it]
Task 5, Epoch 13/20 => Loss 0.232, Train_accy 88.59:  60%|██████    | 12/20 [05:02<03:08, 23.54s/it]
Task 5, Epoch 13/20 => Loss 0.232, Train_accy 88.59:  65%|██████▌   | 13/20 [05:02<02:38, 22.70s/it]
Task 5, Epoch 14/20 => Loss 0.217, Train_accy 89.49:  65%|██████▌   | 13/20 [05:23<02:38, 22.70s/it]
Task 5, Epoch 14/20 => Loss 0.217, Train_accy 89.49:  70%|███████   | 14/20 [05:23<02:12, 22.12s/it]
Task 5, Epoch 15/20 => Loss 0.201, Train_accy 89.42:  70%|███████   | 14/20 [05:44<02:12, 22.12s/it]
Task 5, Epoch 15/20 => Loss 0.201, Train_accy 89.42:  75%|███████▌  | 15/20 [05:44<01:48, 21.74s/it]
Task 5, Epoch 16/20 => Loss 0.198, Train_accy 90.69, Test_accy 64.77:  75%|███████▌  | 15/20 [06:16<01:48, 21.74s/it]
Task 5, Epoch 16/20 => Loss 0.198, Train_accy 90.69, Test_accy 64.77:  80%|████████  | 16/20 [06:16<01:39, 24.78s/it]
Task 5, Epoch 17/20 => Loss 0.220, Train_accy 89.53:  80%|████████  | 16/20 [06:37<01:39, 24.78s/it]                 
Task 5, Epoch 17/20 => Loss 0.220, Train_accy 89.53:  85%|████████▌ | 17/20 [06:37<01:10, 23.59s/it]
Task 5, Epoch 18/20 => Loss 0.186, Train_accy 90.54:  85%|████████▌ | 17/20 [06:57<01:10, 23.59s/it]
Task 5, Epoch 18/20 => Loss 0.186, Train_accy 90.54:  90%|█████████ | 18/20 [06:57<00:45, 22.72s/it]
Task 5, Epoch 19/20 => Loss 0.213, Train_accy 89.23:  90%|█████████ | 18/20 [07:18<00:45, 22.72s/it]
Task 5, Epoch 19/20 => Loss 0.213, Train_accy 89.23:  95%|█████████▌| 19/20 [07:18<00:22, 22.16s/it]
Task 5, Epoch 20/20 => Loss 0.206, Train_accy 90.17:  95%|█████████▌| 19/20 [07:39<00:22, 22.16s/it]
Task 5, Epoch 20/20 => Loss 0.206, Train_accy 90.17: 100%|██████████| 20/20 [07:39<00:00, 21.73s/it]
Task 5, Epoch 20/20 => Loss 0.206, Train_accy 90.17: 100%|██████████| 20/20 [07:39<00:00, 22.97s/it]
2024-09-07 10:28:31,303 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.206, Train_accy 90.17
2024-09-07 10:28:42,451 [trainer.py] => No NME accuracy.
2024-09-07 10:28:42,452 [trainer.py] => CNN: {'total': 63.95, '00-19': 43.69, '20-39': 56.17, '40-59': 63.37, '60-79': 65.67, '80-99': 69.2, '100-119': 87.73, 'old': 58.69, 'new': 87.73}
2024-09-07 10:28:42,452 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48, 72.06, 68.44, 63.95]
2024-09-07 10:28:42,452 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67, 89.91, 87.24, 85.57]

Average Accuracy (CNN): 76.56
2024-09-07 10:28:42,452 [trainer.py] => Average Accuracy (CNN): 76.56 

2024-09-07 10:28:42,454 [trainer.py] => All params: 85890936
2024-09-07 10:28:42,455 [trainer.py] => Trainable params: 85890936
2024-09-07 10:28:42,458 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.555, Train_accy 26.65, Test_accy 62.17:   0%|          | 0/20 [00:29<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.555, Train_accy 26.65, Test_accy 62.17:   5%|▌         | 1/20 [00:29<09:18, 29.38s/it]
Task 6, Epoch 2/20 => Loss 0.608, Train_accy 65.96:   5%|▌         | 1/20 [00:46<09:18, 29.38s/it]                 
Task 6, Epoch 2/20 => Loss 0.608, Train_accy 65.96:  10%|█         | 2/20 [00:46<06:33, 21.89s/it]
Task 6, Epoch 3/20 => Loss 0.452, Train_accy 72.32:  10%|█         | 2/20 [01:02<06:33, 21.89s/it]
Task 6, Epoch 3/20 => Loss 0.452, Train_accy 72.32:  15%|█▌        | 3/20 [01:02<05:31, 19.49s/it]
Task 6, Epoch 4/20 => Loss 0.387, Train_accy 77.12:  15%|█▌        | 3/20 [01:19<05:31, 19.49s/it]
Task 6, Epoch 4/20 => Loss 0.387, Train_accy 77.12:  20%|██        | 4/20 [01:19<04:53, 18.36s/it]
Task 6, Epoch 5/20 => Loss 0.364, Train_accy 79.80:  20%|██        | 4/20 [01:35<04:53, 18.36s/it]
Task 6, Epoch 5/20 => Loss 0.364, Train_accy 79.80:  25%|██▌       | 5/20 [01:35<04:26, 17.76s/it]
Task 6, Epoch 6/20 => Loss 0.311, Train_accy 81.36, Test_accy 63.57:  25%|██▌       | 5/20 [02:05<04:26, 17.76s/it]
Task 6, Epoch 6/20 => Loss 0.311, Train_accy 81.36, Test_accy 63.57:  30%|███       | 6/20 [02:05<05:03, 21.68s/it]
Task 6, Epoch 7/20 => Loss 0.267, Train_accy 82.58:  30%|███       | 6/20 [02:21<05:03, 21.68s/it]                 
Task 6, Epoch 7/20 => Loss 0.267, Train_accy 82.58:  35%|███▌      | 7/20 [02:21<04:20, 20.01s/it]
Task 6, Epoch 8/20 => Loss 0.230, Train_accy 86.39:  35%|███▌      | 7/20 [02:38<04:20, 20.01s/it]
Task 6, Epoch 8/20 => Loss 0.230, Train_accy 86.39:  40%|████      | 8/20 [02:38<03:47, 18.94s/it]
Task 6, Epoch 9/20 => Loss 0.268, Train_accy 84.79:  40%|████      | 8/20 [02:55<03:47, 18.94s/it]
Task 6, Epoch 9/20 => Loss 0.268, Train_accy 84.79:  45%|████▌     | 9/20 [02:55<03:20, 18.20s/it]
Task 6, Epoch 10/20 => Loss 0.223, Train_accy 86.77:  45%|████▌     | 9/20 [03:11<03:20, 18.20s/it]
Task 6, Epoch 10/20 => Loss 0.223, Train_accy 86.77:  50%|█████     | 10/20 [03:11<02:57, 17.71s/it]
Task 6, Epoch 11/20 => Loss 0.243, Train_accy 86.72, Test_accy 64.02:  50%|█████     | 10/20 [03:41<02:57, 17.71s/it]
Task 6, Epoch 11/20 => Loss 0.243, Train_accy 86.72, Test_accy 64.02:  55%|█████▌    | 11/20 [03:41<03:11, 21.30s/it]
Task 6, Epoch 12/20 => Loss 0.206, Train_accy 86.63:  55%|█████▌    | 11/20 [03:57<03:11, 21.30s/it]                 
Task 6, Epoch 12/20 => Loss 0.206, Train_accy 86.63:  60%|██████    | 12/20 [03:57<02:39, 19.88s/it]
Task 6, Epoch 13/20 => Loss 0.202, Train_accy 87.15:  60%|██████    | 12/20 [04:14<02:39, 19.88s/it]
Task 6, Epoch 13/20 => Loss 0.202, Train_accy 87.15:  65%|██████▌   | 13/20 [04:14<02:12, 18.88s/it]
Task 6, Epoch 14/20 => Loss 0.212, Train_accy 87.76:  65%|██████▌   | 13/20 [04:30<02:12, 18.88s/it]
Task 6, Epoch 14/20 => Loss 0.212, Train_accy 87.76:  70%|███████   | 14/20 [04:30<01:49, 18.19s/it]
Task 6, Epoch 15/20 => Loss 0.207, Train_accy 88.47:  70%|███████   | 14/20 [04:47<01:49, 18.19s/it]
Task 6, Epoch 15/20 => Loss 0.207, Train_accy 88.47:  75%|███████▌  | 15/20 [04:47<01:28, 17.77s/it]
Task 6, Epoch 16/20 => Loss 0.193, Train_accy 88.70, Test_accy 61.60:  75%|███████▌  | 15/20 [05:16<01:28, 17.77s/it]
Task 6, Epoch 16/20 => Loss 0.193, Train_accy 88.70, Test_accy 61.60:  80%|████████  | 16/20 [05:16<01:24, 21.22s/it]
Task 6, Epoch 17/20 => Loss 0.179, Train_accy 90.02:  80%|████████  | 16/20 [05:33<01:24, 21.22s/it]                 
Task 6, Epoch 17/20 => Loss 0.179, Train_accy 90.02:  85%|████████▌ | 17/20 [05:33<00:59, 19.86s/it]
Task 6, Epoch 18/20 => Loss 0.188, Train_accy 90.35:  85%|████████▌ | 17/20 [05:50<00:59, 19.86s/it]
Task 6, Epoch 18/20 => Loss 0.188, Train_accy 90.35:  90%|█████████ | 18/20 [05:50<00:37, 18.88s/it]
Task 6, Epoch 19/20 => Loss 0.195, Train_accy 90.25:  90%|█████████ | 18/20 [06:06<00:37, 18.88s/it]
Task 6, Epoch 19/20 => Loss 0.195, Train_accy 90.25:  95%|█████████▌| 19/20 [06:06<00:18, 18.18s/it]
Task 6, Epoch 20/20 => Loss 0.141, Train_accy 91.15:  95%|█████████▌| 19/20 [06:23<00:18, 18.18s/it]
Task 6, Epoch 20/20 => Loss 0.141, Train_accy 91.15: 100%|██████████| 20/20 [06:23<00:00, 17.69s/it]
Task 6, Epoch 20/20 => Loss 0.141, Train_accy 91.15: 100%|██████████| 20/20 [06:23<00:00, 19.17s/it]
2024-09-07 10:35:05,811 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.141, Train_accy 91.15
2024-09-07 10:35:18,579 [trainer.py] => No NME accuracy.
2024-09-07 10:35:18,580 [trainer.py] => CNN: {'total': 60.63, '00-19': 40.35, '20-39': 51.9, '40-59': 55.61, '60-79': 54.64, '80-99': 63.86, '100-119': 77.88, '120-139': 83.48, 'old': 57.06, 'new': 83.48}
2024-09-07 10:35:18,580 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48, 72.06, 68.44, 63.95, 60.63]
2024-09-07 10:35:18,580 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67, 89.91, 87.24, 85.57, 82.3]

Average Accuracy (CNN): 74.28
2024-09-07 10:35:18,580 [trainer.py] => Average Accuracy (CNN): 74.28 

2024-09-07 10:35:18,581 [trainer.py] => All params: 85906316
2024-09-07 10:35:18,582 [trainer.py] => Trainable params: 85906316
2024-09-07 10:35:18,587 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.414, Train_accy 33.10, Test_accy 57.78:   0%|          | 0/20 [00:36<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.414, Train_accy 33.10, Test_accy 57.78:   5%|▌         | 1/20 [00:36<11:41, 36.89s/it]
Task 7, Epoch 2/20 => Loss 0.558, Train_accy 64.42:   5%|▌         | 1/20 [00:58<11:41, 36.89s/it]                 
Task 7, Epoch 2/20 => Loss 0.558, Train_accy 64.42:  10%|█         | 2/20 [00:58<08:26, 28.11s/it]
Task 7, Epoch 3/20 => Loss 0.419, Train_accy 71.95:  10%|█         | 2/20 [01:20<08:26, 28.11s/it]
Task 7, Epoch 3/20 => Loss 0.419, Train_accy 71.95:  15%|█▌        | 3/20 [01:20<07:09, 25.27s/it]
Task 7, Epoch 4/20 => Loss 0.351, Train_accy 74.96:  15%|█▌        | 3/20 [01:42<07:09, 25.27s/it]
Task 7, Epoch 4/20 => Loss 0.351, Train_accy 74.96:  20%|██        | 4/20 [01:42<06:22, 23.94s/it]
Task 7, Epoch 5/20 => Loss 0.302, Train_accy 79.15:  20%|██        | 4/20 [02:04<06:22, 23.94s/it]
Task 7, Epoch 5/20 => Loss 0.302, Train_accy 79.15:  25%|██▌       | 5/20 [02:04<05:48, 23.24s/it]
Task 7, Epoch 6/20 => Loss 0.322, Train_accy 79.44, Test_accy 61.38:  25%|██▌       | 5/20 [02:41<05:48, 23.24s/it]
Task 7, Epoch 6/20 => Loss 0.322, Train_accy 79.44, Test_accy 61.38:  30%|███       | 6/20 [02:41<06:29, 27.84s/it]
Task 7, Epoch 7/20 => Loss 0.259, Train_accy 82.39:  30%|███       | 6/20 [03:03<06:29, 27.84s/it]                 
Task 7, Epoch 7/20 => Loss 0.259, Train_accy 82.39:  35%|███▌      | 7/20 [03:03<05:36, 25.90s/it]
Task 7, Epoch 8/20 => Loss 0.276, Train_accy 84.16:  35%|███▌      | 7/20 [03:25<05:36, 25.90s/it]
Task 7, Epoch 8/20 => Loss 0.276, Train_accy 84.16:  40%|████      | 8/20 [03:25<04:55, 24.60s/it]
Task 7, Epoch 9/20 => Loss 0.232, Train_accy 85.23:  40%|████      | 8/20 [03:47<04:55, 24.60s/it]
Task 7, Epoch 9/20 => Loss 0.232, Train_accy 85.23:  45%|████▌     | 9/20 [03:47<04:21, 23.78s/it]
Task 7, Epoch 10/20 => Loss 0.268, Train_accy 84.34:  45%|████▌     | 9/20 [04:09<04:21, 23.78s/it]
Task 7, Epoch 10/20 => Loss 0.268, Train_accy 84.34:  50%|█████     | 10/20 [04:09<03:52, 23.22s/it]
Task 7, Epoch 11/20 => Loss 0.235, Train_accy 86.15, Test_accy 60.45:  50%|█████     | 10/20 [04:45<03:52, 23.22s/it]
Task 7, Epoch 11/20 => Loss 0.235, Train_accy 86.15, Test_accy 60.45:  55%|█████▌    | 11/20 [04:45<04:06, 27.39s/it]
Task 7, Epoch 12/20 => Loss 0.244, Train_accy 85.58:  55%|█████▌    | 11/20 [05:07<04:06, 27.39s/it]                 
Task 7, Epoch 12/20 => Loss 0.244, Train_accy 85.58:  60%|██████    | 12/20 [05:07<03:25, 25.69s/it]
Task 7, Epoch 13/20 => Loss 0.212, Train_accy 87.96:  60%|██████    | 12/20 [05:29<03:25, 25.69s/it]
Task 7, Epoch 13/20 => Loss 0.212, Train_accy 87.96:  65%|██████▌   | 13/20 [05:29<02:52, 24.58s/it]
Task 7, Epoch 14/20 => Loss 0.210, Train_accy 88.07:  65%|██████▌   | 13/20 [05:51<02:52, 24.58s/it]
Task 7, Epoch 14/20 => Loss 0.210, Train_accy 88.07:  70%|███████   | 14/20 [05:51<02:22, 23.78s/it]
Task 7, Epoch 15/20 => Loss 0.221, Train_accy 87.89:  70%|███████   | 14/20 [06:13<02:22, 23.78s/it]
Task 7, Epoch 15/20 => Loss 0.221, Train_accy 87.89:  75%|███████▌  | 15/20 [06:13<01:56, 23.32s/it]
Task 7, Epoch 16/20 => Loss 0.200, Train_accy 88.57, Test_accy 59.90:  75%|███████▌  | 15/20 [06:50<01:56, 23.32s/it]
Task 7, Epoch 16/20 => Loss 0.200, Train_accy 88.57, Test_accy 59.90:  80%|████████  | 16/20 [06:50<01:49, 27.35s/it]
Task 7, Epoch 17/20 => Loss 0.220, Train_accy 89.17:  80%|████████  | 16/20 [07:12<01:49, 27.35s/it]                 
Task 7, Epoch 17/20 => Loss 0.220, Train_accy 89.17:  85%|████████▌ | 17/20 [07:12<01:17, 25.73s/it]
Task 7, Epoch 18/20 => Loss 0.187, Train_accy 89.56:  85%|████████▌ | 17/20 [07:34<01:17, 25.73s/it]
Task 7, Epoch 18/20 => Loss 0.187, Train_accy 89.56:  90%|█████████ | 18/20 [07:34<00:49, 24.58s/it]
Task 7, Epoch 19/20 => Loss 0.181, Train_accy 89.63:  90%|█████████ | 18/20 [07:56<00:49, 24.58s/it]
Task 7, Epoch 19/20 => Loss 0.181, Train_accy 89.63:  95%|█████████▌| 19/20 [07:56<00:23, 23.84s/it]
Task 7, Epoch 20/20 => Loss 0.174, Train_accy 90.09:  95%|█████████▌| 19/20 [08:18<00:23, 23.84s/it]
Task 7, Epoch 20/20 => Loss 0.174, Train_accy 90.09: 100%|██████████| 20/20 [08:18<00:00, 23.26s/it]
Task 7, Epoch 20/20 => Loss 0.174, Train_accy 90.09: 100%|██████████| 20/20 [08:18<00:00, 24.93s/it]
2024-09-07 10:43:37,158 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.174, Train_accy 90.09
2024-09-07 10:43:51,927 [trainer.py] => No NME accuracy.
2024-09-07 10:43:51,928 [trainer.py] => CNN: {'total': 58.83, '00-19': 32.8, '20-39': 44.78, '40-59': 51.98, '60-79': 52.54, '80-99': 54.21, '100-119': 68.64, '120-139': 74.69, '140-159': 88.07, 'old': 53.77, 'new': 88.07}
2024-09-07 10:43:51,928 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48, 72.06, 68.44, 63.95, 60.63, 58.83]
2024-09-07 10:43:51,928 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67, 89.91, 87.24, 85.57, 82.3, 80.96]

Average Accuracy (CNN): 72.35
2024-09-07 10:43:51,928 [trainer.py] => Average Accuracy (CNN): 72.35 

2024-09-07 10:43:51,929 [trainer.py] => All params: 85921696
2024-09-07 10:43:51,930 [trainer.py] => Trainable params: 85921696
2024-09-07 10:43:51,933 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.829, Train_accy 18.94, Test_accy 57.83:   0%|          | 0/20 [00:31<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.829, Train_accy 18.94, Test_accy 57.83:   5%|▌         | 1/20 [00:31<09:57, 31.46s/it]
Task 8, Epoch 2/20 => Loss 0.690, Train_accy 59.65:   5%|▌         | 1/20 [00:46<09:57, 31.46s/it]                 
Task 8, Epoch 2/20 => Loss 0.690, Train_accy 59.65:  10%|█         | 2/20 [00:46<06:34, 21.94s/it]
Task 8, Epoch 3/20 => Loss 0.552, Train_accy 68.38:  10%|█         | 2/20 [01:01<06:34, 21.94s/it]
Task 8, Epoch 3/20 => Loss 0.552, Train_accy 68.38:  15%|█▌        | 3/20 [01:01<05:21, 18.89s/it]
Task 8, Epoch 4/20 => Loss 0.468, Train_accy 72.43:  15%|█▌        | 3/20 [01:17<05:21, 18.89s/it]
Task 8, Epoch 4/20 => Loss 0.468, Train_accy 72.43:  20%|██        | 4/20 [01:17<04:39, 17.49s/it]
Task 8, Epoch 5/20 => Loss 0.420, Train_accy 75.77:  20%|██        | 4/20 [01:32<04:39, 17.49s/it]
Task 8, Epoch 5/20 => Loss 0.420, Train_accy 75.77:  25%|██▌       | 5/20 [01:32<04:10, 16.72s/it]
Task 8, Epoch 6/20 => Loss 0.382, Train_accy 78.18, Test_accy 57.30:  25%|██▌       | 5/20 [02:04<04:10, 16.72s/it]
Task 8, Epoch 6/20 => Loss 0.382, Train_accy 78.18, Test_accy 57.30:  30%|███       | 6/20 [02:04<05:05, 21.82s/it]
Task 8, Epoch 7/20 => Loss 0.385, Train_accy 78.49:  30%|███       | 6/20 [02:19<05:05, 21.82s/it]                 
Task 8, Epoch 7/20 => Loss 0.385, Train_accy 78.49:  35%|███▌      | 7/20 [02:19<04:16, 19.69s/it]
Task 8, Epoch 8/20 => Loss 0.289, Train_accy 80.70:  35%|███▌      | 7/20 [02:35<04:16, 19.69s/it]
Task 8, Epoch 8/20 => Loss 0.289, Train_accy 80.70:  40%|████      | 8/20 [02:35<03:39, 18.29s/it]
Task 8, Epoch 9/20 => Loss 0.285, Train_accy 82.60:  40%|████      | 8/20 [02:50<03:39, 18.29s/it]
Task 8, Epoch 9/20 => Loss 0.285, Train_accy 82.60:  45%|████▌     | 9/20 [02:50<03:10, 17.36s/it]
Task 8, Epoch 10/20 => Loss 0.264, Train_accy 83.57:  45%|████▌     | 9/20 [03:05<03:10, 17.36s/it]
Task 8, Epoch 10/20 => Loss 0.264, Train_accy 83.57:  50%|█████     | 10/20 [03:05<02:47, 16.75s/it]
Task 8, Epoch 11/20 => Loss 0.281, Train_accy 84.39, Test_accy 58.05:  50%|█████     | 10/20 [03:37<02:47, 16.75s/it]
Task 8, Epoch 11/20 => Loss 0.281, Train_accy 84.39, Test_accy 58.05:  55%|█████▌    | 11/20 [03:37<03:11, 21.31s/it]
Task 8, Epoch 12/20 => Loss 0.232, Train_accy 86.34:  55%|█████▌    | 11/20 [03:52<03:11, 21.31s/it]                 
Task 8, Epoch 12/20 => Loss 0.232, Train_accy 86.34:  60%|██████    | 12/20 [03:52<02:35, 19.48s/it]
Task 8, Epoch 13/20 => Loss 0.277, Train_accy 84.29:  60%|██████    | 12/20 [04:08<02:35, 19.48s/it]
Task 8, Epoch 13/20 => Loss 0.277, Train_accy 84.29:  65%|██████▌   | 13/20 [04:08<02:07, 18.24s/it]
Task 8, Epoch 14/20 => Loss 0.253, Train_accy 87.06:  65%|██████▌   | 13/20 [04:23<02:07, 18.24s/it]
Task 8, Epoch 14/20 => Loss 0.253, Train_accy 87.06:  70%|███████   | 14/20 [04:23<01:44, 17.36s/it]
Task 8, Epoch 15/20 => Loss 0.268, Train_accy 86.50:  70%|███████   | 14/20 [04:38<01:44, 17.36s/it]
Task 8, Epoch 15/20 => Loss 0.268, Train_accy 86.50:  75%|███████▌  | 15/20 [04:38<01:23, 16.76s/it]
Task 8, Epoch 16/20 => Loss 0.201, Train_accy 88.40, Test_accy 56.50:  75%|███████▌  | 15/20 [05:10<01:23, 16.76s/it]
Task 8, Epoch 16/20 => Loss 0.201, Train_accy 88.40, Test_accy 56.50:  80%|████████  | 16/20 [05:10<01:24, 21.24s/it]
Task 8, Epoch 17/20 => Loss 0.243, Train_accy 86.19:  80%|████████  | 16/20 [05:25<01:24, 21.24s/it]                 
Task 8, Epoch 17/20 => Loss 0.243, Train_accy 86.19:  85%|████████▌ | 17/20 [05:25<00:58, 19.45s/it]
Task 8, Epoch 18/20 => Loss 0.236, Train_accy 86.29:  85%|████████▌ | 17/20 [05:41<00:58, 19.45s/it]
Task 8, Epoch 18/20 => Loss 0.236, Train_accy 86.29:  90%|█████████ | 18/20 [05:41<00:36, 18.22s/it]
Task 8, Epoch 19/20 => Loss 0.229, Train_accy 87.78:  90%|█████████ | 18/20 [05:56<00:36, 18.22s/it]
Task 8, Epoch 19/20 => Loss 0.229, Train_accy 87.78:  95%|█████████▌| 19/20 [05:56<00:17, 17.33s/it]
Task 8, Epoch 20/20 => Loss 0.198, Train_accy 87.89:  95%|█████████▌| 19/20 [06:11<00:17, 17.33s/it]
Task 8, Epoch 20/20 => Loss 0.198, Train_accy 87.89: 100%|██████████| 20/20 [06:11<00:00, 16.72s/it]
Task 8, Epoch 20/20 => Loss 0.198, Train_accy 87.89: 100%|██████████| 20/20 [06:11<00:00, 18.58s/it]
2024-09-07 10:50:03,518 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.198, Train_accy 87.89
2024-09-07 10:50:19,670 [trainer.py] => No NME accuracy.
2024-09-07 10:50:19,671 [trainer.py] => CNN: {'total': 56.78, '00-19': 30.62, '20-39': 44.94, '40-59': 46.04, '60-79': 49.74, '80-99': 48.46, '100-119': 63.64, '120-139': 68.89, '140-159': 79.84, '160-179': 81.59, 'old': 54.38, 'new': 81.59}
2024-09-07 10:50:19,671 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48, 72.06, 68.44, 63.95, 60.63, 58.83, 56.78]
2024-09-07 10:50:19,671 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67, 89.91, 87.24, 85.57, 82.3, 80.96, 78.29]

Average Accuracy (CNN): 70.62
2024-09-07 10:50:19,671 [trainer.py] => Average Accuracy (CNN): 70.62 

2024-09-07 10:50:19,673 [trainer.py] => All params: 85937076
2024-09-07 10:50:19,674 [trainer.py] => Trainable params: 85937076
2024-09-07 10:50:19,678 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.457, Train_accy 23.57, Test_accy 55.17:   0%|          | 0/20 [00:35<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.457, Train_accy 23.57, Test_accy 55.17:   5%|▌         | 1/20 [00:35<11:20, 35.82s/it]
Task 9, Epoch 2/20 => Loss 0.597, Train_accy 60.26:   5%|▌         | 1/20 [00:53<11:20, 35.82s/it]                 
Task 9, Epoch 2/20 => Loss 0.597, Train_accy 60.26:  10%|█         | 2/20 [00:53<07:33, 25.18s/it]
Task 9, Epoch 3/20 => Loss 0.402, Train_accy 68.37:  10%|█         | 2/20 [01:11<07:33, 25.18s/it]
Task 9, Epoch 3/20 => Loss 0.402, Train_accy 68.37:  15%|█▌        | 3/20 [01:11<06:10, 21.79s/it]
Task 9, Epoch 4/20 => Loss 0.347, Train_accy 73.48:  15%|█▌        | 3/20 [01:29<06:10, 21.79s/it]
Task 9, Epoch 4/20 => Loss 0.347, Train_accy 73.48:  20%|██        | 4/20 [01:29<05:23, 20.23s/it]
Task 9, Epoch 5/20 => Loss 0.313, Train_accy 75.90:  20%|██        | 4/20 [01:46<05:23, 20.23s/it]
Task 9, Epoch 5/20 => Loss 0.313, Train_accy 75.90:  25%|██▌       | 5/20 [01:46<04:49, 19.31s/it]
Task 9, Epoch 6/20 => Loss 0.284, Train_accy 78.06, Test_accy 57.72:  25%|██▌       | 5/20 [02:22<04:49, 19.31s/it]
Task 9, Epoch 6/20 => Loss 0.284, Train_accy 78.06, Test_accy 57.72:  30%|███       | 6/20 [02:22<05:48, 24.92s/it]
Task 9, Epoch 7/20 => Loss 0.262, Train_accy 79.96:  30%|███       | 6/20 [02:40<05:48, 24.92s/it]                 
Task 9, Epoch 7/20 => Loss 0.262, Train_accy 79.96:  35%|███▌      | 7/20 [02:40<04:53, 22.60s/it]
Task 9, Epoch 8/20 => Loss 0.271, Train_accy 80.57:  35%|███▌      | 7/20 [02:58<04:53, 22.60s/it]
Task 9, Epoch 8/20 => Loss 0.271, Train_accy 80.57:  40%|████      | 8/20 [02:58<04:12, 21.06s/it]
Task 9, Epoch 9/20 => Loss 0.232, Train_accy 82.78:  40%|████      | 8/20 [03:15<04:12, 21.06s/it]
Task 9, Epoch 9/20 => Loss 0.232, Train_accy 82.78:  45%|████▌     | 9/20 [03:15<03:40, 20.02s/it]
Task 9, Epoch 10/20 => Loss 0.240, Train_accy 82.60:  45%|████▌     | 9/20 [03:33<03:40, 20.02s/it]
Task 9, Epoch 10/20 => Loss 0.240, Train_accy 82.60:  50%|█████     | 10/20 [03:33<03:13, 19.31s/it]
Task 9, Epoch 11/20 => Loss 0.232, Train_accy 83.44, Test_accy 55.70:  50%|█████     | 10/20 [04:09<03:13, 19.31s/it]
Task 9, Epoch 11/20 => Loss 0.232, Train_accy 83.44, Test_accy 55.70:  55%|█████▌    | 11/20 [04:09<03:39, 24.36s/it]
Task 9, Epoch 12/20 => Loss 0.238, Train_accy 84.27:  55%|█████▌    | 11/20 [04:27<03:39, 24.36s/it]                 
Task 9, Epoch 12/20 => Loss 0.238, Train_accy 84.27:  60%|██████    | 12/20 [04:27<02:59, 22.39s/it]
Task 9, Epoch 13/20 => Loss 0.195, Train_accy 86.92:  60%|██████    | 12/20 [04:45<02:59, 22.39s/it]
Task 9, Epoch 13/20 => Loss 0.195, Train_accy 86.92:  65%|██████▌   | 13/20 [04:45<02:26, 20.99s/it]
Task 9, Epoch 14/20 => Loss 0.211, Train_accy 85.07:  65%|██████▌   | 13/20 [05:02<02:26, 20.99s/it]
Task 9, Epoch 14/20 => Loss 0.211, Train_accy 85.07:  70%|███████   | 14/20 [05:02<01:59, 20.00s/it]
Task 9, Epoch 15/20 => Loss 0.206, Train_accy 85.07:  70%|███████   | 14/20 [05:20<01:59, 20.00s/it]
Task 9, Epoch 15/20 => Loss 0.206, Train_accy 85.07:  75%|███████▌  | 15/20 [05:20<01:36, 19.32s/it]
Task 9, Epoch 16/20 => Loss 0.188, Train_accy 86.96, Test_accy 55.73:  75%|███████▌  | 15/20 [05:56<01:36, 19.32s/it]
Task 9, Epoch 16/20 => Loss 0.188, Train_accy 86.96, Test_accy 55.73:  80%|████████  | 16/20 [05:56<01:37, 24.27s/it]
Task 9, Epoch 17/20 => Loss 0.194, Train_accy 87.09:  80%|████████  | 16/20 [06:14<01:37, 24.27s/it]                 
Task 9, Epoch 17/20 => Loss 0.194, Train_accy 87.09:  85%|████████▌ | 17/20 [06:14<01:06, 22.33s/it]
Task 9, Epoch 18/20 => Loss 0.188, Train_accy 87.31:  85%|████████▌ | 17/20 [06:31<01:06, 22.33s/it]
Task 9, Epoch 18/20 => Loss 0.188, Train_accy 87.31:  90%|█████████ | 18/20 [06:31<00:41, 20.96s/it]
Task 9, Epoch 19/20 => Loss 0.165, Train_accy 88.19:  90%|█████████ | 18/20 [06:49<00:41, 20.96s/it]
Task 9, Epoch 19/20 => Loss 0.165, Train_accy 88.19:  95%|█████████▌| 19/20 [06:49<00:19, 20.00s/it]
Task 9, Epoch 20/20 => Loss 0.150, Train_accy 88.99:  95%|█████████▌| 19/20 [07:07<00:19, 20.00s/it]
Task 9, Epoch 20/20 => Loss 0.150, Train_accy 88.99: 100%|██████████| 20/20 [07:07<00:00, 19.33s/it]
Task 9, Epoch 20/20 => Loss 0.150, Train_accy 88.99: 100%|██████████| 20/20 [07:07<00:00, 21.37s/it]
2024-09-07 10:57:27,179 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.150, Train_accy 88.99
2024-09-07 10:57:44,794 [trainer.py] => No NME accuracy.
2024-09-07 10:57:44,795 [trainer.py] => CNN: {'total': 54.07, '00-19': 31.64, '20-39': 39.56, '40-59': 37.46, '60-79': 44.48, '80-99': 42.3, '100-119': 58.03, '120-139': 60.98, '140-159': 72.98, '160-179': 70.5, '180-199': 84.63, 'old': 50.8, 'new': 84.63}
2024-09-07 10:57:44,795 [trainer.py] => CNN top1 curve: [93.32, 84.1, 77.48, 72.06, 68.44, 63.95, 60.63, 58.83, 56.78, 54.07]
2024-09-07 10:57:44,795 [trainer.py] => CNN top5 curve: [99.13, 95.91, 93.67, 89.91, 87.24, 85.57, 82.3, 80.96, 78.29, 77.72]

Average Accuracy (CNN): 68.97
2024-09-07 10:57:44,795 [trainer.py] => Average Accuracy (CNN): 68.97 

Accuracy Matrix (CNN):
[[93.32 77.94 70.1  60.38 55.44 43.69 40.35 32.8  30.62 31.64]
 [ 0.   90.82 79.27 72.31 67.56 56.17 51.9  44.78 44.94 39.56]
 [ 0.    0.   83.99 72.61 67.49 63.37 55.61 51.98 46.04 37.46]
 [ 0.    0.    0.   85.29 75.48 65.67 54.64 52.54 49.74 44.48]
 [ 0.    0.    0.    0.   80.9  69.2  63.86 54.21 48.46 42.3 ]
 [ 0.    0.    0.    0.    0.   87.73 77.88 68.64 63.64 58.03]
 [ 0.    0.    0.    0.    0.    0.   83.48 74.69 68.89 60.98]
 [ 0.    0.    0.    0.    0.    0.    0.   88.07 79.84 72.98]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   81.59 70.5 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   84.63]]
2024-09-07 10:57:44,797 [trainer.py] => Forgetting (CNN): 35.25111111111111
2024-09-07 10:57:47,584 [trainer.py] => config: ./exps/finetune_inr_B0_Inc20.json
2024-09-07 10:57:47,584 [trainer.py] => prefix: reproduce
2024-09-07 10:57:47,585 [trainer.py] => dataset: imagenetr
2024-09-07 10:57:47,585 [trainer.py] => memory_size: 0
2024-09-07 10:57:47,585 [trainer.py] => memory_per_class: 0
2024-09-07 10:57:47,585 [trainer.py] => fixed_memory: False
2024-09-07 10:57:47,585 [trainer.py] => shuffle: True
2024-09-07 10:57:47,585 [trainer.py] => init_cls: 10
2024-09-07 10:57:47,585 [trainer.py] => increment: 10
2024-09-07 10:57:47,585 [trainer.py] => model_name: finetune
2024-09-07 10:57:47,585 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 10:57:47,585 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 10:57:47,585 [trainer.py] => seed: 1993
2024-09-07 10:57:47,585 [trainer.py] => init_epoch: 20
2024-09-07 10:57:47,585 [trainer.py] => init_lr: 0.001
2024-09-07 10:57:47,585 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 10:57:47,585 [trainer.py] => init_lr_decay: 0.1
2024-09-07 10:57:47,585 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 10:57:47,585 [trainer.py] => epochs: 20
2024-09-07 10:57:47,585 [trainer.py] => lrate: 0.001
2024-09-07 10:57:47,585 [trainer.py] => milestones: [40, 70]
2024-09-07 10:57:47,585 [trainer.py] => lrate_decay: 0.1
2024-09-07 10:57:47,585 [trainer.py] => batch_size: 48
2024-09-07 10:57:47,585 [trainer.py] => weight_decay: 0.0002
2024-09-07 10:57:47,668 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 10:57:49,463 [trainer.py] => All params: 85798656
2024-09-07 10:57:49,463 [trainer.py] => Trainable params: 85798656
2024-09-07 10:57:49,464 [finetune.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.854, Train_accy 41.43, Test_accy 79.50:   0%|          | 0/20 [00:11<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.854, Train_accy 41.43, Test_accy 79.50:   5%|▌         | 1/20 [00:11<03:43, 11.77s/it]
Task 0, Epoch 2/20 => Loss 0.608, Train_accy 80.92:   5%|▌         | 1/20 [00:22<03:43, 11.77s/it]                 
Task 0, Epoch 2/20 => Loss 0.608, Train_accy 80.92:  10%|█         | 2/20 [00:22<03:15, 10.89s/it]
Task 0, Epoch 3/20 => Loss 0.382, Train_accy 88.60:  10%|█         | 2/20 [00:32<03:15, 10.89s/it]
Task 0, Epoch 3/20 => Loss 0.382, Train_accy 88.60:  15%|█▌        | 3/20 [00:32<02:59, 10.57s/it]
Task 0, Epoch 4/20 => Loss 0.302, Train_accy 90.30:  15%|█▌        | 3/20 [00:42<02:59, 10.57s/it]
Task 0, Epoch 4/20 => Loss 0.302, Train_accy 90.30:  20%|██        | 4/20 [00:42<02:46, 10.40s/it]
Task 0, Epoch 5/20 => Loss 0.310, Train_accy 90.15:  20%|██        | 4/20 [00:52<02:46, 10.40s/it]
Task 0, Epoch 5/20 => Loss 0.310, Train_accy 90.15:  25%|██▌       | 5/20 [00:52<02:34, 10.30s/it]
Task 0, Epoch 6/20 => Loss 0.248, Train_accy 91.85, Test_accy 93.69:  25%|██▌       | 5/20 [01:03<02:34, 10.30s/it]
Task 0, Epoch 6/20 => Loss 0.248, Train_accy 91.85, Test_accy 93.69:  30%|███       | 6/20 [01:03<02:29, 10.70s/it]
Task 0, Epoch 7/20 => Loss 0.232, Train_accy 92.94:  30%|███       | 6/20 [01:14<02:29, 10.70s/it]                 
Task 0, Epoch 7/20 => Loss 0.232, Train_accy 92.94:  35%|███▌      | 7/20 [01:14<02:16, 10.53s/it]
Task 0, Epoch 8/20 => Loss 0.212, Train_accy 93.17:  35%|███▌      | 7/20 [01:24<02:16, 10.53s/it]
Task 0, Epoch 8/20 => Loss 0.212, Train_accy 93.17:  40%|████      | 8/20 [01:24<02:05, 10.45s/it]
Task 0, Epoch 9/20 => Loss 0.176, Train_accy 94.34:  40%|████      | 8/20 [01:34<02:05, 10.45s/it]
Task 0, Epoch 9/20 => Loss 0.176, Train_accy 94.34:  45%|████▌     | 9/20 [01:34<01:53, 10.36s/it]
Task 0, Epoch 10/20 => Loss 0.165, Train_accy 93.95:  45%|████▌     | 9/20 [01:44<01:53, 10.36s/it]
Task 0, Epoch 10/20 => Loss 0.165, Train_accy 93.95:  50%|█████     | 10/20 [01:44<01:43, 10.31s/it]
Task 0, Epoch 11/20 => Loss 0.195, Train_accy 94.49, Test_accy 96.21:  50%|█████     | 10/20 [01:56<01:43, 10.31s/it]
Task 0, Epoch 11/20 => Loss 0.195, Train_accy 94.49, Test_accy 96.21:  55%|█████▌    | 11/20 [01:56<01:36, 10.74s/it]
Task 0, Epoch 12/20 => Loss 0.167, Train_accy 94.72:  55%|█████▌    | 11/20 [02:06<01:36, 10.74s/it]                 
Task 0, Epoch 12/20 => Loss 0.167, Train_accy 94.72:  60%|██████    | 12/20 [02:06<01:24, 10.56s/it]
Task 0, Epoch 13/20 => Loss 0.163, Train_accy 94.49:  60%|██████    | 12/20 [02:16<01:24, 10.56s/it]
Task 0, Epoch 13/20 => Loss 0.163, Train_accy 94.49:  65%|██████▌   | 13/20 [02:16<01:13, 10.46s/it]
Task 0, Epoch 14/20 => Loss 0.176, Train_accy 94.80:  65%|██████▌   | 13/20 [02:27<01:13, 10.46s/it]
Task 0, Epoch 14/20 => Loss 0.176, Train_accy 94.80:  70%|███████   | 14/20 [02:27<01:02, 10.39s/it]
Task 0, Epoch 15/20 => Loss 0.157, Train_accy 95.11:  70%|███████   | 14/20 [02:37<01:02, 10.39s/it]
Task 0, Epoch 15/20 => Loss 0.157, Train_accy 95.11:  75%|███████▌  | 15/20 [02:37<00:51, 10.35s/it]
Task 0, Epoch 16/20 => Loss 0.185, Train_accy 93.64, Test_accy 94.01:  75%|███████▌  | 15/20 [02:49<00:51, 10.35s/it]
Task 0, Epoch 16/20 => Loss 0.185, Train_accy 93.64, Test_accy 94.01:  80%|████████  | 16/20 [02:49<00:42, 10.74s/it]
Task 0, Epoch 17/20 => Loss 0.166, Train_accy 94.65:  80%|████████  | 16/20 [02:59<00:42, 10.74s/it]                 
Task 0, Epoch 17/20 => Loss 0.166, Train_accy 94.65:  85%|████████▌ | 17/20 [02:59<00:31, 10.57s/it]
Task 0, Epoch 18/20 => Loss 0.150, Train_accy 95.35:  85%|████████▌ | 17/20 [03:09<00:31, 10.57s/it]
Task 0, Epoch 18/20 => Loss 0.150, Train_accy 95.35:  90%|█████████ | 18/20 [03:09<00:20, 10.49s/it]
Task 0, Epoch 19/20 => Loss 0.123, Train_accy 96.20:  90%|█████████ | 18/20 [03:19<00:20, 10.49s/it]
Task 0, Epoch 19/20 => Loss 0.123, Train_accy 96.20:  95%|█████████▌| 19/20 [03:19<00:10, 10.41s/it]
Task 0, Epoch 20/20 => Loss 0.120, Train_accy 95.97:  95%|█████████▌| 19/20 [03:29<00:10, 10.41s/it]
Task 0, Epoch 20/20 => Loss 0.120, Train_accy 95.97: 100%|██████████| 20/20 [03:29<00:00, 10.35s/it]
Task 0, Epoch 20/20 => Loss 0.120, Train_accy 95.97: 100%|██████████| 20/20 [03:29<00:00, 10.50s/it]
2024-09-07 11:01:19,851 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.120, Train_accy 95.97
2024-09-07 11:01:21,251 [trainer.py] => No NME accuracy.
2024-09-07 11:01:21,251 [trainer.py] => CNN: {'total': 95.58, '00-09': 95.58, 'old': 0, 'new': 95.58}
2024-09-07 11:01:21,252 [trainer.py] => CNN top1 curve: [95.58]
2024-09-07 11:01:21,252 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 95.58
2024-09-07 11:01:21,252 [trainer.py] => Average Accuracy (CNN): 95.58 

2024-09-07 11:01:21,253 [trainer.py] => All params: 85806346
2024-09-07 11:01:21,254 [trainer.py] => Trainable params: 85806346
2024-09-07 11:01:21,256 [finetune.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.281, Train_accy 41.85, Test_accy 82.87:   0%|          | 0/20 [00:14<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.281, Train_accy 41.85, Test_accy 82.87:   5%|▌         | 1/20 [00:14<04:31, 14.29s/it]
Task 1, Epoch 2/20 => Loss 0.398, Train_accy 83.30:   5%|▌         | 1/20 [00:26<04:31, 14.29s/it]                 
Task 1, Epoch 2/20 => Loss 0.398, Train_accy 83.30:  10%|█         | 2/20 [00:26<03:52, 12.90s/it]
Task 1, Epoch 3/20 => Loss 0.251, Train_accy 89.83:  10%|█         | 2/20 [00:38<03:52, 12.90s/it]
Task 1, Epoch 3/20 => Loss 0.251, Train_accy 89.83:  15%|█▌        | 3/20 [00:38<03:31, 12.46s/it]
Task 1, Epoch 4/20 => Loss 0.248, Train_accy 89.97:  15%|█▌        | 3/20 [00:50<03:31, 12.46s/it]
Task 1, Epoch 4/20 => Loss 0.248, Train_accy 89.97:  20%|██        | 4/20 [00:50<03:16, 12.26s/it]
Task 1, Epoch 5/20 => Loss 0.217, Train_accy 91.88:  20%|██        | 4/20 [01:02<03:16, 12.26s/it]
Task 1, Epoch 5/20 => Loss 0.217, Train_accy 91.88:  25%|██▌       | 5/20 [01:02<03:02, 12.17s/it]
Task 1, Epoch 6/20 => Loss 0.236, Train_accy 90.69, Test_accy 86.65:  25%|██▌       | 5/20 [01:16<03:02, 12.17s/it]
Task 1, Epoch 6/20 => Loss 0.236, Train_accy 90.69, Test_accy 86.65:  30%|███       | 6/20 [01:16<03:01, 12.93s/it]
Task 1, Epoch 7/20 => Loss 0.191, Train_accy 92.41:  30%|███       | 6/20 [01:28<03:01, 12.93s/it]                 
Task 1, Epoch 7/20 => Loss 0.191, Train_accy 92.41:  35%|███▌      | 7/20 [01:28<02:43, 12.61s/it]
Task 1, Epoch 8/20 => Loss 0.159, Train_accy 93.93:  35%|███▌      | 7/20 [01:40<02:43, 12.61s/it]
Task 1, Epoch 8/20 => Loss 0.159, Train_accy 93.93:  40%|████      | 8/20 [01:40<02:28, 12.40s/it]
Task 1, Epoch 9/20 => Loss 0.155, Train_accy 94.65:  40%|████      | 8/20 [01:52<02:28, 12.40s/it]
Task 1, Epoch 9/20 => Loss 0.155, Train_accy 94.65:  45%|████▌     | 9/20 [01:52<02:14, 12.26s/it]
Task 1, Epoch 10/20 => Loss 0.172, Train_accy 93.73:  45%|████▌     | 9/20 [02:04<02:14, 12.26s/it]
Task 1, Epoch 10/20 => Loss 0.172, Train_accy 93.73:  50%|█████     | 10/20 [02:04<02:01, 12.16s/it]
Task 1, Epoch 11/20 => Loss 0.163, Train_accy 94.32, Test_accy 86.21:  50%|█████     | 10/20 [02:18<02:01, 12.16s/it]
Task 1, Epoch 11/20 => Loss 0.163, Train_accy 94.32, Test_accy 86.21:  55%|█████▌    | 11/20 [02:18<01:55, 12.84s/it]
Task 1, Epoch 12/20 => Loss 0.149, Train_accy 94.79:  55%|█████▌    | 11/20 [02:30<01:55, 12.84s/it]                 
Task 1, Epoch 12/20 => Loss 0.149, Train_accy 94.79:  60%|██████    | 12/20 [02:30<01:40, 12.57s/it]
Task 1, Epoch 13/20 => Loss 0.146, Train_accy 94.32:  60%|██████    | 12/20 [02:42<01:40, 12.57s/it]
Task 1, Epoch 13/20 => Loss 0.146, Train_accy 94.32:  65%|██████▌   | 13/20 [02:42<01:26, 12.40s/it]
Task 1, Epoch 14/20 => Loss 0.161, Train_accy 94.26:  65%|██████▌   | 13/20 [02:54<01:26, 12.40s/it]
Task 1, Epoch 14/20 => Loss 0.161, Train_accy 94.26:  70%|███████   | 14/20 [02:54<01:13, 12.26s/it]
Task 1, Epoch 15/20 => Loss 0.134, Train_accy 94.72:  70%|███████   | 14/20 [03:06<01:13, 12.26s/it]
Task 1, Epoch 15/20 => Loss 0.134, Train_accy 94.72:  75%|███████▌  | 15/20 [03:06<01:00, 12.16s/it]
Task 1, Epoch 16/20 => Loss 0.146, Train_accy 95.45, Test_accy 87.37:  75%|███████▌  | 15/20 [03:20<01:00, 12.16s/it]
Task 1, Epoch 16/20 => Loss 0.146, Train_accy 95.45, Test_accy 87.37:  80%|████████  | 16/20 [03:20<00:51, 12.84s/it]
Task 1, Epoch 17/20 => Loss 0.117, Train_accy 95.25:  80%|████████  | 16/20 [03:32<00:51, 12.84s/it]                 
Task 1, Epoch 17/20 => Loss 0.117, Train_accy 95.25:  85%|████████▌ | 17/20 [03:32<00:37, 12.60s/it]
Task 1, Epoch 18/20 => Loss 0.133, Train_accy 95.25:  85%|████████▌ | 17/20 [03:44<00:37, 12.60s/it]
Task 1, Epoch 18/20 => Loss 0.133, Train_accy 95.25:  90%|█████████ | 18/20 [03:45<00:24, 12.42s/it]
Task 1, Epoch 19/20 => Loss 0.101, Train_accy 95.78:  90%|█████████ | 18/20 [03:56<00:24, 12.42s/it]
Task 1, Epoch 19/20 => Loss 0.101, Train_accy 95.78:  95%|█████████▌| 19/20 [03:56<00:12, 12.29s/it]
Task 1, Epoch 20/20 => Loss 0.109, Train_accy 95.97:  95%|█████████▌| 19/20 [04:08<00:12, 12.29s/it]
Task 1, Epoch 20/20 => Loss 0.109, Train_accy 95.97: 100%|██████████| 20/20 [04:08<00:00, 12.21s/it]
Task 1, Epoch 20/20 => Loss 0.109, Train_accy 95.97: 100%|██████████| 20/20 [04:08<00:00, 12.45s/it]
2024-09-07 11:05:30,255 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.109, Train_accy 95.97
2024-09-07 11:05:32,725 [trainer.py] => No NME accuracy.
2024-09-07 11:05:32,725 [trainer.py] => CNN: {'total': 85.78, '00-09': 76.66, '10-19': 93.55, 'old': 76.66, 'new': 93.55}
2024-09-07 11:05:32,726 [trainer.py] => CNN top1 curve: [95.58, 85.78]
2024-09-07 11:05:32,726 [trainer.py] => CNN top5 curve: [100.0, 97.82]

Average Accuracy (CNN): 90.68
2024-09-07 11:05:32,726 [trainer.py] => Average Accuracy (CNN): 90.68 

2024-09-07 11:05:32,728 [trainer.py] => All params: 85814036
2024-09-07 11:05:32,729 [trainer.py] => Trainable params: 85814036
2024-09-07 11:05:32,731 [finetune.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.366, Train_accy 31.83, Test_accy 81.19:   0%|          | 0/20 [00:13<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.366, Train_accy 31.83, Test_accy 81.19:   5%|▌         | 1/20 [00:13<04:09, 13.14s/it]
Task 2, Epoch 2/20 => Loss 0.387, Train_accy 79.46:   5%|▌         | 1/20 [00:22<04:09, 13.14s/it]                 
Task 2, Epoch 2/20 => Loss 0.387, Train_accy 79.46:  10%|█         | 2/20 [00:22<03:21, 11.17s/it]
Task 2, Epoch 3/20 => Loss 0.295, Train_accy 85.35:  10%|█         | 2/20 [00:32<03:21, 11.17s/it]
Task 2, Epoch 3/20 => Loss 0.295, Train_accy 85.35:  15%|█▌        | 3/20 [00:32<02:58, 10.51s/it]
Task 2, Epoch 4/20 => Loss 0.257, Train_accy 87.40:  15%|█▌        | 3/20 [00:42<02:58, 10.51s/it]
Task 2, Epoch 4/20 => Loss 0.257, Train_accy 87.40:  20%|██        | 4/20 [00:42<02:43, 10.20s/it]
Task 2, Epoch 5/20 => Loss 0.243, Train_accy 87.97:  20%|██        | 4/20 [00:52<02:43, 10.20s/it]
Task 2, Epoch 5/20 => Loss 0.243, Train_accy 87.97:  25%|██▌       | 5/20 [00:52<02:30, 10.04s/it]
Task 2, Epoch 6/20 => Loss 0.210, Train_accy 89.36, Test_accy 84.43:  25%|██▌       | 5/20 [01:05<02:30, 10.04s/it]
Task 2, Epoch 6/20 => Loss 0.210, Train_accy 89.36, Test_accy 84.43:  30%|███       | 6/20 [01:05<02:34, 11.06s/it]
Task 2, Epoch 7/20 => Loss 0.215, Train_accy 88.79:  30%|███       | 6/20 [01:14<02:34, 11.06s/it]                 
Task 2, Epoch 7/20 => Loss 0.215, Train_accy 88.79:  35%|███▌      | 7/20 [01:14<02:18, 10.65s/it]
Task 2, Epoch 8/20 => Loss 0.193, Train_accy 90.02:  35%|███▌      | 7/20 [01:24<02:18, 10.65s/it]
Task 2, Epoch 8/20 => Loss 0.193, Train_accy 90.02:  40%|████      | 8/20 [01:24<02:04, 10.38s/it]
Task 2, Epoch 9/20 => Loss 0.144, Train_accy 92.55:  40%|████      | 8/20 [01:34<02:04, 10.38s/it]
Task 2, Epoch 9/20 => Loss 0.144, Train_accy 92.55:  45%|████▌     | 9/20 [01:34<01:51, 10.17s/it]
Task 2, Epoch 10/20 => Loss 0.177, Train_accy 91.08:  45%|████▌     | 9/20 [01:44<01:51, 10.17s/it]
Task 2, Epoch 10/20 => Loss 0.177, Train_accy 91.08:  50%|█████     | 10/20 [01:44<01:40, 10.01s/it]
Task 2, Epoch 11/20 => Loss 0.163, Train_accy 91.41, Test_accy 82.71:  50%|█████     | 10/20 [01:57<01:40, 10.01s/it]
Task 2, Epoch 11/20 => Loss 0.163, Train_accy 91.41, Test_accy 82.71:  55%|█████▌    | 11/20 [01:57<01:38, 10.92s/it]
Task 2, Epoch 12/20 => Loss 0.165, Train_accy 91.24:  55%|█████▌    | 11/20 [02:06<01:38, 10.92s/it]                 
Task 2, Epoch 12/20 => Loss 0.165, Train_accy 91.24:  60%|██████    | 12/20 [02:06<01:24, 10.57s/it]
Task 2, Epoch 13/20 => Loss 0.188, Train_accy 91.33:  60%|██████    | 12/20 [02:16<01:24, 10.57s/it]
Task 2, Epoch 13/20 => Loss 0.188, Train_accy 91.33:  65%|██████▌   | 13/20 [02:16<01:12, 10.32s/it]
Task 2, Epoch 14/20 => Loss 0.204, Train_accy 89.85:  65%|██████▌   | 13/20 [02:26<01:12, 10.32s/it]
Task 2, Epoch 14/20 => Loss 0.204, Train_accy 89.85:  70%|███████   | 14/20 [02:26<01:00, 10.13s/it]
Task 2, Epoch 15/20 => Loss 0.185, Train_accy 90.51:  70%|███████   | 14/20 [02:36<01:00, 10.13s/it]
Task 2, Epoch 15/20 => Loss 0.185, Train_accy 90.51:  75%|███████▌  | 15/20 [02:36<00:49,  9.99s/it]
Task 2, Epoch 16/20 => Loss 0.146, Train_accy 92.64, Test_accy 82.31:  75%|███████▌  | 15/20 [02:49<00:49,  9.99s/it]
Task 2, Epoch 16/20 => Loss 0.146, Train_accy 92.64, Test_accy 82.31:  80%|████████  | 16/20 [02:49<00:43, 10.92s/it]
Task 2, Epoch 17/20 => Loss 0.124, Train_accy 92.31:  80%|████████  | 16/20 [02:58<00:43, 10.92s/it]                 
Task 2, Epoch 17/20 => Loss 0.124, Train_accy 92.31:  85%|████████▌ | 17/20 [02:58<00:31, 10.55s/it]
Task 2, Epoch 18/20 => Loss 0.129, Train_accy 94.19:  85%|████████▌ | 17/20 [03:08<00:31, 10.55s/it]
Task 2, Epoch 18/20 => Loss 0.129, Train_accy 94.19:  90%|█████████ | 18/20 [03:08<00:20, 10.31s/it]
Task 2, Epoch 19/20 => Loss 0.158, Train_accy 92.39:  90%|█████████ | 18/20 [03:18<00:20, 10.31s/it]
Task 2, Epoch 19/20 => Loss 0.158, Train_accy 92.39:  95%|█████████▌| 19/20 [03:18<00:10, 10.13s/it]
Task 2, Epoch 20/20 => Loss 0.172, Train_accy 91.57:  95%|█████████▌| 19/20 [03:27<00:10, 10.13s/it]
Task 2, Epoch 20/20 => Loss 0.172, Train_accy 91.57: 100%|██████████| 20/20 [03:27<00:00, 10.00s/it]
Task 2, Epoch 20/20 => Loss 0.172, Train_accy 91.57: 100%|██████████| 20/20 [03:27<00:00, 10.40s/it]
2024-09-07 11:09:00,656 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.172, Train_accy 91.57
2024-09-07 11:09:03,964 [trainer.py] => No NME accuracy.
2024-09-07 11:09:03,964 [trainer.py] => CNN: {'total': 80.79, '00-09': 71.29, '10-19': 82.8, '20-29': 88.33, 'old': 77.5, 'new': 88.33}
2024-09-07 11:09:03,964 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79]
2024-09-07 11:09:03,965 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36]

Average Accuracy (CNN): 87.38
2024-09-07 11:09:03,965 [trainer.py] => Average Accuracy (CNN): 87.38 

2024-09-07 11:09:03,966 [trainer.py] => All params: 85821726
2024-09-07 11:09:03,967 [trainer.py] => Trainable params: 85821726
2024-09-07 11:09:03,969 [finetune.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.234, Train_accy 35.22, Test_accy 77.44:   0%|          | 0/20 [00:14<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.234, Train_accy 35.22, Test_accy 77.44:   5%|▌         | 1/20 [00:14<04:42, 14.88s/it]
Task 3, Epoch 2/20 => Loss 0.441, Train_accy 75.82:   5%|▌         | 1/20 [00:25<04:42, 14.88s/it]                 
Task 3, Epoch 2/20 => Loss 0.441, Train_accy 75.82:  10%|█         | 2/20 [00:25<03:43, 12.40s/it]
Task 3, Epoch 3/20 => Loss 0.339, Train_accy 78.58:  10%|█         | 2/20 [00:36<03:43, 12.40s/it]
Task 3, Epoch 3/20 => Loss 0.339, Train_accy 78.58:  15%|█▌        | 3/20 [00:36<03:16, 11.58s/it]
Task 3, Epoch 4/20 => Loss 0.248, Train_accy 84.25:  15%|█▌        | 3/20 [00:46<03:16, 11.58s/it]
Task 3, Epoch 4/20 => Loss 0.248, Train_accy 84.25:  20%|██        | 4/20 [00:46<02:59, 11.21s/it]
Task 3, Epoch 5/20 => Loss 0.267, Train_accy 83.58:  20%|██        | 4/20 [00:57<02:59, 11.21s/it]
Task 3, Epoch 5/20 => Loss 0.267, Train_accy 83.58:  25%|██▌       | 5/20 [00:57<02:45, 11.01s/it]
Task 3, Epoch 6/20 => Loss 0.208, Train_accy 87.46, Test_accy 80.70:  25%|██▌       | 5/20 [01:12<02:45, 11.01s/it]
Task 3, Epoch 6/20 => Loss 0.208, Train_accy 87.46, Test_accy 80.70:  30%|███       | 6/20 [01:12<02:52, 12.33s/it]
Task 3, Epoch 7/20 => Loss 0.203, Train_accy 85.75:  30%|███       | 6/20 [01:22<02:52, 12.33s/it]                 
Task 3, Epoch 7/20 => Loss 0.203, Train_accy 85.75:  35%|███▌      | 7/20 [01:22<02:32, 11.77s/it]
Task 3, Epoch 8/20 => Loss 0.200, Train_accy 86.34:  35%|███▌      | 7/20 [01:33<02:32, 11.77s/it]
Task 3, Epoch 8/20 => Loss 0.200, Train_accy 86.34:  40%|████      | 8/20 [01:33<02:17, 11.49s/it]
Task 3, Epoch 9/20 => Loss 0.192, Train_accy 87.54:  40%|████      | 8/20 [01:44<02:17, 11.49s/it]
Task 3, Epoch 9/20 => Loss 0.192, Train_accy 87.54:  45%|████▌     | 9/20 [01:44<02:04, 11.28s/it]
Task 3, Epoch 10/20 => Loss 0.177, Train_accy 87.69:  45%|████▌     | 9/20 [01:55<02:04, 11.28s/it]
Task 3, Epoch 10/20 => Loss 0.177, Train_accy 87.69:  50%|█████     | 10/20 [01:55<01:50, 11.08s/it]
Task 3, Epoch 11/20 => Loss 0.156, Train_accy 89.10, Test_accy 78.58:  50%|█████     | 10/20 [02:10<01:50, 11.08s/it]
Task 3, Epoch 11/20 => Loss 0.156, Train_accy 89.10, Test_accy 78.58:  55%|█████▌    | 11/20 [02:10<01:50, 12.25s/it]
Task 3, Epoch 12/20 => Loss 0.141, Train_accy 91.27:  55%|█████▌    | 11/20 [02:20<01:50, 12.25s/it]                 
Task 3, Epoch 12/20 => Loss 0.141, Train_accy 91.27:  60%|██████    | 12/20 [02:20<01:34, 11.78s/it]
Task 3, Epoch 13/20 => Loss 0.165, Train_accy 89.78:  60%|██████    | 12/20 [02:31<01:34, 11.78s/it]
Task 3, Epoch 13/20 => Loss 0.165, Train_accy 89.78:  65%|██████▌   | 13/20 [02:31<01:20, 11.44s/it]
Task 3, Epoch 14/20 => Loss 0.189, Train_accy 87.91:  65%|██████▌   | 13/20 [02:42<01:20, 11.44s/it]
Task 3, Epoch 14/20 => Loss 0.189, Train_accy 87.91:  70%|███████   | 14/20 [02:42<01:07, 11.19s/it]
Task 3, Epoch 15/20 => Loss 0.155, Train_accy 90.75:  70%|███████   | 14/20 [02:52<01:07, 11.19s/it]
Task 3, Epoch 15/20 => Loss 0.155, Train_accy 90.75:  75%|███████▌  | 15/20 [02:52<00:55, 11.04s/it]
Task 3, Epoch 16/20 => Loss 0.202, Train_accy 87.91, Test_accy 78.96:  75%|███████▌  | 15/20 [03:07<00:55, 11.04s/it]
Task 3, Epoch 16/20 => Loss 0.202, Train_accy 87.91, Test_accy 78.96:  80%|████████  | 16/20 [03:07<00:48, 12.19s/it]
Task 3, Epoch 17/20 => Loss 0.128, Train_accy 91.49:  80%|████████  | 16/20 [03:18<00:48, 12.19s/it]                 
Task 3, Epoch 17/20 => Loss 0.128, Train_accy 91.49:  85%|████████▌ | 17/20 [03:18<00:35, 11.71s/it]
Task 3, Epoch 18/20 => Loss 0.152, Train_accy 90.60:  85%|████████▌ | 17/20 [03:29<00:35, 11.71s/it]
Task 3, Epoch 18/20 => Loss 0.152, Train_accy 90.60:  90%|█████████ | 18/20 [03:29<00:22, 11.43s/it]
Task 3, Epoch 19/20 => Loss 0.160, Train_accy 90.97:  90%|█████████ | 18/20 [03:39<00:22, 11.43s/it]
Task 3, Epoch 19/20 => Loss 0.160, Train_accy 90.97:  95%|█████████▌| 19/20 [03:39<00:11, 11.21s/it]
Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.09:  95%|█████████▌| 19/20 [03:50<00:11, 11.21s/it]
Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.09: 100%|██████████| 20/20 [03:50<00:00, 11.02s/it]
Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.09: 100%|██████████| 20/20 [03:50<00:00, 11.52s/it]
2024-09-07 11:12:54,387 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.134, Train_accy 92.09
2024-09-07 11:12:58,639 [trainer.py] => No NME accuracy.
2024-09-07 11:12:58,640 [trainer.py] => CNN: {'total': 78.58, '00-09': 63.72, '10-19': 79.57, '20-29': 80.67, '30-39': 89.76, 'old': 74.82, 'new': 89.76}
2024-09-07 11:12:58,640 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58]
2024-09-07 11:12:58,640 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85]

Average Accuracy (CNN): 85.18
2024-09-07 11:12:58,640 [trainer.py] => Average Accuracy (CNN): 85.18 

2024-09-07 11:12:58,642 [trainer.py] => All params: 85829416
2024-09-07 11:12:58,643 [trainer.py] => Trainable params: 85829416
2024-09-07 11:12:58,646 [finetune.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.560, Train_accy 20.89, Test_accy 73.81:   0%|          | 0/20 [00:13<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.560, Train_accy 20.89, Test_accy 73.81:   5%|▌         | 1/20 [00:13<04:25, 13.96s/it]
Task 4, Epoch 2/20 => Loss 0.569, Train_accy 72.30:   5%|▌         | 1/20 [00:22<04:25, 13.96s/it]                 
Task 4, Epoch 2/20 => Loss 0.569, Train_accy 72.30:  10%|█         | 2/20 [00:22<03:16, 10.91s/it]
Task 4, Epoch 3/20 => Loss 0.457, Train_accy 76.02:  10%|█         | 2/20 [00:31<03:16, 10.91s/it]
Task 4, Epoch 3/20 => Loss 0.457, Train_accy 76.02:  15%|█▌        | 3/20 [00:31<02:49,  9.94s/it]
Task 4, Epoch 4/20 => Loss 0.326, Train_accy 82.02:  15%|█▌        | 3/20 [00:40<02:49,  9.94s/it]
Task 4, Epoch 4/20 => Loss 0.326, Train_accy 82.02:  20%|██        | 4/20 [00:40<02:31,  9.50s/it]
Task 4, Epoch 5/20 => Loss 0.301, Train_accy 83.20:  20%|██        | 4/20 [00:49<02:31,  9.50s/it]
Task 4, Epoch 5/20 => Loss 0.301, Train_accy 83.20:  25%|██▌       | 5/20 [00:49<02:18,  9.24s/it]
Task 4, Epoch 6/20 => Loss 0.277, Train_accy 84.20, Test_accy 77.57:  25%|██▌       | 5/20 [01:03<02:18,  9.24s/it]
Task 4, Epoch 6/20 => Loss 0.277, Train_accy 84.20, Test_accy 77.57:  30%|███       | 6/20 [01:03<02:31, 10.86s/it]
Task 4, Epoch 7/20 => Loss 0.252, Train_accy 85.47:  30%|███       | 6/20 [01:11<02:31, 10.86s/it]                 
Task 4, Epoch 7/20 => Loss 0.252, Train_accy 85.47:  35%|███▌      | 7/20 [01:11<02:12, 10.17s/it]
Task 4, Epoch 8/20 => Loss 0.229, Train_accy 87.47:  35%|███▌      | 7/20 [01:20<02:12, 10.17s/it]
Task 4, Epoch 8/20 => Loss 0.229, Train_accy 87.47:  40%|████      | 8/20 [01:20<01:56,  9.73s/it]
Task 4, Epoch 9/20 => Loss 0.191, Train_accy 87.92:  40%|████      | 8/20 [01:29<01:56,  9.73s/it]
Task 4, Epoch 9/20 => Loss 0.191, Train_accy 87.92:  45%|████▌     | 9/20 [01:29<01:44,  9.46s/it]
Task 4, Epoch 10/20 => Loss 0.293, Train_accy 85.29:  45%|████▌     | 9/20 [01:38<01:44,  9.46s/it]
Task 4, Epoch 10/20 => Loss 0.293, Train_accy 85.29:  50%|█████     | 10/20 [01:38<01:32,  9.28s/it]
Task 4, Epoch 11/20 => Loss 0.209, Train_accy 86.92, Test_accy 76.46:  50%|█████     | 10/20 [01:52<01:32,  9.28s/it]
Task 4, Epoch 11/20 => Loss 0.209, Train_accy 86.92, Test_accy 76.46:  55%|█████▌    | 11/20 [01:52<01:36, 10.71s/it]
Task 4, Epoch 12/20 => Loss 0.174, Train_accy 89.65:  55%|█████▌    | 11/20 [02:01<01:36, 10.71s/it]                 
Task 4, Epoch 12/20 => Loss 0.174, Train_accy 89.65:  60%|██████    | 12/20 [02:01<01:20, 10.12s/it]
Task 4, Epoch 13/20 => Loss 0.176, Train_accy 90.01:  60%|██████    | 12/20 [02:09<01:20, 10.12s/it]
Task 4, Epoch 13/20 => Loss 0.176, Train_accy 90.01:  65%|██████▌   | 13/20 [02:09<01:08,  9.72s/it]
Task 4, Epoch 14/20 => Loss 0.182, Train_accy 89.28:  65%|██████▌   | 13/20 [02:18<01:08,  9.72s/it]
Task 4, Epoch 14/20 => Loss 0.182, Train_accy 89.28:  70%|███████   | 14/20 [02:18<00:56,  9.44s/it]
Task 4, Epoch 15/20 => Loss 0.171, Train_accy 90.28:  70%|███████   | 14/20 [02:27<00:56,  9.44s/it]
Task 4, Epoch 15/20 => Loss 0.171, Train_accy 90.28:  75%|███████▌  | 15/20 [02:27<00:46,  9.24s/it]
Task 4, Epoch 16/20 => Loss 0.172, Train_accy 90.28, Test_accy 78.19:  75%|███████▌  | 15/20 [02:41<00:46,  9.24s/it]
Task 4, Epoch 16/20 => Loss 0.172, Train_accy 90.28, Test_accy 78.19:  80%|████████  | 16/20 [02:41<00:42, 10.63s/it]
Task 4, Epoch 17/20 => Loss 0.164, Train_accy 91.19:  80%|████████  | 16/20 [02:50<00:42, 10.63s/it]                 
Task 4, Epoch 17/20 => Loss 0.164, Train_accy 91.19:  85%|████████▌ | 17/20 [02:50<00:30, 10.07s/it]
Task 4, Epoch 18/20 => Loss 0.137, Train_accy 91.55:  85%|████████▌ | 17/20 [02:58<00:30, 10.07s/it]
Task 4, Epoch 18/20 => Loss 0.137, Train_accy 91.55:  90%|█████████ | 18/20 [02:58<00:19,  9.68s/it]
Task 4, Epoch 19/20 => Loss 0.164, Train_accy 89.65:  90%|█████████ | 18/20 [03:07<00:19,  9.68s/it]
Task 4, Epoch 19/20 => Loss 0.164, Train_accy 89.65:  95%|█████████▌| 19/20 [03:07<00:09,  9.41s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 91.64:  95%|█████████▌| 19/20 [03:16<00:09,  9.41s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 91.64: 100%|██████████| 20/20 [03:16<00:00,  9.21s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 91.64: 100%|██████████| 20/20 [03:16<00:00,  9.82s/it]
2024-09-07 11:16:15,073 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.134, Train_accy 91.64
2024-09-07 11:16:20,180 [trainer.py] => No NME accuracy.
2024-09-07 11:16:20,181 [trainer.py] => CNN: {'total': 75.54, '00-09': 64.67, '10-19': 73.12, '20-29': 74.0, '30-39': 78.31, '40-49': 88.41, 'old': 72.6, 'new': 88.41}
2024-09-07 11:16:20,181 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54]
2024-09-07 11:16:20,181 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3]

Average Accuracy (CNN): 83.25
2024-09-07 11:16:20,181 [trainer.py] => Average Accuracy (CNN): 83.25 

2024-09-07 11:16:20,182 [trainer.py] => All params: 85837106
2024-09-07 11:16:20,184 [trainer.py] => Trainable params: 85837106
2024-09-07 11:16:20,186 [finetune.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.307, Train_accy 23.51, Test_accy 71.30:   0%|          | 0/20 [00:15<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.307, Train_accy 23.51, Test_accy 71.30:   5%|▌         | 1/20 [00:15<05:02, 15.93s/it]
Task 5, Epoch 2/20 => Loss 0.417, Train_accy 71.26:   5%|▌         | 1/20 [00:25<05:02, 15.93s/it]                 
Task 5, Epoch 2/20 => Loss 0.417, Train_accy 71.26:  10%|█         | 2/20 [00:25<03:42, 12.35s/it]
Task 5, Epoch 3/20 => Loss 0.353, Train_accy 76.09:  10%|█         | 2/20 [00:36<03:42, 12.35s/it]
Task 5, Epoch 3/20 => Loss 0.353, Train_accy 76.09:  15%|█▌        | 3/20 [00:36<03:14, 11.42s/it]
Task 5, Epoch 4/20 => Loss 0.259, Train_accy 81.48:  15%|█▌        | 3/20 [00:45<03:14, 11.42s/it]
Task 5, Epoch 4/20 => Loss 0.259, Train_accy 81.48:  20%|██        | 4/20 [00:45<02:53, 10.82s/it]
Task 5, Epoch 5/20 => Loss 0.274, Train_accy 83.49:  20%|██        | 4/20 [00:55<02:53, 10.82s/it]
Task 5, Epoch 5/20 => Loss 0.274, Train_accy 83.49:  25%|██▌       | 5/20 [00:55<02:37, 10.47s/it]
Task 5, Epoch 6/20 => Loss 0.218, Train_accy 86.23, Test_accy 76.54:  25%|██▌       | 5/20 [01:11<02:37, 10.47s/it]
Task 5, Epoch 6/20 => Loss 0.218, Train_accy 86.23, Test_accy 76.54:  30%|███       | 6/20 [01:11<02:52, 12.34s/it]
Task 5, Epoch 7/20 => Loss 0.193, Train_accy 87.04:  30%|███       | 6/20 [01:21<02:52, 12.34s/it]                 
Task 5, Epoch 7/20 => Loss 0.193, Train_accy 87.04:  35%|███▌      | 7/20 [01:21<02:30, 11.54s/it]
Task 5, Epoch 8/20 => Loss 0.228, Train_accy 85.27:  35%|███▌      | 7/20 [01:31<02:30, 11.54s/it]
Task 5, Epoch 8/20 => Loss 0.228, Train_accy 85.27:  40%|████      | 8/20 [01:31<02:12, 11.01s/it]
Task 5, Epoch 9/20 => Loss 0.232, Train_accy 86.31:  40%|████      | 8/20 [01:41<02:12, 11.01s/it]
Task 5, Epoch 9/20 => Loss 0.232, Train_accy 86.31:  45%|████▌     | 9/20 [01:41<01:57, 10.67s/it]
Task 5, Epoch 10/20 => Loss 0.204, Train_accy 86.88:  45%|████▌     | 9/20 [01:51<01:57, 10.67s/it]
Task 5, Epoch 10/20 => Loss 0.204, Train_accy 86.88:  50%|█████     | 10/20 [01:51<01:44, 10.42s/it]
Task 5, Epoch 11/20 => Loss 0.147, Train_accy 89.61, Test_accy 76.54:  50%|█████     | 10/20 [02:07<01:44, 10.42s/it]
Task 5, Epoch 11/20 => Loss 0.147, Train_accy 89.61, Test_accy 76.54:  55%|█████▌    | 11/20 [02:07<01:48, 12.11s/it]
Task 5, Epoch 12/20 => Loss 0.175, Train_accy 88.89:  55%|█████▌    | 11/20 [02:17<01:48, 12.11s/it]                 
Task 5, Epoch 12/20 => Loss 0.175, Train_accy 88.89:  60%|██████    | 12/20 [02:17<01:31, 11.44s/it]
Task 5, Epoch 13/20 => Loss 0.167, Train_accy 89.21:  60%|██████    | 12/20 [02:27<01:31, 11.44s/it]
Task 5, Epoch 13/20 => Loss 0.167, Train_accy 89.21:  65%|██████▌   | 13/20 [02:27<01:16, 10.96s/it]
Task 5, Epoch 14/20 => Loss 0.166, Train_accy 89.21:  65%|██████▌   | 13/20 [02:36<01:16, 10.96s/it]
Task 5, Epoch 14/20 => Loss 0.166, Train_accy 89.21:  70%|███████   | 14/20 [02:36<01:03, 10.64s/it]
Task 5, Epoch 15/20 => Loss 0.165, Train_accy 89.61:  70%|███████   | 14/20 [02:46<01:03, 10.64s/it]
Task 5, Epoch 15/20 => Loss 0.165, Train_accy 89.61:  75%|███████▌  | 15/20 [02:46<00:52, 10.43s/it]
Task 5, Epoch 16/20 => Loss 0.124, Train_accy 90.74, Test_accy 75.35:  75%|███████▌  | 15/20 [03:02<00:52, 10.43s/it]
Task 5, Epoch 16/20 => Loss 0.124, Train_accy 90.74, Test_accy 75.35:  80%|████████  | 16/20 [03:02<00:48, 12.07s/it]
Task 5, Epoch 17/20 => Loss 0.152, Train_accy 90.98:  80%|████████  | 16/20 [03:12<00:48, 12.07s/it]                 
Task 5, Epoch 17/20 => Loss 0.152, Train_accy 90.98:  85%|████████▌ | 17/20 [03:12<00:34, 11.41s/it]
Task 5, Epoch 18/20 => Loss 0.149, Train_accy 90.82:  85%|████████▌ | 17/20 [03:22<00:34, 11.41s/it]
Task 5, Epoch 18/20 => Loss 0.149, Train_accy 90.82:  90%|█████████ | 18/20 [03:22<00:21, 10.96s/it]
Task 5, Epoch 19/20 => Loss 0.159, Train_accy 89.69:  90%|█████████ | 18/20 [03:32<00:21, 10.96s/it]
Task 5, Epoch 19/20 => Loss 0.159, Train_accy 89.69:  95%|█████████▌| 19/20 [03:32<00:10, 10.65s/it]
Task 5, Epoch 20/20 => Loss 0.093, Train_accy 92.03:  95%|█████████▌| 19/20 [03:42<00:10, 10.65s/it]
Task 5, Epoch 20/20 => Loss 0.093, Train_accy 92.03: 100%|██████████| 20/20 [03:42<00:00, 10.42s/it]
Task 5, Epoch 20/20 => Loss 0.093, Train_accy 92.03: 100%|██████████| 20/20 [03:42<00:00, 11.12s/it]
2024-09-07 11:20:02,566 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.093, Train_accy 92.03
2024-09-07 11:20:08,546 [trainer.py] => No NME accuracy.
2024-09-07 11:20:08,547 [trainer.py] => CNN: {'total': 72.91, '00-09': 59.94, '10-19': 66.94, '20-29': 71.0, '30-39': 71.99, '40-49': 80.79, '50-59': 88.82, 'old': 69.93, 'new': 88.82}
2024-09-07 11:20:08,547 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91]
2024-09-07 11:20:08,547 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49]

Average Accuracy (CNN): 81.53
2024-09-07 11:20:08,548 [trainer.py] => Average Accuracy (CNN): 81.53 

2024-09-07 11:20:08,549 [trainer.py] => All params: 85844796
2024-09-07 11:20:08,551 [trainer.py] => Trainable params: 85844796
2024-09-07 11:20:08,554 [finetune.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.291, Train_accy 25.99, Test_accy 69.26:   0%|          | 0/20 [00:16<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.291, Train_accy 25.99, Test_accy 69.26:   5%|▌         | 1/20 [00:16<05:16, 16.65s/it]
Task 6, Epoch 2/20 => Loss 0.561, Train_accy 65.48:   5%|▌         | 1/20 [00:26<05:16, 16.65s/it]                 
Task 6, Epoch 2/20 => Loss 0.561, Train_accy 65.48:  10%|█         | 2/20 [00:26<03:45, 12.53s/it]
Task 6, Epoch 3/20 => Loss 0.392, Train_accy 75.83:  10%|█         | 2/20 [00:35<03:45, 12.53s/it]
Task 6, Epoch 3/20 => Loss 0.392, Train_accy 75.83:  15%|█▌        | 3/20 [00:35<03:10, 11.22s/it]
Task 6, Epoch 4/20 => Loss 0.341, Train_accy 77.98:  15%|█▌        | 3/20 [00:45<03:10, 11.22s/it]
Task 6, Epoch 4/20 => Loss 0.341, Train_accy 77.98:  20%|██        | 4/20 [00:45<02:49, 10.61s/it]
Task 6, Epoch 5/20 => Loss 0.264, Train_accy 80.38:  20%|██        | 4/20 [00:55<02:49, 10.61s/it]
Task 6, Epoch 5/20 => Loss 0.264, Train_accy 80.38:  25%|██▌       | 5/20 [00:55<02:33, 10.26s/it]
Task 6, Epoch 6/20 => Loss 0.270, Train_accy 82.53, Test_accy 69.48:  25%|██▌       | 5/20 [01:11<02:33, 10.26s/it]
Task 6, Epoch 6/20 => Loss 0.270, Train_accy 82.53, Test_accy 69.48:  30%|███       | 6/20 [01:11<02:53, 12.42s/it]
Task 6, Epoch 7/20 => Loss 0.244, Train_accy 83.94:  30%|███       | 6/20 [01:21<02:53, 12.42s/it]                 
Task 6, Epoch 7/20 => Loss 0.244, Train_accy 83.94:  35%|███▌      | 7/20 [01:21<02:29, 11.51s/it]
Task 6, Epoch 8/20 => Loss 0.213, Train_accy 85.26:  35%|███▌      | 7/20 [01:31<02:29, 11.51s/it]
Task 6, Epoch 8/20 => Loss 0.213, Train_accy 85.26:  40%|████      | 8/20 [01:31<02:10, 10.91s/it]
Task 6, Epoch 9/20 => Loss 0.213, Train_accy 86.42:  40%|████      | 8/20 [01:40<02:10, 10.91s/it]
Task 6, Epoch 9/20 => Loss 0.213, Train_accy 86.42:  45%|████▌     | 9/20 [01:40<01:55, 10.54s/it]
Task 6, Epoch 10/20 => Loss 0.210, Train_accy 85.35:  45%|████▌     | 9/20 [01:50<01:55, 10.54s/it]
Task 6, Epoch 10/20 => Loss 0.210, Train_accy 85.35:  50%|█████     | 10/20 [01:50<01:42, 10.26s/it]
Task 6, Epoch 11/20 => Loss 0.183, Train_accy 87.17, Test_accy 67.91:  50%|█████     | 10/20 [02:07<01:42, 10.26s/it]
Task 6, Epoch 11/20 => Loss 0.183, Train_accy 87.17, Test_accy 67.91:  55%|█████▌    | 11/20 [02:07<01:49, 12.17s/it]
Task 6, Epoch 12/20 => Loss 0.227, Train_accy 86.34:  55%|█████▌    | 11/20 [02:16<01:49, 12.17s/it]                 
Task 6, Epoch 12/20 => Loss 0.227, Train_accy 86.34:  60%|██████    | 12/20 [02:16<01:31, 11.39s/it]
Task 6, Epoch 13/20 => Loss 0.210, Train_accy 85.93:  60%|██████    | 12/20 [02:26<01:31, 11.39s/it]
Task 6, Epoch 13/20 => Loss 0.210, Train_accy 85.93:  65%|██████▌   | 13/20 [02:26<01:15, 10.86s/it]
Task 6, Epoch 14/20 => Loss 0.224, Train_accy 87.50:  65%|██████▌   | 13/20 [02:35<01:15, 10.86s/it]
Task 6, Epoch 14/20 => Loss 0.224, Train_accy 87.50:  70%|███████   | 14/20 [02:35<01:02, 10.49s/it]
Task 6, Epoch 15/20 => Loss 0.201, Train_accy 87.50:  70%|███████   | 14/20 [02:45<01:02, 10.49s/it]
Task 6, Epoch 15/20 => Loss 0.201, Train_accy 87.50:  75%|███████▌  | 15/20 [02:45<00:51, 10.26s/it]
Task 6, Epoch 16/20 => Loss 0.152, Train_accy 89.07, Test_accy 69.84:  75%|███████▌  | 15/20 [03:02<00:51, 10.26s/it]
Task 6, Epoch 16/20 => Loss 0.152, Train_accy 89.07, Test_accy 69.84:  80%|████████  | 16/20 [03:02<00:48, 12.13s/it]
Task 6, Epoch 17/20 => Loss 0.193, Train_accy 89.40:  80%|████████  | 16/20 [03:11<00:48, 12.13s/it]                 
Task 6, Epoch 17/20 => Loss 0.193, Train_accy 89.40:  85%|████████▌ | 17/20 [03:11<00:34, 11.38s/it]
Task 6, Epoch 18/20 => Loss 0.160, Train_accy 88.99:  85%|████████▌ | 17/20 [03:21<00:34, 11.38s/it]
Task 6, Epoch 18/20 => Loss 0.160, Train_accy 88.99:  90%|█████████ | 18/20 [03:21<00:21, 10.85s/it]
Task 6, Epoch 19/20 => Loss 0.167, Train_accy 89.82:  90%|█████████ | 18/20 [03:31<00:21, 10.85s/it]
Task 6, Epoch 19/20 => Loss 0.167, Train_accy 89.82:  95%|█████████▌| 19/20 [03:31<00:10, 10.51s/it]
Task 6, Epoch 20/20 => Loss 0.119, Train_accy 91.47:  95%|█████████▌| 19/20 [03:40<00:10, 10.51s/it]
Task 6, Epoch 20/20 => Loss 0.119, Train_accy 91.47: 100%|██████████| 20/20 [03:40<00:00, 10.22s/it]
Task 6, Epoch 20/20 => Loss 0.119, Train_accy 91.47: 100%|██████████| 20/20 [03:40<00:00, 11.03s/it]
2024-09-07 11:23:49,170 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.119, Train_accy 91.47
2024-09-07 11:23:56,029 [trainer.py] => No NME accuracy.
2024-09-07 11:23:56,030 [trainer.py] => CNN: {'total': 68.58, '00-09': 48.58, '10-19': 60.22, '20-29': 66.33, '30-39': 68.67, '40-49': 69.87, '50-59': 81.25, '60-69': 88.26, 'old': 65.54, 'new': 88.26}
2024-09-07 11:23:56,030 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58]
2024-09-07 11:23:56,030 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62]

Average Accuracy (CNN): 79.68
2024-09-07 11:23:56,030 [trainer.py] => Average Accuracy (CNN): 79.68 

2024-09-07 11:23:56,032 [trainer.py] => All params: 85852486
2024-09-07 11:23:56,033 [trainer.py] => Trainable params: 85852486
2024-09-07 11:23:56,035 [finetune.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.314, Train_accy 17.97, Test_accy 65.53:   0%|          | 0/20 [00:16<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.314, Train_accy 17.97, Test_accy 65.53:   5%|▌         | 1/20 [00:16<05:11, 16.38s/it]
Task 7, Epoch 2/20 => Loss 0.396, Train_accy 61.57:   5%|▌         | 1/20 [00:25<05:11, 16.38s/it]                 
Task 7, Epoch 2/20 => Loss 0.396, Train_accy 61.57:  10%|█         | 2/20 [00:25<03:34, 11.91s/it]
Task 7, Epoch 3/20 => Loss 0.286, Train_accy 73.92:  10%|█         | 2/20 [00:33<03:34, 11.91s/it]
Task 7, Epoch 3/20 => Loss 0.286, Train_accy 73.92:  15%|█▌        | 3/20 [00:33<02:56, 10.41s/it]
Task 7, Epoch 4/20 => Loss 0.250, Train_accy 74.65:  15%|█▌        | 3/20 [00:42<02:56, 10.41s/it]
Task 7, Epoch 4/20 => Loss 0.250, Train_accy 74.65:  20%|██        | 4/20 [00:42<02:35,  9.74s/it]
Task 7, Epoch 5/20 => Loss 0.197, Train_accy 79.17:  20%|██        | 4/20 [00:51<02:35,  9.74s/it]
Task 7, Epoch 5/20 => Loss 0.197, Train_accy 79.17:  25%|██▌       | 5/20 [00:51<02:20,  9.39s/it]
Task 7, Epoch 6/20 => Loss 0.182, Train_accy 79.54, Test_accy 67.25:  25%|██▌       | 5/20 [01:07<02:20,  9.39s/it]
Task 7, Epoch 6/20 => Loss 0.182, Train_accy 79.54, Test_accy 67.25:  30%|███       | 6/20 [01:07<02:45, 11.80s/it]
Task 7, Epoch 7/20 => Loss 0.209, Train_accy 80.18:  30%|███       | 6/20 [01:16<02:45, 11.80s/it]                 
Task 7, Epoch 7/20 => Loss 0.209, Train_accy 80.18:  35%|███▌      | 7/20 [01:16<02:20, 10.80s/it]
Task 7, Epoch 8/20 => Loss 0.186, Train_accy 82.49:  35%|███▌      | 7/20 [01:25<02:20, 10.80s/it]
Task 7, Epoch 8/20 => Loss 0.186, Train_accy 82.49:  40%|████      | 8/20 [01:25<02:01, 10.12s/it]
Task 7, Epoch 9/20 => Loss 0.117, Train_accy 85.25:  40%|████      | 8/20 [01:33<02:01, 10.12s/it]
Task 7, Epoch 9/20 => Loss 0.117, Train_accy 85.25:  45%|████▌     | 9/20 [01:33<01:46,  9.68s/it]
Task 7, Epoch 10/20 => Loss 0.174, Train_accy 84.70:  45%|████▌     | 9/20 [01:42<01:46,  9.68s/it]
Task 7, Epoch 10/20 => Loss 0.174, Train_accy 84.70:  50%|█████     | 10/20 [01:42<01:33,  9.36s/it]
Task 7, Epoch 11/20 => Loss 0.160, Train_accy 83.87, Test_accy 68.78:  50%|█████     | 10/20 [01:58<01:33,  9.36s/it]
Task 7, Epoch 11/20 => Loss 0.160, Train_accy 83.87, Test_accy 68.78:  55%|█████▌    | 11/20 [01:58<01:43, 11.47s/it]
Task 7, Epoch 12/20 => Loss 0.131, Train_accy 86.18:  55%|█████▌    | 11/20 [02:07<01:43, 11.47s/it]                 
Task 7, Epoch 12/20 => Loss 0.131, Train_accy 86.18:  60%|██████    | 12/20 [02:07<01:24, 10.62s/it]
Task 7, Epoch 13/20 => Loss 0.163, Train_accy 85.44:  60%|██████    | 12/20 [02:16<01:24, 10.62s/it]
Task 7, Epoch 13/20 => Loss 0.163, Train_accy 85.44:  65%|██████▌   | 13/20 [02:16<01:10, 10.02s/it]
Task 7, Epoch 14/20 => Loss 0.136, Train_accy 86.36:  65%|██████▌   | 13/20 [02:24<01:10, 10.02s/it]
Task 7, Epoch 14/20 => Loss 0.136, Train_accy 86.36:  70%|███████   | 14/20 [02:24<00:57,  9.61s/it]
Task 7, Epoch 15/20 => Loss 0.120, Train_accy 88.57:  70%|███████   | 14/20 [02:33<00:57,  9.61s/it]
Task 7, Epoch 15/20 => Loss 0.120, Train_accy 88.57:  75%|███████▌  | 15/20 [02:33<00:46,  9.33s/it]
Task 7, Epoch 16/20 => Loss 0.089, Train_accy 88.20, Test_accy 67.09:  75%|███████▌  | 15/20 [02:49<00:46,  9.33s/it]
Task 7, Epoch 16/20 => Loss 0.089, Train_accy 88.20, Test_accy 67.09:  80%|████████  | 16/20 [02:49<00:45, 11.41s/it]
Task 7, Epoch 17/20 => Loss 0.148, Train_accy 87.47:  80%|████████  | 16/20 [02:58<00:45, 11.41s/it]                 
Task 7, Epoch 17/20 => Loss 0.148, Train_accy 87.47:  85%|████████▌ | 17/20 [02:58<00:31, 10.60s/it]
Task 7, Epoch 18/20 => Loss 0.166, Train_accy 85.44:  85%|████████▌ | 17/20 [03:07<00:31, 10.60s/it]
Task 7, Epoch 18/20 => Loss 0.166, Train_accy 85.44:  90%|█████████ | 18/20 [03:07<00:20, 10.01s/it]
Task 7, Epoch 19/20 => Loss 0.144, Train_accy 87.93:  90%|█████████ | 18/20 [03:15<00:20, 10.01s/it]
Task 7, Epoch 19/20 => Loss 0.144, Train_accy 87.93:  95%|█████████▌| 19/20 [03:15<00:09,  9.61s/it]
Task 7, Epoch 20/20 => Loss 0.122, Train_accy 87.56:  95%|█████████▌| 19/20 [03:24<00:09,  9.61s/it]
Task 7, Epoch 20/20 => Loss 0.122, Train_accy 87.56: 100%|██████████| 20/20 [03:24<00:00,  9.32s/it]
Task 7, Epoch 20/20 => Loss 0.122, Train_accy 87.56: 100%|██████████| 20/20 [03:24<00:00, 10.22s/it]
2024-09-07 11:27:20,400 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.122, Train_accy 87.56
2024-09-07 11:27:28,045 [trainer.py] => No NME accuracy.
2024-09-07 11:27:28,046 [trainer.py] => CNN: {'total': 69.26, '00-09': 49.21, '10-19': 65.59, '20-29': 64.67, '30-39': 63.25, '40-49': 66.23, '50-59': 76.32, '60-69': 84.23, '70-79': 89.01, 'old': 66.83, 'new': 89.01}
2024-09-07 11:27:28,046 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26]
2024-09-07 11:27:28,046 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63]

Average Accuracy (CNN): 78.38
2024-09-07 11:27:28,046 [trainer.py] => Average Accuracy (CNN): 78.38 

2024-09-07 11:27:28,047 [trainer.py] => All params: 85860176
2024-09-07 11:27:28,048 [trainer.py] => Trainable params: 85860176
2024-09-07 11:27:28,051 [finetune.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.161, Train_accy 27.33, Test_accy 66.10:   0%|          | 0/20 [00:19<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.161, Train_accy 27.33, Test_accy 66.10:   5%|▌         | 1/20 [00:19<06:17, 19.85s/it]
Task 8, Epoch 2/20 => Loss 0.399, Train_accy 68.50:   5%|▌         | 1/20 [00:31<06:17, 19.85s/it]                 
Task 8, Epoch 2/20 => Loss 0.399, Train_accy 68.50:  10%|█         | 2/20 [00:31<04:25, 14.77s/it]
Task 8, Epoch 3/20 => Loss 0.287, Train_accy 75.14:  10%|█         | 2/20 [00:42<04:25, 14.77s/it]
Task 8, Epoch 3/20 => Loss 0.287, Train_accy 75.14:  15%|█▌        | 3/20 [00:42<03:43, 13.16s/it]
Task 8, Epoch 4/20 => Loss 0.251, Train_accy 78.32:  15%|█▌        | 3/20 [00:53<03:43, 13.16s/it]
Task 8, Epoch 4/20 => Loss 0.251, Train_accy 78.32:  20%|██        | 4/20 [00:53<03:18, 12.38s/it]
Task 8, Epoch 5/20 => Loss 0.237, Train_accy 78.88:  20%|██        | 4/20 [01:04<03:18, 12.38s/it]
Task 8, Epoch 5/20 => Loss 0.237, Train_accy 78.88:  25%|██▌       | 5/20 [01:04<02:59, 11.95s/it]
Task 8, Epoch 6/20 => Loss 0.270, Train_accy 78.46, Test_accy 67.02:  25%|██▌       | 5/20 [01:24<02:59, 11.95s/it]
Task 8, Epoch 6/20 => Loss 0.270, Train_accy 78.46, Test_accy 67.02:  30%|███       | 6/20 [01:24<03:24, 14.61s/it]
Task 8, Epoch 7/20 => Loss 0.251, Train_accy 81.36:  30%|███       | 6/20 [01:35<03:24, 14.61s/it]                 
Task 8, Epoch 7/20 => Loss 0.251, Train_accy 81.36:  35%|███▌      | 7/20 [01:35<02:55, 13.52s/it]
Task 8, Epoch 8/20 => Loss 0.225, Train_accy 84.96:  35%|███▌      | 7/20 [01:46<02:55, 13.52s/it]
Task 8, Epoch 8/20 => Loss 0.225, Train_accy 84.96:  40%|████      | 8/20 [01:46<02:33, 12.78s/it]
Task 8, Epoch 9/20 => Loss 0.199, Train_accy 83.83:  40%|████      | 8/20 [01:58<02:33, 12.78s/it]
Task 8, Epoch 9/20 => Loss 0.199, Train_accy 83.83:  45%|████▌     | 9/20 [01:58<02:15, 12.28s/it]
Task 8, Epoch 10/20 => Loss 0.197, Train_accy 86.86:  45%|████▌     | 9/20 [02:09<02:15, 12.28s/it]
Task 8, Epoch 10/20 => Loss 0.197, Train_accy 86.86:  50%|█████     | 10/20 [02:09<01:59, 11.95s/it]
Task 8, Epoch 11/20 => Loss 0.175, Train_accy 85.17, Test_accy 67.02:  50%|█████     | 10/20 [02:29<01:59, 11.95s/it]
Task 8, Epoch 11/20 => Loss 0.175, Train_accy 85.17, Test_accy 67.02:  55%|█████▌    | 11/20 [02:29<02:08, 14.33s/it]
Task 8, Epoch 12/20 => Loss 0.189, Train_accy 86.23:  55%|█████▌    | 11/20 [02:40<02:08, 14.33s/it]                 
Task 8, Epoch 12/20 => Loss 0.189, Train_accy 86.23:  60%|██████    | 12/20 [02:40<01:46, 13.37s/it]
Task 8, Epoch 13/20 => Loss 0.166, Train_accy 87.64:  60%|██████    | 12/20 [02:51<01:46, 13.37s/it]
Task 8, Epoch 13/20 => Loss 0.166, Train_accy 87.64:  65%|██████▌   | 13/20 [02:51<01:29, 12.73s/it]
Task 8, Epoch 14/20 => Loss 0.167, Train_accy 87.08:  65%|██████▌   | 13/20 [03:02<01:29, 12.73s/it]
Task 8, Epoch 14/20 => Loss 0.167, Train_accy 87.08:  70%|███████   | 14/20 [03:02<01:13, 12.29s/it]
Task 8, Epoch 15/20 => Loss 0.170, Train_accy 88.49:  70%|███████   | 14/20 [03:13<01:13, 12.29s/it]
Task 8, Epoch 15/20 => Loss 0.170, Train_accy 88.49:  75%|███████▌  | 15/20 [03:13<00:59, 11.95s/it]
Task 8, Epoch 16/20 => Loss 0.160, Train_accy 88.35, Test_accy 66.45:  75%|███████▌  | 15/20 [03:33<00:59, 11.95s/it]
Task 8, Epoch 16/20 => Loss 0.160, Train_accy 88.35, Test_accy 66.45:  80%|████████  | 16/20 [03:33<00:57, 14.28s/it]
Task 8, Epoch 17/20 => Loss 0.166, Train_accy 86.65:  80%|████████  | 16/20 [03:44<00:57, 14.28s/it]                 
Task 8, Epoch 17/20 => Loss 0.166, Train_accy 86.65:  85%|████████▌ | 17/20 [03:44<00:40, 13.35s/it]
Task 8, Epoch 18/20 => Loss 0.144, Train_accy 87.50:  85%|████████▌ | 17/20 [03:56<00:40, 13.35s/it]
Task 8, Epoch 18/20 => Loss 0.144, Train_accy 87.50:  90%|█████████ | 18/20 [03:56<00:25, 12.73s/it]
Task 8, Epoch 19/20 => Loss 0.124, Train_accy 91.10:  90%|█████████ | 18/20 [04:07<00:25, 12.73s/it]
Task 8, Epoch 19/20 => Loss 0.124, Train_accy 91.10:  95%|█████████▌| 19/20 [04:07<00:12, 12.27s/it]
Task 8, Epoch 20/20 => Loss 0.119, Train_accy 90.25:  95%|█████████▌| 19/20 [04:18<00:12, 12.27s/it]
Task 8, Epoch 20/20 => Loss 0.119, Train_accy 90.25: 100%|██████████| 20/20 [04:18<00:00, 11.94s/it]
Task 8, Epoch 20/20 => Loss 0.119, Train_accy 90.25: 100%|██████████| 20/20 [04:18<00:00, 12.92s/it]
2024-09-07 11:31:46,506 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.119, Train_accy 90.25
2024-09-07 11:31:55,131 [trainer.py] => No NME accuracy.
2024-09-07 11:31:55,131 [trainer.py] => CNN: {'total': 66.06, '00-09': 43.22, '10-19': 58.6, '20-29': 60.0, '30-39': 57.53, '40-49': 64.24, '50-59': 70.39, '60-69': 77.85, '70-79': 80.22, '80-89': 87.1, 'old': 63.45, 'new': 87.1}
2024-09-07 11:31:55,131 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06]
2024-09-07 11:31:55,131 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61]

Average Accuracy (CNN): 77.01
2024-09-07 11:31:55,132 [trainer.py] => Average Accuracy (CNN): 77.01 

2024-09-07 11:31:55,133 [trainer.py] => All params: 85867866
2024-09-07 11:31:55,134 [trainer.py] => Trainable params: 85867866
2024-09-07 11:31:55,137 [finetune.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.749, Train_accy 5.80, Test_accy 61.47:   0%|          | 0/20 [00:15<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.749, Train_accy 5.80, Test_accy 61.47:   5%|▌         | 1/20 [00:15<04:52, 15.41s/it]
Task 9, Epoch 2/20 => Loss 0.574, Train_accy 52.04:   5%|▌         | 1/20 [00:21<04:52, 15.41s/it]                
Task 9, Epoch 2/20 => Loss 0.574, Train_accy 52.04:  10%|█         | 2/20 [00:21<02:59,  9.99s/it]
Task 9, Epoch 3/20 => Loss 0.437, Train_accy 69.30:  10%|█         | 2/20 [00:27<02:59,  9.99s/it]
Task 9, Epoch 3/20 => Loss 0.437, Train_accy 69.30:  15%|█▌        | 3/20 [00:27<02:20,  8.25s/it]
Task 9, Epoch 4/20 => Loss 0.332, Train_accy 75.36:  15%|█▌        | 3/20 [00:33<02:20,  8.25s/it]
Task 9, Epoch 4/20 => Loss 0.332, Train_accy 75.36:  20%|██        | 4/20 [00:33<01:58,  7.42s/it]
Task 9, Epoch 5/20 => Loss 0.301, Train_accy 80.11:  20%|██        | 4/20 [00:40<01:58,  7.42s/it]
Task 9, Epoch 5/20 => Loss 0.301, Train_accy 80.11:  25%|██▌       | 5/20 [00:40<01:44,  6.97s/it]
Task 9, Epoch 6/20 => Loss 0.275, Train_accy 79.18, Test_accy 62.81:  25%|██▌       | 5/20 [00:55<01:44,  6.97s/it]
Task 9, Epoch 6/20 => Loss 0.275, Train_accy 79.18, Test_accy 62.81:  30%|███       | 6/20 [00:55<02:16,  9.76s/it]
Task 9, Epoch 7/20 => Loss 0.218, Train_accy 84.58:  30%|███       | 6/20 [01:01<02:16,  9.76s/it]                 
Task 9, Epoch 7/20 => Loss 0.218, Train_accy 84.58:  35%|███▌      | 7/20 [01:01<01:51,  8.59s/it]
Task 9, Epoch 8/20 => Loss 0.200, Train_accy 81.95:  35%|███▌      | 7/20 [01:07<01:51,  8.59s/it]
Task 9, Epoch 8/20 => Loss 0.200, Train_accy 81.95:  40%|████      | 8/20 [01:07<01:33,  7.83s/it]
Task 9, Epoch 9/20 => Loss 0.220, Train_accy 81.95:  40%|████      | 8/20 [01:13<01:33,  7.83s/it]
Task 9, Epoch 9/20 => Loss 0.220, Train_accy 81.95:  45%|████▌     | 9/20 [01:13<01:20,  7.31s/it]
Task 9, Epoch 10/20 => Loss 0.220, Train_accy 82.35:  45%|████▌     | 9/20 [01:20<01:20,  7.31s/it]
Task 9, Epoch 10/20 => Loss 0.220, Train_accy 82.35:  50%|█████     | 10/20 [01:20<01:09,  6.98s/it]
Task 9, Epoch 11/20 => Loss 0.148, Train_accy 86.30, Test_accy 63.75:  50%|█████     | 10/20 [01:35<01:09,  6.98s/it]
Task 9, Epoch 11/20 => Loss 0.148, Train_accy 86.30, Test_accy 63.75:  55%|█████▌    | 11/20 [01:35<01:25,  9.52s/it]
Task 9, Epoch 12/20 => Loss 0.185, Train_accy 82.74:  55%|█████▌    | 11/20 [01:41<01:25,  9.52s/it]                 
Task 9, Epoch 12/20 => Loss 0.185, Train_accy 82.74:  60%|██████    | 12/20 [01:41<01:08,  8.51s/it]
Task 9, Epoch 13/20 => Loss 0.139, Train_accy 86.30:  60%|██████    | 12/20 [01:47<01:08,  8.51s/it]
Task 9, Epoch 13/20 => Loss 0.139, Train_accy 86.30:  65%|██████▌   | 13/20 [01:47<00:54,  7.80s/it]
Task 9, Epoch 14/20 => Loss 0.138, Train_accy 84.98:  65%|██████▌   | 13/20 [01:53<00:54,  7.80s/it]
Task 9, Epoch 14/20 => Loss 0.138, Train_accy 84.98:  70%|███████   | 14/20 [01:53<00:43,  7.32s/it]
Task 9, Epoch 15/20 => Loss 0.146, Train_accy 86.03:  70%|███████   | 14/20 [02:00<00:43,  7.32s/it]
Task 9, Epoch 15/20 => Loss 0.146, Train_accy 86.03:  75%|███████▌  | 15/20 [02:00<00:34,  6.97s/it]
Task 9, Epoch 16/20 => Loss 0.156, Train_accy 87.62, Test_accy 61.98:  75%|███████▌  | 15/20 [02:15<00:34,  6.97s/it]
Task 9, Epoch 16/20 => Loss 0.156, Train_accy 87.62, Test_accy 61.98:  80%|████████  | 16/20 [02:15<00:37,  9.49s/it]
Task 9, Epoch 17/20 => Loss 0.183, Train_accy 86.30:  80%|████████  | 16/20 [02:21<00:37,  9.49s/it]                 
Task 9, Epoch 17/20 => Loss 0.183, Train_accy 86.30:  85%|████████▌ | 17/20 [02:21<00:25,  8.50s/it]
Task 9, Epoch 18/20 => Loss 0.106, Train_accy 88.41:  85%|████████▌ | 17/20 [02:27<00:25,  8.50s/it]
Task 9, Epoch 18/20 => Loss 0.106, Train_accy 88.41:  90%|█████████ | 18/20 [02:27<00:15,  7.81s/it]
Task 9, Epoch 19/20 => Loss 0.145, Train_accy 86.69:  90%|█████████ | 18/20 [02:33<00:15,  7.81s/it]
Task 9, Epoch 19/20 => Loss 0.145, Train_accy 86.69:  95%|█████████▌| 19/20 [02:33<00:07,  7.31s/it]
Task 9, Epoch 20/20 => Loss 0.144, Train_accy 87.48:  95%|█████████▌| 19/20 [02:40<00:07,  7.31s/it]
Task 9, Epoch 20/20 => Loss 0.144, Train_accy 87.48: 100%|██████████| 20/20 [02:40<00:00,  6.98s/it]
Task 9, Epoch 20/20 => Loss 0.144, Train_accy 87.48: 100%|██████████| 20/20 [02:40<00:00,  8.01s/it]
2024-09-07 11:34:35,359 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.144, Train_accy 87.48
2024-09-07 11:34:44,464 [trainer.py] => No NME accuracy.
2024-09-07 11:34:44,464 [trainer.py] => CNN: {'total': 61.34, '00-09': 34.07, '10-19': 53.76, '20-29': 58.33, '30-39': 57.83, '40-49': 57.62, '50-59': 62.5, '60-69': 71.14, '70-79': 76.92, '80-89': 76.45, '90-99': 75.14, 'old': 60.47, 'new': 75.14}
2024-09-07 11:34:44,464 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34]
2024-09-07 11:34:44,464 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35]

Average Accuracy (CNN): 75.44
2024-09-07 11:34:44,465 [trainer.py] => Average Accuracy (CNN): 75.44 

2024-09-07 11:34:44,466 [trainer.py] => All params: 85875556
2024-09-07 11:34:44,467 [trainer.py] => Trainable params: 85875556
2024-09-07 11:34:44,470 [finetune.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.261, Train_accy 20.60, Test_accy 59.01:   0%|          | 0/20 [00:19<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.261, Train_accy 20.60, Test_accy 59.01:   5%|▌         | 1/20 [00:19<06:06, 19.29s/it]
Task 10, Epoch 2/20 => Loss 0.435, Train_accy 67.01:   5%|▌         | 1/20 [00:28<06:06, 19.29s/it]                 
Task 10, Epoch 2/20 => Loss 0.435, Train_accy 67.01:  10%|█         | 2/20 [00:28<04:03, 13.52s/it]
Task 10, Epoch 3/20 => Loss 0.267, Train_accy 75.90:  10%|█         | 2/20 [00:38<04:03, 13.52s/it]
Task 10, Epoch 3/20 => Loss 0.267, Train_accy 75.90:  15%|█▌        | 3/20 [00:38<03:17, 11.61s/it]
Task 10, Epoch 4/20 => Loss 0.248, Train_accy 78.89:  15%|█▌        | 3/20 [00:47<03:17, 11.61s/it]
Task 10, Epoch 4/20 => Loss 0.248, Train_accy 78.89:  20%|██        | 4/20 [00:47<02:51, 10.70s/it]
Task 10, Epoch 5/20 => Loss 0.213, Train_accy 81.11:  20%|██        | 4/20 [00:56<02:51, 10.70s/it]
Task 10, Epoch 5/20 => Loss 0.213, Train_accy 81.11:  25%|██▌       | 5/20 [00:56<02:33, 10.24s/it]
Task 10, Epoch 6/20 => Loss 0.193, Train_accy 82.91, Test_accy 61.91:  25%|██▌       | 5/20 [01:16<02:33, 10.24s/it]
Task 10, Epoch 6/20 => Loss 0.193, Train_accy 82.91, Test_accy 61.91:  30%|███       | 6/20 [01:16<03:07, 13.40s/it]
Task 10, Epoch 7/20 => Loss 0.183, Train_accy 83.59:  30%|███       | 6/20 [01:25<03:07, 13.40s/it]                 
Task 10, Epoch 7/20 => Loss 0.183, Train_accy 83.59:  35%|███▌      | 7/20 [01:25<02:36, 12.05s/it]
Task 10, Epoch 8/20 => Loss 0.164, Train_accy 83.16:  35%|███▌      | 7/20 [01:34<02:36, 12.05s/it]
Task 10, Epoch 8/20 => Loss 0.164, Train_accy 83.16:  40%|████      | 8/20 [01:34<02:14, 11.18s/it]
Task 10, Epoch 9/20 => Loss 0.184, Train_accy 82.99:  40%|████      | 8/20 [01:44<02:14, 11.18s/it]
Task 10, Epoch 9/20 => Loss 0.184, Train_accy 82.99:  45%|████▌     | 9/20 [01:44<01:56, 10.60s/it]
Task 10, Epoch 10/20 => Loss 0.160, Train_accy 86.24:  45%|████▌     | 9/20 [01:53<01:56, 10.60s/it]
Task 10, Epoch 10/20 => Loss 0.160, Train_accy 86.24:  50%|█████     | 10/20 [01:53<01:41, 10.19s/it]
Task 10, Epoch 11/20 => Loss 0.177, Train_accy 85.13, Test_accy 59.59:  50%|█████     | 10/20 [02:12<01:41, 10.19s/it]
Task 10, Epoch 11/20 => Loss 0.177, Train_accy 85.13, Test_accy 59.59:  55%|█████▌    | 11/20 [02:12<01:57, 13.02s/it]
Task 10, Epoch 12/20 => Loss 0.152, Train_accy 84.10:  55%|█████▌    | 11/20 [02:22<01:57, 13.02s/it]                 
Task 10, Epoch 12/20 => Loss 0.152, Train_accy 84.10:  60%|██████    | 12/20 [02:22<01:35, 11.96s/it]
Task 10, Epoch 13/20 => Loss 0.149, Train_accy 87.26:  60%|██████    | 12/20 [02:31<01:35, 11.96s/it]
Task 10, Epoch 13/20 => Loss 0.149, Train_accy 87.26:  65%|██████▌   | 13/20 [02:31<01:18, 11.16s/it]
Task 10, Epoch 14/20 => Loss 0.158, Train_accy 87.78:  65%|██████▌   | 13/20 [02:41<01:18, 11.16s/it]
Task 10, Epoch 14/20 => Loss 0.158, Train_accy 87.78:  70%|███████   | 14/20 [02:41<01:03, 10.59s/it]
Task 10, Epoch 15/20 => Loss 0.107, Train_accy 89.06:  70%|███████   | 14/20 [02:50<01:03, 10.59s/it]
Task 10, Epoch 15/20 => Loss 0.107, Train_accy 89.06:  75%|███████▌  | 15/20 [02:50<00:51, 10.23s/it]
Task 10, Epoch 16/20 => Loss 0.129, Train_accy 88.80, Test_accy 60.14:  75%|███████▌  | 15/20 [03:09<00:51, 10.23s/it]
Task 10, Epoch 16/20 => Loss 0.129, Train_accy 88.80, Test_accy 60.14:  80%|████████  | 16/20 [03:09<00:51, 12.98s/it]
Task 10, Epoch 17/20 => Loss 0.120, Train_accy 88.03:  80%|████████  | 16/20 [03:19<00:51, 12.98s/it]                 
Task 10, Epoch 17/20 => Loss 0.120, Train_accy 88.03:  85%|████████▌ | 17/20 [03:19<00:35, 11.89s/it]
Task 10, Epoch 18/20 => Loss 0.102, Train_accy 90.34:  85%|████████▌ | 17/20 [03:28<00:35, 11.89s/it]
Task 10, Epoch 18/20 => Loss 0.102, Train_accy 90.34:  90%|█████████ | 18/20 [03:28<00:22, 11.11s/it]
Task 10, Epoch 19/20 => Loss 0.148, Train_accy 88.97:  90%|█████████ | 18/20 [03:37<00:22, 11.11s/it]
Task 10, Epoch 19/20 => Loss 0.148, Train_accy 88.97:  95%|█████████▌| 19/20 [03:37<00:10, 10.58s/it]
Task 10, Epoch 20/20 => Loss 0.129, Train_accy 88.29:  95%|█████████▌| 19/20 [03:47<00:10, 10.58s/it]
Task 10, Epoch 20/20 => Loss 0.129, Train_accy 88.29: 100%|██████████| 20/20 [03:47<00:00, 10.22s/it]
Task 10, Epoch 20/20 => Loss 0.129, Train_accy 88.29: 100%|██████████| 20/20 [03:47<00:00, 11.36s/it]
2024-09-07 11:38:31,722 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.129, Train_accy 88.29
2024-09-07 11:38:41,503 [trainer.py] => No NME accuracy.
2024-09-07 11:38:41,503 [trainer.py] => CNN: {'total': 62.01, '00-09': 33.75, '10-19': 51.08, '20-29': 56.0, '30-39': 61.45, '40-49': 56.29, '50-59': 65.46, '60-69': 67.11, '70-79': 70.7, '80-89': 72.9, '90-99': 68.93, '100-109': 87.32, 'old': 59.6, 'new': 87.32}
2024-09-07 11:38:41,503 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01]
2024-09-07 11:38:41,503 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96]

Average Accuracy (CNN): 74.22
2024-09-07 11:38:41,503 [trainer.py] => Average Accuracy (CNN): 74.22 

2024-09-07 11:38:41,504 [trainer.py] => All params: 85883246
2024-09-07 11:38:41,504 [trainer.py] => Trainable params: 85883246
2024-09-07 11:38:41,506 [finetune.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.989, Train_accy 32.64, Test_accy 60.30:   0%|          | 0/20 [00:22<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.989, Train_accy 32.64, Test_accy 60.30:   5%|▌         | 1/20 [00:22<07:12, 22.76s/it]
Task 11, Epoch 2/20 => Loss 0.394, Train_accy 68.63:   5%|▌         | 1/20 [00:34<07:12, 22.76s/it]                 
Task 11, Epoch 2/20 => Loss 0.394, Train_accy 68.63:  10%|█         | 2/20 [00:34<04:53, 16.33s/it]
Task 11, Epoch 3/20 => Loss 0.317, Train_accy 74.18:  10%|█         | 2/20 [00:46<04:53, 16.33s/it]
Task 11, Epoch 3/20 => Loss 0.317, Train_accy 74.18:  15%|█▌        | 3/20 [00:46<04:02, 14.26s/it]
Task 11, Epoch 4/20 => Loss 0.257, Train_accy 79.20:  15%|█▌        | 3/20 [00:58<04:02, 14.26s/it]
Task 11, Epoch 4/20 => Loss 0.257, Train_accy 79.20:  20%|██        | 4/20 [00:58<03:32, 13.28s/it]
Task 11, Epoch 5/20 => Loss 0.176, Train_accy 82.07:  20%|██        | 4/20 [01:09<03:32, 13.28s/it]
Task 11, Epoch 5/20 => Loss 0.176, Train_accy 82.07:  25%|██▌       | 5/20 [01:09<03:11, 12.75s/it]
Task 11, Epoch 6/20 => Loss 0.228, Train_accy 81.34, Test_accy 61.40:  25%|██▌       | 5/20 [01:32<03:11, 12.75s/it]
Task 11, Epoch 6/20 => Loss 0.228, Train_accy 81.34, Test_accy 61.40:  30%|███       | 6/20 [01:32<03:45, 16.13s/it]
Task 11, Epoch 7/20 => Loss 0.169, Train_accy 83.61:  30%|███       | 6/20 [01:44<03:45, 16.13s/it]                 
Task 11, Epoch 7/20 => Loss 0.169, Train_accy 83.61:  35%|███▌      | 7/20 [01:44<03:11, 14.72s/it]
Task 11, Epoch 8/20 => Loss 0.209, Train_accy 84.28:  35%|███▌      | 7/20 [01:56<03:11, 14.72s/it]
Task 11, Epoch 8/20 => Loss 0.209, Train_accy 84.28:  40%|████      | 8/20 [01:56<02:45, 13.81s/it]
Task 11, Epoch 9/20 => Loss 0.186, Train_accy 85.42:  40%|████      | 8/20 [02:08<02:45, 13.81s/it]
Task 11, Epoch 9/20 => Loss 0.186, Train_accy 85.42:  45%|████▌     | 9/20 [02:08<02:25, 13.19s/it]
Task 11, Epoch 10/20 => Loss 0.171, Train_accy 86.29:  45%|████▌     | 9/20 [02:19<02:25, 13.19s/it]
Task 11, Epoch 10/20 => Loss 0.171, Train_accy 86.29:  50%|█████     | 10/20 [02:19<02:07, 12.75s/it]
Task 11, Epoch 11/20 => Loss 0.166, Train_accy 86.15, Test_accy 60.25:  50%|█████     | 10/20 [02:42<02:07, 12.75s/it]
Task 11, Epoch 11/20 => Loss 0.166, Train_accy 86.15, Test_accy 60.25:  55%|█████▌    | 11/20 [02:42<02:22, 15.83s/it]
Task 11, Epoch 12/20 => Loss 0.161, Train_accy 85.69:  55%|█████▌    | 11/20 [02:54<02:22, 15.83s/it]                 
Task 11, Epoch 12/20 => Loss 0.161, Train_accy 85.69:  60%|██████    | 12/20 [02:54<01:56, 14.61s/it]
Task 11, Epoch 13/20 => Loss 0.142, Train_accy 87.63:  60%|██████    | 12/20 [03:06<01:56, 14.61s/it]
Task 11, Epoch 13/20 => Loss 0.142, Train_accy 87.63:  65%|██████▌   | 13/20 [03:06<01:36, 13.75s/it]
Task 11, Epoch 14/20 => Loss 0.180, Train_accy 87.76:  65%|██████▌   | 13/20 [03:18<01:36, 13.75s/it]
Task 11, Epoch 14/20 => Loss 0.180, Train_accy 87.76:  70%|███████   | 14/20 [03:18<01:18, 13.16s/it]
Task 11, Epoch 15/20 => Loss 0.162, Train_accy 88.70:  70%|███████   | 14/20 [03:29<01:18, 13.16s/it]
Task 11, Epoch 15/20 => Loss 0.162, Train_accy 88.70:  75%|███████▌  | 15/20 [03:29<01:03, 12.75s/it]
Task 11, Epoch 16/20 => Loss 0.138, Train_accy 89.03, Test_accy 59.62:  75%|███████▌  | 15/20 [03:52<01:03, 12.75s/it]
Task 11, Epoch 16/20 => Loss 0.138, Train_accy 89.03, Test_accy 59.62:  80%|████████  | 16/20 [03:52<01:03, 15.78s/it]
Task 11, Epoch 17/20 => Loss 0.154, Train_accy 88.90:  80%|████████  | 16/20 [04:04<01:03, 15.78s/it]                 
Task 11, Epoch 17/20 => Loss 0.154, Train_accy 88.90:  85%|████████▌ | 17/20 [04:04<00:43, 14.58s/it]
Task 11, Epoch 18/20 => Loss 0.118, Train_accy 91.04:  85%|████████▌ | 17/20 [04:16<00:43, 14.58s/it]
Task 11, Epoch 18/20 => Loss 0.118, Train_accy 91.04:  90%|█████████ | 18/20 [04:16<00:27, 13.73s/it]
Task 11, Epoch 19/20 => Loss 0.152, Train_accy 88.36:  90%|█████████ | 18/20 [04:28<00:27, 13.73s/it]
Task 11, Epoch 19/20 => Loss 0.152, Train_accy 88.36:  95%|█████████▌| 19/20 [04:28<00:13, 13.14s/it]
Task 11, Epoch 20/20 => Loss 0.125, Train_accy 90.17:  95%|█████████▌| 19/20 [04:39<00:13, 13.14s/it]
Task 11, Epoch 20/20 => Loss 0.125, Train_accy 90.17: 100%|██████████| 20/20 [04:39<00:00, 12.72s/it]
Task 11, Epoch 20/20 => Loss 0.125, Train_accy 90.17: 100%|██████████| 20/20 [04:39<00:00, 13.99s/it]
2024-09-07 11:43:21,320 [finetune.py] => Task 11, Epoch 20/20 => Loss 0.125, Train_accy 90.17
2024-09-07 11:43:32,423 [trainer.py] => No NME accuracy.
2024-09-07 11:43:32,424 [trainer.py] => CNN: {'total': 59.64, '00-09': 23.34, '10-19': 44.62, '20-29': 56.33, '30-39': 51.81, '40-49': 58.28, '50-59': 62.17, '60-69': 62.42, '70-79': 64.47, '80-89': 70.97, '90-99': 62.71, '100-109': 70.77, '110-119': 88.83, 'old': 56.29, 'new': 88.83}
2024-09-07 11:43:32,424 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64]
2024-09-07 11:43:32,424 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43]

Average Accuracy (CNN): 73.01
2024-09-07 11:43:32,424 [trainer.py] => Average Accuracy (CNN): 73.01 

2024-09-07 11:43:32,426 [trainer.py] => All params: 85890936
2024-09-07 11:43:32,427 [trainer.py] => Trainable params: 85890936
2024-09-07 11:43:32,430 [finetune.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.457, Train_accy 16.22, Test_accy 56.08:   0%|          | 0/20 [00:19<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.457, Train_accy 16.22, Test_accy 56.08:   5%|▌         | 1/20 [00:19<06:12, 19.62s/it]
Task 12, Epoch 2/20 => Loss 0.435, Train_accy 61.47:   5%|▌         | 1/20 [00:27<06:12, 19.62s/it]                 
Task 12, Epoch 2/20 => Loss 0.435, Train_accy 61.47:  10%|█         | 2/20 [00:27<03:48, 12.71s/it]
Task 12, Epoch 3/20 => Loss 0.341, Train_accy 71.07:  10%|█         | 2/20 [00:35<03:48, 12.71s/it]
Task 12, Epoch 3/20 => Loss 0.341, Train_accy 71.07:  15%|█▌        | 3/20 [00:35<02:57, 10.46s/it]
Task 12, Epoch 4/20 => Loss 0.330, Train_accy 72.42:  15%|█▌        | 3/20 [00:43<02:57, 10.46s/it]
Task 12, Epoch 4/20 => Loss 0.330, Train_accy 72.42:  20%|██        | 4/20 [00:43<02:30,  9.39s/it]
Task 12, Epoch 5/20 => Loss 0.267, Train_accy 74.90:  20%|██        | 4/20 [00:50<02:30,  9.39s/it]
Task 12, Epoch 5/20 => Loss 0.267, Train_accy 74.90:  25%|██▌       | 5/20 [00:50<02:11,  8.80s/it]
Task 12, Epoch 6/20 => Loss 0.171, Train_accy 81.40, Test_accy 57.02:  25%|██▌       | 5/20 [01:10<02:11,  8.80s/it]
Task 12, Epoch 6/20 => Loss 0.171, Train_accy 81.40, Test_accy 57.02:  30%|███       | 6/20 [01:10<02:53, 12.38s/it]
Task 12, Epoch 7/20 => Loss 0.181, Train_accy 83.06:  30%|███       | 6/20 [01:17<02:53, 12.38s/it]                 
Task 12, Epoch 7/20 => Loss 0.181, Train_accy 83.06:  35%|███▌      | 7/20 [01:17<02:21, 10.87s/it]
Task 12, Epoch 8/20 => Loss 0.162, Train_accy 84.09:  35%|███▌      | 7/20 [01:25<02:21, 10.87s/it]
Task 12, Epoch 8/20 => Loss 0.162, Train_accy 84.09:  40%|████      | 8/20 [01:25<01:59,  9.92s/it]
Task 12, Epoch 9/20 => Loss 0.162, Train_accy 83.57:  40%|████      | 8/20 [01:33<01:59,  9.92s/it]
Task 12, Epoch 9/20 => Loss 0.162, Train_accy 83.57:  45%|████▌     | 9/20 [01:33<01:41,  9.24s/it]
Task 12, Epoch 10/20 => Loss 0.174, Train_accy 85.23:  45%|████▌     | 9/20 [01:41<01:41,  9.24s/it]
Task 12, Epoch 10/20 => Loss 0.174, Train_accy 85.23:  50%|█████     | 10/20 [01:41<01:27,  8.80s/it]
Task 12, Epoch 11/20 => Loss 0.164, Train_accy 86.16, Test_accy 57.38:  50%|█████     | 10/20 [02:00<01:27,  8.80s/it]
Task 12, Epoch 11/20 => Loss 0.164, Train_accy 86.16, Test_accy 57.38:  55%|█████▌    | 11/20 [02:00<01:49, 12.11s/it]
Task 12, Epoch 12/20 => Loss 0.106, Train_accy 87.50:  55%|█████▌    | 11/20 [02:08<01:49, 12.11s/it]                 
Task 12, Epoch 12/20 => Loss 0.106, Train_accy 87.50:  60%|██████    | 12/20 [02:08<01:26, 10.79s/it]
Task 12, Epoch 13/20 => Loss 0.102, Train_accy 87.29:  60%|██████    | 12/20 [02:16<01:26, 10.79s/it]
Task 12, Epoch 13/20 => Loss 0.102, Train_accy 87.29:  65%|██████▌   | 13/20 [02:16<01:09,  9.88s/it]
Task 12, Epoch 14/20 => Loss 0.109, Train_accy 86.05:  65%|██████▌   | 13/20 [02:24<01:09,  9.88s/it]
Task 12, Epoch 14/20 => Loss 0.109, Train_accy 86.05:  70%|███████   | 14/20 [02:24<00:55,  9.23s/it]
Task 12, Epoch 15/20 => Loss 0.104, Train_accy 86.78:  70%|███████   | 14/20 [02:32<00:55,  9.23s/it]
Task 12, Epoch 15/20 => Loss 0.104, Train_accy 86.78:  75%|███████▌  | 15/20 [02:32<00:44,  8.80s/it]
Task 12, Epoch 16/20 => Loss 0.123, Train_accy 88.53, Test_accy 56.66:  75%|███████▌  | 15/20 [02:51<00:44,  8.80s/it]
Task 12, Epoch 16/20 => Loss 0.123, Train_accy 88.53, Test_accy 56.66:  80%|████████  | 16/20 [02:51<00:48, 12.05s/it]
Task 12, Epoch 17/20 => Loss 0.124, Train_accy 88.84:  80%|████████  | 16/20 [02:59<00:48, 12.05s/it]                 
Task 12, Epoch 17/20 => Loss 0.124, Train_accy 88.84:  85%|████████▌ | 17/20 [02:59<00:32, 10.76s/it]
Task 12, Epoch 18/20 => Loss 0.089, Train_accy 89.57:  85%|████████▌ | 17/20 [03:07<00:32, 10.76s/it]
Task 12, Epoch 18/20 => Loss 0.089, Train_accy 89.57:  90%|█████████ | 18/20 [03:07<00:19,  9.85s/it]
Task 12, Epoch 19/20 => Loss 0.123, Train_accy 88.64:  90%|█████████ | 18/20 [03:14<00:19,  9.85s/it]
Task 12, Epoch 19/20 => Loss 0.123, Train_accy 88.64:  95%|█████████▌| 19/20 [03:14<00:09,  9.23s/it]
Task 12, Epoch 20/20 => Loss 0.108, Train_accy 90.39:  95%|█████████▌| 19/20 [03:22<00:09,  9.23s/it]
Task 12, Epoch 20/20 => Loss 0.108, Train_accy 90.39: 100%|██████████| 20/20 [03:22<00:00,  8.79s/it]
Task 12, Epoch 20/20 => Loss 0.108, Train_accy 90.39: 100%|██████████| 20/20 [03:22<00:00, 10.13s/it]
2024-09-07 11:46:55,099 [finetune.py] => Task 12, Epoch 20/20 => Loss 0.108, Train_accy 90.39
2024-09-07 11:47:06,784 [trainer.py] => No NME accuracy.
2024-09-07 11:47:06,784 [trainer.py] => CNN: {'total': 55.11, '00-09': 16.09, '10-19': 43.82, '20-29': 41.0, '30-39': 45.48, '40-49': 45.7, '50-59': 56.91, '60-69': 57.05, '70-79': 63.0, '80-89': 64.19, '90-99': 59.32, '100-109': 71.13, '110-119': 76.86, '120-129': 81.92, 'old': 53.11, 'new': 81.92}
2024-09-07 11:47:06,785 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11]
2024-09-07 11:47:06,785 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46]

Average Accuracy (CNN): 71.63
2024-09-07 11:47:06,785 [trainer.py] => Average Accuracy (CNN): 71.63 

2024-09-07 11:47:06,786 [trainer.py] => All params: 85898626
2024-09-07 11:47:06,787 [trainer.py] => Trainable params: 85898626
2024-09-07 11:47:06,790 [finetune.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.156, Train_accy 21.37, Test_accy 53.82:   0%|          | 0/20 [00:21<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.156, Train_accy 21.37, Test_accy 53.82:   5%|▌         | 1/20 [00:21<06:54, 21.80s/it]
Task 13, Epoch 2/20 => Loss 0.485, Train_accy 61.33:   5%|▌         | 1/20 [00:31<06:54, 21.80s/it]                 
Task 13, Epoch 2/20 => Loss 0.485, Train_accy 61.33:  10%|█         | 2/20 [00:31<04:19, 14.39s/it]
Task 13, Epoch 3/20 => Loss 0.358, Train_accy 69.64:  10%|█         | 2/20 [00:40<04:19, 14.39s/it]
Task 13, Epoch 3/20 => Loss 0.358, Train_accy 69.64:  15%|█▌        | 3/20 [00:40<03:24, 12.04s/it]
Task 13, Epoch 4/20 => Loss 0.233, Train_accy 78.46:  15%|█▌        | 3/20 [00:49<03:24, 12.04s/it]
Task 13, Epoch 4/20 => Loss 0.233, Train_accy 78.46:  20%|██        | 4/20 [00:49<02:54, 10.92s/it]
Task 13, Epoch 5/20 => Loss 0.261, Train_accy 79.07:  20%|██        | 4/20 [00:58<02:54, 10.92s/it]
Task 13, Epoch 5/20 => Loss 0.261, Train_accy 79.07:  25%|██▌       | 5/20 [00:58<02:34, 10.32s/it]
Task 13, Epoch 6/20 => Loss 0.233, Train_accy 80.45, Test_accy 55.51:  25%|██▌       | 5/20 [01:20<02:34, 10.32s/it]
Task 13, Epoch 6/20 => Loss 0.233, Train_accy 80.45, Test_accy 55.51:  30%|███       | 6/20 [01:20<03:19, 14.24s/it]
Task 13, Epoch 7/20 => Loss 0.184, Train_accy 83.22:  30%|███       | 6/20 [01:29<03:19, 14.24s/it]                 
Task 13, Epoch 7/20 => Loss 0.184, Train_accy 83.22:  35%|███▌      | 7/20 [01:29<02:44, 12.62s/it]
Task 13, Epoch 8/20 => Loss 0.159, Train_accy 86.07:  35%|███▌      | 7/20 [01:39<02:44, 12.62s/it]
Task 13, Epoch 8/20 => Loss 0.159, Train_accy 86.07:  40%|████      | 8/20 [01:39<02:18, 11.53s/it]
Task 13, Epoch 9/20 => Loss 0.156, Train_accy 86.16:  40%|████      | 8/20 [01:48<02:18, 11.53s/it]
Task 13, Epoch 9/20 => Loss 0.156, Train_accy 86.16:  45%|████▌     | 9/20 [01:48<01:59, 10.83s/it]
Task 13, Epoch 10/20 => Loss 0.205, Train_accy 83.56:  45%|████▌     | 9/20 [01:57<01:59, 10.83s/it]
Task 13, Epoch 10/20 => Loss 0.205, Train_accy 83.56:  50%|█████     | 10/20 [01:57<01:43, 10.32s/it]
Task 13, Epoch 11/20 => Loss 0.185, Train_accy 85.03, Test_accy 54.15:  50%|█████     | 10/20 [02:19<01:43, 10.32s/it]
Task 13, Epoch 11/20 => Loss 0.185, Train_accy 85.03, Test_accy 54.15:  55%|█████▌    | 11/20 [02:19<02:04, 13.86s/it]
Task 13, Epoch 12/20 => Loss 0.171, Train_accy 86.59:  55%|█████▌    | 11/20 [02:28<02:04, 13.86s/it]                 
Task 13, Epoch 12/20 => Loss 0.171, Train_accy 86.59:  60%|██████    | 12/20 [02:28<01:39, 12.48s/it]
Task 13, Epoch 13/20 => Loss 0.160, Train_accy 85.64:  60%|██████    | 12/20 [02:37<01:39, 12.48s/it]
Task 13, Epoch 13/20 => Loss 0.160, Train_accy 85.64:  65%|██████▌   | 13/20 [02:37<01:20, 11.49s/it]
Task 13, Epoch 14/20 => Loss 0.127, Train_accy 89.62:  65%|██████▌   | 13/20 [02:47<01:20, 11.49s/it]
Task 13, Epoch 14/20 => Loss 0.127, Train_accy 89.62:  70%|███████   | 14/20 [02:47<01:04, 10.81s/it]
Task 13, Epoch 15/20 => Loss 0.136, Train_accy 87.63:  70%|███████   | 14/20 [02:56<01:04, 10.81s/it]
Task 13, Epoch 15/20 => Loss 0.136, Train_accy 87.63:  75%|███████▌  | 15/20 [02:56<00:51, 10.32s/it]
Task 13, Epoch 16/20 => Loss 0.127, Train_accy 89.10, Test_accy 53.75:  75%|███████▌  | 15/20 [03:18<00:51, 10.32s/it]
Task 13, Epoch 16/20 => Loss 0.127, Train_accy 89.10, Test_accy 53.75:  80%|████████  | 16/20 [03:18<00:55, 13.80s/it]
Task 13, Epoch 17/20 => Loss 0.143, Train_accy 88.67:  80%|████████  | 16/20 [03:27<00:55, 13.80s/it]                 
Task 13, Epoch 17/20 => Loss 0.143, Train_accy 88.67:  85%|████████▌ | 17/20 [03:27<00:37, 12.43s/it]
Task 13, Epoch 18/20 => Loss 0.095, Train_accy 89.01:  85%|████████▌ | 17/20 [03:36<00:37, 12.43s/it]
Task 13, Epoch 18/20 => Loss 0.095, Train_accy 89.01:  90%|█████████ | 18/20 [03:36<00:22, 11.46s/it]
Task 13, Epoch 19/20 => Loss 0.095, Train_accy 91.18:  90%|█████████ | 18/20 [03:45<00:22, 11.46s/it]
Task 13, Epoch 19/20 => Loss 0.095, Train_accy 91.18:  95%|█████████▌| 19/20 [03:45<00:10, 10.77s/it]
Task 13, Epoch 20/20 => Loss 0.084, Train_accy 92.47:  95%|█████████▌| 19/20 [03:55<00:10, 10.77s/it]
Task 13, Epoch 20/20 => Loss 0.084, Train_accy 92.47: 100%|██████████| 20/20 [03:55<00:00, 10.30s/it]
Task 13, Epoch 20/20 => Loss 0.084, Train_accy 92.47: 100%|██████████| 20/20 [03:55<00:00, 11.75s/it]
2024-09-07 11:51:01,854 [finetune.py] => Task 13, Epoch 20/20 => Loss 0.084, Train_accy 92.47
2024-09-07 11:51:14,440 [trainer.py] => No NME accuracy.
2024-09-07 11:51:14,441 [trainer.py] => CNN: {'total': 54.65, '00-09': 13.25, '10-19': 41.67, '20-29': 46.33, '30-39': 42.47, '40-49': 47.02, '50-59': 57.24, '60-69': 51.34, '70-79': 56.04, '80-89': 59.03, '90-99': 59.89, '100-109': 69.01, '110-119': 73.67, '120-129': 66.79, '130-139': 87.58, 'old': 52.15, 'new': 87.58}
2024-09-07 11:51:14,441 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11, 54.65]
2024-09-07 11:51:14,441 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46, 79.83]

Average Accuracy (CNN): 70.42
2024-09-07 11:51:14,441 [trainer.py] => Average Accuracy (CNN): 70.42 

2024-09-07 11:51:14,442 [trainer.py] => All params: 85906316
2024-09-07 11:51:14,443 [trainer.py] => Trainable params: 85906316
2024-09-07 11:51:14,446 [finetune.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.028, Train_accy 22.05, Test_accy 52.87:   0%|          | 0/20 [00:24<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.028, Train_accy 22.05, Test_accy 52.87:   5%|▌         | 1/20 [00:24<07:54, 25.00s/it]
Task 14, Epoch 2/20 => Loss 0.300, Train_accy 65.23:   5%|▌         | 1/20 [00:36<07:54, 25.00s/it]                 
Task 14, Epoch 2/20 => Loss 0.300, Train_accy 65.23:  10%|█         | 2/20 [00:36<05:03, 16.86s/it]
Task 14, Epoch 3/20 => Loss 0.205, Train_accy 76.25:  10%|█         | 2/20 [00:47<05:03, 16.86s/it]
Task 14, Epoch 3/20 => Loss 0.205, Train_accy 76.25:  15%|█▌        | 3/20 [00:47<04:02, 14.27s/it]
Task 14, Epoch 4/20 => Loss 0.207, Train_accy 77.74:  15%|█▌        | 3/20 [00:58<04:02, 14.27s/it]
Task 14, Epoch 4/20 => Loss 0.207, Train_accy 77.74:  20%|██        | 4/20 [00:58<03:29, 13.08s/it]
Task 14, Epoch 5/20 => Loss 0.192, Train_accy 79.43:  20%|██        | 4/20 [01:09<03:29, 13.08s/it]
Task 14, Epoch 5/20 => Loss 0.192, Train_accy 79.43:  25%|██▌       | 5/20 [01:09<03:06, 12.40s/it]
Task 14, Epoch 6/20 => Loss 0.236, Train_accy 75.41, Test_accy 54.11:  25%|██▌       | 5/20 [01:34<03:06, 12.40s/it]
Task 14, Epoch 6/20 => Loss 0.236, Train_accy 75.41, Test_accy 54.11:  30%|███       | 6/20 [01:34<03:53, 16.67s/it]
Task 14, Epoch 7/20 => Loss 0.148, Train_accy 79.58:  30%|███       | 6/20 [01:46<03:53, 16.67s/it]                 
Task 14, Epoch 7/20 => Loss 0.148, Train_accy 79.58:  35%|███▌      | 7/20 [01:46<03:13, 14.91s/it]
Task 14, Epoch 8/20 => Loss 0.180, Train_accy 80.78:  35%|███▌      | 7/20 [01:57<03:13, 14.91s/it]
Task 14, Epoch 8/20 => Loss 0.180, Train_accy 80.78:  40%|████      | 8/20 [01:57<02:45, 13.75s/it]
Task 14, Epoch 9/20 => Loss 0.174, Train_accy 81.06:  40%|████      | 8/20 [02:08<02:45, 13.75s/it]
Task 14, Epoch 9/20 => Loss 0.174, Train_accy 81.06:  45%|████▌     | 9/20 [02:08<02:22, 12.96s/it]
Task 14, Epoch 10/20 => Loss 0.155, Train_accy 84.38:  45%|████▌     | 9/20 [02:19<02:22, 12.96s/it]
Task 14, Epoch 10/20 => Loss 0.155, Train_accy 84.38:  50%|█████     | 10/20 [02:19<02:04, 12.43s/it]
Task 14, Epoch 11/20 => Loss 0.121, Train_accy 85.65, Test_accy 52.87:  50%|█████     | 10/20 [02:44<02:04, 12.43s/it]
Task 14, Epoch 11/20 => Loss 0.121, Train_accy 85.65, Test_accy 52.87:  55%|█████▌    | 11/20 [02:44<02:26, 16.23s/it]
Task 14, Epoch 12/20 => Loss 0.189, Train_accy 83.25:  55%|█████▌    | 11/20 [02:55<02:26, 16.23s/it]                 
Task 14, Epoch 12/20 => Loss 0.189, Train_accy 83.25:  60%|██████    | 12/20 [02:55<01:57, 14.70s/it]
Task 14, Epoch 13/20 => Loss 0.147, Train_accy 86.71:  60%|██████    | 12/20 [03:07<01:57, 14.70s/it]
Task 14, Epoch 13/20 => Loss 0.147, Train_accy 86.71:  65%|██████▌   | 13/20 [03:07<01:35, 13.63s/it]
Task 14, Epoch 14/20 => Loss 0.127, Train_accy 85.94:  65%|██████▌   | 13/20 [03:18<01:35, 13.63s/it]
Task 14, Epoch 14/20 => Loss 0.127, Train_accy 85.94:  70%|███████   | 14/20 [03:18<01:17, 12.90s/it]
Task 14, Epoch 15/20 => Loss 0.125, Train_accy 86.22:  70%|███████   | 14/20 [03:29<01:17, 12.90s/it]
Task 14, Epoch 15/20 => Loss 0.125, Train_accy 86.22:  75%|███████▌  | 15/20 [03:29<01:01, 12.38s/it]
Task 14, Epoch 16/20 => Loss 0.123, Train_accy 86.50, Test_accy 53.31:  75%|███████▌  | 15/20 [03:54<01:01, 12.38s/it]
Task 14, Epoch 16/20 => Loss 0.123, Train_accy 86.50, Test_accy 53.31:  80%|████████  | 16/20 [03:54<01:04, 16.17s/it]
Task 14, Epoch 17/20 => Loss 0.123, Train_accy 88.13:  80%|████████  | 16/20 [04:05<01:04, 16.17s/it]                 
Task 14, Epoch 17/20 => Loss 0.123, Train_accy 88.13:  85%|████████▌ | 17/20 [04:05<00:43, 14.66s/it]
Task 14, Epoch 18/20 => Loss 0.107, Train_accy 88.13:  85%|████████▌ | 17/20 [04:16<00:43, 14.66s/it]
Task 14, Epoch 18/20 => Loss 0.107, Train_accy 88.13:  90%|█████████ | 18/20 [04:16<00:27, 13.63s/it]
Task 14, Epoch 19/20 => Loss 0.130, Train_accy 87.28:  90%|█████████ | 18/20 [04:27<00:27, 13.63s/it]
Task 14, Epoch 19/20 => Loss 0.130, Train_accy 87.28:  95%|█████████▌| 19/20 [04:27<00:12, 12.91s/it]
Task 14, Epoch 20/20 => Loss 0.129, Train_accy 88.55:  95%|█████████▌| 19/20 [04:39<00:12, 12.91s/it]
Task 14, Epoch 20/20 => Loss 0.129, Train_accy 88.55: 100%|██████████| 20/20 [04:39<00:00, 12.40s/it]
Task 14, Epoch 20/20 => Loss 0.129, Train_accy 88.55: 100%|██████████| 20/20 [04:39<00:00, 13.96s/it]
2024-09-07 11:55:53,650 [finetune.py] => Task 14, Epoch 20/20 => Loss 0.129, Train_accy 88.55
2024-09-07 11:56:07,255 [trainer.py] => No NME accuracy.
2024-09-07 11:56:07,256 [trainer.py] => CNN: {'total': 52.61, '00-09': 10.41, '10-19': 40.05, '20-29': 42.33, '30-39': 40.06, '40-49': 44.7, '50-59': 52.3, '60-69': 46.98, '70-79': 45.79, '80-89': 56.45, '90-99': 54.24, '100-109': 54.23, '110-119': 63.83, '120-129': 64.21, '130-139': 78.52, '140-149': 91.55, 'old': 49.22, 'new': 91.55}
2024-09-07 11:56:07,256 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11, 54.65, 52.61]
2024-09-07 11:56:07,256 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46, 79.83, 78.67]

Average Accuracy (CNN): 69.23
2024-09-07 11:56:07,256 [trainer.py] => Average Accuracy (CNN): 69.23 

2024-09-07 11:56:07,258 [trainer.py] => All params: 85914006
2024-09-07 11:56:07,259 [trainer.py] => Trainable params: 85914006
2024-09-07 11:56:07,262 [finetune.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.182, Train_accy 23.27, Test_accy 49.38:   0%|          | 0/20 [00:26<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.182, Train_accy 23.27, Test_accy 49.38:   5%|▌         | 1/20 [00:26<08:14, 26.01s/it]
Task 15, Epoch 2/20 => Loss 0.427, Train_accy 62.10:   5%|▌         | 1/20 [00:37<08:14, 26.01s/it]                 
Task 15, Epoch 2/20 => Loss 0.427, Train_accy 62.10:  10%|█         | 2/20 [00:37<05:10, 17.23s/it]
Task 15, Epoch 3/20 => Loss 0.328, Train_accy 72.31:  10%|█         | 2/20 [00:48<05:10, 17.23s/it]
Task 15, Epoch 3/20 => Loss 0.328, Train_accy 72.31:  15%|█▌        | 3/20 [00:48<04:04, 14.40s/it]
Task 15, Epoch 4/20 => Loss 0.257, Train_accy 75.16:  15%|█▌        | 3/20 [00:59<04:04, 14.40s/it]
Task 15, Epoch 4/20 => Loss 0.257, Train_accy 75.16:  20%|██        | 4/20 [00:59<03:29, 13.07s/it]
Task 15, Epoch 5/20 => Loss 0.303, Train_accy 73.30:  20%|██        | 4/20 [01:10<03:29, 13.07s/it]
Task 15, Epoch 5/20 => Loss 0.303, Train_accy 73.30:  25%|██▌       | 5/20 [01:10<03:05, 12.34s/it]
Task 15, Epoch 6/20 => Loss 0.231, Train_accy 77.44, Test_accy 51.57:  25%|██▌       | 5/20 [01:35<03:05, 12.34s/it]
Task 15, Epoch 6/20 => Loss 0.231, Train_accy 77.44, Test_accy 51.57:  30%|███       | 6/20 [01:35<03:56, 16.89s/it]
Task 15, Epoch 7/20 => Loss 0.223, Train_accy 79.51:  30%|███       | 6/20 [01:47<03:56, 16.89s/it]                 
Task 15, Epoch 7/20 => Loss 0.223, Train_accy 79.51:  35%|███▌      | 7/20 [01:47<03:14, 15.00s/it]
Task 15, Epoch 8/20 => Loss 0.184, Train_accy 81.51:  35%|███▌      | 7/20 [01:58<03:14, 15.00s/it]
Task 15, Epoch 8/20 => Loss 0.184, Train_accy 81.51:  40%|████      | 8/20 [01:58<02:44, 13.74s/it]
Task 15, Epoch 9/20 => Loss 0.184, Train_accy 80.30:  40%|████      | 8/20 [02:09<02:44, 13.74s/it]
Task 15, Epoch 9/20 => Loss 0.184, Train_accy 80.30:  45%|████▌     | 9/20 [02:09<02:21, 12.90s/it]
Task 15, Epoch 10/20 => Loss 0.141, Train_accy 81.94:  45%|████▌     | 9/20 [02:20<02:21, 12.90s/it]
Task 15, Epoch 10/20 => Loss 0.141, Train_accy 81.94:  50%|█████     | 10/20 [02:20<02:03, 12.38s/it]
Task 15, Epoch 11/20 => Loss 0.170, Train_accy 81.30, Test_accy 51.10:  50%|█████     | 10/20 [02:46<02:03, 12.38s/it]
Task 15, Epoch 11/20 => Loss 0.170, Train_accy 81.30, Test_accy 51.10:  55%|█████▌    | 11/20 [02:46<02:28, 16.54s/it]
Task 15, Epoch 12/20 => Loss 0.155, Train_accy 84.87:  55%|█████▌    | 11/20 [02:57<02:28, 16.54s/it]                 
Task 15, Epoch 12/20 => Loss 0.155, Train_accy 84.87:  60%|██████    | 12/20 [02:57<01:59, 14.88s/it]
Task 15, Epoch 13/20 => Loss 0.164, Train_accy 83.87:  60%|██████    | 12/20 [03:08<01:59, 14.88s/it]
Task 15, Epoch 13/20 => Loss 0.164, Train_accy 83.87:  65%|██████▌   | 13/20 [03:08<01:36, 13.73s/it]
Task 15, Epoch 14/20 => Loss 0.150, Train_accy 84.08:  65%|██████▌   | 13/20 [03:19<01:36, 13.73s/it]
Task 15, Epoch 14/20 => Loss 0.150, Train_accy 84.08:  70%|███████   | 14/20 [03:19<01:17, 12.92s/it]
Task 15, Epoch 15/20 => Loss 0.151, Train_accy 85.01:  70%|███████   | 14/20 [03:30<01:17, 12.92s/it]
Task 15, Epoch 15/20 => Loss 0.151, Train_accy 85.01:  75%|███████▌  | 15/20 [03:30<01:01, 12.35s/it]
Task 15, Epoch 16/20 => Loss 0.174, Train_accy 85.37, Test_accy 51.39:  75%|███████▌  | 15/20 [03:56<01:01, 12.35s/it]
Task 15, Epoch 16/20 => Loss 0.174, Train_accy 85.37, Test_accy 51.39:  80%|████████  | 16/20 [03:56<01:05, 16.33s/it]
Task 15, Epoch 17/20 => Loss 0.150, Train_accy 86.51:  80%|████████  | 16/20 [04:07<01:05, 16.33s/it]                 
Task 15, Epoch 17/20 => Loss 0.150, Train_accy 86.51:  85%|████████▌ | 17/20 [04:07<00:44, 14.73s/it]
Task 15, Epoch 18/20 => Loss 0.127, Train_accy 87.58:  85%|████████▌ | 17/20 [04:18<00:44, 14.73s/it]
Task 15, Epoch 18/20 => Loss 0.127, Train_accy 87.58:  90%|█████████ | 18/20 [04:18<00:27, 13.62s/it]
Task 15, Epoch 19/20 => Loss 0.111, Train_accy 86.51:  90%|█████████ | 18/20 [04:29<00:27, 13.62s/it]
Task 15, Epoch 19/20 => Loss 0.111, Train_accy 86.51:  95%|█████████▌| 19/20 [04:29<00:12, 12.85s/it]
Task 15, Epoch 20/20 => Loss 0.128, Train_accy 88.87:  95%|█████████▌| 19/20 [04:40<00:12, 12.85s/it]
Task 15, Epoch 20/20 => Loss 0.128, Train_accy 88.87: 100%|██████████| 20/20 [04:40<00:00, 12.37s/it]
Task 15, Epoch 20/20 => Loss 0.128, Train_accy 88.87: 100%|██████████| 20/20 [04:40<00:00, 14.02s/it]
2024-09-07 12:00:47,721 [finetune.py] => Task 15, Epoch 20/20 => Loss 0.128, Train_accy 88.87
2024-09-07 12:01:02,327 [trainer.py] => No NME accuracy.
2024-09-07 12:01:02,327 [trainer.py] => CNN: {'total': 50.43, '00-09': 10.09, '10-19': 33.33, '20-29': 42.33, '30-39': 39.46, '40-49': 38.08, '50-59': 46.71, '60-69': 42.95, '70-79': 47.99, '80-89': 51.94, '90-99': 43.5, '100-109': 47.54, '110-119': 56.65, '120-129': 61.62, '130-139': 73.49, '140-149': 80.65, '150-159': 81.49, 'old': 47.98, 'new': 81.49}
2024-09-07 12:01:02,327 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11, 54.65, 52.61, 50.43]
2024-09-07 12:01:02,327 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46, 79.83, 78.67, 75.44]

Average Accuracy (CNN): 68.05
2024-09-07 12:01:02,328 [trainer.py] => Average Accuracy (CNN): 68.05 

2024-09-07 12:01:02,329 [trainer.py] => All params: 85921696
2024-09-07 12:01:02,330 [trainer.py] => Trainable params: 85921696
2024-09-07 12:01:02,333 [finetune.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.694, Train_accy 4.02, Test_accy 50.24:   0%|          | 0/20 [00:23<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.694, Train_accy 4.02, Test_accy 50.24:   5%|▌         | 1/20 [00:23<07:23, 23.34s/it]
Task 16, Epoch 2/20 => Loss 0.669, Train_accy 39.13:   5%|▌         | 1/20 [00:31<07:23, 23.34s/it]                
Task 16, Epoch 2/20 => Loss 0.669, Train_accy 39.13:  10%|█         | 2/20 [00:31<04:17, 14.30s/it]
Task 16, Epoch 3/20 => Loss 0.488, Train_accy 53.12:  10%|█         | 2/20 [00:39<04:17, 14.30s/it]
Task 16, Epoch 3/20 => Loss 0.488, Train_accy 53.12:  15%|█▌        | 3/20 [00:39<03:13, 11.39s/it]
Task 16, Epoch 4/20 => Loss 0.335, Train_accy 63.68:  15%|█▌        | 3/20 [00:47<03:13, 11.39s/it]
Task 16, Epoch 4/20 => Loss 0.335, Train_accy 63.68:  20%|██        | 4/20 [00:47<02:40, 10.04s/it]
Task 16, Epoch 5/20 => Loss 0.335, Train_accy 66.50:  20%|██        | 4/20 [00:55<02:40, 10.04s/it]
Task 16, Epoch 5/20 => Loss 0.335, Train_accy 66.50:  25%|██▌       | 5/20 [00:55<02:19,  9.28s/it]
Task 16, Epoch 6/20 => Loss 0.263, Train_accy 70.72, Test_accy 53.24:  25%|██▌       | 5/20 [01:18<02:19,  9.28s/it]
Task 16, Epoch 6/20 => Loss 0.263, Train_accy 70.72, Test_accy 53.24:  30%|███       | 6/20 [01:18<03:17, 14.11s/it]
Task 16, Epoch 7/20 => Loss 0.241, Train_accy 73.14:  30%|███       | 6/20 [01:26<03:17, 14.11s/it]                 
Task 16, Epoch 7/20 => Loss 0.241, Train_accy 73.14:  35%|███▌      | 7/20 [01:26<02:37, 12.10s/it]
Task 16, Epoch 8/20 => Loss 0.212, Train_accy 73.64:  35%|███▌      | 7/20 [01:34<02:37, 12.10s/it]
Task 16, Epoch 8/20 => Loss 0.212, Train_accy 73.64:  40%|████      | 8/20 [01:34<02:09, 10.79s/it]
Task 16, Epoch 9/20 => Loss 0.221, Train_accy 75.35:  40%|████      | 8/20 [01:42<02:09, 10.79s/it]
Task 16, Epoch 9/20 => Loss 0.221, Train_accy 75.35:  45%|████▌     | 9/20 [01:42<01:49,  9.91s/it]
Task 16, Epoch 10/20 => Loss 0.248, Train_accy 72.43:  45%|████▌     | 9/20 [01:50<01:49,  9.91s/it]
Task 16, Epoch 10/20 => Loss 0.248, Train_accy 72.43:  50%|█████     | 10/20 [01:50<01:32,  9.30s/it]
Task 16, Epoch 11/20 => Loss 0.245, Train_accy 74.75, Test_accy 53.24:  50%|█████     | 10/20 [02:13<01:32,  9.30s/it]
Task 16, Epoch 11/20 => Loss 0.245, Train_accy 74.75, Test_accy 53.24:  55%|█████▌    | 11/20 [02:13<02:02, 13.60s/it]
Task 16, Epoch 12/20 => Loss 0.188, Train_accy 75.15:  55%|█████▌    | 11/20 [02:21<02:02, 13.60s/it]                 
Task 16, Epoch 12/20 => Loss 0.188, Train_accy 75.15:  60%|██████    | 12/20 [02:21<01:35, 11.89s/it]
Task 16, Epoch 13/20 => Loss 0.227, Train_accy 76.36:  60%|██████    | 12/20 [02:29<01:35, 11.89s/it]
Task 16, Epoch 13/20 => Loss 0.227, Train_accy 76.36:  65%|██████▌   | 13/20 [02:29<01:14, 10.70s/it]
Task 16, Epoch 14/20 => Loss 0.232, Train_accy 76.56:  65%|██████▌   | 13/20 [02:37<01:14, 10.70s/it]
Task 16, Epoch 14/20 => Loss 0.232, Train_accy 76.56:  70%|███████   | 14/20 [02:37<00:59,  9.86s/it]
Task 16, Epoch 15/20 => Loss 0.197, Train_accy 77.16:  70%|███████   | 14/20 [02:45<00:59,  9.86s/it]
Task 16, Epoch 15/20 => Loss 0.197, Train_accy 77.16:  75%|███████▌  | 15/20 [02:45<00:46,  9.28s/it]
Task 16, Epoch 16/20 => Loss 0.161, Train_accy 80.38, Test_accy 51.83:  75%|███████▌  | 15/20 [03:08<00:46,  9.28s/it]
Task 16, Epoch 16/20 => Loss 0.161, Train_accy 80.38, Test_accy 51.83:  80%|████████  | 16/20 [03:08<00:54, 13.51s/it]
Task 16, Epoch 17/20 => Loss 0.178, Train_accy 76.76:  80%|████████  | 16/20 [03:16<00:54, 13.51s/it]                 
Task 16, Epoch 17/20 => Loss 0.178, Train_accy 76.76:  85%|████████▌ | 17/20 [03:16<00:35, 11.84s/it]
Task 16, Epoch 18/20 => Loss 0.158, Train_accy 79.98:  85%|████████▌ | 17/20 [03:24<00:35, 11.84s/it]
Task 16, Epoch 18/20 => Loss 0.158, Train_accy 79.98:  90%|█████████ | 18/20 [03:24<00:21, 10.66s/it]
Task 16, Epoch 19/20 => Loss 0.160, Train_accy 81.89:  90%|█████████ | 18/20 [03:32<00:21, 10.66s/it]
Task 16, Epoch 19/20 => Loss 0.160, Train_accy 81.89:  95%|█████████▌| 19/20 [03:32<00:09,  9.84s/it]
Task 16, Epoch 20/20 => Loss 0.126, Train_accy 83.20:  95%|█████████▌| 19/20 [03:40<00:09,  9.84s/it]
Task 16, Epoch 20/20 => Loss 0.126, Train_accy 83.20: 100%|██████████| 20/20 [03:40<00:00,  9.28s/it]
Task 16, Epoch 20/20 => Loss 0.126, Train_accy 83.20: 100%|██████████| 20/20 [03:40<00:00, 11.04s/it]
2024-09-07 12:04:43,076 [finetune.py] => Task 16, Epoch 20/20 => Loss 0.126, Train_accy 83.20
2024-09-07 12:04:58,349 [trainer.py] => No NME accuracy.
2024-09-07 12:04:58,350 [trainer.py] => CNN: {'total': 51.85, '00-09': 12.93, '10-19': 40.59, '20-29': 42.33, '30-39': 42.17, '40-49': 38.41, '50-59': 51.64, '60-69': 42.62, '70-79': 52.01, '80-89': 51.29, '90-99': 40.11, '100-109': 50.7, '110-119': 53.72, '120-129': 60.52, '130-139': 67.45, '140-149': 80.65, '150-159': 74.31, '160-169': 76.09, 'old': 50.72, 'new': 76.09}
2024-09-07 12:04:58,350 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11, 54.65, 52.61, 50.43, 51.85]
2024-09-07 12:04:58,350 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46, 79.83, 78.67, 75.44, 76.22]

Average Accuracy (CNN): 67.1
2024-09-07 12:04:58,350 [trainer.py] => Average Accuracy (CNN): 67.1 

2024-09-07 12:04:58,351 [trainer.py] => All params: 85929386
2024-09-07 12:04:58,352 [trainer.py] => Trainable params: 85929386
2024-09-07 12:04:58,356 [finetune.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.444, Train_accy 15.51, Test_accy 54.09:   0%|          | 0/20 [00:23<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.444, Train_accy 15.51, Test_accy 54.09:   5%|▌         | 1/20 [00:23<07:30, 23.71s/it]
Task 17, Epoch 2/20 => Loss 0.423, Train_accy 68.87:   5%|▌         | 1/20 [00:31<07:30, 23.71s/it]                 
Task 17, Epoch 2/20 => Loss 0.423, Train_accy 68.87:  10%|█         | 2/20 [00:31<04:16, 14.26s/it]
Task 17, Epoch 3/20 => Loss 0.298, Train_accy 77.99:  10%|█         | 2/20 [00:39<04:16, 14.26s/it]
Task 17, Epoch 3/20 => Loss 0.298, Train_accy 77.99:  15%|█▌        | 3/20 [00:39<03:11, 11.25s/it]
Task 17, Epoch 4/20 => Loss 0.253, Train_accy 82.08:  15%|█▌        | 3/20 [00:46<03:11, 11.25s/it]
Task 17, Epoch 4/20 => Loss 0.253, Train_accy 82.08:  20%|██        | 4/20 [00:46<02:37,  9.82s/it]
Task 17, Epoch 5/20 => Loss 0.205, Train_accy 83.75:  20%|██        | 4/20 [00:54<02:37,  9.82s/it]
Task 17, Epoch 5/20 => Loss 0.205, Train_accy 83.75:  25%|██▌       | 5/20 [00:54<02:15,  9.04s/it]
Task 17, Epoch 6/20 => Loss 0.217, Train_accy 83.12, Test_accy 52.78:  25%|██▌       | 5/20 [01:17<02:15,  9.04s/it]
Task 17, Epoch 6/20 => Loss 0.217, Train_accy 83.12, Test_accy 52.78:  30%|███       | 6/20 [01:17<03:15, 13.99s/it]
Task 17, Epoch 7/20 => Loss 0.193, Train_accy 85.95:  30%|███       | 6/20 [01:25<03:15, 13.99s/it]                 
Task 17, Epoch 7/20 => Loss 0.193, Train_accy 85.95:  35%|███▌      | 7/20 [01:25<02:35, 12.00s/it]
Task 17, Epoch 8/20 => Loss 0.178, Train_accy 85.22:  35%|███▌      | 7/20 [01:33<02:35, 12.00s/it]
Task 17, Epoch 8/20 => Loss 0.178, Train_accy 85.22:  40%|████      | 8/20 [01:33<02:07, 10.62s/it]
Task 17, Epoch 9/20 => Loss 0.176, Train_accy 88.05:  40%|████      | 8/20 [01:41<02:07, 10.62s/it]
Task 17, Epoch 9/20 => Loss 0.176, Train_accy 88.05:  45%|████▌     | 9/20 [01:41<01:46,  9.71s/it]
Task 17, Epoch 10/20 => Loss 0.165, Train_accy 87.53:  45%|████▌     | 9/20 [01:48<01:46,  9.71s/it]
Task 17, Epoch 10/20 => Loss 0.165, Train_accy 87.53:  50%|█████     | 10/20 [01:48<01:30,  9.07s/it]
Task 17, Epoch 11/20 => Loss 0.152, Train_accy 87.63, Test_accy 51.69:  50%|█████     | 10/20 [02:12<01:30,  9.07s/it]
Task 17, Epoch 11/20 => Loss 0.152, Train_accy 87.63, Test_accy 51.69:  55%|█████▌    | 11/20 [02:12<02:01, 13.47s/it]
Task 17, Epoch 12/20 => Loss 0.109, Train_accy 88.47:  55%|█████▌    | 11/20 [02:19<02:01, 13.47s/it]                 
Task 17, Epoch 12/20 => Loss 0.109, Train_accy 88.47:  60%|██████    | 12/20 [02:19<01:33, 11.68s/it]
Task 17, Epoch 13/20 => Loss 0.127, Train_accy 89.73:  60%|██████    | 12/20 [02:27<01:33, 11.68s/it]
Task 17, Epoch 13/20 => Loss 0.127, Train_accy 89.73:  65%|██████▌   | 13/20 [02:27<01:13, 10.46s/it]
Task 17, Epoch 14/20 => Loss 0.132, Train_accy 90.15:  65%|██████▌   | 13/20 [02:35<01:13, 10.46s/it]
Task 17, Epoch 14/20 => Loss 0.132, Train_accy 90.15:  70%|███████   | 14/20 [02:35<00:57,  9.60s/it]
Task 17, Epoch 15/20 => Loss 0.136, Train_accy 90.99:  70%|███████   | 14/20 [02:42<00:57,  9.60s/it]
Task 17, Epoch 15/20 => Loss 0.136, Train_accy 90.99:  75%|███████▌  | 15/20 [02:42<00:45,  9.03s/it]
Task 17, Epoch 16/20 => Loss 0.154, Train_accy 88.89, Test_accy 51.21:  75%|███████▌  | 15/20 [03:06<00:45,  9.03s/it]
Task 17, Epoch 16/20 => Loss 0.154, Train_accy 88.89, Test_accy 51.21:  80%|████████  | 16/20 [03:06<00:53, 13.40s/it]
Task 17, Epoch 17/20 => Loss 0.101, Train_accy 91.09:  80%|████████  | 16/20 [03:13<00:53, 13.40s/it]                 
Task 17, Epoch 17/20 => Loss 0.101, Train_accy 91.09:  85%|████████▌ | 17/20 [03:13<00:34, 11.66s/it]
Task 17, Epoch 18/20 => Loss 0.147, Train_accy 90.25:  85%|████████▌ | 17/20 [03:21<00:34, 11.66s/it]
Task 17, Epoch 18/20 => Loss 0.147, Train_accy 90.25:  90%|█████████ | 18/20 [03:21<00:20, 10.45s/it]
Task 17, Epoch 19/20 => Loss 0.141, Train_accy 89.73:  90%|█████████ | 18/20 [03:29<00:20, 10.45s/it]
Task 17, Epoch 19/20 => Loss 0.141, Train_accy 89.73:  95%|█████████▌| 19/20 [03:29<00:09,  9.67s/it]
Task 17, Epoch 20/20 => Loss 0.138, Train_accy 89.94:  95%|█████████▌| 19/20 [03:37<00:09,  9.67s/it]
Task 17, Epoch 20/20 => Loss 0.138, Train_accy 89.94: 100%|██████████| 20/20 [03:37<00:00,  9.05s/it]
Task 17, Epoch 20/20 => Loss 0.138, Train_accy 89.94: 100%|██████████| 20/20 [03:37<00:00, 10.85s/it]
2024-09-07 12:08:35,445 [finetune.py] => Task 17, Epoch 20/20 => Loss 0.138, Train_accy 89.94
2024-09-07 12:08:51,361 [trainer.py] => No NME accuracy.
2024-09-07 12:08:51,361 [trainer.py] => CNN: {'total': 52.79, '00-09': 14.2, '10-19': 36.29, '20-29': 46.0, '30-39': 43.98, '40-49': 41.06, '50-59': 49.34, '60-69': 47.99, '70-79': 48.72, '80-89': 54.52, '90-99': 31.07, '100-109': 49.65, '110-119': 55.32, '120-129': 55.72, '130-139': 68.12, '140-149': 75.48, '150-159': 75.97, '160-169': 64.78, '170-179': 88.71, 'old': 51.07, 'new': 88.71}
2024-09-07 12:08:51,362 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11, 54.65, 52.61, 50.43, 51.85, 52.79]
2024-09-07 12:08:51,362 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46, 79.83, 78.67, 75.44, 76.22, 76.26]

Average Accuracy (CNN): 66.31
2024-09-07 12:08:51,362 [trainer.py] => Average Accuracy (CNN): 66.31 

2024-09-07 12:08:51,363 [trainer.py] => All params: 85937076
2024-09-07 12:08:51,364 [trainer.py] => Trainable params: 85937076
2024-09-07 12:08:51,368 [finetune.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.440, Train_accy 16.46, Test_accy 49.76:   0%|          | 0/20 [00:25<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.440, Train_accy 16.46, Test_accy 49.76:   5%|▌         | 1/20 [00:25<08:11, 25.86s/it]
Task 18, Epoch 2/20 => Loss 0.409, Train_accy 67.25:   5%|▌         | 1/20 [00:34<08:11, 25.86s/it]                 
Task 18, Epoch 2/20 => Loss 0.409, Train_accy 67.25:  10%|█         | 2/20 [00:34<04:47, 15.97s/it]
Task 18, Epoch 3/20 => Loss 0.351, Train_accy 74.87:  10%|█         | 2/20 [00:44<04:47, 15.97s/it]
Task 18, Epoch 3/20 => Loss 0.351, Train_accy 74.87:  15%|█▌        | 3/20 [00:44<03:38, 12.85s/it]
Task 18, Epoch 4/20 => Loss 0.260, Train_accy 79.86:  15%|█▌        | 3/20 [00:53<03:38, 12.85s/it]
Task 18, Epoch 4/20 => Loss 0.260, Train_accy 79.86:  20%|██        | 4/20 [00:53<03:01, 11.36s/it]
Task 18, Epoch 5/20 => Loss 0.282, Train_accy 79.07:  20%|██        | 4/20 [01:02<03:01, 11.36s/it]
Task 18, Epoch 5/20 => Loss 0.282, Train_accy 79.07:  25%|██▌       | 5/20 [01:02<02:38, 10.54s/it]
Task 18, Epoch 6/20 => Loss 0.225, Train_accy 80.74, Test_accy 49.55:  25%|██▌       | 5/20 [01:27<02:38, 10.54s/it]
Task 18, Epoch 6/20 => Loss 0.225, Train_accy 80.74, Test_accy 49.55:  30%|███       | 6/20 [01:27<03:39, 15.71s/it]
Task 18, Epoch 7/20 => Loss 0.220, Train_accy 82.66:  30%|███       | 6/20 [01:36<03:39, 15.71s/it]                 
Task 18, Epoch 7/20 => Loss 0.220, Train_accy 82.66:  35%|███▌      | 7/20 [01:36<02:55, 13.52s/it]
Task 18, Epoch 8/20 => Loss 0.182, Train_accy 83.89:  35%|███▌      | 7/20 [01:46<02:55, 13.52s/it]
Task 18, Epoch 8/20 => Loss 0.182, Train_accy 83.89:  40%|████      | 8/20 [01:46<02:25, 12.10s/it]
Task 18, Epoch 9/20 => Loss 0.197, Train_accy 83.89:  40%|████      | 8/20 [01:55<02:25, 12.10s/it]
Task 18, Epoch 9/20 => Loss 0.197, Train_accy 83.89:  45%|████▌     | 9/20 [01:55<02:02, 11.15s/it]
Task 18, Epoch 10/20 => Loss 0.164, Train_accy 84.76:  45%|████▌     | 9/20 [02:04<02:02, 11.15s/it]
Task 18, Epoch 10/20 => Loss 0.164, Train_accy 84.76:  50%|█████     | 10/20 [02:04<01:45, 10.51s/it]
Task 18, Epoch 11/20 => Loss 0.203, Train_accy 85.55, Test_accy 49.12:  50%|█████     | 10/20 [02:29<01:45, 10.51s/it]
Task 18, Epoch 11/20 => Loss 0.203, Train_accy 85.55, Test_accy 49.12:  55%|█████▌    | 11/20 [02:29<02:16, 15.19s/it]
Task 18, Epoch 12/20 => Loss 0.134, Train_accy 88.18:  55%|█████▌    | 11/20 [02:39<02:16, 15.19s/it]                 
Task 18, Epoch 12/20 => Loss 0.134, Train_accy 88.18:  60%|██████    | 12/20 [02:39<01:46, 13.32s/it]
Task 18, Epoch 13/20 => Loss 0.177, Train_accy 85.64:  60%|██████    | 12/20 [02:48<01:46, 13.32s/it]
Task 18, Epoch 13/20 => Loss 0.177, Train_accy 85.64:  65%|██████▌   | 13/20 [02:48<01:24, 12.06s/it]
Task 18, Epoch 14/20 => Loss 0.149, Train_accy 87.30:  65%|██████▌   | 13/20 [02:57<01:24, 12.06s/it]
Task 18, Epoch 14/20 => Loss 0.149, Train_accy 87.30:  70%|███████   | 14/20 [02:57<01:07, 11.18s/it]
Task 18, Epoch 15/20 => Loss 0.147, Train_accy 88.35:  70%|███████   | 14/20 [03:06<01:07, 11.18s/it]
Task 18, Epoch 15/20 => Loss 0.147, Train_accy 88.35:  75%|███████▌  | 15/20 [03:06<00:52, 10.55s/it]
Task 18, Epoch 16/20 => Loss 0.120, Train_accy 89.93, Test_accy 49.40:  75%|███████▌  | 15/20 [03:32<00:52, 10.55s/it]
Task 18, Epoch 16/20 => Loss 0.120, Train_accy 89.93, Test_accy 49.40:  80%|████████  | 16/20 [03:32<01:00, 15.18s/it]
Task 18, Epoch 17/20 => Loss 0.120, Train_accy 88.88:  80%|████████  | 16/20 [03:41<01:00, 15.18s/it]                 
Task 18, Epoch 17/20 => Loss 0.120, Train_accy 88.88:  85%|████████▌ | 17/20 [03:41<00:40, 13.34s/it]
Task 18, Epoch 18/20 => Loss 0.116, Train_accy 90.19:  85%|████████▌ | 17/20 [03:50<00:40, 13.34s/it]
Task 18, Epoch 18/20 => Loss 0.116, Train_accy 90.19:  90%|█████████ | 18/20 [03:50<00:24, 12.05s/it]
Task 18, Epoch 19/20 => Loss 0.101, Train_accy 90.89:  90%|█████████ | 18/20 [03:59<00:24, 12.05s/it]
Task 18, Epoch 19/20 => Loss 0.101, Train_accy 90.89:  95%|█████████▌| 19/20 [03:59<00:11, 11.15s/it]
Task 18, Epoch 20/20 => Loss 0.123, Train_accy 89.23:  95%|█████████▌| 19/20 [04:08<00:11, 11.15s/it]
Task 18, Epoch 20/20 => Loss 0.123, Train_accy 89.23: 100%|██████████| 20/20 [04:08<00:00, 10.51s/it]
Task 18, Epoch 20/20 => Loss 0.123, Train_accy 89.23: 100%|██████████| 20/20 [04:08<00:00, 12.43s/it]
2024-09-07 12:12:59,923 [finetune.py] => Task 18, Epoch 20/20 => Loss 0.123, Train_accy 89.23
2024-09-07 12:13:16,660 [trainer.py] => No NME accuracy.
2024-09-07 12:13:16,661 [trainer.py] => CNN: {'total': 48.32, '00-09': 11.04, '10-19': 30.91, '20-29': 34.67, '30-39': 37.95, '40-49': 33.11, '50-59': 45.72, '60-69': 41.61, '70-79': 40.29, '80-89': 50.0, '90-99': 31.07, '100-109': 45.07, '110-119': 51.6, '120-129': 52.03, '130-139': 61.74, '140-149': 69.48, '150-159': 59.39, '160-169': 55.65, '170-179': 77.82, '180-189': 86.69, 'old': 46.14, 'new': 86.69}
2024-09-07 12:13:16,661 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11, 54.65, 52.61, 50.43, 51.85, 52.79, 48.32]
2024-09-07 12:13:16,661 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46, 79.83, 78.67, 75.44, 76.22, 76.26, 73.89]

Average Accuracy (CNN): 65.36
2024-09-07 12:13:16,661 [trainer.py] => Average Accuracy (CNN): 65.36 

2024-09-07 12:13:16,663 [trainer.py] => All params: 85944766
2024-09-07 12:13:16,664 [trainer.py] => Trainable params: 85944766
2024-09-07 12:13:16,667 [finetune.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.142, Train_accy 26.86, Test_accy 48.87:   0%|          | 0/20 [00:26<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.142, Train_accy 26.86, Test_accy 48.87:   5%|▌         | 1/20 [00:26<08:21, 26.38s/it]
Task 19, Epoch 2/20 => Loss 0.339, Train_accy 70.48:   5%|▌         | 1/20 [00:35<08:21, 26.38s/it]                 
Task 19, Epoch 2/20 => Loss 0.339, Train_accy 70.48:  10%|█         | 2/20 [00:35<04:50, 16.14s/it]
Task 19, Epoch 3/20 => Loss 0.235, Train_accy 77.84:  10%|█         | 2/20 [00:44<04:50, 16.14s/it]
Task 19, Epoch 3/20 => Loss 0.235, Train_accy 77.84:  15%|█▌        | 3/20 [00:44<03:38, 12.86s/it]
Task 19, Epoch 4/20 => Loss 0.215, Train_accy 79.88:  15%|█▌        | 3/20 [00:53<03:38, 12.86s/it]
Task 19, Epoch 4/20 => Loss 0.215, Train_accy 79.88:  20%|██        | 4/20 [00:53<03:01, 11.33s/it]
Task 19, Epoch 5/20 => Loss 0.152, Train_accy 84.04:  20%|██        | 4/20 [01:02<03:01, 11.33s/it]
Task 19, Epoch 5/20 => Loss 0.152, Train_accy 84.04:  25%|██▌       | 5/20 [01:02<02:37, 10.49s/it]
Task 19, Epoch 6/20 => Loss 0.145, Train_accy 85.73, Test_accy 45.63:  25%|██▌       | 5/20 [01:29<02:37, 10.49s/it]
Task 19, Epoch 6/20 => Loss 0.145, Train_accy 85.73, Test_accy 45.63:  30%|███       | 6/20 [01:29<03:44, 16.02s/it]
Task 19, Epoch 7/20 => Loss 0.164, Train_accy 85.99:  30%|███       | 6/20 [01:38<03:44, 16.02s/it]                 
Task 19, Epoch 7/20 => Loss 0.164, Train_accy 85.99:  35%|███▌      | 7/20 [01:38<02:58, 13.73s/it]
Task 19, Epoch 8/20 => Loss 0.133, Train_accy 87.15:  35%|███▌      | 7/20 [01:47<02:58, 13.73s/it]
Task 19, Epoch 8/20 => Loss 0.133, Train_accy 87.15:  40%|████      | 8/20 [01:47<02:26, 12.23s/it]
Task 19, Epoch 9/20 => Loss 0.161, Train_accy 83.60:  40%|████      | 8/20 [01:56<02:26, 12.23s/it]
Task 19, Epoch 9/20 => Loss 0.161, Train_accy 83.60:  45%|████▌     | 9/20 [01:56<02:03, 11.23s/it]
Task 19, Epoch 10/20 => Loss 0.140, Train_accy 85.37:  45%|████▌     | 9/20 [02:05<02:03, 11.23s/it]
Task 19, Epoch 10/20 => Loss 0.140, Train_accy 85.37:  50%|█████     | 10/20 [02:05<01:45, 10.56s/it]
Task 19, Epoch 11/20 => Loss 0.107, Train_accy 88.56, Test_accy 46.37:  50%|█████     | 10/20 [02:31<01:45, 10.56s/it]
Task 19, Epoch 11/20 => Loss 0.107, Train_accy 88.56, Test_accy 46.37:  55%|█████▌    | 11/20 [02:31<02:19, 15.53s/it]
Task 19, Epoch 12/20 => Loss 0.122, Train_accy 87.59:  55%|█████▌    | 11/20 [02:40<02:19, 15.53s/it]                 
Task 19, Epoch 12/20 => Loss 0.122, Train_accy 87.59:  60%|██████    | 12/20 [02:40<01:48, 13.54s/it]
Task 19, Epoch 13/20 => Loss 0.124, Train_accy 88.39:  60%|██████    | 12/20 [02:49<01:48, 13.54s/it]
Task 19, Epoch 13/20 => Loss 0.124, Train_accy 88.39:  65%|██████▌   | 13/20 [02:49<01:25, 12.16s/it]
Task 19, Epoch 14/20 => Loss 0.110, Train_accy 88.92:  65%|██████▌   | 13/20 [02:58<01:25, 12.16s/it]
Task 19, Epoch 14/20 => Loss 0.110, Train_accy 88.92:  70%|███████   | 14/20 [02:58<01:07, 11.22s/it]
Task 19, Epoch 15/20 => Loss 0.109, Train_accy 88.03:  70%|███████   | 14/20 [03:07<01:07, 11.22s/it]
Task 19, Epoch 15/20 => Loss 0.109, Train_accy 88.03:  75%|███████▌  | 15/20 [03:07<00:52, 10.54s/it]
Task 19, Epoch 16/20 => Loss 0.101, Train_accy 88.39, Test_accy 44.85:  75%|███████▌  | 15/20 [03:34<00:52, 10.54s/it]
Task 19, Epoch 16/20 => Loss 0.101, Train_accy 88.39, Test_accy 44.85:  80%|████████  | 16/20 [03:34<01:01, 15.42s/it]
Task 19, Epoch 17/20 => Loss 0.110, Train_accy 88.48:  80%|████████  | 16/20 [03:43<01:01, 15.42s/it]                 
Task 19, Epoch 17/20 => Loss 0.110, Train_accy 88.48:  85%|████████▌ | 17/20 [03:43<00:40, 13.49s/it]
Task 19, Epoch 18/20 => Loss 0.084, Train_accy 89.98:  85%|████████▌ | 17/20 [03:52<00:40, 13.49s/it]
Task 19, Epoch 18/20 => Loss 0.084, Train_accy 89.98:  90%|█████████ | 18/20 [03:52<00:24, 12.14s/it]
Task 19, Epoch 19/20 => Loss 0.127, Train_accy 88.74:  90%|█████████ | 18/20 [04:01<00:24, 12.14s/it]
Task 19, Epoch 19/20 => Loss 0.127, Train_accy 88.74:  95%|█████████▌| 19/20 [04:01<00:11, 11.18s/it]
Task 19, Epoch 20/20 => Loss 0.086, Train_accy 90.69:  95%|█████████▌| 19/20 [04:10<00:11, 11.18s/it]
Task 19, Epoch 20/20 => Loss 0.086, Train_accy 90.69: 100%|██████████| 20/20 [04:10<00:00, 10.56s/it]
Task 19, Epoch 20/20 => Loss 0.086, Train_accy 90.69: 100%|██████████| 20/20 [04:10<00:00, 12.54s/it]
2024-09-07 12:17:27,424 [finetune.py] => Task 19, Epoch 20/20 => Loss 0.086, Train_accy 90.69
2024-09-07 12:17:45,210 [trainer.py] => No NME accuracy.
2024-09-07 12:17:45,211 [trainer.py] => CNN: {'total': 46.42, '00-09': 11.99, '10-19': 33.06, '20-29': 30.0, '30-39': 36.45, '40-49': 32.45, '50-59': 38.16, '60-69': 39.6, '70-79': 37.36, '80-89': 46.13, '90-99': 24.29, '100-109': 42.61, '110-119': 47.34, '120-129': 45.76, '130-139': 54.7, '140-149': 62.13, '150-159': 61.88, '160-169': 46.96, '170-179': 74.19, '180-189': 73.05, '190-199': 87.82, 'old': 44.46, 'new': 87.82}
2024-09-07 12:17:45,211 [trainer.py] => CNN top1 curve: [95.58, 85.78, 80.79, 78.58, 75.54, 72.91, 68.58, 69.26, 66.06, 61.34, 62.01, 59.64, 55.11, 54.65, 52.61, 50.43, 51.85, 52.79, 48.32, 46.42]
2024-09-07 12:17:45,211 [trainer.py] => CNN top5 curve: [100.0, 97.82, 96.36, 94.85, 92.3, 91.49, 89.62, 88.63, 86.61, 83.35, 82.96, 83.43, 80.46, 79.83, 78.67, 75.44, 76.22, 76.26, 73.89, 72.58]

Average Accuracy (CNN): 64.41
2024-09-07 12:17:45,211 [trainer.py] => Average Accuracy (CNN): 64.41 

Accuracy Matrix (CNN):
[[95.58 76.66 71.29 63.72 64.67 59.94 48.58 49.21 43.22 34.07 33.75 23.34
  16.09 13.25 10.41 10.09 12.93 14.2  11.04 11.99]
 [ 0.   93.55 82.8  79.57 73.12 66.94 60.22 65.59 58.6  53.76 51.08 44.62
  43.82 41.67 40.05 33.33 40.59 36.29 30.91 33.06]
 [ 0.    0.   88.33 80.67 74.   71.   66.33 64.67 60.   58.33 56.   56.33
  41.   46.33 42.33 42.33 42.33 46.   34.67 30.  ]
 [ 0.    0.    0.   89.76 78.31 71.99 68.67 63.25 57.53 57.83 61.45 51.81
  45.48 42.47 40.06 39.46 42.17 43.98 37.95 36.45]
 [ 0.    0.    0.    0.   88.41 80.79 69.87 66.23 64.24 57.62 56.29 58.28
  45.7  47.02 44.7  38.08 38.41 41.06 33.11 32.45]
 [ 0.    0.    0.    0.    0.   88.82 81.25 76.32 70.39 62.5  65.46 62.17
  56.91 57.24 52.3  46.71 51.64 49.34 45.72 38.16]
 [ 0.    0.    0.    0.    0.    0.   88.26 84.23 77.85 71.14 67.11 62.42
  57.05 51.34 46.98 42.95 42.62 47.99 41.61 39.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.   89.01 80.22 76.92 70.7  64.47
  63.   56.04 45.79 47.99 52.01 48.72 40.29 37.36]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   87.1  76.45 72.9  70.97
  64.19 59.03 56.45 51.94 51.29 54.52 50.   46.13]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   75.14 68.93 62.71
  59.32 59.89 54.24 43.5  40.11 31.07 31.07 24.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   87.32 70.77
  71.13 69.01 54.23 47.54 50.7  49.65 45.07 42.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   88.83
  76.86 73.67 63.83 56.65 53.72 55.32 51.6  47.34]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  81.92 66.79 64.21 61.62 60.52 55.72 52.03 45.76]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   87.58 78.52 73.49 67.45 68.12 61.74 54.7 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   91.55 80.65 80.65 75.48 69.48 62.13]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   81.49 74.31 75.97 59.39 61.88]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   76.09 64.78 55.65 46.96]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   88.71 77.82 74.19]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   86.69 73.05]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   87.82]]
2024-09-07 12:17:45,216 [trainer.py] => Forgetting (CNN): 42.94894736842105
2024-09-07 12:17:48,007 [trainer.py] => config: ./exps/finetune_inr_B100_Inc5.json
2024-09-07 12:17:48,020 [trainer.py] => prefix: reproduce
2024-09-07 12:17:48,020 [trainer.py] => dataset: imagenetr
2024-09-07 12:17:48,020 [trainer.py] => memory_size: 0
2024-09-07 12:17:48,020 [trainer.py] => memory_per_class: 0
2024-09-07 12:17:48,020 [trainer.py] => fixed_memory: False
2024-09-07 12:17:48,020 [trainer.py] => shuffle: True
2024-09-07 12:17:48,020 [trainer.py] => init_cls: 100
2024-09-07 12:17:48,020 [trainer.py] => increment: 20
2024-09-07 12:17:48,020 [trainer.py] => model_name: finetune
2024-09-07 12:17:48,021 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 12:17:48,021 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 12:17:48,021 [trainer.py] => seed: 1993
2024-09-07 12:17:48,021 [trainer.py] => init_epoch: 20
2024-09-07 12:17:48,021 [trainer.py] => init_lr: 0.001
2024-09-07 12:17:48,021 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 12:17:48,021 [trainer.py] => init_lr_decay: 0.1
2024-09-07 12:17:48,021 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 12:17:48,021 [trainer.py] => epochs: 20
2024-09-07 12:17:48,021 [trainer.py] => lrate: 0.001
2024-09-07 12:17:48,021 [trainer.py] => milestones: [40, 70]
2024-09-07 12:17:48,021 [trainer.py] => lrate_decay: 0.1
2024-09-07 12:17:48,021 [trainer.py] => batch_size: 48
2024-09-07 12:17:48,021 [trainer.py] => weight_decay: 0.0002
2024-09-07 12:17:48,105 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 12:17:49,886 [trainer.py] => All params: 85798656
2024-09-07 12:17:49,886 [trainer.py] => Trainable params: 85798656
2024-09-07 12:17:49,887 [finetune.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.606, Train_accy 1.96, Test_accy 2.24:   0%|          | 0/20 [01:42<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.606, Train_accy 1.96, Test_accy 2.24:   5%|▌         | 1/20 [01:42<32:19, 102.08s/it]
Task 0, Epoch 2/20 => Loss 4.480, Train_accy 3.37:   5%|▌         | 1/20 [03:15<32:19, 102.08s/it]                
Task 0, Epoch 2/20 => Loss 4.480, Train_accy 3.37:  10%|█         | 2/20 [03:15<29:03, 96.85s/it] 
Task 0, Epoch 3/20 => Loss 3.849, Train_accy 15.40:  10%|█         | 2/20 [04:48<29:03, 96.85s/it]
Task 0, Epoch 3/20 => Loss 3.849, Train_accy 15.40:  15%|█▌        | 3/20 [04:48<26:57, 95.14s/it]
Task 0, Epoch 4/20 => Loss 1.605, Train_accy 61.88:  15%|█▌        | 3/20 [06:21<26:57, 95.14s/it]
Task 0, Epoch 4/20 => Loss 1.605, Train_accy 61.88:  20%|██        | 4/20 [06:21<25:09, 94.34s/it]
Task 0, Epoch 5/20 => Loss 1.149, Train_accy 71.99:  20%|██        | 4/20 [07:54<25:09, 94.34s/it]
Task 0, Epoch 5/20 => Loss 1.149, Train_accy 71.99:  25%|██▌       | 5/20 [07:54<23:28, 93.91s/it]
Task 0, Epoch 6/20 => Loss 0.959, Train_accy 76.71, Test_accy 80.74:  25%|██▌       | 5/20 [09:36<23:28, 93.91s/it]
Task 0, Epoch 6/20 => Loss 0.959, Train_accy 76.71, Test_accy 80.74:  30%|███       | 6/20 [09:36<22:33, 96.65s/it]
Task 0, Epoch 7/20 => Loss 0.858, Train_accy 78.89:  30%|███       | 6/20 [11:09<22:33, 96.65s/it]                 
Task 0, Epoch 7/20 => Loss 0.858, Train_accy 78.89:  35%|███▌      | 7/20 [11:09<20:41, 95.46s/it]
Task 0, Epoch 8/20 => Loss 0.766, Train_accy 81.02:  35%|███▌      | 7/20 [12:42<20:41, 95.46s/it]
Task 0, Epoch 8/20 => Loss 0.766, Train_accy 81.02:  40%|████      | 8/20 [12:42<18:56, 94.67s/it]
Task 0, Epoch 9/20 => Loss 0.729, Train_accy 81.86:  40%|████      | 8/20 [14:16<18:56, 94.67s/it]
Task 0, Epoch 9/20 => Loss 0.729, Train_accy 81.86:  45%|████▌     | 9/20 [14:16<17:17, 94.34s/it]
Task 0, Epoch 10/20 => Loss 0.663, Train_accy 83.58:  45%|████▌     | 9/20 [15:49<17:17, 94.34s/it]
Task 0, Epoch 10/20 => Loss 0.663, Train_accy 83.58:  50%|█████     | 10/20 [15:49<15:40, 94.08s/it]
Task 0, Epoch 11/20 => Loss 0.641, Train_accy 84.02, Test_accy 81.74:  50%|█████     | 10/20 [17:31<15:40, 94.08s/it]
Task 0, Epoch 11/20 => Loss 0.641, Train_accy 84.02, Test_accy 81.74:  55%|█████▌    | 11/20 [17:31<14:28, 96.50s/it]
Task 0, Epoch 12/20 => Loss 0.590, Train_accy 85.56:  55%|█████▌    | 11/20 [19:04<14:28, 96.50s/it]                 
Task 0, Epoch 12/20 => Loss 0.590, Train_accy 85.56:  60%|██████    | 12/20 [19:04<12:43, 95.44s/it]
Task 0, Epoch 13/20 => Loss 0.568, Train_accy 86.30:  60%|██████    | 12/20 [20:37<12:43, 95.44s/it]
Task 0, Epoch 13/20 => Loss 0.568, Train_accy 86.30:  65%|██████▌   | 13/20 [20:37<11:02, 94.71s/it]
Task 0, Epoch 14/20 => Loss 0.534, Train_accy 86.72:  65%|██████▌   | 13/20 [22:10<11:02, 94.71s/it]
Task 0, Epoch 14/20 => Loss 0.534, Train_accy 86.72:  70%|███████   | 14/20 [22:10<09:25, 94.27s/it]
Task 0, Epoch 15/20 => Loss 0.518, Train_accy 87.44:  70%|███████   | 14/20 [23:43<09:25, 94.27s/it]
Task 0, Epoch 15/20 => Loss 0.518, Train_accy 87.44:  75%|███████▌  | 15/20 [23:43<07:49, 93.88s/it]
Task 0, Epoch 16/20 => Loss 0.489, Train_accy 87.77, Test_accy 82.61:  75%|███████▌  | 15/20 [25:26<07:49, 93.88s/it]
Task 0, Epoch 16/20 => Loss 0.489, Train_accy 87.77, Test_accy 82.61:  80%|████████  | 16/20 [25:26<06:25, 96.36s/it]
Task 0, Epoch 17/20 => Loss 0.471, Train_accy 88.22:  80%|████████  | 16/20 [26:59<06:25, 96.36s/it]                 
Task 0, Epoch 17/20 => Loss 0.471, Train_accy 88.22:  85%|████████▌ | 17/20 [26:59<04:46, 95.47s/it]
Task 0, Epoch 18/20 => Loss 0.468, Train_accy 88.38:  85%|████████▌ | 17/20 [28:32<04:46, 95.47s/it]
Task 0, Epoch 18/20 => Loss 0.468, Train_accy 88.38:  90%|█████████ | 18/20 [28:32<03:09, 94.78s/it]
Task 0, Epoch 19/20 => Loss 0.461, Train_accy 88.45:  90%|█████████ | 18/20 [30:05<03:09, 94.78s/it]
Task 0, Epoch 19/20 => Loss 0.461, Train_accy 88.45:  95%|█████████▌| 19/20 [30:05<01:34, 94.25s/it]
Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81:  95%|█████████▌| 19/20 [31:38<01:34, 94.25s/it]
Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81: 100%|██████████| 20/20 [31:38<00:00, 93.93s/it]
Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81: 100%|██████████| 20/20 [31:38<00:00, 94.94s/it]
2024-09-07 12:49:29,238 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81
2024-09-07 12:49:38,413 [trainer.py] => No NME accuracy.
2024-09-07 12:49:38,414 [trainer.py] => CNN: {'total': 81.47, '00-99': 81.47, 'old': 0, 'new': 81.47}
2024-09-07 12:49:38,414 [trainer.py] => CNN top1 curve: [81.47]
2024-09-07 12:49:38,414 [trainer.py] => CNN top5 curve: [93.74]

Average Accuracy (CNN): 81.47
2024-09-07 12:49:38,414 [trainer.py] => Average Accuracy (CNN): 81.47 

2024-09-07 12:49:38,416 [trainer.py] => All params: 85875556
2024-09-07 12:49:38,417 [trainer.py] => Trainable params: 85875556
2024-09-07 12:49:38,420 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.472, Train_accy 25.78, Test_accy 76.02:   0%|          | 0/20 [00:31<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.472, Train_accy 25.78, Test_accy 76.02:   5%|▌         | 1/20 [00:31<10:04, 31.82s/it]
Task 1, Epoch 2/20 => Loss 0.532, Train_accy 57.34:   5%|▌         | 1/20 [00:52<10:04, 31.82s/it]                 
Task 1, Epoch 2/20 => Loss 0.532, Train_accy 57.34:  10%|█         | 2/20 [00:52<07:35, 25.29s/it]
Task 1, Epoch 3/20 => Loss 0.433, Train_accy 65.03:  10%|█         | 2/20 [01:13<07:35, 25.29s/it]
Task 1, Epoch 3/20 => Loss 0.433, Train_accy 65.03:  15%|█▌        | 3/20 [01:13<06:33, 23.17s/it]
Task 1, Epoch 4/20 => Loss 0.343, Train_accy 71.78:  15%|█▌        | 3/20 [01:33<06:33, 23.17s/it]
Task 1, Epoch 4/20 => Loss 0.343, Train_accy 71.78:  20%|██        | 4/20 [01:33<05:55, 22.22s/it]
Task 1, Epoch 5/20 => Loss 0.320, Train_accy 73.70:  20%|██        | 4/20 [01:54<05:55, 22.22s/it]
Task 1, Epoch 5/20 => Loss 0.320, Train_accy 73.70:  25%|██▌       | 5/20 [01:54<05:25, 21.69s/it]
Task 1, Epoch 6/20 => Loss 0.298, Train_accy 75.72, Test_accy 79.29:  25%|██▌       | 5/20 [02:26<05:25, 21.69s/it]
Task 1, Epoch 6/20 => Loss 0.298, Train_accy 75.72, Test_accy 79.29:  30%|███       | 6/20 [02:26<05:51, 25.12s/it]
Task 1, Epoch 7/20 => Loss 0.284, Train_accy 76.59:  30%|███       | 6/20 [02:47<05:51, 25.12s/it]                 
Task 1, Epoch 7/20 => Loss 0.284, Train_accy 76.59:  35%|███▌      | 7/20 [02:47<05:07, 23.68s/it]
Task 1, Epoch 8/20 => Loss 0.295, Train_accy 76.85:  35%|███▌      | 7/20 [03:07<05:07, 23.68s/it]
Task 1, Epoch 8/20 => Loss 0.295, Train_accy 76.85:  40%|████      | 8/20 [03:07<04:32, 22.72s/it]
Task 1, Epoch 9/20 => Loss 0.254, Train_accy 79.17:  40%|████      | 8/20 [03:28<04:32, 22.72s/it]
Task 1, Epoch 9/20 => Loss 0.254, Train_accy 79.17:  45%|████▌     | 9/20 [03:28<04:03, 22.09s/it]
Task 1, Epoch 10/20 => Loss 0.223, Train_accy 81.09:  45%|████▌     | 9/20 [03:49<04:03, 22.09s/it]
Task 1, Epoch 10/20 => Loss 0.223, Train_accy 81.09:  50%|█████     | 10/20 [03:49<03:36, 21.70s/it]
Task 1, Epoch 11/20 => Loss 0.215, Train_accy 82.81, Test_accy 78.24:  50%|█████     | 10/20 [04:21<03:36, 21.70s/it]
Task 1, Epoch 11/20 => Loss 0.215, Train_accy 82.81, Test_accy 78.24:  55%|█████▌    | 11/20 [04:21<03:42, 24.78s/it]
Task 1, Epoch 12/20 => Loss 0.227, Train_accy 81.46:  55%|█████▌    | 11/20 [04:41<03:42, 24.78s/it]                 
Task 1, Epoch 12/20 => Loss 0.227, Train_accy 81.46:  60%|██████    | 12/20 [04:41<03:08, 23.54s/it]
Task 1, Epoch 13/20 => Loss 0.211, Train_accy 83.00:  60%|██████    | 12/20 [05:02<03:08, 23.54s/it]
Task 1, Epoch 13/20 => Loss 0.211, Train_accy 83.00:  65%|██████▌   | 13/20 [05:02<02:38, 22.66s/it]
Task 1, Epoch 14/20 => Loss 0.211, Train_accy 83.00:  65%|██████▌   | 13/20 [05:23<02:38, 22.66s/it]
Task 1, Epoch 14/20 => Loss 0.211, Train_accy 83.00:  70%|███████   | 14/20 [05:23<02:12, 22.09s/it]
Task 1, Epoch 15/20 => Loss 0.194, Train_accy 84.54:  70%|███████   | 14/20 [05:43<02:12, 22.09s/it]
Task 1, Epoch 15/20 => Loss 0.194, Train_accy 84.54:  75%|███████▌  | 15/20 [05:43<01:48, 21.67s/it]
Task 1, Epoch 16/20 => Loss 0.204, Train_accy 84.47, Test_accy 77.20:  75%|███████▌  | 15/20 [06:15<01:48, 21.67s/it]
Task 1, Epoch 16/20 => Loss 0.204, Train_accy 84.47, Test_accy 77.20:  80%|████████  | 16/20 [06:15<01:39, 24.79s/it]
Task 1, Epoch 17/20 => Loss 0.187, Train_accy 85.44:  80%|████████  | 16/20 [06:36<01:39, 24.79s/it]                 
Task 1, Epoch 17/20 => Loss 0.187, Train_accy 85.44:  85%|████████▌ | 17/20 [06:36<01:10, 23.59s/it]
Task 1, Epoch 18/20 => Loss 0.201, Train_accy 85.67:  85%|████████▌ | 17/20 [06:57<01:10, 23.59s/it]
Task 1, Epoch 18/20 => Loss 0.201, Train_accy 85.67:  90%|█████████ | 18/20 [06:57<00:45, 22.72s/it]
Task 1, Epoch 19/20 => Loss 0.197, Train_accy 85.85:  90%|█████████ | 18/20 [07:18<00:45, 22.72s/it]
Task 1, Epoch 19/20 => Loss 0.197, Train_accy 85.85:  95%|█████████▌| 19/20 [07:18<00:22, 22.13s/it]
Task 1, Epoch 20/20 => Loss 0.176, Train_accy 86.42:  95%|█████████▌| 19/20 [07:38<00:22, 22.13s/it]
Task 1, Epoch 20/20 => Loss 0.176, Train_accy 86.42: 100%|██████████| 20/20 [07:38<00:00, 21.70s/it]
Task 1, Epoch 20/20 => Loss 0.176, Train_accy 86.42: 100%|██████████| 20/20 [07:38<00:00, 22.95s/it]
2024-09-07 12:57:17,379 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.176, Train_accy 86.42
2024-09-07 12:57:28,514 [trainer.py] => No NME accuracy.
2024-09-07 12:57:28,514 [trainer.py] => CNN: {'total': 75.91, '00-99': 74.64, '100-119': 81.67, 'old': 74.64, 'new': 81.67}
2024-09-07 12:57:28,515 [trainer.py] => CNN top1 curve: [81.47, 75.91]
2024-09-07 12:57:28,515 [trainer.py] => CNN top5 curve: [93.74, 91.5]

Average Accuracy (CNN): 78.69
2024-09-07 12:57:28,515 [trainer.py] => Average Accuracy (CNN): 78.69 

2024-09-07 12:57:28,517 [trainer.py] => All params: 85890936
2024-09-07 12:57:28,518 [trainer.py] => Trainable params: 85890936
2024-09-07 12:57:28,521 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.579, Train_accy 22.27, Test_accy 71.45:   0%|          | 0/20 [00:29<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.579, Train_accy 22.27, Test_accy 71.45:   5%|▌         | 1/20 [00:29<09:18, 29.38s/it]
Task 2, Epoch 2/20 => Loss 0.601, Train_accy 56.78:   5%|▌         | 1/20 [00:46<09:18, 29.38s/it]                 
Task 2, Epoch 2/20 => Loss 0.601, Train_accy 56.78:  10%|█         | 2/20 [00:46<06:34, 21.91s/it]
Task 2, Epoch 3/20 => Loss 0.489, Train_accy 65.63:  10%|█         | 2/20 [01:02<06:34, 21.91s/it]
Task 2, Epoch 3/20 => Loss 0.489, Train_accy 65.63:  15%|█▌        | 3/20 [01:02<05:31, 19.51s/it]
Task 2, Epoch 4/20 => Loss 0.371, Train_accy 70.81:  15%|█▌        | 3/20 [01:19<05:31, 19.51s/it]
Task 2, Epoch 4/20 => Loss 0.371, Train_accy 70.81:  20%|██        | 4/20 [01:19<04:54, 18.40s/it]
Task 2, Epoch 5/20 => Loss 0.319, Train_accy 75.05:  20%|██        | 4/20 [01:35<04:54, 18.40s/it]
Task 2, Epoch 5/20 => Loss 0.319, Train_accy 75.05:  25%|██▌       | 5/20 [01:35<04:26, 17.75s/it]
Task 2, Epoch 6/20 => Loss 0.277, Train_accy 78.48, Test_accy 74.04:  25%|██▌       | 5/20 [02:05<04:26, 17.75s/it]
Task 2, Epoch 6/20 => Loss 0.277, Train_accy 78.48, Test_accy 74.04:  30%|███       | 6/20 [02:05<05:03, 21.68s/it]
Task 2, Epoch 7/20 => Loss 0.282, Train_accy 79.14:  30%|███       | 6/20 [02:22<05:03, 21.68s/it]                 
Task 2, Epoch 7/20 => Loss 0.282, Train_accy 79.14:  35%|███▌      | 7/20 [02:22<04:20, 20.06s/it]
Task 2, Epoch 8/20 => Loss 0.275, Train_accy 79.05:  35%|███▌      | 7/20 [02:38<04:20, 20.06s/it]
Task 2, Epoch 8/20 => Loss 0.275, Train_accy 79.05:  40%|████      | 8/20 [02:38<03:47, 18.96s/it]
Task 2, Epoch 9/20 => Loss 0.271, Train_accy 79.80:  40%|████      | 8/20 [02:55<03:47, 18.96s/it]
Task 2, Epoch 9/20 => Loss 0.271, Train_accy 79.80:  45%|████▌     | 9/20 [02:55<03:20, 18.24s/it]
Task 2, Epoch 10/20 => Loss 0.223, Train_accy 81.03:  45%|████▌     | 9/20 [03:11<03:20, 18.24s/it]
Task 2, Epoch 10/20 => Loss 0.223, Train_accy 81.03:  50%|█████     | 10/20 [03:11<02:57, 17.75s/it]
Task 2, Epoch 11/20 => Loss 0.228, Train_accy 81.83, Test_accy 72.59:  50%|█████     | 10/20 [03:41<02:57, 17.75s/it]
Task 2, Epoch 11/20 => Loss 0.228, Train_accy 81.83, Test_accy 72.59:  55%|█████▌    | 11/20 [03:41<03:11, 21.32s/it]
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 84.42:  55%|█████▌    | 11/20 [03:58<03:11, 21.32s/it]                 
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 84.42:  60%|██████    | 12/20 [03:58<02:39, 19.92s/it]
Task 2, Epoch 13/20 => Loss 0.162, Train_accy 85.26:  60%|██████    | 12/20 [04:14<02:39, 19.92s/it]
Task 2, Epoch 13/20 => Loss 0.162, Train_accy 85.26:  65%|██████▌   | 13/20 [04:14<02:12, 18.95s/it]
Task 2, Epoch 14/20 => Loss 0.204, Train_accy 84.13:  65%|██████▌   | 13/20 [04:31<02:12, 18.95s/it]
Task 2, Epoch 14/20 => Loss 0.204, Train_accy 84.13:  70%|███████   | 14/20 [04:31<01:49, 18.25s/it]
Task 2, Epoch 15/20 => Loss 0.209, Train_accy 84.13:  70%|███████   | 14/20 [04:48<01:49, 18.25s/it]
Task 2, Epoch 15/20 => Loss 0.209, Train_accy 84.13:  75%|███████▌  | 15/20 [04:48<01:28, 17.79s/it]
Task 2, Epoch 16/20 => Loss 0.184, Train_accy 84.84, Test_accy 71.93:  75%|███████▌  | 15/20 [05:17<01:28, 17.79s/it]
Task 2, Epoch 16/20 => Loss 0.184, Train_accy 84.84, Test_accy 71.93:  80%|████████  | 16/20 [05:17<01:25, 21.27s/it]
Task 2, Epoch 17/20 => Loss 0.171, Train_accy 85.73:  80%|████████  | 16/20 [05:34<01:25, 21.27s/it]                 
Task 2, Epoch 17/20 => Loss 0.171, Train_accy 85.73:  85%|████████▌ | 17/20 [05:34<00:59, 19.86s/it]
Task 2, Epoch 18/20 => Loss 0.209, Train_accy 86.30:  85%|████████▌ | 17/20 [05:50<00:59, 19.86s/it]
Task 2, Epoch 18/20 => Loss 0.209, Train_accy 86.30:  90%|█████████ | 18/20 [05:50<00:37, 18.92s/it]
Task 2, Epoch 19/20 => Loss 0.163, Train_accy 86.53:  90%|█████████ | 18/20 [06:07<00:37, 18.92s/it]
Task 2, Epoch 19/20 => Loss 0.163, Train_accy 86.53:  95%|█████████▌| 19/20 [06:07<00:18, 18.23s/it]
Task 2, Epoch 20/20 => Loss 0.163, Train_accy 87.15:  95%|█████████▌| 19/20 [06:24<00:18, 18.23s/it]
Task 2, Epoch 20/20 => Loss 0.163, Train_accy 87.15: 100%|██████████| 20/20 [06:24<00:00, 17.76s/it]
Task 2, Epoch 20/20 => Loss 0.163, Train_accy 87.15: 100%|██████████| 20/20 [06:24<00:00, 19.21s/it]
2024-09-07 13:03:52,671 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.163, Train_accy 87.15
2024-09-07 13:04:05,365 [trainer.py] => No NME accuracy.
2024-09-07 13:04:05,366 [trainer.py] => CNN: {'total': 70.24, '00-99': 67.64, '100-119': 74.24, '120-139': 79.26, 'old': 68.83, 'new': 79.26}
2024-09-07 13:04:05,366 [trainer.py] => CNN top1 curve: [81.47, 75.91, 70.24]
2024-09-07 13:04:05,366 [trainer.py] => CNN top5 curve: [93.74, 91.5, 88.4]

Average Accuracy (CNN): 75.87
2024-09-07 13:04:05,366 [trainer.py] => Average Accuracy (CNN): 75.87 

2024-09-07 13:04:05,367 [trainer.py] => All params: 85906316
2024-09-07 13:04:05,368 [trainer.py] => Trainable params: 85906316
2024-09-07 13:04:05,371 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.308, Train_accy 33.56, Test_accy 69.49:   0%|          | 0/20 [00:36<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.308, Train_accy 33.56, Test_accy 69.49:   5%|▌         | 1/20 [00:36<11:39, 36.84s/it]
Task 3, Epoch 2/20 => Loss 0.548, Train_accy 62.25:   5%|▌         | 1/20 [00:58<11:39, 36.84s/it]                 
Task 3, Epoch 2/20 => Loss 0.548, Train_accy 62.25:  10%|█         | 2/20 [00:58<08:24, 28.02s/it]
Task 3, Epoch 3/20 => Loss 0.431, Train_accy 69.21:  10%|█         | 2/20 [01:20<08:24, 28.02s/it]
Task 3, Epoch 3/20 => Loss 0.431, Train_accy 69.21:  15%|█▌        | 3/20 [01:20<07:08, 25.21s/it]
Task 3, Epoch 4/20 => Loss 0.346, Train_accy 73.90:  15%|█▌        | 3/20 [01:42<07:08, 25.21s/it]
Task 3, Epoch 4/20 => Loss 0.346, Train_accy 73.90:  20%|██        | 4/20 [01:42<06:21, 23.86s/it]
Task 3, Epoch 5/20 => Loss 0.323, Train_accy 77.95:  20%|██        | 4/20 [02:04<06:21, 23.86s/it]
Task 3, Epoch 5/20 => Loss 0.323, Train_accy 77.95:  25%|██▌       | 5/20 [02:04<05:47, 23.15s/it]
Task 3, Epoch 6/20 => Loss 0.298, Train_accy 78.30, Test_accy 70.75:  25%|██▌       | 5/20 [02:41<05:47, 23.15s/it]
Task 3, Epoch 6/20 => Loss 0.298, Train_accy 78.30, Test_accy 70.75:  30%|███       | 6/20 [02:41<06:29, 27.79s/it]
Task 3, Epoch 7/20 => Loss 0.278, Train_accy 79.40:  30%|███       | 6/20 [03:02<06:29, 27.79s/it]                 
Task 3, Epoch 7/20 => Loss 0.278, Train_accy 79.40:  35%|███▌      | 7/20 [03:02<05:36, 25.85s/it]
Task 3, Epoch 8/20 => Loss 0.231, Train_accy 81.61:  35%|███▌      | 7/20 [03:24<05:36, 25.85s/it]
Task 3, Epoch 8/20 => Loss 0.231, Train_accy 81.61:  40%|████      | 8/20 [03:24<04:55, 24.59s/it]
Task 3, Epoch 9/20 => Loss 0.252, Train_accy 81.96:  40%|████      | 8/20 [03:46<04:55, 24.59s/it]
Task 3, Epoch 9/20 => Loss 0.252, Train_accy 81.96:  45%|████▌     | 9/20 [03:46<04:22, 23.83s/it]
Task 3, Epoch 10/20 => Loss 0.243, Train_accy 83.20:  45%|████▌     | 9/20 [04:09<04:22, 23.83s/it]
Task 3, Epoch 10/20 => Loss 0.243, Train_accy 83.20:  50%|█████     | 10/20 [04:09<03:52, 23.29s/it]
Task 3, Epoch 11/20 => Loss 0.222, Train_accy 83.84, Test_accy 69.49:  50%|█████     | 10/20 [04:45<03:52, 23.29s/it]
Task 3, Epoch 11/20 => Loss 0.222, Train_accy 83.84, Test_accy 69.49:  55%|█████▌    | 11/20 [04:45<04:05, 27.30s/it]
Task 3, Epoch 12/20 => Loss 0.204, Train_accy 85.05:  55%|█████▌    | 11/20 [05:07<04:05, 27.30s/it]                 
Task 3, Epoch 12/20 => Loss 0.204, Train_accy 85.05:  60%|██████    | 12/20 [05:07<03:24, 25.62s/it]
Task 3, Epoch 13/20 => Loss 0.227, Train_accy 85.62:  60%|██████    | 12/20 [05:28<03:24, 25.62s/it]
Task 3, Epoch 13/20 => Loss 0.227, Train_accy 85.62:  65%|██████▌   | 13/20 [05:28<02:51, 24.46s/it]
Task 3, Epoch 14/20 => Loss 0.204, Train_accy 87.07:  65%|██████▌   | 13/20 [05:50<02:51, 24.46s/it]
Task 3, Epoch 14/20 => Loss 0.204, Train_accy 87.07:  70%|███████   | 14/20 [05:50<02:21, 23.65s/it]
Task 3, Epoch 15/20 => Loss 0.236, Train_accy 85.83:  70%|███████   | 14/20 [06:12<02:21, 23.65s/it]
Task 3, Epoch 15/20 => Loss 0.236, Train_accy 85.83:  75%|███████▌  | 15/20 [06:12<01:55, 23.09s/it]
Task 3, Epoch 16/20 => Loss 0.210, Train_accy 87.25, Test_accy 69.13:  75%|███████▌  | 15/20 [06:49<01:55, 23.09s/it]
Task 3, Epoch 16/20 => Loss 0.210, Train_accy 87.25, Test_accy 69.13:  80%|████████  | 16/20 [06:49<01:48, 27.12s/it]
Task 3, Epoch 17/20 => Loss 0.187, Train_accy 87.82:  80%|████████  | 16/20 [07:10<01:48, 27.12s/it]                 
Task 3, Epoch 17/20 => Loss 0.187, Train_accy 87.82:  85%|████████▌ | 17/20 [07:10<01:16, 25.57s/it]
Task 3, Epoch 18/20 => Loss 0.164, Train_accy 88.49:  85%|████████▌ | 17/20 [07:33<01:16, 25.57s/it]
Task 3, Epoch 18/20 => Loss 0.164, Train_accy 88.49:  90%|█████████ | 18/20 [07:33<00:49, 24.53s/it]
Task 3, Epoch 19/20 => Loss 0.175, Train_accy 88.35:  90%|█████████ | 18/20 [07:55<00:49, 24.53s/it]
Task 3, Epoch 19/20 => Loss 0.175, Train_accy 88.35:  95%|█████████▌| 19/20 [07:55<00:23, 23.75s/it]
Task 3, Epoch 20/20 => Loss 0.171, Train_accy 88.78:  95%|█████████▌| 19/20 [08:16<00:23, 23.75s/it]
Task 3, Epoch 20/20 => Loss 0.171, Train_accy 88.78: 100%|██████████| 20/20 [08:16<00:00, 23.20s/it]
Task 3, Epoch 20/20 => Loss 0.171, Train_accy 88.78: 100%|██████████| 20/20 [08:16<00:00, 24.85s/it]
2024-09-07 13:12:22,325 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.171, Train_accy 88.78
2024-09-07 13:12:37,112 [trainer.py] => No NME accuracy.
2024-09-07 13:12:37,113 [trainer.py] => CNN: {'total': 68.28, '00-99': 64.19, '100-119': 65.15, '120-139': 71.35, '140-159': 85.46, 'old': 65.31, 'new': 85.46}
2024-09-07 13:12:37,113 [trainer.py] => CNN top1 curve: [81.47, 75.91, 70.24, 68.28]
2024-09-07 13:12:37,113 [trainer.py] => CNN top5 curve: [93.74, 91.5, 88.4, 86.75]

Average Accuracy (CNN): 73.97
2024-09-07 13:12:37,113 [trainer.py] => Average Accuracy (CNN): 73.97 

2024-09-07 13:12:37,114 [trainer.py] => All params: 85921696
2024-09-07 13:12:37,115 [trainer.py] => Trainable params: 85921696
2024-09-07 13:12:37,119 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.035, Train_accy 12.68, Test_accy 64.97:   0%|          | 0/20 [00:31<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.035, Train_accy 12.68, Test_accy 64.97:   5%|▌         | 1/20 [00:31<10:00, 31.61s/it]
Task 4, Epoch 2/20 => Loss 0.754, Train_accy 54.26:   5%|▌         | 1/20 [00:46<10:00, 31.61s/it]                 
Task 4, Epoch 2/20 => Loss 0.754, Train_accy 54.26:  10%|█         | 2/20 [00:46<06:36, 22.05s/it]
Task 4, Epoch 3/20 => Loss 0.559, Train_accy 65.50:  10%|█         | 2/20 [01:02<06:36, 22.05s/it]
Task 4, Epoch 3/20 => Loss 0.559, Train_accy 65.50:  15%|█▌        | 3/20 [01:02<05:21, 18.94s/it]
Task 4, Epoch 4/20 => Loss 0.485, Train_accy 69.61:  15%|█▌        | 3/20 [01:17<05:21, 18.94s/it]
Task 4, Epoch 4/20 => Loss 0.485, Train_accy 69.61:  20%|██        | 4/20 [01:17<04:39, 17.49s/it]
Task 4, Epoch 5/20 => Loss 0.408, Train_accy 73.82:  20%|██        | 4/20 [01:32<04:39, 17.49s/it]
Task 4, Epoch 5/20 => Loss 0.408, Train_accy 73.82:  25%|██▌       | 5/20 [01:32<04:10, 16.69s/it]
Task 4, Epoch 6/20 => Loss 0.378, Train_accy 75.87, Test_accy 67.85:  25%|██▌       | 5/20 [02:04<04:10, 16.69s/it]
Task 4, Epoch 6/20 => Loss 0.378, Train_accy 75.87, Test_accy 67.85:  30%|███       | 6/20 [02:04<05:03, 21.67s/it]
Task 4, Epoch 7/20 => Loss 0.358, Train_accy 76.80:  30%|███       | 6/20 [02:19<05:03, 21.67s/it]                 
Task 4, Epoch 7/20 => Loss 0.358, Train_accy 76.80:  35%|███▌      | 7/20 [02:19<04:14, 19.59s/it]
Task 4, Epoch 8/20 => Loss 0.297, Train_accy 78.85:  35%|███▌      | 7/20 [02:34<04:14, 19.59s/it]
Task 4, Epoch 8/20 => Loss 0.297, Train_accy 78.85:  40%|████      | 8/20 [02:34<03:38, 18.21s/it]
Task 4, Epoch 9/20 => Loss 0.337, Train_accy 78.08:  40%|████      | 8/20 [02:49<03:38, 18.21s/it]
Task 4, Epoch 9/20 => Loss 0.337, Train_accy 78.08:  45%|████▌     | 9/20 [02:49<03:10, 17.28s/it]
Task 4, Epoch 10/20 => Loss 0.288, Train_accy 80.65:  45%|████▌     | 9/20 [03:05<03:10, 17.28s/it]
Task 4, Epoch 10/20 => Loss 0.288, Train_accy 80.65:  50%|█████     | 10/20 [03:05<02:46, 16.66s/it]
Task 4, Epoch 11/20 => Loss 0.307, Train_accy 81.72, Test_accy 67.20:  50%|█████     | 10/20 [03:36<02:46, 16.66s/it]
Task 4, Epoch 11/20 => Loss 0.307, Train_accy 81.72, Test_accy 67.20:  55%|█████▌    | 11/20 [03:36<03:10, 21.11s/it]
Task 4, Epoch 12/20 => Loss 0.268, Train_accy 82.34:  55%|█████▌    | 11/20 [03:51<03:10, 21.11s/it]                 
Task 4, Epoch 12/20 => Loss 0.268, Train_accy 82.34:  60%|██████    | 12/20 [03:51<02:34, 19.33s/it]
Task 4, Epoch 13/20 => Loss 0.254, Train_accy 82.85:  60%|██████    | 12/20 [04:06<02:34, 19.33s/it]
Task 4, Epoch 13/20 => Loss 0.254, Train_accy 82.85:  65%|██████▌   | 13/20 [04:06<02:06, 18.10s/it]
Task 4, Epoch 14/20 => Loss 0.214, Train_accy 84.29:  65%|██████▌   | 13/20 [04:22<02:06, 18.10s/it]
Task 4, Epoch 14/20 => Loss 0.214, Train_accy 84.29:  70%|███████   | 14/20 [04:22<01:43, 17.23s/it]
Task 4, Epoch 15/20 => Loss 0.228, Train_accy 85.01:  70%|███████   | 14/20 [04:37<01:43, 17.23s/it]
Task 4, Epoch 15/20 => Loss 0.228, Train_accy 85.01:  75%|███████▌  | 15/20 [04:37<01:23, 16.66s/it]
Task 4, Epoch 16/20 => Loss 0.251, Train_accy 83.88, Test_accy 66.30:  75%|███████▌  | 15/20 [05:08<01:23, 16.66s/it]
Task 4, Epoch 16/20 => Loss 0.251, Train_accy 83.88, Test_accy 66.30:  80%|████████  | 16/20 [05:08<01:24, 21.11s/it]
Task 4, Epoch 17/20 => Loss 0.223, Train_accy 86.19:  80%|████████  | 16/20 [05:24<01:24, 21.11s/it]                 
Task 4, Epoch 17/20 => Loss 0.223, Train_accy 86.19:  85%|████████▌ | 17/20 [05:24<00:58, 19.36s/it]
Task 4, Epoch 18/20 => Loss 0.190, Train_accy 87.22:  85%|████████▌ | 17/20 [05:39<00:58, 19.36s/it]
Task 4, Epoch 18/20 => Loss 0.190, Train_accy 87.22:  90%|█████████ | 18/20 [05:39<00:36, 18.12s/it]
Task 4, Epoch 19/20 => Loss 0.187, Train_accy 88.66:  90%|█████████ | 18/20 [05:54<00:36, 18.12s/it]
Task 4, Epoch 19/20 => Loss 0.187, Train_accy 88.66:  95%|█████████▌| 19/20 [05:54<00:17, 17.26s/it]
Task 4, Epoch 20/20 => Loss 0.206, Train_accy 86.40:  95%|█████████▌| 19/20 [06:09<00:17, 17.26s/it]
Task 4, Epoch 20/20 => Loss 0.206, Train_accy 86.40: 100%|██████████| 20/20 [06:09<00:00, 16.65s/it]
Task 4, Epoch 20/20 => Loss 0.206, Train_accy 86.40: 100%|██████████| 20/20 [06:09<00:00, 18.49s/it]
2024-09-07 13:18:47,020 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.206, Train_accy 86.40
2024-09-07 13:19:03,240 [trainer.py] => No NME accuracy.
2024-09-07 13:19:03,241 [trainer.py] => CNN: {'total': 65.5, '00-99': 60.94, '100-119': 60.3, '120-139': 67.49, '140-159': 77.5, '160-179': 80.54, 'old': 64.05, 'new': 80.54}
2024-09-07 13:19:03,241 [trainer.py] => CNN top1 curve: [81.47, 75.91, 70.24, 68.28, 65.5]
2024-09-07 13:19:03,241 [trainer.py] => CNN top5 curve: [93.74, 91.5, 88.4, 86.75, 84.41]

Average Accuracy (CNN): 72.28
2024-09-07 13:19:03,241 [trainer.py] => Average Accuracy (CNN): 72.28 

2024-09-07 13:19:03,242 [trainer.py] => All params: 85937076
2024-09-07 13:19:03,243 [trainer.py] => Trainable params: 85937076
2024-09-07 13:19:03,246 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.437, Train_accy 21.41, Test_accy 63.72:   0%|          | 0/20 [00:35<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.437, Train_accy 21.41, Test_accy 63.72:   5%|▌         | 1/20 [00:35<11:16, 35.59s/it]
Task 5, Epoch 2/20 => Loss 0.518, Train_accy 58.33:   5%|▌         | 1/20 [00:53<11:16, 35.59s/it]                 
Task 5, Epoch 2/20 => Loss 0.518, Train_accy 58.33:  10%|█         | 2/20 [00:53<07:31, 25.06s/it]
Task 5, Epoch 3/20 => Loss 0.414, Train_accy 66.52:  10%|█         | 2/20 [01:10<07:31, 25.06s/it]
Task 5, Epoch 3/20 => Loss 0.414, Train_accy 66.52:  15%|█▌        | 3/20 [01:10<06:08, 21.68s/it]
Task 5, Epoch 4/20 => Loss 0.358, Train_accy 71.63:  15%|█▌        | 3/20 [01:28<06:08, 21.68s/it]
Task 5, Epoch 4/20 => Loss 0.358, Train_accy 71.63:  20%|██        | 4/20 [01:28<05:21, 20.10s/it]
Task 5, Epoch 5/20 => Loss 0.318, Train_accy 73.08:  20%|██        | 4/20 [01:46<05:21, 20.10s/it]
Task 5, Epoch 5/20 => Loss 0.318, Train_accy 73.08:  25%|██▌       | 5/20 [01:46<04:48, 19.21s/it]
Task 5, Epoch 6/20 => Loss 0.264, Train_accy 77.89, Test_accy 63.87:  25%|██▌       | 5/20 [02:21<04:48, 19.21s/it]
Task 5, Epoch 6/20 => Loss 0.264, Train_accy 77.89, Test_accy 63.87:  30%|███       | 6/20 [02:21<05:46, 24.72s/it]
Task 5, Epoch 7/20 => Loss 0.282, Train_accy 76.48:  30%|███       | 6/20 [02:39<05:46, 24.72s/it]                 
Task 5, Epoch 7/20 => Loss 0.282, Train_accy 76.48:  35%|███▌      | 7/20 [02:39<04:51, 22.42s/it]
Task 5, Epoch 8/20 => Loss 0.286, Train_accy 77.80:  35%|███▌      | 7/20 [02:57<04:51, 22.42s/it]
Task 5, Epoch 8/20 => Loss 0.286, Train_accy 77.80:  40%|████      | 8/20 [02:57<04:10, 20.91s/it]
Task 5, Epoch 9/20 => Loss 0.269, Train_accy 81.41:  40%|████      | 8/20 [03:14<04:10, 20.91s/it]
Task 5, Epoch 9/20 => Loss 0.269, Train_accy 81.41:  45%|████▌     | 9/20 [03:14<03:38, 19.91s/it]
Task 5, Epoch 10/20 => Loss 0.285, Train_accy 79.16:  45%|████▌     | 9/20 [03:32<03:38, 19.91s/it]
Task 5, Epoch 10/20 => Loss 0.285, Train_accy 79.16:  50%|█████     | 10/20 [03:32<03:12, 19.22s/it]
Task 5, Epoch 11/20 => Loss 0.250, Train_accy 80.53, Test_accy 63.92:  50%|█████     | 10/20 [04:07<03:12, 19.22s/it]
Task 5, Epoch 11/20 => Loss 0.250, Train_accy 80.53, Test_accy 63.92:  55%|█████▌    | 11/20 [04:07<03:37, 24.18s/it]
Task 5, Epoch 12/20 => Loss 0.198, Train_accy 83.04:  55%|█████▌    | 11/20 [04:25<03:37, 24.18s/it]                 
Task 5, Epoch 12/20 => Loss 0.198, Train_accy 83.04:  60%|██████    | 12/20 [04:25<02:57, 22.21s/it]
Task 5, Epoch 13/20 => Loss 0.219, Train_accy 82.29:  60%|██████    | 12/20 [04:43<02:57, 22.21s/it]
Task 5, Epoch 13/20 => Loss 0.219, Train_accy 82.29:  65%|██████▌   | 13/20 [04:43<02:25, 20.83s/it]
Task 5, Epoch 14/20 => Loss 0.206, Train_accy 82.29:  65%|██████▌   | 13/20 [05:00<02:25, 20.83s/it]
Task 5, Epoch 14/20 => Loss 0.206, Train_accy 82.29:  70%|███████   | 14/20 [05:00<01:59, 19.89s/it]
Task 5, Epoch 15/20 => Loss 0.190, Train_accy 85.07:  70%|███████   | 14/20 [05:18<01:59, 19.89s/it]
Task 5, Epoch 15/20 => Loss 0.190, Train_accy 85.07:  75%|███████▌  | 15/20 [05:18<01:36, 19.24s/it]
Task 5, Epoch 16/20 => Loss 0.182, Train_accy 85.02, Test_accy 62.18:  75%|███████▌  | 15/20 [05:54<01:36, 19.24s/it]
Task 5, Epoch 16/20 => Loss 0.182, Train_accy 85.02, Test_accy 62.18:  80%|████████  | 16/20 [05:54<01:36, 24.13s/it]
Task 5, Epoch 17/20 => Loss 0.170, Train_accy 86.26:  80%|████████  | 16/20 [06:11<01:36, 24.13s/it]                 
Task 5, Epoch 17/20 => Loss 0.170, Train_accy 86.26:  85%|████████▌ | 17/20 [06:11<01:06, 22.23s/it]
Task 5, Epoch 18/20 => Loss 0.179, Train_accy 86.17:  85%|████████▌ | 17/20 [06:29<01:06, 22.23s/it]
Task 5, Epoch 18/20 => Loss 0.179, Train_accy 86.17:  90%|█████████ | 18/20 [06:29<00:41, 20.87s/it]
Task 5, Epoch 19/20 => Loss 0.204, Train_accy 84.98:  90%|█████████ | 18/20 [06:47<00:41, 20.87s/it]
Task 5, Epoch 19/20 => Loss 0.204, Train_accy 84.98:  95%|█████████▌| 19/20 [06:47<00:19, 19.95s/it]
Task 5, Epoch 20/20 => Loss 0.162, Train_accy 87.22:  95%|█████████▌| 19/20 [07:05<00:19, 19.95s/it]
Task 5, Epoch 20/20 => Loss 0.162, Train_accy 87.22: 100%|██████████| 20/20 [07:05<00:00, 19.27s/it]
Task 5, Epoch 20/20 => Loss 0.162, Train_accy 87.22: 100%|██████████| 20/20 [07:05<00:00, 21.26s/it]
2024-09-07 13:26:08,375 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.162, Train_accy 87.22
2024-09-07 13:26:26,000 [trainer.py] => No NME accuracy.
2024-09-07 13:26:26,001 [trainer.py] => CNN: {'total': 63.15, '00-99': 57.99, '100-119': 57.73, '120-139': 62.04, '140-159': 72.15, '160-179': 69.46, '180-199': 80.48, 'old': 61.3, 'new': 80.48}
2024-09-07 13:26:26,001 [trainer.py] => CNN top1 curve: [81.47, 75.91, 70.24, 68.28, 65.5, 63.15]
2024-09-07 13:26:26,001 [trainer.py] => CNN top5 curve: [93.74, 91.5, 88.4, 86.75, 84.41, 83.88]

Average Accuracy (CNN): 70.76
2024-09-07 13:26:26,001 [trainer.py] => Average Accuracy (CNN): 70.76 

Accuracy Matrix (CNN):
[[81.47 74.64 67.64 64.19 60.94 57.99]
 [ 0.   81.67 74.24 65.15 60.3  57.73]
 [ 0.    0.   79.26 71.35 67.49 62.04]
 [ 0.    0.    0.   85.46 77.5  72.15]
 [ 0.    0.    0.    0.   80.54 69.46]
 [ 0.    0.    0.    0.    0.   80.48]]
2024-09-07 13:26:26,002 [trainer.py] => Forgetting (CNN): 17.806000000000004
2024-09-07 13:26:28,866 [trainer.py] => config: ./exps/finetune_inr_B100_Inc10.json
2024-09-07 13:26:28,866 [trainer.py] => prefix: reproduce
2024-09-07 13:26:28,866 [trainer.py] => dataset: imagenetr
2024-09-07 13:26:28,866 [trainer.py] => memory_size: 0
2024-09-07 13:26:28,867 [trainer.py] => memory_per_class: 0
2024-09-07 13:26:28,867 [trainer.py] => fixed_memory: False
2024-09-07 13:26:28,867 [trainer.py] => shuffle: True
2024-09-07 13:26:28,867 [trainer.py] => init_cls: 100
2024-09-07 13:26:28,867 [trainer.py] => increment: 10
2024-09-07 13:26:28,867 [trainer.py] => model_name: finetune
2024-09-07 13:26:28,867 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-07 13:26:28,867 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 13:26:28,867 [trainer.py] => seed: 1993
2024-09-07 13:26:28,867 [trainer.py] => init_epoch: 20
2024-09-07 13:26:28,867 [trainer.py] => init_lr: 0.001
2024-09-07 13:26:28,867 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-07 13:26:28,867 [trainer.py] => init_lr_decay: 0.1
2024-09-07 13:26:28,867 [trainer.py] => init_weight_decay: 0.0005
2024-09-07 13:26:28,867 [trainer.py] => epochs: 20
2024-09-07 13:26:28,867 [trainer.py] => lrate: 0.001
2024-09-07 13:26:28,867 [trainer.py] => milestones: [40, 70]
2024-09-07 13:26:28,867 [trainer.py] => lrate_decay: 0.1
2024-09-07 13:26:28,867 [trainer.py] => batch_size: 48
2024-09-07 13:26:28,867 [trainer.py] => weight_decay: 0.0002
2024-09-07 13:26:28,950 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 13:26:30,702 [trainer.py] => All params: 85798656
2024-09-07 13:26:30,702 [trainer.py] => Trainable params: 85798656
2024-09-07 13:26:30,703 [finetune.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.606, Train_accy 1.96, Test_accy 2.24:   0%|          | 0/20 [01:41<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.606, Train_accy 1.96, Test_accy 2.24:   5%|▌         | 1/20 [01:41<32:12, 101.74s/it]
Task 0, Epoch 2/20 => Loss 4.480, Train_accy 3.37:   5%|▌         | 1/20 [03:14<32:12, 101.74s/it]                
Task 0, Epoch 2/20 => Loss 4.480, Train_accy 3.37:  10%|█         | 2/20 [03:14<28:57, 96.54s/it] 
Task 0, Epoch 3/20 => Loss 3.849, Train_accy 15.40:  10%|█         | 2/20 [04:47<28:57, 96.54s/it]
Task 0, Epoch 3/20 => Loss 3.849, Train_accy 15.40:  15%|█▌        | 3/20 [04:47<26:53, 94.88s/it]
Task 0, Epoch 4/20 => Loss 1.605, Train_accy 61.88:  15%|█▌        | 3/20 [06:20<26:53, 94.88s/it]
Task 0, Epoch 4/20 => Loss 1.605, Train_accy 61.88:  20%|██        | 4/20 [06:20<25:06, 94.16s/it]
Task 0, Epoch 5/20 => Loss 1.149, Train_accy 71.99:  20%|██        | 4/20 [07:53<25:06, 94.16s/it]
Task 0, Epoch 5/20 => Loss 1.149, Train_accy 71.99:  25%|██▌       | 5/20 [07:53<23:26, 93.74s/it]
Task 0, Epoch 6/20 => Loss 0.959, Train_accy 76.71, Test_accy 80.74:  25%|██▌       | 5/20 [09:35<23:26, 93.74s/it]
Task 0, Epoch 6/20 => Loss 0.959, Train_accy 76.71, Test_accy 80.74:  30%|███       | 6/20 [09:35<22:31, 96.50s/it]
Task 0, Epoch 7/20 => Loss 0.858, Train_accy 78.89:  30%|███       | 6/20 [11:08<22:31, 96.50s/it]                 
Task 0, Epoch 7/20 => Loss 0.858, Train_accy 78.89:  35%|███▌      | 7/20 [11:08<20:39, 95.38s/it]
Task 0, Epoch 8/20 => Loss 0.766, Train_accy 81.02:  35%|███▌      | 7/20 [12:41<20:39, 95.38s/it]
Task 0, Epoch 8/20 => Loss 0.766, Train_accy 81.02:  40%|████      | 8/20 [12:41<18:56, 94.69s/it]
Task 0, Epoch 9/20 => Loss 0.729, Train_accy 81.86:  40%|████      | 8/20 [14:14<18:56, 94.69s/it]
Task 0, Epoch 9/20 => Loss 0.729, Train_accy 81.86:  45%|████▌     | 9/20 [14:14<17:15, 94.18s/it]
Task 0, Epoch 10/20 => Loss 0.663, Train_accy 83.58:  45%|████▌     | 9/20 [15:47<17:15, 94.18s/it]
Task 0, Epoch 10/20 => Loss 0.663, Train_accy 83.58:  50%|█████     | 10/20 [15:47<15:37, 93.79s/it]
Task 0, Epoch 11/20 => Loss 0.641, Train_accy 84.02, Test_accy 81.74:  50%|█████     | 10/20 [17:29<15:37, 93.79s/it]
Task 0, Epoch 11/20 => Loss 0.641, Train_accy 84.02, Test_accy 81.74:  55%|█████▌    | 11/20 [17:29<14:26, 96.24s/it]
Task 0, Epoch 12/20 => Loss 0.590, Train_accy 85.56:  55%|█████▌    | 11/20 [19:02<14:26, 96.24s/it]                 
Task 0, Epoch 12/20 => Loss 0.590, Train_accy 85.56:  60%|██████    | 12/20 [19:02<12:42, 95.27s/it]
Task 0, Epoch 13/20 => Loss 0.568, Train_accy 86.30:  60%|██████    | 12/20 [20:35<12:42, 95.27s/it]
Task 0, Epoch 13/20 => Loss 0.568, Train_accy 86.30:  65%|██████▌   | 13/20 [20:35<11:01, 94.57s/it]
Task 0, Epoch 14/20 => Loss 0.534, Train_accy 86.72:  65%|██████▌   | 13/20 [22:08<11:01, 94.57s/it]
Task 0, Epoch 14/20 => Loss 0.534, Train_accy 86.72:  70%|███████   | 14/20 [22:08<09:24, 94.11s/it]
Task 0, Epoch 15/20 => Loss 0.518, Train_accy 87.44:  70%|███████   | 14/20 [23:41<09:24, 94.11s/it]
Task 0, Epoch 15/20 => Loss 0.518, Train_accy 87.44:  75%|███████▌  | 15/20 [23:41<07:48, 93.76s/it]
Task 0, Epoch 16/20 => Loss 0.489, Train_accy 87.77, Test_accy 82.61:  75%|███████▌  | 15/20 [25:23<07:48, 93.76s/it]
Task 0, Epoch 16/20 => Loss 0.489, Train_accy 87.77, Test_accy 82.61:  80%|████████  | 16/20 [25:23<06:25, 96.28s/it]
Task 0, Epoch 17/20 => Loss 0.471, Train_accy 88.22:  80%|████████  | 16/20 [26:57<06:25, 96.28s/it]                 
Task 0, Epoch 17/20 => Loss 0.471, Train_accy 88.22:  85%|████████▌ | 17/20 [26:57<04:46, 95.43s/it]
Task 0, Epoch 18/20 => Loss 0.468, Train_accy 88.38:  85%|████████▌ | 17/20 [28:30<04:46, 95.43s/it]
Task 0, Epoch 18/20 => Loss 0.468, Train_accy 88.38:  90%|█████████ | 18/20 [28:30<03:09, 94.72s/it]
Task 0, Epoch 19/20 => Loss 0.461, Train_accy 88.45:  90%|█████████ | 18/20 [30:03<03:09, 94.72s/it]
Task 0, Epoch 19/20 => Loss 0.461, Train_accy 88.45:  95%|█████████▌| 19/20 [30:03<01:34, 94.17s/it]
Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81:  95%|█████████▌| 19/20 [31:35<01:34, 94.17s/it]
Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81: 100%|██████████| 20/20 [31:35<00:00, 93.78s/it]
Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81: 100%|██████████| 20/20 [31:35<00:00, 94.80s/it]
2024-09-07 13:58:07,097 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.435, Train_accy 88.81
2024-09-07 13:58:16,085 [trainer.py] => No NME accuracy.
2024-09-07 13:58:16,086 [trainer.py] => CNN: {'total': 81.47, '00-99': 81.47, 'old': 0, 'new': 81.47}
2024-09-07 13:58:16,086 [trainer.py] => CNN top1 curve: [81.47]
2024-09-07 13:58:16,086 [trainer.py] => CNN top5 curve: [93.74]

Average Accuracy (CNN): 81.47
2024-09-07 13:58:16,087 [trainer.py] => Average Accuracy (CNN): 81.47 

2024-09-07 13:58:16,088 [trainer.py] => All params: 85875556
2024-09-07 13:58:16,089 [trainer.py] => Trainable params: 85875556
2024-09-07 13:58:16,092 [finetune.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.157, Train_accy 17.09, Test_accy 77.85:   0%|          | 0/20 [00:19<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.157, Train_accy 17.09, Test_accy 77.85:   5%|▌         | 1/20 [00:19<06:02, 19.05s/it]
Task 1, Epoch 2/20 => Loss 0.343, Train_accy 59.74:   5%|▌         | 1/20 [00:28<06:02, 19.05s/it]                 
Task 1, Epoch 2/20 => Loss 0.343, Train_accy 59.74:  10%|█         | 2/20 [00:28<04:03, 13.52s/it]
Task 1, Epoch 3/20 => Loss 0.324, Train_accy 68.38:  10%|█         | 2/20 [00:38<04:03, 13.52s/it]
Task 1, Epoch 3/20 => Loss 0.324, Train_accy 68.38:  15%|█▌        | 3/20 [00:38<03:17, 11.63s/it]
Task 1, Epoch 4/20 => Loss 0.236, Train_accy 75.30:  15%|█▌        | 3/20 [00:47<03:17, 11.63s/it]
Task 1, Epoch 4/20 => Loss 0.236, Train_accy 75.30:  20%|██        | 4/20 [00:47<02:51, 10.72s/it]
Task 1, Epoch 5/20 => Loss 0.174, Train_accy 77.26:  20%|██        | 4/20 [00:56<02:51, 10.72s/it]
Task 1, Epoch 5/20 => Loss 0.174, Train_accy 77.26:  25%|██▌       | 5/20 [00:56<02:32, 10.17s/it]
Task 1, Epoch 6/20 => Loss 0.197, Train_accy 78.46, Test_accy 78.53:  25%|██▌       | 5/20 [01:15<02:32, 10.17s/it]
Task 1, Epoch 6/20 => Loss 0.197, Train_accy 78.46, Test_accy 78.53:  30%|███       | 6/20 [01:15<03:04, 13.21s/it]
Task 1, Epoch 7/20 => Loss 0.188, Train_accy 79.83:  30%|███       | 6/20 [01:24<03:04, 13.21s/it]                 
Task 1, Epoch 7/20 => Loss 0.188, Train_accy 79.83:  35%|███▌      | 7/20 [01:24<02:34, 11.92s/it]
Task 1, Epoch 8/20 => Loss 0.156, Train_accy 78.63:  35%|███▌      | 7/20 [01:34<02:34, 11.92s/it]
Task 1, Epoch 8/20 => Loss 0.156, Train_accy 78.63:  40%|████      | 8/20 [01:34<02:13, 11.11s/it]
Task 1, Epoch 9/20 => Loss 0.177, Train_accy 80.09:  40%|████      | 8/20 [01:43<02:13, 11.11s/it]
Task 1, Epoch 9/20 => Loss 0.177, Train_accy 80.09:  45%|████▌     | 9/20 [01:43<01:55, 10.53s/it]
Task 1, Epoch 10/20 => Loss 0.149, Train_accy 81.28:  45%|████▌     | 9/20 [01:52<01:55, 10.53s/it]
Task 1, Epoch 10/20 => Loss 0.149, Train_accy 81.28:  50%|█████     | 10/20 [01:52<01:41, 10.14s/it]
Task 1, Epoch 11/20 => Loss 0.171, Train_accy 81.20, Test_accy 77.30:  50%|█████     | 10/20 [02:11<01:41, 10.14s/it]
Task 1, Epoch 11/20 => Loss 0.171, Train_accy 81.20, Test_accy 77.30:  55%|█████▌    | 11/20 [02:11<01:55, 12.87s/it]
Task 1, Epoch 12/20 => Loss 0.155, Train_accy 82.05:  55%|█████▌    | 11/20 [02:21<01:55, 12.87s/it]                 
Task 1, Epoch 12/20 => Loss 0.155, Train_accy 82.05:  60%|██████    | 12/20 [02:21<01:34, 11.77s/it]
Task 1, Epoch 13/20 => Loss 0.141, Train_accy 82.99:  60%|██████    | 12/20 [02:30<01:34, 11.77s/it]
Task 1, Epoch 13/20 => Loss 0.141, Train_accy 82.99:  65%|██████▌   | 13/20 [02:30<01:17, 11.03s/it]
Task 1, Epoch 14/20 => Loss 0.146, Train_accy 84.02:  65%|██████▌   | 13/20 [02:39<01:17, 11.03s/it]
Task 1, Epoch 14/20 => Loss 0.146, Train_accy 84.02:  70%|███████   | 14/20 [02:39<01:02, 10.49s/it]
Task 1, Epoch 15/20 => Loss 0.123, Train_accy 84.02:  70%|███████   | 14/20 [02:49<01:02, 10.49s/it]
Task 1, Epoch 15/20 => Loss 0.123, Train_accy 84.02:  75%|███████▌  | 15/20 [02:49<00:50, 10.14s/it]
Task 1, Epoch 16/20 => Loss 0.145, Train_accy 83.16, Test_accy 76.69:  75%|███████▌  | 15/20 [03:08<00:50, 10.14s/it]
Task 1, Epoch 16/20 => Loss 0.145, Train_accy 83.16, Test_accy 76.69:  80%|████████  | 16/20 [03:08<00:51, 12.88s/it]
Task 1, Epoch 17/20 => Loss 0.135, Train_accy 84.19:  80%|████████  | 16/20 [03:17<00:51, 12.88s/it]                 
Task 1, Epoch 17/20 => Loss 0.135, Train_accy 84.19:  85%|████████▌ | 17/20 [03:17<00:35, 11.81s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 84.62:  85%|████████▌ | 17/20 [03:26<00:35, 11.81s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 84.62:  90%|█████████ | 18/20 [03:26<00:22, 11.03s/it]
Task 1, Epoch 19/20 => Loss 0.092, Train_accy 84.44:  90%|█████████ | 18/20 [03:36<00:22, 11.03s/it]
Task 1, Epoch 19/20 => Loss 0.092, Train_accy 84.44:  95%|█████████▌| 19/20 [03:36<00:10, 10.50s/it]
Task 1, Epoch 20/20 => Loss 0.104, Train_accy 86.50:  95%|█████████▌| 19/20 [03:45<00:10, 10.50s/it]
Task 1, Epoch 20/20 => Loss 0.104, Train_accy 86.50: 100%|██████████| 20/20 [03:45<00:00, 10.13s/it]
Task 1, Epoch 20/20 => Loss 0.104, Train_accy 86.50: 100%|██████████| 20/20 [03:45<00:00, 11.27s/it]
2024-09-07 14:02:01,510 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.104, Train_accy 86.50
2024-09-07 14:02:11,243 [trainer.py] => No NME accuracy.
2024-09-07 14:02:11,243 [trainer.py] => CNN: {'total': 77.67, '00-99': 76.95, '100-109': 85.21, 'old': 76.95, 'new': 85.21}
2024-09-07 14:02:11,243 [trainer.py] => CNN top1 curve: [81.47, 77.67]
2024-09-07 14:02:11,243 [trainer.py] => CNN top5 curve: [93.74, 91.95]

Average Accuracy (CNN): 79.57
2024-09-07 14:02:11,244 [trainer.py] => Average Accuracy (CNN): 79.57 

2024-09-07 14:02:11,245 [trainer.py] => All params: 85883246
2024-09-07 14:02:11,247 [trainer.py] => Trainable params: 85883246
2024-09-07 14:02:11,251 [finetune.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.889, Train_accy 28.09, Test_accy 75.39:   0%|          | 0/20 [00:22<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.889, Train_accy 28.09, Test_accy 75.39:   5%|▌         | 1/20 [00:22<07:11, 22.70s/it]
Task 2, Epoch 2/20 => Loss 0.359, Train_accy 62.81:   5%|▌         | 1/20 [00:34<07:11, 22.70s/it]                 
Task 2, Epoch 2/20 => Loss 0.359, Train_accy 62.81:  10%|█         | 2/20 [00:34<04:52, 16.25s/it]
Task 2, Epoch 3/20 => Loss 0.267, Train_accy 67.76:  10%|█         | 2/20 [00:46<04:52, 16.25s/it]
Task 2, Epoch 3/20 => Loss 0.267, Train_accy 67.76:  15%|█▌        | 3/20 [00:46<04:01, 14.18s/it]
Task 2, Epoch 4/20 => Loss 0.227, Train_accy 72.58:  15%|█▌        | 3/20 [00:57<04:01, 14.18s/it]
Task 2, Epoch 4/20 => Loss 0.227, Train_accy 72.58:  20%|██        | 4/20 [00:57<03:31, 13.21s/it]
Task 2, Epoch 5/20 => Loss 0.212, Train_accy 74.58:  20%|██        | 4/20 [01:09<03:31, 13.21s/it]
Task 2, Epoch 5/20 => Loss 0.212, Train_accy 74.58:  25%|██▌       | 5/20 [01:09<03:10, 12.70s/it]
Task 2, Epoch 6/20 => Loss 0.197, Train_accy 75.79, Test_accy 76.02:  25%|██▌       | 5/20 [01:32<03:10, 12.70s/it]
Task 2, Epoch 6/20 => Loss 0.197, Train_accy 75.79, Test_accy 76.02:  30%|███       | 6/20 [01:32<03:44, 16.05s/it]
Task 2, Epoch 7/20 => Loss 0.175, Train_accy 78.19:  30%|███       | 6/20 [01:43<03:44, 16.05s/it]                 
Task 2, Epoch 7/20 => Loss 0.175, Train_accy 78.19:  35%|███▌      | 7/20 [01:43<03:10, 14.63s/it]
Task 2, Epoch 8/20 => Loss 0.152, Train_accy 78.53:  35%|███▌      | 7/20 [01:55<03:10, 14.63s/it]
Task 2, Epoch 8/20 => Loss 0.152, Train_accy 78.53:  40%|████      | 8/20 [01:55<02:44, 13.68s/it]
Task 2, Epoch 9/20 => Loss 0.202, Train_accy 78.39:  40%|████      | 8/20 [02:07<02:44, 13.68s/it]
Task 2, Epoch 9/20 => Loss 0.202, Train_accy 78.39:  45%|████▌     | 9/20 [02:07<02:23, 13.08s/it]
Task 2, Epoch 10/20 => Loss 0.167, Train_accy 80.87:  45%|████▌     | 9/20 [02:19<02:23, 13.08s/it]
Task 2, Epoch 10/20 => Loss 0.167, Train_accy 80.87:  50%|█████     | 10/20 [02:19<02:06, 12.67s/it]
Task 2, Epoch 11/20 => Loss 0.149, Train_accy 80.47, Test_accy 75.78:  50%|█████     | 10/20 [02:41<02:06, 12.67s/it]
Task 2, Epoch 11/20 => Loss 0.149, Train_accy 80.47, Test_accy 75.78:  55%|█████▌    | 11/20 [02:41<02:20, 15.66s/it]
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 80.67:  55%|█████▌    | 11/20 [02:53<02:20, 15.66s/it]                 
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 80.67:  60%|██████    | 12/20 [02:53<01:55, 14.46s/it]
Task 2, Epoch 13/20 => Loss 0.186, Train_accy 79.73:  60%|██████    | 12/20 [03:04<01:55, 14.46s/it]
Task 2, Epoch 13/20 => Loss 0.186, Train_accy 79.73:  65%|██████▌   | 13/20 [03:04<01:35, 13.62s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 82.61:  65%|██████▌   | 13/20 [03:16<01:35, 13.62s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 82.61:  70%|███████   | 14/20 [03:16<01:18, 13.05s/it]
Task 2, Epoch 15/20 => Loss 0.136, Train_accy 81.87:  70%|███████   | 14/20 [03:28<01:18, 13.05s/it]
Task 2, Epoch 15/20 => Loss 0.136, Train_accy 81.87:  75%|███████▌  | 15/20 [03:28<01:03, 12.67s/it]
Task 2, Epoch 16/20 => Loss 0.108, Train_accy 83.68, Test_accy 74.76:  75%|███████▌  | 15/20 [03:51<01:03, 12.67s/it]
Task 2, Epoch 16/20 => Loss 0.108, Train_accy 83.68, Test_accy 74.76:  80%|████████  | 16/20 [03:51<01:02, 15.71s/it]
Task 2, Epoch 17/20 => Loss 0.133, Train_accy 84.75:  80%|████████  | 16/20 [04:03<01:02, 15.71s/it]                 
Task 2, Epoch 17/20 => Loss 0.133, Train_accy 84.75:  85%|████████▌ | 17/20 [04:03<00:43, 14.54s/it]
Task 2, Epoch 18/20 => Loss 0.114, Train_accy 83.75:  85%|████████▌ | 17/20 [04:14<00:43, 14.54s/it]
Task 2, Epoch 18/20 => Loss 0.114, Train_accy 83.75:  90%|█████████ | 18/20 [04:14<00:27, 13.70s/it]
Task 2, Epoch 19/20 => Loss 0.137, Train_accy 84.62:  90%|█████████ | 18/20 [04:26<00:27, 13.70s/it]
Task 2, Epoch 19/20 => Loss 0.137, Train_accy 84.62:  95%|█████████▌| 19/20 [04:26<00:13, 13.11s/it]
Task 2, Epoch 20/20 => Loss 0.119, Train_accy 84.62:  95%|█████████▌| 19/20 [04:38<00:13, 13.11s/it]
Task 2, Epoch 20/20 => Loss 0.119, Train_accy 84.62: 100%|██████████| 20/20 [04:38<00:00, 12.70s/it]
Task 2, Epoch 20/20 => Loss 0.119, Train_accy 84.62: 100%|██████████| 20/20 [04:38<00:00, 13.91s/it]
2024-09-07 14:06:49,532 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.119, Train_accy 84.62
2024-09-07 14:07:00,426 [trainer.py] => No NME accuracy.
2024-09-07 14:07:00,427 [trainer.py] => CNN: {'total': 74.73, '00-99': 73.17, '100-109': 73.24, '110-119': 88.3, 'old': 73.17, 'new': 88.3}
2024-09-07 14:07:00,427 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73]
2024-09-07 14:07:00,427 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92]

Average Accuracy (CNN): 77.96
2024-09-07 14:07:00,427 [trainer.py] => Average Accuracy (CNN): 77.96 

2024-09-07 14:07:00,428 [trainer.py] => All params: 85890936
2024-09-07 14:07:00,430 [trainer.py] => Trainable params: 85890936
2024-09-07 14:07:00,433 [finetune.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.554, Train_accy 20.14, Test_accy 70.07:   0%|          | 0/20 [00:19<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.554, Train_accy 20.14, Test_accy 70.07:   5%|▌         | 1/20 [00:19<06:11, 19.56s/it]
Task 3, Epoch 2/20 => Loss 0.411, Train_accy 66.12:   5%|▌         | 1/20 [00:27<06:11, 19.56s/it]                 
Task 3, Epoch 2/20 => Loss 0.411, Train_accy 66.12:  10%|█         | 2/20 [00:27<03:47, 12.62s/it]
Task 3, Epoch 3/20 => Loss 0.377, Train_accy 73.14:  10%|█         | 2/20 [00:35<03:47, 12.62s/it]
Task 3, Epoch 3/20 => Loss 0.377, Train_accy 73.14:  15%|█▌        | 3/20 [00:35<02:58, 10.48s/it]
Task 3, Epoch 4/20 => Loss 0.263, Train_accy 76.03:  15%|█▌        | 3/20 [00:42<02:58, 10.48s/it]
Task 3, Epoch 4/20 => Loss 0.263, Train_accy 76.03:  20%|██        | 4/20 [00:42<02:30,  9.39s/it]
Task 3, Epoch 5/20 => Loss 0.247, Train_accy 78.41:  20%|██        | 4/20 [00:50<02:30,  9.39s/it]
Task 3, Epoch 5/20 => Loss 0.247, Train_accy 78.41:  25%|██▌       | 5/20 [00:50<02:11,  8.80s/it]
Task 3, Epoch 6/20 => Loss 0.217, Train_accy 78.20, Test_accy 71.12:  25%|██▌       | 5/20 [01:10<02:11,  8.80s/it]
Task 3, Epoch 6/20 => Loss 0.217, Train_accy 78.20, Test_accy 71.12:  30%|███       | 6/20 [01:10<02:53, 12.41s/it]
Task 3, Epoch 7/20 => Loss 0.154, Train_accy 85.85:  30%|███       | 6/20 [01:18<02:53, 12.41s/it]                 
Task 3, Epoch 7/20 => Loss 0.154, Train_accy 85.85:  35%|███▌      | 7/20 [01:18<02:22, 10.98s/it]
Task 3, Epoch 8/20 => Loss 0.176, Train_accy 83.68:  35%|███▌      | 7/20 [01:26<02:22, 10.98s/it]
Task 3, Epoch 8/20 => Loss 0.176, Train_accy 83.68:  40%|████      | 8/20 [01:26<01:59,  9.99s/it]
Task 3, Epoch 9/20 => Loss 0.139, Train_accy 86.26:  40%|████      | 8/20 [01:34<01:59,  9.99s/it]
Task 3, Epoch 9/20 => Loss 0.139, Train_accy 86.26:  45%|████▌     | 9/20 [01:34<01:42,  9.36s/it]
Task 3, Epoch 10/20 => Loss 0.132, Train_accy 86.16:  45%|████▌     | 9/20 [01:41<01:42,  9.36s/it]
Task 3, Epoch 10/20 => Loss 0.132, Train_accy 86.16:  50%|█████     | 10/20 [01:41<01:28,  8.86s/it]
Task 3, Epoch 11/20 => Loss 0.136, Train_accy 84.71, Test_accy 71.55:  50%|█████     | 10/20 [02:01<01:28,  8.86s/it]
Task 3, Epoch 11/20 => Loss 0.136, Train_accy 84.71, Test_accy 71.55:  55%|█████▌    | 11/20 [02:01<01:49, 12.12s/it]
Task 3, Epoch 12/20 => Loss 0.131, Train_accy 87.40:  55%|█████▌    | 11/20 [02:09<01:49, 12.12s/it]                 
Task 3, Epoch 12/20 => Loss 0.131, Train_accy 87.40:  60%|██████    | 12/20 [02:09<01:26, 10.83s/it]
Task 3, Epoch 13/20 => Loss 0.113, Train_accy 87.19:  60%|██████    | 12/20 [02:16<01:26, 10.83s/it]
Task 3, Epoch 13/20 => Loss 0.113, Train_accy 87.19:  65%|██████▌   | 13/20 [02:16<01:09,  9.90s/it]
Task 3, Epoch 14/20 => Loss 0.140, Train_accy 84.92:  65%|██████▌   | 13/20 [02:24<01:09,  9.90s/it]
Task 3, Epoch 14/20 => Loss 0.140, Train_accy 84.92:  70%|███████   | 14/20 [02:24<00:55,  9.26s/it]
Task 3, Epoch 15/20 => Loss 0.135, Train_accy 87.60:  70%|███████   | 14/20 [02:32<00:55,  9.26s/it]
Task 3, Epoch 15/20 => Loss 0.135, Train_accy 87.60:  75%|███████▌  | 15/20 [02:32<00:44,  8.81s/it]
Task 3, Epoch 16/20 => Loss 0.167, Train_accy 88.74, Test_accy 70.40:  75%|███████▌  | 15/20 [02:51<00:44,  8.81s/it]
Task 3, Epoch 16/20 => Loss 0.167, Train_accy 88.74, Test_accy 70.40:  80%|████████  | 16/20 [02:51<00:48, 12.00s/it]
Task 3, Epoch 17/20 => Loss 0.210, Train_accy 84.40:  80%|████████  | 16/20 [02:59<00:48, 12.00s/it]                 
Task 3, Epoch 17/20 => Loss 0.210, Train_accy 84.40:  85%|████████▌ | 17/20 [02:59<00:32, 10.72s/it]
Task 3, Epoch 18/20 => Loss 0.108, Train_accy 87.29:  85%|████████▌ | 17/20 [03:07<00:32, 10.72s/it]
Task 3, Epoch 18/20 => Loss 0.108, Train_accy 87.29:  90%|█████████ | 18/20 [03:07<00:19,  9.83s/it]
Task 3, Epoch 19/20 => Loss 0.136, Train_accy 88.43:  90%|█████████ | 18/20 [03:15<00:19,  9.83s/it]
Task 3, Epoch 19/20 => Loss 0.136, Train_accy 88.43:  95%|█████████▌| 19/20 [03:15<00:09,  9.20s/it]
Task 3, Epoch 20/20 => Loss 0.162, Train_accy 88.02:  95%|█████████▌| 19/20 [03:22<00:09,  9.20s/it]
Task 3, Epoch 20/20 => Loss 0.162, Train_accy 88.02: 100%|██████████| 20/20 [03:22<00:00,  8.77s/it]
Task 3, Epoch 20/20 => Loss 0.162, Train_accy 88.02: 100%|██████████| 20/20 [03:22<00:00, 10.14s/it]
2024-09-07 14:10:23,301 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.162, Train_accy 88.02
2024-09-07 14:10:35,128 [trainer.py] => No NME accuracy.
2024-09-07 14:10:35,129 [trainer.py] => CNN: {'total': 69.82, '00-99': 68.01, '100-109': 70.07, '110-119': 75.53, '120-129': 81.55, 'old': 68.94, 'new': 81.55}
2024-09-07 14:10:35,129 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82]
2024-09-07 14:10:35,129 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77]

Average Accuracy (CNN): 75.92
2024-09-07 14:10:35,129 [trainer.py] => Average Accuracy (CNN): 75.92 

2024-09-07 14:10:35,131 [trainer.py] => All params: 85898626
2024-09-07 14:10:35,132 [trainer.py] => Trainable params: 85898626
2024-09-07 14:10:35,135 [finetune.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.136, Train_accy 10.29, Test_accy 65.12:   0%|          | 0/20 [00:21<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.136, Train_accy 10.29, Test_accy 65.12:   5%|▌         | 1/20 [00:21<06:53, 21.77s/it]
Task 4, Epoch 2/20 => Loss 0.405, Train_accy 49.31:   5%|▌         | 1/20 [00:30<06:53, 21.77s/it]                 
Task 4, Epoch 2/20 => Loss 0.405, Train_accy 49.31:  10%|█         | 2/20 [00:31<04:19, 14.39s/it]
Task 4, Epoch 3/20 => Loss 0.274, Train_accy 62.63:  10%|█         | 2/20 [00:40<04:19, 14.39s/it]
Task 4, Epoch 3/20 => Loss 0.274, Train_accy 62.63:  15%|█▌        | 3/20 [00:40<03:24, 12.03s/it]
Task 4, Epoch 4/20 => Loss 0.240, Train_accy 69.38:  15%|█▌        | 3/20 [00:49<03:24, 12.03s/it]
Task 4, Epoch 4/20 => Loss 0.240, Train_accy 69.38:  20%|██        | 4/20 [00:49<02:54, 10.89s/it]
Task 4, Epoch 5/20 => Loss 0.202, Train_accy 70.07:  20%|██        | 4/20 [00:58<02:54, 10.89s/it]
Task 4, Epoch 5/20 => Loss 0.202, Train_accy 70.07:  25%|██▌       | 5/20 [00:58<02:34, 10.28s/it]
Task 4, Epoch 6/20 => Loss 0.202, Train_accy 71.28, Test_accy 69.89:  25%|██▌       | 5/20 [01:20<02:34, 10.28s/it]
Task 4, Epoch 6/20 => Loss 0.202, Train_accy 71.28, Test_accy 69.89:  30%|███       | 6/20 [01:20<03:18, 14.19s/it]
Task 4, Epoch 7/20 => Loss 0.186, Train_accy 72.49:  30%|███       | 6/20 [01:29<03:18, 14.19s/it]                 
Task 4, Epoch 7/20 => Loss 0.186, Train_accy 72.49:  35%|███▌      | 7/20 [01:29<02:43, 12.59s/it]
Task 4, Epoch 8/20 => Loss 0.209, Train_accy 74.65:  35%|███▌      | 7/20 [01:38<02:43, 12.59s/it]
Task 4, Epoch 8/20 => Loss 0.209, Train_accy 74.65:  40%|████      | 8/20 [01:38<02:18, 11.51s/it]
Task 4, Epoch 9/20 => Loss 0.136, Train_accy 76.04:  40%|████      | 8/20 [01:48<02:18, 11.51s/it]
Task 4, Epoch 9/20 => Loss 0.136, Train_accy 76.04:  45%|████▌     | 9/20 [01:48<01:58, 10.80s/it]
Task 4, Epoch 10/20 => Loss 0.144, Train_accy 78.29:  45%|████▌     | 9/20 [01:57<01:58, 10.80s/it]
Task 4, Epoch 10/20 => Loss 0.144, Train_accy 78.29:  50%|█████     | 10/20 [01:57<01:43, 10.33s/it]
Task 4, Epoch 11/20 => Loss 0.127, Train_accy 79.84, Test_accy 70.31:  50%|█████     | 10/20 [02:18<01:43, 10.33s/it]
Task 4, Epoch 11/20 => Loss 0.127, Train_accy 79.84, Test_accy 70.31:  55%|█████▌    | 11/20 [02:18<02:04, 13.79s/it]
Task 4, Epoch 12/20 => Loss 0.140, Train_accy 80.97:  55%|█████▌    | 11/20 [02:28<02:04, 13.79s/it]                 
Task 4, Epoch 12/20 => Loss 0.140, Train_accy 80.97:  60%|██████    | 12/20 [02:28<01:39, 12.40s/it]
Task 4, Epoch 13/20 => Loss 0.143, Train_accy 79.58:  60%|██████    | 12/20 [02:37<01:39, 12.40s/it]
Task 4, Epoch 13/20 => Loss 0.143, Train_accy 79.58:  65%|██████▌   | 13/20 [02:37<01:19, 11.42s/it]
Task 4, Epoch 14/20 => Loss 0.129, Train_accy 80.97:  65%|██████▌   | 13/20 [02:46<01:19, 11.42s/it]
Task 4, Epoch 14/20 => Loss 0.129, Train_accy 80.97:  70%|███████   | 14/20 [02:46<01:04, 10.75s/it]
Task 4, Epoch 15/20 => Loss 0.088, Train_accy 82.87:  70%|███████   | 14/20 [02:55<01:04, 10.75s/it]
Task 4, Epoch 15/20 => Loss 0.088, Train_accy 82.87:  75%|███████▌  | 15/20 [02:55<00:51, 10.28s/it]
Task 4, Epoch 16/20 => Loss 0.098, Train_accy 84.69, Test_accy 69.39:  75%|███████▌  | 15/20 [03:17<00:51, 10.28s/it]
Task 4, Epoch 16/20 => Loss 0.098, Train_accy 84.69, Test_accy 69.39:  80%|████████  | 16/20 [03:17<00:54, 13.69s/it]
Task 4, Epoch 17/20 => Loss 0.120, Train_accy 82.87:  80%|████████  | 16/20 [03:26<00:54, 13.69s/it]                 
Task 4, Epoch 17/20 => Loss 0.120, Train_accy 82.87:  85%|████████▌ | 17/20 [03:26<00:37, 12.35s/it]
Task 4, Epoch 18/20 => Loss 0.098, Train_accy 84.69:  85%|████████▌ | 17/20 [03:35<00:37, 12.35s/it]
Task 4, Epoch 18/20 => Loss 0.098, Train_accy 84.69:  90%|█████████ | 18/20 [03:35<00:22, 11.39s/it]
Task 4, Epoch 19/20 => Loss 0.108, Train_accy 83.82:  90%|█████████ | 18/20 [03:44<00:22, 11.39s/it]
Task 4, Epoch 19/20 => Loss 0.108, Train_accy 83.82:  95%|█████████▌| 19/20 [03:44<00:10, 10.73s/it]
Task 4, Epoch 20/20 => Loss 0.104, Train_accy 81.92:  95%|█████████▌| 19/20 [03:54<00:10, 10.73s/it]
Task 4, Epoch 20/20 => Loss 0.104, Train_accy 81.92: 100%|██████████| 20/20 [03:54<00:00, 10.26s/it]
Task 4, Epoch 20/20 => Loss 0.104, Train_accy 81.92: 100%|██████████| 20/20 [03:54<00:00, 11.71s/it]
2024-09-07 14:14:29,257 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.104, Train_accy 81.92
2024-09-07 14:14:41,676 [trainer.py] => No NME accuracy.
2024-09-07 14:14:41,676 [trainer.py] => CNN: {'total': 68.89, '00-99': 66.5, '100-109': 64.44, '110-119': 76.33, '120-129': 78.6, '130-139': 78.86, 'old': 68.13, 'new': 78.86}
2024-09-07 14:14:41,676 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82, 68.89]
2024-09-07 14:14:41,677 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77, 87.42]

Average Accuracy (CNN): 74.52
2024-09-07 14:14:41,677 [trainer.py] => Average Accuracy (CNN): 74.52 

2024-09-07 14:14:41,678 [trainer.py] => All params: 85906316
2024-09-07 14:14:41,679 [trainer.py] => Trainable params: 85906316
2024-09-07 14:14:41,682 [finetune.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.973, Train_accy 29.05, Test_accy 65.40:   0%|          | 0/20 [00:24<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.973, Train_accy 29.05, Test_accy 65.40:   5%|▌         | 1/20 [00:24<07:53, 24.90s/it]
Task 5, Epoch 2/20 => Loss 0.287, Train_accy 71.73:   5%|▌         | 1/20 [00:36<07:53, 24.90s/it]                 
Task 5, Epoch 2/20 => Loss 0.287, Train_accy 71.73:  10%|█         | 2/20 [00:36<05:03, 16.87s/it]
Task 5, Epoch 3/20 => Loss 0.240, Train_accy 75.34:  10%|█         | 2/20 [00:47<05:03, 16.87s/it]
Task 5, Epoch 3/20 => Loss 0.240, Train_accy 75.34:  15%|█▌        | 3/20 [00:47<04:02, 14.25s/it]
Task 5, Epoch 4/20 => Loss 0.225, Train_accy 77.81:  15%|█▌        | 3/20 [00:58<04:02, 14.25s/it]
Task 5, Epoch 4/20 => Loss 0.225, Train_accy 77.81:  20%|██        | 4/20 [00:58<03:28, 13.03s/it]
Task 5, Epoch 5/20 => Loss 0.194, Train_accy 79.65:  20%|██        | 4/20 [01:09<03:28, 13.03s/it]
Task 5, Epoch 5/20 => Loss 0.194, Train_accy 79.65:  25%|██▌       | 5/20 [01:09<03:05, 12.36s/it]
Task 5, Epoch 6/20 => Loss 0.172, Train_accy 83.46, Test_accy 66.01:  25%|██▌       | 5/20 [01:34<03:05, 12.36s/it]
Task 5, Epoch 6/20 => Loss 0.172, Train_accy 83.46, Test_accy 66.01:  30%|███       | 6/20 [01:34<03:51, 16.53s/it]
Task 5, Epoch 7/20 => Loss 0.177, Train_accy 82.76:  30%|███       | 6/20 [01:45<03:51, 16.53s/it]                 
Task 5, Epoch 7/20 => Loss 0.177, Train_accy 82.76:  35%|███▌      | 7/20 [01:45<03:11, 14.77s/it]
Task 5, Epoch 8/20 => Loss 0.176, Train_accy 84.10:  35%|███▌      | 7/20 [01:56<03:11, 14.77s/it]
Task 5, Epoch 8/20 => Loss 0.176, Train_accy 84.10:  40%|████      | 8/20 [01:56<02:43, 13.61s/it]
Task 5, Epoch 9/20 => Loss 0.145, Train_accy 84.81:  40%|████      | 8/20 [02:07<02:43, 13.61s/it]
Task 5, Epoch 9/20 => Loss 0.145, Train_accy 84.81:  45%|████▌     | 9/20 [02:07<02:21, 12.85s/it]
Task 5, Epoch 10/20 => Loss 0.149, Train_accy 84.88:  45%|████▌     | 9/20 [02:18<02:21, 12.85s/it]
Task 5, Epoch 10/20 => Loss 0.149, Train_accy 84.88:  50%|█████     | 10/20 [02:18<02:03, 12.34s/it]
Task 5, Epoch 11/20 => Loss 0.145, Train_accy 85.80, Test_accy 65.42:  50%|█████     | 10/20 [02:43<02:03, 12.34s/it]
Task 5, Epoch 11/20 => Loss 0.145, Train_accy 85.80, Test_accy 65.42:  55%|█████▌    | 11/20 [02:43<02:25, 16.12s/it]
Task 5, Epoch 12/20 => Loss 0.131, Train_accy 85.80:  55%|█████▌    | 11/20 [02:54<02:25, 16.12s/it]                 
Task 5, Epoch 12/20 => Loss 0.131, Train_accy 85.80:  60%|██████    | 12/20 [02:54<01:56, 14.62s/it]
Task 5, Epoch 13/20 => Loss 0.136, Train_accy 86.22:  60%|██████    | 12/20 [03:05<01:56, 14.62s/it]
Task 5, Epoch 13/20 => Loss 0.136, Train_accy 86.22:  65%|██████▌   | 13/20 [03:05<01:34, 13.55s/it]
Task 5, Epoch 14/20 => Loss 0.104, Train_accy 88.41:  65%|██████▌   | 13/20 [03:17<01:34, 13.55s/it]
Task 5, Epoch 14/20 => Loss 0.104, Train_accy 88.41:  70%|███████   | 14/20 [03:17<01:16, 12.83s/it]
Task 5, Epoch 15/20 => Loss 0.144, Train_accy 85.72:  70%|███████   | 14/20 [03:28<01:16, 12.83s/it]
Task 5, Epoch 15/20 => Loss 0.144, Train_accy 85.72:  75%|███████▌  | 15/20 [03:28<01:01, 12.34s/it]
Task 5, Epoch 16/20 => Loss 0.118, Train_accy 86.15, Test_accy 66.21:  75%|███████▌  | 15/20 [03:53<01:01, 12.34s/it]
Task 5, Epoch 16/20 => Loss 0.118, Train_accy 86.15, Test_accy 66.21:  80%|████████  | 16/20 [03:53<01:04, 16.09s/it]
Task 5, Epoch 17/20 => Loss 0.110, Train_accy 86.43:  80%|████████  | 16/20 [04:04<01:04, 16.09s/it]                 
Task 5, Epoch 17/20 => Loss 0.110, Train_accy 86.43:  85%|████████▌ | 17/20 [04:04<00:43, 14.61s/it]
Task 5, Epoch 18/20 => Loss 0.096, Train_accy 87.84:  85%|████████▌ | 17/20 [04:15<00:43, 14.61s/it]
Task 5, Epoch 18/20 => Loss 0.096, Train_accy 87.84:  90%|█████████ | 18/20 [04:15<00:27, 13.57s/it]
Task 5, Epoch 19/20 => Loss 0.115, Train_accy 86.15:  90%|█████████ | 18/20 [04:26<00:27, 13.57s/it]
Task 5, Epoch 19/20 => Loss 0.115, Train_accy 86.15:  95%|█████████▌| 19/20 [04:26<00:12, 12.83s/it]
Task 5, Epoch 20/20 => Loss 0.115, Train_accy 87.56:  95%|█████████▌| 19/20 [04:37<00:12, 12.83s/it]
Task 5, Epoch 20/20 => Loss 0.115, Train_accy 87.56: 100%|██████████| 20/20 [04:37<00:00, 12.34s/it]
Task 5, Epoch 20/20 => Loss 0.115, Train_accy 87.56: 100%|██████████| 20/20 [04:37<00:00, 13.88s/it]
2024-09-07 14:19:19,360 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.115, Train_accy 87.56
2024-09-07 14:19:32,979 [trainer.py] => No NME accuracy.
2024-09-07 14:19:32,980 [trainer.py] => CNN: {'total': 65.84, '00-99': 62.98, '100-109': 63.03, '110-119': 65.96, '120-129': 71.22, '130-139': 64.09, '140-149': 88.56, 'old': 63.86, 'new': 88.56}
2024-09-07 14:19:32,980 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82, 68.89, 65.84]
2024-09-07 14:19:32,981 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77, 87.42, 86.77]

Average Accuracy (CNN): 73.07
2024-09-07 14:19:32,981 [trainer.py] => Average Accuracy (CNN): 73.07 

2024-09-07 14:19:32,982 [trainer.py] => All params: 85914006
2024-09-07 14:19:32,983 [trainer.py] => Trainable params: 85914006
2024-09-07 14:19:32,987 [finetune.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.202, Train_accy 18.92, Test_accy 61.08:   0%|          | 0/20 [00:25<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.202, Train_accy 18.92, Test_accy 61.08:   5%|▌         | 1/20 [00:25<08:05, 25.53s/it]
Task 6, Epoch 2/20 => Loss 0.486, Train_accy 55.17:   5%|▌         | 1/20 [00:36<08:05, 25.53s/it]                 
Task 6, Epoch 2/20 => Loss 0.486, Train_accy 55.17:  10%|█         | 2/20 [00:36<05:06, 17.01s/it]
Task 6, Epoch 3/20 => Loss 0.398, Train_accy 61.67:  10%|█         | 2/20 [00:47<05:06, 17.01s/it]
Task 6, Epoch 3/20 => Loss 0.398, Train_accy 61.67:  15%|█▌        | 3/20 [00:47<04:02, 14.27s/it]
Task 6, Epoch 4/20 => Loss 0.290, Train_accy 67.59:  15%|█▌        | 3/20 [00:58<04:02, 14.27s/it]
Task 6, Epoch 4/20 => Loss 0.290, Train_accy 67.59:  20%|██        | 4/20 [00:58<03:28, 13.04s/it]
Task 6, Epoch 5/20 => Loss 0.220, Train_accy 73.30:  20%|██        | 4/20 [01:09<03:28, 13.04s/it]
Task 6, Epoch 5/20 => Loss 0.220, Train_accy 73.30:  25%|██▌       | 5/20 [01:09<03:05, 12.38s/it]
Task 6, Epoch 6/20 => Loss 0.186, Train_accy 76.66, Test_accy 63.75:  25%|██▌       | 5/20 [01:35<03:05, 12.38s/it]
Task 6, Epoch 6/20 => Loss 0.186, Train_accy 76.66, Test_accy 63.75:  30%|███       | 6/20 [01:35<03:55, 16.83s/it]
Task 6, Epoch 7/20 => Loss 0.195, Train_accy 76.66:  30%|███       | 6/20 [01:46<03:55, 16.83s/it]                 
Task 6, Epoch 7/20 => Loss 0.195, Train_accy 76.66:  35%|███▌      | 7/20 [01:46<03:14, 14.93s/it]
Task 6, Epoch 8/20 => Loss 0.201, Train_accy 76.73:  35%|███▌      | 7/20 [01:57<03:14, 14.93s/it]
Task 6, Epoch 8/20 => Loss 0.201, Train_accy 76.73:  40%|████      | 8/20 [01:57<02:44, 13.75s/it]
Task 6, Epoch 9/20 => Loss 0.208, Train_accy 74.45:  40%|████      | 8/20 [02:08<02:44, 13.75s/it]
Task 6, Epoch 9/20 => Loss 0.208, Train_accy 74.45:  45%|████▌     | 9/20 [02:08<02:21, 12.89s/it]
Task 6, Epoch 10/20 => Loss 0.188, Train_accy 77.23:  45%|████▌     | 9/20 [02:19<02:21, 12.89s/it]
Task 6, Epoch 10/20 => Loss 0.188, Train_accy 77.23:  50%|█████     | 10/20 [02:19<02:04, 12.40s/it]
Task 6, Epoch 11/20 => Loss 0.180, Train_accy 79.30, Test_accy 64.21:  50%|█████     | 10/20 [02:45<02:04, 12.40s/it]
Task 6, Epoch 11/20 => Loss 0.180, Train_accy 79.30, Test_accy 64.21:  55%|█████▌    | 11/20 [02:45<02:28, 16.48s/it]
Task 6, Epoch 12/20 => Loss 0.158, Train_accy 80.59:  55%|█████▌    | 11/20 [02:56<02:28, 16.48s/it]                 
Task 6, Epoch 12/20 => Loss 0.158, Train_accy 80.59:  60%|██████    | 12/20 [02:56<01:58, 14.82s/it]
Task 6, Epoch 13/20 => Loss 0.161, Train_accy 80.87:  60%|██████    | 12/20 [03:07<01:58, 14.82s/it]
Task 6, Epoch 13/20 => Loss 0.161, Train_accy 80.87:  65%|██████▌   | 13/20 [03:07<01:35, 13.67s/it]
Task 6, Epoch 14/20 => Loss 0.129, Train_accy 83.58:  65%|██████▌   | 13/20 [03:18<01:35, 13.67s/it]
Task 6, Epoch 14/20 => Loss 0.129, Train_accy 83.58:  70%|███████   | 14/20 [03:18<01:17, 12.86s/it]
Task 6, Epoch 15/20 => Loss 0.164, Train_accy 82.23:  70%|███████   | 14/20 [03:29<01:17, 12.86s/it]
Task 6, Epoch 15/20 => Loss 0.164, Train_accy 82.23:  75%|███████▌  | 15/20 [03:29<01:01, 12.30s/it]
Task 6, Epoch 16/20 => Loss 0.131, Train_accy 84.08, Test_accy 63.95:  75%|███████▌  | 15/20 [03:55<01:01, 12.30s/it]
Task 6, Epoch 16/20 => Loss 0.131, Train_accy 84.08, Test_accy 63.95:  80%|████████  | 16/20 [03:55<01:05, 16.33s/it]
Task 6, Epoch 17/20 => Loss 0.147, Train_accy 82.08:  80%|████████  | 16/20 [04:06<01:05, 16.33s/it]                 
Task 6, Epoch 17/20 => Loss 0.147, Train_accy 82.08:  85%|████████▌ | 17/20 [04:06<00:44, 14.74s/it]
Task 6, Epoch 18/20 => Loss 0.156, Train_accy 82.73:  85%|████████▌ | 17/20 [04:17<00:44, 14.74s/it]
Task 6, Epoch 18/20 => Loss 0.156, Train_accy 82.73:  90%|█████████ | 18/20 [04:17<00:27, 13.65s/it]
Task 6, Epoch 19/20 => Loss 0.127, Train_accy 84.15:  90%|█████████ | 18/20 [04:28<00:27, 13.65s/it]
Task 6, Epoch 19/20 => Loss 0.127, Train_accy 84.15:  95%|█████████▌| 19/20 [04:28<00:12, 12.87s/it]
Task 6, Epoch 20/20 => Loss 0.099, Train_accy 85.87:  95%|█████████▌| 19/20 [04:39<00:12, 12.87s/it]
Task 6, Epoch 20/20 => Loss 0.099, Train_accy 85.87: 100%|██████████| 20/20 [04:39<00:00, 12.32s/it]
Task 6, Epoch 20/20 => Loss 0.099, Train_accy 85.87: 100%|██████████| 20/20 [04:39<00:00, 13.98s/it]
2024-09-07 14:24:12,650 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.099, Train_accy 85.87
2024-09-07 14:24:27,235 [trainer.py] => No NME accuracy.
2024-09-07 14:24:27,235 [trainer.py] => CNN: {'total': 64.48, '00-99': 61.04, '100-109': 53.17, '110-119': 59.57, '120-129': 70.85, '130-139': 65.1, '140-149': 84.74, '150-159': 80.94, 'old': 63.17, 'new': 80.94}
2024-09-07 14:24:27,235 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82, 68.89, 65.84, 64.48]
2024-09-07 14:24:27,235 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77, 87.42, 86.77, 84.24]

Average Accuracy (CNN): 71.84
2024-09-07 14:24:27,235 [trainer.py] => Average Accuracy (CNN): 71.84 

2024-09-07 14:24:27,236 [trainer.py] => All params: 85921696
2024-09-07 14:24:27,237 [trainer.py] => Trainable params: 85921696
2024-09-07 14:24:27,239 [finetune.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.616, Train_accy 4.12, Test_accy 59.25:   0%|          | 0/20 [00:23<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.616, Train_accy 4.12, Test_accy 59.25:   5%|▌         | 1/20 [00:23<07:18, 23.09s/it]
Task 7, Epoch 2/20 => Loss 0.715, Train_accy 36.42:   5%|▌         | 1/20 [00:30<07:18, 23.09s/it]                
Task 7, Epoch 2/20 => Loss 0.715, Train_accy 36.42:  10%|█         | 2/20 [00:30<04:14, 14.14s/it]
Task 7, Epoch 3/20 => Loss 0.407, Train_accy 56.54:  10%|█         | 2/20 [00:38<04:14, 14.14s/it]
Task 7, Epoch 3/20 => Loss 0.407, Train_accy 56.54:  15%|█▌        | 3/20 [00:38<03:11, 11.28s/it]
Task 7, Epoch 4/20 => Loss 0.350, Train_accy 62.47:  15%|█▌        | 3/20 [00:46<03:11, 11.28s/it]
Task 7, Epoch 4/20 => Loss 0.350, Train_accy 62.47:  20%|██        | 4/20 [00:46<02:39,  9.94s/it]
Task 7, Epoch 5/20 => Loss 0.268, Train_accy 66.40:  20%|██        | 4/20 [00:54<02:39,  9.94s/it]
Task 7, Epoch 5/20 => Loss 0.268, Train_accy 66.40:  25%|██▌       | 5/20 [00:54<02:18,  9.22s/it]
Task 7, Epoch 6/20 => Loss 0.337, Train_accy 66.10, Test_accy 63.00:  25%|██▌       | 5/20 [01:17<02:18,  9.22s/it]
Task 7, Epoch 6/20 => Loss 0.337, Train_accy 66.10, Test_accy 63.00:  30%|███       | 6/20 [01:17<03:14, 13.91s/it]
Task 7, Epoch 7/20 => Loss 0.230, Train_accy 73.74:  30%|███       | 6/20 [01:25<03:14, 13.91s/it]                 
Task 7, Epoch 7/20 => Loss 0.230, Train_accy 73.74:  35%|███▌      | 7/20 [01:25<02:35, 11.94s/it]
Task 7, Epoch 8/20 => Loss 0.224, Train_accy 73.14:  35%|███▌      | 7/20 [01:33<02:35, 11.94s/it]
Task 7, Epoch 8/20 => Loss 0.224, Train_accy 73.14:  40%|████      | 8/20 [01:33<02:07, 10.66s/it]
Task 7, Epoch 9/20 => Loss 0.253, Train_accy 75.25:  40%|████      | 8/20 [01:41<02:07, 10.66s/it]
Task 7, Epoch 9/20 => Loss 0.253, Train_accy 75.25:  45%|████▌     | 9/20 [01:41<01:47,  9.81s/it]
Task 7, Epoch 10/20 => Loss 0.212, Train_accy 73.84:  45%|████▌     | 9/20 [01:49<01:47,  9.81s/it]
Task 7, Epoch 10/20 => Loss 0.212, Train_accy 73.84:  50%|█████     | 10/20 [01:49<01:32,  9.22s/it]
Task 7, Epoch 11/20 => Loss 0.187, Train_accy 76.36, Test_accy 62.59:  50%|█████     | 10/20 [02:12<01:32,  9.22s/it]
Task 7, Epoch 11/20 => Loss 0.187, Train_accy 76.36, Test_accy 62.59:  55%|█████▌    | 11/20 [02:12<02:01, 13.48s/it]
Task 7, Epoch 12/20 => Loss 0.189, Train_accy 74.85:  55%|█████▌    | 11/20 [02:20<02:01, 13.48s/it]                 
Task 7, Epoch 12/20 => Loss 0.189, Train_accy 74.85:  60%|██████    | 12/20 [02:20<01:34, 11.79s/it]
Task 7, Epoch 13/20 => Loss 0.190, Train_accy 75.75:  60%|██████    | 12/20 [02:28<01:34, 11.79s/it]
Task 7, Epoch 13/20 => Loss 0.190, Train_accy 75.75:  65%|██████▌   | 13/20 [02:28<01:14, 10.62s/it]
Task 7, Epoch 14/20 => Loss 0.187, Train_accy 76.26:  65%|██████▌   | 13/20 [02:36<01:14, 10.62s/it]
Task 7, Epoch 14/20 => Loss 0.187, Train_accy 76.26:  70%|███████   | 14/20 [02:36<00:58,  9.81s/it]
Task 7, Epoch 15/20 => Loss 0.162, Train_accy 80.99:  70%|███████   | 14/20 [02:44<00:58,  9.81s/it]
Task 7, Epoch 15/20 => Loss 0.162, Train_accy 80.99:  75%|███████▌  | 15/20 [02:44<00:46,  9.24s/it]
Task 7, Epoch 16/20 => Loss 0.174, Train_accy 76.16, Test_accy 64.08:  75%|███████▌  | 15/20 [03:07<00:46,  9.24s/it]
Task 7, Epoch 16/20 => Loss 0.174, Train_accy 76.16, Test_accy 64.08:  80%|████████  | 16/20 [03:07<00:53, 13.39s/it]
Task 7, Epoch 17/20 => Loss 0.184, Train_accy 77.77:  80%|████████  | 16/20 [03:15<00:53, 13.39s/it]                 
Task 7, Epoch 17/20 => Loss 0.184, Train_accy 77.77:  85%|████████▌ | 17/20 [03:15<00:35, 11.73s/it]
Task 7, Epoch 18/20 => Loss 0.148, Train_accy 82.09:  85%|████████▌ | 17/20 [03:22<00:35, 11.73s/it]
Task 7, Epoch 18/20 => Loss 0.148, Train_accy 82.09:  90%|█████████ | 18/20 [03:22<00:21, 10.57s/it]
Task 7, Epoch 19/20 => Loss 0.203, Train_accy 79.58:  90%|█████████ | 18/20 [03:30<00:21, 10.57s/it]
Task 7, Epoch 19/20 => Loss 0.203, Train_accy 79.58:  95%|█████████▌| 19/20 [03:30<00:09,  9.76s/it]
Task 7, Epoch 20/20 => Loss 0.176, Train_accy 79.38:  95%|█████████▌| 19/20 [03:38<00:09,  9.76s/it]
Task 7, Epoch 20/20 => Loss 0.176, Train_accy 79.38: 100%|██████████| 20/20 [03:38<00:00,  9.20s/it]
Task 7, Epoch 20/20 => Loss 0.176, Train_accy 79.38: 100%|██████████| 20/20 [03:38<00:00, 10.94s/it]
2024-09-07 14:28:05,987 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.176, Train_accy 79.38
2024-09-07 14:28:21,150 [trainer.py] => No NME accuracy.
2024-09-07 14:28:21,151 [trainer.py] => CNN: {'total': 62.61, '00-99': 59.56, '100-109': 52.82, '110-119': 59.57, '120-129': 65.31, '130-139': 57.72, '140-149': 82.29, '150-159': 75.97, '160-169': 70.0, 'old': 62.27, 'new': 70.0}
2024-09-07 14:28:21,151 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82, 68.89, 65.84, 64.48, 62.61]
2024-09-07 14:28:21,151 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77, 87.42, 86.77, 84.24, 82.52]

Average Accuracy (CNN): 70.69
2024-09-07 14:28:21,151 [trainer.py] => Average Accuracy (CNN): 70.69 

2024-09-07 14:28:21,152 [trainer.py] => All params: 85929386
2024-09-07 14:28:21,153 [trainer.py] => Trainable params: 85929386
2024-09-07 14:28:21,156 [finetune.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.537, Train_accy 9.12, Test_accy 58.92:   0%|          | 0/20 [00:23<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.537, Train_accy 9.12, Test_accy 58.92:   5%|▌         | 1/20 [00:23<07:31, 23.75s/it]
Task 8, Epoch 2/20 => Loss 0.488, Train_accy 56.29:   5%|▌         | 1/20 [00:31<07:31, 23.75s/it]                
Task 8, Epoch 2/20 => Loss 0.488, Train_accy 56.29:  10%|█         | 2/20 [00:31<04:16, 14.27s/it]
Task 8, Epoch 3/20 => Loss 0.322, Train_accy 69.81:  10%|█         | 2/20 [00:39<04:16, 14.27s/it]
Task 8, Epoch 3/20 => Loss 0.322, Train_accy 69.81:  15%|█▌        | 3/20 [00:39<03:11, 11.24s/it]
Task 8, Epoch 4/20 => Loss 0.288, Train_accy 74.63:  15%|█▌        | 3/20 [00:46<03:11, 11.24s/it]
Task 8, Epoch 4/20 => Loss 0.288, Train_accy 74.63:  20%|██        | 4/20 [00:46<02:37,  9.84s/it]
Task 8, Epoch 5/20 => Loss 0.205, Train_accy 76.62:  20%|██        | 4/20 [00:54<02:37,  9.84s/it]
Task 8, Epoch 5/20 => Loss 0.205, Train_accy 76.62:  25%|██▌       | 5/20 [00:54<02:15,  9.02s/it]
Task 8, Epoch 6/20 => Loss 0.219, Train_accy 79.45, Test_accy 60.41:  25%|██▌       | 5/20 [01:17<02:15,  9.02s/it]
Task 8, Epoch 6/20 => Loss 0.219, Train_accy 79.45, Test_accy 60.41:  30%|███       | 6/20 [01:17<03:14, 13.89s/it]
Task 8, Epoch 7/20 => Loss 0.198, Train_accy 78.30:  30%|███       | 6/20 [01:25<03:14, 13.89s/it]                 
Task 8, Epoch 7/20 => Loss 0.198, Train_accy 78.30:  35%|███▌      | 7/20 [01:25<02:33, 11.83s/it]
Task 8, Epoch 8/20 => Loss 0.194, Train_accy 78.41:  35%|███▌      | 7/20 [01:33<02:33, 11.83s/it]
Task 8, Epoch 8/20 => Loss 0.194, Train_accy 78.41:  40%|████      | 8/20 [01:33<02:07, 10.64s/it]
Task 8, Epoch 9/20 => Loss 0.173, Train_accy 80.50:  40%|████      | 8/20 [01:40<02:07, 10.64s/it]
Task 8, Epoch 9/20 => Loss 0.173, Train_accy 80.50:  45%|████▌     | 9/20 [01:40<01:46,  9.69s/it]
Task 8, Epoch 10/20 => Loss 0.160, Train_accy 80.92:  45%|████▌     | 9/20 [01:48<01:46,  9.69s/it]
Task 8, Epoch 10/20 => Loss 0.160, Train_accy 80.92:  50%|█████     | 10/20 [01:48<01:30,  9.06s/it]
Task 8, Epoch 11/20 => Loss 0.161, Train_accy 81.66, Test_accy 60.03:  50%|█████     | 10/20 [02:12<01:30,  9.06s/it]
Task 8, Epoch 11/20 => Loss 0.161, Train_accy 81.66, Test_accy 60.03:  55%|█████▌    | 11/20 [02:12<02:01, 13.55s/it]
Task 8, Epoch 12/20 => Loss 0.124, Train_accy 84.59:  55%|█████▌    | 11/20 [02:19<02:01, 13.55s/it]                 
Task 8, Epoch 12/20 => Loss 0.124, Train_accy 84.59:  60%|██████    | 12/20 [02:19<01:33, 11.74s/it]
Task 8, Epoch 13/20 => Loss 0.143, Train_accy 85.12:  60%|██████    | 12/20 [02:27<01:33, 11.74s/it]
Task 8, Epoch 13/20 => Loss 0.143, Train_accy 85.12:  65%|██████▌   | 13/20 [02:27<01:13, 10.50s/it]
Task 8, Epoch 14/20 => Loss 0.159, Train_accy 82.60:  65%|██████▌   | 13/20 [02:35<01:13, 10.50s/it]
Task 8, Epoch 14/20 => Loss 0.159, Train_accy 82.60:  70%|███████   | 14/20 [02:35<00:57,  9.62s/it]
Task 8, Epoch 15/20 => Loss 0.175, Train_accy 83.23:  70%|███████   | 14/20 [02:42<00:57,  9.62s/it]
Task 8, Epoch 15/20 => Loss 0.175, Train_accy 83.23:  75%|███████▌  | 15/20 [02:42<00:45,  9.00s/it]
Task 8, Epoch 16/20 => Loss 0.163, Train_accy 84.17, Test_accy 58.86:  75%|███████▌  | 15/20 [03:06<00:45,  9.00s/it]
Task 8, Epoch 16/20 => Loss 0.163, Train_accy 84.17, Test_accy 58.86:  80%|████████  | 16/20 [03:06<00:53, 13.42s/it]
Task 8, Epoch 17/20 => Loss 0.121, Train_accy 85.43:  80%|████████  | 16/20 [03:13<00:53, 13.42s/it]                 
Task 8, Epoch 17/20 => Loss 0.121, Train_accy 85.43:  85%|████████▌ | 17/20 [03:13<00:35, 11.68s/it]
Task 8, Epoch 18/20 => Loss 0.141, Train_accy 85.43:  85%|████████▌ | 17/20 [03:21<00:35, 11.68s/it]
Task 8, Epoch 18/20 => Loss 0.141, Train_accy 85.43:  90%|█████████ | 18/20 [03:21<00:20, 10.46s/it]
Task 8, Epoch 19/20 => Loss 0.136, Train_accy 85.95:  90%|█████████ | 18/20 [03:29<00:20, 10.46s/it]
Task 8, Epoch 19/20 => Loss 0.136, Train_accy 85.95:  95%|█████████▌| 19/20 [03:29<00:09,  9.61s/it]
Task 8, Epoch 20/20 => Loss 0.149, Train_accy 85.12:  95%|█████████▌| 19/20 [03:36<00:09,  9.61s/it]
Task 8, Epoch 20/20 => Loss 0.149, Train_accy 85.12: 100%|██████████| 20/20 [03:36<00:00,  9.02s/it]
Task 8, Epoch 20/20 => Loss 0.149, Train_accy 85.12: 100%|██████████| 20/20 [03:36<00:00, 10.84s/it]
2024-09-07 14:31:58,047 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.149, Train_accy 85.12
2024-09-07 14:32:13,974 [trainer.py] => No NME accuracy.
2024-09-07 14:32:13,975 [trainer.py] => CNN: {'total': 59.25, '00-99': 55.38, '100-109': 50.35, '110-119': 54.79, '120-129': 57.2, '130-139': 53.02, '140-149': 78.47, '150-159': 70.17, '160-169': 63.48, '170-179': 84.27, 'old': 58.05, 'new': 84.27}
2024-09-07 14:32:13,975 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82, 68.89, 65.84, 64.48, 62.61, 59.25]
2024-09-07 14:32:13,975 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77, 87.42, 86.77, 84.24, 82.52, 80.23]

Average Accuracy (CNN): 69.42
2024-09-07 14:32:13,975 [trainer.py] => Average Accuracy (CNN): 69.42 

2024-09-07 14:32:13,976 [trainer.py] => All params: 85937076
2024-09-07 14:32:13,977 [trainer.py] => Trainable params: 85937076
2024-09-07 14:32:13,980 [finetune.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.253, Train_accy 13.49, Test_accy 56.14:   0%|          | 0/20 [00:25<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.253, Train_accy 13.49, Test_accy 56.14:   5%|▌         | 1/20 [00:25<08:09, 25.76s/it]
Task 9, Epoch 2/20 => Loss 0.461, Train_accy 54.99:   5%|▌         | 1/20 [00:34<08:09, 25.76s/it]                 
Task 9, Epoch 2/20 => Loss 0.461, Train_accy 54.99:  10%|█         | 2/20 [00:34<04:47, 15.95s/it]
Task 9, Epoch 3/20 => Loss 0.330, Train_accy 67.51:  10%|█         | 2/20 [00:43<04:47, 15.95s/it]
Task 9, Epoch 3/20 => Loss 0.330, Train_accy 67.51:  15%|█▌        | 3/20 [00:43<03:37, 12.80s/it]
Task 9, Epoch 4/20 => Loss 0.281, Train_accy 70.84:  15%|█▌        | 3/20 [00:53<03:37, 12.80s/it]
Task 9, Epoch 4/20 => Loss 0.281, Train_accy 70.84:  20%|██        | 4/20 [00:53<03:01, 11.35s/it]
Task 9, Epoch 5/20 => Loss 0.258, Train_accy 72.68:  20%|██        | 4/20 [01:02<03:01, 11.35s/it]
Task 9, Epoch 5/20 => Loss 0.258, Train_accy 72.68:  25%|██▌       | 5/20 [01:02<02:38, 10.53s/it]
Task 9, Epoch 6/20 => Loss 0.224, Train_accy 75.48, Test_accy 57.51:  25%|██▌       | 5/20 [01:27<02:38, 10.53s/it]
Task 9, Epoch 6/20 => Loss 0.224, Train_accy 75.48, Test_accy 57.51:  30%|███       | 6/20 [01:27<03:40, 15.75s/it]
Task 9, Epoch 7/20 => Loss 0.228, Train_accy 72.94:  30%|███       | 6/20 [01:37<03:40, 15.75s/it]                 
Task 9, Epoch 7/20 => Loss 0.228, Train_accy 72.94:  35%|███▌      | 7/20 [01:37<02:56, 13.56s/it]
Task 9, Epoch 8/20 => Loss 0.186, Train_accy 77.06:  35%|███▌      | 7/20 [01:46<02:56, 13.56s/it]
Task 9, Epoch 8/20 => Loss 0.186, Train_accy 77.06:  40%|████      | 8/20 [01:46<02:25, 12.12s/it]
Task 9, Epoch 9/20 => Loss 0.172, Train_accy 76.80:  40%|████      | 8/20 [01:55<02:25, 12.12s/it]
Task 9, Epoch 9/20 => Loss 0.172, Train_accy 76.80:  45%|████▌     | 9/20 [01:55<02:03, 11.19s/it]
Task 9, Epoch 10/20 => Loss 0.183, Train_accy 76.97:  45%|████▌     | 9/20 [02:04<02:03, 11.19s/it]
Task 9, Epoch 10/20 => Loss 0.183, Train_accy 76.97:  50%|█████     | 10/20 [02:04<01:45, 10.57s/it]
Task 9, Epoch 11/20 => Loss 0.156, Train_accy 78.28, Test_accy 58.07:  50%|█████     | 10/20 [02:30<01:45, 10.57s/it]
Task 9, Epoch 11/20 => Loss 0.156, Train_accy 78.28, Test_accy 58.07:  55%|█████▌    | 11/20 [02:30<02:17, 15.32s/it]
Task 9, Epoch 12/20 => Loss 0.167, Train_accy 79.33:  55%|█████▌    | 11/20 [02:39<02:17, 15.32s/it]                 
Task 9, Epoch 12/20 => Loss 0.167, Train_accy 79.33:  60%|██████    | 12/20 [02:39<01:47, 13.42s/it]
Task 9, Epoch 13/20 => Loss 0.154, Train_accy 81.26:  60%|██████    | 12/20 [02:48<01:47, 13.42s/it]
Task 9, Epoch 13/20 => Loss 0.154, Train_accy 81.26:  65%|██████▌   | 13/20 [02:48<01:24, 12.11s/it]
Task 9, Epoch 14/20 => Loss 0.121, Train_accy 82.22:  65%|██████▌   | 13/20 [02:57<01:24, 12.11s/it]
Task 9, Epoch 14/20 => Loss 0.121, Train_accy 82.22:  70%|███████   | 14/20 [02:57<01:07, 11.21s/it]
Task 9, Epoch 15/20 => Loss 0.101, Train_accy 85.11:  70%|███████   | 14/20 [03:06<01:07, 11.21s/it]
Task 9, Epoch 15/20 => Loss 0.101, Train_accy 85.11:  75%|███████▌  | 15/20 [03:06<00:52, 10.57s/it]
Task 9, Epoch 16/20 => Loss 0.131, Train_accy 84.68, Test_accy 58.79:  75%|███████▌  | 15/20 [03:32<00:52, 10.57s/it]
Task 9, Epoch 16/20 => Loss 0.131, Train_accy 84.68, Test_accy 58.79:  80%|████████  | 16/20 [03:32<01:00, 15.24s/it]
Task 9, Epoch 17/20 => Loss 0.147, Train_accy 82.31:  80%|████████  | 16/20 [03:42<01:00, 15.24s/it]                 
Task 9, Epoch 17/20 => Loss 0.147, Train_accy 82.31:  85%|████████▌ | 17/20 [03:42<00:40, 13.40s/it]
Task 9, Epoch 18/20 => Loss 0.112, Train_accy 83.54:  85%|████████▌ | 17/20 [03:51<00:40, 13.40s/it]
Task 9, Epoch 18/20 => Loss 0.112, Train_accy 83.54:  90%|█████████ | 18/20 [03:51<00:24, 12.11s/it]
Task 9, Epoch 19/20 => Loss 0.113, Train_accy 82.57:  90%|█████████ | 18/20 [04:00<00:24, 12.11s/it]
Task 9, Epoch 19/20 => Loss 0.113, Train_accy 82.57:  95%|█████████▌| 19/20 [04:00<00:11, 11.18s/it]
Task 9, Epoch 20/20 => Loss 0.140, Train_accy 81.70:  95%|█████████▌| 19/20 [04:09<00:11, 11.18s/it]
Task 9, Epoch 20/20 => Loss 0.140, Train_accy 81.70: 100%|██████████| 20/20 [04:09<00:00, 10.54s/it]
Task 9, Epoch 20/20 => Loss 0.140, Train_accy 81.70: 100%|██████████| 20/20 [04:09<00:00, 12.46s/it]
2024-09-07 14:36:23,243 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.140, Train_accy 81.70
2024-09-07 14:36:40,279 [trainer.py] => No NME accuracy.
2024-09-07 14:36:40,279 [trainer.py] => CNN: {'total': 57.25, '00-99': 52.66, '100-109': 49.65, '110-119': 51.6, '120-129': 54.98, '130-139': 53.36, '140-149': 75.2, '150-159': 63.54, '160-169': 54.35, '170-179': 77.42, '180-189': 78.57, 'old': 56.04, 'new': 78.57}
2024-09-07 14:36:40,279 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82, 68.89, 65.84, 64.48, 62.61, 59.25, 57.25]
2024-09-07 14:36:40,280 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77, 87.42, 86.77, 84.24, 82.52, 80.23, 79.39]

Average Accuracy (CNN): 68.2
2024-09-07 14:36:40,280 [trainer.py] => Average Accuracy (CNN): 68.2 

2024-09-07 14:36:40,281 [trainer.py] => All params: 85944766
2024-09-07 14:36:40,282 [trainer.py] => Trainable params: 85944766
2024-09-07 14:36:40,287 [finetune.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.163, Train_accy 19.86, Test_accy 55.38:   0%|          | 0/20 [00:26<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.163, Train_accy 19.86, Test_accy 55.38:   5%|▌         | 1/20 [00:26<08:22, 26.44s/it]
Task 10, Epoch 2/20 => Loss 0.355, Train_accy 62.50:   5%|▌         | 1/20 [00:35<08:22, 26.44s/it]                 
Task 10, Epoch 2/20 => Loss 0.355, Train_accy 62.50:  10%|█         | 2/20 [00:35<04:50, 16.16s/it]
Task 10, Epoch 3/20 => Loss 0.228, Train_accy 75.00:  10%|█         | 2/20 [00:44<04:50, 16.16s/it]
Task 10, Epoch 3/20 => Loss 0.228, Train_accy 75.00:  15%|█▌        | 3/20 [00:44<03:40, 12.95s/it]
Task 10, Epoch 4/20 => Loss 0.212, Train_accy 76.60:  15%|█▌        | 3/20 [00:53<03:40, 12.95s/it]
Task 10, Epoch 4/20 => Loss 0.212, Train_accy 76.60:  20%|██        | 4/20 [00:53<03:01, 11.37s/it]
Task 10, Epoch 5/20 => Loss 0.169, Train_accy 76.06:  20%|██        | 4/20 [01:02<03:01, 11.37s/it]
Task 10, Epoch 5/20 => Loss 0.169, Train_accy 76.06:  25%|██▌       | 5/20 [01:02<02:37, 10.52s/it]
Task 10, Epoch 6/20 => Loss 0.163, Train_accy 79.43, Test_accy 56.77:  25%|██▌       | 5/20 [01:29<02:37, 10.52s/it]
Task 10, Epoch 6/20 => Loss 0.163, Train_accy 79.43, Test_accy 56.77:  30%|███       | 6/20 [01:29<03:44, 16.01s/it]
Task 10, Epoch 7/20 => Loss 0.110, Train_accy 81.29:  30%|███       | 6/20 [01:38<03:44, 16.01s/it]                 
Task 10, Epoch 7/20 => Loss 0.110, Train_accy 81.29:  35%|███▌      | 7/20 [01:38<02:58, 13.72s/it]
Task 10, Epoch 8/20 => Loss 0.129, Train_accy 80.94:  35%|███▌      | 7/20 [01:47<02:58, 13.72s/it]
Task 10, Epoch 8/20 => Loss 0.129, Train_accy 80.94:  40%|████      | 8/20 [01:47<02:26, 12.20s/it]
Task 10, Epoch 9/20 => Loss 0.147, Train_accy 83.07:  40%|████      | 8/20 [01:56<02:26, 12.20s/it]
Task 10, Epoch 9/20 => Loss 0.147, Train_accy 83.07:  45%|████▌     | 9/20 [01:56<02:03, 11.19s/it]
Task 10, Epoch 10/20 => Loss 0.117, Train_accy 85.02:  45%|████▌     | 9/20 [02:05<02:03, 11.19s/it]
Task 10, Epoch 10/20 => Loss 0.117, Train_accy 85.02:  50%|█████     | 10/20 [02:05<01:45, 10.51s/it]
Task 10, Epoch 11/20 => Loss 0.101, Train_accy 84.93, Test_accy 57.90:  50%|█████     | 10/20 [02:31<01:45, 10.51s/it]
Task 10, Epoch 11/20 => Loss 0.101, Train_accy 84.93, Test_accy 57.90:  55%|█████▌    | 11/20 [02:31<02:19, 15.45s/it]
Task 10, Epoch 12/20 => Loss 0.175, Train_accy 81.03:  55%|█████▌    | 11/20 [02:40<02:19, 15.45s/it]                 
Task 10, Epoch 12/20 => Loss 0.175, Train_accy 81.03:  60%|██████    | 12/20 [02:40<01:47, 13.49s/it]
Task 10, Epoch 13/20 => Loss 0.104, Train_accy 85.28:  60%|██████    | 12/20 [02:49<01:47, 13.49s/it]
Task 10, Epoch 13/20 => Loss 0.104, Train_accy 85.28:  65%|██████▌   | 13/20 [02:49<01:24, 12.11s/it]
Task 10, Epoch 14/20 => Loss 0.121, Train_accy 85.90:  65%|██████▌   | 13/20 [02:58<01:24, 12.11s/it]
Task 10, Epoch 14/20 => Loss 0.121, Train_accy 85.90:  70%|███████   | 14/20 [02:58<01:07, 11.17s/it]
Task 10, Epoch 15/20 => Loss 0.116, Train_accy 85.99:  70%|███████   | 14/20 [03:07<01:07, 11.17s/it]
Task 10, Epoch 15/20 => Loss 0.116, Train_accy 85.99:  75%|███████▌  | 15/20 [03:07<00:52, 10.51s/it]
Task 10, Epoch 16/20 => Loss 0.106, Train_accy 85.82, Test_accy 58.75:  75%|███████▌  | 15/20 [03:34<00:52, 10.51s/it]
Task 10, Epoch 16/20 => Loss 0.106, Train_accy 85.82, Test_accy 58.75:  80%|████████  | 16/20 [03:34<01:01, 15.37s/it]
Task 10, Epoch 17/20 => Loss 0.082, Train_accy 87.68:  80%|████████  | 16/20 [03:43<01:01, 15.37s/it]                 
Task 10, Epoch 17/20 => Loss 0.082, Train_accy 87.68:  85%|████████▌ | 17/20 [03:43<00:40, 13.46s/it]
Task 10, Epoch 18/20 => Loss 0.118, Train_accy 86.52:  85%|████████▌ | 17/20 [03:52<00:40, 13.46s/it]
Task 10, Epoch 18/20 => Loss 0.118, Train_accy 86.52:  90%|█████████ | 18/20 [03:52<00:24, 12.12s/it]
Task 10, Epoch 19/20 => Loss 0.072, Train_accy 86.88:  90%|█████████ | 18/20 [04:01<00:24, 12.12s/it]
Task 10, Epoch 19/20 => Loss 0.072, Train_accy 86.88:  95%|█████████▌| 19/20 [04:01<00:11, 11.17s/it]
Task 10, Epoch 20/20 => Loss 0.096, Train_accy 88.03:  95%|█████████▌| 19/20 [04:10<00:11, 11.17s/it]
Task 10, Epoch 20/20 => Loss 0.096, Train_accy 88.03: 100%|██████████| 20/20 [04:10<00:00, 10.50s/it]
Task 10, Epoch 20/20 => Loss 0.096, Train_accy 88.03: 100%|██████████| 20/20 [04:10<00:00, 12.51s/it]
2024-09-07 14:40:50,518 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.096, Train_accy 88.03
2024-09-07 14:41:08,256 [trainer.py] => No NME accuracy.
2024-09-07 14:41:08,256 [trainer.py] => CNN: {'total': 56.15, '00-99': 50.62, '100-109': 50.7, '110-119': 50.53, '120-129': 52.77, '130-139': 56.71, '140-149': 74.93, '150-159': 57.73, '160-169': 40.0, '170-179': 72.18, '180-189': 71.1, '190-199': 87.82, 'old': 54.65, 'new': 87.82}
2024-09-07 14:41:08,256 [trainer.py] => CNN top1 curve: [81.47, 77.67, 74.73, 69.82, 68.89, 65.84, 64.48, 62.61, 59.25, 57.25, 56.15]
2024-09-07 14:41:08,256 [trainer.py] => CNN top5 curve: [93.74, 91.95, 90.92, 87.77, 87.42, 86.77, 84.24, 82.52, 80.23, 79.39, 78.63]

Average Accuracy (CNN): 67.11
2024-09-07 14:41:08,256 [trainer.py] => Average Accuracy (CNN): 67.11 

Accuracy Matrix (CNN):
[[81.47 76.95 73.17 68.01 66.5  62.98 61.04 59.56 55.38 52.66 50.62]
 [ 0.   85.21 73.24 70.07 64.44 63.03 53.17 52.82 50.35 49.65 50.7 ]
 [ 0.    0.   88.3  75.53 76.33 65.96 59.57 59.57 54.79 51.6  50.53]
 [ 0.    0.    0.   81.55 78.6  71.22 70.85 65.31 57.2  54.98 52.77]
 [ 0.    0.    0.    0.   78.86 64.09 65.1  57.72 53.02 53.36 56.71]
 [ 0.    0.    0.    0.    0.   88.56 84.74 82.29 78.47 75.2  74.93]
 [ 0.    0.    0.    0.    0.    0.   80.94 75.97 70.17 63.54 57.73]
 [ 0.    0.    0.    0.    0.    0.    0.   70.   63.48 54.35 40.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   84.27 77.42 72.18]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   78.57 71.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   87.82]]
2024-09-07 14:41:08,258 [trainer.py] => Forgetting (CNN): 24.045999999999996
2024-09-07 14:41:10,906 [trainer.py] => config: ./exps/simplecil_inr_B0_Inc5.json
2024-09-07 14:41:10,906 [trainer.py] => prefix:  
2024-09-07 14:41:10,906 [trainer.py] => dataset: imagenetr
2024-09-07 14:41:10,906 [trainer.py] => memory_size: 0
2024-09-07 14:41:10,906 [trainer.py] => memory_per_class: 0
2024-09-07 14:41:10,906 [trainer.py] => fixed_memory: False
2024-09-07 14:41:10,906 [trainer.py] => shuffle: True
2024-09-07 14:41:10,906 [trainer.py] => init_cls: 40
2024-09-07 14:41:10,906 [trainer.py] => increment: 40
2024-09-07 14:41:10,906 [trainer.py] => model_name: simplecil
2024-09-07 14:41:10,907 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 14:41:10,907 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 14:41:10,907 [trainer.py] => seed: 1993
2024-09-07 14:41:10,907 [trainer.py] => tuned_epoch: 0
2024-09-07 14:41:10,907 [trainer.py] => init_lr: 0.01
2024-09-07 14:41:10,907 [trainer.py] => batch_size: 48
2024-09-07 14:41:10,907 [trainer.py] => weight_decay: 0.05
2024-09-07 14:41:10,907 [trainer.py] => min_lr: 1e-08
2024-09-07 14:41:10,907 [trainer.py] => optimizer: sgd
2024-09-07 14:41:10,907 [trainer.py] => vpt_type: shallow
2024-09-07 14:41:10,907 [trainer.py] => prompt_token_num: 3
2024-09-07 14:41:10,989 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 14:41:12,783 [trainer.py] => All params: 85798656
2024-09-07 14:41:12,784 [trainer.py] => Trainable params: 85798656
2024-09-07 14:41:13,223 [simplecil.py] => Learning on 0-40
2024-09-07 14:41:34,354 [trainer.py] => No NME accuracy.
2024-09-07 14:41:34,355 [trainer.py] => CNN: {'total': 72.22, '00-39': 72.22, 'old': 0, 'new': 72.22}
2024-09-07 14:41:34,355 [trainer.py] => CNN top1 curve: [72.22]
2024-09-07 14:41:34,355 [trainer.py] => CNN top5 curve: [89.86]

Average Accuracy (CNN): 72.22
2024-09-07 14:41:34,356 [trainer.py] => Average Accuracy (CNN): 72.22 

2024-09-07 14:41:34,357 [trainer.py] => All params: 85829377
2024-09-07 14:41:34,359 [trainer.py] => Trainable params: 85829377
2024-09-07 14:41:34,361 [simplecil.py] => Learning on 40-80
2024-09-07 14:41:56,321 [trainer.py] => No NME accuracy.
2024-09-07 14:41:56,322 [trainer.py] => CNN: {'total': 68.29, '00-39': 67.3, '40-79': 69.41, 'old': 67.3, 'new': 69.41}
2024-09-07 14:41:56,322 [trainer.py] => CNN top1 curve: [72.22, 68.29]
2024-09-07 14:41:56,322 [trainer.py] => CNN top5 curve: [89.86, 84.23]

Average Accuracy (CNN): 70.26
2024-09-07 14:41:56,322 [trainer.py] => Average Accuracy (CNN): 70.26 

2024-09-07 14:41:56,323 [trainer.py] => All params: 85860097
2024-09-07 14:41:56,324 [trainer.py] => Trainable params: 85860097
2024-09-07 14:41:56,327 [simplecil.py] => Learning on 80-120
2024-09-07 14:42:21,986 [trainer.py] => No NME accuracy.
2024-09-07 14:42:21,987 [trainer.py] => CNN: {'total': 64.36, '00-39': 64.72, '40-79': 65.51, '80-119': 62.77, 'old': 65.09, 'new': 62.77}
2024-09-07 14:42:21,987 [trainer.py] => CNN top1 curve: [72.22, 68.29, 64.36]
2024-09-07 14:42:21,987 [trainer.py] => CNN top5 curve: [89.86, 84.23, 80.82]

Average Accuracy (CNN): 68.29
2024-09-07 14:42:21,987 [trainer.py] => Average Accuracy (CNN): 68.29 

2024-09-07 14:42:21,988 [trainer.py] => All params: 85890817
2024-09-07 14:42:21,989 [trainer.py] => Trainable params: 85890817
2024-09-07 14:42:21,992 [simplecil.py] => Learning on 120-160
2024-09-07 14:42:51,802 [trainer.py] => No NME accuracy.
2024-09-07 14:42:51,802 [trainer.py] => CNN: {'total': 63.22, '00-39': 62.91, '40-79': 64.66, '80-119': 60.42, '120-159': 64.71, 'old': 62.69, 'new': 64.71}
2024-09-07 14:42:51,802 [trainer.py] => CNN top1 curve: [72.22, 68.29, 64.36, 63.22]
2024-09-07 14:42:51,802 [trainer.py] => CNN top5 curve: [89.86, 84.23, 80.82, 78.96]

Average Accuracy (CNN): 67.02
2024-09-07 14:42:51,802 [trainer.py] => Average Accuracy (CNN): 67.02 

2024-09-07 14:42:51,803 [trainer.py] => All params: 85921537
2024-09-07 14:42:51,804 [trainer.py] => Trainable params: 85921537
2024-09-07 14:42:51,808 [simplecil.py] => Learning on 160-200
2024-09-07 14:43:22,736 [trainer.py] => No NME accuracy.
2024-09-07 14:43:22,737 [trainer.py] => CNN: {'total': 61.35, '00-39': 61.32, '40-79': 62.79, '80-119': 58.94, '120-159': 62.79, '160-199': 60.64, 'old': 61.5, 'new': 60.64}
2024-09-07 14:43:22,737 [trainer.py] => CNN top1 curve: [72.22, 68.29, 64.36, 63.22, 61.35]
2024-09-07 14:43:22,737 [trainer.py] => CNN top5 curve: [89.86, 84.23, 80.82, 78.96, 76.78]

Average Accuracy (CNN): 65.89
2024-09-07 14:43:22,737 [trainer.py] => Average Accuracy (CNN): 65.89 

Accuracy Matrix (CNN):
[[72.22 67.3  64.72 62.91 61.32]
 [ 0.   69.41 65.51 64.66 62.79]
 [ 0.    0.   62.77 60.42 58.94]
 [ 0.    0.    0.   64.71 62.79]
 [ 0.    0.    0.    0.   60.64]]
2024-09-07 14:43:22,738 [trainer.py] => Forgetting (CNN): 5.817499999999999
2024-09-07 14:43:25,430 [trainer.py] => config: ./exps/simplecil_inr_B0_Inc10.json
2024-09-07 14:43:25,430 [trainer.py] => prefix:  
2024-09-07 14:43:25,430 [trainer.py] => dataset: imagenetr
2024-09-07 14:43:25,430 [trainer.py] => memory_size: 0
2024-09-07 14:43:25,430 [trainer.py] => memory_per_class: 0
2024-09-07 14:43:25,430 [trainer.py] => fixed_memory: False
2024-09-07 14:43:25,430 [trainer.py] => shuffle: True
2024-09-07 14:43:25,431 [trainer.py] => init_cls: 20
2024-09-07 14:43:25,431 [trainer.py] => increment: 20
2024-09-07 14:43:25,431 [trainer.py] => model_name: simplecil
2024-09-07 14:43:25,431 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 14:43:25,431 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 14:43:25,431 [trainer.py] => seed: 1993
2024-09-07 14:43:25,431 [trainer.py] => tuned_epoch: 0
2024-09-07 14:43:25,431 [trainer.py] => init_lr: 0.01
2024-09-07 14:43:25,431 [trainer.py] => batch_size: 48
2024-09-07 14:43:25,431 [trainer.py] => weight_decay: 0.05
2024-09-07 14:43:25,431 [trainer.py] => min_lr: 1e-08
2024-09-07 14:43:25,431 [trainer.py] => optimizer: sgd
2024-09-07 14:43:25,431 [trainer.py] => vpt_type: shallow
2024-09-07 14:43:25,431 [trainer.py] => prompt_token_num: 3
2024-09-07 14:43:25,513 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 14:43:27,303 [trainer.py] => All params: 85798656
2024-09-07 14:43:27,303 [trainer.py] => Trainable params: 85798656
2024-09-07 14:43:27,699 [simplecil.py] => Learning on 0-20
2024-09-07 14:43:39,846 [trainer.py] => No NME accuracy.
2024-09-07 14:43:39,846 [trainer.py] => CNN: {'total': 79.1, '00-19': 79.1, 'old': 0, 'new': 79.1}
2024-09-07 14:43:39,846 [trainer.py] => CNN top1 curve: [79.1]
2024-09-07 14:43:39,846 [trainer.py] => CNN top5 curve: [94.92]

Average Accuracy (CNN): 79.1
2024-09-07 14:43:39,847 [trainer.py] => Average Accuracy (CNN): 79.1 

2024-09-07 14:43:39,848 [trainer.py] => All params: 85814017
2024-09-07 14:43:39,849 [trainer.py] => Trainable params: 85814017
2024-09-07 14:43:39,851 [simplecil.py] => Learning on 20-40
2024-09-07 14:43:52,661 [trainer.py] => No NME accuracy.
2024-09-07 14:43:52,662 [trainer.py] => CNN: {'total': 72.22, '00-19': 75.47, '20-39': 68.67, 'old': 75.47, 'new': 68.67}
2024-09-07 14:43:52,662 [trainer.py] => CNN top1 curve: [79.1, 72.22]
2024-09-07 14:43:52,662 [trainer.py] => CNN top5 curve: [94.92, 89.86]

Average Accuracy (CNN): 75.66
2024-09-07 14:43:52,662 [trainer.py] => Average Accuracy (CNN): 75.66 

2024-09-07 14:43:52,664 [trainer.py] => All params: 85829377
2024-09-07 14:43:52,665 [trainer.py] => Trainable params: 85829377
2024-09-07 14:43:52,668 [simplecil.py] => Learning on 40-60
2024-09-07 14:44:06,651 [trainer.py] => No NME accuracy.
2024-09-07 14:44:06,652 [trainer.py] => CNN: {'total': 70.01, '00-19': 71.55, '20-39': 66.3, '40-59': 72.11, 'old': 69.04, 'new': 72.11}
2024-09-07 14:44:06,652 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01]
2024-09-07 14:44:06,652 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66]

Average Accuracy (CNN): 73.78
2024-09-07 14:44:06,652 [trainer.py] => Average Accuracy (CNN): 73.78 

2024-09-07 14:44:06,654 [trainer.py] => All params: 85844737
2024-09-07 14:44:06,655 [trainer.py] => Trainable params: 85844737
2024-09-07 14:44:06,657 [simplecil.py] => Learning on 60-80
2024-09-07 14:44:22,057 [trainer.py] => No NME accuracy.
2024-09-07 14:44:22,057 [trainer.py] => CNN: {'total': 68.29, '00-19': 69.09, '20-39': 65.35, '40-59': 69.8, '60-79': 69.0, 'old': 68.09, 'new': 69.0}
2024-09-07 14:44:22,057 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01, 68.29]
2024-09-07 14:44:22,057 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66, 84.23]

Average Accuracy (CNN): 72.4
2024-09-07 14:44:22,057 [trainer.py] => Average Accuracy (CNN): 72.4 

2024-09-07 14:44:22,058 [trainer.py] => All params: 85860097
2024-09-07 14:44:22,059 [trainer.py] => Trainable params: 85860097
2024-09-07 14:44:22,062 [simplecil.py] => Learning on 80-100
2024-09-07 14:44:38,596 [trainer.py] => No NME accuracy.
2024-09-07 14:44:38,596 [trainer.py] => CNN: {'total': 65.83, '00-19': 67.49, '20-39': 64.87, '40-59': 66.34, '60-79': 67.78, '80-99': 61.81, 'old': 66.61, 'new': 61.81}
2024-09-07 14:44:38,597 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01, 68.29, 65.83]
2024-09-07 14:44:38,597 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66, 84.23, 82.41]

Average Accuracy (CNN): 71.09
2024-09-07 14:44:38,597 [trainer.py] => Average Accuracy (CNN): 71.09 

2024-09-07 14:44:38,598 [trainer.py] => All params: 85875457
2024-09-07 14:44:38,599 [trainer.py] => Trainable params: 85875457
2024-09-07 14:44:38,601 [simplecil.py] => Learning on 100-120
2024-09-07 14:44:58,159 [trainer.py] => No NME accuracy.
2024-09-07 14:44:58,159 [trainer.py] => CNN: {'total': 64.36, '00-19': 65.31, '20-39': 64.08, '40-59': 65.18, '60-79': 65.85, '80-99': 60.78, '100-119': 64.24, 'old': 64.39, 'new': 64.24}
2024-09-07 14:44:58,159 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01, 68.29, 65.83, 64.36]
2024-09-07 14:44:58,159 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66, 84.23, 82.41, 80.82]

Average Accuracy (CNN): 69.97
2024-09-07 14:44:58,160 [trainer.py] => Average Accuracy (CNN): 69.97 

2024-09-07 14:44:58,161 [trainer.py] => All params: 85890817
2024-09-07 14:44:58,162 [trainer.py] => Trainable params: 85890817
2024-09-07 14:44:58,165 [simplecil.py] => Learning on 120-140
2024-09-07 14:45:17,777 [trainer.py] => No NME accuracy.
2024-09-07 14:45:17,778 [trainer.py] => CNN: {'total': 64.1, '00-19': 64.88, '20-39': 63.45, '40-59': 64.52, '60-79': 65.5, '80-99': 59.34, '100-119': 63.79, '120-139': 66.43, 'old': 63.73, 'new': 66.43}
2024-09-07 14:45:17,778 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01, 68.29, 65.83, 64.36, 64.1]
2024-09-07 14:45:17,778 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66, 84.23, 82.41, 80.82, 79.97]

Average Accuracy (CNN): 69.13
2024-09-07 14:45:17,778 [trainer.py] => Average Accuracy (CNN): 69.13 

2024-09-07 14:45:17,779 [trainer.py] => All params: 85906177
2024-09-07 14:45:17,780 [trainer.py] => Trainable params: 85906177
2024-09-07 14:45:17,783 [simplecil.py] => Learning on 140-160
2024-09-07 14:45:41,771 [trainer.py] => No NME accuracy.
2024-09-07 14:45:41,772 [trainer.py] => CNN: {'total': 63.22, '00-19': 63.43, '20-39': 62.34, '40-59': 64.36, '60-79': 64.97, '80-99': 57.7, '100-119': 62.42, '120-139': 65.55, '140-159': 64.06, 'old': 63.08, 'new': 64.06}
2024-09-07 14:45:41,772 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01, 68.29, 65.83, 64.36, 64.1, 63.22]
2024-09-07 14:45:41,772 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66, 84.23, 82.41, 80.82, 79.97, 78.96]

Average Accuracy (CNN): 68.39
2024-09-07 14:45:41,772 [trainer.py] => Average Accuracy (CNN): 68.39 

2024-09-07 14:45:41,773 [trainer.py] => All params: 85921537
2024-09-07 14:45:41,774 [trainer.py] => Trainable params: 85921537
2024-09-07 14:45:41,777 [simplecil.py] => Learning on 160-180
2024-09-07 14:46:04,504 [trainer.py] => No NME accuracy.
2024-09-07 14:46:04,504 [trainer.py] => CNN: {'total': 62.42, '00-19': 62.12, '20-39': 62.18, '40-59': 63.04, '60-79': 64.1, '80-99': 56.88, '100-119': 61.67, '120-139': 64.67, '140-159': 63.24, '160-179': 63.18, 'old': 62.35, 'new': 63.18}
2024-09-07 14:46:04,504 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01, 68.29, 65.83, 64.36, 64.1, 63.22, 62.42]
2024-09-07 14:46:04,504 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66, 84.23, 82.41, 80.82, 79.97, 78.96, 77.9]

Average Accuracy (CNN): 67.73
2024-09-07 14:46:04,505 [trainer.py] => Average Accuracy (CNN): 67.73 

2024-09-07 14:46:04,506 [trainer.py] => All params: 85936897
2024-09-07 14:46:04,507 [trainer.py] => Trainable params: 85936897
2024-09-07 14:46:04,511 [simplecil.py] => Learning on 180-200
2024-09-07 14:46:29,403 [trainer.py] => No NME accuracy.
2024-09-07 14:46:29,403 [trainer.py] => CNN: {'total': 61.35, '00-19': 61.39, '20-39': 61.23, '40-59': 62.05, '60-79': 63.57, '80-99': 56.06, '100-119': 61.06, '120-139': 63.44, '140-159': 62.28, '160-179': 61.09, '180-199': 60.28, 'old': 61.46, 'new': 60.28}
2024-09-07 14:46:29,403 [trainer.py] => CNN top1 curve: [79.1, 72.22, 70.01, 68.29, 65.83, 64.36, 64.1, 63.22, 62.42, 61.35]
2024-09-07 14:46:29,403 [trainer.py] => CNN top5 curve: [94.92, 89.86, 86.66, 84.23, 82.41, 80.82, 79.97, 78.96, 77.9, 76.78]

Average Accuracy (CNN): 67.09
2024-09-07 14:46:29,403 [trainer.py] => Average Accuracy (CNN): 67.09 

Accuracy Matrix (CNN):
[[79.1  75.47 71.55 69.09 67.49 65.31 64.88 63.43 62.12 61.39]
 [ 0.   68.67 66.3  65.35 64.87 64.08 63.45 62.34 62.18 61.23]
 [ 0.    0.   72.11 69.8  66.34 65.18 64.52 64.36 63.04 62.05]
 [ 0.    0.    0.   69.   67.78 65.85 65.5  64.97 64.1  63.57]
 [ 0.    0.    0.    0.   61.81 60.78 59.34 57.7  56.88 56.06]
 [ 0.    0.    0.    0.    0.   64.24 63.79 62.42 61.67 61.06]
 [ 0.    0.    0.    0.    0.    0.   66.43 65.55 64.67 63.44]
 [ 0.    0.    0.    0.    0.    0.    0.   64.06 63.24 62.28]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   63.18 61.09]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   60.28]]
2024-09-07 14:46:29,405 [trainer.py] => Forgetting (CNN): 6.27
2024-09-07 14:46:32,169 [trainer.py] => config: ./exps/simplecil_inr_B0_Inc20.json
2024-09-07 14:46:32,169 [trainer.py] => prefix:  
2024-09-07 14:46:32,169 [trainer.py] => dataset: imagenetr
2024-09-07 14:46:32,169 [trainer.py] => memory_size: 0
2024-09-07 14:46:32,169 [trainer.py] => memory_per_class: 0
2024-09-07 14:46:32,169 [trainer.py] => fixed_memory: False
2024-09-07 14:46:32,169 [trainer.py] => shuffle: True
2024-09-07 14:46:32,169 [trainer.py] => init_cls: 10
2024-09-07 14:46:32,169 [trainer.py] => increment: 10
2024-09-07 14:46:32,169 [trainer.py] => model_name: simplecil
2024-09-07 14:46:32,169 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 14:46:32,169 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 14:46:32,170 [trainer.py] => seed: 1993
2024-09-07 14:46:32,170 [trainer.py] => tuned_epoch: 0
2024-09-07 14:46:32,170 [trainer.py] => init_lr: 0.01
2024-09-07 14:46:32,170 [trainer.py] => batch_size: 48
2024-09-07 14:46:32,170 [trainer.py] => weight_decay: 0.05
2024-09-07 14:46:32,170 [trainer.py] => min_lr: 1e-08
2024-09-07 14:46:32,170 [trainer.py] => optimizer: sgd
2024-09-07 14:46:32,170 [trainer.py] => vpt_type: shallow
2024-09-07 14:46:32,170 [trainer.py] => prompt_token_num: 3
2024-09-07 14:46:32,252 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 14:46:34,057 [trainer.py] => All params: 85798656
2024-09-07 14:46:34,058 [trainer.py] => Trainable params: 85798656
2024-09-07 14:46:34,464 [simplecil.py] => Learning on 0-10
2024-09-07 14:46:41,233 [trainer.py] => No NME accuracy.
2024-09-07 14:46:41,234 [trainer.py] => CNN: {'total': 82.97, '00-09': 82.97, 'old': 0, 'new': 82.97}
2024-09-07 14:46:41,234 [trainer.py] => CNN top1 curve: [82.97]
2024-09-07 14:46:41,234 [trainer.py] => CNN top5 curve: [99.05]

Average Accuracy (CNN): 82.97
2024-09-07 14:46:41,234 [trainer.py] => Average Accuracy (CNN): 82.97 

2024-09-07 14:46:41,236 [trainer.py] => All params: 85806337
2024-09-07 14:46:41,237 [trainer.py] => Trainable params: 85806337
2024-09-07 14:46:41,239 [simplecil.py] => Learning on 10-20
2024-09-07 14:46:49,300 [trainer.py] => No NME accuracy.
2024-09-07 14:46:49,301 [trainer.py] => CNN: {'total': 79.1, '00-09': 76.34, '10-19': 81.45, 'old': 76.34, 'new': 81.45}
2024-09-07 14:46:49,301 [trainer.py] => CNN top1 curve: [82.97, 79.1]
2024-09-07 14:46:49,301 [trainer.py] => CNN top5 curve: [99.05, 94.92]

Average Accuracy (CNN): 81.04
2024-09-07 14:46:49,301 [trainer.py] => Average Accuracy (CNN): 81.04 

2024-09-07 14:46:49,302 [trainer.py] => All params: 85814017
2024-09-07 14:46:49,304 [trainer.py] => Trainable params: 85814017
2024-09-07 14:46:49,306 [simplecil.py] => Learning on 20-30
2024-09-07 14:46:57,381 [trainer.py] => No NME accuracy.
2024-09-07 14:46:57,381 [trainer.py] => CNN: {'total': 75.23, '00-09': 73.82, '10-19': 78.76, '20-29': 72.33, 'old': 76.49, 'new': 72.33}
2024-09-07 14:46:57,381 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23]
2024-09-07 14:46:57,381 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01]

Average Accuracy (CNN): 79.1
2024-09-07 14:46:57,381 [trainer.py] => Average Accuracy (CNN): 79.1 

2024-09-07 14:46:57,382 [trainer.py] => All params: 85821697
2024-09-07 14:46:57,383 [trainer.py] => Trainable params: 85821697
2024-09-07 14:46:57,384 [simplecil.py] => Learning on 30-40
2024-09-07 14:47:06,810 [trainer.py] => No NME accuracy.
2024-09-07 14:47:06,810 [trainer.py] => CNN: {'total': 72.22, '00-09': 72.56, '10-19': 77.96, '20-29': 70.0, '30-39': 67.47, 'old': 73.81, 'new': 67.47}
2024-09-07 14:47:06,810 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22]
2024-09-07 14:47:06,811 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86]

Average Accuracy (CNN): 77.38
2024-09-07 14:47:06,811 [trainer.py] => Average Accuracy (CNN): 77.38 

2024-09-07 14:47:06,812 [trainer.py] => All params: 85829377
2024-09-07 14:47:06,813 [trainer.py] => Trainable params: 85829377
2024-09-07 14:47:06,815 [simplecil.py] => Learning on 40-50
2024-09-07 14:47:16,241 [trainer.py] => No NME accuracy.
2024-09-07 14:47:16,241 [trainer.py] => CNN: {'total': 70.92, '00-09': 68.14, '10-19': 75.27, '20-29': 67.67, '30-39': 66.57, '40-49': 76.49, 'old': 69.64, 'new': 76.49}
2024-09-07 14:47:16,241 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92]
2024-09-07 14:47:16,241 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49]

Average Accuracy (CNN): 76.09
2024-09-07 14:47:16,241 [trainer.py] => Average Accuracy (CNN): 76.09 

2024-09-07 14:47:16,242 [trainer.py] => All params: 85837057
2024-09-07 14:47:16,243 [trainer.py] => Trainable params: 85837057
2024-09-07 14:47:16,245 [simplecil.py] => Learning on 50-60
2024-09-07 14:47:27,082 [trainer.py] => No NME accuracy.
2024-09-07 14:47:27,083 [trainer.py] => CNN: {'total': 70.01, '00-09': 67.19, '10-19': 75.27, '20-29': 66.67, '30-39': 65.96, '40-49': 76.49, '50-59': 67.76, 'old': 70.43, 'new': 67.76}
2024-09-07 14:47:27,083 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01]
2024-09-07 14:47:27,083 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66]

Average Accuracy (CNN): 75.08
2024-09-07 14:47:27,083 [trainer.py] => Average Accuracy (CNN): 75.08 

2024-09-07 14:47:27,085 [trainer.py] => All params: 85844737
2024-09-07 14:47:27,086 [trainer.py] => Trainable params: 85844737
2024-09-07 14:47:27,088 [simplecil.py] => Learning on 60-70
2024-09-07 14:47:38,607 [trainer.py] => No NME accuracy.
2024-09-07 14:47:38,607 [trainer.py] => CNN: {'total': 68.81, '00-09': 65.62, '10-19': 73.92, '20-29': 65.67, '30-39': 65.06, '40-49': 75.17, '50-59': 67.11, '60-69': 68.46, 'old': 68.86, 'new': 68.46}
2024-09-07 14:47:38,608 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81]
2024-09-07 14:47:38,608 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12]

Average Accuracy (CNN): 74.18
2024-09-07 14:47:38,608 [trainer.py] => Average Accuracy (CNN): 74.18 

2024-09-07 14:47:38,609 [trainer.py] => All params: 85852417
2024-09-07 14:47:38,611 [trainer.py] => Trainable params: 85852417
2024-09-07 14:47:38,613 [simplecil.py] => Learning on 70-80
2024-09-07 14:47:50,510 [trainer.py] => No NME accuracy.
2024-09-07 14:47:50,510 [trainer.py] => CNN: {'total': 68.29, '00-09': 64.67, '10-19': 72.85, '20-29': 65.67, '30-39': 65.06, '40-49': 73.18, '50-59': 66.45, '60-69': 66.78, '70-79': 71.43, 'old': 67.91, 'new': 71.43}
2024-09-07 14:47:50,511 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29]
2024-09-07 14:47:50,511 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23]

Average Accuracy (CNN): 73.44
2024-09-07 14:47:50,511 [trainer.py] => Average Accuracy (CNN): 73.44 

2024-09-07 14:47:50,512 [trainer.py] => All params: 85860097
2024-09-07 14:47:50,513 [trainer.py] => Trainable params: 85860097
2024-09-07 14:47:50,516 [simplecil.py] => Learning on 80-90
2024-09-07 14:48:04,415 [trainer.py] => No NME accuracy.
2024-09-07 14:48:04,415 [trainer.py] => CNN: {'total': 66.74, '00-09': 63.72, '10-19': 71.77, '20-29': 65.33, '30-39': 65.06, '40-49': 70.86, '50-59': 65.13, '60-69': 66.44, '70-79': 71.43, '80-89': 60.65, 'old': 67.49, 'new': 60.65}
2024-09-07 14:48:04,415 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74]
2024-09-07 14:48:04,415 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69]

Average Accuracy (CNN): 72.7
2024-09-07 14:48:04,415 [trainer.py] => Average Accuracy (CNN): 72.7 

2024-09-07 14:48:04,416 [trainer.py] => All params: 85867777
2024-09-07 14:48:04,417 [trainer.py] => Trainable params: 85867777
2024-09-07 14:48:04,418 [simplecil.py] => Learning on 90-100
2024-09-07 14:48:16,804 [trainer.py] => No NME accuracy.
2024-09-07 14:48:16,805 [trainer.py] => CNN: {'total': 65.83, '00-09': 62.78, '10-19': 71.51, '20-29': 65.33, '30-39': 64.46, '40-49': 68.21, '50-59': 64.47, '60-69': 65.1, '70-79': 70.7, '80-89': 59.35, '90-99': 66.1, 'old': 65.81, 'new': 66.1}
2024-09-07 14:48:16,805 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83]
2024-09-07 14:48:16,805 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41]

Average Accuracy (CNN): 72.01
2024-09-07 14:48:16,805 [trainer.py] => Average Accuracy (CNN): 72.01 

2024-09-07 14:48:16,807 [trainer.py] => All params: 85875457
2024-09-07 14:48:16,808 [trainer.py] => Trainable params: 85875457
2024-09-07 14:48:16,810 [simplecil.py] => Learning on 100-110
2024-09-07 14:48:31,183 [trainer.py] => No NME accuracy.
2024-09-07 14:48:31,183 [trainer.py] => CNN: {'total': 65.25, '00-09': 61.2, '10-19': 70.7, '20-29': 64.67, '30-39': 64.16, '40-49': 66.89, '50-59': 63.82, '60-69': 64.43, '70-79': 69.23, '80-89': 58.06, '90-99': 66.1, '100-109': 68.66, 'old': 64.92, 'new': 68.66}
2024-09-07 14:48:31,184 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25]
2024-09-07 14:48:31,184 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95]

Average Accuracy (CNN): 71.4
2024-09-07 14:48:31,184 [trainer.py] => Average Accuracy (CNN): 71.4 

2024-09-07 14:48:31,185 [trainer.py] => All params: 85883137
2024-09-07 14:48:31,186 [trainer.py] => Trainable params: 85883137
2024-09-07 14:48:31,188 [simplecil.py] => Learning on 110-120
2024-09-07 14:48:47,292 [trainer.py] => No NME accuracy.
2024-09-07 14:48:47,292 [trainer.py] => CNN: {'total': 64.36, '00-09': 59.94, '10-19': 69.89, '20-29': 64.33, '30-39': 63.86, '40-49': 66.56, '50-59': 63.82, '60-69': 63.09, '70-79': 68.86, '80-89': 58.06, '90-99': 65.54, '100-109': 68.31, '110-119': 61.17, 'old': 64.73, 'new': 61.17}
2024-09-07 14:48:47,293 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36]
2024-09-07 14:48:47,293 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82]

Average Accuracy (CNN): 70.81
2024-09-07 14:48:47,293 [trainer.py] => Average Accuracy (CNN): 70.81 

2024-09-07 14:48:47,294 [trainer.py] => All params: 85890817
2024-09-07 14:48:47,295 [trainer.py] => Trainable params: 85890817
2024-09-07 14:48:47,297 [simplecil.py] => Learning on 120-130
2024-09-07 14:49:02,904 [trainer.py] => No NME accuracy.
2024-09-07 14:49:02,905 [trainer.py] => CNN: {'total': 63.82, '00-09': 59.94, '10-19': 69.35, '20-29': 64.0, '30-39': 63.55, '40-49': 65.56, '50-59': 63.82, '60-69': 62.75, '70-79': 68.5, '80-89': 57.42, '90-99': 63.28, '100-109': 67.96, '110-119': 61.17, '120-129': 62.36, 'old': 63.92, 'new': 62.36}
2024-09-07 14:49:02,905 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82]
2024-09-07 14:49:02,905 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06]

Average Accuracy (CNN): 70.27
2024-09-07 14:49:02,905 [trainer.py] => Average Accuracy (CNN): 70.27 

2024-09-07 14:49:02,906 [trainer.py] => All params: 85898497
2024-09-07 14:49:02,907 [trainer.py] => Trainable params: 85898497
2024-09-07 14:49:02,911 [simplecil.py] => Learning on 130-140
2024-09-07 14:49:19,813 [trainer.py] => No NME accuracy.
2024-09-07 14:49:19,814 [trainer.py] => CNN: {'total': 64.1, '00-09': 59.62, '10-19': 69.35, '20-29': 63.33, '30-39': 63.55, '40-49': 65.56, '50-59': 63.49, '60-69': 62.75, '70-79': 68.5, '80-89': 57.42, '90-99': 62.71, '100-109': 67.25, '110-119': 61.17, '120-129': 61.62, '130-139': 70.81, 'old': 63.59, 'new': 70.81}
2024-09-07 14:49:19,814 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82, 64.1]
2024-09-07 14:49:19,814 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06, 79.97]

Average Accuracy (CNN): 69.83
2024-09-07 14:49:19,814 [trainer.py] => Average Accuracy (CNN): 69.83 

2024-09-07 14:49:19,815 [trainer.py] => All params: 85906177
2024-09-07 14:49:19,815 [trainer.py] => Trainable params: 85906177
2024-09-07 14:49:19,817 [simplecil.py] => Learning on 140-150
2024-09-07 14:49:38,338 [trainer.py] => No NME accuracy.
2024-09-07 14:49:38,339 [trainer.py] => CNN: {'total': 63.57, '00-09': 58.99, '10-19': 68.82, '20-29': 62.67, '30-39': 63.55, '40-49': 65.56, '50-59': 63.49, '60-69': 62.42, '70-79': 68.5, '80-89': 57.1, '90-99': 61.02, '100-109': 66.9, '110-119': 60.11, '120-129': 61.25, '130-139': 70.81, '140-149': 62.13, 'old': 63.69, 'new': 62.13}
2024-09-07 14:49:38,339 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82, 64.1, 63.57]
2024-09-07 14:49:38,339 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06, 79.97, 79.66]

Average Accuracy (CNN): 69.41
2024-09-07 14:49:38,339 [trainer.py] => Average Accuracy (CNN): 69.41 

2024-09-07 14:49:38,340 [trainer.py] => All params: 85913857
2024-09-07 14:49:38,341 [trainer.py] => Trainable params: 85913857
2024-09-07 14:49:38,343 [simplecil.py] => Learning on 150-160
2024-09-07 14:49:58,076 [trainer.py] => No NME accuracy.
2024-09-07 14:49:58,077 [trainer.py] => CNN: {'total': 63.22, '00-09': 58.36, '10-19': 67.74, '20-29': 62.0, '30-39': 62.65, '40-49': 65.56, '50-59': 63.16, '60-69': 62.42, '70-79': 67.77, '80-89': 55.81, '90-99': 61.02, '100-109': 66.2, '110-119': 59.57, '120-129': 60.52, '130-139': 70.13, '140-149': 61.31, '150-159': 66.85, 'old': 62.93, 'new': 66.85}
2024-09-07 14:49:58,077 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22]
2024-09-07 14:49:58,077 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96]

Average Accuracy (CNN): 69.03
2024-09-07 14:49:58,077 [trainer.py] => Average Accuracy (CNN): 69.03 

2024-09-07 14:49:58,078 [trainer.py] => All params: 85921537
2024-09-07 14:49:58,079 [trainer.py] => Trainable params: 85921537
2024-09-07 14:49:58,081 [simplecil.py] => Learning on 160-170
2024-09-07 14:50:17,240 [trainer.py] => No NME accuracy.
2024-09-07 14:50:17,240 [trainer.py] => CNN: {'total': 62.15, '00-09': 57.41, '10-19': 66.94, '20-29': 61.67, '30-39': 62.65, '40-49': 63.91, '50-59': 62.5, '60-69': 61.74, '70-79': 67.03, '80-89': 55.48, '90-99': 61.02, '100-109': 64.79, '110-119': 59.31, '120-129': 59.41, '130-139': 70.13, '140-149': 60.76, '150-159': 66.02, '160-169': 53.04, 'old': 62.57, 'new': 53.04}
2024-09-07 14:50:17,240 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15]
2024-09-07 14:50:17,241 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92]

Average Accuracy (CNN): 68.62
2024-09-07 14:50:17,241 [trainer.py] => Average Accuracy (CNN): 68.62 

2024-09-07 14:50:17,242 [trainer.py] => All params: 85929217
2024-09-07 14:50:17,242 [trainer.py] => Trainable params: 85929217
2024-09-07 14:50:17,246 [simplecil.py] => Learning on 170-180
2024-09-07 14:50:37,004 [trainer.py] => No NME accuracy.
2024-09-07 14:50:37,005 [trainer.py] => CNN: {'total': 62.42, '00-09': 56.78, '10-19': 66.67, '20-29': 61.67, '30-39': 62.65, '40-49': 63.58, '50-59': 62.5, '60-69': 61.74, '70-79': 66.67, '80-89': 55.48, '90-99': 59.32, '100-109': 64.79, '110-119': 59.31, '120-129': 58.67, '130-139': 70.13, '140-149': 60.49, '150-159': 66.02, '160-169': 52.17, '170-179': 73.39, 'old': 61.9, 'new': 73.39}
2024-09-07 14:50:37,005 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15, 62.42]
2024-09-07 14:50:37,005 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92, 77.9]

Average Accuracy (CNN): 68.28
2024-09-07 14:50:37,005 [trainer.py] => Average Accuracy (CNN): 68.28 

2024-09-07 14:50:37,007 [trainer.py] => All params: 85936897
2024-09-07 14:50:37,008 [trainer.py] => Trainable params: 85936897
2024-09-07 14:50:37,012 [simplecil.py] => Learning on 180-190
2024-09-07 14:50:58,223 [trainer.py] => No NME accuracy.
2024-09-07 14:50:58,223 [trainer.py] => CNN: {'total': 61.63, '00-09': 56.78, '10-19': 66.13, '20-29': 60.67, '30-39': 62.65, '40-49': 62.91, '50-59': 61.51, '60-69': 61.07, '70-79': 66.67, '80-89': 54.52, '90-99': 58.76, '100-109': 64.44, '110-119': 59.04, '120-129': 58.67, '130-139': 69.13, '140-149': 60.22, '150-159': 65.47, '160-169': 52.17, '170-179': 72.18, '180-189': 56.49, 'old': 61.93, 'new': 56.49}
2024-09-07 14:50:58,223 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15, 62.42, 61.63]
2024-09-07 14:50:58,223 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92, 77.9, 77.13]

Average Accuracy (CNN): 67.93
2024-09-07 14:50:58,224 [trainer.py] => Average Accuracy (CNN): 67.93 

2024-09-07 14:50:58,224 [trainer.py] => All params: 85944577
2024-09-07 14:50:58,225 [trainer.py] => Trainable params: 85944577
2024-09-07 14:50:58,228 [simplecil.py] => Learning on 190-200
2024-09-07 14:51:19,882 [trainer.py] => No NME accuracy.
2024-09-07 14:51:19,882 [trainer.py] => CNN: {'total': 61.35, '00-09': 56.78, '10-19': 65.32, '20-29': 60.33, '30-39': 62.05, '40-49': 62.91, '50-59': 61.18, '60-69': 60.74, '70-79': 66.67, '80-89': 54.52, '90-99': 58.76, '100-109': 63.73, '110-119': 59.04, '120-129': 57.93, '130-139': 68.46, '140-149': 59.67, '150-159': 64.92, '160-169': 49.13, '170-179': 72.18, '180-189': 56.49, '190-199': 64.58, 'old': 61.2, 'new': 64.58}
2024-09-07 14:51:19,882 [trainer.py] => CNN top1 curve: [82.97, 79.1, 75.23, 72.22, 70.92, 70.01, 68.81, 68.29, 66.74, 65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15, 62.42, 61.63, 61.35]
2024-09-07 14:51:19,882 [trainer.py] => CNN top5 curve: [99.05, 94.92, 92.01, 89.86, 87.49, 86.66, 85.12, 84.23, 82.69, 82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92, 77.9, 77.13, 76.78]

Average Accuracy (CNN): 67.6
2024-09-07 14:51:19,882 [trainer.py] => Average Accuracy (CNN): 67.6 

Accuracy Matrix (CNN):
[[82.97 76.34 73.82 72.56 68.14 67.19 65.62 64.67 63.72 62.78 61.2  59.94
  59.94 59.62 58.99 58.36 57.41 56.78 56.78 56.78]
 [ 0.   81.45 78.76 77.96 75.27 75.27 73.92 72.85 71.77 71.51 70.7  69.89
  69.35 69.35 68.82 67.74 66.94 66.67 66.13 65.32]
 [ 0.    0.   72.33 70.   67.67 66.67 65.67 65.67 65.33 65.33 64.67 64.33
  64.   63.33 62.67 62.   61.67 61.67 60.67 60.33]
 [ 0.    0.    0.   67.47 66.57 65.96 65.06 65.06 65.06 64.46 64.16 63.86
  63.55 63.55 63.55 62.65 62.65 62.65 62.65 62.05]
 [ 0.    0.    0.    0.   76.49 76.49 75.17 73.18 70.86 68.21 66.89 66.56
  65.56 65.56 65.56 65.56 63.91 63.58 62.91 62.91]
 [ 0.    0.    0.    0.    0.   67.76 67.11 66.45 65.13 64.47 63.82 63.82
  63.82 63.49 63.49 63.16 62.5  62.5  61.51 61.18]
 [ 0.    0.    0.    0.    0.    0.   68.46 66.78 66.44 65.1  64.43 63.09
  62.75 62.75 62.42 62.42 61.74 61.74 61.07 60.74]
 [ 0.    0.    0.    0.    0.    0.    0.   71.43 71.43 70.7  69.23 68.86
  68.5  68.5  68.5  67.77 67.03 66.67 66.67 66.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   60.65 59.35 58.06 58.06
  57.42 57.42 57.1  55.81 55.48 55.48 54.52 54.52]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   66.1  66.1  65.54
  63.28 62.71 61.02 61.02 61.02 59.32 58.76 58.76]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   68.66 68.31
  67.96 67.25 66.9  66.2  64.79 64.79 64.44 63.73]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   61.17
  61.17 61.17 60.11 59.57 59.31 59.31 59.04 59.04]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  62.36 61.62 61.25 60.52 59.41 58.67 58.67 57.93]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   70.81 70.81 70.13 70.13 70.13 69.13 68.46]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   62.13 61.31 60.76 60.49 60.22 59.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   66.85 66.02 66.02 65.47 64.92]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   53.04 52.17 52.17 49.13]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   73.39 72.18 72.18]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   56.49 56.49]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   64.58]]
2024-09-07 14:51:19,886 [trainer.py] => Forgetting (CNN): 6.8
2024-09-07 14:51:22,688 [trainer.py] => config: ./exps/simplecil_inr_B100_Inc5.json
2024-09-07 14:51:22,688 [trainer.py] => prefix:  
2024-09-07 14:51:22,689 [trainer.py] => dataset: imagenetr
2024-09-07 14:51:22,689 [trainer.py] => memory_size: 0
2024-09-07 14:51:22,689 [trainer.py] => memory_per_class: 0
2024-09-07 14:51:22,689 [trainer.py] => fixed_memory: False
2024-09-07 14:51:22,689 [trainer.py] => shuffle: True
2024-09-07 14:51:22,689 [trainer.py] => init_cls: 100
2024-09-07 14:51:22,689 [trainer.py] => increment: 20
2024-09-07 14:51:22,689 [trainer.py] => model_name: simplecil
2024-09-07 14:51:22,689 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 14:51:22,689 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 14:51:22,689 [trainer.py] => seed: 1993
2024-09-07 14:51:22,689 [trainer.py] => tuned_epoch: 0
2024-09-07 14:51:22,689 [trainer.py] => init_lr: 0.01
2024-09-07 14:51:22,689 [trainer.py] => batch_size: 48
2024-09-07 14:51:22,689 [trainer.py] => weight_decay: 0.05
2024-09-07 14:51:22,689 [trainer.py] => min_lr: 1e-08
2024-09-07 14:51:22,689 [trainer.py] => optimizer: sgd
2024-09-07 14:51:22,689 [trainer.py] => vpt_type: shallow
2024-09-07 14:51:22,689 [trainer.py] => prompt_token_num: 3
2024-09-07 14:51:22,772 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 14:51:24,529 [trainer.py] => All params: 85798656
2024-09-07 14:51:24,530 [trainer.py] => Trainable params: 85798656
2024-09-07 14:51:24,913 [simplecil.py] => Learning on 0-100
2024-09-07 14:52:09,461 [trainer.py] => No NME accuracy.
2024-09-07 14:52:09,462 [trainer.py] => CNN: {'total': 65.83, '00-99': 65.83, 'old': 0, 'new': 65.83}
2024-09-07 14:52:09,462 [trainer.py] => CNN top1 curve: [65.83]
2024-09-07 14:52:09,462 [trainer.py] => CNN top5 curve: [82.41]

Average Accuracy (CNN): 65.83
2024-09-07 14:52:09,462 [trainer.py] => Average Accuracy (CNN): 65.83 

2024-09-07 14:52:09,463 [trainer.py] => All params: 85875457
2024-09-07 14:52:09,464 [trainer.py] => Trainable params: 85875457
2024-09-07 14:52:09,467 [simplecil.py] => Learning on 100-120
2024-09-07 14:52:28,993 [trainer.py] => No NME accuracy.
2024-09-07 14:52:28,993 [trainer.py] => CNN: {'total': 64.36, '00-99': 64.39, '100-119': 64.24, 'old': 64.39, 'new': 64.24}
2024-09-07 14:52:28,993 [trainer.py] => CNN top1 curve: [65.83, 64.36]
2024-09-07 14:52:28,993 [trainer.py] => CNN top5 curve: [82.41, 80.82]

Average Accuracy (CNN): 65.1
2024-09-07 14:52:28,994 [trainer.py] => Average Accuracy (CNN): 65.1 

2024-09-07 14:52:28,995 [trainer.py] => All params: 85890817
2024-09-07 14:52:28,996 [trainer.py] => Trainable params: 85890817
2024-09-07 14:52:28,999 [simplecil.py] => Learning on 120-140
2024-09-07 14:52:48,798 [trainer.py] => No NME accuracy.
2024-09-07 14:52:48,799 [trainer.py] => CNN: {'total': 64.1, '00-99': 63.72, '100-119': 63.79, '120-139': 66.43, 'old': 63.73, 'new': 66.43}
2024-09-07 14:52:48,799 [trainer.py] => CNN top1 curve: [65.83, 64.36, 64.1]
2024-09-07 14:52:48,799 [trainer.py] => CNN top5 curve: [82.41, 80.82, 79.97]

Average Accuracy (CNN): 64.76
2024-09-07 14:52:48,799 [trainer.py] => Average Accuracy (CNN): 64.76 

2024-09-07 14:52:48,800 [trainer.py] => All params: 85906177
2024-09-07 14:52:48,801 [trainer.py] => Trainable params: 85906177
2024-09-07 14:52:48,803 [simplecil.py] => Learning on 140-160
2024-09-07 14:53:12,667 [trainer.py] => No NME accuracy.
2024-09-07 14:53:12,667 [trainer.py] => CNN: {'total': 63.22, '00-99': 62.75, '100-119': 62.42, '120-139': 65.55, '140-159': 64.06, 'old': 63.08, 'new': 64.06}
2024-09-07 14:53:12,667 [trainer.py] => CNN top1 curve: [65.83, 64.36, 64.1, 63.22]
2024-09-07 14:53:12,667 [trainer.py] => CNN top5 curve: [82.41, 80.82, 79.97, 78.96]

Average Accuracy (CNN): 64.38
2024-09-07 14:53:12,668 [trainer.py] => Average Accuracy (CNN): 64.38 

2024-09-07 14:53:12,669 [trainer.py] => All params: 85921537
2024-09-07 14:53:12,669 [trainer.py] => Trainable params: 85921537
2024-09-07 14:53:12,672 [simplecil.py] => Learning on 160-180
2024-09-07 14:53:35,180 [trainer.py] => No NME accuracy.
2024-09-07 14:53:35,181 [trainer.py] => CNN: {'total': 62.42, '00-99': 61.84, '100-119': 61.67, '120-139': 64.67, '140-159': 63.24, '160-179': 63.18, 'old': 62.35, 'new': 63.18}
2024-09-07 14:53:35,181 [trainer.py] => CNN top1 curve: [65.83, 64.36, 64.1, 63.22, 62.42]
2024-09-07 14:53:35,181 [trainer.py] => CNN top5 curve: [82.41, 80.82, 79.97, 78.96, 77.9]

Average Accuracy (CNN): 63.99
2024-09-07 14:53:35,181 [trainer.py] => Average Accuracy (CNN): 63.99 

2024-09-07 14:53:35,182 [trainer.py] => All params: 85936897
2024-09-07 14:53:35,184 [trainer.py] => Trainable params: 85936897
2024-09-07 14:53:35,187 [simplecil.py] => Learning on 180-200
2024-09-07 14:54:00,254 [trainer.py] => No NME accuracy.
2024-09-07 14:54:00,254 [trainer.py] => CNN: {'total': 61.35, '00-99': 61.04, '100-119': 61.06, '120-139': 63.44, '140-159': 62.28, '160-179': 61.09, '180-199': 60.28, 'old': 61.46, 'new': 60.28}
2024-09-07 14:54:00,254 [trainer.py] => CNN top1 curve: [65.83, 64.36, 64.1, 63.22, 62.42, 61.35]
2024-09-07 14:54:00,254 [trainer.py] => CNN top5 curve: [82.41, 80.82, 79.97, 78.96, 77.9, 76.78]

Average Accuracy (CNN): 63.55
2024-09-07 14:54:00,255 [trainer.py] => Average Accuracy (CNN): 63.55 

Accuracy Matrix (CNN):
[[65.83 64.39 63.72 62.75 61.84 61.04]
 [ 0.   64.24 63.79 62.42 61.67 61.06]
 [ 0.    0.   66.43 65.55 64.67 63.44]
 [ 0.    0.    0.   64.06 63.24 62.28]
 [ 0.    0.    0.    0.   63.18 61.09]
 [ 0.    0.    0.    0.    0.   60.28]]
2024-09-07 14:54:00,256 [trainer.py] => Forgetting (CNN): 2.9659999999999997
2024-09-07 14:54:03,079 [trainer.py] => config: ./exps/simplecil_inr_B100_Inc10.json
2024-09-07 14:54:03,079 [trainer.py] => prefix:  
2024-09-07 14:54:03,079 [trainer.py] => dataset: imagenetr
2024-09-07 14:54:03,079 [trainer.py] => memory_size: 0
2024-09-07 14:54:03,079 [trainer.py] => memory_per_class: 0
2024-09-07 14:54:03,079 [trainer.py] => fixed_memory: False
2024-09-07 14:54:03,079 [trainer.py] => shuffle: True
2024-09-07 14:54:03,079 [trainer.py] => init_cls: 100
2024-09-07 14:54:03,079 [trainer.py] => increment: 10
2024-09-07 14:54:03,080 [trainer.py] => model_name: simplecil
2024-09-07 14:54:03,080 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-07 14:54:03,080 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 14:54:03,080 [trainer.py] => seed: 1993
2024-09-07 14:54:03,080 [trainer.py] => tuned_epoch: 0
2024-09-07 14:54:03,080 [trainer.py] => init_lr: 0.01
2024-09-07 14:54:03,080 [trainer.py] => batch_size: 48
2024-09-07 14:54:03,080 [trainer.py] => weight_decay: 0.05
2024-09-07 14:54:03,080 [trainer.py] => min_lr: 1e-08
2024-09-07 14:54:03,080 [trainer.py] => optimizer: sgd
2024-09-07 14:54:03,080 [trainer.py] => vpt_type: shallow
2024-09-07 14:54:03,080 [trainer.py] => prompt_token_num: 3
2024-09-07 14:54:03,163 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-07 14:54:04,940 [trainer.py] => All params: 85798656
2024-09-07 14:54:04,941 [trainer.py] => Trainable params: 85798656
2024-09-07 14:54:05,328 [simplecil.py] => Learning on 0-100
2024-09-07 14:54:50,272 [trainer.py] => No NME accuracy.
2024-09-07 14:54:50,272 [trainer.py] => CNN: {'total': 65.83, '00-99': 65.83, 'old': 0, 'new': 65.83}
2024-09-07 14:54:50,273 [trainer.py] => CNN top1 curve: [65.83]
2024-09-07 14:54:50,273 [trainer.py] => CNN top5 curve: [82.41]

Average Accuracy (CNN): 65.83
2024-09-07 14:54:50,273 [trainer.py] => Average Accuracy (CNN): 65.83 

2024-09-07 14:54:50,274 [trainer.py] => All params: 85875457
2024-09-07 14:54:50,276 [trainer.py] => Trainable params: 85875457
2024-09-07 14:54:50,278 [simplecil.py] => Learning on 100-110
2024-09-07 14:55:04,733 [trainer.py] => No NME accuracy.
2024-09-07 14:55:04,733 [trainer.py] => CNN: {'total': 65.25, '00-99': 64.92, '100-109': 68.66, 'old': 64.92, 'new': 68.66}
2024-09-07 14:55:04,733 [trainer.py] => CNN top1 curve: [65.83, 65.25]
2024-09-07 14:55:04,733 [trainer.py] => CNN top5 curve: [82.41, 81.95]

Average Accuracy (CNN): 65.54
2024-09-07 14:55:04,734 [trainer.py] => Average Accuracy (CNN): 65.54 

2024-09-07 14:55:04,735 [trainer.py] => All params: 85883137
2024-09-07 14:55:04,736 [trainer.py] => Trainable params: 85883137
2024-09-07 14:55:04,737 [simplecil.py] => Learning on 110-120
2024-09-07 14:55:21,164 [trainer.py] => No NME accuracy.
2024-09-07 14:55:21,165 [trainer.py] => CNN: {'total': 64.36, '00-99': 64.39, '100-109': 68.31, '110-119': 61.17, 'old': 64.73, 'new': 61.17}
2024-09-07 14:55:21,165 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36]
2024-09-07 14:55:21,165 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82]

Average Accuracy (CNN): 65.15
2024-09-07 14:55:21,165 [trainer.py] => Average Accuracy (CNN): 65.15 

2024-09-07 14:55:21,167 [trainer.py] => All params: 85890817
2024-09-07 14:55:21,168 [trainer.py] => Trainable params: 85890817
2024-09-07 14:55:21,172 [simplecil.py] => Learning on 120-130
2024-09-07 14:55:36,834 [trainer.py] => No NME accuracy.
2024-09-07 14:55:36,834 [trainer.py] => CNN: {'total': 63.82, '00-99': 63.89, '100-109': 67.96, '110-119': 61.17, '120-129': 62.36, 'old': 63.92, 'new': 62.36}
2024-09-07 14:55:36,834 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82]
2024-09-07 14:55:36,835 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06]

Average Accuracy (CNN): 64.82
2024-09-07 14:55:36,835 [trainer.py] => Average Accuracy (CNN): 64.82 

2024-09-07 14:55:36,836 [trainer.py] => All params: 85898497
2024-09-07 14:55:36,837 [trainer.py] => Trainable params: 85898497
2024-09-07 14:55:36,839 [simplecil.py] => Learning on 130-140
2024-09-07 14:55:53,875 [trainer.py] => No NME accuracy.
2024-09-07 14:55:53,875 [trainer.py] => CNN: {'total': 64.1, '00-99': 63.72, '100-109': 67.25, '110-119': 61.17, '120-129': 61.62, '130-139': 70.81, 'old': 63.59, 'new': 70.81}
2024-09-07 14:55:53,876 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82, 64.1]
2024-09-07 14:55:53,876 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06, 79.97]

Average Accuracy (CNN): 64.67
2024-09-07 14:55:53,876 [trainer.py] => Average Accuracy (CNN): 64.67 

2024-09-07 14:55:53,877 [trainer.py] => All params: 85906177
2024-09-07 14:55:53,878 [trainer.py] => Trainable params: 85906177
2024-09-07 14:55:53,880 [simplecil.py] => Learning on 140-150
2024-09-07 14:56:12,527 [trainer.py] => No NME accuracy.
2024-09-07 14:56:12,527 [trainer.py] => CNN: {'total': 63.57, '00-99': 63.35, '100-109': 66.9, '110-119': 60.11, '120-129': 61.25, '130-139': 70.81, '140-149': 62.13, 'old': 63.69, 'new': 62.13}
2024-09-07 14:56:12,527 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82, 64.1, 63.57]
2024-09-07 14:56:12,527 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06, 79.97, 79.66]

Average Accuracy (CNN): 64.49
2024-09-07 14:56:12,527 [trainer.py] => Average Accuracy (CNN): 64.49 

2024-09-07 14:56:12,528 [trainer.py] => All params: 85913857
2024-09-07 14:56:12,529 [trainer.py] => Trainable params: 85913857
2024-09-07 14:56:12,532 [simplecil.py] => Learning on 150-160
2024-09-07 14:56:32,328 [trainer.py] => No NME accuracy.
2024-09-07 14:56:32,328 [trainer.py] => CNN: {'total': 63.22, '00-99': 62.75, '100-109': 66.2, '110-119': 59.57, '120-129': 60.52, '130-139': 70.13, '140-149': 61.31, '150-159': 66.85, 'old': 62.93, 'new': 66.85}
2024-09-07 14:56:32,328 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22]
2024-09-07 14:56:32,328 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96]

Average Accuracy (CNN): 64.31
2024-09-07 14:56:32,328 [trainer.py] => Average Accuracy (CNN): 64.31 

2024-09-07 14:56:32,330 [trainer.py] => All params: 85921537
2024-09-07 14:56:32,331 [trainer.py] => Trainable params: 85921537
2024-09-07 14:56:32,333 [simplecil.py] => Learning on 160-170
2024-09-07 14:56:51,619 [trainer.py] => No NME accuracy.
2024-09-07 14:56:51,619 [trainer.py] => CNN: {'total': 62.15, '00-99': 62.11, '100-109': 64.79, '110-119': 59.31, '120-129': 59.41, '130-139': 70.13, '140-149': 60.76, '150-159': 66.02, '160-169': 53.04, 'old': 62.57, 'new': 53.04}
2024-09-07 14:56:51,620 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15]
2024-09-07 14:56:51,620 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92]

Average Accuracy (CNN): 64.04
2024-09-07 14:56:51,620 [trainer.py] => Average Accuracy (CNN): 64.04 

2024-09-07 14:56:51,621 [trainer.py] => All params: 85929217
2024-09-07 14:56:51,622 [trainer.py] => Trainable params: 85929217
2024-09-07 14:56:51,625 [simplecil.py] => Learning on 170-180
2024-09-07 14:57:11,490 [trainer.py] => No NME accuracy.
2024-09-07 14:57:11,490 [trainer.py] => CNN: {'total': 62.42, '00-99': 61.84, '100-109': 64.79, '110-119': 59.31, '120-129': 58.67, '130-139': 70.13, '140-149': 60.49, '150-159': 66.02, '160-169': 52.17, '170-179': 73.39, 'old': 61.9, 'new': 73.39}
2024-09-07 14:57:11,490 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15, 62.42]
2024-09-07 14:57:11,490 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92, 77.9]

Average Accuracy (CNN): 63.86
2024-09-07 14:57:11,490 [trainer.py] => Average Accuracy (CNN): 63.86 

2024-09-07 14:57:11,492 [trainer.py] => All params: 85936897
2024-09-07 14:57:11,493 [trainer.py] => Trainable params: 85936897
2024-09-07 14:57:11,496 [simplecil.py] => Learning on 180-190
2024-09-07 14:57:32,789 [trainer.py] => No NME accuracy.
2024-09-07 14:57:32,789 [trainer.py] => CNN: {'total': 61.63, '00-99': 61.31, '100-109': 64.44, '110-119': 59.04, '120-129': 58.67, '130-139': 69.13, '140-149': 60.22, '150-159': 65.47, '160-169': 52.17, '170-179': 72.18, '180-189': 56.49, 'old': 61.93, 'new': 56.49}
2024-09-07 14:57:32,789 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15, 62.42, 61.63]
2024-09-07 14:57:32,789 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92, 77.9, 77.13]

Average Accuracy (CNN): 63.63
2024-09-07 14:57:32,789 [trainer.py] => Average Accuracy (CNN): 63.63 

2024-09-07 14:57:32,791 [trainer.py] => All params: 85944577
2024-09-07 14:57:32,792 [trainer.py] => Trainable params: 85944577
2024-09-07 14:57:32,794 [simplecil.py] => Learning on 190-200
2024-09-07 14:57:55,335 [trainer.py] => No NME accuracy.
2024-09-07 14:57:55,336 [trainer.py] => CNN: {'total': 61.35, '00-99': 61.04, '100-109': 63.73, '110-119': 59.04, '120-129': 57.93, '130-139': 68.46, '140-149': 59.67, '150-159': 64.92, '160-169': 49.13, '170-179': 72.18, '180-189': 56.49, '190-199': 64.58, 'old': 61.2, 'new': 64.58}
2024-09-07 14:57:55,336 [trainer.py] => CNN top1 curve: [65.83, 65.25, 64.36, 63.82, 64.1, 63.57, 63.22, 62.15, 62.42, 61.63, 61.35]
2024-09-07 14:57:55,336 [trainer.py] => CNN top5 curve: [82.41, 81.95, 80.82, 80.06, 79.97, 79.66, 78.96, 77.92, 77.9, 77.13, 76.78]

Average Accuracy (CNN): 63.43
2024-09-07 14:57:55,336 [trainer.py] => Average Accuracy (CNN): 63.43 

Accuracy Matrix (CNN):
[[65.83 64.92 64.39 63.89 63.72 63.35 62.75 62.11 61.84 61.31 61.04]
 [ 0.   68.66 68.31 67.96 67.25 66.9  66.2  64.79 64.79 64.44 63.73]
 [ 0.    0.   61.17 61.17 61.17 60.11 59.57 59.31 59.31 59.04 59.04]
 [ 0.    0.    0.   62.36 61.62 61.25 60.52 59.41 58.67 58.67 57.93]
 [ 0.    0.    0.    0.   70.81 70.81 70.13 70.13 70.13 69.13 68.46]
 [ 0.    0.    0.    0.    0.   62.13 61.31 60.76 60.49 60.22 59.67]
 [ 0.    0.    0.    0.    0.    0.   66.85 66.02 66.02 65.47 64.92]
 [ 0.    0.    0.    0.    0.    0.    0.   53.04 52.17 52.17 49.13]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   73.39 72.18 72.18]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   56.49 56.49]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   64.58]]
2024-09-07 14:57:55,337 [trainer.py] => Forgetting (CNN): 2.813999999999999
2024-09-07 14:57:58,179 [trainer.py] => config: ./exps/l2p_inr_B0_Inc5.json
2024-09-07 14:57:58,196 [trainer.py] => prefix:  
2024-09-07 14:57:58,196 [trainer.py] => dataset: imagenetr
2024-09-07 14:57:58,196 [trainer.py] => memory_size: 0
2024-09-07 14:57:58,196 [trainer.py] => memory_per_class: 0
2024-09-07 14:57:58,196 [trainer.py] => fixed_memory: False
2024-09-07 14:57:58,196 [trainer.py] => shuffle: True
2024-09-07 14:57:58,196 [trainer.py] => init_cls: 40
2024-09-07 14:57:58,196 [trainer.py] => increment: 40
2024-09-07 14:57:58,196 [trainer.py] => model_name: l2p
2024-09-07 14:57:58,196 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 14:57:58,196 [trainer.py] => get_original_backbone: True
2024-09-07 14:57:58,196 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 14:57:58,196 [trainer.py] => seed: 1993
2024-09-07 14:57:58,196 [trainer.py] => tuned_epoch: 20
2024-09-07 14:57:58,196 [trainer.py] => init_lr: 0.001875
2024-09-07 14:57:58,196 [trainer.py] => batch_size: 48
2024-09-07 14:57:58,196 [trainer.py] => weight_decay: 0
2024-09-07 14:57:58,196 [trainer.py] => min_lr: 1e-05
2024-09-07 14:57:58,196 [trainer.py] => optimizer: adam
2024-09-07 14:57:58,196 [trainer.py] => scheduler: constant
2024-09-07 14:57:58,196 [trainer.py] => reinit_optimizer: True
2024-09-07 14:57:58,196 [trainer.py] => global_pool: token
2024-09-07 14:57:58,196 [trainer.py] => head_type: prompt
2024-09-07 14:57:58,196 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 14:57:58,196 [trainer.py] => pretrained: True
2024-09-07 14:57:58,196 [trainer.py] => drop: 0.0
2024-09-07 14:57:58,196 [trainer.py] => drop_path: 0.0
2024-09-07 14:57:58,197 [trainer.py] => prompt_pool: True
2024-09-07 14:57:58,197 [trainer.py] => size: 10
2024-09-07 14:57:58,197 [trainer.py] => length: 5
2024-09-07 14:57:58,197 [trainer.py] => top_k: 5
2024-09-07 14:57:58,197 [trainer.py] => initializer: uniform
2024-09-07 14:57:58,197 [trainer.py] => prompt_key: True
2024-09-07 14:57:58,197 [trainer.py] => prompt_key_init: uniform
2024-09-07 14:57:58,197 [trainer.py] => use_prompt_mask: False
2024-09-07 14:57:58,197 [trainer.py] => shared_prompt_pool: False
2024-09-07 14:57:58,197 [trainer.py] => shared_prompt_key: False
2024-09-07 14:57:58,197 [trainer.py] => batchwise_prompt: True
2024-09-07 14:57:58,197 [trainer.py] => embedding_key: cls
2024-09-07 14:57:58,197 [trainer.py] => predefined_key: 
2024-09-07 14:57:58,197 [trainer.py] => pull_constraint: True
2024-09-07 14:57:58,197 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 14:57:58,284 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 14:57:59,781 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 14:57:59,781 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 14:58:01,729 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 14:58:01,730 [l2p.py] => 199,880 model training parameters.
2024-09-07 14:58:01,730 [l2p.py] => prompt.prompt: 38400
2024-09-07 14:58:01,730 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 14:58:01,730 [l2p.py] => head.weight: 153600
2024-09-07 14:58:01,730 [l2p.py] => head.bias: 200
2024-09-07 14:58:01,731 [trainer.py] => All params: 171970192
2024-09-07 14:58:01,732 [trainer.py] => Trainable params: 199880
2024-09-07 14:58:01,732 [l2p.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.948, Train_accy 52.03:   0%|          | 0/20 [00:49<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.948, Train_accy 52.03:   5%|▌         | 1/20 [00:49<15:37, 49.32s/it]
Task 0, Epoch 2/20 => Loss 1.028, Train_accy 71.15:   5%|▌         | 1/20 [01:38<15:37, 49.32s/it]
Task 0, Epoch 2/20 => Loss 1.028, Train_accy 71.15:  10%|█         | 2/20 [01:38<14:47, 49.28s/it]
Task 0, Epoch 3/20 => Loss 0.840, Train_accy 74.64:  10%|█         | 2/20 [02:27<14:47, 49.28s/it]
Task 0, Epoch 3/20 => Loss 0.840, Train_accy 74.64:  15%|█▌        | 3/20 [02:27<13:57, 49.27s/it]
Task 0, Epoch 4/20 => Loss 0.689, Train_accy 78.53:  15%|█▌        | 3/20 [03:17<13:57, 49.27s/it]
Task 0, Epoch 4/20 => Loss 0.689, Train_accy 78.53:  20%|██        | 4/20 [03:17<13:07, 49.24s/it]
Task 0, Epoch 5/20 => Loss 0.582, Train_accy 80.62, Test_accy 80.47:  20%|██        | 4/20 [04:14<13:07, 49.24s/it]
Task 0, Epoch 5/20 => Loss 0.582, Train_accy 80.62, Test_accy 80.47:  25%|██▌       | 5/20 [04:14<13:03, 52.22s/it]
Task 0, Epoch 6/20 => Loss 0.500, Train_accy 81.77:  25%|██▌       | 5/20 [05:03<13:03, 52.22s/it]                 
Task 0, Epoch 6/20 => Loss 0.500, Train_accy 81.77:  30%|███       | 6/20 [05:03<11:57, 51.22s/it]
Task 0, Epoch 7/20 => Loss 0.477, Train_accy 82.39:  30%|███       | 6/20 [05:53<11:57, 51.22s/it]
Task 0, Epoch 7/20 => Loss 0.477, Train_accy 82.39:  35%|███▌      | 7/20 [05:53<10:59, 50.71s/it]
Task 0, Epoch 8/20 => Loss 0.430, Train_accy 83.54:  35%|███▌      | 7/20 [06:42<10:59, 50.71s/it]
Task 0, Epoch 8/20 => Loss 0.430, Train_accy 83.54:  40%|████      | 8/20 [06:42<10:02, 50.22s/it]
Task 0, Epoch 9/20 => Loss 0.419, Train_accy 83.84:  40%|████      | 8/20 [07:31<10:02, 50.22s/it]
Task 0, Epoch 9/20 => Loss 0.419, Train_accy 83.84:  45%|████▌     | 9/20 [07:31<09:08, 49.88s/it]
Task 0, Epoch 10/20 => Loss 0.385, Train_accy 85.07, Test_accy 82.89:  45%|████▌     | 9/20 [08:29<09:08, 49.88s/it]
Task 0, Epoch 10/20 => Loss 0.385, Train_accy 85.07, Test_accy 82.89:  50%|█████     | 10/20 [08:29<08:42, 52.23s/it]
Task 0, Epoch 11/20 => Loss 0.390, Train_accy 84.81:  50%|█████     | 10/20 [09:18<08:42, 52.23s/it]                 
Task 0, Epoch 11/20 => Loss 0.390, Train_accy 84.81:  55%|█████▌    | 11/20 [09:18<07:42, 51.34s/it]
Task 0, Epoch 12/20 => Loss 0.330, Train_accy 86.28:  55%|█████▌    | 11/20 [10:07<07:42, 51.34s/it]
Task 0, Epoch 12/20 => Loss 0.330, Train_accy 86.28:  60%|██████    | 12/20 [10:07<06:45, 50.69s/it]
Task 0, Epoch 13/20 => Loss 0.283, Train_accy 87.05:  60%|██████    | 12/20 [10:56<06:45, 50.69s/it]
Task 0, Epoch 13/20 => Loss 0.283, Train_accy 87.05:  65%|██████▌   | 13/20 [10:56<05:51, 50.22s/it]
Task 0, Epoch 14/20 => Loss 0.305, Train_accy 86.66:  65%|██████▌   | 13/20 [11:46<05:51, 50.22s/it]
Task 0, Epoch 14/20 => Loss 0.305, Train_accy 86.66:  70%|███████   | 14/20 [11:46<04:59, 49.90s/it]
Task 0, Epoch 15/20 => Loss 0.289, Train_accy 87.31, Test_accy 82.89:  70%|███████   | 14/20 [12:43<04:59, 49.90s/it]
Task 0, Epoch 15/20 => Loss 0.289, Train_accy 87.31, Test_accy 82.89:  75%|███████▌  | 15/20 [12:43<04:20, 52.16s/it]
Task 0, Epoch 16/20 => Loss 0.290, Train_accy 87.01:  75%|███████▌  | 15/20 [13:32<04:20, 52.16s/it]                 
Task 0, Epoch 16/20 => Loss 0.290, Train_accy 87.01:  80%|████████  | 16/20 [13:32<03:25, 51.28s/it]
Task 0, Epoch 17/20 => Loss 0.265, Train_accy 87.83:  80%|████████  | 16/20 [14:21<03:25, 51.28s/it]
Task 0, Epoch 17/20 => Loss 0.265, Train_accy 87.83:  85%|████████▌ | 17/20 [14:21<02:31, 50.64s/it]
Task 0, Epoch 18/20 => Loss 0.222, Train_accy 89.02:  85%|████████▌ | 17/20 [15:11<02:31, 50.64s/it]
Task 0, Epoch 18/20 => Loss 0.222, Train_accy 89.02:  90%|█████████ | 18/20 [15:11<01:40, 50.19s/it]
Task 0, Epoch 19/20 => Loss 0.274, Train_accy 88.11:  90%|█████████ | 18/20 [16:00<01:40, 50.19s/it]
Task 0, Epoch 19/20 => Loss 0.274, Train_accy 88.11:  95%|█████████▌| 19/20 [16:00<00:49, 49.91s/it]
Task 0, Epoch 20/20 => Loss 0.278, Train_accy 87.40, Test_accy 82.66:  95%|█████████▌| 19/20 [16:57<00:49, 49.91s/it]
Task 0, Epoch 20/20 => Loss 0.278, Train_accy 87.40, Test_accy 82.66: 100%|██████████| 20/20 [16:57<00:00, 52.19s/it]
Task 0, Epoch 20/20 => Loss 0.278, Train_accy 87.40, Test_accy 82.66: 100%|██████████| 20/20 [16:57<00:00, 50.89s/it]
2024-09-07 15:15:00,071 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.278, Train_accy 87.40, Test_accy 82.66
2024-09-07 15:15:08,362 [trainer.py] => No NME accuracy.
2024-09-07 15:15:08,363 [trainer.py] => CNN: {'total': 82.66, '00-39': 82.66, 'old': 0, 'new': 82.66}
2024-09-07 15:15:08,363 [trainer.py] => CNN top1 curve: [82.66]
2024-09-07 15:15:08,363 [trainer.py] => CNN top5 curve: [94.4]

Average Accuracy (CNN): 82.66
2024-09-07 15:15:08,363 [trainer.py] => Average Accuracy (CNN): 82.66 

2024-09-07 15:15:08,366 [trainer.py] => All params: 171970192
2024-09-07 15:15:08,368 [trainer.py] => Trainable params: 199880
2024-09-07 15:15:08,368 [l2p.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.358, Train_accy 61.41:   0%|          | 0/20 [00:42<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.358, Train_accy 61.41:   5%|▌         | 1/20 [00:42<13:28, 42.53s/it]
Task 1, Epoch 2/20 => Loss 0.683, Train_accy 76.73:   5%|▌         | 1/20 [01:25<13:28, 42.53s/it]
Task 1, Epoch 2/20 => Loss 0.683, Train_accy 76.73:  10%|█         | 2/20 [01:25<12:46, 42.56s/it]
Task 1, Epoch 3/20 => Loss 0.555, Train_accy 80.35:  10%|█         | 2/20 [02:07<12:46, 42.56s/it]
Task 1, Epoch 3/20 => Loss 0.555, Train_accy 80.35:  15%|█▌        | 3/20 [02:07<12:03, 42.56s/it]
Task 1, Epoch 4/20 => Loss 0.473, Train_accy 82.57:  15%|█▌        | 3/20 [02:50<12:03, 42.56s/it]
Task 1, Epoch 4/20 => Loss 0.473, Train_accy 82.57:  20%|██        | 4/20 [02:50<11:21, 42.57s/it]
Task 1, Epoch 5/20 => Loss 0.451, Train_accy 83.11, Test_accy 74.54:  20%|██        | 4/20 [03:48<11:21, 42.57s/it]
Task 1, Epoch 5/20 => Loss 0.451, Train_accy 83.11, Test_accy 74.54:  25%|██▌       | 5/20 [03:48<12:00, 48.04s/it]
Task 1, Epoch 6/20 => Loss 0.380, Train_accy 84.60:  25%|██▌       | 5/20 [04:30<12:00, 48.04s/it]                 
Task 1, Epoch 6/20 => Loss 0.380, Train_accy 84.60:  30%|███       | 6/20 [04:30<10:46, 46.16s/it]
Task 1, Epoch 7/20 => Loss 0.342, Train_accy 85.48:  30%|███       | 6/20 [05:12<10:46, 46.16s/it]
Task 1, Epoch 7/20 => Loss 0.342, Train_accy 85.48:  35%|███▌      | 7/20 [05:12<09:44, 44.96s/it]
Task 1, Epoch 8/20 => Loss 0.335, Train_accy 85.53:  35%|███▌      | 7/20 [05:55<09:44, 44.96s/it]
Task 1, Epoch 8/20 => Loss 0.335, Train_accy 85.53:  40%|████      | 8/20 [05:55<08:51, 44.27s/it]
Task 1, Epoch 9/20 => Loss 0.352, Train_accy 85.27:  40%|████      | 8/20 [06:38<08:51, 44.27s/it]
Task 1, Epoch 9/20 => Loss 0.352, Train_accy 85.27:  45%|████▌     | 9/20 [06:38<08:02, 43.83s/it]
Task 1, Epoch 10/20 => Loss 0.301, Train_accy 86.71, Test_accy 77.02:  45%|████▌     | 9/20 [07:36<08:02, 43.83s/it]
Task 1, Epoch 10/20 => Loss 0.301, Train_accy 86.71, Test_accy 77.02:  50%|█████     | 10/20 [07:36<08:01, 48.10s/it]
Task 1, Epoch 11/20 => Loss 0.307, Train_accy 86.65:  50%|█████     | 10/20 [08:18<08:01, 48.10s/it]                 
Task 1, Epoch 11/20 => Loss 0.307, Train_accy 86.65:  55%|█████▌    | 11/20 [08:18<06:57, 46.39s/it]
Task 1, Epoch 12/20 => Loss 0.251, Train_accy 88.42:  55%|█████▌    | 11/20 [09:01<06:57, 46.39s/it]
Task 1, Epoch 12/20 => Loss 0.251, Train_accy 88.42:  60%|██████    | 12/20 [09:01<06:01, 45.23s/it]
Task 1, Epoch 13/20 => Loss 0.237, Train_accy 88.07:  60%|██████    | 12/20 [09:43<06:01, 45.23s/it]
Task 1, Epoch 13/20 => Loss 0.237, Train_accy 88.07:  65%|██████▌   | 13/20 [09:43<05:10, 44.41s/it]
Task 1, Epoch 14/20 => Loss 0.255, Train_accy 88.63:  65%|██████▌   | 13/20 [10:26<05:10, 44.41s/it]
Task 1, Epoch 14/20 => Loss 0.255, Train_accy 88.63:  70%|███████   | 14/20 [10:26<04:23, 43.89s/it]
Task 1, Epoch 15/20 => Loss 0.261, Train_accy 87.83, Test_accy 78.74:  70%|███████   | 14/20 [11:24<04:23, 43.89s/it]
Task 1, Epoch 15/20 => Loss 0.261, Train_accy 87.83, Test_accy 78.74:  75%|███████▌  | 15/20 [11:24<04:00, 48.14s/it]
Task 1, Epoch 16/20 => Loss 0.250, Train_accy 88.55:  75%|███████▌  | 15/20 [12:07<04:00, 48.14s/it]                 
Task 1, Epoch 16/20 => Loss 0.250, Train_accy 88.55:  80%|████████  | 16/20 [12:07<03:06, 46.51s/it]
Task 1, Epoch 17/20 => Loss 0.217, Train_accy 89.19:  80%|████████  | 16/20 [12:50<03:06, 46.51s/it]
Task 1, Epoch 17/20 => Loss 0.217, Train_accy 89.19:  85%|████████▌ | 17/20 [12:50<02:16, 45.38s/it]
Task 1, Epoch 18/20 => Loss 0.250, Train_accy 88.72:  85%|████████▌ | 17/20 [13:32<02:16, 45.38s/it]
Task 1, Epoch 18/20 => Loss 0.250, Train_accy 88.72:  90%|█████████ | 18/20 [13:32<01:29, 44.53s/it]
Task 1, Epoch 19/20 => Loss 0.241, Train_accy 88.27:  90%|█████████ | 18/20 [14:15<01:29, 44.53s/it]
Task 1, Epoch 19/20 => Loss 0.241, Train_accy 88.27:  95%|█████████▌| 19/20 [14:15<00:43, 43.93s/it]
Task 1, Epoch 20/20 => Loss 0.219, Train_accy 88.87, Test_accy 78.98:  95%|█████████▌| 19/20 [15:12<00:43, 43.93s/it]
Task 1, Epoch 20/20 => Loss 0.219, Train_accy 88.87, Test_accy 78.98: 100%|██████████| 20/20 [15:12<00:00, 48.07s/it]
Task 1, Epoch 20/20 => Loss 0.219, Train_accy 88.87, Test_accy 78.98: 100%|██████████| 20/20 [15:12<00:00, 45.64s/it]
2024-09-07 15:30:21,277 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.219, Train_accy 88.87, Test_accy 78.98
2024-09-07 15:30:36,584 [trainer.py] => No NME accuracy.
2024-09-07 15:30:36,585 [trainer.py] => CNN: {'total': 78.98, '00-39': 81.45, '40-79': 76.21, 'old': 81.45, 'new': 76.21}
2024-09-07 15:30:36,585 [trainer.py] => CNN top1 curve: [82.66, 78.98]
2024-09-07 15:30:36,585 [trainer.py] => CNN top5 curve: [94.4, 91.95]

Average Accuracy (CNN): 80.82
2024-09-07 15:30:36,585 [trainer.py] => Average Accuracy (CNN): 80.82 

2024-09-07 15:30:36,589 [trainer.py] => All params: 171970192
2024-09-07 15:30:36,591 [trainer.py] => Trainable params: 199880
2024-09-07 15:30:36,592 [l2p.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.194, Train_accy 65.02:   0%|          | 0/20 [00:44<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.194, Train_accy 65.02:   5%|▌         | 1/20 [00:44<14:09, 44.71s/it]
Task 2, Epoch 2/20 => Loss 0.574, Train_accy 79.42:   5%|▌         | 1/20 [01:29<14:09, 44.71s/it]
Task 2, Epoch 2/20 => Loss 0.574, Train_accy 79.42:  10%|█         | 2/20 [01:29<13:23, 44.66s/it]
Task 2, Epoch 3/20 => Loss 0.480, Train_accy 81.14:  10%|█         | 2/20 [02:13<13:23, 44.66s/it]
Task 2, Epoch 3/20 => Loss 0.480, Train_accy 81.14:  15%|█▌        | 3/20 [02:13<12:37, 44.55s/it]
Task 2, Epoch 4/20 => Loss 0.398, Train_accy 83.99:  15%|█▌        | 3/20 [02:58<12:37, 44.55s/it]
Task 2, Epoch 4/20 => Loss 0.398, Train_accy 83.99:  20%|██        | 4/20 [02:58<11:52, 44.50s/it]
Task 2, Epoch 5/20 => Loss 0.360, Train_accy 85.50, Test_accy 71.77:  20%|██        | 4/20 [04:04<11:52, 44.50s/it]
Task 2, Epoch 5/20 => Loss 0.360, Train_accy 85.50, Test_accy 71.77:  25%|██▌       | 5/20 [04:04<13:07, 52.50s/it]
Task 2, Epoch 6/20 => Loss 0.332, Train_accy 85.89:  25%|██▌       | 5/20 [04:49<13:07, 52.50s/it]                 
Task 2, Epoch 6/20 => Loss 0.332, Train_accy 85.89:  30%|███       | 6/20 [04:49<11:37, 49.79s/it]
Task 2, Epoch 7/20 => Loss 0.314, Train_accy 86.69:  30%|███       | 6/20 [05:33<11:37, 49.79s/it]
Task 2, Epoch 7/20 => Loss 0.314, Train_accy 86.69:  35%|███▌      | 7/20 [05:33<10:24, 48.07s/it]
Task 2, Epoch 8/20 => Loss 0.300, Train_accy 86.61:  35%|███▌      | 7/20 [06:18<10:24, 48.07s/it]
Task 2, Epoch 8/20 => Loss 0.300, Train_accy 86.61:  40%|████      | 8/20 [06:18<09:22, 46.89s/it]
Task 2, Epoch 9/20 => Loss 0.283, Train_accy 86.84:  40%|████      | 8/20 [07:02<09:22, 46.89s/it]
Task 2, Epoch 9/20 => Loss 0.283, Train_accy 86.84:  45%|████▌     | 9/20 [07:02<08:27, 46.14s/it]
Task 2, Epoch 10/20 => Loss 0.241, Train_accy 88.35, Test_accy 74.13:  45%|████▌     | 9/20 [08:09<08:27, 46.14s/it]
Task 2, Epoch 10/20 => Loss 0.241, Train_accy 88.35, Test_accy 74.13:  50%|█████     | 10/20 [08:09<08:44, 52.43s/it]
Task 2, Epoch 11/20 => Loss 0.242, Train_accy 88.06:  50%|█████     | 10/20 [08:53<08:44, 52.43s/it]                 
Task 2, Epoch 11/20 => Loss 0.242, Train_accy 88.06:  55%|█████▌    | 11/20 [08:53<07:30, 50.00s/it]
Task 2, Epoch 12/20 => Loss 0.250, Train_accy 88.41:  55%|█████▌    | 11/20 [09:38<07:30, 50.00s/it]
Task 2, Epoch 12/20 => Loss 0.250, Train_accy 88.41:  60%|██████    | 12/20 [09:38<06:26, 48.31s/it]
Task 2, Epoch 13/20 => Loss 0.245, Train_accy 87.85:  60%|██████    | 12/20 [10:22<06:26, 48.31s/it]
Task 2, Epoch 13/20 => Loss 0.245, Train_accy 87.85:  65%|██████▌   | 13/20 [10:22<05:30, 47.15s/it]
Task 2, Epoch 14/20 => Loss 0.201, Train_accy 88.99:  65%|██████▌   | 13/20 [11:07<05:30, 47.15s/it]
Task 2, Epoch 14/20 => Loss 0.201, Train_accy 88.99:  70%|███████   | 14/20 [11:07<04:37, 46.33s/it]
Task 2, Epoch 15/20 => Loss 0.203, Train_accy 89.46, Test_accy 75.56:  70%|███████   | 14/20 [12:13<04:37, 46.33s/it]
Task 2, Epoch 15/20 => Loss 0.203, Train_accy 89.46, Test_accy 75.56:  75%|███████▌  | 15/20 [12:13<04:22, 52.45s/it]
Task 2, Epoch 16/20 => Loss 0.209, Train_accy 88.88:  75%|███████▌  | 15/20 [12:58<04:22, 52.45s/it]                 
Task 2, Epoch 16/20 => Loss 0.209, Train_accy 88.88:  80%|████████  | 16/20 [12:58<03:20, 50.13s/it]
Task 2, Epoch 17/20 => Loss 0.201, Train_accy 89.38:  80%|████████  | 16/20 [13:43<03:20, 50.13s/it]
Task 2, Epoch 17/20 => Loss 0.201, Train_accy 89.38:  85%|████████▌ | 17/20 [13:43<02:25, 48.50s/it]
Task 2, Epoch 18/20 => Loss 0.204, Train_accy 89.61:  85%|████████▌ | 17/20 [14:27<02:25, 48.50s/it]
Task 2, Epoch 18/20 => Loss 0.204, Train_accy 89.61:  90%|█████████ | 18/20 [14:27<01:34, 47.32s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 89.75:  90%|█████████ | 18/20 [15:12<01:34, 47.32s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 89.75:  95%|█████████▌| 19/20 [15:12<00:46, 46.53s/it]
Task 2, Epoch 20/20 => Loss 0.205, Train_accy 89.26, Test_accy 75.78:  95%|█████████▌| 19/20 [16:19<00:46, 46.53s/it]
Task 2, Epoch 20/20 => Loss 0.205, Train_accy 89.26, Test_accy 75.78: 100%|██████████| 20/20 [16:19<00:00, 52.54s/it]
Task 2, Epoch 20/20 => Loss 0.205, Train_accy 89.26, Test_accy 75.78: 100%|██████████| 20/20 [16:19<00:00, 48.95s/it]
2024-09-07 15:46:55,652 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.205, Train_accy 89.26, Test_accy 75.78
2024-09-07 15:47:17,481 [trainer.py] => No NME accuracy.
2024-09-07 15:47:17,482 [trainer.py] => CNN: {'total': 75.78, '00-39': 80.62, '40-79': 73.75, '80-119': 72.28, 'old': 77.38, 'new': 72.28}
2024-09-07 15:47:17,482 [trainer.py] => CNN top1 curve: [82.66, 78.98, 75.78]
2024-09-07 15:47:17,482 [trainer.py] => CNN top5 curve: [94.4, 91.95, 90.37]

Average Accuracy (CNN): 79.14
2024-09-07 15:47:17,482 [trainer.py] => Average Accuracy (CNN): 79.14 

2024-09-07 15:47:17,484 [trainer.py] => All params: 171970192
2024-09-07 15:47:17,486 [trainer.py] => Trainable params: 199880
2024-09-07 15:47:17,486 [l2p.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.085, Train_accy 67.83:   0%|          | 0/20 [00:45<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.085, Train_accy 67.83:   5%|▌         | 1/20 [00:45<14:19, 45.23s/it]
Task 3, Epoch 2/20 => Loss 0.516, Train_accy 80.87:   5%|▌         | 1/20 [01:30<14:19, 45.23s/it]
Task 3, Epoch 2/20 => Loss 0.516, Train_accy 80.87:  10%|█         | 2/20 [01:30<13:36, 45.37s/it]
Task 3, Epoch 3/20 => Loss 0.384, Train_accy 84.51:  10%|█         | 2/20 [02:16<13:36, 45.37s/it]
Task 3, Epoch 3/20 => Loss 0.384, Train_accy 84.51:  15%|█▌        | 3/20 [02:16<12:52, 45.47s/it]
Task 3, Epoch 4/20 => Loss 0.346, Train_accy 85.59:  15%|█▌        | 3/20 [03:01<12:52, 45.47s/it]
Task 3, Epoch 4/20 => Loss 0.346, Train_accy 85.59:  20%|██        | 4/20 [03:01<12:07, 45.49s/it]
Task 3, Epoch 5/20 => Loss 0.268, Train_accy 87.77, Test_accy 71.37:  20%|██        | 4/20 [04:17<12:07, 45.49s/it]
Task 3, Epoch 5/20 => Loss 0.268, Train_accy 87.77, Test_accy 71.37:  25%|██▌       | 5/20 [04:17<14:03, 56.26s/it]
Task 3, Epoch 6/20 => Loss 0.274, Train_accy 87.91:  25%|██▌       | 5/20 [05:02<14:03, 56.26s/it]                 
Task 3, Epoch 6/20 => Loss 0.274, Train_accy 87.91:  30%|███       | 6/20 [05:02<12:17, 52.68s/it]
Task 3, Epoch 7/20 => Loss 0.269, Train_accy 87.96:  30%|███       | 6/20 [05:48<12:17, 52.68s/it]
Task 3, Epoch 7/20 => Loss 0.269, Train_accy 87.96:  35%|███▌      | 7/20 [05:48<10:55, 50.41s/it]
Task 3, Epoch 8/20 => Loss 0.222, Train_accy 89.31:  35%|███▌      | 7/20 [06:34<10:55, 50.41s/it]
Task 3, Epoch 8/20 => Loss 0.222, Train_accy 89.31:  40%|████      | 8/20 [06:34<09:47, 48.94s/it]
Task 3, Epoch 9/20 => Loss 0.210, Train_accy 89.09:  40%|████      | 8/20 [07:20<09:47, 48.94s/it]
Task 3, Epoch 9/20 => Loss 0.210, Train_accy 89.09:  45%|████▌     | 9/20 [07:20<08:47, 47.91s/it]
Task 3, Epoch 10/20 => Loss 0.215, Train_accy 89.15, Test_accy 73.48:  45%|████▌     | 9/20 [08:35<08:47, 47.91s/it]
Task 3, Epoch 10/20 => Loss 0.215, Train_accy 89.15, Test_accy 73.48:  50%|█████     | 10/20 [08:35<09:23, 56.37s/it]
Task 3, Epoch 11/20 => Loss 0.203, Train_accy 89.68:  50%|█████     | 10/20 [09:20<09:23, 56.37s/it]                 
Task 3, Epoch 11/20 => Loss 0.203, Train_accy 89.68:  55%|█████▌    | 11/20 [09:20<07:56, 52.99s/it]
Task 3, Epoch 12/20 => Loss 0.184, Train_accy 90.22:  55%|█████▌    | 11/20 [10:05<07:56, 52.99s/it]
Task 3, Epoch 12/20 => Loss 0.184, Train_accy 90.22:  60%|██████    | 12/20 [10:05<06:45, 50.64s/it]
Task 3, Epoch 13/20 => Loss 0.177, Train_accy 90.26:  60%|██████    | 12/20 [10:51<06:45, 50.64s/it]
Task 3, Epoch 13/20 => Loss 0.177, Train_accy 90.26:  65%|██████▌   | 13/20 [10:51<05:43, 49.04s/it]
Task 3, Epoch 14/20 => Loss 0.163, Train_accy 90.38:  65%|██████▌   | 13/20 [11:36<05:43, 49.04s/it]
Task 3, Epoch 14/20 => Loss 0.163, Train_accy 90.38:  70%|███████   | 14/20 [11:36<04:47, 47.90s/it]
Task 3, Epoch 15/20 => Loss 0.184, Train_accy 89.84, Test_accy 74.63:  70%|███████   | 14/20 [12:51<04:47, 47.90s/it]
Task 3, Epoch 15/20 => Loss 0.184, Train_accy 89.84, Test_accy 74.63:  75%|███████▌  | 15/20 [12:51<04:39, 55.95s/it]
Task 3, Epoch 16/20 => Loss 0.156, Train_accy 90.34:  75%|███████▌  | 15/20 [13:36<04:39, 55.95s/it]                 
Task 3, Epoch 16/20 => Loss 0.156, Train_accy 90.34:  80%|████████  | 16/20 [13:36<03:30, 52.74s/it]
Task 3, Epoch 17/20 => Loss 0.138, Train_accy 91.13:  80%|████████  | 16/20 [14:21<03:30, 52.74s/it]
Task 3, Epoch 17/20 => Loss 0.138, Train_accy 91.13:  85%|████████▌ | 17/20 [14:21<02:31, 50.52s/it]
Task 3, Epoch 18/20 => Loss 0.173, Train_accy 90.63:  85%|████████▌ | 17/20 [15:07<02:31, 50.52s/it]
Task 3, Epoch 18/20 => Loss 0.173, Train_accy 90.63:  90%|█████████ | 18/20 [15:07<01:37, 48.97s/it]
Task 3, Epoch 19/20 => Loss 0.158, Train_accy 90.61:  90%|█████████ | 18/20 [15:52<01:37, 48.97s/it]
Task 3, Epoch 19/20 => Loss 0.158, Train_accy 90.61:  95%|█████████▌| 19/20 [15:52<00:47, 47.90s/it]
Task 3, Epoch 20/20 => Loss 0.121, Train_accy 91.30, Test_accy 74.77:  95%|█████████▌| 19/20 [17:07<00:47, 47.90s/it]
Task 3, Epoch 20/20 => Loss 0.121, Train_accy 91.30, Test_accy 74.77: 100%|██████████| 20/20 [17:07<00:00, 55.94s/it]
Task 3, Epoch 20/20 => Loss 0.121, Train_accy 91.30, Test_accy 74.77: 100%|██████████| 20/20 [17:07<00:00, 51.36s/it]
2024-09-07 16:04:24,787 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.121, Train_accy 91.30, Test_accy 74.77
2024-09-07 16:04:54,198 [trainer.py] => No NME accuracy.
2024-09-07 16:04:54,198 [trainer.py] => CNN: {'total': 74.77, '00-39': 77.82, '40-79': 73.49, '80-119': 71.84, '120-159': 75.42, 'old': 74.54, 'new': 75.42}
2024-09-07 16:04:54,198 [trainer.py] => CNN top1 curve: [82.66, 78.98, 75.78, 74.77]
2024-09-07 16:04:54,199 [trainer.py] => CNN top5 curve: [94.4, 91.95, 90.37, 89.4]

Average Accuracy (CNN): 78.05
2024-09-07 16:04:54,199 [trainer.py] => Average Accuracy (CNN): 78.05 

2024-09-07 16:04:54,201 [trainer.py] => All params: 171970192
2024-09-07 16:04:54,202 [trainer.py] => Trainable params: 199880
2024-09-07 16:04:54,203 [l2p.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.200, Train_accy 65.05:   0%|          | 0/20 [00:38<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.200, Train_accy 65.05:   5%|▌         | 1/20 [00:38<12:15, 38.71s/it]
Task 4, Epoch 2/20 => Loss 0.553, Train_accy 79.68:   5%|▌         | 1/20 [01:17<12:15, 38.71s/it]
Task 4, Epoch 2/20 => Loss 0.553, Train_accy 79.68:  10%|█         | 2/20 [01:17<11:37, 38.72s/it]
Task 4, Epoch 3/20 => Loss 0.444, Train_accy 82.88:  10%|█         | 2/20 [01:56<11:37, 38.72s/it]
Task 4, Epoch 3/20 => Loss 0.444, Train_accy 82.88:  15%|█▌        | 3/20 [01:56<10:59, 38.77s/it]
Task 4, Epoch 4/20 => Loss 0.363, Train_accy 84.99:  15%|█▌        | 3/20 [02:34<10:59, 38.77s/it]
Task 4, Epoch 4/20 => Loss 0.363, Train_accy 84.99:  20%|██        | 4/20 [02:34<10:19, 38.73s/it]
Task 4, Epoch 5/20 => Loss 0.330, Train_accy 85.80, Test_accy 70.23:  20%|██        | 4/20 [03:49<10:19, 38.73s/it]
Task 4, Epoch 5/20 => Loss 0.330, Train_accy 85.80, Test_accy 70.23:  25%|██▌       | 5/20 [03:49<12:56, 51.73s/it]
Task 4, Epoch 6/20 => Loss 0.271, Train_accy 87.62:  25%|██▌       | 5/20 [04:28<12:56, 51.73s/it]                 
Task 4, Epoch 6/20 => Loss 0.271, Train_accy 87.62:  30%|███       | 6/20 [04:28<11:02, 47.34s/it]
Task 4, Epoch 7/20 => Loss 0.278, Train_accy 87.55:  30%|███       | 6/20 [05:07<11:02, 47.34s/it]
Task 4, Epoch 7/20 => Loss 0.278, Train_accy 87.55:  35%|███▌      | 7/20 [05:07<09:38, 44.51s/it]
Task 4, Epoch 8/20 => Loss 0.274, Train_accy 87.51:  35%|███▌      | 7/20 [05:45<09:38, 44.51s/it]
Task 4, Epoch 8/20 => Loss 0.274, Train_accy 87.51:  40%|████      | 8/20 [05:45<08:31, 42.66s/it]
Task 4, Epoch 9/20 => Loss 0.234, Train_accy 88.93:  40%|████      | 8/20 [06:24<08:31, 42.66s/it]
Task 4, Epoch 9/20 => Loss 0.234, Train_accy 88.93:  45%|████▌     | 9/20 [06:24<07:35, 41.43s/it]
Task 4, Epoch 10/20 => Loss 0.199, Train_accy 89.00, Test_accy 71.23:  45%|████▌     | 9/20 [07:39<07:35, 41.43s/it]
Task 4, Epoch 10/20 => Loss 0.199, Train_accy 89.00, Test_accy 71.23:  50%|█████     | 10/20 [07:39<08:36, 51.67s/it]
Task 4, Epoch 11/20 => Loss 0.215, Train_accy 88.93:  50%|█████     | 10/20 [08:18<08:36, 51.67s/it]                 
Task 4, Epoch 11/20 => Loss 0.215, Train_accy 88.93:  55%|█████▌    | 11/20 [08:18<07:09, 47.73s/it]
Task 4, Epoch 12/20 => Loss 0.205, Train_accy 89.31:  55%|█████▌    | 11/20 [08:56<07:09, 47.73s/it]
Task 4, Epoch 12/20 => Loss 0.205, Train_accy 89.31:  60%|██████    | 12/20 [08:56<05:59, 45.00s/it]
Task 4, Epoch 13/20 => Loss 0.177, Train_accy 89.76:  60%|██████    | 12/20 [09:35<05:59, 45.00s/it]
Task 4, Epoch 13/20 => Loss 0.177, Train_accy 89.76:  65%|██████▌   | 13/20 [09:35<05:01, 43.11s/it]
Task 4, Epoch 14/20 => Loss 0.168, Train_accy 89.62:  65%|██████▌   | 13/20 [10:14<05:01, 43.11s/it]
Task 4, Epoch 14/20 => Loss 0.168, Train_accy 89.62:  70%|███████   | 14/20 [10:14<04:10, 41.78s/it]
Task 4, Epoch 15/20 => Loss 0.170, Train_accy 90.35, Test_accy 72.15:  70%|███████   | 14/20 [11:28<04:10, 41.78s/it]
Task 4, Epoch 15/20 => Loss 0.170, Train_accy 90.35, Test_accy 72.15:  75%|███████▌  | 15/20 [11:28<04:17, 51.58s/it]
Task 4, Epoch 16/20 => Loss 0.198, Train_accy 89.71:  75%|███████▌  | 15/20 [12:07<04:17, 51.58s/it]                 
Task 4, Epoch 16/20 => Loss 0.198, Train_accy 89.71:  80%|████████  | 16/20 [12:07<03:10, 47.75s/it]
Task 4, Epoch 17/20 => Loss 0.160, Train_accy 90.18:  80%|████████  | 16/20 [12:46<03:10, 47.75s/it]
Task 4, Epoch 17/20 => Loss 0.160, Train_accy 90.18:  85%|████████▌ | 17/20 [12:46<02:15, 45.08s/it]
Task 4, Epoch 18/20 => Loss 0.192, Train_accy 89.40:  85%|████████▌ | 17/20 [13:24<02:15, 45.08s/it]
Task 4, Epoch 18/20 => Loss 0.192, Train_accy 89.40:  90%|█████████ | 18/20 [13:24<01:26, 43.17s/it]
Task 4, Epoch 19/20 => Loss 0.114, Train_accy 91.51:  90%|█████████ | 18/20 [14:03<01:26, 43.17s/it]
Task 4, Epoch 19/20 => Loss 0.114, Train_accy 91.51:  95%|█████████▌| 19/20 [14:03<00:41, 41.84s/it]
Task 4, Epoch 20/20 => Loss 0.139, Train_accy 91.18, Test_accy 72.07:  95%|█████████▌| 19/20 [15:18<00:41, 41.84s/it]
Task 4, Epoch 20/20 => Loss 0.139, Train_accy 91.18, Test_accy 72.07: 100%|██████████| 20/20 [15:18<00:00, 51.60s/it]
Task 4, Epoch 20/20 => Loss 0.139, Train_accy 91.18, Test_accy 72.07: 100%|██████████| 20/20 [15:18<00:00, 45.90s/it]
2024-09-07 16:20:12,289 [l2p.py] => Task 4, Epoch 20/20 => Loss 0.139, Train_accy 91.18, Test_accy 72.07
2024-09-07 16:20:47,822 [trainer.py] => No NME accuracy.
2024-09-07 16:20:47,822 [trainer.py] => CNN: {'total': 72.07, '00-39': 75.4, '40-79': 71.37, '80-119': 70.01, '120-159': 75.12, '160-199': 67.17, 'old': 73.11, 'new': 67.17}
2024-09-07 16:20:47,822 [trainer.py] => CNN top1 curve: [82.66, 78.98, 75.78, 74.77, 72.07]
2024-09-07 16:20:47,822 [trainer.py] => CNN top5 curve: [94.4, 91.95, 90.37, 89.4, 87.95]

Average Accuracy (CNN): 76.85
2024-09-07 16:20:47,823 [trainer.py] => Average Accuracy (CNN): 76.85 

Accuracy Matrix (CNN):
[[82.66 81.45 80.62 77.82 75.4 ]
 [ 0.   76.21 73.75 73.49 71.37]
 [ 0.    0.   72.28 71.84 70.01]
 [ 0.    0.    0.   75.42 75.12]
 [ 0.    0.    0.    0.   67.17]]
2024-09-07 16:20:47,824 [trainer.py] => Forgetting (CNN): 3.6674999999999933
2024-09-07 16:20:50,568 [trainer.py] => config: ./exps/l2p_inr_B0_Inc10.json
2024-09-07 16:20:50,568 [trainer.py] => prefix:  
2024-09-07 16:20:50,568 [trainer.py] => dataset: imagenetr
2024-09-07 16:20:50,568 [trainer.py] => memory_size: 0
2024-09-07 16:20:50,568 [trainer.py] => memory_per_class: 0
2024-09-07 16:20:50,568 [trainer.py] => fixed_memory: False
2024-09-07 16:20:50,568 [trainer.py] => shuffle: True
2024-09-07 16:20:50,568 [trainer.py] => init_cls: 20
2024-09-07 16:20:50,568 [trainer.py] => increment: 20
2024-09-07 16:20:50,569 [trainer.py] => model_name: l2p
2024-09-07 16:20:50,569 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 16:20:50,569 [trainer.py] => get_original_backbone: True
2024-09-07 16:20:50,569 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 16:20:50,569 [trainer.py] => seed: 1993
2024-09-07 16:20:50,569 [trainer.py] => tuned_epoch: 20
2024-09-07 16:20:50,569 [trainer.py] => init_lr: 0.001875
2024-09-07 16:20:50,569 [trainer.py] => batch_size: 48
2024-09-07 16:20:50,569 [trainer.py] => weight_decay: 0
2024-09-07 16:20:50,569 [trainer.py] => min_lr: 1e-05
2024-09-07 16:20:50,569 [trainer.py] => optimizer: adam
2024-09-07 16:20:50,569 [trainer.py] => scheduler: constant
2024-09-07 16:20:50,569 [trainer.py] => reinit_optimizer: True
2024-09-07 16:20:50,569 [trainer.py] => global_pool: token
2024-09-07 16:20:50,569 [trainer.py] => head_type: prompt
2024-09-07 16:20:50,569 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 16:20:50,569 [trainer.py] => pretrained: True
2024-09-07 16:20:50,569 [trainer.py] => drop: 0.0
2024-09-07 16:20:50,569 [trainer.py] => drop_path: 0.0
2024-09-07 16:20:50,569 [trainer.py] => prompt_pool: True
2024-09-07 16:20:50,569 [trainer.py] => size: 10
2024-09-07 16:20:50,569 [trainer.py] => length: 5
2024-09-07 16:20:50,569 [trainer.py] => top_k: 5
2024-09-07 16:20:50,569 [trainer.py] => initializer: uniform
2024-09-07 16:20:50,569 [trainer.py] => prompt_key: True
2024-09-07 16:20:50,569 [trainer.py] => prompt_key_init: uniform
2024-09-07 16:20:50,569 [trainer.py] => use_prompt_mask: False
2024-09-07 16:20:50,569 [trainer.py] => shared_prompt_pool: False
2024-09-07 16:20:50,569 [trainer.py] => shared_prompt_key: False
2024-09-07 16:20:50,569 [trainer.py] => batchwise_prompt: True
2024-09-07 16:20:50,569 [trainer.py] => embedding_key: cls
2024-09-07 16:20:50,569 [trainer.py] => predefined_key: 
2024-09-07 16:20:50,569 [trainer.py] => pull_constraint: True
2024-09-07 16:20:50,569 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 16:20:50,651 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 16:20:52,062 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 16:20:52,062 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 16:20:53,791 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 16:20:53,792 [l2p.py] => 199,880 model training parameters.
2024-09-07 16:20:53,792 [l2p.py] => prompt.prompt: 38400
2024-09-07 16:20:53,792 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 16:20:53,792 [l2p.py] => head.weight: 153600
2024-09-07 16:20:53,792 [l2p.py] => head.bias: 200
2024-09-07 16:20:53,793 [trainer.py] => All params: 171970192
2024-09-07 16:20:53,794 [trainer.py] => Trainable params: 199880
2024-09-07 16:20:53,794 [l2p.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.715, Train_accy 50.82:   0%|          | 0/20 [00:26<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.715, Train_accy 50.82:   5%|▌         | 1/20 [00:26<08:19, 26.28s/it]
Task 0, Epoch 2/20 => Loss 0.858, Train_accy 74.39:   5%|▌         | 1/20 [00:52<08:19, 26.28s/it]
Task 0, Epoch 2/20 => Loss 0.858, Train_accy 74.39:  10%|█         | 2/20 [00:52<07:48, 26.03s/it]
Task 0, Epoch 3/20 => Loss 0.646, Train_accy 79.10:  10%|█         | 2/20 [01:17<07:48, 26.03s/it]
Task 0, Epoch 3/20 => Loss 0.646, Train_accy 79.10:  15%|█▌        | 3/20 [01:17<07:21, 25.95s/it]
Task 0, Epoch 4/20 => Loss 0.577, Train_accy 81.78:  15%|█▌        | 3/20 [01:43<07:21, 25.95s/it]
Task 0, Epoch 4/20 => Loss 0.577, Train_accy 81.78:  20%|██        | 4/20 [01:43<06:54, 25.92s/it]
Task 0, Epoch 5/20 => Loss 0.503, Train_accy 82.67, Test_accy 85.78:  20%|██        | 4/20 [02:14<06:54, 25.92s/it]
Task 0, Epoch 5/20 => Loss 0.503, Train_accy 82.67, Test_accy 85.78:  25%|██▌       | 5/20 [02:14<06:53, 27.57s/it]
Task 0, Epoch 6/20 => Loss 0.436, Train_accy 83.77:  25%|██▌       | 5/20 [02:40<06:53, 27.57s/it]                 
Task 0, Epoch 6/20 => Loss 0.436, Train_accy 83.77:  30%|███       | 6/20 [02:40<06:18, 27.02s/it]
Task 0, Epoch 7/20 => Loss 0.385, Train_accy 84.56:  30%|███       | 6/20 [03:06<06:18, 27.02s/it]
Task 0, Epoch 7/20 => Loss 0.385, Train_accy 84.56:  35%|███▌      | 7/20 [03:06<05:46, 26.68s/it]
Task 0, Epoch 8/20 => Loss 0.319, Train_accy 86.52:  35%|███▌      | 7/20 [03:32<05:46, 26.68s/it]
Task 0, Epoch 8/20 => Loss 0.319, Train_accy 86.52:  40%|████      | 8/20 [03:32<05:17, 26.44s/it]
Task 0, Epoch 9/20 => Loss 0.271, Train_accy 87.52:  40%|████      | 8/20 [03:58<05:17, 26.44s/it]
Task 0, Epoch 9/20 => Loss 0.271, Train_accy 87.52:  45%|████▌     | 9/20 [03:58<04:49, 26.29s/it]
Task 0, Epoch 10/20 => Loss 0.275, Train_accy 87.87, Test_accy 86.79:  45%|████▌     | 9/20 [04:28<04:49, 26.29s/it]
Task 0, Epoch 10/20 => Loss 0.275, Train_accy 87.87, Test_accy 86.79:  50%|█████     | 10/20 [04:28<04:36, 27.68s/it]
Task 0, Epoch 11/20 => Loss 0.255, Train_accy 88.16:  50%|█████     | 10/20 [04:54<04:36, 27.68s/it]                 
Task 0, Epoch 11/20 => Loss 0.255, Train_accy 88.16:  55%|█████▌    | 11/20 [04:54<04:04, 27.16s/it]
Task 0, Epoch 12/20 => Loss 0.252, Train_accy 87.62:  55%|█████▌    | 11/20 [05:21<04:04, 27.16s/it]
Task 0, Epoch 12/20 => Loss 0.252, Train_accy 87.62:  60%|██████    | 12/20 [05:21<03:34, 26.83s/it]
Task 0, Epoch 13/20 => Loss 0.186, Train_accy 89.66:  60%|██████    | 12/20 [05:46<03:34, 26.83s/it]
Task 0, Epoch 13/20 => Loss 0.186, Train_accy 89.66:  65%|██████▌   | 13/20 [05:46<03:05, 26.57s/it]
Task 0, Epoch 14/20 => Loss 0.202, Train_accy 89.19:  65%|██████▌   | 13/20 [06:12<03:05, 26.57s/it]
Task 0, Epoch 14/20 => Loss 0.202, Train_accy 89.19:  70%|███████   | 14/20 [06:12<02:38, 26.40s/it]
Task 0, Epoch 15/20 => Loss 0.175, Train_accy 90.01, Test_accy 86.65:  70%|███████   | 14/20 [06:43<02:38, 26.40s/it]
Task 0, Epoch 15/20 => Loss 0.175, Train_accy 90.01, Test_accy 86.65:  75%|███████▌  | 15/20 [06:43<02:18, 27.66s/it]
Task 0, Epoch 16/20 => Loss 0.161, Train_accy 89.91:  75%|███████▌  | 15/20 [07:09<02:18, 27.66s/it]                 
Task 0, Epoch 16/20 => Loss 0.161, Train_accy 89.91:  80%|████████  | 16/20 [07:09<01:48, 27.17s/it]
Task 0, Epoch 17/20 => Loss 0.160, Train_accy 90.16:  80%|████████  | 16/20 [07:35<01:48, 27.17s/it]
Task 0, Epoch 17/20 => Loss 0.160, Train_accy 90.16:  85%|████████▌ | 17/20 [07:35<01:20, 26.81s/it]
Task 0, Epoch 18/20 => Loss 0.133, Train_accy 90.51:  85%|████████▌ | 17/20 [08:01<01:20, 26.81s/it]
Task 0, Epoch 18/20 => Loss 0.133, Train_accy 90.51:  90%|█████████ | 18/20 [08:01<00:53, 26.58s/it]
Task 0, Epoch 19/20 => Loss 0.125, Train_accy 91.12:  90%|█████████ | 18/20 [08:27<00:53, 26.58s/it]
Task 0, Epoch 19/20 => Loss 0.125, Train_accy 91.12:  95%|█████████▌| 19/20 [08:27<00:26, 26.42s/it]
Task 0, Epoch 20/20 => Loss 0.166, Train_accy 90.41, Test_accy 87.23:  95%|█████████▌| 19/20 [08:58<00:26, 26.42s/it]
Task 0, Epoch 20/20 => Loss 0.166, Train_accy 90.41, Test_accy 87.23: 100%|██████████| 20/20 [08:58<00:00, 27.69s/it]
Task 0, Epoch 20/20 => Loss 0.166, Train_accy 90.41, Test_accy 87.23: 100%|██████████| 20/20 [08:58<00:00, 26.91s/it]
2024-09-07 16:29:52,665 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.166, Train_accy 90.41, Test_accy 87.23
2024-09-07 16:29:57,258 [trainer.py] => No NME accuracy.
2024-09-07 16:29:57,259 [trainer.py] => CNN: {'total': 87.23, '00-19': 87.23, 'old': 0, 'new': 87.23}
2024-09-07 16:29:57,259 [trainer.py] => CNN top1 curve: [87.23]
2024-09-07 16:29:57,259 [trainer.py] => CNN top5 curve: [96.66]

Average Accuracy (CNN): 87.23
2024-09-07 16:29:57,260 [trainer.py] => Average Accuracy (CNN): 87.23 

2024-09-07 16:29:57,263 [trainer.py] => All params: 171970192
2024-09-07 16:29:57,265 [trainer.py] => Trainable params: 199880
2024-09-07 16:29:57,265 [l2p.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.101, Train_accy 62.61:   0%|          | 0/20 [00:23<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.101, Train_accy 62.61:   5%|▌         | 1/20 [00:23<07:32, 23.83s/it]
Task 1, Epoch 2/20 => Loss 0.488, Train_accy 79.43:   5%|▌         | 1/20 [00:47<07:32, 23.83s/it]
Task 1, Epoch 2/20 => Loss 0.488, Train_accy 79.43:  10%|█         | 2/20 [00:47<07:09, 23.87s/it]
Task 1, Epoch 3/20 => Loss 0.367, Train_accy 83.76:  10%|█         | 2/20 [01:11<07:09, 23.87s/it]
Task 1, Epoch 3/20 => Loss 0.367, Train_accy 83.76:  15%|█▌        | 3/20 [01:11<06:45, 23.84s/it]
Task 1, Epoch 4/20 => Loss 0.300, Train_accy 84.70:  15%|█▌        | 3/20 [01:35<06:45, 23.84s/it]
Task 1, Epoch 4/20 => Loss 0.300, Train_accy 84.70:  20%|██        | 4/20 [01:35<06:20, 23.81s/it]
Task 1, Epoch 5/20 => Loss 0.253, Train_accy 86.73, Test_accy 79.49:  20%|██        | 4/20 [02:07<06:20, 23.81s/it]
Task 1, Epoch 5/20 => Loss 0.253, Train_accy 86.73, Test_accy 79.49:  25%|██▌       | 5/20 [02:07<06:41, 26.78s/it]
Task 1, Epoch 6/20 => Loss 0.260, Train_accy 86.81:  25%|██▌       | 5/20 [02:31<06:41, 26.78s/it]                 
Task 1, Epoch 6/20 => Loss 0.260, Train_accy 86.81:  30%|███       | 6/20 [02:31<06:00, 25.78s/it]
Task 1, Epoch 7/20 => Loss 0.209, Train_accy 88.29:  30%|███       | 6/20 [02:55<06:00, 25.78s/it]
Task 1, Epoch 7/20 => Loss 0.209, Train_accy 88.29:  35%|███▌      | 7/20 [02:55<05:26, 25.15s/it]
Task 1, Epoch 8/20 => Loss 0.207, Train_accy 88.49:  35%|███▌      | 7/20 [03:18<05:26, 25.15s/it]
Task 1, Epoch 8/20 => Loss 0.207, Train_accy 88.49:  40%|████      | 8/20 [03:18<04:56, 24.75s/it]
Task 1, Epoch 9/20 => Loss 0.227, Train_accy 87.98:  40%|████      | 8/20 [03:42<04:56, 24.75s/it]
Task 1, Epoch 9/20 => Loss 0.227, Train_accy 87.98:  45%|████▌     | 9/20 [03:42<04:29, 24.49s/it]
Task 1, Epoch 10/20 => Loss 0.162, Train_accy 89.81, Test_accy 81.15:  45%|████▌     | 9/20 [04:15<04:29, 24.49s/it]
Task 1, Epoch 10/20 => Loss 0.162, Train_accy 89.81, Test_accy 81.15:  50%|█████     | 10/20 [04:15<04:30, 27.01s/it]
Task 1, Epoch 11/20 => Loss 0.181, Train_accy 89.15:  50%|█████     | 10/20 [04:39<04:30, 27.01s/it]                 
Task 1, Epoch 11/20 => Loss 0.181, Train_accy 89.15:  55%|█████▌    | 11/20 [04:39<03:54, 26.04s/it]
Task 1, Epoch 12/20 => Loss 0.145, Train_accy 89.81:  55%|█████▌    | 11/20 [05:03<03:54, 26.04s/it]
Task 1, Epoch 12/20 => Loss 0.145, Train_accy 89.81:  60%|██████    | 12/20 [05:03<03:22, 25.35s/it]
Task 1, Epoch 13/20 => Loss 0.162, Train_accy 89.62:  60%|██████    | 12/20 [05:26<03:22, 25.35s/it]
Task 1, Epoch 13/20 => Loss 0.162, Train_accy 89.62:  65%|██████▌   | 13/20 [05:26<02:54, 24.87s/it]
Task 1, Epoch 14/20 => Loss 0.152, Train_accy 90.63:  65%|██████▌   | 13/20 [05:50<02:54, 24.87s/it]
Task 1, Epoch 14/20 => Loss 0.152, Train_accy 90.63:  70%|███████   | 14/20 [05:50<02:27, 24.53s/it]
Task 1, Epoch 15/20 => Loss 0.102, Train_accy 92.15, Test_accy 82.51:  70%|███████   | 14/20 [06:22<02:27, 24.53s/it]
Task 1, Epoch 15/20 => Loss 0.102, Train_accy 92.15, Test_accy 82.51:  75%|███████▌  | 15/20 [06:22<02:14, 26.88s/it]
Task 1, Epoch 16/20 => Loss 0.139, Train_accy 90.52:  75%|███████▌  | 15/20 [06:46<02:14, 26.88s/it]                 
Task 1, Epoch 16/20 => Loss 0.139, Train_accy 90.52:  80%|████████  | 16/20 [06:46<01:44, 26.01s/it]
Task 1, Epoch 17/20 => Loss 0.123, Train_accy 90.59:  80%|████████  | 16/20 [07:11<01:44, 26.01s/it]
Task 1, Epoch 17/20 => Loss 0.123, Train_accy 90.59:  85%|████████▌ | 17/20 [07:11<01:16, 25.44s/it]
Task 1, Epoch 18/20 => Loss 0.127, Train_accy 90.59:  85%|████████▌ | 17/20 [07:34<01:16, 25.44s/it]
Task 1, Epoch 18/20 => Loss 0.127, Train_accy 90.59:  90%|█████████ | 18/20 [07:34<00:49, 24.97s/it]
Task 1, Epoch 19/20 => Loss 0.118, Train_accy 91.45:  90%|█████████ | 18/20 [07:58<00:49, 24.97s/it]
Task 1, Epoch 19/20 => Loss 0.118, Train_accy 91.45:  95%|█████████▌| 19/20 [07:58<00:24, 24.63s/it]
Task 1, Epoch 20/20 => Loss 0.106, Train_accy 91.45, Test_accy 81.30:  95%|█████████▌| 19/20 [08:31<00:24, 24.63s/it]
Task 1, Epoch 20/20 => Loss 0.106, Train_accy 91.45, Test_accy 81.30: 100%|██████████| 20/20 [08:31<00:00, 27.03s/it]
Task 1, Epoch 20/20 => Loss 0.106, Train_accy 91.45, Test_accy 81.30: 100%|██████████| 20/20 [08:31<00:00, 25.57s/it]
2024-09-07 16:38:28,660 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.106, Train_accy 91.45, Test_accy 81.30
2024-09-07 16:38:37,132 [trainer.py] => No NME accuracy.
2024-09-07 16:38:37,133 [trainer.py] => CNN: {'total': 81.3, '00-19': 83.16, '20-39': 79.27, 'old': 83.16, 'new': 79.27}
2024-09-07 16:38:37,133 [trainer.py] => CNN top1 curve: [87.23, 81.3]
2024-09-07 16:38:37,133 [trainer.py] => CNN top5 curve: [96.66, 94.47]

Average Accuracy (CNN): 84.26
2024-09-07 16:38:37,133 [trainer.py] => Average Accuracy (CNN): 84.26 

2024-09-07 16:38:37,135 [trainer.py] => All params: 171970192
2024-09-07 16:38:37,137 [trainer.py] => Trainable params: 199880
2024-09-07 16:38:37,137 [l2p.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.153, Train_accy 62.70:   0%|          | 0/20 [00:21<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.153, Train_accy 62.70:   5%|▌         | 1/20 [00:21<06:53, 21.78s/it]
Task 2, Epoch 2/20 => Loss 0.464, Train_accy 80.79:   5%|▌         | 1/20 [00:43<06:53, 21.78s/it]
Task 2, Epoch 2/20 => Loss 0.464, Train_accy 80.79:  10%|█         | 2/20 [00:43<06:33, 21.84s/it]
Task 2, Epoch 3/20 => Loss 0.342, Train_accy 84.34:  10%|█         | 2/20 [01:05<06:33, 21.84s/it]
Task 2, Epoch 3/20 => Loss 0.342, Train_accy 84.34:  15%|█▌        | 3/20 [01:05<06:10, 21.79s/it]
Task 2, Epoch 4/20 => Loss 0.274, Train_accy 86.43:  15%|█▌        | 3/20 [01:27<06:10, 21.79s/it]
Task 2, Epoch 4/20 => Loss 0.274, Train_accy 86.43:  20%|██        | 4/20 [01:27<05:49, 21.84s/it]
Task 2, Epoch 5/20 => Loss 0.244, Train_accy 87.20, Test_accy 75.71:  20%|██        | 4/20 [02:00<05:49, 21.84s/it]
Task 2, Epoch 5/20 => Loss 0.244, Train_accy 87.20, Test_accy 75.71:  25%|██▌       | 5/20 [02:00<06:31, 26.10s/it]
Task 2, Epoch 6/20 => Loss 0.215, Train_accy 88.52:  25%|██▌       | 5/20 [02:22<06:31, 26.10s/it]                 
Task 2, Epoch 6/20 => Loss 0.215, Train_accy 88.52:  30%|███       | 6/20 [02:22<05:45, 24.66s/it]
Task 2, Epoch 7/20 => Loss 0.177, Train_accy 89.63:  30%|███       | 6/20 [02:44<05:45, 24.66s/it]
Task 2, Epoch 7/20 => Loss 0.177, Train_accy 89.63:  35%|███▌      | 7/20 [02:44<05:09, 23.81s/it]
Task 2, Epoch 8/20 => Loss 0.197, Train_accy 88.78:  35%|███▌      | 7/20 [03:06<05:09, 23.81s/it]
Task 2, Epoch 8/20 => Loss 0.197, Train_accy 88.78:  40%|████      | 8/20 [03:06<04:38, 23.21s/it]
Task 2, Epoch 9/20 => Loss 0.165, Train_accy 89.71:  40%|████      | 8/20 [03:28<04:38, 23.21s/it]
Task 2, Epoch 9/20 => Loss 0.165, Train_accy 89.71:  45%|████▌     | 9/20 [03:28<04:10, 22.77s/it]
Task 2, Epoch 10/20 => Loss 0.153, Train_accy 90.06, Test_accy 77.32:  45%|████▌     | 9/20 [04:02<04:10, 22.77s/it]
Task 2, Epoch 10/20 => Loss 0.153, Train_accy 90.06, Test_accy 77.32:  50%|█████     | 10/20 [04:02<04:21, 26.17s/it]
Task 2, Epoch 11/20 => Loss 0.155, Train_accy 90.44:  50%|█████     | 10/20 [04:24<04:21, 26.17s/it]                 
Task 2, Epoch 11/20 => Loss 0.155, Train_accy 90.44:  55%|█████▌    | 11/20 [04:24<03:43, 24.84s/it]
Task 2, Epoch 12/20 => Loss 0.181, Train_accy 90.06:  55%|█████▌    | 11/20 [04:45<03:43, 24.84s/it]
Task 2, Epoch 12/20 => Loss 0.181, Train_accy 90.06:  60%|██████    | 12/20 [04:45<03:11, 23.89s/it]
Task 2, Epoch 13/20 => Loss 0.145, Train_accy 90.61:  60%|██████    | 12/20 [05:07<03:11, 23.89s/it]
Task 2, Epoch 13/20 => Loss 0.145, Train_accy 90.61:  65%|██████▌   | 13/20 [05:07<02:42, 23.28s/it]
Task 2, Epoch 14/20 => Loss 0.119, Train_accy 90.44:  65%|██████▌   | 13/20 [05:29<02:42, 23.28s/it]
Task 2, Epoch 14/20 => Loss 0.119, Train_accy 90.44:  70%|███████   | 14/20 [05:29<02:16, 22.82s/it]
Task 2, Epoch 15/20 => Loss 0.130, Train_accy 90.95, Test_accy 77.89:  70%|███████   | 14/20 [06:03<02:16, 22.82s/it]
Task 2, Epoch 15/20 => Loss 0.130, Train_accy 90.95, Test_accy 77.89:  75%|███████▌  | 15/20 [06:03<02:11, 26.25s/it]
Task 2, Epoch 16/20 => Loss 0.106, Train_accy 91.34:  75%|███████▌  | 15/20 [06:25<02:11, 26.25s/it]                 
Task 2, Epoch 16/20 => Loss 0.106, Train_accy 91.34:  80%|████████  | 16/20 [06:25<01:39, 24.93s/it]
Task 2, Epoch 17/20 => Loss 0.158, Train_accy 90.31:  80%|████████  | 16/20 [06:47<01:39, 24.93s/it]
Task 2, Epoch 17/20 => Loss 0.158, Train_accy 90.31:  85%|████████▌ | 17/20 [06:47<01:11, 23.96s/it]
Task 2, Epoch 18/20 => Loss 0.132, Train_accy 90.91:  85%|████████▌ | 17/20 [07:09<01:11, 23.96s/it]
Task 2, Epoch 18/20 => Loss 0.132, Train_accy 90.91:  90%|█████████ | 18/20 [07:09<00:46, 23.29s/it]
Task 2, Epoch 19/20 => Loss 0.114, Train_accy 92.27:  90%|█████████ | 18/20 [07:30<00:46, 23.29s/it]
Task 2, Epoch 19/20 => Loss 0.114, Train_accy 92.27:  95%|█████████▌| 19/20 [07:30<00:22, 22.86s/it]
Task 2, Epoch 20/20 => Loss 0.103, Train_accy 91.98, Test_accy 79.24:  95%|█████████▌| 19/20 [08:04<00:22, 22.86s/it]
Task 2, Epoch 20/20 => Loss 0.103, Train_accy 91.98, Test_accy 79.24: 100%|██████████| 20/20 [08:04<00:00, 26.12s/it]
Task 2, Epoch 20/20 => Loss 0.103, Train_accy 91.98, Test_accy 79.24: 100%|██████████| 20/20 [08:04<00:00, 24.23s/it]
2024-09-07 16:46:41,799 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.103, Train_accy 91.98, Test_accy 79.24
2024-09-07 16:46:53,709 [trainer.py] => No NME accuracy.
2024-09-07 16:46:53,709 [trainer.py] => CNN: {'total': 79.24, '00-19': 82.0, '20-39': 78.8, '40-59': 76.57, 'old': 80.47, 'new': 76.57}
2024-09-07 16:46:53,709 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24]
2024-09-07 16:46:53,710 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2]

Average Accuracy (CNN): 82.59
2024-09-07 16:46:53,710 [trainer.py] => Average Accuracy (CNN): 82.59 

2024-09-07 16:46:53,711 [trainer.py] => All params: 171970192
2024-09-07 16:46:53,712 [trainer.py] => Trainable params: 199880
2024-09-07 16:46:53,712 [l2p.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.090, Train_accy 64.28:   0%|          | 0/20 [00:21<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.090, Train_accy 64.28:   5%|▌         | 1/20 [00:21<06:45, 21.36s/it]
Task 3, Epoch 2/20 => Loss 0.443, Train_accy 81.29:   5%|▌         | 1/20 [00:42<06:45, 21.36s/it]
Task 3, Epoch 2/20 => Loss 0.443, Train_accy 81.29:  10%|█         | 2/20 [00:42<06:24, 21.37s/it]
Task 3, Epoch 3/20 => Loss 0.360, Train_accy 84.82:  10%|█         | 2/20 [01:04<06:24, 21.37s/it]
Task 3, Epoch 3/20 => Loss 0.360, Train_accy 84.82:  15%|█▌        | 3/20 [01:04<06:04, 21.43s/it]
Task 3, Epoch 4/20 => Loss 0.269, Train_accy 86.31:  15%|█▌        | 3/20 [01:25<06:04, 21.43s/it]
Task 3, Epoch 4/20 => Loss 0.269, Train_accy 86.31:  20%|██        | 4/20 [01:25<05:41, 21.35s/it]
Task 3, Epoch 5/20 => Loss 0.205, Train_accy 88.23, Test_accy 74.98:  20%|██        | 4/20 [02:02<05:41, 21.35s/it]
Task 3, Epoch 5/20 => Loss 0.205, Train_accy 88.23, Test_accy 74.98:  25%|██▌       | 5/20 [02:02<06:42, 26.86s/it]
Task 3, Epoch 6/20 => Loss 0.222, Train_accy 88.23:  25%|██▌       | 5/20 [02:23<06:42, 26.86s/it]                 
Task 3, Epoch 6/20 => Loss 0.222, Train_accy 88.23:  30%|███       | 6/20 [02:23<05:49, 24.97s/it]
Task 3, Epoch 7/20 => Loss 0.217, Train_accy 88.53:  30%|███       | 6/20 [02:44<05:49, 24.97s/it]
Task 3, Epoch 7/20 => Loss 0.217, Train_accy 88.53:  35%|███▌      | 7/20 [02:44<05:09, 23.80s/it]
Task 3, Epoch 8/20 => Loss 0.187, Train_accy 89.45:  35%|███▌      | 7/20 [03:06<05:09, 23.80s/it]
Task 3, Epoch 8/20 => Loss 0.187, Train_accy 89.45:  40%|████      | 8/20 [03:06<04:36, 23.00s/it]
Task 3, Epoch 9/20 => Loss 0.152, Train_accy 90.54:  40%|████      | 8/20 [03:27<04:36, 23.00s/it]
Task 3, Epoch 9/20 => Loss 0.152, Train_accy 90.54:  45%|████▌     | 9/20 [03:27<04:07, 22.50s/it]
Task 3, Epoch 10/20 => Loss 0.172, Train_accy 90.23, Test_accy 76.82:  45%|████▌     | 9/20 [04:04<04:07, 22.50s/it]
Task 3, Epoch 10/20 => Loss 0.172, Train_accy 90.23, Test_accy 76.82:  50%|█████     | 10/20 [04:04<04:28, 26.87s/it]
Task 3, Epoch 11/20 => Loss 0.159, Train_accy 90.10:  50%|█████     | 10/20 [04:25<04:28, 26.87s/it]                 
Task 3, Epoch 11/20 => Loss 0.159, Train_accy 90.10:  55%|█████▌    | 11/20 [04:25<03:46, 25.20s/it]
Task 3, Epoch 12/20 => Loss 0.152, Train_accy 89.80:  55%|█████▌    | 11/20 [04:46<03:46, 25.20s/it]
Task 3, Epoch 12/20 => Loss 0.152, Train_accy 89.80:  60%|██████    | 12/20 [04:46<03:12, 24.02s/it]
Task 3, Epoch 13/20 => Loss 0.144, Train_accy 90.75:  60%|██████    | 12/20 [05:08<03:12, 24.02s/it]
Task 3, Epoch 13/20 => Loss 0.144, Train_accy 90.75:  65%|██████▌   | 13/20 [05:08<02:42, 23.23s/it]
Task 3, Epoch 14/20 => Loss 0.144, Train_accy 90.41:  65%|██████▌   | 13/20 [05:29<02:42, 23.23s/it]
Task 3, Epoch 14/20 => Loss 0.144, Train_accy 90.41:  70%|███████   | 14/20 [05:29<02:16, 22.70s/it]
Task 3, Epoch 15/20 => Loss 0.123, Train_accy 91.67, Test_accy 77.10:  70%|███████   | 14/20 [06:06<02:16, 22.70s/it]
Task 3, Epoch 15/20 => Loss 0.123, Train_accy 91.67, Test_accy 77.10:  75%|███████▌  | 15/20 [06:06<02:14, 26.95s/it]
Task 3, Epoch 16/20 => Loss 0.143, Train_accy 90.23:  75%|███████▌  | 15/20 [06:27<02:14, 26.95s/it]                 
Task 3, Epoch 16/20 => Loss 0.143, Train_accy 90.23:  80%|████████  | 16/20 [06:27<01:41, 25.27s/it]
Task 3, Epoch 17/20 => Loss 0.096, Train_accy 91.98:  80%|████████  | 16/20 [06:49<01:41, 25.27s/it]
Task 3, Epoch 17/20 => Loss 0.096, Train_accy 91.98:  85%|████████▌ | 17/20 [06:49<01:12, 24.09s/it]
Task 3, Epoch 18/20 => Loss 0.072, Train_accy 92.02:  85%|████████▌ | 17/20 [07:10<01:12, 24.09s/it]
Task 3, Epoch 18/20 => Loss 0.072, Train_accy 92.02:  90%|█████████ | 18/20 [07:10<00:46, 23.27s/it]
Task 3, Epoch 19/20 => Loss 0.120, Train_accy 91.06:  90%|█████████ | 18/20 [07:31<00:46, 23.27s/it]
Task 3, Epoch 19/20 => Loss 0.120, Train_accy 91.06:  95%|█████████▌| 19/20 [07:31<00:22, 22.70s/it]
Task 3, Epoch 20/20 => Loss 0.118, Train_accy 91.02, Test_accy 77.18:  95%|█████████▌| 19/20 [08:08<00:22, 22.70s/it]
Task 3, Epoch 20/20 => Loss 0.118, Train_accy 91.02, Test_accy 77.18: 100%|██████████| 20/20 [08:08<00:00, 26.90s/it]
Task 3, Epoch 20/20 => Loss 0.118, Train_accy 91.02, Test_accy 77.18: 100%|██████████| 20/20 [08:08<00:00, 24.43s/it]
2024-09-07 16:55:02,398 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.118, Train_accy 91.02, Test_accy 77.18
2024-09-07 16:55:17,710 [trainer.py] => No NME accuracy.
2024-09-07 16:55:17,711 [trainer.py] => CNN: {'total': 77.18, '00-19': 80.55, '20-39': 78.64, '40-59': 75.58, '60-79': 73.2, 'old': 78.36, 'new': 73.2}
2024-09-07 16:55:17,711 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24, 77.18]
2024-09-07 16:55:17,711 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2, 91.71]

Average Accuracy (CNN): 81.24
2024-09-07 16:55:17,711 [trainer.py] => Average Accuracy (CNN): 81.24 

2024-09-07 16:55:17,714 [trainer.py] => All params: 171970192
2024-09-07 16:55:17,716 [trainer.py] => Trainable params: 199880
2024-09-07 16:55:17,717 [l2p.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.054, Train_accy 64.64:   0%|          | 0/20 [00:20<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.054, Train_accy 64.64:   5%|▌         | 1/20 [00:20<06:25, 20.30s/it]
Task 4, Epoch 2/20 => Loss 0.460, Train_accy 81.06:   5%|▌         | 1/20 [00:40<06:25, 20.30s/it]
Task 4, Epoch 2/20 => Loss 0.460, Train_accy 81.06:  10%|█         | 2/20 [00:40<06:05, 20.31s/it]
Task 4, Epoch 3/20 => Loss 0.386, Train_accy 83.59:  10%|█         | 2/20 [01:00<06:05, 20.31s/it]
Task 4, Epoch 3/20 => Loss 0.386, Train_accy 83.59:  15%|█▌        | 3/20 [01:00<05:45, 20.32s/it]
Task 4, Epoch 4/20 => Loss 0.288, Train_accy 86.25:  15%|█▌        | 3/20 [01:21<05:45, 20.32s/it]
Task 4, Epoch 4/20 => Loss 0.288, Train_accy 86.25:  20%|██        | 4/20 [01:21<05:25, 20.33s/it]
Task 4, Epoch 5/20 => Loss 0.220, Train_accy 88.51, Test_accy 73.50:  20%|██        | 4/20 [01:59<05:25, 20.33s/it]
Task 4, Epoch 5/20 => Loss 0.220, Train_accy 88.51, Test_accy 73.50:  25%|██▌       | 5/20 [01:59<06:42, 26.85s/it]
Task 4, Epoch 6/20 => Loss 0.214, Train_accy 88.05:  25%|██▌       | 5/20 [02:19<06:42, 26.85s/it]                 
Task 4, Epoch 6/20 => Loss 0.214, Train_accy 88.05:  30%|███       | 6/20 [02:19<05:44, 24.58s/it]
Task 4, Epoch 7/20 => Loss 0.180, Train_accy 89.38:  30%|███       | 6/20 [02:40<05:44, 24.58s/it]
Task 4, Epoch 7/20 => Loss 0.180, Train_accy 89.38:  35%|███▌      | 7/20 [02:40<05:00, 23.14s/it]
Task 4, Epoch 8/20 => Loss 0.153, Train_accy 90.39:  35%|███▌      | 7/20 [03:00<05:00, 23.14s/it]
Task 4, Epoch 8/20 => Loss 0.153, Train_accy 90.39:  40%|████      | 8/20 [03:00<04:26, 22.19s/it]
Task 4, Epoch 9/20 => Loss 0.170, Train_accy 90.30:  40%|████      | 8/20 [03:20<04:26, 22.19s/it]
Task 4, Epoch 9/20 => Loss 0.170, Train_accy 90.30:  45%|████▌     | 9/20 [03:20<03:57, 21.56s/it]
Task 4, Epoch 10/20 => Loss 0.156, Train_accy 89.84, Test_accy 74.37:  45%|████▌     | 9/20 [03:58<03:57, 21.56s/it]
Task 4, Epoch 10/20 => Loss 0.156, Train_accy 89.84, Test_accy 74.37:  50%|█████     | 10/20 [03:58<04:26, 26.69s/it]
Task 4, Epoch 11/20 => Loss 0.131, Train_accy 91.03:  50%|█████     | 10/20 [04:18<04:26, 26.69s/it]                 
Task 4, Epoch 11/20 => Loss 0.131, Train_accy 91.03:  55%|█████▌    | 11/20 [04:18<03:42, 24.69s/it]
Task 4, Epoch 12/20 => Loss 0.116, Train_accy 90.85:  55%|█████▌    | 11/20 [04:38<03:42, 24.69s/it]
Task 4, Epoch 12/20 => Loss 0.116, Train_accy 90.85:  60%|██████    | 12/20 [04:38<03:06, 23.30s/it]
Task 4, Epoch 13/20 => Loss 0.100, Train_accy 91.68:  60%|██████    | 12/20 [04:59<03:06, 23.30s/it]
Task 4, Epoch 13/20 => Loss 0.100, Train_accy 91.68:  65%|██████▌   | 13/20 [04:59<02:36, 22.36s/it]
Task 4, Epoch 14/20 => Loss 0.095, Train_accy 91.72:  65%|██████▌   | 13/20 [05:19<02:36, 22.36s/it]
Task 4, Epoch 14/20 => Loss 0.095, Train_accy 91.72:  70%|███████   | 14/20 [05:19<02:10, 21.70s/it]
Task 4, Epoch 15/20 => Loss 0.100, Train_accy 91.49, Test_accy 74.64:  70%|███████   | 14/20 [05:57<02:10, 21.70s/it]
Task 4, Epoch 15/20 => Loss 0.100, Train_accy 91.49, Test_accy 74.64:  75%|███████▌  | 15/20 [05:57<02:13, 26.66s/it]
Task 4, Epoch 16/20 => Loss 0.086, Train_accy 92.41:  75%|███████▌  | 15/20 [06:17<02:13, 26.66s/it]                 
Task 4, Epoch 16/20 => Loss 0.086, Train_accy 92.41:  80%|████████  | 16/20 [06:17<01:38, 24.70s/it]
Task 4, Epoch 17/20 => Loss 0.123, Train_accy 91.54:  80%|████████  | 16/20 [06:37<01:38, 24.70s/it]
Task 4, Epoch 17/20 => Loss 0.123, Train_accy 91.54:  85%|████████▌ | 17/20 [06:37<01:10, 23.34s/it]
Task 4, Epoch 18/20 => Loss 0.077, Train_accy 91.95:  85%|████████▌ | 17/20 [06:57<01:10, 23.34s/it]
Task 4, Epoch 18/20 => Loss 0.077, Train_accy 91.95:  90%|█████████ | 18/20 [06:57<00:44, 22.39s/it]
Task 4, Epoch 19/20 => Loss 0.098, Train_accy 91.91:  90%|█████████ | 18/20 [07:18<00:44, 22.39s/it]
Task 4, Epoch 19/20 => Loss 0.098, Train_accy 91.91:  95%|█████████▌| 19/20 [07:18<00:21, 21.72s/it]
Task 4, Epoch 20/20 => Loss 0.067, Train_accy 92.55, Test_accy 74.77:  95%|█████████▌| 19/20 [07:56<00:21, 21.72s/it]
Task 4, Epoch 20/20 => Loss 0.067, Train_accy 92.55, Test_accy 74.77: 100%|██████████| 20/20 [07:56<00:00, 26.67s/it]
Task 4, Epoch 20/20 => Loss 0.067, Train_accy 92.55, Test_accy 74.77: 100%|██████████| 20/20 [07:56<00:00, 23.81s/it]
2024-09-07 17:03:13,995 [l2p.py] => Task 4, Epoch 20/20 => Loss 0.067, Train_accy 92.55, Test_accy 74.77
2024-09-07 17:03:32,055 [trainer.py] => No NME accuracy.
2024-09-07 17:03:32,055 [trainer.py] => CNN: {'total': 74.77, '00-19': 80.84, '20-39': 78.01, '40-59': 73.6, '60-79': 71.8, '80-99': 66.94, 'old': 76.3, 'new': 66.94}
2024-09-07 17:03:32,056 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24, 77.18, 74.77]
2024-09-07 17:03:32,056 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2, 91.71, 90.52]

Average Accuracy (CNN): 79.94
2024-09-07 17:03:32,056 [trainer.py] => Average Accuracy (CNN): 79.94 

2024-09-07 17:03:32,059 [trainer.py] => All params: 171970192
2024-09-07 17:03:32,061 [trainer.py] => Trainable params: 199880
2024-09-07 17:03:32,062 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.893, Train_accy 69.61:   0%|          | 0/20 [00:24<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.893, Train_accy 69.61:   5%|▌         | 1/20 [00:24<07:51, 24.79s/it]
Task 5, Epoch 2/20 => Loss 0.367, Train_accy 83.60:   5%|▌         | 1/20 [00:49<07:51, 24.79s/it]
Task 5, Epoch 2/20 => Loss 0.367, Train_accy 83.60:  10%|█         | 2/20 [00:49<07:25, 24.74s/it]
Task 5, Epoch 3/20 => Loss 0.263, Train_accy 86.27:  10%|█         | 2/20 [01:14<07:25, 24.74s/it]
Task 5, Epoch 3/20 => Loss 0.263, Train_accy 86.27:  15%|█▌        | 3/20 [01:14<07:00, 24.76s/it]
Task 5, Epoch 4/20 => Loss 0.211, Train_accy 88.59:  15%|█▌        | 3/20 [01:39<07:00, 24.76s/it]
Task 5, Epoch 4/20 => Loss 0.211, Train_accy 88.59:  20%|██        | 4/20 [01:39<06:36, 24.79s/it]
Task 5, Epoch 5/20 => Loss 0.177, Train_accy 89.27, Test_accy 72.04:  20%|██        | 4/20 [02:25<06:36, 24.79s/it]
Task 5, Epoch 5/20 => Loss 0.177, Train_accy 89.27, Test_accy 72.04:  25%|██▌       | 5/20 [02:25<08:11, 32.76s/it]
Task 5, Epoch 6/20 => Loss 0.180, Train_accy 89.76:  25%|██▌       | 5/20 [02:50<08:11, 32.76s/it]                 
Task 5, Epoch 6/20 => Loss 0.180, Train_accy 89.76:  30%|███       | 6/20 [02:50<07:00, 30.05s/it]
Task 5, Epoch 7/20 => Loss 0.145, Train_accy 89.42:  30%|███       | 6/20 [03:15<07:00, 30.05s/it]
Task 5, Epoch 7/20 => Loss 0.145, Train_accy 89.42:  35%|███▌      | 7/20 [03:15<06:08, 28.36s/it]
Task 5, Epoch 8/20 => Loss 0.152, Train_accy 89.98:  35%|███▌      | 7/20 [03:40<06:08, 28.36s/it]
Task 5, Epoch 8/20 => Loss 0.152, Train_accy 89.98:  40%|████      | 8/20 [03:40<05:26, 27.21s/it]
Task 5, Epoch 9/20 => Loss 0.108, Train_accy 91.37:  40%|████      | 8/20 [04:05<05:26, 27.21s/it]
Task 5, Epoch 9/20 => Loss 0.108, Train_accy 91.37:  45%|████▌     | 9/20 [04:05<04:50, 26.43s/it]
Task 5, Epoch 10/20 => Loss 0.119, Train_accy 90.43, Test_accy 73.28:  45%|████▌     | 9/20 [04:51<04:50, 26.43s/it]
Task 5, Epoch 10/20 => Loss 0.119, Train_accy 90.43, Test_accy 73.28:  50%|█████     | 10/20 [04:51<05:26, 32.66s/it]
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 92.01:  50%|█████     | 10/20 [05:16<05:26, 32.66s/it]                 
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 92.01:  55%|█████▌    | 11/20 [05:16<04:31, 30.19s/it]
Task 5, Epoch 12/20 => Loss 0.121, Train_accy 90.88:  55%|█████▌    | 11/20 [05:41<04:31, 30.19s/it]
Task 5, Epoch 12/20 => Loss 0.121, Train_accy 90.88:  60%|██████    | 12/20 [05:41<03:48, 28.53s/it]
Task 5, Epoch 13/20 => Loss 0.097, Train_accy 92.08:  60%|██████    | 12/20 [06:05<03:48, 28.53s/it]
Task 5, Epoch 13/20 => Loss 0.097, Train_accy 92.08:  65%|██████▌   | 13/20 [06:05<03:11, 27.34s/it]
Task 5, Epoch 14/20 => Loss 0.087, Train_accy 91.67:  65%|██████▌   | 13/20 [06:30<03:11, 27.34s/it]
Task 5, Epoch 14/20 => Loss 0.087, Train_accy 91.67:  70%|███████   | 14/20 [06:30<02:39, 26.52s/it]
Task 5, Epoch 15/20 => Loss 0.077, Train_accy 92.01, Test_accy 73.88:  70%|███████   | 14/20 [07:16<02:39, 26.52s/it]
Task 5, Epoch 15/20 => Loss 0.077, Train_accy 92.01, Test_accy 73.88:  75%|███████▌  | 15/20 [07:16<02:42, 32.54s/it]
Task 5, Epoch 16/20 => Loss 0.077, Train_accy 92.42:  75%|███████▌  | 15/20 [07:41<02:42, 32.54s/it]                 
Task 5, Epoch 16/20 => Loss 0.077, Train_accy 92.42:  80%|████████  | 16/20 [07:41<02:00, 30.15s/it]
Task 5, Epoch 17/20 => Loss 0.081, Train_accy 91.89:  80%|████████  | 16/20 [08:06<02:00, 30.15s/it]
Task 5, Epoch 17/20 => Loss 0.081, Train_accy 91.89:  85%|████████▌ | 17/20 [08:06<01:25, 28.49s/it]
Task 5, Epoch 18/20 => Loss 0.063, Train_accy 92.83:  85%|████████▌ | 17/20 [08:30<01:25, 28.49s/it]
Task 5, Epoch 18/20 => Loss 0.063, Train_accy 92.83:  90%|█████████ | 18/20 [08:30<00:54, 27.32s/it]
Task 5, Epoch 19/20 => Loss 0.066, Train_accy 92.61:  90%|█████████ | 18/20 [08:55<00:54, 27.32s/it]
Task 5, Epoch 19/20 => Loss 0.066, Train_accy 92.61:  95%|█████████▌| 19/20 [08:55<00:26, 26.51s/it]
Task 5, Epoch 20/20 => Loss 0.054, Train_accy 93.17, Test_accy 74.43:  95%|█████████▌| 19/20 [09:42<00:26, 26.51s/it]
Task 5, Epoch 20/20 => Loss 0.054, Train_accy 93.17, Test_accy 74.43: 100%|██████████| 20/20 [09:42<00:00, 32.61s/it]
Task 5, Epoch 20/20 => Loss 0.054, Train_accy 93.17, Test_accy 74.43: 100%|██████████| 20/20 [09:42<00:00, 29.10s/it]
2024-09-07 17:13:14,164 [l2p.py] => Task 5, Epoch 20/20 => Loss 0.054, Train_accy 93.17, Test_accy 74.43
2024-09-07 17:13:36,113 [trainer.py] => No NME accuracy.
2024-09-07 17:13:36,114 [trainer.py] => CNN: {'total': 74.43, '00-19': 80.12, '20-39': 77.69, '40-59': 73.1, '60-79': 70.75, '80-99': 67.76, '100-119': 74.7, 'old': 74.37, 'new': 74.7}
2024-09-07 17:13:36,114 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24, 77.18, 74.77, 74.43]
2024-09-07 17:13:36,114 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2, 91.71, 90.52, 89.88]

Average Accuracy (CNN): 79.02
2024-09-07 17:13:36,114 [trainer.py] => Average Accuracy (CNN): 79.02 

2024-09-07 17:13:36,117 [trainer.py] => All params: 171970192
2024-09-07 17:13:36,119 [trainer.py] => Trainable params: 199880
2024-09-07 17:13:36,119 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.973, Train_accy 68.17:   0%|          | 0/20 [00:19<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.973, Train_accy 68.17:   5%|▌         | 1/20 [00:19<06:15, 19.75s/it]
Task 6, Epoch 2/20 => Loss 0.309, Train_accy 85.45:   5%|▌         | 1/20 [00:39<06:15, 19.75s/it]
Task 6, Epoch 2/20 => Loss 0.309, Train_accy 85.45:  10%|█         | 2/20 [00:39<05:56, 19.79s/it]
Task 6, Epoch 3/20 => Loss 0.200, Train_accy 88.32:  10%|█         | 2/20 [00:59<05:56, 19.79s/it]
Task 6, Epoch 3/20 => Loss 0.200, Train_accy 88.32:  15%|█▌        | 3/20 [00:59<05:37, 19.85s/it]
Task 6, Epoch 4/20 => Loss 0.175, Train_accy 88.94:  15%|█▌        | 3/20 [01:19<05:37, 19.85s/it]
Task 6, Epoch 4/20 => Loss 0.175, Train_accy 88.94:  20%|██        | 4/20 [01:19<05:17, 19.83s/it]
Task 6, Epoch 5/20 => Loss 0.106, Train_accy 91.24, Test_accy 71.74:  20%|██        | 4/20 [02:04<05:17, 19.83s/it]
Task 6, Epoch 5/20 => Loss 0.106, Train_accy 91.24, Test_accy 71.74:  25%|██▌       | 5/20 [02:04<07:14, 28.96s/it]
Task 6, Epoch 6/20 => Loss 0.103, Train_accy 91.38:  25%|██▌       | 5/20 [02:24<07:14, 28.96s/it]                 
Task 6, Epoch 6/20 => Loss 0.103, Train_accy 91.38:  30%|███       | 6/20 [02:24<06:01, 25.86s/it]
Task 6, Epoch 7/20 => Loss 0.122, Train_accy 90.87:  30%|███       | 6/20 [02:44<06:01, 25.86s/it]
Task 6, Epoch 7/20 => Loss 0.122, Train_accy 90.87:  35%|███▌      | 7/20 [02:44<05:10, 23.89s/it]
Task 6, Epoch 8/20 => Loss 0.088, Train_accy 91.71:  35%|███▌      | 7/20 [03:03<05:10, 23.89s/it]
Task 6, Epoch 8/20 => Loss 0.088, Train_accy 91.71:  40%|████      | 8/20 [03:03<04:31, 22.60s/it]
Task 6, Epoch 9/20 => Loss 0.102, Train_accy 91.71:  40%|████      | 8/20 [03:23<04:31, 22.60s/it]
Task 6, Epoch 9/20 => Loss 0.102, Train_accy 91.71:  45%|████▌     | 9/20 [03:23<03:59, 21.74s/it]
Task 6, Epoch 10/20 => Loss 0.064, Train_accy 92.84, Test_accy 72.99:  45%|████▌     | 9/20 [04:09<03:59, 21.74s/it]
Task 6, Epoch 10/20 => Loss 0.064, Train_accy 92.84, Test_accy 72.99:  50%|█████     | 10/20 [04:09<04:49, 28.99s/it]
Task 6, Epoch 11/20 => Loss 0.078, Train_accy 92.23:  50%|█████     | 10/20 [04:28<04:49, 28.99s/it]                 
Task 6, Epoch 11/20 => Loss 0.078, Train_accy 92.23:  55%|█████▌    | 11/20 [04:28<03:55, 26.19s/it]
Task 6, Epoch 12/20 => Loss 0.032, Train_accy 93.41:  55%|█████▌    | 11/20 [04:48<03:55, 26.19s/it]
Task 6, Epoch 12/20 => Loss 0.032, Train_accy 93.41:  60%|██████    | 12/20 [04:48<03:14, 24.27s/it]
Task 6, Epoch 13/20 => Loss 0.067, Train_accy 92.33:  60%|██████    | 12/20 [05:08<03:14, 24.27s/it]
Task 6, Epoch 13/20 => Loss 0.067, Train_accy 92.33:  65%|██████▌   | 13/20 [05:08<02:40, 22.90s/it]
Task 6, Epoch 14/20 => Loss 0.017, Train_accy 94.16:  65%|██████▌   | 13/20 [05:28<02:40, 22.90s/it]
Task 6, Epoch 14/20 => Loss 0.017, Train_accy 94.16:  70%|███████   | 14/20 [05:28<02:11, 21.96s/it]
Task 6, Epoch 15/20 => Loss 0.058, Train_accy 93.03, Test_accy 73.68:  70%|███████   | 14/20 [06:13<02:11, 21.96s/it]
Task 6, Epoch 15/20 => Loss 0.058, Train_accy 93.03, Test_accy 73.68:  75%|███████▌  | 15/20 [06:13<02:24, 28.90s/it]
Task 6, Epoch 16/20 => Loss 0.033, Train_accy 93.46:  75%|███████▌  | 15/20 [06:32<02:24, 28.90s/it]                 
Task 6, Epoch 16/20 => Loss 0.033, Train_accy 93.46:  80%|████████  | 16/20 [06:32<01:44, 26.13s/it]
Task 6, Epoch 17/20 => Loss 0.041, Train_accy 93.50:  80%|████████  | 16/20 [06:52<01:44, 26.13s/it]
Task 6, Epoch 17/20 => Loss 0.041, Train_accy 93.50:  85%|████████▌ | 17/20 [06:52<01:12, 24.21s/it]
Task 6, Epoch 18/20 => Loss 0.023, Train_accy 93.97:  85%|████████▌ | 17/20 [07:12<01:12, 24.21s/it]
Task 6, Epoch 18/20 => Loss 0.023, Train_accy 93.97:  90%|█████████ | 18/20 [07:12<00:45, 22.85s/it]
Task 6, Epoch 19/20 => Loss 0.010, Train_accy 94.16:  90%|█████████ | 18/20 [07:32<00:45, 22.85s/it]
Task 6, Epoch 19/20 => Loss 0.010, Train_accy 94.16:  95%|█████████▌| 19/20 [07:32<00:21, 21.90s/it]
Task 6, Epoch 20/20 => Loss 0.028, Train_accy 93.79, Test_accy 72.99:  95%|█████████▌| 19/20 [08:17<00:21, 21.90s/it]
Task 6, Epoch 20/20 => Loss 0.028, Train_accy 93.79, Test_accy 72.99: 100%|██████████| 20/20 [08:17<00:00, 28.90s/it]
Task 6, Epoch 20/20 => Loss 0.028, Train_accy 93.79, Test_accy 72.99: 100%|██████████| 20/20 [08:17<00:00, 24.86s/it]
2024-09-07 17:21:53,426 [l2p.py] => Task 6, Epoch 20/20 => Loss 0.028, Train_accy 93.79, Test_accy 72.99
2024-09-07 17:22:18,895 [trainer.py] => No NME accuracy.
2024-09-07 17:22:18,895 [trainer.py] => CNN: {'total': 72.99, '00-19': 78.81, '20-39': 76.27, '40-59': 72.61, '60-79': 71.45, '80-99': 66.94, '100-119': 73.64, '120-139': 68.72, 'old': 73.66, 'new': 68.72}
2024-09-07 17:22:18,896 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24, 77.18, 74.77, 74.43, 72.99]
2024-09-07 17:22:18,896 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2, 91.71, 90.52, 89.88, 89.16]

Average Accuracy (CNN): 78.16
2024-09-07 17:22:18,896 [trainer.py] => Average Accuracy (CNN): 78.16 

2024-09-07 17:22:18,898 [trainer.py] => All params: 171970192
2024-09-07 17:22:18,900 [trainer.py] => Trainable params: 199880
2024-09-07 17:22:18,900 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.815, Train_accy 71.52:   0%|          | 0/20 [00:26<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.815, Train_accy 71.52:   5%|▌         | 1/20 [00:26<08:14, 26.05s/it]
Task 7, Epoch 2/20 => Loss 0.321, Train_accy 84.62:   5%|▌         | 1/20 [00:52<08:14, 26.05s/it]
Task 7, Epoch 2/20 => Loss 0.321, Train_accy 84.62:  10%|█         | 2/20 [00:52<07:47, 26.00s/it]
Task 7, Epoch 3/20 => Loss 0.237, Train_accy 87.11:  10%|█         | 2/20 [01:17<07:47, 26.00s/it]
Task 7, Epoch 3/20 => Loss 0.237, Train_accy 87.11:  15%|█▌        | 3/20 [01:17<07:21, 25.98s/it]
Task 7, Epoch 4/20 => Loss 0.196, Train_accy 89.06:  15%|█▌        | 3/20 [01:43<07:21, 25.98s/it]
Task 7, Epoch 4/20 => Loss 0.196, Train_accy 89.06:  20%|██        | 4/20 [01:43<06:55, 25.97s/it]
Task 7, Epoch 5/20 => Loss 0.157, Train_accy 90.20, Test_accy 71.43:  20%|██        | 4/20 [02:39<06:55, 25.97s/it]
Task 7, Epoch 5/20 => Loss 0.157, Train_accy 90.20, Test_accy 71.43:  25%|██▌       | 5/20 [02:39<09:09, 36.66s/it]
Task 7, Epoch 6/20 => Loss 0.116, Train_accy 90.87:  25%|██▌       | 5/20 [03:05<09:09, 36.66s/it]                 
Task 7, Epoch 6/20 => Loss 0.116, Train_accy 90.87:  30%|███       | 6/20 [03:05<07:42, 33.04s/it]
Task 7, Epoch 7/20 => Loss 0.106, Train_accy 91.23:  30%|███       | 6/20 [03:31<07:42, 33.04s/it]
Task 7, Epoch 7/20 => Loss 0.106, Train_accy 91.23:  35%|███▌      | 7/20 [03:31<06:39, 30.75s/it]
Task 7, Epoch 8/20 => Loss 0.114, Train_accy 91.19:  35%|███▌      | 7/20 [03:57<06:39, 30.75s/it]
Task 7, Epoch 8/20 => Loss 0.114, Train_accy 91.19:  40%|████      | 8/20 [03:57<05:50, 29.23s/it]
Task 7, Epoch 9/20 => Loss 0.083, Train_accy 92.51:  40%|████      | 8/20 [04:23<05:50, 29.23s/it]
Task 7, Epoch 9/20 => Loss 0.083, Train_accy 92.51:  45%|████▌     | 9/20 [04:23<05:10, 28.21s/it]
Task 7, Epoch 10/20 => Loss 0.078, Train_accy 92.54, Test_accy 72.71:  45%|████▌     | 9/20 [05:19<05:10, 28.21s/it]
Task 7, Epoch 10/20 => Loss 0.078, Train_accy 92.54, Test_accy 72.71:  50%|█████     | 10/20 [05:19<06:06, 36.67s/it]
Task 7, Epoch 11/20 => Loss 0.086, Train_accy 92.29:  50%|█████     | 10/20 [05:45<06:06, 36.67s/it]                 
Task 7, Epoch 11/20 => Loss 0.086, Train_accy 92.29:  55%|█████▌    | 11/20 [05:45<05:00, 33.42s/it]
Task 7, Epoch 12/20 => Loss 0.071, Train_accy 92.40:  55%|█████▌    | 11/20 [06:11<05:00, 33.42s/it]
Task 7, Epoch 12/20 => Loss 0.071, Train_accy 92.40:  60%|██████    | 12/20 [06:11<04:09, 31.16s/it]
Task 7, Epoch 13/20 => Loss 0.055, Train_accy 92.86:  60%|██████    | 12/20 [06:37<04:09, 31.16s/it]
Task 7, Epoch 13/20 => Loss 0.055, Train_accy 92.86:  65%|██████▌   | 13/20 [06:37<03:27, 29.58s/it]
Task 7, Epoch 14/20 => Loss 0.055, Train_accy 92.61:  65%|██████▌   | 13/20 [07:03<03:27, 29.58s/it]
Task 7, Epoch 14/20 => Loss 0.055, Train_accy 92.61:  70%|███████   | 14/20 [07:03<02:51, 28.52s/it]
Task 7, Epoch 15/20 => Loss 0.059, Train_accy 92.65, Test_accy 73.05:  70%|███████   | 14/20 [07:58<02:51, 28.52s/it]
Task 7, Epoch 15/20 => Loss 0.059, Train_accy 92.65, Test_accy 73.05:  75%|███████▌  | 15/20 [07:58<03:03, 36.72s/it]
Task 7, Epoch 16/20 => Loss 0.051, Train_accy 92.90:  75%|███████▌  | 15/20 [08:25<03:03, 36.72s/it]                 
Task 7, Epoch 16/20 => Loss 0.051, Train_accy 92.90:  80%|████████  | 16/20 [08:25<02:14, 33.54s/it]
Task 7, Epoch 17/20 => Loss 0.060, Train_accy 93.08:  80%|████████  | 16/20 [08:51<02:14, 33.54s/it]
Task 7, Epoch 17/20 => Loss 0.060, Train_accy 93.08:  85%|████████▌ | 17/20 [08:51<01:33, 31.29s/it]
Task 7, Epoch 18/20 => Loss 0.073, Train_accy 92.44:  85%|████████▌ | 17/20 [09:17<01:33, 31.29s/it]
Task 7, Epoch 18/20 => Loss 0.073, Train_accy 92.44:  90%|█████████ | 18/20 [09:17<00:59, 29.72s/it]
Task 7, Epoch 19/20 => Loss 0.044, Train_accy 93.39:  90%|█████████ | 18/20 [09:43<00:59, 29.72s/it]
Task 7, Epoch 19/20 => Loss 0.044, Train_accy 93.39:  95%|█████████▌| 19/20 [09:43<00:28, 28.61s/it]
Task 7, Epoch 20/20 => Loss 0.040, Train_accy 93.47, Test_accy 72.81:  95%|█████████▌| 19/20 [10:38<00:28, 28.61s/it]
Task 7, Epoch 20/20 => Loss 0.040, Train_accy 93.47, Test_accy 72.81: 100%|██████████| 20/20 [10:38<00:00, 36.71s/it]
Task 7, Epoch 20/20 => Loss 0.040, Train_accy 93.47, Test_accy 72.81: 100%|██████████| 20/20 [10:38<00:00, 31.94s/it]
2024-09-07 17:32:57,725 [l2p.py] => Task 7, Epoch 20/20 => Loss 0.040, Train_accy 93.47, Test_accy 72.81
2024-09-07 17:33:27,343 [trainer.py] => No NME accuracy.
2024-09-07 17:33:27,343 [trainer.py] => CNN: {'total': 72.81, '00-19': 77.5, '20-39': 75.63, '40-59': 71.95, '60-79': 70.58, '80-99': 65.3, '100-119': 71.06, '120-139': 68.01, '140-159': 78.74, 'old': 71.78, 'new': 78.74}
2024-09-07 17:33:27,344 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24, 77.18, 74.77, 74.43, 72.99, 72.81]
2024-09-07 17:33:27,344 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2, 91.71, 90.52, 89.88, 89.16, 88.57]

Average Accuracy (CNN): 77.49
2024-09-07 17:33:27,344 [trainer.py] => Average Accuracy (CNN): 77.49 

2024-09-07 17:33:27,346 [trainer.py] => All params: 171970192
2024-09-07 17:33:27,348 [trainer.py] => Trainable params: 199880
2024-09-07 17:33:27,348 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.134, Train_accy 63.09:   0%|          | 0/20 [00:18<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.134, Train_accy 63.09:   5%|▌         | 1/20 [00:18<05:46, 18.22s/it]
Task 8, Epoch 2/20 => Loss 0.365, Train_accy 83.68:   5%|▌         | 1/20 [00:36<05:46, 18.22s/it]
Task 8, Epoch 2/20 => Loss 0.365, Train_accy 83.68:  10%|█         | 2/20 [00:36<05:27, 18.21s/it]
Task 8, Epoch 3/20 => Loss 0.300, Train_accy 85.63:  10%|█         | 2/20 [00:54<05:27, 18.21s/it]
Task 8, Epoch 3/20 => Loss 0.300, Train_accy 85.63:  15%|█▌        | 3/20 [00:54<05:09, 18.22s/it]
Task 8, Epoch 4/20 => Loss 0.257, Train_accy 86.65:  15%|█▌        | 3/20 [01:12<05:09, 18.22s/it]
Task 8, Epoch 4/20 => Loss 0.257, Train_accy 86.65:  20%|██        | 4/20 [01:12<04:51, 18.22s/it]
Task 8, Epoch 5/20 => Loss 0.209, Train_accy 88.50, Test_accy 71.65:  20%|██        | 4/20 [02:03<04:51, 18.22s/it]
Task 8, Epoch 5/20 => Loss 0.209, Train_accy 88.50, Test_accy 71.65:  25%|██▌       | 5/20 [02:03<07:29, 29.94s/it]
Task 8, Epoch 6/20 => Loss 0.178, Train_accy 89.17:  25%|██▌       | 5/20 [02:21<07:29, 29.94s/it]                 
Task 8, Epoch 6/20 => Loss 0.178, Train_accy 89.17:  30%|███       | 6/20 [02:21<06:03, 25.93s/it]
Task 8, Epoch 7/20 => Loss 0.160, Train_accy 89.94:  30%|███       | 6/20 [02:39<06:03, 25.93s/it]
Task 8, Epoch 7/20 => Loss 0.160, Train_accy 89.94:  35%|███▌      | 7/20 [02:39<05:03, 23.38s/it]
Task 8, Epoch 8/20 => Loss 0.173, Train_accy 90.25:  35%|███▌      | 7/20 [02:57<05:03, 23.38s/it]
Task 8, Epoch 8/20 => Loss 0.173, Train_accy 90.25:  40%|████      | 8/20 [02:57<04:20, 21.70s/it]
Task 8, Epoch 9/20 => Loss 0.142, Train_accy 91.02:  40%|████      | 8/20 [03:16<04:20, 21.70s/it]
Task 8, Epoch 9/20 => Loss 0.142, Train_accy 91.02:  45%|████▌     | 9/20 [03:16<03:46, 20.57s/it]
Task 8, Epoch 10/20 => Loss 0.173, Train_accy 89.89, Test_accy 71.83:  45%|████▌     | 9/20 [04:06<03:46, 20.57s/it]
Task 8, Epoch 10/20 => Loss 0.173, Train_accy 89.89, Test_accy 71.83:  50%|█████     | 10/20 [04:06<04:58, 29.90s/it]
Task 8, Epoch 11/20 => Loss 0.133, Train_accy 90.97:  50%|█████     | 10/20 [04:25<04:58, 29.90s/it]                 
Task 8, Epoch 11/20 => Loss 0.133, Train_accy 90.97:  55%|█████▌    | 11/20 [04:25<03:56, 26.32s/it]
Task 8, Epoch 12/20 => Loss 0.142, Train_accy 90.91:  55%|█████▌    | 11/20 [04:43<03:56, 26.32s/it]
Task 8, Epoch 12/20 => Loss 0.142, Train_accy 90.91:  60%|██████    | 12/20 [04:43<03:10, 23.85s/it]
Task 8, Epoch 13/20 => Loss 0.091, Train_accy 92.25:  60%|██████    | 12/20 [05:01<03:10, 23.85s/it]
Task 8, Epoch 13/20 => Loss 0.091, Train_accy 92.25:  65%|██████▌   | 13/20 [05:01<02:34, 22.14s/it]
Task 8, Epoch 14/20 => Loss 0.112, Train_accy 91.32:  65%|██████▌   | 13/20 [05:19<02:34, 22.14s/it]
Task 8, Epoch 14/20 => Loss 0.112, Train_accy 91.32:  70%|███████   | 14/20 [05:19<02:05, 20.94s/it]
Task 8, Epoch 15/20 => Loss 0.087, Train_accy 91.48, Test_accy 72.24:  70%|███████   | 14/20 [06:10<02:05, 20.94s/it]
Task 8, Epoch 15/20 => Loss 0.087, Train_accy 91.48, Test_accy 72.24:  75%|███████▌  | 15/20 [06:10<02:29, 29.88s/it]
Task 8, Epoch 16/20 => Loss 0.090, Train_accy 92.15:  75%|███████▌  | 15/20 [06:28<02:29, 29.88s/it]                 
Task 8, Epoch 16/20 => Loss 0.090, Train_accy 92.15:  80%|████████  | 16/20 [06:28<01:45, 26.36s/it]
Task 8, Epoch 17/20 => Loss 0.064, Train_accy 93.17:  80%|████████  | 16/20 [06:46<01:45, 26.36s/it]
Task 8, Epoch 17/20 => Loss 0.064, Train_accy 93.17:  85%|████████▌ | 17/20 [06:46<01:11, 23.94s/it]
Task 8, Epoch 18/20 => Loss 0.070, Train_accy 92.71:  85%|████████▌ | 17/20 [07:04<01:11, 23.94s/it]
Task 8, Epoch 18/20 => Loss 0.070, Train_accy 92.71:  90%|█████████ | 18/20 [07:04<00:44, 22.21s/it]
Task 8, Epoch 19/20 => Loss 0.052, Train_accy 93.22:  90%|█████████ | 18/20 [07:23<00:44, 22.21s/it]
Task 8, Epoch 19/20 => Loss 0.052, Train_accy 93.22:  95%|█████████▌| 19/20 [07:23<00:21, 21.01s/it]
Task 8, Epoch 20/20 => Loss 0.065, Train_accy 92.81, Test_accy 71.96:  95%|█████████▌| 19/20 [08:13<00:21, 21.01s/it]
Task 8, Epoch 20/20 => Loss 0.065, Train_accy 92.81, Test_accy 71.96: 100%|██████████| 20/20 [08:13<00:00, 29.84s/it]
Task 8, Epoch 20/20 => Loss 0.065, Train_accy 92.81, Test_accy 71.96: 100%|██████████| 20/20 [08:13<00:00, 24.68s/it]
2024-09-07 17:41:40,907 [l2p.py] => Task 8, Epoch 20/20 => Loss 0.065, Train_accy 92.81, Test_accy 71.96
2024-09-07 17:42:13,161 [trainer.py] => No NME accuracy.
2024-09-07 17:42:13,161 [trainer.py] => CNN: {'total': 71.96, '00-19': 75.76, '20-39': 75.47, '40-59': 71.29, '60-79': 69.35, '80-99': 66.12, '100-119': 70.45, '120-139': 67.14, '140-159': 79.29, '160-179': 68.41, 'old': 72.3, 'new': 68.41}
2024-09-07 17:42:13,161 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24, 77.18, 74.77, 74.43, 72.99, 72.81, 71.96]
2024-09-07 17:42:13,161 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2, 91.71, 90.52, 89.88, 89.16, 88.57, 87.88]

Average Accuracy (CNN): 76.88
2024-09-07 17:42:13,162 [trainer.py] => Average Accuracy (CNN): 76.88 

2024-09-07 17:42:13,164 [trainer.py] => All params: 171970192
2024-09-07 17:42:13,165 [trainer.py] => Trainable params: 199880
2024-09-07 17:42:13,166 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.850, Train_accy 70.26:   0%|          | 0/20 [00:21<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.850, Train_accy 70.26:   5%|▌         | 1/20 [00:21<06:41, 21.16s/it]
Task 9, Epoch 2/20 => Loss 0.329, Train_accy 85.07:   5%|▌         | 1/20 [00:42<06:41, 21.16s/it]
Task 9, Epoch 2/20 => Loss 0.329, Train_accy 85.07:  10%|█         | 2/20 [00:42<06:21, 21.20s/it]
Task 9, Epoch 3/20 => Loss 0.217, Train_accy 87.44:  10%|█         | 2/20 [01:03<06:21, 21.20s/it]
Task 9, Epoch 3/20 => Loss 0.217, Train_accy 87.44:  15%|█▌        | 3/20 [01:03<05:59, 21.12s/it]
Task 9, Epoch 4/20 => Loss 0.154, Train_accy 89.56:  15%|█▌        | 3/20 [01:24<05:59, 21.12s/it]
Task 9, Epoch 4/20 => Loss 0.154, Train_accy 89.56:  20%|██        | 4/20 [01:24<05:37, 21.12s/it]
Task 9, Epoch 5/20 => Loss 0.159, Train_accy 89.74, Test_accy 69.72:  20%|██        | 4/20 [02:21<05:37, 21.12s/it]
Task 9, Epoch 5/20 => Loss 0.159, Train_accy 89.74, Test_accy 69.72:  25%|██▌       | 5/20 [02:21<08:30, 34.05s/it]
Task 9, Epoch 6/20 => Loss 0.125, Train_accy 90.79:  25%|██▌       | 5/20 [02:42<08:30, 34.05s/it]                 
Task 9, Epoch 6/20 => Loss 0.125, Train_accy 90.79:  30%|███       | 6/20 [02:42<06:54, 29.64s/it]
Task 9, Epoch 7/20 => Loss 0.133, Train_accy 90.84:  30%|███       | 6/20 [03:03<06:54, 29.64s/it]
Task 9, Epoch 7/20 => Loss 0.133, Train_accy 90.84:  35%|███▌      | 7/20 [03:03<05:48, 26.82s/it]
Task 9, Epoch 8/20 => Loss 0.076, Train_accy 92.38:  35%|███▌      | 7/20 [03:24<05:48, 26.82s/it]
Task 9, Epoch 8/20 => Loss 0.076, Train_accy 92.38:  40%|████      | 8/20 [03:24<04:59, 24.98s/it]
Task 9, Epoch 9/20 => Loss 0.072, Train_accy 92.64:  40%|████      | 8/20 [03:45<04:59, 24.98s/it]
Task 9, Epoch 9/20 => Loss 0.072, Train_accy 92.64:  45%|████▌     | 9/20 [03:45<04:21, 23.74s/it]
Task 9, Epoch 10/20 => Loss 0.072, Train_accy 92.78, Test_accy 70.23:  45%|████▌     | 9/20 [04:42<04:21, 23.74s/it]
Task 9, Epoch 10/20 => Loss 0.072, Train_accy 92.78, Test_accy 70.23:  50%|█████     | 10/20 [04:42<05:38, 33.87s/it]
Task 9, Epoch 11/20 => Loss 0.070, Train_accy 92.60:  50%|█████     | 10/20 [05:03<05:38, 33.87s/it]                 
Task 9, Epoch 11/20 => Loss 0.070, Train_accy 92.60:  55%|█████▌    | 11/20 [05:03<04:29, 29.93s/it]
Task 9, Epoch 12/20 => Loss 0.072, Train_accy 92.33:  55%|█████▌    | 11/20 [05:24<04:29, 29.93s/it]
Task 9, Epoch 12/20 => Loss 0.072, Train_accy 92.33:  60%|██████    | 12/20 [05:24<03:37, 27.22s/it]
Task 9, Epoch 13/20 => Loss 0.045, Train_accy 93.30:  60%|██████    | 12/20 [05:45<03:37, 27.22s/it]
Task 9, Epoch 13/20 => Loss 0.045, Train_accy 93.30:  65%|██████▌   | 13/20 [05:45<02:57, 25.33s/it]
Task 9, Epoch 14/20 => Loss 0.025, Train_accy 93.52:  65%|██████▌   | 13/20 [06:06<02:57, 25.33s/it]
Task 9, Epoch 14/20 => Loss 0.025, Train_accy 93.52:  70%|███████   | 14/20 [06:06<02:24, 24.03s/it]
Task 9, Epoch 15/20 => Loss 0.075, Train_accy 92.20, Test_accy 70.72:  70%|███████   | 14/20 [07:02<02:24, 24.03s/it]
Task 9, Epoch 15/20 => Loss 0.075, Train_accy 92.20, Test_accy 70.72:  75%|███████▌  | 15/20 [07:02<02:49, 33.85s/it]
Task 9, Epoch 16/20 => Loss 0.041, Train_accy 93.66:  75%|███████▌  | 15/20 [07:23<02:49, 33.85s/it]                 
Task 9, Epoch 16/20 => Loss 0.041, Train_accy 93.66:  80%|████████  | 16/20 [07:23<01:59, 29.99s/it]
Task 9, Epoch 17/20 => Loss 0.041, Train_accy 93.08:  80%|████████  | 16/20 [07:44<01:59, 29.99s/it]
Task 9, Epoch 17/20 => Loss 0.041, Train_accy 93.08:  85%|████████▌ | 17/20 [07:44<01:21, 27.28s/it]
Task 9, Epoch 18/20 => Loss 0.045, Train_accy 92.91:  85%|████████▌ | 17/20 [08:05<01:21, 27.28s/it]
Task 9, Epoch 18/20 => Loss 0.045, Train_accy 92.91:  90%|█████████ | 18/20 [08:05<00:50, 25.42s/it]
Task 9, Epoch 19/20 => Loss 0.026, Train_accy 94.10:  90%|█████████ | 18/20 [08:26<00:50, 25.42s/it]
Task 9, Epoch 19/20 => Loss 0.026, Train_accy 94.10:  95%|█████████▌| 19/20 [08:26<00:24, 24.09s/it]
Task 9, Epoch 20/20 => Loss 0.051, Train_accy 92.64, Test_accy 70.68:  95%|█████████▌| 19/20 [09:23<00:24, 24.09s/it]
Task 9, Epoch 20/20 => Loss 0.051, Train_accy 92.64, Test_accy 70.68: 100%|██████████| 20/20 [09:23<00:00, 33.84s/it]
Task 9, Epoch 20/20 => Loss 0.051, Train_accy 92.64, Test_accy 70.68: 100%|██████████| 20/20 [09:23<00:00, 28.17s/it]
2024-09-07 17:51:36,662 [l2p.py] => Task 9, Epoch 20/20 => Loss 0.051, Train_accy 92.64, Test_accy 70.68
2024-09-07 17:52:12,483 [trainer.py] => No NME accuracy.
2024-09-07 17:52:12,484 [trainer.py] => CNN: {'total': 70.68, '00-19': 75.33, '20-39': 74.37, '40-59': 69.47, '60-79': 69.18, '80-99': 65.5, '100-119': 68.18, '120-139': 68.19, '140-159': 77.91, '160-179': 66.95, '180-199': 67.53, 'old': 71.02, 'new': 67.53}
2024-09-07 17:52:12,484 [trainer.py] => CNN top1 curve: [87.23, 81.3, 79.24, 77.18, 74.77, 74.43, 72.99, 72.81, 71.96, 70.68]
2024-09-07 17:52:12,484 [trainer.py] => CNN top5 curve: [96.66, 94.47, 93.2, 91.71, 90.52, 89.88, 89.16, 88.57, 87.88, 87.37]

Average Accuracy (CNN): 76.26
2024-09-07 17:52:12,485 [trainer.py] => Average Accuracy (CNN): 76.26 

Accuracy Matrix (CNN):
[[87.23 83.16 82.   80.55 80.84 80.12 78.81 77.5  75.76 75.33]
 [ 0.   79.27 78.8  78.64 78.01 77.69 76.27 75.63 75.47 74.37]
 [ 0.    0.   76.57 75.58 73.6  73.1  72.61 71.95 71.29 69.47]
 [ 0.    0.    0.   73.2  71.8  70.75 71.45 70.58 69.35 69.18]
 [ 0.    0.    0.    0.   66.94 67.76 66.94 65.3  66.12 65.5 ]
 [ 0.    0.    0.    0.    0.   74.7  73.64 71.06 70.45 68.18]
 [ 0.    0.    0.    0.    0.    0.   68.72 68.01 67.14 68.19]
 [ 0.    0.    0.    0.    0.    0.    0.   78.74 79.29 77.91]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   68.41 66.95]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   67.53]]
2024-09-07 17:52:12,487 [trainer.py] => Forgetting (CNN): 4.452222222222222
2024-09-07 17:52:15,362 [trainer.py] => config: ./exps/l2p_inr_B0_Inc20.json
2024-09-07 17:52:15,362 [trainer.py] => prefix:  
2024-09-07 17:52:15,362 [trainer.py] => dataset: imagenetr
2024-09-07 17:52:15,362 [trainer.py] => memory_size: 0
2024-09-07 17:52:15,362 [trainer.py] => memory_per_class: 0
2024-09-07 17:52:15,362 [trainer.py] => fixed_memory: False
2024-09-07 17:52:15,362 [trainer.py] => shuffle: True
2024-09-07 17:52:15,362 [trainer.py] => init_cls: 10
2024-09-07 17:52:15,362 [trainer.py] => increment: 10
2024-09-07 17:52:15,362 [trainer.py] => model_name: l2p
2024-09-07 17:52:15,362 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 17:52:15,362 [trainer.py] => get_original_backbone: True
2024-09-07 17:52:15,362 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 17:52:15,362 [trainer.py] => seed: 1993
2024-09-07 17:52:15,362 [trainer.py] => tuned_epoch: 20
2024-09-07 17:52:15,362 [trainer.py] => init_lr: 0.001875
2024-09-07 17:52:15,362 [trainer.py] => batch_size: 48
2024-09-07 17:52:15,362 [trainer.py] => weight_decay: 0
2024-09-07 17:52:15,362 [trainer.py] => min_lr: 1e-05
2024-09-07 17:52:15,362 [trainer.py] => optimizer: adam
2024-09-07 17:52:15,362 [trainer.py] => scheduler: constant
2024-09-07 17:52:15,362 [trainer.py] => reinit_optimizer: True
2024-09-07 17:52:15,362 [trainer.py] => global_pool: token
2024-09-07 17:52:15,362 [trainer.py] => head_type: prompt
2024-09-07 17:52:15,362 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 17:52:15,362 [trainer.py] => pretrained: True
2024-09-07 17:52:15,362 [trainer.py] => drop: 0.0
2024-09-07 17:52:15,362 [trainer.py] => drop_path: 0.0
2024-09-07 17:52:15,363 [trainer.py] => prompt_pool: True
2024-09-07 17:52:15,363 [trainer.py] => size: 10
2024-09-07 17:52:15,363 [trainer.py] => length: 5
2024-09-07 17:52:15,363 [trainer.py] => top_k: 5
2024-09-07 17:52:15,363 [trainer.py] => initializer: uniform
2024-09-07 17:52:15,363 [trainer.py] => prompt_key: True
2024-09-07 17:52:15,363 [trainer.py] => prompt_key_init: uniform
2024-09-07 17:52:15,363 [trainer.py] => use_prompt_mask: False
2024-09-07 17:52:15,363 [trainer.py] => shared_prompt_pool: False
2024-09-07 17:52:15,363 [trainer.py] => shared_prompt_key: False
2024-09-07 17:52:15,363 [trainer.py] => batchwise_prompt: True
2024-09-07 17:52:15,363 [trainer.py] => embedding_key: cls
2024-09-07 17:52:15,363 [trainer.py] => predefined_key: 
2024-09-07 17:52:15,363 [trainer.py] => pull_constraint: True
2024-09-07 17:52:15,363 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 17:52:15,446 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 17:52:16,862 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 17:52:16,863 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 17:52:18,568 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 17:52:18,568 [l2p.py] => 199,880 model training parameters.
2024-09-07 17:52:18,568 [l2p.py] => prompt.prompt: 38400
2024-09-07 17:52:18,568 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 17:52:18,569 [l2p.py] => head.weight: 153600
2024-09-07 17:52:18,569 [l2p.py] => head.bias: 200
2024-09-07 17:52:18,570 [trainer.py] => All params: 171970192
2024-09-07 17:52:18,570 [trainer.py] => Trainable params: 199880
2024-09-07 17:52:18,570 [l2p.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.471, Train_accy 52.13:   0%|          | 0/20 [00:12<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.471, Train_accy 52.13:   5%|▌         | 1/20 [00:12<03:57, 12.51s/it]
Task 0, Epoch 2/20 => Loss 0.667, Train_accy 78.36:   5%|▌         | 1/20 [00:24<03:57, 12.51s/it]
Task 0, Epoch 2/20 => Loss 0.667, Train_accy 78.36:  10%|█         | 2/20 [00:24<03:40, 12.25s/it]
Task 0, Epoch 3/20 => Loss 0.523, Train_accy 83.17:  10%|█         | 2/20 [00:36<03:40, 12.25s/it]
Task 0, Epoch 3/20 => Loss 0.523, Train_accy 83.17:  15%|█▌        | 3/20 [00:36<03:27, 12.20s/it]
Task 0, Epoch 4/20 => Loss 0.464, Train_accy 83.48:  15%|█▌        | 3/20 [00:48<03:27, 12.20s/it]
Task 0, Epoch 4/20 => Loss 0.464, Train_accy 83.48:  20%|██        | 4/20 [00:48<03:14, 12.17s/it]
Task 0, Epoch 5/20 => Loss 0.425, Train_accy 84.25, Test_accy 85.80:  20%|██        | 4/20 [01:03<03:14, 12.17s/it]
Task 0, Epoch 5/20 => Loss 0.425, Train_accy 84.25, Test_accy 85.80:  25%|██▌       | 5/20 [01:03<03:15, 13.05s/it]
Task 0, Epoch 6/20 => Loss 0.355, Train_accy 86.97:  25%|██▌       | 5/20 [01:15<03:15, 13.05s/it]                 
Task 0, Epoch 6/20 => Loss 0.355, Train_accy 86.97:  30%|███       | 6/20 [01:15<02:58, 12.75s/it]
Task 0, Epoch 7/20 => Loss 0.316, Train_accy 88.36:  30%|███       | 6/20 [01:27<02:58, 12.75s/it]
Task 0, Epoch 7/20 => Loss 0.316, Train_accy 88.36:  35%|███▌      | 7/20 [01:27<02:43, 12.54s/it]
Task 0, Epoch 8/20 => Loss 0.249, Train_accy 89.29:  35%|███▌      | 7/20 [01:39<02:43, 12.54s/it]
Task 0, Epoch 8/20 => Loss 0.249, Train_accy 89.29:  40%|████      | 8/20 [01:39<02:29, 12.45s/it]
Task 0, Epoch 9/20 => Loss 0.251, Train_accy 88.52:  40%|████      | 8/20 [01:52<02:29, 12.45s/it]
Task 0, Epoch 9/20 => Loss 0.251, Train_accy 88.52:  45%|████▌     | 9/20 [01:52<02:16, 12.41s/it]
Task 0, Epoch 10/20 => Loss 0.237, Train_accy 88.98, Test_accy 88.96:  45%|████▌     | 9/20 [02:07<02:16, 12.41s/it]
Task 0, Epoch 10/20 => Loss 0.237, Train_accy 88.98, Test_accy 88.96:  50%|█████     | 10/20 [02:07<02:11, 13.12s/it]
Task 0, Epoch 11/20 => Loss 0.185, Train_accy 91.39:  50%|█████     | 10/20 [02:19<02:11, 13.12s/it]                 
Task 0, Epoch 11/20 => Loss 0.185, Train_accy 91.39:  55%|█████▌    | 11/20 [02:19<01:55, 12.84s/it]
Task 0, Epoch 12/20 => Loss 0.190, Train_accy 90.77:  55%|█████▌    | 11/20 [02:31<01:55, 12.84s/it]
Task 0, Epoch 12/20 => Loss 0.190, Train_accy 90.77:  60%|██████    | 12/20 [02:31<01:41, 12.65s/it]
Task 0, Epoch 13/20 => Loss 0.154, Train_accy 92.01:  60%|██████    | 12/20 [02:43<01:41, 12.65s/it]
Task 0, Epoch 13/20 => Loss 0.154, Train_accy 92.01:  65%|██████▌   | 13/20 [02:43<01:27, 12.52s/it]
Task 0, Epoch 14/20 => Loss 0.174, Train_accy 90.54:  65%|██████▌   | 13/20 [02:55<01:27, 12.52s/it]
Task 0, Epoch 14/20 => Loss 0.174, Train_accy 90.54:  70%|███████   | 14/20 [02:55<01:14, 12.42s/it]
Task 0, Epoch 15/20 => Loss 0.122, Train_accy 92.32, Test_accy 89.59:  70%|███████   | 14/20 [03:10<01:14, 12.42s/it]
Task 0, Epoch 15/20 => Loss 0.122, Train_accy 92.32, Test_accy 89.59:  75%|███████▌  | 15/20 [03:10<01:05, 13.09s/it]
Task 0, Epoch 16/20 => Loss 0.151, Train_accy 90.85:  75%|███████▌  | 15/20 [03:22<01:05, 13.09s/it]                 
Task 0, Epoch 16/20 => Loss 0.151, Train_accy 90.85:  80%|████████  | 16/20 [03:22<00:51, 12.82s/it]
Task 0, Epoch 17/20 => Loss 0.079, Train_accy 93.10:  80%|████████  | 16/20 [03:34<00:51, 12.82s/it]
Task 0, Epoch 17/20 => Loss 0.079, Train_accy 93.10:  85%|████████▌ | 17/20 [03:34<00:37, 12.64s/it]
Task 0, Epoch 18/20 => Loss 0.085, Train_accy 92.86:  85%|████████▌ | 17/20 [03:47<00:37, 12.64s/it]
Task 0, Epoch 18/20 => Loss 0.085, Train_accy 92.86:  90%|█████████ | 18/20 [03:47<00:25, 12.50s/it]
Task 0, Epoch 19/20 => Loss 0.066, Train_accy 92.32:  90%|█████████ | 18/20 [03:59<00:25, 12.50s/it]
Task 0, Epoch 19/20 => Loss 0.066, Train_accy 92.32:  95%|█████████▌| 19/20 [03:59<00:12, 12.43s/it]
Task 0, Epoch 20/20 => Loss 0.037, Train_accy 93.64, Test_accy 90.54:  95%|█████████▌| 19/20 [04:13<00:12, 12.43s/it]
Task 0, Epoch 20/20 => Loss 0.037, Train_accy 93.64, Test_accy 90.54: 100%|██████████| 20/20 [04:13<00:00, 13.08s/it]
Task 0, Epoch 20/20 => Loss 0.037, Train_accy 93.64, Test_accy 90.54: 100%|██████████| 20/20 [04:13<00:00, 12.70s/it]
2024-09-07 17:56:33,325 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.037, Train_accy 93.64, Test_accy 90.54
2024-09-07 17:56:35,742 [trainer.py] => No NME accuracy.
2024-09-07 17:56:35,743 [trainer.py] => CNN: {'total': 90.54, '00-09': 90.54, 'old': 0, 'new': 90.54}
2024-09-07 17:56:35,743 [trainer.py] => CNN top1 curve: [90.54]
2024-09-07 17:56:35,743 [trainer.py] => CNN top5 curve: [98.74]

Average Accuracy (CNN): 90.54
2024-09-07 17:56:35,743 [trainer.py] => Average Accuracy (CNN): 90.54 

2024-09-07 17:56:35,745 [trainer.py] => All params: 171970192
2024-09-07 17:56:35,747 [trainer.py] => Trainable params: 199880
2024-09-07 17:56:35,747 [l2p.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.981, Train_accy 64.22:   0%|          | 0/20 [00:14<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.981, Train_accy 64.22:   5%|▌         | 1/20 [00:14<04:30, 14.25s/it]
Task 1, Epoch 2/20 => Loss 0.324, Train_accy 84.42:   5%|▌         | 1/20 [00:28<04:30, 14.25s/it]
Task 1, Epoch 2/20 => Loss 0.324, Train_accy 84.42:  10%|█         | 2/20 [00:28<04:17, 14.32s/it]
Task 1, Epoch 3/20 => Loss 0.236, Train_accy 87.99:  10%|█         | 2/20 [00:42<04:17, 14.32s/it]
Task 1, Epoch 3/20 => Loss 0.236, Train_accy 87.99:  15%|█▌        | 3/20 [00:42<04:02, 14.29s/it]
Task 1, Epoch 4/20 => Loss 0.205, Train_accy 87.79:  15%|█▌        | 3/20 [00:57<04:02, 14.29s/it]
Task 1, Epoch 4/20 => Loss 0.205, Train_accy 87.79:  20%|██        | 4/20 [00:57<03:49, 14.31s/it]
Task 1, Epoch 5/20 => Loss 0.139, Train_accy 90.17, Test_accy 81.71:  20%|██        | 4/20 [01:16<03:49, 14.31s/it]
Task 1, Epoch 5/20 => Loss 0.139, Train_accy 90.17, Test_accy 81.71:  25%|██▌       | 5/20 [01:16<03:59, 15.98s/it]
Task 1, Epoch 6/20 => Loss 0.147, Train_accy 89.44:  25%|██▌       | 5/20 [01:30<03:59, 15.98s/it]                 
Task 1, Epoch 6/20 => Loss 0.147, Train_accy 89.44:  30%|███       | 6/20 [01:30<03:35, 15.42s/it]
Task 1, Epoch 7/20 => Loss 0.115, Train_accy 90.30:  30%|███       | 6/20 [01:44<03:35, 15.42s/it]
Task 1, Epoch 7/20 => Loss 0.115, Train_accy 90.30:  35%|███▌      | 7/20 [01:44<03:15, 15.06s/it]
Task 1, Epoch 8/20 => Loss 0.075, Train_accy 91.55:  35%|███▌      | 7/20 [01:59<03:15, 15.06s/it]
Task 1, Epoch 8/20 => Loss 0.075, Train_accy 91.55:  40%|████      | 8/20 [01:59<02:57, 14.81s/it]
Task 1, Epoch 9/20 => Loss 0.071, Train_accy 92.67:  40%|████      | 8/20 [02:13<02:57, 14.81s/it]
Task 1, Epoch 9/20 => Loss 0.071, Train_accy 92.67:  45%|████▌     | 9/20 [02:13<02:41, 14.64s/it]
Task 1, Epoch 10/20 => Loss 0.070, Train_accy 91.49, Test_accy 84.91:  45%|████▌     | 9/20 [02:32<02:41, 14.64s/it]
Task 1, Epoch 10/20 => Loss 0.070, Train_accy 91.49, Test_accy 84.91:  50%|█████     | 10/20 [02:32<02:39, 15.97s/it]
Task 1, Epoch 11/20 => Loss 0.067, Train_accy 92.21:  50%|█████     | 10/20 [02:46<02:39, 15.97s/it]                 
Task 1, Epoch 11/20 => Loss 0.067, Train_accy 92.21:  55%|█████▌    | 11/20 [02:46<02:19, 15.45s/it]
Task 1, Epoch 12/20 => Loss 0.021, Train_accy 93.93:  55%|█████▌    | 11/20 [03:00<02:19, 15.45s/it]
Task 1, Epoch 12/20 => Loss 0.021, Train_accy 93.93:  60%|██████    | 12/20 [03:00<02:00, 15.09s/it]
Task 1, Epoch 13/20 => Loss 0.039, Train_accy 93.27:  60%|██████    | 12/20 [03:15<02:00, 15.09s/it]
Task 1, Epoch 13/20 => Loss 0.039, Train_accy 93.27:  65%|██████▌   | 13/20 [03:15<01:44, 14.88s/it]
Task 1, Epoch 14/20 => Loss 0.026, Train_accy 93.40:  65%|██████▌   | 13/20 [03:29<01:44, 14.88s/it]
Task 1, Epoch 14/20 => Loss 0.026, Train_accy 93.40:  70%|███████   | 14/20 [03:29<01:28, 14.70s/it]
Task 1, Epoch 15/20 => Loss 0.076, Train_accy 91.68, Test_accy 85.05:  70%|███████   | 14/20 [03:48<01:28, 14.70s/it]
Task 1, Epoch 15/20 => Loss 0.076, Train_accy 91.68, Test_accy 85.05:  75%|███████▌  | 15/20 [03:48<01:19, 15.97s/it]
Task 1, Epoch 16/20 => Loss -0.017, Train_accy 94.65:  75%|███████▌  | 15/20 [04:02<01:19, 15.97s/it]                
Task 1, Epoch 16/20 => Loss -0.017, Train_accy 94.65:  80%|████████  | 16/20 [04:02<01:01, 15.45s/it]
Task 1, Epoch 17/20 => Loss 0.009, Train_accy 93.60:  80%|████████  | 16/20 [04:16<01:01, 15.45s/it] 
Task 1, Epoch 17/20 => Loss 0.009, Train_accy 93.60:  85%|████████▌ | 17/20 [04:16<00:45, 15.09s/it]
Task 1, Epoch 18/20 => Loss 0.017, Train_accy 92.81:  85%|████████▌ | 17/20 [04:31<00:45, 15.09s/it]
Task 1, Epoch 18/20 => Loss 0.017, Train_accy 92.81:  90%|█████████ | 18/20 [04:31<00:29, 14.85s/it]
Task 1, Epoch 19/20 => Loss 0.033, Train_accy 93.53:  90%|█████████ | 18/20 [04:45<00:29, 14.85s/it]
Task 1, Epoch 19/20 => Loss 0.033, Train_accy 93.53:  95%|█████████▌| 19/20 [04:45<00:14, 14.72s/it]
Task 1, Epoch 20/20 => Loss 0.024, Train_accy 94.26, Test_accy 84.03:  95%|█████████▌| 19/20 [05:04<00:14, 14.72s/it]
Task 1, Epoch 20/20 => Loss 0.024, Train_accy 94.26, Test_accy 84.03: 100%|██████████| 20/20 [05:04<00:00, 15.97s/it]
Task 1, Epoch 20/20 => Loss 0.024, Train_accy 94.26, Test_accy 84.03: 100%|██████████| 20/20 [05:04<00:00, 15.23s/it]
2024-09-07 18:01:40,273 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.024, Train_accy 94.26, Test_accy 84.03
2024-09-07 18:01:44,884 [trainer.py] => No NME accuracy.
2024-09-07 18:01:44,885 [trainer.py] => CNN: {'total': 84.03, '00-09': 86.75, '10-19': 81.72, 'old': 86.75, 'new': 81.72}
2024-09-07 18:01:44,885 [trainer.py] => CNN top1 curve: [90.54, 84.03]
2024-09-07 18:01:44,885 [trainer.py] => CNN top5 curve: [98.74, 96.81]

Average Accuracy (CNN): 87.28
2024-09-07 18:01:44,885 [trainer.py] => Average Accuracy (CNN): 87.28 

2024-09-07 18:01:44,886 [trainer.py] => All params: 171970192
2024-09-07 18:01:44,888 [trainer.py] => Trainable params: 199880
2024-09-07 18:01:44,888 [l2p.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.858, Train_accy 66.37:   0%|          | 0/20 [00:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.858, Train_accy 66.37:   5%|▌         | 1/20 [00:11<03:39, 11.56s/it]
Task 2, Epoch 2/20 => Loss 0.316, Train_accy 84.78:   5%|▌         | 1/20 [00:23<03:39, 11.56s/it]
Task 2, Epoch 2/20 => Loss 0.316, Train_accy 84.78:  10%|█         | 2/20 [00:23<03:29, 11.62s/it]
Task 2, Epoch 3/20 => Loss 0.228, Train_accy 87.15:  10%|█         | 2/20 [00:34<03:29, 11.62s/it]
Task 2, Epoch 3/20 => Loss 0.228, Train_accy 87.15:  15%|█▌        | 3/20 [00:34<03:17, 11.61s/it]
Task 2, Epoch 4/20 => Loss 0.146, Train_accy 90.26:  15%|█▌        | 3/20 [00:46<03:17, 11.61s/it]
Task 2, Epoch 4/20 => Loss 0.146, Train_accy 90.26:  20%|██        | 4/20 [00:46<03:05, 11.62s/it]
Task 2, Epoch 5/20 => Loss 0.146, Train_accy 89.44, Test_accy 77.96:  20%|██        | 4/20 [01:04<03:05, 11.62s/it]
Task 2, Epoch 5/20 => Loss 0.146, Train_accy 89.44, Test_accy 77.96:  25%|██▌       | 5/20 [01:04<03:28, 13.90s/it]
Task 2, Epoch 6/20 => Loss 0.111, Train_accy 91.08:  25%|██▌       | 5/20 [01:16<03:28, 13.90s/it]                 
Task 2, Epoch 6/20 => Loss 0.111, Train_accy 91.08:  30%|███       | 6/20 [01:16<03:03, 13.14s/it]
Task 2, Epoch 7/20 => Loss 0.084, Train_accy 92.14:  30%|███       | 6/20 [01:27<03:03, 13.14s/it]
Task 2, Epoch 7/20 => Loss 0.084, Train_accy 92.14:  35%|███▌      | 7/20 [01:27<02:44, 12.66s/it]
Task 2, Epoch 8/20 => Loss 0.047, Train_accy 92.47:  35%|███▌      | 7/20 [01:39<02:44, 12.66s/it]
Task 2, Epoch 8/20 => Loss 0.047, Train_accy 92.47:  40%|████      | 8/20 [01:39<02:27, 12.32s/it]
Task 2, Epoch 9/20 => Loss 0.065, Train_accy 93.13:  40%|████      | 8/20 [01:50<02:27, 12.32s/it]
Task 2, Epoch 9/20 => Loss 0.065, Train_accy 93.13:  45%|████▌     | 9/20 [01:50<02:13, 12.10s/it]
Task 2, Epoch 10/20 => Loss 0.096, Train_accy 91.41, Test_accy 79.47:  45%|████▌     | 9/20 [02:08<02:13, 12.10s/it]
Task 2, Epoch 10/20 => Loss 0.096, Train_accy 91.41, Test_accy 79.47:  50%|█████     | 10/20 [02:08<02:19, 13.91s/it]
Task 2, Epoch 11/20 => Loss 0.048, Train_accy 92.72:  50%|█████     | 10/20 [02:20<02:19, 13.91s/it]                 
Task 2, Epoch 11/20 => Loss 0.048, Train_accy 92.72:  55%|█████▌    | 11/20 [02:20<01:58, 13.19s/it]
Task 2, Epoch 12/20 => Loss 0.036, Train_accy 92.72:  55%|█████▌    | 11/20 [02:32<01:58, 13.19s/it]
Task 2, Epoch 12/20 => Loss 0.036, Train_accy 92.72:  60%|██████    | 12/20 [02:32<01:41, 12.70s/it]
Task 2, Epoch 13/20 => Loss 0.030, Train_accy 92.64:  60%|██████    | 12/20 [02:43<01:41, 12.70s/it]
Task 2, Epoch 13/20 => Loss 0.030, Train_accy 92.64:  65%|██████▌   | 13/20 [02:43<01:26, 12.39s/it]
Task 2, Epoch 14/20 => Loss 0.028, Train_accy 92.64:  65%|██████▌   | 13/20 [02:55<01:26, 12.39s/it]
Task 2, Epoch 14/20 => Loss 0.028, Train_accy 92.64:  70%|███████   | 14/20 [02:55<01:12, 12.16s/it]
Task 2, Epoch 15/20 => Loss 0.025, Train_accy 93.37, Test_accy 80.28:  70%|███████   | 14/20 [03:13<01:12, 12.16s/it]
Task 2, Epoch 15/20 => Loss 0.025, Train_accy 93.37, Test_accy 80.28:  75%|███████▌  | 15/20 [03:13<01:09, 13.96s/it]
Task 2, Epoch 16/20 => Loss -0.042, Train_accy 95.58:  75%|███████▌  | 15/20 [03:25<01:09, 13.96s/it]                
Task 2, Epoch 16/20 => Loss -0.042, Train_accy 95.58:  80%|████████  | 16/20 [03:25<00:53, 13.31s/it]
Task 2, Epoch 17/20 => Loss -0.008, Train_accy 94.60:  80%|████████  | 16/20 [03:36<00:53, 13.31s/it]
Task 2, Epoch 17/20 => Loss -0.008, Train_accy 94.60:  85%|████████▌ | 17/20 [03:36<00:38, 12.81s/it]
Task 2, Epoch 18/20 => Loss 0.041, Train_accy 93.54:  85%|████████▌ | 17/20 [03:48<00:38, 12.81s/it] 
Task 2, Epoch 18/20 => Loss 0.041, Train_accy 93.54:  90%|█████████ | 18/20 [03:48<00:24, 12.47s/it]
Task 2, Epoch 19/20 => Loss 0.029, Train_accy 92.96:  90%|█████████ | 18/20 [04:00<00:24, 12.47s/it]
Task 2, Epoch 19/20 => Loss 0.029, Train_accy 92.96:  95%|█████████▌| 19/20 [04:00<00:12, 12.21s/it]
Task 2, Epoch 20/20 => Loss 0.053, Train_accy 93.04, Test_accy 79.47:  95%|█████████▌| 19/20 [04:18<00:12, 12.21s/it]
Task 2, Epoch 20/20 => Loss 0.053, Train_accy 93.04, Test_accy 79.47: 100%|██████████| 20/20 [04:18<00:00, 13.93s/it]
Task 2, Epoch 20/20 => Loss 0.053, Train_accy 93.04, Test_accy 79.47: 100%|██████████| 20/20 [04:18<00:00, 12.91s/it]
2024-09-07 18:06:03,023 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.053, Train_accy 93.04, Test_accy 79.47
2024-09-07 18:06:09,364 [trainer.py] => No NME accuracy.
2024-09-07 18:06:09,364 [trainer.py] => CNN: {'total': 79.47, '00-09': 82.97, '10-19': 80.65, '20-29': 74.33, 'old': 81.71, 'new': 74.33}
2024-09-07 18:06:09,365 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47]
2024-09-07 18:06:09,365 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44]

Average Accuracy (CNN): 84.68
2024-09-07 18:06:09,365 [trainer.py] => Average Accuracy (CNN): 84.68 

2024-09-07 18:06:09,368 [trainer.py] => All params: 171970192
2024-09-07 18:06:09,371 [trainer.py] => Trainable params: 199880
2024-09-07 18:06:09,371 [l2p.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.918, Train_accy 65.00:   0%|          | 0/20 [00:12<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.918, Train_accy 65.00:   5%|▌         | 1/20 [00:12<04:00, 12.67s/it]
Task 3, Epoch 2/20 => Loss 0.275, Train_accy 84.25:   5%|▌         | 1/20 [00:25<04:00, 12.67s/it]
Task 3, Epoch 2/20 => Loss 0.275, Train_accy 84.25:  10%|█         | 2/20 [00:25<03:48, 12.72s/it]
Task 3, Epoch 3/20 => Loss 0.189, Train_accy 86.87:  10%|█         | 2/20 [00:38<03:48, 12.72s/it]
Task 3, Epoch 3/20 => Loss 0.189, Train_accy 86.87:  15%|█▌        | 3/20 [00:38<03:36, 12.71s/it]
Task 3, Epoch 4/20 => Loss 0.163, Train_accy 87.99:  15%|█▌        | 3/20 [00:50<03:36, 12.71s/it]
Task 3, Epoch 4/20 => Loss 0.163, Train_accy 87.99:  20%|██        | 4/20 [00:50<03:23, 12.71s/it]
Task 3, Epoch 5/20 => Loss 0.158, Train_accy 88.51, Test_accy 76.91:  20%|██        | 4/20 [01:11<03:23, 12.71s/it]
Task 3, Epoch 5/20 => Loss 0.158, Train_accy 88.51, Test_accy 76.91:  25%|██▌       | 5/20 [01:11<03:55, 15.70s/it]
Task 3, Epoch 6/20 => Loss 0.119, Train_accy 89.93:  25%|██▌       | 5/20 [01:24<03:55, 15.70s/it]                 
Task 3, Epoch 6/20 => Loss 0.119, Train_accy 89.93:  30%|███       | 6/20 [01:24<03:25, 14.70s/it]
Task 3, Epoch 7/20 => Loss 0.105, Train_accy 89.93:  30%|███       | 6/20 [01:37<03:25, 14.70s/it]
Task 3, Epoch 7/20 => Loss 0.105, Train_accy 89.93:  35%|███▌      | 7/20 [01:37<03:02, 14.04s/it]
Task 3, Epoch 8/20 => Loss 0.061, Train_accy 91.49:  35%|███▌      | 7/20 [01:50<03:02, 14.04s/it]
Task 3, Epoch 8/20 => Loss 0.061, Train_accy 91.49:  40%|████      | 8/20 [01:50<02:43, 13.62s/it]
Task 3, Epoch 9/20 => Loss 0.054, Train_accy 91.72:  40%|████      | 8/20 [02:02<02:43, 13.62s/it]
Task 3, Epoch 9/20 => Loss 0.054, Train_accy 91.72:  45%|████▌     | 9/20 [02:02<02:26, 13.36s/it]
Task 3, Epoch 10/20 => Loss 0.025, Train_accy 92.24, Test_accy 78.50:  45%|████▌     | 9/20 [02:23<02:26, 13.36s/it]
Task 3, Epoch 10/20 => Loss 0.025, Train_accy 92.24, Test_accy 78.50:  50%|█████     | 10/20 [02:23<02:37, 15.77s/it]
Task 3, Epoch 11/20 => Loss 0.024, Train_accy 92.91:  50%|█████     | 10/20 [02:36<02:37, 15.77s/it]                 
Task 3, Epoch 11/20 => Loss 0.024, Train_accy 92.91:  55%|█████▌    | 11/20 [02:36<02:13, 14.83s/it]
Task 3, Epoch 12/20 => Loss 0.016, Train_accy 93.88:  55%|█████▌    | 11/20 [02:49<02:13, 14.83s/it]
Task 3, Epoch 12/20 => Loss 0.016, Train_accy 93.88:  60%|██████    | 12/20 [02:49<01:53, 14.18s/it]
Task 3, Epoch 13/20 => Loss 0.021, Train_accy 93.06:  60%|██████    | 12/20 [03:02<01:53, 14.18s/it]
Task 3, Epoch 13/20 => Loss 0.021, Train_accy 93.06:  65%|██████▌   | 13/20 [03:02<01:36, 13.73s/it]
Task 3, Epoch 14/20 => Loss 0.009, Train_accy 94.10:  65%|██████▌   | 13/20 [03:14<01:36, 13.73s/it]
Task 3, Epoch 14/20 => Loss 0.009, Train_accy 94.10:  70%|███████   | 14/20 [03:14<01:20, 13.42s/it]
Task 3, Epoch 15/20 => Loss 0.021, Train_accy 92.84, Test_accy 78.43:  70%|███████   | 14/20 [03:35<01:20, 13.42s/it]
Task 3, Epoch 15/20 => Loss 0.021, Train_accy 92.84, Test_accy 78.43:  75%|███████▌  | 15/20 [03:35<01:18, 15.70s/it]
Task 3, Epoch 16/20 => Loss 0.030, Train_accy 92.91:  75%|███████▌  | 15/20 [03:48<01:18, 15.70s/it]                 
Task 3, Epoch 16/20 => Loss 0.030, Train_accy 92.91:  80%|████████  | 16/20 [03:48<00:59, 14.80s/it]
Task 3, Epoch 17/20 => Loss 0.025, Train_accy 92.61:  80%|████████  | 16/20 [04:01<00:59, 14.80s/it]
Task 3, Epoch 17/20 => Loss 0.025, Train_accy 92.61:  85%|████████▌ | 17/20 [04:01<00:42, 14.18s/it]
Task 3, Epoch 18/20 => Loss 0.015, Train_accy 94.18:  85%|████████▌ | 17/20 [04:13<00:42, 14.18s/it]
Task 3, Epoch 18/20 => Loss 0.015, Train_accy 94.18:  90%|█████████ | 18/20 [04:13<00:27, 13.75s/it]
Task 3, Epoch 19/20 => Loss 0.004, Train_accy 94.03:  90%|█████████ | 18/20 [04:26<00:27, 13.75s/it]
Task 3, Epoch 19/20 => Loss 0.004, Train_accy 94.03:  95%|█████████▌| 19/20 [04:26<00:13, 13.43s/it]
Task 3, Epoch 20/20 => Loss 0.011, Train_accy 93.58, Test_accy 78.27:  95%|█████████▌| 19/20 [04:47<00:13, 13.43s/it]
Task 3, Epoch 20/20 => Loss 0.011, Train_accy 93.58, Test_accy 78.27: 100%|██████████| 20/20 [04:47<00:00, 15.69s/it]
Task 3, Epoch 20/20 => Loss 0.011, Train_accy 93.58, Test_accy 78.27: 100%|██████████| 20/20 [04:47<00:00, 14.38s/it]
2024-09-07 18:10:56,938 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.011, Train_accy 93.58, Test_accy 78.27
2024-09-07 18:11:05,253 [trainer.py] => No NME accuracy.
2024-09-07 18:11:05,253 [trainer.py] => CNN: {'total': 78.27, '00-09': 81.07, '10-19': 79.03, '20-29': 74.0, '30-39': 78.61, 'old': 78.16, 'new': 78.61}
2024-09-07 18:11:05,253 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27]
2024-09-07 18:11:05,254 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57]

Average Accuracy (CNN): 83.08
2024-09-07 18:11:05,254 [trainer.py] => Average Accuracy (CNN): 83.08 

2024-09-07 18:11:05,257 [trainer.py] => All params: 171970192
2024-09-07 18:11:05,259 [trainer.py] => Trainable params: 199880
2024-09-07 18:11:05,259 [l2p.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.997, Train_accy 60.22:   0%|          | 0/20 [00:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.997, Train_accy 60.22:   5%|▌         | 1/20 [00:10<03:20, 10.54s/it]
Task 4, Epoch 2/20 => Loss 0.370, Train_accy 81.47:   5%|▌         | 1/20 [00:21<03:20, 10.54s/it]
Task 4, Epoch 2/20 => Loss 0.370, Train_accy 81.47:  10%|█         | 2/20 [00:21<03:10, 10.57s/it]
Task 4, Epoch 3/20 => Loss 0.262, Train_accy 86.01:  10%|█         | 2/20 [00:31<03:10, 10.57s/it]
Task 4, Epoch 3/20 => Loss 0.262, Train_accy 86.01:  15%|█▌        | 3/20 [00:31<02:59, 10.55s/it]
Task 4, Epoch 4/20 => Loss 0.237, Train_accy 86.74:  15%|█▌        | 3/20 [00:42<02:59, 10.55s/it]
Task 4, Epoch 4/20 => Loss 0.237, Train_accy 86.74:  20%|██        | 4/20 [00:42<02:48, 10.53s/it]
Task 4, Epoch 5/20 => Loss 0.219, Train_accy 87.74, Test_accy 75.35:  20%|██        | 4/20 [01:02<02:48, 10.53s/it]
Task 4, Epoch 5/20 => Loss 0.219, Train_accy 87.74, Test_accy 75.35:  25%|██▌       | 5/20 [01:02<03:32, 14.17s/it]
Task 4, Epoch 6/20 => Loss 0.108, Train_accy 90.64:  25%|██▌       | 5/20 [01:13<03:32, 14.17s/it]                 
Task 4, Epoch 6/20 => Loss 0.108, Train_accy 90.64:  30%|███       | 6/20 [01:13<03:00, 12.93s/it]
Task 4, Epoch 7/20 => Loss 0.123, Train_accy 90.37:  30%|███       | 6/20 [01:23<03:00, 12.93s/it]
Task 4, Epoch 7/20 => Loss 0.123, Train_accy 90.37:  35%|███▌      | 7/20 [01:23<02:37, 12.12s/it]
Task 4, Epoch 8/20 => Loss 0.134, Train_accy 90.01:  35%|███▌      | 7/20 [01:34<02:37, 12.12s/it]
Task 4, Epoch 8/20 => Loss 0.134, Train_accy 90.01:  40%|████      | 8/20 [01:34<02:19, 11.60s/it]
Task 4, Epoch 9/20 => Loss 0.070, Train_accy 91.92:  40%|████      | 8/20 [01:44<02:19, 11.60s/it]
Task 4, Epoch 9/20 => Loss 0.070, Train_accy 91.92:  45%|████▌     | 9/20 [01:44<02:03, 11.26s/it]
Task 4, Epoch 10/20 => Loss 0.079, Train_accy 92.19, Test_accy 76.65:  45%|████▌     | 9/20 [02:05<02:03, 11.26s/it]
Task 4, Epoch 10/20 => Loss 0.079, Train_accy 92.19, Test_accy 76.65:  50%|█████     | 10/20 [02:05<02:21, 14.14s/it]
Task 4, Epoch 11/20 => Loss 0.044, Train_accy 92.28:  50%|█████     | 10/20 [02:15<02:21, 14.14s/it]                 
Task 4, Epoch 11/20 => Loss 0.044, Train_accy 92.28:  55%|█████▌    | 11/20 [02:15<01:57, 13.02s/it]
Task 4, Epoch 12/20 => Loss 0.045, Train_accy 92.92:  55%|█████▌    | 11/20 [02:26<01:57, 13.02s/it]
Task 4, Epoch 12/20 => Loss 0.045, Train_accy 92.92:  60%|██████    | 12/20 [02:26<01:38, 12.25s/it]
Task 4, Epoch 13/20 => Loss 0.070, Train_accy 92.01:  60%|██████    | 12/20 [02:36<01:38, 12.25s/it]
Task 4, Epoch 13/20 => Loss 0.070, Train_accy 92.01:  65%|██████▌   | 13/20 [02:36<01:22, 11.75s/it]
Task 4, Epoch 14/20 => Loss 0.022, Train_accy 93.10:  65%|██████▌   | 13/20 [02:47<01:22, 11.75s/it]
Task 4, Epoch 14/20 => Loss 0.022, Train_accy 93.10:  70%|███████   | 14/20 [02:47<01:08, 11.37s/it]
Task 4, Epoch 15/20 => Loss 0.058, Train_accy 92.55, Test_accy 76.96:  70%|███████   | 14/20 [03:07<01:08, 11.37s/it]
Task 4, Epoch 15/20 => Loss 0.058, Train_accy 92.55, Test_accy 76.96:  75%|███████▌  | 15/20 [03:07<01:10, 14.15s/it]
Task 4, Epoch 16/20 => Loss 0.056, Train_accy 92.73:  75%|███████▌  | 15/20 [03:18<01:10, 14.15s/it]                 
Task 4, Epoch 16/20 => Loss 0.056, Train_accy 92.73:  80%|████████  | 16/20 [03:18<00:52, 13.05s/it]
Task 4, Epoch 17/20 => Loss 0.025, Train_accy 93.28:  80%|████████  | 16/20 [03:28<00:52, 13.05s/it]
Task 4, Epoch 17/20 => Loss 0.025, Train_accy 93.28:  85%|████████▌ | 17/20 [03:28<00:36, 12.27s/it]
Task 4, Epoch 18/20 => Loss -0.011, Train_accy 94.55:  85%|████████▌ | 17/20 [03:39<00:36, 12.27s/it]
Task 4, Epoch 18/20 => Loss -0.011, Train_accy 94.55:  90%|█████████ | 18/20 [03:39<00:23, 11.74s/it]
Task 4, Epoch 19/20 => Loss 0.049, Train_accy 92.82:  90%|█████████ | 18/20 [03:49<00:23, 11.74s/it] 
Task 4, Epoch 19/20 => Loss 0.049, Train_accy 92.82:  95%|█████████▌| 19/20 [03:49<00:11, 11.38s/it]
Task 4, Epoch 20/20 => Loss 0.011, Train_accy 93.37, Test_accy 76.40:  95%|█████████▌| 19/20 [04:10<00:11, 11.38s/it]
Task 4, Epoch 20/20 => Loss 0.011, Train_accy 93.37, Test_accy 76.40: 100%|██████████| 20/20 [04:10<00:00, 14.13s/it]
Task 4, Epoch 20/20 => Loss 0.011, Train_accy 93.37, Test_accy 76.40: 100%|██████████| 20/20 [04:10<00:00, 12.53s/it]
2024-09-07 18:15:15,813 [l2p.py] => Task 4, Epoch 20/20 => Loss 0.011, Train_accy 93.37, Test_accy 76.40
2024-09-07 18:15:25,959 [trainer.py] => No NME accuracy.
2024-09-07 18:15:25,960 [trainer.py] => CNN: {'total': 76.4, '00-09': 80.13, '10-19': 78.23, '20-29': 74.33, '30-39': 78.31, '40-49': 70.2, 'old': 77.82, 'new': 70.2}
2024-09-07 18:15:25,960 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4]
2024-09-07 18:15:25,960 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56]

Average Accuracy (CNN): 81.74
2024-09-07 18:15:25,960 [trainer.py] => Average Accuracy (CNN): 81.74 

2024-09-07 18:15:25,962 [trainer.py] => All params: 171970192
2024-09-07 18:15:25,964 [trainer.py] => Trainable params: 199880
2024-09-07 18:15:25,964 [l2p.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.859, Train_accy 67.55:   0%|          | 0/20 [00:11<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.859, Train_accy 67.55:   5%|▌         | 1/20 [00:11<03:46, 11.94s/it]
Task 5, Epoch 2/20 => Loss 0.279, Train_accy 84.86:   5%|▌         | 1/20 [00:23<03:46, 11.94s/it]
Task 5, Epoch 2/20 => Loss 0.279, Train_accy 84.86:  10%|█         | 2/20 [00:23<03:33, 11.85s/it]
Task 5, Epoch 3/20 => Loss 0.196, Train_accy 88.16:  10%|█         | 2/20 [00:35<03:33, 11.85s/it]
Task 5, Epoch 3/20 => Loss 0.196, Train_accy 88.16:  15%|█▌        | 3/20 [00:35<03:20, 11.80s/it]
Task 5, Epoch 4/20 => Loss 0.141, Train_accy 89.21:  15%|█▌        | 3/20 [00:47<03:20, 11.80s/it]
Task 5, Epoch 4/20 => Loss 0.141, Train_accy 89.21:  20%|██        | 4/20 [00:47<03:08, 11.80s/it]
Task 5, Epoch 5/20 => Loss 0.098, Train_accy 91.63, Test_accy 74.31:  20%|██        | 4/20 [01:10<03:08, 11.80s/it]
Task 5, Epoch 5/20 => Loss 0.098, Train_accy 91.63, Test_accy 74.31:  25%|██▌       | 5/20 [01:10<04:00, 16.05s/it]
Task 5, Epoch 6/20 => Loss 0.047, Train_accy 93.00:  25%|██▌       | 5/20 [01:22<04:00, 16.05s/it]                 
Task 5, Epoch 6/20 => Loss 0.047, Train_accy 93.00:  30%|███       | 6/20 [01:22<03:24, 14.61s/it]
Task 5, Epoch 7/20 => Loss 0.059, Train_accy 91.79:  30%|███       | 6/20 [01:34<03:24, 14.61s/it]
Task 5, Epoch 7/20 => Loss 0.059, Train_accy 91.79:  35%|███▌      | 7/20 [01:34<02:57, 13.68s/it]
Task 5, Epoch 8/20 => Loss 0.038, Train_accy 93.48:  35%|███▌      | 7/20 [01:46<02:57, 13.68s/it]
Task 5, Epoch 8/20 => Loss 0.038, Train_accy 93.48:  40%|████      | 8/20 [01:46<02:36, 13.08s/it]
Task 5, Epoch 9/20 => Loss 0.074, Train_accy 91.22:  40%|████      | 8/20 [01:58<02:36, 13.08s/it]
Task 5, Epoch 9/20 => Loss 0.074, Train_accy 91.22:  45%|████▌     | 9/20 [01:58<02:19, 12.69s/it]
Task 5, Epoch 10/20 => Loss 0.049, Train_accy 92.67, Test_accy 75.66:  45%|████▌     | 9/20 [02:21<02:19, 12.69s/it]
Task 5, Epoch 10/20 => Loss 0.049, Train_accy 92.67, Test_accy 75.66:  50%|█████     | 10/20 [02:21<02:40, 16.08s/it]
Task 5, Epoch 11/20 => Loss 0.027, Train_accy 93.00:  50%|█████     | 10/20 [02:33<02:40, 16.08s/it]                 
Task 5, Epoch 11/20 => Loss 0.027, Train_accy 93.00:  55%|█████▌    | 11/20 [02:33<02:12, 14.77s/it]
Task 5, Epoch 12/20 => Loss 0.013, Train_accy 93.48:  55%|█████▌    | 11/20 [02:45<02:12, 14.77s/it]
Task 5, Epoch 12/20 => Loss 0.013, Train_accy 93.48:  60%|██████    | 12/20 [02:45<01:50, 13.87s/it]
Task 5, Epoch 13/20 => Loss 0.043, Train_accy 92.35:  60%|██████    | 12/20 [02:57<01:50, 13.87s/it]
Task 5, Epoch 13/20 => Loss 0.043, Train_accy 92.35:  65%|██████▌   | 13/20 [02:57<01:32, 13.25s/it]
Task 5, Epoch 14/20 => Loss 0.029, Train_accy 92.91:  65%|██████▌   | 13/20 [03:08<01:32, 13.25s/it]
Task 5, Epoch 14/20 => Loss 0.029, Train_accy 92.91:  70%|███████   | 14/20 [03:08<01:16, 12.82s/it]
Task 5, Epoch 15/20 => Loss 0.009, Train_accy 93.64, Test_accy 75.92:  70%|███████   | 14/20 [03:32<01:16, 12.82s/it]
Task 5, Epoch 15/20 => Loss 0.009, Train_accy 93.64, Test_accy 75.92:  75%|███████▌  | 15/20 [03:32<01:20, 16.11s/it]
Task 5, Epoch 16/20 => Loss 0.044, Train_accy 92.35:  75%|███████▌  | 15/20 [03:44<01:20, 16.11s/it]                 
Task 5, Epoch 16/20 => Loss 0.044, Train_accy 92.35:  80%|████████  | 16/20 [03:44<00:59, 14.81s/it]
Task 5, Epoch 17/20 => Loss -0.031, Train_accy 94.36:  80%|████████  | 16/20 [03:56<00:59, 14.81s/it]
Task 5, Epoch 17/20 => Loss -0.031, Train_accy 94.36:  85%|████████▌ | 17/20 [03:56<00:42, 14.00s/it]
Task 5, Epoch 18/20 => Loss 0.016, Train_accy 93.08:  85%|████████▌ | 17/20 [04:08<00:42, 14.00s/it] 
Task 5, Epoch 18/20 => Loss 0.016, Train_accy 93.08:  90%|█████████ | 18/20 [04:08<00:26, 13.35s/it]
Task 5, Epoch 19/20 => Loss 0.022, Train_accy 93.40:  90%|█████████ | 18/20 [04:20<00:26, 13.35s/it]
Task 5, Epoch 19/20 => Loss 0.022, Train_accy 93.40:  95%|█████████▌| 19/20 [04:20<00:13, 13.00s/it]
Task 5, Epoch 20/20 => Loss 0.016, Train_accy 94.12, Test_accy 76.13:  95%|█████████▌| 19/20 [04:44<00:13, 13.00s/it]
Task 5, Epoch 20/20 => Loss 0.016, Train_accy 94.12, Test_accy 76.13: 100%|██████████| 20/20 [04:44<00:00, 16.24s/it]
Task 5, Epoch 20/20 => Loss 0.016, Train_accy 94.12, Test_accy 76.13: 100%|██████████| 20/20 [04:44<00:00, 14.22s/it]
2024-09-07 18:20:10,421 [l2p.py] => Task 5, Epoch 20/20 => Loss 0.016, Train_accy 94.12, Test_accy 76.13
2024-09-07 18:20:22,321 [trainer.py] => No NME accuracy.
2024-09-07 18:20:22,321 [trainer.py] => CNN: {'total': 76.13, '00-09': 80.13, '10-19': 78.49, '20-29': 73.0, '30-39': 78.31, '40-49': 70.53, '50-59': 75.33, 'old': 76.28, 'new': 75.33}
2024-09-07 18:20:22,321 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13]
2024-09-07 18:20:22,321 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33]

Average Accuracy (CNN): 80.81
2024-09-07 18:20:22,322 [trainer.py] => Average Accuracy (CNN): 80.81 

2024-09-07 18:20:22,323 [trainer.py] => All params: 171970192
2024-09-07 18:20:22,324 [trainer.py] => Trainable params: 199880
2024-09-07 18:20:22,325 [l2p.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.920, Train_accy 65.23:   0%|          | 0/20 [00:11<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.920, Train_accy 65.23:   5%|▌         | 1/20 [00:11<03:38, 11.50s/it]
Task 6, Epoch 2/20 => Loss 0.287, Train_accy 85.76:   5%|▌         | 1/20 [00:23<03:38, 11.50s/it]
Task 6, Epoch 2/20 => Loss 0.287, Train_accy 85.76:  10%|█         | 2/20 [00:23<03:27, 11.50s/it]
Task 6, Epoch 3/20 => Loss 0.206, Train_accy 86.42:  10%|█         | 2/20 [00:34<03:27, 11.50s/it]
Task 6, Epoch 3/20 => Loss 0.206, Train_accy 86.42:  15%|█▌        | 3/20 [00:34<03:15, 11.50s/it]
Task 6, Epoch 4/20 => Loss 0.166, Train_accy 88.00:  15%|█▌        | 3/20 [00:46<03:15, 11.50s/it]
Task 6, Epoch 4/20 => Loss 0.166, Train_accy 88.00:  20%|██        | 4/20 [00:46<03:04, 11.51s/it]
Task 6, Epoch 5/20 => Loss 0.101, Train_accy 90.15, Test_accy 74.43:  20%|██        | 4/20 [01:11<03:04, 11.51s/it]
Task 6, Epoch 5/20 => Loss 0.101, Train_accy 90.15, Test_accy 74.43:  25%|██▌       | 5/20 [01:11<04:06, 16.44s/it]
Task 6, Epoch 6/20 => Loss 0.100, Train_accy 90.81:  25%|██▌       | 5/20 [01:22<04:06, 16.44s/it]                 
Task 6, Epoch 6/20 => Loss 0.100, Train_accy 90.81:  30%|███       | 6/20 [01:22<03:26, 14.78s/it]
Task 6, Epoch 7/20 => Loss 0.123, Train_accy 89.65:  30%|███       | 6/20 [01:34<03:26, 14.78s/it]
Task 6, Epoch 7/20 => Loss 0.123, Train_accy 89.65:  35%|███▌      | 7/20 [01:34<02:57, 13.69s/it]
Task 6, Epoch 8/20 => Loss 0.099, Train_accy 91.23:  35%|███▌      | 7/20 [01:45<02:57, 13.69s/it]
Task 6, Epoch 8/20 => Loss 0.099, Train_accy 91.23:  40%|████      | 8/20 [01:45<02:35, 12.97s/it]
Task 6, Epoch 9/20 => Loss 0.052, Train_accy 93.21:  40%|████      | 8/20 [01:57<02:35, 12.97s/it]
Task 6, Epoch 9/20 => Loss 0.052, Train_accy 93.21:  45%|████▌     | 9/20 [01:57<02:17, 12.51s/it]
Task 6, Epoch 10/20 => Loss 0.099, Train_accy 90.23, Test_accy 74.52:  45%|████▌     | 9/20 [02:22<02:17, 12.51s/it]
Task 6, Epoch 10/20 => Loss 0.099, Train_accy 90.23, Test_accy 74.52:  50%|█████     | 10/20 [02:22<02:44, 16.43s/it]
Task 6, Epoch 11/20 => Loss 0.034, Train_accy 93.13:  50%|█████     | 10/20 [02:33<02:44, 16.43s/it]                 
Task 6, Epoch 11/20 => Loss 0.034, Train_accy 93.13:  55%|█████▌    | 11/20 [02:33<02:14, 14.92s/it]
Task 6, Epoch 12/20 => Loss 0.055, Train_accy 91.80:  55%|█████▌    | 11/20 [02:45<02:14, 14.92s/it]
Task 6, Epoch 12/20 => Loss 0.055, Train_accy 91.80:  60%|██████    | 12/20 [02:45<01:50, 13.87s/it]
Task 6, Epoch 13/20 => Loss 0.069, Train_accy 91.97:  60%|██████    | 12/20 [02:56<01:50, 13.87s/it]
Task 6, Epoch 13/20 => Loss 0.069, Train_accy 91.97:  65%|██████▌   | 13/20 [02:56<01:31, 13.14s/it]
Task 6, Epoch 14/20 => Loss 0.008, Train_accy 93.46:  65%|██████▌   | 13/20 [03:08<01:31, 13.14s/it]
Task 6, Epoch 14/20 => Loss 0.008, Train_accy 93.46:  70%|███████   | 14/20 [03:08<01:16, 12.68s/it]
Task 6, Epoch 15/20 => Loss 0.011, Train_accy 93.46, Test_accy 75.01:  70%|███████   | 14/20 [03:33<01:16, 12.68s/it]
Task 6, Epoch 15/20 => Loss 0.011, Train_accy 93.46, Test_accy 75.01:  75%|███████▌  | 15/20 [03:33<01:22, 16.46s/it]
Task 6, Epoch 16/20 => Loss 0.060, Train_accy 92.30:  75%|███████▌  | 15/20 [03:45<01:22, 16.46s/it]                 
Task 6, Epoch 16/20 => Loss 0.060, Train_accy 92.30:  80%|████████  | 16/20 [03:45<00:59, 14.96s/it]
Task 6, Epoch 17/20 => Loss 0.026, Train_accy 92.63:  80%|████████  | 16/20 [03:56<00:59, 14.96s/it]
Task 6, Epoch 17/20 => Loss 0.026, Train_accy 92.63:  85%|████████▌ | 17/20 [03:56<00:41, 13.92s/it]
Task 6, Epoch 18/20 => Loss 0.032, Train_accy 92.80:  85%|████████▌ | 17/20 [04:08<00:41, 13.92s/it]
Task 6, Epoch 18/20 => Loss 0.032, Train_accy 92.80:  90%|█████████ | 18/20 [04:08<00:26, 13.19s/it]
Task 6, Epoch 19/20 => Loss 0.014, Train_accy 93.38:  90%|█████████ | 18/20 [04:19<00:26, 13.19s/it]
Task 6, Epoch 19/20 => Loss 0.014, Train_accy 93.38:  95%|█████████▌| 19/20 [04:19<00:12, 12.69s/it]
Task 6, Epoch 20/20 => Loss -0.001, Train_accy 93.29, Test_accy 75.10:  95%|█████████▌| 19/20 [04:45<00:12, 12.69s/it]
Task 6, Epoch 20/20 => Loss -0.001, Train_accy 93.29, Test_accy 75.10: 100%|██████████| 20/20 [04:45<00:00, 16.51s/it]
Task 6, Epoch 20/20 => Loss -0.001, Train_accy 93.29, Test_accy 75.10: 100%|██████████| 20/20 [04:45<00:00, 14.25s/it]
2024-09-07 18:25:07,356 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.001, Train_accy 93.29, Test_accy 75.10
2024-09-07 18:25:20,994 [trainer.py] => No NME accuracy.
2024-09-07 18:25:20,995 [trainer.py] => CNN: {'total': 75.1, '00-09': 78.23, '10-19': 77.96, '20-29': 72.67, '30-39': 77.71, '40-49': 69.87, '50-59': 75.99, '60-69': 72.15, 'old': 75.56, 'new': 72.15}
2024-09-07 18:25:20,995 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1]
2024-09-07 18:25:20,995 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1]

Average Accuracy (CNN): 79.99
2024-09-07 18:25:20,995 [trainer.py] => Average Accuracy (CNN): 79.99 

2024-09-07 18:25:20,999 [trainer.py] => All params: 171970192
2024-09-07 18:25:21,002 [trainer.py] => Trainable params: 199880
2024-09-07 18:25:21,002 [l2p.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.943, Train_accy 65.07:   0%|          | 0/20 [00:10<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.943, Train_accy 65.07:   5%|▌         | 1/20 [00:10<03:16, 10.35s/it]
Task 7, Epoch 2/20 => Loss 0.252, Train_accy 86.08:   5%|▌         | 1/20 [00:20<03:16, 10.35s/it]
Task 7, Epoch 2/20 => Loss 0.252, Train_accy 86.08:  10%|█         | 2/20 [00:20<03:06, 10.36s/it]
Task 7, Epoch 3/20 => Loss 0.103, Train_accy 90.69:  10%|█         | 2/20 [00:31<03:06, 10.36s/it]
Task 7, Epoch 3/20 => Loss 0.103, Train_accy 90.69:  15%|█▌        | 3/20 [00:31<02:56, 10.35s/it]
Task 7, Epoch 4/20 => Loss 0.101, Train_accy 90.78:  15%|█▌        | 3/20 [00:41<02:56, 10.35s/it]
Task 7, Epoch 4/20 => Loss 0.101, Train_accy 90.78:  20%|██        | 4/20 [00:41<02:45, 10.36s/it]
Task 7, Epoch 5/20 => Loss 0.066, Train_accy 92.63, Test_accy 73.58:  20%|██        | 4/20 [01:06<02:45, 10.36s/it]
Task 7, Epoch 5/20 => Loss 0.066, Train_accy 92.63, Test_accy 73.58:  25%|██▌       | 5/20 [01:06<03:57, 15.83s/it]
Task 7, Epoch 6/20 => Loss 0.060, Train_accy 91.71:  25%|██▌       | 5/20 [01:17<03:57, 15.83s/it]                 
Task 7, Epoch 6/20 => Loss 0.060, Train_accy 91.71:  30%|███       | 6/20 [01:17<03:15, 13.97s/it]
Task 7, Epoch 7/20 => Loss 0.020, Train_accy 93.55:  30%|███       | 6/20 [01:27<03:15, 13.97s/it]
Task 7, Epoch 7/20 => Loss 0.020, Train_accy 93.55:  35%|███▌      | 7/20 [01:27<02:46, 12.80s/it]
Task 7, Epoch 8/20 => Loss 0.007, Train_accy 94.65:  35%|███▌      | 7/20 [01:38<02:46, 12.80s/it]
Task 7, Epoch 8/20 => Loss 0.007, Train_accy 94.65:  40%|████      | 8/20 [01:38<02:24, 12.03s/it]
Task 7, Epoch 9/20 => Loss -0.003, Train_accy 95.02:  40%|████      | 8/20 [01:48<02:24, 12.03s/it]
Task 7, Epoch 9/20 => Loss -0.003, Train_accy 95.02:  45%|████▌     | 9/20 [01:48<02:06, 11.52s/it]
Task 7, Epoch 10/20 => Loss 0.015, Train_accy 93.36, Test_accy 74.10:  45%|████▌     | 9/20 [02:14<02:06, 11.52s/it]
Task 7, Epoch 10/20 => Loss 0.015, Train_accy 93.36, Test_accy 74.10:  50%|█████     | 10/20 [02:14<02:38, 15.86s/it]
Task 7, Epoch 11/20 => Loss 0.023, Train_accy 94.10:  50%|█████     | 10/20 [02:24<02:38, 15.86s/it]                 
Task 7, Epoch 11/20 => Loss 0.023, Train_accy 94.10:  55%|█████▌    | 11/20 [02:24<02:07, 14.17s/it]
Task 7, Epoch 12/20 => Loss -0.030, Train_accy 95.67:  55%|█████▌    | 11/20 [02:34<02:07, 14.17s/it]
Task 7, Epoch 12/20 => Loss -0.030, Train_accy 95.67:  60%|██████    | 12/20 [02:34<01:44, 13.01s/it]
Task 7, Epoch 13/20 => Loss 0.045, Train_accy 93.73:  60%|██████    | 12/20 [02:45<01:44, 13.01s/it] 
Task 7, Epoch 13/20 => Loss 0.045, Train_accy 93.73:  65%|██████▌   | 13/20 [02:45<01:25, 12.21s/it]
Task 7, Epoch 14/20 => Loss 0.015, Train_accy 93.55:  65%|██████▌   | 13/20 [02:55<01:25, 12.21s/it]
Task 7, Epoch 14/20 => Loss 0.015, Train_accy 93.55:  70%|███████   | 14/20 [02:55<01:09, 11.63s/it]
Task 7, Epoch 15/20 => Loss -0.028, Train_accy 95.30, Test_accy 74.50:  70%|███████   | 14/20 [03:21<01:09, 11.63s/it]
Task 7, Epoch 15/20 => Loss -0.028, Train_accy 95.30, Test_accy 74.50:  75%|███████▌  | 15/20 [03:21<01:19, 15.86s/it]
Task 7, Epoch 16/20 => Loss -0.014, Train_accy 94.56:  75%|███████▌  | 15/20 [03:31<01:19, 15.86s/it]                 
Task 7, Epoch 16/20 => Loss -0.014, Train_accy 94.56:  80%|████████  | 16/20 [03:31<00:56, 14.21s/it]
Task 7, Epoch 17/20 => Loss -0.062, Train_accy 96.04:  80%|████████  | 16/20 [03:41<00:56, 14.21s/it]
Task 7, Epoch 17/20 => Loss -0.062, Train_accy 96.04:  85%|████████▌ | 17/20 [03:41<00:39, 13.05s/it]
Task 7, Epoch 18/20 => Loss 0.012, Train_accy 94.56:  85%|████████▌ | 17/20 [03:52<00:39, 13.05s/it] 
Task 7, Epoch 18/20 => Loss 0.012, Train_accy 94.56:  90%|█████████ | 18/20 [03:52<00:24, 12.25s/it]
Task 7, Epoch 19/20 => Loss -0.023, Train_accy 95.30:  90%|█████████ | 18/20 [04:02<00:24, 12.25s/it]
Task 7, Epoch 19/20 => Loss -0.023, Train_accy 95.30:  95%|█████████▌| 19/20 [04:02<00:11, 11.69s/it]
Task 7, Epoch 20/20 => Loss -0.049, Train_accy 95.67, Test_accy 74.62:  95%|█████████▌| 19/20 [04:28<00:11, 11.69s/it]
Task 7, Epoch 20/20 => Loss -0.049, Train_accy 95.67, Test_accy 74.62: 100%|██████████| 20/20 [04:28<00:00, 15.86s/it]
Task 7, Epoch 20/20 => Loss -0.049, Train_accy 95.67, Test_accy 74.62: 100%|██████████| 20/20 [04:28<00:00, 13.41s/it]
2024-09-07 18:29:49,178 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.049, Train_accy 95.67, Test_accy 74.62
2024-09-07 18:30:04,578 [trainer.py] => No NME accuracy.
2024-09-07 18:30:04,579 [trainer.py] => CNN: {'total': 74.62, '00-09': 76.97, '10-19': 79.03, '20-29': 72.0, '30-39': 78.31, '40-49': 68.87, '50-59': 75.99, '60-69': 72.48, '70-79': 71.43, 'old': 75.01, 'new': 71.43}
2024-09-07 18:30:04,579 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62]
2024-09-07 18:30:04,579 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83]

Average Accuracy (CNN): 79.32
2024-09-07 18:30:04,579 [trainer.py] => Average Accuracy (CNN): 79.32 

2024-09-07 18:30:04,582 [trainer.py] => All params: 171970192
2024-09-07 18:30:04,585 [trainer.py] => Trainable params: 199880
2024-09-07 18:30:04,585 [l2p.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.832, Train_accy 67.44:   0%|          | 0/20 [00:13<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.832, Train_accy 67.44:   5%|▌         | 1/20 [00:13<04:14, 13.39s/it]
Task 8, Epoch 2/20 => Loss 0.267, Train_accy 85.81:   5%|▌         | 1/20 [00:26<04:14, 13.39s/it]
Task 8, Epoch 2/20 => Loss 0.267, Train_accy 85.81:  10%|█         | 2/20 [00:26<04:00, 13.37s/it]
Task 8, Epoch 3/20 => Loss 0.240, Train_accy 87.08:  10%|█         | 2/20 [00:40<04:00, 13.37s/it]
Task 8, Epoch 3/20 => Loss 0.240, Train_accy 87.08:  15%|█▌        | 3/20 [00:40<03:47, 13.37s/it]
Task 8, Epoch 4/20 => Loss 0.146, Train_accy 89.41:  15%|█▌        | 3/20 [00:53<03:47, 13.37s/it]
Task 8, Epoch 4/20 => Loss 0.146, Train_accy 89.41:  20%|██        | 4/20 [00:53<03:33, 13.35s/it]
Task 8, Epoch 5/20 => Loss 0.113, Train_accy 90.25, Test_accy 72.47:  20%|██        | 4/20 [01:23<03:33, 13.35s/it]
Task 8, Epoch 5/20 => Loss 0.113, Train_accy 90.25, Test_accy 72.47:  25%|██▌       | 5/20 [01:23<04:52, 19.53s/it]
Task 8, Epoch 6/20 => Loss 0.080, Train_accy 92.09:  25%|██▌       | 5/20 [01:37<04:52, 19.53s/it]                 
Task 8, Epoch 6/20 => Loss 0.080, Train_accy 92.09:  30%|███       | 6/20 [01:37<04:04, 17.44s/it]
Task 8, Epoch 7/20 => Loss 0.092, Train_accy 91.88:  30%|███       | 6/20 [01:50<04:04, 17.44s/it]
Task 8, Epoch 7/20 => Loss 0.092, Train_accy 91.88:  35%|███▌      | 7/20 [01:50<03:29, 16.12s/it]
Task 8, Epoch 8/20 => Loss 0.081, Train_accy 91.60:  35%|███▌      | 7/20 [02:04<03:29, 16.12s/it]
Task 8, Epoch 8/20 => Loss 0.081, Train_accy 91.60:  40%|████      | 8/20 [02:04<03:02, 15.24s/it]
Task 8, Epoch 9/20 => Loss 0.025, Train_accy 92.73:  40%|████      | 8/20 [02:17<03:02, 15.24s/it]
Task 8, Epoch 9/20 => Loss 0.025, Train_accy 92.73:  45%|████▌     | 9/20 [02:17<02:41, 14.67s/it]
Task 8, Epoch 10/20 => Loss 0.054, Train_accy 92.23, Test_accy 72.79:  45%|████▌     | 9/20 [02:47<02:41, 14.67s/it]
Task 8, Epoch 10/20 => Loss 0.054, Train_accy 92.23, Test_accy 72.79:  50%|█████     | 10/20 [02:47<03:15, 19.54s/it]
Task 8, Epoch 11/20 => Loss 0.045, Train_accy 92.37:  50%|█████     | 10/20 [03:01<03:15, 19.54s/it]                 
Task 8, Epoch 11/20 => Loss 0.045, Train_accy 92.37:  55%|█████▌    | 11/20 [03:01<02:38, 17.65s/it]
Task 8, Epoch 12/20 => Loss 0.022, Train_accy 93.43:  55%|█████▌    | 11/20 [03:14<02:38, 17.65s/it]
Task 8, Epoch 12/20 => Loss 0.022, Train_accy 93.43:  60%|██████    | 12/20 [03:14<02:10, 16.35s/it]
Task 8, Epoch 13/20 => Loss 0.061, Train_accy 92.09:  60%|██████    | 12/20 [03:27<02:10, 16.35s/it]
Task 8, Epoch 13/20 => Loss 0.061, Train_accy 92.09:  65%|██████▌   | 13/20 [03:27<01:48, 15.43s/it]
Task 8, Epoch 14/20 => Loss 0.026, Train_accy 93.43:  65%|██████▌   | 13/20 [03:41<01:48, 15.43s/it]
Task 8, Epoch 14/20 => Loss 0.026, Train_accy 93.43:  70%|███████   | 14/20 [03:41<01:28, 14.81s/it]
Task 8, Epoch 15/20 => Loss 0.006, Train_accy 93.29, Test_accy 73.15:  70%|███████   | 14/20 [04:11<01:28, 14.81s/it]
Task 8, Epoch 15/20 => Loss 0.006, Train_accy 93.29, Test_accy 73.15:  75%|███████▌  | 15/20 [04:11<01:37, 19.54s/it]
Task 8, Epoch 16/20 => Loss 0.038, Train_accy 93.22:  75%|███████▌  | 15/20 [04:25<01:37, 19.54s/it]                 
Task 8, Epoch 16/20 => Loss 0.038, Train_accy 93.22:  80%|████████  | 16/20 [04:25<01:10, 17.68s/it]
Task 8, Epoch 17/20 => Loss 0.042, Train_accy 93.08:  80%|████████  | 16/20 [04:38<01:10, 17.68s/it]
Task 8, Epoch 17/20 => Loss 0.042, Train_accy 93.08:  85%|████████▌ | 17/20 [04:38<00:49, 16.39s/it]
Task 8, Epoch 18/20 => Loss 0.003, Train_accy 94.56:  85%|████████▌ | 17/20 [04:51<00:49, 16.39s/it]
Task 8, Epoch 18/20 => Loss 0.003, Train_accy 94.56:  90%|█████████ | 18/20 [04:51<00:30, 15.47s/it]
Task 8, Epoch 19/20 => Loss 0.014, Train_accy 93.57:  90%|█████████ | 18/20 [05:05<00:30, 15.47s/it]
Task 8, Epoch 19/20 => Loss 0.014, Train_accy 93.57:  95%|█████████▌| 19/20 [05:05<00:14, 14.85s/it]
Task 8, Epoch 20/20 => Loss 0.028, Train_accy 93.50, Test_accy 73.29:  95%|█████████▌| 19/20 [05:35<00:14, 14.85s/it]
Task 8, Epoch 20/20 => Loss 0.028, Train_accy 93.50, Test_accy 73.29: 100%|██████████| 20/20 [05:35<00:00, 19.54s/it]
Task 8, Epoch 20/20 => Loss 0.028, Train_accy 93.50, Test_accy 73.29: 100%|██████████| 20/20 [05:35<00:00, 16.79s/it]
2024-09-07 18:35:40,426 [l2p.py] => Task 8, Epoch 20/20 => Loss 0.028, Train_accy 93.50, Test_accy 73.29
2024-09-07 18:35:57,423 [trainer.py] => No NME accuracy.
2024-09-07 18:35:57,424 [trainer.py] => CNN: {'total': 73.29, '00-09': 76.66, '10-19': 77.96, '20-29': 72.67, '30-39': 76.51, '40-49': 68.21, '50-59': 74.34, '60-69': 72.48, '70-79': 71.43, '80-89': 67.74, 'old': 73.98, 'new': 67.74}
2024-09-07 18:35:57,424 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29]
2024-09-07 18:35:57,424 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74]

Average Accuracy (CNN): 78.65
2024-09-07 18:35:57,425 [trainer.py] => Average Accuracy (CNN): 78.65 

2024-09-07 18:35:57,428 [trainer.py] => All params: 171970192
2024-09-07 18:35:57,429 [trainer.py] => Trainable params: 199880
2024-09-07 18:35:57,430 [l2p.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.186, Train_accy 56.65:   0%|          | 0/20 [00:07<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.186, Train_accy 56.65:   5%|▌         | 1/20 [00:07<02:20,  7.38s/it]
Task 9, Epoch 2/20 => Loss 0.243, Train_accy 87.22:   5%|▌         | 1/20 [00:14<02:20,  7.38s/it]
Task 9, Epoch 2/20 => Loss 0.243, Train_accy 87.22:  10%|█         | 2/20 [00:14<02:12,  7.35s/it]
Task 9, Epoch 3/20 => Loss 0.175, Train_accy 88.54:  10%|█         | 2/20 [00:22<02:12,  7.35s/it]
Task 9, Epoch 3/20 => Loss 0.175, Train_accy 88.54:  15%|█▌        | 3/20 [00:22<02:05,  7.36s/it]
Task 9, Epoch 4/20 => Loss 0.125, Train_accy 90.38:  15%|█▌        | 3/20 [00:29<02:05,  7.36s/it]
Task 9, Epoch 4/20 => Loss 0.125, Train_accy 90.38:  20%|██        | 4/20 [00:29<01:57,  7.37s/it]
Task 9, Epoch 5/20 => Loss 0.132, Train_accy 89.99, Test_accy 72.50:  20%|██        | 4/20 [00:55<01:57,  7.37s/it]
Task 9, Epoch 5/20 => Loss 0.132, Train_accy 89.99, Test_accy 72.50:  25%|██▌       | 5/20 [00:55<03:28, 13.92s/it]
Task 9, Epoch 6/20 => Loss 0.132, Train_accy 90.65:  25%|██▌       | 5/20 [01:02<03:28, 13.92s/it]                 
Task 9, Epoch 6/20 => Loss 0.132, Train_accy 90.65:  30%|███       | 6/20 [01:02<02:43, 11.70s/it]
Task 9, Epoch 7/20 => Loss 0.101, Train_accy 91.17:  30%|███       | 6/20 [01:09<02:43, 11.70s/it]
Task 9, Epoch 7/20 => Loss 0.101, Train_accy 91.17:  35%|███▌      | 7/20 [01:09<02:13, 10.29s/it]
Task 9, Epoch 8/20 => Loss 0.059, Train_accy 92.09:  35%|███▌      | 7/20 [01:17<02:13, 10.29s/it]
Task 9, Epoch 8/20 => Loss 0.059, Train_accy 92.09:  40%|████      | 8/20 [01:17<01:52,  9.37s/it]
Task 9, Epoch 9/20 => Loss -0.013, Train_accy 94.73:  40%|████      | 8/20 [01:24<01:52,  9.37s/it]
Task 9, Epoch 9/20 => Loss -0.013, Train_accy 94.73:  45%|████▌     | 9/20 [01:24<01:36,  8.75s/it]
Task 9, Epoch 10/20 => Loss 0.048, Train_accy 93.15, Test_accy 72.80:  45%|████▌     | 9/20 [01:50<01:36,  8.75s/it]
Task 9, Epoch 10/20 => Loss 0.048, Train_accy 93.15, Test_accy 72.80:  50%|█████     | 10/20 [01:50<02:19, 13.95s/it]
Task 9, Epoch 11/20 => Loss 0.019, Train_accy 93.28:  50%|█████     | 10/20 [01:57<02:19, 13.95s/it]                 
Task 9, Epoch 11/20 => Loss 0.019, Train_accy 93.28:  55%|█████▌    | 11/20 [01:57<01:47, 11.94s/it]
Task 9, Epoch 12/20 => Loss 0.058, Train_accy 92.49:  55%|█████▌    | 11/20 [02:04<01:47, 11.94s/it]
Task 9, Epoch 12/20 => Loss 0.058, Train_accy 92.49:  60%|██████    | 12/20 [02:04<01:24, 10.55s/it]
Task 9, Epoch 13/20 => Loss 0.028, Train_accy 93.41:  60%|██████    | 12/20 [02:12<01:24, 10.55s/it]
Task 9, Epoch 13/20 => Loss 0.028, Train_accy 93.41:  65%|██████▌   | 13/20 [02:12<01:07,  9.61s/it]
Task 9, Epoch 14/20 => Loss -0.016, Train_accy 94.47:  65%|██████▌   | 13/20 [02:19<01:07,  9.61s/it]
Task 9, Epoch 14/20 => Loss -0.016, Train_accy 94.47:  70%|███████   | 14/20 [02:19<00:53,  8.93s/it]
Task 9, Epoch 15/20 => Loss 0.011, Train_accy 93.94, Test_accy 72.56:  70%|███████   | 14/20 [02:45<00:53,  8.93s/it]
Task 9, Epoch 15/20 => Loss 0.011, Train_accy 93.94, Test_accy 72.56:  75%|███████▌  | 15/20 [02:45<01:09, 13.94s/it]
Task 9, Epoch 16/20 => Loss 0.037, Train_accy 93.28:  75%|███████▌  | 15/20 [02:52<01:09, 13.94s/it]                 
Task 9, Epoch 16/20 => Loss 0.037, Train_accy 93.28:  80%|████████  | 16/20 [02:52<00:47, 11.97s/it]
Task 9, Epoch 17/20 => Loss 0.011, Train_accy 93.54:  80%|████████  | 16/20 [03:00<00:47, 11.97s/it]
Task 9, Epoch 17/20 => Loss 0.011, Train_accy 93.54:  85%|████████▌ | 17/20 [03:00<00:31, 10.60s/it]
Task 9, Epoch 18/20 => Loss 0.011, Train_accy 93.28:  85%|████████▌ | 17/20 [03:07<00:31, 10.60s/it]
Task 9, Epoch 18/20 => Loss 0.011, Train_accy 93.28:  90%|█████████ | 18/20 [03:07<00:19,  9.64s/it]
Task 9, Epoch 19/20 => Loss 0.014, Train_accy 93.54:  90%|█████████ | 18/20 [03:14<00:19,  9.64s/it]
Task 9, Epoch 19/20 => Loss 0.014, Train_accy 93.54:  95%|█████████▌| 19/20 [03:14<00:08,  8.95s/it]
Task 9, Epoch 20/20 => Loss -0.026, Train_accy 94.60, Test_accy 72.70:  95%|█████████▌| 19/20 [03:40<00:08,  8.95s/it]
Task 9, Epoch 20/20 => Loss -0.026, Train_accy 94.60, Test_accy 72.70: 100%|██████████| 20/20 [03:40<00:00, 13.90s/it]
Task 9, Epoch 20/20 => Loss -0.026, Train_accy 94.60, Test_accy 72.70: 100%|██████████| 20/20 [03:40<00:00, 11.01s/it]
2024-09-07 18:39:37,722 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.026, Train_accy 94.60, Test_accy 72.70
2024-09-07 18:39:55,943 [trainer.py] => No NME accuracy.
2024-09-07 18:39:55,943 [trainer.py] => CNN: {'total': 72.7, '00-09': 76.97, '10-19': 77.96, '20-29': 73.67, '30-39': 77.11, '40-49': 68.87, '50-59': 75.0, '60-69': 71.81, '70-79': 69.6, '80-89': 68.39, '90-99': 60.45, 'old': 73.47, 'new': 60.45}
2024-09-07 18:39:55,943 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7]
2024-09-07 18:39:55,943 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21]

Average Accuracy (CNN): 78.06
2024-09-07 18:39:55,943 [trainer.py] => Average Accuracy (CNN): 78.06 

2024-09-07 18:39:55,944 [trainer.py] => All params: 171970192
2024-09-07 18:39:55,945 [trainer.py] => Trainable params: 199880
2024-09-07 18:39:55,945 [l2p.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.870, Train_accy 65.98:   0%|          | 0/20 [00:11<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.870, Train_accy 65.98:   5%|▌         | 1/20 [00:11<03:30, 11.10s/it]
Task 10, Epoch 2/20 => Loss 0.210, Train_accy 86.24:   5%|▌         | 1/20 [00:22<03:30, 11.10s/it]
Task 10, Epoch 2/20 => Loss 0.210, Train_accy 86.24:  10%|█         | 2/20 [00:22<03:20, 11.13s/it]
Task 10, Epoch 3/20 => Loss 0.110, Train_accy 90.26:  10%|█         | 2/20 [00:33<03:20, 11.13s/it]
Task 10, Epoch 3/20 => Loss 0.110, Train_accy 90.26:  15%|█▌        | 3/20 [00:33<03:08, 11.11s/it]
Task 10, Epoch 4/20 => Loss 0.070, Train_accy 92.31:  15%|█▌        | 3/20 [00:44<03:08, 11.11s/it]
Task 10, Epoch 4/20 => Loss 0.070, Train_accy 92.31:  20%|██        | 4/20 [00:44<02:57, 11.12s/it]
Task 10, Epoch 5/20 => Loss 0.066, Train_accy 92.31, Test_accy 71.55:  20%|██        | 4/20 [01:15<02:57, 11.12s/it]
Task 10, Epoch 5/20 => Loss 0.066, Train_accy 92.31, Test_accy 71.55:  25%|██▌       | 5/20 [01:15<04:35, 18.35s/it]
Task 10, Epoch 6/20 => Loss 0.010, Train_accy 93.50:  25%|██▌       | 5/20 [01:26<04:35, 18.35s/it]                 
Task 10, Epoch 6/20 => Loss 0.010, Train_accy 93.50:  30%|███       | 6/20 [01:26<03:42, 15.92s/it]
Task 10, Epoch 7/20 => Loss -0.028, Train_accy 96.24:  30%|███       | 6/20 [01:38<03:42, 15.92s/it]
Task 10, Epoch 7/20 => Loss -0.028, Train_accy 96.24:  35%|███▌      | 7/20 [01:38<03:07, 14.41s/it]
Task 10, Epoch 8/20 => Loss 0.012, Train_accy 94.10:  35%|███▌      | 7/20 [01:49<03:07, 14.41s/it] 
Task 10, Epoch 8/20 => Loss 0.012, Train_accy 94.10:  40%|████      | 8/20 [01:49<02:40, 13.39s/it]
Task 10, Epoch 9/20 => Loss 0.023, Train_accy 92.56:  40%|████      | 8/20 [02:00<02:40, 13.39s/it]
Task 10, Epoch 9/20 => Loss 0.023, Train_accy 92.56:  45%|████▌     | 9/20 [02:00<02:19, 12.71s/it]
Task 10, Epoch 10/20 => Loss 0.049, Train_accy 93.25, Test_accy 71.83:  45%|████▌     | 9/20 [02:31<02:19, 12.71s/it]
Task 10, Epoch 10/20 => Loss 0.049, Train_accy 93.25, Test_accy 71.83:  50%|█████     | 10/20 [02:31<03:03, 18.38s/it]
Task 10, Epoch 11/20 => Loss 0.006, Train_accy 94.27:  50%|█████     | 10/20 [02:42<03:03, 18.38s/it]                 
Task 10, Epoch 11/20 => Loss 0.006, Train_accy 94.27:  55%|█████▌    | 11/20 [02:42<02:25, 16.18s/it]
Task 10, Epoch 12/20 => Loss 0.019, Train_accy 93.85:  55%|█████▌    | 11/20 [02:54<02:25, 16.18s/it]
Task 10, Epoch 12/20 => Loss 0.019, Train_accy 93.85:  60%|██████    | 12/20 [02:54<01:57, 14.67s/it]
Task 10, Epoch 13/20 => Loss -0.006, Train_accy 94.27:  60%|██████    | 12/20 [03:05<01:57, 14.67s/it]
Task 10, Epoch 13/20 => Loss -0.006, Train_accy 94.27:  65%|██████▌   | 13/20 [03:05<01:35, 13.61s/it]
Task 10, Epoch 14/20 => Loss -0.041, Train_accy 95.38:  65%|██████▌   | 13/20 [03:16<01:35, 13.61s/it]
Task 10, Epoch 14/20 => Loss -0.041, Train_accy 95.38:  70%|███████   | 14/20 [03:16<01:17, 12.88s/it]
Task 10, Epoch 15/20 => Loss -0.006, Train_accy 94.44, Test_accy 71.80:  70%|███████   | 14/20 [03:47<01:17, 12.88s/it]
Task 10, Epoch 15/20 => Loss -0.006, Train_accy 94.44, Test_accy 71.80:  75%|███████▌  | 15/20 [03:47<01:31, 18.33s/it]
Task 10, Epoch 16/20 => Loss -0.014, Train_accy 94.62:  75%|███████▌  | 15/20 [03:58<01:31, 18.33s/it]                 
Task 10, Epoch 16/20 => Loss -0.014, Train_accy 94.62:  80%|████████  | 16/20 [03:58<01:04, 16.16s/it]
Task 10, Epoch 17/20 => Loss -0.003, Train_accy 94.36:  80%|████████  | 16/20 [04:09<01:04, 16.16s/it]
Task 10, Epoch 17/20 => Loss -0.003, Train_accy 94.36:  85%|████████▌ | 17/20 [04:09<00:43, 14.64s/it]
Task 10, Epoch 18/20 => Loss -0.071, Train_accy 96.15:  85%|████████▌ | 17/20 [04:20<00:43, 14.64s/it]
Task 10, Epoch 18/20 => Loss -0.071, Train_accy 96.15:  90%|█████████ | 18/20 [04:20<00:27, 13.60s/it]
Task 10, Epoch 19/20 => Loss -0.029, Train_accy 94.79:  90%|█████████ | 18/20 [04:31<00:27, 13.60s/it]
Task 10, Epoch 19/20 => Loss -0.029, Train_accy 94.79:  95%|█████████▌| 19/20 [04:31<00:12, 12.85s/it]
Task 10, Epoch 20/20 => Loss -0.019, Train_accy 94.70, Test_accy 71.64:  95%|█████████▌| 19/20 [05:02<00:12, 12.85s/it]
Task 10, Epoch 20/20 => Loss -0.019, Train_accy 94.70, Test_accy 71.64: 100%|██████████| 20/20 [05:02<00:00, 18.29s/it]
Task 10, Epoch 20/20 => Loss -0.019, Train_accy 94.70, Test_accy 71.64: 100%|██████████| 20/20 [05:02<00:00, 15.14s/it]
2024-09-07 18:44:58,805 [l2p.py] => Task 10, Epoch 20/20 => Loss -0.019, Train_accy 94.70, Test_accy 71.64
2024-09-07 18:45:18,610 [trainer.py] => No NME accuracy.
2024-09-07 18:45:18,611 [trainer.py] => CNN: {'total': 71.64, '00-09': 73.5, '10-19': 77.42, '20-29': 73.33, '30-39': 77.11, '40-49': 68.54, '50-59': 74.67, '60-69': 73.15, '70-79': 68.86, '80-89': 67.42, '90-99': 60.45, '100-109': 66.55, 'old': 72.13, 'new': 66.55}
2024-09-07 18:45:18,611 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64]
2024-09-07 18:45:18,611 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9]

Average Accuracy (CNN): 77.47
2024-09-07 18:45:18,611 [trainer.py] => Average Accuracy (CNN): 77.47 

2024-09-07 18:45:18,614 [trainer.py] => All params: 171970192
2024-09-07 18:45:18,616 [trainer.py] => Trainable params: 199880
2024-09-07 18:45:18,617 [l2p.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.708, Train_accy 71.64:   0%|          | 0/20 [00:14<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.708, Train_accy 71.64:   5%|▌         | 1/20 [00:14<04:28, 14.13s/it]
Task 11, Epoch 2/20 => Loss 0.215, Train_accy 87.42:   5%|▌         | 1/20 [00:28<04:28, 14.13s/it]
Task 11, Epoch 2/20 => Loss 0.215, Train_accy 87.42:  10%|█         | 2/20 [00:28<04:14, 14.13s/it]
Task 11, Epoch 3/20 => Loss 0.138, Train_accy 88.56:  10%|█         | 2/20 [00:42<04:14, 14.13s/it]
Task 11, Epoch 3/20 => Loss 0.138, Train_accy 88.56:  15%|█▌        | 3/20 [00:42<04:00, 14.13s/it]
Task 11, Epoch 4/20 => Loss 0.051, Train_accy 92.37:  15%|█▌        | 3/20 [00:56<04:00, 14.13s/it]
Task 11, Epoch 4/20 => Loss 0.051, Train_accy 92.37:  20%|██        | 4/20 [00:56<03:46, 14.13s/it]
Task 11, Epoch 5/20 => Loss 0.034, Train_accy 92.98, Test_accy 70.43:  20%|██        | 4/20 [01:32<03:46, 14.13s/it]
Task 11, Epoch 5/20 => Loss 0.034, Train_accy 92.98, Test_accy 70.43:  25%|██▌       | 5/20 [01:32<05:32, 22.13s/it]
Task 11, Epoch 6/20 => Loss 0.052, Train_accy 92.17:  25%|██▌       | 5/20 [01:46<05:32, 22.13s/it]                 
Task 11, Epoch 6/20 => Loss 0.052, Train_accy 92.17:  30%|███       | 6/20 [01:46<04:31, 19.41s/it]
Task 11, Epoch 7/20 => Loss 0.018, Train_accy 93.71:  30%|███       | 6/20 [02:01<04:31, 19.41s/it]
Task 11, Epoch 7/20 => Loss 0.018, Train_accy 93.71:  35%|███▌      | 7/20 [02:01<03:49, 17.67s/it]
Task 11, Epoch 8/20 => Loss 0.010, Train_accy 93.65:  35%|███▌      | 7/20 [02:15<03:49, 17.67s/it]
Task 11, Epoch 8/20 => Loss 0.010, Train_accy 93.65:  40%|████      | 8/20 [02:15<03:18, 16.52s/it]
Task 11, Epoch 9/20 => Loss 0.020, Train_accy 93.44:  40%|████      | 8/20 [02:29<03:18, 16.52s/it]
Task 11, Epoch 9/20 => Loss 0.020, Train_accy 93.44:  45%|████▌     | 9/20 [02:29<02:53, 15.77s/it]
Task 11, Epoch 10/20 => Loss 0.035, Train_accy 92.84, Test_accy 71.11:  45%|████▌     | 9/20 [03:05<02:53, 15.77s/it]
Task 11, Epoch 10/20 => Loss 0.035, Train_accy 92.84, Test_accy 71.11:  50%|█████     | 10/20 [03:05<03:40, 22.07s/it]
Task 11, Epoch 11/20 => Loss 0.027, Train_accy 93.44:  50%|█████     | 10/20 [03:19<03:40, 22.07s/it]                 
Task 11, Epoch 11/20 => Loss 0.027, Train_accy 93.44:  55%|█████▌    | 11/20 [03:19<02:56, 19.63s/it]
Task 11, Epoch 12/20 => Loss 0.013, Train_accy 94.05:  55%|█████▌    | 11/20 [03:33<02:56, 19.63s/it]
Task 11, Epoch 12/20 => Loss 0.013, Train_accy 94.05:  60%|██████    | 12/20 [03:33<02:23, 17.98s/it]
Task 11, Epoch 13/20 => Loss 0.012, Train_accy 93.71:  60%|██████    | 12/20 [03:47<02:23, 17.98s/it]
Task 11, Epoch 13/20 => Loss 0.012, Train_accy 93.71:  65%|██████▌   | 13/20 [03:47<01:57, 16.84s/it]
Task 11, Epoch 14/20 => Loss 0.018, Train_accy 93.71:  65%|██████▌   | 13/20 [04:02<01:57, 16.84s/it]
Task 11, Epoch 14/20 => Loss 0.018, Train_accy 93.71:  70%|███████   | 14/20 [04:02<01:36, 16.02s/it]
Task 11, Epoch 15/20 => Loss -0.003, Train_accy 94.52, Test_accy 70.86:  70%|███████   | 14/20 [04:38<01:36, 16.02s/it]
Task 11, Epoch 15/20 => Loss -0.003, Train_accy 94.52, Test_accy 70.86:  75%|███████▌  | 15/20 [04:38<01:50, 22.11s/it]
Task 11, Epoch 16/20 => Loss 0.013, Train_accy 94.11:  75%|███████▌  | 15/20 [04:52<01:50, 22.11s/it]                  
Task 11, Epoch 16/20 => Loss 0.013, Train_accy 94.11:  80%|████████  | 16/20 [04:52<01:18, 19.71s/it]
Task 11, Epoch 17/20 => Loss -0.038, Train_accy 95.72:  80%|████████  | 16/20 [05:06<01:18, 19.71s/it]
Task 11, Epoch 17/20 => Loss -0.038, Train_accy 95.72:  85%|████████▌ | 17/20 [05:06<00:54, 18.01s/it]
Task 11, Epoch 18/20 => Loss -0.012, Train_accy 94.72:  85%|████████▌ | 17/20 [05:20<00:54, 18.01s/it]
Task 11, Epoch 18/20 => Loss -0.012, Train_accy 94.72:  90%|█████████ | 18/20 [05:20<00:33, 16.83s/it]
Task 11, Epoch 19/20 => Loss -0.005, Train_accy 94.11:  90%|█████████ | 18/20 [05:34<00:33, 16.83s/it]
Task 11, Epoch 19/20 => Loss -0.005, Train_accy 94.11:  95%|█████████▌| 19/20 [05:34<00:15, 15.98s/it]
Task 11, Epoch 20/20 => Loss -0.020, Train_accy 94.38, Test_accy 70.51:  95%|█████████▌| 19/20 [06:10<00:15, 15.98s/it]
Task 11, Epoch 20/20 => Loss -0.020, Train_accy 94.38, Test_accy 70.51: 100%|██████████| 20/20 [06:10<00:00, 22.03s/it]
Task 11, Epoch 20/20 => Loss -0.020, Train_accy 94.38, Test_accy 70.51: 100%|██████████| 20/20 [06:10<00:00, 18.53s/it]
2024-09-07 18:51:29,306 [l2p.py] => Task 11, Epoch 20/20 => Loss -0.020, Train_accy 94.38, Test_accy 70.51
2024-09-07 18:51:51,377 [trainer.py] => No NME accuracy.
2024-09-07 18:51:51,378 [trainer.py] => CNN: {'total': 70.51, '00-09': 73.82, '10-19': 74.73, '20-29': 66.67, '30-39': 77.71, '40-49': 69.21, '50-59': 74.34, '60-69': 72.15, '70-79': 67.77, '80-89': 64.52, '90-99': 59.32, '100-109': 64.44, '110-119': 73.67, 'old': 70.14, 'new': 73.67}
2024-09-07 18:51:51,378 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51]
2024-09-07 18:51:51,378 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7]

Average Accuracy (CNN): 76.89
2024-09-07 18:51:51,378 [trainer.py] => Average Accuracy (CNN): 76.89 

2024-09-07 18:51:51,380 [trainer.py] => All params: 171970192
2024-09-07 18:51:51,382 [trainer.py] => Trainable params: 199880
2024-09-07 18:51:51,382 [l2p.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.954, Train_accy 62.09:   0%|          | 0/20 [00:09<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.954, Train_accy 62.09:   5%|▌         | 1/20 [00:09<02:56,  9.29s/it]
Task 12, Epoch 2/20 => Loss 0.239, Train_accy 86.98:   5%|▌         | 1/20 [00:18<02:56,  9.29s/it]
Task 12, Epoch 2/20 => Loss 0.239, Train_accy 86.98:  10%|█         | 2/20 [00:18<02:47,  9.33s/it]
Task 12, Epoch 3/20 => Loss 0.089, Train_accy 91.12:  10%|█         | 2/20 [00:27<02:47,  9.33s/it]
Task 12, Epoch 3/20 => Loss 0.089, Train_accy 91.12:  15%|█▌        | 3/20 [00:27<02:38,  9.31s/it]
Task 12, Epoch 4/20 => Loss 0.010, Train_accy 93.18:  15%|█▌        | 3/20 [00:37<02:38,  9.31s/it]
Task 12, Epoch 4/20 => Loss 0.010, Train_accy 93.18:  20%|██        | 4/20 [00:37<02:29,  9.32s/it]
Task 12, Epoch 5/20 => Loss 0.035, Train_accy 92.98, Test_accy 69.77:  20%|██        | 4/20 [01:10<02:29,  9.32s/it]
Task 12, Epoch 5/20 => Loss 0.035, Train_accy 92.98, Test_accy 69.77:  25%|██▌       | 5/20 [01:10<04:27, 17.85s/it]
Task 12, Epoch 6/20 => Loss -0.006, Train_accy 94.63:  25%|██▌       | 5/20 [01:19<04:27, 17.85s/it]                
Task 12, Epoch 6/20 => Loss -0.006, Train_accy 94.63:  30%|███       | 6/20 [01:19<03:29, 14.95s/it]
Task 12, Epoch 7/20 => Loss -0.016, Train_accy 94.83:  30%|███       | 6/20 [01:28<03:29, 14.95s/it]
Task 12, Epoch 7/20 => Loss -0.016, Train_accy 94.83:  35%|███▌      | 7/20 [01:28<02:50, 13.10s/it]
Task 12, Epoch 8/20 => Loss -0.023, Train_accy 94.52:  35%|███▌      | 7/20 [01:38<02:50, 13.10s/it]
Task 12, Epoch 8/20 => Loss -0.023, Train_accy 94.52:  40%|████      | 8/20 [01:38<02:22, 11.89s/it]
Task 12, Epoch 9/20 => Loss -0.019, Train_accy 94.63:  40%|████      | 8/20 [01:47<02:22, 11.89s/it]
Task 12, Epoch 9/20 => Loss -0.019, Train_accy 94.63:  45%|████▌     | 9/20 [01:47<02:02, 11.09s/it]
Task 12, Epoch 10/20 => Loss 0.048, Train_accy 93.49, Test_accy 70.05:  45%|████▌     | 9/20 [02:20<02:02, 11.09s/it]
Task 12, Epoch 10/20 => Loss 0.048, Train_accy 93.49, Test_accy 70.05:  50%|█████     | 10/20 [02:20<02:58, 17.83s/it]
Task 12, Epoch 11/20 => Loss -0.019, Train_accy 94.42:  50%|█████     | 10/20 [02:29<02:58, 17.83s/it]                
Task 12, Epoch 11/20 => Loss -0.019, Train_accy 94.42:  55%|█████▌    | 11/20 [02:29<02:17, 15.23s/it]
Task 12, Epoch 12/20 => Loss -0.045, Train_accy 95.66:  55%|█████▌    | 11/20 [02:38<02:17, 15.23s/it]
Task 12, Epoch 12/20 => Loss -0.045, Train_accy 95.66:  60%|██████    | 12/20 [02:38<01:47, 13.41s/it]
Task 12, Epoch 13/20 => Loss 0.009, Train_accy 94.42:  60%|██████    | 12/20 [02:48<01:47, 13.41s/it] 
Task 12, Epoch 13/20 => Loss 0.009, Train_accy 94.42:  65%|██████▌   | 13/20 [02:48<01:25, 12.16s/it]
Task 12, Epoch 14/20 => Loss -0.021, Train_accy 94.73:  65%|██████▌   | 13/20 [02:57<01:25, 12.16s/it]
Task 12, Epoch 14/20 => Loss -0.021, Train_accy 94.73:  70%|███████   | 14/20 [02:57<01:07, 11.28s/it]
Task 12, Epoch 15/20 => Loss 0.015, Train_accy 93.90, Test_accy 69.79:  70%|███████   | 14/20 [03:30<01:07, 11.28s/it]
Task 12, Epoch 15/20 => Loss 0.015, Train_accy 93.90, Test_accy 69.79:  75%|███████▌  | 15/20 [03:30<01:29, 17.82s/it]
Task 12, Epoch 16/20 => Loss -0.055, Train_accy 95.25:  75%|███████▌  | 15/20 [03:39<01:29, 17.82s/it]                
Task 12, Epoch 16/20 => Loss -0.055, Train_accy 95.25:  80%|████████  | 16/20 [03:39<01:00, 15.25s/it]
Task 12, Epoch 17/20 => Loss -0.021, Train_accy 94.32:  80%|████████  | 16/20 [03:49<01:00, 15.25s/it]
Task 12, Epoch 17/20 => Loss -0.021, Train_accy 94.32:  85%|████████▌ | 17/20 [03:49<00:40, 13.49s/it]
Task 12, Epoch 18/20 => Loss -0.031, Train_accy 95.04:  85%|████████▌ | 17/20 [03:58<00:40, 13.49s/it]
Task 12, Epoch 18/20 => Loss -0.031, Train_accy 95.04:  90%|█████████ | 18/20 [03:58<00:24, 12.23s/it]
Task 12, Epoch 19/20 => Loss -0.048, Train_accy 95.14:  90%|█████████ | 18/20 [04:07<00:24, 12.23s/it]
Task 12, Epoch 19/20 => Loss -0.048, Train_accy 95.14:  95%|█████████▌| 19/20 [04:07<00:11, 11.34s/it]
Task 12, Epoch 20/20 => Loss -0.036, Train_accy 95.35, Test_accy 69.64:  95%|█████████▌| 19/20 [04:40<00:11, 11.34s/it]
Task 12, Epoch 20/20 => Loss -0.036, Train_accy 95.35, Test_accy 69.64: 100%|██████████| 20/20 [04:40<00:00, 17.76s/it]
Task 12, Epoch 20/20 => Loss -0.036, Train_accy 95.35, Test_accy 69.64: 100%|██████████| 20/20 [04:40<00:00, 14.02s/it]
2024-09-07 18:56:31,857 [l2p.py] => Task 12, Epoch 20/20 => Loss -0.036, Train_accy 95.35, Test_accy 69.64
2024-09-07 18:56:55,393 [trainer.py] => No NME accuracy.
2024-09-07 18:56:55,394 [trainer.py] => CNN: {'total': 69.64, '00-09': 73.5, '10-19': 72.58, '20-29': 64.33, '30-39': 75.3, '40-49': 66.23, '50-59': 73.36, '60-69': 71.48, '70-79': 67.77, '80-89': 65.16, '90-99': 59.89, '100-109': 63.03, '110-119': 72.34, '120-129': 74.17, 'old': 69.3, 'new': 74.17}
2024-09-07 18:56:55,394 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64]
2024-09-07 18:56:55,394 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97]

Average Accuracy (CNN): 76.33
2024-09-07 18:56:55,395 [trainer.py] => Average Accuracy (CNN): 76.33 

2024-09-07 18:56:55,397 [trainer.py] => All params: 171970192
2024-09-07 18:56:55,399 [trainer.py] => Trainable params: 199880
2024-09-07 18:56:55,399 [l2p.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.694, Train_accy 72.32:   0%|          | 0/20 [00:10<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.694, Train_accy 72.32:   5%|▌         | 1/20 [00:10<03:28, 10.96s/it]
Task 13, Epoch 2/20 => Loss 0.257, Train_accy 86.51:   5%|▌         | 1/20 [00:21<03:28, 10.96s/it]
Task 13, Epoch 2/20 => Loss 0.257, Train_accy 86.51:  10%|█         | 2/20 [00:21<03:17, 10.96s/it]
Task 13, Epoch 3/20 => Loss 0.126, Train_accy 90.14:  10%|█         | 2/20 [00:32<03:17, 10.96s/it]
Task 13, Epoch 3/20 => Loss 0.126, Train_accy 90.14:  15%|█▌        | 3/20 [00:32<03:07, 11.00s/it]
Task 13, Epoch 4/20 => Loss 0.058, Train_accy 91.78:  15%|█▌        | 3/20 [00:44<03:07, 11.00s/it]
Task 13, Epoch 4/20 => Loss 0.058, Train_accy 91.78:  20%|██        | 4/20 [00:44<02:56, 11.02s/it]
Task 13, Epoch 5/20 => Loss 0.053, Train_accy 92.47, Test_accy 68.44:  20%|██        | 4/20 [01:20<02:56, 11.02s/it]
Task 13, Epoch 5/20 => Loss 0.053, Train_accy 92.47, Test_accy 68.44:  25%|██▌       | 5/20 [01:20<05:02, 20.15s/it]
Task 13, Epoch 6/20 => Loss 0.009, Train_accy 94.03:  25%|██▌       | 5/20 [01:31<05:02, 20.15s/it]                 
Task 13, Epoch 6/20 => Loss 0.009, Train_accy 94.03:  30%|███       | 6/20 [01:31<03:58, 17.05s/it]
Task 13, Epoch 7/20 => Loss 0.006, Train_accy 93.60:  30%|███       | 6/20 [01:42<03:58, 17.05s/it]
Task 13, Epoch 7/20 => Loss 0.006, Train_accy 93.60:  35%|███▌      | 7/20 [01:42<03:15, 15.07s/it]
Task 13, Epoch 8/20 => Loss 0.049, Train_accy 92.65:  35%|███▌      | 7/20 [01:53<03:15, 15.07s/it]
Task 13, Epoch 8/20 => Loss 0.049, Train_accy 92.65:  40%|████      | 8/20 [01:53<02:45, 13.80s/it]
Task 13, Epoch 9/20 => Loss -0.000, Train_accy 93.86:  40%|████      | 8/20 [02:04<02:45, 13.80s/it]
Task 13, Epoch 9/20 => Loss -0.000, Train_accy 93.86:  45%|████▌     | 9/20 [02:04<02:22, 12.91s/it]
Task 13, Epoch 10/20 => Loss 0.003, Train_accy 94.55, Test_accy 68.98:  45%|████▌     | 9/20 [02:40<02:22, 12.91s/it]
Task 13, Epoch 10/20 => Loss 0.003, Train_accy 94.55, Test_accy 68.98:  50%|█████     | 10/20 [02:40<03:21, 20.13s/it]
Task 13, Epoch 11/20 => Loss -0.013, Train_accy 95.07:  50%|█████     | 10/20 [02:51<03:21, 20.13s/it]                
Task 13, Epoch 11/20 => Loss -0.013, Train_accy 95.07:  55%|█████▌    | 11/20 [02:51<02:36, 17.33s/it]
Task 13, Epoch 12/20 => Loss -0.010, Train_accy 94.64:  55%|█████▌    | 11/20 [03:02<02:36, 17.33s/it]
Task 13, Epoch 12/20 => Loss -0.010, Train_accy 94.64:  60%|██████    | 12/20 [03:02<02:03, 15.41s/it]
Task 13, Epoch 13/20 => Loss -0.054, Train_accy 95.59:  60%|██████    | 12/20 [03:13<02:03, 15.41s/it]
Task 13, Epoch 13/20 => Loss -0.054, Train_accy 95.59:  65%|██████▌   | 13/20 [03:13<01:38, 14.09s/it]
Task 13, Epoch 14/20 => Loss -0.041, Train_accy 96.45:  65%|██████▌   | 13/20 [03:24<01:38, 14.09s/it]
Task 13, Epoch 14/20 => Loss -0.041, Train_accy 96.45:  70%|███████   | 14/20 [03:24<01:18, 13.15s/it]
Task 13, Epoch 15/20 => Loss -0.016, Train_accy 94.38, Test_accy 68.98:  70%|███████   | 14/20 [04:01<01:18, 13.15s/it]
Task 13, Epoch 15/20 => Loss -0.016, Train_accy 94.38, Test_accy 68.98:  75%|███████▌  | 15/20 [04:01<01:40, 20.14s/it]
Task 13, Epoch 16/20 => Loss 0.007, Train_accy 94.81:  75%|███████▌  | 15/20 [04:12<01:40, 20.14s/it]                  
Task 13, Epoch 16/20 => Loss 0.007, Train_accy 94.81:  80%|████████  | 16/20 [04:12<01:09, 17.39s/it]
Task 13, Epoch 17/20 => Loss -0.045, Train_accy 95.50:  80%|████████  | 16/20 [04:23<01:09, 17.39s/it]
Task 13, Epoch 17/20 => Loss -0.045, Train_accy 95.50:  85%|████████▌ | 17/20 [04:23<00:46, 15.50s/it]
Task 13, Epoch 18/20 => Loss -0.034, Train_accy 95.67:  85%|████████▌ | 17/20 [04:34<00:46, 15.50s/it]
Task 13, Epoch 18/20 => Loss -0.034, Train_accy 95.67:  90%|█████████ | 18/20 [04:34<00:28, 14.16s/it]
Task 13, Epoch 19/20 => Loss -0.050, Train_accy 95.76:  90%|█████████ | 18/20 [04:45<00:28, 14.16s/it]
Task 13, Epoch 19/20 => Loss -0.050, Train_accy 95.76:  95%|█████████▌| 19/20 [04:45<00:13, 13.21s/it]
Task 13, Epoch 20/20 => Loss -0.062, Train_accy 96.45, Test_accy 69.27:  95%|█████████▌| 19/20 [05:21<00:13, 13.21s/it]
Task 13, Epoch 20/20 => Loss -0.062, Train_accy 96.45, Test_accy 69.27: 100%|██████████| 20/20 [05:21<00:00, 20.17s/it]
Task 13, Epoch 20/20 => Loss -0.062, Train_accy 96.45, Test_accy 69.27: 100%|██████████| 20/20 [05:21<00:00, 16.08s/it]
2024-09-07 19:02:17,056 [l2p.py] => Task 13, Epoch 20/20 => Loss -0.062, Train_accy 96.45, Test_accy 69.27
2024-09-07 19:02:42,319 [trainer.py] => No NME accuracy.
2024-09-07 19:02:42,320 [trainer.py] => CNN: {'total': 69.27, '00-09': 73.19, '10-19': 72.31, '20-29': 65.0, '30-39': 76.2, '40-49': 66.56, '50-59': 73.36, '60-69': 71.14, '70-79': 66.3, '80-89': 65.16, '90-99': 59.32, '100-109': 63.03, '110-119': 72.87, '120-129': 72.69, '130-139': 65.77, 'old': 69.54, 'new': 65.77}
2024-09-07 19:02:42,320 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64, 69.27]
2024-09-07 19:02:42,320 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97, 88.02]

Average Accuracy (CNN): 75.83
2024-09-07 19:02:42,321 [trainer.py] => Average Accuracy (CNN): 75.83 

2024-09-07 19:02:42,324 [trainer.py] => All params: 171970192
2024-09-07 19:02:42,326 [trainer.py] => Trainable params: 199880
2024-09-07 19:02:42,327 [l2p.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.493, Train_accy 78.37:   0%|          | 0/20 [00:13<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.493, Train_accy 78.37:   5%|▌         | 1/20 [00:13<04:14, 13.38s/it]
Task 14, Epoch 2/20 => Loss 0.135, Train_accy 89.68:   5%|▌         | 1/20 [00:26<04:14, 13.38s/it]
Task 14, Epoch 2/20 => Loss 0.135, Train_accy 89.68:  10%|█         | 2/20 [00:26<04:00, 13.35s/it]
Task 14, Epoch 3/20 => Loss 0.056, Train_accy 92.16:  10%|█         | 2/20 [00:40<04:00, 13.35s/it]
Task 14, Epoch 3/20 => Loss 0.056, Train_accy 92.16:  15%|█▌        | 3/20 [00:40<03:47, 13.36s/it]
Task 14, Epoch 4/20 => Loss 0.012, Train_accy 93.36:  15%|█▌        | 3/20 [00:53<03:47, 13.36s/it]
Task 14, Epoch 4/20 => Loss 0.012, Train_accy 93.36:  20%|██        | 4/20 [00:53<03:34, 13.40s/it]
Task 14, Epoch 5/20 => Loss 0.016, Train_accy 93.64, Test_accy 69.50:  20%|██        | 4/20 [01:34<03:34, 13.40s/it]
Task 14, Epoch 5/20 => Loss 0.016, Train_accy 93.64, Test_accy 69.50:  25%|██▌       | 5/20 [01:34<05:49, 23.29s/it]
Task 14, Epoch 6/20 => Loss -0.022, Train_accy 94.77:  25%|██▌       | 5/20 [01:47<05:49, 23.29s/it]                
Task 14, Epoch 6/20 => Loss -0.022, Train_accy 94.77:  30%|███       | 6/20 [01:47<04:38, 19.92s/it]
Task 14, Epoch 7/20 => Loss 0.000, Train_accy 93.99:  30%|███       | 6/20 [02:01<04:38, 19.92s/it] 
Task 14, Epoch 7/20 => Loss 0.000, Train_accy 93.99:  35%|███▌      | 7/20 [02:01<03:51, 17.78s/it]
Task 14, Epoch 8/20 => Loss -0.011, Train_accy 94.06:  35%|███▌      | 7/20 [02:14<03:51, 17.78s/it]
Task 14, Epoch 8/20 => Loss -0.011, Train_accy 94.06:  40%|████      | 8/20 [02:14<03:16, 16.38s/it]
Task 14, Epoch 9/20 => Loss -0.004, Train_accy 93.78:  40%|████      | 8/20 [02:27<03:16, 16.38s/it]
Task 14, Epoch 9/20 => Loss -0.004, Train_accy 93.78:  45%|████▌     | 9/20 [02:27<02:49, 15.41s/it]
Task 14, Epoch 10/20 => Loss -0.015, Train_accy 94.13, Test_accy 69.44:  45%|████▌     | 9/20 [03:08<02:49, 15.41s/it]
Task 14, Epoch 10/20 => Loss -0.015, Train_accy 94.13, Test_accy 69.44:  50%|█████     | 10/20 [03:08<03:52, 23.28s/it]
Task 14, Epoch 11/20 => Loss -0.012, Train_accy 94.49:  50%|█████     | 10/20 [03:22<03:52, 23.28s/it]                 
Task 14, Epoch 11/20 => Loss -0.012, Train_accy 94.49:  55%|█████▌    | 11/20 [03:22<03:02, 20.24s/it]
Task 14, Epoch 12/20 => Loss -0.036, Train_accy 94.77:  55%|█████▌    | 11/20 [03:35<03:02, 20.24s/it]
Task 14, Epoch 12/20 => Loss -0.036, Train_accy 94.77:  60%|██████    | 12/20 [03:35<02:25, 18.14s/it]
Task 14, Epoch 13/20 => Loss -0.053, Train_accy 95.27:  60%|██████    | 12/20 [03:48<02:25, 18.14s/it]
Task 14, Epoch 13/20 => Loss -0.053, Train_accy 95.27:  65%|██████▌   | 13/20 [03:48<01:56, 16.69s/it]
Task 14, Epoch 14/20 => Loss -0.035, Train_accy 95.34:  65%|██████▌   | 13/20 [04:02<01:56, 16.69s/it]
Task 14, Epoch 14/20 => Loss -0.035, Train_accy 95.34:  70%|███████   | 14/20 [04:02<01:34, 15.69s/it]
Task 14, Epoch 15/20 => Loss -0.050, Train_accy 95.41, Test_accy 69.46:  70%|███████   | 14/20 [04:42<01:34, 15.69s/it]
Task 14, Epoch 15/20 => Loss -0.050, Train_accy 95.41, Test_accy 69.46:  75%|███████▌  | 15/20 [04:42<01:56, 23.26s/it]
Task 14, Epoch 16/20 => Loss -0.030, Train_accy 94.70:  75%|███████▌  | 15/20 [04:56<01:56, 23.26s/it]                 
Task 14, Epoch 16/20 => Loss -0.030, Train_accy 94.70:  80%|████████  | 16/20 [04:56<01:21, 20.28s/it]
Task 14, Epoch 17/20 => Loss -0.062, Train_accy 95.69:  80%|████████  | 16/20 [05:09<01:21, 20.28s/it]
Task 14, Epoch 17/20 => Loss -0.062, Train_accy 95.69:  85%|████████▌ | 17/20 [05:09<00:54, 18.18s/it]
Task 14, Epoch 18/20 => Loss -0.052, Train_accy 95.62:  85%|████████▌ | 17/20 [05:22<00:54, 18.18s/it]
Task 14, Epoch 18/20 => Loss -0.052, Train_accy 95.62:  90%|█████████ | 18/20 [05:22<00:33, 16.73s/it]
Task 14, Epoch 19/20 => Loss -0.063, Train_accy 96.25:  90%|█████████ | 18/20 [05:36<00:33, 16.73s/it]
Task 14, Epoch 19/20 => Loss -0.063, Train_accy 96.25:  95%|█████████▌| 19/20 [05:36<00:15, 15.71s/it]
Task 14, Epoch 20/20 => Loss -0.069, Train_accy 95.83, Test_accy 69.53:  95%|█████████▌| 19/20 [06:17<00:15, 15.71s/it]
Task 14, Epoch 20/20 => Loss -0.069, Train_accy 95.83, Test_accy 69.53: 100%|██████████| 20/20 [06:17<00:00, 23.23s/it]
Task 14, Epoch 20/20 => Loss -0.069, Train_accy 95.83, Test_accy 69.53: 100%|██████████| 20/20 [06:17<00:00, 18.85s/it]
2024-09-07 19:08:59,351 [l2p.py] => Task 14, Epoch 20/20 => Loss -0.069, Train_accy 95.83, Test_accy 69.53
2024-09-07 19:09:27,154 [trainer.py] => No NME accuracy.
2024-09-07 19:09:27,155 [trainer.py] => CNN: {'total': 69.53, '00-09': 71.61, '10-19': 72.31, '20-29': 63.67, '30-39': 74.1, '40-49': 65.23, '50-59': 73.36, '60-69': 70.81, '70-79': 65.57, '80-89': 63.23, '90-99': 59.32, '100-109': 61.27, '110-119': 71.54, '120-129': 70.48, '130-139': 67.45, '140-149': 83.38, 'old': 68.32, 'new': 83.38}
2024-09-07 19:09:27,155 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64, 69.27, 69.53]
2024-09-07 19:09:27,155 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97, 88.02, 87.69]

Average Accuracy (CNN): 75.41
2024-09-07 19:09:27,155 [trainer.py] => Average Accuracy (CNN): 75.41 

2024-09-07 19:09:27,158 [trainer.py] => All params: 171970192
2024-09-07 19:09:27,160 [trainer.py] => Trainable params: 199880
2024-09-07 19:09:27,160 [l2p.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.790, Train_accy 68.59:   0%|          | 0/20 [00:13<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.790, Train_accy 68.59:   5%|▌         | 1/20 [00:13<04:13, 13.32s/it]
Task 15, Epoch 2/20 => Loss 0.204, Train_accy 87.87:   5%|▌         | 1/20 [00:26<04:13, 13.32s/it]
Task 15, Epoch 2/20 => Loss 0.204, Train_accy 87.87:  10%|█         | 2/20 [00:26<03:58, 13.27s/it]
Task 15, Epoch 3/20 => Loss 0.150, Train_accy 89.86:  10%|█         | 2/20 [00:39<03:58, 13.27s/it]
Task 15, Epoch 3/20 => Loss 0.150, Train_accy 89.86:  15%|█▌        | 3/20 [00:39<03:45, 13.28s/it]
Task 15, Epoch 4/20 => Loss 0.102, Train_accy 91.15:  15%|█▌        | 3/20 [00:53<03:45, 13.28s/it]
Task 15, Epoch 4/20 => Loss 0.102, Train_accy 91.15:  20%|██        | 4/20 [00:53<03:32, 13.26s/it]
Task 15, Epoch 5/20 => Loss 0.082, Train_accy 91.08, Test_accy 69.07:  20%|██        | 4/20 [01:36<03:32, 13.26s/it]
Task 15, Epoch 5/20 => Loss 0.082, Train_accy 91.08, Test_accy 69.07:  25%|██▌       | 5/20 [01:36<05:59, 23.97s/it]
Task 15, Epoch 6/20 => Loss 0.057, Train_accy 92.72:  25%|██▌       | 5/20 [01:49<05:59, 23.97s/it]                 
Task 15, Epoch 6/20 => Loss 0.057, Train_accy 92.72:  30%|███       | 6/20 [01:49<04:44, 20.33s/it]
Task 15, Epoch 7/20 => Loss 0.041, Train_accy 93.08:  30%|███       | 6/20 [02:02<04:44, 20.33s/it]
Task 15, Epoch 7/20 => Loss 0.041, Train_accy 93.08:  35%|███▌      | 7/20 [02:02<03:54, 18.03s/it]
Task 15, Epoch 8/20 => Loss 0.031, Train_accy 93.15:  35%|███▌      | 7/20 [02:15<03:54, 18.03s/it]
Task 15, Epoch 8/20 => Loss 0.031, Train_accy 93.15:  40%|████      | 8/20 [02:15<03:18, 16.52s/it]
Task 15, Epoch 9/20 => Loss 0.022, Train_accy 93.43:  40%|████      | 8/20 [02:29<03:18, 16.52s/it]
Task 15, Epoch 9/20 => Loss 0.022, Train_accy 93.43:  45%|████▌     | 9/20 [02:29<02:50, 15.50s/it]
Task 15, Epoch 10/20 => Loss -0.014, Train_accy 94.08, Test_accy 69.41:  45%|████▌     | 9/20 [03:12<02:50, 15.50s/it]
Task 15, Epoch 10/20 => Loss -0.014, Train_accy 94.08, Test_accy 69.41:  50%|█████     | 10/20 [03:12<03:59, 23.98s/it]
Task 15, Epoch 11/20 => Loss 0.020, Train_accy 93.93:  50%|█████     | 10/20 [03:25<03:59, 23.98s/it]                  
Task 15, Epoch 11/20 => Loss 0.020, Train_accy 93.93:  55%|█████▌    | 11/20 [03:25<03:06, 20.69s/it]
Task 15, Epoch 12/20 => Loss 0.004, Train_accy 94.15:  55%|█████▌    | 11/20 [03:38<03:06, 20.69s/it]
Task 15, Epoch 12/20 => Loss 0.004, Train_accy 94.15:  60%|██████    | 12/20 [03:38<02:27, 18.41s/it]
Task 15, Epoch 13/20 => Loss 0.014, Train_accy 93.36:  60%|██████    | 12/20 [03:51<02:27, 18.41s/it]
Task 15, Epoch 13/20 => Loss 0.014, Train_accy 93.36:  65%|██████▌   | 13/20 [03:51<01:57, 16.83s/it]
Task 15, Epoch 14/20 => Loss -0.017, Train_accy 94.58:  65%|██████▌   | 13/20 [04:05<01:57, 16.83s/it]
Task 15, Epoch 14/20 => Loss -0.017, Train_accy 94.58:  70%|███████   | 14/20 [04:05<01:34, 15.78s/it]
Task 15, Epoch 15/20 => Loss -0.007, Train_accy 94.50, Test_accy 69.65:  70%|███████   | 14/20 [04:47<01:34, 15.78s/it]
Task 15, Epoch 15/20 => Loss -0.007, Train_accy 94.50, Test_accy 69.65:  75%|███████▌  | 15/20 [04:48<01:59, 23.96s/it]
Task 15, Epoch 16/20 => Loss -0.041, Train_accy 95.43:  75%|███████▌  | 15/20 [05:01<01:59, 23.96s/it]                 
Task 15, Epoch 16/20 => Loss -0.041, Train_accy 95.43:  80%|████████  | 16/20 [05:01<01:22, 20.75s/it]
Task 15, Epoch 17/20 => Loss -0.005, Train_accy 94.22:  80%|████████  | 16/20 [05:14<01:22, 20.75s/it]
Task 15, Epoch 17/20 => Loss -0.005, Train_accy 94.22:  85%|████████▌ | 17/20 [05:14<00:55, 18.54s/it]
Task 15, Epoch 18/20 => Loss -0.001, Train_accy 93.86:  85%|████████▌ | 17/20 [05:27<00:55, 18.54s/it]
Task 15, Epoch 18/20 => Loss -0.001, Train_accy 93.86:  90%|█████████ | 18/20 [05:27<00:33, 16.95s/it]
Task 15, Epoch 19/20 => Loss 0.012, Train_accy 93.79:  90%|█████████ | 18/20 [05:41<00:33, 16.95s/it] 
Task 15, Epoch 19/20 => Loss 0.012, Train_accy 93.79:  95%|█████████▌| 19/20 [05:41<00:15, 15.86s/it]
Task 15, Epoch 20/20 => Loss 0.015, Train_accy 94.29, Test_accy 69.47:  95%|█████████▌| 19/20 [06:24<00:15, 15.86s/it]
Task 15, Epoch 20/20 => Loss 0.015, Train_accy 94.29, Test_accy 69.47: 100%|██████████| 20/20 [06:24<00:00, 23.96s/it]
Task 15, Epoch 20/20 => Loss 0.015, Train_accy 94.29, Test_accy 69.47: 100%|██████████| 20/20 [06:24<00:00, 19.20s/it]
2024-09-07 19:15:51,273 [l2p.py] => Task 15, Epoch 20/20 => Loss 0.015, Train_accy 94.29, Test_accy 69.47
2024-09-07 19:16:20,942 [trainer.py] => No NME accuracy.
2024-09-07 19:16:20,943 [trainer.py] => CNN: {'total': 69.47, '00-09': 72.24, '10-19': 73.92, '20-29': 64.0, '30-39': 74.1, '40-49': 63.91, '50-59': 72.7, '60-69': 71.14, '70-79': 64.47, '80-89': 63.55, '90-99': 57.63, '100-109': 60.56, '110-119': 71.28, '120-129': 68.63, '130-139': 64.77, '140-149': 83.11, '150-159': 73.76, 'old': 69.13, 'new': 73.76}
2024-09-07 19:16:20,943 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64, 69.27, 69.53, 69.47]
2024-09-07 19:16:20,943 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97, 88.02, 87.69, 87.38]

Average Accuracy (CNN): 75.04
2024-09-07 19:16:20,943 [trainer.py] => Average Accuracy (CNN): 75.04 

2024-09-07 19:16:20,946 [trainer.py] => All params: 171970192
2024-09-07 19:16:20,948 [trainer.py] => Trainable params: 199880
2024-09-07 19:16:20,948 [l2p.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.162, Train_accy 54.23:   0%|          | 0/20 [00:09<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.162, Train_accy 54.23:   5%|▌         | 1/20 [00:09<03:00,  9.52s/it]
Task 16, Epoch 2/20 => Loss 0.405, Train_accy 80.68:   5%|▌         | 1/20 [00:19<03:00,  9.52s/it]
Task 16, Epoch 2/20 => Loss 0.405, Train_accy 80.68:  10%|█         | 2/20 [00:19<02:51,  9.55s/it]
Task 16, Epoch 3/20 => Loss 0.266, Train_accy 86.12:  10%|█         | 2/20 [00:28<02:51,  9.55s/it]
Task 16, Epoch 3/20 => Loss 0.266, Train_accy 86.12:  15%|█▌        | 3/20 [00:28<02:42,  9.53s/it]
Task 16, Epoch 4/20 => Loss 0.182, Train_accy 88.23:  15%|█▌        | 3/20 [00:38<02:42,  9.53s/it]
Task 16, Epoch 4/20 => Loss 0.182, Train_accy 88.23:  20%|██        | 4/20 [00:38<02:32,  9.54s/it]
Task 16, Epoch 5/20 => Loss 0.173, Train_accy 88.03, Test_accy 68.76:  20%|██        | 4/20 [01:18<02:32,  9.54s/it]
Task 16, Epoch 5/20 => Loss 0.173, Train_accy 88.03, Test_accy 68.76:  25%|██▌       | 5/20 [01:18<05:11, 20.76s/it]
Task 16, Epoch 6/20 => Loss 0.130, Train_accy 90.54:  25%|██▌       | 5/20 [01:28<05:11, 20.76s/it]                 
Task 16, Epoch 6/20 => Loss 0.130, Train_accy 90.54:  30%|███       | 6/20 [01:28<03:57, 16.94s/it]
Task 16, Epoch 7/20 => Loss 0.133, Train_accy 90.04:  30%|███       | 6/20 [01:37<03:57, 16.94s/it]
Task 16, Epoch 7/20 => Loss 0.133, Train_accy 90.04:  35%|███▌      | 7/20 [01:37<03:08, 14.51s/it]
Task 16, Epoch 8/20 => Loss 0.106, Train_accy 90.54:  35%|███▌      | 7/20 [01:47<03:08, 14.51s/it]
Task 16, Epoch 8/20 => Loss 0.106, Train_accy 90.54:  40%|████      | 8/20 [01:47<02:35, 12.93s/it]
Task 16, Epoch 9/20 => Loss 0.100, Train_accy 90.54:  40%|████      | 8/20 [01:56<02:35, 12.93s/it]
Task 16, Epoch 9/20 => Loss 0.100, Train_accy 90.54:  45%|████▌     | 9/20 [01:56<02:10, 11.86s/it]
Task 16, Epoch 10/20 => Loss 0.071, Train_accy 92.96, Test_accy 68.86:  45%|████▌     | 9/20 [02:37<02:10, 11.86s/it]
Task 16, Epoch 10/20 => Loss 0.071, Train_accy 92.96, Test_accy 68.86:  50%|█████     | 10/20 [02:37<03:26, 20.70s/it]
Task 16, Epoch 11/20 => Loss 0.033, Train_accy 93.66:  50%|█████     | 10/20 [02:46<03:26, 20.70s/it]                 
Task 16, Epoch 11/20 => Loss 0.033, Train_accy 93.66:  55%|█████▌    | 11/20 [02:46<02:35, 17.27s/it]
Task 16, Epoch 12/20 => Loss 0.011, Train_accy 93.76:  55%|█████▌    | 11/20 [02:56<02:35, 17.27s/it]
Task 16, Epoch 12/20 => Loss 0.011, Train_accy 93.76:  60%|██████    | 12/20 [02:56<01:59, 14.90s/it]
Task 16, Epoch 13/20 => Loss 0.067, Train_accy 92.05:  60%|██████    | 12/20 [03:05<01:59, 14.90s/it]
Task 16, Epoch 13/20 => Loss 0.067, Train_accy 92.05:  65%|██████▌   | 13/20 [03:05<01:32, 13.28s/it]
Task 16, Epoch 14/20 => Loss 0.063, Train_accy 92.66:  65%|██████▌   | 13/20 [03:15<01:32, 13.28s/it]
Task 16, Epoch 14/20 => Loss 0.063, Train_accy 92.66:  70%|███████   | 14/20 [03:15<01:12, 12.14s/it]
Task 16, Epoch 15/20 => Loss 0.070, Train_accy 90.74, Test_accy 68.63:  70%|███████   | 14/20 [03:55<01:12, 12.14s/it]
Task 16, Epoch 15/20 => Loss 0.070, Train_accy 90.74, Test_accy 68.63:  75%|███████▌  | 15/20 [03:55<01:43, 20.66s/it]
Task 16, Epoch 16/20 => Loss 0.051, Train_accy 92.25:  75%|███████▌  | 15/20 [04:05<01:43, 20.66s/it]                 
Task 16, Epoch 16/20 => Loss 0.051, Train_accy 92.25:  80%|████████  | 16/20 [04:05<01:09, 17.30s/it]
Task 16, Epoch 17/20 => Loss 0.072, Train_accy 91.35:  80%|████████  | 16/20 [04:14<01:09, 17.30s/it]
Task 16, Epoch 17/20 => Loss 0.072, Train_accy 91.35:  85%|████████▌ | 17/20 [04:14<00:44, 14.93s/it]
Task 16, Epoch 18/20 => Loss 0.028, Train_accy 92.76:  85%|████████▌ | 17/20 [04:24<00:44, 14.93s/it]
Task 16, Epoch 18/20 => Loss 0.028, Train_accy 92.76:  90%|█████████ | 18/20 [04:24<00:26, 13.29s/it]
Task 16, Epoch 19/20 => Loss 0.019, Train_accy 92.45:  90%|█████████ | 18/20 [04:33<00:26, 13.29s/it]
Task 16, Epoch 19/20 => Loss 0.019, Train_accy 92.45:  95%|█████████▌| 19/20 [04:33<00:12, 12.16s/it]
Task 16, Epoch 20/20 => Loss 0.071, Train_accy 92.66, Test_accy 68.92:  95%|█████████▌| 19/20 [05:14<00:12, 12.16s/it]
Task 16, Epoch 20/20 => Loss 0.071, Train_accy 92.66, Test_accy 68.92: 100%|██████████| 20/20 [05:14<00:00, 20.66s/it]
Task 16, Epoch 20/20 => Loss 0.071, Train_accy 92.66, Test_accy 68.92: 100%|██████████| 20/20 [05:14<00:00, 15.71s/it]
2024-09-07 19:21:35,173 [l2p.py] => Task 16, Epoch 20/20 => Loss 0.071, Train_accy 92.66, Test_accy 68.92
2024-09-07 19:22:06,151 [trainer.py] => No NME accuracy.
2024-09-07 19:22:06,151 [trainer.py] => CNN: {'total': 68.92, '00-09': 73.19, '10-19': 72.31, '20-29': 63.33, '30-39': 74.1, '40-49': 63.25, '50-59': 73.36, '60-69': 70.13, '70-79': 65.93, '80-89': 63.87, '90-99': 58.76, '100-109': 59.51, '110-119': 71.01, '120-129': 69.0, '130-139': 65.44, '140-149': 82.29, '150-159': 73.2, '160-169': 60.0, 'old': 69.33, 'new': 60.0}
2024-09-07 19:22:06,151 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64, 69.27, 69.53, 69.47, 68.92]
2024-09-07 19:22:06,151 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97, 88.02, 87.69, 87.38, 86.84]

Average Accuracy (CNN): 74.68
2024-09-07 19:22:06,152 [trainer.py] => Average Accuracy (CNN): 74.68 

2024-09-07 19:22:06,154 [trainer.py] => All params: 171970192
2024-09-07 19:22:06,155 [trainer.py] => Trainable params: 199880
2024-09-07 19:22:06,156 [l2p.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.691, Train_accy 73.38:   0%|          | 0/20 [00:09<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.691, Train_accy 73.38:   5%|▌         | 1/20 [00:09<02:54,  9.16s/it]
Task 17, Epoch 2/20 => Loss 0.155, Train_accy 89.41:   5%|▌         | 1/20 [00:18<02:54,  9.16s/it]
Task 17, Epoch 2/20 => Loss 0.155, Train_accy 89.41:  10%|█         | 2/20 [00:18<02:45,  9.17s/it]
Task 17, Epoch 3/20 => Loss 0.057, Train_accy 93.29:  10%|█         | 2/20 [00:27<02:45,  9.17s/it]
Task 17, Epoch 3/20 => Loss 0.057, Train_accy 93.29:  15%|█▌        | 3/20 [00:27<02:35,  9.15s/it]
Task 17, Epoch 4/20 => Loss 0.045, Train_accy 92.87:  15%|█▌        | 3/20 [00:36<02:35,  9.15s/it]
Task 17, Epoch 4/20 => Loss 0.045, Train_accy 92.87:  20%|██        | 4/20 [00:36<02:27,  9.24s/it]
Task 17, Epoch 5/20 => Loss 0.019, Train_accy 93.71, Test_accy 68.86:  20%|██        | 4/20 [01:18<02:27,  9.24s/it]
Task 17, Epoch 5/20 => Loss 0.019, Train_accy 93.71, Test_accy 68.86:  25%|██▌       | 5/20 [01:18<05:14, 20.95s/it]
Task 17, Epoch 6/20 => Loss 0.032, Train_accy 93.08:  25%|██▌       | 5/20 [01:27<05:14, 20.95s/it]                 
Task 17, Epoch 6/20 => Loss 0.032, Train_accy 93.08:  30%|███       | 6/20 [01:27<03:57, 16.99s/it]
Task 17, Epoch 7/20 => Loss 0.002, Train_accy 93.50:  30%|███       | 6/20 [01:37<03:57, 16.99s/it]
Task 17, Epoch 7/20 => Loss 0.002, Train_accy 93.50:  35%|███▌      | 7/20 [01:37<03:07, 14.43s/it]
Task 17, Epoch 8/20 => Loss -0.004, Train_accy 94.13:  35%|███▌      | 7/20 [01:46<03:07, 14.43s/it]
Task 17, Epoch 8/20 => Loss -0.004, Train_accy 94.13:  40%|████      | 8/20 [01:46<02:33, 12.75s/it]
Task 17, Epoch 9/20 => Loss -0.036, Train_accy 94.76:  40%|████      | 8/20 [01:55<02:33, 12.75s/it]
Task 17, Epoch 9/20 => Loss -0.036, Train_accy 94.76:  45%|████▌     | 9/20 [01:55<02:07, 11.63s/it]
Task 17, Epoch 10/20 => Loss -0.046, Train_accy 95.39, Test_accy 69.03:  45%|████▌     | 9/20 [02:36<02:07, 11.63s/it]
Task 17, Epoch 10/20 => Loss -0.046, Train_accy 95.39, Test_accy 69.03:  50%|█████     | 10/20 [02:36<03:28, 20.90s/it]
Task 17, Epoch 11/20 => Loss -0.002, Train_accy 94.65:  50%|█████     | 10/20 [02:46<03:28, 20.90s/it]                 
Task 17, Epoch 11/20 => Loss -0.002, Train_accy 94.65:  55%|█████▌    | 11/20 [02:46<02:35, 17.31s/it]
Task 17, Epoch 12/20 => Loss -0.035, Train_accy 95.49:  55%|█████▌    | 11/20 [02:55<02:35, 17.31s/it]
Task 17, Epoch 12/20 => Loss -0.035, Train_accy 95.49:  60%|██████    | 12/20 [02:55<01:58, 14.84s/it]
Task 17, Epoch 13/20 => Loss -0.000, Train_accy 93.50:  60%|██████    | 12/20 [03:04<01:58, 14.84s/it]
Task 17, Epoch 13/20 => Loss -0.000, Train_accy 93.50:  65%|██████▌   | 13/20 [03:04<01:31, 13.13s/it]
Task 17, Epoch 14/20 => Loss -0.028, Train_accy 94.55:  65%|██████▌   | 13/20 [03:13<01:31, 13.13s/it]
Task 17, Epoch 14/20 => Loss -0.028, Train_accy 94.55:  70%|███████   | 14/20 [03:13<01:11, 11.94s/it]
Task 17, Epoch 15/20 => Loss -0.073, Train_accy 96.02, Test_accy 68.90:  70%|███████   | 14/20 [03:55<01:11, 11.94s/it]
Task 17, Epoch 15/20 => Loss -0.073, Train_accy 96.02, Test_accy 68.90:  75%|███████▌  | 15/20 [03:55<01:44, 20.89s/it]
Task 17, Epoch 16/20 => Loss -0.056, Train_accy 95.60:  75%|███████▌  | 15/20 [04:04<01:44, 20.89s/it]                 
Task 17, Epoch 16/20 => Loss -0.056, Train_accy 95.60:  80%|████████  | 16/20 [04:04<01:09, 17.36s/it]
Task 17, Epoch 17/20 => Loss -0.045, Train_accy 95.49:  80%|████████  | 16/20 [04:13<01:09, 17.36s/it]
Task 17, Epoch 17/20 => Loss -0.045, Train_accy 95.49:  85%|████████▌ | 17/20 [04:13<00:44, 14.93s/it]
Task 17, Epoch 18/20 => Loss -0.041, Train_accy 95.39:  85%|████████▌ | 17/20 [04:22<00:44, 14.93s/it]
Task 17, Epoch 18/20 => Loss -0.041, Train_accy 95.39:  90%|█████████ | 18/20 [04:22<00:26, 13.18s/it]
Task 17, Epoch 19/20 => Loss -0.055, Train_accy 95.70:  90%|█████████ | 18/20 [04:32<00:26, 13.18s/it]
Task 17, Epoch 19/20 => Loss -0.055, Train_accy 95.70:  95%|█████████▌| 19/20 [04:32<00:11, 11.96s/it]
Task 17, Epoch 20/20 => Loss -0.035, Train_accy 95.60, Test_accy 68.95:  95%|█████████▌| 19/20 [05:13<00:11, 11.96s/it]
Task 17, Epoch 20/20 => Loss -0.035, Train_accy 95.60, Test_accy 68.95: 100%|██████████| 20/20 [05:13<00:00, 20.88s/it]
Task 17, Epoch 20/20 => Loss -0.035, Train_accy 95.60, Test_accy 68.95: 100%|██████████| 20/20 [05:13<00:00, 15.69s/it]
2024-09-07 19:27:19,874 [l2p.py] => Task 17, Epoch 20/20 => Loss -0.035, Train_accy 95.60, Test_accy 68.95
2024-09-07 19:27:52,269 [trainer.py] => No NME accuracy.
2024-09-07 19:27:52,269 [trainer.py] => CNN: {'total': 68.95, '00-09': 72.56, '10-19': 71.51, '20-29': 63.33, '30-39': 74.4, '40-49': 62.91, '50-59': 73.68, '60-69': 70.81, '70-79': 64.47, '80-89': 65.48, '90-99': 57.63, '100-109': 60.56, '110-119': 70.48, '120-129': 70.11, '130-139': 65.1, '140-149': 82.29, '150-159': 73.2, '160-169': 61.3, '170-179': 68.55, 'old': 68.97, 'new': 68.55}
2024-09-07 19:27:52,269 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64, 69.27, 69.53, 69.47, 68.92, 68.95]
2024-09-07 19:27:52,269 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97, 88.02, 87.69, 87.38, 86.84, 87.0]

Average Accuracy (CNN): 74.36
2024-09-07 19:27:52,270 [trainer.py] => Average Accuracy (CNN): 74.36 

2024-09-07 19:27:52,272 [trainer.py] => All params: 171970192
2024-09-07 19:27:52,273 [trainer.py] => Trainable params: 199880
2024-09-07 19:27:52,273 [l2p.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.731, Train_accy 70.75:   0%|          | 0/20 [00:10<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.731, Train_accy 70.75:   5%|▌         | 1/20 [00:10<03:27, 10.90s/it]
Task 18, Epoch 2/20 => Loss 0.210, Train_accy 87.65:   5%|▌         | 1/20 [00:21<03:27, 10.90s/it]
Task 18, Epoch 2/20 => Loss 0.210, Train_accy 87.65:  10%|█         | 2/20 [00:21<03:15, 10.87s/it]
Task 18, Epoch 3/20 => Loss 0.085, Train_accy 91.68:  10%|█         | 2/20 [00:32<03:15, 10.87s/it]
Task 18, Epoch 3/20 => Loss 0.085, Train_accy 91.68:  15%|█▌        | 3/20 [00:32<03:04, 10.87s/it]
Task 18, Epoch 4/20 => Loss 0.080, Train_accy 91.24:  15%|█▌        | 3/20 [00:43<03:04, 10.87s/it]
Task 18, Epoch 4/20 => Loss 0.080, Train_accy 91.24:  20%|██        | 4/20 [00:43<02:53, 10.86s/it]
Task 18, Epoch 5/20 => Loss 0.054, Train_accy 92.99, Test_accy 67.74:  20%|██        | 4/20 [01:28<02:53, 10.86s/it]
Task 18, Epoch 5/20 => Loss 0.054, Train_accy 92.99, Test_accy 67.74:  25%|██▌       | 5/20 [01:28<05:48, 23.23s/it]
Task 18, Epoch 6/20 => Loss 0.017, Train_accy 92.82:  25%|██▌       | 5/20 [01:39<05:48, 23.23s/it]                 
Task 18, Epoch 6/20 => Loss 0.017, Train_accy 92.82:  30%|███       | 6/20 [01:39<04:26, 19.03s/it]
Task 18, Epoch 7/20 => Loss 0.068, Train_accy 92.03:  30%|███       | 6/20 [01:50<04:26, 19.03s/it]
Task 18, Epoch 7/20 => Loss 0.068, Train_accy 92.03:  35%|███▌      | 7/20 [01:50<03:32, 16.35s/it]
Task 18, Epoch 8/20 => Loss 0.034, Train_accy 93.17:  35%|███▌      | 7/20 [02:01<03:32, 16.35s/it]
Task 18, Epoch 8/20 => Loss 0.034, Train_accy 93.17:  40%|████      | 8/20 [02:01<02:55, 14.60s/it]
Task 18, Epoch 9/20 => Loss 0.035, Train_accy 93.61:  40%|████      | 8/20 [02:12<02:55, 14.60s/it]
Task 18, Epoch 9/20 => Loss 0.035, Train_accy 93.61:  45%|████▌     | 9/20 [02:12<02:27, 13.44s/it]
Task 18, Epoch 10/20 => Loss -0.004, Train_accy 94.05, Test_accy 68.04:  45%|████▌     | 9/20 [02:57<02:27, 13.44s/it]
Task 18, Epoch 10/20 => Loss -0.004, Train_accy 94.05, Test_accy 68.04:  50%|█████     | 10/20 [02:57<03:52, 23.28s/it]
Task 18, Epoch 11/20 => Loss -0.001, Train_accy 94.22:  50%|█████     | 10/20 [03:08<03:52, 23.28s/it]                 
Task 18, Epoch 11/20 => Loss -0.001, Train_accy 94.22:  55%|█████▌    | 11/20 [03:08<02:55, 19.48s/it]
Task 18, Epoch 12/20 => Loss -0.015, Train_accy 94.40:  55%|█████▌    | 11/20 [03:19<02:55, 19.48s/it]
Task 18, Epoch 12/20 => Loss -0.015, Train_accy 94.40:  60%|██████    | 12/20 [03:19<02:14, 16.84s/it]
Task 18, Epoch 13/20 => Loss -0.019, Train_accy 94.48:  60%|██████    | 12/20 [03:29<02:14, 16.84s/it]
Task 18, Epoch 13/20 => Loss -0.019, Train_accy 94.48:  65%|██████▌   | 13/20 [03:29<01:45, 15.03s/it]
Task 18, Epoch 14/20 => Loss -0.039, Train_accy 95.53:  65%|██████▌   | 13/20 [03:40<01:45, 15.03s/it]
Task 18, Epoch 14/20 => Loss -0.039, Train_accy 95.53:  70%|███████   | 14/20 [03:40<01:22, 13.79s/it]
Task 18, Epoch 15/20 => Loss -0.025, Train_accy 95.36, Test_accy 68.06:  70%|███████   | 14/20 [04:26<01:22, 13.79s/it]
Task 18, Epoch 15/20 => Loss -0.025, Train_accy 95.36, Test_accy 68.06:  75%|███████▌  | 15/20 [04:26<01:56, 23.29s/it]
Task 18, Epoch 16/20 => Loss -0.025, Train_accy 95.27:  75%|███████▌  | 15/20 [04:37<01:56, 23.29s/it]                 
Task 18, Epoch 16/20 => Loss -0.025, Train_accy 95.27:  80%|████████  | 16/20 [04:37<01:18, 19.55s/it]
Task 18, Epoch 17/20 => Loss -0.034, Train_accy 95.10:  80%|████████  | 16/20 [04:47<01:18, 19.55s/it]
Task 18, Epoch 17/20 => Loss -0.034, Train_accy 95.10:  85%|████████▌ | 17/20 [04:47<00:50, 16.93s/it]
Task 18, Epoch 18/20 => Loss -0.030, Train_accy 94.75:  85%|████████▌ | 17/20 [04:58<00:50, 16.93s/it]
Task 18, Epoch 18/20 => Loss -0.030, Train_accy 94.75:  90%|█████████ | 18/20 [04:58<00:30, 15.10s/it]
Task 18, Epoch 19/20 => Loss 0.000, Train_accy 94.75:  90%|█████████ | 18/20 [05:09<00:30, 15.10s/it] 
Task 18, Epoch 19/20 => Loss 0.000, Train_accy 94.75:  95%|█████████▌| 19/20 [05:09<00:13, 13.86s/it]
Task 18, Epoch 20/20 => Loss -0.044, Train_accy 96.06, Test_accy 67.95:  95%|█████████▌| 19/20 [05:54<00:13, 13.86s/it]
Task 18, Epoch 20/20 => Loss -0.044, Train_accy 96.06, Test_accy 67.95: 100%|██████████| 20/20 [05:54<00:00, 23.22s/it]
Task 18, Epoch 20/20 => Loss -0.044, Train_accy 96.06, Test_accy 67.95: 100%|██████████| 20/20 [05:54<00:00, 17.74s/it]
2024-09-07 19:33:47,009 [l2p.py] => Task 18, Epoch 20/20 => Loss -0.044, Train_accy 96.06, Test_accy 67.95
2024-09-07 19:34:21,037 [trainer.py] => No NME accuracy.
2024-09-07 19:34:21,038 [trainer.py] => CNN: {'total': 67.95, '00-09': 72.87, '10-19': 70.7, '20-29': 61.67, '30-39': 74.4, '40-49': 63.58, '50-59': 72.04, '60-69': 70.13, '70-79': 64.1, '80-89': 65.16, '90-99': 57.63, '100-109': 60.21, '110-119': 70.21, '120-129': 69.74, '130-139': 64.43, '140-149': 81.2, '150-159': 71.55, '160-169': 57.39, '170-179': 68.95, '180-189': 62.34, 'old': 68.27, 'new': 62.34}
2024-09-07 19:34:21,038 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64, 69.27, 69.53, 69.47, 68.92, 68.95, 67.95]
2024-09-07 19:34:21,038 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97, 88.02, 87.69, 87.38, 86.84, 87.0, 86.19]

Average Accuracy (CNN): 74.02
2024-09-07 19:34:21,039 [trainer.py] => Average Accuracy (CNN): 74.02 

2024-09-07 19:34:21,041 [trainer.py] => All params: 171970192
2024-09-07 19:34:21,043 [trainer.py] => Trainable params: 199880
2024-09-07 19:34:21,043 [l2p.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.654, Train_accy 72.34:   0%|          | 0/20 [00:10<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.654, Train_accy 72.34:   5%|▌         | 1/20 [00:10<03:27, 10.91s/it]
Task 19, Epoch 2/20 => Loss 0.094, Train_accy 91.13:   5%|▌         | 1/20 [00:21<03:27, 10.91s/it]
Task 19, Epoch 2/20 => Loss 0.094, Train_accy 91.13:  10%|█         | 2/20 [00:21<03:15, 10.86s/it]
Task 19, Epoch 3/20 => Loss 0.072, Train_accy 91.58:  10%|█         | 2/20 [00:32<03:15, 10.86s/it]
Task 19, Epoch 3/20 => Loss 0.072, Train_accy 91.58:  15%|█▌        | 3/20 [00:32<03:03, 10.79s/it]
Task 19, Epoch 4/20 => Loss 0.026, Train_accy 92.64:  15%|█▌        | 3/20 [00:43<03:03, 10.79s/it]
Task 19, Epoch 4/20 => Loss 0.026, Train_accy 92.64:  20%|██        | 4/20 [00:43<02:52, 10.78s/it]
Task 19, Epoch 5/20 => Loss -0.025, Train_accy 94.59, Test_accy 67.33:  20%|██        | 4/20 [01:29<02:52, 10.78s/it]
Task 19, Epoch 5/20 => Loss -0.025, Train_accy 94.59, Test_accy 67.33:  25%|██▌       | 5/20 [01:29<05:54, 23.62s/it]
Task 19, Epoch 6/20 => Loss -0.010, Train_accy 94.15:  25%|██▌       | 5/20 [01:40<05:54, 23.62s/it]                 
Task 19, Epoch 6/20 => Loss -0.010, Train_accy 94.15:  30%|███       | 6/20 [01:40<04:29, 19.26s/it]
Task 19, Epoch 7/20 => Loss -0.029, Train_accy 93.97:  30%|███       | 6/20 [01:51<04:29, 19.26s/it]
Task 19, Epoch 7/20 => Loss -0.029, Train_accy 93.97:  35%|███▌      | 7/20 [01:51<03:34, 16.46s/it]
Task 19, Epoch 8/20 => Loss -0.015, Train_accy 94.50:  35%|███▌      | 7/20 [02:01<03:34, 16.46s/it]
Task 19, Epoch 8/20 => Loss -0.015, Train_accy 94.50:  40%|████      | 8/20 [02:01<02:55, 14.65s/it]
Task 19, Epoch 9/20 => Loss -0.039, Train_accy 94.95:  40%|████      | 8/20 [02:12<02:55, 14.65s/it]
Task 19, Epoch 9/20 => Loss -0.039, Train_accy 94.95:  45%|████▌     | 9/20 [02:12<02:27, 13.44s/it]
Task 19, Epoch 10/20 => Loss -0.051, Train_accy 95.48, Test_accy 67.57:  45%|████▌     | 9/20 [02:59<02:27, 13.44s/it]
Task 19, Epoch 10/20 => Loss -0.051, Train_accy 95.48, Test_accy 67.57:  50%|█████     | 10/20 [02:59<03:56, 23.69s/it]
Task 19, Epoch 11/20 => Loss -0.055, Train_accy 95.12:  50%|█████     | 10/20 [03:10<03:56, 23.69s/it]                 
Task 19, Epoch 11/20 => Loss -0.055, Train_accy 95.12:  55%|█████▌    | 11/20 [03:10<02:57, 19.73s/it]
Task 19, Epoch 12/20 => Loss -0.041, Train_accy 95.12:  55%|█████▌    | 11/20 [03:20<02:57, 19.73s/it]
Task 19, Epoch 12/20 => Loss -0.041, Train_accy 95.12:  60%|██████    | 12/20 [03:20<02:15, 17.00s/it]
Task 19, Epoch 13/20 => Loss -0.058, Train_accy 95.21:  60%|██████    | 12/20 [03:31<02:15, 17.00s/it]
Task 19, Epoch 13/20 => Loss -0.058, Train_accy 95.21:  65%|██████▌   | 13/20 [03:31<01:45, 15.10s/it]
Task 19, Epoch 14/20 => Loss -0.076, Train_accy 95.83:  65%|██████▌   | 13/20 [03:42<01:45, 15.10s/it]
Task 19, Epoch 14/20 => Loss -0.076, Train_accy 95.83:  70%|███████   | 14/20 [03:42<01:22, 13.77s/it]
Task 19, Epoch 15/20 => Loss -0.038, Train_accy 94.33, Test_accy 67.92:  70%|███████   | 14/20 [04:29<01:22, 13.77s/it]
Task 19, Epoch 15/20 => Loss -0.038, Train_accy 94.33, Test_accy 67.92:  75%|███████▌  | 15/20 [04:29<01:58, 23.74s/it]
Task 19, Epoch 16/20 => Loss -0.032, Train_accy 94.24:  75%|███████▌  | 15/20 [04:39<01:58, 23.74s/it]                 
Task 19, Epoch 16/20 => Loss -0.032, Train_accy 94.24:  80%|████████  | 16/20 [04:39<01:19, 19.83s/it]
Task 19, Epoch 17/20 => Loss -0.038, Train_accy 94.59:  80%|████████  | 16/20 [04:50<01:19, 19.83s/it]
Task 19, Epoch 17/20 => Loss -0.038, Train_accy 94.59:  85%|████████▌ | 17/20 [04:50<00:51, 17.11s/it]
Task 19, Epoch 18/20 => Loss -0.055, Train_accy 94.95:  85%|████████▌ | 17/20 [05:01<00:51, 17.11s/it]
Task 19, Epoch 18/20 => Loss -0.055, Train_accy 94.95:  90%|█████████ | 18/20 [05:01<00:30, 15.20s/it]
Task 19, Epoch 19/20 => Loss -0.087, Train_accy 96.37:  90%|█████████ | 18/20 [05:12<00:30, 15.20s/it]
Task 19, Epoch 19/20 => Loss -0.087, Train_accy 96.37:  95%|█████████▌| 19/20 [05:12<00:13, 13.86s/it]
Task 19, Epoch 20/20 => Loss -0.105, Train_accy 97.16, Test_accy 67.65:  95%|█████████▌| 19/20 [05:58<00:13, 13.86s/it]
Task 19, Epoch 20/20 => Loss -0.105, Train_accy 97.16, Test_accy 67.65: 100%|██████████| 20/20 [05:58<00:00, 23.72s/it]
Task 19, Epoch 20/20 => Loss -0.105, Train_accy 97.16, Test_accy 67.65: 100%|██████████| 20/20 [05:58<00:00, 17.94s/it]
2024-09-07 19:40:19,845 [l2p.py] => Task 19, Epoch 20/20 => Loss -0.105, Train_accy 97.16, Test_accy 67.65
2024-09-07 19:40:55,692 [trainer.py] => No NME accuracy.
2024-09-07 19:40:55,693 [trainer.py] => CNN: {'total': 67.65, '00-09': 72.56, '10-19': 70.97, '20-29': 61.33, '30-39': 72.89, '40-49': 62.25, '50-59': 71.05, '60-69': 70.81, '70-79': 64.84, '80-89': 65.81, '90-99': 57.63, '100-109': 58.1, '110-119': 70.74, '120-129': 69.37, '130-139': 64.43, '140-149': 81.47, '150-159': 71.27, '160-169': 58.7, '170-179': 67.74, '180-189': 61.69, '190-199': 66.42, 'old': 67.71, 'new': 66.42}
2024-09-07 19:40:55,693 [trainer.py] => CNN top1 curve: [90.54, 84.03, 79.47, 78.27, 76.4, 76.13, 75.1, 74.62, 73.29, 72.7, 71.64, 70.51, 69.64, 69.27, 69.53, 69.47, 68.92, 68.95, 67.95, 67.65]
2024-09-07 19:40:55,693 [trainer.py] => CNN top5 curve: [98.74, 96.81, 94.44, 93.57, 91.56, 91.33, 91.1, 90.83, 89.74, 89.21, 88.9, 88.7, 87.97, 88.02, 87.69, 87.38, 86.84, 87.0, 86.19, 85.72]

Average Accuracy (CNN): 73.7
2024-09-07 19:40:55,693 [trainer.py] => Average Accuracy (CNN): 73.7 

Accuracy Matrix (CNN):
[[90.54 86.75 82.97 81.07 80.13 80.13 78.23 76.97 76.66 76.97 73.5  73.82
  73.5  73.19 71.61 72.24 73.19 72.56 72.87 72.56]
 [ 0.   81.72 80.65 79.03 78.23 78.49 77.96 79.03 77.96 77.96 77.42 74.73
  72.58 72.31 72.31 73.92 72.31 71.51 70.7  70.97]
 [ 0.    0.   74.33 74.   74.33 73.   72.67 72.   72.67 73.67 73.33 66.67
  64.33 65.   63.67 64.   63.33 63.33 61.67 61.33]
 [ 0.    0.    0.   78.61 78.31 78.31 77.71 78.31 76.51 77.11 77.11 77.71
  75.3  76.2  74.1  74.1  74.1  74.4  74.4  72.89]
 [ 0.    0.    0.    0.   70.2  70.53 69.87 68.87 68.21 68.87 68.54 69.21
  66.23 66.56 65.23 63.91 63.25 62.91 63.58 62.25]
 [ 0.    0.    0.    0.    0.   75.33 75.99 75.99 74.34 75.   74.67 74.34
  73.36 73.36 73.36 72.7  73.36 73.68 72.04 71.05]
 [ 0.    0.    0.    0.    0.    0.   72.15 72.48 72.48 71.81 73.15 72.15
  71.48 71.14 70.81 71.14 70.13 70.81 70.13 70.81]
 [ 0.    0.    0.    0.    0.    0.    0.   71.43 71.43 69.6  68.86 67.77
  67.77 66.3  65.57 64.47 65.93 64.47 64.1  64.84]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   67.74 68.39 67.42 64.52
  65.16 65.16 63.23 63.55 63.87 65.48 65.16 65.81]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   60.45 60.45 59.32
  59.89 59.32 59.32 57.63 58.76 57.63 57.63 57.63]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   66.55 64.44
  63.03 63.03 61.27 60.56 59.51 60.56 60.21 58.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   73.67
  72.34 72.87 71.54 71.28 71.01 70.48 70.21 70.74]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  74.17 72.69 70.48 68.63 69.   70.11 69.74 69.37]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   65.77 67.45 64.77 65.44 65.1  64.43 64.43]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   83.38 83.11 82.29 82.29 81.2  81.47]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   73.76 73.2  73.2  71.55 71.27]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   60.   61.3  57.39 58.7 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   68.55 68.95 67.74]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   62.34 61.69]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   66.42]]
2024-09-07 19:40:55,697 [trainer.py] => Forgetting (CNN): 5.4242105263157905
2024-09-07 19:40:58,516 [trainer.py] => config: ./exps/l2p_inr_B100_Inc5.json
2024-09-07 19:40:58,538 [trainer.py] => prefix:  
2024-09-07 19:40:58,538 [trainer.py] => dataset: imagenetr
2024-09-07 19:40:58,538 [trainer.py] => memory_size: 0
2024-09-07 19:40:58,538 [trainer.py] => memory_per_class: 0
2024-09-07 19:40:58,538 [trainer.py] => fixed_memory: False
2024-09-07 19:40:58,538 [trainer.py] => shuffle: True
2024-09-07 19:40:58,538 [trainer.py] => init_cls: 100
2024-09-07 19:40:58,539 [trainer.py] => increment: 20
2024-09-07 19:40:58,539 [trainer.py] => model_name: l2p
2024-09-07 19:40:58,539 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 19:40:58,539 [trainer.py] => get_original_backbone: True
2024-09-07 19:40:58,539 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 19:40:58,539 [trainer.py] => seed: 1993
2024-09-07 19:40:58,539 [trainer.py] => tuned_epoch: 20
2024-09-07 19:40:58,539 [trainer.py] => init_lr: 0.001875
2024-09-07 19:40:58,539 [trainer.py] => batch_size: 48
2024-09-07 19:40:58,539 [trainer.py] => weight_decay: 0
2024-09-07 19:40:58,539 [trainer.py] => min_lr: 1e-05
2024-09-07 19:40:58,539 [trainer.py] => optimizer: adam
2024-09-07 19:40:58,539 [trainer.py] => scheduler: constant
2024-09-07 19:40:58,539 [trainer.py] => reinit_optimizer: True
2024-09-07 19:40:58,539 [trainer.py] => global_pool: token
2024-09-07 19:40:58,539 [trainer.py] => head_type: prompt
2024-09-07 19:40:58,539 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 19:40:58,539 [trainer.py] => pretrained: True
2024-09-07 19:40:58,539 [trainer.py] => drop: 0.0
2024-09-07 19:40:58,539 [trainer.py] => drop_path: 0.0
2024-09-07 19:40:58,539 [trainer.py] => prompt_pool: True
2024-09-07 19:40:58,539 [trainer.py] => size: 10
2024-09-07 19:40:58,539 [trainer.py] => length: 5
2024-09-07 19:40:58,540 [trainer.py] => top_k: 5
2024-09-07 19:40:58,540 [trainer.py] => initializer: uniform
2024-09-07 19:40:58,540 [trainer.py] => prompt_key: True
2024-09-07 19:40:58,540 [trainer.py] => prompt_key_init: uniform
2024-09-07 19:40:58,540 [trainer.py] => use_prompt_mask: False
2024-09-07 19:40:58,540 [trainer.py] => shared_prompt_pool: False
2024-09-07 19:40:58,540 [trainer.py] => shared_prompt_key: False
2024-09-07 19:40:58,540 [trainer.py] => batchwise_prompt: True
2024-09-07 19:40:58,540 [trainer.py] => embedding_key: cls
2024-09-07 19:40:58,540 [trainer.py] => predefined_key: 
2024-09-07 19:40:58,540 [trainer.py] => pull_constraint: True
2024-09-07 19:40:58,540 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 19:40:58,628 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 19:41:00,128 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 19:41:00,129 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 19:41:02,092 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 19:41:02,093 [l2p.py] => 199,880 model training parameters.
2024-09-07 19:41:02,093 [l2p.py] => prompt.prompt: 38400
2024-09-07 19:41:02,093 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 19:41:02,093 [l2p.py] => head.weight: 153600
2024-09-07 19:41:02,093 [l2p.py] => head.bias: 200
2024-09-07 19:41:02,094 [trainer.py] => All params: 171970192
2024-09-07 19:41:02,095 [trainer.py] => Trainable params: 199880
2024-09-07 19:41:02,095 [l2p.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.419, Train_accy 47.34:   0%|          | 0/20 [01:51<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.419, Train_accy 47.34:   5%|▌         | 1/20 [01:51<35:09, 111.01s/it]
Task 0, Epoch 2/20 => Loss 1.330, Train_accy 65.75:   5%|▌         | 1/20 [03:41<35:09, 111.01s/it]
Task 0, Epoch 2/20 => Loss 1.330, Train_accy 65.75:  10%|█         | 2/20 [03:41<33:17, 110.97s/it]
Task 0, Epoch 3/20 => Loss 1.089, Train_accy 69.85:  10%|█         | 2/20 [05:32<33:17, 110.97s/it]
Task 0, Epoch 3/20 => Loss 1.089, Train_accy 69.85:  15%|█▌        | 3/20 [05:32<31:26, 110.96s/it]
Task 0, Epoch 4/20 => Loss 0.924, Train_accy 72.95:  15%|█▌        | 3/20 [07:24<31:26, 110.96s/it]
Task 0, Epoch 4/20 => Loss 0.924, Train_accy 72.95:  20%|██        | 4/20 [07:24<29:38, 111.15s/it]
Task 0, Epoch 5/20 => Loss 0.816, Train_accy 75.49, Test_accy 78.16:  20%|██        | 4/20 [09:34<29:38, 111.15s/it]
Task 0, Epoch 5/20 => Loss 0.816, Train_accy 75.49, Test_accy 78.16:  25%|██▌       | 5/20 [09:34<29:29, 117.95s/it]
Task 0, Epoch 6/20 => Loss 0.770, Train_accy 76.76:  25%|██▌       | 5/20 [11:25<29:29, 117.95s/it]                 
Task 0, Epoch 6/20 => Loss 0.770, Train_accy 76.76:  30%|███       | 6/20 [11:25<27:01, 115.80s/it]
Task 0, Epoch 7/20 => Loss 0.710, Train_accy 78.30:  30%|███       | 6/20 [13:17<27:01, 115.80s/it]
Task 0, Epoch 7/20 => Loss 0.710, Train_accy 78.30:  35%|███▌      | 7/20 [13:17<24:47, 114.45s/it]
Task 0, Epoch 8/20 => Loss 0.649, Train_accy 79.52:  35%|███▌      | 7/20 [15:08<24:47, 114.45s/it]
Task 0, Epoch 8/20 => Loss 0.649, Train_accy 79.52:  40%|████      | 8/20 [15:08<22:41, 113.46s/it]
Task 0, Epoch 9/20 => Loss 0.617, Train_accy 79.85:  40%|████      | 8/20 [17:00<22:41, 113.46s/it]
Task 0, Epoch 9/20 => Loss 0.617, Train_accy 79.85:  45%|████▌     | 9/20 [17:00<20:41, 112.86s/it]
Task 0, Epoch 10/20 => Loss 0.612, Train_accy 80.54, Test_accy 78.06:  45%|████▌     | 9/20 [19:09<20:41, 112.86s/it]
Task 0, Epoch 10/20 => Loss 0.612, Train_accy 80.54, Test_accy 78.06:  50%|█████     | 10/20 [19:09<19:39, 117.98s/it]
Task 0, Epoch 11/20 => Loss 0.596, Train_accy 80.68:  50%|█████     | 10/20 [21:01<19:39, 117.98s/it]                 
Task 0, Epoch 11/20 => Loss 0.596, Train_accy 80.68:  55%|█████▌    | 11/20 [21:01<17:24, 116.07s/it]
Task 0, Epoch 12/20 => Loss 0.562, Train_accy 81.56:  55%|█████▌    | 11/20 [22:53<17:24, 116.07s/it]
Task 0, Epoch 12/20 => Loss 0.562, Train_accy 81.56:  60%|██████    | 12/20 [22:53<15:17, 114.64s/it]
Task 0, Epoch 13/20 => Loss 0.514, Train_accy 82.54:  60%|██████    | 12/20 [24:44<15:17, 114.64s/it]
Task 0, Epoch 13/20 => Loss 0.514, Train_accy 82.54:  65%|██████▌   | 13/20 [24:44<13:16, 113.81s/it]
Task 0, Epoch 14/20 => Loss 0.520, Train_accy 82.68:  65%|██████▌   | 13/20 [26:36<13:16, 113.81s/it]
Task 0, Epoch 14/20 => Loss 0.520, Train_accy 82.68:  70%|███████   | 14/20 [26:36<11:18, 113.15s/it]
Task 0, Epoch 15/20 => Loss 0.515, Train_accy 82.98, Test_accy 78.16:  70%|███████   | 14/20 [28:45<11:18, 113.15s/it]
Task 0, Epoch 15/20 => Loss 0.515, Train_accy 82.98, Test_accy 78.16:  75%|███████▌  | 15/20 [28:45<09:49, 117.92s/it]
Task 0, Epoch 16/20 => Loss 0.483, Train_accy 83.25:  75%|███████▌  | 15/20 [30:36<09:49, 117.92s/it]                 
Task 0, Epoch 16/20 => Loss 0.483, Train_accy 83.25:  80%|████████  | 16/20 [30:36<07:43, 115.81s/it]
Task 0, Epoch 17/20 => Loss 0.490, Train_accy 83.44:  80%|████████  | 16/20 [32:27<07:43, 115.81s/it]
Task 0, Epoch 17/20 => Loss 0.490, Train_accy 83.44:  85%|████████▌ | 17/20 [32:27<05:43, 114.34s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 83.84:  85%|████████▌ | 17/20 [34:18<05:43, 114.34s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 83.84:  90%|█████████ | 18/20 [34:18<03:46, 113.31s/it]
Task 0, Epoch 19/20 => Loss 0.479, Train_accy 83.50:  90%|█████████ | 18/20 [36:09<03:46, 113.31s/it]
Task 0, Epoch 19/20 => Loss 0.479, Train_accy 83.50:  95%|█████████▌| 19/20 [36:09<01:52, 112.62s/it]
Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16:  95%|█████████▌| 19/20 [38:18<01:52, 112.62s/it]
Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16: 100%|██████████| 20/20 [38:18<00:00, 117.54s/it]
Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16: 100%|██████████| 20/20 [38:18<00:00, 114.92s/it]
2024-09-07 20:19:21,308 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16
2024-09-07 20:19:39,461 [trainer.py] => No NME accuracy.
2024-09-07 20:19:39,461 [trainer.py] => CNN: {'total': 78.16, '00-99': 78.16, 'old': 0, 'new': 78.16}
2024-09-07 20:19:39,461 [trainer.py] => CNN top1 curve: [78.16]
2024-09-07 20:19:39,462 [trainer.py] => CNN top5 curve: [91.46]

Average Accuracy (CNN): 78.16
2024-09-07 20:19:39,462 [trainer.py] => Average Accuracy (CNN): 78.16 

2024-09-07 20:19:39,464 [trainer.py] => All params: 171970192
2024-09-07 20:19:39,466 [trainer.py] => Trainable params: 199880
2024-09-07 20:19:39,466 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.924, Train_accy 68.22:   0%|          | 0/20 [00:24<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.924, Train_accy 68.22:   5%|▌         | 1/20 [00:24<07:50, 24.76s/it]
Task 1, Epoch 2/20 => Loss 0.346, Train_accy 84.35:   5%|▌         | 1/20 [00:49<07:50, 24.76s/it]
Task 1, Epoch 2/20 => Loss 0.346, Train_accy 84.35:  10%|█         | 2/20 [00:49<07:24, 24.71s/it]
Task 1, Epoch 3/20 => Loss 0.269, Train_accy 86.90:  10%|█         | 2/20 [01:14<07:24, 24.71s/it]
Task 1, Epoch 3/20 => Loss 0.269, Train_accy 86.90:  15%|█▌        | 3/20 [01:14<07:00, 24.76s/it]
Task 1, Epoch 4/20 => Loss 0.183, Train_accy 88.63:  15%|█▌        | 3/20 [01:39<07:00, 24.76s/it]
Task 1, Epoch 4/20 => Loss 0.183, Train_accy 88.63:  20%|██        | 4/20 [01:39<06:37, 24.82s/it]
Task 1, Epoch 5/20 => Loss 0.152, Train_accy 89.76, Test_accy 71.60:  20%|██        | 4/20 [02:26<06:37, 24.82s/it]
Task 1, Epoch 5/20 => Loss 0.152, Train_accy 89.76, Test_accy 71.60:  25%|██▌       | 5/20 [02:26<08:11, 32.77s/it]
Task 1, Epoch 6/20 => Loss 0.158, Train_accy 89.53:  25%|██▌       | 5/20 [02:50<08:11, 32.77s/it]                 
Task 1, Epoch 6/20 => Loss 0.158, Train_accy 89.53:  30%|███       | 6/20 [02:50<07:00, 30.06s/it]
Task 1, Epoch 7/20 => Loss 0.142, Train_accy 90.43:  30%|███       | 6/20 [03:15<07:00, 30.06s/it]
Task 1, Epoch 7/20 => Loss 0.142, Train_accy 90.43:  35%|███▌      | 7/20 [03:15<06:08, 28.33s/it]
Task 1, Epoch 8/20 => Loss 0.113, Train_accy 91.26:  35%|███▌      | 7/20 [03:40<06:08, 28.33s/it]
Task 1, Epoch 8/20 => Loss 0.113, Train_accy 91.26:  40%|████      | 8/20 [03:40<05:26, 27.19s/it]
Task 1, Epoch 9/20 => Loss 0.104, Train_accy 90.92:  40%|████      | 8/20 [04:05<05:26, 27.19s/it]
Task 1, Epoch 9/20 => Loss 0.104, Train_accy 90.92:  45%|████▌     | 9/20 [04:05<04:50, 26.41s/it]
Task 1, Epoch 10/20 => Loss 0.113, Train_accy 91.37, Test_accy 72.67:  45%|████▌     | 9/20 [04:52<04:50, 26.41s/it]
Task 1, Epoch 10/20 => Loss 0.113, Train_accy 91.37, Test_accy 72.67:  50%|█████     | 10/20 [04:52<05:27, 32.78s/it]
Task 1, Epoch 11/20 => Loss 0.125, Train_accy 90.99:  50%|█████     | 10/20 [05:16<05:27, 32.78s/it]                 
Task 1, Epoch 11/20 => Loss 0.125, Train_accy 90.99:  55%|█████▌    | 11/20 [05:16<04:33, 30.34s/it]
Task 1, Epoch 12/20 => Loss 0.082, Train_accy 91.82:  55%|█████▌    | 11/20 [05:41<04:33, 30.34s/it]
Task 1, Epoch 12/20 => Loss 0.082, Train_accy 91.82:  60%|██████    | 12/20 [05:41<03:49, 28.65s/it]
Task 1, Epoch 13/20 => Loss 0.077, Train_accy 92.57:  60%|██████    | 12/20 [06:06<03:49, 28.65s/it]
Task 1, Epoch 13/20 => Loss 0.077, Train_accy 92.57:  65%|██████▌   | 13/20 [06:06<03:12, 27.50s/it]
Task 1, Epoch 14/20 => Loss 0.121, Train_accy 90.81:  65%|██████▌   | 13/20 [06:31<03:12, 27.50s/it]
Task 1, Epoch 14/20 => Loss 0.121, Train_accy 90.81:  70%|███████   | 14/20 [06:31<02:40, 26.69s/it]
Task 1, Epoch 15/20 => Loss 0.100, Train_accy 91.89, Test_accy 73.66:  70%|███████   | 14/20 [07:18<02:40, 26.69s/it]
Task 1, Epoch 15/20 => Loss 0.100, Train_accy 91.89, Test_accy 73.66:  75%|███████▌  | 15/20 [07:18<02:43, 32.76s/it]
Task 1, Epoch 16/20 => Loss 0.083, Train_accy 92.16:  75%|███████▌  | 15/20 [07:42<02:43, 32.76s/it]                 
Task 1, Epoch 16/20 => Loss 0.083, Train_accy 92.16:  80%|████████  | 16/20 [07:42<02:01, 30.36s/it]
Task 1, Epoch 17/20 => Loss 0.075, Train_accy 92.20:  80%|████████  | 16/20 [08:07<02:01, 30.36s/it]
Task 1, Epoch 17/20 => Loss 0.075, Train_accy 92.20:  85%|████████▌ | 17/20 [08:07<01:25, 28.66s/it]
Task 1, Epoch 18/20 => Loss 0.071, Train_accy 92.27:  85%|████████▌ | 17/20 [08:32<01:25, 28.66s/it]
Task 1, Epoch 18/20 => Loss 0.071, Train_accy 92.27:  90%|█████████ | 18/20 [08:32<00:55, 27.54s/it]
Task 1, Epoch 19/20 => Loss 0.047, Train_accy 93.21:  90%|█████████ | 18/20 [08:57<00:55, 27.54s/it]
Task 1, Epoch 19/20 => Loss 0.047, Train_accy 93.21:  95%|█████████▌| 19/20 [08:57<00:26, 26.68s/it]
Task 1, Epoch 20/20 => Loss 0.050, Train_accy 92.87, Test_accy 74.43:  95%|█████████▌| 19/20 [09:44<00:26, 26.68s/it]
Task 1, Epoch 20/20 => Loss 0.050, Train_accy 92.87, Test_accy 74.43: 100%|██████████| 20/20 [09:44<00:00, 32.77s/it]
Task 1, Epoch 20/20 => Loss 0.050, Train_accy 92.87, Test_accy 74.43: 100%|██████████| 20/20 [09:44<00:00, 29.21s/it]
2024-09-07 20:29:23,726 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.050, Train_accy 92.87, Test_accy 74.43
2024-09-07 20:29:45,760 [trainer.py] => No NME accuracy.
2024-09-07 20:29:45,761 [trainer.py] => CNN: {'total': 74.43, '00-99': 78.59, '100-119': 55.61, 'old': 78.59, 'new': 55.61}
2024-09-07 20:29:45,761 [trainer.py] => CNN top1 curve: [78.16, 74.43]
2024-09-07 20:29:45,761 [trainer.py] => CNN top5 curve: [91.46, 90.18]

Average Accuracy (CNN): 76.3
2024-09-07 20:29:45,761 [trainer.py] => Average Accuracy (CNN): 76.3 

2024-09-07 20:29:45,764 [trainer.py] => All params: 171970192
2024-09-07 20:29:45,766 [trainer.py] => Trainable params: 199880
2024-09-07 20:29:45,766 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.913, Train_accy 69.49:   0%|          | 0/20 [00:19<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.913, Train_accy 69.49:   5%|▌         | 1/20 [00:19<06:18, 19.90s/it]
Task 2, Epoch 2/20 => Loss 0.318, Train_accy 85.12:   5%|▌         | 1/20 [00:39<06:18, 19.90s/it]
Task 2, Epoch 2/20 => Loss 0.318, Train_accy 85.12:  10%|█         | 2/20 [00:39<05:57, 19.84s/it]
Task 2, Epoch 3/20 => Loss 0.266, Train_accy 86.68:  10%|█         | 2/20 [00:59<05:57, 19.84s/it]
Task 2, Epoch 3/20 => Loss 0.266, Train_accy 86.68:  15%|█▌        | 3/20 [00:59<05:37, 19.88s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 89.03:  15%|█▌        | 3/20 [01:19<05:37, 19.88s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 89.03:  20%|██        | 4/20 [01:19<05:18, 19.92s/it]
Task 2, Epoch 5/20 => Loss 0.111, Train_accy 91.67, Test_accy 68.11:  20%|██        | 4/20 [02:04<05:18, 19.92s/it]
Task 2, Epoch 5/20 => Loss 0.111, Train_accy 91.67, Test_accy 68.11:  25%|██▌       | 5/20 [02:04<07:16, 29.07s/it]
Task 2, Epoch 6/20 => Loss 0.116, Train_accy 91.05:  25%|██▌       | 5/20 [02:24<07:16, 29.07s/it]                 
Task 2, Epoch 6/20 => Loss 0.116, Train_accy 91.05:  30%|███       | 6/20 [02:24<06:02, 25.92s/it]
Task 2, Epoch 7/20 => Loss 0.134, Train_accy 90.91:  30%|███       | 6/20 [02:44<06:02, 25.92s/it]
Task 2, Epoch 7/20 => Loss 0.134, Train_accy 90.91:  35%|███▌      | 7/20 [02:44<05:10, 23.92s/it]
Task 2, Epoch 8/20 => Loss 0.093, Train_accy 92.33:  35%|███▌      | 7/20 [03:04<05:10, 23.92s/it]
Task 2, Epoch 8/20 => Loss 0.093, Train_accy 92.33:  40%|████      | 8/20 [03:04<04:31, 22.65s/it]
Task 2, Epoch 9/20 => Loss 0.062, Train_accy 92.89:  40%|████      | 8/20 [03:24<04:31, 22.65s/it]
Task 2, Epoch 9/20 => Loss 0.062, Train_accy 92.89:  45%|████▌     | 9/20 [03:24<03:59, 21.78s/it]
Task 2, Epoch 10/20 => Loss 0.052, Train_accy 93.08, Test_accy 68.98:  45%|████▌     | 9/20 [04:09<03:59, 21.78s/it]
Task 2, Epoch 10/20 => Loss 0.052, Train_accy 93.08, Test_accy 68.98:  50%|█████     | 10/20 [04:09<04:50, 29.08s/it]
Task 2, Epoch 11/20 => Loss 0.078, Train_accy 92.56:  50%|█████     | 10/20 [04:29<04:50, 29.08s/it]                 
Task 2, Epoch 11/20 => Loss 0.078, Train_accy 92.56:  55%|█████▌    | 11/20 [04:29<03:56, 26.25s/it]
Task 2, Epoch 12/20 => Loss 0.072, Train_accy 92.89:  55%|█████▌    | 11/20 [04:49<03:56, 26.25s/it]
Task 2, Epoch 12/20 => Loss 0.072, Train_accy 92.89:  60%|██████    | 12/20 [04:49<03:14, 24.31s/it]
Task 2, Epoch 13/20 => Loss 0.040, Train_accy 93.13:  60%|██████    | 12/20 [05:09<03:14, 24.31s/it]
Task 2, Epoch 13/20 => Loss 0.040, Train_accy 93.13:  65%|██████▌   | 13/20 [05:09<02:40, 22.95s/it]
Task 2, Epoch 14/20 => Loss 0.055, Train_accy 93.08:  65%|██████▌   | 13/20 [05:29<02:40, 22.95s/it]
Task 2, Epoch 14/20 => Loss 0.055, Train_accy 93.08:  70%|███████   | 14/20 [05:29<02:12, 22.09s/it]
Task 2, Epoch 15/20 => Loss 0.057, Train_accy 92.94, Test_accy 69.86:  70%|███████   | 14/20 [06:14<02:12, 22.09s/it]
Task 2, Epoch 15/20 => Loss 0.057, Train_accy 92.94, Test_accy 69.86:  75%|███████▌  | 15/20 [06:14<02:25, 29.18s/it]
Task 2, Epoch 16/20 => Loss 0.038, Train_accy 93.41:  75%|███████▌  | 15/20 [06:34<02:25, 29.18s/it]                 
Task 2, Epoch 16/20 => Loss 0.038, Train_accy 93.41:  80%|████████  | 16/20 [06:34<01:45, 26.37s/it]
Task 2, Epoch 17/20 => Loss 0.025, Train_accy 94.11:  80%|████████  | 16/20 [06:54<01:45, 26.37s/it]
Task 2, Epoch 17/20 => Loss 0.025, Train_accy 94.11:  85%|████████▌ | 17/20 [06:54<01:13, 24.43s/it]
Task 2, Epoch 18/20 => Loss 0.048, Train_accy 92.75:  85%|████████▌ | 17/20 [07:14<01:13, 24.43s/it]
Task 2, Epoch 18/20 => Loss 0.048, Train_accy 92.75:  90%|█████████ | 18/20 [07:14<00:46, 23.06s/it]
Task 2, Epoch 19/20 => Loss -0.002, Train_accy 94.54:  90%|█████████ | 18/20 [07:34<00:46, 23.06s/it]
Task 2, Epoch 19/20 => Loss -0.002, Train_accy 94.54:  95%|█████████▌| 19/20 [07:34<00:22, 22.10s/it]
Task 2, Epoch 20/20 => Loss 0.015, Train_accy 94.35, Test_accy 70.12:  95%|█████████▌| 19/20 [08:19<00:22, 22.10s/it]
Task 2, Epoch 20/20 => Loss 0.015, Train_accy 94.35, Test_accy 70.12: 100%|██████████| 20/20 [08:19<00:00, 29.07s/it]
Task 2, Epoch 20/20 => Loss 0.015, Train_accy 94.35, Test_accy 70.12: 100%|██████████| 20/20 [08:19<00:00, 24.99s/it]
2024-09-07 20:38:05,573 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.015, Train_accy 94.35, Test_accy 70.12
2024-09-07 20:38:30,958 [trainer.py] => No NME accuracy.
2024-09-07 20:38:30,959 [trainer.py] => CNN: {'total': 70.12, '00-99': 78.83, '100-119': 55.3, '120-139': 41.65, 'old': 74.57, 'new': 41.65}
2024-09-07 20:38:30,959 [trainer.py] => CNN top1 curve: [78.16, 74.43, 70.12]
2024-09-07 20:38:30,959 [trainer.py] => CNN top5 curve: [91.46, 90.18, 88.66]

Average Accuracy (CNN): 74.24
2024-09-07 20:38:30,959 [trainer.py] => Average Accuracy (CNN): 74.24 

2024-09-07 20:38:30,962 [trainer.py] => All params: 171970192
2024-09-07 20:38:30,964 [trainer.py] => Trainable params: 199880
2024-09-07 20:38:30,964 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.791, Train_accy 72.37:   0%|          | 0/20 [00:26<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.791, Train_accy 72.37:   5%|▌         | 1/20 [00:26<08:17, 26.17s/it]
Task 3, Epoch 2/20 => Loss 0.271, Train_accy 86.90:   5%|▌         | 1/20 [00:52<08:17, 26.17s/it]
Task 3, Epoch 2/20 => Loss 0.271, Train_accy 86.90:  10%|█         | 2/20 [00:52<07:50, 26.15s/it]
Task 3, Epoch 3/20 => Loss 0.213, Train_accy 88.07:  10%|█         | 2/20 [01:18<07:50, 26.15s/it]
Task 3, Epoch 3/20 => Loss 0.213, Train_accy 88.07:  15%|█▌        | 3/20 [01:18<07:24, 26.15s/it]
Task 3, Epoch 4/20 => Loss 0.161, Train_accy 89.45:  15%|█▌        | 3/20 [01:44<07:24, 26.15s/it]
Task 3, Epoch 4/20 => Loss 0.161, Train_accy 89.45:  20%|██        | 4/20 [01:44<06:57, 26.10s/it]
Task 3, Epoch 5/20 => Loss 0.169, Train_accy 89.28, Test_accy 64.94:  20%|██        | 4/20 [02:40<06:57, 26.10s/it]
Task 3, Epoch 5/20 => Loss 0.169, Train_accy 89.28, Test_accy 64.94:  25%|██▌       | 5/20 [02:40<09:11, 36.78s/it]
Task 3, Epoch 6/20 => Loss 0.149, Train_accy 90.31:  25%|██▌       | 5/20 [03:06<09:11, 36.78s/it]                 
Task 3, Epoch 6/20 => Loss 0.149, Train_accy 90.31:  30%|███       | 6/20 [03:06<07:44, 33.17s/it]
Task 3, Epoch 7/20 => Loss 0.099, Train_accy 91.94:  30%|███       | 6/20 [03:32<07:44, 33.17s/it]
Task 3, Epoch 7/20 => Loss 0.099, Train_accy 91.94:  35%|███▌      | 7/20 [03:32<06:40, 30.84s/it]
Task 3, Epoch 8/20 => Loss 0.096, Train_accy 92.08:  35%|███▌      | 7/20 [03:58<06:40, 30.84s/it]
Task 3, Epoch 8/20 => Loss 0.096, Train_accy 92.08:  40%|████      | 8/20 [03:58<05:52, 29.36s/it]
Task 3, Epoch 9/20 => Loss 0.081, Train_accy 91.69:  40%|████      | 8/20 [04:24<05:52, 29.36s/it]
Task 3, Epoch 9/20 => Loss 0.081, Train_accy 91.69:  45%|████▌     | 9/20 [04:24<05:11, 28.34s/it]
Task 3, Epoch 10/20 => Loss 0.097, Train_accy 91.58, Test_accy 66.07:  45%|████▌     | 9/20 [05:20<05:11, 28.34s/it]
Task 3, Epoch 10/20 => Loss 0.097, Train_accy 91.58, Test_accy 66.07:  50%|█████     | 10/20 [05:20<06:07, 36.73s/it]
Task 3, Epoch 11/20 => Loss 0.065, Train_accy 92.05:  50%|█████     | 10/20 [05:46<06:07, 36.73s/it]                 
Task 3, Epoch 11/20 => Loss 0.065, Train_accy 92.05:  55%|█████▌    | 11/20 [05:46<05:01, 33.51s/it]
Task 3, Epoch 12/20 => Loss 0.082, Train_accy 92.05:  55%|█████▌    | 11/20 [06:12<05:01, 33.51s/it]
Task 3, Epoch 12/20 => Loss 0.082, Train_accy 92.05:  60%|██████    | 12/20 [06:12<04:09, 31.24s/it]
Task 3, Epoch 13/20 => Loss 0.056, Train_accy 92.97:  60%|██████    | 12/20 [06:38<04:09, 31.24s/it]
Task 3, Epoch 13/20 => Loss 0.056, Train_accy 92.97:  65%|██████▌   | 13/20 [06:38<03:27, 29.68s/it]
Task 3, Epoch 14/20 => Loss 0.058, Train_accy 93.22:  65%|██████▌   | 13/20 [07:04<03:27, 29.68s/it]
Task 3, Epoch 14/20 => Loss 0.058, Train_accy 93.22:  70%|███████   | 14/20 [07:04<02:51, 28.58s/it]
Task 3, Epoch 15/20 => Loss 0.052, Train_accy 92.97, Test_accy 66.92:  70%|███████   | 14/20 [08:00<02:51, 28.58s/it]
Task 3, Epoch 15/20 => Loss 0.052, Train_accy 92.97, Test_accy 66.92:  75%|███████▌  | 15/20 [08:00<03:04, 36.89s/it]
Task 3, Epoch 16/20 => Loss 0.062, Train_accy 92.26:  75%|███████▌  | 15/20 [08:27<03:04, 36.89s/it]                 
Task 3, Epoch 16/20 => Loss 0.062, Train_accy 92.26:  80%|████████  | 16/20 [08:27<02:15, 33.81s/it]
Task 3, Epoch 17/20 => Loss 0.069, Train_accy 92.65:  80%|████████  | 16/20 [08:53<02:15, 33.81s/it]
Task 3, Epoch 17/20 => Loss 0.069, Train_accy 92.65:  85%|████████▌ | 17/20 [08:53<01:34, 31.50s/it]
Task 3, Epoch 18/20 => Loss 0.064, Train_accy 92.26:  85%|████████▌ | 17/20 [09:19<01:34, 31.50s/it]
Task 3, Epoch 18/20 => Loss 0.064, Train_accy 92.26:  90%|█████████ | 18/20 [09:19<00:59, 29.89s/it]
Task 3, Epoch 19/20 => Loss 0.059, Train_accy 93.11:  90%|█████████ | 18/20 [09:45<00:59, 29.89s/it]
Task 3, Epoch 19/20 => Loss 0.059, Train_accy 93.11:  95%|█████████▌| 19/20 [09:45<00:28, 28.77s/it]
Task 3, Epoch 20/20 => Loss 0.050, Train_accy 93.18, Test_accy 67.73:  95%|█████████▌| 19/20 [10:41<00:28, 28.77s/it]
Task 3, Epoch 20/20 => Loss 0.050, Train_accy 93.18, Test_accy 67.73: 100%|██████████| 20/20 [10:41<00:00, 36.87s/it]
Task 3, Epoch 20/20 => Loss 0.050, Train_accy 93.18, Test_accy 67.73: 100%|██████████| 20/20 [10:41<00:00, 32.08s/it]
2024-09-07 20:49:12,557 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.050, Train_accy 93.18, Test_accy 67.73
2024-09-07 20:49:42,408 [trainer.py] => No NME accuracy.
2024-09-07 20:49:42,409 [trainer.py] => CNN: {'total': 67.73, '00-99': 78.66, '100-119': 54.55, '120-139': 41.3, '140-159': 55.56, 'old': 69.84, 'new': 55.56}
2024-09-07 20:49:42,409 [trainer.py] => CNN top1 curve: [78.16, 74.43, 70.12, 67.73]
2024-09-07 20:49:42,409 [trainer.py] => CNN top5 curve: [91.46, 90.18, 88.66, 88.06]

Average Accuracy (CNN): 72.61
2024-09-07 20:49:42,409 [trainer.py] => Average Accuracy (CNN): 72.61 

2024-09-07 20:49:42,412 [trainer.py] => All params: 171970192
2024-09-07 20:49:42,413 [trainer.py] => Trainable params: 199880
2024-09-07 20:49:42,414 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.135, Train_accy 62.47:   0%|          | 0/20 [00:18<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.135, Train_accy 62.47:   5%|▌         | 1/20 [00:18<05:46, 18.26s/it]
Task 4, Epoch 2/20 => Loss 0.435, Train_accy 82.03:   5%|▌         | 1/20 [00:36<05:46, 18.26s/it]
Task 4, Epoch 2/20 => Loss 0.435, Train_accy 82.03:  10%|█         | 2/20 [00:36<05:28, 18.27s/it]
Task 4, Epoch 3/20 => Loss 0.312, Train_accy 85.52:  10%|█         | 2/20 [00:54<05:28, 18.27s/it]
Task 4, Epoch 3/20 => Loss 0.312, Train_accy 85.52:  15%|█▌        | 3/20 [00:54<05:11, 18.29s/it]
Task 4, Epoch 4/20 => Loss 0.265, Train_accy 87.53:  15%|█▌        | 3/20 [01:13<05:11, 18.29s/it]
Task 4, Epoch 4/20 => Loss 0.265, Train_accy 87.53:  20%|██        | 4/20 [01:13<04:52, 18.28s/it]
Task 4, Epoch 5/20 => Loss 0.182, Train_accy 89.78, Test_accy 64.71:  20%|██        | 4/20 [02:03<04:52, 18.28s/it]
Task 4, Epoch 5/20 => Loss 0.182, Train_accy 89.78, Test_accy 64.71:  25%|██▌       | 5/20 [02:03<07:30, 30.04s/it]
Task 4, Epoch 6/20 => Loss 0.185, Train_accy 89.48:  25%|██▌       | 5/20 [02:22<07:30, 30.04s/it]                 
Task 4, Epoch 6/20 => Loss 0.185, Train_accy 89.48:  30%|███       | 6/20 [02:22<06:04, 26.02s/it]
Task 4, Epoch 7/20 => Loss 0.190, Train_accy 88.91:  30%|███       | 6/20 [02:40<06:04, 26.02s/it]
Task 4, Epoch 7/20 => Loss 0.190, Train_accy 88.91:  35%|███▌      | 7/20 [02:40<05:05, 23.47s/it]
Task 4, Epoch 8/20 => Loss 0.157, Train_accy 90.14:  35%|███▌      | 7/20 [02:58<05:05, 23.47s/it]
Task 4, Epoch 8/20 => Loss 0.157, Train_accy 90.14:  40%|████      | 8/20 [02:58<04:21, 21.79s/it]
Task 4, Epoch 9/20 => Loss 0.124, Train_accy 91.38:  40%|████      | 8/20 [03:16<04:21, 21.79s/it]
Task 4, Epoch 9/20 => Loss 0.124, Train_accy 91.38:  45%|████▌     | 9/20 [03:16<03:47, 20.68s/it]
Task 4, Epoch 10/20 => Loss 0.115, Train_accy 91.27, Test_accy 64.86:  45%|████▌     | 9/20 [04:07<03:47, 20.68s/it]
Task 4, Epoch 10/20 => Loss 0.115, Train_accy 91.27, Test_accy 64.86:  50%|█████     | 10/20 [04:07<05:00, 30.04s/it]
Task 4, Epoch 11/20 => Loss 0.127, Train_accy 90.20:  50%|█████     | 10/20 [04:26<05:00, 30.04s/it]                 
Task 4, Epoch 11/20 => Loss 0.127, Train_accy 90.20:  55%|█████▌    | 11/20 [04:26<03:57, 26.41s/it]
Task 4, Epoch 12/20 => Loss 0.116, Train_accy 91.22:  55%|█████▌    | 11/20 [04:44<03:57, 26.41s/it]
Task 4, Epoch 12/20 => Loss 0.116, Train_accy 91.22:  60%|██████    | 12/20 [04:44<03:11, 23.93s/it]
Task 4, Epoch 13/20 => Loss 0.076, Train_accy 93.48:  60%|██████    | 12/20 [05:02<03:11, 23.93s/it]
Task 4, Epoch 13/20 => Loss 0.076, Train_accy 93.48:  65%|██████▌   | 13/20 [05:02<02:35, 22.20s/it]
Task 4, Epoch 14/20 => Loss 0.096, Train_accy 91.74:  65%|██████▌   | 13/20 [05:20<02:35, 22.20s/it]
Task 4, Epoch 14/20 => Loss 0.096, Train_accy 91.74:  70%|███████   | 14/20 [05:20<02:06, 21.02s/it]
Task 4, Epoch 15/20 => Loss 0.091, Train_accy 92.25, Test_accy 65.10:  70%|███████   | 14/20 [06:11<02:06, 21.02s/it]
Task 4, Epoch 15/20 => Loss 0.091, Train_accy 92.25, Test_accy 65.10:  75%|███████▌  | 15/20 [06:11<02:30, 30.05s/it]
Task 4, Epoch 16/20 => Loss 0.098, Train_accy 92.71:  75%|███████▌  | 15/20 [06:30<02:30, 30.05s/it]                 
Task 4, Epoch 16/20 => Loss 0.098, Train_accy 92.71:  80%|████████  | 16/20 [06:30<01:46, 26.52s/it]
Task 4, Epoch 17/20 => Loss 0.060, Train_accy 93.07:  80%|████████  | 16/20 [06:48<01:46, 26.52s/it]
Task 4, Epoch 17/20 => Loss 0.060, Train_accy 93.07:  85%|████████▌ | 17/20 [06:48<01:12, 24.03s/it]
Task 4, Epoch 18/20 => Loss 0.071, Train_accy 92.71:  85%|████████▌ | 17/20 [07:06<01:12, 24.03s/it]
Task 4, Epoch 18/20 => Loss 0.071, Train_accy 92.71:  90%|█████████ | 18/20 [07:06<00:44, 22.30s/it]
Task 4, Epoch 19/20 => Loss 0.083, Train_accy 92.35:  90%|█████████ | 18/20 [07:24<00:44, 22.30s/it]
Task 4, Epoch 19/20 => Loss 0.083, Train_accy 92.35:  95%|█████████▌| 19/20 [07:24<00:21, 21.09s/it]
Task 4, Epoch 20/20 => Loss 0.081, Train_accy 92.09, Test_accy 65.04:  95%|█████████▌| 19/20 [08:15<00:21, 21.09s/it]
Task 4, Epoch 20/20 => Loss 0.081, Train_accy 92.09, Test_accy 65.04: 100%|██████████| 20/20 [08:15<00:00, 29.94s/it]
Task 4, Epoch 20/20 => Loss 0.081, Train_accy 92.09, Test_accy 65.04: 100%|██████████| 20/20 [08:15<00:00, 24.77s/it]
2024-09-07 20:57:57,914 [l2p.py] => Task 4, Epoch 20/20 => Loss 0.081, Train_accy 92.09, Test_accy 65.04
2024-09-07 20:58:30,124 [trainer.py] => No NME accuracy.
2024-09-07 20:58:30,125 [trainer.py] => CNN: {'total': 65.04, '00-99': 78.66, '100-119': 53.64, '120-139': 41.48, '140-159': 54.18, '160-179': 40.38, 'old': 67.43, 'new': 40.38}
2024-09-07 20:58:30,125 [trainer.py] => CNN top1 curve: [78.16, 74.43, 70.12, 67.73, 65.04]
2024-09-07 20:58:30,125 [trainer.py] => CNN top5 curve: [91.46, 90.18, 88.66, 88.06, 86.59]

Average Accuracy (CNN): 71.1
2024-09-07 20:58:30,125 [trainer.py] => Average Accuracy (CNN): 71.1 

2024-09-07 20:58:30,128 [trainer.py] => All params: 171970192
2024-09-07 20:58:30,129 [trainer.py] => Trainable params: 199880
2024-09-07 20:58:30,129 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.838, Train_accy 70.40:   0%|          | 0/20 [00:21<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.838, Train_accy 70.40:   5%|▌         | 1/20 [00:21<06:41, 21.13s/it]
Task 5, Epoch 2/20 => Loss 0.289, Train_accy 85.68:   5%|▌         | 1/20 [00:42<06:41, 21.13s/it]
Task 5, Epoch 2/20 => Loss 0.289, Train_accy 85.68:  10%|█         | 2/20 [00:42<06:20, 21.14s/it]
Task 5, Epoch 3/20 => Loss 0.219, Train_accy 87.80:  10%|█         | 2/20 [01:03<06:20, 21.14s/it]
Task 5, Epoch 3/20 => Loss 0.219, Train_accy 87.80:  15%|█▌        | 3/20 [01:03<06:00, 21.20s/it]
Task 5, Epoch 4/20 => Loss 0.146, Train_accy 90.22:  15%|█▌        | 3/20 [01:24<06:00, 21.20s/it]
Task 5, Epoch 4/20 => Loss 0.146, Train_accy 90.22:  20%|██        | 4/20 [01:24<05:38, 21.17s/it]
Task 5, Epoch 5/20 => Loss 0.133, Train_accy 90.62, Test_accy 61.50:  20%|██        | 4/20 [02:21<05:38, 21.17s/it]
Task 5, Epoch 5/20 => Loss 0.133, Train_accy 90.62, Test_accy 61.50:  25%|██▌       | 5/20 [02:21<08:32, 34.17s/it]
Task 5, Epoch 6/20 => Loss 0.096, Train_accy 91.45:  25%|██▌       | 5/20 [02:43<08:32, 34.17s/it]                 
Task 5, Epoch 6/20 => Loss 0.096, Train_accy 91.45:  30%|███       | 6/20 [02:43<06:56, 29.75s/it]
Task 5, Epoch 7/20 => Loss 0.108, Train_accy 91.23:  30%|███       | 6/20 [03:04<06:56, 29.75s/it]
Task 5, Epoch 7/20 => Loss 0.108, Train_accy 91.23:  35%|███▌      | 7/20 [03:04<05:50, 26.97s/it]
Task 5, Epoch 8/20 => Loss 0.102, Train_accy 91.98:  35%|███▌      | 7/20 [03:25<05:50, 26.97s/it]
Task 5, Epoch 8/20 => Loss 0.102, Train_accy 91.98:  40%|████      | 8/20 [03:25<05:01, 25.14s/it]
Task 5, Epoch 9/20 => Loss 0.085, Train_accy 91.50:  40%|████      | 8/20 [03:46<05:01, 25.14s/it]
Task 5, Epoch 9/20 => Loss 0.085, Train_accy 91.50:  45%|████▌     | 9/20 [03:46<04:22, 23.90s/it]
Task 5, Epoch 10/20 => Loss 0.085, Train_accy 91.59, Test_accy 62.00:  45%|████▌     | 9/20 [04:43<04:22, 23.90s/it]
Task 5, Epoch 10/20 => Loss 0.085, Train_accy 91.59, Test_accy 62.00:  50%|█████     | 10/20 [04:43<05:40, 34.08s/it]
Task 5, Epoch 11/20 => Loss 0.056, Train_accy 92.69:  50%|█████     | 10/20 [05:04<05:40, 34.08s/it]                 
Task 5, Epoch 11/20 => Loss 0.056, Train_accy 92.69:  55%|█████▌    | 11/20 [05:04<04:30, 30.11s/it]
Task 5, Epoch 12/20 => Loss 0.068, Train_accy 92.56:  55%|█████▌    | 11/20 [05:25<04:30, 30.11s/it]
Task 5, Epoch 12/20 => Loss 0.068, Train_accy 92.56:  60%|██████    | 12/20 [05:25<03:38, 27.35s/it]
Task 5, Epoch 13/20 => Loss 0.046, Train_accy 93.00:  60%|██████    | 12/20 [05:46<03:38, 27.35s/it]
Task 5, Epoch 13/20 => Loss 0.046, Train_accy 93.00:  65%|██████▌   | 13/20 [05:46<02:58, 25.48s/it]
Task 5, Epoch 14/20 => Loss 0.046, Train_accy 92.64:  65%|██████▌   | 13/20 [06:08<02:58, 25.48s/it]
Task 5, Epoch 14/20 => Loss 0.046, Train_accy 92.64:  70%|███████   | 14/20 [06:08<02:25, 24.17s/it]
Task 5, Epoch 15/20 => Loss 0.045, Train_accy 93.08, Test_accy 62.73:  70%|███████   | 14/20 [07:04<02:25, 24.17s/it]
Task 5, Epoch 15/20 => Loss 0.045, Train_accy 93.08, Test_accy 62.73:  75%|███████▌  | 15/20 [07:04<02:50, 34.04s/it]
Task 5, Epoch 16/20 => Loss 0.051, Train_accy 93.04:  75%|███████▌  | 15/20 [07:26<02:50, 34.04s/it]                 
Task 5, Epoch 16/20 => Loss 0.051, Train_accy 93.04:  80%|████████  | 16/20 [07:26<02:00, 30.20s/it]
Task 5, Epoch 17/20 => Loss 0.037, Train_accy 93.57:  80%|████████  | 16/20 [07:47<02:00, 30.20s/it]
Task 5, Epoch 17/20 => Loss 0.037, Train_accy 93.57:  85%|████████▌ | 17/20 [07:47<01:22, 27.47s/it]
Task 5, Epoch 18/20 => Loss 0.034, Train_accy 93.44:  85%|████████▌ | 17/20 [08:08<01:22, 27.47s/it]
Task 5, Epoch 18/20 => Loss 0.034, Train_accy 93.44:  90%|█████████ | 18/20 [08:08<00:51, 25.60s/it]
Task 5, Epoch 19/20 => Loss 0.037, Train_accy 93.00:  90%|█████████ | 18/20 [08:29<00:51, 25.60s/it]
Task 5, Epoch 19/20 => Loss 0.037, Train_accy 93.00:  95%|█████████▌| 19/20 [08:29<00:24, 24.26s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 93.83, Test_accy 62.70:  95%|█████████▌| 19/20 [09:27<00:24, 24.26s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 93.83, Test_accy 62.70: 100%|██████████| 20/20 [09:27<00:00, 34.17s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 93.83, Test_accy 62.70: 100%|██████████| 20/20 [09:27<00:00, 28.35s/it]
2024-09-07 21:07:57,179 [l2p.py] => Task 5, Epoch 20/20 => Loss 0.045, Train_accy 93.83, Test_accy 62.70
2024-09-07 21:08:33,327 [trainer.py] => No NME accuracy.
2024-09-07 21:08:33,328 [trainer.py] => CNN: {'total': 62.7, '00-99': 78.96, '100-119': 53.94, '120-139': 43.06, '140-159': 53.91, '160-179': 41.0, '180-199': 37.13, 'old': 65.43, 'new': 37.13}
2024-09-07 21:08:33,328 [trainer.py] => CNN top1 curve: [78.16, 74.43, 70.12, 67.73, 65.04, 62.7]
2024-09-07 21:08:33,328 [trainer.py] => CNN top5 curve: [91.46, 90.18, 88.66, 88.06, 86.59, 85.88]

Average Accuracy (CNN): 69.7
2024-09-07 21:08:33,328 [trainer.py] => Average Accuracy (CNN): 69.7 

Accuracy Matrix (CNN):
[[78.16 78.59 78.83 78.66 78.66 78.96]
 [ 0.   55.61 55.3  54.55 53.64 53.94]
 [ 0.    0.   41.65 41.3  41.48 43.06]
 [ 0.    0.    0.   55.56 54.18 53.91]
 [ 0.    0.    0.    0.   40.38 41.  ]
 [ 0.    0.    0.    0.    0.   37.13]]
2024-09-07 21:08:33,329 [trainer.py] => Forgetting (CNN): 0.6640000000000015
2024-09-07 21:08:36,222 [trainer.py] => config: ./exps/l2p_inr_B100_Inc10.json
2024-09-07 21:08:36,222 [trainer.py] => prefix:  
2024-09-07 21:08:36,222 [trainer.py] => dataset: imagenetr
2024-09-07 21:08:36,222 [trainer.py] => memory_size: 0
2024-09-07 21:08:36,222 [trainer.py] => memory_per_class: 0
2024-09-07 21:08:36,222 [trainer.py] => fixed_memory: False
2024-09-07 21:08:36,222 [trainer.py] => shuffle: True
2024-09-07 21:08:36,222 [trainer.py] => init_cls: 100
2024-09-07 21:08:36,222 [trainer.py] => increment: 10
2024-09-07 21:08:36,222 [trainer.py] => model_name: l2p
2024-09-07 21:08:36,222 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-07 21:08:36,222 [trainer.py] => get_original_backbone: True
2024-09-07 21:08:36,222 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 21:08:36,222 [trainer.py] => seed: 1993
2024-09-07 21:08:36,222 [trainer.py] => tuned_epoch: 20
2024-09-07 21:08:36,222 [trainer.py] => init_lr: 0.001875
2024-09-07 21:08:36,222 [trainer.py] => batch_size: 48
2024-09-07 21:08:36,222 [trainer.py] => weight_decay: 0
2024-09-07 21:08:36,222 [trainer.py] => min_lr: 1e-05
2024-09-07 21:08:36,222 [trainer.py] => optimizer: adam
2024-09-07 21:08:36,222 [trainer.py] => scheduler: constant
2024-09-07 21:08:36,223 [trainer.py] => reinit_optimizer: True
2024-09-07 21:08:36,223 [trainer.py] => global_pool: token
2024-09-07 21:08:36,223 [trainer.py] => head_type: prompt
2024-09-07 21:08:36,223 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-07 21:08:36,223 [trainer.py] => pretrained: True
2024-09-07 21:08:36,223 [trainer.py] => drop: 0.0
2024-09-07 21:08:36,223 [trainer.py] => drop_path: 0.0
2024-09-07 21:08:36,223 [trainer.py] => prompt_pool: True
2024-09-07 21:08:36,223 [trainer.py] => size: 10
2024-09-07 21:08:36,223 [trainer.py] => length: 5
2024-09-07 21:08:36,223 [trainer.py] => top_k: 5
2024-09-07 21:08:36,223 [trainer.py] => initializer: uniform
2024-09-07 21:08:36,223 [trainer.py] => prompt_key: True
2024-09-07 21:08:36,223 [trainer.py] => prompt_key_init: uniform
2024-09-07 21:08:36,223 [trainer.py] => use_prompt_mask: False
2024-09-07 21:08:36,223 [trainer.py] => shared_prompt_pool: False
2024-09-07 21:08:36,223 [trainer.py] => shared_prompt_key: False
2024-09-07 21:08:36,223 [trainer.py] => batchwise_prompt: True
2024-09-07 21:08:36,223 [trainer.py] => embedding_key: cls
2024-09-07 21:08:36,223 [trainer.py] => predefined_key: 
2024-09-07 21:08:36,223 [trainer.py] => pull_constraint: True
2024-09-07 21:08:36,223 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-07 21:08:36,306 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 21:08:37,712 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-07 21:08:37,713 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-07 21:08:39,447 [l2p.py] => 86,017,736 model total parameters.
2024-09-07 21:08:39,448 [l2p.py] => 199,880 model training parameters.
2024-09-07 21:08:39,448 [l2p.py] => prompt.prompt: 38400
2024-09-07 21:08:39,448 [l2p.py] => prompt.prompt_key: 7680
2024-09-07 21:08:39,448 [l2p.py] => head.weight: 153600
2024-09-07 21:08:39,448 [l2p.py] => head.bias: 200
2024-09-07 21:08:39,449 [trainer.py] => All params: 171970192
2024-09-07 21:08:39,450 [trainer.py] => Trainable params: 199880
2024-09-07 21:08:39,450 [l2p.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.419, Train_accy 47.34:   0%|          | 0/20 [01:51<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.419, Train_accy 47.34:   5%|▌         | 1/20 [01:51<35:09, 111.00s/it]
Task 0, Epoch 2/20 => Loss 1.330, Train_accy 65.75:   5%|▌         | 1/20 [03:42<35:09, 111.00s/it]
Task 0, Epoch 2/20 => Loss 1.330, Train_accy 65.75:  10%|█         | 2/20 [03:42<33:22, 111.27s/it]
Task 0, Epoch 3/20 => Loss 1.089, Train_accy 69.85:  10%|█         | 2/20 [05:33<33:22, 111.27s/it]
Task 0, Epoch 3/20 => Loss 1.089, Train_accy 69.85:  15%|█▌        | 3/20 [05:33<31:28, 111.11s/it]
Task 0, Epoch 4/20 => Loss 0.924, Train_accy 72.95:  15%|█▌        | 3/20 [07:24<31:28, 111.11s/it]
Task 0, Epoch 4/20 => Loss 0.924, Train_accy 72.95:  20%|██        | 4/20 [07:24<29:36, 111.05s/it]
Task 0, Epoch 5/20 => Loss 0.816, Train_accy 75.49, Test_accy 78.16:  20%|██        | 4/20 [09:33<29:36, 111.05s/it]
Task 0, Epoch 5/20 => Loss 0.816, Train_accy 75.49, Test_accy 78.16:  25%|██▌       | 5/20 [09:33<29:22, 117.51s/it]
Task 0, Epoch 6/20 => Loss 0.770, Train_accy 76.76:  25%|██▌       | 5/20 [11:24<29:22, 117.51s/it]                 
Task 0, Epoch 6/20 => Loss 0.770, Train_accy 76.76:  30%|███       | 6/20 [11:24<26:53, 115.27s/it]
Task 0, Epoch 7/20 => Loss 0.710, Train_accy 78.30:  30%|███       | 6/20 [13:15<26:53, 115.27s/it]
Task 0, Epoch 7/20 => Loss 0.710, Train_accy 78.30:  35%|███▌      | 7/20 [13:15<24:39, 113.84s/it]
Task 0, Epoch 8/20 => Loss 0.649, Train_accy 79.52:  35%|███▌      | 7/20 [15:06<24:39, 113.84s/it]
Task 0, Epoch 8/20 => Loss 0.649, Train_accy 79.52:  40%|████      | 8/20 [15:06<22:35, 112.92s/it]
Task 0, Epoch 9/20 => Loss 0.617, Train_accy 79.85:  40%|████      | 8/20 [16:57<22:35, 112.92s/it]
Task 0, Epoch 9/20 => Loss 0.617, Train_accy 79.85:  45%|████▌     | 9/20 [16:57<20:35, 112.33s/it]
Task 0, Epoch 10/20 => Loss 0.612, Train_accy 80.54, Test_accy 78.06:  45%|████▌     | 9/20 [19:06<20:35, 112.33s/it]
Task 0, Epoch 10/20 => Loss 0.612, Train_accy 80.54, Test_accy 78.06:  50%|█████     | 10/20 [19:06<19:34, 117.47s/it]
Task 0, Epoch 11/20 => Loss 0.596, Train_accy 80.68:  50%|█████     | 10/20 [20:57<19:34, 117.47s/it]                 
Task 0, Epoch 11/20 => Loss 0.596, Train_accy 80.68:  55%|█████▌    | 11/20 [20:57<17:19, 115.48s/it]
Task 0, Epoch 12/20 => Loss 0.562, Train_accy 81.56:  55%|█████▌    | 11/20 [22:47<17:19, 115.48s/it]
Task 0, Epoch 12/20 => Loss 0.562, Train_accy 81.56:  60%|██████    | 12/20 [22:47<15:12, 114.03s/it]
Task 0, Epoch 13/20 => Loss 0.514, Train_accy 82.54:  60%|██████    | 12/20 [24:38<15:12, 114.03s/it]
Task 0, Epoch 13/20 => Loss 0.514, Train_accy 82.54:  65%|██████▌   | 13/20 [24:38<13:11, 113.02s/it]
Task 0, Epoch 14/20 => Loss 0.520, Train_accy 82.68:  65%|██████▌   | 13/20 [26:29<13:11, 113.02s/it]
Task 0, Epoch 14/20 => Loss 0.520, Train_accy 82.68:  70%|███████   | 14/20 [26:29<11:14, 112.33s/it]
Task 0, Epoch 15/20 => Loss 0.515, Train_accy 82.98, Test_accy 78.16:  70%|███████   | 14/20 [28:37<11:14, 112.33s/it]
Task 0, Epoch 15/20 => Loss 0.515, Train_accy 82.98, Test_accy 78.16:  75%|███████▌  | 15/20 [28:37<09:46, 117.29s/it]
Task 0, Epoch 16/20 => Loss 0.483, Train_accy 83.25:  75%|███████▌  | 15/20 [30:28<09:46, 117.29s/it]                 
Task 0, Epoch 16/20 => Loss 0.483, Train_accy 83.25:  80%|████████  | 16/20 [30:28<07:41, 115.28s/it]
Task 0, Epoch 17/20 => Loss 0.490, Train_accy 83.44:  80%|████████  | 16/20 [32:19<07:41, 115.28s/it]
Task 0, Epoch 17/20 => Loss 0.490, Train_accy 83.44:  85%|████████▌ | 17/20 [32:19<05:41, 113.89s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 83.84:  85%|████████▌ | 17/20 [34:10<05:41, 113.89s/it]
Task 0, Epoch 18/20 => Loss 0.464, Train_accy 83.84:  90%|█████████ | 18/20 [34:10<03:45, 112.95s/it]
Task 0, Epoch 19/20 => Loss 0.479, Train_accy 83.50:  90%|█████████ | 18/20 [36:00<03:45, 112.95s/it]
Task 0, Epoch 19/20 => Loss 0.479, Train_accy 83.50:  95%|█████████▌| 19/20 [36:00<01:52, 112.26s/it]
Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16:  95%|█████████▌| 19/20 [38:09<01:52, 112.26s/it]
Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16: 100%|██████████| 20/20 [38:09<00:00, 117.19s/it]
Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16: 100%|██████████| 20/20 [38:09<00:00, 114.47s/it]
2024-09-07 21:46:49,669 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.432, Train_accy 84.53, Test_accy 78.16
2024-09-07 21:47:07,632 [trainer.py] => No NME accuracy.
2024-09-07 21:47:07,633 [trainer.py] => CNN: {'total': 78.16, '00-99': 78.16, 'old': 0, 'new': 78.16}
2024-09-07 21:47:07,633 [trainer.py] => CNN top1 curve: [78.16]
2024-09-07 21:47:07,633 [trainer.py] => CNN top5 curve: [91.46]

Average Accuracy (CNN): 78.16
2024-09-07 21:47:07,633 [trainer.py] => Average Accuracy (CNN): 78.16 

2024-09-07 21:47:07,636 [trainer.py] => All params: 171970192
2024-09-07 21:47:07,638 [trainer.py] => Trainable params: 199880
2024-09-07 21:47:07,638 [l2p.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.837, Train_accy 67.26:   0%|          | 0/20 [00:11<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.837, Train_accy 67.26:   5%|▌         | 1/20 [00:11<03:32, 11.21s/it]
Task 1, Epoch 2/20 => Loss 0.172, Train_accy 88.46:   5%|▌         | 1/20 [00:22<03:32, 11.21s/it]
Task 1, Epoch 2/20 => Loss 0.172, Train_accy 88.46:  10%|█         | 2/20 [00:22<03:19, 11.10s/it]
Task 1, Epoch 3/20 => Loss 0.112, Train_accy 90.00:  10%|█         | 2/20 [00:33<03:19, 11.10s/it]
Task 1, Epoch 3/20 => Loss 0.112, Train_accy 90.00:  15%|█▌        | 3/20 [00:33<03:08, 11.07s/it]
Task 1, Epoch 4/20 => Loss 0.065, Train_accy 92.31:  15%|█▌        | 3/20 [00:44<03:08, 11.07s/it]
Task 1, Epoch 4/20 => Loss 0.065, Train_accy 92.31:  20%|██        | 4/20 [00:44<02:56, 11.06s/it]
Task 1, Epoch 5/20 => Loss 0.041, Train_accy 92.56, Test_accy 73.78:  20%|██        | 4/20 [01:14<02:56, 11.06s/it]
Task 1, Epoch 5/20 => Loss 0.041, Train_accy 92.56, Test_accy 73.78:  25%|██▌       | 5/20 [01:14<04:32, 18.13s/it]
Task 1, Epoch 6/20 => Loss 0.030, Train_accy 92.82:  25%|██▌       | 5/20 [01:26<04:32, 18.13s/it]                 
Task 1, Epoch 6/20 => Loss 0.030, Train_accy 92.82:  30%|███       | 6/20 [01:26<03:40, 15.75s/it]
Task 1, Epoch 7/20 => Loss 0.005, Train_accy 93.76:  30%|███       | 6/20 [01:37<03:40, 15.75s/it]
Task 1, Epoch 7/20 => Loss 0.005, Train_accy 93.76:  35%|███▌      | 7/20 [01:37<03:04, 14.22s/it]
Task 1, Epoch 8/20 => Loss -0.010, Train_accy 94.79:  35%|███▌      | 7/20 [01:48<03:04, 14.22s/it]
Task 1, Epoch 8/20 => Loss -0.010, Train_accy 94.79:  40%|████      | 8/20 [01:48<02:38, 13.21s/it]
Task 1, Epoch 9/20 => Loss -0.023, Train_accy 94.96:  40%|████      | 8/20 [01:59<02:38, 13.21s/it]
Task 1, Epoch 9/20 => Loss -0.023, Train_accy 94.96:  45%|████▌     | 9/20 [01:59<02:18, 12.59s/it]
Task 1, Epoch 10/20 => Loss -0.019, Train_accy 95.04, Test_accy 74.67:  45%|████▌     | 9/20 [02:30<02:18, 12.59s/it]
Task 1, Epoch 10/20 => Loss -0.019, Train_accy 95.04, Test_accy 74.67:  50%|█████     | 10/20 [02:30<03:01, 18.20s/it]
Task 1, Epoch 11/20 => Loss 0.025, Train_accy 92.74:  50%|█████     | 10/20 [02:41<03:01, 18.20s/it]                  
Task 1, Epoch 11/20 => Loss 0.025, Train_accy 92.74:  55%|█████▌    | 11/20 [02:41<02:24, 16.02s/it]
Task 1, Epoch 12/20 => Loss -0.058, Train_accy 96.15:  55%|█████▌    | 11/20 [02:52<02:24, 16.02s/it]
Task 1, Epoch 12/20 => Loss -0.058, Train_accy 96.15:  60%|██████    | 12/20 [02:52<01:56, 14.50s/it]
Task 1, Epoch 13/20 => Loss -0.037, Train_accy 94.87:  60%|██████    | 12/20 [03:03<01:56, 14.50s/it]
Task 1, Epoch 13/20 => Loss -0.037, Train_accy 94.87:  65%|██████▌   | 13/20 [03:03<01:34, 13.46s/it]
Task 1, Epoch 14/20 => Loss -0.034, Train_accy 94.62:  65%|██████▌   | 13/20 [03:14<01:34, 13.46s/it]
Task 1, Epoch 14/20 => Loss -0.034, Train_accy 94.62:  70%|███████   | 14/20 [03:14<01:16, 12.76s/it]
Task 1, Epoch 15/20 => Loss -0.006, Train_accy 94.62, Test_accy 74.95:  70%|███████   | 14/20 [03:45<01:16, 12.76s/it]
Task 1, Epoch 15/20 => Loss -0.006, Train_accy 94.62, Test_accy 74.95:  75%|███████▌  | 15/20 [03:45<01:31, 18.22s/it]
Task 1, Epoch 16/20 => Loss -0.033, Train_accy 94.70:  75%|███████▌  | 15/20 [03:56<01:31, 18.22s/it]                 
Task 1, Epoch 16/20 => Loss -0.033, Train_accy 94.70:  80%|████████  | 16/20 [03:56<01:04, 16.10s/it]
Task 1, Epoch 17/20 => Loss -0.024, Train_accy 95.56:  80%|████████  | 16/20 [04:07<01:04, 16.10s/it]
Task 1, Epoch 17/20 => Loss -0.024, Train_accy 95.56:  85%|████████▌ | 17/20 [04:07<00:43, 14.59s/it]
Task 1, Epoch 18/20 => Loss -0.028, Train_accy 95.21:  85%|████████▌ | 17/20 [04:18<00:43, 14.59s/it]
Task 1, Epoch 18/20 => Loss -0.028, Train_accy 95.21:  90%|█████████ | 18/20 [04:18<00:27, 13.54s/it]
Task 1, Epoch 19/20 => Loss -0.040, Train_accy 94.87:  90%|█████████ | 18/20 [04:29<00:27, 13.54s/it]
Task 1, Epoch 19/20 => Loss -0.040, Train_accy 94.87:  95%|█████████▌| 19/20 [04:29<00:12, 12.79s/it]
Task 1, Epoch 20/20 => Loss -0.057, Train_accy 96.58, Test_accy 75.31:  95%|█████████▌| 19/20 [05:00<00:12, 12.79s/it]
Task 1, Epoch 20/20 => Loss -0.057, Train_accy 96.58, Test_accy 75.31: 100%|██████████| 20/20 [05:00<00:00, 18.17s/it]
Task 1, Epoch 20/20 => Loss -0.057, Train_accy 96.58, Test_accy 75.31: 100%|██████████| 20/20 [05:00<00:00, 15.03s/it]
2024-09-07 21:52:08,167 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.057, Train_accy 96.58, Test_accy 75.31
2024-09-07 21:52:27,774 [trainer.py] => No NME accuracy.
2024-09-07 21:52:27,775 [trainer.py] => CNN: {'total': 75.31, '00-99': 78.59, '100-109': 40.85, 'old': 78.59, 'new': 40.85}
2024-09-07 21:52:27,775 [trainer.py] => CNN top1 curve: [78.16, 75.31]
2024-09-07 21:52:27,775 [trainer.py] => CNN top5 curve: [91.46, 91.07]

Average Accuracy (CNN): 76.74
2024-09-07 21:52:27,775 [trainer.py] => Average Accuracy (CNN): 76.74 

2024-09-07 21:52:27,778 [trainer.py] => All params: 171970192
2024-09-07 21:52:27,780 [trainer.py] => Trainable params: 199880
2024-09-07 21:52:27,780 [l2p.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.606, Train_accy 75.32:   0%|          | 0/20 [00:13<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.606, Train_accy 75.32:   5%|▌         | 1/20 [00:13<04:25, 13.97s/it]
Task 2, Epoch 2/20 => Loss 0.156, Train_accy 88.03:   5%|▌         | 1/20 [00:28<04:25, 13.97s/it]
Task 2, Epoch 2/20 => Loss 0.156, Train_accy 88.03:  10%|█         | 2/20 [00:28<04:12, 14.01s/it]
Task 2, Epoch 3/20 => Loss 0.115, Train_accy 89.97:  10%|█         | 2/20 [00:42<04:12, 14.01s/it]
Task 2, Epoch 3/20 => Loss 0.115, Train_accy 89.97:  15%|█▌        | 3/20 [00:42<03:58, 14.01s/it]
Task 2, Epoch 4/20 => Loss 0.102, Train_accy 91.04:  15%|█▌        | 3/20 [00:56<03:58, 14.01s/it]
Task 2, Epoch 4/20 => Loss 0.102, Train_accy 91.04:  20%|██        | 4/20 [00:56<03:44, 14.01s/it]
Task 2, Epoch 5/20 => Loss 0.066, Train_accy 91.77, Test_accy 70.95:  20%|██        | 4/20 [01:32<03:44, 14.01s/it]
Task 2, Epoch 5/20 => Loss 0.066, Train_accy 91.77, Test_accy 70.95:  25%|██▌       | 5/20 [01:32<05:28, 21.93s/it]
Task 2, Epoch 6/20 => Loss 0.033, Train_accy 92.71:  25%|██▌       | 5/20 [01:46<05:28, 21.93s/it]                 
Task 2, Epoch 6/20 => Loss 0.033, Train_accy 92.71:  30%|███       | 6/20 [01:46<04:29, 19.25s/it]
Task 2, Epoch 7/20 => Loss 0.039, Train_accy 92.91:  30%|███       | 6/20 [02:00<04:29, 19.25s/it]
Task 2, Epoch 7/20 => Loss 0.039, Train_accy 92.91:  35%|███▌      | 7/20 [02:00<03:48, 17.57s/it]
Task 2, Epoch 8/20 => Loss 0.020, Train_accy 93.44:  35%|███▌      | 7/20 [02:14<03:48, 17.57s/it]
Task 2, Epoch 8/20 => Loss 0.020, Train_accy 93.44:  40%|████      | 8/20 [02:14<03:17, 16.44s/it]
Task 2, Epoch 9/20 => Loss 0.017, Train_accy 93.38:  40%|████      | 8/20 [02:28<03:17, 16.44s/it]
Task 2, Epoch 9/20 => Loss 0.017, Train_accy 93.38:  45%|████▌     | 9/20 [02:28<02:52, 15.68s/it]
Task 2, Epoch 10/20 => Loss -0.004, Train_accy 94.65, Test_accy 71.66:  45%|████▌     | 9/20 [03:04<02:52, 15.68s/it]
Task 2, Epoch 10/20 => Loss -0.004, Train_accy 94.65, Test_accy 71.66:  50%|█████     | 10/20 [03:04<03:39, 21.95s/it]
Task 2, Epoch 11/20 => Loss 0.016, Train_accy 93.91:  50%|█████     | 10/20 [03:18<03:39, 21.95s/it]                  
Task 2, Epoch 11/20 => Loss 0.016, Train_accy 93.91:  55%|█████▌    | 11/20 [03:18<02:55, 19.54s/it]
Task 2, Epoch 12/20 => Loss 0.037, Train_accy 92.91:  55%|█████▌    | 11/20 [03:32<02:55, 19.54s/it]
Task 2, Epoch 12/20 => Loss 0.037, Train_accy 92.91:  60%|██████    | 12/20 [03:32<02:23, 17.88s/it]
Task 2, Epoch 13/20 => Loss 0.000, Train_accy 93.44:  60%|██████    | 12/20 [03:46<02:23, 17.88s/it]
Task 2, Epoch 13/20 => Loss 0.000, Train_accy 93.44:  65%|██████▌   | 13/20 [03:46<01:56, 16.71s/it]
Task 2, Epoch 14/20 => Loss -0.028, Train_accy 94.52:  65%|██████▌   | 13/20 [04:00<01:56, 16.71s/it]
Task 2, Epoch 14/20 => Loss -0.028, Train_accy 94.52:  70%|███████   | 14/20 [04:00<01:35, 15.91s/it]
Task 2, Epoch 15/20 => Loss -0.013, Train_accy 95.59, Test_accy 71.71:  70%|███████   | 14/20 [04:36<01:35, 15.91s/it]
Task 2, Epoch 15/20 => Loss -0.013, Train_accy 95.59, Test_accy 71.71:  75%|███████▌  | 15/20 [04:36<01:50, 22.01s/it]
Task 2, Epoch 16/20 => Loss -0.011, Train_accy 94.52:  75%|███████▌  | 15/20 [04:50<01:50, 22.01s/it]                 
Task 2, Epoch 16/20 => Loss -0.011, Train_accy 94.52:  80%|████████  | 16/20 [04:50<01:18, 19.58s/it]
Task 2, Epoch 17/20 => Loss -0.005, Train_accy 93.98:  80%|████████  | 16/20 [05:04<01:18, 19.58s/it]
Task 2, Epoch 17/20 => Loss -0.005, Train_accy 93.98:  85%|████████▌ | 17/20 [05:04<00:53, 17.89s/it]
Task 2, Epoch 18/20 => Loss -0.021, Train_accy 94.92:  85%|████████▌ | 17/20 [05:18<00:53, 17.89s/it]
Task 2, Epoch 18/20 => Loss -0.021, Train_accy 94.92:  90%|█████████ | 18/20 [05:18<00:33, 16.74s/it]
Task 2, Epoch 19/20 => Loss -0.013, Train_accy 94.72:  90%|█████████ | 18/20 [05:32<00:33, 16.74s/it]
Task 2, Epoch 19/20 => Loss -0.013, Train_accy 94.72:  95%|█████████▌| 19/20 [05:32<00:15, 15.90s/it]
Task 2, Epoch 20/20 => Loss -0.020, Train_accy 95.05, Test_accy 72.18:  95%|█████████▌| 19/20 [06:08<00:15, 15.90s/it]
Task 2, Epoch 20/20 => Loss -0.020, Train_accy 95.05, Test_accy 72.18: 100%|██████████| 20/20 [06:08<00:00, 21.87s/it]
Task 2, Epoch 20/20 => Loss -0.020, Train_accy 95.05, Test_accy 72.18: 100%|██████████| 20/20 [06:08<00:00, 18.41s/it]
2024-09-07 21:58:36,061 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.020, Train_accy 95.05, Test_accy 72.18
2024-09-07 21:58:57,874 [trainer.py] => No NME accuracy.
2024-09-07 21:58:57,874 [trainer.py] => CNN: {'total': 72.18, '00-99': 78.96, '100-109': 38.73, '110-119': 43.62, 'old': 75.47, 'new': 43.62}
2024-09-07 21:58:57,874 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18]
2024-09-07 21:58:57,874 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33]

Average Accuracy (CNN): 75.22
2024-09-07 21:58:57,874 [trainer.py] => Average Accuracy (CNN): 75.22 

2024-09-07 21:58:57,877 [trainer.py] => All params: 171970192
2024-09-07 21:58:57,879 [trainer.py] => Trainable params: 199880
2024-09-07 21:58:57,879 [l2p.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.950, Train_accy 62.19:   0%|          | 0/20 [00:09<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.950, Train_accy 62.19:   5%|▌         | 1/20 [00:09<02:55,  9.24s/it]
Task 3, Epoch 2/20 => Loss 0.187, Train_accy 88.02:   5%|▌         | 1/20 [00:18<02:55,  9.24s/it]
Task 3, Epoch 2/20 => Loss 0.187, Train_accy 88.02:  10%|█         | 2/20 [00:18<02:46,  9.23s/it]
Task 3, Epoch 3/20 => Loss 0.113, Train_accy 90.70:  10%|█         | 2/20 [00:27<02:46,  9.23s/it]
Task 3, Epoch 3/20 => Loss 0.113, Train_accy 90.70:  15%|█▌        | 3/20 [00:27<02:36,  9.20s/it]
Task 3, Epoch 4/20 => Loss 0.065, Train_accy 92.46:  15%|█▌        | 3/20 [00:36<02:36,  9.20s/it]
Task 3, Epoch 4/20 => Loss 0.065, Train_accy 92.46:  20%|██        | 4/20 [00:36<02:27,  9.21s/it]
Task 3, Epoch 5/20 => Loss 0.064, Train_accy 92.46, Test_accy 67.85:  20%|██        | 4/20 [01:09<02:27,  9.21s/it]
Task 3, Epoch 5/20 => Loss 0.064, Train_accy 92.46, Test_accy 67.85:  25%|██▌       | 5/20 [01:09<04:25, 17.67s/it]
Task 3, Epoch 6/20 => Loss 0.023, Train_accy 93.49:  25%|██▌       | 5/20 [01:18<04:25, 17.67s/it]                 
Task 3, Epoch 6/20 => Loss 0.023, Train_accy 93.49:  30%|███       | 6/20 [01:18<03:27, 14.79s/it]
Task 3, Epoch 7/20 => Loss -0.009, Train_accy 94.83:  30%|███       | 6/20 [01:27<03:27, 14.79s/it]
Task 3, Epoch 7/20 => Loss -0.009, Train_accy 94.83:  35%|███▌      | 7/20 [01:27<02:48, 12.98s/it]
Task 3, Epoch 8/20 => Loss -0.025, Train_accy 95.04:  35%|███▌      | 7/20 [01:37<02:48, 12.98s/it]
Task 3, Epoch 8/20 => Loss -0.025, Train_accy 95.04:  40%|████      | 8/20 [01:37<02:21, 11.80s/it]
Task 3, Epoch 9/20 => Loss -0.009, Train_accy 94.01:  40%|████      | 8/20 [01:46<02:21, 11.80s/it]
Task 3, Epoch 9/20 => Loss -0.009, Train_accy 94.01:  45%|████▌     | 9/20 [01:46<02:00, 10.98s/it]
Task 3, Epoch 10/20 => Loss -0.006, Train_accy 94.73, Test_accy 68.13:  45%|████▌     | 9/20 [02:19<02:00, 10.98s/it]
Task 3, Epoch 10/20 => Loss -0.006, Train_accy 94.73, Test_accy 68.13:  50%|█████     | 10/20 [02:19<02:56, 17.66s/it]
Task 3, Epoch 11/20 => Loss -0.021, Train_accy 94.52:  50%|█████     | 10/20 [02:28<02:56, 17.66s/it]                 
Task 3, Epoch 11/20 => Loss -0.021, Train_accy 94.52:  55%|█████▌    | 11/20 [02:28<02:15, 15.08s/it]
Task 3, Epoch 12/20 => Loss -0.043, Train_accy 95.76:  55%|█████▌    | 11/20 [02:37<02:15, 15.08s/it]
Task 3, Epoch 12/20 => Loss -0.043, Train_accy 95.76:  60%|██████    | 12/20 [02:37<01:46, 13.31s/it]
Task 3, Epoch 13/20 => Loss -0.022, Train_accy 95.66:  60%|██████    | 12/20 [02:46<01:46, 13.31s/it]
Task 3, Epoch 13/20 => Loss -0.022, Train_accy 95.66:  65%|██████▌   | 13/20 [02:46<01:24, 12.09s/it]
Task 3, Epoch 14/20 => Loss 0.040, Train_accy 93.70:  65%|██████▌   | 13/20 [02:56<01:24, 12.09s/it] 
Task 3, Epoch 14/20 => Loss 0.040, Train_accy 93.70:  70%|███████   | 14/20 [02:56<01:07, 11.22s/it]
Task 3, Epoch 15/20 => Loss -0.020, Train_accy 95.04, Test_accy 68.26:  70%|███████   | 14/20 [03:28<01:07, 11.22s/it]
Task 3, Epoch 15/20 => Loss -0.020, Train_accy 95.04, Test_accy 68.26:  75%|███████▌  | 15/20 [03:28<01:28, 17.66s/it]
Task 3, Epoch 16/20 => Loss -0.025, Train_accy 94.32:  75%|███████▌  | 15/20 [03:37<01:28, 17.66s/it]                 
Task 3, Epoch 16/20 => Loss -0.025, Train_accy 94.32:  80%|████████  | 16/20 [03:37<01:00, 15.13s/it]
Task 3, Epoch 17/20 => Loss -0.064, Train_accy 95.76:  80%|████████  | 16/20 [03:47<01:00, 15.13s/it]
Task 3, Epoch 17/20 => Loss -0.064, Train_accy 95.76:  85%|████████▌ | 17/20 [03:47<00:40, 13.35s/it]
Task 3, Epoch 18/20 => Loss -0.050, Train_accy 95.35:  85%|████████▌ | 17/20 [03:56<00:40, 13.35s/it]
Task 3, Epoch 18/20 => Loss -0.050, Train_accy 95.35:  90%|█████████ | 18/20 [03:56<00:24, 12.14s/it]
Task 3, Epoch 19/20 => Loss -0.057, Train_accy 95.87:  90%|█████████ | 18/20 [04:05<00:24, 12.14s/it]
Task 3, Epoch 19/20 => Loss -0.057, Train_accy 95.87:  95%|█████████▌| 19/20 [04:05<00:11, 11.26s/it]
Task 3, Epoch 20/20 => Loss -0.066, Train_accy 96.07, Test_accy 68.46:  95%|█████████▌| 19/20 [04:38<00:11, 11.26s/it]
Task 3, Epoch 20/20 => Loss -0.066, Train_accy 96.07, Test_accy 68.46: 100%|██████████| 20/20 [04:38<00:00, 17.71s/it]
Task 3, Epoch 20/20 => Loss -0.066, Train_accy 96.07, Test_accy 68.46: 100%|██████████| 20/20 [04:38<00:00, 13.92s/it]
2024-09-07 22:03:36,243 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.066, Train_accy 96.07, Test_accy 68.46
2024-09-07 22:03:59,636 [trainer.py] => No NME accuracy.
2024-09-07 22:03:59,637 [trainer.py] => CNN: {'total': 68.46, '00-99': 78.86, '100-109': 38.73, '110-119': 41.76, '120-129': 22.14, 'old': 71.91, 'new': 22.14}
2024-09-07 22:03:59,637 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46]
2024-09-07 22:03:59,637 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59]

Average Accuracy (CNN): 73.53
2024-09-07 22:03:59,637 [trainer.py] => Average Accuracy (CNN): 73.53 

2024-09-07 22:03:59,640 [trainer.py] => All params: 171970192
2024-09-07 22:03:59,642 [trainer.py] => Trainable params: 199880
2024-09-07 22:03:59,642 [l2p.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.755, Train_accy 69.03:   0%|          | 0/20 [00:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.755, Train_accy 69.03:   5%|▌         | 1/20 [00:10<03:27, 10.93s/it]
Task 4, Epoch 2/20 => Loss 0.183, Train_accy 88.32:   5%|▌         | 1/20 [00:21<03:27, 10.93s/it]
Task 4, Epoch 2/20 => Loss 0.183, Train_accy 88.32:  10%|█         | 2/20 [00:21<03:16, 10.93s/it]
Task 4, Epoch 3/20 => Loss 0.069, Train_accy 92.99:  10%|█         | 2/20 [00:32<03:16, 10.93s/it]
Task 4, Epoch 3/20 => Loss 0.069, Train_accy 92.99:  15%|█▌        | 3/20 [00:32<03:06, 10.95s/it]
Task 4, Epoch 4/20 => Loss 0.106, Train_accy 91.18:  15%|█▌        | 3/20 [00:43<03:06, 10.95s/it]
Task 4, Epoch 4/20 => Loss 0.106, Train_accy 91.18:  20%|██        | 4/20 [00:43<02:55, 10.94s/it]
Task 4, Epoch 5/20 => Loss 0.059, Train_accy 92.04, Test_accy 64.93:  20%|██        | 4/20 [01:20<02:55, 10.94s/it]
Task 4, Epoch 5/20 => Loss 0.059, Train_accy 92.04, Test_accy 64.93:  25%|██▌       | 5/20 [01:20<05:01, 20.08s/it]
Task 4, Epoch 6/20 => Loss 0.022, Train_accy 92.82:  25%|██▌       | 5/20 [01:31<05:01, 20.08s/it]                 
Task 4, Epoch 6/20 => Loss 0.022, Train_accy 92.82:  30%|███       | 6/20 [01:31<03:57, 16.98s/it]
Task 4, Epoch 7/20 => Loss 0.046, Train_accy 93.51:  30%|███       | 6/20 [01:42<03:57, 16.98s/it]
Task 4, Epoch 7/20 => Loss 0.046, Train_accy 93.51:  35%|███▌      | 7/20 [01:42<03:15, 15.03s/it]
Task 4, Epoch 8/20 => Loss 0.037, Train_accy 93.51:  35%|███▌      | 7/20 [01:52<03:15, 15.03s/it]
Task 4, Epoch 8/20 => Loss 0.037, Train_accy 93.51:  40%|████      | 8/20 [01:52<02:44, 13.74s/it]
Task 4, Epoch 9/20 => Loss 0.014, Train_accy 93.60:  40%|████      | 8/20 [02:03<02:44, 13.74s/it]
Task 4, Epoch 9/20 => Loss 0.014, Train_accy 93.60:  45%|████▌     | 9/20 [02:03<02:21, 12.87s/it]
Task 4, Epoch 10/20 => Loss -0.002, Train_accy 94.55, Test_accy 65.14:  45%|████▌     | 9/20 [02:40<02:21, 12.87s/it]
Task 4, Epoch 10/20 => Loss -0.002, Train_accy 94.55, Test_accy 65.14:  50%|█████     | 10/20 [02:40<03:20, 20.08s/it]
Task 4, Epoch 11/20 => Loss -0.026, Train_accy 94.98:  50%|█████     | 10/20 [02:51<03:20, 20.08s/it]                 
Task 4, Epoch 11/20 => Loss -0.026, Train_accy 94.98:  55%|█████▌    | 11/20 [02:51<02:35, 17.30s/it]
Task 4, Epoch 12/20 => Loss -0.029, Train_accy 95.24:  55%|█████▌    | 11/20 [03:02<02:35, 17.30s/it]
Task 4, Epoch 12/20 => Loss -0.029, Train_accy 95.24:  60%|██████    | 12/20 [03:02<02:02, 15.36s/it]
Task 4, Epoch 13/20 => Loss -0.062, Train_accy 96.11:  60%|██████    | 12/20 [03:13<02:02, 15.36s/it]
Task 4, Epoch 13/20 => Loss -0.062, Train_accy 96.11:  65%|██████▌   | 13/20 [03:13<01:38, 14.01s/it]
Task 4, Epoch 14/20 => Loss -0.030, Train_accy 94.98:  65%|██████▌   | 13/20 [03:23<01:38, 14.01s/it]
Task 4, Epoch 14/20 => Loss -0.030, Train_accy 94.98:  70%|███████   | 14/20 [03:23<01:18, 13.08s/it]
Task 4, Epoch 15/20 => Loss -0.019, Train_accy 95.76, Test_accy 65.23:  70%|███████   | 14/20 [04:00<01:18, 13.08s/it]
Task 4, Epoch 15/20 => Loss -0.019, Train_accy 95.76, Test_accy 65.23:  75%|███████▌  | 15/20 [04:00<01:40, 20.07s/it]
Task 4, Epoch 16/20 => Loss -0.032, Train_accy 95.50:  75%|███████▌  | 15/20 [04:11<01:40, 20.07s/it]                 
Task 4, Epoch 16/20 => Loss -0.032, Train_accy 95.50:  80%|████████  | 16/20 [04:11<01:09, 17.35s/it]
Task 4, Epoch 17/20 => Loss -0.057, Train_accy 96.28:  80%|████████  | 16/20 [04:22<01:09, 17.35s/it]
Task 4, Epoch 17/20 => Loss -0.057, Train_accy 96.28:  85%|████████▌ | 17/20 [04:22<00:46, 15.42s/it]
Task 4, Epoch 18/20 => Loss -0.036, Train_accy 94.98:  85%|████████▌ | 17/20 [04:33<00:46, 15.42s/it]
Task 4, Epoch 18/20 => Loss -0.036, Train_accy 94.98:  90%|█████████ | 18/20 [04:33<00:28, 14.09s/it]
Task 4, Epoch 19/20 => Loss -0.008, Train_accy 95.07:  90%|█████████ | 18/20 [04:44<00:28, 14.09s/it]
Task 4, Epoch 19/20 => Loss -0.008, Train_accy 95.07:  95%|█████████▌| 19/20 [04:44<00:13, 13.15s/it]
Task 4, Epoch 20/20 => Loss -0.046, Train_accy 95.33, Test_accy 65.78:  95%|█████████▌| 19/20 [05:20<00:13, 13.15s/it]
Task 4, Epoch 20/20 => Loss -0.046, Train_accy 95.33, Test_accy 65.78: 100%|██████████| 20/20 [05:20<00:00, 20.11s/it]
Task 4, Epoch 20/20 => Loss -0.046, Train_accy 95.33, Test_accy 65.78: 100%|██████████| 20/20 [05:20<00:00, 16.02s/it]
2024-09-07 22:09:20,110 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.046, Train_accy 95.33, Test_accy 65.78
2024-09-07 22:09:45,461 [trainer.py] => No NME accuracy.
2024-09-07 22:09:45,462 [trainer.py] => CNN: {'total': 65.78, '00-99': 78.79, '100-109': 37.68, '110-119': 41.22, '120-129': 22.51, '130-139': 32.55, 'old': 68.31, 'new': 32.55}
2024-09-07 22:09:45,462 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46, 65.78]
2024-09-07 22:09:45,462 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59, 87.14]

Average Accuracy (CNN): 71.98
2024-09-07 22:09:45,462 [trainer.py] => Average Accuracy (CNN): 71.98 

2024-09-07 22:09:45,465 [trainer.py] => All params: 171970192
2024-09-07 22:09:45,466 [trainer.py] => Trainable params: 199880
2024-09-07 22:09:45,467 [l2p.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.481, Train_accy 79.15:   0%|          | 0/20 [00:13<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.481, Train_accy 79.15:   5%|▌         | 1/20 [00:13<04:12, 13.29s/it]
Task 5, Epoch 2/20 => Loss 0.068, Train_accy 91.59:   5%|▌         | 1/20 [00:26<04:12, 13.29s/it]
Task 5, Epoch 2/20 => Loss 0.068, Train_accy 91.59:  10%|█         | 2/20 [00:26<03:59, 13.30s/it]
Task 5, Epoch 3/20 => Loss 0.066, Train_accy 91.52:  10%|█         | 2/20 [00:39<03:59, 13.30s/it]
Task 5, Epoch 3/20 => Loss 0.066, Train_accy 91.52:  15%|█▌        | 3/20 [00:39<03:45, 13.28s/it]
Task 5, Epoch 4/20 => Loss 0.018, Train_accy 93.22:  15%|█▌        | 3/20 [00:53<03:45, 13.28s/it]
Task 5, Epoch 4/20 => Loss 0.018, Train_accy 93.22:  20%|██        | 4/20 [00:53<03:32, 13.29s/it]
Task 5, Epoch 5/20 => Loss -0.028, Train_accy 95.05, Test_accy 61.71:  20%|██        | 4/20 [01:33<03:32, 13.29s/it]
Task 5, Epoch 5/20 => Loss -0.028, Train_accy 95.05, Test_accy 61.71:  25%|██▌       | 5/20 [01:33<05:47, 23.14s/it]
Task 5, Epoch 6/20 => Loss 0.001, Train_accy 93.43:  25%|██▌       | 5/20 [01:47<05:47, 23.14s/it]                  
Task 5, Epoch 6/20 => Loss 0.001, Train_accy 93.43:  30%|███       | 6/20 [01:47<04:37, 19.81s/it]
Task 5, Epoch 7/20 => Loss -0.014, Train_accy 94.13:  30%|███       | 6/20 [02:00<04:37, 19.81s/it]
Task 5, Epoch 7/20 => Loss -0.014, Train_accy 94.13:  35%|███▌      | 7/20 [02:00<03:49, 17.69s/it]
Task 5, Epoch 8/20 => Loss 0.015, Train_accy 93.43:  35%|███▌      | 7/20 [02:13<03:49, 17.69s/it] 
Task 5, Epoch 8/20 => Loss 0.015, Train_accy 93.43:  40%|████      | 8/20 [02:13<03:15, 16.30s/it]
Task 5, Epoch 9/20 => Loss -0.033, Train_accy 95.27:  40%|████      | 8/20 [02:27<03:15, 16.30s/it]
Task 5, Epoch 9/20 => Loss -0.033, Train_accy 95.27:  45%|████▌     | 9/20 [02:27<02:49, 15.37s/it]
Task 5, Epoch 10/20 => Loss -0.022, Train_accy 94.49, Test_accy 62.13:  45%|████▌     | 9/20 [03:07<02:49, 15.37s/it]
Task 5, Epoch 10/20 => Loss -0.022, Train_accy 94.49, Test_accy 62.13:  50%|█████     | 10/20 [03:07<03:52, 23.20s/it]
Task 5, Epoch 11/20 => Loss -0.039, Train_accy 94.56:  50%|█████     | 10/20 [03:21<03:52, 23.20s/it]                 
Task 5, Epoch 11/20 => Loss -0.039, Train_accy 94.56:  55%|█████▌    | 11/20 [03:21<03:01, 20.17s/it]
Task 5, Epoch 12/20 => Loss -0.061, Train_accy 96.04:  55%|█████▌    | 11/20 [03:34<03:01, 20.17s/it]
Task 5, Epoch 12/20 => Loss -0.061, Train_accy 96.04:  60%|██████    | 12/20 [03:34<02:24, 18.08s/it]
Task 5, Epoch 13/20 => Loss -0.052, Train_accy 94.91:  60%|██████    | 12/20 [03:47<02:24, 18.08s/it]
Task 5, Epoch 13/20 => Loss -0.052, Train_accy 94.91:  65%|██████▌   | 13/20 [03:47<01:56, 16.62s/it]
Task 5, Epoch 14/20 => Loss -0.038, Train_accy 95.34:  65%|██████▌   | 13/20 [04:00<01:56, 16.62s/it]
Task 5, Epoch 14/20 => Loss -0.038, Train_accy 95.34:  70%|███████   | 14/20 [04:00<01:33, 15.61s/it]
Task 5, Epoch 15/20 => Loss -0.064, Train_accy 96.04, Test_accy 62.96:  70%|███████   | 14/20 [04:41<01:33, 15.61s/it]
Task 5, Epoch 15/20 => Loss -0.064, Train_accy 96.04, Test_accy 62.96:  75%|███████▌  | 15/20 [04:41<01:55, 23.13s/it]
Task 5, Epoch 16/20 => Loss -0.082, Train_accy 96.47:  75%|███████▌  | 15/20 [04:54<01:55, 23.13s/it]                 
Task 5, Epoch 16/20 => Loss -0.082, Train_accy 96.47:  80%|████████  | 16/20 [04:54<01:20, 20.15s/it]
Task 5, Epoch 17/20 => Loss -0.046, Train_accy 95.48:  80%|████████  | 16/20 [05:07<01:20, 20.15s/it]
Task 5, Epoch 17/20 => Loss -0.046, Train_accy 95.48:  85%|████████▌ | 17/20 [05:07<00:54, 18.07s/it]
Task 5, Epoch 18/20 => Loss -0.052, Train_accy 95.69:  85%|████████▌ | 17/20 [05:21<00:54, 18.07s/it]
Task 5, Epoch 18/20 => Loss -0.052, Train_accy 95.69:  90%|█████████ | 18/20 [05:21<00:33, 16.61s/it]
Task 5, Epoch 19/20 => Loss -0.056, Train_accy 95.90:  90%|█████████ | 18/20 [05:34<00:33, 16.61s/it]
Task 5, Epoch 19/20 => Loss -0.056, Train_accy 95.90:  95%|█████████▌| 19/20 [05:34<00:15, 15.61s/it]
Task 5, Epoch 20/20 => Loss -0.068, Train_accy 95.83, Test_accy 63.28:  95%|█████████▌| 19/20 [06:15<00:15, 15.61s/it]
Task 5, Epoch 20/20 => Loss -0.068, Train_accy 95.83, Test_accy 63.28: 100%|██████████| 20/20 [06:15<00:00, 23.14s/it]
Task 5, Epoch 20/20 => Loss -0.068, Train_accy 95.83, Test_accy 63.28: 100%|██████████| 20/20 [06:15<00:00, 18.76s/it]
2024-09-07 22:16:00,628 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.068, Train_accy 95.83, Test_accy 63.28
2024-09-07 22:16:28,143 [trainer.py] => No NME accuracy.
2024-09-07 22:16:28,144 [trainer.py] => CNN: {'total': 63.28, '00-99': 78.83, '100-109': 37.32, '110-119': 41.49, '120-129': 22.51, '130-139': 32.21, '140-149': 34.6, 'old': 65.78, 'new': 34.6}
2024-09-07 22:16:28,144 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46, 65.78, 63.28]
2024-09-07 22:16:28,144 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59, 87.14, 86.79]

Average Accuracy (CNN): 70.53
2024-09-07 22:16:28,144 [trainer.py] => Average Accuracy (CNN): 70.53 

2024-09-07 22:16:28,148 [trainer.py] => All params: 171970192
2024-09-07 22:16:28,150 [trainer.py] => Trainable params: 199880
2024-09-07 22:16:28,150 [l2p.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.803, Train_accy 68.45:   0%|          | 0/20 [00:13<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.803, Train_accy 68.45:   5%|▌         | 1/20 [00:13<04:10, 13.19s/it]
Task 6, Epoch 2/20 => Loss 0.231, Train_accy 86.94:   5%|▌         | 1/20 [00:26<04:10, 13.19s/it]
Task 6, Epoch 2/20 => Loss 0.231, Train_accy 86.94:  10%|█         | 2/20 [00:26<03:58, 13.25s/it]
Task 6, Epoch 3/20 => Loss 0.135, Train_accy 89.72:  10%|█         | 2/20 [00:39<03:58, 13.25s/it]
Task 6, Epoch 3/20 => Loss 0.135, Train_accy 89.72:  15%|█▌        | 3/20 [00:39<03:44, 13.20s/it]
Task 6, Epoch 4/20 => Loss 0.116, Train_accy 90.72:  15%|█▌        | 3/20 [00:52<03:44, 13.20s/it]
Task 6, Epoch 4/20 => Loss 0.116, Train_accy 90.72:  20%|██        | 4/20 [00:52<03:30, 13.16s/it]
Task 6, Epoch 5/20 => Loss 0.087, Train_accy 90.86, Test_accy 60.08:  20%|██        | 4/20 [01:35<03:30, 13.16s/it]
Task 6, Epoch 5/20 => Loss 0.087, Train_accy 90.86, Test_accy 60.08:  25%|██▌       | 5/20 [01:35<05:57, 23.82s/it]
Task 6, Epoch 6/20 => Loss 0.043, Train_accy 92.79:  25%|██▌       | 5/20 [01:48<05:57, 23.82s/it]                 
Task 6, Epoch 6/20 => Loss 0.043, Train_accy 92.79:  30%|███       | 6/20 [01:48<04:42, 20.19s/it]
Task 6, Epoch 7/20 => Loss 0.017, Train_accy 93.50:  30%|███       | 6/20 [02:01<04:42, 20.19s/it]
Task 6, Epoch 7/20 => Loss 0.017, Train_accy 93.50:  35%|███▌      | 7/20 [02:01<03:52, 17.89s/it]
Task 6, Epoch 8/20 => Loss 0.032, Train_accy 92.58:  35%|███▌      | 7/20 [02:14<03:52, 17.89s/it]
Task 6, Epoch 8/20 => Loss 0.032, Train_accy 92.58:  40%|████      | 8/20 [02:14<03:16, 16.40s/it]
Task 6, Epoch 9/20 => Loss 0.052, Train_accy 93.00:  40%|████      | 8/20 [02:28<03:16, 16.40s/it]
Task 6, Epoch 9/20 => Loss 0.052, Train_accy 93.00:  45%|████▌     | 9/20 [02:28<02:50, 15.50s/it]
Task 6, Epoch 10/20 => Loss 0.002, Train_accy 94.22, Test_accy 60.51:  45%|████▌     | 9/20 [03:11<02:50, 15.50s/it]
Task 6, Epoch 10/20 => Loss 0.002, Train_accy 94.22, Test_accy 60.51:  50%|█████     | 10/20 [03:11<03:59, 23.95s/it]
Task 6, Epoch 11/20 => Loss -0.010, Train_accy 94.29:  50%|█████     | 10/20 [03:24<03:59, 23.95s/it]                
Task 6, Epoch 11/20 => Loss -0.010, Train_accy 94.29:  55%|█████▌    | 11/20 [03:24<03:06, 20.67s/it]
Task 6, Epoch 12/20 => Loss -0.004, Train_accy 94.29:  55%|█████▌    | 11/20 [03:37<03:06, 20.67s/it]
Task 6, Epoch 12/20 => Loss -0.004, Train_accy 94.29:  60%|██████    | 12/20 [03:37<02:27, 18.39s/it]
Task 6, Epoch 13/20 => Loss -0.022, Train_accy 94.50:  60%|██████    | 12/20 [03:51<02:27, 18.39s/it]
Task 6, Epoch 13/20 => Loss -0.022, Train_accy 94.50:  65%|██████▌   | 13/20 [03:51<01:57, 16.85s/it]
Task 6, Epoch 14/20 => Loss -0.035, Train_accy 95.15:  65%|██████▌   | 13/20 [04:04<01:57, 16.85s/it]
Task 6, Epoch 14/20 => Loss -0.035, Train_accy 95.15:  70%|███████   | 14/20 [04:04<01:34, 15.74s/it]
Task 6, Epoch 15/20 => Loss -0.043, Train_accy 95.43, Test_accy 61.22:  70%|███████   | 14/20 [04:47<01:34, 15.74s/it]
Task 6, Epoch 15/20 => Loss -0.043, Train_accy 95.43, Test_accy 61.22:  75%|███████▌  | 15/20 [04:47<01:59, 23.90s/it]
Task 6, Epoch 16/20 => Loss -0.035, Train_accy 95.50:  75%|███████▌  | 15/20 [05:00<01:59, 23.90s/it]                 
Task 6, Epoch 16/20 => Loss -0.035, Train_accy 95.50:  80%|████████  | 16/20 [05:00<01:22, 20.70s/it]
Task 6, Epoch 17/20 => Loss 0.000, Train_accy 94.65:  80%|████████  | 16/20 [05:13<01:22, 20.70s/it] 
Task 6, Epoch 17/20 => Loss 0.000, Train_accy 94.65:  85%|████████▌ | 17/20 [05:13<00:55, 18.47s/it]
Task 6, Epoch 18/20 => Loss -0.006, Train_accy 94.00:  85%|████████▌ | 17/20 [05:26<00:55, 18.47s/it]
Task 6, Epoch 18/20 => Loss -0.006, Train_accy 94.00:  90%|█████████ | 18/20 [05:26<00:33, 16.86s/it]
Task 6, Epoch 19/20 => Loss -0.038, Train_accy 95.79:  90%|█████████ | 18/20 [05:39<00:33, 16.86s/it]
Task 6, Epoch 19/20 => Loss -0.038, Train_accy 95.79:  95%|█████████▌| 19/20 [05:39<00:15, 15.73s/it]
Task 6, Epoch 20/20 => Loss -0.035, Train_accy 96.00, Test_accy 61.34:  95%|█████████▌| 19/20 [06:22<00:15, 15.73s/it]
Task 6, Epoch 20/20 => Loss -0.035, Train_accy 96.00, Test_accy 61.34: 100%|██████████| 20/20 [06:22<00:00, 23.85s/it]
Task 6, Epoch 20/20 => Loss -0.035, Train_accy 96.00, Test_accy 61.34: 100%|██████████| 20/20 [06:22<00:00, 19.13s/it]
2024-09-07 22:22:50,757 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.035, Train_accy 96.00, Test_accy 61.34
2024-09-07 22:23:20,117 [trainer.py] => No NME accuracy.
2024-09-07 22:23:20,117 [trainer.py] => CNN: {'total': 61.34, '00-99': 79.23, '100-109': 36.97, '110-119': 42.29, '120-129': 19.93, '130-139': 31.88, '140-149': 34.06, '150-159': 35.64, 'old': 63.37, 'new': 35.64}
2024-09-07 22:23:20,117 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46, 65.78, 63.28, 61.34]
2024-09-07 22:23:20,117 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59, 87.14, 86.79, 86.02]

Average Accuracy (CNN): 69.22
2024-09-07 22:23:20,118 [trainer.py] => Average Accuracy (CNN): 69.22 

2024-09-07 22:23:20,120 [trainer.py] => All params: 171970192
2024-09-07 22:23:20,121 [trainer.py] => Trainable params: 199880
2024-09-07 22:23:20,122 [l2p.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.128, Train_accy 56.14:   0%|          | 0/20 [00:09<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.128, Train_accy 56.14:   5%|▌         | 1/20 [00:09<03:00,  9.48s/it]
Task 7, Epoch 2/20 => Loss 0.404, Train_accy 80.28:   5%|▌         | 1/20 [00:18<03:00,  9.48s/it]
Task 7, Epoch 2/20 => Loss 0.404, Train_accy 80.28:  10%|█         | 2/20 [00:18<02:50,  9.47s/it]
Task 7, Epoch 3/20 => Loss 0.256, Train_accy 85.21:  10%|█         | 2/20 [00:28<02:50,  9.47s/it]
Task 7, Epoch 3/20 => Loss 0.256, Train_accy 85.21:  15%|█▌        | 3/20 [00:28<02:41,  9.48s/it]
Task 7, Epoch 4/20 => Loss 0.176, Train_accy 89.03:  15%|█▌        | 3/20 [00:37<02:41,  9.48s/it]
Task 7, Epoch 4/20 => Loss 0.176, Train_accy 89.03:  20%|██        | 4/20 [00:37<02:31,  9.46s/it]
Task 7, Epoch 5/20 => Loss 0.159, Train_accy 88.43, Test_accy 59.35:  20%|██        | 4/20 [01:18<02:31,  9.46s/it]
Task 7, Epoch 5/20 => Loss 0.159, Train_accy 88.43, Test_accy 59.35:  25%|██▌       | 5/20 [01:18<05:09, 20.64s/it]
Task 7, Epoch 6/20 => Loss 0.154, Train_accy 89.34:  25%|██▌       | 5/20 [01:27<05:09, 20.64s/it]                 
Task 7, Epoch 6/20 => Loss 0.154, Train_accy 89.34:  30%|███       | 6/20 [01:27<03:56, 16.86s/it]
Task 7, Epoch 7/20 => Loss 0.099, Train_accy 90.95:  30%|███       | 6/20 [01:37<03:56, 16.86s/it]
Task 7, Epoch 7/20 => Loss 0.099, Train_accy 90.95:  35%|███▌      | 7/20 [01:37<03:07, 14.44s/it]
Task 7, Epoch 8/20 => Loss 0.106, Train_accy 91.25:  35%|███▌      | 7/20 [01:46<03:07, 14.44s/it]
Task 7, Epoch 8/20 => Loss 0.106, Train_accy 91.25:  40%|████      | 8/20 [01:46<02:34, 12.85s/it]
Task 7, Epoch 9/20 => Loss 0.093, Train_accy 91.85:  40%|████      | 8/20 [01:56<02:34, 12.85s/it]
Task 7, Epoch 9/20 => Loss 0.093, Train_accy 91.85:  45%|████▌     | 9/20 [01:56<02:09, 11.80s/it]
Task 7, Epoch 10/20 => Loss 0.087, Train_accy 90.74, Test_accy 59.33:  45%|████▌     | 9/20 [02:36<02:09, 11.80s/it]
Task 7, Epoch 10/20 => Loss 0.087, Train_accy 90.74, Test_accy 59.33:  50%|█████     | 10/20 [02:36<03:26, 20.62s/it]
Task 7, Epoch 11/20 => Loss 0.079, Train_accy 92.25:  50%|█████     | 10/20 [02:46<03:26, 20.62s/it]                 
Task 7, Epoch 11/20 => Loss 0.079, Train_accy 92.25:  55%|█████▌    | 11/20 [02:46<02:34, 17.19s/it]
Task 7, Epoch 12/20 => Loss 0.065, Train_accy 92.56:  55%|█████▌    | 11/20 [02:55<02:34, 17.19s/it]
Task 7, Epoch 12/20 => Loss 0.065, Train_accy 92.56:  60%|██████    | 12/20 [02:55<01:58, 14.83s/it]
Task 7, Epoch 13/20 => Loss 0.030, Train_accy 93.36:  60%|██████    | 12/20 [03:04<01:58, 14.83s/it]
Task 7, Epoch 13/20 => Loss 0.030, Train_accy 93.36:  65%|██████▌   | 13/20 [03:04<01:32, 13.20s/it]
Task 7, Epoch 14/20 => Loss 0.037, Train_accy 92.86:  65%|██████▌   | 13/20 [03:14<01:32, 13.20s/it]
Task 7, Epoch 14/20 => Loss 0.037, Train_accy 92.86:  70%|███████   | 14/20 [03:14<01:12, 12.07s/it]
Task 7, Epoch 15/20 => Loss 0.034, Train_accy 93.26, Test_accy 59.37:  70%|███████   | 14/20 [03:54<01:12, 12.07s/it]
Task 7, Epoch 15/20 => Loss 0.034, Train_accy 93.26, Test_accy 59.37:  75%|███████▌  | 15/20 [03:54<01:42, 20.60s/it]
Task 7, Epoch 16/20 => Loss 0.066, Train_accy 91.65:  75%|███████▌  | 15/20 [04:04<01:42, 20.60s/it]                 
Task 7, Epoch 16/20 => Loss 0.066, Train_accy 91.65:  80%|████████  | 16/20 [04:04<01:09, 17.25s/it]
Task 7, Epoch 17/20 => Loss 0.044, Train_accy 93.16:  80%|████████  | 16/20 [04:13<01:09, 17.25s/it]
Task 7, Epoch 17/20 => Loss 0.044, Train_accy 93.16:  85%|████████▌ | 17/20 [04:13<00:44, 14.91s/it]
Task 7, Epoch 18/20 => Loss 0.019, Train_accy 94.06:  85%|████████▌ | 17/20 [04:23<00:44, 14.91s/it]
Task 7, Epoch 18/20 => Loss 0.019, Train_accy 94.06:  90%|█████████ | 18/20 [04:23<00:26, 13.26s/it]
Task 7, Epoch 19/20 => Loss 0.034, Train_accy 92.76:  90%|█████████ | 18/20 [04:32<00:26, 13.26s/it]
Task 7, Epoch 19/20 => Loss 0.034, Train_accy 92.76:  95%|█████████▌| 19/20 [04:32<00:12, 12.11s/it]
Task 7, Epoch 20/20 => Loss 0.021, Train_accy 93.26, Test_accy 59.52:  95%|█████████▌| 19/20 [05:12<00:12, 12.11s/it]
Task 7, Epoch 20/20 => Loss 0.021, Train_accy 93.26, Test_accy 59.52: 100%|██████████| 20/20 [05:12<00:00, 20.60s/it]
Task 7, Epoch 20/20 => Loss 0.021, Train_accy 93.26, Test_accy 59.52: 100%|██████████| 20/20 [05:12<00:00, 15.65s/it]
2024-09-07 22:28:33,060 [l2p.py] => Task 7, Epoch 20/20 => Loss 0.021, Train_accy 93.26, Test_accy 59.52
2024-09-07 22:29:04,024 [trainer.py] => No NME accuracy.
2024-09-07 22:29:04,025 [trainer.py] => CNN: {'total': 59.52, '00-99': 79.06, '100-109': 38.38, '110-119': 41.22, '120-129': 21.03, '130-139': 31.88, '140-149': 33.24, '150-159': 36.74, '160-169': 20.87, 'old': 61.32, 'new': 20.87}
2024-09-07 22:29:04,025 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46, 65.78, 63.28, 61.34, 59.52]
2024-09-07 22:29:04,025 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59, 87.14, 86.79, 86.02, 84.61]

Average Accuracy (CNN): 68.0
2024-09-07 22:29:04,025 [trainer.py] => Average Accuracy (CNN): 68.0 

2024-09-07 22:29:04,027 [trainer.py] => All params: 171970192
2024-09-07 22:29:04,029 [trainer.py] => Trainable params: 199880
2024-09-07 22:29:04,029 [l2p.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.696, Train_accy 72.54:   0%|          | 0/20 [00:09<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.696, Train_accy 72.54:   5%|▌         | 1/20 [00:09<02:53,  9.13s/it]
Task 8, Epoch 2/20 => Loss 0.154, Train_accy 89.52:   5%|▌         | 1/20 [00:18<02:53,  9.13s/it]
Task 8, Epoch 2/20 => Loss 0.154, Train_accy 89.52:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]
Task 8, Epoch 3/20 => Loss 0.087, Train_accy 91.30:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]
Task 8, Epoch 3/20 => Loss 0.087, Train_accy 91.30:  15%|█▌        | 3/20 [00:27<02:35,  9.12s/it]
Task 8, Epoch 4/20 => Loss 0.037, Train_accy 94.13:  15%|█▌        | 3/20 [00:36<02:35,  9.12s/it]
Task 8, Epoch 4/20 => Loss 0.037, Train_accy 94.13:  20%|██        | 4/20 [00:36<02:25,  9.11s/it]
Task 8, Epoch 5/20 => Loss 0.006, Train_accy 94.23, Test_accy 58.35:  20%|██        | 4/20 [01:17<02:25,  9.11s/it]
Task 8, Epoch 5/20 => Loss 0.006, Train_accy 94.23, Test_accy 58.35:  25%|██▌       | 5/20 [01:17<05:10, 20.69s/it]
Task 8, Epoch 6/20 => Loss -0.007, Train_accy 94.23:  25%|██▌       | 5/20 [01:26<05:10, 20.69s/it]                
Task 8, Epoch 6/20 => Loss -0.007, Train_accy 94.23:  30%|███       | 6/20 [01:26<03:54, 16.74s/it]
Task 8, Epoch 7/20 => Loss -0.009, Train_accy 94.13:  30%|███       | 6/20 [01:36<03:54, 16.74s/it]
Task 8, Epoch 7/20 => Loss -0.009, Train_accy 94.13:  35%|███▌      | 7/20 [01:36<03:05, 14.30s/it]
Task 8, Epoch 8/20 => Loss -0.006, Train_accy 94.44:  35%|███▌      | 7/20 [01:45<03:05, 14.30s/it]
Task 8, Epoch 8/20 => Loss -0.006, Train_accy 94.44:  40%|████      | 8/20 [01:45<02:31, 12.66s/it]
Task 8, Epoch 9/20 => Loss -0.022, Train_accy 95.18:  40%|████      | 8/20 [01:54<02:31, 12.66s/it]
Task 8, Epoch 9/20 => Loss -0.022, Train_accy 95.18:  45%|████▌     | 9/20 [01:54<02:07, 11.56s/it]
Task 8, Epoch 10/20 => Loss -0.036, Train_accy 95.18, Test_accy 58.64:  45%|████▌     | 9/20 [02:35<02:07, 11.56s/it]
Task 8, Epoch 10/20 => Loss -0.036, Train_accy 95.18, Test_accy 58.64:  50%|█████     | 10/20 [02:35<03:27, 20.79s/it]
Task 8, Epoch 11/20 => Loss -0.042, Train_accy 95.39:  50%|█████     | 10/20 [02:44<03:27, 20.79s/it]                 
Task 8, Epoch 11/20 => Loss -0.042, Train_accy 95.39:  55%|█████▌    | 11/20 [02:44<02:34, 17.21s/it]
Task 8, Epoch 12/20 => Loss -0.049, Train_accy 95.39:  55%|█████▌    | 11/20 [02:54<02:34, 17.21s/it]
Task 8, Epoch 12/20 => Loss -0.049, Train_accy 95.39:  60%|██████    | 12/20 [02:54<01:58, 14.81s/it]
Task 8, Epoch 13/20 => Loss -0.010, Train_accy 94.34:  60%|██████    | 12/20 [03:03<01:58, 14.81s/it]
Task 8, Epoch 13/20 => Loss -0.010, Train_accy 94.34:  65%|██████▌   | 13/20 [03:03<01:31, 13.08s/it]
Task 8, Epoch 14/20 => Loss -0.043, Train_accy 95.28:  65%|██████▌   | 13/20 [03:12<01:31, 13.08s/it]
Task 8, Epoch 14/20 => Loss -0.043, Train_accy 95.28:  70%|███████   | 14/20 [03:12<01:11, 11.88s/it]
Task 8, Epoch 15/20 => Loss -0.059, Train_accy 95.39, Test_accy 58.57:  70%|███████   | 14/20 [03:53<01:11, 11.88s/it]
Task 8, Epoch 15/20 => Loss -0.059, Train_accy 95.39, Test_accy 58.57:  75%|███████▌  | 15/20 [03:53<01:43, 20.77s/it]
Task 8, Epoch 16/20 => Loss -0.067, Train_accy 96.65:  75%|███████▌  | 15/20 [04:02<01:43, 20.77s/it]                 
Task 8, Epoch 16/20 => Loss -0.067, Train_accy 96.65:  80%|████████  | 16/20 [04:02<01:09, 17.27s/it]
Task 8, Epoch 17/20 => Loss -0.043, Train_accy 95.39:  80%|████████  | 16/20 [04:12<01:09, 17.27s/it]
Task 8, Epoch 17/20 => Loss -0.043, Train_accy 95.39:  85%|████████▌ | 17/20 [04:12<00:44, 14.82s/it]
Task 8, Epoch 18/20 => Loss -0.053, Train_accy 95.70:  85%|████████▌ | 17/20 [04:21<00:44, 14.82s/it]
Task 8, Epoch 18/20 => Loss -0.053, Train_accy 95.70:  90%|█████████ | 18/20 [04:21<00:26, 13.12s/it]
Task 8, Epoch 19/20 => Loss -0.054, Train_accy 95.81:  90%|█████████ | 18/20 [04:30<00:26, 13.12s/it]
Task 8, Epoch 19/20 => Loss -0.054, Train_accy 95.81:  95%|█████████▌| 19/20 [04:30<00:11, 11.92s/it]
Task 8, Epoch 20/20 => Loss -0.049, Train_accy 95.81, Test_accy 58.49:  95%|█████████▌| 19/20 [05:11<00:11, 11.92s/it]
Task 8, Epoch 20/20 => Loss -0.049, Train_accy 95.81, Test_accy 58.49: 100%|██████████| 20/20 [05:11<00:00, 20.77s/it]
Task 8, Epoch 20/20 => Loss -0.049, Train_accy 95.81, Test_accy 58.49: 100%|██████████| 20/20 [05:11<00:00, 15.59s/it]
2024-09-07 22:34:15,778 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.049, Train_accy 95.81, Test_accy 58.49
2024-09-07 22:34:48,257 [trainer.py] => No NME accuracy.
2024-09-07 22:34:48,258 [trainer.py] => CNN: {'total': 58.49, '00-99': 78.96, '100-109': 36.27, '110-119': 42.55, '120-129': 19.93, '130-139': 30.87, '140-149': 35.15, '150-159': 36.19, '160-169': 22.61, '170-179': 37.5, 'old': 59.5, 'new': 37.5}
2024-09-07 22:34:48,258 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46, 65.78, 63.28, 61.34, 59.52, 58.49]
2024-09-07 22:34:48,258 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59, 87.14, 86.79, 86.02, 84.61, 84.19]

Average Accuracy (CNN): 66.95
2024-09-07 22:34:48,258 [trainer.py] => Average Accuracy (CNN): 66.95 

2024-09-07 22:34:48,260 [trainer.py] => All params: 171970192
2024-09-07 22:34:48,262 [trainer.py] => Trainable params: 199880
2024-09-07 22:34:48,262 [l2p.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.710, Train_accy 72.33:   0%|          | 0/20 [00:10<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.710, Train_accy 72.33:   5%|▌         | 1/20 [00:10<03:26, 10.85s/it]
Task 9, Epoch 2/20 => Loss 0.205, Train_accy 87.65:   5%|▌         | 1/20 [00:21<03:26, 10.85s/it]
Task 9, Epoch 2/20 => Loss 0.205, Train_accy 87.65:  10%|█         | 2/20 [00:21<03:14, 10.83s/it]
Task 9, Epoch 3/20 => Loss 0.153, Train_accy 89.84:  10%|█         | 2/20 [00:32<03:14, 10.83s/it]
Task 9, Epoch 3/20 => Loss 0.153, Train_accy 89.84:  15%|█▌        | 3/20 [00:32<03:03, 10.81s/it]
Task 9, Epoch 4/20 => Loss 0.060, Train_accy 92.47:  15%|█▌        | 3/20 [00:43<03:03, 10.81s/it]
Task 9, Epoch 4/20 => Loss 0.060, Train_accy 92.47:  20%|██        | 4/20 [00:43<02:52, 10.80s/it]
Task 9, Epoch 5/20 => Loss 0.080, Train_accy 91.51, Test_accy 56.03:  20%|██        | 4/20 [01:27<02:52, 10.80s/it]
Task 9, Epoch 5/20 => Loss 0.080, Train_accy 91.51, Test_accy 56.03:  25%|██▌       | 5/20 [01:27<05:45, 23.03s/it]
Task 9, Epoch 6/20 => Loss 0.035, Train_accy 92.73:  25%|██▌       | 5/20 [01:38<05:45, 23.03s/it]                 
Task 9, Epoch 6/20 => Loss 0.035, Train_accy 92.73:  30%|███       | 6/20 [01:38<04:24, 18.86s/it]
Task 9, Epoch 7/20 => Loss 0.050, Train_accy 92.56:  30%|███       | 6/20 [01:49<04:24, 18.86s/it]
Task 9, Epoch 7/20 => Loss 0.050, Train_accy 92.56:  35%|███▌      | 7/20 [01:49<03:30, 16.21s/it]
Task 9, Epoch 8/20 => Loss 0.019, Train_accy 93.70:  35%|███▌      | 7/20 [02:00<03:30, 16.21s/it]
Task 9, Epoch 8/20 => Loss 0.019, Train_accy 93.70:  40%|████      | 8/20 [02:00<02:53, 14.49s/it]
Task 9, Epoch 9/20 => Loss -0.030, Train_accy 94.92:  40%|████      | 8/20 [02:11<02:53, 14.49s/it]
Task 9, Epoch 9/20 => Loss -0.030, Train_accy 94.92:  45%|████▌     | 9/20 [02:11<02:26, 13.34s/it]
Task 9, Epoch 10/20 => Loss -0.013, Train_accy 94.48, Test_accy 56.08:  45%|████▌     | 9/20 [02:56<02:26, 13.34s/it]
Task 9, Epoch 10/20 => Loss -0.013, Train_accy 94.48, Test_accy 56.08:  50%|█████     | 10/20 [02:56<03:52, 23.20s/it]
Task 9, Epoch 11/20 => Loss -0.023, Train_accy 94.40:  50%|█████     | 10/20 [03:07<03:52, 23.20s/it]                 
Task 9, Epoch 11/20 => Loss -0.023, Train_accy 94.40:  55%|█████▌    | 11/20 [03:07<02:54, 19.43s/it]
Task 9, Epoch 12/20 => Loss -0.004, Train_accy 94.05:  55%|█████▌    | 11/20 [03:18<02:54, 19.43s/it]
Task 9, Epoch 12/20 => Loss -0.004, Train_accy 94.05:  60%|██████    | 12/20 [03:18<02:14, 16.82s/it]
Task 9, Epoch 13/20 => Loss -0.003, Train_accy 94.48:  60%|██████    | 12/20 [03:28<02:14, 16.82s/it]
Task 9, Epoch 13/20 => Loss -0.003, Train_accy 94.48:  65%|██████▌   | 13/20 [03:28<01:45, 15.01s/it]
Task 9, Epoch 14/20 => Loss -0.012, Train_accy 94.57:  65%|██████▌   | 13/20 [03:39<01:45, 15.01s/it]
Task 9, Epoch 14/20 => Loss -0.012, Train_accy 94.57:  70%|███████   | 14/20 [03:39<01:22, 13.74s/it]
Task 9, Epoch 15/20 => Loss 0.005, Train_accy 94.13, Test_accy 56.15:  70%|███████   | 14/20 [04:24<01:22, 13.74s/it]
Task 9, Epoch 15/20 => Loss 0.005, Train_accy 94.13, Test_accy 56.15:  75%|███████▌  | 15/20 [04:24<01:55, 23.17s/it]
Task 9, Epoch 16/20 => Loss -0.017, Train_accy 94.83:  75%|███████▌  | 15/20 [04:35<01:55, 23.17s/it]                
Task 9, Epoch 16/20 => Loss -0.017, Train_accy 94.83:  80%|████████  | 16/20 [04:35<01:17, 19.47s/it]
Task 9, Epoch 17/20 => Loss -0.036, Train_accy 95.62:  80%|████████  | 16/20 [04:46<01:17, 19.47s/it]
Task 9, Epoch 17/20 => Loss -0.036, Train_accy 95.62:  85%|████████▌ | 17/20 [04:46<00:50, 16.87s/it]
Task 9, Epoch 18/20 => Loss -0.062, Train_accy 95.88:  85%|████████▌ | 17/20 [04:57<00:50, 16.87s/it]
Task 9, Epoch 18/20 => Loss -0.062, Train_accy 95.88:  90%|█████████ | 18/20 [04:57<00:30, 15.05s/it]
Task 9, Epoch 19/20 => Loss -0.049, Train_accy 95.80:  90%|█████████ | 18/20 [05:08<00:30, 15.05s/it]
Task 9, Epoch 19/20 => Loss -0.049, Train_accy 95.80:  95%|█████████▌| 19/20 [05:08<00:13, 13.79s/it]
Task 9, Epoch 20/20 => Loss -0.013, Train_accy 94.92, Test_accy 55.86:  95%|█████████▌| 19/20 [05:52<00:13, 13.79s/it]
Task 9, Epoch 20/20 => Loss -0.013, Train_accy 94.92, Test_accy 55.86: 100%|██████████| 20/20 [05:52<00:00, 23.11s/it]
Task 9, Epoch 20/20 => Loss -0.013, Train_accy 94.92, Test_accy 55.86: 100%|██████████| 20/20 [05:52<00:00, 17.65s/it]
2024-09-07 22:40:41,269 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.013, Train_accy 94.92, Test_accy 55.86
2024-09-07 22:41:15,244 [trainer.py] => No NME accuracy.
2024-09-07 22:41:15,244 [trainer.py] => CNN: {'total': 55.86, '00-99': 79.06, '100-109': 35.92, '110-119': 41.22, '120-129': 21.4, '130-139': 30.87, '140-149': 34.06, '150-159': 35.64, '160-169': 19.13, '170-179': 36.69, '180-189': 14.29, 'old': 58.22, 'new': 14.29}
2024-09-07 22:41:15,244 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46, 65.78, 63.28, 61.34, 59.52, 58.49, 55.86]
2024-09-07 22:41:15,245 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59, 87.14, 86.79, 86.02, 84.61, 84.19, 82.79]

Average Accuracy (CNN): 65.84
2024-09-07 22:41:15,245 [trainer.py] => Average Accuracy (CNN): 65.84 

2024-09-07 22:41:15,247 [trainer.py] => All params: 171970192
2024-09-07 22:41:15,249 [trainer.py] => Trainable params: 199880
2024-09-07 22:41:15,250 [l2p.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.570, Train_accy 75.98:   0%|          | 0/20 [00:10<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.570, Train_accy 75.98:   5%|▌         | 1/20 [00:10<03:21, 10.62s/it]
Task 10, Epoch 2/20 => Loss 0.092, Train_accy 91.31:   5%|▌         | 1/20 [00:21<03:21, 10.62s/it]
Task 10, Epoch 2/20 => Loss 0.092, Train_accy 91.31:  10%|█         | 2/20 [00:21<03:11, 10.64s/it]
Task 10, Epoch 3/20 => Loss 0.026, Train_accy 93.35:  10%|█         | 2/20 [00:31<03:11, 10.64s/it]
Task 10, Epoch 3/20 => Loss 0.026, Train_accy 93.35:  15%|█▌        | 3/20 [00:31<03:01, 10.66s/it]
Task 10, Epoch 4/20 => Loss 0.003, Train_accy 93.44:  15%|█▌        | 3/20 [00:42<03:01, 10.66s/it]
Task 10, Epoch 4/20 => Loss 0.003, Train_accy 93.44:  20%|██        | 4/20 [00:42<02:50, 10.67s/it]
Task 10, Epoch 5/20 => Loss -0.016, Train_accy 94.33, Test_accy 54.92:  20%|██        | 4/20 [01:28<02:50, 10.67s/it]
Task 10, Epoch 5/20 => Loss -0.016, Train_accy 94.33, Test_accy 54.92:  25%|██▌       | 5/20 [01:28<05:52, 23.49s/it]
Task 10, Epoch 6/20 => Loss -0.026, Train_accy 94.59:  25%|██▌       | 5/20 [01:39<05:52, 23.49s/it]                 
Task 10, Epoch 6/20 => Loss -0.026, Train_accy 94.59:  30%|███       | 6/20 [01:39<04:27, 19.13s/it]
Task 10, Epoch 7/20 => Loss 0.004, Train_accy 93.71:  30%|███       | 6/20 [01:50<04:27, 19.13s/it] 
Task 10, Epoch 7/20 => Loss 0.004, Train_accy 93.71:  35%|███▌      | 7/20 [01:50<03:32, 16.36s/it]
Task 10, Epoch 8/20 => Loss -0.014, Train_accy 94.59:  35%|███▌      | 7/20 [02:01<03:32, 16.36s/it]
Task 10, Epoch 8/20 => Loss -0.014, Train_accy 94.59:  40%|████      | 8/20 [02:01<02:55, 14.62s/it]
Task 10, Epoch 9/20 => Loss -0.035, Train_accy 94.86:  40%|████      | 8/20 [02:11<02:55, 14.62s/it]
Task 10, Epoch 9/20 => Loss -0.035, Train_accy 94.86:  45%|████▌     | 9/20 [02:11<02:27, 13.38s/it]
Task 10, Epoch 10/20 => Loss -0.066, Train_accy 95.74, Test_accy 54.98:  45%|████▌     | 9/20 [02:58<02:27, 13.38s/it]
Task 10, Epoch 10/20 => Loss -0.066, Train_accy 95.74, Test_accy 54.98:  50%|█████     | 10/20 [02:58<03:55, 23.55s/it]
Task 10, Epoch 11/20 => Loss -0.051, Train_accy 95.39:  50%|█████     | 10/20 [03:08<03:55, 23.55s/it]                 
Task 10, Epoch 11/20 => Loss -0.051, Train_accy 95.39:  55%|█████▌    | 11/20 [03:08<02:56, 19.60s/it]
Task 10, Epoch 12/20 => Loss -0.019, Train_accy 94.15:  55%|█████▌    | 11/20 [03:19<02:56, 19.60s/it]
Task 10, Epoch 12/20 => Loss -0.019, Train_accy 94.15:  60%|██████    | 12/20 [03:19<02:15, 16.88s/it]
Task 10, Epoch 13/20 => Loss -0.036, Train_accy 94.95:  60%|██████    | 12/20 [03:30<02:15, 16.88s/it]
Task 10, Epoch 13/20 => Loss -0.036, Train_accy 94.95:  65%|██████▌   | 13/20 [03:30<01:45, 15.01s/it]
Task 10, Epoch 14/20 => Loss -0.073, Train_accy 95.92:  65%|██████▌   | 13/20 [03:40<01:45, 15.01s/it]
Task 10, Epoch 14/20 => Loss -0.073, Train_accy 95.92:  70%|███████   | 14/20 [03:40<01:22, 13.72s/it]
Task 10, Epoch 15/20 => Loss -0.050, Train_accy 95.04, Test_accy 55.10:  70%|███████   | 14/20 [04:27<01:22, 13.72s/it]
Task 10, Epoch 15/20 => Loss -0.050, Train_accy 95.04, Test_accy 55.10:  75%|███████▌  | 15/20 [04:27<01:57, 23.55s/it]
Task 10, Epoch 16/20 => Loss -0.079, Train_accy 96.28:  75%|███████▌  | 15/20 [04:37<01:57, 23.55s/it]                 
Task 10, Epoch 16/20 => Loss -0.079, Train_accy 96.28:  80%|████████  | 16/20 [04:37<01:18, 19.71s/it]
Task 10, Epoch 17/20 => Loss -0.066, Train_accy 96.28:  80%|████████  | 16/20 [04:48<01:18, 19.71s/it]
Task 10, Epoch 17/20 => Loss -0.066, Train_accy 96.28:  85%|████████▌ | 17/20 [04:48<00:50, 16.98s/it]
Task 10, Epoch 18/20 => Loss -0.101, Train_accy 97.16:  85%|████████▌ | 17/20 [04:59<00:50, 16.98s/it]
Task 10, Epoch 18/20 => Loss -0.101, Train_accy 97.16:  90%|█████████ | 18/20 [04:59<00:30, 15.09s/it]
Task 10, Epoch 19/20 => Loss -0.042, Train_accy 95.12:  90%|█████████ | 18/20 [05:09<00:30, 15.09s/it]
Task 10, Epoch 19/20 => Loss -0.042, Train_accy 95.12:  95%|█████████▌| 19/20 [05:09<00:13, 13.76s/it]
Task 10, Epoch 20/20 => Loss -0.070, Train_accy 96.28, Test_accy 55.38:  95%|█████████▌| 19/20 [05:56<00:13, 13.76s/it]
Task 10, Epoch 20/20 => Loss -0.070, Train_accy 96.28, Test_accy 55.38: 100%|██████████| 20/20 [05:56<00:00, 23.52s/it]
Task 10, Epoch 20/20 => Loss -0.070, Train_accy 96.28, Test_accy 55.38: 100%|██████████| 20/20 [05:56<00:00, 17.81s/it]
2024-09-07 22:47:11,439 [l2p.py] => Task 10, Epoch 20/20 => Loss -0.070, Train_accy 96.28, Test_accy 55.38
2024-09-07 22:47:46,997 [trainer.py] => No NME accuracy.
2024-09-07 22:47:46,998 [trainer.py] => CNN: {'total': 55.38, '00-99': 79.3, '100-109': 37.32, '110-119': 43.09, '120-129': 20.66, '130-139': 31.88, '140-149': 33.79, '150-159': 36.46, '160-169': 20.43, '170-179': 37.5, '180-189': 16.23, '190-199': 33.58, 'old': 56.41, 'new': 33.58}
2024-09-07 22:47:46,998 [trainer.py] => CNN top1 curve: [78.16, 75.31, 72.18, 68.46, 65.78, 63.28, 61.34, 59.52, 58.49, 55.86, 55.38]
2024-09-07 22:47:46,998 [trainer.py] => CNN top5 curve: [91.46, 91.07, 89.33, 88.59, 87.14, 86.79, 86.02, 84.61, 84.19, 82.79, 82.57]

Average Accuracy (CNN): 64.89
2024-09-07 22:47:46,998 [trainer.py] => Average Accuracy (CNN): 64.89 

Accuracy Matrix (CNN):
[[78.16 78.59 78.96 78.86 78.79 78.83 79.23 79.06 78.96 79.06 79.3 ]
 [ 0.   40.85 38.73 38.73 37.68 37.32 36.97 38.38 36.27 35.92 37.32]
 [ 0.    0.   43.62 41.76 41.22 41.49 42.29 41.22 42.55 41.22 43.09]
 [ 0.    0.    0.   22.14 22.51 22.51 19.93 21.03 19.93 21.4  20.66]
 [ 0.    0.    0.    0.   32.55 32.21 31.88 31.88 30.87 30.87 31.88]
 [ 0.    0.    0.    0.    0.   34.6  34.06 33.24 35.15 34.06 33.79]
 [ 0.    0.    0.    0.    0.    0.   35.64 36.74 36.19 35.64 36.46]
 [ 0.    0.    0.    0.    0.    0.    0.   20.87 22.61 19.13 20.43]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   37.5  36.69 37.5 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   14.29 16.23]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   33.58]]
2024-09-07 22:47:47,000 [trainer.py] => Forgetting (CNN): 1.0399999999999996
nohup: 忽略输入
2024-09-12 09:00:16,163 [trainer.py] => config: ./exps/dualprompt_inr_B0_Inc5.json
2024-09-12 09:00:16,180 [trainer.py] => prefix:  
2024-09-12 09:00:16,180 [trainer.py] => dataset: imagenetr
2024-09-12 09:00:16,180 [trainer.py] => memory_size: 0
2024-09-12 09:00:16,180 [trainer.py] => memory_per_class: 0
2024-09-12 09:00:16,180 [trainer.py] => fixed_memory: False
2024-09-12 09:00:16,180 [trainer.py] => shuffle: True
2024-09-12 09:00:16,180 [trainer.py] => init_cls: 40
2024-09-12 09:00:16,180 [trainer.py] => increment: 40
2024-09-12 09:00:16,180 [trainer.py] => model_name: dualprompt
2024-09-12 09:00:16,180 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 09:00:16,180 [trainer.py] => get_original_backbone: True
2024-09-12 09:00:16,180 [trainer.py] => device: [device(type='cuda', index=4)]
2024-09-12 09:00:16,180 [trainer.py] => seed: 1993
2024-09-12 09:00:16,181 [trainer.py] => tuned_epoch: 20
2024-09-12 09:00:16,181 [trainer.py] => init_lr: 0.001
2024-09-12 09:00:16,181 [trainer.py] => batch_size: 48
2024-09-12 09:00:16,181 [trainer.py] => weight_decay: 0
2024-09-12 09:00:16,181 [trainer.py] => min_lr: 1e-05
2024-09-12 09:00:16,181 [trainer.py] => optimizer: adam
2024-09-12 09:00:16,181 [trainer.py] => scheduler: constant
2024-09-12 09:00:16,181 [trainer.py] => reinit_optimizer: True
2024-09-12 09:00:16,181 [trainer.py] => global_pool: token
2024-09-12 09:00:16,181 [trainer.py] => head_type: token
2024-09-12 09:00:16,181 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 09:00:16,181 [trainer.py] => pretrained: True
2024-09-12 09:00:16,181 [trainer.py] => drop: 0.0
2024-09-12 09:00:16,181 [trainer.py] => drop_path: 0.0
2024-09-12 09:00:16,181 [trainer.py] => use_g_prompt: True
2024-09-12 09:00:16,181 [trainer.py] => g_prompt_length: 5
2024-09-12 09:00:16,181 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 09:00:16,182 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 09:00:16,182 [trainer.py] => use_e_prompt: True
2024-09-12 09:00:16,182 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 09:00:16,182 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 09:00:16,182 [trainer.py] => prompt_pool: True
2024-09-12 09:00:16,182 [trainer.py] => size: 10
2024-09-12 09:00:16,182 [trainer.py] => length: 5
2024-09-12 09:00:16,182 [trainer.py] => top_k: 1
2024-09-12 09:00:16,182 [trainer.py] => initializer: uniform
2024-09-12 09:00:16,182 [trainer.py] => prompt_key: True
2024-09-12 09:00:16,182 [trainer.py] => prompt_key_init: uniform
2024-09-12 09:00:16,182 [trainer.py] => use_prompt_mask: True
2024-09-12 09:00:16,182 [trainer.py] => shared_prompt_pool: True
2024-09-12 09:00:16,182 [trainer.py] => shared_prompt_key: False
2024-09-12 09:00:16,182 [trainer.py] => batchwise_prompt: True
2024-09-12 09:00:16,182 [trainer.py] => embedding_key: cls
2024-09-12 09:00:16,182 [trainer.py] => predefined_key: 
2024-09-12 09:00:16,182 [trainer.py] => pull_constraint: True
2024-09-12 09:00:16,183 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 09:00:16,183 [trainer.py] => same_key_value: False
2024-09-12 09:00:16,886 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 09:00:20,252 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 09:00:20,252 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 09:00:20,252 [dualprompt.py] => g_prompt: 15360
2024-09-12 09:00:20,252 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 09:00:20,252 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 09:00:20,253 [dualprompt.py] => head.weight: 153600
2024-09-12 09:00:20,253 [dualprompt.py] => head.bias: 200
2024-09-12 09:00:20,254 [trainer.py] => All params: 172158352
2024-09-12 09:00:20,254 [trainer.py] => Trainable params: 407240
2024-09-12 09:00:20,254 [dualprompt.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.833, Train_accy 54.25:   0%|          | 0/20 [00:44<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.833, Train_accy 54.25:   5%|▌         | 1/20 [00:44<14:12, 44.85s/it]
Task 0, Epoch 2/20 => Loss 0.928, Train_accy 75.20:   5%|▌         | 1/20 [01:28<14:12, 44.85s/it]
Task 0, Epoch 2/20 => Loss 0.928, Train_accy 75.20:  10%|█         | 2/20 [01:28<13:16, 44.25s/it]
Task 0, Epoch 3/20 => Loss 0.790, Train_accy 78.27:  10%|█         | 2/20 [02:12<13:16, 44.25s/it]
Task 0, Epoch 3/20 => Loss 0.790, Train_accy 78.27:  15%|█▌        | 3/20 [02:12<12:28, 44.04s/it]
Task 0, Epoch 4/20 => Loss 0.654, Train_accy 81.51:  15%|█▌        | 3/20 [02:56<12:28, 44.04s/it]
Task 0, Epoch 4/20 => Loss 0.654, Train_accy 81.51:  20%|██        | 4/20 [02:56<11:44, 44.01s/it]
Task 0, Epoch 5/20 => Loss 0.587, Train_accy 83.38, Test_accy 79.49:  20%|██        | 4/20 [03:46<11:44, 44.01s/it]
Task 0, Epoch 5/20 => Loss 0.587, Train_accy 83.38, Test_accy 79.49:  25%|██▌       | 5/20 [03:46<11:34, 46.33s/it]
Task 0, Epoch 6/20 => Loss 0.574, Train_accy 83.67:  25%|██▌       | 5/20 [04:30<11:34, 46.33s/it]                 
Task 0, Epoch 6/20 => Loss 0.574, Train_accy 83.67:  30%|███       | 6/20 [04:30<10:36, 45.46s/it]
Task 0, Epoch 7/20 => Loss 0.523, Train_accy 84.89:  30%|███       | 6/20 [05:14<10:36, 45.46s/it]
Task 0, Epoch 7/20 => Loss 0.523, Train_accy 84.89:  35%|███▌      | 7/20 [05:14<09:45, 45.02s/it]
Task 0, Epoch 8/20 => Loss 0.503, Train_accy 85.59:  35%|███▌      | 7/20 [05:58<09:45, 45.02s/it]
Task 0, Epoch 8/20 => Loss 0.503, Train_accy 85.59:  40%|████      | 8/20 [05:58<08:56, 44.71s/it]
Task 0, Epoch 9/20 => Loss 0.459, Train_accy 87.01:  40%|████      | 8/20 [06:42<08:56, 44.71s/it]
Task 0, Epoch 9/20 => Loss 0.459, Train_accy 87.01:  45%|████▌     | 9/20 [06:42<08:07, 44.34s/it]
Task 0, Epoch 10/20 => Loss 0.441, Train_accy 87.44, Test_accy 80.77:  45%|████▌     | 9/20 [07:32<08:07, 44.34s/it]
Task 0, Epoch 10/20 => Loss 0.441, Train_accy 87.44, Test_accy 80.77:  50%|█████     | 10/20 [07:32<07:40, 46.06s/it]
Task 0, Epoch 11/20 => Loss 0.447, Train_accy 87.25:  50%|█████     | 10/20 [08:16<07:40, 46.06s/it]                 
Task 0, Epoch 11/20 => Loss 0.447, Train_accy 87.25:  55%|█████▌    | 11/20 [08:16<06:48, 45.42s/it]
Task 0, Epoch 12/20 => Loss 0.414, Train_accy 87.76:  55%|█████▌    | 11/20 [09:00<06:48, 45.42s/it]
Task 0, Epoch 12/20 => Loss 0.414, Train_accy 87.76:  60%|██████    | 12/20 [09:00<05:59, 44.95s/it]
Task 0, Epoch 13/20 => Loss 0.395, Train_accy 88.05:  60%|██████    | 12/20 [09:43<05:59, 44.95s/it]
Task 0, Epoch 13/20 => Loss 0.395, Train_accy 88.05:  65%|██████▌   | 13/20 [09:43<05:12, 44.59s/it]
Task 0, Epoch 14/20 => Loss 0.387, Train_accy 88.58:  65%|██████▌   | 13/20 [10:26<05:12, 44.59s/it]
Task 0, Epoch 14/20 => Loss 0.387, Train_accy 88.58:  70%|███████   | 14/20 [10:26<04:23, 43.93s/it]
Task 0, Epoch 15/20 => Loss 0.405, Train_accy 88.37, Test_accy 79.79:  70%|███████   | 14/20 [11:17<04:23, 43.93s/it]
Task 0, Epoch 15/20 => Loss 0.405, Train_accy 88.37, Test_accy 79.79:  75%|███████▌  | 15/20 [11:17<03:51, 46.22s/it]
Task 0, Epoch 16/20 => Loss 0.341, Train_accy 89.60:  75%|███████▌  | 15/20 [12:01<03:51, 46.22s/it]                 
Task 0, Epoch 16/20 => Loss 0.341, Train_accy 89.60:  80%|████████  | 16/20 [12:01<03:02, 45.60s/it]
Task 0, Epoch 17/20 => Loss 0.375, Train_accy 88.50:  80%|████████  | 16/20 [12:46<03:02, 45.60s/it]
Task 0, Epoch 17/20 => Loss 0.375, Train_accy 88.50:  85%|████████▌ | 17/20 [12:46<02:15, 45.15s/it]
Task 0, Epoch 18/20 => Loss 0.368, Train_accy 89.51:  85%|████████▌ | 17/20 [13:29<02:15, 45.15s/it]
Task 0, Epoch 18/20 => Loss 0.368, Train_accy 89.51:  90%|█████████ | 18/20 [13:29<01:29, 44.67s/it]
Task 0, Epoch 19/20 => Loss 0.357, Train_accy 89.00:  90%|█████████ | 18/20 [14:12<01:29, 44.67s/it]
Task 0, Epoch 19/20 => Loss 0.357, Train_accy 89.00:  95%|█████████▌| 19/20 [14:12<00:44, 44.04s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 90.07, Test_accy 80.09:  95%|█████████▌| 19/20 [15:04<00:44, 44.04s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 90.07, Test_accy 80.09: 100%|██████████| 20/20 [15:04<00:00, 46.40s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 90.07, Test_accy 80.09: 100%|██████████| 20/20 [15:04<00:00, 45.20s/it]
2024-09-12 09:15:24,836 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.333, Train_accy 90.07, Test_accy 80.09
2024-09-12 09:15:32,455 [trainer.py] => No NME accuracy.
2024-09-12 09:15:32,456 [trainer.py] => CNN: {'total': 80.09, '00-39': 80.09, 'old': 0, 'new': 80.09}
2024-09-12 09:15:32,456 [trainer.py] => CNN top1 curve: [80.09]
2024-09-12 09:15:32,456 [trainer.py] => CNN top5 curve: [93.11]

Average Accuracy (CNN): 80.09
2024-09-12 09:15:32,456 [trainer.py] => Average Accuracy (CNN): 80.09 

2024-09-12 09:15:32,458 [trainer.py] => All params: 172158352
2024-09-12 09:15:32,460 [trainer.py] => Trainable params: 407240
2024-09-12 09:15:32,460 [dualprompt.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.008, Train_accy 50.19:   0%|          | 0/20 [00:39<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.008, Train_accy 50.19:   5%|▌         | 1/20 [00:39<12:34, 39.73s/it]
Task 1, Epoch 2/20 => Loss 0.995, Train_accy 73.58:   5%|▌         | 1/20 [01:17<12:34, 39.73s/it]
Task 1, Epoch 2/20 => Loss 0.995, Train_accy 73.58:  10%|█         | 2/20 [01:17<11:39, 38.86s/it]
Task 1, Epoch 3/20 => Loss 0.777, Train_accy 78.84:  10%|█         | 2/20 [01:55<11:39, 38.86s/it]
Task 1, Epoch 3/20 => Loss 0.777, Train_accy 78.84:  15%|█▌        | 3/20 [01:55<10:49, 38.19s/it]
Task 1, Epoch 4/20 => Loss 0.655, Train_accy 81.56:  15%|█▌        | 3/20 [02:32<10:49, 38.19s/it]
Task 1, Epoch 4/20 => Loss 0.655, Train_accy 81.56:  20%|██        | 4/20 [02:32<10:05, 37.82s/it]
Task 1, Epoch 5/20 => Loss 0.593, Train_accy 83.35, Test_accy 70.30:  20%|██        | 4/20 [03:24<10:05, 37.82s/it]
Task 1, Epoch 5/20 => Loss 0.593, Train_accy 83.35, Test_accy 70.30:  25%|██▌       | 5/20 [03:24<10:45, 43.01s/it]
Task 1, Epoch 6/20 => Loss 0.548, Train_accy 84.40:  25%|██▌       | 5/20 [04:03<10:45, 43.01s/it]                 
Task 1, Epoch 6/20 => Loss 0.548, Train_accy 84.40:  30%|███       | 6/20 [04:03<09:39, 41.42s/it]
Task 1, Epoch 7/20 => Loss 0.510, Train_accy 84.94:  30%|███       | 6/20 [04:41<09:39, 41.42s/it]
Task 1, Epoch 7/20 => Loss 0.510, Train_accy 84.94:  35%|███▌      | 7/20 [04:41<08:46, 40.49s/it]
Task 1, Epoch 8/20 => Loss 0.490, Train_accy 85.81:  35%|███▌      | 7/20 [05:19<08:46, 40.49s/it]
Task 1, Epoch 8/20 => Loss 0.490, Train_accy 85.81:  40%|████      | 8/20 [05:19<07:54, 39.57s/it]
Task 1, Epoch 9/20 => Loss 0.452, Train_accy 86.50:  40%|████      | 8/20 [05:56<07:54, 39.57s/it]
Task 1, Epoch 9/20 => Loss 0.452, Train_accy 86.50:  45%|████▌     | 9/20 [05:56<07:07, 38.91s/it]
Task 1, Epoch 10/20 => Loss 0.416, Train_accy 88.05, Test_accy 72.42:  45%|████▌     | 9/20 [06:49<07:07, 38.91s/it]
Task 1, Epoch 10/20 => Loss 0.416, Train_accy 88.05, Test_accy 72.42:  50%|█████     | 10/20 [06:49<07:10, 43.10s/it]
Task 1, Epoch 11/20 => Loss 0.422, Train_accy 87.94:  50%|█████     | 10/20 [07:27<07:10, 43.10s/it]                 
Task 1, Epoch 11/20 => Loss 0.422, Train_accy 87.94:  55%|█████▌    | 11/20 [07:27<06:14, 41.62s/it]
Task 1, Epoch 12/20 => Loss 0.420, Train_accy 87.81:  55%|█████▌    | 11/20 [08:05<06:14, 41.62s/it]
Task 1, Epoch 12/20 => Loss 0.420, Train_accy 87.81:  60%|██████    | 12/20 [08:05<05:25, 40.63s/it]
Task 1, Epoch 13/20 => Loss 0.401, Train_accy 88.37:  60%|██████    | 12/20 [08:43<05:25, 40.63s/it]
Task 1, Epoch 13/20 => Loss 0.401, Train_accy 88.37:  65%|██████▌   | 13/20 [08:43<04:37, 39.65s/it]
Task 1, Epoch 14/20 => Loss 0.355, Train_accy 89.54:  65%|██████▌   | 13/20 [09:20<04:37, 39.65s/it]
Task 1, Epoch 14/20 => Loss 0.355, Train_accy 89.54:  70%|███████   | 14/20 [09:20<03:53, 38.96s/it]
Task 1, Epoch 15/20 => Loss 0.377, Train_accy 88.87, Test_accy 73.62:  70%|███████   | 14/20 [10:12<03:53, 38.96s/it]
Task 1, Epoch 15/20 => Loss 0.377, Train_accy 88.87, Test_accy 73.62:  75%|███████▌  | 15/20 [10:12<03:34, 42.97s/it]
Task 1, Epoch 16/20 => Loss 0.355, Train_accy 89.60:  75%|███████▌  | 15/20 [10:51<03:34, 42.97s/it]                 
Task 1, Epoch 16/20 => Loss 0.355, Train_accy 89.60:  80%|████████  | 16/20 [10:51<02:46, 41.54s/it]
Task 1, Epoch 17/20 => Loss 0.347, Train_accy 89.56:  80%|████████  | 16/20 [11:29<02:46, 41.54s/it]
Task 1, Epoch 17/20 => Loss 0.347, Train_accy 89.56:  85%|████████▌ | 17/20 [11:29<02:01, 40.57s/it]
Task 1, Epoch 18/20 => Loss 0.342, Train_accy 89.60:  85%|████████▌ | 17/20 [12:06<02:01, 40.57s/it]
Task 1, Epoch 18/20 => Loss 0.342, Train_accy 89.60:  90%|█████████ | 18/20 [12:06<01:19, 39.61s/it]
Task 1, Epoch 19/20 => Loss 0.356, Train_accy 89.09:  90%|█████████ | 18/20 [12:43<01:19, 39.61s/it]
Task 1, Epoch 19/20 => Loss 0.356, Train_accy 89.09:  95%|█████████▌| 19/20 [12:43<00:38, 38.84s/it]
Task 1, Epoch 20/20 => Loss 0.332, Train_accy 90.10, Test_accy 75.02:  95%|█████████▌| 19/20 [13:36<00:38, 38.84s/it]
Task 1, Epoch 20/20 => Loss 0.332, Train_accy 90.10, Test_accy 75.02: 100%|██████████| 20/20 [13:36<00:00, 42.84s/it]
Task 1, Epoch 20/20 => Loss 0.332, Train_accy 90.10, Test_accy 75.02: 100%|██████████| 20/20 [13:36<00:00, 40.80s/it]
2024-09-12 09:29:08,531 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.332, Train_accy 90.10, Test_accy 75.02
2024-09-12 09:29:22,453 [trainer.py] => No NME accuracy.
2024-09-12 09:29:22,454 [trainer.py] => CNN: {'total': 75.02, '00-39': 79.33, '40-79': 70.18, 'old': 79.33, 'new': 70.18}
2024-09-12 09:29:22,454 [trainer.py] => CNN top1 curve: [80.09, 75.02]
2024-09-12 09:29:22,454 [trainer.py] => CNN top5 curve: [93.11, 88.99]

Average Accuracy (CNN): 77.56
2024-09-12 09:29:22,454 [trainer.py] => Average Accuracy (CNN): 77.56 

2024-09-12 09:29:22,457 [trainer.py] => All params: 172158352
2024-09-12 09:29:22,459 [trainer.py] => Trainable params: 407240
2024-09-12 09:29:22,459 [dualprompt.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.799, Train_accy 55.35:   0%|          | 0/20 [00:41<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.799, Train_accy 55.35:   5%|▌         | 1/20 [00:41<13:00, 41.08s/it]
Task 2, Epoch 2/20 => Loss 0.869, Train_accy 75.72:   5%|▌         | 1/20 [01:20<13:00, 41.08s/it]
Task 2, Epoch 2/20 => Loss 0.869, Train_accy 75.72:  10%|█         | 2/20 [01:20<12:04, 40.23s/it]
Task 2, Epoch 3/20 => Loss 0.703, Train_accy 80.68:  10%|█         | 2/20 [01:58<12:04, 40.23s/it]
Task 2, Epoch 3/20 => Loss 0.703, Train_accy 80.68:  15%|█▌        | 3/20 [01:58<11:05, 39.13s/it]
Task 2, Epoch 4/20 => Loss 0.639, Train_accy 82.09:  15%|█▌        | 3/20 [02:38<11:05, 39.13s/it]
Task 2, Epoch 4/20 => Loss 0.639, Train_accy 82.09:  20%|██        | 4/20 [02:38<10:29, 39.31s/it]
Task 2, Epoch 5/20 => Loss 0.535, Train_accy 85.02, Test_accy 68.23:  20%|██        | 4/20 [03:38<10:29, 39.31s/it]
Task 2, Epoch 5/20 => Loss 0.535, Train_accy 85.02, Test_accy 68.23:  25%|██▌       | 5/20 [03:38<11:40, 46.73s/it]
Task 2, Epoch 6/20 => Loss 0.484, Train_accy 85.79:  25%|██▌       | 5/20 [04:17<11:40, 46.73s/it]                 
Task 2, Epoch 6/20 => Loss 0.484, Train_accy 85.79:  30%|███       | 6/20 [04:17<10:21, 44.36s/it]
Task 2, Epoch 7/20 => Loss 0.456, Train_accy 86.76:  30%|███       | 6/20 [04:57<10:21, 44.36s/it]
Task 2, Epoch 7/20 => Loss 0.456, Train_accy 86.76:  35%|███▌      | 7/20 [04:57<09:15, 42.72s/it]
Task 2, Epoch 8/20 => Loss 0.410, Train_accy 87.87:  35%|███▌      | 7/20 [05:35<09:15, 42.72s/it]
Task 2, Epoch 8/20 => Loss 0.410, Train_accy 87.87:  40%|████      | 8/20 [05:35<08:14, 41.25s/it]
Task 2, Epoch 9/20 => Loss 0.393, Train_accy 88.12:  40%|████      | 8/20 [06:14<08:14, 41.25s/it]
Task 2, Epoch 9/20 => Loss 0.393, Train_accy 88.12:  45%|████▌     | 9/20 [06:14<07:28, 40.76s/it]
Task 2, Epoch 10/20 => Loss 0.380, Train_accy 88.49, Test_accy 69.96:  45%|████▌     | 9/20 [07:15<07:28, 40.76s/it]
Task 2, Epoch 10/20 => Loss 0.380, Train_accy 88.49, Test_accy 69.96:  50%|█████     | 10/20 [07:15<07:47, 46.74s/it]
Task 2, Epoch 11/20 => Loss 0.392, Train_accy 88.72:  50%|█████     | 10/20 [07:54<07:47, 46.74s/it]                 
Task 2, Epoch 11/20 => Loss 0.392, Train_accy 88.72:  55%|█████▌    | 11/20 [07:54<06:41, 44.60s/it]
Task 2, Epoch 12/20 => Loss 0.362, Train_accy 88.57:  55%|█████▌    | 11/20 [08:33<06:41, 44.60s/it]
Task 2, Epoch 12/20 => Loss 0.362, Train_accy 88.57:  60%|██████    | 12/20 [08:33<05:42, 42.83s/it]
Task 2, Epoch 13/20 => Loss 0.358, Train_accy 89.32:  60%|██████    | 12/20 [09:12<05:42, 42.83s/it]
Task 2, Epoch 13/20 => Loss 0.358, Train_accy 89.32:  65%|██████▌   | 13/20 [09:12<04:50, 41.55s/it]
Task 2, Epoch 14/20 => Loss 0.359, Train_accy 89.15:  65%|██████▌   | 13/20 [09:51<04:50, 41.55s/it]
Task 2, Epoch 14/20 => Loss 0.359, Train_accy 89.15:  70%|███████   | 14/20 [09:51<04:06, 41.02s/it]
Task 2, Epoch 15/20 => Loss 0.329, Train_accy 89.83, Test_accy 71.33:  70%|███████   | 14/20 [10:51<04:06, 41.02s/it]
Task 2, Epoch 15/20 => Loss 0.329, Train_accy 89.83, Test_accy 71.33:  75%|███████▌  | 15/20 [10:51<03:53, 46.68s/it]
Task 2, Epoch 16/20 => Loss 0.320, Train_accy 89.79:  75%|███████▌  | 15/20 [11:31<03:53, 46.68s/it]                 
Task 2, Epoch 16/20 => Loss 0.320, Train_accy 89.79:  80%|████████  | 16/20 [11:31<02:58, 44.51s/it]
Task 2, Epoch 17/20 => Loss 0.324, Train_accy 89.55:  80%|████████  | 16/20 [12:09<02:58, 44.51s/it]
Task 2, Epoch 17/20 => Loss 0.324, Train_accy 89.55:  85%|████████▌ | 17/20 [12:09<02:07, 42.55s/it]
Task 2, Epoch 18/20 => Loss 0.323, Train_accy 90.27:  85%|████████▌ | 17/20 [12:48<02:07, 42.55s/it]
Task 2, Epoch 18/20 => Loss 0.323, Train_accy 90.27:  90%|█████████ | 18/20 [12:48<01:23, 41.54s/it]
Task 2, Epoch 19/20 => Loss 0.312, Train_accy 90.68:  90%|█████████ | 18/20 [13:28<01:23, 41.54s/it]
Task 2, Epoch 19/20 => Loss 0.312, Train_accy 90.68:  95%|█████████▌| 19/20 [13:28<00:41, 41.06s/it]
Task 2, Epoch 20/20 => Loss 0.307, Train_accy 90.87, Test_accy 72.21:  95%|█████████▌| 19/20 [14:28<00:41, 41.06s/it]
Task 2, Epoch 20/20 => Loss 0.307, Train_accy 90.87, Test_accy 72.21: 100%|██████████| 20/20 [14:28<00:00, 46.75s/it]
Task 2, Epoch 20/20 => Loss 0.307, Train_accy 90.87, Test_accy 72.21: 100%|██████████| 20/20 [14:28<00:00, 43.42s/it]
2024-09-12 09:43:50,828 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.307, Train_accy 90.87, Test_accy 72.21
2024-09-12 09:44:11,076 [trainer.py] => No NME accuracy.
2024-09-12 09:44:11,077 [trainer.py] => CNN: {'total': 72.21, '00-39': 78.2, '40-79': 68.14, '80-119': 69.49, 'old': 73.46, 'new': 69.49}
2024-09-12 09:44:11,077 [trainer.py] => CNN top1 curve: [80.09, 75.02, 72.21]
2024-09-12 09:44:11,077 [trainer.py] => CNN top5 curve: [93.11, 88.99, 87.33]

Average Accuracy (CNN): 75.77
2024-09-12 09:44:11,077 [trainer.py] => Average Accuracy (CNN): 75.77 

2024-09-12 09:44:11,080 [trainer.py] => All params: 172158352
2024-09-12 09:44:11,081 [trainer.py] => Trainable params: 407240
2024-09-12 09:44:11,082 [dualprompt.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.634, Train_accy 60.28:   0%|          | 0/20 [00:40<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.634, Train_accy 60.28:   5%|▌         | 1/20 [00:40<12:44, 40.23s/it]
Task 3, Epoch 2/20 => Loss 0.776, Train_accy 78.87:   5%|▌         | 1/20 [01:20<12:44, 40.23s/it]
Task 3, Epoch 2/20 => Loss 0.776, Train_accy 78.87:  10%|█         | 2/20 [01:20<12:01, 40.06s/it]
Task 3, Epoch 3/20 => Loss 0.612, Train_accy 82.71:  10%|█         | 2/20 [02:00<12:01, 40.06s/it]
Task 3, Epoch 3/20 => Loss 0.612, Train_accy 82.71:  15%|█▌        | 3/20 [02:00<11:24, 40.29s/it]
Task 3, Epoch 4/20 => Loss 0.523, Train_accy 85.30:  15%|█▌        | 3/20 [02:41<11:24, 40.29s/it]
Task 3, Epoch 4/20 => Loss 0.523, Train_accy 85.30:  20%|██        | 4/20 [02:41<10:47, 40.45s/it]
Task 3, Epoch 5/20 => Loss 0.474, Train_accy 86.96, Test_accy 66.46:  20%|██        | 4/20 [03:49<10:47, 40.45s/it]
Task 3, Epoch 5/20 => Loss 0.474, Train_accy 86.96, Test_accy 66.46:  25%|██▌       | 5/20 [03:49<12:34, 50.28s/it]
Task 3, Epoch 6/20 => Loss 0.427, Train_accy 87.81:  25%|██▌       | 5/20 [04:28<12:34, 50.28s/it]                 
Task 3, Epoch 6/20 => Loss 0.427, Train_accy 87.81:  30%|███       | 6/20 [04:28<10:50, 46.50s/it]
Task 3, Epoch 7/20 => Loss 0.405, Train_accy 88.36:  30%|███       | 6/20 [05:09<10:50, 46.50s/it]
Task 3, Epoch 7/20 => Loss 0.405, Train_accy 88.36:  35%|███▌      | 7/20 [05:09<09:40, 44.63s/it]
Task 3, Epoch 8/20 => Loss 0.370, Train_accy 89.19:  35%|███▌      | 7/20 [05:49<09:40, 44.63s/it]
Task 3, Epoch 8/20 => Loss 0.370, Train_accy 89.19:  40%|████      | 8/20 [05:49<08:40, 43.35s/it]
Task 3, Epoch 9/20 => Loss 0.374, Train_accy 88.70:  40%|████      | 8/20 [06:30<08:40, 43.35s/it]
Task 3, Epoch 9/20 => Loss 0.374, Train_accy 88.70:  45%|████▌     | 9/20 [06:30<07:47, 42.53s/it]
Task 3, Epoch 10/20 => Loss 0.351, Train_accy 89.41, Test_accy 68.97:  45%|████▌     | 9/20 [07:37<07:47, 42.53s/it]
Task 3, Epoch 10/20 => Loss 0.351, Train_accy 89.41, Test_accy 68.97:  50%|█████     | 10/20 [07:37<08:19, 49.97s/it]
Task 3, Epoch 11/20 => Loss 0.316, Train_accy 90.53:  50%|█████     | 10/20 [08:17<08:19, 49.97s/it]                 
Task 3, Epoch 11/20 => Loss 0.316, Train_accy 90.53:  55%|█████▌    | 11/20 [08:17<07:03, 47.08s/it]
Task 3, Epoch 12/20 => Loss 0.338, Train_accy 89.66:  55%|█████▌    | 11/20 [08:58<07:03, 47.08s/it]
Task 3, Epoch 12/20 => Loss 0.338, Train_accy 89.66:  60%|██████    | 12/20 [08:58<06:01, 45.24s/it]
Task 3, Epoch 13/20 => Loss 0.309, Train_accy 91.07:  60%|██████    | 12/20 [09:39<06:01, 45.24s/it]
Task 3, Epoch 13/20 => Loss 0.309, Train_accy 91.07:  65%|██████▌   | 13/20 [09:39<05:07, 43.89s/it]
Task 3, Epoch 14/20 => Loss 0.330, Train_accy 90.18:  65%|██████▌   | 13/20 [10:20<05:07, 43.89s/it]
Task 3, Epoch 14/20 => Loss 0.330, Train_accy 90.18:  70%|███████   | 14/20 [10:20<04:18, 43.04s/it]
Task 3, Epoch 15/20 => Loss 0.294, Train_accy 91.17, Test_accy 70.28:  70%|███████   | 14/20 [11:26<04:18, 43.04s/it]
Task 3, Epoch 15/20 => Loss 0.294, Train_accy 91.17, Test_accy 70.28:  75%|███████▌  | 15/20 [11:26<04:09, 49.91s/it]
Task 3, Epoch 16/20 => Loss 0.298, Train_accy 90.83:  75%|███████▌  | 15/20 [12:06<04:09, 49.91s/it]                 
Task 3, Epoch 16/20 => Loss 0.298, Train_accy 90.83:  80%|████████  | 16/20 [12:06<03:08, 47.09s/it]
Task 3, Epoch 17/20 => Loss 0.294, Train_accy 91.05:  80%|████████  | 16/20 [12:47<03:08, 47.09s/it]
Task 3, Epoch 17/20 => Loss 0.294, Train_accy 91.05:  85%|████████▌ | 17/20 [12:47<02:15, 45.09s/it]
Task 3, Epoch 18/20 => Loss 0.282, Train_accy 91.05:  85%|████████▌ | 17/20 [13:27<02:15, 45.09s/it]
Task 3, Epoch 18/20 => Loss 0.282, Train_accy 91.05:  90%|█████████ | 18/20 [13:27<01:27, 43.65s/it]
Task 3, Epoch 19/20 => Loss 0.290, Train_accy 91.11:  90%|█████████ | 18/20 [14:07<01:27, 43.65s/it]
Task 3, Epoch 19/20 => Loss 0.290, Train_accy 91.11:  95%|█████████▌| 19/20 [14:07<00:42, 42.41s/it]
Task 3, Epoch 20/20 => Loss 0.305, Train_accy 90.81, Test_accy 71.03:  95%|█████████▌| 19/20 [15:12<00:42, 42.41s/it]
Task 3, Epoch 20/20 => Loss 0.305, Train_accy 90.81, Test_accy 71.03: 100%|██████████| 20/20 [15:12<00:00, 49.42s/it]
Task 3, Epoch 20/20 => Loss 0.305, Train_accy 90.81, Test_accy 71.03: 100%|██████████| 20/20 [15:12<00:00, 45.64s/it]
2024-09-12 09:59:23,952 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.305, Train_accy 90.81, Test_accy 71.03
2024-09-12 09:59:50,889 [trainer.py] => No NME accuracy.
2024-09-12 09:59:50,889 [trainer.py] => CNN: {'total': 71.03, '00-39': 77.14, '40-79': 67.46, '80-119': 68.44, '120-159': 70.34, 'old': 71.28, 'new': 70.34}
2024-09-12 09:59:50,890 [trainer.py] => CNN top1 curve: [80.09, 75.02, 72.21, 71.03]
2024-09-12 09:59:50,890 [trainer.py] => CNN top5 curve: [93.11, 88.99, 87.33, 86.93]

Average Accuracy (CNN): 74.59
2024-09-12 09:59:50,890 [trainer.py] => Average Accuracy (CNN): 74.59 

2024-09-12 09:59:50,892 [trainer.py] => All params: 172158352
2024-09-12 09:59:50,894 [trainer.py] => Trainable params: 407240
2024-09-12 09:59:50,894 [dualprompt.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.744, Train_accy 57.28:   0%|          | 0/20 [00:35<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.744, Train_accy 57.28:   5%|▌         | 1/20 [00:35<11:13, 35.47s/it]
Task 4, Epoch 2/20 => Loss 0.840, Train_accy 77.05:   5%|▌         | 1/20 [01:09<11:13, 35.47s/it]
Task 4, Epoch 2/20 => Loss 0.840, Train_accy 77.05:  10%|█         | 2/20 [01:09<10:25, 34.74s/it]
Task 4, Epoch 3/20 => Loss 0.645, Train_accy 82.41:  10%|█         | 2/20 [01:43<10:25, 34.74s/it]
Task 4, Epoch 3/20 => Loss 0.645, Train_accy 82.41:  15%|█▌        | 3/20 [01:43<09:46, 34.49s/it]
Task 4, Epoch 4/20 => Loss 0.532, Train_accy 85.42:  15%|█▌        | 3/20 [02:16<09:46, 34.49s/it]
Task 4, Epoch 4/20 => Loss 0.532, Train_accy 85.42:  20%|██        | 4/20 [02:16<08:58, 33.63s/it]
Task 4, Epoch 5/20 => Loss 0.493, Train_accy 86.53, Test_accy 66.42:  20%|██        | 4/20 [03:23<08:58, 33.63s/it]
Task 4, Epoch 5/20 => Loss 0.493, Train_accy 86.53, Test_accy 66.42:  25%|██▌       | 5/20 [03:23<11:29, 45.94s/it]
Task 4, Epoch 6/20 => Loss 0.439, Train_accy 87.10:  25%|██▌       | 5/20 [03:58<11:29, 45.94s/it]                 
Task 4, Epoch 6/20 => Loss 0.439, Train_accy 87.10:  30%|███       | 6/20 [03:58<09:50, 42.15s/it]
Task 4, Epoch 7/20 => Loss 0.440, Train_accy 87.91:  30%|███       | 6/20 [04:33<09:50, 42.15s/it]
Task 4, Epoch 7/20 => Loss 0.440, Train_accy 87.91:  35%|███▌      | 7/20 [04:33<08:37, 39.79s/it]
Task 4, Epoch 8/20 => Loss 0.411, Train_accy 88.36:  35%|███▌      | 7/20 [05:08<08:37, 39.79s/it]
Task 4, Epoch 8/20 => Loss 0.411, Train_accy 88.36:  40%|████      | 8/20 [05:08<07:39, 38.26s/it]
Task 4, Epoch 9/20 => Loss 0.408, Train_accy 88.15:  40%|████      | 8/20 [05:41<07:39, 38.26s/it]
Task 4, Epoch 9/20 => Loss 0.408, Train_accy 88.15:  45%|████▌     | 9/20 [05:41<06:42, 36.63s/it]
Task 4, Epoch 10/20 => Loss 0.374, Train_accy 89.19, Test_accy 67.63:  45%|████▌     | 9/20 [06:49<06:42, 36.63s/it]
Task 4, Epoch 10/20 => Loss 0.374, Train_accy 89.19, Test_accy 67.63:  50%|█████     | 10/20 [06:49<07:42, 46.25s/it]
Task 4, Epoch 11/20 => Loss 0.332, Train_accy 89.97:  50%|█████     | 10/20 [07:24<07:42, 46.25s/it]                 
Task 4, Epoch 11/20 => Loss 0.332, Train_accy 89.97:  55%|█████▌    | 11/20 [07:24<06:24, 42.70s/it]
Task 4, Epoch 12/20 => Loss 0.360, Train_accy 89.40:  55%|█████▌    | 11/20 [07:58<06:24, 42.70s/it]
Task 4, Epoch 12/20 => Loss 0.360, Train_accy 89.40:  60%|██████    | 12/20 [07:58<05:22, 40.29s/it]
Task 4, Epoch 13/20 => Loss 0.320, Train_accy 90.49:  60%|██████    | 12/20 [08:33<05:22, 40.29s/it]
Task 4, Epoch 13/20 => Loss 0.320, Train_accy 90.49:  65%|██████▌   | 13/20 [08:33<04:29, 38.56s/it]
Task 4, Epoch 14/20 => Loss 0.317, Train_accy 89.81:  65%|██████▌   | 13/20 [09:06<04:29, 38.56s/it]
Task 4, Epoch 14/20 => Loss 0.317, Train_accy 89.81:  70%|███████   | 14/20 [09:06<03:40, 36.75s/it]
Task 4, Epoch 15/20 => Loss 0.303, Train_accy 90.68, Test_accy 68.03:  70%|███████   | 14/20 [10:13<03:40, 36.75s/it]
Task 4, Epoch 15/20 => Loss 0.303, Train_accy 90.68, Test_accy 68.03:  75%|███████▌  | 15/20 [10:13<03:50, 46.04s/it]
Task 4, Epoch 16/20 => Loss 0.320, Train_accy 90.21:  75%|███████▌  | 15/20 [10:48<03:50, 46.04s/it]                 
Task 4, Epoch 16/20 => Loss 0.320, Train_accy 90.21:  80%|████████  | 16/20 [10:48<02:50, 42.73s/it]
Task 4, Epoch 17/20 => Loss 0.312, Train_accy 90.78:  80%|████████  | 16/20 [11:23<02:50, 42.73s/it]
Task 4, Epoch 17/20 => Loss 0.312, Train_accy 90.78:  85%|████████▌ | 17/20 [11:23<02:01, 40.37s/it]
Task 4, Epoch 18/20 => Loss 0.324, Train_accy 90.00:  85%|████████▌ | 17/20 [11:58<02:01, 40.37s/it]
Task 4, Epoch 18/20 => Loss 0.324, Train_accy 90.00:  90%|█████████ | 18/20 [11:58<01:17, 38.59s/it]
Task 4, Epoch 19/20 => Loss 0.305, Train_accy 90.73:  90%|█████████ | 18/20 [12:31<01:17, 38.59s/it]
Task 4, Epoch 19/20 => Loss 0.305, Train_accy 90.73:  95%|█████████▌| 19/20 [12:31<00:36, 36.94s/it]
Task 4, Epoch 20/20 => Loss 0.306, Train_accy 90.80, Test_accy 69.22:  95%|█████████▌| 19/20 [13:39<00:36, 36.94s/it]
Task 4, Epoch 20/20 => Loss 0.306, Train_accy 90.80, Test_accy 69.22: 100%|██████████| 20/20 [13:39<00:00, 46.31s/it]
Task 4, Epoch 20/20 => Loss 0.306, Train_accy 90.80, Test_accy 69.22: 100%|██████████| 20/20 [13:39<00:00, 40.96s/it]
2024-09-12 10:13:30,169 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.306, Train_accy 90.80, Test_accy 69.22
2024-09-12 10:14:03,374 [trainer.py] => No NME accuracy.
2024-09-12 10:14:03,374 [trainer.py] => CNN: {'total': 69.22, '00-39': 76.61, '40-79': 68.05, '80-119': 67.22, '120-159': 69.57, '160-199': 63.01, 'old': 70.54, 'new': 63.01}
2024-09-12 10:14:03,374 [trainer.py] => CNN top1 curve: [80.09, 75.02, 72.21, 71.03, 69.22]
2024-09-12 10:14:03,374 [trainer.py] => CNN top5 curve: [93.11, 88.99, 87.33, 86.93, 85.45]

Average Accuracy (CNN): 73.51
2024-09-12 10:14:03,374 [trainer.py] => Average Accuracy (CNN): 73.51 

Accuracy Matrix (CNN):
[[80.09 79.33 78.2  77.14 76.61]
 [ 0.   70.18 68.14 67.46 68.05]
 [ 0.    0.   69.49 68.44 67.22]
 [ 0.    0.    0.   70.34 69.57]
 [ 0.    0.    0.    0.   63.01]]
2024-09-12 10:14:03,376 [trainer.py] => Forgetting (CNN): 2.162500000000005
2024-09-12 10:14:06,520 [trainer.py] => config: ./exps/dualprompt_inr_B0_Inc10.json
2024-09-12 10:14:06,520 [trainer.py] => prefix:  
2024-09-12 10:14:06,520 [trainer.py] => dataset: imagenetr
2024-09-12 10:14:06,520 [trainer.py] => memory_size: 0
2024-09-12 10:14:06,520 [trainer.py] => memory_per_class: 0
2024-09-12 10:14:06,520 [trainer.py] => fixed_memory: False
2024-09-12 10:14:06,520 [trainer.py] => shuffle: True
2024-09-12 10:14:06,520 [trainer.py] => init_cls: 20
2024-09-12 10:14:06,520 [trainer.py] => increment: 20
2024-09-12 10:14:06,520 [trainer.py] => model_name: dualprompt
2024-09-12 10:14:06,520 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 10:14:06,520 [trainer.py] => get_original_backbone: True
2024-09-12 10:14:06,520 [trainer.py] => device: [device(type='cuda', index=4)]
2024-09-12 10:14:06,520 [trainer.py] => seed: 1993
2024-09-12 10:14:06,520 [trainer.py] => tuned_epoch: 20
2024-09-12 10:14:06,520 [trainer.py] => init_lr: 0.001
2024-09-12 10:14:06,520 [trainer.py] => batch_size: 48
2024-09-12 10:14:06,520 [trainer.py] => weight_decay: 0
2024-09-12 10:14:06,520 [trainer.py] => min_lr: 1e-05
2024-09-12 10:14:06,520 [trainer.py] => optimizer: adam
2024-09-12 10:14:06,520 [trainer.py] => scheduler: constant
2024-09-12 10:14:06,520 [trainer.py] => reinit_optimizer: True
2024-09-12 10:14:06,520 [trainer.py] => global_pool: token
2024-09-12 10:14:06,520 [trainer.py] => head_type: token
2024-09-12 10:14:06,520 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 10:14:06,520 [trainer.py] => pretrained: True
2024-09-12 10:14:06,520 [trainer.py] => drop: 0.0
2024-09-12 10:14:06,520 [trainer.py] => drop_path: 0.0
2024-09-12 10:14:06,520 [trainer.py] => use_g_prompt: True
2024-09-12 10:14:06,520 [trainer.py] => g_prompt_length: 5
2024-09-12 10:14:06,521 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 10:14:06,521 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 10:14:06,521 [trainer.py] => use_e_prompt: True
2024-09-12 10:14:06,521 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 10:14:06,521 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 10:14:06,521 [trainer.py] => prompt_pool: True
2024-09-12 10:14:06,521 [trainer.py] => size: 10
2024-09-12 10:14:06,521 [trainer.py] => length: 5
2024-09-12 10:14:06,521 [trainer.py] => top_k: 1
2024-09-12 10:14:06,521 [trainer.py] => initializer: uniform
2024-09-12 10:14:06,521 [trainer.py] => prompt_key: True
2024-09-12 10:14:06,521 [trainer.py] => prompt_key_init: uniform
2024-09-12 10:14:06,521 [trainer.py] => use_prompt_mask: True
2024-09-12 10:14:06,521 [trainer.py] => shared_prompt_pool: True
2024-09-12 10:14:06,521 [trainer.py] => shared_prompt_key: False
2024-09-12 10:14:06,521 [trainer.py] => batchwise_prompt: True
2024-09-12 10:14:06,521 [trainer.py] => embedding_key: cls
2024-09-12 10:14:06,521 [trainer.py] => predefined_key: 
2024-09-12 10:14:06,521 [trainer.py] => pull_constraint: True
2024-09-12 10:14:06,521 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 10:14:06,521 [trainer.py] => same_key_value: False
2024-09-12 10:14:06,603 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 10:14:09,918 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 10:14:09,919 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 10:14:09,919 [dualprompt.py] => g_prompt: 15360
2024-09-12 10:14:09,919 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 10:14:09,919 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 10:14:09,919 [dualprompt.py] => head.weight: 153600
2024-09-12 10:14:09,919 [dualprompt.py] => head.bias: 200
2024-09-12 10:14:09,920 [trainer.py] => All params: 172158352
2024-09-12 10:14:09,921 [trainer.py] => Trainable params: 407240
2024-09-12 10:14:09,921 [dualprompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.575, Train_accy 56.03:   0%|          | 0/20 [00:23<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.575, Train_accy 56.03:   5%|▌         | 1/20 [00:23<07:20, 23.21s/it]
Task 0, Epoch 2/20 => Loss 0.753, Train_accy 78.39:   5%|▌         | 1/20 [00:46<07:20, 23.21s/it]
Task 0, Epoch 2/20 => Loss 0.753, Train_accy 78.39:  10%|█         | 2/20 [00:46<06:58, 23.24s/it]
Task 0, Epoch 3/20 => Loss 0.613, Train_accy 82.06:  10%|█         | 2/20 [01:08<06:58, 23.24s/it]
Task 0, Epoch 3/20 => Loss 0.613, Train_accy 82.06:  15%|█▌        | 3/20 [01:08<06:27, 22.82s/it]
Task 0, Epoch 4/20 => Loss 0.516, Train_accy 84.77:  15%|█▌        | 3/20 [01:31<06:27, 22.82s/it]
Task 0, Epoch 4/20 => Loss 0.516, Train_accy 84.77:  20%|██        | 4/20 [01:31<06:01, 22.59s/it]
Task 0, Epoch 5/20 => Loss 0.468, Train_accy 86.16, Test_accy 84.76:  20%|██        | 4/20 [01:58<06:01, 22.59s/it]
Task 0, Epoch 5/20 => Loss 0.468, Train_accy 86.16, Test_accy 84.76:  25%|██▌       | 5/20 [01:58<06:06, 24.43s/it]
Task 0, Epoch 6/20 => Loss 0.399, Train_accy 87.80:  25%|██▌       | 5/20 [02:22<06:06, 24.43s/it]                 
Task 0, Epoch 6/20 => Loss 0.399, Train_accy 87.80:  30%|███       | 6/20 [02:22<05:37, 24.12s/it]
Task 0, Epoch 7/20 => Loss 0.381, Train_accy 89.02:  30%|███       | 6/20 [02:45<05:37, 24.12s/it]
Task 0, Epoch 7/20 => Loss 0.381, Train_accy 89.02:  35%|███▌      | 7/20 [02:45<05:09, 23.84s/it]
Task 0, Epoch 8/20 => Loss 0.340, Train_accy 89.51:  35%|███▌      | 7/20 [03:09<05:09, 23.84s/it]
Task 0, Epoch 8/20 => Loss 0.340, Train_accy 89.51:  40%|████      | 8/20 [03:09<04:44, 23.74s/it]
Task 0, Epoch 9/20 => Loss 0.339, Train_accy 89.80:  40%|████      | 8/20 [03:32<04:44, 23.74s/it]
Task 0, Epoch 9/20 => Loss 0.339, Train_accy 89.80:  45%|████▌     | 9/20 [03:32<04:20, 23.65s/it]
Task 0, Epoch 10/20 => Loss 0.344, Train_accy 89.91, Test_accy 85.92:  45%|████▌     | 9/20 [04:00<04:20, 23.65s/it]
Task 0, Epoch 10/20 => Loss 0.344, Train_accy 89.91, Test_accy 85.92:  50%|█████     | 10/20 [04:00<04:08, 24.85s/it]
Task 0, Epoch 11/20 => Loss 0.300, Train_accy 90.76:  50%|█████     | 10/20 [04:22<04:08, 24.85s/it]                 
Task 0, Epoch 11/20 => Loss 0.300, Train_accy 90.76:  55%|█████▌    | 11/20 [04:22<03:38, 24.23s/it]
Task 0, Epoch 12/20 => Loss 0.304, Train_accy 90.51:  55%|█████▌    | 11/20 [04:44<03:38, 24.23s/it]
Task 0, Epoch 12/20 => Loss 0.304, Train_accy 90.51:  60%|██████    | 12/20 [04:44<03:08, 23.55s/it]
Task 0, Epoch 13/20 => Loss 0.290, Train_accy 91.12:  60%|██████    | 12/20 [05:07<03:08, 23.55s/it]
Task 0, Epoch 13/20 => Loss 0.290, Train_accy 91.12:  65%|██████▌   | 13/20 [05:07<02:43, 23.38s/it]
Task 0, Epoch 14/20 => Loss 0.277, Train_accy 91.76:  65%|██████▌   | 13/20 [05:31<02:43, 23.38s/it]
Task 0, Epoch 14/20 => Loss 0.277, Train_accy 91.76:  70%|███████   | 14/20 [05:31<02:20, 23.38s/it]
Task 0, Epoch 15/20 => Loss 0.269, Train_accy 91.26, Test_accy 84.62:  70%|███████   | 14/20 [05:58<02:20, 23.38s/it]
Task 0, Epoch 15/20 => Loss 0.269, Train_accy 91.26, Test_accy 84.62:  75%|███████▌  | 15/20 [05:58<02:03, 24.69s/it]
Task 0, Epoch 16/20 => Loss 0.271, Train_accy 91.12:  75%|███████▌  | 15/20 [06:22<02:03, 24.69s/it]                 
Task 0, Epoch 16/20 => Loss 0.271, Train_accy 91.12:  80%|████████  | 16/20 [06:22<01:37, 24.31s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 92.33:  80%|████████  | 16/20 [06:45<01:37, 24.31s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 92.33:  85%|████████▌ | 17/20 [06:45<01:12, 24.04s/it]
Task 0, Epoch 18/20 => Loss 0.230, Train_accy 92.58:  85%|████████▌ | 17/20 [07:09<01:12, 24.04s/it]
Task 0, Epoch 18/20 => Loss 0.230, Train_accy 92.58:  90%|█████████ | 18/20 [07:09<00:47, 23.88s/it]
Task 0, Epoch 19/20 => Loss 0.231, Train_accy 92.01:  90%|█████████ | 18/20 [07:32<00:47, 23.88s/it]
Task 0, Epoch 19/20 => Loss 0.231, Train_accy 92.01:  95%|█████████▌| 19/20 [07:32<00:23, 23.74s/it]
Task 0, Epoch 20/20 => Loss 0.228, Train_accy 92.76, Test_accy 82.58:  95%|█████████▌| 19/20 [07:59<00:23, 23.74s/it]
Task 0, Epoch 20/20 => Loss 0.228, Train_accy 92.76, Test_accy 82.58: 100%|██████████| 20/20 [07:59<00:00, 24.57s/it]
Task 0, Epoch 20/20 => Loss 0.228, Train_accy 92.76, Test_accy 82.58: 100%|██████████| 20/20 [07:59<00:00, 23.96s/it]
2024-09-12 10:22:09,766 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.228, Train_accy 92.76, Test_accy 82.58
2024-09-12 10:22:13,868 [trainer.py] => No NME accuracy.
2024-09-12 10:22:13,868 [trainer.py] => CNN: {'total': 82.58, '00-19': 82.58, 'old': 0, 'new': 82.58}
2024-09-12 10:22:13,869 [trainer.py] => CNN top1 curve: [82.58]
2024-09-12 10:22:13,869 [trainer.py] => CNN top5 curve: [95.79]

Average Accuracy (CNN): 82.58
2024-09-12 10:22:13,869 [trainer.py] => Average Accuracy (CNN): 82.58 

2024-09-12 10:22:13,872 [trainer.py] => All params: 172158352
2024-09-12 10:22:13,875 [trainer.py] => Trainable params: 407240
2024-09-12 10:22:13,875 [dualprompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.620, Train_accy 55.35:   0%|          | 0/20 [00:21<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.620, Train_accy 55.35:   5%|▌         | 1/20 [00:21<06:39, 21.03s/it]
Task 1, Epoch 2/20 => Loss 0.752, Train_accy 77.56:   5%|▌         | 1/20 [00:42<06:39, 21.03s/it]
Task 1, Epoch 2/20 => Loss 0.752, Train_accy 77.56:  10%|█         | 2/20 [00:42<06:24, 21.34s/it]
Task 1, Epoch 3/20 => Loss 0.601, Train_accy 81.85:  10%|█         | 2/20 [01:04<06:24, 21.34s/it]
Task 1, Epoch 3/20 => Loss 0.601, Train_accy 81.85:  15%|█▌        | 3/20 [01:04<06:03, 21.39s/it]
Task 1, Epoch 4/20 => Loss 0.461, Train_accy 85.79:  15%|█▌        | 3/20 [01:25<06:03, 21.39s/it]
Task 1, Epoch 4/20 => Loss 0.461, Train_accy 85.79:  20%|██        | 4/20 [01:25<05:43, 21.46s/it]
Task 1, Epoch 5/20 => Loss 0.416, Train_accy 87.35, Test_accy 74.94:  20%|██        | 4/20 [01:54<05:43, 21.46s/it]
Task 1, Epoch 5/20 => Loss 0.416, Train_accy 87.35, Test_accy 74.94:  25%|██▌       | 5/20 [01:54<06:04, 24.30s/it]
Task 1, Epoch 6/20 => Loss 0.390, Train_accy 87.78:  25%|██▌       | 5/20 [02:16<06:04, 24.30s/it]                 
Task 1, Epoch 6/20 => Loss 0.390, Train_accy 87.78:  30%|███       | 6/20 [02:16<05:26, 23.34s/it]
Task 1, Epoch 7/20 => Loss 0.375, Train_accy 89.27:  30%|███       | 6/20 [02:37<05:26, 23.34s/it]
Task 1, Epoch 7/20 => Loss 0.375, Train_accy 89.27:  35%|███▌      | 7/20 [02:37<04:55, 22.75s/it]
Task 1, Epoch 8/20 => Loss 0.315, Train_accy 90.36:  35%|███▌      | 7/20 [02:59<04:55, 22.75s/it]
Task 1, Epoch 8/20 => Loss 0.315, Train_accy 90.36:  40%|████      | 8/20 [02:59<04:28, 22.34s/it]
Task 1, Epoch 9/20 => Loss 0.315, Train_accy 90.55:  40%|████      | 8/20 [03:19<04:28, 22.34s/it]
Task 1, Epoch 9/20 => Loss 0.315, Train_accy 90.55:  45%|████▌     | 9/20 [03:19<03:58, 21.69s/it]
Task 1, Epoch 10/20 => Loss 0.320, Train_accy 90.24, Test_accy 76.99:  45%|████▌     | 9/20 [03:48<03:58, 21.69s/it]
Task 1, Epoch 10/20 => Loss 0.320, Train_accy 90.24, Test_accy 76.99:  50%|█████     | 10/20 [03:48<03:58, 23.85s/it]
Task 1, Epoch 11/20 => Loss 0.308, Train_accy 89.70:  50%|█████     | 10/20 [04:09<03:58, 23.85s/it]                 
Task 1, Epoch 11/20 => Loss 0.308, Train_accy 89.70:  55%|█████▌    | 11/20 [04:09<03:28, 23.13s/it]
Task 1, Epoch 12/20 => Loss 0.267, Train_accy 91.37:  55%|█████▌    | 11/20 [04:31<03:28, 23.13s/it]
Task 1, Epoch 12/20 => Loss 0.267, Train_accy 91.37:  60%|██████    | 12/20 [04:31<03:01, 22.63s/it]
Task 1, Epoch 13/20 => Loss 0.291, Train_accy 91.53:  60%|██████    | 12/20 [04:52<03:01, 22.63s/it]
Task 1, Epoch 13/20 => Loss 0.291, Train_accy 91.53:  65%|██████▌   | 13/20 [04:52<02:36, 22.29s/it]
Task 1, Epoch 14/20 => Loss 0.281, Train_accy 91.14:  65%|██████▌   | 13/20 [05:14<02:36, 22.29s/it]
Task 1, Epoch 14/20 => Loss 0.281, Train_accy 91.14:  70%|███████   | 14/20 [05:14<02:12, 22.03s/it]
Task 1, Epoch 15/20 => Loss 0.263, Train_accy 91.02, Test_accy 77.67:  70%|███████   | 14/20 [05:43<02:12, 22.03s/it]
Task 1, Epoch 15/20 => Loss 0.263, Train_accy 91.02, Test_accy 77.67:  75%|███████▌  | 15/20 [05:43<02:00, 24.18s/it]
Task 1, Epoch 16/20 => Loss 0.281, Train_accy 91.65:  75%|███████▌  | 15/20 [06:04<02:00, 24.18s/it]                 
Task 1, Epoch 16/20 => Loss 0.281, Train_accy 91.65:  80%|████████  | 16/20 [06:04<01:33, 23.38s/it]
Task 1, Epoch 17/20 => Loss 0.268, Train_accy 92.08:  80%|████████  | 16/20 [06:26<01:33, 23.38s/it]
Task 1, Epoch 17/20 => Loss 0.268, Train_accy 92.08:  85%|████████▌ | 17/20 [06:26<01:08, 22.68s/it]
Task 1, Epoch 18/20 => Loss 0.233, Train_accy 92.31:  85%|████████▌ | 17/20 [06:46<01:08, 22.68s/it]
Task 1, Epoch 18/20 => Loss 0.233, Train_accy 92.31:  90%|█████████ | 18/20 [06:46<00:43, 21.98s/it]
Task 1, Epoch 19/20 => Loss 0.241, Train_accy 91.92:  90%|█████████ | 18/20 [07:07<00:43, 21.98s/it]
Task 1, Epoch 19/20 => Loss 0.241, Train_accy 91.92:  95%|█████████▌| 19/20 [07:07<00:21, 21.75s/it]
Task 1, Epoch 20/20 => Loss 0.214, Train_accy 92.39, Test_accy 77.74:  95%|█████████▌| 19/20 [07:37<00:21, 21.75s/it]
Task 1, Epoch 20/20 => Loss 0.214, Train_accy 92.39, Test_accy 77.74: 100%|██████████| 20/20 [07:37<00:00, 24.09s/it]
Task 1, Epoch 20/20 => Loss 0.214, Train_accy 92.39, Test_accy 77.74: 100%|██████████| 20/20 [07:37<00:00, 22.86s/it]
2024-09-12 10:29:51,024 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.214, Train_accy 92.39, Test_accy 77.74
2024-09-12 10:29:58,789 [trainer.py] => No NME accuracy.
2024-09-12 10:29:58,789 [trainer.py] => CNN: {'total': 77.74, '00-19': 79.83, '20-39': 75.47, 'old': 79.83, 'new': 75.47}
2024-09-12 10:29:58,789 [trainer.py] => CNN top1 curve: [82.58, 77.74]
2024-09-12 10:29:58,789 [trainer.py] => CNN top5 curve: [95.79, 93.11]

Average Accuracy (CNN): 80.16
2024-09-12 10:29:58,789 [trainer.py] => Average Accuracy (CNN): 80.16 

2024-09-12 10:29:58,791 [trainer.py] => All params: 172158352
2024-09-12 10:29:58,792 [trainer.py] => Trainable params: 407240
2024-09-12 10:29:58,792 [dualprompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.805, Train_accy 51.22:   0%|          | 0/20 [00:19<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.805, Train_accy 51.22:   5%|▌         | 1/20 [00:19<06:16, 19.81s/it]
Task 2, Epoch 2/20 => Loss 0.759, Train_accy 77.21:   5%|▌         | 1/20 [00:39<06:16, 19.81s/it]
Task 2, Epoch 2/20 => Loss 0.759, Train_accy 77.21:  10%|█         | 2/20 [00:39<05:55, 19.77s/it]
Task 2, Epoch 3/20 => Loss 0.572, Train_accy 82.76:  10%|█         | 2/20 [00:59<05:55, 19.77s/it]
Task 2, Epoch 3/20 => Loss 0.572, Train_accy 82.76:  15%|█▌        | 3/20 [00:59<05:35, 19.76s/it]
Task 2, Epoch 4/20 => Loss 0.512, Train_accy 84.55:  15%|█▌        | 3/20 [01:19<05:35, 19.76s/it]
Task 2, Epoch 4/20 => Loss 0.512, Train_accy 84.55:  20%|██        | 4/20 [01:19<05:15, 19.75s/it]
Task 2, Epoch 5/20 => Loss 0.462, Train_accy 86.73, Test_accy 71.25:  20%|██        | 4/20 [01:49<05:15, 19.75s/it]
Task 2, Epoch 5/20 => Loss 0.462, Train_accy 86.73, Test_accy 71.25:  25%|██▌       | 5/20 [01:49<05:56, 23.74s/it]
Task 2, Epoch 6/20 => Loss 0.410, Train_accy 87.75:  25%|██▌       | 5/20 [02:08<05:56, 23.74s/it]                 
Task 2, Epoch 6/20 => Loss 0.410, Train_accy 87.75:  30%|███       | 6/20 [02:08<05:10, 22.15s/it]
Task 2, Epoch 7/20 => Loss 0.349, Train_accy 89.54:  30%|███       | 6/20 [02:27<05:10, 22.15s/it]
Task 2, Epoch 7/20 => Loss 0.349, Train_accy 89.54:  35%|███▌      | 7/20 [02:27<04:32, 20.94s/it]
Task 2, Epoch 8/20 => Loss 0.353, Train_accy 89.88:  35%|███▌      | 7/20 [02:47<04:32, 20.94s/it]
Task 2, Epoch 8/20 => Loss 0.353, Train_accy 89.88:  40%|████      | 8/20 [02:47<04:06, 20.54s/it]
Task 2, Epoch 9/20 => Loss 0.296, Train_accy 91.29:  40%|████      | 8/20 [03:06<04:06, 20.54s/it]
Task 2, Epoch 9/20 => Loss 0.296, Train_accy 91.29:  45%|████▌     | 9/20 [03:06<03:42, 20.26s/it]
Task 2, Epoch 10/20 => Loss 0.296, Train_accy 91.29, Test_accy 72.86:  45%|████▌     | 9/20 [03:37<03:42, 20.26s/it]
Task 2, Epoch 10/20 => Loss 0.296, Train_accy 91.29, Test_accy 72.86:  50%|█████     | 10/20 [03:37<03:55, 23.55s/it]
Task 2, Epoch 11/20 => Loss 0.330, Train_accy 90.23:  50%|█████     | 10/20 [03:57<03:55, 23.55s/it]                 
Task 2, Epoch 11/20 => Loss 0.330, Train_accy 90.23:  55%|█████▌    | 11/20 [03:57<03:21, 22.34s/it]
Task 2, Epoch 12/20 => Loss 0.250, Train_accy 92.40:  55%|█████▌    | 11/20 [04:16<03:21, 22.34s/it]
Task 2, Epoch 12/20 => Loss 0.250, Train_accy 92.40:  60%|██████    | 12/20 [04:16<02:52, 21.51s/it]
Task 2, Epoch 13/20 => Loss 0.308, Train_accy 90.57:  60%|██████    | 12/20 [04:36<02:52, 21.51s/it]
Task 2, Epoch 13/20 => Loss 0.308, Train_accy 90.57:  65%|██████▌   | 13/20 [04:36<02:26, 20.97s/it]
Task 2, Epoch 14/20 => Loss 0.277, Train_accy 91.51:  65%|██████▌   | 13/20 [04:56<02:26, 20.97s/it]
Task 2, Epoch 14/20 => Loss 0.277, Train_accy 91.51:  70%|███████   | 14/20 [04:56<02:03, 20.59s/it]
Task 2, Epoch 15/20 => Loss 0.256, Train_accy 92.23, Test_accy 72.96:  70%|███████   | 14/20 [05:26<02:03, 20.59s/it]
Task 2, Epoch 15/20 => Loss 0.256, Train_accy 92.23, Test_accy 72.96:  75%|███████▌  | 15/20 [05:26<01:58, 23.61s/it]
Task 2, Epoch 16/20 => Loss 0.209, Train_accy 93.38:  75%|███████▌  | 15/20 [05:45<01:58, 23.61s/it]                 
Task 2, Epoch 16/20 => Loss 0.209, Train_accy 93.38:  80%|████████  | 16/20 [05:45<01:28, 22.12s/it]
Task 2, Epoch 17/20 => Loss 0.234, Train_accy 92.27:  80%|████████  | 16/20 [06:04<01:28, 22.12s/it]
Task 2, Epoch 17/20 => Loss 0.234, Train_accy 92.27:  85%|████████▌ | 17/20 [06:04<01:03, 21.32s/it]
Task 2, Epoch 18/20 => Loss 0.243, Train_accy 92.27:  85%|████████▌ | 17/20 [06:24<01:03, 21.32s/it]
Task 2, Epoch 18/20 => Loss 0.243, Train_accy 92.27:  90%|█████████ | 18/20 [06:24<00:41, 20.79s/it]
Task 2, Epoch 19/20 => Loss 0.236, Train_accy 92.27:  90%|█████████ | 18/20 [06:44<00:41, 20.79s/it]
Task 2, Epoch 19/20 => Loss 0.236, Train_accy 92.27:  95%|█████████▌| 19/20 [06:44<00:20, 20.47s/it]
Task 2, Epoch 20/20 => Loss 0.228, Train_accy 92.57, Test_accy 73.12:  95%|█████████▌| 19/20 [07:14<00:20, 20.47s/it]
Task 2, Epoch 20/20 => Loss 0.228, Train_accy 92.57, Test_accy 73.12: 100%|██████████| 20/20 [07:14<00:00, 23.55s/it]
Task 2, Epoch 20/20 => Loss 0.228, Train_accy 92.57, Test_accy 73.12: 100%|██████████| 20/20 [07:14<00:00, 21.75s/it]
2024-09-12 10:37:13,795 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.228, Train_accy 92.57, Test_accy 73.12
2024-09-12 10:37:24,964 [trainer.py] => No NME accuracy.
2024-09-12 10:37:24,965 [trainer.py] => CNN: {'total': 73.12, '00-19': 77.79, '20-39': 73.73, '40-59': 67.16, 'old': 75.85, 'new': 67.16}
2024-09-12 10:37:24,965 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12]
2024-09-12 10:37:24,965 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02]

Average Accuracy (CNN): 77.81
2024-09-12 10:37:24,966 [trainer.py] => Average Accuracy (CNN): 77.81 

2024-09-12 10:37:24,969 [trainer.py] => All params: 172158352
2024-09-12 10:37:24,973 [trainer.py] => Trainable params: 407240
2024-09-12 10:37:24,973 [dualprompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.793, Train_accy 51.55:   0%|          | 0/20 [00:19<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.793, Train_accy 51.55:   5%|▌         | 1/20 [00:19<06:03, 19.12s/it]
Task 3, Epoch 2/20 => Loss 0.734, Train_accy 77.41:   5%|▌         | 1/20 [00:38<06:03, 19.12s/it]
Task 3, Epoch 2/20 => Loss 0.734, Train_accy 77.41:  10%|█         | 2/20 [00:38<05:47, 19.29s/it]
Task 3, Epoch 3/20 => Loss 0.559, Train_accy 83.52:  10%|█         | 2/20 [00:57<05:47, 19.29s/it]
Task 3, Epoch 3/20 => Loss 0.559, Train_accy 83.52:  15%|█▌        | 3/20 [00:57<05:27, 19.28s/it]
Task 3, Epoch 4/20 => Loss 0.499, Train_accy 85.00:  15%|█▌        | 3/20 [01:16<05:27, 19.28s/it]
Task 3, Epoch 4/20 => Loss 0.499, Train_accy 85.00:  20%|██        | 4/20 [01:16<05:05, 19.12s/it]
Task 3, Epoch 5/20 => Loss 0.439, Train_accy 86.66, Test_accy 67.49:  20%|██        | 4/20 [01:48<05:05, 19.12s/it]
Task 3, Epoch 5/20 => Loss 0.439, Train_accy 86.66, Test_accy 67.49:  25%|██▌       | 5/20 [01:48<05:54, 23.62s/it]
Task 3, Epoch 6/20 => Loss 0.413, Train_accy 87.53:  25%|██▌       | 5/20 [02:07<05:54, 23.62s/it]                 
Task 3, Epoch 6/20 => Loss 0.413, Train_accy 87.53:  30%|███       | 6/20 [02:07<05:09, 22.08s/it]
Task 3, Epoch 7/20 => Loss 0.357, Train_accy 89.32:  30%|███       | 6/20 [02:26<05:09, 22.08s/it]
Task 3, Epoch 7/20 => Loss 0.357, Train_accy 89.32:  35%|███▌      | 7/20 [02:26<04:35, 21.16s/it]
Task 3, Epoch 8/20 => Loss 0.317, Train_accy 90.32:  35%|███▌      | 7/20 [02:45<04:35, 21.16s/it]
Task 3, Epoch 8/20 => Loss 0.317, Train_accy 90.32:  40%|████      | 8/20 [02:45<04:06, 20.55s/it]
Task 3, Epoch 9/20 => Loss 0.327, Train_accy 89.84:  40%|████      | 8/20 [03:05<04:06, 20.55s/it]
Task 3, Epoch 9/20 => Loss 0.327, Train_accy 89.84:  45%|████▌     | 9/20 [03:05<03:41, 20.12s/it]
Task 3, Epoch 10/20 => Loss 0.281, Train_accy 91.15, Test_accy 69.74:  45%|████▌     | 9/20 [03:38<03:41, 20.12s/it]
Task 3, Epoch 10/20 => Loss 0.281, Train_accy 91.15, Test_accy 69.74:  50%|█████     | 10/20 [03:38<04:02, 24.24s/it]
Task 3, Epoch 11/20 => Loss 0.291, Train_accy 91.15:  50%|█████     | 10/20 [03:57<04:02, 24.24s/it]                 
Task 3, Epoch 11/20 => Loss 0.291, Train_accy 91.15:  55%|█████▌    | 11/20 [03:57<03:24, 22.73s/it]
Task 3, Epoch 12/20 => Loss 0.286, Train_accy 91.71:  55%|█████▌    | 11/20 [04:17<03:24, 22.73s/it]
Task 3, Epoch 12/20 => Loss 0.286, Train_accy 91.71:  60%|██████    | 12/20 [04:17<02:53, 21.67s/it]
Task 3, Epoch 13/20 => Loss 0.278, Train_accy 91.32:  60%|██████    | 12/20 [04:36<02:53, 21.67s/it]
Task 3, Epoch 13/20 => Loss 0.278, Train_accy 91.32:  65%|██████▌   | 13/20 [04:36<02:25, 20.85s/it]
Task 3, Epoch 14/20 => Loss 0.270, Train_accy 91.02:  65%|██████▌   | 13/20 [04:54<02:25, 20.85s/it]
Task 3, Epoch 14/20 => Loss 0.270, Train_accy 91.02:  70%|███████   | 14/20 [04:54<02:00, 20.02s/it]
Task 3, Epoch 15/20 => Loss 0.263, Train_accy 91.54, Test_accy 70.38:  70%|███████   | 14/20 [05:26<02:00, 20.02s/it]
Task 3, Epoch 15/20 => Loss 0.263, Train_accy 91.54, Test_accy 70.38:  75%|███████▌  | 15/20 [05:26<01:58, 23.76s/it]
Task 3, Epoch 16/20 => Loss 0.270, Train_accy 91.63:  75%|███████▌  | 15/20 [05:45<01:58, 23.76s/it]                 
Task 3, Epoch 16/20 => Loss 0.270, Train_accy 91.63:  80%|████████  | 16/20 [05:45<01:29, 22.39s/it]
Task 3, Epoch 17/20 => Loss 0.246, Train_accy 91.80:  80%|████████  | 16/20 [06:04<01:29, 22.39s/it]
Task 3, Epoch 17/20 => Loss 0.246, Train_accy 91.80:  85%|████████▌ | 17/20 [06:04<01:04, 21.43s/it]
Task 3, Epoch 18/20 => Loss 0.267, Train_accy 91.58:  85%|████████▌ | 17/20 [06:24<01:04, 21.43s/it]
Task 3, Epoch 18/20 => Loss 0.267, Train_accy 91.58:  90%|█████████ | 18/20 [06:24<00:41, 20.78s/it]
Task 3, Epoch 19/20 => Loss 0.235, Train_accy 91.89:  90%|█████████ | 18/20 [06:43<00:41, 20.78s/it]
Task 3, Epoch 19/20 => Loss 0.235, Train_accy 91.89:  95%|█████████▌| 19/20 [06:43<00:20, 20.26s/it]
Task 3, Epoch 20/20 => Loss 0.243, Train_accy 91.98, Test_accy 70.90:  95%|█████████▌| 19/20 [07:16<00:20, 20.26s/it]
Task 3, Epoch 20/20 => Loss 0.243, Train_accy 91.98, Test_accy 70.90: 100%|██████████| 20/20 [07:16<00:00, 24.18s/it]
Task 3, Epoch 20/20 => Loss 0.243, Train_accy 91.98, Test_accy 70.90: 100%|██████████| 20/20 [07:16<00:00, 21.83s/it]
2024-09-12 10:44:41,594 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.243, Train_accy 91.98, Test_accy 70.90
2024-09-12 10:44:55,574 [trainer.py] => No NME accuracy.
2024-09-12 10:44:55,575 [trainer.py] => CNN: {'total': 70.9, '00-19': 78.37, '20-39': 73.26, '40-59': 67.0, '60-79': 63.4, 'old': 73.12, 'new': 63.4}
2024-09-12 10:44:55,575 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12, 70.9]
2024-09-12 10:44:55,575 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02, 89.27]

Average Accuracy (CNN): 76.09
2024-09-12 10:44:55,576 [trainer.py] => Average Accuracy (CNN): 76.09 

2024-09-12 10:44:55,579 [trainer.py] => All params: 172158352
2024-09-12 10:44:55,581 [trainer.py] => Trainable params: 407240
2024-09-12 10:44:55,581 [dualprompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.797, Train_accy 51.26:   0%|          | 0/20 [00:18<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.797, Train_accy 51.26:   5%|▌         | 1/20 [00:18<05:46, 18.25s/it]
Task 4, Epoch 2/20 => Loss 0.765, Train_accy 77.47:   5%|▌         | 1/20 [00:35<05:46, 18.25s/it]
Task 4, Epoch 2/20 => Loss 0.765, Train_accy 77.47:  10%|█         | 2/20 [00:35<05:20, 17.83s/it]
Task 4, Epoch 3/20 => Loss 0.568, Train_accy 81.75:  10%|█         | 2/20 [00:52<05:20, 17.83s/it]
Task 4, Epoch 3/20 => Loss 0.568, Train_accy 81.75:  15%|█▌        | 3/20 [00:52<04:57, 17.52s/it]
Task 4, Epoch 4/20 => Loss 0.509, Train_accy 84.78:  15%|█▌        | 3/20 [01:10<04:57, 17.52s/it]
Task 4, Epoch 4/20 => Loss 0.509, Train_accy 84.78:  20%|██        | 4/20 [01:10<04:41, 17.57s/it]
Task 4, Epoch 5/20 => Loss 0.455, Train_accy 85.70, Test_accy 66.93:  20%|██        | 4/20 [01:45<04:41, 17.57s/it]
Task 4, Epoch 5/20 => Loss 0.455, Train_accy 85.70, Test_accy 66.93:  25%|██▌       | 5/20 [01:45<05:58, 23.89s/it]
Task 4, Epoch 6/20 => Loss 0.383, Train_accy 87.95:  25%|██▌       | 5/20 [02:03<05:58, 23.89s/it]                 
Task 4, Epoch 6/20 => Loss 0.383, Train_accy 87.95:  30%|███       | 6/20 [02:03<05:07, 21.97s/it]
Task 4, Epoch 7/20 => Loss 0.392, Train_accy 88.23:  30%|███       | 6/20 [02:22<05:07, 21.97s/it]
Task 4, Epoch 7/20 => Loss 0.392, Train_accy 88.23:  35%|███▌      | 7/20 [02:22<04:29, 20.74s/it]
Task 4, Epoch 8/20 => Loss 0.341, Train_accy 89.38:  35%|███▌      | 7/20 [02:40<04:29, 20.74s/it]
Task 4, Epoch 8/20 => Loss 0.341, Train_accy 89.38:  40%|████      | 8/20 [02:40<03:59, 19.92s/it]
Task 4, Epoch 9/20 => Loss 0.281, Train_accy 91.26:  40%|████      | 8/20 [02:58<03:59, 19.92s/it]
Task 4, Epoch 9/20 => Loss 0.281, Train_accy 91.26:  45%|████▌     | 9/20 [02:58<03:32, 19.36s/it]
Task 4, Epoch 10/20 => Loss 0.285, Train_accy 91.26, Test_accy 68.17:  45%|████▌     | 9/20 [03:33<03:32, 19.36s/it]
Task 4, Epoch 10/20 => Loss 0.285, Train_accy 91.26, Test_accy 68.17:  50%|█████     | 10/20 [03:33<04:01, 24.14s/it]
Task 4, Epoch 11/20 => Loss 0.265, Train_accy 91.82:  50%|█████     | 10/20 [03:51<04:01, 24.14s/it]                 
Task 4, Epoch 11/20 => Loss 0.265, Train_accy 91.82:  55%|█████▌    | 11/20 [03:51<03:20, 22.32s/it]
Task 4, Epoch 12/20 => Loss 0.297, Train_accy 90.62:  55%|█████▌    | 11/20 [04:08<03:20, 22.32s/it]
Task 4, Epoch 12/20 => Loss 0.297, Train_accy 90.62:  60%|██████    | 12/20 [04:08<02:45, 20.72s/it]
Task 4, Epoch 13/20 => Loss 0.291, Train_accy 91.26:  60%|██████    | 12/20 [04:25<02:45, 20.72s/it]
Task 4, Epoch 13/20 => Loss 0.291, Train_accy 91.26:  65%|██████▌   | 13/20 [04:25<02:17, 19.67s/it]
Task 4, Epoch 14/20 => Loss 0.270, Train_accy 91.77:  65%|██████▌   | 13/20 [04:43<02:17, 19.67s/it]
Task 4, Epoch 14/20 => Loss 0.270, Train_accy 91.77:  70%|███████   | 14/20 [04:43<01:55, 19.20s/it]
Task 4, Epoch 15/20 => Loss 0.240, Train_accy 92.78, Test_accy 68.04:  70%|███████   | 14/20 [05:19<01:55, 19.20s/it]
Task 4, Epoch 15/20 => Loss 0.240, Train_accy 92.78, Test_accy 68.04:  75%|███████▌  | 15/20 [05:19<02:00, 24.07s/it]
Task 4, Epoch 16/20 => Loss 0.238, Train_accy 92.41:  75%|███████▌  | 15/20 [05:37<02:00, 24.07s/it]                 
Task 4, Epoch 16/20 => Loss 0.238, Train_accy 92.41:  80%|████████  | 16/20 [05:37<01:29, 22.35s/it]
Task 4, Epoch 17/20 => Loss 0.256, Train_accy 92.00:  80%|████████  | 16/20 [05:55<01:29, 22.35s/it]
Task 4, Epoch 17/20 => Loss 0.256, Train_accy 92.00:  85%|████████▌ | 17/20 [05:55<01:03, 21.10s/it]
Task 4, Epoch 18/20 => Loss 0.251, Train_accy 91.82:  85%|████████▌ | 17/20 [06:14<01:03, 21.10s/it]
Task 4, Epoch 18/20 => Loss 0.251, Train_accy 91.82:  90%|█████████ | 18/20 [06:14<00:40, 20.25s/it]
Task 4, Epoch 19/20 => Loss 0.241, Train_accy 92.41:  90%|█████████ | 18/20 [06:32<00:40, 20.25s/it]
Task 4, Epoch 19/20 => Loss 0.241, Train_accy 92.41:  95%|█████████▌| 19/20 [06:32<00:19, 19.70s/it]
Task 4, Epoch 20/20 => Loss 0.221, Train_accy 93.01, Test_accy 68.64:  95%|█████████▌| 19/20 [07:07<00:19, 19.70s/it]
Task 4, Epoch 20/20 => Loss 0.221, Train_accy 93.01, Test_accy 68.64: 100%|██████████| 20/20 [07:07<00:00, 24.32s/it]
Task 4, Epoch 20/20 => Loss 0.221, Train_accy 93.01, Test_accy 68.64: 100%|██████████| 20/20 [07:07<00:00, 21.38s/it]
2024-09-12 10:52:03,196 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.221, Train_accy 93.01, Test_accy 68.64
2024-09-12 10:52:19,352 [trainer.py] => No NME accuracy.
2024-09-12 10:52:19,352 [trainer.py] => CNN: {'total': 68.64, '00-19': 77.65, '20-39': 72.31, '40-59': 65.68, '60-79': 63.05, '80-99': 61.4, 'old': 70.06, 'new': 61.4}
2024-09-12 10:52:19,352 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12, 70.9, 68.64]
2024-09-12 10:52:19,352 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02, 89.27, 87.04]

Average Accuracy (CNN): 74.6
2024-09-12 10:52:19,353 [trainer.py] => Average Accuracy (CNN): 74.6 

2024-09-12 10:52:19,356 [trainer.py] => All params: 172158352
2024-09-12 10:52:19,358 [trainer.py] => Trainable params: 407240
2024-09-12 10:52:19,358 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.516, Train_accy 58.54:   0%|          | 0/20 [00:21<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.516, Train_accy 58.54:   5%|▌         | 1/20 [00:21<06:43, 21.25s/it]
Task 5, Epoch 2/20 => Loss 0.668, Train_accy 80.49:   5%|▌         | 1/20 [00:43<06:43, 21.25s/it]
Task 5, Epoch 2/20 => Loss 0.668, Train_accy 80.49:  10%|█         | 2/20 [00:43<06:35, 21.99s/it]
Task 5, Epoch 3/20 => Loss 0.533, Train_accy 83.64:  10%|█         | 2/20 [01:06<06:35, 21.99s/it]
Task 5, Epoch 3/20 => Loss 0.533, Train_accy 83.64:  15%|█▌        | 3/20 [01:06<06:16, 22.16s/it]
Task 5, Epoch 4/20 => Loss 0.460, Train_accy 85.93:  15%|█▌        | 3/20 [01:28<06:16, 22.16s/it]
Task 5, Epoch 4/20 => Loss 0.460, Train_accy 85.93:  20%|██        | 4/20 [01:28<05:55, 22.23s/it]
Task 5, Epoch 5/20 => Loss 0.376, Train_accy 87.95, Test_accy 65.40:  20%|██        | 4/20 [02:11<05:55, 22.23s/it]
Task 5, Epoch 5/20 => Loss 0.376, Train_accy 87.95, Test_accy 65.40:  25%|██▌       | 5/20 [02:11<07:26, 29.80s/it]
Task 5, Epoch 6/20 => Loss 0.349, Train_accy 89.01:  25%|██▌       | 5/20 [02:33<07:26, 29.80s/it]                 
Task 5, Epoch 6/20 => Loss 0.349, Train_accy 89.01:  30%|███       | 6/20 [02:33<06:21, 27.25s/it]
Task 5, Epoch 7/20 => Loss 0.336, Train_accy 89.72:  30%|███       | 6/20 [02:56<06:21, 27.25s/it]
Task 5, Epoch 7/20 => Loss 0.336, Train_accy 89.72:  35%|███▌      | 7/20 [02:56<05:33, 25.65s/it]
Task 5, Epoch 8/20 => Loss 0.309, Train_accy 90.54:  35%|███▌      | 7/20 [03:18<05:33, 25.65s/it]
Task 5, Epoch 8/20 => Loss 0.309, Train_accy 90.54:  40%|████      | 8/20 [03:18<04:53, 24.47s/it]
Task 5, Epoch 9/20 => Loss 0.260, Train_accy 91.74:  40%|████      | 8/20 [03:39<04:53, 24.47s/it]
Task 5, Epoch 9/20 => Loss 0.260, Train_accy 91.74:  45%|████▌     | 9/20 [03:39<04:17, 23.41s/it]
Task 5, Epoch 10/20 => Loss 0.282, Train_accy 91.52, Test_accy 66.86:  45%|████▌     | 9/20 [04:22<04:17, 23.41s/it]
Task 5, Epoch 10/20 => Loss 0.282, Train_accy 91.52, Test_accy 66.86:  50%|█████     | 10/20 [04:22<04:53, 29.37s/it]
Task 5, Epoch 11/20 => Loss 0.252, Train_accy 92.57:  50%|█████     | 10/20 [04:44<04:53, 29.37s/it]                 
Task 5, Epoch 11/20 => Loss 0.252, Train_accy 92.57:  55%|█████▌    | 11/20 [04:44<04:05, 27.29s/it]
Task 5, Epoch 12/20 => Loss 0.262, Train_accy 91.29:  55%|█████▌    | 11/20 [05:07<04:05, 27.29s/it]
Task 5, Epoch 12/20 => Loss 0.262, Train_accy 91.29:  60%|██████    | 12/20 [05:07<03:26, 25.82s/it]
Task 5, Epoch 13/20 => Loss 0.280, Train_accy 91.71:  60%|██████    | 12/20 [05:29<03:26, 25.82s/it]
Task 5, Epoch 13/20 => Loss 0.280, Train_accy 91.71:  65%|██████▌   | 13/20 [05:29<02:54, 24.88s/it]
Task 5, Epoch 14/20 => Loss 0.222, Train_accy 92.20:  65%|██████▌   | 13/20 [05:52<02:54, 24.88s/it]
Task 5, Epoch 14/20 => Loss 0.222, Train_accy 92.20:  70%|███████   | 14/20 [05:52<02:24, 24.16s/it]
Task 5, Epoch 15/20 => Loss 0.208, Train_accy 93.06, Test_accy 67.30:  70%|███████   | 14/20 [06:35<02:24, 24.16s/it]
Task 5, Epoch 15/20 => Loss 0.208, Train_accy 93.06, Test_accy 67.30:  75%|███████▌  | 15/20 [06:35<02:29, 29.90s/it]
Task 5, Epoch 16/20 => Loss 0.242, Train_accy 92.57:  75%|███████▌  | 15/20 [06:56<02:29, 29.90s/it]                 
Task 5, Epoch 16/20 => Loss 0.242, Train_accy 92.57:  80%|████████  | 16/20 [06:56<01:49, 27.31s/it]
Task 5, Epoch 17/20 => Loss 0.231, Train_accy 92.83:  80%|████████  | 16/20 [07:18<01:49, 27.31s/it]
Task 5, Epoch 17/20 => Loss 0.231, Train_accy 92.83:  85%|████████▌ | 17/20 [07:18<01:17, 25.67s/it]
Task 5, Epoch 18/20 => Loss 0.197, Train_accy 93.43:  85%|████████▌ | 17/20 [07:41<01:17, 25.67s/it]
Task 5, Epoch 18/20 => Loss 0.197, Train_accy 93.43:  90%|█████████ | 18/20 [07:41<00:49, 24.69s/it]
Task 5, Epoch 19/20 => Loss 0.178, Train_accy 94.07:  90%|█████████ | 18/20 [08:03<00:49, 24.69s/it]
Task 5, Epoch 19/20 => Loss 0.178, Train_accy 94.07:  95%|█████████▌| 19/20 [08:03<00:24, 24.07s/it]
Task 5, Epoch 20/20 => Loss 0.210, Train_accy 93.32, Test_accy 67.65:  95%|█████████▌| 19/20 [08:46<00:24, 24.07s/it]
Task 5, Epoch 20/20 => Loss 0.210, Train_accy 93.32, Test_accy 67.65: 100%|██████████| 20/20 [08:46<00:00, 29.69s/it]
Task 5, Epoch 20/20 => Loss 0.210, Train_accy 93.32, Test_accy 67.65: 100%|██████████| 20/20 [08:46<00:00, 26.32s/it]
2024-09-12 11:01:05,871 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.210, Train_accy 93.32, Test_accy 67.65
2024-09-12 11:01:26,369 [trainer.py] => No NME accuracy.
2024-09-12 11:01:26,369 [trainer.py] => CNN: {'total': 67.65, '00-19': 75.33, '20-39': 73.58, '40-59': 64.19, '60-79': 62.87, '80-99': 61.6, '100-119': 65.76, 'old': 68.07, 'new': 65.76}
2024-09-12 11:01:26,369 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12, 70.9, 68.64, 67.65]
2024-09-12 11:01:26,370 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02, 89.27, 87.04, 86.58]

Average Accuracy (CNN): 73.44
2024-09-12 11:01:26,370 [trainer.py] => Average Accuracy (CNN): 73.44 

2024-09-12 11:01:26,372 [trainer.py] => All params: 172158352
2024-09-12 11:01:26,374 [trainer.py] => Trainable params: 407240
2024-09-12 11:01:26,374 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.563, Train_accy 57.49:   0%|          | 0/20 [00:17<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.563, Train_accy 57.49:   5%|▌         | 1/20 [00:17<05:39, 17.89s/it]
Task 6, Epoch 2/20 => Loss 0.639, Train_accy 81.31:   5%|▌         | 1/20 [00:35<05:39, 17.89s/it]
Task 6, Epoch 2/20 => Loss 0.639, Train_accy 81.31:  10%|█         | 2/20 [00:35<05:20, 17.83s/it]
Task 6, Epoch 3/20 => Loss 0.464, Train_accy 86.30:  10%|█         | 2/20 [00:52<05:20, 17.83s/it]
Task 6, Epoch 3/20 => Loss 0.464, Train_accy 86.30:  15%|█▌        | 3/20 [00:52<04:57, 17.52s/it]
Task 6, Epoch 4/20 => Loss 0.405, Train_accy 88.23:  15%|█▌        | 3/20 [01:09<04:57, 17.52s/it]
Task 6, Epoch 4/20 => Loss 0.405, Train_accy 88.23:  20%|██        | 4/20 [01:09<04:36, 17.27s/it]
Task 6, Epoch 5/20 => Loss 0.340, Train_accy 90.21, Test_accy 65.16:  20%|██        | 4/20 [01:50<04:36, 17.27s/it]
Task 6, Epoch 5/20 => Loss 0.340, Train_accy 90.21, Test_accy 65.16:  25%|██▌       | 5/20 [01:50<06:28, 25.92s/it]
Task 6, Epoch 6/20 => Loss 0.322, Train_accy 89.45:  25%|██▌       | 5/20 [02:08<06:28, 25.92s/it]                 
Task 6, Epoch 6/20 => Loss 0.322, Train_accy 89.45:  30%|███       | 6/20 [02:08<05:24, 23.16s/it]
Task 6, Epoch 7/20 => Loss 0.293, Train_accy 90.73:  30%|███       | 6/20 [02:26<05:24, 23.16s/it]
Task 6, Epoch 7/20 => Loss 0.293, Train_accy 90.73:  35%|███▌      | 7/20 [02:26<04:38, 21.39s/it]
Task 6, Epoch 8/20 => Loss 0.270, Train_accy 91.43:  35%|███▌      | 7/20 [02:44<04:38, 21.39s/it]
Task 6, Epoch 8/20 => Loss 0.270, Train_accy 91.43:  40%|████      | 8/20 [02:44<04:03, 20.25s/it]
Task 6, Epoch 9/20 => Loss 0.259, Train_accy 92.09:  40%|████      | 8/20 [03:02<04:03, 20.25s/it]
Task 6, Epoch 9/20 => Loss 0.259, Train_accy 92.09:  45%|████▌     | 9/20 [03:02<03:34, 19.47s/it]
Task 6, Epoch 10/20 => Loss 0.258, Train_accy 92.47, Test_accy 66.09:  45%|████▌     | 9/20 [03:43<03:34, 19.47s/it]
Task 6, Epoch 10/20 => Loss 0.258, Train_accy 92.47, Test_accy 66.09:  50%|█████     | 10/20 [03:43<04:21, 26.18s/it]
Task 6, Epoch 11/20 => Loss 0.237, Train_accy 93.13:  50%|█████     | 10/20 [04:01<04:21, 26.18s/it]                 
Task 6, Epoch 11/20 => Loss 0.237, Train_accy 93.13:  55%|█████▌    | 11/20 [04:01<03:33, 23.69s/it]
Task 6, Epoch 12/20 => Loss 0.235, Train_accy 92.51:  55%|█████▌    | 11/20 [04:18<03:33, 23.69s/it]
Task 6, Epoch 12/20 => Loss 0.235, Train_accy 92.51:  60%|██████    | 12/20 [04:18<02:53, 21.63s/it]
Task 6, Epoch 13/20 => Loss 0.191, Train_accy 94.16:  60%|██████    | 12/20 [04:34<02:53, 21.63s/it]
Task 6, Epoch 13/20 => Loss 0.191, Train_accy 94.16:  65%|██████▌   | 13/20 [04:34<02:20, 20.11s/it]
Task 6, Epoch 14/20 => Loss 0.205, Train_accy 93.31:  65%|██████▌   | 13/20 [04:52<02:20, 20.11s/it]
Task 6, Epoch 14/20 => Loss 0.205, Train_accy 93.31:  70%|███████   | 14/20 [04:52<01:56, 19.39s/it]
Task 6, Epoch 15/20 => Loss 0.146, Train_accy 95.20, Test_accy 66.30:  70%|███████   | 14/20 [05:33<01:56, 19.39s/it]
Task 6, Epoch 15/20 => Loss 0.146, Train_accy 95.20, Test_accy 66.30:  75%|███████▌  | 15/20 [05:33<02:09, 25.97s/it]
Task 6, Epoch 16/20 => Loss 0.196, Train_accy 93.55:  75%|███████▌  | 15/20 [05:51<02:09, 25.97s/it]                 
Task 6, Epoch 16/20 => Loss 0.196, Train_accy 93.55:  80%|████████  | 16/20 [05:51<01:33, 23.49s/it]
Task 6, Epoch 17/20 => Loss 0.167, Train_accy 95.20:  80%|████████  | 16/20 [06:09<01:33, 23.49s/it]
Task 6, Epoch 17/20 => Loss 0.167, Train_accy 95.20:  85%|████████▌ | 17/20 [06:09<01:05, 21.74s/it]
Task 6, Epoch 18/20 => Loss 0.191, Train_accy 93.79:  85%|████████▌ | 17/20 [06:27<01:05, 21.74s/it]
Task 6, Epoch 18/20 => Loss 0.191, Train_accy 93.79:  90%|█████████ | 18/20 [06:27<00:41, 20.56s/it]
Task 6, Epoch 19/20 => Loss 0.165, Train_accy 94.21:  90%|█████████ | 18/20 [06:44<00:41, 20.56s/it]
Task 6, Epoch 19/20 => Loss 0.165, Train_accy 94.21:  95%|█████████▌| 19/20 [06:44<00:19, 19.71s/it]
Task 6, Epoch 20/20 => Loss 0.159, Train_accy 94.92, Test_accy 66.82:  95%|█████████▌| 19/20 [07:25<00:19, 19.71s/it]
Task 6, Epoch 20/20 => Loss 0.159, Train_accy 94.92, Test_accy 66.82: 100%|██████████| 20/20 [07:25<00:00, 26.09s/it]
Task 6, Epoch 20/20 => Loss 0.159, Train_accy 94.92, Test_accy 66.82: 100%|██████████| 20/20 [07:25<00:00, 22.29s/it]
2024-09-12 11:08:52,116 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.159, Train_accy 94.92, Test_accy 66.82
2024-09-12 11:09:14,431 [trainer.py] => No NME accuracy.
2024-09-12 11:09:14,432 [trainer.py] => CNN: {'total': 66.82, '00-19': 74.89, '20-39': 74.05, '40-59': 64.03, '60-79': 61.65, '80-99': 61.19, '100-119': 65.3, '120-139': 63.8, 'old': 67.3, 'new': 63.8}
2024-09-12 11:09:14,432 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12, 70.9, 68.64, 67.65, 66.82]
2024-09-12 11:09:14,432 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02, 89.27, 87.04, 86.58, 85.45]

Average Accuracy (CNN): 72.49
2024-09-12 11:09:14,432 [trainer.py] => Average Accuracy (CNN): 72.49 

2024-09-12 11:09:14,435 [trainer.py] => All params: 172158352
2024-09-12 11:09:14,438 [trainer.py] => Trainable params: 407240
2024-09-12 11:09:14,438 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.395, Train_accy 61.15:   0%|          | 0/20 [00:23<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.395, Train_accy 61.15:   5%|▌         | 1/20 [00:23<07:20, 23.18s/it]
Task 7, Epoch 2/20 => Loss 0.609, Train_accy 82.39:   5%|▌         | 1/20 [00:46<07:20, 23.18s/it]
Task 7, Epoch 2/20 => Loss 0.609, Train_accy 82.39:  10%|█         | 2/20 [00:46<07:00, 23.36s/it]
Task 7, Epoch 3/20 => Loss 0.477, Train_accy 85.87:  10%|█         | 2/20 [01:10<07:00, 23.36s/it]
Task 7, Epoch 3/20 => Loss 0.477, Train_accy 85.87:  15%|█▌        | 3/20 [01:10<06:37, 23.39s/it]
Task 7, Epoch 4/20 => Loss 0.406, Train_accy 87.46:  15%|█▌        | 3/20 [01:33<06:37, 23.39s/it]
Task 7, Epoch 4/20 => Loss 0.406, Train_accy 87.46:  20%|██        | 4/20 [01:33<06:14, 23.42s/it]
Task 7, Epoch 5/20 => Loss 0.346, Train_accy 89.91, Test_accy 64.72:  20%|██        | 4/20 [02:24<06:14, 23.42s/it]
Task 7, Epoch 5/20 => Loss 0.346, Train_accy 89.91, Test_accy 64.72:  25%|██▌       | 5/20 [02:24<08:21, 33.41s/it]
Task 7, Epoch 6/20 => Loss 0.347, Train_accy 89.81:  25%|██▌       | 5/20 [02:48<08:21, 33.41s/it]                 
Task 7, Epoch 6/20 => Loss 0.347, Train_accy 89.81:  30%|███       | 6/20 [02:48<07:00, 30.07s/it]
Task 7, Epoch 7/20 => Loss 0.275, Train_accy 91.41:  30%|███       | 6/20 [03:10<07:00, 30.07s/it]
Task 7, Epoch 7/20 => Loss 0.275, Train_accy 91.41:  35%|███▌      | 7/20 [03:10<05:57, 27.48s/it]
Task 7, Epoch 8/20 => Loss 0.292, Train_accy 90.84:  35%|███▌      | 7/20 [03:33<05:57, 27.48s/it]
Task 7, Epoch 8/20 => Loss 0.292, Train_accy 90.84:  40%|████      | 8/20 [03:33<05:11, 25.94s/it]
Task 7, Epoch 9/20 => Loss 0.232, Train_accy 93.04:  40%|████      | 8/20 [03:56<05:11, 25.94s/it]
Task 7, Epoch 9/20 => Loss 0.232, Train_accy 93.04:  45%|████▌     | 9/20 [03:56<04:36, 25.12s/it]
Task 7, Epoch 10/20 => Loss 0.290, Train_accy 91.19, Test_accy 65.81:  45%|████▌     | 9/20 [04:47<04:36, 25.12s/it]
Task 7, Epoch 10/20 => Loss 0.290, Train_accy 91.19, Test_accy 65.81:  50%|█████     | 10/20 [04:47<05:30, 33.06s/it]
Task 7, Epoch 11/20 => Loss 0.256, Train_accy 91.76:  50%|█████     | 10/20 [05:10<05:30, 33.06s/it]                 
Task 7, Epoch 11/20 => Loss 0.256, Train_accy 91.76:  55%|█████▌    | 11/20 [05:10<04:31, 30.13s/it]
Task 7, Epoch 12/20 => Loss 0.245, Train_accy 91.97:  55%|█████▌    | 11/20 [05:34<04:31, 30.13s/it]
Task 7, Epoch 12/20 => Loss 0.245, Train_accy 91.97:  60%|██████    | 12/20 [05:34<03:44, 28.09s/it]
Task 7, Epoch 13/20 => Loss 0.229, Train_accy 92.97:  60%|██████    | 12/20 [05:57<03:44, 28.09s/it]
Task 7, Epoch 13/20 => Loss 0.229, Train_accy 92.97:  65%|██████▌   | 13/20 [05:57<03:06, 26.70s/it]
Task 7, Epoch 14/20 => Loss 0.229, Train_accy 92.61:  65%|██████▌   | 13/20 [06:20<03:06, 26.70s/it]
Task 7, Epoch 14/20 => Loss 0.229, Train_accy 92.61:  70%|███████   | 14/20 [06:20<02:32, 25.49s/it]
Task 7, Epoch 15/20 => Loss 0.225, Train_accy 92.54, Test_accy 66.52:  70%|███████   | 14/20 [07:09<02:32, 25.49s/it]
Task 7, Epoch 15/20 => Loss 0.225, Train_accy 92.54, Test_accy 66.52:  75%|███████▌  | 15/20 [07:09<02:43, 32.74s/it]
Task 7, Epoch 16/20 => Loss 0.206, Train_accy 92.97:  75%|███████▌  | 15/20 [07:33<02:43, 32.74s/it]                 
Task 7, Epoch 16/20 => Loss 0.206, Train_accy 92.97:  80%|████████  | 16/20 [07:33<02:00, 30.02s/it]
Task 7, Epoch 17/20 => Loss 0.233, Train_accy 92.05:  80%|████████  | 16/20 [07:56<02:00, 30.02s/it]
Task 7, Epoch 17/20 => Loss 0.233, Train_accy 92.05:  85%|████████▌ | 17/20 [07:56<01:24, 28.01s/it]
Task 7, Epoch 18/20 => Loss 0.202, Train_accy 93.61:  85%|████████▌ | 17/20 [08:20<01:24, 28.01s/it]
Task 7, Epoch 18/20 => Loss 0.202, Train_accy 93.61:  90%|█████████ | 18/20 [08:20<00:53, 26.64s/it]
Task 7, Epoch 19/20 => Loss 0.219, Train_accy 93.04:  90%|█████████ | 18/20 [08:44<00:53, 26.64s/it]
Task 7, Epoch 19/20 => Loss 0.219, Train_accy 93.04:  95%|█████████▌| 19/20 [08:44<00:25, 25.74s/it]
Task 7, Epoch 20/20 => Loss 0.180, Train_accy 93.86, Test_accy 68.42:  95%|█████████▌| 19/20 [09:34<00:25, 25.74s/it]
Task 7, Epoch 20/20 => Loss 0.180, Train_accy 93.86, Test_accy 68.42: 100%|██████████| 20/20 [09:34<00:00, 33.29s/it]
Task 7, Epoch 20/20 => Loss 0.180, Train_accy 93.86, Test_accy 68.42: 100%|██████████| 20/20 [09:34<00:00, 28.75s/it]
2024-09-12 11:18:49,383 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.180, Train_accy 93.86, Test_accy 68.42
2024-09-12 11:19:15,364 [trainer.py] => No NME accuracy.
2024-09-12 11:19:15,365 [trainer.py] => CNN: {'total': 68.42, '00-19': 76.92, '20-39': 74.84, '40-59': 65.35, '60-79': 63.22, '80-99': 62.63, '100-119': 65.3, '120-139': 65.03, '140-159': 70.78, 'old': 68.01, 'new': 70.78}
2024-09-12 11:19:15,365 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12, 70.9, 68.64, 67.65, 66.82, 68.42]
2024-09-12 11:19:15,365 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02, 89.27, 87.04, 86.58, 85.45, 86.08]

Average Accuracy (CNN): 71.98
2024-09-12 11:19:15,365 [trainer.py] => Average Accuracy (CNN): 71.98 

2024-09-12 11:19:15,369 [trainer.py] => All params: 172158352
2024-09-12 11:19:15,370 [trainer.py] => Trainable params: 407240
2024-09-12 11:19:15,370 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.758, Train_accy 51.75:   0%|          | 0/20 [00:16<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.758, Train_accy 51.75:   5%|▌         | 1/20 [00:16<05:06, 16.14s/it]
Task 8, Epoch 2/20 => Loss 0.749, Train_accy 78.64:   5%|▌         | 1/20 [00:32<05:06, 16.14s/it]
Task 8, Epoch 2/20 => Loss 0.749, Train_accy 78.64:  10%|█         | 2/20 [00:32<04:53, 16.30s/it]
Task 8, Epoch 3/20 => Loss 0.584, Train_accy 82.75:  10%|█         | 2/20 [00:48<04:53, 16.30s/it]
Task 8, Epoch 3/20 => Loss 0.584, Train_accy 82.75:  15%|█▌        | 3/20 [00:48<04:37, 16.33s/it]
Task 8, Epoch 4/20 => Loss 0.522, Train_accy 85.73:  15%|█▌        | 3/20 [01:05<04:37, 16.33s/it]
Task 8, Epoch 4/20 => Loss 0.522, Train_accy 85.73:  20%|██        | 4/20 [01:05<04:22, 16.38s/it]
Task 8, Epoch 5/20 => Loss 0.403, Train_accy 88.14, Test_accy 67.07:  20%|██        | 4/20 [01:52<04:22, 16.38s/it]
Task 8, Epoch 5/20 => Loss 0.403, Train_accy 88.14, Test_accy 67.07:  25%|██▌       | 5/20 [01:52<06:50, 27.38s/it]
Task 8, Epoch 6/20 => Loss 0.393, Train_accy 88.30:  25%|██▌       | 5/20 [02:08<06:50, 27.38s/it]                 
Task 8, Epoch 6/20 => Loss 0.393, Train_accy 88.30:  30%|███       | 6/20 [02:08<05:31, 23.68s/it]
Task 8, Epoch 7/20 => Loss 0.325, Train_accy 90.91:  30%|███       | 6/20 [02:25<05:31, 23.68s/it]
Task 8, Epoch 7/20 => Loss 0.325, Train_accy 90.91:  35%|███▌      | 7/20 [02:25<04:37, 21.32s/it]
Task 8, Epoch 8/20 => Loss 0.349, Train_accy 89.22:  35%|███▌      | 7/20 [02:41<04:37, 21.32s/it]
Task 8, Epoch 8/20 => Loss 0.349, Train_accy 89.22:  40%|████      | 8/20 [02:41<03:57, 19.76s/it]
Task 8, Epoch 9/20 => Loss 0.349, Train_accy 89.37:  40%|████      | 8/20 [02:57<03:57, 19.76s/it]
Task 8, Epoch 9/20 => Loss 0.349, Train_accy 89.37:  45%|████▌     | 9/20 [02:57<03:25, 18.66s/it]
Task 8, Epoch 10/20 => Loss 0.301, Train_accy 90.55, Test_accy 67.42:  45%|████▌     | 9/20 [03:42<03:25, 18.66s/it]
Task 8, Epoch 10/20 => Loss 0.301, Train_accy 90.55, Test_accy 67.42:  50%|█████     | 10/20 [03:42<04:28, 26.81s/it]
Task 8, Epoch 11/20 => Loss 0.312, Train_accy 90.35:  50%|█████     | 10/20 [03:59<04:28, 26.81s/it]                 
Task 8, Epoch 11/20 => Loss 0.312, Train_accy 90.35:  55%|█████▌    | 11/20 [03:59<03:32, 23.64s/it]
Task 8, Epoch 12/20 => Loss 0.289, Train_accy 90.61:  55%|█████▌    | 11/20 [04:15<03:32, 23.64s/it]
Task 8, Epoch 12/20 => Loss 0.289, Train_accy 90.61:  60%|██████    | 12/20 [04:15<02:51, 21.46s/it]
Task 8, Epoch 13/20 => Loss 0.267, Train_accy 91.79:  60%|██████    | 12/20 [04:32<02:51, 21.46s/it]
Task 8, Epoch 13/20 => Loss 0.267, Train_accy 91.79:  65%|██████▌   | 13/20 [04:32<02:19, 19.92s/it]
Task 8, Epoch 14/20 => Loss 0.258, Train_accy 92.20:  65%|██████▌   | 13/20 [04:48<02:19, 19.92s/it]
Task 8, Epoch 14/20 => Loss 0.258, Train_accy 92.20:  70%|███████   | 14/20 [04:48<01:53, 18.85s/it]
Task 8, Epoch 15/20 => Loss 0.256, Train_accy 91.79, Test_accy 67.83:  70%|███████   | 14/20 [05:35<01:53, 18.85s/it]
Task 8, Epoch 15/20 => Loss 0.256, Train_accy 91.79, Test_accy 67.83:  75%|███████▌  | 15/20 [05:35<02:16, 27.36s/it]
Task 8, Epoch 16/20 => Loss 0.243, Train_accy 92.86:  75%|███████▌  | 15/20 [05:52<02:16, 27.36s/it]                 
Task 8, Epoch 16/20 => Loss 0.243, Train_accy 92.86:  80%|████████  | 16/20 [05:52<01:36, 24.08s/it]
Task 8, Epoch 17/20 => Loss 0.232, Train_accy 92.25:  80%|████████  | 16/20 [06:08<01:36, 24.08s/it]
Task 8, Epoch 17/20 => Loss 0.232, Train_accy 92.25:  85%|████████▌ | 17/20 [06:08<01:05, 21.77s/it]
Task 8, Epoch 18/20 => Loss 0.212, Train_accy 93.02:  85%|████████▌ | 17/20 [06:24<01:05, 21.77s/it]
Task 8, Epoch 18/20 => Loss 0.212, Train_accy 93.02:  90%|█████████ | 18/20 [06:24<00:39, 19.95s/it]
Task 8, Epoch 19/20 => Loss 0.253, Train_accy 92.35:  90%|█████████ | 18/20 [06:39<00:39, 19.95s/it]
Task 8, Epoch 19/20 => Loss 0.253, Train_accy 92.35:  95%|█████████▌| 19/20 [06:39<00:18, 18.61s/it]
Task 8, Epoch 20/20 => Loss 0.241, Train_accy 92.61, Test_accy 67.64:  95%|█████████▌| 19/20 [07:26<00:18, 18.61s/it]
Task 8, Epoch 20/20 => Loss 0.241, Train_accy 92.61, Test_accy 67.64: 100%|██████████| 20/20 [07:26<00:00, 26.91s/it]
Task 8, Epoch 20/20 => Loss 0.241, Train_accy 92.61, Test_accy 67.64: 100%|██████████| 20/20 [07:26<00:00, 22.30s/it]
2024-09-12 11:26:41,410 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.241, Train_accy 92.61, Test_accy 67.64
2024-09-12 11:27:11,573 [trainer.py] => No NME accuracy.
2024-09-12 11:27:11,574 [trainer.py] => CNN: {'total': 67.64, '00-19': 76.63, '20-39': 74.21, '40-59': 64.52, '60-79': 62.7, '80-99': 62.63, '100-119': 64.7, '120-139': 64.85, '140-159': 71.19, '160-179': 62.97, 'old': 68.1, 'new': 62.97}
2024-09-12 11:27:11,574 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12, 70.9, 68.64, 67.65, 66.82, 68.42, 67.64]
2024-09-12 11:27:11,574 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02, 89.27, 87.04, 86.58, 85.45, 86.08, 85.19]

Average Accuracy (CNN): 71.5
2024-09-12 11:27:11,574 [trainer.py] => Average Accuracy (CNN): 71.5 

2024-09-12 11:27:11,577 [trainer.py] => All params: 172158352
2024-09-12 11:27:11,578 [trainer.py] => Trainable params: 407240
2024-09-12 11:27:11,578 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.507, Train_accy 58.68:   0%|          | 0/20 [00:19<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.507, Train_accy 58.68:   5%|▌         | 1/20 [00:19<06:03, 19.11s/it]
Task 9, Epoch 2/20 => Loss 0.626, Train_accy 81.54:   5%|▌         | 1/20 [00:38<06:03, 19.11s/it]
Task 9, Epoch 2/20 => Loss 0.626, Train_accy 81.54:  10%|█         | 2/20 [00:38<05:43, 19.09s/it]
Task 9, Epoch 3/20 => Loss 0.481, Train_accy 85.33:  10%|█         | 2/20 [00:57<05:43, 19.09s/it]
Task 9, Epoch 3/20 => Loss 0.481, Train_accy 85.33:  15%|█▌        | 3/20 [00:57<05:23, 19.02s/it]
Task 9, Epoch 4/20 => Loss 0.396, Train_accy 88.11:  15%|█▌        | 3/20 [01:16<05:23, 19.02s/it]
Task 9, Epoch 4/20 => Loss 0.396, Train_accy 88.11:  20%|██        | 4/20 [01:16<05:04, 19.04s/it]
Task 9, Epoch 5/20 => Loss 0.373, Train_accy 88.68, Test_accy 65.20:  20%|██        | 4/20 [02:07<05:04, 19.04s/it]
Task 9, Epoch 5/20 => Loss 0.373, Train_accy 88.68, Test_accy 65.20:  25%|██▌       | 5/20 [02:07<07:38, 30.59s/it]
Task 9, Epoch 6/20 => Loss 0.333, Train_accy 90.00:  25%|██▌       | 5/20 [02:25<07:38, 30.59s/it]                 
Task 9, Epoch 6/20 => Loss 0.333, Train_accy 90.00:  30%|███       | 6/20 [02:25<06:11, 26.56s/it]
Task 9, Epoch 7/20 => Loss 0.292, Train_accy 91.32:  30%|███       | 6/20 [02:45<06:11, 26.56s/it]
Task 9, Epoch 7/20 => Loss 0.292, Train_accy 91.32:  35%|███▌      | 7/20 [02:45<05:13, 24.15s/it]
Task 9, Epoch 8/20 => Loss 0.272, Train_accy 91.67:  35%|███▌      | 7/20 [03:04<05:13, 24.15s/it]
Task 9, Epoch 8/20 => Loss 0.272, Train_accy 91.67:  40%|████      | 8/20 [03:04<04:30, 22.54s/it]
Task 9, Epoch 9/20 => Loss 0.274, Train_accy 91.15:  40%|████      | 8/20 [03:23<04:30, 22.54s/it]
Task 9, Epoch 9/20 => Loss 0.274, Train_accy 91.15:  45%|████▌     | 9/20 [03:23<03:56, 21.48s/it]
Task 9, Epoch 10/20 => Loss 0.280, Train_accy 91.63, Test_accy 65.67:  45%|████▌     | 9/20 [04:16<03:56, 21.48s/it]
Task 9, Epoch 10/20 => Loss 0.280, Train_accy 91.63, Test_accy 65.67:  50%|█████     | 10/20 [04:16<05:11, 31.13s/it]
Task 9, Epoch 11/20 => Loss 0.260, Train_accy 92.25:  50%|█████     | 10/20 [04:35<05:11, 31.13s/it]                 
Task 9, Epoch 11/20 => Loss 0.260, Train_accy 92.25:  55%|█████▌    | 11/20 [04:35<04:07, 27.46s/it]
Task 9, Epoch 12/20 => Loss 0.268, Train_accy 91.63:  55%|█████▌    | 11/20 [04:54<04:07, 27.46s/it]
Task 9, Epoch 12/20 => Loss 0.268, Train_accy 91.63:  60%|██████    | 12/20 [04:54<03:19, 24.92s/it]
Task 9, Epoch 13/20 => Loss 0.221, Train_accy 92.73:  60%|██████    | 12/20 [05:12<03:19, 24.92s/it]
Task 9, Epoch 13/20 => Loss 0.221, Train_accy 92.73:  65%|██████▌   | 13/20 [05:12<02:39, 22.85s/it]
Task 9, Epoch 14/20 => Loss 0.220, Train_accy 93.00:  65%|██████▌   | 13/20 [05:30<02:39, 22.85s/it]
Task 9, Epoch 14/20 => Loss 0.220, Train_accy 93.00:  70%|███████   | 14/20 [05:30<02:08, 21.39s/it]
Task 9, Epoch 15/20 => Loss 0.215, Train_accy 93.26, Test_accy 66.05:  70%|███████   | 14/20 [06:23<02:08, 21.39s/it]
Task 9, Epoch 15/20 => Loss 0.215, Train_accy 93.26, Test_accy 66.05:  75%|███████▌  | 15/20 [06:23<02:34, 30.89s/it]
Task 9, Epoch 16/20 => Loss 0.208, Train_accy 93.66:  75%|███████▌  | 15/20 [06:42<02:34, 30.89s/it]                 
Task 9, Epoch 16/20 => Loss 0.208, Train_accy 93.66:  80%|████████  | 16/20 [06:42<01:49, 27.36s/it]
Task 9, Epoch 17/20 => Loss 0.215, Train_accy 92.82:  80%|████████  | 16/20 [07:01<01:49, 27.36s/it]
Task 9, Epoch 17/20 => Loss 0.215, Train_accy 92.82:  85%|████████▌ | 17/20 [07:01<01:14, 24.91s/it]
Task 9, Epoch 18/20 => Loss 0.181, Train_accy 93.70:  85%|████████▌ | 17/20 [07:21<01:14, 24.91s/it]
Task 9, Epoch 18/20 => Loss 0.181, Train_accy 93.70:  90%|█████████ | 18/20 [07:21<00:46, 23.19s/it]
Task 9, Epoch 19/20 => Loss 0.170, Train_accy 94.05:  90%|█████████ | 18/20 [07:40<00:46, 23.19s/it]
Task 9, Epoch 19/20 => Loss 0.170, Train_accy 94.05:  95%|█████████▌| 19/20 [07:40<00:21, 21.95s/it]
Task 9, Epoch 20/20 => Loss 0.191, Train_accy 94.19, Test_accy 66.22:  95%|█████████▌| 19/20 [08:31<00:21, 21.95s/it]
Task 9, Epoch 20/20 => Loss 0.191, Train_accy 94.19, Test_accy 66.22: 100%|██████████| 20/20 [08:31<00:00, 30.87s/it]
Task 9, Epoch 20/20 => Loss 0.191, Train_accy 94.19, Test_accy 66.22: 100%|██████████| 20/20 [08:31<00:00, 25.59s/it]
2024-09-12 11:35:43,304 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.191, Train_accy 94.19, Test_accy 66.22
2024-09-12 11:36:16,216 [trainer.py] => No NME accuracy.
2024-09-12 11:36:16,216 [trainer.py] => CNN: {'total': 66.22, '00-19': 76.2, '20-39': 73.58, '40-59': 64.03, '60-79': 62.52, '80-99': 61.81, '100-119': 63.64, '120-139': 63.8, '140-159': 69.82, '160-179': 61.09, '180-199': 60.97, 'old': 66.78, 'new': 60.97}
2024-09-12 11:36:16,216 [trainer.py] => CNN top1 curve: [82.58, 77.74, 73.12, 70.9, 68.64, 67.65, 66.82, 68.42, 67.64, 66.22]
2024-09-12 11:36:16,217 [trainer.py] => CNN top5 curve: [95.79, 93.11, 91.02, 89.27, 87.04, 86.58, 85.45, 86.08, 85.19, 84.68]

Average Accuracy (CNN): 70.97
2024-09-12 11:36:16,217 [trainer.py] => Average Accuracy (CNN): 70.97 

Accuracy Matrix (CNN):
[[82.58 79.83 77.79 78.37 77.65 75.33 74.89 76.92 76.63 76.2 ]
 [ 0.   75.47 73.73 73.26 72.31 73.58 74.05 74.84 74.21 73.58]
 [ 0.    0.   67.16 67.   65.68 64.19 64.03 65.35 64.52 64.03]
 [ 0.    0.    0.   63.4  63.05 62.87 61.65 63.22 62.7  62.52]
 [ 0.    0.    0.    0.   61.4  61.6  61.19 62.63 62.63 61.81]
 [ 0.    0.    0.    0.    0.   65.76 65.3  65.3  64.7  63.64]
 [ 0.    0.    0.    0.    0.    0.   63.8  65.03 64.85 63.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.   70.78 71.19 69.82]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   62.97 61.09]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   60.97]]
2024-09-12 11:36:16,218 [trainer.py] => Forgetting (CNN): 2.188888888888888
2024-09-12 11:36:19,220 [trainer.py] => config: ./exps/dualprompt_inr_B0_Inc20.json
2024-09-12 11:36:19,220 [trainer.py] => prefix:  
2024-09-12 11:36:19,220 [trainer.py] => dataset: imagenetr
2024-09-12 11:36:19,221 [trainer.py] => memory_size: 0
2024-09-12 11:36:19,221 [trainer.py] => memory_per_class: 0
2024-09-12 11:36:19,221 [trainer.py] => fixed_memory: False
2024-09-12 11:36:19,221 [trainer.py] => shuffle: True
2024-09-12 11:36:19,221 [trainer.py] => init_cls: 10
2024-09-12 11:36:19,221 [trainer.py] => increment: 10
2024-09-12 11:36:19,221 [trainer.py] => model_name: dualprompt
2024-09-12 11:36:19,221 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 11:36:19,221 [trainer.py] => get_original_backbone: True
2024-09-12 11:36:19,221 [trainer.py] => device: [device(type='cuda', index=4)]
2024-09-12 11:36:19,221 [trainer.py] => seed: 1993
2024-09-12 11:36:19,221 [trainer.py] => tuned_epoch: 20
2024-09-12 11:36:19,221 [trainer.py] => init_lr: 0.001
2024-09-12 11:36:19,221 [trainer.py] => batch_size: 48
2024-09-12 11:36:19,221 [trainer.py] => weight_decay: 0
2024-09-12 11:36:19,221 [trainer.py] => min_lr: 1e-05
2024-09-12 11:36:19,221 [trainer.py] => optimizer: adam
2024-09-12 11:36:19,221 [trainer.py] => scheduler: constant
2024-09-12 11:36:19,221 [trainer.py] => reinit_optimizer: True
2024-09-12 11:36:19,221 [trainer.py] => global_pool: token
2024-09-12 11:36:19,221 [trainer.py] => head_type: token
2024-09-12 11:36:19,221 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 11:36:19,221 [trainer.py] => pretrained: True
2024-09-12 11:36:19,221 [trainer.py] => drop: 0.0
2024-09-12 11:36:19,221 [trainer.py] => drop_path: 0.0
2024-09-12 11:36:19,221 [trainer.py] => use_g_prompt: True
2024-09-12 11:36:19,221 [trainer.py] => g_prompt_length: 5
2024-09-12 11:36:19,221 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 11:36:19,221 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 11:36:19,221 [trainer.py] => use_e_prompt: True
2024-09-12 11:36:19,221 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 11:36:19,221 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 11:36:19,221 [trainer.py] => prompt_pool: True
2024-09-12 11:36:19,221 [trainer.py] => size: 10
2024-09-12 11:36:19,221 [trainer.py] => length: 5
2024-09-12 11:36:19,222 [trainer.py] => top_k: 1
2024-09-12 11:36:19,222 [trainer.py] => initializer: uniform
2024-09-12 11:36:19,222 [trainer.py] => prompt_key: True
2024-09-12 11:36:19,222 [trainer.py] => prompt_key_init: uniform
2024-09-12 11:36:19,222 [trainer.py] => use_prompt_mask: True
2024-09-12 11:36:19,222 [trainer.py] => shared_prompt_pool: True
2024-09-12 11:36:19,222 [trainer.py] => shared_prompt_key: False
2024-09-12 11:36:19,222 [trainer.py] => batchwise_prompt: True
2024-09-12 11:36:19,222 [trainer.py] => embedding_key: cls
2024-09-12 11:36:19,222 [trainer.py] => predefined_key: 
2024-09-12 11:36:19,222 [trainer.py] => pull_constraint: True
2024-09-12 11:36:19,222 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 11:36:19,222 [trainer.py] => same_key_value: False
2024-09-12 11:36:19,304 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 11:36:22,828 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 11:36:22,828 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 11:36:22,828 [dualprompt.py] => g_prompt: 15360
2024-09-12 11:36:22,828 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 11:36:22,828 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 11:36:22,829 [dualprompt.py] => head.weight: 153600
2024-09-12 11:36:22,829 [dualprompt.py] => head.bias: 200
2024-09-12 11:36:22,830 [trainer.py] => All params: 172158352
2024-09-12 11:36:22,830 [trainer.py] => Trainable params: 407240
2024-09-12 11:36:22,831 [dualprompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.419, Train_accy 54.77:   0%|          | 0/20 [00:11<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.419, Train_accy 54.77:   5%|▌         | 1/20 [00:11<03:29, 11.02s/it]
Task 0, Epoch 2/20 => Loss 0.627, Train_accy 80.68:   5%|▌         | 1/20 [00:21<03:29, 11.02s/it]
Task 0, Epoch 2/20 => Loss 0.627, Train_accy 80.68:  10%|█         | 2/20 [00:21<03:17, 10.99s/it]
Task 0, Epoch 3/20 => Loss 0.475, Train_accy 85.73:  10%|█         | 2/20 [00:32<03:17, 10.99s/it]
Task 0, Epoch 3/20 => Loss 0.475, Train_accy 85.73:  15%|█▌        | 3/20 [00:32<03:06, 10.96s/it]
Task 0, Epoch 4/20 => Loss 0.430, Train_accy 85.96:  15%|█▌        | 3/20 [00:43<03:06, 10.96s/it]
Task 0, Epoch 4/20 => Loss 0.430, Train_accy 85.96:  20%|██        | 4/20 [00:43<02:55, 10.98s/it]
Task 0, Epoch 5/20 => Loss 0.360, Train_accy 89.06, Test_accy 88.64:  20%|██        | 4/20 [00:57<02:55, 10.98s/it]
Task 0, Epoch 5/20 => Loss 0.360, Train_accy 89.06, Test_accy 88.64:  25%|██▌       | 5/20 [00:57<02:56, 11.78s/it]
Task 0, Epoch 6/20 => Loss 0.302, Train_accy 90.22:  25%|██▌       | 5/20 [01:08<02:56, 11.78s/it]                 
Task 0, Epoch 6/20 => Loss 0.302, Train_accy 90.22:  30%|███       | 6/20 [01:08<02:41, 11.51s/it]
Task 0, Epoch 7/20 => Loss 0.306, Train_accy 90.77:  30%|███       | 6/20 [01:19<02:41, 11.51s/it]
Task 0, Epoch 7/20 => Loss 0.306, Train_accy 90.77:  35%|███▌      | 7/20 [01:19<02:27, 11.38s/it]
Task 0, Epoch 8/20 => Loss 0.291, Train_accy 90.38:  35%|███▌      | 7/20 [01:30<02:27, 11.38s/it]
Task 0, Epoch 8/20 => Loss 0.291, Train_accy 90.38:  40%|████      | 8/20 [01:30<02:15, 11.26s/it]
Task 0, Epoch 9/20 => Loss 0.294, Train_accy 90.38:  40%|████      | 8/20 [01:41<02:15, 11.26s/it]
Task 0, Epoch 9/20 => Loss 0.294, Train_accy 90.38:  45%|████▌     | 9/20 [01:41<02:03, 11.23s/it]
Task 0, Epoch 10/20 => Loss 0.268, Train_accy 90.61, Test_accy 88.96:  45%|████▌     | 9/20 [01:54<02:03, 11.23s/it]
Task 0, Epoch 10/20 => Loss 0.268, Train_accy 90.61, Test_accy 88.96:  50%|█████     | 10/20 [01:54<01:59, 11.92s/it]
Task 0, Epoch 11/20 => Loss 0.170, Train_accy 95.19:  50%|█████     | 10/20 [02:05<01:59, 11.92s/it]                 
Task 0, Epoch 11/20 => Loss 0.170, Train_accy 95.19:  55%|█████▌    | 11/20 [02:05<01:44, 11.63s/it]
Task 0, Epoch 12/20 => Loss 0.219, Train_accy 93.02:  55%|█████▌    | 11/20 [02:17<01:44, 11.63s/it]
Task 0, Epoch 12/20 => Loss 0.219, Train_accy 93.02:  60%|██████    | 12/20 [02:17<01:32, 11.51s/it]
Task 0, Epoch 13/20 => Loss 0.185, Train_accy 93.41:  60%|██████    | 12/20 [02:27<01:32, 11.51s/it]
Task 0, Epoch 13/20 => Loss 0.185, Train_accy 93.41:  65%|██████▌   | 13/20 [02:27<01:18, 11.22s/it]
Task 0, Epoch 14/20 => Loss 0.204, Train_accy 93.25:  65%|██████▌   | 13/20 [02:38<01:18, 11.22s/it]
Task 0, Epoch 14/20 => Loss 0.204, Train_accy 93.25:  70%|███████   | 14/20 [02:38<01:05, 10.98s/it]
Task 0, Epoch 15/20 => Loss 0.160, Train_accy 94.57, Test_accy 87.70:  70%|███████   | 14/20 [02:50<01:05, 10.98s/it]
Task 0, Epoch 15/20 => Loss 0.160, Train_accy 94.57, Test_accy 87.70:  75%|███████▌  | 15/20 [02:50<00:57, 11.45s/it]
Task 0, Epoch 16/20 => Loss 0.164, Train_accy 94.18:  75%|███████▌  | 15/20 [03:01<00:57, 11.45s/it]                 
Task 0, Epoch 16/20 => Loss 0.164, Train_accy 94.18:  80%|████████  | 16/20 [03:01<00:45, 11.32s/it]
Task 0, Epoch 17/20 => Loss 0.178, Train_accy 93.79:  80%|████████  | 16/20 [03:12<00:45, 11.32s/it]
Task 0, Epoch 17/20 => Loss 0.178, Train_accy 93.79:  85%|████████▌ | 17/20 [03:12<00:33, 11.32s/it]
Task 0, Epoch 18/20 => Loss 0.150, Train_accy 95.03:  85%|████████▌ | 17/20 [03:23<00:33, 11.32s/it]
Task 0, Epoch 18/20 => Loss 0.150, Train_accy 95.03:  90%|█████████ | 18/20 [03:23<00:22, 11.23s/it]
Task 0, Epoch 19/20 => Loss 0.201, Train_accy 93.10:  90%|█████████ | 18/20 [03:34<00:22, 11.23s/it]
Task 0, Epoch 19/20 => Loss 0.201, Train_accy 93.10:  95%|█████████▌| 19/20 [03:34<00:11, 11.16s/it]
Task 0, Epoch 20/20 => Loss 0.164, Train_accy 94.49, Test_accy 88.33:  95%|█████████▌| 19/20 [03:48<00:11, 11.16s/it]
Task 0, Epoch 20/20 => Loss 0.164, Train_accy 94.49, Test_accy 88.33: 100%|██████████| 20/20 [03:48<00:00, 11.81s/it]
Task 0, Epoch 20/20 => Loss 0.164, Train_accy 94.49, Test_accy 88.33: 100%|██████████| 20/20 [03:48<00:00, 11.41s/it]
2024-09-12 11:40:11,641 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.164, Train_accy 94.49, Test_accy 88.33
2024-09-12 11:40:13,925 [trainer.py] => No NME accuracy.
2024-09-12 11:40:13,925 [trainer.py] => CNN: {'total': 88.33, '00-09': 88.33, 'old': 0, 'new': 88.33}
2024-09-12 11:40:13,926 [trainer.py] => CNN top1 curve: [88.33]
2024-09-12 11:40:13,926 [trainer.py] => CNN top5 curve: [98.42]

Average Accuracy (CNN): 88.33
2024-09-12 11:40:13,926 [trainer.py] => Average Accuracy (CNN): 88.33 

2024-09-12 11:40:13,929 [trainer.py] => All params: 172158352
2024-09-12 11:40:13,931 [trainer.py] => Trainable params: 407240
2024-09-12 11:40:13,931 [dualprompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.328, Train_accy 57.82:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.328, Train_accy 57.82:   5%|▌         | 1/20 [00:12<04:03, 12.81s/it]
Task 1, Epoch 2/20 => Loss 0.507, Train_accy 83.17:   5%|▌         | 1/20 [00:25<04:03, 12.81s/it]
Task 1, Epoch 2/20 => Loss 0.507, Train_accy 83.17:  10%|█         | 2/20 [00:25<03:51, 12.85s/it]
Task 1, Epoch 3/20 => Loss 0.431, Train_accy 86.20:  10%|█         | 2/20 [00:38<03:51, 12.85s/it]
Task 1, Epoch 3/20 => Loss 0.431, Train_accy 86.20:  15%|█▌        | 3/20 [00:38<03:38, 12.84s/it]
Task 1, Epoch 4/20 => Loss 0.328, Train_accy 89.17:  15%|█▌        | 3/20 [00:51<03:38, 12.84s/it]
Task 1, Epoch 4/20 => Loss 0.328, Train_accy 89.17:  20%|██        | 4/20 [00:51<03:25, 12.84s/it]
Task 1, Epoch 5/20 => Loss 0.280, Train_accy 91.55, Test_accy 80.55:  20%|██        | 4/20 [01:08<03:25, 12.84s/it]
Task 1, Epoch 5/20 => Loss 0.280, Train_accy 91.55, Test_accy 80.55:  25%|██▌       | 5/20 [01:08<03:36, 14.45s/it]
Task 1, Epoch 6/20 => Loss 0.250, Train_accy 91.42:  25%|██▌       | 5/20 [01:21<03:36, 14.45s/it]                 
Task 1, Epoch 6/20 => Loss 0.250, Train_accy 91.42:  30%|███       | 6/20 [01:21<03:14, 13.88s/it]
Task 1, Epoch 7/20 => Loss 0.257, Train_accy 91.95:  30%|███       | 6/20 [01:34<03:14, 13.88s/it]
Task 1, Epoch 7/20 => Loss 0.257, Train_accy 91.95:  35%|███▌      | 7/20 [01:34<02:55, 13.51s/it]
Task 1, Epoch 8/20 => Loss 0.221, Train_accy 93.47:  35%|███▌      | 7/20 [01:47<02:55, 13.51s/it]
Task 1, Epoch 8/20 => Loss 0.221, Train_accy 93.47:  40%|████      | 8/20 [01:47<02:39, 13.30s/it]
Task 1, Epoch 9/20 => Loss 0.216, Train_accy 93.14:  40%|████      | 8/20 [01:59<02:39, 13.30s/it]
Task 1, Epoch 9/20 => Loss 0.216, Train_accy 93.14:  45%|████▌     | 9/20 [01:59<02:22, 12.97s/it]
Task 1, Epoch 10/20 => Loss 0.196, Train_accy 93.80, Test_accy 81.13:  45%|████▌     | 9/20 [02:15<02:22, 12.97s/it]
Task 1, Epoch 10/20 => Loss 0.196, Train_accy 93.80, Test_accy 81.13:  50%|█████     | 10/20 [02:15<02:20, 14.02s/it]
Task 1, Epoch 11/20 => Loss 0.187, Train_accy 93.80:  50%|█████     | 10/20 [02:28<02:20, 14.02s/it]                 
Task 1, Epoch 11/20 => Loss 0.187, Train_accy 93.80:  55%|█████▌    | 11/20 [02:28<02:01, 13.52s/it]
Task 1, Epoch 12/20 => Loss 0.189, Train_accy 93.99:  55%|█████▌    | 11/20 [02:40<02:01, 13.52s/it]
Task 1, Epoch 12/20 => Loss 0.189, Train_accy 93.99:  60%|██████    | 12/20 [02:40<01:46, 13.34s/it]
Task 1, Epoch 13/20 => Loss 0.192, Train_accy 93.53:  60%|██████    | 12/20 [02:53<01:46, 13.34s/it]
Task 1, Epoch 13/20 => Loss 0.192, Train_accy 93.53:  65%|██████▌   | 13/20 [02:53<01:32, 13.20s/it]
Task 1, Epoch 14/20 => Loss 0.183, Train_accy 93.53:  65%|██████▌   | 13/20 [03:06<01:32, 13.20s/it]
Task 1, Epoch 14/20 => Loss 0.183, Train_accy 93.53:  70%|███████   | 14/20 [03:06<01:18, 13.09s/it]
Task 1, Epoch 15/20 => Loss 0.163, Train_accy 94.72, Test_accy 81.13:  70%|███████   | 14/20 [03:23<01:18, 13.09s/it]
Task 1, Epoch 15/20 => Loss 0.163, Train_accy 94.72, Test_accy 81.13:  75%|███████▌  | 15/20 [03:23<01:11, 14.33s/it]
Task 1, Epoch 16/20 => Loss 0.182, Train_accy 94.13:  75%|███████▌  | 15/20 [03:36<01:11, 14.33s/it]                 
Task 1, Epoch 16/20 => Loss 0.182, Train_accy 94.13:  80%|████████  | 16/20 [03:36<00:55, 13.89s/it]
Task 1, Epoch 17/20 => Loss 0.138, Train_accy 94.85:  80%|████████  | 16/20 [03:49<00:55, 13.89s/it]
Task 1, Epoch 17/20 => Loss 0.138, Train_accy 94.85:  85%|████████▌ | 17/20 [03:49<00:40, 13.58s/it]
Task 1, Epoch 18/20 => Loss 0.165, Train_accy 94.65:  85%|████████▌ | 17/20 [04:02<00:40, 13.58s/it]
Task 1, Epoch 18/20 => Loss 0.165, Train_accy 94.65:  90%|█████████ | 18/20 [04:02<00:26, 13.35s/it]
Task 1, Epoch 19/20 => Loss 0.140, Train_accy 95.64:  90%|█████████ | 18/20 [04:15<00:26, 13.35s/it]
Task 1, Epoch 19/20 => Loss 0.140, Train_accy 95.64:  95%|█████████▌| 19/20 [04:15<00:13, 13.23s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 94.65, Test_accy 83.89:  95%|█████████▌| 19/20 [04:32<00:13, 13.23s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 94.65, Test_accy 83.89: 100%|██████████| 20/20 [04:32<00:00, 14.41s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 94.65, Test_accy 83.89: 100%|██████████| 20/20 [04:32<00:00, 13.63s/it]
2024-09-12 11:44:46,464 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.130, Train_accy 94.65, Test_accy 83.89
2024-09-12 11:44:50,783 [trainer.py] => No NME accuracy.
2024-09-12 11:44:50,784 [trainer.py] => CNN: {'total': 83.89, '00-09': 82.65, '10-19': 84.95, 'old': 82.65, 'new': 84.95}
2024-09-12 11:44:50,784 [trainer.py] => CNN top1 curve: [88.33, 83.89]
2024-09-12 11:44:50,784 [trainer.py] => CNN top5 curve: [98.42, 95.5]

Average Accuracy (CNN): 86.11
2024-09-12 11:44:50,784 [trainer.py] => Average Accuracy (CNN): 86.11 

2024-09-12 11:44:50,786 [trainer.py] => All params: 172158352
2024-09-12 11:44:50,788 [trainer.py] => Trainable params: 407240
2024-09-12 11:44:50,788 [dualprompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.467, Train_accy 53.19:   0%|          | 0/20 [00:10<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.467, Train_accy 53.19:   5%|▌         | 1/20 [00:10<03:21, 10.60s/it]
Task 2, Epoch 2/20 => Loss 0.601, Train_accy 80.93:   5%|▌         | 1/20 [00:21<03:21, 10.60s/it]
Task 2, Epoch 2/20 => Loss 0.601, Train_accy 80.93:  10%|█         | 2/20 [00:21<03:09, 10.52s/it]
Task 2, Epoch 3/20 => Loss 0.437, Train_accy 86.91:  10%|█         | 2/20 [00:31<03:09, 10.52s/it]
Task 2, Epoch 3/20 => Loss 0.437, Train_accy 86.91:  15%|█▌        | 3/20 [00:31<02:59, 10.54s/it]
Task 2, Epoch 4/20 => Loss 0.382, Train_accy 88.30:  15%|█▌        | 3/20 [00:41<02:59, 10.54s/it]
Task 2, Epoch 4/20 => Loss 0.382, Train_accy 88.30:  20%|██        | 4/20 [00:41<02:45, 10.36s/it]
Task 2, Epoch 5/20 => Loss 0.333, Train_accy 90.34, Test_accy 78.06:  20%|██        | 4/20 [00:57<02:45, 10.36s/it]
Task 2, Epoch 5/20 => Loss 0.333, Train_accy 90.34, Test_accy 78.06:  25%|██▌       | 5/20 [00:57<03:03, 12.24s/it]
Task 2, Epoch 6/20 => Loss 0.305, Train_accy 90.43:  25%|██▌       | 5/20 [01:07<03:03, 12.24s/it]                 
Task 2, Epoch 6/20 => Loss 0.305, Train_accy 90.43:  30%|███       | 6/20 [01:07<02:40, 11.47s/it]
Task 2, Epoch 7/20 => Loss 0.258, Train_accy 91.90:  30%|███       | 6/20 [01:17<02:40, 11.47s/it]
Task 2, Epoch 7/20 => Loss 0.258, Train_accy 91.90:  35%|███▌      | 7/20 [01:17<02:24, 11.12s/it]
Task 2, Epoch 8/20 => Loss 0.233, Train_accy 92.55:  35%|███▌      | 7/20 [01:28<02:24, 11.12s/it]
Task 2, Epoch 8/20 => Loss 0.233, Train_accy 92.55:  40%|████      | 8/20 [01:28<02:11, 10.93s/it]
Task 2, Epoch 9/20 => Loss 0.238, Train_accy 91.73:  40%|████      | 8/20 [01:38<02:11, 10.93s/it]
Task 2, Epoch 9/20 => Loss 0.238, Train_accy 91.73:  45%|████▌     | 9/20 [01:38<01:59, 10.83s/it]
Task 2, Epoch 10/20 => Loss 0.199, Train_accy 93.94, Test_accy 79.37:  45%|████▌     | 9/20 [01:55<01:59, 10.83s/it]
Task 2, Epoch 10/20 => Loss 0.199, Train_accy 93.94, Test_accy 79.37:  50%|█████     | 10/20 [01:55<02:05, 12.57s/it]
Task 2, Epoch 11/20 => Loss 0.202, Train_accy 93.78:  50%|█████     | 10/20 [02:05<02:05, 12.57s/it]                 
Task 2, Epoch 11/20 => Loss 0.202, Train_accy 93.78:  55%|█████▌    | 11/20 [02:05<01:47, 11.97s/it]
Task 2, Epoch 12/20 => Loss 0.203, Train_accy 93.13:  55%|█████▌    | 11/20 [02:16<01:47, 11.97s/it]
Task 2, Epoch 12/20 => Loss 0.203, Train_accy 93.13:  60%|██████    | 12/20 [02:16<01:32, 11.52s/it]
Task 2, Epoch 13/20 => Loss 0.204, Train_accy 93.45:  60%|██████    | 12/20 [02:26<01:32, 11.52s/it]
Task 2, Epoch 13/20 => Loss 0.204, Train_accy 93.45:  65%|██████▌   | 13/20 [02:26<01:18, 11.23s/it]
Task 2, Epoch 14/20 => Loss 0.168, Train_accy 94.68:  65%|██████▌   | 13/20 [02:37<01:18, 11.23s/it]
Task 2, Epoch 14/20 => Loss 0.168, Train_accy 94.68:  70%|███████   | 14/20 [02:37<01:06, 11.02s/it]
Task 2, Epoch 15/20 => Loss 0.191, Train_accy 93.86, Test_accy 79.07:  70%|███████   | 14/20 [02:54<01:06, 11.02s/it]
Task 2, Epoch 15/20 => Loss 0.191, Train_accy 93.86, Test_accy 79.07:  75%|███████▌  | 15/20 [02:54<01:03, 12.72s/it]
Task 2, Epoch 16/20 => Loss 0.157, Train_accy 95.01:  75%|███████▌  | 15/20 [03:04<01:03, 12.72s/it]                 
Task 2, Epoch 16/20 => Loss 0.157, Train_accy 95.01:  80%|████████  | 16/20 [03:04<00:48, 12.08s/it]
Task 2, Epoch 17/20 => Loss 0.175, Train_accy 94.19:  80%|████████  | 16/20 [03:15<00:48, 12.08s/it]
Task 2, Epoch 17/20 => Loss 0.175, Train_accy 94.19:  85%|████████▌ | 17/20 [03:15<00:35, 11.68s/it]
Task 2, Epoch 18/20 => Loss 0.173, Train_accy 93.86:  85%|████████▌ | 17/20 [03:25<00:35, 11.68s/it]
Task 2, Epoch 18/20 => Loss 0.173, Train_accy 93.86:  90%|█████████ | 18/20 [03:25<00:22, 11.29s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 95.91:  90%|█████████ | 18/20 [03:36<00:22, 11.29s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 95.91:  95%|█████████▌| 19/20 [03:36<00:11, 11.04s/it]
Task 2, Epoch 20/20 => Loss 0.160, Train_accy 94.84, Test_accy 79.58:  95%|█████████▌| 19/20 [03:52<00:11, 11.04s/it]
Task 2, Epoch 20/20 => Loss 0.160, Train_accy 94.84, Test_accy 79.58: 100%|██████████| 20/20 [03:52<00:00, 12.67s/it]
Task 2, Epoch 20/20 => Loss 0.160, Train_accy 94.84, Test_accy 79.58: 100%|██████████| 20/20 [03:52<00:00, 11.64s/it]
2024-09-12 11:48:43,555 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.160, Train_accy 94.84, Test_accy 79.58
2024-09-12 11:48:49,190 [trainer.py] => No NME accuracy.
2024-09-12 11:48:49,190 [trainer.py] => CNN: {'total': 79.58, '00-09': 80.44, '10-19': 83.06, '20-29': 74.33, 'old': 81.86, 'new': 74.33}
2024-09-12 11:48:49,190 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58]
2024-09-12 11:48:49,190 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12]

Average Accuracy (CNN): 83.93
2024-09-12 11:48:49,191 [trainer.py] => Average Accuracy (CNN): 83.93 

2024-09-12 11:48:49,192 [trainer.py] => All params: 172158352
2024-09-12 11:48:49,193 [trainer.py] => Trainable params: 407240
2024-09-12 11:48:49,193 [dualprompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.405, Train_accy 55.22:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.405, Train_accy 55.22:   5%|▌         | 1/20 [00:10<03:25, 10.79s/it]
Task 3, Epoch 2/20 => Loss 0.532, Train_accy 81.87:   5%|▌         | 1/20 [00:21<03:25, 10.79s/it]
Task 3, Epoch 2/20 => Loss 0.532, Train_accy 81.87:  10%|█         | 2/20 [00:21<03:13, 10.76s/it]
Task 3, Epoch 3/20 => Loss 0.409, Train_accy 86.34:  10%|█         | 2/20 [00:32<03:13, 10.76s/it]
Task 3, Epoch 3/20 => Loss 0.409, Train_accy 86.34:  15%|█▌        | 3/20 [00:32<03:05, 10.93s/it]
Task 3, Epoch 4/20 => Loss 0.333, Train_accy 88.51:  15%|█▌        | 3/20 [00:44<03:05, 10.93s/it]
Task 3, Epoch 4/20 => Loss 0.333, Train_accy 88.51:  20%|██        | 4/20 [00:44<02:58, 11.14s/it]
Task 3, Epoch 5/20 => Loss 0.296, Train_accy 90.60, Test_accy 75.70:  20%|██        | 4/20 [01:03<02:58, 11.14s/it]
Task 3, Epoch 5/20 => Loss 0.296, Train_accy 90.60, Test_accy 75.70:  25%|██▌       | 5/20 [01:03<03:30, 14.00s/it]
Task 3, Epoch 6/20 => Loss 0.313, Train_accy 89.63:  25%|██▌       | 5/20 [01:14<03:30, 14.00s/it]                 
Task 3, Epoch 6/20 => Loss 0.313, Train_accy 89.63:  30%|███       | 6/20 [01:14<03:04, 13.17s/it]
Task 3, Epoch 7/20 => Loss 0.270, Train_accy 91.34:  30%|███       | 6/20 [01:26<03:04, 13.17s/it]
Task 3, Epoch 7/20 => Loss 0.270, Train_accy 91.34:  35%|███▌      | 7/20 [01:26<02:43, 12.59s/it]
Task 3, Epoch 8/20 => Loss 0.235, Train_accy 91.94:  35%|███▌      | 7/20 [01:37<02:43, 12.59s/it]
Task 3, Epoch 8/20 => Loss 0.235, Train_accy 91.94:  40%|████      | 8/20 [01:37<02:26, 12.23s/it]
Task 3, Epoch 9/20 => Loss 0.244, Train_accy 91.42:  40%|████      | 8/20 [01:49<02:26, 12.23s/it]
Task 3, Epoch 9/20 => Loss 0.244, Train_accy 91.42:  45%|████▌     | 9/20 [01:49<02:11, 11.98s/it]
Task 3, Epoch 10/20 => Loss 0.217, Train_accy 91.94, Test_accy 76.91:  45%|████▌     | 9/20 [02:08<02:11, 11.98s/it]
Task 3, Epoch 10/20 => Loss 0.217, Train_accy 91.94, Test_accy 76.91:  50%|█████     | 10/20 [02:08<02:22, 14.21s/it]
Task 3, Epoch 11/20 => Loss 0.187, Train_accy 94.33:  50%|█████     | 10/20 [02:19<02:22, 14.21s/it]                 
Task 3, Epoch 11/20 => Loss 0.187, Train_accy 94.33:  55%|█████▌    | 11/20 [02:19<02:00, 13.33s/it]
Task 3, Epoch 12/20 => Loss 0.184, Train_accy 93.73:  55%|█████▌    | 11/20 [02:31<02:00, 13.33s/it]
Task 3, Epoch 12/20 => Loss 0.184, Train_accy 93.73:  60%|██████    | 12/20 [02:31<01:42, 12.75s/it]
Task 3, Epoch 13/20 => Loss 0.199, Train_accy 93.58:  60%|██████    | 12/20 [02:42<01:42, 12.75s/it]
Task 3, Epoch 13/20 => Loss 0.199, Train_accy 93.58:  65%|██████▌   | 13/20 [02:42<01:26, 12.38s/it]
Task 3, Epoch 14/20 => Loss 0.186, Train_accy 93.51:  65%|██████▌   | 13/20 [02:54<01:26, 12.38s/it]
Task 3, Epoch 14/20 => Loss 0.186, Train_accy 93.51:  70%|███████   | 14/20 [02:54<01:12, 12.11s/it]
Task 3, Epoch 15/20 => Loss 0.184, Train_accy 94.40, Test_accy 77.29:  70%|███████   | 14/20 [03:13<01:12, 12.11s/it]
Task 3, Epoch 15/20 => Loss 0.184, Train_accy 94.40, Test_accy 77.29:  75%|███████▌  | 15/20 [03:13<01:11, 14.24s/it]
Task 3, Epoch 16/20 => Loss 0.178, Train_accy 94.40:  75%|███████▌  | 15/20 [03:23<01:11, 14.24s/it]                 
Task 3, Epoch 16/20 => Loss 0.178, Train_accy 94.40:  80%|████████  | 16/20 [03:23<00:52, 13.19s/it]
Task 3, Epoch 17/20 => Loss 0.216, Train_accy 92.99:  80%|████████  | 16/20 [03:34<00:52, 13.19s/it]
Task 3, Epoch 17/20 => Loss 0.216, Train_accy 92.99:  85%|████████▌ | 17/20 [03:34<00:37, 12.48s/it]
Task 3, Epoch 18/20 => Loss 0.172, Train_accy 94.10:  85%|████████▌ | 17/20 [03:45<00:37, 12.48s/it]
Task 3, Epoch 18/20 => Loss 0.172, Train_accy 94.10:  90%|█████████ | 18/20 [03:45<00:23, 11.93s/it]
Task 3, Epoch 19/20 => Loss 0.213, Train_accy 92.54:  90%|█████████ | 18/20 [03:56<00:23, 11.93s/it]
Task 3, Epoch 19/20 => Loss 0.213, Train_accy 92.54:  95%|█████████▌| 19/20 [03:56<00:11, 11.74s/it]
Task 3, Epoch 20/20 => Loss 0.165, Train_accy 94.48, Test_accy 77.29:  95%|█████████▌| 19/20 [04:15<00:11, 11.74s/it]
Task 3, Epoch 20/20 => Loss 0.165, Train_accy 94.48, Test_accy 77.29: 100%|██████████| 20/20 [04:15<00:00, 13.98s/it]
Task 3, Epoch 20/20 => Loss 0.165, Train_accy 94.48, Test_accy 77.29: 100%|██████████| 20/20 [04:15<00:00, 12.80s/it]
2024-09-12 11:53:05,109 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.165, Train_accy 94.48, Test_accy 77.29
2024-09-12 11:53:12,794 [trainer.py] => No NME accuracy.
2024-09-12 11:53:12,795 [trainer.py] => CNN: {'total': 77.29, '00-09': 78.55, '10-19': 79.84, '20-29': 71.33, '30-39': 78.61, 'old': 76.85, 'new': 78.61}
2024-09-12 11:53:12,795 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29]
2024-09-12 11:53:12,795 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28]

Average Accuracy (CNN): 82.27
2024-09-12 11:53:12,795 [trainer.py] => Average Accuracy (CNN): 82.27 

2024-09-12 11:53:12,798 [trainer.py] => All params: 172158352
2024-09-12 11:53:12,800 [trainer.py] => Trainable params: 407240
2024-09-12 11:53:12,800 [dualprompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.765, Train_accy 46.41:   0%|          | 0/20 [00:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.765, Train_accy 46.41:   5%|▌         | 1/20 [00:09<03:03,  9.67s/it]
Task 4, Epoch 2/20 => Loss 0.698, Train_accy 77.57:   5%|▌         | 1/20 [00:19<03:03,  9.67s/it]
Task 4, Epoch 2/20 => Loss 0.698, Train_accy 77.57:  10%|█         | 2/20 [00:19<02:52,  9.56s/it]
Task 4, Epoch 3/20 => Loss 0.542, Train_accy 82.20:  10%|█         | 2/20 [00:28<02:52,  9.56s/it]
Task 4, Epoch 3/20 => Loss 0.542, Train_accy 82.20:  15%|█▌        | 3/20 [00:28<02:41,  9.51s/it]
Task 4, Epoch 4/20 => Loss 0.389, Train_accy 87.19:  15%|█▌        | 3/20 [00:38<02:41,  9.51s/it]
Task 4, Epoch 4/20 => Loss 0.389, Train_accy 87.19:  20%|██        | 4/20 [00:38<02:32,  9.51s/it]
Task 4, Epoch 5/20 => Loss 0.350, Train_accy 88.92, Test_accy 73.20:  20%|██        | 4/20 [00:56<02:32,  9.51s/it]
Task 4, Epoch 5/20 => Loss 0.350, Train_accy 88.92, Test_accy 73.20:  25%|██▌       | 5/20 [00:56<03:12, 12.86s/it]
Task 4, Epoch 6/20 => Loss 0.335, Train_accy 89.46:  25%|██▌       | 5/20 [01:06<03:12, 12.86s/it]                 
Task 4, Epoch 6/20 => Loss 0.335, Train_accy 89.46:  30%|███       | 6/20 [01:06<02:44, 11.77s/it]
Task 4, Epoch 7/20 => Loss 0.320, Train_accy 89.10:  30%|███       | 6/20 [01:15<02:44, 11.77s/it]
Task 4, Epoch 7/20 => Loss 0.320, Train_accy 89.10:  35%|███▌      | 7/20 [01:15<02:22, 10.98s/it]
Task 4, Epoch 8/20 => Loss 0.280, Train_accy 90.28:  35%|███▌      | 7/20 [01:25<02:22, 10.98s/it]
Task 4, Epoch 8/20 => Loss 0.280, Train_accy 90.28:  40%|████      | 8/20 [01:25<02:05, 10.48s/it]
Task 4, Epoch 9/20 => Loss 0.257, Train_accy 92.01:  40%|████      | 8/20 [01:34<02:05, 10.48s/it]
Task 4, Epoch 9/20 => Loss 0.257, Train_accy 92.01:  45%|████▌     | 9/20 [01:34<01:51, 10.17s/it]
Task 4, Epoch 10/20 => Loss 0.272, Train_accy 91.73, Test_accy 74.18:  45%|████▌     | 9/20 [01:54<01:51, 10.17s/it]
Task 4, Epoch 10/20 => Loss 0.272, Train_accy 91.73, Test_accy 74.18:  50%|█████     | 10/20 [01:54<02:09, 12.96s/it]
Task 4, Epoch 11/20 => Loss 0.231, Train_accy 92.10:  50%|█████     | 10/20 [02:03<02:09, 12.96s/it]                 
Task 4, Epoch 11/20 => Loss 0.231, Train_accy 92.10:  55%|█████▌    | 11/20 [02:03<01:47, 11.89s/it]
Task 4, Epoch 12/20 => Loss 0.259, Train_accy 91.64:  55%|█████▌    | 11/20 [02:12<01:47, 11.89s/it]
Task 4, Epoch 12/20 => Loss 0.259, Train_accy 91.64:  60%|██████    | 12/20 [02:12<01:28, 11.10s/it]
Task 4, Epoch 13/20 => Loss 0.207, Train_accy 93.19:  60%|██████    | 12/20 [02:21<01:28, 11.10s/it]
Task 4, Epoch 13/20 => Loss 0.207, Train_accy 93.19:  65%|██████▌   | 13/20 [02:21<01:12, 10.41s/it]
Task 4, Epoch 14/20 => Loss 0.250, Train_accy 92.46:  65%|██████▌   | 13/20 [02:30<01:12, 10.41s/it]
Task 4, Epoch 14/20 => Loss 0.250, Train_accy 92.46:  70%|███████   | 14/20 [02:30<00:59,  9.95s/it]
Task 4, Epoch 15/20 => Loss 0.189, Train_accy 93.64, Test_accy 74.37:  70%|███████   | 14/20 [02:48<00:59,  9.95s/it]
Task 4, Epoch 15/20 => Loss 0.189, Train_accy 93.64, Test_accy 74.37:  75%|███████▌  | 15/20 [02:48<01:01, 12.35s/it]
Task 4, Epoch 16/20 => Loss 0.160, Train_accy 95.10:  75%|███████▌  | 15/20 [02:57<01:01, 12.35s/it]                 
Task 4, Epoch 16/20 => Loss 0.160, Train_accy 95.10:  80%|████████  | 16/20 [02:57<00:45, 11.46s/it]
Task 4, Epoch 17/20 => Loss 0.194, Train_accy 93.73:  80%|████████  | 16/20 [03:07<00:45, 11.46s/it]
Task 4, Epoch 17/20 => Loss 0.194, Train_accy 93.73:  85%|████████▌ | 17/20 [03:07<00:32, 10.87s/it]
Task 4, Epoch 18/20 => Loss 0.166, Train_accy 94.37:  85%|████████▌ | 17/20 [03:16<00:32, 10.87s/it]
Task 4, Epoch 18/20 => Loss 0.166, Train_accy 94.37:  90%|█████████ | 18/20 [03:16<00:20, 10.43s/it]
Task 4, Epoch 19/20 => Loss 0.140, Train_accy 95.19:  90%|█████████ | 18/20 [03:26<00:20, 10.43s/it]
Task 4, Epoch 19/20 => Loss 0.140, Train_accy 95.19:  95%|█████████▌| 19/20 [03:26<00:10, 10.16s/it]
Task 4, Epoch 20/20 => Loss 0.156, Train_accy 94.64, Test_accy 74.61:  95%|█████████▌| 19/20 [03:45<00:10, 10.16s/it]
Task 4, Epoch 20/20 => Loss 0.156, Train_accy 94.64, Test_accy 74.61: 100%|██████████| 20/20 [03:45<00:00, 12.77s/it]
Task 4, Epoch 20/20 => Loss 0.156, Train_accy 94.64, Test_accy 74.61: 100%|██████████| 20/20 [03:45<00:00, 11.25s/it]
2024-09-12 11:56:57,906 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.156, Train_accy 94.64, Test_accy 74.61
2024-09-12 11:57:07,335 [trainer.py] => No NME accuracy.
2024-09-12 11:57:07,335 [trainer.py] => CNN: {'total': 74.61, '00-09': 75.08, '10-19': 80.38, '20-29': 71.67, '30-39': 78.31, '40-49': 65.89, 'old': 76.61, 'new': 65.89}
2024-09-12 11:57:07,336 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61]
2024-09-12 11:57:07,336 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96]

Average Accuracy (CNN): 80.74
2024-09-12 11:57:07,336 [trainer.py] => Average Accuracy (CNN): 80.74 

2024-09-12 11:57:07,338 [trainer.py] => All params: 172158352
2024-09-12 11:57:07,340 [trainer.py] => Trainable params: 407240
2024-09-12 11:57:07,340 [dualprompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.500, Train_accy 53.22:   0%|          | 0/20 [00:10<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.500, Train_accy 53.22:   5%|▌         | 1/20 [00:10<03:21, 10.60s/it]
Task 5, Epoch 2/20 => Loss 0.594, Train_accy 81.56:   5%|▌         | 1/20 [00:21<03:21, 10.60s/it]
Task 5, Epoch 2/20 => Loss 0.594, Train_accy 81.56:  10%|█         | 2/20 [00:21<03:10, 10.58s/it]
Task 5, Epoch 3/20 => Loss 0.481, Train_accy 83.90:  10%|█         | 2/20 [00:31<03:10, 10.58s/it]
Task 5, Epoch 3/20 => Loss 0.481, Train_accy 83.90:  15%|█▌        | 3/20 [00:31<03:00, 10.62s/it]
Task 5, Epoch 4/20 => Loss 0.371, Train_accy 88.65:  15%|█▌        | 3/20 [00:42<03:00, 10.62s/it]
Task 5, Epoch 4/20 => Loss 0.371, Train_accy 88.65:  20%|██        | 4/20 [00:42<02:49, 10.61s/it]
Task 5, Epoch 5/20 => Loss 0.321, Train_accy 90.02, Test_accy 70.99:  20%|██        | 4/20 [01:04<02:49, 10.61s/it]
Task 5, Epoch 5/20 => Loss 0.321, Train_accy 90.02, Test_accy 70.99:  25%|██▌       | 5/20 [01:04<03:39, 14.66s/it]
Task 5, Epoch 6/20 => Loss 0.282, Train_accy 90.98:  25%|██▌       | 5/20 [01:14<03:39, 14.66s/it]                 
Task 5, Epoch 6/20 => Loss 0.282, Train_accy 90.98:  30%|███       | 6/20 [01:14<03:06, 13.31s/it]
Task 5, Epoch 7/20 => Loss 0.274, Train_accy 91.63:  30%|███       | 6/20 [01:25<03:06, 13.31s/it]
Task 5, Epoch 7/20 => Loss 0.274, Train_accy 91.63:  35%|███▌      | 7/20 [01:25<02:41, 12.43s/it]
Task 5, Epoch 8/20 => Loss 0.255, Train_accy 91.47:  35%|███▌      | 7/20 [01:36<02:41, 12.43s/it]
Task 5, Epoch 8/20 => Loss 0.255, Train_accy 91.47:  40%|████      | 8/20 [01:36<02:22, 11.86s/it]
Task 5, Epoch 9/20 => Loss 0.224, Train_accy 92.19:  40%|████      | 8/20 [01:46<02:22, 11.86s/it]
Task 5, Epoch 9/20 => Loss 0.224, Train_accy 92.19:  45%|████▌     | 9/20 [01:46<02:03, 11.26s/it]
Task 5, Epoch 10/20 => Loss 0.222, Train_accy 92.91, Test_accy 72.24:  45%|████▌     | 9/20 [02:06<02:03, 11.26s/it]
Task 5, Epoch 10/20 => Loss 0.222, Train_accy 92.91, Test_accy 72.24:  50%|█████     | 10/20 [02:06<02:21, 14.14s/it]
Task 5, Epoch 11/20 => Loss 0.204, Train_accy 93.24:  50%|█████     | 10/20 [02:17<02:21, 14.14s/it]                 
Task 5, Epoch 11/20 => Loss 0.204, Train_accy 93.24:  55%|█████▌    | 11/20 [02:17<01:57, 13.01s/it]
Task 5, Epoch 12/20 => Loss 0.208, Train_accy 92.59:  55%|█████▌    | 11/20 [02:27<01:57, 13.01s/it]
Task 5, Epoch 12/20 => Loss 0.208, Train_accy 92.59:  60%|██████    | 12/20 [02:27<01:38, 12.32s/it]
Task 5, Epoch 13/20 => Loss 0.189, Train_accy 93.56:  60%|██████    | 12/20 [02:38<01:38, 12.32s/it]
Task 5, Epoch 13/20 => Loss 0.189, Train_accy 93.56:  65%|██████▌   | 13/20 [02:38<01:22, 11.82s/it]
Task 5, Epoch 14/20 => Loss 0.177, Train_accy 94.28:  65%|██████▌   | 13/20 [02:49<01:22, 11.82s/it]
Task 5, Epoch 14/20 => Loss 0.177, Train_accy 94.28:  70%|███████   | 14/20 [02:49<01:08, 11.46s/it]
Task 5, Epoch 15/20 => Loss 0.185, Train_accy 93.48, Test_accy 71.72:  70%|███████   | 14/20 [03:10<01:08, 11.46s/it]
Task 5, Epoch 15/20 => Loss 0.185, Train_accy 93.48, Test_accy 71.72:  75%|███████▌  | 15/20 [03:10<01:12, 14.52s/it]
Task 5, Epoch 16/20 => Loss 0.177, Train_accy 94.36:  75%|███████▌  | 15/20 [03:21<01:12, 14.52s/it]                 
Task 5, Epoch 16/20 => Loss 0.177, Train_accy 94.36:  80%|████████  | 16/20 [03:21<00:53, 13.39s/it]
Task 5, Epoch 17/20 => Loss 0.142, Train_accy 95.17:  80%|████████  | 16/20 [03:32<00:53, 13.39s/it]
Task 5, Epoch 17/20 => Loss 0.142, Train_accy 95.17:  85%|████████▌ | 17/20 [03:32<00:37, 12.64s/it]
Task 5, Epoch 18/20 => Loss 0.148, Train_accy 95.01:  85%|████████▌ | 17/20 [03:43<00:37, 12.64s/it]
Task 5, Epoch 18/20 => Loss 0.148, Train_accy 95.01:  90%|█████████ | 18/20 [03:43<00:24, 12.02s/it]
Task 5, Epoch 19/20 => Loss 0.139, Train_accy 95.33:  90%|█████████ | 18/20 [03:53<00:24, 12.02s/it]
Task 5, Epoch 19/20 => Loss 0.139, Train_accy 95.33:  95%|█████████▌| 19/20 [03:53<00:11, 11.63s/it]
Task 5, Epoch 20/20 => Loss 0.137, Train_accy 95.01, Test_accy 71.98:  95%|█████████▌| 19/20 [04:15<00:11, 11.63s/it]
Task 5, Epoch 20/20 => Loss 0.137, Train_accy 95.01, Test_accy 71.98: 100%|██████████| 20/20 [04:15<00:00, 14.66s/it]
Task 5, Epoch 20/20 => Loss 0.137, Train_accy 95.01, Test_accy 71.98: 100%|██████████| 20/20 [04:15<00:00, 12.78s/it]
2024-09-12 12:01:22,906 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.137, Train_accy 95.01, Test_accy 71.98
2024-09-12 12:01:34,173 [trainer.py] => No NME accuracy.
2024-09-12 12:01:34,174 [trainer.py] => CNN: {'total': 71.98, '00-09': 74.76, '10-19': 78.23, '20-29': 67.33, '30-39': 75.6, '40-49': 66.89, '50-59': 67.11, 'old': 72.89, 'new': 67.11}
2024-09-12 12:01:34,174 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98]
2024-09-12 12:01:34,174 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47]

Average Accuracy (CNN): 79.28
2024-09-12 12:01:34,174 [trainer.py] => Average Accuracy (CNN): 79.28 

2024-09-12 12:01:34,175 [trainer.py] => All params: 172158352
2024-09-12 12:01:34,177 [trainer.py] => Trainable params: 407240
2024-09-12 12:01:34,177 [dualprompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.621, Train_accy 50.50:   0%|          | 0/20 [00:10<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.621, Train_accy 50.50:   5%|▌         | 1/20 [00:10<03:16, 10.36s/it]
Task 6, Epoch 2/20 => Loss 0.612, Train_accy 79.47:   5%|▌         | 1/20 [00:20<03:16, 10.36s/it]
Task 6, Epoch 2/20 => Loss 0.612, Train_accy 79.47:  10%|█         | 2/20 [00:20<03:09, 10.50s/it]
Task 6, Epoch 3/20 => Loss 0.502, Train_accy 82.53:  10%|█         | 2/20 [00:31<03:09, 10.50s/it]
Task 6, Epoch 3/20 => Loss 0.502, Train_accy 82.53:  15%|█▌        | 3/20 [00:31<02:56, 10.40s/it]
Task 6, Epoch 4/20 => Loss 0.440, Train_accy 85.93:  15%|█▌        | 3/20 [00:41<02:56, 10.40s/it]
Task 6, Epoch 4/20 => Loss 0.440, Train_accy 85.93:  20%|██        | 4/20 [00:41<02:42, 10.16s/it]
Task 6, Epoch 5/20 => Loss 0.361, Train_accy 88.33, Test_accy 68.54:  20%|██        | 4/20 [01:02<02:42, 10.16s/it]
Task 6, Epoch 5/20 => Loss 0.361, Train_accy 88.33, Test_accy 68.54:  25%|██▌       | 5/20 [01:02<03:35, 14.37s/it]
Task 6, Epoch 6/20 => Loss 0.341, Train_accy 89.49:  25%|██▌       | 5/20 [01:12<03:35, 14.37s/it]                 
Task 6, Epoch 6/20 => Loss 0.341, Train_accy 89.49:  30%|███       | 6/20 [01:12<03:00, 12.92s/it]
Task 6, Epoch 7/20 => Loss 0.274, Train_accy 91.31:  30%|███       | 6/20 [01:23<03:00, 12.92s/it]
Task 6, Epoch 7/20 => Loss 0.274, Train_accy 91.31:  35%|███▌      | 7/20 [01:23<02:37, 12.10s/it]
Task 6, Epoch 8/20 => Loss 0.287, Train_accy 90.98:  35%|███▌      | 7/20 [01:33<02:37, 12.10s/it]
Task 6, Epoch 8/20 => Loss 0.287, Train_accy 90.98:  40%|████      | 8/20 [01:33<02:19, 11.59s/it]
Task 6, Epoch 9/20 => Loss 0.285, Train_accy 91.39:  40%|████      | 8/20 [01:44<02:19, 11.59s/it]
Task 6, Epoch 9/20 => Loss 0.285, Train_accy 91.39:  45%|████▌     | 9/20 [01:44<02:04, 11.27s/it]
Task 6, Epoch 10/20 => Loss 0.237, Train_accy 92.22, Test_accy 69.17:  45%|████▌     | 9/20 [02:07<02:04, 11.27s/it]
Task 6, Epoch 10/20 => Loss 0.237, Train_accy 92.22, Test_accy 69.17:  50%|█████     | 10/20 [02:07<02:30, 15.01s/it]
Task 6, Epoch 11/20 => Loss 0.211, Train_accy 92.63:  50%|█████     | 10/20 [02:18<02:30, 15.01s/it]                 
Task 6, Epoch 11/20 => Loss 0.211, Train_accy 92.63:  55%|█████▌    | 11/20 [02:18<02:02, 13.66s/it]
Task 6, Epoch 12/20 => Loss 0.216, Train_accy 92.30:  55%|█████▌    | 11/20 [02:28<02:02, 13.66s/it]
Task 6, Epoch 12/20 => Loss 0.216, Train_accy 92.30:  60%|██████    | 12/20 [02:28<01:41, 12.67s/it]
Task 6, Epoch 13/20 => Loss 0.224, Train_accy 92.96:  60%|██████    | 12/20 [02:39<01:41, 12.67s/it]
Task 6, Epoch 13/20 => Loss 0.224, Train_accy 92.96:  65%|██████▌   | 13/20 [02:39<01:23, 12.00s/it]
Task 6, Epoch 14/20 => Loss 0.226, Train_accy 93.29:  65%|██████▌   | 13/20 [02:49<01:23, 12.00s/it]
Task 6, Epoch 14/20 => Loss 0.226, Train_accy 93.29:  70%|███████   | 14/20 [02:49<01:09, 11.53s/it]
Task 6, Epoch 15/20 => Loss 0.194, Train_accy 93.63, Test_accy 70.07:  70%|███████   | 14/20 [03:12<01:09, 11.53s/it]
Task 6, Epoch 15/20 => Loss 0.194, Train_accy 93.63, Test_accy 70.07:  75%|███████▌  | 15/20 [03:12<01:15, 15.05s/it]
Task 6, Epoch 16/20 => Loss 0.209, Train_accy 93.38:  75%|███████▌  | 15/20 [03:23<01:15, 15.05s/it]                 
Task 6, Epoch 16/20 => Loss 0.209, Train_accy 93.38:  80%|████████  | 16/20 [03:23<00:54, 13.70s/it]
Task 6, Epoch 17/20 => Loss 0.184, Train_accy 93.13:  80%|████████  | 16/20 [03:33<00:54, 13.70s/it]
Task 6, Epoch 17/20 => Loss 0.184, Train_accy 93.13:  85%|████████▌ | 17/20 [03:33<00:38, 12.71s/it]
Task 6, Epoch 18/20 => Loss 0.199, Train_accy 93.96:  85%|████████▌ | 17/20 [03:44<00:38, 12.71s/it]
Task 6, Epoch 18/20 => Loss 0.199, Train_accy 93.96:  90%|█████████ | 18/20 [03:44<00:24, 12.09s/it]
Task 6, Epoch 19/20 => Loss 0.142, Train_accy 95.78:  90%|█████████ | 18/20 [03:54<00:24, 12.09s/it]
Task 6, Epoch 19/20 => Loss 0.142, Train_accy 95.78:  95%|█████████▌| 19/20 [03:54<00:11, 11.55s/it]
Task 6, Epoch 20/20 => Loss 0.153, Train_accy 94.78, Test_accy 69.98:  95%|█████████▌| 19/20 [04:16<00:11, 11.55s/it]
Task 6, Epoch 20/20 => Loss 0.153, Train_accy 94.78, Test_accy 69.98: 100%|██████████| 20/20 [04:16<00:00, 14.66s/it]
Task 6, Epoch 20/20 => Loss 0.153, Train_accy 94.78, Test_accy 69.98: 100%|██████████| 20/20 [04:16<00:00, 12.84s/it]
2024-09-12 12:05:50,957 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.153, Train_accy 94.78, Test_accy 69.98
2024-09-12 12:06:03,227 [trainer.py] => No NME accuracy.
2024-09-12 12:06:03,228 [trainer.py] => CNN: {'total': 69.98, '00-09': 73.19, '10-19': 78.49, '20-29': 67.33, '30-39': 75.3, '40-49': 65.23, '50-59': 67.76, '60-69': 59.73, 'old': 71.56, 'new': 59.73}
2024-09-12 12:06:03,228 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98]
2024-09-12 12:06:03,228 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55]

Average Accuracy (CNN): 77.95
2024-09-12 12:06:03,228 [trainer.py] => Average Accuracy (CNN): 77.95 

2024-09-12 12:06:03,231 [trainer.py] => All params: 172158352
2024-09-12 12:06:03,234 [trainer.py] => Trainable params: 407240
2024-09-12 12:06:03,234 [dualprompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.619, Train_accy 50.41:   0%|          | 0/20 [00:09<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.619, Train_accy 50.41:   5%|▌         | 1/20 [00:09<02:57,  9.36s/it]
Task 7, Epoch 2/20 => Loss 0.541, Train_accy 83.13:   5%|▌         | 1/20 [00:18<02:57,  9.36s/it]
Task 7, Epoch 2/20 => Loss 0.541, Train_accy 83.13:  10%|█         | 2/20 [00:18<02:48,  9.36s/it]
Task 7, Epoch 3/20 => Loss 0.374, Train_accy 88.29:  10%|█         | 2/20 [00:28<02:48,  9.36s/it]
Task 7, Epoch 3/20 => Loss 0.374, Train_accy 88.29:  15%|█▌        | 3/20 [00:28<02:38,  9.35s/it]
Task 7, Epoch 4/20 => Loss 0.334, Train_accy 89.86:  15%|█▌        | 3/20 [00:37<02:38,  9.35s/it]
Task 7, Epoch 4/20 => Loss 0.334, Train_accy 89.86:  20%|██        | 4/20 [00:37<02:30,  9.39s/it]
Task 7, Epoch 5/20 => Loss 0.271, Train_accy 91.06, Test_accy 68.05:  20%|██        | 4/20 [01:01<02:30,  9.39s/it]
Task 7, Epoch 5/20 => Loss 0.271, Train_accy 91.06, Test_accy 68.05:  25%|██▌       | 5/20 [01:01<03:39, 14.64s/it]
Task 7, Epoch 6/20 => Loss 0.256, Train_accy 91.06:  25%|██▌       | 5/20 [01:10<03:39, 14.64s/it]                 
Task 7, Epoch 6/20 => Loss 0.256, Train_accy 91.06:  30%|███       | 6/20 [01:10<02:59, 12.83s/it]
Task 7, Epoch 7/20 => Loss 0.219, Train_accy 93.09:  30%|███       | 6/20 [01:20<02:59, 12.83s/it]
Task 7, Epoch 7/20 => Loss 0.219, Train_accy 93.09:  35%|███▌      | 7/20 [01:20<02:31, 11.69s/it]
Task 7, Epoch 8/20 => Loss 0.229, Train_accy 93.09:  35%|███▌      | 7/20 [01:29<02:31, 11.69s/it]
Task 7, Epoch 8/20 => Loss 0.229, Train_accy 93.09:  40%|████      | 8/20 [01:29<02:11, 10.94s/it]
Task 7, Epoch 9/20 => Loss 0.202, Train_accy 94.29:  40%|████      | 8/20 [01:39<02:11, 10.94s/it]
Task 7, Epoch 9/20 => Loss 0.202, Train_accy 94.29:  45%|████▌     | 9/20 [01:39<01:55, 10.51s/it]
Task 7, Epoch 10/20 => Loss 0.170, Train_accy 94.47, Test_accy 68.73:  45%|████▌     | 9/20 [02:02<01:55, 10.51s/it]
Task 7, Epoch 10/20 => Loss 0.170, Train_accy 94.47, Test_accy 68.73:  50%|█████     | 10/20 [02:02<02:25, 14.54s/it]
Task 7, Epoch 11/20 => Loss 0.173, Train_accy 94.56:  50%|█████     | 10/20 [02:12<02:25, 14.54s/it]                 
Task 7, Epoch 11/20 => Loss 0.173, Train_accy 94.56:  55%|█████▌    | 11/20 [02:12<01:57, 13.05s/it]
Task 7, Epoch 12/20 => Loss 0.156, Train_accy 95.21:  55%|█████▌    | 11/20 [02:21<01:57, 13.05s/it]
Task 7, Epoch 12/20 => Loss 0.156, Train_accy 95.21:  60%|██████    | 12/20 [02:21<01:35, 11.92s/it]
Task 7, Epoch 13/20 => Loss 0.147, Train_accy 95.58:  60%|██████    | 12/20 [02:31<01:35, 11.92s/it]
Task 7, Epoch 13/20 => Loss 0.147, Train_accy 95.58:  65%|██████▌   | 13/20 [02:31<01:18, 11.17s/it]
Task 7, Epoch 14/20 => Loss 0.181, Train_accy 93.82:  65%|██████▌   | 13/20 [02:40<01:18, 11.17s/it]
Task 7, Epoch 14/20 => Loss 0.181, Train_accy 93.82:  70%|███████   | 14/20 [02:40<01:03, 10.61s/it]
Task 7, Epoch 15/20 => Loss 0.135, Train_accy 95.85, Test_accy 68.94:  70%|███████   | 14/20 [03:02<01:03, 10.61s/it]
Task 7, Epoch 15/20 => Loss 0.135, Train_accy 95.85, Test_accy 68.94:  75%|███████▌  | 15/20 [03:02<01:10, 14.15s/it]
Task 7, Epoch 16/20 => Loss 0.145, Train_accy 95.48:  75%|███████▌  | 15/20 [03:11<01:10, 14.15s/it]                 
Task 7, Epoch 16/20 => Loss 0.145, Train_accy 95.48:  80%|████████  | 16/20 [03:11<00:50, 12.52s/it]
Task 7, Epoch 17/20 => Loss 0.135, Train_accy 95.76:  80%|████████  | 16/20 [03:20<00:50, 12.52s/it]
Task 7, Epoch 17/20 => Loss 0.135, Train_accy 95.76:  85%|████████▌ | 17/20 [03:20<00:34, 11.61s/it]
Task 7, Epoch 18/20 => Loss 0.149, Train_accy 94.56:  85%|████████▌ | 17/20 [03:30<00:34, 11.61s/it]
Task 7, Epoch 18/20 => Loss 0.149, Train_accy 94.56:  90%|█████████ | 18/20 [03:30<00:21, 10.92s/it]
Task 7, Epoch 19/20 => Loss 0.129, Train_accy 95.67:  90%|█████████ | 18/20 [03:39<00:21, 10.92s/it]
Task 7, Epoch 19/20 => Loss 0.129, Train_accy 95.67:  95%|█████████▌| 19/20 [03:39<00:10, 10.45s/it]
Task 7, Epoch 20/20 => Loss 0.132, Train_accy 95.48, Test_accy 69.06:  95%|█████████▌| 19/20 [04:03<00:10, 10.45s/it]
Task 7, Epoch 20/20 => Loss 0.132, Train_accy 95.48, Test_accy 69.06: 100%|██████████| 20/20 [04:03<00:00, 14.51s/it]
Task 7, Epoch 20/20 => Loss 0.132, Train_accy 95.48, Test_accy 69.06: 100%|██████████| 20/20 [04:03<00:00, 12.18s/it]
2024-09-12 12:10:06,827 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.132, Train_accy 95.48, Test_accy 69.06
2024-09-12 12:10:21,010 [trainer.py] => No NME accuracy.
2024-09-12 12:10:21,011 [trainer.py] => CNN: {'total': 69.06, '00-09': 71.92, '10-19': 78.23, '20-29': 67.33, '30-39': 74.7, '40-49': 63.91, '50-59': 67.76, '60-69': 59.06, '70-79': 66.3, 'old': 69.39, 'new': 66.3}
2024-09-12 12:10:21,011 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06]
2024-09-12 12:10:21,011 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59]

Average Accuracy (CNN): 76.84
2024-09-12 12:10:21,011 [trainer.py] => Average Accuracy (CNN): 76.84 

2024-09-12 12:10:21,015 [trainer.py] => All params: 172158352
2024-09-12 12:10:21,017 [trainer.py] => Trainable params: 407240
2024-09-12 12:10:21,018 [dualprompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.562, Train_accy 53.67:   0%|          | 0/20 [00:12<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.562, Train_accy 53.67:   5%|▌         | 1/20 [00:12<03:50, 12.15s/it]
Task 8, Epoch 2/20 => Loss 0.607, Train_accy 81.14:   5%|▌         | 1/20 [00:24<03:50, 12.15s/it]
Task 8, Epoch 2/20 => Loss 0.607, Train_accy 81.14:  10%|█         | 2/20 [00:24<03:37, 12.11s/it]
Task 8, Epoch 3/20 => Loss 0.464, Train_accy 84.32:  10%|█         | 2/20 [00:36<03:37, 12.11s/it]
Task 8, Epoch 3/20 => Loss 0.464, Train_accy 84.32:  15%|█▌        | 3/20 [00:36<03:25, 12.09s/it]
Task 8, Epoch 4/20 => Loss 0.388, Train_accy 86.86:  15%|█▌        | 3/20 [00:48<03:25, 12.09s/it]
Task 8, Epoch 4/20 => Loss 0.388, Train_accy 86.86:  20%|██        | 4/20 [00:48<03:13, 12.08s/it]
Task 8, Epoch 5/20 => Loss 0.374, Train_accy 88.06, Test_accy 66.74:  20%|██        | 4/20 [01:16<03:13, 12.08s/it]
Task 8, Epoch 5/20 => Loss 0.374, Train_accy 88.06, Test_accy 66.74:  25%|██▌       | 5/20 [01:16<04:28, 17.89s/it]
Task 8, Epoch 6/20 => Loss 0.324, Train_accy 89.55:  25%|██▌       | 5/20 [01:28<04:28, 17.89s/it]                 
Task 8, Epoch 6/20 => Loss 0.324, Train_accy 89.55:  30%|███       | 6/20 [01:28<03:42, 15.92s/it]
Task 8, Epoch 7/20 => Loss 0.302, Train_accy 90.61:  30%|███       | 6/20 [01:40<03:42, 15.92s/it]
Task 8, Epoch 7/20 => Loss 0.302, Train_accy 90.61:  35%|███▌      | 7/20 [01:40<03:10, 14.64s/it]
Task 8, Epoch 8/20 => Loss 0.267, Train_accy 90.75:  35%|███▌      | 7/20 [01:52<03:10, 14.64s/it]
Task 8, Epoch 8/20 => Loss 0.267, Train_accy 90.75:  40%|████      | 8/20 [01:52<02:43, 13.65s/it]
Task 8, Epoch 9/20 => Loss 0.228, Train_accy 92.16:  40%|████      | 8/20 [02:03<02:43, 13.65s/it]
Task 8, Epoch 9/20 => Loss 0.228, Train_accy 92.16:  45%|████▌     | 9/20 [02:03<02:22, 12.95s/it]
Task 8, Epoch 10/20 => Loss 0.225, Train_accy 93.01, Test_accy 67.95:  45%|████▌     | 9/20 [02:31<02:22, 12.95s/it]
Task 8, Epoch 10/20 => Loss 0.225, Train_accy 93.01, Test_accy 67.95:  50%|█████     | 10/20 [02:31<02:55, 17.54s/it]
Task 8, Epoch 11/20 => Loss 0.236, Train_accy 91.95:  50%|█████     | 10/20 [02:43<02:55, 17.54s/it]                 
Task 8, Epoch 11/20 => Loss 0.236, Train_accy 91.95:  55%|█████▌    | 11/20 [02:43<02:22, 15.85s/it]
Task 8, Epoch 12/20 => Loss 0.179, Train_accy 94.56:  55%|█████▌    | 11/20 [02:55<02:22, 15.85s/it]
Task 8, Epoch 12/20 => Loss 0.179, Train_accy 94.56:  60%|██████    | 12/20 [02:55<01:58, 14.77s/it]
Task 8, Epoch 13/20 => Loss 0.207, Train_accy 93.01:  60%|██████    | 12/20 [03:07<01:58, 14.77s/it]
Task 8, Epoch 13/20 => Loss 0.207, Train_accy 93.01:  65%|██████▌   | 13/20 [03:07<01:37, 13.98s/it]
Task 8, Epoch 14/20 => Loss 0.228, Train_accy 92.73:  65%|██████▌   | 13/20 [03:20<01:37, 13.98s/it]
Task 8, Epoch 14/20 => Loss 0.228, Train_accy 92.73:  70%|███████   | 14/20 [03:20<01:20, 13.44s/it]
Task 8, Epoch 15/20 => Loss 0.191, Train_accy 93.22, Test_accy 67.49:  70%|███████   | 14/20 [03:48<01:20, 13.44s/it]
Task 8, Epoch 15/20 => Loss 0.191, Train_accy 93.22, Test_accy 67.49:  75%|███████▌  | 15/20 [03:48<01:29, 17.86s/it]
Task 8, Epoch 16/20 => Loss 0.185, Train_accy 94.14:  75%|███████▌  | 15/20 [04:00<01:29, 17.86s/it]                 
Task 8, Epoch 16/20 => Loss 0.185, Train_accy 94.14:  80%|████████  | 16/20 [04:00<01:04, 16.19s/it]
Task 8, Epoch 17/20 => Loss 0.175, Train_accy 94.14:  80%|████████  | 16/20 [04:12<01:04, 16.19s/it]
Task 8, Epoch 17/20 => Loss 0.175, Train_accy 94.14:  85%|████████▌ | 17/20 [04:12<00:44, 14.97s/it]
Task 8, Epoch 18/20 => Loss 0.171, Train_accy 94.07:  85%|████████▌ | 17/20 [04:24<00:44, 14.97s/it]
Task 8, Epoch 18/20 => Loss 0.171, Train_accy 94.07:  90%|█████████ | 18/20 [04:24<00:28, 14.14s/it]
Task 8, Epoch 19/20 => Loss 0.169, Train_accy 94.07:  90%|█████████ | 18/20 [04:37<00:28, 14.14s/it]
Task 8, Epoch 19/20 => Loss 0.169, Train_accy 94.07:  95%|█████████▌| 19/20 [04:37<00:13, 13.57s/it]
Task 8, Epoch 20/20 => Loss 0.150, Train_accy 95.13, Test_accy 67.81:  95%|█████████▌| 19/20 [05:04<00:13, 13.57s/it]
Task 8, Epoch 20/20 => Loss 0.150, Train_accy 95.13, Test_accy 67.81: 100%|██████████| 20/20 [05:04<00:00, 17.61s/it]
Task 8, Epoch 20/20 => Loss 0.150, Train_accy 95.13, Test_accy 67.81: 100%|██████████| 20/20 [05:04<00:00, 15.21s/it]
2024-09-12 12:15:25,152 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.150, Train_accy 95.13, Test_accy 67.81
2024-09-12 12:15:40,282 [trainer.py] => No NME accuracy.
2024-09-12 12:15:40,282 [trainer.py] => CNN: {'total': 67.81, '00-09': 72.24, '10-19': 75.81, '20-29': 67.33, '30-39': 73.49, '40-49': 64.57, '50-59': 66.45, '60-69': 58.72, '70-79': 65.93, '80-89': 62.9, 'old': 68.41, 'new': 62.9}
2024-09-12 12:15:40,282 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81]
2024-09-12 12:15:40,282 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22]

Average Accuracy (CNN): 75.84
2024-09-12 12:15:40,282 [trainer.py] => Average Accuracy (CNN): 75.84 

2024-09-12 12:15:40,284 [trainer.py] => All params: 172158352
2024-09-12 12:15:40,285 [trainer.py] => Trainable params: 407240
2024-09-12 12:15:40,285 [dualprompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.892, Train_accy 43.87:   0%|          | 0/20 [00:06<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.892, Train_accy 43.87:   5%|▌         | 1/20 [00:06<02:03,  6.52s/it]
Task 9, Epoch 2/20 => Loss 0.645, Train_accy 78.39:   5%|▌         | 1/20 [00:13<02:03,  6.52s/it]
Task 9, Epoch 2/20 => Loss 0.645, Train_accy 78.39:  10%|█         | 2/20 [00:13<01:59,  6.62s/it]
Task 9, Epoch 3/20 => Loss 0.468, Train_accy 84.72:  10%|█         | 2/20 [00:19<01:59,  6.62s/it]
Task 9, Epoch 3/20 => Loss 0.468, Train_accy 84.72:  15%|█▌        | 3/20 [00:19<01:53,  6.66s/it]
Task 9, Epoch 4/20 => Loss 0.389, Train_accy 86.96:  15%|█▌        | 3/20 [00:26<01:53,  6.66s/it]
Task 9, Epoch 4/20 => Loss 0.389, Train_accy 86.96:  20%|██        | 4/20 [00:26<01:46,  6.68s/it]
Task 9, Epoch 5/20 => Loss 0.360, Train_accy 88.41, Test_accy 66.33:  20%|██        | 4/20 [00:50<01:46,  6.68s/it]
Task 9, Epoch 5/20 => Loss 0.360, Train_accy 88.41, Test_accy 66.33:  25%|██▌       | 5/20 [00:50<03:11, 12.78s/it]
Task 9, Epoch 6/20 => Loss 0.325, Train_accy 89.72:  25%|██▌       | 5/20 [00:56<03:11, 12.78s/it]                 
Task 9, Epoch 6/20 => Loss 0.325, Train_accy 89.72:  30%|███       | 6/20 [00:56<02:29, 10.70s/it]
Task 9, Epoch 7/20 => Loss 0.273, Train_accy 91.57:  30%|███       | 6/20 [01:03<02:29, 10.70s/it]
Task 9, Epoch 7/20 => Loss 0.273, Train_accy 91.57:  35%|███▌      | 7/20 [01:03<02:01,  9.37s/it]
Task 9, Epoch 8/20 => Loss 0.267, Train_accy 91.57:  35%|███▌      | 7/20 [01:10<02:01,  9.37s/it]
Task 9, Epoch 8/20 => Loss 0.267, Train_accy 91.57:  40%|████      | 8/20 [01:10<01:42,  8.52s/it]
Task 9, Epoch 9/20 => Loss 0.210, Train_accy 92.89:  40%|████      | 8/20 [01:16<01:42,  8.52s/it]
Task 9, Epoch 9/20 => Loss 0.210, Train_accy 92.89:  45%|████▌     | 9/20 [01:16<01:27,  7.94s/it]
Task 9, Epoch 10/20 => Loss 0.225, Train_accy 93.02, Test_accy 66.60:  45%|████▌     | 9/20 [01:40<01:27,  7.94s/it]
Task 9, Epoch 10/20 => Loss 0.225, Train_accy 93.02, Test_accy 66.60:  50%|█████     | 10/20 [01:40<02:08, 12.80s/it]
Task 9, Epoch 11/20 => Loss 0.213, Train_accy 92.62:  50%|█████     | 10/20 [01:47<02:08, 12.80s/it]                 
Task 9, Epoch 11/20 => Loss 0.213, Train_accy 92.62:  55%|█████▌    | 11/20 [01:47<01:38, 10.94s/it]
Task 9, Epoch 12/20 => Loss 0.205, Train_accy 93.68:  55%|█████▌    | 11/20 [01:53<01:38, 10.94s/it]
Task 9, Epoch 12/20 => Loss 0.205, Train_accy 93.68:  60%|██████    | 12/20 [01:53<01:17,  9.64s/it]
Task 9, Epoch 13/20 => Loss 0.190, Train_accy 94.20:  60%|██████    | 12/20 [02:00<01:17,  9.64s/it]
Task 9, Epoch 13/20 => Loss 0.190, Train_accy 94.20:  65%|██████▌   | 13/20 [02:00<01:01,  8.73s/it]
Task 9, Epoch 14/20 => Loss 0.190, Train_accy 93.94:  65%|██████▌   | 13/20 [02:07<01:01,  8.73s/it]
Task 9, Epoch 14/20 => Loss 0.190, Train_accy 93.94:  70%|███████   | 14/20 [02:07<00:48,  8.10s/it]
Task 9, Epoch 15/20 => Loss 0.165, Train_accy 94.60, Test_accy 66.90:  70%|███████   | 14/20 [02:31<00:48,  8.10s/it]
Task 9, Epoch 15/20 => Loss 0.165, Train_accy 94.60, Test_accy 66.90:  75%|███████▌  | 15/20 [02:31<01:04, 12.83s/it]
Task 9, Epoch 16/20 => Loss 0.181, Train_accy 94.07:  75%|███████▌  | 15/20 [02:37<01:04, 12.83s/it]                 
Task 9, Epoch 16/20 => Loss 0.181, Train_accy 94.07:  80%|████████  | 16/20 [02:37<00:44, 11.01s/it]
Task 9, Epoch 17/20 => Loss 0.152, Train_accy 95.39:  80%|████████  | 16/20 [02:44<00:44, 11.01s/it]
Task 9, Epoch 17/20 => Loss 0.152, Train_accy 95.39:  85%|████████▌ | 17/20 [02:44<00:29,  9.69s/it]
Task 9, Epoch 18/20 => Loss 0.165, Train_accy 94.47:  85%|████████▌ | 17/20 [02:50<00:29,  9.69s/it]
Task 9, Epoch 18/20 => Loss 0.165, Train_accy 94.47:  90%|█████████ | 18/20 [02:50<00:17,  8.65s/it]
Task 9, Epoch 19/20 => Loss 0.134, Train_accy 96.05:  90%|█████████ | 18/20 [02:56<00:17,  8.65s/it]
Task 9, Epoch 19/20 => Loss 0.134, Train_accy 96.05:  95%|█████████▌| 19/20 [02:56<00:07,  7.94s/it]
Task 9, Epoch 20/20 => Loss 0.137, Train_accy 95.52, Test_accy 67.50:  95%|█████████▌| 19/20 [03:19<00:07,  7.94s/it]
Task 9, Epoch 20/20 => Loss 0.137, Train_accy 95.52, Test_accy 67.50: 100%|██████████| 20/20 [03:19<00:00, 12.25s/it]
Task 9, Epoch 20/20 => Loss 0.137, Train_accy 95.52, Test_accy 67.50: 100%|██████████| 20/20 [03:19<00:00,  9.96s/it]
2024-09-12 12:18:59,545 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.137, Train_accy 95.52, Test_accy 67.50
2024-09-12 12:19:16,794 [trainer.py] => No NME accuracy.
2024-09-12 12:19:16,795 [trainer.py] => CNN: {'total': 67.5, '00-09': 73.82, '10-19': 75.81, '20-29': 68.33, '30-39': 73.19, '40-49': 64.57, '50-59': 66.78, '60-69': 60.74, '70-79': 64.84, '80-89': 62.58, '90-99': 57.06, 'old': 68.16, 'new': 57.06}
2024-09-12 12:19:16,795 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5]
2024-09-12 12:19:16,795 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36]

Average Accuracy (CNN): 75.0
2024-09-12 12:19:16,795 [trainer.py] => Average Accuracy (CNN): 75.0 

2024-09-12 12:19:16,797 [trainer.py] => All params: 172158352
2024-09-12 12:19:16,799 [trainer.py] => Trainable params: 407240
2024-09-12 12:19:16,799 [dualprompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.352, Train_accy 55.64:   0%|          | 0/20 [00:10<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.352, Train_accy 55.64:   5%|▌         | 1/20 [00:10<03:11, 10.08s/it]
Task 10, Epoch 2/20 => Loss 0.471, Train_accy 83.16:   5%|▌         | 1/20 [00:20<03:11, 10.08s/it]
Task 10, Epoch 2/20 => Loss 0.471, Train_accy 83.16:  10%|█         | 2/20 [00:20<03:00, 10.05s/it]
Task 10, Epoch 3/20 => Loss 0.338, Train_accy 88.80:  10%|█         | 2/20 [00:30<03:00, 10.05s/it]
Task 10, Epoch 3/20 => Loss 0.338, Train_accy 88.80:  15%|█▌        | 3/20 [00:30<02:50, 10.04s/it]
Task 10, Epoch 4/20 => Loss 0.324, Train_accy 88.46:  15%|█▌        | 3/20 [00:40<02:50, 10.04s/it]
Task 10, Epoch 4/20 => Loss 0.324, Train_accy 88.46:  20%|██        | 4/20 [00:40<02:40, 10.05s/it]
Task 10, Epoch 5/20 => Loss 0.285, Train_accy 90.09, Test_accy 64.85:  20%|██        | 4/20 [01:08<02:40, 10.05s/it]
Task 10, Epoch 5/20 => Loss 0.285, Train_accy 90.09, Test_accy 64.85:  25%|██▌       | 5/20 [01:08<04:11, 16.75s/it]
Task 10, Epoch 6/20 => Loss 0.212, Train_accy 92.39:  25%|██▌       | 5/20 [01:19<04:11, 16.75s/it]                 
Task 10, Epoch 6/20 => Loss 0.212, Train_accy 92.39:  30%|███       | 6/20 [01:19<03:23, 14.52s/it]
Task 10, Epoch 7/20 => Loss 0.218, Train_accy 91.97:  30%|███       | 6/20 [01:29<03:23, 14.52s/it]
Task 10, Epoch 7/20 => Loss 0.218, Train_accy 91.97:  35%|███▌      | 7/20 [01:29<02:49, 13.07s/it]
Task 10, Epoch 8/20 => Loss 0.221, Train_accy 92.48:  35%|███▌      | 7/20 [01:39<02:49, 13.07s/it]
Task 10, Epoch 8/20 => Loss 0.221, Train_accy 92.48:  40%|████      | 8/20 [01:39<02:25, 12.09s/it]
Task 10, Epoch 9/20 => Loss 0.177, Train_accy 93.85:  40%|████      | 8/20 [01:49<02:25, 12.09s/it]
Task 10, Epoch 9/20 => Loss 0.177, Train_accy 93.85:  45%|████▌     | 9/20 [01:49<02:06, 11.47s/it]
Task 10, Epoch 10/20 => Loss 0.182, Train_accy 93.16, Test_accy 65.68:  45%|████▌     | 9/20 [02:18<02:06, 11.47s/it]
Task 10, Epoch 10/20 => Loss 0.182, Train_accy 93.16, Test_accy 65.68:  50%|█████     | 10/20 [02:18<02:48, 16.84s/it]
Task 10, Epoch 11/20 => Loss 0.149, Train_accy 94.87:  50%|█████     | 10/20 [02:28<02:48, 16.84s/it]                 
Task 10, Epoch 11/20 => Loss 0.149, Train_accy 94.87:  55%|█████▌    | 11/20 [02:28<02:13, 14.80s/it]
Task 10, Epoch 12/20 => Loss 0.156, Train_accy 95.13:  55%|█████▌    | 11/20 [02:37<02:13, 14.80s/it]
Task 10, Epoch 12/20 => Loss 0.156, Train_accy 95.13:  60%|██████    | 12/20 [02:37<01:45, 13.18s/it]
Task 10, Epoch 13/20 => Loss 0.108, Train_accy 95.98:  60%|██████    | 12/20 [02:47<01:45, 13.18s/it]
Task 10, Epoch 13/20 => Loss 0.108, Train_accy 95.98:  65%|██████▌   | 13/20 [02:47<01:24, 12.11s/it]
Task 10, Epoch 14/20 => Loss 0.115, Train_accy 95.56:  65%|██████▌   | 13/20 [02:56<01:24, 12.11s/it]
Task 10, Epoch 14/20 => Loss 0.115, Train_accy 95.56:  70%|███████   | 14/20 [02:56<01:07, 11.31s/it]
Task 10, Epoch 15/20 => Loss 0.153, Train_accy 94.44, Test_accy 66.20:  70%|███████   | 14/20 [03:24<01:07, 11.31s/it]
Task 10, Epoch 15/20 => Loss 0.153, Train_accy 94.44, Test_accy 66.20:  75%|███████▌  | 15/20 [03:24<01:21, 16.38s/it]
Task 10, Epoch 16/20 => Loss 0.152, Train_accy 94.10:  75%|███████▌  | 15/20 [03:34<01:21, 16.38s/it]                 
Task 10, Epoch 16/20 => Loss 0.152, Train_accy 94.10:  80%|████████  | 16/20 [03:34<00:57, 14.46s/it]
Task 10, Epoch 17/20 => Loss 0.126, Train_accy 95.21:  80%|████████  | 16/20 [03:44<00:57, 14.46s/it]
Task 10, Epoch 17/20 => Loss 0.126, Train_accy 95.21:  85%|████████▌ | 17/20 [03:44<00:39, 13.10s/it]
Task 10, Epoch 18/20 => Loss 0.101, Train_accy 95.90:  85%|████████▌ | 17/20 [03:55<00:39, 13.10s/it]
Task 10, Epoch 18/20 => Loss 0.101, Train_accy 95.90:  90%|█████████ | 18/20 [03:55<00:24, 12.20s/it]
Task 10, Epoch 19/20 => Loss 0.134, Train_accy 95.21:  90%|█████████ | 18/20 [04:05<00:24, 12.20s/it]
Task 10, Epoch 19/20 => Loss 0.134, Train_accy 95.21:  95%|█████████▌| 19/20 [04:05<00:11, 11.57s/it]
Task 10, Epoch 20/20 => Loss 0.147, Train_accy 95.04, Test_accy 66.35:  95%|█████████▌| 19/20 [04:33<00:11, 11.57s/it]
Task 10, Epoch 20/20 => Loss 0.147, Train_accy 95.04, Test_accy 66.35: 100%|██████████| 20/20 [04:33<00:00, 16.61s/it]
Task 10, Epoch 20/20 => Loss 0.147, Train_accy 95.04, Test_accy 66.35: 100%|██████████| 20/20 [04:33<00:00, 13.67s/it]
2024-09-12 12:23:50,293 [dualprompt.py] => Task 10, Epoch 20/20 => Loss 0.147, Train_accy 95.04, Test_accy 66.35
2024-09-12 12:24:08,665 [trainer.py] => No NME accuracy.
2024-09-12 12:24:08,666 [trainer.py] => CNN: {'total': 66.35, '00-09': 73.5, '10-19': 75.54, '20-29': 66.67, '30-39': 72.89, '40-49': 61.92, '50-59': 67.76, '60-69': 58.72, '70-79': 64.84, '80-89': 59.03, '90-99': 55.93, '100-109': 65.49, 'old': 66.43, 'new': 65.49}
2024-09-12 12:24:08,666 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35]
2024-09-12 12:24:08,666 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8]

Average Accuracy (CNN): 74.22
2024-09-12 12:24:08,667 [trainer.py] => Average Accuracy (CNN): 74.22 

2024-09-12 12:24:08,670 [trainer.py] => All params: 172158352
2024-09-12 12:24:08,673 [trainer.py] => Trainable params: 407240
2024-09-12 12:24:08,673 [dualprompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.289, Train_accy 59.40:   0%|          | 0/20 [00:12<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.289, Train_accy 59.40:   5%|▌         | 1/20 [00:12<04:00, 12.67s/it]
Task 11, Epoch 2/20 => Loss 0.460, Train_accy 84.21:   5%|▌         | 1/20 [00:25<04:00, 12.67s/it]
Task 11, Epoch 2/20 => Loss 0.460, Train_accy 84.21:  10%|█         | 2/20 [00:25<03:47, 12.64s/it]
Task 11, Epoch 3/20 => Loss 0.331, Train_accy 88.36:  10%|█         | 2/20 [00:37<03:47, 12.64s/it]
Task 11, Epoch 3/20 => Loss 0.331, Train_accy 88.36:  15%|█▌        | 3/20 [00:37<03:34, 12.63s/it]
Task 11, Epoch 4/20 => Loss 0.329, Train_accy 88.83:  15%|█▌        | 3/20 [00:50<03:34, 12.63s/it]
Task 11, Epoch 4/20 => Loss 0.329, Train_accy 88.83:  20%|██        | 4/20 [00:50<03:22, 12.65s/it]
Task 11, Epoch 5/20 => Loss 0.261, Train_accy 90.03, Test_accy 65.27:  20%|██        | 4/20 [01:22<03:22, 12.65s/it]
Task 11, Epoch 5/20 => Loss 0.261, Train_accy 90.03, Test_accy 65.27:  25%|██▌       | 5/20 [01:22<04:52, 19.53s/it]
Task 11, Epoch 6/20 => Loss 0.216, Train_accy 91.57:  25%|██▌       | 5/20 [01:34<04:52, 19.53s/it]                 
Task 11, Epoch 6/20 => Loss 0.216, Train_accy 91.57:  30%|███       | 6/20 [01:34<03:56, 16.93s/it]
Task 11, Epoch 7/20 => Loss 0.215, Train_accy 92.51:  30%|███       | 6/20 [01:46<03:56, 16.93s/it]
Task 11, Epoch 7/20 => Loss 0.215, Train_accy 92.51:  35%|███▌      | 7/20 [01:46<03:21, 15.53s/it]
Task 11, Epoch 8/20 => Loss 0.178, Train_accy 94.05:  35%|███▌      | 7/20 [01:59<03:21, 15.53s/it]
Task 11, Epoch 8/20 => Loss 0.178, Train_accy 94.05:  40%|████      | 8/20 [01:59<02:55, 14.59s/it]
Task 11, Epoch 9/20 => Loss 0.157, Train_accy 93.51:  40%|████      | 8/20 [02:12<02:55, 14.59s/it]
Task 11, Epoch 9/20 => Loss 0.157, Train_accy 93.51:  45%|████▌     | 9/20 [02:12<02:33, 14.00s/it]
Task 11, Epoch 10/20 => Loss 0.181, Train_accy 93.98, Test_accy 66.15:  45%|████▌     | 9/20 [02:45<02:33, 14.00s/it]
Task 11, Epoch 10/20 => Loss 0.181, Train_accy 93.98, Test_accy 66.15:  50%|█████     | 10/20 [02:45<03:18, 19.85s/it]
Task 11, Epoch 11/20 => Loss 0.189, Train_accy 92.91:  50%|█████     | 10/20 [02:57<03:18, 19.85s/it]                 
Task 11, Epoch 11/20 => Loss 0.189, Train_accy 92.91:  55%|█████▌    | 11/20 [02:57<02:38, 17.64s/it]
Task 11, Epoch 12/20 => Loss 0.169, Train_accy 93.38:  55%|█████▌    | 11/20 [03:10<02:38, 17.64s/it]
Task 11, Epoch 12/20 => Loss 0.169, Train_accy 93.38:  60%|██████    | 12/20 [03:10<02:08, 16.11s/it]
Task 11, Epoch 13/20 => Loss 0.171, Train_accy 93.85:  60%|██████    | 12/20 [03:22<02:08, 16.11s/it]
Task 11, Epoch 13/20 => Loss 0.171, Train_accy 93.85:  65%|██████▌   | 13/20 [03:22<01:45, 15.07s/it]
Task 11, Epoch 14/20 => Loss 0.180, Train_accy 92.84:  65%|██████▌   | 13/20 [03:35<01:45, 15.07s/it]
Task 11, Epoch 14/20 => Loss 0.180, Train_accy 92.84:  70%|███████   | 14/20 [03:35<01:25, 14.32s/it]
Task 11, Epoch 15/20 => Loss 0.120, Train_accy 95.32, Test_accy 66.01:  70%|███████   | 14/20 [04:08<01:25, 14.32s/it]
Task 11, Epoch 15/20 => Loss 0.120, Train_accy 95.32, Test_accy 66.01:  75%|███████▌  | 15/20 [04:08<01:39, 19.93s/it]
Task 11, Epoch 16/20 => Loss 0.128, Train_accy 95.18:  75%|███████▌  | 15/20 [04:21<01:39, 19.93s/it]                 
Task 11, Epoch 16/20 => Loss 0.128, Train_accy 95.18:  80%|████████  | 16/20 [04:21<01:10, 17.74s/it]
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 94.25:  80%|████████  | 16/20 [04:33<01:10, 17.74s/it]
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 94.25:  85%|████████▌ | 17/20 [04:33<00:48, 16.06s/it]
Task 11, Epoch 18/20 => Loss 0.145, Train_accy 95.25:  85%|████████▌ | 17/20 [04:45<00:48, 16.06s/it]
Task 11, Epoch 18/20 => Loss 0.145, Train_accy 95.25:  90%|█████████ | 18/20 [04:45<00:29, 14.83s/it]
Task 11, Epoch 19/20 => Loss 0.133, Train_accy 94.52:  90%|█████████ | 18/20 [04:57<00:29, 14.83s/it]
Task 11, Epoch 19/20 => Loss 0.133, Train_accy 94.52:  95%|█████████▌| 19/20 [04:57<00:13, 14.00s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.05, Test_accy 66.15:  95%|█████████▌| 19/20 [05:30<00:13, 14.00s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.05, Test_accy 66.15: 100%|██████████| 20/20 [05:30<00:00, 19.64s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.05, Test_accy 66.15: 100%|██████████| 20/20 [05:30<00:00, 16.51s/it]
2024-09-12 12:29:38,827 [dualprompt.py] => Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.05, Test_accy 66.15
2024-09-12 12:29:59,262 [trainer.py] => No NME accuracy.
2024-09-12 12:29:59,263 [trainer.py] => CNN: {'total': 66.15, '00-09': 74.13, '10-19': 73.66, '20-29': 63.33, '30-39': 73.8, '40-49': 61.92, '50-59': 68.09, '60-69': 59.4, '70-79': 64.1, '80-89': 60.32, '90-99': 54.8, '100-109': 65.49, '110-119': 66.76, 'old': 66.08, 'new': 66.76}
2024-09-12 12:29:59,263 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15]
2024-09-12 12:29:59,263 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44]

Average Accuracy (CNN): 73.54
2024-09-12 12:29:59,263 [trainer.py] => Average Accuracy (CNN): 73.54 

2024-09-12 12:29:59,265 [trainer.py] => All params: 172158352
2024-09-12 12:29:59,266 [trainer.py] => Trainable params: 407240
2024-09-12 12:29:59,266 [dualprompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.461, Train_accy 52.58:   0%|          | 0/20 [00:08<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.461, Train_accy 52.58:   5%|▌         | 1/20 [00:08<02:41,  8.49s/it]
Task 12, Epoch 2/20 => Loss 0.528, Train_accy 81.61:   5%|▌         | 1/20 [00:16<02:41,  8.49s/it]
Task 12, Epoch 2/20 => Loss 0.528, Train_accy 81.61:  10%|█         | 2/20 [00:16<02:31,  8.43s/it]
Task 12, Epoch 3/20 => Loss 0.346, Train_accy 87.29:  10%|█         | 2/20 [00:25<02:31,  8.43s/it]
Task 12, Epoch 3/20 => Loss 0.346, Train_accy 87.29:  15%|█▌        | 3/20 [00:25<02:23,  8.43s/it]
Task 12, Epoch 4/20 => Loss 0.302, Train_accy 88.95:  15%|█▌        | 3/20 [00:33<02:23,  8.43s/it]
Task 12, Epoch 4/20 => Loss 0.302, Train_accy 88.95:  20%|██        | 4/20 [00:33<02:14,  8.42s/it]
Task 12, Epoch 5/20 => Loss 0.225, Train_accy 91.43, Test_accy 63.94:  20%|██        | 4/20 [01:04<02:14,  8.42s/it]
Task 12, Epoch 5/20 => Loss 0.225, Train_accy 91.43, Test_accy 63.94:  25%|██▌       | 5/20 [01:04<04:05, 16.40s/it]
Task 12, Epoch 6/20 => Loss 0.221, Train_accy 92.15:  25%|██▌       | 5/20 [01:12<04:05, 16.40s/it]                 
Task 12, Epoch 6/20 => Loss 0.221, Train_accy 92.15:  30%|███       | 6/20 [01:12<03:12, 13.72s/it]
Task 12, Epoch 7/20 => Loss 0.159, Train_accy 94.01:  30%|███       | 6/20 [01:21<03:12, 13.72s/it]
Task 12, Epoch 7/20 => Loss 0.159, Train_accy 94.01:  35%|███▌      | 7/20 [01:21<02:35, 11.98s/it]
Task 12, Epoch 8/20 => Loss 0.155, Train_accy 94.42:  35%|███▌      | 7/20 [01:29<02:35, 11.98s/it]
Task 12, Epoch 8/20 => Loss 0.155, Train_accy 94.42:  40%|████      | 8/20 [01:29<02:09, 10.82s/it]
Task 12, Epoch 9/20 => Loss 0.141, Train_accy 94.63:  40%|████      | 8/20 [01:37<02:09, 10.82s/it]
Task 12, Epoch 9/20 => Loss 0.141, Train_accy 94.63:  45%|████▌     | 9/20 [01:37<01:50, 10.07s/it]
Task 12, Epoch 10/20 => Loss 0.156, Train_accy 94.01, Test_accy 64.96:  45%|████▌     | 9/20 [02:07<01:50, 10.07s/it]
Task 12, Epoch 10/20 => Loss 0.156, Train_accy 94.01, Test_accy 64.96:  50%|█████     | 10/20 [02:07<02:42, 16.22s/it]
Task 12, Epoch 11/20 => Loss 0.127, Train_accy 94.83:  50%|█████     | 10/20 [02:15<02:42, 16.22s/it]                 
Task 12, Epoch 11/20 => Loss 0.127, Train_accy 94.83:  55%|█████▌    | 11/20 [02:15<02:03, 13.69s/it]
Task 12, Epoch 12/20 => Loss 0.111, Train_accy 94.83:  55%|█████▌    | 11/20 [02:23<02:03, 13.69s/it]
Task 12, Epoch 12/20 => Loss 0.111, Train_accy 94.83:  60%|██████    | 12/20 [02:23<01:35, 11.93s/it]
Task 12, Epoch 13/20 => Loss 0.121, Train_accy 95.56:  60%|██████    | 12/20 [02:31<01:35, 11.93s/it]
Task 12, Epoch 13/20 => Loss 0.121, Train_accy 95.56:  65%|██████▌   | 13/20 [02:31<01:14, 10.70s/it]
Task 12, Epoch 14/20 => Loss 0.119, Train_accy 95.25:  65%|██████▌   | 13/20 [02:40<01:14, 10.70s/it]
Task 12, Epoch 14/20 => Loss 0.119, Train_accy 95.25:  70%|███████   | 14/20 [02:40<01:00, 10.03s/it]
Task 12, Epoch 15/20 => Loss 0.128, Train_accy 95.04, Test_accy 65.02:  70%|███████   | 14/20 [03:10<01:00, 10.03s/it]
Task 12, Epoch 15/20 => Loss 0.128, Train_accy 95.04, Test_accy 65.02:  75%|███████▌  | 15/20 [03:10<01:20, 16.14s/it]
Task 12, Epoch 16/20 => Loss 0.104, Train_accy 95.66:  75%|███████▌  | 15/20 [03:18<01:20, 16.14s/it]                 
Task 12, Epoch 16/20 => Loss 0.104, Train_accy 95.66:  80%|████████  | 16/20 [03:18<00:55, 13.80s/it]
Task 12, Epoch 17/20 => Loss 0.089, Train_accy 96.07:  80%|████████  | 16/20 [03:27<00:55, 13.80s/it]
Task 12, Epoch 17/20 => Loss 0.089, Train_accy 96.07:  85%|████████▌ | 17/20 [03:27<00:36, 12.18s/it]
Task 12, Epoch 18/20 => Loss 0.120, Train_accy 95.04:  85%|████████▌ | 17/20 [03:35<00:36, 12.18s/it]
Task 12, Epoch 18/20 => Loss 0.120, Train_accy 95.04:  90%|█████████ | 18/20 [03:35<00:22, 11.03s/it]
Task 12, Epoch 19/20 => Loss 0.103, Train_accy 95.14:  90%|█████████ | 18/20 [03:44<00:22, 11.03s/it]
Task 12, Epoch 19/20 => Loss 0.103, Train_accy 95.14:  95%|█████████▌| 19/20 [03:44<00:10, 10.28s/it]
Task 12, Epoch 20/20 => Loss 0.089, Train_accy 96.80, Test_accy 65.30:  95%|█████████▌| 19/20 [04:14<00:10, 10.28s/it]
Task 12, Epoch 20/20 => Loss 0.089, Train_accy 96.80, Test_accy 65.30: 100%|██████████| 20/20 [04:14<00:00, 16.36s/it]
Task 12, Epoch 20/20 => Loss 0.089, Train_accy 96.80, Test_accy 65.30: 100%|██████████| 20/20 [04:14<00:00, 12.73s/it]
2024-09-12 12:34:13,902 [dualprompt.py] => Task 12, Epoch 20/20 => Loss 0.089, Train_accy 96.80, Test_accy 65.30
2024-09-12 12:34:36,282 [trainer.py] => No NME accuracy.
2024-09-12 12:34:36,282 [trainer.py] => CNN: {'total': 65.3, '00-09': 74.76, '10-19': 73.92, '20-29': 64.0, '30-39': 71.69, '40-49': 60.6, '50-59': 68.42, '60-69': 60.4, '70-79': 64.1, '80-89': 60.97, '90-99': 55.37, '100-109': 64.79, '110-119': 66.49, '120-129': 54.61, 'old': 66.09, 'new': 54.61}
2024-09-12 12:34:36,282 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3]
2024-09-12 12:34:36,282 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58]

Average Accuracy (CNN): 72.91
2024-09-12 12:34:36,282 [trainer.py] => Average Accuracy (CNN): 72.91 

2024-09-12 12:34:36,284 [trainer.py] => All params: 172158352
2024-09-12 12:34:36,285 [trainer.py] => Trainable params: 407240
2024-09-12 12:34:36,285 [dualprompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.321, Train_accy 59.78:   0%|          | 0/20 [00:09<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.321, Train_accy 59.78:   5%|▌         | 1/20 [00:09<03:09,  9.98s/it]
Task 13, Epoch 2/20 => Loss 0.480, Train_accy 82.53:   5%|▌         | 1/20 [00:19<03:09,  9.98s/it]
Task 13, Epoch 2/20 => Loss 0.480, Train_accy 82.53:  10%|█         | 2/20 [00:19<02:59,  9.97s/it]
Task 13, Epoch 3/20 => Loss 0.309, Train_accy 87.72:  10%|█         | 2/20 [00:29<02:59,  9.97s/it]
Task 13, Epoch 3/20 => Loss 0.309, Train_accy 87.72:  15%|█▌        | 3/20 [00:29<02:48,  9.93s/it]
Task 13, Epoch 4/20 => Loss 0.256, Train_accy 90.05:  15%|█▌        | 3/20 [00:39<02:48,  9.93s/it]
Task 13, Epoch 4/20 => Loss 0.256, Train_accy 90.05:  20%|██        | 4/20 [00:39<02:38,  9.91s/it]
Task 13, Epoch 5/20 => Loss 0.196, Train_accy 92.99, Test_accy 63.88:  20%|██        | 4/20 [01:11<02:38,  9.91s/it]
Task 13, Epoch 5/20 => Loss 0.196, Train_accy 92.99, Test_accy 63.88:  25%|██▌       | 5/20 [01:11<04:28, 17.88s/it]
Task 13, Epoch 6/20 => Loss 0.195, Train_accy 92.47:  25%|██▌       | 5/20 [01:21<04:28, 17.88s/it]                 
Task 13, Epoch 6/20 => Loss 0.195, Train_accy 92.47:  30%|███       | 6/20 [01:21<03:30, 15.07s/it]
Task 13, Epoch 7/20 => Loss 0.178, Train_accy 92.99:  30%|███       | 6/20 [01:31<03:30, 15.07s/it]
Task 13, Epoch 7/20 => Loss 0.178, Train_accy 92.99:  35%|███▌      | 7/20 [01:31<02:53, 13.36s/it]
Task 13, Epoch 8/20 => Loss 0.170, Train_accy 93.25:  35%|███▌      | 7/20 [01:41<02:53, 13.36s/it]
Task 13, Epoch 8/20 => Loss 0.170, Train_accy 93.25:  40%|████      | 8/20 [01:41<02:27, 12.26s/it]
Task 13, Epoch 9/20 => Loss 0.121, Train_accy 94.64:  40%|████      | 8/20 [01:50<02:27, 12.26s/it]
Task 13, Epoch 9/20 => Loss 0.121, Train_accy 94.64:  45%|████▌     | 9/20 [01:50<02:06, 11.49s/it]
Task 13, Epoch 10/20 => Loss 0.202, Train_accy 94.46, Test_accy 64.69:  45%|████▌     | 9/20 [02:24<02:06, 11.49s/it]
Task 13, Epoch 10/20 => Loss 0.202, Train_accy 94.46, Test_accy 64.69:  50%|█████     | 10/20 [02:24<03:02, 18.24s/it]
Task 13, Epoch 11/20 => Loss 0.146, Train_accy 94.46:  50%|█████     | 10/20 [02:34<03:02, 18.24s/it]                 
Task 13, Epoch 11/20 => Loss 0.146, Train_accy 94.46:  55%|█████▌    | 11/20 [02:34<02:21, 15.73s/it]
Task 13, Epoch 12/20 => Loss 0.100, Train_accy 95.76:  55%|█████▌    | 11/20 [02:44<02:21, 15.73s/it]
Task 13, Epoch 12/20 => Loss 0.100, Train_accy 95.76:  60%|██████    | 12/20 [02:44<01:51, 13.95s/it]
Task 13, Epoch 13/20 => Loss 0.110, Train_accy 96.28:  60%|██████    | 12/20 [02:54<01:51, 13.95s/it]
Task 13, Epoch 13/20 => Loss 0.110, Train_accy 96.28:  65%|██████▌   | 13/20 [02:54<01:29, 12.72s/it]
Task 13, Epoch 14/20 => Loss 0.146, Train_accy 94.20:  65%|██████▌   | 13/20 [03:03<01:29, 12.72s/it]
Task 13, Epoch 14/20 => Loss 0.146, Train_accy 94.20:  70%|███████   | 14/20 [03:03<01:11, 11.86s/it]
Task 13, Epoch 15/20 => Loss 0.097, Train_accy 95.42, Test_accy 65.09:  70%|███████   | 14/20 [03:37<01:11, 11.86s/it]
Task 13, Epoch 15/20 => Loss 0.097, Train_accy 95.42, Test_accy 65.09:  75%|███████▌  | 15/20 [03:37<01:31, 18.34s/it]
Task 13, Epoch 16/20 => Loss 0.124, Train_accy 94.64:  75%|███████▌  | 15/20 [03:47<01:31, 18.34s/it]                 
Task 13, Epoch 16/20 => Loss 0.124, Train_accy 94.64:  80%|████████  | 16/20 [03:47<01:03, 15.77s/it]
Task 13, Epoch 17/20 => Loss 0.142, Train_accy 94.81:  80%|████████  | 16/20 [03:56<01:03, 15.77s/it]
Task 13, Epoch 17/20 => Loss 0.142, Train_accy 94.81:  85%|████████▌ | 17/20 [03:56<00:41, 13.99s/it]
Task 13, Epoch 18/20 => Loss 0.108, Train_accy 95.59:  85%|████████▌ | 17/20 [04:06<00:41, 13.99s/it]
Task 13, Epoch 18/20 => Loss 0.108, Train_accy 95.59:  90%|█████████ | 18/20 [04:06<00:25, 12.74s/it]
Task 13, Epoch 19/20 => Loss 0.099, Train_accy 96.28:  90%|█████████ | 18/20 [04:16<00:25, 12.74s/it]
Task 13, Epoch 19/20 => Loss 0.099, Train_accy 96.28:  95%|█████████▌| 19/20 [04:16<00:11, 11.77s/it]
Task 13, Epoch 20/20 => Loss 0.097, Train_accy 95.67, Test_accy 65.09:  95%|█████████▌| 19/20 [04:47<00:11, 11.77s/it]
Task 13, Epoch 20/20 => Loss 0.097, Train_accy 95.67, Test_accy 65.09: 100%|██████████| 20/20 [04:47<00:00, 17.68s/it]
Task 13, Epoch 20/20 => Loss 0.097, Train_accy 95.67, Test_accy 65.09: 100%|██████████| 20/20 [04:47<00:00, 14.39s/it]
2024-09-12 12:39:24,006 [dualprompt.py] => Task 13, Epoch 20/20 => Loss 0.097, Train_accy 95.67, Test_accy 65.09
2024-09-12 12:39:47,636 [trainer.py] => No NME accuracy.
2024-09-12 12:39:47,636 [trainer.py] => CNN: {'total': 65.09, '00-09': 74.13, '10-19': 73.66, '20-29': 64.67, '30-39': 71.99, '40-49': 60.26, '50-59': 68.42, '60-69': 59.06, '70-79': 64.47, '80-89': 60.97, '90-99': 55.37, '100-109': 64.08, '110-119': 67.29, '120-129': 53.87, '130-139': 64.09, 'old': 65.17, 'new': 64.09}
2024-09-12 12:39:47,636 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3, 65.09]
2024-09-12 12:39:47,637 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58, 83.7]

Average Accuracy (CNN): 72.35
2024-09-12 12:39:47,637 [trainer.py] => Average Accuracy (CNN): 72.35 

2024-09-12 12:39:47,639 [trainer.py] => All params: 172158352
2024-09-12 12:39:47,641 [trainer.py] => Trainable params: 407240
2024-09-12 12:39:47,641 [dualprompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.038, Train_accy 65.94:   0%|          | 0/20 [00:12<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.038, Train_accy 65.94:   5%|▌         | 1/20 [00:12<03:48, 12.04s/it]
Task 14, Epoch 2/20 => Loss 0.377, Train_accy 86.64:   5%|▌         | 1/20 [00:24<03:48, 12.04s/it]
Task 14, Epoch 2/20 => Loss 0.377, Train_accy 86.64:  10%|█         | 2/20 [00:24<03:37, 12.06s/it]
Task 14, Epoch 3/20 => Loss 0.264, Train_accy 90.46:  10%|█         | 2/20 [00:36<03:37, 12.06s/it]
Task 14, Epoch 3/20 => Loss 0.264, Train_accy 90.46:  15%|█▌        | 3/20 [00:36<03:24, 12.03s/it]
Task 14, Epoch 4/20 => Loss 0.248, Train_accy 91.10:  15%|█▌        | 3/20 [00:48<03:24, 12.03s/it]
Task 14, Epoch 4/20 => Loss 0.248, Train_accy 91.10:  20%|██        | 4/20 [00:48<03:12, 12.03s/it]
Task 14, Epoch 5/20 => Loss 0.223, Train_accy 92.51, Test_accy 63.81:  20%|██        | 4/20 [01:25<03:12, 12.03s/it]
Task 14, Epoch 5/20 => Loss 0.223, Train_accy 92.51, Test_accy 63.81:  25%|██▌       | 5/20 [01:25<05:18, 21.20s/it]
Task 14, Epoch 6/20 => Loss 0.180, Train_accy 93.50:  25%|██▌       | 5/20 [01:37<05:18, 21.20s/it]                 
Task 14, Epoch 6/20 => Loss 0.180, Train_accy 93.50:  30%|███       | 6/20 [01:37<04:12, 18.07s/it]
Task 14, Epoch 7/20 => Loss 0.170, Train_accy 93.22:  30%|███       | 6/20 [01:49<04:12, 18.07s/it]
Task 14, Epoch 7/20 => Loss 0.170, Train_accy 93.22:  35%|███▌      | 7/20 [01:49<03:28, 16.06s/it]
Task 14, Epoch 8/20 => Loss 0.137, Train_accy 94.56:  35%|███▌      | 7/20 [02:01<03:28, 16.06s/it]
Task 14, Epoch 8/20 => Loss 0.137, Train_accy 94.56:  40%|████      | 8/20 [02:01<02:56, 14.75s/it]
Task 14, Epoch 9/20 => Loss 0.119, Train_accy 95.05:  40%|████      | 8/20 [02:13<02:56, 14.75s/it]
Task 14, Epoch 9/20 => Loss 0.119, Train_accy 95.05:  45%|████▌     | 9/20 [02:13<02:32, 13.90s/it]
Task 14, Epoch 10/20 => Loss 0.122, Train_accy 95.62, Test_accy 64.55:  45%|████▌     | 9/20 [02:49<02:32, 13.90s/it]
Task 14, Epoch 10/20 => Loss 0.122, Train_accy 95.62, Test_accy 64.55:  50%|█████     | 10/20 [02:49<03:27, 20.73s/it]
Task 14, Epoch 11/20 => Loss 0.164, Train_accy 93.71:  50%|█████     | 10/20 [03:00<03:27, 20.73s/it]                 
Task 14, Epoch 11/20 => Loss 0.164, Train_accy 93.71:  55%|█████▌    | 11/20 [03:00<02:41, 17.90s/it]
Task 14, Epoch 12/20 => Loss 0.122, Train_accy 95.27:  55%|█████▌    | 11/20 [03:12<02:41, 17.90s/it]
Task 14, Epoch 12/20 => Loss 0.122, Train_accy 95.27:  60%|██████    | 12/20 [03:12<02:08, 16.09s/it]
Task 14, Epoch 13/20 => Loss 0.152, Train_accy 94.56:  60%|██████    | 12/20 [03:24<02:08, 16.09s/it]
Task 14, Epoch 13/20 => Loss 0.152, Train_accy 94.56:  65%|██████▌   | 13/20 [03:24<01:43, 14.83s/it]
Task 14, Epoch 14/20 => Loss 0.147, Train_accy 93.92:  65%|██████▌   | 13/20 [03:36<01:43, 14.83s/it]
Task 14, Epoch 14/20 => Loss 0.147, Train_accy 93.92:  70%|███████   | 14/20 [03:36<01:23, 13.94s/it]
Task 14, Epoch 15/20 => Loss 0.134, Train_accy 94.70, Test_accy 64.77:  70%|███████   | 14/20 [04:14<01:23, 13.94s/it]
Task 14, Epoch 15/20 => Loss 0.134, Train_accy 94.70, Test_accy 64.77:  75%|███████▌  | 15/20 [04:14<01:45, 21.03s/it]
Task 14, Epoch 16/20 => Loss 0.113, Train_accy 95.41:  75%|███████▌  | 15/20 [04:26<01:45, 21.03s/it]                 
Task 14, Epoch 16/20 => Loss 0.113, Train_accy 95.41:  80%|████████  | 16/20 [04:26<01:13, 18.35s/it]
Task 14, Epoch 17/20 => Loss 0.103, Train_accy 95.69:  80%|████████  | 16/20 [04:38<01:13, 18.35s/it]
Task 14, Epoch 17/20 => Loss 0.103, Train_accy 95.69:  85%|████████▌ | 17/20 [04:38<00:49, 16.45s/it]
Task 14, Epoch 18/20 => Loss 0.140, Train_accy 94.56:  85%|████████▌ | 17/20 [04:50<00:49, 16.45s/it]
Task 14, Epoch 18/20 => Loss 0.140, Train_accy 94.56:  90%|█████████ | 18/20 [04:50<00:30, 15.16s/it]
Task 14, Epoch 19/20 => Loss 0.114, Train_accy 95.41:  90%|█████████ | 18/20 [05:02<00:30, 15.16s/it]
Task 14, Epoch 19/20 => Loss 0.114, Train_accy 95.41:  95%|█████████▌| 19/20 [05:02<00:14, 14.23s/it]
Task 14, Epoch 20/20 => Loss 0.105, Train_accy 94.98, Test_accy 65.14:  95%|█████████▌| 19/20 [05:40<00:14, 14.23s/it]
Task 14, Epoch 20/20 => Loss 0.105, Train_accy 94.98, Test_accy 65.14: 100%|██████████| 20/20 [05:40<00:00, 21.23s/it]
Task 14, Epoch 20/20 => Loss 0.105, Train_accy 94.98, Test_accy 65.14: 100%|██████████| 20/20 [05:40<00:00, 17.01s/it]
2024-09-12 12:45:27,791 [dualprompt.py] => Task 14, Epoch 20/20 => Loss 0.105, Train_accy 94.98, Test_accy 65.14
2024-09-12 12:45:52,397 [trainer.py] => No NME accuracy.
2024-09-12 12:45:52,398 [trainer.py] => CNN: {'total': 65.14, '00-09': 73.82, '10-19': 74.19, '20-29': 64.67, '30-39': 71.08, '40-49': 60.26, '50-59': 67.43, '60-69': 59.73, '70-79': 64.84, '80-89': 61.29, '90-99': 54.24, '100-109': 62.32, '110-119': 65.96, '120-129': 53.87, '130-139': 63.42, '140-149': 69.75, 'old': 64.74, 'new': 69.75}
2024-09-12 12:45:52,398 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3, 65.09, 65.14]
2024-09-12 12:45:52,398 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58, 83.7, 83.96]

Average Accuracy (CNN): 71.87
2024-09-12 12:45:52,398 [trainer.py] => Average Accuracy (CNN): 71.87 

2024-09-12 12:45:52,401 [trainer.py] => All params: 172158352
2024-09-12 12:45:52,403 [trainer.py] => Trainable params: 407240
2024-09-12 12:45:52,403 [dualprompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.480, Train_accy 55.39:   0%|          | 0/20 [00:11<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.480, Train_accy 55.39:   5%|▌         | 1/20 [00:11<03:31, 11.13s/it]
Task 15, Epoch 2/20 => Loss 0.531, Train_accy 81.87:   5%|▌         | 1/20 [00:22<03:31, 11.13s/it]
Task 15, Epoch 2/20 => Loss 0.531, Train_accy 81.87:  10%|█         | 2/20 [00:22<03:24, 11.33s/it]
Task 15, Epoch 3/20 => Loss 0.414, Train_accy 86.22:  10%|█         | 2/20 [00:34<03:24, 11.33s/it]
Task 15, Epoch 3/20 => Loss 0.414, Train_accy 86.22:  15%|█▌        | 3/20 [00:34<03:17, 11.60s/it]
Task 15, Epoch 4/20 => Loss 0.329, Train_accy 88.94:  15%|█▌        | 3/20 [00:46<03:17, 11.60s/it]
Task 15, Epoch 4/20 => Loss 0.329, Train_accy 88.94:  20%|██        | 4/20 [00:46<03:06, 11.68s/it]
Task 15, Epoch 5/20 => Loss 0.275, Train_accy 89.15, Test_accy 64.05:  20%|██        | 4/20 [01:25<03:06, 11.68s/it]
Task 15, Epoch 5/20 => Loss 0.275, Train_accy 89.15, Test_accy 64.05:  25%|██▌       | 5/20 [01:25<05:26, 21.77s/it]
Task 15, Epoch 6/20 => Loss 0.258, Train_accy 90.79:  25%|██▌       | 5/20 [01:38<05:26, 21.77s/it]                 
Task 15, Epoch 6/20 => Loss 0.258, Train_accy 90.79:  30%|███       | 6/20 [01:38<04:18, 18.46s/it]
Task 15, Epoch 7/20 => Loss 0.237, Train_accy 92.29:  30%|███       | 6/20 [01:49<04:18, 18.46s/it]
Task 15, Epoch 7/20 => Loss 0.237, Train_accy 92.29:  35%|███▌      | 7/20 [01:49<03:32, 16.32s/it]
Task 15, Epoch 8/20 => Loss 0.213, Train_accy 92.43:  35%|███▌      | 7/20 [02:01<03:32, 16.32s/it]
Task 15, Epoch 8/20 => Loss 0.213, Train_accy 92.43:  40%|████      | 8/20 [02:01<02:59, 14.94s/it]
Task 15, Epoch 9/20 => Loss 0.182, Train_accy 93.29:  40%|████      | 8/20 [02:13<02:59, 14.94s/it]
Task 15, Epoch 9/20 => Loss 0.182, Train_accy 93.29:  45%|████▌     | 9/20 [02:13<02:34, 14.02s/it]
Task 15, Epoch 10/20 => Loss 0.186, Train_accy 93.00, Test_accy 64.60:  45%|████▌     | 9/20 [02:53<02:34, 14.02s/it]
Task 15, Epoch 10/20 => Loss 0.186, Train_accy 93.00, Test_accy 64.60:  50%|█████     | 10/20 [02:53<03:38, 21.83s/it]
Task 15, Epoch 11/20 => Loss 0.146, Train_accy 94.29:  50%|█████     | 10/20 [03:05<03:38, 21.83s/it]                 
Task 15, Epoch 11/20 => Loss 0.146, Train_accy 94.29:  55%|█████▌    | 11/20 [03:05<02:49, 18.81s/it]
Task 15, Epoch 12/20 => Loss 0.186, Train_accy 93.00:  55%|█████▌    | 11/20 [03:16<02:49, 18.81s/it]
Task 15, Epoch 12/20 => Loss 0.186, Train_accy 93.00:  60%|██████    | 12/20 [03:16<02:12, 16.54s/it]
Task 15, Epoch 13/20 => Loss 0.151, Train_accy 93.93:  60%|██████    | 12/20 [03:27<02:12, 16.54s/it]
Task 15, Epoch 13/20 => Loss 0.151, Train_accy 93.93:  65%|██████▌   | 13/20 [03:27<01:44, 14.96s/it]
Task 15, Epoch 14/20 => Loss 0.155, Train_accy 93.86:  65%|██████▌   | 13/20 [03:39<01:44, 14.96s/it]
Task 15, Epoch 14/20 => Loss 0.155, Train_accy 93.86:  70%|███████   | 14/20 [03:39<01:23, 13.84s/it]
Task 15, Epoch 15/20 => Loss 0.161, Train_accy 93.65, Test_accy 64.82:  70%|███████   | 14/20 [04:18<01:23, 13.84s/it]
Task 15, Epoch 15/20 => Loss 0.161, Train_accy 93.65, Test_accy 64.82:  75%|███████▌  | 15/20 [04:18<01:47, 21.46s/it]
Task 15, Epoch 16/20 => Loss 0.138, Train_accy 94.50:  75%|███████▌  | 15/20 [04:30<01:47, 21.46s/it]                 
Task 15, Epoch 16/20 => Loss 0.138, Train_accy 94.50:  80%|████████  | 16/20 [04:30<01:14, 18.59s/it]
Task 15, Epoch 17/20 => Loss 0.135, Train_accy 95.07:  80%|████████  | 16/20 [04:42<01:14, 18.59s/it]
Task 15, Epoch 17/20 => Loss 0.135, Train_accy 95.07:  85%|████████▌ | 17/20 [04:42<00:49, 16.59s/it]
Task 15, Epoch 18/20 => Loss 0.123, Train_accy 94.93:  85%|████████▌ | 17/20 [04:54<00:49, 16.59s/it]
Task 15, Epoch 18/20 => Loss 0.123, Train_accy 94.93:  90%|█████████ | 18/20 [04:54<00:30, 15.19s/it]
Task 15, Epoch 19/20 => Loss 0.153, Train_accy 93.72:  90%|█████████ | 18/20 [05:06<00:30, 15.19s/it]
Task 15, Epoch 19/20 => Loss 0.153, Train_accy 93.72:  95%|█████████▌| 19/20 [05:06<00:14, 14.22s/it]
Task 15, Epoch 20/20 => Loss 0.096, Train_accy 95.93, Test_accy 64.98:  95%|█████████▌| 19/20 [05:45<00:14, 14.22s/it]
Task 15, Epoch 20/20 => Loss 0.096, Train_accy 95.93, Test_accy 64.98: 100%|██████████| 20/20 [05:45<00:00, 21.72s/it]
Task 15, Epoch 20/20 => Loss 0.096, Train_accy 95.93, Test_accy 64.98: 100%|██████████| 20/20 [05:45<00:00, 17.26s/it]
2024-09-12 12:51:37,637 [dualprompt.py] => Task 15, Epoch 20/20 => Loss 0.096, Train_accy 95.93, Test_accy 64.98
2024-09-12 12:52:05,028 [trainer.py] => No NME accuracy.
2024-09-12 12:52:05,028 [trainer.py] => CNN: {'total': 64.98, '00-09': 73.5, '10-19': 73.39, '20-29': 65.0, '30-39': 71.99, '40-49': 58.61, '50-59': 67.43, '60-69': 61.41, '70-79': 63.74, '80-89': 61.61, '90-99': 53.11, '100-109': 60.56, '110-119': 64.89, '120-129': 55.35, '130-139': 63.42, '140-149': 70.3, '150-159': 64.92, 'old': 64.99, 'new': 64.92}
2024-09-12 12:52:05,028 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3, 65.09, 65.14, 64.98]
2024-09-12 12:52:05,028 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58, 83.7, 83.96, 83.88]

Average Accuracy (CNN): 71.44
2024-09-12 12:52:05,029 [trainer.py] => Average Accuracy (CNN): 71.44 

2024-09-12 12:52:05,030 [trainer.py] => All params: 172158352
2024-09-12 12:52:05,032 [trainer.py] => Trainable params: 407240
2024-09-12 12:52:05,032 [dualprompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.875, Train_accy 43.66:   0%|          | 0/20 [00:08<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.875, Train_accy 43.66:   5%|▌         | 1/20 [00:08<02:42,  8.54s/it]
Task 16, Epoch 2/20 => Loss 0.772, Train_accy 72.94:   5%|▌         | 1/20 [00:17<02:42,  8.54s/it]
Task 16, Epoch 2/20 => Loss 0.772, Train_accy 72.94:  10%|█         | 2/20 [00:17<02:33,  8.53s/it]
Task 16, Epoch 3/20 => Loss 0.570, Train_accy 79.58:  10%|█         | 2/20 [00:25<02:33,  8.53s/it]
Task 16, Epoch 3/20 => Loss 0.570, Train_accy 79.58:  15%|█▌        | 3/20 [00:25<02:24,  8.48s/it]
Task 16, Epoch 4/20 => Loss 0.438, Train_accy 84.51:  15%|█▌        | 3/20 [00:33<02:24,  8.48s/it]
Task 16, Epoch 4/20 => Loss 0.438, Train_accy 84.51:  20%|██        | 4/20 [00:33<02:13,  8.32s/it]
Task 16, Epoch 5/20 => Loss 0.426, Train_accy 86.42, Test_accy 63.81:  20%|██        | 4/20 [01:09<02:13,  8.32s/it]
Task 16, Epoch 5/20 => Loss 0.426, Train_accy 86.42, Test_accy 63.81:  25%|██▌       | 5/20 [01:09<04:34, 18.28s/it]
Task 16, Epoch 6/20 => Loss 0.338, Train_accy 89.13:  25%|██▌       | 5/20 [01:18<04:34, 18.28s/it]                 
Task 16, Epoch 6/20 => Loss 0.338, Train_accy 89.13:  30%|███       | 6/20 [01:18<03:30, 15.01s/it]
Task 16, Epoch 7/20 => Loss 0.323, Train_accy 88.73:  30%|███       | 6/20 [01:26<03:30, 15.01s/it]
Task 16, Epoch 7/20 => Loss 0.323, Train_accy 88.73:  35%|███▌      | 7/20 [01:26<02:47, 12.86s/it]
Task 16, Epoch 8/20 => Loss 0.302, Train_accy 89.74:  35%|███▌      | 7/20 [01:34<02:47, 12.86s/it]
Task 16, Epoch 8/20 => Loss 0.302, Train_accy 89.74:  40%|████      | 8/20 [01:34<02:17, 11.44s/it]
Task 16, Epoch 9/20 => Loss 0.257, Train_accy 91.75:  40%|████      | 8/20 [01:43<02:17, 11.44s/it]
Task 16, Epoch 9/20 => Loss 0.257, Train_accy 91.75:  45%|████▌     | 9/20 [01:43<01:56, 10.56s/it]
Task 16, Epoch 10/20 => Loss 0.275, Train_accy 91.15, Test_accy 64.06:  45%|████▌     | 9/20 [02:20<01:56, 10.56s/it]
Task 16, Epoch 10/20 => Loss 0.275, Train_accy 91.15, Test_accy 64.06:  50%|█████     | 10/20 [02:20<03:07, 18.80s/it]
Task 16, Epoch 11/20 => Loss 0.218, Train_accy 92.45:  50%|█████     | 10/20 [02:29<03:07, 18.80s/it]                 
Task 16, Epoch 11/20 => Loss 0.218, Train_accy 92.45:  55%|█████▌    | 11/20 [02:29<02:21, 15.68s/it]
Task 16, Epoch 12/20 => Loss 0.290, Train_accy 89.94:  55%|█████▌    | 11/20 [02:37<02:21, 15.68s/it]
Task 16, Epoch 12/20 => Loss 0.290, Train_accy 89.94:  60%|██████    | 12/20 [02:37<01:48, 13.50s/it]
Task 16, Epoch 13/20 => Loss 0.211, Train_accy 92.35:  60%|██████    | 12/20 [02:46<01:48, 13.50s/it]
Task 16, Epoch 13/20 => Loss 0.211, Train_accy 92.35:  65%|██████▌   | 13/20 [02:46<01:23, 11.99s/it]
Task 16, Epoch 14/20 => Loss 0.206, Train_accy 93.46:  65%|██████▌   | 13/20 [02:54<01:23, 11.99s/it]
Task 16, Epoch 14/20 => Loss 0.206, Train_accy 93.46:  70%|███████   | 14/20 [02:54<01:05, 10.93s/it]
Task 16, Epoch 15/20 => Loss 0.213, Train_accy 92.76, Test_accy 64.18:  70%|███████   | 14/20 [03:31<01:05, 10.93s/it]
Task 16, Epoch 15/20 => Loss 0.213, Train_accy 92.76, Test_accy 64.18:  75%|███████▌  | 15/20 [03:31<01:33, 18.79s/it]
Task 16, Epoch 16/20 => Loss 0.199, Train_accy 92.35:  75%|███████▌  | 15/20 [03:40<01:33, 18.79s/it]                 
Task 16, Epoch 16/20 => Loss 0.199, Train_accy 92.35:  80%|████████  | 16/20 [03:40<01:02, 15.73s/it]
Task 16, Epoch 17/20 => Loss 0.200, Train_accy 92.45:  80%|████████  | 16/20 [03:48<01:02, 15.73s/it]
Task 16, Epoch 17/20 => Loss 0.200, Train_accy 92.45:  85%|████████▌ | 17/20 [03:48<00:40, 13.52s/it]
Task 16, Epoch 18/20 => Loss 0.172, Train_accy 94.16:  85%|████████▌ | 17/20 [03:57<00:40, 13.52s/it]
Task 16, Epoch 18/20 => Loss 0.172, Train_accy 94.16:  90%|█████████ | 18/20 [03:57<00:23, 11.90s/it]
Task 16, Epoch 19/20 => Loss 0.181, Train_accy 94.06:  90%|█████████ | 18/20 [04:05<00:23, 11.90s/it]
Task 16, Epoch 19/20 => Loss 0.181, Train_accy 94.06:  95%|█████████▌| 19/20 [04:05<00:10, 10.77s/it]
Task 16, Epoch 20/20 => Loss 0.187, Train_accy 91.85, Test_accy 64.35:  95%|█████████▌| 19/20 [04:41<00:10, 10.77s/it]
Task 16, Epoch 20/20 => Loss 0.187, Train_accy 91.85, Test_accy 64.35: 100%|██████████| 20/20 [04:41<00:00, 18.38s/it]
Task 16, Epoch 20/20 => Loss 0.187, Train_accy 91.85, Test_accy 64.35: 100%|██████████| 20/20 [04:41<00:00, 14.07s/it]
2024-09-12 12:56:46,397 [dualprompt.py] => Task 16, Epoch 20/20 => Loss 0.187, Train_accy 91.85, Test_accy 64.35
2024-09-12 12:57:14,972 [trainer.py] => No NME accuracy.
2024-09-12 12:57:14,973 [trainer.py] => CNN: {'total': 64.35, '00-09': 73.82, '10-19': 72.58, '20-29': 63.33, '30-39': 71.39, '40-49': 59.27, '50-59': 67.43, '60-69': 61.41, '70-79': 64.47, '80-89': 62.26, '90-99': 52.54, '100-109': 61.27, '110-119': 65.43, '120-129': 54.61, '130-139': 64.09, '140-149': 71.12, '150-159': 64.92, '160-169': 49.57, 'old': 65.04, 'new': 49.57}
2024-09-12 12:57:14,973 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3, 65.09, 65.14, 64.98, 64.35]
2024-09-12 12:57:14,973 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58, 83.7, 83.96, 83.88, 82.81]

Average Accuracy (CNN): 71.02
2024-09-12 12:57:14,973 [trainer.py] => Average Accuracy (CNN): 71.02 

2024-09-12 12:57:14,975 [trainer.py] => All params: 172158352
2024-09-12 12:57:14,977 [trainer.py] => Trainable params: 407240
2024-09-12 12:57:14,977 [dualprompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.431, Train_accy 55.97:   0%|          | 0/20 [00:08<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.431, Train_accy 55.97:   5%|▌         | 1/20 [00:08<02:35,  8.20s/it]
Task 17, Epoch 2/20 => Loss 0.466, Train_accy 85.32:   5%|▌         | 1/20 [00:16<02:35,  8.20s/it]
Task 17, Epoch 2/20 => Loss 0.466, Train_accy 85.32:  10%|█         | 2/20 [00:16<02:28,  8.22s/it]
Task 17, Epoch 3/20 => Loss 0.340, Train_accy 88.47:  10%|█         | 2/20 [00:24<02:28,  8.22s/it]
Task 17, Epoch 3/20 => Loss 0.340, Train_accy 88.47:  15%|█▌        | 3/20 [00:24<02:20,  8.26s/it]
Task 17, Epoch 4/20 => Loss 0.236, Train_accy 91.30:  15%|█▌        | 3/20 [00:33<02:20,  8.26s/it]
Task 17, Epoch 4/20 => Loss 0.236, Train_accy 91.30:  20%|██        | 4/20 [00:33<02:12,  8.28s/it]
Task 17, Epoch 5/20 => Loss 0.217, Train_accy 91.93, Test_accy 63.68:  20%|██        | 4/20 [01:11<02:12,  8.28s/it]
Task 17, Epoch 5/20 => Loss 0.217, Train_accy 91.93, Test_accy 63.68:  25%|██▌       | 5/20 [01:11<04:47, 19.16s/it]
Task 17, Epoch 6/20 => Loss 0.169, Train_accy 94.44:  25%|██▌       | 5/20 [01:19<04:47, 19.16s/it]                 
Task 17, Epoch 6/20 => Loss 0.169, Train_accy 94.44:  30%|███       | 6/20 [01:19<03:36, 15.44s/it]
Task 17, Epoch 7/20 => Loss 0.180, Train_accy 94.34:  30%|███       | 6/20 [01:28<03:36, 15.44s/it]
Task 17, Epoch 7/20 => Loss 0.180, Train_accy 94.34:  35%|███▌      | 7/20 [01:28<02:50, 13.13s/it]
Task 17, Epoch 8/20 => Loss 0.165, Train_accy 93.71:  35%|███▌      | 7/20 [01:36<02:50, 13.13s/it]
Task 17, Epoch 8/20 => Loss 0.165, Train_accy 93.71:  40%|████      | 8/20 [01:36<02:18, 11.57s/it]
Task 17, Epoch 9/20 => Loss 0.129, Train_accy 95.28:  40%|████      | 8/20 [01:44<02:18, 11.57s/it]
Task 17, Epoch 9/20 => Loss 0.129, Train_accy 95.28:  45%|████▌     | 9/20 [01:44<01:56, 10.58s/it]
Task 17, Epoch 10/20 => Loss 0.172, Train_accy 94.03, Test_accy 64.19:  45%|████▌     | 9/20 [02:21<01:56, 10.58s/it]
Task 17, Epoch 10/20 => Loss 0.172, Train_accy 94.03, Test_accy 64.19:  50%|█████     | 10/20 [02:21<03:07, 18.79s/it]
Task 17, Epoch 11/20 => Loss 0.123, Train_accy 95.28:  50%|█████     | 10/20 [02:29<03:07, 18.79s/it]                 
Task 17, Epoch 11/20 => Loss 0.123, Train_accy 95.28:  55%|█████▌    | 11/20 [02:29<02:18, 15.44s/it]
Task 17, Epoch 12/20 => Loss 0.128, Train_accy 94.23:  55%|█████▌    | 11/20 [02:37<02:18, 15.44s/it]
Task 17, Epoch 12/20 => Loss 0.128, Train_accy 94.23:  60%|██████    | 12/20 [02:37<01:45, 13.13s/it]
Task 17, Epoch 13/20 => Loss 0.132, Train_accy 94.76:  60%|██████    | 12/20 [02:45<01:45, 13.13s/it]
Task 17, Epoch 13/20 => Loss 0.132, Train_accy 94.76:  65%|██████▌   | 13/20 [02:45<01:21, 11.68s/it]
Task 17, Epoch 14/20 => Loss 0.141, Train_accy 94.44:  65%|██████▌   | 13/20 [02:54<01:21, 11.68s/it]
Task 17, Epoch 14/20 => Loss 0.141, Train_accy 94.44:  70%|███████   | 14/20 [02:54<01:03, 10.63s/it]
Task 17, Epoch 15/20 => Loss 0.134, Train_accy 95.39, Test_accy 64.29:  70%|███████   | 14/20 [03:32<01:03, 10.63s/it]
Task 17, Epoch 15/20 => Loss 0.134, Train_accy 95.39, Test_accy 64.29:  75%|███████▌  | 15/20 [03:32<01:35, 19.13s/it]
Task 17, Epoch 16/20 => Loss 0.118, Train_accy 95.39:  75%|███████▌  | 15/20 [03:41<01:35, 19.13s/it]                 
Task 17, Epoch 16/20 => Loss 0.118, Train_accy 95.39:  80%|████████  | 16/20 [03:41<01:04, 16.05s/it]
Task 17, Epoch 17/20 => Loss 0.073, Train_accy 96.75:  80%|████████  | 16/20 [03:50<01:04, 16.05s/it]
Task 17, Epoch 17/20 => Loss 0.073, Train_accy 96.75:  85%|████████▌ | 17/20 [03:50<00:41, 13.68s/it]
Task 17, Epoch 18/20 => Loss 0.103, Train_accy 95.28:  85%|████████▌ | 17/20 [03:58<00:41, 13.68s/it]
Task 17, Epoch 18/20 => Loss 0.103, Train_accy 95.28:  90%|█████████ | 18/20 [03:58<00:24, 12.11s/it]
Task 17, Epoch 19/20 => Loss 0.103, Train_accy 95.81:  90%|█████████ | 18/20 [04:06<00:24, 12.11s/it]
Task 17, Epoch 19/20 => Loss 0.103, Train_accy 95.81:  95%|█████████▌| 19/20 [04:06<00:10, 10.97s/it]
Task 17, Epoch 20/20 => Loss 0.085, Train_accy 96.12, Test_accy 64.36:  95%|█████████▌| 19/20 [04:45<00:10, 10.97s/it]
Task 17, Epoch 20/20 => Loss 0.085, Train_accy 96.12, Test_accy 64.36: 100%|██████████| 20/20 [04:45<00:00, 19.39s/it]
Task 17, Epoch 20/20 => Loss 0.085, Train_accy 96.12, Test_accy 64.36: 100%|██████████| 20/20 [04:45<00:00, 14.29s/it]
2024-09-12 13:02:00,836 [dualprompt.py] => Task 17, Epoch 20/20 => Loss 0.085, Train_accy 96.12, Test_accy 64.36
2024-09-12 13:02:31,002 [trainer.py] => No NME accuracy.
2024-09-12 13:02:31,003 [trainer.py] => CNN: {'total': 64.36, '00-09': 73.19, '10-19': 72.58, '20-29': 64.0, '30-39': 71.69, '40-49': 59.27, '50-59': 67.76, '60-69': 61.41, '70-79': 63.74, '80-89': 61.94, '90-99': 53.11, '100-109': 63.03, '110-119': 64.89, '120-129': 54.61, '130-139': 63.42, '140-149': 71.12, '150-159': 63.26, '160-169': 49.57, '170-179': 66.53, 'old': 64.26, 'new': 66.53}
2024-09-12 13:02:31,003 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3, 65.09, 65.14, 64.98, 64.35, 64.36]
2024-09-12 13:02:31,003 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58, 83.7, 83.96, 83.88, 82.81, 82.92]

Average Accuracy (CNN): 70.65
2024-09-12 13:02:31,003 [trainer.py] => Average Accuracy (CNN): 70.65 

2024-09-12 13:02:31,006 [trainer.py] => All params: 172158352
2024-09-12 13:02:31,008 [trainer.py] => Trainable params: 407240
2024-09-12 13:02:31,008 [dualprompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.546, Train_accy 53.94:   0%|          | 0/20 [00:09<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.546, Train_accy 53.94:   5%|▌         | 1/20 [00:09<03:07,  9.88s/it]
Task 18, Epoch 2/20 => Loss 0.567, Train_accy 80.74:   5%|▌         | 1/20 [00:19<03:07,  9.88s/it]
Task 18, Epoch 2/20 => Loss 0.567, Train_accy 80.74:  10%|█         | 2/20 [00:19<02:53,  9.65s/it]
Task 18, Epoch 3/20 => Loss 0.377, Train_accy 87.30:  10%|█         | 2/20 [00:28<02:53,  9.65s/it]
Task 18, Epoch 3/20 => Loss 0.377, Train_accy 87.30:  15%|█▌        | 3/20 [00:28<02:41,  9.49s/it]
Task 18, Epoch 4/20 => Loss 0.318, Train_accy 88.88:  15%|█▌        | 3/20 [00:37<02:41,  9.49s/it]
Task 18, Epoch 4/20 => Loss 0.318, Train_accy 88.88:  20%|██        | 4/20 [00:37<02:30,  9.38s/it]
Task 18, Epoch 5/20 => Loss 0.245, Train_accy 90.28, Test_accy 62.91:  20%|██        | 4/20 [01:19<02:30,  9.38s/it]
Task 18, Epoch 5/20 => Loss 0.245, Train_accy 90.28, Test_accy 62.91:  25%|██▌       | 5/20 [01:19<05:12, 20.86s/it]
Task 18, Epoch 6/20 => Loss 0.217, Train_accy 92.38:  25%|██▌       | 5/20 [01:28<05:12, 20.86s/it]                 
Task 18, Epoch 6/20 => Loss 0.217, Train_accy 92.38:  30%|███       | 6/20 [01:28<03:59, 17.09s/it]
Task 18, Epoch 7/20 => Loss 0.214, Train_accy 92.29:  30%|███       | 6/20 [01:38<03:59, 17.09s/it]
Task 18, Epoch 7/20 => Loss 0.214, Train_accy 92.29:  35%|███▌      | 7/20 [01:38<03:11, 14.73s/it]
Task 18, Epoch 8/20 => Loss 0.200, Train_accy 92.82:  35%|███▌      | 7/20 [01:48<03:11, 14.73s/it]
Task 18, Epoch 8/20 => Loss 0.200, Train_accy 92.82:  40%|████      | 8/20 [01:48<02:38, 13.18s/it]
Task 18, Epoch 9/20 => Loss 0.170, Train_accy 93.35:  40%|████      | 8/20 [01:58<02:38, 13.18s/it]
Task 18, Epoch 9/20 => Loss 0.170, Train_accy 93.35:  45%|████▌     | 9/20 [01:58<02:13, 12.13s/it]
Task 18, Epoch 10/20 => Loss 0.181, Train_accy 94.05, Test_accy 63.48:  45%|████▌     | 9/20 [02:40<02:13, 12.13s/it]
Task 18, Epoch 10/20 => Loss 0.181, Train_accy 94.05, Test_accy 63.48:  50%|█████     | 10/20 [02:40<03:33, 21.36s/it]
Task 18, Epoch 11/20 => Loss 0.145, Train_accy 94.48:  50%|█████     | 10/20 [02:50<03:33, 21.36s/it]                 
Task 18, Epoch 11/20 => Loss 0.145, Train_accy 94.48:  55%|█████▌    | 11/20 [02:50<02:40, 17.85s/it]
Task 18, Epoch 12/20 => Loss 0.144, Train_accy 94.31:  55%|█████▌    | 11/20 [03:00<02:40, 17.85s/it]
Task 18, Epoch 12/20 => Loss 0.144, Train_accy 94.31:  60%|██████    | 12/20 [03:00<02:03, 15.38s/it]
Task 18, Epoch 13/20 => Loss 0.148, Train_accy 94.40:  60%|██████    | 12/20 [03:09<02:03, 15.38s/it]
Task 18, Epoch 13/20 => Loss 0.148, Train_accy 94.40:  65%|██████▌   | 13/20 [03:09<01:35, 13.67s/it]
Task 18, Epoch 14/20 => Loss 0.143, Train_accy 94.92:  65%|██████▌   | 13/20 [03:19<01:35, 13.67s/it]
Task 18, Epoch 14/20 => Loss 0.143, Train_accy 94.92:  70%|███████   | 14/20 [03:19<01:14, 12.47s/it]
Task 18, Epoch 15/20 => Loss 0.129, Train_accy 95.01, Test_accy 63.57:  70%|███████   | 14/20 [03:59<01:14, 12.47s/it]
Task 18, Epoch 15/20 => Loss 0.129, Train_accy 95.01, Test_accy 63.57:  75%|███████▌  | 15/20 [03:59<01:44, 20.89s/it]
Task 18, Epoch 16/20 => Loss 0.124, Train_accy 95.10:  75%|███████▌  | 15/20 [04:09<01:44, 20.89s/it]                 
Task 18, Epoch 16/20 => Loss 0.124, Train_accy 95.10:  80%|████████  | 16/20 [04:09<01:09, 17.37s/it]
Task 18, Epoch 17/20 => Loss 0.132, Train_accy 94.66:  80%|████████  | 16/20 [04:18<01:09, 17.37s/it]
Task 18, Epoch 17/20 => Loss 0.132, Train_accy 94.66:  85%|████████▌ | 17/20 [04:18<00:45, 15.06s/it]
Task 18, Epoch 18/20 => Loss 0.154, Train_accy 94.40:  85%|████████▌ | 17/20 [04:28<00:45, 15.06s/it]
Task 18, Epoch 18/20 => Loss 0.154, Train_accy 94.40:  90%|█████████ | 18/20 [04:28<00:27, 13.52s/it]
Task 18, Epoch 19/20 => Loss 0.091, Train_accy 96.32:  90%|█████████ | 18/20 [04:38<00:27, 13.52s/it]
Task 18, Epoch 19/20 => Loss 0.091, Train_accy 96.32:  95%|█████████▌| 19/20 [04:38<00:12, 12.37s/it]
Task 18, Epoch 20/20 => Loss 0.100, Train_accy 95.45, Test_accy 63.55:  95%|█████████▌| 19/20 [05:19<00:12, 12.37s/it]
Task 18, Epoch 20/20 => Loss 0.100, Train_accy 95.45, Test_accy 63.55: 100%|██████████| 20/20 [05:19<00:00, 21.08s/it]
Task 18, Epoch 20/20 => Loss 0.100, Train_accy 95.45, Test_accy 63.55: 100%|██████████| 20/20 [05:19<00:00, 15.99s/it]
2024-09-12 13:07:50,816 [dualprompt.py] => Task 18, Epoch 20/20 => Loss 0.100, Train_accy 95.45, Test_accy 63.55
2024-09-12 13:08:22,949 [trainer.py] => No NME accuracy.
2024-09-12 13:08:22,950 [trainer.py] => CNN: {'total': 63.55, '00-09': 73.5, '10-19': 73.12, '20-29': 63.67, '30-39': 71.69, '40-49': 59.6, '50-59': 67.11, '60-69': 60.4, '70-79': 63.74, '80-89': 61.29, '90-99': 51.41, '100-109': 63.03, '110-119': 64.36, '120-129': 56.09, '130-139': 63.76, '140-149': 71.12, '150-159': 63.81, '160-169': 48.26, '170-179': 66.53, '180-189': 50.97, 'old': 64.27, 'new': 50.97}
2024-09-12 13:08:22,950 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3, 65.09, 65.14, 64.98, 64.35, 64.36, 63.55]
2024-09-12 13:08:22,951 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58, 83.7, 83.96, 83.88, 82.81, 82.92, 82.48]

Average Accuracy (CNN): 70.28
2024-09-12 13:08:22,951 [trainer.py] => Average Accuracy (CNN): 70.28 

2024-09-12 13:08:22,954 [trainer.py] => All params: 172158352
2024-09-12 13:08:22,956 [trainer.py] => Trainable params: 407240
2024-09-12 13:08:22,956 [dualprompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.311, Train_accy 60.20:   0%|          | 0/20 [00:09<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.311, Train_accy 60.20:   5%|▌         | 1/20 [00:09<03:02,  9.63s/it]
Task 19, Epoch 2/20 => Loss 0.391, Train_accy 85.46:   5%|▌         | 1/20 [00:19<03:02,  9.63s/it]
Task 19, Epoch 2/20 => Loss 0.391, Train_accy 85.46:  10%|█         | 2/20 [00:19<02:54,  9.68s/it]
Task 19, Epoch 3/20 => Loss 0.280, Train_accy 88.74:  10%|█         | 2/20 [00:28<02:54,  9.68s/it]
Task 19, Epoch 3/20 => Loss 0.280, Train_accy 88.74:  15%|█▌        | 3/20 [00:28<02:44,  9.66s/it]
Task 19, Epoch 4/20 => Loss 0.219, Train_accy 91.31:  15%|█▌        | 3/20 [00:38<02:44,  9.66s/it]
Task 19, Epoch 4/20 => Loss 0.219, Train_accy 91.31:  20%|██        | 4/20 [00:38<02:35,  9.70s/it]
Task 19, Epoch 5/20 => Loss 0.212, Train_accy 92.38, Test_accy 62.70:  20%|██        | 4/20 [01:20<02:35,  9.70s/it]
Task 19, Epoch 5/20 => Loss 0.212, Train_accy 92.38, Test_accy 62.70:  25%|██▌       | 5/20 [01:20<05:21, 21.42s/it]
Task 19, Epoch 6/20 => Loss 0.183, Train_accy 92.91:  25%|██▌       | 5/20 [01:30<05:21, 21.42s/it]                 
Task 19, Epoch 6/20 => Loss 0.183, Train_accy 92.91:  30%|███       | 6/20 [01:30<04:01, 17.26s/it]
Task 19, Epoch 7/20 => Loss 0.155, Train_accy 94.06:  30%|███       | 6/20 [01:39<04:01, 17.26s/it]
Task 19, Epoch 7/20 => Loss 0.155, Train_accy 94.06:  35%|███▌      | 7/20 [01:39<03:09, 14.56s/it]
Task 19, Epoch 8/20 => Loss 0.145, Train_accy 94.06:  35%|███▌      | 7/20 [01:48<03:09, 14.56s/it]
Task 19, Epoch 8/20 => Loss 0.145, Train_accy 94.06:  40%|████      | 8/20 [01:48<02:34, 12.85s/it]
Task 19, Epoch 9/20 => Loss 0.126, Train_accy 95.12:  40%|████      | 8/20 [01:57<02:34, 12.85s/it]
Task 19, Epoch 9/20 => Loss 0.126, Train_accy 95.12:  45%|████▌     | 9/20 [01:57<02:10, 11.83s/it]
Task 19, Epoch 10/20 => Loss 0.110, Train_accy 95.39, Test_accy 62.87:  45%|████▌     | 9/20 [02:40<02:10, 11.83s/it]
Task 19, Epoch 10/20 => Loss 0.110, Train_accy 95.39, Test_accy 62.87:  50%|█████     | 10/20 [02:40<03:34, 21.43s/it]
Task 19, Epoch 11/20 => Loss 0.128, Train_accy 95.21:  50%|█████     | 10/20 [02:50<03:34, 21.43s/it]                 
Task 19, Epoch 11/20 => Loss 0.128, Train_accy 95.21:  55%|█████▌    | 11/20 [02:50<02:40, 17.84s/it]
Task 19, Epoch 12/20 => Loss 0.095, Train_accy 95.48:  55%|█████▌    | 11/20 [03:00<02:40, 17.84s/it]
Task 19, Epoch 12/20 => Loss 0.095, Train_accy 95.48:  60%|██████    | 12/20 [03:00<02:02, 15.33s/it]
Task 19, Epoch 13/20 => Loss 0.096, Train_accy 96.10:  60%|██████    | 12/20 [03:09<02:02, 15.33s/it]
Task 19, Epoch 13/20 => Loss 0.096, Train_accy 96.10:  65%|██████▌   | 13/20 [03:09<01:35, 13.60s/it]
Task 19, Epoch 14/20 => Loss 0.098, Train_accy 95.12:  65%|██████▌   | 13/20 [03:19<01:35, 13.60s/it]
Task 19, Epoch 14/20 => Loss 0.098, Train_accy 95.12:  70%|███████   | 14/20 [03:19<01:14, 12.42s/it]
Task 19, Epoch 15/20 => Loss 0.105, Train_accy 95.57, Test_accy 62.80:  70%|███████   | 14/20 [04:02<01:14, 12.42s/it]
Task 19, Epoch 15/20 => Loss 0.105, Train_accy 95.57, Test_accy 62.80:  75%|███████▌  | 15/20 [04:02<01:48, 21.60s/it]
Task 19, Epoch 16/20 => Loss 0.087, Train_accy 96.10:  75%|███████▌  | 15/20 [04:11<01:48, 21.60s/it]                 
Task 19, Epoch 16/20 => Loss 0.087, Train_accy 96.10:  80%|████████  | 16/20 [04:11<01:11, 18.00s/it]
Task 19, Epoch 17/20 => Loss 0.080, Train_accy 96.28:  80%|████████  | 16/20 [04:21<01:11, 18.00s/it]
Task 19, Epoch 17/20 => Loss 0.080, Train_accy 96.28:  85%|████████▌ | 17/20 [04:21<00:46, 15.49s/it]
Task 19, Epoch 18/20 => Loss 0.116, Train_accy 95.39:  85%|████████▌ | 17/20 [04:31<00:46, 15.49s/it]
Task 19, Epoch 18/20 => Loss 0.116, Train_accy 95.39:  90%|█████████ | 18/20 [04:31<00:27, 13.74s/it]
Task 19, Epoch 19/20 => Loss 0.098, Train_accy 96.01:  90%|█████████ | 18/20 [04:40<00:27, 13.74s/it]
Task 19, Epoch 19/20 => Loss 0.098, Train_accy 96.01:  95%|█████████▌| 19/20 [04:40<00:12, 12.38s/it]
Task 19, Epoch 20/20 => Loss 0.093, Train_accy 96.10, Test_accy 63.20:  95%|█████████▌| 19/20 [05:22<00:12, 12.38s/it]
Task 19, Epoch 20/20 => Loss 0.093, Train_accy 96.10, Test_accy 63.20: 100%|██████████| 20/20 [05:22<00:00, 21.15s/it]
Task 19, Epoch 20/20 => Loss 0.093, Train_accy 96.10, Test_accy 63.20: 100%|██████████| 20/20 [05:22<00:00, 16.10s/it]
2024-09-12 13:13:45,017 [dualprompt.py] => Task 19, Epoch 20/20 => Loss 0.093, Train_accy 96.10, Test_accy 63.20
2024-09-12 13:14:18,487 [trainer.py] => No NME accuracy.
2024-09-12 13:14:18,487 [trainer.py] => CNN: {'total': 63.2, '00-09': 73.19, '10-19': 74.46, '20-29': 62.33, '30-39': 70.48, '40-49': 58.94, '50-59': 66.12, '60-69': 61.74, '70-79': 63.37, '80-89': 62.26, '90-99': 53.11, '100-109': 59.51, '110-119': 64.63, '120-129': 54.98, '130-139': 64.09, '140-149': 71.93, '150-159': 63.26, '160-169': 47.39, '170-179': 68.55, '180-189': 50.97, '190-199': 58.3, 'old': 63.43, 'new': 58.3}
2024-09-12 13:14:18,488 [trainer.py] => CNN top1 curve: [88.33, 83.89, 79.58, 77.29, 74.61, 71.98, 69.98, 69.06, 67.81, 67.5, 66.35, 66.15, 65.3, 65.09, 65.14, 64.98, 64.35, 64.36, 63.55, 63.2]
2024-09-12 13:14:18,488 [trainer.py] => CNN top5 curve: [98.42, 95.5, 93.12, 92.28, 89.96, 89.47, 87.55, 86.59, 86.22, 85.36, 84.8, 84.44, 83.58, 83.7, 83.96, 83.88, 82.81, 82.92, 82.48, 82.52]

Average Accuracy (CNN): 69.92
2024-09-12 13:14:18,488 [trainer.py] => Average Accuracy (CNN): 69.92 

Accuracy Matrix (CNN):
[[88.33 82.65 80.44 78.55 75.08 74.76 73.19 71.92 72.24 73.82 73.5  74.13
  74.76 74.13 73.82 73.5  73.82 73.19 73.5  73.19]
 [ 0.   84.95 83.06 79.84 80.38 78.23 78.49 78.23 75.81 75.81 75.54 73.66
  73.92 73.66 74.19 73.39 72.58 72.58 73.12 74.46]
 [ 0.    0.   74.33 71.33 71.67 67.33 67.33 67.33 67.33 68.33 66.67 63.33
  64.   64.67 64.67 65.   63.33 64.   63.67 62.33]
 [ 0.    0.    0.   78.61 78.31 75.6  75.3  74.7  73.49 73.19 72.89 73.8
  71.69 71.99 71.08 71.99 71.39 71.69 71.69 70.48]
 [ 0.    0.    0.    0.   65.89 66.89 65.23 63.91 64.57 64.57 61.92 61.92
  60.6  60.26 60.26 58.61 59.27 59.27 59.6  58.94]
 [ 0.    0.    0.    0.    0.   67.11 67.76 67.76 66.45 66.78 67.76 68.09
  68.42 68.42 67.43 67.43 67.43 67.76 67.11 66.12]
 [ 0.    0.    0.    0.    0.    0.   59.73 59.06 58.72 60.74 58.72 59.4
  60.4  59.06 59.73 61.41 61.41 61.41 60.4  61.74]
 [ 0.    0.    0.    0.    0.    0.    0.   66.3  65.93 64.84 64.84 64.1
  64.1  64.47 64.84 63.74 64.47 63.74 63.74 63.37]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   62.9  62.58 59.03 60.32
  60.97 60.97 61.29 61.61 62.26 61.94 61.29 62.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   57.06 55.93 54.8
  55.37 55.37 54.24 53.11 52.54 53.11 51.41 53.11]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   65.49 65.49
  64.79 64.08 62.32 60.56 61.27 63.03 63.03 59.51]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   66.76
  66.49 67.29 65.96 64.89 65.43 64.89 64.36 64.63]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  54.61 53.87 53.87 55.35 54.61 54.61 56.09 54.98]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   64.09 63.42 63.42 64.09 63.42 63.76 64.09]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   69.75 70.3  71.12 71.12 71.12 71.93]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   64.92 64.92 63.26 63.81 63.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   49.57 49.57 48.26 47.39]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   66.53 66.53 68.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   50.97 50.97]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   58.3 ]]
2024-09-12 13:14:18,491 [trainer.py] => Forgetting (CNN): 4.058947368421054
2024-09-12 13:14:21,675 [trainer.py] => config: ./exps/dualprompt_inr_B100_Inc5.json
2024-09-12 13:14:21,690 [trainer.py] => prefix:  
2024-09-12 13:14:21,690 [trainer.py] => dataset: imagenetr
2024-09-12 13:14:21,690 [trainer.py] => memory_size: 0
2024-09-12 13:14:21,691 [trainer.py] => memory_per_class: 0
2024-09-12 13:14:21,691 [trainer.py] => fixed_memory: False
2024-09-12 13:14:21,691 [trainer.py] => shuffle: True
2024-09-12 13:14:21,691 [trainer.py] => init_cls: 100
2024-09-12 13:14:21,691 [trainer.py] => increment: 20
2024-09-12 13:14:21,691 [trainer.py] => model_name: dualprompt
2024-09-12 13:14:21,691 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 13:14:21,691 [trainer.py] => get_original_backbone: True
2024-09-12 13:14:21,691 [trainer.py] => device: [device(type='cuda', index=4)]
2024-09-12 13:14:21,691 [trainer.py] => seed: 1993
2024-09-12 13:14:21,691 [trainer.py] => tuned_epoch: 20
2024-09-12 13:14:21,691 [trainer.py] => init_lr: 0.001
2024-09-12 13:14:21,691 [trainer.py] => batch_size: 48
2024-09-12 13:14:21,691 [trainer.py] => weight_decay: 0
2024-09-12 13:14:21,691 [trainer.py] => min_lr: 1e-05
2024-09-12 13:14:21,691 [trainer.py] => optimizer: adam
2024-09-12 13:14:21,692 [trainer.py] => scheduler: constant
2024-09-12 13:14:21,692 [trainer.py] => reinit_optimizer: True
2024-09-12 13:14:21,692 [trainer.py] => global_pool: token
2024-09-12 13:14:21,692 [trainer.py] => head_type: token
2024-09-12 13:14:21,692 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 13:14:21,692 [trainer.py] => pretrained: True
2024-09-12 13:14:21,692 [trainer.py] => drop: 0.0
2024-09-12 13:14:21,692 [trainer.py] => drop_path: 0.0
2024-09-12 13:14:21,692 [trainer.py] => use_g_prompt: True
2024-09-12 13:14:21,692 [trainer.py] => g_prompt_length: 5
2024-09-12 13:14:21,692 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 13:14:21,692 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 13:14:21,692 [trainer.py] => use_e_prompt: True
2024-09-12 13:14:21,692 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 13:14:21,692 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 13:14:21,692 [trainer.py] => prompt_pool: True
2024-09-12 13:14:21,692 [trainer.py] => size: 10
2024-09-12 13:14:21,693 [trainer.py] => length: 5
2024-09-12 13:14:21,693 [trainer.py] => top_k: 1
2024-09-12 13:14:21,693 [trainer.py] => initializer: uniform
2024-09-12 13:14:21,693 [trainer.py] => prompt_key: True
2024-09-12 13:14:21,693 [trainer.py] => prompt_key_init: uniform
2024-09-12 13:14:21,693 [trainer.py] => use_prompt_mask: True
2024-09-12 13:14:21,693 [trainer.py] => shared_prompt_pool: True
2024-09-12 13:14:21,693 [trainer.py] => shared_prompt_key: False
2024-09-12 13:14:21,693 [trainer.py] => batchwise_prompt: True
2024-09-12 13:14:21,693 [trainer.py] => embedding_key: cls
2024-09-12 13:14:21,693 [trainer.py] => predefined_key: 
2024-09-12 13:14:21,693 [trainer.py] => pull_constraint: True
2024-09-12 13:14:21,693 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 13:14:21,693 [trainer.py] => same_key_value: False
2024-09-12 13:14:21,791 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 13:14:25,967 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 13:14:25,967 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 13:14:25,967 [dualprompt.py] => g_prompt: 15360
2024-09-12 13:14:25,967 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 13:14:25,967 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 13:14:25,968 [dualprompt.py] => head.weight: 153600
2024-09-12 13:14:25,968 [dualprompt.py] => head.bias: 200
2024-09-12 13:14:25,969 [trainer.py] => All params: 172158352
2024-09-12 13:14:25,970 [trainer.py] => Trainable params: 407240
2024-09-12 13:14:25,970 [dualprompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.370, Train_accy 48.15:   0%|          | 0/20 [01:39<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.370, Train_accy 48.15:   5%|▌         | 1/20 [01:39<31:34, 99.71s/it]
Task 0, Epoch 2/20 => Loss 1.356, Train_accy 67.11:   5%|▌         | 1/20 [03:17<31:34, 99.71s/it]
Task 0, Epoch 2/20 => Loss 1.356, Train_accy 67.11:  10%|█         | 2/20 [03:17<29:32, 98.48s/it]
Task 0, Epoch 3/20 => Loss 1.138, Train_accy 71.72:  10%|█         | 2/20 [04:57<29:32, 98.48s/it]
Task 0, Epoch 3/20 => Loss 1.138, Train_accy 71.72:  15%|█▌        | 3/20 [04:57<28:04, 99.08s/it]
Task 0, Epoch 4/20 => Loss 1.001, Train_accy 74.68:  15%|█▌        | 3/20 [06:35<28:04, 99.08s/it]
Task 0, Epoch 4/20 => Loss 1.001, Train_accy 74.68:  20%|██        | 4/20 [06:35<26:17, 98.62s/it]
Task 0, Epoch 5/20 => Loss 0.899, Train_accy 77.03, Test_accy 73.07:  20%|██        | 4/20 [08:32<26:17, 98.62s/it]
Task 0, Epoch 5/20 => Loss 0.899, Train_accy 77.03, Test_accy 73.07:  25%|██▌       | 5/20 [08:32<26:20, 105.35s/it]
Task 0, Epoch 6/20 => Loss 0.836, Train_accy 78.32:  25%|██▌       | 5/20 [10:10<26:20, 105.35s/it]                 
Task 0, Epoch 6/20 => Loss 0.836, Train_accy 78.32:  30%|███       | 6/20 [10:10<23:59, 102.84s/it]
Task 0, Epoch 7/20 => Loss 0.799, Train_accy 78.98:  30%|███       | 6/20 [11:50<23:59, 102.84s/it]
Task 0, Epoch 7/20 => Loss 0.799, Train_accy 78.98:  35%|███▌      | 7/20 [11:50<22:05, 101.96s/it]
Task 0, Epoch 8/20 => Loss 0.791, Train_accy 79.36:  35%|███▌      | 7/20 [13:28<22:05, 101.96s/it]
Task 0, Epoch 8/20 => Loss 0.791, Train_accy 79.36:  40%|████      | 8/20 [13:28<20:07, 100.64s/it]
Task 0, Epoch 9/20 => Loss 0.709, Train_accy 81.01:  40%|████      | 8/20 [15:07<20:07, 100.64s/it]
Task 0, Epoch 9/20 => Loss 0.709, Train_accy 81.01:  45%|████▌     | 9/20 [15:07<18:23, 100.35s/it]
Task 0, Epoch 10/20 => Loss 0.695, Train_accy 81.79, Test_accy 74.41:  45%|████▌     | 9/20 [17:02<18:23, 100.35s/it]
Task 0, Epoch 10/20 => Loss 0.695, Train_accy 81.79, Test_accy 74.41:  50%|█████     | 10/20 [17:02<17:26, 104.60s/it]
Task 0, Epoch 11/20 => Loss 0.656, Train_accy 82.55:  50%|█████     | 10/20 [18:42<17:26, 104.60s/it]                 
Task 0, Epoch 11/20 => Loss 0.656, Train_accy 82.55:  55%|█████▌    | 11/20 [18:42<15:29, 103.31s/it]
Task 0, Epoch 12/20 => Loss 0.629, Train_accy 83.21:  55%|█████▌    | 11/20 [20:20<15:29, 103.31s/it]
Task 0, Epoch 12/20 => Loss 0.629, Train_accy 83.21:  60%|██████    | 12/20 [20:20<13:33, 101.63s/it]
Task 0, Epoch 13/20 => Loss 0.637, Train_accy 82.92:  60%|██████    | 12/20 [21:59<13:33, 101.63s/it]
Task 0, Epoch 13/20 => Loss 0.637, Train_accy 82.92:  65%|██████▌   | 13/20 [21:59<11:47, 101.01s/it]
Task 0, Epoch 14/20 => Loss 0.635, Train_accy 83.47:  65%|██████▌   | 13/20 [23:37<11:47, 101.01s/it]
Task 0, Epoch 14/20 => Loss 0.635, Train_accy 83.47:  70%|███████   | 14/20 [23:37<09:59, 99.98s/it] 
Task 0, Epoch 15/20 => Loss 0.612, Train_accy 83.70, Test_accy 74.64:  70%|███████   | 14/20 [25:34<09:59, 99.98s/it]
Task 0, Epoch 15/20 => Loss 0.612, Train_accy 83.70, Test_accy 74.64:  75%|███████▌  | 15/20 [25:34<08:46, 105.28s/it]
Task 0, Epoch 16/20 => Loss 0.599, Train_accy 84.21:  75%|███████▌  | 15/20 [27:13<08:46, 105.28s/it]                 
Task 0, Epoch 16/20 => Loss 0.599, Train_accy 84.21:  80%|████████  | 16/20 [27:13<06:52, 103.14s/it]
Task 0, Epoch 17/20 => Loss 0.582, Train_accy 84.44:  80%|████████  | 16/20 [28:54<06:52, 103.14s/it]
Task 0, Epoch 17/20 => Loss 0.582, Train_accy 84.44:  85%|████████▌ | 17/20 [28:54<05:07, 102.50s/it]
Task 0, Epoch 18/20 => Loss 0.572, Train_accy 84.64:  85%|████████▌ | 17/20 [30:32<05:07, 102.50s/it]
Task 0, Epoch 18/20 => Loss 0.572, Train_accy 84.64:  90%|█████████ | 18/20 [30:32<03:22, 101.18s/it]
Task 0, Epoch 19/20 => Loss 0.562, Train_accy 85.37:  90%|█████████ | 18/20 [32:12<03:22, 101.18s/it]
Task 0, Epoch 19/20 => Loss 0.562, Train_accy 85.37:  95%|█████████▌| 19/20 [32:12<01:41, 101.02s/it]
Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54:  95%|█████████▌| 19/20 [34:08<01:41, 101.02s/it]
Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54: 100%|██████████| 20/20 [34:08<00:00, 105.52s/it]
Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54: 100%|██████████| 20/20 [34:08<00:00, 102.45s/it]
2024-09-12 13:48:35,452 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54
2024-09-12 13:48:52,263 [trainer.py] => No NME accuracy.
2024-09-12 13:48:52,264 [trainer.py] => CNN: {'total': 74.54, '00-99': 74.54, 'old': 0, 'new': 74.54}
2024-09-12 13:48:52,264 [trainer.py] => CNN top1 curve: [74.54]
2024-09-12 13:48:52,264 [trainer.py] => CNN top5 curve: [88.78]

Average Accuracy (CNN): 74.54
2024-09-12 13:48:52,264 [trainer.py] => Average Accuracy (CNN): 74.54 

2024-09-12 13:48:52,267 [trainer.py] => All params: 172158352
2024-09-12 13:48:52,269 [trainer.py] => Trainable params: 407240
2024-09-12 13:48:52,269 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.438, Train_accy 58.76:   0%|          | 0/20 [00:22<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.438, Train_accy 58.76:   5%|▌         | 1/20 [00:22<07:07, 22.50s/it]
Task 1, Epoch 2/20 => Loss 0.623, Train_accy 82.21:   5%|▌         | 1/20 [00:44<07:07, 22.50s/it]
Task 1, Epoch 2/20 => Loss 0.623, Train_accy 82.21:  10%|█         | 2/20 [00:44<06:44, 22.46s/it]
Task 1, Epoch 3/20 => Loss 0.495, Train_accy 85.40:  10%|█         | 2/20 [01:07<06:44, 22.46s/it]
Task 1, Epoch 3/20 => Loss 0.495, Train_accy 85.40:  15%|█▌        | 3/20 [01:07<06:19, 22.31s/it]
Task 1, Epoch 4/20 => Loss 0.426, Train_accy 86.94:  15%|█▌        | 3/20 [01:28<06:19, 22.31s/it]
Task 1, Epoch 4/20 => Loss 0.426, Train_accy 86.94:  20%|██        | 4/20 [01:28<05:48, 21.77s/it]
Task 1, Epoch 5/20 => Loss 0.344, Train_accy 88.97, Test_accy 67.57:  20%|██        | 4/20 [02:10<05:48, 21.77s/it]
Task 1, Epoch 5/20 => Loss 0.344, Train_accy 88.97, Test_accy 67.57:  25%|██▌       | 5/20 [02:10<07:19, 29.32s/it]
Task 1, Epoch 6/20 => Loss 0.326, Train_accy 89.72:  25%|██▌       | 5/20 [02:33<07:19, 29.32s/it]                 
Task 1, Epoch 6/20 => Loss 0.326, Train_accy 89.72:  30%|███       | 6/20 [02:33<06:17, 26.96s/it]
Task 1, Epoch 7/20 => Loss 0.317, Train_accy 89.57:  30%|███       | 6/20 [02:55<06:17, 26.96s/it]
Task 1, Epoch 7/20 => Loss 0.317, Train_accy 89.57:  35%|███▌      | 7/20 [02:55<05:31, 25.49s/it]
Task 1, Epoch 8/20 => Loss 0.267, Train_accy 91.33:  35%|███▌      | 7/20 [03:18<05:31, 25.49s/it]
Task 1, Epoch 8/20 => Loss 0.267, Train_accy 91.33:  40%|████      | 8/20 [03:18<04:54, 24.55s/it]
Task 1, Epoch 9/20 => Loss 0.290, Train_accy 90.39:  40%|████      | 8/20 [03:40<04:54, 24.55s/it]
Task 1, Epoch 9/20 => Loss 0.290, Train_accy 90.39:  45%|████▌     | 9/20 [03:40<04:22, 23.86s/it]
Task 1, Epoch 10/20 => Loss 0.245, Train_accy 92.08, Test_accy 68.94:  45%|████▌     | 9/20 [04:22<04:22, 23.86s/it]
Task 1, Epoch 10/20 => Loss 0.245, Train_accy 92.08, Test_accy 68.94:  50%|█████     | 10/20 [04:22<04:56, 29.60s/it]
Task 1, Epoch 11/20 => Loss 0.269, Train_accy 91.78:  50%|█████     | 10/20 [04:43<04:56, 29.60s/it]                 
Task 1, Epoch 11/20 => Loss 0.269, Train_accy 91.78:  55%|█████▌    | 11/20 [04:43<04:02, 26.99s/it]
Task 1, Epoch 12/20 => Loss 0.229, Train_accy 92.08:  55%|█████▌    | 11/20 [05:06<04:02, 26.99s/it]
Task 1, Epoch 12/20 => Loss 0.229, Train_accy 92.08:  60%|██████    | 12/20 [05:06<03:24, 25.52s/it]
Task 1, Epoch 13/20 => Loss 0.232, Train_accy 92.16:  60%|██████    | 12/20 [05:28<03:24, 25.52s/it]
Task 1, Epoch 13/20 => Loss 0.232, Train_accy 92.16:  65%|██████▌   | 13/20 [05:28<02:51, 24.55s/it]
Task 1, Epoch 14/20 => Loss 0.223, Train_accy 92.76:  65%|██████▌   | 13/20 [05:50<02:51, 24.55s/it]
Task 1, Epoch 14/20 => Loss 0.223, Train_accy 92.76:  70%|███████   | 14/20 [05:50<02:23, 23.85s/it]
Task 1, Epoch 15/20 => Loss 0.218, Train_accy 92.76, Test_accy 69.38:  70%|███████   | 14/20 [06:33<02:23, 23.85s/it]
Task 1, Epoch 15/20 => Loss 0.218, Train_accy 92.76, Test_accy 69.38:  75%|███████▌  | 15/20 [06:33<02:28, 29.63s/it]
Task 1, Epoch 16/20 => Loss 0.199, Train_accy 93.13:  75%|███████▌  | 15/20 [06:56<02:28, 29.63s/it]                 
Task 1, Epoch 16/20 => Loss 0.199, Train_accy 93.13:  80%|████████  | 16/20 [06:56<01:49, 27.50s/it]
Task 1, Epoch 17/20 => Loss 0.219, Train_accy 92.50:  80%|████████  | 16/20 [07:18<01:49, 27.50s/it]
Task 1, Epoch 17/20 => Loss 0.219, Train_accy 92.50:  85%|████████▌ | 17/20 [07:18<01:17, 25.97s/it]
Task 1, Epoch 18/20 => Loss 0.189, Train_accy 93.58:  85%|████████▌ | 17/20 [07:40<01:17, 25.97s/it]
Task 1, Epoch 18/20 => Loss 0.189, Train_accy 93.58:  90%|█████████ | 18/20 [07:40<00:49, 24.59s/it]
Task 1, Epoch 19/20 => Loss 0.207, Train_accy 92.27:  90%|█████████ | 18/20 [08:01<00:49, 24.59s/it]
Task 1, Epoch 19/20 => Loss 0.207, Train_accy 92.27:  95%|█████████▌| 19/20 [08:01<00:23, 23.62s/it]
Task 1, Epoch 20/20 => Loss 0.181, Train_accy 93.43, Test_accy 70.07:  95%|█████████▌| 19/20 [08:44<00:23, 23.62s/it]
Task 1, Epoch 20/20 => Loss 0.181, Train_accy 93.43, Test_accy 70.07: 100%|██████████| 20/20 [08:44<00:00, 29.51s/it]
Task 1, Epoch 20/20 => Loss 0.181, Train_accy 93.43, Test_accy 70.07: 100%|██████████| 20/20 [08:44<00:00, 26.23s/it]
2024-09-12 13:57:36,925 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.181, Train_accy 93.43, Test_accy 70.07
2024-09-12 13:57:57,472 [trainer.py] => No NME accuracy.
2024-09-12 13:57:57,472 [trainer.py] => CNN: {'total': 70.07, '00-99': 74.47, '100-119': 50.15, 'old': 74.47, 'new': 50.15}
2024-09-12 13:57:57,472 [trainer.py] => CNN top1 curve: [74.54, 70.07]
2024-09-12 13:57:57,472 [trainer.py] => CNN top5 curve: [88.78, 87.16]

Average Accuracy (CNN): 72.31
2024-09-12 13:57:57,472 [trainer.py] => Average Accuracy (CNN): 72.31 

2024-09-12 13:57:57,473 [trainer.py] => All params: 172158352
2024-09-12 13:57:57,474 [trainer.py] => Trainable params: 407240
2024-09-12 13:57:57,474 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.508, Train_accy 58.57:   0%|          | 0/20 [00:18<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.508, Train_accy 58.57:   5%|▌         | 1/20 [00:18<05:45, 18.20s/it]
Task 2, Epoch 2/20 => Loss 0.604, Train_accy 82.58:   5%|▌         | 1/20 [00:36<05:45, 18.20s/it]
Task 2, Epoch 2/20 => Loss 0.604, Train_accy 82.58:  10%|█         | 2/20 [00:36<05:26, 18.14s/it]
Task 2, Epoch 3/20 => Loss 0.438, Train_accy 87.62:  10%|█         | 2/20 [00:54<05:26, 18.14s/it]
Task 2, Epoch 3/20 => Loss 0.438, Train_accy 87.62:  15%|█▌        | 3/20 [00:54<05:08, 18.17s/it]
Task 2, Epoch 4/20 => Loss 0.404, Train_accy 87.90:  15%|█▌        | 3/20 [01:12<05:08, 18.17s/it]
Task 2, Epoch 4/20 => Loss 0.404, Train_accy 87.90:  20%|██        | 4/20 [01:12<04:49, 18.09s/it]
Task 2, Epoch 5/20 => Loss 0.325, Train_accy 90.35, Test_accy 63.43:  20%|██        | 4/20 [01:53<04:49, 18.09s/it]
Task 2, Epoch 5/20 => Loss 0.325, Train_accy 90.35, Test_accy 63.43:  25%|██▌       | 5/20 [01:53<06:33, 26.21s/it]
Task 2, Epoch 6/20 => Loss 0.289, Train_accy 91.57:  25%|██▌       | 5/20 [02:10<06:33, 26.21s/it]                 
Task 2, Epoch 6/20 => Loss 0.289, Train_accy 91.57:  30%|███       | 6/20 [02:10<05:25, 23.25s/it]
Task 2, Epoch 7/20 => Loss 0.274, Train_accy 92.09:  30%|███       | 6/20 [02:28<05:25, 23.25s/it]
Task 2, Epoch 7/20 => Loss 0.274, Train_accy 92.09:  35%|███▌      | 7/20 [02:28<04:40, 21.55s/it]
Task 2, Epoch 8/20 => Loss 0.259, Train_accy 92.04:  35%|███▌      | 7/20 [02:46<04:40, 21.55s/it]
Task 2, Epoch 8/20 => Loss 0.259, Train_accy 92.04:  40%|████      | 8/20 [02:46<04:05, 20.47s/it]
Task 2, Epoch 9/20 => Loss 0.229, Train_accy 92.89:  40%|████      | 8/20 [03:04<04:05, 20.47s/it]
Task 2, Epoch 9/20 => Loss 0.229, Train_accy 92.89:  45%|████▌     | 9/20 [03:04<03:37, 19.74s/it]
Task 2, Epoch 10/20 => Loss 0.215, Train_accy 93.08, Test_accy 63.93:  45%|████▌     | 9/20 [03:46<03:37, 19.74s/it]
Task 2, Epoch 10/20 => Loss 0.215, Train_accy 93.08, Test_accy 63.93:  50%|█████     | 10/20 [03:46<04:26, 26.61s/it]
Task 2, Epoch 11/20 => Loss 0.244, Train_accy 92.51:  50%|█████     | 10/20 [04:05<04:26, 26.61s/it]                 
Task 2, Epoch 11/20 => Loss 0.244, Train_accy 92.51:  55%|█████▌    | 11/20 [04:05<03:36, 24.02s/it]
Task 2, Epoch 12/20 => Loss 0.212, Train_accy 93.22:  55%|█████▌    | 11/20 [04:23<03:36, 24.02s/it]
Task 2, Epoch 12/20 => Loss 0.212, Train_accy 93.22:  60%|██████    | 12/20 [04:23<02:58, 22.28s/it]
Task 2, Epoch 13/20 => Loss 0.211, Train_accy 93.69:  60%|██████    | 12/20 [04:41<02:58, 22.28s/it]
Task 2, Epoch 13/20 => Loss 0.211, Train_accy 93.69:  65%|██████▌   | 13/20 [04:41<02:27, 21.08s/it]
Task 2, Epoch 14/20 => Loss 0.179, Train_accy 93.97:  65%|██████▌   | 13/20 [04:58<02:27, 21.08s/it]
Task 2, Epoch 14/20 => Loss 0.179, Train_accy 93.97:  70%|███████   | 14/20 [04:58<01:59, 19.86s/it]
Task 2, Epoch 15/20 => Loss 0.176, Train_accy 93.83, Test_accy 64.55:  70%|███████   | 14/20 [05:39<01:59, 19.86s/it]
Task 2, Epoch 15/20 => Loss 0.176, Train_accy 93.83, Test_accy 64.55:  75%|███████▌  | 15/20 [05:39<02:11, 26.30s/it]
Task 2, Epoch 16/20 => Loss 0.163, Train_accy 94.26:  75%|███████▌  | 15/20 [05:58<02:11, 26.30s/it]                 
Task 2, Epoch 16/20 => Loss 0.163, Train_accy 94.26:  80%|████████  | 16/20 [05:58<01:35, 23.89s/it]
Task 2, Epoch 17/20 => Loss 0.155, Train_accy 94.30:  80%|████████  | 16/20 [06:16<01:35, 23.89s/it]
Task 2, Epoch 17/20 => Loss 0.155, Train_accy 94.30:  85%|████████▌ | 17/20 [06:16<01:06, 22.11s/it]
Task 2, Epoch 18/20 => Loss 0.185, Train_accy 93.50:  85%|████████▌ | 17/20 [06:34<01:06, 22.11s/it]
Task 2, Epoch 18/20 => Loss 0.185, Train_accy 93.50:  90%|█████████ | 18/20 [06:34<00:41, 20.90s/it]
Task 2, Epoch 19/20 => Loss 0.147, Train_accy 94.54:  90%|█████████ | 18/20 [06:52<00:41, 20.90s/it]
Task 2, Epoch 19/20 => Loss 0.147, Train_accy 94.54:  95%|█████████▌| 19/20 [06:52<00:20, 20.04s/it]
Task 2, Epoch 20/20 => Loss 0.150, Train_accy 94.68, Test_accy 64.95:  95%|█████████▌| 19/20 [07:34<00:20, 20.04s/it]
Task 2, Epoch 20/20 => Loss 0.150, Train_accy 94.68, Test_accy 64.95: 100%|██████████| 20/20 [07:34<00:00, 26.67s/it]
Task 2, Epoch 20/20 => Loss 0.150, Train_accy 94.68, Test_accy 64.95: 100%|██████████| 20/20 [07:34<00:00, 22.72s/it]
2024-09-12 14:05:31,934 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.150, Train_accy 94.68, Test_accy 64.95
2024-09-12 14:05:55,352 [trainer.py] => No NME accuracy.
2024-09-12 14:05:55,353 [trainer.py] => CNN: {'total': 64.95, '00-99': 74.34, '100-119': 49.24, '120-139': 33.92, 'old': 69.79, 'new': 33.92}
2024-09-12 14:05:55,353 [trainer.py] => CNN top1 curve: [74.54, 70.07, 64.95]
2024-09-12 14:05:55,353 [trainer.py] => CNN top5 curve: [88.78, 87.16, 85.22]

Average Accuracy (CNN): 69.85
2024-09-12 14:05:55,353 [trainer.py] => Average Accuracy (CNN): 69.85 

2024-09-12 14:05:55,355 [trainer.py] => All params: 172158352
2024-09-12 14:05:55,358 [trainer.py] => Trainable params: 407240
2024-09-12 14:05:55,358 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.378, Train_accy 62.39:   0%|          | 0/20 [00:22<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.378, Train_accy 62.39:   5%|▌         | 1/20 [00:22<07:03, 22.30s/it]
Task 3, Epoch 2/20 => Loss 0.592, Train_accy 83.49:   5%|▌         | 1/20 [00:45<07:03, 22.30s/it]
Task 3, Epoch 2/20 => Loss 0.592, Train_accy 83.49:  10%|█         | 2/20 [00:45<06:51, 22.86s/it]
Task 3, Epoch 3/20 => Loss 0.479, Train_accy 85.72:  10%|█         | 2/20 [01:09<06:51, 22.86s/it]
Task 3, Epoch 3/20 => Loss 0.479, Train_accy 85.72:  15%|█▌        | 3/20 [01:09<06:35, 23.24s/it]
Task 3, Epoch 4/20 => Loss 0.379, Train_accy 88.25:  15%|█▌        | 3/20 [01:33<06:35, 23.24s/it]
Task 3, Epoch 4/20 => Loss 0.379, Train_accy 88.25:  20%|██        | 4/20 [01:33<06:15, 23.48s/it]
Task 3, Epoch 5/20 => Loss 0.344, Train_accy 89.35, Test_accy 59.44:  20%|██        | 4/20 [02:25<06:15, 23.48s/it]
Task 3, Epoch 5/20 => Loss 0.344, Train_accy 89.35, Test_accy 59.44:  25%|██▌       | 5/20 [02:25<08:27, 33.82s/it]
Task 3, Epoch 6/20 => Loss 0.328, Train_accy 89.70:  25%|██▌       | 5/20 [02:49<08:27, 33.82s/it]                 
Task 3, Epoch 6/20 => Loss 0.328, Train_accy 89.70:  30%|███       | 6/20 [02:49<07:06, 30.44s/it]
Task 3, Epoch 7/20 => Loss 0.291, Train_accy 91.26:  30%|███       | 6/20 [03:12<07:06, 30.44s/it]
Task 3, Epoch 7/20 => Loss 0.291, Train_accy 91.26:  35%|███▌      | 7/20 [03:12<06:06, 28.16s/it]
Task 3, Epoch 8/20 => Loss 0.309, Train_accy 90.62:  35%|███▌      | 7/20 [03:34<06:06, 28.16s/it]
Task 3, Epoch 8/20 => Loss 0.309, Train_accy 90.62:  40%|████      | 8/20 [03:34<05:15, 26.28s/it]
Task 3, Epoch 9/20 => Loss 0.253, Train_accy 91.69:  40%|████      | 8/20 [03:58<05:15, 26.28s/it]
Task 3, Epoch 9/20 => Loss 0.253, Train_accy 91.69:  45%|████▌     | 9/20 [03:58<04:38, 25.35s/it]
Task 3, Epoch 10/20 => Loss 0.269, Train_accy 91.69, Test_accy 60.51:  45%|████▌     | 9/20 [04:49<04:38, 25.35s/it]
Task 3, Epoch 10/20 => Loss 0.269, Train_accy 91.69, Test_accy 60.51:  50%|█████     | 10/20 [04:49<05:34, 33.42s/it]
Task 3, Epoch 11/20 => Loss 0.262, Train_accy 91.09:  50%|█████     | 10/20 [05:13<05:34, 33.42s/it]                 
Task 3, Epoch 11/20 => Loss 0.262, Train_accy 91.09:  55%|█████▌    | 11/20 [05:13<04:34, 30.45s/it]
Task 3, Epoch 12/20 => Loss 0.229, Train_accy 92.76:  55%|█████▌    | 11/20 [05:36<04:34, 30.45s/it]
Task 3, Epoch 12/20 => Loss 0.229, Train_accy 92.76:  60%|██████    | 12/20 [05:36<03:46, 28.36s/it]
Task 3, Epoch 13/20 => Loss 0.217, Train_accy 93.11:  60%|██████    | 12/20 [06:00<03:46, 28.36s/it]
Task 3, Epoch 13/20 => Loss 0.217, Train_accy 93.11:  65%|██████▌   | 13/20 [06:00<03:08, 26.89s/it]
Task 3, Epoch 14/20 => Loss 0.218, Train_accy 92.90:  65%|██████▌   | 13/20 [06:23<03:08, 26.89s/it]
Task 3, Epoch 14/20 => Loss 0.218, Train_accy 92.90:  70%|███████   | 14/20 [06:23<02:34, 25.82s/it]
Task 3, Epoch 15/20 => Loss 0.215, Train_accy 92.68, Test_accy 61.48:  70%|███████   | 14/20 [07:13<02:34, 25.82s/it]
Task 3, Epoch 15/20 => Loss 0.215, Train_accy 92.68, Test_accy 61.48:  75%|███████▌  | 15/20 [07:13<02:44, 32.99s/it]
Task 3, Epoch 16/20 => Loss 0.187, Train_accy 93.50:  75%|███████▌  | 15/20 [07:37<02:44, 32.99s/it]                 
Task 3, Epoch 16/20 => Loss 0.187, Train_accy 93.50:  80%|████████  | 16/20 [07:37<02:00, 30.19s/it]
Task 3, Epoch 17/20 => Loss 0.205, Train_accy 93.18:  80%|████████  | 16/20 [08:00<02:00, 30.19s/it]
Task 3, Epoch 17/20 => Loss 0.205, Train_accy 93.18:  85%|████████▌ | 17/20 [08:00<01:24, 28.24s/it]
Task 3, Epoch 18/20 => Loss 0.218, Train_accy 92.86:  85%|████████▌ | 17/20 [08:24<01:24, 28.24s/it]
Task 3, Epoch 18/20 => Loss 0.218, Train_accy 92.86:  90%|█████████ | 18/20 [08:24<00:53, 26.91s/it]
Task 3, Epoch 19/20 => Loss 0.204, Train_accy 93.25:  90%|█████████ | 18/20 [08:48<00:53, 26.91s/it]
Task 3, Epoch 19/20 => Loss 0.204, Train_accy 93.25:  95%|█████████▌| 19/20 [08:48<00:25, 25.96s/it]
Task 3, Epoch 20/20 => Loss 0.194, Train_accy 93.36, Test_accy 62.05:  95%|█████████▌| 19/20 [09:39<00:25, 25.96s/it]
Task 3, Epoch 20/20 => Loss 0.194, Train_accy 93.36, Test_accy 62.05: 100%|██████████| 20/20 [09:39<00:00, 33.54s/it]
Task 3, Epoch 20/20 => Loss 0.194, Train_accy 93.36, Test_accy 62.05: 100%|██████████| 20/20 [09:39<00:00, 28.98s/it]
2024-09-12 14:15:34,930 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.194, Train_accy 93.36, Test_accy 62.05
2024-09-12 14:16:01,255 [trainer.py] => No NME accuracy.
2024-09-12 14:16:01,256 [trainer.py] => CNN: {'total': 62.05, '00-99': 74.37, '100-119': 49.7, '120-139': 34.97, '140-159': 43.9, 'old': 65.19, 'new': 43.9}
2024-09-12 14:16:01,256 [trainer.py] => CNN top1 curve: [74.54, 70.07, 64.95, 62.05]
2024-09-12 14:16:01,256 [trainer.py] => CNN top5 curve: [88.78, 87.16, 85.22, 84.36]

Average Accuracy (CNN): 67.9
2024-09-12 14:16:01,256 [trainer.py] => Average Accuracy (CNN): 67.9 

2024-09-12 14:16:01,259 [trainer.py] => All params: 172158352
2024-09-12 14:16:01,261 [trainer.py] => Trainable params: 407240
2024-09-12 14:16:01,261 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.753, Train_accy 52.36:   0%|          | 0/20 [00:16<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.753, Train_accy 52.36:   5%|▌         | 1/20 [00:16<05:09, 16.30s/it]
Task 4, Epoch 2/20 => Loss 0.696, Train_accy 79.62:   5%|▌         | 1/20 [00:33<05:09, 16.30s/it]
Task 4, Epoch 2/20 => Loss 0.696, Train_accy 79.62:  10%|█         | 2/20 [00:33<04:58, 16.60s/it]
Task 4, Epoch 3/20 => Loss 0.566, Train_accy 82.75:  10%|█         | 2/20 [00:49<04:58, 16.60s/it]
Task 4, Epoch 3/20 => Loss 0.566, Train_accy 82.75:  15%|█▌        | 3/20 [00:49<04:42, 16.61s/it]
Task 4, Epoch 4/20 => Loss 0.453, Train_accy 86.60:  15%|█▌        | 3/20 [01:06<04:42, 16.61s/it]
Task 4, Epoch 4/20 => Loss 0.453, Train_accy 86.60:  20%|██        | 4/20 [01:06<04:24, 16.55s/it]
Task 4, Epoch 5/20 => Loss 0.409, Train_accy 87.27, Test_accy 58.59:  20%|██        | 4/20 [01:53<04:24, 16.55s/it]
Task 4, Epoch 5/20 => Loss 0.409, Train_accy 87.27, Test_accy 58.59:  25%|██▌       | 5/20 [01:53<06:53, 27.54s/it]
Task 4, Epoch 6/20 => Loss 0.366, Train_accy 88.91:  25%|██▌       | 5/20 [02:09<06:53, 27.54s/it]                 
Task 4, Epoch 6/20 => Loss 0.366, Train_accy 88.91:  30%|███       | 6/20 [02:09<05:33, 23.82s/it]
Task 4, Epoch 7/20 => Loss 0.350, Train_accy 89.58:  30%|███       | 6/20 [02:26<05:33, 23.82s/it]
Task 4, Epoch 7/20 => Loss 0.350, Train_accy 89.58:  35%|███▌      | 7/20 [02:26<04:39, 21.46s/it]
Task 4, Epoch 8/20 => Loss 0.322, Train_accy 90.97:  35%|███▌      | 7/20 [02:42<04:39, 21.46s/it]
Task 4, Epoch 8/20 => Loss 0.322, Train_accy 90.97:  40%|████      | 8/20 [02:42<03:58, 19.88s/it]
Task 4, Epoch 9/20 => Loss 0.325, Train_accy 90.30:  40%|████      | 8/20 [02:58<03:58, 19.88s/it]
Task 4, Epoch 9/20 => Loss 0.325, Train_accy 90.30:  45%|████▌     | 9/20 [02:58<03:23, 18.51s/it]
Task 4, Epoch 10/20 => Loss 0.318, Train_accy 90.55, Test_accy 59.14:  45%|████▌     | 9/20 [03:44<03:23, 18.51s/it]
Task 4, Epoch 10/20 => Loss 0.318, Train_accy 90.55, Test_accy 59.14:  50%|█████     | 10/20 [03:44<04:29, 26.99s/it]
Task 4, Epoch 11/20 => Loss 0.270, Train_accy 92.09:  50%|█████     | 10/20 [04:00<04:29, 26.99s/it]                 
Task 4, Epoch 11/20 => Loss 0.270, Train_accy 92.09:  55%|█████▌    | 11/20 [04:00<03:34, 23.78s/it]
Task 4, Epoch 12/20 => Loss 0.285, Train_accy 91.43:  55%|█████▌    | 11/20 [04:17<03:34, 23.78s/it]
Task 4, Epoch 12/20 => Loss 0.285, Train_accy 91.43:  60%|██████    | 12/20 [04:17<02:52, 21.57s/it]
Task 4, Epoch 13/20 => Loss 0.237, Train_accy 92.15:  60%|██████    | 12/20 [04:33<02:52, 21.57s/it]
Task 4, Epoch 13/20 => Loss 0.237, Train_accy 92.15:  65%|██████▌   | 13/20 [04:33<02:20, 20.05s/it]
Task 4, Epoch 14/20 => Loss 0.229, Train_accy 93.12:  65%|██████▌   | 13/20 [04:50<02:20, 20.05s/it]
Task 4, Epoch 14/20 => Loss 0.229, Train_accy 93.12:  70%|███████   | 14/20 [04:50<01:53, 18.95s/it]
Task 4, Epoch 15/20 => Loss 0.212, Train_accy 93.22, Test_accy 59.36:  70%|███████   | 14/20 [05:37<01:53, 18.95s/it]
Task 4, Epoch 15/20 => Loss 0.212, Train_accy 93.22, Test_accy 59.36:  75%|███████▌  | 15/20 [05:37<02:17, 27.53s/it]
Task 4, Epoch 16/20 => Loss 0.255, Train_accy 91.84:  75%|███████▌  | 15/20 [05:54<02:17, 27.53s/it]                 
Task 4, Epoch 16/20 => Loss 0.255, Train_accy 91.84:  80%|████████  | 16/20 [05:54<01:36, 24.16s/it]
Task 4, Epoch 17/20 => Loss 0.233, Train_accy 92.15:  80%|████████  | 16/20 [06:09<01:36, 24.16s/it]
Task 4, Epoch 17/20 => Loss 0.233, Train_accy 92.15:  85%|████████▌ | 17/20 [06:09<01:04, 21.56s/it]
Task 4, Epoch 18/20 => Loss 0.187, Train_accy 93.74:  85%|████████▌ | 17/20 [06:25<01:04, 21.56s/it]
Task 4, Epoch 18/20 => Loss 0.187, Train_accy 93.74:  90%|█████████ | 18/20 [06:25<00:39, 19.72s/it]
Task 4, Epoch 19/20 => Loss 0.209, Train_accy 93.63:  90%|█████████ | 18/20 [06:41<00:39, 19.72s/it]
Task 4, Epoch 19/20 => Loss 0.209, Train_accy 93.63:  95%|█████████▌| 19/20 [06:41<00:18, 18.76s/it]
Task 4, Epoch 20/20 => Loss 0.205, Train_accy 93.69, Test_accy 59.79:  95%|█████████▌| 19/20 [07:28<00:18, 18.76s/it]
Task 4, Epoch 20/20 => Loss 0.205, Train_accy 93.69, Test_accy 59.79: 100%|██████████| 20/20 [07:28<00:00, 27.23s/it]
Task 4, Epoch 20/20 => Loss 0.205, Train_accy 93.69, Test_accy 59.79: 100%|██████████| 20/20 [07:28<00:00, 22.43s/it]
2024-09-12 14:23:29,845 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.205, Train_accy 93.69, Test_accy 59.79
2024-09-12 14:24:00,317 [trainer.py] => No NME accuracy.
2024-09-12 14:24:00,318 [trainer.py] => CNN: {'total': 59.79, '00-99': 74.3, '100-119': 50.15, '120-139': 33.74, '140-159': 43.9, '160-179': 37.66, 'old': 61.93, 'new': 37.66}
2024-09-12 14:24:00,318 [trainer.py] => CNN top1 curve: [74.54, 70.07, 64.95, 62.05, 59.79]
2024-09-12 14:24:00,318 [trainer.py] => CNN top5 curve: [88.78, 87.16, 85.22, 84.36, 82.72]

Average Accuracy (CNN): 66.28
2024-09-12 14:24:00,318 [trainer.py] => Average Accuracy (CNN): 66.28 

2024-09-12 14:24:00,320 [trainer.py] => All params: 172158352
2024-09-12 14:24:00,322 [trainer.py] => Trainable params: 407240
2024-09-12 14:24:00,322 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.501, Train_accy 59.65:   0%|          | 0/20 [00:19<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.501, Train_accy 59.65:   5%|▌         | 1/20 [00:19<06:04, 19.18s/it]
Task 5, Epoch 2/20 => Loss 0.622, Train_accy 81.98:   5%|▌         | 1/20 [00:38<06:04, 19.18s/it]
Task 5, Epoch 2/20 => Loss 0.622, Train_accy 81.98:  10%|█         | 2/20 [00:38<05:45, 19.19s/it]
Task 5, Epoch 3/20 => Loss 0.492, Train_accy 86.12:  10%|█         | 2/20 [00:57<05:45, 19.19s/it]
Task 5, Epoch 3/20 => Loss 0.492, Train_accy 86.12:  15%|█▌        | 3/20 [00:57<05:25, 19.17s/it]
Task 5, Epoch 4/20 => Loss 0.393, Train_accy 88.46:  15%|█▌        | 3/20 [01:16<05:25, 19.17s/it]
Task 5, Epoch 4/20 => Loss 0.393, Train_accy 88.46:  20%|██        | 4/20 [01:16<05:02, 18.91s/it]
Task 5, Epoch 5/20 => Loss 0.354, Train_accy 89.43, Test_accy 56.27:  20%|██        | 4/20 [02:07<05:02, 18.91s/it]
Task 5, Epoch 5/20 => Loss 0.354, Train_accy 89.43, Test_accy 56.27:  25%|██▌       | 5/20 [02:07<07:39, 30.63s/it]
Task 5, Epoch 6/20 => Loss 0.312, Train_accy 90.26:  25%|██▌       | 5/20 [02:26<07:39, 30.63s/it]                 
Task 5, Epoch 6/20 => Loss 0.312, Train_accy 90.26:  30%|███       | 6/20 [02:26<06:13, 26.71s/it]
Task 5, Epoch 7/20 => Loss 0.295, Train_accy 91.41:  30%|███       | 6/20 [02:45<06:13, 26.71s/it]
Task 5, Epoch 7/20 => Loss 0.295, Train_accy 91.41:  35%|███▌      | 7/20 [02:45<05:15, 24.26s/it]
Task 5, Epoch 8/20 => Loss 0.265, Train_accy 91.89:  35%|███▌      | 7/20 [03:04<05:15, 24.26s/it]
Task 5, Epoch 8/20 => Loss 0.265, Train_accy 91.89:  40%|████      | 8/20 [03:04<04:31, 22.63s/it]
Task 5, Epoch 9/20 => Loss 0.254, Train_accy 91.81:  40%|████      | 8/20 [03:23<04:31, 22.63s/it]
Task 5, Epoch 9/20 => Loss 0.254, Train_accy 91.81:  45%|████▌     | 9/20 [03:23<03:56, 21.52s/it]
Task 5, Epoch 10/20 => Loss 0.253, Train_accy 92.25, Test_accy 56.73:  45%|████▌     | 9/20 [04:17<03:56, 21.52s/it]
Task 5, Epoch 10/20 => Loss 0.253, Train_accy 92.25, Test_accy 56.73:  50%|█████     | 10/20 [04:17<05:13, 31.31s/it]
Task 5, Epoch 11/20 => Loss 0.216, Train_accy 93.17:  50%|█████     | 10/20 [04:35<05:13, 31.31s/it]                 
Task 5, Epoch 11/20 => Loss 0.216, Train_accy 93.17:  55%|█████▌    | 11/20 [04:35<04:04, 27.20s/it]
Task 5, Epoch 12/20 => Loss 0.235, Train_accy 92.82:  55%|█████▌    | 11/20 [04:53<04:04, 27.20s/it]
Task 5, Epoch 12/20 => Loss 0.235, Train_accy 92.82:  60%|██████    | 12/20 [04:53<03:15, 24.46s/it]
Task 5, Epoch 13/20 => Loss 0.231, Train_accy 92.73:  60%|██████    | 12/20 [05:12<03:15, 24.46s/it]
Task 5, Epoch 13/20 => Loss 0.231, Train_accy 92.73:  65%|██████▌   | 13/20 [05:12<02:39, 22.80s/it]
Task 5, Epoch 14/20 => Loss 0.221, Train_accy 92.16:  65%|██████▌   | 13/20 [05:31<02:39, 22.80s/it]
Task 5, Epoch 14/20 => Loss 0.221, Train_accy 92.16:  70%|███████   | 14/20 [05:31<02:10, 21.68s/it]
Task 5, Epoch 15/20 => Loss 0.202, Train_accy 94.14, Test_accy 57.13:  70%|███████   | 14/20 [06:23<02:10, 21.68s/it]
Task 5, Epoch 15/20 => Loss 0.202, Train_accy 94.14, Test_accy 57.13:  75%|███████▌  | 15/20 [06:23<02:35, 31.00s/it]
Task 5, Epoch 16/20 => Loss 0.227, Train_accy 92.25:  75%|███████▌  | 15/20 [06:43<02:35, 31.00s/it]                 
Task 5, Epoch 16/20 => Loss 0.227, Train_accy 92.25:  80%|████████  | 16/20 [06:43<01:49, 27.49s/it]
Task 5, Epoch 17/20 => Loss 0.190, Train_accy 93.48:  80%|████████  | 16/20 [07:02<01:49, 27.49s/it]
Task 5, Epoch 17/20 => Loss 0.190, Train_accy 93.48:  85%|████████▌ | 17/20 [07:02<01:14, 24.98s/it]
Task 5, Epoch 18/20 => Loss 0.176, Train_accy 94.27:  85%|████████▌ | 17/20 [07:21<01:14, 24.98s/it]
Task 5, Epoch 18/20 => Loss 0.176, Train_accy 94.27:  90%|█████████ | 18/20 [07:21<00:46, 23.19s/it]
Task 5, Epoch 19/20 => Loss 0.190, Train_accy 93.57:  90%|█████████ | 18/20 [07:39<00:46, 23.19s/it]
Task 5, Epoch 19/20 => Loss 0.190, Train_accy 93.57:  95%|█████████▌| 19/20 [07:39<00:21, 21.73s/it]
Task 5, Epoch 20/20 => Loss 0.181, Train_accy 93.30, Test_accy 57.55:  95%|█████████▌| 19/20 [08:31<00:21, 21.73s/it]
Task 5, Epoch 20/20 => Loss 0.181, Train_accy 93.30, Test_accy 57.55: 100%|██████████| 20/20 [08:31<00:00, 30.65s/it]
Task 5, Epoch 20/20 => Loss 0.181, Train_accy 93.30, Test_accy 57.55: 100%|██████████| 20/20 [08:31<00:00, 25.56s/it]
2024-09-12 14:32:31,568 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.181, Train_accy 93.30, Test_accy 57.55
2024-09-12 14:33:04,876 [trainer.py] => No NME accuracy.
2024-09-12 14:33:04,877 [trainer.py] => CNN: {'total': 57.55, '00-99': 74.61, '100-119': 50.0, '120-139': 33.92, '140-159': 44.17, '160-179': 37.03, '180-199': 35.23, 'old': 59.93, 'new': 35.23}
2024-09-12 14:33:04,877 [trainer.py] => CNN top1 curve: [74.54, 70.07, 64.95, 62.05, 59.79, 57.55]
2024-09-12 14:33:04,877 [trainer.py] => CNN top5 curve: [88.78, 87.16, 85.22, 84.36, 82.72, 81.57]

Average Accuracy (CNN): 64.82
2024-09-12 14:33:04,877 [trainer.py] => Average Accuracy (CNN): 64.82 

Accuracy Matrix (CNN):
[[74.54 74.47 74.34 74.37 74.3  74.61]
 [ 0.   50.15 49.24 49.7  50.15 50.  ]
 [ 0.    0.   33.92 34.97 33.74 33.92]
 [ 0.    0.    0.   43.9  43.9  44.17]
 [ 0.    0.    0.    0.   37.66 37.03]
 [ 0.    0.    0.    0.    0.   35.23]]
2024-09-12 14:33:04,878 [trainer.py] => Forgetting (CNN): 0.3659999999999982
2024-09-12 14:33:07,818 [trainer.py] => config: ./exps/dualprompt_inr_B100_Inc10.json
2024-09-12 14:33:07,818 [trainer.py] => prefix:  
2024-09-12 14:33:07,818 [trainer.py] => dataset: imagenetr
2024-09-12 14:33:07,818 [trainer.py] => memory_size: 0
2024-09-12 14:33:07,819 [trainer.py] => memory_per_class: 0
2024-09-12 14:33:07,819 [trainer.py] => fixed_memory: False
2024-09-12 14:33:07,819 [trainer.py] => shuffle: True
2024-09-12 14:33:07,819 [trainer.py] => init_cls: 100
2024-09-12 14:33:07,819 [trainer.py] => increment: 10
2024-09-12 14:33:07,819 [trainer.py] => model_name: dualprompt
2024-09-12 14:33:07,819 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-12 14:33:07,819 [trainer.py] => get_original_backbone: True
2024-09-12 14:33:07,819 [trainer.py] => device: [device(type='cuda', index=4)]
2024-09-12 14:33:07,819 [trainer.py] => seed: 1993
2024-09-12 14:33:07,819 [trainer.py] => tuned_epoch: 20
2024-09-12 14:33:07,819 [trainer.py] => init_lr: 0.001
2024-09-12 14:33:07,819 [trainer.py] => batch_size: 48
2024-09-12 14:33:07,819 [trainer.py] => weight_decay: 0
2024-09-12 14:33:07,819 [trainer.py] => min_lr: 1e-05
2024-09-12 14:33:07,819 [trainer.py] => optimizer: adam
2024-09-12 14:33:07,819 [trainer.py] => scheduler: constant
2024-09-12 14:33:07,819 [trainer.py] => reinit_optimizer: True
2024-09-12 14:33:07,819 [trainer.py] => global_pool: token
2024-09-12 14:33:07,819 [trainer.py] => head_type: token
2024-09-12 14:33:07,819 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-12 14:33:07,819 [trainer.py] => pretrained: True
2024-09-12 14:33:07,819 [trainer.py] => drop: 0.0
2024-09-12 14:33:07,819 [trainer.py] => drop_path: 0.0
2024-09-12 14:33:07,819 [trainer.py] => use_g_prompt: True
2024-09-12 14:33:07,819 [trainer.py] => g_prompt_length: 5
2024-09-12 14:33:07,819 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-12 14:33:07,819 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-12 14:33:07,819 [trainer.py] => use_e_prompt: True
2024-09-12 14:33:07,819 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-12 14:33:07,819 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-12 14:33:07,819 [trainer.py] => prompt_pool: True
2024-09-12 14:33:07,819 [trainer.py] => size: 10
2024-09-12 14:33:07,820 [trainer.py] => length: 5
2024-09-12 14:33:07,820 [trainer.py] => top_k: 1
2024-09-12 14:33:07,820 [trainer.py] => initializer: uniform
2024-09-12 14:33:07,820 [trainer.py] => prompt_key: True
2024-09-12 14:33:07,820 [trainer.py] => prompt_key_init: uniform
2024-09-12 14:33:07,820 [trainer.py] => use_prompt_mask: True
2024-09-12 14:33:07,820 [trainer.py] => shared_prompt_pool: True
2024-09-12 14:33:07,820 [trainer.py] => shared_prompt_key: False
2024-09-12 14:33:07,820 [trainer.py] => batchwise_prompt: True
2024-09-12 14:33:07,820 [trainer.py] => embedding_key: cls
2024-09-12 14:33:07,820 [trainer.py] => predefined_key: 
2024-09-12 14:33:07,820 [trainer.py] => pull_constraint: True
2024-09-12 14:33:07,820 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-12 14:33:07,820 [trainer.py] => same_key_value: False
2024-09-12 14:33:07,903 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 14:33:11,362 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-12 14:33:11,363 [dualprompt.py] => 407,240 model training parameters.
2024-09-12 14:33:11,363 [dualprompt.py] => g_prompt: 15360
2024-09-12 14:33:11,363 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-12 14:33:11,363 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-12 14:33:11,364 [dualprompt.py] => head.weight: 153600
2024-09-12 14:33:11,364 [dualprompt.py] => head.bias: 200
2024-09-12 14:33:11,365 [trainer.py] => All params: 172158352
2024-09-12 14:33:11,365 [trainer.py] => Trainable params: 407240
2024-09-12 14:33:11,366 [dualprompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.370, Train_accy 48.15:   0%|          | 0/20 [01:39<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.370, Train_accy 48.15:   5%|▌         | 1/20 [01:39<31:25, 99.21s/it]
Task 0, Epoch 2/20 => Loss 1.356, Train_accy 67.11:   5%|▌         | 1/20 [03:17<31:25, 99.21s/it]
Task 0, Epoch 2/20 => Loss 1.356, Train_accy 67.11:  10%|█         | 2/20 [03:17<29:41, 98.95s/it]
Task 0, Epoch 3/20 => Loss 1.138, Train_accy 71.72:  10%|█         | 2/20 [04:57<29:41, 98.95s/it]
Task 0, Epoch 3/20 => Loss 1.138, Train_accy 71.72:  15%|█▌        | 3/20 [04:57<28:05, 99.15s/it]
Task 0, Epoch 4/20 => Loss 1.001, Train_accy 74.68:  15%|█▌        | 3/20 [06:36<28:05, 99.15s/it]
Task 0, Epoch 4/20 => Loss 1.001, Train_accy 74.68:  20%|██        | 4/20 [06:36<26:26, 99.16s/it]
Task 0, Epoch 5/20 => Loss 0.899, Train_accy 77.03, Test_accy 73.07:  20%|██        | 4/20 [08:32<26:26, 99.16s/it]
Task 0, Epoch 5/20 => Loss 0.899, Train_accy 77.03, Test_accy 73.07:  25%|██▌       | 5/20 [08:32<26:16, 105.10s/it]
Task 0, Epoch 6/20 => Loss 0.836, Train_accy 78.32:  25%|██▌       | 5/20 [10:13<26:16, 105.10s/it]                 
Task 0, Epoch 6/20 => Loss 0.836, Train_accy 78.32:  30%|███       | 6/20 [10:13<24:11, 103.66s/it]
Task 0, Epoch 7/20 => Loss 0.799, Train_accy 78.98:  30%|███       | 6/20 [11:51<24:11, 103.66s/it]
Task 0, Epoch 7/20 => Loss 0.799, Train_accy 78.98:  35%|███▌      | 7/20 [11:51<22:05, 101.94s/it]
Task 0, Epoch 8/20 => Loss 0.791, Train_accy 79.36:  35%|███▌      | 7/20 [13:31<22:05, 101.94s/it]
Task 0, Epoch 8/20 => Loss 0.791, Train_accy 79.36:  40%|████      | 8/20 [13:31<20:16, 101.36s/it]
Task 0, Epoch 9/20 => Loss 0.709, Train_accy 81.01:  40%|████      | 8/20 [15:09<20:16, 101.36s/it]
Task 0, Epoch 9/20 => Loss 0.709, Train_accy 81.01:  45%|████▌     | 9/20 [15:09<18:22, 100.25s/it]
Task 0, Epoch 10/20 => Loss 0.695, Train_accy 81.79, Test_accy 74.41:  45%|████▌     | 9/20 [17:06<18:22, 100.25s/it]
Task 0, Epoch 10/20 => Loss 0.695, Train_accy 81.79, Test_accy 74.41:  50%|█████     | 10/20 [17:06<17:34, 105.41s/it]
Task 0, Epoch 11/20 => Loss 0.656, Train_accy 82.55:  50%|█████     | 10/20 [18:45<17:34, 105.41s/it]                 
Task 0, Epoch 11/20 => Loss 0.656, Train_accy 82.55:  55%|█████▌    | 11/20 [18:45<15:30, 103.39s/it]
Task 0, Epoch 12/20 => Loss 0.629, Train_accy 83.21:  55%|█████▌    | 11/20 [20:25<15:30, 103.39s/it]
Task 0, Epoch 12/20 => Loss 0.629, Train_accy 83.21:  60%|██████    | 12/20 [20:25<13:38, 102.37s/it]
Task 0, Epoch 13/20 => Loss 0.637, Train_accy 82.92:  60%|██████    | 12/20 [22:03<13:38, 102.37s/it]
Task 0, Epoch 13/20 => Loss 0.637, Train_accy 82.92:  65%|██████▌   | 13/20 [22:03<11:48, 101.24s/it]
Task 0, Epoch 14/20 => Loss 0.635, Train_accy 83.47:  65%|██████▌   | 13/20 [23:44<11:48, 101.24s/it]
Task 0, Epoch 14/20 => Loss 0.635, Train_accy 83.47:  70%|███████   | 14/20 [23:44<10:06, 101.06s/it]
Task 0, Epoch 15/20 => Loss 0.612, Train_accy 83.70, Test_accy 74.64:  70%|███████   | 14/20 [25:39<10:06, 101.06s/it]
Task 0, Epoch 15/20 => Loss 0.612, Train_accy 83.70, Test_accy 74.64:  75%|███████▌  | 15/20 [25:39<08:46, 105.34s/it]
Task 0, Epoch 16/20 => Loss 0.599, Train_accy 84.21:  75%|███████▌  | 15/20 [27:19<08:46, 105.34s/it]                 
Task 0, Epoch 16/20 => Loss 0.599, Train_accy 84.21:  80%|████████  | 16/20 [27:19<06:54, 103.72s/it]
Task 0, Epoch 17/20 => Loss 0.582, Train_accy 84.44:  80%|████████  | 16/20 [28:59<06:54, 103.72s/it]
Task 0, Epoch 17/20 => Loss 0.582, Train_accy 84.44:  85%|████████▌ | 17/20 [28:59<05:07, 102.58s/it]
Task 0, Epoch 18/20 => Loss 0.572, Train_accy 84.64:  85%|████████▌ | 17/20 [30:39<05:07, 102.58s/it]
Task 0, Epoch 18/20 => Loss 0.572, Train_accy 84.64:  90%|█████████ | 18/20 [30:39<03:23, 101.76s/it]
Task 0, Epoch 19/20 => Loss 0.562, Train_accy 85.37:  90%|█████████ | 18/20 [32:19<03:23, 101.76s/it]
Task 0, Epoch 19/20 => Loss 0.562, Train_accy 85.37:  95%|█████████▌| 19/20 [32:19<01:41, 101.33s/it]
Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54:  95%|█████████▌| 19/20 [34:16<01:41, 101.33s/it]
Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54: 100%|██████████| 20/20 [34:16<00:00, 106.00s/it]
Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54: 100%|██████████| 20/20 [34:16<00:00, 102.83s/it]
2024-09-12 15:07:28,517 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.546, Train_accy 85.35, Test_accy 74.54
2024-09-12 15:07:45,553 [trainer.py] => No NME accuracy.
2024-09-12 15:07:45,554 [trainer.py] => CNN: {'total': 74.54, '00-99': 74.54, 'old': 0, 'new': 74.54}
2024-09-12 15:07:45,554 [trainer.py] => CNN top1 curve: [74.54]
2024-09-12 15:07:45,554 [trainer.py] => CNN top5 curve: [88.78]

Average Accuracy (CNN): 74.54
2024-09-12 15:07:45,554 [trainer.py] => Average Accuracy (CNN): 74.54 

2024-09-12 15:07:45,556 [trainer.py] => All params: 172158352
2024-09-12 15:07:45,557 [trainer.py] => Trainable params: 407240
2024-09-12 15:07:45,557 [dualprompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.243, Train_accy 57.69:   0%|          | 0/20 [00:10<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.243, Train_accy 57.69:   5%|▌         | 1/20 [00:10<03:13, 10.16s/it]
Task 1, Epoch 2/20 => Loss 0.515, Train_accy 83.50:   5%|▌         | 1/20 [00:20<03:13, 10.16s/it]
Task 1, Epoch 2/20 => Loss 0.515, Train_accy 83.50:  10%|█         | 2/20 [00:20<03:02, 10.15s/it]
Task 1, Epoch 3/20 => Loss 0.391, Train_accy 87.61:  10%|█         | 2/20 [00:30<03:02, 10.15s/it]
Task 1, Epoch 3/20 => Loss 0.391, Train_accy 87.61:  15%|█▌        | 3/20 [00:30<02:53, 10.18s/it]
Task 1, Epoch 4/20 => Loss 0.316, Train_accy 89.32:  15%|█▌        | 3/20 [00:40<02:53, 10.18s/it]
Task 1, Epoch 4/20 => Loss 0.316, Train_accy 89.32:  20%|██        | 4/20 [00:40<02:42, 10.16s/it]
Task 1, Epoch 5/20 => Loss 0.243, Train_accy 92.48, Test_accy 70.20:  20%|██        | 4/20 [01:09<02:42, 10.16s/it]
Task 1, Epoch 5/20 => Loss 0.243, Train_accy 92.48, Test_accy 70.20:  25%|██▌       | 5/20 [01:09<04:14, 16.98s/it]
Task 1, Epoch 6/20 => Loss 0.259, Train_accy 91.71:  25%|██▌       | 5/20 [01:19<04:14, 16.98s/it]                 
Task 1, Epoch 6/20 => Loss 0.259, Train_accy 91.71:  30%|███       | 6/20 [01:19<03:24, 14.62s/it]
Task 1, Epoch 7/20 => Loss 0.231, Train_accy 92.56:  30%|███       | 6/20 [01:29<03:24, 14.62s/it]
Task 1, Epoch 7/20 => Loss 0.231, Train_accy 92.56:  35%|███▌      | 7/20 [01:29<02:50, 13.15s/it]
Task 1, Epoch 8/20 => Loss 0.220, Train_accy 93.42:  35%|███▌      | 7/20 [01:39<02:50, 13.15s/it]
Task 1, Epoch 8/20 => Loss 0.220, Train_accy 93.42:  40%|████      | 8/20 [01:39<02:26, 12.18s/it]
Task 1, Epoch 9/20 => Loss 0.183, Train_accy 94.53:  40%|████      | 8/20 [01:49<02:26, 12.18s/it]
Task 1, Epoch 9/20 => Loss 0.183, Train_accy 94.53:  45%|████▌     | 9/20 [01:49<02:06, 11.50s/it]
Task 1, Epoch 10/20 => Loss 0.189, Train_accy 93.68, Test_accy 70.42:  45%|████▌     | 9/20 [02:18<02:06, 11.50s/it]
Task 1, Epoch 10/20 => Loss 0.189, Train_accy 93.68, Test_accy 70.42:  50%|█████     | 10/20 [02:18<02:46, 16.68s/it]
Task 1, Epoch 11/20 => Loss 0.163, Train_accy 94.10:  50%|█████     | 10/20 [02:27<02:46, 16.68s/it]                 
Task 1, Epoch 11/20 => Loss 0.163, Train_accy 94.10:  55%|█████▌    | 11/20 [02:27<02:10, 14.50s/it]
Task 1, Epoch 12/20 => Loss 0.171, Train_accy 93.68:  55%|█████▌    | 11/20 [02:37<02:10, 14.50s/it]
Task 1, Epoch 12/20 => Loss 0.171, Train_accy 93.68:  60%|██████    | 12/20 [02:37<01:43, 12.97s/it]
Task 1, Epoch 13/20 => Loss 0.157, Train_accy 94.53:  60%|██████    | 12/20 [02:46<01:43, 12.97s/it]
Task 1, Epoch 13/20 => Loss 0.157, Train_accy 94.53:  65%|██████▌   | 13/20 [02:46<01:23, 11.95s/it]
Task 1, Epoch 14/20 => Loss 0.129, Train_accy 95.30:  65%|██████▌   | 13/20 [02:56<01:23, 11.95s/it]
Task 1, Epoch 14/20 => Loss 0.129, Train_accy 95.30:  70%|███████   | 14/20 [02:56<01:08, 11.35s/it]
Task 1, Epoch 15/20 => Loss 0.120, Train_accy 95.56, Test_accy 71.00:  70%|███████   | 14/20 [03:25<01:08, 11.35s/it]
Task 1, Epoch 15/20 => Loss 0.120, Train_accy 95.56, Test_accy 71.00:  75%|███████▌  | 15/20 [03:25<01:23, 16.68s/it]
Task 1, Epoch 16/20 => Loss 0.137, Train_accy 95.30:  75%|███████▌  | 15/20 [03:36<01:23, 16.68s/it]                 
Task 1, Epoch 16/20 => Loss 0.137, Train_accy 95.30:  80%|████████  | 16/20 [03:36<00:58, 14.72s/it]
Task 1, Epoch 17/20 => Loss 0.136, Train_accy 95.21:  80%|████████  | 16/20 [03:46<00:58, 14.72s/it]
Task 1, Epoch 17/20 => Loss 0.136, Train_accy 95.21:  85%|████████▌ | 17/20 [03:46<00:39, 13.32s/it]
Task 1, Epoch 18/20 => Loss 0.129, Train_accy 95.47:  85%|████████▌ | 17/20 [03:56<00:39, 13.32s/it]
Task 1, Epoch 18/20 => Loss 0.129, Train_accy 95.47:  90%|█████████ | 18/20 [03:56<00:24, 12.37s/it]
Task 1, Epoch 19/20 => Loss 0.120, Train_accy 95.47:  90%|█████████ | 18/20 [04:06<00:24, 12.37s/it]
Task 1, Epoch 19/20 => Loss 0.120, Train_accy 95.47:  95%|█████████▌| 19/20 [04:06<00:11, 11.67s/it]
Task 1, Epoch 20/20 => Loss 0.117, Train_accy 95.56, Test_accy 71.03:  95%|█████████▌| 19/20 [04:35<00:11, 11.67s/it]
Task 1, Epoch 20/20 => Loss 0.117, Train_accy 95.56, Test_accy 71.03: 100%|██████████| 20/20 [04:35<00:00, 16.80s/it]
Task 1, Epoch 20/20 => Loss 0.117, Train_accy 95.56, Test_accy 71.03: 100%|██████████| 20/20 [04:35<00:00, 13.75s/it]
2024-09-12 15:12:20,653 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.117, Train_accy 95.56, Test_accy 71.03
2024-09-12 15:12:39,269 [trainer.py] => No NME accuracy.
2024-09-12 15:12:39,269 [trainer.py] => CNN: {'total': 71.03, '00-99': 74.54, '100-109': 34.15, 'old': 74.54, 'new': 34.15}
2024-09-12 15:12:39,270 [trainer.py] => CNN top1 curve: [74.54, 71.03]
2024-09-12 15:12:39,270 [trainer.py] => CNN top5 curve: [88.78, 87.92]

Average Accuracy (CNN): 72.78
2024-09-12 15:12:39,270 [trainer.py] => Average Accuracy (CNN): 72.78 

2024-09-12 15:12:39,273 [trainer.py] => All params: 172158352
2024-09-12 15:12:39,276 [trainer.py] => Trainable params: 407240
2024-09-12 15:12:39,276 [dualprompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.180, Train_accy 61.34:   0%|          | 0/20 [00:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.180, Train_accy 61.34:   5%|▌         | 1/20 [00:12<04:01, 12.70s/it]
Task 2, Epoch 2/20 => Loss 0.438, Train_accy 84.75:   5%|▌         | 1/20 [00:25<04:01, 12.70s/it]
Task 2, Epoch 2/20 => Loss 0.438, Train_accy 84.75:  10%|█         | 2/20 [00:25<03:49, 12.73s/it]
Task 2, Epoch 3/20 => Loss 0.309, Train_accy 90.10:  10%|█         | 2/20 [00:37<03:49, 12.73s/it]
Task 2, Epoch 3/20 => Loss 0.309, Train_accy 90.10:  15%|█▌        | 3/20 [00:37<03:33, 12.55s/it]
Task 2, Epoch 4/20 => Loss 0.306, Train_accy 89.63:  15%|█▌        | 3/20 [00:49<03:33, 12.55s/it]
Task 2, Epoch 4/20 => Loss 0.306, Train_accy 89.63:  20%|██        | 4/20 [00:49<03:17, 12.33s/it]
Task 2, Epoch 5/20 => Loss 0.280, Train_accy 90.50, Test_accy 65.60:  20%|██        | 4/20 [01:22<03:17, 12.33s/it]
Task 2, Epoch 5/20 => Loss 0.280, Train_accy 90.50, Test_accy 65.60:  25%|██▌       | 5/20 [01:22<04:53, 19.58s/it]
Task 2, Epoch 6/20 => Loss 0.246, Train_accy 91.97:  25%|██▌       | 5/20 [01:34<04:53, 19.58s/it]                 
Task 2, Epoch 6/20 => Loss 0.246, Train_accy 91.97:  30%|███       | 6/20 [01:34<04:01, 17.25s/it]
Task 2, Epoch 7/20 => Loss 0.249, Train_accy 92.24:  30%|███       | 6/20 [01:47<04:01, 17.25s/it]
Task 2, Epoch 7/20 => Loss 0.249, Train_accy 92.24:  35%|███▌      | 7/20 [01:47<03:25, 15.77s/it]
Task 2, Epoch 8/20 => Loss 0.229, Train_accy 91.84:  35%|███▌      | 7/20 [02:00<03:25, 15.77s/it]
Task 2, Epoch 8/20 => Loss 0.229, Train_accy 91.84:  40%|████      | 8/20 [02:00<02:57, 14.83s/it]
Task 2, Epoch 9/20 => Loss 0.192, Train_accy 93.58:  40%|████      | 8/20 [02:13<02:57, 14.83s/it]
Task 2, Epoch 9/20 => Loss 0.192, Train_accy 93.58:  45%|████▌     | 9/20 [02:13<02:35, 14.14s/it]
Task 2, Epoch 10/20 => Loss 0.175, Train_accy 93.78, Test_accy 66.20:  45%|████▌     | 9/20 [02:46<02:35, 14.14s/it]
Task 2, Epoch 10/20 => Loss 0.175, Train_accy 93.78, Test_accy 66.20:  50%|█████     | 10/20 [02:46<03:20, 20.05s/it]
Task 2, Epoch 11/20 => Loss 0.171, Train_accy 94.45:  50%|█████     | 10/20 [02:59<03:20, 20.05s/it]                 
Task 2, Epoch 11/20 => Loss 0.171, Train_accy 94.45:  55%|█████▌    | 11/20 [02:59<02:40, 17.80s/it]
Task 2, Epoch 12/20 => Loss 0.160, Train_accy 94.25:  55%|█████▌    | 11/20 [03:11<02:40, 17.80s/it]
Task 2, Epoch 12/20 => Loss 0.160, Train_accy 94.25:  60%|██████    | 12/20 [03:11<02:10, 16.31s/it]
Task 2, Epoch 13/20 => Loss 0.170, Train_accy 94.31:  60%|██████    | 12/20 [03:24<02:10, 16.31s/it]
Task 2, Epoch 13/20 => Loss 0.170, Train_accy 94.31:  65%|██████▌   | 13/20 [03:24<01:46, 15.19s/it]
Task 2, Epoch 14/20 => Loss 0.145, Train_accy 95.05:  65%|██████▌   | 13/20 [03:37<01:46, 15.19s/it]
Task 2, Epoch 14/20 => Loss 0.145, Train_accy 95.05:  70%|███████   | 14/20 [03:37<01:26, 14.47s/it]
Task 2, Epoch 15/20 => Loss 0.146, Train_accy 94.78, Test_accy 66.15:  70%|███████   | 14/20 [04:09<01:26, 14.47s/it]
Task 2, Epoch 15/20 => Loss 0.146, Train_accy 94.78, Test_accy 66.15:  75%|███████▌  | 15/20 [04:09<01:38, 19.73s/it]
Task 2, Epoch 16/20 => Loss 0.125, Train_accy 95.79:  75%|███████▌  | 15/20 [04:21<01:38, 19.73s/it]                 
Task 2, Epoch 16/20 => Loss 0.125, Train_accy 95.79:  80%|████████  | 16/20 [04:21<01:10, 17.53s/it]
Task 2, Epoch 17/20 => Loss 0.171, Train_accy 93.65:  80%|████████  | 16/20 [04:34<01:10, 17.53s/it]
Task 2, Epoch 17/20 => Loss 0.171, Train_accy 93.65:  85%|████████▌ | 17/20 [04:34<00:48, 16.09s/it]
Task 2, Epoch 18/20 => Loss 0.122, Train_accy 95.18:  85%|████████▌ | 17/20 [04:47<00:48, 16.09s/it]
Task 2, Epoch 18/20 => Loss 0.122, Train_accy 95.18:  90%|█████████ | 18/20 [04:47<00:30, 15.08s/it]
Task 2, Epoch 19/20 => Loss 0.156, Train_accy 94.31:  90%|█████████ | 18/20 [05:00<00:30, 15.08s/it]
Task 2, Epoch 19/20 => Loss 0.156, Train_accy 94.31:  95%|█████████▌| 19/20 [05:00<00:14, 14.40s/it]
Task 2, Epoch 20/20 => Loss 0.147, Train_accy 94.52, Test_accy 66.97:  95%|█████████▌| 19/20 [05:33<00:14, 14.40s/it]
Task 2, Epoch 20/20 => Loss 0.147, Train_accy 94.52, Test_accy 66.97: 100%|██████████| 20/20 [05:33<00:00, 20.07s/it]
Task 2, Epoch 20/20 => Loss 0.147, Train_accy 94.52, Test_accy 66.97: 100%|██████████| 20/20 [05:33<00:00, 16.67s/it]
2024-09-12 15:18:12,627 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.147, Train_accy 94.52, Test_accy 66.97
2024-09-12 15:18:33,393 [trainer.py] => No NME accuracy.
2024-09-12 15:18:33,394 [trainer.py] => CNN: {'total': 66.97, '00-99': 74.54, '100-109': 33.1, '110-119': 32.45, 'old': 70.94, 'new': 32.45}
2024-09-12 15:18:33,394 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97]
2024-09-12 15:18:33,394 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28]

Average Accuracy (CNN): 70.85
2024-09-12 15:18:33,394 [trainer.py] => Average Accuracy (CNN): 70.85 

2024-09-12 15:18:33,397 [trainer.py] => All params: 172158352
2024-09-12 15:18:33,399 [trainer.py] => Trainable params: 407240
2024-09-12 15:18:33,399 [dualprompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.431, Train_accy 55.99:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.431, Train_accy 55.99:   5%|▌         | 1/20 [00:08<02:38,  8.37s/it]
Task 3, Epoch 2/20 => Loss 0.530, Train_accy 83.16:   5%|▌         | 1/20 [00:16<02:38,  8.37s/it]
Task 3, Epoch 2/20 => Loss 0.530, Train_accy 83.16:  10%|█         | 2/20 [00:16<02:31,  8.39s/it]
Task 3, Epoch 3/20 => Loss 0.359, Train_accy 88.43:  10%|█         | 2/20 [00:25<02:31,  8.39s/it]
Task 3, Epoch 3/20 => Loss 0.359, Train_accy 88.43:  15%|█▌        | 3/20 [00:25<02:22,  8.38s/it]
Task 3, Epoch 4/20 => Loss 0.290, Train_accy 90.29:  15%|█▌        | 3/20 [00:33<02:22,  8.38s/it]
Task 3, Epoch 4/20 => Loss 0.290, Train_accy 90.29:  20%|██        | 4/20 [00:33<02:14,  8.38s/it]
Task 3, Epoch 5/20 => Loss 0.271, Train_accy 91.32, Test_accy 62.64:  20%|██        | 4/20 [01:03<02:14,  8.38s/it]
Task 3, Epoch 5/20 => Loss 0.271, Train_accy 91.32, Test_accy 62.64:  25%|██▌       | 5/20 [01:03<04:02, 16.19s/it]
Task 3, Epoch 6/20 => Loss 0.231, Train_accy 92.36:  25%|██▌       | 5/20 [01:11<04:02, 16.19s/it]                 
Task 3, Epoch 6/20 => Loss 0.231, Train_accy 92.36:  30%|███       | 6/20 [01:11<03:06, 13.35s/it]
Task 3, Epoch 7/20 => Loss 0.213, Train_accy 93.90:  30%|███       | 6/20 [01:19<03:06, 13.35s/it]
Task 3, Epoch 7/20 => Loss 0.213, Train_accy 93.90:  35%|███▌      | 7/20 [01:19<02:30, 11.58s/it]
Task 3, Epoch 8/20 => Loss 0.179, Train_accy 94.83:  35%|███▌      | 7/20 [01:27<02:30, 11.58s/it]
Task 3, Epoch 8/20 => Loss 0.179, Train_accy 94.83:  40%|████      | 8/20 [01:27<02:05, 10.42s/it]
Task 3, Epoch 9/20 => Loss 0.172, Train_accy 94.52:  40%|████      | 8/20 [01:35<02:05, 10.42s/it]
Task 3, Epoch 9/20 => Loss 0.172, Train_accy 94.52:  45%|████▌     | 9/20 [01:35<01:45,  9.63s/it]
Task 3, Epoch 10/20 => Loss 0.188, Train_accy 94.21, Test_accy 62.79:  45%|████▌     | 9/20 [02:05<01:45,  9.63s/it]
Task 3, Epoch 10/20 => Loss 0.188, Train_accy 94.21, Test_accy 62.79:  50%|█████     | 10/20 [02:05<02:40, 16.04s/it]
Task 3, Epoch 11/20 => Loss 0.177, Train_accy 94.11:  50%|█████     | 10/20 [02:14<02:40, 16.04s/it]                 
Task 3, Epoch 11/20 => Loss 0.177, Train_accy 94.11:  55%|█████▌    | 11/20 [02:14<02:03, 13.72s/it]
Task 3, Epoch 12/20 => Loss 0.144, Train_accy 95.04:  55%|█████▌    | 11/20 [02:22<02:03, 13.72s/it]
Task 3, Epoch 12/20 => Loss 0.144, Train_accy 95.04:  60%|██████    | 12/20 [02:22<01:37, 12.14s/it]
Task 3, Epoch 13/20 => Loss 0.154, Train_accy 94.63:  60%|██████    | 12/20 [02:30<01:37, 12.14s/it]
Task 3, Epoch 13/20 => Loss 0.154, Train_accy 94.63:  65%|██████▌   | 13/20 [02:30<01:16, 10.98s/it]
Task 3, Epoch 14/20 => Loss 0.128, Train_accy 96.18:  65%|██████▌   | 13/20 [02:39<01:16, 10.98s/it]
Task 3, Epoch 14/20 => Loss 0.128, Train_accy 96.18:  70%|███████   | 14/20 [02:39<01:01, 10.19s/it]
Task 3, Epoch 15/20 => Loss 0.156, Train_accy 94.63, Test_accy 62.69:  70%|███████   | 14/20 [03:09<01:01, 10.19s/it]
Task 3, Epoch 15/20 => Loss 0.156, Train_accy 94.63, Test_accy 62.69:  75%|███████▌  | 15/20 [03:09<01:21, 16.33s/it]
Task 3, Epoch 16/20 => Loss 0.125, Train_accy 95.35:  75%|███████▌  | 15/20 [03:18<01:21, 16.33s/it]                 
Task 3, Epoch 16/20 => Loss 0.125, Train_accy 95.35:  80%|████████  | 16/20 [03:18<00:55, 13.93s/it]
Task 3, Epoch 17/20 => Loss 0.131, Train_accy 96.07:  80%|████████  | 16/20 [03:26<00:55, 13.93s/it]
Task 3, Epoch 17/20 => Loss 0.131, Train_accy 96.07:  85%|████████▌ | 17/20 [03:26<00:36, 12.24s/it]
Task 3, Epoch 18/20 => Loss 0.120, Train_accy 95.97:  85%|████████▌ | 17/20 [03:34<00:36, 12.24s/it]
Task 3, Epoch 18/20 => Loss 0.120, Train_accy 95.97:  90%|█████████ | 18/20 [03:34<00:22, 11.06s/it]
Task 3, Epoch 19/20 => Loss 0.102, Train_accy 95.45:  90%|█████████ | 18/20 [03:43<00:22, 11.06s/it]
Task 3, Epoch 19/20 => Loss 0.102, Train_accy 95.45:  95%|█████████▌| 19/20 [03:43<00:10, 10.26s/it]
Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.49, Test_accy 62.82:  95%|█████████▌| 19/20 [04:13<00:10, 10.26s/it]
Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.49, Test_accy 62.82: 100%|██████████| 20/20 [04:13<00:00, 16.32s/it]
Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.49, Test_accy 62.82: 100%|██████████| 20/20 [04:13<00:00, 12.68s/it]
2024-09-12 15:22:46,993 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.119, Train_accy 96.49, Test_accy 62.82
2024-09-12 15:23:08,008 [trainer.py] => No NME accuracy.
2024-09-12 15:23:08,008 [trainer.py] => CNN: {'total': 62.82, '00-99': 74.44, '100-109': 31.69, '110-119': 31.38, '120-129': 11.07, 'old': 66.67, 'new': 11.07}
2024-09-12 15:23:08,008 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82]
2024-09-12 15:23:08,008 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58]

Average Accuracy (CNN): 68.84
2024-09-12 15:23:08,009 [trainer.py] => Average Accuracy (CNN): 68.84 

2024-09-12 15:23:08,011 [trainer.py] => All params: 172158352
2024-09-12 15:23:08,013 [trainer.py] => Trainable params: 407240
2024-09-12 15:23:08,013 [dualprompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.219, Train_accy 63.15:   0%|          | 0/20 [00:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.219, Train_accy 63.15:   5%|▌         | 1/20 [00:09<02:57,  9.33s/it]
Task 4, Epoch 2/20 => Loss 0.451, Train_accy 85.38:   5%|▌         | 1/20 [00:19<02:57,  9.33s/it]
Task 4, Epoch 2/20 => Loss 0.451, Train_accy 85.38:  10%|█         | 2/20 [00:19<02:53,  9.63s/it]
Task 4, Epoch 3/20 => Loss 0.336, Train_accy 89.10:  10%|█         | 2/20 [00:29<02:53,  9.63s/it]
Task 4, Epoch 3/20 => Loss 0.336, Train_accy 89.10:  15%|█▌        | 3/20 [00:29<02:46,  9.81s/it]
Task 4, Epoch 4/20 => Loss 0.258, Train_accy 91.18:  15%|█▌        | 3/20 [00:39<02:46,  9.81s/it]
Task 4, Epoch 4/20 => Loss 0.258, Train_accy 91.18:  20%|██        | 4/20 [00:39<02:37,  9.84s/it]
Task 4, Epoch 5/20 => Loss 0.208, Train_accy 93.34, Test_accy 59.11:  20%|██        | 4/20 [01:12<02:37,  9.84s/it]
Task 4, Epoch 5/20 => Loss 0.208, Train_accy 93.34, Test_accy 59.11:  25%|██▌       | 5/20 [01:12<04:35, 18.37s/it]
Task 4, Epoch 6/20 => Loss 0.226, Train_accy 92.13:  25%|██▌       | 5/20 [01:22<04:35, 18.37s/it]                 
Task 4, Epoch 6/20 => Loss 0.226, Train_accy 92.13:  30%|███       | 6/20 [01:22<03:36, 15.49s/it]
Task 4, Epoch 7/20 => Loss 0.189, Train_accy 93.25:  30%|███       | 6/20 [01:32<03:36, 15.49s/it]
Task 4, Epoch 7/20 => Loss 0.189, Train_accy 93.25:  35%|███▌      | 7/20 [01:32<02:57, 13.64s/it]
Task 4, Epoch 8/20 => Loss 0.161, Train_accy 94.90:  35%|███▌      | 7/20 [01:42<02:57, 13.64s/it]
Task 4, Epoch 8/20 => Loss 0.161, Train_accy 94.90:  40%|████      | 8/20 [01:42<02:29, 12.50s/it]
Task 4, Epoch 9/20 => Loss 0.176, Train_accy 94.03:  40%|████      | 8/20 [01:52<02:29, 12.50s/it]
Task 4, Epoch 9/20 => Loss 0.176, Train_accy 94.03:  45%|████▌     | 9/20 [01:52<02:08, 11.65s/it]
Task 4, Epoch 10/20 => Loss 0.137, Train_accy 95.33, Test_accy 59.35:  45%|████▌     | 9/20 [02:25<02:08, 11.65s/it]
Task 4, Epoch 10/20 => Loss 0.137, Train_accy 95.33, Test_accy 59.35:  50%|█████     | 10/20 [02:25<03:04, 18.42s/it]
Task 4, Epoch 11/20 => Loss 0.169, Train_accy 94.38:  50%|█████     | 10/20 [02:35<03:04, 18.42s/it]                 
Task 4, Epoch 11/20 => Loss 0.169, Train_accy 94.38:  55%|█████▌    | 11/20 [02:35<02:22, 15.83s/it]
Task 4, Epoch 12/20 => Loss 0.175, Train_accy 94.81:  55%|█████▌    | 11/20 [02:45<02:22, 15.83s/it]
Task 4, Epoch 12/20 => Loss 0.175, Train_accy 94.81:  60%|██████    | 12/20 [02:45<01:52, 14.03s/it]
Task 4, Epoch 13/20 => Loss 0.117, Train_accy 95.67:  60%|██████    | 12/20 [02:55<01:52, 14.03s/it]
Task 4, Epoch 13/20 => Loss 0.117, Train_accy 95.67:  65%|██████▌   | 13/20 [02:55<01:28, 12.68s/it]
Task 4, Epoch 14/20 => Loss 0.145, Train_accy 95.33:  65%|██████▌   | 13/20 [03:04<01:28, 12.68s/it]
Task 4, Epoch 14/20 => Loss 0.145, Train_accy 95.33:  70%|███████   | 14/20 [03:04<01:10, 11.68s/it]
Task 4, Epoch 15/20 => Loss 0.111, Train_accy 96.63, Test_accy 59.90:  70%|███████   | 14/20 [03:36<01:10, 11.68s/it]
Task 4, Epoch 15/20 => Loss 0.111, Train_accy 96.63, Test_accy 59.90:  75%|███████▌  | 15/20 [03:36<01:29, 17.89s/it]
Task 4, Epoch 16/20 => Loss 0.122, Train_accy 95.59:  75%|███████▌  | 15/20 [03:46<01:29, 17.89s/it]                 
Task 4, Epoch 16/20 => Loss 0.122, Train_accy 95.59:  80%|████████  | 16/20 [03:46<01:02, 15.51s/it]
Task 4, Epoch 17/20 => Loss 0.112, Train_accy 96.37:  80%|████████  | 16/20 [03:56<01:02, 15.51s/it]
Task 4, Epoch 17/20 => Loss 0.112, Train_accy 96.37:  85%|████████▌ | 17/20 [03:56<00:41, 13.85s/it]
Task 4, Epoch 18/20 => Loss 0.146, Train_accy 94.90:  85%|████████▌ | 17/20 [04:06<00:41, 13.85s/it]
Task 4, Epoch 18/20 => Loss 0.146, Train_accy 94.90:  90%|█████████ | 18/20 [04:06<00:25, 12.73s/it]
Task 4, Epoch 19/20 => Loss 0.145, Train_accy 95.42:  90%|█████████ | 18/20 [04:16<00:25, 12.73s/it]
Task 4, Epoch 19/20 => Loss 0.145, Train_accy 95.42:  95%|█████████▌| 19/20 [04:16<00:11, 11.91s/it]
Task 4, Epoch 20/20 => Loss 0.118, Train_accy 95.42, Test_accy 59.90:  95%|█████████▌| 19/20 [04:50<00:11, 11.91s/it]
Task 4, Epoch 20/20 => Loss 0.118, Train_accy 95.42, Test_accy 59.90: 100%|██████████| 20/20 [04:50<00:00, 18.46s/it]
Task 4, Epoch 20/20 => Loss 0.118, Train_accy 95.42, Test_accy 59.90: 100%|██████████| 20/20 [04:50<00:00, 14.53s/it]
2024-09-12 15:27:58,655 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.118, Train_accy 95.42, Test_accy 59.90
2024-09-12 15:28:22,388 [trainer.py] => No NME accuracy.
2024-09-12 15:28:22,389 [trainer.py] => CNN: {'total': 59.9, '00-99': 74.41, '100-109': 31.69, '110-119': 31.12, '120-129': 11.81, '130-139': 21.48, 'old': 62.82, 'new': 21.48}
2024-09-12 15:28:22,389 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82, 59.9]
2024-09-12 15:28:22,389 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58, 83.48]

Average Accuracy (CNN): 67.05
2024-09-12 15:28:22,389 [trainer.py] => Average Accuracy (CNN): 67.05 

2024-09-12 15:28:22,390 [trainer.py] => All params: 172158352
2024-09-12 15:28:22,391 [trainer.py] => Trainable params: 407240
2024-09-12 15:28:22,392 [dualprompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.032, Train_accy 67.70:   0%|          | 0/20 [00:12<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.032, Train_accy 67.70:   5%|▌         | 1/20 [00:12<03:49, 12.07s/it]
Task 5, Epoch 2/20 => Loss 0.402, Train_accy 86.86:   5%|▌         | 1/20 [00:24<03:49, 12.07s/it]
Task 5, Epoch 2/20 => Loss 0.402, Train_accy 86.86:  10%|█         | 2/20 [00:24<03:36, 12.01s/it]
Task 5, Epoch 3/20 => Loss 0.331, Train_accy 89.26:  10%|█         | 2/20 [00:36<03:36, 12.01s/it]
Task 5, Epoch 3/20 => Loss 0.331, Train_accy 89.26:  15%|█▌        | 3/20 [00:36<03:24, 12.03s/it]
Task 5, Epoch 4/20 => Loss 0.240, Train_accy 92.93:  15%|█▌        | 3/20 [00:48<03:24, 12.03s/it]
Task 5, Epoch 4/20 => Loss 0.240, Train_accy 92.93:  20%|██        | 4/20 [00:48<03:12, 12.01s/it]
Task 5, Epoch 5/20 => Loss 0.229, Train_accy 92.58, Test_accy 56.65:  20%|██        | 4/20 [01:23<03:12, 12.01s/it]
Task 5, Epoch 5/20 => Loss 0.229, Train_accy 92.58, Test_accy 56.65:  25%|██▌       | 5/20 [01:23<05:07, 20.51s/it]
Task 5, Epoch 6/20 => Loss 0.219, Train_accy 93.36:  25%|██▌       | 5/20 [01:35<05:07, 20.51s/it]                 
Task 5, Epoch 6/20 => Loss 0.219, Train_accy 93.36:  30%|███       | 6/20 [01:35<04:06, 17.62s/it]
Task 5, Epoch 7/20 => Loss 0.203, Train_accy 92.51:  30%|███       | 6/20 [01:47<04:06, 17.62s/it]
Task 5, Epoch 7/20 => Loss 0.203, Train_accy 92.51:  35%|███▌      | 7/20 [01:47<03:25, 15.83s/it]
Task 5, Epoch 8/20 => Loss 0.173, Train_accy 94.63:  35%|███▌      | 7/20 [01:59<03:25, 15.83s/it]
Task 5, Epoch 8/20 => Loss 0.173, Train_accy 94.63:  40%|████      | 8/20 [01:59<02:55, 14.66s/it]
Task 5, Epoch 9/20 => Loss 0.159, Train_accy 94.49:  40%|████      | 8/20 [02:12<02:55, 14.66s/it]
Task 5, Epoch 9/20 => Loss 0.159, Train_accy 94.49:  45%|████▌     | 9/20 [02:12<02:32, 13.86s/it]
Task 5, Epoch 10/20 => Loss 0.132, Train_accy 95.69, Test_accy 56.95:  45%|████▌     | 9/20 [02:50<02:32, 13.86s/it]
Task 5, Epoch 10/20 => Loss 0.132, Train_accy 95.69, Test_accy 56.95:  50%|█████     | 10/20 [02:50<03:33, 21.31s/it]
Task 5, Epoch 11/20 => Loss 0.163, Train_accy 94.49:  50%|█████     | 10/20 [03:02<03:33, 21.31s/it]                 
Task 5, Epoch 11/20 => Loss 0.163, Train_accy 94.49:  55%|█████▌    | 11/20 [03:02<02:46, 18.51s/it]
Task 5, Epoch 12/20 => Loss 0.149, Train_accy 95.34:  55%|█████▌    | 11/20 [03:14<02:46, 18.51s/it]
Task 5, Epoch 12/20 => Loss 0.149, Train_accy 95.34:  60%|██████    | 12/20 [03:14<02:12, 16.56s/it]
Task 5, Epoch 13/20 => Loss 0.148, Train_accy 94.77:  60%|██████    | 12/20 [03:26<02:12, 16.56s/it]
Task 5, Epoch 13/20 => Loss 0.148, Train_accy 94.77:  65%|██████▌   | 13/20 [03:26<01:46, 15.21s/it]
Task 5, Epoch 14/20 => Loss 0.141, Train_accy 94.70:  65%|██████▌   | 13/20 [03:38<01:46, 15.21s/it]
Task 5, Epoch 14/20 => Loss 0.141, Train_accy 94.70:  70%|███████   | 14/20 [03:38<01:25, 14.29s/it]
Task 5, Epoch 15/20 => Loss 0.131, Train_accy 95.34, Test_accy 57.13:  70%|███████   | 14/20 [04:15<01:25, 14.29s/it]
Task 5, Epoch 15/20 => Loss 0.131, Train_accy 95.34, Test_accy 57.13:  75%|███████▌  | 15/20 [04:15<01:45, 21.11s/it]
Task 5, Epoch 16/20 => Loss 0.126, Train_accy 95.83:  75%|███████▌  | 15/20 [04:26<01:45, 21.11s/it]                 
Task 5, Epoch 16/20 => Loss 0.126, Train_accy 95.83:  80%|████████  | 16/20 [04:26<01:12, 18.20s/it]
Task 5, Epoch 17/20 => Loss 0.122, Train_accy 95.34:  80%|████████  | 16/20 [04:38<01:12, 18.20s/it]
Task 5, Epoch 17/20 => Loss 0.122, Train_accy 95.34:  85%|████████▌ | 17/20 [04:38<00:48, 16.31s/it]
Task 5, Epoch 18/20 => Loss 0.122, Train_accy 95.19:  85%|████████▌ | 17/20 [04:51<00:48, 16.31s/it]
Task 5, Epoch 18/20 => Loss 0.122, Train_accy 95.19:  90%|█████████ | 18/20 [04:51<00:30, 15.07s/it]
Task 5, Epoch 19/20 => Loss 0.111, Train_accy 96.18:  90%|█████████ | 18/20 [05:03<00:30, 15.07s/it]
Task 5, Epoch 19/20 => Loss 0.111, Train_accy 96.18:  95%|█████████▌| 19/20 [05:03<00:14, 14.19s/it]
Task 5, Epoch 20/20 => Loss 0.108, Train_accy 95.76, Test_accy 57.52:  95%|█████████▌| 19/20 [05:41<00:14, 14.19s/it]
Task 5, Epoch 20/20 => Loss 0.108, Train_accy 95.76, Test_accy 57.52: 100%|██████████| 20/20 [05:41<00:00, 21.33s/it]
Task 5, Epoch 20/20 => Loss 0.108, Train_accy 95.76, Test_accy 57.52: 100%|██████████| 20/20 [05:41<00:00, 17.06s/it]
2024-09-12 15:34:03,578 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.108, Train_accy 95.76, Test_accy 57.52
2024-09-12 15:34:29,738 [trainer.py] => No NME accuracy.
2024-09-12 15:34:29,738 [trainer.py] => CNN: {'total': 57.52, '00-99': 74.57, '100-109': 30.99, '110-119': 30.85, '120-129': 11.44, '130-139': 22.48, '140-149': 29.16, 'old': 59.99, 'new': 29.16}
2024-09-12 15:34:29,739 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82, 59.9, 57.52]
2024-09-12 15:34:29,739 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58, 83.48, 82.8]

Average Accuracy (CNN): 65.46
2024-09-12 15:34:29,739 [trainer.py] => Average Accuracy (CNN): 65.46 

2024-09-12 15:34:29,741 [trainer.py] => All params: 172158352
2024-09-12 15:34:29,743 [trainer.py] => Trainable params: 407240
2024-09-12 15:34:29,743 [dualprompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.303, Train_accy 59.60:   0%|          | 0/20 [00:11<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.303, Train_accy 59.60:   5%|▌         | 1/20 [00:11<03:47, 11.97s/it]
Task 6, Epoch 2/20 => Loss 0.487, Train_accy 84.58:   5%|▌         | 1/20 [00:24<03:47, 11.97s/it]
Task 6, Epoch 2/20 => Loss 0.487, Train_accy 84.58:  10%|█         | 2/20 [00:24<03:38, 12.14s/it]
Task 6, Epoch 3/20 => Loss 0.363, Train_accy 88.51:  10%|█         | 2/20 [00:36<03:38, 12.14s/it]
Task 6, Epoch 3/20 => Loss 0.363, Train_accy 88.51:  15%|█▌        | 3/20 [00:36<03:25, 12.10s/it]
Task 6, Epoch 4/20 => Loss 0.340, Train_accy 88.87:  15%|█▌        | 3/20 [00:48<03:25, 12.10s/it]
Task 6, Epoch 4/20 => Loss 0.340, Train_accy 88.87:  20%|██        | 4/20 [00:48<03:13, 12.09s/it]
Task 6, Epoch 5/20 => Loss 0.285, Train_accy 90.44, Test_accy 54.44:  20%|██        | 4/20 [01:27<03:13, 12.09s/it]
Task 6, Epoch 5/20 => Loss 0.285, Train_accy 90.44, Test_accy 54.44:  25%|██▌       | 5/20 [01:27<05:25, 21.67s/it]
Task 6, Epoch 6/20 => Loss 0.224, Train_accy 92.86:  25%|██▌       | 5/20 [01:38<05:25, 21.67s/it]                 
Task 6, Epoch 6/20 => Loss 0.224, Train_accy 92.86:  30%|███       | 6/20 [01:38<04:15, 18.26s/it]
Task 6, Epoch 7/20 => Loss 0.204, Train_accy 93.36:  30%|███       | 6/20 [01:50<04:15, 18.26s/it]
Task 6, Epoch 7/20 => Loss 0.204, Train_accy 93.36:  35%|███▌      | 7/20 [01:50<03:31, 16.27s/it]
Task 6, Epoch 8/20 => Loss 0.219, Train_accy 92.86:  35%|███▌      | 7/20 [02:03<03:31, 16.27s/it]
Task 6, Epoch 8/20 => Loss 0.219, Train_accy 92.86:  40%|████      | 8/20 [02:03<02:59, 14.98s/it]
Task 6, Epoch 9/20 => Loss 0.223, Train_accy 92.86:  40%|████      | 8/20 [02:15<02:59, 14.98s/it]
Task 6, Epoch 9/20 => Loss 0.223, Train_accy 92.86:  45%|████▌     | 9/20 [02:15<02:34, 14.06s/it]
Task 6, Epoch 10/20 => Loss 0.215, Train_accy 92.43, Test_accy 54.99:  45%|████▌     | 9/20 [02:54<02:34, 14.06s/it]
Task 6, Epoch 10/20 => Loss 0.215, Train_accy 92.43, Test_accy 54.99:  50%|█████     | 10/20 [02:54<03:40, 22.01s/it]
Task 6, Epoch 11/20 => Loss 0.156, Train_accy 94.86:  50%|█████     | 10/20 [03:06<03:40, 22.01s/it]                 
Task 6, Epoch 11/20 => Loss 0.156, Train_accy 94.86:  55%|█████▌    | 11/20 [03:06<02:50, 18.92s/it]
Task 6, Epoch 12/20 => Loss 0.191, Train_accy 94.00:  55%|█████▌    | 11/20 [03:18<02:50, 18.92s/it]
Task 6, Epoch 12/20 => Loss 0.191, Train_accy 94.00:  60%|██████    | 12/20 [03:18<02:14, 16.84s/it]
Task 6, Epoch 13/20 => Loss 0.181, Train_accy 94.00:  60%|██████    | 12/20 [03:30<02:14, 16.84s/it]
Task 6, Epoch 13/20 => Loss 0.181, Train_accy 94.00:  65%|██████▌   | 13/20 [03:30<01:47, 15.38s/it]
Task 6, Epoch 14/20 => Loss 0.178, Train_accy 94.00:  65%|██████▌   | 13/20 [03:43<01:47, 15.38s/it]
Task 6, Epoch 14/20 => Loss 0.178, Train_accy 94.00:  70%|███████   | 14/20 [03:43<01:26, 14.40s/it]
Task 6, Epoch 15/20 => Loss 0.151, Train_accy 94.50, Test_accy 55.21:  70%|███████   | 14/20 [04:21<01:26, 14.40s/it]
Task 6, Epoch 15/20 => Loss 0.151, Train_accy 94.50, Test_accy 55.21:  75%|███████▌  | 15/20 [04:21<01:48, 21.78s/it]
Task 6, Epoch 16/20 => Loss 0.158, Train_accy 94.22:  75%|███████▌  | 15/20 [04:33<01:48, 21.78s/it]                 
Task 6, Epoch 16/20 => Loss 0.158, Train_accy 94.22:  80%|████████  | 16/20 [04:33<01:14, 18.61s/it]
Task 6, Epoch 17/20 => Loss 0.121, Train_accy 95.65:  80%|████████  | 16/20 [04:44<01:14, 18.61s/it]
Task 6, Epoch 17/20 => Loss 0.121, Train_accy 95.65:  85%|████████▌ | 17/20 [04:44<00:49, 16.39s/it]
Task 6, Epoch 18/20 => Loss 0.155, Train_accy 95.36:  85%|████████▌ | 17/20 [04:56<00:49, 16.39s/it]
Task 6, Epoch 18/20 => Loss 0.155, Train_accy 95.36:  90%|█████████ | 18/20 [04:56<00:30, 15.04s/it]
Task 6, Epoch 19/20 => Loss 0.156, Train_accy 95.00:  90%|█████████ | 18/20 [05:08<00:30, 15.04s/it]
Task 6, Epoch 19/20 => Loss 0.156, Train_accy 95.00:  95%|█████████▌| 19/20 [05:08<00:14, 14.14s/it]
Task 6, Epoch 20/20 => Loss 0.146, Train_accy 95.29, Test_accy 55.63:  95%|█████████▌| 19/20 [05:47<00:14, 14.14s/it]
Task 6, Epoch 20/20 => Loss 0.146, Train_accy 95.29, Test_accy 55.63: 100%|██████████| 20/20 [05:47<00:00, 21.73s/it]
Task 6, Epoch 20/20 => Loss 0.146, Train_accy 95.29, Test_accy 55.63: 100%|██████████| 20/20 [05:47<00:00, 17.39s/it]
2024-09-12 15:40:17,486 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.146, Train_accy 95.29, Test_accy 55.63
2024-09-12 15:40:44,991 [trainer.py] => No NME accuracy.
2024-09-12 15:40:44,992 [trainer.py] => CNN: {'total': 55.63, '00-99': 74.51, '100-109': 31.34, '110-119': 31.12, '120-129': 11.81, '130-139': 22.48, '140-149': 30.52, '150-159': 30.11, 'old': 57.65, 'new': 30.11}
2024-09-12 15:40:44,992 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82, 59.9, 57.52, 55.63]
2024-09-12 15:40:44,992 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58, 83.48, 82.8, 82.06]

Average Accuracy (CNN): 64.06
2024-09-12 15:40:44,992 [trainer.py] => Average Accuracy (CNN): 64.06 

2024-09-12 15:40:44,994 [trainer.py] => All params: 172158352
2024-09-12 15:40:44,997 [trainer.py] => Trainable params: 407240
2024-09-12 15:40:44,997 [dualprompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.741, Train_accy 45.47:   0%|          | 0/20 [00:08<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.741, Train_accy 45.47:   5%|▌         | 1/20 [00:08<02:44,  8.65s/it]
Task 7, Epoch 2/20 => Loss 0.723, Train_accy 76.96:   5%|▌         | 1/20 [00:17<02:44,  8.65s/it]
Task 7, Epoch 2/20 => Loss 0.723, Train_accy 76.96:  10%|█         | 2/20 [00:17<02:34,  8.61s/it]
Task 7, Epoch 3/20 => Loss 0.523, Train_accy 82.29:  10%|█         | 2/20 [00:25<02:34,  8.61s/it]
Task 7, Epoch 3/20 => Loss 0.523, Train_accy 82.29:  15%|█▌        | 3/20 [00:25<02:25,  8.57s/it]
Task 7, Epoch 4/20 => Loss 0.421, Train_accy 86.42:  15%|█▌        | 3/20 [00:34<02:25,  8.57s/it]
Task 7, Epoch 4/20 => Loss 0.421, Train_accy 86.42:  20%|██        | 4/20 [00:34<02:16,  8.56s/it]
Task 7, Epoch 5/20 => Loss 0.365, Train_accy 88.13, Test_accy 53.47:  20%|██        | 4/20 [01:11<02:16,  8.56s/it]
Task 7, Epoch 5/20 => Loss 0.365, Train_accy 88.13, Test_accy 53.47:  25%|██▌       | 5/20 [01:11<04:43, 18.92s/it]
Task 7, Epoch 6/20 => Loss 0.377, Train_accy 88.93:  25%|██▌       | 5/20 [01:19<04:43, 18.92s/it]                 
Task 7, Epoch 6/20 => Loss 0.377, Train_accy 88.93:  30%|███       | 6/20 [01:19<03:33, 15.23s/it]
Task 7, Epoch 7/20 => Loss 0.338, Train_accy 90.24:  30%|███       | 6/20 [01:27<03:33, 15.23s/it]
Task 7, Epoch 7/20 => Loss 0.338, Train_accy 90.24:  35%|███▌      | 7/20 [01:27<02:47, 12.89s/it]
Task 7, Epoch 8/20 => Loss 0.306, Train_accy 90.04:  35%|███▌      | 7/20 [01:35<02:47, 12.89s/it]
Task 7, Epoch 8/20 => Loss 0.306, Train_accy 90.04:  40%|████      | 8/20 [01:35<02:16, 11.34s/it]
Task 7, Epoch 9/20 => Loss 0.285, Train_accy 91.45:  40%|████      | 8/20 [01:43<02:16, 11.34s/it]
Task 7, Epoch 9/20 => Loss 0.285, Train_accy 91.45:  45%|████▌     | 9/20 [01:43<01:53, 10.28s/it]
Task 7, Epoch 10/20 => Loss 0.278, Train_accy 91.25, Test_accy 53.64:  45%|████▌     | 9/20 [02:20<01:53, 10.28s/it]
Task 7, Epoch 10/20 => Loss 0.278, Train_accy 91.25, Test_accy 53.64:  50%|█████     | 10/20 [02:20<03:05, 18.54s/it]
Task 7, Epoch 11/20 => Loss 0.258, Train_accy 91.35:  50%|█████     | 10/20 [02:29<03:05, 18.54s/it]                 
Task 7, Epoch 11/20 => Loss 0.258, Train_accy 91.35:  55%|█████▌    | 11/20 [02:29<02:19, 15.46s/it]
Task 7, Epoch 12/20 => Loss 0.296, Train_accy 90.54:  55%|█████▌    | 11/20 [02:37<02:19, 15.46s/it]
Task 7, Epoch 12/20 => Loss 0.296, Train_accy 90.54:  60%|██████    | 12/20 [02:37<01:47, 13.38s/it]
Task 7, Epoch 13/20 => Loss 0.212, Train_accy 93.26:  60%|██████    | 12/20 [02:46<01:47, 13.38s/it]
Task 7, Epoch 13/20 => Loss 0.212, Train_accy 93.26:  65%|██████▌   | 13/20 [02:46<01:23, 11.91s/it]
Task 7, Epoch 14/20 => Loss 0.195, Train_accy 93.76:  65%|██████▌   | 13/20 [02:54<01:23, 11.91s/it]
Task 7, Epoch 14/20 => Loss 0.195, Train_accy 93.76:  70%|███████   | 14/20 [02:54<01:05, 10.88s/it]
Task 7, Epoch 15/20 => Loss 0.202, Train_accy 93.06, Test_accy 53.82:  70%|███████   | 14/20 [03:32<01:05, 10.88s/it]
Task 7, Epoch 15/20 => Loss 0.202, Train_accy 93.06, Test_accy 53.82:  75%|███████▌  | 15/20 [03:32<01:34, 18.92s/it]
Task 7, Epoch 16/20 => Loss 0.216, Train_accy 93.36:  75%|███████▌  | 15/20 [03:41<01:34, 18.92s/it]                 
Task 7, Epoch 16/20 => Loss 0.216, Train_accy 93.36:  80%|████████  | 16/20 [03:41<01:03, 15.84s/it]
Task 7, Epoch 17/20 => Loss 0.231, Train_accy 92.76:  80%|████████  | 16/20 [03:49<01:03, 15.84s/it]
Task 7, Epoch 17/20 => Loss 0.231, Train_accy 92.76:  85%|████████▌ | 17/20 [03:49<00:40, 13.65s/it]
Task 7, Epoch 18/20 => Loss 0.195, Train_accy 93.96:  85%|████████▌ | 17/20 [03:58<00:40, 13.65s/it]
Task 7, Epoch 18/20 => Loss 0.195, Train_accy 93.96:  90%|█████████ | 18/20 [03:58<00:24, 12.12s/it]
Task 7, Epoch 19/20 => Loss 0.191, Train_accy 92.86:  90%|█████████ | 18/20 [04:06<00:24, 12.12s/it]
Task 7, Epoch 19/20 => Loss 0.191, Train_accy 92.86:  95%|█████████▌| 19/20 [04:06<00:11, 11.06s/it]
Task 7, Epoch 20/20 => Loss 0.190, Train_accy 92.86, Test_accy 53.78:  95%|█████████▌| 19/20 [04:42<00:11, 11.06s/it]
Task 7, Epoch 20/20 => Loss 0.190, Train_accy 92.86, Test_accy 53.78: 100%|██████████| 20/20 [04:42<00:00, 18.53s/it]
Task 7, Epoch 20/20 => Loss 0.190, Train_accy 92.86, Test_accy 53.78: 100%|██████████| 20/20 [04:42<00:00, 14.14s/it]
2024-09-12 15:45:27,772 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.190, Train_accy 92.86, Test_accy 53.78
2024-09-12 15:45:55,937 [trainer.py] => No NME accuracy.
2024-09-12 15:45:55,938 [trainer.py] => CNN: {'total': 53.78, '00-99': 74.34, '100-109': 32.04, '110-119': 30.85, '120-129': 11.81, '130-139': 22.15, '140-149': 30.52, '150-159': 29.83, '160-169': 16.52, 'old': 55.51, 'new': 16.52}
2024-09-12 15:45:55,938 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82, 59.9, 57.52, 55.63, 53.78]
2024-09-12 15:45:55,938 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58, 83.48, 82.8, 82.06, 80.78]

Average Accuracy (CNN): 62.77
2024-09-12 15:45:55,939 [trainer.py] => Average Accuracy (CNN): 62.77 

2024-09-12 15:45:55,941 [trainer.py] => All params: 172158352
2024-09-12 15:45:55,943 [trainer.py] => Trainable params: 407240
2024-09-12 15:45:55,943 [dualprompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.413, Train_accy 56.18:   0%|          | 0/20 [00:08<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.413, Train_accy 56.18:   5%|▌         | 1/20 [00:08<02:40,  8.47s/it]
Task 8, Epoch 2/20 => Loss 0.451, Train_accy 85.95:   5%|▌         | 1/20 [00:16<02:40,  8.47s/it]
Task 8, Epoch 2/20 => Loss 0.451, Train_accy 85.95:  10%|█         | 2/20 [00:16<02:32,  8.46s/it]
Task 8, Epoch 3/20 => Loss 0.302, Train_accy 90.46:  10%|█         | 2/20 [00:25<02:32,  8.46s/it]
Task 8, Epoch 3/20 => Loss 0.302, Train_accy 90.46:  15%|█▌        | 3/20 [00:25<02:22,  8.40s/it]
Task 8, Epoch 4/20 => Loss 0.300, Train_accy 90.57:  15%|█▌        | 3/20 [00:33<02:22,  8.40s/it]
Task 8, Epoch 4/20 => Loss 0.300, Train_accy 90.57:  20%|██        | 4/20 [00:33<02:14,  8.42s/it]
Task 8, Epoch 5/20 => Loss 0.240, Train_accy 93.08, Test_accy 52.20:  20%|██        | 4/20 [01:12<02:14,  8.42s/it]
Task 8, Epoch 5/20 => Loss 0.240, Train_accy 93.08, Test_accy 52.20:  25%|██▌       | 5/20 [01:12<04:48, 19.24s/it]
Task 8, Epoch 6/20 => Loss 0.180, Train_accy 94.65:  25%|██▌       | 5/20 [01:20<04:48, 19.24s/it]                 
Task 8, Epoch 6/20 => Loss 0.180, Train_accy 94.65:  30%|███       | 6/20 [01:20<03:38, 15.63s/it]
Task 8, Epoch 7/20 => Loss 0.208, Train_accy 92.77:  30%|███       | 6/20 [01:29<03:38, 15.63s/it]
Task 8, Epoch 7/20 => Loss 0.208, Train_accy 92.77:  35%|███▌      | 7/20 [01:29<02:52, 13.24s/it]
Task 8, Epoch 8/20 => Loss 0.195, Train_accy 93.29:  35%|███▌      | 7/20 [01:37<02:52, 13.24s/it]
Task 8, Epoch 8/20 => Loss 0.195, Train_accy 93.29:  40%|████      | 8/20 [01:37<02:20, 11.70s/it]
Task 8, Epoch 9/20 => Loss 0.153, Train_accy 95.49:  40%|████      | 8/20 [01:45<02:20, 11.70s/it]
Task 8, Epoch 9/20 => Loss 0.153, Train_accy 95.49:  45%|████▌     | 9/20 [01:45<01:56, 10.60s/it]
Task 8, Epoch 10/20 => Loss 0.164, Train_accy 94.55, Test_accy 52.32:  45%|████▌     | 9/20 [02:24<01:56, 10.60s/it]
Task 8, Epoch 10/20 => Loss 0.164, Train_accy 94.55, Test_accy 52.32:  50%|█████     | 10/20 [02:24<03:11, 19.20s/it]
Task 8, Epoch 11/20 => Loss 0.201, Train_accy 93.29:  50%|█████     | 10/20 [02:31<03:11, 19.20s/it]                 
Task 8, Epoch 11/20 => Loss 0.201, Train_accy 93.29:  55%|█████▌    | 11/20 [02:31<02:21, 15.71s/it]
Task 8, Epoch 12/20 => Loss 0.143, Train_accy 95.60:  55%|█████▌    | 11/20 [02:39<02:21, 15.71s/it]
Task 8, Epoch 12/20 => Loss 0.143, Train_accy 95.60:  60%|██████    | 12/20 [02:39<01:46, 13.34s/it]
Task 8, Epoch 13/20 => Loss 0.144, Train_accy 94.97:  60%|██████    | 12/20 [02:47<01:46, 13.34s/it]
Task 8, Epoch 13/20 => Loss 0.144, Train_accy 94.97:  65%|██████▌   | 13/20 [02:47<01:21, 11.66s/it]
Task 8, Epoch 14/20 => Loss 0.096, Train_accy 96.75:  65%|██████▌   | 13/20 [02:55<01:21, 11.66s/it]
Task 8, Epoch 14/20 => Loss 0.096, Train_accy 96.75:  70%|███████   | 14/20 [02:55<01:03, 10.59s/it]
Task 8, Epoch 15/20 => Loss 0.158, Train_accy 94.86, Test_accy 52.44:  70%|███████   | 14/20 [03:34<01:03, 10.59s/it]
Task 8, Epoch 15/20 => Loss 0.158, Train_accy 94.86, Test_accy 52.44:  75%|███████▌  | 15/20 [03:34<01:35, 19.14s/it]
Task 8, Epoch 16/20 => Loss 0.103, Train_accy 96.23:  75%|███████▌  | 15/20 [03:42<01:35, 19.14s/it]                 
Task 8, Epoch 16/20 => Loss 0.103, Train_accy 96.23:  80%|████████  | 16/20 [03:42<01:03, 15.87s/it]
Task 8, Epoch 17/20 => Loss 0.114, Train_accy 95.81:  80%|████████  | 16/20 [03:51<01:03, 15.87s/it]
Task 8, Epoch 17/20 => Loss 0.114, Train_accy 95.81:  85%|████████▌ | 17/20 [03:51<00:40, 13.61s/it]
Task 8, Epoch 18/20 => Loss 0.111, Train_accy 96.75:  85%|████████▌ | 17/20 [03:59<00:40, 13.61s/it]
Task 8, Epoch 18/20 => Loss 0.111, Train_accy 96.75:  90%|█████████ | 18/20 [03:59<00:24, 12.02s/it]
Task 8, Epoch 19/20 => Loss 0.125, Train_accy 95.39:  90%|█████████ | 18/20 [04:08<00:24, 12.02s/it]
Task 8, Epoch 19/20 => Loss 0.125, Train_accy 95.39:  95%|█████████▌| 19/20 [04:08<00:10, 10.94s/it]
Task 8, Epoch 20/20 => Loss 0.132, Train_accy 95.28, Test_accy 52.54:  95%|█████████▌| 19/20 [04:47<00:10, 10.94s/it]
Task 8, Epoch 20/20 => Loss 0.132, Train_accy 95.28, Test_accy 52.54: 100%|██████████| 20/20 [04:47<00:00, 19.36s/it]
Task 8, Epoch 20/20 => Loss 0.132, Train_accy 95.28, Test_accy 52.54: 100%|██████████| 20/20 [04:47<00:00, 14.35s/it]
2024-09-12 15:50:43,014 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.132, Train_accy 95.28, Test_accy 52.54
2024-09-12 15:51:13,264 [trainer.py] => No NME accuracy.
2024-09-12 15:51:13,264 [trainer.py] => CNN: {'total': 52.54, '00-99': 74.47, '100-109': 31.69, '110-119': 30.05, '120-129': 12.18, '130-139': 21.81, '140-149': 29.7, '150-159': 29.56, '160-169': 16.09, '170-179': 28.63, 'old': 53.68, 'new': 28.63}
2024-09-12 15:51:13,265 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82, 59.9, 57.52, 55.63, 53.78, 52.54]
2024-09-12 15:51:13,265 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58, 83.48, 82.8, 82.06, 80.78, 80.35]

Average Accuracy (CNN): 61.64
2024-09-12 15:51:13,265 [trainer.py] => Average Accuracy (CNN): 61.64 

2024-09-12 15:51:13,268 [trainer.py] => All params: 172158352
2024-09-12 15:51:13,270 [trainer.py] => Trainable params: 407240
2024-09-12 15:51:13,270 [dualprompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.487, Train_accy 55.08:   0%|          | 0/20 [00:09<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.487, Train_accy 55.08:   5%|▌         | 1/20 [00:09<03:07,  9.87s/it]
Task 9, Epoch 2/20 => Loss 0.543, Train_accy 83.89:   5%|▌         | 1/20 [00:19<03:07,  9.87s/it]
Task 9, Epoch 2/20 => Loss 0.543, Train_accy 83.89:  10%|█         | 2/20 [00:19<02:50,  9.47s/it]
Task 9, Epoch 3/20 => Loss 0.405, Train_accy 87.39:  10%|█         | 2/20 [00:28<02:50,  9.47s/it]
Task 9, Epoch 3/20 => Loss 0.405, Train_accy 87.39:  15%|█▌        | 3/20 [00:28<02:39,  9.37s/it]
Task 9, Epoch 4/20 => Loss 0.299, Train_accy 90.72:  15%|█▌        | 3/20 [00:37<02:39,  9.37s/it]
Task 9, Epoch 4/20 => Loss 0.299, Train_accy 90.72:  20%|██        | 4/20 [00:37<02:28,  9.27s/it]
Task 9, Epoch 5/20 => Loss 0.310, Train_accy 90.37, Test_accy 50.50:  20%|██        | 4/20 [01:19<02:28,  9.27s/it]
Task 9, Epoch 5/20 => Loss 0.310, Train_accy 90.37, Test_accy 50.50:  25%|██▌       | 5/20 [01:19<05:14, 20.94s/it]
Task 9, Epoch 6/20 => Loss 0.228, Train_accy 92.82:  25%|██▌       | 5/20 [01:28<05:14, 20.94s/it]                 
Task 9, Epoch 6/20 => Loss 0.228, Train_accy 92.82:  30%|███       | 6/20 [01:28<04:00, 17.20s/it]
Task 9, Epoch 7/20 => Loss 0.234, Train_accy 92.38:  30%|███       | 6/20 [01:38<04:00, 17.20s/it]
Task 9, Epoch 7/20 => Loss 0.234, Train_accy 92.38:  35%|███▌      | 7/20 [01:38<03:12, 14.80s/it]
Task 9, Epoch 8/20 => Loss 0.215, Train_accy 92.73:  35%|███▌      | 7/20 [01:48<03:12, 14.80s/it]
Task 9, Epoch 8/20 => Loss 0.215, Train_accy 92.73:  40%|████      | 8/20 [01:48<02:38, 13.24s/it]
Task 9, Epoch 9/20 => Loss 0.202, Train_accy 92.99:  40%|████      | 8/20 [01:58<02:38, 13.24s/it]
Task 9, Epoch 9/20 => Loss 0.202, Train_accy 92.99:  45%|████▌     | 9/20 [01:58<02:13, 12.17s/it]
Task 9, Epoch 10/20 => Loss 0.212, Train_accy 93.52, Test_accy 50.67:  45%|████▌     | 9/20 [02:40<02:13, 12.17s/it]
Task 9, Epoch 10/20 => Loss 0.212, Train_accy 93.52, Test_accy 50.67:  50%|█████     | 10/20 [02:40<03:33, 21.32s/it]
Task 9, Epoch 11/20 => Loss 0.167, Train_accy 94.57:  50%|█████     | 10/20 [02:50<03:33, 21.32s/it]                 
Task 9, Epoch 11/20 => Loss 0.167, Train_accy 94.57:  55%|█████▌    | 11/20 [02:50<02:40, 17.83s/it]
Task 9, Epoch 12/20 => Loss 0.179, Train_accy 94.22:  55%|█████▌    | 11/20 [03:00<02:40, 17.83s/it]
Task 9, Epoch 12/20 => Loss 0.179, Train_accy 94.22:  60%|██████    | 12/20 [03:00<02:03, 15.38s/it]
Task 9, Epoch 13/20 => Loss 0.160, Train_accy 95.01:  60%|██████    | 12/20 [03:09<02:03, 15.38s/it]
Task 9, Epoch 13/20 => Loss 0.160, Train_accy 95.01:  65%|██████▌   | 13/20 [03:09<01:36, 13.72s/it]
Task 9, Epoch 14/20 => Loss 0.136, Train_accy 95.62:  65%|██████▌   | 13/20 [03:19<01:36, 13.72s/it]
Task 9, Epoch 14/20 => Loss 0.136, Train_accy 95.62:  70%|███████   | 14/20 [03:19<01:15, 12.52s/it]
Task 9, Epoch 15/20 => Loss 0.154, Train_accy 95.01, Test_accy 50.86:  70%|███████   | 14/20 [03:59<01:15, 12.52s/it]
Task 9, Epoch 15/20 => Loss 0.154, Train_accy 95.01, Test_accy 50.86:  75%|███████▌  | 15/20 [03:59<01:43, 20.67s/it]
Task 9, Epoch 16/20 => Loss 0.166, Train_accy 94.05:  75%|███████▌  | 15/20 [04:09<01:43, 20.67s/it]                 
Task 9, Epoch 16/20 => Loss 0.166, Train_accy 94.05:  80%|████████  | 16/20 [04:09<01:09, 17.41s/it]
Task 9, Epoch 17/20 => Loss 0.128, Train_accy 95.88:  80%|████████  | 16/20 [04:18<01:09, 17.41s/it]
Task 9, Epoch 17/20 => Loss 0.128, Train_accy 95.88:  85%|████████▌ | 17/20 [04:18<00:45, 15.15s/it]
Task 9, Epoch 18/20 => Loss 0.133, Train_accy 95.45:  85%|████████▌ | 17/20 [04:28<00:45, 15.15s/it]
Task 9, Epoch 18/20 => Loss 0.133, Train_accy 95.45:  90%|█████████ | 18/20 [04:28<00:27, 13.56s/it]
Task 9, Epoch 19/20 => Loss 0.110, Train_accy 96.32:  90%|█████████ | 18/20 [04:38<00:27, 13.56s/it]
Task 9, Epoch 19/20 => Loss 0.110, Train_accy 96.32:  95%|█████████▌| 19/20 [04:38<00:12, 12.44s/it]
Task 9, Epoch 20/20 => Loss 0.096, Train_accy 97.20, Test_accy 50.93:  95%|█████████▌| 19/20 [05:20<00:12, 12.44s/it]
Task 9, Epoch 20/20 => Loss 0.096, Train_accy 97.20, Test_accy 50.93: 100%|██████████| 20/20 [05:20<00:00, 21.30s/it]
Task 9, Epoch 20/20 => Loss 0.096, Train_accy 97.20, Test_accy 50.93: 100%|██████████| 20/20 [05:20<00:00, 16.03s/it]
2024-09-12 15:56:33,917 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.096, Train_accy 97.20, Test_accy 50.93
2024-09-12 15:57:06,101 [trainer.py] => No NME accuracy.
2024-09-12 15:57:06,101 [trainer.py] => CNN: {'total': 50.93, '00-99': 74.84, '100-109': 32.04, '110-119': 30.59, '120-129': 12.18, '130-139': 22.48, '140-149': 29.97, '150-159': 29.83, '160-169': 16.09, '170-179': 28.63, '180-189': 16.88, 'old': 52.87, 'new': 16.88}
2024-09-12 15:57:06,101 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82, 59.9, 57.52, 55.63, 53.78, 52.54, 50.93]
2024-09-12 15:57:06,101 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58, 83.48, 82.8, 82.06, 80.78, 80.35, 79.18]

Average Accuracy (CNN): 60.57
2024-09-12 15:57:06,102 [trainer.py] => Average Accuracy (CNN): 60.57 

2024-09-12 15:57:06,104 [trainer.py] => All params: 172158352
2024-09-12 15:57:06,106 [trainer.py] => Trainable params: 407240
2024-09-12 15:57:06,106 [dualprompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.262, Train_accy 60.02:   0%|          | 0/20 [00:09<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.262, Train_accy 60.02:   5%|▌         | 1/20 [00:09<03:03,  9.68s/it]
Task 10, Epoch 2/20 => Loss 0.353, Train_accy 87.50:   5%|▌         | 1/20 [00:19<03:03,  9.68s/it]
Task 10, Epoch 2/20 => Loss 0.353, Train_accy 87.50:  10%|█         | 2/20 [00:19<02:54,  9.68s/it]
Task 10, Epoch 3/20 => Loss 0.263, Train_accy 90.43:  10%|█         | 2/20 [00:28<02:54,  9.68s/it]
Task 10, Epoch 3/20 => Loss 0.263, Train_accy 90.43:  15%|█▌        | 3/20 [00:28<02:44,  9.66s/it]
Task 10, Epoch 4/20 => Loss 0.230, Train_accy 91.22:  15%|█▌        | 3/20 [00:38<02:44,  9.66s/it]
Task 10, Epoch 4/20 => Loss 0.230, Train_accy 91.22:  20%|██        | 4/20 [00:38<02:35,  9.69s/it]
Task 10, Epoch 5/20 => Loss 0.216, Train_accy 92.29, Test_accy 49.38:  20%|██        | 4/20 [01:19<02:35,  9.69s/it]
Task 10, Epoch 5/20 => Loss 0.216, Train_accy 92.29, Test_accy 49.38:  25%|██▌       | 5/20 [01:19<05:15, 21.04s/it]
Task 10, Epoch 6/20 => Loss 0.180, Train_accy 93.09:  25%|██▌       | 5/20 [01:29<05:15, 21.04s/it]                 
Task 10, Epoch 6/20 => Loss 0.180, Train_accy 93.09:  30%|███       | 6/20 [01:29<04:00, 17.15s/it]
Task 10, Epoch 7/20 => Loss 0.140, Train_accy 94.59:  30%|███       | 6/20 [01:39<04:00, 17.15s/it]
Task 10, Epoch 7/20 => Loss 0.140, Train_accy 94.59:  35%|███▌      | 7/20 [01:39<03:11, 14.75s/it]
Task 10, Epoch 8/20 => Loss 0.141, Train_accy 94.50:  35%|███▌      | 7/20 [01:49<03:11, 14.75s/it]
Task 10, Epoch 8/20 => Loss 0.141, Train_accy 94.50:  40%|████      | 8/20 [01:49<02:38, 13.18s/it]
Task 10, Epoch 9/20 => Loss 0.165, Train_accy 93.53:  40%|████      | 8/20 [01:58<02:38, 13.18s/it]
Task 10, Epoch 9/20 => Loss 0.165, Train_accy 93.53:  45%|████▌     | 9/20 [01:58<02:12, 12.08s/it]
Task 10, Epoch 10/20 => Loss 0.113, Train_accy 95.57, Test_accy 49.12:  45%|████▌     | 9/20 [02:42<02:12, 12.08s/it]
Task 10, Epoch 10/20 => Loss 0.113, Train_accy 95.57, Test_accy 49.12:  50%|█████     | 10/20 [02:42<03:37, 21.72s/it]
Task 10, Epoch 11/20 => Loss 0.110, Train_accy 94.86:  50%|█████     | 10/20 [02:51<03:37, 21.72s/it]                 
Task 10, Epoch 11/20 => Loss 0.110, Train_accy 94.86:  55%|█████▌    | 11/20 [02:51<02:42, 18.06s/it]
Task 10, Epoch 12/20 => Loss 0.089, Train_accy 95.66:  55%|█████▌    | 11/20 [03:01<02:42, 18.06s/it]
Task 10, Epoch 12/20 => Loss 0.089, Train_accy 95.66:  60%|██████    | 12/20 [03:01<02:04, 15.52s/it]
Task 10, Epoch 13/20 => Loss 0.095, Train_accy 95.83:  60%|██████    | 12/20 [03:11<02:04, 15.52s/it]
Task 10, Epoch 13/20 => Loss 0.095, Train_accy 95.83:  65%|██████▌   | 13/20 [03:11<01:36, 13.74s/it]
Task 10, Epoch 14/20 => Loss 0.054, Train_accy 96.63:  65%|██████▌   | 13/20 [03:20<01:36, 13.74s/it]
Task 10, Epoch 14/20 => Loss 0.054, Train_accy 96.63:  70%|███████   | 14/20 [03:20<01:15, 12.51s/it]
Task 10, Epoch 15/20 => Loss 0.094, Train_accy 96.10, Test_accy 49.23:  70%|███████   | 14/20 [04:03<01:15, 12.51s/it]
Task 10, Epoch 15/20 => Loss 0.094, Train_accy 96.10, Test_accy 49.23:  75%|███████▌  | 15/20 [04:03<01:47, 21.51s/it]
Task 10, Epoch 16/20 => Loss 0.086, Train_accy 95.92:  75%|███████▌  | 15/20 [04:12<01:47, 21.51s/it]                 
Task 10, Epoch 16/20 => Loss 0.086, Train_accy 95.92:  80%|████████  | 16/20 [04:12<01:11, 17.80s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 96.99:  80%|████████  | 16/20 [04:21<01:11, 17.80s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 96.99:  85%|████████▌ | 17/20 [04:21<00:45, 15.19s/it]
Task 10, Epoch 18/20 => Loss 0.072, Train_accy 96.45:  85%|████████▌ | 17/20 [04:31<00:45, 15.19s/it]
Task 10, Epoch 18/20 => Loss 0.072, Train_accy 96.45:  90%|█████████ | 18/20 [04:31<00:26, 13.49s/it]
Task 10, Epoch 19/20 => Loss 0.093, Train_accy 96.10:  90%|█████████ | 18/20 [04:40<00:26, 13.49s/it]
Task 10, Epoch 19/20 => Loss 0.093, Train_accy 96.10:  95%|█████████▌| 19/20 [04:40<00:12, 12.35s/it]
Task 10, Epoch 20/20 => Loss 0.064, Train_accy 96.54, Test_accy 49.40:  95%|█████████▌| 19/20 [05:24<00:12, 12.35s/it]
Task 10, Epoch 20/20 => Loss 0.064, Train_accy 96.54, Test_accy 49.40: 100%|██████████| 20/20 [05:24<00:00, 21.64s/it]
Task 10, Epoch 20/20 => Loss 0.064, Train_accy 96.54, Test_accy 49.40: 100%|██████████| 20/20 [05:24<00:00, 16.20s/it]
2024-09-12 16:02:30,191 [dualprompt.py] => Task 10, Epoch 20/20 => Loss 0.064, Train_accy 96.54, Test_accy 49.40
2024-09-12 16:03:03,567 [trainer.py] => No NME accuracy.
2024-09-12 16:03:03,568 [trainer.py] => CNN: {'total': 49.4, '00-99': 74.57, '100-109': 29.58, '110-119': 29.52, '120-129': 11.07, '130-139': 22.48, '140-149': 28.61, '150-159': 28.45, '160-169': 16.09, '170-179': 27.02, '180-189': 17.21, '190-199': 29.89, 'old': 50.32, 'new': 29.89}
2024-09-12 16:03:03,568 [trainer.py] => CNN top1 curve: [74.54, 71.03, 66.97, 62.82, 59.9, 57.52, 55.63, 53.78, 52.54, 50.93, 49.4]
2024-09-12 16:03:03,568 [trainer.py] => CNN top5 curve: [88.78, 87.92, 86.28, 84.58, 83.48, 82.8, 82.06, 80.78, 80.35, 79.18, 78.77]

Average Accuracy (CNN): 59.55
2024-09-12 16:03:03,568 [trainer.py] => Average Accuracy (CNN): 59.55 

Accuracy Matrix (CNN):
[[74.54 74.54 74.54 74.44 74.41 74.57 74.51 74.34 74.47 74.84 74.57]
 [ 0.   34.15 33.1  31.69 31.69 30.99 31.34 32.04 31.69 32.04 29.58]
 [ 0.    0.   32.45 31.38 31.12 30.85 31.12 30.85 30.05 30.59 29.52]
 [ 0.    0.    0.   11.07 11.81 11.44 11.81 11.81 12.18 12.18 11.07]
 [ 0.    0.    0.    0.   21.48 22.48 22.48 22.15 21.81 22.48 22.48]
 [ 0.    0.    0.    0.    0.   29.16 30.52 30.52 29.7  29.97 28.61]
 [ 0.    0.    0.    0.    0.    0.   30.11 29.83 29.56 29.83 28.45]
 [ 0.    0.    0.    0.    0.    0.    0.   16.52 16.09 16.09 16.09]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   28.63 28.63 27.02]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   16.88 17.21]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   29.89]]
2024-09-12 16:03:03,570 [trainer.py] => Forgetting (CNN): 1.4490000000000012
024-09-07 22:48:02,230 [trainer.py] => config: ./exps/coda_prompt_inr_B0_Inc5.json
2024-09-07 22:48:02,247 [trainer.py] => prefix:  
2024-09-07 22:48:02,247 [trainer.py] => dataset: imagenetr
2024-09-07 22:48:02,247 [trainer.py] => memory_size: 0
2024-09-07 22:48:02,247 [trainer.py] => memory_per_class: 0
2024-09-07 22:48:02,247 [trainer.py] => fixed_memory: False
2024-09-07 22:48:02,247 [trainer.py] => shuffle: True
2024-09-07 22:48:02,247 [trainer.py] => init_cls: 40
2024-09-07 22:48:02,247 [trainer.py] => increment: 40
2024-09-07 22:48:02,247 [trainer.py] => model_name: coda_prompt
2024-09-07 22:48:02,247 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-07 22:48:02,247 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-07 22:48:02,247 [trainer.py] => seed: 1993
2024-09-07 22:48:02,247 [trainer.py] => tuned_epoch: 20
2024-09-07 22:48:02,247 [trainer.py] => init_lr: 0.001
2024-09-07 22:48:02,247 [trainer.py] => batch_size: 48
2024-09-07 22:48:02,247 [trainer.py] => weight_decay: 0
2024-09-07 22:48:02,248 [trainer.py] => min_lr: 1e-05
2024-09-07 22:48:02,248 [trainer.py] => optimizer: adam
2024-09-07 22:48:02,248 [trainer.py] => scheduler: cosine
2024-09-07 22:48:02,248 [trainer.py] => reinit_optimizer: True
2024-09-07 22:48:02,248 [trainer.py] => pretrained: True
2024-09-07 22:48:02,248 [trainer.py] => drop: 0.0
2024-09-07 22:48:02,248 [trainer.py] => drop_path: 0.0
2024-09-07 22:48:02,248 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-07 22:48:02,335 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-07 22:48:04,428 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-07 22:48:04,428 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-07 22:48:04,429 [trainer.py] => All params: 89792456
2024-09-07 22:48:04,429 [trainer.py] => Trainable params: 89792456
2024-09-07 22:48:04,429 [coda_prompt.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.789, Train_accy 56.02:   0%|          | 0/20 [00:57<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.789, Train_accy 56.02:   5%|▌         | 1/20 [00:57<18:19, 57.86s/it]
Task 0, Epoch 2/20 => Loss 0.770, Train_accy 79.71:   5%|▌         | 1/20 [01:55<18:19, 57.86s/it]
Task 0, Epoch 2/20 => Loss 0.770, Train_accy 79.71:  10%|█         | 2/20 [01:55<17:20, 57.79s/it]
Task 0, Epoch 3/20 => Loss 0.542, Train_accy 84.31:  10%|█         | 2/20 [02:53<17:20, 57.79s/it]
Task 0, Epoch 3/20 => Loss 0.542, Train_accy 84.31:  15%|█▌        | 3/20 [02:53<16:24, 57.92s/it]
Task 0, Epoch 4/20 => Loss 0.483, Train_accy 86.67:  15%|█▌        | 3/20 [03:51<16:24, 57.92s/it]
Task 0, Epoch 4/20 => Loss 0.483, Train_accy 86.67:  20%|██        | 4/20 [03:51<15:27, 57.95s/it]
Task 0, Epoch 5/20 => Loss 0.408, Train_accy 88.70, Test_accy 86.07:  20%|██        | 4/20 [04:57<15:27, 57.95s/it]
Task 0, Epoch 5/20 => Loss 0.408, Train_accy 88.70, Test_accy 86.07:  25%|██▌       | 5/20 [04:57<15:11, 60.74s/it]
Task 0, Epoch 6/20 => Loss 0.374, Train_accy 89.77:  25%|██▌       | 5/20 [05:55<15:11, 60.74s/it]                 
Task 0, Epoch 6/20 => Loss 0.374, Train_accy 89.77:  30%|███       | 6/20 [05:55<13:57, 59.79s/it]
Task 0, Epoch 7/20 => Loss 0.356, Train_accy 90.24:  30%|███       | 6/20 [06:53<13:57, 59.79s/it]
Task 0, Epoch 7/20 => Loss 0.356, Train_accy 90.24:  35%|███▌      | 7/20 [06:53<12:50, 59.24s/it]
Task 0, Epoch 8/20 => Loss 0.324, Train_accy 91.03:  35%|███▌      | 7/20 [07:51<12:50, 59.24s/it]
Task 0, Epoch 8/20 => Loss 0.324, Train_accy 91.03:  40%|████      | 8/20 [07:51<11:46, 58.85s/it]
Task 0, Epoch 9/20 => Loss 0.327, Train_accy 91.48:  40%|████      | 8/20 [08:49<11:46, 58.85s/it]
Task 0, Epoch 9/20 => Loss 0.327, Train_accy 91.48:  45%|████▌     | 9/20 [08:49<10:44, 58.62s/it]
Task 0, Epoch 10/20 => Loss 0.289, Train_accy 92.14, Test_accy 86.22:  45%|████▌     | 9/20 [09:55<10:44, 58.62s/it]
Task 0, Epoch 10/20 => Loss 0.289, Train_accy 92.14, Test_accy 86.22:  50%|█████     | 10/20 [09:55<10:08, 60.84s/it]
Task 0, Epoch 11/20 => Loss 0.307, Train_accy 91.44:  50%|█████     | 10/20 [10:53<10:08, 60.84s/it]                 
Task 0, Epoch 11/20 => Loss 0.307, Train_accy 91.44:  55%|█████▌    | 11/20 [10:53<08:59, 59.97s/it]
Task 0, Epoch 12/20 => Loss 0.286, Train_accy 91.99:  55%|█████▌    | 11/20 [11:51<08:59, 59.97s/it]
Task 0, Epoch 12/20 => Loss 0.286, Train_accy 91.99:  60%|██████    | 12/20 [11:51<07:55, 59.39s/it]
Task 0, Epoch 13/20 => Loss 0.282, Train_accy 92.42:  60%|██████    | 12/20 [12:49<07:55, 59.39s/it]
Task 0, Epoch 13/20 => Loss 0.282, Train_accy 92.42:  65%|██████▌   | 13/20 [12:49<06:52, 58.96s/it]
Task 0, Epoch 14/20 => Loss 0.276, Train_accy 92.36:  65%|██████▌   | 13/20 [13:47<06:52, 58.96s/it]
Task 0, Epoch 14/20 => Loss 0.276, Train_accy 92.36:  70%|███████   | 14/20 [13:47<05:51, 58.65s/it]
Task 0, Epoch 15/20 => Loss 0.261, Train_accy 92.94, Test_accy 87.28:  70%|███████   | 14/20 [14:53<05:51, 58.65s/it]
Task 0, Epoch 15/20 => Loss 0.261, Train_accy 92.94, Test_accy 87.28:  75%|███████▌  | 15/20 [14:53<05:04, 60.80s/it]
Task 0, Epoch 16/20 => Loss 0.248, Train_accy 93.19:  75%|███████▌  | 15/20 [15:51<05:04, 60.80s/it]                 
Task 0, Epoch 16/20 => Loss 0.248, Train_accy 93.19:  80%|████████  | 16/20 [15:51<03:59, 59.94s/it]
Task 0, Epoch 17/20 => Loss 0.237, Train_accy 93.43:  80%|████████  | 16/20 [16:48<03:59, 59.94s/it]
Task 0, Epoch 17/20 => Loss 0.237, Train_accy 93.43:  85%|████████▌ | 17/20 [16:48<02:57, 59.33s/it]
Task 0, Epoch 18/20 => Loss 0.201, Train_accy 94.46:  85%|████████▌ | 17/20 [17:46<02:57, 59.33s/it]
Task 0, Epoch 18/20 => Loss 0.201, Train_accy 94.46:  90%|█████████ | 18/20 [17:46<01:57, 58.92s/it]
Task 0, Epoch 19/20 => Loss 0.225, Train_accy 93.88:  90%|█████████ | 18/20 [18:44<01:57, 58.92s/it]
Task 0, Epoch 19/20 => Loss 0.225, Train_accy 93.88:  95%|█████████▌| 19/20 [18:44<00:58, 58.65s/it]
Task 0, Epoch 20/20 => Loss 0.218, Train_accy 93.88, Test_accy 88.12:  95%|█████████▌| 19/20 [19:50<00:58, 58.65s/it]
Task 0, Epoch 20/20 => Loss 0.218, Train_accy 93.88, Test_accy 88.12: 100%|██████████| 20/20 [19:50<00:00, 60.74s/it]
Task 0, Epoch 20/20 => Loss 0.218, Train_accy 93.88, Test_accy 88.12: 100%|██████████| 20/20 [19:50<00:00, 59.53s/it]
2024-09-07 23:07:55,468 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.218, Train_accy 93.88, Test_accy 88.12
2024-09-07 23:08:03,221 [trainer.py] => No NME accuracy.
2024-09-07 23:08:03,222 [trainer.py] => CNN: {'total': 88.12, '00-39': 88.12, 'old': 0, 'new': 88.12}
2024-09-07 23:08:03,222 [trainer.py] => CNN top1 curve: [88.12]
2024-09-07 23:08:03,222 [trainer.py] => CNN top5 curve: [96.44]

Average Accuracy (CNN): 88.12
2024-09-07 23:08:03,222 [trainer.py] => Average Accuracy (CNN): 88.12 

2024-09-07 23:08:03,224 [trainer.py] => All params: 89792456
2024-09-07 23:08:03,225 [trainer.py] => Trainable params: 89792456
2024-09-07 23:08:04,617 [coda_prompt.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.687, Train_accy 59.01:   0%|          | 0/20 [00:50<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.687, Train_accy 59.01:   5%|▌         | 1/20 [00:50<15:55, 50.27s/it]
Task 1, Epoch 2/20 => Loss 0.743, Train_accy 80.12:   5%|▌         | 1/20 [01:40<15:55, 50.27s/it]
Task 1, Epoch 2/20 => Loss 0.743, Train_accy 80.12:  10%|█         | 2/20 [01:40<15:05, 50.29s/it]
Task 1, Epoch 3/20 => Loss 0.555, Train_accy 84.92:  10%|█         | 2/20 [02:30<15:05, 50.29s/it]
Task 1, Epoch 3/20 => Loss 0.555, Train_accy 84.92:  15%|█▌        | 3/20 [02:30<14:15, 50.33s/it]
Task 1, Epoch 4/20 => Loss 0.499, Train_accy 86.48:  15%|█▌        | 3/20 [03:21<14:15, 50.33s/it]
Task 1, Epoch 4/20 => Loss 0.499, Train_accy 86.48:  20%|██        | 4/20 [03:21<13:25, 50.37s/it]
Task 1, Epoch 5/20 => Loss 0.397, Train_accy 88.85, Test_accy 80.34:  20%|██        | 4/20 [04:26<13:25, 50.37s/it]
Task 1, Epoch 5/20 => Loss 0.397, Train_accy 88.85, Test_accy 80.34:  25%|██▌       | 5/20 [04:26<13:52, 55.52s/it]
Task 1, Epoch 6/20 => Loss 0.416, Train_accy 88.26:  25%|██▌       | 5/20 [05:16<13:52, 55.52s/it]                 
Task 1, Epoch 6/20 => Loss 0.416, Train_accy 88.26:  30%|███       | 6/20 [05:16<12:32, 53.74s/it]
Task 1, Epoch 7/20 => Loss 0.373, Train_accy 90.06:  30%|███       | 6/20 [06:06<12:32, 53.74s/it]
Task 1, Epoch 7/20 => Loss 0.373, Train_accy 90.06:  35%|███▌      | 7/20 [06:06<11:23, 52.60s/it]
Task 1, Epoch 8/20 => Loss 0.337, Train_accy 90.28:  35%|███▌      | 7/20 [06:56<11:23, 52.60s/it]
Task 1, Epoch 8/20 => Loss 0.337, Train_accy 90.28:  40%|████      | 8/20 [06:56<10:22, 51.90s/it]
Task 1, Epoch 9/20 => Loss 0.304, Train_accy 91.25:  40%|████      | 8/20 [07:47<10:22, 51.90s/it]
Task 1, Epoch 9/20 => Loss 0.304, Train_accy 91.25:  45%|████▌     | 9/20 [07:47<09:25, 51.41s/it]
Task 1, Epoch 10/20 => Loss 0.311, Train_accy 91.58, Test_accy 81.14:  45%|████▌     | 9/20 [08:51<09:25, 51.41s/it]
Task 1, Epoch 10/20 => Loss 0.311, Train_accy 91.58, Test_accy 81.14:  50%|█████     | 10/20 [08:51<09:14, 55.49s/it]
Task 1, Epoch 11/20 => Loss 0.297, Train_accy 91.51:  50%|█████     | 10/20 [09:42<09:14, 55.49s/it]                 
Task 1, Epoch 11/20 => Loss 0.297, Train_accy 91.51:  55%|█████▌    | 11/20 [09:42<08:05, 53.94s/it]
Task 1, Epoch 12/20 => Loss 0.294, Train_accy 91.84:  55%|█████▌    | 11/20 [10:32<08:05, 53.94s/it]
Task 1, Epoch 12/20 => Loss 0.294, Train_accy 91.84:  60%|██████    | 12/20 [10:32<07:02, 52.78s/it]
Task 1, Epoch 13/20 => Loss 0.269, Train_accy 92.38:  60%|██████    | 12/20 [11:22<07:02, 52.78s/it]
Task 1, Epoch 13/20 => Loss 0.269, Train_accy 92.38:  65%|██████▌   | 13/20 [11:22<06:04, 52.04s/it]
Task 1, Epoch 14/20 => Loss 0.275, Train_accy 92.60:  65%|██████▌   | 13/20 [12:13<06:04, 52.04s/it]
Task 1, Epoch 14/20 => Loss 0.275, Train_accy 92.60:  70%|███████   | 14/20 [12:13<05:09, 51.51s/it]
Task 1, Epoch 15/20 => Loss 0.254, Train_accy 92.95, Test_accy 81.71:  70%|███████   | 14/20 [13:17<05:09, 51.51s/it]
Task 1, Epoch 15/20 => Loss 0.254, Train_accy 92.95, Test_accy 81.71:  75%|███████▌  | 15/20 [13:17<04:37, 55.47s/it]
Task 1, Epoch 16/20 => Loss 0.266, Train_accy 92.45:  75%|███████▌  | 15/20 [14:08<04:37, 55.47s/it]                 
Task 1, Epoch 16/20 => Loss 0.266, Train_accy 92.45:  80%|████████  | 16/20 [14:08<03:35, 53.94s/it]
Task 1, Epoch 17/20 => Loss 0.238, Train_accy 93.03:  80%|████████  | 16/20 [14:58<03:35, 53.94s/it]
Task 1, Epoch 17/20 => Loss 0.238, Train_accy 93.03:  85%|████████▌ | 17/20 [14:58<02:38, 52.87s/it]
Task 1, Epoch 18/20 => Loss 0.228, Train_accy 93.86:  85%|████████▌ | 17/20 [15:48<02:38, 52.87s/it]
Task 1, Epoch 18/20 => Loss 0.228, Train_accy 93.86:  90%|█████████ | 18/20 [15:48<01:44, 52.09s/it]
Task 1, Epoch 19/20 => Loss 0.218, Train_accy 93.88:  90%|█████████ | 18/20 [16:39<01:44, 52.09s/it]
Task 1, Epoch 19/20 => Loss 0.218, Train_accy 93.88:  95%|█████████▌| 19/20 [16:39<00:51, 51.58s/it]
Task 1, Epoch 20/20 => Loss 0.225, Train_accy 93.82, Test_accy 81.39:  95%|█████████▌| 19/20 [17:43<00:51, 51.58s/it]
Task 1, Epoch 20/20 => Loss 0.225, Train_accy 93.82, Test_accy 81.39: 100%|██████████| 20/20 [17:43<00:00, 55.47s/it]
Task 1, Epoch 20/20 => Loss 0.225, Train_accy 93.82, Test_accy 81.39: 100%|██████████| 20/20 [17:43<00:00, 53.19s/it]
2024-09-07 23:25:48,339 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.225, Train_accy 93.82, Test_accy 81.39
2024-09-07 23:26:02,649 [trainer.py] => No NME accuracy.
2024-09-07 23:26:02,650 [trainer.py] => CNN: {'total': 81.39, '00-39': 85.16, '40-79': 77.15, 'old': 85.16, 'new': 77.15}
2024-09-07 23:26:02,650 [trainer.py] => CNN top1 curve: [88.12, 81.39]
2024-09-07 23:26:02,650 [trainer.py] => CNN top5 curve: [96.44, 93.71]

Average Accuracy (CNN): 84.76
2024-09-07 23:26:02,650 [trainer.py] => Average Accuracy (CNN): 84.76 

2024-09-07 23:26:02,652 [trainer.py] => All params: 89792456
2024-09-07 23:26:02,653 [trainer.py] => Trainable params: 89792456
2024-09-07 23:26:04,699 [coda_prompt.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.580, Train_accy 61.15:   0%|          | 0/20 [00:52<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.580, Train_accy 61.15:   5%|▌         | 1/20 [00:52<16:34, 52.37s/it]
Task 2, Epoch 2/20 => Loss 0.677, Train_accy 81.65:   5%|▌         | 1/20 [01:44<16:34, 52.37s/it]
Task 2, Epoch 2/20 => Loss 0.677, Train_accy 81.65:  10%|█         | 2/20 [01:44<15:42, 52.37s/it]
Task 2, Epoch 3/20 => Loss 0.541, Train_accy 85.31:  10%|█         | 2/20 [02:37<15:42, 52.37s/it]
Task 2, Epoch 3/20 => Loss 0.541, Train_accy 85.31:  15%|█▌        | 3/20 [02:37<14:50, 52.40s/it]
Task 2, Epoch 4/20 => Loss 0.466, Train_accy 86.94:  15%|█▌        | 3/20 [03:29<14:50, 52.40s/it]
Task 2, Epoch 4/20 => Loss 0.466, Train_accy 86.94:  20%|██        | 4/20 [03:29<13:58, 52.39s/it]
Task 2, Epoch 5/20 => Loss 0.408, Train_accy 88.52, Test_accy 76.35:  20%|██        | 4/20 [04:42<13:58, 52.39s/it]
Task 2, Epoch 5/20 => Loss 0.408, Train_accy 88.52, Test_accy 76.35:  25%|██▌       | 5/20 [04:42<14:57, 59.84s/it]
Task 2, Epoch 6/20 => Loss 0.369, Train_accy 89.71:  25%|██▌       | 5/20 [05:35<14:57, 59.84s/it]                 
Task 2, Epoch 6/20 => Loss 0.369, Train_accy 89.71:  30%|███       | 6/20 [05:35<13:22, 57.33s/it]
Task 2, Epoch 7/20 => Loss 0.340, Train_accy 90.40:  30%|███       | 6/20 [06:27<13:22, 57.33s/it]
Task 2, Epoch 7/20 => Loss 0.340, Train_accy 90.40:  35%|███▌      | 7/20 [06:27<12:04, 55.72s/it]
Task 2, Epoch 8/20 => Loss 0.329, Train_accy 90.94:  35%|███▌      | 7/20 [07:19<12:04, 55.72s/it]
Task 2, Epoch 8/20 => Loss 0.329, Train_accy 90.94:  40%|████      | 8/20 [07:19<10:55, 54.66s/it]
Task 2, Epoch 9/20 => Loss 0.303, Train_accy 91.73:  40%|████      | 8/20 [08:12<10:55, 54.66s/it]
Task 2, Epoch 9/20 => Loss 0.303, Train_accy 91.73:  45%|████▌     | 9/20 [08:12<09:53, 53.96s/it]
Task 2, Epoch 10/20 => Loss 0.314, Train_accy 91.42, Test_accy 77.94:  45%|████▌     | 9/20 [09:25<09:53, 53.96s/it]
Task 2, Epoch 10/20 => Loss 0.314, Train_accy 91.42, Test_accy 77.94:  50%|█████     | 10/20 [09:25<09:58, 59.83s/it]
Task 2, Epoch 11/20 => Loss 0.288, Train_accy 92.40:  50%|█████     | 10/20 [10:17<09:58, 59.83s/it]                 
Task 2, Epoch 11/20 => Loss 0.288, Train_accy 92.40:  55%|█████▌    | 11/20 [10:17<08:37, 57.55s/it]
Task 2, Epoch 12/20 => Loss 0.281, Train_accy 92.02:  55%|█████▌    | 11/20 [11:09<08:37, 57.55s/it]
Task 2, Epoch 12/20 => Loss 0.281, Train_accy 92.02:  60%|██████    | 12/20 [11:09<07:26, 55.86s/it]
Task 2, Epoch 13/20 => Loss 0.289, Train_accy 92.31:  60%|██████    | 12/20 [12:02<07:26, 55.86s/it]
Task 2, Epoch 13/20 => Loss 0.289, Train_accy 92.31:  65%|██████▌   | 13/20 [12:02<06:23, 54.86s/it]
Task 2, Epoch 14/20 => Loss 0.279, Train_accy 92.17:  65%|██████▌   | 13/20 [12:54<06:23, 54.86s/it]
Task 2, Epoch 14/20 => Loss 0.279, Train_accy 92.17:  70%|███████   | 14/20 [12:54<05:24, 54.11s/it]
Task 2, Epoch 15/20 => Loss 0.245, Train_accy 93.10, Test_accy 78.33:  70%|███████   | 14/20 [14:07<05:24, 54.11s/it]
Task 2, Epoch 15/20 => Loss 0.245, Train_accy 93.10, Test_accy 78.33:  75%|███████▌  | 15/20 [14:07<04:58, 59.78s/it]
Task 2, Epoch 16/20 => Loss 0.248, Train_accy 93.60:  75%|███████▌  | 15/20 [14:59<04:58, 59.78s/it]                 
Task 2, Epoch 16/20 => Loss 0.248, Train_accy 93.60:  80%|████████  | 16/20 [14:59<03:50, 57.56s/it]
Task 2, Epoch 17/20 => Loss 0.260, Train_accy 92.75:  80%|████████  | 16/20 [15:52<03:50, 57.56s/it]
Task 2, Epoch 17/20 => Loss 0.260, Train_accy 92.75:  85%|████████▌ | 17/20 [15:52<02:48, 56.01s/it]
Task 2, Epoch 18/20 => Loss 0.221, Train_accy 93.81:  85%|████████▌ | 17/20 [16:44<02:48, 56.01s/it]
Task 2, Epoch 18/20 => Loss 0.221, Train_accy 93.81:  90%|█████████ | 18/20 [16:44<01:49, 54.93s/it]
Task 2, Epoch 19/20 => Loss 0.197, Train_accy 94.15:  90%|█████████ | 18/20 [17:37<01:49, 54.93s/it]
Task 2, Epoch 19/20 => Loss 0.197, Train_accy 94.15:  95%|█████████▌| 19/20 [17:37<00:54, 54.19s/it]
Task 2, Epoch 20/20 => Loss 0.223, Train_accy 93.90, Test_accy 78.57:  95%|█████████▌| 19/20 [18:50<00:54, 54.19s/it]
Task 2, Epoch 20/20 => Loss 0.223, Train_accy 93.90, Test_accy 78.57: 100%|██████████| 20/20 [18:50<00:00, 59.84s/it]
Task 2, Epoch 20/20 => Loss 0.223, Train_accy 93.90, Test_accy 78.57: 100%|██████████| 20/20 [18:50<00:00, 56.51s/it]
2024-09-07 23:44:54,880 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.223, Train_accy 93.90, Test_accy 78.57
2024-09-07 23:45:15,527 [trainer.py] => No NME accuracy.
2024-09-07 23:45:15,527 [trainer.py] => CNN: {'total': 78.57, '00-39': 83.42, '40-79': 75.62, '80-119': 76.02, 'old': 79.74, 'new': 76.02}
2024-09-07 23:45:15,528 [trainer.py] => CNN top1 curve: [88.12, 81.39, 78.57]
2024-09-07 23:45:15,528 [trainer.py] => CNN top5 curve: [96.44, 93.71, 91.93]

Average Accuracy (CNN): 82.69
2024-09-07 23:45:15,528 [trainer.py] => Average Accuracy (CNN): 82.69 

2024-09-07 23:45:15,529 [trainer.py] => All params: 89792456
2024-09-07 23:45:15,530 [trainer.py] => Trainable params: 89792456
2024-09-07 23:45:18,429 [coda_prompt.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.501, Train_accy 63.71:   0%|          | 0/20 [00:53<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.501, Train_accy 63.71:   5%|▌         | 1/20 [00:53<17:00, 53.69s/it]
Task 3, Epoch 2/20 => Loss 0.640, Train_accy 82.74:   5%|▌         | 1/20 [01:47<17:00, 53.69s/it]
Task 3, Epoch 2/20 => Loss 0.640, Train_accy 82.74:  10%|█         | 2/20 [01:47<16:04, 53.58s/it]
Task 3, Epoch 3/20 => Loss 0.473, Train_accy 87.13:  10%|█         | 2/20 [02:40<16:04, 53.58s/it]
Task 3, Epoch 3/20 => Loss 0.473, Train_accy 87.13:  15%|█▌        | 3/20 [02:40<15:10, 53.54s/it]
Task 3, Epoch 4/20 => Loss 0.431, Train_accy 88.77:  15%|█▌        | 3/20 [03:34<15:10, 53.54s/it]
Task 3, Epoch 4/20 => Loss 0.431, Train_accy 88.77:  20%|██        | 4/20 [03:34<14:16, 53.51s/it]
Task 3, Epoch 5/20 => Loss 0.374, Train_accy 89.73, Test_accy 75.32:  20%|██        | 4/20 [04:55<14:16, 53.51s/it]
Task 3, Epoch 5/20 => Loss 0.374, Train_accy 89.73, Test_accy 75.32:  25%|██▌       | 5/20 [04:55<15:53, 63.54s/it]
Task 3, Epoch 6/20 => Loss 0.335, Train_accy 90.58:  25%|██▌       | 5/20 [05:48<15:53, 63.54s/it]                 
Task 3, Epoch 6/20 => Loss 0.335, Train_accy 90.58:  30%|███       | 6/20 [05:48<14:01, 60.12s/it]
Task 3, Epoch 7/20 => Loss 0.319, Train_accy 91.16:  30%|███       | 6/20 [06:42<14:01, 60.12s/it]
Task 3, Epoch 7/20 => Loss 0.319, Train_accy 91.16:  35%|███▌      | 7/20 [06:42<12:33, 57.96s/it]
Task 3, Epoch 8/20 => Loss 0.274, Train_accy 92.59:  35%|███▌      | 7/20 [07:35<12:33, 57.96s/it]
Task 3, Epoch 8/20 => Loss 0.274, Train_accy 92.59:  40%|████      | 8/20 [07:35<11:18, 56.53s/it]
Task 3, Epoch 9/20 => Loss 0.297, Train_accy 92.18:  40%|████      | 8/20 [08:29<11:18, 56.53s/it]
Task 3, Epoch 9/20 => Loss 0.297, Train_accy 92.18:  45%|████▌     | 9/20 [08:29<10:11, 55.58s/it]
Task 3, Epoch 10/20 => Loss 0.281, Train_accy 92.03, Test_accy 76.76:  45%|████▌     | 9/20 [09:50<10:11, 55.58s/it]
Task 3, Epoch 10/20 => Loss 0.281, Train_accy 92.03, Test_accy 76.76:  50%|█████     | 10/20 [09:50<10:35, 63.52s/it]
Task 3, Epoch 11/20 => Loss 0.275, Train_accy 92.69:  50%|█████     | 10/20 [10:44<10:35, 63.52s/it]                 
Task 3, Epoch 11/20 => Loss 0.275, Train_accy 92.69:  55%|█████▌    | 11/20 [10:44<09:04, 60.47s/it]
Task 3, Epoch 12/20 => Loss 0.249, Train_accy 92.89:  55%|█████▌    | 11/20 [11:37<09:04, 60.47s/it]
Task 3, Epoch 12/20 => Loss 0.249, Train_accy 92.89:  60%|██████    | 12/20 [11:37<07:46, 58.36s/it]
Task 3, Epoch 13/20 => Loss 0.259, Train_accy 92.54:  60%|██████    | 12/20 [12:31<07:46, 58.36s/it]
Task 3, Epoch 13/20 => Loss 0.259, Train_accy 92.54:  65%|██████▌   | 13/20 [12:31<06:38, 56.90s/it]
Task 3, Epoch 14/20 => Loss 0.216, Train_accy 93.87:  65%|██████▌   | 13/20 [13:24<06:38, 56.90s/it]
Task 3, Epoch 14/20 => Loss 0.216, Train_accy 93.87:  70%|███████   | 14/20 [13:24<05:35, 55.90s/it]
Task 3, Epoch 15/20 => Loss 0.214, Train_accy 94.00, Test_accy 77.32:  70%|███████   | 14/20 [14:46<05:35, 55.90s/it]
Task 3, Epoch 15/20 => Loss 0.214, Train_accy 94.00, Test_accy 77.32:  75%|███████▌  | 15/20 [14:46<05:17, 63.55s/it]
Task 3, Epoch 16/20 => Loss 0.213, Train_accy 94.32:  75%|███████▌  | 15/20 [15:39<05:17, 63.55s/it]                 
Task 3, Epoch 16/20 => Loss 0.213, Train_accy 94.32:  80%|████████  | 16/20 [15:39<04:02, 60.55s/it]
Task 3, Epoch 17/20 => Loss 0.232, Train_accy 93.53:  80%|████████  | 16/20 [16:33<04:02, 60.55s/it]
Task 3, Epoch 17/20 => Loss 0.232, Train_accy 93.53:  85%|████████▌ | 17/20 [16:33<02:55, 58.43s/it]
Task 3, Epoch 18/20 => Loss 0.223, Train_accy 94.10:  85%|████████▌ | 17/20 [17:26<02:55, 58.43s/it]
Task 3, Epoch 18/20 => Loss 0.223, Train_accy 94.10:  90%|█████████ | 18/20 [17:26<01:53, 56.94s/it]
Task 3, Epoch 19/20 => Loss 0.190, Train_accy 94.59:  90%|█████████ | 18/20 [18:20<01:53, 56.94s/it]
Task 3, Epoch 19/20 => Loss 0.190, Train_accy 94.59:  95%|█████████▌| 19/20 [18:20<00:55, 55.90s/it]
Task 3, Epoch 20/20 => Loss 0.190, Train_accy 95.00, Test_accy 77.10:  95%|█████████▌| 19/20 [19:41<00:55, 55.90s/it]
Task 3, Epoch 20/20 => Loss 0.190, Train_accy 95.00, Test_accy 77.10: 100%|██████████| 20/20 [19:41<00:00, 63.53s/it]
Task 3, Epoch 20/20 => Loss 0.190, Train_accy 95.00, Test_accy 77.10: 100%|██████████| 20/20 [19:41<00:00, 59.08s/it]
2024-09-08 00:04:59,983 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.190, Train_accy 95.00, Test_accy 77.10
2024-09-08 00:05:27,730 [trainer.py] => No NME accuracy.
2024-09-08 00:05:27,730 [trainer.py] => CNN: {'total': 77.1, '00-39': 82.66, '40-79': 74.94, '80-119': 73.84, '120-159': 76.27, 'old': 77.39, 'new': 76.27}
2024-09-08 00:05:27,731 [trainer.py] => CNN top1 curve: [88.12, 81.39, 78.57, 77.1]
2024-09-08 00:05:27,731 [trainer.py] => CNN top5 curve: [96.44, 93.71, 91.93, 90.92]

Average Accuracy (CNN): 81.29
2024-09-08 00:05:27,731 [trainer.py] => Average Accuracy (CNN): 81.29 

2024-09-08 00:05:27,732 [trainer.py] => All params: 89792456
2024-09-08 00:05:27,733 [trainer.py] => Trainable params: 89792456
2024-09-08 00:05:31,531 [coda_prompt.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.560, Train_accy 61.85:   0%|          | 0/20 [00:45<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.560, Train_accy 61.85:   5%|▌         | 1/20 [00:45<14:27, 45.64s/it]
Task 4, Epoch 2/20 => Loss 0.695, Train_accy 81.06:   5%|▌         | 1/20 [01:31<14:27, 45.64s/it]
Task 4, Epoch 2/20 => Loss 0.695, Train_accy 81.06:  10%|█         | 2/20 [01:31<13:42, 45.69s/it]
Task 4, Epoch 3/20 => Loss 0.548, Train_accy 84.99:  10%|█         | 2/20 [02:17<13:42, 45.69s/it]
Task 4, Epoch 3/20 => Loss 0.548, Train_accy 84.99:  15%|█▌        | 3/20 [02:17<12:56, 45.68s/it]
Task 4, Epoch 4/20 => Loss 0.447, Train_accy 87.69:  15%|█▌        | 3/20 [03:02<12:56, 45.68s/it]
Task 4, Epoch 4/20 => Loss 0.447, Train_accy 87.69:  20%|██        | 4/20 [03:02<12:10, 45.68s/it]
Task 4, Epoch 5/20 => Loss 0.413, Train_accy 89.08, Test_accy 73.92:  20%|██        | 4/20 [04:22<12:10, 45.68s/it]
Task 4, Epoch 5/20 => Loss 0.413, Train_accy 89.08, Test_accy 73.92:  25%|██▌       | 5/20 [04:22<14:27, 57.82s/it]
Task 4, Epoch 6/20 => Loss 0.362, Train_accy 90.52:  25%|██▌       | 5/20 [05:07<14:27, 57.82s/it]                 
Task 4, Epoch 6/20 => Loss 0.362, Train_accy 90.52:  30%|███       | 6/20 [05:07<12:32, 53.75s/it]
Task 4, Epoch 7/20 => Loss 0.365, Train_accy 89.73:  30%|███       | 6/20 [05:53<12:32, 53.75s/it]
Task 4, Epoch 7/20 => Loss 0.365, Train_accy 89.73:  35%|███▌      | 7/20 [05:53<11:04, 51.12s/it]
Task 4, Epoch 8/20 => Loss 0.320, Train_accy 91.07:  35%|███▌      | 7/20 [06:39<11:04, 51.12s/it]
Task 4, Epoch 8/20 => Loss 0.320, Train_accy 91.07:  40%|████      | 8/20 [06:39<09:52, 49.40s/it]
Task 4, Epoch 9/20 => Loss 0.314, Train_accy 91.69:  40%|████      | 8/20 [07:24<09:52, 49.40s/it]
Task 4, Epoch 9/20 => Loss 0.314, Train_accy 91.69:  45%|████▌     | 9/20 [07:24<08:50, 48.23s/it]
Task 4, Epoch 10/20 => Loss 0.302, Train_accy 91.95, Test_accy 74.90:  45%|████▌     | 9/20 [08:44<08:50, 48.23s/it]
Task 4, Epoch 10/20 => Loss 0.302, Train_accy 91.95, Test_accy 74.90:  50%|█████     | 10/20 [08:44<09:38, 57.87s/it]
Task 4, Epoch 11/20 => Loss 0.288, Train_accy 92.29:  50%|█████     | 10/20 [09:30<09:38, 57.87s/it]                 
Task 4, Epoch 11/20 => Loss 0.288, Train_accy 92.29:  55%|█████▌    | 11/20 [09:30<08:07, 54.14s/it]
Task 4, Epoch 12/20 => Loss 0.249, Train_accy 93.53:  55%|█████▌    | 11/20 [10:15<08:07, 54.14s/it]
Task 4, Epoch 12/20 => Loss 0.249, Train_accy 93.53:  60%|██████    | 12/20 [10:15<06:52, 51.55s/it]
Task 4, Epoch 13/20 => Loss 0.257, Train_accy 93.13:  60%|██████    | 12/20 [11:01<06:52, 51.55s/it]
Task 4, Epoch 13/20 => Loss 0.257, Train_accy 93.13:  65%|██████▌   | 13/20 [11:01<05:48, 49.77s/it]
Task 4, Epoch 14/20 => Loss 0.250, Train_accy 93.03:  65%|██████▌   | 13/20 [11:47<05:48, 49.77s/it]
Task 4, Epoch 14/20 => Loss 0.250, Train_accy 93.03:  70%|███████   | 14/20 [11:47<04:51, 48.54s/it]
Task 4, Epoch 15/20 => Loss 0.255, Train_accy 93.41, Test_accy 74.82:  70%|███████   | 14/20 [13:06<04:51, 48.54s/it]
Task 4, Epoch 15/20 => Loss 0.255, Train_accy 93.41, Test_accy 74.82:  75%|███████▌  | 15/20 [13:06<04:49, 57.85s/it]
Task 4, Epoch 16/20 => Loss 0.242, Train_accy 93.53:  75%|███████▌  | 15/20 [13:52<04:49, 57.85s/it]                 
Task 4, Epoch 16/20 => Loss 0.242, Train_accy 93.53:  80%|████████  | 16/20 [13:52<03:36, 54.20s/it]
Task 4, Epoch 17/20 => Loss 0.216, Train_accy 94.09:  80%|████████  | 16/20 [14:37<03:36, 54.20s/it]
Task 4, Epoch 17/20 => Loss 0.216, Train_accy 94.09:  85%|████████▌ | 17/20 [14:37<02:34, 51.64s/it]
Task 4, Epoch 18/20 => Loss 0.222, Train_accy 93.99:  85%|████████▌ | 17/20 [15:23<02:34, 51.64s/it]
Task 4, Epoch 18/20 => Loss 0.222, Train_accy 93.99:  90%|█████████ | 18/20 [15:23<01:39, 49.88s/it]
Task 4, Epoch 19/20 => Loss 0.201, Train_accy 94.61:  90%|█████████ | 18/20 [16:09<01:39, 49.88s/it]
Task 4, Epoch 19/20 => Loss 0.201, Train_accy 94.61:  95%|█████████▌| 19/20 [16:09<00:48, 48.71s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 94.66, Test_accy 74.78:  95%|█████████▌| 19/20 [17:29<00:48, 48.71s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 94.66, Test_accy 74.78: 100%|██████████| 20/20 [17:29<00:00, 57.98s/it]
Task 4, Epoch 20/20 => Loss 0.202, Train_accy 94.66, Test_accy 74.78: 100%|██████████| 20/20 [17:29<00:00, 52.47s/it]
2024-09-08 00:23:00,865 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.202, Train_accy 94.66, Test_accy 74.78
2024-09-08 00:23:34,651 [trainer.py] => No NME accuracy.
2024-09-08 00:23:34,651 [trainer.py] => CNN: {'total': 74.78, '00-39': 81.3, '40-79': 74.0, '80-119': 72.8, '120-159': 75.58, '160-199': 68.68, 'old': 76.09, 'new': 68.68}
2024-09-08 00:23:34,651 [trainer.py] => CNN top1 curve: [88.12, 81.39, 78.57, 77.1, 74.78]
2024-09-08 00:23:34,651 [trainer.py] => CNN top5 curve: [96.44, 93.71, 91.93, 90.92, 89.57]

Average Accuracy (CNN): 79.99
2024-09-08 00:23:34,652 [trainer.py] => Average Accuracy (CNN): 79.99 

Accuracy Matrix (CNN):
[[88.12 85.16 83.42 82.66 81.3 ]
 [ 0.   77.15 75.62 74.94 74.  ]
 [ 0.    0.   76.02 73.84 72.8 ]
 [ 0.    0.    0.   76.27 75.58]
 [ 0.    0.    0.    0.   68.68]]
2024-09-08 00:23:34,653 [trainer.py] => Forgetting (CNN): 3.4700000000000024
2024-09-08 00:23:37,446 [trainer.py] => config: ./exps/coda_prompt_inr_B0_Inc10.json
2024-09-08 00:23:37,446 [trainer.py] => prefix:  
2024-09-08 00:23:37,446 [trainer.py] => dataset: imagenetr
2024-09-08 00:23:37,446 [trainer.py] => memory_size: 0
2024-09-08 00:23:37,446 [trainer.py] => memory_per_class: 0
2024-09-08 00:23:37,446 [trainer.py] => fixed_memory: False
2024-09-08 00:23:37,446 [trainer.py] => shuffle: True
2024-09-08 00:23:37,446 [trainer.py] => init_cls: 20
2024-09-08 00:23:37,446 [trainer.py] => increment: 20
2024-09-08 00:23:37,446 [trainer.py] => model_name: coda_prompt
2024-09-08 00:23:37,446 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-08 00:23:37,446 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 00:23:37,446 [trainer.py] => seed: 1993
2024-09-08 00:23:37,446 [trainer.py] => tuned_epoch: 20
2024-09-08 00:23:37,446 [trainer.py] => init_lr: 0.001
2024-09-08 00:23:37,446 [trainer.py] => batch_size: 48
2024-09-08 00:23:37,446 [trainer.py] => weight_decay: 0
2024-09-08 00:23:37,447 [trainer.py] => min_lr: 1e-05
2024-09-08 00:23:37,447 [trainer.py] => optimizer: adam
2024-09-08 00:23:37,447 [trainer.py] => scheduler: cosine
2024-09-08 00:23:37,447 [trainer.py] => reinit_optimizer: True
2024-09-08 00:23:37,447 [trainer.py] => pretrained: True
2024-09-08 00:23:37,447 [trainer.py] => drop: 0.0
2024-09-08 00:23:37,447 [trainer.py] => drop_path: 0.0
2024-09-08 00:23:37,447 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-08 00:23:37,529 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-08 00:23:39,425 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-08 00:23:39,425 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-08 00:23:39,426 [trainer.py] => All params: 89792456
2024-09-08 00:23:39,426 [trainer.py] => Trainable params: 89792456
2024-09-08 00:23:39,426 [coda_prompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.577, Train_accy 56.75:   0%|          | 0/20 [00:30<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.577, Train_accy 56.75:   5%|▌         | 1/20 [00:30<09:45, 30.80s/it]
Task 0, Epoch 2/20 => Loss 0.717, Train_accy 78.77:   5%|▌         | 1/20 [01:01<09:45, 30.80s/it]
Task 0, Epoch 2/20 => Loss 0.717, Train_accy 78.77:  10%|█         | 2/20 [01:01<09:10, 30.58s/it]
Task 0, Epoch 3/20 => Loss 0.492, Train_accy 86.03:  10%|█         | 2/20 [01:31<09:10, 30.58s/it]
Task 0, Epoch 3/20 => Loss 0.492, Train_accy 86.03:  15%|█▌        | 3/20 [01:31<08:39, 30.55s/it]
Task 0, Epoch 4/20 => Loss 0.381, Train_accy 88.18:  15%|█▌        | 3/20 [02:02<08:39, 30.55s/it]
Task 0, Epoch 4/20 => Loss 0.381, Train_accy 88.18:  20%|██        | 4/20 [02:02<08:07, 30.47s/it]
Task 0, Epoch 5/20 => Loss 0.374, Train_accy 88.76, Test_accy 86.50:  20%|██        | 4/20 [02:36<08:07, 30.47s/it]
Task 0, Epoch 5/20 => Loss 0.374, Train_accy 88.76, Test_accy 86.50:  25%|██▌       | 5/20 [02:36<07:59, 31.97s/it]
Task 0, Epoch 6/20 => Loss 0.295, Train_accy 91.42:  25%|██▌       | 5/20 [03:07<07:59, 31.97s/it]                 
Task 0, Epoch 6/20 => Loss 0.295, Train_accy 91.42:  30%|███       | 6/20 [03:07<07:20, 31.45s/it]
Task 0, Epoch 7/20 => Loss 0.257, Train_accy 92.74:  30%|███       | 6/20 [03:37<07:20, 31.45s/it]
Task 0, Epoch 7/20 => Loss 0.257, Train_accy 92.74:  35%|███▌      | 7/20 [03:37<06:44, 31.14s/it]
Task 0, Epoch 8/20 => Loss 0.246, Train_accy 92.89:  35%|███▌      | 7/20 [04:08<06:44, 31.14s/it]
Task 0, Epoch 8/20 => Loss 0.246, Train_accy 92.89:  40%|████      | 8/20 [04:08<06:10, 30.90s/it]
Task 0, Epoch 9/20 => Loss 0.218, Train_accy 93.75:  40%|████      | 8/20 [04:38<06:10, 30.90s/it]
Task 0, Epoch 9/20 => Loss 0.218, Train_accy 93.75:  45%|████▌     | 9/20 [04:38<05:38, 30.77s/it]
Task 0, Epoch 10/20 => Loss 0.232, Train_accy 93.50, Test_accy 87.66:  45%|████▌     | 9/20 [05:13<05:38, 30.77s/it]
Task 0, Epoch 10/20 => Loss 0.232, Train_accy 93.50, Test_accy 87.66:  50%|█████     | 10/20 [05:13<05:19, 31.97s/it]
Task 0, Epoch 11/20 => Loss 0.201, Train_accy 94.43:  50%|█████     | 10/20 [05:43<05:19, 31.97s/it]                 
Task 0, Epoch 11/20 => Loss 0.201, Train_accy 94.43:  55%|█████▌    | 11/20 [05:43<04:43, 31.48s/it]
Task 0, Epoch 12/20 => Loss 0.202, Train_accy 93.86:  55%|█████▌    | 11/20 [06:13<04:43, 31.48s/it]
Task 0, Epoch 12/20 => Loss 0.202, Train_accy 93.86:  60%|██████    | 12/20 [06:13<04:09, 31.14s/it]
Task 0, Epoch 13/20 => Loss 0.198, Train_accy 94.18:  60%|██████    | 12/20 [06:44<04:09, 31.14s/it]
Task 0, Epoch 13/20 => Loss 0.198, Train_accy 94.18:  65%|██████▌   | 13/20 [06:44<03:36, 30.90s/it]
Task 0, Epoch 14/20 => Loss 0.191, Train_accy 94.50:  65%|██████▌   | 13/20 [07:14<03:36, 30.90s/it]
Task 0, Epoch 14/20 => Loss 0.191, Train_accy 94.50:  70%|███████   | 14/20 [07:14<03:04, 30.76s/it]
Task 0, Epoch 15/20 => Loss 0.185, Train_accy 94.32, Test_accy 87.95:  70%|███████   | 14/20 [07:49<03:04, 30.76s/it]
Task 0, Epoch 15/20 => Loss 0.185, Train_accy 94.32, Test_accy 87.95:  75%|███████▌  | 15/20 [07:49<02:39, 31.92s/it]
Task 0, Epoch 16/20 => Loss 0.153, Train_accy 95.98:  75%|███████▌  | 15/20 [08:19<02:39, 31.92s/it]                 
Task 0, Epoch 16/20 => Loss 0.153, Train_accy 95.98:  80%|████████  | 16/20 [08:19<02:05, 31.48s/it]
Task 0, Epoch 17/20 => Loss 0.160, Train_accy 95.44:  80%|████████  | 16/20 [08:50<02:05, 31.48s/it]
Task 0, Epoch 17/20 => Loss 0.160, Train_accy 95.44:  85%|████████▌ | 17/20 [08:50<01:33, 31.18s/it]
Task 0, Epoch 18/20 => Loss 0.158, Train_accy 95.80:  85%|████████▌ | 17/20 [09:20<01:33, 31.18s/it]
Task 0, Epoch 18/20 => Loss 0.158, Train_accy 95.80:  90%|█████████ | 18/20 [09:20<01:01, 30.95s/it]
Task 0, Epoch 19/20 => Loss 0.145, Train_accy 95.94:  90%|█████████ | 18/20 [09:50<01:01, 30.95s/it]
Task 0, Epoch 19/20 => Loss 0.145, Train_accy 95.94:  95%|█████████▌| 19/20 [09:50<00:30, 30.76s/it]
Task 0, Epoch 20/20 => Loss 0.143, Train_accy 95.87, Test_accy 88.97:  95%|█████████▌| 19/20 [10:25<00:30, 30.76s/it]
Task 0, Epoch 20/20 => Loss 0.143, Train_accy 95.87, Test_accy 88.97: 100%|██████████| 20/20 [10:25<00:00, 31.94s/it]
Task 0, Epoch 20/20 => Loss 0.143, Train_accy 95.87, Test_accy 88.97: 100%|██████████| 20/20 [10:25<00:00, 31.28s/it]
2024-09-08 00:34:05,582 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.143, Train_accy 95.87, Test_accy 88.97
2024-09-08 00:34:09,842 [trainer.py] => No NME accuracy.
2024-09-08 00:34:09,843 [trainer.py] => CNN: {'total': 88.97, '00-19': 88.97, 'old': 0, 'new': 88.97}
2024-09-08 00:34:09,843 [trainer.py] => CNN top1 curve: [88.97]
2024-09-08 00:34:09,843 [trainer.py] => CNN top5 curve: [97.53]

Average Accuracy (CNN): 88.97
2024-09-08 00:34:09,843 [trainer.py] => Average Accuracy (CNN): 88.97 

2024-09-08 00:34:09,845 [trainer.py] => All params: 89792456
2024-09-08 00:34:09,846 [trainer.py] => Trainable params: 89792456
2024-09-08 00:34:10,165 [coda_prompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.454, Train_accy 60.65:   0%|          | 0/20 [00:27<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.454, Train_accy 60.65:   5%|▌         | 1/20 [00:27<08:48, 27.84s/it]
Task 1, Epoch 2/20 => Loss 0.567, Train_accy 83.73:   5%|▌         | 1/20 [00:55<08:48, 27.84s/it]
Task 1, Epoch 2/20 => Loss 0.567, Train_accy 83.73:  10%|█         | 2/20 [00:55<08:22, 27.89s/it]
Task 1, Epoch 3/20 => Loss 0.416, Train_accy 87.26:  10%|█         | 2/20 [01:23<08:22, 27.89s/it]
Task 1, Epoch 3/20 => Loss 0.416, Train_accy 87.26:  15%|█▌        | 3/20 [01:23<07:55, 27.99s/it]
Task 1, Epoch 4/20 => Loss 0.380, Train_accy 88.29:  15%|█▌        | 3/20 [01:51<07:55, 27.99s/it]
Task 1, Epoch 4/20 => Loss 0.380, Train_accy 88.29:  20%|██        | 4/20 [01:51<07:26, 27.92s/it]
Task 1, Epoch 5/20 => Loss 0.318, Train_accy 90.41, Test_accy 83.42:  20%|██        | 4/20 [02:27<07:26, 27.92s/it]
Task 1, Epoch 5/20 => Loss 0.318, Train_accy 90.41, Test_accy 83.42:  25%|██▌       | 5/20 [02:27<07:40, 30.67s/it]
Task 1, Epoch 6/20 => Loss 0.303, Train_accy 90.80:  25%|██▌       | 5/20 [02:55<07:40, 30.67s/it]                 
Task 1, Epoch 6/20 => Loss 0.303, Train_accy 90.80:  30%|███       | 6/20 [02:55<06:55, 29.70s/it]
Task 1, Epoch 7/20 => Loss 0.254, Train_accy 92.45:  30%|███       | 6/20 [03:22<06:55, 29.70s/it]
Task 1, Epoch 7/20 => Loss 0.254, Train_accy 92.45:  35%|███▌      | 7/20 [03:22<06:17, 29.07s/it]
Task 1, Epoch 8/20 => Loss 0.261, Train_accy 92.26:  35%|███▌      | 7/20 [03:50<06:17, 29.07s/it]
Task 1, Epoch 8/20 => Loss 0.261, Train_accy 92.26:  40%|████      | 8/20 [03:50<05:44, 28.67s/it]
Task 1, Epoch 9/20 => Loss 0.248, Train_accy 92.85:  40%|████      | 8/20 [04:18<05:44, 28.67s/it]
Task 1, Epoch 9/20 => Loss 0.248, Train_accy 92.85:  45%|████▌     | 9/20 [04:18<05:12, 28.41s/it]
Task 1, Epoch 10/20 => Loss 0.230, Train_accy 93.51, Test_accy 84.33:  45%|████▌     | 9/20 [04:54<05:12, 28.41s/it]
Task 1, Epoch 10/20 => Loss 0.230, Train_accy 93.51, Test_accy 84.33:  50%|█████     | 10/20 [04:54<05:06, 30.65s/it]
Task 1, Epoch 11/20 => Loss 0.194, Train_accy 94.22:  50%|█████     | 10/20 [05:22<05:06, 30.65s/it]                 
Task 1, Epoch 11/20 => Loss 0.194, Train_accy 94.22:  55%|█████▌    | 11/20 [05:22<04:28, 29.81s/it]
Task 1, Epoch 12/20 => Loss 0.213, Train_accy 93.36:  55%|█████▌    | 11/20 [05:49<04:28, 29.81s/it]
Task 1, Epoch 12/20 => Loss 0.213, Train_accy 93.36:  60%|██████    | 12/20 [05:49<03:53, 29.21s/it]
Task 1, Epoch 13/20 => Loss 0.179, Train_accy 94.85:  60%|██████    | 12/20 [06:17<03:53, 29.21s/it]
Task 1, Epoch 13/20 => Loss 0.179, Train_accy 94.85:  65%|██████▌   | 13/20 [06:17<03:21, 28.85s/it]
Task 1, Epoch 14/20 => Loss 0.199, Train_accy 94.34:  65%|██████▌   | 13/20 [06:45<03:21, 28.85s/it]
Task 1, Epoch 14/20 => Loss 0.199, Train_accy 94.34:  70%|███████   | 14/20 [06:45<02:51, 28.55s/it]
Task 1, Epoch 15/20 => Loss 0.184, Train_accy 94.54, Test_accy 85.24:  70%|███████   | 14/20 [07:21<02:51, 28.55s/it]
Task 1, Epoch 15/20 => Loss 0.184, Train_accy 94.54, Test_accy 85.24:  75%|███████▌  | 15/20 [07:21<02:33, 30.68s/it]
Task 1, Epoch 16/20 => Loss 0.200, Train_accy 94.46:  75%|███████▌  | 15/20 [07:49<02:33, 30.68s/it]                 
Task 1, Epoch 16/20 => Loss 0.200, Train_accy 94.46:  80%|████████  | 16/20 [07:49<01:59, 29.87s/it]
Task 1, Epoch 17/20 => Loss 0.156, Train_accy 95.68:  80%|████████  | 16/20 [08:17<01:59, 29.87s/it]
Task 1, Epoch 17/20 => Loss 0.156, Train_accy 95.68:  85%|████████▌ | 17/20 [08:17<01:27, 29.29s/it]
Task 1, Epoch 18/20 => Loss 0.171, Train_accy 94.97:  85%|████████▌ | 17/20 [08:45<01:27, 29.29s/it]
Task 1, Epoch 18/20 => Loss 0.171, Train_accy 94.97:  90%|█████████ | 18/20 [08:45<00:57, 28.87s/it]
Task 1, Epoch 19/20 => Loss 0.171, Train_accy 95.20:  90%|█████████ | 18/20 [09:13<00:57, 28.87s/it]
Task 1, Epoch 19/20 => Loss 0.171, Train_accy 95.20:  95%|█████████▌| 19/20 [09:13<00:28, 28.56s/it]
Task 1, Epoch 20/20 => Loss 0.151, Train_accy 95.79, Test_accy 85.16:  95%|█████████▌| 19/20 [09:48<00:28, 28.56s/it]
Task 1, Epoch 20/20 => Loss 0.151, Train_accy 95.79, Test_accy 85.16: 100%|██████████| 20/20 [09:48<00:00, 30.68s/it]
Task 1, Epoch 20/20 => Loss 0.151, Train_accy 95.79, Test_accy 85.16: 100%|██████████| 20/20 [09:48<00:00, 29.43s/it]
2024-09-08 00:43:58,838 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.151, Train_accy 95.79, Test_accy 85.16
2024-09-08 00:44:06,594 [trainer.py] => No NME accuracy.
2024-09-08 00:44:06,595 [trainer.py] => CNN: {'total': 85.16, '00-19': 85.78, '20-39': 84.49, 'old': 85.78, 'new': 84.49}
2024-09-08 00:44:06,595 [trainer.py] => CNN top1 curve: [88.97, 85.16]
2024-09-08 00:44:06,595 [trainer.py] => CNN top5 curve: [97.53, 96.21]

Average Accuracy (CNN): 87.06
2024-09-08 00:44:06,595 [trainer.py] => Average Accuracy (CNN): 87.06 

2024-09-08 00:44:06,597 [trainer.py] => All params: 89792456
2024-09-08 00:44:06,598 [trainer.py] => Trainable params: 89792456
2024-09-08 00:44:07,129 [coda_prompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.663, Train_accy 55.12:   0%|          | 0/20 [00:25<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.663, Train_accy 55.12:   5%|▌         | 1/20 [00:25<08:01, 25.33s/it]
Task 2, Epoch 2/20 => Loss 0.597, Train_accy 82.90:   5%|▌         | 1/20 [00:50<08:01, 25.33s/it]
Task 2, Epoch 2/20 => Loss 0.597, Train_accy 82.90:  10%|█         | 2/20 [00:50<07:35, 25.31s/it]
Task 2, Epoch 3/20 => Loss 0.446, Train_accy 87.02:  10%|█         | 2/20 [01:15<07:35, 25.31s/it]
Task 2, Epoch 3/20 => Loss 0.446, Train_accy 87.02:  15%|█▌        | 3/20 [01:15<07:10, 25.32s/it]
Task 2, Epoch 4/20 => Loss 0.362, Train_accy 89.37:  15%|█▌        | 3/20 [01:41<07:10, 25.32s/it]
Task 2, Epoch 4/20 => Loss 0.362, Train_accy 89.37:  20%|██        | 4/20 [01:41<06:44, 25.31s/it]
Task 2, Epoch 5/20 => Loss 0.361, Train_accy 89.32, Test_accy 80.07:  20%|██        | 4/20 [02:17<06:44, 25.31s/it]
Task 2, Epoch 5/20 => Loss 0.361, Train_accy 89.32, Test_accy 80.07:  25%|██▌       | 5/20 [02:17<07:18, 29.25s/it]
Task 2, Epoch 6/20 => Loss 0.313, Train_accy 90.76:  25%|██▌       | 5/20 [02:42<07:18, 29.25s/it]                 
Task 2, Epoch 6/20 => Loss 0.313, Train_accy 90.76:  30%|███       | 6/20 [02:42<06:30, 27.89s/it]
Task 2, Epoch 7/20 => Loss 0.281, Train_accy 92.06:  30%|███       | 6/20 [03:07<06:30, 27.89s/it]
Task 2, Epoch 7/20 => Loss 0.281, Train_accy 92.06:  35%|███▌      | 7/20 [03:07<05:51, 27.02s/it]
Task 2, Epoch 8/20 => Loss 0.265, Train_accy 92.80:  35%|███▌      | 7/20 [03:33<05:51, 27.02s/it]
Task 2, Epoch 8/20 => Loss 0.265, Train_accy 92.80:  40%|████      | 8/20 [03:33<05:17, 26.48s/it]
Task 2, Epoch 9/20 => Loss 0.237, Train_accy 93.23:  40%|████      | 8/20 [03:58<05:17, 26.48s/it]
Task 2, Epoch 9/20 => Loss 0.237, Train_accy 93.23:  45%|████▌     | 9/20 [03:58<04:47, 26.11s/it]
Task 2, Epoch 10/20 => Loss 0.228, Train_accy 94.05, Test_accy 81.47:  45%|████▌     | 9/20 [04:34<04:47, 26.11s/it]
Task 2, Epoch 10/20 => Loss 0.228, Train_accy 94.05, Test_accy 81.47:  50%|█████     | 10/20 [04:34<04:52, 29.29s/it]
Task 2, Epoch 11/20 => Loss 0.229, Train_accy 93.36:  50%|█████     | 10/20 [05:00<04:52, 29.29s/it]                 
Task 2, Epoch 11/20 => Loss 0.229, Train_accy 93.36:  55%|█████▌    | 11/20 [05:00<04:12, 28.07s/it]
Task 2, Epoch 12/20 => Loss 0.200, Train_accy 94.36:  55%|█████▌    | 11/20 [05:25<04:12, 28.07s/it]
Task 2, Epoch 12/20 => Loss 0.200, Train_accy 94.36:  60%|██████    | 12/20 [05:25<03:38, 27.26s/it]
Task 2, Epoch 13/20 => Loss 0.196, Train_accy 94.44:  60%|██████    | 12/20 [05:51<03:38, 27.26s/it]
Task 2, Epoch 13/20 => Loss 0.196, Train_accy 94.44:  65%|██████▌   | 13/20 [05:51<03:06, 26.70s/it]
Task 2, Epoch 14/20 => Loss 0.207, Train_accy 93.97:  65%|██████▌   | 13/20 [06:16<03:06, 26.70s/it]
Task 2, Epoch 14/20 => Loss 0.207, Train_accy 93.97:  70%|███████   | 14/20 [06:16<02:37, 26.30s/it]
Task 2, Epoch 15/20 => Loss 0.192, Train_accy 94.57, Test_accy 81.94:  70%|███████   | 14/20 [06:52<02:37, 26.30s/it]
Task 2, Epoch 15/20 => Loss 0.192, Train_accy 94.57, Test_accy 81.94:  75%|███████▌  | 15/20 [06:52<02:26, 29.38s/it]
Task 2, Epoch 16/20 => Loss 0.186, Train_accy 94.97:  75%|███████▌  | 15/20 [07:18<02:26, 29.38s/it]                 
Task 2, Epoch 16/20 => Loss 0.186, Train_accy 94.97:  80%|████████  | 16/20 [07:18<01:52, 28.15s/it]
Task 2, Epoch 17/20 => Loss 0.176, Train_accy 95.05:  80%|████████  | 16/20 [07:43<01:52, 28.15s/it]
Task 2, Epoch 17/20 => Loss 0.176, Train_accy 95.05:  85%|████████▌ | 17/20 [07:43<01:21, 27.29s/it]
Task 2, Epoch 18/20 => Loss 0.176, Train_accy 95.01:  85%|████████▌ | 17/20 [08:09<01:21, 27.29s/it]
Task 2, Epoch 18/20 => Loss 0.176, Train_accy 95.01:  90%|█████████ | 18/20 [08:09<00:53, 26.81s/it]
Task 2, Epoch 19/20 => Loss 0.161, Train_accy 95.53:  90%|█████████ | 18/20 [08:34<00:53, 26.81s/it]
Task 2, Epoch 19/20 => Loss 0.161, Train_accy 95.53:  95%|█████████▌| 19/20 [08:34<00:26, 26.36s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 95.66, Test_accy 81.84:  95%|█████████▌| 19/20 [09:10<00:26, 26.36s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 95.66, Test_accy 81.84: 100%|██████████| 20/20 [09:10<00:00, 29.36s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 95.66, Test_accy 81.84: 100%|██████████| 20/20 [09:10<00:00, 27.55s/it]
2024-09-08 00:53:18,076 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.158, Train_accy 95.66, Test_accy 81.84
2024-09-08 00:53:29,117 [trainer.py] => No NME accuracy.
2024-09-08 00:53:29,118 [trainer.py] => CNN: {'total': 81.84, '00-19': 85.78, '20-39': 83.7, '40-59': 75.41, 'old': 84.78, 'new': 75.41}
2024-09-08 00:53:29,118 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84]
2024-09-08 00:53:29,118 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65]

Average Accuracy (CNN): 85.32
2024-09-08 00:53:29,118 [trainer.py] => Average Accuracy (CNN): 85.32 

2024-09-08 00:53:29,120 [trainer.py] => All params: 89792456
2024-09-08 00:53:29,122 [trainer.py] => Trainable params: 89792456
2024-09-08 00:53:29,833 [coda_prompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.505, Train_accy 58.82:   0%|          | 0/20 [00:24<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.505, Train_accy 58.82:   5%|▌         | 1/20 [00:24<07:50, 24.78s/it]
Task 3, Epoch 2/20 => Loss 0.611, Train_accy 81.65:   5%|▌         | 1/20 [00:49<07:50, 24.78s/it]
Task 3, Epoch 2/20 => Loss 0.611, Train_accy 81.65:  10%|█         | 2/20 [00:49<07:26, 24.80s/it]
Task 3, Epoch 3/20 => Loss 0.488, Train_accy 86.17:  10%|█         | 2/20 [01:14<07:26, 24.80s/it]
Task 3, Epoch 3/20 => Loss 0.488, Train_accy 86.17:  15%|█▌        | 3/20 [01:14<07:00, 24.76s/it]
Task 3, Epoch 4/20 => Loss 0.393, Train_accy 87.85:  15%|█▌        | 3/20 [01:39<07:00, 24.76s/it]
Task 3, Epoch 4/20 => Loss 0.393, Train_accy 87.85:  20%|██        | 4/20 [01:39<06:36, 24.78s/it]
Task 3, Epoch 5/20 => Loss 0.351, Train_accy 89.45, Test_accy 78.90:  20%|██        | 4/20 [02:18<06:36, 24.78s/it]
Task 3, Epoch 5/20 => Loss 0.351, Train_accy 89.45, Test_accy 78.90:  25%|██▌       | 5/20 [02:18<07:29, 29.94s/it]
Task 3, Epoch 6/20 => Loss 0.307, Train_accy 92.02:  25%|██▌       | 5/20 [02:42<07:29, 29.94s/it]                 
Task 3, Epoch 6/20 => Loss 0.307, Train_accy 92.02:  30%|███       | 6/20 [02:42<06:34, 28.17s/it]
Task 3, Epoch 7/20 => Loss 0.300, Train_accy 90.91:  30%|███       | 6/20 [03:07<06:34, 28.17s/it]
Task 3, Epoch 7/20 => Loss 0.300, Train_accy 90.91:  35%|███▌      | 7/20 [03:07<05:51, 27.07s/it]
Task 3, Epoch 8/20 => Loss 0.242, Train_accy 92.69:  35%|███▌      | 7/20 [03:32<05:51, 27.07s/it]
Task 3, Epoch 8/20 => Loss 0.242, Train_accy 92.69:  40%|████      | 8/20 [03:32<05:16, 26.38s/it]
Task 3, Epoch 9/20 => Loss 0.262, Train_accy 92.24:  40%|████      | 8/20 [03:57<05:16, 26.38s/it]
Task 3, Epoch 9/20 => Loss 0.262, Train_accy 92.24:  45%|████▌     | 9/20 [03:57<04:45, 25.91s/it]
Task 3, Epoch 10/20 => Loss 0.244, Train_accy 92.64, Test_accy 79.54:  45%|████▌     | 9/20 [04:36<04:45, 25.91s/it]
Task 3, Epoch 10/20 => Loss 0.244, Train_accy 92.64, Test_accy 79.54:  50%|█████     | 10/20 [04:36<04:59, 29.98s/it]
Task 3, Epoch 11/20 => Loss 0.244, Train_accy 92.60:  50%|█████     | 10/20 [05:01<04:59, 29.98s/it]                 
Task 3, Epoch 11/20 => Loss 0.244, Train_accy 92.60:  55%|█████▌    | 11/20 [05:01<04:15, 28.39s/it]
Task 3, Epoch 12/20 => Loss 0.225, Train_accy 93.44:  55%|█████▌    | 11/20 [05:26<04:15, 28.39s/it]
Task 3, Epoch 12/20 => Loss 0.225, Train_accy 93.44:  60%|██████    | 12/20 [05:26<03:38, 27.25s/it]
Task 3, Epoch 13/20 => Loss 0.213, Train_accy 93.97:  60%|██████    | 12/20 [05:50<03:38, 27.25s/it]
Task 3, Epoch 13/20 => Loss 0.213, Train_accy 93.97:  65%|██████▌   | 13/20 [05:50<03:05, 26.52s/it]
Task 3, Epoch 14/20 => Loss 0.224, Train_accy 93.84:  65%|██████▌   | 13/20 [06:15<03:05, 26.52s/it]
Task 3, Epoch 14/20 => Loss 0.224, Train_accy 93.84:  70%|███████   | 14/20 [06:15<02:36, 26.03s/it]
Task 3, Epoch 15/20 => Loss 0.222, Train_accy 92.86, Test_accy 79.66:  70%|███████   | 14/20 [06:55<02:36, 26.03s/it]
Task 3, Epoch 15/20 => Loss 0.222, Train_accy 92.86, Test_accy 79.66:  75%|███████▌  | 15/20 [06:55<02:30, 30.09s/it]
Task 3, Epoch 16/20 => Loss 0.190, Train_accy 94.68:  75%|███████▌  | 15/20 [07:19<02:30, 30.09s/it]                 
Task 3, Epoch 16/20 => Loss 0.190, Train_accy 94.68:  80%|████████  | 16/20 [07:19<01:53, 28.46s/it]
Task 3, Epoch 17/20 => Loss 0.191, Train_accy 94.19:  80%|████████  | 16/20 [07:44<01:53, 28.46s/it]
Task 3, Epoch 17/20 => Loss 0.191, Train_accy 94.19:  85%|████████▌ | 17/20 [07:44<01:22, 27.38s/it]
Task 3, Epoch 18/20 => Loss 0.196, Train_accy 94.37:  85%|████████▌ | 17/20 [08:09<01:22, 27.38s/it]
Task 3, Epoch 18/20 => Loss 0.196, Train_accy 94.37:  90%|█████████ | 18/20 [08:09<00:53, 26.61s/it]
Task 3, Epoch 19/20 => Loss 0.169, Train_accy 95.17:  90%|█████████ | 18/20 [08:34<00:53, 26.61s/it]
Task 3, Epoch 19/20 => Loss 0.169, Train_accy 95.17:  95%|█████████▌| 19/20 [08:34<00:26, 26.09s/it]
Task 3, Epoch 20/20 => Loss 0.169, Train_accy 95.04, Test_accy 79.78:  95%|█████████▌| 19/20 [09:13<00:26, 26.09s/it]
Task 3, Epoch 20/20 => Loss 0.169, Train_accy 95.04, Test_accy 79.78: 100%|██████████| 20/20 [09:13<00:00, 30.02s/it]
Task 3, Epoch 20/20 => Loss 0.169, Train_accy 95.04, Test_accy 79.78: 100%|██████████| 20/20 [09:13<00:00, 27.69s/it]
2024-09-08 01:02:43,554 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.169, Train_accy 95.04, Test_accy 79.78
2024-09-08 01:02:57,793 [trainer.py] => No NME accuracy.
2024-09-08 01:02:57,794 [trainer.py] => CNN: {'total': 79.78, '00-19': 85.63, '20-39': 82.91, '40-59': 74.26, '60-79': 75.13, 'old': 81.16, 'new': 75.13}
2024-09-08 01:02:57,794 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84, 79.78]
2024-09-08 01:02:57,794 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65, 93.07]

Average Accuracy (CNN): 83.94
2024-09-08 01:02:57,794 [trainer.py] => Average Accuracy (CNN): 83.94 

2024-09-08 01:02:57,796 [trainer.py] => All params: 89792456
2024-09-08 01:02:57,797 [trainer.py] => Trainable params: 89792456
2024-09-08 01:02:58,702 [coda_prompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.697, Train_accy 55.23:   0%|          | 0/20 [00:23<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.697, Train_accy 55.23:   5%|▌         | 1/20 [00:23<07:33, 23.86s/it]
Task 4, Epoch 2/20 => Loss 0.635, Train_accy 81.34:   5%|▌         | 1/20 [00:47<07:33, 23.86s/it]
Task 4, Epoch 2/20 => Loss 0.635, Train_accy 81.34:  10%|█         | 2/20 [00:47<07:08, 23.83s/it]
Task 4, Epoch 3/20 => Loss 0.455, Train_accy 86.39:  10%|█         | 2/20 [01:11<07:08, 23.83s/it]
Task 4, Epoch 3/20 => Loss 0.455, Train_accy 86.39:  15%|█▌        | 3/20 [01:11<06:44, 23.81s/it]
Task 4, Epoch 4/20 => Loss 0.429, Train_accy 87.55:  15%|█▌        | 3/20 [01:35<06:44, 23.81s/it]
Task 4, Epoch 4/20 => Loss 0.429, Train_accy 87.55:  20%|██        | 4/20 [01:35<06:20, 23.78s/it]
Task 4, Epoch 5/20 => Loss 0.329, Train_accy 90.51, Test_accy 76.92:  20%|██        | 4/20 [02:15<06:20, 23.78s/it]
Task 4, Epoch 5/20 => Loss 0.329, Train_accy 90.51, Test_accy 76.92:  25%|██▌       | 5/20 [02:15<07:27, 29.86s/it]
Task 4, Epoch 6/20 => Loss 0.317, Train_accy 90.83:  25%|██▌       | 5/20 [02:39<07:27, 29.86s/it]                 
Task 4, Epoch 6/20 => Loss 0.317, Train_accy 90.83:  30%|███       | 6/20 [02:39<06:29, 27.80s/it]
Task 4, Epoch 7/20 => Loss 0.304, Train_accy 90.88:  30%|███       | 6/20 [03:03<06:29, 27.80s/it]
Task 4, Epoch 7/20 => Loss 0.304, Train_accy 90.88:  35%|███▌      | 7/20 [03:03<05:44, 26.49s/it]
Task 4, Epoch 8/20 => Loss 0.264, Train_accy 92.41:  35%|███▌      | 7/20 [03:27<05:44, 26.49s/it]
Task 4, Epoch 8/20 => Loss 0.264, Train_accy 92.41:  40%|████      | 8/20 [03:27<05:07, 25.62s/it]
Task 4, Epoch 9/20 => Loss 0.258, Train_accy 92.78:  40%|████      | 8/20 [03:50<05:07, 25.62s/it]
Task 4, Epoch 9/20 => Loss 0.258, Train_accy 92.78:  45%|████▌     | 9/20 [03:50<04:35, 25.05s/it]
Task 4, Epoch 10/20 => Loss 0.235, Train_accy 93.43, Test_accy 77.35:  45%|████▌     | 9/20 [04:31<04:35, 25.05s/it]
Task 4, Epoch 10/20 => Loss 0.235, Train_accy 93.43, Test_accy 77.35:  50%|█████     | 10/20 [04:31<04:58, 29.87s/it]
Task 4, Epoch 11/20 => Loss 0.215, Train_accy 93.89:  50%|█████     | 10/20 [04:55<04:58, 29.87s/it]                 
Task 4, Epoch 11/20 => Loss 0.215, Train_accy 93.89:  55%|█████▌    | 11/20 [04:55<04:12, 28.02s/it]
Task 4, Epoch 12/20 => Loss 0.192, Train_accy 94.54:  55%|█████▌    | 11/20 [05:19<04:12, 28.02s/it]
Task 4, Epoch 12/20 => Loss 0.192, Train_accy 94.54:  60%|██████    | 12/20 [05:19<03:33, 26.75s/it]
Task 4, Epoch 13/20 => Loss 0.216, Train_accy 94.12:  60%|██████    | 12/20 [05:43<03:33, 26.75s/it]
Task 4, Epoch 13/20 => Loss 0.216, Train_accy 94.12:  65%|██████▌   | 13/20 [05:43<03:01, 25.87s/it]
Task 4, Epoch 14/20 => Loss 0.215, Train_accy 93.38:  65%|██████▌   | 13/20 [06:06<03:01, 25.87s/it]
Task 4, Epoch 14/20 => Loss 0.215, Train_accy 93.38:  70%|███████   | 14/20 [06:06<02:31, 25.25s/it]
Task 4, Epoch 15/20 => Loss 0.183, Train_accy 95.14, Test_accy 77.82:  70%|███████   | 14/20 [06:47<02:31, 25.25s/it]
Task 4, Epoch 15/20 => Loss 0.183, Train_accy 95.14, Test_accy 77.82:  75%|███████▌  | 15/20 [06:47<02:29, 29.94s/it]
Task 4, Epoch 16/20 => Loss 0.173, Train_accy 95.14:  75%|███████▌  | 15/20 [07:11<02:29, 29.94s/it]                 
Task 4, Epoch 16/20 => Loss 0.173, Train_accy 95.14:  80%|████████  | 16/20 [07:11<01:52, 28.10s/it]
Task 4, Epoch 17/20 => Loss 0.188, Train_accy 94.91:  80%|████████  | 16/20 [07:35<01:52, 28.10s/it]
Task 4, Epoch 17/20 => Loss 0.188, Train_accy 94.91:  85%|████████▌ | 17/20 [07:35<01:20, 26.82s/it]
Task 4, Epoch 18/20 => Loss 0.198, Train_accy 94.49:  85%|████████▌ | 17/20 [07:59<01:20, 26.82s/it]
Task 4, Epoch 18/20 => Loss 0.198, Train_accy 94.49:  90%|█████████ | 18/20 [07:59<00:51, 25.91s/it]
Task 4, Epoch 19/20 => Loss 0.180, Train_accy 94.63:  90%|█████████ | 18/20 [08:23<00:51, 25.91s/it]
Task 4, Epoch 19/20 => Loss 0.180, Train_accy 94.63:  95%|█████████▌| 19/20 [08:23<00:25, 25.27s/it]
Task 4, Epoch 20/20 => Loss 0.172, Train_accy 95.28, Test_accy 77.45:  95%|█████████▌| 19/20 [09:03<00:25, 25.27s/it]
Task 4, Epoch 20/20 => Loss 0.172, Train_accy 95.28, Test_accy 77.45: 100%|██████████| 20/20 [09:03<00:00, 29.89s/it]
Task 4, Epoch 20/20 => Loss 0.172, Train_accy 95.28, Test_accy 77.45: 100%|██████████| 20/20 [09:03<00:00, 27.18s/it]
2024-09-08 01:12:02,394 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.172, Train_accy 95.28, Test_accy 77.45
2024-09-08 01:12:19,266 [trainer.py] => No NME accuracy.
2024-09-08 01:12:19,267 [trainer.py] => CNN: {'total': 77.45, '00-19': 86.07, '20-39': 82.75, '40-59': 73.43, '60-79': 74.08, '80-99': 67.35, 'old': 79.42, 'new': 67.35}
2024-09-08 01:12:19,267 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84, 79.78, 77.45]
2024-09-08 01:12:19,267 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65, 93.07, 91.59]

Average Accuracy (CNN): 82.64
2024-09-08 01:12:19,267 [trainer.py] => Average Accuracy (CNN): 82.64 

2024-09-08 01:12:19,269 [trainer.py] => All params: 89792456
2024-09-08 01:12:19,270 [trainer.py] => Trainable params: 89792456
2024-09-08 01:12:20,376 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.386, Train_accy 62.50:   0%|          | 0/20 [00:28<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.386, Train_accy 62.50:   5%|▌         | 1/20 [00:28<09:10, 28.98s/it]
Task 5, Epoch 2/20 => Loss 0.541, Train_accy 83.71:   5%|▌         | 1/20 [00:57<09:10, 28.98s/it]
Task 5, Epoch 2/20 => Loss 0.541, Train_accy 83.71:  10%|█         | 2/20 [00:57<08:41, 28.97s/it]
Task 5, Epoch 3/20 => Loss 0.375, Train_accy 89.13:  10%|█         | 2/20 [01:26<08:41, 28.97s/it]
Task 5, Epoch 3/20 => Loss 0.375, Train_accy 89.13:  15%|█▌        | 3/20 [01:26<08:12, 28.96s/it]
Task 5, Epoch 4/20 => Loss 0.316, Train_accy 91.02:  15%|█▌        | 3/20 [01:55<08:12, 28.96s/it]
Task 5, Epoch 4/20 => Loss 0.316, Train_accy 91.02:  20%|██        | 4/20 [01:55<07:43, 28.96s/it]
Task 5, Epoch 5/20 => Loss 0.324, Train_accy 90.49, Test_accy 75.47:  20%|██        | 4/20 [02:45<07:43, 28.96s/it]
Task 5, Epoch 5/20 => Loss 0.324, Train_accy 90.49, Test_accy 75.47:  25%|██▌       | 5/20 [02:45<09:05, 36.37s/it]
Task 5, Epoch 6/20 => Loss 0.276, Train_accy 92.01:  25%|██▌       | 5/20 [03:14<09:05, 36.37s/it]                 
Task 5, Epoch 6/20 => Loss 0.276, Train_accy 92.01:  30%|███       | 6/20 [03:14<07:53, 33.85s/it]
Task 5, Epoch 7/20 => Loss 0.248, Train_accy 92.73:  30%|███       | 6/20 [03:43<07:53, 33.85s/it]
Task 5, Epoch 7/20 => Loss 0.248, Train_accy 92.73:  35%|███▌      | 7/20 [03:43<06:59, 32.27s/it]
Task 5, Epoch 8/20 => Loss 0.223, Train_accy 93.41:  35%|███▌      | 7/20 [04:12<06:59, 32.27s/it]
Task 5, Epoch 8/20 => Loss 0.223, Train_accy 93.41:  40%|████      | 8/20 [04:12<06:14, 31.17s/it]
Task 5, Epoch 9/20 => Loss 0.255, Train_accy 92.65:  40%|████      | 8/20 [04:41<06:14, 31.17s/it]
Task 5, Epoch 9/20 => Loss 0.255, Train_accy 92.65:  45%|████▌     | 9/20 [04:41<05:35, 30.50s/it]
Task 5, Epoch 10/20 => Loss 0.199, Train_accy 93.98, Test_accy 76.43:  45%|████▌     | 9/20 [05:30<05:35, 30.50s/it]
Task 5, Epoch 10/20 => Loss 0.199, Train_accy 93.98, Test_accy 76.43:  50%|█████     | 10/20 [05:30<06:04, 36.43s/it]
Task 5, Epoch 11/20 => Loss 0.219, Train_accy 93.98:  50%|█████     | 10/20 [05:59<06:04, 36.43s/it]                 
Task 5, Epoch 11/20 => Loss 0.219, Train_accy 93.98:  55%|█████▌    | 11/20 [05:59<05:07, 34.16s/it]
Task 5, Epoch 12/20 => Loss 0.193, Train_accy 94.62:  55%|█████▌    | 11/20 [06:29<05:07, 34.16s/it]
Task 5, Epoch 12/20 => Loss 0.193, Train_accy 94.62:  60%|██████    | 12/20 [06:29<04:21, 32.66s/it]
Task 5, Epoch 13/20 => Loss 0.204, Train_accy 94.09:  60%|██████    | 12/20 [06:58<04:21, 32.66s/it]
Task 5, Epoch 13/20 => Loss 0.204, Train_accy 94.09:  65%|██████▌   | 13/20 [06:58<03:40, 31.55s/it]
Task 5, Epoch 14/20 => Loss 0.183, Train_accy 94.81:  65%|██████▌   | 13/20 [07:27<03:40, 31.55s/it]
Task 5, Epoch 14/20 => Loss 0.183, Train_accy 94.81:  70%|███████   | 14/20 [07:27<03:04, 30.77s/it]
Task 5, Epoch 15/20 => Loss 0.168, Train_accy 94.85, Test_accy 76.10:  70%|███████   | 14/20 [08:16<03:04, 30.77s/it]
Task 5, Epoch 15/20 => Loss 0.168, Train_accy 94.85, Test_accy 76.10:  75%|███████▌  | 15/20 [08:16<03:02, 36.50s/it]
Task 5, Epoch 16/20 => Loss 0.187, Train_accy 94.66:  75%|███████▌  | 15/20 [08:45<03:02, 36.50s/it]                 
Task 5, Epoch 16/20 => Loss 0.187, Train_accy 94.66:  80%|████████  | 16/20 [08:45<02:16, 34.24s/it]
Task 5, Epoch 17/20 => Loss 0.160, Train_accy 95.34:  80%|████████  | 16/20 [09:14<02:16, 34.24s/it]
Task 5, Epoch 17/20 => Loss 0.160, Train_accy 95.34:  85%|████████▌ | 17/20 [09:14<01:38, 32.69s/it]
Task 5, Epoch 18/20 => Loss 0.167, Train_accy 95.08:  85%|████████▌ | 17/20 [09:43<01:38, 32.69s/it]
Task 5, Epoch 18/20 => Loss 0.167, Train_accy 95.08:  90%|█████████ | 18/20 [09:43<01:03, 31.58s/it]
Task 5, Epoch 19/20 => Loss 0.173, Train_accy 94.70:  90%|█████████ | 18/20 [10:13<01:03, 31.58s/it]
Task 5, Epoch 19/20 => Loss 0.173, Train_accy 94.70:  95%|█████████▌| 19/20 [10:13<00:30, 30.83s/it]
Task 5, Epoch 20/20 => Loss 0.167, Train_accy 95.23, Test_accy 76.21:  95%|█████████▌| 19/20 [11:02<00:30, 30.83s/it]
Task 5, Epoch 20/20 => Loss 0.167, Train_accy 95.23, Test_accy 76.21: 100%|██████████| 20/20 [11:02<00:00, 36.48s/it]
Task 5, Epoch 20/20 => Loss 0.167, Train_accy 95.23, Test_accy 76.21: 100%|██████████| 20/20 [11:02<00:00, 33.13s/it]
2024-09-08 01:23:23,053 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.167, Train_accy 95.23, Test_accy 76.21
2024-09-08 01:23:43,635 [trainer.py] => No NME accuracy.
2024-09-08 01:23:43,636 [trainer.py] => CNN: {'total': 76.21, '00-19': 85.05, '20-39': 81.17, '40-59': 72.28, '60-79': 72.33, '80-99': 66.53, '100-119': 76.36, 'old': 76.18, 'new': 76.36}
2024-09-08 01:23:43,636 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84, 79.78, 77.45, 76.21]
2024-09-08 01:23:43,636 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65, 93.07, 91.59, 91.17]

Average Accuracy (CNN): 81.57
2024-09-08 01:23:43,636 [trainer.py] => Average Accuracy (CNN): 81.57 

2024-09-08 01:23:43,638 [trainer.py] => All params: 89792456
2024-09-08 01:23:43,639 [trainer.py] => Trainable params: 89792456
2024-09-08 01:23:44,967 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.593, Train_accy 57.48:   0%|          | 0/20 [00:23<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.593, Train_accy 57.48:   5%|▌         | 1/20 [00:23<07:22, 23.27s/it]
Task 6, Epoch 2/20 => Loss 0.543, Train_accy 84.28:   5%|▌         | 1/20 [00:46<07:22, 23.27s/it]
Task 6, Epoch 2/20 => Loss 0.543, Train_accy 84.28:  10%|█         | 2/20 [00:46<06:59, 23.29s/it]
Task 6, Epoch 3/20 => Loss 0.430, Train_accy 87.93:  10%|█         | 2/20 [01:09<06:59, 23.29s/it]
Task 6, Epoch 3/20 => Loss 0.430, Train_accy 87.93:  15%|█▌        | 3/20 [01:09<06:35, 23.29s/it]
Task 6, Epoch 4/20 => Loss 0.317, Train_accy 91.00:  15%|█▌        | 3/20 [01:33<06:35, 23.29s/it]
Task 6, Epoch 4/20 => Loss 0.317, Train_accy 91.00:  20%|██        | 4/20 [01:33<06:13, 23.32s/it]
Task 6, Epoch 5/20 => Loss 0.297, Train_accy 91.38, Test_accy 74.75:  20%|██        | 4/20 [02:20<06:13, 23.32s/it]
Task 6, Epoch 5/20 => Loss 0.297, Train_accy 91.38, Test_accy 74.75:  25%|██▌       | 5/20 [02:20<07:58, 31.89s/it]
Task 6, Epoch 6/20 => Loss 0.271, Train_accy 91.95:  25%|██▌       | 5/20 [02:43<07:58, 31.89s/it]                 
Task 6, Epoch 6/20 => Loss 0.271, Train_accy 91.95:  30%|███       | 6/20 [02:43<06:45, 28.97s/it]
Task 6, Epoch 7/20 => Loss 0.228, Train_accy 93.13:  30%|███       | 6/20 [03:06<06:45, 28.97s/it]
Task 6, Epoch 7/20 => Loss 0.228, Train_accy 93.13:  35%|███▌      | 7/20 [03:06<05:52, 27.13s/it]
Task 6, Epoch 8/20 => Loss 0.207, Train_accy 94.27:  35%|███▌      | 7/20 [03:30<05:52, 27.13s/it]
Task 6, Epoch 8/20 => Loss 0.207, Train_accy 94.27:  40%|████      | 8/20 [03:30<05:10, 25.91s/it]
Task 6, Epoch 9/20 => Loss 0.216, Train_accy 93.99:  40%|████      | 8/20 [03:53<05:10, 25.91s/it]
Task 6, Epoch 9/20 => Loss 0.216, Train_accy 93.99:  45%|████▌     | 9/20 [03:53<04:36, 25.09s/it]
Task 6, Epoch 10/20 => Loss 0.200, Train_accy 93.56, Test_accy 75.34:  45%|████▌     | 9/20 [04:40<04:36, 25.09s/it]
Task 6, Epoch 10/20 => Loss 0.200, Train_accy 93.56, Test_accy 75.34:  50%|█████     | 10/20 [04:40<05:18, 31.86s/it]
Task 6, Epoch 11/20 => Loss 0.177, Train_accy 94.70:  50%|█████     | 10/20 [05:03<05:18, 31.86s/it]                 
Task 6, Epoch 11/20 => Loss 0.177, Train_accy 94.70:  55%|█████▌    | 11/20 [05:03<04:23, 29.25s/it]
Task 6, Epoch 12/20 => Loss 0.172, Train_accy 95.03:  55%|█████▌    | 11/20 [05:27<04:23, 29.25s/it]
Task 6, Epoch 12/20 => Loss 0.172, Train_accy 95.03:  60%|██████    | 12/20 [05:27<03:39, 27.43s/it]
Task 6, Epoch 13/20 => Loss 0.172, Train_accy 95.27:  60%|██████    | 12/20 [05:50<03:39, 27.43s/it]
Task 6, Epoch 13/20 => Loss 0.172, Train_accy 95.27:  65%|██████▌   | 13/20 [05:50<03:03, 26.22s/it]
Task 6, Epoch 14/20 => Loss 0.151, Train_accy 95.41:  65%|██████▌   | 13/20 [06:13<03:03, 26.22s/it]
Task 6, Epoch 14/20 => Loss 0.151, Train_accy 95.41:  70%|███████   | 14/20 [06:13<02:31, 25.33s/it]
Task 6, Epoch 15/20 => Loss 0.149, Train_accy 96.07, Test_accy 75.11:  70%|███████   | 14/20 [07:00<02:31, 25.33s/it]
Task 6, Epoch 15/20 => Loss 0.149, Train_accy 96.07, Test_accy 75.11:  75%|███████▌  | 15/20 [07:00<02:39, 31.85s/it]
Task 6, Epoch 16/20 => Loss 0.125, Train_accy 96.50:  75%|███████▌  | 15/20 [07:24<02:39, 31.85s/it]                 
Task 6, Epoch 16/20 => Loss 0.125, Train_accy 96.50:  80%|████████  | 16/20 [07:24<01:57, 29.28s/it]
Task 6, Epoch 17/20 => Loss 0.158, Train_accy 95.83:  80%|████████  | 16/20 [07:47<01:57, 29.28s/it]
Task 6, Epoch 17/20 => Loss 0.158, Train_accy 95.83:  85%|████████▌ | 17/20 [07:47<01:22, 27.52s/it]
Task 6, Epoch 18/20 => Loss 0.131, Train_accy 96.21:  85%|████████▌ | 17/20 [08:10<01:22, 27.52s/it]
Task 6, Epoch 18/20 => Loss 0.131, Train_accy 96.21:  90%|█████████ | 18/20 [08:10<00:52, 26.25s/it]
Task 6, Epoch 19/20 => Loss 0.140, Train_accy 96.07:  90%|█████████ | 18/20 [08:34<00:52, 26.25s/it]
Task 6, Epoch 19/20 => Loss 0.140, Train_accy 96.07:  95%|█████████▌| 19/20 [08:34<00:25, 25.36s/it]
Task 6, Epoch 20/20 => Loss 0.142, Train_accy 96.02, Test_accy 75.39:  95%|█████████▌| 19/20 [09:21<00:25, 25.36s/it]
Task 6, Epoch 20/20 => Loss 0.142, Train_accy 96.02, Test_accy 75.39: 100%|██████████| 20/20 [09:21<00:00, 31.85s/it]
Task 6, Epoch 20/20 => Loss 0.142, Train_accy 96.02, Test_accy 75.39: 100%|██████████| 20/20 [09:21<00:00, 28.06s/it]
2024-09-08 01:33:06,125 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.142, Train_accy 96.02, Test_accy 75.39
2024-09-08 01:33:29,884 [trainer.py] => No NME accuracy.
2024-09-08 01:33:29,885 [trainer.py] => CNN: {'total': 75.39, '00-19': 84.76, '20-39': 81.65, '40-59': 70.79, '60-79': 72.5, '80-99': 65.71, '100-119': 75.61, '120-139': 72.93, 'old': 75.78, 'new': 72.93}
2024-09-08 01:33:29,885 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84, 79.78, 77.45, 76.21, 75.39]
2024-09-08 01:33:29,885 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65, 93.07, 91.59, 91.17, 90.06]

Average Accuracy (CNN): 80.69
2024-09-08 01:33:29,885 [trainer.py] => Average Accuracy (CNN): 80.69 

2024-09-08 01:33:29,886 [trainer.py] => All params: 89792456
2024-09-08 01:33:29,887 [trainer.py] => Trainable params: 89792456
2024-09-08 01:33:31,383 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.384, Train_accy 62.46:   0%|          | 0/20 [00:30<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.384, Train_accy 62.46:   5%|▌         | 1/20 [00:30<09:41, 30.58s/it]
Task 7, Epoch 2/20 => Loss 0.484, Train_accy 85.63:   5%|▌         | 1/20 [01:01<09:41, 30.58s/it]
Task 7, Epoch 2/20 => Loss 0.484, Train_accy 85.63:  10%|█         | 2/20 [01:01<09:10, 30.58s/it]
Task 7, Epoch 3/20 => Loss 0.367, Train_accy 89.40:  10%|█         | 2/20 [01:31<09:10, 30.58s/it]
Task 7, Epoch 3/20 => Loss 0.367, Train_accy 89.40:  15%|█▌        | 3/20 [01:31<08:39, 30.57s/it]
Task 7, Epoch 4/20 => Loss 0.322, Train_accy 90.52:  15%|█▌        | 3/20 [02:02<08:39, 30.57s/it]
Task 7, Epoch 4/20 => Loss 0.322, Train_accy 90.52:  20%|██        | 4/20 [02:02<08:09, 30.60s/it]
Task 7, Epoch 5/20 => Loss 0.306, Train_accy 90.80, Test_accy 73.48:  20%|██        | 4/20 [03:00<08:09, 30.60s/it]
Task 7, Epoch 5/20 => Loss 0.306, Train_accy 90.80, Test_accy 73.48:  25%|██▌       | 5/20 [03:00<10:08, 40.59s/it]
Task 7, Epoch 6/20 => Loss 0.287, Train_accy 91.77:  25%|██▌       | 5/20 [03:31<10:08, 40.59s/it]                 
Task 7, Epoch 6/20 => Loss 0.287, Train_accy 91.77:  30%|███       | 6/20 [03:31<08:40, 37.18s/it]
Task 7, Epoch 7/20 => Loss 0.211, Train_accy 93.75:  30%|███       | 6/20 [04:01<08:40, 37.18s/it]
Task 7, Epoch 7/20 => Loss 0.211, Train_accy 93.75:  35%|███▌      | 7/20 [04:01<07:35, 35.03s/it]
Task 7, Epoch 8/20 => Loss 0.223, Train_accy 93.93:  35%|███▌      | 7/20 [04:32<07:35, 35.03s/it]
Task 7, Epoch 8/20 => Loss 0.223, Train_accy 93.93:  40%|████      | 8/20 [04:32<06:43, 33.62s/it]
Task 7, Epoch 9/20 => Loss 0.232, Train_accy 93.46:  40%|████      | 8/20 [05:02<06:43, 33.62s/it]
Task 7, Epoch 9/20 => Loss 0.232, Train_accy 93.46:  45%|████▌     | 9/20 [05:02<05:59, 32.66s/it]
Task 7, Epoch 10/20 => Loss 0.185, Train_accy 94.11, Test_accy 74.49:  45%|████▌     | 9/20 [06:01<05:59, 32.66s/it]
Task 7, Epoch 10/20 => Loss 0.185, Train_accy 94.11, Test_accy 74.49:  50%|█████     | 10/20 [06:01<06:45, 40.54s/it]
Task 7, Epoch 11/20 => Loss 0.205, Train_accy 94.22:  50%|█████     | 10/20 [06:31<06:45, 40.54s/it]                 
Task 7, Epoch 11/20 => Loss 0.205, Train_accy 94.22:  55%|█████▌    | 11/20 [06:31<05:37, 37.49s/it]
Task 7, Epoch 12/20 => Loss 0.194, Train_accy 94.40:  55%|█████▌    | 11/20 [07:02<05:37, 37.49s/it]
Task 7, Epoch 12/20 => Loss 0.194, Train_accy 94.40:  60%|██████    | 12/20 [07:02<04:43, 35.38s/it]
Task 7, Epoch 13/20 => Loss 0.202, Train_accy 94.68:  60%|██████    | 12/20 [07:32<04:43, 35.38s/it]
Task 7, Epoch 13/20 => Loss 0.202, Train_accy 94.68:  65%|██████▌   | 13/20 [07:32<03:57, 33.91s/it]
Task 7, Epoch 14/20 => Loss 0.185, Train_accy 94.76:  65%|██████▌   | 13/20 [08:03<03:57, 33.91s/it]
Task 7, Epoch 14/20 => Loss 0.185, Train_accy 94.76:  70%|███████   | 14/20 [08:03<03:17, 32.90s/it]
Task 7, Epoch 15/20 => Loss 0.191, Train_accy 94.40, Test_accy 74.69:  70%|███████   | 14/20 [09:01<03:17, 32.90s/it]
Task 7, Epoch 15/20 => Loss 0.191, Train_accy 94.40, Test_accy 74.69:  75%|███████▌  | 15/20 [09:01<03:22, 40.53s/it]
Task 7, Epoch 16/20 => Loss 0.200, Train_accy 94.61:  75%|███████▌  | 15/20 [09:31<03:22, 40.53s/it]                 
Task 7, Epoch 16/20 => Loss 0.200, Train_accy 94.61:  80%|████████  | 16/20 [09:31<02:29, 37.47s/it]
Task 7, Epoch 17/20 => Loss 0.194, Train_accy 94.76:  80%|████████  | 16/20 [10:02<02:29, 37.47s/it]
Task 7, Epoch 17/20 => Loss 0.194, Train_accy 94.76:  85%|████████▌ | 17/20 [10:02<01:46, 35.40s/it]
Task 7, Epoch 18/20 => Loss 0.162, Train_accy 95.58:  85%|████████▌ | 17/20 [10:33<01:46, 35.40s/it]
Task 7, Epoch 18/20 => Loss 0.162, Train_accy 95.58:  90%|█████████ | 18/20 [10:33<01:07, 33.96s/it]
Task 7, Epoch 19/20 => Loss 0.140, Train_accy 96.12:  90%|█████████ | 18/20 [11:03<01:07, 33.96s/it]
Task 7, Epoch 19/20 => Loss 0.140, Train_accy 96.12:  95%|█████████▌| 19/20 [11:03<00:32, 32.94s/it]
Task 7, Epoch 20/20 => Loss 0.153, Train_accy 95.69, Test_accy 74.51:  95%|█████████▌| 19/20 [12:02<00:32, 32.94s/it]
Task 7, Epoch 20/20 => Loss 0.153, Train_accy 95.69, Test_accy 74.51: 100%|██████████| 20/20 [12:02<00:00, 40.57s/it]
Task 7, Epoch 20/20 => Loss 0.153, Train_accy 95.69, Test_accy 74.51: 100%|██████████| 20/20 [12:02<00:00, 36.10s/it]
2024-09-08 01:45:33,487 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.153, Train_accy 95.69, Test_accy 74.51
2024-09-08 01:46:01,178 [trainer.py] => No NME accuracy.
2024-09-08 01:46:01,178 [trainer.py] => CNN: {'total': 74.51, '00-19': 83.6, '20-39': 80.38, '40-59': 70.3, '60-79': 73.03, '80-99': 65.09, '100-119': 73.48, '120-139': 71.53, '140-159': 75.03, 'old': 74.42, 'new': 75.03}
2024-09-08 01:46:01,178 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84, 79.78, 77.45, 76.21, 75.39, 74.51]
2024-09-08 01:46:01,178 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65, 93.07, 91.59, 91.17, 90.06, 89.74]

Average Accuracy (CNN): 79.91
2024-09-08 01:46:01,178 [trainer.py] => Average Accuracy (CNN): 79.91 

2024-09-08 01:46:01,179 [trainer.py] => All params: 89792456
2024-09-08 01:46:01,180 [trainer.py] => Trainable params: 89792456
2024-09-08 01:46:02,883 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.673, Train_accy 54.95:   0%|          | 0/20 [00:21<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.673, Train_accy 54.95:   5%|▌         | 1/20 [00:21<06:43, 21.24s/it]
Task 8, Epoch 2/20 => Loss 0.625, Train_accy 81.56:   5%|▌         | 1/20 [00:42<06:43, 21.24s/it]
Task 8, Epoch 2/20 => Loss 0.625, Train_accy 81.56:  10%|█         | 2/20 [00:42<06:22, 21.26s/it]
Task 8, Epoch 3/20 => Loss 0.470, Train_accy 86.72:  10%|█         | 2/20 [01:03<06:22, 21.26s/it]
Task 8, Epoch 3/20 => Loss 0.470, Train_accy 86.72:  15%|█▌        | 3/20 [01:03<06:01, 21.25s/it]
Task 8, Epoch 4/20 => Loss 0.403, Train_accy 89.01:  15%|█▌        | 3/20 [01:24<06:01, 21.25s/it]
Task 8, Epoch 4/20 => Loss 0.403, Train_accy 89.01:  20%|██        | 4/20 [01:24<05:39, 21.24s/it]
Task 8, Epoch 5/20 => Loss 0.350, Train_accy 90.62, Test_accy 73.95:  20%|██        | 4/20 [02:16<05:39, 21.24s/it]
Task 8, Epoch 5/20 => Loss 0.350, Train_accy 90.62, Test_accy 73.95:  25%|██▌       | 5/20 [02:16<08:02, 32.15s/it]
Task 8, Epoch 6/20 => Loss 0.340, Train_accy 90.31:  25%|██▌       | 5/20 [02:37<08:02, 32.15s/it]                 
Task 8, Epoch 6/20 => Loss 0.340, Train_accy 90.31:  30%|███       | 6/20 [02:37<06:38, 28.46s/it]
Task 8, Epoch 7/20 => Loss 0.281, Train_accy 92.14:  30%|███       | 6/20 [02:59<06:38, 28.46s/it]
Task 8, Epoch 7/20 => Loss 0.281, Train_accy 92.14:  35%|███▌      | 7/20 [02:59<05:40, 26.17s/it]
Task 8, Epoch 8/20 => Loss 0.259, Train_accy 93.12:  35%|███▌      | 7/20 [03:20<05:40, 26.17s/it]
Task 8, Epoch 8/20 => Loss 0.259, Train_accy 93.12:  40%|████      | 8/20 [03:20<04:55, 24.60s/it]
Task 8, Epoch 9/20 => Loss 0.249, Train_accy 93.23:  40%|████      | 8/20 [03:41<04:55, 24.60s/it]
Task 8, Epoch 9/20 => Loss 0.249, Train_accy 93.23:  45%|████▌     | 9/20 [03:41<04:19, 23.55s/it]
Task 8, Epoch 10/20 => Loss 0.262, Train_accy 92.60, Test_accy 74.08:  45%|████▌     | 9/20 [04:33<04:19, 23.55s/it]
Task 8, Epoch 10/20 => Loss 0.262, Train_accy 92.60, Test_accy 74.08:  50%|█████     | 10/20 [04:33<05:21, 32.19s/it]
Task 8, Epoch 11/20 => Loss 0.264, Train_accy 92.97:  50%|█████     | 10/20 [04:54<05:21, 32.19s/it]                 
Task 8, Epoch 11/20 => Loss 0.264, Train_accy 92.97:  55%|█████▌    | 11/20 [04:54<04:19, 28.85s/it]
Task 8, Epoch 12/20 => Loss 0.232, Train_accy 93.91:  55%|█████▌    | 11/20 [05:15<04:19, 28.85s/it]
Task 8, Epoch 12/20 => Loss 0.232, Train_accy 93.91:  60%|██████    | 12/20 [05:15<03:31, 26.50s/it]
Task 8, Epoch 13/20 => Loss 0.236, Train_accy 93.12:  60%|██████    | 12/20 [05:36<03:31, 26.50s/it]
Task 8, Epoch 13/20 => Loss 0.236, Train_accy 93.12:  65%|██████▌   | 13/20 [05:36<02:54, 24.91s/it]
Task 8, Epoch 14/20 => Loss 0.230, Train_accy 93.80:  65%|██████▌   | 13/20 [05:58<02:54, 24.91s/it]
Task 8, Epoch 14/20 => Loss 0.230, Train_accy 93.80:  70%|███████   | 14/20 [05:58<02:22, 23.79s/it]
Task 8, Epoch 15/20 => Loss 0.208, Train_accy 94.38, Test_accy 74.19:  70%|███████   | 14/20 [06:49<02:22, 23.79s/it]
Task 8, Epoch 15/20 => Loss 0.208, Train_accy 94.38, Test_accy 74.19:  75%|███████▌  | 15/20 [06:49<02:40, 32.15s/it]
Task 8, Epoch 16/20 => Loss 0.200, Train_accy 94.43:  75%|███████▌  | 15/20 [07:10<02:40, 32.15s/it]                 
Task 8, Epoch 16/20 => Loss 0.200, Train_accy 94.43:  80%|████████  | 16/20 [07:10<01:55, 28.85s/it]
Task 8, Epoch 17/20 => Loss 0.201, Train_accy 94.53:  80%|████████  | 16/20 [07:32<01:55, 28.85s/it]
Task 8, Epoch 17/20 => Loss 0.201, Train_accy 94.53:  85%|████████▌ | 17/20 [07:32<01:19, 26.57s/it]
Task 8, Epoch 18/20 => Loss 0.182, Train_accy 94.69:  85%|████████▌ | 17/20 [07:53<01:19, 26.57s/it]
Task 8, Epoch 18/20 => Loss 0.182, Train_accy 94.69:  90%|█████████ | 18/20 [07:53<00:50, 25.03s/it]
Task 8, Epoch 19/20 => Loss 0.183, Train_accy 95.05:  90%|█████████ | 18/20 [08:14<00:50, 25.03s/it]
Task 8, Epoch 19/20 => Loss 0.183, Train_accy 95.05:  95%|█████████▌| 19/20 [08:14<00:23, 23.89s/it]
Task 8, Epoch 20/20 => Loss 0.194, Train_accy 94.58, Test_accy 74.05:  95%|█████████▌| 19/20 [09:06<00:23, 23.89s/it]
Task 8, Epoch 20/20 => Loss 0.194, Train_accy 94.58, Test_accy 74.05: 100%|██████████| 20/20 [09:06<00:00, 32.17s/it]
Task 8, Epoch 20/20 => Loss 0.194, Train_accy 94.58, Test_accy 74.05: 100%|██████████| 20/20 [09:06<00:00, 27.31s/it]
2024-09-08 01:55:09,124 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.194, Train_accy 94.58, Test_accy 74.05
2024-09-08 01:55:39,419 [trainer.py] => No NME accuracy.
2024-09-08 01:55:39,419 [trainer.py] => CNN: {'total': 74.05, '00-19': 83.16, '20-39': 80.38, '40-59': 69.8, '60-79': 71.63, '80-99': 64.48, '100-119': 73.79, '120-139': 72.06, '140-159': 75.31, '160-179': 71.34, 'old': 74.31, 'new': 71.34}
2024-09-08 01:55:39,420 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84, 79.78, 77.45, 76.21, 75.39, 74.51, 74.05]
2024-09-08 01:55:39,420 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65, 93.07, 91.59, 91.17, 90.06, 89.74, 89.25]

Average Accuracy (CNN): 79.26
2024-09-08 01:55:39,420 [trainer.py] => Average Accuracy (CNN): 79.26 

2024-09-08 01:55:39,421 [trainer.py] => All params: 89792456
2024-09-08 01:55:39,422 [trainer.py] => Trainable params: 89792456
2024-09-08 01:55:41,265 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.345, Train_accy 62.50:   0%|          | 0/20 [00:24<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.345, Train_accy 62.50:   5%|▌         | 1/20 [00:24<07:51, 24.82s/it]
Task 9, Epoch 2/20 => Loss 0.497, Train_accy 84.80:   5%|▌         | 1/20 [00:49<07:51, 24.82s/it]
Task 9, Epoch 2/20 => Loss 0.497, Train_accy 84.80:  10%|█         | 2/20 [00:49<07:27, 24.84s/it]
Task 9, Epoch 3/20 => Loss 0.408, Train_accy 87.63:  10%|█         | 2/20 [01:14<07:27, 24.84s/it]
Task 9, Epoch 3/20 => Loss 0.408, Train_accy 87.63:  15%|█▌        | 3/20 [01:14<07:02, 24.86s/it]
Task 9, Epoch 4/20 => Loss 0.326, Train_accy 90.78:  15%|█▌        | 3/20 [01:39<07:02, 24.86s/it]
Task 9, Epoch 4/20 => Loss 0.326, Train_accy 90.78:  20%|██        | 4/20 [01:39<06:37, 24.87s/it]
Task 9, Epoch 5/20 => Loss 0.295, Train_accy 91.58, Test_accy 72.28:  20%|██        | 4/20 [02:37<06:37, 24.87s/it]
Task 9, Epoch 5/20 => Loss 0.295, Train_accy 91.58, Test_accy 72.28:  25%|██▌       | 5/20 [02:37<09:13, 36.93s/it]
Task 9, Epoch 6/20 => Loss 0.258, Train_accy 92.55:  25%|██▌       | 5/20 [03:02<09:13, 36.93s/it]                 
Task 9, Epoch 6/20 => Loss 0.258, Train_accy 92.55:  30%|███       | 6/20 [03:02<07:39, 32.82s/it]
Task 9, Epoch 7/20 => Loss 0.244, Train_accy 93.13:  30%|███       | 6/20 [03:27<07:39, 32.82s/it]
Task 9, Epoch 7/20 => Loss 0.244, Train_accy 93.13:  35%|███▌      | 7/20 [03:27<06:33, 30.25s/it]
Task 9, Epoch 8/20 => Loss 0.218, Train_accy 93.93:  35%|███▌      | 7/20 [03:52<06:33, 30.25s/it]
Task 9, Epoch 8/20 => Loss 0.218, Train_accy 93.93:  40%|████      | 8/20 [03:52<05:42, 28.57s/it]
Task 9, Epoch 9/20 => Loss 0.238, Train_accy 93.17:  40%|████      | 8/20 [04:17<05:42, 28.57s/it]
Task 9, Epoch 9/20 => Loss 0.238, Train_accy 93.17:  45%|████▌     | 9/20 [04:17<05:01, 27.43s/it]
Task 9, Epoch 10/20 => Loss 0.208, Train_accy 94.06, Test_accy 72.85:  45%|████▌     | 9/20 [05:16<05:01, 27.43s/it]
Task 9, Epoch 10/20 => Loss 0.208, Train_accy 94.06, Test_accy 72.85:  50%|█████     | 10/20 [05:16<06:10, 37.06s/it]
Task 9, Epoch 11/20 => Loss 0.169, Train_accy 95.08:  50%|█████     | 10/20 [05:40<06:10, 37.06s/it]                 
Task 9, Epoch 11/20 => Loss 0.169, Train_accy 95.08:  55%|█████▌    | 11/20 [05:40<04:59, 33.33s/it]
Task 9, Epoch 12/20 => Loss 0.192, Train_accy 94.77:  55%|█████▌    | 11/20 [06:05<04:59, 33.33s/it]
Task 9, Epoch 12/20 => Loss 0.192, Train_accy 94.77:  60%|██████    | 12/20 [06:05<04:06, 30.75s/it]
Task 9, Epoch 13/20 => Loss 0.176, Train_accy 94.81:  60%|██████    | 12/20 [06:30<04:06, 30.75s/it]
Task 9, Epoch 13/20 => Loss 0.176, Train_accy 94.81:  65%|██████▌   | 13/20 [06:30<03:22, 28.97s/it]
Task 9, Epoch 14/20 => Loss 0.150, Train_accy 95.70:  65%|██████▌   | 13/20 [06:55<03:22, 28.97s/it]
Task 9, Epoch 14/20 => Loss 0.150, Train_accy 95.70:  70%|███████   | 14/20 [06:55<02:46, 27.73s/it]
Task 9, Epoch 15/20 => Loss 0.167, Train_accy 95.12, Test_accy 73.03:  70%|███████   | 14/20 [07:53<02:46, 27.73s/it]
Task 9, Epoch 15/20 => Loss 0.167, Train_accy 95.12, Test_accy 73.03:  75%|███████▌  | 15/20 [07:53<03:04, 36.97s/it]
Task 9, Epoch 16/20 => Loss 0.177, Train_accy 95.26:  75%|███████▌  | 15/20 [08:18<03:04, 36.97s/it]                 
Task 9, Epoch 16/20 => Loss 0.177, Train_accy 95.26:  80%|████████  | 16/20 [08:18<02:13, 33.32s/it]
Task 9, Epoch 17/20 => Loss 0.144, Train_accy 95.66:  80%|████████  | 16/20 [08:43<02:13, 33.32s/it]
Task 9, Epoch 17/20 => Loss 0.144, Train_accy 95.66:  85%|████████▌ | 17/20 [08:43<01:32, 30.78s/it]
Task 9, Epoch 18/20 => Loss 0.154, Train_accy 95.52:  85%|████████▌ | 17/20 [09:08<01:32, 30.78s/it]
Task 9, Epoch 18/20 => Loss 0.154, Train_accy 95.52:  90%|█████████ | 18/20 [09:08<00:57, 28.99s/it]
Task 9, Epoch 19/20 => Loss 0.149, Train_accy 95.97:  90%|█████████ | 18/20 [09:33<00:57, 28.99s/it]
Task 9, Epoch 19/20 => Loss 0.149, Train_accy 95.97:  95%|█████████▌| 19/20 [09:33<00:27, 27.81s/it]
Task 9, Epoch 20/20 => Loss 0.139, Train_accy 95.83, Test_accy 72.97:  95%|█████████▌| 19/20 [10:31<00:27, 27.81s/it]
Task 9, Epoch 20/20 => Loss 0.139, Train_accy 95.83, Test_accy 72.97: 100%|██████████| 20/20 [10:31<00:00, 37.01s/it]
Task 9, Epoch 20/20 => Loss 0.139, Train_accy 95.83, Test_accy 72.97: 100%|██████████| 20/20 [10:31<00:00, 31.60s/it]
2024-09-08 02:06:13,267 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.139, Train_accy 95.83, Test_accy 72.97
2024-09-08 02:06:46,871 [trainer.py] => No NME accuracy.
2024-09-08 02:06:46,872 [trainer.py] => CNN: {'total': 72.97, '00-19': 83.02, '20-39': 79.59, '40-59': 68.98, '60-79': 70.4, '80-99': 64.07, '100-119': 73.79, '120-139': 71.53, '140-159': 74.62, '160-179': 70.29, '180-199': 68.57, 'old': 73.44, 'new': 68.57}
2024-09-08 02:06:46,872 [trainer.py] => CNN top1 curve: [88.97, 85.16, 81.84, 79.78, 77.45, 76.21, 75.39, 74.51, 74.05, 72.97]
2024-09-08 02:06:46,872 [trainer.py] => CNN top5 curve: [97.53, 96.21, 94.65, 93.07, 91.59, 91.17, 90.06, 89.74, 89.25, 88.42]

Average Accuracy (CNN): 78.63
2024-09-08 02:06:46,872 [trainer.py] => Average Accuracy (CNN): 78.63 

Accuracy Matrix (CNN):
[[88.97 85.78 85.78 85.63 86.07 85.05 84.76 83.6  83.16 83.02]
 [ 0.   84.49 83.7  82.91 82.75 81.17 81.65 80.38 80.38 79.59]
 [ 0.    0.   75.41 74.26 73.43 72.28 70.79 70.3  69.8  68.98]
 [ 0.    0.    0.   75.13 74.08 72.33 72.5  73.03 71.63 70.4 ]
 [ 0.    0.    0.    0.   67.35 66.53 65.71 65.09 64.48 64.07]
 [ 0.    0.    0.    0.    0.   76.36 75.61 73.48 73.79 73.79]
 [ 0.    0.    0.    0.    0.    0.   72.93 71.53 72.06 71.53]
 [ 0.    0.    0.    0.    0.    0.    0.   75.03 75.31 74.62]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   71.34 70.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   68.57]]
2024-09-08 02:06:46,874 [trainer.py] => Forgetting (CNN): 3.444444444444441
2024-09-08 02:06:49,738 [trainer.py] => config: ./exps/coda_prompt_inr_B0_Inc20.json
2024-09-08 02:06:49,739 [trainer.py] => prefix:  
2024-09-08 02:06:49,739 [trainer.py] => dataset: imagenetr
2024-09-08 02:06:49,739 [trainer.py] => memory_size: 0
2024-09-08 02:06:49,739 [trainer.py] => memory_per_class: 0
2024-09-08 02:06:49,739 [trainer.py] => fixed_memory: False
2024-09-08 02:06:49,739 [trainer.py] => shuffle: True
2024-09-08 02:06:49,739 [trainer.py] => init_cls: 10
2024-09-08 02:06:49,739 [trainer.py] => increment: 10
2024-09-08 02:06:49,739 [trainer.py] => model_name: coda_prompt
2024-09-08 02:06:49,739 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-08 02:06:49,739 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 02:06:49,739 [trainer.py] => seed: 1993
2024-09-08 02:06:49,739 [trainer.py] => tuned_epoch: 20
2024-09-08 02:06:49,739 [trainer.py] => init_lr: 0.001
2024-09-08 02:06:49,739 [trainer.py] => batch_size: 48
2024-09-08 02:06:49,739 [trainer.py] => weight_decay: 0
2024-09-08 02:06:49,739 [trainer.py] => min_lr: 1e-05
2024-09-08 02:06:49,739 [trainer.py] => optimizer: adam
2024-09-08 02:06:49,739 [trainer.py] => scheduler: cosine
2024-09-08 02:06:49,739 [trainer.py] => reinit_optimizer: True
2024-09-08 02:06:49,739 [trainer.py] => pretrained: True
2024-09-08 02:06:49,739 [trainer.py] => drop: 0.0
2024-09-08 02:06:49,739 [trainer.py] => drop_path: 0.0
2024-09-08 02:06:49,739 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-08 02:06:49,821 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-08 02:06:51,772 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-08 02:06:51,772 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-08 02:06:51,773 [trainer.py] => All params: 89792456
2024-09-08 02:06:51,773 [trainer.py] => Trainable params: 89792456
2024-09-08 02:06:51,773 [coda_prompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.422, Train_accy 54.09:   0%|          | 0/20 [00:14<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.422, Train_accy 54.09:   5%|▌         | 1/20 [00:14<04:31, 14.29s/it]
Task 0, Epoch 2/20 => Loss 0.591, Train_accy 81.25:   5%|▌         | 1/20 [00:28<04:31, 14.29s/it]
Task 0, Epoch 2/20 => Loss 0.591, Train_accy 81.25:  10%|█         | 2/20 [00:28<04:12, 14.03s/it]
Task 0, Epoch 3/20 => Loss 0.441, Train_accy 86.54:  10%|█         | 2/20 [00:42<04:12, 14.03s/it]
Task 0, Epoch 3/20 => Loss 0.441, Train_accy 86.54:  15%|█▌        | 3/20 [00:42<03:57, 13.97s/it]
Task 0, Epoch 4/20 => Loss 0.392, Train_accy 88.38:  15%|█▌        | 3/20 [00:55<03:57, 13.97s/it]
Task 0, Epoch 4/20 => Loss 0.392, Train_accy 88.38:  20%|██        | 4/20 [00:55<03:43, 13.94s/it]
Task 0, Epoch 5/20 => Loss 0.303, Train_accy 90.14, Test_accy 85.49:  20%|██        | 4/20 [01:12<03:43, 13.94s/it]
Task 0, Epoch 5/20 => Loss 0.303, Train_accy 90.14, Test_accy 85.49:  25%|██▌       | 5/20 [01:12<03:40, 14.72s/it]
Task 0, Epoch 6/20 => Loss 0.270, Train_accy 91.75:  25%|██▌       | 5/20 [01:25<03:40, 14.72s/it]                 
Task 0, Epoch 6/20 => Loss 0.270, Train_accy 91.75:  30%|███       | 6/20 [01:25<03:22, 14.45s/it]
Task 0, Epoch 7/20 => Loss 0.212, Train_accy 94.07:  30%|███       | 6/20 [01:39<03:22, 14.45s/it]
Task 0, Epoch 7/20 => Loss 0.212, Train_accy 94.07:  35%|███▌      | 7/20 [01:39<03:05, 14.26s/it]
Task 0, Epoch 8/20 => Loss 0.218, Train_accy 93.43:  35%|███▌      | 7/20 [01:53<03:05, 14.26s/it]
Task 0, Epoch 8/20 => Loss 0.218, Train_accy 93.43:  40%|████      | 8/20 [01:53<02:49, 14.13s/it]
Task 0, Epoch 9/20 => Loss 0.170, Train_accy 95.19:  40%|████      | 8/20 [02:07<02:49, 14.13s/it]
Task 0, Epoch 9/20 => Loss 0.170, Train_accy 95.19:  45%|████▌     | 9/20 [02:07<02:34, 14.05s/it]
Task 0, Epoch 10/20 => Loss 0.169, Train_accy 94.31, Test_accy 87.07:  45%|████▌     | 9/20 [02:23<02:34, 14.05s/it]
Task 0, Epoch 10/20 => Loss 0.169, Train_accy 94.31, Test_accy 87.07:  50%|█████     | 10/20 [02:23<02:26, 14.67s/it]
Task 0, Epoch 11/20 => Loss 0.159, Train_accy 94.95:  50%|█████     | 10/20 [02:37<02:26, 14.67s/it]                 
Task 0, Epoch 11/20 => Loss 0.159, Train_accy 94.95:  55%|█████▌    | 11/20 [02:37<02:09, 14.44s/it]
Task 0, Epoch 12/20 => Loss 0.157, Train_accy 95.03:  55%|█████▌    | 11/20 [02:51<02:09, 14.44s/it]
Task 0, Epoch 12/20 => Loss 0.157, Train_accy 95.03:  60%|██████    | 12/20 [02:51<01:54, 14.27s/it]
Task 0, Epoch 13/20 => Loss 0.160, Train_accy 95.03:  60%|██████    | 12/20 [03:05<01:54, 14.27s/it]
Task 0, Epoch 13/20 => Loss 0.160, Train_accy 95.03:  65%|██████▌   | 13/20 [03:05<01:39, 14.17s/it]
Task 0, Epoch 14/20 => Loss 0.166, Train_accy 95.03:  65%|██████▌   | 13/20 [03:19<01:39, 14.17s/it]
Task 0, Epoch 14/20 => Loss 0.166, Train_accy 95.03:  70%|███████   | 14/20 [03:19<01:24, 14.11s/it]
Task 0, Epoch 15/20 => Loss 0.146, Train_accy 96.07, Test_accy 88.33:  70%|███████   | 14/20 [03:35<01:24, 14.11s/it]
Task 0, Epoch 15/20 => Loss 0.146, Train_accy 96.07, Test_accy 88.33:  75%|███████▌  | 15/20 [03:35<01:13, 14.69s/it]
Task 0, Epoch 16/20 => Loss 0.149, Train_accy 96.07:  75%|███████▌  | 15/20 [03:49<01:13, 14.69s/it]                 
Task 0, Epoch 16/20 => Loss 0.149, Train_accy 96.07:  80%|████████  | 16/20 [03:49<00:57, 14.44s/it]
Task 0, Epoch 17/20 => Loss 0.141, Train_accy 95.75:  80%|████████  | 16/20 [04:03<00:57, 14.44s/it]
Task 0, Epoch 17/20 => Loss 0.141, Train_accy 95.75:  85%|████████▌ | 17/20 [04:03<00:42, 14.27s/it]
Task 0, Epoch 18/20 => Loss 0.124, Train_accy 96.23:  85%|████████▌ | 17/20 [04:16<00:42, 14.27s/it]
Task 0, Epoch 18/20 => Loss 0.124, Train_accy 96.23:  90%|█████████ | 18/20 [04:16<00:28, 14.16s/it]
Task 0, Epoch 19/20 => Loss 0.146, Train_accy 95.83:  90%|█████████ | 18/20 [04:30<00:28, 14.16s/it]
Task 0, Epoch 19/20 => Loss 0.146, Train_accy 95.83:  95%|█████████▌| 19/20 [04:30<00:14, 14.08s/it]
Task 0, Epoch 20/20 => Loss 0.104, Train_accy 97.04, Test_accy 88.96:  95%|█████████▌| 19/20 [04:47<00:14, 14.08s/it]
Task 0, Epoch 20/20 => Loss 0.104, Train_accy 97.04, Test_accy 88.96: 100%|██████████| 20/20 [04:47<00:00, 14.72s/it]
Task 0, Epoch 20/20 => Loss 0.104, Train_accy 97.04, Test_accy 88.96: 100%|██████████| 20/20 [04:47<00:00, 14.35s/it]
2024-09-08 02:11:39,351 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.104, Train_accy 97.04, Test_accy 88.96
2024-09-08 02:11:41,582 [trainer.py] => No NME accuracy.
2024-09-08 02:11:41,582 [trainer.py] => CNN: {'total': 88.96, '00-09': 88.96, 'old': 0, 'new': 88.96}
2024-09-08 02:11:41,582 [trainer.py] => CNN top1 curve: [88.96]
2024-09-08 02:11:41,583 [trainer.py] => CNN top5 curve: [99.05]

Average Accuracy (CNN): 88.96
2024-09-08 02:11:41,583 [trainer.py] => Average Accuracy (CNN): 88.96 

2024-09-08 02:11:41,584 [trainer.py] => All params: 89792456
2024-09-08 02:11:41,586 [trainer.py] => Trainable params: 89792456
2024-09-08 02:11:41,680 [coda_prompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.431, Train_accy 58.60:   0%|          | 0/20 [00:16<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.431, Train_accy 58.60:   5%|▌         | 1/20 [00:16<05:12, 16.47s/it]
Task 1, Epoch 2/20 => Loss 0.486, Train_accy 84.27:   5%|▌         | 1/20 [00:32<05:12, 16.47s/it]
Task 1, Epoch 2/20 => Loss 0.486, Train_accy 84.27:  10%|█         | 2/20 [00:32<04:57, 16.50s/it]
Task 1, Epoch 3/20 => Loss 0.344, Train_accy 89.45:  10%|█         | 2/20 [00:49<04:57, 16.50s/it]
Task 1, Epoch 3/20 => Loss 0.344, Train_accy 89.45:  15%|█▌        | 3/20 [00:49<04:40, 16.51s/it]
Task 1, Epoch 4/20 => Loss 0.294, Train_accy 90.12:  15%|█▌        | 3/20 [01:05<04:40, 16.51s/it]
Task 1, Epoch 4/20 => Loss 0.294, Train_accy 90.12:  20%|██        | 4/20 [01:05<04:23, 16.49s/it]
Task 1, Epoch 5/20 => Loss 0.257, Train_accy 92.20, Test_accy 82.15:  20%|██        | 4/20 [01:26<04:23, 16.49s/it]
Task 1, Epoch 5/20 => Loss 0.257, Train_accy 92.20, Test_accy 82.15:  25%|██▌       | 5/20 [01:26<04:30, 18.01s/it]
Task 1, Epoch 6/20 => Loss 0.212, Train_accy 93.35:  25%|██▌       | 5/20 [01:43<04:30, 18.01s/it]                 
Task 1, Epoch 6/20 => Loss 0.212, Train_accy 93.35:  30%|███       | 6/20 [01:43<04:04, 17.49s/it]
Task 1, Epoch 7/20 => Loss 0.193, Train_accy 94.35:  30%|███       | 6/20 [01:59<04:04, 17.49s/it]
Task 1, Epoch 7/20 => Loss 0.193, Train_accy 94.35:  35%|███▌      | 7/20 [01:59<03:42, 17.15s/it]
Task 1, Epoch 8/20 => Loss 0.163, Train_accy 95.03:  35%|███▌      | 7/20 [02:16<03:42, 17.15s/it]
Task 1, Epoch 8/20 => Loss 0.163, Train_accy 95.03:  40%|████      | 8/20 [02:16<03:23, 16.93s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 94.56:  40%|████      | 8/20 [02:32<03:23, 16.93s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 94.56:  45%|████▌     | 9/20 [02:32<03:04, 16.80s/it]
Task 1, Epoch 10/20 => Loss 0.140, Train_accy 95.70, Test_accy 83.74:  45%|████▌     | 9/20 [02:53<03:04, 16.80s/it]
Task 1, Epoch 10/20 => Loss 0.140, Train_accy 95.70, Test_accy 83.74:  50%|█████     | 10/20 [02:53<03:00, 18.03s/it]
Task 1, Epoch 11/20 => Loss 0.135, Train_accy 96.03:  50%|█████     | 10/20 [03:09<03:00, 18.03s/it]                 
Task 1, Epoch 11/20 => Loss 0.135, Train_accy 96.03:  55%|█████▌    | 11/20 [03:09<02:37, 17.55s/it]
Task 1, Epoch 12/20 => Loss 0.115, Train_accy 96.91:  55%|█████▌    | 11/20 [03:26<02:37, 17.55s/it]
Task 1, Epoch 12/20 => Loss 0.115, Train_accy 96.91:  60%|██████    | 12/20 [03:26<02:18, 17.26s/it]
Task 1, Epoch 13/20 => Loss 0.145, Train_accy 95.77:  60%|██████    | 12/20 [03:42<02:18, 17.26s/it]
Task 1, Epoch 13/20 => Loss 0.145, Train_accy 95.77:  65%|██████▌   | 13/20 [03:42<01:59, 17.05s/it]
Task 1, Epoch 14/20 => Loss 0.119, Train_accy 96.03:  65%|██████▌   | 13/20 [03:59<01:59, 17.05s/it]
Task 1, Epoch 14/20 => Loss 0.119, Train_accy 96.03:  70%|███████   | 14/20 [03:59<01:41, 16.85s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 96.44, Test_accy 83.89:  70%|███████   | 14/20 [04:20<01:41, 16.85s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 96.44, Test_accy 83.89:  75%|███████▌  | 15/20 [04:20<01:30, 18.02s/it]
Task 1, Epoch 16/20 => Loss 0.115, Train_accy 96.71:  75%|███████▌  | 15/20 [04:36<01:30, 18.02s/it]                 
Task 1, Epoch 16/20 => Loss 0.115, Train_accy 96.71:  80%|████████  | 16/20 [04:36<01:10, 17.56s/it]
Task 1, Epoch 17/20 => Loss 0.119, Train_accy 96.51:  80%|████████  | 16/20 [04:53<01:10, 17.56s/it]
Task 1, Epoch 17/20 => Loss 0.119, Train_accy 96.51:  85%|████████▌ | 17/20 [04:53<00:51, 17.22s/it]
Task 1, Epoch 18/20 => Loss 0.128, Train_accy 95.97:  85%|████████▌ | 17/20 [05:09<00:51, 17.22s/it]
Task 1, Epoch 18/20 => Loss 0.128, Train_accy 95.97:  90%|█████████ | 18/20 [05:09<00:33, 16.98s/it]
Task 1, Epoch 19/20 => Loss 0.120, Train_accy 96.10:  90%|█████████ | 18/20 [05:25<00:33, 16.98s/it]
Task 1, Epoch 19/20 => Loss 0.120, Train_accy 96.10:  95%|█████████▌| 19/20 [05:25<00:16, 16.84s/it]
Task 1, Epoch 20/20 => Loss 0.116, Train_accy 96.37, Test_accy 84.91:  95%|█████████▌| 19/20 [05:46<00:16, 16.84s/it]
Task 1, Epoch 20/20 => Loss 0.116, Train_accy 96.37, Test_accy 84.91: 100%|██████████| 20/20 [05:46<00:00, 18.01s/it]
Task 1, Epoch 20/20 => Loss 0.116, Train_accy 96.37, Test_accy 84.91: 100%|██████████| 20/20 [05:46<00:00, 17.33s/it]
2024-09-08 02:17:28,383 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.116, Train_accy 96.37, Test_accy 84.91
2024-09-08 02:17:32,693 [trainer.py] => No NME accuracy.
2024-09-08 02:17:32,694 [trainer.py] => CNN: {'total': 84.91, '00-09': 82.97, '10-19': 86.56, 'old': 82.97, 'new': 86.56}
2024-09-08 02:17:32,694 [trainer.py] => CNN top1 curve: [88.96, 84.91]
2024-09-08 02:17:32,694 [trainer.py] => CNN top5 curve: [99.05, 96.81]

Average Accuracy (CNN): 86.94
2024-09-08 02:17:32,694 [trainer.py] => Average Accuracy (CNN): 86.94 

2024-09-08 02:17:32,695 [trainer.py] => All params: 89792456
2024-09-08 02:17:32,697 [trainer.py] => Trainable params: 89792456
2024-09-08 02:17:32,840 [coda_prompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.558, Train_accy 53.25:   0%|          | 0/20 [00:13<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.558, Train_accy 53.25:   5%|▌         | 1/20 [00:13<04:14, 13.38s/it]
Task 2, Epoch 2/20 => Loss 0.464, Train_accy 86.00:   5%|▌         | 1/20 [00:26<04:14, 13.38s/it]
Task 2, Epoch 2/20 => Loss 0.464, Train_accy 86.00:  10%|█         | 2/20 [00:26<04:01, 13.40s/it]
Task 2, Epoch 3/20 => Loss 0.368, Train_accy 88.83:  10%|█         | 2/20 [00:40<04:01, 13.40s/it]
Task 2, Epoch 3/20 => Loss 0.368, Train_accy 88.83:  15%|█▌        | 3/20 [00:40<03:47, 13.38s/it]
Task 2, Epoch 4/20 => Loss 0.282, Train_accy 91.25:  15%|█▌        | 3/20 [00:53<03:47, 13.38s/it]
Task 2, Epoch 4/20 => Loss 0.282, Train_accy 91.25:  20%|██        | 4/20 [00:53<03:34, 13.39s/it]
Task 2, Epoch 5/20 => Loss 0.227, Train_accy 93.25, Test_accy 80.18:  20%|██        | 4/20 [01:12<03:34, 13.39s/it]
Task 2, Epoch 5/20 => Loss 0.227, Train_accy 93.25, Test_accy 80.18:  25%|██▌       | 5/20 [01:12<03:52, 15.53s/it]
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 92.50:  25%|██▌       | 5/20 [01:26<03:52, 15.53s/it]                 
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 92.50:  30%|███       | 6/20 [01:26<03:27, 14.80s/it]
Task 2, Epoch 7/20 => Loss 0.189, Train_accy 94.83:  30%|███       | 6/20 [01:39<03:27, 14.80s/it]
Task 2, Epoch 7/20 => Loss 0.189, Train_accy 94.83:  35%|███▌      | 7/20 [01:39<03:06, 14.34s/it]
Task 2, Epoch 8/20 => Loss 0.176, Train_accy 94.67:  35%|███▌      | 7/20 [01:52<03:06, 14.34s/it]
Task 2, Epoch 8/20 => Loss 0.176, Train_accy 94.67:  40%|████      | 8/20 [01:52<02:48, 14.02s/it]
Task 2, Epoch 9/20 => Loss 0.168, Train_accy 95.33:  40%|████      | 8/20 [02:06<02:48, 14.02s/it]
Task 2, Epoch 9/20 => Loss 0.168, Train_accy 95.33:  45%|████▌     | 9/20 [02:06<02:32, 13.83s/it]
Task 2, Epoch 10/20 => Loss 0.154, Train_accy 95.08, Test_accy 80.79:  45%|████▌     | 9/20 [02:25<02:32, 13.83s/it]
Task 2, Epoch 10/20 => Loss 0.154, Train_accy 95.08, Test_accy 80.79:  50%|█████     | 10/20 [02:25<02:35, 15.55s/it]
Task 2, Epoch 11/20 => Loss 0.148, Train_accy 95.33:  50%|█████     | 10/20 [02:39<02:35, 15.55s/it]                 
Task 2, Epoch 11/20 => Loss 0.148, Train_accy 95.33:  55%|█████▌    | 11/20 [02:39<02:14, 14.89s/it]
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 95.83:  55%|█████▌    | 11/20 [02:52<02:14, 14.89s/it]
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 95.83:  60%|██████    | 12/20 [02:52<01:55, 14.44s/it]
Task 2, Epoch 13/20 => Loss 0.146, Train_accy 96.17:  60%|██████    | 12/20 [03:05<01:55, 14.44s/it]
Task 2, Epoch 13/20 => Loss 0.146, Train_accy 96.17:  65%|██████▌   | 13/20 [03:05<01:38, 14.11s/it]
Task 2, Epoch 14/20 => Loss 0.128, Train_accy 96.17:  65%|██████▌   | 13/20 [03:19<01:38, 14.11s/it]
Task 2, Epoch 14/20 => Loss 0.128, Train_accy 96.17:  70%|███████   | 14/20 [03:19<01:23, 13.90s/it]
Task 2, Epoch 15/20 => Loss 0.130, Train_accy 96.17, Test_accy 81.70:  70%|███████   | 14/20 [03:38<01:23, 13.90s/it]
Task 2, Epoch 15/20 => Loss 0.130, Train_accy 96.17, Test_accy 81.70:  75%|███████▌  | 15/20 [03:38<01:17, 15.51s/it]
Task 2, Epoch 16/20 => Loss 0.099, Train_accy 96.67:  75%|███████▌  | 15/20 [03:51<01:17, 15.51s/it]                 
Task 2, Epoch 16/20 => Loss 0.099, Train_accy 96.67:  80%|████████  | 16/20 [03:51<00:59, 14.85s/it]
Task 2, Epoch 17/20 => Loss 0.141, Train_accy 96.00:  80%|████████  | 16/20 [04:05<00:59, 14.85s/it]
Task 2, Epoch 17/20 => Loss 0.141, Train_accy 96.00:  85%|████████▌ | 17/20 [04:05<00:43, 14.41s/it]
Task 2, Epoch 18/20 => Loss 0.123, Train_accy 97.17:  85%|████████▌ | 17/20 [04:18<00:43, 14.41s/it]
Task 2, Epoch 18/20 => Loss 0.123, Train_accy 97.17:  90%|█████████ | 18/20 [04:18<00:28, 14.11s/it]
Task 2, Epoch 19/20 => Loss 0.087, Train_accy 97.92:  90%|█████████ | 18/20 [04:32<00:28, 14.11s/it]
Task 2, Epoch 19/20 => Loss 0.087, Train_accy 97.92:  95%|█████████▌| 19/20 [04:32<00:13, 13.88s/it]
Task 2, Epoch 20/20 => Loss 0.119, Train_accy 96.25, Test_accy 82.51:  95%|█████████▌| 19/20 [04:51<00:13, 13.88s/it]
Task 2, Epoch 20/20 => Loss 0.119, Train_accy 96.25, Test_accy 82.51: 100%|██████████| 20/20 [04:51<00:00, 15.50s/it]
Task 2, Epoch 20/20 => Loss 0.119, Train_accy 96.25, Test_accy 82.51: 100%|██████████| 20/20 [04:51<00:00, 14.57s/it]
2024-09-08 02:22:24,205 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.119, Train_accy 96.25, Test_accy 82.51
2024-09-08 02:22:30,124 [trainer.py] => No NME accuracy.
2024-09-08 02:22:30,125 [trainer.py] => CNN: {'total': 82.51, '00-09': 83.28, '10-19': 84.95, '20-29': 78.67, 'old': 84.18, 'new': 78.67}
2024-09-08 02:22:30,125 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51]
2024-09-08 02:22:30,125 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25]

Average Accuracy (CNN): 85.46
2024-09-08 02:22:30,125 [trainer.py] => Average Accuracy (CNN): 85.46 

2024-09-08 02:22:30,125 [trainer.py] => All params: 89792456
2024-09-08 02:22:30,126 [trainer.py] => Trainable params: 89792456
2024-09-08 02:22:30,332 [coda_prompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.281, Train_accy 60.11:   0%|          | 0/20 [00:14<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.281, Train_accy 60.11:   5%|▌         | 1/20 [00:14<04:33, 14.42s/it]
Task 3, Epoch 2/20 => Loss 0.460, Train_accy 85.26:   5%|▌         | 1/20 [00:28<04:33, 14.42s/it]
Task 3, Epoch 2/20 => Loss 0.460, Train_accy 85.26:  10%|█         | 2/20 [00:28<04:19, 14.43s/it]
Task 3, Epoch 3/20 => Loss 0.353, Train_accy 87.42:  10%|█         | 2/20 [00:43<04:19, 14.43s/it]
Task 3, Epoch 3/20 => Loss 0.353, Train_accy 87.42:  15%|█▌        | 3/20 [00:43<04:05, 14.46s/it]
Task 3, Epoch 4/20 => Loss 0.292, Train_accy 90.82:  15%|█▌        | 3/20 [00:57<04:05, 14.46s/it]
Task 3, Epoch 4/20 => Loss 0.292, Train_accy 90.82:  20%|██        | 4/20 [00:57<03:51, 14.45s/it]
Task 3, Epoch 5/20 => Loss 0.264, Train_accy 91.59, Test_accy 80.24:  20%|██        | 4/20 [01:19<03:51, 14.45s/it]
Task 3, Epoch 5/20 => Loss 0.264, Train_accy 91.59, Test_accy 80.24:  25%|██▌       | 5/20 [01:19<04:18, 17.24s/it]
Task 3, Epoch 6/20 => Loss 0.222, Train_accy 93.13:  25%|██▌       | 5/20 [01:34<04:18, 17.24s/it]                 
Task 3, Epoch 6/20 => Loss 0.222, Train_accy 93.13:  30%|███       | 6/20 [01:34<03:48, 16.29s/it]
Task 3, Epoch 7/20 => Loss 0.181, Train_accy 94.52:  30%|███       | 6/20 [01:48<03:48, 16.29s/it]
Task 3, Epoch 7/20 => Loss 0.181, Train_accy 94.52:  35%|███▌      | 7/20 [01:48<03:23, 15.69s/it]
Task 3, Epoch 8/20 => Loss 0.202, Train_accy 94.06:  35%|███▌      | 7/20 [02:03<03:23, 15.69s/it]
Task 3, Epoch 8/20 => Loss 0.202, Train_accy 94.06:  40%|████      | 8/20 [02:03<03:03, 15.28s/it]
Task 3, Epoch 9/20 => Loss 0.185, Train_accy 93.98:  40%|████      | 8/20 [02:17<03:03, 15.28s/it]
Task 3, Epoch 9/20 => Loss 0.185, Train_accy 93.98:  45%|████▌     | 9/20 [02:17<02:45, 15.01s/it]
Task 3, Epoch 10/20 => Loss 0.141, Train_accy 95.45, Test_accy 80.85:  45%|████▌     | 9/20 [02:39<02:45, 15.01s/it]
Task 3, Epoch 10/20 => Loss 0.141, Train_accy 95.45, Test_accy 80.85:  50%|█████     | 10/20 [02:39<02:52, 17.21s/it]
Task 3, Epoch 11/20 => Loss 0.164, Train_accy 94.98:  50%|█████     | 10/20 [02:54<02:52, 17.21s/it]                 
Task 3, Epoch 11/20 => Loss 0.164, Train_accy 94.98:  55%|█████▌    | 11/20 [02:54<02:27, 16.34s/it]
Task 3, Epoch 12/20 => Loss 0.147, Train_accy 95.99:  55%|█████▌    | 11/20 [03:08<02:27, 16.34s/it]
Task 3, Epoch 12/20 => Loss 0.147, Train_accy 95.99:  60%|██████    | 12/20 [03:08<02:06, 15.76s/it]
Task 3, Epoch 13/20 => Loss 0.126, Train_accy 95.68:  60%|██████    | 12/20 [03:22<02:06, 15.76s/it]
Task 3, Epoch 13/20 => Loss 0.126, Train_accy 95.68:  65%|██████▌   | 13/20 [03:22<01:47, 15.32s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 94.68:  65%|██████▌   | 13/20 [03:37<01:47, 15.32s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 94.68:  70%|███████   | 14/20 [03:37<01:30, 15.06s/it]
Task 3, Epoch 15/20 => Loss 0.146, Train_accy 95.60, Test_accy 81.30:  70%|███████   | 14/20 [03:59<01:30, 15.06s/it]
Task 3, Epoch 15/20 => Loss 0.146, Train_accy 95.60, Test_accy 81.30:  75%|███████▌  | 15/20 [03:59<01:25, 17.19s/it]
Task 3, Epoch 16/20 => Loss 0.099, Train_accy 97.15:  75%|███████▌  | 15/20 [04:13<01:25, 17.19s/it]                 
Task 3, Epoch 16/20 => Loss 0.099, Train_accy 97.15:  80%|████████  | 16/20 [04:13<01:05, 16.35s/it]
Task 3, Epoch 17/20 => Loss 0.149, Train_accy 95.60:  80%|████████  | 16/20 [04:28<01:05, 16.35s/it]
Task 3, Epoch 17/20 => Loss 0.149, Train_accy 95.60:  85%|████████▌ | 17/20 [04:28<00:47, 15.74s/it]
Task 3, Epoch 18/20 => Loss 0.127, Train_accy 95.99:  85%|████████▌ | 17/20 [04:42<00:47, 15.74s/it]
Task 3, Epoch 18/20 => Loss 0.127, Train_accy 95.99:  90%|█████████ | 18/20 [04:42<00:30, 15.31s/it]
Task 3, Epoch 19/20 => Loss 0.125, Train_accy 96.37:  90%|█████████ | 18/20 [04:56<00:30, 15.31s/it]
Task 3, Epoch 19/20 => Loss 0.125, Train_accy 96.37:  95%|█████████▌| 19/20 [04:56<00:15, 15.03s/it]
Task 3, Epoch 20/20 => Loss 0.127, Train_accy 96.53, Test_accy 81.15:  95%|█████████▌| 19/20 [05:19<00:15, 15.03s/it]
Task 3, Epoch 20/20 => Loss 0.127, Train_accy 96.53, Test_accy 81.15: 100%|██████████| 20/20 [05:19<00:00, 17.17s/it]
Task 3, Epoch 20/20 => Loss 0.127, Train_accy 96.53, Test_accy 81.15: 100%|██████████| 20/20 [05:19<00:00, 15.95s/it]
2024-09-08 02:27:49,435 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.127, Train_accy 96.53, Test_accy 81.15
2024-09-08 02:27:57,167 [trainer.py] => No NME accuracy.
2024-09-08 02:27:57,168 [trainer.py] => CNN: {'total': 81.15, '00-09': 80.76, '10-19': 83.6, '20-29': 75.0, '30-39': 84.34, 'old': 80.08, 'new': 84.34}
2024-09-08 02:27:57,168 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15]
2024-09-08 02:27:57,168 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63]

Average Accuracy (CNN): 84.38
2024-09-08 02:27:57,168 [trainer.py] => Average Accuracy (CNN): 84.38 

2024-09-08 02:27:57,170 [trainer.py] => All params: 89792456
2024-09-08 02:27:57,171 [trainer.py] => Trainable params: 89792456
2024-09-08 02:27:57,417 [coda_prompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.825, Train_accy 45.83:   0%|          | 0/20 [00:11<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.825, Train_accy 45.83:   5%|▌         | 1/20 [00:11<03:44, 11.80s/it]
Task 4, Epoch 2/20 => Loss 0.635, Train_accy 79.83:   5%|▌         | 1/20 [00:23<03:44, 11.80s/it]
Task 4, Epoch 2/20 => Loss 0.635, Train_accy 79.83:  10%|█         | 2/20 [00:23<03:32, 11.82s/it]
Task 4, Epoch 3/20 => Loss 0.457, Train_accy 85.04:  10%|█         | 2/20 [00:35<03:32, 11.82s/it]
Task 4, Epoch 3/20 => Loss 0.457, Train_accy 85.04:  15%|█▌        | 3/20 [00:35<03:20, 11.81s/it]
Task 4, Epoch 4/20 => Loss 0.391, Train_accy 87.97:  15%|█▌        | 3/20 [00:47<03:20, 11.81s/it]
Task 4, Epoch 4/20 => Loss 0.391, Train_accy 87.97:  20%|██        | 4/20 [00:47<03:09, 11.82s/it]
Task 4, Epoch 5/20 => Loss 0.334, Train_accy 89.49, Test_accy 77.33:  20%|██        | 4/20 [01:08<03:09, 11.82s/it]
Task 4, Epoch 5/20 => Loss 0.334, Train_accy 89.49, Test_accy 77.33:  25%|██▌       | 5/20 [01:08<03:47, 15.18s/it]
Task 4, Epoch 6/20 => Loss 0.284, Train_accy 91.76:  25%|██▌       | 5/20 [01:20<03:47, 15.18s/it]                 
Task 4, Epoch 6/20 => Loss 0.284, Train_accy 91.76:  30%|███       | 6/20 [01:20<03:16, 14.04s/it]
Task 4, Epoch 7/20 => Loss 0.272, Train_accy 91.76:  30%|███       | 6/20 [01:32<03:16, 14.04s/it]
Task 4, Epoch 7/20 => Loss 0.272, Train_accy 91.76:  35%|███▌      | 7/20 [01:32<02:53, 13.32s/it]
Task 4, Epoch 8/20 => Loss 0.227, Train_accy 92.90:  35%|███▌      | 7/20 [01:43<02:53, 13.32s/it]
Task 4, Epoch 8/20 => Loss 0.227, Train_accy 92.90:  40%|████      | 8/20 [01:43<02:33, 12.82s/it]
Task 4, Epoch 9/20 => Loss 0.215, Train_accy 93.37:  40%|████      | 8/20 [01:55<02:33, 12.82s/it]
Task 4, Epoch 9/20 => Loss 0.215, Train_accy 93.37:  45%|████▌     | 9/20 [01:55<02:17, 12.51s/it]
Task 4, Epoch 10/20 => Loss 0.175, Train_accy 94.79, Test_accy 78.31:  45%|████▌     | 9/20 [02:16<02:17, 12.51s/it]
Task 4, Epoch 10/20 => Loss 0.175, Train_accy 94.79, Test_accy 78.31:  50%|█████     | 10/20 [02:16<02:31, 15.20s/it]
Task 4, Epoch 11/20 => Loss 0.172, Train_accy 94.70:  50%|█████     | 10/20 [02:28<02:31, 15.20s/it]                 
Task 4, Epoch 11/20 => Loss 0.172, Train_accy 94.70:  55%|█████▌    | 11/20 [02:28<02:07, 14.16s/it]
Task 4, Epoch 12/20 => Loss 0.177, Train_accy 94.79:  55%|█████▌    | 11/20 [02:40<02:07, 14.16s/it]
Task 4, Epoch 12/20 => Loss 0.177, Train_accy 94.79:  60%|██████    | 12/20 [02:40<01:47, 13.45s/it]
Task 4, Epoch 13/20 => Loss 0.192, Train_accy 94.79:  60%|██████    | 12/20 [02:52<01:47, 13.45s/it]
Task 4, Epoch 13/20 => Loss 0.192, Train_accy 94.79:  65%|██████▌   | 13/20 [02:52<01:30, 12.94s/it]
Task 4, Epoch 14/20 => Loss 0.143, Train_accy 96.40:  65%|██████▌   | 13/20 [03:04<01:30, 12.94s/it]
Task 4, Epoch 14/20 => Loss 0.143, Train_accy 96.40:  70%|███████   | 14/20 [03:04<01:15, 12.67s/it]
Task 4, Epoch 15/20 => Loss 0.178, Train_accy 94.41, Test_accy 78.56:  70%|███████   | 14/20 [03:25<01:15, 12.67s/it]
Task 4, Epoch 15/20 => Loss 0.178, Train_accy 94.41, Test_accy 78.56:  75%|███████▌  | 15/20 [03:25<01:16, 15.26s/it]
Task 4, Epoch 16/20 => Loss 0.157, Train_accy 95.08:  75%|███████▌  | 15/20 [03:37<01:16, 15.26s/it]                 
Task 4, Epoch 16/20 => Loss 0.157, Train_accy 95.08:  80%|████████  | 16/20 [03:37<00:56, 14.22s/it]
Task 4, Epoch 17/20 => Loss 0.166, Train_accy 95.55:  80%|████████  | 16/20 [03:49<00:56, 14.22s/it]
Task 4, Epoch 17/20 => Loss 0.166, Train_accy 95.55:  85%|████████▌ | 17/20 [03:49<00:40, 13.49s/it]
Task 4, Epoch 18/20 => Loss 0.118, Train_accy 97.44:  85%|████████▌ | 17/20 [04:01<00:40, 13.49s/it]
Task 4, Epoch 18/20 => Loss 0.118, Train_accy 97.44:  90%|█████████ | 18/20 [04:01<00:26, 13.01s/it]
Task 4, Epoch 19/20 => Loss 0.139, Train_accy 95.93:  90%|█████████ | 18/20 [04:12<00:26, 13.01s/it]
Task 4, Epoch 19/20 => Loss 0.139, Train_accy 95.93:  95%|█████████▌| 19/20 [04:12<00:12, 12.65s/it]
Task 4, Epoch 20/20 => Loss 0.158, Train_accy 95.45, Test_accy 78.87:  95%|█████████▌| 19/20 [04:34<00:12, 12.65s/it]
Task 4, Epoch 20/20 => Loss 0.158, Train_accy 95.45, Test_accy 78.87: 100%|██████████| 20/20 [04:34<00:00, 15.21s/it]
Task 4, Epoch 20/20 => Loss 0.158, Train_accy 95.45, Test_accy 78.87: 100%|██████████| 20/20 [04:34<00:00, 13.70s/it]
2024-09-08 02:32:31,472 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.158, Train_accy 95.45, Test_accy 78.87
2024-09-08 02:32:40,908 [trainer.py] => No NME accuracy.
2024-09-08 02:32:40,909 [trainer.py] => CNN: {'total': 78.87, '00-09': 79.18, '10-19': 84.14, '20-29': 75.0, '30-39': 84.94, '40-49': 69.21, 'old': 81.07, 'new': 69.21}
2024-09-08 02:32:40,909 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87]
2024-09-08 02:32:40,909 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73]

Average Accuracy (CNN): 83.28
2024-09-08 02:32:40,909 [trainer.py] => Average Accuracy (CNN): 83.28 

2024-09-08 02:32:40,911 [trainer.py] => All params: 89792456
2024-09-08 02:32:40,912 [trainer.py] => Trainable params: 89792456
2024-09-08 02:32:41,198 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.470, Train_accy 55.00:   0%|          | 0/20 [00:13<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.470, Train_accy 55.00:   5%|▌         | 1/20 [00:13<04:14, 13.37s/it]
Task 5, Epoch 2/20 => Loss 0.472, Train_accy 85.58:   5%|▌         | 1/20 [00:26<04:14, 13.37s/it]
Task 5, Epoch 2/20 => Loss 0.472, Train_accy 85.58:  10%|█         | 2/20 [00:26<04:00, 13.37s/it]
Task 5, Epoch 3/20 => Loss 0.390, Train_accy 87.67:  10%|█         | 2/20 [00:40<04:00, 13.37s/it]
Task 5, Epoch 3/20 => Loss 0.390, Train_accy 87.67:  15%|█▌        | 3/20 [00:40<03:47, 13.38s/it]
Task 5, Epoch 4/20 => Loss 0.290, Train_accy 91.08:  15%|█▌        | 3/20 [00:53<03:47, 13.38s/it]
Task 5, Epoch 4/20 => Loss 0.290, Train_accy 91.08:  20%|██        | 4/20 [00:53<03:34, 13.38s/it]
Task 5, Epoch 5/20 => Loss 0.231, Train_accy 92.83, Test_accy 75.66:  20%|██        | 4/20 [01:17<03:34, 13.38s/it]
Task 5, Epoch 5/20 => Loss 0.231, Train_accy 92.83, Test_accy 75.66:  25%|██▌       | 5/20 [01:17<04:20, 17.38s/it]
Task 5, Epoch 6/20 => Loss 0.217, Train_accy 92.58:  25%|██▌       | 5/20 [01:31<04:20, 17.38s/it]                 
Task 5, Epoch 6/20 => Loss 0.217, Train_accy 92.58:  30%|███       | 6/20 [01:31<03:44, 16.05s/it]
Task 5, Epoch 7/20 => Loss 0.217, Train_accy 92.33:  30%|███       | 6/20 [01:44<03:44, 16.05s/it]
Task 5, Epoch 7/20 => Loss 0.217, Train_accy 92.33:  35%|███▌      | 7/20 [01:44<03:17, 15.19s/it]
Task 5, Epoch 8/20 => Loss 0.181, Train_accy 94.83:  35%|███▌      | 7/20 [01:58<03:17, 15.19s/it]
Task 5, Epoch 8/20 => Loss 0.181, Train_accy 94.83:  40%|████      | 8/20 [01:58<02:55, 14.61s/it]
Task 5, Epoch 9/20 => Loss 0.174, Train_accy 95.25:  40%|████      | 8/20 [02:11<02:55, 14.61s/it]
Task 5, Epoch 9/20 => Loss 0.174, Train_accy 95.25:  45%|████▌     | 9/20 [02:11<02:36, 14.25s/it]
Task 5, Epoch 10/20 => Loss 0.170, Train_accy 95.67, Test_accy 76.49:  45%|████▌     | 9/20 [02:36<02:36, 14.25s/it]
Task 5, Epoch 10/20 => Loss 0.170, Train_accy 95.67, Test_accy 76.49:  50%|█████     | 10/20 [02:36<02:54, 17.43s/it]
Task 5, Epoch 11/20 => Loss 0.138, Train_accy 96.25:  50%|█████     | 10/20 [02:49<02:54, 17.43s/it]                 
Task 5, Epoch 11/20 => Loss 0.138, Train_accy 96.25:  55%|█████▌    | 11/20 [02:49<02:25, 16.20s/it]
Task 5, Epoch 12/20 => Loss 0.151, Train_accy 95.33:  55%|█████▌    | 11/20 [03:03<02:25, 16.20s/it]
Task 5, Epoch 12/20 => Loss 0.151, Train_accy 95.33:  60%|██████    | 12/20 [03:03<02:02, 15.36s/it]
Task 5, Epoch 13/20 => Loss 0.157, Train_accy 95.17:  60%|██████    | 12/20 [03:16<02:02, 15.36s/it]
Task 5, Epoch 13/20 => Loss 0.157, Train_accy 95.17:  65%|██████▌   | 13/20 [03:16<01:43, 14.78s/it]
Task 5, Epoch 14/20 => Loss 0.152, Train_accy 95.83:  65%|██████▌   | 13/20 [03:29<01:43, 14.78s/it]
Task 5, Epoch 14/20 => Loss 0.152, Train_accy 95.83:  70%|███████   | 14/20 [03:29<01:26, 14.35s/it]
Task 5, Epoch 15/20 => Loss 0.130, Train_accy 95.92, Test_accy 76.91:  70%|███████   | 14/20 [03:54<01:26, 14.35s/it]
Task 5, Epoch 15/20 => Loss 0.130, Train_accy 95.92, Test_accy 76.91:  75%|███████▌  | 15/20 [03:54<01:27, 17.41s/it]
Task 5, Epoch 16/20 => Loss 0.141, Train_accy 95.58:  75%|███████▌  | 15/20 [04:07<01:27, 17.41s/it]                 
Task 5, Epoch 16/20 => Loss 0.141, Train_accy 95.58:  80%|████████  | 16/20 [04:07<01:04, 16.20s/it]
Task 5, Epoch 17/20 => Loss 0.140, Train_accy 96.00:  80%|████████  | 16/20 [04:21<01:04, 16.20s/it]
Task 5, Epoch 17/20 => Loss 0.140, Train_accy 96.00:  85%|████████▌ | 17/20 [04:21<00:46, 15.35s/it]
Task 5, Epoch 18/20 => Loss 0.134, Train_accy 95.75:  85%|████████▌ | 17/20 [04:34<00:46, 15.35s/it]
Task 5, Epoch 18/20 => Loss 0.134, Train_accy 95.75:  90%|█████████ | 18/20 [04:34<00:29, 14.76s/it]
Task 5, Epoch 19/20 => Loss 0.136, Train_accy 96.00:  90%|█████████ | 18/20 [04:47<00:29, 14.76s/it]
Task 5, Epoch 19/20 => Loss 0.136, Train_accy 96.00:  95%|█████████▌| 19/20 [04:47<00:14, 14.35s/it]
Task 5, Epoch 20/20 => Loss 0.140, Train_accy 96.42, Test_accy 76.96:  95%|█████████▌| 19/20 [05:12<00:14, 14.35s/it]
Task 5, Epoch 20/20 => Loss 0.140, Train_accy 96.42, Test_accy 76.96: 100%|██████████| 20/20 [05:12<00:00, 17.39s/it]
Task 5, Epoch 20/20 => Loss 0.140, Train_accy 96.42, Test_accy 76.96: 100%|██████████| 20/20 [05:12<00:00, 15.62s/it]
2024-09-08 02:37:53,620 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.140, Train_accy 96.42, Test_accy 76.96
2024-09-08 02:38:04,718 [trainer.py] => No NME accuracy.
2024-09-08 02:38:04,719 [trainer.py] => CNN: {'total': 76.96, '00-09': 80.13, '10-19': 84.68, '20-29': 74.33, '30-39': 84.04, '40-49': 67.88, '50-59': 68.09, 'old': 78.62, 'new': 68.09}
2024-09-08 02:38:04,719 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96]
2024-09-08 02:38:04,719 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8]

Average Accuracy (CNN): 82.23
2024-09-08 02:38:04,719 [trainer.py] => Average Accuracy (CNN): 82.23 

2024-09-08 02:38:04,721 [trainer.py] => All params: 89792456
2024-09-08 02:38:04,722 [trainer.py] => Trainable params: 89792456
2024-09-08 02:38:05,062 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.561, Train_accy 52.17:   0%|          | 0/20 [00:13<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.561, Train_accy 52.17:   5%|▌         | 1/20 [00:13<04:14, 13.40s/it]
Task 6, Epoch 2/20 => Loss 0.504, Train_accy 84.17:   5%|▌         | 1/20 [00:26<04:14, 13.40s/it]
Task 6, Epoch 2/20 => Loss 0.504, Train_accy 84.17:  10%|█         | 2/20 [00:26<04:01, 13.41s/it]
Task 6, Epoch 3/20 => Loss 0.365, Train_accy 88.42:  10%|█         | 2/20 [00:40<04:01, 13.41s/it]
Task 6, Epoch 3/20 => Loss 0.365, Train_accy 88.42:  15%|█▌        | 3/20 [00:40<03:48, 13.42s/it]
Task 6, Epoch 4/20 => Loss 0.298, Train_accy 90.08:  15%|█▌        | 3/20 [00:53<03:48, 13.42s/it]
Task 6, Epoch 4/20 => Loss 0.298, Train_accy 90.08:  20%|██        | 4/20 [00:53<03:34, 13.39s/it]
Task 6, Epoch 5/20 => Loss 0.280, Train_accy 90.75, Test_accy 74.25:  20%|██        | 4/20 [01:19<03:34, 13.39s/it]
Task 6, Epoch 5/20 => Loss 0.280, Train_accy 90.75, Test_accy 74.25:  25%|██▌       | 5/20 [01:19<04:30, 18.04s/it]
Task 6, Epoch 6/20 => Loss 0.234, Train_accy 91.83:  25%|██▌       | 5/20 [01:33<04:30, 18.04s/it]                 
Task 6, Epoch 6/20 => Loss 0.234, Train_accy 91.83:  30%|███       | 6/20 [01:33<03:51, 16.52s/it]
Task 6, Epoch 7/20 => Loss 0.223, Train_accy 92.92:  30%|███       | 6/20 [01:46<03:51, 16.52s/it]
Task 6, Epoch 7/20 => Loss 0.223, Train_accy 92.92:  35%|███▌      | 7/20 [01:46<03:21, 15.49s/it]
Task 6, Epoch 8/20 => Loss 0.217, Train_accy 93.83:  35%|███▌      | 7/20 [02:00<03:21, 15.49s/it]
Task 6, Epoch 8/20 => Loss 0.217, Train_accy 93.83:  40%|████      | 8/20 [02:00<02:57, 14.82s/it]
Task 6, Epoch 9/20 => Loss 0.207, Train_accy 94.00:  40%|████      | 8/20 [02:13<02:57, 14.82s/it]
Task 6, Epoch 9/20 => Loss 0.207, Train_accy 94.00:  45%|████▌     | 9/20 [02:13<02:38, 14.37s/it]
Task 6, Epoch 10/20 => Loss 0.203, Train_accy 94.58, Test_accy 75.37:  45%|████▌     | 9/20 [02:39<02:38, 14.37s/it]
Task 6, Epoch 10/20 => Loss 0.203, Train_accy 94.58, Test_accy 75.37:  50%|█████     | 10/20 [02:39<03:00, 18.03s/it]
Task 6, Epoch 11/20 => Loss 0.191, Train_accy 93.92:  50%|█████     | 10/20 [02:53<03:00, 18.03s/it]                 
Task 6, Epoch 11/20 => Loss 0.191, Train_accy 93.92:  55%|█████▌    | 11/20 [02:53<02:29, 16.62s/it]
Task 6, Epoch 12/20 => Loss 0.196, Train_accy 93.50:  55%|█████▌    | 11/20 [03:06<02:29, 16.62s/it]
Task 6, Epoch 12/20 => Loss 0.196, Train_accy 93.50:  60%|██████    | 12/20 [03:06<02:05, 15.67s/it]
Task 6, Epoch 13/20 => Loss 0.155, Train_accy 95.50:  60%|██████    | 12/20 [03:20<02:05, 15.67s/it]
Task 6, Epoch 13/20 => Loss 0.155, Train_accy 95.50:  65%|██████▌   | 13/20 [03:20<01:44, 14.98s/it]
Task 6, Epoch 14/20 => Loss 0.174, Train_accy 94.75:  65%|██████▌   | 13/20 [03:33<01:44, 14.98s/it]
Task 6, Epoch 14/20 => Loss 0.174, Train_accy 94.75:  70%|███████   | 14/20 [03:33<01:27, 14.50s/it]
Task 6, Epoch 15/20 => Loss 0.172, Train_accy 94.33, Test_accy 75.73:  70%|███████   | 14/20 [03:59<01:27, 14.50s/it]
Task 6, Epoch 15/20 => Loss 0.172, Train_accy 94.33, Test_accy 75.73:  75%|███████▌  | 15/20 [03:59<01:30, 18.05s/it]
Task 6, Epoch 16/20 => Loss 0.154, Train_accy 96.08:  75%|███████▌  | 15/20 [04:13<01:30, 18.05s/it]                 
Task 6, Epoch 16/20 => Loss 0.154, Train_accy 96.08:  80%|████████  | 16/20 [04:13<01:06, 16.65s/it]
Task 6, Epoch 17/20 => Loss 0.134, Train_accy 96.17:  80%|████████  | 16/20 [04:26<01:06, 16.65s/it]
Task 6, Epoch 17/20 => Loss 0.134, Train_accy 96.17:  85%|████████▌ | 17/20 [04:26<00:47, 15.68s/it]
Task 6, Epoch 18/20 => Loss 0.147, Train_accy 94.92:  85%|████████▌ | 17/20 [04:39<00:47, 15.68s/it]
Task 6, Epoch 18/20 => Loss 0.147, Train_accy 94.92:  90%|█████████ | 18/20 [04:39<00:29, 14.98s/it]
Task 6, Epoch 19/20 => Loss 0.144, Train_accy 95.58:  90%|█████████ | 18/20 [04:53<00:29, 14.98s/it]
Task 6, Epoch 19/20 => Loss 0.144, Train_accy 95.58:  95%|█████████▌| 19/20 [04:53<00:14, 14.50s/it]
Task 6, Epoch 20/20 => Loss 0.144, Train_accy 96.25, Test_accy 75.78:  95%|█████████▌| 19/20 [05:19<00:14, 14.50s/it]
Task 6, Epoch 20/20 => Loss 0.144, Train_accy 96.25, Test_accy 75.78: 100%|██████████| 20/20 [05:19<00:00, 17.99s/it]
Task 6, Epoch 20/20 => Loss 0.144, Train_accy 96.25, Test_accy 75.78: 100%|██████████| 20/20 [05:19<00:00, 15.97s/it]
2024-09-08 02:43:24,538 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.144, Train_accy 96.25, Test_accy 75.78
2024-09-08 02:43:37,329 [trainer.py] => No NME accuracy.
2024-09-08 02:43:37,330 [trainer.py] => CNN: {'total': 75.78, '00-09': 79.81, '10-19': 83.87, '20-29': 74.0, '30-39': 83.13, '40-49': 68.21, '50-59': 68.09, '60-69': 70.47, 'old': 76.6, 'new': 70.47}
2024-09-08 02:43:37,330 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78]
2024-09-08 02:43:37,330 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01]

Average Accuracy (CNN): 81.31
2024-09-08 02:43:37,330 [trainer.py] => Average Accuracy (CNN): 81.31 

2024-09-08 02:43:37,332 [trainer.py] => All params: 89792456
2024-09-08 02:43:37,333 [trainer.py] => Trainable params: 89792456
2024-09-08 02:43:37,715 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.405, Train_accy 57.67:   0%|          | 0/20 [00:11<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.405, Train_accy 57.67:   5%|▌         | 1/20 [00:11<03:44, 11.80s/it]
Task 7, Epoch 2/20 => Loss 0.419, Train_accy 86.65:   5%|▌         | 1/20 [00:23<03:44, 11.80s/it]
Task 7, Epoch 2/20 => Loss 0.419, Train_accy 86.65:  10%|█         | 2/20 [00:23<03:32, 11.81s/it]
Task 7, Epoch 3/20 => Loss 0.302, Train_accy 90.91:  10%|█         | 2/20 [00:35<03:32, 11.81s/it]
Task 7, Epoch 3/20 => Loss 0.302, Train_accy 90.91:  15%|█▌        | 3/20 [00:35<03:20, 11.80s/it]
Task 7, Epoch 4/20 => Loss 0.304, Train_accy 91.57:  15%|█▌        | 3/20 [00:47<03:20, 11.80s/it]
Task 7, Epoch 4/20 => Loss 0.304, Train_accy 91.57:  20%|██        | 4/20 [00:47<03:08, 11.81s/it]
Task 7, Epoch 5/20 => Loss 0.287, Train_accy 91.10, Test_accy 74.18:  20%|██        | 4/20 [01:13<03:08, 11.81s/it]
Task 7, Epoch 5/20 => Loss 0.287, Train_accy 91.10, Test_accy 74.18:  25%|██▌       | 5/20 [01:13<04:14, 16.97s/it]
Task 7, Epoch 6/20 => Loss 0.197, Train_accy 93.94:  25%|██▌       | 5/20 [01:25<04:14, 16.97s/it]                 
Task 7, Epoch 6/20 => Loss 0.197, Train_accy 93.94:  30%|███       | 6/20 [01:25<03:32, 15.20s/it]
Task 7, Epoch 7/20 => Loss 0.190, Train_accy 94.32:  30%|███       | 6/20 [01:36<03:32, 15.20s/it]
Task 7, Epoch 7/20 => Loss 0.190, Train_accy 94.32:  35%|███▌      | 7/20 [01:36<03:02, 14.06s/it]
Task 7, Epoch 8/20 => Loss 0.164, Train_accy 94.70:  35%|███▌      | 7/20 [01:48<03:02, 14.06s/it]
Task 7, Epoch 8/20 => Loss 0.164, Train_accy 94.70:  40%|████      | 8/20 [01:48<02:40, 13.36s/it]
Task 7, Epoch 9/20 => Loss 0.152, Train_accy 96.02:  40%|████      | 8/20 [02:00<02:40, 13.36s/it]
Task 7, Epoch 9/20 => Loss 0.152, Train_accy 96.02:  45%|████▌     | 9/20 [02:00<02:21, 12.90s/it]
Task 7, Epoch 10/20 => Loss 0.153, Train_accy 94.98, Test_accy 74.42:  45%|████▌     | 9/20 [02:26<02:21, 12.90s/it]
Task 7, Epoch 10/20 => Loss 0.153, Train_accy 94.98, Test_accy 74.42:  50%|█████     | 10/20 [02:26<02:49, 16.97s/it]
Task 7, Epoch 11/20 => Loss 0.133, Train_accy 96.12:  50%|█████     | 10/20 [02:38<02:49, 16.97s/it]                 
Task 7, Epoch 11/20 => Loss 0.133, Train_accy 96.12:  55%|█████▌    | 11/20 [02:38<02:18, 15.42s/it]
Task 7, Epoch 12/20 => Loss 0.175, Train_accy 94.41:  55%|█████▌    | 11/20 [02:50<02:18, 15.42s/it]
Task 7, Epoch 12/20 => Loss 0.175, Train_accy 94.41:  60%|██████    | 12/20 [02:50<01:54, 14.34s/it]
Task 7, Epoch 13/20 => Loss 0.146, Train_accy 96.40:  60%|██████    | 12/20 [03:02<01:54, 14.34s/it]
Task 7, Epoch 13/20 => Loss 0.146, Train_accy 96.40:  65%|██████▌   | 13/20 [03:02<01:35, 13.61s/it]
Task 7, Epoch 14/20 => Loss 0.118, Train_accy 96.21:  65%|██████▌   | 13/20 [03:14<01:35, 13.61s/it]
Task 7, Epoch 14/20 => Loss 0.118, Train_accy 96.21:  70%|███████   | 14/20 [03:14<01:18, 13.07s/it]
Task 7, Epoch 15/20 => Loss 0.140, Train_accy 95.74, Test_accy 74.46:  70%|███████   | 14/20 [03:40<01:18, 13.07s/it]
Task 7, Epoch 15/20 => Loss 0.140, Train_accy 95.74, Test_accy 74.46:  75%|███████▌  | 15/20 [03:40<01:25, 17.06s/it]
Task 7, Epoch 16/20 => Loss 0.114, Train_accy 96.88:  75%|███████▌  | 15/20 [03:52<01:25, 17.06s/it]                 
Task 7, Epoch 16/20 => Loss 0.114, Train_accy 96.88:  80%|████████  | 16/20 [03:52<01:01, 15.49s/it]
Task 7, Epoch 17/20 => Loss 0.111, Train_accy 96.97:  80%|████████  | 16/20 [04:04<01:01, 15.49s/it]
Task 7, Epoch 17/20 => Loss 0.111, Train_accy 96.97:  85%|████████▌ | 17/20 [04:04<00:43, 14.40s/it]
Task 7, Epoch 18/20 => Loss 0.115, Train_accy 96.78:  85%|████████▌ | 17/20 [04:16<00:43, 14.40s/it]
Task 7, Epoch 18/20 => Loss 0.115, Train_accy 96.78:  90%|█████████ | 18/20 [04:16<00:27, 13.62s/it]
Task 7, Epoch 19/20 => Loss 0.112, Train_accy 97.44:  90%|█████████ | 18/20 [04:27<00:27, 13.62s/it]
Task 7, Epoch 19/20 => Loss 0.112, Train_accy 97.44:  95%|█████████▌| 19/20 [04:27<00:13, 13.08s/it]
Task 7, Epoch 20/20 => Loss 0.119, Train_accy 96.31, Test_accy 74.58:  95%|█████████▌| 19/20 [04:53<00:13, 13.08s/it]
Task 7, Epoch 20/20 => Loss 0.119, Train_accy 96.31, Test_accy 74.58: 100%|██████████| 20/20 [04:53<00:00, 17.00s/it]
Task 7, Epoch 20/20 => Loss 0.119, Train_accy 96.31, Test_accy 74.58: 100%|██████████| 20/20 [04:53<00:00, 14.70s/it]
2024-09-08 02:48:31,705 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.119, Train_accy 96.31, Test_accy 74.58
2024-09-08 02:48:46,014 [trainer.py] => No NME accuracy.
2024-09-08 02:48:46,015 [trainer.py] => CNN: {'total': 74.58, '00-09': 78.55, '10-19': 82.8, '20-29': 74.0, '30-39': 82.53, '40-49': 65.89, '50-59': 68.09, '60-69': 69.8, '70-79': 71.79, 'old': 74.92, 'new': 71.79}
2024-09-08 02:48:46,015 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58]
2024-09-08 02:48:46,015 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71]

Average Accuracy (CNN): 80.46
2024-09-08 02:48:46,016 [trainer.py] => Average Accuracy (CNN): 80.46 

2024-09-08 02:48:46,017 [trainer.py] => All params: 89792456
2024-09-08 02:48:46,018 [trainer.py] => Trainable params: 89792456
2024-09-08 02:48:46,436 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.525, Train_accy 55.68:   0%|          | 0/20 [00:15<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.525, Train_accy 55.68:   5%|▌         | 1/20 [00:15<04:54, 15.48s/it]
Task 8, Epoch 2/20 => Loss 0.486, Train_accy 85.20:   5%|▌         | 1/20 [00:31<04:54, 15.48s/it]
Task 8, Epoch 2/20 => Loss 0.486, Train_accy 85.20:  10%|█         | 2/20 [00:31<04:39, 15.55s/it]
Task 8, Epoch 3/20 => Loss 0.374, Train_accy 88.00:  10%|█         | 2/20 [00:46<04:39, 15.55s/it]
Task 8, Epoch 3/20 => Loss 0.374, Train_accy 88.00:  15%|█▌        | 3/20 [00:46<04:23, 15.52s/it]
Task 8, Epoch 4/20 => Loss 0.332, Train_accy 89.22:  15%|█▌        | 3/20 [01:02<04:23, 15.52s/it]
Task 8, Epoch 4/20 => Loss 0.332, Train_accy 89.22:  20%|██        | 4/20 [01:02<04:08, 15.50s/it]
Task 8, Epoch 5/20 => Loss 0.290, Train_accy 91.24, Test_accy 72.29:  20%|██        | 4/20 [01:33<04:08, 15.50s/it]
Task 8, Epoch 5/20 => Loss 0.290, Train_accy 91.24, Test_accy 72.29:  25%|██▌       | 5/20 [01:33<05:18, 21.26s/it]
Task 8, Epoch 6/20 => Loss 0.247, Train_accy 91.74:  25%|██▌       | 5/20 [01:49<05:18, 21.26s/it]                 
Task 8, Epoch 6/20 => Loss 0.247, Train_accy 91.74:  30%|███       | 6/20 [01:49<04:30, 19.30s/it]
Task 8, Epoch 7/20 => Loss 0.236, Train_accy 92.67:  30%|███       | 6/20 [02:04<04:30, 19.30s/it]
Task 8, Epoch 7/20 => Loss 0.236, Train_accy 92.67:  35%|███▌      | 7/20 [02:04<03:54, 18.04s/it]
Task 8, Epoch 8/20 => Loss 0.208, Train_accy 94.40:  35%|███▌      | 7/20 [02:19<03:54, 18.04s/it]
Task 8, Epoch 8/20 => Loss 0.208, Train_accy 94.40:  40%|████      | 8/20 [02:19<03:26, 17.23s/it]
Task 8, Epoch 9/20 => Loss 0.218, Train_accy 92.96:  40%|████      | 8/20 [02:35<03:26, 17.23s/it]
Task 8, Epoch 9/20 => Loss 0.218, Train_accy 92.96:  45%|████▌     | 9/20 [02:35<03:03, 16.68s/it]
Task 8, Epoch 10/20 => Loss 0.208, Train_accy 93.18, Test_accy 72.79:  45%|████▌     | 9/20 [03:06<03:03, 16.68s/it]
Task 8, Epoch 10/20 => Loss 0.208, Train_accy 93.18, Test_accy 72.79:  50%|█████     | 10/20 [03:06<03:32, 21.23s/it]
Task 8, Epoch 11/20 => Loss 0.218, Train_accy 93.32:  50%|█████     | 10/20 [03:22<03:32, 21.23s/it]                 
Task 8, Epoch 11/20 => Loss 0.218, Train_accy 93.32:  55%|█████▌    | 11/20 [03:22<02:55, 19.48s/it]
Task 8, Epoch 12/20 => Loss 0.180, Train_accy 94.97:  55%|█████▌    | 11/20 [03:37<02:55, 19.48s/it]
Task 8, Epoch 12/20 => Loss 0.180, Train_accy 94.97:  60%|██████    | 12/20 [03:37<02:26, 18.26s/it]
Task 8, Epoch 13/20 => Loss 0.152, Train_accy 95.47:  60%|██████    | 12/20 [03:53<02:26, 18.26s/it]
Task 8, Epoch 13/20 => Loss 0.152, Train_accy 95.47:  65%|██████▌   | 13/20 [03:53<02:01, 17.42s/it]
Task 8, Epoch 14/20 => Loss 0.143, Train_accy 95.40:  65%|██████▌   | 13/20 [04:08<02:01, 17.42s/it]
Task 8, Epoch 14/20 => Loss 0.143, Train_accy 95.40:  70%|███████   | 14/20 [04:08<01:41, 16.84s/it]
Task 8, Epoch 15/20 => Loss 0.171, Train_accy 95.11, Test_accy 73.01:  70%|███████   | 14/20 [04:39<01:41, 16.84s/it]
Task 8, Epoch 15/20 => Loss 0.171, Train_accy 95.11, Test_accy 73.01:  75%|███████▌  | 15/20 [04:39<01:45, 21.14s/it]
Task 8, Epoch 16/20 => Loss 0.133, Train_accy 95.83:  75%|███████▌  | 15/20 [04:55<01:45, 21.14s/it]                 
Task 8, Epoch 16/20 => Loss 0.133, Train_accy 95.83:  80%|████████  | 16/20 [04:55<01:17, 19.45s/it]
Task 8, Epoch 17/20 => Loss 0.175, Train_accy 94.83:  80%|████████  | 16/20 [05:10<01:17, 19.45s/it]
Task 8, Epoch 17/20 => Loss 0.175, Train_accy 94.83:  85%|████████▌ | 17/20 [05:10<00:54, 18.25s/it]
Task 8, Epoch 18/20 => Loss 0.126, Train_accy 95.98:  85%|████████▌ | 17/20 [05:26<00:54, 18.25s/it]
Task 8, Epoch 18/20 => Loss 0.126, Train_accy 95.98:  90%|█████████ | 18/20 [05:26<00:34, 17.41s/it]
Task 8, Epoch 19/20 => Loss 0.164, Train_accy 95.11:  90%|█████████ | 18/20 [05:41<00:34, 17.41s/it]
Task 8, Epoch 19/20 => Loss 0.164, Train_accy 95.11:  95%|█████████▌| 19/20 [05:41<00:16, 16.83s/it]
Task 8, Epoch 20/20 => Loss 0.139, Train_accy 95.47, Test_accy 73.18:  95%|█████████▌| 19/20 [06:13<00:16, 16.83s/it]
Task 8, Epoch 20/20 => Loss 0.139, Train_accy 95.47, Test_accy 73.18: 100%|██████████| 20/20 [06:13<00:00, 21.20s/it]
Task 8, Epoch 20/20 => Loss 0.139, Train_accy 95.47, Test_accy 73.18: 100%|██████████| 20/20 [06:13<00:00, 18.66s/it]
2024-09-08 02:54:59,637 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.139, Train_accy 95.47, Test_accy 73.18
2024-09-08 02:55:15,533 [trainer.py] => No NME accuracy.
2024-09-08 02:55:15,533 [trainer.py] => CNN: {'total': 73.18, '00-09': 79.5, '10-19': 82.53, '20-29': 73.0, '30-39': 82.53, '40-49': 65.23, '50-59': 67.43, '60-69': 68.46, '70-79': 72.16, '80-89': 64.52, 'old': 74.26, 'new': 64.52}
2024-09-08 02:55:15,534 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18]
2024-09-08 02:55:15,534 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39]

Average Accuracy (CNN): 79.66
2024-09-08 02:55:15,534 [trainer.py] => Average Accuracy (CNN): 79.66 

2024-09-08 02:55:15,535 [trainer.py] => All params: 89792456
2024-09-08 02:55:15,536 [trainer.py] => Trainable params: 89792456
2024-09-08 02:55:15,996 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.898, Train_accy 41.67:   0%|          | 0/20 [00:08<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.898, Train_accy 41.67:   5%|▌         | 1/20 [00:08<02:37,  8.31s/it]
Task 9, Epoch 2/20 => Loss 0.587, Train_accy 81.67:   5%|▌         | 1/20 [00:16<02:37,  8.31s/it]
Task 9, Epoch 2/20 => Loss 0.587, Train_accy 81.67:  10%|█         | 2/20 [00:16<02:28,  8.22s/it]
Task 9, Epoch 3/20 => Loss 0.440, Train_accy 86.25:  10%|█         | 2/20 [00:24<02:28,  8.22s/it]
Task 9, Epoch 3/20 => Loss 0.440, Train_accy 86.25:  15%|█▌        | 3/20 [00:24<02:19,  8.20s/it]
Task 9, Epoch 4/20 => Loss 0.315, Train_accy 90.56:  15%|█▌        | 3/20 [00:32<02:19,  8.20s/it]
Task 9, Epoch 4/20 => Loss 0.315, Train_accy 90.56:  20%|██        | 4/20 [00:32<02:11,  8.20s/it]
Task 9, Epoch 5/20 => Loss 0.268, Train_accy 92.22, Test_accy 71.56:  20%|██        | 4/20 [00:57<02:11,  8.20s/it]
Task 9, Epoch 5/20 => Loss 0.268, Train_accy 92.22, Test_accy 71.56:  25%|██▌       | 5/20 [00:57<03:34, 14.31s/it]
Task 9, Epoch 6/20 => Loss 0.278, Train_accy 91.11:  25%|██▌       | 5/20 [01:06<03:34, 14.31s/it]                 
Task 9, Epoch 6/20 => Loss 0.278, Train_accy 91.11:  30%|███       | 6/20 [01:06<02:51, 12.24s/it]
Task 9, Epoch 7/20 => Loss 0.257, Train_accy 92.22:  30%|███       | 6/20 [01:14<02:51, 12.24s/it]
Task 9, Epoch 7/20 => Loss 0.257, Train_accy 92.22:  35%|███▌      | 7/20 [01:14<02:22, 10.98s/it]
Task 9, Epoch 8/20 => Loss 0.201, Train_accy 93.33:  35%|███▌      | 7/20 [01:22<02:22, 10.98s/it]
Task 9, Epoch 8/20 => Loss 0.201, Train_accy 93.33:  40%|████      | 8/20 [01:22<02:01, 10.09s/it]
Task 9, Epoch 9/20 => Loss 0.181, Train_accy 94.31:  40%|████      | 8/20 [01:30<02:01, 10.09s/it]
Task 9, Epoch 9/20 => Loss 0.181, Train_accy 94.31:  45%|████▌     | 9/20 [01:30<01:44,  9.50s/it]
Task 9, Epoch 10/20 => Loss 0.212, Train_accy 92.92, Test_accy 72.19:  45%|████▌     | 9/20 [01:56<01:44,  9.50s/it]
Task 9, Epoch 10/20 => Loss 0.212, Train_accy 92.92, Test_accy 72.19:  50%|█████     | 10/20 [01:56<02:23, 14.33s/it]
Task 9, Epoch 11/20 => Loss 0.158, Train_accy 95.42:  50%|█████     | 10/20 [02:04<02:23, 14.33s/it]                 
Task 9, Epoch 11/20 => Loss 0.158, Train_accy 95.42:  55%|█████▌    | 11/20 [02:04<01:52, 12.45s/it]
Task 9, Epoch 12/20 => Loss 0.152, Train_accy 94.86:  55%|█████▌    | 11/20 [02:12<01:52, 12.45s/it]
Task 9, Epoch 12/20 => Loss 0.152, Train_accy 94.86:  60%|██████    | 12/20 [02:12<01:29, 11.15s/it]
Task 9, Epoch 13/20 => Loss 0.150, Train_accy 95.83:  60%|██████    | 12/20 [02:20<01:29, 11.15s/it]
Task 9, Epoch 13/20 => Loss 0.150, Train_accy 95.83:  65%|██████▌   | 13/20 [02:20<01:11, 10.26s/it]
Task 9, Epoch 14/20 => Loss 0.135, Train_accy 96.25:  65%|██████▌   | 13/20 [02:28<01:11, 10.26s/it]
Task 9, Epoch 14/20 => Loss 0.135, Train_accy 96.25:  70%|███████   | 14/20 [02:28<00:57,  9.65s/it]
Task 9, Epoch 15/20 => Loss 0.147, Train_accy 95.83, Test_accy 72.13:  70%|███████   | 14/20 [02:54<00:57,  9.65s/it]
Task 9, Epoch 15/20 => Loss 0.147, Train_accy 95.83, Test_accy 72.13:  75%|███████▌  | 15/20 [02:54<01:11, 14.34s/it]
Task 9, Epoch 16/20 => Loss 0.130, Train_accy 95.97:  75%|███████▌  | 15/20 [03:02<01:11, 14.34s/it]                 
Task 9, Epoch 16/20 => Loss 0.130, Train_accy 95.97:  80%|████████  | 16/20 [03:02<00:50, 12.54s/it]
Task 9, Epoch 17/20 => Loss 0.184, Train_accy 94.72:  80%|████████  | 16/20 [03:10<00:50, 12.54s/it]
Task 9, Epoch 17/20 => Loss 0.184, Train_accy 94.72:  85%|████████▌ | 17/20 [03:10<00:33, 11.24s/it]
Task 9, Epoch 18/20 => Loss 0.145, Train_accy 95.56:  85%|████████▌ | 17/20 [03:18<00:33, 11.24s/it]
Task 9, Epoch 18/20 => Loss 0.145, Train_accy 95.56:  90%|█████████ | 18/20 [03:18<00:20, 10.33s/it]
Task 9, Epoch 19/20 => Loss 0.148, Train_accy 96.25:  90%|█████████ | 18/20 [03:27<00:20, 10.33s/it]
Task 9, Epoch 19/20 => Loss 0.148, Train_accy 96.25:  95%|█████████▌| 19/20 [03:27<00:09,  9.70s/it]
Task 9, Epoch 20/20 => Loss 0.167, Train_accy 94.31, Test_accy 72.16:  95%|█████████▌| 19/20 [03:52<00:09,  9.70s/it]
Task 9, Epoch 20/20 => Loss 0.167, Train_accy 94.31, Test_accy 72.16: 100%|██████████| 20/20 [03:52<00:00, 14.33s/it]
Task 9, Epoch 20/20 => Loss 0.167, Train_accy 94.31, Test_accy 72.16: 100%|██████████| 20/20 [03:52<00:00, 11.61s/it]
2024-09-08 02:59:08,291 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.167, Train_accy 94.31, Test_accy 72.16
2024-09-08 02:59:25,246 [trainer.py] => No NME accuracy.
2024-09-08 02:59:25,247 [trainer.py] => CNN: {'total': 72.16, '00-09': 79.18, '10-19': 81.72, '20-29': 73.0, '30-39': 82.83, '40-49': 65.23, '50-59': 67.43, '60-69': 68.46, '70-79': 71.43, '80-89': 65.16, '90-99': 57.63, 'old': 73.08, 'new': 57.63}
2024-09-08 02:59:25,247 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16]
2024-09-08 02:59:25,247 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74]

Average Accuracy (CNN): 78.91
2024-09-08 02:59:25,248 [trainer.py] => Average Accuracy (CNN): 78.91 

2024-09-08 02:59:25,249 [trainer.py] => All params: 89792456
2024-09-08 02:59:25,251 [trainer.py] => Trainable params: 89792456
2024-09-08 02:59:25,768 [coda_prompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.317, Train_accy 59.29:   0%|          | 0/20 [00:12<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.317, Train_accy 59.29:   5%|▌         | 1/20 [00:12<04:04, 12.86s/it]
Task 10, Epoch 2/20 => Loss 0.482, Train_accy 85.68:   5%|▌         | 1/20 [00:25<04:04, 12.86s/it]
Task 10, Epoch 2/20 => Loss 0.482, Train_accy 85.68:  10%|█         | 2/20 [00:25<03:52, 12.90s/it]
Task 10, Epoch 3/20 => Loss 0.329, Train_accy 89.24:  10%|█         | 2/20 [00:38<03:52, 12.90s/it]
Task 10, Epoch 3/20 => Loss 0.329, Train_accy 89.24:  15%|█▌        | 3/20 [00:38<03:39, 12.90s/it]
Task 10, Epoch 4/20 => Loss 0.269, Train_accy 91.32:  15%|█▌        | 3/20 [00:51<03:39, 12.90s/it]
Task 10, Epoch 4/20 => Loss 0.269, Train_accy 91.32:  20%|██        | 4/20 [00:51<03:26, 12.91s/it]
Task 10, Epoch 5/20 => Loss 0.214, Train_accy 93.92, Test_accy 71.15:  20%|██        | 4/20 [01:23<03:26, 12.91s/it]
Task 10, Epoch 5/20 => Loss 0.214, Train_accy 93.92, Test_accy 71.15:  25%|██▌       | 5/20 [01:23<04:54, 19.60s/it]
Task 10, Epoch 6/20 => Loss 0.229, Train_accy 93.23:  25%|██▌       | 5/20 [01:36<04:54, 19.60s/it]                 
Task 10, Epoch 6/20 => Loss 0.229, Train_accy 93.23:  30%|███       | 6/20 [01:36<04:02, 17.34s/it]
Task 10, Epoch 7/20 => Loss 0.196, Train_accy 93.66:  30%|███       | 6/20 [01:48<04:02, 17.34s/it]
Task 10, Epoch 7/20 => Loss 0.196, Train_accy 93.66:  35%|███▌      | 7/20 [01:48<03:26, 15.88s/it]
Task 10, Epoch 8/20 => Loss 0.192, Train_accy 93.75:  35%|███▌      | 7/20 [02:01<03:26, 15.88s/it]
Task 10, Epoch 8/20 => Loss 0.192, Train_accy 93.75:  40%|████      | 8/20 [02:01<02:59, 14.93s/it]
Task 10, Epoch 9/20 => Loss 0.181, Train_accy 94.79:  40%|████      | 8/20 [02:14<02:59, 14.93s/it]
Task 10, Epoch 9/20 => Loss 0.181, Train_accy 94.79:  45%|████▌     | 9/20 [02:14<02:37, 14.29s/it]
Task 10, Epoch 10/20 => Loss 0.139, Train_accy 95.92, Test_accy 71.28:  45%|████▌     | 9/20 [02:46<02:37, 14.29s/it]
Task 10, Epoch 10/20 => Loss 0.139, Train_accy 95.92, Test_accy 71.28:  50%|█████     | 10/20 [02:46<03:15, 19.60s/it]
Task 10, Epoch 11/20 => Loss 0.155, Train_accy 95.23:  50%|█████     | 10/20 [02:59<03:15, 19.60s/it]                 
Task 10, Epoch 11/20 => Loss 0.155, Train_accy 95.23:  55%|█████▌    | 11/20 [02:59<02:37, 17.55s/it]
Task 10, Epoch 12/20 => Loss 0.118, Train_accy 96.09:  55%|█████▌    | 11/20 [03:12<02:37, 17.55s/it]
Task 10, Epoch 12/20 => Loss 0.118, Train_accy 96.09:  60%|██████    | 12/20 [03:12<02:09, 16.16s/it]
Task 10, Epoch 13/20 => Loss 0.130, Train_accy 95.57:  60%|██████    | 12/20 [03:24<02:09, 16.16s/it]
Task 10, Epoch 13/20 => Loss 0.130, Train_accy 95.57:  65%|██████▌   | 13/20 [03:24<01:46, 15.16s/it]
Task 10, Epoch 14/20 => Loss 0.118, Train_accy 96.53:  65%|██████▌   | 13/20 [03:37<01:46, 15.16s/it]
Task 10, Epoch 14/20 => Loss 0.118, Train_accy 96.53:  70%|███████   | 14/20 [03:37<01:26, 14.47s/it]
Task 10, Epoch 15/20 => Loss 0.112, Train_accy 96.79, Test_accy 71.43:  70%|███████   | 14/20 [04:09<01:26, 14.47s/it]
Task 10, Epoch 15/20 => Loss 0.112, Train_accy 96.79, Test_accy 71.43:  75%|███████▌  | 15/20 [04:09<01:37, 19.59s/it]
Task 10, Epoch 16/20 => Loss 0.109, Train_accy 97.31:  75%|███████▌  | 15/20 [04:22<01:37, 19.59s/it]                 
Task 10, Epoch 16/20 => Loss 0.109, Train_accy 97.31:  80%|████████  | 16/20 [04:22<01:10, 17.57s/it]
Task 10, Epoch 17/20 => Loss 0.138, Train_accy 96.09:  80%|████████  | 16/20 [04:35<01:10, 17.57s/it]
Task 10, Epoch 17/20 => Loss 0.138, Train_accy 96.09:  85%|████████▌ | 17/20 [04:35<00:48, 16.18s/it]
Task 10, Epoch 18/20 => Loss 0.128, Train_accy 96.53:  85%|████████▌ | 17/20 [04:47<00:48, 16.18s/it]
Task 10, Epoch 18/20 => Loss 0.128, Train_accy 96.53:  90%|█████████ | 18/20 [04:47<00:30, 15.20s/it]
Task 10, Epoch 19/20 => Loss 0.096, Train_accy 97.05:  90%|█████████ | 18/20 [05:00<00:30, 15.20s/it]
Task 10, Epoch 19/20 => Loss 0.096, Train_accy 97.05:  95%|█████████▌| 19/20 [05:00<00:14, 14.51s/it]
Task 10, Epoch 20/20 => Loss 0.115, Train_accy 96.27, Test_accy 71.52:  95%|█████████▌| 19/20 [05:32<00:14, 14.51s/it]
Task 10, Epoch 20/20 => Loss 0.115, Train_accy 96.27, Test_accy 71.52: 100%|██████████| 20/20 [05:32<00:00, 19.58s/it]
Task 10, Epoch 20/20 => Loss 0.115, Train_accy 96.27, Test_accy 71.52: 100%|██████████| 20/20 [05:32<00:00, 16.61s/it]
2024-09-08 03:04:58,072 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.115, Train_accy 96.27, Test_accy 71.52
2024-09-08 03:05:16,519 [trainer.py] => No NME accuracy.
2024-09-08 03:05:16,520 [trainer.py] => CNN: {'total': 71.52, '00-09': 79.18, '10-19': 80.65, '20-29': 72.0, '30-39': 82.23, '40-49': 63.25, '50-59': 67.11, '60-69': 69.13, '70-79': 71.06, '80-89': 63.87, '90-99': 57.06, '100-109': 71.83, 'old': 71.49, 'new': 71.83}
2024-09-08 03:05:16,520 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52]
2024-09-08 03:05:16,520 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68]

Average Accuracy (CNN): 78.23
2024-09-08 03:05:16,520 [trainer.py] => Average Accuracy (CNN): 78.23 

2024-09-08 03:05:16,522 [trainer.py] => All params: 89792456
2024-09-08 03:05:16,524 [trainer.py] => Trainable params: 89792456
2024-09-08 03:05:17,082 [coda_prompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.214, Train_accy 63.78:   0%|          | 0/20 [00:16<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.214, Train_accy 63.78:   5%|▌         | 1/20 [00:16<05:13, 16.53s/it]
Task 11, Epoch 2/20 => Loss 0.368, Train_accy 88.31:   5%|▌         | 1/20 [00:33<05:13, 16.53s/it]
Task 11, Epoch 2/20 => Loss 0.368, Train_accy 88.31:  10%|█         | 2/20 [00:33<04:57, 16.53s/it]
Task 11, Epoch 3/20 => Loss 0.338, Train_accy 88.24:  10%|█         | 2/20 [00:49<04:57, 16.53s/it]
Task 11, Epoch 3/20 => Loss 0.338, Train_accy 88.24:  15%|█▌        | 3/20 [00:49<04:42, 16.59s/it]
Task 11, Epoch 4/20 => Loss 0.258, Train_accy 92.20:  15%|█▌        | 3/20 [01:06<04:42, 16.59s/it]
Task 11, Epoch 4/20 => Loss 0.258, Train_accy 92.20:  20%|██        | 4/20 [01:06<04:25, 16.58s/it]
Task 11, Epoch 5/20 => Loss 0.240, Train_accy 92.07, Test_accy 70.62:  20%|██        | 4/20 [01:43<04:25, 16.58s/it]
Task 11, Epoch 5/20 => Loss 0.240, Train_accy 92.07, Test_accy 70.62:  25%|██▌       | 5/20 [01:43<05:59, 24.00s/it]
Task 11, Epoch 6/20 => Loss 0.210, Train_accy 93.82:  25%|██▌       | 5/20 [01:59<05:59, 24.00s/it]                 
Task 11, Epoch 6/20 => Loss 0.210, Train_accy 93.82:  30%|███       | 6/20 [01:59<05:00, 21.45s/it]
Task 11, Epoch 7/20 => Loss 0.180, Train_accy 94.09:  30%|███       | 6/20 [02:16<05:00, 21.45s/it]
Task 11, Epoch 7/20 => Loss 0.180, Train_accy 94.09:  35%|███▌      | 7/20 [02:16<04:17, 19.84s/it]
Task 11, Epoch 8/20 => Loss 0.180, Train_accy 94.42:  35%|███▌      | 7/20 [02:32<04:17, 19.84s/it]
Task 11, Epoch 8/20 => Loss 0.180, Train_accy 94.42:  40%|████      | 8/20 [02:32<03:45, 18.78s/it]
Task 11, Epoch 9/20 => Loss 0.145, Train_accy 95.83:  40%|████      | 8/20 [02:49<03:45, 18.78s/it]
Task 11, Epoch 9/20 => Loss 0.145, Train_accy 95.83:  45%|████▌     | 9/20 [02:49<03:18, 18.07s/it]
Task 11, Epoch 10/20 => Loss 0.133, Train_accy 96.44, Test_accy 71.25:  45%|████▌     | 9/20 [03:26<03:18, 18.07s/it]
Task 11, Epoch 10/20 => Loss 0.133, Train_accy 96.44, Test_accy 71.25:  50%|█████     | 10/20 [03:26<03:59, 23.98s/it]
Task 11, Epoch 11/20 => Loss 0.156, Train_accy 95.23:  50%|█████     | 10/20 [03:43<03:59, 23.98s/it]                 
Task 11, Epoch 11/20 => Loss 0.156, Train_accy 95.23:  55%|█████▌    | 11/20 [03:43<03:15, 21.70s/it]
Task 11, Epoch 12/20 => Loss 0.142, Train_accy 96.03:  55%|█████▌    | 11/20 [03:59<03:15, 21.70s/it]
Task 11, Epoch 12/20 => Loss 0.142, Train_accy 96.03:  60%|██████    | 12/20 [03:59<02:41, 20.13s/it]
Task 11, Epoch 13/20 => Loss 0.120, Train_accy 95.83:  60%|██████    | 12/20 [04:16<02:41, 20.13s/it]
Task 11, Epoch 13/20 => Loss 0.120, Train_accy 95.83:  65%|██████▌   | 13/20 [04:16<02:13, 19.05s/it]
Task 11, Epoch 14/20 => Loss 0.120, Train_accy 96.51:  65%|██████▌   | 13/20 [04:32<02:13, 19.05s/it]
Task 11, Epoch 14/20 => Loss 0.120, Train_accy 96.51:  70%|███████   | 14/20 [04:32<01:49, 18.28s/it]
Task 11, Epoch 15/20 => Loss 0.132, Train_accy 95.83, Test_accy 71.17:  70%|███████   | 14/20 [05:10<01:49, 18.28s/it]
Task 11, Epoch 15/20 => Loss 0.132, Train_accy 95.83, Test_accy 71.17:  75%|███████▌  | 15/20 [05:10<01:59, 23.99s/it]
Task 11, Epoch 16/20 => Loss 0.122, Train_accy 96.30:  75%|███████▌  | 15/20 [05:26<01:59, 23.99s/it]                 
Task 11, Epoch 16/20 => Loss 0.122, Train_accy 96.30:  80%|████████  | 16/20 [05:26<01:26, 21.73s/it]
Task 11, Epoch 17/20 => Loss 0.150, Train_accy 95.50:  80%|████████  | 16/20 [05:43<01:26, 21.73s/it]
Task 11, Epoch 17/20 => Loss 0.150, Train_accy 95.50:  85%|████████▌ | 17/20 [05:43<01:00, 20.17s/it]
Task 11, Epoch 18/20 => Loss 0.124, Train_accy 96.17:  85%|████████▌ | 17/20 [05:59<01:00, 20.17s/it]
Task 11, Epoch 18/20 => Loss 0.124, Train_accy 96.17:  90%|█████████ | 18/20 [05:59<00:38, 19.09s/it]
Task 11, Epoch 19/20 => Loss 0.118, Train_accy 96.51:  90%|█████████ | 18/20 [06:16<00:38, 19.09s/it]
Task 11, Epoch 19/20 => Loss 0.118, Train_accy 96.51:  95%|█████████▌| 19/20 [06:16<00:18, 18.35s/it]
Task 11, Epoch 20/20 => Loss 0.111, Train_accy 96.64, Test_accy 71.25:  95%|█████████▌| 19/20 [06:53<00:18, 18.35s/it]
Task 11, Epoch 20/20 => Loss 0.111, Train_accy 96.64, Test_accy 71.25: 100%|██████████| 20/20 [06:53<00:00, 24.01s/it]
Task 11, Epoch 20/20 => Loss 0.111, Train_accy 96.64, Test_accy 71.25: 100%|██████████| 20/20 [06:53<00:00, 20.67s/it]
2024-09-08 03:12:10,579 [coda_prompt.py] => Task 11, Epoch 20/20 => Loss 0.111, Train_accy 96.64, Test_accy 71.25
2024-09-08 03:12:31,186 [trainer.py] => No NME accuracy.
2024-09-08 03:12:31,187 [trainer.py] => CNN: {'total': 71.25, '00-09': 77.6, '10-19': 79.03, '20-29': 72.67, '30-39': 81.93, '40-49': 63.58, '50-59': 66.78, '60-69': 69.46, '70-79': 69.96, '80-89': 63.87, '90-99': 58.19, '100-109': 70.42, '110-119': 72.61, 'old': 71.09, 'new': 72.61}
2024-09-08 03:12:31,187 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25]
2024-09-08 03:12:31,187 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2]

Average Accuracy (CNN): 77.65
2024-09-08 03:12:31,187 [trainer.py] => Average Accuracy (CNN): 77.65 

2024-09-08 03:12:31,188 [trainer.py] => All params: 89792456
2024-09-08 03:12:31,189 [trainer.py] => Trainable params: 89792456
2024-09-08 03:12:31,828 [coda_prompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.733, Train_accy 48.44:   0%|          | 0/20 [00:10<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.733, Train_accy 48.44:   5%|▌         | 1/20 [00:10<03:26, 10.86s/it]
Task 12, Epoch 2/20 => Loss 0.511, Train_accy 85.21:   5%|▌         | 1/20 [00:21<03:26, 10.86s/it]
Task 12, Epoch 2/20 => Loss 0.511, Train_accy 85.21:  10%|█         | 2/20 [00:21<03:15, 10.86s/it]
Task 12, Epoch 3/20 => Loss 0.356, Train_accy 88.12:  10%|█         | 2/20 [00:32<03:15, 10.86s/it]
Task 12, Epoch 3/20 => Loss 0.356, Train_accy 88.12:  15%|█▌        | 3/20 [00:32<03:04, 10.86s/it]
Task 12, Epoch 4/20 => Loss 0.275, Train_accy 91.35:  15%|█▌        | 3/20 [00:43<03:04, 10.86s/it]
Task 12, Epoch 4/20 => Loss 0.275, Train_accy 91.35:  20%|██        | 4/20 [00:43<02:53, 10.85s/it]
Task 12, Epoch 5/20 => Loss 0.238, Train_accy 93.23, Test_accy 69.89:  20%|██        | 4/20 [01:16<02:53, 10.85s/it]
Task 12, Epoch 5/20 => Loss 0.238, Train_accy 93.23, Test_accy 69.89:  25%|██▌       | 5/20 [01:16<04:41, 18.80s/it]
Task 12, Epoch 6/20 => Loss 0.213, Train_accy 93.12:  25%|██▌       | 5/20 [01:27<04:41, 18.80s/it]                 
Task 12, Epoch 6/20 => Loss 0.213, Train_accy 93.12:  30%|███       | 6/20 [01:27<03:45, 16.09s/it]
Task 12, Epoch 7/20 => Loss 0.194, Train_accy 94.27:  30%|███       | 6/20 [01:37<03:45, 16.09s/it]
Task 12, Epoch 7/20 => Loss 0.194, Train_accy 94.27:  35%|███▌      | 7/20 [01:37<03:06, 14.35s/it]
Task 12, Epoch 8/20 => Loss 0.148, Train_accy 95.21:  35%|███▌      | 7/20 [01:48<03:06, 14.35s/it]
Task 12, Epoch 8/20 => Loss 0.148, Train_accy 95.21:  40%|████      | 8/20 [01:48<02:38, 13.22s/it]
Task 12, Epoch 9/20 => Loss 0.148, Train_accy 95.94:  40%|████      | 8/20 [01:59<02:38, 13.22s/it]
Task 12, Epoch 9/20 => Loss 0.148, Train_accy 95.94:  45%|████▌     | 9/20 [01:59<02:17, 12.51s/it]
Task 12, Epoch 10/20 => Loss 0.162, Train_accy 95.83, Test_accy 69.94:  45%|████▌     | 9/20 [02:32<02:17, 12.51s/it]
Task 12, Epoch 10/20 => Loss 0.162, Train_accy 95.83, Test_accy 69.94:  50%|█████     | 10/20 [02:32<03:08, 18.85s/it]
Task 12, Epoch 11/20 => Loss 0.123, Train_accy 96.25:  50%|█████     | 10/20 [02:43<03:08, 18.85s/it]                 
Task 12, Epoch 11/20 => Loss 0.123, Train_accy 96.25:  55%|█████▌    | 11/20 [02:43<02:27, 16.40s/it]
Task 12, Epoch 12/20 => Loss 0.159, Train_accy 95.83:  55%|█████▌    | 11/20 [02:54<02:27, 16.40s/it]
Task 12, Epoch 12/20 => Loss 0.159, Train_accy 95.83:  60%|██████    | 12/20 [02:54<01:57, 14.70s/it]
Task 12, Epoch 13/20 => Loss 0.147, Train_accy 95.42:  60%|██████    | 12/20 [03:05<01:57, 14.70s/it]
Task 12, Epoch 13/20 => Loss 0.147, Train_accy 95.42:  65%|██████▌   | 13/20 [03:05<01:34, 13.52s/it]
Task 12, Epoch 14/20 => Loss 0.151, Train_accy 94.69:  65%|██████▌   | 13/20 [03:16<01:34, 13.52s/it]
Task 12, Epoch 14/20 => Loss 0.151, Train_accy 94.69:  70%|███████   | 14/20 [03:16<01:16, 12.75s/it]
Task 12, Epoch 15/20 => Loss 0.133, Train_accy 96.15, Test_accy 70.38:  70%|███████   | 14/20 [03:49<01:16, 12.75s/it]
Task 12, Epoch 15/20 => Loss 0.133, Train_accy 96.15, Test_accy 70.38:  75%|███████▌  | 15/20 [03:49<01:34, 18.85s/it]
Task 12, Epoch 16/20 => Loss 0.111, Train_accy 96.77:  75%|███████▌  | 15/20 [04:00<01:34, 18.85s/it]                 
Task 12, Epoch 16/20 => Loss 0.111, Train_accy 96.77:  80%|████████  | 16/20 [04:00<01:05, 16.46s/it]
Task 12, Epoch 17/20 => Loss 0.119, Train_accy 96.46:  80%|████████  | 16/20 [04:10<01:05, 16.46s/it]
Task 12, Epoch 17/20 => Loss 0.119, Train_accy 96.46:  85%|████████▌ | 17/20 [04:10<00:44, 14.76s/it]
Task 12, Epoch 18/20 => Loss 0.108, Train_accy 96.56:  85%|████████▌ | 17/20 [04:21<00:44, 14.76s/it]
Task 12, Epoch 18/20 => Loss 0.108, Train_accy 96.56:  90%|█████████ | 18/20 [04:21<00:27, 13.60s/it]
Task 12, Epoch 19/20 => Loss 0.128, Train_accy 95.42:  90%|█████████ | 18/20 [04:32<00:27, 13.60s/it]
Task 12, Epoch 19/20 => Loss 0.128, Train_accy 95.42:  95%|█████████▌| 19/20 [04:32<00:12, 12.77s/it]
Task 12, Epoch 20/20 => Loss 0.097, Train_accy 97.40, Test_accy 70.28:  95%|█████████▌| 19/20 [05:05<00:12, 12.77s/it]
Task 12, Epoch 20/20 => Loss 0.097, Train_accy 97.40, Test_accy 70.28: 100%|██████████| 20/20 [05:05<00:00, 18.82s/it]
Task 12, Epoch 20/20 => Loss 0.097, Train_accy 97.40, Test_accy 70.28: 100%|██████████| 20/20 [05:05<00:00, 15.28s/it]
2024-09-08 03:17:37,337 [coda_prompt.py] => Task 12, Epoch 20/20 => Loss 0.097, Train_accy 97.40, Test_accy 70.28
2024-09-08 03:17:59,474 [trainer.py] => No NME accuracy.
2024-09-08 03:17:59,475 [trainer.py] => CNN: {'total': 70.28, '00-09': 79.18, '10-19': 79.03, '20-29': 71.67, '30-39': 81.93, '40-49': 63.58, '50-59': 64.8, '60-69': 68.12, '70-79': 70.33, '80-89': 62.9, '90-99': 57.06, '100-109': 70.77, '110-119': 73.14, '120-129': 60.52, 'old': 71.0, 'new': 60.52}
2024-09-08 03:17:59,475 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28]
2024-09-08 03:17:59,475 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82]

Average Accuracy (CNN): 77.09
2024-09-08 03:17:59,475 [trainer.py] => Average Accuracy (CNN): 77.09 

2024-09-08 03:17:59,475 [trainer.py] => All params: 89792456
2024-09-08 03:17:59,476 [trainer.py] => Trainable params: 89792456
2024-09-08 03:18:00,127 [coda_prompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.524, Train_accy 55.38:   0%|          | 0/20 [00:12<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.524, Train_accy 55.38:   5%|▌         | 1/20 [00:12<04:06, 12.96s/it]
Task 13, Epoch 2/20 => Loss 0.428, Train_accy 87.24:   5%|▌         | 1/20 [00:25<04:06, 12.96s/it]
Task 13, Epoch 2/20 => Loss 0.428, Train_accy 87.24:  10%|█         | 2/20 [00:25<03:52, 12.94s/it]
Task 13, Epoch 3/20 => Loss 0.309, Train_accy 90.19:  10%|█         | 2/20 [00:38<03:52, 12.94s/it]
Task 13, Epoch 3/20 => Loss 0.309, Train_accy 90.19:  15%|█▌        | 3/20 [00:38<03:39, 12.93s/it]
Task 13, Epoch 4/20 => Loss 0.256, Train_accy 92.01:  15%|█▌        | 3/20 [00:51<03:39, 12.93s/it]
Task 13, Epoch 4/20 => Loss 0.256, Train_accy 92.01:  20%|██        | 4/20 [00:51<03:26, 12.92s/it]
Task 13, Epoch 5/20 => Loss 0.214, Train_accy 93.32, Test_accy 69.79:  20%|██        | 4/20 [01:28<03:26, 12.92s/it]
Task 13, Epoch 5/20 => Loss 0.214, Train_accy 93.32, Test_accy 69.79:  25%|██▌       | 5/20 [01:28<05:22, 21.48s/it]
Task 13, Epoch 6/20 => Loss 0.186, Train_accy 94.44:  25%|██▌       | 5/20 [01:41<05:22, 21.48s/it]                 
Task 13, Epoch 6/20 => Loss 0.186, Train_accy 94.44:  30%|███       | 6/20 [01:41<04:19, 18.57s/it]
Task 13, Epoch 7/20 => Loss 0.199, Train_accy 94.62:  30%|███       | 6/20 [01:54<04:19, 18.57s/it]
Task 13, Epoch 7/20 => Loss 0.199, Train_accy 94.62:  35%|███▌      | 7/20 [01:54<03:37, 16.75s/it]
Task 13, Epoch 8/20 => Loss 0.169, Train_accy 94.88:  35%|███▌      | 7/20 [02:07<03:37, 16.75s/it]
Task 13, Epoch 8/20 => Loss 0.169, Train_accy 94.88:  40%|████      | 8/20 [02:07<03:06, 15.55s/it]
Task 13, Epoch 9/20 => Loss 0.135, Train_accy 96.27:  40%|████      | 8/20 [02:20<03:06, 15.55s/it]
Task 13, Epoch 9/20 => Loss 0.135, Train_accy 96.27:  45%|████▌     | 9/20 [02:20<02:41, 14.72s/it]
Task 13, Epoch 10/20 => Loss 0.111, Train_accy 97.48, Test_accy 70.27:  45%|████▌     | 9/20 [02:56<02:41, 14.72s/it]
Task 13, Epoch 10/20 => Loss 0.111, Train_accy 97.48, Test_accy 70.27:  50%|█████     | 10/20 [02:56<03:35, 21.52s/it]
Task 13, Epoch 11/20 => Loss 0.111, Train_accy 97.40:  50%|█████     | 10/20 [03:09<03:35, 21.52s/it]                 
Task 13, Epoch 11/20 => Loss 0.111, Train_accy 97.40:  55%|█████▌    | 11/20 [03:09<02:50, 18.91s/it]
Task 13, Epoch 12/20 => Loss 0.132, Train_accy 96.18:  55%|█████▌    | 11/20 [03:22<02:50, 18.91s/it]
Task 13, Epoch 12/20 => Loss 0.132, Train_accy 96.18:  60%|██████    | 12/20 [03:22<02:16, 17.08s/it]
Task 13, Epoch 13/20 => Loss 0.125, Train_accy 97.14:  60%|██████    | 12/20 [03:35<02:16, 17.08s/it]
Task 13, Epoch 13/20 => Loss 0.125, Train_accy 97.14:  65%|██████▌   | 13/20 [03:35<01:50, 15.82s/it]
Task 13, Epoch 14/20 => Loss 0.108, Train_accy 96.79:  65%|██████▌   | 13/20 [03:48<01:50, 15.82s/it]
Task 13, Epoch 14/20 => Loss 0.108, Train_accy 96.79:  70%|███████   | 14/20 [03:48<01:29, 14.95s/it]
Task 13, Epoch 15/20 => Loss 0.141, Train_accy 95.66, Test_accy 70.38:  70%|███████   | 14/20 [04:25<01:29, 14.95s/it]
Task 13, Epoch 15/20 => Loss 0.141, Train_accy 95.66, Test_accy 70.38:  75%|███████▌  | 15/20 [04:25<01:47, 21.46s/it]
Task 13, Epoch 16/20 => Loss 0.096, Train_accy 97.48:  75%|███████▌  | 15/20 [04:38<01:47, 21.46s/it]                 
Task 13, Epoch 16/20 => Loss 0.096, Train_accy 97.48:  80%|████████  | 16/20 [04:38<01:15, 18.89s/it]
Task 13, Epoch 17/20 => Loss 0.100, Train_accy 97.05:  80%|████████  | 16/20 [04:51<01:15, 18.89s/it]
Task 13, Epoch 17/20 => Loss 0.100, Train_accy 97.05:  85%|████████▌ | 17/20 [04:51<00:51, 17.10s/it]
Task 13, Epoch 18/20 => Loss 0.110, Train_accy 96.79:  85%|████████▌ | 17/20 [05:04<00:51, 17.10s/it]
Task 13, Epoch 18/20 => Loss 0.110, Train_accy 96.79:  90%|█████████ | 18/20 [05:04<00:31, 15.87s/it]
Task 13, Epoch 19/20 => Loss 0.091, Train_accy 97.83:  90%|█████████ | 18/20 [05:17<00:31, 15.87s/it]
Task 13, Epoch 19/20 => Loss 0.091, Train_accy 97.83:  95%|█████████▌| 19/20 [05:17<00:14, 14.99s/it]
Task 13, Epoch 20/20 => Loss 0.098, Train_accy 97.48, Test_accy 70.36:  95%|█████████▌| 19/20 [05:53<00:14, 14.99s/it]
Task 13, Epoch 20/20 => Loss 0.098, Train_accy 97.48, Test_accy 70.36: 100%|██████████| 20/20 [05:53<00:00, 21.52s/it]
Task 13, Epoch 20/20 => Loss 0.098, Train_accy 97.48, Test_accy 70.36: 100%|██████████| 20/20 [05:53<00:00, 17.69s/it]
2024-09-08 03:23:53,899 [coda_prompt.py] => Task 13, Epoch 20/20 => Loss 0.098, Train_accy 97.48, Test_accy 70.36
2024-09-08 03:24:17,706 [trainer.py] => No NME accuracy.
2024-09-08 03:24:17,707 [trainer.py] => CNN: {'total': 70.36, '00-09': 77.92, '10-19': 79.84, '20-29': 72.0, '30-39': 81.93, '40-49': 63.25, '50-59': 65.46, '60-69': 67.79, '70-79': 70.33, '80-89': 62.9, '90-99': 56.5, '100-109': 70.07, '110-119': 73.14, '120-129': 60.89, '130-139': 72.15, 'old': 70.22, 'new': 72.15}
2024-09-08 03:24:17,707 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28, 70.36]
2024-09-08 03:24:17,707 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82, 87.4]

Average Accuracy (CNN): 76.6
2024-09-08 03:24:17,707 [trainer.py] => Average Accuracy (CNN): 76.6 

2024-09-08 03:24:17,709 [trainer.py] => All params: 89792456
2024-09-08 03:24:17,710 [trainer.py] => Trainable params: 89792456
2024-09-08 03:24:18,423 [coda_prompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.241, Train_accy 63.65:   0%|          | 0/20 [00:15<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.241, Train_accy 63.65:   5%|▌         | 1/20 [00:15<04:54, 15.50s/it]
Task 14, Epoch 2/20 => Loss 0.344, Train_accy 89.58:   5%|▌         | 1/20 [00:31<04:54, 15.50s/it]
Task 14, Epoch 2/20 => Loss 0.344, Train_accy 89.58:  10%|█         | 2/20 [00:31<04:39, 15.51s/it]
Task 14, Epoch 3/20 => Loss 0.265, Train_accy 92.31:  10%|█         | 2/20 [00:46<04:39, 15.51s/it]
Task 14, Epoch 3/20 => Loss 0.265, Train_accy 92.31:  15%|█▌        | 3/20 [00:46<04:23, 15.52s/it]
Task 14, Epoch 4/20 => Loss 0.223, Train_accy 92.24:  15%|█▌        | 3/20 [01:02<04:23, 15.52s/it]
Task 14, Epoch 4/20 => Loss 0.223, Train_accy 92.24:  20%|██        | 4/20 [01:02<04:08, 15.51s/it]
Task 14, Epoch 5/20 => Loss 0.194, Train_accy 93.32, Test_accy 69.00:  20%|██        | 4/20 [01:43<04:08, 15.51s/it]
Task 14, Epoch 5/20 => Loss 0.194, Train_accy 93.32, Test_accy 69.00:  25%|██▌       | 5/20 [01:43<06:11, 24.75s/it]
Task 14, Epoch 6/20 => Loss 0.178, Train_accy 93.61:  25%|██▌       | 5/20 [01:58<06:11, 24.75s/it]                 
Task 14, Epoch 6/20 => Loss 0.178, Train_accy 93.61:  30%|███       | 6/20 [01:58<05:02, 21.60s/it]
Task 14, Epoch 7/20 => Loss 0.133, Train_accy 95.47:  30%|███       | 6/20 [02:14<05:02, 21.60s/it]
Task 14, Epoch 7/20 => Loss 0.133, Train_accy 95.47:  35%|███▌      | 7/20 [02:14<04:15, 19.62s/it]
Task 14, Epoch 8/20 => Loss 0.191, Train_accy 94.04:  35%|███▌      | 7/20 [02:29<04:15, 19.62s/it]
Task 14, Epoch 8/20 => Loss 0.191, Train_accy 94.04:  40%|████      | 8/20 [02:29<03:40, 18.33s/it]
Task 14, Epoch 9/20 => Loss 0.133, Train_accy 95.98:  40%|████      | 8/20 [02:45<03:40, 18.33s/it]
Task 14, Epoch 9/20 => Loss 0.133, Train_accy 95.98:  45%|████▌     | 9/20 [02:45<03:12, 17.46s/it]
Task 14, Epoch 10/20 => Loss 0.120, Train_accy 96.41, Test_accy 69.77:  45%|████▌     | 9/20 [03:26<03:12, 17.46s/it]
Task 14, Epoch 10/20 => Loss 0.120, Train_accy 96.41, Test_accy 69.77:  50%|█████     | 10/20 [03:26<04:08, 24.84s/it]
Task 14, Epoch 11/20 => Loss 0.118, Train_accy 96.19:  50%|█████     | 10/20 [03:42<04:08, 24.84s/it]                 
Task 14, Epoch 11/20 => Loss 0.118, Train_accy 96.19:  55%|█████▌    | 11/20 [03:42<03:17, 21.99s/it]
Task 14, Epoch 12/20 => Loss 0.137, Train_accy 95.62:  55%|█████▌    | 11/20 [03:57<03:17, 21.99s/it]
Task 14, Epoch 12/20 => Loss 0.137, Train_accy 95.62:  60%|██████    | 12/20 [03:57<02:40, 20.02s/it]
Task 14, Epoch 13/20 => Loss 0.134, Train_accy 95.62:  60%|██████    | 12/20 [04:13<02:40, 20.02s/it]
Task 14, Epoch 13/20 => Loss 0.134, Train_accy 95.62:  65%|██████▌   | 13/20 [04:13<02:10, 18.65s/it]
Task 14, Epoch 14/20 => Loss 0.097, Train_accy 96.91:  65%|██████▌   | 13/20 [04:28<02:10, 18.65s/it]
Task 14, Epoch 14/20 => Loss 0.097, Train_accy 96.91:  70%|███████   | 14/20 [04:28<01:46, 17.71s/it]
Task 14, Epoch 15/20 => Loss 0.122, Train_accy 96.34, Test_accy 69.88:  70%|███████   | 14/20 [05:10<01:46, 17.71s/it]
Task 14, Epoch 15/20 => Loss 0.122, Train_accy 96.34, Test_accy 69.88:  75%|███████▌  | 15/20 [05:10<02:04, 24.86s/it]
Task 14, Epoch 16/20 => Loss 0.112, Train_accy 96.19:  75%|███████▌  | 15/20 [05:25<02:04, 24.86s/it]                 
Task 14, Epoch 16/20 => Loss 0.112, Train_accy 96.19:  80%|████████  | 16/20 [05:25<01:28, 22.04s/it]
Task 14, Epoch 17/20 => Loss 0.116, Train_accy 96.55:  80%|████████  | 16/20 [05:41<01:28, 22.04s/it]
Task 14, Epoch 17/20 => Loss 0.116, Train_accy 96.55:  85%|████████▌ | 17/20 [05:41<01:00, 20.06s/it]
Task 14, Epoch 18/20 => Loss 0.117, Train_accy 95.91:  85%|████████▌ | 17/20 [05:56<01:00, 20.06s/it]
Task 14, Epoch 18/20 => Loss 0.117, Train_accy 95.91:  90%|█████████ | 18/20 [05:56<00:37, 18.68s/it]
Task 14, Epoch 19/20 => Loss 0.093, Train_accy 96.98:  90%|█████████ | 18/20 [06:12<00:37, 18.68s/it]
Task 14, Epoch 19/20 => Loss 0.093, Train_accy 96.98:  95%|█████████▌| 19/20 [06:12<00:17, 17.72s/it]
Task 14, Epoch 20/20 => Loss 0.084, Train_accy 97.84, Test_accy 69.94:  95%|█████████▌| 19/20 [06:53<00:17, 17.72s/it]
Task 14, Epoch 20/20 => Loss 0.084, Train_accy 97.84, Test_accy 69.94: 100%|██████████| 20/20 [06:53<00:00, 24.83s/it]
Task 14, Epoch 20/20 => Loss 0.084, Train_accy 97.84, Test_accy 69.94: 100%|██████████| 20/20 [06:53<00:00, 20.68s/it]
2024-09-08 03:31:11,941 [coda_prompt.py] => Task 14, Epoch 20/20 => Loss 0.084, Train_accy 97.84, Test_accy 69.94
2024-09-08 03:31:37,712 [trainer.py] => No NME accuracy.
2024-09-08 03:31:37,713 [trainer.py] => CNN: {'total': 69.94, '00-09': 76.34, '10-19': 79.84, '20-29': 72.33, '30-39': 82.23, '40-49': 61.26, '50-59': 67.43, '60-69': 67.79, '70-79': 70.33, '80-89': 63.23, '90-99': 55.93, '100-109': 68.31, '110-119': 72.61, '120-129': 60.52, '130-139': 72.15, '140-149': 68.12, 'old': 70.1, 'new': 68.12}
2024-09-08 03:31:37,713 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28, 70.36, 69.94]
2024-09-08 03:31:37,713 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82, 87.4, 87.51]

Average Accuracy (CNN): 76.16
2024-09-08 03:31:37,713 [trainer.py] => Average Accuracy (CNN): 76.16 

2024-09-08 03:31:37,715 [trainer.py] => All params: 89792456
2024-09-08 03:31:37,716 [trainer.py] => Trainable params: 89792456
2024-09-08 03:31:38,459 [coda_prompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.440, Train_accy 57.69:   0%|          | 0/20 [00:15<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.440, Train_accy 57.69:   5%|▌         | 1/20 [00:15<04:54, 15.52s/it]
Task 15, Epoch 2/20 => Loss 0.467, Train_accy 86.42:   5%|▌         | 1/20 [00:31<04:54, 15.52s/it]
Task 15, Epoch 2/20 => Loss 0.467, Train_accy 86.42:  10%|█         | 2/20 [00:31<04:39, 15.52s/it]
Task 15, Epoch 3/20 => Loss 0.331, Train_accy 89.58:  10%|█         | 2/20 [00:46<04:39, 15.52s/it]
Task 15, Epoch 3/20 => Loss 0.331, Train_accy 89.58:  15%|█▌        | 3/20 [00:46<04:23, 15.53s/it]
Task 15, Epoch 4/20 => Loss 0.284, Train_accy 91.52:  15%|█▌        | 3/20 [01:02<04:23, 15.53s/it]
Task 15, Epoch 4/20 => Loss 0.284, Train_accy 91.52:  20%|██        | 4/20 [01:02<04:08, 15.52s/it]
Task 15, Epoch 5/20 => Loss 0.238, Train_accy 92.10, Test_accy 68.76:  20%|██        | 4/20 [01:45<04:08, 15.52s/it]
Task 15, Epoch 5/20 => Loss 0.238, Train_accy 92.10, Test_accy 68.76:  25%|██▌       | 5/20 [01:45<06:23, 25.58s/it]
Task 15, Epoch 6/20 => Loss 0.223, Train_accy 93.46:  25%|██▌       | 5/20 [02:01<06:23, 25.58s/it]                 
Task 15, Epoch 6/20 => Loss 0.223, Train_accy 93.46:  30%|███       | 6/20 [02:01<05:10, 22.18s/it]
Task 15, Epoch 7/20 => Loss 0.212, Train_accy 93.61:  30%|███       | 6/20 [02:16<05:10, 22.18s/it]
Task 15, Epoch 7/20 => Loss 0.212, Train_accy 93.61:  35%|███▌      | 7/20 [02:16<04:20, 20.00s/it]
Task 15, Epoch 8/20 => Loss 0.177, Train_accy 94.90:  35%|███▌      | 7/20 [02:32<04:20, 20.00s/it]
Task 15, Epoch 8/20 => Loss 0.177, Train_accy 94.90:  40%|████      | 8/20 [02:32<03:42, 18.56s/it]
Task 15, Epoch 9/20 => Loss 0.175, Train_accy 94.68:  40%|████      | 8/20 [02:47<03:42, 18.56s/it]
Task 15, Epoch 9/20 => Loss 0.175, Train_accy 94.68:  45%|████▌     | 9/20 [02:47<03:14, 17.66s/it]
Task 15, Epoch 10/20 => Loss 0.175, Train_accy 94.90, Test_accy 69.09:  45%|████▌     | 9/20 [03:31<03:14, 17.66s/it]
Task 15, Epoch 10/20 => Loss 0.175, Train_accy 94.90, Test_accy 69.09:  50%|█████     | 10/20 [03:31<04:15, 25.58s/it]
Task 15, Epoch 11/20 => Loss 0.167, Train_accy 95.47:  50%|█████     | 10/20 [03:46<04:15, 25.58s/it]                 
Task 15, Epoch 11/20 => Loss 0.167, Train_accy 95.47:  55%|█████▌    | 11/20 [03:46<03:22, 22.49s/it]
Task 15, Epoch 12/20 => Loss 0.150, Train_accy 95.40:  55%|█████▌    | 11/20 [04:02<03:22, 22.49s/it]
Task 15, Epoch 12/20 => Loss 0.150, Train_accy 95.40:  60%|██████    | 12/20 [04:02<02:42, 20.37s/it]
Task 15, Epoch 13/20 => Loss 0.151, Train_accy 95.19:  60%|██████    | 12/20 [04:17<02:42, 20.37s/it]
Task 15, Epoch 13/20 => Loss 0.151, Train_accy 95.19:  65%|██████▌   | 13/20 [04:17<02:12, 18.89s/it]
Task 15, Epoch 14/20 => Loss 0.126, Train_accy 96.34:  65%|██████▌   | 13/20 [04:33<02:12, 18.89s/it]
Task 15, Epoch 14/20 => Loss 0.126, Train_accy 96.34:  70%|███████   | 14/20 [04:33<01:47, 17.87s/it]
Task 15, Epoch 15/20 => Loss 0.095, Train_accy 97.41, Test_accy 69.29:  70%|███████   | 14/20 [05:16<01:47, 17.87s/it]
Task 15, Epoch 15/20 => Loss 0.095, Train_accy 97.41, Test_accy 69.29:  75%|███████▌  | 15/20 [05:16<02:07, 25.53s/it]
Task 15, Epoch 16/20 => Loss 0.126, Train_accy 96.55:  75%|███████▌  | 15/20 [05:31<02:07, 25.53s/it]                 
Task 15, Epoch 16/20 => Loss 0.126, Train_accy 96.55:  80%|████████  | 16/20 [05:31<01:30, 22.51s/it]
Task 15, Epoch 17/20 => Loss 0.106, Train_accy 96.98:  80%|████████  | 16/20 [05:47<01:30, 22.51s/it]
Task 15, Epoch 17/20 => Loss 0.106, Train_accy 96.98:  85%|████████▌ | 17/20 [05:47<01:01, 20.40s/it]
Task 15, Epoch 18/20 => Loss 0.101, Train_accy 96.48:  85%|████████▌ | 17/20 [06:02<01:01, 20.40s/it]
Task 15, Epoch 18/20 => Loss 0.101, Train_accy 96.48:  90%|█████████ | 18/20 [06:02<00:37, 18.92s/it]
Task 15, Epoch 19/20 => Loss 0.107, Train_accy 97.20:  90%|█████████ | 18/20 [06:18<00:37, 18.92s/it]
Task 15, Epoch 19/20 => Loss 0.107, Train_accy 97.20:  95%|█████████▌| 19/20 [06:18<00:17, 17.89s/it]
Task 15, Epoch 20/20 => Loss 0.106, Train_accy 96.84, Test_accy 69.37:  95%|█████████▌| 19/20 [07:01<00:17, 17.89s/it]
Task 15, Epoch 20/20 => Loss 0.106, Train_accy 96.84, Test_accy 69.37: 100%|██████████| 20/20 [07:01<00:00, 25.53s/it]
Task 15, Epoch 20/20 => Loss 0.106, Train_accy 96.84, Test_accy 69.37: 100%|██████████| 20/20 [07:01<00:00, 21.08s/it]
2024-09-08 03:38:40,152 [coda_prompt.py] => Task 15, Epoch 20/20 => Loss 0.106, Train_accy 96.84, Test_accy 69.37
2024-09-08 03:39:08,117 [trainer.py] => No NME accuracy.
2024-09-08 03:39:08,118 [trainer.py] => CNN: {'total': 69.37, '00-09': 76.66, '10-19': 79.3, '20-29': 71.67, '30-39': 81.33, '40-49': 60.6, '50-59': 66.78, '60-69': 68.12, '70-79': 69.96, '80-89': 62.58, '90-99': 56.5, '100-109': 67.96, '110-119': 71.81, '120-129': 60.52, '130-139': 72.82, '140-149': 68.39, '150-159': 65.47, 'old': 69.68, 'new': 65.47}
2024-09-08 03:39:08,118 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28, 70.36, 69.94, 69.37]
2024-09-08 03:39:08,118 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82, 87.4, 87.51, 87.05]

Average Accuracy (CNN): 75.74
2024-09-08 03:39:08,118 [trainer.py] => Average Accuracy (CNN): 75.74 

2024-09-08 03:39:08,119 [trainer.py] => All params: 89792456
2024-09-08 03:39:08,120 [trainer.py] => Trainable params: 89792456
2024-09-08 03:39:08,928 [coda_prompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.897, Train_accy 44.90:   0%|          | 0/20 [00:10<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.897, Train_accy 44.90:   5%|▌         | 1/20 [00:10<03:25, 10.81s/it]
Task 16, Epoch 2/20 => Loss 0.741, Train_accy 75.10:   5%|▌         | 1/20 [00:21<03:25, 10.81s/it]
Task 16, Epoch 2/20 => Loss 0.741, Train_accy 75.10:  10%|█         | 2/20 [00:21<03:14, 10.80s/it]
Task 16, Epoch 3/20 => Loss 0.588, Train_accy 82.81:  10%|█         | 2/20 [00:32<03:14, 10.80s/it]
Task 16, Epoch 3/20 => Loss 0.588, Train_accy 82.81:  15%|█▌        | 3/20 [00:32<03:04, 10.86s/it]
Task 16, Epoch 4/20 => Loss 0.420, Train_accy 86.46:  15%|█▌        | 3/20 [00:43<03:04, 10.86s/it]
Task 16, Epoch 4/20 => Loss 0.420, Train_accy 86.46:  20%|██        | 4/20 [00:43<02:53, 10.84s/it]
Task 16, Epoch 5/20 => Loss 0.361, Train_accy 87.71, Test_accy 68.39:  20%|██        | 4/20 [01:23<02:53, 10.84s/it]
Task 16, Epoch 5/20 => Loss 0.361, Train_accy 87.71, Test_accy 68.39:  25%|██▌       | 5/20 [01:23<05:20, 21.38s/it]
Task 16, Epoch 6/20 => Loss 0.336, Train_accy 89.38:  25%|██▌       | 5/20 [01:34<05:20, 21.38s/it]                 
Task 16, Epoch 6/20 => Loss 0.336, Train_accy 89.38:  30%|███       | 6/20 [01:34<04:09, 17.81s/it]
Task 16, Epoch 7/20 => Loss 0.305, Train_accy 90.52:  30%|███       | 6/20 [01:45<04:09, 17.81s/it]
Task 16, Epoch 7/20 => Loss 0.305, Train_accy 90.52:  35%|███▌      | 7/20 [01:45<03:21, 15.54s/it]
Task 16, Epoch 8/20 => Loss 0.256, Train_accy 92.19:  35%|███▌      | 7/20 [01:56<03:21, 15.54s/it]
Task 16, Epoch 8/20 => Loss 0.256, Train_accy 92.19:  40%|████      | 8/20 [01:56<02:48, 14.05s/it]
Task 16, Epoch 9/20 => Loss 0.252, Train_accy 92.40:  40%|████      | 8/20 [02:06<02:48, 14.05s/it]
Task 16, Epoch 9/20 => Loss 0.252, Train_accy 92.40:  45%|████▌     | 9/20 [02:06<02:23, 13.06s/it]
Task 16, Epoch 10/20 => Loss 0.251, Train_accy 91.88, Test_accy 68.78:  45%|████▌     | 9/20 [02:46<02:23, 13.06s/it]
Task 16, Epoch 10/20 => Loss 0.251, Train_accy 91.88, Test_accy 68.78:  50%|█████     | 10/20 [02:46<03:33, 21.36s/it]
Task 16, Epoch 11/20 => Loss 0.206, Train_accy 93.65:  50%|█████     | 10/20 [02:57<03:33, 21.36s/it]                 
Task 16, Epoch 11/20 => Loss 0.206, Train_accy 93.65:  55%|█████▌    | 11/20 [02:57<02:43, 18.14s/it]
Task 16, Epoch 12/20 => Loss 0.216, Train_accy 93.65:  55%|█████▌    | 11/20 [03:08<02:43, 18.14s/it]
Task 16, Epoch 12/20 => Loss 0.216, Train_accy 93.65:  60%|██████    | 12/20 [03:08<02:07, 15.91s/it]
Task 16, Epoch 13/20 => Loss 0.246, Train_accy 93.02:  60%|██████    | 12/20 [03:19<02:07, 15.91s/it]
Task 16, Epoch 13/20 => Loss 0.246, Train_accy 93.02:  65%|██████▌   | 13/20 [03:19<01:40, 14.36s/it]
Task 16, Epoch 14/20 => Loss 0.195, Train_accy 95.10:  65%|██████▌   | 13/20 [03:30<01:40, 14.36s/it]
Task 16, Epoch 14/20 => Loss 0.195, Train_accy 95.10:  70%|███████   | 14/20 [03:30<01:19, 13.29s/it]
Task 16, Epoch 15/20 => Loss 0.249, Train_accy 91.98, Test_accy 68.78:  70%|███████   | 14/20 [04:09<01:19, 13.29s/it]
Task 16, Epoch 15/20 => Loss 0.249, Train_accy 91.98, Test_accy 68.78:  75%|███████▌  | 15/20 [04:09<01:46, 21.28s/it]
Task 16, Epoch 16/20 => Loss 0.205, Train_accy 93.54:  75%|███████▌  | 15/20 [04:20<01:46, 21.28s/it]                 
Task 16, Epoch 16/20 => Loss 0.205, Train_accy 93.54:  80%|████████  | 16/20 [04:20<01:12, 18.12s/it]
Task 16, Epoch 17/20 => Loss 0.210, Train_accy 93.96:  80%|████████  | 16/20 [04:31<01:12, 18.12s/it]
Task 16, Epoch 17/20 => Loss 0.210, Train_accy 93.96:  85%|████████▌ | 17/20 [04:31<00:47, 15.93s/it]
Task 16, Epoch 18/20 => Loss 0.210, Train_accy 93.44:  85%|████████▌ | 17/20 [04:42<00:47, 15.93s/it]
Task 16, Epoch 18/20 => Loss 0.210, Train_accy 93.44:  90%|█████████ | 18/20 [04:42<00:28, 14.40s/it]
Task 16, Epoch 19/20 => Loss 0.193, Train_accy 94.58:  90%|█████████ | 18/20 [04:53<00:28, 14.40s/it]
Task 16, Epoch 19/20 => Loss 0.193, Train_accy 94.58:  95%|█████████▌| 19/20 [04:53<00:13, 13.32s/it]
Task 16, Epoch 20/20 => Loss 0.185, Train_accy 94.58, Test_accy 68.84:  95%|█████████▌| 19/20 [05:32<00:13, 13.32s/it]
Task 16, Epoch 20/20 => Loss 0.185, Train_accy 94.58, Test_accy 68.84: 100%|██████████| 20/20 [05:32<00:00, 21.27s/it]
Task 16, Epoch 20/20 => Loss 0.185, Train_accy 94.58, Test_accy 68.84: 100%|██████████| 20/20 [05:32<00:00, 16.65s/it]
2024-09-08 03:44:41,870 [coda_prompt.py] => Task 16, Epoch 20/20 => Loss 0.185, Train_accy 94.58, Test_accy 68.84
2024-09-08 03:45:10,880 [trainer.py] => No NME accuracy.
2024-09-08 03:45:10,881 [trainer.py] => CNN: {'total': 68.84, '00-09': 76.66, '10-19': 79.3, '20-29': 71.0, '30-39': 81.33, '40-49': 60.26, '50-59': 67.11, '60-69': 67.79, '70-79': 69.6, '80-89': 63.87, '90-99': 57.63, '100-109': 68.31, '110-119': 71.81, '120-129': 59.41, '130-139': 71.48, '140-149': 68.12, '150-159': 65.47, '160-169': 59.57, 'old': 69.27, 'new': 59.57}
2024-09-08 03:45:10,881 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28, 70.36, 69.94, 69.37, 68.84]
2024-09-08 03:45:10,881 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82, 87.4, 87.51, 87.05, 86.49]

Average Accuracy (CNN): 75.33
2024-09-08 03:45:10,882 [trainer.py] => Average Accuracy (CNN): 75.33 

2024-09-08 03:45:10,883 [trainer.py] => All params: 89792456
2024-09-08 03:45:10,884 [trainer.py] => Trainable params: 89792456
2024-09-08 03:45:11,726 [coda_prompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.313, Train_accy 59.21:   0%|          | 0/20 [00:10<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.313, Train_accy 59.21:   5%|▌         | 1/20 [00:10<03:15, 10.30s/it]
Task 17, Epoch 2/20 => Loss 0.408, Train_accy 87.94:   5%|▌         | 1/20 [00:20<03:15, 10.30s/it]
Task 17, Epoch 2/20 => Loss 0.408, Train_accy 87.94:  10%|█         | 2/20 [00:20<03:05, 10.30s/it]
Task 17, Epoch 3/20 => Loss 0.288, Train_accy 90.90:  10%|█         | 2/20 [00:30<03:05, 10.30s/it]
Task 17, Epoch 3/20 => Loss 0.288, Train_accy 90.90:  15%|█▌        | 3/20 [00:30<02:55, 10.30s/it]
Task 17, Epoch 4/20 => Loss 0.268, Train_accy 91.89:  15%|█▌        | 3/20 [00:41<02:55, 10.30s/it]
Task 17, Epoch 4/20 => Loss 0.268, Train_accy 91.89:  20%|██        | 4/20 [00:41<02:44, 10.29s/it]
Task 17, Epoch 5/20 => Loss 0.194, Train_accy 93.75, Test_accy 68.75:  20%|██        | 4/20 [01:21<02:44, 10.29s/it]
Task 17, Epoch 5/20 => Loss 0.194, Train_accy 93.75, Test_accy 68.75:  25%|██▌       | 5/20 [01:21<05:19, 21.27s/it]
Task 17, Epoch 6/20 => Loss 0.193, Train_accy 94.30:  25%|██▌       | 5/20 [01:32<05:19, 21.27s/it]                 
Task 17, Epoch 6/20 => Loss 0.193, Train_accy 94.30:  30%|███       | 6/20 [01:32<04:05, 17.57s/it]
Task 17, Epoch 7/20 => Loss 0.168, Train_accy 95.29:  30%|███       | 6/20 [01:42<04:05, 17.57s/it]
Task 17, Epoch 7/20 => Loss 0.168, Train_accy 95.29:  35%|███▌      | 7/20 [01:42<03:18, 15.28s/it]
Task 17, Epoch 8/20 => Loss 0.150, Train_accy 96.05:  35%|███▌      | 7/20 [01:53<03:18, 15.28s/it]
Task 17, Epoch 8/20 => Loss 0.150, Train_accy 96.05:  40%|████      | 8/20 [01:53<02:44, 13.70s/it]
Task 17, Epoch 9/20 => Loss 0.200, Train_accy 94.41:  40%|████      | 8/20 [02:03<02:44, 13.70s/it]
Task 17, Epoch 9/20 => Loss 0.200, Train_accy 94.41:  45%|████▌     | 9/20 [02:03<02:19, 12.70s/it]
Task 17, Epoch 10/20 => Loss 0.148, Train_accy 94.63, Test_accy 68.82:  45%|████▌     | 9/20 [02:44<02:19, 12.70s/it]
Task 17, Epoch 10/20 => Loss 0.148, Train_accy 94.63, Test_accy 68.82:  50%|█████     | 10/20 [02:44<03:33, 21.37s/it]
Task 17, Epoch 11/20 => Loss 0.162, Train_accy 95.39:  50%|█████     | 10/20 [02:54<03:33, 21.37s/it]                 
Task 17, Epoch 11/20 => Loss 0.162, Train_accy 95.39:  55%|█████▌    | 11/20 [02:54<02:42, 18.00s/it]
Task 17, Epoch 12/20 => Loss 0.134, Train_accy 95.94:  55%|█████▌    | 11/20 [03:05<02:42, 18.00s/it]
Task 17, Epoch 12/20 => Loss 0.134, Train_accy 95.94:  60%|██████    | 12/20 [03:05<02:05, 15.66s/it]
Task 17, Epoch 13/20 => Loss 0.135, Train_accy 95.72:  60%|██████    | 12/20 [03:15<02:05, 15.66s/it]
Task 17, Epoch 13/20 => Loss 0.135, Train_accy 95.72:  65%|██████▌   | 13/20 [03:15<01:39, 14.19s/it]
Task 17, Epoch 14/20 => Loss 0.106, Train_accy 96.93:  65%|██████▌   | 13/20 [03:26<01:39, 14.19s/it]
Task 17, Epoch 14/20 => Loss 0.106, Train_accy 96.93:  70%|███████   | 14/20 [03:26<01:18, 13.04s/it]
Task 17, Epoch 15/20 => Loss 0.108, Train_accy 96.05, Test_accy 68.88:  70%|███████   | 14/20 [04:07<01:18, 13.04s/it]
Task 17, Epoch 15/20 => Loss 0.108, Train_accy 96.05, Test_accy 68.88:  75%|███████▌  | 15/20 [04:07<01:46, 21.40s/it]
Task 17, Epoch 16/20 => Loss 0.130, Train_accy 95.83:  75%|███████▌  | 15/20 [04:17<01:46, 21.40s/it]                 
Task 17, Epoch 16/20 => Loss 0.130, Train_accy 95.83:  80%|████████  | 16/20 [04:17<01:12, 18.05s/it]
Task 17, Epoch 17/20 => Loss 0.101, Train_accy 97.15:  80%|████████  | 16/20 [04:27<01:12, 18.05s/it]
Task 17, Epoch 17/20 => Loss 0.101, Train_accy 97.15:  85%|████████▌ | 17/20 [04:27<00:47, 15.73s/it]
Task 17, Epoch 18/20 => Loss 0.108, Train_accy 96.71:  85%|████████▌ | 17/20 [04:38<00:47, 15.73s/it]
Task 17, Epoch 18/20 => Loss 0.108, Train_accy 96.71:  90%|█████████ | 18/20 [04:38<00:28, 14.10s/it]
Task 17, Epoch 19/20 => Loss 0.114, Train_accy 96.71:  90%|█████████ | 18/20 [04:48<00:28, 14.10s/it]
Task 17, Epoch 19/20 => Loss 0.114, Train_accy 96.71:  95%|█████████▌| 19/20 [04:48<00:12, 12.97s/it]
Task 17, Epoch 20/20 => Loss 0.134, Train_accy 95.83, Test_accy 68.94:  95%|█████████▌| 19/20 [05:29<00:12, 12.97s/it]
Task 17, Epoch 20/20 => Loss 0.134, Train_accy 95.83, Test_accy 68.94: 100%|██████████| 20/20 [05:29<00:00, 21.29s/it]
Task 17, Epoch 20/20 => Loss 0.134, Train_accy 95.83, Test_accy 68.94: 100%|██████████| 20/20 [05:29<00:00, 16.45s/it]
2024-09-08 03:50:40,789 [coda_prompt.py] => Task 17, Epoch 20/20 => Loss 0.134, Train_accy 95.83, Test_accy 68.94
2024-09-08 03:51:11,215 [trainer.py] => No NME accuracy.
2024-09-08 03:51:11,216 [trainer.py] => CNN: {'total': 68.94, '00-09': 76.03, '10-19': 79.57, '20-29': 71.33, '30-39': 80.42, '40-49': 60.26, '50-59': 66.78, '60-69': 68.12, '70-79': 69.23, '80-89': 62.58, '90-99': 55.37, '100-109': 68.31, '110-119': 71.54, '120-129': 57.93, '130-139': 72.48, '140-149': 68.12, '150-159': 66.02, '160-169': 56.96, '170-179': 78.23, 'old': 68.49, 'new': 78.23}
2024-09-08 03:51:11,216 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28, 70.36, 69.94, 69.37, 68.84, 68.94]
2024-09-08 03:51:11,216 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82, 87.4, 87.51, 87.05, 86.49, 86.31]

Average Accuracy (CNN): 74.98
2024-09-08 03:51:11,216 [trainer.py] => Average Accuracy (CNN): 74.98 

2024-09-08 03:51:11,217 [trainer.py] => All params: 89792456
2024-09-08 03:51:11,218 [trainer.py] => Trainable params: 89792456
2024-09-08 03:51:12,103 [coda_prompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.396, Train_accy 57.79:   0%|          | 0/20 [00:12<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.396, Train_accy 57.79:   5%|▌         | 1/20 [00:12<03:55, 12.37s/it]
Task 18, Epoch 2/20 => Loss 0.479, Train_accy 83.97:   5%|▌         | 1/20 [00:24<03:55, 12.37s/it]
Task 18, Epoch 2/20 => Loss 0.479, Train_accy 83.97:  10%|█         | 2/20 [00:24<03:42, 12.37s/it]
Task 18, Epoch 3/20 => Loss 0.347, Train_accy 88.41:  10%|█         | 2/20 [00:37<03:42, 12.37s/it]
Task 18, Epoch 3/20 => Loss 0.347, Train_accy 88.41:  15%|█▌        | 3/20 [00:37<03:30, 12.38s/it]
Task 18, Epoch 4/20 => Loss 0.301, Train_accy 90.22:  15%|█▌        | 3/20 [00:49<03:30, 12.38s/it]
Task 18, Epoch 4/20 => Loss 0.301, Train_accy 90.22:  20%|██        | 4/20 [00:49<03:18, 12.39s/it]
Task 18, Epoch 5/20 => Loss 0.238, Train_accy 92.93, Test_accy 67.92:  20%|██        | 4/20 [01:34<03:18, 12.39s/it]
Task 18, Epoch 5/20 => Loss 0.238, Train_accy 92.93, Test_accy 67.92:  25%|██▌       | 5/20 [01:34<06:00, 24.02s/it]
Task 18, Epoch 6/20 => Loss 0.214, Train_accy 93.57:  25%|██▌       | 5/20 [01:46<06:00, 24.02s/it]                 
Task 18, Epoch 6/20 => Loss 0.214, Train_accy 93.57:  30%|███       | 6/20 [01:46<04:41, 20.09s/it]
Task 18, Epoch 7/20 => Loss 0.237, Train_accy 92.84:  30%|███       | 6/20 [01:59<04:41, 20.09s/it]
Task 18, Epoch 7/20 => Loss 0.237, Train_accy 92.84:  35%|███▌      | 7/20 [01:59<03:48, 17.58s/it]
Task 18, Epoch 8/20 => Loss 0.165, Train_accy 95.02:  35%|███▌      | 7/20 [02:11<03:48, 17.58s/it]
Task 18, Epoch 8/20 => Loss 0.165, Train_accy 95.02:  40%|████      | 8/20 [02:11<03:11, 15.93s/it]
Task 18, Epoch 9/20 => Loss 0.181, Train_accy 94.38:  40%|████      | 8/20 [02:23<03:11, 15.93s/it]
Task 18, Epoch 9/20 => Loss 0.181, Train_accy 94.38:  45%|████▌     | 9/20 [02:23<02:43, 14.83s/it]
Task 18, Epoch 10/20 => Loss 0.141, Train_accy 96.83, Test_accy 68.07:  45%|████▌     | 9/20 [03:08<02:43, 14.83s/it]
Task 18, Epoch 10/20 => Loss 0.141, Train_accy 96.83, Test_accy 68.07:  50%|█████     | 10/20 [03:08<04:00, 24.06s/it]
Task 18, Epoch 11/20 => Loss 0.136, Train_accy 95.74:  50%|█████     | 10/20 [03:21<04:00, 24.06s/it]                 
Task 18, Epoch 11/20 => Loss 0.136, Train_accy 95.74:  55%|█████▌    | 11/20 [03:21<03:04, 20.51s/it]
Task 18, Epoch 12/20 => Loss 0.166, Train_accy 95.20:  55%|█████▌    | 11/20 [03:33<03:04, 20.51s/it]
Task 18, Epoch 12/20 => Loss 0.166, Train_accy 95.20:  60%|██████    | 12/20 [03:33<02:24, 18.04s/it]
Task 18, Epoch 13/20 => Loss 0.148, Train_accy 95.56:  60%|██████    | 12/20 [03:45<02:24, 18.04s/it]
Task 18, Epoch 13/20 => Loss 0.148, Train_accy 95.56:  65%|██████▌   | 13/20 [03:45<01:54, 16.36s/it]
Task 18, Epoch 14/20 => Loss 0.118, Train_accy 96.74:  65%|██████▌   | 13/20 [03:58<01:54, 16.36s/it]
Task 18, Epoch 14/20 => Loss 0.118, Train_accy 96.74:  70%|███████   | 14/20 [03:58<01:30, 15.16s/it]
Task 18, Epoch 15/20 => Loss 0.132, Train_accy 96.56, Test_accy 68.34:  70%|███████   | 14/20 [04:42<01:30, 15.16s/it]
Task 18, Epoch 15/20 => Loss 0.132, Train_accy 96.56, Test_accy 68.34:  75%|███████▌  | 15/20 [04:42<02:00, 24.02s/it]
Task 18, Epoch 16/20 => Loss 0.146, Train_accy 95.47:  75%|███████▌  | 15/20 [04:55<02:00, 24.02s/it]                 
Task 18, Epoch 16/20 => Loss 0.146, Train_accy 95.47:  80%|████████  | 16/20 [04:55<01:22, 20.54s/it]
Task 18, Epoch 17/20 => Loss 0.117, Train_accy 96.74:  80%|████████  | 16/20 [05:07<01:22, 20.54s/it]
Task 18, Epoch 17/20 => Loss 0.117, Train_accy 96.74:  85%|████████▌ | 17/20 [05:07<00:54, 18.10s/it]
Task 18, Epoch 18/20 => Loss 0.152, Train_accy 95.74:  85%|████████▌ | 17/20 [05:20<00:54, 18.10s/it]
Task 18, Epoch 18/20 => Loss 0.152, Train_accy 95.74:  90%|█████████ | 18/20 [05:20<00:32, 16.39s/it]
Task 18, Epoch 19/20 => Loss 0.142, Train_accy 95.65:  90%|█████████ | 18/20 [05:32<00:32, 16.39s/it]
Task 18, Epoch 19/20 => Loss 0.142, Train_accy 95.65:  95%|█████████▌| 19/20 [05:32<00:15, 15.12s/it]
Task 18, Epoch 20/20 => Loss 0.118, Train_accy 96.92, Test_accy 68.39:  95%|█████████▌| 19/20 [06:16<00:15, 15.12s/it]
Task 18, Epoch 20/20 => Loss 0.118, Train_accy 96.92, Test_accy 68.39: 100%|██████████| 20/20 [06:16<00:00, 23.95s/it]
Task 18, Epoch 20/20 => Loss 0.118, Train_accy 96.92, Test_accy 68.39: 100%|██████████| 20/20 [06:16<00:00, 18.84s/it]
2024-09-08 03:57:28,969 [coda_prompt.py] => Task 18, Epoch 20/20 => Loss 0.118, Train_accy 96.92, Test_accy 68.39
2024-09-08 03:58:01,021 [trainer.py] => No NME accuracy.
2024-09-08 03:58:01,022 [trainer.py] => CNN: {'total': 68.39, '00-09': 75.71, '10-19': 79.03, '20-29': 70.67, '30-39': 81.63, '40-49': 61.26, '50-59': 67.11, '60-69': 67.11, '70-79': 68.86, '80-89': 61.94, '90-99': 55.37, '100-109': 67.61, '110-119': 70.74, '120-129': 57.93, '130-139': 72.15, '140-149': 67.57, '150-159': 65.47, '160-169': 57.39, '170-179': 77.02, '180-189': 63.64, 'old': 68.66, 'new': 63.64}
2024-09-08 03:58:01,022 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28, 70.36, 69.94, 69.37, 68.84, 68.94, 68.39]
2024-09-08 03:58:01,022 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82, 87.4, 87.51, 87.05, 86.49, 86.31, 85.69]

Average Accuracy (CNN): 74.63
2024-09-08 03:58:01,022 [trainer.py] => Average Accuracy (CNN): 74.63 

2024-09-08 03:58:01,023 [trainer.py] => All params: 89792456
2024-09-08 03:58:01,024 [trainer.py] => Trainable params: 89792456
2024-09-08 03:58:01,962 [coda_prompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.159, Train_accy 64.86:   0%|          | 0/20 [00:12<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.159, Train_accy 64.86:   5%|▌         | 1/20 [00:12<03:55, 12.39s/it]
Task 19, Epoch 2/20 => Loss 0.368, Train_accy 88.04:   5%|▌         | 1/20 [00:24<03:55, 12.39s/it]
Task 19, Epoch 2/20 => Loss 0.368, Train_accy 88.04:  10%|█         | 2/20 [00:24<03:43, 12.39s/it]
Task 19, Epoch 3/20 => Loss 0.292, Train_accy 91.76:  10%|█         | 2/20 [00:37<03:43, 12.39s/it]
Task 19, Epoch 3/20 => Loss 0.292, Train_accy 91.76:  15%|█▌        | 3/20 [00:37<03:30, 12.37s/it]
Task 19, Epoch 4/20 => Loss 0.211, Train_accy 93.84:  15%|█▌        | 3/20 [00:49<03:30, 12.37s/it]
Task 19, Epoch 4/20 => Loss 0.211, Train_accy 93.84:  20%|██        | 4/20 [00:49<03:18, 12.39s/it]
Task 19, Epoch 5/20 => Loss 0.202, Train_accy 92.93, Test_accy 67.45:  20%|██        | 4/20 [01:35<03:18, 12.39s/it]
Task 19, Epoch 5/20 => Loss 0.202, Train_accy 92.93, Test_accy 67.45:  25%|██▌       | 5/20 [01:35<06:07, 24.53s/it]
Task 19, Epoch 6/20 => Loss 0.141, Train_accy 95.02:  25%|██▌       | 5/20 [01:47<06:07, 24.53s/it]                 
Task 19, Epoch 6/20 => Loss 0.141, Train_accy 95.02:  30%|███       | 6/20 [01:47<04:45, 20.39s/it]
Task 19, Epoch 7/20 => Loss 0.160, Train_accy 94.38:  30%|███       | 6/20 [02:00<04:45, 20.39s/it]
Task 19, Epoch 7/20 => Loss 0.160, Train_accy 94.38:  35%|███▌      | 7/20 [02:00<03:51, 17.82s/it]
Task 19, Epoch 8/20 => Loss 0.129, Train_accy 96.20:  35%|███▌      | 7/20 [02:12<03:51, 17.82s/it]
Task 19, Epoch 8/20 => Loss 0.129, Train_accy 96.20:  40%|████      | 8/20 [02:12<03:13, 16.08s/it]
Task 19, Epoch 9/20 => Loss 0.143, Train_accy 95.74:  40%|████      | 8/20 [02:25<03:13, 16.08s/it]
Task 19, Epoch 9/20 => Loss 0.143, Train_accy 95.74:  45%|████▌     | 9/20 [02:25<02:44, 14.98s/it]
Task 19, Epoch 10/20 => Loss 0.133, Train_accy 96.20, Test_accy 67.45:  45%|████▌     | 9/20 [03:11<02:44, 14.98s/it]
Task 19, Epoch 10/20 => Loss 0.133, Train_accy 96.20, Test_accy 67.45:  50%|█████     | 10/20 [03:11<04:05, 24.56s/it]
Task 19, Epoch 11/20 => Loss 0.117, Train_accy 96.56:  50%|█████     | 10/20 [03:23<04:05, 24.56s/it]                 
Task 19, Epoch 11/20 => Loss 0.117, Train_accy 96.56:  55%|█████▌    | 11/20 [03:23<03:07, 20.85s/it]
Task 19, Epoch 12/20 => Loss 0.119, Train_accy 96.56:  55%|█████▌    | 11/20 [03:36<03:07, 20.85s/it]
Task 19, Epoch 12/20 => Loss 0.119, Train_accy 96.56:  60%|██████    | 12/20 [03:36<02:26, 18.28s/it]
Task 19, Epoch 13/20 => Loss 0.134, Train_accy 95.83:  60%|██████    | 12/20 [03:48<02:26, 18.28s/it]
Task 19, Epoch 13/20 => Loss 0.134, Train_accy 95.83:  65%|██████▌   | 13/20 [03:48<01:55, 16.50s/it]
Task 19, Epoch 14/20 => Loss 0.117, Train_accy 96.20:  65%|██████▌   | 13/20 [04:01<01:55, 16.50s/it]
Task 19, Epoch 14/20 => Loss 0.117, Train_accy 96.20:  70%|███████   | 14/20 [04:01<01:31, 15.26s/it]
Task 19, Epoch 15/20 => Loss 0.109, Train_accy 97.10, Test_accy 67.50:  70%|███████   | 14/20 [04:47<01:31, 15.26s/it]
Task 19, Epoch 15/20 => Loss 0.109, Train_accy 97.10, Test_accy 67.50:  75%|███████▌  | 15/20 [04:47<02:02, 24.56s/it]
Task 19, Epoch 16/20 => Loss 0.095, Train_accy 97.19:  75%|███████▌  | 15/20 [04:59<02:02, 24.56s/it]                 
Task 19, Epoch 16/20 => Loss 0.095, Train_accy 97.19:  80%|████████  | 16/20 [04:59<01:23, 20.91s/it]
Task 19, Epoch 17/20 => Loss 0.092, Train_accy 97.10:  80%|████████  | 16/20 [05:11<01:23, 20.91s/it]
Task 19, Epoch 17/20 => Loss 0.092, Train_accy 97.10:  85%|████████▌ | 17/20 [05:11<00:54, 18.29s/it]
Task 19, Epoch 18/20 => Loss 0.097, Train_accy 97.19:  85%|████████▌ | 17/20 [05:24<00:54, 18.29s/it]
Task 19, Epoch 18/20 => Loss 0.097, Train_accy 97.19:  90%|█████████ | 18/20 [05:24<00:32, 16.48s/it]
Task 19, Epoch 19/20 => Loss 0.109, Train_accy 97.01:  90%|█████████ | 18/20 [05:36<00:32, 16.48s/it]
Task 19, Epoch 19/20 => Loss 0.109, Train_accy 97.01:  95%|█████████▌| 19/20 [05:36<00:15, 15.23s/it]
Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.37, Test_accy 67.53:  95%|█████████▌| 19/20 [06:22<00:15, 15.23s/it]
Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.37, Test_accy 67.53: 100%|██████████| 20/20 [06:22<00:00, 24.48s/it]
Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.37, Test_accy 67.53: 100%|██████████| 20/20 [06:22<00:00, 19.12s/it]
2024-09-08 04:04:24,395 [coda_prompt.py] => Task 19, Epoch 20/20 => Loss 0.088, Train_accy 97.37, Test_accy 67.53
2024-09-08 04:04:58,050 [trainer.py] => No NME accuracy.
2024-09-08 04:04:58,051 [trainer.py] => CNN: {'total': 67.53, '00-09': 74.76, '10-19': 77.96, '20-29': 70.67, '30-39': 81.63, '40-49': 60.6, '50-59': 65.79, '60-69': 67.45, '70-79': 69.23, '80-89': 61.61, '90-99': 54.24, '100-109': 66.9, '110-119': 71.01, '120-129': 56.09, '130-139': 71.14, '140-149': 68.12, '150-159': 65.75, '160-169': 56.52, '170-179': 76.21, '180-189': 63.31, '190-199': 58.67, 'old': 67.95, 'new': 58.67}
2024-09-08 04:04:58,051 [trainer.py] => CNN top1 curve: [88.96, 84.91, 82.51, 81.15, 78.87, 76.96, 75.78, 74.58, 73.18, 72.16, 71.52, 71.25, 70.28, 70.36, 69.94, 69.37, 68.84, 68.94, 68.39, 67.53]
2024-09-08 04:04:58,051 [trainer.py] => CNN top5 curve: [99.05, 96.81, 95.25, 94.63, 92.73, 91.8, 91.01, 90.71, 89.39, 88.74, 88.68, 88.2, 87.82, 87.4, 87.51, 87.05, 86.49, 86.31, 85.69, 85.58]

Average Accuracy (CNN): 74.27
2024-09-08 04:04:58,051 [trainer.py] => Average Accuracy (CNN): 74.27 

Accuracy Matrix (CNN):
[[88.96 82.97 83.28 80.76 79.18 80.13 79.81 78.55 79.5  79.18 79.18 77.6
  79.18 77.92 76.34 76.66 76.66 76.03 75.71 74.76]
 [ 0.   86.56 84.95 83.6  84.14 84.68 83.87 82.8  82.53 81.72 80.65 79.03
  79.03 79.84 79.84 79.3  79.3  79.57 79.03 77.96]
 [ 0.    0.   78.67 75.   75.   74.33 74.   74.   73.   73.   72.   72.67
  71.67 72.   72.33 71.67 71.   71.33 70.67 70.67]
 [ 0.    0.    0.   84.34 84.94 84.04 83.13 82.53 82.53 82.83 82.23 81.93
  81.93 81.93 82.23 81.33 81.33 80.42 81.63 81.63]
 [ 0.    0.    0.    0.   69.21 67.88 68.21 65.89 65.23 65.23 63.25 63.58
  63.58 63.25 61.26 60.6  60.26 60.26 61.26 60.6 ]
 [ 0.    0.    0.    0.    0.   68.09 68.09 68.09 67.43 67.43 67.11 66.78
  64.8  65.46 67.43 66.78 67.11 66.78 67.11 65.79]
 [ 0.    0.    0.    0.    0.    0.   70.47 69.8  68.46 68.46 69.13 69.46
  68.12 67.79 67.79 68.12 67.79 68.12 67.11 67.45]
 [ 0.    0.    0.    0.    0.    0.    0.   71.79 72.16 71.43 71.06 69.96
  70.33 70.33 70.33 69.96 69.6  69.23 68.86 69.23]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   64.52 65.16 63.87 63.87
  62.9  62.9  63.23 62.58 63.87 62.58 61.94 61.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   57.63 57.06 58.19
  57.06 56.5  55.93 56.5  57.63 55.37 55.37 54.24]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   71.83 70.42
  70.77 70.07 68.31 67.96 68.31 68.31 67.61 66.9 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   72.61
  73.14 73.14 72.61 71.81 71.81 71.54 70.74 71.01]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  60.52 60.89 60.52 60.52 59.41 57.93 57.93 56.09]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   72.15 72.15 72.82 71.48 72.48 72.15 71.14]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   68.12 68.39 68.12 68.12 67.57 68.12]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   65.47 65.47 66.02 65.47 65.75]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   59.57 56.96 57.39 56.52]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   78.23 77.02 76.21]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   63.64 63.31]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   58.67]]
2024-09-08 04:04:58,055 [trainer.py] => Forgetting (CNN): 4.102631578947365
2024-09-08 04:05:00,872 [trainer.py] => config: ./exps/coda_prompt_inr_B100_Inc5.json
2024-09-08 04:05:00,883 [trainer.py] => prefix:  
2024-09-08 04:05:00,883 [trainer.py] => dataset: imagenetr
2024-09-08 04:05:00,883 [trainer.py] => memory_size: 0
2024-09-08 04:05:00,883 [trainer.py] => memory_per_class: 0
2024-09-08 04:05:00,883 [trainer.py] => fixed_memory: False
2024-09-08 04:05:00,883 [trainer.py] => shuffle: True
2024-09-08 04:05:00,883 [trainer.py] => init_cls: 100
2024-09-08 04:05:00,883 [trainer.py] => increment: 20
2024-09-08 04:05:00,883 [trainer.py] => model_name: coda_prompt
2024-09-08 04:05:00,883 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-08 04:05:00,883 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 04:05:00,883 [trainer.py] => seed: 1993
2024-09-08 04:05:00,884 [trainer.py] => tuned_epoch: 20
2024-09-08 04:05:00,884 [trainer.py] => init_lr: 0.001
2024-09-08 04:05:00,884 [trainer.py] => batch_size: 48
2024-09-08 04:05:00,884 [trainer.py] => weight_decay: 0
2024-09-08 04:05:00,884 [trainer.py] => min_lr: 1e-05
2024-09-08 04:05:00,884 [trainer.py] => optimizer: adam
2024-09-08 04:05:00,884 [trainer.py] => scheduler: cosine
2024-09-08 04:05:00,884 [trainer.py] => reinit_optimizer: True
2024-09-08 04:05:00,884 [trainer.py] => pretrained: True
2024-09-08 04:05:00,884 [trainer.py] => drop: 0.0
2024-09-08 04:05:00,884 [trainer.py] => drop_path: 0.0
2024-09-08 04:05:00,884 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-08 04:05:00,968 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-08 04:05:03,016 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-08 04:05:03,016 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-08 04:05:03,017 [trainer.py] => All params: 89792456
2024-09-08 04:05:03,017 [trainer.py] => Trainable params: 89792456
2024-09-08 04:05:03,017 [coda_prompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.186, Train_accy 52.31:   0%|          | 0/20 [02:11<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.186, Train_accy 52.31:   5%|▌         | 1/20 [02:11<41:42, 131.68s/it]
Task 0, Epoch 2/20 => Loss 1.042, Train_accy 74.43:   5%|▌         | 1/20 [04:23<41:42, 131.68s/it]
Task 0, Epoch 2/20 => Loss 1.042, Train_accy 74.43:  10%|█         | 2/20 [04:23<39:27, 131.51s/it]
Task 0, Epoch 3/20 => Loss 0.835, Train_accy 78.76:  10%|█         | 2/20 [06:34<39:27, 131.51s/it]
Task 0, Epoch 3/20 => Loss 0.835, Train_accy 78.76:  15%|█▌        | 3/20 [06:34<37:14, 131.46s/it]
Task 0, Epoch 4/20 => Loss 0.736, Train_accy 81.31:  15%|█▌        | 3/20 [08:45<37:14, 131.46s/it]
Task 0, Epoch 4/20 => Loss 0.736, Train_accy 81.31:  20%|██        | 4/20 [08:45<35:02, 131.42s/it]
Task 0, Epoch 5/20 => Loss 0.665, Train_accy 83.23, Test_accy 80.67:  20%|██        | 4/20 [11:13<35:02, 131.42s/it]
Task 0, Epoch 5/20 => Loss 0.665, Train_accy 83.23, Test_accy 80.67:  25%|██▌       | 5/20 [11:13<34:21, 137.46s/it]
Task 0, Epoch 6/20 => Loss 0.599, Train_accy 84.86:  25%|██▌       | 5/20 [13:25<34:21, 137.46s/it]                 
Task 0, Epoch 6/20 => Loss 0.599, Train_accy 84.86:  30%|███       | 6/20 [13:25<31:35, 135.42s/it]
Task 0, Epoch 7/20 => Loss 0.573, Train_accy 85.53:  30%|███       | 6/20 [15:36<31:35, 135.42s/it]
Task 0, Epoch 7/20 => Loss 0.573, Train_accy 85.53:  35%|███▌      | 7/20 [15:36<29:03, 134.09s/it]
Task 0, Epoch 8/20 => Loss 0.533, Train_accy 86.24:  35%|███▌      | 7/20 [17:48<29:03, 134.09s/it]
Task 0, Epoch 8/20 => Loss 0.533, Train_accy 86.24:  40%|████      | 8/20 [17:48<26:38, 133.24s/it]
Task 0, Epoch 9/20 => Loss 0.519, Train_accy 86.85:  40%|████      | 8/20 [19:59<26:38, 133.24s/it]
Task 0, Epoch 9/20 => Loss 0.519, Train_accy 86.85:  45%|████▌     | 9/20 [19:59<24:19, 132.64s/it]
Task 0, Epoch 10/20 => Loss 0.481, Train_accy 87.53, Test_accy 80.13:  45%|████▌     | 9/20 [22:27<24:19, 132.64s/it]
Task 0, Epoch 10/20 => Loss 0.481, Train_accy 87.53, Test_accy 80.13:  50%|█████     | 10/20 [22:27<22:54, 137.49s/it]
Task 0, Epoch 11/20 => Loss 0.491, Train_accy 87.52:  50%|█████     | 10/20 [24:39<22:54, 137.49s/it]                 
Task 0, Epoch 11/20 => Loss 0.491, Train_accy 87.52:  55%|█████▌    | 11/20 [24:39<20:20, 135.65s/it]
Task 0, Epoch 12/20 => Loss 0.444, Train_accy 88.69:  55%|█████▌    | 11/20 [26:50<20:20, 135.65s/it]
Task 0, Epoch 12/20 => Loss 0.444, Train_accy 88.69:  60%|██████    | 12/20 [26:50<17:54, 134.37s/it]
Task 0, Epoch 13/20 => Loss 0.435, Train_accy 88.92:  60%|██████    | 12/20 [29:02<17:54, 134.37s/it]
Task 0, Epoch 13/20 => Loss 0.435, Train_accy 88.92:  65%|██████▌   | 13/20 [29:02<15:33, 133.41s/it]
Task 0, Epoch 14/20 => Loss 0.441, Train_accy 88.73:  65%|██████▌   | 13/20 [31:13<15:33, 133.41s/it]
Task 0, Epoch 14/20 => Loss 0.441, Train_accy 88.73:  70%|███████   | 14/20 [31:13<13:16, 132.78s/it]
Task 0, Epoch 15/20 => Loss 0.404, Train_accy 89.58, Test_accy 79.70:  70%|███████   | 14/20 [33:41<13:16, 132.78s/it]
Task 0, Epoch 15/20 => Loss 0.404, Train_accy 89.58, Test_accy 79.70:  75%|███████▌  | 15/20 [33:41<11:27, 137.50s/it]
Task 0, Epoch 16/20 => Loss 0.400, Train_accy 90.00:  75%|███████▌  | 15/20 [35:53<11:27, 137.50s/it]                 
Task 0, Epoch 16/20 => Loss 0.400, Train_accy 90.00:  80%|████████  | 16/20 [35:53<09:02, 135.64s/it]
Task 0, Epoch 17/20 => Loss 0.370, Train_accy 90.37:  80%|████████  | 16/20 [38:04<09:02, 135.64s/it]
Task 0, Epoch 17/20 => Loss 0.370, Train_accy 90.37:  85%|████████▌ | 17/20 [38:04<06:43, 134.34s/it]
Task 0, Epoch 18/20 => Loss 0.368, Train_accy 90.46:  85%|████████▌ | 17/20 [40:15<06:43, 134.34s/it]
Task 0, Epoch 18/20 => Loss 0.368, Train_accy 90.46:  90%|█████████ | 18/20 [40:15<04:26, 133.43s/it]
Task 0, Epoch 19/20 => Loss 0.342, Train_accy 91.39:  90%|█████████ | 18/20 [42:27<04:26, 133.43s/it]
Task 0, Epoch 19/20 => Loss 0.342, Train_accy 91.39:  95%|█████████▌| 19/20 [42:27<02:12, 132.79s/it]
Task 0, Epoch 20/20 => Loss 0.337, Train_accy 91.41, Test_accy 80.94:  95%|█████████▌| 19/20 [44:55<02:12, 132.79s/it]
Task 0, Epoch 20/20 => Loss 0.337, Train_accy 91.41, Test_accy 80.94: 100%|██████████| 20/20 [44:55<00:00, 137.51s/it]
Task 0, Epoch 20/20 => Loss 0.337, Train_accy 91.41, Test_accy 80.94: 100%|██████████| 20/20 [44:55<00:00, 134.78s/it]
2024-09-08 04:49:59,032 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.337, Train_accy 91.41, Test_accy 80.94
2024-09-08 04:50:16,015 [trainer.py] => No NME accuracy.
2024-09-08 04:50:16,015 [trainer.py] => CNN: {'total': 80.94, '00-99': 80.94, 'old': 0, 'new': 80.94}
2024-09-08 04:50:16,016 [trainer.py] => CNN top1 curve: [80.94]
2024-09-08 04:50:16,016 [trainer.py] => CNN top5 curve: [91.93]

Average Accuracy (CNN): 80.94
2024-09-08 04:50:16,016 [trainer.py] => Average Accuracy (CNN): 80.94 

2024-09-08 04:50:16,017 [trainer.py] => All params: 89792456
2024-09-08 04:50:16,018 [trainer.py] => Trainable params: 89792456
2024-09-08 04:50:16,766 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.334, Train_accy 62.61:   0%|          | 0/20 [00:29<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.334, Train_accy 62.61:   5%|▌         | 1/20 [00:29<09:12, 29.06s/it]
Task 1, Epoch 2/20 => Loss 0.489, Train_accy 85.87:   5%|▌         | 1/20 [00:58<09:12, 29.06s/it]
Task 1, Epoch 2/20 => Loss 0.489, Train_accy 85.87:  10%|█         | 2/20 [00:58<08:41, 29.00s/it]
Task 1, Epoch 3/20 => Loss 0.367, Train_accy 88.75:  10%|█         | 2/20 [01:27<08:41, 29.00s/it]
Task 1, Epoch 3/20 => Loss 0.367, Train_accy 88.75:  15%|█▌        | 3/20 [01:27<08:13, 29.00s/it]
Task 1, Epoch 4/20 => Loss 0.301, Train_accy 91.10:  15%|█▌        | 3/20 [01:56<08:13, 29.00s/it]
Task 1, Epoch 4/20 => Loss 0.301, Train_accy 91.10:  20%|██        | 4/20 [01:56<07:44, 29.01s/it]
Task 1, Epoch 5/20 => Loss 0.286, Train_accy 91.82, Test_accy 75.67:  20%|██        | 4/20 [02:45<07:44, 29.01s/it]
Task 1, Epoch 5/20 => Loss 0.286, Train_accy 91.82, Test_accy 75.67:  25%|██▌       | 5/20 [02:45<09:06, 36.43s/it]
Task 1, Epoch 6/20 => Loss 0.235, Train_accy 92.69:  25%|██▌       | 5/20 [03:14<09:06, 36.43s/it]                 
Task 1, Epoch 6/20 => Loss 0.235, Train_accy 92.69:  30%|███       | 6/20 [03:14<07:54, 33.90s/it]
Task 1, Epoch 7/20 => Loss 0.241, Train_accy 92.88:  30%|███       | 6/20 [03:43<07:54, 33.90s/it]
Task 1, Epoch 7/20 => Loss 0.241, Train_accy 92.88:  35%|███▌      | 7/20 [03:43<06:59, 32.29s/it]
Task 1, Epoch 8/20 => Loss 0.217, Train_accy 93.64:  35%|███▌      | 7/20 [04:12<06:59, 32.29s/it]
Task 1, Epoch 8/20 => Loss 0.217, Train_accy 93.64:  40%|████      | 8/20 [04:12<06:14, 31.24s/it]
Task 1, Epoch 9/20 => Loss 0.214, Train_accy 93.52:  40%|████      | 8/20 [04:41<06:14, 31.24s/it]
Task 1, Epoch 9/20 => Loss 0.214, Train_accy 93.52:  45%|████▌     | 9/20 [04:41<05:36, 30.55s/it]
Task 1, Epoch 10/20 => Loss 0.209, Train_accy 93.90, Test_accy 77.01:  45%|████▌     | 9/20 [05:31<05:36, 30.55s/it]
Task 1, Epoch 10/20 => Loss 0.209, Train_accy 93.90, Test_accy 77.01:  50%|█████     | 10/20 [05:31<06:04, 36.43s/it]
Task 1, Epoch 11/20 => Loss 0.197, Train_accy 94.24:  50%|█████     | 10/20 [06:00<06:04, 36.43s/it]                 
Task 1, Epoch 11/20 => Loss 0.197, Train_accy 94.24:  55%|█████▌    | 11/20 [06:00<05:07, 34.17s/it]
Task 1, Epoch 12/20 => Loss 0.168, Train_accy 95.49:  55%|█████▌    | 11/20 [06:29<05:07, 34.17s/it]
Task 1, Epoch 12/20 => Loss 0.168, Train_accy 95.49:  60%|██████    | 12/20 [06:29<04:21, 32.63s/it]
Task 1, Epoch 13/20 => Loss 0.215, Train_accy 93.64:  60%|██████    | 12/20 [06:58<04:21, 32.63s/it]
Task 1, Epoch 13/20 => Loss 0.215, Train_accy 93.64:  65%|██████▌   | 13/20 [06:58<03:40, 31.52s/it]
Task 1, Epoch 14/20 => Loss 0.172, Train_accy 95.15:  65%|██████▌   | 13/20 [07:27<03:40, 31.52s/it]
Task 1, Epoch 14/20 => Loss 0.172, Train_accy 95.15:  70%|███████   | 14/20 [07:27<03:04, 30.80s/it]
Task 1, Epoch 15/20 => Loss 0.177, Train_accy 94.81, Test_accy 77.20:  70%|███████   | 14/20 [08:17<03:04, 30.80s/it]
Task 1, Epoch 15/20 => Loss 0.177, Train_accy 94.81, Test_accy 77.20:  75%|███████▌  | 15/20 [08:17<03:02, 36.45s/it]
Task 1, Epoch 16/20 => Loss 0.150, Train_accy 95.57:  75%|███████▌  | 15/20 [08:45<03:02, 36.45s/it]                 
Task 1, Epoch 16/20 => Loss 0.150, Train_accy 95.57:  80%|████████  | 16/20 [08:45<02:16, 34.20s/it]
Task 1, Epoch 17/20 => Loss 0.156, Train_accy 95.38:  80%|████████  | 16/20 [09:14<02:16, 34.20s/it]
Task 1, Epoch 17/20 => Loss 0.156, Train_accy 95.38:  85%|████████▌ | 17/20 [09:14<01:37, 32.61s/it]
Task 1, Epoch 18/20 => Loss 0.136, Train_accy 95.91:  85%|████████▌ | 17/20 [09:43<01:37, 32.61s/it]
Task 1, Epoch 18/20 => Loss 0.136, Train_accy 95.91:  90%|█████████ | 18/20 [09:43<01:03, 31.54s/it]
Task 1, Epoch 19/20 => Loss 0.146, Train_accy 96.02:  90%|█████████ | 18/20 [10:12<01:03, 31.54s/it]
Task 1, Epoch 19/20 => Loss 0.146, Train_accy 96.02:  95%|█████████▌| 19/20 [10:12<00:30, 30.77s/it]
Task 1, Epoch 20/20 => Loss 0.147, Train_accy 95.72, Test_accy 77.15:  95%|█████████▌| 19/20 [11:02<00:30, 30.77s/it]
Task 1, Epoch 20/20 => Loss 0.147, Train_accy 95.72, Test_accy 77.15: 100%|██████████| 20/20 [11:02<00:00, 36.44s/it]
Task 1, Epoch 20/20 => Loss 0.147, Train_accy 95.72, Test_accy 77.15: 100%|██████████| 20/20 [11:02<00:00, 33.13s/it]
2024-09-08 05:01:19,348 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.147, Train_accy 95.72, Test_accy 77.15
2024-09-08 05:01:39,914 [trainer.py] => No NME accuracy.
2024-09-08 05:01:39,915 [trainer.py] => CNN: {'total': 77.15, '00-99': 80.94, '100-119': 60.0, 'old': 80.94, 'new': 60.0}
2024-09-08 05:01:39,915 [trainer.py] => CNN top1 curve: [80.94, 77.15]
2024-09-08 05:01:39,915 [trainer.py] => CNN top5 curve: [91.93, 91.47]

Average Accuracy (CNN): 79.04
2024-09-08 05:01:39,915 [trainer.py] => Average Accuracy (CNN): 79.04 

2024-09-08 05:01:39,917 [trainer.py] => All params: 89792456
2024-09-08 05:01:39,917 [trainer.py] => Trainable params: 89792456
2024-09-08 05:01:41,247 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.537, Train_accy 58.71:   0%|          | 0/20 [00:23<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.537, Train_accy 58.71:   5%|▌         | 1/20 [00:23<07:21, 23.23s/it]
Task 2, Epoch 2/20 => Loss 0.548, Train_accy 83.33:   5%|▌         | 1/20 [00:46<07:21, 23.23s/it]
Task 2, Epoch 2/20 => Loss 0.548, Train_accy 83.33:  10%|█         | 2/20 [00:46<06:58, 23.27s/it]
Task 2, Epoch 3/20 => Loss 0.396, Train_accy 88.40:  10%|█         | 2/20 [01:09<06:58, 23.27s/it]
Task 2, Epoch 3/20 => Loss 0.396, Train_accy 88.40:  15%|█▌        | 3/20 [01:09<06:36, 23.30s/it]
Task 2, Epoch 4/20 => Loss 0.293, Train_accy 91.48:  15%|█▌        | 3/20 [01:33<06:36, 23.30s/it]
Task 2, Epoch 4/20 => Loss 0.293, Train_accy 91.48:  20%|██        | 4/20 [01:33<06:12, 23.31s/it]
Task 2, Epoch 5/20 => Loss 0.272, Train_accy 92.09, Test_accy 72.02:  20%|██        | 4/20 [02:20<06:12, 23.31s/it]
Task 2, Epoch 5/20 => Loss 0.272, Train_accy 92.09, Test_accy 72.02:  25%|██▌       | 5/20 [02:20<07:58, 31.87s/it]
Task 2, Epoch 6/20 => Loss 0.246, Train_accy 92.71:  25%|██▌       | 5/20 [02:43<07:58, 31.87s/it]                 
Task 2, Epoch 6/20 => Loss 0.246, Train_accy 92.71:  30%|███       | 6/20 [02:43<06:45, 28.95s/it]
Task 2, Epoch 7/20 => Loss 0.209, Train_accy 93.75:  30%|███       | 6/20 [03:06<06:45, 28.95s/it]
Task 2, Epoch 7/20 => Loss 0.209, Train_accy 93.75:  35%|███▌      | 7/20 [03:06<05:52, 27.10s/it]
Task 2, Epoch 8/20 => Loss 0.203, Train_accy 94.51:  35%|███▌      | 7/20 [03:30<05:52, 27.10s/it]
Task 2, Epoch 8/20 => Loss 0.203, Train_accy 94.51:  40%|████      | 8/20 [03:30<05:10, 25.88s/it]
Task 2, Epoch 9/20 => Loss 0.171, Train_accy 95.45:  40%|████      | 8/20 [03:53<05:10, 25.88s/it]
Task 2, Epoch 9/20 => Loss 0.171, Train_accy 95.45:  45%|████▌     | 9/20 [03:53<04:35, 25.07s/it]
Task 2, Epoch 10/20 => Loss 0.178, Train_accy 95.22, Test_accy 73.14:  45%|████▌     | 9/20 [04:40<04:35, 25.07s/it]
Task 2, Epoch 10/20 => Loss 0.178, Train_accy 95.22, Test_accy 73.14:  50%|█████     | 10/20 [04:40<05:18, 31.84s/it]
Task 2, Epoch 11/20 => Loss 0.215, Train_accy 93.94:  50%|█████     | 10/20 [05:03<05:18, 31.84s/it]                 
Task 2, Epoch 11/20 => Loss 0.215, Train_accy 93.94:  55%|█████▌    | 11/20 [05:03<04:23, 29.22s/it]
Task 2, Epoch 12/20 => Loss 0.174, Train_accy 94.84:  55%|█████▌    | 11/20 [05:26<04:23, 29.22s/it]
Task 2, Epoch 12/20 => Loss 0.174, Train_accy 94.84:  60%|██████    | 12/20 [05:26<03:39, 27.41s/it]
Task 2, Epoch 13/20 => Loss 0.166, Train_accy 94.79:  60%|██████    | 12/20 [05:50<03:39, 27.41s/it]
Task 2, Epoch 13/20 => Loss 0.166, Train_accy 94.79:  65%|██████▌   | 13/20 [05:50<03:03, 26.18s/it]
Task 2, Epoch 14/20 => Loss 0.154, Train_accy 95.60:  65%|██████▌   | 13/20 [06:13<03:03, 26.18s/it]
Task 2, Epoch 14/20 => Loss 0.154, Train_accy 95.60:  70%|███████   | 14/20 [06:13<02:31, 25.31s/it]
Task 2, Epoch 15/20 => Loss 0.150, Train_accy 95.55, Test_accy 73.40:  70%|███████   | 14/20 [07:00<02:31, 25.31s/it]
Task 2, Epoch 15/20 => Loss 0.150, Train_accy 95.55, Test_accy 73.40:  75%|███████▌  | 15/20 [07:00<02:39, 31.87s/it]
Task 2, Epoch 16/20 => Loss 0.147, Train_accy 95.88:  75%|███████▌  | 15/20 [07:23<02:39, 31.87s/it]                 
Task 2, Epoch 16/20 => Loss 0.147, Train_accy 95.88:  80%|████████  | 16/20 [07:23<01:57, 29.28s/it]
Task 2, Epoch 17/20 => Loss 0.138, Train_accy 95.55:  80%|████████  | 16/20 [07:47<01:57, 29.28s/it]
Task 2, Epoch 17/20 => Loss 0.138, Train_accy 95.55:  85%|████████▌ | 17/20 [07:47<01:22, 27.50s/it]
Task 2, Epoch 18/20 => Loss 0.125, Train_accy 96.45:  85%|████████▌ | 17/20 [08:10<01:22, 27.50s/it]
Task 2, Epoch 18/20 => Loss 0.125, Train_accy 96.45:  90%|█████████ | 18/20 [08:10<00:52, 26.25s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 96.12:  90%|█████████ | 18/20 [08:33<00:52, 26.25s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 96.12:  95%|█████████▌| 19/20 [08:33<00:25, 25.38s/it]
Task 2, Epoch 20/20 => Loss 0.136, Train_accy 96.16, Test_accy 73.61:  95%|█████████▌| 19/20 [09:21<00:25, 25.38s/it]
Task 2, Epoch 20/20 => Loss 0.136, Train_accy 96.16, Test_accy 73.61: 100%|██████████| 20/20 [09:21<00:00, 31.90s/it]
Task 2, Epoch 20/20 => Loss 0.136, Train_accy 96.16, Test_accy 73.61: 100%|██████████| 20/20 [09:21<00:00, 28.05s/it]
2024-09-08 05:11:02,300 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.136, Train_accy 96.16, Test_accy 73.61
2024-09-08 05:11:26,217 [trainer.py] => No NME accuracy.
2024-09-08 05:11:26,218 [trainer.py] => CNN: {'total': 73.61, '00-99': 81.24, '100-119': 59.55, '120-139': 49.91, 'old': 77.31, 'new': 49.91}
2024-09-08 05:11:26,218 [trainer.py] => CNN top1 curve: [80.94, 77.15, 73.61]
2024-09-08 05:11:26,218 [trainer.py] => CNN top5 curve: [91.93, 91.47, 90.15]

Average Accuracy (CNN): 77.23
2024-09-08 05:11:26,219 [trainer.py] => Average Accuracy (CNN): 77.23 

2024-09-08 05:11:26,220 [trainer.py] => All params: 89792456
2024-09-08 05:11:26,221 [trainer.py] => Trainable params: 89792456
2024-09-08 05:11:27,993 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.327, Train_accy 64.30:   0%|          | 0/20 [00:30<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.327, Train_accy 64.30:   5%|▌         | 1/20 [00:30<09:40, 30.55s/it]
Task 3, Epoch 2/20 => Loss 0.474, Train_accy 85.92:   5%|▌         | 1/20 [01:01<09:40, 30.55s/it]
Task 3, Epoch 2/20 => Loss 0.474, Train_accy 85.92:  10%|█         | 2/20 [01:01<09:08, 30.50s/it]
Task 3, Epoch 3/20 => Loss 0.383, Train_accy 88.90:  10%|█         | 2/20 [01:31<09:08, 30.50s/it]
Task 3, Epoch 3/20 => Loss 0.383, Train_accy 88.90:  15%|█▌        | 3/20 [01:31<08:38, 30.52s/it]
Task 3, Epoch 4/20 => Loss 0.296, Train_accy 91.59:  15%|█▌        | 3/20 [02:02<08:38, 30.52s/it]
Task 3, Epoch 4/20 => Loss 0.296, Train_accy 91.59:  20%|██        | 4/20 [02:02<08:09, 30.58s/it]
Task 3, Epoch 5/20 => Loss 0.285, Train_accy 92.03, Test_accy 68.80:  20%|██        | 4/20 [03:00<08:09, 30.58s/it]
Task 3, Epoch 5/20 => Loss 0.285, Train_accy 92.03, Test_accy 68.80:  25%|██▌       | 5/20 [03:00<10:09, 40.61s/it]
Task 3, Epoch 6/20 => Loss 0.268, Train_accy 92.35:  25%|██▌       | 5/20 [03:31<10:09, 40.61s/it]                 
Task 3, Epoch 6/20 => Loss 0.268, Train_accy 92.35:  30%|███       | 6/20 [03:31<08:40, 37.21s/it]
Task 3, Epoch 7/20 => Loss 0.224, Train_accy 92.96:  30%|███       | 6/20 [04:01<08:40, 37.21s/it]
Task 3, Epoch 7/20 => Loss 0.224, Train_accy 92.96:  35%|███▌      | 7/20 [04:01<07:35, 35.04s/it]
Task 3, Epoch 8/20 => Loss 0.218, Train_accy 93.64:  35%|███▌      | 7/20 [04:32<07:35, 35.04s/it]
Task 3, Epoch 8/20 => Loss 0.218, Train_accy 93.64:  40%|████      | 8/20 [04:32<06:43, 33.61s/it]
Task 3, Epoch 9/20 => Loss 0.226, Train_accy 93.75:  40%|████      | 8/20 [05:02<06:43, 33.61s/it]
Task 3, Epoch 9/20 => Loss 0.226, Train_accy 93.75:  45%|████▌     | 9/20 [05:02<05:59, 32.67s/it]
Task 3, Epoch 10/20 => Loss 0.202, Train_accy 94.29, Test_accy 70.18:  45%|████▌     | 9/20 [06:01<05:59, 32.67s/it]
Task 3, Epoch 10/20 => Loss 0.202, Train_accy 94.29, Test_accy 70.18:  50%|█████     | 10/20 [06:01<06:46, 40.66s/it]
Task 3, Epoch 11/20 => Loss 0.192, Train_accy 94.58:  50%|█████     | 10/20 [06:32<06:46, 40.66s/it]                 
Task 3, Epoch 11/20 => Loss 0.192, Train_accy 94.58:  55%|█████▌    | 11/20 [06:32<05:38, 37.60s/it]
Task 3, Epoch 12/20 => Loss 0.204, Train_accy 94.36:  55%|█████▌    | 11/20 [07:02<05:38, 37.60s/it]
Task 3, Epoch 12/20 => Loss 0.204, Train_accy 94.36:  60%|██████    | 12/20 [07:02<04:43, 35.48s/it]
Task 3, Epoch 13/20 => Loss 0.177, Train_accy 94.68:  60%|██████    | 12/20 [07:33<04:43, 35.48s/it]
Task 3, Epoch 13/20 => Loss 0.177, Train_accy 94.68:  65%|██████▌   | 13/20 [07:33<03:58, 34.01s/it]
Task 3, Epoch 14/20 => Loss 0.151, Train_accy 95.26:  65%|██████▌   | 13/20 [08:03<03:58, 34.01s/it]
Task 3, Epoch 14/20 => Loss 0.151, Train_accy 95.26:  70%|███████   | 14/20 [08:03<03:17, 32.97s/it]
Task 3, Epoch 15/20 => Loss 0.173, Train_accy 94.83, Test_accy 70.52:  70%|███████   | 14/20 [09:02<03:17, 32.97s/it]
Task 3, Epoch 15/20 => Loss 0.173, Train_accy 94.83, Test_accy 70.52:  75%|███████▌  | 15/20 [09:02<03:23, 40.65s/it]
Task 3, Epoch 16/20 => Loss 0.139, Train_accy 95.91:  75%|███████▌  | 15/20 [09:32<03:23, 40.65s/it]                 
Task 3, Epoch 16/20 => Loss 0.139, Train_accy 95.91:  80%|████████  | 16/20 [09:32<02:30, 37.59s/it]
Task 3, Epoch 17/20 => Loss 0.150, Train_accy 95.87:  80%|████████  | 16/20 [10:03<02:30, 37.59s/it]
Task 3, Epoch 17/20 => Loss 0.150, Train_accy 95.87:  85%|████████▌ | 17/20 [10:03<01:46, 35.49s/it]
Task 3, Epoch 18/20 => Loss 0.161, Train_accy 95.62:  85%|████████▌ | 17/20 [10:34<01:46, 35.49s/it]
Task 3, Epoch 18/20 => Loss 0.161, Train_accy 95.62:  90%|█████████ | 18/20 [10:34<01:08, 34.04s/it]
Task 3, Epoch 19/20 => Loss 0.153, Train_accy 95.40:  90%|█████████ | 18/20 [11:04<01:08, 34.04s/it]
Task 3, Epoch 19/20 => Loss 0.153, Train_accy 95.40:  95%|█████████▌| 19/20 [11:04<00:33, 33.02s/it]
Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.55, Test_accy 70.97:  95%|█████████▌| 19/20 [12:03<00:33, 33.02s/it]
Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.55, Test_accy 70.97: 100%|██████████| 20/20 [12:03<00:00, 40.69s/it]
Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.55, Test_accy 70.97: 100%|██████████| 20/20 [12:03<00:00, 36.17s/it]
2024-09-08 05:23:31,409 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.151, Train_accy 95.55, Test_accy 70.97
2024-09-08 05:23:59,288 [trainer.py] => No NME accuracy.
2024-09-08 05:23:59,289 [trainer.py] => CNN: {'total': 70.97, '00-99': 81.37, '100-119': 59.7, '120-139': 49.21, '140-159': 55.56, 'old': 73.64, 'new': 55.56}
2024-09-08 05:23:59,289 [trainer.py] => CNN top1 curve: [80.94, 77.15, 73.61, 70.97]
2024-09-08 05:23:59,289 [trainer.py] => CNN top5 curve: [91.93, 91.47, 90.15, 89.54]

Average Accuracy (CNN): 75.67
2024-09-08 05:23:59,289 [trainer.py] => Average Accuracy (CNN): 75.67 

2024-09-08 05:23:59,290 [trainer.py] => All params: 89792456
2024-09-08 05:23:59,291 [trainer.py] => Trainable params: 89792456
2024-09-08 05:24:01,610 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.647, Train_accy 54.79:   0%|          | 0/20 [00:21<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.647, Train_accy 54.79:   5%|▌         | 1/20 [00:21<06:45, 21.35s/it]
Task 4, Epoch 2/20 => Loss 0.617, Train_accy 82.81:   5%|▌         | 1/20 [00:42<06:45, 21.35s/it]
Task 4, Epoch 2/20 => Loss 0.617, Train_accy 82.81:  10%|█         | 2/20 [00:42<06:23, 21.30s/it]
Task 4, Epoch 3/20 => Loss 0.484, Train_accy 85.26:  10%|█         | 2/20 [01:03<06:23, 21.30s/it]
Task 4, Epoch 3/20 => Loss 0.484, Train_accy 85.26:  15%|█▌        | 3/20 [01:03<06:01, 21.29s/it]
Task 4, Epoch 4/20 => Loss 0.393, Train_accy 88.80:  15%|█▌        | 3/20 [01:25<06:01, 21.29s/it]
Task 4, Epoch 4/20 => Loss 0.393, Train_accy 88.80:  20%|██        | 4/20 [01:25<05:41, 21.32s/it]
Task 4, Epoch 5/20 => Loss 0.333, Train_accy 90.16, Test_accy 68.38:  20%|██        | 4/20 [02:17<05:41, 21.32s/it]
Task 4, Epoch 5/20 => Loss 0.333, Train_accy 90.16, Test_accy 68.38:  25%|██▌       | 5/20 [02:17<08:04, 32.30s/it]
Task 4, Epoch 6/20 => Loss 0.314, Train_accy 91.04:  25%|██▌       | 5/20 [02:38<08:04, 32.30s/it]                 
Task 4, Epoch 6/20 => Loss 0.314, Train_accy 91.04:  30%|███       | 6/20 [02:38<06:39, 28.54s/it]
Task 4, Epoch 7/20 => Loss 0.275, Train_accy 92.19:  30%|███       | 6/20 [02:59<06:39, 28.54s/it]
Task 4, Epoch 7/20 => Loss 0.275, Train_accy 92.19:  35%|███▌      | 7/20 [02:59<05:40, 26.16s/it]
Task 4, Epoch 8/20 => Loss 0.220, Train_accy 94.22:  35%|███▌      | 7/20 [03:20<05:40, 26.16s/it]
Task 4, Epoch 8/20 => Loss 0.220, Train_accy 94.22:  40%|████      | 8/20 [03:20<04:55, 24.61s/it]
Task 4, Epoch 9/20 => Loss 0.255, Train_accy 92.97:  40%|████      | 8/20 [03:42<04:55, 24.61s/it]
Task 4, Epoch 9/20 => Loss 0.255, Train_accy 92.97:  45%|████▌     | 9/20 [03:42<04:19, 23.58s/it]
Task 4, Epoch 10/20 => Loss 0.237, Train_accy 93.49, Test_accy 69.38:  45%|████▌     | 9/20 [04:33<04:19, 23.58s/it]
Task 4, Epoch 10/20 => Loss 0.237, Train_accy 93.49, Test_accy 69.38:  50%|█████     | 10/20 [04:33<05:22, 32.27s/it]
Task 4, Epoch 11/20 => Loss 0.228, Train_accy 93.28:  50%|█████     | 10/20 [04:55<05:22, 32.27s/it]                 
Task 4, Epoch 11/20 => Loss 0.228, Train_accy 93.28:  55%|█████▌    | 11/20 [04:55<04:19, 28.88s/it]
Task 4, Epoch 12/20 => Loss 0.220, Train_accy 93.65:  55%|█████▌    | 11/20 [05:16<04:19, 28.88s/it]
Task 4, Epoch 12/20 => Loss 0.220, Train_accy 93.65:  60%|██████    | 12/20 [05:16<03:32, 26.55s/it]
Task 4, Epoch 13/20 => Loss 0.192, Train_accy 94.64:  60%|██████    | 12/20 [05:37<03:32, 26.55s/it]
Task 4, Epoch 13/20 => Loss 0.192, Train_accy 94.64:  65%|██████▌   | 13/20 [05:37<02:54, 24.95s/it]
Task 4, Epoch 14/20 => Loss 0.213, Train_accy 93.75:  65%|██████▌   | 13/20 [05:58<02:54, 24.95s/it]
Task 4, Epoch 14/20 => Loss 0.213, Train_accy 93.75:  70%|███████   | 14/20 [05:58<02:23, 23.85s/it]
Task 4, Epoch 15/20 => Loss 0.201, Train_accy 94.32, Test_accy 69.16:  70%|███████   | 14/20 [06:50<02:23, 23.85s/it]
Task 4, Epoch 15/20 => Loss 0.201, Train_accy 94.32, Test_accy 69.16:  75%|███████▌  | 15/20 [06:50<02:41, 32.22s/it]
Task 4, Epoch 16/20 => Loss 0.186, Train_accy 94.58:  75%|███████▌  | 15/20 [07:11<02:41, 32.22s/it]                 
Task 4, Epoch 16/20 => Loss 0.186, Train_accy 94.58:  80%|████████  | 16/20 [07:11<01:55, 28.92s/it]
Task 4, Epoch 17/20 => Loss 0.187, Train_accy 94.48:  80%|████████  | 16/20 [07:33<01:55, 28.92s/it]
Task 4, Epoch 17/20 => Loss 0.187, Train_accy 94.48:  85%|████████▌ | 17/20 [07:33<01:19, 26.64s/it]
Task 4, Epoch 18/20 => Loss 0.200, Train_accy 94.48:  85%|████████▌ | 17/20 [07:54<01:19, 26.64s/it]
Task 4, Epoch 18/20 => Loss 0.200, Train_accy 94.48:  90%|█████████ | 18/20 [07:54<00:50, 25.02s/it]
Task 4, Epoch 19/20 => Loss 0.165, Train_accy 95.57:  90%|█████████ | 18/20 [08:15<00:50, 25.02s/it]
Task 4, Epoch 19/20 => Loss 0.165, Train_accy 95.57:  95%|█████████▌| 19/20 [08:15<00:23, 23.91s/it]
Task 4, Epoch 20/20 => Loss 0.174, Train_accy 95.36, Test_accy 69.27:  95%|█████████▌| 19/20 [09:07<00:23, 23.91s/it]
Task 4, Epoch 20/20 => Loss 0.174, Train_accy 95.36, Test_accy 69.27: 100%|██████████| 20/20 [09:07<00:00, 32.27s/it]
Task 4, Epoch 20/20 => Loss 0.174, Train_accy 95.36, Test_accy 69.27: 100%|██████████| 20/20 [09:07<00:00, 27.37s/it]
2024-09-08 05:33:09,027 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.174, Train_accy 95.36, Test_accy 69.27
2024-09-08 05:33:39,579 [trainer.py] => No NME accuracy.
2024-09-08 05:33:39,579 [trainer.py] => CNN: {'total': 69.27, '00-99': 81.34, '100-119': 60.15, '120-139': 49.74, '140-159': 54.6, '160-179': 52.09, 'old': 70.93, 'new': 52.09}
2024-09-08 05:33:39,580 [trainer.py] => CNN top1 curve: [80.94, 77.15, 73.61, 70.97, 69.27]
2024-09-08 05:33:39,580 [trainer.py] => CNN top5 curve: [91.93, 91.47, 90.15, 89.54, 88.21]

Average Accuracy (CNN): 74.39
2024-09-08 05:33:39,580 [trainer.py] => Average Accuracy (CNN): 74.39 

2024-09-08 05:33:39,581 [trainer.py] => All params: 89792456
2024-09-08 05:33:39,582 [trainer.py] => Trainable params: 89792456
2024-09-08 05:33:42,575 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.373, Train_accy 63.56:   0%|          | 0/20 [00:24<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.373, Train_accy 63.56:   5%|▌         | 1/20 [00:24<07:53, 24.94s/it]
Task 5, Epoch 2/20 => Loss 0.506, Train_accy 84.80:   5%|▌         | 1/20 [00:49<07:53, 24.94s/it]
Task 5, Epoch 2/20 => Loss 0.506, Train_accy 84.80:  10%|█         | 2/20 [00:49<07:28, 24.92s/it]
Task 5, Epoch 3/20 => Loss 0.377, Train_accy 88.56:  10%|█         | 2/20 [01:14<07:28, 24.92s/it]
Task 5, Epoch 3/20 => Loss 0.377, Train_accy 88.56:  15%|█▌        | 3/20 [01:14<07:03, 24.92s/it]
Task 5, Epoch 4/20 => Loss 0.323, Train_accy 90.20:  15%|█▌        | 3/20 [01:39<07:03, 24.92s/it]
Task 5, Epoch 4/20 => Loss 0.323, Train_accy 90.20:  20%|██        | 4/20 [01:39<06:39, 24.98s/it]
Task 5, Epoch 5/20 => Loss 0.273, Train_accy 92.15, Test_accy 65.55:  20%|██        | 4/20 [02:38<06:39, 24.98s/it]
Task 5, Epoch 5/20 => Loss 0.273, Train_accy 92.15, Test_accy 65.55:  25%|██▌       | 5/20 [02:38<09:16, 37.07s/it]
Task 5, Epoch 6/20 => Loss 0.254, Train_accy 93.09:  25%|██▌       | 5/20 [03:03<09:16, 37.07s/it]                 
Task 5, Epoch 6/20 => Loss 0.254, Train_accy 93.09:  30%|███       | 6/20 [03:03<07:41, 32.94s/it]
Task 5, Epoch 7/20 => Loss 0.205, Train_accy 94.02:  30%|███       | 6/20 [03:28<07:41, 32.94s/it]
Task 5, Epoch 7/20 => Loss 0.205, Train_accy 94.02:  35%|███▌      | 7/20 [03:28<06:34, 30.32s/it]
Task 5, Epoch 8/20 => Loss 0.206, Train_accy 93.88:  35%|███▌      | 7/20 [03:53<06:34, 30.32s/it]
Task 5, Epoch 8/20 => Loss 0.206, Train_accy 93.88:  40%|████      | 8/20 [03:53<05:43, 28.61s/it]
Task 5, Epoch 9/20 => Loss 0.181, Train_accy 94.28:  40%|████      | 8/20 [04:18<05:43, 28.61s/it]
Task 5, Epoch 9/20 => Loss 0.181, Train_accy 94.28:  45%|████▌     | 9/20 [04:18<05:02, 27.46s/it]
Task 5, Epoch 10/20 => Loss 0.189, Train_accy 94.68, Test_accy 66.37:  45%|████▌     | 9/20 [05:16<05:02, 27.46s/it]
Task 5, Epoch 10/20 => Loss 0.189, Train_accy 94.68, Test_accy 66.37:  50%|█████     | 10/20 [05:16<06:11, 37.11s/it]
Task 5, Epoch 11/20 => Loss 0.178, Train_accy 94.55:  50%|█████     | 10/20 [05:41<06:11, 37.11s/it]                 
Task 5, Epoch 11/20 => Loss 0.178, Train_accy 94.55:  55%|█████▌    | 11/20 [05:41<05:00, 33.38s/it]
Task 5, Epoch 12/20 => Loss 0.174, Train_accy 95.26:  55%|█████▌    | 11/20 [06:06<05:00, 33.38s/it]
Task 5, Epoch 12/20 => Loss 0.174, Train_accy 95.26:  60%|██████    | 12/20 [06:06<04:06, 30.81s/it]
Task 5, Epoch 13/20 => Loss 0.186, Train_accy 94.73:  60%|██████    | 12/20 [06:31<04:06, 30.81s/it]
Task 5, Epoch 13/20 => Loss 0.186, Train_accy 94.73:  65%|██████▌   | 13/20 [06:31<03:23, 29.01s/it]
Task 5, Epoch 14/20 => Loss 0.144, Train_accy 96.14:  65%|██████▌   | 13/20 [06:56<03:23, 29.01s/it]
Task 5, Epoch 14/20 => Loss 0.144, Train_accy 96.14:  70%|███████   | 14/20 [06:56<02:46, 27.79s/it]
Task 5, Epoch 15/20 => Loss 0.165, Train_accy 94.95, Test_accy 66.75:  70%|███████   | 14/20 [07:55<02:46, 27.79s/it]
Task 5, Epoch 15/20 => Loss 0.165, Train_accy 94.95, Test_accy 66.75:  75%|███████▌  | 15/20 [07:55<03:05, 37.11s/it]
Task 5, Epoch 16/20 => Loss 0.169, Train_accy 95.43:  75%|███████▌  | 15/20 [08:20<03:05, 37.11s/it]                 
Task 5, Epoch 16/20 => Loss 0.169, Train_accy 95.43:  80%|████████  | 16/20 [08:20<02:13, 33.44s/it]
Task 5, Epoch 17/20 => Loss 0.145, Train_accy 95.48:  80%|████████  | 16/20 [08:45<02:13, 33.44s/it]
Task 5, Epoch 17/20 => Loss 0.145, Train_accy 95.48:  85%|████████▌ | 17/20 [08:45<01:32, 30.89s/it]
Task 5, Epoch 18/20 => Loss 0.151, Train_accy 95.12:  85%|████████▌ | 17/20 [09:10<01:32, 30.89s/it]
Task 5, Epoch 18/20 => Loss 0.151, Train_accy 95.12:  90%|█████████ | 18/20 [09:10<00:58, 29.11s/it]
Task 5, Epoch 19/20 => Loss 0.152, Train_accy 95.12:  90%|█████████ | 18/20 [09:34<00:58, 29.11s/it]
Task 5, Epoch 19/20 => Loss 0.152, Train_accy 95.12:  95%|█████████▌| 19/20 [09:34<00:27, 27.85s/it]
Task 5, Epoch 20/20 => Loss 0.146, Train_accy 96.23, Test_accy 66.95:  95%|█████████▌| 19/20 [10:33<00:27, 27.85s/it]
Task 5, Epoch 20/20 => Loss 0.146, Train_accy 96.23, Test_accy 66.95: 100%|██████████| 20/20 [10:33<00:00, 37.13s/it]
Task 5, Epoch 20/20 => Loss 0.146, Train_accy 96.23, Test_accy 66.95: 100%|██████████| 20/20 [10:33<00:00, 31.69s/it]
2024-09-08 05:44:16,293 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.146, Train_accy 96.23, Test_accy 66.95
2024-09-08 05:44:50,058 [trainer.py] => No NME accuracy.
2024-09-08 05:44:50,059 [trainer.py] => CNN: {'total': 66.95, '00-99': 81.54, '100-119': 60.45, '120-139': 48.86, '140-159': 54.46, '160-179': 51.67, '180-199': 45.25, 'old': 69.27, 'new': 45.25}
2024-09-08 05:44:50,059 [trainer.py] => CNN top1 curve: [80.94, 77.15, 73.61, 70.97, 69.27, 66.95]
2024-09-08 05:44:50,059 [trainer.py] => CNN top5 curve: [91.93, 91.47, 90.15, 89.54, 88.21, 87.77]

Average Accuracy (CNN): 73.15
2024-09-08 05:44:50,059 [trainer.py] => Average Accuracy (CNN): 73.15 

Accuracy Matrix (CNN):
[[80.94 80.94 81.24 81.37 81.34 81.54]
 [ 0.   60.   59.55 59.7  60.15 60.45]
 [ 0.    0.   49.91 49.21 49.74 48.86]
 [ 0.    0.    0.   55.56 54.6  54.46]
 [ 0.    0.    0.    0.   52.09 51.67]
 [ 0.    0.    0.    0.    0.   45.25]]
2024-09-08 05:44:50,061 [trainer.py] => Forgetting (CNN): 0.514
2024-09-08 05:44:52,805 [trainer.py] => config: ./exps/coda_prompt_inr_B100_Inc10.json
2024-09-08 05:44:52,805 [trainer.py] => prefix:  
2024-09-08 05:44:52,805 [trainer.py] => dataset: imagenetr
2024-09-08 05:44:52,805 [trainer.py] => memory_size: 0
2024-09-08 05:44:52,805 [trainer.py] => memory_per_class: 0
2024-09-08 05:44:52,805 [trainer.py] => fixed_memory: False
2024-09-08 05:44:52,805 [trainer.py] => shuffle: True
2024-09-08 05:44:52,805 [trainer.py] => init_cls: 100
2024-09-08 05:44:52,805 [trainer.py] => increment: 10
2024-09-08 05:44:52,805 [trainer.py] => model_name: coda_prompt
2024-09-08 05:44:52,805 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-08 05:44:52,806 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 05:44:52,806 [trainer.py] => seed: 1993
2024-09-08 05:44:52,806 [trainer.py] => tuned_epoch: 20
2024-09-08 05:44:52,806 [trainer.py] => init_lr: 0.001
2024-09-08 05:44:52,806 [trainer.py] => batch_size: 48
2024-09-08 05:44:52,806 [trainer.py] => weight_decay: 0
2024-09-08 05:44:52,806 [trainer.py] => min_lr: 1e-05
2024-09-08 05:44:52,806 [trainer.py] => optimizer: adam
2024-09-08 05:44:52,806 [trainer.py] => scheduler: cosine
2024-09-08 05:44:52,806 [trainer.py] => reinit_optimizer: True
2024-09-08 05:44:52,806 [trainer.py] => pretrained: True
2024-09-08 05:44:52,806 [trainer.py] => drop: 0.0
2024-09-08 05:44:52,806 [trainer.py] => drop_path: 0.0
2024-09-08 05:44:52,806 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-08 05:44:52,889 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-08 05:44:54,768 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-08 05:44:54,769 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-08 05:44:54,769 [trainer.py] => All params: 89792456
2024-09-08 05:44:54,770 [trainer.py] => Trainable params: 89792456
2024-09-08 05:44:54,770 [coda_prompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.229, Train_accy 51.56:   0%|          | 0/20 [02:11<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.229, Train_accy 51.56:   5%|▌         | 1/20 [02:11<41:39, 131.57s/it]
Task 0, Epoch 2/20 => Loss 1.042, Train_accy 74.46:   5%|▌         | 1/20 [04:22<41:39, 131.57s/it]
Task 0, Epoch 2/20 => Loss 1.042, Train_accy 74.46:  10%|█         | 2/20 [04:22<39:26, 131.48s/it]
Task 0, Epoch 3/20 => Loss 0.851, Train_accy 78.90:  10%|█         | 2/20 [06:34<39:26, 131.48s/it]
Task 0, Epoch 3/20 => Loss 0.851, Train_accy 78.90:  15%|█▌        | 3/20 [06:34<37:14, 131.43s/it]
Task 0, Epoch 4/20 => Loss 0.740, Train_accy 81.21:  15%|█▌        | 3/20 [08:45<37:14, 131.43s/it]
Task 0, Epoch 4/20 => Loss 0.740, Train_accy 81.21:  20%|██        | 4/20 [08:45<35:03, 131.47s/it]
Task 0, Epoch 5/20 => Loss 0.658, Train_accy 82.86, Test_accy 79.97:  20%|██        | 4/20 [11:14<35:03, 131.47s/it]
Task 0, Epoch 5/20 => Loss 0.658, Train_accy 82.86, Test_accy 79.97:  25%|██▌       | 5/20 [11:14<34:24, 137.61s/it]
Task 0, Epoch 6/20 => Loss 0.600, Train_accy 84.72:  25%|██▌       | 5/20 [13:25<34:24, 137.61s/it]                 
Task 0, Epoch 6/20 => Loss 0.600, Train_accy 84.72:  30%|███       | 6/20 [13:25<31:37, 135.56s/it]
Task 0, Epoch 7/20 => Loss 0.592, Train_accy 84.70:  30%|███       | 6/20 [15:37<31:37, 135.56s/it]
Task 0, Epoch 7/20 => Loss 0.592, Train_accy 84.70:  35%|███▌      | 7/20 [15:37<29:04, 134.22s/it]
Task 0, Epoch 8/20 => Loss 0.551, Train_accy 86.06:  35%|███▌      | 7/20 [17:48<29:04, 134.22s/it]
Task 0, Epoch 8/20 => Loss 0.551, Train_accy 86.06:  40%|████      | 8/20 [17:48<26:40, 133.36s/it]
Task 0, Epoch 9/20 => Loss 0.515, Train_accy 86.63:  40%|████      | 8/20 [20:00<26:40, 133.36s/it]
Task 0, Epoch 9/20 => Loss 0.515, Train_accy 86.63:  45%|████▌     | 9/20 [20:00<24:20, 132.75s/it]
Task 0, Epoch 10/20 => Loss 0.485, Train_accy 87.50, Test_accy 79.70:  45%|████▌     | 9/20 [22:28<24:20, 132.75s/it]
Task 0, Epoch 10/20 => Loss 0.485, Train_accy 87.50, Test_accy 79.70:  50%|█████     | 10/20 [22:28<22:55, 137.55s/it]
Task 0, Epoch 11/20 => Loss 0.482, Train_accy 87.81:  50%|█████     | 10/20 [24:39<22:55, 137.55s/it]                 
Task 0, Epoch 11/20 => Loss 0.482, Train_accy 87.81:  55%|█████▌    | 11/20 [24:39<20:20, 135.64s/it]
Task 0, Epoch 12/20 => Loss 0.464, Train_accy 88.18:  55%|█████▌    | 11/20 [26:51<20:20, 135.64s/it]
Task 0, Epoch 12/20 => Loss 0.464, Train_accy 88.18:  60%|██████    | 12/20 [26:51<17:55, 134.39s/it]
Task 0, Epoch 13/20 => Loss 0.441, Train_accy 88.58:  60%|██████    | 12/20 [29:02<17:55, 134.39s/it]
Task 0, Epoch 13/20 => Loss 0.441, Train_accy 88.58:  65%|██████▌   | 13/20 [29:02<15:34, 133.50s/it]
Task 0, Epoch 14/20 => Loss 0.436, Train_accy 88.76:  65%|██████▌   | 13/20 [31:14<15:34, 133.50s/it]
Task 0, Epoch 14/20 => Loss 0.436, Train_accy 88.76:  70%|███████   | 14/20 [31:14<13:17, 132.89s/it]
Task 0, Epoch 15/20 => Loss 0.399, Train_accy 89.75, Test_accy 79.73:  70%|███████   | 14/20 [33:42<13:17, 132.89s/it]
Task 0, Epoch 15/20 => Loss 0.399, Train_accy 89.75, Test_accy 79.73:  75%|███████▌  | 15/20 [33:42<11:27, 137.59s/it]
Task 0, Epoch 16/20 => Loss 0.391, Train_accy 89.83:  75%|███████▌  | 15/20 [35:54<11:27, 137.59s/it]                 
Task 0, Epoch 16/20 => Loss 0.391, Train_accy 89.83:  80%|████████  | 16/20 [35:54<09:03, 135.79s/it]
Task 0, Epoch 17/20 => Loss 0.386, Train_accy 90.24:  80%|████████  | 16/20 [38:06<09:03, 135.79s/it]
Task 0, Epoch 17/20 => Loss 0.386, Train_accy 90.24:  85%|████████▌ | 17/20 [38:06<06:43, 134.50s/it]
Task 0, Epoch 18/20 => Loss 0.394, Train_accy 89.96:  85%|████████▌ | 17/20 [40:17<06:43, 134.50s/it]
Task 0, Epoch 18/20 => Loss 0.394, Train_accy 89.96:  90%|█████████ | 18/20 [40:17<04:27, 133.54s/it]
Task 0, Epoch 19/20 => Loss 0.351, Train_accy 90.80:  90%|█████████ | 18/20 [42:28<04:27, 133.54s/it]
Task 0, Epoch 19/20 => Loss 0.351, Train_accy 90.80:  95%|█████████▌| 19/20 [42:28<02:12, 132.94s/it]
Task 0, Epoch 20/20 => Loss 0.350, Train_accy 91.13, Test_accy 79.77:  95%|█████████▌| 19/20 [44:57<02:12, 132.94s/it]
Task 0, Epoch 20/20 => Loss 0.350, Train_accy 91.13, Test_accy 79.77: 100%|██████████| 20/20 [44:57<00:00, 137.57s/it]
Task 0, Epoch 20/20 => Loss 0.350, Train_accy 91.13, Test_accy 79.77: 100%|██████████| 20/20 [44:57<00:00, 134.86s/it]
2024-09-08 06:29:52,537 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.350, Train_accy 91.13, Test_accy 79.77
2024-09-08 06:30:09,490 [trainer.py] => No NME accuracy.
2024-09-08 06:30:09,490 [trainer.py] => CNN: {'total': 79.77, '00-99': 79.77, 'old': 0, 'new': 79.77}
2024-09-08 06:30:09,490 [trainer.py] => CNN top1 curve: [79.77]
2024-09-08 06:30:09,490 [trainer.py] => CNN top5 curve: [92.23]

Average Accuracy (CNN): 79.77
2024-09-08 06:30:09,491 [trainer.py] => Average Accuracy (CNN): 79.77 

2024-09-08 06:30:09,492 [trainer.py] => All params: 89792456
2024-09-08 06:30:09,493 [trainer.py] => Trainable params: 89792456
2024-09-08 06:30:09,744 [coda_prompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.275, Train_accy 59.90:   0%|          | 0/20 [00:13<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.275, Train_accy 59.90:   5%|▌         | 1/20 [00:13<04:08, 13.09s/it]
Task 1, Epoch 2/20 => Loss 0.434, Train_accy 85.85:   5%|▌         | 1/20 [00:26<04:08, 13.09s/it]
Task 1, Epoch 2/20 => Loss 0.434, Train_accy 85.85:  10%|█         | 2/20 [00:26<03:53, 12.99s/it]
Task 1, Epoch 3/20 => Loss 0.290, Train_accy 91.67:  10%|█         | 2/20 [00:38<03:53, 12.99s/it]
Task 1, Epoch 3/20 => Loss 0.290, Train_accy 91.67:  15%|█▌        | 3/20 [00:38<03:39, 12.93s/it]
Task 1, Epoch 4/20 => Loss 0.217, Train_accy 93.66:  15%|█▌        | 3/20 [00:51<03:39, 12.93s/it]
Task 1, Epoch 4/20 => Loss 0.217, Train_accy 93.66:  20%|██        | 4/20 [00:51<03:26, 12.90s/it]
Task 1, Epoch 5/20 => Loss 0.211, Train_accy 93.58, Test_accy 76.20:  20%|██        | 4/20 [01:23<03:26, 12.90s/it]
Task 1, Epoch 5/20 => Loss 0.211, Train_accy 93.58, Test_accy 76.20:  25%|██▌       | 5/20 [01:23<04:53, 19.60s/it]
Task 1, Epoch 6/20 => Loss 0.175, Train_accy 94.53:  25%|██▌       | 5/20 [01:36<04:53, 19.60s/it]                 
Task 1, Epoch 6/20 => Loss 0.175, Train_accy 94.53:  30%|███       | 6/20 [01:36<04:02, 17.31s/it]
Task 1, Epoch 7/20 => Loss 0.158, Train_accy 95.23:  30%|███       | 6/20 [01:48<04:02, 17.31s/it]
Task 1, Epoch 7/20 => Loss 0.158, Train_accy 95.23:  35%|███▌      | 7/20 [01:48<03:26, 15.85s/it]
Task 1, Epoch 8/20 => Loss 0.144, Train_accy 94.97:  35%|███▌      | 7/20 [02:01<03:26, 15.85s/it]
Task 1, Epoch 8/20 => Loss 0.144, Train_accy 94.97:  40%|████      | 8/20 [02:01<02:59, 14.92s/it]
Task 1, Epoch 9/20 => Loss 0.122, Train_accy 96.35:  40%|████      | 8/20 [02:14<02:59, 14.92s/it]
Task 1, Epoch 9/20 => Loss 0.122, Train_accy 96.35:  45%|████▌     | 9/20 [02:14<02:36, 14.27s/it]
Task 1, Epoch 10/20 => Loss 0.119, Train_accy 96.53, Test_accy 76.48:  45%|████▌     | 9/20 [02:46<02:36, 14.27s/it]
Task 1, Epoch 10/20 => Loss 0.119, Train_accy 96.53, Test_accy 76.48:  50%|█████     | 10/20 [02:46<03:15, 19.56s/it]
Task 1, Epoch 11/20 => Loss 0.128, Train_accy 95.49:  50%|█████     | 10/20 [02:59<03:15, 19.56s/it]                 
Task 1, Epoch 11/20 => Loss 0.128, Train_accy 95.49:  55%|█████▌    | 11/20 [02:59<02:37, 17.54s/it]
Task 1, Epoch 12/20 => Loss 0.105, Train_accy 97.05:  55%|█████▌    | 11/20 [03:11<02:37, 17.54s/it]
Task 1, Epoch 12/20 => Loss 0.105, Train_accy 97.05:  60%|██████    | 12/20 [03:11<02:09, 16.13s/it]
Task 1, Epoch 13/20 => Loss 0.128, Train_accy 96.18:  60%|██████    | 12/20 [03:24<02:09, 16.13s/it]
Task 1, Epoch 13/20 => Loss 0.128, Train_accy 96.18:  65%|██████▌   | 13/20 [03:24<01:46, 15.14s/it]
Task 1, Epoch 14/20 => Loss 0.099, Train_accy 96.88:  65%|██████▌   | 13/20 [03:37<01:46, 15.14s/it]
Task 1, Epoch 14/20 => Loss 0.099, Train_accy 96.88:  70%|███████   | 14/20 [03:37<01:26, 14.47s/it]
Task 1, Epoch 15/20 => Loss 0.096, Train_accy 96.96, Test_accy 76.51:  70%|███████   | 14/20 [04:09<01:26, 14.47s/it]
Task 1, Epoch 15/20 => Loss 0.096, Train_accy 96.96, Test_accy 76.51:  75%|███████▌  | 15/20 [04:09<01:37, 19.59s/it]
Task 1, Epoch 16/20 => Loss 0.103, Train_accy 96.88:  75%|███████▌  | 15/20 [04:22<01:37, 19.59s/it]                 
Task 1, Epoch 16/20 => Loss 0.103, Train_accy 96.88:  80%|████████  | 16/20 [04:22<01:10, 17.59s/it]
Task 1, Epoch 17/20 => Loss 0.111, Train_accy 96.53:  80%|████████  | 16/20 [04:34<01:10, 17.59s/it]
Task 1, Epoch 17/20 => Loss 0.111, Train_accy 96.53:  85%|████████▌ | 17/20 [04:34<00:48, 16.16s/it]
Task 1, Epoch 18/20 => Loss 0.090, Train_accy 97.48:  85%|████████▌ | 17/20 [04:47<00:48, 16.16s/it]
Task 1, Epoch 18/20 => Loss 0.090, Train_accy 97.48:  90%|█████████ | 18/20 [04:47<00:30, 15.17s/it]
Task 1, Epoch 19/20 => Loss 0.106, Train_accy 97.14:  90%|█████████ | 18/20 [05:00<00:30, 15.17s/it]
Task 1, Epoch 19/20 => Loss 0.106, Train_accy 97.14:  95%|█████████▌| 19/20 [05:00<00:14, 14.52s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 97.14, Test_accy 76.38:  95%|█████████▌| 19/20 [05:32<00:14, 14.52s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 97.14, Test_accy 76.38: 100%|██████████| 20/20 [05:32<00:00, 19.57s/it]
Task 1, Epoch 20/20 => Loss 0.083, Train_accy 97.14, Test_accy 76.38: 100%|██████████| 20/20 [05:32<00:00, 16.61s/it]
2024-09-08 06:35:41,957 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.083, Train_accy 97.14, Test_accy 76.38
2024-09-08 06:36:00,524 [trainer.py] => No NME accuracy.
2024-09-08 06:36:00,525 [trainer.py] => CNN: {'total': 76.38, '00-99': 79.66, '100-109': 41.9, 'old': 79.66, 'new': 41.9}
2024-09-08 06:36:00,526 [trainer.py] => CNN top1 curve: [79.77, 76.38]
2024-09-08 06:36:00,526 [trainer.py] => CNN top5 curve: [92.23, 91.56]

Average Accuracy (CNN): 78.07
2024-09-08 06:36:00,526 [trainer.py] => Average Accuracy (CNN): 78.07 

2024-09-08 06:36:00,528 [trainer.py] => All params: 89792456
2024-09-08 06:36:00,529 [trainer.py] => Trainable params: 89792456
2024-09-08 06:36:00,946 [coda_prompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.112, Train_accy 65.79:   0%|          | 0/20 [00:16<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.112, Train_accy 65.79:   5%|▌         | 1/20 [00:16<05:13, 16.49s/it]
Task 2, Epoch 2/20 => Loss 0.381, Train_accy 87.63:   5%|▌         | 1/20 [00:33<05:13, 16.49s/it]
Task 2, Epoch 2/20 => Loss 0.381, Train_accy 87.63:  10%|█         | 2/20 [00:33<04:58, 16.57s/it]
Task 2, Epoch 3/20 => Loss 0.278, Train_accy 90.86:  10%|█         | 2/20 [00:49<04:58, 16.57s/it]
Task 2, Epoch 3/20 => Loss 0.278, Train_accy 90.86:  15%|█▌        | 3/20 [00:49<04:41, 16.54s/it]
Task 2, Epoch 4/20 => Loss 0.245, Train_accy 92.61:  15%|█▌        | 3/20 [01:06<04:41, 16.54s/it]
Task 2, Epoch 4/20 => Loss 0.245, Train_accy 92.61:  20%|██        | 4/20 [01:06<04:24, 16.52s/it]
Task 2, Epoch 5/20 => Loss 0.196, Train_accy 93.75, Test_accy 72.98:  20%|██        | 4/20 [01:43<04:24, 16.52s/it]
Task 2, Epoch 5/20 => Loss 0.196, Train_accy 93.75, Test_accy 72.98:  25%|██▌       | 5/20 [01:43<05:58, 23.93s/it]
Task 2, Epoch 6/20 => Loss 0.186, Train_accy 94.22:  25%|██▌       | 5/20 [01:59<05:58, 23.93s/it]                 
Task 2, Epoch 6/20 => Loss 0.186, Train_accy 94.22:  30%|███       | 6/20 [01:59<05:00, 21.44s/it]
Task 2, Epoch 7/20 => Loss 0.169, Train_accy 95.09:  30%|███       | 6/20 [02:16<05:00, 21.44s/it]
Task 2, Epoch 7/20 => Loss 0.169, Train_accy 95.09:  35%|███▌      | 7/20 [02:16<04:17, 19.82s/it]
Task 2, Epoch 8/20 => Loss 0.135, Train_accy 95.63:  35%|███▌      | 7/20 [02:32<04:17, 19.82s/it]
Task 2, Epoch 8/20 => Loss 0.135, Train_accy 95.63:  40%|████      | 8/20 [02:32<03:45, 18.77s/it]
Task 2, Epoch 9/20 => Loss 0.156, Train_accy 94.89:  40%|████      | 8/20 [02:49<03:45, 18.77s/it]
Task 2, Epoch 9/20 => Loss 0.156, Train_accy 94.89:  45%|████▌     | 9/20 [02:49<03:18, 18.07s/it]
Task 2, Epoch 10/20 => Loss 0.123, Train_accy 95.63, Test_accy 73.47:  45%|████▌     | 9/20 [03:26<03:18, 18.07s/it]
Task 2, Epoch 10/20 => Loss 0.123, Train_accy 95.63, Test_accy 73.47:  50%|█████     | 10/20 [03:26<03:59, 23.94s/it]
Task 2, Epoch 11/20 => Loss 0.128, Train_accy 95.36:  50%|█████     | 10/20 [03:42<03:59, 23.94s/it]                 
Task 2, Epoch 11/20 => Loss 0.128, Train_accy 95.36:  55%|█████▌    | 11/20 [03:42<03:15, 21.67s/it]
Task 2, Epoch 12/20 => Loss 0.123, Train_accy 96.44:  55%|█████▌    | 11/20 [03:59<03:15, 21.67s/it]
Task 2, Epoch 12/20 => Loss 0.123, Train_accy 96.44:  60%|██████    | 12/20 [03:59<02:40, 20.09s/it]
Task 2, Epoch 13/20 => Loss 0.117, Train_accy 96.03:  60%|██████    | 12/20 [04:15<02:40, 20.09s/it]
Task 2, Epoch 13/20 => Loss 0.117, Train_accy 96.03:  65%|██████▌   | 13/20 [04:15<02:13, 19.01s/it]
Task 2, Epoch 14/20 => Loss 0.135, Train_accy 95.56:  65%|██████▌   | 13/20 [04:32<02:13, 19.01s/it]
Task 2, Epoch 14/20 => Loss 0.135, Train_accy 95.56:  70%|███████   | 14/20 [04:32<01:49, 18.26s/it]
Task 2, Epoch 15/20 => Loss 0.096, Train_accy 97.24, Test_accy 73.88:  70%|███████   | 14/20 [05:09<01:49, 18.26s/it]
Task 2, Epoch 15/20 => Loss 0.096, Train_accy 97.24, Test_accy 73.88:  75%|███████▌  | 15/20 [05:09<01:59, 23.95s/it]
Task 2, Epoch 16/20 => Loss 0.110, Train_accy 96.77:  75%|███████▌  | 15/20 [05:26<01:59, 23.95s/it]                 
Task 2, Epoch 16/20 => Loss 0.110, Train_accy 96.77:  80%|████████  | 16/20 [05:26<01:26, 21.73s/it]
Task 2, Epoch 17/20 => Loss 0.118, Train_accy 96.77:  80%|████████  | 16/20 [05:42<01:26, 21.73s/it]
Task 2, Epoch 17/20 => Loss 0.118, Train_accy 96.77:  85%|████████▌ | 17/20 [05:42<01:00, 20.15s/it]
Task 2, Epoch 18/20 => Loss 0.102, Train_accy 96.57:  85%|████████▌ | 17/20 [05:59<01:00, 20.15s/it]
Task 2, Epoch 18/20 => Loss 0.102, Train_accy 96.57:  90%|█████████ | 18/20 [05:59<00:38, 19.05s/it]
Task 2, Epoch 19/20 => Loss 0.105, Train_accy 96.64:  90%|█████████ | 18/20 [06:15<00:38, 19.05s/it]
Task 2, Epoch 19/20 => Loss 0.105, Train_accy 96.64:  95%|█████████▌| 19/20 [06:15<00:18, 18.29s/it]
Task 2, Epoch 20/20 => Loss 0.093, Train_accy 96.91, Test_accy 74.07:  95%|█████████▌| 19/20 [06:52<00:18, 18.29s/it]
Task 2, Epoch 20/20 => Loss 0.093, Train_accy 96.91, Test_accy 74.07: 100%|██████████| 20/20 [06:52<00:00, 23.95s/it]
Task 2, Epoch 20/20 => Loss 0.093, Train_accy 96.91, Test_accy 74.07: 100%|██████████| 20/20 [06:52<00:00, 20.64s/it]
2024-09-08 06:42:53,751 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.093, Train_accy 96.91, Test_accy 74.07
2024-09-08 06:43:14,388 [trainer.py] => No NME accuracy.
2024-09-08 06:43:14,388 [trainer.py] => CNN: {'total': 74.07, '00-99': 80.74, '100-109': 41.55, '110-119': 45.74, 'old': 77.33, 'new': 45.74}
2024-09-08 06:43:14,389 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07]
2024-09-08 06:43:14,389 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56]

Average Accuracy (CNN): 76.74
2024-09-08 06:43:14,389 [trainer.py] => Average Accuracy (CNN): 76.74 

2024-09-08 06:43:14,390 [trainer.py] => All params: 89792456
2024-09-08 06:43:14,391 [trainer.py] => Trainable params: 89792456
2024-09-08 06:43:14,940 [coda_prompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.583, Train_accy 51.67:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.583, Train_accy 51.67:   5%|▌         | 1/20 [00:10<03:25, 10.80s/it]
Task 3, Epoch 2/20 => Loss 0.437, Train_accy 86.04:   5%|▌         | 1/20 [00:21<03:25, 10.80s/it]
Task 3, Epoch 2/20 => Loss 0.437, Train_accy 86.04:  10%|█         | 2/20 [00:21<03:14, 10.79s/it]
Task 3, Epoch 3/20 => Loss 0.318, Train_accy 90.31:  10%|█         | 2/20 [00:32<03:14, 10.79s/it]
Task 3, Epoch 3/20 => Loss 0.318, Train_accy 90.31:  15%|█▌        | 3/20 [00:32<03:03, 10.78s/it]
Task 3, Epoch 4/20 => Loss 0.287, Train_accy 92.08:  15%|█▌        | 3/20 [00:43<03:03, 10.78s/it]
Task 3, Epoch 4/20 => Loss 0.287, Train_accy 92.08:  20%|██        | 4/20 [00:43<02:52, 10.81s/it]
Task 3, Epoch 5/20 => Loss 0.215, Train_accy 93.65, Test_accy 69.94:  20%|██        | 4/20 [01:16<02:52, 10.81s/it]
Task 3, Epoch 5/20 => Loss 0.215, Train_accy 93.65, Test_accy 69.94:  25%|██▌       | 5/20 [01:16<04:42, 18.83s/it]
Task 3, Epoch 6/20 => Loss 0.194, Train_accy 94.58:  25%|██▌       | 5/20 [01:27<04:42, 18.83s/it]                 
Task 3, Epoch 6/20 => Loss 0.194, Train_accy 94.58:  30%|███       | 6/20 [01:27<03:45, 16.11s/it]
Task 3, Epoch 7/20 => Loss 0.182, Train_accy 95.21:  30%|███       | 6/20 [01:37<03:45, 16.11s/it]
Task 3, Epoch 7/20 => Loss 0.182, Train_accy 95.21:  35%|███▌      | 7/20 [01:37<03:07, 14.41s/it]
Task 3, Epoch 8/20 => Loss 0.155, Train_accy 95.42:  35%|███▌      | 7/20 [01:48<03:07, 14.41s/it]
Task 3, Epoch 8/20 => Loss 0.155, Train_accy 95.42:  40%|████      | 8/20 [01:48<02:39, 13.25s/it]
Task 3, Epoch 9/20 => Loss 0.127, Train_accy 96.25:  40%|████      | 8/20 [01:59<02:39, 13.25s/it]
Task 3, Epoch 9/20 => Loss 0.127, Train_accy 96.25:  45%|████▌     | 9/20 [01:59<02:17, 12.50s/it]
Task 3, Epoch 10/20 => Loss 0.131, Train_accy 95.83, Test_accy 70.45:  45%|████▌     | 9/20 [02:32<02:17, 12.50s/it]
Task 3, Epoch 10/20 => Loss 0.131, Train_accy 95.83, Test_accy 70.45:  50%|█████     | 10/20 [02:32<03:08, 18.83s/it]
Task 3, Epoch 11/20 => Loss 0.103, Train_accy 97.40:  50%|█████     | 10/20 [02:43<03:08, 18.83s/it]                 
Task 3, Epoch 11/20 => Loss 0.103, Train_accy 97.40:  55%|█████▌    | 11/20 [02:43<02:27, 16.36s/it]
Task 3, Epoch 12/20 => Loss 0.128, Train_accy 96.04:  55%|█████▌    | 11/20 [02:54<02:27, 16.36s/it]
Task 3, Epoch 12/20 => Loss 0.128, Train_accy 96.04:  60%|██████    | 12/20 [02:54<01:57, 14.66s/it]
Task 3, Epoch 13/20 => Loss 0.104, Train_accy 97.19:  60%|██████    | 12/20 [03:04<01:57, 14.66s/it]
Task 3, Epoch 13/20 => Loss 0.104, Train_accy 97.19:  65%|██████▌   | 13/20 [03:04<01:34, 13.47s/it]
Task 3, Epoch 14/20 => Loss 0.119, Train_accy 96.67:  65%|██████▌   | 13/20 [03:15<01:34, 13.47s/it]
Task 3, Epoch 14/20 => Loss 0.119, Train_accy 96.67:  70%|███████   | 14/20 [03:15<01:15, 12.66s/it]
Task 3, Epoch 15/20 => Loss 0.118, Train_accy 96.67, Test_accy 70.79:  70%|███████   | 14/20 [03:48<01:15, 12.66s/it]
Task 3, Epoch 15/20 => Loss 0.118, Train_accy 96.67, Test_accy 70.79:  75%|███████▌  | 15/20 [03:48<01:33, 18.79s/it]
Task 3, Epoch 16/20 => Loss 0.099, Train_accy 96.67:  75%|███████▌  | 15/20 [03:59<01:33, 18.79s/it]                 
Task 3, Epoch 16/20 => Loss 0.099, Train_accy 96.67:  80%|████████  | 16/20 [03:59<01:05, 16.41s/it]
Task 3, Epoch 17/20 => Loss 0.112, Train_accy 96.04:  80%|████████  | 16/20 [04:10<01:05, 16.41s/it]
Task 3, Epoch 17/20 => Loss 0.112, Train_accy 96.04:  85%|████████▌ | 17/20 [04:10<00:44, 14.80s/it]
Task 3, Epoch 18/20 => Loss 0.120, Train_accy 96.15:  85%|████████▌ | 17/20 [04:21<00:44, 14.80s/it]
Task 3, Epoch 18/20 => Loss 0.120, Train_accy 96.15:  90%|█████████ | 18/20 [04:21<00:27, 13.60s/it]
Task 3, Epoch 19/20 => Loss 0.086, Train_accy 97.40:  90%|█████████ | 18/20 [04:32<00:27, 13.60s/it]
Task 3, Epoch 19/20 => Loss 0.086, Train_accy 97.40:  95%|█████████▌| 19/20 [04:32<00:12, 12.76s/it]
Task 3, Epoch 20/20 => Loss 0.087, Train_accy 97.50, Test_accy 70.61:  95%|█████████▌| 19/20 [05:05<00:12, 12.76s/it]
Task 3, Epoch 20/20 => Loss 0.087, Train_accy 97.50, Test_accy 70.61: 100%|██████████| 20/20 [05:05<00:00, 18.83s/it]
Task 3, Epoch 20/20 => Loss 0.087, Train_accy 97.50, Test_accy 70.61: 100%|██████████| 20/20 [05:05<00:00, 15.26s/it]
2024-09-08 06:48:20,128 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.087, Train_accy 97.50, Test_accy 70.61
2024-09-08 06:48:42,360 [trainer.py] => No NME accuracy.
2024-09-08 06:48:42,361 [trainer.py] => CNN: {'total': 70.61, '00-99': 80.57, '100-109': 41.9, '110-119': 45.21, '120-129': 26.2, 'old': 73.91, 'new': 26.2}
2024-09-08 06:48:42,361 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61]
2024-09-08 06:48:42,361 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38]

Average Accuracy (CNN): 75.21
2024-09-08 06:48:42,361 [trainer.py] => Average Accuracy (CNN): 75.21 

2024-09-08 06:48:42,363 [trainer.py] => All params: 89792456
2024-09-08 06:48:42,364 [trainer.py] => Trainable params: 89792456
2024-09-08 06:48:43,067 [coda_prompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.351, Train_accy 60.85:   0%|          | 0/20 [00:12<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.351, Train_accy 60.85:   5%|▌         | 1/20 [00:12<04:01, 12.73s/it]
Task 4, Epoch 2/20 => Loss 0.471, Train_accy 85.42:   5%|▌         | 1/20 [00:25<04:01, 12.73s/it]
Task 4, Epoch 2/20 => Loss 0.471, Train_accy 85.42:  10%|█         | 2/20 [00:25<03:50, 12.80s/it]
Task 4, Epoch 3/20 => Loss 0.323, Train_accy 90.62:  10%|█         | 2/20 [00:38<03:50, 12.80s/it]
Task 4, Epoch 3/20 => Loss 0.323, Train_accy 90.62:  15%|█▌        | 3/20 [00:38<03:38, 12.85s/it]
Task 4, Epoch 4/20 => Loss 0.251, Train_accy 91.41:  15%|█▌        | 3/20 [00:51<03:38, 12.85s/it]
Task 4, Epoch 4/20 => Loss 0.251, Train_accy 91.41:  20%|██        | 4/20 [00:51<03:25, 12.87s/it]
Task 4, Epoch 5/20 => Loss 0.219, Train_accy 94.10, Test_accy 68.46:  20%|██        | 4/20 [01:27<03:25, 12.87s/it]
Task 4, Epoch 5/20 => Loss 0.219, Train_accy 94.10, Test_accy 68.46:  25%|██▌       | 5/20 [01:27<05:21, 21.43s/it]
Task 4, Epoch 6/20 => Loss 0.180, Train_accy 94.70:  25%|██▌       | 5/20 [01:40<05:21, 21.43s/it]                 
Task 4, Epoch 6/20 => Loss 0.180, Train_accy 94.70:  30%|███       | 6/20 [01:40<04:19, 18.54s/it]
Task 4, Epoch 7/20 => Loss 0.158, Train_accy 95.92:  30%|███       | 6/20 [01:53<04:19, 18.54s/it]
Task 4, Epoch 7/20 => Loss 0.158, Train_accy 95.92:  35%|███▌      | 7/20 [01:53<03:37, 16.71s/it]
Task 4, Epoch 8/20 => Loss 0.137, Train_accy 95.66:  35%|███▌      | 7/20 [02:06<03:37, 16.71s/it]
Task 4, Epoch 8/20 => Loss 0.137, Train_accy 95.66:  40%|████      | 8/20 [02:06<03:05, 15.49s/it]
Task 4, Epoch 9/20 => Loss 0.125, Train_accy 96.27:  40%|████      | 8/20 [02:19<03:05, 15.49s/it]
Task 4, Epoch 9/20 => Loss 0.125, Train_accy 96.27:  45%|████▌     | 9/20 [02:19<02:41, 14.67s/it]
Task 4, Epoch 10/20 => Loss 0.108, Train_accy 96.88, Test_accy 68.79:  45%|████▌     | 9/20 [02:56<02:41, 14.67s/it]
Task 4, Epoch 10/20 => Loss 0.108, Train_accy 96.88, Test_accy 68.79:  50%|█████     | 10/20 [02:56<03:34, 21.46s/it]
Task 4, Epoch 11/20 => Loss 0.121, Train_accy 96.09:  50%|█████     | 10/20 [03:09<03:34, 21.46s/it]                 
Task 4, Epoch 11/20 => Loss 0.121, Train_accy 96.09:  55%|█████▌    | 11/20 [03:09<02:49, 18.85s/it]
Task 4, Epoch 12/20 => Loss 0.126, Train_accy 96.44:  55%|█████▌    | 11/20 [03:22<02:49, 18.85s/it]
Task 4, Epoch 12/20 => Loss 0.126, Train_accy 96.44:  60%|██████    | 12/20 [03:22<02:16, 17.05s/it]
Task 4, Epoch 13/20 => Loss 0.127, Train_accy 96.09:  60%|██████    | 12/20 [03:35<02:16, 17.05s/it]
Task 4, Epoch 13/20 => Loss 0.127, Train_accy 96.09:  65%|██████▌   | 13/20 [03:35<01:50, 15.78s/it]
Task 4, Epoch 14/20 => Loss 0.122, Train_accy 96.70:  65%|██████▌   | 13/20 [03:47<01:50, 15.78s/it]
Task 4, Epoch 14/20 => Loss 0.122, Train_accy 96.70:  70%|███████   | 14/20 [03:47<01:29, 14.90s/it]
Task 4, Epoch 15/20 => Loss 0.131, Train_accy 95.57, Test_accy 68.75:  70%|███████   | 14/20 [04:24<01:29, 14.90s/it]
Task 4, Epoch 15/20 => Loss 0.131, Train_accy 95.57, Test_accy 68.75:  75%|███████▌  | 15/20 [04:24<01:47, 21.46s/it]
Task 4, Epoch 16/20 => Loss 0.099, Train_accy 97.22:  75%|███████▌  | 15/20 [04:37<01:47, 21.46s/it]                 
Task 4, Epoch 16/20 => Loss 0.099, Train_accy 97.22:  80%|████████  | 16/20 [04:37<01:15, 18.89s/it]
Task 4, Epoch 17/20 => Loss 0.094, Train_accy 97.31:  80%|████████  | 16/20 [04:50<01:15, 18.89s/it]
Task 4, Epoch 17/20 => Loss 0.094, Train_accy 97.31:  85%|████████▌ | 17/20 [04:50<00:51, 17.09s/it]
Task 4, Epoch 18/20 => Loss 0.099, Train_accy 96.88:  85%|████████▌ | 17/20 [05:03<00:51, 17.09s/it]
Task 4, Epoch 18/20 => Loss 0.099, Train_accy 96.88:  90%|█████████ | 18/20 [05:03<00:31, 15.86s/it]
Task 4, Epoch 19/20 => Loss 0.085, Train_accy 97.92:  90%|█████████ | 18/20 [05:16<00:31, 15.86s/it]
Task 4, Epoch 19/20 => Loss 0.085, Train_accy 97.92:  95%|█████████▌| 19/20 [05:16<00:14, 14.97s/it]
Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.31, Test_accy 68.96:  95%|█████████▌| 19/20 [05:53<00:14, 14.97s/it]
Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.31, Test_accy 68.96: 100%|██████████| 20/20 [05:53<00:00, 21.51s/it]
Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.31, Test_accy 68.96: 100%|██████████| 20/20 [05:53<00:00, 17.65s/it]
2024-09-08 06:54:36,090 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.087, Train_accy 97.31, Test_accy 68.96
2024-09-08 06:54:59,970 [trainer.py] => No NME accuracy.
2024-09-08 06:54:59,970 [trainer.py] => CNN: {'total': 68.96, '00-99': 80.64, '100-109': 41.9, '110-119': 46.28, '120-129': 27.68, '130-139': 43.96, 'old': 70.86, 'new': 43.96}
2024-09-08 06:54:59,970 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61, 68.96]
2024-09-08 06:54:59,970 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38, 88.78]

Average Accuracy (CNN): 73.96
2024-09-08 06:54:59,971 [trainer.py] => Average Accuracy (CNN): 73.96 

2024-09-08 06:54:59,972 [trainer.py] => All params: 89792456
2024-09-08 06:54:59,973 [trainer.py] => Trainable params: 89792456
2024-09-08 06:55:00,828 [coda_prompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.122, Train_accy 66.16:   0%|          | 0/20 [00:15<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.122, Train_accy 66.16:   5%|▌         | 1/20 [00:15<04:55, 15.56s/it]
Task 5, Epoch 2/20 => Loss 0.305, Train_accy 90.37:   5%|▌         | 1/20 [00:31<04:55, 15.56s/it]
Task 5, Epoch 2/20 => Loss 0.305, Train_accy 90.37:  10%|█         | 2/20 [00:31<04:39, 15.54s/it]
Task 5, Epoch 3/20 => Loss 0.263, Train_accy 91.52:  10%|█         | 2/20 [00:46<04:39, 15.54s/it]
Task 5, Epoch 3/20 => Loss 0.263, Train_accy 91.52:  15%|█▌        | 3/20 [00:46<04:23, 15.51s/it]
Task 5, Epoch 4/20 => Loss 0.210, Train_accy 92.89:  15%|█▌        | 3/20 [01:02<04:23, 15.51s/it]
Task 5, Epoch 4/20 => Loss 0.210, Train_accy 92.89:  20%|██        | 4/20 [01:02<04:08, 15.52s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.97, Test_accy 65.88:  20%|██        | 4/20 [01:43<04:08, 15.52s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.97, Test_accy 65.88:  25%|██▌       | 5/20 [01:43<06:12, 24.84s/it]
Task 5, Epoch 6/20 => Loss 0.157, Train_accy 95.62:  25%|██▌       | 5/20 [01:58<06:12, 24.84s/it]                 
Task 5, Epoch 6/20 => Loss 0.157, Train_accy 95.62:  30%|███       | 6/20 [01:58<05:03, 21.67s/it]
Task 5, Epoch 7/20 => Loss 0.137, Train_accy 95.55:  30%|███       | 6/20 [02:14<05:03, 21.67s/it]
Task 5, Epoch 7/20 => Loss 0.137, Train_accy 95.55:  35%|███▌      | 7/20 [02:14<04:15, 19.64s/it]
Task 5, Epoch 8/20 => Loss 0.129, Train_accy 95.91:  35%|███▌      | 7/20 [02:29<04:15, 19.64s/it]
Task 5, Epoch 8/20 => Loss 0.129, Train_accy 95.91:  40%|████      | 8/20 [02:29<03:39, 18.32s/it]
Task 5, Epoch 9/20 => Loss 0.168, Train_accy 95.26:  40%|████      | 8/20 [02:45<03:39, 18.32s/it]
Task 5, Epoch 9/20 => Loss 0.168, Train_accy 95.26:  45%|████▌     | 9/20 [02:45<03:11, 17.43s/it]
Task 5, Epoch 10/20 => Loss 0.118, Train_accy 96.55, Test_accy 66.64:  45%|████▌     | 9/20 [03:26<03:11, 17.43s/it]
Task 5, Epoch 10/20 => Loss 0.118, Train_accy 96.55, Test_accy 66.64:  50%|█████     | 10/20 [03:26<04:08, 24.80s/it]
Task 5, Epoch 11/20 => Loss 0.130, Train_accy 96.19:  50%|█████     | 10/20 [03:42<04:08, 24.80s/it]                 
Task 5, Epoch 11/20 => Loss 0.130, Train_accy 96.19:  55%|█████▌    | 11/20 [03:42<03:17, 21.96s/it]
Task 5, Epoch 12/20 => Loss 0.115, Train_accy 97.05:  55%|█████▌    | 11/20 [03:57<03:17, 21.96s/it]
Task 5, Epoch 12/20 => Loss 0.115, Train_accy 97.05:  60%|██████    | 12/20 [03:57<02:39, 19.99s/it]
Task 5, Epoch 13/20 => Loss 0.114, Train_accy 96.55:  60%|██████    | 12/20 [04:13<02:39, 19.99s/it]
Task 5, Epoch 13/20 => Loss 0.114, Train_accy 96.55:  65%|██████▌   | 13/20 [04:13<02:10, 18.62s/it]
Task 5, Epoch 14/20 => Loss 0.122, Train_accy 96.41:  65%|██████▌   | 13/20 [04:28<02:10, 18.62s/it]
Task 5, Epoch 14/20 => Loss 0.122, Train_accy 96.41:  70%|███████   | 14/20 [04:28<01:46, 17.69s/it]
Task 5, Epoch 15/20 => Loss 0.090, Train_accy 96.84, Test_accy 66.75:  70%|███████   | 14/20 [05:10<01:46, 17.69s/it]
Task 5, Epoch 15/20 => Loss 0.090, Train_accy 96.84, Test_accy 66.75:  75%|███████▌  | 15/20 [05:10<02:04, 24.86s/it]
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 96.77:  75%|███████▌  | 15/20 [05:25<02:04, 24.86s/it]                 
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 96.77:  80%|████████  | 16/20 [05:25<01:28, 22.04s/it]
Task 5, Epoch 17/20 => Loss 0.088, Train_accy 97.20:  80%|████████  | 16/20 [05:41<01:28, 22.04s/it]
Task 5, Epoch 17/20 => Loss 0.088, Train_accy 97.20:  85%|████████▌ | 17/20 [05:41<01:00, 20.09s/it]
Task 5, Epoch 18/20 => Loss 0.102, Train_accy 96.62:  85%|████████▌ | 17/20 [05:56<01:00, 20.09s/it]
Task 5, Epoch 18/20 => Loss 0.102, Train_accy 96.62:  90%|█████████ | 18/20 [05:56<00:37, 18.73s/it]
Task 5, Epoch 19/20 => Loss 0.112, Train_accy 96.34:  90%|█████████ | 18/20 [06:12<00:37, 18.73s/it]
Task 5, Epoch 19/20 => Loss 0.112, Train_accy 96.34:  95%|█████████▌| 19/20 [06:12<00:17, 17.77s/it]
Task 5, Epoch 20/20 => Loss 0.095, Train_accy 96.48, Test_accy 66.69:  95%|█████████▌| 19/20 [06:53<00:17, 17.77s/it]
Task 5, Epoch 20/20 => Loss 0.095, Train_accy 96.48, Test_accy 66.69: 100%|██████████| 20/20 [06:53<00:00, 24.85s/it]
Task 5, Epoch 20/20 => Loss 0.095, Train_accy 96.48, Test_accy 66.69: 100%|██████████| 20/20 [06:53<00:00, 20.68s/it]
2024-09-08 07:01:54,517 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.095, Train_accy 96.48, Test_accy 66.69
2024-09-08 07:02:20,348 [trainer.py] => No NME accuracy.
2024-09-08 07:02:20,348 [trainer.py] => CNN: {'total': 66.69, '00-99': 80.74, '100-109': 41.55, '110-119': 47.07, '120-129': 26.94, '130-139': 42.62, '140-149': 40.87, 'old': 68.94, 'new': 40.87}
2024-09-08 07:02:20,348 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61, 68.96, 66.69]
2024-09-08 07:02:20,348 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38, 88.78, 88.36]

Average Accuracy (CNN): 72.75
2024-09-08 07:02:20,348 [trainer.py] => Average Accuracy (CNN): 72.75 

2024-09-08 07:02:20,349 [trainer.py] => All params: 89792456
2024-09-08 07:02:20,350 [trainer.py] => Trainable params: 89792456
2024-09-08 07:02:21,373 [coda_prompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.415, Train_accy 58.98:   0%|          | 0/20 [00:15<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.415, Train_accy 58.98:   5%|▌         | 1/20 [00:15<04:54, 15.49s/it]
Task 6, Epoch 2/20 => Loss 0.438, Train_accy 86.78:   5%|▌         | 1/20 [00:31<04:54, 15.49s/it]
Task 6, Epoch 2/20 => Loss 0.438, Train_accy 86.78:  10%|█         | 2/20 [00:31<04:39, 15.50s/it]
Task 6, Epoch 3/20 => Loss 0.332, Train_accy 89.15:  10%|█         | 2/20 [00:46<04:39, 15.50s/it]
Task 6, Epoch 3/20 => Loss 0.332, Train_accy 89.15:  15%|█▌        | 3/20 [00:46<04:24, 15.55s/it]
Task 6, Epoch 4/20 => Loss 0.264, Train_accy 91.31:  15%|█▌        | 3/20 [01:02<04:24, 15.55s/it]
Task 6, Epoch 4/20 => Loss 0.264, Train_accy 91.31:  20%|██        | 4/20 [01:02<04:08, 15.54s/it]
Task 6, Epoch 5/20 => Loss 0.211, Train_accy 93.10, Test_accy 63.61:  20%|██        | 4/20 [01:45<04:08, 15.54s/it]
Task 6, Epoch 5/20 => Loss 0.211, Train_accy 93.10, Test_accy 63.61:  25%|██▌       | 5/20 [01:45<06:23, 25.58s/it]
Task 6, Epoch 6/20 => Loss 0.211, Train_accy 93.03:  25%|██▌       | 5/20 [02:00<06:23, 25.58s/it]                 
Task 6, Epoch 6/20 => Loss 0.211, Train_accy 93.03:  30%|███       | 6/20 [02:00<05:10, 22.14s/it]
Task 6, Epoch 7/20 => Loss 0.194, Train_accy 93.97:  30%|███       | 6/20 [02:16<05:10, 22.14s/it]
Task 6, Epoch 7/20 => Loss 0.194, Train_accy 93.97:  35%|███▌      | 7/20 [02:16<04:19, 19.97s/it]
Task 6, Epoch 8/20 => Loss 0.200, Train_accy 93.89:  35%|███▌      | 7/20 [02:31<04:19, 19.97s/it]
Task 6, Epoch 8/20 => Loss 0.200, Train_accy 93.89:  40%|████      | 8/20 [02:31<03:42, 18.55s/it]
Task 6, Epoch 9/20 => Loss 0.130, Train_accy 95.76:  40%|████      | 8/20 [02:47<03:42, 18.55s/it]
Task 6, Epoch 9/20 => Loss 0.130, Train_accy 95.76:  45%|████▌     | 9/20 [02:47<03:13, 17.59s/it]
Task 6, Epoch 10/20 => Loss 0.132, Train_accy 95.76, Test_accy 64.23:  45%|████▌     | 9/20 [03:31<03:13, 17.59s/it]
Task 6, Epoch 10/20 => Loss 0.132, Train_accy 95.76, Test_accy 64.23:  50%|█████     | 10/20 [03:31<04:16, 25.62s/it]
Task 6, Epoch 11/20 => Loss 0.134, Train_accy 95.62:  50%|█████     | 10/20 [03:46<04:16, 25.62s/it]                 
Task 6, Epoch 11/20 => Loss 0.134, Train_accy 95.62:  55%|█████▌    | 11/20 [03:46<03:22, 22.51s/it]
Task 6, Epoch 12/20 => Loss 0.164, Train_accy 95.04:  55%|█████▌    | 11/20 [04:02<03:22, 22.51s/it]
Task 6, Epoch 12/20 => Loss 0.164, Train_accy 95.04:  60%|██████    | 12/20 [04:02<02:43, 20.38s/it]
Task 6, Epoch 13/20 => Loss 0.123, Train_accy 96.48:  60%|██████    | 12/20 [04:17<02:43, 20.38s/it]
Task 6, Epoch 13/20 => Loss 0.123, Train_accy 96.48:  65%|██████▌   | 13/20 [04:17<02:12, 18.95s/it]
Task 6, Epoch 14/20 => Loss 0.136, Train_accy 95.62:  65%|██████▌   | 13/20 [04:33<02:12, 18.95s/it]
Task 6, Epoch 14/20 => Loss 0.136, Train_accy 95.62:  70%|███████   | 14/20 [04:33<01:47, 17.93s/it]
Task 6, Epoch 15/20 => Loss 0.097, Train_accy 97.20, Test_accy 64.68:  70%|███████   | 14/20 [05:16<01:47, 17.93s/it]
Task 6, Epoch 15/20 => Loss 0.097, Train_accy 97.20, Test_accy 64.68:  75%|███████▌  | 15/20 [05:16<02:08, 25.62s/it]
Task 6, Epoch 16/20 => Loss 0.133, Train_accy 95.98:  75%|███████▌  | 15/20 [05:32<02:08, 25.62s/it]                 
Task 6, Epoch 16/20 => Loss 0.133, Train_accy 95.98:  80%|████████  | 16/20 [05:32<01:30, 22.58s/it]
Task 6, Epoch 17/20 => Loss 0.107, Train_accy 96.70:  80%|████████  | 16/20 [05:47<01:30, 22.58s/it]
Task 6, Epoch 17/20 => Loss 0.107, Train_accy 96.70:  85%|████████▌ | 17/20 [05:47<01:01, 20.46s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 96.48:  85%|████████▌ | 17/20 [06:03<01:01, 20.46s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 96.48:  90%|█████████ | 18/20 [06:03<00:37, 18.99s/it]
Task 6, Epoch 19/20 => Loss 0.122, Train_accy 96.34:  90%|█████████ | 18/20 [06:18<00:37, 18.99s/it]
Task 6, Epoch 19/20 => Loss 0.122, Train_accy 96.34:  95%|█████████▌| 19/20 [06:18<00:17, 17.94s/it]
Task 6, Epoch 20/20 => Loss 0.138, Train_accy 95.91, Test_accy 64.74:  95%|█████████▌| 19/20 [07:02<00:17, 17.94s/it]
Task 6, Epoch 20/20 => Loss 0.138, Train_accy 95.91, Test_accy 64.74: 100%|██████████| 20/20 [07:02<00:00, 25.56s/it]
Task 6, Epoch 20/20 => Loss 0.138, Train_accy 95.91, Test_accy 64.74: 100%|██████████| 20/20 [07:02<00:00, 21.11s/it]
2024-09-08 07:09:23,533 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.138, Train_accy 95.91, Test_accy 64.74
2024-09-08 07:09:51,430 [trainer.py] => No NME accuracy.
2024-09-08 07:09:51,431 [trainer.py] => CNN: {'total': 64.74, '00-99': 80.67, '100-109': 41.2, '110-119': 47.61, '120-129': 26.94, '130-139': 42.62, '140-149': 41.14, '150-159': 40.06, 'old': 66.69, 'new': 40.06}
2024-09-08 07:09:51,431 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61, 68.96, 66.69, 64.74]
2024-09-08 07:09:51,431 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38, 88.78, 88.36, 87.62]

Average Accuracy (CNN): 71.6
2024-09-08 07:09:51,431 [trainer.py] => Average Accuracy (CNN): 71.6 

2024-09-08 07:09:51,432 [trainer.py] => All params: 89792456
2024-09-08 07:09:51,433 [trainer.py] => Trainable params: 89792456
2024-09-08 07:09:52,609 [coda_prompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.824, Train_accy 47.40:   0%|          | 0/20 [00:10<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.824, Train_accy 47.40:   5%|▌         | 1/20 [00:10<03:27, 10.92s/it]
Task 7, Epoch 2/20 => Loss 0.686, Train_accy 77.08:   5%|▌         | 1/20 [00:21<03:27, 10.92s/it]
Task 7, Epoch 2/20 => Loss 0.686, Train_accy 77.08:  10%|█         | 2/20 [00:21<03:16, 10.91s/it]
Task 7, Epoch 3/20 => Loss 0.425, Train_accy 86.04:  10%|█         | 2/20 [00:32<03:16, 10.91s/it]
Task 7, Epoch 3/20 => Loss 0.425, Train_accy 86.04:  15%|█▌        | 3/20 [00:32<03:04, 10.86s/it]
Task 7, Epoch 4/20 => Loss 0.389, Train_accy 88.12:  15%|█▌        | 3/20 [00:43<03:04, 10.86s/it]
Task 7, Epoch 4/20 => Loss 0.389, Train_accy 88.12:  20%|██        | 4/20 [00:43<02:53, 10.85s/it]
Task 7, Epoch 5/20 => Loss 0.326, Train_accy 89.90, Test_accy 62.65:  20%|██        | 4/20 [01:23<02:53, 10.85s/it]
Task 7, Epoch 5/20 => Loss 0.326, Train_accy 89.90, Test_accy 62.65:  25%|██▌       | 5/20 [01:23<05:20, 21.35s/it]
Task 7, Epoch 6/20 => Loss 0.300, Train_accy 90.42:  25%|██▌       | 5/20 [01:34<05:20, 21.35s/it]                 
Task 7, Epoch 6/20 => Loss 0.300, Train_accy 90.42:  30%|███       | 6/20 [01:34<04:08, 17.77s/it]
Task 7, Epoch 7/20 => Loss 0.271, Train_accy 91.98:  30%|███       | 6/20 [01:45<04:08, 17.77s/it]
Task 7, Epoch 7/20 => Loss 0.271, Train_accy 91.98:  35%|███▌      | 7/20 [01:45<03:21, 15.50s/it]
Task 7, Epoch 8/20 => Loss 0.287, Train_accy 91.15:  35%|███▌      | 7/20 [01:55<03:21, 15.50s/it]
Task 7, Epoch 8/20 => Loss 0.287, Train_accy 91.15:  40%|████      | 8/20 [01:55<02:48, 14.01s/it]
Task 7, Epoch 9/20 => Loss 0.241, Train_accy 93.33:  40%|████      | 8/20 [02:06<02:48, 14.01s/it]
Task 7, Epoch 9/20 => Loss 0.241, Train_accy 93.33:  45%|████▌     | 9/20 [02:06<02:23, 13.03s/it]
Task 7, Epoch 10/20 => Loss 0.208, Train_accy 93.65, Test_accy 62.65:  45%|████▌     | 9/20 [02:47<02:23, 13.03s/it]
Task 7, Epoch 10/20 => Loss 0.208, Train_accy 93.65, Test_accy 62.65:  50%|█████     | 10/20 [02:47<03:34, 21.46s/it]
Task 7, Epoch 11/20 => Loss 0.225, Train_accy 94.06:  50%|█████     | 10/20 [02:57<03:34, 21.46s/it]                 
Task 7, Epoch 11/20 => Loss 0.225, Train_accy 94.06:  55%|█████▌    | 11/20 [02:57<02:43, 18.22s/it]
Task 7, Epoch 12/20 => Loss 0.196, Train_accy 93.44:  55%|█████▌    | 11/20 [03:08<02:43, 18.22s/it]
Task 7, Epoch 12/20 => Loss 0.196, Train_accy 93.44:  60%|██████    | 12/20 [03:08<02:07, 15.97s/it]
Task 7, Epoch 13/20 => Loss 0.199, Train_accy 94.17:  60%|██████    | 12/20 [03:19<02:07, 15.97s/it]
Task 7, Epoch 13/20 => Loss 0.199, Train_accy 94.17:  65%|██████▌   | 13/20 [03:19<01:40, 14.42s/it]
Task 7, Epoch 14/20 => Loss 0.206, Train_accy 94.06:  65%|██████▌   | 13/20 [03:30<01:40, 14.42s/it]
Task 7, Epoch 14/20 => Loss 0.206, Train_accy 94.06:  70%|███████   | 14/20 [03:30<01:20, 13.34s/it]
Task 7, Epoch 15/20 => Loss 0.190, Train_accy 94.69, Test_accy 63.02:  70%|███████   | 14/20 [04:10<01:20, 13.34s/it]
Task 7, Epoch 15/20 => Loss 0.190, Train_accy 94.69, Test_accy 63.02:  75%|███████▌  | 15/20 [04:10<01:46, 21.37s/it]
Task 7, Epoch 16/20 => Loss 0.159, Train_accy 95.42:  75%|███████▌  | 15/20 [04:21<01:46, 21.37s/it]                 
Task 7, Epoch 16/20 => Loss 0.159, Train_accy 95.42:  80%|████████  | 16/20 [04:21<01:12, 18.20s/it]
Task 7, Epoch 17/20 => Loss 0.143, Train_accy 95.83:  80%|████████  | 16/20 [04:32<01:12, 18.20s/it]
Task 7, Epoch 17/20 => Loss 0.143, Train_accy 95.83:  85%|████████▌ | 17/20 [04:32<00:47, 15.98s/it]
Task 7, Epoch 18/20 => Loss 0.148, Train_accy 95.73:  85%|████████▌ | 17/20 [04:42<00:47, 15.98s/it]
Task 7, Epoch 18/20 => Loss 0.148, Train_accy 95.73:  90%|█████████ | 18/20 [04:42<00:28, 14.43s/it]
Task 7, Epoch 19/20 => Loss 0.175, Train_accy 94.58:  90%|█████████ | 18/20 [04:53<00:28, 14.43s/it]
Task 7, Epoch 19/20 => Loss 0.175, Train_accy 94.58:  95%|█████████▌| 19/20 [04:53<00:13, 13.34s/it]
Task 7, Epoch 20/20 => Loss 0.168, Train_accy 94.48, Test_accy 62.94:  95%|█████████▌| 19/20 [05:33<00:13, 13.34s/it]
Task 7, Epoch 20/20 => Loss 0.168, Train_accy 94.48, Test_accy 62.94: 100%|██████████| 20/20 [05:33<00:00, 21.33s/it]
Task 7, Epoch 20/20 => Loss 0.168, Train_accy 94.48, Test_accy 62.94: 100%|██████████| 20/20 [05:33<00:00, 16.69s/it]
2024-09-08 07:15:26,343 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.168, Train_accy 94.48, Test_accy 62.94
2024-09-08 07:15:55,432 [trainer.py] => No NME accuracy.
2024-09-08 07:15:55,432 [trainer.py] => CNN: {'total': 62.94, '00-99': 80.64, '100-109': 39.79, '110-119': 46.01, '120-129': 26.94, '130-139': 42.62, '140-149': 41.42, '150-159': 40.88, '160-169': 27.39, 'old': 64.6, 'new': 27.39}
2024-09-08 07:15:55,432 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61, 68.96, 66.69, 64.74, 62.94]
2024-09-08 07:15:55,432 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38, 88.78, 88.36, 87.62, 86.58]

Average Accuracy (CNN): 70.52
2024-09-08 07:15:55,433 [trainer.py] => Average Accuracy (CNN): 70.52 

2024-09-08 07:15:55,434 [trainer.py] => All params: 89792456
2024-09-08 07:15:55,435 [trainer.py] => Trainable params: 89792456
2024-09-08 07:15:56,747 [coda_prompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.321, Train_accy 61.18:   0%|          | 0/20 [00:10<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.321, Train_accy 61.18:   5%|▌         | 1/20 [00:10<03:20, 10.58s/it]
Task 8, Epoch 2/20 => Loss 0.406, Train_accy 87.39:   5%|▌         | 1/20 [00:20<03:20, 10.58s/it]
Task 8, Epoch 2/20 => Loss 0.406, Train_accy 87.39:  10%|█         | 2/20 [00:20<03:08, 10.47s/it]
Task 8, Epoch 3/20 => Loss 0.248, Train_accy 91.56:  10%|█         | 2/20 [00:31<03:08, 10.47s/it]
Task 8, Epoch 3/20 => Loss 0.248, Train_accy 91.56:  15%|█▌        | 3/20 [00:31<02:57, 10.42s/it]
Task 8, Epoch 4/20 => Loss 0.254, Train_accy 92.00:  15%|█▌        | 3/20 [00:41<02:57, 10.42s/it]
Task 8, Epoch 4/20 => Loss 0.254, Train_accy 92.00:  20%|██        | 4/20 [00:41<02:46, 10.38s/it]
Task 8, Epoch 5/20 => Loss 0.203, Train_accy 94.19, Test_accy 61.87:  20%|██        | 4/20 [01:22<02:46, 10.38s/it]
Task 8, Epoch 5/20 => Loss 0.203, Train_accy 94.19, Test_accy 61.87:  25%|██▌       | 5/20 [01:22<05:19, 21.31s/it]
Task 8, Epoch 6/20 => Loss 0.194, Train_accy 94.30:  25%|██▌       | 5/20 [01:32<05:19, 21.31s/it]                 
Task 8, Epoch 6/20 => Loss 0.194, Train_accy 94.30:  30%|███       | 6/20 [01:32<04:05, 17.56s/it]
Task 8, Epoch 7/20 => Loss 0.158, Train_accy 94.96:  30%|███       | 6/20 [01:42<04:05, 17.56s/it]
Task 8, Epoch 7/20 => Loss 0.158, Train_accy 94.96:  35%|███▌      | 7/20 [01:42<03:17, 15.17s/it]
Task 8, Epoch 8/20 => Loss 0.182, Train_accy 94.30:  35%|███▌      | 7/20 [01:53<03:17, 15.17s/it]
Task 8, Epoch 8/20 => Loss 0.182, Train_accy 94.30:  40%|████      | 8/20 [01:53<02:43, 13.62s/it]
Task 8, Epoch 9/20 => Loss 0.143, Train_accy 95.50:  40%|████      | 8/20 [02:03<02:43, 13.62s/it]
Task 8, Epoch 9/20 => Loss 0.143, Train_accy 95.50:  45%|████▌     | 9/20 [02:03<02:18, 12.59s/it]
Task 8, Epoch 10/20 => Loss 0.133, Train_accy 96.49, Test_accy 62.17:  45%|████▌     | 9/20 [02:44<02:18, 12.59s/it]
Task 8, Epoch 10/20 => Loss 0.133, Train_accy 96.49, Test_accy 62.17:  50%|█████     | 10/20 [02:44<03:33, 21.40s/it]
Task 8, Epoch 11/20 => Loss 0.115, Train_accy 96.71:  50%|█████     | 10/20 [02:55<03:33, 21.40s/it]                 
Task 8, Epoch 11/20 => Loss 0.115, Train_accy 96.71:  55%|█████▌    | 11/20 [02:55<02:42, 18.10s/it]
Task 8, Epoch 12/20 => Loss 0.124, Train_accy 96.27:  55%|█████▌    | 11/20 [03:05<02:42, 18.10s/it]
Task 8, Epoch 12/20 => Loss 0.124, Train_accy 96.27:  60%|██████    | 12/20 [03:05<02:05, 15.73s/it]
Task 8, Epoch 13/20 => Loss 0.123, Train_accy 96.82:  60%|██████    | 12/20 [03:15<02:05, 15.73s/it]
Task 8, Epoch 13/20 => Loss 0.123, Train_accy 96.82:  65%|██████▌   | 13/20 [03:15<01:38, 14.10s/it]
Task 8, Epoch 14/20 => Loss 0.124, Train_accy 96.60:  65%|██████▌   | 13/20 [03:26<01:38, 14.10s/it]
Task 8, Epoch 14/20 => Loss 0.124, Train_accy 96.60:  70%|███████   | 14/20 [03:26<01:17, 12.96s/it]
Task 8, Epoch 15/20 => Loss 0.101, Train_accy 97.26, Test_accy 62.31:  70%|███████   | 14/20 [04:06<01:17, 12.96s/it]
Task 8, Epoch 15/20 => Loss 0.101, Train_accy 97.26, Test_accy 62.31:  75%|███████▌  | 15/20 [04:06<01:46, 21.34s/it]
Task 8, Epoch 16/20 => Loss 0.128, Train_accy 96.05:  75%|███████▌  | 15/20 [04:17<01:46, 21.34s/it]                 
Task 8, Epoch 16/20 => Loss 0.128, Train_accy 96.05:  80%|████████  | 16/20 [04:17<01:12, 18.01s/it]
Task 8, Epoch 17/20 => Loss 0.090, Train_accy 97.26:  80%|████████  | 16/20 [04:27<01:12, 18.01s/it]
Task 8, Epoch 17/20 => Loss 0.090, Train_accy 97.26:  85%|████████▌ | 17/20 [04:27<00:47, 15.70s/it]
Task 8, Epoch 18/20 => Loss 0.124, Train_accy 96.93:  85%|████████▌ | 17/20 [04:37<00:47, 15.70s/it]
Task 8, Epoch 18/20 => Loss 0.124, Train_accy 96.93:  90%|█████████ | 18/20 [04:37<00:28, 14.09s/it]
Task 8, Epoch 19/20 => Loss 0.110, Train_accy 96.93:  90%|█████████ | 18/20 [04:48<00:28, 14.09s/it]
Task 8, Epoch 19/20 => Loss 0.110, Train_accy 96.93:  95%|█████████▌| 19/20 [04:48<00:12, 12.96s/it]
Task 8, Epoch 20/20 => Loss 0.104, Train_accy 96.49, Test_accy 62.39:  95%|█████████▌| 19/20 [05:28<00:12, 12.96s/it]
Task 8, Epoch 20/20 => Loss 0.104, Train_accy 96.49, Test_accy 62.39: 100%|██████████| 20/20 [05:28<00:00, 21.29s/it]
Task 8, Epoch 20/20 => Loss 0.104, Train_accy 96.49, Test_accy 62.39: 100%|██████████| 20/20 [05:28<00:00, 16.45s/it]
2024-09-08 07:21:25,730 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.104, Train_accy 96.49, Test_accy 62.39
2024-09-08 07:21:56,242 [trainer.py] => No NME accuracy.
2024-09-08 07:21:56,243 [trainer.py] => CNN: {'total': 62.39, '00-99': 80.9, '100-109': 39.44, '110-119': 46.81, '120-129': 26.94, '130-139': 42.28, '140-149': 41.69, '150-159': 40.88, '160-169': 26.96, '170-179': 47.18, 'old': 63.12, 'new': 47.18}
2024-09-08 07:21:56,243 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61, 68.96, 66.69, 64.74, 62.94, 62.39]
2024-09-08 07:21:56,243 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38, 88.78, 88.36, 87.62, 86.58, 86.33]

Average Accuracy (CNN): 69.62
2024-09-08 07:21:56,243 [trainer.py] => Average Accuracy (CNN): 69.62 

2024-09-08 07:21:56,245 [trainer.py] => All params: 89792456
2024-09-08 07:21:56,246 [trainer.py] => Trainable params: 89792456
2024-09-08 07:21:57,754 [coda_prompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.351, Train_accy 59.33:   0%|          | 0/20 [00:12<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.351, Train_accy 59.33:   5%|▌         | 1/20 [00:12<03:55, 12.40s/it]
Task 9, Epoch 2/20 => Loss 0.481, Train_accy 84.69:   5%|▌         | 1/20 [00:24<03:55, 12.40s/it]
Task 9, Epoch 2/20 => Loss 0.481, Train_accy 84.69:  10%|█         | 2/20 [00:24<03:43, 12.41s/it]
Task 9, Epoch 3/20 => Loss 0.352, Train_accy 88.77:  10%|█         | 2/20 [00:37<03:43, 12.41s/it]
Task 9, Epoch 3/20 => Loss 0.352, Train_accy 88.77:  15%|█▌        | 3/20 [00:37<03:30, 12.40s/it]
Task 9, Epoch 4/20 => Loss 0.259, Train_accy 92.66:  15%|█▌        | 3/20 [00:49<03:30, 12.40s/it]
Task 9, Epoch 4/20 => Loss 0.259, Train_accy 92.66:  20%|██        | 4/20 [00:49<03:18, 12.42s/it]
Task 9, Epoch 5/20 => Loss 0.221, Train_accy 93.48, Test_accy 59.89:  20%|██        | 4/20 [01:34<03:18, 12.42s/it]
Task 9, Epoch 5/20 => Loss 0.221, Train_accy 93.48, Test_accy 59.89:  25%|██▌       | 5/20 [01:34<05:59, 23.99s/it]
Task 9, Epoch 6/20 => Loss 0.188, Train_accy 94.47:  25%|██▌       | 5/20 [01:46<05:59, 23.99s/it]                 
Task 9, Epoch 6/20 => Loss 0.188, Train_accy 94.47:  30%|███       | 6/20 [01:46<04:41, 20.09s/it]
Task 9, Epoch 7/20 => Loss 0.206, Train_accy 93.57:  30%|███       | 6/20 [01:59<04:41, 20.09s/it]
Task 9, Epoch 7/20 => Loss 0.206, Train_accy 93.57:  35%|███▌      | 7/20 [01:59<03:48, 17.57s/it]
Task 9, Epoch 8/20 => Loss 0.195, Train_accy 94.57:  35%|███▌      | 7/20 [02:11<03:48, 17.57s/it]
Task 9, Epoch 8/20 => Loss 0.195, Train_accy 94.57:  40%|████      | 8/20 [02:11<03:11, 15.94s/it]
Task 9, Epoch 9/20 => Loss 0.167, Train_accy 95.20:  40%|████      | 8/20 [02:23<03:11, 15.94s/it]
Task 9, Epoch 9/20 => Loss 0.167, Train_accy 95.20:  45%|████▌     | 9/20 [02:23<02:43, 14.82s/it]
Task 9, Epoch 10/20 => Loss 0.154, Train_accy 95.74, Test_accy 60.17:  45%|████▌     | 9/20 [03:08<02:43, 14.82s/it]
Task 9, Epoch 10/20 => Loss 0.154, Train_accy 95.74, Test_accy 60.17:  50%|█████     | 10/20 [03:08<04:00, 24.02s/it]
Task 9, Epoch 11/20 => Loss 0.146, Train_accy 95.38:  50%|█████     | 10/20 [03:20<04:00, 24.02s/it]                 
Task 9, Epoch 11/20 => Loss 0.146, Train_accy 95.38:  55%|█████▌    | 11/20 [03:20<03:04, 20.46s/it]
Task 9, Epoch 12/20 => Loss 0.120, Train_accy 96.92:  55%|█████▌    | 11/20 [03:33<03:04, 20.46s/it]
Task 9, Epoch 12/20 => Loss 0.120, Train_accy 96.92:  60%|██████    | 12/20 [03:33<02:24, 18.01s/it]
Task 9, Epoch 13/20 => Loss 0.112, Train_accy 96.29:  60%|██████    | 12/20 [03:45<02:24, 18.01s/it]
Task 9, Epoch 13/20 => Loss 0.112, Train_accy 96.29:  65%|██████▌   | 13/20 [03:45<01:54, 16.31s/it]
Task 9, Epoch 14/20 => Loss 0.143, Train_accy 95.56:  65%|██████▌   | 13/20 [03:58<01:54, 16.31s/it]
Task 9, Epoch 14/20 => Loss 0.143, Train_accy 95.56:  70%|███████   | 14/20 [03:58<01:30, 15.14s/it]
Task 9, Epoch 15/20 => Loss 0.115, Train_accy 96.38, Test_accy 60.29:  70%|███████   | 14/20 [04:42<01:30, 15.14s/it]
Task 9, Epoch 15/20 => Loss 0.115, Train_accy 96.38, Test_accy 60.29:  75%|███████▌  | 15/20 [04:42<02:00, 24.01s/it]
Task 9, Epoch 16/20 => Loss 0.126, Train_accy 96.47:  75%|███████▌  | 15/20 [04:55<02:00, 24.01s/it]                 
Task 9, Epoch 16/20 => Loss 0.126, Train_accy 96.47:  80%|████████  | 16/20 [04:55<01:22, 20.52s/it]
Task 9, Epoch 17/20 => Loss 0.128, Train_accy 96.01:  80%|████████  | 16/20 [05:07<01:22, 20.52s/it]
Task 9, Epoch 17/20 => Loss 0.128, Train_accy 96.01:  85%|████████▌ | 17/20 [05:07<00:54, 18.12s/it]
Task 9, Epoch 18/20 => Loss 0.134, Train_accy 96.11:  85%|████████▌ | 17/20 [05:20<00:54, 18.12s/it]
Task 9, Epoch 18/20 => Loss 0.134, Train_accy 96.11:  90%|█████████ | 18/20 [05:20<00:32, 16.41s/it]
Task 9, Epoch 19/20 => Loss 0.103, Train_accy 96.83:  90%|█████████ | 18/20 [05:32<00:32, 16.41s/it]
Task 9, Epoch 19/20 => Loss 0.103, Train_accy 96.83:  95%|█████████▌| 19/20 [05:32<00:15, 15.19s/it]
Task 9, Epoch 20/20 => Loss 0.118, Train_accy 96.56, Test_accy 60.31:  95%|█████████▌| 19/20 [06:16<00:15, 15.19s/it]
Task 9, Epoch 20/20 => Loss 0.118, Train_accy 96.56, Test_accy 60.31: 100%|██████████| 20/20 [06:16<00:00, 23.98s/it]
Task 9, Epoch 20/20 => Loss 0.118, Train_accy 96.56, Test_accy 60.31: 100%|██████████| 20/20 [06:16<00:00, 18.84s/it]
2024-09-08 07:28:14,656 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.118, Train_accy 96.56, Test_accy 60.31
2024-09-08 07:28:46,909 [trainer.py] => No NME accuracy.
2024-09-08 07:28:46,909 [trainer.py] => CNN: {'total': 60.31, '00-99': 80.37, '100-109': 39.44, '110-119': 46.81, '120-129': 26.57, '130-139': 41.61, '140-149': 42.23, '150-159': 40.06, '160-169': 28.26, '170-179': 48.39, '180-189': 28.25, 'old': 62.13, 'new': 28.25}
2024-09-08 07:28:46,910 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61, 68.96, 66.69, 64.74, 62.94, 62.39, 60.31]
2024-09-08 07:28:46,910 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38, 88.78, 88.36, 87.62, 86.58, 86.33, 85.69]

Average Accuracy (CNN): 68.69
2024-09-08 07:28:46,910 [trainer.py] => Average Accuracy (CNN): 68.69 

2024-09-08 07:28:46,911 [trainer.py] => All params: 89792456
2024-09-08 07:28:46,913 [trainer.py] => Trainable params: 89792456
2024-09-08 07:28:48,632 [coda_prompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.123, Train_accy 65.94:   0%|          | 0/20 [00:12<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.123, Train_accy 65.94:   5%|▌         | 1/20 [00:12<03:55, 12.42s/it]
Task 10, Epoch 2/20 => Loss 0.383, Train_accy 88.22:   5%|▌         | 1/20 [00:24<03:55, 12.42s/it]
Task 10, Epoch 2/20 => Loss 0.383, Train_accy 88.22:  10%|█         | 2/20 [00:24<03:43, 12.42s/it]
Task 10, Epoch 3/20 => Loss 0.271, Train_accy 90.49:  10%|█         | 2/20 [00:37<03:43, 12.42s/it]
Task 10, Epoch 3/20 => Loss 0.271, Train_accy 90.49:  15%|█▌        | 3/20 [00:37<03:31, 12.44s/it]
Task 10, Epoch 4/20 => Loss 0.195, Train_accy 93.84:  15%|█▌        | 3/20 [00:49<03:31, 12.44s/it]
Task 10, Epoch 4/20 => Loss 0.195, Train_accy 93.84:  20%|██        | 4/20 [00:49<03:19, 12.45s/it]
Task 10, Epoch 5/20 => Loss 0.161, Train_accy 94.93, Test_accy 59.07:  20%|██        | 4/20 [01:35<03:19, 12.45s/it]
Task 10, Epoch 5/20 => Loss 0.161, Train_accy 94.93, Test_accy 59.07:  25%|██▌       | 5/20 [01:35<06:08, 24.55s/it]
Task 10, Epoch 6/20 => Loss 0.163, Train_accy 94.84:  25%|██▌       | 5/20 [01:48<06:08, 24.55s/it]                 
Task 10, Epoch 6/20 => Loss 0.163, Train_accy 94.84:  30%|███       | 6/20 [01:48<04:45, 20.42s/it]
Task 10, Epoch 7/20 => Loss 0.134, Train_accy 95.83:  30%|███       | 6/20 [02:00<04:45, 20.42s/it]
Task 10, Epoch 7/20 => Loss 0.134, Train_accy 95.83:  35%|███▌      | 7/20 [02:00<03:51, 17.82s/it]
Task 10, Epoch 8/20 => Loss 0.126, Train_accy 96.47:  35%|███▌      | 7/20 [02:13<03:51, 17.82s/it]
Task 10, Epoch 8/20 => Loss 0.126, Train_accy 96.47:  40%|████      | 8/20 [02:13<03:13, 16.11s/it]
Task 10, Epoch 9/20 => Loss 0.149, Train_accy 95.56:  40%|████      | 8/20 [02:25<03:13, 16.11s/it]
Task 10, Epoch 9/20 => Loss 0.149, Train_accy 95.56:  45%|████▌     | 9/20 [02:25<02:44, 14.97s/it]
Task 10, Epoch 10/20 => Loss 0.100, Train_accy 97.10, Test_accy 59.08:  45%|████▌     | 9/20 [03:11<02:44, 14.97s/it]
Task 10, Epoch 10/20 => Loss 0.100, Train_accy 97.10, Test_accy 59.08:  50%|█████     | 10/20 [03:11<04:05, 24.56s/it]
Task 10, Epoch 11/20 => Loss 0.119, Train_accy 96.20:  50%|█████     | 10/20 [03:24<04:05, 24.56s/it]                 
Task 10, Epoch 11/20 => Loss 0.119, Train_accy 96.20:  55%|█████▌    | 11/20 [03:24<03:07, 20.84s/it]
Task 10, Epoch 12/20 => Loss 0.083, Train_accy 97.28:  55%|█████▌    | 11/20 [03:36<03:07, 20.84s/it]
Task 10, Epoch 12/20 => Loss 0.083, Train_accy 97.28:  60%|██████    | 12/20 [03:36<02:26, 18.29s/it]
Task 10, Epoch 13/20 => Loss 0.094, Train_accy 97.46:  60%|██████    | 12/20 [03:48<02:26, 18.29s/it]
Task 10, Epoch 13/20 => Loss 0.094, Train_accy 97.46:  65%|██████▌   | 13/20 [03:48<01:55, 16.53s/it]
Task 10, Epoch 14/20 => Loss 0.094, Train_accy 97.37:  65%|██████▌   | 13/20 [04:01<01:55, 16.53s/it]
Task 10, Epoch 14/20 => Loss 0.094, Train_accy 97.37:  70%|███████   | 14/20 [04:01<01:31, 15.32s/it]
Task 10, Epoch 15/20 => Loss 0.123, Train_accy 95.56, Test_accy 59.25:  70%|███████   | 14/20 [04:47<01:31, 15.32s/it]
Task 10, Epoch 15/20 => Loss 0.123, Train_accy 95.56, Test_accy 59.25:  75%|███████▌  | 15/20 [04:47<02:03, 24.60s/it]
Task 10, Epoch 16/20 => Loss 0.115, Train_accy 96.74:  75%|███████▌  | 15/20 [05:00<02:03, 24.60s/it]                 
Task 10, Epoch 16/20 => Loss 0.115, Train_accy 96.74:  80%|████████  | 16/20 [05:00<01:23, 20.95s/it]
Task 10, Epoch 17/20 => Loss 0.096, Train_accy 97.01:  80%|████████  | 16/20 [05:12<01:23, 20.95s/it]
Task 10, Epoch 17/20 => Loss 0.096, Train_accy 97.01:  85%|████████▌ | 17/20 [05:12<00:55, 18.38s/it]
Task 10, Epoch 18/20 => Loss 0.085, Train_accy 97.55:  85%|████████▌ | 17/20 [05:24<00:55, 18.38s/it]
Task 10, Epoch 18/20 => Loss 0.085, Train_accy 97.55:  90%|█████████ | 18/20 [05:24<00:33, 16.59s/it]
Task 10, Epoch 19/20 => Loss 0.085, Train_accy 97.55:  90%|█████████ | 18/20 [05:37<00:33, 16.59s/it]
Task 10, Epoch 19/20 => Loss 0.085, Train_accy 97.55:  95%|█████████▌| 19/20 [05:37<00:15, 15.33s/it]
Task 10, Epoch 20/20 => Loss 0.096, Train_accy 97.10, Test_accy 59.23:  95%|█████████▌| 19/20 [06:23<00:15, 15.33s/it]
Task 10, Epoch 20/20 => Loss 0.096, Train_accy 97.10, Test_accy 59.23: 100%|██████████| 20/20 [06:23<00:00, 24.58s/it]
Task 10, Epoch 20/20 => Loss 0.096, Train_accy 97.10, Test_accy 59.23: 100%|██████████| 20/20 [06:23<00:00, 19.17s/it]
2024-09-08 07:35:12,042 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.096, Train_accy 97.10, Test_accy 59.23
2024-09-08 07:35:45,722 [trainer.py] => No NME accuracy.
2024-09-08 07:35:45,722 [trainer.py] => CNN: {'total': 59.23, '00-99': 80.34, '100-109': 40.14, '110-119': 46.01, '120-129': 26.57, '130-139': 41.61, '140-149': 41.69, '150-159': 39.5, '160-169': 26.96, '170-179': 47.98, '180-189': 28.9, '190-199': 39.48, 'old': 60.17, 'new': 39.48}
2024-09-08 07:35:45,723 [trainer.py] => CNN top1 curve: [79.77, 76.38, 74.07, 70.61, 68.96, 66.69, 64.74, 62.94, 62.39, 60.31, 59.23]
2024-09-08 07:35:45,723 [trainer.py] => CNN top5 curve: [92.23, 91.56, 90.56, 89.38, 88.78, 88.36, 87.62, 86.58, 86.33, 85.69, 85.47]

Average Accuracy (CNN): 67.83
2024-09-08 07:35:45,723 [trainer.py] => Average Accuracy (CNN): 67.83 

Accuracy Matrix (CNN):
[[79.77 79.66 80.74 80.57 80.64 80.74 80.67 80.64 80.9  80.37 80.34]
 [ 0.   41.9  41.55 41.9  41.9  41.55 41.2  39.79 39.44 39.44 40.14]
 [ 0.    0.   45.74 45.21 46.28 47.07 47.61 46.01 46.81 46.81 46.01]
 [ 0.    0.    0.   26.2  27.68 26.94 26.94 26.94 26.94 26.57 26.57]
 [ 0.    0.    0.    0.   43.96 42.62 42.62 42.62 42.28 41.61 41.61]
 [ 0.    0.    0.    0.    0.   40.87 41.14 41.42 41.69 42.23 41.69]
 [ 0.    0.    0.    0.    0.    0.   40.06 40.88 40.88 40.06 39.5 ]
 [ 0.    0.    0.    0.    0.    0.    0.   27.39 26.96 28.26 26.96]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   47.18 48.39 47.98]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   28.25 28.9 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   39.48]]
2024-09-08 07:35:45,725 [trainer.py] => Forgetting (CNN): 1.1010000000000009
2024-09-08 07:35:48,581 [trainer.py] => config: ./exps/ease_inr_B0_Inc5.json
2024-09-08 07:35:48,581 [trainer.py] => prefix:  
2024-09-08 07:35:48,581 [trainer.py] => dataset: imagenetr
2024-09-08 07:35:48,581 [trainer.py] => memory_size: 0
2024-09-08 07:35:48,581 [trainer.py] => memory_per_class: 0
2024-09-08 07:35:48,581 [trainer.py] => fixed_memory: False
2024-09-08 07:35:48,581 [trainer.py] => shuffle: True
2024-09-08 07:35:48,581 [trainer.py] => init_cls: 40
2024-09-08 07:35:48,582 [trainer.py] => increment: 40
2024-09-08 07:35:48,582 [trainer.py] => model_name: ease
2024-09-08 07:35:48,582 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-08 07:35:48,582 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 07:35:48,582 [trainer.py] => seed: 1993
2024-09-08 07:35:48,582 [trainer.py] => init_epochs: 20
2024-09-08 07:35:48,582 [trainer.py] => init_lr: 0.05
2024-09-08 07:35:48,582 [trainer.py] => later_epochs: 20
2024-09-08 07:35:48,582 [trainer.py] => later_lr: 0.05
2024-09-08 07:35:48,582 [trainer.py] => batch_size: 48
2024-09-08 07:35:48,582 [trainer.py] => weight_decay: 0.005
2024-09-08 07:35:48,582 [trainer.py] => min_lr: 0
2024-09-08 07:35:48,582 [trainer.py] => optimizer: sgd
2024-09-08 07:35:48,582 [trainer.py] => scheduler: cosine
2024-09-08 07:35:48,582 [trainer.py] => pretrained: True
2024-09-08 07:35:48,582 [trainer.py] => vpt_type: Deep
2024-09-08 07:35:48,582 [trainer.py] => prompt_token_num: 5
2024-09-08 07:35:48,582 [trainer.py] => ffn_num: 16
2024-09-08 07:35:48,582 [trainer.py] => use_diagonal: False
2024-09-08 07:35:48,582 [trainer.py] => recalc_sim: True
2024-09-08 07:35:48,582 [trainer.py] => alpha: 0.1
2024-09-08 07:35:48,582 [trainer.py] => use_init_ptm: False
2024-09-08 07:35:48,582 [trainer.py] => beta: 0
2024-09-08 07:35:48,582 [trainer.py] => use_old_data: False
2024-09-08 07:35:48,582 [trainer.py] => use_reweight: True
2024-09-08 07:35:48,582 [trainer.py] => moni_adam: False
2024-09-08 07:35:48,582 [trainer.py] => adapter_num: -1
2024-09-08 07:35:48,665 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-08 07:35:51,468 [trainer.py] => All params: 86102976
2024-09-08 07:35:51,469 [trainer.py] => Trainable params: 304320
2024-09-08 07:35:51,476 [ease.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.039, Train_accy 40.48:   0%|          | 0/20 [00:31<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.039, Train_accy 40.48:   5%|▌         | 1/20 [00:31<10:03, 31.77s/it]
Task 0, Epoch 2/20 => Loss 1.180, Train_accy 74.26:   5%|▌         | 1/20 [01:03<10:03, 31.77s/it]
Task 0, Epoch 2/20 => Loss 1.180, Train_accy 74.26:  10%|█         | 2/20 [01:03<09:29, 31.64s/it]
Task 0, Epoch 3/20 => Loss 0.834, Train_accy 80.97:  10%|█         | 2/20 [01:35<09:29, 31.64s/it]
Task 0, Epoch 3/20 => Loss 0.834, Train_accy 80.97:  15%|█▌        | 3/20 [01:35<08:58, 31.68s/it]
Task 0, Epoch 4/20 => Loss 0.800, Train_accy 81.23:  15%|█▌        | 3/20 [02:06<08:58, 31.68s/it]
Task 0, Epoch 4/20 => Loss 0.800, Train_accy 81.23:  20%|██        | 4/20 [02:06<08:27, 31.70s/it]
Task 0, Epoch 5/20 => Loss 0.782, Train_accy 81.22:  20%|██        | 4/20 [02:38<08:27, 31.70s/it]
Task 0, Epoch 5/20 => Loss 0.782, Train_accy 81.22:  25%|██▌       | 5/20 [02:38<07:56, 31.75s/it]
Task 0, Epoch 6/20 => Loss 0.746, Train_accy 82.07:  25%|██▌       | 5/20 [03:10<07:56, 31.75s/it]
Task 0, Epoch 6/20 => Loss 0.746, Train_accy 82.07:  30%|███       | 6/20 [03:10<07:24, 31.76s/it]
Task 0, Epoch 7/20 => Loss 0.762, Train_accy 81.74:  30%|███       | 6/20 [03:42<07:24, 31.76s/it]
Task 0, Epoch 7/20 => Loss 0.762, Train_accy 81.74:  35%|███▌      | 7/20 [03:42<06:52, 31.76s/it]
Task 0, Epoch 8/20 => Loss 0.750, Train_accy 81.90:  35%|███▌      | 7/20 [04:13<06:52, 31.76s/it]
Task 0, Epoch 8/20 => Loss 0.750, Train_accy 81.90:  40%|████      | 8/20 [04:13<06:21, 31.75s/it]
Task 0, Epoch 9/20 => Loss 0.745, Train_accy 82.04:  40%|████      | 8/20 [04:45<06:21, 31.75s/it]
Task 0, Epoch 9/20 => Loss 0.745, Train_accy 82.04:  45%|████▌     | 9/20 [04:45<05:49, 31.75s/it]
Task 0, Epoch 10/20 => Loss 0.741, Train_accy 82.17:  45%|████▌     | 9/20 [05:17<05:49, 31.75s/it]
Task 0, Epoch 10/20 => Loss 0.741, Train_accy 82.17:  50%|█████     | 10/20 [05:17<05:17, 31.74s/it]
Task 0, Epoch 11/20 => Loss 0.742, Train_accy 81.96:  50%|█████     | 10/20 [05:49<05:17, 31.74s/it]
Task 0, Epoch 11/20 => Loss 0.742, Train_accy 81.96:  55%|█████▌    | 11/20 [05:49<04:45, 31.76s/it]
Task 0, Epoch 12/20 => Loss 0.701, Train_accy 83.34:  55%|█████▌    | 11/20 [06:20<04:45, 31.76s/it]
Task 0, Epoch 12/20 => Loss 0.701, Train_accy 83.34:  60%|██████    | 12/20 [06:20<04:14, 31.77s/it]
Task 0, Epoch 13/20 => Loss 0.714, Train_accy 82.48:  60%|██████    | 12/20 [06:53<04:14, 31.77s/it]
Task 0, Epoch 13/20 => Loss 0.714, Train_accy 82.48:  65%|██████▌   | 13/20 [06:53<03:43, 31.87s/it]
Task 0, Epoch 14/20 => Loss 0.706, Train_accy 83.10:  65%|██████▌   | 13/20 [07:24<03:43, 31.87s/it]
Task 0, Epoch 14/20 => Loss 0.706, Train_accy 83.10:  70%|███████   | 14/20 [07:24<03:10, 31.81s/it]
Task 0, Epoch 15/20 => Loss 0.692, Train_accy 83.77:  70%|███████   | 14/20 [07:56<03:10, 31.81s/it]
Task 0, Epoch 15/20 => Loss 0.692, Train_accy 83.77:  75%|███████▌  | 15/20 [07:56<02:39, 31.82s/it]
Task 0, Epoch 16/20 => Loss 0.660, Train_accy 83.81:  75%|███████▌  | 15/20 [08:28<02:39, 31.82s/it]
Task 0, Epoch 16/20 => Loss 0.660, Train_accy 83.81:  80%|████████  | 16/20 [08:28<02:07, 31.79s/it]
Task 0, Epoch 17/20 => Loss 0.660, Train_accy 83.88:  80%|████████  | 16/20 [09:00<02:07, 31.79s/it]
Task 0, Epoch 17/20 => Loss 0.660, Train_accy 83.88:  85%|████████▌ | 17/20 [09:00<01:35, 31.77s/it]
Task 0, Epoch 18/20 => Loss 0.653, Train_accy 84.81:  85%|████████▌ | 17/20 [09:31<01:35, 31.77s/it]
Task 0, Epoch 18/20 => Loss 0.653, Train_accy 84.81:  90%|█████████ | 18/20 [09:31<01:03, 31.74s/it]
Task 0, Epoch 19/20 => Loss 0.646, Train_accy 84.05:  90%|█████████ | 18/20 [10:03<01:03, 31.74s/it]
Task 0, Epoch 19/20 => Loss 0.646, Train_accy 84.05:  95%|█████████▌| 19/20 [10:03<00:31, 31.72s/it]
Task 0, Epoch 20/20 => Loss 0.637, Train_accy 84.61:  95%|█████████▌| 19/20 [10:35<00:31, 31.72s/it]
Task 0, Epoch 20/20 => Loss 0.637, Train_accy 84.61: 100%|██████████| 20/20 [10:35<00:00, 31.70s/it]
Task 0, Epoch 20/20 => Loss 0.637, Train_accy 84.61: 100%|██████████| 20/20 [10:35<00:00, 31.75s/it]
2024-09-08 07:46:26,567 [ease.py] => Task 0, Epoch 20/20 => Loss 0.637, Train_accy 84.61
2024-09-08 07:46:47,951 [ease.py] => Task correct: 100.0
2024-09-08 07:46:47,952 [ease.py] => Task acc: 88.11506434519303
2024-09-08 07:46:47,973 [trainer.py] => No NME accuracy.
2024-09-08 07:46:47,973 [trainer.py] => CNN: {'total': 88.12, '00-39': 88.12, 'old': 0, 'new': 88.12}
2024-09-08 07:46:47,973 [trainer.py] => CNN top1 curve: [88.12]
2024-09-08 07:46:47,973 [trainer.py] => CNN top5 curve: [97.43]

Average Accuracy (CNN): 88.12
2024-09-08 07:46:47,973 [trainer.py] => Average Accuracy (CNN): 88.12 

2024-09-08 07:46:47,974 [trainer.py] => All params: 86164418
2024-09-08 07:46:47,975 [trainer.py] => Trainable params: 304320
2024-09-08 07:46:47,977 [ease.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.251, Train_accy 33.87:   0%|          | 0/20 [00:27<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.251, Train_accy 33.87:   5%|▌         | 1/20 [00:27<08:40, 27.41s/it]
Task 1, Epoch 2/20 => Loss 1.577, Train_accy 69.41:   5%|▌         | 1/20 [00:54<08:40, 27.41s/it]
Task 1, Epoch 2/20 => Loss 1.577, Train_accy 69.41:  10%|█         | 2/20 [00:54<08:13, 27.40s/it]
Task 1, Epoch 3/20 => Loss 1.008, Train_accy 77.18:  10%|█         | 2/20 [01:22<08:13, 27.40s/it]
Task 1, Epoch 3/20 => Loss 1.008, Train_accy 77.18:  15%|█▌        | 3/20 [01:22<07:47, 27.48s/it]
Task 1, Epoch 4/20 => Loss 0.948, Train_accy 77.83:  15%|█▌        | 3/20 [01:49<07:47, 27.48s/it]
Task 1, Epoch 4/20 => Loss 0.948, Train_accy 77.83:  20%|██        | 4/20 [01:49<07:18, 27.43s/it]
Task 1, Epoch 5/20 => Loss 0.890, Train_accy 79.12:  20%|██        | 4/20 [02:17<07:18, 27.43s/it]
Task 1, Epoch 5/20 => Loss 0.890, Train_accy 79.12:  25%|██▌       | 5/20 [02:17<06:51, 27.43s/it]
Task 1, Epoch 6/20 => Loss 0.855, Train_accy 80.26:  25%|██▌       | 5/20 [02:44<06:51, 27.43s/it]
Task 1, Epoch 6/20 => Loss 0.855, Train_accy 80.26:  30%|███       | 6/20 [02:44<06:24, 27.44s/it]
Task 1, Epoch 7/20 => Loss 0.867, Train_accy 80.39:  30%|███       | 6/20 [03:11<06:24, 27.44s/it]
Task 1, Epoch 7/20 => Loss 0.867, Train_accy 80.39:  35%|███▌      | 7/20 [03:11<05:56, 27.42s/it]
Task 1, Epoch 8/20 => Loss 0.806, Train_accy 81.13:  35%|███▌      | 7/20 [03:39<05:56, 27.42s/it]
Task 1, Epoch 8/20 => Loss 0.806, Train_accy 81.13:  40%|████      | 8/20 [03:39<05:30, 27.54s/it]
Task 1, Epoch 9/20 => Loss 0.819, Train_accy 80.39:  40%|████      | 8/20 [04:07<05:30, 27.54s/it]
Task 1, Epoch 9/20 => Loss 0.819, Train_accy 80.39:  45%|████▌     | 9/20 [04:07<05:03, 27.56s/it]
Task 1, Epoch 10/20 => Loss 0.785, Train_accy 81.92:  45%|████▌     | 9/20 [04:34<05:03, 27.56s/it]
Task 1, Epoch 10/20 => Loss 0.785, Train_accy 81.92:  50%|█████     | 10/20 [04:34<04:34, 27.50s/it]
Task 1, Epoch 11/20 => Loss 0.818, Train_accy 80.82:  50%|█████     | 10/20 [05:02<04:34, 27.50s/it]
Task 1, Epoch 11/20 => Loss 0.818, Train_accy 80.82:  55%|█████▌    | 11/20 [05:02<04:07, 27.46s/it]
Task 1, Epoch 12/20 => Loss 0.798, Train_accy 81.17:  55%|█████▌    | 11/20 [05:29<04:07, 27.46s/it]
Task 1, Epoch 12/20 => Loss 0.798, Train_accy 81.17:  60%|██████    | 12/20 [05:29<03:39, 27.45s/it]
Task 1, Epoch 13/20 => Loss 0.754, Train_accy 81.86:  60%|██████    | 12/20 [05:57<03:39, 27.45s/it]
Task 1, Epoch 13/20 => Loss 0.754, Train_accy 81.86:  65%|██████▌   | 13/20 [05:57<03:12, 27.49s/it]
Task 1, Epoch 14/20 => Loss 0.732, Train_accy 82.27:  65%|██████▌   | 13/20 [06:24<03:12, 27.49s/it]
Task 1, Epoch 14/20 => Loss 0.732, Train_accy 82.27:  70%|███████   | 14/20 [06:24<02:45, 27.51s/it]
Task 1, Epoch 15/20 => Loss 0.740, Train_accy 82.08:  70%|███████   | 14/20 [06:52<02:45, 27.51s/it]
Task 1, Epoch 15/20 => Loss 0.740, Train_accy 82.08:  75%|███████▌  | 15/20 [06:52<02:17, 27.51s/it]
Task 1, Epoch 16/20 => Loss 0.740, Train_accy 82.16:  75%|███████▌  | 15/20 [07:19<02:17, 27.51s/it]
Task 1, Epoch 16/20 => Loss 0.740, Train_accy 82.16:  80%|████████  | 16/20 [07:19<01:50, 27.51s/it]
Task 1, Epoch 17/20 => Loss 0.720, Train_accy 82.81:  80%|████████  | 16/20 [07:47<01:50, 27.51s/it]
Task 1, Epoch 17/20 => Loss 0.720, Train_accy 82.81:  85%|████████▌ | 17/20 [07:47<01:22, 27.47s/it]
Task 1, Epoch 18/20 => Loss 0.688, Train_accy 83.80:  85%|████████▌ | 17/20 [08:14<01:22, 27.47s/it]
Task 1, Epoch 18/20 => Loss 0.688, Train_accy 83.80:  90%|█████████ | 18/20 [08:14<00:54, 27.42s/it]
Task 1, Epoch 19/20 => Loss 0.678, Train_accy 83.91:  90%|█████████ | 18/20 [08:41<00:54, 27.42s/it]
Task 1, Epoch 19/20 => Loss 0.678, Train_accy 83.91:  95%|█████████▌| 19/20 [08:41<00:27, 27.39s/it]
Task 1, Epoch 20/20 => Loss 0.707, Train_accy 83.13:  95%|█████████▌| 19/20 [09:09<00:27, 27.39s/it]
Task 1, Epoch 20/20 => Loss 0.707, Train_accy 83.13: 100%|██████████| 20/20 [09:09<00:00, 27.38s/it]
Task 1, Epoch 20/20 => Loss 0.707, Train_accy 83.13: 100%|██████████| 20/20 [09:09<00:00, 27.45s/it]
2024-09-08 07:55:57,053 [ease.py] => Task 1, Epoch 20/20 => Loss 0.707, Train_accy 83.13
2024-09-08 07:56:41,341 [ease.py] => Task correct: 91.83346677341873
2024-09-08 07:56:41,341 [ease.py] => Task acc: 88.27061649319455
2024-09-08 07:56:41,355 [trainer.py] => No NME accuracy.
2024-09-08 07:56:41,355 [trainer.py] => CNN: {'total': 83.71, '00-39': 84.18, '40-79': 83.18, 'old': 84.18, 'new': 83.18}
2024-09-08 07:56:41,355 [trainer.py] => CNN top1 curve: [88.12, 83.71]
2024-09-08 07:56:41,355 [trainer.py] => CNN top5 curve: [97.43, 95.08]

Average Accuracy (CNN): 85.92
2024-09-08 07:56:41,355 [trainer.py] => Average Accuracy (CNN): 85.92 

2024-09-08 07:56:41,356 [trainer.py] => All params: 86256578
2024-09-08 07:56:41,356 [trainer.py] => Trainable params: 304320
2024-09-08 07:56:41,359 [ease.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.128, Train_accy 35.35:   0%|          | 0/20 [00:28<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.128, Train_accy 35.35:   5%|▌         | 1/20 [00:28<09:04, 28.66s/it]
Task 2, Epoch 2/20 => Loss 1.383, Train_accy 71.34:   5%|▌         | 1/20 [00:57<09:04, 28.66s/it]
Task 2, Epoch 2/20 => Loss 1.383, Train_accy 71.34:  10%|█         | 2/20 [00:57<08:35, 28.66s/it]
Task 2, Epoch 3/20 => Loss 0.965, Train_accy 77.81:  10%|█         | 2/20 [01:25<08:35, 28.66s/it]
Task 2, Epoch 3/20 => Loss 0.965, Train_accy 77.81:  15%|█▌        | 3/20 [01:25<08:05, 28.59s/it]
Task 2, Epoch 4/20 => Loss 0.882, Train_accy 79.36:  15%|█▌        | 3/20 [01:54<08:05, 28.59s/it]
Task 2, Epoch 4/20 => Loss 0.882, Train_accy 79.36:  20%|██        | 4/20 [01:54<07:36, 28.56s/it]
Task 2, Epoch 5/20 => Loss 0.863, Train_accy 79.26:  20%|██        | 4/20 [02:22<07:36, 28.56s/it]
Task 2, Epoch 5/20 => Loss 0.863, Train_accy 79.26:  25%|██▌       | 5/20 [02:22<07:08, 28.56s/it]
Task 2, Epoch 6/20 => Loss 0.861, Train_accy 79.09:  25%|██▌       | 5/20 [02:51<07:08, 28.56s/it]
Task 2, Epoch 6/20 => Loss 0.861, Train_accy 79.09:  30%|███       | 6/20 [02:51<06:40, 28.59s/it]
Task 2, Epoch 7/20 => Loss 0.815, Train_accy 80.52:  30%|███       | 6/20 [03:20<06:40, 28.59s/it]
Task 2, Epoch 7/20 => Loss 0.815, Train_accy 80.52:  35%|███▌      | 7/20 [03:20<06:11, 28.56s/it]
Task 2, Epoch 8/20 => Loss 0.843, Train_accy 79.61:  35%|███▌      | 7/20 [03:48<06:11, 28.56s/it]
Task 2, Epoch 8/20 => Loss 0.843, Train_accy 79.61:  40%|████      | 8/20 [03:48<05:42, 28.55s/it]
Task 2, Epoch 9/20 => Loss 0.830, Train_accy 79.50:  40%|████      | 8/20 [04:17<05:42, 28.55s/it]
Task 2, Epoch 9/20 => Loss 0.830, Train_accy 79.50:  45%|████▌     | 9/20 [04:17<05:13, 28.54s/it]
Task 2, Epoch 10/20 => Loss 0.819, Train_accy 79.65:  45%|████▌     | 9/20 [04:45<05:13, 28.54s/it]
Task 2, Epoch 10/20 => Loss 0.819, Train_accy 79.65:  50%|█████     | 10/20 [04:45<04:45, 28.56s/it]
Task 2, Epoch 11/20 => Loss 0.802, Train_accy 80.31:  50%|█████     | 10/20 [05:14<04:45, 28.56s/it]
Task 2, Epoch 11/20 => Loss 0.802, Train_accy 80.31:  55%|█████▌    | 11/20 [05:14<04:17, 28.59s/it]
Task 2, Epoch 12/20 => Loss 0.787, Train_accy 80.87:  55%|█████▌    | 11/20 [05:42<04:17, 28.59s/it]
Task 2, Epoch 12/20 => Loss 0.787, Train_accy 80.87:  60%|██████    | 12/20 [05:42<03:48, 28.60s/it]
Task 2, Epoch 13/20 => Loss 0.764, Train_accy 81.61:  60%|██████    | 12/20 [06:11<03:48, 28.60s/it]
Task 2, Epoch 13/20 => Loss 0.764, Train_accy 81.61:  65%|██████▌   | 13/20 [06:11<03:20, 28.59s/it]
Task 2, Epoch 14/20 => Loss 0.758, Train_accy 81.59:  65%|██████▌   | 13/20 [06:40<03:20, 28.59s/it]
Task 2, Epoch 14/20 => Loss 0.758, Train_accy 81.59:  70%|███████   | 14/20 [06:40<02:51, 28.60s/it]
Task 2, Epoch 15/20 => Loss 0.716, Train_accy 82.71:  70%|███████   | 14/20 [07:08<02:51, 28.60s/it]
Task 2, Epoch 15/20 => Loss 0.716, Train_accy 82.71:  75%|███████▌  | 15/20 [07:08<02:22, 28.58s/it]
Task 2, Epoch 16/20 => Loss 0.710, Train_accy 82.85:  75%|███████▌  | 15/20 [07:37<02:22, 28.58s/it]
Task 2, Epoch 16/20 => Loss 0.710, Train_accy 82.85:  80%|████████  | 16/20 [07:37<01:54, 28.56s/it]
Task 2, Epoch 17/20 => Loss 0.698, Train_accy 82.62:  80%|████████  | 16/20 [08:05<01:54, 28.56s/it]
Task 2, Epoch 17/20 => Loss 0.698, Train_accy 82.62:  85%|████████▌ | 17/20 [08:05<01:25, 28.54s/it]
Task 2, Epoch 18/20 => Loss 0.710, Train_accy 82.23:  85%|████████▌ | 17/20 [08:34<01:25, 28.54s/it]
Task 2, Epoch 18/20 => Loss 0.710, Train_accy 82.23:  90%|█████████ | 18/20 [08:34<00:57, 28.52s/it]
Task 2, Epoch 19/20 => Loss 0.694, Train_accy 82.93:  90%|█████████ | 18/20 [09:02<00:57, 28.52s/it]
Task 2, Epoch 19/20 => Loss 0.694, Train_accy 82.93:  95%|█████████▌| 19/20 [09:02<00:28, 28.50s/it]
Task 2, Epoch 20/20 => Loss 0.687, Train_accy 83.41:  95%|█████████▌| 19/20 [09:31<00:28, 28.50s/it]
Task 2, Epoch 20/20 => Loss 0.687, Train_accy 83.41: 100%|██████████| 20/20 [09:31<00:00, 28.51s/it]
Task 2, Epoch 20/20 => Loss 0.687, Train_accy 83.41: 100%|██████████| 20/20 [09:31<00:00, 28.56s/it]
2024-09-08 08:06:12,562 [ease.py] => Task 2, Epoch 20/20 => Loss 0.687, Train_accy 83.41
2024-09-08 08:07:29,602 [ease.py] => Task correct: 86.3923182441701
2024-09-08 08:07:29,602 [ease.py] => Task acc: 88.25788751714677
2024-09-08 08:07:29,625 [trainer.py] => No NME accuracy.
2024-09-08 08:07:29,625 [trainer.py] => CNN: {'total': 80.19, '00-39': 80.92, '40-79': 78.42, '80-119': 81.17, 'old': 79.74, 'new': 81.17}
2024-09-08 08:07:29,625 [trainer.py] => CNN top1 curve: [88.12, 83.71, 80.19]
2024-09-08 08:07:29,625 [trainer.py] => CNN top5 curve: [97.43, 95.08, 93.61]

Average Accuracy (CNN): 84.01
2024-09-08 08:07:29,626 [trainer.py] => Average Accuracy (CNN): 84.01 

2024-09-08 08:07:29,626 [trainer.py] => All params: 86410178
2024-09-08 08:07:29,627 [trainer.py] => Trainable params: 304320
2024-09-08 08:07:29,632 [ease.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.086, Train_accy 35.65:   0%|          | 0/20 [00:29<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.086, Train_accy 35.65:   5%|▌         | 1/20 [00:29<09:15, 29.26s/it]
Task 3, Epoch 2/20 => Loss 1.318, Train_accy 73.50:   5%|▌         | 1/20 [00:58<09:15, 29.26s/it]
Task 3, Epoch 2/20 => Loss 1.318, Train_accy 73.50:  10%|█         | 2/20 [00:58<08:45, 29.18s/it]
Task 3, Epoch 3/20 => Loss 0.919, Train_accy 78.91:  10%|█         | 2/20 [01:27<08:45, 29.18s/it]
Task 3, Epoch 3/20 => Loss 0.919, Train_accy 78.91:  15%|█▌        | 3/20 [01:27<08:15, 29.15s/it]
Task 3, Epoch 4/20 => Loss 0.869, Train_accy 79.88:  15%|█▌        | 3/20 [01:56<08:15, 29.15s/it]
Task 3, Epoch 4/20 => Loss 0.869, Train_accy 79.88:  20%|██        | 4/20 [01:56<07:46, 29.16s/it]
Task 3, Epoch 5/20 => Loss 0.825, Train_accy 81.09:  20%|██        | 4/20 [02:25<07:46, 29.16s/it]
Task 3, Epoch 5/20 => Loss 0.825, Train_accy 81.09:  25%|██▌       | 5/20 [02:25<07:16, 29.12s/it]
Task 3, Epoch 6/20 => Loss 0.831, Train_accy 80.53:  25%|██▌       | 5/20 [02:55<07:16, 29.12s/it]
Task 3, Epoch 6/20 => Loss 0.831, Train_accy 80.53:  30%|███       | 6/20 [02:55<06:49, 29.22s/it]
Task 3, Epoch 7/20 => Loss 0.803, Train_accy 81.07:  30%|███       | 6/20 [03:24<06:49, 29.22s/it]
Task 3, Epoch 7/20 => Loss 0.803, Train_accy 81.07:  35%|███▌      | 7/20 [03:24<06:19, 29.21s/it]
Task 3, Epoch 8/20 => Loss 0.788, Train_accy 80.99:  35%|███▌      | 7/20 [03:53<06:19, 29.21s/it]
Task 3, Epoch 8/20 => Loss 0.788, Train_accy 80.99:  40%|████      | 8/20 [03:53<05:50, 29.18s/it]
Task 3, Epoch 9/20 => Loss 0.758, Train_accy 82.35:  40%|████      | 8/20 [04:22<05:50, 29.18s/it]
Task 3, Epoch 9/20 => Loss 0.758, Train_accy 82.35:  45%|████▌     | 9/20 [04:22<05:20, 29.16s/it]
Task 3, Epoch 10/20 => Loss 0.788, Train_accy 81.07:  45%|████▌     | 9/20 [04:51<05:20, 29.16s/it]
Task 3, Epoch 10/20 => Loss 0.788, Train_accy 81.07:  50%|█████     | 10/20 [04:51<04:51, 29.13s/it]
Task 3, Epoch 11/20 => Loss 0.746, Train_accy 82.63:  50%|█████     | 10/20 [05:20<04:51, 29.13s/it]
Task 3, Epoch 11/20 => Loss 0.746, Train_accy 82.63:  55%|█████▌    | 11/20 [05:20<04:22, 29.16s/it]
Task 3, Epoch 12/20 => Loss 0.759, Train_accy 81.66:  55%|█████▌    | 11/20 [05:49<04:22, 29.16s/it]
Task 3, Epoch 12/20 => Loss 0.759, Train_accy 81.66:  60%|██████    | 12/20 [05:49<03:53, 29.13s/it]
Task 3, Epoch 13/20 => Loss 0.746, Train_accy 82.11:  60%|██████    | 12/20 [06:19<03:53, 29.13s/it]
Task 3, Epoch 13/20 => Loss 0.746, Train_accy 82.11:  65%|██████▌   | 13/20 [06:19<03:24, 29.17s/it]
Task 3, Epoch 14/20 => Loss 0.718, Train_accy 83.22:  65%|██████▌   | 13/20 [06:48<03:24, 29.17s/it]
Task 3, Epoch 14/20 => Loss 0.718, Train_accy 83.22:  70%|███████   | 14/20 [06:48<02:54, 29.14s/it]
Task 3, Epoch 15/20 => Loss 0.722, Train_accy 81.94:  70%|███████   | 14/20 [07:17<02:54, 29.14s/it]
Task 3, Epoch 15/20 => Loss 0.722, Train_accy 81.94:  75%|███████▌  | 15/20 [07:17<02:25, 29.12s/it]
Task 3, Epoch 16/20 => Loss 0.694, Train_accy 83.52:  75%|███████▌  | 15/20 [07:46<02:25, 29.12s/it]
Task 3, Epoch 16/20 => Loss 0.694, Train_accy 83.52:  80%|████████  | 16/20 [07:46<01:56, 29.14s/it]
Task 3, Epoch 17/20 => Loss 0.686, Train_accy 83.64:  80%|████████  | 16/20 [08:15<01:56, 29.14s/it]
Task 3, Epoch 17/20 => Loss 0.686, Train_accy 83.64:  85%|████████▌ | 17/20 [08:15<01:27, 29.14s/it]
Task 3, Epoch 18/20 => Loss 0.675, Train_accy 83.91:  85%|████████▌ | 17/20 [08:44<01:27, 29.14s/it]
Task 3, Epoch 18/20 => Loss 0.675, Train_accy 83.91:  90%|█████████ | 18/20 [08:44<00:58, 29.18s/it]
Task 3, Epoch 19/20 => Loss 0.652, Train_accy 84.64:  90%|█████████ | 18/20 [09:14<00:58, 29.18s/it]
Task 3, Epoch 19/20 => Loss 0.652, Train_accy 84.64:  95%|█████████▌| 19/20 [09:14<00:29, 29.20s/it]
Task 3, Epoch 20/20 => Loss 0.661, Train_accy 84.17:  95%|█████████▌| 19/20 [09:43<00:29, 29.20s/it]
Task 3, Epoch 20/20 => Loss 0.661, Train_accy 84.17: 100%|██████████| 20/20 [09:43<00:00, 29.30s/it]
Task 3, Epoch 20/20 => Loss 0.661, Train_accy 84.17: 100%|██████████| 20/20 [09:43<00:00, 29.18s/it]
2024-09-08 08:17:13,306 [ease.py] => Task 3, Epoch 20/20 => Loss 0.661, Train_accy 84.17
2024-09-08 08:19:11,737 [ease.py] => Task correct: 84.3010317620878
2024-09-08 08:19:11,738 [ease.py] => Task acc: 88.12462067570301
2024-09-08 08:19:11,760 [trainer.py] => No NME accuracy.
2024-09-08 08:19:11,760 [trainer.py] => CNN: {'total': 78.94, '00-39': 78.8, '40-79': 77.49, '80-119': 78.64, '120-159': 80.66, 'old': 78.33, 'new': 80.66}
2024-09-08 08:19:11,760 [trainer.py] => CNN top1 curve: [88.12, 83.71, 80.19, 78.94]
2024-09-08 08:19:11,760 [trainer.py] => CNN top5 curve: [97.43, 95.08, 93.61, 92.31]

Average Accuracy (CNN): 82.74
2024-09-08 08:19:11,760 [trainer.py] => Average Accuracy (CNN): 82.74 

2024-09-08 08:19:11,761 [trainer.py] => All params: 86625218
2024-09-08 08:19:11,762 [trainer.py] => Trainable params: 304320
2024-09-08 08:19:11,769 [ease.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.231, Train_accy 34.02:   0%|          | 0/20 [00:24<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.231, Train_accy 34.02:   5%|▌         | 1/20 [00:24<07:52, 24.86s/it]
Task 4, Epoch 2/20 => Loss 1.605, Train_accy 68.11:   5%|▌         | 1/20 [00:49<07:52, 24.86s/it]
Task 4, Epoch 2/20 => Loss 1.605, Train_accy 68.11:  10%|█         | 2/20 [00:49<07:27, 24.86s/it]
Task 4, Epoch 3/20 => Loss 1.048, Train_accy 76.29:  10%|█         | 2/20 [01:14<07:27, 24.86s/it]
Task 4, Epoch 3/20 => Loss 1.048, Train_accy 76.29:  15%|█▌        | 3/20 [01:14<07:04, 24.98s/it]
Task 4, Epoch 4/20 => Loss 0.916, Train_accy 78.57:  15%|█▌        | 3/20 [01:39<07:04, 24.98s/it]
Task 4, Epoch 4/20 => Loss 0.916, Train_accy 78.57:  20%|██        | 4/20 [01:39<06:39, 24.98s/it]
Task 4, Epoch 5/20 => Loss 0.885, Train_accy 79.30:  20%|██        | 4/20 [02:04<06:39, 24.98s/it]
Task 4, Epoch 5/20 => Loss 0.885, Train_accy 79.30:  25%|██▌       | 5/20 [02:04<06:14, 24.95s/it]
Task 4, Epoch 6/20 => Loss 0.858, Train_accy 79.61:  25%|██▌       | 5/20 [02:29<06:14, 24.95s/it]
Task 4, Epoch 6/20 => Loss 0.858, Train_accy 79.61:  30%|███       | 6/20 [02:29<05:49, 24.94s/it]
Task 4, Epoch 7/20 => Loss 0.835, Train_accy 80.46:  30%|███       | 6/20 [02:54<05:49, 24.94s/it]
Task 4, Epoch 7/20 => Loss 0.835, Train_accy 80.46:  35%|███▌      | 7/20 [02:54<05:23, 24.91s/it]
Task 4, Epoch 8/20 => Loss 0.826, Train_accy 80.68:  35%|███▌      | 7/20 [03:19<05:23, 24.91s/it]
Task 4, Epoch 8/20 => Loss 0.826, Train_accy 80.68:  40%|████      | 8/20 [03:19<04:58, 24.91s/it]
Task 4, Epoch 9/20 => Loss 0.824, Train_accy 80.39:  40%|████      | 8/20 [03:44<04:58, 24.91s/it]
Task 4, Epoch 9/20 => Loss 0.824, Train_accy 80.39:  45%|████▌     | 9/20 [03:44<04:34, 24.94s/it]
Task 4, Epoch 10/20 => Loss 0.798, Train_accy 81.10:  45%|████▌     | 9/20 [04:09<04:34, 24.94s/it]
Task 4, Epoch 10/20 => Loss 0.798, Train_accy 81.10:  50%|█████     | 10/20 [04:09<04:09, 24.94s/it]
Task 4, Epoch 11/20 => Loss 0.799, Train_accy 81.06:  50%|█████     | 10/20 [04:34<04:09, 24.94s/it]
Task 4, Epoch 11/20 => Loss 0.799, Train_accy 81.06:  55%|█████▌    | 11/20 [04:34<03:44, 24.94s/it]
Task 4, Epoch 12/20 => Loss 0.798, Train_accy 80.70:  55%|█████▌    | 11/20 [04:59<03:44, 24.94s/it]
Task 4, Epoch 12/20 => Loss 0.798, Train_accy 80.70:  60%|██████    | 12/20 [04:59<03:19, 24.93s/it]
Task 4, Epoch 13/20 => Loss 0.757, Train_accy 81.72:  60%|██████    | 12/20 [05:24<03:19, 24.93s/it]
Task 4, Epoch 13/20 => Loss 0.757, Train_accy 81.72:  65%|██████▌   | 13/20 [05:24<02:54, 24.92s/it]
Task 4, Epoch 14/20 => Loss 0.768, Train_accy 81.84:  65%|██████▌   | 13/20 [05:48<02:54, 24.92s/it]
Task 4, Epoch 14/20 => Loss 0.768, Train_accy 81.84:  70%|███████   | 14/20 [05:48<02:29, 24.90s/it]
Task 4, Epoch 15/20 => Loss 0.759, Train_accy 81.67:  70%|███████   | 14/20 [06:13<02:29, 24.90s/it]
Task 4, Epoch 15/20 => Loss 0.759, Train_accy 81.67:  75%|███████▌  | 15/20 [06:13<02:04, 24.92s/it]
Task 4, Epoch 16/20 => Loss 0.739, Train_accy 83.03:  75%|███████▌  | 15/20 [06:38<02:04, 24.92s/it]
Task 4, Epoch 16/20 => Loss 0.739, Train_accy 83.03:  80%|████████  | 16/20 [06:38<01:39, 24.94s/it]
Task 4, Epoch 17/20 => Loss 0.725, Train_accy 82.55:  80%|████████  | 16/20 [07:03<01:39, 24.94s/it]
Task 4, Epoch 17/20 => Loss 0.725, Train_accy 82.55:  85%|████████▌ | 17/20 [07:03<01:14, 24.93s/it]
Task 4, Epoch 18/20 => Loss 0.744, Train_accy 82.43:  85%|████████▌ | 17/20 [07:28<01:14, 24.93s/it]
Task 4, Epoch 18/20 => Loss 0.744, Train_accy 82.43:  90%|█████████ | 18/20 [07:28<00:49, 24.92s/it]
Task 4, Epoch 19/20 => Loss 0.739, Train_accy 82.55:  90%|█████████ | 18/20 [07:53<00:49, 24.92s/it]
Task 4, Epoch 19/20 => Loss 0.739, Train_accy 82.55:  95%|█████████▌| 19/20 [07:53<00:24, 24.90s/it]
Task 4, Epoch 20/20 => Loss 0.691, Train_accy 83.93:  95%|█████████▌| 19/20 [08:18<00:24, 24.90s/it]
Task 4, Epoch 20/20 => Loss 0.691, Train_accy 83.93: 100%|██████████| 20/20 [08:18<00:00, 24.89s/it]
Task 4, Epoch 20/20 => Loss 0.691, Train_accy 83.93: 100%|██████████| 20/20 [08:18<00:00, 24.92s/it]
2024-09-08 08:27:30,208 [ease.py] => Task 4, Epoch 20/20 => Loss 0.691, Train_accy 83.93
2024-09-08 08:30:03,531 [ease.py] => Task correct: 81.26666666666667
2024-09-08 08:30:03,532 [ease.py] => Task acc: 88.11666666666666
2024-09-08 08:30:03,555 [trainer.py] => No NME accuracy.
2024-09-08 08:30:03,555 [trainer.py] => CNN: {'total': 77.02, '00-39': 77.82, '40-79': 75.19, '80-119': 75.85, '120-159': 79.04, '160-199': 76.82, 'old': 77.06, 'new': 76.82}
2024-09-08 08:30:03,555 [trainer.py] => CNN top1 curve: [88.12, 83.71, 80.19, 78.94, 77.02]
2024-09-08 08:30:03,555 [trainer.py] => CNN top5 curve: [97.43, 95.08, 93.61, 92.31, 91.1]

Average Accuracy (CNN): 81.6
2024-09-08 08:30:03,555 [trainer.py] => Average Accuracy (CNN): 81.6 

Accuracy Matrix (CNN):
[[88.12 84.18 80.92 78.8  77.82]
 [ 0.   83.18 78.42 77.49 75.19]
 [ 0.    0.   81.17 78.64 75.85]
 [ 0.    0.    0.   80.66 79.04]
 [ 0.    0.    0.    0.   76.82]]
2024-09-08 08:30:03,556 [trainer.py] => Forgetting (CNN): 6.3075000000000045
2024-09-08 08:30:06,354 [trainer.py] => config: ./exps/ease_inr_B0_Inc10.json
2024-09-08 08:30:06,354 [trainer.py] => prefix:  
2024-09-08 08:30:06,354 [trainer.py] => dataset: imagenetr
2024-09-08 08:30:06,354 [trainer.py] => memory_size: 0
2024-09-08 08:30:06,354 [trainer.py] => memory_per_class: 0
2024-09-08 08:30:06,354 [trainer.py] => fixed_memory: False
2024-09-08 08:30:06,354 [trainer.py] => shuffle: True
2024-09-08 08:30:06,354 [trainer.py] => init_cls: 20
2024-09-08 08:30:06,354 [trainer.py] => increment: 20
2024-09-08 08:30:06,354 [trainer.py] => model_name: ease
2024-09-08 08:30:06,354 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-08 08:30:06,354 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 08:30:06,354 [trainer.py] => seed: 1993
2024-09-08 08:30:06,354 [trainer.py] => init_epochs: 20
2024-09-08 08:30:06,354 [trainer.py] => init_lr: 0.05
2024-09-08 08:30:06,355 [trainer.py] => later_epochs: 20
2024-09-08 08:30:06,355 [trainer.py] => later_lr: 0.05
2024-09-08 08:30:06,355 [trainer.py] => batch_size: 48
2024-09-08 08:30:06,355 [trainer.py] => weight_decay: 0.005
2024-09-08 08:30:06,355 [trainer.py] => min_lr: 0
2024-09-08 08:30:06,355 [trainer.py] => optimizer: sgd
2024-09-08 08:30:06,355 [trainer.py] => scheduler: cosine
2024-09-08 08:30:06,355 [trainer.py] => pretrained: True
2024-09-08 08:30:06,355 [trainer.py] => vpt_type: Deep
2024-09-08 08:30:06,355 [trainer.py] => prompt_token_num: 5
2024-09-08 08:30:06,355 [trainer.py] => ffn_num: 16
2024-09-08 08:30:06,355 [trainer.py] => use_diagonal: False
2024-09-08 08:30:06,355 [trainer.py] => recalc_sim: True
2024-09-08 08:30:06,355 [trainer.py] => alpha: 0.1
2024-09-08 08:30:06,355 [trainer.py] => use_init_ptm: False
2024-09-08 08:30:06,355 [trainer.py] => beta: 0
2024-09-08 08:30:06,355 [trainer.py] => use_old_data: False
2024-09-08 08:30:06,355 [trainer.py] => use_reweight: True
2024-09-08 08:30:06,355 [trainer.py] => moni_adam: False
2024-09-08 08:30:06,355 [trainer.py] => adapter_num: -1
2024-09-08 08:30:06,438 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-08 08:30:09,410 [trainer.py] => All params: 86102976
2024-09-08 08:30:09,411 [trainer.py] => Trainable params: 304320
2024-09-08 08:30:09,417 [ease.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.684, Train_accy 39.76:   0%|          | 0/20 [00:17<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.684, Train_accy 39.76:   5%|▌         | 1/20 [00:17<05:23, 17.02s/it]
Task 0, Epoch 2/20 => Loss 1.534, Train_accy 71.40:   5%|▌         | 1/20 [00:33<05:23, 17.02s/it]
Task 0, Epoch 2/20 => Loss 1.534, Train_accy 71.40:  10%|█         | 2/20 [00:33<05:02, 16.83s/it]
Task 0, Epoch 3/20 => Loss 0.880, Train_accy 80.53:  10%|█         | 2/20 [00:50<05:02, 16.83s/it]
Task 0, Epoch 3/20 => Loss 0.880, Train_accy 80.53:  15%|█▌        | 3/20 [00:50<04:45, 16.81s/it]
Task 0, Epoch 4/20 => Loss 0.652, Train_accy 84.06:  15%|█▌        | 3/20 [01:07<04:45, 16.81s/it]
Task 0, Epoch 4/20 => Loss 0.652, Train_accy 84.06:  20%|██        | 4/20 [01:07<04:29, 16.83s/it]
Task 0, Epoch 5/20 => Loss 0.585, Train_accy 85.95:  20%|██        | 4/20 [01:24<04:29, 16.83s/it]
Task 0, Epoch 5/20 => Loss 0.585, Train_accy 85.95:  25%|██▌       | 5/20 [01:24<04:11, 16.80s/it]
Task 0, Epoch 6/20 => Loss 0.549, Train_accy 86.45:  25%|██▌       | 5/20 [01:40<04:11, 16.80s/it]
Task 0, Epoch 6/20 => Loss 0.549, Train_accy 86.45:  30%|███       | 6/20 [01:40<03:54, 16.76s/it]
Task 0, Epoch 7/20 => Loss 0.557, Train_accy 86.31:  30%|███       | 6/20 [01:57<03:54, 16.76s/it]
Task 0, Epoch 7/20 => Loss 0.557, Train_accy 86.31:  35%|███▌      | 7/20 [01:57<03:37, 16.74s/it]
Task 0, Epoch 8/20 => Loss 0.535, Train_accy 86.52:  35%|███▌      | 7/20 [02:14<03:37, 16.74s/it]
Task 0, Epoch 8/20 => Loss 0.535, Train_accy 86.52:  40%|████      | 8/20 [02:14<03:21, 16.80s/it]
Task 0, Epoch 9/20 => Loss 0.509, Train_accy 87.16:  40%|████      | 8/20 [02:31<03:21, 16.80s/it]
Task 0, Epoch 9/20 => Loss 0.509, Train_accy 87.16:  45%|████▌     | 9/20 [02:31<03:04, 16.78s/it]
Task 0, Epoch 10/20 => Loss 0.517, Train_accy 86.52:  45%|████▌     | 9/20 [02:47<03:04, 16.78s/it]
Task 0, Epoch 10/20 => Loss 0.517, Train_accy 86.52:  50%|█████     | 10/20 [02:47<02:47, 16.78s/it]
Task 0, Epoch 11/20 => Loss 0.526, Train_accy 87.13:  50%|█████     | 10/20 [03:04<02:47, 16.78s/it]
Task 0, Epoch 11/20 => Loss 0.526, Train_accy 87.13:  55%|█████▌    | 11/20 [03:04<02:30, 16.75s/it]
Task 0, Epoch 12/20 => Loss 0.486, Train_accy 87.98:  55%|█████▌    | 11/20 [03:21<02:30, 16.75s/it]
Task 0, Epoch 12/20 => Loss 0.486, Train_accy 87.98:  60%|██████    | 12/20 [03:21<02:13, 16.74s/it]
Task 0, Epoch 13/20 => Loss 0.482, Train_accy 87.91:  60%|██████    | 12/20 [03:38<02:13, 16.74s/it]
Task 0, Epoch 13/20 => Loss 0.482, Train_accy 87.91:  65%|██████▌   | 13/20 [03:38<01:57, 16.76s/it]
Task 0, Epoch 14/20 => Loss 0.451, Train_accy 89.30:  65%|██████▌   | 13/20 [03:54<01:57, 16.76s/it]
Task 0, Epoch 14/20 => Loss 0.451, Train_accy 89.30:  70%|███████   | 14/20 [03:54<01:40, 16.76s/it]
Task 0, Epoch 15/20 => Loss 0.482, Train_accy 87.77:  70%|███████   | 14/20 [04:11<01:40, 16.76s/it]
Task 0, Epoch 15/20 => Loss 0.482, Train_accy 87.77:  75%|███████▌  | 15/20 [04:11<01:23, 16.76s/it]
Task 0, Epoch 16/20 => Loss 0.467, Train_accy 87.91:  75%|███████▌  | 15/20 [04:28<01:23, 16.76s/it]
Task 0, Epoch 16/20 => Loss 0.467, Train_accy 87.91:  80%|████████  | 16/20 [04:28<01:06, 16.75s/it]
Task 0, Epoch 17/20 => Loss 0.459, Train_accy 87.98:  80%|████████  | 16/20 [04:45<01:06, 16.75s/it]
Task 0, Epoch 17/20 => Loss 0.459, Train_accy 87.98:  85%|████████▌ | 17/20 [04:45<00:50, 16.73s/it]
Task 0, Epoch 18/20 => Loss 0.467, Train_accy 88.62:  85%|████████▌ | 17/20 [05:01<00:50, 16.73s/it]
Task 0, Epoch 18/20 => Loss 0.467, Train_accy 88.62:  90%|█████████ | 18/20 [05:01<00:33, 16.77s/it]
Task 0, Epoch 19/20 => Loss 0.463, Train_accy 88.23:  90%|█████████ | 18/20 [05:18<00:33, 16.77s/it]
Task 0, Epoch 19/20 => Loss 0.463, Train_accy 88.23:  95%|█████████▌| 19/20 [05:18<00:16, 16.78s/it]
Task 0, Epoch 20/20 => Loss 0.439, Train_accy 89.02:  95%|█████████▌| 19/20 [05:35<00:16, 16.78s/it]
Task 0, Epoch 20/20 => Loss 0.439, Train_accy 89.02: 100%|██████████| 20/20 [05:35<00:00, 16.76s/it]
Task 0, Epoch 20/20 => Loss 0.439, Train_accy 89.02: 100%|██████████| 20/20 [05:35<00:00, 16.77s/it]
2024-09-08 08:35:44,925 [ease.py] => Task 0, Epoch 20/20 => Loss 0.439, Train_accy 89.02
2024-09-08 08:35:56,441 [ease.py] => Task correct: 100.0
2024-09-08 08:35:56,441 [ease.py] => Task acc: 92.16255442670537
2024-09-08 08:35:56,461 [trainer.py] => No NME accuracy.
2024-09-08 08:35:56,461 [trainer.py] => CNN: {'total': 92.16, '00-19': 92.16, 'old': 0, 'new': 92.16}
2024-09-08 08:35:56,461 [trainer.py] => CNN top1 curve: [92.16]
2024-09-08 08:35:56,461 [trainer.py] => CNN top5 curve: [98.69]

Average Accuracy (CNN): 92.16
2024-09-08 08:35:56,461 [trainer.py] => Average Accuracy (CNN): 92.16 

2024-09-08 08:35:56,462 [trainer.py] => All params: 86133698
2024-09-08 08:35:56,462 [trainer.py] => Trainable params: 304320
2024-09-08 08:35:56,464 [ease.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.731, Train_accy 42.58:   0%|          | 0/20 [00:15<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.731, Train_accy 42.58:   5%|▌         | 1/20 [00:15<04:50, 15.30s/it]
Task 1, Epoch 2/20 => Loss 1.626, Train_accy 70.49:   5%|▌         | 1/20 [00:30<04:50, 15.30s/it]
Task 1, Epoch 2/20 => Loss 1.626, Train_accy 70.49:  10%|█         | 2/20 [00:30<04:36, 15.34s/it]
Task 1, Epoch 3/20 => Loss 0.906, Train_accy 79.39:  10%|█         | 2/20 [00:46<04:36, 15.34s/it]
Task 1, Epoch 3/20 => Loss 0.906, Train_accy 79.39:  15%|█▌        | 3/20 [00:46<04:20, 15.35s/it]
Task 1, Epoch 4/20 => Loss 0.674, Train_accy 82.90:  15%|█▌        | 3/20 [01:01<04:20, 15.35s/it]
Task 1, Epoch 4/20 => Loss 0.674, Train_accy 82.90:  20%|██        | 4/20 [01:01<04:05, 15.36s/it]
Task 1, Epoch 5/20 => Loss 0.618, Train_accy 84.07:  20%|██        | 4/20 [01:16<04:05, 15.36s/it]
Task 1, Epoch 5/20 => Loss 0.618, Train_accy 84.07:  25%|██▌       | 5/20 [01:16<03:50, 15.38s/it]
Task 1, Epoch 6/20 => Loss 0.589, Train_accy 84.27:  25%|██▌       | 5/20 [01:32<03:50, 15.38s/it]
Task 1, Epoch 6/20 => Loss 0.589, Train_accy 84.27:  30%|███       | 6/20 [01:32<03:35, 15.40s/it]
Task 1, Epoch 7/20 => Loss 0.579, Train_accy 84.35:  30%|███       | 6/20 [01:47<03:35, 15.40s/it]
Task 1, Epoch 7/20 => Loss 0.579, Train_accy 84.35:  35%|███▌      | 7/20 [01:47<03:20, 15.44s/it]
Task 1, Epoch 8/20 => Loss 0.577, Train_accy 84.66:  35%|███▌      | 7/20 [02:03<03:20, 15.44s/it]
Task 1, Epoch 8/20 => Loss 0.577, Train_accy 84.66:  40%|████      | 8/20 [02:03<03:05, 15.48s/it]
Task 1, Epoch 9/20 => Loss 0.557, Train_accy 84.97:  40%|████      | 8/20 [02:18<03:05, 15.48s/it]
Task 1, Epoch 9/20 => Loss 0.557, Train_accy 84.97:  45%|████▌     | 9/20 [02:18<02:49, 15.45s/it]
Task 1, Epoch 10/20 => Loss 0.538, Train_accy 85.64:  45%|████▌     | 9/20 [02:34<02:49, 15.45s/it]
Task 1, Epoch 10/20 => Loss 0.538, Train_accy 85.64:  50%|█████     | 10/20 [02:34<02:34, 15.47s/it]
Task 1, Epoch 11/20 => Loss 0.550, Train_accy 85.44:  50%|█████     | 10/20 [02:49<02:34, 15.47s/it]
Task 1, Epoch 11/20 => Loss 0.550, Train_accy 85.44:  55%|█████▌    | 11/20 [02:49<02:18, 15.43s/it]
Task 1, Epoch 12/20 => Loss 0.538, Train_accy 85.68:  55%|█████▌    | 11/20 [03:04<02:18, 15.43s/it]
Task 1, Epoch 12/20 => Loss 0.538, Train_accy 85.68:  60%|██████    | 12/20 [03:04<02:03, 15.41s/it]
Task 1, Epoch 13/20 => Loss 0.486, Train_accy 87.24:  60%|██████    | 12/20 [03:20<02:03, 15.41s/it]
Task 1, Epoch 13/20 => Loss 0.486, Train_accy 87.24:  65%|██████▌   | 13/20 [03:20<01:47, 15.41s/it]
Task 1, Epoch 14/20 => Loss 0.485, Train_accy 87.35:  65%|██████▌   | 13/20 [03:35<01:47, 15.41s/it]
Task 1, Epoch 14/20 => Loss 0.485, Train_accy 87.35:  70%|███████   | 14/20 [03:35<01:32, 15.40s/it]
Task 1, Epoch 15/20 => Loss 0.510, Train_accy 87.24:  70%|███████   | 14/20 [03:51<01:32, 15.40s/it]
Task 1, Epoch 15/20 => Loss 0.510, Train_accy 87.24:  75%|███████▌  | 15/20 [03:51<01:16, 15.39s/it]
Task 1, Epoch 16/20 => Loss 0.491, Train_accy 87.12:  75%|███████▌  | 15/20 [04:06<01:16, 15.39s/it]
Task 1, Epoch 16/20 => Loss 0.491, Train_accy 87.12:  80%|████████  | 16/20 [04:06<01:01, 15.37s/it]
Task 1, Epoch 17/20 => Loss 0.500, Train_accy 87.08:  80%|████████  | 16/20 [04:21<01:01, 15.37s/it]
Task 1, Epoch 17/20 => Loss 0.500, Train_accy 87.08:  85%|████████▌ | 17/20 [04:21<00:46, 15.39s/it]
Task 1, Epoch 18/20 => Loss 0.484, Train_accy 87.20:  85%|████████▌ | 17/20 [04:37<00:46, 15.39s/it]
Task 1, Epoch 18/20 => Loss 0.484, Train_accy 87.20:  90%|█████████ | 18/20 [04:37<00:30, 15.39s/it]
Task 1, Epoch 19/20 => Loss 0.448, Train_accy 88.17:  90%|█████████ | 18/20 [04:52<00:30, 15.39s/it]
Task 1, Epoch 19/20 => Loss 0.448, Train_accy 88.17:  95%|█████████▌| 19/20 [04:52<00:15, 15.41s/it]
Task 1, Epoch 20/20 => Loss 0.462, Train_accy 87.70:  95%|█████████▌| 19/20 [05:08<00:15, 15.41s/it]
Task 1, Epoch 20/20 => Loss 0.462, Train_accy 87.70: 100%|██████████| 20/20 [05:08<00:00, 15.39s/it]
Task 1, Epoch 20/20 => Loss 0.462, Train_accy 87.70: 100%|██████████| 20/20 [05:08<00:00, 15.40s/it]
2024-09-08 08:41:04,528 [ease.py] => Task 1, Epoch 20/20 => Loss 0.462, Train_accy 87.70
2024-09-08 08:41:29,323 [ease.py] => Task correct: 92.12717638152914
2024-09-08 08:41:29,324 [ease.py] => Task acc: 91.59727479182438
2024-09-08 08:41:29,351 [trainer.py] => No NME accuracy.
2024-09-08 08:41:29,351 [trainer.py] => CNN: {'total': 86.98, '00-19': 86.36, '20-39': 87.66, 'old': 86.36, 'new': 87.66}
2024-09-08 08:41:29,352 [trainer.py] => CNN top1 curve: [92.16, 86.98]
2024-09-08 08:41:29,352 [trainer.py] => CNN top5 curve: [98.69, 97.43]

Average Accuracy (CNN): 89.57
2024-09-08 08:41:29,352 [trainer.py] => Average Accuracy (CNN): 89.57 

2024-09-08 08:41:29,353 [trainer.py] => All params: 86179778
2024-09-08 08:41:29,354 [trainer.py] => Trainable params: 304320
2024-09-08 08:41:29,356 [ease.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.818, Train_accy 37.52:   0%|          | 0/20 [00:14<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.818, Train_accy 37.52:   5%|▌         | 1/20 [00:14<04:28, 14.12s/it]
Task 2, Epoch 2/20 => Loss 1.927, Train_accy 65.98:   5%|▌         | 1/20 [00:28<04:28, 14.12s/it]
Task 2, Epoch 2/20 => Loss 1.927, Train_accy 65.98:  10%|█         | 2/20 [00:28<04:14, 14.13s/it]
Task 2, Epoch 3/20 => Loss 1.184, Train_accy 76.14:  10%|█         | 2/20 [00:42<04:14, 14.13s/it]
Task 2, Epoch 3/20 => Loss 1.184, Train_accy 76.14:  15%|█▌        | 3/20 [00:42<03:59, 14.09s/it]
Task 2, Epoch 4/20 => Loss 0.865, Train_accy 79.30:  15%|█▌        | 3/20 [00:56<03:59, 14.09s/it]
Task 2, Epoch 4/20 => Loss 0.865, Train_accy 79.30:  20%|██        | 4/20 [00:56<03:45, 14.08s/it]
Task 2, Epoch 5/20 => Loss 0.690, Train_accy 83.14:  20%|██        | 4/20 [01:10<03:45, 14.08s/it]
Task 2, Epoch 5/20 => Loss 0.690, Train_accy 83.14:  25%|██▌       | 5/20 [01:10<03:31, 14.10s/it]
Task 2, Epoch 6/20 => Loss 0.659, Train_accy 83.57:  25%|██▌       | 5/20 [01:24<03:31, 14.10s/it]
Task 2, Epoch 6/20 => Loss 0.659, Train_accy 83.57:  30%|███       | 6/20 [01:24<03:17, 14.12s/it]
Task 2, Epoch 7/20 => Loss 0.636, Train_accy 83.70:  30%|███       | 6/20 [01:38<03:17, 14.12s/it]
Task 2, Epoch 7/20 => Loss 0.636, Train_accy 83.70:  35%|███▌      | 7/20 [01:38<03:03, 14.11s/it]
Task 2, Epoch 8/20 => Loss 0.649, Train_accy 83.74:  35%|███▌      | 7/20 [01:52<03:03, 14.11s/it]
Task 2, Epoch 8/20 => Loss 0.649, Train_accy 83.74:  40%|████      | 8/20 [01:52<02:49, 14.11s/it]
Task 2, Epoch 9/20 => Loss 0.601, Train_accy 84.81:  40%|████      | 8/20 [02:06<02:49, 14.11s/it]
Task 2, Epoch 9/20 => Loss 0.601, Train_accy 84.81:  45%|████▌     | 9/20 [02:06<02:35, 14.11s/it]
Task 2, Epoch 10/20 => Loss 0.576, Train_accy 85.62:  45%|████▌     | 9/20 [02:21<02:35, 14.11s/it]
Task 2, Epoch 10/20 => Loss 0.576, Train_accy 85.62:  50%|█████     | 10/20 [02:21<02:20, 14.09s/it]
Task 2, Epoch 11/20 => Loss 0.589, Train_accy 84.98:  50%|█████     | 10/20 [02:35<02:20, 14.09s/it]
Task 2, Epoch 11/20 => Loss 0.589, Train_accy 84.98:  55%|█████▌    | 11/20 [02:35<02:06, 14.08s/it]
Task 2, Epoch 12/20 => Loss 0.543, Train_accy 86.43:  55%|█████▌    | 11/20 [02:49<02:06, 14.08s/it]
Task 2, Epoch 12/20 => Loss 0.543, Train_accy 86.43:  60%|██████    | 12/20 [02:49<01:52, 14.09s/it]
Task 2, Epoch 13/20 => Loss 0.555, Train_accy 85.74:  60%|██████    | 12/20 [03:03<01:52, 14.09s/it]
Task 2, Epoch 13/20 => Loss 0.555, Train_accy 85.74:  65%|██████▌   | 13/20 [03:03<01:38, 14.09s/it]
Task 2, Epoch 14/20 => Loss 0.530, Train_accy 86.64:  65%|██████▌   | 13/20 [03:17<01:38, 14.09s/it]
Task 2, Epoch 14/20 => Loss 0.530, Train_accy 86.64:  70%|███████   | 14/20 [03:17<01:24, 14.12s/it]
Task 2, Epoch 15/20 => Loss 0.542, Train_accy 86.38:  70%|███████   | 14/20 [03:31<01:24, 14.12s/it]
Task 2, Epoch 15/20 => Loss 0.542, Train_accy 86.38:  75%|███████▌  | 15/20 [03:31<01:10, 14.12s/it]
Task 2, Epoch 16/20 => Loss 0.548, Train_accy 85.87:  75%|███████▌  | 15/20 [03:45<01:10, 14.12s/it]
Task 2, Epoch 16/20 => Loss 0.548, Train_accy 85.87:  80%|████████  | 16/20 [03:45<00:56, 14.14s/it]
Task 2, Epoch 17/20 => Loss 0.532, Train_accy 86.30:  80%|████████  | 16/20 [03:59<00:56, 14.14s/it]
Task 2, Epoch 17/20 => Loss 0.532, Train_accy 86.30:  85%|████████▌ | 17/20 [03:59<00:42, 14.15s/it]
Task 2, Epoch 18/20 => Loss 0.500, Train_accy 87.41:  85%|████████▌ | 17/20 [04:13<00:42, 14.15s/it]
Task 2, Epoch 18/20 => Loss 0.500, Train_accy 87.41:  90%|█████████ | 18/20 [04:13<00:28, 14.12s/it]
Task 2, Epoch 19/20 => Loss 0.538, Train_accy 86.85:  90%|█████████ | 18/20 [04:28<00:28, 14.12s/it]
Task 2, Epoch 19/20 => Loss 0.538, Train_accy 86.85:  95%|█████████▌| 19/20 [04:28<00:14, 14.11s/it]
Task 2, Epoch 20/20 => Loss 0.507, Train_accy 87.41:  95%|█████████▌| 19/20 [04:42<00:14, 14.11s/it]
Task 2, Epoch 20/20 => Loss 0.507, Train_accy 87.41: 100%|██████████| 20/20 [04:42<00:00, 14.11s/it]
Task 2, Epoch 20/20 => Loss 0.507, Train_accy 87.41: 100%|██████████| 20/20 [04:42<00:00, 14.11s/it]
2024-09-08 08:46:11,560 [ease.py] => Task 2, Epoch 20/20 => Loss 0.507, Train_accy 87.41
2024-09-08 08:46:51,366 [ease.py] => Task correct: 88.06434872859367
2024-09-08 08:46:51,367 [ease.py] => Task acc: 91.43746756616503
2024-09-08 08:46:51,395 [trainer.py] => No NME accuracy.
2024-09-08 08:46:51,395 [trainer.py] => CNN: {'total': 83.96, '00-19': 84.33, '20-39': 84.02, '40-59': 83.5, 'old': 84.18, 'new': 83.5}
2024-09-08 08:46:51,395 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96]
2024-09-08 08:46:51,395 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8]

Average Accuracy (CNN): 87.7
2024-09-08 08:46:51,395 [trainer.py] => Average Accuracy (CNN): 87.7 

2024-09-08 08:46:51,396 [trainer.py] => All params: 86256578
2024-09-08 08:46:51,397 [trainer.py] => Trainable params: 304320
2024-09-08 08:46:51,400 [ease.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.794, Train_accy 34.80:   0%|          | 0/20 [00:13<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.794, Train_accy 34.80:   5%|▌         | 1/20 [00:13<04:21, 13.76s/it]
Task 3, Epoch 2/20 => Loss 1.865, Train_accy 66.20:   5%|▌         | 1/20 [00:27<04:21, 13.76s/it]
Task 3, Epoch 2/20 => Loss 1.865, Train_accy 66.20:  10%|█         | 2/20 [00:27<04:08, 13.81s/it]
Task 3, Epoch 3/20 => Loss 1.181, Train_accy 75.19:  10%|█         | 2/20 [00:41<04:08, 13.81s/it]
Task 3, Epoch 3/20 => Loss 1.181, Train_accy 75.19:  15%|█▌        | 3/20 [00:41<03:55, 13.83s/it]
Task 3, Epoch 4/20 => Loss 0.840, Train_accy 80.94:  15%|█▌        | 3/20 [00:55<03:55, 13.83s/it]
Task 3, Epoch 4/20 => Loss 0.840, Train_accy 80.94:  20%|██        | 4/20 [00:55<03:40, 13.79s/it]
Task 3, Epoch 5/20 => Loss 0.710, Train_accy 82.21:  20%|██        | 4/20 [01:08<03:40, 13.79s/it]
Task 3, Epoch 5/20 => Loss 0.710, Train_accy 82.21:  25%|██▌       | 5/20 [01:08<03:26, 13.79s/it]
Task 3, Epoch 6/20 => Loss 0.627, Train_accy 84.52:  25%|██▌       | 5/20 [01:22<03:26, 13.79s/it]
Task 3, Epoch 6/20 => Loss 0.627, Train_accy 84.52:  30%|███       | 6/20 [01:22<03:13, 13.80s/it]
Task 3, Epoch 7/20 => Loss 0.647, Train_accy 83.82:  30%|███       | 6/20 [01:36<03:13, 13.80s/it]
Task 3, Epoch 7/20 => Loss 0.647, Train_accy 83.82:  35%|███▌      | 7/20 [01:36<02:59, 13.81s/it]
Task 3, Epoch 8/20 => Loss 0.647, Train_accy 83.60:  35%|███▌      | 7/20 [01:50<02:59, 13.81s/it]
Task 3, Epoch 8/20 => Loss 0.647, Train_accy 83.60:  40%|████      | 8/20 [01:50<02:45, 13.80s/it]
Task 3, Epoch 9/20 => Loss 0.586, Train_accy 84.74:  40%|████      | 8/20 [02:04<02:45, 13.80s/it]
Task 3, Epoch 9/20 => Loss 0.586, Train_accy 84.74:  45%|████▌     | 9/20 [02:04<02:31, 13.79s/it]
Task 3, Epoch 10/20 => Loss 0.566, Train_accy 86.04:  45%|████▌     | 9/20 [02:18<02:31, 13.79s/it]
Task 3, Epoch 10/20 => Loss 0.566, Train_accy 86.04:  50%|█████     | 10/20 [02:18<02:18, 13.81s/it]
Task 3, Epoch 11/20 => Loss 0.531, Train_accy 87.35:  50%|█████     | 10/20 [02:31<02:18, 13.81s/it]
Task 3, Epoch 11/20 => Loss 0.531, Train_accy 87.35:  55%|█████▌    | 11/20 [02:31<02:04, 13.81s/it]
Task 3, Epoch 12/20 => Loss 0.539, Train_accy 86.22:  55%|█████▌    | 11/20 [02:45<02:04, 13.81s/it]
Task 3, Epoch 12/20 => Loss 0.539, Train_accy 86.22:  60%|██████    | 12/20 [02:45<01:50, 13.80s/it]
Task 3, Epoch 13/20 => Loss 0.542, Train_accy 86.18:  60%|██████    | 12/20 [02:59<01:50, 13.80s/it]
Task 3, Epoch 13/20 => Loss 0.542, Train_accy 86.18:  65%|██████▌   | 13/20 [02:59<01:36, 13.82s/it]
Task 3, Epoch 14/20 => Loss 0.521, Train_accy 87.13:  65%|██████▌   | 13/20 [03:13<01:36, 13.82s/it]
Task 3, Epoch 14/20 => Loss 0.521, Train_accy 87.13:  70%|███████   | 14/20 [03:13<01:22, 13.80s/it]
Task 3, Epoch 15/20 => Loss 0.554, Train_accy 85.83:  70%|███████   | 14/20 [03:27<01:22, 13.80s/it]
Task 3, Epoch 15/20 => Loss 0.554, Train_accy 85.83:  75%|███████▌  | 15/20 [03:27<01:09, 13.81s/it]
Task 3, Epoch 16/20 => Loss 0.504, Train_accy 87.09:  75%|███████▌  | 15/20 [03:40<01:09, 13.81s/it]
Task 3, Epoch 16/20 => Loss 0.504, Train_accy 87.09:  80%|████████  | 16/20 [03:40<00:55, 13.82s/it]
Task 3, Epoch 17/20 => Loss 0.502, Train_accy 87.79:  80%|████████  | 16/20 [03:54<00:55, 13.82s/it]
Task 3, Epoch 17/20 => Loss 0.502, Train_accy 87.79:  85%|████████▌ | 17/20 [03:54<00:41, 13.84s/it]
Task 3, Epoch 18/20 => Loss 0.494, Train_accy 88.31:  85%|████████▌ | 17/20 [04:08<00:41, 13.84s/it]
Task 3, Epoch 18/20 => Loss 0.494, Train_accy 88.31:  90%|█████████ | 18/20 [04:08<00:27, 13.83s/it]
Task 3, Epoch 19/20 => Loss 0.502, Train_accy 87.35:  90%|█████████ | 18/20 [04:22<00:27, 13.83s/it]
Task 3, Epoch 19/20 => Loss 0.502, Train_accy 87.35:  95%|█████████▌| 19/20 [04:22<00:13, 13.82s/it]
Task 3, Epoch 20/20 => Loss 0.521, Train_accy 87.27:  95%|█████████▌| 19/20 [04:36<00:13, 13.82s/it]
Task 3, Epoch 20/20 => Loss 0.521, Train_accy 87.27: 100%|██████████| 20/20 [04:36<00:00, 13.86s/it]
Task 3, Epoch 20/20 => Loss 0.521, Train_accy 87.27: 100%|██████████| 20/20 [04:36<00:00, 13.82s/it]
2024-09-08 08:51:27,720 [ease.py] => Task 3, Epoch 20/20 => Loss 0.521, Train_accy 87.27
2024-09-08 08:52:26,794 [ease.py] => Task correct: 86.06885508406725
2024-09-08 08:52:26,795 [ease.py] => Task acc: 91.35308246597278
2024-09-08 08:52:26,819 [trainer.py] => No NME accuracy.
2024-09-08 08:52:26,819 [trainer.py] => CNN: {'total': 82.43, '00-19': 82.29, '20-39': 83.23, '40-59': 82.01, '60-79': 82.14, 'old': 82.51, 'new': 82.14}
2024-09-08 08:52:26,819 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96, 82.43]
2024-09-08 08:52:26,819 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8, 94.76]

Average Accuracy (CNN): 86.38
2024-09-08 08:52:26,820 [trainer.py] => Average Accuracy (CNN): 86.38 

2024-09-08 08:52:26,820 [trainer.py] => All params: 86364098
2024-09-08 08:52:26,821 [trainer.py] => Trainable params: 304320
2024-09-08 08:52:26,826 [ease.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.790, Train_accy 32.92:   0%|          | 0/20 [00:13<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.790, Train_accy 32.92:   5%|▌         | 1/20 [00:13<04:08, 13.07s/it]
Task 4, Epoch 2/20 => Loss 1.913, Train_accy 61.33:   5%|▌         | 1/20 [00:26<04:08, 13.07s/it]
Task 4, Epoch 2/20 => Loss 1.913, Train_accy 61.33:  10%|█         | 2/20 [00:26<03:56, 13.17s/it]
Task 4, Epoch 3/20 => Loss 1.248, Train_accy 73.66:  10%|█         | 2/20 [00:39<03:56, 13.17s/it]
Task 4, Epoch 3/20 => Loss 1.248, Train_accy 73.66:  15%|█▌        | 3/20 [00:39<03:43, 13.14s/it]
Task 4, Epoch 4/20 => Loss 0.911, Train_accy 78.48:  15%|█▌        | 3/20 [00:52<03:43, 13.14s/it]
Task 4, Epoch 4/20 => Loss 0.911, Train_accy 78.48:  20%|██        | 4/20 [00:52<03:29, 13.12s/it]
Task 4, Epoch 5/20 => Loss 0.763, Train_accy 81.47:  20%|██        | 4/20 [01:05<03:29, 13.12s/it]
Task 4, Epoch 5/20 => Loss 0.763, Train_accy 81.47:  25%|██▌       | 5/20 [01:05<03:16, 13.10s/it]
Task 4, Epoch 6/20 => Loss 0.669, Train_accy 83.54:  25%|██▌       | 5/20 [01:18<03:16, 13.10s/it]
Task 4, Epoch 6/20 => Loss 0.669, Train_accy 83.54:  30%|███       | 6/20 [01:18<03:03, 13.09s/it]
Task 4, Epoch 7/20 => Loss 0.629, Train_accy 84.41:  30%|███       | 6/20 [01:31<03:03, 13.09s/it]
Task 4, Epoch 7/20 => Loss 0.629, Train_accy 84.41:  35%|███▌      | 7/20 [01:31<02:50, 13.13s/it]
Task 4, Epoch 8/20 => Loss 0.620, Train_accy 83.91:  35%|███▌      | 7/20 [01:44<02:50, 13.13s/it]
Task 4, Epoch 8/20 => Loss 0.620, Train_accy 83.91:  40%|████      | 8/20 [01:44<02:37, 13.11s/it]
Task 4, Epoch 9/20 => Loss 0.589, Train_accy 84.97:  40%|████      | 8/20 [01:58<02:37, 13.11s/it]
Task 4, Epoch 9/20 => Loss 0.589, Train_accy 84.97:  45%|████▌     | 9/20 [01:58<02:24, 13.12s/it]
Task 4, Epoch 10/20 => Loss 0.593, Train_accy 85.10:  45%|████▌     | 9/20 [02:11<02:24, 13.12s/it]
Task 4, Epoch 10/20 => Loss 0.593, Train_accy 85.10:  50%|█████     | 10/20 [02:11<02:10, 13.10s/it]
Task 4, Epoch 11/20 => Loss 0.611, Train_accy 83.86:  50%|█████     | 10/20 [02:24<02:10, 13.10s/it]
Task 4, Epoch 11/20 => Loss 0.611, Train_accy 83.86:  55%|█████▌    | 11/20 [02:24<01:57, 13.11s/it]
Task 4, Epoch 12/20 => Loss 0.567, Train_accy 85.10:  55%|█████▌    | 11/20 [02:37<01:57, 13.11s/it]
Task 4, Epoch 12/20 => Loss 0.567, Train_accy 85.10:  60%|██████    | 12/20 [02:37<01:45, 13.13s/it]
Task 4, Epoch 13/20 => Loss 0.567, Train_accy 85.84:  60%|██████    | 12/20 [02:50<01:45, 13.13s/it]
Task 4, Epoch 13/20 => Loss 0.567, Train_accy 85.84:  65%|██████▌   | 13/20 [02:50<01:31, 13.13s/it]
Task 4, Epoch 14/20 => Loss 0.545, Train_accy 86.11:  65%|██████▌   | 13/20 [03:03<01:31, 13.13s/it]
Task 4, Epoch 14/20 => Loss 0.545, Train_accy 86.11:  70%|███████   | 14/20 [03:03<01:18, 13.13s/it]
Task 4, Epoch 15/20 => Loss 0.546, Train_accy 85.61:  70%|███████   | 14/20 [03:16<01:18, 13.13s/it]
Task 4, Epoch 15/20 => Loss 0.546, Train_accy 85.61:  75%|███████▌  | 15/20 [03:16<01:05, 13.12s/it]
Task 4, Epoch 16/20 => Loss 0.526, Train_accy 86.76:  75%|███████▌  | 15/20 [03:29<01:05, 13.12s/it]
Task 4, Epoch 16/20 => Loss 0.526, Train_accy 86.76:  80%|████████  | 16/20 [03:29<00:52, 13.13s/it]
Task 4, Epoch 17/20 => Loss 0.523, Train_accy 86.39:  80%|████████  | 16/20 [03:43<00:52, 13.13s/it]
Task 4, Epoch 17/20 => Loss 0.523, Train_accy 86.39:  85%|████████▌ | 17/20 [03:43<00:39, 13.12s/it]
Task 4, Epoch 18/20 => Loss 0.534, Train_accy 85.75:  85%|████████▌ | 17/20 [03:56<00:39, 13.12s/it]
Task 4, Epoch 18/20 => Loss 0.534, Train_accy 85.75:  90%|█████████ | 18/20 [03:56<00:26, 13.12s/it]
Task 4, Epoch 19/20 => Loss 0.518, Train_accy 86.44:  90%|█████████ | 18/20 [04:09<00:26, 13.12s/it]
Task 4, Epoch 19/20 => Loss 0.518, Train_accy 86.44:  95%|█████████▌| 19/20 [04:09<00:13, 13.12s/it]
Task 4, Epoch 20/20 => Loss 0.491, Train_accy 87.54:  95%|█████████▌| 19/20 [04:22<00:13, 13.12s/it]
Task 4, Epoch 20/20 => Loss 0.491, Train_accy 87.54: 100%|██████████| 20/20 [04:22<00:00, 13.12s/it]
Task 4, Epoch 20/20 => Loss 0.491, Train_accy 87.54: 100%|██████████| 20/20 [04:22<00:00, 13.12s/it]
2024-09-08 08:56:49,240 [ease.py] => Task 4, Epoch 20/20 => Loss 0.491, Train_accy 87.54
2024-09-08 08:58:07,963 [ease.py] => Task correct: 82.91457286432161
2024-09-08 08:58:07,963 [ease.py] => Task acc: 90.95477386934674
2024-09-08 08:58:07,991 [trainer.py] => No NME accuracy.
2024-09-08 08:58:07,991 [trainer.py] => CNN: {'total': 79.56, '00-19': 80.55, '20-39': 81.96, '40-59': 78.71, '60-79': 79.51, '80-99': 76.18, 'old': 80.22, 'new': 76.18}
2024-09-08 08:58:07,991 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96, 82.43, 79.56]
2024-09-08 08:58:07,991 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8, 94.76, 93.7]

Average Accuracy (CNN): 85.02
2024-09-08 08:58:07,991 [trainer.py] => Average Accuracy (CNN): 85.02 

2024-09-08 08:58:07,992 [trainer.py] => All params: 86502338
2024-09-08 08:58:07,993 [trainer.py] => Trainable params: 304320
2024-09-08 08:58:07,999 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.695, Train_accy 37.22:   0%|          | 0/20 [00:16<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.695, Train_accy 37.22:   5%|▌         | 1/20 [00:16<05:04, 16.03s/it]
Task 5, Epoch 2/20 => Loss 1.592, Train_accy 67.80:   5%|▌         | 1/20 [00:32<05:04, 16.03s/it]
Task 5, Epoch 2/20 => Loss 1.592, Train_accy 67.80:  10%|█         | 2/20 [00:32<04:49, 16.09s/it]
Task 5, Epoch 3/20 => Loss 0.943, Train_accy 78.20:  10%|█         | 2/20 [00:48<04:49, 16.09s/it]
Task 5, Epoch 3/20 => Loss 0.943, Train_accy 78.20:  15%|█▌        | 3/20 [00:48<04:32, 16.02s/it]
Task 5, Epoch 4/20 => Loss 0.727, Train_accy 81.80:  15%|█▌        | 3/20 [01:04<04:32, 16.02s/it]
Task 5, Epoch 4/20 => Loss 0.727, Train_accy 81.80:  20%|██        | 4/20 [01:04<04:15, 15.99s/it]
Task 5, Epoch 5/20 => Loss 0.648, Train_accy 83.60:  20%|██        | 4/20 [01:19<04:15, 15.99s/it]
Task 5, Epoch 5/20 => Loss 0.648, Train_accy 83.60:  25%|██▌       | 5/20 [01:19<03:59, 15.95s/it]
Task 5, Epoch 6/20 => Loss 0.609, Train_accy 84.05:  25%|██▌       | 5/20 [01:35<03:59, 15.95s/it]
Task 5, Epoch 6/20 => Loss 0.609, Train_accy 84.05:  30%|███       | 6/20 [01:35<03:43, 15.96s/it]
Task 5, Epoch 7/20 => Loss 0.562, Train_accy 85.07:  30%|███       | 6/20 [01:51<03:43, 15.96s/it]
Task 5, Epoch 7/20 => Loss 0.562, Train_accy 85.07:  35%|███▌      | 7/20 [01:51<03:27, 15.95s/it]
Task 5, Epoch 8/20 => Loss 0.573, Train_accy 85.22:  35%|███▌      | 7/20 [02:07<03:27, 15.95s/it]
Task 5, Epoch 8/20 => Loss 0.573, Train_accy 85.22:  40%|████      | 8/20 [02:07<03:11, 15.95s/it]
Task 5, Epoch 9/20 => Loss 0.525, Train_accy 86.79:  40%|████      | 8/20 [02:23<03:11, 15.95s/it]
Task 5, Epoch 9/20 => Loss 0.525, Train_accy 86.79:  45%|████▌     | 9/20 [02:23<02:55, 15.97s/it]
Task 5, Epoch 10/20 => Loss 0.543, Train_accy 85.74:  45%|████▌     | 9/20 [02:39<02:55, 15.97s/it]
Task 5, Epoch 10/20 => Loss 0.543, Train_accy 85.74:  50%|█████     | 10/20 [02:39<02:39, 15.99s/it]
Task 5, Epoch 11/20 => Loss 0.537, Train_accy 85.48:  50%|█████     | 10/20 [02:55<02:39, 15.99s/it]
Task 5, Epoch 11/20 => Loss 0.537, Train_accy 85.48:  55%|█████▌    | 11/20 [02:55<02:24, 16.03s/it]
Task 5, Epoch 12/20 => Loss 0.521, Train_accy 86.23:  55%|█████▌    | 11/20 [03:11<02:24, 16.03s/it]
Task 5, Epoch 12/20 => Loss 0.521, Train_accy 86.23:  60%|██████    | 12/20 [03:11<02:08, 16.01s/it]
Task 5, Epoch 13/20 => Loss 0.541, Train_accy 85.93:  60%|██████    | 12/20 [03:27<02:08, 16.01s/it]
Task 5, Epoch 13/20 => Loss 0.541, Train_accy 85.93:  65%|██████▌   | 13/20 [03:27<01:52, 16.01s/it]
Task 5, Epoch 14/20 => Loss 0.496, Train_accy 87.39:  65%|██████▌   | 13/20 [03:43<01:52, 16.01s/it]
Task 5, Epoch 14/20 => Loss 0.496, Train_accy 87.39:  70%|███████   | 14/20 [03:43<01:35, 15.97s/it]
Task 5, Epoch 15/20 => Loss 0.499, Train_accy 87.32:  70%|███████   | 14/20 [03:59<01:35, 15.97s/it]
Task 5, Epoch 15/20 => Loss 0.499, Train_accy 87.32:  75%|███████▌  | 15/20 [03:59<01:19, 15.97s/it]
Task 5, Epoch 16/20 => Loss 0.494, Train_accy 87.32:  75%|███████▌  | 15/20 [04:15<01:19, 15.97s/it]
Task 5, Epoch 16/20 => Loss 0.494, Train_accy 87.32:  80%|████████  | 16/20 [04:15<01:03, 15.96s/it]
Task 5, Epoch 17/20 => Loss 0.475, Train_accy 87.65:  80%|████████  | 16/20 [04:31<01:03, 15.96s/it]
Task 5, Epoch 17/20 => Loss 0.475, Train_accy 87.65:  85%|████████▌ | 17/20 [04:31<00:47, 15.96s/it]
Task 5, Epoch 18/20 => Loss 0.493, Train_accy 86.64:  85%|████████▌ | 17/20 [04:47<00:47, 15.96s/it]
Task 5, Epoch 18/20 => Loss 0.493, Train_accy 86.64:  90%|█████████ | 18/20 [04:47<00:32, 16.01s/it]
Task 5, Epoch 19/20 => Loss 0.482, Train_accy 87.39:  90%|█████████ | 18/20 [05:03<00:32, 16.01s/it]
Task 5, Epoch 19/20 => Loss 0.482, Train_accy 87.39:  95%|█████████▌| 19/20 [05:03<00:16, 16.01s/it]
Task 5, Epoch 20/20 => Loss 0.498, Train_accy 87.02:  95%|█████████▌| 19/20 [05:19<00:16, 16.01s/it]
Task 5, Epoch 20/20 => Loss 0.498, Train_accy 87.02: 100%|██████████| 20/20 [05:19<00:00, 16.01s/it]
Task 5, Epoch 20/20 => Loss 0.498, Train_accy 87.02: 100%|██████████| 20/20 [05:19<00:00, 15.99s/it]
2024-09-08 09:03:27,844 [ease.py] => Task 5, Epoch 20/20 => Loss 0.498, Train_accy 87.02
2024-09-08 09:05:21,778 [ease.py] => Task correct: 81.37174211248285
2024-09-08 09:05:21,778 [ease.py] => Task acc: 91.13854595336076
2024-09-08 09:05:21,801 [trainer.py] => No NME accuracy.
2024-09-08 09:05:21,801 [trainer.py] => CNN: {'total': 78.38, '00-19': 77.07, '20-39': 81.17, '40-59': 77.23, '60-79': 76.53, '80-99': 73.92, '100-119': 83.03, 'old': 77.35, 'new': 83.03}
2024-09-08 09:05:21,801 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96, 82.43, 79.56, 78.38]
2024-09-08 09:05:21,801 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8, 94.76, 93.7, 93.14]

Average Accuracy (CNN): 83.91
2024-09-08 09:05:21,801 [trainer.py] => Average Accuracy (CNN): 83.91 

2024-09-08 09:05:21,802 [trainer.py] => All params: 86671298
2024-09-08 09:05:21,803 [trainer.py] => Trainable params: 304320
2024-09-08 09:05:21,810 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.770, Train_accy 36.02:   0%|          | 0/20 [00:12<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.770, Train_accy 36.02:   5%|▌         | 1/20 [00:12<04:03, 12.80s/it]
Task 6, Epoch 2/20 => Loss 1.829, Train_accy 64.92:   5%|▌         | 1/20 [00:25<04:03, 12.80s/it]
Task 6, Epoch 2/20 => Loss 1.829, Train_accy 64.92:  10%|█         | 2/20 [00:25<03:50, 12.80s/it]
Task 6, Epoch 3/20 => Loss 1.136, Train_accy 78.44:  10%|█         | 2/20 [00:38<03:50, 12.80s/it]
Task 6, Epoch 3/20 => Loss 1.136, Train_accy 78.44:  15%|█▌        | 3/20 [00:38<03:37, 12.79s/it]
Task 6, Epoch 4/20 => Loss 0.825, Train_accy 83.05:  15%|█▌        | 3/20 [00:51<03:37, 12.79s/it]
Task 6, Epoch 4/20 => Loss 0.825, Train_accy 83.05:  20%|██        | 4/20 [00:51<03:25, 12.84s/it]
Task 6, Epoch 5/20 => Loss 0.691, Train_accy 82.91:  20%|██        | 4/20 [01:04<03:25, 12.84s/it]
Task 6, Epoch 5/20 => Loss 0.691, Train_accy 82.91:  25%|██▌       | 5/20 [01:04<03:12, 12.83s/it]
Task 6, Epoch 6/20 => Loss 0.611, Train_accy 85.64:  25%|██▌       | 5/20 [01:16<03:12, 12.83s/it]
Task 6, Epoch 6/20 => Loss 0.611, Train_accy 85.64:  30%|███       | 6/20 [01:16<02:59, 12.84s/it]
Task 6, Epoch 7/20 => Loss 0.596, Train_accy 85.40:  30%|███       | 6/20 [01:29<02:59, 12.84s/it]
Task 6, Epoch 7/20 => Loss 0.596, Train_accy 85.40:  35%|███▌      | 7/20 [01:29<02:46, 12.83s/it]
Task 6, Epoch 8/20 => Loss 0.552, Train_accy 86.21:  35%|███▌      | 7/20 [01:42<02:46, 12.83s/it]
Task 6, Epoch 8/20 => Loss 0.552, Train_accy 86.21:  40%|████      | 8/20 [01:42<02:33, 12.83s/it]
Task 6, Epoch 9/20 => Loss 0.509, Train_accy 88.14:  40%|████      | 8/20 [01:55<02:33, 12.83s/it]
Task 6, Epoch 9/20 => Loss 0.509, Train_accy 88.14:  45%|████▌     | 9/20 [01:55<02:21, 12.83s/it]
Task 6, Epoch 10/20 => Loss 0.522, Train_accy 86.91:  45%|████▌     | 9/20 [02:08<02:21, 12.83s/it]
Task 6, Epoch 10/20 => Loss 0.522, Train_accy 86.91:  50%|█████     | 10/20 [02:08<02:08, 12.84s/it]
Task 6, Epoch 11/20 => Loss 0.518, Train_accy 87.57:  50%|█████     | 10/20 [02:21<02:08, 12.84s/it]
Task 6, Epoch 11/20 => Loss 0.518, Train_accy 87.57:  55%|█████▌    | 11/20 [02:21<01:55, 12.86s/it]
Task 6, Epoch 12/20 => Loss 0.508, Train_accy 87.90:  55%|█████▌    | 11/20 [02:34<01:55, 12.86s/it]
Task 6, Epoch 12/20 => Loss 0.508, Train_accy 87.90:  60%|██████    | 12/20 [02:34<01:43, 12.88s/it]
Task 6, Epoch 13/20 => Loss 0.504, Train_accy 88.09:  60%|██████    | 12/20 [02:47<01:43, 12.88s/it]
Task 6, Epoch 13/20 => Loss 0.504, Train_accy 88.09:  65%|██████▌   | 13/20 [02:47<01:30, 12.89s/it]
Task 6, Epoch 14/20 => Loss 0.479, Train_accy 88.09:  65%|██████▌   | 13/20 [02:59<01:30, 12.89s/it]
Task 6, Epoch 14/20 => Loss 0.479, Train_accy 88.09:  70%|███████   | 14/20 [02:59<01:17, 12.88s/it]
Task 6, Epoch 15/20 => Loss 0.474, Train_accy 88.37:  70%|███████   | 14/20 [03:12<01:17, 12.88s/it]
Task 6, Epoch 15/20 => Loss 0.474, Train_accy 88.37:  75%|███████▌  | 15/20 [03:12<01:04, 12.85s/it]
Task 6, Epoch 16/20 => Loss 0.478, Train_accy 87.38:  75%|███████▌  | 15/20 [03:25<01:04, 12.85s/it]
Task 6, Epoch 16/20 => Loss 0.478, Train_accy 87.38:  80%|████████  | 16/20 [03:25<00:51, 12.83s/it]
Task 6, Epoch 17/20 => Loss 0.489, Train_accy 87.62:  80%|████████  | 16/20 [03:38<00:51, 12.83s/it]
Task 6, Epoch 17/20 => Loss 0.489, Train_accy 87.62:  85%|████████▌ | 17/20 [03:38<00:38, 12.83s/it]
Task 6, Epoch 18/20 => Loss 0.494, Train_accy 87.90:  85%|████████▌ | 17/20 [03:51<00:38, 12.83s/it]
Task 6, Epoch 18/20 => Loss 0.494, Train_accy 87.90:  90%|█████████ | 18/20 [03:51<00:25, 12.84s/it]
Task 6, Epoch 19/20 => Loss 0.480, Train_accy 88.51:  90%|█████████ | 18/20 [04:03<00:25, 12.84s/it]
Task 6, Epoch 19/20 => Loss 0.480, Train_accy 88.51:  95%|█████████▌| 19/20 [04:03<00:12, 12.81s/it]
Task 6, Epoch 20/20 => Loss 0.466, Train_accy 88.79:  95%|█████████▌| 19/20 [04:16<00:12, 12.81s/it]
Task 6, Epoch 20/20 => Loss 0.466, Train_accy 88.79: 100%|██████████| 20/20 [04:16<00:00, 12.78s/it]
Task 6, Epoch 20/20 => Loss 0.466, Train_accy 88.79: 100%|██████████| 20/20 [04:16<00:00, 12.83s/it]
2024-09-08 09:09:38,436 [ease.py] => Task 6, Epoch 20/20 => Loss 0.466, Train_accy 88.79
2024-09-08 09:11:50,740 [ease.py] => Task correct: 80.44613194114855
2024-09-08 09:11:50,741 [ease.py] => Task acc: 90.98243948742288
2024-09-08 09:11:50,762 [trainer.py] => No NME accuracy.
2024-09-08 09:11:50,762 [trainer.py] => CNN: {'total': 77.57, '00-19': 76.34, '20-39': 80.22, '40-59': 76.57, '60-79': 75.66, '80-99': 72.48, '100-119': 82.42, '120-139': 77.86, 'old': 77.53, 'new': 77.86}
2024-09-08 09:11:50,762 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96, 82.43, 79.56, 78.38, 77.57]
2024-09-08 09:11:50,762 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8, 94.76, 93.7, 93.14, 92.48]

Average Accuracy (CNN): 83.01
2024-09-08 09:11:50,762 [trainer.py] => Average Accuracy (CNN): 83.01 

2024-09-08 09:11:50,763 [trainer.py] => All params: 86870978
2024-09-08 09:11:50,764 [trainer.py] => Trainable params: 304320
2024-09-08 09:11:50,773 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.632, Train_accy 37.54:   0%|          | 0/20 [00:17<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.632, Train_accy 37.54:   5%|▌         | 1/20 [00:17<05:24, 17.09s/it]
Task 7, Epoch 2/20 => Loss 1.513, Train_accy 70.06:   5%|▌         | 1/20 [00:33<05:24, 17.09s/it]
Task 7, Epoch 2/20 => Loss 1.513, Train_accy 70.06:  10%|█         | 2/20 [00:33<05:04, 16.93s/it]
Task 7, Epoch 3/20 => Loss 0.917, Train_accy 79.69:  10%|█         | 2/20 [00:50<05:04, 16.93s/it]
Task 7, Epoch 3/20 => Loss 0.917, Train_accy 79.69:  15%|█▌        | 3/20 [00:50<04:47, 16.90s/it]
Task 7, Epoch 4/20 => Loss 0.726, Train_accy 82.88:  15%|█▌        | 3/20 [01:07<04:47, 16.90s/it]
Task 7, Epoch 4/20 => Loss 0.726, Train_accy 82.88:  20%|██        | 4/20 [01:07<04:30, 16.90s/it]
Task 7, Epoch 5/20 => Loss 0.619, Train_accy 85.12:  20%|██        | 4/20 [01:24<04:30, 16.90s/it]
Task 7, Epoch 5/20 => Loss 0.619, Train_accy 85.12:  25%|██▌       | 5/20 [01:24<04:13, 16.90s/it]
Task 7, Epoch 6/20 => Loss 0.604, Train_accy 85.05:  25%|██▌       | 5/20 [01:41<04:13, 16.90s/it]
Task 7, Epoch 6/20 => Loss 0.604, Train_accy 85.05:  30%|███       | 6/20 [01:41<03:56, 16.89s/it]
Task 7, Epoch 7/20 => Loss 0.550, Train_accy 86.58:  30%|███       | 6/20 [01:58<03:56, 16.89s/it]
Task 7, Epoch 7/20 => Loss 0.550, Train_accy 86.58:  35%|███▌      | 7/20 [01:58<03:39, 16.88s/it]
Task 7, Epoch 8/20 => Loss 0.557, Train_accy 86.29:  35%|███▌      | 7/20 [02:15<03:39, 16.88s/it]
Task 7, Epoch 8/20 => Loss 0.557, Train_accy 86.29:  40%|████      | 8/20 [02:15<03:22, 16.87s/it]
Task 7, Epoch 9/20 => Loss 0.567, Train_accy 85.97:  40%|████      | 8/20 [02:32<03:22, 16.87s/it]
Task 7, Epoch 9/20 => Loss 0.567, Train_accy 85.97:  45%|████▌     | 9/20 [02:32<03:05, 16.87s/it]
Task 7, Epoch 10/20 => Loss 0.545, Train_accy 86.40:  45%|████▌     | 9/20 [02:48<03:05, 16.87s/it]
Task 7, Epoch 10/20 => Loss 0.545, Train_accy 86.40:  50%|█████     | 10/20 [02:48<02:48, 16.85s/it]
Task 7, Epoch 11/20 => Loss 0.537, Train_accy 86.75:  50%|█████     | 10/20 [03:05<02:48, 16.85s/it]
Task 7, Epoch 11/20 => Loss 0.537, Train_accy 86.75:  55%|█████▌    | 11/20 [03:05<02:31, 16.84s/it]
Task 7, Epoch 12/20 => Loss 0.524, Train_accy 86.97:  55%|█████▌    | 11/20 [03:22<02:31, 16.84s/it]
Task 7, Epoch 12/20 => Loss 0.524, Train_accy 86.97:  60%|██████    | 12/20 [03:22<02:14, 16.82s/it]
Task 7, Epoch 13/20 => Loss 0.509, Train_accy 87.64:  60%|██████    | 12/20 [03:39<02:14, 16.82s/it]
Task 7, Epoch 13/20 => Loss 0.509, Train_accy 87.64:  65%|██████▌   | 13/20 [03:39<01:57, 16.83s/it]
Task 7, Epoch 14/20 => Loss 0.521, Train_accy 86.90:  65%|██████▌   | 13/20 [03:56<01:57, 16.83s/it]
Task 7, Epoch 14/20 => Loss 0.521, Train_accy 86.90:  70%|███████   | 14/20 [03:56<01:40, 16.81s/it]
Task 7, Epoch 15/20 => Loss 0.493, Train_accy 87.61:  70%|███████   | 14/20 [04:12<01:40, 16.81s/it]
Task 7, Epoch 15/20 => Loss 0.493, Train_accy 87.61:  75%|███████▌  | 15/20 [04:12<01:24, 16.81s/it]
Task 7, Epoch 16/20 => Loss 0.491, Train_accy 88.03:  75%|███████▌  | 15/20 [04:29<01:24, 16.81s/it]
Task 7, Epoch 16/20 => Loss 0.491, Train_accy 88.03:  80%|████████  | 16/20 [04:29<01:07, 16.81s/it]
Task 7, Epoch 17/20 => Loss 0.491, Train_accy 87.93:  80%|████████  | 16/20 [04:46<01:07, 16.81s/it]
Task 7, Epoch 17/20 => Loss 0.491, Train_accy 87.93:  85%|████████▌ | 17/20 [04:46<00:50, 16.80s/it]
Task 7, Epoch 18/20 => Loss 0.486, Train_accy 87.22:  85%|████████▌ | 17/20 [05:03<00:50, 16.80s/it]
Task 7, Epoch 18/20 => Loss 0.486, Train_accy 87.22:  90%|█████████ | 18/20 [05:03<00:33, 16.90s/it]
Task 7, Epoch 19/20 => Loss 0.487, Train_accy 87.64:  90%|█████████ | 18/20 [05:20<00:33, 16.90s/it]
Task 7, Epoch 19/20 => Loss 0.487, Train_accy 87.64:  95%|█████████▌| 19/20 [05:20<00:16, 16.87s/it]
Task 7, Epoch 20/20 => Loss 0.471, Train_accy 88.17:  95%|█████████▌| 19/20 [05:37<00:16, 16.87s/it]
Task 7, Epoch 20/20 => Loss 0.471, Train_accy 88.17: 100%|██████████| 20/20 [05:37<00:00, 16.86s/it]
Task 7, Epoch 20/20 => Loss 0.471, Train_accy 88.17: 100%|██████████| 20/20 [05:37<00:00, 16.86s/it]
2024-09-08 09:17:27,991 [ease.py] => Task 7, Epoch 20/20 => Loss 0.471, Train_accy 88.17
2024-09-08 09:20:33,570 [ease.py] => Task correct: 79.46591138984422
2024-09-08 09:20:33,571 [ease.py] => Task acc: 91.11875379324297
2024-09-08 09:20:33,594 [trainer.py] => No NME accuracy.
2024-09-08 09:20:33,594 [trainer.py] => CNN: {'total': 77.02, '00-19': 74.31, '20-39': 79.11, '40-59': 75.41, '60-79': 74.61, '80-99': 71.66, '100-119': 81.06, '120-139': 76.8, '140-159': 81.07, 'old': 76.32, 'new': 81.07}
2024-09-08 09:20:33,594 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96, 82.43, 79.56, 78.38, 77.57, 77.02]
2024-09-08 09:20:33,594 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8, 94.76, 93.7, 93.14, 92.48, 91.95]

Average Accuracy (CNN): 82.26
2024-09-08 09:20:33,594 [trainer.py] => Average Accuracy (CNN): 82.26 

2024-09-08 09:20:33,595 [trainer.py] => All params: 87101378
2024-09-08 09:20:33,596 [trainer.py] => Trainable params: 304320
2024-09-08 09:20:33,606 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.868, Train_accy 27.05:   0%|          | 0/20 [00:11<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.868, Train_accy 27.05:   5%|▌         | 1/20 [00:11<03:42, 11.72s/it]
Task 8, Epoch 2/20 => Loss 2.149, Train_accy 57.65:   5%|▌         | 1/20 [00:23<03:42, 11.72s/it]
Task 8, Epoch 2/20 => Loss 2.149, Train_accy 57.65:  10%|█         | 2/20 [00:23<03:31, 11.77s/it]
Task 8, Epoch 3/20 => Loss 1.426, Train_accy 73.00:  10%|█         | 2/20 [00:35<03:31, 11.77s/it]
Task 8, Epoch 3/20 => Loss 1.426, Train_accy 73.00:  15%|█▌        | 3/20 [00:35<03:20, 11.81s/it]
Task 8, Epoch 4/20 => Loss 1.023, Train_accy 77.46:  15%|█▌        | 3/20 [00:47<03:20, 11.81s/it]
Task 8, Epoch 4/20 => Loss 1.023, Train_accy 77.46:  20%|██        | 4/20 [00:47<03:09, 11.83s/it]
Task 8, Epoch 5/20 => Loss 0.837, Train_accy 80.08:  20%|██        | 4/20 [00:59<03:09, 11.83s/it]
Task 8, Epoch 5/20 => Loss 0.837, Train_accy 80.08:  25%|██▌       | 5/20 [00:59<02:57, 11.81s/it]
Task 8, Epoch 6/20 => Loss 0.744, Train_accy 81.78:  25%|██▌       | 5/20 [01:10<02:57, 11.81s/it]
Task 8, Epoch 6/20 => Loss 0.744, Train_accy 81.78:  30%|███       | 6/20 [01:10<02:44, 11.79s/it]
Task 8, Epoch 7/20 => Loss 0.683, Train_accy 83.93:  30%|███       | 6/20 [01:22<02:44, 11.79s/it]
Task 8, Epoch 7/20 => Loss 0.683, Train_accy 83.93:  35%|███▌      | 7/20 [01:22<02:33, 11.80s/it]
Task 8, Epoch 8/20 => Loss 0.676, Train_accy 82.91:  35%|███▌      | 7/20 [01:34<02:33, 11.80s/it]
Task 8, Epoch 8/20 => Loss 0.676, Train_accy 82.91:  40%|████      | 8/20 [01:34<02:21, 11.79s/it]
Task 8, Epoch 9/20 => Loss 0.625, Train_accy 84.70:  40%|████      | 8/20 [01:46<02:21, 11.79s/it]
Task 8, Epoch 9/20 => Loss 0.625, Train_accy 84.70:  45%|████▌     | 9/20 [01:46<02:09, 11.80s/it]
Task 8, Epoch 10/20 => Loss 0.646, Train_accy 84.14:  45%|████▌     | 9/20 [01:58<02:09, 11.80s/it]
Task 8, Epoch 10/20 => Loss 0.646, Train_accy 84.14:  50%|█████     | 10/20 [01:58<01:58, 11.81s/it]
Task 8, Epoch 11/20 => Loss 0.598, Train_accy 85.22:  50%|█████     | 10/20 [02:09<01:58, 11.81s/it]
Task 8, Epoch 11/20 => Loss 0.598, Train_accy 85.22:  55%|█████▌    | 11/20 [02:09<01:46, 11.80s/it]
Task 8, Epoch 12/20 => Loss 0.609, Train_accy 85.32:  55%|█████▌    | 11/20 [02:21<01:46, 11.80s/it]
Task 8, Epoch 12/20 => Loss 0.609, Train_accy 85.32:  60%|██████    | 12/20 [02:21<01:34, 11.81s/it]
Task 8, Epoch 13/20 => Loss 0.591, Train_accy 85.16:  60%|██████    | 12/20 [02:33<01:34, 11.81s/it]
Task 8, Epoch 13/20 => Loss 0.591, Train_accy 85.16:  65%|██████▌   | 13/20 [02:33<01:22, 11.82s/it]
Task 8, Epoch 14/20 => Loss 0.568, Train_accy 85.47:  65%|██████▌   | 13/20 [02:45<01:22, 11.82s/it]
Task 8, Epoch 14/20 => Loss 0.568, Train_accy 85.47:  70%|███████   | 14/20 [02:45<01:11, 11.84s/it]
Task 8, Epoch 15/20 => Loss 0.589, Train_accy 85.47:  70%|███████   | 14/20 [02:57<01:11, 11.84s/it]
Task 8, Epoch 15/20 => Loss 0.589, Train_accy 85.47:  75%|███████▌  | 15/20 [02:57<00:59, 11.82s/it]
Task 8, Epoch 16/20 => Loss 0.572, Train_accy 85.99:  75%|███████▌  | 15/20 [03:08<00:59, 11.82s/it]
Task 8, Epoch 16/20 => Loss 0.572, Train_accy 85.99:  80%|████████  | 16/20 [03:08<00:47, 11.79s/it]
Task 8, Epoch 17/20 => Loss 0.571, Train_accy 86.76:  80%|████████  | 16/20 [03:20<00:47, 11.79s/it]
Task 8, Epoch 17/20 => Loss 0.571, Train_accy 86.76:  85%|████████▌ | 17/20 [03:20<00:35, 11.78s/it]
Task 8, Epoch 18/20 => Loss 0.573, Train_accy 85.63:  85%|████████▌ | 17/20 [03:32<00:35, 11.78s/it]
Task 8, Epoch 18/20 => Loss 0.573, Train_accy 85.63:  90%|█████████ | 18/20 [03:32<00:23, 11.80s/it]
Task 8, Epoch 19/20 => Loss 0.546, Train_accy 86.34:  90%|█████████ | 18/20 [03:44<00:23, 11.80s/it]
Task 8, Epoch 19/20 => Loss 0.546, Train_accy 86.34:  95%|█████████▌| 19/20 [03:44<00:11, 11.85s/it]
Task 8, Epoch 20/20 => Loss 0.560, Train_accy 86.09:  95%|█████████▌| 19/20 [03:56<00:11, 11.85s/it]
Task 8, Epoch 20/20 => Loss 0.560, Train_accy 86.09: 100%|██████████| 20/20 [03:56<00:00, 11.83s/it]
Task 8, Epoch 20/20 => Loss 0.560, Train_accy 86.09: 100%|██████████| 20/20 [03:56<00:00, 11.81s/it]
2024-09-08 09:24:29,801 [ease.py] => Task 8, Epoch 20/20 => Loss 0.560, Train_accy 86.09
2024-09-08 09:27:46,632 [ease.py] => Task correct: 78.14056447149973
2024-09-08 09:27:46,633 [ease.py] => Task acc: 90.92418372993913
2024-09-08 09:27:46,657 [trainer.py] => No NME accuracy.
2024-09-08 09:27:46,657 [trainer.py] => CNN: {'total': 75.98, '00-19': 73.88, '20-39': 78.64, '40-59': 74.26, '60-79': 74.08, '80-99': 69.2, '100-119': 80.15, '120-139': 76.1, '140-159': 79.56, '160-179': 75.52, 'old': 76.03, 'new': 75.52}
2024-09-08 09:27:46,657 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96, 82.43, 79.56, 78.38, 77.57, 77.02, 75.98]
2024-09-08 09:27:46,657 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8, 94.76, 93.7, 93.14, 92.48, 91.95, 91.15]

Average Accuracy (CNN): 81.56
2024-09-08 09:27:46,657 [trainer.py] => Average Accuracy (CNN): 81.56 

2024-09-08 09:27:46,658 [trainer.py] => All params: 87362498
2024-09-08 09:27:46,658 [trainer.py] => Trainable params: 304320
2024-09-08 09:27:46,671 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.731, Train_accy 38.90:   0%|          | 0/20 [00:13<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.731, Train_accy 38.90:   5%|▌         | 1/20 [00:13<04:21, 13.75s/it]
Task 9, Epoch 2/20 => Loss 1.694, Train_accy 67.89:   5%|▌         | 1/20 [00:27<04:21, 13.75s/it]
Task 9, Epoch 2/20 => Loss 1.694, Train_accy 67.89:  10%|█         | 2/20 [00:27<04:06, 13.72s/it]
Task 9, Epoch 3/20 => Loss 1.060, Train_accy 77.97:  10%|█         | 2/20 [00:41<04:06, 13.72s/it]
Task 9, Epoch 3/20 => Loss 1.060, Train_accy 77.97:  15%|█▌        | 3/20 [00:41<03:53, 13.71s/it]
Task 9, Epoch 4/20 => Loss 0.785, Train_accy 81.59:  15%|█▌        | 3/20 [00:54<03:53, 13.71s/it]
Task 9, Epoch 4/20 => Loss 0.785, Train_accy 81.59:  20%|██        | 4/20 [00:54<03:39, 13.72s/it]
Task 9, Epoch 5/20 => Loss 0.670, Train_accy 83.26:  20%|██        | 4/20 [01:08<03:39, 13.72s/it]
Task 9, Epoch 5/20 => Loss 0.670, Train_accy 83.26:  25%|██▌       | 5/20 [01:08<03:25, 13.73s/it]
Task 9, Epoch 6/20 => Loss 0.647, Train_accy 83.88:  25%|██▌       | 5/20 [01:22<03:25, 13.73s/it]
Task 9, Epoch 6/20 => Loss 0.647, Train_accy 83.88:  30%|███       | 6/20 [01:22<03:12, 13.73s/it]
Task 9, Epoch 7/20 => Loss 0.581, Train_accy 85.86:  30%|███       | 6/20 [01:36<03:12, 13.73s/it]
Task 9, Epoch 7/20 => Loss 0.581, Train_accy 85.86:  35%|███▌      | 7/20 [01:36<02:58, 13.71s/it]
Task 9, Epoch 8/20 => Loss 0.577, Train_accy 85.81:  35%|███▌      | 7/20 [01:49<02:58, 13.71s/it]
Task 9, Epoch 8/20 => Loss 0.577, Train_accy 85.81:  40%|████      | 8/20 [01:49<02:44, 13.69s/it]
Task 9, Epoch 9/20 => Loss 0.565, Train_accy 85.42:  40%|████      | 8/20 [02:03<02:44, 13.69s/it]
Task 9, Epoch 9/20 => Loss 0.565, Train_accy 85.42:  45%|████▌     | 9/20 [02:03<02:30, 13.69s/it]
Task 9, Epoch 10/20 => Loss 0.552, Train_accy 86.39:  45%|████▌     | 9/20 [02:17<02:30, 13.69s/it]
Task 9, Epoch 10/20 => Loss 0.552, Train_accy 86.39:  50%|█████     | 10/20 [02:17<02:16, 13.68s/it]
Task 9, Epoch 11/20 => Loss 0.548, Train_accy 85.81:  50%|█████     | 10/20 [02:30<02:16, 13.68s/it]
Task 9, Epoch 11/20 => Loss 0.548, Train_accy 85.81:  55%|█████▌    | 11/20 [02:30<02:03, 13.68s/it]
Task 9, Epoch 12/20 => Loss 0.542, Train_accy 86.12:  55%|█████▌    | 11/20 [02:44<02:03, 13.68s/it]
Task 9, Epoch 12/20 => Loss 0.542, Train_accy 86.12:  60%|██████    | 12/20 [02:44<01:49, 13.67s/it]
Task 9, Epoch 13/20 => Loss 0.504, Train_accy 88.06:  60%|██████    | 12/20 [02:58<01:49, 13.67s/it]
Task 9, Epoch 13/20 => Loss 0.504, Train_accy 88.06:  65%|██████▌   | 13/20 [02:58<01:35, 13.68s/it]
Task 9, Epoch 14/20 => Loss 0.533, Train_accy 86.74:  65%|██████▌   | 13/20 [03:11<01:35, 13.68s/it]
Task 9, Epoch 14/20 => Loss 0.533, Train_accy 86.74:  70%|███████   | 14/20 [03:11<01:22, 13.70s/it]
Task 9, Epoch 15/20 => Loss 0.506, Train_accy 87.00:  70%|███████   | 14/20 [03:25<01:22, 13.70s/it]
Task 9, Epoch 15/20 => Loss 0.506, Train_accy 87.00:  75%|███████▌  | 15/20 [03:25<01:08, 13.68s/it]
Task 9, Epoch 16/20 => Loss 0.507, Train_accy 86.87:  75%|███████▌  | 15/20 [03:39<01:08, 13.68s/it]
Task 9, Epoch 16/20 => Loss 0.507, Train_accy 86.87:  80%|████████  | 16/20 [03:39<00:54, 13.69s/it]
Task 9, Epoch 17/20 => Loss 0.495, Train_accy 87.00:  80%|████████  | 16/20 [03:52<00:54, 13.69s/it]
Task 9, Epoch 17/20 => Loss 0.495, Train_accy 87.00:  85%|████████▌ | 17/20 [03:52<00:41, 13.68s/it]
Task 9, Epoch 18/20 => Loss 0.503, Train_accy 87.27:  85%|████████▌ | 17/20 [04:06<00:41, 13.68s/it]
Task 9, Epoch 18/20 => Loss 0.503, Train_accy 87.27:  90%|█████████ | 18/20 [04:06<00:27, 13.67s/it]
Task 9, Epoch 19/20 => Loss 0.492, Train_accy 87.62:  90%|█████████ | 18/20 [04:20<00:27, 13.67s/it]
Task 9, Epoch 19/20 => Loss 0.492, Train_accy 87.62:  95%|█████████▌| 19/20 [04:20<00:13, 13.67s/it]
Task 9, Epoch 20/20 => Loss 0.488, Train_accy 88.11:  95%|█████████▌| 19/20 [04:33<00:13, 13.67s/it]
Task 9, Epoch 20/20 => Loss 0.488, Train_accy 88.11: 100%|██████████| 20/20 [04:33<00:00, 13.65s/it]
Task 9, Epoch 20/20 => Loss 0.488, Train_accy 88.11: 100%|██████████| 20/20 [04:33<00:00, 13.69s/it]
2024-09-08 09:32:20,404 [ease.py] => Task 9, Epoch 20/20 => Loss 0.488, Train_accy 88.11
2024-09-08 09:36:25,289 [ease.py] => Task correct: 77.21666666666667
2024-09-08 09:36:25,290 [ease.py] => Task acc: 91.0
2024-09-08 09:36:25,310 [trainer.py] => No NME accuracy.
2024-09-08 09:36:25,310 [trainer.py] => CNN: {'total': 75.2, '00-19': 73.88, '20-39': 77.06, '40-59': 72.61, '60-79': 72.5, '80-99': 67.56, '100-119': 79.55, '120-139': 75.4, '140-159': 79.15, '160-179': 75.1, '180-199': 76.51, 'old': 75.06, 'new': 76.51}
2024-09-08 09:36:25,311 [trainer.py] => CNN top1 curve: [92.16, 86.98, 83.96, 82.43, 79.56, 78.38, 77.57, 77.02, 75.98, 75.2]
2024-09-08 09:36:25,311 [trainer.py] => CNN top5 curve: [98.69, 97.43, 95.8, 94.76, 93.7, 93.14, 92.48, 91.95, 91.15, 90.78]

Average Accuracy (CNN): 80.92
2024-09-08 09:36:25,311 [trainer.py] => Average Accuracy (CNN): 80.92 

Accuracy Matrix (CNN):
[[92.16 86.36 84.33 82.29 80.55 77.07 76.34 74.31 73.88 73.88]
 [ 0.   87.66 84.02 83.23 81.96 81.17 80.22 79.11 78.64 77.06]
 [ 0.    0.   83.5  82.01 78.71 77.23 76.57 75.41 74.26 72.61]
 [ 0.    0.    0.   82.14 79.51 76.53 75.66 74.61 74.08 72.5 ]
 [ 0.    0.    0.    0.   76.18 73.92 72.48 71.66 69.2  67.56]
 [ 0.    0.    0.    0.    0.   83.03 82.42 81.06 80.15 79.55]
 [ 0.    0.    0.    0.    0.    0.   77.86 76.8  76.1  75.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.   81.07 79.56 79.15]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   75.52 75.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   76.51]]
2024-09-08 09:36:25,312 [trainer.py] => Forgetting (CNN): 7.367777777777777
2024-09-08 09:36:28,105 [trainer.py] => config: ./exps/ease_inr_B0_Inc20.json
2024-09-08 09:36:28,105 [trainer.py] => prefix:  
2024-09-08 09:36:28,105 [trainer.py] => dataset: imagenetr
2024-09-08 09:36:28,105 [trainer.py] => memory_size: 0
2024-09-08 09:36:28,105 [trainer.py] => memory_per_class: 0
2024-09-08 09:36:28,105 [trainer.py] => fixed_memory: False
2024-09-08 09:36:28,105 [trainer.py] => shuffle: True
2024-09-08 09:36:28,105 [trainer.py] => init_cls: 10
2024-09-08 09:36:28,105 [trainer.py] => increment: 10
2024-09-08 09:36:28,105 [trainer.py] => model_name: ease
2024-09-08 09:36:28,105 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-08 09:36:28,105 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 09:36:28,105 [trainer.py] => seed: 1993
2024-09-08 09:36:28,106 [trainer.py] => init_epochs: 20
2024-09-08 09:36:28,106 [trainer.py] => init_lr: 0.05
2024-09-08 09:36:28,106 [trainer.py] => later_epochs: 20
2024-09-08 09:36:28,106 [trainer.py] => later_lr: 0.05
2024-09-08 09:36:28,106 [trainer.py] => batch_size: 48
2024-09-08 09:36:28,106 [trainer.py] => weight_decay: 0.005
2024-09-08 09:36:28,106 [trainer.py] => min_lr: 0
2024-09-08 09:36:28,106 [trainer.py] => optimizer: sgd
2024-09-08 09:36:28,106 [trainer.py] => scheduler: cosine
2024-09-08 09:36:28,106 [trainer.py] => pretrained: True
2024-09-08 09:36:28,106 [trainer.py] => vpt_type: Deep
2024-09-08 09:36:28,106 [trainer.py] => prompt_token_num: 5
2024-09-08 09:36:28,106 [trainer.py] => ffn_num: 16
2024-09-08 09:36:28,106 [trainer.py] => use_diagonal: False
2024-09-08 09:36:28,106 [trainer.py] => recalc_sim: True
2024-09-08 09:36:28,106 [trainer.py] => alpha: 0.1
2024-09-08 09:36:28,106 [trainer.py] => use_init_ptm: False
2024-09-08 09:36:28,106 [trainer.py] => beta: 0
2024-09-08 09:36:28,106 [trainer.py] => use_old_data: False
2024-09-08 09:36:28,106 [trainer.py] => use_reweight: True
2024-09-08 09:36:28,106 [trainer.py] => moni_adam: False
2024-09-08 09:36:28,106 [trainer.py] => adapter_num: -1
2024-09-08 09:36:28,190 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-08 09:36:31,148 [trainer.py] => All params: 86102976
2024-09-08 09:36:31,149 [trainer.py] => Trainable params: 304320
2024-09-08 09:36:31,156 [ease.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.197, Train_accy 48.10:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.197, Train_accy 48.10:   5%|▌         | 1/20 [00:08<02:35,  8.19s/it]
Task 0, Epoch 2/20 => Loss 1.696, Train_accy 71.84:   5%|▌         | 1/20 [00:16<02:35,  8.19s/it]
Task 0, Epoch 2/20 => Loss 1.696, Train_accy 71.84:  10%|█         | 2/20 [00:16<02:24,  8.01s/it]
Task 0, Epoch 3/20 => Loss 1.193, Train_accy 80.06:  10%|█         | 2/20 [00:24<02:24,  8.01s/it]
Task 0, Epoch 3/20 => Loss 1.193, Train_accy 80.06:  15%|█▌        | 3/20 [00:24<02:16,  8.00s/it]
Task 0, Epoch 4/20 => Loss 0.857, Train_accy 83.24:  15%|█▌        | 3/20 [00:31<02:16,  8.00s/it]
Task 0, Epoch 4/20 => Loss 0.857, Train_accy 83.24:  20%|██        | 4/20 [00:31<02:07,  7.97s/it]
Task 0, Epoch 5/20 => Loss 0.683, Train_accy 86.27:  20%|██        | 4/20 [00:39<02:07,  7.97s/it]
Task 0, Epoch 5/20 => Loss 0.683, Train_accy 86.27:  25%|██▌       | 5/20 [00:39<01:59,  7.94s/it]
Task 0, Epoch 6/20 => Loss 0.551, Train_accy 87.12:  25%|██▌       | 5/20 [00:47<01:59,  7.94s/it]
Task 0, Epoch 6/20 => Loss 0.551, Train_accy 87.12:  30%|███       | 6/20 [00:47<01:50,  7.93s/it]
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 89.14:  30%|███       | 6/20 [00:55<01:50,  7.93s/it]
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 89.14:  35%|███▌      | 7/20 [00:55<01:42,  7.90s/it]
Task 0, Epoch 8/20 => Loss 0.447, Train_accy 89.68:  35%|███▌      | 7/20 [01:03<01:42,  7.90s/it]
Task 0, Epoch 8/20 => Loss 0.447, Train_accy 89.68:  40%|████      | 8/20 [01:03<01:34,  7.90s/it]
Task 0, Epoch 9/20 => Loss 0.400, Train_accy 90.30:  40%|████      | 8/20 [01:11<01:34,  7.90s/it]
Task 0, Epoch 9/20 => Loss 0.400, Train_accy 90.30:  45%|████▌     | 9/20 [01:11<01:27,  7.91s/it]
Task 0, Epoch 10/20 => Loss 0.374, Train_accy 90.77:  45%|████▌     | 9/20 [01:19<01:27,  7.91s/it]
Task 0, Epoch 10/20 => Loss 0.374, Train_accy 90.77:  50%|█████     | 10/20 [01:19<01:19,  7.91s/it]
Task 0, Epoch 11/20 => Loss 0.379, Train_accy 90.54:  50%|█████     | 10/20 [01:27<01:19,  7.91s/it]
Task 0, Epoch 11/20 => Loss 0.379, Train_accy 90.54:  55%|█████▌    | 11/20 [01:27<01:11,  7.92s/it]
Task 0, Epoch 12/20 => Loss 0.354, Train_accy 91.31:  55%|█████▌    | 11/20 [01:35<01:11,  7.92s/it]
Task 0, Epoch 12/20 => Loss 0.354, Train_accy 91.31:  60%|██████    | 12/20 [01:35<01:03,  7.95s/it]
Task 0, Epoch 13/20 => Loss 0.357, Train_accy 91.23:  60%|██████    | 12/20 [01:43<01:03,  7.95s/it]
Task 0, Epoch 13/20 => Loss 0.357, Train_accy 91.23:  65%|██████▌   | 13/20 [01:43<00:55,  7.93s/it]
Task 0, Epoch 14/20 => Loss 0.344, Train_accy 91.00:  65%|██████▌   | 13/20 [01:51<00:55,  7.93s/it]
Task 0, Epoch 14/20 => Loss 0.344, Train_accy 91.00:  70%|███████   | 14/20 [01:51<00:47,  7.92s/it]
Task 0, Epoch 15/20 => Loss 0.350, Train_accy 91.47:  70%|███████   | 14/20 [01:59<00:47,  7.92s/it]
Task 0, Epoch 15/20 => Loss 0.350, Train_accy 91.47:  75%|███████▌  | 15/20 [01:59<00:39,  7.92s/it]
Task 0, Epoch 16/20 => Loss 0.343, Train_accy 91.39:  75%|███████▌  | 15/20 [02:07<00:39,  7.92s/it]
Task 0, Epoch 16/20 => Loss 0.343, Train_accy 91.39:  80%|████████  | 16/20 [02:07<00:31,  7.96s/it]
Task 0, Epoch 17/20 => Loss 0.347, Train_accy 91.16:  80%|████████  | 16/20 [02:15<00:31,  7.96s/it]
Task 0, Epoch 17/20 => Loss 0.347, Train_accy 91.16:  85%|████████▌ | 17/20 [02:15<00:23,  7.98s/it]
Task 0, Epoch 18/20 => Loss 0.302, Train_accy 92.55:  85%|████████▌ | 17/20 [02:23<00:23,  7.98s/it]
Task 0, Epoch 18/20 => Loss 0.302, Train_accy 92.55:  90%|█████████ | 18/20 [02:23<00:15,  7.96s/it]
Task 0, Epoch 19/20 => Loss 0.349, Train_accy 91.47:  90%|█████████ | 18/20 [02:30<00:15,  7.96s/it]
Task 0, Epoch 19/20 => Loss 0.349, Train_accy 91.47:  95%|█████████▌| 19/20 [02:30<00:07,  7.94s/it]
Task 0, Epoch 20/20 => Loss 0.319, Train_accy 92.40:  95%|█████████▌| 19/20 [02:38<00:07,  7.94s/it]
Task 0, Epoch 20/20 => Loss 0.319, Train_accy 92.40: 100%|██████████| 20/20 [02:38<00:00,  7.97s/it]
Task 0, Epoch 20/20 => Loss 0.319, Train_accy 92.40: 100%|██████████| 20/20 [02:38<00:00,  7.95s/it]
2024-09-08 09:39:10,201 [ease.py] => Task 0, Epoch 20/20 => Loss 0.319, Train_accy 92.40
2024-09-08 09:39:16,063 [ease.py] => Task correct: 100.0
2024-09-08 09:39:16,064 [ease.py] => Task acc: 92.74447949526814
2024-09-08 09:39:16,087 [trainer.py] => No NME accuracy.
2024-09-08 09:39:16,087 [trainer.py] => CNN: {'total': 92.74, '00-09': 92.74, 'old': 0, 'new': 92.74}
2024-09-08 09:39:16,087 [trainer.py] => CNN top1 curve: [92.74]
2024-09-08 09:39:16,087 [trainer.py] => CNN top5 curve: [99.37]

Average Accuracy (CNN): 92.74
2024-09-08 09:39:16,087 [trainer.py] => Average Accuracy (CNN): 92.74 

2024-09-08 09:39:16,088 [trainer.py] => All params: 86118338
2024-09-08 09:39:16,089 [trainer.py] => Trainable params: 304320
2024-09-08 09:39:16,090 [ease.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.107, Train_accy 49.31:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.107, Train_accy 49.31:   5%|▌         | 1/20 [00:09<02:54,  9.18s/it]
Task 1, Epoch 2/20 => Loss 1.424, Train_accy 73.33:   5%|▌         | 1/20 [00:18<02:54,  9.18s/it]
Task 1, Epoch 2/20 => Loss 1.424, Train_accy 73.33:  10%|█         | 2/20 [00:18<02:45,  9.19s/it]
Task 1, Epoch 3/20 => Loss 0.993, Train_accy 80.66:  10%|█         | 2/20 [00:27<02:45,  9.19s/it]
Task 1, Epoch 3/20 => Loss 0.993, Train_accy 80.66:  15%|█▌        | 3/20 [00:27<02:36,  9.21s/it]
Task 1, Epoch 4/20 => Loss 0.732, Train_accy 83.23:  15%|█▌        | 3/20 [00:36<02:36,  9.21s/it]
Task 1, Epoch 4/20 => Loss 0.732, Train_accy 83.23:  20%|██        | 4/20 [00:36<02:27,  9.21s/it]
Task 1, Epoch 5/20 => Loss 0.568, Train_accy 86.40:  20%|██        | 4/20 [00:46<02:27,  9.21s/it]
Task 1, Epoch 5/20 => Loss 0.568, Train_accy 86.40:  25%|██▌       | 5/20 [00:46<02:18,  9.20s/it]
Task 1, Epoch 6/20 => Loss 0.454, Train_accy 88.58:  25%|██▌       | 5/20 [00:55<02:18,  9.20s/it]
Task 1, Epoch 6/20 => Loss 0.454, Train_accy 88.58:  30%|███       | 6/20 [00:55<02:09,  9.22s/it]
Task 1, Epoch 7/20 => Loss 0.406, Train_accy 90.23:  30%|███       | 6/20 [01:04<02:09,  9.22s/it]
Task 1, Epoch 7/20 => Loss 0.406, Train_accy 90.23:  35%|███▌      | 7/20 [01:04<02:00,  9.24s/it]
Task 1, Epoch 8/20 => Loss 0.357, Train_accy 90.50:  35%|███▌      | 7/20 [01:13<02:00,  9.24s/it]
Task 1, Epoch 8/20 => Loss 0.357, Train_accy 90.50:  40%|████      | 8/20 [01:13<01:50,  9.25s/it]
Task 1, Epoch 9/20 => Loss 0.356, Train_accy 91.02:  40%|████      | 8/20 [01:23<01:50,  9.25s/it]
Task 1, Epoch 9/20 => Loss 0.356, Train_accy 91.02:  45%|████▌     | 9/20 [01:23<01:42,  9.29s/it]
Task 1, Epoch 10/20 => Loss 0.340, Train_accy 91.35:  45%|████▌     | 9/20 [01:32<01:42,  9.29s/it]
Task 1, Epoch 10/20 => Loss 0.340, Train_accy 91.35:  50%|█████     | 10/20 [01:32<01:33,  9.37s/it]
Task 1, Epoch 11/20 => Loss 0.349, Train_accy 90.56:  50%|█████     | 10/20 [01:41<01:33,  9.37s/it]
Task 1, Epoch 11/20 => Loss 0.349, Train_accy 90.56:  55%|█████▌    | 11/20 [01:41<01:23,  9.31s/it]
Task 1, Epoch 12/20 => Loss 0.322, Train_accy 92.28:  55%|█████▌    | 11/20 [01:51<01:23,  9.31s/it]
Task 1, Epoch 12/20 => Loss 0.322, Train_accy 92.28:  60%|██████    | 12/20 [01:51<01:14,  9.28s/it]
Task 1, Epoch 13/20 => Loss 0.339, Train_accy 91.42:  60%|██████    | 12/20 [02:00<01:14,  9.28s/it]
Task 1, Epoch 13/20 => Loss 0.339, Train_accy 91.42:  65%|██████▌   | 13/20 [02:00<01:04,  9.26s/it]
Task 1, Epoch 14/20 => Loss 0.320, Train_accy 91.88:  65%|██████▌   | 13/20 [02:09<01:04,  9.26s/it]
Task 1, Epoch 14/20 => Loss 0.320, Train_accy 91.88:  70%|███████   | 14/20 [02:09<00:55,  9.28s/it]
Task 1, Epoch 15/20 => Loss 0.286, Train_accy 92.15:  70%|███████   | 14/20 [02:18<00:55,  9.28s/it]
Task 1, Epoch 15/20 => Loss 0.286, Train_accy 92.15:  75%|███████▌  | 15/20 [02:18<00:46,  9.28s/it]
Task 1, Epoch 16/20 => Loss 0.310, Train_accy 91.62:  75%|███████▌  | 15/20 [02:28<00:46,  9.28s/it]
Task 1, Epoch 16/20 => Loss 0.310, Train_accy 91.62:  80%|████████  | 16/20 [02:28<00:37,  9.28s/it]
Task 1, Epoch 17/20 => Loss 0.294, Train_accy 92.87:  80%|████████  | 16/20 [02:37<00:37,  9.28s/it]
Task 1, Epoch 17/20 => Loss 0.294, Train_accy 92.87:  85%|████████▌ | 17/20 [02:37<00:27,  9.28s/it]
Task 1, Epoch 18/20 => Loss 0.300, Train_accy 92.28:  85%|████████▌ | 17/20 [02:46<00:27,  9.28s/it]
Task 1, Epoch 18/20 => Loss 0.300, Train_accy 92.28:  90%|█████████ | 18/20 [02:46<00:18,  9.27s/it]
Task 1, Epoch 19/20 => Loss 0.299, Train_accy 91.95:  90%|█████████ | 18/20 [02:55<00:18,  9.27s/it]
Task 1, Epoch 19/20 => Loss 0.299, Train_accy 91.95:  95%|█████████▌| 19/20 [02:55<00:09,  9.26s/it]
Task 1, Epoch 20/20 => Loss 0.287, Train_accy 92.28:  95%|█████████▌| 19/20 [03:05<00:09,  9.26s/it]
Task 1, Epoch 20/20 => Loss 0.287, Train_accy 92.28: 100%|██████████| 20/20 [03:05<00:00,  9.25s/it]
Task 1, Epoch 20/20 => Loss 0.287, Train_accy 92.28: 100%|██████████| 20/20 [03:05<00:00,  9.26s/it]
2024-09-08 09:42:21,324 [ease.py] => Task 1, Epoch 20/20 => Loss 0.287, Train_accy 92.28
2024-09-08 09:42:36,043 [ease.py] => Task correct: 94.33962264150944
2024-09-08 09:42:36,044 [ease.py] => Task acc: 93.75907111756169
2024-09-08 09:42:36,068 [trainer.py] => No NME accuracy.
2024-09-08 09:42:36,068 [trainer.py] => CNN: {'total': 89.99, '00-09': 86.44, '10-19': 93.01, 'old': 86.44, 'new': 93.01}
2024-09-08 09:42:36,068 [trainer.py] => CNN top1 curve: [92.74, 89.99]
2024-09-08 09:42:36,068 [trainer.py] => CNN top5 curve: [99.37, 98.4]

Average Accuracy (CNN): 91.36
2024-09-08 09:42:36,069 [trainer.py] => Average Accuracy (CNN): 91.36 

2024-09-08 09:42:36,070 [trainer.py] => All params: 86141378
2024-09-08 09:42:36,070 [trainer.py] => Trainable params: 304320
2024-09-08 09:42:36,072 [ease.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.205, Train_accy 40.34:   0%|          | 0/20 [00:07<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.205, Train_accy 40.34:   5%|▌         | 1/20 [00:07<02:22,  7.52s/it]
Task 2, Epoch 2/20 => Loss 1.734, Train_accy 66.37:   5%|▌         | 1/20 [00:15<02:22,  7.52s/it]
Task 2, Epoch 2/20 => Loss 1.734, Train_accy 66.37:  10%|█         | 2/20 [00:15<02:15,  7.55s/it]
Task 2, Epoch 3/20 => Loss 1.262, Train_accy 78.64:  10%|█         | 2/20 [00:22<02:15,  7.55s/it]
Task 2, Epoch 3/20 => Loss 1.262, Train_accy 78.64:  15%|█▌        | 3/20 [00:22<02:08,  7.56s/it]
Task 2, Epoch 4/20 => Loss 0.977, Train_accy 80.93:  15%|█▌        | 3/20 [00:30<02:08,  7.56s/it]
Task 2, Epoch 4/20 => Loss 0.977, Train_accy 80.93:  20%|██        | 4/20 [00:30<02:01,  7.57s/it]
Task 2, Epoch 5/20 => Loss 0.781, Train_accy 83.06:  20%|██        | 4/20 [00:37<02:01,  7.57s/it]
Task 2, Epoch 5/20 => Loss 0.781, Train_accy 83.06:  25%|██▌       | 5/20 [00:37<01:53,  7.55s/it]
Task 2, Epoch 6/20 => Loss 0.613, Train_accy 86.42:  25%|██▌       | 5/20 [00:45<01:53,  7.55s/it]
Task 2, Epoch 6/20 => Loss 0.613, Train_accy 86.42:  30%|███       | 6/20 [00:45<01:45,  7.56s/it]
Task 2, Epoch 7/20 => Loss 0.519, Train_accy 86.58:  30%|███       | 6/20 [00:52<01:45,  7.56s/it]
Task 2, Epoch 7/20 => Loss 0.519, Train_accy 86.58:  35%|███▌      | 7/20 [00:52<01:38,  7.57s/it]
Task 2, Epoch 8/20 => Loss 0.467, Train_accy 87.48:  35%|███▌      | 7/20 [01:00<01:38,  7.57s/it]
Task 2, Epoch 8/20 => Loss 0.467, Train_accy 87.48:  40%|████      | 8/20 [01:00<01:30,  7.55s/it]
Task 2, Epoch 9/20 => Loss 0.458, Train_accy 87.40:  40%|████      | 8/20 [01:07<01:30,  7.55s/it]
Task 2, Epoch 9/20 => Loss 0.458, Train_accy 87.40:  45%|████▌     | 9/20 [01:07<01:22,  7.55s/it]
Task 2, Epoch 10/20 => Loss 0.416, Train_accy 89.20:  45%|████▌     | 9/20 [01:15<01:22,  7.55s/it]
Task 2, Epoch 10/20 => Loss 0.416, Train_accy 89.20:  50%|█████     | 10/20 [01:15<01:15,  7.53s/it]
Task 2, Epoch 11/20 => Loss 0.395, Train_accy 90.34:  50%|█████     | 10/20 [01:23<01:15,  7.53s/it]
Task 2, Epoch 11/20 => Loss 0.395, Train_accy 90.34:  55%|█████▌    | 11/20 [01:23<01:07,  7.55s/it]
Task 2, Epoch 12/20 => Loss 0.377, Train_accy 90.26:  55%|█████▌    | 11/20 [01:30<01:07,  7.55s/it]
Task 2, Epoch 12/20 => Loss 0.377, Train_accy 90.26:  60%|██████    | 12/20 [01:30<01:00,  7.57s/it]
Task 2, Epoch 13/20 => Loss 0.362, Train_accy 90.43:  60%|██████    | 12/20 [01:38<01:00,  7.57s/it]
Task 2, Epoch 13/20 => Loss 0.362, Train_accy 90.43:  65%|██████▌   | 13/20 [01:38<00:52,  7.56s/it]
Task 2, Epoch 14/20 => Loss 0.362, Train_accy 90.59:  65%|██████▌   | 13/20 [01:45<00:52,  7.56s/it]
Task 2, Epoch 14/20 => Loss 0.362, Train_accy 90.59:  70%|███████   | 14/20 [01:45<00:45,  7.57s/it]
Task 2, Epoch 15/20 => Loss 0.348, Train_accy 90.75:  70%|███████   | 14/20 [01:53<00:45,  7.57s/it]
Task 2, Epoch 15/20 => Loss 0.348, Train_accy 90.75:  75%|███████▌  | 15/20 [01:53<00:37,  7.56s/it]
Task 2, Epoch 16/20 => Loss 0.356, Train_accy 90.51:  75%|███████▌  | 15/20 [02:00<00:37,  7.56s/it]
Task 2, Epoch 16/20 => Loss 0.356, Train_accy 90.51:  80%|████████  | 16/20 [02:00<00:30,  7.55s/it]
Task 2, Epoch 17/20 => Loss 0.365, Train_accy 90.43:  80%|████████  | 16/20 [02:08<00:30,  7.55s/it]
Task 2, Epoch 17/20 => Loss 0.365, Train_accy 90.43:  85%|████████▌ | 17/20 [02:08<00:22,  7.54s/it]
Task 2, Epoch 18/20 => Loss 0.361, Train_accy 90.34:  85%|████████▌ | 17/20 [02:15<00:22,  7.54s/it]
Task 2, Epoch 18/20 => Loss 0.361, Train_accy 90.34:  90%|█████████ | 18/20 [02:15<00:15,  7.53s/it]
Task 2, Epoch 19/20 => Loss 0.359, Train_accy 90.18:  90%|█████████ | 18/20 [02:23<00:15,  7.53s/it]
Task 2, Epoch 19/20 => Loss 0.359, Train_accy 90.18:  95%|█████████▌| 19/20 [02:23<00:07,  7.52s/it]
Task 2, Epoch 20/20 => Loss 0.347, Train_accy 91.73:  95%|█████████▌| 19/20 [02:30<00:07,  7.52s/it]
Task 2, Epoch 20/20 => Loss 0.347, Train_accy 91.73: 100%|██████████| 20/20 [02:30<00:00,  7.55s/it]
Task 2, Epoch 20/20 => Loss 0.347, Train_accy 91.73: 100%|██████████| 20/20 [02:30<00:00,  7.55s/it]
2024-09-08 09:45:07,074 [ease.py] => Task 2, Epoch 20/20 => Loss 0.347, Train_accy 91.73
2024-09-08 09:45:28,561 [ease.py] => Task correct: 89.48432760364004
2024-09-08 09:45:28,562 [ease.py] => Task acc: 93.62992922143579
2024-09-08 09:45:28,583 [trainer.py] => No NME accuracy.
2024-09-08 09:45:28,583 [trainer.py] => CNN: {'total': 86.35, '00-09': 80.76, '10-19': 91.94, '20-29': 85.33, 'old': 86.79, 'new': 85.33}
2024-09-08 09:45:28,584 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35]
2024-09-08 09:45:28,584 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17]

Average Accuracy (CNN): 89.69
2024-09-08 09:45:28,584 [trainer.py] => Average Accuracy (CNN): 89.69 

2024-09-08 09:45:28,584 [trainer.py] => All params: 86179778
2024-09-08 09:45:28,585 [trainer.py] => Trainable params: 304320
2024-09-08 09:45:28,587 [ease.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.158, Train_accy 46.34:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.158, Train_accy 46.34:   5%|▌         | 1/20 [00:08<02:36,  8.25s/it]
Task 3, Epoch 2/20 => Loss 1.575, Train_accy 69.48:   5%|▌         | 1/20 [00:16<02:36,  8.25s/it]
Task 3, Epoch 2/20 => Loss 1.575, Train_accy 69.48:  10%|█         | 2/20 [00:16<02:27,  8.22s/it]
Task 3, Epoch 3/20 => Loss 1.081, Train_accy 81.72:  10%|█         | 2/20 [00:24<02:27,  8.22s/it]
Task 3, Epoch 3/20 => Loss 1.081, Train_accy 81.72:  15%|█▌        | 3/20 [00:24<02:19,  8.22s/it]
Task 3, Epoch 4/20 => Loss 0.817, Train_accy 83.21:  15%|█▌        | 3/20 [00:32<02:19,  8.22s/it]
Task 3, Epoch 4/20 => Loss 0.817, Train_accy 83.21:  20%|██        | 4/20 [00:32<02:11,  8.21s/it]
Task 3, Epoch 5/20 => Loss 0.638, Train_accy 84.70:  20%|██        | 4/20 [00:41<02:11,  8.21s/it]
Task 3, Epoch 5/20 => Loss 0.638, Train_accy 84.70:  25%|██▌       | 5/20 [00:41<02:03,  8.21s/it]
Task 3, Epoch 6/20 => Loss 0.520, Train_accy 86.27:  25%|██▌       | 5/20 [00:49<02:03,  8.21s/it]
Task 3, Epoch 6/20 => Loss 0.520, Train_accy 86.27:  30%|███       | 6/20 [00:49<01:55,  8.22s/it]
Task 3, Epoch 7/20 => Loss 0.480, Train_accy 86.94:  30%|███       | 6/20 [00:57<01:55,  8.22s/it]
Task 3, Epoch 7/20 => Loss 0.480, Train_accy 86.94:  35%|███▌      | 7/20 [00:57<01:46,  8.21s/it]
Task 3, Epoch 8/20 => Loss 0.413, Train_accy 88.21:  35%|███▌      | 7/20 [01:05<01:46,  8.21s/it]
Task 3, Epoch 8/20 => Loss 0.413, Train_accy 88.21:  40%|████      | 8/20 [01:05<01:38,  8.21s/it]
Task 3, Epoch 9/20 => Loss 0.415, Train_accy 87.91:  40%|████      | 8/20 [01:13<01:38,  8.21s/it]
Task 3, Epoch 9/20 => Loss 0.415, Train_accy 87.91:  45%|████▌     | 9/20 [01:13<01:30,  8.20s/it]
Task 3, Epoch 10/20 => Loss 0.393, Train_accy 88.13:  45%|████▌     | 9/20 [01:22<01:30,  8.20s/it]
Task 3, Epoch 10/20 => Loss 0.393, Train_accy 88.13:  50%|█████     | 10/20 [01:22<01:22,  8.25s/it]
Task 3, Epoch 11/20 => Loss 0.388, Train_accy 89.63:  50%|█████     | 10/20 [01:30<01:22,  8.25s/it]
Task 3, Epoch 11/20 => Loss 0.388, Train_accy 89.63:  55%|█████▌    | 11/20 [01:30<01:14,  8.23s/it]
Task 3, Epoch 12/20 => Loss 0.381, Train_accy 89.18:  55%|█████▌    | 11/20 [01:38<01:14,  8.23s/it]
Task 3, Epoch 12/20 => Loss 0.381, Train_accy 89.18:  60%|██████    | 12/20 [01:38<01:06,  8.25s/it]
Task 3, Epoch 13/20 => Loss 0.365, Train_accy 90.67:  60%|██████    | 12/20 [01:47<01:06,  8.25s/it]
Task 3, Epoch 13/20 => Loss 0.365, Train_accy 90.67:  65%|██████▌   | 13/20 [01:47<00:57,  8.26s/it]
Task 3, Epoch 14/20 => Loss 0.358, Train_accy 90.07:  65%|██████▌   | 13/20 [01:55<00:57,  8.26s/it]
Task 3, Epoch 14/20 => Loss 0.358, Train_accy 90.07:  70%|███████   | 14/20 [01:55<00:49,  8.24s/it]
Task 3, Epoch 15/20 => Loss 0.357, Train_accy 89.93:  70%|███████   | 14/20 [02:03<00:49,  8.24s/it]
Task 3, Epoch 15/20 => Loss 0.357, Train_accy 89.93:  75%|███████▌  | 15/20 [02:03<00:41,  8.23s/it]
Task 3, Epoch 16/20 => Loss 0.345, Train_accy 90.82:  75%|███████▌  | 15/20 [02:11<00:41,  8.23s/it]
Task 3, Epoch 16/20 => Loss 0.345, Train_accy 90.82:  80%|████████  | 16/20 [02:11<00:32,  8.23s/it]
Task 3, Epoch 17/20 => Loss 0.360, Train_accy 89.85:  80%|████████  | 16/20 [02:19<00:32,  8.23s/it]
Task 3, Epoch 17/20 => Loss 0.360, Train_accy 89.85:  85%|████████▌ | 17/20 [02:19<00:24,  8.22s/it]
Task 3, Epoch 18/20 => Loss 0.352, Train_accy 90.82:  85%|████████▌ | 17/20 [02:28<00:24,  8.22s/it]
Task 3, Epoch 18/20 => Loss 0.352, Train_accy 90.82:  90%|█████████ | 18/20 [02:28<00:16,  8.21s/it]
Task 3, Epoch 19/20 => Loss 0.324, Train_accy 90.60:  90%|█████████ | 18/20 [02:36<00:16,  8.21s/it]
Task 3, Epoch 19/20 => Loss 0.324, Train_accy 90.60:  95%|█████████▌| 19/20 [02:36<00:08,  8.22s/it]
Task 3, Epoch 20/20 => Loss 0.329, Train_accy 90.45:  95%|█████████▌| 19/20 [02:44<00:08,  8.22s/it]
Task 3, Epoch 20/20 => Loss 0.329, Train_accy 90.45: 100%|██████████| 20/20 [02:44<00:00,  8.22s/it]
Task 3, Epoch 20/20 => Loss 0.329, Train_accy 90.45: 100%|██████████| 20/20 [02:44<00:00,  8.22s/it]
2024-09-08 09:48:13,072 [ease.py] => Task 3, Epoch 20/20 => Loss 0.329, Train_accy 90.45
2024-09-08 09:48:46,905 [ease.py] => Task correct: 88.41786525359576
2024-09-08 09:48:46,906 [ease.py] => Task acc: 93.48978046934141
2024-09-08 09:48:46,931 [trainer.py] => No NME accuracy.
2024-09-08 09:48:46,932 [trainer.py] => CNN: {'total': 85.47, '00-09': 79.5, '10-19': 91.67, '20-29': 84.0, '30-39': 85.54, 'old': 85.44, 'new': 85.54}
2024-09-08 09:48:46,932 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47]
2024-09-08 09:48:46,932 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59]

Average Accuracy (CNN): 88.64
2024-09-08 09:48:46,932 [trainer.py] => Average Accuracy (CNN): 88.64 

2024-09-08 09:48:46,933 [trainer.py] => All params: 86233538
2024-09-08 09:48:46,934 [trainer.py] => Trainable params: 304320
2024-09-08 09:48:46,937 [ease.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.245, Train_accy 36.51:   0%|          | 0/20 [00:06<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.245, Train_accy 36.51:   5%|▌         | 1/20 [00:06<02:08,  6.79s/it]
Task 4, Epoch 2/20 => Loss 1.900, Train_accy 67.76:   5%|▌         | 1/20 [00:13<02:08,  6.79s/it]
Task 4, Epoch 2/20 => Loss 1.900, Train_accy 67.76:  10%|█         | 2/20 [00:13<02:02,  6.80s/it]
Task 4, Epoch 3/20 => Loss 1.454, Train_accy 71.75:  10%|█         | 2/20 [00:20<02:02,  6.80s/it]
Task 4, Epoch 3/20 => Loss 1.454, Train_accy 71.75:  15%|█▌        | 3/20 [00:20<01:55,  6.81s/it]
Task 4, Epoch 4/20 => Loss 1.147, Train_accy 78.93:  15%|█▌        | 3/20 [00:27<01:55,  6.81s/it]
Task 4, Epoch 4/20 => Loss 1.147, Train_accy 78.93:  20%|██        | 4/20 [00:27<01:49,  6.82s/it]
Task 4, Epoch 5/20 => Loss 0.934, Train_accy 80.84:  20%|██        | 4/20 [00:34<01:49,  6.82s/it]
Task 4, Epoch 5/20 => Loss 0.934, Train_accy 80.84:  25%|██▌       | 5/20 [00:34<01:42,  6.82s/it]
Task 4, Epoch 6/20 => Loss 0.809, Train_accy 81.11:  25%|██▌       | 5/20 [00:40<01:42,  6.82s/it]
Task 4, Epoch 6/20 => Loss 0.809, Train_accy 81.11:  30%|███       | 6/20 [00:40<01:35,  6.82s/it]
Task 4, Epoch 7/20 => Loss 0.713, Train_accy 82.65:  30%|███       | 6/20 [00:47<01:35,  6.82s/it]
Task 4, Epoch 7/20 => Loss 0.713, Train_accy 82.65:  35%|███▌      | 7/20 [00:47<01:28,  6.82s/it]
Task 4, Epoch 8/20 => Loss 0.628, Train_accy 84.56:  35%|███▌      | 7/20 [00:54<01:28,  6.82s/it]
Task 4, Epoch 8/20 => Loss 0.628, Train_accy 84.56:  40%|████      | 8/20 [00:54<01:21,  6.82s/it]
Task 4, Epoch 9/20 => Loss 0.596, Train_accy 84.65:  40%|████      | 8/20 [01:01<01:21,  6.82s/it]
Task 4, Epoch 9/20 => Loss 0.596, Train_accy 84.65:  45%|████▌     | 9/20 [01:01<01:15,  6.82s/it]
Task 4, Epoch 10/20 => Loss 0.559, Train_accy 86.01:  45%|████▌     | 9/20 [01:08<01:15,  6.82s/it]
Task 4, Epoch 10/20 => Loss 0.559, Train_accy 86.01:  50%|█████     | 10/20 [01:08<01:08,  6.82s/it]
Task 4, Epoch 11/20 => Loss 0.532, Train_accy 86.56:  50%|█████     | 10/20 [01:14<01:08,  6.82s/it]
Task 4, Epoch 11/20 => Loss 0.532, Train_accy 86.56:  55%|█████▌    | 11/20 [01:14<01:01,  6.81s/it]
Task 4, Epoch 12/20 => Loss 0.533, Train_accy 87.19:  55%|█████▌    | 11/20 [01:21<01:01,  6.81s/it]
Task 4, Epoch 12/20 => Loss 0.533, Train_accy 87.19:  60%|██████    | 12/20 [01:21<00:54,  6.82s/it]
Task 4, Epoch 13/20 => Loss 0.545, Train_accy 85.65:  60%|██████    | 12/20 [01:28<00:54,  6.82s/it]
Task 4, Epoch 13/20 => Loss 0.545, Train_accy 85.65:  65%|██████▌   | 13/20 [01:28<00:47,  6.81s/it]
Task 4, Epoch 14/20 => Loss 0.499, Train_accy 87.74:  65%|██████▌   | 13/20 [01:35<00:47,  6.81s/it]
Task 4, Epoch 14/20 => Loss 0.499, Train_accy 87.74:  70%|███████   | 14/20 [01:35<00:40,  6.82s/it]
Task 4, Epoch 15/20 => Loss 0.499, Train_accy 85.83:  70%|███████   | 14/20 [01:42<00:40,  6.82s/it]
Task 4, Epoch 15/20 => Loss 0.499, Train_accy 85.83:  75%|███████▌  | 15/20 [01:42<00:34,  6.82s/it]
Task 4, Epoch 16/20 => Loss 0.494, Train_accy 86.74:  75%|███████▌  | 15/20 [01:49<00:34,  6.82s/it]
Task 4, Epoch 16/20 => Loss 0.494, Train_accy 86.74:  80%|████████  | 16/20 [01:49<00:27,  6.83s/it]
Task 4, Epoch 17/20 => Loss 0.457, Train_accy 89.01:  80%|████████  | 16/20 [01:55<00:27,  6.83s/it]
Task 4, Epoch 17/20 => Loss 0.457, Train_accy 89.01:  85%|████████▌ | 17/20 [01:55<00:20,  6.81s/it]
Task 4, Epoch 18/20 => Loss 0.464, Train_accy 88.92:  85%|████████▌ | 17/20 [02:02<00:20,  6.81s/it]
Task 4, Epoch 18/20 => Loss 0.464, Train_accy 88.92:  90%|█████████ | 18/20 [02:02<00:13,  6.82s/it]
Task 4, Epoch 19/20 => Loss 0.469, Train_accy 87.74:  90%|█████████ | 18/20 [02:09<00:13,  6.82s/it]
Task 4, Epoch 19/20 => Loss 0.469, Train_accy 87.74:  95%|█████████▌| 19/20 [02:09<00:06,  6.84s/it]
Task 4, Epoch 20/20 => Loss 0.443, Train_accy 89.10:  95%|█████████▌| 19/20 [02:16<00:06,  6.84s/it]
Task 4, Epoch 20/20 => Loss 0.443, Train_accy 89.10: 100%|██████████| 20/20 [02:16<00:00,  6.83s/it]
Task 4, Epoch 20/20 => Loss 0.443, Train_accy 89.10: 100%|██████████| 20/20 [02:16<00:00,  6.82s/it]
2024-09-08 09:51:03,363 [ease.py] => Task 4, Epoch 20/20 => Loss 0.443, Train_accy 89.10
2024-09-08 09:51:45,653 [ease.py] => Task correct: 86.56808379544054
2024-09-08 09:51:45,654 [ease.py] => Task acc: 92.72951324707333
2024-09-08 09:51:45,676 [trainer.py] => No NME accuracy.
2024-09-08 09:51:45,676 [trainer.py] => CNN: {'total': 83.61, '00-09': 78.86, '10-19': 90.32, '20-29': 83.0, '30-39': 84.64, '40-49': 79.8, 'old': 84.48, 'new': 79.8}
2024-09-08 09:51:45,676 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61]
2024-09-08 09:51:45,676 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07]

Average Accuracy (CNN): 87.63
2024-09-08 09:51:45,676 [trainer.py] => Average Accuracy (CNN): 87.63 

2024-09-08 09:51:45,677 [trainer.py] => All params: 86302658
2024-09-08 09:51:45,678 [trainer.py] => Trainable params: 304320
2024-09-08 09:51:45,681 [ease.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.221, Train_accy 37.12:   0%|          | 0/20 [00:07<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.221, Train_accy 37.12:   5%|▌         | 1/20 [00:07<02:25,  7.68s/it]
Task 5, Epoch 2/20 => Loss 1.833, Train_accy 61.27:   5%|▌         | 1/20 [00:15<02:25,  7.68s/it]
Task 5, Epoch 2/20 => Loss 1.833, Train_accy 61.27:  10%|█         | 2/20 [00:15<02:18,  7.68s/it]
Task 5, Epoch 3/20 => Loss 1.369, Train_accy 75.60:  10%|█         | 2/20 [00:23<02:18,  7.68s/it]
Task 5, Epoch 3/20 => Loss 1.369, Train_accy 75.60:  15%|█▌        | 3/20 [00:23<02:10,  7.66s/it]
Task 5, Epoch 4/20 => Loss 1.056, Train_accy 80.03:  15%|█▌        | 3/20 [00:30<02:10,  7.66s/it]
Task 5, Epoch 4/20 => Loss 1.056, Train_accy 80.03:  20%|██        | 4/20 [00:30<02:04,  7.79s/it]
Task 5, Epoch 5/20 => Loss 0.841, Train_accy 82.53:  20%|██        | 4/20 [00:38<02:04,  7.79s/it]
Task 5, Epoch 5/20 => Loss 0.841, Train_accy 82.53:  25%|██▌       | 5/20 [00:38<01:55,  7.73s/it]
Task 5, Epoch 6/20 => Loss 0.689, Train_accy 84.06:  25%|██▌       | 5/20 [00:46<01:55,  7.73s/it]
Task 5, Epoch 6/20 => Loss 0.689, Train_accy 84.06:  30%|███       | 6/20 [00:46<01:47,  7.70s/it]
Task 5, Epoch 7/20 => Loss 0.571, Train_accy 85.99:  30%|███       | 6/20 [00:53<01:47,  7.70s/it]
Task 5, Epoch 7/20 => Loss 0.571, Train_accy 85.99:  35%|███▌      | 7/20 [00:53<01:39,  7.69s/it]
Task 5, Epoch 8/20 => Loss 0.508, Train_accy 88.00:  35%|███▌      | 7/20 [01:01<01:39,  7.69s/it]
Task 5, Epoch 8/20 => Loss 0.508, Train_accy 88.00:  40%|████      | 8/20 [01:01<01:33,  7.81s/it]
Task 5, Epoch 9/20 => Loss 0.499, Train_accy 85.35:  40%|████      | 8/20 [01:09<01:33,  7.81s/it]
Task 5, Epoch 9/20 => Loss 0.499, Train_accy 85.35:  45%|████▌     | 9/20 [01:09<01:25,  7.79s/it]
Task 5, Epoch 10/20 => Loss 0.442, Train_accy 89.21:  45%|████▌     | 9/20 [01:17<01:25,  7.79s/it]
Task 5, Epoch 10/20 => Loss 0.442, Train_accy 89.21:  50%|█████     | 10/20 [01:17<01:17,  7.75s/it]
Task 5, Epoch 11/20 => Loss 0.418, Train_accy 88.33:  50%|█████     | 10/20 [01:25<01:17,  7.75s/it]
Task 5, Epoch 11/20 => Loss 0.418, Train_accy 88.33:  55%|█████▌    | 11/20 [01:25<01:09,  7.71s/it]
Task 5, Epoch 12/20 => Loss 0.403, Train_accy 89.45:  55%|█████▌    | 11/20 [01:32<01:09,  7.71s/it]
Task 5, Epoch 12/20 => Loss 0.403, Train_accy 89.45:  60%|██████    | 12/20 [01:32<01:01,  7.72s/it]
Task 5, Epoch 13/20 => Loss 0.379, Train_accy 90.10:  60%|██████    | 12/20 [01:40<01:01,  7.72s/it]
Task 5, Epoch 13/20 => Loss 0.379, Train_accy 90.10:  65%|██████▌   | 13/20 [01:40<00:53,  7.70s/it]
Task 5, Epoch 14/20 => Loss 0.361, Train_accy 90.58:  65%|██████▌   | 13/20 [01:47<00:53,  7.70s/it]
Task 5, Epoch 14/20 => Loss 0.361, Train_accy 90.58:  70%|███████   | 14/20 [01:47<00:46,  7.67s/it]
Task 5, Epoch 15/20 => Loss 0.373, Train_accy 91.38:  70%|███████   | 14/20 [01:55<00:46,  7.67s/it]
Task 5, Epoch 15/20 => Loss 0.373, Train_accy 91.38:  75%|███████▌  | 15/20 [01:55<00:38,  7.65s/it]
Task 5, Epoch 16/20 => Loss 0.368, Train_accy 90.10:  75%|███████▌  | 15/20 [02:03<00:38,  7.65s/it]
Task 5, Epoch 16/20 => Loss 0.368, Train_accy 90.10:  80%|████████  | 16/20 [02:03<00:30,  7.64s/it]
Task 5, Epoch 17/20 => Loss 0.342, Train_accy 90.90:  80%|████████  | 16/20 [02:10<00:30,  7.64s/it]
Task 5, Epoch 17/20 => Loss 0.342, Train_accy 90.90:  85%|████████▌ | 17/20 [02:10<00:22,  7.63s/it]
Task 5, Epoch 18/20 => Loss 0.351, Train_accy 90.34:  85%|████████▌ | 17/20 [02:18<00:22,  7.63s/it]
Task 5, Epoch 18/20 => Loss 0.351, Train_accy 90.34:  90%|█████████ | 18/20 [02:18<00:15,  7.67s/it]
Task 5, Epoch 19/20 => Loss 0.372, Train_accy 90.74:  90%|█████████ | 18/20 [02:26<00:15,  7.67s/it]
Task 5, Epoch 19/20 => Loss 0.372, Train_accy 90.74:  95%|█████████▌| 19/20 [02:26<00:07,  7.67s/it]
Task 5, Epoch 20/20 => Loss 0.360, Train_accy 91.63:  95%|█████████▌| 19/20 [02:33<00:07,  7.67s/it]
Task 5, Epoch 20/20 => Loss 0.360, Train_accy 91.63: 100%|██████████| 20/20 [02:33<00:00,  7.68s/it]
Task 5, Epoch 20/20 => Loss 0.360, Train_accy 91.63: 100%|██████████| 20/20 [02:33<00:00,  7.70s/it]
2024-09-08 09:54:19,674 [ease.py] => Task 5, Epoch 20/20 => Loss 0.360, Train_accy 91.63
2024-09-08 09:55:18,491 [ease.py] => Task correct: 84.89880643487285
2024-09-08 09:55:18,492 [ease.py] => Task acc: 92.6829268292683
2024-09-08 09:55:18,518 [trainer.py] => No NME accuracy.
2024-09-08 09:55:18,518 [trainer.py] => CNN: {'total': 82.1, '00-09': 78.55, '10-19': 88.98, '20-29': 81.0, '30-39': 83.43, '40-49': 78.48, '50-59': 80.59, 'old': 82.38, 'new': 80.59}
2024-09-08 09:55:18,518 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1]
2024-09-08 09:55:18,518 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34]

Average Accuracy (CNN): 86.71
2024-09-08 09:55:18,518 [trainer.py] => Average Accuracy (CNN): 86.71 

2024-09-08 09:55:18,519 [trainer.py] => All params: 86387138
2024-09-08 09:55:18,520 [trainer.py] => Trainable params: 304320
2024-09-08 09:55:18,524 [ease.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.205, Train_accy 32.37:   0%|          | 0/20 [00:07<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.205, Train_accy 32.37:   5%|▌         | 1/20 [00:07<02:21,  7.46s/it]
Task 6, Epoch 2/20 => Loss 1.799, Train_accy 59.27:   5%|▌         | 1/20 [00:15<02:21,  7.46s/it]
Task 6, Epoch 2/20 => Loss 1.799, Train_accy 59.27:  10%|█         | 2/20 [00:15<02:15,  7.55s/it]
Task 6, Epoch 3/20 => Loss 1.337, Train_accy 77.90:  10%|█         | 2/20 [00:22<02:15,  7.55s/it]
Task 6, Epoch 3/20 => Loss 1.337, Train_accy 77.90:  15%|█▌        | 3/20 [00:22<02:07,  7.49s/it]
Task 6, Epoch 4/20 => Loss 1.101, Train_accy 77.73:  15%|█▌        | 3/20 [00:30<02:07,  7.49s/it]
Task 6, Epoch 4/20 => Loss 1.101, Train_accy 77.73:  20%|██        | 4/20 [00:30<02:00,  7.52s/it]
Task 6, Epoch 5/20 => Loss 0.871, Train_accy 82.12:  20%|██        | 4/20 [00:37<02:00,  7.52s/it]
Task 6, Epoch 5/20 => Loss 0.871, Train_accy 82.12:  25%|██▌       | 5/20 [00:37<01:52,  7.51s/it]
Task 6, Epoch 6/20 => Loss 0.762, Train_accy 82.20:  25%|██▌       | 5/20 [00:45<01:52,  7.51s/it]
Task 6, Epoch 6/20 => Loss 0.762, Train_accy 82.20:  30%|███       | 6/20 [00:45<01:44,  7.49s/it]
Task 6, Epoch 7/20 => Loss 0.651, Train_accy 83.94:  30%|███       | 6/20 [00:52<01:44,  7.49s/it]
Task 6, Epoch 7/20 => Loss 0.651, Train_accy 83.94:  35%|███▌      | 7/20 [00:52<01:37,  7.52s/it]
Task 6, Epoch 8/20 => Loss 0.560, Train_accy 87.09:  35%|███▌      | 7/20 [01:00<01:37,  7.52s/it]
Task 6, Epoch 8/20 => Loss 0.560, Train_accy 87.09:  40%|████      | 8/20 [01:00<01:29,  7.49s/it]
Task 6, Epoch 9/20 => Loss 0.501, Train_accy 88.49:  40%|████      | 8/20 [01:07<01:29,  7.49s/it]
Task 6, Epoch 9/20 => Loss 0.501, Train_accy 88.49:  45%|████▌     | 9/20 [01:07<01:22,  7.46s/it]
Task 6, Epoch 10/20 => Loss 0.498, Train_accy 87.17:  45%|████▌     | 9/20 [01:14<01:22,  7.46s/it]
Task 6, Epoch 10/20 => Loss 0.498, Train_accy 87.17:  50%|█████     | 10/20 [01:14<01:14,  7.48s/it]
Task 6, Epoch 11/20 => Loss 0.493, Train_accy 86.92:  50%|█████     | 10/20 [01:22<01:14,  7.48s/it]
Task 6, Epoch 11/20 => Loss 0.493, Train_accy 86.92:  55%|█████▌    | 11/20 [01:22<01:07,  7.47s/it]
Task 6, Epoch 12/20 => Loss 0.466, Train_accy 88.91:  55%|█████▌    | 11/20 [01:29<01:07,  7.47s/it]
Task 6, Epoch 12/20 => Loss 0.466, Train_accy 88.91:  60%|██████    | 12/20 [01:29<00:59,  7.49s/it]
Task 6, Epoch 13/20 => Loss 0.450, Train_accy 88.25:  60%|██████    | 12/20 [01:37<00:59,  7.49s/it]
Task 6, Epoch 13/20 => Loss 0.450, Train_accy 88.25:  65%|██████▌   | 13/20 [01:37<00:52,  7.48s/it]
Task 6, Epoch 14/20 => Loss 0.454, Train_accy 88.41:  65%|██████▌   | 13/20 [01:44<00:52,  7.48s/it]
Task 6, Epoch 14/20 => Loss 0.454, Train_accy 88.41:  70%|███████   | 14/20 [01:44<00:44,  7.47s/it]
Task 6, Epoch 15/20 => Loss 0.478, Train_accy 87.17:  70%|███████   | 14/20 [01:52<00:44,  7.47s/it]
Task 6, Epoch 15/20 => Loss 0.478, Train_accy 87.17:  75%|███████▌  | 15/20 [01:52<00:37,  7.46s/it]
Task 6, Epoch 16/20 => Loss 0.390, Train_accy 90.40:  75%|███████▌  | 15/20 [01:59<00:37,  7.46s/it]
Task 6, Epoch 16/20 => Loss 0.390, Train_accy 90.40:  80%|████████  | 16/20 [01:59<00:29,  7.46s/it]
Task 6, Epoch 17/20 => Loss 0.392, Train_accy 89.57:  80%|████████  | 16/20 [02:07<00:29,  7.46s/it]
Task 6, Epoch 17/20 => Loss 0.392, Train_accy 89.57:  85%|████████▌ | 17/20 [02:07<00:22,  7.48s/it]
Task 6, Epoch 18/20 => Loss 0.389, Train_accy 90.23:  85%|████████▌ | 17/20 [02:14<00:22,  7.48s/it]
Task 6, Epoch 18/20 => Loss 0.389, Train_accy 90.23:  90%|█████████ | 18/20 [02:14<00:14,  7.46s/it]
Task 6, Epoch 19/20 => Loss 0.434, Train_accy 89.16:  90%|█████████ | 18/20 [02:22<00:14,  7.46s/it]
Task 6, Epoch 19/20 => Loss 0.434, Train_accy 89.16:  95%|█████████▌| 19/20 [02:22<00:07,  7.46s/it]
Task 6, Epoch 20/20 => Loss 0.446, Train_accy 88.33:  95%|█████████▌| 19/20 [02:29<00:07,  7.46s/it]
Task 6, Epoch 20/20 => Loss 0.446, Train_accy 88.33: 100%|██████████| 20/20 [02:29<00:00,  7.46s/it]
Task 6, Epoch 20/20 => Loss 0.446, Train_accy 88.33: 100%|██████████| 20/20 [02:29<00:00,  7.48s/it]
2024-09-08 09:57:48,094 [ease.py] => Task 6, Epoch 20/20 => Loss 0.446, Train_accy 88.33
2024-09-08 09:59:01,629 [ease.py] => Task correct: 83.37078651685393
2024-09-08 09:59:01,629 [ease.py] => Task acc: 92.53932584269663
2024-09-08 09:59:01,656 [trainer.py] => No NME accuracy.
2024-09-08 09:59:01,656 [trainer.py] => CNN: {'total': 80.85, '00-09': 76.97, '10-19': 88.44, '20-29': 80.33, '30-39': 82.83, '40-49': 77.48, '50-59': 79.61, '60-69': 78.52, 'old': 81.21, 'new': 78.52}
2024-09-08 09:59:01,656 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85]
2024-09-08 09:59:01,656 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66]

Average Accuracy (CNN): 85.87
2024-09-08 09:59:01,656 [trainer.py] => Average Accuracy (CNN): 85.87 

2024-09-08 09:59:01,657 [trainer.py] => All params: 86486978
2024-09-08 09:59:01,658 [trainer.py] => Trainable params: 304320
2024-09-08 09:59:01,663 [ease.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.197, Train_accy 38.25:   0%|          | 0/20 [00:06<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.197, Train_accy 38.25:   5%|▌         | 1/20 [00:06<02:08,  6.74s/it]
Task 7, Epoch 2/20 => Loss 1.729, Train_accy 63.59:   5%|▌         | 1/20 [00:13<02:08,  6.74s/it]
Task 7, Epoch 2/20 => Loss 1.729, Train_accy 63.59:  10%|█         | 2/20 [00:13<02:00,  6.72s/it]
Task 7, Epoch 3/20 => Loss 1.238, Train_accy 77.42:  10%|█         | 2/20 [00:20<02:00,  6.72s/it]
Task 7, Epoch 3/20 => Loss 1.238, Train_accy 77.42:  15%|█▌        | 3/20 [00:20<01:54,  6.72s/it]
Task 7, Epoch 4/20 => Loss 0.969, Train_accy 81.84:  15%|█▌        | 3/20 [00:26<01:54,  6.72s/it]
Task 7, Epoch 4/20 => Loss 0.969, Train_accy 81.84:  20%|██        | 4/20 [00:26<01:47,  6.72s/it]
Task 7, Epoch 5/20 => Loss 0.778, Train_accy 83.41:  20%|██        | 4/20 [00:33<01:47,  6.72s/it]
Task 7, Epoch 5/20 => Loss 0.778, Train_accy 83.41:  25%|██▌       | 5/20 [00:33<01:40,  6.73s/it]
Task 7, Epoch 6/20 => Loss 0.653, Train_accy 86.18:  25%|██▌       | 5/20 [00:40<01:40,  6.73s/it]
Task 7, Epoch 6/20 => Loss 0.653, Train_accy 86.18:  30%|███       | 6/20 [00:40<01:34,  6.72s/it]
Task 7, Epoch 7/20 => Loss 0.587, Train_accy 86.82:  30%|███       | 6/20 [00:47<01:34,  6.72s/it]
Task 7, Epoch 7/20 => Loss 0.587, Train_accy 86.82:  35%|███▌      | 7/20 [00:47<01:27,  6.74s/it]
Task 7, Epoch 8/20 => Loss 0.512, Train_accy 87.10:  35%|███▌      | 7/20 [00:53<01:27,  6.74s/it]
Task 7, Epoch 8/20 => Loss 0.512, Train_accy 87.10:  40%|████      | 8/20 [00:53<01:20,  6.73s/it]
Task 7, Epoch 9/20 => Loss 0.454, Train_accy 89.31:  40%|████      | 8/20 [01:00<01:20,  6.73s/it]
Task 7, Epoch 9/20 => Loss 0.454, Train_accy 89.31:  45%|████▌     | 9/20 [01:00<01:13,  6.72s/it]
Task 7, Epoch 10/20 => Loss 0.439, Train_accy 89.95:  45%|████▌     | 9/20 [01:07<01:13,  6.72s/it]
Task 7, Epoch 10/20 => Loss 0.439, Train_accy 89.95:  50%|█████     | 10/20 [01:07<01:07,  6.72s/it]
Task 7, Epoch 11/20 => Loss 0.424, Train_accy 89.12:  50%|█████     | 10/20 [01:13<01:07,  6.72s/it]
Task 7, Epoch 11/20 => Loss 0.424, Train_accy 89.12:  55%|█████▌    | 11/20 [01:13<01:00,  6.73s/it]
Task 7, Epoch 12/20 => Loss 0.385, Train_accy 91.15:  55%|█████▌    | 11/20 [01:20<01:00,  6.73s/it]
Task 7, Epoch 12/20 => Loss 0.385, Train_accy 91.15:  60%|██████    | 12/20 [01:20<00:53,  6.72s/it]
Task 7, Epoch 13/20 => Loss 0.372, Train_accy 90.69:  60%|██████    | 12/20 [01:27<00:53,  6.72s/it]
Task 7, Epoch 13/20 => Loss 0.372, Train_accy 90.69:  65%|██████▌   | 13/20 [01:27<00:47,  6.72s/it]
Task 7, Epoch 14/20 => Loss 0.370, Train_accy 90.97:  65%|██████▌   | 13/20 [01:34<00:47,  6.72s/it]
Task 7, Epoch 14/20 => Loss 0.370, Train_accy 90.97:  70%|███████   | 14/20 [01:34<00:40,  6.74s/it]
Task 7, Epoch 15/20 => Loss 0.348, Train_accy 91.80:  70%|███████   | 14/20 [01:40<00:40,  6.74s/it]
Task 7, Epoch 15/20 => Loss 0.348, Train_accy 91.80:  75%|███████▌  | 15/20 [01:40<00:33,  6.73s/it]
Task 7, Epoch 16/20 => Loss 0.358, Train_accy 92.17:  75%|███████▌  | 15/20 [01:47<00:33,  6.73s/it]
Task 7, Epoch 16/20 => Loss 0.358, Train_accy 92.17:  80%|████████  | 16/20 [01:47<00:26,  6.73s/it]
Task 7, Epoch 17/20 => Loss 0.356, Train_accy 91.43:  80%|████████  | 16/20 [01:54<00:26,  6.73s/it]
Task 7, Epoch 17/20 => Loss 0.356, Train_accy 91.43:  85%|████████▌ | 17/20 [01:54<00:20,  6.75s/it]
Task 7, Epoch 18/20 => Loss 0.362, Train_accy 91.80:  85%|████████▌ | 17/20 [02:01<00:20,  6.75s/it]
Task 7, Epoch 18/20 => Loss 0.362, Train_accy 91.80:  90%|█████████ | 18/20 [02:01<00:13,  6.75s/it]
Task 7, Epoch 19/20 => Loss 0.343, Train_accy 91.98:  90%|█████████ | 18/20 [02:07<00:13,  6.75s/it]
Task 7, Epoch 19/20 => Loss 0.343, Train_accy 91.98:  95%|█████████▌| 19/20 [02:07<00:06,  6.73s/it]
Task 7, Epoch 20/20 => Loss 0.347, Train_accy 91.98:  95%|█████████▌| 19/20 [02:14<00:06,  6.73s/it]
Task 7, Epoch 20/20 => Loss 0.347, Train_accy 91.98: 100%|██████████| 20/20 [02:14<00:00,  6.73s/it]
Task 7, Epoch 20/20 => Loss 0.347, Train_accy 91.98: 100%|██████████| 20/20 [02:14<00:00,  6.73s/it]
2024-09-08 10:01:16,251 [ease.py] => Task 7, Epoch 20/20 => Loss 0.347, Train_accy 91.98
2024-09-08 10:02:43,133 [ease.py] => Task correct: 82.2658126501201
2024-09-08 10:02:43,134 [ease.py] => Task acc: 92.47397918334667
2024-09-08 10:02:43,162 [trainer.py] => No NME accuracy.
2024-09-08 10:02:43,162 [trainer.py] => CNN: {'total': 79.94, '00-09': 74.76, '10-19': 87.63, '20-29': 80.33, '30-39': 82.53, '40-49': 75.83, '50-59': 78.95, '60-69': 77.18, '70-79': 80.59, 'old': 79.87, 'new': 80.59}
2024-09-08 10:02:43,162 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94]
2024-09-08 10:02:43,162 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79]

Average Accuracy (CNN): 85.13
2024-09-08 10:02:43,162 [trainer.py] => Average Accuracy (CNN): 85.13 

2024-09-08 10:02:43,163 [trainer.py] => All params: 86602178
2024-09-08 10:02:43,164 [trainer.py] => Trainable params: 304320
2024-09-08 10:02:43,171 [ease.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.162, Train_accy 42.66:   0%|          | 0/20 [00:08<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.162, Train_accy 42.66:   5%|▌         | 1/20 [00:08<02:43,  8.61s/it]
Task 8, Epoch 2/20 => Loss 1.600, Train_accy 67.87:   5%|▌         | 1/20 [00:17<02:43,  8.61s/it]
Task 8, Epoch 2/20 => Loss 1.600, Train_accy 67.87:  10%|█         | 2/20 [00:17<02:35,  8.62s/it]
Task 8, Epoch 3/20 => Loss 1.190, Train_accy 75.85:  10%|█         | 2/20 [00:25<02:35,  8.62s/it]
Task 8, Epoch 3/20 => Loss 1.190, Train_accy 75.85:  15%|█▌        | 3/20 [00:25<02:26,  8.63s/it]
Task 8, Epoch 4/20 => Loss 0.916, Train_accy 79.52:  15%|█▌        | 3/20 [00:34<02:26,  8.63s/it]
Task 8, Epoch 4/20 => Loss 0.916, Train_accy 79.52:  20%|██        | 4/20 [00:34<02:18,  8.65s/it]
Task 8, Epoch 5/20 => Loss 0.715, Train_accy 83.05:  20%|██        | 4/20 [00:43<02:18,  8.65s/it]
Task 8, Epoch 5/20 => Loss 0.715, Train_accy 83.05:  25%|██▌       | 5/20 [00:43<02:09,  8.66s/it]
Task 8, Epoch 6/20 => Loss 0.571, Train_accy 85.81:  25%|██▌       | 5/20 [00:51<02:09,  8.66s/it]
Task 8, Epoch 6/20 => Loss 0.571, Train_accy 85.81:  30%|███       | 6/20 [00:51<02:01,  8.65s/it]
Task 8, Epoch 7/20 => Loss 0.526, Train_accy 86.58:  30%|███       | 6/20 [01:00<02:01,  8.65s/it]
Task 8, Epoch 7/20 => Loss 0.526, Train_accy 86.58:  35%|███▌      | 7/20 [01:00<01:52,  8.66s/it]
Task 8, Epoch 8/20 => Loss 0.506, Train_accy 86.51:  35%|███▌      | 7/20 [01:09<01:52,  8.66s/it]
Task 8, Epoch 8/20 => Loss 0.506, Train_accy 86.51:  40%|████      | 8/20 [01:09<01:44,  8.68s/it]
Task 8, Epoch 9/20 => Loss 0.475, Train_accy 87.57:  40%|████      | 8/20 [01:17<01:44,  8.68s/it]
Task 8, Epoch 9/20 => Loss 0.475, Train_accy 87.57:  45%|████▌     | 9/20 [01:17<01:35,  8.69s/it]
Task 8, Epoch 10/20 => Loss 0.470, Train_accy 87.92:  45%|████▌     | 9/20 [01:26<01:35,  8.69s/it]
Task 8, Epoch 10/20 => Loss 0.470, Train_accy 87.92:  50%|█████     | 10/20 [01:26<01:26,  8.69s/it]
Task 8, Epoch 11/20 => Loss 0.435, Train_accy 89.34:  50%|█████     | 10/20 [01:35<01:26,  8.69s/it]
Task 8, Epoch 11/20 => Loss 0.435, Train_accy 89.34:  55%|█████▌    | 11/20 [01:35<01:18,  8.70s/it]
Task 8, Epoch 12/20 => Loss 0.445, Train_accy 87.50:  55%|█████▌    | 11/20 [01:44<01:18,  8.70s/it]
Task 8, Epoch 12/20 => Loss 0.445, Train_accy 87.50:  60%|██████    | 12/20 [01:44<01:09,  8.71s/it]
Task 8, Epoch 13/20 => Loss 0.402, Train_accy 88.70:  60%|██████    | 12/20 [01:52<01:09,  8.71s/it]
Task 8, Epoch 13/20 => Loss 0.402, Train_accy 88.70:  65%|██████▌   | 13/20 [01:52<01:00,  8.69s/it]
Task 8, Epoch 14/20 => Loss 0.430, Train_accy 88.49:  65%|██████▌   | 13/20 [02:01<01:00,  8.69s/it]
Task 8, Epoch 14/20 => Loss 0.430, Train_accy 88.49:  70%|███████   | 14/20 [02:01<00:52,  8.67s/it]
Task 8, Epoch 15/20 => Loss 0.393, Train_accy 89.62:  70%|███████   | 14/20 [02:10<00:52,  8.67s/it]
Task 8, Epoch 15/20 => Loss 0.393, Train_accy 89.62:  75%|███████▌  | 15/20 [02:10<00:43,  8.66s/it]
Task 8, Epoch 16/20 => Loss 0.413, Train_accy 88.84:  75%|███████▌  | 15/20 [02:18<00:43,  8.66s/it]
Task 8, Epoch 16/20 => Loss 0.413, Train_accy 88.84:  80%|████████  | 16/20 [02:18<00:34,  8.66s/it]
Task 8, Epoch 17/20 => Loss 0.392, Train_accy 89.05:  80%|████████  | 16/20 [02:27<00:34,  8.66s/it]
Task 8, Epoch 17/20 => Loss 0.392, Train_accy 89.05:  85%|████████▌ | 17/20 [02:27<00:26,  8.67s/it]
Task 8, Epoch 18/20 => Loss 0.384, Train_accy 89.76:  85%|████████▌ | 17/20 [02:36<00:26,  8.67s/it]
Task 8, Epoch 18/20 => Loss 0.384, Train_accy 89.76:  90%|█████████ | 18/20 [02:36<00:17,  8.68s/it]
Task 8, Epoch 19/20 => Loss 0.371, Train_accy 89.97:  90%|█████████ | 18/20 [02:44<00:17,  8.68s/it]
Task 8, Epoch 19/20 => Loss 0.371, Train_accy 89.97:  95%|█████████▌| 19/20 [02:44<00:08,  8.68s/it]
Task 8, Epoch 20/20 => Loss 0.385, Train_accy 89.76:  95%|█████████▌| 19/20 [02:53<00:08,  8.68s/it]
Task 8, Epoch 20/20 => Loss 0.385, Train_accy 89.76: 100%|██████████| 20/20 [02:53<00:00,  8.69s/it]
Task 8, Epoch 20/20 => Loss 0.385, Train_accy 89.76: 100%|██████████| 20/20 [02:53<00:00,  8.68s/it]
2024-09-08 10:05:36,691 [ease.py] => Task 8, Epoch 20/20 => Loss 0.385, Train_accy 89.76
2024-09-08 10:07:31,254 [ease.py] => Task correct: 80.62678062678063
2024-09-08 10:07:31,255 [ease.py] => Task acc: 92.41452991452991
2024-09-08 10:07:31,276 [trainer.py] => No NME accuracy.
2024-09-08 10:07:31,276 [trainer.py] => CNN: {'total': 78.56, '00-09': 73.5, '10-19': 86.83, '20-29': 79.0, '30-39': 82.23, '40-49': 73.18, '50-59': 78.62, '60-69': 74.5, '70-79': 79.49, '80-89': 77.74, 'old': 78.66, 'new': 77.74}
2024-09-08 10:07:31,276 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56]
2024-09-08 10:07:31,277 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92]

Average Accuracy (CNN): 84.4
2024-09-08 10:07:31,277 [trainer.py] => Average Accuracy (CNN): 84.4 

2024-09-08 10:07:31,277 [trainer.py] => All params: 86732738
2024-09-08 10:07:31,278 [trainer.py] => Trainable params: 304320
2024-09-08 10:07:31,285 [ease.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.257, Train_accy 32.67:   0%|          | 0/20 [00:04<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.257, Train_accy 32.67:   5%|▌         | 1/20 [00:04<01:31,  4.80s/it]
Task 9, Epoch 2/20 => Loss 2.046, Train_accy 56.26:   5%|▌         | 1/20 [00:09<01:31,  4.80s/it]
Task 9, Epoch 2/20 => Loss 2.046, Train_accy 56.26:  10%|█         | 2/20 [00:09<01:26,  4.81s/it]
Task 9, Epoch 3/20 => Loss 1.703, Train_accy 65.74:  10%|█         | 2/20 [00:14<01:26,  4.81s/it]
Task 9, Epoch 3/20 => Loss 1.703, Train_accy 65.74:  15%|█▌        | 3/20 [00:14<01:21,  4.80s/it]
Task 9, Epoch 4/20 => Loss 1.383, Train_accy 74.70:  15%|█▌        | 3/20 [00:19<01:21,  4.80s/it]
Task 9, Epoch 4/20 => Loss 1.383, Train_accy 74.70:  20%|██        | 4/20 [00:19<01:16,  4.80s/it]
Task 9, Epoch 5/20 => Loss 1.174, Train_accy 79.97:  20%|██        | 4/20 [00:24<01:16,  4.80s/it]
Task 9, Epoch 5/20 => Loss 1.174, Train_accy 79.97:  25%|██▌       | 5/20 [00:24<01:12,  4.85s/it]
Task 9, Epoch 6/20 => Loss 0.981, Train_accy 81.42:  25%|██▌       | 5/20 [00:28<01:12,  4.85s/it]
Task 9, Epoch 6/20 => Loss 0.981, Train_accy 81.42:  30%|███       | 6/20 [00:28<01:07,  4.84s/it]
Task 9, Epoch 7/20 => Loss 0.860, Train_accy 81.69:  30%|███       | 6/20 [00:33<01:07,  4.84s/it]
Task 9, Epoch 7/20 => Loss 0.860, Train_accy 81.69:  35%|███▌      | 7/20 [00:33<01:02,  4.83s/it]
Task 9, Epoch 8/20 => Loss 0.777, Train_accy 84.85:  35%|███▌      | 7/20 [00:38<01:02,  4.83s/it]
Task 9, Epoch 8/20 => Loss 0.777, Train_accy 84.85:  40%|████      | 8/20 [00:38<00:58,  4.85s/it]
Task 9, Epoch 9/20 => Loss 0.721, Train_accy 85.11:  40%|████      | 8/20 [00:43<00:58,  4.85s/it]
Task 9, Epoch 9/20 => Loss 0.721, Train_accy 85.11:  45%|████▌     | 9/20 [00:43<00:53,  4.84s/it]
Task 9, Epoch 10/20 => Loss 0.652, Train_accy 88.67:  45%|████▌     | 9/20 [00:48<00:53,  4.84s/it]
Task 9, Epoch 10/20 => Loss 0.652, Train_accy 88.67:  50%|█████     | 10/20 [00:48<00:48,  4.86s/it]
Task 9, Epoch 11/20 => Loss 0.621, Train_accy 87.75:  50%|█████     | 10/20 [00:53<00:48,  4.86s/it]
Task 9, Epoch 11/20 => Loss 0.621, Train_accy 87.75:  55%|█████▌    | 11/20 [00:53<00:43,  4.84s/it]
Task 9, Epoch 12/20 => Loss 0.597, Train_accy 87.88:  55%|█████▌    | 11/20 [00:58<00:43,  4.84s/it]
Task 9, Epoch 12/20 => Loss 0.597, Train_accy 87.88:  60%|██████    | 12/20 [00:58<00:38,  4.86s/it]
Task 9, Epoch 13/20 => Loss 0.583, Train_accy 88.01:  60%|██████    | 12/20 [01:02<00:38,  4.86s/it]
Task 9, Epoch 13/20 => Loss 0.583, Train_accy 88.01:  65%|██████▌   | 13/20 [01:02<00:33,  4.85s/it]
Task 9, Epoch 14/20 => Loss 0.545, Train_accy 90.12:  65%|██████▌   | 13/20 [01:07<00:33,  4.85s/it]
Task 9, Epoch 14/20 => Loss 0.545, Train_accy 90.12:  70%|███████   | 14/20 [01:07<00:29,  4.85s/it]
Task 9, Epoch 15/20 => Loss 0.540, Train_accy 88.54:  70%|███████   | 14/20 [01:12<00:29,  4.85s/it]
Task 9, Epoch 15/20 => Loss 0.540, Train_accy 88.54:  75%|███████▌  | 15/20 [01:12<00:24,  4.86s/it]
Task 9, Epoch 16/20 => Loss 0.493, Train_accy 90.25:  75%|███████▌  | 15/20 [01:17<00:24,  4.86s/it]
Task 9, Epoch 16/20 => Loss 0.493, Train_accy 90.25:  80%|████████  | 16/20 [01:17<00:19,  4.85s/it]
Task 9, Epoch 17/20 => Loss 0.523, Train_accy 89.20:  80%|████████  | 16/20 [01:22<00:19,  4.85s/it]
Task 9, Epoch 17/20 => Loss 0.523, Train_accy 89.20:  85%|████████▌ | 17/20 [01:22<00:14,  4.85s/it]
Task 9, Epoch 18/20 => Loss 0.546, Train_accy 87.75:  85%|████████▌ | 17/20 [01:27<00:14,  4.85s/it]
Task 9, Epoch 18/20 => Loss 0.546, Train_accy 87.75:  90%|█████████ | 18/20 [01:27<00:09,  4.84s/it]
Task 9, Epoch 19/20 => Loss 0.516, Train_accy 90.12:  90%|█████████ | 18/20 [01:31<00:09,  4.84s/it]
Task 9, Epoch 19/20 => Loss 0.516, Train_accy 90.12:  95%|█████████▌| 19/20 [01:31<00:04,  4.84s/it]
Task 9, Epoch 20/20 => Loss 0.502, Train_accy 89.72:  95%|█████████▌| 19/20 [01:36<00:04,  4.84s/it]
Task 9, Epoch 20/20 => Loss 0.502, Train_accy 89.72: 100%|██████████| 20/20 [01:36<00:00,  4.84s/it]
Task 9, Epoch 20/20 => Loss 0.502, Train_accy 89.72: 100%|██████████| 20/20 [01:36<00:00,  4.84s/it]
2024-09-08 10:09:08,120 [ease.py] => Task 9, Epoch 20/20 => Loss 0.502, Train_accy 89.72
2024-09-08 10:11:00,563 [ease.py] => Task correct: 79.39698492462311
2024-09-08 10:11:00,563 [ease.py] => Task acc: 92.26130653266331
2024-09-08 10:11:00,585 [trainer.py] => No NME accuracy.
2024-09-08 10:11:00,585 [trainer.py] => CNN: {'total': 77.45, '00-09': 74.13, '10-19': 86.56, '20-29': 78.67, '30-39': 82.23, '40-49': 72.19, '50-59': 78.29, '60-69': 73.83, '70-79': 77.66, '80-89': 78.06, '90-99': 65.54, 'old': 78.21, 'new': 65.54}
2024-09-08 10:11:00,585 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45]
2024-09-08 10:11:00,585 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19]

Average Accuracy (CNN): 83.71
2024-09-08 10:11:00,585 [trainer.py] => Average Accuracy (CNN): 83.71 

2024-09-08 10:11:00,586 [trainer.py] => All params: 86878658
2024-09-08 10:11:00,587 [trainer.py] => Trainable params: 304320
2024-09-08 10:11:00,596 [ease.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.208, Train_accy 43.25:   0%|          | 0/20 [00:07<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.208, Train_accy 43.25:   5%|▌         | 1/20 [00:07<02:19,  7.35s/it]
Task 10, Epoch 2/20 => Loss 1.749, Train_accy 74.36:   5%|▌         | 1/20 [00:14<02:19,  7.35s/it]
Task 10, Epoch 2/20 => Loss 1.749, Train_accy 74.36:  10%|█         | 2/20 [00:14<02:10,  7.26s/it]
Task 10, Epoch 3/20 => Loss 1.253, Train_accy 80.68:  10%|█         | 2/20 [00:21<02:10,  7.26s/it]
Task 10, Epoch 3/20 => Loss 1.253, Train_accy 80.68:  15%|█▌        | 3/20 [00:21<02:02,  7.23s/it]
Task 10, Epoch 4/20 => Loss 0.983, Train_accy 80.85:  15%|█▌        | 3/20 [00:28<02:02,  7.23s/it]
Task 10, Epoch 4/20 => Loss 0.983, Train_accy 80.85:  20%|██        | 4/20 [00:28<01:55,  7.21s/it]
Task 10, Epoch 5/20 => Loss 0.779, Train_accy 83.08:  20%|██        | 4/20 [00:36<01:55,  7.21s/it]
Task 10, Epoch 5/20 => Loss 0.779, Train_accy 83.08:  25%|██▌       | 5/20 [00:36<01:48,  7.22s/it]
Task 10, Epoch 6/20 => Loss 0.651, Train_accy 85.47:  25%|██▌       | 5/20 [00:43<01:48,  7.22s/it]
Task 10, Epoch 6/20 => Loss 0.651, Train_accy 85.47:  30%|███       | 6/20 [00:43<01:41,  7.27s/it]
Task 10, Epoch 7/20 => Loss 0.537, Train_accy 88.46:  30%|███       | 6/20 [00:50<01:41,  7.27s/it]
Task 10, Epoch 7/20 => Loss 0.537, Train_accy 88.46:  35%|███▌      | 7/20 [00:50<01:35,  7.32s/it]
Task 10, Epoch 8/20 => Loss 0.483, Train_accy 89.23:  35%|███▌      | 7/20 [00:58<01:35,  7.32s/it]
Task 10, Epoch 8/20 => Loss 0.483, Train_accy 89.23:  40%|████      | 8/20 [00:58<01:27,  7.32s/it]
Task 10, Epoch 9/20 => Loss 0.448, Train_accy 89.23:  40%|████      | 8/20 [01:05<01:27,  7.32s/it]
Task 10, Epoch 9/20 => Loss 0.448, Train_accy 89.23:  45%|████▌     | 9/20 [01:05<01:20,  7.30s/it]
Task 10, Epoch 10/20 => Loss 0.439, Train_accy 89.40:  45%|████▌     | 9/20 [01:12<01:20,  7.30s/it]
Task 10, Epoch 10/20 => Loss 0.439, Train_accy 89.40:  50%|█████     | 10/20 [01:12<01:12,  7.29s/it]
Task 10, Epoch 11/20 => Loss 0.399, Train_accy 90.43:  50%|█████     | 10/20 [01:20<01:12,  7.29s/it]
Task 10, Epoch 11/20 => Loss 0.399, Train_accy 90.43:  55%|█████▌    | 11/20 [01:20<01:05,  7.28s/it]
Task 10, Epoch 12/20 => Loss 0.406, Train_accy 90.17:  55%|█████▌    | 11/20 [01:27<01:05,  7.28s/it]
Task 10, Epoch 12/20 => Loss 0.406, Train_accy 90.17:  60%|██████    | 12/20 [01:27<00:58,  7.26s/it]
Task 10, Epoch 13/20 => Loss 0.390, Train_accy 89.40:  60%|██████    | 12/20 [01:34<00:58,  7.26s/it]
Task 10, Epoch 13/20 => Loss 0.390, Train_accy 89.40:  65%|██████▌   | 13/20 [01:34<00:50,  7.28s/it]
Task 10, Epoch 14/20 => Loss 0.390, Train_accy 90.17:  65%|██████▌   | 13/20 [01:41<00:50,  7.28s/it]
Task 10, Epoch 14/20 => Loss 0.390, Train_accy 90.17:  70%|███████   | 14/20 [01:41<00:43,  7.26s/it]
Task 10, Epoch 15/20 => Loss 0.355, Train_accy 91.20:  70%|███████   | 14/20 [01:49<00:43,  7.26s/it]
Task 10, Epoch 15/20 => Loss 0.355, Train_accy 91.20:  75%|███████▌  | 15/20 [01:49<00:36,  7.26s/it]
Task 10, Epoch 16/20 => Loss 0.357, Train_accy 91.45:  75%|███████▌  | 15/20 [01:56<00:36,  7.26s/it]
Task 10, Epoch 16/20 => Loss 0.357, Train_accy 91.45:  80%|████████  | 16/20 [01:56<00:29,  7.27s/it]
Task 10, Epoch 17/20 => Loss 0.381, Train_accy 90.26:  80%|████████  | 16/20 [02:03<00:29,  7.27s/it]
Task 10, Epoch 17/20 => Loss 0.381, Train_accy 90.26:  85%|████████▌ | 17/20 [02:03<00:21,  7.25s/it]
Task 10, Epoch 18/20 => Loss 0.351, Train_accy 91.28:  85%|████████▌ | 17/20 [02:10<00:21,  7.25s/it]
Task 10, Epoch 18/20 => Loss 0.351, Train_accy 91.28:  90%|█████████ | 18/20 [02:10<00:14,  7.27s/it]
Task 10, Epoch 19/20 => Loss 0.359, Train_accy 91.37:  90%|█████████ | 18/20 [02:18<00:14,  7.27s/it]
Task 10, Epoch 19/20 => Loss 0.359, Train_accy 91.37:  95%|█████████▌| 19/20 [02:18<00:07,  7.24s/it]
Task 10, Epoch 20/20 => Loss 0.345, Train_accy 91.20:  95%|█████████▌| 19/20 [02:25<00:07,  7.24s/it]
Task 10, Epoch 20/20 => Loss 0.345, Train_accy 91.20: 100%|██████████| 20/20 [02:25<00:00,  7.23s/it]
Task 10, Epoch 20/20 => Loss 0.345, Train_accy 91.20: 100%|██████████| 20/20 [02:25<00:00,  7.26s/it]
2024-09-08 10:13:25,847 [ease.py] => Task 10, Epoch 20/20 => Loss 0.345, Train_accy 91.20
2024-09-08 10:15:52,965 [ease.py] => Task correct: 78.73967574181707
2024-09-08 10:15:52,965 [ease.py] => Task acc: 92.13826858366473
2024-09-08 10:15:52,993 [trainer.py] => No NME accuracy.
2024-09-08 10:15:52,993 [trainer.py] => CNN: {'total': 76.69, '00-09': 73.5, '10-19': 86.83, '20-29': 78.33, '30-39': 81.93, '40-49': 71.52, '50-59': 77.63, '60-69': 73.15, '70-79': 75.09, '80-89': 76.77, '90-99': 64.97, '100-109': 76.06, 'old': 76.75, 'new': 76.06}
2024-09-08 10:15:52,994 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69]
2024-09-08 10:15:52,994 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88]

Average Accuracy (CNN): 83.07
2024-09-08 10:15:52,994 [trainer.py] => Average Accuracy (CNN): 83.07 

2024-09-08 10:15:52,994 [trainer.py] => All params: 87039938
2024-09-08 10:15:52,995 [trainer.py] => Trainable params: 304320
2024-09-08 10:15:53,005 [ease.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.118, Train_accy 42.07:   0%|          | 0/20 [00:09<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.118, Train_accy 42.07:   5%|▌         | 1/20 [00:09<02:53,  9.15s/it]
Task 11, Epoch 2/20 => Loss 1.453, Train_accy 67.63:   5%|▌         | 1/20 [00:18<02:53,  9.15s/it]
Task 11, Epoch 2/20 => Loss 1.453, Train_accy 67.63:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]
Task 11, Epoch 3/20 => Loss 1.029, Train_accy 78.66:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]
Task 11, Epoch 3/20 => Loss 1.029, Train_accy 78.66:  15%|█▌        | 3/20 [00:27<02:35,  9.13s/it]
Task 11, Epoch 4/20 => Loss 0.758, Train_accy 82.94:  15%|█▌        | 3/20 [00:36<02:35,  9.13s/it]
Task 11, Epoch 4/20 => Loss 0.758, Train_accy 82.94:  20%|██        | 4/20 [00:36<02:25,  9.11s/it]
Task 11, Epoch 5/20 => Loss 0.585, Train_accy 86.02:  20%|██        | 4/20 [00:45<02:25,  9.11s/it]
Task 11, Epoch 5/20 => Loss 0.585, Train_accy 86.02:  25%|██▌       | 5/20 [00:45<02:16,  9.10s/it]
Task 11, Epoch 6/20 => Loss 0.488, Train_accy 87.49:  25%|██▌       | 5/20 [00:54<02:16,  9.10s/it]
Task 11, Epoch 6/20 => Loss 0.488, Train_accy 87.49:  30%|███       | 6/20 [00:54<02:08,  9.15s/it]
Task 11, Epoch 7/20 => Loss 0.425, Train_accy 88.70:  30%|███       | 6/20 [01:03<02:08,  9.15s/it]
Task 11, Epoch 7/20 => Loss 0.425, Train_accy 88.70:  35%|███▌      | 7/20 [01:03<01:59,  9.16s/it]
Task 11, Epoch 8/20 => Loss 0.399, Train_accy 88.76:  35%|███▌      | 7/20 [01:13<01:59,  9.16s/it]
Task 11, Epoch 8/20 => Loss 0.399, Train_accy 88.76:  40%|████      | 8/20 [01:13<01:50,  9.18s/it]
Task 11, Epoch 9/20 => Loss 0.384, Train_accy 90.03:  40%|████      | 8/20 [01:22<01:50,  9.18s/it]
Task 11, Epoch 9/20 => Loss 0.384, Train_accy 90.03:  45%|████▌     | 9/20 [01:22<01:40,  9.17s/it]
Task 11, Epoch 10/20 => Loss 0.381, Train_accy 90.23:  45%|████▌     | 9/20 [01:31<01:40,  9.17s/it]
Task 11, Epoch 10/20 => Loss 0.381, Train_accy 90.23:  50%|█████     | 10/20 [01:31<01:31,  9.16s/it]
Task 11, Epoch 11/20 => Loss 0.380, Train_accy 90.10:  50%|█████     | 10/20 [01:40<01:31,  9.16s/it]
Task 11, Epoch 11/20 => Loss 0.380, Train_accy 90.10:  55%|█████▌    | 11/20 [01:40<01:22,  9.18s/it]
Task 11, Epoch 12/20 => Loss 0.353, Train_accy 90.23:  55%|█████▌    | 11/20 [01:49<01:22,  9.18s/it]
Task 11, Epoch 12/20 => Loss 0.353, Train_accy 90.23:  60%|██████    | 12/20 [01:49<01:13,  9.18s/it]
Task 11, Epoch 13/20 => Loss 0.323, Train_accy 90.50:  60%|██████    | 12/20 [01:59<01:13,  9.18s/it]
Task 11, Epoch 13/20 => Loss 0.323, Train_accy 90.50:  65%|██████▌   | 13/20 [01:59<01:04,  9.18s/it]
Task 11, Epoch 14/20 => Loss 0.327, Train_accy 90.03:  65%|██████▌   | 13/20 [02:08<01:04,  9.18s/it]
Task 11, Epoch 14/20 => Loss 0.327, Train_accy 90.03:  70%|███████   | 14/20 [02:08<00:55,  9.17s/it]
Task 11, Epoch 15/20 => Loss 0.309, Train_accy 92.17:  70%|███████   | 14/20 [02:17<00:55,  9.17s/it]
Task 11, Epoch 15/20 => Loss 0.309, Train_accy 92.17:  75%|███████▌  | 15/20 [02:17<00:45,  9.16s/it]
Task 11, Epoch 16/20 => Loss 0.349, Train_accy 90.70:  75%|███████▌  | 15/20 [02:26<00:45,  9.16s/it]
Task 11, Epoch 16/20 => Loss 0.349, Train_accy 90.70:  80%|████████  | 16/20 [02:26<00:36,  9.16s/it]
Task 11, Epoch 17/20 => Loss 0.303, Train_accy 91.57:  80%|████████  | 16/20 [02:35<00:36,  9.16s/it]
Task 11, Epoch 17/20 => Loss 0.303, Train_accy 91.57:  85%|████████▌ | 17/20 [02:35<00:27,  9.16s/it]
Task 11, Epoch 18/20 => Loss 0.306, Train_accy 92.17:  85%|████████▌ | 17/20 [02:44<00:27,  9.16s/it]
Task 11, Epoch 18/20 => Loss 0.306, Train_accy 92.17:  90%|█████████ | 18/20 [02:44<00:18,  9.15s/it]
Task 11, Epoch 19/20 => Loss 0.310, Train_accy 90.84:  90%|█████████ | 18/20 [02:53<00:18,  9.15s/it]
Task 11, Epoch 19/20 => Loss 0.310, Train_accy 90.84:  95%|█████████▌| 19/20 [02:53<00:09,  9.16s/it]
Task 11, Epoch 20/20 => Loss 0.310, Train_accy 91.84:  95%|█████████▌| 19/20 [03:03<00:09,  9.16s/it]
Task 11, Epoch 20/20 => Loss 0.310, Train_accy 91.84: 100%|██████████| 20/20 [03:03<00:00,  9.14s/it]
Task 11, Epoch 20/20 => Loss 0.310, Train_accy 91.84: 100%|██████████| 20/20 [03:03<00:00,  9.15s/it]
2024-09-08 10:18:56,080 [ease.py] => Task 11, Epoch 20/20 => Loss 0.310, Train_accy 91.84
2024-09-08 10:22:00,195 [ease.py] => Task correct: 77.64060356652949
2024-09-08 10:22:00,196 [ease.py] => Task acc: 92.4554183813443
2024-09-08 10:22:00,216 [trainer.py] => No NME accuracy.
2024-09-08 10:22:00,216 [trainer.py] => CNN: {'total': 75.99, '00-09': 72.87, '10-19': 84.14, '20-29': 76.67, '30-39': 81.63, '40-49': 70.53, '50-59': 77.3, '60-69': 70.13, '70-79': 72.53, '80-89': 74.52, '90-99': 63.84, '100-109': 74.65, '110-119': 83.51, 'old': 75.13, 'new': 83.51}
2024-09-08 10:22:00,216 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99]
2024-09-08 10:22:00,216 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84]

Average Accuracy (CNN): 82.48
2024-09-08 10:22:00,216 [trainer.py] => Average Accuracy (CNN): 82.48 

2024-09-08 10:22:00,217 [trainer.py] => All params: 87216578
2024-09-08 10:22:00,217 [trainer.py] => Trainable params: 304320
2024-09-08 10:22:00,227 [ease.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.230, Train_accy 32.54:   0%|          | 0/20 [00:06<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.230, Train_accy 32.54:   5%|▌         | 1/20 [00:06<01:55,  6.07s/it]
Task 12, Epoch 2/20 => Loss 1.884, Train_accy 60.85:   5%|▌         | 1/20 [00:12<01:55,  6.07s/it]
Task 12, Epoch 2/20 => Loss 1.884, Train_accy 60.85:  10%|█         | 2/20 [00:12<01:48,  6.05s/it]
Task 12, Epoch 3/20 => Loss 1.458, Train_accy 73.24:  10%|█         | 2/20 [00:18<01:48,  6.05s/it]
Task 12, Epoch 3/20 => Loss 1.458, Train_accy 73.24:  15%|█▌        | 3/20 [00:18<01:42,  6.05s/it]
Task 12, Epoch 4/20 => Loss 1.150, Train_accy 83.47:  15%|█▌        | 3/20 [00:24<01:42,  6.05s/it]
Task 12, Epoch 4/20 => Loss 1.150, Train_accy 83.47:  20%|██        | 4/20 [00:24<01:37,  6.08s/it]
Task 12, Epoch 5/20 => Loss 0.960, Train_accy 83.47:  20%|██        | 4/20 [00:30<01:37,  6.08s/it]
Task 12, Epoch 5/20 => Loss 0.960, Train_accy 83.47:  25%|██▌       | 5/20 [00:30<01:31,  6.08s/it]
Task 12, Epoch 6/20 => Loss 0.793, Train_accy 87.09:  25%|██▌       | 5/20 [00:36<01:31,  6.08s/it]
Task 12, Epoch 6/20 => Loss 0.793, Train_accy 87.09:  30%|███       | 6/20 [00:36<01:25,  6.09s/it]
Task 12, Epoch 7/20 => Loss 0.716, Train_accy 86.05:  30%|███       | 6/20 [00:42<01:25,  6.09s/it]
Task 12, Epoch 7/20 => Loss 0.716, Train_accy 86.05:  35%|███▌      | 7/20 [00:42<01:19,  6.08s/it]
Task 12, Epoch 8/20 => Loss 0.655, Train_accy 87.09:  35%|███▌      | 7/20 [00:48<01:19,  6.08s/it]
Task 12, Epoch 8/20 => Loss 0.655, Train_accy 87.09:  40%|████      | 8/20 [00:48<01:12,  6.08s/it]
Task 12, Epoch 9/20 => Loss 0.595, Train_accy 86.98:  40%|████      | 8/20 [00:54<01:12,  6.08s/it]
Task 12, Epoch 9/20 => Loss 0.595, Train_accy 86.98:  45%|████▌     | 9/20 [00:54<01:07,  6.11s/it]
Task 12, Epoch 10/20 => Loss 0.497, Train_accy 89.15:  45%|████▌     | 9/20 [01:00<01:07,  6.11s/it]
Task 12, Epoch 10/20 => Loss 0.497, Train_accy 89.15:  50%|█████     | 10/20 [01:00<01:01,  6.11s/it]
Task 12, Epoch 11/20 => Loss 0.511, Train_accy 89.36:  50%|█████     | 10/20 [01:07<01:01,  6.11s/it]
Task 12, Epoch 11/20 => Loss 0.511, Train_accy 89.36:  55%|█████▌    | 11/20 [01:07<00:55,  6.12s/it]
Task 12, Epoch 12/20 => Loss 0.471, Train_accy 89.36:  55%|█████▌    | 11/20 [01:13<00:55,  6.12s/it]
Task 12, Epoch 12/20 => Loss 0.471, Train_accy 89.36:  60%|██████    | 12/20 [01:13<00:48,  6.11s/it]
Task 12, Epoch 13/20 => Loss 0.467, Train_accy 89.15:  60%|██████    | 12/20 [01:19<00:48,  6.11s/it]
Task 12, Epoch 13/20 => Loss 0.467, Train_accy 89.15:  65%|██████▌   | 13/20 [01:19<00:42,  6.10s/it]
Task 12, Epoch 14/20 => Loss 0.441, Train_accy 90.60:  65%|██████▌   | 13/20 [01:25<00:42,  6.10s/it]
Task 12, Epoch 14/20 => Loss 0.441, Train_accy 90.60:  70%|███████   | 14/20 [01:25<00:36,  6.09s/it]
Task 12, Epoch 15/20 => Loss 0.446, Train_accy 89.77:  70%|███████   | 14/20 [01:31<00:36,  6.09s/it]
Task 12, Epoch 15/20 => Loss 0.446, Train_accy 89.77:  75%|███████▌  | 15/20 [01:31<00:30,  6.09s/it]
Task 12, Epoch 16/20 => Loss 0.426, Train_accy 91.01:  75%|███████▌  | 15/20 [01:37<00:30,  6.09s/it]
Task 12, Epoch 16/20 => Loss 0.426, Train_accy 91.01:  80%|████████  | 16/20 [01:37<00:24,  6.10s/it]
Task 12, Epoch 17/20 => Loss 0.406, Train_accy 91.43:  80%|████████  | 16/20 [01:43<00:24,  6.10s/it]
Task 12, Epoch 17/20 => Loss 0.406, Train_accy 91.43:  85%|████████▌ | 17/20 [01:43<00:18,  6.09s/it]
Task 12, Epoch 18/20 => Loss 0.417, Train_accy 90.70:  85%|████████▌ | 17/20 [01:49<00:18,  6.09s/it]
Task 12, Epoch 18/20 => Loss 0.417, Train_accy 90.70:  90%|█████████ | 18/20 [01:49<00:12,  6.11s/it]
Task 12, Epoch 19/20 => Loss 0.400, Train_accy 91.63:  90%|█████████ | 18/20 [01:55<00:12,  6.11s/it]
Task 12, Epoch 19/20 => Loss 0.400, Train_accy 91.63:  95%|█████████▌| 19/20 [01:55<00:06,  6.08s/it]
Task 12, Epoch 20/20 => Loss 0.414, Train_accy 90.19:  95%|█████████▌| 19/20 [02:01<00:06,  6.08s/it]
Task 12, Epoch 20/20 => Loss 0.414, Train_accy 90.19: 100%|██████████| 20/20 [02:01<00:00,  6.10s/it]
Task 12, Epoch 20/20 => Loss 0.414, Train_accy 90.19: 100%|██████████| 20/20 [02:01<00:00,  6.09s/it]
2024-09-08 10:24:02,086 [ease.py] => Task 12, Epoch 20/20 => Loss 0.414, Train_accy 90.19
2024-09-08 10:27:11,455 [ease.py] => Task correct: 76.25127681307457
2024-09-08 10:27:11,456 [ease.py] => Task acc: 92.21144024514811
2024-09-08 10:27:11,481 [trainer.py] => No NME accuracy.
2024-09-08 10:27:11,481 [trainer.py] => CNN: {'total': 74.69, '00-09': 72.87, '10-19': 83.6, '20-29': 76.0, '30-39': 81.33, '40-49': 70.2, '50-59': 77.3, '60-69': 69.46, '70-79': 72.16, '80-89': 74.52, '90-99': 62.71, '100-109': 74.65, '110-119': 83.51, '120-129': 61.25, 'old': 75.69, 'new': 61.25}
2024-09-08 10:27:11,481 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69]
2024-09-08 10:27:11,481 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96]

Average Accuracy (CNN): 81.88
2024-09-08 10:27:11,481 [trainer.py] => Average Accuracy (CNN): 81.88 

2024-09-08 10:27:11,482 [trainer.py] => All params: 87408578
2024-09-08 10:27:11,483 [trainer.py] => Trainable params: 304320
2024-09-08 10:27:11,496 [ease.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.150, Train_accy 39.01:   0%|          | 0/20 [00:07<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.150, Train_accy 39.01:   5%|▌         | 1/20 [00:07<02:15,  7.15s/it]
Task 13, Epoch 2/20 => Loss 1.580, Train_accy 66.61:   5%|▌         | 1/20 [00:14<02:15,  7.15s/it]
Task 13, Epoch 2/20 => Loss 1.580, Train_accy 66.61:  10%|█         | 2/20 [00:14<02:08,  7.16s/it]
Task 13, Epoch 3/20 => Loss 1.087, Train_accy 78.55:  10%|█         | 2/20 [00:21<02:08,  7.16s/it]
Task 13, Epoch 3/20 => Loss 1.087, Train_accy 78.55:  15%|█▌        | 3/20 [00:21<02:01,  7.15s/it]
Task 13, Epoch 4/20 => Loss 0.824, Train_accy 83.39:  15%|█▌        | 3/20 [00:28<02:01,  7.15s/it]
Task 13, Epoch 4/20 => Loss 0.824, Train_accy 83.39:  20%|██        | 4/20 [00:28<01:54,  7.17s/it]
Task 13, Epoch 5/20 => Loss 0.675, Train_accy 85.03:  20%|██        | 4/20 [00:35<01:54,  7.17s/it]
Task 13, Epoch 5/20 => Loss 0.675, Train_accy 85.03:  25%|██▌       | 5/20 [00:35<01:47,  7.18s/it]
Task 13, Epoch 6/20 => Loss 0.567, Train_accy 86.94:  25%|██▌       | 5/20 [00:43<01:47,  7.18s/it]
Task 13, Epoch 6/20 => Loss 0.567, Train_accy 86.94:  30%|███       | 6/20 [00:43<01:40,  7.20s/it]
Task 13, Epoch 7/20 => Loss 0.511, Train_accy 87.46:  30%|███       | 6/20 [00:50<01:40,  7.20s/it]
Task 13, Epoch 7/20 => Loss 0.511, Train_accy 87.46:  35%|███▌      | 7/20 [00:50<01:33,  7.19s/it]
Task 13, Epoch 8/20 => Loss 0.428, Train_accy 89.88:  35%|███▌      | 7/20 [00:57<01:33,  7.19s/it]
Task 13, Epoch 8/20 => Loss 0.428, Train_accy 89.88:  40%|████      | 8/20 [00:57<01:26,  7.19s/it]
Task 13, Epoch 9/20 => Loss 0.420, Train_accy 90.83:  40%|████      | 8/20 [01:04<01:26,  7.19s/it]
Task 13, Epoch 9/20 => Loss 0.420, Train_accy 90.83:  45%|████▌     | 9/20 [01:04<01:19,  7.21s/it]
Task 13, Epoch 10/20 => Loss 0.383, Train_accy 90.66:  45%|████▌     | 9/20 [01:11<01:19,  7.21s/it]
Task 13, Epoch 10/20 => Loss 0.383, Train_accy 90.66:  50%|█████     | 10/20 [01:11<01:12,  7.22s/it]
Task 13, Epoch 11/20 => Loss 0.385, Train_accy 89.97:  50%|█████     | 10/20 [01:19<01:12,  7.22s/it]
Task 13, Epoch 11/20 => Loss 0.385, Train_accy 89.97:  55%|█████▌    | 11/20 [01:19<01:04,  7.21s/it]
Task 13, Epoch 12/20 => Loss 0.350, Train_accy 91.61:  55%|█████▌    | 11/20 [01:26<01:04,  7.21s/it]
Task 13, Epoch 12/20 => Loss 0.350, Train_accy 91.61:  60%|██████    | 12/20 [01:26<00:57,  7.20s/it]
Task 13, Epoch 13/20 => Loss 0.384, Train_accy 90.14:  60%|██████    | 12/20 [01:33<00:57,  7.20s/it]
Task 13, Epoch 13/20 => Loss 0.384, Train_accy 90.14:  65%|██████▌   | 13/20 [01:33<00:50,  7.20s/it]
Task 13, Epoch 14/20 => Loss 0.353, Train_accy 90.57:  65%|██████▌   | 13/20 [01:40<00:50,  7.20s/it]
Task 13, Epoch 14/20 => Loss 0.353, Train_accy 90.57:  70%|███████   | 14/20 [01:40<00:43,  7.19s/it]
Task 13, Epoch 15/20 => Loss 0.340, Train_accy 92.56:  70%|███████   | 14/20 [01:47<00:43,  7.19s/it]
Task 13, Epoch 15/20 => Loss 0.340, Train_accy 92.56:  75%|███████▌  | 15/20 [01:47<00:36,  7.20s/it]
Task 13, Epoch 16/20 => Loss 0.353, Train_accy 91.35:  75%|███████▌  | 15/20 [01:55<00:36,  7.20s/it]
Task 13, Epoch 16/20 => Loss 0.353, Train_accy 91.35:  80%|████████  | 16/20 [01:55<00:28,  7.18s/it]
Task 13, Epoch 17/20 => Loss 0.338, Train_accy 91.52:  80%|████████  | 16/20 [02:02<00:28,  7.18s/it]
Task 13, Epoch 17/20 => Loss 0.338, Train_accy 91.52:  85%|████████▌ | 17/20 [02:02<00:21,  7.19s/it]
Task 13, Epoch 18/20 => Loss 0.298, Train_accy 92.47:  85%|████████▌ | 17/20 [02:09<00:21,  7.19s/it]
Task 13, Epoch 18/20 => Loss 0.298, Train_accy 92.47:  90%|█████████ | 18/20 [02:09<00:14,  7.19s/it]
Task 13, Epoch 19/20 => Loss 0.347, Train_accy 90.83:  90%|█████████ | 18/20 [02:16<00:14,  7.19s/it]
Task 13, Epoch 19/20 => Loss 0.347, Train_accy 90.83:  95%|█████████▌| 19/20 [02:16<00:07,  7.19s/it]
Task 13, Epoch 20/20 => Loss 0.331, Train_accy 91.18:  95%|█████████▌| 19/20 [02:23<00:07,  7.19s/it]
Task 13, Epoch 20/20 => Loss 0.331, Train_accy 91.18: 100%|██████████| 20/20 [02:23<00:00,  7.18s/it]
Task 13, Epoch 20/20 => Loss 0.331, Train_accy 91.18: 100%|██████████| 20/20 [02:23<00:00,  7.19s/it]
2024-09-08 10:29:35,303 [ease.py] => Task 13, Epoch 20/20 => Loss 0.331, Train_accy 91.18
2024-09-08 10:33:18,745 [ease.py] => Task correct: 76.05600379686759
2024-09-08 10:33:18,745 [ease.py] => Task acc: 92.21642145230184
2024-09-08 10:33:18,769 [trainer.py] => No NME accuracy.
2024-09-08 10:33:18,770 [trainer.py] => CNN: {'total': 74.7, '00-09': 72.56, '10-19': 83.87, '20-29': 75.67, '30-39': 81.02, '40-49': 69.87, '50-59': 77.3, '60-69': 69.13, '70-79': 71.43, '80-89': 74.19, '90-99': 61.58, '100-109': 73.94, '110-119': 83.24, '120-129': 59.78, '130-139': 80.2, 'old': 74.28, 'new': 80.2}
2024-09-08 10:33:18,770 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69, 74.7]
2024-09-08 10:33:18,770 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96, 89.77]

Average Accuracy (CNN): 81.37
2024-09-08 10:33:18,770 [trainer.py] => Average Accuracy (CNN): 81.37 

2024-09-08 10:33:18,771 [trainer.py] => All params: 87615938
2024-09-08 10:33:18,772 [trainer.py] => Trainable params: 304320
2024-09-08 10:33:18,785 [ease.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.107, Train_accy 41.48:   0%|          | 0/20 [00:08<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.107, Train_accy 41.48:   5%|▌         | 1/20 [00:08<02:45,  8.72s/it]
Task 14, Epoch 2/20 => Loss 1.437, Train_accy 67.99:   5%|▌         | 1/20 [00:17<02:45,  8.72s/it]
Task 14, Epoch 2/20 => Loss 1.437, Train_accy 67.99:  10%|█         | 2/20 [00:17<02:36,  8.72s/it]
Task 14, Epoch 3/20 => Loss 0.960, Train_accy 83.18:  10%|█         | 2/20 [00:26<02:36,  8.72s/it]
Task 14, Epoch 3/20 => Loss 0.960, Train_accy 83.18:  15%|█▌        | 3/20 [00:26<02:28,  8.73s/it]
Task 14, Epoch 4/20 => Loss 0.712, Train_accy 84.88:  15%|█▌        | 3/20 [00:34<02:28,  8.73s/it]
Task 14, Epoch 4/20 => Loss 0.712, Train_accy 84.88:  20%|██        | 4/20 [00:34<02:19,  8.74s/it]
Task 14, Epoch 5/20 => Loss 0.542, Train_accy 87.63:  20%|██        | 4/20 [00:43<02:19,  8.74s/it]
Task 14, Epoch 5/20 => Loss 0.542, Train_accy 87.63:  25%|██▌       | 5/20 [00:43<02:10,  8.72s/it]
Task 14, Epoch 6/20 => Loss 0.448, Train_accy 89.47:  25%|██▌       | 5/20 [00:52<02:10,  8.72s/it]
Task 14, Epoch 6/20 => Loss 0.448, Train_accy 89.47:  30%|███       | 6/20 [00:52<02:01,  8.71s/it]
Task 14, Epoch 7/20 => Loss 0.409, Train_accy 90.18:  30%|███       | 6/20 [01:00<02:01,  8.71s/it]
Task 14, Epoch 7/20 => Loss 0.409, Train_accy 90.18:  35%|███▌      | 7/20 [01:00<01:53,  8.70s/it]
Task 14, Epoch 8/20 => Loss 0.385, Train_accy 90.11:  35%|███▌      | 7/20 [01:09<01:53,  8.70s/it]
Task 14, Epoch 8/20 => Loss 0.385, Train_accy 90.11:  40%|████      | 8/20 [01:09<01:44,  8.69s/it]
Task 14, Epoch 9/20 => Loss 0.362, Train_accy 90.67:  40%|████      | 8/20 [01:18<01:44,  8.69s/it]
Task 14, Epoch 9/20 => Loss 0.362, Train_accy 90.67:  45%|████▌     | 9/20 [01:18<01:35,  8.68s/it]
Task 14, Epoch 10/20 => Loss 0.346, Train_accy 90.60:  45%|████▌     | 9/20 [01:27<01:35,  8.68s/it]
Task 14, Epoch 10/20 => Loss 0.346, Train_accy 90.60:  50%|█████     | 10/20 [01:27<01:26,  8.70s/it]
Task 14, Epoch 11/20 => Loss 0.322, Train_accy 92.16:  50%|█████     | 10/20 [01:35<01:26,  8.70s/it]
Task 14, Epoch 11/20 => Loss 0.322, Train_accy 92.16:  55%|█████▌    | 11/20 [01:35<01:18,  8.70s/it]
Task 14, Epoch 12/20 => Loss 0.337, Train_accy 91.02:  55%|█████▌    | 11/20 [01:44<01:18,  8.70s/it]
Task 14, Epoch 12/20 => Loss 0.337, Train_accy 91.02:  60%|██████    | 12/20 [01:44<01:09,  8.72s/it]
Task 14, Epoch 13/20 => Loss 0.344, Train_accy 91.10:  60%|██████    | 12/20 [01:53<01:09,  8.72s/it]
Task 14, Epoch 13/20 => Loss 0.344, Train_accy 91.10:  65%|██████▌   | 13/20 [01:53<01:00,  8.71s/it]
Task 14, Epoch 14/20 => Loss 0.337, Train_accy 91.73:  65%|██████▌   | 13/20 [02:01<01:00,  8.71s/it]
Task 14, Epoch 14/20 => Loss 0.337, Train_accy 91.73:  70%|███████   | 14/20 [02:01<00:52,  8.70s/it]
Task 14, Epoch 15/20 => Loss 0.352, Train_accy 90.46:  70%|███████   | 14/20 [02:10<00:52,  8.70s/it]
Task 14, Epoch 15/20 => Loss 0.352, Train_accy 90.46:  75%|███████▌  | 15/20 [02:10<00:43,  8.67s/it]
Task 14, Epoch 16/20 => Loss 0.299, Train_accy 93.07:  75%|███████▌  | 15/20 [02:19<00:43,  8.67s/it]
Task 14, Epoch 16/20 => Loss 0.299, Train_accy 93.07:  80%|████████  | 16/20 [02:19<00:34,  8.68s/it]
Task 14, Epoch 17/20 => Loss 0.338, Train_accy 90.81:  80%|████████  | 16/20 [02:27<00:34,  8.68s/it]
Task 14, Epoch 17/20 => Loss 0.338, Train_accy 90.81:  85%|████████▌ | 17/20 [02:27<00:26,  8.70s/it]
Task 14, Epoch 18/20 => Loss 0.307, Train_accy 91.87:  85%|████████▌ | 17/20 [02:36<00:26,  8.70s/it]
Task 14, Epoch 18/20 => Loss 0.307, Train_accy 91.87:  90%|█████████ | 18/20 [02:36<00:17,  8.70s/it]
Task 14, Epoch 19/20 => Loss 0.308, Train_accy 91.87:  90%|█████████ | 18/20 [02:45<00:17,  8.70s/it]
Task 14, Epoch 19/20 => Loss 0.308, Train_accy 91.87:  95%|█████████▌| 19/20 [02:45<00:08,  8.69s/it]
Task 14, Epoch 20/20 => Loss 0.338, Train_accy 90.81:  95%|█████████▌| 19/20 [02:53<00:08,  8.69s/it]
Task 14, Epoch 20/20 => Loss 0.338, Train_accy 90.81: 100%|██████████| 20/20 [02:53<00:00,  8.69s/it]
Task 14, Epoch 20/20 => Loss 0.338, Train_accy 90.81: 100%|██████████| 20/20 [02:53<00:00,  8.70s/it]
2024-09-08 10:36:12,793 [ease.py] => Task 14, Epoch 20/20 => Loss 0.338, Train_accy 90.81
2024-09-08 10:40:39,822 [ease.py] => Task correct: 75.83497053045187
2024-09-08 10:40:39,823 [ease.py] => Task acc: 92.5343811394892
2024-09-08 10:40:39,848 [trainer.py] => No NME accuracy.
2024-09-08 10:40:39,849 [trainer.py] => CNN: {'total': 74.59, '00-09': 70.35, '10-19': 83.6, '20-29': 75.67, '30-39': 81.02, '40-49': 68.87, '50-59': 76.97, '60-69': 68.46, '70-79': 71.43, '80-89': 73.87, '90-99': 59.89, '100-109': 73.24, '110-119': 82.71, '120-129': 59.41, '130-139': 79.87, '140-149': 79.84, 'old': 74.13, 'new': 79.84}
2024-09-08 10:40:39,849 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69, 74.7, 74.59]
2024-09-08 10:40:39,849 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96, 89.77, 89.67]

Average Accuracy (CNN): 80.91
2024-09-08 10:40:39,849 [trainer.py] => Average Accuracy (CNN): 80.91 

2024-09-08 10:40:39,850 [trainer.py] => All params: 87838658
2024-09-08 10:40:39,850 [trainer.py] => Trainable params: 304320
2024-09-08 10:40:39,866 [ease.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.158, Train_accy 37.47:   0%|          | 0/20 [00:08<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.158, Train_accy 37.47:   5%|▌         | 1/20 [00:08<02:43,  8.60s/it]
Task 15, Epoch 2/20 => Loss 1.613, Train_accy 61.03:   5%|▌         | 1/20 [00:17<02:43,  8.60s/it]
Task 15, Epoch 2/20 => Loss 1.613, Train_accy 61.03:  10%|█         | 2/20 [00:17<02:35,  8.61s/it]
Task 15, Epoch 3/20 => Loss 1.185, Train_accy 76.37:  10%|█         | 2/20 [00:25<02:35,  8.61s/it]
Task 15, Epoch 3/20 => Loss 1.185, Train_accy 76.37:  15%|█▌        | 3/20 [00:25<02:26,  8.61s/it]
Task 15, Epoch 4/20 => Loss 0.933, Train_accy 78.87:  15%|█▌        | 3/20 [00:34<02:26,  8.61s/it]
Task 15, Epoch 4/20 => Loss 0.933, Train_accy 78.87:  20%|██        | 4/20 [00:34<02:17,  8.62s/it]
Task 15, Epoch 5/20 => Loss 0.764, Train_accy 81.01:  20%|██        | 4/20 [00:43<02:17,  8.62s/it]
Task 15, Epoch 5/20 => Loss 0.764, Train_accy 81.01:  25%|██▌       | 5/20 [00:43<02:09,  8.62s/it]
Task 15, Epoch 6/20 => Loss 0.656, Train_accy 84.08:  25%|██▌       | 5/20 [00:51<02:09,  8.62s/it]
Task 15, Epoch 6/20 => Loss 0.656, Train_accy 84.08:  30%|███       | 6/20 [00:51<02:00,  8.61s/it]
Task 15, Epoch 7/20 => Loss 0.587, Train_accy 85.08:  30%|███       | 6/20 [01:00<02:00,  8.61s/it]
Task 15, Epoch 7/20 => Loss 0.587, Train_accy 85.08:  35%|███▌      | 7/20 [01:00<01:52,  8.62s/it]
Task 15, Epoch 8/20 => Loss 0.549, Train_accy 86.22:  35%|███▌      | 7/20 [01:08<01:52,  8.62s/it]
Task 15, Epoch 8/20 => Loss 0.549, Train_accy 86.22:  40%|████      | 8/20 [01:08<01:43,  8.60s/it]
Task 15, Epoch 9/20 => Loss 0.480, Train_accy 88.65:  40%|████      | 8/20 [01:17<01:43,  8.60s/it]
Task 15, Epoch 9/20 => Loss 0.480, Train_accy 88.65:  45%|████▌     | 9/20 [01:17<01:34,  8.63s/it]
Task 15, Epoch 10/20 => Loss 0.464, Train_accy 88.37:  45%|████▌     | 9/20 [01:26<01:34,  8.63s/it]
Task 15, Epoch 10/20 => Loss 0.464, Train_accy 88.37:  50%|█████     | 10/20 [01:26<01:26,  8.63s/it]
Task 15, Epoch 11/20 => Loss 0.444, Train_accy 89.15:  50%|█████     | 10/20 [01:34<01:26,  8.63s/it]
Task 15, Epoch 11/20 => Loss 0.444, Train_accy 89.15:  55%|█████▌    | 11/20 [01:34<01:17,  8.61s/it]
Task 15, Epoch 12/20 => Loss 0.423, Train_accy 90.01:  55%|█████▌    | 11/20 [01:43<01:17,  8.61s/it]
Task 15, Epoch 12/20 => Loss 0.423, Train_accy 90.01:  60%|██████    | 12/20 [01:43<01:08,  8.61s/it]
Task 15, Epoch 13/20 => Loss 0.429, Train_accy 89.01:  60%|██████    | 12/20 [01:51<01:08,  8.61s/it]
Task 15, Epoch 13/20 => Loss 0.429, Train_accy 89.01:  65%|██████▌   | 13/20 [01:51<01:00,  8.60s/it]
Task 15, Epoch 14/20 => Loss 0.426, Train_accy 89.29:  65%|██████▌   | 13/20 [02:00<01:00,  8.60s/it]
Task 15, Epoch 14/20 => Loss 0.426, Train_accy 89.29:  70%|███████   | 14/20 [02:00<00:51,  8.61s/it]
Task 15, Epoch 15/20 => Loss 0.422, Train_accy 89.58:  70%|███████   | 14/20 [02:09<00:51,  8.61s/it]
Task 15, Epoch 15/20 => Loss 0.422, Train_accy 89.58:  75%|███████▌  | 15/20 [02:09<00:43,  8.62s/it]
Task 15, Epoch 16/20 => Loss 0.405, Train_accy 89.44:  75%|███████▌  | 15/20 [02:17<00:43,  8.62s/it]
Task 15, Epoch 16/20 => Loss 0.405, Train_accy 89.44:  80%|████████  | 16/20 [02:17<00:34,  8.60s/it]
Task 15, Epoch 17/20 => Loss 0.368, Train_accy 90.72:  80%|████████  | 16/20 [02:26<00:34,  8.60s/it]
Task 15, Epoch 17/20 => Loss 0.368, Train_accy 90.72:  85%|████████▌ | 17/20 [02:26<00:25,  8.60s/it]
Task 15, Epoch 18/20 => Loss 0.384, Train_accy 90.36:  85%|████████▌ | 17/20 [02:34<00:25,  8.60s/it]
Task 15, Epoch 18/20 => Loss 0.384, Train_accy 90.36:  90%|█████████ | 18/20 [02:34<00:17,  8.60s/it]
Task 15, Epoch 19/20 => Loss 0.377, Train_accy 90.29:  90%|█████████ | 18/20 [02:43<00:17,  8.60s/it]
Task 15, Epoch 19/20 => Loss 0.377, Train_accy 90.29:  95%|█████████▌| 19/20 [02:43<00:08,  8.58s/it]
Task 15, Epoch 20/20 => Loss 0.406, Train_accy 89.22:  95%|█████████▌| 19/20 [02:52<00:08,  8.58s/it]
Task 15, Epoch 20/20 => Loss 0.406, Train_accy 89.22: 100%|██████████| 20/20 [02:52<00:00,  8.61s/it]
Task 15, Epoch 20/20 => Loss 0.406, Train_accy 89.22: 100%|██████████| 20/20 [02:52<00:00,  8.61s/it]
2024-09-08 10:43:32,056 [ease.py] => Task 15, Epoch 20/20 => Loss 0.406, Train_accy 89.22
2024-09-08 10:48:34,094 [ease.py] => Task correct: 75.19724863443253
2024-09-08 10:48:34,095 [ease.py] => Task acc: 92.55512846449524
2024-09-08 10:48:34,115 [trainer.py] => No NME accuracy.
2024-09-08 10:48:34,116 [trainer.py] => CNN: {'total': 74.06, '00-09': 70.35, '10-19': 82.8, '20-29': 75.0, '30-39': 81.02, '40-49': 69.21, '50-59': 76.64, '60-69': 68.12, '70-79': 70.7, '80-89': 73.87, '90-99': 58.76, '100-109': 72.89, '110-119': 82.71, '120-129': 57.56, '130-139': 79.87, '140-149': 79.02, '150-159': 72.65, 'old': 74.18, 'new': 72.65}
2024-09-08 10:48:34,116 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69, 74.7, 74.59, 74.06]
2024-09-08 10:48:34,116 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96, 89.77, 89.67, 89.36]

Average Accuracy (CNN): 80.49
2024-09-08 10:48:34,116 [trainer.py] => Average Accuracy (CNN): 80.49 

2024-09-08 10:48:34,117 [trainer.py] => All params: 88076738
2024-09-08 10:48:34,117 [trainer.py] => Trainable params: 304320
2024-09-08 10:48:34,134 [ease.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.242, Train_accy 33.20:   0%|          | 0/20 [00:06<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.242, Train_accy 33.20:   5%|▌         | 1/20 [00:06<01:57,  6.19s/it]
Task 16, Epoch 2/20 => Loss 1.980, Train_accy 49.20:   5%|▌         | 1/20 [00:12<01:57,  6.19s/it]
Task 16, Epoch 2/20 => Loss 1.980, Train_accy 49.20:  10%|█         | 2/20 [00:12<01:51,  6.20s/it]
Task 16, Epoch 3/20 => Loss 1.641, Train_accy 58.75:  10%|█         | 2/20 [00:18<01:51,  6.20s/it]
Task 16, Epoch 3/20 => Loss 1.641, Train_accy 58.75:  15%|█▌        | 3/20 [00:18<01:45,  6.22s/it]
Task 16, Epoch 4/20 => Loss 1.386, Train_accy 70.02:  15%|█▌        | 3/20 [00:24<01:45,  6.22s/it]
Task 16, Epoch 4/20 => Loss 1.386, Train_accy 70.02:  20%|██        | 4/20 [00:24<01:39,  6.22s/it]
Task 16, Epoch 5/20 => Loss 1.200, Train_accy 74.04:  20%|██        | 4/20 [00:31<01:39,  6.22s/it]
Task 16, Epoch 5/20 => Loss 1.200, Train_accy 74.04:  25%|██▌       | 5/20 [00:31<01:33,  6.20s/it]
Task 16, Epoch 6/20 => Loss 1.028, Train_accy 76.56:  25%|██▌       | 5/20 [00:37<01:33,  6.20s/it]
Task 16, Epoch 6/20 => Loss 1.028, Train_accy 76.56:  30%|███       | 6/20 [00:37<01:26,  6.20s/it]
Task 16, Epoch 7/20 => Loss 0.929, Train_accy 78.87:  30%|███       | 6/20 [00:43<01:26,  6.20s/it]
Task 16, Epoch 7/20 => Loss 0.929, Train_accy 78.87:  35%|███▌      | 7/20 [00:43<01:21,  6.23s/it]
Task 16, Epoch 8/20 => Loss 0.833, Train_accy 78.57:  35%|███▌      | 7/20 [00:49<01:21,  6.23s/it]
Task 16, Epoch 8/20 => Loss 0.833, Train_accy 78.57:  40%|████      | 8/20 [00:49<01:14,  6.24s/it]
Task 16, Epoch 9/20 => Loss 0.781, Train_accy 79.98:  40%|████      | 8/20 [00:55<01:14,  6.24s/it]
Task 16, Epoch 9/20 => Loss 0.781, Train_accy 79.98:  45%|████▌     | 9/20 [00:55<01:08,  6.23s/it]
Task 16, Epoch 10/20 => Loss 0.728, Train_accy 83.00:  45%|████▌     | 9/20 [01:02<01:08,  6.23s/it]
Task 16, Epoch 10/20 => Loss 0.728, Train_accy 83.00:  50%|█████     | 10/20 [01:02<01:02,  6.23s/it]
Task 16, Epoch 11/20 => Loss 0.699, Train_accy 81.49:  50%|█████     | 10/20 [01:08<01:02,  6.23s/it]
Task 16, Epoch 11/20 => Loss 0.699, Train_accy 81.49:  55%|█████▌    | 11/20 [01:08<00:56,  6.25s/it]
Task 16, Epoch 12/20 => Loss 0.650, Train_accy 83.60:  55%|█████▌    | 11/20 [01:14<00:56,  6.25s/it]
Task 16, Epoch 12/20 => Loss 0.650, Train_accy 83.60:  60%|██████    | 12/20 [01:14<00:49,  6.25s/it]
Task 16, Epoch 13/20 => Loss 0.640, Train_accy 83.50:  60%|██████    | 12/20 [01:20<00:49,  6.25s/it]
Task 16, Epoch 13/20 => Loss 0.640, Train_accy 83.50:  65%|██████▌   | 13/20 [01:20<00:43,  6.23s/it]
Task 16, Epoch 14/20 => Loss 0.625, Train_accy 84.41:  65%|██████▌   | 13/20 [01:27<00:43,  6.23s/it]
Task 16, Epoch 14/20 => Loss 0.625, Train_accy 84.41:  70%|███████   | 14/20 [01:27<00:37,  6.24s/it]
Task 16, Epoch 15/20 => Loss 0.604, Train_accy 85.21:  70%|███████   | 14/20 [01:33<00:37,  6.24s/it]
Task 16, Epoch 15/20 => Loss 0.604, Train_accy 85.21:  75%|███████▌  | 15/20 [01:33<00:31,  6.23s/it]
Task 16, Epoch 16/20 => Loss 0.587, Train_accy 84.61:  75%|███████▌  | 15/20 [01:39<00:31,  6.23s/it]
Task 16, Epoch 16/20 => Loss 0.587, Train_accy 84.61:  80%|████████  | 16/20 [01:39<00:24,  6.22s/it]
Task 16, Epoch 17/20 => Loss 0.550, Train_accy 85.51:  80%|████████  | 16/20 [01:45<00:24,  6.22s/it]
Task 16, Epoch 17/20 => Loss 0.550, Train_accy 85.51:  85%|████████▌ | 17/20 [01:45<00:18,  6.23s/it]
Task 16, Epoch 18/20 => Loss 0.572, Train_accy 85.92:  85%|████████▌ | 17/20 [01:52<00:18,  6.23s/it]
Task 16, Epoch 18/20 => Loss 0.572, Train_accy 85.92:  90%|█████████ | 18/20 [01:52<00:12,  6.21s/it]
Task 16, Epoch 19/20 => Loss 0.575, Train_accy 85.21:  90%|█████████ | 18/20 [01:58<00:12,  6.21s/it]
Task 16, Epoch 19/20 => Loss 0.575, Train_accy 85.21:  95%|█████████▌| 19/20 [01:58<00:06,  6.21s/it]
Task 16, Epoch 20/20 => Loss 0.571, Train_accy 85.92:  95%|█████████▌| 19/20 [02:04<00:06,  6.21s/it]
Task 16, Epoch 20/20 => Loss 0.571, Train_accy 85.92: 100%|██████████| 20/20 [02:04<00:00,  6.20s/it]
Task 16, Epoch 20/20 => Loss 0.571, Train_accy 85.92: 100%|██████████| 20/20 [02:04<00:00,  6.22s/it]
2024-09-08 10:50:38,548 [ease.py] => Task 16, Epoch 20/20 => Loss 0.571, Train_accy 85.92
2024-09-08 10:55:50,138 [ease.py] => Task correct: 73.902957664798
2024-09-08 10:55:50,139 [ease.py] => Task acc: 92.24821186932148
2024-09-08 10:55:50,164 [trainer.py] => No NME accuracy.
2024-09-08 10:55:50,164 [trainer.py] => CNN: {'total': 72.88, '00-09': 70.03, '10-19': 82.53, '20-29': 75.33, '30-39': 80.72, '40-49': 66.89, '50-59': 76.32, '60-69': 68.12, '70-79': 70.7, '80-89': 72.9, '90-99': 58.19, '100-109': 72.18, '110-119': 82.45, '120-129': 57.56, '130-139': 79.87, '140-149': 79.02, '150-159': 72.1, '160-169': 55.65, 'old': 73.68, 'new': 55.65}
2024-09-08 10:55:50,164 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69, 74.7, 74.59, 74.06, 72.88]
2024-09-08 10:55:50,164 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96, 89.77, 89.67, 89.36, 88.65]

Average Accuracy (CNN): 80.04
2024-09-08 10:55:50,164 [trainer.py] => Average Accuracy (CNN): 80.04 

2024-09-08 10:55:50,165 [trainer.py] => All params: 88330178
2024-09-08 10:55:50,165 [trainer.py] => Trainable params: 304320
2024-09-08 10:55:50,184 [ease.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.223, Train_accy 35.22:   0%|          | 0/20 [00:05<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.223, Train_accy 35.22:   5%|▌         | 1/20 [00:05<01:53,  6.00s/it]
Task 17, Epoch 2/20 => Loss 1.821, Train_accy 63.42:   5%|▌         | 1/20 [00:12<01:53,  6.00s/it]
Task 17, Epoch 2/20 => Loss 1.821, Train_accy 63.42:  10%|█         | 2/20 [00:12<01:50,  6.13s/it]
Task 17, Epoch 3/20 => Loss 1.328, Train_accy 76.94:  10%|█         | 2/20 [00:18<01:50,  6.13s/it]
Task 17, Epoch 3/20 => Loss 1.328, Train_accy 76.94:  15%|█▌        | 3/20 [00:18<01:43,  6.06s/it]
Task 17, Epoch 4/20 => Loss 0.999, Train_accy 84.38:  15%|█▌        | 3/20 [00:24<01:43,  6.06s/it]
Task 17, Epoch 4/20 => Loss 0.999, Train_accy 84.38:  20%|██        | 4/20 [00:24<01:36,  6.05s/it]
Task 17, Epoch 5/20 => Loss 0.806, Train_accy 84.80:  20%|██        | 4/20 [00:30<01:36,  6.05s/it]
Task 17, Epoch 5/20 => Loss 0.806, Train_accy 84.80:  25%|██▌       | 5/20 [00:30<01:30,  6.03s/it]
Task 17, Epoch 6/20 => Loss 0.659, Train_accy 87.00:  25%|██▌       | 5/20 [00:36<01:30,  6.03s/it]
Task 17, Epoch 6/20 => Loss 0.659, Train_accy 87.00:  30%|███       | 6/20 [00:36<01:24,  6.01s/it]
Task 17, Epoch 7/20 => Loss 0.584, Train_accy 87.84:  30%|███       | 6/20 [00:42<01:24,  6.01s/it]
Task 17, Epoch 7/20 => Loss 0.584, Train_accy 87.84:  35%|███▌      | 7/20 [00:42<01:18,  6.00s/it]
Task 17, Epoch 8/20 => Loss 0.488, Train_accy 89.62:  35%|███▌      | 7/20 [00:48<01:18,  6.00s/it]
Task 17, Epoch 8/20 => Loss 0.488, Train_accy 89.62:  40%|████      | 8/20 [00:48<01:12,  6.01s/it]
Task 17, Epoch 9/20 => Loss 0.462, Train_accy 90.46:  40%|████      | 8/20 [00:54<01:12,  6.01s/it]
Task 17, Epoch 9/20 => Loss 0.462, Train_accy 90.46:  45%|████▌     | 9/20 [00:54<01:06,  6.08s/it]
Task 17, Epoch 10/20 => Loss 0.456, Train_accy 88.78:  45%|████▌     | 9/20 [01:00<01:06,  6.08s/it]
Task 17, Epoch 10/20 => Loss 0.456, Train_accy 88.78:  50%|█████     | 10/20 [01:00<01:00,  6.04s/it]
Task 17, Epoch 11/20 => Loss 0.397, Train_accy 91.09:  50%|█████     | 10/20 [01:06<01:00,  6.04s/it]
Task 17, Epoch 11/20 => Loss 0.397, Train_accy 91.09:  55%|█████▌    | 11/20 [01:06<00:54,  6.03s/it]
Task 17, Epoch 12/20 => Loss 0.353, Train_accy 91.40:  55%|█████▌    | 11/20 [01:12<00:54,  6.03s/it]
Task 17, Epoch 12/20 => Loss 0.353, Train_accy 91.40:  60%|██████    | 12/20 [01:12<00:48,  6.09s/it]
Task 17, Epoch 13/20 => Loss 0.364, Train_accy 92.14:  60%|██████    | 12/20 [01:18<00:48,  6.09s/it]
Task 17, Epoch 13/20 => Loss 0.364, Train_accy 92.14:  65%|██████▌   | 13/20 [01:18<00:42,  6.04s/it]
Task 17, Epoch 14/20 => Loss 0.367, Train_accy 91.19:  65%|██████▌   | 13/20 [01:24<00:42,  6.04s/it]
Task 17, Epoch 14/20 => Loss 0.367, Train_accy 91.19:  70%|███████   | 14/20 [01:24<00:36,  6.04s/it]
Task 17, Epoch 15/20 => Loss 0.349, Train_accy 91.40:  70%|███████   | 14/20 [01:30<00:36,  6.04s/it]
Task 17, Epoch 15/20 => Loss 0.349, Train_accy 91.40:  75%|███████▌  | 15/20 [01:30<00:30,  6.08s/it]
Task 17, Epoch 16/20 => Loss 0.335, Train_accy 92.56:  75%|███████▌  | 15/20 [01:36<00:30,  6.08s/it]
Task 17, Epoch 16/20 => Loss 0.335, Train_accy 92.56:  80%|████████  | 16/20 [01:36<00:24,  6.04s/it]
Task 17, Epoch 17/20 => Loss 0.360, Train_accy 91.93:  80%|████████  | 16/20 [01:42<00:24,  6.04s/it]
Task 17, Epoch 17/20 => Loss 0.360, Train_accy 91.93:  85%|████████▌ | 17/20 [01:42<00:18,  6.02s/it]
Task 17, Epoch 18/20 => Loss 0.344, Train_accy 92.45:  85%|████████▌ | 17/20 [01:48<00:18,  6.02s/it]
Task 17, Epoch 18/20 => Loss 0.344, Train_accy 92.45:  90%|█████████ | 18/20 [01:48<00:12,  6.00s/it]
Task 17, Epoch 19/20 => Loss 0.333, Train_accy 91.72:  90%|█████████ | 18/20 [01:54<00:12,  6.00s/it]
Task 17, Epoch 19/20 => Loss 0.333, Train_accy 91.72:  95%|█████████▌| 19/20 [01:54<00:05,  5.99s/it]
Task 17, Epoch 20/20 => Loss 0.332, Train_accy 93.29:  95%|█████████▌| 19/20 [02:00<00:05,  5.99s/it]
Task 17, Epoch 20/20 => Loss 0.332, Train_accy 93.29: 100%|██████████| 20/20 [02:00<00:00,  6.03s/it]
Task 17, Epoch 20/20 => Loss 0.332, Train_accy 93.29: 100%|██████████| 20/20 [02:00<00:00,  6.04s/it]
2024-09-08 10:57:50,904 [ease.py] => Task 17, Epoch 20/20 => Loss 0.332, Train_accy 93.29
2024-09-08 11:03:32,315 [ease.py] => Task correct: 73.91625161409334
2024-09-08 11:03:32,316 [ease.py] => Task acc: 92.36303265080244
2024-09-08 11:03:32,338 [trainer.py] => No NME accuracy.
2024-09-08 11:03:32,339 [trainer.py] => CNN: {'total': 72.92, '00-09': 69.72, '10-19': 81.99, '20-29': 75.33, '30-39': 80.12, '40-49': 66.89, '50-59': 75.99, '60-69': 68.12, '70-79': 70.7, '80-89': 72.9, '90-99': 56.5, '100-109': 72.18, '110-119': 82.45, '120-129': 57.2, '130-139': 79.87, '140-149': 79.02, '150-159': 72.1, '160-169': 55.22, '170-179': 78.23, 'old': 72.67, 'new': 78.23}
2024-09-08 11:03:32,339 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69, 74.7, 74.59, 74.06, 72.88, 72.92]
2024-09-08 11:03:32,339 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96, 89.77, 89.67, 89.36, 88.65, 88.45]

Average Accuracy (CNN): 79.64
2024-09-08 11:03:32,339 [trainer.py] => Average Accuracy (CNN): 79.64 

2024-09-08 11:03:32,340 [trainer.py] => All params: 88598978
2024-09-08 11:03:32,340 [trainer.py] => Trainable params: 304320
2024-09-08 11:03:32,361 [ease.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.193, Train_accy 33.27:   0%|          | 0/20 [00:07<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.193, Train_accy 33.27:   5%|▌         | 1/20 [00:07<02:14,  7.06s/it]
Task 18, Epoch 2/20 => Loss 1.731, Train_accy 57.44:   5%|▌         | 1/20 [00:14<02:14,  7.06s/it]
Task 18, Epoch 2/20 => Loss 1.731, Train_accy 57.44:  10%|█         | 2/20 [00:14<02:07,  7.08s/it]
Task 18, Epoch 3/20 => Loss 1.289, Train_accy 73.82:  10%|█         | 2/20 [00:21<02:07,  7.08s/it]
Task 18, Epoch 3/20 => Loss 1.289, Train_accy 73.82:  15%|█▌        | 3/20 [00:21<02:01,  7.14s/it]
Task 18, Epoch 4/20 => Loss 1.041, Train_accy 78.20:  15%|█▌        | 3/20 [00:28<02:01,  7.14s/it]
Task 18, Epoch 4/20 => Loss 1.041, Train_accy 78.20:  20%|██        | 4/20 [00:28<01:54,  7.13s/it]
Task 18, Epoch 5/20 => Loss 0.864, Train_accy 81.44:  20%|██        | 4/20 [00:35<01:54,  7.13s/it]
Task 18, Epoch 5/20 => Loss 0.864, Train_accy 81.44:  25%|██▌       | 5/20 [00:35<01:46,  7.12s/it]
Task 18, Epoch 6/20 => Loss 0.701, Train_accy 84.06:  25%|██▌       | 5/20 [00:42<01:46,  7.12s/it]
Task 18, Epoch 6/20 => Loss 0.701, Train_accy 84.06:  30%|███       | 6/20 [00:42<01:39,  7.10s/it]
Task 18, Epoch 7/20 => Loss 0.643, Train_accy 84.94:  30%|███       | 6/20 [00:49<01:39,  7.10s/it]
Task 18, Epoch 7/20 => Loss 0.643, Train_accy 84.94:  35%|███▌      | 7/20 [00:49<01:32,  7.11s/it]
Task 18, Epoch 8/20 => Loss 0.556, Train_accy 86.51:  35%|███▌      | 7/20 [00:56<01:32,  7.11s/it]
Task 18, Epoch 8/20 => Loss 0.556, Train_accy 86.51:  40%|████      | 8/20 [00:56<01:25,  7.12s/it]
Task 18, Epoch 9/20 => Loss 0.546, Train_accy 85.81:  40%|████      | 8/20 [01:04<01:25,  7.12s/it]
Task 18, Epoch 9/20 => Loss 0.546, Train_accy 85.81:  45%|████▌     | 9/20 [01:04<01:18,  7.11s/it]
Task 18, Epoch 10/20 => Loss 0.474, Train_accy 88.09:  45%|████▌     | 9/20 [01:11<01:18,  7.11s/it]
Task 18, Epoch 10/20 => Loss 0.474, Train_accy 88.09:  50%|█████     | 10/20 [01:11<01:11,  7.11s/it]
Task 18, Epoch 11/20 => Loss 0.476, Train_accy 88.09:  50%|█████     | 10/20 [01:18<01:11,  7.11s/it]
Task 18, Epoch 11/20 => Loss 0.476, Train_accy 88.09:  55%|█████▌    | 11/20 [01:18<01:03,  7.10s/it]
Task 18, Epoch 12/20 => Loss 0.453, Train_accy 87.92:  55%|█████▌    | 11/20 [01:25<01:03,  7.10s/it]
Task 18, Epoch 12/20 => Loss 0.453, Train_accy 87.92:  60%|██████    | 12/20 [01:25<00:56,  7.10s/it]
Task 18, Epoch 13/20 => Loss 0.432, Train_accy 89.14:  60%|██████    | 12/20 [01:32<00:56,  7.10s/it]
Task 18, Epoch 13/20 => Loss 0.432, Train_accy 89.14:  65%|██████▌   | 13/20 [01:32<00:49,  7.10s/it]
Task 18, Epoch 14/20 => Loss 0.433, Train_accy 89.14:  65%|██████▌   | 13/20 [01:39<00:49,  7.10s/it]
Task 18, Epoch 14/20 => Loss 0.433, Train_accy 89.14:  70%|███████   | 14/20 [01:39<00:42,  7.08s/it]
Task 18, Epoch 15/20 => Loss 0.434, Train_accy 88.97:  70%|███████   | 14/20 [01:46<00:42,  7.08s/it]
Task 18, Epoch 15/20 => Loss 0.434, Train_accy 88.97:  75%|███████▌  | 15/20 [01:46<00:35,  7.08s/it]
Task 18, Epoch 16/20 => Loss 0.416, Train_accy 89.40:  75%|███████▌  | 15/20 [01:53<00:35,  7.08s/it]
Task 18, Epoch 16/20 => Loss 0.416, Train_accy 89.40:  80%|████████  | 16/20 [01:53<00:28,  7.07s/it]
Task 18, Epoch 17/20 => Loss 0.428, Train_accy 88.18:  80%|████████  | 16/20 [02:00<00:28,  7.07s/it]
Task 18, Epoch 17/20 => Loss 0.428, Train_accy 88.18:  85%|████████▌ | 17/20 [02:00<00:21,  7.08s/it]
Task 18, Epoch 18/20 => Loss 0.413, Train_accy 89.67:  85%|████████▌ | 17/20 [02:07<00:21,  7.08s/it]
Task 18, Epoch 18/20 => Loss 0.413, Train_accy 89.67:  90%|█████████ | 18/20 [02:07<00:14,  7.08s/it]
Task 18, Epoch 19/20 => Loss 0.397, Train_accy 90.11:  90%|█████████ | 18/20 [02:14<00:14,  7.08s/it]
Task 18, Epoch 19/20 => Loss 0.397, Train_accy 90.11:  95%|█████████▌| 19/20 [02:14<00:07,  7.07s/it]
Task 18, Epoch 20/20 => Loss 0.399, Train_accy 89.67:  95%|█████████▌| 19/20 [02:21<00:07,  7.07s/it]
Task 18, Epoch 20/20 => Loss 0.399, Train_accy 89.67: 100%|██████████| 20/20 [02:21<00:00,  7.06s/it]
Task 18, Epoch 20/20 => Loss 0.399, Train_accy 89.67: 100%|██████████| 20/20 [02:21<00:00,  7.09s/it]
2024-09-08 11:05:54,190 [ease.py] => Task 18, Epoch 20/20 => Loss 0.399, Train_accy 89.67
2024-09-08 11:12:21,593 [ease.py] => Task correct: 73.15412812009076
2024-09-08 11:12:21,594 [ease.py] => Task acc: 92.40705184150812
2024-09-08 11:12:21,619 [trainer.py] => No NME accuracy.
2024-09-08 11:12:21,619 [trainer.py] => CNN: {'total': 72.26, '00-09': 69.72, '10-19': 81.72, '20-29': 74.0, '30-39': 79.82, '40-49': 67.22, '50-59': 74.01, '60-69': 67.79, '70-79': 70.7, '80-89': 71.94, '90-99': 56.5, '100-109': 71.83, '110-119': 81.38, '120-129': 57.2, '130-139': 79.19, '140-149': 79.02, '150-159': 72.1, '160-169': 55.22, '170-179': 77.42, '180-189': 68.51, 'old': 72.48, 'new': 68.51}
2024-09-08 11:12:21,619 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69, 74.7, 74.59, 74.06, 72.88, 72.92, 72.26]
2024-09-08 11:12:21,619 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96, 89.77, 89.67, 89.36, 88.65, 88.45, 88.11]

Average Accuracy (CNN): 79.25
2024-09-08 11:12:21,619 [trainer.py] => Average Accuracy (CNN): 79.25 

2024-09-08 11:12:21,620 [trainer.py] => All params: 88883138
2024-09-08 11:12:21,621 [trainer.py] => Trainable params: 304320
2024-09-08 11:12:21,644 [ease.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.158, Train_accy 39.72:   0%|          | 0/20 [00:06<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.158, Train_accy 39.72:   5%|▌         | 1/20 [00:06<02:12,  6.99s/it]
Task 19, Epoch 2/20 => Loss 1.565, Train_accy 67.91:   5%|▌         | 1/20 [00:13<02:12,  6.99s/it]
Task 19, Epoch 2/20 => Loss 1.565, Train_accy 67.91:  10%|█         | 2/20 [00:13<02:05,  6.99s/it]
Task 19, Epoch 3/20 => Loss 1.057, Train_accy 82.09:  10%|█         | 2/20 [00:21<02:05,  6.99s/it]
Task 19, Epoch 3/20 => Loss 1.057, Train_accy 82.09:  15%|█▌        | 3/20 [00:21<02:00,  7.08s/it]
Task 19, Epoch 4/20 => Loss 0.811, Train_accy 84.22:  15%|█▌        | 3/20 [00:28<02:00,  7.08s/it]
Task 19, Epoch 4/20 => Loss 0.811, Train_accy 84.22:  20%|██        | 4/20 [00:28<01:53,  7.11s/it]
Task 19, Epoch 5/20 => Loss 0.660, Train_accy 85.28:  20%|██        | 4/20 [00:35<01:53,  7.11s/it]
Task 19, Epoch 5/20 => Loss 0.660, Train_accy 85.28:  25%|██▌       | 5/20 [00:35<01:46,  7.09s/it]
Task 19, Epoch 6/20 => Loss 0.580, Train_accy 87.32:  25%|██▌       | 5/20 [00:42<01:46,  7.09s/it]
Task 19, Epoch 6/20 => Loss 0.580, Train_accy 87.32:  30%|███       | 6/20 [00:42<01:39,  7.07s/it]
Task 19, Epoch 7/20 => Loss 0.517, Train_accy 86.79:  30%|███       | 6/20 [00:49<01:39,  7.07s/it]
Task 19, Epoch 7/20 => Loss 0.517, Train_accy 86.79:  35%|███▌      | 7/20 [00:49<01:31,  7.07s/it]
Task 19, Epoch 8/20 => Loss 0.431, Train_accy 89.98:  35%|███▌      | 7/20 [00:56<01:31,  7.07s/it]
Task 19, Epoch 8/20 => Loss 0.431, Train_accy 89.98:  40%|████      | 8/20 [00:56<01:25,  7.11s/it]
Task 19, Epoch 9/20 => Loss 0.388, Train_accy 89.98:  40%|████      | 8/20 [01:03<01:25,  7.11s/it]
Task 19, Epoch 9/20 => Loss 0.388, Train_accy 89.98:  45%|████▌     | 9/20 [01:03<01:17,  7.06s/it]
Task 19, Epoch 10/20 => Loss 0.421, Train_accy 89.63:  45%|████▌     | 9/20 [01:10<01:17,  7.06s/it]
Task 19, Epoch 10/20 => Loss 0.421, Train_accy 89.63:  50%|█████     | 10/20 [01:10<01:10,  7.04s/it]
Task 19, Epoch 11/20 => Loss 0.376, Train_accy 90.96:  50%|█████     | 10/20 [01:17<01:10,  7.04s/it]
Task 19, Epoch 11/20 => Loss 0.376, Train_accy 90.96:  55%|█████▌    | 11/20 [01:17<01:03,  7.02s/it]
Task 19, Epoch 12/20 => Loss 0.365, Train_accy 90.78:  55%|█████▌    | 11/20 [01:24<01:03,  7.02s/it]
Task 19, Epoch 12/20 => Loss 0.365, Train_accy 90.78:  60%|██████    | 12/20 [01:24<00:56,  7.00s/it]
Task 19, Epoch 13/20 => Loss 0.374, Train_accy 89.72:  60%|██████    | 12/20 [01:31<00:56,  7.00s/it]
Task 19, Epoch 13/20 => Loss 0.374, Train_accy 89.72:  65%|██████▌   | 13/20 [01:31<00:48,  6.99s/it]
Task 19, Epoch 14/20 => Loss 0.348, Train_accy 91.05:  65%|██████▌   | 13/20 [01:38<00:48,  6.99s/it]
Task 19, Epoch 14/20 => Loss 0.348, Train_accy 91.05:  70%|███████   | 14/20 [01:38<00:41,  6.98s/it]
Task 19, Epoch 15/20 => Loss 0.368, Train_accy 89.98:  70%|███████   | 14/20 [01:45<00:41,  6.98s/it]
Task 19, Epoch 15/20 => Loss 0.368, Train_accy 89.98:  75%|███████▌  | 15/20 [01:45<00:34,  6.97s/it]
Task 19, Epoch 16/20 => Loss 0.333, Train_accy 91.40:  75%|███████▌  | 15/20 [01:52<00:34,  6.97s/it]
Task 19, Epoch 16/20 => Loss 0.333, Train_accy 91.40:  80%|████████  | 16/20 [01:52<00:27,  6.98s/it]
Task 19, Epoch 17/20 => Loss 0.328, Train_accy 92.46:  80%|████████  | 16/20 [01:59<00:27,  6.98s/it]
Task 19, Epoch 17/20 => Loss 0.328, Train_accy 92.46:  85%|████████▌ | 17/20 [01:59<00:20,  6.98s/it]
Task 19, Epoch 18/20 => Loss 0.360, Train_accy 90.78:  85%|████████▌ | 17/20 [02:06<00:20,  6.98s/it]
Task 19, Epoch 18/20 => Loss 0.360, Train_accy 90.78:  90%|█████████ | 18/20 [02:06<00:13,  6.97s/it]
Task 19, Epoch 19/20 => Loss 0.312, Train_accy 92.02:  90%|█████████ | 18/20 [02:13<00:13,  6.97s/it]
Task 19, Epoch 19/20 => Loss 0.312, Train_accy 92.02:  95%|█████████▌| 19/20 [02:13<00:06,  6.98s/it]
Task 19, Epoch 20/20 => Loss 0.336, Train_accy 91.49:  95%|█████████▌| 19/20 [02:20<00:06,  6.98s/it]
Task 19, Epoch 20/20 => Loss 0.336, Train_accy 91.49: 100%|██████████| 20/20 [02:20<00:00,  6.98s/it]
Task 19, Epoch 20/20 => Loss 0.336, Train_accy 91.49: 100%|██████████| 20/20 [02:20<00:00,  7.02s/it]
2024-09-08 11:14:41,984 [ease.py] => Task 19, Epoch 20/20 => Loss 0.336, Train_accy 91.49
2024-09-08 11:21:45,108 [ease.py] => Task correct: 72.91666666666667
2024-09-08 11:21:45,109 [ease.py] => Task acc: 92.51666666666667
2024-09-08 11:21:45,132 [trainer.py] => No NME accuracy.
2024-09-08 11:21:45,132 [trainer.py] => CNN: {'total': 72.08, '00-09': 69.72, '10-19': 81.72, '20-29': 73.67, '30-39': 78.92, '40-49': 67.22, '50-59': 74.01, '60-69': 67.79, '70-79': 70.7, '80-89': 71.94, '90-99': 55.37, '100-109': 71.48, '110-119': 81.38, '120-129': 56.46, '130-139': 78.86, '140-149': 78.47, '150-159': 72.1, '160-169': 54.35, '170-179': 77.42, '180-189': 68.18, '190-199': 73.8, 'old': 72.0, 'new': 73.8}
2024-09-08 11:21:45,132 [trainer.py] => CNN top1 curve: [92.74, 89.99, 86.35, 85.47, 83.61, 82.1, 80.85, 79.94, 78.56, 77.45, 76.69, 75.99, 74.69, 74.7, 74.59, 74.06, 72.88, 72.92, 72.26, 72.08]
2024-09-08 11:21:45,132 [trainer.py] => CNN top5 curve: [99.37, 98.4, 97.17, 96.59, 95.07, 94.34, 93.66, 92.79, 91.92, 91.19, 90.88, 90.84, 89.96, 89.77, 89.67, 89.36, 88.65, 88.45, 88.11, 87.85]

Average Accuracy (CNN): 78.9
2024-09-08 11:21:45,132 [trainer.py] => Average Accuracy (CNN): 78.9 

Accuracy Matrix (CNN):
[[92.74 86.44 80.76 79.5  78.86 78.55 76.97 74.76 73.5  74.13 73.5  72.87
  72.87 72.56 70.35 70.35 70.03 69.72 69.72 69.72]
 [ 0.   93.01 91.94 91.67 90.32 88.98 88.44 87.63 86.83 86.56 86.83 84.14
  83.6  83.87 83.6  82.8  82.53 81.99 81.72 81.72]
 [ 0.    0.   85.33 84.   83.   81.   80.33 80.33 79.   78.67 78.33 76.67
  76.   75.67 75.67 75.   75.33 75.33 74.   73.67]
 [ 0.    0.    0.   85.54 84.64 83.43 82.83 82.53 82.23 82.23 81.93 81.63
  81.33 81.02 81.02 81.02 80.72 80.12 79.82 78.92]
 [ 0.    0.    0.    0.   79.8  78.48 77.48 75.83 73.18 72.19 71.52 70.53
  70.2  69.87 68.87 69.21 66.89 66.89 67.22 67.22]
 [ 0.    0.    0.    0.    0.   80.59 79.61 78.95 78.62 78.29 77.63 77.3
  77.3  77.3  76.97 76.64 76.32 75.99 74.01 74.01]
 [ 0.    0.    0.    0.    0.    0.   78.52 77.18 74.5  73.83 73.15 70.13
  69.46 69.13 68.46 68.12 68.12 68.12 67.79 67.79]
 [ 0.    0.    0.    0.    0.    0.    0.   80.59 79.49 77.66 75.09 72.53
  72.16 71.43 71.43 70.7  70.7  70.7  70.7  70.7 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   77.74 78.06 76.77 74.52
  74.52 74.19 73.87 73.87 72.9  72.9  71.94 71.94]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   65.54 64.97 63.84
  62.71 61.58 59.89 58.76 58.19 56.5  56.5  55.37]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   76.06 74.65
  74.65 73.94 73.24 72.89 72.18 72.18 71.83 71.48]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   83.51
  83.51 83.24 82.71 82.71 82.45 82.45 81.38 81.38]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  61.25 59.78 59.41 57.56 57.56 57.2  57.2  56.46]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   80.2  79.87 79.87 79.87 79.87 79.19 78.86]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   79.84 79.02 79.02 79.02 79.02 78.47]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   72.65 72.1  72.1  72.1  72.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   55.65 55.22 55.22 54.35]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   78.23 77.42 77.42]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   68.51 68.18]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   73.8 ]]
2024-09-08 11:21:45,135 [trainer.py] => Forgetting (CNN): 6.6242105263157915
2024-09-08 11:21:47,964 [trainer.py] => config: ./exps/ease_inr_B100_Inc5.json
2024-09-08 11:21:47,972 [trainer.py] => prefix:  
2024-09-08 11:21:47,972 [trainer.py] => dataset: imagenetr
2024-09-08 11:21:47,972 [trainer.py] => memory_size: 0
2024-09-08 11:21:47,972 [trainer.py] => memory_per_class: 0
2024-09-08 11:21:47,972 [trainer.py] => fixed_memory: False
2024-09-08 11:21:47,972 [trainer.py] => shuffle: True
2024-09-08 11:21:47,972 [trainer.py] => init_cls: 100
2024-09-08 11:21:47,972 [trainer.py] => increment: 20
2024-09-08 11:21:47,972 [trainer.py] => model_name: ease
2024-09-08 11:21:47,972 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-08 11:21:47,972 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 11:21:47,972 [trainer.py] => seed: 1993
2024-09-08 11:21:47,972 [trainer.py] => init_epochs: 20
2024-09-08 11:21:47,972 [trainer.py] => init_lr: 0.05
2024-09-08 11:21:47,972 [trainer.py] => later_epochs: 20
2024-09-08 11:21:47,972 [trainer.py] => later_lr: 0.05
2024-09-08 11:21:47,972 [trainer.py] => batch_size: 48
2024-09-08 11:21:47,972 [trainer.py] => weight_decay: 0.005
2024-09-08 11:21:47,972 [trainer.py] => min_lr: 0
2024-09-08 11:21:47,972 [trainer.py] => optimizer: sgd
2024-09-08 11:21:47,972 [trainer.py] => scheduler: cosine
2024-09-08 11:21:47,973 [trainer.py] => pretrained: True
2024-09-08 11:21:47,973 [trainer.py] => vpt_type: Deep
2024-09-08 11:21:47,973 [trainer.py] => prompt_token_num: 5
2024-09-08 11:21:47,973 [trainer.py] => ffn_num: 16
2024-09-08 11:21:47,973 [trainer.py] => use_diagonal: False
2024-09-08 11:21:47,973 [trainer.py] => recalc_sim: True
2024-09-08 11:21:47,973 [trainer.py] => alpha: 0.1
2024-09-08 11:21:47,973 [trainer.py] => use_init_ptm: False
2024-09-08 11:21:47,973 [trainer.py] => beta: 0
2024-09-08 11:21:47,973 [trainer.py] => use_old_data: False
2024-09-08 11:21:47,973 [trainer.py] => use_reweight: True
2024-09-08 11:21:47,973 [trainer.py] => moni_adam: False
2024-09-08 11:21:47,973 [trainer.py] => adapter_num: -1
2024-09-08 11:21:48,055 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-08 11:21:50,836 [trainer.py] => All params: 86102976
2024-09-08 11:21:50,837 [trainer.py] => Trainable params: 304320
2024-09-08 11:21:50,844 [ease.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.141, Train_accy 42.08:   0%|          | 0/20 [01:11<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.141, Train_accy 42.08:   5%|▌         | 1/20 [01:11<22:38, 71.50s/it]
Task 0, Epoch 2/20 => Loss 1.388, Train_accy 70.32:   5%|▌         | 1/20 [02:22<22:38, 71.50s/it]
Task 0, Epoch 2/20 => Loss 1.388, Train_accy 70.32:  10%|█         | 2/20 [02:22<21:22, 71.23s/it]
Task 0, Epoch 3/20 => Loss 1.292, Train_accy 72.14:  10%|█         | 2/20 [03:33<21:22, 71.23s/it]
Task 0, Epoch 3/20 => Loss 1.292, Train_accy 72.14:  15%|█▌        | 3/20 [03:33<20:11, 71.26s/it]
Task 0, Epoch 4/20 => Loss 1.272, Train_accy 72.05:  15%|█▌        | 3/20 [04:45<20:11, 71.26s/it]
Task 0, Epoch 4/20 => Loss 1.272, Train_accy 72.05:  20%|██        | 4/20 [04:45<19:00, 71.25s/it]
Task 0, Epoch 5/20 => Loss 1.272, Train_accy 72.29:  20%|██        | 4/20 [05:56<19:00, 71.25s/it]
Task 0, Epoch 5/20 => Loss 1.272, Train_accy 72.29:  25%|██▌       | 5/20 [05:56<17:48, 71.26s/it]
Task 0, Epoch 6/20 => Loss 1.255, Train_accy 72.58:  25%|██▌       | 5/20 [07:07<17:48, 71.26s/it]
Task 0, Epoch 6/20 => Loss 1.255, Train_accy 72.58:  30%|███       | 6/20 [07:07<16:37, 71.24s/it]
Task 0, Epoch 7/20 => Loss 1.241, Train_accy 72.81:  30%|███       | 6/20 [08:18<16:37, 71.24s/it]
Task 0, Epoch 7/20 => Loss 1.241, Train_accy 72.81:  35%|███▌      | 7/20 [08:18<15:26, 71.23s/it]
Task 0, Epoch 8/20 => Loss 1.226, Train_accy 73.27:  35%|███▌      | 7/20 [09:30<15:26, 71.23s/it]
Task 0, Epoch 8/20 => Loss 1.226, Train_accy 73.27:  40%|████      | 8/20 [09:30<14:15, 71.25s/it]
Task 0, Epoch 9/20 => Loss 1.229, Train_accy 73.46:  40%|████      | 8/20 [10:41<14:15, 71.25s/it]
Task 0, Epoch 9/20 => Loss 1.229, Train_accy 73.46:  45%|████▌     | 9/20 [10:41<13:03, 71.20s/it]
Task 0, Epoch 10/20 => Loss 1.200, Train_accy 73.79:  45%|████▌     | 9/20 [11:52<13:03, 71.20s/it]
Task 0, Epoch 10/20 => Loss 1.200, Train_accy 73.79:  50%|█████     | 10/20 [11:52<11:52, 71.24s/it]
Task 0, Epoch 11/20 => Loss 1.178, Train_accy 74.14:  50%|█████     | 10/20 [13:03<11:52, 71.24s/it]
Task 0, Epoch 11/20 => Loss 1.178, Train_accy 74.14:  55%|█████▌    | 11/20 [13:03<10:41, 71.28s/it]
Task 0, Epoch 12/20 => Loss 1.159, Train_accy 74.27:  55%|█████▌    | 11/20 [14:15<10:41, 71.28s/it]
Task 0, Epoch 12/20 => Loss 1.159, Train_accy 74.27:  60%|██████    | 12/20 [14:15<09:32, 71.53s/it]
Task 0, Epoch 13/20 => Loss 1.144, Train_accy 75.18:  60%|██████    | 12/20 [15:27<09:32, 71.53s/it]
Task 0, Epoch 13/20 => Loss 1.144, Train_accy 75.18:  65%|██████▌   | 13/20 [15:27<08:20, 71.43s/it]
Task 0, Epoch 14/20 => Loss 1.113, Train_accy 75.62:  65%|██████▌   | 13/20 [16:38<08:20, 71.43s/it]
Task 0, Epoch 14/20 => Loss 1.113, Train_accy 75.62:  70%|███████   | 14/20 [16:38<07:08, 71.35s/it]
Task 0, Epoch 15/20 => Loss 1.105, Train_accy 75.36:  70%|███████   | 14/20 [17:49<07:08, 71.35s/it]
Task 0, Epoch 15/20 => Loss 1.105, Train_accy 75.36:  75%|███████▌  | 15/20 [17:49<05:56, 71.32s/it]
Task 0, Epoch 16/20 => Loss 1.088, Train_accy 75.82:  75%|███████▌  | 15/20 [19:00<05:56, 71.32s/it]
Task 0, Epoch 16/20 => Loss 1.088, Train_accy 75.82:  80%|████████  | 16/20 [19:00<04:45, 71.28s/it]
Task 0, Epoch 17/20 => Loss 1.082, Train_accy 76.30:  80%|████████  | 16/20 [20:12<04:45, 71.28s/it]
Task 0, Epoch 17/20 => Loss 1.082, Train_accy 76.30:  85%|████████▌ | 17/20 [20:12<03:33, 71.29s/it]
Task 0, Epoch 18/20 => Loss 1.018, Train_accy 77.67:  85%|████████▌ | 17/20 [21:23<03:33, 71.29s/it]
Task 0, Epoch 18/20 => Loss 1.018, Train_accy 77.67:  90%|█████████ | 18/20 [21:23<02:22, 71.22s/it]
Task 0, Epoch 19/20 => Loss 1.021, Train_accy 77.62:  90%|█████████ | 18/20 [22:33<02:22, 71.22s/it]
Task 0, Epoch 19/20 => Loss 1.021, Train_accy 77.62:  95%|█████████▌| 19/20 [22:33<01:11, 71.10s/it]
Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29:  95%|█████████▌| 19/20 [23:44<01:11, 71.10s/it]
Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29: 100%|██████████| 20/20 [23:44<00:00, 71.08s/it]
Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29: 100%|██████████| 20/20 [23:44<00:00, 71.25s/it]
2024-09-08 11:45:35,926 [ease.py] => Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29
2024-09-08 11:46:22,246 [ease.py] => Task correct: 84.52261306532664
2024-09-08 11:46:22,246 [ease.py] => Task acc: 88.84422110552764
2024-09-08 11:46:22,273 [trainer.py] => No NME accuracy.
2024-09-08 11:46:22,273 [trainer.py] => CNN: {'total': 81.21, '00-99': 81.21, 'old': 0, 'new': 81.21}
2024-09-08 11:46:22,273 [trainer.py] => CNN top1 curve: [81.21]
2024-09-08 11:46:22,273 [trainer.py] => CNN top5 curve: [93.57]

Average Accuracy (CNN): 81.21
2024-09-08 11:46:22,273 [trainer.py] => Average Accuracy (CNN): 81.21 

2024-09-08 11:46:22,274 [trainer.py] => All params: 86256578
2024-09-08 11:46:22,275 [trainer.py] => Trainable params: 304320
2024-09-08 11:46:22,277 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.705, Train_accy 35.23:   0%|          | 0/20 [00:15<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.705, Train_accy 35.23:   5%|▌         | 1/20 [00:15<05:00, 15.79s/it]
Task 1, Epoch 2/20 => Loss 1.633, Train_accy 67.09:   5%|▌         | 1/20 [00:31<05:00, 15.79s/it]
Task 1, Epoch 2/20 => Loss 1.633, Train_accy 67.09:  10%|█         | 2/20 [00:31<04:43, 15.73s/it]
Task 1, Epoch 3/20 => Loss 0.946, Train_accy 78.76:  10%|█         | 2/20 [00:47<04:43, 15.73s/it]
Task 1, Epoch 3/20 => Loss 0.946, Train_accy 78.76:  15%|█▌        | 3/20 [00:47<04:27, 15.73s/it]
Task 1, Epoch 4/20 => Loss 0.724, Train_accy 82.40:  15%|█▌        | 3/20 [01:02<04:27, 15.73s/it]
Task 1, Epoch 4/20 => Loss 0.724, Train_accy 82.40:  20%|██        | 4/20 [01:02<04:11, 15.72s/it]
Task 1, Epoch 5/20 => Loss 0.649, Train_accy 83.49:  20%|██        | 4/20 [01:18<04:11, 15.72s/it]
Task 1, Epoch 5/20 => Loss 0.649, Train_accy 83.49:  25%|██▌       | 5/20 [01:18<03:55, 15.72s/it]
Task 1, Epoch 6/20 => Loss 0.623, Train_accy 84.09:  25%|██▌       | 5/20 [01:34<03:55, 15.72s/it]
Task 1, Epoch 6/20 => Loss 0.623, Train_accy 84.09:  30%|███       | 6/20 [01:34<03:39, 15.70s/it]
Task 1, Epoch 7/20 => Loss 0.582, Train_accy 85.40:  30%|███       | 6/20 [01:49<03:39, 15.70s/it]
Task 1, Epoch 7/20 => Loss 0.582, Train_accy 85.40:  35%|███▌      | 7/20 [01:49<03:23, 15.69s/it]
Task 1, Epoch 8/20 => Loss 0.564, Train_accy 85.07:  35%|███▌      | 7/20 [02:05<03:23, 15.69s/it]
Task 1, Epoch 8/20 => Loss 0.564, Train_accy 85.07:  40%|████      | 8/20 [02:05<03:08, 15.70s/it]
Task 1, Epoch 9/20 => Loss 0.567, Train_accy 85.33:  40%|████      | 8/20 [02:21<03:08, 15.70s/it]
Task 1, Epoch 9/20 => Loss 0.567, Train_accy 85.33:  45%|████▌     | 9/20 [02:21<02:53, 15.77s/it]
Task 1, Epoch 10/20 => Loss 0.555, Train_accy 85.74:  45%|████▌     | 9/20 [02:37<02:53, 15.77s/it]
Task 1, Epoch 10/20 => Loss 0.555, Train_accy 85.74:  50%|█████     | 10/20 [02:37<02:37, 15.75s/it]
Task 1, Epoch 11/20 => Loss 0.540, Train_accy 86.08:  50%|█████     | 10/20 [02:52<02:37, 15.75s/it]
Task 1, Epoch 11/20 => Loss 0.540, Train_accy 86.08:  55%|█████▌    | 11/20 [02:52<02:21, 15.70s/it]
Task 1, Epoch 12/20 => Loss 0.523, Train_accy 85.93:  55%|█████▌    | 11/20 [03:08<02:21, 15.70s/it]
Task 1, Epoch 12/20 => Loss 0.523, Train_accy 85.93:  60%|██████    | 12/20 [03:08<02:05, 15.71s/it]
Task 1, Epoch 13/20 => Loss 0.506, Train_accy 86.75:  60%|██████    | 12/20 [03:24<02:05, 15.71s/it]
Task 1, Epoch 13/20 => Loss 0.506, Train_accy 86.75:  65%|██████▌   | 13/20 [03:24<01:49, 15.69s/it]
Task 1, Epoch 14/20 => Loss 0.494, Train_accy 86.90:  65%|██████▌   | 13/20 [03:39<01:49, 15.69s/it]
Task 1, Epoch 14/20 => Loss 0.494, Train_accy 86.90:  70%|███████   | 14/20 [03:39<01:33, 15.66s/it]
Task 1, Epoch 15/20 => Loss 0.482, Train_accy 88.07:  70%|███████   | 14/20 [03:55<01:33, 15.66s/it]
Task 1, Epoch 15/20 => Loss 0.482, Train_accy 88.07:  75%|███████▌  | 15/20 [03:55<01:18, 15.64s/it]
Task 1, Epoch 16/20 => Loss 0.491, Train_accy 86.72:  75%|███████▌  | 15/20 [04:11<01:18, 15.64s/it]
Task 1, Epoch 16/20 => Loss 0.491, Train_accy 86.72:  80%|████████  | 16/20 [04:11<01:02, 15.64s/it]
Task 1, Epoch 17/20 => Loss 0.492, Train_accy 87.05:  80%|████████  | 16/20 [04:26<01:02, 15.64s/it]
Task 1, Epoch 17/20 => Loss 0.492, Train_accy 87.05:  85%|████████▌ | 17/20 [04:26<00:46, 15.66s/it]
Task 1, Epoch 18/20 => Loss 0.494, Train_accy 87.43:  85%|████████▌ | 17/20 [04:42<00:46, 15.66s/it]
Task 1, Epoch 18/20 => Loss 0.494, Train_accy 87.43:  90%|█████████ | 18/20 [04:42<00:31, 15.68s/it]
Task 1, Epoch 19/20 => Loss 0.476, Train_accy 87.54:  90%|█████████ | 18/20 [04:58<00:31, 15.68s/it]
Task 1, Epoch 19/20 => Loss 0.476, Train_accy 87.54:  95%|█████████▌| 19/20 [04:58<00:15, 15.68s/it]
Task 1, Epoch 20/20 => Loss 0.469, Train_accy 87.92:  95%|█████████▌| 19/20 [05:13<00:15, 15.68s/it]
Task 1, Epoch 20/20 => Loss 0.469, Train_accy 87.92: 100%|██████████| 20/20 [05:13<00:00, 15.68s/it]
Task 1, Epoch 20/20 => Loss 0.469, Train_accy 87.92: 100%|██████████| 20/20 [05:13<00:00, 15.70s/it]
2024-09-08 11:51:36,192 [ease.py] => Task 1, Epoch 20/20 => Loss 0.469, Train_accy 87.92
2024-09-08 11:52:14,285 [ease.py] => Task correct: 82.05761316872427
2024-09-08 11:52:14,286 [ease.py] => Task acc: 89.41015089163237
2024-09-08 11:52:14,307 [trainer.py] => No NME accuracy.
2024-09-08 11:52:14,307 [trainer.py] => CNN: {'total': 79.09, '00-99': 77.25, '100-119': 87.42, 'old': 77.25, 'new': 87.42}
2024-09-08 11:52:14,307 [trainer.py] => CNN top1 curve: [81.21, 79.09]
2024-09-08 11:52:14,307 [trainer.py] => CNN top5 curve: [93.57, 92.76]

Average Accuracy (CNN): 80.15
2024-09-08 11:52:14,307 [trainer.py] => Average Accuracy (CNN): 80.15 

2024-09-08 11:52:14,308 [trainer.py] => All params: 86302658
2024-09-08 11:52:14,308 [trainer.py] => Trainable params: 304320
2024-09-08 11:52:14,311 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.792, Train_accy 31.17:   0%|          | 0/20 [00:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.792, Train_accy 31.17:   5%|▌         | 1/20 [00:12<03:57, 12.52s/it]
Task 2, Epoch 2/20 => Loss 1.854, Train_accy 65.02:   5%|▌         | 1/20 [00:25<03:57, 12.52s/it]
Task 2, Epoch 2/20 => Loss 1.854, Train_accy 65.02:  10%|█         | 2/20 [00:25<03:47, 12.63s/it]
Task 2, Epoch 3/20 => Loss 1.172, Train_accy 77.31:  10%|█         | 2/20 [00:37<03:47, 12.63s/it]
Task 2, Epoch 3/20 => Loss 1.172, Train_accy 77.31:  15%|█▌        | 3/20 [00:37<03:34, 12.62s/it]
Task 2, Epoch 4/20 => Loss 0.831, Train_accy 81.69:  15%|█▌        | 3/20 [00:50<03:34, 12.62s/it]
Task 2, Epoch 4/20 => Loss 0.831, Train_accy 81.69:  20%|██        | 4/20 [00:50<03:21, 12.62s/it]
Task 2, Epoch 5/20 => Loss 0.697, Train_accy 83.43:  20%|██        | 4/20 [01:03<03:21, 12.62s/it]
Task 2, Epoch 5/20 => Loss 0.697, Train_accy 83.43:  25%|██▌       | 5/20 [01:03<03:09, 12.60s/it]
Task 2, Epoch 6/20 => Loss 0.629, Train_accy 85.17:  25%|██▌       | 5/20 [01:15<03:09, 12.60s/it]
Task 2, Epoch 6/20 => Loss 0.629, Train_accy 85.17:  30%|███       | 6/20 [01:15<02:56, 12.62s/it]
Task 2, Epoch 7/20 => Loss 0.605, Train_accy 84.89:  30%|███       | 6/20 [01:28<02:56, 12.62s/it]
Task 2, Epoch 7/20 => Loss 0.605, Train_accy 84.89:  35%|███▌      | 7/20 [01:28<02:44, 12.62s/it]
Task 2, Epoch 8/20 => Loss 0.584, Train_accy 85.36:  35%|███▌      | 7/20 [01:41<02:44, 12.62s/it]
Task 2, Epoch 8/20 => Loss 0.584, Train_accy 85.36:  40%|████      | 8/20 [01:41<02:32, 12.68s/it]
Task 2, Epoch 9/20 => Loss 0.551, Train_accy 86.44:  40%|████      | 8/20 [01:53<02:32, 12.68s/it]
Task 2, Epoch 9/20 => Loss 0.551, Train_accy 86.44:  45%|████▌     | 9/20 [01:53<02:19, 12.69s/it]
Task 2, Epoch 10/20 => Loss 0.549, Train_accy 85.78:  45%|████▌     | 9/20 [02:06<02:19, 12.69s/it]
Task 2, Epoch 10/20 => Loss 0.549, Train_accy 85.78:  50%|█████     | 10/20 [02:06<02:06, 12.68s/it]
Task 2, Epoch 11/20 => Loss 0.506, Train_accy 87.15:  50%|█████     | 10/20 [02:19<02:06, 12.68s/it]
Task 2, Epoch 11/20 => Loss 0.506, Train_accy 87.15:  55%|█████▌    | 11/20 [02:19<01:53, 12.64s/it]
Task 2, Epoch 12/20 => Loss 0.516, Train_accy 87.71:  55%|█████▌    | 11/20 [02:31<01:53, 12.64s/it]
Task 2, Epoch 12/20 => Loss 0.516, Train_accy 87.71:  60%|██████    | 12/20 [02:31<01:40, 12.62s/it]
Task 2, Epoch 13/20 => Loss 0.502, Train_accy 87.85:  60%|██████    | 12/20 [02:44<01:40, 12.62s/it]
Task 2, Epoch 13/20 => Loss 0.502, Train_accy 87.85:  65%|██████▌   | 13/20 [02:44<01:28, 12.62s/it]
Task 2, Epoch 14/20 => Loss 0.508, Train_accy 86.39:  65%|██████▌   | 13/20 [02:56<01:28, 12.62s/it]
Task 2, Epoch 14/20 => Loss 0.508, Train_accy 86.39:  70%|███████   | 14/20 [02:56<01:15, 12.59s/it]
Task 2, Epoch 15/20 => Loss 0.483, Train_accy 88.28:  70%|███████   | 14/20 [03:09<01:15, 12.59s/it]
Task 2, Epoch 15/20 => Loss 0.483, Train_accy 88.28:  75%|███████▌  | 15/20 [03:09<01:02, 12.58s/it]
Task 2, Epoch 16/20 => Loss 0.461, Train_accy 87.90:  75%|███████▌  | 15/20 [03:21<01:02, 12.58s/it]
Task 2, Epoch 16/20 => Loss 0.461, Train_accy 87.90:  80%|████████  | 16/20 [03:21<00:50, 12.57s/it]
Task 2, Epoch 17/20 => Loss 0.481, Train_accy 87.76:  80%|████████  | 16/20 [03:34<00:50, 12.57s/it]
Task 2, Epoch 17/20 => Loss 0.481, Train_accy 87.76:  85%|████████▌ | 17/20 [03:34<00:37, 12.57s/it]
Task 2, Epoch 18/20 => Loss 0.477, Train_accy 88.28:  85%|████████▌ | 17/20 [03:46<00:37, 12.57s/it]
Task 2, Epoch 18/20 => Loss 0.477, Train_accy 88.28:  90%|█████████ | 18/20 [03:46<00:25, 12.56s/it]
Task 2, Epoch 19/20 => Loss 0.466, Train_accy 88.89:  90%|█████████ | 18/20 [03:59<00:25, 12.56s/it]
Task 2, Epoch 19/20 => Loss 0.466, Train_accy 88.89:  95%|█████████▌| 19/20 [03:59<00:12, 12.58s/it]
Task 2, Epoch 20/20 => Loss 0.480, Train_accy 87.71:  95%|█████████▌| 19/20 [04:12<00:12, 12.58s/it]
Task 2, Epoch 20/20 => Loss 0.480, Train_accy 87.71: 100%|██████████| 20/20 [04:12<00:00, 12.56s/it]
Task 2, Epoch 20/20 => Loss 0.480, Train_accy 87.71: 100%|██████████| 20/20 [04:12<00:00, 12.60s/it]
2024-09-08 11:56:26,406 [ease.py] => Task 2, Epoch 20/20 => Loss 0.480, Train_accy 87.71
2024-09-08 11:57:22,565 [ease.py] => Task correct: 80.5173232083531
2024-09-08 11:57:22,565 [ease.py] => Task acc: 89.53488372093024
2024-09-08 11:57:22,590 [trainer.py] => No NME accuracy.
2024-09-08 11:57:22,590 [trainer.py] => CNN: {'total': 77.98, '00-99': 75.34, '100-119': 85.61, '120-139': 82.95, 'old': 77.2, 'new': 82.95}
2024-09-08 11:57:22,590 [trainer.py] => CNN top1 curve: [81.21, 79.09, 77.98]
2024-09-08 11:57:22,590 [trainer.py] => CNN top5 curve: [93.57, 92.76, 92.03]

Average Accuracy (CNN): 79.43
2024-09-08 11:57:22,590 [trainer.py] => Average Accuracy (CNN): 79.43 

2024-09-08 11:57:22,591 [trainer.py] => All params: 86440898
2024-09-08 11:57:22,592 [trainer.py] => Trainable params: 304320
2024-09-08 11:57:22,596 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.640, Train_accy 37.89:   0%|          | 0/20 [00:16<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.640, Train_accy 37.89:   5%|▌         | 1/20 [00:16<05:13, 16.50s/it]
Task 3, Epoch 2/20 => Loss 1.513, Train_accy 69.85:   5%|▌         | 1/20 [00:32<05:13, 16.50s/it]
Task 3, Epoch 2/20 => Loss 1.513, Train_accy 69.85:  10%|█         | 2/20 [00:32<04:56, 16.49s/it]
Task 3, Epoch 3/20 => Loss 0.905, Train_accy 80.22:  10%|█         | 2/20 [00:49<04:56, 16.49s/it]
Task 3, Epoch 3/20 => Loss 0.905, Train_accy 80.22:  15%|█▌        | 3/20 [00:49<04:40, 16.52s/it]
Task 3, Epoch 4/20 => Loss 0.701, Train_accy 83.17:  15%|█▌        | 3/20 [01:06<04:40, 16.52s/it]
Task 3, Epoch 4/20 => Loss 0.701, Train_accy 83.17:  20%|██        | 4/20 [01:06<04:25, 16.60s/it]
Task 3, Epoch 5/20 => Loss 0.645, Train_accy 84.23:  20%|██        | 4/20 [01:22<04:25, 16.60s/it]
Task 3, Epoch 5/20 => Loss 0.645, Train_accy 84.23:  25%|██▌       | 5/20 [01:22<04:08, 16.59s/it]
Task 3, Epoch 6/20 => Loss 0.611, Train_accy 84.73:  25%|██▌       | 5/20 [01:39<04:08, 16.59s/it]
Task 3, Epoch 6/20 => Loss 0.611, Train_accy 84.73:  30%|███       | 6/20 [01:39<03:52, 16.62s/it]
Task 3, Epoch 7/20 => Loss 0.599, Train_accy 84.55:  30%|███       | 6/20 [01:56<03:52, 16.62s/it]
Task 3, Epoch 7/20 => Loss 0.599, Train_accy 84.55:  35%|███▌      | 7/20 [01:56<03:36, 16.64s/it]
Task 3, Epoch 8/20 => Loss 0.568, Train_accy 85.87:  35%|███▌      | 7/20 [02:12<03:36, 16.64s/it]
Task 3, Epoch 8/20 => Loss 0.568, Train_accy 85.87:  40%|████      | 8/20 [02:12<03:19, 16.62s/it]
Task 3, Epoch 9/20 => Loss 0.553, Train_accy 86.29:  40%|████      | 8/20 [02:29<03:19, 16.62s/it]
Task 3, Epoch 9/20 => Loss 0.553, Train_accy 86.29:  45%|████▌     | 9/20 [02:29<03:02, 16.58s/it]
Task 3, Epoch 10/20 => Loss 0.551, Train_accy 85.87:  45%|████▌     | 9/20 [02:45<03:02, 16.58s/it]
Task 3, Epoch 10/20 => Loss 0.551, Train_accy 85.87:  50%|█████     | 10/20 [02:45<02:45, 16.57s/it]
Task 3, Epoch 11/20 => Loss 0.541, Train_accy 86.51:  50%|█████     | 10/20 [03:02<02:45, 16.57s/it]
Task 3, Epoch 11/20 => Loss 0.541, Train_accy 86.51:  55%|█████▌    | 11/20 [03:02<02:29, 16.60s/it]
Task 3, Epoch 12/20 => Loss 0.520, Train_accy 86.97:  55%|█████▌    | 11/20 [03:18<02:29, 16.60s/it]
Task 3, Epoch 12/20 => Loss 0.520, Train_accy 86.97:  60%|██████    | 12/20 [03:18<02:12, 16.57s/it]
Task 3, Epoch 13/20 => Loss 0.532, Train_accy 86.65:  60%|██████    | 12/20 [03:35<02:12, 16.57s/it]
Task 3, Epoch 13/20 => Loss 0.532, Train_accy 86.65:  65%|██████▌   | 13/20 [03:35<01:56, 16.59s/it]
Task 3, Epoch 14/20 => Loss 0.494, Train_accy 88.07:  65%|██████▌   | 13/20 [03:52<01:56, 16.59s/it]
Task 3, Epoch 14/20 => Loss 0.494, Train_accy 88.07:  70%|███████   | 14/20 [03:52<01:39, 16.59s/it]
Task 3, Epoch 15/20 => Loss 0.516, Train_accy 86.90:  70%|███████   | 14/20 [04:08<01:39, 16.59s/it]
Task 3, Epoch 15/20 => Loss 0.516, Train_accy 86.90:  75%|███████▌  | 15/20 [04:08<01:22, 16.55s/it]
Task 3, Epoch 16/20 => Loss 0.497, Train_accy 87.96:  75%|███████▌  | 15/20 [04:25<01:22, 16.55s/it]
Task 3, Epoch 16/20 => Loss 0.497, Train_accy 87.96:  80%|████████  | 16/20 [04:25<01:06, 16.54s/it]
Task 3, Epoch 17/20 => Loss 0.487, Train_accy 87.57:  80%|████████  | 16/20 [04:41<01:06, 16.54s/it]
Task 3, Epoch 17/20 => Loss 0.487, Train_accy 87.57:  85%|████████▌ | 17/20 [04:41<00:49, 16.53s/it]
Task 3, Epoch 18/20 => Loss 0.489, Train_accy 87.43:  85%|████████▌ | 17/20 [04:58<00:49, 16.53s/it]
Task 3, Epoch 18/20 => Loss 0.489, Train_accy 87.43:  90%|█████████ | 18/20 [04:58<00:33, 16.51s/it]
Task 3, Epoch 19/20 => Loss 0.470, Train_accy 88.25:  90%|█████████ | 18/20 [05:14<00:33, 16.51s/it]
Task 3, Epoch 19/20 => Loss 0.470, Train_accy 88.25:  95%|█████████▌| 19/20 [05:14<00:16, 16.49s/it]
Task 3, Epoch 20/20 => Loss 0.477, Train_accy 88.00:  95%|█████████▌| 19/20 [05:31<00:16, 16.49s/it]
Task 3, Epoch 20/20 => Loss 0.477, Train_accy 88.00: 100%|██████████| 20/20 [05:31<00:00, 16.49s/it]
Task 3, Epoch 20/20 => Loss 0.477, Train_accy 88.00: 100%|██████████| 20/20 [05:31<00:00, 16.55s/it]
2024-09-08 12:02:53,694 [ease.py] => Task 3, Epoch 20/20 => Loss 0.477, Train_accy 88.00
2024-09-08 12:04:25,125 [ease.py] => Task correct: 79.850293344123
2024-09-08 12:04:25,126 [ease.py] => Task acc: 89.82399352619866
2024-09-08 12:04:25,149 [trainer.py] => No NME accuracy.
2024-09-08 12:04:25,149 [trainer.py] => CNN: {'total': 77.44, '00-99': 74.0, '100-119': 83.18, '120-139': 81.2, '140-159': 83.4, 'old': 76.41, 'new': 83.4}
2024-09-08 12:04:25,149 [trainer.py] => CNN top1 curve: [81.21, 79.09, 77.98, 77.44]
2024-09-08 12:04:25,149 [trainer.py] => CNN top5 curve: [93.57, 92.76, 92.03, 91.58]

Average Accuracy (CNN): 78.93
2024-09-08 12:04:25,149 [trainer.py] => Average Accuracy (CNN): 78.93 

2024-09-08 12:04:25,150 [trainer.py] => All params: 86609858
2024-09-08 12:04:25,151 [trainer.py] => Trainable params: 304320
2024-09-08 12:04:25,157 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.864, Train_accy 26.90:   0%|          | 0/20 [00:11<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.864, Train_accy 26.90:   5%|▌         | 1/20 [00:11<03:39, 11.54s/it]
Task 4, Epoch 2/20 => Loss 2.127, Train_accy 57.49:   5%|▌         | 1/20 [00:23<03:39, 11.54s/it]
Task 4, Epoch 2/20 => Loss 2.127, Train_accy 57.49:  10%|█         | 2/20 [00:23<03:27, 11.54s/it]
Task 4, Epoch 3/20 => Loss 1.414, Train_accy 73.10:  10%|█         | 2/20 [00:34<03:27, 11.54s/it]
Task 4, Epoch 3/20 => Loss 1.414, Train_accy 73.10:  15%|█▌        | 3/20 [00:34<03:16, 11.58s/it]
Task 4, Epoch 4/20 => Loss 1.009, Train_accy 76.90:  15%|█▌        | 3/20 [00:46<03:16, 11.58s/it]
Task 4, Epoch 4/20 => Loss 1.009, Train_accy 76.90:  20%|██        | 4/20 [00:46<03:04, 11.56s/it]
Task 4, Epoch 5/20 => Loss 0.848, Train_accy 80.70:  20%|██        | 4/20 [00:57<03:04, 11.56s/it]
Task 4, Epoch 5/20 => Loss 0.848, Train_accy 80.70:  25%|██▌       | 5/20 [00:57<02:52, 11.52s/it]
Task 4, Epoch 6/20 => Loss 0.713, Train_accy 82.60:  25%|██▌       | 5/20 [01:09<02:52, 11.52s/it]
Task 4, Epoch 6/20 => Loss 0.713, Train_accy 82.60:  30%|███       | 6/20 [01:09<02:42, 11.63s/it]
Task 4, Epoch 7/20 => Loss 0.681, Train_accy 83.78:  30%|███       | 6/20 [01:21<02:42, 11.63s/it]
Task 4, Epoch 7/20 => Loss 0.681, Train_accy 83.78:  35%|███▌      | 7/20 [01:21<02:30, 11.58s/it]
Task 4, Epoch 8/20 => Loss 0.660, Train_accy 83.26:  35%|███▌      | 7/20 [01:32<02:30, 11.58s/it]
Task 4, Epoch 8/20 => Loss 0.660, Train_accy 83.26:  40%|████      | 8/20 [01:32<02:18, 11.56s/it]
Task 4, Epoch 9/20 => Loss 0.642, Train_accy 84.19:  40%|████      | 8/20 [01:44<02:18, 11.56s/it]
Task 4, Epoch 9/20 => Loss 0.642, Train_accy 84.19:  45%|████▌     | 9/20 [01:44<02:06, 11.54s/it]
Task 4, Epoch 10/20 => Loss 0.597, Train_accy 85.32:  45%|████▌     | 9/20 [01:55<02:06, 11.54s/it]
Task 4, Epoch 10/20 => Loss 0.597, Train_accy 85.32:  50%|█████     | 10/20 [01:55<01:55, 11.53s/it]
Task 4, Epoch 11/20 => Loss 0.629, Train_accy 83.98:  50%|█████     | 10/20 [02:06<01:55, 11.53s/it]
Task 4, Epoch 11/20 => Loss 0.629, Train_accy 83.98:  55%|█████▌    | 11/20 [02:06<01:43, 11.50s/it]
Task 4, Epoch 12/20 => Loss 0.597, Train_accy 84.75:  55%|█████▌    | 11/20 [02:18<01:43, 11.50s/it]
Task 4, Epoch 12/20 => Loss 0.597, Train_accy 84.75:  60%|██████    | 12/20 [02:18<01:31, 11.50s/it]
Task 4, Epoch 13/20 => Loss 0.578, Train_accy 85.42:  60%|██████    | 12/20 [02:29<01:31, 11.50s/it]
Task 4, Epoch 13/20 => Loss 0.578, Train_accy 85.42:  65%|██████▌   | 13/20 [02:29<01:20, 11.50s/it]
Task 4, Epoch 14/20 => Loss 0.582, Train_accy 84.91:  65%|██████▌   | 13/20 [02:41<01:20, 11.50s/it]
Task 4, Epoch 14/20 => Loss 0.582, Train_accy 84.91:  70%|███████   | 14/20 [02:41<01:09, 11.51s/it]
Task 4, Epoch 15/20 => Loss 0.602, Train_accy 84.80:  70%|███████   | 14/20 [02:53<01:09, 11.51s/it]
Task 4, Epoch 15/20 => Loss 0.602, Train_accy 84.80:  75%|███████▌  | 15/20 [02:53<00:57, 11.53s/it]
Task 4, Epoch 16/20 => Loss 0.584, Train_accy 85.52:  75%|███████▌  | 15/20 [03:04<00:57, 11.53s/it]
Task 4, Epoch 16/20 => Loss 0.584, Train_accy 85.52:  80%|████████  | 16/20 [03:04<00:46, 11.54s/it]
Task 4, Epoch 17/20 => Loss 0.543, Train_accy 86.14:  80%|████████  | 16/20 [03:16<00:46, 11.54s/it]
Task 4, Epoch 17/20 => Loss 0.543, Train_accy 86.14:  85%|████████▌ | 17/20 [03:16<00:34, 11.57s/it]
Task 4, Epoch 18/20 => Loss 0.547, Train_accy 85.37:  85%|████████▌ | 17/20 [03:27<00:34, 11.57s/it]
Task 4, Epoch 18/20 => Loss 0.547, Train_accy 85.37:  90%|█████████ | 18/20 [03:27<00:23, 11.59s/it]
Task 4, Epoch 19/20 => Loss 0.576, Train_accy 85.22:  90%|█████████ | 18/20 [03:39<00:23, 11.59s/it]
Task 4, Epoch 19/20 => Loss 0.576, Train_accy 85.22:  95%|█████████▌| 19/20 [03:39<00:11, 11.61s/it]
Task 4, Epoch 20/20 => Loss 0.523, Train_accy 87.11:  95%|█████████▌| 19/20 [03:51<00:11, 11.61s/it]
Task 4, Epoch 20/20 => Loss 0.523, Train_accy 87.11: 100%|██████████| 20/20 [03:51<00:00, 11.63s/it]
Task 4, Epoch 20/20 => Loss 0.523, Train_accy 87.11: 100%|██████████| 20/20 [03:51<00:00, 11.56s/it]
2024-09-08 12:08:16,393 [ease.py] => Task 4, Epoch 20/20 => Loss 0.523, Train_accy 87.11
2024-09-08 12:10:04,962 [ease.py] => Task correct: 78.60173399741745
2024-09-08 12:10:04,963 [ease.py] => Task acc: 89.81737686773658
2024-09-08 12:10:04,983 [trainer.py] => No NME accuracy.
2024-09-08 12:10:04,984 [trainer.py] => CNN: {'total': 76.41, '00-99': 72.63, '100-119': 82.42, '120-139': 80.32, '140-159': 82.03, '160-179': 78.45, 'old': 76.21, 'new': 78.45}
2024-09-08 12:10:04,984 [trainer.py] => CNN top1 curve: [81.21, 79.09, 77.98, 77.44, 76.41]
2024-09-08 12:10:04,984 [trainer.py] => CNN top5 curve: [93.57, 92.76, 92.03, 91.58, 90.7]

Average Accuracy (CNN): 78.43
2024-09-08 12:10:04,984 [trainer.py] => Average Accuracy (CNN): 78.43 

2024-09-08 12:10:04,984 [trainer.py] => All params: 86809538
2024-09-08 12:10:04,985 [trainer.py] => Trainable params: 304320
2024-09-08 12:10:04,992 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.741, Train_accy 35.77:   0%|          | 0/20 [00:13<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.741, Train_accy 35.77:   5%|▌         | 1/20 [00:13<04:14, 13.38s/it]
Task 5, Epoch 2/20 => Loss 1.689, Train_accy 67.05:   5%|▌         | 1/20 [00:26<04:14, 13.38s/it]
Task 5, Epoch 2/20 => Loss 1.689, Train_accy 67.05:  10%|█         | 2/20 [00:26<04:00, 13.37s/it]
Task 5, Epoch 3/20 => Loss 1.029, Train_accy 78.68:  10%|█         | 2/20 [00:40<04:00, 13.37s/it]
Task 5, Epoch 3/20 => Loss 1.029, Train_accy 78.68:  15%|█▌        | 3/20 [00:40<03:47, 13.36s/it]
Task 5, Epoch 4/20 => Loss 0.778, Train_accy 81.45:  15%|█▌        | 3/20 [00:53<03:47, 13.36s/it]
Task 5, Epoch 4/20 => Loss 0.778, Train_accy 81.45:  20%|██        | 4/20 [00:53<03:33, 13.35s/it]
Task 5, Epoch 5/20 => Loss 0.679, Train_accy 82.86:  20%|██        | 4/20 [01:07<03:33, 13.35s/it]
Task 5, Epoch 5/20 => Loss 0.679, Train_accy 82.86:  25%|██▌       | 5/20 [01:07<03:21, 13.45s/it]
Task 5, Epoch 6/20 => Loss 0.663, Train_accy 83.83:  25%|██▌       | 5/20 [01:20<03:21, 13.45s/it]
Task 5, Epoch 6/20 => Loss 0.663, Train_accy 83.83:  30%|███       | 6/20 [01:20<03:08, 13.44s/it]
Task 5, Epoch 7/20 => Loss 0.616, Train_accy 84.76:  30%|███       | 6/20 [01:33<03:08, 13.44s/it]
Task 5, Epoch 7/20 => Loss 0.616, Train_accy 84.76:  35%|███▌      | 7/20 [01:33<02:54, 13.43s/it]
Task 5, Epoch 8/20 => Loss 0.575, Train_accy 85.33:  35%|███▌      | 7/20 [01:47<02:54, 13.43s/it]
Task 5, Epoch 8/20 => Loss 0.575, Train_accy 85.33:  40%|████      | 8/20 [01:47<02:41, 13.43s/it]
Task 5, Epoch 9/20 => Loss 0.576, Train_accy 85.20:  40%|████      | 8/20 [02:00<02:41, 13.43s/it]
Task 5, Epoch 9/20 => Loss 0.576, Train_accy 85.20:  45%|████▌     | 9/20 [02:00<02:27, 13.45s/it]
Task 5, Epoch 10/20 => Loss 0.582, Train_accy 85.55:  45%|████▌     | 9/20 [02:14<02:27, 13.45s/it]
Task 5, Epoch 10/20 => Loss 0.582, Train_accy 85.55:  50%|█████     | 10/20 [02:14<02:15, 13.52s/it]
Task 5, Epoch 11/20 => Loss 0.562, Train_accy 85.51:  50%|█████     | 10/20 [02:27<02:15, 13.52s/it]
Task 5, Epoch 11/20 => Loss 0.562, Train_accy 85.51:  55%|█████▌    | 11/20 [02:27<02:01, 13.50s/it]
Task 5, Epoch 12/20 => Loss 0.567, Train_accy 85.68:  55%|█████▌    | 11/20 [02:41<02:01, 13.50s/it]
Task 5, Epoch 12/20 => Loss 0.567, Train_accy 85.68:  60%|██████    | 12/20 [02:41<01:47, 13.47s/it]
Task 5, Epoch 13/20 => Loss 0.520, Train_accy 86.92:  60%|██████    | 12/20 [02:54<01:47, 13.47s/it]
Task 5, Epoch 13/20 => Loss 0.520, Train_accy 86.92:  65%|██████▌   | 13/20 [02:54<01:34, 13.45s/it]
Task 5, Epoch 14/20 => Loss 0.517, Train_accy 87.27:  65%|██████▌   | 13/20 [03:08<01:34, 13.45s/it]
Task 5, Epoch 14/20 => Loss 0.517, Train_accy 87.27:  70%|███████   | 14/20 [03:08<01:20, 13.46s/it]
Task 5, Epoch 15/20 => Loss 0.516, Train_accy 87.27:  70%|███████   | 14/20 [03:21<01:20, 13.46s/it]
Task 5, Epoch 15/20 => Loss 0.516, Train_accy 87.27:  75%|███████▌  | 15/20 [03:21<01:07, 13.44s/it]
Task 5, Epoch 16/20 => Loss 0.514, Train_accy 87.62:  75%|███████▌  | 15/20 [03:35<01:07, 13.44s/it]
Task 5, Epoch 16/20 => Loss 0.514, Train_accy 87.62:  80%|████████  | 16/20 [03:35<00:53, 13.45s/it]
Task 5, Epoch 17/20 => Loss 0.484, Train_accy 87.27:  80%|████████  | 16/20 [03:48<00:53, 13.45s/it]
Task 5, Epoch 17/20 => Loss 0.484, Train_accy 87.27:  85%|████████▌ | 17/20 [03:48<00:40, 13.46s/it]
Task 5, Epoch 18/20 => Loss 0.517, Train_accy 86.78:  85%|████████▌ | 17/20 [04:01<00:40, 13.46s/it]
Task 5, Epoch 18/20 => Loss 0.517, Train_accy 86.78:  90%|█████████ | 18/20 [04:01<00:26, 13.44s/it]
Task 5, Epoch 19/20 => Loss 0.488, Train_accy 88.15:  90%|█████████ | 18/20 [04:15<00:26, 13.44s/it]
Task 5, Epoch 19/20 => Loss 0.488, Train_accy 88.15:  95%|█████████▌| 19/20 [04:15<00:13, 13.43s/it]
Task 5, Epoch 20/20 => Loss 0.488, Train_accy 88.33:  95%|█████████▌| 19/20 [04:28<00:13, 13.43s/it]
Task 5, Epoch 20/20 => Loss 0.488, Train_accy 88.33: 100%|██████████| 20/20 [04:28<00:00, 13.42s/it]
Task 5, Epoch 20/20 => Loss 0.488, Train_accy 88.33: 100%|██████████| 20/20 [04:28<00:00, 13.44s/it]
2024-09-08 12:14:33,777 [ease.py] => Task 5, Epoch 20/20 => Loss 0.488, Train_accy 88.33
2024-09-08 12:16:58,266 [ease.py] => Task correct: 77.6
2024-09-08 12:16:58,267 [ease.py] => Task acc: 89.98333333333333
2024-09-08 12:16:58,289 [trainer.py] => No NME accuracy.
2024-09-08 12:16:58,289 [trainer.py] => CNN: {'total': 75.58, '00-99': 71.06, '100-119': 81.52, '120-139': 78.73, '140-159': 81.76, '160-179': 77.2, '180-199': 79.97, 'old': 75.12, 'new': 79.97}
2024-09-08 12:16:58,289 [trainer.py] => CNN top1 curve: [81.21, 79.09, 77.98, 77.44, 76.41, 75.58]
2024-09-08 12:16:58,289 [trainer.py] => CNN top5 curve: [93.57, 92.76, 92.03, 91.58, 90.7, 90.13]

Average Accuracy (CNN): 77.95
2024-09-08 12:16:58,290 [trainer.py] => Average Accuracy (CNN): 77.95 

Accuracy Matrix (CNN):
[[81.21 77.25 75.34 74.   72.63 71.06]
 [ 0.   87.42 85.61 83.18 82.42 81.52]
 [ 0.    0.   82.95 81.2  80.32 78.73]
 [ 0.    0.    0.   83.4  82.03 81.76]
 [ 0.    0.    0.    0.   78.45 77.2 ]
 [ 0.    0.    0.    0.    0.   79.97]]
2024-09-08 12:16:58,290 [trainer.py] => Forgetting (CNN): 4.632
2024-09-08 12:17:01,107 [trainer.py] => config: ./exps/ease_inr_B100_Inc10.json
2024-09-08 12:17:01,107 [trainer.py] => prefix:  
2024-09-08 12:17:01,107 [trainer.py] => dataset: imagenetr
2024-09-08 12:17:01,107 [trainer.py] => memory_size: 0
2024-09-08 12:17:01,107 [trainer.py] => memory_per_class: 0
2024-09-08 12:17:01,107 [trainer.py] => fixed_memory: False
2024-09-08 12:17:01,107 [trainer.py] => shuffle: True
2024-09-08 12:17:01,107 [trainer.py] => init_cls: 100
2024-09-08 12:17:01,108 [trainer.py] => increment: 10
2024-09-08 12:17:01,108 [trainer.py] => model_name: ease
2024-09-08 12:17:01,108 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-08 12:17:01,108 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-08 12:17:01,108 [trainer.py] => seed: 1993
2024-09-08 12:17:01,108 [trainer.py] => init_epochs: 20
2024-09-08 12:17:01,108 [trainer.py] => init_lr: 0.05
2024-09-08 12:17:01,108 [trainer.py] => later_epochs: 20
2024-09-08 12:17:01,108 [trainer.py] => later_lr: 0.05
2024-09-08 12:17:01,108 [trainer.py] => batch_size: 48
2024-09-08 12:17:01,108 [trainer.py] => weight_decay: 0.005
2024-09-08 12:17:01,108 [trainer.py] => min_lr: 0
2024-09-08 12:17:01,108 [trainer.py] => optimizer: sgd
2024-09-08 12:17:01,108 [trainer.py] => scheduler: cosine
2024-09-08 12:17:01,108 [trainer.py] => pretrained: True
2024-09-08 12:17:01,108 [trainer.py] => vpt_type: Deep
2024-09-08 12:17:01,108 [trainer.py] => prompt_token_num: 5
2024-09-08 12:17:01,108 [trainer.py] => ffn_num: 16
2024-09-08 12:17:01,108 [trainer.py] => use_diagonal: False
2024-09-08 12:17:01,108 [trainer.py] => recalc_sim: True
2024-09-08 12:17:01,108 [trainer.py] => alpha: 0.1
2024-09-08 12:17:01,108 [trainer.py] => use_init_ptm: False
2024-09-08 12:17:01,108 [trainer.py] => beta: 0
2024-09-08 12:17:01,108 [trainer.py] => use_old_data: False
2024-09-08 12:17:01,108 [trainer.py] => use_reweight: True
2024-09-08 12:17:01,108 [trainer.py] => moni_adam: False
2024-09-08 12:17:01,108 [trainer.py] => adapter_num: -1
2024-09-08 12:17:01,191 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-08 12:17:04,072 [trainer.py] => All params: 86102976
2024-09-08 12:17:04,073 [trainer.py] => Trainable params: 304320
2024-09-08 12:17:04,081 [ease.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.141, Train_accy 42.08:   0%|          | 0/20 [01:10<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.141, Train_accy 42.08:   5%|▌         | 1/20 [01:10<22:18, 70.46s/it]
Task 0, Epoch 2/20 => Loss 1.388, Train_accy 70.32:   5%|▌         | 1/20 [02:20<22:18, 70.46s/it]
Task 0, Epoch 2/20 => Loss 1.388, Train_accy 70.32:  10%|█         | 2/20 [02:20<21:01, 70.07s/it]
Task 0, Epoch 3/20 => Loss 1.292, Train_accy 72.14:  10%|█         | 2/20 [03:30<21:01, 70.07s/it]
Task 0, Epoch 3/20 => Loss 1.292, Train_accy 72.14:  15%|█▌        | 3/20 [03:30<19:50, 70.02s/it]
Task 0, Epoch 4/20 => Loss 1.272, Train_accy 72.05:  15%|█▌        | 3/20 [04:40<19:50, 70.02s/it]
Task 0, Epoch 4/20 => Loss 1.272, Train_accy 72.05:  20%|██        | 4/20 [04:40<18:40, 70.04s/it]
Task 0, Epoch 5/20 => Loss 1.272, Train_accy 72.29:  20%|██        | 4/20 [05:50<18:40, 70.04s/it]
Task 0, Epoch 5/20 => Loss 1.272, Train_accy 72.29:  25%|██▌       | 5/20 [05:50<17:30, 70.01s/it]
Task 0, Epoch 6/20 => Loss 1.255, Train_accy 72.58:  25%|██▌       | 5/20 [07:00<17:30, 70.01s/it]
Task 0, Epoch 6/20 => Loss 1.255, Train_accy 72.58:  30%|███       | 6/20 [07:00<16:19, 69.98s/it]
Task 0, Epoch 7/20 => Loss 1.241, Train_accy 72.81:  30%|███       | 6/20 [08:10<16:19, 69.98s/it]
Task 0, Epoch 7/20 => Loss 1.241, Train_accy 72.81:  35%|███▌      | 7/20 [08:10<15:09, 69.96s/it]
Task 0, Epoch 8/20 => Loss 1.226, Train_accy 73.27:  35%|███▌      | 7/20 [09:19<15:09, 69.96s/it]
Task 0, Epoch 8/20 => Loss 1.226, Train_accy 73.27:  40%|████      | 8/20 [09:19<13:59, 69.93s/it]
Task 0, Epoch 9/20 => Loss 1.229, Train_accy 73.46:  40%|████      | 8/20 [10:29<13:59, 69.93s/it]
Task 0, Epoch 9/20 => Loss 1.229, Train_accy 73.46:  45%|████▌     | 9/20 [10:29<12:49, 69.91s/it]
Task 0, Epoch 10/20 => Loss 1.200, Train_accy 73.79:  45%|████▌     | 9/20 [11:39<12:49, 69.91s/it]
Task 0, Epoch 10/20 => Loss 1.200, Train_accy 73.79:  50%|█████     | 10/20 [11:39<11:38, 69.88s/it]
Task 0, Epoch 11/20 => Loss 1.178, Train_accy 74.14:  50%|█████     | 10/20 [12:49<11:38, 69.88s/it]
Task 0, Epoch 11/20 => Loss 1.178, Train_accy 74.14:  55%|█████▌    | 11/20 [12:49<10:28, 69.87s/it]
Task 0, Epoch 12/20 => Loss 1.159, Train_accy 74.27:  55%|█████▌    | 11/20 [13:59<10:28, 69.87s/it]
Task 0, Epoch 12/20 => Loss 1.159, Train_accy 74.27:  60%|██████    | 12/20 [13:59<09:18, 69.86s/it]
Task 0, Epoch 13/20 => Loss 1.144, Train_accy 75.18:  60%|██████    | 12/20 [15:09<09:18, 69.86s/it]
Task 0, Epoch 13/20 => Loss 1.144, Train_accy 75.18:  65%|██████▌   | 13/20 [15:09<08:09, 69.87s/it]
Task 0, Epoch 14/20 => Loss 1.113, Train_accy 75.62:  65%|██████▌   | 13/20 [16:19<08:09, 69.87s/it]
Task 0, Epoch 14/20 => Loss 1.113, Train_accy 75.62:  70%|███████   | 14/20 [16:19<06:59, 69.88s/it]
Task 0, Epoch 15/20 => Loss 1.105, Train_accy 75.36:  70%|███████   | 14/20 [17:28<06:59, 69.88s/it]
Task 0, Epoch 15/20 => Loss 1.105, Train_accy 75.36:  75%|███████▌  | 15/20 [17:28<05:49, 69.87s/it]
Task 0, Epoch 16/20 => Loss 1.088, Train_accy 75.82:  75%|███████▌  | 15/20 [18:39<05:49, 69.87s/it]
Task 0, Epoch 16/20 => Loss 1.088, Train_accy 75.82:  80%|████████  | 16/20 [18:39<04:39, 69.99s/it]
Task 0, Epoch 17/20 => Loss 1.082, Train_accy 76.30:  80%|████████  | 16/20 [19:49<04:39, 69.99s/it]
Task 0, Epoch 17/20 => Loss 1.082, Train_accy 76.30:  85%|████████▌ | 17/20 [19:49<03:29, 69.99s/it]
Task 0, Epoch 18/20 => Loss 1.018, Train_accy 77.67:  85%|████████▌ | 17/20 [20:59<03:29, 69.99s/it]
Task 0, Epoch 18/20 => Loss 1.018, Train_accy 77.67:  90%|█████████ | 18/20 [20:59<02:19, 69.95s/it]
Task 0, Epoch 19/20 => Loss 1.021, Train_accy 77.62:  90%|█████████ | 18/20 [22:08<02:19, 69.95s/it]
Task 0, Epoch 19/20 => Loss 1.021, Train_accy 77.62:  95%|█████████▌| 19/20 [22:08<01:09, 69.87s/it]
Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29:  95%|█████████▌| 19/20 [23:18<01:09, 69.87s/it]
Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29: 100%|██████████| 20/20 [23:18<00:00, 69.85s/it]
Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29: 100%|██████████| 20/20 [23:18<00:00, 69.93s/it]
2024-09-08 12:40:22,731 [ease.py] => Task 0, Epoch 20/20 => Loss 1.024, Train_accy 77.29
2024-09-08 12:41:08,296 [ease.py] => Task correct: 82.78056951423785
2024-09-08 12:41:08,297 [ease.py] => Task acc: 92.5963149078727
2024-09-08 12:41:08,324 [trainer.py] => No NME accuracy.
2024-09-08 12:41:08,325 [trainer.py] => CNN: {'total': 81.21, '00-99': 81.21, 'old': 0, 'new': 81.21}
2024-09-08 12:41:08,325 [trainer.py] => CNN top1 curve: [81.21]
2024-09-08 12:41:08,325 [trainer.py] => CNN top5 curve: [93.57]

Average Accuracy (CNN): 81.21
2024-09-08 12:41:08,325 [trainer.py] => Average Accuracy (CNN): 81.21 

2024-09-08 12:41:08,326 [trainer.py] => All params: 86256578
2024-09-08 12:41:08,326 [trainer.py] => Trainable params: 304320
2024-09-08 12:41:08,329 [ease.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.205, Train_accy 44.10:   0%|          | 0/20 [00:07<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.205, Train_accy 44.10:   5%|▌         | 1/20 [00:07<02:14,  7.10s/it]
Task 1, Epoch 2/20 => Loss 1.754, Train_accy 71.97:   5%|▌         | 1/20 [00:14<02:14,  7.10s/it]
Task 1, Epoch 2/20 => Loss 1.754, Train_accy 71.97:  10%|█         | 2/20 [00:14<02:07,  7.08s/it]
Task 1, Epoch 3/20 => Loss 1.273, Train_accy 80.26:  10%|█         | 2/20 [00:21<02:07,  7.08s/it]
Task 1, Epoch 3/20 => Loss 1.273, Train_accy 80.26:  15%|█▌        | 3/20 [00:21<02:00,  7.11s/it]
Task 1, Epoch 4/20 => Loss 0.969, Train_accy 82.48:  15%|█▌        | 3/20 [00:28<02:00,  7.11s/it]
Task 1, Epoch 4/20 => Loss 0.969, Train_accy 82.48:  20%|██        | 4/20 [00:28<01:53,  7.11s/it]
Task 1, Epoch 5/20 => Loss 0.762, Train_accy 85.04:  20%|██        | 4/20 [00:35<01:53,  7.11s/it]
Task 1, Epoch 5/20 => Loss 0.762, Train_accy 85.04:  25%|██▌       | 5/20 [00:35<01:47,  7.16s/it]
Task 1, Epoch 6/20 => Loss 0.643, Train_accy 86.67:  25%|██▌       | 5/20 [00:42<01:47,  7.16s/it]
Task 1, Epoch 6/20 => Loss 0.643, Train_accy 86.67:  30%|███       | 6/20 [00:42<01:40,  7.15s/it]
Task 1, Epoch 7/20 => Loss 0.566, Train_accy 86.67:  30%|███       | 6/20 [00:49<01:40,  7.15s/it]
Task 1, Epoch 7/20 => Loss 0.566, Train_accy 86.67:  35%|███▌      | 7/20 [00:49<01:33,  7.17s/it]
Task 1, Epoch 8/20 => Loss 0.531, Train_accy 87.18:  35%|███▌      | 7/20 [00:57<01:33,  7.17s/it]
Task 1, Epoch 8/20 => Loss 0.531, Train_accy 87.18:  40%|████      | 8/20 [00:57<01:26,  7.19s/it]
Task 1, Epoch 9/20 => Loss 0.475, Train_accy 88.29:  40%|████      | 8/20 [01:04<01:26,  7.19s/it]
Task 1, Epoch 9/20 => Loss 0.475, Train_accy 88.29:  45%|████▌     | 9/20 [01:04<01:19,  7.20s/it]
Task 1, Epoch 10/20 => Loss 0.440, Train_accy 89.49:  45%|████▌     | 9/20 [01:11<01:19,  7.20s/it]
Task 1, Epoch 10/20 => Loss 0.440, Train_accy 89.49:  50%|█████     | 10/20 [01:11<01:11,  7.18s/it]
Task 1, Epoch 11/20 => Loss 0.420, Train_accy 90.26:  50%|█████     | 10/20 [01:18<01:11,  7.18s/it]
Task 1, Epoch 11/20 => Loss 0.420, Train_accy 90.26:  55%|█████▌    | 11/20 [01:18<01:04,  7.14s/it]
Task 1, Epoch 12/20 => Loss 0.407, Train_accy 89.91:  55%|█████▌    | 11/20 [01:25<01:04,  7.14s/it]
Task 1, Epoch 12/20 => Loss 0.407, Train_accy 89.91:  60%|██████    | 12/20 [01:25<00:56,  7.12s/it]
Task 1, Epoch 13/20 => Loss 0.400, Train_accy 90.17:  60%|██████    | 12/20 [01:32<00:56,  7.12s/it]
Task 1, Epoch 13/20 => Loss 0.400, Train_accy 90.17:  65%|██████▌   | 13/20 [01:33<00:50,  7.17s/it]
Task 1, Epoch 14/20 => Loss 0.397, Train_accy 90.09:  65%|██████▌   | 13/20 [01:40<00:50,  7.17s/it]
Task 1, Epoch 14/20 => Loss 0.397, Train_accy 90.09:  70%|███████   | 14/20 [01:40<00:42,  7.15s/it]
Task 1, Epoch 15/20 => Loss 0.383, Train_accy 90.60:  70%|███████   | 14/20 [01:47<00:42,  7.15s/it]
Task 1, Epoch 15/20 => Loss 0.383, Train_accy 90.60:  75%|███████▌  | 15/20 [01:47<00:35,  7.15s/it]
Task 1, Epoch 16/20 => Loss 0.370, Train_accy 91.79:  75%|███████▌  | 15/20 [01:54<00:35,  7.15s/it]
Task 1, Epoch 16/20 => Loss 0.370, Train_accy 91.79:  80%|████████  | 16/20 [01:54<00:28,  7.12s/it]
Task 1, Epoch 17/20 => Loss 0.368, Train_accy 90.34:  80%|████████  | 16/20 [02:01<00:28,  7.12s/it]
Task 1, Epoch 17/20 => Loss 0.368, Train_accy 90.34:  85%|████████▌ | 17/20 [02:01<00:21,  7.12s/it]
Task 1, Epoch 18/20 => Loss 0.345, Train_accy 91.37:  85%|████████▌ | 17/20 [02:08<00:21,  7.12s/it]
Task 1, Epoch 18/20 => Loss 0.345, Train_accy 91.37:  90%|█████████ | 18/20 [02:08<00:14,  7.11s/it]
Task 1, Epoch 19/20 => Loss 0.352, Train_accy 91.79:  90%|█████████ | 18/20 [02:15<00:14,  7.11s/it]
Task 1, Epoch 19/20 => Loss 0.352, Train_accy 91.79:  95%|█████████▌| 19/20 [02:15<00:07,  7.10s/it]
Task 1, Epoch 20/20 => Loss 0.357, Train_accy 92.31:  95%|█████████▌| 19/20 [02:22<00:07,  7.10s/it]
Task 1, Epoch 20/20 => Loss 0.357, Train_accy 92.31: 100%|██████████| 20/20 [02:22<00:00,  7.11s/it]
Task 1, Epoch 20/20 => Loss 0.357, Train_accy 92.31: 100%|██████████| 20/20 [02:22<00:00,  7.13s/it]
2024-09-08 12:43:31,030 [ease.py] => Task 1, Epoch 20/20 => Loss 0.357, Train_accy 92.31
2024-09-08 12:43:58,320 [ease.py] => Task correct: 81.82930559804221
2024-09-08 12:43:58,321 [ease.py] => Task acc: 92.44417252982564
2024-09-08 12:43:58,345 [trainer.py] => No NME accuracy.
2024-09-08 12:43:58,345 [trainer.py] => CNN: {'total': 80.06, '00-99': 79.97, '100-109': 80.99, 'old': 79.97, 'new': 80.99}
2024-09-08 12:43:58,345 [trainer.py] => CNN top1 curve: [81.21, 80.06]
2024-09-08 12:43:58,345 [trainer.py] => CNN top5 curve: [93.57, 92.9]

Average Accuracy (CNN): 80.63
2024-09-08 12:43:58,345 [trainer.py] => Average Accuracy (CNN): 80.63 

2024-09-08 12:43:58,346 [trainer.py] => All params: 86279618
2024-09-08 12:43:58,346 [trainer.py] => Trainable params: 304320
2024-09-08 12:43:58,350 [ease.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.112, Train_accy 45.22:   0%|          | 0/20 [00:08<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.112, Train_accy 45.22:   5%|▌         | 1/20 [00:08<02:49,  8.91s/it]
Task 2, Epoch 2/20 => Loss 1.436, Train_accy 69.83:   5%|▌         | 1/20 [00:17<02:49,  8.91s/it]
Task 2, Epoch 2/20 => Loss 1.436, Train_accy 69.83:  10%|█         | 2/20 [00:17<02:40,  8.91s/it]
Task 2, Epoch 3/20 => Loss 1.026, Train_accy 78.13:  10%|█         | 2/20 [00:26<02:40,  8.91s/it]
Task 2, Epoch 3/20 => Loss 1.026, Train_accy 78.13:  15%|█▌        | 3/20 [00:26<02:32,  8.95s/it]
Task 2, Epoch 4/20 => Loss 0.732, Train_accy 82.68:  15%|█▌        | 3/20 [00:35<02:32,  8.95s/it]
Task 2, Epoch 4/20 => Loss 0.732, Train_accy 82.68:  20%|██        | 4/20 [00:35<02:23,  8.96s/it]
Task 2, Epoch 5/20 => Loss 0.581, Train_accy 85.15:  20%|██        | 4/20 [00:44<02:23,  8.96s/it]
Task 2, Epoch 5/20 => Loss 0.581, Train_accy 85.15:  25%|██▌       | 5/20 [00:44<02:14,  8.98s/it]
Task 2, Epoch 6/20 => Loss 0.472, Train_accy 87.76:  25%|██▌       | 5/20 [00:53<02:14,  8.98s/it]
Task 2, Epoch 6/20 => Loss 0.472, Train_accy 87.76:  30%|███       | 6/20 [00:53<02:06,  9.01s/it]
Task 2, Epoch 7/20 => Loss 0.443, Train_accy 88.83:  30%|███       | 6/20 [01:02<02:06,  9.01s/it]
Task 2, Epoch 7/20 => Loss 0.443, Train_accy 88.83:  35%|███▌      | 7/20 [01:02<01:57,  9.01s/it]
Task 2, Epoch 8/20 => Loss 0.416, Train_accy 88.03:  35%|███▌      | 7/20 [01:11<01:57,  9.01s/it]
Task 2, Epoch 8/20 => Loss 0.416, Train_accy 88.03:  40%|████      | 8/20 [01:11<01:48,  9.02s/it]
Task 2, Epoch 9/20 => Loss 0.393, Train_accy 89.03:  40%|████      | 8/20 [01:20<01:48,  9.02s/it]
Task 2, Epoch 9/20 => Loss 0.393, Train_accy 89.03:  45%|████▌     | 9/20 [01:20<01:39,  9.01s/it]
Task 2, Epoch 10/20 => Loss 0.364, Train_accy 89.57:  45%|████▌     | 9/20 [01:29<01:39,  9.01s/it]
Task 2, Epoch 10/20 => Loss 0.364, Train_accy 89.57:  50%|█████     | 10/20 [01:29<01:30,  9.01s/it]
Task 2, Epoch 11/20 => Loss 0.385, Train_accy 88.96:  50%|█████     | 10/20 [01:38<01:30,  9.01s/it]
Task 2, Epoch 11/20 => Loss 0.385, Train_accy 88.96:  55%|█████▌    | 11/20 [01:38<01:20,  8.99s/it]
Task 2, Epoch 12/20 => Loss 0.339, Train_accy 91.51:  55%|█████▌    | 11/20 [01:47<01:20,  8.99s/it]
Task 2, Epoch 12/20 => Loss 0.339, Train_accy 91.51:  60%|██████    | 12/20 [01:47<01:11,  8.97s/it]
Task 2, Epoch 13/20 => Loss 0.374, Train_accy 89.30:  60%|██████    | 12/20 [01:56<01:11,  8.97s/it]
Task 2, Epoch 13/20 => Loss 0.374, Train_accy 89.30:  65%|██████▌   | 13/20 [01:56<01:02,  8.98s/it]
Task 2, Epoch 14/20 => Loss 0.316, Train_accy 91.64:  65%|██████▌   | 13/20 [02:05<01:02,  8.98s/it]
Task 2, Epoch 14/20 => Loss 0.316, Train_accy 91.64:  70%|███████   | 14/20 [02:05<00:53,  8.97s/it]
Task 2, Epoch 15/20 => Loss 0.329, Train_accy 90.64:  70%|███████   | 14/20 [02:14<00:53,  8.97s/it]
Task 2, Epoch 15/20 => Loss 0.329, Train_accy 90.64:  75%|███████▌  | 15/20 [02:14<00:45,  9.02s/it]
Task 2, Epoch 16/20 => Loss 0.338, Train_accy 90.50:  75%|███████▌  | 15/20 [02:23<00:45,  9.02s/it]
Task 2, Epoch 16/20 => Loss 0.338, Train_accy 90.50:  80%|████████  | 16/20 [02:23<00:35,  9.00s/it]
Task 2, Epoch 17/20 => Loss 0.338, Train_accy 91.51:  80%|████████  | 16/20 [02:32<00:35,  9.00s/it]
Task 2, Epoch 17/20 => Loss 0.338, Train_accy 91.51:  85%|████████▌ | 17/20 [02:32<00:26,  8.99s/it]
Task 2, Epoch 18/20 => Loss 0.348, Train_accy 90.30:  85%|████████▌ | 17/20 [02:41<00:26,  8.99s/it]
Task 2, Epoch 18/20 => Loss 0.348, Train_accy 90.30:  90%|█████████ | 18/20 [02:41<00:17,  8.99s/it]
Task 2, Epoch 19/20 => Loss 0.325, Train_accy 91.64:  90%|█████████ | 18/20 [02:50<00:17,  8.99s/it]
Task 2, Epoch 19/20 => Loss 0.325, Train_accy 91.64:  95%|█████████▌| 19/20 [02:50<00:08,  8.98s/it]
Task 2, Epoch 20/20 => Loss 0.322, Train_accy 91.30:  95%|█████████▌| 19/20 [02:59<00:08,  8.98s/it]
Task 2, Epoch 20/20 => Loss 0.322, Train_accy 91.30: 100%|██████████| 20/20 [02:59<00:00,  8.97s/it]
Task 2, Epoch 20/20 => Loss 0.322, Train_accy 91.30: 100%|██████████| 20/20 [02:59<00:00,  8.98s/it]
2024-09-08 12:46:58,038 [ease.py] => Task 2, Epoch 20/20 => Loss 0.322, Train_accy 91.30
2024-09-08 12:47:44,115 [ease.py] => Task correct: 79.67078189300412
2024-09-08 12:47:44,116 [ease.py] => Task acc: 92.70233196159123
2024-09-08 12:47:44,137 [trainer.py] => No NME accuracy.
2024-09-08 12:47:44,137 [trainer.py] => CNN: {'total': 78.16, '00-99': 76.85, '100-109': 77.46, '110-119': 89.1, 'old': 76.9, 'new': 89.1}
2024-09-08 12:47:44,137 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16]
2024-09-08 12:47:44,138 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54]

Average Accuracy (CNN): 79.81
2024-09-08 12:47:44,138 [trainer.py] => Average Accuracy (CNN): 79.81 

2024-09-08 12:47:44,138 [trainer.py] => All params: 86387138
2024-09-08 12:47:44,139 [trainer.py] => Trainable params: 304320
2024-09-08 12:47:44,143 [ease.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.228, Train_accy 32.54:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.228, Train_accy 32.54:   5%|▌         | 1/20 [00:05<01:52,  5.92s/it]
Task 3, Epoch 2/20 => Loss 1.888, Train_accy 59.50:   5%|▌         | 1/20 [00:11<01:52,  5.92s/it]
Task 3, Epoch 2/20 => Loss 1.888, Train_accy 59.50:  10%|█         | 2/20 [00:11<01:47,  5.94s/it]
Task 3, Epoch 3/20 => Loss 1.445, Train_accy 76.65:  10%|█         | 2/20 [00:17<01:47,  5.94s/it]
Task 3, Epoch 3/20 => Loss 1.445, Train_accy 76.65:  15%|█▌        | 3/20 [00:17<01:41,  5.95s/it]
Task 3, Epoch 4/20 => Loss 1.153, Train_accy 80.17:  15%|█▌        | 3/20 [00:23<01:41,  5.95s/it]
Task 3, Epoch 4/20 => Loss 1.153, Train_accy 80.17:  20%|██        | 4/20 [00:23<01:35,  5.95s/it]
Task 3, Epoch 5/20 => Loss 0.918, Train_accy 85.43:  20%|██        | 4/20 [00:29<01:35,  5.95s/it]
Task 3, Epoch 5/20 => Loss 0.918, Train_accy 85.43:  25%|██▌       | 5/20 [00:29<01:30,  6.03s/it]
Task 3, Epoch 6/20 => Loss 0.760, Train_accy 87.40:  25%|██▌       | 5/20 [00:35<01:30,  6.03s/it]
Task 3, Epoch 6/20 => Loss 0.760, Train_accy 87.40:  30%|███       | 6/20 [00:35<01:24,  6.01s/it]
Task 3, Epoch 7/20 => Loss 0.678, Train_accy 86.78:  30%|███       | 6/20 [00:41<01:24,  6.01s/it]
Task 3, Epoch 7/20 => Loss 0.678, Train_accy 86.78:  35%|███▌      | 7/20 [00:41<01:18,  6.01s/it]
Task 3, Epoch 8/20 => Loss 0.628, Train_accy 87.81:  35%|███▌      | 7/20 [00:47<01:18,  6.01s/it]
Task 3, Epoch 8/20 => Loss 0.628, Train_accy 87.81:  40%|████      | 8/20 [00:47<01:11,  5.99s/it]
Task 3, Epoch 9/20 => Loss 0.570, Train_accy 87.60:  40%|████      | 8/20 [00:53<01:11,  5.99s/it]
Task 3, Epoch 9/20 => Loss 0.570, Train_accy 87.60:  45%|████▌     | 9/20 [00:53<01:06,  6.01s/it]
Task 3, Epoch 10/20 => Loss 0.517, Train_accy 89.15:  45%|████▌     | 9/20 [00:59<01:06,  6.01s/it]
Task 3, Epoch 10/20 => Loss 0.517, Train_accy 89.15:  50%|█████     | 10/20 [00:59<00:59,  5.98s/it]
Task 3, Epoch 11/20 => Loss 0.479, Train_accy 90.08:  50%|█████     | 10/20 [01:05<00:59,  5.98s/it]
Task 3, Epoch 11/20 => Loss 0.479, Train_accy 90.08:  55%|█████▌    | 11/20 [01:05<00:53,  5.98s/it]
Task 3, Epoch 12/20 => Loss 0.461, Train_accy 91.12:  55%|█████▌    | 11/20 [01:11<00:53,  5.98s/it]
Task 3, Epoch 12/20 => Loss 0.461, Train_accy 91.12:  60%|██████    | 12/20 [01:11<00:47,  5.96s/it]
Task 3, Epoch 13/20 => Loss 0.463, Train_accy 89.98:  60%|██████    | 12/20 [01:17<00:47,  5.96s/it]
Task 3, Epoch 13/20 => Loss 0.463, Train_accy 89.98:  65%|██████▌   | 13/20 [01:17<00:41,  5.98s/it]
Task 3, Epoch 14/20 => Loss 0.448, Train_accy 90.19:  65%|██████▌   | 13/20 [01:23<00:41,  5.98s/it]
Task 3, Epoch 14/20 => Loss 0.448, Train_accy 90.19:  70%|███████   | 14/20 [01:23<00:35,  5.99s/it]
Task 3, Epoch 15/20 => Loss 0.422, Train_accy 89.15:  70%|███████   | 14/20 [01:29<00:35,  5.99s/it]
Task 3, Epoch 15/20 => Loss 0.422, Train_accy 89.15:  75%|███████▌  | 15/20 [01:29<00:29,  5.99s/it]
Task 3, Epoch 16/20 => Loss 0.423, Train_accy 89.57:  75%|███████▌  | 15/20 [01:35<00:29,  5.99s/it]
Task 3, Epoch 16/20 => Loss 0.423, Train_accy 89.57:  80%|████████  | 16/20 [01:35<00:23,  5.98s/it]
Task 3, Epoch 17/20 => Loss 0.403, Train_accy 91.32:  80%|████████  | 16/20 [01:41<00:23,  5.98s/it]
Task 3, Epoch 17/20 => Loss 0.403, Train_accy 91.32:  85%|████████▌ | 17/20 [01:41<00:17,  5.98s/it]
Task 3, Epoch 18/20 => Loss 0.413, Train_accy 91.43:  85%|████████▌ | 17/20 [01:47<00:17,  5.98s/it]
Task 3, Epoch 18/20 => Loss 0.413, Train_accy 91.43:  90%|█████████ | 18/20 [01:47<00:11,  5.98s/it]
Task 3, Epoch 19/20 => Loss 0.432, Train_accy 89.88:  90%|█████████ | 18/20 [01:53<00:11,  5.98s/it]
Task 3, Epoch 19/20 => Loss 0.432, Train_accy 89.88:  95%|█████████▌| 19/20 [01:53<00:05,  5.99s/it]
Task 3, Epoch 20/20 => Loss 0.365, Train_accy 91.94:  95%|█████████▌| 19/20 [01:59<00:05,  5.99s/it]
Task 3, Epoch 20/20 => Loss 0.365, Train_accy 91.94: 100%|██████████| 20/20 [01:59<00:00,  5.99s/it]
Task 3, Epoch 20/20 => Loss 0.365, Train_accy 91.94: 100%|██████████| 20/20 [01:59<00:00,  5.98s/it]
2024-09-08 12:49:43,834 [ease.py] => Task 3, Epoch 20/20 => Loss 0.365, Train_accy 91.94
2024-09-08 12:50:41,661 [ease.py] => Task correct: 78.77936670071502
2024-09-08 12:50:41,661 [ease.py] => Task acc: 92.4923391215526
2024-09-08 12:50:41,684 [trainer.py] => No NME accuracy.
2024-09-08 12:50:41,684 [trainer.py] => CNN: {'total': 77.15, '00-99': 75.95, '100-109': 76.06, '110-119': 88.3, '120-129': 76.01, 'old': 77.23, 'new': 76.01}
2024-09-08 12:50:41,684 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15]
2024-09-08 12:50:41,684 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55]

Average Accuracy (CNN): 79.14
2024-09-08 12:50:41,684 [trainer.py] => Average Accuracy (CNN): 79.14 

2024-09-08 12:50:41,685 [trainer.py] => All params: 86510018
2024-09-08 12:50:41,685 [trainer.py] => Trainable params: 304320
2024-09-08 12:50:41,690 [ease.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.158, Train_accy 41.78:   0%|          | 0/20 [00:07<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.158, Train_accy 41.78:   5%|▌         | 1/20 [00:07<02:15,  7.11s/it]
Task 4, Epoch 2/20 => Loss 1.587, Train_accy 65.14:   5%|▌         | 1/20 [00:14<02:15,  7.11s/it]
Task 4, Epoch 2/20 => Loss 1.587, Train_accy 65.14:  10%|█         | 2/20 [00:14<02:07,  7.07s/it]
Task 4, Epoch 3/20 => Loss 1.135, Train_accy 77.25:  10%|█         | 2/20 [00:21<02:07,  7.07s/it]
Task 4, Epoch 3/20 => Loss 1.135, Train_accy 77.25:  15%|█▌        | 3/20 [00:21<01:59,  7.05s/it]
Task 4, Epoch 4/20 => Loss 0.869, Train_accy 82.79:  15%|█▌        | 3/20 [00:28<01:59,  7.05s/it]
Task 4, Epoch 4/20 => Loss 0.869, Train_accy 82.79:  20%|██        | 4/20 [00:28<01:53,  7.07s/it]
Task 4, Epoch 5/20 => Loss 0.683, Train_accy 85.64:  20%|██        | 4/20 [00:35<01:53,  7.07s/it]
Task 4, Epoch 5/20 => Loss 0.683, Train_accy 85.64:  25%|██▌       | 5/20 [00:35<01:45,  7.04s/it]
Task 4, Epoch 6/20 => Loss 0.588, Train_accy 86.68:  25%|██▌       | 5/20 [00:42<01:45,  7.04s/it]
Task 4, Epoch 6/20 => Loss 0.588, Train_accy 86.68:  30%|███       | 6/20 [00:42<01:38,  7.06s/it]
Task 4, Epoch 7/20 => Loss 0.469, Train_accy 89.36:  30%|███       | 6/20 [00:49<01:38,  7.06s/it]
Task 4, Epoch 7/20 => Loss 0.469, Train_accy 89.36:  35%|███▌      | 7/20 [00:49<01:31,  7.06s/it]
Task 4, Epoch 8/20 => Loss 0.457, Train_accy 89.10:  35%|███▌      | 7/20 [00:56<01:31,  7.06s/it]
Task 4, Epoch 8/20 => Loss 0.457, Train_accy 89.10:  40%|████      | 8/20 [00:56<01:24,  7.05s/it]
Task 4, Epoch 9/20 => Loss 0.411, Train_accy 89.45:  40%|████      | 8/20 [01:03<01:24,  7.05s/it]
Task 4, Epoch 9/20 => Loss 0.411, Train_accy 89.45:  45%|████▌     | 9/20 [01:03<01:17,  7.07s/it]
Task 4, Epoch 10/20 => Loss 0.395, Train_accy 89.97:  45%|████▌     | 9/20 [01:10<01:17,  7.07s/it]
Task 4, Epoch 10/20 => Loss 0.395, Train_accy 89.97:  50%|█████     | 10/20 [01:10<01:10,  7.08s/it]
Task 4, Epoch 11/20 => Loss 0.385, Train_accy 90.74:  50%|█████     | 10/20 [01:17<01:10,  7.08s/it]
Task 4, Epoch 11/20 => Loss 0.385, Train_accy 90.74:  55%|█████▌    | 11/20 [01:17<01:03,  7.06s/it]
Task 4, Epoch 12/20 => Loss 0.393, Train_accy 89.01:  55%|█████▌    | 11/20 [01:24<01:03,  7.06s/it]
Task 4, Epoch 12/20 => Loss 0.393, Train_accy 89.01:  60%|██████    | 12/20 [01:24<00:56,  7.06s/it]
Task 4, Epoch 13/20 => Loss 0.350, Train_accy 90.74:  60%|██████    | 12/20 [01:31<00:56,  7.06s/it]
Task 4, Epoch 13/20 => Loss 0.350, Train_accy 90.74:  65%|██████▌   | 13/20 [01:31<00:49,  7.07s/it]
Task 4, Epoch 14/20 => Loss 0.358, Train_accy 91.70:  65%|██████▌   | 13/20 [01:38<00:49,  7.07s/it]
Task 4, Epoch 14/20 => Loss 0.358, Train_accy 91.70:  70%|███████   | 14/20 [01:38<00:42,  7.08s/it]
Task 4, Epoch 15/20 => Loss 0.336, Train_accy 90.74:  70%|███████   | 14/20 [01:46<00:42,  7.08s/it]
Task 4, Epoch 15/20 => Loss 0.336, Train_accy 90.74:  75%|███████▌  | 15/20 [01:46<00:35,  7.09s/it]
Task 4, Epoch 16/20 => Loss 0.337, Train_accy 91.00:  75%|███████▌  | 15/20 [01:53<00:35,  7.09s/it]
Task 4, Epoch 16/20 => Loss 0.337, Train_accy 91.00:  80%|████████  | 16/20 [01:53<00:28,  7.08s/it]
Task 4, Epoch 17/20 => Loss 0.318, Train_accy 92.04:  80%|████████  | 16/20 [02:00<00:28,  7.08s/it]
Task 4, Epoch 17/20 => Loss 0.318, Train_accy 92.04:  85%|████████▌ | 17/20 [02:00<00:21,  7.06s/it]
Task 4, Epoch 18/20 => Loss 0.312, Train_accy 92.13:  85%|████████▌ | 17/20 [02:07<00:21,  7.06s/it]
Task 4, Epoch 18/20 => Loss 0.312, Train_accy 92.13:  90%|█████████ | 18/20 [02:07<00:14,  7.05s/it]
Task 4, Epoch 19/20 => Loss 0.328, Train_accy 91.96:  90%|█████████ | 18/20 [02:14<00:14,  7.05s/it]
Task 4, Epoch 19/20 => Loss 0.328, Train_accy 91.96:  95%|█████████▌| 19/20 [02:14<00:07,  7.05s/it]
Task 4, Epoch 20/20 => Loss 0.337, Train_accy 91.78:  95%|█████████▌| 19/20 [02:21<00:07,  7.05s/it]
Task 4, Epoch 20/20 => Loss 0.337, Train_accy 91.78: 100%|██████████| 20/20 [02:21<00:00,  7.05s/it]
Task 4, Epoch 20/20 => Loss 0.337, Train_accy 91.78: 100%|██████████| 20/20 [02:21<00:00,  7.06s/it]
2024-09-08 12:53:02,938 [ease.py] => Task 4, Epoch 20/20 => Loss 0.337, Train_accy 91.78
2024-09-08 12:54:22,255 [ease.py] => Task correct: 78.26293308020882
2024-09-08 12:54:22,256 [ease.py] => Task acc: 92.47745609871856
2024-09-08 12:54:22,280 [trainer.py] => No NME accuracy.
2024-09-08 12:54:22,280 [trainer.py] => CNN: {'total': 76.79, '00-99': 75.44, '100-109': 74.65, '110-119': 87.23, '120-129': 73.06, '130-139': 82.55, 'old': 76.35, 'new': 82.55}
2024-09-08 12:54:22,280 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15, 76.79]
2024-09-08 12:54:22,280 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55, 90.84]

Average Accuracy (CNN): 78.67
2024-09-08 12:54:22,280 [trainer.py] => Average Accuracy (CNN): 78.67 

2024-09-08 12:54:22,281 [trainer.py] => All params: 86648258
2024-09-08 12:54:22,282 [trainer.py] => Trainable params: 304320
2024-09-08 12:54:22,290 [ease.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.108, Train_accy 42.12:   0%|          | 0/20 [00:08<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.108, Train_accy 42.12:   5%|▌         | 1/20 [00:08<02:43,  8.59s/it]
Task 5, Epoch 2/20 => Loss 1.410, Train_accy 68.34:   5%|▌         | 1/20 [00:17<02:43,  8.59s/it]
Task 5, Epoch 2/20 => Loss 1.410, Train_accy 68.34:  10%|█         | 2/20 [00:17<02:34,  8.57s/it]
Task 5, Epoch 3/20 => Loss 0.949, Train_accy 81.27:  10%|█         | 2/20 [00:25<02:34,  8.57s/it]
Task 5, Epoch 3/20 => Loss 0.949, Train_accy 81.27:  15%|█▌        | 3/20 [00:25<02:25,  8.58s/it]
Task 5, Epoch 4/20 => Loss 0.682, Train_accy 85.94:  15%|█▌        | 3/20 [00:34<02:25,  8.58s/it]
Task 5, Epoch 4/20 => Loss 0.682, Train_accy 85.94:  20%|██        | 4/20 [00:34<02:17,  8.58s/it]
Task 5, Epoch 5/20 => Loss 0.511, Train_accy 88.06:  20%|██        | 4/20 [00:42<02:17,  8.58s/it]
Task 5, Epoch 5/20 => Loss 0.511, Train_accy 88.06:  25%|██▌       | 5/20 [00:42<02:08,  8.59s/it]
Task 5, Epoch 6/20 => Loss 0.435, Train_accy 89.40:  25%|██▌       | 5/20 [00:51<02:08,  8.59s/it]
Task 5, Epoch 6/20 => Loss 0.435, Train_accy 89.40:  30%|███       | 6/20 [00:51<02:00,  8.59s/it]
Task 5, Epoch 7/20 => Loss 0.389, Train_accy 90.74:  30%|███       | 6/20 [01:00<02:00,  8.59s/it]
Task 5, Epoch 7/20 => Loss 0.389, Train_accy 90.74:  35%|███▌      | 7/20 [01:00<01:51,  8.57s/it]
Task 5, Epoch 8/20 => Loss 0.351, Train_accy 91.59:  35%|███▌      | 7/20 [01:08<01:51,  8.57s/it]
Task 5, Epoch 8/20 => Loss 0.351, Train_accy 91.59:  40%|████      | 8/20 [01:08<01:42,  8.56s/it]
Task 5, Epoch 9/20 => Loss 0.361, Train_accy 90.60:  40%|████      | 8/20 [01:17<01:42,  8.56s/it]
Task 5, Epoch 9/20 => Loss 0.361, Train_accy 90.60:  45%|████▌     | 9/20 [01:17<01:34,  8.55s/it]
Task 5, Epoch 10/20 => Loss 0.334, Train_accy 91.45:  45%|████▌     | 9/20 [01:25<01:34,  8.55s/it]
Task 5, Epoch 10/20 => Loss 0.334, Train_accy 91.45:  50%|█████     | 10/20 [01:25<01:25,  8.55s/it]
Task 5, Epoch 11/20 => Loss 0.309, Train_accy 92.44:  50%|█████     | 10/20 [01:34<01:25,  8.55s/it]
Task 5, Epoch 11/20 => Loss 0.309, Train_accy 92.44:  55%|█████▌    | 11/20 [01:34<01:16,  8.53s/it]
Task 5, Epoch 12/20 => Loss 0.323, Train_accy 91.24:  55%|█████▌    | 11/20 [01:42<01:16,  8.53s/it]
Task 5, Epoch 12/20 => Loss 0.323, Train_accy 91.24:  60%|██████    | 12/20 [01:42<01:08,  8.54s/it]
Task 5, Epoch 13/20 => Loss 0.327, Train_accy 91.02:  60%|██████    | 12/20 [01:51<01:08,  8.54s/it]
Task 5, Epoch 13/20 => Loss 0.327, Train_accy 91.02:  65%|██████▌   | 13/20 [01:51<00:59,  8.53s/it]
Task 5, Epoch 14/20 => Loss 0.309, Train_accy 92.01:  65%|██████▌   | 13/20 [01:59<00:59,  8.53s/it]
Task 5, Epoch 14/20 => Loss 0.309, Train_accy 92.01:  70%|███████   | 14/20 [01:59<00:51,  8.53s/it]
Task 5, Epoch 15/20 => Loss 0.335, Train_accy 90.39:  70%|███████   | 14/20 [02:08<00:51,  8.53s/it]
Task 5, Epoch 15/20 => Loss 0.335, Train_accy 90.39:  75%|███████▌  | 15/20 [02:08<00:42,  8.53s/it]
Task 5, Epoch 16/20 => Loss 0.309, Train_accy 92.01:  75%|███████▌  | 15/20 [02:16<00:42,  8.53s/it]
Task 5, Epoch 16/20 => Loss 0.309, Train_accy 92.01:  80%|████████  | 16/20 [02:16<00:34,  8.54s/it]
Task 5, Epoch 17/20 => Loss 0.291, Train_accy 93.00:  80%|████████  | 16/20 [02:25<00:34,  8.54s/it]
Task 5, Epoch 17/20 => Loss 0.291, Train_accy 93.00:  85%|████████▌ | 17/20 [02:25<00:25,  8.53s/it]
Task 5, Epoch 18/20 => Loss 0.299, Train_accy 92.37:  85%|████████▌ | 17/20 [02:33<00:25,  8.53s/it]
Task 5, Epoch 18/20 => Loss 0.299, Train_accy 92.37:  90%|█████████ | 18/20 [02:33<00:17,  8.54s/it]
Task 5, Epoch 19/20 => Loss 0.304, Train_accy 92.86:  90%|█████████ | 18/20 [02:42<00:17,  8.54s/it]
Task 5, Epoch 19/20 => Loss 0.304, Train_accy 92.86:  95%|█████████▌| 19/20 [02:42<00:08,  8.56s/it]
Task 5, Epoch 20/20 => Loss 0.303, Train_accy 92.16:  95%|█████████▌| 19/20 [02:51<00:08,  8.56s/it]
Task 5, Epoch 20/20 => Loss 0.303, Train_accy 92.16: 100%|██████████| 20/20 [02:51<00:00,  8.56s/it]
Task 5, Epoch 20/20 => Loss 0.303, Train_accy 92.16: 100%|██████████| 20/20 [02:51<00:00,  8.55s/it]
2024-09-08 12:57:13,363 [ease.py] => Task 5, Epoch 20/20 => Loss 0.303, Train_accy 92.16
2024-09-08 12:58:58,645 [ease.py] => Task correct: 77.51582623881248
2024-09-08 12:58:58,645 [ease.py] => Task acc: 92.73084479371316
2024-09-08 12:58:58,668 [trainer.py] => No NME accuracy.
2024-09-08 12:58:58,669 [trainer.py] => CNN: {'total': 76.23, '00-99': 74.34, '100-109': 72.54, '110-119': 85.37, '120-129': 69.74, '130-139': 80.87, '140-149': 86.1, 'old': 75.37, 'new': 86.1}
2024-09-08 12:58:58,669 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15, 76.79, 76.23]
2024-09-08 12:58:58,669 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55, 90.84, 90.64]

Average Accuracy (CNN): 78.27
2024-09-08 12:58:58,669 [trainer.py] => Average Accuracy (CNN): 78.27 

2024-09-08 12:58:58,670 [trainer.py] => All params: 86801858
2024-09-08 12:58:58,670 [trainer.py] => Trainable params: 304320
2024-09-08 12:58:58,678 [ease.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.164, Train_accy 41.83:   0%|          | 0/20 [00:08<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.164, Train_accy 41.83:   5%|▌         | 1/20 [00:08<02:42,  8.56s/it]
Task 6, Epoch 2/20 => Loss 1.638, Train_accy 59.89:   5%|▌         | 1/20 [00:17<02:42,  8.56s/it]
Task 6, Epoch 2/20 => Loss 1.638, Train_accy 59.89:  10%|█         | 2/20 [00:17<02:36,  8.70s/it]
Task 6, Epoch 3/20 => Loss 1.205, Train_accy 74.09:  10%|█         | 2/20 [00:25<02:36,  8.70s/it]
Task 6, Epoch 3/20 => Loss 1.205, Train_accy 74.09:  15%|█▌        | 3/20 [00:25<02:26,  8.61s/it]
Task 6, Epoch 4/20 => Loss 0.912, Train_accy 81.58:  15%|█▌        | 3/20 [00:34<02:26,  8.61s/it]
Task 6, Epoch 4/20 => Loss 0.912, Train_accy 81.58:  20%|██        | 4/20 [00:34<02:16,  8.55s/it]
Task 6, Epoch 5/20 => Loss 0.763, Train_accy 82.23:  20%|██        | 4/20 [00:42<02:16,  8.55s/it]
Task 6, Epoch 5/20 => Loss 0.763, Train_accy 82.23:  25%|██▌       | 5/20 [00:42<02:08,  8.55s/it]
Task 6, Epoch 6/20 => Loss 0.680, Train_accy 83.08:  25%|██▌       | 5/20 [00:51<02:08,  8.55s/it]
Task 6, Epoch 6/20 => Loss 0.680, Train_accy 83.08:  30%|███       | 6/20 [00:51<01:59,  8.53s/it]
Task 6, Epoch 7/20 => Loss 0.595, Train_accy 85.87:  30%|███       | 6/20 [01:00<01:59,  8.53s/it]
Task 6, Epoch 7/20 => Loss 0.595, Train_accy 85.87:  35%|███▌      | 7/20 [01:00<01:51,  8.58s/it]
Task 6, Epoch 8/20 => Loss 0.562, Train_accy 86.08:  35%|███▌      | 7/20 [01:08<01:51,  8.58s/it]
Task 6, Epoch 8/20 => Loss 0.562, Train_accy 86.08:  40%|████      | 8/20 [01:08<01:42,  8.56s/it]
Task 6, Epoch 9/20 => Loss 0.507, Train_accy 87.51:  40%|████      | 8/20 [01:17<01:42,  8.56s/it]
Task 6, Epoch 9/20 => Loss 0.507, Train_accy 87.51:  45%|████▌     | 9/20 [01:17<01:34,  8.63s/it]
Task 6, Epoch 10/20 => Loss 0.468, Train_accy 87.94:  45%|████▌     | 9/20 [01:25<01:34,  8.63s/it]
Task 6, Epoch 10/20 => Loss 0.468, Train_accy 87.94:  50%|█████     | 10/20 [01:25<01:25,  8.59s/it]
Task 6, Epoch 11/20 => Loss 0.453, Train_accy 88.94:  50%|█████     | 10/20 [01:34<01:25,  8.59s/it]
Task 6, Epoch 11/20 => Loss 0.453, Train_accy 88.94:  55%|█████▌    | 11/20 [01:34<01:16,  8.54s/it]
Task 6, Epoch 12/20 => Loss 0.439, Train_accy 89.01:  55%|█████▌    | 11/20 [01:42<01:16,  8.54s/it]
Task 6, Epoch 12/20 => Loss 0.439, Train_accy 89.01:  60%|██████    | 12/20 [01:42<01:08,  8.52s/it]
Task 6, Epoch 13/20 => Loss 0.418, Train_accy 89.86:  60%|██████    | 12/20 [01:51<01:08,  8.52s/it]
Task 6, Epoch 13/20 => Loss 0.418, Train_accy 89.86:  65%|██████▌   | 13/20 [01:51<00:59,  8.52s/it]
Task 6, Epoch 14/20 => Loss 0.441, Train_accy 88.87:  65%|██████▌   | 13/20 [01:59<00:59,  8.52s/it]
Task 6, Epoch 14/20 => Loss 0.441, Train_accy 88.87:  70%|███████   | 14/20 [01:59<00:51,  8.51s/it]
Task 6, Epoch 15/20 => Loss 0.405, Train_accy 90.29:  70%|███████   | 14/20 [02:08<00:51,  8.51s/it]
Task 6, Epoch 15/20 => Loss 0.405, Train_accy 90.29:  75%|███████▌  | 15/20 [02:08<00:42,  8.51s/it]
Task 6, Epoch 16/20 => Loss 0.403, Train_accy 90.36:  75%|███████▌  | 15/20 [02:16<00:42,  8.51s/it]
Task 6, Epoch 16/20 => Loss 0.403, Train_accy 90.36:  80%|████████  | 16/20 [02:16<00:34,  8.55s/it]
Task 6, Epoch 17/20 => Loss 0.407, Train_accy 89.86:  80%|████████  | 16/20 [02:25<00:34,  8.55s/it]
Task 6, Epoch 17/20 => Loss 0.407, Train_accy 89.86:  85%|████████▌ | 17/20 [02:25<00:25,  8.53s/it]
Task 6, Epoch 18/20 => Loss 0.379, Train_accy 91.15:  85%|████████▌ | 17/20 [02:33<00:25,  8.53s/it]
Task 6, Epoch 18/20 => Loss 0.379, Train_accy 91.15:  90%|█████████ | 18/20 [02:33<00:17,  8.51s/it]
Task 6, Epoch 19/20 => Loss 0.400, Train_accy 89.36:  90%|█████████ | 18/20 [02:42<00:17,  8.51s/it]
Task 6, Epoch 19/20 => Loss 0.400, Train_accy 89.36:  95%|█████████▌| 19/20 [02:42<00:08,  8.53s/it]
Task 6, Epoch 20/20 => Loss 0.408, Train_accy 89.22:  95%|█████████▌| 19/20 [02:50<00:08,  8.53s/it]
Task 6, Epoch 20/20 => Loss 0.408, Train_accy 89.22: 100%|██████████| 20/20 [02:50<00:00,  8.52s/it]
Task 6, Epoch 20/20 => Loss 0.408, Train_accy 89.22: 100%|██████████| 20/20 [02:50<00:00,  8.55s/it]
2024-09-08 13:01:49,610 [ease.py] => Task 6, Epoch 20/20 => Loss 0.408, Train_accy 89.22
2024-09-08 13:03:59,676 [ease.py] => Task correct: 76.85616022658304
2024-09-08 13:03:59,676 [ease.py] => Task acc: 92.75743475622092
2024-09-08 13:03:59,701 [trainer.py] => No NME accuracy.
2024-09-08 13:03:59,701 [trainer.py] => CNN: {'total': 75.78, '00-99': 74.14, '100-109': 72.18, '110-119': 84.04, '120-129': 68.63, '130-139': 80.54, '140-149': 83.92, '150-159': 76.8, 'old': 75.7, 'new': 76.8}
2024-09-08 13:03:59,701 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15, 76.79, 76.23, 75.78]
2024-09-08 13:03:59,701 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55, 90.84, 90.64, 90.09]

Average Accuracy (CNN): 77.91
2024-09-08 13:03:59,701 [trainer.py] => Average Accuracy (CNN): 77.91 

2024-09-08 13:03:59,702 [trainer.py] => All params: 86970818
2024-09-08 13:03:59,702 [trainer.py] => Trainable params: 304320
2024-09-08 13:03:59,712 [ease.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.241, Train_accy 34.51:   0%|          | 0/20 [00:06<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.241, Train_accy 34.51:   5%|▌         | 1/20 [00:06<01:55,  6.08s/it]
Task 7, Epoch 2/20 => Loss 1.983, Train_accy 49.40:   5%|▌         | 1/20 [00:12<01:55,  6.08s/it]
Task 7, Epoch 2/20 => Loss 1.983, Train_accy 49.40:  10%|█         | 2/20 [00:12<01:49,  6.07s/it]
Task 7, Epoch 3/20 => Loss 1.654, Train_accy 59.76:  10%|█         | 2/20 [00:18<01:49,  6.07s/it]
Task 7, Epoch 3/20 => Loss 1.654, Train_accy 59.76:  15%|█▌        | 3/20 [00:18<01:43,  6.08s/it]
Task 7, Epoch 4/20 => Loss 1.392, Train_accy 68.81:  15%|█▌        | 3/20 [00:24<01:43,  6.08s/it]
Task 7, Epoch 4/20 => Loss 1.392, Train_accy 68.81:  20%|██        | 4/20 [00:24<01:37,  6.09s/it]
Task 7, Epoch 5/20 => Loss 1.203, Train_accy 74.35:  20%|██        | 4/20 [00:30<01:37,  6.09s/it]
Task 7, Epoch 5/20 => Loss 1.203, Train_accy 74.35:  25%|██▌       | 5/20 [00:30<01:31,  6.08s/it]
Task 7, Epoch 6/20 => Loss 1.046, Train_accy 76.26:  25%|██▌       | 5/20 [00:36<01:31,  6.08s/it]
Task 7, Epoch 6/20 => Loss 1.046, Train_accy 76.26:  30%|███       | 6/20 [00:36<01:25,  6.11s/it]
Task 7, Epoch 7/20 => Loss 0.940, Train_accy 77.26:  30%|███       | 6/20 [00:42<01:25,  6.11s/it]
Task 7, Epoch 7/20 => Loss 0.940, Train_accy 77.26:  35%|███▌      | 7/20 [00:42<01:19,  6.10s/it]
Task 7, Epoch 8/20 => Loss 0.864, Train_accy 78.67:  35%|███▌      | 7/20 [00:48<01:19,  6.10s/it]
Task 7, Epoch 8/20 => Loss 0.864, Train_accy 78.67:  40%|████      | 8/20 [00:48<01:13,  6.11s/it]
Task 7, Epoch 9/20 => Loss 0.784, Train_accy 82.09:  40%|████      | 8/20 [00:54<01:13,  6.11s/it]
Task 7, Epoch 9/20 => Loss 0.784, Train_accy 82.09:  45%|████▌     | 9/20 [00:54<01:07,  6.10s/it]
Task 7, Epoch 10/20 => Loss 0.742, Train_accy 81.99:  45%|████▌     | 9/20 [01:00<01:07,  6.10s/it]
Task 7, Epoch 10/20 => Loss 0.742, Train_accy 81.99:  50%|█████     | 10/20 [01:00<01:01,  6.11s/it]
Task 7, Epoch 11/20 => Loss 0.698, Train_accy 81.69:  50%|█████     | 10/20 [01:07<01:01,  6.11s/it]
Task 7, Epoch 11/20 => Loss 0.698, Train_accy 81.69:  55%|█████▌    | 11/20 [01:07<00:54,  6.10s/it]
Task 7, Epoch 12/20 => Loss 0.676, Train_accy 83.80:  55%|█████▌    | 11/20 [01:13<00:54,  6.10s/it]
Task 7, Epoch 12/20 => Loss 0.676, Train_accy 83.80:  60%|██████    | 12/20 [01:13<00:48,  6.11s/it]
Task 7, Epoch 13/20 => Loss 0.645, Train_accy 82.70:  60%|██████    | 12/20 [01:19<00:48,  6.11s/it]
Task 7, Epoch 13/20 => Loss 0.645, Train_accy 82.70:  65%|██████▌   | 13/20 [01:19<00:42,  6.10s/it]
Task 7, Epoch 14/20 => Loss 0.615, Train_accy 84.61:  65%|██████▌   | 13/20 [01:25<00:42,  6.10s/it]
Task 7, Epoch 14/20 => Loss 0.615, Train_accy 84.61:  70%|███████   | 14/20 [01:25<00:36,  6.12s/it]
Task 7, Epoch 15/20 => Loss 0.603, Train_accy 84.61:  70%|███████   | 14/20 [01:31<00:36,  6.12s/it]
Task 7, Epoch 15/20 => Loss 0.603, Train_accy 84.61:  75%|███████▌  | 15/20 [01:31<00:30,  6.11s/it]
Task 7, Epoch 16/20 => Loss 0.587, Train_accy 84.61:  75%|███████▌  | 15/20 [01:37<00:30,  6.11s/it]
Task 7, Epoch 16/20 => Loss 0.587, Train_accy 84.61:  80%|████████  | 16/20 [01:37<00:24,  6.12s/it]
Task 7, Epoch 17/20 => Loss 0.604, Train_accy 84.10:  80%|████████  | 16/20 [01:43<00:24,  6.12s/it]
Task 7, Epoch 17/20 => Loss 0.604, Train_accy 84.10:  85%|████████▌ | 17/20 [01:43<00:18,  6.14s/it]
Task 7, Epoch 18/20 => Loss 0.567, Train_accy 85.41:  85%|████████▌ | 17/20 [01:50<00:18,  6.14s/it]
Task 7, Epoch 18/20 => Loss 0.567, Train_accy 85.41:  90%|█████████ | 18/20 [01:50<00:12,  6.14s/it]
Task 7, Epoch 19/20 => Loss 0.583, Train_accy 84.91:  90%|█████████ | 18/20 [01:56<00:12,  6.14s/it]
Task 7, Epoch 19/20 => Loss 0.583, Train_accy 84.91:  95%|█████████▌| 19/20 [01:56<00:06,  6.13s/it]
Task 7, Epoch 20/20 => Loss 0.614, Train_accy 84.81:  95%|█████████▌| 19/20 [02:02<00:06,  6.13s/it]
Task 7, Epoch 20/20 => Loss 0.614, Train_accy 84.81: 100%|██████████| 20/20 [02:02<00:00,  6.13s/it]
Task 7, Epoch 20/20 => Loss 0.614, Train_accy 84.81: 100%|██████████| 20/20 [02:02<00:00,  6.11s/it]
2024-09-08 13:06:01,960 [ease.py] => Task 7, Epoch 20/20 => Loss 0.614, Train_accy 84.81
2024-09-08 13:08:25,222 [ease.py] => Task correct: 75.72008505702686
2024-09-08 13:08:25,223 [ease.py] => Task acc: 92.42219215155616
2024-09-08 13:08:25,243 [trainer.py] => No NME accuracy.
2024-09-08 13:08:25,243 [trainer.py] => CNN: {'total': 74.62, '00-99': 73.57, '100-109': 71.48, '110-119': 83.24, '120-129': 66.79, '130-139': 80.54, '140-149': 83.92, '150-159': 75.69, '160-169': 63.04, 'old': 75.16, 'new': 63.04}
2024-09-08 13:08:25,243 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15, 76.79, 76.23, 75.78, 74.62]
2024-09-08 13:08:25,243 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55, 90.84, 90.64, 90.09, 89.5]

Average Accuracy (CNN): 77.5
2024-09-08 13:08:25,243 [trainer.py] => Average Accuracy (CNN): 77.5 

2024-09-08 13:08:25,244 [trainer.py] => All params: 87155138
2024-09-08 13:08:25,245 [trainer.py] => Trainable params: 304320
2024-09-08 13:08:25,254 [ease.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.216, Train_accy 40.67:   0%|          | 0/20 [00:05<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.216, Train_accy 40.67:   5%|▌         | 1/20 [00:05<01:51,  5.86s/it]
Task 8, Epoch 2/20 => Loss 1.815, Train_accy 62.79:   5%|▌         | 1/20 [00:11<01:51,  5.86s/it]
Task 8, Epoch 2/20 => Loss 1.815, Train_accy 62.79:  10%|█         | 2/20 [00:11<01:45,  5.87s/it]
Task 8, Epoch 3/20 => Loss 1.333, Train_accy 76.00:  10%|█         | 2/20 [00:17<01:45,  5.87s/it]
Task 8, Epoch 3/20 => Loss 1.333, Train_accy 76.00:  15%|█▌        | 3/20 [00:17<01:39,  5.87s/it]
Task 8, Epoch 4/20 => Loss 1.020, Train_accy 82.08:  15%|█▌        | 3/20 [00:23<01:39,  5.87s/it]
Task 8, Epoch 4/20 => Loss 1.020, Train_accy 82.08:  20%|██        | 4/20 [00:23<01:34,  5.88s/it]
Task 8, Epoch 5/20 => Loss 0.795, Train_accy 86.69:  20%|██        | 4/20 [00:29<01:34,  5.88s/it]
Task 8, Epoch 5/20 => Loss 0.795, Train_accy 86.69:  25%|██▌       | 5/20 [00:29<01:28,  5.90s/it]
Task 8, Epoch 6/20 => Loss 0.666, Train_accy 86.90:  25%|██▌       | 5/20 [00:35<01:28,  5.90s/it]
Task 8, Epoch 6/20 => Loss 0.666, Train_accy 86.90:  30%|███       | 6/20 [00:35<01:22,  5.89s/it]
Task 8, Epoch 7/20 => Loss 0.594, Train_accy 87.63:  30%|███       | 6/20 [00:41<01:22,  5.89s/it]
Task 8, Epoch 7/20 => Loss 0.594, Train_accy 87.63:  35%|███▌      | 7/20 [00:41<01:16,  5.90s/it]
Task 8, Epoch 8/20 => Loss 0.503, Train_accy 88.99:  35%|███▌      | 7/20 [00:47<01:16,  5.90s/it]
Task 8, Epoch 8/20 => Loss 0.503, Train_accy 88.99:  40%|████      | 8/20 [00:47<01:10,  5.89s/it]
Task 8, Epoch 9/20 => Loss 0.458, Train_accy 90.15:  40%|████      | 8/20 [00:52<01:10,  5.89s/it]
Task 8, Epoch 9/20 => Loss 0.458, Train_accy 90.15:  45%|████▌     | 9/20 [00:52<01:04,  5.89s/it]
Task 8, Epoch 10/20 => Loss 0.426, Train_accy 89.94:  45%|████▌     | 9/20 [00:58<01:04,  5.89s/it]
Task 8, Epoch 10/20 => Loss 0.426, Train_accy 89.94:  50%|█████     | 10/20 [00:58<00:58,  5.89s/it]
Task 8, Epoch 11/20 => Loss 0.408, Train_accy 90.46:  50%|█████     | 10/20 [01:04<00:58,  5.89s/it]
Task 8, Epoch 11/20 => Loss 0.408, Train_accy 90.46:  55%|█████▌    | 11/20 [01:04<00:52,  5.89s/it]
Task 8, Epoch 12/20 => Loss 0.366, Train_accy 92.03:  55%|█████▌    | 11/20 [01:10<00:52,  5.89s/it]
Task 8, Epoch 12/20 => Loss 0.366, Train_accy 92.03:  60%|██████    | 12/20 [01:10<00:47,  5.88s/it]
Task 8, Epoch 13/20 => Loss 0.355, Train_accy 92.77:  60%|██████    | 12/20 [01:16<00:47,  5.88s/it]
Task 8, Epoch 13/20 => Loss 0.355, Train_accy 92.77:  65%|██████▌   | 13/20 [01:16<00:41,  5.88s/it]
Task 8, Epoch 14/20 => Loss 0.351, Train_accy 91.93:  65%|██████▌   | 13/20 [01:22<00:41,  5.88s/it]
Task 8, Epoch 14/20 => Loss 0.351, Train_accy 91.93:  70%|███████   | 14/20 [01:22<00:35,  5.91s/it]
Task 8, Epoch 15/20 => Loss 0.336, Train_accy 91.61:  70%|███████   | 14/20 [01:28<00:35,  5.91s/it]
Task 8, Epoch 15/20 => Loss 0.336, Train_accy 91.61:  75%|███████▌  | 15/20 [01:28<00:29,  5.92s/it]
Task 8, Epoch 16/20 => Loss 0.347, Train_accy 92.35:  75%|███████▌  | 15/20 [01:34<00:29,  5.92s/it]
Task 8, Epoch 16/20 => Loss 0.347, Train_accy 92.35:  80%|████████  | 16/20 [01:34<00:23,  5.91s/it]
Task 8, Epoch 17/20 => Loss 0.325, Train_accy 92.98:  80%|████████  | 16/20 [01:40<00:23,  5.91s/it]
Task 8, Epoch 17/20 => Loss 0.325, Train_accy 92.98:  85%|████████▌ | 17/20 [01:40<00:17,  5.91s/it]
Task 8, Epoch 18/20 => Loss 0.339, Train_accy 92.35:  85%|████████▌ | 17/20 [01:46<00:17,  5.91s/it]
Task 8, Epoch 18/20 => Loss 0.339, Train_accy 92.35:  90%|█████████ | 18/20 [01:46<00:11,  5.90s/it]
Task 8, Epoch 19/20 => Loss 0.329, Train_accy 92.87:  90%|█████████ | 18/20 [01:51<00:11,  5.90s/it]
Task 8, Epoch 19/20 => Loss 0.329, Train_accy 92.87:  95%|█████████▌| 19/20 [01:51<00:05,  5.90s/it]
Task 8, Epoch 20/20 => Loss 0.384, Train_accy 90.57:  95%|█████████▌| 19/20 [01:58<00:05,  5.90s/it]
Task 8, Epoch 20/20 => Loss 0.384, Train_accy 90.57: 100%|██████████| 20/20 [01:58<00:00,  5.94s/it]
Task 8, Epoch 20/20 => Loss 0.384, Train_accy 90.57: 100%|██████████| 20/20 [01:58<00:00,  5.90s/it]
2024-09-08 13:10:23,286 [ease.py] => Task 8, Epoch 20/20 => Loss 0.384, Train_accy 90.57
2024-09-08 13:13:11,130 [ease.py] => Task correct: 75.74248293672754
2024-09-08 13:13:11,131 [ease.py] => Task acc: 92.56594724220624
2024-09-08 13:13:11,154 [trainer.py] => No NME accuracy.
2024-09-08 13:13:11,154 [trainer.py] => CNN: {'total': 74.71, '00-99': 73.23, '100-109': 71.48, '110-119': 83.24, '120-129': 66.42, '130-139': 80.54, '140-149': 83.92, '150-159': 75.69, '160-169': 63.04, '170-179': 81.05, 'old': 74.41, 'new': 81.05}
2024-09-08 13:13:11,154 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15, 76.79, 76.23, 75.78, 74.62, 74.71]
2024-09-08 13:13:11,155 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55, 90.84, 90.64, 90.09, 89.5, 89.32]

Average Accuracy (CNN): 77.19
2024-09-08 13:13:11,155 [trainer.py] => Average Accuracy (CNN): 77.19 

2024-09-08 13:13:11,155 [trainer.py] => All params: 87354818
2024-09-08 13:13:11,156 [trainer.py] => Trainable params: 304320
2024-09-08 13:13:11,168 [ease.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.185, Train_accy 38.97:   0%|          | 0/20 [00:06<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.185, Train_accy 38.97:   5%|▌         | 1/20 [00:06<02:12,  6.99s/it]
Task 9, Epoch 2/20 => Loss 1.707, Train_accy 60.95:   5%|▌         | 1/20 [00:13<02:12,  6.99s/it]
Task 9, Epoch 2/20 => Loss 1.707, Train_accy 60.95:  10%|█         | 2/20 [00:13<02:05,  6.98s/it]
Task 9, Epoch 3/20 => Loss 1.272, Train_accy 73.03:  10%|█         | 2/20 [00:21<02:05,  6.98s/it]
Task 9, Epoch 3/20 => Loss 1.272, Train_accy 73.03:  15%|█▌        | 3/20 [00:21<01:59,  7.01s/it]
Task 9, Epoch 4/20 => Loss 1.010, Train_accy 78.81:  15%|█▌        | 3/20 [00:27<01:59,  7.01s/it]
Task 9, Epoch 4/20 => Loss 1.010, Train_accy 78.81:  20%|██        | 4/20 [00:27<01:51,  7.00s/it]
Task 9, Epoch 5/20 => Loss 0.873, Train_accy 81.44:  20%|██        | 4/20 [00:34<01:51,  7.00s/it]
Task 9, Epoch 5/20 => Loss 0.873, Train_accy 81.44:  25%|██▌       | 5/20 [00:34<01:44,  6.99s/it]
Task 9, Epoch 6/20 => Loss 0.735, Train_accy 83.27:  25%|██▌       | 5/20 [00:41<01:44,  6.99s/it]
Task 9, Epoch 6/20 => Loss 0.735, Train_accy 83.27:  30%|███       | 6/20 [00:41<01:37,  6.97s/it]
Task 9, Epoch 7/20 => Loss 0.625, Train_accy 86.25:  30%|███       | 6/20 [00:48<01:37,  6.97s/it]
Task 9, Epoch 7/20 => Loss 0.625, Train_accy 86.25:  35%|███▌      | 7/20 [00:48<01:30,  6.97s/it]
Task 9, Epoch 8/20 => Loss 0.562, Train_accy 85.99:  35%|███▌      | 7/20 [00:55<01:30,  6.97s/it]
Task 9, Epoch 8/20 => Loss 0.562, Train_accy 85.99:  40%|████      | 8/20 [00:55<01:23,  6.97s/it]
Task 9, Epoch 9/20 => Loss 0.521, Train_accy 86.60:  40%|████      | 8/20 [01:02<01:23,  6.97s/it]
Task 9, Epoch 9/20 => Loss 0.521, Train_accy 86.60:  45%|████▌     | 9/20 [01:02<01:16,  6.96s/it]
Task 9, Epoch 10/20 => Loss 0.483, Train_accy 88.00:  45%|████▌     | 9/20 [01:09<01:16,  6.96s/it]
Task 9, Epoch 10/20 => Loss 0.483, Train_accy 88.00:  50%|█████     | 10/20 [01:09<01:09,  6.96s/it]
Task 9, Epoch 11/20 => Loss 0.493, Train_accy 87.39:  50%|█████     | 10/20 [01:16<01:09,  6.96s/it]
Task 9, Epoch 11/20 => Loss 0.493, Train_accy 87.39:  55%|█████▌    | 11/20 [01:16<01:02,  6.95s/it]
Task 9, Epoch 12/20 => Loss 0.461, Train_accy 88.53:  55%|█████▌    | 11/20 [01:23<01:02,  6.95s/it]
Task 9, Epoch 12/20 => Loss 0.461, Train_accy 88.53:  60%|██████    | 12/20 [01:23<00:55,  6.97s/it]
Task 9, Epoch 13/20 => Loss 0.460, Train_accy 88.62:  60%|██████    | 12/20 [01:30<00:55,  6.97s/it]
Task 9, Epoch 13/20 => Loss 0.460, Train_accy 88.62:  65%|██████▌   | 13/20 [01:30<00:48,  6.97s/it]
Task 9, Epoch 14/20 => Loss 0.468, Train_accy 87.39:  65%|██████▌   | 13/20 [01:37<00:48,  6.97s/it]
Task 9, Epoch 14/20 => Loss 0.468, Train_accy 87.39:  70%|███████   | 14/20 [01:37<00:41,  6.98s/it]
Task 9, Epoch 15/20 => Loss 0.444, Train_accy 88.79:  70%|███████   | 14/20 [01:44<00:41,  6.98s/it]
Task 9, Epoch 15/20 => Loss 0.444, Train_accy 88.79:  75%|███████▌  | 15/20 [01:44<00:34,  6.97s/it]
Task 9, Epoch 16/20 => Loss 0.442, Train_accy 87.48:  75%|███████▌  | 15/20 [01:51<00:34,  6.97s/it]
Task 9, Epoch 16/20 => Loss 0.442, Train_accy 87.48:  80%|████████  | 16/20 [01:51<00:27,  6.97s/it]
Task 9, Epoch 17/20 => Loss 0.425, Train_accy 89.75:  80%|████████  | 16/20 [01:58<00:27,  6.97s/it]
Task 9, Epoch 17/20 => Loss 0.425, Train_accy 89.75:  85%|████████▌ | 17/20 [01:58<00:20,  6.97s/it]
Task 9, Epoch 18/20 => Loss 0.439, Train_accy 89.05:  85%|████████▌ | 17/20 [02:05<00:20,  6.97s/it]
Task 9, Epoch 18/20 => Loss 0.439, Train_accy 89.05:  90%|█████████ | 18/20 [02:05<00:13,  6.98s/it]
Task 9, Epoch 19/20 => Loss 0.425, Train_accy 89.49:  90%|█████████ | 18/20 [02:12<00:13,  6.98s/it]
Task 9, Epoch 19/20 => Loss 0.425, Train_accy 89.49:  95%|█████████▌| 19/20 [02:12<00:06,  6.98s/it]
Task 9, Epoch 20/20 => Loss 0.404, Train_accy 90.28:  95%|█████████▌| 19/20 [02:19<00:06,  6.98s/it]
Task 9, Epoch 20/20 => Loss 0.404, Train_accy 90.28: 100%|██████████| 20/20 [02:19<00:00,  6.98s/it]
Task 9, Epoch 20/20 => Loss 0.404, Train_accy 90.28: 100%|██████████| 20/20 [02:19<00:00,  6.98s/it]
2024-09-08 13:15:30,696 [ease.py] => Task 9, Epoch 20/20 => Loss 0.404, Train_accy 90.28
2024-09-08 13:18:49,277 [ease.py] => Task correct: 75.0218188165474
2024-09-08 13:18:49,278 [ease.py] => Task acc: 92.63396753360098
2024-09-08 13:18:49,306 [trainer.py] => No NME accuracy.
2024-09-08 13:18:49,306 [trainer.py] => CNN: {'total': 74.15, '00-99': 72.83, '100-109': 71.13, '110-119': 82.18, '120-129': 66.42, '130-139': 80.54, '140-149': 83.38, '150-159': 75.14, '160-169': 62.61, '170-179': 79.44, '180-189': 72.73, 'old': 74.23, 'new': 72.73}
2024-09-08 13:18:49,306 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15, 76.79, 76.23, 75.78, 74.62, 74.71, 74.15]
2024-09-08 13:18:49,306 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55, 90.84, 90.64, 90.09, 89.5, 89.32, 88.95]

Average Accuracy (CNN): 76.89
2024-09-08 13:18:49,306 [trainer.py] => Average Accuracy (CNN): 76.89 

2024-09-08 13:18:49,308 [trainer.py] => All params: 87569858
2024-09-08 13:18:49,308 [trainer.py] => Trainable params: 304320
2024-09-08 13:18:49,325 [ease.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.172, Train_accy 39.36:   0%|          | 0/20 [00:06<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.172, Train_accy 39.36:   5%|▌         | 1/20 [00:06<02:12,  6.99s/it]
Task 10, Epoch 2/20 => Loss 1.595, Train_accy 67.91:   5%|▌         | 1/20 [00:13<02:12,  6.99s/it]
Task 10, Epoch 2/20 => Loss 1.595, Train_accy 67.91:  10%|█         | 2/20 [00:13<02:04,  6.94s/it]
Task 10, Epoch 3/20 => Loss 1.079, Train_accy 80.59:  10%|█         | 2/20 [00:20<02:04,  6.94s/it]
Task 10, Epoch 3/20 => Loss 1.079, Train_accy 80.59:  15%|█▌        | 3/20 [00:20<01:57,  6.91s/it]
Task 10, Epoch 4/20 => Loss 0.819, Train_accy 83.69:  15%|█▌        | 3/20 [00:27<01:57,  6.91s/it]
Task 10, Epoch 4/20 => Loss 0.819, Train_accy 83.69:  20%|██        | 4/20 [00:27<01:50,  6.90s/it]
Task 10, Epoch 5/20 => Loss 0.616, Train_accy 88.21:  20%|██        | 4/20 [00:34<01:50,  6.90s/it]
Task 10, Epoch 5/20 => Loss 0.616, Train_accy 88.21:  25%|██▌       | 5/20 [00:34<01:43,  6.88s/it]
Task 10, Epoch 6/20 => Loss 0.543, Train_accy 87.23:  25%|██▌       | 5/20 [00:41<01:43,  6.88s/it]
Task 10, Epoch 6/20 => Loss 0.543, Train_accy 87.23:  30%|███       | 6/20 [00:41<01:36,  6.89s/it]
Task 10, Epoch 7/20 => Loss 0.462, Train_accy 89.89:  30%|███       | 6/20 [00:48<01:36,  6.89s/it]
Task 10, Epoch 7/20 => Loss 0.462, Train_accy 89.89:  35%|███▌      | 7/20 [00:48<01:29,  6.90s/it]
Task 10, Epoch 8/20 => Loss 0.442, Train_accy 88.30:  35%|███▌      | 7/20 [00:55<01:29,  6.90s/it]
Task 10, Epoch 8/20 => Loss 0.442, Train_accy 88.30:  40%|████      | 8/20 [00:55<01:22,  6.89s/it]
Task 10, Epoch 9/20 => Loss 0.404, Train_accy 89.72:  40%|████      | 8/20 [01:02<01:22,  6.89s/it]
Task 10, Epoch 9/20 => Loss 0.404, Train_accy 89.72:  45%|████▌     | 9/20 [01:02<01:16,  6.95s/it]
Task 10, Epoch 10/20 => Loss 0.403, Train_accy 90.07:  45%|████▌     | 9/20 [01:09<01:16,  6.95s/it]
Task 10, Epoch 10/20 => Loss 0.403, Train_accy 90.07:  50%|█████     | 10/20 [01:09<01:09,  6.95s/it]
Task 10, Epoch 11/20 => Loss 0.368, Train_accy 90.60:  50%|█████     | 10/20 [01:16<01:09,  6.95s/it]
Task 10, Epoch 11/20 => Loss 0.368, Train_accy 90.60:  55%|█████▌    | 11/20 [01:16<01:02,  6.95s/it]
Task 10, Epoch 12/20 => Loss 0.355, Train_accy 90.87:  55%|█████▌    | 11/20 [01:23<01:02,  6.95s/it]
Task 10, Epoch 12/20 => Loss 0.355, Train_accy 90.87:  60%|██████    | 12/20 [01:23<00:55,  6.93s/it]
Task 10, Epoch 13/20 => Loss 0.346, Train_accy 91.05:  60%|██████    | 12/20 [01:30<00:55,  6.93s/it]
Task 10, Epoch 13/20 => Loss 0.346, Train_accy 91.05:  65%|██████▌   | 13/20 [01:30<00:48,  6.94s/it]
Task 10, Epoch 14/20 => Loss 0.335, Train_accy 90.60:  65%|██████▌   | 13/20 [01:36<00:48,  6.94s/it]
Task 10, Epoch 14/20 => Loss 0.335, Train_accy 90.60:  70%|███████   | 14/20 [01:36<00:41,  6.94s/it]
Task 10, Epoch 15/20 => Loss 0.372, Train_accy 89.89:  70%|███████   | 14/20 [01:43<00:41,  6.94s/it]
Task 10, Epoch 15/20 => Loss 0.372, Train_accy 89.89:  75%|███████▌  | 15/20 [01:43<00:34,  6.96s/it]
Task 10, Epoch 16/20 => Loss 0.324, Train_accy 91.67:  75%|███████▌  | 15/20 [01:50<00:34,  6.96s/it]
Task 10, Epoch 16/20 => Loss 0.324, Train_accy 91.67:  80%|████████  | 16/20 [01:50<00:27,  6.94s/it]
Task 10, Epoch 17/20 => Loss 0.336, Train_accy 90.60:  80%|████████  | 16/20 [01:57<00:27,  6.94s/it]
Task 10, Epoch 17/20 => Loss 0.336, Train_accy 90.60:  85%|████████▌ | 17/20 [01:57<00:20,  6.93s/it]
Task 10, Epoch 18/20 => Loss 0.298, Train_accy 93.26:  85%|████████▌ | 17/20 [02:04<00:20,  6.93s/it]
Task 10, Epoch 18/20 => Loss 0.298, Train_accy 93.26:  90%|█████████ | 18/20 [02:04<00:13,  6.93s/it]
Task 10, Epoch 19/20 => Loss 0.345, Train_accy 90.16:  90%|█████████ | 18/20 [02:11<00:13,  6.93s/it]
Task 10, Epoch 19/20 => Loss 0.345, Train_accy 90.16:  95%|█████████▌| 19/20 [02:11<00:06,  6.92s/it]
Task 10, Epoch 20/20 => Loss 0.337, Train_accy 90.69:  95%|█████████▌| 19/20 [02:18<00:06,  6.92s/it]
Task 10, Epoch 20/20 => Loss 0.337, Train_accy 90.69: 100%|██████████| 20/20 [02:18<00:00,  6.90s/it]
Task 10, Epoch 20/20 => Loss 0.337, Train_accy 90.69: 100%|██████████| 20/20 [02:18<00:00,  6.92s/it]
2024-09-08 13:21:07,793 [ease.py] => Task 10, Epoch 20/20 => Loss 0.337, Train_accy 90.69
2024-09-08 13:24:55,214 [ease.py] => Task correct: 74.4
2024-09-08 13:24:55,214 [ease.py] => Task acc: 92.75
2024-09-08 13:24:55,235 [trainer.py] => No NME accuracy.
2024-09-08 13:24:55,236 [trainer.py] => CNN: {'total': 73.6, '00-99': 72.26, '100-109': 70.42, '110-119': 81.65, '120-129': 65.31, '130-139': 79.87, '140-149': 82.83, '150-159': 74.86, '160-169': 60.0, '170-179': 78.63, '180-189': 72.08, '190-199': 76.38, 'old': 73.47, 'new': 76.38}
2024-09-08 13:24:55,236 [trainer.py] => CNN top1 curve: [81.21, 80.06, 78.16, 77.15, 76.79, 76.23, 75.78, 74.62, 74.71, 74.15, 73.6]
2024-09-08 13:24:55,236 [trainer.py] => CNN top5 curve: [93.57, 92.9, 92.54, 91.55, 90.84, 90.64, 90.09, 89.5, 89.32, 88.95, 88.58]

Average Accuracy (CNN): 76.59
2024-09-08 13:24:55,236 [trainer.py] => Average Accuracy (CNN): 76.59 

Accuracy Matrix (CNN):
[[81.21 79.97 76.85 75.95 75.44 74.34 74.14 73.57 73.23 72.83 72.26]
 [ 0.   80.99 77.46 76.06 74.65 72.54 72.18 71.48 71.48 71.13 70.42]
 [ 0.    0.   89.1  88.3  87.23 85.37 84.04 83.24 83.24 82.18 81.65]
 [ 0.    0.    0.   76.01 73.06 69.74 68.63 66.79 66.42 66.42 65.31]
 [ 0.    0.    0.    0.   82.55 80.87 80.54 80.54 80.54 80.54 79.87]
 [ 0.    0.    0.    0.    0.   86.1  83.92 83.92 83.92 83.38 82.83]
 [ 0.    0.    0.    0.    0.    0.   76.8  75.69 75.69 75.14 74.86]
 [ 0.    0.    0.    0.    0.    0.    0.   63.04 63.04 62.61 60.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   81.05 79.44 78.63]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   72.73 72.08]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   76.38]]
2024-09-08 13:24:55,237 [trainer.py] => Forgetting (CNN): 5.166999999999996
