nohup: 忽略输入
2024-09-04 16:27:21,013 [trainer.py] => config: ./exps/finetune_cub_B0_Inc5.json
2024-09-04 16:27:21,013 [trainer.py] => prefix: reproduce
2024-09-04 16:27:21,013 [trainer.py] => dataset: cub
2024-09-04 16:27:21,013 [trainer.py] => memory_size: 0
2024-09-04 16:27:21,013 [trainer.py] => memory_per_class: 0
2024-09-04 16:27:21,013 [trainer.py] => fixed_memory: False
2024-09-04 16:27:21,013 [trainer.py] => shuffle: True
2024-09-04 16:27:21,013 [trainer.py] => init_cls: 40
2024-09-04 16:27:21,013 [trainer.py] => increment: 40
2024-09-04 16:27:21,013 [trainer.py] => model_name: finetune
2024-09-04 16:27:21,013 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 16:27:21,013 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 16:27:21,013 [trainer.py] => seed: 1993
2024-09-04 16:27:21,013 [trainer.py] => init_epoch: 20
2024-09-04 16:27:21,013 [trainer.py] => init_lr: 0.001
2024-09-04 16:27:21,013 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 16:27:21,013 [trainer.py] => init_lr_decay: 0.1
2024-09-04 16:27:21,013 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 16:27:21,013 [trainer.py] => epochs: 20
2024-09-04 16:27:21,013 [trainer.py] => lrate: 0.001
2024-09-04 16:27:21,013 [trainer.py] => milestones: [40, 70]
2024-09-04 16:27:21,013 [trainer.py] => lrate_decay: 0.1
2024-09-04 16:27:21,013 [trainer.py] => batch_size: 48
2024-09-04 16:27:21,014 [trainer.py] => weight_decay: 0.0002
2024-09-04 16:27:21,051 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 16:27:22,762 [trainer.py] => All params: 85798656
2024-09-04 16:27:22,763 [trainer.py] => Trainable params: 85798656
2024-09-04 16:27:22,763 [finetune.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.270, Train_accy 41.72, Test_accy 85.02:   0%|          | 0/20 [00:16<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.270, Train_accy 41.72, Test_accy 85.02:   5%|▌         | 1/20 [00:16<05:09, 16.31s/it]
Task 0, Epoch 2/20 => Loss 0.628, Train_accy 82.23:   5%|▌         | 1/20 [00:30<05:09, 16.31s/it]                 
Task 0, Epoch 2/20 => Loss 0.628, Train_accy 82.23:  10%|█         | 2/20 [00:30<04:34, 15.24s/it]
Task 0, Epoch 3/20 => Loss 0.490, Train_accy 86.04:  10%|█         | 2/20 [00:45<04:34, 15.24s/it]
Task 0, Epoch 3/20 => Loss 0.490, Train_accy 86.04:  15%|█▌        | 3/20 [00:45<04:13, 14.88s/it]
Task 0, Epoch 4/20 => Loss 0.400, Train_accy 88.15:  15%|█▌        | 3/20 [00:59<04:13, 14.88s/it]
Task 0, Epoch 4/20 => Loss 0.400, Train_accy 88.15:  20%|██        | 4/20 [00:59<03:55, 14.70s/it]
Task 0, Epoch 5/20 => Loss 0.392, Train_accy 88.42:  20%|██        | 4/20 [01:14<03:55, 14.70s/it]
Task 0, Epoch 5/20 => Loss 0.392, Train_accy 88.42:  25%|██▌       | 5/20 [01:14<03:39, 14.61s/it]
Task 0, Epoch 6/20 => Loss 0.326, Train_accy 91.12, Test_accy 96.04:  25%|██▌       | 5/20 [01:30<03:39, 14.61s/it]
Task 0, Epoch 6/20 => Loss 0.326, Train_accy 91.12, Test_accy 96.04:  30%|███       | 6/20 [01:30<03:31, 15.13s/it]
Task 0, Epoch 7/20 => Loss 0.263, Train_accy 92.54:  30%|███       | 6/20 [01:44<03:31, 15.13s/it]                 
Task 0, Epoch 7/20 => Loss 0.263, Train_accy 92.54:  35%|███▌      | 7/20 [01:44<03:13, 14.89s/it]
Task 0, Epoch 8/20 => Loss 0.265, Train_accy 92.70:  35%|███▌      | 7/20 [01:59<03:13, 14.89s/it]
Task 0, Epoch 8/20 => Loss 0.265, Train_accy 92.70:  40%|████      | 8/20 [01:59<02:57, 14.76s/it]
Task 0, Epoch 9/20 => Loss 0.252, Train_accy 92.49:  40%|████      | 8/20 [02:13<02:57, 14.76s/it]
Task 0, Epoch 9/20 => Loss 0.252, Train_accy 92.49:  45%|████▌     | 9/20 [02:13<02:41, 14.67s/it]
Task 0, Epoch 10/20 => Loss 0.279, Train_accy 91.59:  45%|████▌     | 9/20 [02:28<02:41, 14.67s/it]
Task 0, Epoch 10/20 => Loss 0.279, Train_accy 91.59:  50%|█████     | 10/20 [02:28<02:26, 14.62s/it]
Task 0, Epoch 11/20 => Loss 0.239, Train_accy 93.18, Test_accy 95.37:  50%|█████     | 10/20 [02:44<02:26, 14.62s/it]
Task 0, Epoch 11/20 => Loss 0.239, Train_accy 93.18, Test_accy 95.37:  55%|█████▌    | 11/20 [02:44<02:16, 15.14s/it]
Task 0, Epoch 12/20 => Loss 0.265, Train_accy 92.28:  55%|█████▌    | 11/20 [02:58<02:16, 15.14s/it]                 
Task 0, Epoch 12/20 => Loss 0.265, Train_accy 92.28:  60%|██████    | 12/20 [02:58<01:59, 14.95s/it]
Task 0, Epoch 13/20 => Loss 0.282, Train_accy 91.91:  60%|██████    | 12/20 [03:13<01:59, 14.95s/it]
Task 0, Epoch 13/20 => Loss 0.282, Train_accy 91.91:  65%|██████▌   | 13/20 [03:13<01:43, 14.79s/it]
Task 0, Epoch 14/20 => Loss 0.267, Train_accy 91.86:  65%|██████▌   | 13/20 [03:27<01:43, 14.79s/it]
Task 0, Epoch 14/20 => Loss 0.267, Train_accy 91.86:  70%|███████   | 14/20 [03:27<01:28, 14.69s/it]
Task 0, Epoch 15/20 => Loss 0.232, Train_accy 93.65:  70%|███████   | 14/20 [03:42<01:28, 14.69s/it]
Task 0, Epoch 15/20 => Loss 0.232, Train_accy 93.65:  75%|███████▌  | 15/20 [03:42<01:13, 14.63s/it]
Task 0, Epoch 16/20 => Loss 0.220, Train_accy 93.76, Test_accy 96.04:  75%|███████▌  | 15/20 [03:58<01:13, 14.63s/it]
Task 0, Epoch 16/20 => Loss 0.220, Train_accy 93.76, Test_accy 96.04:  80%|████████  | 16/20 [03:58<01:00, 15.11s/it]
Task 0, Epoch 17/20 => Loss 0.200, Train_accy 94.08:  80%|████████  | 16/20 [04:13<01:00, 15.11s/it]                 
Task 0, Epoch 17/20 => Loss 0.200, Train_accy 94.08:  85%|████████▌ | 17/20 [04:13<00:44, 14.92s/it]
Task 0, Epoch 18/20 => Loss 0.242, Train_accy 93.65:  85%|████████▌ | 17/20 [04:27<00:44, 14.92s/it]
Task 0, Epoch 18/20 => Loss 0.242, Train_accy 93.65:  90%|█████████ | 18/20 [04:27<00:29, 14.80s/it]
Task 0, Epoch 19/20 => Loss 0.189, Train_accy 94.71:  90%|█████████ | 18/20 [04:41<00:29, 14.80s/it]
Task 0, Epoch 19/20 => Loss 0.189, Train_accy 94.71:  95%|█████████▌| 19/20 [04:41<00:14, 14.69s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39:  95%|█████████▌| 19/20 [04:56<00:14, 14.69s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39: 100%|██████████| 20/20 [04:56<00:00, 14.60s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39: 100%|██████████| 20/20 [04:56<00:00, 14.82s/it]
2024-09-04 16:32:19,650 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39
2024-09-04 16:32:21,363 [trainer.py] => No NME accuracy.
2024-09-04 16:32:21,363 [trainer.py] => CNN: {'total': 94.71, '00-39': 94.71, 'old': 0, 'new': 94.71}
2024-09-04 16:32:21,363 [trainer.py] => CNN top1 curve: [94.71]
2024-09-04 16:32:21,363 [trainer.py] => CNN top5 curve: [99.56]

Average Accuracy (CNN): 94.71
2024-09-04 16:32:21,363 [trainer.py] => Average Accuracy (CNN): 94.71 

2024-09-04 16:32:21,364 [trainer.py] => All params: 85829416
2024-09-04 16:32:21,365 [trainer.py] => Trainable params: 85829416
2024-09-04 16:32:21,367 [finetune.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.039, Train_accy 18.79, Test_accy 74.21:   0%|          | 0/20 [00:17<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.039, Train_accy 18.79, Test_accy 74.21:   5%|▌         | 1/20 [00:17<05:31, 17.47s/it]
Task 1, Epoch 2/20 => Loss 0.504, Train_accy 63.26:   5%|▌         | 1/20 [00:31<05:31, 17.47s/it]                 
Task 1, Epoch 2/20 => Loss 0.504, Train_accy 63.26:  10%|█         | 2/20 [00:31<04:41, 15.64s/it]
Task 1, Epoch 3/20 => Loss 0.434, Train_accy 73.48:  10%|█         | 2/20 [00:46<04:41, 15.64s/it]
Task 1, Epoch 3/20 => Loss 0.434, Train_accy 73.48:  15%|█▌        | 3/20 [00:46<04:16, 15.11s/it]
Task 1, Epoch 4/20 => Loss 0.368, Train_accy 77.50:  15%|█▌        | 3/20 [01:00<04:16, 15.11s/it]
Task 1, Epoch 4/20 => Loss 0.368, Train_accy 77.50:  20%|██        | 4/20 [01:00<03:57, 14.85s/it]
Task 1, Epoch 5/20 => Loss 0.337, Train_accy 81.47:  20%|██        | 4/20 [01:15<03:57, 14.85s/it]
Task 1, Epoch 5/20 => Loss 0.337, Train_accy 81.47:  25%|██▌       | 5/20 [01:15<03:40, 14.69s/it]
Task 1, Epoch 6/20 => Loss 0.304, Train_accy 82.64, Test_accy 85.96:  25%|██▌       | 5/20 [01:32<03:40, 14.69s/it]
Task 1, Epoch 6/20 => Loss 0.304, Train_accy 82.64, Test_accy 85.96:  30%|███       | 6/20 [01:32<03:39, 15.65s/it]
Task 1, Epoch 7/20 => Loss 0.331, Train_accy 82.74:  30%|███       | 6/20 [01:47<03:39, 15.65s/it]                 
Task 1, Epoch 7/20 => Loss 0.331, Train_accy 82.74:  35%|███▌      | 7/20 [01:47<03:18, 15.24s/it]
Task 1, Epoch 8/20 => Loss 0.270, Train_accy 85.76:  35%|███▌      | 7/20 [02:01<03:18, 15.24s/it]
Task 1, Epoch 8/20 => Loss 0.270, Train_accy 85.76:  40%|████      | 8/20 [02:01<02:59, 14.99s/it]
Task 1, Epoch 9/20 => Loss 0.271, Train_accy 86.08:  40%|████      | 8/20 [02:15<02:59, 14.99s/it]
Task 1, Epoch 9/20 => Loss 0.271, Train_accy 86.08:  45%|████▌     | 9/20 [02:15<02:43, 14.82s/it]
Task 1, Epoch 10/20 => Loss 0.294, Train_accy 85.97:  45%|████▌     | 9/20 [02:30<02:43, 14.82s/it]
Task 1, Epoch 10/20 => Loss 0.294, Train_accy 85.97:  50%|█████     | 10/20 [02:30<02:27, 14.70s/it]
Task 1, Epoch 11/20 => Loss 0.263, Train_accy 87.88, Test_accy 86.83:  50%|█████     | 10/20 [02:47<02:27, 14.70s/it]
Task 1, Epoch 11/20 => Loss 0.263, Train_accy 87.88, Test_accy 86.83:  55%|█████▌    | 11/20 [02:47<02:19, 15.54s/it]
Task 1, Epoch 12/20 => Loss 0.266, Train_accy 87.45:  55%|█████▌    | 11/20 [03:02<02:19, 15.54s/it]                 
Task 1, Epoch 12/20 => Loss 0.266, Train_accy 87.45:  60%|██████    | 12/20 [03:02<02:02, 15.25s/it]
Task 1, Epoch 13/20 => Loss 0.254, Train_accy 88.35:  60%|██████    | 12/20 [03:16<02:02, 15.25s/it]
Task 1, Epoch 13/20 => Loss 0.254, Train_accy 88.35:  65%|██████▌   | 13/20 [03:16<01:45, 15.00s/it]
Task 1, Epoch 14/20 => Loss 0.298, Train_accy 87.19:  65%|██████▌   | 13/20 [03:31<01:45, 15.00s/it]
Task 1, Epoch 14/20 => Loss 0.298, Train_accy 87.19:  70%|███████   | 14/20 [03:31<01:29, 14.87s/it]
Task 1, Epoch 15/20 => Loss 0.191, Train_accy 91.05:  70%|███████   | 14/20 [03:45<01:29, 14.87s/it]
Task 1, Epoch 15/20 => Loss 0.191, Train_accy 91.05:  75%|███████▌  | 15/20 [03:45<01:13, 14.75s/it]
Task 1, Epoch 16/20 => Loss 0.232, Train_accy 89.52, Test_accy 85.85:  75%|███████▌  | 15/20 [04:03<01:13, 14.75s/it]
Task 1, Epoch 16/20 => Loss 0.232, Train_accy 89.52, Test_accy 85.85:  80%|████████  | 16/20 [04:03<01:02, 15.57s/it]
Task 1, Epoch 17/20 => Loss 0.214, Train_accy 90.63:  80%|████████  | 16/20 [04:17<01:02, 15.57s/it]                 
Task 1, Epoch 17/20 => Loss 0.214, Train_accy 90.63:  85%|████████▌ | 17/20 [04:17<00:45, 15.24s/it]
Task 1, Epoch 18/20 => Loss 0.208, Train_accy 90.84:  85%|████████▌ | 17/20 [04:32<00:45, 15.24s/it]
Task 1, Epoch 18/20 => Loss 0.208, Train_accy 90.84:  90%|█████████ | 18/20 [04:32<00:30, 15.02s/it]
Task 1, Epoch 19/20 => Loss 0.258, Train_accy 90.42:  90%|█████████ | 18/20 [04:46<00:30, 15.02s/it]
Task 1, Epoch 19/20 => Loss 0.258, Train_accy 90.42:  95%|█████████▌| 19/20 [04:46<00:14, 14.84s/it]
Task 1, Epoch 20/20 => Loss 0.253, Train_accy 89.89:  95%|█████████▌| 19/20 [05:01<00:14, 14.84s/it]
Task 1, Epoch 20/20 => Loss 0.253, Train_accy 89.89: 100%|██████████| 20/20 [05:01<00:00, 14.71s/it]
Task 1, Epoch 20/20 => Loss 0.253, Train_accy 89.89: 100%|██████████| 20/20 [05:01<00:00, 15.06s/it]
2024-09-04 16:37:22,576 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.253, Train_accy 89.89
2024-09-04 16:37:25,607 [trainer.py] => No NME accuracy.
2024-09-04 16:37:25,608 [trainer.py] => CNN: {'total': 84.44, '00-39': 79.52, '40-79': 89.25, 'old': 79.52, 'new': 89.25}
2024-09-04 16:37:25,608 [trainer.py] => CNN top1 curve: [94.71, 84.44]
2024-09-04 16:37:25,608 [trainer.py] => CNN top5 curve: [99.56, 98.15]

Average Accuracy (CNN): 89.57
2024-09-04 16:37:25,608 [trainer.py] => Average Accuracy (CNN): 89.57 

2024-09-04 16:37:25,610 [trainer.py] => All params: 85860176
2024-09-04 16:37:25,611 [trainer.py] => Trainable params: 85860176
2024-09-04 16:37:25,614 [finetune.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.670, Train_accy 26.05, Test_accy 75.49:   0%|          | 0/20 [00:18<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.670, Train_accy 26.05, Test_accy 75.49:   5%|▌         | 1/20 [00:18<05:55, 18.70s/it]
Task 2, Epoch 2/20 => Loss 0.500, Train_accy 64.47:   5%|▌         | 1/20 [00:32<05:55, 18.70s/it]                 
Task 2, Epoch 2/20 => Loss 0.500, Train_accy 64.47:  10%|█         | 2/20 [00:32<04:49, 16.08s/it]
Task 2, Epoch 3/20 => Loss 0.364, Train_accy 70.20:  10%|█         | 2/20 [00:47<04:49, 16.08s/it]
Task 2, Epoch 3/20 => Loss 0.364, Train_accy 70.20:  15%|█▌        | 3/20 [00:47<04:19, 15.24s/it]
Task 2, Epoch 4/20 => Loss 0.298, Train_accy 77.44:  15%|█▌        | 3/20 [01:01<04:19, 15.24s/it]
Task 2, Epoch 4/20 => Loss 0.298, Train_accy 77.44:  20%|██        | 4/20 [01:01<03:58, 14.88s/it]
Task 2, Epoch 5/20 => Loss 0.313, Train_accy 76.21:  20%|██        | 4/20 [01:15<03:58, 14.88s/it]
Task 2, Epoch 5/20 => Loss 0.313, Train_accy 76.21:  25%|██▌       | 5/20 [01:15<03:40, 14.67s/it]
Task 2, Epoch 6/20 => Loss 0.343, Train_accy 76.58, Test_accy 78.60:  25%|██▌       | 5/20 [01:34<03:40, 14.67s/it]
Task 2, Epoch 6/20 => Loss 0.343, Train_accy 76.58, Test_accy 78.60:  30%|███       | 6/20 [01:34<03:45, 16.08s/it]
Task 2, Epoch 7/20 => Loss 0.267, Train_accy 80.01:  30%|███       | 6/20 [01:48<03:45, 16.08s/it]                 
Task 2, Epoch 7/20 => Loss 0.267, Train_accy 80.01:  35%|███▌      | 7/20 [01:48<03:21, 15.50s/it]
Task 2, Epoch 8/20 => Loss 0.274, Train_accy 81.40:  35%|███▌      | 7/20 [02:03<03:21, 15.50s/it]
Task 2, Epoch 8/20 => Loss 0.274, Train_accy 81.40:  40%|████      | 8/20 [02:03<03:01, 15.11s/it]
Task 2, Epoch 9/20 => Loss 0.306, Train_accy 81.40:  40%|████      | 8/20 [02:17<03:01, 15.11s/it]
Task 2, Epoch 9/20 => Loss 0.306, Train_accy 81.40:  45%|████▌     | 9/20 [02:17<02:43, 14.84s/it]
Task 2, Epoch 10/20 => Loss 0.260, Train_accy 85.53:  45%|████▌     | 9/20 [02:31<02:43, 14.84s/it]
Task 2, Epoch 10/20 => Loss 0.260, Train_accy 85.53:  50%|█████     | 10/20 [02:31<02:26, 14.66s/it]
Task 2, Epoch 11/20 => Loss 0.289, Train_accy 84.19, Test_accy 79.17:  50%|█████     | 10/20 [02:50<02:26, 14.66s/it]
Task 2, Epoch 11/20 => Loss 0.289, Train_accy 84.19, Test_accy 79.17:  55%|█████▌    | 11/20 [02:50<02:23, 15.93s/it]
Task 2, Epoch 12/20 => Loss 0.237, Train_accy 85.21:  55%|█████▌    | 11/20 [03:04<02:23, 15.93s/it]                 
Task 2, Epoch 12/20 => Loss 0.237, Train_accy 85.21:  60%|██████    | 12/20 [03:04<02:03, 15.45s/it]
Task 2, Epoch 13/20 => Loss 0.242, Train_accy 86.28:  60%|██████    | 12/20 [03:19<02:03, 15.45s/it]
Task 2, Epoch 13/20 => Loss 0.242, Train_accy 86.28:  65%|██████▌   | 13/20 [03:19<01:45, 15.09s/it]
Task 2, Epoch 14/20 => Loss 0.237, Train_accy 87.14:  65%|██████▌   | 13/20 [03:33<01:45, 15.09s/it]
Task 2, Epoch 14/20 => Loss 0.237, Train_accy 87.14:  70%|███████   | 14/20 [03:33<01:29, 14.84s/it]
Task 2, Epoch 15/20 => Loss 0.237, Train_accy 86.87:  70%|███████   | 14/20 [03:47<01:29, 14.84s/it]
Task 2, Epoch 15/20 => Loss 0.237, Train_accy 86.87:  75%|███████▌  | 15/20 [03:47<01:13, 14.67s/it]
Task 2, Epoch 16/20 => Loss 0.225, Train_accy 88.59, Test_accy 81.00:  75%|███████▌  | 15/20 [04:06<01:13, 14.67s/it]
Task 2, Epoch 16/20 => Loss 0.225, Train_accy 88.59, Test_accy 81.00:  80%|████████  | 16/20 [04:06<01:03, 15.91s/it]
Task 2, Epoch 17/20 => Loss 0.206, Train_accy 89.39:  80%|████████  | 16/20 [04:20<01:03, 15.91s/it]                 
Task 2, Epoch 17/20 => Loss 0.206, Train_accy 89.39:  85%|████████▌ | 17/20 [04:20<00:46, 15.42s/it]
Task 2, Epoch 18/20 => Loss 0.236, Train_accy 89.44:  85%|████████▌ | 17/20 [04:35<00:46, 15.42s/it]
Task 2, Epoch 18/20 => Loss 0.236, Train_accy 89.44:  90%|█████████ | 18/20 [04:35<00:30, 15.09s/it]
Task 2, Epoch 19/20 => Loss 0.203, Train_accy 90.14:  90%|█████████ | 18/20 [04:49<00:30, 15.09s/it]
Task 2, Epoch 19/20 => Loss 0.203, Train_accy 90.14:  95%|█████████▌| 19/20 [04:49<00:14, 14.86s/it]
Task 2, Epoch 20/20 => Loss 0.206, Train_accy 89.71:  95%|█████████▌| 19/20 [05:03<00:14, 14.86s/it]
Task 2, Epoch 20/20 => Loss 0.206, Train_accy 89.71: 100%|██████████| 20/20 [05:03<00:00, 14.69s/it]
Task 2, Epoch 20/20 => Loss 0.206, Train_accy 89.71: 100%|██████████| 20/20 [05:03<00:00, 15.18s/it]
2024-09-04 16:42:29,307 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.206, Train_accy 89.71
2024-09-04 16:42:33,740 [trainer.py] => No NME accuracy.
2024-09-04 16:42:33,740 [trainer.py] => CNN: {'total': 78.25, '00-39': 67.62, '40-79': 74.19, '80-119': 91.75, 'old': 70.95, 'new': 91.75}
2024-09-04 16:42:33,741 [trainer.py] => CNN top1 curve: [94.71, 84.44, 78.25]
2024-09-04 16:42:33,741 [trainer.py] => CNN top5 curve: [99.56, 98.15, 97.32]

Average Accuracy (CNN): 85.8
2024-09-04 16:42:33,741 [trainer.py] => Average Accuracy (CNN): 85.8 

2024-09-04 16:42:33,743 [trainer.py] => All params: 85890936
2024-09-04 16:42:33,744 [trainer.py] => Trainable params: 85890936
2024-09-04 16:42:33,748 [finetune.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.870, Train_accy 20.60, Test_accy 72.18:   0%|          | 0/20 [00:20<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.870, Train_accy 20.60, Test_accy 72.18:   5%|▌         | 1/20 [00:20<06:22, 20.12s/it]
Task 3, Epoch 2/20 => Loss 0.566, Train_accy 65.69:   5%|▌         | 1/20 [00:34<06:22, 20.12s/it]                 
Task 3, Epoch 2/20 => Loss 0.566, Train_accy 65.69:  10%|█         | 2/20 [00:34<05:01, 16.78s/it]
Task 3, Epoch 3/20 => Loss 0.498, Train_accy 73.91:  10%|█         | 2/20 [00:48<05:01, 16.78s/it]
Task 3, Epoch 3/20 => Loss 0.498, Train_accy 73.91:  15%|█▌        | 3/20 [00:48<04:26, 15.68s/it]
Task 3, Epoch 4/20 => Loss 0.524, Train_accy 75.51:  15%|█▌        | 3/20 [01:03<04:26, 15.68s/it]
Task 3, Epoch 4/20 => Loss 0.524, Train_accy 75.51:  20%|██        | 4/20 [01:03<04:03, 15.21s/it]
Task 3, Epoch 5/20 => Loss 0.411, Train_accy 80.36:  20%|██        | 4/20 [01:17<04:03, 15.21s/it]
Task 3, Epoch 5/20 => Loss 0.411, Train_accy 80.36:  25%|██▌       | 5/20 [01:17<03:43, 14.91s/it]
Task 3, Epoch 6/20 => Loss 0.534, Train_accy 77.16, Test_accy 69.86:  25%|██▌       | 5/20 [01:37<03:43, 14.91s/it]
Task 3, Epoch 6/20 => Loss 0.534, Train_accy 77.16, Test_accy 69.86:  30%|███       | 6/20 [01:37<03:53, 16.67s/it]
Task 3, Epoch 7/20 => Loss 0.427, Train_accy 82.50:  30%|███       | 6/20 [01:52<03:53, 16.67s/it]                 
Task 3, Epoch 7/20 => Loss 0.427, Train_accy 82.50:  35%|███▌      | 7/20 [01:52<03:27, 15.96s/it]
Task 3, Epoch 8/20 => Loss 0.362, Train_accy 82.87:  35%|███▌      | 7/20 [02:06<03:27, 15.96s/it]
Task 3, Epoch 8/20 => Loss 0.362, Train_accy 82.87:  40%|████      | 8/20 [02:06<03:05, 15.50s/it]
Task 3, Epoch 9/20 => Loss 0.319, Train_accy 86.39:  40%|████      | 8/20 [02:21<03:05, 15.50s/it]
Task 3, Epoch 9/20 => Loss 0.319, Train_accy 86.39:  45%|████▌     | 9/20 [02:21<02:46, 15.18s/it]
Task 3, Epoch 10/20 => Loss 0.369, Train_accy 85.54:  45%|████▌     | 9/20 [02:35<02:46, 15.18s/it]
Task 3, Epoch 10/20 => Loss 0.369, Train_accy 85.54:  50%|█████     | 10/20 [02:35<02:29, 14.94s/it]
Task 3, Epoch 11/20 => Loss 0.274, Train_accy 87.46, Test_accy 70.81:  50%|█████     | 10/20 [02:55<02:29, 14.94s/it]
Task 3, Epoch 11/20 => Loss 0.274, Train_accy 87.46, Test_accy 70.81:  55%|█████▌    | 11/20 [02:55<02:28, 16.55s/it]
Task 3, Epoch 12/20 => Loss 0.282, Train_accy 87.35:  55%|█████▌    | 11/20 [03:10<02:28, 16.55s/it]                 
Task 3, Epoch 12/20 => Loss 0.282, Train_accy 87.35:  60%|██████    | 12/20 [03:10<02:07, 15.96s/it]
Task 3, Epoch 13/20 => Loss 0.235, Train_accy 89.97:  60%|██████    | 12/20 [03:24<02:07, 15.96s/it]
Task 3, Epoch 13/20 => Loss 0.235, Train_accy 89.97:  65%|██████▌   | 13/20 [03:24<01:48, 15.48s/it]
Task 3, Epoch 14/20 => Loss 0.278, Train_accy 88.90:  65%|██████▌   | 13/20 [03:39<01:48, 15.48s/it]
Task 3, Epoch 14/20 => Loss 0.278, Train_accy 88.90:  70%|███████   | 14/20 [03:39<01:30, 15.15s/it]
Task 3, Epoch 15/20 => Loss 0.235, Train_accy 89.65:  70%|███████   | 14/20 [03:53<01:30, 15.15s/it]
Task 3, Epoch 15/20 => Loss 0.235, Train_accy 89.65:  75%|███████▌  | 15/20 [03:53<01:14, 14.91s/it]
Task 3, Epoch 16/20 => Loss 0.286, Train_accy 88.10, Test_accy 70.44:  75%|███████▌  | 15/20 [04:13<01:14, 14.91s/it]
Task 3, Epoch 16/20 => Loss 0.286, Train_accy 88.10, Test_accy 70.44:  80%|████████  | 16/20 [04:13<01:05, 16.47s/it]
Task 3, Epoch 17/20 => Loss 0.272, Train_accy 89.65:  80%|████████  | 16/20 [04:28<01:05, 16.47s/it]                 
Task 3, Epoch 17/20 => Loss 0.272, Train_accy 89.65:  85%|████████▌ | 17/20 [04:28<00:47, 15.86s/it]
Task 3, Epoch 18/20 => Loss 0.356, Train_accy 86.55:  85%|████████▌ | 17/20 [04:42<00:47, 15.86s/it]
Task 3, Epoch 18/20 => Loss 0.356, Train_accy 86.55:  90%|█████████ | 18/20 [04:42<00:30, 15.44s/it]
Task 3, Epoch 19/20 => Loss 0.247, Train_accy 88.69:  90%|█████████ | 18/20 [04:57<00:30, 15.44s/it]
Task 3, Epoch 19/20 => Loss 0.247, Train_accy 88.69:  95%|█████████▌| 19/20 [04:57<00:15, 15.14s/it]
Task 3, Epoch 20/20 => Loss 0.285, Train_accy 89.22:  95%|█████████▌| 19/20 [05:11<00:15, 15.14s/it]
Task 3, Epoch 20/20 => Loss 0.285, Train_accy 89.22: 100%|██████████| 20/20 [05:11<00:00, 14.90s/it]
Task 3, Epoch 20/20 => Loss 0.285, Train_accy 89.22: 100%|██████████| 20/20 [05:11<00:00, 15.58s/it]
2024-09-04 16:47:45,266 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.285, Train_accy 89.22
2024-09-04 16:47:51,096 [trainer.py] => No NME accuracy.
2024-09-04 16:47:51,097 [trainer.py] => CNN: {'total': 67.95, '00-39': 45.81, '40-79': 61.94, '80-119': 69.82, '120-159': 93.05, 'old': 59.53, 'new': 93.05}
2024-09-04 16:47:51,097 [trainer.py] => CNN top1 curve: [94.71, 84.44, 78.25, 67.95]
2024-09-04 16:47:51,097 [trainer.py] => CNN top5 curve: [99.56, 98.15, 97.32, 94.18]

Average Accuracy (CNN): 81.34
2024-09-04 16:47:51,097 [trainer.py] => Average Accuracy (CNN): 81.34 

2024-09-04 16:47:51,098 [trainer.py] => All params: 85921696
2024-09-04 16:47:51,099 [trainer.py] => Trainable params: 85921696
2024-09-04 16:47:51,103 [finetune.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.924, Train_accy 14.97, Test_accy 61.83:   0%|          | 0/20 [00:21<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.924, Train_accy 14.97, Test_accy 61.83:   5%|▌         | 1/20 [00:21<06:51, 21.68s/it]
Task 4, Epoch 2/20 => Loss 0.536, Train_accy 54.66:   5%|▌         | 1/20 [00:36<06:51, 21.68s/it]                 
Task 4, Epoch 2/20 => Loss 0.536, Train_accy 54.66:  10%|█         | 2/20 [00:36<05:15, 17.53s/it]
Task 4, Epoch 3/20 => Loss 0.426, Train_accy 65.60:  10%|█         | 2/20 [00:51<05:15, 17.53s/it]
Task 4, Epoch 3/20 => Loss 0.426, Train_accy 65.60:  15%|█▌        | 3/20 [00:51<04:36, 16.25s/it]
Task 4, Epoch 4/20 => Loss 0.355, Train_accy 70.42:  15%|█▌        | 3/20 [01:05<04:36, 16.25s/it]
Task 4, Epoch 4/20 => Loss 0.355, Train_accy 70.42:  20%|██        | 4/20 [01:05<04:09, 15.61s/it]
Task 4, Epoch 5/20 => Loss 0.339, Train_accy 71.99:  20%|██        | 4/20 [01:20<04:09, 15.61s/it]
Task 4, Epoch 5/20 => Loss 0.339, Train_accy 71.99:  25%|██▌       | 5/20 [01:20<03:49, 15.28s/it]
Task 4, Epoch 6/20 => Loss 0.306, Train_accy 72.46, Test_accy 67.30:  25%|██▌       | 5/20 [01:42<03:49, 15.28s/it]
Task 4, Epoch 6/20 => Loss 0.306, Train_accy 72.46, Test_accy 67.30:  30%|███       | 6/20 [01:42<04:04, 17.45s/it]
Task 4, Epoch 7/20 => Loss 0.298, Train_accy 76.34:  30%|███       | 6/20 [01:56<04:04, 17.45s/it]                 
Task 4, Epoch 7/20 => Loss 0.298, Train_accy 76.34:  35%|███▌      | 7/20 [01:56<03:34, 16.53s/it]
Task 4, Epoch 8/20 => Loss 0.327, Train_accy 75.50:  35%|███▌      | 7/20 [02:11<03:34, 16.53s/it]
Task 4, Epoch 8/20 => Loss 0.327, Train_accy 75.50:  40%|████      | 8/20 [02:11<03:11, 15.94s/it]
Task 4, Epoch 9/20 => Loss 0.318, Train_accy 77.59:  40%|████      | 8/20 [02:25<03:11, 15.94s/it]
Task 4, Epoch 9/20 => Loss 0.318, Train_accy 77.59:  45%|████▌     | 9/20 [02:25<02:50, 15.54s/it]
Task 4, Epoch 10/20 => Loss 0.249, Train_accy 81.78:  45%|████▌     | 9/20 [02:40<02:50, 15.54s/it]
Task 4, Epoch 10/20 => Loss 0.249, Train_accy 81.78:  50%|█████     | 10/20 [02:40<02:32, 15.27s/it]
Task 4, Epoch 11/20 => Loss 0.294, Train_accy 80.58, Test_accy 64.89:  50%|█████     | 10/20 [03:02<02:32, 15.27s/it]
Task 4, Epoch 11/20 => Loss 0.294, Train_accy 80.58, Test_accy 64.89:  55%|█████▌    | 11/20 [03:02<02:35, 17.22s/it]
Task 4, Epoch 12/20 => Loss 0.295, Train_accy 82.20:  55%|█████▌    | 11/20 [03:16<02:35, 17.22s/it]                 
Task 4, Epoch 12/20 => Loss 0.295, Train_accy 82.20:  60%|██████    | 12/20 [03:16<02:11, 16.43s/it]
Task 4, Epoch 13/20 => Loss 0.234, Train_accy 83.25:  60%|██████    | 12/20 [03:31<02:11, 16.43s/it]
Task 4, Epoch 13/20 => Loss 0.234, Train_accy 83.25:  65%|██████▌   | 13/20 [03:31<01:51, 15.87s/it]
Task 4, Epoch 14/20 => Loss 0.286, Train_accy 82.88:  65%|██████▌   | 13/20 [03:46<01:51, 15.87s/it]
Task 4, Epoch 14/20 => Loss 0.286, Train_accy 82.88:  70%|███████   | 14/20 [03:46<01:33, 15.50s/it]
Task 4, Epoch 15/20 => Loss 0.234, Train_accy 85.34:  70%|███████   | 14/20 [04:00<01:33, 15.50s/it]
Task 4, Epoch 15/20 => Loss 0.234, Train_accy 85.34:  75%|███████▌  | 15/20 [04:00<01:16, 15.23s/it]
Task 4, Epoch 16/20 => Loss 0.270, Train_accy 84.82, Test_accy 64.25:  75%|███████▌  | 15/20 [04:22<01:16, 15.23s/it]
Task 4, Epoch 16/20 => Loss 0.270, Train_accy 84.82, Test_accy 64.25:  80%|████████  | 16/20 [04:22<01:08, 17.22s/it]
Task 4, Epoch 17/20 => Loss 0.269, Train_accy 85.65:  80%|████████  | 16/20 [04:37<01:08, 17.22s/it]                 
Task 4, Epoch 17/20 => Loss 0.269, Train_accy 85.65:  85%|████████▌ | 17/20 [04:37<00:49, 16.44s/it]
Task 4, Epoch 18/20 => Loss 0.236, Train_accy 86.13:  85%|████████▌ | 17/20 [04:51<00:49, 16.44s/it]
Task 4, Epoch 18/20 => Loss 0.236, Train_accy 86.13:  90%|█████████ | 18/20 [04:51<00:31, 15.89s/it]
Task 4, Epoch 19/20 => Loss 0.228, Train_accy 87.64:  90%|█████████ | 18/20 [05:06<00:31, 15.89s/it]
Task 4, Epoch 19/20 => Loss 0.228, Train_accy 87.64:  95%|█████████▌| 19/20 [05:06<00:15, 15.53s/it]
Task 4, Epoch 20/20 => Loss 0.201, Train_accy 87.28:  95%|█████████▌| 19/20 [05:21<00:15, 15.53s/it]
Task 4, Epoch 20/20 => Loss 0.201, Train_accy 87.28: 100%|██████████| 20/20 [05:21<00:00, 15.25s/it]
Task 4, Epoch 20/20 => Loss 0.201, Train_accy 87.28: 100%|██████████| 20/20 [05:21<00:00, 16.06s/it]
2024-09-04 16:53:12,240 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.201, Train_accy 87.28
2024-09-04 16:53:19,319 [trainer.py] => No NME accuracy.
2024-09-04 16:53:19,319 [trainer.py] => CNN: {'total': 64.89, '00-39': 38.77, '40-79': 51.83, '80-119': 64.59, '120-159': 80.21, '160-199': 88.01, 'old': 59.18, 'new': 88.01}
2024-09-04 16:53:19,319 [trainer.py] => CNN top1 curve: [94.71, 84.44, 78.25, 67.95, 64.89]
2024-09-04 16:53:19,319 [trainer.py] => CNN top5 curve: [99.56, 98.15, 97.32, 94.18, 92.79]

Average Accuracy (CNN): 78.05
2024-09-04 16:53:19,319 [trainer.py] => Average Accuracy (CNN): 78.05 

Accuracy Matrix (CNN):
[[94.71 79.52 67.62 45.81 38.77]
 [ 0.   89.25 74.19 61.94 51.83]
 [ 0.    0.   91.75 69.82 64.59]
 [ 0.    0.    0.   93.05 80.21]
 [ 0.    0.    0.    0.   88.01]]
2024-09-04 16:53:19,320 [trainer.py] => Forgetting (CNN): 33.339999999999996
2024-09-04 16:53:22,033 [trainer.py] => config: ./exps/finetune_cub_B0_Inc10.json
2024-09-04 16:53:22,051 [trainer.py] => prefix: reproduce
2024-09-04 16:53:22,051 [trainer.py] => dataset: cub
2024-09-04 16:53:22,051 [trainer.py] => memory_size: 0
2024-09-04 16:53:22,051 [trainer.py] => memory_per_class: 0
2024-09-04 16:53:22,051 [trainer.py] => fixed_memory: False
2024-09-04 16:53:22,051 [trainer.py] => shuffle: True
2024-09-04 16:53:22,051 [trainer.py] => init_cls: 20
2024-09-04 16:53:22,051 [trainer.py] => increment: 20
2024-09-04 16:53:22,051 [trainer.py] => model_name: finetune
2024-09-04 16:53:22,051 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 16:53:22,051 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 16:53:22,051 [trainer.py] => seed: 1993
2024-09-04 16:53:22,051 [trainer.py] => init_epoch: 20
2024-09-04 16:53:22,051 [trainer.py] => init_lr: 0.001
2024-09-04 16:53:22,051 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 16:53:22,051 [trainer.py] => init_lr_decay: 0.1
2024-09-04 16:53:22,051 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 16:53:22,051 [trainer.py] => epochs: 20
2024-09-04 16:53:22,051 [trainer.py] => lrate: 0.001
2024-09-04 16:53:22,051 [trainer.py] => milestones: [40, 70]
2024-09-04 16:53:22,051 [trainer.py] => lrate_decay: 0.1
2024-09-04 16:53:22,051 [trainer.py] => batch_size: 48
2024-09-04 16:53:22,051 [trainer.py] => weight_decay: 0.0002
2024-09-04 16:53:22,093 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 16:53:23,886 [trainer.py] => All params: 85798656
2024-09-04 16:53:23,887 [trainer.py] => Trainable params: 85798656
2024-09-04 16:53:23,887 [finetune.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.738, Train_accy 49.58, Test_accy 92.31:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.738, Train_accy 49.58, Test_accy 92.31:   5%|▌         | 1/20 [00:08<02:46,  8.78s/it]
Task 0, Epoch 2/20 => Loss 0.514, Train_accy 85.31:   5%|▌         | 1/20 [00:16<02:46,  8.78s/it]                 
Task 0, Epoch 2/20 => Loss 0.514, Train_accy 85.31:  10%|█         | 2/20 [00:16<02:23,  7.95s/it]
Task 0, Epoch 3/20 => Loss 0.367, Train_accy 88.90:  10%|█         | 2/20 [00:23<02:23,  7.95s/it]
Task 0, Epoch 3/20 => Loss 0.367, Train_accy 88.90:  15%|█▌        | 3/20 [00:23<02:10,  7.69s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.80:  15%|█▌        | 3/20 [00:30<02:10,  7.69s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.80:  20%|██        | 4/20 [00:30<02:01,  7.57s/it]
Task 0, Epoch 5/20 => Loss 0.248, Train_accy 91.75:  20%|██        | 4/20 [00:38<02:01,  7.57s/it]
Task 0, Epoch 5/20 => Loss 0.248, Train_accy 91.75:  25%|██▌       | 5/20 [00:38<01:52,  7.51s/it]
Task 0, Epoch 6/20 => Loss 0.250, Train_accy 92.18, Test_accy 95.14:  25%|██▌       | 5/20 [00:46<01:52,  7.51s/it]
Task 0, Epoch 6/20 => Loss 0.250, Train_accy 92.18, Test_accy 95.14:  30%|███       | 6/20 [00:46<01:50,  7.87s/it]
Task 0, Epoch 7/20 => Loss 0.233, Train_accy 93.23:  30%|███       | 6/20 [00:54<01:50,  7.87s/it]                 
Task 0, Epoch 7/20 => Loss 0.233, Train_accy 93.23:  35%|███▌      | 7/20 [00:54<01:40,  7.72s/it]
Task 0, Epoch 8/20 => Loss 0.231, Train_accy 92.71:  35%|███▌      | 7/20 [01:01<01:40,  7.72s/it]
Task 0, Epoch 8/20 => Loss 0.231, Train_accy 92.71:  40%|████      | 8/20 [01:01<01:31,  7.62s/it]
Task 0, Epoch 9/20 => Loss 0.183, Train_accy 94.19:  40%|████      | 8/20 [01:09<01:31,  7.62s/it]
Task 0, Epoch 9/20 => Loss 0.183, Train_accy 94.19:  45%|████▌     | 9/20 [01:09<01:23,  7.55s/it]
Task 0, Epoch 10/20 => Loss 0.208, Train_accy 93.45:  45%|████▌     | 9/20 [01:16<01:23,  7.55s/it]
Task 0, Epoch 10/20 => Loss 0.208, Train_accy 93.45:  50%|█████     | 10/20 [01:16<01:15,  7.51s/it]
Task 0, Epoch 11/20 => Loss 0.228, Train_accy 93.02, Test_accy 97.17:  50%|█████     | 10/20 [01:25<01:15,  7.51s/it]
Task 0, Epoch 11/20 => Loss 0.228, Train_accy 93.02, Test_accy 97.17:  55%|█████▌    | 11/20 [01:25<01:10,  7.82s/it]
Task 0, Epoch 12/20 => Loss 0.219, Train_accy 94.08:  55%|█████▌    | 11/20 [01:32<01:10,  7.82s/it]                 
Task 0, Epoch 12/20 => Loss 0.219, Train_accy 94.08:  60%|██████    | 12/20 [01:32<01:01,  7.68s/it]
Task 0, Epoch 13/20 => Loss 0.151, Train_accy 95.35:  60%|██████    | 12/20 [01:39<01:01,  7.68s/it]
Task 0, Epoch 13/20 => Loss 0.151, Train_accy 95.35:  65%|██████▌   | 13/20 [01:39<00:53,  7.60s/it]
Task 0, Epoch 14/20 => Loss 0.137, Train_accy 95.56:  65%|██████▌   | 13/20 [01:47<00:53,  7.60s/it]
Task 0, Epoch 14/20 => Loss 0.137, Train_accy 95.56:  70%|███████   | 14/20 [01:47<00:45,  7.54s/it]
Task 0, Epoch 15/20 => Loss 0.223, Train_accy 93.23:  70%|███████   | 14/20 [01:54<00:45,  7.54s/it]
Task 0, Epoch 15/20 => Loss 0.223, Train_accy 93.23:  75%|███████▌  | 15/20 [01:54<00:37,  7.49s/it]
Task 0, Epoch 16/20 => Loss 0.218, Train_accy 93.02, Test_accy 95.95:  75%|███████▌  | 15/20 [02:03<00:37,  7.49s/it]
Task 0, Epoch 16/20 => Loss 0.218, Train_accy 93.02, Test_accy 95.95:  80%|████████  | 16/20 [02:03<00:31,  7.84s/it]
Task 0, Epoch 17/20 => Loss 0.163, Train_accy 95.14:  80%|████████  | 16/20 [02:10<00:31,  7.84s/it]                 
Task 0, Epoch 17/20 => Loss 0.163, Train_accy 95.14:  85%|████████▌ | 17/20 [02:10<00:23,  7.71s/it]
Task 0, Epoch 18/20 => Loss 0.132, Train_accy 95.77:  85%|████████▌ | 17/20 [02:18<00:23,  7.71s/it]
Task 0, Epoch 18/20 => Loss 0.132, Train_accy 95.77:  90%|█████████ | 18/20 [02:18<00:15,  7.62s/it]
Task 0, Epoch 19/20 => Loss 0.145, Train_accy 95.35:  90%|█████████ | 18/20 [02:25<00:15,  7.62s/it]
Task 0, Epoch 19/20 => Loss 0.145, Train_accy 95.35:  95%|█████████▌| 19/20 [02:25<00:07,  7.56s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45:  95%|█████████▌| 19/20 [02:33<00:07,  7.56s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45: 100%|██████████| 20/20 [02:33<00:00,  7.54s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45: 100%|██████████| 20/20 [02:33<00:00,  7.65s/it]
2024-09-04 16:55:57,381 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45
2024-09-04 16:55:58,626 [trainer.py] => No NME accuracy.
2024-09-04 16:55:58,626 [trainer.py] => CNN: {'total': 96.36, '00-19': 96.36, 'old': 0, 'new': 96.36}
2024-09-04 16:55:58,626 [trainer.py] => CNN top1 curve: [96.36]
2024-09-04 16:55:58,626 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 96.36
2024-09-04 16:55:58,626 [trainer.py] => Average Accuracy (CNN): 96.36 

2024-09-04 16:55:58,627 [trainer.py] => All params: 85814036
2024-09-04 16:55:58,628 [trainer.py] => Trainable params: 85814036
2024-09-04 16:55:58,630 [finetune.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.538, Train_accy 22.12, Test_accy 79.07:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.538, Train_accy 22.12, Test_accy 79.07:   5%|▌         | 1/20 [00:09<02:55,  9.21s/it]
Task 1, Epoch 2/20 => Loss 0.395, Train_accy 72.80:   5%|▌         | 1/20 [00:16<02:55,  9.21s/it]                 
Task 1, Epoch 2/20 => Loss 0.395, Train_accy 72.80:  10%|█         | 2/20 [00:16<02:26,  8.12s/it]
Task 1, Epoch 3/20 => Loss 0.296, Train_accy 82.33:  10%|█         | 2/20 [00:24<02:26,  8.12s/it]
Task 1, Epoch 3/20 => Loss 0.296, Train_accy 82.33:  15%|█▌        | 3/20 [00:24<02:12,  7.82s/it]
Task 1, Epoch 4/20 => Loss 0.219, Train_accy 87.09:  15%|█▌        | 3/20 [00:31<02:12,  7.82s/it]
Task 1, Epoch 4/20 => Loss 0.219, Train_accy 87.09:  20%|██        | 4/20 [00:31<02:02,  7.64s/it]
Task 1, Epoch 5/20 => Loss 0.258, Train_accy 84.34:  20%|██        | 4/20 [00:38<02:02,  7.64s/it]
Task 1, Epoch 5/20 => Loss 0.258, Train_accy 84.34:  25%|██▌       | 5/20 [00:38<01:53,  7.56s/it]
Task 1, Epoch 6/20 => Loss 0.233, Train_accy 86.03, Test_accy 91.63:  25%|██▌       | 5/20 [00:48<01:53,  7.56s/it]
Task 1, Epoch 6/20 => Loss 0.233, Train_accy 86.03, Test_accy 91.63:  30%|███       | 6/20 [00:48<01:53,  8.12s/it]
Task 1, Epoch 7/20 => Loss 0.179, Train_accy 89.42:  30%|███       | 6/20 [00:55<01:53,  8.12s/it]                 
Task 1, Epoch 7/20 => Loss 0.179, Train_accy 89.42:  35%|███▌      | 7/20 [00:55<01:42,  7.90s/it]
Task 1, Epoch 8/20 => Loss 0.154, Train_accy 89.95:  35%|███▌      | 7/20 [01:02<01:42,  7.90s/it]
Task 1, Epoch 8/20 => Loss 0.154, Train_accy 89.95:  40%|████      | 8/20 [01:02<01:33,  7.75s/it]
Task 1, Epoch 9/20 => Loss 0.161, Train_accy 91.01:  40%|████      | 8/20 [01:10<01:33,  7.75s/it]
Task 1, Epoch 9/20 => Loss 0.161, Train_accy 91.01:  45%|████▌     | 9/20 [01:10<01:24,  7.65s/it]
Task 1, Epoch 10/20 => Loss 0.152, Train_accy 90.16:  45%|████▌     | 9/20 [01:17<01:24,  7.65s/it]
Task 1, Epoch 10/20 => Loss 0.152, Train_accy 90.16:  50%|█████     | 10/20 [01:17<01:15,  7.59s/it]
Task 1, Epoch 11/20 => Loss 0.177, Train_accy 88.68, Test_accy 89.43:  50%|█████     | 10/20 [01:26<01:15,  7.59s/it]
Task 1, Epoch 11/20 => Loss 0.177, Train_accy 88.68, Test_accy 89.43:  55%|█████▌    | 11/20 [01:26<01:12,  8.07s/it]
Task 1, Epoch 12/20 => Loss 0.137, Train_accy 91.22:  55%|█████▌    | 11/20 [01:34<01:12,  8.07s/it]                 
Task 1, Epoch 12/20 => Loss 0.137, Train_accy 91.22:  60%|██████    | 12/20 [01:34<01:02,  7.87s/it]
Task 1, Epoch 13/20 => Loss 0.174, Train_accy 90.79:  60%|██████    | 12/20 [01:41<01:02,  7.87s/it]
Task 1, Epoch 13/20 => Loss 0.174, Train_accy 90.79:  65%|██████▌   | 13/20 [01:41<00:54,  7.72s/it]
Task 1, Epoch 14/20 => Loss 0.168, Train_accy 88.89:  65%|██████▌   | 13/20 [01:49<00:54,  7.72s/it]
Task 1, Epoch 14/20 => Loss 0.168, Train_accy 88.89:  70%|███████   | 14/20 [01:49<00:45,  7.62s/it]
Task 1, Epoch 15/20 => Loss 0.136, Train_accy 91.53:  70%|███████   | 14/20 [01:56<00:45,  7.62s/it]
Task 1, Epoch 15/20 => Loss 0.136, Train_accy 91.53:  75%|███████▌  | 15/20 [01:56<00:37,  7.55s/it]
Task 1, Epoch 16/20 => Loss 0.177, Train_accy 92.70, Test_accy 91.85:  75%|███████▌  | 15/20 [02:05<00:37,  7.55s/it]
Task 1, Epoch 16/20 => Loss 0.177, Train_accy 92.70, Test_accy 91.85:  80%|████████  | 16/20 [02:05<00:32,  8.05s/it]
Task 1, Epoch 17/20 => Loss 0.138, Train_accy 93.44:  80%|████████  | 16/20 [02:13<00:32,  8.05s/it]                 
Task 1, Epoch 17/20 => Loss 0.138, Train_accy 93.44:  85%|████████▌ | 17/20 [02:13<00:23,  7.85s/it]
Task 1, Epoch 18/20 => Loss 0.167, Train_accy 91.75:  85%|████████▌ | 17/20 [02:20<00:23,  7.85s/it]
Task 1, Epoch 18/20 => Loss 0.167, Train_accy 91.75:  90%|█████████ | 18/20 [02:20<00:15,  7.71s/it]
Task 1, Epoch 19/20 => Loss 0.186, Train_accy 91.85:  90%|█████████ | 18/20 [02:27<00:15,  7.71s/it]
Task 1, Epoch 19/20 => Loss 0.186, Train_accy 91.85:  95%|█████████▌| 19/20 [02:27<00:07,  7.62s/it]
Task 1, Epoch 20/20 => Loss 0.127, Train_accy 93.23:  95%|█████████▌| 19/20 [02:35<00:07,  7.62s/it]
Task 1, Epoch 20/20 => Loss 0.127, Train_accy 93.23: 100%|██████████| 20/20 [02:35<00:00,  7.54s/it]
Task 1, Epoch 20/20 => Loss 0.127, Train_accy 93.23: 100%|██████████| 20/20 [02:35<00:00,  7.76s/it]
2024-09-04 16:58:33,890 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.127, Train_accy 93.23
2024-09-04 16:58:35,724 [trainer.py] => No NME accuracy.
2024-09-04 16:58:35,724 [trainer.py] => CNN: {'total': 93.17, '00-19': 92.31, '20-39': 94.2, 'old': 92.31, 'new': 94.2}
2024-09-04 16:58:35,724 [trainer.py] => CNN top1 curve: [96.36, 93.17]
2024-09-04 16:58:35,724 [trainer.py] => CNN top5 curve: [100.0, 99.34]

Average Accuracy (CNN): 94.76
2024-09-04 16:58:35,725 [trainer.py] => Average Accuracy (CNN): 94.76 

2024-09-04 16:58:35,726 [trainer.py] => All params: 85829416
2024-09-04 16:58:35,728 [trainer.py] => Trainable params: 85829416
2024-09-04 16:58:35,730 [finetune.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.717, Train_accy 21.53, Test_accy 82.89:   0%|          | 0/20 [00:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.717, Train_accy 21.53, Test_accy 82.89:   5%|▌         | 1/20 [00:09<03:04,  9.71s/it]
Task 2, Epoch 2/20 => Loss 0.408, Train_accy 76.56:   5%|▌         | 1/20 [00:17<03:04,  9.71s/it]                 
Task 2, Epoch 2/20 => Loss 0.408, Train_accy 76.56:  10%|█         | 2/20 [00:17<02:30,  8.34s/it]
Task 2, Epoch 3/20 => Loss 0.318, Train_accy 84.20:  10%|█         | 2/20 [00:24<02:30,  8.34s/it]
Task 2, Epoch 3/20 => Loss 0.318, Train_accy 84.20:  15%|█▌        | 3/20 [00:24<02:14,  7.90s/it]
Task 2, Epoch 4/20 => Loss 0.270, Train_accy 86.32:  15%|█▌        | 3/20 [00:31<02:14,  7.90s/it]
Task 2, Epoch 4/20 => Loss 0.270, Train_accy 86.32:  20%|██        | 4/20 [00:31<02:03,  7.69s/it]
Task 2, Epoch 5/20 => Loss 0.222, Train_accy 89.18:  20%|██        | 4/20 [00:39<02:03,  7.69s/it]
Task 2, Epoch 5/20 => Loss 0.222, Train_accy 89.18:  25%|██▌       | 5/20 [00:39<01:53,  7.59s/it]
Task 2, Epoch 6/20 => Loss 0.253, Train_accy 86.96, Test_accy 84.08:  25%|██▌       | 5/20 [00:48<01:53,  7.59s/it]
Task 2, Epoch 6/20 => Loss 0.253, Train_accy 86.96, Test_accy 84.08:  30%|███       | 6/20 [00:48<01:56,  8.32s/it]
Task 2, Epoch 7/20 => Loss 0.212, Train_accy 89.82:  30%|███       | 6/20 [00:56<01:56,  8.32s/it]                 
Task 2, Epoch 7/20 => Loss 0.212, Train_accy 89.82:  35%|███▌      | 7/20 [00:56<01:44,  8.02s/it]
Task 2, Epoch 8/20 => Loss 0.254, Train_accy 87.80:  35%|███▌      | 7/20 [01:03<01:44,  8.02s/it]
Task 2, Epoch 8/20 => Loss 0.254, Train_accy 87.80:  40%|████      | 8/20 [01:03<01:33,  7.82s/it]
Task 2, Epoch 9/20 => Loss 0.207, Train_accy 90.35:  40%|████      | 8/20 [01:11<01:33,  7.82s/it]
Task 2, Epoch 9/20 => Loss 0.207, Train_accy 90.35:  45%|████▌     | 9/20 [01:11<01:24,  7.68s/it]
Task 2, Epoch 10/20 => Loss 0.202, Train_accy 89.93:  45%|████▌     | 9/20 [01:18<01:24,  7.68s/it]
Task 2, Epoch 10/20 => Loss 0.202, Train_accy 89.93:  50%|█████     | 10/20 [01:18<01:15,  7.59s/it]
Task 2, Epoch 11/20 => Loss 0.188, Train_accy 90.14, Test_accy 81.55:  50%|█████     | 10/20 [01:28<01:15,  7.59s/it]
Task 2, Epoch 11/20 => Loss 0.188, Train_accy 90.14, Test_accy 81.55:  55%|█████▌    | 11/20 [01:28<01:14,  8.23s/it]
Task 2, Epoch 12/20 => Loss 0.184, Train_accy 91.20:  55%|█████▌    | 11/20 [01:35<01:14,  8.23s/it]                 
Task 2, Epoch 12/20 => Loss 0.184, Train_accy 91.20:  60%|██████    | 12/20 [01:35<01:03,  7.96s/it]
Task 2, Epoch 13/20 => Loss 0.216, Train_accy 90.03:  60%|██████    | 12/20 [01:42<01:03,  7.96s/it]
Task 2, Epoch 13/20 => Loss 0.216, Train_accy 90.03:  65%|██████▌   | 13/20 [01:42<00:54,  7.79s/it]
Task 2, Epoch 14/20 => Loss 0.190, Train_accy 92.47:  65%|██████▌   | 13/20 [01:50<00:54,  7.79s/it]
Task 2, Epoch 14/20 => Loss 0.190, Train_accy 92.47:  70%|███████   | 14/20 [01:50<00:46,  7.67s/it]
Task 2, Epoch 15/20 => Loss 0.172, Train_accy 92.58:  70%|███████   | 14/20 [01:57<00:46,  7.67s/it]
Task 2, Epoch 15/20 => Loss 0.172, Train_accy 92.58:  75%|███████▌  | 15/20 [01:57<00:37,  7.58s/it]
Task 2, Epoch 16/20 => Loss 0.198, Train_accy 91.09, Test_accy 84.52:  75%|███████▌  | 15/20 [02:07<00:37,  7.58s/it]
Task 2, Epoch 16/20 => Loss 0.198, Train_accy 91.09, Test_accy 84.52:  80%|████████  | 16/20 [02:07<00:32,  8.22s/it]
Task 2, Epoch 17/20 => Loss 0.207, Train_accy 90.14:  80%|████████  | 16/20 [02:14<00:32,  8.22s/it]                 
Task 2, Epoch 17/20 => Loss 0.207, Train_accy 90.14:  85%|████████▌ | 17/20 [02:14<00:23,  7.96s/it]
Task 2, Epoch 18/20 => Loss 0.201, Train_accy 90.56:  85%|████████▌ | 17/20 [02:22<00:23,  7.96s/it]
Task 2, Epoch 18/20 => Loss 0.201, Train_accy 90.56:  90%|█████████ | 18/20 [02:22<00:15,  7.80s/it]
Task 2, Epoch 19/20 => Loss 0.141, Train_accy 92.47:  90%|█████████ | 18/20 [02:29<00:15,  7.80s/it]
Task 2, Epoch 19/20 => Loss 0.141, Train_accy 92.47:  95%|█████████▌| 19/20 [02:29<00:07,  7.67s/it]
Task 2, Epoch 20/20 => Loss 0.151, Train_accy 92.90:  95%|█████████▌| 19/20 [02:37<00:07,  7.67s/it]
Task 2, Epoch 20/20 => Loss 0.151, Train_accy 92.90: 100%|██████████| 20/20 [02:37<00:00,  7.61s/it]
Task 2, Epoch 20/20 => Loss 0.151, Train_accy 92.90: 100%|██████████| 20/20 [02:37<00:00,  7.85s/it]
2024-09-04 17:01:12,786 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.151, Train_accy 92.90
2024-09-04 17:01:15,127 [trainer.py] => No NME accuracy.
2024-09-04 17:01:15,127 [trainer.py] => CNN: {'total': 81.55, '00-19': 74.49, '20-39': 76.81, '40-59': 94.04, 'old': 75.55, 'new': 94.04}
2024-09-04 17:01:15,127 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55]
2024-09-04 17:01:15,127 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26]

Average Accuracy (CNN): 90.36
2024-09-04 17:01:15,127 [trainer.py] => Average Accuracy (CNN): 90.36 

2024-09-04 17:01:15,129 [trainer.py] => All params: 85844796
2024-09-04 17:01:15,130 [trainer.py] => Trainable params: 85844796
2024-09-04 17:01:15,132 [finetune.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.423, Train_accy 15.22, Test_accy 75.95:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.423, Train_accy 15.22, Test_accy 75.95:   5%|▌         | 1/20 [00:10<03:18, 10.43s/it]
Task 3, Epoch 2/20 => Loss 0.319, Train_accy 68.71:   5%|▌         | 1/20 [00:17<03:18, 10.43s/it]                 
Task 3, Epoch 2/20 => Loss 0.319, Train_accy 68.71:  10%|█         | 2/20 [00:17<02:36,  8.70s/it]
Task 3, Epoch 3/20 => Loss 0.280, Train_accy 81.29:  10%|█         | 2/20 [00:25<02:36,  8.70s/it]
Task 3, Epoch 3/20 => Loss 0.280, Train_accy 81.29:  15%|█▌        | 3/20 [00:25<02:18,  8.14s/it]
Task 3, Epoch 4/20 => Loss 0.220, Train_accy 82.88:  15%|█▌        | 3/20 [00:32<02:18,  8.14s/it]
Task 3, Epoch 4/20 => Loss 0.220, Train_accy 82.88:  20%|██        | 4/20 [00:32<02:05,  7.86s/it]
Task 3, Epoch 5/20 => Loss 0.223, Train_accy 82.77:  20%|██        | 4/20 [00:40<02:05,  7.86s/it]
Task 3, Epoch 5/20 => Loss 0.223, Train_accy 82.77:  25%|██▌       | 5/20 [00:40<01:55,  7.68s/it]
Task 3, Epoch 6/20 => Loss 0.177, Train_accy 88.79, Test_accy 81.18:  25%|██▌       | 5/20 [00:50<01:55,  7.68s/it]
Task 3, Epoch 6/20 => Loss 0.177, Train_accy 88.79, Test_accy 81.18:  30%|███       | 6/20 [00:50<02:00,  8.62s/it]
Task 3, Epoch 7/20 => Loss 0.221, Train_accy 86.68:  30%|███       | 6/20 [00:58<02:00,  8.62s/it]                 
Task 3, Epoch 7/20 => Loss 0.221, Train_accy 86.68:  35%|███▌      | 7/20 [00:58<01:46,  8.22s/it]
Task 3, Epoch 8/20 => Loss 0.170, Train_accy 88.48:  35%|███▌      | 7/20 [01:05<01:46,  8.22s/it]
Task 3, Epoch 8/20 => Loss 0.170, Train_accy 88.48:  40%|████      | 8/20 [01:05<01:35,  7.97s/it]
Task 3, Epoch 9/20 => Loss 0.257, Train_accy 86.15:  40%|████      | 8/20 [01:12<01:35,  7.97s/it]
Task 3, Epoch 9/20 => Loss 0.257, Train_accy 86.15:  45%|████▌     | 9/20 [01:12<01:25,  7.79s/it]
Task 3, Epoch 10/20 => Loss 0.192, Train_accy 88.05:  45%|████▌     | 9/20 [01:20<01:25,  7.79s/it]
Task 3, Epoch 10/20 => Loss 0.192, Train_accy 88.05:  50%|█████     | 10/20 [01:20<01:16,  7.67s/it]
Task 3, Epoch 11/20 => Loss 0.188, Train_accy 89.22, Test_accy 79.87:  50%|█████     | 10/20 [01:30<01:16,  7.67s/it]
Task 3, Epoch 11/20 => Loss 0.188, Train_accy 89.22, Test_accy 79.87:  55%|█████▌    | 11/20 [01:30<01:16,  8.53s/it]
Task 3, Epoch 12/20 => Loss 0.142, Train_accy 92.81:  55%|█████▌    | 11/20 [01:38<01:16,  8.53s/it]                 
Task 3, Epoch 12/20 => Loss 0.142, Train_accy 92.81:  60%|██████    | 12/20 [01:38<01:05,  8.19s/it]
Task 3, Epoch 13/20 => Loss 0.126, Train_accy 90.38:  60%|██████    | 12/20 [01:45<01:05,  8.19s/it]
Task 3, Epoch 13/20 => Loss 0.126, Train_accy 90.38:  65%|██████▌   | 13/20 [01:45<00:56,  8.01s/it]
Task 3, Epoch 14/20 => Loss 0.183, Train_accy 89.96:  65%|██████▌   | 13/20 [01:53<00:56,  8.01s/it]
Task 3, Epoch 14/20 => Loss 0.183, Train_accy 89.96:  70%|███████   | 14/20 [01:53<00:46,  7.82s/it]
Task 3, Epoch 15/20 => Loss 0.173, Train_accy 88.69:  70%|███████   | 14/20 [02:00<00:46,  7.82s/it]
Task 3, Epoch 15/20 => Loss 0.173, Train_accy 88.69:  75%|███████▌  | 15/20 [02:00<00:38,  7.71s/it]
Task 3, Epoch 16/20 => Loss 0.169, Train_accy 91.44, Test_accy 78.78:  75%|███████▌  | 15/20 [02:11<00:38,  7.71s/it]
Task 3, Epoch 16/20 => Loss 0.169, Train_accy 91.44, Test_accy 78.78:  80%|████████  | 16/20 [02:11<00:34,  8.55s/it]
Task 3, Epoch 17/20 => Loss 0.167, Train_accy 90.91:  80%|████████  | 16/20 [02:18<00:34,  8.55s/it]                 
Task 3, Epoch 17/20 => Loss 0.167, Train_accy 90.91:  85%|████████▌ | 17/20 [02:18<00:24,  8.22s/it]
Task 3, Epoch 18/20 => Loss 0.155, Train_accy 91.01:  85%|████████▌ | 17/20 [02:26<00:24,  8.22s/it]
Task 3, Epoch 18/20 => Loss 0.155, Train_accy 91.01:  90%|█████████ | 18/20 [02:26<00:16,  8.01s/it]
Task 3, Epoch 19/20 => Loss 0.140, Train_accy 92.39:  90%|█████████ | 18/20 [02:33<00:16,  8.01s/it]
Task 3, Epoch 19/20 => Loss 0.140, Train_accy 92.39:  95%|█████████▌| 19/20 [02:33<00:07,  7.82s/it]
Task 3, Epoch 20/20 => Loss 0.157, Train_accy 91.33:  95%|█████████▌| 19/20 [02:40<00:07,  7.82s/it]
Task 3, Epoch 20/20 => Loss 0.157, Train_accy 91.33: 100%|██████████| 20/20 [02:40<00:00,  7.69s/it]
Task 3, Epoch 20/20 => Loss 0.157, Train_accy 91.33: 100%|██████████| 20/20 [02:40<00:00,  8.04s/it]
2024-09-04 17:03:55,982 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.157, Train_accy 91.33
2024-09-04 17:03:58,949 [trainer.py] => No NME accuracy.
2024-09-04 17:03:58,949 [trainer.py] => CNN: {'total': 78.13, '00-19': 63.16, '20-39': 71.01, '40-59': 83.49, '60-79': 94.33, 'old': 72.17, 'new': 94.33}
2024-09-04 17:03:58,949 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55, 78.13]
2024-09-04 17:03:58,949 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26, 97.71]

Average Accuracy (CNN): 87.3
2024-09-04 17:03:58,950 [trainer.py] => Average Accuracy (CNN): 87.3 

2024-09-04 17:03:58,951 [trainer.py] => All params: 85860176
2024-09-04 17:03:58,952 [trainer.py] => Trainable params: 85860176
2024-09-04 17:03:58,954 [finetune.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.558, Train_accy 17.07, Test_accy 69.44:   0%|          | 0/20 [00:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.558, Train_accy 17.07, Test_accy 69.44:   5%|▌         | 1/20 [00:10<03:28, 10.97s/it]
Task 4, Epoch 2/20 => Loss 0.379, Train_accy 64.66:   5%|▌         | 1/20 [00:18<03:28, 10.97s/it]                 
Task 4, Epoch 2/20 => Loss 0.379, Train_accy 64.66:  10%|█         | 2/20 [00:18<02:37,  8.72s/it]
Task 4, Epoch 3/20 => Loss 0.413, Train_accy 74.40:  10%|█         | 2/20 [00:25<02:37,  8.72s/it]
Task 4, Epoch 3/20 => Loss 0.413, Train_accy 74.40:  15%|█▌        | 3/20 [00:25<02:16,  8.02s/it]
Task 4, Epoch 4/20 => Loss 0.749, Train_accy 67.18:  15%|█▌        | 3/20 [00:32<02:16,  8.02s/it]
Task 4, Epoch 4/20 => Loss 0.749, Train_accy 67.18:  20%|██        | 4/20 [00:32<02:03,  7.70s/it]
Task 4, Epoch 5/20 => Loss 0.326, Train_accy 73.30:  20%|██        | 4/20 [00:39<02:03,  7.70s/it]
Task 4, Epoch 5/20 => Loss 0.326, Train_accy 73.30:  25%|██▌       | 5/20 [00:39<01:53,  7.54s/it]
Task 4, Epoch 6/20 => Loss 0.240, Train_accy 84.14, Test_accy 67.26:  25%|██▌       | 5/20 [00:50<01:53,  7.54s/it]
Task 4, Epoch 6/20 => Loss 0.240, Train_accy 84.14, Test_accy 67.26:  30%|███       | 6/20 [00:50<02:01,  8.71s/it]
Task 4, Epoch 7/20 => Loss 0.322, Train_accy 83.70:  30%|███       | 6/20 [00:57<02:01,  8.71s/it]                 
Task 4, Epoch 7/20 => Loss 0.322, Train_accy 83.70:  35%|███▌      | 7/20 [00:57<01:46,  8.22s/it]
Task 4, Epoch 8/20 => Loss 0.509, Train_accy 81.18:  35%|███▌      | 7/20 [01:05<01:46,  8.22s/it]
Task 4, Epoch 8/20 => Loss 0.509, Train_accy 81.18:  40%|████      | 8/20 [01:05<01:34,  7.90s/it]
Task 4, Epoch 9/20 => Loss 0.672, Train_accy 73.74:  40%|████      | 8/20 [01:12<01:34,  7.90s/it]
Task 4, Epoch 9/20 => Loss 0.672, Train_accy 73.74:  45%|████▌     | 9/20 [01:12<01:24,  7.70s/it]
Task 4, Epoch 10/20 => Loss 0.325, Train_accy 78.56:  45%|████▌     | 9/20 [01:19<01:24,  7.70s/it]
Task 4, Epoch 10/20 => Loss 0.325, Train_accy 78.56:  50%|█████     | 10/20 [01:19<01:15,  7.54s/it]
Task 4, Epoch 11/20 => Loss 0.201, Train_accy 86.76, Test_accy 64.06:  50%|█████     | 10/20 [01:30<01:15,  7.54s/it]
Task 4, Epoch 11/20 => Loss 0.201, Train_accy 86.76, Test_accy 64.06:  55%|█████▌    | 11/20 [01:30<01:17,  8.60s/it]
Task 4, Epoch 12/20 => Loss 0.201, Train_accy 87.75:  55%|█████▌    | 11/20 [01:37<01:17,  8.60s/it]                 
Task 4, Epoch 12/20 => Loss 0.201, Train_accy 87.75:  60%|██████    | 12/20 [01:37<01:05,  8.18s/it]
Task 4, Epoch 13/20 => Loss 0.210, Train_accy 90.04:  60%|██████    | 12/20 [01:45<01:05,  8.18s/it]
Task 4, Epoch 13/20 => Loss 0.210, Train_accy 90.04:  65%|██████▌   | 13/20 [01:45<00:55,  7.88s/it]
Task 4, Epoch 14/20 => Loss 0.234, Train_accy 88.18:  65%|██████▌   | 13/20 [01:52<00:55,  7.88s/it]
Task 4, Epoch 14/20 => Loss 0.234, Train_accy 88.18:  70%|███████   | 14/20 [01:52<00:46,  7.68s/it]
Task 4, Epoch 15/20 => Loss 0.167, Train_accy 89.28:  70%|███████   | 14/20 [01:59<00:46,  7.68s/it]
Task 4, Epoch 15/20 => Loss 0.167, Train_accy 89.28:  75%|███████▌  | 15/20 [01:59<00:37,  7.54s/it]
Task 4, Epoch 16/20 => Loss 0.219, Train_accy 87.42, Test_accy 65.99:  75%|███████▌  | 15/20 [02:10<00:37,  7.54s/it]
Task 4, Epoch 16/20 => Loss 0.219, Train_accy 87.42, Test_accy 65.99:  80%|████████  | 16/20 [02:10<00:34,  8.59s/it]
Task 4, Epoch 17/20 => Loss 0.252, Train_accy 88.18:  80%|████████  | 16/20 [02:17<00:34,  8.59s/it]                 
Task 4, Epoch 17/20 => Loss 0.252, Train_accy 88.18:  85%|████████▌ | 17/20 [02:17<00:24,  8.19s/it]
Task 4, Epoch 18/20 => Loss 0.148, Train_accy 90.92:  85%|████████▌ | 17/20 [02:24<00:24,  8.19s/it]
Task 4, Epoch 18/20 => Loss 0.148, Train_accy 90.92:  90%|█████████ | 18/20 [02:24<00:15,  7.89s/it]
Task 4, Epoch 19/20 => Loss 0.181, Train_accy 89.17:  90%|█████████ | 18/20 [02:32<00:15,  7.89s/it]
Task 4, Epoch 19/20 => Loss 0.181, Train_accy 89.17:  95%|█████████▌| 19/20 [02:32<00:07,  7.69s/it]
Task 4, Epoch 20/20 => Loss 0.279, Train_accy 89.39:  95%|█████████▌| 19/20 [02:39<00:07,  7.69s/it]
Task 4, Epoch 20/20 => Loss 0.279, Train_accy 89.39: 100%|██████████| 20/20 [02:39<00:00,  7.55s/it]
Task 4, Epoch 20/20 => Loss 0.279, Train_accy 89.39: 100%|██████████| 20/20 [02:39<00:00,  7.97s/it]
2024-09-04 17:06:38,334 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.279, Train_accy 89.39
2024-09-04 17:06:42,127 [trainer.py] => No NME accuracy.
2024-09-04 17:06:42,127 [trainer.py] => CNN: {'total': 65.99, '00-19': 31.58, '20-39': 53.14, '40-59': 69.72, '60-79': 78.54, '80-99': 92.94, 'old': 58.11, 'new': 92.94}
2024-09-04 17:06:42,127 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55, 78.13, 65.99]
2024-09-04 17:06:42,128 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26, 97.71, 95.96]

Average Accuracy (CNN): 83.04
2024-09-04 17:06:42,128 [trainer.py] => Average Accuracy (CNN): 83.04 

2024-09-04 17:06:42,129 [trainer.py] => All params: 85875556
2024-09-04 17:06:42,130 [trainer.py] => Trainable params: 85875556
2024-09-04 17:06:42,132 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.614, Train_accy 11.87, Test_accy 59.25:   0%|          | 0/20 [00:11<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.614, Train_accy 11.87, Test_accy 59.25:   5%|▌         | 1/20 [00:11<03:45, 11.85s/it]
Task 5, Epoch 2/20 => Loss 0.323, Train_accy 62.39:   5%|▌         | 1/20 [00:19<03:45, 11.85s/it]                 
Task 5, Epoch 2/20 => Loss 0.323, Train_accy 62.39:  10%|█         | 2/20 [00:19<02:46,  9.25s/it]
Task 5, Epoch 3/20 => Loss 0.172, Train_accy 78.68:  10%|█         | 2/20 [00:26<02:46,  9.25s/it]
Task 5, Epoch 3/20 => Loss 0.172, Train_accy 78.68:  15%|█▌        | 3/20 [00:26<02:23,  8.46s/it]
Task 5, Epoch 4/20 => Loss 0.175, Train_accy 81.09:  15%|█▌        | 3/20 [00:34<02:23,  8.46s/it]
Task 5, Epoch 4/20 => Loss 0.175, Train_accy 81.09:  20%|██        | 4/20 [00:34<02:09,  8.08s/it]
Task 5, Epoch 5/20 => Loss 0.193, Train_accy 82.04:  20%|██        | 4/20 [00:41<02:09,  8.08s/it]
Task 5, Epoch 5/20 => Loss 0.193, Train_accy 82.04:  25%|██▌       | 5/20 [00:41<01:58,  7.87s/it]
Task 5, Epoch 6/20 => Loss 0.184, Train_accy 84.56, Test_accy 61.94:  25%|██▌       | 5/20 [00:53<01:58,  7.87s/it]
Task 5, Epoch 6/20 => Loss 0.184, Train_accy 84.56, Test_accy 61.94:  30%|███       | 6/20 [00:53<02:09,  9.26s/it]
Task 5, Epoch 7/20 => Loss 0.195, Train_accy 83.40:  30%|███       | 6/20 [01:01<02:09,  9.26s/it]                 
Task 5, Epoch 7/20 => Loss 0.195, Train_accy 83.40:  35%|███▌      | 7/20 [01:01<01:52,  8.68s/it]
Task 5, Epoch 8/20 => Loss 0.165, Train_accy 84.87:  35%|███▌      | 7/20 [01:08<01:52,  8.68s/it]
Task 5, Epoch 8/20 => Loss 0.165, Train_accy 84.87:  40%|████      | 8/20 [01:08<01:39,  8.30s/it]
Task 5, Epoch 9/20 => Loss 0.195, Train_accy 83.09:  40%|████      | 8/20 [01:16<01:39,  8.30s/it]
Task 5, Epoch 9/20 => Loss 0.195, Train_accy 83.09:  45%|████▌     | 9/20 [01:16<01:28,  8.03s/it]
Task 5, Epoch 10/20 => Loss 0.160, Train_accy 84.24:  45%|████▌     | 9/20 [01:23<01:28,  8.03s/it]
Task 5, Epoch 10/20 => Loss 0.160, Train_accy 84.24:  50%|█████     | 10/20 [01:23<01:18,  7.85s/it]
Task 5, Epoch 11/20 => Loss 0.172, Train_accy 85.19, Test_accy 62.92:  50%|█████     | 10/20 [01:35<01:18,  7.85s/it]
Task 5, Epoch 11/20 => Loss 0.172, Train_accy 85.19, Test_accy 62.92:  55%|█████▌    | 11/20 [01:35<01:21,  9.10s/it]
Task 5, Epoch 12/20 => Loss 0.126, Train_accy 86.13:  55%|█████▌    | 11/20 [01:42<01:21,  9.10s/it]                 
Task 5, Epoch 12/20 => Loss 0.126, Train_accy 86.13:  60%|██████    | 12/20 [01:42<01:08,  8.60s/it]
Task 5, Epoch 13/20 => Loss 0.150, Train_accy 86.34:  60%|██████    | 12/20 [01:50<01:08,  8.60s/it]
Task 5, Epoch 13/20 => Loss 0.150, Train_accy 86.34:  65%|██████▌   | 13/20 [01:50<00:57,  8.25s/it]
Task 5, Epoch 14/20 => Loss 0.173, Train_accy 87.08:  65%|██████▌   | 13/20 [01:57<00:57,  8.25s/it]
Task 5, Epoch 14/20 => Loss 0.173, Train_accy 87.08:  70%|███████   | 14/20 [01:57<00:48,  8.01s/it]
Task 5, Epoch 15/20 => Loss 0.169, Train_accy 85.19:  70%|███████   | 14/20 [02:05<00:48,  8.01s/it]
Task 5, Epoch 15/20 => Loss 0.169, Train_accy 85.19:  75%|███████▌  | 15/20 [02:05<00:39,  7.85s/it]
Task 5, Epoch 16/20 => Loss 0.141, Train_accy 86.66, Test_accy 62.57:  75%|███████▌  | 15/20 [02:17<00:39,  7.85s/it]
Task 5, Epoch 16/20 => Loss 0.141, Train_accy 86.66, Test_accy 62.57:  80%|████████  | 16/20 [02:17<00:36,  9.08s/it]
Task 5, Epoch 17/20 => Loss 0.169, Train_accy 87.29:  80%|████████  | 16/20 [02:24<00:36,  9.08s/it]                 
Task 5, Epoch 17/20 => Loss 0.169, Train_accy 87.29:  85%|████████▌ | 17/20 [02:24<00:25,  8.61s/it]
Task 5, Epoch 18/20 => Loss 0.141, Train_accy 89.08:  85%|████████▌ | 17/20 [02:32<00:25,  8.61s/it]
Task 5, Epoch 18/20 => Loss 0.141, Train_accy 89.08:  90%|█████████ | 18/20 [02:32<00:16,  8.27s/it]
Task 5, Epoch 19/20 => Loss 0.163, Train_accy 89.18:  90%|█████████ | 18/20 [02:39<00:16,  8.27s/it]
Task 5, Epoch 19/20 => Loss 0.163, Train_accy 89.18:  95%|█████████▌| 19/20 [02:39<00:08,  8.03s/it]
Task 5, Epoch 20/20 => Loss 0.125, Train_accy 89.50:  95%|█████████▌| 19/20 [02:47<00:08,  8.03s/it]
Task 5, Epoch 20/20 => Loss 0.125, Train_accy 89.50: 100%|██████████| 20/20 [02:47<00:00,  7.86s/it]
Task 5, Epoch 20/20 => Loss 0.125, Train_accy 89.50: 100%|██████████| 20/20 [02:47<00:00,  8.36s/it]
2024-09-04 17:09:29,393 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.125, Train_accy 89.50
2024-09-04 17:09:33,873 [trainer.py] => No NME accuracy.
2024-09-04 17:09:33,874 [trainer.py] => CNN: {'total': 61.58, '00-19': 23.89, '20-39': 42.51, '40-59': 56.88, '60-79': 66.4, '80-99': 85.13, '100-119': 91.23, 'old': 55.89, 'new': 91.23}
2024-09-04 17:09:33,874 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55, 78.13, 65.99, 61.58]
2024-09-04 17:09:33,874 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26, 97.71, 95.96, 93.86]

Average Accuracy (CNN): 79.46
2024-09-04 17:09:33,874 [trainer.py] => Average Accuracy (CNN): 79.46 

2024-09-04 17:09:33,876 [trainer.py] => All params: 85890936
2024-09-04 17:09:33,877 [trainer.py] => Trainable params: 85890936
2024-09-04 17:09:33,880 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.752, Train_accy 6.60, Test_accy 54.24:   0%|          | 0/20 [00:12<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.752, Train_accy 6.60, Test_accy 54.24:   5%|▌         | 1/20 [00:12<03:59, 12.62s/it]
Task 6, Epoch 2/20 => Loss 0.512, Train_accy 53.46:   5%|▌         | 1/20 [00:20<03:59, 12.62s/it]                
Task 6, Epoch 2/20 => Loss 0.512, Train_accy 53.46:  10%|█         | 2/20 [00:20<02:53,  9.63s/it]
Task 6, Epoch 3/20 => Loss 0.369, Train_accy 71.38:  10%|█         | 2/20 [00:27<02:53,  9.63s/it]
Task 6, Epoch 3/20 => Loss 0.369, Train_accy 71.38:  15%|█▌        | 3/20 [00:27<02:26,  8.64s/it]
Task 6, Epoch 4/20 => Loss 0.304, Train_accy 76.00:  15%|█▌        | 3/20 [00:35<02:26,  8.64s/it]
Task 6, Epoch 4/20 => Loss 0.304, Train_accy 76.00:  20%|██        | 4/20 [00:35<02:10,  8.18s/it]
Task 6, Epoch 5/20 => Loss 0.328, Train_accy 77.25:  20%|██        | 4/20 [00:42<02:10,  8.18s/it]
Task 6, Epoch 5/20 => Loss 0.328, Train_accy 77.25:  25%|██▌       | 5/20 [00:42<01:58,  7.92s/it]
Task 6, Epoch 6/20 => Loss 0.252, Train_accy 81.13, Test_accy 60.02:  25%|██▌       | 5/20 [00:55<01:58,  7.92s/it]
Task 6, Epoch 6/20 => Loss 0.252, Train_accy 81.13, Test_accy 60.02:  30%|███       | 6/20 [00:55<02:13,  9.51s/it]
Task 6, Epoch 7/20 => Loss 0.312, Train_accy 78.30:  30%|███       | 6/20 [01:02<02:13,  9.51s/it]                 
Task 6, Epoch 7/20 => Loss 0.312, Train_accy 78.30:  35%|███▌      | 7/20 [01:02<01:55,  8.89s/it]
Task 6, Epoch 8/20 => Loss 0.266, Train_accy 78.72:  35%|███▌      | 7/20 [01:10<01:55,  8.89s/it]
Task 6, Epoch 8/20 => Loss 0.266, Train_accy 78.72:  40%|████      | 8/20 [01:10<01:41,  8.44s/it]
Task 6, Epoch 9/20 => Loss 0.298, Train_accy 79.77:  40%|████      | 8/20 [01:17<01:41,  8.44s/it]
Task 6, Epoch 9/20 => Loss 0.298, Train_accy 79.77:  45%|████▌     | 9/20 [01:17<01:29,  8.15s/it]
Task 6, Epoch 10/20 => Loss 0.220, Train_accy 83.86:  45%|████▌     | 9/20 [01:25<01:29,  8.15s/it]
Task 6, Epoch 10/20 => Loss 0.220, Train_accy 83.86:  50%|█████     | 10/20 [01:25<01:19,  7.94s/it]
Task 6, Epoch 11/20 => Loss 0.215, Train_accy 85.64, Test_accy 63.19:  50%|█████     | 10/20 [01:37<01:19,  7.94s/it]
Task 6, Epoch 11/20 => Loss 0.215, Train_accy 85.64, Test_accy 63.19:  55%|█████▌    | 11/20 [01:37<01:24,  9.37s/it]
Task 6, Epoch 12/20 => Loss 0.163, Train_accy 87.53:  55%|█████▌    | 11/20 [01:45<01:24,  9.37s/it]                 
Task 6, Epoch 12/20 => Loss 0.163, Train_accy 87.53:  60%|██████    | 12/20 [01:45<01:10,  8.80s/it]
Task 6, Epoch 13/20 => Loss 0.173, Train_accy 85.01:  60%|██████    | 12/20 [01:52<01:10,  8.80s/it]
Task 6, Epoch 13/20 => Loss 0.173, Train_accy 85.01:  65%|██████▌   | 13/20 [01:52<00:58,  8.40s/it]
Task 6, Epoch 14/20 => Loss 0.232, Train_accy 84.59:  65%|██████▌   | 13/20 [02:00<00:58,  8.40s/it]
Task 6, Epoch 14/20 => Loss 0.232, Train_accy 84.59:  70%|███████   | 14/20 [02:00<00:48,  8.14s/it]
Task 6, Epoch 15/20 => Loss 0.253, Train_accy 83.86:  70%|███████   | 14/20 [02:07<00:48,  8.14s/it]
Task 6, Epoch 15/20 => Loss 0.253, Train_accy 83.86:  75%|███████▌  | 15/20 [02:07<00:39,  7.94s/it]
Task 6, Epoch 16/20 => Loss 0.190, Train_accy 85.64, Test_accy 63.19:  75%|███████▌  | 15/20 [02:20<00:39,  7.94s/it]
Task 6, Epoch 16/20 => Loss 0.190, Train_accy 85.64, Test_accy 63.19:  80%|████████  | 16/20 [02:20<00:37,  9.33s/it]
Task 6, Epoch 17/20 => Loss 0.202, Train_accy 84.07:  80%|████████  | 16/20 [02:27<00:37,  9.33s/it]                 
Task 6, Epoch 17/20 => Loss 0.202, Train_accy 84.07:  85%|████████▌ | 17/20 [02:27<00:26,  8.78s/it]
Task 6, Epoch 18/20 => Loss 0.174, Train_accy 86.16:  85%|████████▌ | 17/20 [02:35<00:26,  8.78s/it]
Task 6, Epoch 18/20 => Loss 0.174, Train_accy 86.16:  90%|█████████ | 18/20 [02:35<00:16,  8.37s/it]
Task 6, Epoch 19/20 => Loss 0.179, Train_accy 85.74:  90%|█████████ | 18/20 [02:42<00:16,  8.37s/it]
Task 6, Epoch 19/20 => Loss 0.179, Train_accy 85.74:  95%|█████████▌| 19/20 [02:42<00:08,  8.09s/it]
Task 6, Epoch 20/20 => Loss 0.186, Train_accy 86.48:  95%|█████████▌| 19/20 [02:50<00:08,  8.09s/it]
Task 6, Epoch 20/20 => Loss 0.186, Train_accy 86.48: 100%|██████████| 20/20 [02:50<00:00,  7.90s/it]
Task 6, Epoch 20/20 => Loss 0.186, Train_accy 86.48: 100%|██████████| 20/20 [02:50<00:00,  8.51s/it]
2024-09-04 17:12:24,099 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.186, Train_accy 86.48
2024-09-04 17:12:29,169 [trainer.py] => No NME accuracy.
2024-09-04 17:12:29,169 [trainer.py] => CNN: {'total': 62.77, '00-19': 25.91, '20-39': 41.55, '40-59': 57.8, '60-79': 57.49, '80-99': 81.78, '100-119': 83.77, '120-139': 89.33, 'old': 58.55, 'new': 89.33}
2024-09-04 17:12:29,170 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55, 78.13, 65.99, 61.58, 62.77]
2024-09-04 17:12:29,170 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26, 97.71, 95.96, 93.86, 91.47]

Average Accuracy (CNN): 77.08
2024-09-04 17:12:29,170 [trainer.py] => Average Accuracy (CNN): 77.08 

2024-09-04 17:12:29,172 [trainer.py] => All params: 85906316
2024-09-04 17:12:29,173 [trainer.py] => Trainable params: 85906316
2024-09-04 17:12:29,178 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.566, Train_accy 6.09, Test_accy 53.94:   0%|          | 0/20 [00:13<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.566, Train_accy 6.09, Test_accy 53.94:   5%|▌         | 1/20 [00:13<04:09, 13.11s/it]
Task 7, Epoch 2/20 => Loss 0.449, Train_accy 47.50:   5%|▌         | 1/20 [00:20<04:09, 13.11s/it]                
Task 7, Epoch 2/20 => Loss 0.449, Train_accy 47.50:  10%|█         | 2/20 [00:20<02:53,  9.66s/it]
Task 7, Epoch 3/20 => Loss 0.334, Train_accy 61.74:  10%|█         | 2/20 [00:27<02:53,  9.66s/it]
Task 7, Epoch 3/20 => Loss 0.334, Train_accy 61.74:  15%|█▌        | 3/20 [00:27<02:25,  8.55s/it]
Task 7, Epoch 4/20 => Loss 0.290, Train_accy 66.52:  15%|█▌        | 3/20 [00:34<02:25,  8.55s/it]
Task 7, Epoch 4/20 => Loss 0.290, Train_accy 66.52:  20%|██        | 4/20 [00:34<02:08,  8.03s/it]
Task 7, Epoch 5/20 => Loss 0.225, Train_accy 70.33:  20%|██        | 4/20 [00:42<02:08,  8.03s/it]
Task 7, Epoch 5/20 => Loss 0.225, Train_accy 70.33:  25%|██▌       | 5/20 [00:42<01:56,  7.76s/it]
Task 7, Epoch 6/20 => Loss 0.219, Train_accy 75.54, Test_accy 60.07:  25%|██▌       | 5/20 [00:55<01:56,  7.76s/it]
Task 7, Epoch 6/20 => Loss 0.219, Train_accy 75.54, Test_accy 60.07:  30%|███       | 6/20 [00:55<02:13,  9.55s/it]
Task 7, Epoch 7/20 => Loss 0.230, Train_accy 74.89:  30%|███       | 6/20 [01:02<02:13,  9.55s/it]                 
Task 7, Epoch 7/20 => Loss 0.230, Train_accy 74.89:  35%|███▌      | 7/20 [01:02<01:54,  8.79s/it]
Task 7, Epoch 8/20 => Loss 0.195, Train_accy 77.61:  35%|███▌      | 7/20 [01:09<01:54,  8.79s/it]
Task 7, Epoch 8/20 => Loss 0.195, Train_accy 77.61:  40%|████      | 8/20 [01:09<01:39,  8.29s/it]
Task 7, Epoch 9/20 => Loss 0.216, Train_accy 77.93:  40%|████      | 8/20 [01:16<01:39,  8.29s/it]
Task 7, Epoch 9/20 => Loss 0.216, Train_accy 77.93:  45%|████▌     | 9/20 [01:16<01:27,  7.95s/it]
Task 7, Epoch 10/20 => Loss 0.237, Train_accy 81.30:  45%|████▌     | 9/20 [01:24<01:27,  7.95s/it]
Task 7, Epoch 10/20 => Loss 0.237, Train_accy 81.30:  50%|█████     | 10/20 [01:24<01:17,  7.73s/it]
Task 7, Epoch 11/20 => Loss 0.278, Train_accy 77.61, Test_accy 60.18:  50%|█████     | 10/20 [01:37<01:17,  7.73s/it]
Task 7, Epoch 11/20 => Loss 0.278, Train_accy 77.61, Test_accy 60.18:  55%|█████▌    | 11/20 [01:37<01:24,  9.35s/it]
Task 7, Epoch 12/20 => Loss 0.198, Train_accy 78.15:  55%|█████▌    | 11/20 [01:44<01:24,  9.35s/it]                 
Task 7, Epoch 12/20 => Loss 0.198, Train_accy 78.15:  60%|██████    | 12/20 [01:44<01:09,  8.71s/it]
Task 7, Epoch 13/20 => Loss 0.249, Train_accy 80.33:  60%|██████    | 12/20 [01:51<01:09,  8.71s/it]
Task 7, Epoch 13/20 => Loss 0.249, Train_accy 80.33:  65%|██████▌   | 13/20 [01:51<00:57,  8.26s/it]
Task 7, Epoch 14/20 => Loss 0.205, Train_accy 81.20:  65%|██████▌   | 13/20 [01:58<00:57,  8.26s/it]
Task 7, Epoch 14/20 => Loss 0.205, Train_accy 81.20:  70%|███████   | 14/20 [01:58<00:47,  7.97s/it]
Task 7, Epoch 15/20 => Loss 0.189, Train_accy 82.72:  70%|███████   | 14/20 [02:06<00:47,  7.97s/it]
Task 7, Epoch 15/20 => Loss 0.189, Train_accy 82.72:  75%|███████▌  | 15/20 [02:06<00:38,  7.74s/it]
Task 7, Epoch 16/20 => Loss 0.209, Train_accy 81.85, Test_accy 60.39:  75%|███████▌  | 15/20 [02:19<00:38,  7.74s/it]
Task 7, Epoch 16/20 => Loss 0.209, Train_accy 81.85, Test_accy 60.39:  80%|████████  | 16/20 [02:19<00:37,  9.33s/it]
Task 7, Epoch 17/20 => Loss 0.259, Train_accy 77.28:  80%|████████  | 16/20 [02:26<00:37,  9.33s/it]                 
Task 7, Epoch 17/20 => Loss 0.259, Train_accy 77.28:  85%|████████▌ | 17/20 [02:26<00:26,  8.70s/it]
Task 7, Epoch 18/20 => Loss 0.182, Train_accy 79.46:  85%|████████▌ | 17/20 [02:33<00:26,  8.70s/it]
Task 7, Epoch 18/20 => Loss 0.182, Train_accy 79.46:  90%|█████████ | 18/20 [02:33<00:16,  8.27s/it]
Task 7, Epoch 19/20 => Loss 0.176, Train_accy 81.30:  90%|█████████ | 18/20 [02:40<00:16,  8.27s/it]
Task 7, Epoch 19/20 => Loss 0.176, Train_accy 81.30:  95%|█████████▌| 19/20 [02:40<00:07,  7.95s/it]
Task 7, Epoch 20/20 => Loss 0.142, Train_accy 83.48:  95%|█████████▌| 19/20 [02:47<00:07,  7.95s/it]
Task 7, Epoch 20/20 => Loss 0.142, Train_accy 83.48: 100%|██████████| 20/20 [02:47<00:00,  7.73s/it]
Task 7, Epoch 20/20 => Loss 0.142, Train_accy 83.48: 100%|██████████| 20/20 [02:47<00:00,  8.40s/it]
2024-09-04 17:15:17,155 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.142, Train_accy 83.48
2024-09-04 17:15:22,915 [trainer.py] => No NME accuracy.
2024-09-04 17:15:22,915 [trainer.py] => CNN: {'total': 59.97, '00-19': 22.27, '20-39': 41.06, '40-59': 55.05, '60-79': 53.04, '80-99': 78.44, '100-119': 69.3, '120-139': 73.78, '140-159': 83.2, 'old': 56.43, 'new': 83.2}
2024-09-04 17:15:22,915 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55, 78.13, 65.99, 61.58, 62.77, 59.97]
2024-09-04 17:15:22,915 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26, 97.71, 95.96, 93.86, 91.47, 92.65]

Average Accuracy (CNN): 74.94
2024-09-04 17:15:22,916 [trainer.py] => Average Accuracy (CNN): 74.94 

2024-09-04 17:15:22,917 [trainer.py] => All params: 85921696
2024-09-04 17:15:22,918 [trainer.py] => Trainable params: 85921696
2024-09-04 17:15:22,921 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.716, Train_accy 8.56, Test_accy 54.09:   0%|          | 0/20 [00:14<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.716, Train_accy 8.56, Test_accy 54.09:   5%|▌         | 1/20 [00:14<04:27, 14.09s/it]
Task 8, Epoch 2/20 => Loss 0.393, Train_accy 61.06:   5%|▌         | 1/20 [00:21<04:27, 14.09s/it]                
Task 8, Epoch 2/20 => Loss 0.393, Train_accy 61.06:  10%|█         | 2/20 [00:21<03:05, 10.31s/it]
Task 8, Epoch 3/20 => Loss 0.300, Train_accy 75.26:  10%|█         | 2/20 [00:29<03:05, 10.31s/it]
Task 8, Epoch 3/20 => Loss 0.300, Train_accy 75.26:  15%|█▌        | 3/20 [00:29<02:33,  9.05s/it]
Task 8, Epoch 4/20 => Loss 0.248, Train_accy 78.81:  15%|█▌        | 3/20 [00:36<02:33,  9.05s/it]
Task 8, Epoch 4/20 => Loss 0.248, Train_accy 78.81:  20%|██        | 4/20 [00:36<02:15,  8.45s/it]
Task 8, Epoch 5/20 => Loss 0.285, Train_accy 75.68:  20%|██        | 4/20 [00:44<02:15,  8.45s/it]
Task 8, Epoch 5/20 => Loss 0.285, Train_accy 75.68:  25%|██▌       | 5/20 [00:44<02:01,  8.13s/it]
Task 8, Epoch 6/20 => Loss 0.227, Train_accy 78.81, Test_accy 57.10:  25%|██▌       | 5/20 [00:58<02:01,  8.13s/it]
Task 8, Epoch 6/20 => Loss 0.227, Train_accy 78.81, Test_accy 57.10:  30%|███       | 6/20 [00:58<02:21, 10.11s/it]
Task 8, Epoch 7/20 => Loss 0.193, Train_accy 82.25:  30%|███       | 6/20 [01:05<02:21, 10.11s/it]                 
Task 8, Epoch 7/20 => Loss 0.193, Train_accy 82.25:  35%|███▌      | 7/20 [01:05<02:00,  9.25s/it]
Task 8, Epoch 8/20 => Loss 0.203, Train_accy 84.86:  35%|███▌      | 7/20 [01:13<02:00,  9.25s/it]
Task 8, Epoch 8/20 => Loss 0.203, Train_accy 84.86:  40%|████      | 8/20 [01:13<01:44,  8.69s/it]
Task 8, Epoch 9/20 => Loss 0.237, Train_accy 84.03:  40%|████      | 8/20 [01:20<01:44,  8.69s/it]
Task 8, Epoch 9/20 => Loss 0.237, Train_accy 84.03:  45%|████▌     | 9/20 [01:20<01:31,  8.35s/it]
Task 8, Epoch 10/20 => Loss 0.180, Train_accy 84.76:  45%|████▌     | 9/20 [01:28<01:31,  8.35s/it]
Task 8, Epoch 10/20 => Loss 0.180, Train_accy 84.76:  50%|█████     | 10/20 [01:28<01:20,  8.10s/it]
Task 8, Epoch 11/20 => Loss 0.240, Train_accy 83.30, Test_accy 57.14:  50%|█████     | 10/20 [01:42<01:20,  8.10s/it]
Task 8, Epoch 11/20 => Loss 0.240, Train_accy 83.30, Test_accy 57.14:  55%|█████▌    | 11/20 [01:42<01:29,  9.90s/it]
Task 8, Epoch 12/20 => Loss 0.152, Train_accy 86.33:  55%|█████▌    | 11/20 [01:49<01:29,  9.90s/it]                 
Task 8, Epoch 12/20 => Loss 0.152, Train_accy 86.33:  60%|██████    | 12/20 [01:49<01:13,  9.18s/it]
Task 8, Epoch 13/20 => Loss 0.187, Train_accy 86.01:  60%|██████    | 12/20 [01:57<01:13,  9.18s/it]
Task 8, Epoch 13/20 => Loss 0.187, Train_accy 86.01:  65%|██████▌   | 13/20 [01:57<01:00,  8.68s/it]
Task 8, Epoch 14/20 => Loss 0.187, Train_accy 84.34:  65%|██████▌   | 13/20 [02:05<01:00,  8.68s/it]
Task 8, Epoch 14/20 => Loss 0.187, Train_accy 84.34:  70%|███████   | 14/20 [02:05<00:50,  8.34s/it]
Task 8, Epoch 15/20 => Loss 0.193, Train_accy 84.45:  70%|███████   | 14/20 [02:12<00:50,  8.34s/it]
Task 8, Epoch 15/20 => Loss 0.193, Train_accy 84.45:  75%|███████▌  | 15/20 [02:12<00:40,  8.09s/it]
Task 8, Epoch 16/20 => Loss 0.181, Train_accy 86.53, Test_accy 57.52:  75%|███████▌  | 15/20 [02:26<00:40,  8.09s/it]
Task 8, Epoch 16/20 => Loss 0.181, Train_accy 86.53, Test_accy 57.52:  80%|████████  | 16/20 [02:26<00:39,  9.85s/it]
Task 8, Epoch 17/20 => Loss 0.179, Train_accy 86.74:  80%|████████  | 16/20 [02:34<00:39,  9.85s/it]                 
Task 8, Epoch 17/20 => Loss 0.179, Train_accy 86.74:  85%|████████▌ | 17/20 [02:34<00:27,  9.15s/it]
Task 8, Epoch 18/20 => Loss 0.233, Train_accy 83.51:  85%|████████▌ | 17/20 [02:41<00:27,  9.15s/it]
Task 8, Epoch 18/20 => Loss 0.233, Train_accy 83.51:  90%|█████████ | 18/20 [02:41<00:17,  8.67s/it]
Task 8, Epoch 19/20 => Loss 0.162, Train_accy 87.68:  90%|█████████ | 18/20 [02:49<00:17,  8.67s/it]
Task 8, Epoch 19/20 => Loss 0.162, Train_accy 87.68:  95%|█████████▌| 19/20 [02:49<00:08,  8.34s/it]
Task 8, Epoch 20/20 => Loss 0.144, Train_accy 88.41:  95%|█████████▌| 19/20 [02:56<00:08,  8.34s/it]
Task 8, Epoch 20/20 => Loss 0.144, Train_accy 88.41: 100%|██████████| 20/20 [02:56<00:00,  8.11s/it]
Task 8, Epoch 20/20 => Loss 0.144, Train_accy 88.41: 100%|██████████| 20/20 [02:56<00:00,  8.84s/it]
2024-09-04 17:18:19,660 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.144, Train_accy 88.41
2024-09-04 17:18:26,139 [trainer.py] => No NME accuracy.
2024-09-04 17:18:26,139 [trainer.py] => CNN: {'total': 57.47, '00-19': 18.22, '20-39': 37.2, '40-59': 46.79, '60-79': 52.23, '80-99': 68.4, '100-119': 62.72, '120-139': 61.78, '140-159': 72.0, '160-179': 94.51, 'old': 52.83, 'new': 94.51}
2024-09-04 17:18:26,139 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55, 78.13, 65.99, 61.58, 62.77, 59.97, 57.47]
2024-09-04 17:18:26,139 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26, 97.71, 95.96, 93.86, 91.47, 92.65, 89.29]

Average Accuracy (CNN): 73.0
2024-09-04 17:18:26,139 [trainer.py] => Average Accuracy (CNN): 73.0 

2024-09-04 17:18:26,140 [trainer.py] => All params: 85937076
2024-09-04 17:18:26,140 [trainer.py] => Trainable params: 85937076
2024-09-04 17:18:26,143 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.456, Train_accy 9.35, Test_accy 49.58:   0%|          | 0/20 [00:14<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.456, Train_accy 9.35, Test_accy 49.58:   5%|▌         | 1/20 [00:14<04:40, 14.74s/it]
Task 9, Epoch 2/20 => Loss 0.360, Train_accy 62.50:   5%|▌         | 1/20 [00:22<04:40, 14.74s/it]                
Task 9, Epoch 2/20 => Loss 0.360, Train_accy 62.50:  10%|█         | 2/20 [00:22<03:08, 10.48s/it]
Task 9, Epoch 3/20 => Loss 0.319, Train_accy 72.79:  10%|█         | 2/20 [00:29<03:08, 10.48s/it]
Task 9, Epoch 3/20 => Loss 0.319, Train_accy 72.79:  15%|█▌        | 3/20 [00:29<02:34,  9.10s/it]
Task 9, Epoch 4/20 => Loss 0.247, Train_accy 79.52:  15%|█▌        | 3/20 [00:37<02:34,  9.10s/it]
Task 9, Epoch 4/20 => Loss 0.247, Train_accy 79.52:  20%|██        | 4/20 [00:37<02:15,  8.47s/it]
Task 9, Epoch 5/20 => Loss 0.249, Train_accy 79.52:  20%|██        | 4/20 [00:44<02:15,  8.47s/it]
Task 9, Epoch 5/20 => Loss 0.249, Train_accy 79.52:  25%|██▌       | 5/20 [00:44<02:01,  8.11s/it]
Task 9, Epoch 6/20 => Loss 0.226, Train_accy 82.46, Test_accy 54.83:  25%|██▌       | 5/20 [00:59<02:01,  8.11s/it]
Task 9, Epoch 6/20 => Loss 0.226, Train_accy 82.46, Test_accy 54.83:  30%|███       | 6/20 [00:59<02:25, 10.37s/it]
Task 9, Epoch 7/20 => Loss 0.192, Train_accy 82.88:  30%|███       | 6/20 [01:06<02:25, 10.37s/it]                 
Task 9, Epoch 7/20 => Loss 0.192, Train_accy 82.88:  35%|███▌      | 7/20 [01:06<02:02,  9.44s/it]
Task 9, Epoch 8/20 => Loss 0.197, Train_accy 82.14:  35%|███▌      | 7/20 [01:14<02:02,  9.44s/it]
Task 9, Epoch 8/20 => Loss 0.197, Train_accy 82.14:  40%|████      | 8/20 [01:14<01:45,  8.83s/it]
Task 9, Epoch 9/20 => Loss 0.212, Train_accy 84.24:  40%|████      | 8/20 [01:22<01:45,  8.83s/it]
Task 9, Epoch 9/20 => Loss 0.212, Train_accy 84.24:  45%|████▌     | 9/20 [01:22<01:32,  8.43s/it]
Task 9, Epoch 10/20 => Loss 0.154, Train_accy 85.08:  45%|████▌     | 9/20 [01:29<01:32,  8.43s/it]
Task 9, Epoch 10/20 => Loss 0.154, Train_accy 85.08:  50%|█████     | 10/20 [01:29<01:21,  8.15s/it]
Task 9, Epoch 11/20 => Loss 0.178, Train_accy 85.19, Test_accy 56.06:  50%|█████     | 10/20 [01:44<01:21,  8.15s/it]
Task 9, Epoch 11/20 => Loss 0.178, Train_accy 85.19, Test_accy 56.06:  55%|█████▌    | 11/20 [01:44<01:31, 10.15s/it]
Task 9, Epoch 12/20 => Loss 0.203, Train_accy 85.92:  55%|█████▌    | 11/20 [01:51<01:31, 10.15s/it]                 
Task 9, Epoch 12/20 => Loss 0.203, Train_accy 85.92:  60%|██████    | 12/20 [01:51<01:14,  9.34s/it]
Task 9, Epoch 13/20 => Loss 0.149, Train_accy 86.97:  60%|██████    | 12/20 [01:59<01:14,  9.34s/it]
Task 9, Epoch 13/20 => Loss 0.149, Train_accy 86.97:  65%|██████▌   | 13/20 [01:59<01:01,  8.78s/it]
Task 9, Epoch 14/20 => Loss 0.151, Train_accy 88.76:  65%|██████▌   | 13/20 [02:06<01:01,  8.78s/it]
Task 9, Epoch 14/20 => Loss 0.151, Train_accy 88.76:  70%|███████   | 14/20 [02:06<00:50,  8.38s/it]
Task 9, Epoch 15/20 => Loss 0.174, Train_accy 88.03:  70%|███████   | 14/20 [02:14<00:50,  8.38s/it]
Task 9, Epoch 15/20 => Loss 0.174, Train_accy 88.03:  75%|███████▌  | 15/20 [02:14<00:40,  8.12s/it]
Task 9, Epoch 16/20 => Loss 0.148, Train_accy 89.50, Test_accy 54.96:  75%|███████▌  | 15/20 [02:28<00:40,  8.12s/it]
Task 9, Epoch 16/20 => Loss 0.148, Train_accy 89.50, Test_accy 54.96:  80%|████████  | 16/20 [02:28<00:40, 10.10s/it]
Task 9, Epoch 17/20 => Loss 0.159, Train_accy 88.55:  80%|████████  | 16/20 [02:36<00:40, 10.10s/it]                 
Task 9, Epoch 17/20 => Loss 0.159, Train_accy 88.55:  85%|████████▌ | 17/20 [02:36<00:28,  9.34s/it]
Task 9, Epoch 18/20 => Loss 0.164, Train_accy 87.92:  85%|████████▌ | 17/20 [02:44<00:28,  9.34s/it]
Task 9, Epoch 18/20 => Loss 0.164, Train_accy 87.92:  90%|█████████ | 18/20 [02:44<00:17,  8.81s/it]
Task 9, Epoch 19/20 => Loss 0.177, Train_accy 88.24:  90%|█████████ | 18/20 [02:51<00:17,  8.81s/it]
Task 9, Epoch 19/20 => Loss 0.177, Train_accy 88.24:  95%|█████████▌| 19/20 [02:51<00:08,  8.41s/it]
Task 9, Epoch 20/20 => Loss 0.159, Train_accy 89.81:  95%|█████████▌| 19/20 [02:59<00:08,  8.41s/it]
Task 9, Epoch 20/20 => Loss 0.159, Train_accy 89.81: 100%|██████████| 20/20 [02:59<00:00,  8.14s/it]
Task 9, Epoch 20/20 => Loss 0.159, Train_accy 89.81: 100%|██████████| 20/20 [02:59<00:00,  8.95s/it]
2024-09-04 17:21:25,197 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.159, Train_accy 89.81
2024-09-04 17:21:32,337 [trainer.py] => No NME accuracy.
2024-09-04 17:21:32,338 [trainer.py] => CNN: {'total': 56.83, '00-19': 21.46, '20-39': 31.4, '40-59': 41.74, '60-79': 48.18, '80-99': 65.06, '100-119': 57.46, '120-139': 58.22, '140-159': 68.4, '160-179': 80.17, '180-199': 93.04, 'old': 52.91, 'new': 93.04}
2024-09-04 17:21:32,338 [trainer.py] => CNN top1 curve: [96.36, 93.17, 81.55, 78.13, 65.99, 61.58, 62.77, 59.97, 57.47, 56.83]
2024-09-04 17:21:32,338 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.26, 97.71, 95.96, 93.86, 91.47, 92.65, 89.29, 88.13]

Average Accuracy (CNN): 71.38
2024-09-04 17:21:32,338 [trainer.py] => Average Accuracy (CNN): 71.38 

Accuracy Matrix (CNN):
[[96.36 92.31 74.49 63.16 31.58 23.89 25.91 22.27 18.22 21.46]
 [ 0.   94.2  76.81 71.01 53.14 42.51 41.55 41.06 37.2  31.4 ]
 [ 0.    0.   94.04 83.49 69.72 56.88 57.8  55.05 46.79 41.74]
 [ 0.    0.    0.   94.33 78.54 66.4  57.49 53.04 52.23 48.18]
 [ 0.    0.    0.    0.   92.94 85.13 81.78 78.44 68.4  65.06]
 [ 0.    0.    0.    0.    0.   91.23 83.77 69.3  62.72 57.46]
 [ 0.    0.    0.    0.    0.    0.   89.33 73.78 61.78 58.22]
 [ 0.    0.    0.    0.    0.    0.    0.   83.2  72.   68.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   94.51 80.17]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   93.04]]
2024-09-04 17:21:32,340 [trainer.py] => Forgetting (CNN): 39.78333333333334
2024-09-04 17:21:35,119 [trainer.py] => config: ./exps/finetune_cub_B0_Inc20.json
2024-09-04 17:21:35,119 [trainer.py] => prefix: reproduce
2024-09-04 17:21:35,119 [trainer.py] => dataset: cub
2024-09-04 17:21:35,119 [trainer.py] => memory_size: 0
2024-09-04 17:21:35,119 [trainer.py] => memory_per_class: 0
2024-09-04 17:21:35,119 [trainer.py] => fixed_memory: False
2024-09-04 17:21:35,119 [trainer.py] => shuffle: True
2024-09-04 17:21:35,119 [trainer.py] => init_cls: 10
2024-09-04 17:21:35,119 [trainer.py] => increment: 10
2024-09-04 17:21:35,119 [trainer.py] => model_name: finetune
2024-09-04 17:21:35,119 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 17:21:35,119 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 17:21:35,119 [trainer.py] => seed: 1993
2024-09-04 17:21:35,119 [trainer.py] => init_epoch: 20
2024-09-04 17:21:35,119 [trainer.py] => init_lr: 0.001
2024-09-04 17:21:35,119 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 17:21:35,120 [trainer.py] => init_lr_decay: 0.1
2024-09-04 17:21:35,120 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 17:21:35,120 [trainer.py] => epochs: 20
2024-09-04 17:21:35,120 [trainer.py] => lrate: 0.001
2024-09-04 17:21:35,120 [trainer.py] => milestones: [40, 70]
2024-09-04 17:21:35,120 [trainer.py] => lrate_decay: 0.1
2024-09-04 17:21:35,120 [trainer.py] => batch_size: 48
2024-09-04 17:21:35,120 [trainer.py] => weight_decay: 0.0002
2024-09-04 17:21:35,156 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 17:21:36,995 [trainer.py] => All params: 85798656
2024-09-04 17:21:36,996 [trainer.py] => Trainable params: 85798656
2024-09-04 17:21:36,997 [finetune.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.465, Train_accy 54.28, Test_accy 91.53:   0%|          | 0/20 [00:05<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.465, Train_accy 54.28, Test_accy 91.53:   5%|▌         | 1/20 [00:05<01:35,  5.03s/it]
Task 0, Epoch 2/20 => Loss 0.554, Train_accy 83.72:   5%|▌         | 1/20 [00:08<01:35,  5.03s/it]                 
Task 0, Epoch 2/20 => Loss 0.554, Train_accy 83.72:  10%|█         | 2/20 [00:08<01:18,  4.38s/it]
Task 0, Epoch 3/20 => Loss 0.395, Train_accy 88.94:  10%|█         | 2/20 [00:12<01:18,  4.38s/it]
Task 0, Epoch 3/20 => Loss 0.395, Train_accy 88.94:  15%|█▌        | 3/20 [00:12<01:11,  4.18s/it]
Task 0, Epoch 4/20 => Loss 0.248, Train_accy 92.07:  15%|█▌        | 3/20 [00:16<01:11,  4.18s/it]
Task 0, Epoch 4/20 => Loss 0.248, Train_accy 92.07:  20%|██        | 4/20 [00:16<01:05,  4.08s/it]
Task 0, Epoch 5/20 => Loss 0.297, Train_accy 89.56:  20%|██        | 4/20 [00:20<01:05,  4.08s/it]
Task 0, Epoch 5/20 => Loss 0.297, Train_accy 89.56:  25%|██▌       | 5/20 [00:20<01:00,  4.03s/it]
Task 0, Epoch 6/20 => Loss 0.237, Train_accy 91.65, Test_accy 96.61:  25%|██▌       | 5/20 [00:25<01:00,  4.03s/it]
Task 0, Epoch 6/20 => Loss 0.237, Train_accy 91.65, Test_accy 96.61:  30%|███       | 6/20 [00:25<01:00,  4.29s/it]
Task 0, Epoch 7/20 => Loss 0.248, Train_accy 91.44:  30%|███       | 6/20 [00:29<01:00,  4.29s/it]                 
Task 0, Epoch 7/20 => Loss 0.248, Train_accy 91.44:  35%|███▌      | 7/20 [00:29<00:54,  4.18s/it]
Task 0, Epoch 8/20 => Loss 0.200, Train_accy 93.11:  35%|███▌      | 7/20 [00:33<00:54,  4.18s/it]
Task 0, Epoch 8/20 => Loss 0.200, Train_accy 93.11:  40%|████      | 8/20 [00:33<00:49,  4.10s/it]
Task 0, Epoch 9/20 => Loss 0.100, Train_accy 96.24:  40%|████      | 8/20 [00:37<00:49,  4.10s/it]
Task 0, Epoch 9/20 => Loss 0.100, Train_accy 96.24:  45%|████▌     | 9/20 [00:37<00:44,  4.06s/it]
Task 0, Epoch 10/20 => Loss 0.181, Train_accy 93.74:  45%|████▌     | 9/20 [00:41<00:44,  4.06s/it]
Task 0, Epoch 10/20 => Loss 0.181, Train_accy 93.74:  50%|█████     | 10/20 [00:41<00:40,  4.03s/it]
Task 0, Epoch 11/20 => Loss 0.156, Train_accy 95.20, Test_accy 98.31:  50%|█████     | 10/20 [00:46<00:40,  4.03s/it]
Task 0, Epoch 11/20 => Loss 0.156, Train_accy 95.20, Test_accy 98.31:  55%|█████▌    | 11/20 [00:46<00:38,  4.25s/it]
Task 0, Epoch 12/20 => Loss 0.139, Train_accy 95.82:  55%|█████▌    | 11/20 [00:50<00:38,  4.25s/it]                 
Task 0, Epoch 12/20 => Loss 0.139, Train_accy 95.82:  60%|██████    | 12/20 [00:50<00:33,  4.15s/it]
Task 0, Epoch 13/20 => Loss 0.126, Train_accy 95.20:  60%|██████    | 12/20 [00:54<00:33,  4.15s/it]
Task 0, Epoch 13/20 => Loss 0.126, Train_accy 95.20:  65%|██████▌   | 13/20 [00:54<00:28,  4.09s/it]
Task 0, Epoch 14/20 => Loss 0.155, Train_accy 95.20:  65%|██████▌   | 13/20 [00:58<00:28,  4.09s/it]
Task 0, Epoch 14/20 => Loss 0.155, Train_accy 95.20:  70%|███████   | 14/20 [00:58<00:24,  4.07s/it]
Task 0, Epoch 15/20 => Loss 0.113, Train_accy 96.24:  70%|███████   | 14/20 [01:01<00:24,  4.07s/it]
Task 0, Epoch 15/20 => Loss 0.113, Train_accy 96.24:  75%|███████▌  | 15/20 [01:01<00:20,  4.02s/it]
Task 0, Epoch 16/20 => Loss 0.139, Train_accy 94.99, Test_accy 96.61:  75%|███████▌  | 15/20 [01:06<00:20,  4.02s/it]
Task 0, Epoch 16/20 => Loss 0.139, Train_accy 94.99, Test_accy 96.61:  80%|████████  | 16/20 [01:06<00:17,  4.25s/it]
Task 0, Epoch 17/20 => Loss 0.156, Train_accy 95.62:  80%|████████  | 16/20 [01:10<00:17,  4.25s/it]                 
Task 0, Epoch 17/20 => Loss 0.156, Train_accy 95.62:  85%|████████▌ | 17/20 [01:10<00:12,  4.15s/it]
Task 0, Epoch 18/20 => Loss 0.121, Train_accy 95.20:  85%|████████▌ | 17/20 [01:14<00:12,  4.15s/it]
Task 0, Epoch 18/20 => Loss 0.121, Train_accy 95.20:  90%|█████████ | 18/20 [01:14<00:08,  4.09s/it]
Task 0, Epoch 19/20 => Loss 0.112, Train_accy 96.03:  90%|█████████ | 18/20 [01:18<00:08,  4.09s/it]
Task 0, Epoch 19/20 => Loss 0.112, Train_accy 96.03:  95%|█████████▌| 19/20 [01:18<00:04,  4.05s/it]
Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41:  95%|█████████▌| 19/20 [01:22<00:04,  4.05s/it]
Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41: 100%|██████████| 20/20 [01:22<00:00,  4.04s/it]
Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41: 100%|██████████| 20/20 [01:22<00:00,  4.13s/it]
2024-09-04 17:22:59,987 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41
2024-09-04 17:23:00,786 [trainer.py] => No NME accuracy.
2024-09-04 17:23:00,787 [trainer.py] => CNN: {'total': 96.61, '00-09': 96.61, 'old': 0, 'new': 96.61}
2024-09-04 17:23:00,787 [trainer.py] => CNN top1 curve: [96.61]
2024-09-04 17:23:00,787 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 96.61
2024-09-04 17:23:00,787 [trainer.py] => Average Accuracy (CNN): 96.61 

2024-09-04 17:23:00,789 [trainer.py] => All params: 85806346
2024-09-04 17:23:00,790 [trainer.py] => Trainable params: 85806346
2024-09-04 17:23:00,792 [finetune.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.800, Train_accy 22.48, Test_accy 76.92:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.800, Train_accy 22.48, Test_accy 76.92:   5%|▌         | 1/20 [00:05<01:35,  5.05s/it]
Task 1, Epoch 2/20 => Loss 0.450, Train_accy 76.45:   5%|▌         | 1/20 [00:08<01:35,  5.05s/it]                 
Task 1, Epoch 2/20 => Loss 0.450, Train_accy 76.45:  10%|█         | 2/20 [00:08<01:18,  4.35s/it]
Task 1, Epoch 3/20 => Loss 0.217, Train_accy 90.36:  10%|█         | 2/20 [00:12<01:18,  4.35s/it]
Task 1, Epoch 3/20 => Loss 0.217, Train_accy 90.36:  15%|█▌        | 3/20 [00:12<01:10,  4.12s/it]
Task 1, Epoch 4/20 => Loss 0.276, Train_accy 89.08:  15%|█▌        | 3/20 [00:16<01:10,  4.12s/it]
Task 1, Epoch 4/20 => Loss 0.276, Train_accy 89.08:  20%|██        | 4/20 [00:16<01:04,  4.03s/it]
Task 1, Epoch 5/20 => Loss 0.214, Train_accy 88.87:  20%|██        | 4/20 [00:20<01:04,  4.03s/it]
Task 1, Epoch 5/20 => Loss 0.214, Train_accy 88.87:  25%|██▌       | 5/20 [00:20<00:59,  3.98s/it]
Task 1, Epoch 6/20 => Loss 0.182, Train_accy 91.65, Test_accy 92.31:  25%|██▌       | 5/20 [00:25<00:59,  3.98s/it]
Task 1, Epoch 6/20 => Loss 0.182, Train_accy 91.65, Test_accy 92.31:  30%|███       | 6/20 [00:25<01:00,  4.32s/it]
Task 1, Epoch 7/20 => Loss 0.138, Train_accy 92.51:  30%|███       | 6/20 [00:29<01:00,  4.32s/it]                 
Task 1, Epoch 7/20 => Loss 0.138, Train_accy 92.51:  35%|███▌      | 7/20 [00:29<00:54,  4.19s/it]
Task 1, Epoch 8/20 => Loss 0.139, Train_accy 94.22:  35%|███▌      | 7/20 [00:33<00:54,  4.19s/it]
Task 1, Epoch 8/20 => Loss 0.139, Train_accy 94.22:  40%|████      | 8/20 [00:33<00:48,  4.08s/it]
Task 1, Epoch 9/20 => Loss 0.148, Train_accy 94.43:  40%|████      | 8/20 [00:37<00:48,  4.08s/it]
Task 1, Epoch 9/20 => Loss 0.148, Train_accy 94.43:  45%|████▌     | 9/20 [00:37<00:44,  4.00s/it]
Task 1, Epoch 10/20 => Loss 0.196, Train_accy 92.08:  45%|████▌     | 9/20 [00:40<00:44,  4.00s/it]
Task 1, Epoch 10/20 => Loss 0.196, Train_accy 92.08:  50%|█████     | 10/20 [00:40<00:39,  3.96s/it]
Task 1, Epoch 11/20 => Loss 0.145, Train_accy 93.79, Test_accy 93.12:  50%|█████     | 10/20 [00:45<00:39,  3.96s/it]
Task 1, Epoch 11/20 => Loss 0.145, Train_accy 93.79, Test_accy 93.12:  55%|█████▌    | 11/20 [00:45<00:38,  4.27s/it]
Task 1, Epoch 12/20 => Loss 0.119, Train_accy 94.86:  55%|█████▌    | 11/20 [00:49<00:38,  4.27s/it]                 
Task 1, Epoch 12/20 => Loss 0.119, Train_accy 94.86:  60%|██████    | 12/20 [00:49<00:33,  4.17s/it]
Task 1, Epoch 13/20 => Loss 0.115, Train_accy 95.07:  60%|██████    | 12/20 [00:53<00:33,  4.17s/it]
Task 1, Epoch 13/20 => Loss 0.115, Train_accy 95.07:  65%|██████▌   | 13/20 [00:53<00:28,  4.10s/it]
Task 1, Epoch 14/20 => Loss 0.086, Train_accy 95.07:  65%|██████▌   | 13/20 [00:57<00:28,  4.10s/it]
Task 1, Epoch 14/20 => Loss 0.086, Train_accy 95.07:  70%|███████   | 14/20 [00:57<00:24,  4.03s/it]
Task 1, Epoch 15/20 => Loss 0.137, Train_accy 95.50:  70%|███████   | 14/20 [01:01<00:24,  4.03s/it]
Task 1, Epoch 15/20 => Loss 0.137, Train_accy 95.50:  75%|███████▌  | 15/20 [01:01<00:19,  3.98s/it]
Task 1, Epoch 16/20 => Loss 0.101, Train_accy 94.22, Test_accy 92.71:  75%|███████▌  | 15/20 [01:06<00:19,  3.98s/it]
Task 1, Epoch 16/20 => Loss 0.101, Train_accy 94.22, Test_accy 92.71:  80%|████████  | 16/20 [01:06<00:17,  4.33s/it]
Task 1, Epoch 17/20 => Loss 0.135, Train_accy 92.93:  80%|████████  | 16/20 [01:10<00:17,  4.33s/it]                 
Task 1, Epoch 17/20 => Loss 0.135, Train_accy 92.93:  85%|████████▌ | 17/20 [01:10<00:12,  4.18s/it]
Task 1, Epoch 18/20 => Loss 0.107, Train_accy 95.07:  85%|████████▌ | 17/20 [01:14<00:12,  4.18s/it]
Task 1, Epoch 18/20 => Loss 0.107, Train_accy 95.07:  90%|█████████ | 18/20 [01:14<00:08,  4.09s/it]
Task 1, Epoch 19/20 => Loss 0.099, Train_accy 94.65:  90%|█████████ | 18/20 [01:18<00:08,  4.09s/it]
Task 1, Epoch 19/20 => Loss 0.099, Train_accy 94.65:  95%|█████████▌| 19/20 [01:18<00:04,  4.01s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 93.58:  95%|█████████▌| 19/20 [01:22<00:04,  4.01s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 93.58: 100%|██████████| 20/20 [01:22<00:00,  3.96s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 93.58: 100%|██████████| 20/20 [01:22<00:00,  4.10s/it]
2024-09-04 17:24:22,885 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.111, Train_accy 93.58
2024-09-04 17:24:24,115 [trainer.py] => No NME accuracy.
2024-09-04 17:24:24,116 [trainer.py] => CNN: {'total': 92.71, '00-09': 87.29, '10-19': 97.67, 'old': 87.29, 'new': 97.67}
2024-09-04 17:24:24,116 [trainer.py] => CNN top1 curve: [96.61, 92.71]
2024-09-04 17:24:24,116 [trainer.py] => CNN top5 curve: [100.0, 99.6]

Average Accuracy (CNN): 94.66
2024-09-04 17:24:24,117 [trainer.py] => Average Accuracy (CNN): 94.66 

2024-09-04 17:24:24,118 [trainer.py] => All params: 85814036
2024-09-04 17:24:24,120 [trainer.py] => Trainable params: 85814036
2024-09-04 17:24:24,122 [finetune.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.104, Train_accy 8.82, Test_accy 73.26:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.104, Train_accy 8.82, Test_accy 73.26:   5%|▌         | 1/20 [00:05<01:40,  5.28s/it]
Task 2, Epoch 2/20 => Loss 0.251, Train_accy 56.93:   5%|▌         | 1/20 [00:09<01:40,  5.28s/it]                
Task 2, Epoch 2/20 => Loss 0.251, Train_accy 56.93:  10%|█         | 2/20 [00:09<01:20,  4.46s/it]
Task 2, Epoch 3/20 => Loss 0.140, Train_accy 80.67:  10%|█         | 2/20 [00:13<01:20,  4.46s/it]
Task 2, Epoch 3/20 => Loss 0.140, Train_accy 80.67:  15%|█▌        | 3/20 [00:13<01:11,  4.20s/it]
Task 2, Epoch 4/20 => Loss 0.135, Train_accy 85.08:  15%|█▌        | 3/20 [00:17<01:11,  4.20s/it]
Task 2, Epoch 4/20 => Loss 0.135, Train_accy 85.08:  20%|██        | 4/20 [00:17<01:05,  4.10s/it]
Task 2, Epoch 5/20 => Loss 0.138, Train_accy 87.61:  20%|██        | 4/20 [00:20<01:05,  4.10s/it]
Task 2, Epoch 5/20 => Loss 0.138, Train_accy 87.61:  25%|██▌       | 5/20 [00:20<01:00,  4.03s/it]
Task 2, Epoch 6/20 => Loss 0.117, Train_accy 89.92, Test_accy 90.12:  25%|██▌       | 5/20 [00:26<01:00,  4.03s/it]
Task 2, Epoch 6/20 => Loss 0.117, Train_accy 89.92, Test_accy 90.12:  30%|███       | 6/20 [00:26<01:02,  4.48s/it]
Task 2, Epoch 7/20 => Loss 0.067, Train_accy 94.12:  30%|███       | 6/20 [00:30<01:02,  4.48s/it]                 
Task 2, Epoch 7/20 => Loss 0.067, Train_accy 94.12:  35%|███▌      | 7/20 [00:30<00:56,  4.32s/it]
Task 2, Epoch 8/20 => Loss 0.088, Train_accy 94.12:  35%|███▌      | 7/20 [00:34<00:56,  4.32s/it]
Task 2, Epoch 8/20 => Loss 0.088, Train_accy 94.12:  40%|████      | 8/20 [00:34<00:50,  4.21s/it]
Task 2, Epoch 9/20 => Loss 0.097, Train_accy 94.33:  40%|████      | 8/20 [00:38<00:50,  4.21s/it]
Task 2, Epoch 9/20 => Loss 0.097, Train_accy 94.33:  45%|████▌     | 9/20 [00:38<00:45,  4.12s/it]
Task 2, Epoch 10/20 => Loss 0.113, Train_accy 92.65:  45%|████▌     | 9/20 [00:42<00:45,  4.12s/it]
Task 2, Epoch 10/20 => Loss 0.113, Train_accy 92.65:  50%|█████     | 10/20 [00:42<00:40,  4.07s/it]
Task 2, Epoch 11/20 => Loss 0.113, Train_accy 93.91, Test_accy 89.83:  50%|█████     | 10/20 [00:47<00:40,  4.07s/it]
Task 2, Epoch 11/20 => Loss 0.113, Train_accy 93.91, Test_accy 89.83:  55%|█████▌    | 11/20 [00:47<00:40,  4.47s/it]
Task 2, Epoch 12/20 => Loss 0.082, Train_accy 94.33:  55%|█████▌    | 11/20 [00:51<00:40,  4.47s/it]                 
Task 2, Epoch 12/20 => Loss 0.082, Train_accy 94.33:  60%|██████    | 12/20 [00:51<00:34,  4.32s/it]
Task 2, Epoch 13/20 => Loss 0.073, Train_accy 92.86:  60%|██████    | 12/20 [00:55<00:34,  4.32s/it]
Task 2, Epoch 13/20 => Loss 0.073, Train_accy 92.86:  65%|██████▌   | 13/20 [00:55<00:29,  4.20s/it]
Task 2, Epoch 14/20 => Loss 0.081, Train_accy 94.12:  65%|██████▌   | 13/20 [00:59<00:29,  4.20s/it]
Task 2, Epoch 14/20 => Loss 0.081, Train_accy 94.12:  70%|███████   | 14/20 [00:59<00:24,  4.13s/it]
Task 2, Epoch 15/20 => Loss 0.080, Train_accy 93.91:  70%|███████   | 14/20 [01:03<00:24,  4.13s/it]
Task 2, Epoch 15/20 => Loss 0.080, Train_accy 93.91:  75%|███████▌  | 15/20 [01:03<00:20,  4.06s/it]
Task 2, Epoch 16/20 => Loss 0.122, Train_accy 93.28, Test_accy 89.24:  75%|███████▌  | 15/20 [01:08<00:20,  4.06s/it]
Task 2, Epoch 16/20 => Loss 0.122, Train_accy 93.28, Test_accy 89.24:  80%|████████  | 16/20 [01:08<00:17,  4.44s/it]
Task 2, Epoch 17/20 => Loss 0.109, Train_accy 92.23:  80%|████████  | 16/20 [01:12<00:17,  4.44s/it]                 
Task 2, Epoch 17/20 => Loss 0.109, Train_accy 92.23:  85%|████████▌ | 17/20 [01:12<00:12,  4.27s/it]
Task 2, Epoch 18/20 => Loss 0.058, Train_accy 94.12:  85%|████████▌ | 17/20 [01:16<00:12,  4.27s/it]
Task 2, Epoch 18/20 => Loss 0.058, Train_accy 94.12:  90%|█████████ | 18/20 [01:16<00:08,  4.16s/it]
Task 2, Epoch 19/20 => Loss 0.057, Train_accy 94.12:  90%|█████████ | 18/20 [01:20<00:08,  4.16s/it]
Task 2, Epoch 19/20 => Loss 0.057, Train_accy 94.12:  95%|█████████▌| 19/20 [01:20<00:04,  4.08s/it]
Task 2, Epoch 20/20 => Loss 0.069, Train_accy 95.38:  95%|█████████▌| 19/20 [01:24<00:04,  4.08s/it]
Task 2, Epoch 20/20 => Loss 0.069, Train_accy 95.38: 100%|██████████| 20/20 [01:24<00:00,  4.03s/it]
Task 2, Epoch 20/20 => Loss 0.069, Train_accy 95.38: 100%|██████████| 20/20 [01:24<00:00,  4.21s/it]
2024-09-04 17:25:48,296 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.069, Train_accy 95.38
2024-09-04 17:25:49,775 [trainer.py] => No NME accuracy.
2024-09-04 17:25:49,776 [trainer.py] => CNN: {'total': 88.37, '00-09': 73.73, '10-19': 95.35, '20-29': 96.91, 'old': 85.02, 'new': 96.91}
2024-09-04 17:25:49,776 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37]
2024-09-04 17:25:49,776 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71]

Average Accuracy (CNN): 92.56
2024-09-04 17:25:49,776 [trainer.py] => Average Accuracy (CNN): 92.56 

2024-09-04 17:25:49,777 [trainer.py] => All params: 85821726
2024-09-04 17:25:49,778 [trainer.py] => Trainable params: 85821726
2024-09-04 17:25:49,780 [finetune.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.568, Train_accy 4.05, Test_accy 73.35:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.568, Train_accy 4.05, Test_accy 73.35:   5%|▌         | 1/20 [00:05<01:46,  5.59s/it]
Task 3, Epoch 2/20 => Loss 0.283, Train_accy 51.60:   5%|▌         | 1/20 [00:09<01:46,  5.59s/it]                
Task 3, Epoch 2/20 => Loss 0.283, Train_accy 51.60:  10%|█         | 2/20 [00:09<01:22,  4.57s/it]
Task 3, Epoch 3/20 => Loss 0.194, Train_accy 71.64:  10%|█         | 2/20 [00:13<01:22,  4.57s/it]
Task 3, Epoch 3/20 => Loss 0.194, Train_accy 71.64:  15%|█▌        | 3/20 [00:13<01:12,  4.26s/it]
Task 3, Epoch 4/20 => Loss 0.181, Train_accy 82.52:  15%|█▌        | 3/20 [00:17<01:12,  4.26s/it]
Task 3, Epoch 4/20 => Loss 0.181, Train_accy 82.52:  20%|██        | 4/20 [00:17<01:05,  4.11s/it]
Task 3, Epoch 5/20 => Loss 0.141, Train_accy 81.66:  20%|██        | 4/20 [00:21<01:05,  4.11s/it]
Task 3, Epoch 5/20 => Loss 0.141, Train_accy 81.66:  25%|██▌       | 5/20 [00:21<01:00,  4.02s/it]
Task 3, Epoch 6/20 => Loss 0.142, Train_accy 82.52, Test_accy 72.69:  25%|██▌       | 5/20 [00:26<01:00,  4.02s/it]
Task 3, Epoch 6/20 => Loss 0.142, Train_accy 82.52, Test_accy 72.69:  30%|███       | 6/20 [00:26<01:04,  4.59s/it]
Task 3, Epoch 7/20 => Loss 0.132, Train_accy 77.83:  30%|███       | 6/20 [00:30<01:04,  4.59s/it]                 
Task 3, Epoch 7/20 => Loss 0.132, Train_accy 77.83:  35%|███▌      | 7/20 [00:30<00:56,  4.35s/it]
Task 3, Epoch 8/20 => Loss 0.127, Train_accy 81.88:  35%|███▌      | 7/20 [00:34<00:56,  4.35s/it]
Task 3, Epoch 8/20 => Loss 0.127, Train_accy 81.88:  40%|████      | 8/20 [00:34<00:50,  4.19s/it]
Task 3, Epoch 9/20 => Loss 0.125, Train_accy 84.43:  40%|████      | 8/20 [00:38<00:50,  4.19s/it]
Task 3, Epoch 9/20 => Loss 0.125, Train_accy 84.43:  45%|████▌     | 9/20 [00:38<00:44,  4.09s/it]
Task 3, Epoch 10/20 => Loss 0.100, Train_accy 81.88:  45%|████▌     | 9/20 [00:42<00:44,  4.09s/it]
Task 3, Epoch 10/20 => Loss 0.100, Train_accy 81.88:  50%|█████     | 10/20 [00:42<00:40,  4.04s/it]
Task 3, Epoch 11/20 => Loss 0.107, Train_accy 81.88, Test_accy 70.70:  50%|█████     | 10/20 [00:47<00:40,  4.04s/it]
Task 3, Epoch 11/20 => Loss 0.107, Train_accy 81.88, Test_accy 70.70:  55%|█████▌    | 11/20 [00:47<00:40,  4.52s/it]
Task 3, Epoch 12/20 => Loss 0.057, Train_accy 84.86:  55%|█████▌    | 11/20 [00:51<00:40,  4.52s/it]                 
Task 3, Epoch 12/20 => Loss 0.057, Train_accy 84.86:  60%|██████    | 12/20 [00:51<00:34,  4.31s/it]
Task 3, Epoch 13/20 => Loss 0.102, Train_accy 84.43:  60%|██████    | 12/20 [00:55<00:34,  4.31s/it]
Task 3, Epoch 13/20 => Loss 0.102, Train_accy 84.43:  65%|██████▌   | 13/20 [00:55<00:29,  4.17s/it]
Task 3, Epoch 14/20 => Loss 0.136, Train_accy 84.43:  65%|██████▌   | 13/20 [00:59<00:29,  4.17s/it]
Task 3, Epoch 14/20 => Loss 0.136, Train_accy 84.43:  70%|███████   | 14/20 [00:59<00:24,  4.09s/it]
Task 3, Epoch 15/20 => Loss 0.078, Train_accy 89.55:  70%|███████   | 14/20 [01:03<00:24,  4.09s/it]
Task 3, Epoch 15/20 => Loss 0.078, Train_accy 89.55:  75%|███████▌  | 15/20 [01:03<00:20,  4.01s/it]
Task 3, Epoch 16/20 => Loss 0.093, Train_accy 89.98, Test_accy 74.67:  75%|███████▌  | 15/20 [01:08<00:20,  4.01s/it]
Task 3, Epoch 16/20 => Loss 0.093, Train_accy 89.98, Test_accy 74.67:  80%|████████  | 16/20 [01:08<00:17,  4.47s/it]
Task 3, Epoch 17/20 => Loss 0.091, Train_accy 90.62:  80%|████████  | 16/20 [01:12<00:17,  4.47s/it]                 
Task 3, Epoch 17/20 => Loss 0.091, Train_accy 90.62:  85%|████████▌ | 17/20 [01:12<00:12,  4.30s/it]
Task 3, Epoch 18/20 => Loss 0.102, Train_accy 89.98:  85%|████████▌ | 17/20 [01:16<00:12,  4.30s/it]
Task 3, Epoch 18/20 => Loss 0.102, Train_accy 89.98:  90%|█████████ | 18/20 [01:16<00:08,  4.24s/it]
Task 3, Epoch 19/20 => Loss 0.108, Train_accy 87.42:  90%|█████████ | 18/20 [01:20<00:08,  4.24s/it]
Task 3, Epoch 19/20 => Loss 0.108, Train_accy 87.42:  95%|█████████▌| 19/20 [01:20<00:04,  4.14s/it]
Task 3, Epoch 20/20 => Loss 0.126, Train_accy 87.42:  95%|█████████▌| 19/20 [01:24<00:04,  4.14s/it]
Task 3, Epoch 20/20 => Loss 0.126, Train_accy 87.42: 100%|██████████| 20/20 [01:24<00:00,  4.06s/it]
Task 3, Epoch 20/20 => Loss 0.126, Train_accy 87.42: 100%|██████████| 20/20 [01:24<00:00,  4.23s/it]
2024-09-04 17:27:14,398 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.126, Train_accy 87.42
2024-09-04 17:27:16,187 [trainer.py] => No NME accuracy.
2024-09-04 17:27:16,187 [trainer.py] => CNN: {'total': 72.69, '00-09': 49.15, '10-19': 77.52, '20-29': 78.35, '30-39': 87.27, 'old': 68.02, 'new': 87.27}
2024-09-04 17:27:16,188 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69]
2024-09-04 17:27:16,188 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02]

Average Accuracy (CNN): 87.6
2024-09-04 17:27:16,188 [trainer.py] => Average Accuracy (CNN): 87.6 

2024-09-04 17:27:16,189 [trainer.py] => All params: 85829416
2024-09-04 17:27:16,190 [trainer.py] => Trainable params: 85829416
2024-09-04 17:27:16,192 [finetune.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.791, Train_accy 2.56, Test_accy 57.58:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.791, Train_accy 2.56, Test_accy 57.58:   5%|▌         | 1/20 [00:05<01:50,  5.83s/it]
Task 4, Epoch 2/20 => Loss 0.382, Train_accy 51.60:   5%|▌         | 1/20 [00:09<01:50,  5.83s/it]                
Task 4, Epoch 2/20 => Loss 0.382, Train_accy 51.60:  10%|█         | 2/20 [00:09<01:24,  4.69s/it]
Task 4, Epoch 3/20 => Loss 0.253, Train_accy 79.10:  10%|█         | 2/20 [00:13<01:24,  4.69s/it]
Task 4, Epoch 3/20 => Loss 0.253, Train_accy 79.10:  15%|█▌        | 3/20 [00:13<01:13,  4.31s/it]
Task 4, Epoch 4/20 => Loss 0.221, Train_accy 82.73:  15%|█▌        | 3/20 [00:17<01:13,  4.31s/it]
Task 4, Epoch 4/20 => Loss 0.221, Train_accy 82.73:  20%|██        | 4/20 [00:17<01:06,  4.15s/it]
Task 4, Epoch 5/20 => Loss 0.152, Train_accy 85.50:  20%|██        | 4/20 [00:21<01:06,  4.15s/it]
Task 4, Epoch 5/20 => Loss 0.152, Train_accy 85.50:  25%|██▌       | 5/20 [00:21<01:00,  4.06s/it]
Task 4, Epoch 6/20 => Loss 0.231, Train_accy 84.65, Test_accy 73.62:  25%|██▌       | 5/20 [00:27<01:00,  4.06s/it]
Task 4, Epoch 6/20 => Loss 0.231, Train_accy 84.65, Test_accy 73.62:  30%|███       | 6/20 [00:27<01:06,  4.73s/it]
Task 4, Epoch 7/20 => Loss 0.230, Train_accy 80.60:  30%|███       | 6/20 [00:31<01:06,  4.73s/it]                 
Task 4, Epoch 7/20 => Loss 0.230, Train_accy 80.60:  35%|███▌      | 7/20 [00:31<00:58,  4.48s/it]
Task 4, Epoch 8/20 => Loss 0.153, Train_accy 84.86:  35%|███▌      | 7/20 [00:35<00:58,  4.48s/it]
Task 4, Epoch 8/20 => Loss 0.153, Train_accy 84.86:  40%|████      | 8/20 [00:35<00:51,  4.29s/it]
Task 4, Epoch 9/20 => Loss 0.161, Train_accy 87.21:  40%|████      | 8/20 [00:39<00:51,  4.29s/it]
Task 4, Epoch 9/20 => Loss 0.161, Train_accy 87.21:  45%|████▌     | 9/20 [00:39<00:45,  4.18s/it]
Task 4, Epoch 10/20 => Loss 0.237, Train_accy 82.94:  45%|████▌     | 9/20 [00:43<00:45,  4.18s/it]
Task 4, Epoch 10/20 => Loss 0.237, Train_accy 82.94:  50%|█████     | 10/20 [00:43<00:40,  4.09s/it]
Task 4, Epoch 11/20 => Loss 0.172, Train_accy 85.07, Test_accy 78.07:  50%|█████     | 10/20 [00:49<00:40,  4.09s/it]
Task 4, Epoch 11/20 => Loss 0.172, Train_accy 85.07, Test_accy 78.07:  55%|█████▌    | 11/20 [00:49<00:42,  4.67s/it]
Task 4, Epoch 12/20 => Loss 0.120, Train_accy 87.63:  55%|█████▌    | 11/20 [00:53<00:42,  4.67s/it]                 
Task 4, Epoch 12/20 => Loss 0.120, Train_accy 87.63:  60%|██████    | 12/20 [00:53<00:35,  4.45s/it]
Task 4, Epoch 13/20 => Loss 0.147, Train_accy 86.78:  60%|██████    | 12/20 [00:56<00:35,  4.45s/it]
Task 4, Epoch 13/20 => Loss 0.147, Train_accy 86.78:  65%|██████▌   | 13/20 [00:56<00:30,  4.29s/it]
Task 4, Epoch 14/20 => Loss 0.162, Train_accy 88.06:  65%|██████▌   | 13/20 [01:00<00:30,  4.29s/it]
Task 4, Epoch 14/20 => Loss 0.162, Train_accy 88.06:  70%|███████   | 14/20 [01:00<00:24,  4.16s/it]
Task 4, Epoch 15/20 => Loss 0.144, Train_accy 87.42:  70%|███████   | 14/20 [01:04<00:24,  4.16s/it]
Task 4, Epoch 15/20 => Loss 0.144, Train_accy 87.42:  75%|███████▌  | 15/20 [01:04<00:20,  4.06s/it]
Task 4, Epoch 16/20 => Loss 0.128, Train_accy 89.98, Test_accy 75.40:  75%|███████▌  | 15/20 [01:10<00:20,  4.06s/it]
Task 4, Epoch 16/20 => Loss 0.128, Train_accy 89.98, Test_accy 75.40:  80%|████████  | 16/20 [01:10<00:18,  4.59s/it]
Task 4, Epoch 17/20 => Loss 0.088, Train_accy 90.19:  80%|████████  | 16/20 [01:14<00:18,  4.59s/it]                 
Task 4, Epoch 17/20 => Loss 0.088, Train_accy 90.19:  85%|████████▌ | 17/20 [01:14<00:13,  4.38s/it]
Task 4, Epoch 18/20 => Loss 0.104, Train_accy 92.11:  85%|████████▌ | 17/20 [01:18<00:13,  4.38s/it]
Task 4, Epoch 18/20 => Loss 0.104, Train_accy 92.11:  90%|█████████ | 18/20 [01:18<00:08,  4.22s/it]
Task 4, Epoch 19/20 => Loss 0.147, Train_accy 88.49:  90%|█████████ | 18/20 [01:22<00:08,  4.22s/it]
Task 4, Epoch 19/20 => Loss 0.147, Train_accy 88.49:  95%|█████████▌| 19/20 [01:22<00:04,  4.11s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 90.19:  95%|█████████▌| 19/20 [01:25<00:04,  4.11s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 90.19: 100%|██████████| 20/20 [01:25<00:00,  4.03s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 90.19: 100%|██████████| 20/20 [01:25<00:00,  4.29s/it]
2024-09-04 17:28:42,095 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.131, Train_accy 90.19
2024-09-04 17:28:44,139 [trainer.py] => No NME accuracy.
2024-09-04 17:28:44,139 [trainer.py] => CNN: {'total': 76.11, '00-09': 52.54, '10-19': 84.5, '20-29': 71.13, '30-39': 79.09, '40-49': 93.46, 'old': 72.03, 'new': 93.46}
2024-09-04 17:28:44,139 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11]
2024-09-04 17:28:44,139 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86]

Average Accuracy (CNN): 85.3
2024-09-04 17:28:44,139 [trainer.py] => Average Accuracy (CNN): 85.3 

2024-09-04 17:28:44,140 [trainer.py] => All params: 85837106
2024-09-04 17:28:44,141 [trainer.py] => Trainable params: 85837106
2024-09-04 17:28:44,143 [finetune.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.356, Train_accy 3.38, Test_accy 66.22:   0%|          | 0/20 [00:06<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.356, Train_accy 3.38, Test_accy 66.22:   5%|▌         | 1/20 [00:06<02:00,  6.36s/it]
Task 5, Epoch 2/20 => Loss 0.275, Train_accy 44.73:   5%|▌         | 1/20 [00:10<02:00,  6.36s/it]                
Task 5, Epoch 2/20 => Loss 0.275, Train_accy 44.73:  10%|█         | 2/20 [00:10<01:28,  4.93s/it]
Task 5, Epoch 3/20 => Loss 0.301, Train_accy 74.68:  10%|█         | 2/20 [00:14<01:28,  4.93s/it]
Task 5, Epoch 3/20 => Loss 0.301, Train_accy 74.68:  15%|█▌        | 3/20 [00:14<01:16,  4.49s/it]
Task 5, Epoch 4/20 => Loss 0.238, Train_accy 79.32:  15%|█▌        | 3/20 [00:18<01:16,  4.49s/it]
Task 5, Epoch 4/20 => Loss 0.238, Train_accy 79.32:  20%|██        | 4/20 [00:18<01:08,  4.29s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 81.22:  20%|██        | 4/20 [00:22<01:08,  4.29s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 81.22:  25%|██▌       | 5/20 [00:22<01:02,  4.17s/it]
Task 5, Epoch 6/20 => Loss 0.186, Train_accy 82.28, Test_accy 75.89:  25%|██▌       | 5/20 [00:28<01:02,  4.17s/it]
Task 5, Epoch 6/20 => Loss 0.186, Train_accy 82.28, Test_accy 75.89:  30%|███       | 6/20 [00:28<01:09,  4.97s/it]
Task 5, Epoch 7/20 => Loss 0.174, Train_accy 85.02:  30%|███       | 6/20 [00:32<01:09,  4.97s/it]                 
Task 5, Epoch 7/20 => Loss 0.174, Train_accy 85.02:  35%|███▌      | 7/20 [00:32<01:00,  4.64s/it]
Task 5, Epoch 8/20 => Loss 0.157, Train_accy 85.44:  35%|███▌      | 7/20 [00:36<01:00,  4.64s/it]
Task 5, Epoch 8/20 => Loss 0.157, Train_accy 85.44:  40%|████      | 8/20 [00:36<00:53,  4.42s/it]
Task 5, Epoch 9/20 => Loss 0.148, Train_accy 83.54:  40%|████      | 8/20 [00:40<00:53,  4.42s/it]
Task 5, Epoch 9/20 => Loss 0.148, Train_accy 83.54:  45%|████▌     | 9/20 [00:40<00:46,  4.26s/it]
Task 5, Epoch 10/20 => Loss 0.173, Train_accy 84.60:  45%|████▌     | 9/20 [00:44<00:46,  4.26s/it]
Task 5, Epoch 10/20 => Loss 0.173, Train_accy 84.60:  50%|█████     | 10/20 [00:44<00:41,  4.15s/it]
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 88.61, Test_accy 75.89:  50%|█████     | 10/20 [00:50<00:41,  4.15s/it]
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 88.61, Test_accy 75.89:  55%|█████▌    | 11/20 [00:50<00:43,  4.78s/it]
Task 5, Epoch 12/20 => Loss 0.156, Train_accy 86.08:  55%|█████▌    | 11/20 [00:54<00:43,  4.78s/it]                 
Task 5, Epoch 12/20 => Loss 0.156, Train_accy 86.08:  60%|██████    | 12/20 [00:54<00:36,  4.53s/it]
Task 5, Epoch 13/20 => Loss 0.163, Train_accy 85.02:  60%|██████    | 12/20 [00:58<00:36,  4.53s/it]
Task 5, Epoch 13/20 => Loss 0.163, Train_accy 85.02:  65%|██████▌   | 13/20 [00:58<00:30,  4.32s/it]
Task 5, Epoch 14/20 => Loss 0.138, Train_accy 86.08:  65%|██████▌   | 13/20 [01:02<00:30,  4.32s/it]
Task 5, Epoch 14/20 => Loss 0.138, Train_accy 86.08:  70%|███████   | 14/20 [01:02<00:25,  4.18s/it]
Task 5, Epoch 15/20 => Loss 0.146, Train_accy 87.13:  70%|███████   | 14/20 [01:06<00:25,  4.18s/it]
Task 5, Epoch 15/20 => Loss 0.146, Train_accy 87.13:  75%|███████▌  | 15/20 [01:06<00:20,  4.09s/it]
Task 5, Epoch 16/20 => Loss 0.108, Train_accy 85.86, Test_accy 77.08:  75%|███████▌  | 15/20 [01:12<00:20,  4.09s/it]
Task 5, Epoch 16/20 => Loss 0.108, Train_accy 85.86, Test_accy 77.08:  80%|████████  | 16/20 [01:12<00:19,  4.76s/it]
Task 5, Epoch 17/20 => Loss 0.159, Train_accy 85.65:  80%|████████  | 16/20 [01:16<00:19,  4.76s/it]                 
Task 5, Epoch 17/20 => Loss 0.159, Train_accy 85.65:  85%|████████▌ | 17/20 [01:16<00:13,  4.51s/it]
Task 5, Epoch 18/20 => Loss 0.108, Train_accy 89.45:  85%|████████▌ | 17/20 [01:20<00:13,  4.51s/it]
Task 5, Epoch 18/20 => Loss 0.108, Train_accy 89.45:  90%|█████████ | 18/20 [01:20<00:08,  4.32s/it]
Task 5, Epoch 19/20 => Loss 0.119, Train_accy 88.40:  90%|█████████ | 18/20 [01:24<00:08,  4.32s/it]
Task 5, Epoch 19/20 => Loss 0.119, Train_accy 88.40:  95%|█████████▌| 19/20 [01:24<00:04,  4.20s/it]
Task 5, Epoch 20/20 => Loss 0.099, Train_accy 88.19:  95%|█████████▌| 19/20 [01:28<00:04,  4.20s/it]
Task 5, Epoch 20/20 => Loss 0.099, Train_accy 88.19: 100%|██████████| 20/20 [01:28<00:00,  4.13s/it]
Task 5, Epoch 20/20 => Loss 0.099, Train_accy 88.19: 100%|██████████| 20/20 [01:28<00:00,  4.41s/it]
2024-09-04 17:30:12,367 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.099, Train_accy 88.19
2024-09-04 17:30:14,773 [trainer.py] => No NME accuracy.
2024-09-04 17:30:14,773 [trainer.py] => CNN: {'total': 76.64, '00-09': 47.46, '10-19': 78.29, '20-29': 77.32, '30-39': 79.09, '40-49': 85.98, '50-59': 93.69, 'old': 73.26, 'new': 93.69}
2024-09-04 17:30:14,773 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64]
2024-09-04 17:30:14,773 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98]

Average Accuracy (CNN): 83.86
2024-09-04 17:30:14,773 [trainer.py] => Average Accuracy (CNN): 83.86 

2024-09-04 17:30:14,774 [trainer.py] => All params: 85844796
2024-09-04 17:30:14,775 [trainer.py] => Trainable params: 85844796
2024-09-04 17:30:14,777 [finetune.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.685, Train_accy 6.16, Test_accy 60.28:   0%|          | 0/20 [00:06<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.685, Train_accy 6.16, Test_accy 60.28:   5%|▌         | 1/20 [00:06<02:08,  6.77s/it]
Task 6, Epoch 2/20 => Loss 0.617, Train_accy 53.18:   5%|▌         | 1/20 [00:10<02:08,  6.77s/it]                
Task 6, Epoch 2/20 => Loss 0.617, Train_accy 53.18:  10%|█         | 2/20 [00:10<01:32,  5.16s/it]
Task 6, Epoch 3/20 => Loss 0.308, Train_accy 78.03:  10%|█         | 2/20 [00:14<01:32,  5.16s/it]
Task 6, Epoch 3/20 => Loss 0.308, Train_accy 78.03:  15%|█▌        | 3/20 [00:14<01:18,  4.65s/it]
Task 6, Epoch 4/20 => Loss 0.230, Train_accy 85.01:  15%|█▌        | 3/20 [00:18<01:18,  4.65s/it]
Task 6, Epoch 4/20 => Loss 0.230, Train_accy 85.01:  20%|██        | 4/20 [00:18<01:10,  4.41s/it]
Task 6, Epoch 5/20 => Loss 0.230, Train_accy 89.32:  20%|██        | 4/20 [00:22<01:10,  4.41s/it]
Task 6, Epoch 5/20 => Loss 0.230, Train_accy 89.32:  25%|██▌       | 5/20 [00:22<01:04,  4.28s/it]
Task 6, Epoch 6/20 => Loss 0.204, Train_accy 89.73, Test_accy 67.74:  25%|██▌       | 5/20 [00:29<01:04,  4.28s/it]
Task 6, Epoch 6/20 => Loss 0.204, Train_accy 89.73, Test_accy 67.74:  30%|███       | 6/20 [00:29<01:11,  5.10s/it]
Task 6, Epoch 7/20 => Loss 0.175, Train_accy 91.17:  30%|███       | 6/20 [00:33<01:11,  5.10s/it]                 
Task 6, Epoch 7/20 => Loss 0.175, Train_accy 91.17:  35%|███▌      | 7/20 [00:33<01:01,  4.75s/it]
Task 6, Epoch 8/20 => Loss 0.152, Train_accy 91.79:  35%|███▌      | 7/20 [00:37<01:01,  4.75s/it]
Task 6, Epoch 8/20 => Loss 0.152, Train_accy 91.79:  40%|████      | 8/20 [00:37<00:54,  4.54s/it]
Task 6, Epoch 9/20 => Loss 0.158, Train_accy 91.38:  40%|████      | 8/20 [00:41<00:54,  4.54s/it]
Task 6, Epoch 9/20 => Loss 0.158, Train_accy 91.38:  45%|████▌     | 9/20 [00:41<00:48,  4.38s/it]
Task 6, Epoch 10/20 => Loss 0.169, Train_accy 90.55:  45%|████▌     | 9/20 [00:45<00:48,  4.38s/it]
Task 6, Epoch 10/20 => Loss 0.169, Train_accy 90.55:  50%|█████     | 10/20 [00:45<00:42,  4.29s/it]
Task 6, Epoch 11/20 => Loss 0.189, Train_accy 90.14, Test_accy 66.20:  50%|█████     | 10/20 [00:52<00:42,  4.29s/it]
Task 6, Epoch 11/20 => Loss 0.189, Train_accy 90.14, Test_accy 66.20:  55%|█████▌    | 11/20 [00:52<00:45,  5.01s/it]
Task 6, Epoch 12/20 => Loss 0.144, Train_accy 92.40:  55%|█████▌    | 11/20 [00:56<00:45,  5.01s/it]                 
Task 6, Epoch 12/20 => Loss 0.144, Train_accy 92.40:  60%|██████    | 12/20 [00:56<00:37,  4.71s/it]
Task 6, Epoch 13/20 => Loss 0.143, Train_accy 92.40:  60%|██████    | 12/20 [01:00<00:37,  4.71s/it]
Task 6, Epoch 13/20 => Loss 0.143, Train_accy 92.40:  65%|██████▌   | 13/20 [01:00<00:31,  4.52s/it]
Task 6, Epoch 14/20 => Loss 0.151, Train_accy 91.79:  65%|██████▌   | 13/20 [01:04<00:31,  4.52s/it]
Task 6, Epoch 14/20 => Loss 0.151, Train_accy 91.79:  70%|███████   | 14/20 [01:04<00:26,  4.38s/it]
Task 6, Epoch 15/20 => Loss 0.128, Train_accy 93.02:  70%|███████   | 14/20 [01:08<00:26,  4.38s/it]
Task 6, Epoch 15/20 => Loss 0.128, Train_accy 93.02:  75%|███████▌  | 15/20 [01:08<00:21,  4.31s/it]
Task 6, Epoch 16/20 => Loss 0.096, Train_accy 94.05, Test_accy 65.81:  75%|███████▌  | 15/20 [01:15<00:21,  4.31s/it]
Task 6, Epoch 16/20 => Loss 0.096, Train_accy 94.05, Test_accy 65.81:  80%|████████  | 16/20 [01:15<00:20,  5.02s/it]
Task 6, Epoch 17/20 => Loss 0.175, Train_accy 92.20:  80%|████████  | 16/20 [01:19<00:20,  5.02s/it]                 
Task 6, Epoch 17/20 => Loss 0.175, Train_accy 92.20:  85%|████████▌ | 17/20 [01:19<00:14,  4.77s/it]
Task 6, Epoch 18/20 => Loss 0.165, Train_accy 92.61:  85%|████████▌ | 17/20 [01:23<00:14,  4.77s/it]
Task 6, Epoch 18/20 => Loss 0.165, Train_accy 92.61:  90%|█████████ | 18/20 [01:23<00:09,  4.55s/it]
Task 6, Epoch 19/20 => Loss 0.166, Train_accy 91.38:  90%|█████████ | 18/20 [01:27<00:09,  4.55s/it]
Task 6, Epoch 19/20 => Loss 0.166, Train_accy 91.38:  95%|█████████▌| 19/20 [01:27<00:04,  4.41s/it]
Task 6, Epoch 20/20 => Loss 0.153, Train_accy 92.40:  95%|█████████▌| 19/20 [01:31<00:04,  4.41s/it]
Task 6, Epoch 20/20 => Loss 0.153, Train_accy 92.40: 100%|██████████| 20/20 [01:31<00:00,  4.28s/it]
Task 6, Epoch 20/20 => Loss 0.153, Train_accy 92.40: 100%|██████████| 20/20 [01:31<00:00,  4.59s/it]
2024-09-04 17:31:46,570 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.153, Train_accy 92.40
2024-09-04 17:31:49,221 [trainer.py] => No NME accuracy.
2024-09-04 17:31:49,221 [trainer.py] => CNN: {'total': 65.81, '00-09': 45.76, '10-19': 68.22, '20-29': 58.76, '30-39': 57.27, '40-49': 72.9, '50-59': 63.06, '60-69': 96.23, 'old': 61.01, 'new': 96.23}
2024-09-04 17:31:49,221 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81]
2024-09-04 17:31:49,221 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53]

Average Accuracy (CNN): 81.28
2024-09-04 17:31:49,221 [trainer.py] => Average Accuracy (CNN): 81.28 

2024-09-04 17:31:49,222 [trainer.py] => All params: 85852486
2024-09-04 17:31:49,223 [trainer.py] => Trainable params: 85852486
2024-09-04 17:31:49,224 [finetune.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.909, Train_accy 0.87, Test_accy 54.30:   0%|          | 0/20 [00:06<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.909, Train_accy 0.87, Test_accy 54.30:   5%|▌         | 1/20 [00:06<02:12,  6.95s/it]
Task 7, Epoch 2/20 => Loss 0.282, Train_accy 38.13:   5%|▌         | 1/20 [00:10<02:12,  6.95s/it]                
Task 7, Epoch 2/20 => Loss 0.282, Train_accy 38.13:  10%|█         | 2/20 [00:10<01:32,  5.17s/it]
Task 7, Epoch 3/20 => Loss 0.195, Train_accy 68.19:  10%|█         | 2/20 [00:14<01:32,  5.17s/it]
Task 7, Epoch 3/20 => Loss 0.195, Train_accy 68.19:  15%|█▌        | 3/20 [00:14<01:17,  4.57s/it]
Task 7, Epoch 4/20 => Loss 0.127, Train_accy 75.38:  15%|█▌        | 3/20 [00:18<01:17,  4.57s/it]
Task 7, Epoch 4/20 => Loss 0.127, Train_accy 75.38:  20%|██        | 4/20 [00:18<01:08,  4.29s/it]
Task 7, Epoch 5/20 => Loss 0.158, Train_accy 78.65:  20%|██        | 4/20 [00:22<01:08,  4.29s/it]
Task 7, Epoch 5/20 => Loss 0.158, Train_accy 78.65:  25%|██▌       | 5/20 [00:22<01:02,  4.16s/it]
Task 7, Epoch 6/20 => Loss 0.130, Train_accy 78.00, Test_accy 63.66:  25%|██▌       | 5/20 [00:29<01:02,  4.16s/it]
Task 7, Epoch 6/20 => Loss 0.130, Train_accy 78.00, Test_accy 63.66:  30%|███       | 6/20 [00:29<01:11,  5.10s/it]
Task 7, Epoch 7/20 => Loss 0.089, Train_accy 79.52:  30%|███       | 6/20 [00:33<01:11,  5.10s/it]                 
Task 7, Epoch 7/20 => Loss 0.089, Train_accy 79.52:  35%|███▌      | 7/20 [00:33<01:00,  4.69s/it]
Task 7, Epoch 8/20 => Loss 0.134, Train_accy 82.79:  35%|███▌      | 7/20 [00:37<01:00,  4.69s/it]
Task 7, Epoch 8/20 => Loss 0.134, Train_accy 82.79:  40%|████      | 8/20 [00:37<00:53,  4.45s/it]
Task 7, Epoch 9/20 => Loss 0.099, Train_accy 81.26:  40%|████      | 8/20 [00:41<00:53,  4.45s/it]
Task 7, Epoch 9/20 => Loss 0.099, Train_accy 81.26:  45%|████▌     | 9/20 [00:41<00:46,  4.25s/it]
Task 7, Epoch 10/20 => Loss 0.142, Train_accy 80.61:  45%|████▌     | 9/20 [00:44<00:46,  4.25s/it]
Task 7, Epoch 10/20 => Loss 0.142, Train_accy 80.61:  50%|█████     | 10/20 [00:44<00:41,  4.11s/it]
Task 7, Epoch 11/20 => Loss 0.098, Train_accy 85.40, Test_accy 63.76:  50%|█████     | 10/20 [00:51<00:41,  4.11s/it]
Task 7, Epoch 11/20 => Loss 0.098, Train_accy 85.40, Test_accy 63.76:  55%|█████▌    | 11/20 [00:51<00:44,  4.92s/it]
Task 7, Epoch 12/20 => Loss 0.095, Train_accy 84.31:  55%|█████▌    | 11/20 [00:55<00:44,  4.92s/it]                 
Task 7, Epoch 12/20 => Loss 0.095, Train_accy 84.31:  60%|██████    | 12/20 [00:55<00:36,  4.56s/it]
Task 7, Epoch 13/20 => Loss 0.116, Train_accy 84.31:  60%|██████    | 12/20 [00:59<00:36,  4.56s/it]
Task 7, Epoch 13/20 => Loss 0.116, Train_accy 84.31:  65%|██████▌   | 13/20 [00:59<00:30,  4.34s/it]
Task 7, Epoch 14/20 => Loss 0.091, Train_accy 87.15:  65%|██████▌   | 13/20 [01:02<00:30,  4.34s/it]
Task 7, Epoch 14/20 => Loss 0.091, Train_accy 87.15:  70%|███████   | 14/20 [01:02<00:25,  4.18s/it]
Task 7, Epoch 15/20 => Loss 0.099, Train_accy 81.92:  70%|███████   | 14/20 [01:06<00:25,  4.18s/it]
Task 7, Epoch 15/20 => Loss 0.099, Train_accy 81.92:  75%|███████▌  | 15/20 [01:06<00:20,  4.07s/it]
Task 7, Epoch 16/20 => Loss 0.082, Train_accy 87.15, Test_accy 65.07:  75%|███████▌  | 15/20 [01:13<00:20,  4.07s/it]
Task 7, Epoch 16/20 => Loss 0.082, Train_accy 87.15, Test_accy 65.07:  80%|████████  | 16/20 [01:13<00:19,  4.94s/it]
Task 7, Epoch 17/20 => Loss 0.134, Train_accy 87.15:  80%|████████  | 16/20 [01:17<00:19,  4.94s/it]                 
Task 7, Epoch 17/20 => Loss 0.134, Train_accy 87.15:  85%|████████▌ | 17/20 [01:17<00:13,  4.62s/it]
Task 7, Epoch 18/20 => Loss 0.121, Train_accy 85.19:  85%|████████▌ | 17/20 [01:21<00:13,  4.62s/it]
Task 7, Epoch 18/20 => Loss 0.121, Train_accy 85.19:  90%|█████████ | 18/20 [01:21<00:08,  4.40s/it]
Task 7, Epoch 19/20 => Loss 0.101, Train_accy 85.19:  90%|█████████ | 18/20 [01:25<00:08,  4.40s/it]
Task 7, Epoch 19/20 => Loss 0.101, Train_accy 85.19:  95%|█████████▌| 19/20 [01:25<00:04,  4.22s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 85.62:  95%|█████████▌| 19/20 [01:29<00:04,  4.22s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 85.62: 100%|██████████| 20/20 [01:29<00:00,  4.11s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 85.62: 100%|██████████| 20/20 [01:29<00:00,  4.46s/it]
2024-09-04 17:33:18,388 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.121, Train_accy 85.62
2024-09-04 17:33:21,506 [trainer.py] => No NME accuracy.
2024-09-04 17:33:21,507 [trainer.py] => CNN: {'total': 66.38, '00-09': 37.29, '10-19': 62.79, '20-29': 55.67, '30-39': 48.18, '40-49': 71.96, '50-59': 65.77, '60-69': 96.23, '70-79': 89.36, 'old': 62.21, 'new': 89.36}
2024-09-04 17:33:21,507 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38]
2024-09-04 17:33:21,507 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91]

Average Accuracy (CNN): 79.42
2024-09-04 17:33:21,507 [trainer.py] => Average Accuracy (CNN): 79.42 

2024-09-04 17:33:21,508 [trainer.py] => All params: 85860176
2024-09-04 17:33:21,508 [trainer.py] => Trainable params: 85860176
2024-09-04 17:33:21,510 [finetune.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.515, Train_accy 3.69, Test_accy 61.60:   0%|          | 0/20 [00:07<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.515, Train_accy 3.69, Test_accy 61.60:   5%|▌         | 1/20 [00:07<02:20,  7.42s/it]
Task 8, Epoch 2/20 => Loss 0.289, Train_accy 34.06:   5%|▌         | 1/20 [00:11<02:20,  7.42s/it]                
Task 8, Epoch 2/20 => Loss 0.289, Train_accy 34.06:  10%|█         | 2/20 [00:11<01:36,  5.38s/it]
Task 8, Epoch 3/20 => Loss 0.273, Train_accy 63.99:  10%|█         | 2/20 [00:15<01:36,  5.38s/it]
Task 8, Epoch 3/20 => Loss 0.273, Train_accy 63.99:  15%|█▌        | 3/20 [00:15<01:19,  4.69s/it]
Task 8, Epoch 4/20 => Loss 0.174, Train_accy 77.66:  15%|█▌        | 3/20 [00:19<01:19,  4.69s/it]
Task 8, Epoch 4/20 => Loss 0.174, Train_accy 77.66:  20%|██        | 4/20 [00:19<01:10,  4.38s/it]
Task 8, Epoch 5/20 => Loss 0.172, Train_accy 78.74:  20%|██        | 4/20 [00:23<01:10,  4.38s/it]
Task 8, Epoch 5/20 => Loss 0.172, Train_accy 78.74:  25%|██▌       | 5/20 [00:23<01:02,  4.20s/it]
Task 8, Epoch 6/20 => Loss 0.146, Train_accy 83.08, Test_accy 68.63:  25%|██▌       | 5/20 [00:30<01:02,  4.20s/it]
Task 8, Epoch 6/20 => Loss 0.146, Train_accy 83.08, Test_accy 68.63:  30%|███       | 6/20 [00:30<01:13,  5.25s/it]
Task 8, Epoch 7/20 => Loss 0.140, Train_accy 83.08:  30%|███       | 6/20 [00:34<01:13,  5.25s/it]                 
Task 8, Epoch 7/20 => Loss 0.140, Train_accy 83.08:  35%|███▌      | 7/20 [00:34<01:02,  4.79s/it]
Task 8, Epoch 8/20 => Loss 0.136, Train_accy 83.73:  35%|███▌      | 7/20 [00:37<01:02,  4.79s/it]
Task 8, Epoch 8/20 => Loss 0.136, Train_accy 83.73:  40%|████      | 8/20 [00:37<00:53,  4.48s/it]
Task 8, Epoch 9/20 => Loss 0.163, Train_accy 81.56:  40%|████      | 8/20 [00:41<00:53,  4.48s/it]
Task 8, Epoch 9/20 => Loss 0.163, Train_accy 81.56:  45%|████▌     | 9/20 [00:41<00:47,  4.31s/it]
Task 8, Epoch 10/20 => Loss 0.140, Train_accy 82.86:  45%|████▌     | 9/20 [00:45<00:47,  4.31s/it]
Task 8, Epoch 10/20 => Loss 0.140, Train_accy 82.86:  50%|█████     | 10/20 [00:45<00:41,  4.19s/it]
Task 8, Epoch 11/20 => Loss 0.138, Train_accy 85.25, Test_accy 70.53:  50%|█████     | 10/20 [00:53<00:41,  4.19s/it]
Task 8, Epoch 11/20 => Loss 0.138, Train_accy 85.25, Test_accy 70.53:  55%|█████▌    | 11/20 [00:53<00:46,  5.15s/it]
Task 8, Epoch 12/20 => Loss 0.139, Train_accy 83.73:  55%|█████▌    | 11/20 [00:57<00:46,  5.15s/it]                 
Task 8, Epoch 12/20 => Loss 0.139, Train_accy 83.73:  60%|██████    | 12/20 [00:57<00:38,  4.75s/it]
Task 8, Epoch 13/20 => Loss 0.142, Train_accy 83.95:  60%|██████    | 12/20 [01:00<00:38,  4.75s/it]
Task 8, Epoch 13/20 => Loss 0.142, Train_accy 83.95:  65%|██████▌   | 13/20 [01:00<00:31,  4.48s/it]
Task 8, Epoch 14/20 => Loss 0.141, Train_accy 82.86:  65%|██████▌   | 13/20 [01:04<00:31,  4.48s/it]
Task 8, Epoch 14/20 => Loss 0.141, Train_accy 82.86:  70%|███████   | 14/20 [01:04<00:25,  4.31s/it]
Task 8, Epoch 15/20 => Loss 0.105, Train_accy 85.03:  70%|███████   | 14/20 [01:08<00:25,  4.31s/it]
Task 8, Epoch 15/20 => Loss 0.105, Train_accy 85.03:  75%|███████▌  | 15/20 [01:08<00:20,  4.18s/it]
Task 8, Epoch 16/20 => Loss 0.118, Train_accy 87.42, Test_accy 69.96:  75%|███████▌  | 15/20 [01:16<00:20,  4.18s/it]
Task 8, Epoch 16/20 => Loss 0.118, Train_accy 87.42, Test_accy 69.96:  80%|████████  | 16/20 [01:16<00:20,  5.15s/it]
Task 8, Epoch 17/20 => Loss 0.107, Train_accy 85.47:  80%|████████  | 16/20 [01:19<00:20,  5.15s/it]                 
Task 8, Epoch 17/20 => Loss 0.107, Train_accy 85.47:  85%|████████▌ | 17/20 [01:19<00:14,  4.76s/it]
Task 8, Epoch 18/20 => Loss 0.123, Train_accy 83.51:  85%|████████▌ | 17/20 [01:23<00:14,  4.76s/it]
Task 8, Epoch 18/20 => Loss 0.123, Train_accy 83.51:  90%|█████████ | 18/20 [01:23<00:08,  4.48s/it]
Task 8, Epoch 19/20 => Loss 0.092, Train_accy 82.65:  90%|█████████ | 18/20 [01:27<00:08,  4.48s/it]
Task 8, Epoch 19/20 => Loss 0.092, Train_accy 82.65:  95%|█████████▌| 19/20 [01:27<00:04,  4.30s/it]
Task 8, Epoch 20/20 => Loss 0.087, Train_accy 87.64:  95%|█████████▌| 19/20 [01:31<00:04,  4.30s/it]
Task 8, Epoch 20/20 => Loss 0.087, Train_accy 87.64: 100%|██████████| 20/20 [01:31<00:00,  4.17s/it]
Task 8, Epoch 20/20 => Loss 0.087, Train_accy 87.64: 100%|██████████| 20/20 [01:31<00:00,  4.57s/it]
2024-09-04 17:34:52,999 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.087, Train_accy 87.64
2024-09-04 17:34:56,446 [trainer.py] => No NME accuracy.
2024-09-04 17:34:56,447 [trainer.py] => CNN: {'total': 70.06, '00-09': 33.05, '10-19': 59.69, '20-29': 65.98, '30-39': 50.91, '40-49': 67.29, '50-59': 64.86, '60-69': 92.45, '70-79': 94.33, '80-89': 94.74, 'old': 66.49, 'new': 94.74}
2024-09-04 17:34:56,447 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06]
2024-09-04 17:34:56,447 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73]

Average Accuracy (CNN): 78.38
2024-09-04 17:34:56,447 [trainer.py] => Average Accuracy (CNN): 78.38 

2024-09-04 17:34:56,448 [trainer.py] => All params: 85867866
2024-09-04 17:34:56,448 [trainer.py] => Trainable params: 85867866
2024-09-04 17:34:56,450 [finetune.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.754, Train_accy 1.99, Test_accy 56.90:   0%|          | 0/20 [00:07<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.754, Train_accy 1.99, Test_accy 56.90:   5%|▌         | 1/20 [00:07<02:24,  7.60s/it]
Task 9, Epoch 2/20 => Loss 0.367, Train_accy 39.51:   5%|▌         | 1/20 [00:11<02:24,  7.60s/it]                
Task 9, Epoch 2/20 => Loss 0.367, Train_accy 39.51:  10%|█         | 2/20 [00:11<01:36,  5.36s/it]
Task 9, Epoch 3/20 => Loss 0.251, Train_accy 70.64:  10%|█         | 2/20 [00:15<01:36,  5.36s/it]
Task 9, Epoch 3/20 => Loss 0.251, Train_accy 70.64:  15%|█▌        | 3/20 [00:15<01:18,  4.63s/it]
Task 9, Epoch 4/20 => Loss 0.275, Train_accy 80.35:  15%|█▌        | 3/20 [00:19<01:18,  4.63s/it]
Task 9, Epoch 4/20 => Loss 0.275, Train_accy 80.35:  20%|██        | 4/20 [00:19<01:09,  4.32s/it]
Task 9, Epoch 5/20 => Loss 0.273, Train_accy 82.56:  20%|██        | 4/20 [00:22<01:09,  4.32s/it]
Task 9, Epoch 5/20 => Loss 0.273, Train_accy 82.56:  25%|██▌       | 5/20 [00:22<01:02,  4.14s/it]
Task 9, Epoch 6/20 => Loss 0.178, Train_accy 87.42, Test_accy 61.11:  25%|██▌       | 5/20 [00:30<01:02,  4.14s/it]
Task 9, Epoch 6/20 => Loss 0.178, Train_accy 87.42, Test_accy 61.11:  30%|███       | 6/20 [00:30<01:14,  5.32s/it]
Task 9, Epoch 7/20 => Loss 0.138, Train_accy 84.11:  30%|███       | 6/20 [00:34<01:14,  5.32s/it]                 
Task 9, Epoch 7/20 => Loss 0.138, Train_accy 84.11:  35%|███▌      | 7/20 [00:34<01:02,  4.81s/it]
Task 9, Epoch 8/20 => Loss 0.140, Train_accy 88.30:  35%|███▌      | 7/20 [00:38<01:02,  4.81s/it]
Task 9, Epoch 8/20 => Loss 0.140, Train_accy 88.30:  40%|████      | 8/20 [00:38<00:54,  4.50s/it]
Task 9, Epoch 9/20 => Loss 0.163, Train_accy 88.08:  40%|████      | 8/20 [00:41<00:54,  4.50s/it]
Task 9, Epoch 9/20 => Loss 0.163, Train_accy 88.08:  45%|████▌     | 9/20 [00:41<00:47,  4.29s/it]
Task 9, Epoch 10/20 => Loss 0.152, Train_accy 89.18:  45%|████▌     | 9/20 [00:45<00:47,  4.29s/it]
Task 9, Epoch 10/20 => Loss 0.152, Train_accy 89.18:  50%|█████     | 10/20 [00:45<00:41,  4.13s/it]
Task 9, Epoch 11/20 => Loss 0.158, Train_accy 89.85, Test_accy 62.37:  50%|█████     | 10/20 [00:53<00:41,  4.13s/it]
Task 9, Epoch 11/20 => Loss 0.158, Train_accy 89.85, Test_accy 62.37:  55%|█████▌    | 11/20 [00:53<00:46,  5.19s/it]
Task 9, Epoch 12/20 => Loss 0.099, Train_accy 92.72:  55%|█████▌    | 11/20 [00:57<00:46,  5.19s/it]                 
Task 9, Epoch 12/20 => Loss 0.099, Train_accy 92.72:  60%|██████    | 12/20 [00:57<00:38,  4.77s/it]
Task 9, Epoch 13/20 => Loss 0.105, Train_accy 92.72:  60%|██████    | 12/20 [01:00<00:38,  4.77s/it]
Task 9, Epoch 13/20 => Loss 0.105, Train_accy 92.72:  65%|██████▌   | 13/20 [01:00<00:31,  4.48s/it]
Task 9, Epoch 14/20 => Loss 0.110, Train_accy 93.38:  65%|██████▌   | 13/20 [01:04<00:31,  4.48s/it]
Task 9, Epoch 14/20 => Loss 0.110, Train_accy 93.38:  70%|███████   | 14/20 [01:04<00:25,  4.27s/it]
Task 9, Epoch 15/20 => Loss 0.141, Train_accy 90.95:  70%|███████   | 14/20 [01:08<00:25,  4.27s/it]
Task 9, Epoch 15/20 => Loss 0.141, Train_accy 90.95:  75%|███████▌  | 15/20 [01:08<00:20,  4.13s/it]
Task 9, Epoch 16/20 => Loss 0.119, Train_accy 89.62, Test_accy 62.71:  75%|███████▌  | 15/20 [01:16<00:20,  4.13s/it]
Task 9, Epoch 16/20 => Loss 0.119, Train_accy 89.62, Test_accy 62.71:  80%|████████  | 16/20 [01:16<00:20,  5.18s/it]
Task 9, Epoch 17/20 => Loss 0.122, Train_accy 91.17:  80%|████████  | 16/20 [01:19<00:20,  5.18s/it]                 
Task 9, Epoch 17/20 => Loss 0.122, Train_accy 91.17:  85%|████████▌ | 17/20 [01:19<00:14,  4.76s/it]
Task 9, Epoch 18/20 => Loss 0.141, Train_accy 90.07:  85%|████████▌ | 17/20 [01:23<00:14,  4.76s/it]
Task 9, Epoch 18/20 => Loss 0.141, Train_accy 90.07:  90%|█████████ | 18/20 [01:23<00:08,  4.48s/it]
Task 9, Epoch 19/20 => Loss 0.093, Train_accy 93.16:  90%|█████████ | 18/20 [01:27<00:08,  4.48s/it]
Task 9, Epoch 19/20 => Loss 0.093, Train_accy 93.16:  95%|█████████▌| 19/20 [01:27<00:04,  4.27s/it]
Task 9, Epoch 20/20 => Loss 0.150, Train_accy 90.73:  95%|█████████▌| 19/20 [01:31<00:04,  4.27s/it]
Task 9, Epoch 20/20 => Loss 0.150, Train_accy 90.73: 100%|██████████| 20/20 [01:31<00:00,  4.15s/it]
Task 9, Epoch 20/20 => Loss 0.150, Train_accy 90.73: 100%|██████████| 20/20 [01:31<00:00,  4.57s/it]
2024-09-04 17:36:27,773 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.150, Train_accy 90.73
2024-09-04 17:36:31,676 [trainer.py] => No NME accuracy.
2024-09-04 17:36:31,677 [trainer.py] => CNN: {'total': 62.04, '00-09': 24.58, '10-19': 54.26, '20-29': 47.42, '30-39': 39.09, '40-49': 51.4, '50-59': 53.15, '60-69': 76.42, '70-79': 80.85, '80-89': 85.71, '90-99': 92.65, 'old': 58.08, 'new': 92.65}
2024-09-04 17:36:31,677 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04]
2024-09-04 17:36:31,677 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68]

Average Accuracy (CNN): 76.74
2024-09-04 17:36:31,677 [trainer.py] => Average Accuracy (CNN): 76.74 

2024-09-04 17:36:31,678 [trainer.py] => All params: 85875556
2024-09-04 17:36:31,679 [trainer.py] => Trainable params: 85875556
2024-09-04 17:36:31,681 [finetune.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.170, Train_accy 6.03, Test_accy 58.56:   0%|          | 0/20 [00:08<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.170, Train_accy 6.03, Test_accy 58.56:   5%|▌         | 1/20 [00:08<02:37,  8.27s/it]
Task 10, Epoch 2/20 => Loss 0.279, Train_accy 53.64:   5%|▌         | 1/20 [00:12<02:37,  8.27s/it]                
Task 10, Epoch 2/20 => Loss 0.279, Train_accy 53.64:  10%|█         | 2/20 [00:12<01:43,  5.76s/it]
Task 10, Epoch 3/20 => Loss 0.123, Train_accy 77.55:  10%|█         | 2/20 [00:16<01:43,  5.76s/it]
Task 10, Epoch 3/20 => Loss 0.123, Train_accy 77.55:  15%|█▌        | 3/20 [00:16<01:24,  4.97s/it]
Task 10, Epoch 4/20 => Loss 0.158, Train_accy 83.99:  15%|█▌        | 3/20 [00:20<01:24,  4.97s/it]
Task 10, Epoch 4/20 => Loss 0.158, Train_accy 83.99:  20%|██        | 4/20 [00:20<01:13,  4.59s/it]
Task 10, Epoch 5/20 => Loss 0.141, Train_accy 86.69:  20%|██        | 4/20 [00:24<01:13,  4.59s/it]
Task 10, Epoch 5/20 => Loss 0.141, Train_accy 86.69:  25%|██▌       | 5/20 [00:24<01:06,  4.40s/it]
Task 10, Epoch 6/20 => Loss 0.149, Train_accy 87.32, Test_accy 62.85:  25%|██▌       | 5/20 [00:32<01:06,  4.40s/it]
Task 10, Epoch 6/20 => Loss 0.149, Train_accy 87.32, Test_accy 62.85:  30%|███       | 6/20 [00:32<01:19,  5.68s/it]
Task 10, Epoch 7/20 => Loss 0.601, Train_accy 81.91:  30%|███       | 6/20 [00:36<01:19,  5.68s/it]                 
Task 10, Epoch 7/20 => Loss 0.601, Train_accy 81.91:  35%|███▌      | 7/20 [00:36<01:06,  5.13s/it]
Task 10, Epoch 8/20 => Loss 0.291, Train_accy 79.83:  35%|███▌      | 7/20 [00:40<01:06,  5.13s/it]
Task 10, Epoch 8/20 => Loss 0.291, Train_accy 79.83:  40%|████      | 8/20 [00:40<00:57,  4.76s/it]
Task 10, Epoch 9/20 => Loss 0.298, Train_accy 83.58:  40%|████      | 8/20 [00:44<00:57,  4.76s/it]
Task 10, Epoch 9/20 => Loss 0.298, Train_accy 83.58:  45%|████▌     | 9/20 [00:44<00:49,  4.53s/it]
Task 10, Epoch 10/20 => Loss 0.560, Train_accy 76.09:  45%|████▌     | 9/20 [00:48<00:49,  4.53s/it]
Task 10, Epoch 10/20 => Loss 0.560, Train_accy 76.09:  50%|█████     | 10/20 [00:48<00:43,  4.37s/it]
Task 10, Epoch 11/20 => Loss 0.406, Train_accy 77.13, Test_accy 42.98:  50%|█████     | 10/20 [00:56<00:43,  4.37s/it]
Task 10, Epoch 11/20 => Loss 0.406, Train_accy 77.13, Test_accy 42.98:  55%|█████▌    | 11/20 [00:56<00:50,  5.59s/it]
Task 10, Epoch 12/20 => Loss 0.738, Train_accy 62.58:  55%|█████▌    | 11/20 [01:00<00:50,  5.59s/it]                 
Task 10, Epoch 12/20 => Loss 0.738, Train_accy 62.58:  60%|██████    | 12/20 [01:00<00:40,  5.11s/it]
Task 10, Epoch 13/20 => Loss 0.378, Train_accy 75.88:  60%|██████    | 12/20 [01:04<00:40,  5.11s/it]
Task 10, Epoch 13/20 => Loss 0.378, Train_accy 75.88:  65%|██████▌   | 13/20 [01:04<00:33,  4.77s/it]
Task 10, Epoch 14/20 => Loss 0.595, Train_accy 77.13:  65%|██████▌   | 13/20 [01:08<00:33,  4.77s/it]
Task 10, Epoch 14/20 => Loss 0.595, Train_accy 77.13:  70%|███████   | 14/20 [01:08<00:27,  4.56s/it]
Task 10, Epoch 15/20 => Loss 0.291, Train_accy 80.04:  70%|███████   | 14/20 [01:13<00:27,  4.56s/it]
Task 10, Epoch 15/20 => Loss 0.291, Train_accy 80.04:  75%|███████▌  | 15/20 [01:13<00:22,  4.42s/it]
Task 10, Epoch 16/20 => Loss 0.166, Train_accy 86.49, Test_accy 43.44:  75%|███████▌  | 15/20 [01:21<00:22,  4.42s/it]
Task 10, Epoch 16/20 => Loss 0.166, Train_accy 86.49, Test_accy 43.44:  80%|████████  | 16/20 [01:21<00:22,  5.58s/it]
Task 10, Epoch 17/20 => Loss 0.153, Train_accy 87.73:  80%|████████  | 16/20 [01:25<00:22,  5.58s/it]                 
Task 10, Epoch 17/20 => Loss 0.153, Train_accy 87.73:  85%|████████▌ | 17/20 [01:25<00:15,  5.13s/it]
Task 10, Epoch 18/20 => Loss 0.127, Train_accy 86.07:  85%|████████▌ | 17/20 [01:29<00:15,  5.13s/it]
Task 10, Epoch 18/20 => Loss 0.127, Train_accy 86.07:  90%|█████████ | 18/20 [01:29<00:09,  4.81s/it]
Task 10, Epoch 19/20 => Loss 0.151, Train_accy 87.94:  90%|█████████ | 18/20 [01:33<00:09,  4.81s/it]
Task 10, Epoch 19/20 => Loss 0.151, Train_accy 87.94:  95%|█████████▌| 19/20 [01:33<00:04,  4.57s/it]
Task 10, Epoch 20/20 => Loss 0.128, Train_accy 89.40:  95%|█████████▌| 19/20 [01:37<00:04,  4.57s/it]
Task 10, Epoch 20/20 => Loss 0.128, Train_accy 89.40: 100%|██████████| 20/20 [01:37<00:00,  4.41s/it]
Task 10, Epoch 20/20 => Loss 0.128, Train_accy 89.40: 100%|██████████| 20/20 [01:37<00:00,  4.88s/it]
2024-09-04 17:38:09,241 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.128, Train_accy 89.40
2024-09-04 17:38:13,355 [trainer.py] => No NME accuracy.
2024-09-04 17:38:13,355 [trainer.py] => CNN: {'total': 46.82, '00-09': 9.32, '10-19': 33.33, '20-29': 23.71, '30-39': 40.0, '40-49': 33.64, '50-59': 30.63, '60-69': 64.15, '70-79': 49.65, '80-89': 60.15, '90-99': 73.53, '100-109': 87.83, 'old': 42.85, 'new': 87.83}
2024-09-04 17:38:13,355 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82]
2024-09-04 17:38:13,355 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27]

Average Accuracy (CNN): 74.02
2024-09-04 17:38:13,355 [trainer.py] => Average Accuracy (CNN): 74.02 

2024-09-04 17:38:13,356 [trainer.py] => All params: 85883246
2024-09-04 17:38:13,356 [trainer.py] => Trainable params: 85883246
2024-09-04 17:38:13,358 [finetune.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.718, Train_accy 0.00, Test_accy 33.05:   0%|          | 0/20 [00:08<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.718, Train_accy 0.00, Test_accy 33.05:   5%|▌         | 1/20 [00:08<02:38,  8.34s/it]
Task 11, Epoch 2/20 => Loss 0.438, Train_accy 10.83:   5%|▌         | 1/20 [00:12<02:38,  8.34s/it]                
Task 11, Epoch 2/20 => Loss 0.438, Train_accy 10.83:  10%|█         | 2/20 [00:12<01:43,  5.73s/it]
Task 11, Epoch 3/20 => Loss 0.216, Train_accy 35.67:  10%|█         | 2/20 [00:16<01:43,  5.73s/it]
Task 11, Epoch 3/20 => Loss 0.216, Train_accy 35.67:  15%|█▌        | 3/20 [00:16<01:23,  4.93s/it]
Task 11, Epoch 4/20 => Loss 0.195, Train_accy 46.71:  15%|█▌        | 3/20 [00:20<01:23,  4.93s/it]
Task 11, Epoch 4/20 => Loss 0.195, Train_accy 46.71:  20%|██        | 4/20 [00:20<01:12,  4.53s/it]
Task 11, Epoch 5/20 => Loss 0.187, Train_accy 61.57:  20%|██        | 4/20 [00:24<01:12,  4.53s/it]
Task 11, Epoch 5/20 => Loss 0.187, Train_accy 61.57:  25%|██▌       | 5/20 [00:24<01:04,  4.32s/it]
Task 11, Epoch 6/20 => Loss 0.157, Train_accy 62.21, Test_accy 39.97:  25%|██▌       | 5/20 [00:32<01:04,  4.32s/it]
Task 11, Epoch 6/20 => Loss 0.157, Train_accy 62.21, Test_accy 39.97:  30%|███       | 6/20 [00:32<01:20,  5.73s/it]
Task 11, Epoch 7/20 => Loss 0.161, Train_accy 61.78:  30%|███       | 6/20 [00:36<01:20,  5.73s/it]                 
Task 11, Epoch 7/20 => Loss 0.161, Train_accy 61.78:  35%|███▌      | 7/20 [00:36<01:06,  5.15s/it]
Task 11, Epoch 8/20 => Loss 0.138, Train_accy 66.24:  35%|███▌      | 7/20 [00:40<01:06,  5.15s/it]
Task 11, Epoch 8/20 => Loss 0.138, Train_accy 66.24:  40%|████      | 8/20 [00:40<00:57,  4.76s/it]
Task 11, Epoch 9/20 => Loss 0.109, Train_accy 71.55:  40%|████      | 8/20 [00:44<00:57,  4.76s/it]
Task 11, Epoch 9/20 => Loss 0.109, Train_accy 71.55:  45%|████▌     | 9/20 [00:44<00:49,  4.51s/it]
Task 11, Epoch 10/20 => Loss 0.150, Train_accy 69.64:  45%|████▌     | 9/20 [00:48<00:49,  4.51s/it]
Task 11, Epoch 10/20 => Loss 0.150, Train_accy 69.64:  50%|█████     | 10/20 [00:48<00:43,  4.33s/it]
Task 11, Epoch 11/20 => Loss 0.164, Train_accy 69.64, Test_accy 43.57:  50%|█████     | 10/20 [00:56<00:43,  4.33s/it]
Task 11, Epoch 11/20 => Loss 0.164, Train_accy 69.64, Test_accy 43.57:  55%|█████▌    | 11/20 [00:56<00:50,  5.61s/it]
Task 11, Epoch 12/20 => Loss 0.137, Train_accy 71.34:  55%|█████▌    | 11/20 [01:00<00:50,  5.61s/it]                 
Task 11, Epoch 12/20 => Loss 0.137, Train_accy 71.34:  60%|██████    | 12/20 [01:00<00:40,  5.11s/it]
Task 11, Epoch 13/20 => Loss 0.091, Train_accy 70.06:  60%|██████    | 12/20 [01:04<00:40,  5.11s/it]
Task 11, Epoch 13/20 => Loss 0.091, Train_accy 70.06:  65%|██████▌   | 13/20 [01:04<00:33,  4.75s/it]
Task 11, Epoch 14/20 => Loss 0.092, Train_accy 77.07:  65%|██████▌   | 13/20 [01:08<00:33,  4.75s/it]
Task 11, Epoch 14/20 => Loss 0.092, Train_accy 77.07:  70%|███████   | 14/20 [01:08<00:26,  4.49s/it]
Task 11, Epoch 15/20 => Loss 0.095, Train_accy 77.92:  70%|███████   | 14/20 [01:12<00:26,  4.49s/it]
Task 11, Epoch 15/20 => Loss 0.095, Train_accy 77.92:  75%|███████▌  | 15/20 [01:12<00:21,  4.31s/it]
Task 11, Epoch 16/20 => Loss 0.101, Train_accy 77.28, Test_accy 44.28:  75%|███████▌  | 15/20 [01:20<00:21,  4.31s/it]
Task 11, Epoch 16/20 => Loss 0.101, Train_accy 77.28, Test_accy 44.28:  80%|████████  | 16/20 [01:20<00:22,  5.55s/it]
Task 11, Epoch 17/20 => Loss 0.070, Train_accy 76.86:  80%|████████  | 16/20 [01:24<00:22,  5.55s/it]                 
Task 11, Epoch 17/20 => Loss 0.070, Train_accy 76.86:  85%|████████▌ | 17/20 [01:24<00:15,  5.08s/it]
Task 11, Epoch 18/20 => Loss 0.084, Train_accy 77.92:  85%|████████▌ | 17/20 [01:28<00:15,  5.08s/it]
Task 11, Epoch 18/20 => Loss 0.084, Train_accy 77.92:  90%|█████████ | 18/20 [01:28<00:09,  4.73s/it]
Task 11, Epoch 19/20 => Loss 0.111, Train_accy 74.31:  90%|█████████ | 18/20 [01:32<00:09,  4.73s/it]
Task 11, Epoch 19/20 => Loss 0.111, Train_accy 74.31:  95%|█████████▌| 19/20 [01:32<00:04,  4.52s/it]
Task 11, Epoch 20/20 => Loss 0.078, Train_accy 79.41:  95%|█████████▌| 19/20 [01:36<00:04,  4.52s/it]
Task 11, Epoch 20/20 => Loss 0.078, Train_accy 79.41: 100%|██████████| 20/20 [01:36<00:00,  4.34s/it]
Task 11, Epoch 20/20 => Loss 0.078, Train_accy 79.41: 100%|██████████| 20/20 [01:36<00:00,  4.84s/it]
2024-09-04 17:39:50,149 [finetune.py] => Task 11, Epoch 20/20 => Loss 0.078, Train_accy 79.41
2024-09-04 17:39:54,632 [trainer.py] => No NME accuracy.
2024-09-04 17:39:54,632 [trainer.py] => CNN: {'total': 44.84, '00-09': 11.02, '10-19': 33.33, '20-29': 23.71, '30-39': 23.64, '40-49': 36.45, '50-59': 34.23, '60-69': 51.89, '70-79': 46.81, '80-89': 48.87, '90-99': 59.56, '100-109': 86.09, '110-119': 76.99, 'old': 42.06, 'new': 76.99}
2024-09-04 17:39:54,632 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84]
2024-09-04 17:39:54,632 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91]

Average Accuracy (CNN): 71.59
2024-09-04 17:39:54,633 [trainer.py] => Average Accuracy (CNN): 71.59 

2024-09-04 17:39:54,634 [trainer.py] => All params: 85890936
2024-09-04 17:39:54,635 [trainer.py] => Trainable params: 85890936
2024-09-04 17:39:54,637 [finetune.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.598, Train_accy 0.00, Test_accy 41.96:   0%|          | 0/20 [00:08<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.598, Train_accy 0.00, Test_accy 41.96:   5%|▌         | 1/20 [00:08<02:48,  8.89s/it]
Task 12, Epoch 2/20 => Loss 0.939, Train_accy 25.52:   5%|▌         | 1/20 [00:12<02:48,  8.89s/it]                
Task 12, Epoch 2/20 => Loss 0.939, Train_accy 25.52:  10%|█         | 2/20 [00:12<01:48,  6.03s/it]
Task 12, Epoch 3/20 => Loss 0.645, Train_accy 54.56:  10%|█         | 2/20 [00:16<01:48,  6.03s/it]
Task 12, Epoch 3/20 => Loss 0.645, Train_accy 54.56:  15%|█▌        | 3/20 [00:16<01:26,  5.10s/it]
Task 12, Epoch 4/20 => Loss 0.490, Train_accy 60.58:  15%|█▌        | 3/20 [00:20<01:26,  5.10s/it]
Task 12, Epoch 4/20 => Loss 0.490, Train_accy 60.58:  20%|██        | 4/20 [00:20<01:15,  4.70s/it]
Task 12, Epoch 5/20 => Loss 0.381, Train_accy 65.35:  20%|██        | 4/20 [00:25<01:15,  4.70s/it]
Task 12, Epoch 5/20 => Loss 0.381, Train_accy 65.35:  25%|██▌       | 5/20 [00:25<01:06,  4.46s/it]
Task 12, Epoch 6/20 => Loss 0.271, Train_accy 72.41, Test_accy 43.66:  25%|██▌       | 5/20 [00:33<01:06,  4.46s/it]
Task 12, Epoch 6/20 => Loss 0.271, Train_accy 72.41, Test_accy 43.66:  30%|███       | 6/20 [00:33<01:23,  5.97s/it]
Task 12, Epoch 7/20 => Loss 0.230, Train_accy 71.37:  30%|███       | 6/20 [00:37<01:23,  5.97s/it]                 
Task 12, Epoch 7/20 => Loss 0.230, Train_accy 71.37:  35%|███▌      | 7/20 [00:37<01:09,  5.34s/it]
Task 12, Epoch 8/20 => Loss 0.256, Train_accy 72.82:  35%|███▌      | 7/20 [00:42<01:09,  5.34s/it]
Task 12, Epoch 8/20 => Loss 0.256, Train_accy 72.82:  40%|████      | 8/20 [00:42<00:59,  4.95s/it]
Task 12, Epoch 9/20 => Loss 0.271, Train_accy 77.18:  40%|████      | 8/20 [00:46<00:59,  4.95s/it]
Task 12, Epoch 9/20 => Loss 0.271, Train_accy 77.18:  45%|████▌     | 9/20 [00:46<00:51,  4.67s/it]
Task 12, Epoch 10/20 => Loss 0.309, Train_accy 76.14:  45%|████▌     | 9/20 [00:50<00:51,  4.67s/it]
Task 12, Epoch 10/20 => Loss 0.309, Train_accy 76.14:  50%|█████     | 10/20 [00:50<00:44,  4.48s/it]
Task 12, Epoch 11/20 => Loss 0.247, Train_accy 79.25, Test_accy 46.16:  50%|█████     | 10/20 [00:59<00:44,  4.48s/it]
Task 12, Epoch 11/20 => Loss 0.247, Train_accy 79.25, Test_accy 46.16:  55%|█████▌    | 11/20 [00:59<00:52,  5.85s/it]
Task 12, Epoch 12/20 => Loss 0.211, Train_accy 78.42:  55%|█████▌    | 11/20 [01:03<00:52,  5.85s/it]                 
Task 12, Epoch 12/20 => Loss 0.211, Train_accy 78.42:  60%|██████    | 12/20 [01:03<00:42,  5.29s/it]
Task 12, Epoch 13/20 => Loss 0.152, Train_accy 78.22:  60%|██████    | 12/20 [01:07<00:42,  5.29s/it]
Task 12, Epoch 13/20 => Loss 0.152, Train_accy 78.22:  65%|██████▌   | 13/20 [01:07<00:34,  4.90s/it]
Task 12, Epoch 14/20 => Loss 0.155, Train_accy 82.16:  65%|██████▌   | 13/20 [01:11<00:34,  4.90s/it]
Task 12, Epoch 14/20 => Loss 0.155, Train_accy 82.16:  70%|███████   | 14/20 [01:11<00:27,  4.63s/it]
Task 12, Epoch 15/20 => Loss 0.164, Train_accy 85.27:  70%|███████   | 14/20 [01:15<00:27,  4.63s/it]
Task 12, Epoch 15/20 => Loss 0.164, Train_accy 85.27:  75%|███████▌  | 15/20 [01:15<00:22,  4.44s/it]
Task 12, Epoch 16/20 => Loss 0.178, Train_accy 83.61, Test_accy 46.22:  75%|███████▌  | 15/20 [01:24<00:22,  4.44s/it]
Task 12, Epoch 16/20 => Loss 0.178, Train_accy 83.61, Test_accy 46.22:  80%|████████  | 16/20 [01:24<00:23,  5.77s/it]
Task 12, Epoch 17/20 => Loss 0.123, Train_accy 85.48:  80%|████████  | 16/20 [01:28<00:23,  5.77s/it]                 
Task 12, Epoch 17/20 => Loss 0.123, Train_accy 85.48:  85%|████████▌ | 17/20 [01:28<00:15,  5.23s/it]
Task 12, Epoch 18/20 => Loss 0.213, Train_accy 85.89:  85%|████████▌ | 17/20 [01:32<00:15,  5.23s/it]
Task 12, Epoch 18/20 => Loss 0.213, Train_accy 85.89:  90%|█████████ | 18/20 [01:32<00:09,  4.86s/it]
Task 12, Epoch 19/20 => Loss 0.243, Train_accy 82.99:  90%|█████████ | 18/20 [01:36<00:09,  4.86s/it]
Task 12, Epoch 19/20 => Loss 0.243, Train_accy 82.99:  95%|█████████▌| 19/20 [01:36<00:04,  4.61s/it]
Task 12, Epoch 20/20 => Loss 0.208, Train_accy 80.91:  95%|█████████▌| 19/20 [01:40<00:04,  4.61s/it]
Task 12, Epoch 20/20 => Loss 0.208, Train_accy 80.91: 100%|██████████| 20/20 [01:40<00:00,  4.43s/it]
Task 12, Epoch 20/20 => Loss 0.208, Train_accy 80.91: 100%|██████████| 20/20 [01:40<00:00,  5.00s/it]
2024-09-04 17:41:34,714 [finetune.py] => Task 12, Epoch 20/20 => Loss 0.208, Train_accy 80.91
2024-09-04 17:41:39,483 [trainer.py] => No NME accuracy.
2024-09-04 17:41:39,484 [trainer.py] => CNN: {'total': 44.12, '00-09': 5.93, '10-19': 37.21, '20-29': 22.68, '30-39': 21.82, '40-49': 42.99, '50-59': 23.42, '60-69': 35.85, '70-79': 49.65, '80-89': 45.11, '90-99': 53.68, '100-109': 80.87, '110-119': 66.37, '120-129': 84.11, 'old': 41.1, 'new': 84.11}
2024-09-04 17:41:39,484 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12]
2024-09-04 17:41:39,484 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89]

Average Accuracy (CNN): 69.48
2024-09-04 17:41:39,484 [trainer.py] => Average Accuracy (CNN): 69.48 

2024-09-04 17:41:39,485 [trainer.py] => All params: 85898626
2024-09-04 17:41:39,485 [trainer.py] => Trainable params: 85898626
2024-09-04 17:41:39,487 [finetune.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.706, Train_accy 0.64, Test_accy 41.07:   0%|          | 0/20 [00:09<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.706, Train_accy 0.64, Test_accy 41.07:   5%|▌         | 1/20 [00:09<02:53,  9.13s/it]
Task 13, Epoch 2/20 => Loss 0.473, Train_accy 26.91:   5%|▌         | 1/20 [00:13<02:53,  9.13s/it]                
Task 13, Epoch 2/20 => Loss 0.473, Train_accy 26.91:  10%|█         | 2/20 [00:13<01:49,  6.10s/it]
Task 13, Epoch 3/20 => Loss 0.328, Train_accy 56.36:  10%|█         | 2/20 [00:17<01:49,  6.10s/it]
Task 13, Epoch 3/20 => Loss 0.328, Train_accy 56.36:  15%|█▌        | 3/20 [00:17<01:27,  5.13s/it]
Task 13, Epoch 4/20 => Loss 0.265, Train_accy 70.13:  15%|█▌        | 3/20 [00:21<01:27,  5.13s/it]
Task 13, Epoch 4/20 => Loss 0.265, Train_accy 70.13:  20%|██        | 4/20 [00:21<01:14,  4.67s/it]
Task 13, Epoch 5/20 => Loss 0.223, Train_accy 75.21:  20%|██        | 4/20 [00:24<01:14,  4.67s/it]
Task 13, Epoch 5/20 => Loss 0.223, Train_accy 75.21:  25%|██▌       | 5/20 [00:24<01:06,  4.41s/it]
Task 13, Epoch 6/20 => Loss 0.177, Train_accy 78.39, Test_accy 46.31:  25%|██▌       | 5/20 [00:34<01:06,  4.41s/it]
Task 13, Epoch 6/20 => Loss 0.177, Train_accy 78.39, Test_accy 46.31:  30%|███       | 6/20 [00:34<01:23,  5.98s/it]
Task 13, Epoch 7/20 => Loss 0.190, Train_accy 79.45:  30%|███       | 6/20 [00:37<01:23,  5.98s/it]                 
Task 13, Epoch 7/20 => Loss 0.190, Train_accy 79.45:  35%|███▌      | 7/20 [00:37<01:09,  5.31s/it]
Task 13, Epoch 8/20 => Loss 0.197, Train_accy 80.51:  35%|███▌      | 7/20 [00:41<01:09,  5.31s/it]
Task 13, Epoch 8/20 => Loss 0.197, Train_accy 80.51:  40%|████      | 8/20 [00:41<00:58,  4.85s/it]
Task 13, Epoch 9/20 => Loss 0.200, Train_accy 81.99:  40%|████      | 8/20 [00:45<00:58,  4.85s/it]
Task 13, Epoch 9/20 => Loss 0.200, Train_accy 81.99:  45%|████▌     | 9/20 [00:45<00:50,  4.56s/it]
Task 13, Epoch 10/20 => Loss 0.157, Train_accy 82.20:  45%|████▌     | 9/20 [00:49<00:50,  4.56s/it]
Task 13, Epoch 10/20 => Loss 0.157, Train_accy 82.20:  50%|█████     | 10/20 [00:49<00:43,  4.36s/it]
Task 13, Epoch 11/20 => Loss 0.165, Train_accy 82.84, Test_accy 49.18:  50%|█████     | 10/20 [00:58<00:43,  4.36s/it]
Task 13, Epoch 11/20 => Loss 0.165, Train_accy 82.84, Test_accy 49.18:  55%|█████▌    | 11/20 [00:58<00:51,  5.77s/it]
Task 13, Epoch 12/20 => Loss 0.154, Train_accy 83.47:  55%|█████▌    | 11/20 [01:02<00:51,  5.77s/it]                 
Task 13, Epoch 12/20 => Loss 0.154, Train_accy 83.47:  60%|██████    | 12/20 [01:02<00:41,  5.20s/it]
Task 13, Epoch 13/20 => Loss 0.148, Train_accy 82.84:  60%|██████    | 12/20 [01:06<00:41,  5.20s/it]
Task 13, Epoch 13/20 => Loss 0.148, Train_accy 82.84:  65%|██████▌   | 13/20 [01:06<00:33,  4.81s/it]
Task 13, Epoch 14/20 => Loss 0.157, Train_accy 83.05:  65%|██████▌   | 13/20 [01:10<00:33,  4.81s/it]
Task 13, Epoch 14/20 => Loss 0.157, Train_accy 83.05:  70%|███████   | 14/20 [01:10<00:27,  4.55s/it]
Task 13, Epoch 15/20 => Loss 0.161, Train_accy 82.20:  70%|███████   | 14/20 [01:14<00:27,  4.55s/it]
Task 13, Epoch 15/20 => Loss 0.161, Train_accy 82.20:  75%|███████▌  | 15/20 [01:14<00:21,  4.39s/it]
Task 13, Epoch 16/20 => Loss 0.124, Train_accy 85.59, Test_accy 49.48:  75%|███████▌  | 15/20 [01:23<00:21,  4.39s/it]
Task 13, Epoch 16/20 => Loss 0.124, Train_accy 85.59, Test_accy 49.48:  80%|████████  | 16/20 [01:23<00:23,  5.89s/it]
Task 13, Epoch 17/20 => Loss 0.114, Train_accy 85.59:  80%|████████  | 16/20 [01:27<00:23,  5.89s/it]                 
Task 13, Epoch 17/20 => Loss 0.114, Train_accy 85.59:  85%|████████▌ | 17/20 [01:27<00:15,  5.32s/it]
Task 13, Epoch 18/20 => Loss 0.161, Train_accy 83.90:  85%|████████▌ | 17/20 [01:31<00:15,  5.32s/it]
Task 13, Epoch 18/20 => Loss 0.161, Train_accy 83.90:  90%|█████████ | 18/20 [01:31<00:09,  4.91s/it]
Task 13, Epoch 19/20 => Loss 0.117, Train_accy 86.65:  90%|█████████ | 18/20 [01:35<00:09,  4.91s/it]
Task 13, Epoch 19/20 => Loss 0.117, Train_accy 86.65:  95%|█████████▌| 19/20 [01:35<00:04,  4.62s/it]
Task 13, Epoch 20/20 => Loss 0.149, Train_accy 87.92:  95%|█████████▌| 19/20 [01:39<00:04,  4.62s/it]
Task 13, Epoch 20/20 => Loss 0.149, Train_accy 87.92: 100%|██████████| 20/20 [01:39<00:00,  4.41s/it]
Task 13, Epoch 20/20 => Loss 0.149, Train_accy 87.92: 100%|██████████| 20/20 [01:39<00:00,  4.98s/it]
2024-09-04 17:43:19,077 [finetune.py] => Task 13, Epoch 20/20 => Loss 0.149, Train_accy 87.92
2024-09-04 17:43:24,184 [trainer.py] => No NME accuracy.
2024-09-04 17:43:24,185 [trainer.py] => CNN: {'total': 49.6, '00-09': 11.02, '10-19': 37.98, '20-29': 26.8, '30-39': 25.45, '40-49': 37.38, '50-59': 25.23, '60-69': 55.66, '70-79': 44.68, '80-89': 51.13, '90-99': 52.94, '100-109': 81.74, '110-119': 71.68, '120-129': 84.11, '130-139': 87.29, 'old': 46.68, 'new': 87.29}
2024-09-04 17:43:24,185 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12, 49.6]
2024-09-04 17:43:24,185 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89, 84.03]

Average Accuracy (CNN): 68.06
2024-09-04 17:43:24,185 [trainer.py] => Average Accuracy (CNN): 68.06 

2024-09-04 17:43:24,186 [trainer.py] => All params: 85906316
2024-09-04 17:43:24,187 [trainer.py] => Trainable params: 85906316
2024-09-04 17:43:24,190 [finetune.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.803, Train_accy 0.22, Test_accy 43.24:   0%|          | 0/20 [00:09<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.803, Train_accy 0.22, Test_accy 43.24:   5%|▌         | 1/20 [00:09<02:57,  9.33s/it]
Task 14, Epoch 2/20 => Loss 0.331, Train_accy 24.34:   5%|▌         | 1/20 [00:13<02:57,  9.33s/it]                
Task 14, Epoch 2/20 => Loss 0.331, Train_accy 24.34:  10%|█         | 2/20 [00:13<01:49,  6.08s/it]
Task 14, Epoch 3/20 => Loss 0.304, Train_accy 51.33:  10%|█         | 2/20 [00:16<01:49,  6.08s/it]
Task 14, Epoch 3/20 => Loss 0.304, Train_accy 51.33:  15%|█▌        | 3/20 [00:16<01:25,  5.04s/it]
Task 14, Epoch 4/20 => Loss 0.265, Train_accy 61.28:  15%|█▌        | 3/20 [00:20<01:25,  5.04s/it]
Task 14, Epoch 4/20 => Loss 0.265, Train_accy 61.28:  20%|██        | 4/20 [00:20<01:12,  4.53s/it]
Task 14, Epoch 5/20 => Loss 0.207, Train_accy 61.73:  20%|██        | 4/20 [00:24<01:12,  4.53s/it]
Task 14, Epoch 5/20 => Loss 0.207, Train_accy 61.73:  25%|██▌       | 5/20 [00:24<01:03,  4.26s/it]
Task 14, Epoch 6/20 => Loss 0.212, Train_accy 65.04, Test_accy 46.58:  25%|██▌       | 5/20 [00:33<01:03,  4.26s/it]
Task 14, Epoch 6/20 => Loss 0.212, Train_accy 65.04, Test_accy 46.58:  30%|███       | 6/20 [00:33<01:23,  5.97s/it]
Task 14, Epoch 7/20 => Loss 0.171, Train_accy 67.26:  30%|███       | 6/20 [00:37<01:23,  5.97s/it]                 
Task 14, Epoch 7/20 => Loss 0.171, Train_accy 67.26:  35%|███▌      | 7/20 [00:37<01:08,  5.26s/it]
Task 14, Epoch 8/20 => Loss 0.147, Train_accy 73.23:  35%|███▌      | 7/20 [00:41<01:08,  5.26s/it]
Task 14, Epoch 8/20 => Loss 0.147, Train_accy 73.23:  40%|████      | 8/20 [00:41<00:57,  4.80s/it]
Task 14, Epoch 9/20 => Loss 0.128, Train_accy 74.78:  40%|████      | 8/20 [00:45<00:57,  4.80s/it]
Task 14, Epoch 9/20 => Loss 0.128, Train_accy 74.78:  45%|████▌     | 9/20 [00:45<00:49,  4.47s/it]
Task 14, Epoch 10/20 => Loss 0.138, Train_accy 77.65:  45%|████▌     | 9/20 [00:48<00:49,  4.47s/it]
Task 14, Epoch 10/20 => Loss 0.138, Train_accy 77.65:  50%|█████     | 10/20 [00:48<00:42,  4.26s/it]
Task 14, Epoch 11/20 => Loss 0.143, Train_accy 77.21, Test_accy 47.71:  50%|█████     | 10/20 [00:58<00:42,  4.26s/it]
Task 14, Epoch 11/20 => Loss 0.143, Train_accy 77.21, Test_accy 47.71:  55%|█████▌    | 11/20 [00:58<00:52,  5.78s/it]
Task 14, Epoch 12/20 => Loss 0.152, Train_accy 80.53:  55%|█████▌    | 11/20 [01:01<00:52,  5.78s/it]                 
Task 14, Epoch 12/20 => Loss 0.152, Train_accy 80.53:  60%|██████    | 12/20 [01:01<00:41,  5.18s/it]
Task 14, Epoch 13/20 => Loss 0.137, Train_accy 78.32:  60%|██████    | 12/20 [01:05<00:41,  5.18s/it]
Task 14, Epoch 13/20 => Loss 0.137, Train_accy 78.32:  65%|██████▌   | 13/20 [01:05<00:33,  4.75s/it]
Task 14, Epoch 14/20 => Loss 0.122, Train_accy 76.99:  65%|██████▌   | 13/20 [01:09<00:33,  4.75s/it]
Task 14, Epoch 14/20 => Loss 0.122, Train_accy 76.99:  70%|███████   | 14/20 [01:09<00:26,  4.48s/it]
Task 14, Epoch 15/20 => Loss 0.174, Train_accy 77.88:  70%|███████   | 14/20 [01:13<00:26,  4.48s/it]
Task 14, Epoch 15/20 => Loss 0.174, Train_accy 77.88:  75%|███████▌  | 15/20 [01:13<00:21,  4.26s/it]
Task 14, Epoch 16/20 => Loss 0.146, Train_accy 78.54, Test_accy 48.50:  75%|███████▌  | 15/20 [01:22<00:21,  4.26s/it]
Task 14, Epoch 16/20 => Loss 0.146, Train_accy 78.54, Test_accy 48.50:  80%|████████  | 16/20 [01:22<00:23,  5.77s/it]
Task 14, Epoch 17/20 => Loss 0.113, Train_accy 78.10:  80%|████████  | 16/20 [01:26<00:23,  5.77s/it]                 
Task 14, Epoch 17/20 => Loss 0.113, Train_accy 78.10:  85%|████████▌ | 17/20 [01:26<00:15,  5.17s/it]
Task 14, Epoch 18/20 => Loss 0.090, Train_accy 81.86:  85%|████████▌ | 17/20 [01:30<00:15,  5.17s/it]
Task 14, Epoch 18/20 => Loss 0.090, Train_accy 81.86:  90%|█████████ | 18/20 [01:30<00:09,  4.77s/it]
Task 14, Epoch 19/20 => Loss 0.157, Train_accy 77.65:  90%|█████████ | 18/20 [01:34<00:09,  4.77s/it]
Task 14, Epoch 19/20 => Loss 0.157, Train_accy 77.65:  95%|█████████▌| 19/20 [01:34<00:04,  4.49s/it]
Task 14, Epoch 20/20 => Loss 0.128, Train_accy 79.65:  95%|█████████▌| 19/20 [01:37<00:04,  4.49s/it]
Task 14, Epoch 20/20 => Loss 0.128, Train_accy 79.65: 100%|██████████| 20/20 [01:37<00:00,  4.28s/it]
Task 14, Epoch 20/20 => Loss 0.128, Train_accy 79.65: 100%|██████████| 20/20 [01:37<00:00,  4.89s/it]
2024-09-04 17:45:02,024 [finetune.py] => Task 14, Epoch 20/20 => Loss 0.128, Train_accy 79.65
2024-09-04 17:45:07,607 [trainer.py] => No NME accuracy.
2024-09-04 17:45:07,608 [trainer.py] => CNN: {'total': 47.48, '00-09': 5.93, '10-19': 31.01, '20-29': 21.65, '30-39': 14.55, '40-49': 29.91, '50-59': 28.83, '60-69': 40.57, '70-79': 39.72, '80-89': 48.12, '90-99': 57.35, '100-109': 80.87, '110-119': 61.95, '120-129': 76.64, '130-139': 79.66, '140-149': 88.1, 'old': 44.36, 'new': 88.1}
2024-09-04 17:45:07,608 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12, 49.6, 47.48]
2024-09-04 17:45:07,608 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89, 84.03, 82.06]

Average Accuracy (CNN): 66.69
2024-09-04 17:45:07,608 [trainer.py] => Average Accuracy (CNN): 66.69 

2024-09-04 17:45:07,610 [trainer.py] => All params: 85914006
2024-09-04 17:45:07,611 [trainer.py] => Trainable params: 85914006
2024-09-04 17:45:07,613 [finetune.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.471, Train_accy 1.28, Test_accy 45.21:   0%|          | 0/20 [00:09<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.471, Train_accy 1.28, Test_accy 45.21:   5%|▌         | 1/20 [00:09<03:05,  9.74s/it]
Task 15, Epoch 2/20 => Loss 0.341, Train_accy 27.78:   5%|▌         | 1/20 [00:13<03:05,  9.74s/it]                
Task 15, Epoch 2/20 => Loss 0.341, Train_accy 27.78:  10%|█         | 2/20 [00:13<01:53,  6.30s/it]
Task 15, Epoch 3/20 => Loss 0.238, Train_accy 51.92:  10%|█         | 2/20 [00:17<01:53,  6.30s/it]
Task 15, Epoch 3/20 => Loss 0.238, Train_accy 51.92:  15%|█▌        | 3/20 [00:17<01:28,  5.18s/it]
Task 15, Epoch 4/20 => Loss 0.215, Train_accy 61.97:  15%|█▌        | 3/20 [00:21<01:28,  5.18s/it]
Task 15, Epoch 4/20 => Loss 0.215, Train_accy 61.97:  20%|██        | 4/20 [00:21<01:14,  4.65s/it]
Task 15, Epoch 5/20 => Loss 0.178, Train_accy 65.17:  20%|██        | 4/20 [00:25<01:14,  4.65s/it]
Task 15, Epoch 5/20 => Loss 0.178, Train_accy 65.17:  25%|██▌       | 5/20 [00:25<01:05,  4.36s/it]
Task 15, Epoch 6/20 => Loss 0.176, Train_accy 65.60, Test_accy 46.38:  25%|██▌       | 5/20 [00:34<01:05,  4.36s/it]
Task 15, Epoch 6/20 => Loss 0.176, Train_accy 65.60, Test_accy 46.38:  30%|███       | 6/20 [00:34<01:26,  6.19s/it]
Task 15, Epoch 7/20 => Loss 0.157, Train_accy 70.30:  30%|███       | 6/20 [00:38<01:26,  6.19s/it]                 
Task 15, Epoch 7/20 => Loss 0.157, Train_accy 70.30:  35%|███▌      | 7/20 [00:38<01:10,  5.44s/it]
Task 15, Epoch 8/20 => Loss 0.147, Train_accy 75.21:  35%|███▌      | 7/20 [00:42<01:10,  5.44s/it]
Task 15, Epoch 8/20 => Loss 0.147, Train_accy 75.21:  40%|████      | 8/20 [00:42<00:59,  4.97s/it]
Task 15, Epoch 9/20 => Loss 0.165, Train_accy 69.02:  40%|████      | 8/20 [00:46<00:59,  4.97s/it]
Task 15, Epoch 9/20 => Loss 0.165, Train_accy 69.02:  45%|████▌     | 9/20 [00:46<00:51,  4.64s/it]
Task 15, Epoch 10/20 => Loss 0.110, Train_accy 72.65:  45%|████▌     | 9/20 [00:50<00:51,  4.64s/it]
Task 15, Epoch 10/20 => Loss 0.110, Train_accy 72.65:  50%|█████     | 10/20 [00:50<00:44,  4.41s/it]
Task 15, Epoch 11/20 => Loss 0.134, Train_accy 72.86, Test_accy 48.23:  50%|█████     | 10/20 [01:00<00:44,  4.41s/it]
Task 15, Epoch 11/20 => Loss 0.134, Train_accy 72.86, Test_accy 48.23:  55%|█████▌    | 11/20 [01:00<00:54,  6.05s/it]
Task 15, Epoch 12/20 => Loss 0.115, Train_accy 73.50:  55%|█████▌    | 11/20 [01:04<00:54,  6.05s/it]                 
Task 15, Epoch 12/20 => Loss 0.115, Train_accy 73.50:  60%|██████    | 12/20 [01:04<00:43,  5.44s/it]
Task 15, Epoch 13/20 => Loss 0.136, Train_accy 72.65:  60%|██████    | 12/20 [01:08<00:43,  5.44s/it]
Task 15, Epoch 13/20 => Loss 0.136, Train_accy 72.65:  65%|██████▌   | 13/20 [01:08<00:34,  4.99s/it]
Task 15, Epoch 14/20 => Loss 0.119, Train_accy 74.57:  65%|██████▌   | 13/20 [01:12<00:34,  4.99s/it]
Task 15, Epoch 14/20 => Loss 0.119, Train_accy 74.57:  70%|███████   | 14/20 [01:12<00:28,  4.67s/it]
Task 15, Epoch 15/20 => Loss 0.161, Train_accy 74.36:  70%|███████   | 14/20 [01:16<00:28,  4.67s/it]
Task 15, Epoch 15/20 => Loss 0.161, Train_accy 74.36:  75%|███████▌  | 15/20 [01:16<00:22,  4.44s/it]
Task 15, Epoch 16/20 => Loss 0.121, Train_accy 72.01, Test_accy 47.01:  75%|███████▌  | 15/20 [01:25<00:22,  4.44s/it]
Task 15, Epoch 16/20 => Loss 0.121, Train_accy 72.01, Test_accy 47.01:  80%|████████  | 16/20 [01:25<00:24,  6.04s/it]
Task 15, Epoch 17/20 => Loss 0.155, Train_accy 71.79:  80%|████████  | 16/20 [01:29<00:24,  6.04s/it]                 
Task 15, Epoch 17/20 => Loss 0.155, Train_accy 71.79:  85%|████████▌ | 17/20 [01:29<00:16,  5.40s/it]
Task 15, Epoch 18/20 => Loss 0.152, Train_accy 73.50:  85%|████████▌ | 17/20 [01:33<00:16,  5.40s/it]
Task 15, Epoch 18/20 => Loss 0.152, Train_accy 73.50:  90%|█████████ | 18/20 [01:33<00:09,  4.95s/it]
Task 15, Epoch 19/20 => Loss 0.088, Train_accy 76.92:  90%|█████████ | 18/20 [01:37<00:09,  4.95s/it]
Task 15, Epoch 19/20 => Loss 0.088, Train_accy 76.92:  95%|█████████▌| 19/20 [01:37<00:04,  4.62s/it]
Task 15, Epoch 20/20 => Loss 0.104, Train_accy 74.79:  95%|█████████▌| 19/20 [01:41<00:04,  4.62s/it]
Task 15, Epoch 20/20 => Loss 0.104, Train_accy 74.79: 100%|██████████| 20/20 [01:41<00:00,  4.39s/it]
Task 15, Epoch 20/20 => Loss 0.104, Train_accy 74.79: 100%|██████████| 20/20 [01:41<00:00,  5.07s/it]
2024-09-04 17:46:49,093 [finetune.py] => Task 15, Epoch 20/20 => Loss 0.104, Train_accy 74.79
2024-09-04 17:46:54,887 [trainer.py] => No NME accuracy.
2024-09-04 17:46:54,887 [trainer.py] => CNN: {'total': 47.28, '00-09': 6.78, '10-19': 27.91, '20-29': 22.68, '30-39': 18.18, '40-49': 32.71, '50-59': 26.13, '60-69': 39.62, '70-79': 40.43, '80-89': 45.86, '90-99': 55.88, '100-109': 70.43, '110-119': 59.29, '120-129': 76.64, '130-139': 64.41, '140-149': 85.71, '150-159': 75.81, 'old': 45.27, 'new': 75.81}
2024-09-04 17:46:54,887 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12, 49.6, 47.48, 47.28]
2024-09-04 17:46:54,888 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89, 84.03, 82.06, 83.66]

Average Accuracy (CNN): 65.47
2024-09-04 17:46:54,888 [trainer.py] => Average Accuracy (CNN): 65.47 

2024-09-04 17:46:54,889 [trainer.py] => All params: 85921696
2024-09-04 17:46:54,890 [trainer.py] => Trainable params: 85921696
2024-09-04 17:46:54,893 [finetune.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.346, Train_accy 0.65, Test_accy 44.00:   0%|          | 0/20 [00:10<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.346, Train_accy 0.65, Test_accy 44.00:   5%|▌         | 1/20 [00:10<03:13, 10.20s/it]
Task 16, Epoch 2/20 => Loss 0.248, Train_accy 35.78:   5%|▌         | 1/20 [00:14<03:13, 10.20s/it]                
Task 16, Epoch 2/20 => Loss 0.248, Train_accy 35.78:  10%|█         | 2/20 [00:14<01:56,  6.48s/it]
Task 16, Epoch 3/20 => Loss 0.237, Train_accy 68.10:  10%|█         | 2/20 [00:17<01:56,  6.48s/it]
Task 16, Epoch 3/20 => Loss 0.237, Train_accy 68.10:  15%|█▌        | 3/20 [00:17<01:29,  5.27s/it]
Task 16, Epoch 4/20 => Loss 0.135, Train_accy 78.45:  15%|█▌        | 3/20 [00:21<01:29,  5.27s/it]
Task 16, Epoch 4/20 => Loss 0.135, Train_accy 78.45:  20%|██        | 4/20 [00:21<01:15,  4.74s/it]
Task 16, Epoch 5/20 => Loss 0.177, Train_accy 82.33:  20%|██        | 4/20 [00:25<01:15,  4.74s/it]
Task 16, Epoch 5/20 => Loss 0.177, Train_accy 82.33:  25%|██▌       | 5/20 [00:25<01:06,  4.41s/it]
Task 16, Epoch 6/20 => Loss 0.117, Train_accy 84.48, Test_accy 46.12:  25%|██▌       | 5/20 [00:35<01:06,  4.41s/it]
Task 16, Epoch 6/20 => Loss 0.117, Train_accy 84.48, Test_accy 46.12:  30%|███       | 6/20 [00:35<01:29,  6.36s/it]
Task 16, Epoch 7/20 => Loss 0.150, Train_accy 82.76:  30%|███       | 6/20 [00:39<01:29,  6.36s/it]                 
Task 16, Epoch 7/20 => Loss 0.150, Train_accy 82.76:  35%|███▌      | 7/20 [00:39<01:12,  5.56s/it]
Task 16, Epoch 8/20 => Loss 0.166, Train_accy 83.62:  35%|███▌      | 7/20 [00:43<01:12,  5.56s/it]
Task 16, Epoch 8/20 => Loss 0.166, Train_accy 83.62:  40%|████      | 8/20 [00:43<01:00,  5.03s/it]
Task 16, Epoch 9/20 => Loss 0.126, Train_accy 84.05:  40%|████      | 8/20 [00:47<01:00,  5.03s/it]
Task 16, Epoch 9/20 => Loss 0.126, Train_accy 84.05:  45%|████▌     | 9/20 [00:47<00:51,  4.67s/it]
Task 16, Epoch 10/20 => Loss 0.169, Train_accy 81.03:  45%|████▌     | 9/20 [00:51<00:51,  4.67s/it]
Task 16, Epoch 10/20 => Loss 0.169, Train_accy 81.03:  50%|█████     | 10/20 [00:51<00:44,  4.45s/it]
Task 16, Epoch 11/20 => Loss 0.156, Train_accy 80.82, Test_accy 47.85:  50%|█████     | 10/20 [01:01<00:44,  4.45s/it]
Task 16, Epoch 11/20 => Loss 0.156, Train_accy 80.82, Test_accy 47.85:  55%|█████▌    | 11/20 [01:01<00:55,  6.17s/it]
Task 16, Epoch 12/20 => Loss 0.126, Train_accy 81.47:  55%|█████▌    | 11/20 [01:05<00:55,  6.17s/it]                 
Task 16, Epoch 12/20 => Loss 0.126, Train_accy 81.47:  60%|██████    | 12/20 [01:05<00:43,  5.46s/it]
Task 16, Epoch 13/20 => Loss 0.135, Train_accy 81.90:  60%|██████    | 12/20 [01:09<00:43,  5.46s/it]
Task 16, Epoch 13/20 => Loss 0.135, Train_accy 81.90:  65%|██████▌   | 13/20 [01:09<00:34,  4.99s/it]
Task 16, Epoch 14/20 => Loss 0.128, Train_accy 84.70:  65%|██████▌   | 13/20 [01:13<00:34,  4.99s/it]
Task 16, Epoch 14/20 => Loss 0.128, Train_accy 84.70:  70%|███████   | 14/20 [01:13<00:27,  4.66s/it]
Task 16, Epoch 15/20 => Loss 0.073, Train_accy 87.50:  70%|███████   | 14/20 [01:17<00:27,  4.66s/it]
Task 16, Epoch 15/20 => Loss 0.073, Train_accy 87.50:  75%|███████▌  | 15/20 [01:17<00:22,  4.45s/it]
Task 16, Epoch 16/20 => Loss 0.124, Train_accy 84.48, Test_accy 48.20:  75%|███████▌  | 15/20 [01:27<00:22,  4.45s/it]
Task 16, Epoch 16/20 => Loss 0.124, Train_accy 84.48, Test_accy 48.20:  80%|████████  | 16/20 [01:27<00:24,  6.16s/it]
Task 16, Epoch 17/20 => Loss 0.105, Train_accy 86.21:  80%|████████  | 16/20 [01:31<00:24,  6.16s/it]                 
Task 16, Epoch 17/20 => Loss 0.105, Train_accy 86.21:  85%|████████▌ | 17/20 [01:31<00:16,  5.46s/it]
Task 16, Epoch 18/20 => Loss 0.141, Train_accy 84.48:  85%|████████▌ | 17/20 [01:34<00:16,  5.46s/it]
Task 16, Epoch 18/20 => Loss 0.141, Train_accy 84.48:  90%|█████████ | 18/20 [01:34<00:09,  4.97s/it]
Task 16, Epoch 19/20 => Loss 0.124, Train_accy 85.78:  90%|█████████ | 18/20 [01:38<00:09,  4.97s/it]
Task 16, Epoch 19/20 => Loss 0.124, Train_accy 85.78:  95%|█████████▌| 19/20 [01:38<00:04,  4.64s/it]
Task 16, Epoch 20/20 => Loss 0.086, Train_accy 87.07:  95%|█████████▌| 19/20 [01:42<00:04,  4.64s/it]
Task 16, Epoch 20/20 => Loss 0.086, Train_accy 87.07: 100%|██████████| 20/20 [01:42<00:00,  4.41s/it]
Task 16, Epoch 20/20 => Loss 0.086, Train_accy 87.07: 100%|██████████| 20/20 [01:42<00:00,  5.13s/it]
2024-09-04 17:48:37,555 [finetune.py] => Task 16, Epoch 20/20 => Loss 0.086, Train_accy 87.07
2024-09-04 17:48:43,966 [trainer.py] => No NME accuracy.
2024-09-04 17:48:43,966 [trainer.py] => CNN: {'total': 47.56, '00-09': 6.78, '10-19': 28.68, '20-29': 15.46, '30-39': 13.64, '40-49': 29.91, '50-59': 28.83, '60-69': 37.74, '70-79': 38.3, '80-89': 43.61, '90-99': 47.79, '100-109': 75.65, '110-119': 58.41, '120-129': 75.7, '130-139': 56.78, '140-149': 76.19, '150-159': 72.58, '160-169': 89.55, 'old': 44.58, 'new': 89.55}
2024-09-04 17:48:43,966 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12, 49.6, 47.48, 47.28, 47.56]
2024-09-04 17:48:43,967 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89, 84.03, 82.06, 83.66, 81.53]

Average Accuracy (CNN): 64.42
2024-09-04 17:48:43,967 [trainer.py] => Average Accuracy (CNN): 64.42 

2024-09-04 17:48:43,968 [trainer.py] => All params: 85929386
2024-09-04 17:48:43,969 [trainer.py] => Trainable params: 85929386
2024-09-04 17:48:43,972 [finetune.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.242, Train_accy 0.20, Test_accy 40.37:   0%|          | 0/20 [00:10<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.242, Train_accy 0.20, Test_accy 40.37:   5%|▌         | 1/20 [00:10<03:19, 10.51s/it]
Task 17, Epoch 2/20 => Loss 0.299, Train_accy 19.84:   5%|▌         | 1/20 [00:14<03:19, 10.51s/it]                
Task 17, Epoch 2/20 => Loss 0.299, Train_accy 19.84:  10%|█         | 2/20 [00:14<02:01,  6.73s/it]
Task 17, Epoch 3/20 => Loss 0.223, Train_accy 43.32:  10%|█         | 2/20 [00:18<02:01,  6.73s/it]
Task 17, Epoch 3/20 => Loss 0.223, Train_accy 43.32:  15%|█▌        | 3/20 [00:18<01:34,  5.54s/it]
Task 17, Epoch 4/20 => Loss 0.168, Train_accy 59.11:  15%|█▌        | 3/20 [00:22<01:34,  5.54s/it]
Task 17, Epoch 4/20 => Loss 0.168, Train_accy 59.11:  20%|██        | 4/20 [00:22<01:19,  4.99s/it]
Task 17, Epoch 5/20 => Loss 0.170, Train_accy 63.97:  20%|██        | 4/20 [00:26<01:19,  4.99s/it]
Task 17, Epoch 5/20 => Loss 0.170, Train_accy 63.97:  25%|██▌       | 5/20 [00:26<01:10,  4.68s/it]
Task 17, Epoch 6/20 => Loss 0.164, Train_accy 60.73, Test_accy 43.23:  25%|██▌       | 5/20 [00:37<01:10,  4.68s/it]
Task 17, Epoch 6/20 => Loss 0.164, Train_accy 60.73, Test_accy 43.23:  30%|███       | 6/20 [00:37<01:34,  6.78s/it]
Task 17, Epoch 7/20 => Loss 0.224, Train_accy 60.73:  30%|███       | 6/20 [00:41<01:34,  6.78s/it]                 
Task 17, Epoch 7/20 => Loss 0.224, Train_accy 60.73:  35%|███▌      | 7/20 [00:41<01:16,  5.91s/it]
Task 17, Epoch 8/20 => Loss 0.225, Train_accy 63.56:  35%|███▌      | 7/20 [00:46<01:16,  5.91s/it]
Task 17, Epoch 8/20 => Loss 0.225, Train_accy 63.56:  40%|████      | 8/20 [00:46<01:03,  5.33s/it]
Task 17, Epoch 9/20 => Loss 0.172, Train_accy 69.23:  40%|████      | 8/20 [00:50<01:03,  5.33s/it]
Task 17, Epoch 9/20 => Loss 0.172, Train_accy 69.23:  45%|████▌     | 9/20 [00:50<00:54,  4.95s/it]
Task 17, Epoch 10/20 => Loss 0.171, Train_accy 67.61:  45%|████▌     | 9/20 [00:54<00:54,  4.95s/it]
Task 17, Epoch 10/20 => Loss 0.171, Train_accy 67.61:  50%|█████     | 10/20 [00:54<00:46,  4.68s/it]
Task 17, Epoch 11/20 => Loss 0.113, Train_accy 72.27, Test_accy 47.37:  50%|█████     | 10/20 [01:04<00:46,  4.68s/it]
Task 17, Epoch 11/20 => Loss 0.113, Train_accy 72.27, Test_accy 47.37:  55%|█████▌    | 11/20 [01:04<00:58,  6.48s/it]
Task 17, Epoch 12/20 => Loss 0.131, Train_accy 71.66:  55%|█████▌    | 11/20 [01:08<00:58,  6.48s/it]                 
Task 17, Epoch 12/20 => Loss 0.131, Train_accy 71.66:  60%|██████    | 12/20 [01:08<00:46,  5.76s/it]
Task 17, Epoch 13/20 => Loss 0.103, Train_accy 67.61:  60%|██████    | 12/20 [01:12<00:46,  5.76s/it]
Task 17, Epoch 13/20 => Loss 0.103, Train_accy 67.61:  65%|██████▌   | 13/20 [01:12<00:36,  5.25s/it]
Task 17, Epoch 14/20 => Loss 0.110, Train_accy 71.86:  65%|██████▌   | 13/20 [01:17<00:36,  5.25s/it]
Task 17, Epoch 14/20 => Loss 0.110, Train_accy 71.86:  70%|███████   | 14/20 [01:17<00:29,  4.90s/it]
Task 17, Epoch 15/20 => Loss 0.066, Train_accy 75.51:  70%|███████   | 14/20 [01:21<00:29,  4.90s/it]
Task 17, Epoch 15/20 => Loss 0.066, Train_accy 75.51:  75%|███████▌  | 15/20 [01:21<00:23,  4.66s/it]
Task 17, Epoch 16/20 => Loss 0.115, Train_accy 73.68, Test_accy 47.09:  75%|███████▌  | 15/20 [01:31<00:23,  4.66s/it]
Task 17, Epoch 16/20 => Loss 0.115, Train_accy 73.68, Test_accy 47.09:  80%|████████  | 16/20 [01:31<00:25,  6.45s/it]
Task 17, Epoch 17/20 => Loss 0.127, Train_accy 75.30:  80%|████████  | 16/20 [01:35<00:25,  6.45s/it]                 
Task 17, Epoch 17/20 => Loss 0.127, Train_accy 75.30:  85%|████████▌ | 17/20 [01:35<00:17,  5.77s/it]
Task 17, Epoch 18/20 => Loss 0.123, Train_accy 74.49:  85%|████████▌ | 17/20 [01:40<00:17,  5.77s/it]
Task 17, Epoch 18/20 => Loss 0.123, Train_accy 74.49:  90%|█████████ | 18/20 [01:40<00:10,  5.28s/it]
Task 17, Epoch 19/20 => Loss 0.084, Train_accy 78.95:  90%|█████████ | 18/20 [01:44<00:10,  5.28s/it]
Task 17, Epoch 19/20 => Loss 0.084, Train_accy 78.95:  95%|█████████▌| 19/20 [01:44<00:04,  4.93s/it]
Task 17, Epoch 20/20 => Loss 0.112, Train_accy 77.94:  95%|█████████▌| 19/20 [01:48<00:04,  4.93s/it]
Task 17, Epoch 20/20 => Loss 0.112, Train_accy 77.94: 100%|██████████| 20/20 [01:48<00:00,  4.68s/it]
Task 17, Epoch 20/20 => Loss 0.112, Train_accy 77.94: 100%|██████████| 20/20 [01:48<00:00,  5.42s/it]
2024-09-04 17:50:32,327 [finetune.py] => Task 17, Epoch 20/20 => Loss 0.112, Train_accy 77.94
2024-09-04 17:50:38,882 [trainer.py] => No NME accuracy.
2024-09-04 17:50:38,883 [trainer.py] => CNN: {'total': 45.44, '00-09': 6.78, '10-19': 25.58, '20-29': 15.46, '30-39': 14.55, '40-49': 25.23, '50-59': 28.83, '60-69': 27.36, '70-79': 35.46, '80-89': 48.12, '90-99': 44.12, '100-109': 73.91, '110-119': 46.9, '120-129': 63.55, '130-139': 43.22, '140-149': 67.46, '150-159': 67.74, '160-169': 89.55, '170-179': 84.47, 'old': 43.46, 'new': 84.47}
2024-09-04 17:50:38,883 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12, 49.6, 47.48, 47.28, 47.56, 45.44]
2024-09-04 17:50:38,883 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89, 84.03, 82.06, 83.66, 81.53, 79.37]

Average Accuracy (CNN): 63.36
2024-09-04 17:50:38,883 [trainer.py] => Average Accuracy (CNN): 63.36 

2024-09-04 17:50:38,885 [trainer.py] => All params: 85937076
2024-09-04 17:50:38,886 [trainer.py] => Trainable params: 85937076
2024-09-04 17:50:38,890 [finetune.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.481, Train_accy 0.44, Test_accy 41.02:   0%|          | 0/20 [00:10<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.481, Train_accy 0.44, Test_accy 41.02:   5%|▌         | 1/20 [00:10<03:22, 10.65s/it]
Task 18, Epoch 2/20 => Loss 0.314, Train_accy 24.84:   5%|▌         | 1/20 [00:14<03:22, 10.65s/it]                
Task 18, Epoch 2/20 => Loss 0.314, Train_accy 24.84:  10%|█         | 2/20 [00:14<01:59,  6.63s/it]
Task 18, Epoch 3/20 => Loss 0.208, Train_accy 59.34:  10%|█         | 2/20 [00:18<01:59,  6.63s/it]
Task 18, Epoch 3/20 => Loss 0.208, Train_accy 59.34:  15%|█▌        | 3/20 [00:18<01:30,  5.31s/it]
Task 18, Epoch 4/20 => Loss 0.162, Train_accy 74.51:  15%|█▌        | 3/20 [00:22<01:30,  5.31s/it]
Task 18, Epoch 4/20 => Loss 0.162, Train_accy 74.51:  20%|██        | 4/20 [00:22<01:15,  4.75s/it]
Task 18, Epoch 5/20 => Loss 0.127, Train_accy 77.36:  20%|██        | 4/20 [00:25<01:15,  4.75s/it]
Task 18, Epoch 5/20 => Loss 0.127, Train_accy 77.36:  25%|██▌       | 5/20 [00:25<01:06,  4.44s/it]
Task 18, Epoch 6/20 => Loss 0.136, Train_accy 83.74, Test_accy 42.61:  25%|██▌       | 5/20 [00:36<01:06,  4.44s/it]
Task 18, Epoch 6/20 => Loss 0.136, Train_accy 83.74, Test_accy 42.61:  30%|███       | 6/20 [00:36<01:31,  6.55s/it]
Task 18, Epoch 7/20 => Loss 0.212, Train_accy 78.90:  30%|███       | 6/20 [00:40<01:31,  6.55s/it]                 
Task 18, Epoch 7/20 => Loss 0.212, Train_accy 78.90:  35%|███▌      | 7/20 [00:40<01:13,  5.66s/it]
Task 18, Epoch 8/20 => Loss 0.117, Train_accy 84.84:  35%|███▌      | 7/20 [00:44<01:13,  5.66s/it]
Task 18, Epoch 8/20 => Loss 0.117, Train_accy 84.84:  40%|████      | 8/20 [00:44<01:00,  5.08s/it]
Task 18, Epoch 9/20 => Loss 0.135, Train_accy 83.52:  40%|████      | 8/20 [00:48<01:00,  5.08s/it]
Task 18, Epoch 9/20 => Loss 0.135, Train_accy 83.52:  45%|████▌     | 9/20 [00:48<00:51,  4.70s/it]
Task 18, Epoch 10/20 => Loss 0.187, Train_accy 80.22:  45%|████▌     | 9/20 [00:51<00:51,  4.70s/it]
Task 18, Epoch 10/20 => Loss 0.187, Train_accy 80.22:  50%|█████     | 10/20 [00:51<00:44,  4.43s/it]
Task 18, Epoch 11/20 => Loss 0.151, Train_accy 81.98, Test_accy 44.34:  50%|█████     | 10/20 [01:02<00:44,  4.43s/it]
Task 18, Epoch 11/20 => Loss 0.151, Train_accy 81.98, Test_accy 44.34:  55%|█████▌    | 11/20 [01:02<00:57,  6.37s/it]
Task 18, Epoch 12/20 => Loss 0.088, Train_accy 85.93:  55%|█████▌    | 11/20 [01:06<00:57,  6.37s/it]                 
Task 18, Epoch 12/20 => Loss 0.088, Train_accy 85.93:  60%|██████    | 12/20 [01:06<00:44,  5.59s/it]
Task 18, Epoch 13/20 => Loss 0.124, Train_accy 86.59:  60%|██████    | 12/20 [01:10<00:44,  5.59s/it]
Task 18, Epoch 13/20 => Loss 0.124, Train_accy 86.59:  65%|██████▌   | 13/20 [01:10<00:35,  5.05s/it]
Task 18, Epoch 14/20 => Loss 0.129, Train_accy 84.18:  65%|██████▌   | 13/20 [01:14<00:35,  5.05s/it]
Task 18, Epoch 14/20 => Loss 0.129, Train_accy 84.18:  70%|███████   | 14/20 [01:14<00:28,  4.68s/it]
Task 18, Epoch 15/20 => Loss 0.103, Train_accy 87.69:  70%|███████   | 14/20 [01:18<00:28,  4.68s/it]
Task 18, Epoch 15/20 => Loss 0.103, Train_accy 87.69:  75%|███████▌  | 15/20 [01:18<00:22,  4.43s/it]
Task 18, Epoch 16/20 => Loss 0.161, Train_accy 83.08, Test_accy 46.28:  75%|███████▌  | 15/20 [01:28<00:22,  4.43s/it]
Task 18, Epoch 16/20 => Loss 0.161, Train_accy 83.08, Test_accy 46.28:  80%|████████  | 16/20 [01:28<00:25,  6.34s/it]
Task 18, Epoch 17/20 => Loss 0.144, Train_accy 85.93:  80%|████████  | 16/20 [01:32<00:25,  6.34s/it]                 
Task 18, Epoch 17/20 => Loss 0.144, Train_accy 85.93:  85%|████████▌ | 17/20 [01:32<00:16,  5.58s/it]
Task 18, Epoch 18/20 => Loss 0.122, Train_accy 87.91:  85%|████████▌ | 17/20 [01:36<00:16,  5.58s/it]
Task 18, Epoch 18/20 => Loss 0.122, Train_accy 87.91:  90%|█████████ | 18/20 [01:36<00:10,  5.04s/it]
Task 18, Epoch 19/20 => Loss 0.161, Train_accy 86.15:  90%|█████████ | 18/20 [01:40<00:10,  5.04s/it]
Task 18, Epoch 19/20 => Loss 0.161, Train_accy 86.15:  95%|█████████▌| 19/20 [01:40<00:04,  4.69s/it]
Task 18, Epoch 20/20 => Loss 0.093, Train_accy 89.89:  95%|█████████▌| 19/20 [01:44<00:04,  4.69s/it]
Task 18, Epoch 20/20 => Loss 0.093, Train_accy 89.89: 100%|██████████| 20/20 [01:44<00:00,  4.44s/it]
Task 18, Epoch 20/20 => Loss 0.093, Train_accy 89.89: 100%|██████████| 20/20 [01:44<00:00,  5.21s/it]
2024-09-04 17:52:23,054 [finetune.py] => Task 18, Epoch 20/20 => Loss 0.093, Train_accy 89.89
2024-09-04 17:52:30,040 [trainer.py] => No NME accuracy.
2024-09-04 17:52:30,041 [trainer.py] => CNN: {'total': 45.8, '00-09': 5.08, '10-19': 32.56, '20-29': 15.46, '30-39': 7.27, '40-49': 24.3, '50-59': 31.53, '60-69': 32.08, '70-79': 31.21, '80-89': 58.65, '90-99': 49.26, '100-109': 72.17, '110-119': 38.05, '120-129': 60.75, '130-139': 32.2, '140-149': 62.7, '150-159': 58.87, '160-169': 77.61, '170-179': 76.7, '180-189': 87.88, 'old': 43.19, 'new': 87.88}
2024-09-04 17:52:30,041 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12, 49.6, 47.48, 47.28, 47.56, 45.44, 45.8]
2024-09-04 17:52:30,041 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89, 84.03, 82.06, 83.66, 81.53, 79.37, 80.09]

Average Accuracy (CNN): 62.44
2024-09-04 17:52:30,042 [trainer.py] => Average Accuracy (CNN): 62.44 

2024-09-04 17:52:30,043 [trainer.py] => All params: 85944766
2024-09-04 17:52:30,044 [trainer.py] => Trainable params: 85944766
2024-09-04 17:52:30,049 [finetune.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.734, Train_accy 0.20, Test_accy 43.68:   0%|          | 0/20 [00:11<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.734, Train_accy 0.20, Test_accy 43.68:   5%|▌         | 1/20 [00:11<03:35, 11.33s/it]
Task 19, Epoch 2/20 => Loss 0.402, Train_accy 29.18:   5%|▌         | 1/20 [00:15<03:35, 11.33s/it]                
Task 19, Epoch 2/20 => Loss 0.402, Train_accy 29.18:  10%|█         | 2/20 [00:15<02:07,  7.09s/it]
Task 19, Epoch 3/20 => Loss 0.296, Train_accy 54.73:  10%|█         | 2/20 [00:19<02:07,  7.09s/it]
Task 19, Epoch 3/20 => Loss 0.296, Train_accy 54.73:  15%|█▌        | 3/20 [00:19<01:38,  5.79s/it]
Task 19, Epoch 4/20 => Loss 0.274, Train_accy 63.98:  15%|█▌        | 3/20 [00:23<01:38,  5.79s/it]
Task 19, Epoch 4/20 => Loss 0.274, Train_accy 63.98:  20%|██        | 4/20 [00:23<01:22,  5.14s/it]
Task 19, Epoch 5/20 => Loss 0.192, Train_accy 67.61:  20%|██        | 4/20 [00:27<01:22,  5.14s/it]
Task 19, Epoch 5/20 => Loss 0.192, Train_accy 67.61:  25%|██▌       | 5/20 [00:27<01:11,  4.79s/it]
Task 19, Epoch 6/20 => Loss 0.159, Train_accy 71.03, Test_accy 43.55:  25%|██▌       | 5/20 [00:39<01:11,  4.79s/it]
Task 19, Epoch 6/20 => Loss 0.159, Train_accy 71.03, Test_accy 43.55:  30%|███       | 6/20 [00:39<01:37,  6.97s/it]
Task 19, Epoch 7/20 => Loss 0.236, Train_accy 68.01:  30%|███       | 6/20 [00:43<01:37,  6.97s/it]                 
Task 19, Epoch 7/20 => Loss 0.236, Train_accy 68.01:  35%|███▌      | 7/20 [00:43<01:18,  6.05s/it]
Task 19, Epoch 8/20 => Loss 0.154, Train_accy 74.45:  35%|███▌      | 7/20 [00:47<01:18,  6.05s/it]
Task 19, Epoch 8/20 => Loss 0.154, Train_accy 74.45:  40%|████      | 8/20 [00:47<01:05,  5.44s/it]
Task 19, Epoch 9/20 => Loss 0.151, Train_accy 71.83:  40%|████      | 8/20 [00:51<01:05,  5.44s/it]
Task 19, Epoch 9/20 => Loss 0.151, Train_accy 71.83:  45%|████▌     | 9/20 [00:51<00:55,  5.04s/it]
Task 19, Epoch 10/20 => Loss 0.185, Train_accy 71.43:  45%|████▌     | 9/20 [00:55<00:55,  5.04s/it]
Task 19, Epoch 10/20 => Loss 0.185, Train_accy 71.43:  50%|█████     | 10/20 [00:55<00:47,  4.78s/it]
Task 19, Epoch 11/20 => Loss 0.157, Train_accy 72.03, Test_accy 43.34:  50%|█████     | 10/20 [01:07<00:47,  4.78s/it]
Task 19, Epoch 11/20 => Loss 0.157, Train_accy 72.03, Test_accy 43.34:  55%|█████▌    | 11/20 [01:07<01:01,  6.83s/it]
Task 19, Epoch 12/20 => Loss 0.155, Train_accy 76.86:  55%|█████▌    | 11/20 [01:11<01:01,  6.83s/it]                 
Task 19, Epoch 12/20 => Loss 0.155, Train_accy 76.86:  60%|██████    | 12/20 [01:11<00:48,  6.01s/it]
Task 19, Epoch 13/20 => Loss 0.117, Train_accy 79.68:  60%|██████    | 12/20 [01:15<00:48,  6.01s/it]
Task 19, Epoch 13/20 => Loss 0.117, Train_accy 79.68:  65%|██████▌   | 13/20 [01:15<00:38,  5.45s/it]
Task 19, Epoch 14/20 => Loss 0.132, Train_accy 79.48:  65%|██████▌   | 13/20 [01:19<00:38,  5.45s/it]
Task 19, Epoch 14/20 => Loss 0.132, Train_accy 79.48:  70%|███████   | 14/20 [01:19<00:30,  5.04s/it]
Task 19, Epoch 15/20 => Loss 0.145, Train_accy 77.67:  70%|███████   | 14/20 [01:23<00:30,  5.04s/it]
Task 19, Epoch 15/20 => Loss 0.145, Train_accy 77.67:  75%|███████▌  | 15/20 [01:23<00:23,  4.74s/it]
Task 19, Epoch 16/20 => Loss 0.087, Train_accy 80.68, Test_accy 43.89:  75%|███████▌  | 15/20 [01:34<00:23,  4.74s/it]
Task 19, Epoch 16/20 => Loss 0.087, Train_accy 80.68, Test_accy 43.89:  80%|████████  | 16/20 [01:34<00:26,  6.69s/it]
Task 19, Epoch 17/20 => Loss 0.176, Train_accy 78.87:  80%|████████  | 16/20 [01:39<00:26,  6.69s/it]                 
Task 19, Epoch 17/20 => Loss 0.176, Train_accy 78.87:  85%|████████▌ | 17/20 [01:39<00:17,  5.91s/it]
Task 19, Epoch 18/20 => Loss 0.193, Train_accy 77.67:  85%|████████▌ | 17/20 [01:43<00:17,  5.91s/it]
Task 19, Epoch 18/20 => Loss 0.193, Train_accy 77.67:  90%|█████████ | 18/20 [01:43<00:10,  5.36s/it]
Task 19, Epoch 19/20 => Loss 0.149, Train_accy 74.45:  90%|█████████ | 18/20 [01:47<00:10,  5.36s/it]
Task 19, Epoch 19/20 => Loss 0.149, Train_accy 74.45:  95%|█████████▌| 19/20 [01:47<00:04,  5.00s/it]
Task 19, Epoch 20/20 => Loss 0.113, Train_accy 81.09:  95%|█████████▌| 19/20 [01:51<00:04,  5.00s/it]
Task 19, Epoch 20/20 => Loss 0.113, Train_accy 81.09: 100%|██████████| 20/20 [01:51<00:00,  4.74s/it]
Task 19, Epoch 20/20 => Loss 0.113, Train_accy 81.09: 100%|██████████| 20/20 [01:51<00:00,  5.57s/it]
2024-09-04 17:54:21,519 [finetune.py] => Task 19, Epoch 20/20 => Loss 0.113, Train_accy 81.09
2024-09-04 17:54:28,717 [trainer.py] => No NME accuracy.
2024-09-04 17:54:28,717 [trainer.py] => CNN: {'total': 45.12, '00-09': 7.63, '10-19': 31.01, '20-29': 16.49, '30-39': 12.73, '40-49': 22.43, '50-59': 35.14, '60-69': 23.58, '70-79': 34.75, '80-89': 45.86, '90-99': 53.68, '100-109': 67.83, '110-119': 46.02, '120-129': 57.01, '130-139': 38.14, '140-149': 59.52, '150-159': 57.26, '160-169': 58.96, '170-179': 67.96, '180-189': 71.97, '190-199': 89.8, 'old': 43.19, 'new': 89.8}
2024-09-04 17:54:28,717 [trainer.py] => CNN top1 curve: [96.61, 92.71, 88.37, 72.69, 76.11, 76.64, 65.81, 66.38, 70.06, 62.04, 46.82, 44.84, 44.12, 49.6, 47.48, 47.28, 47.56, 45.44, 45.8, 45.12]
2024-09-04 17:54:28,717 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 98.02, 97.86, 95.98, 96.53, 93.91, 93.73, 92.68, 83.27, 82.91, 80.89, 84.03, 82.06, 83.66, 81.53, 79.37, 80.09, 78.88]

Average Accuracy (CNN): 61.57
2024-09-04 17:54:28,717 [trainer.py] => Average Accuracy (CNN): 61.57 

Accuracy Matrix (CNN):
[[96.61 87.29 73.73 49.15 52.54 47.46 45.76 37.29 33.05 24.58  9.32 11.02
   5.93 11.02  5.93  6.78  6.78  6.78  5.08  7.63]
 [ 0.   97.67 95.35 77.52 84.5  78.29 68.22 62.79 59.69 54.26 33.33 33.33
  37.21 37.98 31.01 27.91 28.68 25.58 32.56 31.01]
 [ 0.    0.   96.91 78.35 71.13 77.32 58.76 55.67 65.98 47.42 23.71 23.71
  22.68 26.8  21.65 22.68 15.46 15.46 15.46 16.49]
 [ 0.    0.    0.   87.27 79.09 79.09 57.27 48.18 50.91 39.09 40.   23.64
  21.82 25.45 14.55 18.18 13.64 14.55  7.27 12.73]
 [ 0.    0.    0.    0.   93.46 85.98 72.9  71.96 67.29 51.4  33.64 36.45
  42.99 37.38 29.91 32.71 29.91 25.23 24.3  22.43]
 [ 0.    0.    0.    0.    0.   93.69 63.06 65.77 64.86 53.15 30.63 34.23
  23.42 25.23 28.83 26.13 28.83 28.83 31.53 35.14]
 [ 0.    0.    0.    0.    0.    0.   96.23 96.23 92.45 76.42 64.15 51.89
  35.85 55.66 40.57 39.62 37.74 27.36 32.08 23.58]
 [ 0.    0.    0.    0.    0.    0.    0.   89.36 94.33 80.85 49.65 46.81
  49.65 44.68 39.72 40.43 38.3  35.46 31.21 34.75]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   94.74 85.71 60.15 48.87
  45.11 51.13 48.12 45.86 43.61 48.12 58.65 45.86]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   92.65 73.53 59.56
  53.68 52.94 57.35 55.88 47.79 44.12 49.26 53.68]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   87.83 86.09
  80.87 81.74 80.87 70.43 75.65 73.91 72.17 67.83]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   76.99
  66.37 71.68 61.95 59.29 58.41 46.9  38.05 46.02]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  84.11 84.11 76.64 76.64 75.7  63.55 60.75 57.01]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   87.29 79.66 64.41 56.78 43.22 32.2  38.14]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   88.1  85.71 76.19 67.46 62.7  59.52]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   75.81 72.58 67.74 58.87 57.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   89.55 89.55 77.61 58.96]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   84.47 76.7  67.96]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   87.88 71.97]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   89.8 ]]
2024-09-04 17:54:28,720 [trainer.py] => Forgetting (CNN): 47.24315789473684
2024-09-04 17:54:32,051 [trainer.py] => config: ./exps/finetune_cub_B100_Inc5.json
2024-09-04 17:54:32,052 [trainer.py] => prefix: reproduce
2024-09-04 17:54:32,052 [trainer.py] => dataset: cub
2024-09-04 17:54:32,052 [trainer.py] => memory_size: 0
2024-09-04 17:54:32,052 [trainer.py] => memory_per_class: 0
2024-09-04 17:54:32,052 [trainer.py] => fixed_memory: False
2024-09-04 17:54:32,052 [trainer.py] => shuffle: True
2024-09-04 17:54:32,052 [trainer.py] => init_cls: 100
2024-09-04 17:54:32,052 [trainer.py] => increment: 20
2024-09-04 17:54:32,052 [trainer.py] => model_name: finetune
2024-09-04 17:54:32,052 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 17:54:32,052 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 17:54:32,052 [trainer.py] => seed: 1993
2024-09-04 17:54:32,052 [trainer.py] => init_epoch: 20
2024-09-04 17:54:32,052 [trainer.py] => init_lr: 0.001
2024-09-04 17:54:32,052 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 17:54:32,052 [trainer.py] => init_lr_decay: 0.1
2024-09-04 17:54:32,052 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 17:54:32,052 [trainer.py] => epochs: 20
2024-09-04 17:54:32,052 [trainer.py] => lrate: 0.001
2024-09-04 17:54:32,052 [trainer.py] => milestones: [40, 70]
2024-09-04 17:54:32,052 [trainer.py] => lrate_decay: 0.1
2024-09-04 17:54:32,052 [trainer.py] => batch_size: 48
2024-09-04 17:54:32,052 [trainer.py] => weight_decay: 0.0002
2024-09-04 17:54:32,090 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 17:54:35,259 [trainer.py] => All params: 85798656
2024-09-04 17:54:35,259 [trainer.py] => Trainable params: 85798656
2024-09-04 17:54:35,260 [finetune.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   0%|          | 0/20 [00:39<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   5%|▌         | 1/20 [00:39<12:28, 39.37s/it]
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:   5%|▌         | 1/20 [01:14<12:28, 39.37s/it]                 
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:  10%|█         | 2/20 [01:14<11:07, 37.09s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  10%|█         | 2/20 [01:50<11:07, 37.09s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  15%|█▌        | 3/20 [01:50<10:17, 36.30s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  15%|█▌        | 3/20 [02:25<10:17, 36.30s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  20%|██        | 4/20 [02:25<09:36, 36.00s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  20%|██        | 4/20 [03:01<09:36, 36.00s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  25%|██▌       | 5/20 [03:01<08:56, 35.78s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  25%|██▌       | 5/20 [03:40<08:56, 35.78s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  30%|███       | 6/20 [03:40<08:37, 36.96s/it]
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  30%|███       | 6/20 [04:15<08:37, 36.96s/it]                 
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  35%|███▌      | 7/20 [04:15<07:53, 36.46s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  35%|███▌      | 7/20 [04:51<07:53, 36.46s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  40%|████      | 8/20 [04:51<07:13, 36.11s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  40%|████      | 8/20 [05:26<07:13, 36.11s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  45%|████▌     | 9/20 [05:26<06:35, 35.92s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  45%|████▌     | 9/20 [06:02<06:35, 35.92s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  50%|█████     | 10/20 [06:02<05:57, 35.80s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  50%|█████     | 10/20 [06:41<05:57, 35.80s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  55%|█████▌    | 11/20 [06:41<05:32, 36.91s/it]
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  55%|█████▌    | 11/20 [07:17<05:32, 36.91s/it]                 
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  60%|██████    | 12/20 [07:17<04:51, 36.49s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  60%|██████    | 12/20 [07:52<04:51, 36.49s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  65%|██████▌   | 13/20 [07:52<04:13, 36.19s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  65%|██████▌   | 13/20 [08:28<04:13, 36.19s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  70%|███████   | 14/20 [08:28<03:36, 36.13s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  70%|███████   | 14/20 [09:04<03:36, 36.13s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  75%|███████▌  | 15/20 [09:04<03:00, 36.01s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  75%|███████▌  | 15/20 [09:43<03:00, 36.01s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  80%|████████  | 16/20 [09:43<02:28, 37.01s/it]
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  80%|████████  | 16/20 [10:19<02:28, 37.01s/it]                 
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  85%|████████▌ | 17/20 [10:19<01:49, 36.61s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  85%|████████▌ | 17/20 [10:55<01:49, 36.61s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  90%|█████████ | 18/20 [10:55<01:12, 36.32s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  90%|█████████ | 18/20 [11:30<01:12, 36.32s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  95%|█████████▌| 19/20 [11:30<00:36, 36.07s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29:  95%|█████████▌| 19/20 [12:06<00:36, 36.07s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [12:06<00:00, 35.95s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [12:06<00:00, 36.31s/it]
2024-09-04 18:06:41,962 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29
2024-09-04 18:06:45,875 [trainer.py] => No NME accuracy.
2024-09-04 18:06:45,876 [trainer.py] => CNN: {'total': 88.47, '00-99': 88.47, 'old': 0, 'new': 88.47}
2024-09-04 18:06:45,876 [trainer.py] => CNN top1 curve: [88.47]
2024-09-04 18:06:45,876 [trainer.py] => CNN top5 curve: [98.15]

Average Accuracy (CNN): 88.47
2024-09-04 18:06:45,876 [trainer.py] => Average Accuracy (CNN): 88.47 

2024-09-04 18:06:45,877 [trainer.py] => All params: 85875556
2024-09-04 18:06:45,877 [trainer.py] => Trainable params: 85875556
2024-09-04 18:06:45,879 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.425, Train_accy 15.97, Test_accy 79.31:   0%|          | 0/20 [00:11<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.425, Train_accy 15.97, Test_accy 79.31:   5%|▌         | 1/20 [00:11<03:47, 11.98s/it]
Task 1, Epoch 2/20 => Loss 0.281, Train_accy 72.27:   5%|▌         | 1/20 [00:19<03:47, 11.98s/it]                 
Task 1, Epoch 2/20 => Loss 0.281, Train_accy 72.27:  10%|█         | 2/20 [00:19<02:48,  9.38s/it]
Task 1, Epoch 3/20 => Loss 0.185, Train_accy 82.56:  10%|█         | 2/20 [00:27<02:48,  9.38s/it]
Task 1, Epoch 3/20 => Loss 0.185, Train_accy 82.56:  15%|█▌        | 3/20 [00:27<02:25,  8.55s/it]
Task 1, Epoch 4/20 => Loss 0.210, Train_accy 82.77:  15%|█▌        | 3/20 [00:34<02:25,  8.55s/it]
Task 1, Epoch 4/20 => Loss 0.210, Train_accy 82.77:  20%|██        | 4/20 [00:34<02:10,  8.17s/it]
Task 1, Epoch 5/20 => Loss 0.204, Train_accy 82.77:  20%|██        | 4/20 [00:42<02:10,  8.17s/it]
Task 1, Epoch 5/20 => Loss 0.204, Train_accy 82.77:  25%|██▌       | 5/20 [00:42<01:59,  7.98s/it]
Task 1, Epoch 6/20 => Loss 0.173, Train_accy 85.92, Test_accy 80.37:  25%|██▌       | 5/20 [00:54<01:59,  7.98s/it]
Task 1, Epoch 6/20 => Loss 0.173, Train_accy 85.92, Test_accy 80.37:  30%|███       | 6/20 [00:54<02:10,  9.36s/it]
Task 1, Epoch 7/20 => Loss 0.146, Train_accy 86.45:  30%|███       | 6/20 [01:01<02:10,  9.36s/it]                 
Task 1, Epoch 7/20 => Loss 0.146, Train_accy 86.45:  35%|███▌      | 7/20 [01:01<01:53,  8.76s/it]
Task 1, Epoch 8/20 => Loss 0.165, Train_accy 88.03:  35%|███▌      | 7/20 [01:09<01:53,  8.76s/it]
Task 1, Epoch 8/20 => Loss 0.165, Train_accy 88.03:  40%|████      | 8/20 [01:09<01:40,  8.38s/it]
Task 1, Epoch 9/20 => Loss 0.155, Train_accy 88.55:  40%|████      | 8/20 [01:16<01:40,  8.38s/it]
Task 1, Epoch 9/20 => Loss 0.155, Train_accy 88.55:  45%|████▌     | 9/20 [01:16<01:29,  8.10s/it]
Task 1, Epoch 10/20 => Loss 0.126, Train_accy 87.08:  45%|████▌     | 9/20 [01:24<01:29,  8.10s/it]
Task 1, Epoch 10/20 => Loss 0.126, Train_accy 87.08:  50%|█████     | 10/20 [01:24<01:19,  7.92s/it]
Task 1, Epoch 11/20 => Loss 0.098, Train_accy 90.76, Test_accy 80.37:  50%|█████     | 10/20 [01:36<01:19,  7.92s/it]
Task 1, Epoch 11/20 => Loss 0.098, Train_accy 90.76, Test_accy 80.37:  55%|█████▌    | 11/20 [01:36<01:22,  9.17s/it]
Task 1, Epoch 12/20 => Loss 0.127, Train_accy 91.28:  55%|█████▌    | 11/20 [01:44<01:22,  9.17s/it]                 
Task 1, Epoch 12/20 => Loss 0.127, Train_accy 91.28:  60%|██████    | 12/20 [01:44<01:09,  8.69s/it]
Task 1, Epoch 13/20 => Loss 0.164, Train_accy 88.03:  60%|██████    | 12/20 [01:51<01:09,  8.69s/it]
Task 1, Epoch 13/20 => Loss 0.164, Train_accy 88.03:  65%|██████▌   | 13/20 [01:51<00:58,  8.34s/it]
Task 1, Epoch 14/20 => Loss 0.171, Train_accy 87.39:  65%|██████▌   | 13/20 [01:59<00:58,  8.34s/it]
Task 1, Epoch 14/20 => Loss 0.171, Train_accy 87.39:  70%|███████   | 14/20 [01:59<00:48,  8.11s/it]
Task 1, Epoch 15/20 => Loss 0.156, Train_accy 89.29:  70%|███████   | 14/20 [02:06<00:48,  8.11s/it]
Task 1, Epoch 15/20 => Loss 0.156, Train_accy 89.29:  75%|███████▌  | 15/20 [02:06<00:39,  7.93s/it]
Task 1, Epoch 16/20 => Loss 0.165, Train_accy 88.34, Test_accy 79.31:  75%|███████▌  | 15/20 [02:18<00:39,  7.93s/it]
Task 1, Epoch 16/20 => Loss 0.165, Train_accy 88.34, Test_accy 79.31:  80%|████████  | 16/20 [02:18<00:36,  9.21s/it]
Task 1, Epoch 17/20 => Loss 0.118, Train_accy 91.07:  80%|████████  | 16/20 [02:26<00:36,  9.21s/it]                 
Task 1, Epoch 17/20 => Loss 0.118, Train_accy 91.07:  85%|████████▌ | 17/20 [02:26<00:26,  8.69s/it]
Task 1, Epoch 18/20 => Loss 0.121, Train_accy 92.12:  85%|████████▌ | 17/20 [02:33<00:26,  8.69s/it]
Task 1, Epoch 18/20 => Loss 0.121, Train_accy 92.12:  90%|█████████ | 18/20 [02:33<00:16,  8.33s/it]
Task 1, Epoch 19/20 => Loss 0.138, Train_accy 89.92:  90%|█████████ | 18/20 [02:41<00:16,  8.33s/it]
Task 1, Epoch 19/20 => Loss 0.138, Train_accy 89.92:  95%|█████████▌| 19/20 [02:41<00:08,  8.09s/it]
Task 1, Epoch 20/20 => Loss 0.115, Train_accy 91.60:  95%|█████████▌| 19/20 [02:48<00:08,  8.09s/it]
Task 1, Epoch 20/20 => Loss 0.115, Train_accy 91.60: 100%|██████████| 20/20 [02:48<00:00,  7.92s/it]
Task 1, Epoch 20/20 => Loss 0.115, Train_accy 91.60: 100%|██████████| 20/20 [02:48<00:00,  8.44s/it]
2024-09-04 18:09:34,751 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.115, Train_accy 91.60
2024-09-04 18:09:39,225 [trainer.py] => No NME accuracy.
2024-09-04 18:09:39,226 [trainer.py] => CNN: {'total': 80.93, '00-99': 78.62, '100-119': 92.98, 'old': 78.62, 'new': 92.98}
2024-09-04 18:09:39,226 [trainer.py] => CNN top1 curve: [88.47, 80.93]
2024-09-04 18:09:39,226 [trainer.py] => CNN top5 curve: [98.15, 97.39]

Average Accuracy (CNN): 84.7
2024-09-04 18:09:39,226 [trainer.py] => Average Accuracy (CNN): 84.7 

2024-09-04 18:09:39,227 [trainer.py] => All params: 85890936
2024-09-04 18:09:39,228 [trainer.py] => Trainable params: 85890936
2024-09-04 18:09:39,231 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.788, Train_accy 10.48, Test_accy 74.95:   0%|          | 0/20 [00:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.788, Train_accy 10.48, Test_accy 74.95:   5%|▌         | 1/20 [00:12<04:02, 12.76s/it]
Task 2, Epoch 2/20 => Loss 0.487, Train_accy 64.15:   5%|▌         | 1/20 [00:20<04:02, 12.76s/it]                 
Task 2, Epoch 2/20 => Loss 0.487, Train_accy 64.15:  10%|█         | 2/20 [00:20<02:54,  9.68s/it]
Task 2, Epoch 3/20 => Loss 0.462, Train_accy 76.42:  10%|█         | 2/20 [00:27<02:54,  9.68s/it]
Task 2, Epoch 3/20 => Loss 0.462, Train_accy 76.42:  15%|█▌        | 3/20 [00:27<02:28,  8.75s/it]
Task 2, Epoch 4/20 => Loss 0.367, Train_accy 80.29:  15%|█▌        | 3/20 [00:35<02:28,  8.75s/it]
Task 2, Epoch 4/20 => Loss 0.367, Train_accy 80.29:  20%|██        | 4/20 [00:35<02:12,  8.26s/it]
Task 2, Epoch 5/20 => Loss 0.291, Train_accy 83.54:  20%|██        | 4/20 [00:42<02:12,  8.26s/it]
Task 2, Epoch 5/20 => Loss 0.291, Train_accy 83.54:  25%|██▌       | 5/20 [00:42<02:00,  8.00s/it]
Task 2, Epoch 6/20 => Loss 0.265, Train_accy 85.53, Test_accy 78.00:  25%|██▌       | 5/20 [00:55<02:00,  8.00s/it]
Task 2, Epoch 6/20 => Loss 0.265, Train_accy 85.53, Test_accy 78.00:  30%|███       | 6/20 [00:55<02:14,  9.61s/it]
Task 2, Epoch 7/20 => Loss 0.297, Train_accy 83.86:  30%|███       | 6/20 [01:03<02:14,  9.61s/it]                 
Task 2, Epoch 7/20 => Loss 0.297, Train_accy 83.86:  35%|███▌      | 7/20 [01:03<01:56,  8.94s/it]
Task 2, Epoch 8/20 => Loss 0.223, Train_accy 87.21:  35%|███▌      | 7/20 [01:10<01:56,  8.94s/it]
Task 2, Epoch 8/20 => Loss 0.223, Train_accy 87.21:  40%|████      | 8/20 [01:10<01:41,  8.49s/it]
Task 2, Epoch 9/20 => Loss 0.244, Train_accy 87.00:  40%|████      | 8/20 [01:18<01:41,  8.49s/it]
Task 2, Epoch 9/20 => Loss 0.244, Train_accy 87.00:  45%|████▌     | 9/20 [01:18<01:29,  8.17s/it]
Task 2, Epoch 10/20 => Loss 0.213, Train_accy 88.26:  45%|████▌     | 9/20 [01:25<01:29,  8.17s/it]
Task 2, Epoch 10/20 => Loss 0.213, Train_accy 88.26:  50%|█████     | 10/20 [01:25<01:19,  7.99s/it]
Task 2, Epoch 11/20 => Loss 0.206, Train_accy 88.57, Test_accy 77.64:  50%|█████     | 10/20 [01:38<01:19,  7.99s/it]
Task 2, Epoch 11/20 => Loss 0.206, Train_accy 88.57, Test_accy 77.64:  55%|█████▌    | 11/20 [01:38<01:24,  9.41s/it]
Task 2, Epoch 12/20 => Loss 0.221, Train_accy 88.99:  55%|█████▌    | 11/20 [01:46<01:24,  9.41s/it]                 
Task 2, Epoch 12/20 => Loss 0.221, Train_accy 88.99:  60%|██████    | 12/20 [01:46<01:10,  8.86s/it]
Task 2, Epoch 13/20 => Loss 0.234, Train_accy 87.32:  60%|██████    | 12/20 [01:53<01:10,  8.86s/it]
Task 2, Epoch 13/20 => Loss 0.234, Train_accy 87.32:  65%|██████▌   | 13/20 [01:53<00:59,  8.47s/it]
Task 2, Epoch 14/20 => Loss 0.205, Train_accy 87.42:  65%|██████▌   | 13/20 [02:01<00:59,  8.47s/it]
Task 2, Epoch 14/20 => Loss 0.205, Train_accy 87.42:  70%|███████   | 14/20 [02:01<00:49,  8.21s/it]
Task 2, Epoch 15/20 => Loss 0.207, Train_accy 87.95:  70%|███████   | 14/20 [02:08<00:49,  8.21s/it]
Task 2, Epoch 15/20 => Loss 0.207, Train_accy 87.95:  75%|███████▌  | 15/20 [02:08<00:40,  8.01s/it]
Task 2, Epoch 16/20 => Loss 0.176, Train_accy 89.52, Test_accy 77.88:  75%|███████▌  | 15/20 [02:21<00:40,  8.01s/it]
Task 2, Epoch 16/20 => Loss 0.176, Train_accy 89.52, Test_accy 77.88:  80%|████████  | 16/20 [02:21<00:37,  9.40s/it]
Task 2, Epoch 17/20 => Loss 0.206, Train_accy 88.26:  80%|████████  | 16/20 [02:28<00:37,  9.40s/it]                 
Task 2, Epoch 17/20 => Loss 0.206, Train_accy 88.26:  85%|████████▌ | 17/20 [02:28<00:26,  8.83s/it]
Task 2, Epoch 18/20 => Loss 0.160, Train_accy 89.62:  85%|████████▌ | 17/20 [02:36<00:26,  8.83s/it]
Task 2, Epoch 18/20 => Loss 0.160, Train_accy 89.62:  90%|█████████ | 18/20 [02:36<00:16,  8.45s/it]
Task 2, Epoch 19/20 => Loss 0.189, Train_accy 88.89:  90%|█████████ | 18/20 [02:44<00:16,  8.45s/it]
Task 2, Epoch 19/20 => Loss 0.189, Train_accy 88.89:  95%|█████████▌| 19/20 [02:44<00:08,  8.17s/it]
Task 2, Epoch 20/20 => Loss 0.211, Train_accy 86.79:  95%|█████████▌| 19/20 [02:51<00:08,  8.17s/it]
Task 2, Epoch 20/20 => Loss 0.211, Train_accy 86.79: 100%|██████████| 20/20 [02:51<00:00,  7.98s/it]
Task 2, Epoch 20/20 => Loss 0.211, Train_accy 86.79: 100%|██████████| 20/20 [02:51<00:00,  8.58s/it]
2024-09-04 18:12:30,826 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.211, Train_accy 86.79
2024-09-04 18:12:36,063 [trainer.py] => No NME accuracy.
2024-09-04 18:12:36,063 [trainer.py] => CNN: {'total': 77.51, '00-99': 72.81, '100-119': 89.91, '120-139': 89.78, 'old': 75.56, 'new': 89.78}
2024-09-04 18:12:36,063 [trainer.py] => CNN top1 curve: [88.47, 80.93, 77.51]
2024-09-04 18:12:36,063 [trainer.py] => CNN top5 curve: [98.15, 97.39, 96.65]

Average Accuracy (CNN): 82.3
2024-09-04 18:12:36,064 [trainer.py] => Average Accuracy (CNN): 82.3 

2024-09-04 18:12:36,065 [trainer.py] => All params: 85906316
2024-09-04 18:12:36,066 [trainer.py] => Trainable params: 85906316
2024-09-04 18:12:36,069 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.466, Train_accy 10.43, Test_accy 67.79:   0%|          | 0/20 [00:13<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.466, Train_accy 10.43, Test_accy 67.79:   5%|▌         | 1/20 [00:13<04:10, 13.18s/it]
Task 3, Epoch 2/20 => Loss 0.408, Train_accy 59.24:   5%|▌         | 1/20 [00:20<04:10, 13.18s/it]                 
Task 3, Epoch 2/20 => Loss 0.408, Train_accy 59.24:  10%|█         | 2/20 [00:20<02:54,  9.71s/it]
Task 3, Epoch 3/20 => Loss 0.286, Train_accy 72.07:  10%|█         | 2/20 [00:27<02:54,  9.71s/it]
Task 3, Epoch 3/20 => Loss 0.286, Train_accy 72.07:  15%|█▌        | 3/20 [00:27<02:26,  8.62s/it]
Task 3, Epoch 4/20 => Loss 0.249, Train_accy 75.76:  15%|█▌        | 3/20 [00:35<02:26,  8.62s/it]
Task 3, Epoch 4/20 => Loss 0.249, Train_accy 75.76:  20%|██        | 4/20 [00:35<02:09,  8.10s/it]
Task 3, Epoch 5/20 => Loss 0.209, Train_accy 76.85:  20%|██        | 4/20 [00:42<02:09,  8.10s/it]
Task 3, Epoch 5/20 => Loss 0.209, Train_accy 76.85:  25%|██▌       | 5/20 [00:42<01:56,  7.80s/it]
Task 3, Epoch 6/20 => Loss 0.205, Train_accy 77.28, Test_accy 71.34:  25%|██▌       | 5/20 [00:55<01:56,  7.80s/it]
Task 3, Epoch 6/20 => Loss 0.205, Train_accy 77.28, Test_accy 71.34:  30%|███       | 6/20 [00:55<02:13,  9.56s/it]
Task 3, Epoch 7/20 => Loss 0.237, Train_accy 79.67:  30%|███       | 6/20 [01:02<02:13,  9.56s/it]                 
Task 3, Epoch 7/20 => Loss 0.237, Train_accy 79.67:  35%|███▌      | 7/20 [01:02<01:54,  8.83s/it]
Task 3, Epoch 8/20 => Loss 0.244, Train_accy 79.78:  35%|███▌      | 7/20 [01:09<01:54,  8.83s/it]
Task 3, Epoch 8/20 => Loss 0.244, Train_accy 79.78:  40%|████      | 8/20 [01:09<01:40,  8.33s/it]
Task 3, Epoch 9/20 => Loss 0.236, Train_accy 79.35:  40%|████      | 8/20 [01:17<01:40,  8.33s/it]
Task 3, Epoch 9/20 => Loss 0.236, Train_accy 79.35:  45%|████▌     | 9/20 [01:17<01:28,  8.03s/it]
Task 3, Epoch 10/20 => Loss 0.243, Train_accy 80.22:  45%|████▌     | 9/20 [01:24<01:28,  8.03s/it]
Task 3, Epoch 10/20 => Loss 0.243, Train_accy 80.22:  50%|█████     | 10/20 [01:24<01:18,  7.81s/it]
Task 3, Epoch 11/20 => Loss 0.195, Train_accy 81.20, Test_accy 70.65:  50%|█████     | 10/20 [01:37<01:18,  7.81s/it]
Task 3, Epoch 11/20 => Loss 0.195, Train_accy 81.20, Test_accy 70.65:  55%|█████▌    | 11/20 [01:37<01:25,  9.47s/it]
Task 3, Epoch 12/20 => Loss 0.205, Train_accy 82.28:  55%|█████▌    | 11/20 [01:45<01:25,  9.47s/it]                 
Task 3, Epoch 12/20 => Loss 0.205, Train_accy 82.28:  60%|██████    | 12/20 [01:45<01:10,  8.82s/it]
Task 3, Epoch 13/20 => Loss 0.177, Train_accy 82.72:  60%|██████    | 12/20 [01:52<01:10,  8.82s/it]
Task 3, Epoch 13/20 => Loss 0.177, Train_accy 82.72:  65%|██████▌   | 13/20 [01:52<00:58,  8.37s/it]
Task 3, Epoch 14/20 => Loss 0.202, Train_accy 83.80:  65%|██████▌   | 13/20 [02:00<00:58,  8.37s/it]
Task 3, Epoch 14/20 => Loss 0.202, Train_accy 83.80:  70%|███████   | 14/20 [02:00<00:48,  8.11s/it]
Task 3, Epoch 15/20 => Loss 0.169, Train_accy 84.02:  70%|███████   | 14/20 [02:07<00:48,  8.11s/it]
Task 3, Epoch 15/20 => Loss 0.169, Train_accy 84.02:  75%|███████▌  | 15/20 [02:07<00:39,  7.87s/it]
Task 3, Epoch 16/20 => Loss 0.138, Train_accy 85.87, Test_accy 72.71:  75%|███████▌  | 15/20 [02:20<00:39,  7.87s/it]
Task 3, Epoch 16/20 => Loss 0.138, Train_accy 85.87, Test_accy 72.71:  80%|████████  | 16/20 [02:20<00:37,  9.47s/it]
Task 3, Epoch 17/20 => Loss 0.192, Train_accy 83.04:  80%|████████  | 16/20 [02:27<00:37,  9.47s/it]                 
Task 3, Epoch 17/20 => Loss 0.192, Train_accy 83.04:  85%|████████▌ | 17/20 [02:27<00:26,  8.82s/it]
Task 3, Epoch 18/20 => Loss 0.126, Train_accy 86.74:  85%|████████▌ | 17/20 [02:35<00:26,  8.82s/it]
Task 3, Epoch 18/20 => Loss 0.126, Train_accy 86.74:  90%|█████████ | 18/20 [02:35<00:16,  8.36s/it]
Task 3, Epoch 19/20 => Loss 0.179, Train_accy 85.98:  90%|█████████ | 18/20 [02:42<00:16,  8.36s/it]
Task 3, Epoch 19/20 => Loss 0.179, Train_accy 85.98:  95%|█████████▌| 19/20 [02:42<00:08,  8.04s/it]
Task 3, Epoch 20/20 => Loss 0.178, Train_accy 84.35:  95%|█████████▌| 19/20 [02:49<00:08,  8.04s/it]
Task 3, Epoch 20/20 => Loss 0.178, Train_accy 84.35: 100%|██████████| 20/20 [02:49<00:00,  7.82s/it]
Task 3, Epoch 20/20 => Loss 0.178, Train_accy 84.35: 100%|██████████| 20/20 [02:49<00:00,  8.48s/it]
2024-09-04 18:15:25,778 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.178, Train_accy 84.35
2024-09-04 18:15:31,662 [trainer.py] => No NME accuracy.
2024-09-04 18:15:31,662 [trainer.py] => CNN: {'total': 68.59, '00-99': 61.53, '100-119': 78.07, '120-139': 77.78, '140-159': 85.2, 'old': 66.06, 'new': 85.2}
2024-09-04 18:15:31,663 [trainer.py] => CNN top1 curve: [88.47, 80.93, 77.51, 68.59]
2024-09-04 18:15:31,663 [trainer.py] => CNN top5 curve: [98.15, 97.39, 96.65, 95.61]

Average Accuracy (CNN): 78.88
2024-09-04 18:15:31,663 [trainer.py] => Average Accuracy (CNN): 78.88 

2024-09-04 18:15:31,664 [trainer.py] => All params: 85921696
2024-09-04 18:15:31,664 [trainer.py] => Trainable params: 85921696
2024-09-04 18:15:31,666 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.699, Train_accy 9.19, Test_accy 63.30:   0%|          | 0/20 [00:14<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.699, Train_accy 9.19, Test_accy 63.30:   5%|▌         | 1/20 [00:14<04:27, 14.10s/it]
Task 4, Epoch 2/20 => Loss 0.359, Train_accy 62.94:   5%|▌         | 1/20 [00:21<04:27, 14.10s/it]                
Task 4, Epoch 2/20 => Loss 0.359, Train_accy 62.94:  10%|█         | 2/20 [00:21<03:05, 10.31s/it]
Task 4, Epoch 3/20 => Loss 0.218, Train_accy 74.11:  10%|█         | 2/20 [00:29<03:05, 10.31s/it]
Task 4, Epoch 3/20 => Loss 0.218, Train_accy 74.11:  15%|█▌        | 3/20 [00:29<02:34,  9.07s/it]
Task 4, Epoch 4/20 => Loss 0.245, Train_accy 75.57:  15%|█▌        | 3/20 [00:36<02:34,  9.07s/it]
Task 4, Epoch 4/20 => Loss 0.245, Train_accy 75.57:  20%|██        | 4/20 [00:36<02:16,  8.50s/it]
Task 4, Epoch 5/20 => Loss 0.186, Train_accy 78.71:  20%|██        | 4/20 [00:44<02:16,  8.50s/it]
Task 4, Epoch 5/20 => Loss 0.186, Train_accy 78.71:  25%|██▌       | 5/20 [00:44<02:02,  8.16s/it]
Task 4, Epoch 6/20 => Loss 0.248, Train_accy 76.93, Test_accy 62.45:  25%|██▌       | 5/20 [00:58<02:02,  8.16s/it]
Task 4, Epoch 6/20 => Loss 0.248, Train_accy 76.93, Test_accy 62.45:  30%|███       | 6/20 [00:58<02:22, 10.17s/it]
Task 4, Epoch 7/20 => Loss 0.204, Train_accy 76.72:  30%|███       | 6/20 [01:06<02:22, 10.17s/it]                 
Task 4, Epoch 7/20 => Loss 0.204, Train_accy 76.72:  35%|███▌      | 7/20 [01:06<02:01,  9.32s/it]
Task 4, Epoch 8/20 => Loss 0.183, Train_accy 79.96:  35%|███▌      | 7/20 [01:13<02:01,  9.32s/it]
Task 4, Epoch 8/20 => Loss 0.183, Train_accy 79.96:  40%|████      | 8/20 [01:13<01:45,  8.75s/it]
Task 4, Epoch 9/20 => Loss 0.169, Train_accy 80.69:  40%|████      | 8/20 [01:21<01:45,  8.75s/it]
Task 4, Epoch 9/20 => Loss 0.169, Train_accy 80.69:  45%|████▌     | 9/20 [01:21<01:32,  8.40s/it]
Task 4, Epoch 10/20 => Loss 0.219, Train_accy 82.05:  45%|████▌     | 9/20 [01:28<01:32,  8.40s/it]
Task 4, Epoch 10/20 => Loss 0.219, Train_accy 82.05:  50%|█████     | 10/20 [01:28<01:21,  8.16s/it]
Task 4, Epoch 11/20 => Loss 0.192, Train_accy 82.46, Test_accy 61.33:  50%|█████     | 10/20 [01:43<01:21,  8.16s/it]
Task 4, Epoch 11/20 => Loss 0.192, Train_accy 82.46, Test_accy 61.33:  55%|█████▌    | 11/20 [01:43<01:30, 10.00s/it]
Task 4, Epoch 12/20 => Loss 0.138, Train_accy 84.13:  55%|█████▌    | 11/20 [01:50<01:30, 10.00s/it]                 
Task 4, Epoch 12/20 => Loss 0.138, Train_accy 84.13:  60%|██████    | 12/20 [01:50<01:14,  9.27s/it]
Task 4, Epoch 13/20 => Loss 0.161, Train_accy 85.70:  60%|██████    | 12/20 [01:58<01:14,  9.27s/it]
Task 4, Epoch 13/20 => Loss 0.161, Train_accy 85.70:  65%|██████▌   | 13/20 [01:58<01:01,  8.75s/it]
Task 4, Epoch 14/20 => Loss 0.159, Train_accy 84.03:  65%|██████▌   | 13/20 [02:05<01:01,  8.75s/it]
Task 4, Epoch 14/20 => Loss 0.159, Train_accy 84.03:  70%|███████   | 14/20 [02:05<00:50,  8.39s/it]
Task 4, Epoch 15/20 => Loss 0.188, Train_accy 84.03:  70%|███████   | 14/20 [02:13<00:50,  8.39s/it]
Task 4, Epoch 15/20 => Loss 0.188, Train_accy 84.03:  75%|███████▌  | 15/20 [02:13<00:40,  8.14s/it]
Task 4, Epoch 16/20 => Loss 0.178, Train_accy 83.92, Test_accy 62.50:  75%|███████▌  | 15/20 [02:27<00:40,  8.14s/it]
Task 4, Epoch 16/20 => Loss 0.178, Train_accy 83.92, Test_accy 62.50:  80%|████████  | 16/20 [02:27<00:39,  9.92s/it]
Task 4, Epoch 17/20 => Loss 0.167, Train_accy 84.76:  80%|████████  | 16/20 [02:35<00:39,  9.92s/it]                 
Task 4, Epoch 17/20 => Loss 0.167, Train_accy 84.76:  85%|████████▌ | 17/20 [02:35<00:27,  9.22s/it]
Task 4, Epoch 18/20 => Loss 0.149, Train_accy 83.51:  85%|████████▌ | 17/20 [02:42<00:27,  9.22s/it]
Task 4, Epoch 18/20 => Loss 0.149, Train_accy 83.51:  90%|█████████ | 18/20 [02:42<00:17,  8.73s/it]
Task 4, Epoch 19/20 => Loss 0.158, Train_accy 83.61:  90%|█████████ | 18/20 [02:50<00:17,  8.73s/it]
Task 4, Epoch 19/20 => Loss 0.158, Train_accy 83.61:  95%|█████████▌| 19/20 [02:50<00:08,  8.39s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 84.76:  95%|█████████▌| 19/20 [02:57<00:08,  8.39s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 84.76: 100%|██████████| 20/20 [02:57<00:00,  8.16s/it]
Task 4, Epoch 20/20 => Loss 0.134, Train_accy 84.76: 100%|██████████| 20/20 [02:57<00:00,  8.89s/it]
2024-09-04 18:18:29,522 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.134, Train_accy 84.76
2024-09-04 18:18:36,132 [trainer.py] => No NME accuracy.
2024-09-04 18:18:36,133 [trainer.py] => CNN: {'total': 63.35, '00-99': 54.21, '100-119': 72.37, '120-139': 65.33, '140-159': 72.8, '160-179': 88.61, 'old': 60.18, 'new': 88.61}
2024-09-04 18:18:36,133 [trainer.py] => CNN top1 curve: [88.47, 80.93, 77.51, 68.59, 63.35]
2024-09-04 18:18:36,133 [trainer.py] => CNN top5 curve: [98.15, 97.39, 96.65, 95.61, 94.03]

Average Accuracy (CNN): 75.77
2024-09-04 18:18:36,133 [trainer.py] => Average Accuracy (CNN): 75.77 

2024-09-04 18:18:36,136 [trainer.py] => All params: 85937076
2024-09-04 18:18:36,137 [trainer.py] => Trainable params: 85937076
2024-09-04 18:18:36,142 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.788, Train_accy 6.51, Test_accy 55.09:   0%|          | 0/20 [00:14<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.788, Train_accy 6.51, Test_accy 55.09:   5%|▌         | 1/20 [00:14<04:41, 14.83s/it]
Task 5, Epoch 2/20 => Loss 0.421, Train_accy 55.57:   5%|▌         | 1/20 [00:22<04:41, 14.83s/it]                
Task 5, Epoch 2/20 => Loss 0.421, Train_accy 55.57:  10%|█         | 2/20 [00:22<03:09, 10.53s/it]
Task 5, Epoch 3/20 => Loss 0.314, Train_accy 76.16:  10%|█         | 2/20 [00:29<03:09, 10.53s/it]
Task 5, Epoch 3/20 => Loss 0.314, Train_accy 76.16:  15%|█▌        | 3/20 [00:29<02:35,  9.16s/it]
Task 5, Epoch 4/20 => Loss 0.240, Train_accy 79.31:  15%|█▌        | 3/20 [00:37<02:35,  9.16s/it]
Task 5, Epoch 4/20 => Loss 0.240, Train_accy 79.31:  20%|██        | 4/20 [00:37<02:16,  8.52s/it]
Task 5, Epoch 5/20 => Loss 0.284, Train_accy 80.46:  20%|██        | 4/20 [00:45<02:16,  8.52s/it]
Task 5, Epoch 5/20 => Loss 0.284, Train_accy 80.46:  25%|██▌       | 5/20 [00:45<02:02,  8.19s/it]
Task 5, Epoch 6/20 => Loss 0.214, Train_accy 81.09, Test_accy 60.77:  25%|██▌       | 5/20 [00:59<02:02,  8.19s/it]
Task 5, Epoch 6/20 => Loss 0.214, Train_accy 81.09, Test_accy 60.77:  30%|███       | 6/20 [00:59<02:25, 10.40s/it]
Task 5, Epoch 7/20 => Loss 0.251, Train_accy 81.30:  30%|███       | 6/20 [01:07<02:25, 10.40s/it]                 
Task 5, Epoch 7/20 => Loss 0.251, Train_accy 81.30:  35%|███▌      | 7/20 [01:07<02:03,  9.49s/it]
Task 5, Epoch 8/20 => Loss 0.210, Train_accy 81.41:  35%|███▌      | 7/20 [01:14<02:03,  9.49s/it]
Task 5, Epoch 8/20 => Loss 0.210, Train_accy 81.41:  40%|████      | 8/20 [01:14<01:46,  8.87s/it]
Task 5, Epoch 9/20 => Loss 0.203, Train_accy 83.72:  40%|████      | 8/20 [01:22<01:46,  8.87s/it]
Task 5, Epoch 9/20 => Loss 0.203, Train_accy 83.72:  45%|████▌     | 9/20 [01:22<01:33,  8.46s/it]
Task 5, Epoch 10/20 => Loss 0.203, Train_accy 84.35:  45%|████▌     | 9/20 [01:30<01:33,  8.46s/it]
Task 5, Epoch 10/20 => Loss 0.203, Train_accy 84.35:  50%|█████     | 10/20 [01:30<01:21,  8.19s/it]
Task 5, Epoch 11/20 => Loss 0.170, Train_accy 85.29, Test_accy 61.75:  50%|█████     | 10/20 [01:44<01:21,  8.19s/it]
Task 5, Epoch 11/20 => Loss 0.170, Train_accy 85.29, Test_accy 61.75:  55%|█████▌    | 11/20 [01:44<01:32, 10.23s/it]
Task 5, Epoch 12/20 => Loss 0.189, Train_accy 84.45:  55%|█████▌    | 11/20 [01:52<01:32, 10.23s/it]                 
Task 5, Epoch 12/20 => Loss 0.189, Train_accy 84.45:  60%|██████    | 12/20 [01:52<01:15,  9.40s/it]
Task 5, Epoch 13/20 => Loss 0.186, Train_accy 86.55:  60%|██████    | 12/20 [01:59<01:15,  9.40s/it]
Task 5, Epoch 13/20 => Loss 0.186, Train_accy 86.55:  65%|██████▌   | 13/20 [01:59<01:01,  8.84s/it]
Task 5, Epoch 14/20 => Loss 0.189, Train_accy 87.08:  65%|██████▌   | 13/20 [02:07<01:01,  8.84s/it]
Task 5, Epoch 14/20 => Loss 0.189, Train_accy 87.08:  70%|███████   | 14/20 [02:07<00:50,  8.47s/it]
Task 5, Epoch 15/20 => Loss 0.127, Train_accy 89.92:  70%|███████   | 14/20 [02:15<00:50,  8.47s/it]
Task 5, Epoch 15/20 => Loss 0.127, Train_accy 89.92:  75%|███████▌  | 15/20 [02:15<00:40,  8.17s/it]
Task 5, Epoch 16/20 => Loss 0.131, Train_accy 88.34, Test_accy 61.15:  75%|███████▌  | 15/20 [02:29<00:40,  8.17s/it]
Task 5, Epoch 16/20 => Loss 0.131, Train_accy 88.34, Test_accy 61.15:  80%|████████  | 16/20 [02:29<00:40, 10.15s/it]
Task 5, Epoch 17/20 => Loss 0.160, Train_accy 89.39:  80%|████████  | 16/20 [02:37<00:40, 10.15s/it]                 
Task 5, Epoch 17/20 => Loss 0.160, Train_accy 89.39:  85%|████████▌ | 17/20 [02:37<00:28,  9.38s/it]
Task 5, Epoch 18/20 => Loss 0.159, Train_accy 87.92:  85%|████████▌ | 17/20 [02:44<00:28,  9.38s/it]
Task 5, Epoch 18/20 => Loss 0.159, Train_accy 87.92:  90%|█████████ | 18/20 [02:44<00:17,  8.83s/it]
Task 5, Epoch 19/20 => Loss 0.166, Train_accy 88.34:  90%|█████████ | 18/20 [02:52<00:17,  8.83s/it]
Task 5, Epoch 19/20 => Loss 0.166, Train_accy 88.34:  95%|█████████▌| 19/20 [02:52<00:08,  8.44s/it]
Task 5, Epoch 20/20 => Loss 0.148, Train_accy 89.81:  95%|█████████▌| 19/20 [03:00<00:08,  8.44s/it]
Task 5, Epoch 20/20 => Loss 0.148, Train_accy 89.81: 100%|██████████| 20/20 [03:00<00:00,  8.18s/it]
Task 5, Epoch 20/20 => Loss 0.148, Train_accy 89.81: 100%|██████████| 20/20 [03:00<00:00,  9.00s/it]
2024-09-04 18:21:36,199 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.148, Train_accy 89.81
2024-09-04 18:21:43,350 [trainer.py] => No NME accuracy.
2024-09-04 18:21:43,350 [trainer.py] => CNN: {'total': 61.45, '00-99': 49.41, '100-119': 71.05, '120-139': 53.33, '140-159': 75.2, '160-179': 80.59, '180-199': 87.39, 'old': 58.65, 'new': 87.39}
2024-09-04 18:21:43,350 [trainer.py] => CNN top1 curve: [88.47, 80.93, 77.51, 68.59, 63.35, 61.45]
2024-09-04 18:21:43,350 [trainer.py] => CNN top5 curve: [98.15, 97.39, 96.65, 95.61, 94.03, 92.37]

Average Accuracy (CNN): 73.38
2024-09-04 18:21:43,350 [trainer.py] => Average Accuracy (CNN): 73.38 

Accuracy Matrix (CNN):
[[88.47 78.62 72.81 61.53 54.21 49.41]
 [ 0.   92.98 89.91 78.07 72.37 71.05]
 [ 0.    0.   89.78 77.78 65.33 53.33]
 [ 0.    0.    0.   85.2  72.8  75.2 ]
 [ 0.    0.    0.    0.   88.61 80.59]
 [ 0.    0.    0.    0.    0.   87.39]]
2024-09-04 18:21:43,351 [trainer.py] => Forgetting (CNN): 23.092000000000002
2024-09-04 18:21:46,477 [trainer.py] => config: ./exps/finetune_cub_B100_Inc10.json
2024-09-04 18:21:46,478 [trainer.py] => prefix: reproduce
2024-09-04 18:21:46,478 [trainer.py] => dataset: cub
2024-09-04 18:21:46,478 [trainer.py] => memory_size: 0
2024-09-04 18:21:46,478 [trainer.py] => memory_per_class: 0
2024-09-04 18:21:46,478 [trainer.py] => fixed_memory: False
2024-09-04 18:21:46,478 [trainer.py] => shuffle: True
2024-09-04 18:21:46,478 [trainer.py] => init_cls: 100
2024-09-04 18:21:46,478 [trainer.py] => increment: 10
2024-09-04 18:21:46,478 [trainer.py] => model_name: finetune
2024-09-04 18:21:46,478 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-04 18:21:46,478 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 18:21:46,478 [trainer.py] => seed: 1993
2024-09-04 18:21:46,478 [trainer.py] => init_epoch: 20
2024-09-04 18:21:46,478 [trainer.py] => init_lr: 0.001
2024-09-04 18:21:46,478 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-04 18:21:46,478 [trainer.py] => init_lr_decay: 0.1
2024-09-04 18:21:46,478 [trainer.py] => init_weight_decay: 0.0005
2024-09-04 18:21:46,478 [trainer.py] => epochs: 20
2024-09-04 18:21:46,478 [trainer.py] => lrate: 0.001
2024-09-04 18:21:46,478 [trainer.py] => milestones: [40, 70]
2024-09-04 18:21:46,478 [trainer.py] => lrate_decay: 0.1
2024-09-04 18:21:46,478 [trainer.py] => batch_size: 48
2024-09-04 18:21:46,478 [trainer.py] => weight_decay: 0.0002
2024-09-04 18:21:46,517 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 18:21:48,430 [trainer.py] => All params: 85798656
2024-09-04 18:21:48,431 [trainer.py] => Trainable params: 85798656
2024-09-04 18:21:48,431 [finetune.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   0%|          | 0/20 [00:39<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   5%|▌         | 1/20 [00:39<12:27, 39.36s/it]
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:   5%|▌         | 1/20 [01:14<12:27, 39.36s/it]                 
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:  10%|█         | 2/20 [01:14<11:07, 37.06s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  10%|█         | 2/20 [01:50<11:07, 37.06s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  15%|█▌        | 3/20 [01:50<10:17, 36.34s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  15%|█▌        | 3/20 [02:25<10:17, 36.34s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  20%|██        | 4/20 [02:25<09:37, 36.06s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  20%|██        | 4/20 [03:01<09:37, 36.06s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  25%|██▌       | 5/20 [03:01<08:58, 35.90s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  25%|██▌       | 5/20 [03:40<08:58, 35.90s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  30%|███       | 6/20 [03:40<08:39, 37.08s/it]
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  30%|███       | 6/20 [04:16<08:39, 37.08s/it]                 
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  35%|███▌      | 7/20 [04:16<07:54, 36.53s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  35%|███▌      | 7/20 [04:51<07:54, 36.53s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  40%|████      | 8/20 [04:51<07:14, 36.19s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  40%|████      | 8/20 [05:27<07:14, 36.19s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  45%|████▌     | 9/20 [05:27<06:36, 36.03s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  45%|████▌     | 9/20 [06:02<06:36, 36.03s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  50%|█████     | 10/20 [06:02<05:58, 35.84s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  50%|█████     | 10/20 [06:42<05:58, 35.84s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  55%|█████▌    | 11/20 [06:42<05:31, 36.89s/it]
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  55%|█████▌    | 11/20 [07:17<05:31, 36.89s/it]                 
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  60%|██████    | 12/20 [07:17<04:51, 36.46s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  60%|██████    | 12/20 [07:52<04:51, 36.46s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  65%|██████▌   | 13/20 [07:52<04:12, 36.13s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  65%|██████▌   | 13/20 [08:28<04:12, 36.13s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  70%|███████   | 14/20 [08:28<03:35, 35.90s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  70%|███████   | 14/20 [09:03<03:35, 35.90s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  75%|███████▌  | 15/20 [09:03<02:58, 35.71s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  75%|███████▌  | 15/20 [09:42<02:58, 35.71s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  80%|████████  | 16/20 [09:42<02:27, 36.75s/it]
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  80%|████████  | 16/20 [10:18<02:27, 36.75s/it]                 
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  85%|████████▌ | 17/20 [10:18<01:49, 36.37s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  85%|████████▌ | 17/20 [10:53<01:49, 36.37s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  90%|█████████ | 18/20 [10:53<01:12, 36.09s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  90%|█████████ | 18/20 [11:29<01:12, 36.09s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  95%|█████████▌| 19/20 [11:29<00:35, 35.95s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29:  95%|█████████▌| 19/20 [12:04<00:35, 35.95s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [12:04<00:00, 35.79s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [12:04<00:00, 36.24s/it]
2024-09-04 18:33:53,732 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29
2024-09-04 18:33:57,594 [trainer.py] => No NME accuracy.
2024-09-04 18:33:57,595 [trainer.py] => CNN: {'total': 88.47, '00-99': 88.47, 'old': 0, 'new': 88.47}
2024-09-04 18:33:57,595 [trainer.py] => CNN top1 curve: [88.47]
2024-09-04 18:33:57,595 [trainer.py] => CNN top5 curve: [98.15]

Average Accuracy (CNN): 88.47
2024-09-04 18:33:57,595 [trainer.py] => Average Accuracy (CNN): 88.47 

2024-09-04 18:33:57,595 [trainer.py] => All params: 85875556
2024-09-04 18:33:57,596 [trainer.py] => Trainable params: 85875556
2024-09-04 18:33:57,597 [finetune.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.435, Train_accy 6.44, Test_accy 83.27:   0%|          | 0/20 [00:08<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.435, Train_accy 6.44, Test_accy 83.27:   5%|▌         | 1/20 [00:08<02:40,  8.43s/it]
Task 1, Epoch 2/20 => Loss 0.241, Train_accy 61.33:   5%|▌         | 1/20 [00:12<02:40,  8.43s/it]                
Task 1, Epoch 2/20 => Loss 0.241, Train_accy 61.33:  10%|█         | 2/20 [00:12<01:44,  5.82s/it]
Task 1, Epoch 3/20 => Loss 0.113, Train_accy 85.45:  10%|█         | 2/20 [00:16<01:44,  5.82s/it]
Task 1, Epoch 3/20 => Loss 0.113, Train_accy 85.45:  15%|█▌        | 3/20 [00:16<01:24,  4.99s/it]
Task 1, Epoch 4/20 => Loss 0.093, Train_accy 88.57:  15%|█▌        | 3/20 [00:20<01:24,  4.99s/it]
Task 1, Epoch 4/20 => Loss 0.093, Train_accy 88.57:  20%|██        | 4/20 [00:20<01:13,  4.62s/it]
Task 1, Epoch 5/20 => Loss 0.101, Train_accy 89.19:  20%|██        | 4/20 [00:24<01:13,  4.62s/it]
Task 1, Epoch 5/20 => Loss 0.101, Train_accy 89.19:  25%|██▌       | 5/20 [00:24<01:06,  4.41s/it]
Task 1, Epoch 6/20 => Loss 0.089, Train_accy 90.44, Test_accy 81.73:  25%|██▌       | 5/20 [00:32<01:06,  4.41s/it]
Task 1, Epoch 6/20 => Loss 0.089, Train_accy 90.44, Test_accy 81.73:  30%|███       | 6/20 [00:32<01:19,  5.68s/it]
Task 1, Epoch 7/20 => Loss 0.132, Train_accy 88.98:  30%|███       | 6/20 [00:36<01:19,  5.68s/it]                 
Task 1, Epoch 7/20 => Loss 0.132, Train_accy 88.98:  35%|███▌      | 7/20 [00:36<01:06,  5.13s/it]
Task 1, Epoch 8/20 => Loss 0.127, Train_accy 87.94:  35%|███▌      | 7/20 [00:40<01:06,  5.13s/it]
Task 1, Epoch 8/20 => Loss 0.127, Train_accy 87.94:  40%|████      | 8/20 [00:40<00:57,  4.77s/it]
Task 1, Epoch 9/20 => Loss 0.102, Train_accy 90.64:  40%|████      | 8/20 [00:44<00:57,  4.77s/it]
Task 1, Epoch 9/20 => Loss 0.102, Train_accy 90.64:  45%|████▌     | 9/20 [00:44<00:50,  4.55s/it]
Task 1, Epoch 10/20 => Loss 0.129, Train_accy 90.64:  45%|████▌     | 9/20 [00:48<00:50,  4.55s/it]
Task 1, Epoch 10/20 => Loss 0.129, Train_accy 90.64:  50%|█████     | 10/20 [00:48<00:43,  4.39s/it]
Task 1, Epoch 11/20 => Loss 0.093, Train_accy 89.81, Test_accy 79.05:  50%|█████     | 10/20 [00:56<00:43,  4.39s/it]
Task 1, Epoch 11/20 => Loss 0.093, Train_accy 89.81, Test_accy 79.05:  55%|█████▌    | 11/20 [00:56<00:49,  5.53s/it]
Task 1, Epoch 12/20 => Loss 0.088, Train_accy 91.68:  55%|█████▌    | 11/20 [01:00<00:49,  5.53s/it]                 
Task 1, Epoch 12/20 => Loss 0.088, Train_accy 91.68:  60%|██████    | 12/20 [01:00<00:40,  5.06s/it]
Task 1, Epoch 13/20 => Loss 0.072, Train_accy 91.68:  60%|██████    | 12/20 [01:04<00:40,  5.06s/it]
Task 1, Epoch 13/20 => Loss 0.072, Train_accy 91.68:  65%|██████▌   | 13/20 [01:04<00:33,  4.77s/it]
Task 1, Epoch 14/20 => Loss 0.075, Train_accy 91.48:  65%|██████▌   | 13/20 [01:09<00:33,  4.77s/it]
Task 1, Epoch 14/20 => Loss 0.075, Train_accy 91.48:  70%|███████   | 14/20 [01:09<00:27,  4.56s/it]
Task 1, Epoch 15/20 => Loss 0.068, Train_accy 93.35:  70%|███████   | 14/20 [01:13<00:27,  4.56s/it]
Task 1, Epoch 15/20 => Loss 0.068, Train_accy 93.35:  75%|███████▌  | 15/20 [01:13<00:21,  4.40s/it]
Task 1, Epoch 16/20 => Loss 0.128, Train_accy 91.89, Test_accy 79.97:  75%|███████▌  | 15/20 [01:21<00:21,  4.40s/it]
Task 1, Epoch 16/20 => Loss 0.128, Train_accy 91.89, Test_accy 79.97:  80%|████████  | 16/20 [01:21<00:22,  5.52s/it]
Task 1, Epoch 17/20 => Loss 0.110, Train_accy 91.06:  80%|████████  | 16/20 [01:25<00:22,  5.52s/it]                 
Task 1, Epoch 17/20 => Loss 0.110, Train_accy 91.06:  85%|████████▌ | 17/20 [01:25<00:15,  5.08s/it]
Task 1, Epoch 18/20 => Loss 0.108, Train_accy 91.89:  85%|████████▌ | 17/20 [01:29<00:15,  5.08s/it]
Task 1, Epoch 18/20 => Loss 0.108, Train_accy 91.89:  90%|█████████ | 18/20 [01:29<00:09,  4.75s/it]
Task 1, Epoch 19/20 => Loss 0.070, Train_accy 92.93:  90%|█████████ | 18/20 [01:33<00:09,  4.75s/it]
Task 1, Epoch 19/20 => Loss 0.070, Train_accy 92.93:  95%|█████████▌| 19/20 [01:33<00:04,  4.56s/it]
Task 1, Epoch 20/20 => Loss 0.112, Train_accy 91.27:  95%|█████████▌| 19/20 [01:37<00:04,  4.56s/it]
Task 1, Epoch 20/20 => Loss 0.112, Train_accy 91.27: 100%|██████████| 20/20 [01:37<00:00,  4.39s/it]
Task 1, Epoch 20/20 => Loss 0.112, Train_accy 91.27: 100%|██████████| 20/20 [01:37<00:00,  4.87s/it]
2024-09-04 18:35:34,940 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.112, Train_accy 91.27
2024-09-04 18:35:39,089 [trainer.py] => No NME accuracy.
2024-09-04 18:35:39,090 [trainer.py] => CNN: {'total': 81.81, '00-99': 80.64, '100-109': 93.91, 'old': 80.64, 'new': 93.91}
2024-09-04 18:35:39,090 [trainer.py] => CNN top1 curve: [88.47, 81.81]
2024-09-04 18:35:39,090 [trainer.py] => CNN top5 curve: [98.15, 97.7]

Average Accuracy (CNN): 85.14
2024-09-04 18:35:39,090 [trainer.py] => Average Accuracy (CNN): 85.14 

2024-09-04 18:35:39,092 [trainer.py] => All params: 85883246
2024-09-04 18:35:39,094 [trainer.py] => Trainable params: 85883246
2024-09-04 18:35:39,097 [finetune.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.043, Train_accy 0.64, Test_accy 76.06:   0%|          | 0/20 [00:08<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.043, Train_accy 0.64, Test_accy 76.06:   5%|▌         | 1/20 [00:08<02:38,  8.34s/it]
Task 2, Epoch 2/20 => Loss 0.222, Train_accy 37.58:   5%|▌         | 1/20 [00:12<02:38,  8.34s/it]                
Task 2, Epoch 2/20 => Loss 0.222, Train_accy 37.58:  10%|█         | 2/20 [00:12<01:43,  5.73s/it]
Task 2, Epoch 3/20 => Loss 0.154, Train_accy 55.20:  10%|█         | 2/20 [00:16<01:43,  5.73s/it]
Task 2, Epoch 3/20 => Loss 0.154, Train_accy 55.20:  15%|█▌        | 3/20 [00:16<01:23,  4.88s/it]
Task 2, Epoch 4/20 => Loss 0.084, Train_accy 64.54:  15%|█▌        | 3/20 [00:20<01:23,  4.88s/it]
Task 2, Epoch 4/20 => Loss 0.084, Train_accy 64.54:  20%|██        | 4/20 [00:20<01:12,  4.51s/it]
Task 2, Epoch 5/20 => Loss 0.114, Train_accy 65.61:  20%|██        | 4/20 [00:23<01:12,  4.51s/it]
Task 2, Epoch 5/20 => Loss 0.114, Train_accy 65.61:  25%|██▌       | 5/20 [00:23<01:04,  4.30s/it]
Task 2, Epoch 6/20 => Loss 0.067, Train_accy 75.37, Test_accy 73.31:  25%|██▌       | 5/20 [00:32<01:04,  4.30s/it]
Task 2, Epoch 6/20 => Loss 0.067, Train_accy 75.37, Test_accy 73.31:  30%|███       | 6/20 [00:32<01:19,  5.69s/it]
Task 2, Epoch 7/20 => Loss 0.096, Train_accy 76.01:  30%|███       | 6/20 [00:36<01:19,  5.69s/it]                 
Task 2, Epoch 7/20 => Loss 0.096, Train_accy 76.01:  35%|███▌      | 7/20 [00:36<01:06,  5.12s/it]
Task 2, Epoch 8/20 => Loss 0.057, Train_accy 74.95:  35%|███▌      | 7/20 [00:40<01:06,  5.12s/it]
Task 2, Epoch 8/20 => Loss 0.057, Train_accy 74.95:  40%|████      | 8/20 [00:40<00:56,  4.73s/it]
Task 2, Epoch 9/20 => Loss 0.083, Train_accy 77.28:  40%|████      | 8/20 [00:44<00:56,  4.73s/it]
Task 2, Epoch 9/20 => Loss 0.083, Train_accy 77.28:  45%|████▌     | 9/20 [00:44<00:49,  4.47s/it]
Task 2, Epoch 10/20 => Loss 0.099, Train_accy 72.40:  45%|████▌     | 9/20 [00:48<00:49,  4.47s/it]
Task 2, Epoch 10/20 => Loss 0.099, Train_accy 72.40:  50%|█████     | 10/20 [00:48<00:43,  4.31s/it]
Task 2, Epoch 11/20 => Loss 0.086, Train_accy 74.31, Test_accy 73.80:  50%|█████     | 10/20 [00:56<00:43,  4.31s/it]
Task 2, Epoch 11/20 => Loss 0.086, Train_accy 74.31, Test_accy 73.80:  55%|█████▌    | 11/20 [00:56<00:50,  5.56s/it]
Task 2, Epoch 12/20 => Loss 0.101, Train_accy 75.16:  55%|█████▌    | 11/20 [01:00<00:50,  5.56s/it]                 
Task 2, Epoch 12/20 => Loss 0.101, Train_accy 75.16:  60%|██████    | 12/20 [01:00<00:40,  5.06s/it]
Task 2, Epoch 13/20 => Loss 0.097, Train_accy 77.71:  60%|██████    | 12/20 [01:04<00:40,  5.06s/it]
Task 2, Epoch 13/20 => Loss 0.097, Train_accy 77.71:  65%|██████▌   | 13/20 [01:04<00:33,  4.72s/it]
Task 2, Epoch 14/20 => Loss 0.071, Train_accy 75.37:  65%|██████▌   | 13/20 [01:08<00:33,  4.72s/it]
Task 2, Epoch 14/20 => Loss 0.071, Train_accy 75.37:  70%|███████   | 14/20 [01:08<00:26,  4.48s/it]
Task 2, Epoch 15/20 => Loss 0.083, Train_accy 74.95:  70%|███████   | 14/20 [01:12<00:26,  4.48s/it]
Task 2, Epoch 15/20 => Loss 0.083, Train_accy 74.95:  75%|███████▌  | 15/20 [01:12<00:21,  4.31s/it]
Task 2, Epoch 16/20 => Loss 0.059, Train_accy 76.01, Test_accy 73.09:  75%|███████▌  | 15/20 [01:20<00:21,  4.31s/it]
Task 2, Epoch 16/20 => Loss 0.059, Train_accy 76.01, Test_accy 73.09:  80%|████████  | 16/20 [01:20<00:22,  5.55s/it]
Task 2, Epoch 17/20 => Loss 0.113, Train_accy 73.25:  80%|████████  | 16/20 [01:24<00:22,  5.55s/it]                 
Task 2, Epoch 17/20 => Loss 0.113, Train_accy 73.25:  85%|████████▌ | 17/20 [01:24<00:15,  5.07s/it]
Task 2, Epoch 18/20 => Loss 0.058, Train_accy 70.06:  85%|████████▌ | 17/20 [01:28<00:15,  5.07s/it]
Task 2, Epoch 18/20 => Loss 0.058, Train_accy 70.06:  90%|█████████ | 18/20 [01:28<00:09,  4.71s/it]
Task 2, Epoch 19/20 => Loss 0.044, Train_accy 75.16:  90%|█████████ | 18/20 [01:32<00:09,  4.71s/it]
Task 2, Epoch 19/20 => Loss 0.044, Train_accy 75.16:  95%|█████████▌| 19/20 [01:32<00:04,  4.50s/it]
Task 2, Epoch 20/20 => Loss 0.093, Train_accy 78.34:  95%|█████████▌| 19/20 [01:36<00:04,  4.50s/it]
Task 2, Epoch 20/20 => Loss 0.093, Train_accy 78.34: 100%|██████████| 20/20 [01:36<00:00,  4.33s/it]
Task 2, Epoch 20/20 => Loss 0.093, Train_accy 78.34: 100%|██████████| 20/20 [01:36<00:00,  4.82s/it]
2024-09-04 18:37:15,457 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.093, Train_accy 78.34
2024-09-04 18:37:20,041 [trainer.py] => No NME accuracy.
2024-09-04 18:37:20,042 [trainer.py] => CNN: {'total': 72.1, '00-99': 69.28, '100-109': 94.78, '110-119': 78.76, 'old': 71.53, 'new': 78.76}
2024-09-04 18:37:20,042 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1]
2024-09-04 18:37:20,042 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69]

Average Accuracy (CNN): 80.79
2024-09-04 18:37:20,042 [trainer.py] => Average Accuracy (CNN): 80.79 

2024-09-04 18:37:20,044 [trainer.py] => All params: 85890936
2024-09-04 18:37:20,045 [trainer.py] => Trainable params: 85890936
2024-09-04 18:37:20,048 [finetune.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.269, Train_accy 1.66, Test_accy 66.38:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.269, Train_accy 1.66, Test_accy 66.38:   5%|▌         | 1/20 [00:08<02:48,  8.84s/it]
Task 3, Epoch 2/20 => Loss 0.294, Train_accy 36.10:   5%|▌         | 1/20 [00:12<02:48,  8.84s/it]                
Task 3, Epoch 2/20 => Loss 0.294, Train_accy 36.10:  10%|█         | 2/20 [00:12<01:48,  6.01s/it]
Task 3, Epoch 3/20 => Loss 0.232, Train_accy 69.29:  10%|█         | 2/20 [00:16<01:48,  6.01s/it]
Task 3, Epoch 3/20 => Loss 0.232, Train_accy 69.29:  15%|█▌        | 3/20 [00:16<01:26,  5.08s/it]
Task 3, Epoch 4/20 => Loss 0.202, Train_accy 78.42:  15%|█▌        | 3/20 [00:20<01:26,  5.08s/it]
Task 3, Epoch 4/20 => Loss 0.202, Train_accy 78.42:  20%|██        | 4/20 [00:20<01:14,  4.66s/it]
Task 3, Epoch 5/20 => Loss 0.237, Train_accy 79.88:  20%|██        | 4/20 [00:24<01:14,  4.66s/it]
Task 3, Epoch 5/20 => Loss 0.237, Train_accy 79.88:  25%|██▌       | 5/20 [00:24<01:06,  4.42s/it]
Task 3, Epoch 6/20 => Loss 0.192, Train_accy 81.54, Test_accy 70.85:  25%|██▌       | 5/20 [00:33<01:06,  4.42s/it]
Task 3, Epoch 6/20 => Loss 0.192, Train_accy 81.54, Test_accy 70.85:  30%|███       | 6/20 [00:33<01:22,  5.89s/it]
Task 3, Epoch 7/20 => Loss 0.153, Train_accy 82.99:  30%|███       | 6/20 [00:37<01:22,  5.89s/it]                 
Task 3, Epoch 7/20 => Loss 0.153, Train_accy 82.99:  35%|███▌      | 7/20 [00:37<01:08,  5.30s/it]
Task 3, Epoch 8/20 => Loss 0.139, Train_accy 85.27:  35%|███▌      | 7/20 [00:41<01:08,  5.30s/it]
Task 3, Epoch 8/20 => Loss 0.139, Train_accy 85.27:  40%|████      | 8/20 [00:41<00:58,  4.88s/it]
Task 3, Epoch 9/20 => Loss 0.127, Train_accy 86.51:  40%|████      | 8/20 [00:45<00:58,  4.88s/it]
Task 3, Epoch 9/20 => Loss 0.127, Train_accy 86.51:  45%|████▌     | 9/20 [00:45<00:50,  4.61s/it]
Task 3, Epoch 10/20 => Loss 0.088, Train_accy 88.17:  45%|████▌     | 9/20 [00:49<00:50,  4.61s/it]
Task 3, Epoch 10/20 => Loss 0.088, Train_accy 88.17:  50%|█████     | 10/20 [00:49<00:44,  4.43s/it]
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 86.31, Test_accy 70.19:  50%|█████     | 10/20 [00:58<00:44,  4.43s/it]
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 86.31, Test_accy 70.19:  55%|█████▌    | 11/20 [00:58<00:52,  5.79s/it]
Task 3, Epoch 12/20 => Loss 0.111, Train_accy 88.59:  55%|█████▌    | 11/20 [01:02<00:52,  5.79s/it]                 
Task 3, Epoch 12/20 => Loss 0.111, Train_accy 88.59:  60%|██████    | 12/20 [01:02<00:41,  5.25s/it]
Task 3, Epoch 13/20 => Loss 0.260, Train_accy 87.97:  60%|██████    | 12/20 [01:06<00:41,  5.25s/it]
Task 3, Epoch 13/20 => Loss 0.260, Train_accy 87.97:  65%|██████▌   | 13/20 [01:06<00:34,  4.88s/it]
Task 3, Epoch 14/20 => Loss 0.217, Train_accy 86.10:  65%|██████▌   | 13/20 [01:10<00:34,  4.88s/it]
Task 3, Epoch 14/20 => Loss 0.217, Train_accy 86.10:  70%|███████   | 14/20 [01:10<00:27,  4.62s/it]
Task 3, Epoch 15/20 => Loss 0.140, Train_accy 89.21:  70%|███████   | 14/20 [01:14<00:27,  4.62s/it]
Task 3, Epoch 15/20 => Loss 0.140, Train_accy 89.21:  75%|███████▌  | 15/20 [01:14<00:22,  4.45s/it]
Task 3, Epoch 16/20 => Loss 0.162, Train_accy 86.93, Test_accy 71.44:  75%|███████▌  | 15/20 [01:23<00:22,  4.45s/it]
Task 3, Epoch 16/20 => Loss 0.162, Train_accy 86.93, Test_accy 71.44:  80%|████████  | 16/20 [01:23<00:23,  5.81s/it]
Task 3, Epoch 17/20 => Loss 0.105, Train_accy 89.00:  80%|████████  | 16/20 [01:27<00:23,  5.81s/it]                 
Task 3, Epoch 17/20 => Loss 0.105, Train_accy 89.00:  85%|████████▌ | 17/20 [01:27<00:15,  5.26s/it]
Task 3, Epoch 18/20 => Loss 0.142, Train_accy 86.72:  85%|████████▌ | 17/20 [01:31<00:15,  5.26s/it]
Task 3, Epoch 18/20 => Loss 0.142, Train_accy 86.72:  90%|█████████ | 18/20 [01:31<00:09,  4.88s/it]
Task 3, Epoch 19/20 => Loss 0.118, Train_accy 87.14:  90%|█████████ | 18/20 [01:35<00:09,  4.88s/it]
Task 3, Epoch 19/20 => Loss 0.118, Train_accy 87.14:  95%|█████████▌| 19/20 [01:35<00:04,  4.61s/it]
Task 3, Epoch 20/20 => Loss 0.137, Train_accy 87.97:  95%|█████████▌| 19/20 [01:39<00:04,  4.61s/it]
Task 3, Epoch 20/20 => Loss 0.137, Train_accy 87.97: 100%|██████████| 20/20 [01:39<00:00,  4.44s/it]
Task 3, Epoch 20/20 => Loss 0.137, Train_accy 87.97: 100%|██████████| 20/20 [01:39<00:00,  4.98s/it]
2024-09-04 18:38:59,727 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.137, Train_accy 87.97
2024-09-04 18:39:04,528 [trainer.py] => No NME accuracy.
2024-09-04 18:39:04,528 [trainer.py] => CNN: {'total': 71.77, '00-99': 67.26, '100-109': 93.91, '110-119': 80.53, '120-129': 88.79, 'old': 70.48, 'new': 88.79}
2024-09-04 18:39:04,529 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77]
2024-09-04 18:39:04,529 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8]

Average Accuracy (CNN): 78.54
2024-09-04 18:39:04,529 [trainer.py] => Average Accuracy (CNN): 78.54 

2024-09-04 18:39:04,530 [trainer.py] => All params: 85898626
2024-09-04 18:39:04,532 [trainer.py] => Trainable params: 85898626
2024-09-04 18:39:04,535 [finetune.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.626, Train_accy 0.42, Test_accy 64.66:   0%|          | 0/20 [00:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.626, Train_accy 0.42, Test_accy 64.66:   5%|▌         | 1/20 [00:09<02:52,  9.06s/it]
Task 4, Epoch 2/20 => Loss 0.321, Train_accy 31.78:   5%|▌         | 1/20 [00:13<02:52,  9.06s/it]                
Task 4, Epoch 2/20 => Loss 0.321, Train_accy 31.78:  10%|█         | 2/20 [00:13<01:49,  6.07s/it]
Task 4, Epoch 3/20 => Loss 0.250, Train_accy 60.59:  10%|█         | 2/20 [00:17<01:49,  6.07s/it]
Task 4, Epoch 3/20 => Loss 0.250, Train_accy 60.59:  15%|█▌        | 3/20 [00:17<01:27,  5.12s/it]
Task 4, Epoch 4/20 => Loss 0.228, Train_accy 72.88:  15%|█▌        | 3/20 [00:20<01:27,  5.12s/it]
Task 4, Epoch 4/20 => Loss 0.228, Train_accy 72.88:  20%|██        | 4/20 [00:20<01:14,  4.65s/it]
Task 4, Epoch 5/20 => Loss 0.139, Train_accy 80.93:  20%|██        | 4/20 [00:24<01:14,  4.65s/it]
Task 4, Epoch 5/20 => Loss 0.139, Train_accy 80.93:  25%|██▌       | 5/20 [00:24<01:05,  4.40s/it]
Task 4, Epoch 6/20 => Loss 0.178, Train_accy 82.63, Test_accy 65.57:  25%|██▌       | 5/20 [00:33<01:05,  4.40s/it]
Task 4, Epoch 6/20 => Loss 0.178, Train_accy 82.63, Test_accy 65.57:  30%|███       | 6/20 [00:33<01:23,  5.97s/it]
Task 4, Epoch 7/20 => Loss 0.140, Train_accy 84.53:  30%|███       | 6/20 [00:37<01:23,  5.97s/it]                 
Task 4, Epoch 7/20 => Loss 0.140, Train_accy 84.53:  35%|███▌      | 7/20 [00:37<01:08,  5.31s/it]
Task 4, Epoch 8/20 => Loss 0.133, Train_accy 87.71:  35%|███▌      | 7/20 [00:41<01:08,  5.31s/it]
Task 4, Epoch 8/20 => Loss 0.133, Train_accy 87.71:  40%|████      | 8/20 [00:41<00:58,  4.91s/it]
Task 4, Epoch 9/20 => Loss 0.153, Train_accy 84.75:  40%|████      | 8/20 [00:45<00:58,  4.91s/it]
Task 4, Epoch 9/20 => Loss 0.153, Train_accy 84.75:  45%|████▌     | 9/20 [00:45<00:50,  4.60s/it]
Task 4, Epoch 10/20 => Loss 0.130, Train_accy 85.81:  45%|████▌     | 9/20 [00:49<00:50,  4.60s/it]
Task 4, Epoch 10/20 => Loss 0.130, Train_accy 85.81:  50%|█████     | 10/20 [00:49<00:44,  4.42s/it]
Task 4, Epoch 11/20 => Loss 0.129, Train_accy 86.86, Test_accy 65.94:  50%|█████     | 10/20 [00:58<00:44,  4.42s/it]
Task 4, Epoch 11/20 => Loss 0.129, Train_accy 86.86, Test_accy 65.94:  55%|█████▌    | 11/20 [00:58<00:52,  5.82s/it]
Task 4, Epoch 12/20 => Loss 0.127, Train_accy 85.59:  55%|█████▌    | 11/20 [01:02<00:52,  5.82s/it]                 
Task 4, Epoch 12/20 => Loss 0.127, Train_accy 85.59:  60%|██████    | 12/20 [01:02<00:42,  5.26s/it]
Task 4, Epoch 13/20 => Loss 0.146, Train_accy 86.23:  60%|██████    | 12/20 [01:06<00:42,  5.26s/it]
Task 4, Epoch 13/20 => Loss 0.146, Train_accy 86.23:  65%|██████▌   | 13/20 [01:06<00:34,  4.86s/it]
Task 4, Epoch 14/20 => Loss 0.175, Train_accy 87.50:  65%|██████▌   | 13/20 [01:10<00:34,  4.86s/it]
Task 4, Epoch 14/20 => Loss 0.175, Train_accy 87.50:  70%|███████   | 14/20 [01:10<00:27,  4.61s/it]
Task 4, Epoch 15/20 => Loss 0.089, Train_accy 90.25:  70%|███████   | 14/20 [01:14<00:27,  4.61s/it]
Task 4, Epoch 15/20 => Loss 0.089, Train_accy 90.25:  75%|███████▌  | 15/20 [01:14<00:22,  4.43s/it]
Task 4, Epoch 16/20 => Loss 0.122, Train_accy 88.35, Test_accy 66.36:  75%|███████▌  | 15/20 [01:23<00:22,  4.43s/it]
Task 4, Epoch 16/20 => Loss 0.122, Train_accy 88.35, Test_accy 66.36:  80%|████████  | 16/20 [01:23<00:23,  5.83s/it]
Task 4, Epoch 17/20 => Loss 0.132, Train_accy 86.02:  80%|████████  | 16/20 [01:27<00:23,  5.83s/it]                 
Task 4, Epoch 17/20 => Loss 0.132, Train_accy 86.02:  85%|████████▌ | 17/20 [01:27<00:15,  5.27s/it]
Task 4, Epoch 18/20 => Loss 0.103, Train_accy 90.89:  85%|████████▌ | 17/20 [01:31<00:15,  5.27s/it]
Task 4, Epoch 18/20 => Loss 0.103, Train_accy 90.89:  90%|█████████ | 18/20 [01:31<00:09,  4.85s/it]
Task 4, Epoch 19/20 => Loss 0.108, Train_accy 90.04:  90%|█████████ | 18/20 [01:35<00:09,  4.85s/it]
Task 4, Epoch 19/20 => Loss 0.108, Train_accy 90.04:  95%|█████████▌| 19/20 [01:35<00:04,  4.57s/it]
Task 4, Epoch 20/20 => Loss 0.105, Train_accy 87.92:  95%|█████████▌| 19/20 [01:39<00:04,  4.57s/it]
Task 4, Epoch 20/20 => Loss 0.105, Train_accy 87.92: 100%|██████████| 20/20 [01:39<00:00,  4.38s/it]
Task 4, Epoch 20/20 => Loss 0.105, Train_accy 87.92: 100%|██████████| 20/20 [01:39<00:00,  4.98s/it]
2024-09-04 18:40:44,138 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.105, Train_accy 87.92
2024-09-04 18:40:49,218 [trainer.py] => No NME accuracy.
2024-09-04 18:40:49,218 [trainer.py] => CNN: {'total': 65.51, '00-99': 59.51, '100-109': 90.43, '110-119': 74.34, '120-129': 72.9, '130-139': 86.44, 'old': 63.89, 'new': 86.44}
2024-09-04 18:40:49,218 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77, 65.51]
2024-09-04 18:40:49,218 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8, 94.7]

Average Accuracy (CNN): 75.93
2024-09-04 18:40:49,219 [trainer.py] => Average Accuracy (CNN): 75.93 

2024-09-04 18:40:49,219 [trainer.py] => All params: 85906316
2024-09-04 18:40:49,220 [trainer.py] => Trainable params: 85906316
2024-09-04 18:40:49,222 [finetune.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.335, Train_accy 1.77, Test_accy 61.29:   0%|          | 0/20 [00:09<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.335, Train_accy 1.77, Test_accy 61.29:   5%|▌         | 1/20 [00:09<02:57,  9.36s/it]
Task 5, Epoch 2/20 => Loss 0.306, Train_accy 38.05:   5%|▌         | 1/20 [00:13<02:57,  9.36s/it]                
Task 5, Epoch 2/20 => Loss 0.306, Train_accy 38.05:  10%|█         | 2/20 [00:13<01:49,  6.09s/it]
Task 5, Epoch 3/20 => Loss 0.169, Train_accy 63.50:  10%|█         | 2/20 [00:16<01:49,  6.09s/it]
Task 5, Epoch 3/20 => Loss 0.169, Train_accy 63.50:  15%|█▌        | 3/20 [00:16<01:25,  5.06s/it]
Task 5, Epoch 4/20 => Loss 0.206, Train_accy 72.35:  15%|█▌        | 3/20 [00:20<01:25,  5.06s/it]
Task 5, Epoch 4/20 => Loss 0.206, Train_accy 72.35:  20%|██        | 4/20 [00:20<01:13,  4.58s/it]
Task 5, Epoch 5/20 => Loss 0.184, Train_accy 80.31:  20%|██        | 4/20 [00:24<01:13,  4.58s/it]
Task 5, Epoch 5/20 => Loss 0.184, Train_accy 80.31:  25%|██▌       | 5/20 [00:24<01:04,  4.30s/it]
Task 5, Epoch 6/20 => Loss 0.161, Train_accy 76.55, Test_accy 64.91:  25%|██▌       | 5/20 [00:34<01:04,  4.30s/it]
Task 5, Epoch 6/20 => Loss 0.161, Train_accy 76.55, Test_accy 64.91:  30%|███       | 6/20 [00:34<01:24,  6.03s/it]
Task 5, Epoch 7/20 => Loss 0.165, Train_accy 75.44:  30%|███       | 6/20 [00:37<01:24,  6.03s/it]                 
Task 5, Epoch 7/20 => Loss 0.165, Train_accy 75.44:  35%|███▌      | 7/20 [00:37<01:09,  5.34s/it]
Task 5, Epoch 8/20 => Loss 0.168, Train_accy 78.10:  35%|███▌      | 7/20 [00:41<01:09,  5.34s/it]
Task 5, Epoch 8/20 => Loss 0.168, Train_accy 78.10:  40%|████      | 8/20 [00:41<00:58,  4.88s/it]
Task 5, Epoch 9/20 => Loss 0.135, Train_accy 79.65:  40%|████      | 8/20 [00:45<00:58,  4.88s/it]
Task 5, Epoch 9/20 => Loss 0.135, Train_accy 79.65:  45%|████▌     | 9/20 [00:45<00:50,  4.57s/it]
Task 5, Epoch 10/20 => Loss 0.166, Train_accy 76.99:  45%|████▌     | 9/20 [00:49<00:50,  4.57s/it]
Task 5, Epoch 10/20 => Loss 0.166, Train_accy 76.99:  50%|█████     | 10/20 [00:49<00:43,  4.33s/it]
Task 5, Epoch 11/20 => Loss 0.138, Train_accy 81.42, Test_accy 65.82:  50%|█████     | 10/20 [00:58<00:43,  4.33s/it]
Task 5, Epoch 11/20 => Loss 0.138, Train_accy 81.42, Test_accy 65.82:  55%|█████▌    | 11/20 [00:58<00:52,  5.85s/it]
Task 5, Epoch 12/20 => Loss 0.146, Train_accy 81.64:  55%|█████▌    | 11/20 [01:02<00:52,  5.85s/it]                 
Task 5, Epoch 12/20 => Loss 0.146, Train_accy 81.64:  60%|██████    | 12/20 [01:02<00:41,  5.23s/it]
Task 5, Epoch 13/20 => Loss 0.090, Train_accy 83.41:  60%|██████    | 12/20 [01:06<00:41,  5.23s/it]
Task 5, Epoch 13/20 => Loss 0.090, Train_accy 83.41:  65%|██████▌   | 13/20 [01:06<00:33,  4.80s/it]
Task 5, Epoch 14/20 => Loss 0.130, Train_accy 83.19:  65%|██████▌   | 13/20 [01:10<00:33,  4.80s/it]
Task 5, Epoch 14/20 => Loss 0.130, Train_accy 83.19:  70%|███████   | 14/20 [01:10<00:26,  4.49s/it]
Task 5, Epoch 15/20 => Loss 0.133, Train_accy 80.09:  70%|███████   | 14/20 [01:14<00:26,  4.49s/it]
Task 5, Epoch 15/20 => Loss 0.133, Train_accy 80.09:  75%|███████▌  | 15/20 [01:14<00:21,  4.28s/it]
Task 5, Epoch 16/20 => Loss 0.104, Train_accy 84.29, Test_accy 65.42:  75%|███████▌  | 15/20 [01:23<00:21,  4.28s/it]
Task 5, Epoch 16/20 => Loss 0.104, Train_accy 84.29, Test_accy 65.42:  80%|████████  | 16/20 [01:23<00:23,  5.80s/it]
Task 5, Epoch 17/20 => Loss 0.166, Train_accy 81.42:  80%|████████  | 16/20 [01:27<00:23,  5.80s/it]                 
Task 5, Epoch 17/20 => Loss 0.166, Train_accy 81.42:  85%|████████▌ | 17/20 [01:27<00:15,  5.21s/it]
Task 5, Epoch 18/20 => Loss 0.125, Train_accy 81.86:  85%|████████▌ | 17/20 [01:30<00:15,  5.21s/it]
Task 5, Epoch 18/20 => Loss 0.125, Train_accy 81.86:  90%|█████████ | 18/20 [01:30<00:09,  4.79s/it]
Task 5, Epoch 19/20 => Loss 0.088, Train_accy 84.51:  90%|█████████ | 18/20 [01:34<00:09,  4.79s/it]
Task 5, Epoch 19/20 => Loss 0.088, Train_accy 84.51:  95%|█████████▌| 19/20 [01:34<00:04,  4.50s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 83.85:  95%|█████████▌| 19/20 [01:38<00:04,  4.50s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 83.85: 100%|██████████| 20/20 [01:38<00:00,  4.29s/it]
Task 5, Epoch 20/20 => Loss 0.092, Train_accy 83.85: 100%|██████████| 20/20 [01:38<00:00,  4.93s/it]
2024-09-04 18:42:27,864 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.092, Train_accy 83.85
2024-09-04 18:42:33,489 [trainer.py] => No NME accuracy.
2024-09-04 18:42:33,489 [trainer.py] => CNN: {'total': 65.03, '00-99': 58.25, '100-109': 80.87, '110-119': 73.45, '120-129': 66.36, '130-139': 89.83, '140-149': 82.54, 'old': 63.68, 'new': 82.54}
2024-09-04 18:42:33,489 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77, 65.51, 65.03]
2024-09-04 18:42:33,489 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8, 94.7, 94.96]

Average Accuracy (CNN): 74.11
2024-09-04 18:42:33,489 [trainer.py] => Average Accuracy (CNN): 74.11 

2024-09-04 18:42:33,490 [trainer.py] => All params: 85914006
2024-09-04 18:42:33,490 [trainer.py] => Trainable params: 85914006
2024-09-04 18:42:33,493 [finetune.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.713, Train_accy 4.27, Test_accy 59.07:   0%|          | 0/20 [00:09<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.713, Train_accy 4.27, Test_accy 59.07:   5%|▌         | 1/20 [00:09<03:06,  9.80s/it]
Task 6, Epoch 2/20 => Loss 0.361, Train_accy 53.85:   5%|▌         | 1/20 [00:13<03:06,  9.80s/it]                
Task 6, Epoch 2/20 => Loss 0.361, Train_accy 53.85:  10%|█         | 2/20 [00:13<01:54,  6.35s/it]
Task 6, Epoch 3/20 => Loss 0.250, Train_accy 81.62:  10%|█         | 2/20 [00:17<01:54,  6.35s/it]
Task 6, Epoch 3/20 => Loss 0.250, Train_accy 81.62:  15%|█▌        | 3/20 [00:17<01:29,  5.24s/it]
Task 6, Epoch 4/20 => Loss 0.208, Train_accy 86.11:  15%|█▌        | 3/20 [00:21<01:29,  5.24s/it]
Task 6, Epoch 4/20 => Loss 0.208, Train_accy 86.11:  20%|██        | 4/20 [00:21<01:15,  4.71s/it]
Task 6, Epoch 5/20 => Loss 0.158, Train_accy 88.68:  20%|██        | 4/20 [00:25<01:15,  4.71s/it]
Task 6, Epoch 5/20 => Loss 0.158, Train_accy 88.68:  25%|██▌       | 5/20 [00:25<01:06,  4.43s/it]
Task 6, Epoch 6/20 => Loss 0.141, Train_accy 88.89, Test_accy 56.95:  25%|██▌       | 5/20 [00:35<01:06,  4.43s/it]
Task 6, Epoch 6/20 => Loss 0.141, Train_accy 88.89, Test_accy 56.95:  30%|███       | 6/20 [00:35<01:27,  6.22s/it]
Task 6, Epoch 7/20 => Loss 0.139, Train_accy 89.74:  30%|███       | 6/20 [00:39<01:27,  6.22s/it]                 
Task 6, Epoch 7/20 => Loss 0.139, Train_accy 89.74:  35%|███▌      | 7/20 [00:39<01:11,  5.48s/it]
Task 6, Epoch 8/20 => Loss 0.126, Train_accy 90.38:  35%|███▌      | 7/20 [00:43<01:11,  5.48s/it]
Task 6, Epoch 8/20 => Loss 0.126, Train_accy 90.38:  40%|████      | 8/20 [00:43<01:00,  5.01s/it]
Task 6, Epoch 9/20 => Loss 0.173, Train_accy 88.46:  40%|████      | 8/20 [00:47<01:00,  5.01s/it]
Task 6, Epoch 9/20 => Loss 0.173, Train_accy 88.46:  45%|████▌     | 9/20 [00:47<00:51,  4.67s/it]
Task 6, Epoch 10/20 => Loss 0.128, Train_accy 89.53:  45%|████▌     | 9/20 [00:50<00:51,  4.67s/it]
Task 6, Epoch 10/20 => Loss 0.128, Train_accy 89.53:  50%|█████     | 10/20 [00:50<00:44,  4.43s/it]
Task 6, Epoch 11/20 => Loss 0.124, Train_accy 90.38, Test_accy 58.54:  50%|█████     | 10/20 [01:00<00:44,  4.43s/it]
Task 6, Epoch 11/20 => Loss 0.124, Train_accy 90.38, Test_accy 58.54:  55%|█████▌    | 11/20 [01:00<00:55,  6.12s/it]
Task 6, Epoch 12/20 => Loss 0.157, Train_accy 91.03:  55%|█████▌    | 11/20 [01:04<00:55,  6.12s/it]                 
Task 6, Epoch 12/20 => Loss 0.157, Train_accy 91.03:  60%|██████    | 12/20 [01:04<00:43,  5.46s/it]
Task 6, Epoch 13/20 => Loss 0.125, Train_accy 88.89:  60%|██████    | 12/20 [01:08<00:43,  5.46s/it]
Task 6, Epoch 13/20 => Loss 0.125, Train_accy 88.89:  65%|██████▌   | 13/20 [01:08<00:35,  5.00s/it]
Task 6, Epoch 14/20 => Loss 0.142, Train_accy 92.52:  65%|██████▌   | 13/20 [01:12<00:35,  5.00s/it]
Task 6, Epoch 14/20 => Loss 0.142, Train_accy 92.52:  70%|███████   | 14/20 [01:12<00:27,  4.66s/it]
Task 6, Epoch 15/20 => Loss 0.099, Train_accy 91.67:  70%|███████   | 14/20 [01:16<00:27,  4.66s/it]
Task 6, Epoch 15/20 => Loss 0.099, Train_accy 91.67:  75%|███████▌  | 15/20 [01:16<00:22,  4.47s/it]
Task 6, Epoch 16/20 => Loss 0.087, Train_accy 93.38, Test_accy 57.69:  75%|███████▌  | 15/20 [01:26<00:22,  4.47s/it]
Task 6, Epoch 16/20 => Loss 0.087, Train_accy 93.38, Test_accy 57.69:  80%|████████  | 16/20 [01:26<00:24,  6.02s/it]
Task 6, Epoch 17/20 => Loss 0.080, Train_accy 93.80:  80%|████████  | 16/20 [01:30<00:24,  6.02s/it]                 
Task 6, Epoch 17/20 => Loss 0.080, Train_accy 93.80:  85%|████████▌ | 17/20 [01:30<00:16,  5.39s/it]
Task 6, Epoch 18/20 => Loss 0.101, Train_accy 92.52:  85%|████████▌ | 17/20 [01:34<00:16,  5.39s/it]
Task 6, Epoch 18/20 => Loss 0.101, Train_accy 92.52:  90%|█████████ | 18/20 [01:34<00:09,  4.96s/it]
Task 6, Epoch 19/20 => Loss 0.139, Train_accy 92.95:  90%|█████████ | 18/20 [01:38<00:09,  4.96s/it]
Task 6, Epoch 19/20 => Loss 0.139, Train_accy 92.95:  95%|█████████▌| 19/20 [01:38<00:04,  4.65s/it]
Task 6, Epoch 20/20 => Loss 0.097, Train_accy 91.88:  95%|█████████▌| 19/20 [01:42<00:04,  4.65s/it]
Task 6, Epoch 20/20 => Loss 0.097, Train_accy 91.88: 100%|██████████| 20/20 [01:42<00:00,  4.44s/it]
Task 6, Epoch 20/20 => Loss 0.097, Train_accy 91.88: 100%|██████████| 20/20 [01:42<00:00,  5.10s/it]
2024-09-04 18:44:15,601 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.097, Train_accy 91.88
2024-09-04 18:44:21,504 [trainer.py] => No NME accuracy.
2024-09-04 18:44:21,505 [trainer.py] => CNN: {'total': 57.43, '00-99': 50.34, '100-109': 59.13, '110-119': 59.29, '120-129': 61.68, '130-139': 69.49, '140-149': 65.08, '150-159': 99.19, 'old': 54.5, 'new': 99.19}
2024-09-04 18:44:21,505 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77, 65.51, 65.03, 57.43]
2024-09-04 18:44:21,505 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8, 94.7, 94.96, 93.23]

Average Accuracy (CNN): 71.73
2024-09-04 18:44:21,505 [trainer.py] => Average Accuracy (CNN): 71.73 

2024-09-04 18:44:21,506 [trainer.py] => All params: 85921696
2024-09-04 18:44:21,507 [trainer.py] => Trainable params: 85921696
2024-09-04 18:44:21,509 [finetune.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.667, Train_accy 2.16, Test_accy 52.54:   0%|          | 0/20 [00:10<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.667, Train_accy 2.16, Test_accy 52.54:   5%|▌         | 1/20 [00:10<03:13, 10.17s/it]
Task 7, Epoch 2/20 => Loss 0.262, Train_accy 53.02:   5%|▌         | 1/20 [00:14<03:13, 10.17s/it]                
Task 7, Epoch 2/20 => Loss 0.262, Train_accy 53.02:  10%|█         | 2/20 [00:14<01:56,  6.48s/it]
Task 7, Epoch 3/20 => Loss 0.169, Train_accy 85.34:  10%|█         | 2/20 [00:18<01:56,  6.48s/it]
Task 7, Epoch 3/20 => Loss 0.169, Train_accy 85.34:  15%|█▌        | 3/20 [00:18<01:30,  5.32s/it]
Task 7, Epoch 4/20 => Loss 0.153, Train_accy 87.93:  15%|█▌        | 3/20 [00:21<01:30,  5.32s/it]
Task 7, Epoch 4/20 => Loss 0.153, Train_accy 87.93:  20%|██        | 4/20 [00:21<01:16,  4.77s/it]
Task 7, Epoch 5/20 => Loss 0.134, Train_accy 89.01:  20%|██        | 4/20 [00:25<01:16,  4.77s/it]
Task 7, Epoch 5/20 => Loss 0.134, Train_accy 89.01:  25%|██▌       | 5/20 [00:25<01:06,  4.45s/it]
Task 7, Epoch 6/20 => Loss 0.139, Train_accy 89.01, Test_accy 48.40:  25%|██▌       | 5/20 [00:35<01:06,  4.45s/it]
Task 7, Epoch 6/20 => Loss 0.139, Train_accy 89.01, Test_accy 48.40:  30%|███       | 6/20 [00:35<01:29,  6.38s/it]
Task 7, Epoch 7/20 => Loss 0.105, Train_accy 90.95:  30%|███       | 6/20 [00:39<01:29,  6.38s/it]                 
Task 7, Epoch 7/20 => Loss 0.105, Train_accy 90.95:  35%|███▌      | 7/20 [00:39<01:12,  5.57s/it]
Task 7, Epoch 8/20 => Loss 0.097, Train_accy 92.03:  35%|███▌      | 7/20 [00:43<01:12,  5.57s/it]
Task 7, Epoch 8/20 => Loss 0.097, Train_accy 92.03:  40%|████      | 8/20 [00:43<01:01,  5.10s/it]
Task 7, Epoch 9/20 => Loss 0.107, Train_accy 89.22:  40%|████      | 8/20 [00:47<01:01,  5.10s/it]
Task 7, Epoch 9/20 => Loss 0.107, Train_accy 89.22:  45%|████▌     | 9/20 [00:47<00:52,  4.75s/it]
Task 7, Epoch 10/20 => Loss 0.104, Train_accy 90.52:  45%|████▌     | 9/20 [00:51<00:52,  4.75s/it]
Task 7, Epoch 10/20 => Loss 0.104, Train_accy 90.52:  50%|█████     | 10/20 [00:51<00:44,  4.49s/it]
Task 7, Epoch 11/20 => Loss 0.105, Train_accy 91.81, Test_accy 48.05:  50%|█████     | 10/20 [01:01<00:44,  4.49s/it]
Task 7, Epoch 11/20 => Loss 0.105, Train_accy 91.81, Test_accy 48.05:  55%|█████▌    | 11/20 [01:01<00:55,  6.21s/it]
Task 7, Epoch 12/20 => Loss 0.075, Train_accy 92.89:  55%|█████▌    | 11/20 [01:05<00:55,  6.21s/it]                 
Task 7, Epoch 12/20 => Loss 0.075, Train_accy 92.89:  60%|██████    | 12/20 [01:05<00:44,  5.53s/it]
Task 7, Epoch 13/20 => Loss 0.138, Train_accy 89.87:  60%|██████    | 12/20 [01:09<00:44,  5.53s/it]
Task 7, Epoch 13/20 => Loss 0.138, Train_accy 89.87:  65%|██████▌   | 13/20 [01:09<00:35,  5.03s/it]
Task 7, Epoch 14/20 => Loss 0.122, Train_accy 91.16:  65%|██████▌   | 13/20 [01:13<00:35,  5.03s/it]
Task 7, Epoch 14/20 => Loss 0.122, Train_accy 91.16:  70%|███████   | 14/20 [01:13<00:28,  4.69s/it]
Task 7, Epoch 15/20 => Loss 0.123, Train_accy 93.32:  70%|███████   | 14/20 [01:17<00:28,  4.69s/it]
Task 7, Epoch 15/20 => Loss 0.123, Train_accy 93.32:  75%|███████▌  | 15/20 [01:17<00:22,  4.46s/it]
Task 7, Epoch 16/20 => Loss 0.072, Train_accy 92.89, Test_accy 50.17:  75%|███████▌  | 15/20 [01:27<00:22,  4.46s/it]
Task 7, Epoch 16/20 => Loss 0.072, Train_accy 92.89, Test_accy 50.17:  80%|████████  | 16/20 [01:27<00:24,  6.20s/it]
Task 7, Epoch 17/20 => Loss 0.130, Train_accy 90.73:  80%|████████  | 16/20 [01:31<00:24,  6.20s/it]                 
Task 7, Epoch 17/20 => Loss 0.130, Train_accy 90.73:  85%|████████▌ | 17/20 [01:31<00:16,  5.51s/it]
Task 7, Epoch 18/20 => Loss 0.065, Train_accy 92.46:  85%|████████▌ | 17/20 [01:35<00:16,  5.51s/it]
Task 7, Epoch 18/20 => Loss 0.065, Train_accy 92.46:  90%|█████████ | 18/20 [01:35<00:10,  5.02s/it]
Task 7, Epoch 19/20 => Loss 0.101, Train_accy 91.81:  90%|█████████ | 18/20 [01:39<00:10,  5.02s/it]
Task 7, Epoch 19/20 => Loss 0.101, Train_accy 91.81:  95%|█████████▌| 19/20 [01:39<00:04,  4.67s/it]
Task 7, Epoch 20/20 => Loss 0.089, Train_accy 92.03:  95%|█████████▌| 19/20 [01:43<00:04,  4.67s/it]
Task 7, Epoch 20/20 => Loss 0.089, Train_accy 92.03: 100%|██████████| 20/20 [01:43<00:00,  4.44s/it]
Task 7, Epoch 20/20 => Loss 0.089, Train_accy 92.03: 100%|██████████| 20/20 [01:43<00:00,  5.17s/it]
2024-09-04 18:46:04,930 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.089, Train_accy 92.03
2024-09-04 18:46:11,254 [trainer.py] => No NME accuracy.
2024-09-04 18:46:11,254 [trainer.py] => CNN: {'total': 50.47, '00-99': 41.5, '100-109': 54.78, '110-119': 44.25, '120-129': 56.07, '130-139': 44.92, '140-149': 46.83, '150-159': 89.52, '160-169': 99.25, 'old': 47.01, 'new': 99.25}
2024-09-04 18:46:11,255 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77, 65.51, 65.03, 57.43, 50.47]
2024-09-04 18:46:11,255 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8, 94.7, 94.96, 93.23, 89.43]

Average Accuracy (CNN): 69.07
2024-09-04 18:46:11,255 [trainer.py] => Average Accuracy (CNN): 69.07 

2024-09-04 18:46:11,257 [trainer.py] => All params: 85929386
2024-09-04 18:46:11,258 [trainer.py] => Trainable params: 85929386
2024-09-04 18:46:11,263 [finetune.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.211, Train_accy 1.21, Test_accy 46.48:   0%|          | 0/20 [00:10<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.211, Train_accy 1.21, Test_accy 46.48:   5%|▌         | 1/20 [00:10<03:22, 10.68s/it]
Task 8, Epoch 2/20 => Loss 0.253, Train_accy 31.98:   5%|▌         | 1/20 [00:14<03:22, 10.68s/it]                
Task 8, Epoch 2/20 => Loss 0.253, Train_accy 31.98:  10%|█         | 2/20 [00:14<02:03,  6.83s/it]
Task 8, Epoch 3/20 => Loss 0.195, Train_accy 62.35:  10%|█         | 2/20 [00:18<02:03,  6.83s/it]
Task 8, Epoch 3/20 => Loss 0.195, Train_accy 62.35:  15%|█▌        | 3/20 [00:18<01:35,  5.62s/it]
Task 8, Epoch 4/20 => Loss 0.176, Train_accy 70.65:  15%|█▌        | 3/20 [00:23<01:35,  5.62s/it]
Task 8, Epoch 4/20 => Loss 0.176, Train_accy 70.65:  20%|██        | 4/20 [00:23<01:20,  5.04s/it]
Task 8, Epoch 5/20 => Loss 0.153, Train_accy 71.26:  20%|██        | 4/20 [00:27<01:20,  5.04s/it]
Task 8, Epoch 5/20 => Loss 0.153, Train_accy 71.26:  25%|██▌       | 5/20 [00:27<01:10,  4.73s/it]
Task 8, Epoch 6/20 => Loss 0.177, Train_accy 72.47, Test_accy 49.15:  25%|██▌       | 5/20 [00:38<01:10,  4.73s/it]
Task 8, Epoch 6/20 => Loss 0.177, Train_accy 72.47, Test_accy 49.15:  30%|███       | 6/20 [00:38<01:35,  6.81s/it]
Task 8, Epoch 7/20 => Loss 0.206, Train_accy 75.51:  30%|███       | 6/20 [00:42<01:35,  6.81s/it]                 
Task 8, Epoch 7/20 => Loss 0.206, Train_accy 75.51:  35%|███▌      | 7/20 [00:42<01:17,  5.94s/it]
Task 8, Epoch 8/20 => Loss 0.206, Train_accy 76.52:  35%|███▌      | 7/20 [00:46<01:17,  5.94s/it]
Task 8, Epoch 8/20 => Loss 0.206, Train_accy 76.52:  40%|████      | 8/20 [00:46<01:04,  5.35s/it]
Task 8, Epoch 9/20 => Loss 0.184, Train_accy 71.66:  40%|████      | 8/20 [00:50<01:04,  5.35s/it]
Task 8, Epoch 9/20 => Loss 0.184, Train_accy 71.66:  45%|████▌     | 9/20 [00:50<00:54,  4.95s/it]
Task 8, Epoch 10/20 => Loss 0.136, Train_accy 80.77:  45%|████▌     | 9/20 [00:54<00:54,  4.95s/it]
Task 8, Epoch 10/20 => Loss 0.136, Train_accy 80.77:  50%|█████     | 10/20 [00:54<00:46,  4.68s/it]
Task 8, Epoch 11/20 => Loss 0.149, Train_accy 75.91, Test_accy 50.56:  50%|█████     | 10/20 [01:05<00:46,  4.68s/it]
Task 8, Epoch 11/20 => Loss 0.149, Train_accy 75.91, Test_accy 50.56:  55%|█████▌    | 11/20 [01:05<00:58,  6.49s/it]
Task 8, Epoch 12/20 => Loss 0.088, Train_accy 75.71:  55%|█████▌    | 11/20 [01:09<00:58,  6.49s/it]                 
Task 8, Epoch 12/20 => Loss 0.088, Train_accy 75.71:  60%|██████    | 12/20 [01:09<00:46,  5.76s/it]
Task 8, Epoch 13/20 => Loss 0.131, Train_accy 76.32:  60%|██████    | 12/20 [01:13<00:46,  5.76s/it]
Task 8, Epoch 13/20 => Loss 0.131, Train_accy 76.32:  65%|██████▌   | 13/20 [01:13<00:36,  5.26s/it]
Task 8, Epoch 14/20 => Loss 0.130, Train_accy 77.13:  65%|██████▌   | 13/20 [01:17<00:36,  5.26s/it]
Task 8, Epoch 14/20 => Loss 0.130, Train_accy 77.13:  70%|███████   | 14/20 [01:17<00:29,  4.93s/it]
Task 8, Epoch 15/20 => Loss 0.082, Train_accy 81.17:  70%|███████   | 14/20 [01:21<00:29,  4.93s/it]
Task 8, Epoch 15/20 => Loss 0.082, Train_accy 81.17:  75%|███████▌  | 15/20 [01:21<00:23,  4.68s/it]
Task 8, Epoch 16/20 => Loss 0.120, Train_accy 76.72, Test_accy 50.52:  75%|███████▌  | 15/20 [01:32<00:23,  4.68s/it]
Task 8, Epoch 16/20 => Loss 0.120, Train_accy 76.72, Test_accy 50.52:  80%|████████  | 16/20 [01:32<00:26,  6.50s/it]
Task 8, Epoch 17/20 => Loss 0.117, Train_accy 73.89:  80%|████████  | 16/20 [01:36<00:26,  6.50s/it]                 
Task 8, Epoch 17/20 => Loss 0.117, Train_accy 73.89:  85%|████████▌ | 17/20 [01:36<00:17,  5.81s/it]
Task 8, Epoch 18/20 => Loss 0.095, Train_accy 76.72:  85%|████████▌ | 17/20 [01:40<00:17,  5.81s/it]
Task 8, Epoch 18/20 => Loss 0.095, Train_accy 76.72:  90%|█████████ | 18/20 [01:40<00:10,  5.30s/it]
Task 8, Epoch 19/20 => Loss 0.124, Train_accy 78.54:  90%|█████████ | 18/20 [01:44<00:10,  5.30s/it]
Task 8, Epoch 19/20 => Loss 0.124, Train_accy 78.54:  95%|█████████▌| 19/20 [01:44<00:04,  4.96s/it]
Task 8, Epoch 20/20 => Loss 0.080, Train_accy 79.35:  95%|█████████▌| 19/20 [01:48<00:04,  4.96s/it]
Task 8, Epoch 20/20 => Loss 0.080, Train_accy 79.35: 100%|██████████| 20/20 [01:48<00:00,  4.72s/it]
Task 8, Epoch 20/20 => Loss 0.080, Train_accy 79.35: 100%|██████████| 20/20 [01:48<00:00,  5.45s/it]
2024-09-04 18:48:00,269 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.080, Train_accy 79.35
2024-09-04 18:48:06,831 [trainer.py] => No NME accuracy.
2024-09-04 18:48:06,831 [trainer.py] => CNN: {'total': 51.41, '00-99': 39.39, '100-109': 57.39, '110-119': 47.79, '120-129': 52.34, '130-139': 53.39, '140-149': 45.24, '150-159': 88.71, '160-169': 94.78, '170-179': 90.29, 'old': 49.43, 'new': 90.29}
2024-09-04 18:48:06,831 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77, 65.51, 65.03, 57.43, 50.47, 51.41]
2024-09-04 18:48:06,831 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8, 94.7, 94.96, 93.23, 89.43, 87.5]

Average Accuracy (CNN): 67.11
2024-09-04 18:48:06,832 [trainer.py] => Average Accuracy (CNN): 67.11 

2024-09-04 18:48:06,833 [trainer.py] => All params: 85937076
2024-09-04 18:48:06,834 [trainer.py] => Trainable params: 85937076
2024-09-04 18:48:06,837 [finetune.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.450, Train_accy 0.66, Test_accy 45.93:   0%|          | 0/20 [00:10<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.450, Train_accy 0.66, Test_accy 45.93:   5%|▌         | 1/20 [00:10<03:26, 10.86s/it]
Task 9, Epoch 2/20 => Loss 0.281, Train_accy 21.32:   5%|▌         | 1/20 [00:14<03:26, 10.86s/it]                
Task 9, Epoch 2/20 => Loss 0.281, Train_accy 21.32:  10%|█         | 2/20 [00:14<02:01,  6.74s/it]
Task 9, Epoch 3/20 => Loss 0.258, Train_accy 65.93:  10%|█         | 2/20 [00:18<02:01,  6.74s/it]
Task 9, Epoch 3/20 => Loss 0.258, Train_accy 65.93:  15%|█▌        | 3/20 [00:18<01:32,  5.44s/it]
Task 9, Epoch 4/20 => Loss 0.188, Train_accy 75.82:  15%|█▌        | 3/20 [00:22<01:32,  5.44s/it]
Task 9, Epoch 4/20 => Loss 0.188, Train_accy 75.82:  20%|██        | 4/20 [00:22<01:17,  4.82s/it]
Task 9, Epoch 5/20 => Loss 0.223, Train_accy 80.88:  20%|██        | 4/20 [00:26<01:17,  4.82s/it]
Task 9, Epoch 5/20 => Loss 0.223, Train_accy 80.88:  25%|██▌       | 5/20 [00:26<01:06,  4.46s/it]
Task 9, Epoch 6/20 => Loss 0.164, Train_accy 83.52, Test_accy 47.35:  25%|██▌       | 5/20 [00:37<01:06,  4.46s/it]
Task 9, Epoch 6/20 => Loss 0.164, Train_accy 83.52, Test_accy 47.35:  30%|███       | 6/20 [00:37<01:32,  6.59s/it]
Task 9, Epoch 7/20 => Loss 0.145, Train_accy 85.05:  30%|███       | 6/20 [00:40<01:32,  6.59s/it]                 
Task 9, Epoch 7/20 => Loss 0.145, Train_accy 85.05:  35%|███▌      | 7/20 [00:40<01:13,  5.69s/it]
Task 9, Epoch 8/20 => Loss 0.167, Train_accy 84.18:  35%|███▌      | 7/20 [00:44<01:13,  5.69s/it]
Task 9, Epoch 8/20 => Loss 0.167, Train_accy 84.18:  40%|████      | 8/20 [00:44<01:01,  5.10s/it]
Task 9, Epoch 9/20 => Loss 0.155, Train_accy 82.86:  40%|████      | 8/20 [00:48<01:01,  5.10s/it]
Task 9, Epoch 9/20 => Loss 0.155, Train_accy 82.86:  45%|████▌     | 9/20 [00:48<00:51,  4.70s/it]
Task 9, Epoch 10/20 => Loss 0.128, Train_accy 88.35:  45%|████▌     | 9/20 [00:52<00:51,  4.70s/it]
Task 9, Epoch 10/20 => Loss 0.128, Train_accy 88.35:  50%|█████     | 10/20 [00:52<00:44,  4.44s/it]
Task 9, Epoch 11/20 => Loss 0.158, Train_accy 83.96, Test_accy 49.20:  50%|█████     | 10/20 [01:03<00:44,  4.44s/it]
Task 9, Epoch 11/20 => Loss 0.158, Train_accy 83.96, Test_accy 49.20:  55%|█████▌    | 11/20 [01:03<00:57,  6.34s/it]
Task 9, Epoch 12/20 => Loss 0.120, Train_accy 87.47:  55%|█████▌    | 11/20 [01:06<00:57,  6.34s/it]                 
Task 9, Epoch 12/20 => Loss 0.120, Train_accy 87.47:  60%|██████    | 12/20 [01:06<00:44,  5.58s/it]
Task 9, Epoch 13/20 => Loss 0.170, Train_accy 86.15:  60%|██████    | 12/20 [01:10<00:44,  5.58s/it]
Task 9, Epoch 13/20 => Loss 0.170, Train_accy 86.15:  65%|██████▌   | 13/20 [01:10<00:35,  5.05s/it]
Task 9, Epoch 14/20 => Loss 0.149, Train_accy 87.47:  65%|██████▌   | 13/20 [01:14<00:35,  5.05s/it]
Task 9, Epoch 14/20 => Loss 0.149, Train_accy 87.47:  70%|███████   | 14/20 [01:14<00:28,  4.71s/it]
Task 9, Epoch 15/20 => Loss 0.100, Train_accy 89.23:  70%|███████   | 14/20 [01:18<00:28,  4.71s/it]
Task 9, Epoch 15/20 => Loss 0.100, Train_accy 89.23:  75%|███████▌  | 15/20 [01:18<00:22,  4.45s/it]
Task 9, Epoch 16/20 => Loss 0.093, Train_accy 88.35, Test_accy 49.42:  75%|███████▌  | 15/20 [01:29<00:22,  4.45s/it]
Task 9, Epoch 16/20 => Loss 0.093, Train_accy 88.35, Test_accy 49.42:  80%|████████  | 16/20 [01:29<00:25,  6.38s/it]
Task 9, Epoch 17/20 => Loss 0.121, Train_accy 88.35:  80%|████████  | 16/20 [01:33<00:25,  6.38s/it]                 
Task 9, Epoch 17/20 => Loss 0.121, Train_accy 88.35:  85%|████████▌ | 17/20 [01:33<00:16,  5.63s/it]
Task 9, Epoch 18/20 => Loss 0.113, Train_accy 85.71:  85%|████████▌ | 17/20 [01:37<00:16,  5.63s/it]
Task 9, Epoch 18/20 => Loss 0.113, Train_accy 85.71:  90%|█████████ | 18/20 [01:37<00:10,  5.11s/it]
Task 9, Epoch 19/20 => Loss 0.139, Train_accy 87.47:  90%|█████████ | 18/20 [01:40<00:10,  5.11s/it]
Task 9, Epoch 19/20 => Loss 0.139, Train_accy 87.47:  95%|█████████▌| 19/20 [01:40<00:04,  4.72s/it]
Task 9, Epoch 20/20 => Loss 0.113, Train_accy 89.01:  95%|█████████▌| 19/20 [01:44<00:04,  4.72s/it]
Task 9, Epoch 20/20 => Loss 0.113, Train_accy 89.01: 100%|██████████| 20/20 [01:44<00:00,  4.46s/it]
Task 9, Epoch 20/20 => Loss 0.113, Train_accy 89.01: 100%|██████████| 20/20 [01:44<00:00,  5.24s/it]
2024-09-04 18:49:51,620 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.113, Train_accy 89.01
2024-09-04 18:49:58,487 [trainer.py] => No NME accuracy.
2024-09-04 18:49:58,488 [trainer.py] => CNN: {'total': 49.38, '00-99': 36.87, '100-109': 56.52, '110-119': 38.94, '120-129': 39.25, '130-139': 35.59, '140-149': 43.65, '150-159': 83.87, '160-169': 88.81, '170-179': 83.5, '180-189': 91.67, 'old': 46.76, 'new': 91.67}
2024-09-04 18:49:58,488 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77, 65.51, 65.03, 57.43, 50.47, 51.41, 49.38]
2024-09-04 18:49:58,488 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8, 94.7, 94.96, 93.23, 89.43, 87.5, 86.77]

Average Accuracy (CNN): 65.34
2024-09-04 18:49:58,488 [trainer.py] => Average Accuracy (CNN): 65.34 

2024-09-04 18:49:58,490 [trainer.py] => All params: 85944766
2024-09-04 18:49:58,491 [trainer.py] => Trainable params: 85944766
2024-09-04 18:49:58,495 [finetune.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.489, Train_accy 0.40, Test_accy 47.71:   0%|          | 0/20 [00:11<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.489, Train_accy 0.40, Test_accy 47.71:   5%|▌         | 1/20 [00:11<03:35, 11.36s/it]
Task 10, Epoch 2/20 => Loss 0.352, Train_accy 29.38:   5%|▌         | 1/20 [00:15<03:35, 11.36s/it]                
Task 10, Epoch 2/20 => Loss 0.352, Train_accy 29.38:  10%|█         | 2/20 [00:15<02:08,  7.12s/it]
Task 10, Epoch 3/20 => Loss 0.295, Train_accy 60.56:  10%|█         | 2/20 [00:19<02:08,  7.12s/it]
Task 10, Epoch 3/20 => Loss 0.295, Train_accy 60.56:  15%|█▌        | 3/20 [00:19<01:37,  5.76s/it]
Task 10, Epoch 4/20 => Loss 0.233, Train_accy 70.42:  15%|█▌        | 3/20 [00:23<01:37,  5.76s/it]
Task 10, Epoch 4/20 => Loss 0.233, Train_accy 70.42:  20%|██        | 4/20 [00:23<01:21,  5.12s/it]
Task 10, Epoch 5/20 => Loss 0.229, Train_accy 75.25:  20%|██        | 4/20 [00:27<01:21,  5.12s/it]
Task 10, Epoch 5/20 => Loss 0.229, Train_accy 75.25:  25%|██▌       | 5/20 [00:27<01:11,  4.76s/it]
Task 10, Epoch 6/20 => Loss 0.166, Train_accy 79.07, Test_accy 47.03:  25%|██▌       | 5/20 [00:39<01:11,  4.76s/it]
Task 10, Epoch 6/20 => Loss 0.166, Train_accy 79.07, Test_accy 47.03:  30%|███       | 6/20 [00:39<01:37,  6.99s/it]
Task 10, Epoch 7/20 => Loss 0.187, Train_accy 75.45:  30%|███       | 6/20 [00:43<01:37,  6.99s/it]                 
Task 10, Epoch 7/20 => Loss 0.187, Train_accy 75.45:  35%|███▌      | 7/20 [00:43<01:18,  6.05s/it]
Task 10, Epoch 8/20 => Loss 0.157, Train_accy 82.09:  35%|███▌      | 7/20 [00:47<01:18,  6.05s/it]
Task 10, Epoch 8/20 => Loss 0.157, Train_accy 82.09:  40%|████      | 8/20 [00:47<01:05,  5.45s/it]
Task 10, Epoch 9/20 => Loss 0.126, Train_accy 80.68:  40%|████      | 8/20 [00:51<01:05,  5.45s/it]
Task 10, Epoch 9/20 => Loss 0.126, Train_accy 80.68:  45%|████▌     | 9/20 [00:51<00:55,  5.05s/it]
Task 10, Epoch 10/20 => Loss 0.127, Train_accy 81.69:  45%|████▌     | 9/20 [00:55<00:55,  5.05s/it]
Task 10, Epoch 10/20 => Loss 0.127, Train_accy 81.69:  50%|█████     | 10/20 [00:55<00:47,  4.78s/it]
Task 10, Epoch 11/20 => Loss 0.135, Train_accy 81.49, Test_accy 47.63:  50%|█████     | 10/20 [01:07<00:47,  4.78s/it]
Task 10, Epoch 11/20 => Loss 0.135, Train_accy 81.49, Test_accy 47.63:  55%|█████▌    | 11/20 [01:07<01:01,  6.80s/it]
Task 10, Epoch 12/20 => Loss 0.079, Train_accy 86.32:  55%|█████▌    | 11/20 [01:11<01:01,  6.80s/it]                 
Task 10, Epoch 12/20 => Loss 0.079, Train_accy 86.32:  60%|██████    | 12/20 [01:11<00:48,  6.02s/it]
Task 10, Epoch 13/20 => Loss 0.137, Train_accy 82.70:  60%|██████    | 12/20 [01:15<00:48,  6.02s/it]
Task 10, Epoch 13/20 => Loss 0.137, Train_accy 82.70:  65%|██████▌   | 13/20 [01:15<00:38,  5.45s/it]
Task 10, Epoch 14/20 => Loss 0.172, Train_accy 83.30:  65%|██████▌   | 13/20 [01:19<00:38,  5.45s/it]
Task 10, Epoch 14/20 => Loss 0.172, Train_accy 83.30:  70%|███████   | 14/20 [01:19<00:30,  5.06s/it]
Task 10, Epoch 15/20 => Loss 0.128, Train_accy 83.30:  70%|███████   | 14/20 [01:24<00:30,  5.06s/it]
Task 10, Epoch 15/20 => Loss 0.128, Train_accy 83.30:  75%|███████▌  | 15/20 [01:24<00:24,  4.82s/it]
Task 10, Epoch 16/20 => Loss 0.186, Train_accy 83.70, Test_accy 48.85:  75%|███████▌  | 15/20 [01:35<00:24,  4.82s/it]
Task 10, Epoch 16/20 => Loss 0.186, Train_accy 83.70, Test_accy 48.85:  80%|████████  | 16/20 [01:35<00:27,  6.76s/it]
Task 10, Epoch 17/20 => Loss 0.105, Train_accy 86.92:  80%|████████  | 16/20 [01:39<00:27,  6.76s/it]                 
Task 10, Epoch 17/20 => Loss 0.105, Train_accy 86.92:  85%|████████▌ | 17/20 [01:39<00:17,  5.96s/it]
Task 10, Epoch 18/20 => Loss 0.082, Train_accy 89.74:  85%|████████▌ | 17/20 [01:43<00:17,  5.96s/it]
Task 10, Epoch 18/20 => Loss 0.082, Train_accy 89.74:  90%|█████████ | 18/20 [01:43<00:10,  5.41s/it]
Task 10, Epoch 19/20 => Loss 0.093, Train_accy 89.94:  90%|█████████ | 18/20 [01:47<00:10,  5.41s/it]
Task 10, Epoch 19/20 => Loss 0.093, Train_accy 89.94:  95%|█████████▌| 19/20 [01:47<00:05,  5.03s/it]
Task 10, Epoch 20/20 => Loss 0.084, Train_accy 85.31:  95%|█████████▌| 19/20 [01:51<00:05,  5.03s/it]
Task 10, Epoch 20/20 => Loss 0.084, Train_accy 85.31: 100%|██████████| 20/20 [01:51<00:00,  4.76s/it]
Task 10, Epoch 20/20 => Loss 0.084, Train_accy 85.31: 100%|██████████| 20/20 [01:51<00:00,  5.59s/it]
2024-09-04 18:51:50,327 [finetune.py] => Task 10, Epoch 20/20 => Loss 0.084, Train_accy 85.31
2024-09-04 18:51:57,527 [trainer.py] => No NME accuracy.
2024-09-04 18:51:57,528 [trainer.py] => CNN: {'total': 48.56, '00-99': 36.03, '100-109': 63.48, '110-119': 41.59, '120-129': 42.99, '130-139': 36.44, '140-149': 39.68, '150-159': 85.48, '160-169': 65.67, '170-179': 71.84, '180-189': 79.55, '190-199': 86.73, 'old': 46.9, 'new': 86.73}
2024-09-04 18:51:57,528 [trainer.py] => CNN top1 curve: [88.47, 81.81, 72.1, 71.77, 65.51, 65.03, 57.43, 50.47, 51.41, 49.38, 48.56]
2024-09-04 18:51:57,528 [trainer.py] => CNN top5 curve: [98.15, 97.7, 95.69, 95.8, 94.7, 94.96, 93.23, 89.43, 87.5, 86.77, 87.11]

Average Accuracy (CNN): 63.81
2024-09-04 18:51:57,528 [trainer.py] => Average Accuracy (CNN): 63.81 

Accuracy Matrix (CNN):
[[88.47 80.64 69.28 67.26 59.51 58.25 50.34 41.5  39.39 36.87 36.03]
 [ 0.   93.91 94.78 93.91 90.43 80.87 59.13 54.78 57.39 56.52 63.48]
 [ 0.    0.   78.76 80.53 74.34 73.45 59.29 44.25 47.79 38.94 41.59]
 [ 0.    0.    0.   88.79 72.9  66.36 61.68 56.07 52.34 39.25 42.99]
 [ 0.    0.    0.    0.   86.44 89.83 69.49 44.92 53.39 35.59 36.44]
 [ 0.    0.    0.    0.    0.   82.54 65.08 46.83 45.24 43.65 39.68]
 [ 0.    0.    0.    0.    0.    0.   99.19 89.52 88.71 83.87 85.48]
 [ 0.    0.    0.    0.    0.    0.    0.   99.25 94.78 88.81 65.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   90.29 83.5  71.84]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   91.67 79.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   86.73]]
2024-09-04 18:51:57,530 [trainer.py] => Forgetting (CNN): 34.259
2024-09-04 18:52:00,813 [trainer.py] => config: ./exps/simplecil_cub_B0_Inc5.json
2024-09-04 18:52:00,814 [trainer.py] => prefix:  
2024-09-04 18:52:00,814 [trainer.py] => dataset: cub
2024-09-04 18:52:00,814 [trainer.py] => memory_size: 0
2024-09-04 18:52:00,814 [trainer.py] => memory_per_class: 0
2024-09-04 18:52:00,814 [trainer.py] => fixed_memory: False
2024-09-04 18:52:00,814 [trainer.py] => shuffle: True
2024-09-04 18:52:00,814 [trainer.py] => init_cls: 40
2024-09-04 18:52:00,814 [trainer.py] => increment: 40
2024-09-04 18:52:00,814 [trainer.py] => model_name: simplecil
2024-09-04 18:52:00,814 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-04 18:52:00,814 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 18:52:00,814 [trainer.py] => seed: 1993
2024-09-04 18:52:00,814 [trainer.py] => tuned_epoch: 0
2024-09-04 18:52:00,814 [trainer.py] => init_lr: 0.01
2024-09-04 18:52:00,814 [trainer.py] => batch_size: 48
2024-09-04 18:52:00,814 [trainer.py] => weight_decay: 0.05
2024-09-04 18:52:00,814 [trainer.py] => min_lr: 1e-08
2024-09-04 18:52:00,814 [trainer.py] => optimizer: sgd
2024-09-04 18:52:00,814 [trainer.py] => vpt_type: shallow
2024-09-04 18:52:00,814 [trainer.py] => prompt_token_num: 3
2024-09-04 18:52:00,853 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 18:52:05,776 [trainer.py] => All params: 85798656
2024-09-04 18:52:05,778 [trainer.py] => Trainable params: 85798656
2024-09-04 18:52:06,210 [simplecil.py] => Learning on 0-40
2024-09-04 18:52:15,360 [trainer.py] => No NME accuracy.
2024-09-04 18:52:15,360 [trainer.py] => CNN: {'total': 96.92, '00-39': 96.92, 'old': 0, 'new': 96.92}
2024-09-04 18:52:15,360 [trainer.py] => CNN top1 curve: [96.92]
2024-09-04 18:52:15,360 [trainer.py] => CNN top5 curve: [99.78]

Average Accuracy (CNN): 96.92
2024-09-04 18:52:15,360 [trainer.py] => Average Accuracy (CNN): 96.92 

2024-09-04 18:52:15,361 [trainer.py] => All params: 85829377
2024-09-04 18:52:15,362 [trainer.py] => Trainable params: 85829377
2024-09-04 18:52:15,363 [simplecil.py] => Learning on 40-80
2024-09-04 18:52:25,101 [trainer.py] => No NME accuracy.
2024-09-04 18:52:25,102 [trainer.py] => CNN: {'total': 91.95, '00-39': 93.39, '40-79': 90.54, 'old': 93.39, 'new': 90.54}
2024-09-04 18:52:25,102 [trainer.py] => CNN top1 curve: [96.92, 91.95]
2024-09-04 18:52:25,102 [trainer.py] => CNN top5 curve: [99.78, 99.02]

Average Accuracy (CNN): 94.44
2024-09-04 18:52:25,102 [trainer.py] => Average Accuracy (CNN): 94.44 

2024-09-04 18:52:25,104 [trainer.py] => All params: 85860097
2024-09-04 18:52:25,105 [trainer.py] => Trainable params: 85860097
2024-09-04 18:52:25,108 [simplecil.py] => Learning on 80-120
2024-09-04 18:52:36,119 [trainer.py] => No NME accuracy.
2024-09-04 18:52:36,119 [trainer.py] => CNN: {'total': 88.91, '00-39': 90.97, '40-79': 87.31, '80-119': 88.53, 'old': 89.12, 'new': 88.53}
2024-09-04 18:52:36,119 [trainer.py] => CNN top1 curve: [96.92, 91.95, 88.91]
2024-09-04 18:52:36,119 [trainer.py] => CNN top5 curve: [99.78, 99.02, 98.73]

Average Accuracy (CNN): 92.59
2024-09-04 18:52:36,119 [trainer.py] => Average Accuracy (CNN): 92.59 

2024-09-04 18:52:36,121 [trainer.py] => All params: 85890817
2024-09-04 18:52:36,122 [trainer.py] => Trainable params: 85890817
2024-09-04 18:52:36,124 [simplecil.py] => Learning on 120-160
2024-09-04 18:52:48,528 [trainer.py] => No NME accuracy.
2024-09-04 18:52:48,528 [trainer.py] => CNN: {'total': 86.62, '00-39': 88.55, '40-79': 85.38, '80-119': 86.32, '120-159': 86.32, 'old': 86.72, 'new': 86.32}
2024-09-04 18:52:48,528 [trainer.py] => CNN top1 curve: [96.92, 91.95, 88.91, 86.62]
2024-09-04 18:52:48,528 [trainer.py] => CNN top5 curve: [99.78, 99.02, 98.73, 98.41]

Average Accuracy (CNN): 91.1
2024-09-04 18:52:48,528 [trainer.py] => Average Accuracy (CNN): 91.1 

2024-09-04 18:52:48,530 [trainer.py] => All params: 85921537
2024-09-04 18:52:48,530 [trainer.py] => Trainable params: 85921537
2024-09-04 18:52:48,534 [simplecil.py] => Learning on 160-200
2024-09-04 18:53:02,100 [trainer.py] => No NME accuracy.
2024-09-04 18:53:02,101 [trainer.py] => CNN: {'total': 85.24, '00-39': 87.0, '40-79': 83.66, '80-119': 85.11, '120-159': 85.47, '160-199': 85.01, 'old': 85.3, 'new': 85.01}
2024-09-04 18:53:02,101 [trainer.py] => CNN top1 curve: [96.92, 91.95, 88.91, 86.62, 85.24]
2024-09-04 18:53:02,101 [trainer.py] => CNN top5 curve: [99.78, 99.02, 98.73, 98.41, 97.79]

Average Accuracy (CNN): 89.93
2024-09-04 18:53:02,101 [trainer.py] => Average Accuracy (CNN): 89.93 

Accuracy Matrix (CNN):
[[96.92 93.39 90.97 88.55 87.  ]
 [ 0.   90.54 87.31 85.38 83.66]
 [ 0.    0.   88.53 86.32 85.11]
 [ 0.    0.    0.   86.32 85.47]
 [ 0.    0.    0.    0.   85.01]]
2024-09-04 18:53:02,102 [trainer.py] => Forgetting (CNN): 5.267500000000002
2024-09-04 18:53:05,037 [trainer.py] => config: ./exps/simplecil_cub_B0_Inc10.json
2024-09-04 18:53:05,053 [trainer.py] => prefix:  
2024-09-04 18:53:05,053 [trainer.py] => dataset: cub
2024-09-04 18:53:05,053 [trainer.py] => memory_size: 0
2024-09-04 18:53:05,053 [trainer.py] => memory_per_class: 0
2024-09-04 18:53:05,053 [trainer.py] => fixed_memory: False
2024-09-04 18:53:05,053 [trainer.py] => shuffle: True
2024-09-04 18:53:05,053 [trainer.py] => init_cls: 20
2024-09-04 18:53:05,053 [trainer.py] => increment: 20
2024-09-04 18:53:05,053 [trainer.py] => model_name: simplecil
2024-09-04 18:53:05,053 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-04 18:53:05,053 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 18:53:05,053 [trainer.py] => seed: 1993
2024-09-04 18:53:05,053 [trainer.py] => tuned_epoch: 0
2024-09-04 18:53:05,054 [trainer.py] => init_lr: 0.01
2024-09-04 18:53:05,054 [trainer.py] => batch_size: 48
2024-09-04 18:53:05,054 [trainer.py] => weight_decay: 0.05
2024-09-04 18:53:05,054 [trainer.py] => min_lr: 1e-08
2024-09-04 18:53:05,054 [trainer.py] => optimizer: sgd
2024-09-04 18:53:05,054 [trainer.py] => vpt_type: shallow
2024-09-04 18:53:05,054 [trainer.py] => prompt_token_num: 3
2024-09-04 18:53:05,090 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 18:53:07,533 [trainer.py] => All params: 85798656
2024-09-04 18:53:07,534 [trainer.py] => Trainable params: 85798656
2024-09-04 18:53:07,948 [simplecil.py] => Learning on 0-20
2024-09-04 18:53:13,330 [trainer.py] => No NME accuracy.
2024-09-04 18:53:13,330 [trainer.py] => CNN: {'total': 97.98, '00-19': 97.98, 'old': 0, 'new': 97.98}
2024-09-04 18:53:13,330 [trainer.py] => CNN top1 curve: [97.98]
2024-09-04 18:53:13,330 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.98
2024-09-04 18:53:13,330 [trainer.py] => Average Accuracy (CNN): 97.98 

2024-09-04 18:53:13,331 [trainer.py] => All params: 85814017
2024-09-04 18:53:13,332 [trainer.py] => Trainable params: 85814017
2024-09-04 18:53:13,333 [simplecil.py] => Learning on 20-40
2024-09-04 18:53:19,110 [trainer.py] => No NME accuracy.
2024-09-04 18:53:19,111 [trainer.py] => CNN: {'total': 96.92, '00-19': 97.17, '20-39': 96.62, 'old': 97.17, 'new': 96.62}
2024-09-04 18:53:19,111 [trainer.py] => CNN top1 curve: [97.98, 96.92]
2024-09-04 18:53:19,111 [trainer.py] => CNN top5 curve: [100.0, 99.78]

Average Accuracy (CNN): 97.45
2024-09-04 18:53:19,111 [trainer.py] => Average Accuracy (CNN): 97.45 

2024-09-04 18:53:19,112 [trainer.py] => All params: 85829377
2024-09-04 18:53:19,113 [trainer.py] => Trainable params: 85829377
2024-09-04 18:53:19,116 [simplecil.py] => Learning on 40-60
2024-09-04 18:53:25,519 [trainer.py] => No NME accuracy.
2024-09-04 18:53:25,520 [trainer.py] => CNN: {'total': 93.6, '00-19': 93.52, '20-39': 96.14, '40-59': 91.28, 'old': 94.71, 'new': 91.28}
2024-09-04 18:53:25,520 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6]
2024-09-04 18:53:25,520 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55]

Average Accuracy (CNN): 96.17
2024-09-04 18:53:25,520 [trainer.py] => Average Accuracy (CNN): 96.17 

2024-09-04 18:53:25,521 [trainer.py] => All params: 85844737
2024-09-04 18:53:25,522 [trainer.py] => Trainable params: 85844737
2024-09-04 18:53:25,524 [simplecil.py] => Learning on 60-80
2024-09-04 18:53:32,582 [trainer.py] => No NME accuracy.
2024-09-04 18:53:32,583 [trainer.py] => CNN: {'total': 91.95, '00-19': 91.9, '20-39': 95.17, '40-59': 89.91, '60-79': 91.09, 'old': 92.26, 'new': 91.09}
2024-09-04 18:53:32,583 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95]
2024-09-04 18:53:32,583 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02]

Average Accuracy (CNN): 95.11
2024-09-04 18:53:32,583 [trainer.py] => Average Accuracy (CNN): 95.11 

2024-09-04 18:53:32,584 [trainer.py] => All params: 85860097
2024-09-04 18:53:32,585 [trainer.py] => Trainable params: 85860097
2024-09-04 18:53:32,587 [simplecil.py] => Learning on 80-100
2024-09-04 18:53:40,508 [trainer.py] => No NME accuracy.
2024-09-04 18:53:40,508 [trainer.py] => CNN: {'total': 91.16, '00-19': 90.69, '20-39': 93.24, '40-59': 89.91, '60-79': 89.88, '80-99': 92.19, 'old': 90.86, 'new': 92.19}
2024-09-04 18:53:40,508 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16]
2024-09-04 18:53:40,508 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99]

Average Accuracy (CNN): 94.32
2024-09-04 18:53:40,508 [trainer.py] => Average Accuracy (CNN): 94.32 

2024-09-04 18:53:40,509 [trainer.py] => All params: 85875457
2024-09-04 18:53:40,509 [trainer.py] => Trainable params: 85875457
2024-09-04 18:53:40,511 [simplecil.py] => Learning on 100-120
2024-09-04 18:53:48,888 [trainer.py] => No NME accuracy.
2024-09-04 18:53:48,888 [trainer.py] => CNN: {'total': 88.91, '00-19': 89.47, '20-39': 92.75, '40-59': 89.45, '60-79': 85.43, '80-99': 91.08, '100-119': 85.53, 'old': 89.56, 'new': 85.53}
2024-09-04 18:53:48,888 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91]
2024-09-04 18:53:48,888 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73]

Average Accuracy (CNN): 93.42
2024-09-04 18:53:48,888 [trainer.py] => Average Accuracy (CNN): 93.42 

2024-09-04 18:53:48,889 [trainer.py] => All params: 85890817
2024-09-04 18:53:48,889 [trainer.py] => Trainable params: 85890817
2024-09-04 18:53:48,891 [simplecil.py] => Learning on 120-140
2024-09-04 18:53:57,971 [trainer.py] => No NME accuracy.
2024-09-04 18:53:57,972 [trainer.py] => CNN: {'total': 87.2, '00-19': 87.85, '20-39': 92.27, '40-59': 88.07, '60-79': 84.62, '80-99': 90.71, '100-119': 84.65, '120-139': 82.22, 'old': 87.99, 'new': 82.22}
2024-09-04 18:53:57,972 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2]
2024-09-04 18:53:57,972 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6]

Average Accuracy (CNN): 92.53
2024-09-04 18:53:57,972 [trainer.py] => Average Accuracy (CNN): 92.53 

2024-09-04 18:53:57,973 [trainer.py] => All params: 85906177
2024-09-04 18:53:57,974 [trainer.py] => Trainable params: 85906177
2024-09-04 18:53:57,976 [simplecil.py] => Learning on 140-160
2024-09-04 18:54:07,723 [trainer.py] => No NME accuracy.
2024-09-04 18:54:07,724 [trainer.py] => CNN: {'total': 86.62, '00-19': 86.64, '20-39': 90.82, '40-59': 86.7, '60-79': 84.21, '80-99': 88.48, '100-119': 83.77, '120-139': 82.22, '140-159': 90.0, 'old': 86.11, 'new': 90.0}
2024-09-04 18:54:07,724 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2, 86.62]
2024-09-04 18:54:07,724 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6, 98.41]

Average Accuracy (CNN): 91.79
2024-09-04 18:54:07,724 [trainer.py] => Average Accuracy (CNN): 91.79 

2024-09-04 18:54:07,725 [trainer.py] => All params: 85921537
2024-09-04 18:54:07,726 [trainer.py] => Trainable params: 85921537
2024-09-04 18:54:07,730 [simplecil.py] => Learning on 160-180
2024-09-04 18:54:18,249 [trainer.py] => No NME accuracy.
2024-09-04 18:54:18,249 [trainer.py] => CNN: {'total': 86.23, '00-19': 85.43, '20-39': 90.34, '40-59': 86.24, '60-79': 84.21, '80-99': 86.99, '100-119': 83.33, '120-139': 82.22, '140-159': 88.8, '160-179': 88.61, 'old': 85.93, 'new': 88.61}
2024-09-04 18:54:18,249 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2, 86.62, 86.23]
2024-09-04 18:54:18,249 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6, 98.41, 98.17]

Average Accuracy (CNN): 91.17
2024-09-04 18:54:18,249 [trainer.py] => Average Accuracy (CNN): 91.17 

2024-09-04 18:54:18,251 [trainer.py] => All params: 85936897
2024-09-04 18:54:18,252 [trainer.py] => Trainable params: 85936897
2024-09-04 18:54:18,255 [simplecil.py] => Learning on 180-200
2024-09-04 18:54:29,332 [trainer.py] => No NME accuracy.
2024-09-04 18:54:29,332 [trainer.py] => CNN: {'total': 85.24, '00-19': 85.43, '20-39': 88.89, '40-59': 85.32, '60-79': 82.19, '80-99': 86.62, '100-119': 83.33, '120-139': 81.78, '140-159': 88.8, '160-179': 86.92, '180-199': 83.04, 'old': 85.48, 'new': 83.04}
2024-09-04 18:54:29,333 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2, 86.62, 86.23, 85.24]
2024-09-04 18:54:29,333 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6, 98.41, 98.17, 97.79]

Average Accuracy (CNN): 90.58
2024-09-04 18:54:29,333 [trainer.py] => Average Accuracy (CNN): 90.58 

Accuracy Matrix (CNN):
[[97.98 97.17 93.52 91.9  90.69 89.47 87.85 86.64 85.43 85.43]
 [ 0.   96.62 96.14 95.17 93.24 92.75 92.27 90.82 90.34 88.89]
 [ 0.    0.   91.28 89.91 89.91 89.45 88.07 86.7  86.24 85.32]
 [ 0.    0.    0.   91.09 89.88 85.43 84.62 84.21 84.21 82.19]
 [ 0.    0.    0.    0.   92.19 91.08 90.71 88.48 86.99 86.62]
 [ 0.    0.    0.    0.    0.   85.53 84.65 83.77 83.33 83.33]
 [ 0.    0.    0.    0.    0.    0.   82.22 82.22 82.22 81.78]
 [ 0.    0.    0.    0.    0.    0.    0.   90.   88.8  88.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   88.61 86.92]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   83.04]]
2024-09-04 18:54:29,334 [trainer.py] => Forgetting (CNN): 5.137777777777779
2024-09-04 18:54:32,120 [trainer.py] => config: ./exps/simplecil_cub_B0_Inc20.json
2024-09-04 18:54:32,120 [trainer.py] => prefix:  
2024-09-04 18:54:32,120 [trainer.py] => dataset: cub
2024-09-04 18:54:32,120 [trainer.py] => memory_size: 0
2024-09-04 18:54:32,120 [trainer.py] => memory_per_class: 0
2024-09-04 18:54:32,120 [trainer.py] => fixed_memory: False
2024-09-04 18:54:32,120 [trainer.py] => shuffle: True
2024-09-04 18:54:32,120 [trainer.py] => init_cls: 10
2024-09-04 18:54:32,120 [trainer.py] => increment: 10
2024-09-04 18:54:32,121 [trainer.py] => model_name: simplecil
2024-09-04 18:54:32,121 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-04 18:54:32,121 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 18:54:32,121 [trainer.py] => seed: 1993
2024-09-04 18:54:32,121 [trainer.py] => tuned_epoch: 0
2024-09-04 18:54:32,121 [trainer.py] => init_lr: 0.01
2024-09-04 18:54:32,121 [trainer.py] => batch_size: 48
2024-09-04 18:54:32,121 [trainer.py] => weight_decay: 0.05
2024-09-04 18:54:32,121 [trainer.py] => min_lr: 1e-08
2024-09-04 18:54:32,121 [trainer.py] => optimizer: sgd
2024-09-04 18:54:32,121 [trainer.py] => vpt_type: shallow
2024-09-04 18:54:32,121 [trainer.py] => prompt_token_num: 3
2024-09-04 18:54:32,157 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 18:54:34,275 [trainer.py] => All params: 85798656
2024-09-04 18:54:34,276 [trainer.py] => Trainable params: 85798656
2024-09-04 18:54:34,686 [simplecil.py] => Learning on 0-10
2024-09-04 18:54:38,466 [trainer.py] => No NME accuracy.
2024-09-04 18:54:38,466 [trainer.py] => CNN: {'total': 99.15, '00-09': 99.15, 'old': 0, 'new': 99.15}
2024-09-04 18:54:38,466 [trainer.py] => CNN top1 curve: [99.15]
2024-09-04 18:54:38,466 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.15
2024-09-04 18:54:38,467 [trainer.py] => Average Accuracy (CNN): 99.15 

2024-09-04 18:54:38,468 [trainer.py] => All params: 85806337
2024-09-04 18:54:38,468 [trainer.py] => Trainable params: 85806337
2024-09-04 18:54:38,470 [simplecil.py] => Learning on 10-20
2024-09-04 18:54:42,452 [trainer.py] => No NME accuracy.
2024-09-04 18:54:42,453 [trainer.py] => CNN: {'total': 97.98, '00-09': 99.15, '10-19': 96.9, 'old': 99.15, 'new': 96.9}
2024-09-04 18:54:42,453 [trainer.py] => CNN top1 curve: [99.15, 97.98]
2024-09-04 18:54:42,453 [trainer.py] => CNN top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 98.56
2024-09-04 18:54:42,453 [trainer.py] => Average Accuracy (CNN): 98.56 

2024-09-04 18:54:42,454 [trainer.py] => All params: 85814017
2024-09-04 18:54:42,454 [trainer.py] => Trainable params: 85814017
2024-09-04 18:54:42,455 [simplecil.py] => Learning on 20-30
2024-09-04 18:54:46,544 [trainer.py] => No NME accuracy.
2024-09-04 18:54:46,544 [trainer.py] => CNN: {'total': 97.67, '00-09': 98.31, '10-19': 96.9, '20-29': 97.94, 'old': 97.57, 'new': 97.94}
2024-09-04 18:54:46,544 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67]
2024-09-04 18:54:46,544 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71]

Average Accuracy (CNN): 98.27
2024-09-04 18:54:46,544 [trainer.py] => Average Accuracy (CNN): 98.27 

2024-09-04 18:54:46,546 [trainer.py] => All params: 85821697
2024-09-04 18:54:46,546 [trainer.py] => Trainable params: 85821697
2024-09-04 18:54:46,548 [simplecil.py] => Learning on 30-40
2024-09-04 18:54:51,378 [trainer.py] => No NME accuracy.
2024-09-04 18:54:51,378 [trainer.py] => CNN: {'total': 96.92, '00-09': 98.31, '10-19': 96.12, '20-29': 96.91, '30-39': 96.36, 'old': 97.09, 'new': 96.36}
2024-09-04 18:54:51,378 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92]
2024-09-04 18:54:51,378 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78]

Average Accuracy (CNN): 97.93
2024-09-04 18:54:51,379 [trainer.py] => Average Accuracy (CNN): 97.93 

2024-09-04 18:54:51,379 [trainer.py] => All params: 85829377
2024-09-04 18:54:51,380 [trainer.py] => Trainable params: 85829377
2024-09-04 18:54:51,381 [simplecil.py] => Learning on 40-50
2024-09-04 18:54:56,195 [trainer.py] => No NME accuracy.
2024-09-04 18:54:56,195 [trainer.py] => CNN: {'total': 96.26, '00-09': 97.46, '10-19': 95.35, '20-29': 96.91, '30-39': 95.45, '40-49': 96.26, 'old': 96.26, 'new': 96.26}
2024-09-04 18:54:56,195 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26]
2024-09-04 18:54:56,195 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82]

Average Accuracy (CNN): 97.6
2024-09-04 18:54:56,195 [trainer.py] => Average Accuracy (CNN): 97.6 

2024-09-04 18:54:56,196 [trainer.py] => All params: 85837057
2024-09-04 18:54:56,196 [trainer.py] => Trainable params: 85837057
2024-09-04 18:54:56,197 [simplecil.py] => Learning on 50-60
2024-09-04 18:55:01,347 [trainer.py] => No NME accuracy.
2024-09-04 18:55:01,348 [trainer.py] => CNN: {'total': 93.6, '00-09': 91.53, '10-19': 95.35, '20-29': 96.91, '30-39': 95.45, '40-49': 96.26, '50-59': 86.49, 'old': 95.01, 'new': 86.49}
2024-09-04 18:55:01,348 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6]
2024-09-04 18:55:01,348 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55]

Average Accuracy (CNN): 96.93
2024-09-04 18:55:01,348 [trainer.py] => Average Accuracy (CNN): 96.93 

2024-09-04 18:55:01,348 [trainer.py] => All params: 85844737
2024-09-04 18:55:01,349 [trainer.py] => Trainable params: 85844737
2024-09-04 18:55:01,350 [simplecil.py] => Learning on 60-70
2024-09-04 18:55:06,853 [trainer.py] => No NME accuracy.
2024-09-04 18:55:06,854 [trainer.py] => CNN: {'total': 91.52, '00-09': 90.68, '10-19': 93.02, '20-29': 96.91, '30-39': 94.55, '40-49': 95.33, '50-59': 84.68, '60-69': 85.85, 'old': 92.41, 'new': 85.85}
2024-09-04 18:55:06,854 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52]
2024-09-04 18:55:06,854 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23]

Average Accuracy (CNN): 96.16
2024-09-04 18:55:06,854 [trainer.py] => Average Accuracy (CNN): 96.16 

2024-09-04 18:55:06,855 [trainer.py] => All params: 85852417
2024-09-04 18:55:06,855 [trainer.py] => Trainable params: 85852417
2024-09-04 18:55:06,856 [simplecil.py] => Learning on 70-80
2024-09-04 18:55:12,585 [trainer.py] => No NME accuracy.
2024-09-04 18:55:12,586 [trainer.py] => CNN: {'total': 91.95, '00-09': 90.68, '10-19': 93.02, '20-29': 96.91, '30-39': 93.64, '40-49': 95.33, '50-59': 84.68, '60-69': 85.85, '70-79': 95.04, 'old': 91.39, 'new': 95.04}
2024-09-04 18:55:12,586 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95]
2024-09-04 18:55:12,586 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02]

Average Accuracy (CNN): 95.63
2024-09-04 18:55:12,586 [trainer.py] => Average Accuracy (CNN): 95.63 

2024-09-04 18:55:12,588 [trainer.py] => All params: 85860097
2024-09-04 18:55:12,589 [trainer.py] => Trainable params: 85860097
2024-09-04 18:55:12,592 [simplecil.py] => Learning on 80-90
2024-09-04 18:55:18,831 [trainer.py] => No NME accuracy.
2024-09-04 18:55:18,831 [trainer.py] => CNN: {'total': 92.02, '00-09': 90.68, '10-19': 91.47, '20-29': 96.91, '30-39': 93.64, '40-49': 95.33, '50-59': 84.68, '60-69': 85.85, '70-79': 94.33, '80-89': 94.74, 'old': 91.62, 'new': 94.74}
2024-09-04 18:55:18,831 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02]
2024-09-04 18:55:18,831 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14]

Average Accuracy (CNN): 95.23
2024-09-04 18:55:18,831 [trainer.py] => Average Accuracy (CNN): 95.23 

2024-09-04 18:55:18,832 [trainer.py] => All params: 85867777
2024-09-04 18:55:18,833 [trainer.py] => Trainable params: 85867777
2024-09-04 18:55:18,835 [simplecil.py] => Learning on 90-100
2024-09-04 18:55:25,463 [trainer.py] => No NME accuracy.
2024-09-04 18:55:25,463 [trainer.py] => CNN: {'total': 91.16, '00-09': 89.83, '10-19': 91.47, '20-29': 96.91, '30-39': 90.0, '40-49': 95.33, '50-59': 84.68, '60-69': 83.96, '70-79': 94.33, '80-89': 94.74, '90-99': 89.71, 'old': 91.35, 'new': 89.71}
2024-09-04 18:55:25,463 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16]
2024-09-04 18:55:25,464 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99]

Average Accuracy (CNN): 94.82
2024-09-04 18:55:25,464 [trainer.py] => Average Accuracy (CNN): 94.82 

2024-09-04 18:55:25,464 [trainer.py] => All params: 85875457
2024-09-04 18:55:25,465 [trainer.py] => Trainable params: 85875457
2024-09-04 18:55:25,467 [simplecil.py] => Learning on 100-110
2024-09-04 18:55:32,524 [trainer.py] => No NME accuracy.
2024-09-04 18:55:32,524 [trainer.py] => CNN: {'total': 90.94, '00-09': 89.83, '10-19': 89.15, '20-29': 96.91, '30-39': 89.09, '40-49': 95.33, '50-59': 84.68, '60-69': 83.02, '70-79': 94.33, '80-89': 94.74, '90-99': 89.71, '100-109': 93.04, 'old': 90.74, 'new': 93.04}
2024-09-04 18:55:32,524 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94]
2024-09-04 18:55:32,524 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0]

Average Accuracy (CNN): 94.47
2024-09-04 18:55:32,525 [trainer.py] => Average Accuracy (CNN): 94.47 

2024-09-04 18:55:32,526 [trainer.py] => All params: 85883137
2024-09-04 18:55:32,526 [trainer.py] => Trainable params: 85883137
2024-09-04 18:55:32,528 [simplecil.py] => Learning on 110-120
2024-09-04 18:55:39,637 [trainer.py] => No NME accuracy.
2024-09-04 18:55:39,638 [trainer.py] => CNN: {'total': 88.91, '00-09': 89.83, '10-19': 89.15, '20-29': 96.91, '30-39': 89.09, '40-49': 95.33, '50-59': 83.78, '60-69': 82.08, '70-79': 87.94, '80-89': 93.98, '90-99': 88.24, '100-109': 93.04, '110-119': 77.88, 'old': 89.87, 'new': 77.88}
2024-09-04 18:55:39,638 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91]
2024-09-04 18:55:39,638 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73]

Average Accuracy (CNN): 94.01
2024-09-04 18:55:39,638 [trainer.py] => Average Accuracy (CNN): 94.01 

2024-09-04 18:55:39,640 [trainer.py] => All params: 85890817
2024-09-04 18:55:39,641 [trainer.py] => Trainable params: 85890817
2024-09-04 18:55:39,644 [simplecil.py] => Learning on 120-130
2024-09-04 18:55:46,959 [trainer.py] => No NME accuracy.
2024-09-04 18:55:46,959 [trainer.py] => CNN: {'total': 87.85, '00-09': 86.44, '10-19': 89.15, '20-29': 96.91, '30-39': 88.18, '40-49': 92.52, '50-59': 83.78, '60-69': 81.13, '70-79': 87.23, '80-89': 93.98, '90-99': 88.24, '100-109': 92.17, '110-119': 77.88, '120-129': 84.11, 'old': 88.14, 'new': 84.11}
2024-09-04 18:55:46,959 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85]
2024-09-04 18:55:46,959 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75]

Average Accuracy (CNN): 93.53
2024-09-04 18:55:46,960 [trainer.py] => Average Accuracy (CNN): 93.53 

2024-09-04 18:55:46,960 [trainer.py] => All params: 85898497
2024-09-04 18:55:46,961 [trainer.py] => Trainable params: 85898497
2024-09-04 18:55:46,963 [simplecil.py] => Learning on 130-140
2024-09-04 18:55:54,713 [trainer.py] => No NME accuracy.
2024-09-04 18:55:54,713 [trainer.py] => CNN: {'total': 87.2, '00-09': 86.44, '10-19': 89.15, '20-29': 96.91, '30-39': 88.18, '40-49': 92.52, '50-59': 83.78, '60-69': 81.13, '70-79': 87.23, '80-89': 93.23, '90-99': 88.24, '100-109': 91.3, '110-119': 77.88, '120-129': 80.37, '130-139': 83.9, 'old': 87.46, 'new': 83.9}
2024-09-04 18:55:54,713 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85, 87.2]
2024-09-04 18:55:54,713 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75, 98.6]

Average Accuracy (CNN): 93.08
2024-09-04 18:55:54,713 [trainer.py] => Average Accuracy (CNN): 93.08 

2024-09-04 18:55:54,714 [trainer.py] => All params: 85906177
2024-09-04 18:55:54,715 [trainer.py] => Trainable params: 85906177
2024-09-04 18:55:54,718 [simplecil.py] => Learning on 140-150
2024-09-04 18:56:02,564 [trainer.py] => No NME accuracy.
2024-09-04 18:56:02,564 [trainer.py] => CNN: {'total': 86.3, '00-09': 84.75, '10-19': 89.15, '20-29': 95.88, '30-39': 86.36, '40-49': 89.72, '50-59': 83.78, '60-69': 81.13, '70-79': 87.23, '80-89': 93.23, '90-99': 86.03, '100-109': 91.3, '110-119': 76.99, '120-129': 80.37, '130-139': 83.9, '140-149': 84.13, 'old': 86.47, 'new': 84.13}
2024-09-04 18:56:02,564 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85, 87.2, 86.3]
2024-09-04 18:56:02,564 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75, 98.6, 98.47]

Average Accuracy (CNN): 92.63
2024-09-04 18:56:02,564 [trainer.py] => Average Accuracy (CNN): 92.63 

2024-09-04 18:56:02,565 [trainer.py] => All params: 85913857
2024-09-04 18:56:02,566 [trainer.py] => Trainable params: 85913857
2024-09-04 18:56:02,568 [simplecil.py] => Learning on 150-160
2024-09-04 18:56:11,138 [trainer.py] => No NME accuracy.
2024-09-04 18:56:11,138 [trainer.py] => CNN: {'total': 86.62, '00-09': 83.9, '10-19': 89.15, '20-29': 95.88, '30-39': 86.36, '40-49': 89.72, '50-59': 83.78, '60-69': 81.13, '70-79': 86.52, '80-89': 91.73, '90-99': 85.29, '100-109': 90.43, '110-119': 76.99, '120-129': 80.37, '130-139': 83.9, '140-149': 84.13, '150-159': 95.97, 'old': 85.96, 'new': 95.97}
2024-09-04 18:56:11,139 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62]
2024-09-04 18:56:11,139 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41]

Average Accuracy (CNN): 92.25
2024-09-04 18:56:11,139 [trainer.py] => Average Accuracy (CNN): 92.25 

2024-09-04 18:56:11,140 [trainer.py] => All params: 85921537
2024-09-04 18:56:11,141 [trainer.py] => Trainable params: 85921537
2024-09-04 18:56:11,144 [simplecil.py] => Learning on 160-170
2024-09-04 18:56:19,969 [trainer.py] => No NME accuracy.
2024-09-04 18:56:19,969 [trainer.py] => CNN: {'total': 86.12, '00-09': 83.9, '10-19': 89.15, '20-29': 94.85, '30-39': 86.36, '40-49': 88.79, '50-59': 83.78, '60-69': 81.13, '70-79': 86.52, '80-89': 91.73, '90-99': 82.35, '100-109': 90.43, '110-119': 76.11, '120-129': 80.37, '130-139': 83.9, '140-149': 82.54, '150-159': 95.97, '160-169': 85.82, 'old': 86.14, 'new': 85.82}
2024-09-04 18:56:19,969 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12]
2024-09-04 18:56:19,969 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22]

Average Accuracy (CNN): 91.89
2024-09-04 18:56:19,969 [trainer.py] => Average Accuracy (CNN): 91.89 

2024-09-04 18:56:19,970 [trainer.py] => All params: 85929217
2024-09-04 18:56:19,971 [trainer.py] => Trainable params: 85929217
2024-09-04 18:56:19,975 [simplecil.py] => Learning on 170-180
2024-09-04 18:56:29,289 [trainer.py] => No NME accuracy.
2024-09-04 18:56:29,290 [trainer.py] => CNN: {'total': 86.23, '00-09': 83.05, '10-19': 87.6, '20-29': 94.85, '30-39': 86.36, '40-49': 88.79, '50-59': 83.78, '60-69': 81.13, '70-79': 86.52, '80-89': 91.73, '90-99': 82.35, '100-109': 90.43, '110-119': 76.11, '120-129': 80.37, '130-139': 83.9, '140-149': 82.54, '150-159': 95.16, '160-169': 85.82, '170-179': 92.23, 'old': 85.93, 'new': 92.23}
2024-09-04 18:56:29,290 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12, 86.23]
2024-09-04 18:56:29,290 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22, 98.17]

Average Accuracy (CNN): 91.58
2024-09-04 18:56:29,290 [trainer.py] => Average Accuracy (CNN): 91.58 

2024-09-04 18:56:29,291 [trainer.py] => All params: 85936897
2024-09-04 18:56:29,291 [trainer.py] => Trainable params: 85936897
2024-09-04 18:56:29,294 [simplecil.py] => Learning on 180-190
2024-09-04 18:56:38,810 [trainer.py] => No NME accuracy.
2024-09-04 18:56:38,810 [trainer.py] => CNN: {'total': 85.75, '00-09': 83.05, '10-19': 87.6, '20-29': 92.78, '30-39': 85.45, '40-49': 86.92, '50-59': 83.78, '60-69': 81.13, '70-79': 86.52, '80-89': 91.73, '90-99': 81.62, '100-109': 90.43, '110-119': 76.11, '120-129': 79.44, '130-139': 83.9, '140-149': 82.54, '150-159': 95.16, '160-169': 85.82, '170-179': 92.23, '180-189': 83.33, 'old': 85.9, 'new': 83.33}
2024-09-04 18:56:38,811 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12, 86.23, 85.75]
2024-09-04 18:56:38,811 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22, 98.17, 97.79]

Average Accuracy (CNN): 91.27
2024-09-04 18:56:38,811 [trainer.py] => Average Accuracy (CNN): 91.27 

2024-09-04 18:56:38,811 [trainer.py] => All params: 85944577
2024-09-04 18:56:38,812 [trainer.py] => Trainable params: 85944577
2024-09-04 18:56:38,814 [simplecil.py] => Learning on 190-200
2024-09-04 18:56:48,670 [trainer.py] => No NME accuracy.
2024-09-04 18:56:48,670 [trainer.py] => CNN: {'total': 85.24, '00-09': 83.05, '10-19': 87.6, '20-29': 92.78, '30-39': 85.45, '40-49': 86.92, '50-59': 83.78, '60-69': 77.36, '70-79': 85.82, '80-89': 91.73, '90-99': 81.62, '100-109': 90.43, '110-119': 76.11, '120-129': 79.44, '130-139': 83.9, '140-149': 82.54, '150-159': 95.16, '160-169': 83.58, '170-179': 91.26, '180-189': 82.58, '190-199': 83.67, 'old': 85.31, 'new': 83.67}
2024-09-04 18:56:48,670 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.67, 96.92, 96.26, 93.6, 91.52, 91.95, 92.02, 91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12, 86.23, 85.75, 85.24]
2024-09-04 18:56:48,670 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.82, 99.55, 99.23, 99.02, 99.14, 98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22, 98.17, 97.79, 97.79]

Average Accuracy (CNN): 90.97
2024-09-04 18:56:48,670 [trainer.py] => Average Accuracy (CNN): 90.97 

Accuracy Matrix (CNN):
[[99.15 99.15 98.31 98.31 97.46 91.53 90.68 90.68 90.68 89.83 89.83 89.83
  86.44 86.44 84.75 83.9  83.9  83.05 83.05 83.05]
 [ 0.   96.9  96.9  96.12 95.35 95.35 93.02 93.02 91.47 91.47 89.15 89.15
  89.15 89.15 89.15 89.15 89.15 87.6  87.6  87.6 ]
 [ 0.    0.   97.94 96.91 96.91 96.91 96.91 96.91 96.91 96.91 96.91 96.91
  96.91 96.91 95.88 95.88 94.85 94.85 92.78 92.78]
 [ 0.    0.    0.   96.36 95.45 95.45 94.55 93.64 93.64 90.   89.09 89.09
  88.18 88.18 86.36 86.36 86.36 86.36 85.45 85.45]
 [ 0.    0.    0.    0.   96.26 96.26 95.33 95.33 95.33 95.33 95.33 95.33
  92.52 92.52 89.72 89.72 88.79 88.79 86.92 86.92]
 [ 0.    0.    0.    0.    0.   86.49 84.68 84.68 84.68 84.68 84.68 83.78
  83.78 83.78 83.78 83.78 83.78 83.78 83.78 83.78]
 [ 0.    0.    0.    0.    0.    0.   85.85 85.85 85.85 83.96 83.02 82.08
  81.13 81.13 81.13 81.13 81.13 81.13 81.13 77.36]
 [ 0.    0.    0.    0.    0.    0.    0.   95.04 94.33 94.33 94.33 87.94
  87.23 87.23 87.23 86.52 86.52 86.52 86.52 85.82]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   94.74 94.74 94.74 93.98
  93.98 93.23 93.23 91.73 91.73 91.73 91.73 91.73]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   89.71 89.71 88.24
  88.24 88.24 86.03 85.29 82.35 82.35 81.62 81.62]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   93.04 93.04
  92.17 91.3  91.3  90.43 90.43 90.43 90.43 90.43]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   77.88
  77.88 77.88 76.99 76.99 76.11 76.11 76.11 76.11]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  84.11 80.37 80.37 80.37 80.37 80.37 79.44 79.44]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   83.9  83.9  83.9  83.9  83.9  83.9  83.9 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   84.13 84.13 82.54 82.54 82.54 82.54]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   95.97 95.97 95.16 95.16 95.16]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   85.82 85.82 85.82 83.58]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   92.23 92.23 91.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   83.33 82.58]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   83.67]]
2024-09-04 18:56:48,672 [trainer.py] => Forgetting (CNN): 5.1442105263157885
2024-09-04 18:56:51,811 [trainer.py] => config: ./exps/simplecil_cub_B100_Inc5.json
2024-09-04 18:56:51,829 [trainer.py] => prefix:  
2024-09-04 18:56:51,829 [trainer.py] => dataset: cub
2024-09-04 18:56:51,829 [trainer.py] => memory_size: 0
2024-09-04 18:56:51,829 [trainer.py] => memory_per_class: 0
2024-09-04 18:56:51,829 [trainer.py] => fixed_memory: False
2024-09-04 18:56:51,829 [trainer.py] => shuffle: True
2024-09-04 18:56:51,829 [trainer.py] => init_cls: 100
2024-09-04 18:56:51,829 [trainer.py] => increment: 20
2024-09-04 18:56:51,829 [trainer.py] => model_name: simplecil
2024-09-04 18:56:51,829 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-04 18:56:51,829 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 18:56:51,830 [trainer.py] => seed: 1993
2024-09-04 18:56:51,830 [trainer.py] => tuned_epoch: 0
2024-09-04 18:56:51,830 [trainer.py] => init_lr: 0.01
2024-09-04 18:56:51,830 [trainer.py] => batch_size: 256
2024-09-04 18:56:51,830 [trainer.py] => weight_decay: 0.05
2024-09-04 18:56:51,830 [trainer.py] => min_lr: 1e-08
2024-09-04 18:56:51,830 [trainer.py] => optimizer: sgd
2024-09-04 18:56:51,830 [trainer.py] => vpt_type: shallow
2024-09-04 18:56:51,830 [trainer.py] => prompt_token_num: 3
2024-09-04 18:56:51,873 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 18:56:54,504 [trainer.py] => All params: 85798656
2024-09-04 18:56:54,505 [trainer.py] => Trainable params: 85798656
2024-09-04 18:56:54,947 [simplecil.py] => Learning on 0-100
2024-09-04 18:57:13,425 [trainer.py] => No NME accuracy.
2024-09-04 18:57:13,425 [trainer.py] => CNN: {'total': 91.16, '00-99': 91.16, 'old': 0, 'new': 91.16}
2024-09-04 18:57:13,425 [trainer.py] => CNN top1 curve: [91.16]
2024-09-04 18:57:13,425 [trainer.py] => CNN top5 curve: [98.99]

Average Accuracy (CNN): 91.16
2024-09-04 18:57:13,425 [trainer.py] => Average Accuracy (CNN): 91.16 

2024-09-04 18:57:13,427 [trainer.py] => All params: 85875457
2024-09-04 18:57:13,428 [trainer.py] => Trainable params: 85875457
2024-09-04 18:57:13,431 [simplecil.py] => Learning on 100-120
2024-09-04 18:57:21,802 [trainer.py] => No NME accuracy.
2024-09-04 18:57:21,803 [trainer.py] => CNN: {'total': 88.91, '00-99': 89.56, '100-119': 85.53, 'old': 89.56, 'new': 85.53}
2024-09-04 18:57:21,803 [trainer.py] => CNN top1 curve: [91.16, 88.91]
2024-09-04 18:57:21,803 [trainer.py] => CNN top5 curve: [98.99, 98.73]

Average Accuracy (CNN): 90.04
2024-09-04 18:57:21,803 [trainer.py] => Average Accuracy (CNN): 90.04 

2024-09-04 18:57:21,805 [trainer.py] => All params: 85890817
2024-09-04 18:57:21,806 [trainer.py] => Trainable params: 85890817
2024-09-04 18:57:21,809 [simplecil.py] => Learning on 120-140
2024-09-04 18:57:30,815 [trainer.py] => No NME accuracy.
2024-09-04 18:57:30,815 [trainer.py] => CNN: {'total': 87.2, '00-99': 88.64, '100-119': 84.65, '120-139': 82.22, 'old': 87.99, 'new': 82.22}
2024-09-04 18:57:30,815 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2]
2024-09-04 18:57:30,815 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6]

Average Accuracy (CNN): 89.09
2024-09-04 18:57:30,815 [trainer.py] => Average Accuracy (CNN): 89.09 

2024-09-04 18:57:30,816 [trainer.py] => All params: 85906177
2024-09-04 18:57:30,817 [trainer.py] => Trainable params: 85906177
2024-09-04 18:57:30,819 [simplecil.py] => Learning on 140-160
2024-09-04 18:57:40,777 [trainer.py] => No NME accuracy.
2024-09-04 18:57:40,777 [trainer.py] => CNN: {'total': 86.62, '00-99': 87.29, '100-119': 83.77, '120-139': 82.22, '140-159': 90.0, 'old': 86.11, 'new': 90.0}
2024-09-04 18:57:40,777 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2, 86.62]
2024-09-04 18:57:40,777 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6, 98.41]

Average Accuracy (CNN): 88.47
2024-09-04 18:57:40,778 [trainer.py] => Average Accuracy (CNN): 88.47 

2024-09-04 18:57:40,778 [trainer.py] => All params: 85921537
2024-09-04 18:57:40,779 [trainer.py] => Trainable params: 85921537
2024-09-04 18:57:40,781 [simplecil.py] => Learning on 160-180
2024-09-04 18:57:51,220 [trainer.py] => No NME accuracy.
2024-09-04 18:57:51,220 [trainer.py] => CNN: {'total': 86.23, '00-99': 86.53, '100-119': 83.33, '120-139': 82.22, '140-159': 88.8, '160-179': 88.61, 'old': 85.93, 'new': 88.61}
2024-09-04 18:57:51,220 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2, 86.62, 86.23]
2024-09-04 18:57:51,220 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6, 98.41, 98.17]

Average Accuracy (CNN): 88.02
2024-09-04 18:57:51,221 [trainer.py] => Average Accuracy (CNN): 88.02 

2024-09-04 18:57:51,222 [trainer.py] => All params: 85936897
2024-09-04 18:57:51,223 [trainer.py] => Trainable params: 85936897
2024-09-04 18:57:51,226 [simplecil.py] => Learning on 180-200
2024-09-04 18:58:02,734 [trainer.py] => No NME accuracy.
2024-09-04 18:58:02,734 [trainer.py] => CNN: {'total': 85.24, '00-99': 85.61, '100-119': 83.33, '120-139': 81.78, '140-159': 88.8, '160-179': 86.92, '180-199': 83.04, 'old': 85.48, 'new': 83.04}
2024-09-04 18:58:02,734 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2, 86.62, 86.23, 85.24]
2024-09-04 18:58:02,734 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6, 98.41, 98.17, 97.79]

Average Accuracy (CNN): 87.56
2024-09-04 18:58:02,735 [trainer.py] => Average Accuracy (CNN): 87.56 

Accuracy Matrix (CNN):
[[91.16 89.56 88.64 87.29 86.53 85.61]
 [ 0.   85.53 84.65 83.77 83.33 83.33]
 [ 0.    0.   82.22 82.22 82.22 81.78]
 [ 0.    0.    0.   90.   88.8  88.8 ]
 [ 0.    0.    0.    0.   88.61 86.92]
 [ 0.    0.    0.    0.    0.   83.04]]
2024-09-04 18:58:02,736 [trainer.py] => Forgetting (CNN): 2.2159999999999997
2024-09-04 18:58:05,933 [trainer.py] => config: ./exps/simplecil_cub_B100_Inc10.json
2024-09-04 18:58:05,933 [trainer.py] => prefix:  
2024-09-04 18:58:05,933 [trainer.py] => dataset: cub
2024-09-04 18:58:05,933 [trainer.py] => memory_size: 0
2024-09-04 18:58:05,933 [trainer.py] => memory_per_class: 0
2024-09-04 18:58:05,933 [trainer.py] => fixed_memory: False
2024-09-04 18:58:05,933 [trainer.py] => shuffle: True
2024-09-04 18:58:05,933 [trainer.py] => init_cls: 100
2024-09-04 18:58:05,933 [trainer.py] => increment: 10
2024-09-04 18:58:05,933 [trainer.py] => model_name: simplecil
2024-09-04 18:58:05,933 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-09-04 18:58:05,933 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 18:58:05,933 [trainer.py] => seed: 1993
2024-09-04 18:58:05,933 [trainer.py] => tuned_epoch: 0
2024-09-04 18:58:05,933 [trainer.py] => init_lr: 0.01
2024-09-04 18:58:05,933 [trainer.py] => batch_size: 256
2024-09-04 18:58:05,933 [trainer.py] => weight_decay: 0.05
2024-09-04 18:58:05,933 [trainer.py] => min_lr: 1e-08
2024-09-04 18:58:05,933 [trainer.py] => optimizer: sgd
2024-09-04 18:58:05,933 [trainer.py] => vpt_type: shallow
2024-09-04 18:58:05,933 [trainer.py] => prompt_token_num: 3
2024-09-04 18:58:05,973 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-04 18:58:08,291 [trainer.py] => All params: 85798656
2024-09-04 18:58:08,292 [trainer.py] => Trainable params: 85798656
2024-09-04 18:58:08,726 [simplecil.py] => Learning on 0-100
2024-09-04 18:58:27,353 [trainer.py] => No NME accuracy.
2024-09-04 18:58:27,354 [trainer.py] => CNN: {'total': 91.16, '00-99': 91.16, 'old': 0, 'new': 91.16}
2024-09-04 18:58:27,354 [trainer.py] => CNN top1 curve: [91.16]
2024-09-04 18:58:27,354 [trainer.py] => CNN top5 curve: [98.99]

Average Accuracy (CNN): 91.16
2024-09-04 18:58:27,354 [trainer.py] => Average Accuracy (CNN): 91.16 

2024-09-04 18:58:27,355 [trainer.py] => All params: 85875457
2024-09-04 18:58:27,356 [trainer.py] => Trainable params: 85875457
2024-09-04 18:58:27,359 [simplecil.py] => Learning on 100-110
2024-09-04 18:58:34,227 [trainer.py] => No NME accuracy.
2024-09-04 18:58:34,228 [trainer.py] => CNN: {'total': 90.94, '00-99': 90.74, '100-109': 93.04, 'old': 90.74, 'new': 93.04}
2024-09-04 18:58:34,228 [trainer.py] => CNN top1 curve: [91.16, 90.94]
2024-09-04 18:58:34,228 [trainer.py] => CNN top5 curve: [98.99, 99.0]

Average Accuracy (CNN): 91.05
2024-09-04 18:58:34,228 [trainer.py] => Average Accuracy (CNN): 91.05 

2024-09-04 18:58:34,230 [trainer.py] => All params: 85883137
2024-09-04 18:58:34,231 [trainer.py] => Trainable params: 85883137
2024-09-04 18:58:34,234 [simplecil.py] => Learning on 110-120
2024-09-04 18:58:41,465 [trainer.py] => No NME accuracy.
2024-09-04 18:58:41,465 [trainer.py] => CNN: {'total': 88.91, '00-99': 89.56, '100-109': 93.04, '110-119': 77.88, 'old': 89.87, 'new': 77.88}
2024-09-04 18:58:41,465 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91]
2024-09-04 18:58:41,465 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73]

Average Accuracy (CNN): 90.34
2024-09-04 18:58:41,466 [trainer.py] => Average Accuracy (CNN): 90.34 

2024-09-04 18:58:41,467 [trainer.py] => All params: 85890817
2024-09-04 18:58:41,469 [trainer.py] => Trainable params: 85890817
2024-09-04 18:58:41,472 [simplecil.py] => Learning on 120-130
2024-09-04 18:58:48,872 [trainer.py] => No NME accuracy.
2024-09-04 18:58:48,873 [trainer.py] => CNN: {'total': 87.85, '00-99': 88.72, '100-109': 92.17, '110-119': 77.88, '120-129': 84.11, 'old': 88.14, 'new': 84.11}
2024-09-04 18:58:48,873 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85]
2024-09-04 18:58:48,873 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75]

Average Accuracy (CNN): 89.72
2024-09-04 18:58:48,873 [trainer.py] => Average Accuracy (CNN): 89.72 

2024-09-04 18:58:48,874 [trainer.py] => All params: 85898497
2024-09-04 18:58:48,874 [trainer.py] => Trainable params: 85898497
2024-09-04 18:58:48,876 [simplecil.py] => Learning on 130-140
2024-09-04 18:58:56,451 [trainer.py] => No NME accuracy.
2024-09-04 18:58:56,451 [trainer.py] => CNN: {'total': 87.2, '00-99': 88.64, '100-109': 91.3, '110-119': 77.88, '120-129': 80.37, '130-139': 83.9, 'old': 87.46, 'new': 83.9}
2024-09-04 18:58:56,452 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85, 87.2]
2024-09-04 18:58:56,452 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75, 98.6]

Average Accuracy (CNN): 89.21
2024-09-04 18:58:56,452 [trainer.py] => Average Accuracy (CNN): 89.21 

2024-09-04 18:58:56,453 [trainer.py] => All params: 85906177
2024-09-04 18:58:56,454 [trainer.py] => Trainable params: 85906177
2024-09-04 18:58:56,457 [simplecil.py] => Learning on 140-150
2024-09-04 18:59:04,686 [trainer.py] => No NME accuracy.
2024-09-04 18:59:04,687 [trainer.py] => CNN: {'total': 86.3, '00-99': 87.71, '100-109': 91.3, '110-119': 76.99, '120-129': 80.37, '130-139': 83.9, '140-149': 84.13, 'old': 86.47, 'new': 84.13}
2024-09-04 18:59:04,687 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85, 87.2, 86.3]
2024-09-04 18:59:04,687 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75, 98.6, 98.47]

Average Accuracy (CNN): 88.73
2024-09-04 18:59:04,687 [trainer.py] => Average Accuracy (CNN): 88.73 

2024-09-04 18:59:04,688 [trainer.py] => All params: 85913857
2024-09-04 18:59:04,689 [trainer.py] => Trainable params: 85913857
2024-09-04 18:59:04,691 [simplecil.py] => Learning on 150-160
2024-09-04 18:59:13,250 [trainer.py] => No NME accuracy.
2024-09-04 18:59:13,250 [trainer.py] => CNN: {'total': 86.62, '00-99': 87.29, '100-109': 90.43, '110-119': 76.99, '120-129': 80.37, '130-139': 83.9, '140-149': 84.13, '150-159': 95.97, 'old': 85.96, 'new': 95.97}
2024-09-04 18:59:13,250 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62]
2024-09-04 18:59:13,250 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41]

Average Accuracy (CNN): 88.43
2024-09-04 18:59:13,250 [trainer.py] => Average Accuracy (CNN): 88.43 

2024-09-04 18:59:13,251 [trainer.py] => All params: 85921537
2024-09-04 18:59:13,252 [trainer.py] => Trainable params: 85921537
2024-09-04 18:59:13,254 [simplecil.py] => Learning on 160-170
2024-09-04 18:59:22,194 [trainer.py] => No NME accuracy.
2024-09-04 18:59:22,194 [trainer.py] => CNN: {'total': 86.12, '00-99': 86.78, '100-109': 90.43, '110-119': 76.11, '120-129': 80.37, '130-139': 83.9, '140-149': 82.54, '150-159': 95.97, '160-169': 85.82, 'old': 86.14, 'new': 85.82}
2024-09-04 18:59:22,194 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12]
2024-09-04 18:59:22,194 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22]

Average Accuracy (CNN): 88.14
2024-09-04 18:59:22,195 [trainer.py] => Average Accuracy (CNN): 88.14 

2024-09-04 18:59:22,195 [trainer.py] => All params: 85929217
2024-09-04 18:59:22,196 [trainer.py] => Trainable params: 85929217
2024-09-04 18:59:22,199 [simplecil.py] => Learning on 170-180
2024-09-04 18:59:31,375 [trainer.py] => No NME accuracy.
2024-09-04 18:59:31,375 [trainer.py] => CNN: {'total': 86.23, '00-99': 86.53, '100-109': 90.43, '110-119': 76.11, '120-129': 80.37, '130-139': 83.9, '140-149': 82.54, '150-159': 95.16, '160-169': 85.82, '170-179': 92.23, 'old': 85.93, 'new': 92.23}
2024-09-04 18:59:31,375 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12, 86.23]
2024-09-04 18:59:31,376 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22, 98.17]

Average Accuracy (CNN): 87.93
2024-09-04 18:59:31,376 [trainer.py] => Average Accuracy (CNN): 87.93 

2024-09-04 18:59:31,376 [trainer.py] => All params: 85936897
2024-09-04 18:59:31,377 [trainer.py] => Trainable params: 85936897
2024-09-04 18:59:31,379 [simplecil.py] => Learning on 180-190
2024-09-04 18:59:40,742 [trainer.py] => No NME accuracy.
2024-09-04 18:59:40,742 [trainer.py] => CNN: {'total': 85.75, '00-99': 86.03, '100-109': 90.43, '110-119': 76.11, '120-129': 79.44, '130-139': 83.9, '140-149': 82.54, '150-159': 95.16, '160-169': 85.82, '170-179': 92.23, '180-189': 83.33, 'old': 85.9, 'new': 83.33}
2024-09-04 18:59:40,742 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12, 86.23, 85.75]
2024-09-04 18:59:40,742 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22, 98.17, 97.79]

Average Accuracy (CNN): 87.71
2024-09-04 18:59:40,742 [trainer.py] => Average Accuracy (CNN): 87.71 

2024-09-04 18:59:40,743 [trainer.py] => All params: 85944577
2024-09-04 18:59:40,744 [trainer.py] => Trainable params: 85944577
2024-09-04 18:59:40,748 [simplecil.py] => Learning on 190-200
2024-09-04 18:59:50,791 [trainer.py] => No NME accuracy.
2024-09-04 18:59:50,792 [trainer.py] => CNN: {'total': 85.24, '00-99': 85.61, '100-109': 90.43, '110-119': 76.11, '120-129': 79.44, '130-139': 83.9, '140-149': 82.54, '150-159': 95.16, '160-169': 83.58, '170-179': 91.26, '180-189': 82.58, '190-199': 83.67, 'old': 85.31, 'new': 83.67}
2024-09-04 18:59:50,792 [trainer.py] => CNN top1 curve: [91.16, 90.94, 88.91, 87.85, 87.2, 86.3, 86.62, 86.12, 86.23, 85.75, 85.24]
2024-09-04 18:59:50,792 [trainer.py] => CNN top5 curve: [98.99, 99.0, 98.73, 98.75, 98.6, 98.47, 98.41, 98.22, 98.17, 97.79, 97.79]

Average Accuracy (CNN): 87.48
2024-09-04 18:59:50,792 [trainer.py] => Average Accuracy (CNN): 87.48 

Accuracy Matrix (CNN):
[[91.16 90.74 89.56 88.72 88.64 87.71 87.29 86.78 86.53 86.03 85.61]
 [ 0.   93.04 93.04 92.17 91.3  91.3  90.43 90.43 90.43 90.43 90.43]
 [ 0.    0.   77.88 77.88 77.88 76.99 76.99 76.11 76.11 76.11 76.11]
 [ 0.    0.    0.   84.11 80.37 80.37 80.37 80.37 80.37 79.44 79.44]
 [ 0.    0.    0.    0.   83.9  83.9  83.9  83.9  83.9  83.9  83.9 ]
 [ 0.    0.    0.    0.    0.   84.13 84.13 82.54 82.54 82.54 82.54]
 [ 0.    0.    0.    0.    0.    0.   95.97 95.97 95.16 95.16 95.16]
 [ 0.    0.    0.    0.    0.    0.    0.   85.82 85.82 85.82 83.58]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   92.23 92.23 91.26]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   83.33 82.58]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   83.67]]
2024-09-04 18:59:50,794 [trainer.py] => Forgetting (CNN): 2.095999999999998
nohup: 忽略输入
2024-09-11 20:24:15,594 [trainer.py] => config: ./exps/icarl_cub_B0_Inc5.json
2024-09-11 20:24:15,607 [trainer.py] => prefix: reproduce
2024-09-11 20:24:15,607 [trainer.py] => dataset: cub
2024-09-11 20:24:15,607 [trainer.py] => memory_size: 4000
2024-09-11 20:24:15,607 [trainer.py] => memory_per_class: 20
2024-09-11 20:24:15,607 [trainer.py] => fixed_memory: True
2024-09-11 20:24:15,607 [trainer.py] => shuffle: True
2024-09-11 20:24:15,607 [trainer.py] => init_cls: 40
2024-09-11 20:24:15,607 [trainer.py] => increment: 40
2024-09-11 20:24:15,607 [trainer.py] => model_name: icarl
2024-09-11 20:24:15,607 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-11 20:24:15,607 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-11 20:24:15,607 [trainer.py] => seed: 1993
2024-09-11 20:24:15,607 [trainer.py] => init_epoch: 20
2024-09-11 20:24:15,607 [trainer.py] => init_lr: 0.001
2024-09-11 20:24:15,608 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-11 20:24:15,608 [trainer.py] => init_lr_decay: 0.1
2024-09-11 20:24:15,608 [trainer.py] => init_weight_decay: 0.0005
2024-09-11 20:24:15,608 [trainer.py] => epochs: 20
2024-09-11 20:24:15,608 [trainer.py] => lrate: 0.001
2024-09-11 20:24:15,608 [trainer.py] => milestones: [80, 120]
2024-09-11 20:24:15,608 [trainer.py] => lrate_decay: 0.1
2024-09-11 20:24:15,608 [trainer.py] => batch_size: 48
2024-09-11 20:24:15,608 [trainer.py] => weight_decay: 0.0002
2024-09-11 20:24:15,608 [trainer.py] => T: 2
2024-09-11 20:24:16,309 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-11 20:24:25,490 [trainer.py] => All params: 85798656
2024-09-11 20:24:25,491 [trainer.py] => Trainable params: 85798656
2024-09-11 20:24:25,492 [icarl.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.270, Train_accy 41.72, Test_accy 85.02:   0%|          | 0/20 [00:20<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.270, Train_accy 41.72, Test_accy 85.02:   5%|▌         | 1/20 [00:20<06:26, 20.33s/it]
Task 0, Epoch 2/20 => Loss 0.628, Train_accy 82.23:   5%|▌         | 1/20 [00:35<06:26, 20.33s/it]                 
Task 0, Epoch 2/20 => Loss 0.628, Train_accy 82.23:  10%|█         | 2/20 [00:35<05:14, 17.46s/it]
Task 0, Epoch 3/20 => Loss 0.490, Train_accy 86.04:  10%|█         | 2/20 [00:51<05:14, 17.46s/it]
Task 0, Epoch 3/20 => Loss 0.490, Train_accy 86.04:  15%|█▌        | 3/20 [00:51<04:41, 16.57s/it]
Task 0, Epoch 4/20 => Loss 0.400, Train_accy 88.15:  15%|█▌        | 3/20 [01:06<04:41, 16.57s/it]
Task 0, Epoch 4/20 => Loss 0.400, Train_accy 88.15:  20%|██        | 4/20 [01:06<04:18, 16.13s/it]
Task 0, Epoch 5/20 => Loss 0.392, Train_accy 88.42:  20%|██        | 4/20 [01:22<04:18, 16.13s/it]
Task 0, Epoch 5/20 => Loss 0.392, Train_accy 88.42:  25%|██▌       | 5/20 [01:22<03:58, 15.88s/it]
Task 0, Epoch 6/20 => Loss 0.326, Train_accy 91.12, Test_accy 96.04:  25%|██▌       | 5/20 [01:39<03:58, 15.88s/it]
Task 0, Epoch 6/20 => Loss 0.326, Train_accy 91.12, Test_accy 96.04:  30%|███       | 6/20 [01:39<03:49, 16.42s/it]
Task 0, Epoch 7/20 => Loss 0.263, Train_accy 92.54:  30%|███       | 6/20 [01:55<03:49, 16.42s/it]                 
Task 0, Epoch 7/20 => Loss 0.263, Train_accy 92.54:  35%|███▌      | 7/20 [01:55<03:29, 16.11s/it]
Task 0, Epoch 8/20 => Loss 0.265, Train_accy 92.70:  35%|███▌      | 7/20 [02:10<03:29, 16.11s/it]
Task 0, Epoch 8/20 => Loss 0.265, Train_accy 92.70:  40%|████      | 8/20 [02:10<03:11, 15.93s/it]
Task 0, Epoch 9/20 => Loss 0.252, Train_accy 92.49:  40%|████      | 8/20 [02:26<03:11, 15.93s/it]
Task 0, Epoch 9/20 => Loss 0.252, Train_accy 92.49:  45%|████▌     | 9/20 [02:26<02:53, 15.81s/it]
Task 0, Epoch 10/20 => Loss 0.279, Train_accy 91.59:  45%|████▌     | 9/20 [02:41<02:53, 15.81s/it]
Task 0, Epoch 10/20 => Loss 0.279, Train_accy 91.59:  50%|█████     | 10/20 [02:41<02:37, 15.71s/it]
Task 0, Epoch 11/20 => Loss 0.239, Train_accy 93.18, Test_accy 95.37:  50%|█████     | 10/20 [02:59<02:37, 15.71s/it]
Task 0, Epoch 11/20 => Loss 0.239, Train_accy 93.18, Test_accy 95.37:  55%|█████▌    | 11/20 [02:59<02:26, 16.32s/it]
Task 0, Epoch 12/20 => Loss 0.265, Train_accy 92.28:  55%|█████▌    | 11/20 [03:14<02:26, 16.32s/it]                 
Task 0, Epoch 12/20 => Loss 0.265, Train_accy 92.28:  60%|██████    | 12/20 [03:14<02:08, 16.08s/it]
Task 0, Epoch 13/20 => Loss 0.282, Train_accy 91.91:  60%|██████    | 12/20 [03:30<02:08, 16.08s/it]
Task 0, Epoch 13/20 => Loss 0.282, Train_accy 91.91:  65%|██████▌   | 13/20 [03:30<01:51, 15.91s/it]
Task 0, Epoch 14/20 => Loss 0.267, Train_accy 91.86:  65%|██████▌   | 13/20 [03:46<01:51, 15.91s/it]
Task 0, Epoch 14/20 => Loss 0.267, Train_accy 91.86:  70%|███████   | 14/20 [03:46<01:34, 15.81s/it]
Task 0, Epoch 15/20 => Loss 0.232, Train_accy 93.65:  70%|███████   | 14/20 [04:01<01:34, 15.81s/it]
Task 0, Epoch 15/20 => Loss 0.232, Train_accy 93.65:  75%|███████▌  | 15/20 [04:01<01:18, 15.73s/it]
Task 0, Epoch 16/20 => Loss 0.220, Train_accy 93.76, Test_accy 96.04:  75%|███████▌  | 15/20 [04:19<01:18, 15.73s/it]
Task 0, Epoch 16/20 => Loss 0.220, Train_accy 93.76, Test_accy 96.04:  80%|████████  | 16/20 [04:19<01:05, 16.32s/it]
Task 0, Epoch 17/20 => Loss 0.200, Train_accy 94.08:  80%|████████  | 16/20 [04:34<01:05, 16.32s/it]                 
Task 0, Epoch 17/20 => Loss 0.200, Train_accy 94.08:  85%|████████▌ | 17/20 [04:34<00:48, 16.07s/it]
Task 0, Epoch 18/20 => Loss 0.242, Train_accy 93.65:  85%|████████▌ | 17/20 [04:50<00:48, 16.07s/it]
Task 0, Epoch 18/20 => Loss 0.242, Train_accy 93.65:  90%|█████████ | 18/20 [04:50<00:31, 15.85s/it]
Task 0, Epoch 19/20 => Loss 0.189, Train_accy 94.71:  90%|█████████ | 18/20 [05:05<00:31, 15.85s/it]
Task 0, Epoch 19/20 => Loss 0.189, Train_accy 94.71:  95%|█████████▌| 19/20 [05:05<00:15, 15.73s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39:  95%|█████████▌| 19/20 [05:21<00:15, 15.73s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39: 100%|██████████| 20/20 [05:21<00:00, 15.68s/it]
Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39: 100%|██████████| 20/20 [05:21<00:00, 16.05s/it]
2024-09-11 20:29:47,142 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.188, Train_accy 94.39
2024-09-11 20:29:47,148 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 20:30:31,069 [icarl.py] => Exemplar size: 800
2024-09-11 20:30:31,069 [trainer.py] => CNN: {'total': 94.71, '00-39': 94.71, 'old': 0, 'new': 94.71}
2024-09-11 20:30:31,069 [trainer.py] => NME: {'total': 95.59, '00-39': 95.59, 'old': 0, 'new': 95.59}
2024-09-11 20:30:31,069 [trainer.py] => CNN top1 curve: [94.71]
2024-09-11 20:30:31,069 [trainer.py] => CNN top5 curve: [99.56]
2024-09-11 20:30:31,069 [trainer.py] => NME top1 curve: [95.59]
2024-09-11 20:30:31,069 [trainer.py] => NME top5 curve: [99.78]

Average Accuracy (CNN): 94.71
Average Accuracy (NME): 95.59
2024-09-11 20:30:31,069 [trainer.py] => Average Accuracy (CNN): 94.71
2024-09-11 20:30:31,069 [trainer.py] => Average Accuracy (NME): 95.59
2024-09-11 20:30:31,070 [trainer.py] => All params: 85829416
2024-09-11 20:30:31,070 [trainer.py] => Trainable params: 85829416
2024-09-11 20:30:31,072 [icarl.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.709, Train_accy 55.71, Test_accy 82.59:   0%|          | 0/20 [00:33<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.709, Train_accy 55.71, Test_accy 82.59:   5%|▌         | 1/20 [00:33<10:27, 33.00s/it]
Task 1, Epoch 2/20 => Loss 2.070, Train_accy 82.52:   5%|▌         | 1/20 [01:02<10:27, 33.00s/it]                 
Task 1, Epoch 2/20 => Loss 2.070, Train_accy 82.52:  10%|█         | 2/20 [01:02<09:12, 30.68s/it]
Task 1, Epoch 3/20 => Loss 1.972, Train_accy 86.05:  10%|█         | 2/20 [01:31<09:12, 30.68s/it]
Task 1, Epoch 3/20 => Loss 1.972, Train_accy 86.05:  15%|█▌        | 3/20 [01:31<08:30, 30.02s/it]
Task 1, Epoch 4/20 => Loss 1.907, Train_accy 86.65:  15%|█▌        | 3/20 [02:00<08:30, 30.02s/it]
Task 1, Epoch 4/20 => Loss 1.907, Train_accy 86.65:  20%|██        | 4/20 [02:00<07:55, 29.70s/it]
Task 1, Epoch 5/20 => Loss 1.790, Train_accy 89.44:  20%|██        | 4/20 [02:29<07:55, 29.70s/it]
Task 1, Epoch 5/20 => Loss 1.790, Train_accy 89.44:  25%|██▌       | 5/20 [02:29<07:23, 29.53s/it]
Task 1, Epoch 6/20 => Loss 1.758, Train_accy 90.63, Test_accy 87.60:  25%|██▌       | 5/20 [03:02<07:23, 29.53s/it]
Task 1, Epoch 6/20 => Loss 1.758, Train_accy 90.63, Test_accy 87.60:  30%|███       | 6/20 [03:02<07:07, 30.53s/it]
Task 1, Epoch 7/20 => Loss 1.787, Train_accy 90.41:  30%|███       | 6/20 [03:31<07:07, 30.53s/it]                 
Task 1, Epoch 7/20 => Loss 1.787, Train_accy 90.41:  35%|███▌      | 7/20 [03:31<06:31, 30.10s/it]
Task 1, Epoch 8/20 => Loss 1.734, Train_accy 90.96:  35%|███▌      | 7/20 [04:00<06:31, 30.10s/it]
Task 1, Epoch 8/20 => Loss 1.734, Train_accy 90.96:  40%|████      | 8/20 [04:00<05:57, 29.77s/it]
Task 1, Epoch 9/20 => Loss 1.907, Train_accy 89.40:  40%|████      | 8/20 [04:29<05:57, 29.77s/it]
Task 1, Epoch 9/20 => Loss 1.907, Train_accy 89.40:  45%|████▌     | 9/20 [04:29<05:25, 29.60s/it]
Task 1, Epoch 10/20 => Loss 2.403, Train_accy 80.10:  45%|████▌     | 9/20 [04:58<05:25, 29.60s/it]
Task 1, Epoch 10/20 => Loss 2.403, Train_accy 80.10:  50%|█████     | 10/20 [04:58<04:54, 29.44s/it]
Task 1, Epoch 11/20 => Loss 1.955, Train_accy 87.84, Test_accy 87.05:  50%|█████     | 10/20 [05:31<04:54, 29.44s/it]
Task 1, Epoch 11/20 => Loss 1.955, Train_accy 87.84, Test_accy 87.05:  55%|█████▌    | 11/20 [05:31<04:33, 30.36s/it]
Task 1, Epoch 12/20 => Loss 1.795, Train_accy 90.52:  55%|█████▌    | 11/20 [06:00<04:33, 30.36s/it]                 
Task 1, Epoch 12/20 => Loss 1.795, Train_accy 90.52:  60%|██████    | 12/20 [06:00<04:00, 30.00s/it]
Task 1, Epoch 13/20 => Loss 1.770, Train_accy 91.60:  60%|██████    | 12/20 [06:29<04:00, 30.00s/it]
Task 1, Epoch 13/20 => Loss 1.770, Train_accy 91.60:  65%|██████▌   | 13/20 [06:29<03:28, 29.72s/it]
Task 1, Epoch 14/20 => Loss 1.706, Train_accy 91.89:  65%|██████▌   | 13/20 [06:58<03:28, 29.72s/it]
Task 1, Epoch 14/20 => Loss 1.706, Train_accy 91.89:  70%|███████   | 14/20 [06:58<02:57, 29.57s/it]
Task 1, Epoch 15/20 => Loss 1.691, Train_accy 92.86:  70%|███████   | 14/20 [07:28<02:57, 29.57s/it]
Task 1, Epoch 15/20 => Loss 1.691, Train_accy 92.86:  75%|███████▌  | 15/20 [07:28<02:27, 29.59s/it]
Task 1, Epoch 16/20 => Loss 1.730, Train_accy 91.78, Test_accy 89.55:  75%|███████▌  | 15/20 [08:00<02:27, 29.59s/it]
Task 1, Epoch 16/20 => Loss 1.730, Train_accy 91.78, Test_accy 89.55:  80%|████████  | 16/20 [08:00<02:01, 30.41s/it]
Task 1, Epoch 17/20 => Loss 1.721, Train_accy 92.49:  80%|████████  | 16/20 [08:29<02:01, 30.41s/it]                 
Task 1, Epoch 17/20 => Loss 1.721, Train_accy 92.49:  85%|████████▌ | 17/20 [08:29<01:30, 30.04s/it]
Task 1, Epoch 18/20 => Loss 1.710, Train_accy 93.01:  85%|████████▌ | 17/20 [08:59<01:30, 30.04s/it]
Task 1, Epoch 18/20 => Loss 1.710, Train_accy 93.01:  90%|█████████ | 18/20 [08:59<00:59, 29.79s/it]
Task 1, Epoch 19/20 => Loss 1.645, Train_accy 92.75:  90%|█████████ | 18/20 [09:29<00:59, 29.79s/it]
Task 1, Epoch 19/20 => Loss 1.645, Train_accy 92.75:  95%|█████████▌| 19/20 [09:29<00:30, 30.03s/it]
Task 1, Epoch 20/20 => Loss 1.762, Train_accy 92.97:  95%|█████████▌| 19/20 [10:00<00:30, 30.03s/it]
Task 1, Epoch 20/20 => Loss 1.762, Train_accy 92.97: 100%|██████████| 20/20 [10:00<00:00, 30.39s/it]
Task 1, Epoch 20/20 => Loss 1.762, Train_accy 92.97: 100%|██████████| 20/20 [10:00<00:00, 30.04s/it]
2024-09-11 20:40:31,960 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.762, Train_accy 92.97
2024-09-11 20:40:31,961 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 20:41:26,916 [icarl.py] => Exemplar size: 1600
2024-09-11 20:41:26,917 [trainer.py] => CNN: {'total': 89.01, '00-39': 84.8, '40-79': 93.12, 'old': 84.8, 'new': 93.12}
2024-09-11 20:41:26,917 [trainer.py] => NME: {'total': 90.42, '00-39': 89.87, '40-79': 90.97, 'old': 89.87, 'new': 90.97}
2024-09-11 20:41:26,917 [trainer.py] => CNN top1 curve: [94.71, 89.01]
2024-09-11 20:41:26,917 [trainer.py] => CNN top5 curve: [99.56, 98.69]
2024-09-11 20:41:26,917 [trainer.py] => NME top1 curve: [95.59, 90.42]
2024-09-11 20:41:26,917 [trainer.py] => NME top5 curve: [99.78, 99.24]

Average Accuracy (CNN): 91.86
Average Accuracy (NME): 93.0
2024-09-11 20:41:26,917 [trainer.py] => Average Accuracy (CNN): 91.86
2024-09-11 20:41:26,917 [trainer.py] => Average Accuracy (NME): 93.0
2024-09-11 20:41:26,917 [trainer.py] => All params: 85860176
2024-09-11 20:41:26,918 [trainer.py] => Trainable params: 85860176
2024-09-11 20:41:26,919 [icarl.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.481, Train_accy 65.41, Test_accy 83.12:   0%|          | 0/20 [00:45<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.481, Train_accy 65.41, Test_accy 83.12:   5%|▌         | 1/20 [00:45<14:27, 45.66s/it]
Task 2, Epoch 2/20 => Loss 2.267, Train_accy 84.74:   5%|▌         | 1/20 [01:25<14:27, 45.66s/it]                 
Task 2, Epoch 2/20 => Loss 2.267, Train_accy 84.74:  10%|█         | 2/20 [01:25<12:42, 42.36s/it]
Task 2, Epoch 3/20 => Loss 2.192, Train_accy 86.64:  10%|█         | 2/20 [02:05<12:42, 42.36s/it]
Task 2, Epoch 3/20 => Loss 2.192, Train_accy 86.64:  15%|█▌        | 3/20 [02:05<11:42, 41.35s/it]
Task 2, Epoch 4/20 => Loss 2.132, Train_accy 88.23:  15%|█▌        | 3/20 [02:45<11:42, 41.35s/it]
Task 2, Epoch 4/20 => Loss 2.132, Train_accy 88.23:  20%|██        | 4/20 [02:45<10:53, 40.84s/it]
Task 2, Epoch 5/20 => Loss 2.095, Train_accy 89.27:  20%|██        | 4/20 [03:25<10:53, 40.84s/it]
Task 2, Epoch 5/20 => Loss 2.095, Train_accy 89.27:  25%|██▌       | 5/20 [03:25<10:08, 40.56s/it]
Task 2, Epoch 6/20 => Loss 2.041, Train_accy 90.48, Test_accy 86.16:  25%|██▌       | 5/20 [04:10<10:08, 40.56s/it]
Task 2, Epoch 6/20 => Loss 2.041, Train_accy 90.48, Test_accy 86.16:  30%|███       | 6/20 [04:10<09:49, 42.07s/it]
Task 2, Epoch 7/20 => Loss 2.087, Train_accy 90.77:  30%|███       | 6/20 [04:51<09:49, 42.07s/it]                 
Task 2, Epoch 7/20 => Loss 2.087, Train_accy 90.77:  35%|███▌      | 7/20 [04:51<08:58, 41.44s/it]
Task 2, Epoch 8/20 => Loss 2.048, Train_accy 90.88:  35%|███▌      | 7/20 [05:31<08:58, 41.44s/it]
Task 2, Epoch 8/20 => Loss 2.048, Train_accy 90.88:  40%|████      | 8/20 [05:31<08:11, 41.00s/it]
Task 2, Epoch 9/20 => Loss 1.988, Train_accy 91.20:  40%|████      | 8/20 [06:11<08:11, 41.00s/it]
Task 2, Epoch 9/20 => Loss 1.988, Train_accy 91.20:  45%|████▌     | 9/20 [06:11<07:27, 40.71s/it]
Task 2, Epoch 10/20 => Loss 1.999, Train_accy 91.60:  45%|████▌     | 9/20 [06:51<07:27, 40.71s/it]
Task 2, Epoch 10/20 => Loss 1.999, Train_accy 91.60:  50%|█████     | 10/20 [06:51<06:44, 40.50s/it]
Task 2, Epoch 11/20 => Loss 1.996, Train_accy 92.15, Test_accy 86.16:  50%|█████     | 10/20 [07:36<06:44, 40.50s/it]
Task 2, Epoch 11/20 => Loss 1.996, Train_accy 92.15, Test_accy 86.16:  55%|█████▌    | 11/20 [07:36<06:17, 41.97s/it]
Task 2, Epoch 12/20 => Loss 1.976, Train_accy 91.89:  55%|█████▌    | 11/20 [08:16<06:17, 41.97s/it]                 
Task 2, Epoch 12/20 => Loss 1.976, Train_accy 91.89:  60%|██████    | 12/20 [08:16<05:31, 41.39s/it]
Task 2, Epoch 13/20 => Loss 2.068, Train_accy 90.65:  60%|██████    | 12/20 [08:56<05:31, 41.39s/it]
Task 2, Epoch 13/20 => Loss 2.068, Train_accy 90.65:  65%|██████▌   | 13/20 [08:56<04:46, 40.97s/it]
Task 2, Epoch 14/20 => Loss 2.001, Train_accy 91.95:  65%|██████▌   | 13/20 [09:36<04:46, 40.97s/it]
Task 2, Epoch 14/20 => Loss 2.001, Train_accy 91.95:  70%|███████   | 14/20 [09:36<04:04, 40.71s/it]
Task 2, Epoch 15/20 => Loss 1.972, Train_accy 92.33:  70%|███████   | 14/20 [10:16<04:04, 40.71s/it]
Task 2, Epoch 15/20 => Loss 1.972, Train_accy 92.33:  75%|███████▌  | 15/20 [10:16<03:22, 40.50s/it]
Task 2, Epoch 16/20 => Loss 2.027, Train_accy 92.38, Test_accy 86.44:  75%|███████▌  | 15/20 [11:01<03:22, 40.50s/it]
Task 2, Epoch 16/20 => Loss 2.027, Train_accy 92.38, Test_accy 86.44:  80%|████████  | 16/20 [11:01<02:47, 41.89s/it]
Task 2, Epoch 17/20 => Loss 1.961, Train_accy 92.73:  80%|████████  | 16/20 [11:41<02:47, 41.89s/it]                 
Task 2, Epoch 17/20 => Loss 1.961, Train_accy 92.73:  85%|████████▌ | 17/20 [11:41<02:03, 41.33s/it]
Task 2, Epoch 18/20 => Loss 1.937, Train_accy 93.16:  85%|████████▌ | 17/20 [12:21<02:03, 41.33s/it]
Task 2, Epoch 18/20 => Loss 1.937, Train_accy 93.16:  90%|█████████ | 18/20 [12:21<01:21, 40.94s/it]
Task 2, Epoch 19/20 => Loss 1.922, Train_accy 94.00:  90%|█████████ | 18/20 [13:02<01:21, 40.94s/it]
Task 2, Epoch 19/20 => Loss 1.922, Train_accy 94.00:  95%|█████████▌| 19/20 [13:02<00:40, 40.69s/it]
Task 2, Epoch 20/20 => Loss 1.894, Train_accy 94.03:  95%|█████████▌| 19/20 [13:42<00:40, 40.69s/it]
Task 2, Epoch 20/20 => Loss 1.894, Train_accy 94.03: 100%|██████████| 20/20 [13:42<00:00, 40.48s/it]
Task 2, Epoch 20/20 => Loss 1.894, Train_accy 94.03: 100%|██████████| 20/20 [13:42<00:00, 41.10s/it]
2024-09-11 20:55:08,976 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.894, Train_accy 94.03
2024-09-11 20:55:08,977 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 20:56:19,421 [icarl.py] => Exemplar size: 2400
2024-09-11 20:56:19,421 [trainer.py] => CNN: {'total': 86.65, '00-39': 81.28, '40-79': 86.02, '80-119': 92.15, 'old': 83.68, 'new': 92.15}
2024-09-11 20:56:19,422 [trainer.py] => NME: {'total': 87.85, '00-39': 87.67, '40-79': 87.53, '80-119': 88.33, 'old': 87.6, 'new': 88.33}
2024-09-11 20:56:19,422 [trainer.py] => CNN top1 curve: [94.71, 89.01, 86.65]
2024-09-11 20:56:19,422 [trainer.py] => CNN top5 curve: [99.56, 98.69, 98.09]
2024-09-11 20:56:19,422 [trainer.py] => NME top1 curve: [95.59, 90.42, 87.85]
2024-09-11 20:56:19,422 [trainer.py] => NME top5 curve: [99.78, 99.24, 98.38]

Average Accuracy (CNN): 90.12
Average Accuracy (NME): 91.29
2024-09-11 20:56:19,422 [trainer.py] => Average Accuracy (CNN): 90.12
2024-09-11 20:56:19,422 [trainer.py] => Average Accuracy (NME): 91.29
2024-09-11 20:56:19,422 [trainer.py] => All params: 85890936
2024-09-11 20:56:19,423 [trainer.py] => Trainable params: 85890936
2024-09-11 20:56:19,424 [icarl.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.352, Train_accy 69.58, Test_accy 82.02:   0%|          | 0/20 [00:55<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.352, Train_accy 69.58, Test_accy 82.02:   5%|▌         | 1/20 [00:55<17:42, 55.90s/it]
Task 3, Epoch 2/20 => Loss 2.374, Train_accy 83.39:   5%|▌         | 1/20 [01:45<17:42, 55.90s/it]                 
Task 3, Epoch 2/20 => Loss 2.374, Train_accy 83.39:  10%|█         | 2/20 [01:45<15:34, 51.91s/it]
Task 3, Epoch 3/20 => Loss 2.209, Train_accy 87.15:  10%|█         | 2/20 [02:34<15:34, 51.91s/it]
Task 3, Epoch 3/20 => Loss 2.209, Train_accy 87.15:  15%|█▌        | 3/20 [02:34<14:22, 50.71s/it]
Task 3, Epoch 4/20 => Loss 2.163, Train_accy 88.37:  15%|█▌        | 3/20 [03:23<14:22, 50.71s/it]
Task 3, Epoch 4/20 => Loss 2.163, Train_accy 88.37:  20%|██        | 4/20 [03:23<13:22, 50.14s/it]
Task 3, Epoch 5/20 => Loss 2.118, Train_accy 89.89:  20%|██        | 4/20 [04:12<13:22, 50.14s/it]
Task 3, Epoch 5/20 => Loss 2.118, Train_accy 89.89:  25%|██▌       | 5/20 [04:12<12:27, 49.82s/it]
Task 3, Epoch 6/20 => Loss 2.102, Train_accy 90.59, Test_accy 83.08:  25%|██▌       | 5/20 [05:08<12:27, 49.82s/it]
Task 3, Epoch 6/20 => Loss 2.102, Train_accy 90.59, Test_accy 83.08:  30%|███       | 6/20 [05:08<12:06, 51.93s/it]
Task 3, Epoch 7/20 => Loss 2.002, Train_accy 91.83:  30%|███       | 6/20 [05:58<12:06, 51.93s/it]                 
Task 3, Epoch 7/20 => Loss 2.002, Train_accy 91.83:  35%|███▌      | 7/20 [05:58<11:03, 51.07s/it]
Task 3, Epoch 8/20 => Loss 2.090, Train_accy 90.85:  35%|███▌      | 7/20 [06:47<11:03, 51.07s/it]
Task 3, Epoch 8/20 => Loss 2.090, Train_accy 90.85:  40%|████      | 8/20 [06:47<10:06, 50.53s/it]
Task 3, Epoch 9/20 => Loss 2.063, Train_accy 91.48:  40%|████      | 8/20 [07:36<10:06, 50.53s/it]
Task 3, Epoch 9/20 => Loss 2.063, Train_accy 91.48:  45%|████▌     | 9/20 [07:36<09:12, 50.20s/it]
Task 3, Epoch 10/20 => Loss 2.113, Train_accy 90.85:  45%|████▌     | 9/20 [08:26<09:12, 50.20s/it]
Task 3, Epoch 10/20 => Loss 2.113, Train_accy 90.85:  50%|█████     | 10/20 [08:26<08:19, 49.94s/it]
Task 3, Epoch 11/20 => Loss 2.034, Train_accy 91.37, Test_accy 84.14:  50%|█████     | 10/20 [09:22<08:19, 49.94s/it]
Task 3, Epoch 11/20 => Loss 2.034, Train_accy 91.37, Test_accy 84.14:  55%|█████▌    | 11/20 [09:22<07:46, 51.81s/it]
Task 3, Epoch 12/20 => Loss 2.021, Train_accy 92.42:  55%|█████▌    | 11/20 [10:11<07:46, 51.81s/it]                 
Task 3, Epoch 12/20 => Loss 2.021, Train_accy 92.42:  60%|██████    | 12/20 [10:11<06:48, 51.09s/it]
Task 3, Epoch 13/20 => Loss 2.022, Train_accy 92.75:  60%|██████    | 12/20 [11:01<06:48, 51.09s/it]
Task 3, Epoch 13/20 => Loss 2.022, Train_accy 92.75:  65%|██████▌   | 13/20 [11:01<05:54, 50.63s/it]
Task 3, Epoch 14/20 => Loss 1.971, Train_accy 92.35:  65%|██████▌   | 13/20 [11:50<05:54, 50.63s/it]
Task 3, Epoch 14/20 => Loss 1.971, Train_accy 92.35:  70%|███████   | 14/20 [11:50<05:01, 50.27s/it]
Task 3, Epoch 15/20 => Loss 2.013, Train_accy 92.68:  70%|███████   | 14/20 [12:40<05:01, 50.27s/it]
Task 3, Epoch 15/20 => Loss 2.013, Train_accy 92.68:  75%|███████▌  | 15/20 [12:40<04:10, 50.04s/it]
Task 3, Epoch 16/20 => Loss 2.016, Train_accy 92.23, Test_accy 85.25:  75%|███████▌  | 15/20 [13:36<04:10, 50.04s/it]
Task 3, Epoch 16/20 => Loss 2.016, Train_accy 92.23, Test_accy 85.25:  80%|████████  | 16/20 [13:36<03:27, 51.81s/it]
Task 3, Epoch 17/20 => Loss 1.922, Train_accy 93.28:  80%|████████  | 16/20 [14:25<03:27, 51.81s/it]                 
Task 3, Epoch 17/20 => Loss 1.922, Train_accy 93.28:  85%|████████▌ | 17/20 [14:25<02:33, 51.07s/it]
Task 3, Epoch 18/20 => Loss 1.998, Train_accy 93.52:  85%|████████▌ | 17/20 [15:15<02:33, 51.07s/it]
Task 3, Epoch 18/20 => Loss 1.998, Train_accy 93.52:  90%|█████████ | 18/20 [15:15<01:41, 50.60s/it]
Task 3, Epoch 19/20 => Loss 1.979, Train_accy 92.84:  90%|█████████ | 18/20 [16:04<01:41, 50.60s/it]
Task 3, Epoch 19/20 => Loss 1.979, Train_accy 92.84:  95%|█████████▌| 19/20 [16:04<00:50, 50.18s/it]
Task 3, Epoch 20/20 => Loss 1.990, Train_accy 93.43:  95%|█████████▌| 19/20 [16:53<00:50, 50.18s/it]
Task 3, Epoch 20/20 => Loss 1.990, Train_accy 93.43: 100%|██████████| 20/20 [16:53<00:00, 49.98s/it]
Task 3, Epoch 20/20 => Loss 1.990, Train_accy 93.43: 100%|██████████| 20/20 [16:53<00:00, 50.69s/it]
2024-09-11 21:13:13,286 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.990, Train_accy 93.43
2024-09-11 21:13:13,288 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 21:14:39,938 [icarl.py] => Exemplar size: 3200
2024-09-11 21:14:39,938 [trainer.py] => CNN: {'total': 84.77, '00-39': 78.63, '40-79': 81.29, '80-119': 86.52, '120-159': 92.21, 'old': 82.27, 'new': 92.21}
2024-09-11 21:14:39,938 [trainer.py] => NME: {'total': 86.3, '00-39': 85.68, '40-79': 86.02, '80-119': 85.51, '120-159': 88.0, 'old': 85.73, 'new': 88.0}
2024-09-11 21:14:39,938 [trainer.py] => CNN top1 curve: [94.71, 89.01, 86.65, 84.77]
2024-09-11 21:14:39,938 [trainer.py] => CNN top5 curve: [99.56, 98.69, 98.09, 97.62]
2024-09-11 21:14:39,938 [trainer.py] => NME top1 curve: [95.59, 90.42, 87.85, 86.3]
2024-09-11 21:14:39,938 [trainer.py] => NME top5 curve: [99.78, 99.24, 98.38, 98.36]

Average Accuracy (CNN): 88.78
Average Accuracy (NME): 90.04
2024-09-11 21:14:39,938 [trainer.py] => Average Accuracy (CNN): 88.78
2024-09-11 21:14:39,938 [trainer.py] => Average Accuracy (NME): 90.04
2024-09-11 21:14:39,939 [trainer.py] => All params: 85921696
2024-09-11 21:14:39,939 [trainer.py] => Trainable params: 85921696
2024-09-11 21:14:39,941 [icarl.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.278, Train_accy 73.44, Test_accy 77.18:   0%|          | 0/20 [01:07<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.278, Train_accy 73.44, Test_accy 77.18:   5%|▌         | 1/20 [01:07<21:27, 67.78s/it]
Task 4, Epoch 2/20 => Loss 2.337, Train_accy 86.11:   5%|▌         | 1/20 [02:06<21:27, 67.78s/it]                 
Task 4, Epoch 2/20 => Loss 2.337, Train_accy 86.11:  10%|█         | 2/20 [02:06<18:48, 62.68s/it]
Task 4, Epoch 3/20 => Loss 2.275, Train_accy 87.63:  10%|█         | 2/20 [03:05<18:48, 62.68s/it]
Task 4, Epoch 3/20 => Loss 2.275, Train_accy 87.63:  15%|█▌        | 3/20 [03:05<17:17, 61.02s/it]
Task 4, Epoch 4/20 => Loss 2.193, Train_accy 90.22:  15%|█▌        | 3/20 [04:05<17:17, 61.02s/it]
Task 4, Epoch 4/20 => Loss 2.193, Train_accy 90.22:  20%|██        | 4/20 [04:05<16:04, 60.29s/it]
Task 4, Epoch 5/20 => Loss 2.159, Train_accy 91.00:  20%|██        | 4/20 [05:04<16:04, 60.29s/it]
Task 4, Epoch 5/20 => Loss 2.159, Train_accy 91.00:  25%|██▌       | 5/20 [05:04<14:57, 59.86s/it]
Task 4, Epoch 6/20 => Loss 2.189, Train_accy 90.35, Test_accy 82.19:  25%|██▌       | 5/20 [06:11<14:57, 59.86s/it]
Task 4, Epoch 6/20 => Loss 2.189, Train_accy 90.35, Test_accy 82.19:  30%|███       | 6/20 [06:11<14:31, 62.23s/it]
Task 4, Epoch 7/20 => Loss 2.169, Train_accy 91.27:  30%|███       | 6/20 [07:09<14:31, 62.23s/it]                 
Task 4, Epoch 7/20 => Loss 2.169, Train_accy 91.27:  35%|███▌      | 7/20 [07:09<13:14, 61.12s/it]
Task 4, Epoch 8/20 => Loss 2.098, Train_accy 92.37:  35%|███▌      | 7/20 [08:08<13:14, 61.12s/it]
Task 4, Epoch 8/20 => Loss 2.098, Train_accy 92.37:  40%|████      | 8/20 [08:08<12:05, 60.46s/it]
Task 4, Epoch 9/20 => Loss 2.103, Train_accy 92.37:  40%|████      | 8/20 [09:07<12:05, 60.46s/it]
Task 4, Epoch 9/20 => Loss 2.103, Train_accy 92.37:  45%|████▌     | 9/20 [09:07<10:59, 59.96s/it]
Task 4, Epoch 10/20 => Loss 2.134, Train_accy 92.04:  45%|████▌     | 9/20 [10:06<10:59, 59.96s/it]
Task 4, Epoch 10/20 => Loss 2.134, Train_accy 92.04:  50%|█████     | 10/20 [10:06<09:56, 59.61s/it]
Task 4, Epoch 11/20 => Loss 2.130, Train_accy 92.39, Test_accy 82.49:  50%|█████     | 10/20 [11:13<09:56, 59.61s/it]
Task 4, Epoch 11/20 => Loss 2.130, Train_accy 92.39, Test_accy 82.49:  55%|█████▌    | 11/20 [11:13<09:16, 61.81s/it]
Task 4, Epoch 12/20 => Loss 2.056, Train_accy 93.44:  55%|█████▌    | 11/20 [12:12<09:16, 61.81s/it]                 
Task 4, Epoch 12/20 => Loss 2.056, Train_accy 93.44:  60%|██████    | 12/20 [12:12<08:08, 61.02s/it]
Task 4, Epoch 13/20 => Loss 2.129, Train_accy 92.74:  60%|██████    | 12/20 [13:11<08:08, 61.02s/it]
Task 4, Epoch 13/20 => Loss 2.129, Train_accy 92.74:  65%|██████▌   | 13/20 [13:11<07:02, 60.38s/it]
Task 4, Epoch 14/20 => Loss 2.039, Train_accy 93.42:  65%|██████▌   | 13/20 [14:10<07:02, 60.38s/it]
Task 4, Epoch 14/20 => Loss 2.039, Train_accy 93.42:  70%|███████   | 14/20 [14:10<05:59, 59.95s/it]
Task 4, Epoch 15/20 => Loss 2.055, Train_accy 93.52:  70%|███████   | 14/20 [15:09<05:59, 59.95s/it]
Task 4, Epoch 15/20 => Loss 2.055, Train_accy 93.52:  75%|███████▌  | 15/20 [15:09<04:58, 59.68s/it]
Task 4, Epoch 16/20 => Loss 2.085, Train_accy 93.44, Test_accy 82.27:  75%|███████▌  | 15/20 [16:16<04:58, 59.68s/it]
Task 4, Epoch 16/20 => Loss 2.085, Train_accy 93.44, Test_accy 82.27:  80%|████████  | 16/20 [16:16<04:07, 61.85s/it]
Task 4, Epoch 17/20 => Loss 2.095, Train_accy 93.50:  80%|████████  | 16/20 [17:15<04:07, 61.85s/it]                 
Task 4, Epoch 17/20 => Loss 2.095, Train_accy 93.50:  85%|████████▌ | 17/20 [17:15<03:02, 60.97s/it]
Task 4, Epoch 18/20 => Loss 2.045, Train_accy 94.03:  85%|████████▌ | 17/20 [18:14<03:02, 60.97s/it]
Task 4, Epoch 18/20 => Loss 2.045, Train_accy 94.03:  90%|█████████ | 18/20 [18:14<02:00, 60.34s/it]
Task 4, Epoch 19/20 => Loss 2.086, Train_accy 93.52:  90%|█████████ | 18/20 [19:13<02:00, 60.34s/it]
Task 4, Epoch 19/20 => Loss 2.086, Train_accy 93.52:  95%|█████████▌| 19/20 [19:13<00:59, 59.94s/it]
Task 4, Epoch 20/20 => Loss 2.059, Train_accy 93.76:  95%|█████████▌| 19/20 [20:12<00:59, 59.94s/it]
Task 4, Epoch 20/20 => Loss 2.059, Train_accy 93.76: 100%|██████████| 20/20 [20:12<00:00, 59.62s/it]
Task 4, Epoch 20/20 => Loss 2.059, Train_accy 93.76: 100%|██████████| 20/20 [20:12<00:00, 60.60s/it]
2024-09-11 21:34:52,050 [icarl.py] => Task 4, Epoch 20/20 => Loss 2.059, Train_accy 93.76
2024-09-11 21:34:52,052 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 21:36:35,622 [icarl.py] => Exemplar size: 4000
2024-09-11 21:36:35,623 [trainer.py] => CNN: {'total': 81.98, '00-39': 73.57, '40-79': 78.71, '80-119': 81.49, '120-159': 84.84, '160-199': 91.01, 'old': 79.75, 'new': 91.01}
2024-09-11 21:36:35,623 [trainer.py] => NME: {'total': 85.45, '00-39': 84.8, '40-79': 84.95, '80-119': 85.31, '120-159': 85.68, '160-199': 86.51, 'old': 85.19, 'new': 86.51}
2024-09-11 21:36:35,623 [trainer.py] => CNN top1 curve: [94.71, 89.01, 86.65, 84.77, 81.98]
2024-09-11 21:36:35,623 [trainer.py] => CNN top5 curve: [99.56, 98.69, 98.09, 97.62, 96.52]
2024-09-11 21:36:35,623 [trainer.py] => NME top1 curve: [95.59, 90.42, 87.85, 86.3, 85.45]
2024-09-11 21:36:35,623 [trainer.py] => NME top5 curve: [99.78, 99.24, 98.38, 98.36, 97.24]

Average Accuracy (CNN): 87.42
Average Accuracy (NME): 89.12
2024-09-11 21:36:35,623 [trainer.py] => Average Accuracy (CNN): 87.42
2024-09-11 21:36:35,623 [trainer.py] => Average Accuracy (NME): 89.12
Accuracy Matrix (CNN):
[[94.71 84.8  81.28 78.63 73.57]
 [ 0.   93.12 86.02 81.29 78.71]
 [ 0.    0.   92.15 86.52 81.49]
 [ 0.    0.    0.   92.21 84.84]
 [ 0.    0.    0.    0.   91.01]]
2024-09-11 21:36:35,624 [trainer.py] => Forgetting (CNN): 13.395000000000003
Accuracy Matrix (NME):
[[95.59 89.87 87.67 85.68 84.8 ]
 [ 0.   90.97 87.53 86.02 84.95]
 [ 0.    0.   88.33 85.51 85.31]
 [ 0.    0.    0.   88.   85.68]
 [ 0.    0.    0.    0.   86.51]]
2024-09-11 21:36:35,624 [trainer.py] => Forgetting (NME): 5.537499999999998
2024-09-11 21:36:39,871 [trainer.py] => config: ./exps/icarl_cub_B0_Inc10.json
2024-09-11 21:36:39,899 [trainer.py] => prefix: reproduce
2024-09-11 21:36:39,899 [trainer.py] => dataset: cub
2024-09-11 21:36:39,899 [trainer.py] => memory_size: 4000
2024-09-11 21:36:39,899 [trainer.py] => memory_per_class: 20
2024-09-11 21:36:39,899 [trainer.py] => fixed_memory: True
2024-09-11 21:36:39,899 [trainer.py] => shuffle: True
2024-09-11 21:36:39,899 [trainer.py] => init_cls: 20
2024-09-11 21:36:39,899 [trainer.py] => increment: 20
2024-09-11 21:36:39,900 [trainer.py] => model_name: icarl
2024-09-11 21:36:39,900 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-11 21:36:39,900 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-11 21:36:39,900 [trainer.py] => seed: 1993
2024-09-11 21:36:39,900 [trainer.py] => init_epoch: 20
2024-09-11 21:36:39,900 [trainer.py] => init_lr: 0.001
2024-09-11 21:36:39,900 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-11 21:36:39,900 [trainer.py] => init_lr_decay: 0.1
2024-09-11 21:36:39,900 [trainer.py] => init_weight_decay: 0.0005
2024-09-11 21:36:39,901 [trainer.py] => epochs: 20
2024-09-11 21:36:39,901 [trainer.py] => lrate: 0.001
2024-09-11 21:36:39,901 [trainer.py] => milestones: [80, 120]
2024-09-11 21:36:39,901 [trainer.py] => lrate_decay: 0.1
2024-09-11 21:36:39,901 [trainer.py] => batch_size: 48
2024-09-11 21:36:39,901 [trainer.py] => weight_decay: 0.0002
2024-09-11 21:36:39,901 [trainer.py] => T: 2
2024-09-11 21:36:39,959 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-11 21:36:42,126 [trainer.py] => All params: 85798656
2024-09-11 21:36:42,127 [trainer.py] => Trainable params: 85798656
2024-09-11 21:36:42,127 [icarl.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.738, Train_accy 49.58, Test_accy 92.31:   0%|          | 0/20 [00:09<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.738, Train_accy 49.58, Test_accy 92.31:   5%|▌         | 1/20 [00:09<03:09,  9.99s/it]
Task 0, Epoch 2/20 => Loss 0.514, Train_accy 85.31:   5%|▌         | 1/20 [00:18<03:09,  9.99s/it]                 
Task 0, Epoch 2/20 => Loss 0.514, Train_accy 85.31:  10%|█         | 2/20 [00:18<02:42,  9.05s/it]
Task 0, Epoch 3/20 => Loss 0.367, Train_accy 88.90:  10%|█         | 2/20 [00:26<02:42,  9.05s/it]
Task 0, Epoch 3/20 => Loss 0.367, Train_accy 88.90:  15%|█▌        | 3/20 [00:26<02:29,  8.76s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.80:  15%|█▌        | 3/20 [00:35<02:29,  8.76s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.80:  20%|██        | 4/20 [00:35<02:17,  8.61s/it]
Task 0, Epoch 5/20 => Loss 0.248, Train_accy 91.75:  20%|██        | 4/20 [00:43<02:17,  8.61s/it]
Task 0, Epoch 5/20 => Loss 0.248, Train_accy 91.75:  25%|██▌       | 5/20 [00:43<02:07,  8.53s/it]
Task 0, Epoch 6/20 => Loss 0.250, Train_accy 92.18, Test_accy 95.14:  25%|██▌       | 5/20 [00:53<02:07,  8.53s/it]
Task 0, Epoch 6/20 => Loss 0.250, Train_accy 92.18, Test_accy 95.14:  30%|███       | 6/20 [00:53<02:05,  8.95s/it]
Task 0, Epoch 7/20 => Loss 0.233, Train_accy 93.23:  30%|███       | 6/20 [01:01<02:05,  8.95s/it]                 
Task 0, Epoch 7/20 => Loss 0.233, Train_accy 93.23:  35%|███▌      | 7/20 [01:01<01:54,  8.81s/it]
Task 0, Epoch 8/20 => Loss 0.231, Train_accy 92.71:  35%|███▌      | 7/20 [01:10<01:54,  8.81s/it]
Task 0, Epoch 8/20 => Loss 0.231, Train_accy 92.71:  40%|████      | 8/20 [01:10<01:44,  8.68s/it]
Task 0, Epoch 9/20 => Loss 0.183, Train_accy 94.19:  40%|████      | 8/20 [01:18<01:44,  8.68s/it]
Task 0, Epoch 9/20 => Loss 0.183, Train_accy 94.19:  45%|████▌     | 9/20 [01:18<01:34,  8.61s/it]
Task 0, Epoch 10/20 => Loss 0.208, Train_accy 93.45:  45%|████▌     | 9/20 [01:27<01:34,  8.61s/it]
Task 0, Epoch 10/20 => Loss 0.208, Train_accy 93.45:  50%|█████     | 10/20 [01:27<01:25,  8.55s/it]
Task 0, Epoch 11/20 => Loss 0.228, Train_accy 93.02, Test_accy 97.17:  50%|█████     | 10/20 [01:36<01:25,  8.55s/it]
Task 0, Epoch 11/20 => Loss 0.228, Train_accy 93.02, Test_accy 97.17:  55%|█████▌    | 11/20 [01:36<01:20,  8.91s/it]
Task 0, Epoch 12/20 => Loss 0.219, Train_accy 94.08:  55%|█████▌    | 11/20 [01:45<01:20,  8.91s/it]                 
Task 0, Epoch 12/20 => Loss 0.219, Train_accy 94.08:  60%|██████    | 12/20 [01:45<01:10,  8.77s/it]
Task 0, Epoch 13/20 => Loss 0.151, Train_accy 95.35:  60%|██████    | 12/20 [01:53<01:10,  8.77s/it]
Task 0, Epoch 13/20 => Loss 0.151, Train_accy 95.35:  65%|██████▌   | 13/20 [01:53<01:00,  8.67s/it]
Task 0, Epoch 14/20 => Loss 0.137, Train_accy 95.56:  65%|██████▌   | 13/20 [02:02<01:00,  8.67s/it]
Task 0, Epoch 14/20 => Loss 0.137, Train_accy 95.56:  70%|███████   | 14/20 [02:02<00:51,  8.60s/it]
Task 0, Epoch 15/20 => Loss 0.223, Train_accy 93.23:  70%|███████   | 14/20 [02:10<00:51,  8.60s/it]
Task 0, Epoch 15/20 => Loss 0.223, Train_accy 93.23:  75%|███████▌  | 15/20 [02:10<00:42,  8.58s/it]
Task 0, Epoch 16/20 => Loss 0.218, Train_accy 93.02, Test_accy 95.95:  75%|███████▌  | 15/20 [02:20<00:42,  8.58s/it]
Task 0, Epoch 16/20 => Loss 0.218, Train_accy 93.02, Test_accy 95.95:  80%|████████  | 16/20 [02:20<00:35,  8.93s/it]
Task 0, Epoch 17/20 => Loss 0.163, Train_accy 95.14:  80%|████████  | 16/20 [02:28<00:35,  8.93s/it]                 
Task 0, Epoch 17/20 => Loss 0.163, Train_accy 95.14:  85%|████████▌ | 17/20 [02:28<00:26,  8.77s/it]
Task 0, Epoch 18/20 => Loss 0.132, Train_accy 95.77:  85%|████████▌ | 17/20 [02:37<00:26,  8.77s/it]
Task 0, Epoch 18/20 => Loss 0.132, Train_accy 95.77:  90%|█████████ | 18/20 [02:37<00:17,  8.68s/it]
Task 0, Epoch 19/20 => Loss 0.145, Train_accy 95.35:  90%|█████████ | 18/20 [02:45<00:17,  8.68s/it]
Task 0, Epoch 19/20 => Loss 0.145, Train_accy 95.35:  95%|█████████▌| 19/20 [02:45<00:08,  8.61s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45:  95%|█████████▌| 19/20 [02:54<00:08,  8.61s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45: 100%|██████████| 20/20 [02:54<00:00,  8.58s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45: 100%|██████████| 20/20 [02:54<00:00,  8.71s/it]
2024-09-11 21:39:36,927 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.45
2024-09-11 21:39:36,928 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 21:39:57,363 [icarl.py] => Exemplar size: 400
2024-09-11 21:39:57,363 [trainer.py] => CNN: {'total': 96.36, '00-19': 96.36, 'old': 0, 'new': 96.36}
2024-09-11 21:39:57,363 [trainer.py] => NME: {'total': 98.79, '00-19': 98.79, 'old': 0, 'new': 98.79}
2024-09-11 21:39:57,363 [trainer.py] => CNN top1 curve: [96.36]
2024-09-11 21:39:57,363 [trainer.py] => CNN top5 curve: [100.0]
2024-09-11 21:39:57,363 [trainer.py] => NME top1 curve: [98.79]
2024-09-11 21:39:57,363 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 96.36
Average Accuracy (NME): 98.79
2024-09-11 21:39:57,363 [trainer.py] => Average Accuracy (CNN): 96.36
2024-09-11 21:39:57,363 [trainer.py] => Average Accuracy (NME): 98.79
2024-09-11 21:39:57,364 [trainer.py] => All params: 85814036
2024-09-11 21:39:57,364 [trainer.py] => Trainable params: 85814036
2024-09-11 21:39:57,365 [icarl.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.239, Train_accy 58.44, Test_accy 88.33:   0%|          | 0/20 [00:17<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.239, Train_accy 58.44, Test_accy 88.33:   5%|▌         | 1/20 [00:17<05:36, 17.71s/it]
Task 1, Epoch 2/20 => Loss 1.595, Train_accy 87.73:   5%|▌         | 1/20 [00:33<05:36, 17.71s/it]                 
Task 1, Epoch 2/20 => Loss 1.595, Train_accy 87.73:  10%|█         | 2/20 [00:33<04:59, 16.62s/it]
Task 1, Epoch 3/20 => Loss 1.476, Train_accy 89.74:  10%|█         | 2/20 [00:49<04:59, 16.62s/it]
Task 1, Epoch 3/20 => Loss 1.476, Train_accy 89.74:  15%|█▌        | 3/20 [00:49<04:37, 16.31s/it]
Task 1, Epoch 4/20 => Loss 1.382, Train_accy 92.04:  15%|█▌        | 3/20 [01:05<04:37, 16.31s/it]
Task 1, Epoch 4/20 => Loss 1.382, Train_accy 92.04:  20%|██        | 4/20 [01:05<04:18, 16.13s/it]
Task 1, Epoch 5/20 => Loss 1.659, Train_accy 87.66:  20%|██        | 4/20 [01:21<04:18, 16.13s/it]
Task 1, Epoch 5/20 => Loss 1.659, Train_accy 87.66:  25%|██▌       | 5/20 [01:21<04:00, 16.05s/it]
Task 1, Epoch 6/20 => Loss 1.319, Train_accy 93.68, Test_accy 95.15:  25%|██▌       | 5/20 [01:39<04:00, 16.05s/it]
Task 1, Epoch 6/20 => Loss 1.319, Train_accy 93.68, Test_accy 95.15:  30%|███       | 6/20 [01:39<03:52, 16.64s/it]
Task 1, Epoch 7/20 => Loss 1.376, Train_accy 93.09:  30%|███       | 6/20 [01:54<03:52, 16.64s/it]                 
Task 1, Epoch 7/20 => Loss 1.376, Train_accy 93.09:  35%|███▌      | 7/20 [01:54<03:33, 16.39s/it]
Task 1, Epoch 8/20 => Loss 1.271, Train_accy 94.13:  35%|███▌      | 7/20 [02:10<03:33, 16.39s/it]
Task 1, Epoch 8/20 => Loss 1.271, Train_accy 94.13:  40%|████      | 8/20 [02:10<03:14, 16.25s/it]
Task 1, Epoch 9/20 => Loss 1.384, Train_accy 93.53:  40%|████      | 8/20 [02:26<03:14, 16.25s/it]
Task 1, Epoch 9/20 => Loss 1.384, Train_accy 93.53:  45%|████▌     | 9/20 [02:26<02:57, 16.14s/it]
Task 1, Epoch 10/20 => Loss 1.401, Train_accy 92.64:  45%|████▌     | 9/20 [02:42<02:57, 16.14s/it]
Task 1, Epoch 10/20 => Loss 1.401, Train_accy 92.64:  50%|█████     | 10/20 [02:42<02:40, 16.07s/it]
Task 1, Epoch 11/20 => Loss 1.401, Train_accy 93.75, Test_accy 96.92:  50%|█████     | 10/20 [03:00<02:40, 16.07s/it]
Task 1, Epoch 11/20 => Loss 1.401, Train_accy 93.75, Test_accy 96.92:  55%|█████▌    | 11/20 [03:00<02:29, 16.64s/it]
Task 1, Epoch 12/20 => Loss 1.259, Train_accy 95.46:  55%|█████▌    | 11/20 [03:16<02:29, 16.64s/it]                 
Task 1, Epoch 12/20 => Loss 1.259, Train_accy 95.46:  60%|██████    | 12/20 [03:16<02:11, 16.41s/it]
Task 1, Epoch 13/20 => Loss 1.355, Train_accy 93.75:  60%|██████    | 12/20 [03:32<02:11, 16.41s/it]
Task 1, Epoch 13/20 => Loss 1.355, Train_accy 93.75:  65%|██████▌   | 13/20 [03:32<01:54, 16.29s/it]
Task 1, Epoch 14/20 => Loss 1.470, Train_accy 91.15:  65%|██████▌   | 13/20 [03:48<01:54, 16.29s/it]
Task 1, Epoch 14/20 => Loss 1.470, Train_accy 91.15:  70%|███████   | 14/20 [03:48<01:37, 16.18s/it]
Task 1, Epoch 15/20 => Loss 1.432, Train_accy 93.16:  70%|███████   | 14/20 [04:04<01:37, 16.18s/it]
Task 1, Epoch 15/20 => Loss 1.432, Train_accy 93.16:  75%|███████▌  | 15/20 [04:04<01:20, 16.15s/it]
Task 1, Epoch 16/20 => Loss 1.651, Train_accy 91.60, Test_accy 91.63:  75%|███████▌  | 15/20 [04:22<01:20, 16.15s/it]
Task 1, Epoch 16/20 => Loss 1.651, Train_accy 91.60, Test_accy 91.63:  80%|████████  | 16/20 [04:22<01:06, 16.66s/it]
Task 1, Epoch 17/20 => Loss 1.988, Train_accy 85.28:  80%|████████  | 16/20 [04:38<01:06, 16.66s/it]                 
Task 1, Epoch 17/20 => Loss 1.988, Train_accy 85.28:  85%|████████▌ | 17/20 [04:38<00:49, 16.43s/it]
Task 1, Epoch 18/20 => Loss 1.519, Train_accy 90.86:  85%|████████▌ | 17/20 [04:54<00:49, 16.43s/it]
Task 1, Epoch 18/20 => Loss 1.519, Train_accy 90.86:  90%|█████████ | 18/20 [04:54<00:32, 16.27s/it]
Task 1, Epoch 19/20 => Loss 1.420, Train_accy 93.98:  90%|█████████ | 18/20 [05:10<00:32, 16.27s/it]
Task 1, Epoch 19/20 => Loss 1.420, Train_accy 93.98:  95%|█████████▌| 19/20 [05:10<00:16, 16.16s/it]
Task 1, Epoch 20/20 => Loss 1.348, Train_accy 94.72:  95%|█████████▌| 19/20 [05:26<00:16, 16.16s/it]
Task 1, Epoch 20/20 => Loss 1.348, Train_accy 94.72: 100%|██████████| 20/20 [05:26<00:00, 16.11s/it]
Task 1, Epoch 20/20 => Loss 1.348, Train_accy 94.72: 100%|██████████| 20/20 [05:26<00:00, 16.30s/it]
2024-09-11 21:45:23,425 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.348, Train_accy 94.72
2024-09-11 21:45:23,427 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 21:45:52,377 [icarl.py] => Exemplar size: 800
2024-09-11 21:45:52,378 [trainer.py] => CNN: {'total': 95.15, '00-19': 95.14, '20-39': 95.17, 'old': 95.14, 'new': 95.17}
2024-09-11 21:45:52,378 [trainer.py] => NME: {'total': 94.93, '00-19': 95.95, '20-39': 93.72, 'old': 95.95, 'new': 93.72}
2024-09-11 21:45:52,378 [trainer.py] => CNN top1 curve: [96.36, 95.15]
2024-09-11 21:45:52,378 [trainer.py] => CNN top5 curve: [100.0, 99.56]
2024-09-11 21:45:52,378 [trainer.py] => NME top1 curve: [98.79, 94.93]
2024-09-11 21:45:52,378 [trainer.py] => NME top5 curve: [100.0, 99.56]

Average Accuracy (CNN): 95.76
Average Accuracy (NME): 96.86
2024-09-11 21:45:52,378 [trainer.py] => Average Accuracy (CNN): 95.76
2024-09-11 21:45:52,378 [trainer.py] => Average Accuracy (NME): 96.86
2024-09-11 21:45:52,378 [trainer.py] => All params: 85829416
2024-09-11 21:45:52,379 [trainer.py] => Trainable params: 85829416
2024-09-11 21:45:52,380 [icarl.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.304, Train_accy 64.08, Test_accy 86.46:   0%|          | 0/20 [00:23<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.304, Train_accy 64.08, Test_accy 86.46:   5%|▌         | 1/20 [00:23<07:18, 23.07s/it]
Task 2, Epoch 2/20 => Loss 1.926, Train_accy 86.00:   5%|▌         | 1/20 [00:43<07:18, 23.07s/it]                 
Task 2, Epoch 2/20 => Loss 1.926, Train_accy 86.00:  10%|█         | 2/20 [00:43<06:27, 21.52s/it]
Task 2, Epoch 3/20 => Loss 1.815, Train_accy 88.93:  10%|█         | 2/20 [01:04<06:27, 21.52s/it]
Task 2, Epoch 3/20 => Loss 1.815, Train_accy 88.93:  15%|█▌        | 3/20 [01:04<05:58, 21.08s/it]
Task 2, Epoch 4/20 => Loss 1.836, Train_accy 88.70:  15%|█▌        | 3/20 [01:24<05:58, 21.08s/it]
Task 2, Epoch 4/20 => Loss 1.836, Train_accy 88.70:  20%|██        | 4/20 [01:24<05:33, 20.84s/it]
Task 2, Epoch 5/20 => Loss 1.769, Train_accy 90.42:  20%|██        | 4/20 [01:44<05:33, 20.84s/it]
Task 2, Epoch 5/20 => Loss 1.769, Train_accy 90.42:  25%|██▌       | 5/20 [01:44<05:10, 20.69s/it]
Task 2, Epoch 6/20 => Loss 1.776, Train_accy 90.42, Test_accy 90.77:  25%|██▌       | 5/20 [02:08<05:10, 20.69s/it]
Task 2, Epoch 6/20 => Loss 1.776, Train_accy 90.42, Test_accy 90.77:  30%|███       | 6/20 [02:08<05:01, 21.51s/it]
Task 2, Epoch 7/20 => Loss 1.710, Train_accy 92.08:  30%|███       | 6/20 [02:28<05:01, 21.51s/it]                 
Task 2, Epoch 7/20 => Loss 1.710, Train_accy 92.08:  35%|███▌      | 7/20 [02:28<04:35, 21.17s/it]
Task 2, Epoch 8/20 => Loss 1.730, Train_accy 91.97:  35%|███▌      | 7/20 [02:49<04:35, 21.17s/it]
Task 2, Epoch 8/20 => Loss 1.730, Train_accy 91.97:  40%|████      | 8/20 [02:49<04:11, 20.96s/it]
Task 2, Epoch 9/20 => Loss 1.691, Train_accy 92.20:  40%|████      | 8/20 [03:09<04:11, 20.96s/it]
Task 2, Epoch 9/20 => Loss 1.691, Train_accy 92.20:  45%|████▌     | 9/20 [03:09<03:48, 20.78s/it]
Task 2, Epoch 10/20 => Loss 1.677, Train_accy 93.06:  45%|████▌     | 9/20 [03:29<03:48, 20.78s/it]
Task 2, Epoch 10/20 => Loss 1.677, Train_accy 93.06:  50%|█████     | 10/20 [03:29<03:26, 20.66s/it]
Task 2, Epoch 11/20 => Loss 1.665, Train_accy 93.40, Test_accy 92.41:  50%|█████     | 10/20 [03:52<03:26, 20.66s/it]
Task 2, Epoch 11/20 => Loss 1.665, Train_accy 93.40, Test_accy 92.41:  55%|█████▌    | 11/20 [03:52<03:12, 21.40s/it]
Task 2, Epoch 12/20 => Loss 1.658, Train_accy 93.57:  55%|█████▌    | 11/20 [04:13<03:12, 21.40s/it]                 
Task 2, Epoch 12/20 => Loss 1.658, Train_accy 93.57:  60%|██████    | 12/20 [04:13<02:48, 21.09s/it]
Task 2, Epoch 13/20 => Loss 1.639, Train_accy 93.46:  60%|██████    | 12/20 [04:33<02:48, 21.09s/it]
Task 2, Epoch 13/20 => Loss 1.639, Train_accy 93.46:  65%|██████▌   | 13/20 [04:33<02:26, 20.90s/it]
Task 2, Epoch 14/20 => Loss 1.656, Train_accy 93.63:  65%|██████▌   | 13/20 [04:54<02:26, 20.90s/it]
Task 2, Epoch 14/20 => Loss 1.656, Train_accy 93.63:  70%|███████   | 14/20 [04:54<02:04, 20.77s/it]
Task 2, Epoch 15/20 => Loss 1.679, Train_accy 93.12:  70%|███████   | 14/20 [05:14<02:04, 20.77s/it]
Task 2, Epoch 15/20 => Loss 1.679, Train_accy 93.12:  75%|███████▌  | 15/20 [05:14<01:43, 20.69s/it]
Task 2, Epoch 16/20 => Loss 1.609, Train_accy 93.92, Test_accy 90.92:  75%|███████▌  | 15/20 [05:37<01:43, 20.69s/it]
Task 2, Epoch 16/20 => Loss 1.609, Train_accy 93.92, Test_accy 90.92:  80%|████████  | 16/20 [05:37<01:25, 21.42s/it]
Task 2, Epoch 17/20 => Loss 1.711, Train_accy 92.71:  80%|████████  | 16/20 [05:58<01:25, 21.42s/it]                 
Task 2, Epoch 17/20 => Loss 1.711, Train_accy 92.71:  85%|████████▌ | 17/20 [05:58<01:03, 21.13s/it]
Task 2, Epoch 18/20 => Loss 1.576, Train_accy 95.30:  85%|████████▌ | 17/20 [06:18<01:03, 21.13s/it]
Task 2, Epoch 18/20 => Loss 1.576, Train_accy 95.30:  90%|█████████ | 18/20 [06:18<00:41, 20.93s/it]
Task 2, Epoch 19/20 => Loss 1.627, Train_accy 93.40:  90%|█████████ | 18/20 [06:39<00:41, 20.93s/it]
Task 2, Epoch 19/20 => Loss 1.627, Train_accy 93.40:  95%|█████████▌| 19/20 [06:39<00:20, 20.79s/it]
Task 2, Epoch 20/20 => Loss 1.637, Train_accy 94.26:  95%|█████████▌| 19/20 [06:59<00:20, 20.79s/it]
Task 2, Epoch 20/20 => Loss 1.637, Train_accy 94.26: 100%|██████████| 20/20 [06:59<00:00, 20.68s/it]
Task 2, Epoch 20/20 => Loss 1.637, Train_accy 94.26: 100%|██████████| 20/20 [06:59<00:00, 20.98s/it]
2024-09-11 21:52:52,040 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.637, Train_accy 94.26
2024-09-11 21:52:52,043 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 21:53:27,816 [icarl.py] => Exemplar size: 1200
2024-09-11 21:53:27,816 [trainer.py] => CNN: {'total': 91.07, '00-19': 87.85, '20-39': 93.24, '40-59': 92.66, 'old': 90.31, 'new': 92.66}
2024-09-11 21:53:27,816 [trainer.py] => NME: {'total': 93.45, '00-19': 94.33, '20-39': 92.27, '40-59': 93.58, 'old': 93.39, 'new': 93.58}
2024-09-11 21:53:27,816 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07]
2024-09-11 21:53:27,816 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66]
2024-09-11 21:53:27,816 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45]
2024-09-11 21:53:27,816 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55]

Average Accuracy (CNN): 94.19
Average Accuracy (NME): 95.72
2024-09-11 21:53:27,816 [trainer.py] => Average Accuracy (CNN): 94.19
2024-09-11 21:53:27,816 [trainer.py] => Average Accuracy (NME): 95.72
2024-09-11 21:53:27,817 [trainer.py] => All params: 85844796
2024-09-11 21:53:27,817 [trainer.py] => Trainable params: 85844796
2024-09-11 21:53:27,818 [icarl.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.149, Train_accy 70.55, Test_accy 83.68:   0%|          | 0/20 [00:28<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.149, Train_accy 70.55, Test_accy 83.68:   5%|▌         | 1/20 [00:28<08:59, 28.41s/it]
Task 3, Epoch 2/20 => Loss 1.946, Train_accy 86.63:   5%|▌         | 1/20 [00:53<08:59, 28.41s/it]                 
Task 3, Epoch 2/20 => Loss 1.946, Train_accy 86.63:  10%|█         | 2/20 [00:53<07:54, 26.39s/it]
Task 3, Epoch 3/20 => Loss 1.838, Train_accy 89.84:  10%|█         | 2/20 [01:18<07:54, 26.39s/it]
Task 3, Epoch 3/20 => Loss 1.838, Train_accy 89.84:  15%|█▌        | 3/20 [01:18<07:16, 25.71s/it]
Task 3, Epoch 4/20 => Loss 1.862, Train_accy 90.59:  15%|█▌        | 3/20 [01:43<07:16, 25.71s/it]
Task 3, Epoch 4/20 => Loss 1.862, Train_accy 90.59:  20%|██        | 4/20 [01:43<06:47, 25.44s/it]
Task 3, Epoch 5/20 => Loss 1.838, Train_accy 91.24:  20%|██        | 4/20 [02:08<06:47, 25.44s/it]
Task 3, Epoch 5/20 => Loss 1.838, Train_accy 91.24:  25%|██▌       | 5/20 [02:08<06:19, 25.28s/it]
Task 3, Epoch 6/20 => Loss 1.781, Train_accy 91.94, Test_accy 88.57:  25%|██▌       | 5/20 [02:36<06:19, 25.28s/it]
Task 3, Epoch 6/20 => Loss 1.781, Train_accy 91.94, Test_accy 88.57:  30%|███       | 6/20 [02:36<06:08, 26.35s/it]
Task 3, Epoch 7/20 => Loss 1.762, Train_accy 91.66:  30%|███       | 6/20 [03:01<06:08, 26.35s/it]                 
Task 3, Epoch 7/20 => Loss 1.762, Train_accy 91.66:  35%|███▌      | 7/20 [03:01<05:36, 25.91s/it]
Task 3, Epoch 8/20 => Loss 1.761, Train_accy 92.26:  35%|███▌      | 7/20 [03:26<05:36, 25.91s/it]
Task 3, Epoch 8/20 => Loss 1.761, Train_accy 92.26:  40%|████      | 8/20 [03:26<05:07, 25.66s/it]
Task 3, Epoch 9/20 => Loss 1.766, Train_accy 92.59:  40%|████      | 8/20 [03:51<05:07, 25.66s/it]
Task 3, Epoch 9/20 => Loss 1.766, Train_accy 92.59:  45%|████▌     | 9/20 [03:51<04:39, 25.45s/it]
Task 3, Epoch 10/20 => Loss 1.696, Train_accy 94.08:  45%|████▌     | 9/20 [04:16<04:39, 25.45s/it]
Task 3, Epoch 10/20 => Loss 1.696, Train_accy 94.08:  50%|█████     | 10/20 [04:16<04:13, 25.33s/it]
Task 3, Epoch 11/20 => Loss 1.758, Train_accy 93.20, Test_accy 90.53:  50%|█████     | 10/20 [04:45<04:13, 25.33s/it]
Task 3, Epoch 11/20 => Loss 1.758, Train_accy 93.20, Test_accy 90.53:  55%|█████▌    | 11/20 [04:45<03:56, 26.31s/it]
Task 3, Epoch 12/20 => Loss 1.726, Train_accy 93.80:  55%|█████▌    | 11/20 [05:10<03:56, 26.31s/it]                 
Task 3, Epoch 12/20 => Loss 1.726, Train_accy 93.80:  60%|██████    | 12/20 [05:10<03:27, 25.94s/it]
Task 3, Epoch 13/20 => Loss 1.690, Train_accy 93.76:  60%|██████    | 12/20 [05:35<03:27, 25.94s/it]
Task 3, Epoch 13/20 => Loss 1.690, Train_accy 93.76:  65%|██████▌   | 13/20 [05:35<02:59, 25.68s/it]
Task 3, Epoch 14/20 => Loss 1.697, Train_accy 94.08:  65%|██████▌   | 13/20 [06:00<02:59, 25.68s/it]
Task 3, Epoch 14/20 => Loss 1.697, Train_accy 94.08:  70%|███████   | 14/20 [06:00<02:33, 25.52s/it]
Task 3, Epoch 15/20 => Loss 1.724, Train_accy 93.94:  70%|███████   | 14/20 [06:25<02:33, 25.52s/it]
Task 3, Epoch 15/20 => Loss 1.724, Train_accy 93.94:  75%|███████▌  | 15/20 [06:25<02:06, 25.38s/it]
Task 3, Epoch 16/20 => Loss 1.710, Train_accy 94.08, Test_accy 89.77:  75%|███████▌  | 15/20 [06:54<02:06, 25.38s/it]
Task 3, Epoch 16/20 => Loss 1.710, Train_accy 94.08, Test_accy 89.77:  80%|████████  | 16/20 [06:54<01:45, 26.30s/it]
Task 3, Epoch 17/20 => Loss 1.711, Train_accy 94.50:  80%|████████  | 16/20 [07:19<01:45, 26.30s/it]                 
Task 3, Epoch 17/20 => Loss 1.711, Train_accy 94.50:  85%|████████▌ | 17/20 [07:19<01:17, 25.93s/it]
Task 3, Epoch 18/20 => Loss 1.653, Train_accy 95.11:  85%|████████▌ | 17/20 [07:44<01:17, 25.93s/it]
Task 3, Epoch 18/20 => Loss 1.653, Train_accy 95.11:  90%|█████████ | 18/20 [07:44<00:51, 25.64s/it]
Task 3, Epoch 19/20 => Loss 1.722, Train_accy 94.50:  90%|█████████ | 18/20 [08:09<00:51, 25.64s/it]
Task 3, Epoch 19/20 => Loss 1.722, Train_accy 94.50:  95%|█████████▌| 19/20 [08:09<00:25, 25.54s/it]
Task 3, Epoch 20/20 => Loss 1.680, Train_accy 94.59:  95%|█████████▌| 19/20 [08:34<00:25, 25.54s/it]
Task 3, Epoch 20/20 => Loss 1.680, Train_accy 94.59: 100%|██████████| 20/20 [08:34<00:00, 25.40s/it]
Task 3, Epoch 20/20 => Loss 1.680, Train_accy 94.59: 100%|██████████| 20/20 [08:34<00:00, 25.73s/it]
2024-09-11 22:02:02,487 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.680, Train_accy 94.59
2024-09-11 22:02:02,488 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 22:02:46,460 [icarl.py] => Exemplar size: 1600
2024-09-11 22:02:46,461 [trainer.py] => CNN: {'total': 89.88, '00-19': 83.4, '20-39': 91.3, '40-59': 91.74, '60-79': 93.52, 'old': 88.54, 'new': 93.52}
2024-09-11 22:02:46,461 [trainer.py] => NME: {'total': 90.42, '00-19': 86.23, '20-39': 90.82, '40-59': 91.28, '60-79': 93.52, 'old': 89.29, 'new': 93.52}
2024-09-11 22:02:46,461 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07, 89.88]
2024-09-11 22:02:46,461 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 98.37]
2024-09-11 22:02:46,461 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45, 90.42]
2024-09-11 22:02:46,461 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55, 99.02]

Average Accuracy (CNN): 93.12
Average Accuracy (NME): 94.4
2024-09-11 22:02:46,461 [trainer.py] => Average Accuracy (CNN): 93.12
2024-09-11 22:02:46,461 [trainer.py] => Average Accuracy (NME): 94.4
2024-09-11 22:02:46,462 [trainer.py] => All params: 85860176
2024-09-11 22:02:46,463 [trainer.py] => Trainable params: 85860176
2024-09-11 22:02:46,465 [icarl.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.841, Train_accy 76.81, Test_accy 87.29:   0%|          | 0/20 [00:33<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.841, Train_accy 76.81, Test_accy 87.29:   5%|▌         | 1/20 [00:33<10:38, 33.59s/it]
Task 4, Epoch 2/20 => Loss 1.913, Train_accy 89.74:   5%|▌         | 1/20 [01:02<10:38, 33.59s/it]                 
Task 4, Epoch 2/20 => Loss 1.913, Train_accy 89.74:  10%|█         | 2/20 [01:02<09:19, 31.07s/it]
Task 4, Epoch 3/20 => Loss 1.896, Train_accy 90.53:  10%|█         | 2/20 [01:32<09:19, 31.07s/it]
Task 4, Epoch 3/20 => Loss 1.896, Train_accy 90.53:  15%|█▌        | 3/20 [01:32<08:33, 30.23s/it]
Task 4, Epoch 4/20 => Loss 1.898, Train_accy 90.81:  15%|█▌        | 3/20 [02:01<08:33, 30.23s/it]
Task 4, Epoch 4/20 => Loss 1.898, Train_accy 90.81:  20%|██        | 4/20 [02:01<07:57, 29.87s/it]
Task 4, Epoch 5/20 => Loss 1.867, Train_accy 91.49:  20%|██        | 4/20 [02:30<07:57, 29.87s/it]
Task 4, Epoch 5/20 => Loss 1.867, Train_accy 91.49:  25%|██▌       | 5/20 [02:30<07:25, 29.67s/it]
Task 4, Epoch 6/20 => Loss 1.807, Train_accy 93.16, Test_accy 88.89:  25%|██▌       | 5/20 [03:04<07:25, 29.67s/it]
Task 4, Epoch 6/20 => Loss 1.807, Train_accy 93.16, Test_accy 88.89:  30%|███       | 6/20 [03:04<07:13, 30.99s/it]
Task 4, Epoch 7/20 => Loss 1.861, Train_accy 92.44:  30%|███       | 6/20 [03:33<07:13, 30.99s/it]                 
Task 4, Epoch 7/20 => Loss 1.861, Train_accy 92.44:  35%|███▌      | 7/20 [03:33<06:35, 30.41s/it]
Task 4, Epoch 8/20 => Loss 1.807, Train_accy 93.04:  35%|███▌      | 7/20 [04:02<06:35, 30.41s/it]
Task 4, Epoch 8/20 => Loss 1.807, Train_accy 93.04:  40%|████      | 8/20 [04:02<06:00, 30.05s/it]
Task 4, Epoch 9/20 => Loss 1.865, Train_accy 92.48:  40%|████      | 8/20 [04:32<06:00, 30.05s/it]
Task 4, Epoch 9/20 => Loss 1.865, Train_accy 92.48:  45%|████▌     | 9/20 [04:32<05:28, 29.85s/it]
Task 4, Epoch 10/20 => Loss 1.827, Train_accy 93.32:  45%|████▌     | 9/20 [05:01<05:28, 29.85s/it]
Task 4, Epoch 10/20 => Loss 1.827, Train_accy 93.32:  50%|█████     | 10/20 [05:01<04:56, 29.69s/it]
Task 4, Epoch 11/20 => Loss 1.777, Train_accy 93.87, Test_accy 88.13:  50%|█████     | 10/20 [05:35<04:56, 29.69s/it]
Task 4, Epoch 11/20 => Loss 1.777, Train_accy 93.87, Test_accy 88.13:  55%|█████▌    | 11/20 [05:35<04:38, 30.91s/it]
Task 4, Epoch 12/20 => Loss 1.746, Train_accy 94.63:  55%|█████▌    | 11/20 [06:04<04:38, 30.91s/it]                 
Task 4, Epoch 12/20 => Loss 1.746, Train_accy 94.63:  60%|██████    | 12/20 [06:04<04:03, 30.45s/it]
Task 4, Epoch 13/20 => Loss 1.750, Train_accy 94.11:  60%|██████    | 12/20 [06:33<04:03, 30.45s/it]
Task 4, Epoch 13/20 => Loss 1.750, Train_accy 94.11:  65%|██████▌   | 13/20 [06:33<03:30, 30.11s/it]
Task 4, Epoch 14/20 => Loss 1.759, Train_accy 94.23:  65%|██████▌   | 13/20 [07:03<03:30, 30.11s/it]
Task 4, Epoch 14/20 => Loss 1.759, Train_accy 94.23:  70%|███████   | 14/20 [07:03<02:59, 29.85s/it]
Task 4, Epoch 15/20 => Loss 1.719, Train_accy 95.39:  70%|███████   | 14/20 [07:32<02:59, 29.85s/it]
Task 4, Epoch 15/20 => Loss 1.719, Train_accy 95.39:  75%|███████▌  | 15/20 [07:32<02:28, 29.67s/it]
Task 4, Epoch 16/20 => Loss 1.771, Train_accy 94.43, Test_accy 88.55:  75%|███████▌  | 15/20 [08:06<02:28, 29.67s/it]
Task 4, Epoch 16/20 => Loss 1.771, Train_accy 94.43, Test_accy 88.55:  80%|████████  | 16/20 [08:06<02:03, 30.88s/it]
Task 4, Epoch 17/20 => Loss 1.747, Train_accy 94.79:  80%|████████  | 16/20 [08:35<02:03, 30.88s/it]                 
Task 4, Epoch 17/20 => Loss 1.747, Train_accy 94.79:  85%|████████▌ | 17/20 [08:35<01:31, 30.37s/it]
Task 4, Epoch 18/20 => Loss 1.756, Train_accy 94.19:  85%|████████▌ | 17/20 [09:04<01:31, 30.37s/it]
Task 4, Epoch 18/20 => Loss 1.756, Train_accy 94.19:  90%|█████████ | 18/20 [09:04<01:00, 30.00s/it]
Task 4, Epoch 19/20 => Loss 1.733, Train_accy 94.99:  90%|█████████ | 18/20 [09:33<01:00, 30.00s/it]
Task 4, Epoch 19/20 => Loss 1.733, Train_accy 94.99:  95%|█████████▌| 19/20 [09:33<00:29, 29.74s/it]
Task 4, Epoch 20/20 => Loss 1.729, Train_accy 94.43:  95%|█████████▌| 19/20 [10:02<00:29, 29.74s/it]
Task 4, Epoch 20/20 => Loss 1.729, Train_accy 94.43: 100%|██████████| 20/20 [10:02<00:00, 29.58s/it]
Task 4, Epoch 20/20 => Loss 1.729, Train_accy 94.43: 100%|██████████| 20/20 [10:02<00:00, 30.14s/it]
2024-09-11 22:12:49,281 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.729, Train_accy 94.43
2024-09-11 22:12:49,282 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 22:13:41,500 [icarl.py] => Exemplar size: 2000
2024-09-11 22:13:41,500 [trainer.py] => CNN: {'total': 89.39, '00-19': 84.21, '20-39': 87.44, '40-59': 90.83, '60-79': 89.88, '80-99': 94.05, 'old': 88.03, 'new': 94.05}
2024-09-11 22:13:41,500 [trainer.py] => NME: {'total': 89.9, '00-19': 85.43, '20-39': 89.37, '40-59': 92.66, '60-79': 89.88, '80-99': 92.19, 'old': 89.23, 'new': 92.19}
2024-09-11 22:13:41,500 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07, 89.88, 89.39]
2024-09-11 22:13:41,500 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 98.37, 98.06]
2024-09-11 22:13:41,500 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45, 90.42, 89.9]
2024-09-11 22:13:41,500 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55, 99.02, 98.74]

Average Accuracy (CNN): 92.37
Average Accuracy (NME): 93.5
2024-09-11 22:13:41,500 [trainer.py] => Average Accuracy (CNN): 92.37
2024-09-11 22:13:41,500 [trainer.py] => Average Accuracy (NME): 93.5
2024-09-11 22:13:41,501 [trainer.py] => All params: 85875556
2024-09-11 22:13:41,501 [trainer.py] => Trainable params: 85875556
2024-09-11 22:13:41,503 [icarl.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.747, Train_accy 78.66, Test_accy 84.53:   0%|          | 0/20 [00:39<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.747, Train_accy 78.66, Test_accy 84.53:   5%|▌         | 1/20 [00:39<12:27, 39.34s/it]
Task 5, Epoch 2/20 => Loss 2.024, Train_accy 88.89:   5%|▌         | 1/20 [01:13<12:27, 39.34s/it]                 
Task 5, Epoch 2/20 => Loss 2.024, Train_accy 88.89:  10%|█         | 2/20 [01:13<10:54, 36.38s/it]
Task 5, Epoch 3/20 => Loss 1.938, Train_accy 91.09:  10%|█         | 2/20 [01:47<10:54, 36.38s/it]
Task 5, Epoch 3/20 => Loss 1.938, Train_accy 91.09:  15%|█▌        | 3/20 [01:47<10:01, 35.36s/it]
Task 5, Epoch 4/20 => Loss 1.940, Train_accy 91.60:  15%|█▌        | 3/20 [02:21<10:01, 35.36s/it]
Task 5, Epoch 4/20 => Loss 1.940, Train_accy 91.60:  20%|██        | 4/20 [02:21<09:18, 34.90s/it]
Task 5, Epoch 5/20 => Loss 1.924, Train_accy 92.82:  20%|██        | 4/20 [02:56<09:18, 34.90s/it]
Task 5, Epoch 5/20 => Loss 1.924, Train_accy 92.82:  25%|██▌       | 5/20 [02:56<08:39, 34.63s/it]
Task 5, Epoch 6/20 => Loss 1.888, Train_accy 92.99, Test_accy 86.94:  25%|██▌       | 5/20 [03:35<08:39, 34.63s/it]
Task 5, Epoch 6/20 => Loss 1.888, Train_accy 92.99, Test_accy 86.94:  30%|███       | 6/20 [03:35<08:27, 36.25s/it]
Task 5, Epoch 7/20 => Loss 1.883, Train_accy 93.97:  30%|███       | 6/20 [04:09<08:27, 36.25s/it]                 
Task 5, Epoch 7/20 => Loss 1.883, Train_accy 93.97:  35%|███▌      | 7/20 [04:09<07:42, 35.61s/it]
Task 5, Epoch 8/20 => Loss 1.850, Train_accy 93.94:  35%|███▌      | 7/20 [04:44<07:42, 35.61s/it]
Task 5, Epoch 8/20 => Loss 1.850, Train_accy 93.94:  40%|████      | 8/20 [04:44<07:02, 35.22s/it]
Task 5, Epoch 9/20 => Loss 1.898, Train_accy 92.92:  40%|████      | 8/20 [05:18<07:02, 35.22s/it]
Task 5, Epoch 9/20 => Loss 1.898, Train_accy 92.92:  45%|████▌     | 9/20 [05:18<06:23, 34.91s/it]
Task 5, Epoch 10/20 => Loss 1.918, Train_accy 93.22:  45%|████▌     | 9/20 [05:52<06:23, 34.91s/it]
Task 5, Epoch 10/20 => Loss 1.918, Train_accy 93.22:  50%|█████     | 10/20 [05:52<05:47, 34.75s/it]
Task 5, Epoch 11/20 => Loss 1.856, Train_accy 93.97, Test_accy 85.73:  50%|█████     | 10/20 [06:32<05:47, 34.75s/it]
Task 5, Epoch 11/20 => Loss 1.856, Train_accy 93.97, Test_accy 85.73:  55%|█████▌    | 11/20 [06:32<05:25, 36.15s/it]
Task 5, Epoch 12/20 => Loss 1.865, Train_accy 94.65:  55%|█████▌    | 11/20 [07:06<05:25, 36.15s/it]                 
Task 5, Epoch 12/20 => Loss 1.865, Train_accy 94.65:  60%|██████    | 12/20 [07:06<04:44, 35.61s/it]
Task 5, Epoch 13/20 => Loss 1.883, Train_accy 93.77:  60%|██████    | 12/20 [07:40<04:44, 35.61s/it]
Task 5, Epoch 13/20 => Loss 1.883, Train_accy 93.77:  65%|██████▌   | 13/20 [07:40<04:06, 35.19s/it]
Task 5, Epoch 14/20 => Loss 1.881, Train_accy 93.53:  65%|██████▌   | 13/20 [08:15<04:06, 35.19s/it]
Task 5, Epoch 14/20 => Loss 1.881, Train_accy 93.53:  70%|███████   | 14/20 [08:15<03:29, 34.95s/it]
Task 5, Epoch 15/20 => Loss 1.843, Train_accy 94.99:  70%|███████   | 14/20 [08:49<03:29, 34.95s/it]
Task 5, Epoch 15/20 => Loss 1.843, Train_accy 94.99:  75%|███████▌  | 15/20 [08:49<02:53, 34.80s/it]
Task 5, Epoch 16/20 => Loss 1.839, Train_accy 94.85, Test_accy 86.86:  75%|███████▌  | 15/20 [09:29<02:53, 34.80s/it]
Task 5, Epoch 16/20 => Loss 1.839, Train_accy 94.85, Test_accy 86.86:  80%|████████  | 16/20 [09:29<02:24, 36.25s/it]
Task 5, Epoch 17/20 => Loss 1.839, Train_accy 94.95:  80%|████████  | 16/20 [10:03<02:24, 36.25s/it]                 
Task 5, Epoch 17/20 => Loss 1.839, Train_accy 94.95:  85%|████████▌ | 17/20 [10:03<01:47, 35.73s/it]
Task 5, Epoch 18/20 => Loss 1.798, Train_accy 95.46:  85%|████████▌ | 17/20 [10:38<01:47, 35.73s/it]
Task 5, Epoch 18/20 => Loss 1.798, Train_accy 95.46:  90%|█████████ | 18/20 [10:38<01:10, 35.32s/it]
Task 5, Epoch 19/20 => Loss 1.843, Train_accy 94.28:  90%|█████████ | 18/20 [11:12<01:10, 35.32s/it]
Task 5, Epoch 19/20 => Loss 1.843, Train_accy 94.28:  95%|█████████▌| 19/20 [11:12<00:35, 35.05s/it]
Task 5, Epoch 20/20 => Loss 1.819, Train_accy 95.49:  95%|█████████▌| 19/20 [11:47<00:35, 35.05s/it]
Task 5, Epoch 20/20 => Loss 1.819, Train_accy 95.49: 100%|██████████| 20/20 [11:47<00:00, 34.90s/it]
Task 5, Epoch 20/20 => Loss 1.819, Train_accy 95.49: 100%|██████████| 20/20 [11:47<00:00, 35.35s/it]
2024-09-11 22:25:28,564 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.819, Train_accy 95.49
2024-09-11 22:25:28,565 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 22:26:33,951 [icarl.py] => Exemplar size: 2400
2024-09-11 22:26:33,952 [trainer.py] => CNN: {'total': 86.09, '00-19': 81.38, '20-39': 83.57, '40-59': 84.4, '60-79': 86.23, '80-99': 90.33, '100-119': 89.91, 'old': 85.35, 'new': 89.91}
2024-09-11 22:26:33,952 [trainer.py] => NME: {'total': 89.12, '00-19': 86.23, '20-39': 89.86, '40-59': 91.28, '60-79': 87.45, '80-99': 91.08, '100-119': 89.04, 'old': 89.14, 'new': 89.04}
2024-09-11 22:26:33,952 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07, 89.88, 89.39, 86.09]
2024-09-11 22:26:33,952 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 98.37, 98.06, 97.39]
2024-09-11 22:26:33,952 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45, 90.42, 89.9, 89.12]
2024-09-11 22:26:33,952 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55, 99.02, 98.74, 98.8]

Average Accuracy (CNN): 91.32
Average Accuracy (NME): 92.77
2024-09-11 22:26:33,952 [trainer.py] => Average Accuracy (CNN): 91.32
2024-09-11 22:26:33,952 [trainer.py] => Average Accuracy (NME): 92.77
2024-09-11 22:26:33,952 [trainer.py] => All params: 85890936
2024-09-11 22:26:33,953 [trainer.py] => Trainable params: 85890936
2024-09-11 22:26:33,955 [icarl.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.758, Train_accy 79.82, Test_accy 83.55:   0%|          | 0/20 [00:44<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.758, Train_accy 79.82, Test_accy 83.55:   5%|▌         | 1/20 [00:44<14:08, 44.67s/it]
Task 6, Epoch 2/20 => Loss 2.080, Train_accy 89.09:   5%|▌         | 1/20 [01:23<14:08, 44.67s/it]                 
Task 6, Epoch 2/20 => Loss 2.080, Train_accy 89.09:  10%|█         | 2/20 [01:23<12:24, 41.34s/it]
Task 6, Epoch 3/20 => Loss 1.995, Train_accy 91.92:  10%|█         | 2/20 [02:02<12:24, 41.34s/it]
Task 6, Epoch 3/20 => Loss 1.995, Train_accy 91.92:  15%|█▌        | 3/20 [02:02<11:23, 40.18s/it]
Task 6, Epoch 4/20 => Loss 1.953, Train_accy 92.73:  15%|█▌        | 3/20 [02:41<11:23, 40.18s/it]
Task 6, Epoch 4/20 => Loss 1.953, Train_accy 92.73:  20%|██        | 4/20 [02:41<10:35, 39.69s/it]
Task 6, Epoch 5/20 => Loss 1.902, Train_accy 93.17:  20%|██        | 4/20 [03:20<10:35, 39.69s/it]
Task 6, Epoch 5/20 => Loss 1.902, Train_accy 93.17:  25%|██▌       | 5/20 [03:20<09:51, 39.46s/it]
Task 6, Epoch 6/20 => Loss 1.909, Train_accy 93.38, Test_accy 84.40:  25%|██▌       | 5/20 [04:05<09:51, 39.46s/it]
Task 6, Epoch 6/20 => Loss 1.909, Train_accy 93.38, Test_accy 84.40:  30%|███       | 6/20 [04:05<09:38, 41.29s/it]
Task 6, Epoch 7/20 => Loss 1.942, Train_accy 93.41:  30%|███       | 6/20 [04:44<09:38, 41.29s/it]                 
Task 6, Epoch 7/20 => Loss 1.942, Train_accy 93.41:  35%|███▌      | 7/20 [04:44<08:48, 40.65s/it]
Task 6, Epoch 8/20 => Loss 1.909, Train_accy 94.16:  35%|███▌      | 7/20 [05:23<08:48, 40.65s/it]
Task 6, Epoch 8/20 => Loss 1.909, Train_accy 94.16:  40%|████      | 8/20 [05:23<08:01, 40.13s/it]
Task 6, Epoch 9/20 => Loss 1.950, Train_accy 93.44:  40%|████      | 8/20 [06:02<08:01, 40.13s/it]
Task 6, Epoch 9/20 => Loss 1.950, Train_accy 93.44:  45%|████▌     | 9/20 [06:02<07:17, 39.78s/it]
Task 6, Epoch 10/20 => Loss 1.894, Train_accy 94.60:  45%|████▌     | 9/20 [06:41<07:17, 39.78s/it]
Task 6, Epoch 10/20 => Loss 1.894, Train_accy 94.60:  50%|█████     | 10/20 [06:41<06:36, 39.61s/it]
Task 6, Epoch 11/20 => Loss 1.884, Train_accy 94.42, Test_accy 86.41:  50%|█████     | 10/20 [07:27<06:36, 39.61s/it]
Task 6, Epoch 11/20 => Loss 1.884, Train_accy 94.42, Test_accy 86.41:  55%|█████▌    | 11/20 [07:27<06:12, 41.34s/it]
Task 6, Epoch 12/20 => Loss 1.871, Train_accy 94.45:  55%|█████▌    | 11/20 [08:06<06:12, 41.34s/it]                 
Task 6, Epoch 12/20 => Loss 1.871, Train_accy 94.45:  60%|██████    | 12/20 [08:06<05:25, 40.68s/it]
Task 6, Epoch 13/20 => Loss 1.886, Train_accy 94.01:  60%|██████    | 12/20 [08:45<05:25, 40.68s/it]
Task 6, Epoch 13/20 => Loss 1.886, Train_accy 94.01:  65%|██████▌   | 13/20 [08:45<04:42, 40.32s/it]
Task 6, Epoch 14/20 => Loss 1.895, Train_accy 94.45:  65%|██████▌   | 13/20 [09:25<04:42, 40.32s/it]
Task 6, Epoch 14/20 => Loss 1.895, Train_accy 94.45:  70%|███████   | 14/20 [09:25<03:59, 40.00s/it]
Task 6, Epoch 15/20 => Loss 1.944, Train_accy 94.04:  70%|███████   | 14/20 [10:04<03:59, 40.00s/it]
Task 6, Epoch 15/20 => Loss 1.944, Train_accy 94.04:  75%|███████▌  | 15/20 [10:04<03:18, 39.79s/it]
Task 6, Epoch 16/20 => Loss 1.904, Train_accy 94.25, Test_accy 84.70:  75%|███████▌  | 15/20 [10:49<03:18, 39.79s/it]
Task 6, Epoch 16/20 => Loss 1.904, Train_accy 94.25, Test_accy 84.70:  80%|████████  | 16/20 [10:49<02:45, 41.38s/it]
Task 6, Epoch 17/20 => Loss 1.835, Train_accy 95.68:  80%|████████  | 16/20 [11:28<02:45, 41.38s/it]                 
Task 6, Epoch 17/20 => Loss 1.835, Train_accy 95.68:  85%|████████▌ | 17/20 [11:28<02:02, 40.76s/it]
Task 6, Epoch 18/20 => Loss 1.890, Train_accy 94.99:  85%|████████▌ | 17/20 [12:08<02:02, 40.76s/it]
Task 6, Epoch 18/20 => Loss 1.890, Train_accy 94.99:  90%|█████████ | 18/20 [12:08<01:20, 40.32s/it]
Task 6, Epoch 19/20 => Loss 1.890, Train_accy 94.69:  90%|█████████ | 18/20 [12:47<01:20, 40.32s/it]
Task 6, Epoch 19/20 => Loss 1.890, Train_accy 94.69:  95%|█████████▌| 19/20 [12:47<00:40, 40.00s/it]
Task 6, Epoch 20/20 => Loss 1.867, Train_accy 95.23:  95%|█████████▌| 19/20 [13:26<00:40, 40.00s/it]
Task 6, Epoch 20/20 => Loss 1.867, Train_accy 95.23: 100%|██████████| 20/20 [13:26<00:00, 39.79s/it]
Task 6, Epoch 20/20 => Loss 1.867, Train_accy 95.23: 100%|██████████| 20/20 [13:26<00:00, 40.33s/it]
2024-09-11 22:40:00,605 [icarl.py] => Task 6, Epoch 20/20 => Loss 1.867, Train_accy 95.23
2024-09-11 22:40:00,607 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 22:41:10,411 [icarl.py] => Exemplar size: 2800
2024-09-11 22:41:10,411 [trainer.py] => CNN: {'total': 85.37, '00-19': 81.38, '20-39': 84.54, '40-59': 81.65, '60-79': 83.4, '80-99': 86.99, '100-119': 89.91, '120-139': 89.78, 'old': 84.68, 'new': 89.78}
2024-09-11 22:41:10,411 [trainer.py] => NME: {'total': 87.32, '00-19': 83.81, '20-39': 88.41, '40-59': 88.99, '60-79': 85.43, '80-99': 90.71, '100-119': 89.04, '120-139': 84.89, 'old': 87.71, 'new': 84.89}
2024-09-11 22:41:10,411 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07, 89.88, 89.39, 86.09, 85.37]
2024-09-11 22:41:10,411 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 98.37, 98.06, 97.39, 97.32]
2024-09-11 22:41:10,411 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45, 90.42, 89.9, 89.12, 87.32]
2024-09-11 22:41:10,411 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55, 99.02, 98.74, 98.8, 98.42]

Average Accuracy (CNN): 90.47
Average Accuracy (NME): 91.99
2024-09-11 22:41:10,411 [trainer.py] => Average Accuracy (CNN): 90.47
2024-09-11 22:41:10,411 [trainer.py] => Average Accuracy (NME): 91.99
2024-09-11 22:41:10,412 [trainer.py] => All params: 85906316
2024-09-11 22:41:10,412 [trainer.py] => Trainable params: 85906316
2024-09-11 22:41:10,414 [icarl.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.755, Train_accy 81.53, Test_accy 81.97:   0%|          | 0/20 [00:49<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.755, Train_accy 81.53, Test_accy 81.97:   5%|▌         | 1/20 [00:49<15:47, 49.89s/it]
Task 7, Epoch 2/20 => Loss 2.109, Train_accy 91.21:   5%|▌         | 1/20 [01:33<15:47, 49.89s/it]                 
Task 7, Epoch 2/20 => Loss 2.109, Train_accy 91.21:  10%|█         | 2/20 [01:33<13:49, 46.06s/it]
Task 7, Epoch 3/20 => Loss 2.072, Train_accy 92.45:  10%|█         | 2/20 [02:16<13:49, 46.06s/it]
Task 7, Epoch 3/20 => Loss 2.072, Train_accy 92.45:  15%|█▌        | 3/20 [02:16<12:41, 44.80s/it]
Task 7, Epoch 4/20 => Loss 2.021, Train_accy 93.15:  15%|█▌        | 3/20 [03:00<12:41, 44.80s/it]
Task 7, Epoch 4/20 => Loss 2.021, Train_accy 93.15:  20%|██        | 4/20 [03:00<11:48, 44.27s/it]
Task 7, Epoch 5/20 => Loss 2.028, Train_accy 93.39:  20%|██        | 4/20 [03:43<11:48, 44.27s/it]
Task 7, Epoch 5/20 => Loss 2.028, Train_accy 93.39:  25%|██▌       | 5/20 [03:43<10:59, 44.00s/it]
Task 7, Epoch 6/20 => Loss 2.034, Train_accy 93.31, Test_accy 83.92:  25%|██▌       | 5/20 [04:33<10:59, 44.00s/it]
Task 7, Epoch 6/20 => Loss 2.034, Train_accy 93.31, Test_accy 83.92:  30%|███       | 6/20 [04:33<10:45, 46.10s/it]
Task 7, Epoch 7/20 => Loss 1.974, Train_accy 94.38:  30%|███       | 6/20 [05:17<10:45, 46.10s/it]                 
Task 7, Epoch 7/20 => Loss 1.974, Train_accy 94.38:  35%|███▌      | 7/20 [05:17<09:48, 45.24s/it]
Task 7, Epoch 8/20 => Loss 1.956, Train_accy 93.87:  35%|███▌      | 7/20 [06:00<09:48, 45.24s/it]
Task 7, Epoch 8/20 => Loss 1.956, Train_accy 93.87:  40%|████      | 8/20 [06:00<08:55, 44.66s/it]
Task 7, Epoch 9/20 => Loss 1.996, Train_accy 94.27:  40%|████      | 8/20 [06:44<08:55, 44.66s/it]
Task 7, Epoch 9/20 => Loss 1.996, Train_accy 94.27:  45%|████▌     | 9/20 [06:44<08:06, 44.27s/it]
Task 7, Epoch 10/20 => Loss 1.986, Train_accy 94.27:  45%|████▌     | 9/20 [07:27<08:06, 44.27s/it]
Task 7, Epoch 10/20 => Loss 1.986, Train_accy 94.27:  50%|█████     | 10/20 [07:27<07:20, 44.03s/it]
Task 7, Epoch 11/20 => Loss 1.965, Train_accy 94.49, Test_accy 83.40:  50%|█████     | 10/20 [08:17<07:20, 44.03s/it]
Task 7, Epoch 11/20 => Loss 1.965, Train_accy 94.49, Test_accy 83.40:  55%|█████▌    | 11/20 [08:17<06:52, 45.82s/it]
Task 7, Epoch 12/20 => Loss 1.933, Train_accy 95.08:  55%|█████▌    | 11/20 [09:00<06:52, 45.82s/it]                 
Task 7, Epoch 12/20 => Loss 1.933, Train_accy 95.08:  60%|██████    | 12/20 [09:00<06:00, 45.08s/it]
Task 7, Epoch 13/20 => Loss 1.968, Train_accy 94.65:  60%|██████    | 12/20 [09:44<06:00, 45.08s/it]
Task 7, Epoch 13/20 => Loss 1.968, Train_accy 94.65:  65%|██████▌   | 13/20 [09:44<05:11, 44.57s/it]
Task 7, Epoch 14/20 => Loss 1.952, Train_accy 94.54:  65%|██████▌   | 13/20 [10:28<05:11, 44.57s/it]
Task 7, Epoch 14/20 => Loss 1.952, Train_accy 94.54:  70%|███████   | 14/20 [10:28<04:26, 44.37s/it]
Task 7, Epoch 15/20 => Loss 1.993, Train_accy 94.44:  70%|███████   | 14/20 [11:11<04:26, 44.37s/it]
Task 7, Epoch 15/20 => Loss 1.993, Train_accy 94.44:  75%|███████▌  | 15/20 [11:11<03:40, 44.16s/it]
Task 7, Epoch 16/20 => Loss 1.931, Train_accy 95.59, Test_accy 84.29:  75%|███████▌  | 15/20 [12:01<03:40, 44.16s/it]
Task 7, Epoch 16/20 => Loss 1.931, Train_accy 95.59, Test_accy 84.29:  80%|████████  | 16/20 [12:01<03:03, 45.82s/it]
Task 7, Epoch 17/20 => Loss 1.974, Train_accy 94.95:  80%|████████  | 16/20 [12:44<03:03, 45.82s/it]                 
Task 7, Epoch 17/20 => Loss 1.974, Train_accy 94.95:  85%|████████▌ | 17/20 [12:44<02:15, 45.01s/it]
Task 7, Epoch 18/20 => Loss 1.927, Train_accy 95.67:  85%|████████▌ | 17/20 [13:27<02:15, 45.01s/it]
Task 7, Epoch 18/20 => Loss 1.927, Train_accy 95.67:  90%|█████████ | 18/20 [13:27<01:28, 44.49s/it]
Task 7, Epoch 19/20 => Loss 1.920, Train_accy 96.02:  90%|█████████ | 18/20 [14:11<01:28, 44.49s/it]
Task 7, Epoch 19/20 => Loss 1.920, Train_accy 96.02:  95%|█████████▌| 19/20 [14:11<00:44, 44.22s/it]
Task 7, Epoch 20/20 => Loss 1.962, Train_accy 95.19:  95%|█████████▌| 19/20 [14:54<00:44, 44.22s/it]
Task 7, Epoch 20/20 => Loss 1.962, Train_accy 95.19: 100%|██████████| 20/20 [14:54<00:00, 43.95s/it]
Task 7, Epoch 20/20 => Loss 1.962, Train_accy 95.19: 100%|██████████| 20/20 [14:54<00:00, 44.74s/it]
2024-09-11 22:56:05,188 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.962, Train_accy 95.19
2024-09-11 22:56:05,190 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 22:57:23,380 [icarl.py] => Exemplar size: 3200
2024-09-11 22:57:23,381 [trainer.py] => CNN: {'total': 84.35, '00-19': 79.76, '20-39': 78.26, '40-59': 78.9, '60-79': 82.19, '80-99': 86.62, '100-119': 85.53, '120-139': 88.0, '140-159': 94.0, 'old': 82.88, 'new': 94.0}
2024-09-11 22:57:23,381 [trainer.py] => NME: {'total': 86.67, '00-19': 82.19, '20-39': 87.92, '40-59': 86.7, '60-79': 86.23, '80-99': 89.22, '100-119': 84.65, '120-139': 84.0, '140-159': 92.0, 'old': 85.86, 'new': 92.0}
2024-09-11 22:57:23,381 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07, 89.88, 89.39, 86.09, 85.37, 84.35]
2024-09-11 22:57:23,381 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 98.37, 98.06, 97.39, 97.32, 96.93]
2024-09-11 22:57:23,381 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45, 90.42, 89.9, 89.12, 87.32, 86.67]
2024-09-11 22:57:23,381 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55, 99.02, 98.74, 98.8, 98.42, 98.31]

Average Accuracy (CNN): 89.71
Average Accuracy (NME): 91.32
2024-09-11 22:57:23,381 [trainer.py] => Average Accuracy (CNN): 89.71
2024-09-11 22:57:23,381 [trainer.py] => Average Accuracy (NME): 91.32
2024-09-11 22:57:23,381 [trainer.py] => All params: 85921696
2024-09-11 22:57:23,382 [trainer.py] => Trainable params: 85921696
2024-09-11 22:57:23,384 [icarl.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.608, Train_accy 84.73, Test_accy 81.16:   0%|          | 0/20 [00:56<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.608, Train_accy 84.73, Test_accy 81.16:   5%|▌         | 1/20 [00:56<17:50, 56.36s/it]
Task 8, Epoch 2/20 => Loss 2.064, Train_accy 91.73:   5%|▌         | 1/20 [01:45<17:50, 56.36s/it]                 
Task 8, Epoch 2/20 => Loss 2.064, Train_accy 91.73:  10%|█         | 2/20 [01:45<15:40, 52.25s/it]
Task 8, Epoch 3/20 => Loss 2.057, Train_accy 92.76:  10%|█         | 2/20 [02:34<15:40, 52.25s/it]
Task 8, Epoch 3/20 => Loss 2.057, Train_accy 92.76:  15%|█▌        | 3/20 [02:34<14:24, 50.85s/it]
Task 8, Epoch 4/20 => Loss 2.044, Train_accy 93.15:  15%|█▌        | 3/20 [03:24<14:24, 50.85s/it]
Task 8, Epoch 4/20 => Loss 2.044, Train_accy 93.15:  20%|██        | 4/20 [03:24<13:23, 50.22s/it]
Task 8, Epoch 5/20 => Loss 2.021, Train_accy 93.72:  20%|██        | 4/20 [04:13<13:23, 50.22s/it]
Task 8, Epoch 5/20 => Loss 2.021, Train_accy 93.72:  25%|██▌       | 5/20 [04:13<12:28, 49.90s/it]
Task 8, Epoch 6/20 => Loss 1.995, Train_accy 94.42, Test_accy 82.14:  25%|██▌       | 5/20 [05:10<12:28, 49.90s/it]
Task 8, Epoch 6/20 => Loss 1.995, Train_accy 94.42, Test_accy 82.14:  30%|███       | 6/20 [05:10<12:11, 52.24s/it]
Task 8, Epoch 7/20 => Loss 1.966, Train_accy 94.71:  30%|███       | 6/20 [05:59<12:11, 52.24s/it]                 
Task 8, Epoch 7/20 => Loss 1.966, Train_accy 94.71:  35%|███▌      | 7/20 [05:59<11:07, 51.33s/it]
Task 8, Epoch 8/20 => Loss 2.034, Train_accy 94.28:  35%|███▌      | 7/20 [06:49<11:07, 51.33s/it]
Task 8, Epoch 8/20 => Loss 2.034, Train_accy 94.28:  40%|████      | 8/20 [06:49<10:08, 50.68s/it]
Task 8, Epoch 9/20 => Loss 2.001, Train_accy 94.83:  40%|████      | 8/20 [07:38<10:08, 50.68s/it]
Task 8, Epoch 9/20 => Loss 2.001, Train_accy 94.83:  45%|████▌     | 9/20 [07:38<09:14, 50.38s/it]
Task 8, Epoch 10/20 => Loss 1.977, Train_accy 95.21:  45%|████▌     | 9/20 [08:28<09:14, 50.38s/it]
Task 8, Epoch 10/20 => Loss 1.977, Train_accy 95.21:  50%|█████     | 10/20 [08:28<08:21, 50.15s/it]
Task 8, Epoch 11/20 => Loss 1.978, Train_accy 94.56, Test_accy 82.75:  50%|█████     | 10/20 [09:25<08:21, 50.15s/it]
Task 8, Epoch 11/20 => Loss 1.978, Train_accy 94.56, Test_accy 82.75:  55%|█████▌    | 11/20 [09:25<07:49, 52.17s/it]
Task 8, Epoch 12/20 => Loss 1.989, Train_accy 94.64:  55%|█████▌    | 11/20 [10:14<07:49, 52.17s/it]                 
Task 8, Epoch 12/20 => Loss 1.989, Train_accy 94.64:  60%|██████    | 12/20 [10:14<06:50, 51.35s/it]
Task 8, Epoch 13/20 => Loss 1.978, Train_accy 94.90:  60%|██████    | 12/20 [11:03<06:50, 51.35s/it]
Task 8, Epoch 13/20 => Loss 1.978, Train_accy 94.90:  65%|██████▌   | 13/20 [11:03<05:55, 50.76s/it]
Task 8, Epoch 14/20 => Loss 1.976, Train_accy 94.85:  65%|██████▌   | 13/20 [11:53<05:55, 50.76s/it]
Task 8, Epoch 14/20 => Loss 1.976, Train_accy 94.85:  70%|███████   | 14/20 [11:53<05:01, 50.29s/it]
Task 8, Epoch 15/20 => Loss 1.956, Train_accy 95.55:  70%|███████   | 14/20 [12:42<05:01, 50.29s/it]
Task 8, Epoch 15/20 => Loss 1.956, Train_accy 95.55:  75%|███████▌  | 15/20 [12:42<04:09, 49.97s/it]
Task 8, Epoch 16/20 => Loss 1.949, Train_accy 95.48, Test_accy 83.51:  75%|███████▌  | 15/20 [13:39<04:09, 49.97s/it]
Task 8, Epoch 16/20 => Loss 1.949, Train_accy 95.48, Test_accy 83.51:  80%|████████  | 16/20 [13:39<03:28, 52.07s/it]
Task 8, Epoch 17/20 => Loss 1.910, Train_accy 95.77:  80%|████████  | 16/20 [14:28<03:28, 52.07s/it]                 
Task 8, Epoch 17/20 => Loss 1.910, Train_accy 95.77:  85%|████████▌ | 17/20 [14:28<02:33, 51.22s/it]
Task 8, Epoch 18/20 => Loss 1.953, Train_accy 95.62:  85%|████████▌ | 17/20 [15:17<02:33, 51.22s/it]
Task 8, Epoch 18/20 => Loss 1.953, Train_accy 95.62:  90%|█████████ | 18/20 [15:17<01:41, 50.62s/it]
Task 8, Epoch 19/20 => Loss 1.989, Train_accy 95.07:  90%|█████████ | 18/20 [16:07<01:41, 50.62s/it]
Task 8, Epoch 19/20 => Loss 1.989, Train_accy 95.07:  95%|█████████▌| 19/20 [16:07<00:50, 50.19s/it]
Task 8, Epoch 20/20 => Loss 1.932, Train_accy 95.67:  95%|█████████▌| 19/20 [16:56<00:50, 50.19s/it]
Task 8, Epoch 20/20 => Loss 1.932, Train_accy 95.67: 100%|██████████| 20/20 [16:56<00:00, 49.88s/it]
Task 8, Epoch 20/20 => Loss 1.932, Train_accy 95.67: 100%|██████████| 20/20 [16:56<00:00, 50.81s/it]
2024-09-11 23:14:19,598 [icarl.py] => Task 8, Epoch 20/20 => Loss 1.932, Train_accy 95.67
2024-09-11 23:14:19,599 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 23:15:44,168 [icarl.py] => Exemplar size: 3600
2024-09-11 23:15:44,168 [trainer.py] => CNN: {'total': 83.27, '00-19': 78.14, '20-39': 79.23, '40-59': 77.98, '60-79': 79.35, '80-99': 84.01, '100-119': 85.96, '120-139': 84.89, '140-159': 87.2, '160-179': 91.98, 'old': 82.18, 'new': 91.98}
2024-09-11 23:15:44,168 [trainer.py] => NME: {'total': 86.04, '00-19': 81.38, '20-39': 87.44, '40-59': 86.7, '60-79': 86.64, '80-99': 89.22, '100-119': 84.21, '120-139': 81.78, '140-159': 88.4, '160-179': 88.19, 'old': 85.77, 'new': 88.19}
2024-09-11 23:15:44,168 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07, 89.88, 89.39, 86.09, 85.37, 84.35, 83.27]
2024-09-11 23:15:44,168 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 98.37, 98.06, 97.39, 97.32, 96.93, 96.43]
2024-09-11 23:15:44,168 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45, 90.42, 89.9, 89.12, 87.32, 86.67, 86.04]
2024-09-11 23:15:44,168 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55, 99.02, 98.74, 98.8, 98.42, 98.31, 98.07]

Average Accuracy (CNN): 88.99
Average Accuracy (NME): 90.74
2024-09-11 23:15:44,169 [trainer.py] => Average Accuracy (CNN): 88.99
2024-09-11 23:15:44,169 [trainer.py] => Average Accuracy (NME): 90.74
2024-09-11 23:15:44,169 [trainer.py] => All params: 85937076
2024-09-11 23:15:44,170 [trainer.py] => Trainable params: 85937076
2024-09-11 23:15:44,171 [icarl.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.625, Train_accy 86.12, Test_accy 80.07:   0%|          | 0/20 [01:02<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.625, Train_accy 86.12, Test_accy 80.07:   5%|▌         | 1/20 [01:02<19:38, 62.02s/it]
Task 9, Epoch 2/20 => Loss 2.168, Train_accy 92.31:   5%|▌         | 1/20 [01:55<19:38, 62.02s/it]                 
Task 9, Epoch 2/20 => Loss 2.168, Train_accy 92.31:  10%|█         | 2/20 [01:55<17:10, 57.27s/it]
Task 9, Epoch 3/20 => Loss 2.084, Train_accy 93.85:  10%|█         | 2/20 [02:49<17:10, 57.27s/it]
Task 9, Epoch 3/20 => Loss 2.084, Train_accy 93.85:  15%|█▌        | 3/20 [02:49<15:47, 55.75s/it]
Task 9, Epoch 4/20 => Loss 2.066, Train_accy 94.40:  15%|█▌        | 3/20 [03:44<15:47, 55.75s/it]
Task 9, Epoch 4/20 => Loss 2.066, Train_accy 94.40:  20%|██        | 4/20 [03:44<14:41, 55.11s/it]
Task 9, Epoch 5/20 => Loss 2.090, Train_accy 94.07:  20%|██        | 4/20 [04:37<14:41, 55.11s/it]
Task 9, Epoch 5/20 => Loss 2.090, Train_accy 94.07:  25%|██▌       | 5/20 [04:37<13:40, 54.69s/it]
Task 9, Epoch 6/20 => Loss 2.084, Train_accy 94.33, Test_accy 80.79:  25%|██▌       | 5/20 [05:39<13:40, 54.69s/it]
Task 9, Epoch 6/20 => Loss 2.084, Train_accy 94.33, Test_accy 80.79:  30%|███       | 6/20 [05:39<13:20, 57.18s/it]
Task 9, Epoch 7/20 => Loss 2.089, Train_accy 94.24:  30%|███       | 6/20 [06:33<13:20, 57.18s/it]                 
Task 9, Epoch 7/20 => Loss 2.089, Train_accy 94.24:  35%|███▌      | 7/20 [06:33<12:09, 56.14s/it]
Task 9, Epoch 8/20 => Loss 2.066, Train_accy 94.88:  35%|███▌      | 7/20 [07:27<12:09, 56.14s/it]
Task 9, Epoch 8/20 => Loss 2.066, Train_accy 94.88:  40%|████      | 8/20 [07:27<11:05, 55.44s/it]
Task 9, Epoch 9/20 => Loss 2.044, Train_accy 95.19:  40%|████      | 8/20 [08:21<11:05, 55.44s/it]
Task 9, Epoch 9/20 => Loss 2.044, Train_accy 95.19:  45%|████▌     | 9/20 [08:21<10:04, 55.00s/it]
Task 9, Epoch 10/20 => Loss 2.076, Train_accy 94.68:  45%|████▌     | 9/20 [09:15<10:04, 55.00s/it]
Task 9, Epoch 10/20 => Loss 2.076, Train_accy 94.68:  50%|█████     | 10/20 [09:15<09:06, 54.65s/it]
Task 9, Epoch 11/20 => Loss 2.104, Train_accy 94.77, Test_accy 81.38:  50%|█████     | 10/20 [10:17<09:06, 54.65s/it]
Task 9, Epoch 11/20 => Loss 2.104, Train_accy 94.77, Test_accy 81.38:  55%|█████▌    | 11/20 [10:17<08:32, 56.94s/it]
Task 9, Epoch 12/20 => Loss 2.098, Train_accy 94.55:  55%|█████▌    | 11/20 [11:11<08:32, 56.94s/it]                 
Task 9, Epoch 12/20 => Loss 2.098, Train_accy 94.55:  60%|██████    | 12/20 [11:11<07:28, 56.05s/it]
Task 9, Epoch 13/20 => Loss 2.027, Train_accy 95.52:  60%|██████    | 12/20 [12:05<07:28, 56.05s/it]
Task 9, Epoch 13/20 => Loss 2.027, Train_accy 95.52:  65%|██████▌   | 13/20 [12:05<06:27, 55.37s/it]
Task 9, Epoch 14/20 => Loss 2.045, Train_accy 95.25:  65%|██████▌   | 13/20 [12:59<06:27, 55.37s/it]
Task 9, Epoch 14/20 => Loss 2.045, Train_accy 95.25:  70%|███████   | 14/20 [12:59<05:29, 54.92s/it]
Task 9, Epoch 15/20 => Loss 2.056, Train_accy 95.43:  70%|███████   | 14/20 [13:54<05:29, 54.92s/it]
Task 9, Epoch 15/20 => Loss 2.056, Train_accy 95.43:  75%|███████▌  | 15/20 [13:54<04:33, 54.75s/it]
Task 9, Epoch 16/20 => Loss 2.075, Train_accy 95.63, Test_accy 81.13:  75%|███████▌  | 15/20 [14:56<04:33, 54.75s/it]
Task 9, Epoch 16/20 => Loss 2.075, Train_accy 95.63, Test_accy 81.13:  80%|████████  | 16/20 [14:56<03:47, 56.99s/it]
Task 9, Epoch 17/20 => Loss 1.990, Train_accy 96.09:  80%|████████  | 16/20 [15:50<03:47, 56.99s/it]                 
Task 9, Epoch 17/20 => Loss 1.990, Train_accy 96.09:  85%|████████▌ | 17/20 [15:50<02:48, 56.09s/it]
Task 9, Epoch 18/20 => Loss 2.034, Train_accy 95.67:  85%|████████▌ | 17/20 [16:44<02:48, 56.09s/it]
Task 9, Epoch 18/20 => Loss 2.034, Train_accy 95.67:  90%|█████████ | 18/20 [16:44<01:50, 55.41s/it]
Task 9, Epoch 19/20 => Loss 2.019, Train_accy 96.40:  90%|█████████ | 18/20 [17:38<01:50, 55.41s/it]
Task 9, Epoch 19/20 => Loss 2.019, Train_accy 96.40:  95%|█████████▌| 19/20 [17:38<00:54, 55.00s/it]
Task 9, Epoch 20/20 => Loss 2.001, Train_accy 96.18:  95%|█████████▌| 19/20 [18:32<00:54, 55.00s/it]
Task 9, Epoch 20/20 => Loss 2.001, Train_accy 96.18: 100%|██████████| 20/20 [18:32<00:00, 54.71s/it]
Task 9, Epoch 20/20 => Loss 2.001, Train_accy 96.18: 100%|██████████| 20/20 [18:32<00:00, 55.60s/it]
2024-09-11 23:34:16,281 [icarl.py] => Task 9, Epoch 20/20 => Loss 2.001, Train_accy 96.18
2024-09-11 23:34:16,282 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 23:35:50,366 [icarl.py] => Exemplar size: 4000
2024-09-11 23:35:50,366 [trainer.py] => CNN: {'total': 81.81, '00-19': 76.11, '20-39': 71.98, '40-59': 79.82, '60-79': 75.3, '80-99': 81.78, '100-119': 85.96, '120-139': 80.44, '140-159': 88.4, '160-179': 88.61, '180-199': 88.7, 'old': 81.06, 'new': 88.7}
2024-09-11 23:35:50,366 [trainer.py] => NME: {'total': 84.69, '00-19': 80.57, '20-39': 85.51, '40-59': 86.24, '60-79': 83.0, '80-99': 86.25, '100-119': 84.21, '120-139': 80.89, '140-159': 87.6, '160-179': 87.34, '180-199': 85.22, 'old': 84.63, 'new': 85.22}
2024-09-11 23:35:50,366 [trainer.py] => CNN top1 curve: [96.36, 95.15, 91.07, 89.88, 89.39, 86.09, 85.37, 84.35, 83.27, 81.81]
2024-09-11 23:35:50,366 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 98.37, 98.06, 97.39, 97.32, 96.93, 96.43, 96.01]
2024-09-11 23:35:50,366 [trainer.py] => NME top1 curve: [98.79, 94.93, 93.45, 90.42, 89.9, 89.12, 87.32, 86.67, 86.04, 84.69]
2024-09-11 23:35:50,366 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.55, 99.02, 98.74, 98.8, 98.42, 98.31, 98.07, 97.41]

Average Accuracy (CNN): 88.27
Average Accuracy (NME): 90.13
2024-09-11 23:35:50,367 [trainer.py] => Average Accuracy (CNN): 88.27
2024-09-11 23:35:50,367 [trainer.py] => Average Accuracy (NME): 90.13
Accuracy Matrix (CNN):
[[96.36 95.14 87.85 83.4  84.21 81.38 81.38 79.76 78.14 76.11]
 [ 0.   95.17 93.24 91.3  87.44 83.57 84.54 78.26 79.23 71.98]
 [ 0.    0.   92.66 91.74 90.83 84.4  81.65 78.9  77.98 79.82]
 [ 0.    0.    0.   93.52 89.88 86.23 83.4  82.19 79.35 75.3 ]
 [ 0.    0.    0.    0.   94.05 90.33 86.99 86.62 84.01 81.78]
 [ 0.    0.    0.    0.    0.   89.91 89.91 85.53 85.96 85.96]
 [ 0.    0.    0.    0.    0.    0.   89.78 88.   84.89 80.44]
 [ 0.    0.    0.    0.    0.    0.    0.   94.   87.2  88.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   91.98 88.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   88.7 ]]
2024-09-11 23:35:50,368 [trainer.py] => Forgetting (CNN): 12.114444444444445
Accuracy Matrix (NME):
[[98.79 95.95 94.33 86.23 85.43 86.23 83.81 82.19 81.38 80.57]
 [ 0.   93.72 92.27 90.82 89.37 89.86 88.41 87.92 87.44 85.51]
 [ 0.    0.   93.58 91.28 92.66 91.28 88.99 86.7  86.7  86.24]
 [ 0.    0.    0.   93.52 89.88 87.45 85.43 86.23 86.64 83.  ]
 [ 0.    0.    0.    0.   92.19 91.08 90.71 89.22 89.22 86.25]
 [ 0.    0.    0.    0.    0.   89.04 89.04 84.65 84.21 84.21]
 [ 0.    0.    0.    0.    0.    0.   84.89 84.   81.78 80.89]
 [ 0.    0.    0.    0.    0.    0.    0.   92.   88.4  87.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   88.19 87.34]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   85.22]]
2024-09-11 23:35:50,368 [trainer.py] => Forgetting (NME): 7.145555555555557
2024-09-11 23:35:53,289 [trainer.py] => config: ./exps/icarl_cub_B0_Inc20.json
2024-09-11 23:35:53,305 [trainer.py] => prefix: reproduce
2024-09-11 23:35:53,305 [trainer.py] => dataset: cub
2024-09-11 23:35:53,305 [trainer.py] => memory_size: 4000
2024-09-11 23:35:53,305 [trainer.py] => memory_per_class: 20
2024-09-11 23:35:53,305 [trainer.py] => fixed_memory: True
2024-09-11 23:35:53,305 [trainer.py] => shuffle: True
2024-09-11 23:35:53,305 [trainer.py] => init_cls: 10
2024-09-11 23:35:53,305 [trainer.py] => increment: 10
2024-09-11 23:35:53,305 [trainer.py] => model_name: icarl
2024-09-11 23:35:53,305 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-11 23:35:53,305 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-11 23:35:53,305 [trainer.py] => seed: 1993
2024-09-11 23:35:53,305 [trainer.py] => init_epoch: 20
2024-09-11 23:35:53,305 [trainer.py] => init_lr: 0.001
2024-09-11 23:35:53,305 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-11 23:35:53,306 [trainer.py] => init_lr_decay: 0.1
2024-09-11 23:35:53,306 [trainer.py] => init_weight_decay: 0.0005
2024-09-11 23:35:53,306 [trainer.py] => epochs: 20
2024-09-11 23:35:53,306 [trainer.py] => lrate: 0.001
2024-09-11 23:35:53,306 [trainer.py] => milestones: [80, 120]
2024-09-11 23:35:53,306 [trainer.py] => lrate_decay: 0.1
2024-09-11 23:35:53,306 [trainer.py] => batch_size: 48
2024-09-11 23:35:53,306 [trainer.py] => weight_decay: 0.0002
2024-09-11 23:35:53,306 [trainer.py] => T: 2
2024-09-11 23:35:53,352 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-11 23:35:55,272 [trainer.py] => All params: 85798656
2024-09-11 23:35:55,273 [trainer.py] => Trainable params: 85798656
2024-09-11 23:35:55,274 [icarl.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.465, Train_accy 54.28, Test_accy 91.53:   0%|          | 0/20 [00:05<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.465, Train_accy 54.28, Test_accy 91.53:   5%|▌         | 1/20 [00:05<01:45,  5.55s/it]
Task 0, Epoch 2/20 => Loss 0.554, Train_accy 83.72:   5%|▌         | 1/20 [00:10<01:45,  5.55s/it]                 
Task 0, Epoch 2/20 => Loss 0.554, Train_accy 83.72:  10%|█         | 2/20 [00:10<01:28,  4.94s/it]
Task 0, Epoch 3/20 => Loss 0.395, Train_accy 88.94:  10%|█         | 2/20 [00:14<01:28,  4.94s/it]
Task 0, Epoch 3/20 => Loss 0.395, Train_accy 88.94:  15%|█▌        | 3/20 [00:14<01:20,  4.75s/it]
Task 0, Epoch 4/20 => Loss 0.248, Train_accy 92.07:  15%|█▌        | 3/20 [00:19<01:20,  4.75s/it]
Task 0, Epoch 4/20 => Loss 0.248, Train_accy 92.07:  20%|██        | 4/20 [00:19<01:14,  4.67s/it]
Task 0, Epoch 5/20 => Loss 0.297, Train_accy 89.56:  20%|██        | 4/20 [00:23<01:14,  4.67s/it]
Task 0, Epoch 5/20 => Loss 0.297, Train_accy 89.56:  25%|██▌       | 5/20 [00:23<01:09,  4.61s/it]
Task 0, Epoch 6/20 => Loss 0.237, Train_accy 91.65, Test_accy 96.61:  25%|██▌       | 5/20 [00:29<01:09,  4.61s/it]
Task 0, Epoch 6/20 => Loss 0.237, Train_accy 91.65, Test_accy 96.61:  30%|███       | 6/20 [00:29<01:08,  4.88s/it]
Task 0, Epoch 7/20 => Loss 0.248, Train_accy 91.44:  30%|███       | 6/20 [00:33<01:08,  4.88s/it]                 
Task 0, Epoch 7/20 => Loss 0.248, Train_accy 91.44:  35%|███▌      | 7/20 [00:33<01:01,  4.76s/it]
Task 0, Epoch 8/20 => Loss 0.200, Train_accy 93.11:  35%|███▌      | 7/20 [00:38<01:01,  4.76s/it]
Task 0, Epoch 8/20 => Loss 0.200, Train_accy 93.11:  40%|████      | 8/20 [00:38<00:56,  4.71s/it]
Task 0, Epoch 9/20 => Loss 0.100, Train_accy 96.24:  40%|████      | 8/20 [00:42<00:56,  4.71s/it]
Task 0, Epoch 9/20 => Loss 0.100, Train_accy 96.24:  45%|████▌     | 9/20 [00:42<00:51,  4.65s/it]
Task 0, Epoch 10/20 => Loss 0.181, Train_accy 93.74:  45%|████▌     | 9/20 [00:47<00:51,  4.65s/it]
Task 0, Epoch 10/20 => Loss 0.181, Train_accy 93.74:  50%|█████     | 10/20 [00:47<00:46,  4.63s/it]
Task 0, Epoch 11/20 => Loss 0.156, Train_accy 95.20, Test_accy 98.31:  50%|█████     | 10/20 [00:52<00:46,  4.63s/it]
Task 0, Epoch 11/20 => Loss 0.156, Train_accy 95.20, Test_accy 98.31:  55%|█████▌    | 11/20 [00:52<00:43,  4.88s/it]
Task 0, Epoch 12/20 => Loss 0.139, Train_accy 95.82:  55%|█████▌    | 11/20 [00:57<00:43,  4.88s/it]                 
Task 0, Epoch 12/20 => Loss 0.139, Train_accy 95.82:  60%|██████    | 12/20 [00:57<00:38,  4.77s/it]
Task 0, Epoch 13/20 => Loss 0.126, Train_accy 95.20:  60%|██████    | 12/20 [01:01<00:38,  4.77s/it]
Task 0, Epoch 13/20 => Loss 0.126, Train_accy 95.20:  65%|██████▌   | 13/20 [01:01<00:33,  4.74s/it]
Task 0, Epoch 14/20 => Loss 0.155, Train_accy 95.20:  65%|██████▌   | 13/20 [01:06<00:33,  4.74s/it]
Task 0, Epoch 14/20 => Loss 0.155, Train_accy 95.20:  70%|███████   | 14/20 [01:06<00:28,  4.70s/it]
Task 0, Epoch 15/20 => Loss 0.113, Train_accy 96.24:  70%|███████   | 14/20 [01:11<00:28,  4.70s/it]
Task 0, Epoch 15/20 => Loss 0.113, Train_accy 96.24:  75%|███████▌  | 15/20 [01:11<00:23,  4.66s/it]
Task 0, Epoch 16/20 => Loss 0.139, Train_accy 94.99, Test_accy 96.61:  75%|███████▌  | 15/20 [01:16<00:23,  4.66s/it]
Task 0, Epoch 16/20 => Loss 0.139, Train_accy 94.99, Test_accy 96.61:  80%|████████  | 16/20 [01:16<00:19,  4.90s/it]
Task 0, Epoch 17/20 => Loss 0.156, Train_accy 95.62:  80%|████████  | 16/20 [01:21<00:19,  4.90s/it]                 
Task 0, Epoch 17/20 => Loss 0.156, Train_accy 95.62:  85%|████████▌ | 17/20 [01:21<00:14,  4.79s/it]
Task 0, Epoch 18/20 => Loss 0.121, Train_accy 95.20:  85%|████████▌ | 17/20 [01:25<00:14,  4.79s/it]
Task 0, Epoch 18/20 => Loss 0.121, Train_accy 95.20:  90%|█████████ | 18/20 [01:25<00:09,  4.75s/it]
Task 0, Epoch 19/20 => Loss 0.112, Train_accy 96.03:  90%|█████████ | 18/20 [01:30<00:09,  4.75s/it]
Task 0, Epoch 19/20 => Loss 0.112, Train_accy 96.03:  95%|█████████▌| 19/20 [01:30<00:04,  4.69s/it]
Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41:  95%|█████████▌| 19/20 [01:34<00:04,  4.69s/it]
Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41: 100%|██████████| 20/20 [01:34<00:00,  4.64s/it]
Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41: 100%|██████████| 20/20 [01:34<00:00,  4.74s/it]
2024-09-11 23:37:30,603 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.123, Train_accy 95.41
2024-09-11 23:37:30,604 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 23:37:41,150 [icarl.py] => Exemplar size: 200
2024-09-11 23:37:41,150 [trainer.py] => CNN: {'total': 96.61, '00-09': 96.61, 'old': 0, 'new': 96.61}
2024-09-11 23:37:41,151 [trainer.py] => NME: {'total': 98.31, '00-09': 98.31, 'old': 0, 'new': 98.31}
2024-09-11 23:37:41,151 [trainer.py] => CNN top1 curve: [96.61]
2024-09-11 23:37:41,151 [trainer.py] => CNN top5 curve: [100.0]
2024-09-11 23:37:41,151 [trainer.py] => NME top1 curve: [98.31]
2024-09-11 23:37:41,151 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 96.61
Average Accuracy (NME): 98.31
2024-09-11 23:37:41,151 [trainer.py] => Average Accuracy (CNN): 96.61
2024-09-11 23:37:41,151 [trainer.py] => Average Accuracy (NME): 98.31
2024-09-11 23:37:41,152 [trainer.py] => All params: 85806346
2024-09-11 23:37:41,152 [trainer.py] => Trainable params: 85806346
2024-09-11 23:37:41,153 [icarl.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.323, Train_accy 51.42, Test_accy 87.04:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.323, Train_accy 51.42, Test_accy 87.04:   5%|▌         | 1/20 [00:09<03:00,  9.52s/it]
Task 1, Epoch 2/20 => Loss 1.675, Train_accy 86.96:   5%|▌         | 1/20 [00:17<03:00,  9.52s/it]                 
Task 1, Epoch 2/20 => Loss 1.675, Train_accy 86.96:  10%|█         | 2/20 [00:17<02:37,  8.77s/it]
Task 1, Epoch 3/20 => Loss 1.495, Train_accy 89.36:  10%|█         | 2/20 [00:26<02:37,  8.77s/it]
Task 1, Epoch 3/20 => Loss 1.495, Train_accy 89.36:  15%|█▌        | 3/20 [00:26<02:25,  8.54s/it]
Task 1, Epoch 4/20 => Loss 1.473, Train_accy 91.30:  15%|█▌        | 3/20 [00:34<02:25,  8.54s/it]
Task 1, Epoch 4/20 => Loss 1.473, Train_accy 91.30:  20%|██        | 4/20 [00:34<02:14,  8.41s/it]
Task 1, Epoch 5/20 => Loss 1.466, Train_accy 91.90:  20%|██        | 4/20 [00:42<02:14,  8.41s/it]
Task 1, Epoch 5/20 => Loss 1.466, Train_accy 91.90:  25%|██▌       | 5/20 [00:42<02:04,  8.33s/it]
Task 1, Epoch 6/20 => Loss 1.392, Train_accy 93.55, Test_accy 95.95:  25%|██▌       | 5/20 [00:51<02:04,  8.33s/it]
Task 1, Epoch 6/20 => Loss 1.392, Train_accy 93.55, Test_accy 95.95:  30%|███       | 6/20 [00:51<02:02,  8.72s/it]
Task 1, Epoch 7/20 => Loss 1.328, Train_accy 95.05:  30%|███       | 6/20 [01:00<02:02,  8.72s/it]                 
Task 1, Epoch 7/20 => Loss 1.328, Train_accy 95.05:  35%|███▌      | 7/20 [01:00<01:51,  8.55s/it]
Task 1, Epoch 8/20 => Loss 1.345, Train_accy 94.45:  35%|███▌      | 7/20 [01:08<01:51,  8.55s/it]
Task 1, Epoch 8/20 => Loss 1.345, Train_accy 94.45:  40%|████      | 8/20 [01:08<01:41,  8.45s/it]
Task 1, Epoch 9/20 => Loss 1.344, Train_accy 94.15:  40%|████      | 8/20 [01:16<01:41,  8.45s/it]
Task 1, Epoch 9/20 => Loss 1.344, Train_accy 94.15:  45%|████▌     | 9/20 [01:16<01:32,  8.39s/it]
Task 1, Epoch 10/20 => Loss 1.283, Train_accy 95.50:  45%|████▌     | 9/20 [01:24<01:32,  8.39s/it]
Task 1, Epoch 10/20 => Loss 1.283, Train_accy 95.50:  50%|█████     | 10/20 [01:24<01:23,  8.34s/it]
Task 1, Epoch 11/20 => Loss 1.313, Train_accy 94.30, Test_accy 96.36:  50%|█████     | 10/20 [01:34<01:23,  8.34s/it]
Task 1, Epoch 11/20 => Loss 1.313, Train_accy 94.30, Test_accy 96.36:  55%|█████▌    | 11/20 [01:34<01:18,  8.70s/it]
Task 1, Epoch 12/20 => Loss 1.264, Train_accy 95.65:  55%|█████▌    | 11/20 [01:42<01:18,  8.70s/it]                 
Task 1, Epoch 12/20 => Loss 1.264, Train_accy 95.65:  60%|██████    | 12/20 [01:42<01:08,  8.55s/it]
Task 1, Epoch 13/20 => Loss 1.296, Train_accy 95.20:  60%|██████    | 12/20 [01:50<01:08,  8.55s/it]
Task 1, Epoch 13/20 => Loss 1.296, Train_accy 95.20:  65%|██████▌   | 13/20 [01:50<00:59,  8.49s/it]
Task 1, Epoch 14/20 => Loss 1.291, Train_accy 94.90:  65%|██████▌   | 13/20 [01:59<00:59,  8.49s/it]
Task 1, Epoch 14/20 => Loss 1.291, Train_accy 94.90:  70%|███████   | 14/20 [01:59<00:50,  8.40s/it]
Task 1, Epoch 15/20 => Loss 1.305, Train_accy 95.05:  70%|███████   | 14/20 [02:07<00:50,  8.40s/it]
Task 1, Epoch 15/20 => Loss 1.305, Train_accy 95.05:  75%|███████▌  | 15/20 [02:07<00:41,  8.36s/it]
Task 1, Epoch 16/20 => Loss 1.287, Train_accy 94.60, Test_accy 96.76:  75%|███████▌  | 15/20 [02:16<00:41,  8.36s/it]
Task 1, Epoch 16/20 => Loss 1.287, Train_accy 94.60, Test_accy 96.76:  80%|████████  | 16/20 [02:16<00:34,  8.73s/it]
Task 1, Epoch 17/20 => Loss 1.303, Train_accy 95.35:  80%|████████  | 16/20 [02:25<00:34,  8.73s/it]                 
Task 1, Epoch 17/20 => Loss 1.303, Train_accy 95.35:  85%|████████▌ | 17/20 [02:25<00:25,  8.57s/it]
Task 1, Epoch 18/20 => Loss 1.315, Train_accy 94.90:  85%|████████▌ | 17/20 [02:33<00:25,  8.57s/it]
Task 1, Epoch 18/20 => Loss 1.315, Train_accy 94.90:  90%|█████████ | 18/20 [02:33<00:16,  8.47s/it]
Task 1, Epoch 19/20 => Loss 1.344, Train_accy 94.45:  90%|█████████ | 18/20 [02:41<00:16,  8.47s/it]
Task 1, Epoch 19/20 => Loss 1.344, Train_accy 94.45:  95%|█████████▌| 19/20 [02:41<00:08,  8.40s/it]
Task 1, Epoch 20/20 => Loss 1.251, Train_accy 97.15:  95%|█████████▌| 19/20 [02:49<00:08,  8.40s/it]
Task 1, Epoch 20/20 => Loss 1.251, Train_accy 97.15: 100%|██████████| 20/20 [02:49<00:00,  8.39s/it]
Task 1, Epoch 20/20 => Loss 1.251, Train_accy 97.15: 100%|██████████| 20/20 [02:49<00:00,  8.50s/it]
2024-09-11 23:40:31,140 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.251, Train_accy 97.15
2024-09-11 23:40:31,141 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 23:40:47,847 [icarl.py] => Exemplar size: 400
2024-09-11 23:40:47,847 [trainer.py] => CNN: {'total': 97.17, '00-09': 97.46, '10-19': 96.9, 'old': 97.46, 'new': 96.9}
2024-09-11 23:40:47,847 [trainer.py] => NME: {'total': 97.17, '00-09': 98.31, '10-19': 96.12, 'old': 98.31, 'new': 96.12}
2024-09-11 23:40:47,847 [trainer.py] => CNN top1 curve: [96.61, 97.17]
2024-09-11 23:40:47,847 [trainer.py] => CNN top5 curve: [100.0, 99.6]
2024-09-11 23:40:47,847 [trainer.py] => NME top1 curve: [98.31, 97.17]
2024-09-11 23:40:47,847 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 96.89
Average Accuracy (NME): 97.74
2024-09-11 23:40:47,847 [trainer.py] => Average Accuracy (CNN): 96.89
2024-09-11 23:40:47,847 [trainer.py] => Average Accuracy (NME): 97.74
2024-09-11 23:40:47,848 [trainer.py] => All params: 85814036
2024-09-11 23:40:47,849 [trainer.py] => Trainable params: 85814036
2024-09-11 23:40:47,850 [icarl.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.064, Train_accy 65.41, Test_accy 92.44:   0%|          | 0/20 [00:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.064, Train_accy 65.41, Test_accy 92.44:   5%|▌         | 1/20 [00:12<03:54, 12.34s/it]
Task 2, Epoch 2/20 => Loss 1.335, Train_accy 90.53:   5%|▌         | 1/20 [00:23<03:54, 12.34s/it]                 
Task 2, Epoch 2/20 => Loss 1.335, Train_accy 90.53:  10%|█         | 2/20 [00:23<03:24, 11.36s/it]
Task 2, Epoch 3/20 => Loss 1.223, Train_accy 92.58:  10%|█         | 2/20 [00:33<03:24, 11.36s/it]
Task 2, Epoch 3/20 => Loss 1.223, Train_accy 92.58:  15%|█▌        | 3/20 [00:33<03:07, 11.03s/it]
Task 2, Epoch 4/20 => Loss 1.189, Train_accy 93.72:  15%|█▌        | 3/20 [00:44<03:07, 11.03s/it]
Task 2, Epoch 4/20 => Loss 1.189, Train_accy 93.72:  20%|██        | 4/20 [00:44<02:54, 10.88s/it]
Task 2, Epoch 5/20 => Loss 1.180, Train_accy 93.61:  20%|██        | 4/20 [00:55<02:54, 10.88s/it]
Task 2, Epoch 5/20 => Loss 1.180, Train_accy 93.61:  25%|██▌       | 5/20 [00:55<02:42, 10.83s/it]
Task 2, Epoch 6/20 => Loss 1.138, Train_accy 94.52, Test_accy 95.64:  25%|██▌       | 5/20 [01:07<02:42, 10.83s/it]
Task 2, Epoch 6/20 => Loss 1.138, Train_accy 94.52, Test_accy 95.64:  30%|███       | 6/20 [01:07<02:38, 11.35s/it]
Task 2, Epoch 7/20 => Loss 1.138, Train_accy 94.52:  30%|███       | 6/20 [01:18<02:38, 11.35s/it]                 
Task 2, Epoch 7/20 => Loss 1.138, Train_accy 94.52:  35%|███▌      | 7/20 [01:18<02:24, 11.15s/it]
Task 2, Epoch 8/20 => Loss 1.132, Train_accy 94.75:  35%|███▌      | 7/20 [01:28<02:24, 11.15s/it]
Task 2, Epoch 8/20 => Loss 1.132, Train_accy 94.75:  40%|████      | 8/20 [01:28<02:12, 11.01s/it]
Task 2, Epoch 9/20 => Loss 1.100, Train_accy 96.23:  40%|████      | 8/20 [01:39<02:12, 11.01s/it]
Task 2, Epoch 9/20 => Loss 1.100, Train_accy 96.23:  45%|████▌     | 9/20 [01:39<01:59, 10.90s/it]
Task 2, Epoch 10/20 => Loss 1.116, Train_accy 94.75:  45%|████▌     | 9/20 [01:50<01:59, 10.90s/it]
Task 2, Epoch 10/20 => Loss 1.116, Train_accy 94.75:  50%|█████     | 10/20 [01:50<01:48, 10.85s/it]
Task 2, Epoch 11/20 => Loss 1.176, Train_accy 92.92, Test_accy 97.09:  50%|█████     | 10/20 [02:02<01:48, 10.85s/it]
Task 2, Epoch 11/20 => Loss 1.176, Train_accy 92.92, Test_accy 97.09:  55%|█████▌    | 11/20 [02:02<01:42, 11.34s/it]
Task 2, Epoch 12/20 => Loss 1.151, Train_accy 94.98:  55%|█████▌    | 11/20 [02:13<01:42, 11.34s/it]                 
Task 2, Epoch 12/20 => Loss 1.151, Train_accy 94.98:  60%|██████    | 12/20 [02:13<01:29, 11.14s/it]
Task 2, Epoch 13/20 => Loss 1.127, Train_accy 95.66:  60%|██████    | 12/20 [02:24<01:29, 11.14s/it]
Task 2, Epoch 13/20 => Loss 1.127, Train_accy 95.66:  65%|██████▌   | 13/20 [02:24<01:17, 11.01s/it]
Task 2, Epoch 14/20 => Loss 1.095, Train_accy 95.43:  65%|██████▌   | 13/20 [02:34<01:17, 11.01s/it]
Task 2, Epoch 14/20 => Loss 1.095, Train_accy 95.43:  70%|███████   | 14/20 [02:34<01:05, 10.93s/it]
Task 2, Epoch 15/20 => Loss 1.064, Train_accy 95.55:  70%|███████   | 14/20 [02:45<01:05, 10.93s/it]
Task 2, Epoch 15/20 => Loss 1.064, Train_accy 95.55:  75%|███████▌  | 15/20 [02:45<00:54, 10.86s/it]
Task 2, Epoch 16/20 => Loss 1.036, Train_accy 96.69, Test_accy 95.64:  75%|███████▌  | 15/20 [02:57<00:54, 10.86s/it]
Task 2, Epoch 16/20 => Loss 1.036, Train_accy 96.69, Test_accy 95.64:  80%|████████  | 16/20 [02:57<00:45, 11.30s/it]
Task 2, Epoch 17/20 => Loss 1.073, Train_accy 96.46:  80%|████████  | 16/20 [03:08<00:45, 11.30s/it]                 
Task 2, Epoch 17/20 => Loss 1.073, Train_accy 96.46:  85%|████████▌ | 17/20 [03:08<00:33, 11.13s/it]
Task 2, Epoch 18/20 => Loss 1.006, Train_accy 96.92:  85%|████████▌ | 17/20 [03:19<00:33, 11.13s/it]
Task 2, Epoch 18/20 => Loss 1.006, Train_accy 96.92:  90%|█████████ | 18/20 [03:19<00:21, 10.99s/it]
Task 2, Epoch 19/20 => Loss 1.047, Train_accy 97.15:  90%|█████████ | 18/20 [03:29<00:21, 10.99s/it]
Task 2, Epoch 19/20 => Loss 1.047, Train_accy 97.15:  95%|█████████▌| 19/20 [03:29<00:10, 10.90s/it]
Task 2, Epoch 20/20 => Loss 1.050, Train_accy 96.69:  95%|█████████▌| 19/20 [03:40<00:10, 10.90s/it]
Task 2, Epoch 20/20 => Loss 1.050, Train_accy 96.69: 100%|██████████| 20/20 [03:40<00:00, 10.85s/it]
Task 2, Epoch 20/20 => Loss 1.050, Train_accy 96.69: 100%|██████████| 20/20 [03:40<00:00, 11.03s/it]
2024-09-11 23:44:28,522 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.050, Train_accy 96.69
2024-09-11 23:44:28,523 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 23:44:47,787 [icarl.py] => Exemplar size: 600
2024-09-11 23:44:47,788 [trainer.py] => CNN: {'total': 97.38, '00-09': 96.61, '10-19': 97.67, '20-29': 97.94, 'old': 97.17, 'new': 97.94}
2024-09-11 23:44:47,788 [trainer.py] => NME: {'total': 96.8, '00-09': 98.31, '10-19': 95.35, '20-29': 96.91, 'old': 96.76, 'new': 96.91}
2024-09-11 23:44:47,788 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38]
2024-09-11 23:44:47,788 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71]
2024-09-11 23:44:47,788 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8]
2024-09-11 23:44:47,788 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71]

Average Accuracy (CNN): 97.05
Average Accuracy (NME): 97.43
2024-09-11 23:44:47,788 [trainer.py] => Average Accuracy (CNN): 97.05
2024-09-11 23:44:47,788 [trainer.py] => Average Accuracy (NME): 97.43
2024-09-11 23:44:47,789 [trainer.py] => All params: 85821726
2024-09-11 23:44:47,790 [trainer.py] => Trainable params: 85821726
2024-09-11 23:44:47,791 [icarl.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.654, Train_accy 73.06, Test_accy 93.17:   0%|          | 0/20 [00:15<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.654, Train_accy 73.06, Test_accy 93.17:   5%|▌         | 1/20 [00:15<04:45, 15.02s/it]
Task 3, Epoch 2/20 => Loss 1.367, Train_accy 90.93:   5%|▌         | 1/20 [00:27<04:45, 15.02s/it]                 
Task 3, Epoch 2/20 => Loss 1.367, Train_accy 90.93:  10%|█         | 2/20 [00:27<04:08, 13.79s/it]
Task 3, Epoch 3/20 => Loss 1.334, Train_accy 93.92:  10%|█         | 2/20 [00:40<04:08, 13.79s/it]
Task 3, Epoch 3/20 => Loss 1.334, Train_accy 93.92:  15%|█▌        | 3/20 [00:40<03:48, 13.44s/it]
Task 3, Epoch 4/20 => Loss 1.330, Train_accy 92.33:  15%|█▌        | 3/20 [00:53<03:48, 13.44s/it]
Task 3, Epoch 4/20 => Loss 1.330, Train_accy 92.33:  20%|██        | 4/20 [00:53<03:31, 13.25s/it]
Task 3, Epoch 5/20 => Loss 1.285, Train_accy 93.83:  20%|██        | 4/20 [01:07<03:31, 13.25s/it]
Task 3, Epoch 5/20 => Loss 1.285, Train_accy 93.83:  25%|██▌       | 5/20 [01:07<03:17, 13.19s/it]
Task 3, Epoch 6/20 => Loss 1.266, Train_accy 94.48, Test_accy 94.49:  25%|██▌       | 5/20 [01:22<03:17, 13.19s/it]
Task 3, Epoch 6/20 => Loss 1.266, Train_accy 94.48, Test_accy 94.49:  30%|███       | 6/20 [01:22<03:13, 13.84s/it]
Task 3, Epoch 7/20 => Loss 1.270, Train_accy 94.67:  30%|███       | 6/20 [01:35<03:13, 13.84s/it]                 
Task 3, Epoch 7/20 => Loss 1.270, Train_accy 94.67:  35%|███▌      | 7/20 [01:35<02:56, 13.54s/it]
Task 3, Epoch 8/20 => Loss 1.251, Train_accy 94.11:  35%|███▌      | 7/20 [01:47<02:56, 13.54s/it]
Task 3, Epoch 8/20 => Loss 1.251, Train_accy 94.11:  40%|████      | 8/20 [01:47<02:40, 13.35s/it]
Task 3, Epoch 9/20 => Loss 1.284, Train_accy 94.67:  40%|████      | 8/20 [02:00<02:40, 13.35s/it]
Task 3, Epoch 9/20 => Loss 1.284, Train_accy 94.67:  45%|████▌     | 9/20 [02:00<02:25, 13.21s/it]
Task 3, Epoch 10/20 => Loss 1.255, Train_accy 93.83:  45%|████▌     | 9/20 [02:13<02:25, 13.21s/it]
Task 3, Epoch 10/20 => Loss 1.255, Train_accy 93.83:  50%|█████     | 10/20 [02:13<02:11, 13.14s/it]
Task 3, Epoch 11/20 => Loss 1.222, Train_accy 95.98, Test_accy 96.26:  50%|█████     | 10/20 [02:28<02:11, 13.14s/it]
Task 3, Epoch 11/20 => Loss 1.222, Train_accy 95.98, Test_accy 96.26:  55%|█████▌    | 11/20 [02:28<02:02, 13.67s/it]
Task 3, Epoch 12/20 => Loss 1.202, Train_accy 95.88:  55%|█████▌    | 11/20 [02:41<02:02, 13.67s/it]                 
Task 3, Epoch 12/20 => Loss 1.202, Train_accy 95.88:  60%|██████    | 12/20 [02:41<01:47, 13.43s/it]
Task 3, Epoch 13/20 => Loss 1.237, Train_accy 95.88:  60%|██████    | 12/20 [02:54<01:47, 13.43s/it]
Task 3, Epoch 13/20 => Loss 1.237, Train_accy 95.88:  65%|██████▌   | 13/20 [02:54<01:33, 13.29s/it]
Task 3, Epoch 14/20 => Loss 1.206, Train_accy 96.16:  65%|██████▌   | 13/20 [03:07<01:33, 13.29s/it]
Task 3, Epoch 14/20 => Loss 1.206, Train_accy 96.16:  70%|███████   | 14/20 [03:07<01:19, 13.21s/it]
Task 3, Epoch 15/20 => Loss 1.217, Train_accy 95.88:  70%|███████   | 14/20 [03:20<01:19, 13.21s/it]
Task 3, Epoch 15/20 => Loss 1.217, Train_accy 95.88:  75%|███████▌  | 15/20 [03:20<01:05, 13.13s/it]
Task 3, Epoch 16/20 => Loss 1.159, Train_accy 96.16, Test_accy 95.81:  75%|███████▌  | 15/20 [03:35<01:05, 13.13s/it]
Task 3, Epoch 16/20 => Loss 1.159, Train_accy 96.16, Test_accy 95.81:  80%|████████  | 16/20 [03:35<00:54, 13.64s/it]
Task 3, Epoch 17/20 => Loss 1.177, Train_accy 96.35:  80%|████████  | 16/20 [03:48<00:54, 13.64s/it]                 
Task 3, Epoch 17/20 => Loss 1.177, Train_accy 96.35:  85%|████████▌ | 17/20 [03:48<00:40, 13.42s/it]
Task 3, Epoch 18/20 => Loss 1.258, Train_accy 95.60:  85%|████████▌ | 17/20 [04:01<00:40, 13.42s/it]
Task 3, Epoch 18/20 => Loss 1.258, Train_accy 95.60:  90%|█████████ | 18/20 [04:01<00:26, 13.29s/it]
Task 3, Epoch 19/20 => Loss 1.215, Train_accy 96.73:  90%|█████████ | 18/20 [04:14<00:26, 13.29s/it]
Task 3, Epoch 19/20 => Loss 1.215, Train_accy 96.73:  95%|█████████▌| 19/20 [04:14<00:13, 13.20s/it]
Task 3, Epoch 20/20 => Loss 1.171, Train_accy 96.63:  95%|█████████▌| 19/20 [04:27<00:13, 13.20s/it]
Task 3, Epoch 20/20 => Loss 1.171, Train_accy 96.63: 100%|██████████| 20/20 [04:27<00:00, 13.11s/it]
Task 3, Epoch 20/20 => Loss 1.171, Train_accy 96.63: 100%|██████████| 20/20 [04:27<00:00, 13.36s/it]
2024-09-11 23:49:14,954 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.171, Train_accy 96.63
2024-09-11 23:49:14,956 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 23:49:37,071 [icarl.py] => Exemplar size: 800
2024-09-11 23:49:37,071 [trainer.py] => CNN: {'total': 94.49, '00-09': 92.37, '10-19': 95.35, '20-29': 95.88, '30-39': 94.55, 'old': 94.48, 'new': 94.55}
2024-09-11 23:49:37,071 [trainer.py] => NME: {'total': 95.15, '00-09': 96.61, '10-19': 93.8, '20-29': 97.94, '30-39': 92.73, 'old': 95.93, 'new': 92.73}
2024-09-11 23:49:37,071 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49]
2024-09-11 23:49:37,071 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56]
2024-09-11 23:49:37,071 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15]
2024-09-11 23:49:37,071 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78]

Average Accuracy (CNN): 96.41
Average Accuracy (NME): 96.86
2024-09-11 23:49:37,071 [trainer.py] => Average Accuracy (CNN): 96.41
2024-09-11 23:49:37,072 [trainer.py] => Average Accuracy (NME): 96.86
2024-09-11 23:49:37,072 [trainer.py] => All params: 85829416
2024-09-11 23:49:37,072 [trainer.py] => Trainable params: 85829416
2024-09-11 23:49:37,074 [icarl.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.478, Train_accy 76.75, Test_accy 90.55:   0%|          | 0/20 [00:17<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.478, Train_accy 76.75, Test_accy 90.55:   5%|▌         | 1/20 [00:17<05:32, 17.50s/it]
Task 4, Epoch 2/20 => Loss 1.479, Train_accy 92.12:   5%|▌         | 1/20 [00:32<05:32, 17.50s/it]                 
Task 4, Epoch 2/20 => Loss 1.479, Train_accy 92.12:  10%|█         | 2/20 [00:32<04:50, 16.13s/it]
Task 4, Epoch 3/20 => Loss 1.507, Train_accy 92.20:  10%|█         | 2/20 [00:47<04:50, 16.13s/it]
Task 4, Epoch 3/20 => Loss 1.507, Train_accy 92.20:  15%|█▌        | 3/20 [00:47<04:27, 15.72s/it]
Task 4, Epoch 4/20 => Loss 1.406, Train_accy 93.62:  15%|█▌        | 3/20 [01:03<04:27, 15.72s/it]
Task 4, Epoch 4/20 => Loss 1.406, Train_accy 93.62:  20%|██        | 4/20 [01:03<04:08, 15.52s/it]
Task 4, Epoch 5/20 => Loss 1.324, Train_accy 95.19:  20%|██        | 4/20 [01:18<04:08, 15.52s/it]
Task 4, Epoch 5/20 => Loss 1.324, Train_accy 95.19:  25%|██▌       | 5/20 [01:18<03:51, 15.40s/it]
Task 4, Epoch 6/20 => Loss 1.386, Train_accy 94.09, Test_accy 93.05:  25%|██▌       | 5/20 [01:35<03:51, 15.40s/it]
Task 4, Epoch 6/20 => Loss 1.386, Train_accy 94.09, Test_accy 93.05:  30%|███       | 6/20 [01:35<03:45, 16.12s/it]
Task 4, Epoch 7/20 => Loss 1.369, Train_accy 94.80:  30%|███       | 6/20 [01:51<03:45, 16.12s/it]                 
Task 4, Epoch 7/20 => Loss 1.369, Train_accy 94.80:  35%|███▌      | 7/20 [01:51<03:25, 15.82s/it]
Task 4, Epoch 8/20 => Loss 1.415, Train_accy 93.46:  35%|███▌      | 7/20 [02:06<03:25, 15.82s/it]
Task 4, Epoch 8/20 => Loss 1.415, Train_accy 93.46:  40%|████      | 8/20 [02:06<03:07, 15.64s/it]
Task 4, Epoch 9/20 => Loss 1.411, Train_accy 94.09:  40%|████      | 8/20 [02:21<03:07, 15.64s/it]
Task 4, Epoch 9/20 => Loss 1.411, Train_accy 94.09:  45%|████▌     | 9/20 [02:21<02:50, 15.51s/it]
Task 4, Epoch 10/20 => Loss 1.367, Train_accy 95.27:  45%|████▌     | 9/20 [02:36<02:50, 15.51s/it]
Task 4, Epoch 10/20 => Loss 1.367, Train_accy 95.27:  50%|█████     | 10/20 [02:36<02:34, 15.42s/it]
Task 4, Epoch 11/20 => Loss 1.305, Train_accy 96.22, Test_accy 93.05:  50%|█████     | 10/20 [02:54<02:34, 15.42s/it]
Task 4, Epoch 11/20 => Loss 1.305, Train_accy 96.22, Test_accy 93.05:  55%|█████▌    | 11/20 [02:54<02:24, 16.06s/it]
Task 4, Epoch 12/20 => Loss 1.438, Train_accy 94.33:  55%|█████▌    | 11/20 [03:09<02:24, 16.06s/it]                 
Task 4, Epoch 12/20 => Loss 1.438, Train_accy 94.33:  60%|██████    | 12/20 [03:09<02:06, 15.81s/it]
Task 4, Epoch 13/20 => Loss 1.330, Train_accy 95.59:  60%|██████    | 12/20 [03:24<02:06, 15.81s/it]
Task 4, Epoch 13/20 => Loss 1.330, Train_accy 95.59:  65%|██████▌   | 13/20 [03:24<01:49, 15.65s/it]
Task 4, Epoch 14/20 => Loss 1.334, Train_accy 95.90:  65%|██████▌   | 13/20 [03:40<01:49, 15.65s/it]
Task 4, Epoch 14/20 => Loss 1.334, Train_accy 95.90:  70%|███████   | 14/20 [03:40<01:33, 15.53s/it]
Task 4, Epoch 15/20 => Loss 1.397, Train_accy 94.41:  70%|███████   | 14/20 [03:55<01:33, 15.53s/it]
Task 4, Epoch 15/20 => Loss 1.397, Train_accy 94.41:  75%|███████▌  | 15/20 [03:55<01:17, 15.44s/it]
Task 4, Epoch 16/20 => Loss 1.334, Train_accy 96.45, Test_accy 92.34:  75%|███████▌  | 15/20 [04:12<01:17, 15.44s/it]
Task 4, Epoch 16/20 => Loss 1.334, Train_accy 96.45, Test_accy 92.34:  80%|████████  | 16/20 [04:12<01:04, 16.08s/it]
Task 4, Epoch 17/20 => Loss 1.328, Train_accy 95.82:  80%|████████  | 16/20 [04:28<01:04, 16.08s/it]                 
Task 4, Epoch 17/20 => Loss 1.328, Train_accy 95.82:  85%|████████▌ | 17/20 [04:28<00:47, 15.87s/it]
Task 4, Epoch 18/20 => Loss 1.334, Train_accy 96.06:  85%|████████▌ | 17/20 [04:43<00:47, 15.87s/it]
Task 4, Epoch 18/20 => Loss 1.334, Train_accy 96.06:  90%|█████████ | 18/20 [04:43<00:31, 15.68s/it]
Task 4, Epoch 19/20 => Loss 1.379, Train_accy 94.88:  90%|█████████ | 18/20 [04:58<00:31, 15.68s/it]
Task 4, Epoch 19/20 => Loss 1.379, Train_accy 94.88:  95%|█████████▌| 19/20 [04:58<00:15, 15.55s/it]
Task 4, Epoch 20/20 => Loss 1.331, Train_accy 96.30:  95%|█████████▌| 19/20 [05:14<00:15, 15.55s/it]
Task 4, Epoch 20/20 => Loss 1.331, Train_accy 96.30: 100%|██████████| 20/20 [05:14<00:00, 15.49s/it]
Task 4, Epoch 20/20 => Loss 1.331, Train_accy 96.30: 100%|██████████| 20/20 [05:14<00:00, 15.70s/it]
2024-09-11 23:54:51,099 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.331, Train_accy 96.30
2024-09-11 23:54:51,100 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-11 23:55:17,216 [icarl.py] => Exemplar size: 1000
2024-09-11 23:55:17,216 [trainer.py] => CNN: {'total': 93.05, '00-09': 91.53, '10-19': 94.57, '20-29': 95.88, '30-39': 86.36, '40-49': 97.2, 'old': 92.07, 'new': 97.2}
2024-09-11 23:55:17,216 [trainer.py] => NME: {'total': 95.19, '00-09': 97.46, '10-19': 93.8, '20-29': 97.94, '30-39': 90.0, '40-49': 97.2, 'old': 94.71, 'new': 97.2}
2024-09-11 23:55:17,216 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05]
2024-09-11 23:55:17,217 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29]
2024-09-11 23:55:17,217 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19]
2024-09-11 23:55:17,217 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29]

Average Accuracy (CNN): 95.74
Average Accuracy (NME): 96.52
2024-09-11 23:55:17,217 [trainer.py] => Average Accuracy (CNN): 95.74
2024-09-11 23:55:17,217 [trainer.py] => Average Accuracy (NME): 96.52
2024-09-11 23:55:17,217 [trainer.py] => All params: 85837106
2024-09-11 23:55:17,218 [trainer.py] => Trainable params: 85837106
2024-09-11 23:55:17,219 [icarl.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.444, Train_accy 78.83, Test_accy 88.10:   0%|          | 0/20 [00:20<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.444, Train_accy 78.83, Test_accy 88.10:   5%|▌         | 1/20 [00:20<06:26, 20.36s/it]
Task 5, Epoch 2/20 => Loss 1.686, Train_accy 90.50:   5%|▌         | 1/20 [00:37<06:26, 20.36s/it]                 
Task 5, Epoch 2/20 => Loss 1.686, Train_accy 90.50:  10%|█         | 2/20 [00:37<05:36, 18.71s/it]
Task 5, Epoch 3/20 => Loss 1.624, Train_accy 92.27:  10%|█         | 2/20 [00:55<05:36, 18.71s/it]
Task 5, Epoch 3/20 => Loss 1.624, Train_accy 92.27:  15%|█▌        | 3/20 [00:55<05:10, 18.24s/it]
Task 5, Epoch 4/20 => Loss 1.643, Train_accy 91.93:  15%|█▌        | 3/20 [01:13<05:10, 18.24s/it]
Task 5, Epoch 4/20 => Loss 1.643, Train_accy 91.93:  20%|██        | 4/20 [01:13<04:47, 18.00s/it]
Task 5, Epoch 5/20 => Loss 1.586, Train_accy 94.03:  20%|██        | 4/20 [01:30<04:47, 18.00s/it]
Task 5, Epoch 5/20 => Loss 1.586, Train_accy 94.03:  25%|██▌       | 5/20 [01:30<04:27, 17.85s/it]
Task 5, Epoch 6/20 => Loss 1.568, Train_accy 93.55, Test_accy 90.48:  25%|██▌       | 5/20 [01:51<04:27, 17.85s/it]
Task 5, Epoch 6/20 => Loss 1.568, Train_accy 93.55, Test_accy 90.48:  30%|███       | 6/20 [01:51<04:22, 18.74s/it]
Task 5, Epoch 7/20 => Loss 1.518, Train_accy 94.98:  30%|███       | 6/20 [02:09<04:22, 18.74s/it]                 
Task 5, Epoch 7/20 => Loss 1.518, Train_accy 94.98:  35%|███▌      | 7/20 [02:09<03:59, 18.42s/it]
Task 5, Epoch 8/20 => Loss 1.508, Train_accy 94.84:  35%|███▌      | 7/20 [02:26<03:59, 18.42s/it]
Task 5, Epoch 8/20 => Loss 1.508, Train_accy 94.84:  40%|████      | 8/20 [02:26<03:37, 18.16s/it]
Task 5, Epoch 9/20 => Loss 1.560, Train_accy 94.84:  40%|████      | 8/20 [02:44<03:37, 18.16s/it]
Task 5, Epoch 9/20 => Loss 1.560, Train_accy 94.84:  45%|████▌     | 9/20 [02:44<03:17, 18.00s/it]
Task 5, Epoch 10/20 => Loss 1.526, Train_accy 94.64:  45%|████▌     | 9/20 [03:02<03:17, 18.00s/it]
Task 5, Epoch 10/20 => Loss 1.526, Train_accy 94.64:  50%|█████     | 10/20 [03:02<02:59, 17.93s/it]
Task 5, Epoch 11/20 => Loss 1.590, Train_accy 93.96, Test_accy 90.92:  50%|█████     | 10/20 [03:22<02:59, 17.93s/it]
Task 5, Epoch 11/20 => Loss 1.590, Train_accy 93.96, Test_accy 90.92:  55%|█████▌    | 11/20 [03:22<02:48, 18.67s/it]
Task 5, Epoch 12/20 => Loss 1.543, Train_accy 95.12:  55%|█████▌    | 11/20 [03:40<02:48, 18.67s/it]                 
Task 5, Epoch 12/20 => Loss 1.543, Train_accy 95.12:  60%|██████    | 12/20 [03:40<02:26, 18.34s/it]
Task 5, Epoch 13/20 => Loss 1.509, Train_accy 95.32:  60%|██████    | 12/20 [03:57<02:26, 18.34s/it]
Task 5, Epoch 13/20 => Loss 1.509, Train_accy 95.32:  65%|██████▌   | 13/20 [03:57<02:06, 18.11s/it]
Task 5, Epoch 14/20 => Loss 1.501, Train_accy 95.73:  65%|██████▌   | 13/20 [04:15<02:06, 18.11s/it]
Task 5, Epoch 14/20 => Loss 1.501, Train_accy 95.73:  70%|███████   | 14/20 [04:15<01:47, 17.96s/it]
Task 5, Epoch 15/20 => Loss 1.514, Train_accy 95.05:  70%|███████   | 14/20 [04:32<01:47, 17.96s/it]
Task 5, Epoch 15/20 => Loss 1.514, Train_accy 95.05:  75%|███████▌  | 15/20 [04:32<01:29, 17.90s/it]
Task 5, Epoch 16/20 => Loss 1.485, Train_accy 96.07, Test_accy 90.33:  75%|███████▌  | 15/20 [04:53<01:29, 17.90s/it]
Task 5, Epoch 16/20 => Loss 1.485, Train_accy 96.07, Test_accy 90.33:  80%|████████  | 16/20 [04:53<01:14, 18.61s/it]
Task 5, Epoch 17/20 => Loss 1.522, Train_accy 95.66:  80%|████████  | 16/20 [05:10<01:14, 18.61s/it]                 
Task 5, Epoch 17/20 => Loss 1.522, Train_accy 95.66:  85%|████████▌ | 17/20 [05:10<00:55, 18.34s/it]
Task 5, Epoch 18/20 => Loss 1.540, Train_accy 94.64:  85%|████████▌ | 17/20 [05:28<00:55, 18.34s/it]
Task 5, Epoch 18/20 => Loss 1.540, Train_accy 94.64:  90%|█████████ | 18/20 [05:28<00:36, 18.16s/it]
Task 5, Epoch 19/20 => Loss 1.513, Train_accy 96.07:  90%|█████████ | 18/20 [05:46<00:36, 18.16s/it]
Task 5, Epoch 19/20 => Loss 1.513, Train_accy 96.07:  95%|█████████▌| 19/20 [05:46<00:18, 18.01s/it]
Task 5, Epoch 20/20 => Loss 1.478, Train_accy 95.86:  95%|█████████▌| 19/20 [06:03<00:18, 18.01s/it]
Task 5, Epoch 20/20 => Loss 1.478, Train_accy 95.86: 100%|██████████| 20/20 [06:03<00:00, 17.90s/it]
Task 5, Epoch 20/20 => Loss 1.478, Train_accy 95.86: 100%|██████████| 20/20 [06:03<00:00, 18.20s/it]
2024-09-12 00:01:21,188 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.478, Train_accy 95.86
2024-09-12 00:01:21,190 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 00:01:51,320 [icarl.py] => Exemplar size: 1200
2024-09-12 00:01:51,320 [trainer.py] => CNN: {'total': 90.62, '00-09': 83.9, '10-19': 90.7, '20-29': 94.85, '30-39': 86.36, '40-49': 97.2, '50-59': 91.89, 'old': 90.37, 'new': 91.89}
2024-09-12 00:01:51,320 [trainer.py] => NME: {'total': 93.01, '00-09': 89.83, '10-19': 93.02, '20-29': 96.91, '30-39': 89.09, '40-49': 97.2, '50-59': 92.79, 'old': 93.05, 'new': 92.79}
2024-09-12 00:01:51,320 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62]
2024-09-12 00:01:51,320 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51]
2024-09-12 00:01:51,320 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01]
2024-09-12 00:01:51,320 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4]

Average Accuracy (CNN): 94.89
Average Accuracy (NME): 95.94
2024-09-12 00:01:51,320 [trainer.py] => Average Accuracy (CNN): 94.89
2024-09-12 00:01:51,320 [trainer.py] => Average Accuracy (NME): 95.94
2024-09-12 00:01:51,321 [trainer.py] => All params: 85844796
2024-09-12 00:01:51,321 [trainer.py] => Trainable params: 85844796
2024-09-12 00:01:51,322 [icarl.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.374, Train_accy 79.67, Test_accy 85.99:   0%|          | 0/20 [00:22<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.374, Train_accy 79.67, Test_accy 85.99:   5%|▌         | 1/20 [00:22<07:15, 22.94s/it]
Task 6, Epoch 2/20 => Loss 1.620, Train_accy 89.69:   5%|▌         | 1/20 [00:42<07:15, 22.94s/it]                 
Task 6, Epoch 2/20 => Loss 1.620, Train_accy 89.69:  10%|█         | 2/20 [00:42<06:21, 21.22s/it]
Task 6, Epoch 3/20 => Loss 1.533, Train_accy 93.24:  10%|█         | 2/20 [01:02<06:21, 21.22s/it]
Task 6, Epoch 3/20 => Loss 1.533, Train_accy 93.24:  15%|█▌        | 3/20 [01:02<05:51, 20.68s/it]
Task 6, Epoch 4/20 => Loss 1.494, Train_accy 94.07:  15%|█▌        | 3/20 [01:23<05:51, 20.68s/it]
Task 6, Epoch 4/20 => Loss 1.494, Train_accy 94.07:  20%|██        | 4/20 [01:23<05:27, 20.48s/it]
Task 6, Epoch 5/20 => Loss 1.516, Train_accy 93.48:  20%|██        | 4/20 [01:43<05:27, 20.48s/it]
Task 6, Epoch 5/20 => Loss 1.516, Train_accy 93.48:  25%|██▌       | 5/20 [01:43<05:04, 20.33s/it]
Task 6, Epoch 6/20 => Loss 1.471, Train_accy 94.13, Test_accy 87.40:  25%|██▌       | 5/20 [02:06<05:04, 20.33s/it]
Task 6, Epoch 6/20 => Loss 1.471, Train_accy 94.13, Test_accy 87.40:  30%|███       | 6/20 [02:06<04:57, 21.26s/it]
Task 6, Epoch 7/20 => Loss 1.552, Train_accy 93.95:  30%|███       | 6/20 [02:26<04:57, 21.26s/it]                 
Task 6, Epoch 7/20 => Loss 1.552, Train_accy 93.95:  35%|███▌      | 7/20 [02:26<04:31, 20.89s/it]
Task 6, Epoch 8/20 => Loss 1.439, Train_accy 95.08:  35%|███▌      | 7/20 [02:46<04:31, 20.89s/it]
Task 6, Epoch 8/20 => Loss 1.439, Train_accy 95.08:  40%|████      | 8/20 [02:46<04:08, 20.67s/it]
Task 6, Epoch 9/20 => Loss 1.441, Train_accy 95.14:  40%|████      | 8/20 [03:06<04:08, 20.67s/it]
Task 6, Epoch 9/20 => Loss 1.441, Train_accy 95.14:  45%|████▌     | 9/20 [03:06<03:45, 20.49s/it]
Task 6, Epoch 10/20 => Loss 1.429, Train_accy 96.56:  45%|████▌     | 9/20 [03:26<03:45, 20.49s/it]
Task 6, Epoch 10/20 => Loss 1.429, Train_accy 96.56:  50%|█████     | 10/20 [03:26<03:23, 20.37s/it]
Task 6, Epoch 11/20 => Loss 1.439, Train_accy 95.79, Test_accy 87.28:  50%|█████     | 10/20 [03:50<03:23, 20.37s/it]
Task 6, Epoch 11/20 => Loss 1.439, Train_accy 95.79, Test_accy 87.28:  55%|█████▌    | 11/20 [03:50<03:11, 21.24s/it]
Task 6, Epoch 12/20 => Loss 1.500, Train_accy 94.90:  55%|█████▌    | 11/20 [04:10<03:11, 21.24s/it]                 
Task 6, Epoch 12/20 => Loss 1.500, Train_accy 94.90:  60%|██████    | 12/20 [04:10<02:47, 20.92s/it]
Task 6, Epoch 13/20 => Loss 1.489, Train_accy 94.78:  60%|██████    | 12/20 [04:30<02:47, 20.92s/it]
Task 6, Epoch 13/20 => Loss 1.489, Train_accy 94.78:  65%|██████▌   | 13/20 [04:30<02:24, 20.69s/it]
Task 6, Epoch 14/20 => Loss 1.430, Train_accy 95.61:  65%|██████▌   | 13/20 [04:50<02:24, 20.69s/it]
Task 6, Epoch 14/20 => Loss 1.430, Train_accy 95.61:  70%|███████   | 14/20 [04:50<02:03, 20.53s/it]
Task 6, Epoch 15/20 => Loss 1.454, Train_accy 95.61:  70%|███████   | 14/20 [05:10<02:03, 20.53s/it]
Task 6, Epoch 15/20 => Loss 1.454, Train_accy 95.61:  75%|███████▌  | 15/20 [05:10<01:42, 20.42s/it]
Task 6, Epoch 16/20 => Loss 1.365, Train_accy 96.32, Test_accy 88.17:  75%|███████▌  | 15/20 [05:34<01:42, 20.42s/it]
Task 6, Epoch 16/20 => Loss 1.365, Train_accy 96.32, Test_accy 88.17:  80%|████████  | 16/20 [05:34<01:25, 21.33s/it]
Task 6, Epoch 17/20 => Loss 1.400, Train_accy 96.44:  80%|████████  | 16/20 [05:54<01:25, 21.33s/it]                 
Task 6, Epoch 17/20 => Loss 1.400, Train_accy 96.44:  85%|████████▌ | 17/20 [05:54<01:02, 20.98s/it]
Task 6, Epoch 18/20 => Loss 1.484, Train_accy 95.67:  85%|████████▌ | 17/20 [06:14<01:02, 20.98s/it]
Task 6, Epoch 18/20 => Loss 1.484, Train_accy 95.67:  90%|█████████ | 18/20 [06:14<00:41, 20.75s/it]
Task 6, Epoch 19/20 => Loss 1.445, Train_accy 95.79:  90%|█████████ | 18/20 [06:34<00:41, 20.75s/it]
Task 6, Epoch 19/20 => Loss 1.445, Train_accy 95.79:  95%|█████████▌| 19/20 [06:34<00:20, 20.57s/it]
Task 6, Epoch 20/20 => Loss 1.418, Train_accy 95.32:  95%|█████████▌| 19/20 [06:54<00:20, 20.57s/it]
Task 6, Epoch 20/20 => Loss 1.418, Train_accy 95.32: 100%|██████████| 20/20 [06:54<00:00, 20.48s/it]
Task 6, Epoch 20/20 => Loss 1.418, Train_accy 95.32: 100%|██████████| 20/20 [06:54<00:00, 20.75s/it]
2024-09-12 00:08:46,284 [icarl.py] => Task 6, Epoch 20/20 => Loss 1.418, Train_accy 95.32
2024-09-12 00:08:46,285 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 00:09:20,700 [icarl.py] => Exemplar size: 1400
2024-09-12 00:09:20,701 [trainer.py] => CNN: {'total': 87.4, '00-09': 78.81, '10-19': 82.95, '20-29': 92.78, '30-39': 80.0, '40-49': 94.39, '50-59': 92.79, '60-69': 92.45, 'old': 86.61, 'new': 92.45}
2024-09-12 00:09:20,701 [trainer.py] => NME: {'total': 90.36, '00-09': 87.29, '10-19': 89.92, '20-29': 96.91, '30-39': 86.36, '40-49': 92.52, '50-59': 91.89, '60-69': 88.68, 'old': 90.62, 'new': 88.68}
2024-09-12 00:09:20,701 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4]
2024-09-12 00:09:20,701 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33]
2024-09-12 00:09:20,701 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36]
2024-09-12 00:09:20,701 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36]

Average Accuracy (CNN): 93.82
Average Accuracy (NME): 95.14
2024-09-12 00:09:20,701 [trainer.py] => Average Accuracy (CNN): 93.82
2024-09-12 00:09:20,701 [trainer.py] => Average Accuracy (NME): 95.14
2024-09-12 00:09:20,702 [trainer.py] => All params: 85852486
2024-09-12 00:09:20,702 [trainer.py] => Trainable params: 85852486
2024-09-12 00:09:20,703 [icarl.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.317, Train_accy 84.19, Test_accy 87.27:   0%|          | 0/20 [00:25<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.317, Train_accy 84.19, Test_accy 87.27:   5%|▌         | 1/20 [00:25<08:01, 25.35s/it]
Task 7, Epoch 2/20 => Loss 1.666, Train_accy 94.03:   5%|▌         | 1/20 [00:47<08:01, 25.35s/it]                 
Task 7, Epoch 2/20 => Loss 1.666, Train_accy 94.03:  10%|█         | 2/20 [00:47<07:00, 23.38s/it]
Task 7, Epoch 3/20 => Loss 1.686, Train_accy 93.98:  10%|█         | 2/20 [01:09<07:00, 23.38s/it]
Task 7, Epoch 3/20 => Loss 1.686, Train_accy 93.98:  15%|█▌        | 3/20 [01:09<06:27, 22.77s/it]
Task 7, Epoch 4/20 => Loss 1.636, Train_accy 95.21:  15%|█▌        | 3/20 [01:31<06:27, 22.77s/it]
Task 7, Epoch 4/20 => Loss 1.636, Train_accy 95.21:  20%|██        | 4/20 [01:31<05:59, 22.48s/it]
Task 7, Epoch 5/20 => Loss 1.635, Train_accy 93.92:  20%|██        | 4/20 [01:53<05:59, 22.48s/it]
Task 7, Epoch 5/20 => Loss 1.635, Train_accy 93.92:  25%|██▌       | 5/20 [01:53<05:34, 22.33s/it]
Task 7, Epoch 6/20 => Loss 1.605, Train_accy 95.54, Test_accy 88.57:  25%|██▌       | 5/20 [02:19<05:34, 22.33s/it]
Task 7, Epoch 6/20 => Loss 1.605, Train_accy 95.54, Test_accy 88.57:  30%|███       | 6/20 [02:19<05:28, 23.45s/it]
Task 7, Epoch 7/20 => Loss 1.662, Train_accy 94.41:  30%|███       | 6/20 [02:41<05:28, 23.45s/it]                 
Task 7, Epoch 7/20 => Loss 1.662, Train_accy 94.41:  35%|███▌      | 7/20 [02:41<04:58, 22.99s/it]
Task 7, Epoch 8/20 => Loss 1.695, Train_accy 94.67:  35%|███▌      | 7/20 [03:03<04:58, 22.99s/it]
Task 7, Epoch 8/20 => Loss 1.695, Train_accy 94.67:  40%|████      | 8/20 [03:03<04:32, 22.74s/it]
Task 7, Epoch 9/20 => Loss 1.653, Train_accy 94.30:  40%|████      | 8/20 [03:25<04:32, 22.74s/it]
Task 7, Epoch 9/20 => Loss 1.653, Train_accy 94.30:  45%|████▌     | 9/20 [03:25<04:08, 22.57s/it]
Task 7, Epoch 10/20 => Loss 1.603, Train_accy 95.75:  45%|████▌     | 9/20 [03:47<04:08, 22.57s/it]
Task 7, Epoch 10/20 => Loss 1.603, Train_accy 95.75:  50%|█████     | 10/20 [03:47<03:44, 22.41s/it]
Task 7, Epoch 11/20 => Loss 1.576, Train_accy 95.64, Test_accy 89.55:  50%|█████     | 10/20 [04:13<03:44, 22.41s/it]
Task 7, Epoch 11/20 => Loss 1.576, Train_accy 95.64, Test_accy 89.55:  55%|█████▌    | 11/20 [04:13<03:30, 23.43s/it]
Task 7, Epoch 12/20 => Loss 1.632, Train_accy 95.70:  55%|█████▌    | 11/20 [04:35<03:30, 23.43s/it]                 
Task 7, Epoch 12/20 => Loss 1.632, Train_accy 95.70:  60%|██████    | 12/20 [04:35<03:04, 23.04s/it]
Task 7, Epoch 13/20 => Loss 1.624, Train_accy 95.37:  60%|██████    | 12/20 [04:57<03:04, 23.04s/it]
Task 7, Epoch 13/20 => Loss 1.624, Train_accy 95.37:  65%|██████▌   | 13/20 [04:57<02:39, 22.75s/it]
Task 7, Epoch 14/20 => Loss 1.571, Train_accy 95.97:  65%|██████▌   | 13/20 [05:19<02:39, 22.75s/it]
Task 7, Epoch 14/20 => Loss 1.571, Train_accy 95.97:  70%|███████   | 14/20 [05:19<02:15, 22.57s/it]
Task 7, Epoch 15/20 => Loss 1.577, Train_accy 96.13:  70%|███████   | 14/20 [05:41<02:15, 22.57s/it]
Task 7, Epoch 15/20 => Loss 1.577, Train_accy 96.13:  75%|███████▌  | 15/20 [05:41<01:52, 22.46s/it]
Task 7, Epoch 16/20 => Loss 1.653, Train_accy 95.54, Test_accy 88.03:  75%|███████▌  | 15/20 [06:07<01:52, 22.46s/it]
Task 7, Epoch 16/20 => Loss 1.653, Train_accy 95.54, Test_accy 88.03:  80%|████████  | 16/20 [06:07<01:33, 23.40s/it]
Task 7, Epoch 17/20 => Loss 1.646, Train_accy 94.89:  80%|████████  | 16/20 [06:29<01:33, 23.40s/it]                 
Task 7, Epoch 17/20 => Loss 1.646, Train_accy 94.89:  85%|████████▌ | 17/20 [06:29<01:09, 23.06s/it]
Task 7, Epoch 18/20 => Loss 1.596, Train_accy 95.80:  85%|████████▌ | 17/20 [06:52<01:09, 23.06s/it]
Task 7, Epoch 18/20 => Loss 1.596, Train_accy 95.80:  90%|█████████ | 18/20 [06:52<00:45, 22.82s/it]
Task 7, Epoch 19/20 => Loss 1.601, Train_accy 95.91:  90%|█████████ | 18/20 [07:14<00:45, 22.82s/it]
Task 7, Epoch 19/20 => Loss 1.601, Train_accy 95.91:  95%|█████████▌| 19/20 [07:14<00:22, 22.65s/it]
Task 7, Epoch 20/20 => Loss 1.600, Train_accy 95.91:  95%|█████████▌| 19/20 [07:36<00:22, 22.65s/it]
Task 7, Epoch 20/20 => Loss 1.600, Train_accy 95.91: 100%|██████████| 20/20 [07:36<00:00, 22.51s/it]
Task 7, Epoch 20/20 => Loss 1.600, Train_accy 95.91: 100%|██████████| 20/20 [07:36<00:00, 22.83s/it]
2024-09-12 00:16:57,217 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.600, Train_accy 95.91
2024-09-12 00:16:57,218 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 00:17:35,046 [icarl.py] => Exemplar size: 1600
2024-09-12 00:17:35,046 [trainer.py] => CNN: {'total': 88.03, '00-09': 79.66, '10-19': 82.95, '20-29': 91.75, '30-39': 78.18, '40-49': 94.39, '50-59': 93.69, '60-69': 88.68, '70-79': 95.04, 'old': 86.76, 'new': 95.04}
2024-09-12 00:17:35,046 [trainer.py] => NME: {'total': 90.32, '00-09': 85.59, '10-19': 89.15, '20-29': 96.91, '30-39': 85.45, '40-49': 93.46, '50-59': 91.89, '60-69': 89.62, '70-79': 91.49, 'old': 90.1, 'new': 91.49}
2024-09-12 00:17:35,046 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03]
2024-09-12 00:17:35,046 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04]
2024-09-12 00:17:35,047 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32]
2024-09-12 00:17:35,047 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24]

Average Accuracy (CNN): 93.09
Average Accuracy (NME): 94.54
2024-09-12 00:17:35,047 [trainer.py] => Average Accuracy (CNN): 93.09
2024-09-12 00:17:35,047 [trainer.py] => Average Accuracy (NME): 94.54
2024-09-12 00:17:35,047 [trainer.py] => All params: 85860176
2024-09-12 00:17:35,048 [trainer.py] => Trainable params: 85860176
2024-09-12 00:17:35,049 [icarl.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.220, Train_accy 86.12, Test_accy 87.83:   0%|          | 0/20 [00:28<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.220, Train_accy 86.12, Test_accy 87.83:   5%|▌         | 1/20 [00:28<08:57, 28.28s/it]
Task 8, Epoch 2/20 => Loss 1.726, Train_accy 93.50:   5%|▌         | 1/20 [00:52<08:57, 28.28s/it]                 
Task 8, Epoch 2/20 => Loss 1.726, Train_accy 93.50:  10%|█         | 2/20 [00:52<07:48, 26.01s/it]
Task 8, Epoch 3/20 => Loss 1.611, Train_accy 94.52:  10%|█         | 2/20 [01:17<07:48, 26.01s/it]
Task 8, Epoch 3/20 => Loss 1.611, Train_accy 94.52:  15%|█▌        | 3/20 [01:17<07:10, 25.33s/it]
Task 8, Epoch 4/20 => Loss 1.641, Train_accy 95.20:  15%|█▌        | 3/20 [01:41<07:10, 25.33s/it]
Task 8, Epoch 4/20 => Loss 1.641, Train_accy 95.20:  20%|██        | 4/20 [01:41<06:39, 25.00s/it]
Task 8, Epoch 5/20 => Loss 1.694, Train_accy 93.64:  20%|██        | 4/20 [02:06<06:39, 25.00s/it]
Task 8, Epoch 5/20 => Loss 1.694, Train_accy 93.64:  25%|██▌       | 5/20 [02:06<06:11, 24.79s/it]
Task 8, Epoch 6/20 => Loss 1.622, Train_accy 95.10, Test_accy 88.59:  25%|██▌       | 5/20 [02:34<06:11, 24.79s/it]
Task 8, Epoch 6/20 => Loss 1.622, Train_accy 95.10, Test_accy 88.59:  30%|███       | 6/20 [02:34<06:03, 26.00s/it]
Task 8, Epoch 7/20 => Loss 1.590, Train_accy 95.68:  30%|███       | 6/20 [02:58<06:03, 26.00s/it]                 
Task 8, Epoch 7/20 => Loss 1.590, Train_accy 95.68:  35%|███▌      | 7/20 [02:58<05:31, 25.49s/it]
Task 8, Epoch 8/20 => Loss 1.594, Train_accy 96.36:  35%|███▌      | 7/20 [03:23<05:31, 25.49s/it]
Task 8, Epoch 8/20 => Loss 1.594, Train_accy 96.36:  40%|████      | 8/20 [03:23<05:02, 25.17s/it]
Task 8, Epoch 9/20 => Loss 1.640, Train_accy 95.49:  40%|████      | 8/20 [03:47<05:02, 25.17s/it]
Task 8, Epoch 9/20 => Loss 1.640, Train_accy 95.49:  45%|████▌     | 9/20 [03:47<04:34, 24.97s/it]
Task 8, Epoch 10/20 => Loss 1.597, Train_accy 95.88:  45%|████▌     | 9/20 [04:12<04:34, 24.97s/it]
Task 8, Epoch 10/20 => Loss 1.597, Train_accy 95.88:  50%|█████     | 10/20 [04:12<04:08, 24.85s/it]
Task 8, Epoch 11/20 => Loss 1.628, Train_accy 95.44, Test_accy 88.59:  50%|█████     | 10/20 [04:41<04:08, 24.85s/it]
Task 8, Epoch 11/20 => Loss 1.628, Train_accy 95.44, Test_accy 88.59:  55%|█████▌    | 11/20 [04:41<03:53, 25.99s/it]
Task 8, Epoch 12/20 => Loss 1.625, Train_accy 95.92:  55%|█████▌    | 11/20 [05:05<03:53, 25.99s/it]                 
Task 8, Epoch 12/20 => Loss 1.625, Train_accy 95.92:  60%|██████    | 12/20 [05:05<03:24, 25.58s/it]
Task 8, Epoch 13/20 => Loss 1.628, Train_accy 96.07:  60%|██████    | 12/20 [05:30<03:24, 25.58s/it]
Task 8, Epoch 13/20 => Loss 1.628, Train_accy 96.07:  65%|██████▌   | 13/20 [05:30<02:57, 25.33s/it]
Task 8, Epoch 14/20 => Loss 1.629, Train_accy 95.68:  65%|██████▌   | 13/20 [05:54<02:57, 25.33s/it]
Task 8, Epoch 14/20 => Loss 1.629, Train_accy 95.68:  70%|███████   | 14/20 [05:54<02:30, 25.07s/it]
Task 8, Epoch 15/20 => Loss 1.641, Train_accy 95.78:  70%|███████   | 14/20 [06:19<02:30, 25.07s/it]
Task 8, Epoch 15/20 => Loss 1.641, Train_accy 95.78:  75%|███████▌  | 15/20 [06:19<02:04, 24.89s/it]
Task 8, Epoch 16/20 => Loss 1.609, Train_accy 95.68, Test_accy 87.83:  75%|███████▌  | 15/20 [06:47<02:04, 24.89s/it]
Task 8, Epoch 16/20 => Loss 1.609, Train_accy 95.68, Test_accy 87.83:  80%|████████  | 16/20 [06:47<01:43, 25.97s/it]
Task 8, Epoch 17/20 => Loss 1.610, Train_accy 95.97:  80%|████████  | 16/20 [07:12<01:43, 25.97s/it]                 
Task 8, Epoch 17/20 => Loss 1.610, Train_accy 95.97:  85%|████████▌ | 17/20 [07:12<01:16, 25.53s/it]
Task 8, Epoch 18/20 => Loss 1.636, Train_accy 95.92:  85%|████████▌ | 17/20 [07:36<01:16, 25.53s/it]
Task 8, Epoch 18/20 => Loss 1.636, Train_accy 95.92:  90%|█████████ | 18/20 [07:36<00:49, 24.99s/it]
Task 8, Epoch 19/20 => Loss 1.601, Train_accy 96.60:  90%|█████████ | 18/20 [08:00<00:49, 24.99s/it]
Task 8, Epoch 19/20 => Loss 1.601, Train_accy 96.60:  95%|█████████▌| 19/20 [08:00<00:24, 24.85s/it]
Task 8, Epoch 20/20 => Loss 1.593, Train_accy 96.31:  95%|█████████▌| 19/20 [08:25<00:24, 24.85s/it]
Task 8, Epoch 20/20 => Loss 1.593, Train_accy 96.31: 100%|██████████| 20/20 [08:25<00:00, 24.75s/it]
Task 8, Epoch 20/20 => Loss 1.593, Train_accy 96.31: 100%|██████████| 20/20 [08:25<00:00, 25.26s/it]
2024-09-12 00:26:00,263 [icarl.py] => Task 8, Epoch 20/20 => Loss 1.593, Train_accy 96.31
2024-09-12 00:26:00,264 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 00:26:42,674 [icarl.py] => Exemplar size: 1800
2024-09-12 00:26:42,674 [trainer.py] => CNN: {'total': 88.97, '00-09': 80.51, '10-19': 82.95, '20-29': 92.78, '30-39': 80.91, '40-49': 91.59, '50-59': 89.19, '60-69': 88.68, '70-79': 96.45, '80-89': 96.24, 'old': 87.92, 'new': 96.24}
2024-09-12 00:26:42,674 [trainer.py] => NME: {'total': 90.11, '00-09': 84.75, '10-19': 86.82, '20-29': 96.91, '30-39': 85.45, '40-49': 94.39, '50-59': 91.89, '60-69': 85.85, '70-79': 92.91, '80-89': 92.48, 'old': 89.77, 'new': 92.48}
2024-09-12 00:26:42,674 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97]
2024-09-12 00:26:42,675 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81]
2024-09-12 00:26:42,675 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11]
2024-09-12 00:26:42,675 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24]

Average Accuracy (CNN): 92.64
Average Accuracy (NME): 94.05
2024-09-12 00:26:42,675 [trainer.py] => Average Accuracy (CNN): 92.64
2024-09-12 00:26:42,675 [trainer.py] => Average Accuracy (NME): 94.05
2024-09-12 00:26:42,675 [trainer.py] => All params: 85867866
2024-09-12 00:26:42,676 [trainer.py] => Trainable params: 85867866
2024-09-12 00:26:42,677 [icarl.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.160, Train_accy 86.91, Test_accy 85.69:   0%|          | 0/20 [00:30<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.160, Train_accy 86.91, Test_accy 85.69:   5%|▌         | 1/20 [00:30<09:46, 30.86s/it]
Task 9, Epoch 2/20 => Loss 1.706, Train_accy 92.81:   5%|▌         | 1/20 [00:57<09:46, 30.86s/it]                 
Task 9, Epoch 2/20 => Loss 1.706, Train_accy 92.81:  10%|█         | 2/20 [00:57<08:29, 28.31s/it]
Task 9, Epoch 3/20 => Loss 1.652, Train_accy 93.70:  10%|█         | 2/20 [01:24<08:29, 28.31s/it]
Task 9, Epoch 3/20 => Loss 1.652, Train_accy 93.70:  15%|█▌        | 3/20 [01:24<07:48, 27.55s/it]
Task 9, Epoch 4/20 => Loss 1.626, Train_accy 93.74:  15%|█▌        | 3/20 [01:50<07:48, 27.55s/it]
Task 9, Epoch 4/20 => Loss 1.626, Train_accy 93.74:  20%|██        | 4/20 [01:50<07:15, 27.22s/it]
Task 9, Epoch 5/20 => Loss 1.666, Train_accy 94.32:  20%|██        | 4/20 [02:17<07:15, 27.22s/it]
Task 9, Epoch 5/20 => Loss 1.666, Train_accy 94.32:  25%|██▌       | 5/20 [02:17<06:45, 27.02s/it]
Task 9, Epoch 6/20 => Loss 1.616, Train_accy 95.34, Test_accy 87.21:  25%|██▌       | 5/20 [02:48<06:45, 27.02s/it]
Task 9, Epoch 6/20 => Loss 1.616, Train_accy 95.34, Test_accy 87.21:  30%|███       | 6/20 [02:48<06:37, 28.41s/it]
Task 9, Epoch 7/20 => Loss 1.594, Train_accy 95.43:  30%|███       | 6/20 [03:15<06:37, 28.41s/it]                 
Task 9, Epoch 7/20 => Loss 1.594, Train_accy 95.43:  35%|███▌      | 7/20 [03:15<06:01, 27.84s/it]
Task 9, Epoch 8/20 => Loss 1.553, Train_accy 96.05:  35%|███▌      | 7/20 [03:41<06:01, 27.84s/it]
Task 9, Epoch 8/20 => Loss 1.553, Train_accy 96.05:  40%|████      | 8/20 [03:41<05:29, 27.50s/it]
Task 9, Epoch 9/20 => Loss 1.556, Train_accy 96.36:  40%|████      | 8/20 [04:08<05:29, 27.50s/it]
Task 9, Epoch 9/20 => Loss 1.556, Train_accy 96.36:  45%|████▌     | 9/20 [04:08<05:00, 27.28s/it]
Task 9, Epoch 10/20 => Loss 1.627, Train_accy 95.25:  45%|████▌     | 9/20 [04:35<05:00, 27.28s/it]
Task 9, Epoch 10/20 => Loss 1.627, Train_accy 95.25:  50%|█████     | 10/20 [04:35<04:31, 27.11s/it]
Task 9, Epoch 11/20 => Loss 1.582, Train_accy 96.32, Test_accy 88.80:  50%|█████     | 10/20 [05:06<04:31, 27.11s/it]
Task 9, Epoch 11/20 => Loss 1.582, Train_accy 96.32, Test_accy 88.80:  55%|█████▌    | 11/20 [05:06<04:15, 28.37s/it]
Task 9, Epoch 12/20 => Loss 1.568, Train_accy 96.09:  55%|█████▌    | 11/20 [05:33<04:15, 28.37s/it]                 
Task 9, Epoch 12/20 => Loss 1.568, Train_accy 96.09:  60%|██████    | 12/20 [05:33<03:43, 27.91s/it]
Task 9, Epoch 13/20 => Loss 1.617, Train_accy 95.47:  60%|██████    | 12/20 [06:00<03:43, 27.91s/it]
Task 9, Epoch 13/20 => Loss 1.617, Train_accy 95.47:  65%|██████▌   | 13/20 [06:00<03:12, 27.56s/it]
Task 9, Epoch 14/20 => Loss 1.612, Train_accy 95.69:  65%|██████▌   | 13/20 [06:27<03:12, 27.56s/it]
Task 9, Epoch 14/20 => Loss 1.612, Train_accy 95.69:  70%|███████   | 14/20 [06:27<02:43, 27.33s/it]
Task 9, Epoch 15/20 => Loss 1.621, Train_accy 95.47:  70%|███████   | 14/20 [06:53<02:43, 27.33s/it]
Task 9, Epoch 15/20 => Loss 1.621, Train_accy 95.47:  75%|███████▌  | 15/20 [06:53<02:15, 27.15s/it]
Task 9, Epoch 16/20 => Loss 1.560, Train_accy 96.63, Test_accy 88.89:  75%|███████▌  | 15/20 [07:25<02:15, 27.15s/it]
Task 9, Epoch 16/20 => Loss 1.560, Train_accy 96.63, Test_accy 88.89:  80%|████████  | 16/20 [07:25<01:53, 28.36s/it]
Task 9, Epoch 17/20 => Loss 1.535, Train_accy 96.63:  80%|████████  | 16/20 [07:51<01:53, 28.36s/it]                 
Task 9, Epoch 17/20 => Loss 1.535, Train_accy 96.63:  85%|████████▌ | 17/20 [07:51<01:23, 27.92s/it]
Task 9, Epoch 18/20 => Loss 1.566, Train_accy 96.58:  85%|████████▌ | 17/20 [08:18<01:23, 27.92s/it]
Task 9, Epoch 18/20 => Loss 1.566, Train_accy 96.58:  90%|█████████ | 18/20 [08:18<00:55, 27.56s/it]
Task 9, Epoch 19/20 => Loss 1.565, Train_accy 96.18:  90%|█████████ | 18/20 [08:45<00:55, 27.56s/it]
Task 9, Epoch 19/20 => Loss 1.565, Train_accy 96.18:  95%|█████████▌| 19/20 [08:45<00:27, 27.32s/it]
Task 9, Epoch 20/20 => Loss 1.569, Train_accy 95.69:  95%|█████████▌| 19/20 [09:12<00:27, 27.32s/it]
Task 9, Epoch 20/20 => Loss 1.569, Train_accy 95.69: 100%|██████████| 20/20 [09:12<00:00, 27.13s/it]
Task 9, Epoch 20/20 => Loss 1.569, Train_accy 95.69: 100%|██████████| 20/20 [09:12<00:00, 27.60s/it]
2024-09-12 00:35:54,737 [icarl.py] => Task 9, Epoch 20/20 => Loss 1.569, Train_accy 95.69
2024-09-12 00:35:54,739 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 00:36:41,373 [icarl.py] => Exemplar size: 2000
2024-09-12 00:36:41,374 [trainer.py] => CNN: {'total': 88.47, '00-09': 81.36, '10-19': 80.62, '20-29': 93.81, '30-39': 74.55, '40-49': 86.92, '50-59': 90.09, '60-69': 90.57, '70-79': 95.04, '80-89': 95.49, '90-99': 94.12, 'old': 87.74, 'new': 94.12}
2024-09-12 00:36:41,374 [trainer.py] => NME: {'total': 89.48, '00-09': 84.75, '10-19': 87.6, '20-29': 96.91, '30-39': 82.73, '40-49': 93.46, '50-59': 90.99, '60-69': 84.91, '70-79': 90.78, '80-89': 93.23, '90-99': 89.71, 'old': 89.45, 'new': 89.71}
2024-09-12 00:36:41,374 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47]
2024-09-12 00:36:41,374 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9]
2024-09-12 00:36:41,374 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48]
2024-09-12 00:36:41,374 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91]

Average Accuracy (CNN): 92.22
Average Accuracy (NME): 93.59
2024-09-12 00:36:41,374 [trainer.py] => Average Accuracy (CNN): 92.22
2024-09-12 00:36:41,374 [trainer.py] => Average Accuracy (NME): 93.59
2024-09-12 00:36:41,375 [trainer.py] => All params: 85875556
2024-09-12 00:36:41,375 [trainer.py] => Trainable params: 85875556
2024-09-12 00:36:41,376 [icarl.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.244, Train_accy 87.06, Test_accy 87.11:   0%|          | 0/20 [00:33<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.244, Train_accy 87.06, Test_accy 87.11:   5%|▌         | 1/20 [00:33<10:43, 33.89s/it]
Task 10, Epoch 2/20 => Loss 1.819, Train_accy 93.31:   5%|▌         | 1/20 [01:03<10:43, 33.89s/it]                 
Task 10, Epoch 2/20 => Loss 1.819, Train_accy 93.31:  10%|█         | 2/20 [01:03<09:21, 31.21s/it]
Task 10, Epoch 3/20 => Loss 1.724, Train_accy 94.72:  10%|█         | 2/20 [01:32<09:21, 31.21s/it]
Task 10, Epoch 3/20 => Loss 1.724, Train_accy 94.72:  15%|█▌        | 3/20 [01:32<08:35, 30.35s/it]
Task 10, Epoch 4/20 => Loss 1.704, Train_accy 95.28:  15%|█▌        | 3/20 [02:02<08:35, 30.35s/it]
Task 10, Epoch 4/20 => Loss 1.704, Train_accy 95.28:  20%|██        | 4/20 [02:02<08:00, 30.06s/it]
Task 10, Epoch 5/20 => Loss 1.713, Train_accy 95.32:  20%|██        | 4/20 [02:31<08:00, 30.06s/it]
Task 10, Epoch 5/20 => Loss 1.713, Train_accy 95.32:  25%|██▌       | 5/20 [02:31<07:27, 29.83s/it]
Task 10, Epoch 6/20 => Loss 1.705, Train_accy 95.20, Test_accy 87.41:  25%|██▌       | 5/20 [03:05<07:27, 29.83s/it]
Task 10, Epoch 6/20 => Loss 1.705, Train_accy 95.20, Test_accy 87.41:  30%|███       | 6/20 [03:05<07:18, 31.29s/it]
Task 10, Epoch 7/20 => Loss 1.658, Train_accy 96.09:  30%|███       | 6/20 [03:35<07:18, 31.29s/it]                 
Task 10, Epoch 7/20 => Loss 1.658, Train_accy 96.09:  35%|███▌      | 7/20 [03:35<06:38, 30.68s/it]
Task 10, Epoch 8/20 => Loss 1.720, Train_accy 95.12:  35%|███▌      | 7/20 [04:04<06:38, 30.68s/it]
Task 10, Epoch 8/20 => Loss 1.720, Train_accy 95.12:  40%|████      | 8/20 [04:04<06:03, 30.29s/it]
Task 10, Epoch 9/20 => Loss 1.706, Train_accy 95.53:  40%|████      | 8/20 [04:33<06:03, 30.29s/it]
Task 10, Epoch 9/20 => Loss 1.706, Train_accy 95.53:  45%|████▌     | 9/20 [04:33<05:30, 30.01s/it]
Task 10, Epoch 10/20 => Loss 1.723, Train_accy 95.53:  45%|████▌     | 9/20 [05:03<05:30, 30.01s/it]
Task 10, Epoch 10/20 => Loss 1.723, Train_accy 95.53:  50%|█████     | 10/20 [05:03<04:58, 29.85s/it]
Task 10, Epoch 11/20 => Loss 1.736, Train_accy 95.45, Test_accy 87.80:  50%|█████     | 10/20 [05:37<04:58, 29.85s/it]
Task 10, Epoch 11/20 => Loss 1.736, Train_accy 95.45, Test_accy 87.80:  55%|█████▌    | 11/20 [05:37<04:40, 31.20s/it]
Task 10, Epoch 12/20 => Loss 1.632, Train_accy 96.65:  55%|█████▌    | 11/20 [06:07<04:40, 31.20s/it]                 
Task 10, Epoch 12/20 => Loss 1.632, Train_accy 96.65:  60%|██████    | 12/20 [06:07<04:05, 30.65s/it]
Task 10, Epoch 13/20 => Loss 1.713, Train_accy 96.01:  60%|██████    | 12/20 [06:36<04:05, 30.65s/it]
Task 10, Epoch 13/20 => Loss 1.713, Train_accy 96.01:  65%|██████▌   | 13/20 [06:36<03:32, 30.29s/it]
Task 10, Epoch 14/20 => Loss 1.711, Train_accy 96.17:  65%|██████▌   | 13/20 [07:06<03:32, 30.29s/it]
Task 10, Epoch 14/20 => Loss 1.711, Train_accy 96.17:  70%|███████   | 14/20 [07:06<03:00, 30.06s/it]
Task 10, Epoch 15/20 => Loss 1.714, Train_accy 96.17:  70%|███████   | 14/20 [07:35<03:00, 30.06s/it]
Task 10, Epoch 15/20 => Loss 1.714, Train_accy 96.17:  75%|███████▌  | 15/20 [07:35<02:29, 29.87s/it]
Task 10, Epoch 16/20 => Loss 1.694, Train_accy 96.17, Test_accy 88.03:  75%|███████▌  | 15/20 [08:09<02:29, 29.87s/it]
Task 10, Epoch 16/20 => Loss 1.694, Train_accy 96.17, Test_accy 88.03:  80%|████████  | 16/20 [08:09<02:04, 31.17s/it]
Task 10, Epoch 17/20 => Loss 1.678, Train_accy 96.17:  80%|████████  | 16/20 [08:39<02:04, 31.17s/it]                 
Task 10, Epoch 17/20 => Loss 1.678, Train_accy 96.17:  85%|████████▌ | 17/20 [08:39<01:31, 30.64s/it]
Task 10, Epoch 18/20 => Loss 1.643, Train_accy 96.57:  85%|████████▌ | 17/20 [09:08<01:31, 30.64s/it]
Task 10, Epoch 18/20 => Loss 1.643, Train_accy 96.57:  90%|█████████ | 18/20 [09:08<01:00, 30.27s/it]
Task 10, Epoch 19/20 => Loss 1.694, Train_accy 96.45:  90%|█████████ | 18/20 [09:37<01:00, 30.27s/it]
Task 10, Epoch 19/20 => Loss 1.694, Train_accy 96.45:  95%|█████████▌| 19/20 [09:37<00:30, 30.02s/it]
Task 10, Epoch 20/20 => Loss 1.686, Train_accy 96.17:  95%|█████████▌| 19/20 [10:07<00:30, 30.02s/it]
Task 10, Epoch 20/20 => Loss 1.686, Train_accy 96.17: 100%|██████████| 20/20 [10:07<00:00, 29.87s/it]
Task 10, Epoch 20/20 => Loss 1.686, Train_accy 96.17: 100%|██████████| 20/20 [10:07<00:00, 30.38s/it]
2024-09-12 00:46:48,890 [icarl.py] => Task 10, Epoch 20/20 => Loss 1.686, Train_accy 96.17
2024-09-12 00:46:48,892 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 00:47:38,957 [icarl.py] => Exemplar size: 2200
2024-09-12 00:47:38,958 [trainer.py] => CNN: {'total': 88.56, '00-09': 83.05, '10-19': 82.17, '20-29': 91.75, '30-39': 78.18, '40-49': 88.79, '50-59': 87.39, '60-69': 86.79, '70-79': 92.91, '80-89': 93.98, '90-99': 92.65, '100-109': 94.78, 'old': 87.96, 'new': 94.78}
2024-09-12 00:47:38,958 [trainer.py] => NME: {'total': 89.1, '00-09': 83.05, '10-19': 86.05, '20-29': 96.91, '30-39': 80.91, '40-49': 93.46, '50-59': 88.29, '60-69': 83.96, '70-79': 91.49, '80-89': 94.74, '90-99': 89.71, '100-109': 91.3, 'old': 88.89, 'new': 91.3}
2024-09-12 00:47:38,958 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56]
2024-09-12 00:47:38,958 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54]
2024-09-12 00:47:38,958 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1]
2024-09-12 00:47:38,958 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31]

Average Accuracy (CNN): 91.89
Average Accuracy (NME): 93.18
2024-09-12 00:47:38,958 [trainer.py] => Average Accuracy (CNN): 91.89
2024-09-12 00:47:38,958 [trainer.py] => Average Accuracy (NME): 93.18
2024-09-12 00:47:38,958 [trainer.py] => All params: 85883246
2024-09-12 00:47:38,959 [trainer.py] => Trainable params: 85883246
2024-09-12 00:47:38,960 [icarl.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.201, Train_accy 87.31, Test_accy 83.55:   0%|          | 0/20 [00:36<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.201, Train_accy 87.31, Test_accy 83.55:   5%|▌         | 1/20 [00:36<11:31, 36.40s/it]
Task 11, Epoch 2/20 => Loss 1.753, Train_accy 93.64:   5%|▌         | 1/20 [01:07<11:31, 36.40s/it]                 
Task 11, Epoch 2/20 => Loss 1.753, Train_accy 93.64:  10%|█         | 2/20 [01:07<10:03, 33.52s/it]
Task 11, Epoch 3/20 => Loss 1.724, Train_accy 94.61:  10%|█         | 2/20 [01:39<10:03, 33.52s/it]
Task 11, Epoch 3/20 => Loss 1.724, Train_accy 94.61:  15%|█▌        | 3/20 [01:39<09:15, 32.67s/it]
Task 11, Epoch 4/20 => Loss 1.665, Train_accy 95.39:  15%|█▌        | 3/20 [02:11<09:15, 32.67s/it]
Task 11, Epoch 4/20 => Loss 1.665, Train_accy 95.39:  20%|██        | 4/20 [02:11<08:36, 32.30s/it]
Task 11, Epoch 5/20 => Loss 1.699, Train_accy 95.66:  20%|██        | 4/20 [02:42<08:36, 32.30s/it]
Task 11, Epoch 5/20 => Loss 1.699, Train_accy 95.66:  25%|██▌       | 5/20 [02:42<08:01, 32.08s/it]
Task 11, Epoch 6/20 => Loss 1.665, Train_accy 95.77, Test_accy 86.51:  25%|██▌       | 5/20 [03:19<08:01, 32.08s/it]
Task 11, Epoch 6/20 => Loss 1.665, Train_accy 95.77, Test_accy 86.51:  30%|███       | 6/20 [03:19<07:50, 33.62s/it]
Task 11, Epoch 7/20 => Loss 1.693, Train_accy 95.84:  30%|███       | 6/20 [03:51<07:50, 33.62s/it]                 
Task 11, Epoch 7/20 => Loss 1.693, Train_accy 95.84:  35%|███▌      | 7/20 [03:51<07:09, 33.03s/it]
Task 11, Epoch 8/20 => Loss 1.711, Train_accy 95.28:  35%|███▌      | 7/20 [04:23<07:09, 33.03s/it]
Task 11, Epoch 8/20 => Loss 1.711, Train_accy 95.28:  40%|████      | 8/20 [04:23<06:31, 32.61s/it]
Task 11, Epoch 9/20 => Loss 1.694, Train_accy 95.66:  40%|████      | 8/20 [04:54<06:31, 32.61s/it]
Task 11, Epoch 9/20 => Loss 1.694, Train_accy 95.66:  45%|████▌     | 9/20 [04:54<05:55, 32.34s/it]
Task 11, Epoch 10/20 => Loss 1.656, Train_accy 95.88:  45%|████▌     | 9/20 [05:26<05:55, 32.34s/it]
Task 11, Epoch 10/20 => Loss 1.656, Train_accy 95.88:  50%|█████     | 10/20 [05:26<05:21, 32.19s/it]
Task 11, Epoch 11/20 => Loss 1.657, Train_accy 96.29, Test_accy 86.23:  50%|█████     | 10/20 [06:03<05:21, 32.19s/it]
Task 11, Epoch 11/20 => Loss 1.657, Train_accy 96.29, Test_accy 86.23:  55%|█████▌    | 11/20 [06:03<05:02, 33.62s/it]
Task 11, Epoch 12/20 => Loss 1.624, Train_accy 96.33:  55%|█████▌    | 11/20 [06:35<05:02, 33.62s/it]                 
Task 11, Epoch 12/20 => Loss 1.624, Train_accy 96.33:  60%|██████    | 12/20 [06:35<04:24, 33.05s/it]
Task 11, Epoch 13/20 => Loss 1.650, Train_accy 96.37:  60%|██████    | 12/20 [07:06<04:24, 33.05s/it]
Task 11, Epoch 13/20 => Loss 1.650, Train_accy 96.37:  65%|██████▌   | 13/20 [07:06<03:48, 32.62s/it]
Task 11, Epoch 14/20 => Loss 1.666, Train_accy 95.58:  65%|██████▌   | 13/20 [07:38<03:48, 32.62s/it]
Task 11, Epoch 14/20 => Loss 1.666, Train_accy 95.58:  70%|███████   | 14/20 [07:38<03:13, 32.33s/it]
Task 11, Epoch 15/20 => Loss 1.684, Train_accy 96.74:  70%|███████   | 14/20 [08:10<03:13, 32.33s/it]
Task 11, Epoch 15/20 => Loss 1.684, Train_accy 96.74:  75%|███████▌  | 15/20 [08:10<02:40, 32.13s/it]
Task 11, Epoch 16/20 => Loss 1.641, Train_accy 96.56, Test_accy 85.66:  75%|███████▌  | 15/20 [08:47<02:40, 32.13s/it]
Task 11, Epoch 16/20 => Loss 1.641, Train_accy 96.56, Test_accy 85.66:  80%|████████  | 16/20 [08:47<02:14, 33.55s/it]
Task 11, Epoch 17/20 => Loss 1.639, Train_accy 96.33:  80%|████████  | 16/20 [09:18<02:14, 33.55s/it]                 
Task 11, Epoch 17/20 => Loss 1.639, Train_accy 96.33:  85%|████████▌ | 17/20 [09:18<01:39, 33.02s/it]
Task 11, Epoch 18/20 => Loss 1.642, Train_accy 96.74:  85%|████████▌ | 17/20 [09:50<01:39, 33.02s/it]
Task 11, Epoch 18/20 => Loss 1.642, Train_accy 96.74:  90%|█████████ | 18/20 [09:50<01:05, 32.62s/it]
Task 11, Epoch 19/20 => Loss 1.605, Train_accy 96.93:  90%|█████████ | 18/20 [10:22<01:05, 32.62s/it]
Task 11, Epoch 19/20 => Loss 1.605, Train_accy 96.93:  95%|█████████▌| 19/20 [10:22<00:32, 32.33s/it]
Task 11, Epoch 20/20 => Loss 1.610, Train_accy 96.97:  95%|█████████▌| 19/20 [10:53<00:32, 32.33s/it]
Task 11, Epoch 20/20 => Loss 1.610, Train_accy 96.97: 100%|██████████| 20/20 [10:53<00:00, 32.12s/it]
Task 11, Epoch 20/20 => Loss 1.610, Train_accy 96.97: 100%|██████████| 20/20 [10:53<00:00, 32.70s/it]
2024-09-12 00:58:32,882 [icarl.py] => Task 11, Epoch 20/20 => Loss 1.610, Train_accy 96.97
2024-09-12 00:58:32,883 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 00:59:26,955 [icarl.py] => Exemplar size: 2400
2024-09-12 00:59:26,955 [trainer.py] => CNN: {'total': 86.86, '00-09': 78.81, '10-19': 80.62, '20-29': 90.72, '30-39': 74.55, '40-49': 87.85, '50-59': 81.08, '60-69': 85.85, '70-79': 90.78, '80-89': 92.48, '90-99': 92.65, '100-109': 93.91, '110-119': 91.15, 'old': 86.49, 'new': 91.15}
2024-09-12 00:59:26,955 [trainer.py] => NME: {'total': 87.5, '00-09': 79.66, '10-19': 86.82, '20-29': 96.91, '30-39': 81.82, '40-49': 93.46, '50-59': 85.59, '60-69': 82.08, '70-79': 87.23, '80-89': 93.98, '90-99': 88.24, '100-109': 89.57, '110-119': 84.96, 'old': 87.72, 'new': 84.96}
2024-09-12 00:59:26,955 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86]
2024-09-12 00:59:26,955 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39]
2024-09-12 00:59:26,956 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5]
2024-09-12 00:59:26,956 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38]

Average Accuracy (CNN): 91.47
Average Accuracy (NME): 92.71
2024-09-12 00:59:26,956 [trainer.py] => Average Accuracy (CNN): 91.47
2024-09-12 00:59:26,956 [trainer.py] => Average Accuracy (NME): 92.71
2024-09-12 00:59:26,956 [trainer.py] => All params: 85890936
2024-09-12 00:59:26,957 [trainer.py] => Trainable params: 85890936
2024-09-12 00:59:26,958 [icarl.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.201, Train_accy 88.38, Test_accy 83.26:   0%|          | 0/20 [00:39<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.201, Train_accy 88.38, Test_accy 83.26:   5%|▌         | 1/20 [00:39<12:25, 39.23s/it]
Task 12, Epoch 2/20 => Loss 1.883, Train_accy 93.16:   5%|▌         | 1/20 [01:13<12:25, 39.23s/it]                 
Task 12, Epoch 2/20 => Loss 1.883, Train_accy 93.16:  10%|█         | 2/20 [01:13<10:50, 36.15s/it]
Task 12, Epoch 3/20 => Loss 2.072, Train_accy 90.74:  10%|█         | 2/20 [01:47<10:50, 36.15s/it]
Task 12, Epoch 3/20 => Loss 2.072, Train_accy 90.74:  15%|█▌        | 3/20 [01:47<09:58, 35.20s/it]
Task 12, Epoch 4/20 => Loss 1.931, Train_accy 93.06:  15%|█▌        | 3/20 [02:21<09:58, 35.20s/it]
Task 12, Epoch 4/20 => Loss 1.931, Train_accy 93.06:  20%|██        | 4/20 [02:21<09:16, 34.79s/it]
Task 12, Epoch 5/20 => Loss 2.127, Train_accy 89.14:  20%|██        | 4/20 [02:55<09:16, 34.79s/it]
Task 12, Epoch 5/20 => Loss 2.127, Train_accy 89.14:  25%|██▌       | 5/20 [02:55<08:38, 34.56s/it]
Task 12, Epoch 6/20 => Loss 1.864, Train_accy 93.86, Test_accy 83.26:  25%|██▌       | 5/20 [03:35<08:38, 34.56s/it]
Task 12, Epoch 6/20 => Loss 1.864, Train_accy 93.86, Test_accy 83.26:  30%|███       | 6/20 [03:35<08:27, 36.27s/it]
Task 12, Epoch 7/20 => Loss 1.823, Train_accy 94.52:  30%|███       | 6/20 [04:09<08:27, 36.27s/it]                 
Task 12, Epoch 7/20 => Loss 1.823, Train_accy 94.52:  35%|███▌      | 7/20 [04:09<07:42, 35.60s/it]
Task 12, Epoch 8/20 => Loss 1.809, Train_accy 94.80:  35%|███▌      | 7/20 [04:43<07:42, 35.60s/it]
Task 12, Epoch 8/20 => Loss 1.809, Train_accy 94.80:  40%|████      | 8/20 [04:43<07:01, 35.14s/it]
Task 12, Epoch 9/20 => Loss 1.822, Train_accy 94.97:  40%|████      | 8/20 [05:17<07:01, 35.14s/it]
Task 12, Epoch 9/20 => Loss 1.822, Train_accy 94.97:  45%|████▌     | 9/20 [05:17<06:23, 34.84s/it]
Task 12, Epoch 10/20 => Loss 1.793, Train_accy 95.07:  45%|████▌     | 9/20 [05:52<06:23, 34.84s/it]
Task 12, Epoch 10/20 => Loss 1.793, Train_accy 95.07:  50%|█████     | 10/20 [05:52<05:46, 34.69s/it]
Task 12, Epoch 11/20 => Loss 1.792, Train_accy 95.21, Test_accy 84.70:  50%|█████     | 10/20 [06:31<05:46, 34.69s/it]
Task 12, Epoch 11/20 => Loss 1.792, Train_accy 95.21, Test_accy 84.70:  55%|█████▌    | 11/20 [06:31<05:26, 36.25s/it]
Task 12, Epoch 12/20 => Loss 1.730, Train_accy 96.39:  55%|█████▌    | 11/20 [07:06<05:26, 36.25s/it]                 
Task 12, Epoch 12/20 => Loss 1.730, Train_accy 96.39:  60%|██████    | 12/20 [07:06<04:44, 35.60s/it]
Task 12, Epoch 13/20 => Loss 1.810, Train_accy 95.77:  60%|██████    | 12/20 [07:40<04:44, 35.60s/it]
Task 12, Epoch 13/20 => Loss 1.810, Train_accy 95.77:  65%|██████▌   | 13/20 [07:40<04:06, 35.16s/it]
Task 12, Epoch 14/20 => Loss 1.690, Train_accy 96.32:  65%|██████▌   | 13/20 [08:14<04:06, 35.16s/it]
Task 12, Epoch 14/20 => Loss 1.690, Train_accy 96.32:  70%|███████   | 14/20 [08:14<03:29, 34.84s/it]
Task 12, Epoch 15/20 => Loss 1.742, Train_accy 96.70:  70%|███████   | 14/20 [08:48<03:29, 34.84s/it]
Task 12, Epoch 15/20 => Loss 1.742, Train_accy 96.70:  75%|███████▌  | 15/20 [08:48<02:53, 34.65s/it]
Task 12, Epoch 16/20 => Loss 1.695, Train_accy 96.67, Test_accy 86.28:  75%|███████▌  | 15/20 [09:28<02:53, 34.65s/it]
Task 12, Epoch 16/20 => Loss 1.695, Train_accy 96.67, Test_accy 86.28:  80%|████████  | 16/20 [09:28<02:24, 36.16s/it]
Task 12, Epoch 17/20 => Loss 1.738, Train_accy 96.43:  80%|████████  | 16/20 [10:02<02:24, 36.16s/it]                 
Task 12, Epoch 17/20 => Loss 1.738, Train_accy 96.43:  85%|████████▌ | 17/20 [10:02<01:46, 35.56s/it]
Task 12, Epoch 18/20 => Loss 1.739, Train_accy 96.50:  85%|████████▌ | 17/20 [10:36<01:46, 35.56s/it]
Task 12, Epoch 18/20 => Loss 1.739, Train_accy 96.50:  90%|█████████ | 18/20 [10:36<01:10, 35.14s/it]
Task 12, Epoch 19/20 => Loss 1.736, Train_accy 96.74:  90%|█████████ | 18/20 [11:10<01:10, 35.14s/it]
Task 12, Epoch 19/20 => Loss 1.736, Train_accy 96.74:  95%|█████████▌| 19/20 [11:10<00:34, 34.81s/it]
Task 12, Epoch 20/20 => Loss 1.718, Train_accy 96.22:  95%|█████████▌| 19/20 [11:44<00:34, 34.81s/it]
Task 12, Epoch 20/20 => Loss 1.718, Train_accy 96.22: 100%|██████████| 20/20 [11:44<00:00, 34.60s/it]
Task 12, Epoch 20/20 => Loss 1.718, Train_accy 96.22: 100%|██████████| 20/20 [11:44<00:00, 35.23s/it]
2024-09-12 01:11:11,600 [icarl.py] => Task 12, Epoch 20/20 => Loss 1.718, Train_accy 96.22
2024-09-12 01:11:11,602 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 01:12:09,664 [icarl.py] => Exemplar size: 2600
2024-09-12 01:12:09,664 [trainer.py] => CNN: {'total': 85.03, '00-09': 79.66, '10-19': 79.07, '20-29': 92.78, '30-39': 70.0, '40-49': 81.31, '50-59': 81.08, '60-69': 83.96, '70-79': 87.94, '80-89': 90.98, '90-99': 86.76, '100-109': 91.3, '110-119': 89.38, '120-129': 90.65, 'old': 84.6, 'new': 90.65}
2024-09-12 01:12:09,664 [trainer.py] => NME: {'total': 86.54, '00-09': 83.9, '10-19': 87.6, '20-29': 93.81, '30-39': 81.82, '40-49': 88.79, '50-59': 83.78, '60-69': 81.13, '70-79': 86.52, '80-89': 92.48, '90-99': 87.5, '100-109': 90.43, '110-119': 81.42, '120-129': 85.05, 'old': 86.65, 'new': 85.05}
2024-09-12 01:12:09,664 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03]
2024-09-12 01:12:09,664 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05]
2024-09-12 01:12:09,664 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54]
2024-09-12 01:12:09,664 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23]

Average Accuracy (CNN): 90.97
Average Accuracy (NME): 92.23
2024-09-12 01:12:09,664 [trainer.py] => Average Accuracy (CNN): 90.97
2024-09-12 01:12:09,664 [trainer.py] => Average Accuracy (NME): 92.23
2024-09-12 01:12:09,665 [trainer.py] => All params: 85898626
2024-09-12 01:12:09,665 [trainer.py] => Trainable params: 85898626
2024-09-12 01:12:09,667 [icarl.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.148, Train_accy 89.00, Test_accy 83.79:   0%|          | 0/20 [00:41<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.148, Train_accy 89.00, Test_accy 83.79:   5%|▌         | 1/20 [00:41<13:14, 41.80s/it]
Task 13, Epoch 2/20 => Loss 1.723, Train_accy 94.53:   5%|▌         | 1/20 [01:18<13:14, 41.80s/it]                 
Task 13, Epoch 2/20 => Loss 1.723, Train_accy 94.53:  10%|█         | 2/20 [01:18<11:33, 38.54s/it]
Task 13, Epoch 3/20 => Loss 1.723, Train_accy 95.15:  10%|█         | 2/20 [01:54<11:33, 38.54s/it]
Task 13, Epoch 3/20 => Loss 1.723, Train_accy 95.15:  15%|█▌        | 3/20 [01:54<10:38, 37.53s/it]
Task 13, Epoch 4/20 => Loss 1.714, Train_accy 95.57:  15%|█▌        | 3/20 [02:30<10:38, 37.53s/it]
Task 13, Epoch 4/20 => Loss 1.714, Train_accy 95.57:  20%|██        | 4/20 [02:30<09:53, 37.09s/it]
Task 13, Epoch 5/20 => Loss 1.672, Train_accy 96.00:  20%|██        | 4/20 [03:07<09:53, 37.09s/it]
Task 13, Epoch 5/20 => Loss 1.672, Train_accy 96.00:  25%|██▌       | 5/20 [03:07<09:12, 36.83s/it]
Task 13, Epoch 6/20 => Loss 1.695, Train_accy 95.87, Test_accy 84.40:  25%|██▌       | 5/20 [03:49<09:12, 36.83s/it]
Task 13, Epoch 6/20 => Loss 1.695, Train_accy 95.87, Test_accy 84.40:  30%|███       | 6/20 [03:49<09:01, 38.66s/it]
Task 13, Epoch 7/20 => Loss 1.696, Train_accy 95.77:  30%|███       | 6/20 [04:25<09:01, 38.66s/it]                 
Task 13, Epoch 7/20 => Loss 1.696, Train_accy 95.77:  35%|███▌      | 7/20 [04:25<08:12, 37.90s/it]
Task 13, Epoch 8/20 => Loss 1.698, Train_accy 95.93:  35%|███▌      | 7/20 [05:02<08:12, 37.90s/it]
Task 13, Epoch 8/20 => Loss 1.698, Train_accy 95.93:  40%|████      | 8/20 [05:02<07:28, 37.41s/it]
Task 13, Epoch 9/20 => Loss 1.727, Train_accy 96.00:  40%|████      | 8/20 [05:38<07:28, 37.41s/it]
Task 13, Epoch 9/20 => Loss 1.727, Train_accy 96.00:  45%|████▌     | 9/20 [05:38<06:47, 37.07s/it]
Task 13, Epoch 10/20 => Loss 1.661, Train_accy 96.13:  45%|████▌     | 9/20 [06:14<06:47, 37.07s/it]
Task 13, Epoch 10/20 => Loss 1.661, Train_accy 96.13:  50%|█████     | 10/20 [06:14<06:08, 36.84s/it]
Task 13, Epoch 11/20 => Loss 1.681, Train_accy 96.45, Test_accy 83.79:  50%|█████     | 10/20 [06:56<06:08, 36.84s/it]
Task 13, Epoch 11/20 => Loss 1.681, Train_accy 96.45, Test_accy 83.79:  55%|█████▌    | 11/20 [06:56<05:46, 38.46s/it]
Task 13, Epoch 12/20 => Loss 1.663, Train_accy 96.42:  55%|█████▌    | 11/20 [07:33<05:46, 38.46s/it]                 
Task 13, Epoch 12/20 => Loss 1.663, Train_accy 96.42:  60%|██████    | 12/20 [07:33<05:02, 37.81s/it]
Task 13, Epoch 13/20 => Loss 1.653, Train_accy 96.48:  60%|██████    | 12/20 [08:09<05:02, 37.81s/it]
Task 13, Epoch 13/20 => Loss 1.653, Train_accy 96.48:  65%|██████▌   | 13/20 [08:09<04:21, 37.36s/it]
Task 13, Epoch 14/20 => Loss 1.663, Train_accy 96.19:  65%|██████▌   | 13/20 [08:45<04:21, 37.36s/it]
Task 13, Epoch 14/20 => Loss 1.663, Train_accy 96.19:  70%|███████   | 14/20 [08:45<03:42, 37.05s/it]
Task 13, Epoch 15/20 => Loss 1.669, Train_accy 96.39:  70%|███████   | 14/20 [09:22<03:42, 37.05s/it]
Task 13, Epoch 15/20 => Loss 1.669, Train_accy 96.39:  75%|███████▌  | 15/20 [09:22<03:04, 36.85s/it]
Task 13, Epoch 16/20 => Loss 1.649, Train_accy 96.88, Test_accy 84.70:  75%|███████▌  | 15/20 [10:04<03:04, 36.85s/it]
Task 13, Epoch 16/20 => Loss 1.649, Train_accy 96.88, Test_accy 84.70:  80%|████████  | 16/20 [10:04<02:34, 38.51s/it]
Task 13, Epoch 17/20 => Loss 1.674, Train_accy 96.55:  80%|████████  | 16/20 [10:41<02:34, 38.51s/it]                 
Task 13, Epoch 17/20 => Loss 1.674, Train_accy 96.55:  85%|████████▌ | 17/20 [10:41<01:53, 37.89s/it]
Task 13, Epoch 18/20 => Loss 1.671, Train_accy 96.39:  85%|████████▌ | 17/20 [11:17<01:53, 37.89s/it]
Task 13, Epoch 18/20 => Loss 1.671, Train_accy 96.39:  90%|█████████ | 18/20 [11:17<01:14, 37.46s/it]
Task 13, Epoch 19/20 => Loss 1.641, Train_accy 96.42:  90%|█████████ | 18/20 [11:53<01:14, 37.46s/it]
Task 13, Epoch 19/20 => Loss 1.641, Train_accy 96.42:  95%|█████████▌| 19/20 [11:53<00:37, 37.13s/it]
Task 13, Epoch 20/20 => Loss 1.668, Train_accy 96.26:  95%|█████████▌| 19/20 [12:30<00:37, 37.13s/it]
Task 13, Epoch 20/20 => Loss 1.668, Train_accy 96.26: 100%|██████████| 20/20 [12:30<00:00, 36.91s/it]
Task 13, Epoch 20/20 => Loss 1.668, Train_accy 96.26: 100%|██████████| 20/20 [12:30<00:00, 37.51s/it]
2024-09-12 01:24:39,933 [icarl.py] => Task 13, Epoch 20/20 => Loss 1.668, Train_accy 96.26
2024-09-12 01:24:39,934 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 01:25:41,987 [icarl.py] => Exemplar size: 2800
2024-09-12 01:25:41,987 [trainer.py] => CNN: {'total': 84.77, '00-09': 77.97, '10-19': 80.62, '20-29': 91.75, '30-39': 73.64, '40-49': 79.44, '50-59': 78.38, '60-69': 86.79, '70-79': 87.94, '80-89': 87.22, '90-99': 85.29, '100-109': 89.57, '110-119': 89.38, '120-129': 83.18, '130-139': 94.92, 'old': 83.98, 'new': 94.92}
2024-09-12 01:25:41,987 [trainer.py] => NME: {'total': 86.65, '00-09': 83.05, '10-19': 84.5, '20-29': 92.78, '30-39': 82.73, '40-49': 88.79, '50-59': 84.68, '60-69': 84.91, '70-79': 87.94, '80-89': 91.73, '90-99': 86.76, '100-109': 88.7, '110-119': 87.61, '120-129': 80.37, '130-139': 88.14, 'old': 86.54, 'new': 88.14}
2024-09-12 01:25:41,987 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03, 84.77]
2024-09-12 01:25:41,987 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05, 96.89]
2024-09-12 01:25:41,987 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54, 86.65]
2024-09-12 01:25:41,987 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23, 98.11]

Average Accuracy (CNN): 90.53
Average Accuracy (NME): 91.84
2024-09-12 01:25:41,987 [trainer.py] => Average Accuracy (CNN): 90.53
2024-09-12 01:25:41,987 [trainer.py] => Average Accuracy (NME): 91.84
2024-09-12 01:25:41,988 [trainer.py] => All params: 85906316
2024-09-12 01:25:41,988 [trainer.py] => Trainable params: 85906316
2024-09-12 01:25:41,990 [icarl.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.157, Train_accy 90.22, Test_accy 81.38:   0%|          | 0/20 [00:44<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.157, Train_accy 90.22, Test_accy 81.38:   5%|▌         | 1/20 [00:44<13:59, 44.21s/it]
Task 14, Epoch 2/20 => Loss 1.814, Train_accy 94.07:   5%|▌         | 1/20 [01:22<13:59, 44.21s/it]                 
Task 14, Epoch 2/20 => Loss 1.814, Train_accy 94.07:  10%|█         | 2/20 [01:22<12:12, 40.69s/it]
Task 14, Epoch 3/20 => Loss 1.755, Train_accy 95.39:  10%|█         | 2/20 [02:00<12:12, 40.69s/it]
Task 14, Epoch 3/20 => Loss 1.755, Train_accy 95.39:  15%|█▌        | 3/20 [02:00<11:13, 39.62s/it]
Task 14, Epoch 4/20 => Loss 1.762, Train_accy 95.05:  15%|█▌        | 3/20 [02:39<11:13, 39.62s/it]
Task 14, Epoch 4/20 => Loss 1.762, Train_accy 95.05:  20%|██        | 4/20 [02:39<10:26, 39.18s/it]
Task 14, Epoch 5/20 => Loss 1.734, Train_accy 95.97:  20%|██        | 4/20 [03:17<10:26, 39.18s/it]
Task 14, Epoch 5/20 => Loss 1.734, Train_accy 95.97:  25%|██▌       | 5/20 [03:17<09:43, 38.92s/it]
Task 14, Epoch 6/20 => Loss 1.733, Train_accy 95.51, Test_accy 83.08:  25%|██▌       | 5/20 [04:02<09:43, 38.92s/it]
Task 14, Epoch 6/20 => Loss 1.733, Train_accy 95.51, Test_accy 83.08:  30%|███       | 6/20 [04:02<09:33, 40.95s/it]
Task 14, Epoch 7/20 => Loss 1.741, Train_accy 95.85:  30%|███       | 6/20 [04:41<09:33, 40.95s/it]                 
Task 14, Epoch 7/20 => Loss 1.741, Train_accy 95.85:  35%|███▌      | 7/20 [04:41<08:42, 40.18s/it]
Task 14, Epoch 8/20 => Loss 1.727, Train_accy 96.40:  35%|███▌      | 7/20 [05:19<08:42, 40.18s/it]
Task 14, Epoch 8/20 => Loss 1.727, Train_accy 96.40:  40%|████      | 8/20 [05:19<07:55, 39.66s/it]
Task 14, Epoch 9/20 => Loss 1.768, Train_accy 95.94:  40%|████      | 8/20 [05:58<07:55, 39.66s/it]
Task 14, Epoch 9/20 => Loss 1.768, Train_accy 95.94:  45%|████▌     | 9/20 [05:58<07:12, 39.28s/it]
Task 14, Epoch 10/20 => Loss 1.717, Train_accy 96.34:  45%|████▌     | 9/20 [06:36<07:12, 39.28s/it]
Task 14, Epoch 10/20 => Loss 1.717, Train_accy 96.34:  50%|█████     | 10/20 [06:36<06:30, 39.02s/it]
Task 14, Epoch 11/20 => Loss 1.742, Train_accy 96.53, Test_accy 83.02:  50%|█████     | 10/20 [07:21<06:30, 39.02s/it]
Task 14, Epoch 11/20 => Loss 1.742, Train_accy 96.53, Test_accy 83.02:  55%|█████▌    | 11/20 [07:21<06:06, 40.74s/it]
Task 14, Epoch 12/20 => Loss 1.745, Train_accy 96.37:  55%|█████▌    | 11/20 [07:59<06:06, 40.74s/it]                 
Task 14, Epoch 12/20 => Loss 1.745, Train_accy 96.37:  60%|██████    | 12/20 [07:59<05:20, 40.04s/it]
Task 14, Epoch 13/20 => Loss 1.740, Train_accy 96.34:  60%|██████    | 12/20 [08:38<05:20, 40.04s/it]
Task 14, Epoch 13/20 => Loss 1.740, Train_accy 96.34:  65%|██████▌   | 13/20 [08:38<04:36, 39.57s/it]
Task 14, Epoch 14/20 => Loss 1.712, Train_accy 96.65:  65%|██████▌   | 13/20 [09:16<04:36, 39.57s/it]
Task 14, Epoch 14/20 => Loss 1.712, Train_accy 96.65:  70%|███████   | 14/20 [09:16<03:55, 39.26s/it]
Task 14, Epoch 15/20 => Loss 1.733, Train_accy 96.71:  70%|███████   | 14/20 [09:55<03:55, 39.26s/it]
Task 14, Epoch 15/20 => Loss 1.733, Train_accy 96.71:  75%|███████▌  | 15/20 [09:55<03:15, 39.04s/it]
Task 14, Epoch 16/20 => Loss 1.753, Train_accy 96.37, Test_accy 83.42:  75%|███████▌  | 15/20 [10:40<03:15, 39.04s/it]
Task 14, Epoch 16/20 => Loss 1.753, Train_accy 96.37, Test_accy 83.42:  80%|████████  | 16/20 [10:40<02:43, 40.77s/it]
Task 14, Epoch 17/20 => Loss 1.756, Train_accy 96.00:  80%|████████  | 16/20 [11:18<02:43, 40.77s/it]                 
Task 14, Epoch 17/20 => Loss 1.756, Train_accy 96.00:  85%|████████▌ | 17/20 [11:18<02:00, 40.10s/it]
Task 14, Epoch 18/20 => Loss 1.741, Train_accy 96.43:  85%|████████▌ | 17/20 [11:57<02:00, 40.10s/it]
Task 14, Epoch 18/20 => Loss 1.741, Train_accy 96.43:  90%|█████████ | 18/20 [11:57<01:19, 39.63s/it]
Task 14, Epoch 19/20 => Loss 1.705, Train_accy 96.96:  90%|█████████ | 18/20 [12:35<01:19, 39.63s/it]
Task 14, Epoch 19/20 => Loss 1.705, Train_accy 96.96:  95%|█████████▌| 19/20 [12:35<00:39, 39.31s/it]
Task 14, Epoch 20/20 => Loss 1.717, Train_accy 96.96:  95%|█████████▌| 19/20 [13:14<00:39, 39.31s/it]
Task 14, Epoch 20/20 => Loss 1.717, Train_accy 96.96: 100%|██████████| 20/20 [13:14<00:00, 39.10s/it]
Task 14, Epoch 20/20 => Loss 1.717, Train_accy 96.96: 100%|██████████| 20/20 [13:14<00:00, 39.72s/it]
2024-09-12 01:38:56,320 [icarl.py] => Task 14, Epoch 20/20 => Loss 1.717, Train_accy 96.96
2024-09-12 01:38:56,322 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 01:40:02,432 [icarl.py] => Exemplar size: 3000
2024-09-12 01:40:02,432 [trainer.py] => CNN: {'total': 83.19, '00-09': 72.03, '10-19': 80.62, '20-29': 88.66, '30-39': 68.18, '40-49': 77.57, '50-59': 80.18, '60-69': 81.13, '70-79': 85.11, '80-89': 87.22, '90-99': 85.29, '100-109': 85.22, '110-119': 85.84, '120-129': 81.31, '130-139': 94.92, '140-149': 92.06, 'old': 82.51, 'new': 92.06}
2024-09-12 01:40:02,432 [trainer.py] => NME: {'total': 85.74, '00-09': 81.36, '10-19': 85.27, '20-29': 94.85, '30-39': 81.82, '40-49': 88.79, '50-59': 82.88, '60-69': 80.19, '70-79': 85.82, '80-89': 91.73, '90-99': 86.76, '100-109': 89.57, '110-119': 81.42, '120-129': 79.44, '130-139': 86.44, '140-149': 88.89, 'old': 85.5, 'new': 88.89}
2024-09-12 01:40:02,432 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03, 84.77, 83.19]
2024-09-12 01:40:02,432 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05, 96.89, 96.49]
2024-09-12 01:40:02,432 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54, 86.65, 85.74]
2024-09-12 01:40:02,432 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23, 98.11, 98.08]

Average Accuracy (CNN): 90.04
Average Accuracy (NME): 91.43
2024-09-12 01:40:02,433 [trainer.py] => Average Accuracy (CNN): 90.04
2024-09-12 01:40:02,433 [trainer.py] => Average Accuracy (NME): 91.43
2024-09-12 01:40:02,433 [trainer.py] => All params: 85914006
2024-09-12 01:40:02,434 [trainer.py] => Trainable params: 85914006
2024-09-12 01:40:02,435 [icarl.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.195, Train_accy 89.48, Test_accy 79.53:   0%|          | 0/20 [00:47<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.195, Train_accy 89.48, Test_accy 79.53:   5%|▌         | 1/20 [00:47<14:55, 47.15s/it]
Task 15, Epoch 2/20 => Loss 1.859, Train_accy 93.97:   5%|▌         | 1/20 [01:28<14:55, 47.15s/it]                 
Task 15, Epoch 2/20 => Loss 1.859, Train_accy 93.97:  10%|█         | 2/20 [01:28<13:02, 43.48s/it]
Task 15, Epoch 3/20 => Loss 1.804, Train_accy 95.16:  10%|█         | 2/20 [02:08<13:02, 43.48s/it]
Task 15, Epoch 3/20 => Loss 1.804, Train_accy 95.16:  15%|█▌        | 3/20 [02:08<11:58, 42.28s/it]
Task 15, Epoch 4/20 => Loss 1.830, Train_accy 95.30:  15%|█▌        | 3/20 [02:49<11:58, 42.28s/it]
Task 15, Epoch 4/20 => Loss 1.830, Train_accy 95.30:  20%|██        | 4/20 [02:49<11:08, 41.75s/it]
Task 15, Epoch 5/20 => Loss 1.776, Train_accy 96.11:  20%|██        | 4/20 [03:31<11:08, 41.75s/it]
Task 15, Epoch 5/20 => Loss 1.776, Train_accy 96.11:  25%|██▌       | 5/20 [03:31<10:23, 41.54s/it]
Task 15, Epoch 6/20 => Loss 1.795, Train_accy 95.99, Test_accy 81.60:  25%|██▌       | 5/20 [04:18<10:23, 41.54s/it]
Task 15, Epoch 6/20 => Loss 1.795, Train_accy 95.99, Test_accy 81.60:  30%|███       | 6/20 [04:18<10:11, 43.66s/it]
Task 15, Epoch 7/20 => Loss 1.839, Train_accy 95.42:  30%|███       | 6/20 [04:59<10:11, 43.66s/it]                 
Task 15, Epoch 7/20 => Loss 1.839, Train_accy 95.42:  35%|███▌      | 7/20 [04:59<09:16, 42.78s/it]
Task 15, Epoch 8/20 => Loss 1.787, Train_accy 96.25:  35%|███▌      | 7/20 [05:40<09:16, 42.78s/it]
Task 15, Epoch 8/20 => Loss 1.787, Train_accy 96.25:  40%|████      | 8/20 [05:40<08:26, 42.20s/it]
Task 15, Epoch 9/20 => Loss 1.791, Train_accy 96.66:  40%|████      | 8/20 [06:21<08:26, 42.20s/it]
Task 15, Epoch 9/20 => Loss 1.791, Train_accy 96.66:  45%|████▌     | 9/20 [06:21<07:39, 41.81s/it]
Task 15, Epoch 10/20 => Loss 1.758, Train_accy 96.68:  45%|████▌     | 9/20 [07:02<07:39, 41.81s/it]
Task 15, Epoch 10/20 => Loss 1.758, Train_accy 96.68:  50%|█████     | 10/20 [07:02<06:55, 41.58s/it]
Task 15, Epoch 11/20 => Loss 1.764, Train_accy 96.71, Test_accy 81.39:  50%|█████     | 10/20 [07:50<06:55, 41.58s/it]
Task 15, Epoch 11/20 => Loss 1.764, Train_accy 96.71, Test_accy 81.39:  55%|█████▌    | 11/20 [07:50<06:31, 43.47s/it]
Task 15, Epoch 12/20 => Loss 1.766, Train_accy 96.51:  55%|█████▌    | 11/20 [08:31<06:31, 43.47s/it]                 
Task 15, Epoch 12/20 => Loss 1.766, Train_accy 96.51:  60%|██████    | 12/20 [08:31<05:41, 42.71s/it]
Task 15, Epoch 13/20 => Loss 1.787, Train_accy 96.48:  60%|██████    | 12/20 [09:12<05:41, 42.71s/it]
Task 15, Epoch 13/20 => Loss 1.787, Train_accy 96.48:  65%|██████▌   | 13/20 [09:12<04:55, 42.18s/it]
Task 15, Epoch 14/20 => Loss 1.787, Train_accy 96.86:  65%|██████▌   | 13/20 [09:53<04:55, 42.18s/it]
Task 15, Epoch 14/20 => Loss 1.787, Train_accy 96.86:  70%|███████   | 14/20 [09:53<04:10, 41.82s/it]
Task 15, Epoch 15/20 => Loss 1.808, Train_accy 96.11:  70%|███████   | 14/20 [10:34<04:10, 41.82s/it]
Task 15, Epoch 15/20 => Loss 1.808, Train_accy 96.11:  75%|███████▌  | 15/20 [10:34<03:27, 41.56s/it]
Task 15, Epoch 16/20 => Loss 1.771, Train_accy 96.68, Test_accy 82.60:  75%|███████▌  | 15/20 [11:22<03:27, 41.56s/it]
Task 15, Epoch 16/20 => Loss 1.771, Train_accy 96.68, Test_accy 82.60:  80%|████████  | 16/20 [11:22<02:53, 43.43s/it]
Task 15, Epoch 17/20 => Loss 1.773, Train_accy 96.86:  80%|████████  | 16/20 [12:02<02:53, 43.43s/it]                 
Task 15, Epoch 17/20 => Loss 1.773, Train_accy 96.86:  85%|████████▌ | 17/20 [12:02<02:07, 42.50s/it]
Task 15, Epoch 18/20 => Loss 1.759, Train_accy 96.66:  85%|████████▌ | 17/20 [12:38<02:07, 42.50s/it]
Task 15, Epoch 18/20 => Loss 1.759, Train_accy 96.66:  90%|█████████ | 18/20 [12:38<01:21, 40.52s/it]
Task 15, Epoch 19/20 => Loss 1.718, Train_accy 97.09:  90%|█████████ | 18/20 [13:16<01:21, 40.52s/it]
Task 15, Epoch 19/20 => Loss 1.718, Train_accy 97.09:  95%|█████████▌| 19/20 [13:16<00:39, 39.68s/it]
Task 15, Epoch 20/20 => Loss 1.740, Train_accy 97.32:  95%|█████████▌| 19/20 [13:57<00:39, 39.68s/it]
Task 15, Epoch 20/20 => Loss 1.740, Train_accy 97.32: 100%|██████████| 20/20 [13:57<00:00, 40.14s/it]
Task 15, Epoch 20/20 => Loss 1.740, Train_accy 97.32: 100%|██████████| 20/20 [13:57<00:00, 41.87s/it]
2024-09-12 01:53:59,760 [icarl.py] => Task 15, Epoch 20/20 => Loss 1.740, Train_accy 97.32
2024-09-12 01:53:59,762 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 01:55:10,476 [icarl.py] => Exemplar size: 3200
2024-09-12 01:55:10,476 [trainer.py] => CNN: {'total': 82.97, '00-09': 73.73, '10-19': 84.5, '20-29': 88.66, '30-39': 72.73, '40-49': 80.37, '50-59': 82.88, '60-69': 78.3, '70-79': 81.56, '80-89': 84.96, '90-99': 83.09, '100-109': 79.13, '110-119': 80.53, '120-129': 80.37, '130-139': 88.14, '140-149': 91.27, '150-159': 95.16, 'old': 82.12, 'new': 95.16}
2024-09-12 01:55:10,476 [trainer.py] => NME: {'total': 85.72, '00-09': 83.9, '10-19': 82.17, '20-29': 93.81, '30-39': 81.82, '40-49': 87.85, '50-59': 83.78, '60-69': 80.19, '70-79': 87.94, '80-89': 91.73, '90-99': 87.5, '100-109': 86.96, '110-119': 81.42, '120-129': 78.5, '130-139': 82.2, '140-149': 87.3, '150-159': 92.74, 'old': 85.23, 'new': 92.74}
2024-09-12 01:55:10,476 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03, 84.77, 83.19, 82.97]
2024-09-12 01:55:10,477 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05, 96.89, 96.49, 95.82]
2024-09-12 01:55:10,477 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54, 86.65, 85.74, 85.72]
2024-09-12 01:55:10,477 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23, 98.11, 98.08, 98.15]

Average Accuracy (CNN): 89.6
Average Accuracy (NME): 91.07
2024-09-12 01:55:10,477 [trainer.py] => Average Accuracy (CNN): 89.6
2024-09-12 01:55:10,477 [trainer.py] => Average Accuracy (NME): 91.07
2024-09-12 01:55:10,477 [trainer.py] => All params: 85921696
2024-09-12 01:55:10,478 [trainer.py] => Trainable params: 85921696
2024-09-12 01:55:10,479 [icarl.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.060, Train_accy 91.29, Test_accy 79.16:   0%|          | 0/20 [00:50<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.060, Train_accy 91.29, Test_accy 79.16:   5%|▌         | 1/20 [00:50<15:56, 50.36s/it]
Task 16, Epoch 2/20 => Loss 1.844, Train_accy 94.98:   5%|▌         | 1/20 [01:33<15:56, 50.36s/it]                 
Task 16, Epoch 2/20 => Loss 1.844, Train_accy 94.98:  10%|█         | 2/20 [01:33<13:51, 46.21s/it]
Task 16, Epoch 3/20 => Loss 1.769, Train_accy 96.12:  10%|█         | 2/20 [02:17<13:51, 46.21s/it]
Task 16, Epoch 3/20 => Loss 1.769, Train_accy 96.12:  15%|█▌        | 3/20 [02:17<12:43, 44.91s/it]
Task 16, Epoch 4/20 => Loss 1.826, Train_accy 95.25:  15%|█▌        | 3/20 [03:00<12:43, 44.91s/it]
Task 16, Epoch 4/20 => Loss 1.826, Train_accy 95.25:  20%|██        | 4/20 [03:00<11:49, 44.34s/it]
Task 16, Epoch 5/20 => Loss 1.815, Train_accy 95.88:  20%|██        | 4/20 [03:43<11:49, 44.34s/it]
Task 16, Epoch 5/20 => Loss 1.815, Train_accy 95.88:  25%|██▌       | 5/20 [03:43<10:59, 43.99s/it]
Task 16, Epoch 6/20 => Loss 1.785, Train_accy 96.40, Test_accy 82.42:  25%|██▌       | 5/20 [04:34<10:59, 43.99s/it]
Task 16, Epoch 6/20 => Loss 1.785, Train_accy 96.40, Test_accy 82.42:  30%|███       | 6/20 [04:34<10:47, 46.24s/it]
Task 16, Epoch 7/20 => Loss 1.742, Train_accy 97.13:  30%|███       | 6/20 [05:17<10:47, 46.24s/it]                 
Task 16, Epoch 7/20 => Loss 1.742, Train_accy 97.13:  35%|███▌      | 7/20 [05:17<09:48, 45.29s/it]
Task 16, Epoch 8/20 => Loss 1.825, Train_accy 96.07:  35%|███▌      | 7/20 [06:01<09:48, 45.29s/it]
Task 16, Epoch 8/20 => Loss 1.825, Train_accy 96.07:  40%|████      | 8/20 [06:01<08:56, 44.69s/it]
Task 16, Epoch 9/20 => Loss 1.770, Train_accy 96.67:  40%|████      | 8/20 [06:44<08:56, 44.69s/it]
Task 16, Epoch 9/20 => Loss 1.770, Train_accy 96.67:  45%|████▌     | 9/20 [06:44<08:07, 44.33s/it]
Task 16, Epoch 10/20 => Loss 1.796, Train_accy 96.64:  45%|████▌     | 9/20 [07:28<08:07, 44.33s/it]
Task 16, Epoch 10/20 => Loss 1.796, Train_accy 96.64:  50%|█████     | 10/20 [07:28<07:20, 44.04s/it]
Task 16, Epoch 11/20 => Loss 1.768, Train_accy 96.72, Test_accy 81.53:  50%|█████     | 10/20 [08:18<07:20, 44.04s/it]
Task 16, Epoch 11/20 => Loss 1.768, Train_accy 96.72, Test_accy 81.53:  55%|█████▌    | 11/20 [08:18<06:54, 46.03s/it]
Task 16, Epoch 12/20 => Loss 1.797, Train_accy 96.59:  55%|█████▌    | 11/20 [09:02<06:54, 46.03s/it]                 
Task 16, Epoch 12/20 => Loss 1.797, Train_accy 96.59:  60%|██████    | 12/20 [09:02<06:01, 45.25s/it]
Task 16, Epoch 13/20 => Loss 1.775, Train_accy 96.86:  60%|██████    | 12/20 [09:45<06:01, 45.25s/it]
Task 16, Epoch 13/20 => Loss 1.775, Train_accy 96.86:  65%|██████▌   | 13/20 [09:45<05:12, 44.67s/it]
Task 16, Epoch 14/20 => Loss 1.763, Train_accy 97.16:  65%|██████▌   | 13/20 [10:28<05:12, 44.67s/it]
Task 16, Epoch 14/20 => Loss 1.763, Train_accy 97.16:  70%|███████   | 14/20 [10:28<04:25, 44.25s/it]
Task 16, Epoch 15/20 => Loss 1.779, Train_accy 96.92:  70%|███████   | 14/20 [11:12<04:25, 44.25s/it]
Task 16, Epoch 15/20 => Loss 1.779, Train_accy 96.92:  75%|███████▌  | 15/20 [11:12<03:39, 43.99s/it]
Task 16, Epoch 16/20 => Loss 1.769, Train_accy 96.83, Test_accy 82.96:  75%|███████▌  | 15/20 [12:02<03:39, 43.99s/it]
Task 16, Epoch 16/20 => Loss 1.769, Train_accy 96.83, Test_accy 82.96:  80%|████████  | 16/20 [12:02<03:03, 45.86s/it]
Task 16, Epoch 17/20 => Loss 1.773, Train_accy 96.78:  80%|████████  | 16/20 [12:45<03:03, 45.86s/it]                 
Task 16, Epoch 17/20 => Loss 1.773, Train_accy 96.78:  85%|████████▌ | 17/20 [12:45<02:15, 45.07s/it]
Task 16, Epoch 18/20 => Loss 1.724, Train_accy 97.27:  85%|████████▌ | 17/20 [13:28<02:15, 45.07s/it]
Task 16, Epoch 18/20 => Loss 1.724, Train_accy 97.27:  90%|█████████ | 18/20 [13:28<01:29, 44.51s/it]
Task 16, Epoch 19/20 => Loss 1.754, Train_accy 97.05:  90%|█████████ | 18/20 [14:12<01:29, 44.51s/it]
Task 16, Epoch 19/20 => Loss 1.754, Train_accy 97.05:  95%|█████████▌| 19/20 [14:12<00:44, 44.29s/it]
Task 16, Epoch 20/20 => Loss 1.762, Train_accy 96.75:  95%|█████████▌| 19/20 [14:56<00:44, 44.29s/it]
Task 16, Epoch 20/20 => Loss 1.762, Train_accy 96.75: 100%|██████████| 20/20 [14:56<00:00, 44.12s/it]
Task 16, Epoch 20/20 => Loss 1.762, Train_accy 96.75: 100%|██████████| 20/20 [14:56<00:00, 44.81s/it]
2024-09-12 02:10:06,760 [icarl.py] => Task 16, Epoch 20/20 => Loss 1.762, Train_accy 96.75
2024-09-12 02:10:06,762 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 02:11:20,316 [icarl.py] => Exemplar size: 3400
2024-09-12 02:11:20,316 [trainer.py] => CNN: {'total': 82.81, '00-09': 69.49, '10-19': 84.5, '20-29': 88.66, '30-39': 71.82, '40-49': 77.57, '50-59': 79.28, '60-69': 75.47, '70-79': 82.27, '80-89': 87.22, '90-99': 83.09, '100-109': 84.35, '110-119': 79.65, '120-129': 77.57, '130-139': 88.98, '140-149': 84.92, '150-159': 95.16, '160-169': 93.28, 'old': 82.07, 'new': 93.28}
2024-09-12 02:11:20,316 [trainer.py] => NME: {'total': 85.78, '00-09': 84.75, '10-19': 85.27, '20-29': 93.81, '30-39': 81.82, '40-49': 86.92, '50-59': 82.88, '60-69': 81.13, '70-79': 86.52, '80-89': 92.48, '90-99': 86.03, '100-109': 86.09, '110-119': 81.42, '120-129': 79.44, '130-139': 83.9, '140-149': 82.54, '150-159': 92.74, '160-169': 88.81, 'old': 85.56, 'new': 88.81}
2024-09-12 02:11:20,316 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03, 84.77, 83.19, 82.97, 82.81]
2024-09-12 02:11:20,316 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05, 96.89, 96.49, 95.82, 95.51]
2024-09-12 02:11:20,316 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54, 86.65, 85.74, 85.72, 85.78]
2024-09-12 02:11:20,316 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23, 98.11, 98.08, 98.15, 98.07]

Average Accuracy (CNN): 89.2
Average Accuracy (NME): 90.76
2024-09-12 02:11:20,316 [trainer.py] => Average Accuracy (CNN): 89.2
2024-09-12 02:11:20,316 [trainer.py] => Average Accuracy (NME): 90.76
2024-09-12 02:11:20,317 [trainer.py] => All params: 85929386
2024-09-12 02:11:20,317 [trainer.py] => Trainable params: 85929386
2024-09-12 02:11:20,319 [icarl.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.119, Train_accy 91.78, Test_accy 80.92:   0%|          | 0/20 [00:52<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.119, Train_accy 91.78, Test_accy 80.92:   5%|▌         | 1/20 [00:52<16:42, 52.74s/it]
Task 17, Epoch 2/20 => Loss 1.858, Train_accy 95.56:   5%|▌         | 1/20 [01:38<16:42, 52.74s/it]                 
Task 17, Epoch 2/20 => Loss 1.858, Train_accy 95.56:  10%|█         | 2/20 [01:38<14:35, 48.65s/it]
Task 17, Epoch 3/20 => Loss 1.839, Train_accy 96.05:  10%|█         | 2/20 [02:24<14:35, 48.65s/it]
Task 17, Epoch 3/20 => Loss 1.839, Train_accy 96.05:  15%|█▌        | 3/20 [02:24<13:26, 47.43s/it]
Task 17, Epoch 4/20 => Loss 1.816, Train_accy 96.25:  15%|█▌        | 3/20 [03:10<13:26, 47.43s/it]
Task 17, Epoch 4/20 => Loss 1.816, Train_accy 96.25:  20%|██        | 4/20 [03:10<12:29, 46.86s/it]
Task 17, Epoch 5/20 => Loss 1.876, Train_accy 96.17:  20%|██        | 4/20 [03:56<12:29, 46.86s/it]
Task 17, Epoch 5/20 => Loss 1.876, Train_accy 96.17:  25%|██▌       | 5/20 [03:56<11:37, 46.51s/it]
Task 17, Epoch 6/20 => Loss 1.861, Train_accy 96.22, Test_accy 81.58:  25%|██▌       | 5/20 [04:49<11:37, 46.51s/it]
Task 17, Epoch 6/20 => Loss 1.861, Train_accy 96.22, Test_accy 81.58:  30%|███       | 6/20 [04:49<11:23, 48.82s/it]
Task 17, Epoch 7/20 => Loss 1.841, Train_accy 96.53:  30%|███       | 6/20 [05:35<11:23, 48.82s/it]                 
Task 17, Epoch 7/20 => Loss 1.841, Train_accy 96.53:  35%|███▌      | 7/20 [05:35<10:22, 47.90s/it]
Task 17, Epoch 8/20 => Loss 1.851, Train_accy 96.51:  35%|███▌      | 7/20 [06:21<10:22, 47.90s/it]
Task 17, Epoch 8/20 => Loss 1.851, Train_accy 96.51:  40%|████      | 8/20 [06:21<09:28, 47.34s/it]
Task 17, Epoch 9/20 => Loss 1.853, Train_accy 96.22:  40%|████      | 8/20 [07:07<09:28, 47.34s/it]
Task 17, Epoch 9/20 => Loss 1.853, Train_accy 96.22:  45%|████▌     | 9/20 [07:07<08:36, 46.94s/it]
Task 17, Epoch 10/20 => Loss 1.844, Train_accy 96.61:  45%|████▌     | 9/20 [07:54<08:36, 46.94s/it]
Task 17, Epoch 10/20 => Loss 1.844, Train_accy 96.61:  50%|█████     | 10/20 [07:54<07:46, 46.68s/it]
Task 17, Epoch 11/20 => Loss 1.822, Train_accy 96.58, Test_accy 82.05:  50%|█████     | 10/20 [08:47<07:46, 46.68s/it]
Task 17, Epoch 11/20 => Loss 1.822, Train_accy 96.58, Test_accy 82.05:  55%|█████▌    | 11/20 [08:47<07:18, 48.75s/it]
Task 17, Epoch 12/20 => Loss 1.803, Train_accy 97.30:  55%|█████▌    | 11/20 [09:33<07:18, 48.75s/it]                 
Task 17, Epoch 12/20 => Loss 1.803, Train_accy 97.30:  60%|██████    | 12/20 [09:33<06:23, 47.92s/it]
Task 17, Epoch 13/20 => Loss 1.836, Train_accy 96.69:  60%|██████    | 12/20 [10:19<06:23, 47.92s/it]
Task 17, Epoch 13/20 => Loss 1.836, Train_accy 96.69:  65%|██████▌   | 13/20 [10:19<05:31, 47.41s/it]
Task 17, Epoch 14/20 => Loss 1.860, Train_accy 96.53:  65%|██████▌   | 13/20 [11:05<05:31, 47.41s/it]
Task 17, Epoch 14/20 => Loss 1.860, Train_accy 96.53:  70%|███████   | 14/20 [11:05<04:42, 47.04s/it]
Task 17, Epoch 15/20 => Loss 1.774, Train_accy 97.30:  70%|███████   | 14/20 [11:52<04:42, 47.04s/it]
Task 17, Epoch 15/20 => Loss 1.774, Train_accy 97.30:  75%|███████▌  | 15/20 [11:52<03:53, 46.76s/it]
Task 17, Epoch 16/20 => Loss 1.809, Train_accy 97.18, Test_accy 82.57:  75%|███████▌  | 15/20 [12:45<03:53, 46.76s/it]
Task 17, Epoch 16/20 => Loss 1.809, Train_accy 97.18, Test_accy 82.57:  80%|████████  | 16/20 [12:45<03:15, 48.77s/it]
Task 17, Epoch 17/20 => Loss 1.793, Train_accy 97.46:  80%|████████  | 16/20 [13:31<03:15, 48.77s/it]                 
Task 17, Epoch 17/20 => Loss 1.793, Train_accy 97.46:  85%|████████▌ | 17/20 [13:31<02:23, 47.91s/it]
Task 17, Epoch 18/20 => Loss 1.774, Train_accy 97.35:  85%|████████▌ | 17/20 [14:17<02:23, 47.91s/it]
Task 17, Epoch 18/20 => Loss 1.774, Train_accy 97.35:  90%|█████████ | 18/20 [14:17<01:34, 47.30s/it]
Task 17, Epoch 19/20 => Loss 1.822, Train_accy 96.82:  90%|█████████ | 18/20 [15:03<01:34, 47.30s/it]
Task 17, Epoch 19/20 => Loss 1.822, Train_accy 96.82:  95%|█████████▌| 19/20 [15:03<00:46, 46.90s/it]
Task 17, Epoch 20/20 => Loss 1.810, Train_accy 97.15:  95%|█████████▌| 19/20 [15:49<00:46, 46.90s/it]
Task 17, Epoch 20/20 => Loss 1.810, Train_accy 97.15: 100%|██████████| 20/20 [15:49<00:00, 46.61s/it]
Task 17, Epoch 20/20 => Loss 1.810, Train_accy 97.15: 100%|██████████| 20/20 [15:49<00:00, 47.46s/it]
2024-09-12 02:27:09,488 [icarl.py] => Task 17, Epoch 20/20 => Loss 1.810, Train_accy 97.15
2024-09-12 02:27:09,489 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 02:28:27,580 [icarl.py] => Exemplar size: 3600
2024-09-12 02:28:27,580 [trainer.py] => CNN: {'total': 81.81, '00-09': 72.88, '10-19': 76.74, '20-29': 91.75, '30-39': 76.36, '40-49': 78.5, '50-59': 75.68, '60-69': 67.92, '70-79': 85.82, '80-89': 82.71, '90-99': 80.88, '100-109': 84.35, '110-119': 80.53, '120-129': 71.96, '130-139': 88.98, '140-149': 80.16, '150-159': 89.52, '160-169': 93.28, '170-179': 92.23, 'old': 81.28, 'new': 92.23}
2024-09-12 02:28:27,580 [trainer.py] => NME: {'total': 85.95, '00-09': 81.36, '10-19': 85.27, '20-29': 94.85, '30-39': 80.91, '40-49': 87.85, '50-59': 84.68, '60-69': 78.3, '70-79': 87.23, '80-89': 90.98, '90-99': 86.76, '100-109': 87.83, '110-119': 84.96, '120-129': 74.77, '130-139': 85.59, '140-149': 83.33, '150-159': 91.94, '160-169': 88.81, '170-179': 90.29, 'old': 85.73, 'new': 90.29}
2024-09-12 02:28:27,580 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03, 84.77, 83.19, 82.97, 82.81, 81.81]
2024-09-12 02:28:27,580 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05, 96.89, 96.49, 95.82, 95.51, 95.49]
2024-09-12 02:28:27,580 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54, 86.65, 85.74, 85.72, 85.78, 85.95]
2024-09-12 02:28:27,580 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23, 98.11, 98.08, 98.15, 98.07, 98.03]

Average Accuracy (CNN): 88.79
Average Accuracy (NME): 90.49
2024-09-12 02:28:27,580 [trainer.py] => Average Accuracy (CNN): 88.79
2024-09-12 02:28:27,580 [trainer.py] => Average Accuracy (NME): 90.49
2024-09-12 02:28:27,581 [trainer.py] => All params: 85937076
2024-09-12 02:28:27,581 [trainer.py] => Trainable params: 85937076
2024-09-12 02:28:27,583 [icarl.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.177, Train_accy 91.79, Test_accy 79.12:   0%|          | 0/20 [00:55<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.177, Train_accy 91.79, Test_accy 79.12:   5%|▌         | 1/20 [00:55<17:28, 55.17s/it]
Task 18, Epoch 2/20 => Loss 1.937, Train_accy 95.29:   5%|▌         | 1/20 [01:42<17:28, 55.17s/it]                 
Task 18, Epoch 2/20 => Loss 1.937, Train_accy 95.29:  10%|█         | 2/20 [01:42<15:12, 50.72s/it]
Task 18, Epoch 3/20 => Loss 1.944, Train_accy 95.66:  10%|█         | 2/20 [02:30<15:12, 50.72s/it]
Task 18, Epoch 3/20 => Loss 1.944, Train_accy 95.66:  15%|█▌        | 3/20 [02:30<14:00, 49.45s/it]
Task 18, Epoch 4/20 => Loss 1.934, Train_accy 96.52:  15%|█▌        | 3/20 [03:18<14:00, 49.45s/it]
Task 18, Epoch 4/20 => Loss 1.934, Train_accy 96.52:  20%|██        | 4/20 [03:18<13:02, 48.88s/it]
Task 18, Epoch 5/20 => Loss 1.855, Train_accy 96.94:  20%|██        | 4/20 [04:06<13:02, 48.88s/it]
Task 18, Epoch 5/20 => Loss 1.855, Train_accy 96.94:  25%|██▌       | 5/20 [04:06<12:07, 48.52s/it]
Task 18, Epoch 6/20 => Loss 1.899, Train_accy 96.28, Test_accy 79.73:  25%|██▌       | 5/20 [05:02<12:07, 48.52s/it]
Task 18, Epoch 6/20 => Loss 1.899, Train_accy 96.28, Test_accy 79.73:  30%|███       | 6/20 [05:02<11:55, 51.12s/it]
Task 18, Epoch 7/20 => Loss 1.865, Train_accy 96.65:  30%|███       | 6/20 [05:50<11:55, 51.12s/it]                 
Task 18, Epoch 7/20 => Loss 1.865, Train_accy 96.65:  35%|███▌      | 7/20 [05:50<10:51, 50.15s/it]
Task 18, Epoch 8/20 => Loss 1.887, Train_accy 96.52:  35%|███▌      | 7/20 [06:38<10:51, 50.15s/it]
Task 18, Epoch 8/20 => Loss 1.887, Train_accy 96.52:  40%|████      | 8/20 [06:38<09:53, 49.45s/it]
Task 18, Epoch 9/20 => Loss 1.906, Train_accy 96.55:  40%|████      | 8/20 [07:26<09:53, 49.45s/it]
Task 18, Epoch 9/20 => Loss 1.906, Train_accy 96.55:  45%|████▌     | 9/20 [07:26<08:58, 48.96s/it]
Task 18, Epoch 10/20 => Loss 1.856, Train_accy 97.26:  45%|████▌     | 9/20 [08:14<08:58, 48.96s/it]
Task 18, Epoch 10/20 => Loss 1.856, Train_accy 97.26:  50%|█████     | 10/20 [08:14<08:06, 48.64s/it]
Task 18, Epoch 11/20 => Loss 1.862, Train_accy 97.09, Test_accy 81.59:  50%|█████     | 10/20 [09:10<08:06, 48.64s/it]
Task 18, Epoch 11/20 => Loss 1.862, Train_accy 97.09, Test_accy 81.59:  55%|█████▌    | 11/20 [09:10<07:38, 50.93s/it]
Task 18, Epoch 12/20 => Loss 1.867, Train_accy 97.44:  55%|█████▌    | 11/20 [09:58<07:38, 50.93s/it]                 
Task 18, Epoch 12/20 => Loss 1.867, Train_accy 97.44:  60%|██████    | 12/20 [09:58<06:40, 50.00s/it]
Task 18, Epoch 13/20 => Loss 1.875, Train_accy 97.16:  60%|██████    | 12/20 [10:46<06:40, 50.00s/it]
Task 18, Epoch 13/20 => Loss 1.875, Train_accy 97.16:  65%|██████▌   | 13/20 [10:46<05:46, 49.48s/it]
Task 18, Epoch 14/20 => Loss 1.908, Train_accy 96.67:  65%|██████▌   | 13/20 [11:35<05:46, 49.48s/it]
Task 18, Epoch 14/20 => Loss 1.908, Train_accy 96.67:  70%|███████   | 14/20 [11:35<04:54, 49.08s/it]
Task 18, Epoch 15/20 => Loss 1.922, Train_accy 96.84:  70%|███████   | 14/20 [12:23<04:54, 49.08s/it]
Task 18, Epoch 15/20 => Loss 1.922, Train_accy 96.84:  75%|███████▌  | 15/20 [12:23<04:03, 48.75s/it]
Task 18, Epoch 16/20 => Loss 1.869, Train_accy 97.41, Test_accy 81.59:  75%|███████▌  | 15/20 [13:19<04:03, 48.75s/it]
Task 18, Epoch 16/20 => Loss 1.869, Train_accy 97.41, Test_accy 81.59:  80%|████████  | 16/20 [13:19<03:23, 50.93s/it]
Task 18, Epoch 17/20 => Loss 1.850, Train_accy 97.44:  80%|████████  | 16/20 [14:07<03:23, 50.93s/it]                 
Task 18, Epoch 17/20 => Loss 1.850, Train_accy 97.44:  85%|████████▌ | 17/20 [14:07<02:30, 50.11s/it]
Task 18, Epoch 18/20 => Loss 1.915, Train_accy 96.79:  85%|████████▌ | 17/20 [14:55<02:30, 50.11s/it]
Task 18, Epoch 18/20 => Loss 1.915, Train_accy 96.79:  90%|█████████ | 18/20 [14:55<01:39, 49.53s/it]
Task 18, Epoch 19/20 => Loss 1.880, Train_accy 97.31:  90%|█████████ | 18/20 [15:43<01:39, 49.53s/it]
Task 18, Epoch 19/20 => Loss 1.880, Train_accy 97.31:  95%|█████████▌| 19/20 [15:43<00:49, 49.11s/it]
Task 18, Epoch 20/20 => Loss 1.894, Train_accy 97.11:  95%|█████████▌| 19/20 [16:31<00:49, 49.11s/it]
Task 18, Epoch 20/20 => Loss 1.894, Train_accy 97.11: 100%|██████████| 20/20 [16:31<00:00, 48.80s/it]
Task 18, Epoch 20/20 => Loss 1.894, Train_accy 97.11: 100%|██████████| 20/20 [16:31<00:00, 49.58s/it]
2024-09-12 02:44:59,277 [icarl.py] => Task 18, Epoch 20/20 => Loss 1.894, Train_accy 97.11
2024-09-12 02:44:59,279 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 02:46:24,055 [icarl.py] => Exemplar size: 3800
2024-09-12 02:46:24,055 [trainer.py] => CNN: {'total': 81.77, '00-09': 73.73, '10-19': 79.84, '20-29': 88.66, '30-39': 70.0, '40-49': 75.7, '50-59': 80.18, '60-69': 70.75, '70-79': 85.11, '80-89': 84.96, '90-99': 78.68, '100-109': 84.35, '110-119': 84.07, '120-129': 65.42, '130-139': 83.9, '140-149': 81.75, '150-159': 90.32, '160-169': 88.06, '170-179': 93.2, '180-189': 90.91, 'old': 81.2, 'new': 90.91}
2024-09-12 02:46:24,055 [trainer.py] => NME: {'total': 84.73, '00-09': 78.81, '10-19': 83.72, '20-29': 93.81, '30-39': 78.18, '40-49': 88.79, '50-59': 84.68, '60-69': 79.25, '70-79': 85.11, '80-89': 91.73, '90-99': 83.82, '100-109': 86.96, '110-119': 84.07, '120-129': 71.96, '130-139': 82.2, '140-149': 82.54, '150-159': 92.74, '160-169': 88.81, '170-179': 89.32, '180-189': 82.58, 'old': 84.87, 'new': 82.58}
2024-09-12 02:46:24,055 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03, 84.77, 83.19, 82.97, 82.81, 81.81, 81.77]
2024-09-12 02:46:24,055 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05, 96.89, 96.49, 95.82, 95.51, 95.49, 95.53]
2024-09-12 02:46:24,055 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54, 86.65, 85.74, 85.72, 85.78, 85.95, 84.73]
2024-09-12 02:46:24,055 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23, 98.11, 98.08, 98.15, 98.07, 98.03, 97.65]

Average Accuracy (CNN): 88.42
Average Accuracy (NME): 90.19
2024-09-12 02:46:24,055 [trainer.py] => Average Accuracy (CNN): 88.42
2024-09-12 02:46:24,055 [trainer.py] => Average Accuracy (NME): 90.19
2024-09-12 02:46:24,056 [trainer.py] => All params: 85944766
2024-09-12 02:46:24,056 [trainer.py] => Trainable params: 85944766
2024-09-12 02:46:24,058 [icarl.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.240, Train_accy 91.51, Test_accy 78.97:   0%|          | 0/20 [00:58<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.240, Train_accy 91.51, Test_accy 78.97:   5%|▌         | 1/20 [00:58<18:27, 58.28s/it]
Task 19, Epoch 2/20 => Loss 2.002, Train_accy 95.16:   5%|▌         | 1/20 [01:48<18:27, 58.28s/it]                 
Task 19, Epoch 2/20 => Loss 2.002, Train_accy 95.16:  10%|█         | 2/20 [01:48<16:07, 53.75s/it]
Task 19, Epoch 3/20 => Loss 1.972, Train_accy 95.74:  10%|█         | 2/20 [02:39<16:07, 53.75s/it]
Task 19, Epoch 3/20 => Loss 1.972, Train_accy 95.74:  15%|█▌        | 3/20 [02:39<14:48, 52.29s/it]
Task 19, Epoch 4/20 => Loss 1.931, Train_accy 96.72:  15%|█▌        | 3/20 [03:30<14:48, 52.29s/it]
Task 19, Epoch 4/20 => Loss 1.931, Train_accy 96.72:  20%|██        | 4/20 [03:30<13:46, 51.64s/it]
Task 19, Epoch 5/20 => Loss 1.944, Train_accy 96.53:  20%|██        | 4/20 [04:20<13:46, 51.64s/it]
Task 19, Epoch 5/20 => Loss 1.944, Train_accy 96.53:  25%|██▌       | 5/20 [04:20<12:48, 51.25s/it]
Task 19, Epoch 6/20 => Loss 1.929, Train_accy 96.65, Test_accy 80.24:  25%|██▌       | 5/20 [05:19<12:48, 51.25s/it]
Task 19, Epoch 6/20 => Loss 1.929, Train_accy 96.65, Test_accy 80.24:  30%|███       | 6/20 [05:19<12:33, 53.80s/it]
Task 19, Epoch 7/20 => Loss 1.906, Train_accy 96.93:  30%|███       | 6/20 [06:10<12:33, 53.80s/it]                 
Task 19, Epoch 7/20 => Loss 1.906, Train_accy 96.93:  35%|███▌      | 7/20 [06:10<11:26, 52.81s/it]
Task 19, Epoch 8/20 => Loss 1.893, Train_accy 97.46:  35%|███▌      | 7/20 [07:00<11:26, 52.81s/it]
Task 19, Epoch 8/20 => Loss 1.893, Train_accy 97.46:  40%|████      | 8/20 [07:00<10:25, 52.09s/it]
Task 19, Epoch 9/20 => Loss 1.928, Train_accy 96.90:  40%|████      | 8/20 [07:51<10:25, 52.09s/it]
Task 19, Epoch 9/20 => Loss 1.928, Train_accy 96.90:  45%|████▌     | 9/20 [07:51<09:27, 51.61s/it]
Task 19, Epoch 10/20 => Loss 1.926, Train_accy 96.88:  45%|████▌     | 9/20 [08:41<09:27, 51.61s/it]
Task 19, Epoch 10/20 => Loss 1.926, Train_accy 96.88:  50%|█████     | 10/20 [08:41<08:33, 51.33s/it]
Task 19, Epoch 11/20 => Loss 1.924, Train_accy 97.07, Test_accy 82.61:  50%|█████     | 10/20 [09:40<08:33, 51.33s/it]
Task 19, Epoch 11/20 => Loss 1.924, Train_accy 97.07, Test_accy 82.61:  55%|█████▌    | 11/20 [09:40<08:02, 53.57s/it]
Task 19, Epoch 12/20 => Loss 1.895, Train_accy 97.16:  55%|█████▌    | 11/20 [10:31<08:02, 53.57s/it]                 
Task 19, Epoch 12/20 => Loss 1.895, Train_accy 97.16:  60%|██████    | 12/20 [10:31<07:01, 52.73s/it]
Task 19, Epoch 13/20 => Loss 1.898, Train_accy 97.28:  60%|██████    | 12/20 [11:22<07:01, 52.73s/it]
Task 19, Epoch 13/20 => Loss 1.898, Train_accy 97.28:  65%|██████▌   | 13/20 [11:22<06:04, 52.10s/it]
Task 19, Epoch 14/20 => Loss 1.914, Train_accy 96.88:  65%|██████▌   | 13/20 [12:12<06:04, 52.10s/it]
Task 19, Epoch 14/20 => Loss 1.914, Train_accy 96.88:  70%|███████   | 14/20 [12:12<05:10, 51.74s/it]
Task 19, Epoch 15/20 => Loss 1.922, Train_accy 97.02:  70%|███████   | 14/20 [13:03<05:10, 51.74s/it]
Task 19, Epoch 15/20 => Loss 1.922, Train_accy 97.02:  75%|███████▌  | 15/20 [13:03<04:16, 51.40s/it]
Task 19, Epoch 16/20 => Loss 1.912, Train_accy 97.30, Test_accy 82.10:  75%|███████▌  | 15/20 [14:02<04:16, 51.40s/it]
Task 19, Epoch 16/20 => Loss 1.912, Train_accy 97.30, Test_accy 82.10:  80%|████████  | 16/20 [14:02<03:34, 53.59s/it]
Task 19, Epoch 17/20 => Loss 1.925, Train_accy 97.11:  80%|████████  | 16/20 [14:52<03:34, 53.59s/it]                 
Task 19, Epoch 17/20 => Loss 1.925, Train_accy 97.11:  85%|████████▌ | 17/20 [14:52<02:38, 52.72s/it]
Task 19, Epoch 18/20 => Loss 1.914, Train_accy 97.39:  85%|████████▌ | 17/20 [15:43<02:38, 52.72s/it]
Task 19, Epoch 18/20 => Loss 1.914, Train_accy 97.39:  90%|█████████ | 18/20 [15:43<01:44, 52.11s/it]
Task 19, Epoch 19/20 => Loss 1.860, Train_accy 97.67:  90%|█████████ | 18/20 [16:34<01:44, 52.11s/it]
Task 19, Epoch 19/20 => Loss 1.860, Train_accy 97.67:  95%|█████████▌| 19/20 [16:34<00:51, 51.86s/it]
Task 19, Epoch 20/20 => Loss 1.908, Train_accy 97.00:  95%|█████████▌| 19/20 [17:25<00:51, 51.86s/it]
Task 19, Epoch 20/20 => Loss 1.908, Train_accy 97.00: 100%|██████████| 20/20 [17:25<00:00, 51.62s/it]
Task 19, Epoch 20/20 => Loss 1.908, Train_accy 97.00: 100%|██████████| 20/20 [17:25<00:00, 52.30s/it]
2024-09-12 03:03:50,042 [icarl.py] => Task 19, Epoch 20/20 => Loss 1.908, Train_accy 97.00
2024-09-12 03:03:50,043 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 03:05:17,876 [icarl.py] => Exemplar size: 4000
2024-09-12 03:05:17,876 [trainer.py] => CNN: {'total': 81.42, '00-09': 74.58, '10-19': 78.29, '20-29': 85.57, '30-39': 67.27, '40-49': 75.7, '50-59': 72.97, '60-69': 71.7, '70-79': 80.85, '80-89': 81.95, '90-99': 83.82, '100-109': 82.61, '110-119': 84.07, '120-129': 68.22, '130-139': 87.29, '140-149': 81.75, '150-159': 91.94, '160-169': 88.06, '170-179': 88.35, '180-189': 88.64, '190-199': 91.84, 'old': 80.97, 'new': 91.84}
2024-09-12 03:05:17,876 [trainer.py] => NME: {'total': 84.35, '00-09': 78.81, '10-19': 82.95, '20-29': 92.78, '30-39': 77.27, '40-49': 88.79, '50-59': 80.18, '60-69': 77.36, '70-79': 84.4, '80-89': 92.48, '90-99': 83.82, '100-109': 88.7, '110-119': 82.3, '120-129': 72.9, '130-139': 82.2, '140-149': 81.75, '150-159': 91.94, '160-169': 88.06, '170-179': 90.29, '180-189': 83.33, '190-199': 85.71, 'old': 84.29, 'new': 85.71}
2024-09-12 03:05:17,876 [trainer.py] => CNN top1 curve: [96.61, 97.17, 97.38, 94.49, 93.05, 90.62, 87.4, 88.03, 88.97, 88.47, 88.56, 86.86, 85.03, 84.77, 83.19, 82.97, 82.81, 81.81, 81.77, 81.42]
2024-09-12 03:05:17,876 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.71, 99.56, 99.29, 98.51, 98.33, 98.04, 97.81, 97.9, 97.54, 97.39, 97.05, 96.89, 96.49, 95.82, 95.51, 95.49, 95.53, 95.12]
2024-09-12 03:05:17,876 [trainer.py] => NME top1 curve: [98.31, 97.17, 96.8, 95.15, 95.19, 93.01, 90.36, 90.32, 90.11, 89.48, 89.1, 87.5, 86.54, 86.65, 85.74, 85.72, 85.78, 85.95, 84.73, 84.35]
2024-09-12 03:05:17,876 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.78, 99.29, 99.4, 99.36, 99.24, 99.24, 98.91, 98.31, 98.38, 98.23, 98.11, 98.08, 98.15, 98.07, 98.03, 97.65, 97.37]

Average Accuracy (CNN): 88.07
Average Accuracy (NME): 89.9
2024-09-12 03:05:17,876 [trainer.py] => Average Accuracy (CNN): 88.07
2024-09-12 03:05:17,876 [trainer.py] => Average Accuracy (NME): 89.9
Accuracy Matrix (CNN):
[[96.61 97.46 96.61 92.37 91.53 83.9  78.81 79.66 80.51 81.36 83.05 78.81
  79.66 77.97 72.03 73.73 69.49 72.88 73.73 74.58]
 [ 0.   96.9  97.67 95.35 94.57 90.7  82.95 82.95 82.95 80.62 82.17 80.62
  79.07 80.62 80.62 84.5  84.5  76.74 79.84 78.29]
 [ 0.    0.   97.94 95.88 95.88 94.85 92.78 91.75 92.78 93.81 91.75 90.72
  92.78 91.75 88.66 88.66 88.66 91.75 88.66 85.57]
 [ 0.    0.    0.   94.55 86.36 86.36 80.   78.18 80.91 74.55 78.18 74.55
  70.   73.64 68.18 72.73 71.82 76.36 70.   67.27]
 [ 0.    0.    0.    0.   97.2  97.2  94.39 94.39 91.59 86.92 88.79 87.85
  81.31 79.44 77.57 80.37 77.57 78.5  75.7  75.7 ]
 [ 0.    0.    0.    0.    0.   91.89 92.79 93.69 89.19 90.09 87.39 81.08
  81.08 78.38 80.18 82.88 79.28 75.68 80.18 72.97]
 [ 0.    0.    0.    0.    0.    0.   92.45 88.68 88.68 90.57 86.79 85.85
  83.96 86.79 81.13 78.3  75.47 67.92 70.75 71.7 ]
 [ 0.    0.    0.    0.    0.    0.    0.   95.04 96.45 95.04 92.91 90.78
  87.94 87.94 85.11 81.56 82.27 85.82 85.11 80.85]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   96.24 95.49 93.98 92.48
  90.98 87.22 87.22 84.96 87.22 82.71 84.96 81.95]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   94.12 92.65 92.65
  86.76 85.29 85.29 83.09 83.09 80.88 78.68 83.82]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   94.78 93.91
  91.3  89.57 85.22 79.13 84.35 84.35 84.35 82.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   91.15
  89.38 89.38 85.84 80.53 79.65 80.53 84.07 84.07]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  90.65 83.18 81.31 80.37 77.57 71.96 65.42 68.22]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   94.92 94.92 88.14 88.98 88.98 83.9  87.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   92.06 91.27 84.92 80.16 81.75 81.75]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   95.16 95.16 89.52 90.32 91.94]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   93.28 93.28 88.06 88.06]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   92.23 93.2  88.35]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   90.91 88.64]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   91.84]]
2024-09-12 03:05:17,879 [trainer.py] => Forgetting (CNN): 13.697368421052632
Accuracy Matrix (NME):
[[98.31 98.31 98.31 96.61 97.46 89.83 87.29 85.59 84.75 84.75 83.05 79.66
  83.9  83.05 81.36 83.9  84.75 81.36 78.81 78.81]
 [ 0.   96.12 95.35 93.8  93.8  93.02 89.92 89.15 86.82 87.6  86.05 86.82
  87.6  84.5  85.27 82.17 85.27 85.27 83.72 82.95]
 [ 0.    0.   96.91 97.94 97.94 96.91 96.91 96.91 96.91 96.91 96.91 96.91
  93.81 92.78 94.85 93.81 93.81 94.85 93.81 92.78]
 [ 0.    0.    0.   92.73 90.   89.09 86.36 85.45 85.45 82.73 80.91 81.82
  81.82 82.73 81.82 81.82 81.82 80.91 78.18 77.27]
 [ 0.    0.    0.    0.   97.2  97.2  92.52 93.46 94.39 93.46 93.46 93.46
  88.79 88.79 88.79 87.85 86.92 87.85 88.79 88.79]
 [ 0.    0.    0.    0.    0.   92.79 91.89 91.89 91.89 90.99 88.29 85.59
  83.78 84.68 82.88 83.78 82.88 84.68 84.68 80.18]
 [ 0.    0.    0.    0.    0.    0.   88.68 89.62 85.85 84.91 83.96 82.08
  81.13 84.91 80.19 80.19 81.13 78.3  79.25 77.36]
 [ 0.    0.    0.    0.    0.    0.    0.   91.49 92.91 90.78 91.49 87.23
  86.52 87.94 85.82 87.94 86.52 87.23 85.11 84.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   92.48 93.23 94.74 93.98
  92.48 91.73 91.73 91.73 92.48 90.98 91.73 92.48]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   89.71 89.71 88.24
  87.5  86.76 86.76 87.5  86.03 86.76 83.82 83.82]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   91.3  89.57
  90.43 88.7  89.57 86.96 86.09 87.83 86.96 88.7 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   84.96
  81.42 87.61 81.42 81.42 81.42 84.96 84.07 82.3 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  85.05 80.37 79.44 78.5  79.44 74.77 71.96 72.9 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   88.14 86.44 82.2  83.9  85.59 82.2  82.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   88.89 87.3  82.54 83.33 82.54 81.75]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   92.74 92.74 91.94 92.74 91.94]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   88.81 88.81 88.81 88.06]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   90.29 89.32 90.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   82.58 83.33]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   85.71]]
2024-09-12 03:05:17,881 [trainer.py] => Forgetting (NME): 7.25894736842105
2024-09-12 03:05:20,875 [trainer.py] => config: ./exps/icarl_cub_B100_Inc5.json
2024-09-12 03:05:20,883 [trainer.py] => prefix: reproduce
2024-09-12 03:05:20,883 [trainer.py] => dataset: cub
2024-09-12 03:05:20,883 [trainer.py] => memory_size: 4000
2024-09-12 03:05:20,883 [trainer.py] => memory_per_class: 20
2024-09-12 03:05:20,883 [trainer.py] => fixed_memory: True
2024-09-12 03:05:20,883 [trainer.py] => shuffle: True
2024-09-12 03:05:20,883 [trainer.py] => init_cls: 100
2024-09-12 03:05:20,883 [trainer.py] => increment: 20
2024-09-12 03:05:20,883 [trainer.py] => model_name: icarl
2024-09-12 03:05:20,883 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 03:05:20,883 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-12 03:05:20,883 [trainer.py] => seed: 1993
2024-09-12 03:05:20,883 [trainer.py] => init_epoch: 20
2024-09-12 03:05:20,883 [trainer.py] => init_lr: 0.001
2024-09-12 03:05:20,883 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 03:05:20,883 [trainer.py] => init_lr_decay: 0.1
2024-09-12 03:05:20,883 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 03:05:20,883 [trainer.py] => epochs: 20
2024-09-12 03:05:20,883 [trainer.py] => lrate: 0.001
2024-09-12 03:05:20,883 [trainer.py] => milestones: [80, 120]
2024-09-12 03:05:20,884 [trainer.py] => lrate_decay: 0.1
2024-09-12 03:05:20,884 [trainer.py] => batch_size: 48
2024-09-12 03:05:20,884 [trainer.py] => weight_decay: 0.0002
2024-09-12 03:05:20,884 [trainer.py] => T: 2
2024-09-12 03:05:20,945 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 03:05:22,902 [trainer.py] => All params: 85798656
2024-09-12 03:05:22,903 [trainer.py] => Trainable params: 85798656
2024-09-12 03:05:22,904 [icarl.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   0%|          | 0/20 [00:45<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   5%|▌         | 1/20 [00:45<14:16, 45.06s/it]
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:   5%|▌         | 1/20 [01:25<14:16, 45.06s/it]                 
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:  10%|█         | 2/20 [01:25<12:46, 42.60s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  10%|█         | 2/20 [02:06<12:46, 42.60s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  15%|█▌        | 3/20 [02:06<11:50, 41.79s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  15%|█▌        | 3/20 [02:47<11:50, 41.79s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  20%|██        | 4/20 [02:47<11:03, 41.45s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  20%|██        | 4/20 [03:28<11:03, 41.45s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  25%|██▌       | 5/20 [03:28<10:19, 41.27s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  25%|██▌       | 5/20 [04:13<10:19, 41.27s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  30%|███       | 6/20 [04:13<09:57, 42.65s/it]
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  30%|███       | 6/20 [04:55<09:57, 42.65s/it]                 
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  35%|███▌      | 7/20 [04:55<09:07, 42.13s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  35%|███▌      | 7/20 [05:36<09:07, 42.13s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  40%|████      | 8/20 [05:36<08:21, 41.78s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  40%|████      | 8/20 [06:17<08:21, 41.78s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  45%|████▌     | 9/20 [06:17<07:36, 41.54s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  45%|████▌     | 9/20 [06:58<07:36, 41.54s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  50%|█████     | 10/20 [06:58<06:54, 41.40s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  50%|█████     | 10/20 [07:43<06:54, 41.40s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  55%|█████▌    | 11/20 [07:43<06:23, 42.65s/it]
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  55%|█████▌    | 11/20 [08:24<06:23, 42.65s/it]                 
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  60%|██████    | 12/20 [08:24<05:37, 42.16s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  60%|██████    | 12/20 [09:05<05:37, 42.16s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  65%|██████▌   | 13/20 [09:05<04:52, 41.82s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  65%|██████▌   | 13/20 [09:46<04:52, 41.82s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  70%|███████   | 14/20 [09:46<04:09, 41.61s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  70%|███████   | 14/20 [10:27<04:09, 41.61s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  75%|███████▌  | 15/20 [10:27<03:27, 41.46s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  75%|███████▌  | 15/20 [11:13<03:27, 41.46s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  80%|████████  | 16/20 [11:13<02:50, 42.70s/it]
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  80%|████████  | 16/20 [11:54<02:50, 42.70s/it]                 
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  85%|████████▌ | 17/20 [11:54<02:06, 42.21s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  85%|████████▌ | 17/20 [12:35<02:06, 42.21s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  90%|█████████ | 18/20 [12:35<01:23, 41.89s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  90%|█████████ | 18/20 [13:16<01:23, 41.89s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  95%|█████████▌| 19/20 [13:16<00:41, 41.66s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29:  95%|█████████▌| 19/20 [13:58<00:41, 41.66s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [13:58<00:00, 41.50s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [13:58<00:00, 41.90s/it]
2024-09-12 03:19:21,444 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29
2024-09-12 03:19:21,445 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 03:20:57,095 [icarl.py] => Exemplar size: 2000
2024-09-12 03:20:57,096 [trainer.py] => CNN: {'total': 88.47, '00-99': 88.47, 'old': 0, 'new': 88.47}
2024-09-12 03:20:57,096 [trainer.py] => NME: {'total': 90.4, '00-99': 90.4, 'old': 0, 'new': 90.4}
2024-09-12 03:20:57,096 [trainer.py] => CNN top1 curve: [88.47]
2024-09-12 03:20:57,096 [trainer.py] => CNN top5 curve: [98.15]
2024-09-12 03:20:57,096 [trainer.py] => NME top1 curve: [90.4]
2024-09-12 03:20:57,096 [trainer.py] => NME top5 curve: [98.91]

Average Accuracy (CNN): 88.47
Average Accuracy (NME): 90.4
2024-09-12 03:20:57,096 [trainer.py] => Average Accuracy (CNN): 88.47
2024-09-12 03:20:57,096 [trainer.py] => Average Accuracy (NME): 90.4
2024-09-12 03:20:57,096 [trainer.py] => All params: 85875556
2024-09-12 03:20:57,097 [trainer.py] => Trainable params: 85875556
2024-09-12 03:20:57,098 [icarl.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.573, Train_accy 76.56, Test_accy 85.52:   0%|          | 0/20 [00:39<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.573, Train_accy 76.56, Test_accy 85.52:   5%|▌         | 1/20 [00:39<12:35, 39.78s/it]
Task 1, Epoch 2/20 => Loss 1.749, Train_accy 87.30:   5%|▌         | 1/20 [01:14<12:35, 39.78s/it]                 
Task 1, Epoch 2/20 => Loss 1.749, Train_accy 87.30:  10%|█         | 2/20 [01:14<11:02, 36.82s/it]
Task 1, Epoch 3/20 => Loss 1.675, Train_accy 89.02:  10%|█         | 2/20 [01:49<11:02, 36.82s/it]
Task 1, Epoch 3/20 => Loss 1.675, Train_accy 89.02:  15%|█▌        | 3/20 [01:49<10:09, 35.85s/it]
Task 1, Epoch 4/20 => Loss 1.693, Train_accy 89.33:  15%|█▌        | 3/20 [02:24<10:09, 35.85s/it]
Task 1, Epoch 4/20 => Loss 1.693, Train_accy 89.33:  20%|██        | 4/20 [02:24<09:27, 35.45s/it]
Task 1, Epoch 5/20 => Loss 1.631, Train_accy 90.75:  20%|██        | 4/20 [02:58<09:27, 35.45s/it]
Task 1, Epoch 5/20 => Loss 1.631, Train_accy 90.75:  25%|██▌       | 5/20 [02:58<08:48, 35.25s/it]
Task 1, Epoch 6/20 => Loss 1.613, Train_accy 90.85, Test_accy 87.15:  25%|██▌       | 5/20 [03:38<08:48, 35.25s/it]
Task 1, Epoch 6/20 => Loss 1.613, Train_accy 90.85, Test_accy 87.15:  30%|███       | 6/20 [03:38<08:35, 36.82s/it]
Task 1, Epoch 7/20 => Loss 1.585, Train_accy 91.87:  30%|███       | 6/20 [04:13<08:35, 36.82s/it]                 
Task 1, Epoch 7/20 => Loss 1.585, Train_accy 91.87:  35%|███▌      | 7/20 [04:13<07:50, 36.20s/it]
Task 1, Epoch 8/20 => Loss 1.561, Train_accy 91.60:  35%|███▌      | 7/20 [04:48<07:50, 36.20s/it]
Task 1, Epoch 8/20 => Loss 1.561, Train_accy 91.60:  40%|████      | 8/20 [04:48<07:09, 35.78s/it]
Task 1, Epoch 9/20 => Loss 1.559, Train_accy 92.51:  40%|████      | 8/20 [05:23<07:09, 35.78s/it]
Task 1, Epoch 9/20 => Loss 1.559, Train_accy 92.51:  45%|████▌     | 9/20 [05:23<06:30, 35.51s/it]
Task 1, Epoch 10/20 => Loss 1.527, Train_accy 92.34:  45%|████▌     | 9/20 [05:58<06:30, 35.51s/it]
Task 1, Epoch 10/20 => Loss 1.527, Train_accy 92.34:  50%|█████     | 10/20 [05:58<05:53, 35.32s/it]
Task 1, Epoch 11/20 => Loss 1.597, Train_accy 91.90, Test_accy 88.21:  50%|█████     | 10/20 [06:38<05:53, 35.32s/it]
Task 1, Epoch 11/20 => Loss 1.597, Train_accy 91.90, Test_accy 88.21:  55%|█████▌    | 11/20 [06:38<05:30, 36.78s/it]
Task 1, Epoch 12/20 => Loss 1.513, Train_accy 92.78:  55%|█████▌    | 11/20 [07:13<05:30, 36.78s/it]                 
Task 1, Epoch 12/20 => Loss 1.513, Train_accy 92.78:  60%|██████    | 12/20 [07:13<04:49, 36.20s/it]
Task 1, Epoch 13/20 => Loss 1.506, Train_accy 93.33:  60%|██████    | 12/20 [07:48<04:49, 36.20s/it]
Task 1, Epoch 13/20 => Loss 1.506, Train_accy 93.33:  65%|██████▌   | 13/20 [07:48<04:10, 35.79s/it]
Task 1, Epoch 14/20 => Loss 1.503, Train_accy 92.95:  65%|██████▌   | 13/20 [08:23<04:10, 35.79s/it]
Task 1, Epoch 14/20 => Loss 1.503, Train_accy 92.95:  70%|███████   | 14/20 [08:23<03:33, 35.56s/it]
Task 1, Epoch 15/20 => Loss 1.499, Train_accy 93.26:  70%|███████   | 14/20 [08:58<03:33, 35.56s/it]
Task 1, Epoch 15/20 => Loss 1.499, Train_accy 93.26:  75%|███████▌  | 15/20 [08:58<02:56, 35.39s/it]
Task 1, Epoch 16/20 => Loss 1.518, Train_accy 93.70, Test_accy 88.28:  75%|███████▌  | 15/20 [09:38<02:56, 35.39s/it]
Task 1, Epoch 16/20 => Loss 1.518, Train_accy 93.70, Test_accy 88.28:  80%|████████  | 16/20 [09:38<02:27, 36.77s/it]
Task 1, Epoch 17/20 => Loss 1.470, Train_accy 93.50:  80%|████████  | 16/20 [10:13<02:27, 36.77s/it]                 
Task 1, Epoch 17/20 => Loss 1.470, Train_accy 93.50:  85%|████████▌ | 17/20 [10:13<01:48, 36.21s/it]
Task 1, Epoch 18/20 => Loss 1.510, Train_accy 94.07:  85%|████████▌ | 17/20 [10:48<01:48, 36.21s/it]
Task 1, Epoch 18/20 => Loss 1.510, Train_accy 94.07:  90%|█████████ | 18/20 [10:48<01:11, 35.82s/it]
Task 1, Epoch 19/20 => Loss 1.495, Train_accy 93.94:  90%|█████████ | 18/20 [11:22<01:11, 35.82s/it]
Task 1, Epoch 19/20 => Loss 1.495, Train_accy 93.94:  95%|█████████▌| 19/20 [11:22<00:35, 35.54s/it]
Task 1, Epoch 20/20 => Loss 1.486, Train_accy 94.04:  95%|█████████▌| 19/20 [11:57<00:35, 35.54s/it]
Task 1, Epoch 20/20 => Loss 1.486, Train_accy 94.04: 100%|██████████| 20/20 [11:57<00:00, 35.34s/it]
Task 1, Epoch 20/20 => Loss 1.486, Train_accy 94.04: 100%|██████████| 20/20 [11:57<00:00, 35.89s/it]
2024-09-12 03:32:54,921 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.486, Train_accy 94.04
2024-09-12 03:32:54,922 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 03:33:55,222 [icarl.py] => Exemplar size: 2400
2024-09-12 03:33:55,223 [trainer.py] => CNN: {'total': 87.71, '00-99': 86.7, '100-119': 92.98, 'old': 86.7, 'new': 92.98}
2024-09-12 03:33:55,223 [trainer.py] => NME: {'total': 88.98, '00-99': 88.97, '100-119': 89.04, 'old': 88.97, 'new': 89.04}
2024-09-12 03:33:55,223 [trainer.py] => CNN top1 curve: [88.47, 87.71]
2024-09-12 03:33:55,223 [trainer.py] => CNN top5 curve: [98.15, 97.95]
2024-09-12 03:33:55,223 [trainer.py] => NME top1 curve: [90.4, 88.98]
2024-09-12 03:33:55,223 [trainer.py] => NME top5 curve: [98.91, 98.45]

Average Accuracy (CNN): 88.09
Average Accuracy (NME): 89.69
2024-09-12 03:33:55,223 [trainer.py] => Average Accuracy (CNN): 88.09
2024-09-12 03:33:55,223 [trainer.py] => Average Accuracy (NME): 89.69
2024-09-12 03:33:55,223 [trainer.py] => All params: 85890936
2024-09-12 03:33:55,224 [trainer.py] => Trainable params: 85890936
2024-09-12 03:33:55,225 [icarl.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.401, Train_accy 79.52, Test_accy 84.64:   0%|          | 0/20 [00:45<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.401, Train_accy 79.52, Test_accy 84.64:   5%|▌         | 1/20 [00:45<14:24, 45.49s/it]
Task 2, Epoch 2/20 => Loss 1.705, Train_accy 88.85:   5%|▌         | 1/20 [01:25<14:24, 45.49s/it]                 
Task 2, Epoch 2/20 => Loss 1.705, Train_accy 88.85:  10%|█         | 2/20 [01:25<12:37, 42.09s/it]
Task 2, Epoch 3/20 => Loss 1.647, Train_accy 90.79:  10%|█         | 2/20 [02:04<12:37, 42.09s/it]
Task 2, Epoch 3/20 => Loss 1.647, Train_accy 90.79:  15%|█▌        | 3/20 [02:04<11:37, 41.01s/it]
Task 2, Epoch 4/20 => Loss 1.633, Train_accy 91.50:  15%|█▌        | 3/20 [02:44<11:37, 41.01s/it]
Task 2, Epoch 4/20 => Loss 1.633, Train_accy 91.50:  20%|██        | 4/20 [02:44<10:46, 40.43s/it]
Task 2, Epoch 5/20 => Loss 1.655, Train_accy 91.38:  20%|██        | 4/20 [03:24<10:46, 40.43s/it]
Task 2, Epoch 5/20 => Loss 1.655, Train_accy 91.38:  25%|██▌       | 5/20 [03:24<10:02, 40.15s/it]
Task 2, Epoch 6/20 => Loss 1.632, Train_accy 91.53, Test_accy 86.35:  25%|██▌       | 5/20 [04:09<10:02, 40.15s/it]
Task 2, Epoch 6/20 => Loss 1.632, Train_accy 91.53, Test_accy 86.35:  30%|███       | 6/20 [04:09<09:46, 41.93s/it]
Task 2, Epoch 7/20 => Loss 1.578, Train_accy 92.34:  30%|███       | 6/20 [04:49<09:46, 41.93s/it]                 
Task 2, Epoch 7/20 => Loss 1.578, Train_accy 92.34:  35%|███▌      | 7/20 [04:49<08:55, 41.18s/it]
Task 2, Epoch 8/20 => Loss 1.643, Train_accy 92.64:  35%|███▌      | 7/20 [05:28<08:55, 41.18s/it]
Task 2, Epoch 8/20 => Loss 1.643, Train_accy 92.64:  40%|████      | 8/20 [05:28<08:08, 40.68s/it]
Task 2, Epoch 9/20 => Loss 1.571, Train_accy 93.05:  40%|████      | 8/20 [06:08<08:08, 40.68s/it]
Task 2, Epoch 9/20 => Loss 1.571, Train_accy 93.05:  45%|████▌     | 9/20 [06:08<07:23, 40.36s/it]
Task 2, Epoch 10/20 => Loss 1.556, Train_accy 93.38:  45%|████▌     | 9/20 [06:47<07:23, 40.36s/it]
Task 2, Epoch 10/20 => Loss 1.556, Train_accy 93.38:  50%|█████     | 10/20 [06:47<06:41, 40.10s/it]
Task 2, Epoch 11/20 => Loss 1.554, Train_accy 94.34, Test_accy 86.11:  50%|█████     | 10/20 [07:33<06:41, 40.10s/it]
Task 2, Epoch 11/20 => Loss 1.554, Train_accy 94.34, Test_accy 86.11:  55%|█████▌    | 11/20 [07:33<06:15, 41.68s/it]
Task 2, Epoch 12/20 => Loss 1.553, Train_accy 93.71:  55%|█████▌    | 11/20 [08:12<06:15, 41.68s/it]                 
Task 2, Epoch 12/20 => Loss 1.553, Train_accy 93.71:  60%|██████    | 12/20 [08:12<05:28, 41.05s/it]
Task 2, Epoch 13/20 => Loss 1.582, Train_accy 93.98:  60%|██████    | 12/20 [08:52<05:28, 41.05s/it]
Task 2, Epoch 13/20 => Loss 1.582, Train_accy 93.98:  65%|██████▌   | 13/20 [08:52<04:44, 40.60s/it]
Task 2, Epoch 14/20 => Loss 1.564, Train_accy 93.77:  65%|██████▌   | 13/20 [09:31<04:44, 40.60s/it]
Task 2, Epoch 14/20 => Loss 1.564, Train_accy 93.77:  70%|███████   | 14/20 [09:31<04:01, 40.30s/it]
Task 2, Epoch 15/20 => Loss 1.580, Train_accy 94.16:  70%|███████   | 14/20 [10:11<04:01, 40.30s/it]
Task 2, Epoch 15/20 => Loss 1.580, Train_accy 94.16:  75%|███████▌  | 15/20 [10:11<03:20, 40.10s/it]
Task 2, Epoch 16/20 => Loss 1.543, Train_accy 93.89, Test_accy 87.32:  75%|███████▌  | 15/20 [10:56<03:20, 40.10s/it]
Task 2, Epoch 16/20 => Loss 1.543, Train_accy 93.89, Test_accy 87.32:  80%|████████  | 16/20 [10:56<02:46, 41.68s/it]
Task 2, Epoch 17/20 => Loss 1.559, Train_accy 94.10:  80%|████████  | 16/20 [11:36<02:46, 41.68s/it]                 
Task 2, Epoch 17/20 => Loss 1.559, Train_accy 94.10:  85%|████████▌ | 17/20 [11:36<02:03, 41.07s/it]
Task 2, Epoch 18/20 => Loss 1.541, Train_accy 94.10:  85%|████████▌ | 17/20 [12:16<02:03, 41.07s/it]
Task 2, Epoch 18/20 => Loss 1.541, Train_accy 94.10:  90%|█████████ | 18/20 [12:16<01:21, 40.60s/it]
Task 2, Epoch 19/20 => Loss 1.567, Train_accy 93.95:  90%|█████████ | 18/20 [12:55<01:21, 40.60s/it]
Task 2, Epoch 19/20 => Loss 1.567, Train_accy 93.95:  95%|█████████▌| 19/20 [12:55<00:40, 40.30s/it]
Task 2, Epoch 20/20 => Loss 1.568, Train_accy 94.13:  95%|█████████▌| 19/20 [13:35<00:40, 40.30s/it]
Task 2, Epoch 20/20 => Loss 1.568, Train_accy 94.13: 100%|██████████| 20/20 [13:35<00:00, 40.10s/it]
Task 2, Epoch 20/20 => Loss 1.568, Train_accy 94.13: 100%|██████████| 20/20 [13:35<00:00, 40.77s/it]
2024-09-12 03:47:30,588 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.568, Train_accy 94.13
2024-09-12 03:47:30,590 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 03:48:38,636 [icarl.py] => Exemplar size: 2800
2024-09-12 03:48:38,636 [trainer.py] => CNN: {'total': 86.72, '00-99': 85.44, '100-119': 88.6, '120-139': 91.56, 'old': 85.95, 'new': 91.56}
2024-09-12 03:48:38,636 [trainer.py] => NME: {'total': 87.87, '00-99': 87.46, '100-119': 89.91, '120-139': 88.0, 'old': 87.85, 'new': 88.0}
2024-09-12 03:48:38,636 [trainer.py] => CNN top1 curve: [88.47, 87.71, 86.72]
2024-09-12 03:48:38,636 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.62]
2024-09-12 03:48:38,636 [trainer.py] => NME top1 curve: [90.4, 88.98, 87.87]
2024-09-12 03:48:38,636 [trainer.py] => NME top5 curve: [98.91, 98.45, 98.54]

Average Accuracy (CNN): 87.63
Average Accuracy (NME): 89.08
2024-09-12 03:48:38,636 [trainer.py] => Average Accuracy (CNN): 87.63
2024-09-12 03:48:38,636 [trainer.py] => Average Accuracy (NME): 89.08
2024-09-12 03:48:38,637 [trainer.py] => All params: 85906316
2024-09-12 03:48:38,637 [trainer.py] => Trainable params: 85906316
2024-09-12 03:48:38,639 [icarl.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.384, Train_accy 82.12, Test_accy 82.50:   0%|          | 0/20 [00:49<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.384, Train_accy 82.12, Test_accy 82.50:   5%|▌         | 1/20 [00:49<15:48, 49.90s/it]
Task 3, Epoch 2/20 => Loss 1.789, Train_accy 89.14:   5%|▌         | 1/20 [01:33<15:48, 49.90s/it]                 
Task 3, Epoch 2/20 => Loss 1.789, Train_accy 89.14:  10%|█         | 2/20 [01:33<13:51, 46.20s/it]
Task 3, Epoch 3/20 => Loss 1.644, Train_accy 91.91:  10%|█         | 2/20 [02:17<13:51, 46.20s/it]
Task 3, Epoch 3/20 => Loss 1.644, Train_accy 91.91:  15%|█▌        | 3/20 [02:17<12:46, 45.09s/it]
Task 3, Epoch 4/20 => Loss 1.605, Train_accy 93.12:  15%|█▌        | 3/20 [03:01<12:46, 45.09s/it]
Task 3, Epoch 4/20 => Loss 1.605, Train_accy 93.12:  20%|██        | 4/20 [03:01<11:53, 44.57s/it]
Task 3, Epoch 5/20 => Loss 1.623, Train_accy 92.39:  20%|██        | 4/20 [03:44<11:53, 44.57s/it]
Task 3, Epoch 5/20 => Loss 1.623, Train_accy 92.39:  25%|██▌       | 5/20 [03:44<11:04, 44.29s/it]
Task 3, Epoch 6/20 => Loss 1.619, Train_accy 93.06, Test_accy 84.08:  25%|██▌       | 5/20 [04:35<11:04, 44.29s/it]
Task 3, Epoch 6/20 => Loss 1.619, Train_accy 93.06, Test_accy 84.08:  30%|███       | 6/20 [04:35<10:49, 46.42s/it]
Task 3, Epoch 7/20 => Loss 1.620, Train_accy 93.41:  30%|███       | 6/20 [05:19<10:49, 46.42s/it]                 
Task 3, Epoch 7/20 => Loss 1.620, Train_accy 93.41:  35%|███▌      | 7/20 [05:19<09:52, 45.58s/it]
Task 3, Epoch 8/20 => Loss 1.598, Train_accy 93.49:  35%|███▌      | 7/20 [06:03<09:52, 45.58s/it]
Task 3, Epoch 8/20 => Loss 1.598, Train_accy 93.49:  40%|████      | 8/20 [06:03<09:00, 45.02s/it]
Task 3, Epoch 9/20 => Loss 1.620, Train_accy 92.85:  40%|████      | 8/20 [06:46<09:00, 45.02s/it]
Task 3, Epoch 9/20 => Loss 1.620, Train_accy 92.85:  45%|████▌     | 9/20 [06:46<08:11, 44.65s/it]
Task 3, Epoch 10/20 => Loss 1.649, Train_accy 93.04:  45%|████▌     | 9/20 [07:30<08:11, 44.65s/it]
Task 3, Epoch 10/20 => Loss 1.649, Train_accy 93.04:  50%|█████     | 10/20 [07:30<07:24, 44.44s/it]
Task 3, Epoch 11/20 => Loss 1.617, Train_accy 93.71, Test_accy 85.83:  50%|█████     | 10/20 [08:21<07:24, 44.44s/it]
Task 3, Epoch 11/20 => Loss 1.617, Train_accy 93.71, Test_accy 85.83:  55%|█████▌    | 11/20 [08:21<06:57, 46.34s/it]
Task 3, Epoch 12/20 => Loss 1.499, Train_accy 95.16:  55%|█████▌    | 11/20 [09:05<06:57, 46.34s/it]                 
Task 3, Epoch 12/20 => Loss 1.499, Train_accy 95.16:  60%|██████    | 12/20 [09:05<06:04, 45.57s/it]
Task 3, Epoch 13/20 => Loss 1.593, Train_accy 94.17:  60%|██████    | 12/20 [09:49<06:04, 45.57s/it]
Task 3, Epoch 13/20 => Loss 1.593, Train_accy 94.17:  65%|██████▌   | 13/20 [09:49<05:15, 45.07s/it]
Task 3, Epoch 14/20 => Loss 1.612, Train_accy 93.71:  65%|██████▌   | 13/20 [10:33<05:15, 45.07s/it]
Task 3, Epoch 14/20 => Loss 1.612, Train_accy 93.71:  70%|███████   | 14/20 [10:33<04:28, 44.74s/it]
Task 3, Epoch 15/20 => Loss 1.614, Train_accy 93.74:  70%|███████   | 14/20 [11:17<04:28, 44.74s/it]
Task 3, Epoch 15/20 => Loss 1.614, Train_accy 93.74:  75%|███████▌  | 15/20 [11:17<03:42, 44.50s/it]
Task 3, Epoch 16/20 => Loss 1.546, Train_accy 94.81, Test_accy 85.83:  75%|███████▌  | 15/20 [12:07<03:42, 44.50s/it]
Task 3, Epoch 16/20 => Loss 1.546, Train_accy 94.81, Test_accy 85.83:  80%|████████  | 16/20 [12:07<03:05, 46.32s/it]
Task 3, Epoch 17/20 => Loss 1.557, Train_accy 94.87:  80%|████████  | 16/20 [12:51<03:05, 46.32s/it]                 
Task 3, Epoch 17/20 => Loss 1.557, Train_accy 94.87:  85%|████████▌ | 17/20 [12:51<02:16, 45.57s/it]
Task 3, Epoch 18/20 => Loss 1.554, Train_accy 94.78:  85%|████████▌ | 17/20 [13:35<02:16, 45.57s/it]
Task 3, Epoch 18/20 => Loss 1.554, Train_accy 94.78:  90%|█████████ | 18/20 [13:35<01:30, 45.05s/it]
Task 3, Epoch 19/20 => Loss 1.535, Train_accy 95.11:  90%|█████████ | 18/20 [14:19<01:30, 45.05s/it]
Task 3, Epoch 19/20 => Loss 1.535, Train_accy 95.11:  95%|█████████▌| 19/20 [14:19<00:44, 44.69s/it]
Task 3, Epoch 20/20 => Loss 1.551, Train_accy 94.97:  95%|█████████▌| 19/20 [15:03<00:44, 44.69s/it]
Task 3, Epoch 20/20 => Loss 1.551, Train_accy 94.97: 100%|██████████| 20/20 [15:03<00:00, 44.50s/it]
Task 3, Epoch 20/20 => Loss 1.551, Train_accy 94.97: 100%|██████████| 20/20 [15:03<00:00, 45.16s/it]
2024-09-12 04:03:41,945 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.551, Train_accy 94.97
2024-09-12 04:03:41,946 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 04:04:58,256 [icarl.py] => Exemplar size: 3200
2024-09-12 04:04:58,256 [trainer.py] => CNN: {'total': 85.93, '00-99': 83.16, '100-119': 89.47, '120-139': 90.67, '140-159': 91.6, 'old': 85.07, 'new': 91.6}
2024-09-12 04:04:58,256 [trainer.py] => NME: {'total': 87.57, '00-99': 87.21, '100-119': 86.84, '120-139': 86.67, '140-159': 90.8, 'old': 87.08, 'new': 90.8}
2024-09-12 04:04:58,256 [trainer.py] => CNN top1 curve: [88.47, 87.71, 86.72, 85.93]
2024-09-12 04:04:58,256 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.62, 97.36]
2024-09-12 04:04:58,256 [trainer.py] => NME top1 curve: [90.4, 88.98, 87.87, 87.57]
2024-09-12 04:04:58,256 [trainer.py] => NME top5 curve: [98.91, 98.45, 98.54, 98.2]

Average Accuracy (CNN): 87.21
Average Accuracy (NME): 88.7
2024-09-12 04:04:58,256 [trainer.py] => Average Accuracy (CNN): 87.21
2024-09-12 04:04:58,256 [trainer.py] => Average Accuracy (NME): 88.7
2024-09-12 04:04:58,257 [trainer.py] => All params: 85921696
2024-09-12 04:04:58,257 [trainer.py] => Trainable params: 85921696
2024-09-12 04:04:58,259 [icarl.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.316, Train_accy 83.89, Test_accy 82.66:   0%|          | 0/20 [00:55<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.316, Train_accy 83.89, Test_accy 82.66:   5%|▌         | 1/20 [00:55<17:37, 55.67s/it]
Task 4, Epoch 2/20 => Loss 1.754, Train_accy 91.01:   5%|▌         | 1/20 [01:44<17:37, 55.67s/it]                 
Task 4, Epoch 2/20 => Loss 1.754, Train_accy 91.01:  10%|█         | 2/20 [01:44<15:28, 51.58s/it]
Task 4, Epoch 3/20 => Loss 1.641, Train_accy 93.22:  10%|█         | 2/20 [02:33<15:28, 51.58s/it]
Task 4, Epoch 3/20 => Loss 1.641, Train_accy 93.22:  15%|█▌        | 3/20 [02:33<14:16, 50.37s/it]
Task 4, Epoch 4/20 => Loss 1.721, Train_accy 92.16:  15%|█▌        | 3/20 [03:22<14:16, 50.37s/it]
Task 4, Epoch 4/20 => Loss 1.721, Train_accy 92.16:  20%|██        | 4/20 [03:22<13:17, 49.82s/it]
Task 4, Epoch 5/20 => Loss 1.733, Train_accy 92.83:  20%|██        | 4/20 [04:11<13:17, 49.82s/it]
Task 4, Epoch 5/20 => Loss 1.733, Train_accy 92.83:  25%|██▌       | 5/20 [04:11<12:22, 49.49s/it]
Task 4, Epoch 6/20 => Loss 1.676, Train_accy 93.29, Test_accy 82.99:  25%|██▌       | 5/20 [05:07<12:22, 49.49s/it]
Task 4, Epoch 6/20 => Loss 1.676, Train_accy 93.29, Test_accy 82.99:  30%|███       | 6/20 [05:07<12:05, 51.84s/it]
Task 4, Epoch 7/20 => Loss 1.655, Train_accy 93.51:  30%|███       | 6/20 [05:56<12:05, 51.84s/it]                 
Task 4, Epoch 7/20 => Loss 1.655, Train_accy 93.51:  35%|███▌      | 7/20 [05:56<11:01, 50.90s/it]
Task 4, Epoch 8/20 => Loss 1.651, Train_accy 93.92:  35%|███▌      | 7/20 [06:45<11:01, 50.90s/it]
Task 4, Epoch 8/20 => Loss 1.651, Train_accy 93.92:  40%|████      | 8/20 [06:45<10:03, 50.33s/it]
Task 4, Epoch 9/20 => Loss 1.648, Train_accy 94.32:  40%|████      | 8/20 [07:34<10:03, 50.33s/it]
Task 4, Epoch 9/20 => Loss 1.648, Train_accy 94.32:  45%|████▌     | 9/20 [07:34<09:09, 49.97s/it]
Task 4, Epoch 10/20 => Loss 1.628, Train_accy 94.32:  45%|████▌     | 9/20 [08:24<09:09, 49.97s/it]
Task 4, Epoch 10/20 => Loss 1.628, Train_accy 94.32:  50%|█████     | 10/20 [08:24<08:17, 49.79s/it]
Task 4, Epoch 11/20 => Loss 1.670, Train_accy 93.87, Test_accy 84.35:  50%|█████     | 10/20 [09:20<08:17, 49.79s/it]
Task 4, Epoch 11/20 => Loss 1.670, Train_accy 93.87, Test_accy 84.35:  55%|█████▌    | 11/20 [09:20<07:47, 51.90s/it]
Task 4, Epoch 12/20 => Loss 1.653, Train_accy 94.32:  55%|█████▌    | 11/20 [10:10<07:47, 51.90s/it]                 
Task 4, Epoch 12/20 => Loss 1.653, Train_accy 94.32:  60%|██████    | 12/20 [10:10<06:48, 51.09s/it]
Task 4, Epoch 13/20 => Loss 1.606, Train_accy 95.07:  60%|██████    | 12/20 [10:59<06:48, 51.09s/it]
Task 4, Epoch 13/20 => Loss 1.606, Train_accy 95.07:  65%|██████▌   | 13/20 [10:59<05:53, 50.50s/it]
Task 4, Epoch 14/20 => Loss 1.623, Train_accy 95.00:  65%|██████▌   | 13/20 [11:48<05:53, 50.50s/it]
Task 4, Epoch 14/20 => Loss 1.623, Train_accy 95.00:  70%|███████   | 14/20 [11:48<05:00, 50.12s/it]
Task 4, Epoch 15/20 => Loss 1.626, Train_accy 94.68:  70%|███████   | 14/20 [12:37<05:00, 50.12s/it]
Task 4, Epoch 15/20 => Loss 1.626, Train_accy 94.68:  75%|███████▌  | 15/20 [12:37<04:09, 49.81s/it]
Task 4, Epoch 16/20 => Loss 1.581, Train_accy 95.53, Test_accy 83.74:  75%|███████▌  | 15/20 [13:34<04:09, 49.81s/it]
Task 4, Epoch 16/20 => Loss 1.581, Train_accy 95.53, Test_accy 83.74:  80%|████████  | 16/20 [13:34<03:27, 51.83s/it]
Task 4, Epoch 17/20 => Loss 1.634, Train_accy 94.42:  80%|████████  | 16/20 [14:23<03:27, 51.83s/it]                 
Task 4, Epoch 17/20 => Loss 1.634, Train_accy 94.42:  85%|████████▌ | 17/20 [14:23<02:33, 51.02s/it]
Task 4, Epoch 18/20 => Loss 1.615, Train_accy 95.02:  85%|████████▌ | 17/20 [15:12<02:33, 51.02s/it]
Task 4, Epoch 18/20 => Loss 1.615, Train_accy 95.02:  90%|█████████ | 18/20 [15:12<01:40, 50.44s/it]
Task 4, Epoch 19/20 => Loss 1.626, Train_accy 95.02:  90%|█████████ | 18/20 [16:01<01:40, 50.44s/it]
Task 4, Epoch 19/20 => Loss 1.626, Train_accy 95.02:  95%|█████████▌| 19/20 [16:01<00:50, 50.02s/it]
Task 4, Epoch 20/20 => Loss 1.644, Train_accy 94.44:  95%|█████████▌| 19/20 [16:50<00:50, 50.02s/it]
Task 4, Epoch 20/20 => Loss 1.644, Train_accy 94.44: 100%|██████████| 20/20 [16:50<00:00, 49.70s/it]
Task 4, Epoch 20/20 => Loss 1.644, Train_accy 94.44: 100%|██████████| 20/20 [16:50<00:00, 50.52s/it]
2024-09-12 04:21:48,641 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.644, Train_accy 94.44
2024-09-12 04:21:48,643 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 04:23:11,612 [icarl.py] => Exemplar size: 3600
2024-09-12 04:23:11,613 [trainer.py] => CNN: {'total': 83.88, '00-99': 79.88, '100-119': 86.4, '120-139': 88.44, '140-159': 87.2, '160-179': 93.67, 'old': 82.65, 'new': 93.67}
2024-09-12 04:23:11,613 [trainer.py] => NME: {'total': 87.5, '00-99': 86.53, '100-119': 87.28, '120-139': 86.67, '140-159': 91.2, '160-179': 89.45, 'old': 87.26, 'new': 89.45}
2024-09-12 04:23:11,613 [trainer.py] => CNN top1 curve: [88.47, 87.71, 86.72, 85.93, 83.88]
2024-09-12 04:23:11,613 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.62, 97.36, 96.85]
2024-09-12 04:23:11,613 [trainer.py] => NME top1 curve: [90.4, 88.98, 87.87, 87.57, 87.5]
2024-09-12 04:23:11,613 [trainer.py] => NME top5 curve: [98.91, 98.45, 98.54, 98.2, 98.36]

Average Accuracy (CNN): 86.54
Average Accuracy (NME): 88.46
2024-09-12 04:23:11,613 [trainer.py] => Average Accuracy (CNN): 86.54
2024-09-12 04:23:11,613 [trainer.py] => Average Accuracy (NME): 88.46
2024-09-12 04:23:11,614 [trainer.py] => All params: 85937076
2024-09-12 04:23:11,614 [trainer.py] => Trainable params: 85937076
2024-09-12 04:23:11,616 [icarl.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.268, Train_accy 84.80, Test_accy 80.66:   0%|          | 0/20 [01:01<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.268, Train_accy 84.80, Test_accy 80.66:   5%|▌         | 1/20 [01:01<19:20, 61.09s/it]
Task 5, Epoch 2/20 => Loss 1.733, Train_accy 92.77:   5%|▌         | 1/20 [01:54<19:20, 61.09s/it]                 
Task 5, Epoch 2/20 => Loss 1.733, Train_accy 92.77:  10%|█         | 2/20 [01:54<16:57, 56.50s/it]
Task 5, Epoch 3/20 => Loss 1.737, Train_accy 93.50:  10%|█         | 2/20 [02:47<16:57, 56.50s/it]
Task 5, Epoch 3/20 => Loss 1.737, Train_accy 93.50:  15%|█▌        | 3/20 [02:47<15:36, 55.11s/it]
Task 5, Epoch 4/20 => Loss 1.741, Train_accy 93.32:  15%|█▌        | 3/20 [03:41<15:36, 55.11s/it]
Task 5, Epoch 4/20 => Loss 1.741, Train_accy 93.32:  20%|██        | 4/20 [03:41<14:32, 54.52s/it]
Task 5, Epoch 5/20 => Loss 1.778, Train_accy 93.17:  20%|██        | 4/20 [04:35<14:32, 54.52s/it]
Task 5, Epoch 5/20 => Loss 1.778, Train_accy 93.17:  25%|██▌       | 5/20 [04:35<13:32, 54.19s/it]
Task 5, Epoch 6/20 => Loss 1.703, Train_accy 94.42, Test_accy 80.75:  25%|██▌       | 5/20 [05:36<13:32, 54.19s/it]
Task 5, Epoch 6/20 => Loss 1.703, Train_accy 94.42, Test_accy 80.75:  30%|███       | 6/20 [05:36<13:14, 56.75s/it]
Task 5, Epoch 7/20 => Loss 1.681, Train_accy 94.53:  30%|███       | 6/20 [06:30<13:14, 56.75s/it]                 
Task 5, Epoch 7/20 => Loss 1.681, Train_accy 94.53:  35%|███▌      | 7/20 [06:30<12:04, 55.73s/it]
Task 5, Epoch 8/20 => Loss 1.648, Train_accy 94.79:  35%|███▌      | 7/20 [07:23<12:04, 55.73s/it]
Task 5, Epoch 8/20 => Loss 1.648, Train_accy 94.79:  40%|████      | 8/20 [07:23<11:00, 55.04s/it]
Task 5, Epoch 9/20 => Loss 1.693, Train_accy 94.18:  40%|████      | 8/20 [08:17<11:00, 55.04s/it]
Task 5, Epoch 9/20 => Loss 1.693, Train_accy 94.18:  45%|████▌     | 9/20 [08:17<10:00, 54.57s/it]
Task 5, Epoch 10/20 => Loss 1.686, Train_accy 94.38:  45%|████▌     | 9/20 [09:11<10:00, 54.57s/it]
Task 5, Epoch 10/20 => Loss 1.686, Train_accy 94.38:  50%|█████     | 10/20 [09:11<09:02, 54.27s/it]
Task 5, Epoch 11/20 => Loss 1.701, Train_accy 94.49, Test_accy 81.89:  50%|█████     | 10/20 [10:12<09:02, 54.27s/it]
Task 5, Epoch 11/20 => Loss 1.701, Train_accy 94.49, Test_accy 81.89:  55%|█████▌    | 11/20 [10:12<08:28, 56.55s/it]
Task 5, Epoch 12/20 => Loss 1.632, Train_accy 94.95:  55%|█████▌    | 11/20 [11:06<08:28, 56.55s/it]                 
Task 5, Epoch 12/20 => Loss 1.632, Train_accy 94.95:  60%|██████    | 12/20 [11:06<07:25, 55.68s/it]
Task 5, Epoch 13/20 => Loss 1.690, Train_accy 94.31:  60%|██████    | 12/20 [12:00<07:25, 55.68s/it]
Task 5, Epoch 13/20 => Loss 1.690, Train_accy 94.31:  65%|██████▌   | 13/20 [12:00<06:25, 55.06s/it]
Task 5, Epoch 14/20 => Loss 1.691, Train_accy 94.62:  65%|██████▌   | 13/20 [12:53<06:25, 55.06s/it]
Task 5, Epoch 14/20 => Loss 1.691, Train_accy 94.62:  70%|███████   | 14/20 [12:53<05:27, 54.64s/it]
Task 5, Epoch 15/20 => Loss 1.681, Train_accy 95.23:  70%|███████   | 14/20 [13:47<05:27, 54.64s/it]
Task 5, Epoch 15/20 => Loss 1.681, Train_accy 95.23:  75%|███████▌  | 15/20 [13:47<04:31, 54.31s/it]
Task 5, Epoch 16/20 => Loss 1.664, Train_accy 95.08, Test_accy 82.27:  75%|███████▌  | 15/20 [14:49<04:31, 54.31s/it]
Task 5, Epoch 16/20 => Loss 1.664, Train_accy 95.08, Test_accy 82.27:  80%|████████  | 16/20 [14:49<03:46, 56.58s/it]
Task 5, Epoch 17/20 => Loss 1.693, Train_accy 94.71:  80%|████████  | 16/20 [15:42<03:46, 56.58s/it]                 
Task 5, Epoch 17/20 => Loss 1.693, Train_accy 94.71:  85%|████████▌ | 17/20 [15:42<02:47, 55.73s/it]
Task 5, Epoch 18/20 => Loss 1.678, Train_accy 95.01:  85%|████████▌ | 17/20 [16:36<02:47, 55.73s/it]
Task 5, Epoch 18/20 => Loss 1.678, Train_accy 95.01:  90%|█████████ | 18/20 [16:36<01:50, 55.09s/it]
Task 5, Epoch 19/20 => Loss 1.679, Train_accy 95.41:  90%|█████████ | 18/20 [17:30<01:50, 55.09s/it]
Task 5, Epoch 19/20 => Loss 1.679, Train_accy 95.41:  95%|█████████▌| 19/20 [17:30<00:54, 54.62s/it]
Task 5, Epoch 20/20 => Loss 1.615, Train_accy 95.98:  95%|█████████▌| 19/20 [18:23<00:54, 54.62s/it]
Task 5, Epoch 20/20 => Loss 1.615, Train_accy 95.98: 100%|██████████| 20/20 [18:23<00:00, 54.35s/it]
Task 5, Epoch 20/20 => Loss 1.615, Train_accy 95.98: 100%|██████████| 20/20 [18:23<00:00, 55.19s/it]
2024-09-12 04:41:35,428 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.615, Train_accy 95.98
2024-09-12 04:41:35,429 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 04:43:08,302 [icarl.py] => Exemplar size: 4000
2024-09-12 04:43:08,303 [trainer.py] => CNN: {'total': 82.7, '00-99': 78.2, '100-119': 82.89, '120-139': 85.78, '140-159': 84.8, '160-179': 90.72, '180-199': 92.17, 'old': 81.67, 'new': 92.17}
2024-09-12 04:43:08,303 [trainer.py] => NME: {'total': 86.34, '00-99': 85.69, '100-119': 85.96, '120-139': 83.56, '140-159': 90.0, '160-179': 89.03, '180-199': 86.09, 'old': 86.37, 'new': 86.09}
2024-09-12 04:43:08,303 [trainer.py] => CNN top1 curve: [88.47, 87.71, 86.72, 85.93, 83.88, 82.7]
2024-09-12 04:43:08,303 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.62, 97.36, 96.85, 96.23]
2024-09-12 04:43:08,303 [trainer.py] => NME top1 curve: [90.4, 88.98, 87.87, 87.57, 87.5, 86.34]
2024-09-12 04:43:08,303 [trainer.py] => NME top5 curve: [98.91, 98.45, 98.54, 98.2, 98.36, 97.84]

Average Accuracy (CNN): 85.9
Average Accuracy (NME): 88.11
2024-09-12 04:43:08,303 [trainer.py] => Average Accuracy (CNN): 85.9
2024-09-12 04:43:08,303 [trainer.py] => Average Accuracy (NME): 88.11
Accuracy Matrix (CNN):
[[88.47 86.7  85.44 83.16 79.88 78.2 ]
 [ 0.   92.98 88.6  89.47 86.4  82.89]
 [ 0.    0.   91.56 90.67 88.44 85.78]
 [ 0.    0.    0.   91.6  87.2  84.8 ]
 [ 0.    0.    0.    0.   93.67 90.72]
 [ 0.    0.    0.    0.    0.   92.17]]
2024-09-12 04:43:08,304 [trainer.py] => Forgetting (CNN): 7.178
Accuracy Matrix (NME):
[[90.4  88.97 87.46 87.21 86.53 85.69]
 [ 0.   89.04 89.91 86.84 87.28 85.96]
 [ 0.    0.   88.   86.67 86.67 83.56]
 [ 0.    0.    0.   90.8  91.2  90.  ]
 [ 0.    0.    0.    0.   89.45 89.03]
 [ 0.    0.    0.    0.    0.   86.09]]
2024-09-12 04:43:08,304 [trainer.py] => Forgetting (NME): 2.9440000000000026
2024-09-12 04:43:11,186 [trainer.py] => config: ./exps/icarl_cub_B100_Inc10.json
2024-09-12 04:43:11,205 [trainer.py] => prefix: reproduce
2024-09-12 04:43:11,205 [trainer.py] => dataset: cub
2024-09-12 04:43:11,205 [trainer.py] => memory_size: 4000
2024-09-12 04:43:11,205 [trainer.py] => memory_per_class: 20
2024-09-12 04:43:11,205 [trainer.py] => fixed_memory: True
2024-09-12 04:43:11,205 [trainer.py] => shuffle: True
2024-09-12 04:43:11,205 [trainer.py] => init_cls: 100
2024-09-12 04:43:11,205 [trainer.py] => increment: 10
2024-09-12 04:43:11,205 [trainer.py] => model_name: icarl
2024-09-12 04:43:11,205 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 04:43:11,205 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-12 04:43:11,205 [trainer.py] => seed: 1993
2024-09-12 04:43:11,205 [trainer.py] => init_epoch: 20
2024-09-12 04:43:11,205 [trainer.py] => init_lr: 0.001
2024-09-12 04:43:11,206 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 04:43:11,206 [trainer.py] => init_lr_decay: 0.1
2024-09-12 04:43:11,206 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 04:43:11,206 [trainer.py] => epochs: 20
2024-09-12 04:43:11,206 [trainer.py] => lrate: 0.001
2024-09-12 04:43:11,206 [trainer.py] => milestones: [80, 120]
2024-09-12 04:43:11,206 [trainer.py] => lrate_decay: 0.1
2024-09-12 04:43:11,206 [trainer.py] => batch_size: 48
2024-09-12 04:43:11,206 [trainer.py] => weight_decay: 0.0002
2024-09-12 04:43:11,206 [trainer.py] => T: 2
2024-09-12 04:43:11,252 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-09-12 04:43:13,122 [trainer.py] => All params: 85798656
2024-09-12 04:43:13,123 [trainer.py] => Trainable params: 85798656
2024-09-12 04:43:13,124 [icarl.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   0%|          | 0/20 [00:44<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.801, Train_accy 36.41, Test_accy 76.94:   5%|▌         | 1/20 [00:44<14:11, 44.84s/it]
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:   5%|▌         | 1/20 [01:25<14:11, 44.84s/it]                 
Task 0, Epoch 2/20 => Loss 0.899, Train_accy 75.20:  10%|█         | 2/20 [01:25<12:43, 42.43s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  10%|█         | 2/20 [02:06<12:43, 42.43s/it]
Task 0, Epoch 3/20 => Loss 0.711, Train_accy 80.10:  15%|█▌        | 3/20 [02:06<11:49, 41.71s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  15%|█▌        | 3/20 [02:47<11:49, 41.71s/it]
Task 0, Epoch 4/20 => Loss 0.650, Train_accy 82.57:  20%|██        | 4/20 [02:47<11:02, 41.38s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  20%|██        | 4/20 [03:28<11:02, 41.38s/it]
Task 0, Epoch 5/20 => Loss 0.571, Train_accy 84.45:  25%|██▌       | 5/20 [03:28<10:19, 41.28s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  25%|██▌       | 5/20 [04:13<10:19, 41.28s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 86.92, Test_accy 88.80:  30%|███       | 6/20 [04:13<09:57, 42.66s/it]
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  30%|███       | 6/20 [04:54<09:57, 42.66s/it]                 
Task 0, Epoch 7/20 => Loss 0.491, Train_accy 86.66:  35%|███▌      | 7/20 [04:54<09:07, 42.15s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  35%|███▌      | 7/20 [05:35<09:07, 42.15s/it]
Task 0, Epoch 8/20 => Loss 0.437, Train_accy 88.09:  40%|████      | 8/20 [05:35<08:21, 41.76s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  40%|████      | 8/20 [06:16<08:21, 41.76s/it]
Task 0, Epoch 9/20 => Loss 0.411, Train_accy 88.33:  45%|████▌     | 9/20 [06:16<07:37, 41.55s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  45%|████▌     | 9/20 [06:57<07:37, 41.55s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 89.07:  50%|█████     | 10/20 [06:57<06:53, 41.37s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  50%|█████     | 10/20 [07:43<06:53, 41.37s/it]
Task 0, Epoch 11/20 => Loss 0.380, Train_accy 89.56, Test_accy 87.96:  55%|█████▌    | 11/20 [07:43<06:23, 42.56s/it]
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  55%|█████▌    | 11/20 [08:24<06:23, 42.56s/it]                 
Task 0, Epoch 12/20 => Loss 0.389, Train_accy 89.63:  60%|██████    | 12/20 [08:24<05:36, 42.10s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  60%|██████    | 12/20 [09:05<05:36, 42.10s/it]
Task 0, Epoch 13/20 => Loss 0.353, Train_accy 89.99:  65%|██████▌   | 13/20 [09:05<04:52, 41.81s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  65%|██████▌   | 13/20 [09:46<04:52, 41.81s/it]
Task 0, Epoch 14/20 => Loss 0.369, Train_accy 90.14:  70%|███████   | 14/20 [09:46<04:09, 41.56s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  70%|███████   | 14/20 [10:27<04:09, 41.56s/it]
Task 0, Epoch 15/20 => Loss 0.353, Train_accy 90.99:  75%|███████▌  | 15/20 [10:27<03:26, 41.37s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  75%|███████▌  | 15/20 [11:12<03:26, 41.37s/it]
Task 0, Epoch 16/20 => Loss 0.332, Train_accy 91.07, Test_accy 89.98:  80%|████████  | 16/20 [11:12<02:50, 42.57s/it]
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  80%|████████  | 16/20 [11:53<02:50, 42.57s/it]                 
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 91.14:  85%|████████▌ | 17/20 [11:53<02:06, 42.08s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  85%|████████▌ | 17/20 [12:34<02:06, 42.08s/it]
Task 0, Epoch 18/20 => Loss 0.355, Train_accy 90.69:  90%|█████████ | 18/20 [12:34<01:23, 41.77s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  90%|█████████ | 18/20 [13:15<01:23, 41.77s/it]
Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.80:  95%|█████████▌| 19/20 [13:15<00:41, 41.59s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29:  95%|█████████▌| 19/20 [13:56<00:41, 41.59s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [13:56<00:00, 41.45s/it]
Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29: 100%|██████████| 20/20 [13:56<00:00, 41.84s/it]
2024-09-12 04:57:10,446 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.333, Train_accy 91.29
2024-09-12 04:57:10,447 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 04:58:46,679 [icarl.py] => Exemplar size: 2000
2024-09-12 04:58:46,679 [trainer.py] => CNN: {'total': 88.47, '00-99': 88.47, 'old': 0, 'new': 88.47}
2024-09-12 04:58:46,679 [trainer.py] => NME: {'total': 90.4, '00-99': 90.4, 'old': 0, 'new': 90.4}
2024-09-12 04:58:46,679 [trainer.py] => CNN top1 curve: [88.47]
2024-09-12 04:58:46,679 [trainer.py] => CNN top5 curve: [98.15]
2024-09-12 04:58:46,679 [trainer.py] => NME top1 curve: [90.4]
2024-09-12 04:58:46,679 [trainer.py] => NME top5 curve: [98.91]

Average Accuracy (CNN): 88.47
Average Accuracy (NME): 90.4
2024-09-12 04:58:46,680 [trainer.py] => Average Accuracy (CNN): 88.47
2024-09-12 04:58:46,680 [trainer.py] => Average Accuracy (NME): 90.4
2024-09-12 04:58:46,680 [trainer.py] => All params: 85875556
2024-09-12 04:58:46,681 [trainer.py] => Trainable params: 85875556
2024-09-12 04:58:46,682 [icarl.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.934, Train_accy 83.56, Test_accy 87.87:   0%|          | 0/20 [00:33<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.934, Train_accy 83.56, Test_accy 87.87:   5%|▌         | 1/20 [00:33<10:43, 33.85s/it]
Task 1, Epoch 2/20 => Loss 1.481, Train_accy 89.72:   5%|▌         | 1/20 [01:03<10:43, 33.85s/it]                 
Task 1, Epoch 2/20 => Loss 1.481, Train_accy 89.72:  10%|█         | 2/20 [01:03<09:21, 31.21s/it]
Task 1, Epoch 3/20 => Loss 1.440, Train_accy 91.58:  10%|█         | 2/20 [01:32<09:21, 31.21s/it]
Task 1, Epoch 3/20 => Loss 1.440, Train_accy 91.58:  15%|█▌        | 3/20 [01:32<08:37, 30.44s/it]
Task 1, Epoch 4/20 => Loss 1.480, Train_accy 91.05:  15%|█▌        | 3/20 [02:02<08:37, 30.44s/it]
Task 1, Epoch 4/20 => Loss 1.480, Train_accy 91.05:  20%|██        | 4/20 [02:02<08:00, 30.05s/it]
Task 1, Epoch 5/20 => Loss 1.459, Train_accy 91.86:  20%|██        | 4/20 [02:31<08:00, 30.05s/it]
Task 1, Epoch 5/20 => Loss 1.459, Train_accy 91.86:  25%|██▌       | 5/20 [02:31<07:27, 29.82s/it]
Task 1, Epoch 6/20 => Loss 1.351, Train_accy 92.87, Test_accy 89.56:  25%|██▌       | 5/20 [03:05<07:27, 29.82s/it]
Task 1, Epoch 6/20 => Loss 1.351, Train_accy 92.87, Test_accy 89.56:  30%|███       | 6/20 [03:05<07:18, 31.32s/it]
Task 1, Epoch 7/20 => Loss 1.358, Train_accy 93.19:  30%|███       | 6/20 [03:35<07:18, 31.32s/it]                 
Task 1, Epoch 7/20 => Loss 1.358, Train_accy 93.19:  35%|███▌      | 7/20 [03:35<06:39, 30.74s/it]
Task 1, Epoch 8/20 => Loss 1.397, Train_accy 92.50:  35%|███▌      | 7/20 [04:04<06:39, 30.74s/it]
Task 1, Epoch 8/20 => Loss 1.397, Train_accy 92.50:  40%|████      | 8/20 [04:04<06:03, 30.30s/it]
Task 1, Epoch 9/20 => Loss 1.320, Train_accy 93.79:  40%|████      | 8/20 [04:34<06:03, 30.30s/it]
Task 1, Epoch 9/20 => Loss 1.320, Train_accy 93.79:  45%|████▌     | 9/20 [04:34<05:30, 30.04s/it]
Task 1, Epoch 10/20 => Loss 1.387, Train_accy 92.66:  45%|████▌     | 9/20 [05:03<05:30, 30.04s/it]
Task 1, Epoch 10/20 => Loss 1.387, Train_accy 92.66:  50%|█████     | 10/20 [05:03<04:58, 29.86s/it]
Task 1, Epoch 11/20 => Loss 1.316, Train_accy 93.83, Test_accy 89.49:  50%|█████     | 10/20 [05:37<04:58, 29.86s/it]
Task 1, Epoch 11/20 => Loss 1.316, Train_accy 93.83, Test_accy 89.49:  55%|█████▌    | 11/20 [05:37<04:40, 31.19s/it]
Task 1, Epoch 12/20 => Loss 1.326, Train_accy 93.99:  55%|█████▌    | 11/20 [06:07<04:40, 31.19s/it]                 
Task 1, Epoch 12/20 => Loss 1.326, Train_accy 93.99:  60%|██████    | 12/20 [06:07<04:05, 30.63s/it]
Task 1, Epoch 13/20 => Loss 1.263, Train_accy 94.52:  60%|██████    | 12/20 [06:36<04:05, 30.63s/it]
Task 1, Epoch 13/20 => Loss 1.263, Train_accy 94.52:  65%|██████▌   | 13/20 [06:36<03:32, 30.32s/it]
Task 1, Epoch 14/20 => Loss 1.405, Train_accy 93.11:  65%|██████▌   | 13/20 [07:06<03:32, 30.32s/it]
Task 1, Epoch 14/20 => Loss 1.405, Train_accy 93.11:  70%|███████   | 14/20 [07:06<03:00, 30.04s/it]
Task 1, Epoch 15/20 => Loss 1.373, Train_accy 93.43:  70%|███████   | 14/20 [07:35<03:00, 30.04s/it]
Task 1, Epoch 15/20 => Loss 1.373, Train_accy 93.43:  75%|███████▌  | 15/20 [07:35<02:29, 29.83s/it]
Task 1, Epoch 16/20 => Loss 1.345, Train_accy 94.20, Test_accy 88.56:  75%|███████▌  | 15/20 [08:09<02:29, 29.83s/it]
Task 1, Epoch 16/20 => Loss 1.345, Train_accy 94.20, Test_accy 88.56:  80%|████████  | 16/20 [08:09<02:04, 31.12s/it]
Task 1, Epoch 17/20 => Loss 1.367, Train_accy 93.55:  80%|████████  | 16/20 [08:39<02:04, 31.12s/it]                 
Task 1, Epoch 17/20 => Loss 1.367, Train_accy 93.55:  85%|████████▌ | 17/20 [08:39<01:31, 30.59s/it]
Task 1, Epoch 18/20 => Loss 1.338, Train_accy 94.32:  85%|████████▌ | 17/20 [09:08<01:31, 30.59s/it]
Task 1, Epoch 18/20 => Loss 1.338, Train_accy 94.32:  90%|█████████ | 18/20 [09:08<01:00, 30.24s/it]
Task 1, Epoch 19/20 => Loss 1.331, Train_accy 94.24:  90%|█████████ | 18/20 [09:37<01:00, 30.24s/it]
Task 1, Epoch 19/20 => Loss 1.331, Train_accy 94.24:  95%|█████████▌| 19/20 [09:37<00:29, 29.98s/it]
Task 1, Epoch 20/20 => Loss 1.333, Train_accy 94.12:  95%|█████████▌| 19/20 [10:07<00:29, 29.98s/it]
Task 1, Epoch 20/20 => Loss 1.333, Train_accy 94.12: 100%|██████████| 20/20 [10:07<00:00, 29.79s/it]
Task 1, Epoch 20/20 => Loss 1.333, Train_accy 94.12: 100%|██████████| 20/20 [10:07<00:00, 30.36s/it]
2024-09-12 05:08:53,860 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.333, Train_accy 94.12
2024-09-12 05:08:53,861 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 05:09:44,519 [icarl.py] => Exemplar size: 2200
2024-09-12 05:09:44,520 [trainer.py] => CNN: {'total': 89.64, '00-99': 89.31, '100-109': 93.04, 'old': 89.31, 'new': 93.04}
2024-09-12 05:09:44,520 [trainer.py] => NME: {'total': 90.56, '00-99': 90.4, '100-109': 92.17, 'old': 90.4, 'new': 92.17}
2024-09-12 05:09:44,520 [trainer.py] => CNN top1 curve: [88.47, 89.64]
2024-09-12 05:09:44,520 [trainer.py] => CNN top5 curve: [98.15, 98.54]
2024-09-12 05:09:44,520 [trainer.py] => NME top1 curve: [90.4, 90.56]
2024-09-12 05:09:44,520 [trainer.py] => NME top5 curve: [98.91, 98.85]

Average Accuracy (CNN): 89.06
Average Accuracy (NME): 90.48
2024-09-12 05:09:44,520 [trainer.py] => Average Accuracy (CNN): 89.06
2024-09-12 05:09:44,520 [trainer.py] => Average Accuracy (NME): 90.48
2024-09-12 05:09:44,520 [trainer.py] => All params: 85883246
2024-09-12 05:09:44,521 [trainer.py] => Trainable params: 85883246
2024-09-12 05:09:44,522 [icarl.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.850, Train_accy 84.99, Test_accy 85.38:   0%|          | 0/20 [00:36<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.850, Train_accy 84.99, Test_accy 85.38:   5%|▌         | 1/20 [00:36<11:28, 36.24s/it]
Task 2, Epoch 2/20 => Loss 1.445, Train_accy 91.73:   5%|▌         | 1/20 [01:07<11:28, 36.24s/it]                 
Task 2, Epoch 2/20 => Loss 1.445, Train_accy 91.73:  10%|█         | 2/20 [01:07<10:02, 33.47s/it]
Task 2, Epoch 3/20 => Loss 1.423, Train_accy 92.03:  10%|█         | 2/20 [01:39<10:02, 33.47s/it]
Task 2, Epoch 3/20 => Loss 1.423, Train_accy 92.03:  15%|█▌        | 3/20 [01:39<09:14, 32.61s/it]
Task 2, Epoch 4/20 => Loss 1.351, Train_accy 93.34:  15%|█▌        | 3/20 [02:10<09:14, 32.61s/it]
Task 2, Epoch 4/20 => Loss 1.351, Train_accy 93.34:  20%|██        | 4/20 [02:10<08:34, 32.18s/it]
Task 2, Epoch 5/20 => Loss 1.391, Train_accy 93.19:  20%|██        | 4/20 [02:42<08:34, 32.18s/it]
Task 2, Epoch 5/20 => Loss 1.391, Train_accy 93.19:  25%|██▌       | 5/20 [02:42<07:59, 31.95s/it]
Task 2, Epoch 6/20 => Loss 1.391, Train_accy 93.60, Test_accy 87.50:  25%|██▌       | 5/20 [03:18<07:59, 31.95s/it]
Task 2, Epoch 6/20 => Loss 1.391, Train_accy 93.60, Test_accy 87.50:  30%|███       | 6/20 [03:18<07:49, 33.52s/it]
Task 2, Epoch 7/20 => Loss 1.347, Train_accy 94.31:  30%|███       | 6/20 [03:50<07:49, 33.52s/it]                 
Task 2, Epoch 7/20 => Loss 1.347, Train_accy 94.31:  35%|███▌      | 7/20 [03:50<07:07, 32.88s/it]
Task 2, Epoch 8/20 => Loss 1.338, Train_accy 94.27:  35%|███▌      | 7/20 [04:22<07:07, 32.88s/it]
Task 2, Epoch 8/20 => Loss 1.338, Train_accy 94.27:  40%|████      | 8/20 [04:22<06:29, 32.48s/it]
Task 2, Epoch 9/20 => Loss 1.326, Train_accy 94.46:  40%|████      | 8/20 [04:53<06:29, 32.48s/it]
Task 2, Epoch 9/20 => Loss 1.326, Train_accy 94.46:  45%|████▌     | 9/20 [04:53<05:54, 32.20s/it]
Task 2, Epoch 10/20 => Loss 1.361, Train_accy 93.93:  45%|████▌     | 9/20 [05:25<05:54, 32.20s/it]
Task 2, Epoch 10/20 => Loss 1.361, Train_accy 93.93:  50%|█████     | 10/20 [05:25<05:20, 32.01s/it]
Task 2, Epoch 11/20 => Loss 1.388, Train_accy 93.64, Test_accy 87.22:  50%|█████     | 10/20 [06:01<05:20, 32.01s/it]
Task 2, Epoch 11/20 => Loss 1.388, Train_accy 93.64, Test_accy 87.22:  55%|█████▌    | 11/20 [06:01<05:00, 33.43s/it]
Task 2, Epoch 12/20 => Loss 1.334, Train_accy 94.16:  55%|█████▌    | 11/20 [06:33<05:00, 33.43s/it]                 
Task 2, Epoch 12/20 => Loss 1.334, Train_accy 94.16:  60%|██████    | 12/20 [06:33<04:22, 32.86s/it]
Task 2, Epoch 13/20 => Loss 1.333, Train_accy 94.87:  60%|██████    | 12/20 [07:05<04:22, 32.86s/it]
Task 2, Epoch 13/20 => Loss 1.333, Train_accy 94.87:  65%|██████▌   | 13/20 [07:05<03:47, 32.50s/it]
Task 2, Epoch 14/20 => Loss 1.297, Train_accy 94.68:  65%|██████▌   | 13/20 [07:36<03:47, 32.50s/it]
Task 2, Epoch 14/20 => Loss 1.297, Train_accy 94.68:  70%|███████   | 14/20 [07:36<03:13, 32.27s/it]
Task 2, Epoch 15/20 => Loss 1.305, Train_accy 95.43:  70%|███████   | 14/20 [08:08<03:13, 32.27s/it]
Task 2, Epoch 15/20 => Loss 1.305, Train_accy 95.43:  75%|███████▌  | 15/20 [08:08<02:40, 32.07s/it]
Task 2, Epoch 16/20 => Loss 1.370, Train_accy 94.38, Test_accy 86.72:  75%|███████▌  | 15/20 [08:45<02:40, 32.07s/it]
Task 2, Epoch 16/20 => Loss 1.370, Train_accy 94.38, Test_accy 86.72:  80%|████████  | 16/20 [08:45<02:13, 33.44s/it]
Task 2, Epoch 17/20 => Loss 1.341, Train_accy 94.42:  80%|████████  | 16/20 [09:16<02:13, 33.44s/it]                 
Task 2, Epoch 17/20 => Loss 1.341, Train_accy 94.42:  85%|████████▌ | 17/20 [09:16<01:38, 32.88s/it]
Task 2, Epoch 18/20 => Loss 1.378, Train_accy 94.53:  85%|████████▌ | 17/20 [09:48<01:38, 32.88s/it]
Task 2, Epoch 18/20 => Loss 1.378, Train_accy 94.53:  90%|█████████ | 18/20 [09:48<01:05, 32.52s/it]
Task 2, Epoch 19/20 => Loss 1.330, Train_accy 94.98:  90%|█████████ | 18/20 [10:20<01:05, 32.52s/it]
Task 2, Epoch 19/20 => Loss 1.330, Train_accy 94.98:  95%|█████████▌| 19/20 [10:20<00:32, 32.29s/it]
Task 2, Epoch 20/20 => Loss 1.280, Train_accy 95.77:  95%|█████████▌| 19/20 [10:51<00:32, 32.29s/it]
Task 2, Epoch 20/20 => Loss 1.280, Train_accy 95.77: 100%|██████████| 20/20 [10:51<00:00, 32.08s/it]
Task 2, Epoch 20/20 => Loss 1.280, Train_accy 95.77: 100%|██████████| 20/20 [10:51<00:00, 32.59s/it]
2024-09-12 05:20:36,326 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.280, Train_accy 95.77
2024-09-12 05:20:36,327 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 05:21:30,452 [icarl.py] => Exemplar size: 2400
2024-09-12 05:21:30,453 [trainer.py] => CNN: {'total': 87.29, '00-99': 86.2, '100-109': 93.91, '110-119': 92.04, 'old': 86.88, 'new': 92.04}
2024-09-12 05:21:30,453 [trainer.py] => NME: {'total': 89.12, '00-99': 89.31, '100-109': 93.04, '110-119': 83.19, 'old': 89.64, 'new': 83.19}
2024-09-12 05:21:30,453 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29]
2024-09-12 05:21:30,453 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88]
2024-09-12 05:21:30,453 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12]
2024-09-12 05:21:30,453 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87]

Average Accuracy (CNN): 88.47
Average Accuracy (NME): 90.03
2024-09-12 05:21:30,453 [trainer.py] => Average Accuracy (CNN): 88.47
2024-09-12 05:21:30,453 [trainer.py] => Average Accuracy (NME): 90.03
2024-09-12 05:21:30,454 [trainer.py] => All params: 85890936
2024-09-12 05:21:30,454 [trainer.py] => Trainable params: 85890936
2024-09-12 05:21:30,455 [icarl.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.907, Train_accy 86.50, Test_accy 84.64:   0%|          | 0/20 [00:39<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.907, Train_accy 86.50, Test_accy 84.64:   5%|▌         | 1/20 [00:39<12:21, 39.01s/it]
Task 3, Epoch 2/20 => Loss 1.451, Train_accy 92.23:   5%|▌         | 1/20 [01:12<12:21, 39.01s/it]                 
Task 3, Epoch 2/20 => Loss 1.451, Train_accy 92.23:  10%|█         | 2/20 [01:12<10:47, 35.98s/it]
Task 3, Epoch 3/20 => Loss 1.429, Train_accy 93.03:  10%|█         | 2/20 [01:46<10:47, 35.98s/it]
Task 3, Epoch 3/20 => Loss 1.429, Train_accy 93.03:  15%|█▌        | 3/20 [01:46<09:55, 35.06s/it]
Task 3, Epoch 4/20 => Loss 1.463, Train_accy 93.48:  15%|█▌        | 3/20 [02:20<09:55, 35.06s/it]
Task 3, Epoch 4/20 => Loss 1.463, Train_accy 93.48:  20%|██        | 4/20 [02:20<09:14, 34.65s/it]
Task 3, Epoch 5/20 => Loss 1.639, Train_accy 91.46:  20%|██        | 4/20 [02:54<09:14, 34.65s/it]
Task 3, Epoch 5/20 => Loss 1.639, Train_accy 91.46:  25%|██▌       | 5/20 [02:54<08:36, 34.45s/it]
Task 3, Epoch 6/20 => Loss 1.574, Train_accy 91.05, Test_accy 84.50:  25%|██▌       | 5/20 [03:34<08:36, 34.45s/it]
Task 3, Epoch 6/20 => Loss 1.574, Train_accy 91.05, Test_accy 84.50:  30%|███       | 6/20 [03:34<08:26, 36.18s/it]
Task 3, Epoch 7/20 => Loss 1.472, Train_accy 93.27:  30%|███       | 6/20 [04:08<08:26, 36.18s/it]                 
Task 3, Epoch 7/20 => Loss 1.472, Train_accy 93.27:  35%|███▌      | 7/20 [04:08<07:41, 35.48s/it]
Task 3, Epoch 8/20 => Loss 1.524, Train_accy 93.86:  35%|███▌      | 7/20 [04:42<07:41, 35.48s/it]
Task 3, Epoch 8/20 => Loss 1.524, Train_accy 93.86:  40%|████      | 8/20 [04:42<07:00, 35.03s/it]
Task 3, Epoch 9/20 => Loss 1.583, Train_accy 92.47:  40%|████      | 8/20 [05:16<07:00, 35.03s/it]
Task 3, Epoch 9/20 => Loss 1.583, Train_accy 92.47:  45%|████▌     | 9/20 [05:16<06:22, 34.76s/it]
Task 3, Epoch 10/20 => Loss 1.427, Train_accy 93.37:  45%|████▌     | 9/20 [05:50<06:22, 34.76s/it]
Task 3, Epoch 10/20 => Loss 1.427, Train_accy 93.37:  50%|█████     | 10/20 [05:50<05:45, 34.54s/it]
Task 3, Epoch 11/20 => Loss 1.494, Train_accy 93.55, Test_accy 85.62:  50%|█████     | 10/20 [06:30<05:45, 34.54s/it]
Task 3, Epoch 11/20 => Loss 1.494, Train_accy 93.55, Test_accy 85.62:  55%|█████▌    | 11/20 [06:30<05:24, 36.07s/it]
Task 3, Epoch 12/20 => Loss 1.581, Train_accy 92.57:  55%|█████▌    | 11/20 [07:04<05:24, 36.07s/it]                 
Task 3, Epoch 12/20 => Loss 1.581, Train_accy 92.57:  60%|██████    | 12/20 [07:04<04:43, 35.47s/it]
Task 3, Epoch 13/20 => Loss 1.446, Train_accy 93.55:  60%|██████    | 12/20 [07:38<04:43, 35.47s/it]
Task 3, Epoch 13/20 => Loss 1.446, Train_accy 93.55:  65%|██████▌   | 13/20 [07:38<04:05, 35.08s/it]
Task 3, Epoch 14/20 => Loss 1.504, Train_accy 94.21:  65%|██████▌   | 13/20 [08:12<04:05, 35.08s/it]
Task 3, Epoch 14/20 => Loss 1.504, Train_accy 94.21:  70%|███████   | 14/20 [08:12<03:28, 34.77s/it]
Task 3, Epoch 15/20 => Loss 1.430, Train_accy 93.72:  70%|███████   | 14/20 [08:46<03:28, 34.77s/it]
Task 3, Epoch 15/20 => Loss 1.430, Train_accy 93.72:  75%|███████▌  | 15/20 [08:46<02:52, 34.58s/it]
Task 3, Epoch 16/20 => Loss 1.438, Train_accy 94.62, Test_accy 86.74:  75%|███████▌  | 15/20 [09:26<02:52, 34.58s/it]
Task 3, Epoch 16/20 => Loss 1.438, Train_accy 94.62, Test_accy 86.74:  80%|████████  | 16/20 [09:26<02:24, 36.05s/it]
Task 3, Epoch 17/20 => Loss 1.425, Train_accy 95.28:  80%|████████  | 16/20 [10:00<02:24, 36.05s/it]                 
Task 3, Epoch 17/20 => Loss 1.425, Train_accy 95.28:  85%|████████▌ | 17/20 [10:00<01:46, 35.50s/it]
Task 3, Epoch 18/20 => Loss 1.526, Train_accy 93.48:  85%|████████▌ | 17/20 [10:34<01:46, 35.50s/it]
Task 3, Epoch 18/20 => Loss 1.526, Train_accy 93.48:  90%|█████████ | 18/20 [10:34<01:10, 35.06s/it]
Task 3, Epoch 19/20 => Loss 1.468, Train_accy 94.80:  90%|█████████ | 18/20 [11:08<01:10, 35.06s/it]
Task 3, Epoch 19/20 => Loss 1.468, Train_accy 94.80:  95%|█████████▌| 19/20 [11:08<00:34, 34.76s/it]
Task 3, Epoch 20/20 => Loss 1.474, Train_accy 93.37:  95%|█████████▌| 19/20 [11:42<00:34, 34.76s/it]
Task 3, Epoch 20/20 => Loss 1.474, Train_accy 93.37: 100%|██████████| 20/20 [11:42<00:00, 34.55s/it]
Task 3, Epoch 20/20 => Loss 1.474, Train_accy 93.37: 100%|██████████| 20/20 [11:42<00:00, 35.13s/it]
2024-09-12 05:33:13,097 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.474, Train_accy 93.37
2024-09-12 05:33:13,099 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 05:34:11,464 [icarl.py] => Exemplar size: 2600
2024-09-12 05:34:11,465 [trainer.py] => CNN: {'total': 86.54, '00-99': 85.61, '100-109': 91.3, '110-119': 91.15, '120-129': 86.92, 'old': 86.51, 'new': 86.92}
2024-09-12 05:34:11,465 [trainer.py] => NME: {'total': 86.8, '00-99': 87.12, '100-109': 90.43, '110-119': 80.53, '120-129': 85.98, 'old': 86.86, 'new': 85.98}
2024-09-12 05:34:11,465 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54]
2024-09-12 05:34:11,465 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7]
2024-09-12 05:34:11,465 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8]
2024-09-12 05:34:11,465 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29]

Average Accuracy (CNN): 87.99
Average Accuracy (NME): 89.22
2024-09-12 05:34:11,465 [trainer.py] => Average Accuracy (CNN): 87.99
2024-09-12 05:34:11,465 [trainer.py] => Average Accuracy (NME): 89.22
2024-09-12 05:34:11,466 [trainer.py] => All params: 85898626
2024-09-12 05:34:11,466 [trainer.py] => Trainable params: 85898626
2024-09-12 05:34:11,467 [icarl.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.908, Train_accy 87.57, Test_accy 84.83:   0%|          | 0/20 [00:41<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.908, Train_accy 87.57, Test_accy 84.83:   5%|▌         | 1/20 [00:41<13:08, 41.49s/it]
Task 4, Epoch 2/20 => Loss 1.561, Train_accy 92.22:   5%|▌         | 1/20 [01:17<13:08, 41.49s/it]                 
Task 4, Epoch 2/20 => Loss 1.561, Train_accy 92.22:  10%|█         | 2/20 [01:17<11:28, 38.27s/it]
Task 4, Epoch 3/20 => Loss 1.559, Train_accy 92.45:  10%|█         | 2/20 [01:53<11:28, 38.27s/it]
Task 4, Epoch 3/20 => Loss 1.559, Train_accy 92.45:  15%|█▌        | 3/20 [01:53<10:34, 37.34s/it]
Task 4, Epoch 4/20 => Loss 1.500, Train_accy 93.39:  15%|█▌        | 3/20 [02:29<10:34, 37.34s/it]
Task 4, Epoch 4/20 => Loss 1.500, Train_accy 93.39:  20%|██        | 4/20 [02:29<09:50, 36.88s/it]
Task 4, Epoch 5/20 => Loss 1.443, Train_accy 94.43:  20%|██        | 4/20 [03:06<09:50, 36.88s/it]
Task 4, Epoch 5/20 => Loss 1.443, Train_accy 94.43:  25%|██▌       | 5/20 [03:06<09:09, 36.66s/it]
Task 4, Epoch 6/20 => Loss 1.486, Train_accy 93.78, Test_accy 86.35:  25%|██▌       | 5/20 [03:48<09:09, 36.66s/it]
Task 4, Epoch 6/20 => Loss 1.486, Train_accy 93.78, Test_accy 86.35:  30%|███       | 6/20 [03:48<08:59, 38.50s/it]
Task 4, Epoch 7/20 => Loss 1.464, Train_accy 94.43:  30%|███       | 6/20 [04:24<08:59, 38.50s/it]                 
Task 4, Epoch 7/20 => Loss 1.464, Train_accy 94.43:  35%|███▌      | 7/20 [04:24<08:11, 37.80s/it]
Task 4, Epoch 8/20 => Loss 1.452, Train_accy 94.95:  35%|███▌      | 7/20 [05:00<08:11, 37.80s/it]
Task 4, Epoch 8/20 => Loss 1.452, Train_accy 94.95:  40%|████      | 8/20 [05:00<07:27, 37.31s/it]
Task 4, Epoch 9/20 => Loss 1.440, Train_accy 94.92:  40%|████      | 8/20 [05:37<07:27, 37.31s/it]
Task 4, Epoch 9/20 => Loss 1.440, Train_accy 94.92:  45%|████▌     | 9/20 [05:37<06:46, 36.97s/it]
Task 4, Epoch 10/20 => Loss 1.421, Train_accy 95.12:  45%|████▌     | 9/20 [06:13<06:46, 36.97s/it]
Task 4, Epoch 10/20 => Loss 1.421, Train_accy 95.12:  50%|█████     | 10/20 [06:13<06:07, 36.75s/it]
Task 4, Epoch 11/20 => Loss 1.402, Train_accy 94.95, Test_accy 87.87:  50%|█████     | 10/20 [06:55<06:07, 36.75s/it]
Task 4, Epoch 11/20 => Loss 1.402, Train_accy 94.95, Test_accy 87.87:  55%|█████▌    | 11/20 [06:55<05:45, 38.37s/it]
Task 4, Epoch 12/20 => Loss 1.434, Train_accy 94.53:  55%|█████▌    | 11/20 [07:31<05:45, 38.37s/it]                 
Task 4, Epoch 12/20 => Loss 1.434, Train_accy 94.53:  60%|██████    | 12/20 [07:31<05:02, 37.77s/it]
Task 4, Epoch 13/20 => Loss 1.465, Train_accy 94.76:  60%|██████    | 12/20 [08:08<05:02, 37.77s/it]
Task 4, Epoch 13/20 => Loss 1.465, Train_accy 94.76:  65%|██████▌   | 13/20 [08:08<04:21, 37.30s/it]
Task 4, Epoch 14/20 => Loss 1.489, Train_accy 94.53:  65%|██████▌   | 13/20 [08:44<04:21, 37.30s/it]
Task 4, Epoch 14/20 => Loss 1.489, Train_accy 94.53:  70%|███████   | 14/20 [08:44<03:41, 36.99s/it]
Task 4, Epoch 15/20 => Loss 1.411, Train_accy 95.57:  70%|███████   | 14/20 [09:20<03:41, 36.99s/it]
Task 4, Epoch 15/20 => Loss 1.411, Train_accy 95.57:  75%|███████▌  | 15/20 [09:20<03:03, 36.79s/it]
Task 4, Epoch 16/20 => Loss 1.457, Train_accy 94.79, Test_accy 86.65:  75%|███████▌  | 15/20 [10:02<03:03, 36.79s/it]
Task 4, Epoch 16/20 => Loss 1.457, Train_accy 94.79, Test_accy 86.65:  80%|████████  | 16/20 [10:02<02:33, 38.40s/it]
Task 4, Epoch 17/20 => Loss 1.426, Train_accy 95.31:  80%|████████  | 16/20 [10:39<02:33, 38.40s/it]                 
Task 4, Epoch 17/20 => Loss 1.426, Train_accy 95.31:  85%|████████▌ | 17/20 [10:39<01:53, 37.78s/it]
Task 4, Epoch 18/20 => Loss 1.367, Train_accy 96.42:  85%|████████▌ | 17/20 [11:15<01:53, 37.78s/it]
Task 4, Epoch 18/20 => Loss 1.367, Train_accy 96.42:  90%|█████████ | 18/20 [11:15<01:14, 37.31s/it]
Task 4, Epoch 19/20 => Loss 1.472, Train_accy 94.95:  90%|█████████ | 18/20 [11:51<01:14, 37.31s/it]
Task 4, Epoch 19/20 => Loss 1.472, Train_accy 94.95:  95%|█████████▌| 19/20 [11:51<00:37, 37.03s/it]
Task 4, Epoch 20/20 => Loss 1.393, Train_accy 95.83:  95%|█████████▌| 19/20 [12:27<00:37, 37.03s/it]
Task 4, Epoch 20/20 => Loss 1.393, Train_accy 95.83: 100%|██████████| 20/20 [12:27<00:00, 36.80s/it]
Task 4, Epoch 20/20 => Loss 1.393, Train_accy 95.83: 100%|██████████| 20/20 [12:27<00:00, 37.40s/it]
2024-09-12 05:46:39,438 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.393, Train_accy 95.83
2024-09-12 05:46:39,439 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 05:47:41,800 [icarl.py] => Exemplar size: 2800
2024-09-12 05:47:41,800 [trainer.py] => CNN: {'total': 86.41, '00-99': 85.1, '100-109': 88.7, '110-119': 92.04, '120-129': 83.18, '130-139': 94.92, 'old': 85.75, 'new': 94.92}
2024-09-12 05:47:41,800 [trainer.py] => NME: {'total': 87.51, '00-99': 87.21, '100-109': 91.3, '110-119': 84.07, '120-129': 85.05, '130-139': 92.37, 'old': 87.13, 'new': 92.37}
2024-09-12 05:47:41,800 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54, 86.41]
2024-09-12 05:47:41,800 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7, 97.75]
2024-09-12 05:47:41,800 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8, 87.51]
2024-09-12 05:47:41,800 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29, 98.29]

Average Accuracy (CNN): 87.67
Average Accuracy (NME): 88.88
2024-09-12 05:47:41,800 [trainer.py] => Average Accuracy (CNN): 87.67
2024-09-12 05:47:41,800 [trainer.py] => Average Accuracy (NME): 88.88
2024-09-12 05:47:41,801 [trainer.py] => All params: 85906316
2024-09-12 05:47:41,801 [trainer.py] => Trainable params: 85906316
2024-09-12 05:47:41,803 [icarl.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.785, Train_accy 89.21, Test_accy 84.72:   0%|          | 0/20 [00:44<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.785, Train_accy 89.21, Test_accy 84.72:   5%|▌         | 1/20 [00:44<13:57, 44.06s/it]
Task 5, Epoch 2/20 => Loss 1.515, Train_accy 93.30:   5%|▌         | 1/20 [01:22<13:57, 44.06s/it]                 
Task 5, Epoch 2/20 => Loss 1.515, Train_accy 93.30:  10%|█         | 2/20 [01:22<12:09, 40.54s/it]
Task 5, Epoch 3/20 => Loss 1.450, Train_accy 94.16:  10%|█         | 2/20 [02:00<12:09, 40.54s/it]
Task 5, Epoch 3/20 => Loss 1.450, Train_accy 94.16:  15%|█▌        | 3/20 [02:00<11:11, 39.50s/it]
Task 5, Epoch 4/20 => Loss 1.503, Train_accy 94.37:  15%|█▌        | 3/20 [02:38<11:11, 39.50s/it]
Task 5, Epoch 4/20 => Loss 1.503, Train_accy 94.37:  20%|██        | 4/20 [02:38<10:25, 39.06s/it]
Task 5, Epoch 5/20 => Loss 1.459, Train_accy 95.08:  20%|██        | 4/20 [03:17<10:25, 39.06s/it]
Task 5, Epoch 5/20 => Loss 1.459, Train_accy 95.08:  25%|██▌       | 5/20 [03:17<09:41, 38.79s/it]
Task 5, Epoch 6/20 => Loss 1.419, Train_accy 95.60, Test_accy 83.19:  25%|██▌       | 5/20 [04:01<09:41, 38.79s/it]
Task 5, Epoch 6/20 => Loss 1.419, Train_accy 95.60, Test_accy 83.19:  30%|███       | 6/20 [04:01<09:30, 40.75s/it]
Task 5, Epoch 7/20 => Loss 1.464, Train_accy 94.68:  30%|███       | 6/20 [04:40<09:30, 40.75s/it]                 
Task 5, Epoch 7/20 => Loss 1.464, Train_accy 94.68:  35%|███▌      | 7/20 [04:40<08:40, 40.01s/it]
Task 5, Epoch 8/20 => Loss 1.442, Train_accy 95.42:  35%|███▌      | 7/20 [05:18<08:40, 40.01s/it]
Task 5, Epoch 8/20 => Loss 1.442, Train_accy 95.42:  40%|████      | 8/20 [05:18<07:53, 39.48s/it]
Task 5, Epoch 9/20 => Loss 1.461, Train_accy 94.90:  40%|████      | 8/20 [05:56<07:53, 39.48s/it]
Task 5, Epoch 9/20 => Loss 1.461, Train_accy 94.90:  45%|████▌     | 9/20 [05:56<07:10, 39.13s/it]
Task 5, Epoch 10/20 => Loss 1.496, Train_accy 94.50:  45%|████▌     | 9/20 [06:35<07:10, 39.13s/it]
Task 5, Epoch 10/20 => Loss 1.496, Train_accy 94.50:  50%|█████     | 10/20 [06:35<06:29, 38.93s/it]
Task 5, Epoch 11/20 => Loss 1.402, Train_accy 95.66, Test_accy 85.12:  50%|█████     | 10/20 [07:20<06:29, 38.93s/it]
Task 5, Epoch 11/20 => Loss 1.402, Train_accy 95.66, Test_accy 85.12:  55%|█████▌    | 11/20 [07:20<06:06, 40.76s/it]
Task 5, Epoch 12/20 => Loss 1.466, Train_accy 95.30:  55%|█████▌    | 11/20 [07:58<06:06, 40.76s/it]                 
Task 5, Epoch 12/20 => Loss 1.466, Train_accy 95.30:  60%|██████    | 12/20 [07:58<05:21, 40.13s/it]
Task 5, Epoch 13/20 => Loss 1.406, Train_accy 95.82:  60%|██████    | 12/20 [08:37<05:21, 40.13s/it]
Task 5, Epoch 13/20 => Loss 1.406, Train_accy 95.82:  65%|██████▌   | 13/20 [08:37<04:37, 39.67s/it]
Task 5, Epoch 14/20 => Loss 1.442, Train_accy 95.73:  65%|██████▌   | 13/20 [09:16<04:37, 39.67s/it]
Task 5, Epoch 14/20 => Loss 1.442, Train_accy 95.73:  70%|███████   | 14/20 [09:16<03:55, 39.32s/it]
Task 5, Epoch 15/20 => Loss 1.400, Train_accy 96.06:  70%|███████   | 14/20 [09:54<03:55, 39.32s/it]
Task 5, Epoch 15/20 => Loss 1.400, Train_accy 96.06:  75%|███████▌  | 15/20 [09:54<03:15, 39.13s/it]
Task 5, Epoch 16/20 => Loss 1.483, Train_accy 95.05, Test_accy 85.74:  75%|███████▌  | 15/20 [10:39<03:15, 39.13s/it]
Task 5, Epoch 16/20 => Loss 1.483, Train_accy 95.05, Test_accy 85.74:  80%|████████  | 16/20 [10:39<02:43, 40.82s/it]
Task 5, Epoch 17/20 => Loss 1.451, Train_accy 95.33:  80%|████████  | 16/20 [11:18<02:43, 40.82s/it]                 
Task 5, Epoch 17/20 => Loss 1.451, Train_accy 95.33:  85%|████████▌ | 17/20 [11:18<02:00, 40.16s/it]
Task 5, Epoch 18/20 => Loss 1.444, Train_accy 95.85:  85%|████████▌ | 17/20 [11:56<02:00, 40.16s/it]
Task 5, Epoch 18/20 => Loss 1.444, Train_accy 95.85:  90%|█████████ | 18/20 [11:56<01:19, 39.65s/it]
Task 5, Epoch 19/20 => Loss 1.445, Train_accy 96.06:  90%|█████████ | 18/20 [12:35<01:19, 39.65s/it]
Task 5, Epoch 19/20 => Loss 1.445, Train_accy 96.06:  95%|█████████▌| 19/20 [12:35<00:39, 39.30s/it]
Task 5, Epoch 20/20 => Loss 1.487, Train_accy 95.20:  95%|█████████▌| 19/20 [13:13<00:39, 39.30s/it]
Task 5, Epoch 20/20 => Loss 1.487, Train_accy 95.20: 100%|██████████| 20/20 [13:13<00:00, 39.10s/it]
Task 5, Epoch 20/20 => Loss 1.487, Train_accy 95.20: 100%|██████████| 20/20 [13:13<00:00, 39.68s/it]
2024-09-12 06:00:55,500 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.487, Train_accy 95.20
2024-09-12 06:00:55,501 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 06:02:02,017 [icarl.py] => Exemplar size: 3000
2024-09-12 06:02:02,017 [trainer.py] => CNN: {'total': 85.29, '00-99': 83.25, '100-109': 86.96, '110-119': 84.07, '120-129': 84.11, '130-139': 94.92, '140-149': 96.03, 'old': 84.46, 'new': 96.03}
2024-09-12 06:02:02,017 [trainer.py] => NME: {'total': 86.87, '00-99': 86.11, '100-109': 90.43, '110-119': 83.19, '120-129': 86.92, '130-139': 90.68, '140-149': 90.48, 'old': 86.59, 'new': 90.48}
2024-09-12 06:02:02,018 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54, 86.41, 85.29]
2024-09-12 06:02:02,018 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7, 97.75, 97.45]
2024-09-12 06:02:02,018 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8, 87.51, 86.87]
2024-09-12 06:02:02,018 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29, 98.29, 98.42]

Average Accuracy (CNN): 87.27
Average Accuracy (NME): 88.54
2024-09-12 06:02:02,018 [trainer.py] => Average Accuracy (CNN): 87.27
2024-09-12 06:02:02,018 [trainer.py] => Average Accuracy (NME): 88.54
2024-09-12 06:02:02,018 [trainer.py] => All params: 85914006
2024-09-12 06:02:02,019 [trainer.py] => Trainable params: 85914006
2024-09-12 06:02:02,020 [icarl.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.836, Train_accy 89.36, Test_accy 83.24:   0%|          | 0/20 [00:46<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.836, Train_accy 89.36, Test_accy 83.24:   5%|▌         | 1/20 [00:46<14:52, 46.95s/it]
Task 6, Epoch 2/20 => Loss 1.530, Train_accy 94.00:   5%|▌         | 1/20 [01:27<14:52, 46.95s/it]                 
Task 6, Epoch 2/20 => Loss 1.530, Train_accy 94.00:  10%|█         | 2/20 [01:27<12:59, 43.29s/it]
Task 6, Epoch 3/20 => Loss 1.482, Train_accy 94.78:  10%|█         | 2/20 [02:08<12:59, 43.29s/it]
Task 6, Epoch 3/20 => Loss 1.482, Train_accy 94.78:  15%|█▌        | 3/20 [02:08<11:56, 42.13s/it]
Task 6, Epoch 4/20 => Loss 1.476, Train_accy 95.16:  15%|█▌        | 3/20 [02:49<11:56, 42.13s/it]
Task 6, Epoch 4/20 => Loss 1.476, Train_accy 95.16:  20%|██        | 4/20 [02:49<11:06, 41.63s/it]
Task 6, Epoch 5/20 => Loss 1.454, Train_accy 94.95:  20%|██        | 4/20 [03:30<11:06, 41.63s/it]
Task 6, Epoch 5/20 => Loss 1.454, Train_accy 94.95:  25%|██▌       | 5/20 [03:30<10:20, 41.34s/it]
Task 6, Epoch 6/20 => Loss 1.482, Train_accy 94.64, Test_accy 83.61:  25%|██▌       | 5/20 [04:17<10:20, 41.34s/it]
Task 6, Epoch 6/20 => Loss 1.482, Train_accy 94.64, Test_accy 83.61:  30%|███       | 6/20 [04:17<10:08, 43.43s/it]
Task 6, Epoch 7/20 => Loss 1.485, Train_accy 95.67:  30%|███       | 6/20 [04:58<10:08, 43.43s/it]                 
Task 6, Epoch 7/20 => Loss 1.485, Train_accy 95.67:  35%|███▌      | 7/20 [04:58<09:14, 42.63s/it]
Task 6, Epoch 8/20 => Loss 1.510, Train_accy 95.30:  35%|███▌      | 7/20 [05:39<09:14, 42.63s/it]
Task 6, Epoch 8/20 => Loss 1.510, Train_accy 95.30:  40%|████      | 8/20 [05:39<08:24, 42.08s/it]
Task 6, Epoch 9/20 => Loss 1.462, Train_accy 95.36:  40%|████      | 8/20 [06:20<08:24, 42.08s/it]
Task 6, Epoch 9/20 => Loss 1.462, Train_accy 95.36:  45%|████▌     | 9/20 [06:20<07:38, 41.73s/it]
Task 6, Epoch 10/20 => Loss 1.469, Train_accy 95.47:  45%|████▌     | 9/20 [07:01<07:38, 41.73s/it]
Task 6, Epoch 10/20 => Loss 1.469, Train_accy 95.47:  50%|█████     | 10/20 [07:01<06:54, 41.49s/it]
Task 6, Epoch 11/20 => Loss 1.475, Train_accy 95.73, Test_accy 84.19:  50%|█████     | 10/20 [07:48<06:54, 41.49s/it]
Task 6, Epoch 11/20 => Loss 1.475, Train_accy 95.73, Test_accy 84.19:  55%|█████▌    | 11/20 [07:48<06:30, 43.35s/it]
Task 6, Epoch 12/20 => Loss 1.436, Train_accy 95.82:  55%|█████▌    | 11/20 [08:29<06:30, 43.35s/it]                 
Task 6, Epoch 12/20 => Loss 1.436, Train_accy 95.82:  60%|██████    | 12/20 [08:29<05:41, 42.63s/it]
Task 6, Epoch 13/20 => Loss 1.479, Train_accy 95.93:  60%|██████    | 12/20 [09:10<05:41, 42.63s/it]
Task 6, Epoch 13/20 => Loss 1.479, Train_accy 95.93:  65%|██████▌   | 13/20 [09:10<04:54, 42.10s/it]
Task 6, Epoch 14/20 => Loss 1.443, Train_accy 95.99:  65%|██████▌   | 13/20 [09:51<04:54, 42.10s/it]
Task 6, Epoch 14/20 => Loss 1.443, Train_accy 95.99:  70%|███████   | 14/20 [09:51<04:10, 41.79s/it]
Task 6, Epoch 15/20 => Loss 1.404, Train_accy 96.48:  70%|███████   | 14/20 [10:32<04:10, 41.79s/it]
Task 6, Epoch 15/20 => Loss 1.404, Train_accy 96.48:  75%|███████▌  | 15/20 [10:32<03:27, 41.54s/it]
Task 6, Epoch 16/20 => Loss 1.491, Train_accy 95.36, Test_accy 84.66:  75%|███████▌  | 15/20 [11:20<03:27, 41.54s/it]
Task 6, Epoch 16/20 => Loss 1.491, Train_accy 95.36, Test_accy 84.66:  80%|████████  | 16/20 [11:20<02:53, 43.36s/it]
Task 6, Epoch 17/20 => Loss 1.432, Train_accy 96.19:  80%|████████  | 16/20 [12:01<02:53, 43.36s/it]                 
Task 6, Epoch 17/20 => Loss 1.432, Train_accy 96.19:  85%|████████▌ | 17/20 [12:01<02:07, 42.62s/it]
Task 6, Epoch 18/20 => Loss 1.532, Train_accy 95.27:  85%|████████▌ | 17/20 [12:42<02:07, 42.62s/it]
Task 6, Epoch 18/20 => Loss 1.532, Train_accy 95.27:  90%|█████████ | 18/20 [12:42<01:24, 42.15s/it]
Task 6, Epoch 19/20 => Loss 1.483, Train_accy 95.36:  90%|█████████ | 18/20 [13:23<01:24, 42.15s/it]
Task 6, Epoch 19/20 => Loss 1.483, Train_accy 95.36:  95%|█████████▌| 19/20 [13:23<00:41, 41.79s/it]
Task 6, Epoch 20/20 => Loss 1.436, Train_accy 96.31:  95%|█████████▌| 19/20 [14:04<00:41, 41.79s/it]
Task 6, Epoch 20/20 => Loss 1.436, Train_accy 96.31: 100%|██████████| 20/20 [14:04<00:00, 41.58s/it]
Task 6, Epoch 20/20 => Loss 1.436, Train_accy 96.31: 100%|██████████| 20/20 [14:04<00:00, 42.22s/it]
2024-09-12 06:16:06,473 [icarl.py] => Task 6, Epoch 20/20 => Loss 1.436, Train_accy 96.31
2024-09-12 06:16:06,474 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 06:17:16,810 [icarl.py] => Exemplar size: 3200
2024-09-12 06:17:16,810 [trainer.py] => CNN: {'total': 85.19, '00-99': 82.07, '100-109': 90.43, '110-119': 84.96, '120-129': 83.18, '130-139': 88.98, '140-149': 95.24, '150-159': 98.39, 'old': 84.27, 'new': 98.39}
2024-09-12 06:17:16,811 [trainer.py] => NME: {'total': 87.31, '00-99': 86.11, '100-109': 88.7, '110-119': 82.3, '120-129': 84.11, '130-139': 91.53, '140-149': 90.48, '150-159': 97.58, 'old': 86.59, 'new': 97.58}
2024-09-12 06:17:16,811 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54, 86.41, 85.29, 85.19]
2024-09-12 06:17:16,811 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7, 97.75, 97.45, 97.57]
2024-09-12 06:17:16,811 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8, 87.51, 86.87, 87.31]
2024-09-12 06:17:16,811 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29, 98.29, 98.42, 98.15]

Average Accuracy (CNN): 86.98
Average Accuracy (NME): 88.37
2024-09-12 06:17:16,811 [trainer.py] => Average Accuracy (CNN): 86.98
2024-09-12 06:17:16,811 [trainer.py] => Average Accuracy (NME): 88.37
2024-09-12 06:17:16,811 [trainer.py] => All params: 85921696
2024-09-12 06:17:16,812 [trainer.py] => Trainable params: 85921696
2024-09-12 06:17:16,813 [icarl.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.808, Train_accy 90.97, Test_accy 82.32:   0%|          | 0/20 [00:49<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.808, Train_accy 90.97, Test_accy 82.32:   5%|▌         | 1/20 [00:49<15:46, 49.80s/it]
Task 7, Epoch 2/20 => Loss 1.533, Train_accy 94.16:   5%|▌         | 1/20 [01:32<15:46, 49.80s/it]                 
Task 7, Epoch 2/20 => Loss 1.533, Train_accy 94.16:  10%|█         | 2/20 [01:32<13:44, 45.81s/it]
Task 7, Epoch 3/20 => Loss 1.534, Train_accy 94.73:  10%|█         | 2/20 [02:15<13:44, 45.81s/it]
Task 7, Epoch 3/20 => Loss 1.534, Train_accy 94.73:  15%|█▌        | 3/20 [02:15<12:37, 44.57s/it]
Task 7, Epoch 4/20 => Loss 1.513, Train_accy 95.22:  15%|█▌        | 3/20 [02:59<12:37, 44.57s/it]
Task 7, Epoch 4/20 => Loss 1.513, Train_accy 95.22:  20%|██        | 4/20 [02:59<11:43, 44.00s/it]
Task 7, Epoch 5/20 => Loss 1.554, Train_accy 94.76:  20%|██        | 4/20 [03:42<11:43, 44.00s/it]
Task 7, Epoch 5/20 => Loss 1.554, Train_accy 94.76:  25%|██▌       | 5/20 [03:42<10:55, 43.69s/it]
Task 7, Epoch 6/20 => Loss 1.443, Train_accy 96.53, Test_accy 83.31:  25%|██▌       | 5/20 [04:32<10:55, 43.69s/it]
Task 7, Epoch 6/20 => Loss 1.443, Train_accy 96.53, Test_accy 83.31:  30%|███       | 6/20 [04:32<10:42, 45.93s/it]
Task 7, Epoch 7/20 => Loss 1.507, Train_accy 95.74:  30%|███       | 6/20 [05:15<10:42, 45.93s/it]                 
Task 7, Epoch 7/20 => Loss 1.507, Train_accy 95.74:  35%|███▌      | 7/20 [05:15<09:45, 45.06s/it]
Task 7, Epoch 8/20 => Loss 1.464, Train_accy 96.12:  35%|███▌      | 7/20 [05:58<09:45, 45.06s/it]
Task 7, Epoch 8/20 => Loss 1.464, Train_accy 96.12:  40%|████      | 8/20 [05:58<08:53, 44.45s/it]
Task 7, Epoch 9/20 => Loss 1.483, Train_accy 96.02:  40%|████      | 8/20 [06:42<08:53, 44.45s/it]
Task 7, Epoch 9/20 => Loss 1.483, Train_accy 96.02:  45%|████▌     | 9/20 [06:42<08:05, 44.13s/it]
Task 7, Epoch 10/20 => Loss 1.466, Train_accy 96.40:  45%|████▌     | 9/20 [07:25<08:05, 44.13s/it]
Task 7, Epoch 10/20 => Loss 1.466, Train_accy 96.40:  50%|█████     | 10/20 [07:25<07:18, 43.86s/it]
Task 7, Epoch 11/20 => Loss 1.505, Train_accy 96.07, Test_accy 84.05:  50%|█████     | 10/20 [08:15<07:18, 43.86s/it]
Task 7, Epoch 11/20 => Loss 1.505, Train_accy 96.07, Test_accy 84.05:  55%|█████▌    | 11/20 [08:15<06:52, 45.81s/it]
Task 7, Epoch 12/20 => Loss 1.495, Train_accy 96.29:  55%|█████▌    | 11/20 [08:59<06:52, 45.81s/it]                 
Task 7, Epoch 12/20 => Loss 1.495, Train_accy 96.29:  60%|██████    | 12/20 [08:59<06:00, 45.02s/it]
Task 7, Epoch 13/20 => Loss 1.439, Train_accy 96.78:  60%|██████    | 12/20 [09:42<06:00, 45.02s/it]
Task 7, Epoch 13/20 => Loss 1.439, Train_accy 96.78:  65%|██████▌   | 13/20 [09:42<05:11, 44.45s/it]
Task 7, Epoch 14/20 => Loss 1.508, Train_accy 96.12:  65%|██████▌   | 13/20 [10:25<05:11, 44.45s/it]
Task 7, Epoch 14/20 => Loss 1.508, Train_accy 96.12:  70%|███████   | 14/20 [10:25<04:24, 44.13s/it]
Task 7, Epoch 15/20 => Loss 1.495, Train_accy 95.82:  70%|███████   | 14/20 [11:08<04:24, 44.13s/it]
Task 7, Epoch 15/20 => Loss 1.495, Train_accy 95.82:  75%|███████▌  | 15/20 [11:08<03:39, 43.92s/it]
Task 7, Epoch 16/20 => Loss 1.449, Train_accy 96.23, Test_accy 84.25:  75%|███████▌  | 15/20 [11:59<03:39, 43.92s/it]
Task 7, Epoch 16/20 => Loss 1.449, Train_accy 96.23, Test_accy 84.25:  80%|████████  | 16/20 [11:59<03:03, 45.80s/it]
Task 7, Epoch 17/20 => Loss 1.458, Train_accy 96.40:  80%|████████  | 16/20 [12:42<03:03, 45.80s/it]                 
Task 7, Epoch 17/20 => Loss 1.458, Train_accy 96.40:  85%|████████▌ | 17/20 [12:42<02:15, 45.04s/it]
Task 7, Epoch 18/20 => Loss 1.500, Train_accy 96.23:  85%|████████▌ | 17/20 [13:25<02:15, 45.04s/it]
Task 7, Epoch 18/20 => Loss 1.500, Train_accy 96.23:  90%|█████████ | 18/20 [13:25<01:28, 44.49s/it]
Task 7, Epoch 19/20 => Loss 1.466, Train_accy 96.45:  90%|█████████ | 18/20 [14:08<01:28, 44.49s/it]
Task 7, Epoch 19/20 => Loss 1.466, Train_accy 96.45:  95%|█████████▌| 19/20 [14:08<00:44, 44.09s/it]
Task 7, Epoch 20/20 => Loss 1.541, Train_accy 95.99:  95%|█████████▌| 19/20 [14:51<00:44, 44.09s/it]
Task 7, Epoch 20/20 => Loss 1.541, Train_accy 95.99: 100%|██████████| 20/20 [14:51<00:00, 43.81s/it]
Task 7, Epoch 20/20 => Loss 1.541, Train_accy 95.99: 100%|██████████| 20/20 [14:51<00:00, 44.60s/it]
2024-09-12 06:32:08,772 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.541, Train_accy 95.99
2024-09-12 06:32:08,773 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 06:33:22,920 [icarl.py] => Exemplar size: 3400
2024-09-12 06:33:22,920 [trainer.py] => CNN: {'total': 84.35, '00-99': 80.98, '100-109': 89.57, '110-119': 83.19, '120-129': 86.92, '130-139': 86.44, '140-149': 85.71, '150-159': 96.77, '160-169': 94.03, 'old': 83.66, 'new': 94.03}
2024-09-12 06:33:22,920 [trainer.py] => NME: {'total': 87.31, '00-99': 86.2, '100-109': 90.43, '110-119': 83.19, '120-129': 85.05, '130-139': 88.98, '140-149': 85.71, '150-159': 96.77, '160-169': 91.04, 'old': 87.04, 'new': 91.04}
2024-09-12 06:33:22,921 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54, 86.41, 85.29, 85.19, 84.35]
2024-09-12 06:33:22,921 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7, 97.75, 97.45, 97.57, 97.19]
2024-09-12 06:33:22,921 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8, 87.51, 86.87, 87.31, 87.31]
2024-09-12 06:33:22,921 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29, 98.29, 98.42, 98.15, 98.07]

Average Accuracy (CNN): 86.65
Average Accuracy (NME): 88.23
2024-09-12 06:33:22,921 [trainer.py] => Average Accuracy (CNN): 86.65
2024-09-12 06:33:22,921 [trainer.py] => Average Accuracy (NME): 88.23
2024-09-12 06:33:22,921 [trainer.py] => All params: 85929386
2024-09-12 06:33:22,922 [trainer.py] => Trainable params: 85929386
2024-09-12 06:33:22,923 [icarl.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.839, Train_accy 90.93, Test_accy 81.11:   0%|          | 0/20 [00:52<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.839, Train_accy 90.93, Test_accy 81.11:   5%|▌         | 1/20 [00:52<16:40, 52.65s/it]
Task 8, Epoch 2/20 => Loss 1.534, Train_accy 94.66:   5%|▌         | 1/20 [01:38<16:40, 52.65s/it]                 
Task 8, Epoch 2/20 => Loss 1.534, Train_accy 94.66:  10%|█         | 2/20 [01:38<14:34, 48.59s/it]
Task 8, Epoch 3/20 => Loss 1.551, Train_accy 94.71:  10%|█         | 2/20 [02:24<14:34, 48.59s/it]
Task 8, Epoch 3/20 => Loss 1.551, Train_accy 94.71:  15%|█▌        | 3/20 [02:24<13:24, 47.30s/it]
Task 8, Epoch 4/20 => Loss 1.503, Train_accy 95.56:  15%|█▌        | 3/20 [03:10<13:24, 47.30s/it]
Task 8, Epoch 4/20 => Loss 1.503, Train_accy 95.56:  20%|██        | 4/20 [03:10<12:28, 46.76s/it]
Task 8, Epoch 5/20 => Loss 1.479, Train_accy 96.10:  20%|██        | 4/20 [03:55<12:28, 46.76s/it]
Task 8, Epoch 5/20 => Loss 1.479, Train_accy 96.10:  25%|██▌       | 5/20 [03:55<11:36, 46.45s/it]
Task 8, Epoch 6/20 => Loss 1.503, Train_accy 95.81, Test_accy 82.89:  25%|██▌       | 5/20 [04:49<11:36, 46.45s/it]
Task 8, Epoch 6/20 => Loss 1.503, Train_accy 95.81, Test_accy 82.89:  30%|███       | 6/20 [04:49<11:22, 48.78s/it]
Task 8, Epoch 7/20 => Loss 1.526, Train_accy 95.30:  30%|███       | 6/20 [05:35<11:22, 48.78s/it]                 
Task 8, Epoch 7/20 => Loss 1.526, Train_accy 95.30:  35%|███▌      | 7/20 [05:35<10:21, 47.83s/it]
Task 8, Epoch 8/20 => Loss 1.513, Train_accy 95.97:  35%|███▌      | 7/20 [06:21<10:21, 47.83s/it]
Task 8, Epoch 8/20 => Loss 1.513, Train_accy 95.97:  40%|████      | 8/20 [06:21<09:26, 47.22s/it]
Task 8, Epoch 9/20 => Loss 1.479, Train_accy 95.81:  40%|████      | 8/20 [07:07<09:26, 47.22s/it]
Task 8, Epoch 9/20 => Loss 1.479, Train_accy 95.81:  45%|████▌     | 9/20 [07:07<08:34, 46.81s/it]
Task 8, Epoch 10/20 => Loss 1.527, Train_accy 95.99:  45%|████▌     | 9/20 [07:52<08:34, 46.81s/it]
Task 8, Epoch 10/20 => Loss 1.527, Train_accy 95.99:  50%|█████     | 10/20 [07:52<07:45, 46.55s/it]
Task 8, Epoch 11/20 => Loss 1.511, Train_accy 96.05, Test_accy 83.22:  50%|█████     | 10/20 [08:46<07:45, 46.55s/it]
Task 8, Epoch 11/20 => Loss 1.511, Train_accy 96.05, Test_accy 83.22:  55%|█████▌    | 11/20 [08:46<07:17, 48.59s/it]
Task 8, Epoch 12/20 => Loss 1.498, Train_accy 96.02:  55%|█████▌    | 11/20 [09:32<07:17, 48.59s/it]                 
Task 8, Epoch 12/20 => Loss 1.498, Train_accy 96.02:  60%|██████    | 12/20 [09:32<06:22, 47.76s/it]
Task 8, Epoch 13/20 => Loss 1.494, Train_accy 96.15:  60%|██████    | 12/20 [10:17<06:22, 47.76s/it]
Task 8, Epoch 13/20 => Loss 1.494, Train_accy 96.15:  65%|██████▌   | 13/20 [10:17<05:30, 47.19s/it]
Task 8, Epoch 14/20 => Loss 1.435, Train_accy 96.76:  65%|██████▌   | 13/20 [11:03<05:30, 47.19s/it]
Task 8, Epoch 14/20 => Loss 1.435, Train_accy 96.76:  70%|███████   | 14/20 [11:03<04:40, 46.81s/it]
Task 8, Epoch 15/20 => Loss 1.526, Train_accy 96.48:  70%|███████   | 14/20 [11:49<04:40, 46.81s/it]
Task 8, Epoch 15/20 => Loss 1.526, Train_accy 96.48:  75%|███████▌  | 15/20 [11:49<03:52, 46.55s/it]
Task 8, Epoch 16/20 => Loss 1.463, Train_accy 96.38, Test_accy 83.51:  75%|███████▌  | 15/20 [12:43<03:52, 46.55s/it]
Task 8, Epoch 16/20 => Loss 1.463, Train_accy 96.38, Test_accy 83.51:  80%|████████  | 16/20 [12:43<03:14, 48.61s/it]
Task 8, Epoch 17/20 => Loss 1.505, Train_accy 96.76:  80%|████████  | 16/20 [13:29<03:14, 48.61s/it]                 
Task 8, Epoch 17/20 => Loss 1.505, Train_accy 96.76:  85%|████████▌ | 17/20 [13:29<02:23, 47.80s/it]
Task 8, Epoch 18/20 => Loss 1.496, Train_accy 96.33:  85%|████████▌ | 17/20 [14:15<02:23, 47.80s/it]
Task 8, Epoch 18/20 => Loss 1.496, Train_accy 96.33:  90%|█████████ | 18/20 [14:15<01:34, 47.26s/it]
Task 8, Epoch 19/20 => Loss 1.509, Train_accy 96.53:  90%|█████████ | 18/20 [15:01<01:34, 47.26s/it]
Task 8, Epoch 19/20 => Loss 1.509, Train_accy 96.53:  95%|█████████▌| 19/20 [15:01<00:46, 46.87s/it]
Task 8, Epoch 20/20 => Loss 1.487, Train_accy 96.48:  95%|█████████▌| 19/20 [15:47<00:46, 46.87s/it]
Task 8, Epoch 20/20 => Loss 1.487, Train_accy 96.48: 100%|██████████| 20/20 [15:47<00:00, 46.61s/it]
Task 8, Epoch 20/20 => Loss 1.487, Train_accy 96.48: 100%|██████████| 20/20 [15:47<00:00, 47.35s/it]
2024-09-12 06:49:10,014 [icarl.py] => Task 8, Epoch 20/20 => Loss 1.487, Train_accy 96.48
2024-09-12 06:49:10,015 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 06:50:29,054 [icarl.py] => Exemplar size: 3600
2024-09-12 06:50:29,054 [trainer.py] => CNN: {'total': 83.46, '00-99': 80.56, '100-109': 86.09, '110-119': 79.65, '120-129': 78.5, '130-139': 88.14, '140-149': 82.54, '150-159': 91.13, '160-169': 93.28, '170-179': 97.09, 'old': 82.77, 'new': 97.09}
2024-09-12 06:50:29,054 [trainer.py] => NME: {'total': 86.23, '00-99': 85.19, '100-109': 88.7, '110-119': 80.53, '120-129': 79.44, '130-139': 90.68, '140-149': 84.92, '150-159': 93.55, '160-169': 89.55, '170-179': 92.23, 'old': 85.93, 'new': 92.23}
2024-09-12 06:50:29,054 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54, 86.41, 85.29, 85.19, 84.35, 83.46]
2024-09-12 06:50:29,054 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7, 97.75, 97.45, 97.57, 97.19, 96.95]
2024-09-12 06:50:29,054 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8, 87.51, 86.87, 87.31, 87.31, 86.23]
2024-09-12 06:50:29,054 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29, 98.29, 98.42, 98.15, 98.07, 98.21]

Average Accuracy (CNN): 86.29
Average Accuracy (NME): 88.01
2024-09-12 06:50:29,054 [trainer.py] => Average Accuracy (CNN): 86.29
2024-09-12 06:50:29,054 [trainer.py] => Average Accuracy (NME): 88.01
2024-09-12 06:50:29,055 [trainer.py] => All params: 85937076
2024-09-12 06:50:29,055 [trainer.py] => Trainable params: 85937076
2024-09-12 06:50:29,057 [icarl.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.838, Train_accy 90.63, Test_accy 80.27:   0%|          | 0/20 [00:54<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.838, Train_accy 90.63, Test_accy 80.27:   5%|▌         | 1/20 [00:54<17:21, 54.82s/it]
Task 9, Epoch 2/20 => Loss 1.543, Train_accy 94.55:   5%|▌         | 1/20 [01:42<17:21, 54.82s/it]                 
Task 9, Epoch 2/20 => Loss 1.543, Train_accy 94.55:  10%|█         | 2/20 [01:42<15:09, 50.54s/it]
Task 9, Epoch 3/20 => Loss 1.518, Train_accy 95.31:  10%|█         | 2/20 [02:30<15:09, 50.54s/it]
Task 9, Epoch 3/20 => Loss 1.518, Train_accy 95.31:  15%|█▌        | 3/20 [02:30<13:56, 49.22s/it]
Task 9, Epoch 4/20 => Loss 1.502, Train_accy 95.83:  15%|█▌        | 3/20 [03:17<13:56, 49.22s/it]
Task 9, Epoch 4/20 => Loss 1.502, Train_accy 95.83:  20%|██        | 4/20 [03:17<12:58, 48.63s/it]
Task 9, Epoch 5/20 => Loss 1.482, Train_accy 95.93:  20%|██        | 4/20 [04:05<12:58, 48.63s/it]
Task 9, Epoch 5/20 => Loss 1.482, Train_accy 95.93:  25%|██▌       | 5/20 [04:05<12:04, 48.30s/it]
Task 9, Epoch 6/20 => Loss 1.515, Train_accy 95.68, Test_accy 80.97:  25%|██▌       | 5/20 [05:01<12:04, 48.30s/it]
Task 9, Epoch 6/20 => Loss 1.515, Train_accy 95.68, Test_accy 80.97:  30%|███       | 6/20 [05:01<11:50, 50.78s/it]
Task 9, Epoch 7/20 => Loss 1.449, Train_accy 96.35:  30%|███       | 6/20 [05:48<11:50, 50.78s/it]                 
Task 9, Epoch 7/20 => Loss 1.449, Train_accy 96.35:  35%|███▌      | 7/20 [05:48<10:47, 49.80s/it]
Task 9, Epoch 8/20 => Loss 1.493, Train_accy 96.13:  35%|███▌      | 7/20 [06:36<10:47, 49.80s/it]
Task 9, Epoch 8/20 => Loss 1.493, Train_accy 96.13:  40%|████      | 8/20 [06:36<09:50, 49.19s/it]
Task 9, Epoch 9/20 => Loss 1.530, Train_accy 95.59:  40%|████      | 8/20 [07:24<09:50, 49.19s/it]
Task 9, Epoch 9/20 => Loss 1.530, Train_accy 95.59:  45%|████▌     | 9/20 [07:24<08:56, 48.76s/it]
Task 9, Epoch 10/20 => Loss 1.449, Train_accy 96.82:  45%|████▌     | 9/20 [08:12<08:56, 48.76s/it]
Task 9, Epoch 10/20 => Loss 1.449, Train_accy 96.82:  50%|█████     | 10/20 [08:12<08:05, 48.52s/it]
Task 9, Epoch 11/20 => Loss 1.493, Train_accy 96.25, Test_accy 81.64:  50%|█████     | 10/20 [09:08<08:05, 48.52s/it]
Task 9, Epoch 11/20 => Loss 1.493, Train_accy 96.25, Test_accy 81.64:  55%|█████▌    | 11/20 [09:08<07:36, 50.72s/it]
Task 9, Epoch 12/20 => Loss 1.490, Train_accy 96.50:  55%|█████▌    | 11/20 [09:56<07:36, 50.72s/it]                 
Task 9, Epoch 12/20 => Loss 1.490, Train_accy 96.50:  60%|██████    | 12/20 [09:56<06:38, 49.85s/it]
Task 9, Epoch 13/20 => Loss 1.474, Train_accy 96.47:  60%|██████    | 12/20 [10:43<06:38, 49.85s/it]
Task 9, Epoch 13/20 => Loss 1.474, Train_accy 96.47:  65%|██████▌   | 13/20 [10:43<05:44, 49.26s/it]
Task 9, Epoch 14/20 => Loss 1.483, Train_accy 96.33:  65%|██████▌   | 13/20 [11:32<05:44, 49.26s/it]
Task 9, Epoch 14/20 => Loss 1.483, Train_accy 96.33:  70%|███████   | 14/20 [11:32<04:54, 49.05s/it]
Task 9, Epoch 15/20 => Loss 1.458, Train_accy 96.92:  70%|███████   | 14/20 [12:21<04:54, 49.05s/it]
Task 9, Epoch 15/20 => Loss 1.458, Train_accy 96.92:  75%|███████▌  | 15/20 [12:21<04:04, 48.93s/it]
Task 9, Epoch 16/20 => Loss 1.465, Train_accy 96.55, Test_accy 83.45:  75%|███████▌  | 15/20 [13:17<04:04, 48.93s/it]
Task 9, Epoch 16/20 => Loss 1.465, Train_accy 96.55, Test_accy 83.45:  80%|████████  | 16/20 [13:17<03:24, 51.11s/it]
Task 9, Epoch 17/20 => Loss 1.511, Train_accy 96.57:  80%|████████  | 16/20 [14:05<03:24, 51.11s/it]                 
Task 9, Epoch 17/20 => Loss 1.511, Train_accy 96.57:  85%|████████▌ | 17/20 [14:05<02:30, 50.16s/it]
Task 9, Epoch 18/20 => Loss 1.467, Train_accy 96.82:  85%|████████▌ | 17/20 [14:53<02:30, 50.16s/it]
Task 9, Epoch 18/20 => Loss 1.467, Train_accy 96.82:  90%|█████████ | 18/20 [14:53<01:38, 49.49s/it]
Task 9, Epoch 19/20 => Loss 1.488, Train_accy 96.30:  90%|█████████ | 18/20 [15:41<01:38, 49.49s/it]
Task 9, Epoch 19/20 => Loss 1.488, Train_accy 96.30:  95%|█████████▌| 19/20 [15:41<00:49, 49.05s/it]
Task 9, Epoch 20/20 => Loss 1.509, Train_accy 96.13:  95%|█████████▌| 19/20 [16:29<00:49, 49.05s/it]
Task 9, Epoch 20/20 => Loss 1.509, Train_accy 96.13: 100%|██████████| 20/20 [16:29<00:00, 48.71s/it]
Task 9, Epoch 20/20 => Loss 1.509, Train_accy 96.13: 100%|██████████| 20/20 [16:29<00:00, 49.46s/it]
2024-09-12 07:06:58,245 [icarl.py] => Task 9, Epoch 20/20 => Loss 1.509, Train_accy 96.13
2024-09-12 07:06:58,246 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 07:08:22,032 [icarl.py] => Exemplar size: 3800
2024-09-12 07:08:22,033 [trainer.py] => CNN: {'total': 82.52, '00-99': 79.8, '100-109': 86.09, '110-119': 80.53, '120-129': 72.9, '130-139': 80.51, '140-149': 80.16, '150-159': 91.13, '160-169': 90.3, '170-179': 95.15, '180-189': 91.67, 'old': 81.95, 'new': 91.67}
2024-09-12 07:08:22,033 [trainer.py] => NME: {'total': 85.27, '00-99': 84.34, '100-109': 88.7, '110-119': 79.65, '120-129': 78.5, '130-139': 87.29, '140-149': 83.33, '150-159': 94.35, '160-169': 89.55, '170-179': 90.29, '180-189': 84.09, 'old': 85.34, 'new': 84.09}
2024-09-12 07:08:22,033 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54, 86.41, 85.29, 85.19, 84.35, 83.46, 82.52]
2024-09-12 07:08:22,033 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7, 97.75, 97.45, 97.57, 97.19, 96.95, 96.42]
2024-09-12 07:08:22,033 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8, 87.51, 86.87, 87.31, 87.31, 86.23, 85.27]
2024-09-12 07:08:22,033 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29, 98.29, 98.42, 98.15, 98.07, 98.21, 98.14]

Average Accuracy (CNN): 85.92
Average Accuracy (NME): 87.74
2024-09-12 07:08:22,033 [trainer.py] => Average Accuracy (CNN): 85.92
2024-09-12 07:08:22,033 [trainer.py] => Average Accuracy (NME): 87.74
2024-09-12 07:08:22,033 [trainer.py] => All params: 85944766
2024-09-12 07:08:22,034 [trainer.py] => Trainable params: 85944766
2024-09-12 07:08:22,035 [icarl.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.827, Train_accy 92.09, Test_accy 78.20:   0%|          | 0/20 [00:58<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.827, Train_accy 92.09, Test_accy 78.20:   5%|▌         | 1/20 [00:58<18:24, 58.11s/it]
Task 10, Epoch 2/20 => Loss 1.578, Train_accy 95.21:   5%|▌         | 1/20 [01:48<18:24, 58.11s/it]                 
Task 10, Epoch 2/20 => Loss 1.578, Train_accy 95.21:  10%|█         | 2/20 [01:48<16:03, 53.54s/it]
Task 10, Epoch 3/20 => Loss 1.593, Train_accy 95.37:  10%|█         | 2/20 [02:39<16:03, 53.54s/it]
Task 10, Epoch 3/20 => Loss 1.593, Train_accy 95.37:  15%|█▌        | 3/20 [02:39<14:47, 52.21s/it]
Task 10, Epoch 4/20 => Loss 1.627, Train_accy 95.72:  15%|█▌        | 3/20 [03:29<14:47, 52.21s/it]
Task 10, Epoch 4/20 => Loss 1.627, Train_accy 95.72:  20%|██        | 4/20 [03:29<13:44, 51.56s/it]
Task 10, Epoch 5/20 => Loss 1.584, Train_accy 95.81:  20%|██        | 4/20 [04:20<13:44, 51.56s/it]
Task 10, Epoch 5/20 => Loss 1.584, Train_accy 95.81:  25%|██▌       | 5/20 [04:20<12:48, 51.23s/it]
Task 10, Epoch 6/20 => Loss 1.548, Train_accy 96.51, Test_accy 80.87:  25%|██▌       | 5/20 [05:17<12:48, 51.23s/it]
Task 10, Epoch 6/20 => Loss 1.548, Train_accy 96.51, Test_accy 80.87:  30%|███       | 6/20 [05:17<12:23, 53.11s/it]
Task 10, Epoch 7/20 => Loss 1.536, Train_accy 96.35:  30%|███       | 6/20 [06:01<12:23, 53.11s/it]                 
Task 10, Epoch 7/20 => Loss 1.536, Train_accy 96.35:  35%|███▌      | 7/20 [06:01<10:53, 50.27s/it]
Task 10, Epoch 8/20 => Loss 1.570, Train_accy 96.25:  35%|███▌      | 7/20 [06:49<10:53, 50.27s/it]
Task 10, Epoch 8/20 => Loss 1.570, Train_accy 96.25:  40%|████      | 8/20 [06:50<09:56, 49.72s/it]
Task 10, Epoch 9/20 => Loss 1.526, Train_accy 96.51:  40%|████      | 8/20 [07:40<09:56, 49.72s/it]
Task 10, Epoch 9/20 => Loss 1.526, Train_accy 96.51:  45%|████▌     | 9/20 [07:40<09:09, 50.00s/it]
Task 10, Epoch 10/20 => Loss 1.527, Train_accy 96.53:  45%|████▌     | 9/20 [08:31<09:09, 50.00s/it]
Task 10, Epoch 10/20 => Loss 1.527, Train_accy 96.53:  50%|█████     | 10/20 [08:31<08:22, 50.23s/it]
Task 10, Epoch 11/20 => Loss 1.500, Train_accy 97.09, Test_accy 80.92:  50%|█████     | 10/20 [09:30<08:22, 50.23s/it]
Task 10, Epoch 11/20 => Loss 1.500, Train_accy 97.09, Test_accy 80.92:  55%|█████▌    | 11/20 [09:30<07:55, 52.86s/it]
Task 10, Epoch 12/20 => Loss 1.551, Train_accy 96.67:  55%|█████▌    | 11/20 [10:20<07:55, 52.86s/it]                 
Task 10, Epoch 12/20 => Loss 1.551, Train_accy 96.67:  60%|██████    | 12/20 [10:20<06:57, 52.23s/it]
Task 10, Epoch 13/20 => Loss 1.530, Train_accy 96.84:  60%|██████    | 12/20 [11:11<06:57, 52.23s/it]
Task 10, Epoch 13/20 => Loss 1.530, Train_accy 96.84:  65%|██████▌   | 13/20 [11:11<06:02, 51.77s/it]
Task 10, Epoch 14/20 => Loss 1.539, Train_accy 96.49:  65%|██████▌   | 13/20 [12:02<06:02, 51.77s/it]
Task 10, Epoch 14/20 => Loss 1.539, Train_accy 96.49:  70%|███████   | 14/20 [12:02<05:08, 51.40s/it]
Task 10, Epoch 15/20 => Loss 1.535, Train_accy 96.79:  70%|███████   | 14/20 [12:52<05:08, 51.40s/it]
Task 10, Epoch 15/20 => Loss 1.535, Train_accy 96.79:  75%|███████▌  | 15/20 [12:52<04:15, 51.16s/it]
Task 10, Epoch 16/20 => Loss 1.522, Train_accy 97.14, Test_accy 80.58:  75%|███████▌  | 15/20 [13:51<04:15, 51.16s/it]
Task 10, Epoch 16/20 => Loss 1.522, Train_accy 97.14, Test_accy 80.58:  80%|████████  | 16/20 [13:51<03:33, 53.46s/it]
Task 10, Epoch 17/20 => Loss 1.496, Train_accy 97.00:  80%|████████  | 16/20 [14:42<03:33, 53.46s/it]                 
Task 10, Epoch 17/20 => Loss 1.496, Train_accy 97.00:  85%|████████▌ | 17/20 [14:42<02:37, 52.61s/it]
Task 10, Epoch 18/20 => Loss 1.510, Train_accy 97.02:  85%|████████▌ | 17/20 [15:33<02:37, 52.61s/it]
Task 10, Epoch 18/20 => Loss 1.510, Train_accy 97.02:  90%|█████████ | 18/20 [15:33<01:44, 52.05s/it]
Task 10, Epoch 19/20 => Loss 1.549, Train_accy 97.09:  90%|█████████ | 18/20 [16:23<01:44, 52.05s/it]
Task 10, Epoch 19/20 => Loss 1.549, Train_accy 97.09:  95%|█████████▌| 19/20 [16:23<00:51, 51.62s/it]
Task 10, Epoch 20/20 => Loss 1.502, Train_accy 97.09:  95%|█████████▌| 19/20 [17:14<00:51, 51.62s/it]
Task 10, Epoch 20/20 => Loss 1.502, Train_accy 97.09: 100%|██████████| 20/20 [17:14<00:00, 51.33s/it]
Task 10, Epoch 20/20 => Loss 1.502, Train_accy 97.09: 100%|██████████| 20/20 [17:14<00:00, 51.71s/it]
2024-09-12 07:25:36,338 [icarl.py] => Task 10, Epoch 20/20 => Loss 1.502, Train_accy 97.09
2024-09-12 07:25:36,339 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 07:27:02,757 [icarl.py] => Exemplar size: 4000
2024-09-12 07:27:02,757 [trainer.py] => CNN: {'total': 81.04, '00-99': 76.6, '100-109': 85.22, '110-119': 83.19, '120-129': 71.03, '130-139': 82.2, '140-149': 76.98, '150-159': 89.52, '160-169': 90.3, '170-179': 95.15, '180-189': 90.91, '190-199': 90.82, 'old': 80.62, 'new': 90.82}
2024-09-12 07:27:02,757 [trainer.py] => NME: {'total': 85.5, '00-99': 84.26, '100-109': 87.83, '110-119': 82.3, '120-129': 79.44, '130-139': 87.29, '140-149': 83.33, '150-159': 95.97, '160-169': 89.55, '170-179': 89.32, '180-189': 85.61, '190-199': 85.71, 'old': 85.49, 'new': 85.71}
2024-09-12 07:27:02,757 [trainer.py] => CNN top1 curve: [88.47, 89.64, 87.29, 86.54, 86.41, 85.29, 85.19, 84.35, 83.46, 82.52, 81.04]
2024-09-12 07:27:02,757 [trainer.py] => CNN top5 curve: [98.15, 98.54, 97.88, 97.7, 97.75, 97.45, 97.57, 97.19, 96.95, 96.42, 95.63]
2024-09-12 07:27:02,758 [trainer.py] => NME top1 curve: [90.4, 90.56, 89.12, 86.8, 87.51, 86.87, 87.31, 87.31, 86.23, 85.27, 85.5]
2024-09-12 07:27:02,758 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.87, 98.29, 98.29, 98.42, 98.15, 98.07, 98.21, 98.14, 97.5]

Average Accuracy (CNN): 85.47
Average Accuracy (NME): 87.53
2024-09-12 07:27:02,758 [trainer.py] => Average Accuracy (CNN): 85.47
2024-09-12 07:27:02,758 [trainer.py] => Average Accuracy (NME): 87.53
Accuracy Matrix (CNN):
[[88.47 89.31 86.2  85.61 85.1  83.25 82.07 80.98 80.56 79.8  76.6 ]
 [ 0.   93.04 93.91 91.3  88.7  86.96 90.43 89.57 86.09 86.09 85.22]
 [ 0.    0.   92.04 91.15 92.04 84.07 84.96 83.19 79.65 80.53 83.19]
 [ 0.    0.    0.   86.92 83.18 84.11 83.18 86.92 78.5  72.9  71.03]
 [ 0.    0.    0.    0.   94.92 94.92 88.98 86.44 88.14 80.51 82.2 ]
 [ 0.    0.    0.    0.    0.   96.03 95.24 85.71 82.54 80.16 76.98]
 [ 0.    0.    0.    0.    0.    0.   98.39 96.77 91.13 91.13 89.52]
 [ 0.    0.    0.    0.    0.    0.    0.   94.03 93.28 90.3  90.3 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   97.09 95.15 95.15]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   91.67 90.91]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   90.82]]
2024-09-12 07:27:02,759 [trainer.py] => Forgetting (CNN): 9.321000000000002
Accuracy Matrix (NME):
[[90.4  90.4  89.31 87.12 87.21 86.11 86.11 86.2  85.19 84.34 84.26]
 [ 0.   92.17 93.04 90.43 91.3  90.43 88.7  90.43 88.7  88.7  87.83]
 [ 0.    0.   83.19 80.53 84.07 83.19 82.3  83.19 80.53 79.65 82.3 ]
 [ 0.    0.    0.   85.98 85.05 86.92 84.11 85.05 79.44 78.5  79.44]
 [ 0.    0.    0.    0.   92.37 90.68 91.53 88.98 90.68 87.29 87.29]
 [ 0.    0.    0.    0.    0.   90.48 90.48 85.71 84.92 83.33 83.33]
 [ 0.    0.    0.    0.    0.    0.   97.58 96.77 93.55 94.35 95.97]
 [ 0.    0.    0.    0.    0.    0.    0.   91.04 89.55 89.55 89.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   92.23 90.29 89.32]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   84.09 85.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   85.71]]
2024-09-12 07:27:02,759 [trainer.py] => Forgetting (NME): 3.884000000000003
2024-09-12 07:27:05,792 [trainer.py] => config: ./exps/der_cub_B0_Inc5.json
2024-09-12 07:27:05,808 [trainer.py] => prefix: reproduce
2024-09-12 07:27:05,808 [trainer.py] => dataset: cub
2024-09-12 07:27:05,808 [trainer.py] => memory_size: 4000
2024-09-12 07:27:05,808 [trainer.py] => memory_per_class: 20
2024-09-12 07:27:05,808 [trainer.py] => fixed_memory: True
2024-09-12 07:27:05,809 [trainer.py] => shuffle: True
2024-09-12 07:27:05,809 [trainer.py] => init_cls: 40
2024-09-12 07:27:05,809 [trainer.py] => increment: 40
2024-09-12 07:27:05,809 [trainer.py] => model_name: der
2024-09-12 07:27:05,809 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 07:27:05,809 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-12 07:27:05,809 [trainer.py] => seed: 1993
2024-09-12 07:27:05,809 [trainer.py] => init_epoch: 20
2024-09-12 07:27:05,809 [trainer.py] => init_lr: 0.001
2024-09-12 07:27:05,809 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 07:27:05,809 [trainer.py] => init_lr_decay: 0.1
2024-09-12 07:27:05,809 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 07:27:05,809 [trainer.py] => epochs: 20
2024-09-12 07:27:05,809 [trainer.py] => lrate: 0.001
2024-09-12 07:27:05,810 [trainer.py] => milestones: [80, 120, 150]
2024-09-12 07:27:05,810 [trainer.py] => lrate_decay: 0.1
2024-09-12 07:27:05,810 [trainer.py] => batch_size: 48
2024-09-12 07:27:05,810 [trainer.py] => weight_decay: 0.0002
2024-09-12 07:27:05,810 [trainer.py] => T: 2
2024-09-12 07:27:05,868 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 07:27:06,243 [trainer.py] => All params: 0
2024-09-12 07:27:06,244 [trainer.py] => Trainable params: 0
2024-09-12 07:27:07,911 [der.py] => Learning on 0-40
2024-09-12 07:27:07,912 [der.py] => All params: 85860945
2024-09-12 07:27:07,913 [der.py] => Trainable params: 85860945

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.412, Train_accy 37.70, Test_accy 73.57:   0%|          | 0/20 [00:18<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.412, Train_accy 37.70, Test_accy 73.57:   5%|▌         | 1/20 [00:18<05:54, 18.65s/it]
Task 0, Epoch 2/20 => Loss 0.732, Train_accy 78.64:   5%|▌         | 1/20 [00:35<05:54, 18.65s/it]                 
Task 0, Epoch 2/20 => Loss 0.732, Train_accy 78.64:  10%|█         | 2/20 [00:35<05:13, 17.40s/it]
Task 0, Epoch 3/20 => Loss 0.502, Train_accy 85.03:  10%|█         | 2/20 [00:51<05:13, 17.40s/it]
Task 0, Epoch 3/20 => Loss 0.502, Train_accy 85.03:  15%|█▌        | 3/20 [00:51<04:49, 17.02s/it]
Task 0, Epoch 4/20 => Loss 0.408, Train_accy 88.52:  15%|█▌        | 3/20 [01:08<04:49, 17.02s/it]
Task 0, Epoch 4/20 => Loss 0.408, Train_accy 88.52:  20%|██        | 4/20 [01:08<04:29, 16.86s/it]
Task 0, Epoch 5/20 => Loss 0.364, Train_accy 89.11:  20%|██        | 4/20 [01:25<04:29, 16.86s/it]
Task 0, Epoch 5/20 => Loss 0.364, Train_accy 89.11:  25%|██▌       | 5/20 [01:25<04:11, 16.78s/it]
Task 0, Epoch 6/20 => Loss 0.334, Train_accy 90.01, Test_accy 94.49:  25%|██▌       | 5/20 [01:43<04:11, 16.78s/it]
Task 0, Epoch 6/20 => Loss 0.334, Train_accy 90.01, Test_accy 94.49:  30%|███       | 6/20 [01:43<04:03, 17.42s/it]
Task 0, Epoch 7/20 => Loss 0.342, Train_accy 89.74:  30%|███       | 6/20 [02:00<04:03, 17.42s/it]                 
Task 0, Epoch 7/20 => Loss 0.342, Train_accy 89.74:  35%|███▌      | 7/20 [02:00<03:43, 17.17s/it]
Task 0, Epoch 8/20 => Loss 0.319, Train_accy 91.01:  35%|███▌      | 7/20 [02:17<03:43, 17.17s/it]
Task 0, Epoch 8/20 => Loss 0.319, Train_accy 91.01:  40%|████      | 8/20 [02:17<03:24, 17.04s/it]
Task 0, Epoch 9/20 => Loss 0.273, Train_accy 92.07:  40%|████      | 8/20 [02:33<03:24, 17.04s/it]
Task 0, Epoch 9/20 => Loss 0.273, Train_accy 92.07:  45%|████▌     | 9/20 [02:33<03:06, 16.96s/it]
Task 0, Epoch 10/20 => Loss 0.290, Train_accy 91.12:  45%|████▌     | 9/20 [02:50<03:06, 16.96s/it]
Task 0, Epoch 10/20 => Loss 0.290, Train_accy 91.12:  50%|█████     | 10/20 [02:50<02:48, 16.89s/it]
Task 0, Epoch 11/20 => Loss 0.251, Train_accy 92.54, Test_accy 95.37:  50%|█████     | 10/20 [03:09<02:48, 16.89s/it]
Task 0, Epoch 11/20 => Loss 0.251, Train_accy 92.54, Test_accy 95.37:  55%|█████▌    | 11/20 [03:09<02:37, 17.47s/it]
Task 0, Epoch 12/20 => Loss 0.262, Train_accy 92.60:  55%|█████▌    | 11/20 [03:26<02:37, 17.47s/it]                 
Task 0, Epoch 12/20 => Loss 0.262, Train_accy 92.60:  60%|██████    | 12/20 [03:26<02:18, 17.26s/it]
Task 0, Epoch 13/20 => Loss 0.252, Train_accy 92.49:  60%|██████    | 12/20 [03:42<02:18, 17.26s/it]
Task 0, Epoch 13/20 => Loss 0.252, Train_accy 92.49:  65%|██████▌   | 13/20 [03:42<01:59, 17.09s/it]
Task 0, Epoch 14/20 => Loss 0.277, Train_accy 92.54:  65%|██████▌   | 13/20 [03:59<01:59, 17.09s/it]
Task 0, Epoch 14/20 => Loss 0.277, Train_accy 92.54:  70%|███████   | 14/20 [03:59<01:41, 16.98s/it]
Task 0, Epoch 15/20 => Loss 0.249, Train_accy 92.33:  70%|███████   | 14/20 [04:16<01:41, 16.98s/it]
Task 0, Epoch 15/20 => Loss 0.249, Train_accy 92.33:  75%|███████▌  | 15/20 [04:16<01:24, 16.91s/it]
Task 0, Epoch 16/20 => Loss 0.255, Train_accy 91.91, Test_accy 96.26:  75%|███████▌  | 15/20 [04:34<01:24, 16.91s/it]
Task 0, Epoch 16/20 => Loss 0.255, Train_accy 91.91, Test_accy 96.26:  80%|████████  | 16/20 [04:34<01:09, 17.43s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 93.13:  80%|████████  | 16/20 [04:51<01:09, 17.43s/it]                 
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 93.13:  85%|████████▌ | 17/20 [04:51<00:51, 17.22s/it]
Task 0, Epoch 18/20 => Loss 0.213, Train_accy 93.50:  85%|████████▌ | 17/20 [05:08<00:51, 17.22s/it]
Task 0, Epoch 18/20 => Loss 0.213, Train_accy 93.50:  90%|█████████ | 18/20 [05:08<00:34, 17.06s/it]
Task 0, Epoch 19/20 => Loss 0.244, Train_accy 92.97:  90%|█████████ | 18/20 [05:25<00:34, 17.06s/it]
Task 0, Epoch 19/20 => Loss 0.244, Train_accy 92.97:  95%|█████████▌| 19/20 [05:25<00:16, 16.98s/it]
Task 0, Epoch 20/20 => Loss 0.242, Train_accy 93.50:  95%|█████████▌| 19/20 [05:42<00:16, 16.98s/it]
Task 0, Epoch 20/20 => Loss 0.242, Train_accy 93.50: 100%|██████████| 20/20 [05:42<00:00, 16.93s/it]
Task 0, Epoch 20/20 => Loss 0.242, Train_accy 93.50: 100%|██████████| 20/20 [05:42<00:00, 17.10s/it]
2024-09-12 07:32:50,450 [der.py] => Task 0, Epoch 20/20 => Loss 0.242, Train_accy 93.50
2024-09-12 07:32:50,451 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 07:33:29,614 [der.py] => Exemplar size: 800
2024-09-12 07:33:29,615 [trainer.py] => CNN: {'total': 96.26, '00-39': 96.26, 'old': 0, 'new': 96.26}
2024-09-12 07:33:29,615 [trainer.py] => NME: {'total': 96.92, '00-39': 96.92, 'old': 0, 'new': 96.92}
2024-09-12 07:33:29,615 [trainer.py] => CNN top1 curve: [96.26]
2024-09-12 07:33:29,615 [trainer.py] => CNN top5 curve: [99.56]
2024-09-12 07:33:29,615 [trainer.py] => NME top1 curve: [96.92]
2024-09-12 07:33:29,615 [trainer.py] => NME top5 curve: [99.78]

Average Accuracy (CNN): 96.26
Average Accuracy (NME): 96.92
2024-09-12 07:33:29,615 [trainer.py] => Average Accuracy (CNN): 96.26
2024-09-12 07:33:29,615 [trainer.py] => Average Accuracy (NME): 96.92
2024-09-12 07:33:29,616 [trainer.py] => All params: 85860945
2024-09-12 07:33:29,617 [trainer.py] => Trainable params: 85860945
2024-09-12 07:33:31,464 [der.py] => Learning on 40-80
2024-09-12 07:33:31,466 [der.py] => All params: 171751801
2024-09-12 07:33:31,467 [der.py] => Trainable params: 85953145

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.153, Loss_clf 2.224, Loss_aux 1.929, Train_accy 56.30, Test_accy 84.22:   0%|          | 0/20 [00:37<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.153, Loss_clf 2.224, Loss_aux 1.929, Train_accy 56.30, Test_accy 84.22:   5%|▌         | 1/20 [00:37<11:56, 37.74s/it]
Task 1, Epoch 2/20 => Loss 1.404, Loss_clf 0.661, Loss_aux 0.744, Train_accy 80.59:   5%|▌         | 1/20 [01:09<11:56, 37.74s/it]                 
Task 1, Epoch 2/20 => Loss 1.404, Loss_clf 0.661, Loss_aux 0.744, Train_accy 80.59:  10%|█         | 2/20 [01:09<10:15, 34.22s/it]
Task 1, Epoch 3/20 => Loss 1.134, Loss_clf 0.526, Loss_aux 0.608, Train_accy 84.34:  10%|█         | 2/20 [01:41<10:15, 34.22s/it]
Task 1, Epoch 3/20 => Loss 1.134, Loss_clf 0.526, Loss_aux 0.608, Train_accy 84.34:  15%|█▌        | 3/20 [01:41<09:22, 33.11s/it]
Task 1, Epoch 4/20 => Loss 1.376, Loss_clf 0.528, Loss_aux 0.848, Train_accy 85.38:  15%|█▌        | 3/20 [02:13<09:22, 33.11s/it]
Task 1, Epoch 4/20 => Loss 1.376, Loss_clf 0.528, Loss_aux 0.848, Train_accy 85.38:  20%|██        | 4/20 [02:13<08:41, 32.59s/it]
Task 1, Epoch 5/20 => Loss 0.874, Loss_clf 0.418, Loss_aux 0.456, Train_accy 88.25:  20%|██        | 4/20 [02:44<08:41, 32.59s/it]
Task 1, Epoch 5/20 => Loss 0.874, Loss_clf 0.418, Loss_aux 0.456, Train_accy 88.25:  25%|██▌       | 5/20 [02:44<08:05, 32.34s/it]
Task 1, Epoch 6/20 => Loss 0.849, Loss_clf 0.407, Loss_aux 0.442, Train_accy 87.91, Test_accy 88.47:  25%|██▌       | 5/20 [03:23<08:05, 32.34s/it]
Task 1, Epoch 6/20 => Loss 0.849, Loss_clf 0.407, Loss_aux 0.442, Train_accy 87.91, Test_accy 88.47:  30%|███       | 6/20 [03:23<08:00, 34.30s/it]
Task 1, Epoch 7/20 => Loss 0.751, Loss_clf 0.374, Loss_aux 0.376, Train_accy 89.51:  30%|███       | 6/20 [03:54<08:00, 34.30s/it]                 
Task 1, Epoch 7/20 => Loss 0.751, Loss_clf 0.374, Loss_aux 0.376, Train_accy 89.51:  35%|███▌      | 7/20 [03:54<07:15, 33.50s/it]
Task 1, Epoch 8/20 => Loss 0.747, Loss_clf 0.360, Loss_aux 0.387, Train_accy 89.74:  35%|███▌      | 7/20 [04:26<07:15, 33.50s/it]
Task 1, Epoch 8/20 => Loss 0.747, Loss_clf 0.360, Loss_aux 0.387, Train_accy 89.74:  40%|████      | 8/20 [04:26<06:35, 32.98s/it]
Task 1, Epoch 9/20 => Loss 0.671, Loss_clf 0.328, Loss_aux 0.344, Train_accy 90.96:  40%|████      | 8/20 [04:58<06:35, 32.98s/it]
Task 1, Epoch 9/20 => Loss 0.671, Loss_clf 0.328, Loss_aux 0.344, Train_accy 90.96:  45%|████▌     | 9/20 [04:58<05:59, 32.64s/it]
Task 1, Epoch 10/20 => Loss 0.825, Loss_clf 0.415, Loss_aux 0.410, Train_accy 90.15:  45%|████▌     | 9/20 [05:30<05:59, 32.64s/it]
Task 1, Epoch 10/20 => Loss 0.825, Loss_clf 0.415, Loss_aux 0.410, Train_accy 90.15:  50%|█████     | 10/20 [05:30<05:23, 32.39s/it]
Task 1, Epoch 11/20 => Loss 1.057, Loss_clf 0.472, Loss_aux 0.584, Train_accy 86.87, Test_accy 89.23:  50%|█████     | 10/20 [06:08<05:23, 32.39s/it]
Task 1, Epoch 11/20 => Loss 1.057, Loss_clf 0.472, Loss_aux 0.584, Train_accy 86.87, Test_accy 89.23:  55%|█████▌    | 11/20 [06:08<05:07, 34.20s/it]
Task 1, Epoch 12/20 => Loss 0.678, Loss_clf 0.322, Loss_aux 0.356, Train_accy 90.93:  55%|█████▌    | 11/20 [06:40<05:07, 34.20s/it]                 
Task 1, Epoch 12/20 => Loss 0.678, Loss_clf 0.322, Loss_aux 0.356, Train_accy 90.93:  60%|██████    | 12/20 [06:40<04:27, 33.49s/it]
Task 1, Epoch 13/20 => Loss 0.659, Loss_clf 0.327, Loss_aux 0.332, Train_accy 90.89:  60%|██████    | 12/20 [07:12<04:27, 33.49s/it]
Task 1, Epoch 13/20 => Loss 0.659, Loss_clf 0.327, Loss_aux 0.332, Train_accy 90.89:  65%|██████▌   | 13/20 [07:12<03:50, 33.00s/it]
Task 1, Epoch 14/20 => Loss 0.668, Loss_clf 0.323, Loss_aux 0.345, Train_accy 91.26:  65%|██████▌   | 13/20 [07:44<03:50, 33.00s/it]
Task 1, Epoch 14/20 => Loss 0.668, Loss_clf 0.323, Loss_aux 0.345, Train_accy 91.26:  70%|███████   | 14/20 [07:44<03:15, 32.64s/it]
Task 1, Epoch 15/20 => Loss 0.662, Loss_clf 0.336, Loss_aux 0.326, Train_accy 90.26:  70%|███████   | 14/20 [08:16<03:15, 32.64s/it]
Task 1, Epoch 15/20 => Loss 0.662, Loss_clf 0.336, Loss_aux 0.326, Train_accy 90.26:  75%|███████▌  | 15/20 [08:16<02:42, 32.41s/it]
Task 1, Epoch 16/20 => Loss 0.549, Loss_clf 0.276, Loss_aux 0.273, Train_accy 91.97, Test_accy 90.10:  75%|███████▌  | 15/20 [08:54<02:42, 32.41s/it]
Task 1, Epoch 16/20 => Loss 0.549, Loss_clf 0.276, Loss_aux 0.273, Train_accy 91.97, Test_accy 90.10:  80%|████████  | 16/20 [08:54<02:16, 34.13s/it]
Task 1, Epoch 17/20 => Loss 0.554, Loss_clf 0.276, Loss_aux 0.277, Train_accy 91.67:  80%|████████  | 16/20 [09:26<02:16, 34.13s/it]                 
Task 1, Epoch 17/20 => Loss 0.554, Loss_clf 0.276, Loss_aux 0.277, Train_accy 91.67:  85%|████████▌ | 17/20 [09:26<01:40, 33.45s/it]
Task 1, Epoch 18/20 => Loss 0.620, Loss_clf 0.313, Loss_aux 0.307, Train_accy 91.00:  85%|████████▌ | 17/20 [09:58<01:40, 33.45s/it]
Task 1, Epoch 18/20 => Loss 0.620, Loss_clf 0.313, Loss_aux 0.307, Train_accy 91.00:  90%|█████████ | 18/20 [09:58<01:05, 32.98s/it]
Task 1, Epoch 19/20 => Loss 0.583, Loss_clf 0.297, Loss_aux 0.286, Train_accy 91.48:  90%|█████████ | 18/20 [10:30<01:05, 32.98s/it]
Task 1, Epoch 19/20 => Loss 0.583, Loss_clf 0.297, Loss_aux 0.286, Train_accy 91.48:  95%|█████████▌| 19/20 [10:30<00:32, 32.68s/it]
Task 1, Epoch 20/20 => Loss 0.580, Loss_clf 0.296, Loss_aux 0.284, Train_accy 91.74:  95%|█████████▌| 19/20 [11:01<00:32, 32.68s/it]
Task 1, Epoch 20/20 => Loss 0.580, Loss_clf 0.296, Loss_aux 0.284, Train_accy 91.74: 100%|██████████| 20/20 [11:01<00:00, 32.43s/it]
Task 1, Epoch 20/20 => Loss 0.580, Loss_clf 0.296, Loss_aux 0.284, Train_accy 91.74: 100%|██████████| 20/20 [11:01<00:00, 33.10s/it]
2024-09-12 07:44:33,479 [der.py] => Task 1, Epoch 20/20 => Loss 0.580, Loss_clf 0.296, Loss_aux 0.284, Train_accy 91.74
2024-09-12 07:44:33,480 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 07:45:48,198 [der.py] => Exemplar size: 1600
2024-09-12 07:45:48,198 [trainer.py] => CNN: {'total': 91.19, '00-39': 89.43, '40-79': 92.9, 'old': 89.43, 'new': 92.9}
2024-09-12 07:45:48,198 [trainer.py] => NME: {'total': 90.86, '00-39': 90.97, '40-79': 90.75, 'old': 90.97, 'new': 90.75}
2024-09-12 07:45:48,198 [trainer.py] => CNN top1 curve: [96.26, 91.19]
2024-09-12 07:45:48,198 [trainer.py] => CNN top5 curve: [99.56, 98.59]
2024-09-12 07:45:48,198 [trainer.py] => NME top1 curve: [96.92, 90.86]
2024-09-12 07:45:48,199 [trainer.py] => NME top5 curve: [99.78, 99.13]

Average Accuracy (CNN): 93.72
Average Accuracy (NME): 93.89
2024-09-12 07:45:48,199 [trainer.py] => Average Accuracy (CNN): 93.72
2024-09-12 07:45:48,199 [trainer.py] => Average Accuracy (NME): 93.89
2024-09-12 07:45:48,200 [trainer.py] => All params: 171751801
2024-09-12 07:45:48,201 [trainer.py] => Trainable params: 85953145
2024-09-12 07:45:49,843 [der.py] => Learning on 80-120
2024-09-12 07:45:49,846 [der.py] => All params: 257704097
2024-09-12 07:45:49,848 [der.py] => Trainable params: 86106785

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.718, Loss_clf 1.982, Loss_aux 1.736, Train_accy 65.18, Test_accy 83.83:   0%|          | 0/20 [01:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.718, Loss_clf 1.982, Loss_aux 1.736, Train_accy 65.18, Test_accy 83.83:   5%|▌         | 1/20 [01:04<20:27, 64.59s/it]
Task 2, Epoch 2/20 => Loss 1.203, Loss_clf 0.612, Loss_aux 0.591, Train_accy 82.78:   5%|▌         | 1/20 [01:55<20:27, 64.59s/it]                 
Task 2, Epoch 2/20 => Loss 1.203, Loss_clf 0.612, Loss_aux 0.591, Train_accy 82.78:  10%|█         | 2/20 [01:55<17:02, 56.83s/it]
Task 2, Epoch 3/20 => Loss 1.010, Loss_clf 0.536, Loss_aux 0.475, Train_accy 85.52:  10%|█         | 2/20 [02:47<17:02, 56.83s/it]
Task 2, Epoch 3/20 => Loss 1.010, Loss_clf 0.536, Loss_aux 0.475, Train_accy 85.52:  15%|█▌        | 3/20 [02:47<15:23, 54.32s/it]
Task 2, Epoch 4/20 => Loss 0.940, Loss_clf 0.505, Loss_aux 0.435, Train_accy 85.17:  15%|█▌        | 3/20 [03:38<15:23, 54.32s/it]
Task 2, Epoch 4/20 => Loss 0.940, Loss_clf 0.505, Loss_aux 0.435, Train_accy 85.17:  20%|██        | 4/20 [03:38<14:10, 53.16s/it]
Task 2, Epoch 5/20 => Loss 0.848, Loss_clf 0.461, Loss_aux 0.387, Train_accy 86.81:  20%|██        | 4/20 [04:30<14:10, 53.16s/it]
Task 2, Epoch 5/20 => Loss 0.848, Loss_clf 0.461, Loss_aux 0.387, Train_accy 86.81:  25%|██▌       | 5/20 [04:30<13:08, 52.54s/it]
Task 2, Epoch 6/20 => Loss 0.742, Loss_clf 0.410, Loss_aux 0.331, Train_accy 88.81, Test_accy 87.78:  25%|██▌       | 5/20 [05:35<13:08, 52.54s/it]
Task 2, Epoch 6/20 => Loss 0.742, Loss_clf 0.410, Loss_aux 0.331, Train_accy 88.81, Test_accy 87.78:  30%|███       | 6/20 [05:35<13:15, 56.82s/it]
Task 2, Epoch 7/20 => Loss 0.721, Loss_clf 0.392, Loss_aux 0.329, Train_accy 89.47:  30%|███       | 6/20 [06:26<13:15, 56.82s/it]                 
Task 2, Epoch 7/20 => Loss 0.721, Loss_clf 0.392, Loss_aux 0.329, Train_accy 89.47:  35%|███▌      | 7/20 [06:26<11:56, 55.08s/it]
Task 2, Epoch 8/20 => Loss 0.707, Loss_clf 0.385, Loss_aux 0.322, Train_accy 89.50:  35%|███▌      | 7/20 [07:18<11:56, 55.08s/it]
Task 2, Epoch 8/20 => Loss 0.707, Loss_clf 0.385, Loss_aux 0.322, Train_accy 89.50:  40%|████      | 8/20 [07:18<10:46, 53.91s/it]
Task 2, Epoch 9/20 => Loss 0.666, Loss_clf 0.365, Loss_aux 0.301, Train_accy 89.87:  40%|████      | 8/20 [08:09<10:46, 53.91s/it]
Task 2, Epoch 9/20 => Loss 0.666, Loss_clf 0.365, Loss_aux 0.301, Train_accy 89.87:  45%|████▌     | 9/20 [08:09<09:44, 53.17s/it]
Task 2, Epoch 10/20 => Loss 0.627, Loss_clf 0.335, Loss_aux 0.292, Train_accy 90.83:  45%|████▌     | 9/20 [09:01<09:44, 53.17s/it]
Task 2, Epoch 10/20 => Loss 0.627, Loss_clf 0.335, Loss_aux 0.292, Train_accy 90.83:  50%|█████     | 10/20 [09:01<08:46, 52.64s/it]
Task 2, Epoch 11/20 => Loss 0.638, Loss_clf 0.358, Loss_aux 0.280, Train_accy 90.08, Test_accy 87.92:  50%|█████     | 10/20 [10:06<08:46, 52.64s/it]
Task 2, Epoch 11/20 => Loss 0.638, Loss_clf 0.358, Loss_aux 0.280, Train_accy 90.08, Test_accy 87.92:  55%|█████▌    | 11/20 [10:06<08:28, 56.49s/it]
Task 2, Epoch 12/20 => Loss 0.620, Loss_clf 0.337, Loss_aux 0.283, Train_accy 90.85:  55%|█████▌    | 11/20 [10:57<08:28, 56.49s/it]                 
Task 2, Epoch 12/20 => Loss 0.620, Loss_clf 0.337, Loss_aux 0.283, Train_accy 90.85:  60%|██████    | 12/20 [10:57<07:19, 54.95s/it]
Task 2, Epoch 13/20 => Loss 0.553, Loss_clf 0.315, Loss_aux 0.238, Train_accy 91.95:  60%|██████    | 12/20 [11:49<07:19, 54.95s/it]
Task 2, Epoch 13/20 => Loss 0.553, Loss_clf 0.315, Loss_aux 0.238, Train_accy 91.95:  65%|██████▌   | 13/20 [11:49<06:17, 53.95s/it]
Task 2, Epoch 14/20 => Loss 0.589, Loss_clf 0.338, Loss_aux 0.251, Train_accy 90.88:  65%|██████▌   | 13/20 [12:40<06:17, 53.95s/it]
Task 2, Epoch 14/20 => Loss 0.589, Loss_clf 0.338, Loss_aux 0.251, Train_accy 90.88:  70%|███████   | 14/20 [12:40<05:19, 53.20s/it]
Task 2, Epoch 15/20 => Loss 0.530, Loss_clf 0.299, Loss_aux 0.231, Train_accy 91.69:  70%|███████   | 14/20 [13:32<05:19, 53.20s/it]
Task 2, Epoch 15/20 => Loss 0.530, Loss_clf 0.299, Loss_aux 0.231, Train_accy 91.69:  75%|███████▌  | 15/20 [13:32<04:23, 52.66s/it]
Task 2, Epoch 16/20 => Loss 0.550, Loss_clf 0.314, Loss_aux 0.236, Train_accy 91.14, Test_accy 88.06:  75%|███████▌  | 15/20 [14:37<04:23, 52.66s/it]
Task 2, Epoch 16/20 => Loss 0.550, Loss_clf 0.314, Loss_aux 0.236, Train_accy 91.14, Test_accy 88.06:  80%|████████  | 16/20 [14:37<03:45, 56.42s/it]
Task 2, Epoch 17/20 => Loss 0.541, Loss_clf 0.301, Loss_aux 0.240, Train_accy 91.72:  80%|████████  | 16/20 [15:28<03:45, 56.42s/it]                 
Task 2, Epoch 17/20 => Loss 0.541, Loss_clf 0.301, Loss_aux 0.240, Train_accy 91.72:  85%|████████▌ | 17/20 [15:28<02:44, 54.92s/it]
Task 2, Epoch 18/20 => Loss 0.557, Loss_clf 0.312, Loss_aux 0.245, Train_accy 91.49:  85%|████████▌ | 17/20 [16:20<02:44, 54.92s/it]
Task 2, Epoch 18/20 => Loss 0.557, Loss_clf 0.312, Loss_aux 0.245, Train_accy 91.49:  90%|█████████ | 18/20 [16:20<01:47, 53.89s/it]
Task 2, Epoch 19/20 => Loss 0.517, Loss_clf 0.283, Loss_aux 0.234, Train_accy 92.47:  90%|█████████ | 18/20 [17:12<01:47, 53.89s/it]
Task 2, Epoch 19/20 => Loss 0.517, Loss_clf 0.283, Loss_aux 0.234, Train_accy 92.47:  95%|█████████▌| 19/20 [17:12<00:53, 53.20s/it]
Task 2, Epoch 20/20 => Loss 0.553, Loss_clf 0.308, Loss_aux 0.245, Train_accy 91.26:  95%|█████████▌| 19/20 [18:03<00:53, 53.20s/it]
Task 2, Epoch 20/20 => Loss 0.553, Loss_clf 0.308, Loss_aux 0.245, Train_accy 91.26: 100%|██████████| 20/20 [18:03<00:00, 52.69s/it]
Task 2, Epoch 20/20 => Loss 0.553, Loss_clf 0.308, Loss_aux 0.245, Train_accy 91.26: 100%|██████████| 20/20 [18:03<00:00, 54.18s/it]
2024-09-12 08:03:53,410 [der.py] => Task 2, Epoch 20/20 => Loss 0.553, Loss_clf 0.308, Loss_aux 0.245, Train_accy 91.26
2024-09-12 08:03:53,412 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 08:05:57,246 [der.py] => Exemplar size: 2400
2024-09-12 08:05:57,246 [trainer.py] => CNN: {'total': 89.34, '00-39': 87.89, '40-79': 87.74, '80-119': 92.15, 'old': 87.81, 'new': 92.15}
2024-09-12 08:05:57,246 [trainer.py] => NME: {'total': 88.84, '00-39': 88.11, '40-79': 86.88, '80-119': 91.35, 'old': 87.49, 'new': 91.35}
2024-09-12 08:05:57,246 [trainer.py] => CNN top1 curve: [96.26, 91.19, 89.34]
2024-09-12 08:05:57,246 [trainer.py] => CNN top5 curve: [99.56, 98.59, 98.02]
2024-09-12 08:05:57,246 [trainer.py] => NME top1 curve: [96.92, 90.86, 88.84]
2024-09-12 08:05:57,246 [trainer.py] => NME top5 curve: [99.78, 99.13, 98.52]

Average Accuracy (CNN): 92.26
Average Accuracy (NME): 92.21
2024-09-12 08:05:57,246 [trainer.py] => Average Accuracy (CNN): 92.26
2024-09-12 08:05:57,247 [trainer.py] => Average Accuracy (NME): 92.21
2024-09-12 08:05:57,248 [trainer.py] => All params: 257704097
2024-09-12 08:05:57,249 [trainer.py] => Trainable params: 86106785
2024-09-12 08:05:58,860 [der.py] => Learning on 120-160
2024-09-12 08:05:58,865 [der.py] => All params: 343717833
2024-09-12 08:05:58,867 [der.py] => Trainable params: 86321865

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.415, Loss_clf 1.848, Loss_aux 1.568, Train_accy 67.45, Test_accy 83.98:   0%|          | 0/20 [01:39<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.415, Loss_clf 1.848, Loss_aux 1.568, Train_accy 67.45, Test_accy 83.98:   5%|▌         | 1/20 [01:39<31:28, 99.38s/it]
Task 3, Epoch 2/20 => Loss 1.289, Loss_clf 0.620, Loss_aux 0.670, Train_accy 82.31:   5%|▌         | 1/20 [02:55<31:28, 99.38s/it]                 
Task 3, Epoch 2/20 => Loss 1.289, Loss_clf 0.620, Loss_aux 0.670, Train_accy 82.31:  10%|█         | 2/20 [02:55<25:43, 85.76s/it]
Task 3, Epoch 3/20 => Loss 1.124, Loss_clf 0.564, Loss_aux 0.561, Train_accy 84.58:  10%|█         | 2/20 [04:11<25:43, 85.76s/it]
Task 3, Epoch 3/20 => Loss 1.124, Loss_clf 0.564, Loss_aux 0.561, Train_accy 84.58:  15%|█▌        | 3/20 [04:11<23:03, 81.41s/it]
Task 3, Epoch 4/20 => Loss 0.936, Loss_clf 0.511, Loss_aux 0.426, Train_accy 85.96:  15%|█▌        | 3/20 [05:28<23:03, 81.41s/it]
Task 3, Epoch 4/20 => Loss 0.936, Loss_clf 0.511, Loss_aux 0.426, Train_accy 85.96:  20%|██        | 4/20 [05:28<21:10, 79.39s/it]
Task 3, Epoch 5/20 => Loss 0.881, Loss_clf 0.469, Loss_aux 0.412, Train_accy 86.94:  20%|██        | 4/20 [06:44<21:10, 79.39s/it]
Task 3, Epoch 5/20 => Loss 0.881, Loss_clf 0.469, Loss_aux 0.412, Train_accy 86.94:  25%|██▌       | 5/20 [06:44<19:35, 78.35s/it]
Task 3, Epoch 6/20 => Loss 0.765, Loss_clf 0.431, Loss_aux 0.334, Train_accy 88.11, Test_accy 86.41:  25%|██▌       | 5/20 [08:24<19:35, 78.35s/it]
Task 3, Epoch 6/20 => Loss 0.765, Loss_clf 0.431, Loss_aux 0.334, Train_accy 88.11, Test_accy 86.41:  30%|███       | 6/20 [08:24<20:00, 85.76s/it]
Task 3, Epoch 7/20 => Loss 0.777, Loss_clf 0.432, Loss_aux 0.345, Train_accy 88.16:  30%|███       | 6/20 [09:41<20:00, 85.76s/it]                 
Task 3, Epoch 7/20 => Loss 0.777, Loss_clf 0.432, Loss_aux 0.345, Train_accy 88.16:  35%|███▌      | 7/20 [09:41<17:54, 82.67s/it]
Task 3, Epoch 8/20 => Loss 0.692, Loss_clf 0.386, Loss_aux 0.306, Train_accy 89.47:  35%|███▌      | 7/20 [10:57<17:54, 82.67s/it]
Task 3, Epoch 8/20 => Loss 0.692, Loss_clf 0.386, Loss_aux 0.306, Train_accy 89.47:  40%|████      | 8/20 [10:57<16:08, 80.71s/it]
Task 3, Epoch 9/20 => Loss 0.822, Loss_clf 0.493, Loss_aux 0.329, Train_accy 87.79:  40%|████      | 8/20 [12:13<16:08, 80.71s/it]
Task 3, Epoch 9/20 => Loss 0.822, Loss_clf 0.493, Loss_aux 0.329, Train_accy 87.79:  45%|████▌     | 9/20 [12:13<14:32, 79.35s/it]
Task 3, Epoch 10/20 => Loss 0.655, Loss_clf 0.383, Loss_aux 0.272, Train_accy 89.71:  45%|████▌     | 9/20 [13:30<14:32, 79.35s/it]
Task 3, Epoch 10/20 => Loss 0.655, Loss_clf 0.383, Loss_aux 0.272, Train_accy 89.71:  50%|█████     | 10/20 [13:30<13:05, 78.58s/it]
Task 3, Epoch 11/20 => Loss 0.635, Loss_clf 0.392, Loss_aux 0.243, Train_accy 89.75, Test_accy 86.30:  50%|█████     | 10/20 [15:11<13:05, 78.58s/it]
Task 3, Epoch 11/20 => Loss 0.635, Loss_clf 0.392, Loss_aux 0.243, Train_accy 89.75, Test_accy 86.30:  55%|█████▌    | 11/20 [15:11<12:47, 85.30s/it]
Task 3, Epoch 12/20 => Loss 0.662, Loss_clf 0.404, Loss_aux 0.257, Train_accy 89.33:  55%|█████▌    | 11/20 [16:27<12:47, 85.30s/it]                 
Task 3, Epoch 12/20 => Loss 0.662, Loss_clf 0.404, Loss_aux 0.257, Train_accy 89.33:  60%|██████    | 12/20 [16:27<11:01, 82.63s/it]
Task 3, Epoch 13/20 => Loss 0.596, Loss_clf 0.354, Loss_aux 0.241, Train_accy 91.02:  60%|██████    | 12/20 [17:44<11:01, 82.63s/it]
Task 3, Epoch 13/20 => Loss 0.596, Loss_clf 0.354, Loss_aux 0.241, Train_accy 91.02:  65%|██████▌   | 13/20 [17:44<09:25, 80.78s/it]
Task 3, Epoch 14/20 => Loss 0.648, Loss_clf 0.393, Loss_aux 0.256, Train_accy 90.15:  65%|██████▌   | 13/20 [19:00<09:25, 80.78s/it]
Task 3, Epoch 14/20 => Loss 0.648, Loss_clf 0.393, Loss_aux 0.256, Train_accy 90.15:  70%|███████   | 14/20 [19:00<07:56, 79.48s/it]
Task 3, Epoch 15/20 => Loss 0.586, Loss_clf 0.369, Loss_aux 0.217, Train_accy 90.80:  70%|███████   | 14/20 [20:17<07:56, 79.48s/it]
Task 3, Epoch 15/20 => Loss 0.586, Loss_clf 0.369, Loss_aux 0.217, Train_accy 90.80:  75%|███████▌  | 15/20 [20:17<06:32, 78.58s/it]
Task 3, Epoch 16/20 => Loss 0.564, Loss_clf 0.316, Loss_aux 0.248, Train_accy 91.83, Test_accy 87.15:  75%|███████▌  | 15/20 [21:57<06:32, 78.58s/it]
Task 3, Epoch 16/20 => Loss 0.564, Loss_clf 0.316, Loss_aux 0.248, Train_accy 91.83, Test_accy 87.15:  80%|████████  | 16/20 [21:57<05:40, 85.10s/it]
Task 3, Epoch 17/20 => Loss 0.790, Loss_clf 0.392, Loss_aux 0.398, Train_accy 89.75:  80%|████████  | 16/20 [23:14<05:40, 85.10s/it]                 
Task 3, Epoch 17/20 => Loss 0.790, Loss_clf 0.392, Loss_aux 0.398, Train_accy 89.75:  85%|████████▌ | 17/20 [23:14<04:07, 82.49s/it]
Task 3, Epoch 18/20 => Loss 0.641, Loss_clf 0.372, Loss_aux 0.269, Train_accy 90.48:  85%|████████▌ | 17/20 [24:30<04:07, 82.49s/it]
Task 3, Epoch 18/20 => Loss 0.641, Loss_clf 0.372, Loss_aux 0.269, Train_accy 90.48:  90%|█████████ | 18/20 [24:30<02:41, 80.69s/it]
Task 3, Epoch 19/20 => Loss 0.594, Loss_clf 0.351, Loss_aux 0.243, Train_accy 91.23:  90%|█████████ | 18/20 [25:46<02:41, 80.69s/it]
Task 3, Epoch 19/20 => Loss 0.594, Loss_clf 0.351, Loss_aux 0.243, Train_accy 91.23:  95%|█████████▌| 19/20 [25:46<01:19, 79.41s/it]
Task 3, Epoch 20/20 => Loss 0.499, Loss_clf 0.298, Loss_aux 0.201, Train_accy 91.86:  95%|█████████▌| 19/20 [27:03<01:19, 79.41s/it]
Task 3, Epoch 20/20 => Loss 0.499, Loss_clf 0.298, Loss_aux 0.201, Train_accy 91.86: 100%|██████████| 20/20 [27:03<00:00, 78.51s/it]
Task 3, Epoch 20/20 => Loss 0.499, Loss_clf 0.298, Loss_aux 0.201, Train_accy 91.86: 100%|██████████| 20/20 [27:03<00:00, 81.17s/it]
2024-09-12 08:33:02,295 [der.py] => Task 3, Epoch 20/20 => Loss 0.499, Loss_clf 0.298, Loss_aux 0.201, Train_accy 91.86
2024-09-12 08:33:02,296 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 08:36:02,807 [der.py] => Exemplar size: 3200
2024-09-12 08:36:02,807 [trainer.py] => CNN: {'total': 86.89, '00-39': 84.14, '40-79': 86.24, '80-119': 86.72, '120-159': 90.32, 'old': 85.73, 'new': 90.32}
2024-09-12 08:36:02,807 [trainer.py] => NME: {'total': 87.26, '00-39': 86.78, '40-79': 85.38, '80-119': 89.34, '120-159': 87.37, 'old': 87.22, 'new': 87.37}
2024-09-12 08:36:02,807 [trainer.py] => CNN top1 curve: [96.26, 91.19, 89.34, 86.89]
2024-09-12 08:36:02,808 [trainer.py] => CNN top5 curve: [99.56, 98.59, 98.02, 97.57]
2024-09-12 08:36:02,808 [trainer.py] => NME top1 curve: [96.92, 90.86, 88.84, 87.26]
2024-09-12 08:36:02,808 [trainer.py] => NME top5 curve: [99.78, 99.13, 98.52, 98.31]

Average Accuracy (CNN): 90.92
Average Accuracy (NME): 90.97
2024-09-12 08:36:02,808 [trainer.py] => Average Accuracy (CNN): 90.92
2024-09-12 08:36:02,808 [trainer.py] => Average Accuracy (NME): 90.97
2024-09-12 08:36:02,810 [trainer.py] => All params: 343717833
2024-09-12 08:36:02,812 [trainer.py] => Trainable params: 86321865
2024-09-12 08:36:04,415 [der.py] => Learning on 160-200
2024-09-12 08:36:04,420 [der.py] => All params: 429793009
2024-09-12 08:36:04,422 [der.py] => Trainable params: 86598385

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.999, Loss_clf 1.593, Loss_aux 1.406, Train_accy 72.95, Test_accy 80.96:   0%|          | 0/20 [02:23<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.999, Loss_clf 1.593, Loss_aux 1.406, Train_accy 72.95, Test_accy 80.96:   5%|▌         | 1/20 [02:23<45:18, 143.10s/it]
Task 4, Epoch 2/20 => Loss 1.180, Loss_clf 0.615, Loss_aux 0.565, Train_accy 83.70:   5%|▌         | 1/20 [04:09<45:18, 143.10s/it]                 
Task 4, Epoch 2/20 => Loss 1.180, Loss_clf 0.615, Loss_aux 0.565, Train_accy 83.70:  10%|█         | 2/20 [04:09<36:31, 121.78s/it]
Task 4, Epoch 3/20 => Loss 0.968, Loss_clf 0.534, Loss_aux 0.434, Train_accy 85.79:  10%|█         | 2/20 [05:56<36:31, 121.78s/it]
Task 4, Epoch 3/20 => Loss 0.968, Loss_clf 0.534, Loss_aux 0.434, Train_accy 85.79:  15%|█▌        | 3/20 [05:56<32:34, 115.00s/it]
Task 4, Epoch 4/20 => Loss 0.842, Loss_clf 0.470, Loss_aux 0.372, Train_accy 87.69:  15%|█▌        | 3/20 [07:43<32:34, 115.00s/it]
Task 4, Epoch 4/20 => Loss 0.842, Loss_clf 0.470, Loss_aux 0.372, Train_accy 87.69:  20%|██        | 4/20 [07:43<29:49, 111.82s/it]
Task 4, Epoch 5/20 => Loss 0.804, Loss_clf 0.459, Loss_aux 0.345, Train_accy 87.83:  20%|██        | 4/20 [09:30<29:49, 111.82s/it]
Task 4, Epoch 5/20 => Loss 0.804, Loss_clf 0.459, Loss_aux 0.345, Train_accy 87.83:  25%|██▌       | 5/20 [09:30<27:31, 110.08s/it]
Task 4, Epoch 6/20 => Loss 0.780, Loss_clf 0.455, Loss_aux 0.325, Train_accy 88.06, Test_accy 83.12:  25%|██▌       | 5/20 [11:54<27:31, 110.08s/it]
Task 4, Epoch 6/20 => Loss 0.780, Loss_clf 0.455, Loss_aux 0.325, Train_accy 88.06, Test_accy 83.12:  30%|███       | 6/20 [11:54<28:23, 121.67s/it]
Task 4, Epoch 7/20 => Loss 0.713, Loss_clf 0.436, Loss_aux 0.277, Train_accy 88.73:  30%|███       | 6/20 [13:42<28:23, 121.67s/it]                 
Task 4, Epoch 7/20 => Loss 0.713, Loss_clf 0.436, Loss_aux 0.277, Train_accy 88.73:  35%|███▌      | 7/20 [13:42<25:19, 116.89s/it]
Task 4, Epoch 8/20 => Loss 0.701, Loss_clf 0.422, Loss_aux 0.279, Train_accy 88.94:  35%|███▌      | 7/20 [15:29<25:19, 116.89s/it]
Task 4, Epoch 8/20 => Loss 0.701, Loss_clf 0.422, Loss_aux 0.279, Train_accy 88.94:  40%|████      | 8/20 [15:29<22:45, 113.79s/it]
Task 4, Epoch 9/20 => Loss 0.669, Loss_clf 0.414, Loss_aux 0.255, Train_accy 89.12:  40%|████      | 8/20 [17:16<22:45, 113.79s/it]
Task 4, Epoch 9/20 => Loss 0.669, Loss_clf 0.414, Loss_aux 0.255, Train_accy 89.12:  45%|████▌     | 9/20 [17:16<20:28, 111.72s/it]
Task 4, Epoch 10/20 => Loss 0.635, Loss_clf 0.389, Loss_aux 0.247, Train_accy 90.10:  45%|████▌     | 9/20 [19:03<20:28, 111.72s/it]
Task 4, Epoch 10/20 => Loss 0.635, Loss_clf 0.389, Loss_aux 0.247, Train_accy 90.10:  50%|█████     | 10/20 [19:03<18:22, 110.29s/it]
Task 4, Epoch 11/20 => Loss 0.618, Loss_clf 0.378, Loss_aux 0.240, Train_accy 90.14, Test_accy 83.67:  50%|█████     | 10/20 [21:27<18:22, 110.29s/it]
Task 4, Epoch 11/20 => Loss 0.618, Loss_clf 0.378, Loss_aux 0.240, Train_accy 90.14, Test_accy 83.67:  55%|█████▌    | 11/20 [21:27<18:06, 120.70s/it]
Task 4, Epoch 12/20 => Loss 0.608, Loss_clf 0.368, Loss_aux 0.240, Train_accy 89.94:  55%|█████▌    | 11/20 [23:14<18:06, 120.70s/it]                 
Task 4, Epoch 12/20 => Loss 0.608, Loss_clf 0.368, Loss_aux 0.240, Train_accy 89.94:  60%|██████    | 12/20 [23:14<15:32, 116.59s/it]
Task 4, Epoch 13/20 => Loss 0.625, Loss_clf 0.386, Loss_aux 0.239, Train_accy 89.78:  60%|██████    | 12/20 [25:00<15:32, 116.59s/it]
Task 4, Epoch 13/20 => Loss 0.625, Loss_clf 0.386, Loss_aux 0.239, Train_accy 89.78:  65%|██████▌   | 13/20 [25:00<13:12, 113.24s/it]
Task 4, Epoch 14/20 => Loss 0.566, Loss_clf 0.351, Loss_aux 0.215, Train_accy 90.72:  65%|██████▌   | 13/20 [26:44<13:12, 113.24s/it]
Task 4, Epoch 14/20 => Loss 0.566, Loss_clf 0.351, Loss_aux 0.215, Train_accy 90.72:  70%|███████   | 14/20 [26:44<11:03, 110.59s/it]
Task 4, Epoch 15/20 => Loss 0.554, Loss_clf 0.341, Loss_aux 0.213, Train_accy 91.19:  70%|███████   | 14/20 [28:29<11:03, 110.59s/it]
Task 4, Epoch 15/20 => Loss 0.554, Loss_clf 0.341, Loss_aux 0.213, Train_accy 91.19:  75%|███████▌  | 15/20 [28:29<09:03, 108.70s/it]
Task 4, Epoch 16/20 => Loss 0.564, Loss_clf 0.366, Loss_aux 0.199, Train_accy 90.84, Test_accy 84.31:  75%|███████▌  | 15/20 [30:49<09:03, 108.70s/it]
Task 4, Epoch 16/20 => Loss 0.564, Loss_clf 0.366, Loss_aux 0.199, Train_accy 90.84, Test_accy 84.31:  80%|████████  | 16/20 [30:49<07:52, 118.24s/it]
Task 4, Epoch 17/20 => Loss 0.535, Loss_clf 0.334, Loss_aux 0.201, Train_accy 91.64:  80%|████████  | 16/20 [32:33<07:52, 118.24s/it]                 
Task 4, Epoch 17/20 => Loss 0.535, Loss_clf 0.334, Loss_aux 0.201, Train_accy 91.64:  85%|████████▌ | 17/20 [32:33<05:42, 114.06s/it]
Task 4, Epoch 18/20 => Loss 0.569, Loss_clf 0.363, Loss_aux 0.207, Train_accy 90.90:  85%|████████▌ | 17/20 [34:18<05:42, 114.06s/it]
Task 4, Epoch 18/20 => Loss 0.569, Loss_clf 0.363, Loss_aux 0.207, Train_accy 90.90:  90%|█████████ | 18/20 [34:18<03:42, 111.13s/it]
Task 4, Epoch 19/20 => Loss 0.547, Loss_clf 0.349, Loss_aux 0.198, Train_accy 91.35:  90%|█████████ | 18/20 [36:02<03:42, 111.13s/it]
Task 4, Epoch 19/20 => Loss 0.547, Loss_clf 0.349, Loss_aux 0.198, Train_accy 91.35:  95%|█████████▌| 19/20 [36:02<01:49, 109.09s/it]
Task 4, Epoch 20/20 => Loss 0.540, Loss_clf 0.347, Loss_aux 0.192, Train_accy 90.98:  95%|█████████▌| 19/20 [37:47<01:49, 109.09s/it]
Task 4, Epoch 20/20 => Loss 0.540, Loss_clf 0.347, Loss_aux 0.192, Train_accy 90.98: 100%|██████████| 20/20 [37:47<00:00, 107.68s/it]
Task 4, Epoch 20/20 => Loss 0.540, Loss_clf 0.347, Loss_aux 0.192, Train_accy 90.98: 100%|██████████| 20/20 [37:47<00:00, 113.35s/it]
2024-09-12 09:13:51,536 [der.py] => Task 4, Epoch 20/20 => Loss 0.540, Loss_clf 0.347, Loss_aux 0.192, Train_accy 90.98
2024-09-12 09:13:51,538 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-12 09:18:11,441 [der.py] => Exemplar size: 4000
2024-09-12 09:18:11,441 [trainer.py] => CNN: {'total': 84.99, '00-39': 82.6, '40-79': 83.01, '80-119': 86.32, '120-159': 82.74, '160-199': 90.15, 'old': 83.71, 'new': 90.15}
2024-09-12 09:18:11,441 [trainer.py] => NME: {'total': 85.24, '00-39': 84.14, '40-79': 83.44, '80-119': 87.93, '120-159': 86.11, '160-199': 84.37, 'old': 85.46, 'new': 84.37}
2024-09-12 09:18:11,441 [trainer.py] => CNN top1 curve: [96.26, 91.19, 89.34, 86.89, 84.99]
2024-09-12 09:18:11,441 [trainer.py] => CNN top5 curve: [99.56, 98.59, 98.02, 97.57, 96.27]
2024-09-12 09:18:11,441 [trainer.py] => NME top1 curve: [96.92, 90.86, 88.84, 87.26, 85.24]
2024-09-12 09:18:11,442 [trainer.py] => NME top5 curve: [99.78, 99.13, 98.52, 98.31, 97.54]

Average Accuracy (CNN): 89.73
Average Accuracy (NME): 89.82
2024-09-12 09:18:11,442 [trainer.py] => Average Accuracy (CNN): 89.73
2024-09-12 09:18:11,442 [trainer.py] => Average Accuracy (NME): 89.82
Accuracy Matrix (CNN):
[[96.26 89.43 87.89 84.14 82.6 ]
 [ 0.   92.9  87.74 86.24 83.01]
 [ 0.    0.   92.15 86.72 86.32]
 [ 0.    0.    0.   90.32 82.74]
 [ 0.    0.    0.    0.   90.15]]
2024-09-12 09:18:11,442 [trainer.py] => Forgetting (CNN): 9.240000000000006
Accuracy Matrix (NME):
[[96.92 90.97 88.11 86.78 84.14]
 [ 0.   90.75 86.88 85.38 83.44]
 [ 0.    0.   91.35 89.34 87.93]
 [ 0.    0.    0.   87.37 86.11]
 [ 0.    0.    0.    0.   84.37]]
2024-09-12 09:18:11,443 [trainer.py] => Forgetting (NME): 6.192499999999999
nohup: 忽略输入
2024-09-12 10:02:54,639 [trainer.py] => config: ./exps/der_cub_B0_Inc10.json
2024-09-12 10:02:54,677 [trainer.py] => prefix: reproduce
2024-09-12 10:02:54,677 [trainer.py] => dataset: cub
2024-09-12 10:02:54,677 [trainer.py] => memory_size: 4000
2024-09-12 10:02:54,677 [trainer.py] => memory_per_class: 20
2024-09-12 10:02:54,677 [trainer.py] => fixed_memory: True
2024-09-12 10:02:54,677 [trainer.py] => shuffle: True
2024-09-12 10:02:54,677 [trainer.py] => init_cls: 20
2024-09-12 10:02:54,678 [trainer.py] => increment: 20
2024-09-12 10:02:54,678 [trainer.py] => model_name: der
2024-09-12 10:02:54,678 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 10:02:54,678 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-12 10:02:54,678 [trainer.py] => seed: 1993
2024-09-12 10:02:54,678 [trainer.py] => init_epoch: 20
2024-09-12 10:02:54,678 [trainer.py] => init_lr: 0.001
2024-09-12 10:02:54,678 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 10:02:54,679 [trainer.py] => init_lr_decay: 0.1
2024-09-12 10:02:54,679 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 10:02:54,679 [trainer.py] => epochs: 20
2024-09-12 10:02:54,679 [trainer.py] => lrate: 0.001
2024-09-12 10:02:54,679 [trainer.py] => milestones: [80, 120, 150]
2024-09-12 10:02:54,679 [trainer.py] => lrate_decay: 0.1
2024-09-12 10:02:54,679 [trainer.py] => batch_size: 48
2024-09-12 10:02:54,679 [trainer.py] => weight_decay: 0.0002
2024-09-12 10:02:54,679 [trainer.py] => T: 2
2024-09-12 10:02:54,738 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 10:03:00,478 [trainer.py] => All params: 0
2024-09-12 10:03:00,478 [trainer.py] => Trainable params: 0
2024-09-12 10:03:02,591 [der.py] => Learning on 0-20
2024-09-12 10:03:02,592 [der.py] => All params: 85830185
2024-09-12 10:03:02,593 [der.py] => Trainable params: 85830185

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.889, Train_accy 46.62, Test_accy 85.02:   0%|          | 0/20 [00:10<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.889, Train_accy 46.62, Test_accy 85.02:   5%|▌         | 1/20 [00:10<03:12, 10.11s/it]
Task 0, Epoch 2/20 => Loss 0.731, Train_accy 78.86:   5%|▌         | 1/20 [00:18<03:12, 10.11s/it]                 
Task 0, Epoch 2/20 => Loss 0.731, Train_accy 78.86:  10%|█         | 2/20 [00:18<02:45,  9.20s/it]
Task 0, Epoch 3/20 => Loss 0.459, Train_accy 86.05:  10%|█         | 2/20 [00:27<02:45,  9.20s/it]
Task 0, Epoch 3/20 => Loss 0.459, Train_accy 86.05:  15%|█▌        | 3/20 [00:27<02:30,  8.85s/it]
Task 0, Epoch 4/20 => Loss 0.426, Train_accy 87.10:  15%|█▌        | 3/20 [00:35<02:30,  8.85s/it]
Task 0, Epoch 4/20 => Loss 0.426, Train_accy 87.10:  20%|██        | 4/20 [00:35<02:18,  8.68s/it]
Task 0, Epoch 5/20 => Loss 0.334, Train_accy 89.64:  20%|██        | 4/20 [00:43<02:18,  8.68s/it]
Task 0, Epoch 5/20 => Loss 0.334, Train_accy 89.64:  25%|██▌       | 5/20 [00:43<02:08,  8.59s/it]
Task 0, Epoch 6/20 => Loss 0.266, Train_accy 90.38, Test_accy 96.36:  25%|██▌       | 5/20 [00:53<02:08,  8.59s/it]
Task 0, Epoch 6/20 => Loss 0.266, Train_accy 90.38, Test_accy 96.36:  30%|███       | 6/20 [00:53<02:06,  9.00s/it]
Task 0, Epoch 7/20 => Loss 0.259, Train_accy 90.91:  30%|███       | 6/20 [01:02<02:06,  9.00s/it]                 
Task 0, Epoch 7/20 => Loss 0.259, Train_accy 90.91:  35%|███▌      | 7/20 [01:02<01:54,  8.80s/it]
Task 0, Epoch 8/20 => Loss 0.233, Train_accy 93.23:  35%|███▌      | 7/20 [01:10<01:54,  8.80s/it]
Task 0, Epoch 8/20 => Loss 0.233, Train_accy 93.23:  40%|████      | 8/20 [01:10<01:44,  8.68s/it]
Task 0, Epoch 9/20 => Loss 0.171, Train_accy 94.50:  40%|████      | 8/20 [01:18<01:44,  8.68s/it]
Task 0, Epoch 9/20 => Loss 0.171, Train_accy 94.50:  45%|████▌     | 9/20 [01:18<01:34,  8.59s/it]
Task 0, Epoch 10/20 => Loss 0.190, Train_accy 93.66:  45%|████▌     | 9/20 [01:27<01:34,  8.59s/it]
Task 0, Epoch 10/20 => Loss 0.190, Train_accy 93.66:  50%|█████     | 10/20 [01:27<01:25,  8.54s/it]
Task 0, Epoch 11/20 => Loss 0.170, Train_accy 94.61, Test_accy 97.17:  50%|█████     | 10/20 [01:37<01:25,  8.54s/it]
Task 0, Epoch 11/20 => Loss 0.170, Train_accy 94.61, Test_accy 97.17:  55%|█████▌    | 11/20 [01:37<01:19,  8.89s/it]
Task 0, Epoch 12/20 => Loss 0.207, Train_accy 93.45:  55%|█████▌    | 11/20 [01:45<01:19,  8.89s/it]                 
Task 0, Epoch 12/20 => Loss 0.207, Train_accy 93.45:  60%|██████    | 12/20 [01:45<01:09,  8.74s/it]
Task 0, Epoch 13/20 => Loss 0.225, Train_accy 92.07:  60%|██████    | 12/20 [01:53<01:09,  8.74s/it]
Task 0, Epoch 13/20 => Loss 0.225, Train_accy 92.07:  65%|██████▌   | 13/20 [01:53<01:00,  8.63s/it]
Task 0, Epoch 14/20 => Loss 0.241, Train_accy 92.39:  65%|██████▌   | 13/20 [02:02<01:00,  8.63s/it]
Task 0, Epoch 14/20 => Loss 0.241, Train_accy 92.39:  70%|███████   | 14/20 [02:02<00:51,  8.56s/it]
Task 0, Epoch 15/20 => Loss 0.181, Train_accy 94.50:  70%|███████   | 14/20 [02:10<00:51,  8.56s/it]
Task 0, Epoch 15/20 => Loss 0.181, Train_accy 94.50:  75%|███████▌  | 15/20 [02:10<00:42,  8.52s/it]
Task 0, Epoch 16/20 => Loss 0.201, Train_accy 94.29, Test_accy 97.98:  75%|███████▌  | 15/20 [02:20<00:42,  8.52s/it]
Task 0, Epoch 16/20 => Loss 0.201, Train_accy 94.29, Test_accy 97.98:  80%|████████  | 16/20 [02:20<00:35,  8.90s/it]
Task 0, Epoch 17/20 => Loss 0.177, Train_accy 94.29:  80%|████████  | 16/20 [02:28<00:35,  8.90s/it]                 
Task 0, Epoch 17/20 => Loss 0.177, Train_accy 94.29:  85%|████████▌ | 17/20 [02:28<00:26,  8.75s/it]
Task 0, Epoch 18/20 => Loss 0.141, Train_accy 95.98:  85%|████████▌ | 17/20 [02:37<00:26,  8.75s/it]
Task 0, Epoch 18/20 => Loss 0.141, Train_accy 95.98:  90%|█████████ | 18/20 [02:37<00:17,  8.65s/it]
Task 0, Epoch 19/20 => Loss 0.169, Train_accy 94.93:  90%|█████████ | 18/20 [02:45<00:17,  8.65s/it]
Task 0, Epoch 19/20 => Loss 0.169, Train_accy 94.93:  95%|█████████▌| 19/20 [02:45<00:08,  8.57s/it]
Task 0, Epoch 20/20 => Loss 0.150, Train_accy 95.56:  95%|█████████▌| 19/20 [02:54<00:08,  8.57s/it]
Task 0, Epoch 20/20 => Loss 0.150, Train_accy 95.56: 100%|██████████| 20/20 [02:54<00:00,  8.53s/it]
Task 0, Epoch 20/20 => Loss 0.150, Train_accy 95.56: 100%|██████████| 20/20 [02:54<00:00,  8.70s/it]2024-09-12 10:05:57,186 [der.py] => Task 0, Epoch 20/20 => Loss 0.150, Train_accy 95.56
2024-09-12 10:05:57,187 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 10:06:19,747 [der.py] => Exemplar size: 400
2024-09-12 10:06:19,748 [trainer.py] => CNN: {'total': 97.17, '00-19': 97.17, 'old': 0, 'new': 97.17}
2024-09-12 10:06:19,748 [trainer.py] => NME: {'total': 98.38, '00-19': 98.38, 'old': 0, 'new': 98.38}
2024-09-12 10:06:19,748 [trainer.py] => CNN top1 curve: [97.17]
2024-09-12 10:06:19,748 [trainer.py] => CNN top5 curve: [100.0]
2024-09-12 10:06:19,748 [trainer.py] => NME top1 curve: [98.38]
2024-09-12 10:06:19,748 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 97.17
Average Accuracy (NME): 98.38
2024-09-12 10:06:19,748 [trainer.py] => Average Accuracy (CNN): 97.17
2024-09-12 10:06:19,748 [trainer.py] => Average Accuracy (NME): 98.38
2024-09-12 10:06:19,750 [trainer.py] => All params: 85830185
2024-09-12 10:06:19,751 [trainer.py] => Trainable params: 85830185
2024-09-12 10:06:21,662 [der.py] => Learning on 20-40
2024-09-12 10:06:21,664 [der.py] => All params: 171674941
2024-09-12 10:06:21,665 [der.py] => Trainable params: 85876285

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.079, Loss_clf 2.439, Loss_aux 1.641, Train_accy 54.80, Test_accy 82.38:   0%|          | 0/20 [00:19<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.079, Loss_clf 2.439, Loss_aux 1.641, Train_accy 54.80, Test_accy 82.38:   5%|▌         | 1/20 [00:19<06:09, 19.46s/it]
Task 1, Epoch 2/20 => Loss 2.185, Loss_clf 1.013, Loss_aux 1.172, Train_accy 78.22:   5%|▌         | 1/20 [00:35<06:09, 19.46s/it]                 
Task 1, Epoch 2/20 => Loss 2.185, Loss_clf 1.013, Loss_aux 1.172, Train_accy 78.22:  10%|█         | 2/20 [00:35<05:13, 17.44s/it]
Task 1, Epoch 3/20 => Loss 0.940, Loss_clf 0.467, Loss_aux 0.473, Train_accy 86.10:  10%|█         | 2/20 [00:51<05:13, 17.44s/it]
Task 1, Epoch 3/20 => Loss 0.940, Loss_clf 0.467, Loss_aux 0.473, Train_accy 86.10:  15%|█▌        | 3/20 [00:51<04:44, 16.72s/it]
Task 1, Epoch 4/20 => Loss 0.556, Loss_clf 0.268, Loss_aux 0.287, Train_accy 91.52:  15%|█▌        | 3/20 [01:07<04:44, 16.72s/it]
Task 1, Epoch 4/20 => Loss 0.556, Loss_clf 0.268, Loss_aux 0.287, Train_accy 91.52:  20%|██        | 4/20 [01:07<04:22, 16.39s/it]
Task 1, Epoch 5/20 => Loss 0.523, Loss_clf 0.259, Loss_aux 0.264, Train_accy 92.12:  20%|██        | 4/20 [01:23<04:22, 16.39s/it]
Task 1, Epoch 5/20 => Loss 0.523, Loss_clf 0.259, Loss_aux 0.264, Train_accy 92.12:  25%|██▌       | 5/20 [01:23<04:02, 16.19s/it]
Task 1, Epoch 6/20 => Loss 0.596, Loss_clf 0.294, Loss_aux 0.301, Train_accy 91.60, Test_accy 93.83:  25%|██▌       | 5/20 [01:42<04:02, 16.19s/it]
Task 1, Epoch 6/20 => Loss 0.596, Loss_clf 0.294, Loss_aux 0.301, Train_accy 91.60, Test_accy 93.83:  30%|███       | 6/20 [01:42<04:01, 17.28s/it]
Task 1, Epoch 7/20 => Loss 0.483, Loss_clf 0.247, Loss_aux 0.236, Train_accy 92.64:  30%|███       | 6/20 [01:58<04:01, 17.28s/it]                 
Task 1, Epoch 7/20 => Loss 0.483, Loss_clf 0.247, Loss_aux 0.236, Train_accy 92.64:  35%|███▌      | 7/20 [01:58<03:38, 16.78s/it]
Task 1, Epoch 8/20 => Loss 0.462, Loss_clf 0.217, Loss_aux 0.244, Train_accy 93.53:  35%|███▌      | 7/20 [02:14<03:38, 16.78s/it]
Task 1, Epoch 8/20 => Loss 0.462, Loss_clf 0.217, Loss_aux 0.244, Train_accy 93.53:  40%|████      | 8/20 [02:14<03:17, 16.47s/it]
Task 1, Epoch 9/20 => Loss 0.460, Loss_clf 0.234, Loss_aux 0.227, Train_accy 92.64:  40%|████      | 8/20 [02:29<03:17, 16.47s/it]
Task 1, Epoch 9/20 => Loss 0.460, Loss_clf 0.234, Loss_aux 0.227, Train_accy 92.64:  45%|████▌     | 9/20 [02:29<02:59, 16.28s/it]
Task 1, Epoch 10/20 => Loss 0.462, Loss_clf 0.244, Loss_aux 0.218, Train_accy 92.27:  45%|████▌     | 9/20 [02:45<02:59, 16.28s/it]
Task 1, Epoch 10/20 => Loss 0.462, Loss_clf 0.244, Loss_aux 0.218, Train_accy 92.27:  50%|█████     | 10/20 [02:45<02:41, 16.16s/it]
Task 1, Epoch 11/20 => Loss 0.457, Loss_clf 0.232, Loss_aux 0.225, Train_accy 93.53, Test_accy 95.15:  50%|█████     | 10/20 [03:05<02:41, 16.16s/it]
Task 1, Epoch 11/20 => Loss 0.457, Loss_clf 0.232, Loss_aux 0.225, Train_accy 93.53, Test_accy 95.15:  55%|█████▌    | 11/20 [03:05<02:34, 17.15s/it]
Task 1, Epoch 12/20 => Loss 0.634, Loss_clf 0.286, Loss_aux 0.348, Train_accy 91.97:  55%|█████▌    | 11/20 [03:20<02:34, 17.15s/it]                 
Task 1, Epoch 12/20 => Loss 0.634, Loss_clf 0.286, Loss_aux 0.348, Train_accy 91.97:  60%|██████    | 12/20 [03:20<02:13, 16.75s/it]
Task 1, Epoch 13/20 => Loss 0.406, Loss_clf 0.198, Loss_aux 0.208, Train_accy 93.68:  60%|██████    | 12/20 [03:36<02:13, 16.75s/it]
Task 1, Epoch 13/20 => Loss 0.406, Loss_clf 0.198, Loss_aux 0.208, Train_accy 93.68:  65%|██████▌   | 13/20 [03:36<01:55, 16.48s/it]
Task 1, Epoch 14/20 => Loss 0.426, Loss_clf 0.231, Loss_aux 0.196, Train_accy 93.61:  65%|██████▌   | 13/20 [03:52<01:55, 16.48s/it]
Task 1, Epoch 14/20 => Loss 0.426, Loss_clf 0.231, Loss_aux 0.196, Train_accy 93.61:  70%|███████   | 14/20 [03:52<01:37, 16.29s/it]
Task 1, Epoch 15/20 => Loss 0.623, Loss_clf 0.337, Loss_aux 0.287, Train_accy 92.42:  70%|███████   | 14/20 [04:08<01:37, 16.29s/it]
Task 1, Epoch 15/20 => Loss 0.623, Loss_clf 0.337, Loss_aux 0.287, Train_accy 92.42:  75%|███████▌  | 15/20 [04:08<01:20, 16.16s/it]
Task 1, Epoch 16/20 => Loss 1.928, Loss_clf 0.746, Loss_aux 1.182, Train_accy 82.97, Test_accy 84.80:  75%|███████▌  | 15/20 [04:27<01:20, 16.16s/it]
Task 1, Epoch 16/20 => Loss 1.928, Loss_clf 0.746, Loss_aux 1.182, Train_accy 82.97, Test_accy 84.80:  80%|████████  | 16/20 [04:27<01:08, 17.05s/it]
Task 1, Epoch 17/20 => Loss 1.363, Loss_clf 0.432, Loss_aux 0.931, Train_accy 88.18:  80%|████████  | 16/20 [04:43<01:08, 17.05s/it]                 
Task 1, Epoch 17/20 => Loss 1.363, Loss_clf 0.432, Loss_aux 0.931, Train_accy 88.18:  85%|████████▌ | 17/20 [04:43<00:50, 16.70s/it]
Task 1, Epoch 18/20 => Loss 1.089, Loss_clf 0.319, Loss_aux 0.770, Train_accy 90.04:  85%|████████▌ | 17/20 [04:59<00:50, 16.70s/it]
Task 1, Epoch 18/20 => Loss 1.089, Loss_clf 0.319, Loss_aux 0.770, Train_accy 90.04:  90%|█████████ | 18/20 [04:59<00:32, 16.45s/it]
Task 1, Epoch 19/20 => Loss 0.712, Loss_clf 0.278, Loss_aux 0.434, Train_accy 91.45:  90%|█████████ | 18/20 [05:15<00:32, 16.45s/it]
Task 1, Epoch 19/20 => Loss 0.712, Loss_clf 0.278, Loss_aux 0.434, Train_accy 91.45:  95%|█████████▌| 19/20 [05:15<00:16, 16.27s/it]
Task 1, Epoch 20/20 => Loss 0.564, Loss_clf 0.244, Loss_aux 0.320, Train_accy 92.27:  95%|█████████▌| 19/20 [05:31<00:16, 16.27s/it]
Task 1, Epoch 20/20 => Loss 0.564, Loss_clf 0.244, Loss_aux 0.320, Train_accy 92.27: 100%|██████████| 20/20 [05:31<00:00, 16.15s/it]
Task 1, Epoch 20/20 => Loss 0.564, Loss_clf 0.244, Loss_aux 0.320, Train_accy 92.27: 100%|██████████| 20/20 [05:31<00:00, 16.56s/it]2024-09-12 10:11:52,900 [der.py] => Task 1, Epoch 20/20 => Loss 0.564, Loss_clf 0.244, Loss_aux 0.320, Train_accy 92.27
2024-09-12 10:11:52,902 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 10:12:34,176 [der.py] => Exemplar size: 800
2024-09-12 10:12:34,176 [trainer.py] => CNN: {'total': 92.07, '00-19': 93.12, '20-39': 90.82, 'old': 93.12, 'new': 90.82}
2024-09-12 10:12:34,177 [trainer.py] => NME: {'total': 93.83, '00-19': 96.36, '20-39': 90.82, 'old': 96.36, 'new': 90.82}
2024-09-12 10:12:34,177 [trainer.py] => CNN top1 curve: [97.17, 92.07]
2024-09-12 10:12:34,177 [trainer.py] => CNN top5 curve: [100.0, 99.34]
2024-09-12 10:12:34,177 [trainer.py] => NME top1 curve: [98.38, 93.83]
2024-09-12 10:12:34,177 [trainer.py] => NME top5 curve: [100.0, 99.56]

Average Accuracy (CNN): 94.62
Average Accuracy (NME): 96.1
2024-09-12 10:12:34,177 [trainer.py] => Average Accuracy (CNN): 94.62
2024-09-12 10:12:34,177 [trainer.py] => Average Accuracy (NME): 96.1
2024-09-12 10:12:34,178 [trainer.py] => All params: 171674941
2024-09-12 10:12:34,179 [trainer.py] => Trainable params: 85876285
2024-09-12 10:12:35,956 [der.py] => Learning on 40-60
2024-09-12 10:12:35,959 [der.py] => All params: 257550417
2024-09-12 10:12:35,961 [der.py] => Trainable params: 85953105

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.671, Loss_clf 1.976, Loss_aux 1.695, Train_accy 60.87, Test_accy 86.16:   0%|          | 0/20 [00:32<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.671, Loss_clf 1.976, Loss_aux 1.695, Train_accy 60.87, Test_accy 86.16:   5%|▌         | 1/20 [00:32<10:10, 32.15s/it]
Task 2, Epoch 2/20 => Loss 1.153, Loss_clf 0.541, Loss_aux 0.612, Train_accy 84.97:   5%|▌         | 1/20 [00:57<10:10, 32.15s/it]                 
Task 2, Epoch 2/20 => Loss 1.153, Loss_clf 0.541, Loss_aux 0.612, Train_accy 84.97:  10%|█         | 2/20 [00:57<08:27, 28.21s/it]
Task 2, Epoch 3/20 => Loss 0.992, Loss_clf 0.491, Loss_aux 0.502, Train_accy 85.89:  10%|█         | 2/20 [01:23<08:27, 28.21s/it]
Task 2, Epoch 3/20 => Loss 0.992, Loss_clf 0.491, Loss_aux 0.502, Train_accy 85.89:  15%|█▌        | 3/20 [01:23<07:38, 26.99s/it]
Task 2, Epoch 4/20 => Loss 0.784, Loss_clf 0.404, Loss_aux 0.380, Train_accy 87.95:  15%|█▌        | 3/20 [01:48<07:38, 26.99s/it]
Task 2, Epoch 4/20 => Loss 0.784, Loss_clf 0.404, Loss_aux 0.380, Train_accy 87.95:  20%|██        | 4/20 [01:48<07:03, 26.44s/it]
Task 2, Epoch 5/20 => Loss 0.739, Loss_clf 0.390, Loss_aux 0.349, Train_accy 89.50:  20%|██        | 4/20 [02:14<07:03, 26.44s/it]
Task 2, Epoch 5/20 => Loss 0.739, Loss_clf 0.390, Loss_aux 0.349, Train_accy 89.50:  25%|██▌       | 5/20 [02:14<06:31, 26.13s/it]
Task 2, Epoch 6/20 => Loss 0.620, Loss_clf 0.331, Loss_aux 0.289, Train_accy 90.76, Test_accy 89.29:  25%|██▌       | 5/20 [02:46<06:31, 26.13s/it]
Task 2, Epoch 6/20 => Loss 0.620, Loss_clf 0.331, Loss_aux 0.289, Train_accy 90.76, Test_accy 89.29:  30%|███       | 6/20 [02:46<06:34, 28.19s/it]
Task 2, Epoch 7/20 => Loss 0.690, Loss_clf 0.366, Loss_aux 0.324, Train_accy 89.16:  30%|███       | 6/20 [03:12<06:34, 28.19s/it]                 
Task 2, Epoch 7/20 => Loss 0.690, Loss_clf 0.366, Loss_aux 0.324, Train_accy 89.16:  35%|███▌      | 7/20 [03:12<05:55, 27.35s/it]
Task 2, Epoch 8/20 => Loss 0.613, Loss_clf 0.321, Loss_aux 0.291, Train_accy 90.76:  35%|███▌      | 7/20 [03:37<05:55, 27.35s/it]
Task 2, Epoch 8/20 => Loss 0.613, Loss_clf 0.321, Loss_aux 0.291, Train_accy 90.76:  40%|████      | 8/20 [03:37<05:21, 26.78s/it]
Task 2, Epoch 9/20 => Loss 0.615, Loss_clf 0.322, Loss_aux 0.293, Train_accy 90.25:  40%|████      | 8/20 [04:03<05:21, 26.78s/it]
Task 2, Epoch 9/20 => Loss 0.615, Loss_clf 0.322, Loss_aux 0.293, Train_accy 90.25:  45%|████▌     | 9/20 [04:03<04:50, 26.38s/it]
Task 2, Epoch 10/20 => Loss 0.620, Loss_clf 0.338, Loss_aux 0.282, Train_accy 90.99:  45%|████▌     | 9/20 [04:28<04:50, 26.38s/it]
Task 2, Epoch 10/20 => Loss 0.620, Loss_clf 0.338, Loss_aux 0.282, Train_accy 90.99:  50%|█████     | 10/20 [04:28<04:21, 26.12s/it]
Task 2, Epoch 11/20 => Loss 0.504, Loss_clf 0.272, Loss_aux 0.232, Train_accy 92.31, Test_accy 90.48:  50%|█████     | 10/20 [05:01<04:21, 26.12s/it]
Task 2, Epoch 11/20 => Loss 0.504, Loss_clf 0.272, Loss_aux 0.232, Train_accy 92.31, Test_accy 90.48:  55%|█████▌    | 11/20 [05:01<04:12, 28.01s/it]
Task 2, Epoch 12/20 => Loss 0.642, Loss_clf 0.332, Loss_aux 0.309, Train_accy 91.11:  55%|█████▌    | 11/20 [05:26<04:12, 28.01s/it]                 
Task 2, Epoch 12/20 => Loss 0.642, Loss_clf 0.332, Loss_aux 0.309, Train_accy 91.11:  60%|██████    | 12/20 [05:26<03:37, 27.24s/it]
Task 2, Epoch 13/20 => Loss 0.549, Loss_clf 0.317, Loss_aux 0.232, Train_accy 91.16:  60%|██████    | 12/20 [05:52<03:37, 27.24s/it]
Task 2, Epoch 13/20 => Loss 0.549, Loss_clf 0.317, Loss_aux 0.232, Train_accy 91.16:  65%|██████▌   | 13/20 [05:52<03:07, 26.72s/it]
Task 2, Epoch 14/20 => Loss 0.511, Loss_clf 0.283, Loss_aux 0.228, Train_accy 92.37:  65%|██████▌   | 13/20 [06:17<03:07, 26.72s/it]
Task 2, Epoch 14/20 => Loss 0.511, Loss_clf 0.283, Loss_aux 0.228, Train_accy 92.37:  70%|███████   | 14/20 [06:17<02:38, 26.35s/it]
Task 2, Epoch 15/20 => Loss 0.479, Loss_clf 0.271, Loss_aux 0.208, Train_accy 92.94:  70%|███████   | 14/20 [06:43<02:38, 26.35s/it]
Task 2, Epoch 15/20 => Loss 0.479, Loss_clf 0.271, Loss_aux 0.208, Train_accy 92.94:  75%|███████▌  | 15/20 [06:43<02:10, 26.13s/it]
Task 2, Epoch 16/20 => Loss 0.540, Loss_clf 0.302, Loss_aux 0.238, Train_accy 91.39, Test_accy 90.03:  75%|███████▌  | 15/20 [07:15<02:10, 26.13s/it]
Task 2, Epoch 16/20 => Loss 0.540, Loss_clf 0.302, Loss_aux 0.238, Train_accy 91.39, Test_accy 90.03:  80%|████████  | 16/20 [07:15<01:52, 28.03s/it]
Task 2, Epoch 17/20 => Loss 0.496, Loss_clf 0.264, Loss_aux 0.231, Train_accy 92.43:  80%|████████  | 16/20 [07:41<01:52, 28.03s/it]                 
Task 2, Epoch 17/20 => Loss 0.496, Loss_clf 0.264, Loss_aux 0.231, Train_accy 92.43:  85%|████████▌ | 17/20 [07:41<01:21, 27.30s/it]
Task 2, Epoch 18/20 => Loss 0.472, Loss_clf 0.255, Loss_aux 0.217, Train_accy 92.54:  85%|████████▌ | 17/20 [08:06<01:21, 27.30s/it]
Task 2, Epoch 18/20 => Loss 0.472, Loss_clf 0.255, Loss_aux 0.217, Train_accy 92.54:  90%|█████████ | 18/20 [08:06<00:53, 26.83s/it]
Task 2, Epoch 19/20 => Loss 0.482, Loss_clf 0.256, Loss_aux 0.226, Train_accy 92.48:  90%|█████████ | 18/20 [08:32<00:53, 26.83s/it]
Task 2, Epoch 19/20 => Loss 0.482, Loss_clf 0.256, Loss_aux 0.226, Train_accy 92.48:  95%|█████████▌| 19/20 [08:32<00:26, 26.50s/it]
Task 2, Epoch 20/20 => Loss 0.545, Loss_clf 0.290, Loss_aux 0.255, Train_accy 91.45:  95%|█████████▌| 19/20 [08:58<00:26, 26.50s/it]
Task 2, Epoch 20/20 => Loss 0.545, Loss_clf 0.290, Loss_aux 0.255, Train_accy 91.45: 100%|██████████| 20/20 [08:58<00:00, 26.26s/it]
Task 2, Epoch 20/20 => Loss 0.545, Loss_clf 0.290, Loss_aux 0.255, Train_accy 91.45: 100%|██████████| 20/20 [08:58<00:00, 26.92s/it]2024-09-12 10:21:34,377 [der.py] => Task 2, Epoch 20/20 => Loss 0.545, Loss_clf 0.290, Loss_aux 0.255, Train_accy 91.45
2024-09-12 10:21:34,379 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 10:22:40,233 [der.py] => Exemplar size: 1200
2024-09-12 10:22:40,234 [trainer.py] => CNN: {'total': 90.03, '00-19': 89.47, '20-39': 87.44, '40-59': 93.12, 'old': 88.55, 'new': 93.12}
2024-09-12 10:22:40,234 [trainer.py] => NME: {'total': 91.07, '00-19': 89.88, '20-39': 91.3, '40-59': 92.2, 'old': 90.53, 'new': 92.2}
2024-09-12 10:22:40,234 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03]
2024-09-12 10:22:40,234 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81]
2024-09-12 10:22:40,234 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07]
2024-09-12 10:22:40,234 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4]

Average Accuracy (CNN): 93.09
Average Accuracy (NME): 94.43
2024-09-12 10:22:40,234 [trainer.py] => Average Accuracy (CNN): 93.09
2024-09-12 10:22:40,234 [trainer.py] => Average Accuracy (NME): 94.43
2024-09-12 10:22:40,236 [trainer.py] => All params: 257550417
2024-09-12 10:22:40,237 [trainer.py] => Trainable params: 85953105
2024-09-12 10:22:42,261 [der.py] => Learning on 60-80
2024-09-12 10:22:42,265 [der.py] => All params: 343456613
2024-09-12 10:22:42,267 [der.py] => Trainable params: 86060645

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.081, Loss_clf 1.741, Loss_aux 1.340, Train_accy 67.85, Test_accy 82.37:   0%|          | 0/20 [00:49<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.081, Loss_clf 1.741, Loss_aux 1.340, Train_accy 67.85, Test_accy 82.37:   5%|▌         | 1/20 [00:49<15:37, 49.36s/it]
Task 3, Epoch 2/20 => Loss 0.974, Loss_clf 0.490, Loss_aux 0.484, Train_accy 86.39:   5%|▌         | 1/20 [01:27<15:37, 49.36s/it]                 
Task 3, Epoch 2/20 => Loss 0.974, Loss_clf 0.490, Loss_aux 0.484, Train_accy 86.39:  10%|█         | 2/20 [01:27<12:45, 42.52s/it]
Task 3, Epoch 3/20 => Loss 0.840, Loss_clf 0.448, Loss_aux 0.392, Train_accy 86.95:  10%|█         | 2/20 [02:04<12:45, 42.52s/it]
Task 3, Epoch 3/20 => Loss 0.840, Loss_clf 0.448, Loss_aux 0.392, Train_accy 86.95:  15%|█▌        | 3/20 [02:04<11:26, 40.37s/it]
Task 3, Epoch 4/20 => Loss 0.827, Loss_clf 0.467, Loss_aux 0.360, Train_accy 87.56:  15%|█▌        | 3/20 [02:42<11:26, 40.37s/it]
Task 3, Epoch 4/20 => Loss 0.827, Loss_clf 0.467, Loss_aux 0.360, Train_accy 87.56:  20%|██        | 4/20 [02:42<10:30, 39.38s/it]
Task 3, Epoch 5/20 => Loss 0.690, Loss_clf 0.393, Loss_aux 0.297, Train_accy 88.58:  20%|██        | 4/20 [03:20<10:30, 39.38s/it]
Task 3, Epoch 5/20 => Loss 0.690, Loss_clf 0.393, Loss_aux 0.297, Train_accy 88.58:  25%|██▌       | 5/20 [03:20<09:42, 38.82s/it]
Task 3, Epoch 6/20 => Loss 0.636, Loss_clf 0.351, Loss_aux 0.285, Train_accy 89.10, Test_accy 87.16:  25%|██▌       | 5/20 [04:10<09:42, 38.82s/it]
Task 3, Epoch 6/20 => Loss 0.636, Loss_clf 0.351, Loss_aux 0.285, Train_accy 89.10, Test_accy 87.16:  30%|███       | 6/20 [04:10<09:53, 42.43s/it]
Task 3, Epoch 7/20 => Loss 0.621, Loss_clf 0.351, Loss_aux 0.269, Train_accy 89.98:  30%|███       | 6/20 [04:47<09:53, 42.43s/it]                 
Task 3, Epoch 7/20 => Loss 0.621, Loss_clf 0.351, Loss_aux 0.269, Train_accy 89.98:  35%|███▌      | 7/20 [04:47<08:51, 40.91s/it]
Task 3, Epoch 8/20 => Loss 0.576, Loss_clf 0.334, Loss_aux 0.242, Train_accy 90.17:  35%|███▌      | 7/20 [05:25<08:51, 40.91s/it]
Task 3, Epoch 8/20 => Loss 0.576, Loss_clf 0.334, Loss_aux 0.242, Train_accy 90.17:  40%|████      | 8/20 [05:25<07:58, 39.89s/it]
Task 3, Epoch 9/20 => Loss 0.627, Loss_clf 0.362, Loss_aux 0.265, Train_accy 89.00:  40%|████      | 8/20 [06:03<07:58, 39.89s/it]
Task 3, Epoch 9/20 => Loss 0.627, Loss_clf 0.362, Loss_aux 0.265, Train_accy 89.00:  45%|████▌     | 9/20 [06:03<07:11, 39.22s/it]
Task 3, Epoch 10/20 => Loss 0.533, Loss_clf 0.332, Loss_aux 0.201, Train_accy 90.87:  45%|████▌     | 9/20 [06:40<07:11, 39.22s/it]
Task 3, Epoch 10/20 => Loss 0.533, Loss_clf 0.332, Loss_aux 0.201, Train_accy 90.87:  50%|█████     | 10/20 [06:40<06:27, 38.76s/it]
Task 3, Epoch 11/20 => Loss 0.553, Loss_clf 0.319, Loss_aux 0.234, Train_accy 91.47, Test_accy 88.03:  50%|█████     | 10/20 [07:30<06:27, 38.76s/it]
Task 3, Epoch 11/20 => Loss 0.553, Loss_clf 0.319, Loss_aux 0.234, Train_accy 91.47, Test_accy 88.03:  55%|█████▌    | 11/20 [07:30<06:18, 42.06s/it]
Task 3, Epoch 12/20 => Loss 0.516, Loss_clf 0.302, Loss_aux 0.214, Train_accy 91.24:  55%|█████▌    | 11/20 [08:08<06:18, 42.06s/it]                 
Task 3, Epoch 12/20 => Loss 0.516, Loss_clf 0.302, Loss_aux 0.214, Train_accy 91.24:  60%|██████    | 12/20 [08:08<05:26, 40.77s/it]
Task 3, Epoch 13/20 => Loss 0.465, Loss_clf 0.297, Loss_aux 0.168, Train_accy 92.22:  60%|██████    | 12/20 [08:46<05:26, 40.77s/it]
Task 3, Epoch 13/20 => Loss 0.465, Loss_clf 0.297, Loss_aux 0.168, Train_accy 92.22:  65%|██████▌   | 13/20 [08:46<04:38, 39.84s/it]
Task 3, Epoch 14/20 => Loss 0.503, Loss_clf 0.299, Loss_aux 0.203, Train_accy 91.57:  65%|██████▌   | 13/20 [09:23<04:38, 39.84s/it]
Task 3, Epoch 14/20 => Loss 0.503, Loss_clf 0.299, Loss_aux 0.203, Train_accy 91.57:  70%|███████   | 14/20 [09:23<03:55, 39.19s/it]
Task 3, Epoch 15/20 => Loss 0.482, Loss_clf 0.289, Loss_aux 0.194, Train_accy 91.94:  70%|███████   | 14/20 [10:01<03:55, 39.19s/it]
Task 3, Epoch 15/20 => Loss 0.482, Loss_clf 0.289, Loss_aux 0.194, Train_accy 91.94:  75%|███████▌  | 15/20 [10:01<03:13, 38.74s/it]
Task 3, Epoch 16/20 => Loss 0.507, Loss_clf 0.320, Loss_aux 0.187, Train_accy 91.43, Test_accy 88.14:  75%|███████▌  | 15/20 [10:50<03:13, 38.74s/it]
Task 3, Epoch 16/20 => Loss 0.507, Loss_clf 0.320, Loss_aux 0.187, Train_accy 91.43, Test_accy 88.14:  80%|████████  | 16/20 [10:50<02:47, 41.95s/it]
Task 3, Epoch 17/20 => Loss 0.502, Loss_clf 0.309, Loss_aux 0.193, Train_accy 92.12:  80%|████████  | 16/20 [11:28<02:47, 41.95s/it]                 
Task 3, Epoch 17/20 => Loss 0.502, Loss_clf 0.309, Loss_aux 0.193, Train_accy 92.12:  85%|████████▌ | 17/20 [11:28<02:01, 40.66s/it]
Task 3, Epoch 18/20 => Loss 0.436, Loss_clf 0.259, Loss_aux 0.176, Train_accy 92.92:  85%|████████▌ | 17/20 [12:06<02:01, 40.66s/it]
Task 3, Epoch 18/20 => Loss 0.436, Loss_clf 0.259, Loss_aux 0.176, Train_accy 92.92:  90%|█████████ | 18/20 [12:06<01:19, 39.75s/it]
Task 3, Epoch 19/20 => Loss 0.449, Loss_clf 0.282, Loss_aux 0.167, Train_accy 92.17:  90%|█████████ | 18/20 [12:43<01:19, 39.75s/it]
Task 3, Epoch 19/20 => Loss 0.449, Loss_clf 0.282, Loss_aux 0.167, Train_accy 92.17:  95%|█████████▌| 19/20 [12:43<00:39, 39.13s/it]
Task 3, Epoch 20/20 => Loss 0.437, Loss_clf 0.253, Loss_aux 0.184, Train_accy 92.87:  95%|█████████▌| 19/20 [13:21<00:39, 39.13s/it]
Task 3, Epoch 20/20 => Loss 0.437, Loss_clf 0.253, Loss_aux 0.184, Train_accy 92.87: 100%|██████████| 20/20 [13:21<00:00, 38.73s/it]
Task 3, Epoch 20/20 => Loss 0.437, Loss_clf 0.253, Loss_aux 0.184, Train_accy 92.87: 100%|██████████| 20/20 [13:21<00:00, 40.08s/it]2024-09-12 10:36:03,954 [der.py] => Task 3, Epoch 20/20 => Loss 0.437, Loss_clf 0.253, Loss_aux 0.184, Train_accy 92.87
2024-09-12 10:36:03,955 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 10:37:37,731 [der.py] => Exemplar size: 1600
2024-09-12 10:37:37,731 [trainer.py] => CNN: {'total': 88.9, '00-19': 85.83, '20-39': 86.47, '40-59': 91.28, '60-79': 91.9, 'old': 87.8, 'new': 91.9}
2024-09-12 10:37:37,731 [trainer.py] => NME: {'total': 88.9, '00-19': 85.02, '20-39': 88.89, '40-59': 90.37, '60-79': 91.5, 'old': 87.95, 'new': 91.5}
2024-09-12 10:37:37,731 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03, 88.9]
2024-09-12 10:37:37,732 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.8]
2024-09-12 10:37:37,732 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07, 88.9]
2024-09-12 10:37:37,732 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 98.8]

Average Accuracy (CNN): 92.04
Average Accuracy (NME): 93.04
2024-09-12 10:37:37,732 [trainer.py] => Average Accuracy (CNN): 92.04
2024-09-12 10:37:37,732 [trainer.py] => Average Accuracy (NME): 93.04
2024-09-12 10:37:37,734 [trainer.py] => All params: 343456613
2024-09-12 10:37:37,736 [trainer.py] => Trainable params: 86060645
2024-09-12 10:37:39,414 [der.py] => Learning on 80-100
2024-09-12 10:37:39,420 [der.py] => All params: 429393529
2024-09-12 10:37:39,422 [der.py] => Trainable params: 86198905

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.892, Loss_clf 1.492, Loss_aux 1.400, Train_accy 74.70, Test_accy 86.36:   0%|          | 0/20 [01:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.892, Loss_clf 1.492, Loss_aux 1.400, Train_accy 74.70, Test_accy 86.36:   5%|▌         | 1/20 [01:09<22:06, 69.81s/it]
Task 4, Epoch 2/20 => Loss 0.918, Loss_clf 0.473, Loss_aux 0.445, Train_accy 86.36:   5%|▌         | 1/20 [02:01<22:06, 69.81s/it]                 
Task 4, Epoch 2/20 => Loss 0.918, Loss_clf 0.473, Loss_aux 0.445, Train_accy 86.36:  10%|█         | 2/20 [02:01<17:42, 59.02s/it]
Task 4, Epoch 3/20 => Loss 0.774, Loss_clf 0.415, Loss_aux 0.360, Train_accy 88.39:  10%|█         | 2/20 [02:52<17:42, 59.02s/it]
Task 4, Epoch 3/20 => Loss 0.774, Loss_clf 0.415, Loss_aux 0.360, Train_accy 88.39:  15%|█▌        | 3/20 [02:52<15:45, 55.63s/it]
Task 4, Epoch 4/20 => Loss 0.683, Loss_clf 0.388, Loss_aux 0.294, Train_accy 89.06:  15%|█▌        | 3/20 [03:44<15:45, 55.63s/it]
Task 4, Epoch 4/20 => Loss 0.683, Loss_clf 0.388, Loss_aux 0.294, Train_accy 89.06:  20%|██        | 4/20 [03:44<14:24, 54.03s/it]
Task 4, Epoch 5/20 => Loss 0.646, Loss_clf 0.394, Loss_aux 0.251, Train_accy 88.54:  20%|██        | 4/20 [04:35<14:24, 54.03s/it]
Task 4, Epoch 5/20 => Loss 0.646, Loss_clf 0.394, Loss_aux 0.251, Train_accy 88.54:  25%|██▌       | 5/20 [04:35<13:15, 53.03s/it]
Task 4, Epoch 6/20 => Loss 0.606, Loss_clf 0.373, Loss_aux 0.232, Train_accy 90.10, Test_accy 86.20:  25%|██▌       | 5/20 [05:37<13:15, 53.03s/it]
Task 4, Epoch 6/20 => Loss 0.606, Loss_clf 0.373, Loss_aux 0.232, Train_accy 90.10, Test_accy 86.20:  30%|███       | 6/20 [05:37<13:03, 55.96s/it]
Task 4, Epoch 7/20 => Loss 0.542, Loss_clf 0.322, Loss_aux 0.219, Train_accy 90.41:  30%|███       | 6/20 [06:22<13:03, 55.96s/it]                 
Task 4, Epoch 7/20 => Loss 0.542, Loss_clf 0.322, Loss_aux 0.219, Train_accy 90.41:  35%|███▌      | 7/20 [06:22<11:22, 52.51s/it]
Task 4, Epoch 8/20 => Loss 0.562, Loss_clf 0.346, Loss_aux 0.216, Train_accy 90.37:  35%|███▌      | 7/20 [07:07<11:22, 52.51s/it]
Task 4, Epoch 8/20 => Loss 0.562, Loss_clf 0.346, Loss_aux 0.216, Train_accy 90.37:  40%|████      | 8/20 [07:07<10:01, 50.14s/it]
Task 4, Epoch 9/20 => Loss 0.508, Loss_clf 0.334, Loss_aux 0.174, Train_accy 90.73:  40%|████      | 8/20 [07:53<10:01, 50.14s/it]
Task 4, Epoch 9/20 => Loss 0.508, Loss_clf 0.334, Loss_aux 0.174, Train_accy 90.73:  45%|████▌     | 9/20 [07:53<08:54, 48.60s/it]
Task 4, Epoch 10/20 => Loss 0.531, Loss_clf 0.331, Loss_aux 0.200, Train_accy 91.25:  45%|████▌     | 9/20 [08:38<08:54, 48.60s/it]
Task 4, Epoch 10/20 => Loss 0.531, Loss_clf 0.331, Loss_aux 0.200, Train_accy 91.25:  50%|█████     | 10/20 [08:38<07:55, 47.55s/it]
Task 4, Epoch 11/20 => Loss 0.488, Loss_clf 0.317, Loss_aux 0.171, Train_accy 91.49, Test_accy 88.13:  50%|█████     | 10/20 [09:39<07:55, 47.55s/it]
Task 4, Epoch 11/20 => Loss 0.488, Loss_clf 0.317, Loss_aux 0.171, Train_accy 91.49, Test_accy 88.13:  55%|█████▌    | 11/20 [09:39<07:46, 51.86s/it]
Task 4, Epoch 12/20 => Loss 0.490, Loss_clf 0.325, Loss_aux 0.165, Train_accy 91.77:  55%|█████▌    | 11/20 [10:25<07:46, 51.86s/it]                 
Task 4, Epoch 12/20 => Loss 0.490, Loss_clf 0.325, Loss_aux 0.165, Train_accy 91.77:  60%|██████    | 12/20 [10:25<06:38, 49.86s/it]
Task 4, Epoch 13/20 => Loss 0.472, Loss_clf 0.307, Loss_aux 0.165, Train_accy 91.45:  60%|██████    | 12/20 [11:10<06:38, 49.86s/it]
Task 4, Epoch 13/20 => Loss 0.472, Loss_clf 0.307, Loss_aux 0.165, Train_accy 91.45:  65%|██████▌   | 13/20 [11:10<05:39, 48.47s/it]
Task 4, Epoch 14/20 => Loss 0.504, Loss_clf 0.313, Loss_aux 0.191, Train_accy 91.37:  65%|██████▌   | 13/20 [11:55<05:39, 48.47s/it]
Task 4, Epoch 14/20 => Loss 0.504, Loss_clf 0.313, Loss_aux 0.191, Train_accy 91.37:  70%|███████   | 14/20 [11:55<04:44, 47.50s/it]
Task 4, Epoch 15/20 => Loss 0.469, Loss_clf 0.308, Loss_aux 0.161, Train_accy 91.49:  70%|███████   | 14/20 [12:41<04:44, 47.50s/it]
Task 4, Epoch 15/20 => Loss 0.469, Loss_clf 0.308, Loss_aux 0.161, Train_accy 91.49:  75%|███████▌  | 15/20 [12:41<03:54, 46.85s/it]
Task 4, Epoch 16/20 => Loss 0.427, Loss_clf 0.273, Loss_aux 0.154, Train_accy 92.40, Test_accy 88.05:  75%|███████▌  | 15/20 [13:42<03:54, 46.85s/it]
Task 4, Epoch 16/20 => Loss 0.427, Loss_clf 0.273, Loss_aux 0.154, Train_accy 92.40, Test_accy 88.05:  80%|████████  | 16/20 [13:42<03:25, 51.28s/it]
Task 4, Epoch 17/20 => Loss 0.446, Loss_clf 0.283, Loss_aux 0.162, Train_accy 92.16:  80%|████████  | 16/20 [14:27<03:25, 51.28s/it]                 
Task 4, Epoch 17/20 => Loss 0.446, Loss_clf 0.283, Loss_aux 0.162, Train_accy 92.16:  85%|████████▌ | 17/20 [14:27<02:28, 49.47s/it]
Task 4, Epoch 18/20 => Loss 0.427, Loss_clf 0.280, Loss_aux 0.146, Train_accy 92.36:  85%|████████▌ | 17/20 [15:13<02:28, 49.47s/it]
Task 4, Epoch 18/20 => Loss 0.427, Loss_clf 0.280, Loss_aux 0.146, Train_accy 92.36:  90%|█████████ | 18/20 [15:13<01:36, 48.19s/it]
Task 4, Epoch 19/20 => Loss 0.461, Loss_clf 0.305, Loss_aux 0.155, Train_accy 91.85:  90%|█████████ | 18/20 [15:58<01:36, 48.19s/it]
Task 4, Epoch 19/20 => Loss 0.461, Loss_clf 0.305, Loss_aux 0.155, Train_accy 91.85:  95%|█████████▌| 19/20 [15:58<00:47, 47.30s/it]
Task 4, Epoch 20/20 => Loss 0.464, Loss_clf 0.308, Loss_aux 0.156, Train_accy 92.00:  95%|█████████▌| 19/20 [16:43<00:47, 47.30s/it]
Task 4, Epoch 20/20 => Loss 0.464, Loss_clf 0.308, Loss_aux 0.156, Train_accy 92.00: 100%|██████████| 20/20 [16:43<00:00, 46.71s/it]
Task 4, Epoch 20/20 => Loss 0.464, Loss_clf 0.308, Loss_aux 0.156, Train_accy 92.00: 100%|██████████| 20/20 [16:43<00:00, 50.18s/it]2024-09-12 10:54:23,141 [der.py] => Task 4, Epoch 20/20 => Loss 0.464, Loss_clf 0.308, Loss_aux 0.156, Train_accy 92.00
2024-09-12 10:54:23,143 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 10:56:26,754 [der.py] => Exemplar size: 2000
2024-09-12 10:56:26,754 [trainer.py] => CNN: {'total': 88.22, '00-19': 85.02, '20-39': 83.57, '40-59': 90.37, '60-79': 87.45, '80-99': 93.68, 'old': 86.62, 'new': 93.68}
2024-09-12 10:56:26,754 [trainer.py] => NME: {'total': 88.89, '00-19': 83.4, '20-39': 87.44, '40-59': 90.37, '60-79': 91.5, '80-99': 91.45, 'old': 88.14, 'new': 91.45}
2024-09-12 10:56:26,754 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03, 88.9, 88.22]
2024-09-12 10:56:26,754 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.8, 98.4]
2024-09-12 10:56:26,754 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07, 88.9, 88.89]
2024-09-12 10:56:26,755 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 98.8, 98.82]

Average Accuracy (CNN): 91.28
Average Accuracy (NME): 92.21
2024-09-12 10:56:26,755 [trainer.py] => Average Accuracy (CNN): 91.28
2024-09-12 10:56:26,755 [trainer.py] => Average Accuracy (NME): 92.21
2024-09-12 10:56:26,758 [trainer.py] => All params: 429393529
2024-09-12 10:56:26,761 [trainer.py] => Trainable params: 86198905
2024-09-12 10:56:28,448 [der.py] => Learning on 100-120
2024-09-12 10:56:28,460 [der.py] => All params: 515361165
2024-09-12 10:56:28,465 [der.py] => Trainable params: 86367885

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.412, Loss_clf 1.347, Loss_aux 1.065, Train_accy 76.22, Test_accy 82.42:   0%|          | 0/20 [01:23<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.412, Loss_clf 1.347, Loss_aux 1.065, Train_accy 76.22, Test_accy 82.42:   5%|▌         | 1/20 [01:23<26:27, 83.56s/it]
Task 5, Epoch 2/20 => Loss 0.837, Loss_clf 0.463, Loss_aux 0.373, Train_accy 86.59:   5%|▌         | 1/20 [02:24<26:27, 83.56s/it]                 
Task 5, Epoch 2/20 => Loss 0.837, Loss_clf 0.463, Loss_aux 0.373, Train_accy 86.59:  10%|█         | 2/20 [02:24<21:01, 70.10s/it]
Task 5, Epoch 3/20 => Loss 0.704, Loss_clf 0.414, Loss_aux 0.289, Train_accy 88.62:  10%|█         | 2/20 [03:24<21:01, 70.10s/it]
Task 5, Epoch 3/20 => Loss 0.704, Loss_clf 0.414, Loss_aux 0.289, Train_accy 88.62:  15%|█▌        | 3/20 [03:24<18:38, 65.77s/it]
Task 5, Epoch 4/20 => Loss 0.687, Loss_clf 0.424, Loss_aux 0.264, Train_accy 88.18:  15%|█▌        | 3/20 [04:25<18:38, 65.77s/it]
Task 5, Epoch 4/20 => Loss 0.687, Loss_clf 0.424, Loss_aux 0.264, Train_accy 88.18:  20%|██        | 4/20 [04:25<16:59, 63.71s/it]
Task 5, Epoch 5/20 => Loss 0.597, Loss_clf 0.384, Loss_aux 0.213, Train_accy 89.16:  20%|██        | 4/20 [05:25<16:59, 63.71s/it]
Task 5, Epoch 5/20 => Loss 0.597, Loss_clf 0.384, Loss_aux 0.213, Train_accy 89.16:  25%|██▌       | 5/20 [05:25<15:38, 62.56s/it]
Task 5, Epoch 6/20 => Loss 0.544, Loss_clf 0.354, Loss_aux 0.190, Train_accy 90.18, Test_accy 84.39:  25%|██▌       | 5/20 [06:49<15:38, 62.56s/it]
Task 5, Epoch 6/20 => Loss 0.544, Loss_clf 0.354, Loss_aux 0.190, Train_accy 90.18, Test_accy 84.39:  30%|███       | 6/20 [06:49<16:15, 69.68s/it]
Task 5, Epoch 7/20 => Loss 0.552, Loss_clf 0.341, Loss_aux 0.211, Train_accy 90.21:  30%|███       | 6/20 [07:49<16:15, 69.68s/it]                 
Task 5, Epoch 7/20 => Loss 0.552, Loss_clf 0.341, Loss_aux 0.211, Train_accy 90.21:  35%|███▌      | 7/20 [07:49<14:26, 66.68s/it]
Task 5, Epoch 8/20 => Loss 0.540, Loss_clf 0.341, Loss_aux 0.198, Train_accy 90.62:  35%|███▌      | 7/20 [08:50<14:26, 66.68s/it]
Task 5, Epoch 8/20 => Loss 0.540, Loss_clf 0.341, Loss_aux 0.198, Train_accy 90.62:  40%|████      | 8/20 [08:50<12:56, 64.74s/it]
Task 5, Epoch 9/20 => Loss 0.528, Loss_clf 0.334, Loss_aux 0.195, Train_accy 90.72:  40%|████      | 8/20 [09:51<12:56, 64.74s/it]
Task 5, Epoch 9/20 => Loss 0.528, Loss_clf 0.334, Loss_aux 0.195, Train_accy 90.72:  45%|████▌     | 9/20 [09:51<11:37, 63.42s/it]
Task 5, Epoch 10/20 => Loss 0.499, Loss_clf 0.320, Loss_aux 0.179, Train_accy 91.87:  45%|████▌     | 9/20 [10:51<11:37, 63.42s/it]
Task 5, Epoch 10/20 => Loss 0.499, Loss_clf 0.320, Loss_aux 0.179, Train_accy 91.87:  50%|█████     | 10/20 [10:51<10:25, 62.55s/it]
Task 5, Epoch 11/20 => Loss 0.439, Loss_clf 0.298, Loss_aux 0.141, Train_accy 91.90, Test_accy 85.45:  50%|█████     | 10/20 [12:15<10:25, 62.55s/it]
Task 5, Epoch 11/20 => Loss 0.439, Loss_clf 0.298, Loss_aux 0.141, Train_accy 91.90, Test_accy 85.45:  55%|█████▌    | 11/20 [12:15<10:20, 68.96s/it]
Task 5, Epoch 12/20 => Loss 0.492, Loss_clf 0.335, Loss_aux 0.157, Train_accy 91.06:  55%|█████▌    | 11/20 [13:15<10:20, 68.96s/it]                 
Task 5, Epoch 12/20 => Loss 0.492, Loss_clf 0.335, Loss_aux 0.157, Train_accy 91.06:  60%|██████    | 12/20 [13:15<08:51, 66.42s/it]
Task 5, Epoch 13/20 => Loss 0.397, Loss_clf 0.259, Loss_aux 0.138, Train_accy 92.78:  60%|██████    | 12/20 [14:16<08:51, 66.42s/it]
Task 5, Epoch 13/20 => Loss 0.397, Loss_clf 0.259, Loss_aux 0.138, Train_accy 92.78:  65%|██████▌   | 13/20 [14:16<07:32, 64.65s/it]
Task 5, Epoch 14/20 => Loss 0.457, Loss_clf 0.308, Loss_aux 0.150, Train_accy 91.90:  65%|██████▌   | 13/20 [15:16<07:32, 64.65s/it]
Task 5, Epoch 14/20 => Loss 0.457, Loss_clf 0.308, Loss_aux 0.150, Train_accy 91.90:  70%|███████   | 14/20 [15:16<06:20, 63.40s/it]
Task 5, Epoch 15/20 => Loss 0.448, Loss_clf 0.302, Loss_aux 0.146, Train_accy 91.70:  70%|███████   | 14/20 [16:17<06:20, 63.40s/it]
Task 5, Epoch 15/20 => Loss 0.448, Loss_clf 0.302, Loss_aux 0.146, Train_accy 91.70:  75%|███████▌  | 15/20 [16:17<05:12, 62.56s/it]
Task 5, Epoch 16/20 => Loss 0.441, Loss_clf 0.293, Loss_aux 0.148, Train_accy 92.17, Test_accy 86.16:  75%|███████▌  | 15/20 [17:40<05:12, 62.56s/it]
Task 5, Epoch 16/20 => Loss 0.441, Loss_clf 0.293, Loss_aux 0.148, Train_accy 92.17, Test_accy 86.16:  80%|████████  | 16/20 [17:40<04:35, 68.84s/it]
Task 5, Epoch 17/20 => Loss 0.401, Loss_clf 0.272, Loss_aux 0.130, Train_accy 92.58:  80%|████████  | 16/20 [18:41<04:35, 68.84s/it]                 
Task 5, Epoch 17/20 => Loss 0.401, Loss_clf 0.272, Loss_aux 0.130, Train_accy 92.58:  85%|████████▌ | 17/20 [18:41<03:19, 66.34s/it]
Task 5, Epoch 18/20 => Loss 0.370, Loss_clf 0.246, Loss_aux 0.124, Train_accy 93.36:  85%|████████▌ | 17/20 [19:41<03:19, 66.34s/it]
Task 5, Epoch 18/20 => Loss 0.370, Loss_clf 0.246, Loss_aux 0.124, Train_accy 93.36:  90%|█████████ | 18/20 [19:41<02:09, 64.59s/it]
Task 5, Epoch 19/20 => Loss 0.421, Loss_clf 0.296, Loss_aux 0.125, Train_accy 92.21:  90%|█████████ | 18/20 [20:42<02:09, 64.59s/it]
Task 5, Epoch 19/20 => Loss 0.421, Loss_clf 0.296, Loss_aux 0.125, Train_accy 92.21:  95%|█████████▌| 19/20 [20:42<01:03, 63.37s/it]
Task 5, Epoch 20/20 => Loss 0.422, Loss_clf 0.287, Loss_aux 0.136, Train_accy 92.17:  95%|█████████▌| 19/20 [21:43<01:03, 63.37s/it]
Task 5, Epoch 20/20 => Loss 0.422, Loss_clf 0.287, Loss_aux 0.136, Train_accy 92.17: 100%|██████████| 20/20 [21:43<00:00, 62.56s/it]
Task 5, Epoch 20/20 => Loss 0.422, Loss_clf 0.287, Loss_aux 0.136, Train_accy 92.17: 100%|██████████| 20/20 [21:43<00:00, 65.16s/it]2024-09-12 11:18:11,697 [der.py] => Task 5, Epoch 20/20 => Loss 0.422, Loss_clf 0.287, Loss_aux 0.136, Train_accy 92.17
2024-09-12 11:18:11,699 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 11:20:52,846 [der.py] => Exemplar size: 2400
2024-09-12 11:20:52,846 [trainer.py] => CNN: {'total': 86.58, '00-19': 81.38, '20-39': 82.13, '40-59': 86.24, '60-79': 85.02, '80-99': 91.82, '100-119': 92.11, 'old': 85.52, 'new': 92.11}
2024-09-12 11:20:52,846 [trainer.py] => NME: {'total': 86.79, '00-19': 82.19, '20-39': 86.47, '40-59': 87.61, '60-79': 85.02, '80-99': 90.33, '100-119': 89.04, 'old': 86.36, 'new': 89.04}
2024-09-12 11:20:52,846 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03, 88.9, 88.22, 86.58]
2024-09-12 11:20:52,846 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.8, 98.4, 97.88]
2024-09-12 11:20:52,846 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07, 88.9, 88.89, 86.79]
2024-09-12 11:20:52,846 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 98.8, 98.82, 98.23]

Average Accuracy (CNN): 90.5
Average Accuracy (NME): 91.31
2024-09-12 11:20:52,846 [trainer.py] => Average Accuracy (CNN): 90.5
2024-09-12 11:20:52,847 [trainer.py] => Average Accuracy (NME): 91.31
2024-09-12 11:20:52,850 [trainer.py] => All params: 515361165
2024-09-12 11:20:52,853 [trainer.py] => Trainable params: 86367885
2024-09-12 11:20:54,527 [der.py] => Learning on 120-140
2024-09-12 11:20:54,535 [der.py] => All params: 601359521
2024-09-12 11:20:54,538 [der.py] => Trainable params: 86567585

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.136, Loss_clf 1.192, Loss_aux 0.944, Train_accy 78.00, Test_accy 82.27:   0%|          | 0/20 [01:48<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.136, Loss_clf 1.192, Loss_aux 0.944, Train_accy 78.00, Test_accy 82.27:   5%|▌         | 1/20 [01:48<34:14, 108.15s/it]
Task 6, Epoch 2/20 => Loss 0.865, Loss_clf 0.515, Loss_aux 0.350, Train_accy 85.60:   5%|▌         | 1/20 [03:05<34:14, 108.15s/it]                 
Task 6, Epoch 2/20 => Loss 0.865, Loss_clf 0.515, Loss_aux 0.350, Train_accy 85.60:  10%|█         | 2/20 [03:05<27:01, 90.11s/it] 
Task 6, Epoch 3/20 => Loss 0.743, Loss_clf 0.463, Loss_aux 0.279, Train_accy 88.01:  10%|█         | 2/20 [04:23<27:01, 90.11s/it]
Task 6, Epoch 3/20 => Loss 0.743, Loss_clf 0.463, Loss_aux 0.279, Train_accy 88.01:  15%|█▌        | 3/20 [04:23<23:54, 84.36s/it]
Task 6, Epoch 4/20 => Loss 0.639, Loss_clf 0.402, Loss_aux 0.237, Train_accy 89.09:  15%|█▌        | 3/20 [05:40<23:54, 84.36s/it]
Task 6, Epoch 4/20 => Loss 0.639, Loss_clf 0.402, Loss_aux 0.237, Train_accy 89.09:  20%|██        | 4/20 [05:40<21:46, 81.66s/it]
Task 6, Epoch 5/20 => Loss 0.544, Loss_clf 0.340, Loss_aux 0.204, Train_accy 90.64:  20%|██        | 4/20 [06:58<21:46, 81.66s/it]
Task 6, Epoch 5/20 => Loss 0.544, Loss_clf 0.340, Loss_aux 0.204, Train_accy 90.64:  25%|██▌       | 5/20 [06:58<20:04, 80.29s/it]
Task 6, Epoch 6/20 => Loss 0.582, Loss_clf 0.370, Loss_aux 0.212, Train_accy 89.98, Test_accy 84.03:  25%|██▌       | 5/20 [08:46<20:04, 80.29s/it]
Task 6, Epoch 6/20 => Loss 0.582, Loss_clf 0.370, Loss_aux 0.212, Train_accy 89.98, Test_accy 84.03:  30%|███       | 6/20 [08:46<20:57, 89.79s/it]
Task 6, Epoch 7/20 => Loss 0.576, Loss_clf 0.381, Loss_aux 0.195, Train_accy 89.95:  30%|███       | 6/20 [10:04<20:57, 89.79s/it]                 
Task 6, Epoch 7/20 => Loss 0.576, Loss_clf 0.381, Loss_aux 0.195, Train_accy 89.95:  35%|███▌      | 7/20 [10:04<18:34, 85.77s/it]
Task 6, Epoch 8/20 => Loss 0.557, Loss_clf 0.366, Loss_aux 0.191, Train_accy 89.95:  35%|███▌      | 7/20 [11:21<18:34, 85.77s/it]
Task 6, Epoch 8/20 => Loss 0.557, Loss_clf 0.366, Loss_aux 0.191, Train_accy 89.95:  40%|████      | 8/20 [11:21<16:38, 83.19s/it]
Task 6, Epoch 9/20 => Loss 0.560, Loss_clf 0.375, Loss_aux 0.186, Train_accy 90.22:  40%|████      | 8/20 [12:39<16:38, 83.19s/it]
Task 6, Epoch 9/20 => Loss 0.560, Loss_clf 0.375, Loss_aux 0.186, Train_accy 90.22:  45%|████▌     | 9/20 [12:39<14:55, 81.44s/it]
Task 6, Epoch 10/20 => Loss 0.448, Loss_clf 0.297, Loss_aux 0.151, Train_accy 91.68:  45%|████▌     | 9/20 [13:57<14:55, 81.44s/it]
Task 6, Epoch 10/20 => Loss 0.448, Loss_clf 0.297, Loss_aux 0.151, Train_accy 91.68:  50%|█████     | 10/20 [13:57<13:22, 80.25s/it]
Task 6, Epoch 11/20 => Loss 0.443, Loss_clf 0.294, Loss_aux 0.148, Train_accy 91.92, Test_accy 84.46:  50%|█████     | 10/20 [15:45<13:22, 80.25s/it]
Task 6, Epoch 11/20 => Loss 0.443, Loss_clf 0.294, Loss_aux 0.148, Train_accy 91.92, Test_accy 84.46:  55%|█████▌    | 11/20 [15:45<13:20, 88.90s/it]
Task 6, Epoch 12/20 => Loss 0.473, Loss_clf 0.315, Loss_aux 0.158, Train_accy 91.56:  55%|█████▌    | 11/20 [17:03<13:20, 88.90s/it]                 
Task 6, Epoch 12/20 => Loss 0.473, Loss_clf 0.315, Loss_aux 0.158, Train_accy 91.56:  60%|██████    | 12/20 [17:03<11:23, 85.49s/it]
Task 6, Epoch 13/20 => Loss 0.457, Loss_clf 0.300, Loss_aux 0.158, Train_accy 91.95:  60%|██████    | 12/20 [18:21<11:23, 85.49s/it]
Task 6, Epoch 13/20 => Loss 0.457, Loss_clf 0.300, Loss_aux 0.158, Train_accy 91.95:  65%|██████▌   | 13/20 [18:21<09:41, 83.13s/it]
Task 6, Epoch 14/20 => Loss 0.477, Loss_clf 0.314, Loss_aux 0.163, Train_accy 91.47:  65%|██████▌   | 13/20 [19:38<09:41, 83.13s/it]
Task 6, Epoch 14/20 => Loss 0.477, Loss_clf 0.314, Loss_aux 0.163, Train_accy 91.47:  70%|███████   | 14/20 [19:38<08:08, 81.47s/it]
Task 6, Epoch 15/20 => Loss 0.427, Loss_clf 0.291, Loss_aux 0.136, Train_accy 92.04:  70%|███████   | 14/20 [20:56<08:08, 81.47s/it]
Task 6, Epoch 15/20 => Loss 0.427, Loss_clf 0.291, Loss_aux 0.136, Train_accy 92.04:  75%|███████▌  | 15/20 [20:56<06:41, 80.31s/it]
Task 6, Epoch 16/20 => Loss 0.464, Loss_clf 0.312, Loss_aux 0.153, Train_accy 91.83, Test_accy 84.52:  75%|███████▌  | 15/20 [22:44<06:41, 80.31s/it]
Task 6, Epoch 16/20 => Loss 0.464, Loss_clf 0.312, Loss_aux 0.153, Train_accy 91.83, Test_accy 84.52:  80%|████████  | 16/20 [22:44<05:55, 88.79s/it]
Task 6, Epoch 17/20 => Loss 0.455, Loss_clf 0.310, Loss_aux 0.145, Train_accy 91.86:  80%|████████  | 16/20 [24:02<05:55, 88.79s/it]                 
Task 6, Epoch 17/20 => Loss 0.455, Loss_clf 0.310, Loss_aux 0.145, Train_accy 91.86:  85%|████████▌ | 17/20 [24:02<04:16, 85.41s/it]
Task 6, Epoch 18/20 => Loss 0.458, Loss_clf 0.316, Loss_aux 0.141, Train_accy 91.65:  85%|████████▌ | 17/20 [25:19<04:16, 85.41s/it]
Task 6, Epoch 18/20 => Loss 0.458, Loss_clf 0.316, Loss_aux 0.141, Train_accy 91.65:  90%|█████████ | 18/20 [25:19<02:46, 83.05s/it]
Task 6, Epoch 19/20 => Loss 0.396, Loss_clf 0.280, Loss_aux 0.117, Train_accy 92.31:  90%|█████████ | 18/20 [26:37<02:46, 83.05s/it]
Task 6, Epoch 19/20 => Loss 0.396, Loss_clf 0.280, Loss_aux 0.117, Train_accy 92.31:  95%|█████████▌| 19/20 [26:37<01:21, 81.40s/it]
Task 6, Epoch 20/20 => Loss 0.451, Loss_clf 0.317, Loss_aux 0.134, Train_accy 91.77:  95%|█████████▌| 19/20 [27:54<01:21, 81.40s/it]
Task 6, Epoch 20/20 => Loss 0.451, Loss_clf 0.317, Loss_aux 0.134, Train_accy 91.77: 100%|██████████| 20/20 [27:54<00:00, 80.24s/it]
Task 6, Epoch 20/20 => Loss 0.451, Loss_clf 0.317, Loss_aux 0.134, Train_accy 91.77: 100%|██████████| 20/20 [27:54<00:00, 83.75s/it]2024-09-12 11:48:49,606 [der.py] => Task 6, Epoch 20/20 => Loss 0.451, Loss_clf 0.317, Loss_aux 0.134, Train_accy 91.77
2024-09-12 11:48:49,608 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 11:52:13,439 [der.py] => Exemplar size: 2800
2024-09-12 11:52:13,439 [trainer.py] => CNN: {'total': 85.74, '00-19': 81.38, '20-39': 84.06, '40-59': 83.94, '60-79': 83.4, '80-99': 87.36, '100-119': 91.23, '120-139': 88.89, 'old': 85.24, 'new': 88.89}
2024-09-12 11:52:13,439 [trainer.py] => NME: {'total': 85.98, '00-19': 81.38, '20-39': 85.99, '40-59': 85.78, '60-79': 85.02, '80-99': 88.48, '100-119': 89.47, '120-139': 85.78, 'old': 86.02, 'new': 85.78}
2024-09-12 11:52:13,439 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03, 88.9, 88.22, 86.58, 85.74]
2024-09-12 11:52:13,439 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.8, 98.4, 97.88, 97.38]
2024-09-12 11:52:13,440 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07, 88.9, 88.89, 86.79, 85.98]
2024-09-12 11:52:13,440 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 98.8, 98.82, 98.23, 98.42]

Average Accuracy (CNN): 89.82
Average Accuracy (NME): 90.55
2024-09-12 11:52:13,440 [trainer.py] => Average Accuracy (CNN): 89.82
2024-09-12 11:52:13,440 [trainer.py] => Average Accuracy (NME): 90.55
2024-09-12 11:52:13,444 [trainer.py] => All params: 601359521
2024-09-12 11:52:13,448 [trainer.py] => Trainable params: 86567585
2024-09-12 11:52:15,209 [der.py] => Learning on 140-160
2024-09-12 11:52:15,219 [der.py] => All params: 687388597
2024-09-12 11:52:15,223 [der.py] => Trainable params: 86798005

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.097, Loss_clf 1.159, Loss_aux 0.938, Train_accy 80.67, Test_accy 83.29:   0%|          | 0/20 [02:16<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.097, Loss_clf 1.159, Loss_aux 0.938, Train_accy 80.67, Test_accy 83.29:   5%|▌         | 1/20 [02:16<43:06, 136.14s/it]
Task 7, Epoch 2/20 => Loss 0.779, Loss_clf 0.441, Loss_aux 0.338, Train_accy 87.96:   5%|▌         | 1/20 [03:51<43:06, 136.14s/it]                 
Task 7, Epoch 2/20 => Loss 0.779, Loss_clf 0.441, Loss_aux 0.338, Train_accy 87.96:  10%|█         | 2/20 [03:51<33:40, 112.25s/it]
Task 7, Epoch 3/20 => Loss 0.706, Loss_clf 0.445, Loss_aux 0.262, Train_accy 87.72:  10%|█         | 2/20 [05:27<33:40, 112.25s/it]
Task 7, Epoch 3/20 => Loss 0.706, Loss_clf 0.445, Loss_aux 0.262, Train_accy 87.72:  15%|█▌        | 3/20 [05:27<29:38, 104.64s/it]
Task 7, Epoch 4/20 => Loss 0.615, Loss_clf 0.395, Loss_aux 0.220, Train_accy 89.19:  15%|█▌        | 3/20 [07:02<29:38, 104.64s/it]
Task 7, Epoch 4/20 => Loss 0.615, Loss_clf 0.395, Loss_aux 0.220, Train_accy 89.19:  20%|██        | 4/20 [07:02<26:56, 101.06s/it]
Task 7, Epoch 5/20 => Loss 0.564, Loss_clf 0.372, Loss_aux 0.192, Train_accy 90.30:  20%|██        | 4/20 [08:38<26:56, 101.06s/it]
Task 7, Epoch 5/20 => Loss 0.564, Loss_clf 0.372, Loss_aux 0.192, Train_accy 90.30:  25%|██▌       | 5/20 [08:38<24:46, 99.09s/it] 
Task 7, Epoch 6/20 => Loss 0.541, Loss_clf 0.354, Loss_aux 0.188, Train_accy 90.43, Test_accy 82.87:  25%|██▌       | 5/20 [10:54<24:46, 99.09s/it]
Task 7, Epoch 6/20 => Loss 0.541, Loss_clf 0.354, Loss_aux 0.188, Train_accy 90.43, Test_accy 82.87:  30%|███       | 6/20 [10:54<26:02, 111.64s/it]
Task 7, Epoch 7/20 => Loss 0.527, Loss_clf 0.350, Loss_aux 0.177, Train_accy 90.32:  30%|███       | 6/20 [12:30<26:02, 111.64s/it]                 
Task 7, Epoch 7/20 => Loss 0.527, Loss_clf 0.350, Loss_aux 0.177, Train_accy 90.32:  35%|███▌      | 7/20 [12:30<23:03, 106.42s/it]
Task 7, Epoch 8/20 => Loss 0.526, Loss_clf 0.347, Loss_aux 0.179, Train_accy 91.08:  35%|███▌      | 7/20 [14:05<23:03, 106.42s/it]
Task 7, Epoch 8/20 => Loss 0.526, Loss_clf 0.347, Loss_aux 0.179, Train_accy 91.08:  40%|████      | 8/20 [14:05<20:35, 102.98s/it]
Task 7, Epoch 9/20 => Loss 0.500, Loss_clf 0.346, Loss_aux 0.154, Train_accy 91.16:  40%|████      | 8/20 [15:41<20:35, 102.98s/it]
Task 7, Epoch 9/20 => Loss 0.500, Loss_clf 0.346, Loss_aux 0.154, Train_accy 91.16:  45%|████▌     | 9/20 [15:41<18:27, 100.68s/it]
Task 7, Epoch 10/20 => Loss 0.453, Loss_clf 0.315, Loss_aux 0.138, Train_accy 91.56:  45%|████▌     | 9/20 [17:16<18:27, 100.68s/it]
Task 7, Epoch 10/20 => Loss 0.453, Loss_clf 0.315, Loss_aux 0.138, Train_accy 91.56:  50%|█████     | 10/20 [17:16<16:31, 99.10s/it]
Task 7, Epoch 11/20 => Loss 0.434, Loss_clf 0.308, Loss_aux 0.126, Train_accy 92.02, Test_accy 84.56:  50%|█████     | 10/20 [19:32<16:31, 99.10s/it]
Task 7, Epoch 11/20 => Loss 0.434, Loss_clf 0.308, Loss_aux 0.126, Train_accy 92.02, Test_accy 84.56:  55%|█████▌    | 11/20 [19:32<16:33, 110.34s/it]
Task 7, Epoch 12/20 => Loss 0.438, Loss_clf 0.304, Loss_aux 0.135, Train_accy 91.75:  55%|█████▌    | 11/20 [21:08<16:33, 110.34s/it]                 
Task 7, Epoch 12/20 => Loss 0.438, Loss_clf 0.304, Loss_aux 0.135, Train_accy 91.75:  60%|██████    | 12/20 [21:08<14:06, 105.84s/it]
Task 7, Epoch 13/20 => Loss 0.454, Loss_clf 0.332, Loss_aux 0.122, Train_accy 91.59:  60%|██████    | 12/20 [22:43<14:06, 105.84s/it]
Task 7, Epoch 13/20 => Loss 0.454, Loss_clf 0.332, Loss_aux 0.122, Train_accy 91.59:  65%|██████▌   | 13/20 [22:43<11:59, 102.73s/it]
Task 7, Epoch 14/20 => Loss 0.423, Loss_clf 0.299, Loss_aux 0.124, Train_accy 92.39:  65%|██████▌   | 13/20 [24:19<11:59, 102.73s/it]
Task 7, Epoch 14/20 => Loss 0.423, Loss_clf 0.299, Loss_aux 0.124, Train_accy 92.39:  70%|███████   | 14/20 [24:19<10:03, 100.56s/it]
Task 7, Epoch 15/20 => Loss 0.449, Loss_clf 0.315, Loss_aux 0.134, Train_accy 92.26:  70%|███████   | 14/20 [25:54<10:03, 100.56s/it]
Task 7, Epoch 15/20 => Loss 0.449, Loss_clf 0.315, Loss_aux 0.134, Train_accy 92.26:  75%|███████▌  | 15/20 [25:54<08:15, 99.02s/it] 
Task 7, Epoch 16/20 => Loss 0.437, Loss_clf 0.302, Loss_aux 0.135, Train_accy 92.34, Test_accy 83.98:  75%|███████▌  | 15/20 [28:10<08:15, 99.02s/it]
Task 7, Epoch 16/20 => Loss 0.437, Loss_clf 0.302, Loss_aux 0.135, Train_accy 92.34, Test_accy 83.98:  80%|████████  | 16/20 [28:10<07:20, 110.08s/it]
Task 7, Epoch 17/20 => Loss 0.386, Loss_clf 0.269, Loss_aux 0.117, Train_accy 92.77:  80%|████████  | 16/20 [29:46<07:20, 110.08s/it]                 
Task 7, Epoch 17/20 => Loss 0.386, Loss_clf 0.269, Loss_aux 0.117, Train_accy 92.77:  85%|████████▌ | 17/20 [29:46<05:17, 105.80s/it]
Task 7, Epoch 18/20 => Loss 0.424, Loss_clf 0.302, Loss_aux 0.122, Train_accy 92.07:  85%|████████▌ | 17/20 [31:22<05:17, 105.80s/it]
Task 7, Epoch 18/20 => Loss 0.424, Loss_clf 0.302, Loss_aux 0.122, Train_accy 92.07:  90%|█████████ | 18/20 [31:22<03:25, 102.76s/it]
Task 7, Epoch 19/20 => Loss 0.426, Loss_clf 0.307, Loss_aux 0.119, Train_accy 92.20:  90%|█████████ | 18/20 [32:57<03:25, 102.76s/it]
Task 7, Epoch 19/20 => Loss 0.426, Loss_clf 0.307, Loss_aux 0.119, Train_accy 92.20:  95%|█████████▌| 19/20 [32:57<01:40, 100.66s/it]
Task 7, Epoch 20/20 => Loss 0.414, Loss_clf 0.287, Loss_aux 0.126, Train_accy 92.04:  95%|█████████▌| 19/20 [34:33<01:40, 100.66s/it]
Task 7, Epoch 20/20 => Loss 0.414, Loss_clf 0.287, Loss_aux 0.126, Train_accy 92.04: 100%|██████████| 20/20 [34:33<00:00, 99.20s/it] 
Task 7, Epoch 20/20 => Loss 0.414, Loss_clf 0.287, Loss_aux 0.126, Train_accy 92.04: 100%|██████████| 20/20 [34:33<00:00, 103.69s/it]2024-09-12 12:26:49,002 [der.py] => Task 7, Epoch 20/20 => Loss 0.414, Loss_clf 0.287, Loss_aux 0.126, Train_accy 92.04
2024-09-12 12:26:49,003 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 12:31:02,884 [der.py] => Exemplar size: 3200
2024-09-12 12:31:02,884 [trainer.py] => CNN: {'total': 84.24, '00-19': 80.57, '20-39': 80.68, '40-59': 79.82, '60-79': 83.81, '80-99': 84.76, '100-119': 85.53, '120-139': 86.22, '140-159': 91.6, 'old': 83.12, 'new': 91.6}
2024-09-12 12:31:02,884 [trainer.py] => NME: {'total': 85.46, '00-19': 80.97, '20-39': 86.47, '40-59': 84.86, '60-79': 83.81, '80-99': 88.48, '100-119': 89.04, '120-139': 84.89, '140-159': 85.2, 'old': 85.5, 'new': 85.2}
2024-09-12 12:31:02,884 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03, 88.9, 88.22, 86.58, 85.74, 84.24]
2024-09-12 12:31:02,884 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.8, 98.4, 97.88, 97.38, 97.14]
2024-09-12 12:31:02,884 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07, 88.9, 88.89, 86.79, 85.98, 85.46]
2024-09-12 12:31:02,884 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 98.8, 98.82, 98.23, 98.42, 98.57]

Average Accuracy (CNN): 89.12
Average Accuracy (NME): 89.91
2024-09-12 12:31:02,884 [trainer.py] => Average Accuracy (CNN): 89.12
2024-09-12 12:31:02,884 [trainer.py] => Average Accuracy (NME): 89.91
2024-09-12 12:31:02,889 [trainer.py] => All params: 687388597
2024-09-12 12:31:02,893 [trainer.py] => Trainable params: 86798005
2024-09-12 12:31:05,534 [der.py] => Learning on 160-180
2024-09-12 12:31:05,545 [der.py] => All params: 773448393
2024-09-12 12:31:05,550 [der.py] => Trainable params: 87059145

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.944, Loss_clf 1.106, Loss_aux 0.838, Train_accy 82.06, Test_accy 80.83:   0%|          | 0/20 [02:48<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.944, Loss_clf 1.106, Loss_aux 0.838, Train_accy 82.06, Test_accy 80.83:   5%|▌         | 1/20 [02:48<53:19, 168.40s/it]
Task 8, Epoch 2/20 => Loss 0.758, Loss_clf 0.445, Loss_aux 0.313, Train_accy 88.05:   5%|▌         | 1/20 [04:46<53:19, 168.40s/it]                 
Task 8, Epoch 2/20 => Loss 0.758, Loss_clf 0.445, Loss_aux 0.313, Train_accy 88.05:  10%|█         | 2/20 [04:46<41:34, 138.58s/it]
Task 8, Epoch 3/20 => Loss 0.666, Loss_clf 0.421, Loss_aux 0.245, Train_accy 89.11:  10%|█         | 2/20 [06:43<41:34, 138.58s/it]
Task 8, Epoch 3/20 => Loss 0.666, Loss_clf 0.421, Loss_aux 0.245, Train_accy 89.11:  15%|█▌        | 3/20 [06:43<36:33, 129.04s/it]
Task 8, Epoch 4/20 => Loss 0.580, Loss_clf 0.368, Loss_aux 0.212, Train_accy 90.38:  15%|█▌        | 3/20 [08:41<36:33, 129.04s/it]
Task 8, Epoch 4/20 => Loss 0.580, Loss_clf 0.368, Loss_aux 0.212, Train_accy 90.38:  20%|██        | 4/20 [08:41<33:11, 124.49s/it]
Task 8, Epoch 5/20 => Loss 0.541, Loss_clf 0.353, Loss_aux 0.188, Train_accy 91.05:  20%|██        | 4/20 [10:38<33:11, 124.49s/it]
Task 8, Epoch 5/20 => Loss 0.541, Loss_clf 0.353, Loss_aux 0.188, Train_accy 91.05:  25%|██▌       | 5/20 [10:38<30:29, 122.00s/it]
Task 8, Epoch 6/20 => Loss 0.531, Loss_clf 0.350, Loss_aux 0.181, Train_accy 91.15, Test_accy 82.75:  25%|██▌       | 5/20 [13:27<30:29, 122.00s/it]
Task 8, Epoch 6/20 => Loss 0.531, Loss_clf 0.350, Loss_aux 0.181, Train_accy 91.15, Test_accy 82.75:  30%|███       | 6/20 [13:27<32:10, 137.88s/it]
Task 8, Epoch 7/20 => Loss 0.490, Loss_clf 0.341, Loss_aux 0.149, Train_accy 91.03:  30%|███       | 6/20 [15:25<32:10, 137.88s/it]                 
Task 8, Epoch 7/20 => Loss 0.490, Loss_clf 0.341, Loss_aux 0.149, Train_accy 91.03:  35%|███▌      | 7/20 [15:25<28:26, 131.28s/it]
Task 8, Epoch 8/20 => Loss 0.513, Loss_clf 0.310, Loss_aux 0.203, Train_accy 91.99:  35%|███▌      | 7/20 [17:22<28:26, 131.28s/it]
Task 8, Epoch 8/20 => Loss 0.513, Loss_clf 0.310, Loss_aux 0.203, Train_accy 91.99:  40%|████      | 8/20 [17:22<25:22, 126.90s/it]
Task 8, Epoch 9/20 => Loss 0.484, Loss_clf 0.313, Loss_aux 0.171, Train_accy 91.73:  40%|████      | 8/20 [19:20<25:22, 126.90s/it]
Task 8, Epoch 9/20 => Loss 0.484, Loss_clf 0.313, Loss_aux 0.171, Train_accy 91.73:  45%|████▌     | 9/20 [19:20<22:44, 124.01s/it]
Task 8, Epoch 10/20 => Loss 0.503, Loss_clf 0.346, Loss_aux 0.157, Train_accy 91.29:  45%|████▌     | 9/20 [21:18<22:44, 124.01s/it]
Task 8, Epoch 10/20 => Loss 0.503, Loss_clf 0.346, Loss_aux 0.157, Train_accy 91.29:  50%|█████     | 10/20 [21:18<20:20, 122.03s/it]
Task 8, Epoch 11/20 => Loss 0.505, Loss_clf 0.336, Loss_aux 0.169, Train_accy 91.27, Test_accy 83.41:  50%|█████     | 10/20 [24:06<20:20, 122.03s/it]
Task 8, Epoch 11/20 => Loss 0.505, Loss_clf 0.336, Loss_aux 0.169, Train_accy 91.27, Test_accy 83.41:  55%|█████▌    | 11/20 [24:06<20:25, 136.20s/it]
Task 8, Epoch 12/20 => Loss 0.494, Loss_clf 0.350, Loss_aux 0.144, Train_accy 90.86:  55%|█████▌    | 11/20 [26:03<20:25, 136.20s/it]                 
Task 8, Epoch 12/20 => Loss 0.494, Loss_clf 0.350, Loss_aux 0.144, Train_accy 90.86:  60%|██████    | 12/20 [26:03<17:24, 130.51s/it]
Task 8, Epoch 13/20 => Loss 0.415, Loss_clf 0.284, Loss_aux 0.132, Train_accy 92.47:  60%|██████    | 12/20 [28:01<17:24, 130.51s/it]
Task 8, Epoch 13/20 => Loss 0.415, Loss_clf 0.284, Loss_aux 0.132, Train_accy 92.47:  65%|██████▌   | 13/20 [28:01<14:46, 126.61s/it]
Task 8, Epoch 14/20 => Loss 0.444, Loss_clf 0.304, Loss_aux 0.140, Train_accy 92.33:  65%|██████▌   | 13/20 [29:59<14:46, 126.61s/it]
Task 8, Epoch 14/20 => Loss 0.444, Loss_clf 0.304, Loss_aux 0.140, Train_accy 92.33:  70%|███████   | 14/20 [29:59<12:23, 123.90s/it]
Task 8, Epoch 15/20 => Loss 0.446, Loss_clf 0.319, Loss_aux 0.126, Train_accy 91.70:  70%|███████   | 14/20 [31:57<12:23, 123.90s/it]
Task 8, Epoch 15/20 => Loss 0.446, Loss_clf 0.319, Loss_aux 0.126, Train_accy 91.70:  75%|███████▌  | 15/20 [31:57<10:10, 122.09s/it]
Task 8, Epoch 16/20 => Loss 0.425, Loss_clf 0.303, Loss_aux 0.122, Train_accy 92.33, Test_accy 83.60:  75%|███████▌  | 15/20 [34:45<10:10, 122.09s/it]
Task 8, Epoch 16/20 => Loss 0.425, Loss_clf 0.303, Loss_aux 0.122, Train_accy 92.33, Test_accy 83.60:  80%|████████  | 16/20 [34:45<09:04, 136.13s/it]
Task 8, Epoch 17/20 => Loss 0.395, Loss_clf 0.291, Loss_aux 0.104, Train_accy 92.59:  80%|████████  | 16/20 [36:43<09:04, 136.13s/it]                 
Task 8, Epoch 17/20 => Loss 0.395, Loss_clf 0.291, Loss_aux 0.104, Train_accy 92.59:  85%|████████▌ | 17/20 [36:43<06:31, 130.56s/it]
Task 8, Epoch 18/20 => Loss 0.405, Loss_clf 0.297, Loss_aux 0.108, Train_accy 92.30:  85%|████████▌ | 17/20 [38:40<06:31, 130.56s/it]
Task 8, Epoch 18/20 => Loss 0.405, Loss_clf 0.297, Loss_aux 0.108, Train_accy 92.30:  90%|█████████ | 18/20 [38:40<04:13, 126.65s/it]
Task 8, Epoch 19/20 => Loss 0.406, Loss_clf 0.286, Loss_aux 0.120, Train_accy 92.21:  90%|█████████ | 18/20 [40:38<04:13, 126.65s/it]
Task 8, Epoch 19/20 => Loss 0.406, Loss_clf 0.286, Loss_aux 0.120, Train_accy 92.21:  95%|█████████▌| 19/20 [40:38<02:03, 123.90s/it]
Task 8, Epoch 20/20 => Loss 0.419, Loss_clf 0.306, Loss_aux 0.112, Train_accy 91.97:  95%|█████████▌| 19/20 [42:35<02:03, 123.90s/it]
Task 8, Epoch 20/20 => Loss 0.419, Loss_clf 0.306, Loss_aux 0.112, Train_accy 91.97: 100%|██████████| 20/20 [42:35<00:00, 121.98s/it]
Task 8, Epoch 20/20 => Loss 0.419, Loss_clf 0.306, Loss_aux 0.112, Train_accy 91.97: 100%|██████████| 20/20 [42:35<00:00, 127.80s/it]2024-09-12 13:13:41,565 [der.py] => Task 8, Epoch 20/20 => Loss 0.419, Loss_clf 0.306, Loss_aux 0.112, Train_accy 91.97
2024-09-12 13:13:41,567 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 13:18:49,730 [der.py] => Exemplar size: 3600
2024-09-12 13:18:49,730 [trainer.py] => CNN: {'total': 84.45, '00-19': 78.54, '20-39': 82.13, '40-59': 83.03, '60-79': 79.35, '80-99': 86.62, '100-119': 84.65, '120-139': 88.89, '140-159': 84.8, '160-179': 91.98, 'old': 83.5, 'new': 91.98}
2024-09-12 13:18:49,731 [trainer.py] => NME: {'total': 85.29, '00-19': 81.38, '20-39': 86.47, '40-59': 84.4, '60-79': 83.0, '80-99': 88.48, '100-119': 88.16, '120-139': 84.44, '140-159': 85.6, '160-179': 85.65, 'old': 85.25, 'new': 85.65}
2024-09-12 13:18:49,731 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03, 88.9, 88.22, 86.58, 85.74, 84.24, 84.45]
2024-09-12 13:18:49,731 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.8, 98.4, 97.88, 97.38, 97.14, 96.43]
2024-09-12 13:18:49,731 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07, 88.9, 88.89, 86.79, 85.98, 85.46, 85.29]
2024-09-12 13:18:49,731 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 98.8, 98.82, 98.23, 98.42, 98.57, 98.07]

Average Accuracy (CNN): 88.6
Average Accuracy (NME): 89.4
2024-09-12 13:18:49,731 [trainer.py] => Average Accuracy (CNN): 88.6
2024-09-12 13:18:49,731 [trainer.py] => Average Accuracy (NME): 89.4
2024-09-12 13:18:49,736 [trainer.py] => All params: 773448393
2024-09-12 13:18:49,741 [trainer.py] => Trainable params: 87059145
2024-09-12 13:18:51,720 [der.py] => Learning on 180-200
2024-09-12 13:18:51,737 [der.py] => All params: 859538909
2024-09-12 13:18:51,744 [der.py] => Trainable params: 87351005

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.015, Loss_clf 1.064, Loss_aux 0.951, Train_accy 81.11, Test_accy 78.63:   0%|          | 0/20 [03:22<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.015, Loss_clf 1.064, Loss_aux 0.951, Train_accy 81.11, Test_accy 78.63:   5%|▌         | 1/20 [03:22<1:04:09, 202.58s/it]
Task 9, Epoch 2/20 => Loss 0.784, Loss_clf 0.460, Loss_aux 0.324, Train_accy 87.83:   5%|▌         | 1/20 [05:43<1:04:09, 202.58s/it]                 
Task 9, Epoch 2/20 => Loss 0.784, Loss_clf 0.460, Loss_aux 0.324, Train_accy 87.83:  10%|█         | 2/20 [05:43<49:51, 166.18s/it]  
Task 9, Epoch 3/20 => Loss 0.722, Loss_clf 0.449, Loss_aux 0.272, Train_accy 88.16:  10%|█         | 2/20 [08:03<49:51, 166.18s/it]
Task 9, Epoch 3/20 => Loss 0.722, Loss_clf 0.449, Loss_aux 0.272, Train_accy 88.16:  15%|█▌        | 3/20 [08:03<43:44, 154.40s/it]
Task 9, Epoch 4/20 => Loss 0.569, Loss_clf 0.352, Loss_aux 0.217, Train_accy 90.64:  15%|█▌        | 3/20 [10:23<43:44, 154.40s/it]
Task 9, Epoch 4/20 => Loss 0.569, Loss_clf 0.352, Loss_aux 0.217, Train_accy 90.64:  20%|██        | 4/20 [10:23<39:41, 148.84s/it]
Task 9, Epoch 5/20 => Loss 0.572, Loss_clf 0.378, Loss_aux 0.194, Train_accy 90.05:  20%|██        | 4/20 [12:44<39:41, 148.84s/it]
Task 9, Epoch 5/20 => Loss 0.572, Loss_clf 0.378, Loss_aux 0.194, Train_accy 90.05:  25%|██▌       | 5/20 [12:44<36:27, 145.82s/it]
Task 9, Epoch 6/20 => Loss 0.527, Loss_clf 0.363, Loss_aux 0.164, Train_accy 90.58, Test_accy 82.02:  25%|██▌       | 5/20 [16:07<36:27, 145.82s/it]
Task 9, Epoch 6/20 => Loss 0.527, Loss_clf 0.363, Loss_aux 0.164, Train_accy 90.58, Test_accy 82.02:  30%|███       | 6/20 [16:07<38:32, 165.14s/it]
Task 9, Epoch 7/20 => Loss 0.515, Loss_clf 0.352, Loss_aux 0.163, Train_accy 91.17:  30%|███       | 6/20 [18:27<38:32, 165.14s/it]                 
Task 9, Epoch 7/20 => Loss 0.515, Loss_clf 0.352, Loss_aux 0.163, Train_accy 91.17:  35%|███▌      | 7/20 [18:27<34:02, 157.12s/it]
Task 9, Epoch 8/20 => Loss 0.482, Loss_clf 0.336, Loss_aux 0.145, Train_accy 91.37:  35%|███▌      | 7/20 [20:48<34:02, 157.12s/it]
Task 9, Epoch 8/20 => Loss 0.482, Loss_clf 0.336, Loss_aux 0.145, Train_accy 91.37:  40%|████      | 8/20 [20:48<30:21, 151.78s/it]
Task 9, Epoch 9/20 => Loss 0.486, Loss_clf 0.346, Loss_aux 0.140, Train_accy 91.21:  40%|████      | 8/20 [23:08<30:21, 151.78s/it]
Task 9, Epoch 9/20 => Loss 0.486, Loss_clf 0.346, Loss_aux 0.140, Train_accy 91.21:  45%|████▌     | 9/20 [23:08<27:10, 148.21s/it]
Task 9, Epoch 10/20 => Loss 0.465, Loss_clf 0.322, Loss_aux 0.143, Train_accy 91.37:  45%|████▌     | 9/20 [25:29<27:10, 148.21s/it]
Task 9, Epoch 10/20 => Loss 0.465, Loss_clf 0.322, Loss_aux 0.143, Train_accy 91.37:  50%|█████     | 10/20 [25:29<24:18, 145.89s/it]
Task 9, Epoch 11/20 => Loss 0.437, Loss_clf 0.310, Loss_aux 0.127, Train_accy 92.05, Test_accy 82.23:  50%|█████     | 10/20 [28:51<24:18, 145.89s/it]
Task 9, Epoch 11/20 => Loss 0.437, Loss_clf 0.310, Loss_aux 0.127, Train_accy 92.05, Test_accy 82.23:  55%|█████▌    | 11/20 [28:51<24:29, 163.30s/it]
Task 9, Epoch 12/20 => Loss 0.465, Loss_clf 0.340, Loss_aux 0.125, Train_accy 91.26:  55%|█████▌    | 11/20 [31:12<24:29, 163.30s/it]                 
Task 9, Epoch 12/20 => Loss 0.465, Loss_clf 0.340, Loss_aux 0.125, Train_accy 91.26:  60%|██████    | 12/20 [31:12<20:50, 156.34s/it]
Task 9, Epoch 13/20 => Loss 0.473, Loss_clf 0.350, Loss_aux 0.124, Train_accy 91.23:  60%|██████    | 12/20 [33:32<20:50, 156.34s/it]
Task 9, Epoch 13/20 => Loss 0.473, Loss_clf 0.350, Loss_aux 0.124, Train_accy 91.23:  65%|██████▌   | 13/20 [33:32<17:40, 151.49s/it]
Task 9, Epoch 14/20 => Loss 0.429, Loss_clf 0.309, Loss_aux 0.119, Train_accy 92.00:  65%|██████▌   | 13/20 [35:52<17:40, 151.49s/it]
Task 9, Epoch 14/20 => Loss 0.429, Loss_clf 0.309, Loss_aux 0.119, Train_accy 92.00:  70%|███████   | 14/20 [35:52<14:48, 148.13s/it]
Task 9, Epoch 15/20 => Loss 0.409, Loss_clf 0.298, Loss_aux 0.111, Train_accy 92.33:  70%|███████   | 14/20 [38:13<14:48, 148.13s/it]
Task 9, Epoch 15/20 => Loss 0.409, Loss_clf 0.298, Loss_aux 0.111, Train_accy 92.33:  75%|███████▌  | 15/20 [38:13<12:09, 145.82s/it]
Task 9, Epoch 16/20 => Loss 0.437, Loss_clf 0.316, Loss_aux 0.121, Train_accy 91.67, Test_accy 83.16:  75%|███████▌  | 15/20 [41:36<12:09, 145.82s/it]
Task 9, Epoch 16/20 => Loss 0.437, Loss_clf 0.316, Loss_aux 0.121, Train_accy 91.67, Test_accy 83.16:  80%|████████  | 16/20 [41:36<10:51, 162.99s/it]
Task 9, Epoch 17/20 => Loss 0.400, Loss_clf 0.301, Loss_aux 0.099, Train_accy 92.27:  80%|████████  | 16/20 [43:56<10:51, 162.99s/it]                 
Task 9, Epoch 17/20 => Loss 0.400, Loss_clf 0.301, Loss_aux 0.099, Train_accy 92.27:  85%|████████▌ | 17/20 [43:56<07:48, 156.27s/it]
Task 9, Epoch 18/20 => Loss 0.406, Loss_clf 0.293, Loss_aux 0.113, Train_accy 92.31:  85%|████████▌ | 17/20 [46:17<07:48, 156.27s/it]
Task 9, Epoch 18/20 => Loss 0.406, Loss_clf 0.293, Loss_aux 0.113, Train_accy 92.31:  90%|█████████ | 18/20 [46:17<05:03, 151.54s/it]
Task 9, Epoch 19/20 => Loss 0.414, Loss_clf 0.297, Loss_aux 0.117, Train_accy 92.31:  90%|█████████ | 18/20 [48:37<05:03, 151.54s/it]
Task 9, Epoch 19/20 => Loss 0.414, Loss_clf 0.297, Loss_aux 0.117, Train_accy 92.31:  95%|█████████▌| 19/20 [48:37<02:28, 148.19s/it]
Task 9, Epoch 20/20 => Loss 0.396, Loss_clf 0.303, Loss_aux 0.093, Train_accy 92.29:  95%|█████████▌| 19/20 [50:58<02:28, 148.19s/it]
Task 9, Epoch 20/20 => Loss 0.396, Loss_clf 0.303, Loss_aux 0.093, Train_accy 92.29: 100%|██████████| 20/20 [50:58<00:00, 145.83s/it]
Task 9, Epoch 20/20 => Loss 0.396, Loss_clf 0.303, Loss_aux 0.093, Train_accy 92.29: 100%|██████████| 20/20 [50:58<00:00, 152.91s/it]2024-09-12 14:09:50,032 [der.py] => Task 9, Epoch 20/20 => Loss 0.396, Loss_clf 0.303, Loss_aux 0.093, Train_accy 92.29
2024-09-12 14:09:50,034 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 14:16:01,347 [der.py] => Exemplar size: 4000
2024-09-12 14:16:01,347 [trainer.py] => CNN: {'total': 83.55, '00-19': 79.76, '20-39': 81.16, '40-59': 81.19, '60-79': 76.52, '80-99': 84.39, '100-119': 86.84, '120-139': 80.89, '140-159': 84.0, '160-179': 90.72, '180-199': 90.0, 'old': 82.85, 'new': 90.0}
2024-09-12 14:16:01,347 [trainer.py] => NME: {'total': 84.69, '00-19': 82.19, '20-39': 85.99, '40-59': 84.4, '60-79': 81.38, '80-99': 88.48, '100-119': 86.84, '120-139': 82.67, '140-159': 86.4, '160-179': 86.5, '180-199': 81.74, 'old': 85.01, 'new': 81.74}
2024-09-12 14:16:01,347 [trainer.py] => CNN top1 curve: [97.17, 92.07, 90.03, 88.9, 88.22, 86.58, 85.74, 84.24, 84.45, 83.55]
2024-09-12 14:16:01,347 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 98.8, 98.4, 97.88, 97.38, 97.14, 96.43, 96.06]
2024-09-12 14:16:01,348 [trainer.py] => NME top1 curve: [98.38, 93.83, 91.07, 88.9, 88.89, 86.79, 85.98, 85.46, 85.29, 84.69]
2024-09-12 14:16:01,348 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 98.8, 98.82, 98.23, 98.42, 98.57, 98.07, 97.37]

Average Accuracy (CNN): 88.1
Average Accuracy (NME): 88.93
2024-09-12 14:16:01,348 [trainer.py] => Average Accuracy (CNN): 88.1
2024-09-12 14:16:01,348 [trainer.py] => Average Accuracy (NME): 88.93
Accuracy Matrix (CNN):
[[97.17 93.12 89.47 85.83 85.02 81.38 81.38 80.57 78.54 79.76]
 [ 0.   90.82 87.44 86.47 83.57 82.13 84.06 80.68 82.13 81.16]
 [ 0.    0.   93.12 91.28 90.37 86.24 83.94 79.82 83.03 81.19]
 [ 0.    0.    0.   91.9  87.45 85.02 83.4  83.81 79.35 76.52]
 [ 0.    0.    0.    0.   93.68 91.82 87.36 84.76 86.62 84.39]
 [ 0.    0.    0.    0.    0.   92.11 91.23 85.53 84.65 86.84]
 [ 0.    0.    0.    0.    0.    0.   88.89 86.22 88.89 80.89]
 [ 0.    0.    0.    0.    0.    0.    0.   91.6  84.8  84.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   91.98 90.72]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   90.  ]]
2024-09-12 14:16:01,349 [trainer.py] => Forgetting (CNN): 9.533333333333335
Accuracy Matrix (NME):
[[98.38 96.36 89.88 85.02 83.4  82.19 81.38 80.97 81.38 82.19]
 [ 0.   90.82 91.3  88.89 87.44 86.47 85.99 86.47 86.47 85.99]
 [ 0.    0.   92.2  90.37 90.37 87.61 85.78 84.86 84.4  84.4 ]
 [ 0.    0.    0.   91.5  91.5  85.02 85.02 83.81 83.   81.38]
 [ 0.    0.    0.    0.   91.45 90.33 88.48 88.48 88.48 88.48]
 [ 0.    0.    0.    0.    0.   89.04 89.47 89.04 88.16 86.84]
 [ 0.    0.    0.    0.    0.    0.   85.78 84.89 84.44 82.67]
 [ 0.    0.    0.    0.    0.    0.    0.   85.2  85.6  86.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   85.65 86.5 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   81.74]]
2024-09-12 14:16:01,349 [trainer.py] => Forgetting (NME): 5.347777777777777
2024-09-12 14:16:03,728 [trainer.py] => config: ./exps/der_cub_B0_Inc20.json
2024-09-12 14:16:03,747 [trainer.py] => prefix: reproduce
2024-09-12 14:16:03,747 [trainer.py] => dataset: cub
2024-09-12 14:16:03,747 [trainer.py] => memory_size: 4000
2024-09-12 14:16:03,747 [trainer.py] => memory_per_class: 20
2024-09-12 14:16:03,747 [trainer.py] => fixed_memory: True
2024-09-12 14:16:03,747 [trainer.py] => shuffle: True
2024-09-12 14:16:03,747 [trainer.py] => init_cls: 10
2024-09-12 14:16:03,747 [trainer.py] => increment: 10
2024-09-12 14:16:03,747 [trainer.py] => model_name: der
2024-09-12 14:16:03,747 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-12 14:16:03,747 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-12 14:16:03,747 [trainer.py] => seed: 1993
2024-09-12 14:16:03,747 [trainer.py] => init_epoch: 20
2024-09-12 14:16:03,748 [trainer.py] => init_lr: 0.001
2024-09-12 14:16:03,748 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-12 14:16:03,748 [trainer.py] => init_lr_decay: 0.1
2024-09-12 14:16:03,748 [trainer.py] => init_weight_decay: 0.0005
2024-09-12 14:16:03,748 [trainer.py] => epochs: 20
2024-09-12 14:16:03,748 [trainer.py] => lrate: 0.001
2024-09-12 14:16:03,748 [trainer.py] => milestones: [80, 120, 150]
2024-09-12 14:16:03,748 [trainer.py] => lrate_decay: 0.1
2024-09-12 14:16:03,748 [trainer.py] => batch_size: 48
2024-09-12 14:16:03,748 [trainer.py] => weight_decay: 0.0002
2024-09-12 14:16:03,748 [trainer.py] => T: 2
2024-09-12 14:16:03,797 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-12 14:16:04,429 [trainer.py] => All params: 0
2024-09-12 14:16:04,429 [trainer.py] => Trainable params: 0
2024-09-12 14:16:06,179 [der.py] => Learning on 0-10
2024-09-12 14:16:06,180 [der.py] => All params: 85814805
2024-09-12 14:16:06,181 [der.py] => Trainable params: 85814805

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.510, Train_accy 53.44, Test_accy 56.78:   0%|          | 0/20 [00:05<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.510, Train_accy 53.44, Test_accy 56.78:   5%|▌         | 1/20 [00:05<01:37,  5.12s/it]
Task 0, Epoch 2/20 => Loss 0.802, Train_accy 76.41:   5%|▌         | 1/20 [00:09<01:37,  5.12s/it]                 
Task 0, Epoch 2/20 => Loss 0.802, Train_accy 76.41:  10%|█         | 2/20 [00:09<01:20,  4.47s/it]
Task 0, Epoch 3/20 => Loss 0.415, Train_accy 86.43:  10%|█         | 2/20 [00:13<01:20,  4.47s/it]
Task 0, Epoch 3/20 => Loss 0.415, Train_accy 86.43:  15%|█▌        | 3/20 [00:13<01:12,  4.25s/it]
Task 0, Epoch 4/20 => Loss 0.182, Train_accy 94.36:  15%|█▌        | 3/20 [00:17<01:12,  4.25s/it]
Task 0, Epoch 4/20 => Loss 0.182, Train_accy 94.36:  20%|██        | 4/20 [00:17<01:06,  4.17s/it]
Task 0, Epoch 5/20 => Loss 0.243, Train_accy 92.90:  20%|██        | 4/20 [00:21<01:06,  4.17s/it]
Task 0, Epoch 5/20 => Loss 0.243, Train_accy 92.90:  25%|██▌       | 5/20 [00:21<01:01,  4.11s/it]
Task 0, Epoch 6/20 => Loss 0.282, Train_accy 91.86, Test_accy 96.61:  25%|██▌       | 5/20 [00:26<01:01,  4.11s/it]
Task 0, Epoch 6/20 => Loss 0.282, Train_accy 91.86, Test_accy 96.61:  30%|███       | 6/20 [00:26<01:01,  4.36s/it]
Task 0, Epoch 7/20 => Loss 0.247, Train_accy 91.65:  30%|███       | 6/20 [00:30<01:01,  4.36s/it]                 
Task 0, Epoch 7/20 => Loss 0.247, Train_accy 91.65:  35%|███▌      | 7/20 [00:30<00:55,  4.25s/it]
Task 0, Epoch 8/20 => Loss 0.196, Train_accy 93.74:  35%|███▌      | 7/20 [00:34<00:55,  4.25s/it]
Task 0, Epoch 8/20 => Loss 0.196, Train_accy 93.74:  40%|████      | 8/20 [00:34<00:50,  4.17s/it]
Task 0, Epoch 9/20 => Loss 0.177, Train_accy 94.15:  40%|████      | 8/20 [00:38<00:50,  4.17s/it]
Task 0, Epoch 9/20 => Loss 0.177, Train_accy 94.15:  45%|████▌     | 9/20 [00:38<00:45,  4.12s/it]
Task 0, Epoch 10/20 => Loss 0.137, Train_accy 94.57:  45%|████▌     | 9/20 [00:42<00:45,  4.12s/it]
Task 0, Epoch 10/20 => Loss 0.137, Train_accy 94.57:  50%|█████     | 10/20 [00:42<00:40,  4.09s/it]
Task 0, Epoch 11/20 => Loss 0.208, Train_accy 93.95, Test_accy 95.76:  50%|█████     | 10/20 [00:46<00:40,  4.09s/it]
Task 0, Epoch 11/20 => Loss 0.208, Train_accy 93.95, Test_accy 95.76:  55%|█████▌    | 11/20 [00:46<00:38,  4.32s/it]
Task 0, Epoch 12/20 => Loss 0.129, Train_accy 95.62:  55%|█████▌    | 11/20 [00:50<00:38,  4.32s/it]                 
Task 0, Epoch 12/20 => Loss 0.129, Train_accy 95.62:  60%|██████    | 12/20 [00:50<00:33,  4.24s/it]
Task 0, Epoch 13/20 => Loss 0.120, Train_accy 95.82:  60%|██████    | 12/20 [00:54<00:33,  4.24s/it]
Task 0, Epoch 13/20 => Loss 0.120, Train_accy 95.82:  65%|██████▌   | 13/20 [00:54<00:29,  4.17s/it]
Task 0, Epoch 14/20 => Loss 0.145, Train_accy 94.78:  65%|██████▌   | 13/20 [00:58<00:29,  4.17s/it]
Task 0, Epoch 14/20 => Loss 0.145, Train_accy 94.78:  70%|███████   | 14/20 [00:58<00:24,  4.12s/it]
Task 0, Epoch 15/20 => Loss 0.132, Train_accy 96.03:  70%|███████   | 14/20 [01:02<00:24,  4.12s/it]
Task 0, Epoch 15/20 => Loss 0.132, Train_accy 96.03:  75%|███████▌  | 15/20 [01:02<00:20,  4.08s/it]
Task 0, Epoch 16/20 => Loss 0.133, Train_accy 95.62, Test_accy 98.31:  75%|███████▌  | 15/20 [01:07<00:20,  4.08s/it]
Task 0, Epoch 16/20 => Loss 0.133, Train_accy 95.62, Test_accy 98.31:  80%|████████  | 16/20 [01:07<00:17,  4.36s/it]
Task 0, Epoch 17/20 => Loss 0.175, Train_accy 94.99:  80%|████████  | 16/20 [01:11<00:17,  4.36s/it]                 
Task 0, Epoch 17/20 => Loss 0.175, Train_accy 94.99:  85%|████████▌ | 17/20 [01:11<00:12,  4.24s/it]
Task 0, Epoch 18/20 => Loss 0.119, Train_accy 96.03:  85%|████████▌ | 17/20 [01:15<00:12,  4.24s/it]
Task 0, Epoch 18/20 => Loss 0.119, Train_accy 96.03:  90%|█████████ | 18/20 [01:15<00:08,  4.17s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 95.20:  90%|█████████ | 18/20 [01:20<00:08,  4.17s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 95.20:  95%|█████████▌| 19/20 [01:20<00:04,  4.14s/it]
Task 0, Epoch 20/20 => Loss 0.117, Train_accy 95.82:  95%|█████████▌| 19/20 [01:24<00:04,  4.14s/it]
Task 0, Epoch 20/20 => Loss 0.117, Train_accy 95.82: 100%|██████████| 20/20 [01:24<00:00,  4.09s/it]
Task 0, Epoch 20/20 => Loss 0.117, Train_accy 95.82: 100%|██████████| 20/20 [01:24<00:00,  4.20s/it]2024-09-12 14:17:30,808 [der.py] => Task 0, Epoch 20/20 => Loss 0.117, Train_accy 95.82
2024-09-12 14:17:30,809 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 14:17:42,562 [der.py] => Exemplar size: 200
2024-09-12 14:17:42,562 [trainer.py] => CNN: {'total': 99.15, '00-09': 99.15, 'old': 0, 'new': 99.15}
2024-09-12 14:17:42,562 [trainer.py] => NME: {'total': 98.31, '00-09': 98.31, 'old': 0, 'new': 98.31}
2024-09-12 14:17:42,562 [trainer.py] => CNN top1 curve: [99.15]
2024-09-12 14:17:42,562 [trainer.py] => CNN top5 curve: [100.0]
2024-09-12 14:17:42,562 [trainer.py] => NME top1 curve: [98.31]
2024-09-12 14:17:42,562 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.15
Average Accuracy (NME): 98.31
2024-09-12 14:17:42,562 [trainer.py] => Average Accuracy (CNN): 99.15
2024-09-12 14:17:42,562 [trainer.py] => Average Accuracy (NME): 98.31
2024-09-12 14:17:42,563 [trainer.py] => All params: 85814805
2024-09-12 14:17:42,564 [trainer.py] => Trainable params: 85814805
2024-09-12 14:17:44,133 [der.py] => Learning on 10-20
2024-09-12 14:17:44,135 [der.py] => All params: 171636511
2024-09-12 14:17:44,136 [der.py] => Trainable params: 85837855

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.326, Loss_clf 1.835, Loss_aux 1.491, Train_accy 58.32, Test_accy 87.04:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.326, Loss_clf 1.835, Loss_aux 1.491, Train_accy 58.32, Test_accy 87.04:   5%|▌         | 1/20 [00:09<02:55,  9.25s/it]
Task 1, Epoch 2/20 => Loss 0.961, Loss_clf 0.484, Loss_aux 0.476, Train_accy 86.66:   5%|▌         | 1/20 [00:16<02:55,  9.25s/it]                 
Task 1, Epoch 2/20 => Loss 0.961, Loss_clf 0.484, Loss_aux 0.476, Train_accy 86.66:  10%|█         | 2/20 [00:16<02:26,  8.16s/it]
Task 1, Epoch 3/20 => Loss 0.604, Loss_clf 0.306, Loss_aux 0.299, Train_accy 88.91:  10%|█         | 2/20 [00:23<02:26,  8.16s/it]
Task 1, Epoch 3/20 => Loss 0.604, Loss_clf 0.306, Loss_aux 0.299, Train_accy 88.91:  15%|█▌        | 3/20 [00:23<02:11,  7.72s/it]
Task 1, Epoch 4/20 => Loss 0.533, Loss_clf 0.264, Loss_aux 0.269, Train_accy 90.85:  15%|█▌        | 3/20 [00:31<02:11,  7.72s/it]
Task 1, Epoch 4/20 => Loss 0.533, Loss_clf 0.264, Loss_aux 0.269, Train_accy 90.85:  20%|██        | 4/20 [00:31<02:00,  7.51s/it]
Task 1, Epoch 5/20 => Loss 0.488, Loss_clf 0.250, Loss_aux 0.237, Train_accy 91.30:  20%|██        | 4/20 [00:38<02:00,  7.51s/it]
Task 1, Epoch 5/20 => Loss 0.488, Loss_clf 0.250, Loss_aux 0.237, Train_accy 91.30:  25%|██▌       | 5/20 [00:38<01:50,  7.39s/it]
Task 1, Epoch 6/20 => Loss 0.468, Loss_clf 0.245, Loss_aux 0.223, Train_accy 92.35, Test_accy 95.55:  25%|██▌       | 5/20 [00:47<01:50,  7.39s/it]
Task 1, Epoch 6/20 => Loss 0.468, Loss_clf 0.245, Loss_aux 0.223, Train_accy 92.35, Test_accy 95.55:  30%|███       | 6/20 [00:47<01:51,  7.97s/it]
Task 1, Epoch 7/20 => Loss 0.494, Loss_clf 0.239, Loss_aux 0.255, Train_accy 91.30:  30%|███       | 6/20 [00:54<01:51,  7.97s/it]                 
Task 1, Epoch 7/20 => Loss 0.494, Loss_clf 0.239, Loss_aux 0.255, Train_accy 91.30:  35%|███▌      | 7/20 [00:54<01:40,  7.71s/it]
Task 1, Epoch 8/20 => Loss 0.469, Loss_clf 0.234, Loss_aux 0.235, Train_accy 91.90:  35%|███▌      | 7/20 [01:01<01:40,  7.71s/it]
Task 1, Epoch 8/20 => Loss 0.469, Loss_clf 0.234, Loss_aux 0.235, Train_accy 91.90:  40%|████      | 8/20 [01:01<01:30,  7.55s/it]
Task 1, Epoch 9/20 => Loss 0.368, Loss_clf 0.195, Loss_aux 0.173, Train_accy 93.25:  40%|████      | 8/20 [01:08<01:30,  7.55s/it]
Task 1, Epoch 9/20 => Loss 0.368, Loss_clf 0.195, Loss_aux 0.173, Train_accy 93.25:  45%|████▌     | 9/20 [01:08<01:21,  7.45s/it]
Task 1, Epoch 10/20 => Loss 0.348, Loss_clf 0.181, Loss_aux 0.167, Train_accy 94.30:  45%|████▌     | 9/20 [01:16<01:21,  7.45s/it]
Task 1, Epoch 10/20 => Loss 0.348, Loss_clf 0.181, Loss_aux 0.167, Train_accy 94.30:  50%|█████     | 10/20 [01:16<01:13,  7.37s/it]
Task 1, Epoch 11/20 => Loss 0.323, Loss_clf 0.160, Loss_aux 0.163, Train_accy 94.75, Test_accy 97.17:  50%|█████     | 10/20 [01:25<01:13,  7.37s/it]
Task 1, Epoch 11/20 => Loss 0.323, Loss_clf 0.160, Loss_aux 0.163, Train_accy 94.75, Test_accy 97.17:  55%|█████▌    | 11/20 [01:25<01:11,  7.92s/it]
Task 1, Epoch 12/20 => Loss 0.417, Loss_clf 0.222, Loss_aux 0.196, Train_accy 92.50:  55%|█████▌    | 11/20 [01:32<01:11,  7.92s/it]                 
Task 1, Epoch 12/20 => Loss 0.417, Loss_clf 0.222, Loss_aux 0.196, Train_accy 92.50:  60%|██████    | 12/20 [01:32<01:01,  7.70s/it]
Task 1, Epoch 13/20 => Loss 0.382, Loss_clf 0.186, Loss_aux 0.196, Train_accy 93.55:  60%|██████    | 12/20 [01:39<01:01,  7.70s/it]
Task 1, Epoch 13/20 => Loss 0.382, Loss_clf 0.186, Loss_aux 0.196, Train_accy 93.55:  65%|██████▌   | 13/20 [01:39<00:52,  7.56s/it]
Task 1, Epoch 14/20 => Loss 0.305, Loss_clf 0.149, Loss_aux 0.156, Train_accy 95.35:  65%|██████▌   | 13/20 [01:46<00:52,  7.56s/it]
Task 1, Epoch 14/20 => Loss 0.305, Loss_clf 0.149, Loss_aux 0.156, Train_accy 95.35:  70%|███████   | 14/20 [01:46<00:44,  7.45s/it]
Task 1, Epoch 15/20 => Loss 0.337, Loss_clf 0.179, Loss_aux 0.158, Train_accy 94.60:  70%|███████   | 14/20 [01:54<00:44,  7.45s/it]
Task 1, Epoch 15/20 => Loss 0.337, Loss_clf 0.179, Loss_aux 0.158, Train_accy 94.60:  75%|███████▌  | 15/20 [01:54<00:36,  7.37s/it]
Task 1, Epoch 16/20 => Loss 0.276, Loss_clf 0.149, Loss_aux 0.127, Train_accy 95.50, Test_accy 96.76:  75%|███████▌  | 15/20 [02:03<00:36,  7.37s/it]
Task 1, Epoch 16/20 => Loss 0.276, Loss_clf 0.149, Loss_aux 0.127, Train_accy 95.50, Test_accy 96.76:  80%|████████  | 16/20 [02:03<00:31,  7.93s/it]
Task 1, Epoch 17/20 => Loss 0.293, Loss_clf 0.163, Loss_aux 0.129, Train_accy 95.35:  80%|████████  | 16/20 [02:10<00:31,  7.93s/it]                 
Task 1, Epoch 17/20 => Loss 0.293, Loss_clf 0.163, Loss_aux 0.129, Train_accy 95.35:  85%|████████▌ | 17/20 [02:10<00:23,  7.69s/it]
Task 1, Epoch 18/20 => Loss 0.337, Loss_clf 0.173, Loss_aux 0.165, Train_accy 93.85:  85%|████████▌ | 17/20 [02:17<00:23,  7.69s/it]
Task 1, Epoch 18/20 => Loss 0.337, Loss_clf 0.173, Loss_aux 0.165, Train_accy 93.85:  90%|█████████ | 18/20 [02:17<00:15,  7.54s/it]
Task 1, Epoch 19/20 => Loss 0.325, Loss_clf 0.168, Loss_aux 0.157, Train_accy 94.60:  90%|█████████ | 18/20 [02:24<00:15,  7.54s/it]
Task 1, Epoch 19/20 => Loss 0.325, Loss_clf 0.168, Loss_aux 0.157, Train_accy 94.60:  95%|█████████▌| 19/20 [02:24<00:07,  7.44s/it]
Task 1, Epoch 20/20 => Loss 0.344, Loss_clf 0.179, Loss_aux 0.165, Train_accy 93.85:  95%|█████████▌| 19/20 [02:32<00:07,  7.44s/it]
Task 1, Epoch 20/20 => Loss 0.344, Loss_clf 0.179, Loss_aux 0.165, Train_accy 93.85: 100%|██████████| 20/20 [02:32<00:00,  7.37s/it]
Task 1, Epoch 20/20 => Loss 0.344, Loss_clf 0.179, Loss_aux 0.165, Train_accy 93.85: 100%|██████████| 20/20 [02:32<00:00,  7.60s/it]2024-09-12 14:20:16,228 [der.py] => Task 1, Epoch 20/20 => Loss 0.344, Loss_clf 0.179, Loss_aux 0.165, Train_accy 93.85
2024-09-12 14:20:16,229 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 14:20:36,740 [der.py] => Exemplar size: 400
2024-09-12 14:20:36,741 [trainer.py] => CNN: {'total': 97.98, '00-09': 98.31, '10-19': 97.67, 'old': 98.31, 'new': 97.67}
2024-09-12 14:20:36,741 [trainer.py] => NME: {'total': 97.98, '00-09': 97.46, '10-19': 98.45, 'old': 97.46, 'new': 98.45}
2024-09-12 14:20:36,741 [trainer.py] => CNN top1 curve: [99.15, 97.98]
2024-09-12 14:20:36,741 [trainer.py] => CNN top5 curve: [100.0, 99.6]
2024-09-12 14:20:36,741 [trainer.py] => NME top1 curve: [98.31, 97.98]
2024-09-12 14:20:36,741 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 98.56
Average Accuracy (NME): 98.15
2024-09-12 14:20:36,741 [trainer.py] => Average Accuracy (CNN): 98.56
2024-09-12 14:20:36,741 [trainer.py] => Average Accuracy (NME): 98.15
2024-09-12 14:20:36,743 [trainer.py] => All params: 171636511
2024-09-12 14:20:36,745 [trainer.py] => Trainable params: 85837855
2024-09-12 14:20:38,266 [der.py] => Learning on 20-30
2024-09-12 14:20:38,268 [der.py] => All params: 257473577
2024-09-12 14:20:38,270 [der.py] => Trainable params: 85876265

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.698, Loss_clf 2.438, Loss_aux 1.260, Train_accy 60.84, Test_accy 81.40:   0%|          | 0/20 [00:15<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.698, Loss_clf 2.438, Loss_aux 1.260, Train_accy 60.84, Test_accy 81.40:   5%|▌         | 1/20 [00:15<04:45, 15.03s/it]
Task 2, Epoch 2/20 => Loss 0.784, Loss_clf 0.450, Loss_aux 0.335, Train_accy 88.36:   5%|▌         | 1/20 [00:26<04:45, 15.03s/it]                 
Task 2, Epoch 2/20 => Loss 0.784, Loss_clf 0.450, Loss_aux 0.335, Train_accy 88.36:  10%|█         | 2/20 [00:26<03:54, 13.04s/it]
Task 2, Epoch 3/20 => Loss 0.393, Loss_clf 0.211, Loss_aux 0.181, Train_accy 93.26:  10%|█         | 2/20 [00:38<03:54, 13.04s/it]
Task 2, Epoch 3/20 => Loss 0.393, Loss_clf 0.211, Loss_aux 0.181, Train_accy 93.26:  15%|█▌        | 3/20 [00:38<03:30, 12.37s/it]
Task 2, Epoch 4/20 => Loss 0.377, Loss_clf 0.205, Loss_aux 0.172, Train_accy 91.67:  15%|█▌        | 3/20 [00:49<03:30, 12.37s/it]
Task 2, Epoch 4/20 => Loss 0.377, Loss_clf 0.205, Loss_aux 0.172, Train_accy 91.67:  20%|██        | 4/20 [00:49<03:12, 12.06s/it]
Task 2, Epoch 5/20 => Loss 0.373, Loss_clf 0.214, Loss_aux 0.160, Train_accy 93.72:  20%|██        | 4/20 [01:01<03:12, 12.06s/it]
Task 2, Epoch 5/20 => Loss 0.373, Loss_clf 0.214, Loss_aux 0.160, Train_accy 93.72:  25%|██▌       | 5/20 [01:01<02:58, 11.89s/it]
Task 2, Epoch 6/20 => Loss 0.337, Loss_clf 0.216, Loss_aux 0.122, Train_accy 94.06, Test_accy 96.51:  25%|██▌       | 5/20 [01:16<02:58, 11.89s/it]
Task 2, Epoch 6/20 => Loss 0.337, Loss_clf 0.216, Loss_aux 0.122, Train_accy 94.06, Test_accy 96.51:  30%|███       | 6/20 [01:16<03:01, 12.93s/it]
Task 2, Epoch 7/20 => Loss 0.293, Loss_clf 0.177, Loss_aux 0.116, Train_accy 95.78:  30%|███       | 6/20 [01:27<03:01, 12.93s/it]                 
Task 2, Epoch 7/20 => Loss 0.293, Loss_clf 0.177, Loss_aux 0.116, Train_accy 95.78:  35%|███▌      | 7/20 [01:27<02:42, 12.48s/it]
Task 2, Epoch 8/20 => Loss 0.344, Loss_clf 0.203, Loss_aux 0.141, Train_accy 93.72:  35%|███▌      | 7/20 [01:39<02:42, 12.48s/it]
Task 2, Epoch 8/20 => Loss 0.344, Loss_clf 0.203, Loss_aux 0.141, Train_accy 93.72:  40%|████      | 8/20 [01:39<02:26, 12.20s/it]
Task 2, Epoch 9/20 => Loss 0.317, Loss_clf 0.174, Loss_aux 0.143, Train_accy 94.63:  40%|████      | 8/20 [01:51<02:26, 12.20s/it]
Task 2, Epoch 9/20 => Loss 0.317, Loss_clf 0.174, Loss_aux 0.143, Train_accy 94.63:  45%|████▌     | 9/20 [01:51<02:12, 12.01s/it]
Task 2, Epoch 10/20 => Loss 0.400, Loss_clf 0.229, Loss_aux 0.171, Train_accy 93.49:  45%|████▌     | 9/20 [02:02<02:12, 12.01s/it]
Task 2, Epoch 10/20 => Loss 0.400, Loss_clf 0.229, Loss_aux 0.171, Train_accy 93.49:  50%|█████     | 10/20 [02:02<01:58, 11.86s/it]
Task 2, Epoch 11/20 => Loss 0.326, Loss_clf 0.179, Loss_aux 0.147, Train_accy 94.63, Test_accy 96.80:  50%|█████     | 10/20 [02:17<01:58, 11.86s/it]
Task 2, Epoch 11/20 => Loss 0.326, Loss_clf 0.179, Loss_aux 0.147, Train_accy 94.63, Test_accy 96.80:  55%|█████▌    | 11/20 [02:17<01:55, 12.82s/it]
Task 2, Epoch 12/20 => Loss 0.283, Loss_clf 0.157, Loss_aux 0.126, Train_accy 94.75:  55%|█████▌    | 11/20 [02:29<01:55, 12.82s/it]                 
Task 2, Epoch 12/20 => Loss 0.283, Loss_clf 0.157, Loss_aux 0.126, Train_accy 94.75:  60%|██████    | 12/20 [02:29<01:39, 12.44s/it]
Task 2, Epoch 13/20 => Loss 0.295, Loss_clf 0.184, Loss_aux 0.111, Train_accy 94.63:  60%|██████    | 12/20 [02:40<01:39, 12.44s/it]
Task 2, Epoch 13/20 => Loss 0.295, Loss_clf 0.184, Loss_aux 0.111, Train_accy 94.63:  65%|██████▌   | 13/20 [02:40<01:25, 12.21s/it]
Task 2, Epoch 14/20 => Loss 0.344, Loss_clf 0.195, Loss_aux 0.150, Train_accy 94.75:  65%|██████▌   | 13/20 [02:52<01:25, 12.21s/it]
Task 2, Epoch 14/20 => Loss 0.344, Loss_clf 0.195, Loss_aux 0.150, Train_accy 94.75:  70%|███████   | 14/20 [02:52<01:12, 12.02s/it]
Task 2, Epoch 15/20 => Loss 0.247, Loss_clf 0.139, Loss_aux 0.107, Train_accy 95.55:  70%|███████   | 14/20 [03:04<01:12, 12.02s/it]
Task 2, Epoch 15/20 => Loss 0.247, Loss_clf 0.139, Loss_aux 0.107, Train_accy 95.55:  75%|███████▌  | 15/20 [03:04<00:59, 11.89s/it]
Task 2, Epoch 16/20 => Loss 0.249, Loss_clf 0.165, Loss_aux 0.084, Train_accy 96.00, Test_accy 97.38:  75%|███████▌  | 15/20 [03:19<00:59, 11.89s/it]
Task 2, Epoch 16/20 => Loss 0.249, Loss_clf 0.165, Loss_aux 0.084, Train_accy 96.00, Test_accy 97.38:  80%|████████  | 16/20 [03:19<00:51, 12.82s/it]
Task 2, Epoch 17/20 => Loss 0.241, Loss_clf 0.157, Loss_aux 0.084, Train_accy 95.09:  80%|████████  | 16/20 [03:30<00:51, 12.82s/it]                 
Task 2, Epoch 17/20 => Loss 0.241, Loss_clf 0.157, Loss_aux 0.084, Train_accy 95.09:  85%|████████▌ | 17/20 [03:30<00:37, 12.44s/it]
Task 2, Epoch 18/20 => Loss 0.185, Loss_clf 0.112, Loss_aux 0.073, Train_accy 97.15:  85%|████████▌ | 17/20 [03:42<00:37, 12.44s/it]
Task 2, Epoch 18/20 => Loss 0.185, Loss_clf 0.112, Loss_aux 0.073, Train_accy 97.15:  90%|█████████ | 18/20 [03:42<00:24, 12.18s/it]
Task 2, Epoch 19/20 => Loss 0.202, Loss_clf 0.124, Loss_aux 0.079, Train_accy 96.46:  90%|█████████ | 18/20 [03:53<00:24, 12.18s/it]
Task 2, Epoch 19/20 => Loss 0.202, Loss_clf 0.124, Loss_aux 0.079, Train_accy 96.46:  95%|█████████▌| 19/20 [03:53<00:12, 12.01s/it]
Task 2, Epoch 20/20 => Loss 0.290, Loss_clf 0.174, Loss_aux 0.116, Train_accy 94.86:  95%|█████████▌| 19/20 [04:05<00:12, 12.01s/it]
Task 2, Epoch 20/20 => Loss 0.290, Loss_clf 0.174, Loss_aux 0.116, Train_accy 94.86: 100%|██████████| 20/20 [04:05<00:00, 11.88s/it]
Task 2, Epoch 20/20 => Loss 0.290, Loss_clf 0.174, Loss_aux 0.116, Train_accy 94.86: 100%|██████████| 20/20 [04:05<00:00, 12.27s/it]2024-09-12 14:24:43,704 [der.py] => Task 2, Epoch 20/20 => Loss 0.290, Loss_clf 0.174, Loss_aux 0.116, Train_accy 94.86
2024-09-12 14:24:43,705 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 14:25:14,759 [der.py] => Exemplar size: 600
2024-09-12 14:25:14,759 [trainer.py] => CNN: {'total': 97.09, '00-09': 96.61, '10-19': 96.9, '20-29': 97.94, 'old': 96.76, 'new': 97.94}
2024-09-12 14:25:14,759 [trainer.py] => NME: {'total': 97.67, '00-09': 96.61, '10-19': 98.45, '20-29': 97.94, 'old': 97.57, 'new': 97.94}
2024-09-12 14:25:14,759 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09]
2024-09-12 14:25:14,759 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42]
2024-09-12 14:25:14,759 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67]
2024-09-12 14:25:14,759 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71]

Average Accuracy (CNN): 98.07
Average Accuracy (NME): 97.99
2024-09-12 14:25:14,759 [trainer.py] => Average Accuracy (CNN): 98.07
2024-09-12 14:25:14,760 [trainer.py] => Average Accuracy (NME): 97.99
2024-09-12 14:25:14,762 [trainer.py] => All params: 257473577
2024-09-12 14:25:14,764 [trainer.py] => Trainable params: 85876265
2024-09-12 14:25:16,560 [der.py] => Learning on 30-40
2024-09-12 14:25:16,565 [der.py] => All params: 343326003
2024-09-12 14:25:16,567 [der.py] => Trainable params: 85930035

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.892, Loss_clf 1.670, Loss_aux 1.222, Train_accy 68.57, Test_accy 87.67:   0%|          | 0/20 [00:22<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.892, Loss_clf 1.670, Loss_aux 1.222, Train_accy 68.57, Test_accy 87.67:   5%|▌         | 1/20 [00:22<07:06, 22.46s/it]
Task 3, Epoch 2/20 => Loss 0.725, Loss_clf 0.359, Loss_aux 0.366, Train_accy 88.49:   5%|▌         | 1/20 [00:39<07:06, 22.46s/it]                 
Task 3, Epoch 2/20 => Loss 0.725, Loss_clf 0.359, Loss_aux 0.366, Train_accy 88.49:  10%|█         | 2/20 [00:39<05:44, 19.12s/it]
Task 3, Epoch 3/20 => Loss 0.483, Loss_clf 0.278, Loss_aux 0.206, Train_accy 91.02:  10%|█         | 2/20 [00:56<05:44, 19.12s/it]
Task 3, Epoch 3/20 => Loss 0.483, Loss_clf 0.278, Loss_aux 0.206, Train_accy 91.02:  15%|█▌        | 3/20 [00:56<05:06, 18.04s/it]
Task 3, Epoch 4/20 => Loss 0.395, Loss_clf 0.242, Loss_aux 0.153, Train_accy 92.52:  15%|█▌        | 3/20 [01:12<05:06, 18.04s/it]
Task 3, Epoch 4/20 => Loss 0.395, Loss_clf 0.242, Loss_aux 0.153, Train_accy 92.52:  20%|██        | 4/20 [01:12<04:40, 17.55s/it]
Task 3, Epoch 5/20 => Loss 0.379, Loss_clf 0.223, Loss_aux 0.156, Train_accy 93.17:  20%|██        | 4/20 [01:29<04:40, 17.55s/it]
Task 3, Epoch 5/20 => Loss 0.379, Loss_clf 0.223, Loss_aux 0.156, Train_accy 93.17:  25%|██▌       | 5/20 [01:29<04:18, 17.26s/it]
Task 3, Epoch 6/20 => Loss 0.562, Loss_clf 0.320, Loss_aux 0.242, Train_accy 91.39, Test_accy 93.39:  25%|██▌       | 5/20 [01:51<04:18, 17.26s/it]
Task 3, Epoch 6/20 => Loss 0.562, Loss_clf 0.320, Loss_aux 0.242, Train_accy 91.39, Test_accy 93.39:  30%|███       | 6/20 [01:51<04:25, 18.99s/it]
Task 3, Epoch 7/20 => Loss 0.387, Loss_clf 0.208, Loss_aux 0.179, Train_accy 93.64:  30%|███       | 6/20 [02:08<04:25, 18.99s/it]                 
Task 3, Epoch 7/20 => Loss 0.387, Loss_clf 0.208, Loss_aux 0.179, Train_accy 93.64:  35%|███▌      | 7/20 [02:08<03:57, 18.29s/it]
Task 3, Epoch 8/20 => Loss 0.339, Loss_clf 0.192, Loss_aux 0.147, Train_accy 93.92:  35%|███▌      | 7/20 [02:25<03:57, 18.29s/it]
Task 3, Epoch 8/20 => Loss 0.339, Loss_clf 0.192, Loss_aux 0.147, Train_accy 93.92:  40%|████      | 8/20 [02:25<03:33, 17.83s/it]
Task 3, Epoch 9/20 => Loss 0.265, Loss_clf 0.156, Loss_aux 0.109, Train_accy 95.14:  40%|████      | 8/20 [02:42<03:33, 17.83s/it]
Task 3, Epoch 9/20 => Loss 0.265, Loss_clf 0.156, Loss_aux 0.109, Train_accy 95.14:  45%|████▌     | 9/20 [02:42<03:12, 17.51s/it]
Task 3, Epoch 10/20 => Loss 0.372, Loss_clf 0.212, Loss_aux 0.160, Train_accy 93.64:  45%|████▌     | 9/20 [02:59<03:12, 17.51s/it]
Task 3, Epoch 10/20 => Loss 0.372, Loss_clf 0.212, Loss_aux 0.160, Train_accy 93.64:  50%|█████     | 10/20 [02:59<02:52, 17.29s/it]
Task 3, Epoch 11/20 => Loss 0.333, Loss_clf 0.205, Loss_aux 0.129, Train_accy 94.29, Test_accy 94.27:  50%|█████     | 10/20 [03:21<02:52, 17.29s/it]
Task 3, Epoch 11/20 => Loss 0.333, Loss_clf 0.205, Loss_aux 0.129, Train_accy 94.29, Test_accy 94.27:  55%|█████▌    | 11/20 [03:21<02:49, 18.81s/it]
Task 3, Epoch 12/20 => Loss 0.347, Loss_clf 0.199, Loss_aux 0.147, Train_accy 94.29:  55%|█████▌    | 11/20 [03:38<02:49, 18.81s/it]                 
Task 3, Epoch 12/20 => Loss 0.347, Loss_clf 0.199, Loss_aux 0.147, Train_accy 94.29:  60%|██████    | 12/20 [03:38<02:25, 18.19s/it]
Task 3, Epoch 13/20 => Loss 0.342, Loss_clf 0.194, Loss_aux 0.148, Train_accy 94.01:  60%|██████    | 12/20 [03:55<02:25, 18.19s/it]
Task 3, Epoch 13/20 => Loss 0.342, Loss_clf 0.194, Loss_aux 0.148, Train_accy 94.01:  65%|██████▌   | 13/20 [03:55<02:04, 17.77s/it]
Task 3, Epoch 14/20 => Loss 0.300, Loss_clf 0.182, Loss_aux 0.118, Train_accy 94.57:  65%|██████▌   | 13/20 [04:11<02:04, 17.77s/it]
Task 3, Epoch 14/20 => Loss 0.300, Loss_clf 0.182, Loss_aux 0.118, Train_accy 94.57:  70%|███████   | 14/20 [04:11<01:44, 17.47s/it]
Task 3, Epoch 15/20 => Loss 0.293, Loss_clf 0.165, Loss_aux 0.128, Train_accy 94.95:  70%|███████   | 14/20 [04:28<01:44, 17.47s/it]
Task 3, Epoch 15/20 => Loss 0.293, Loss_clf 0.165, Loss_aux 0.128, Train_accy 94.95:  75%|███████▌  | 15/20 [04:28<01:26, 17.28s/it]
Task 3, Epoch 16/20 => Loss 0.335, Loss_clf 0.206, Loss_aux 0.129, Train_accy 94.01, Test_accy 95.15:  75%|███████▌  | 15/20 [04:50<01:26, 17.28s/it]
Task 3, Epoch 16/20 => Loss 0.335, Loss_clf 0.206, Loss_aux 0.129, Train_accy 94.01, Test_accy 95.15:  80%|████████  | 16/20 [04:50<01:15, 18.76s/it]
Task 3, Epoch 17/20 => Loss 0.337, Loss_clf 0.203, Loss_aux 0.134, Train_accy 94.20:  80%|████████  | 16/20 [05:07<01:15, 18.76s/it]                 
Task 3, Epoch 17/20 => Loss 0.337, Loss_clf 0.203, Loss_aux 0.134, Train_accy 94.20:  85%|████████▌ | 17/20 [05:07<00:54, 18.17s/it]
Task 3, Epoch 18/20 => Loss 0.264, Loss_clf 0.162, Loss_aux 0.102, Train_accy 94.48:  85%|████████▌ | 17/20 [05:24<00:54, 18.17s/it]
Task 3, Epoch 18/20 => Loss 0.264, Loss_clf 0.162, Loss_aux 0.102, Train_accy 94.48:  90%|█████████ | 18/20 [05:24<00:35, 17.78s/it]
Task 3, Epoch 19/20 => Loss 0.317, Loss_clf 0.191, Loss_aux 0.126, Train_accy 94.39:  90%|█████████ | 18/20 [05:41<00:35, 17.78s/it]
Task 3, Epoch 19/20 => Loss 0.317, Loss_clf 0.191, Loss_aux 0.126, Train_accy 94.39:  95%|█████████▌| 19/20 [05:41<00:17, 17.47s/it]
Task 3, Epoch 20/20 => Loss 0.319, Loss_clf 0.199, Loss_aux 0.120, Train_accy 94.01:  95%|█████████▌| 19/20 [05:58<00:17, 17.47s/it]
Task 3, Epoch 20/20 => Loss 0.319, Loss_clf 0.199, Loss_aux 0.120, Train_accy 94.01: 100%|██████████| 20/20 [05:58<00:00, 17.26s/it]
Task 3, Epoch 20/20 => Loss 0.319, Loss_clf 0.199, Loss_aux 0.120, Train_accy 94.01: 100%|██████████| 20/20 [05:58<00:00, 17.90s/it]2024-09-12 14:31:14,637 [der.py] => Task 3, Epoch 20/20 => Loss 0.319, Loss_clf 0.199, Loss_aux 0.120, Train_accy 94.01
2024-09-12 14:31:14,639 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 14:32:00,875 [der.py] => Exemplar size: 800
2024-09-12 14:32:00,875 [trainer.py] => CNN: {'total': 95.59, '00-09': 96.61, '10-19': 95.35, '20-29': 95.88, '30-39': 94.55, 'old': 95.93, 'new': 94.55}
2024-09-12 14:32:00,875 [trainer.py] => NME: {'total': 96.26, '00-09': 96.61, '10-19': 97.67, '20-29': 96.91, '30-39': 93.64, 'old': 97.09, 'new': 93.64}
2024-09-12 14:32:00,875 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59]
2024-09-12 14:32:00,875 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34]
2024-09-12 14:32:00,875 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26]
2024-09-12 14:32:00,876 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34]

Average Accuracy (CNN): 97.45
Average Accuracy (NME): 97.56
2024-09-12 14:32:00,876 [trainer.py] => Average Accuracy (CNN): 97.45
2024-09-12 14:32:00,876 [trainer.py] => Average Accuracy (NME): 97.56
2024-09-12 14:32:00,878 [trainer.py] => All params: 343326003
2024-09-12 14:32:00,881 [trainer.py] => Trainable params: 85930035
2024-09-12 14:32:03,806 [der.py] => Learning on 40-50
2024-09-12 14:32:03,815 [der.py] => All params: 429193789
2024-09-12 14:32:03,818 [der.py] => Trainable params: 85999165

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.255, Loss_clf 1.205, Loss_aux 1.050, Train_accy 76.52, Test_accy 89.48:   0%|          | 0/20 [00:31<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.255, Loss_clf 1.205, Loss_aux 1.050, Train_accy 76.52, Test_accy 89.48:   5%|▌         | 1/20 [00:31<09:52, 31.19s/it]
Task 4, Epoch 2/20 => Loss 0.639, Loss_clf 0.322, Loss_aux 0.317, Train_accy 91.33:   5%|▌         | 1/20 [00:54<09:52, 31.19s/it]                 
Task 4, Epoch 2/20 => Loss 0.639, Loss_clf 0.322, Loss_aux 0.317, Train_accy 91.33:  10%|█         | 2/20 [00:54<07:55, 26.40s/it]
Task 4, Epoch 3/20 => Loss 0.489, Loss_clf 0.294, Loss_aux 0.195, Train_accy 91.88:  10%|█         | 2/20 [01:17<07:55, 26.40s/it]
Task 4, Epoch 3/20 => Loss 0.489, Loss_clf 0.294, Loss_aux 0.195, Train_accy 91.88:  15%|█▌        | 3/20 [01:17<07:04, 24.97s/it]
Task 4, Epoch 4/20 => Loss 0.458, Loss_clf 0.271, Loss_aux 0.187, Train_accy 92.12:  15%|█▌        | 3/20 [01:40<07:04, 24.97s/it]
Task 4, Epoch 4/20 => Loss 0.458, Loss_clf 0.271, Loss_aux 0.187, Train_accy 92.12:  20%|██        | 4/20 [01:40<06:27, 24.25s/it]
Task 4, Epoch 5/20 => Loss 0.336, Loss_clf 0.206, Loss_aux 0.131, Train_accy 94.33:  20%|██        | 4/20 [02:03<06:27, 24.25s/it]
Task 4, Epoch 5/20 => Loss 0.336, Loss_clf 0.206, Loss_aux 0.131, Train_accy 94.33:  25%|██▌       | 5/20 [02:03<05:57, 23.85s/it]
Task 4, Epoch 6/20 => Loss 0.409, Loss_clf 0.245, Loss_aux 0.164, Train_accy 93.07, Test_accy 93.23:  25%|██▌       | 5/20 [02:35<05:57, 23.85s/it]
Task 4, Epoch 6/20 => Loss 0.409, Loss_clf 0.245, Loss_aux 0.164, Train_accy 93.07, Test_accy 93.23:  30%|███       | 6/20 [02:35<06:09, 26.37s/it]
Task 4, Epoch 7/20 => Loss 0.405, Loss_clf 0.259, Loss_aux 0.146, Train_accy 92.43:  30%|███       | 6/20 [02:58<06:09, 26.37s/it]                 
Task 4, Epoch 7/20 => Loss 0.405, Loss_clf 0.259, Loss_aux 0.146, Train_accy 92.43:  35%|███▌      | 7/20 [02:58<05:29, 25.32s/it]
Task 4, Epoch 8/20 => Loss 0.295, Loss_clf 0.190, Loss_aux 0.106, Train_accy 94.64:  35%|███▌      | 7/20 [03:21<05:29, 25.32s/it]
Task 4, Epoch 8/20 => Loss 0.295, Loss_clf 0.190, Loss_aux 0.106, Train_accy 94.64:  40%|████      | 8/20 [03:21<04:55, 24.62s/it]
Task 4, Epoch 9/20 => Loss 0.408, Loss_clf 0.238, Loss_aux 0.170, Train_accy 93.14:  40%|████      | 8/20 [03:44<04:55, 24.62s/it]
Task 4, Epoch 9/20 => Loss 0.408, Loss_clf 0.238, Loss_aux 0.170, Train_accy 93.14:  45%|████▌     | 9/20 [03:44<04:25, 24.18s/it]
Task 4, Epoch 10/20 => Loss 0.359, Loss_clf 0.211, Loss_aux 0.149, Train_accy 93.93:  45%|████▌     | 9/20 [04:07<04:25, 24.18s/it]
Task 4, Epoch 10/20 => Loss 0.359, Loss_clf 0.211, Loss_aux 0.149, Train_accy 93.93:  50%|█████     | 10/20 [04:07<03:58, 23.85s/it]
Task 4, Epoch 11/20 => Loss 0.307, Loss_clf 0.162, Loss_aux 0.145, Train_accy 94.88, Test_accy 92.87:  50%|█████     | 10/20 [04:38<03:58, 23.85s/it]
Task 4, Epoch 11/20 => Loss 0.307, Loss_clf 0.162, Loss_aux 0.145, Train_accy 94.88, Test_accy 92.87:  55%|█████▌    | 11/20 [04:38<03:55, 26.13s/it]
Task 4, Epoch 12/20 => Loss 0.377, Loss_clf 0.216, Loss_aux 0.161, Train_accy 94.17:  55%|█████▌    | 11/20 [05:02<03:55, 26.13s/it]                 
Task 4, Epoch 12/20 => Loss 0.377, Loss_clf 0.216, Loss_aux 0.161, Train_accy 94.17:  60%|██████    | 12/20 [05:02<03:21, 25.24s/it]
Task 4, Epoch 13/20 => Loss 0.375, Loss_clf 0.240, Loss_aux 0.134, Train_accy 92.99:  60%|██████    | 12/20 [05:25<03:21, 25.24s/it]
Task 4, Epoch 13/20 => Loss 0.375, Loss_clf 0.240, Loss_aux 0.134, Train_accy 92.99:  65%|██████▌   | 13/20 [05:25<02:52, 24.62s/it]
Task 4, Epoch 14/20 => Loss 0.296, Loss_clf 0.189, Loss_aux 0.107, Train_accy 94.41:  65%|██████▌   | 13/20 [05:48<02:52, 24.62s/it]
Task 4, Epoch 14/20 => Loss 0.296, Loss_clf 0.189, Loss_aux 0.107, Train_accy 94.41:  70%|███████   | 14/20 [05:48<02:25, 24.20s/it]
Task 4, Epoch 15/20 => Loss 0.335, Loss_clf 0.199, Loss_aux 0.136, Train_accy 94.41:  70%|███████   | 14/20 [06:11<02:25, 24.20s/it]
Task 4, Epoch 15/20 => Loss 0.335, Loss_clf 0.199, Loss_aux 0.136, Train_accy 94.41:  75%|███████▌  | 15/20 [06:11<01:59, 23.88s/it]
Task 4, Epoch 16/20 => Loss 0.278, Loss_clf 0.172, Loss_aux 0.106, Train_accy 95.04, Test_accy 92.51:  75%|███████▌  | 15/20 [06:42<01:59, 23.88s/it]
Task 4, Epoch 16/20 => Loss 0.278, Loss_clf 0.172, Loss_aux 0.106, Train_accy 95.04, Test_accy 92.51:  80%|████████  | 16/20 [06:42<01:44, 26.08s/it]
Task 4, Epoch 17/20 => Loss 0.307, Loss_clf 0.197, Loss_aux 0.109, Train_accy 94.56:  80%|████████  | 16/20 [07:06<01:44, 26.08s/it]                 
Task 4, Epoch 17/20 => Loss 0.307, Loss_clf 0.197, Loss_aux 0.109, Train_accy 94.56:  85%|████████▌ | 17/20 [07:06<01:15, 25.22s/it]
Task 4, Epoch 18/20 => Loss 0.293, Loss_clf 0.184, Loss_aux 0.109, Train_accy 94.64:  85%|████████▌ | 17/20 [07:29<01:15, 25.22s/it]
Task 4, Epoch 18/20 => Loss 0.293, Loss_clf 0.184, Loss_aux 0.109, Train_accy 94.64:  90%|█████████ | 18/20 [07:29<00:49, 24.63s/it]
Task 4, Epoch 19/20 => Loss 0.319, Loss_clf 0.200, Loss_aux 0.119, Train_accy 93.93:  90%|█████████ | 18/20 [07:52<00:49, 24.63s/it]
Task 4, Epoch 19/20 => Loss 0.319, Loss_clf 0.200, Loss_aux 0.119, Train_accy 93.93:  95%|█████████▌| 19/20 [07:52<00:24, 24.18s/it]
Task 4, Epoch 20/20 => Loss 0.259, Loss_clf 0.157, Loss_aux 0.102, Train_accy 95.35:  95%|█████████▌| 19/20 [08:15<00:24, 24.18s/it]
Task 4, Epoch 20/20 => Loss 0.259, Loss_clf 0.157, Loss_aux 0.102, Train_accy 95.35: 100%|██████████| 20/20 [08:15<00:00, 23.87s/it]
Task 4, Epoch 20/20 => Loss 0.259, Loss_clf 0.157, Loss_aux 0.102, Train_accy 95.35: 100%|██████████| 20/20 [08:15<00:00, 24.78s/it]2024-09-12 14:40:19,530 [der.py] => Task 4, Epoch 20/20 => Loss 0.259, Loss_clf 0.157, Loss_aux 0.102, Train_accy 95.35
2024-09-12 14:40:19,531 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 14:41:20,390 [der.py] => Exemplar size: 1000
2024-09-12 14:41:20,390 [trainer.py] => CNN: {'total': 92.87, '00-09': 93.22, '10-19': 93.02, '20-29': 93.81, '30-39': 88.18, '40-49': 96.26, 'old': 92.07, 'new': 96.26}
2024-09-12 14:41:20,391 [trainer.py] => NME: {'total': 95.54, '00-09': 95.76, '10-19': 97.67, '20-29': 96.91, '30-39': 91.82, '40-49': 95.33, 'old': 95.59, 'new': 95.33}
2024-09-12 14:41:20,391 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87]
2024-09-12 14:41:20,391 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11]
2024-09-12 14:41:20,391 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54]
2024-09-12 14:41:20,391 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29]

Average Accuracy (CNN): 96.54
Average Accuracy (NME): 97.15
2024-09-12 14:41:20,391 [trainer.py] => Average Accuracy (CNN): 96.54
2024-09-12 14:41:20,391 [trainer.py] => Average Accuracy (NME): 97.15
2024-09-12 14:41:20,394 [trainer.py] => All params: 429193789
2024-09-12 14:41:20,397 [trainer.py] => Trainable params: 85999165
2024-09-12 14:41:22,085 [der.py] => Learning on 50-60
2024-09-12 14:41:22,093 [der.py] => All params: 515076935
2024-09-12 14:41:22,096 [der.py] => Trainable params: 86083655

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.070, Loss_clf 1.257, Loss_aux 0.814, Train_accy 77.07, Test_accy 90.03:   0%|          | 0/20 [00:42<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.070, Loss_clf 1.257, Loss_aux 0.814, Train_accy 77.07, Test_accy 90.03:   5%|▌         | 1/20 [00:42<13:18, 42.00s/it]
Task 5, Epoch 2/20 => Loss 0.702, Loss_clf 0.406, Loss_aux 0.296, Train_accy 87.79:   5%|▌         | 1/20 [01:12<13:18, 42.00s/it]                 
Task 5, Epoch 2/20 => Loss 0.702, Loss_clf 0.406, Loss_aux 0.296, Train_accy 87.79:  10%|█         | 2/20 [01:12<10:37, 35.39s/it]
Task 5, Epoch 3/20 => Loss 0.568, Loss_clf 0.322, Loss_aux 0.246, Train_accy 90.98:  10%|█         | 2/20 [01:43<10:37, 35.39s/it]
Task 5, Epoch 3/20 => Loss 0.568, Loss_clf 0.322, Loss_aux 0.246, Train_accy 90.98:  15%|█▌        | 3/20 [01:43<09:24, 33.20s/it]
Task 5, Epoch 4/20 => Loss 0.503, Loss_clf 0.302, Loss_aux 0.201, Train_accy 90.64:  15%|█▌        | 3/20 [02:13<09:24, 33.20s/it]
Task 5, Epoch 4/20 => Loss 0.503, Loss_clf 0.302, Loss_aux 0.201, Train_accy 90.64:  20%|██        | 4/20 [02:13<08:34, 32.17s/it]
Task 5, Epoch 5/20 => Loss 0.404, Loss_clf 0.241, Loss_aux 0.163, Train_accy 93.15:  20%|██        | 4/20 [02:44<08:34, 32.17s/it]
Task 5, Epoch 5/20 => Loss 0.404, Loss_clf 0.241, Loss_aux 0.163, Train_accy 93.15:  25%|██▌       | 5/20 [02:44<07:54, 31.61s/it]
Task 5, Epoch 6/20 => Loss 0.448, Loss_clf 0.280, Loss_aux 0.169, Train_accy 91.86, Test_accy 90.18:  25%|██▌       | 5/20 [03:26<07:54, 31.61s/it]
Task 5, Epoch 6/20 => Loss 0.448, Loss_clf 0.280, Loss_aux 0.169, Train_accy 91.86, Test_accy 90.18:  30%|███       | 6/20 [03:26<08:11, 35.11s/it]
Task 5, Epoch 7/20 => Loss 0.410, Loss_clf 0.272, Loss_aux 0.139, Train_accy 92.47:  30%|███       | 6/20 [03:57<08:11, 35.11s/it]                 
Task 5, Epoch 7/20 => Loss 0.410, Loss_clf 0.272, Loss_aux 0.139, Train_accy 92.47:  35%|███▌      | 7/20 [03:57<07:17, 33.63s/it]
Task 5, Epoch 8/20 => Loss 0.419, Loss_clf 0.259, Loss_aux 0.160, Train_accy 93.01:  35%|███▌      | 7/20 [04:27<07:17, 33.63s/it]
Task 5, Epoch 8/20 => Loss 0.419, Loss_clf 0.259, Loss_aux 0.160, Train_accy 93.01:  40%|████      | 8/20 [04:27<06:31, 32.67s/it]
Task 5, Epoch 9/20 => Loss 0.446, Loss_clf 0.293, Loss_aux 0.153, Train_accy 91.99:  40%|████      | 8/20 [04:58<06:31, 32.67s/it]
Task 5, Epoch 9/20 => Loss 0.446, Loss_clf 0.293, Loss_aux 0.153, Train_accy 91.99:  45%|████▌     | 9/20 [04:58<05:52, 32.05s/it]
Task 5, Epoch 10/20 => Loss 0.374, Loss_clf 0.239, Loss_aux 0.136, Train_accy 93.42:  45%|████▌     | 9/20 [05:29<05:52, 32.05s/it]
Task 5, Epoch 10/20 => Loss 0.374, Loss_clf 0.239, Loss_aux 0.136, Train_accy 93.42:  50%|█████     | 10/20 [05:29<05:16, 31.62s/it]
Task 5, Epoch 11/20 => Loss 0.348, Loss_clf 0.226, Loss_aux 0.122, Train_accy 93.49, Test_accy 91.07:  50%|█████     | 10/20 [06:10<05:16, 31.62s/it]
Task 5, Epoch 11/20 => Loss 0.348, Loss_clf 0.226, Loss_aux 0.122, Train_accy 93.49, Test_accy 91.07:  55%|█████▌    | 11/20 [06:10<05:13, 34.78s/it]
Task 5, Epoch 12/20 => Loss 0.305, Loss_clf 0.197, Loss_aux 0.108, Train_accy 94.57:  55%|█████▌    | 11/20 [06:41<05:13, 34.78s/it]                 
Task 5, Epoch 12/20 => Loss 0.305, Loss_clf 0.197, Loss_aux 0.108, Train_accy 94.57:  60%|██████    | 12/20 [06:41<04:28, 33.54s/it]
Task 5, Epoch 13/20 => Loss 0.355, Loss_clf 0.235, Loss_aux 0.120, Train_accy 93.55:  60%|██████    | 12/20 [07:12<04:28, 33.54s/it]
Task 5, Epoch 13/20 => Loss 0.355, Loss_clf 0.235, Loss_aux 0.120, Train_accy 93.55:  65%|██████▌   | 13/20 [07:12<03:48, 32.67s/it]
Task 5, Epoch 14/20 => Loss 0.357, Loss_clf 0.232, Loss_aux 0.125, Train_accy 93.55:  65%|██████▌   | 13/20 [07:42<03:48, 32.67s/it]
Task 5, Epoch 14/20 => Loss 0.357, Loss_clf 0.232, Loss_aux 0.125, Train_accy 93.55:  70%|███████   | 14/20 [07:42<03:12, 32.05s/it]
Task 5, Epoch 15/20 => Loss 0.408, Loss_clf 0.246, Loss_aux 0.162, Train_accy 93.01:  70%|███████   | 14/20 [08:13<03:12, 32.05s/it]
Task 5, Epoch 15/20 => Loss 0.408, Loss_clf 0.246, Loss_aux 0.162, Train_accy 93.01:  75%|███████▌  | 15/20 [08:13<02:38, 31.62s/it]
Task 5, Epoch 16/20 => Loss 0.297, Loss_clf 0.201, Loss_aux 0.096, Train_accy 94.44, Test_accy 91.22:  75%|███████▌  | 15/20 [08:55<02:38, 31.62s/it]
Task 5, Epoch 16/20 => Loss 0.297, Loss_clf 0.201, Loss_aux 0.096, Train_accy 94.44, Test_accy 91.22:  80%|████████  | 16/20 [08:55<02:18, 34.72s/it]
Task 5, Epoch 17/20 => Loss 0.341, Loss_clf 0.214, Loss_aux 0.127, Train_accy 93.83:  80%|████████  | 16/20 [09:26<02:18, 34.72s/it]                 
Task 5, Epoch 17/20 => Loss 0.341, Loss_clf 0.214, Loss_aux 0.127, Train_accy 93.83:  85%|████████▌ | 17/20 [09:26<01:40, 33.47s/it]
Task 5, Epoch 18/20 => Loss 0.365, Loss_clf 0.235, Loss_aux 0.130, Train_accy 93.55:  85%|████████▌ | 17/20 [09:56<01:40, 33.47s/it]
Task 5, Epoch 18/20 => Loss 0.365, Loss_clf 0.235, Loss_aux 0.130, Train_accy 93.55:  90%|█████████ | 18/20 [09:56<01:05, 32.63s/it]
Task 5, Epoch 19/20 => Loss 0.411, Loss_clf 0.265, Loss_aux 0.146, Train_accy 92.67:  90%|█████████ | 18/20 [10:27<01:05, 32.63s/it]
Task 5, Epoch 19/20 => Loss 0.411, Loss_clf 0.265, Loss_aux 0.146, Train_accy 92.67:  95%|█████████▌| 19/20 [10:27<00:32, 32.02s/it]
Task 5, Epoch 20/20 => Loss 0.328, Loss_clf 0.217, Loss_aux 0.111, Train_accy 93.83:  95%|█████████▌| 19/20 [10:57<00:32, 32.02s/it]
Task 5, Epoch 20/20 => Loss 0.328, Loss_clf 0.217, Loss_aux 0.111, Train_accy 93.83: 100%|██████████| 20/20 [10:57<00:00, 31.59s/it]
Task 5, Epoch 20/20 => Loss 0.328, Loss_clf 0.217, Loss_aux 0.111, Train_accy 93.83: 100%|██████████| 20/20 [10:57<00:00, 32.90s/it]2024-09-12 14:52:20,100 [der.py] => Task 5, Epoch 20/20 => Loss 0.328, Loss_clf 0.217, Loss_aux 0.111, Train_accy 93.83
2024-09-12 14:52:20,101 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 14:53:40,740 [der.py] => Exemplar size: 1200
2024-09-12 14:53:40,740 [trainer.py] => CNN: {'total': 91.22, '00-09': 84.75, '10-19': 93.02, '20-29': 92.78, '30-39': 90.0, '40-49': 94.39, '50-59': 92.79, 'old': 90.91, 'new': 92.79}
2024-09-12 14:53:40,740 [trainer.py] => NME: {'total': 93.45, '00-09': 87.29, '10-19': 96.9, '20-29': 96.91, '30-39': 92.73, '40-49': 96.26, '50-59': 90.99, 'old': 93.94, 'new': 90.99}
2024-09-12 14:53:40,740 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22]
2024-09-12 14:53:40,740 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96]
2024-09-12 14:53:40,740 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45]
2024-09-12 14:53:40,740 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96]

Average Accuracy (CNN): 95.65
Average Accuracy (NME): 96.54
2024-09-12 14:53:40,740 [trainer.py] => Average Accuracy (CNN): 95.65
2024-09-12 14:53:40,740 [trainer.py] => Average Accuracy (NME): 96.54
2024-09-12 14:53:40,746 [trainer.py] => All params: 515076935
2024-09-12 14:53:40,752 [trainer.py] => Trainable params: 86083655
2024-09-12 14:53:42,479 [der.py] => Learning on 60-70
2024-09-12 14:53:42,487 [der.py] => All params: 600975441
2024-09-12 14:53:42,490 [der.py] => Trainable params: 86183505

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.267, Loss_clf 1.216, Loss_aux 1.051, Train_accy 77.83, Test_accy 88.69:   0%|          | 0/20 [00:54<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.267, Loss_clf 1.216, Loss_aux 1.051, Train_accy 77.83, Test_accy 88.69:   5%|▌         | 1/20 [00:54<17:10, 54.25s/it]
Task 6, Epoch 2/20 => Loss 0.748, Loss_clf 0.365, Loss_aux 0.383, Train_accy 88.86:   5%|▌         | 1/20 [01:33<17:10, 54.25s/it]                 
Task 6, Epoch 2/20 => Loss 0.748, Loss_clf 0.365, Loss_aux 0.383, Train_accy 88.86:  10%|█         | 2/20 [01:33<13:40, 45.56s/it]
Task 6, Epoch 3/20 => Loss 0.545, Loss_clf 0.293, Loss_aux 0.252, Train_accy 91.64:  10%|█         | 2/20 [02:13<13:40, 45.56s/it]
Task 6, Epoch 3/20 => Loss 0.545, Loss_clf 0.293, Loss_aux 0.252, Train_accy 91.64:  15%|█▌        | 3/20 [02:13<12:07, 42.76s/it]
Task 6, Epoch 4/20 => Loss 0.551, Loss_clf 0.324, Loss_aux 0.227, Train_accy 91.17:  15%|█▌        | 3/20 [02:52<12:07, 42.76s/it]
Task 6, Epoch 4/20 => Loss 0.551, Loss_clf 0.324, Loss_aux 0.227, Train_accy 91.17:  20%|██        | 4/20 [02:52<11:03, 41.47s/it]
Task 6, Epoch 5/20 => Loss 0.516, Loss_clf 0.312, Loss_aux 0.204, Train_accy 90.69:  20%|██        | 4/20 [03:32<11:03, 41.47s/it]
Task 6, Epoch 5/20 => Loss 0.516, Loss_clf 0.312, Loss_aux 0.204, Train_accy 90.69:  25%|██▌       | 5/20 [03:32<10:11, 40.74s/it]
Task 6, Epoch 6/20 => Loss 0.436, Loss_clf 0.267, Loss_aux 0.168, Train_accy 92.06, Test_accy 89.33:  25%|██▌       | 5/20 [04:26<10:11, 40.74s/it]
Task 6, Epoch 6/20 => Loss 0.436, Loss_clf 0.267, Loss_aux 0.168, Train_accy 92.06, Test_accy 89.33:  30%|███       | 6/20 [04:26<10:35, 45.40s/it]
Task 6, Epoch 7/20 => Loss 0.437, Loss_clf 0.289, Loss_aux 0.148, Train_accy 91.82:  30%|███       | 6/20 [05:05<10:35, 45.40s/it]                 
Task 6, Epoch 7/20 => Loss 0.437, Loss_clf 0.289, Loss_aux 0.148, Train_accy 91.82:  35%|███▌      | 7/20 [05:05<09:24, 43.43s/it]
Task 6, Epoch 8/20 => Loss 0.445, Loss_clf 0.272, Loss_aux 0.172, Train_accy 92.71:  35%|███▌      | 7/20 [05:45<09:24, 43.43s/it]
Task 6, Epoch 8/20 => Loss 0.445, Loss_clf 0.272, Loss_aux 0.172, Train_accy 92.71:  40%|████      | 8/20 [05:45<08:25, 42.14s/it]
Task 6, Epoch 9/20 => Loss 0.408, Loss_clf 0.257, Loss_aux 0.151, Train_accy 92.35:  40%|████      | 8/20 [06:24<08:25, 42.14s/it]
Task 6, Epoch 9/20 => Loss 0.408, Loss_clf 0.257, Loss_aux 0.151, Train_accy 92.35:  45%|████▌     | 9/20 [06:24<07:34, 41.30s/it]
Task 6, Epoch 10/20 => Loss 0.397, Loss_clf 0.253, Loss_aux 0.145, Train_accy 93.06:  45%|████▌     | 9/20 [07:04<07:34, 41.30s/it]
Task 6, Epoch 10/20 => Loss 0.397, Loss_clf 0.253, Loss_aux 0.145, Train_accy 93.06:  50%|█████     | 10/20 [07:04<06:47, 40.73s/it]
Task 6, Epoch 11/20 => Loss 0.364, Loss_clf 0.226, Loss_aux 0.138, Train_accy 92.95, Test_accy 88.56:  50%|█████     | 10/20 [07:58<06:47, 40.73s/it]
Task 6, Epoch 11/20 => Loss 0.364, Loss_clf 0.226, Loss_aux 0.138, Train_accy 92.95, Test_accy 88.56:  55%|█████▌    | 11/20 [07:58<06:44, 44.98s/it]
Task 6, Epoch 12/20 => Loss 0.378, Loss_clf 0.263, Loss_aux 0.115, Train_accy 92.95:  55%|█████▌    | 11/20 [08:38<06:44, 44.98s/it]                 
Task 6, Epoch 12/20 => Loss 0.378, Loss_clf 0.263, Loss_aux 0.115, Train_accy 92.95:  60%|██████    | 12/20 [08:38<05:46, 43.29s/it]
Task 6, Epoch 13/20 => Loss 0.306, Loss_clf 0.212, Loss_aux 0.094, Train_accy 94.07:  60%|██████    | 12/20 [09:17<05:46, 43.29s/it]
Task 6, Epoch 13/20 => Loss 0.306, Loss_clf 0.212, Loss_aux 0.094, Train_accy 94.07:  65%|██████▌   | 13/20 [09:17<04:54, 42.10s/it]
Task 6, Epoch 14/20 => Loss 0.409, Loss_clf 0.249, Loss_aux 0.160, Train_accy 93.54:  65%|██████▌   | 13/20 [09:57<04:54, 42.10s/it]
Task 6, Epoch 14/20 => Loss 0.409, Loss_clf 0.249, Loss_aux 0.160, Train_accy 93.54:  70%|███████   | 14/20 [09:57<04:07, 41.29s/it]
Task 6, Epoch 15/20 => Loss 0.388, Loss_clf 0.258, Loss_aux 0.130, Train_accy 93.18:  70%|███████   | 14/20 [10:36<04:07, 41.29s/it]
Task 6, Epoch 15/20 => Loss 0.388, Loss_clf 0.258, Loss_aux 0.130, Train_accy 93.18:  75%|███████▌  | 15/20 [10:36<03:23, 40.78s/it]
Task 6, Epoch 16/20 => Loss 0.345, Loss_clf 0.221, Loss_aux 0.124, Train_accy 93.72, Test_accy 88.95:  75%|███████▌  | 15/20 [11:31<03:23, 40.78s/it]
Task 6, Epoch 16/20 => Loss 0.345, Loss_clf 0.221, Loss_aux 0.124, Train_accy 93.72, Test_accy 88.95:  80%|████████  | 16/20 [11:31<02:59, 44.97s/it]
Task 6, Epoch 17/20 => Loss 0.337, Loss_clf 0.212, Loss_aux 0.124, Train_accy 93.78:  80%|████████  | 16/20 [12:10<02:59, 44.97s/it]                 
Task 6, Epoch 17/20 => Loss 0.337, Loss_clf 0.212, Loss_aux 0.124, Train_accy 93.78:  85%|████████▌ | 17/20 [12:10<02:09, 43.32s/it]
Task 6, Epoch 18/20 => Loss 0.325, Loss_clf 0.207, Loss_aux 0.117, Train_accy 94.49:  85%|████████▌ | 17/20 [12:50<02:09, 43.32s/it]
Task 6, Epoch 18/20 => Loss 0.325, Loss_clf 0.207, Loss_aux 0.117, Train_accy 94.49:  90%|█████████ | 18/20 [12:50<01:24, 42.17s/it]
Task 6, Epoch 19/20 => Loss 0.340, Loss_clf 0.216, Loss_aux 0.124, Train_accy 93.78:  90%|█████████ | 18/20 [13:29<01:24, 42.17s/it]
Task 6, Epoch 19/20 => Loss 0.340, Loss_clf 0.216, Loss_aux 0.124, Train_accy 93.78:  95%|█████████▌| 19/20 [13:29<00:41, 41.36s/it]
Task 6, Epoch 20/20 => Loss 0.292, Loss_clf 0.202, Loss_aux 0.091, Train_accy 94.67:  95%|█████████▌| 19/20 [14:09<00:41, 41.36s/it]
Task 6, Epoch 20/20 => Loss 0.292, Loss_clf 0.202, Loss_aux 0.091, Train_accy 94.67: 100%|██████████| 20/20 [14:09<00:00, 40.79s/it]
Task 6, Epoch 20/20 => Loss 0.292, Loss_clf 0.202, Loss_aux 0.091, Train_accy 94.67: 100%|██████████| 20/20 [14:09<00:00, 42.46s/it]2024-09-12 15:07:51,798 [der.py] => Task 6, Epoch 20/20 => Loss 0.292, Loss_clf 0.202, Loss_aux 0.091, Train_accy 94.67
2024-09-12 15:07:51,800 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 15:09:35,025 [der.py] => Exemplar size: 1400
2024-09-12 15:09:35,025 [trainer.py] => CNN: {'total': 89.72, '00-09': 84.75, '10-19': 89.92, '20-29': 91.75, '30-39': 82.73, '40-49': 94.39, '50-59': 89.19, '60-69': 96.23, 'old': 88.69, 'new': 96.23}
2024-09-12 15:09:35,025 [trainer.py] => NME: {'total': 91.9, '00-09': 87.29, '10-19': 91.47, '20-29': 94.85, '30-39': 92.73, '40-49': 95.33, '50-59': 90.99, '60-69': 91.51, 'old': 91.96, 'new': 91.51}
2024-09-12 15:09:35,025 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72]
2024-09-12 15:09:35,025 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07]
2024-09-12 15:09:35,025 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9]
2024-09-12 15:09:35,025 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97]

Average Accuracy (CNN): 94.8
Average Accuracy (NME): 95.87
2024-09-12 15:09:35,025 [trainer.py] => Average Accuracy (CNN): 94.8
2024-09-12 15:09:35,025 [trainer.py] => Average Accuracy (NME): 95.87
2024-09-12 15:09:35,031 [trainer.py] => All params: 600975441
2024-09-12 15:09:35,037 [trainer.py] => Trainable params: 86183505
2024-09-12 15:09:36,826 [der.py] => Learning on 70-80
2024-09-12 15:09:36,836 [der.py] => All params: 686889307
2024-09-12 15:09:36,840 [der.py] => Trainable params: 86298715

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.955, Loss_clf 0.994, Loss_aux 0.961, Train_accy 81.66, Test_accy 88.79:   0%|          | 0/20 [01:08<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.955, Loss_clf 0.994, Loss_aux 0.961, Train_accy 81.66, Test_accy 88.79:   5%|▌         | 1/20 [01:08<21:35, 68.18s/it]
Task 7, Epoch 2/20 => Loss 0.574, Loss_clf 0.340, Loss_aux 0.234, Train_accy 90.91:   5%|▌         | 1/20 [01:56<21:35, 68.18s/it]                 
Task 7, Epoch 2/20 => Loss 0.574, Loss_clf 0.340, Loss_aux 0.234, Train_accy 90.91:  10%|█         | 2/20 [01:56<16:56, 56.47s/it]
Task 7, Epoch 3/20 => Loss 0.414, Loss_clf 0.273, Loss_aux 0.142, Train_accy 92.85:  10%|█         | 2/20 [02:44<16:56, 56.47s/it]
Task 7, Epoch 3/20 => Loss 0.414, Loss_clf 0.273, Loss_aux 0.142, Train_accy 92.85:  15%|█▌        | 3/20 [02:44<14:55, 52.70s/it]
Task 7, Epoch 4/20 => Loss 0.390, Loss_clf 0.263, Loss_aux 0.127, Train_accy 92.20:  15%|█▌        | 3/20 [03:33<14:55, 52.70s/it]
Task 7, Epoch 4/20 => Loss 0.390, Loss_clf 0.263, Loss_aux 0.127, Train_accy 92.20:  20%|██        | 4/20 [03:33<13:35, 50.99s/it]
Task 7, Epoch 5/20 => Loss 0.389, Loss_clf 0.272, Loss_aux 0.117, Train_accy 92.90:  20%|██        | 4/20 [04:21<13:35, 50.99s/it]
Task 7, Epoch 5/20 => Loss 0.389, Loss_clf 0.272, Loss_aux 0.117, Train_accy 92.90:  25%|██▌       | 5/20 [04:21<12:30, 50.01s/it]
Task 7, Epoch 6/20 => Loss 0.377, Loss_clf 0.257, Loss_aux 0.119, Train_accy 92.85, Test_accy 90.10:  25%|██▌       | 5/20 [05:29<12:30, 50.01s/it]
Task 7, Epoch 6/20 => Loss 0.377, Loss_clf 0.257, Loss_aux 0.119, Train_accy 92.85, Test_accy 90.10:  30%|███       | 6/20 [05:29<13:07, 56.23s/it]
Task 7, Epoch 7/20 => Loss 0.344, Loss_clf 0.230, Loss_aux 0.114, Train_accy 93.28:  30%|███       | 6/20 [06:17<13:07, 56.23s/it]                 
Task 7, Epoch 7/20 => Loss 0.344, Loss_clf 0.230, Loss_aux 0.114, Train_accy 93.28:  35%|███▌      | 7/20 [06:17<11:37, 53.65s/it]
Task 7, Epoch 8/20 => Loss 0.370, Loss_clf 0.265, Loss_aux 0.106, Train_accy 93.54:  35%|███▌      | 7/20 [07:06<11:37, 53.65s/it]
Task 7, Epoch 8/20 => Loss 0.370, Loss_clf 0.265, Loss_aux 0.106, Train_accy 93.54:  40%|████      | 8/20 [07:06<10:22, 51.91s/it]
Task 7, Epoch 9/20 => Loss 0.348, Loss_clf 0.255, Loss_aux 0.093, Train_accy 93.01:  40%|████      | 8/20 [07:54<10:22, 51.91s/it]
Task 7, Epoch 9/20 => Loss 0.348, Loss_clf 0.255, Loss_aux 0.093, Train_accy 93.01:  45%|████▌     | 9/20 [07:54<09:18, 50.78s/it]
Task 7, Epoch 10/20 => Loss 0.357, Loss_clf 0.251, Loss_aux 0.106, Train_accy 92.85:  45%|████▌     | 9/20 [08:42<09:18, 50.78s/it]
Task 7, Epoch 10/20 => Loss 0.357, Loss_clf 0.251, Loss_aux 0.106, Train_accy 92.85:  50%|█████     | 10/20 [08:42<08:19, 50.00s/it]
Task 7, Epoch 11/20 => Loss 0.337, Loss_clf 0.230, Loss_aux 0.107, Train_accy 93.01, Test_accy 89.34:  50%|█████     | 10/20 [09:50<08:19, 50.00s/it]
Task 7, Epoch 11/20 => Loss 0.337, Loss_clf 0.230, Loss_aux 0.107, Train_accy 93.01, Test_accy 89.34:  55%|█████▌    | 11/20 [09:50<08:20, 55.60s/it]
Task 7, Epoch 12/20 => Loss 0.298, Loss_clf 0.223, Loss_aux 0.076, Train_accy 94.03:  55%|█████▌    | 11/20 [10:39<08:20, 55.60s/it]                 
Task 7, Epoch 12/20 => Loss 0.298, Loss_clf 0.223, Loss_aux 0.076, Train_accy 94.03:  60%|██████    | 12/20 [10:39<07:06, 53.36s/it]
Task 7, Epoch 13/20 => Loss 0.316, Loss_clf 0.228, Loss_aux 0.088, Train_accy 93.65:  60%|██████    | 12/20 [11:27<07:06, 53.36s/it]
Task 7, Epoch 13/20 => Loss 0.316, Loss_clf 0.228, Loss_aux 0.088, Train_accy 93.65:  65%|██████▌   | 13/20 [11:27<06:02, 51.81s/it]
Task 7, Epoch 14/20 => Loss 0.273, Loss_clf 0.204, Loss_aux 0.069, Train_accy 94.24:  65%|██████▌   | 13/20 [12:15<06:02, 51.81s/it]
Task 7, Epoch 14/20 => Loss 0.273, Loss_clf 0.204, Loss_aux 0.069, Train_accy 94.24:  70%|███████   | 14/20 [12:15<05:04, 50.73s/it]
Task 7, Epoch 15/20 => Loss 0.240, Loss_clf 0.175, Loss_aux 0.065, Train_accy 95.00:  70%|███████   | 14/20 [13:03<05:04, 50.73s/it]
Task 7, Epoch 15/20 => Loss 0.240, Loss_clf 0.175, Loss_aux 0.065, Train_accy 95.00:  75%|███████▌  | 15/20 [13:03<04:09, 50.00s/it]
Task 7, Epoch 16/20 => Loss 0.281, Loss_clf 0.201, Loss_aux 0.080, Train_accy 94.46, Test_accy 89.88:  75%|███████▌  | 15/20 [14:12<04:09, 50.00s/it]
Task 7, Epoch 16/20 => Loss 0.281, Loss_clf 0.201, Loss_aux 0.080, Train_accy 94.46, Test_accy 89.88:  80%|████████  | 16/20 [14:12<03:42, 55.51s/it]
Task 7, Epoch 17/20 => Loss 0.323, Loss_clf 0.235, Loss_aux 0.088, Train_accy 93.65:  80%|████████  | 16/20 [15:00<03:42, 55.51s/it]                 
Task 7, Epoch 17/20 => Loss 0.323, Loss_clf 0.235, Loss_aux 0.088, Train_accy 93.65:  85%|████████▌ | 17/20 [15:00<02:39, 53.31s/it]
Task 7, Epoch 18/20 => Loss 0.289, Loss_clf 0.208, Loss_aux 0.081, Train_accy 94.35:  85%|████████▌ | 17/20 [15:48<02:39, 53.31s/it]
Task 7, Epoch 18/20 => Loss 0.289, Loss_clf 0.208, Loss_aux 0.081, Train_accy 94.35:  90%|█████████ | 18/20 [15:48<01:43, 51.76s/it]
Task 7, Epoch 19/20 => Loss 0.266, Loss_clf 0.199, Loss_aux 0.067, Train_accy 94.24:  90%|█████████ | 18/20 [16:36<01:43, 51.76s/it]
Task 7, Epoch 19/20 => Loss 0.266, Loss_clf 0.199, Loss_aux 0.067, Train_accy 94.24:  95%|█████████▌| 19/20 [16:36<00:50, 50.68s/it]
Task 7, Epoch 20/20 => Loss 0.286, Loss_clf 0.209, Loss_aux 0.077, Train_accy 94.08:  95%|█████████▌| 19/20 [17:24<00:50, 50.68s/it]
Task 7, Epoch 20/20 => Loss 0.286, Loss_clf 0.209, Loss_aux 0.077, Train_accy 94.08: 100%|██████████| 20/20 [17:24<00:00, 49.91s/it]
Task 7, Epoch 20/20 => Loss 0.286, Loss_clf 0.209, Loss_aux 0.077, Train_accy 94.08: 100%|██████████| 20/20 [17:24<00:00, 52.25s/it]2024-09-12 15:27:01,850 [der.py] => Task 7, Epoch 20/20 => Loss 0.286, Loss_clf 0.209, Loss_aux 0.077, Train_accy 94.08
2024-09-12 15:27:01,851 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 15:29:10,355 [der.py] => Exemplar size: 1600
2024-09-12 15:29:10,355 [trainer.py] => CNN: {'total': 90.32, '00-09': 84.75, '10-19': 89.92, '20-29': 94.85, '30-39': 84.55, '40-49': 93.46, '50-59': 90.09, '60-69': 86.79, '70-79': 97.16, 'old': 89.07, 'new': 97.16}
2024-09-12 15:29:10,355 [trainer.py] => NME: {'total': 90.86, '00-09': 85.59, '10-19': 90.7, '20-29': 94.85, '30-39': 91.82, '40-49': 94.39, '50-59': 89.19, '60-69': 89.62, '70-79': 91.49, 'old': 90.75, 'new': 91.49}
2024-09-12 15:29:10,356 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32]
2024-09-12 15:29:10,356 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04]
2024-09-12 15:29:10,356 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86]
2024-09-12 15:29:10,356 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02]

Average Accuracy (CNN): 94.24
Average Accuracy (NME): 95.25
2024-09-12 15:29:10,356 [trainer.py] => Average Accuracy (CNN): 94.24
2024-09-12 15:29:10,356 [trainer.py] => Average Accuracy (NME): 95.25
2024-09-12 15:29:10,361 [trainer.py] => All params: 686889307
2024-09-12 15:29:10,365 [trainer.py] => Trainable params: 86298715
2024-09-12 15:29:11,991 [der.py] => Learning on 80-90
2024-09-12 15:29:12,001 [der.py] => All params: 772818533
2024-09-12 15:29:12,005 [der.py] => Trainable params: 86429285

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.547, Loss_clf 0.874, Loss_aux 0.673, Train_accy 85.01, Test_accy 90.11:   0%|          | 0/20 [01:24<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.547, Loss_clf 0.874, Loss_aux 0.673, Train_accy 85.01, Test_accy 90.11:   5%|▌         | 1/20 [01:24<26:38, 84.11s/it]
Task 8, Epoch 2/20 => Loss 0.537, Loss_clf 0.320, Loss_aux 0.217, Train_accy 90.73:   5%|▌         | 1/20 [02:31<26:38, 84.11s/it]                 
Task 8, Epoch 2/20 => Loss 0.537, Loss_clf 0.320, Loss_aux 0.217, Train_accy 90.73:  10%|█         | 2/20 [02:31<22:20, 74.45s/it]
Task 8, Epoch 3/20 => Loss 0.385, Loss_clf 0.231, Loss_aux 0.154, Train_accy 93.69:  10%|█         | 2/20 [03:45<22:20, 74.45s/it]
Task 8, Epoch 3/20 => Loss 0.385, Loss_clf 0.231, Loss_aux 0.154, Train_accy 93.69:  15%|█▌        | 3/20 [03:45<20:59, 74.11s/it]
Task 8, Epoch 4/20 => Loss 0.359, Loss_clf 0.239, Loss_aux 0.120, Train_accy 93.40:  15%|█▌        | 3/20 [04:59<20:59, 74.11s/it]
Task 8, Epoch 4/20 => Loss 0.359, Loss_clf 0.239, Loss_aux 0.120, Train_accy 93.40:  20%|██        | 4/20 [04:59<19:43, 73.98s/it]
Task 8, Epoch 5/20 => Loss 0.394, Loss_clf 0.269, Loss_aux 0.125, Train_accy 92.33:  20%|██        | 4/20 [06:13<19:43, 73.98s/it]
Task 8, Epoch 5/20 => Loss 0.394, Loss_clf 0.269, Loss_aux 0.125, Train_accy 92.33:  25%|██▌       | 5/20 [06:13<18:29, 73.94s/it]
Task 8, Epoch 6/20 => Loss 0.401, Loss_clf 0.269, Loss_aux 0.132, Train_accy 92.72, Test_accy 89.07:  25%|██▌       | 5/20 [07:59<18:29, 73.94s/it]
Task 8, Epoch 6/20 => Loss 0.401, Loss_clf 0.269, Loss_aux 0.132, Train_accy 92.72, Test_accy 89.07:  30%|███       | 6/20 [07:59<19:47, 84.85s/it]
Task 8, Epoch 7/20 => Loss 0.326, Loss_clf 0.233, Loss_aux 0.094, Train_accy 93.45:  30%|███       | 6/20 [09:12<19:47, 84.85s/it]                 
Task 8, Epoch 7/20 => Loss 0.326, Loss_clf 0.233, Loss_aux 0.094, Train_accy 93.45:  35%|███▌      | 7/20 [09:12<17:35, 81.23s/it]
Task 8, Epoch 8/20 => Loss 0.383, Loss_clf 0.270, Loss_aux 0.112, Train_accy 92.19:  35%|███▌      | 7/20 [10:26<17:35, 81.23s/it]
Task 8, Epoch 8/20 => Loss 0.383, Loss_clf 0.270, Loss_aux 0.112, Train_accy 92.19:  40%|████      | 8/20 [10:26<15:46, 78.85s/it]
Task 8, Epoch 9/20 => Loss 0.300, Loss_clf 0.208, Loss_aux 0.092, Train_accy 94.08:  40%|████      | 8/20 [11:38<15:46, 78.85s/it]
Task 8, Epoch 9/20 => Loss 0.300, Loss_clf 0.208, Loss_aux 0.092, Train_accy 94.08:  45%|████▌     | 9/20 [11:38<14:02, 76.60s/it]
Task 8, Epoch 10/20 => Loss 0.337, Loss_clf 0.236, Loss_aux 0.101, Train_accy 93.50:  45%|████▌     | 9/20 [12:50<14:02, 76.60s/it]
Task 8, Epoch 10/20 => Loss 0.337, Loss_clf 0.236, Loss_aux 0.101, Train_accy 93.50:  50%|█████     | 10/20 [12:50<12:33, 75.32s/it]
Task 8, Epoch 11/20 => Loss 0.316, Loss_clf 0.229, Loss_aux 0.087, Train_accy 93.40, Test_accy 89.54:  50%|█████     | 10/20 [14:36<12:33, 75.32s/it]
Task 8, Epoch 11/20 => Loss 0.316, Loss_clf 0.229, Loss_aux 0.087, Train_accy 93.40, Test_accy 89.54:  55%|█████▌    | 11/20 [14:36<12:42, 84.71s/it]
Task 8, Epoch 12/20 => Loss 0.305, Loss_clf 0.216, Loss_aux 0.090, Train_accy 94.08:  55%|█████▌    | 11/20 [15:50<12:42, 84.71s/it]                 
Task 8, Epoch 12/20 => Loss 0.305, Loss_clf 0.216, Loss_aux 0.090, Train_accy 94.08:  60%|██████    | 12/20 [15:50<10:50, 81.36s/it]
Task 8, Epoch 13/20 => Loss 0.353, Loss_clf 0.248, Loss_aux 0.105, Train_accy 93.26:  60%|██████    | 12/20 [17:04<10:50, 81.36s/it]
Task 8, Epoch 13/20 => Loss 0.353, Loss_clf 0.248, Loss_aux 0.105, Train_accy 93.26:  65%|██████▌   | 13/20 [17:04<09:13, 79.12s/it]
Task 8, Epoch 14/20 => Loss 0.337, Loss_clf 0.239, Loss_aux 0.098, Train_accy 93.06:  65%|██████▌   | 13/20 [18:18<09:13, 79.12s/it]
Task 8, Epoch 14/20 => Loss 0.337, Loss_clf 0.239, Loss_aux 0.098, Train_accy 93.06:  70%|███████   | 14/20 [18:18<07:44, 77.45s/it]
Task 8, Epoch 15/20 => Loss 0.353, Loss_clf 0.259, Loss_aux 0.094, Train_accy 93.21:  70%|███████   | 14/20 [19:31<07:44, 77.45s/it]
Task 8, Epoch 15/20 => Loss 0.353, Loss_clf 0.259, Loss_aux 0.094, Train_accy 93.21:  75%|███████▌  | 15/20 [19:31<06:21, 76.33s/it]
Task 8, Epoch 16/20 => Loss 0.299, Loss_clf 0.220, Loss_aux 0.079, Train_accy 94.47, Test_accy 90.49:  75%|███████▌  | 15/20 [21:16<06:21, 76.33s/it]
Task 8, Epoch 16/20 => Loss 0.299, Loss_clf 0.220, Loss_aux 0.079, Train_accy 94.47, Test_accy 90.49:  80%|████████  | 16/20 [21:16<05:39, 84.98s/it]
Task 8, Epoch 17/20 => Loss 0.262, Loss_clf 0.194, Loss_aux 0.068, Train_accy 94.66:  80%|████████  | 16/20 [22:27<05:39, 84.98s/it]                 
Task 8, Epoch 17/20 => Loss 0.262, Loss_clf 0.194, Loss_aux 0.068, Train_accy 94.66:  85%|████████▌ | 17/20 [22:27<04:01, 80.59s/it]
Task 8, Epoch 18/20 => Loss 0.243, Loss_clf 0.172, Loss_aux 0.070, Train_accy 94.86:  85%|████████▌ | 17/20 [23:40<04:01, 80.59s/it]
Task 8, Epoch 18/20 => Loss 0.243, Loss_clf 0.172, Loss_aux 0.070, Train_accy 94.86:  90%|█████████ | 18/20 [23:40<02:36, 78.49s/it]
Task 8, Epoch 19/20 => Loss 0.298, Loss_clf 0.217, Loss_aux 0.081, Train_accy 94.23:  90%|█████████ | 18/20 [24:54<02:36, 78.49s/it]
Task 8, Epoch 19/20 => Loss 0.298, Loss_clf 0.217, Loss_aux 0.081, Train_accy 94.23:  95%|█████████▌| 19/20 [24:54<01:17, 77.02s/it]
Task 8, Epoch 20/20 => Loss 0.338, Loss_clf 0.248, Loss_aux 0.090, Train_accy 93.50:  95%|█████████▌| 19/20 [26:08<01:17, 77.02s/it]
Task 8, Epoch 20/20 => Loss 0.338, Loss_clf 0.248, Loss_aux 0.090, Train_accy 93.50: 100%|██████████| 20/20 [26:08<00:00, 75.99s/it]
Task 8, Epoch 20/20 => Loss 0.338, Loss_clf 0.248, Loss_aux 0.090, Train_accy 93.50: 100%|██████████| 20/20 [26:08<00:00, 78.40s/it]2024-09-12 15:55:20,092 [der.py] => Task 8, Epoch 20/20 => Loss 0.338, Loss_clf 0.248, Loss_aux 0.090, Train_accy 93.50
2024-09-12 15:55:20,093 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 15:58:17,112 [der.py] => Exemplar size: 1800
2024-09-12 15:58:17,113 [trainer.py] => CNN: {'total': 90.49, '00-09': 83.05, '10-19': 85.27, '20-29': 93.81, '30-39': 84.55, '40-49': 94.39, '50-59': 90.99, '60-69': 87.74, '70-79': 96.45, '80-89': 96.99, 'old': 89.55, 'new': 96.99}
2024-09-12 15:58:17,113 [trainer.py] => NME: {'total': 90.87, '00-09': 84.75, '10-19': 89.92, '20-29': 95.88, '30-39': 90.0, '40-49': 93.46, '50-59': 89.19, '60-69': 87.74, '70-79': 92.2, '80-89': 94.74, 'old': 90.32, 'new': 94.74}
2024-09-12 15:58:17,113 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49]
2024-09-12 15:58:17,113 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19]
2024-09-12 15:58:17,113 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87]
2024-09-12 15:58:17,113 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14]

Average Accuracy (CNN): 93.83
Average Accuracy (NME): 94.76
2024-09-12 15:58:17,113 [trainer.py] => Average Accuracy (CNN): 93.83
2024-09-12 15:58:17,113 [trainer.py] => Average Accuracy (NME): 94.76
2024-09-12 15:58:17,118 [trainer.py] => All params: 772818533
2024-09-12 15:58:17,123 [trainer.py] => Trainable params: 86429285
2024-09-12 15:58:18,746 [der.py] => Learning on 90-100
2024-09-12 15:58:18,758 [der.py] => All params: 858763119
2024-09-12 15:58:18,762 [der.py] => Trainable params: 86575215

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.864, Loss_clf 1.029, Loss_aux 0.835, Train_accy 82.91, Test_accy 88.05:   0%|          | 0/20 [01:48<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.864, Loss_clf 1.029, Loss_aux 0.835, Train_accy 82.91, Test_accy 88.05:   5%|▌         | 1/20 [01:48<34:28, 108.86s/it]
Task 9, Epoch 2/20 => Loss 0.625, Loss_clf 0.370, Loss_aux 0.256, Train_accy 89.75:   5%|▌         | 1/20 [02:58<34:28, 108.86s/it]                 
Task 9, Epoch 2/20 => Loss 0.625, Loss_clf 0.370, Loss_aux 0.256, Train_accy 89.75:  10%|█         | 2/20 [02:58<25:47, 85.97s/it] 
Task 9, Epoch 3/20 => Loss 0.477, Loss_clf 0.307, Loss_aux 0.171, Train_accy 90.55:  10%|█         | 2/20 [04:08<25:47, 85.97s/it]
Task 9, Epoch 3/20 => Loss 0.477, Loss_clf 0.307, Loss_aux 0.171, Train_accy 90.55:  15%|█▌        | 3/20 [04:08<22:16, 78.59s/it]
Task 9, Epoch 4/20 => Loss 0.396, Loss_clf 0.252, Loss_aux 0.144, Train_accy 92.68:  15%|█▌        | 3/20 [05:18<22:16, 78.59s/it]
Task 9, Epoch 4/20 => Loss 0.396, Loss_clf 0.252, Loss_aux 0.144, Train_accy 92.68:  20%|██        | 4/20 [05:18<20:02, 75.16s/it]
Task 9, Epoch 5/20 => Loss 0.414, Loss_clf 0.266, Loss_aux 0.149, Train_accy 92.68:  20%|██        | 4/20 [06:28<20:02, 75.16s/it]
Task 9, Epoch 5/20 => Loss 0.414, Loss_clf 0.266, Loss_aux 0.149, Train_accy 92.68:  25%|██▌       | 5/20 [06:28<18:19, 73.33s/it]
Task 9, Epoch 6/20 => Loss 0.368, Loss_clf 0.262, Loss_aux 0.107, Train_accy 92.23, Test_accy 89.65:  25%|██▌       | 5/20 [08:13<18:19, 73.33s/it]
Task 9, Epoch 6/20 => Loss 0.368, Loss_clf 0.262, Loss_aux 0.107, Train_accy 92.23, Test_accy 89.65:  30%|███       | 6/20 [08:13<19:34, 83.91s/it]
Task 9, Epoch 7/20 => Loss 0.353, Loss_clf 0.248, Loss_aux 0.104, Train_accy 93.03:  30%|███       | 6/20 [09:25<19:34, 83.91s/it]                 
Task 9, Epoch 7/20 => Loss 0.353, Loss_clf 0.248, Loss_aux 0.104, Train_accy 93.03:  35%|███▌      | 7/20 [09:25<17:20, 80.02s/it]
Task 9, Epoch 8/20 => Loss 0.368, Loss_clf 0.265, Loss_aux 0.103, Train_accy 92.99:  35%|███▌      | 7/20 [10:37<17:20, 80.02s/it]
Task 9, Epoch 8/20 => Loss 0.368, Loss_clf 0.265, Loss_aux 0.103, Train_accy 92.99:  40%|████      | 8/20 [10:37<15:29, 77.45s/it]
Task 9, Epoch 9/20 => Loss 0.306, Loss_clf 0.231, Loss_aux 0.076, Train_accy 93.56:  40%|████      | 8/20 [11:49<15:29, 77.45s/it]
Task 9, Epoch 9/20 => Loss 0.306, Loss_clf 0.231, Loss_aux 0.076, Train_accy 93.56:  45%|████▌     | 9/20 [11:49<13:53, 75.74s/it]
Task 9, Epoch 10/20 => Loss 0.347, Loss_clf 0.251, Loss_aux 0.097, Train_accy 92.72:  45%|████▌     | 9/20 [13:16<13:53, 75.74s/it]
Task 9, Epoch 10/20 => Loss 0.347, Loss_clf 0.251, Loss_aux 0.097, Train_accy 92.72:  50%|█████     | 10/20 [13:16<13:14, 79.44s/it]
Task 9, Epoch 11/20 => Loss 0.342, Loss_clf 0.238, Loss_aux 0.104, Train_accy 93.52, Test_accy 89.06:  50%|█████     | 10/20 [15:27<13:14, 79.44s/it]
Task 9, Epoch 11/20 => Loss 0.342, Loss_clf 0.238, Loss_aux 0.104, Train_accy 93.52, Test_accy 89.06:  55%|█████▌    | 11/20 [15:27<14:17, 95.24s/it]
Task 9, Epoch 12/20 => Loss 0.312, Loss_clf 0.215, Loss_aux 0.097, Train_accy 94.45:  55%|█████▌    | 11/20 [16:58<14:17, 95.24s/it]                 
Task 9, Epoch 12/20 => Loss 0.312, Loss_clf 0.215, Loss_aux 0.097, Train_accy 94.45:  60%|██████    | 12/20 [16:58<12:30, 93.80s/it]
Task 9, Epoch 13/20 => Loss 0.286, Loss_clf 0.198, Loss_aux 0.088, Train_accy 94.41:  60%|██████    | 12/20 [18:28<12:30, 93.80s/it]
Task 9, Epoch 13/20 => Loss 0.286, Loss_clf 0.198, Loss_aux 0.088, Train_accy 94.41:  65%|██████▌   | 13/20 [18:28<10:48, 92.71s/it]
Task 9, Epoch 14/20 => Loss 0.312, Loss_clf 0.223, Loss_aux 0.088, Train_accy 93.87:  65%|██████▌   | 13/20 [19:58<10:48, 92.71s/it]
Task 9, Epoch 14/20 => Loss 0.312, Loss_clf 0.223, Loss_aux 0.088, Train_accy 93.87:  70%|███████   | 14/20 [19:58<09:11, 91.97s/it]
Task 9, Epoch 15/20 => Loss 0.335, Loss_clf 0.239, Loss_aux 0.096, Train_accy 92.99:  70%|███████   | 14/20 [21:28<09:11, 91.97s/it]
Task 9, Epoch 15/20 => Loss 0.335, Loss_clf 0.239, Loss_aux 0.096, Train_accy 92.99:  75%|███████▌  | 15/20 [21:28<07:36, 91.32s/it]
Task 9, Epoch 16/20 => Loss 0.316, Loss_clf 0.219, Loss_aux 0.097, Train_accy 93.30, Test_accy 89.48:  75%|███████▌  | 15/20 [23:37<07:36, 91.32s/it]
Task 9, Epoch 16/20 => Loss 0.316, Loss_clf 0.219, Loss_aux 0.097, Train_accy 93.30, Test_accy 89.48:  80%|████████  | 16/20 [23:37<06:50, 102.60s/it]
Task 9, Epoch 17/20 => Loss 0.265, Loss_clf 0.196, Loss_aux 0.069, Train_accy 94.72:  80%|████████  | 16/20 [25:07<06:50, 102.60s/it]                 
Task 9, Epoch 17/20 => Loss 0.265, Loss_clf 0.196, Loss_aux 0.069, Train_accy 94.72:  85%|████████▌ | 17/20 [25:07<04:57, 99.00s/it] 
Task 9, Epoch 18/20 => Loss 0.281, Loss_clf 0.210, Loss_aux 0.071, Train_accy 94.50:  85%|████████▌ | 17/20 [26:38<04:57, 99.00s/it]
Task 9, Epoch 18/20 => Loss 0.281, Loss_clf 0.210, Loss_aux 0.071, Train_accy 94.50:  90%|█████████ | 18/20 [26:38<03:12, 96.42s/it]
Task 9, Epoch 19/20 => Loss 0.314, Loss_clf 0.238, Loss_aux 0.076, Train_accy 93.48:  90%|█████████ | 18/20 [28:08<03:12, 96.42s/it]
Task 9, Epoch 19/20 => Loss 0.314, Loss_clf 0.238, Loss_aux 0.076, Train_accy 93.48:  95%|█████████▌| 19/20 [28:08<01:34, 94.60s/it]
Task 9, Epoch 20/20 => Loss 0.336, Loss_clf 0.253, Loss_aux 0.083, Train_accy 92.99:  95%|█████████▌| 19/20 [29:39<01:34, 94.60s/it]
Task 9, Epoch 20/20 => Loss 0.336, Loss_clf 0.253, Loss_aux 0.083, Train_accy 92.99: 100%|██████████| 20/20 [29:39<00:00, 93.34s/it]
Task 9, Epoch 20/20 => Loss 0.336, Loss_clf 0.253, Loss_aux 0.083, Train_accy 92.99: 100%|██████████| 20/20 [29:39<00:00, 88.96s/it]2024-09-12 16:27:57,994 [der.py] => Task 9, Epoch 20/20 => Loss 0.336, Loss_clf 0.253, Loss_aux 0.083, Train_accy 92.99
2024-09-12 16:27:57,995 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 16:31:39,306 [der.py] => Exemplar size: 2000
2024-09-12 16:31:39,306 [trainer.py] => CNN: {'total': 88.89, '00-09': 81.36, '10-19': 85.27, '20-29': 89.69, '30-39': 78.18, '40-49': 94.39, '50-59': 88.29, '60-69': 83.96, '70-79': 94.33, '80-89': 94.74, '90-99': 95.59, 'old': 88.02, 'new': 95.59}
2024-09-12 16:31:39,306 [trainer.py] => NME: {'total': 90.15, '00-09': 84.75, '10-19': 90.7, '20-29': 95.88, '30-39': 86.36, '40-49': 93.46, '50-59': 89.19, '60-69': 85.85, '70-79': 91.49, '80-89': 94.74, '90-99': 88.97, 'old': 90.3, 'new': 88.97}
2024-09-12 16:31:39,306 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89]
2024-09-12 16:31:39,306 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15]
2024-09-12 16:31:39,306 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15]
2024-09-12 16:31:39,307 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91]

Average Accuracy (CNN): 93.33
Average Accuracy (NME): 94.3
2024-09-12 16:31:39,307 [trainer.py] => Average Accuracy (CNN): 93.33
2024-09-12 16:31:39,307 [trainer.py] => Average Accuracy (NME): 94.3
2024-09-12 16:31:39,313 [trainer.py] => All params: 858763119
2024-09-12 16:31:39,318 [trainer.py] => Trainable params: 86575215
2024-09-12 16:31:40,918 [der.py] => Learning on 100-110
2024-09-12 16:31:40,931 [der.py] => All params: 944723065
2024-09-12 16:31:40,936 [der.py] => Trainable params: 86736505

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.517, Loss_clf 0.799, Loss_aux 0.718, Train_accy 85.93, Test_accy 87.26:   0%|          | 0/20 [02:36<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.517, Loss_clf 0.799, Loss_aux 0.718, Train_accy 85.93, Test_accy 87.26:   5%|▌         | 1/20 [02:36<49:35, 156.59s/it]
Task 10, Epoch 2/20 => Loss 0.525, Loss_clf 0.338, Loss_aux 0.187, Train_accy 91.01:   5%|▌         | 1/20 [04:24<49:35, 156.59s/it]                 
Task 10, Epoch 2/20 => Loss 0.525, Loss_clf 0.338, Loss_aux 0.187, Train_accy 91.01:  10%|█         | 2/20 [04:24<38:20, 127.79s/it]
Task 10, Epoch 3/20 => Loss 0.402, Loss_clf 0.265, Loss_aux 0.137, Train_accy 92.66:  10%|█         | 2/20 [06:12<38:20, 127.79s/it]
Task 10, Epoch 3/20 => Loss 0.402, Loss_clf 0.265, Loss_aux 0.137, Train_accy 92.66:  15%|█▌        | 3/20 [06:12<33:37, 118.69s/it]
Task 10, Epoch 4/20 => Loss 0.420, Loss_clf 0.286, Loss_aux 0.134, Train_accy 91.90:  15%|█▌        | 3/20 [07:56<33:37, 118.69s/it]
Task 10, Epoch 4/20 => Loss 0.420, Loss_clf 0.286, Loss_aux 0.134, Train_accy 91.90:  20%|██        | 4/20 [07:56<30:07, 112.99s/it]
Task 10, Epoch 5/20 => Loss 0.346, Loss_clf 0.232, Loss_aux 0.114, Train_accy 93.47:  20%|██        | 4/20 [09:44<30:07, 112.99s/it]
Task 10, Epoch 5/20 => Loss 0.346, Loss_clf 0.232, Loss_aux 0.114, Train_accy 93.47:  25%|██▌       | 5/20 [09:44<27:48, 111.21s/it]
Task 10, Epoch 6/20 => Loss 0.334, Loss_clf 0.246, Loss_aux 0.089, Train_accy 93.15, Test_accy 87.03:  25%|██▌       | 5/20 [12:21<27:48, 111.21s/it]
Task 10, Epoch 6/20 => Loss 0.334, Loss_clf 0.246, Loss_aux 0.089, Train_accy 93.15, Test_accy 87.03:  30%|███       | 6/20 [12:21<29:35, 126.85s/it]
Task 10, Epoch 7/20 => Loss 0.320, Loss_clf 0.233, Loss_aux 0.087, Train_accy 93.23:  30%|███       | 6/20 [14:09<29:35, 126.85s/it]                 
Task 10, Epoch 7/20 => Loss 0.320, Loss_clf 0.233, Loss_aux 0.087, Train_accy 93.23:  35%|███▌      | 7/20 [14:09<26:08, 120.67s/it]
Task 10, Epoch 8/20 => Loss 0.344, Loss_clf 0.244, Loss_aux 0.100, Train_accy 92.95:  35%|███▌      | 7/20 [15:57<26:08, 120.67s/it]
Task 10, Epoch 8/20 => Loss 0.344, Loss_clf 0.244, Loss_aux 0.100, Train_accy 92.95:  40%|████      | 8/20 [15:57<23:18, 116.57s/it]
Task 10, Epoch 9/20 => Loss 0.317, Loss_clf 0.234, Loss_aux 0.083, Train_accy 93.51:  40%|████      | 8/20 [17:43<23:18, 116.57s/it]
Task 10, Epoch 9/20 => Loss 0.317, Loss_clf 0.234, Loss_aux 0.083, Train_accy 93.51:  45%|████▌     | 9/20 [17:43<20:45, 113.19s/it]
Task 10, Epoch 10/20 => Loss 0.296, Loss_clf 0.213, Loss_aux 0.083, Train_accy 94.20:  45%|████▌     | 9/20 [19:29<20:45, 113.19s/it]
Task 10, Epoch 10/20 => Loss 0.296, Loss_clf 0.213, Loss_aux 0.083, Train_accy 94.20:  50%|█████     | 10/20 [19:29<18:30, 111.00s/it]
Task 10, Epoch 11/20 => Loss 0.289, Loss_clf 0.199, Loss_aux 0.090, Train_accy 94.20, Test_accy 88.49:  50%|█████     | 10/20 [22:06<18:30, 111.00s/it]
Task 10, Epoch 11/20 => Loss 0.289, Loss_clf 0.199, Loss_aux 0.090, Train_accy 94.20, Test_accy 88.49:  55%|█████▌    | 11/20 [22:06<18:46, 125.18s/it]
Task 10, Epoch 12/20 => Loss 0.317, Loss_clf 0.234, Loss_aux 0.083, Train_accy 93.87:  55%|█████▌    | 11/20 [23:54<18:46, 125.18s/it]                 
Task 10, Epoch 12/20 => Loss 0.317, Loss_clf 0.234, Loss_aux 0.083, Train_accy 93.87:  60%|██████    | 12/20 [23:54<15:59, 119.96s/it]
Task 10, Epoch 13/20 => Loss 0.306, Loss_clf 0.220, Loss_aux 0.086, Train_accy 94.28:  60%|██████    | 12/20 [25:42<15:59, 119.96s/it]
Task 10, Epoch 13/20 => Loss 0.306, Loss_clf 0.220, Loss_aux 0.086, Train_accy 94.28:  65%|██████▌   | 13/20 [25:42<13:33, 116.27s/it]
Task 10, Epoch 14/20 => Loss 0.284, Loss_clf 0.213, Loss_aux 0.071, Train_accy 94.36:  65%|██████▌   | 13/20 [27:30<13:33, 116.27s/it]
Task 10, Epoch 14/20 => Loss 0.284, Loss_clf 0.213, Loss_aux 0.071, Train_accy 94.36:  70%|███████   | 14/20 [27:30<11:22, 113.74s/it]
Task 10, Epoch 15/20 => Loss 0.281, Loss_clf 0.210, Loss_aux 0.071, Train_accy 93.79:  70%|███████   | 14/20 [29:14<11:22, 113.74s/it]
Task 10, Epoch 15/20 => Loss 0.281, Loss_clf 0.210, Loss_aux 0.071, Train_accy 93.79:  75%|███████▌  | 15/20 [29:14<09:14, 110.85s/it]
Task 10, Epoch 16/20 => Loss 0.334, Loss_clf 0.232, Loss_aux 0.102, Train_accy 93.55, Test_accy 89.10:  75%|███████▌  | 15/20 [31:51<09:14, 110.85s/it]
Task 10, Epoch 16/20 => Loss 0.334, Loss_clf 0.232, Loss_aux 0.102, Train_accy 93.55, Test_accy 89.10:  80%|████████  | 16/20 [31:51<08:18, 124.75s/it]
Task 10, Epoch 17/20 => Loss 0.272, Loss_clf 0.202, Loss_aux 0.070, Train_accy 94.76:  80%|████████  | 16/20 [33:39<08:18, 124.75s/it]                 
Task 10, Epoch 17/20 => Loss 0.272, Loss_clf 0.202, Loss_aux 0.070, Train_accy 94.76:  85%|████████▌ | 17/20 [33:39<05:58, 119.63s/it]
Task 10, Epoch 18/20 => Loss 0.299, Loss_clf 0.218, Loss_aux 0.081, Train_accy 94.07:  85%|████████▌ | 17/20 [35:26<05:58, 119.63s/it]
Task 10, Epoch 18/20 => Loss 0.299, Loss_clf 0.218, Loss_aux 0.081, Train_accy 94.07:  90%|█████████ | 18/20 [35:26<03:52, 116.07s/it]
Task 10, Epoch 19/20 => Loss 0.299, Loss_clf 0.234, Loss_aux 0.065, Train_accy 93.99:  90%|█████████ | 18/20 [37:14<03:52, 116.07s/it]
Task 10, Epoch 19/20 => Loss 0.299, Loss_clf 0.234, Loss_aux 0.065, Train_accy 93.99:  95%|█████████▌| 19/20 [37:14<01:53, 113.63s/it]
Task 10, Epoch 20/20 => Loss 0.291, Loss_clf 0.231, Loss_aux 0.059, Train_accy 93.59:  95%|█████████▌| 19/20 [39:00<01:53, 113.63s/it]
Task 10, Epoch 20/20 => Loss 0.291, Loss_clf 0.231, Loss_aux 0.059, Train_accy 93.59: 100%|██████████| 20/20 [39:00<00:00, 111.12s/it]
Task 10, Epoch 20/20 => Loss 0.291, Loss_clf 0.231, Loss_aux 0.059, Train_accy 93.59: 100%|██████████| 20/20 [39:00<00:00, 117.01s/it]2024-09-12 17:10:41,136 [der.py] => Task 10, Epoch 20/20 => Loss 0.291, Loss_clf 0.231, Loss_aux 0.059, Train_accy 93.59
2024-09-12 17:10:41,138 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 17:15:04,686 [der.py] => Exemplar size: 2200
2024-09-12 17:15:04,686 [trainer.py] => CNN: {'total': 89.33, '00-09': 82.2, '10-19': 88.37, '20-29': 89.69, '30-39': 80.91, '40-49': 94.39, '50-59': 88.29, '60-69': 82.08, '70-79': 91.49, '80-89': 93.23, '90-99': 94.85, '100-109': 94.78, 'old': 88.8, 'new': 94.78}
2024-09-12 17:15:04,686 [trainer.py] => NME: {'total': 90.02, '00-09': 83.9, '10-19': 88.37, '20-29': 95.88, '30-39': 86.36, '40-49': 93.46, '50-59': 89.19, '60-69': 85.85, '70-79': 90.78, '80-89': 93.98, '90-99': 91.18, '100-109': 91.3, 'old': 89.9, 'new': 91.3}
2024-09-12 17:15:04,686 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33]
2024-09-12 17:15:04,686 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0]
2024-09-12 17:15:04,686 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02]
2024-09-12 17:15:04,686 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93]

Average Accuracy (CNN): 92.97
Average Accuracy (NME): 93.91
2024-09-12 17:15:04,686 [trainer.py] => Average Accuracy (CNN): 92.97
2024-09-12 17:15:04,686 [trainer.py] => Average Accuracy (NME): 93.91
2024-09-12 17:15:04,693 [trainer.py] => All params: 944723065
2024-09-12 17:15:04,699 [trainer.py] => Trainable params: 86736505
2024-09-12 17:15:06,402 [der.py] => Learning on 110-120
2024-09-12 17:15:06,414 [der.py] => All params: 1030698371
2024-09-12 17:15:06,420 [der.py] => Trainable params: 86913155

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.545, Loss_clf 0.950, Loss_aux 0.595, Train_accy 85.55, Test_accy 86.94:   0%|          | 0/20 [03:02<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.545, Loss_clf 0.950, Loss_aux 0.595, Train_accy 85.55, Test_accy 86.94:   5%|▌         | 1/20 [03:02<57:44, 182.33s/it]
Task 11, Epoch 2/20 => Loss 0.570, Loss_clf 0.357, Loss_aux 0.213, Train_accy 90.04:   5%|▌         | 1/20 [05:04<57:44, 182.33s/it]                 
Task 11, Epoch 2/20 => Loss 0.570, Loss_clf 0.357, Loss_aux 0.213, Train_accy 90.04:  10%|█         | 2/20 [05:04<44:05, 146.98s/it]
Task 11, Epoch 3/20 => Loss 0.481, Loss_clf 0.309, Loss_aux 0.172, Train_accy 91.58:  10%|█         | 2/20 [07:09<44:05, 146.98s/it]
Task 11, Epoch 3/20 => Loss 0.481, Loss_clf 0.309, Loss_aux 0.172, Train_accy 91.58:  15%|█▌        | 3/20 [07:09<38:47, 136.91s/it]
Task 11, Epoch 4/20 => Loss 0.397, Loss_clf 0.271, Loss_aux 0.126, Train_accy 92.03:  15%|█▌        | 3/20 [09:14<38:47, 136.91s/it]
Task 11, Epoch 4/20 => Loss 0.397, Loss_clf 0.271, Loss_aux 0.126, Train_accy 92.03:  20%|██        | 4/20 [09:14<35:15, 132.22s/it]
Task 11, Epoch 5/20 => Loss 0.355, Loss_clf 0.239, Loss_aux 0.117, Train_accy 93.45:  20%|██        | 4/20 [11:19<35:15, 132.22s/it]
Task 11, Epoch 5/20 => Loss 0.355, Loss_clf 0.239, Loss_aux 0.117, Train_accy 93.45:  25%|██▌       | 5/20 [11:19<32:24, 129.65s/it]
Task 11, Epoch 6/20 => Loss 0.366, Loss_clf 0.257, Loss_aux 0.108, Train_accy 92.81, Test_accy 86.16:  25%|██▌       | 5/20 [14:20<32:24, 129.65s/it]
Task 11, Epoch 6/20 => Loss 0.366, Loss_clf 0.257, Loss_aux 0.108, Train_accy 92.81, Test_accy 86.16:  30%|███       | 6/20 [14:20<34:16, 146.92s/it]
Task 11, Epoch 7/20 => Loss 0.300, Loss_clf 0.213, Loss_aux 0.087, Train_accy 93.82:  30%|███       | 6/20 [16:25<34:16, 146.92s/it]                 
Task 11, Epoch 7/20 => Loss 0.300, Loss_clf 0.213, Loss_aux 0.087, Train_accy 93.82:  35%|███▌      | 7/20 [16:25<30:16, 139.76s/it]
Task 11, Epoch 8/20 => Loss 0.365, Loss_clf 0.265, Loss_aux 0.101, Train_accy 93.04:  35%|███▌      | 7/20 [18:30<30:16, 139.76s/it]
Task 11, Epoch 8/20 => Loss 0.365, Loss_clf 0.265, Loss_aux 0.101, Train_accy 93.04:  40%|████      | 8/20 [18:30<27:01, 135.09s/it]
Task 11, Epoch 9/20 => Loss 0.315, Loss_clf 0.221, Loss_aux 0.095, Train_accy 94.23:  40%|████      | 8/20 [20:35<27:01, 135.09s/it]
Task 11, Epoch 9/20 => Loss 0.315, Loss_clf 0.221, Loss_aux 0.095, Train_accy 94.23:  45%|████▌     | 9/20 [20:35<24:13, 132.13s/it]
Task 11, Epoch 10/20 => Loss 0.283, Loss_clf 0.206, Loss_aux 0.078, Train_accy 94.35:  45%|████▌     | 9/20 [22:40<24:13, 132.13s/it]
Task 11, Epoch 10/20 => Loss 0.283, Loss_clf 0.206, Loss_aux 0.078, Train_accy 94.35:  50%|█████     | 10/20 [22:40<21:39, 129.96s/it]
Task 11, Epoch 11/20 => Loss 0.338, Loss_clf 0.256, Loss_aux 0.081, Train_accy 92.85, Test_accy 88.35:  50%|█████     | 10/20 [25:40<21:39, 129.96s/it]
Task 11, Epoch 11/20 => Loss 0.338, Loss_clf 0.256, Loss_aux 0.081, Train_accy 92.85, Test_accy 88.35:  55%|█████▌    | 11/20 [25:40<21:47, 145.27s/it]
Task 11, Epoch 12/20 => Loss 0.292, Loss_clf 0.217, Loss_aux 0.074, Train_accy 93.90:  55%|█████▌    | 11/20 [27:45<21:47, 145.27s/it]                 
Task 11, Epoch 12/20 => Loss 0.292, Loss_clf 0.217, Loss_aux 0.074, Train_accy 93.90:  60%|██████    | 12/20 [27:45<18:32, 139.12s/it]
Task 11, Epoch 13/20 => Loss 0.283, Loss_clf 0.207, Loss_aux 0.076, Train_accy 94.12:  60%|██████    | 12/20 [29:50<18:32, 139.12s/it]
Task 11, Epoch 13/20 => Loss 0.283, Loss_clf 0.207, Loss_aux 0.076, Train_accy 94.12:  65%|██████▌   | 13/20 [29:50<15:43, 134.78s/it]
Task 11, Epoch 14/20 => Loss 0.290, Loss_clf 0.201, Loss_aux 0.089, Train_accy 94.46:  65%|██████▌   | 13/20 [31:55<15:43, 134.78s/it]
Task 11, Epoch 14/20 => Loss 0.290, Loss_clf 0.201, Loss_aux 0.089, Train_accy 94.46:  70%|███████   | 14/20 [31:55<13:10, 131.69s/it]
Task 11, Epoch 15/20 => Loss 0.285, Loss_clf 0.217, Loss_aux 0.068, Train_accy 94.08:  70%|███████   | 14/20 [34:00<13:10, 131.69s/it]
Task 11, Epoch 15/20 => Loss 0.285, Loss_clf 0.217, Loss_aux 0.068, Train_accy 94.08:  75%|███████▌  | 15/20 [34:00<10:48, 129.62s/it]
Task 11, Epoch 16/20 => Loss 0.244, Loss_clf 0.179, Loss_aux 0.065, Train_accy 95.25, Test_accy 88.42:  75%|███████▌  | 15/20 [36:59<10:48, 129.62s/it]
Task 11, Epoch 16/20 => Loss 0.244, Loss_clf 0.179, Loss_aux 0.065, Train_accy 95.25, Test_accy 88.42:  80%|████████  | 16/20 [36:59<09:38, 144.62s/it]
Task 11, Epoch 17/20 => Loss 0.301, Loss_clf 0.228, Loss_aux 0.073, Train_accy 94.05:  80%|████████  | 16/20 [39:04<09:38, 144.62s/it]                 
Task 11, Epoch 17/20 => Loss 0.301, Loss_clf 0.228, Loss_aux 0.073, Train_accy 94.05:  85%|████████▌ | 17/20 [39:04<06:55, 138.66s/it]
Task 11, Epoch 18/20 => Loss 0.284, Loss_clf 0.207, Loss_aux 0.077, Train_accy 94.38:  85%|████████▌ | 17/20 [41:09<06:55, 138.66s/it]
Task 11, Epoch 18/20 => Loss 0.284, Loss_clf 0.207, Loss_aux 0.077, Train_accy 94.38:  90%|█████████ | 18/20 [41:09<04:29, 134.57s/it]
Task 11, Epoch 19/20 => Loss 0.241, Loss_clf 0.189, Loss_aux 0.052, Train_accy 95.02:  90%|█████████ | 18/20 [43:14<04:29, 134.57s/it]
Task 11, Epoch 19/20 => Loss 0.241, Loss_clf 0.189, Loss_aux 0.052, Train_accy 95.02:  95%|█████████▌| 19/20 [43:14<02:11, 131.64s/it]
Task 11, Epoch 20/20 => Loss 0.289, Loss_clf 0.214, Loss_aux 0.075, Train_accy 94.31:  95%|█████████▌| 19/20 [45:17<02:11, 131.64s/it]
Task 11, Epoch 20/20 => Loss 0.289, Loss_clf 0.214, Loss_aux 0.075, Train_accy 94.31: 100%|██████████| 20/20 [45:17<00:00, 129.12s/it]
Task 11, Epoch 20/20 => Loss 0.289, Loss_clf 0.214, Loss_aux 0.075, Train_accy 94.31: 100%|██████████| 20/20 [45:17<00:00, 135.87s/it]2024-09-12 18:00:23,963 [der.py] => Task 11, Epoch 20/20 => Loss 0.289, Loss_clf 0.214, Loss_aux 0.075, Train_accy 94.31
2024-09-12 18:00:23,965 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 18:05:27,881 [der.py] => Exemplar size: 2400
2024-09-12 18:05:27,881 [trainer.py] => CNN: {'total': 88.06, '00-09': 83.05, '10-19': 82.17, '20-29': 91.75, '30-39': 80.0, '40-49': 92.52, '50-59': 88.29, '60-69': 84.91, '70-79': 84.4, '80-89': 90.23, '90-99': 93.38, '100-109': 92.17, '110-119': 94.69, 'old': 87.49, 'new': 94.69}
2024-09-12 18:05:27,881 [trainer.py] => NME: {'total': 88.91, '00-09': 83.9, '10-19': 86.05, '20-29': 96.91, '30-39': 85.45, '40-49': 92.52, '50-59': 88.29, '60-69': 84.91, '70-79': 85.82, '80-89': 93.23, '90-99': 91.18, '100-109': 92.17, '110-119': 87.61, 'old': 89.03, 'new': 87.61}
2024-09-12 18:05:27,882 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06]
2024-09-12 18:05:27,882 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88]
2024-09-12 18:05:27,882 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91]
2024-09-12 18:05:27,882 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73]

Average Accuracy (CNN): 92.56
Average Accuracy (NME): 93.49
2024-09-12 18:05:27,882 [trainer.py] => Average Accuracy (CNN): 92.56
2024-09-12 18:05:27,882 [trainer.py] => Average Accuracy (NME): 93.49
2024-09-12 18:05:27,889 [trainer.py] => All params: 1030698371
2024-09-12 18:05:27,895 [trainer.py] => Trainable params: 86913155
2024-09-12 18:05:29,519 [der.py] => Learning on 120-130
2024-09-12 18:05:29,534 [der.py] => All params: 1116689037
2024-09-12 18:05:29,540 [der.py] => Trainable params: 87105165

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.589, Loss_clf 0.772, Loss_aux 0.817, Train_accy 85.53, Test_accy 84.64:   0%|          | 0/20 [03:27<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.589, Loss_clf 0.772, Loss_aux 0.817, Train_accy 85.53, Test_accy 84.64:   5%|▌         | 1/20 [03:27<1:05:41, 207.47s/it]
Task 12, Epoch 2/20 => Loss 0.533, Loss_clf 0.314, Loss_aux 0.219, Train_accy 91.15:   5%|▌         | 1/20 [05:51<1:05:41, 207.47s/it]                 
Task 12, Epoch 2/20 => Loss 0.533, Loss_clf 0.314, Loss_aux 0.219, Train_accy 91.15:  10%|█         | 2/20 [05:51<51:02, 170.16s/it]  
Task 12, Epoch 3/20 => Loss 0.492, Loss_clf 0.304, Loss_aux 0.188, Train_accy 91.74:  10%|█         | 2/20 [08:16<51:02, 170.16s/it]
Task 12, Epoch 3/20 => Loss 0.492, Loss_clf 0.304, Loss_aux 0.188, Train_accy 91.74:  15%|█▌        | 3/20 [08:16<44:54, 158.49s/it]
Task 12, Epoch 4/20 => Loss 0.391, Loss_clf 0.258, Loss_aux 0.133, Train_accy 93.16:  15%|█▌        | 3/20 [10:40<44:54, 158.49s/it]
Task 12, Epoch 4/20 => Loss 0.391, Loss_clf 0.258, Loss_aux 0.133, Train_accy 93.16:  20%|██        | 4/20 [10:40<40:45, 152.84s/it]
Task 12, Epoch 5/20 => Loss 0.373, Loss_clf 0.249, Loss_aux 0.124, Train_accy 93.03:  20%|██        | 4/20 [13:04<40:45, 152.84s/it]
Task 12, Epoch 5/20 => Loss 0.373, Loss_clf 0.249, Loss_aux 0.124, Train_accy 93.03:  25%|██▌       | 5/20 [13:04<37:23, 149.58s/it]
Task 12, Epoch 6/20 => Loss 0.339, Loss_clf 0.241, Loss_aux 0.098, Train_accy 93.10, Test_accy 87.13:  25%|██▌       | 5/20 [16:33<37:23, 149.58s/it]
Task 12, Epoch 6/20 => Loss 0.339, Loss_clf 0.241, Loss_aux 0.098, Train_accy 93.10, Test_accy 87.13:  30%|███       | 6/20 [16:33<39:38, 169.92s/it]
Task 12, Epoch 7/20 => Loss 0.356, Loss_clf 0.256, Loss_aux 0.100, Train_accy 93.16:  30%|███       | 6/20 [18:57<39:38, 169.92s/it]                 
Task 12, Epoch 7/20 => Loss 0.356, Loss_clf 0.256, Loss_aux 0.100, Train_accy 93.16:  35%|███▌      | 7/20 [18:57<35:00, 161.59s/it]
Task 12, Epoch 8/20 => Loss 0.372, Loss_clf 0.267, Loss_aux 0.104, Train_accy 93.06:  35%|███▌      | 7/20 [21:22<35:00, 161.59s/it]
Task 12, Epoch 8/20 => Loss 0.372, Loss_clf 0.267, Loss_aux 0.104, Train_accy 93.06:  40%|████      | 8/20 [21:22<31:13, 156.15s/it]
Task 12, Epoch 9/20 => Loss 0.368, Loss_clf 0.267, Loss_aux 0.101, Train_accy 92.75:  40%|████      | 8/20 [23:45<31:13, 156.15s/it]
Task 12, Epoch 9/20 => Loss 0.368, Loss_clf 0.267, Loss_aux 0.101, Train_accy 92.75:  45%|████▌     | 9/20 [23:45<27:53, 152.15s/it]
Task 12, Epoch 10/20 => Loss 0.430, Loss_clf 0.327, Loss_aux 0.104, Train_accy 92.40:  45%|████▌     | 9/20 [26:08<27:53, 152.15s/it]
Task 12, Epoch 10/20 => Loss 0.430, Loss_clf 0.327, Loss_aux 0.104, Train_accy 92.40:  50%|█████     | 10/20 [26:08<24:50, 149.09s/it]
Task 12, Epoch 11/20 => Loss 0.365, Loss_clf 0.278, Loss_aux 0.086, Train_accy 92.40, Test_accy 86.54:  50%|█████     | 10/20 [29:39<24:50, 149.09s/it]
Task 12, Epoch 11/20 => Loss 0.365, Loss_clf 0.278, Loss_aux 0.086, Train_accy 92.40, Test_accy 86.54:  55%|█████▌    | 11/20 [29:39<25:15, 168.33s/it]
Task 12, Epoch 12/20 => Loss 0.312, Loss_clf 0.238, Loss_aux 0.074, Train_accy 93.79:  55%|█████▌    | 11/20 [32:01<25:15, 168.33s/it]                 
Task 12, Epoch 12/20 => Loss 0.312, Loss_clf 0.238, Loss_aux 0.074, Train_accy 93.79:  60%|██████    | 12/20 [32:01<21:21, 160.17s/it]
Task 12, Epoch 13/20 => Loss 0.349, Loss_clf 0.234, Loss_aux 0.115, Train_accy 93.37:  60%|██████    | 12/20 [34:21<21:21, 160.17s/it]
Task 12, Epoch 13/20 => Loss 0.349, Loss_clf 0.234, Loss_aux 0.115, Train_accy 93.37:  65%|██████▌   | 13/20 [34:21<17:57, 153.98s/it]
Task 12, Epoch 14/20 => Loss 0.358, Loss_clf 0.271, Loss_aux 0.088, Train_accy 93.68:  65%|██████▌   | 13/20 [36:42<17:57, 153.98s/it]
Task 12, Epoch 14/20 => Loss 0.358, Loss_clf 0.271, Loss_aux 0.088, Train_accy 93.68:  70%|███████   | 14/20 [36:42<15:00, 150.01s/it]
Task 12, Epoch 15/20 => Loss 0.362, Loss_clf 0.272, Loss_aux 0.090, Train_accy 93.06:  70%|███████   | 14/20 [39:06<15:00, 150.01s/it]
Task 12, Epoch 15/20 => Loss 0.362, Loss_clf 0.272, Loss_aux 0.090, Train_accy 93.06:  75%|███████▌  | 15/20 [39:06<12:21, 148.27s/it]
Task 12, Epoch 16/20 => Loss 0.292, Loss_clf 0.225, Loss_aux 0.067, Train_accy 93.62, Test_accy 87.20:  75%|███████▌  | 15/20 [42:38<12:21, 148.27s/it]
Task 12, Epoch 16/20 => Loss 0.292, Loss_clf 0.225, Loss_aux 0.067, Train_accy 93.62, Test_accy 87.20:  80%|████████  | 16/20 [42:38<11:10, 167.55s/it]
Task 12, Epoch 17/20 => Loss 0.326, Loss_clf 0.251, Loss_aux 0.076, Train_accy 93.58:  80%|████████  | 16/20 [45:01<11:10, 167.55s/it]                 
Task 12, Epoch 17/20 => Loss 0.326, Loss_clf 0.251, Loss_aux 0.076, Train_accy 93.58:  85%|████████▌ | 17/20 [45:01<08:00, 160.05s/it]
Task 12, Epoch 18/20 => Loss 0.358, Loss_clf 0.276, Loss_aux 0.082, Train_accy 93.16:  85%|████████▌ | 17/20 [47:24<08:00, 160.05s/it]
Task 12, Epoch 18/20 => Loss 0.358, Loss_clf 0.276, Loss_aux 0.082, Train_accy 93.16:  90%|█████████ | 18/20 [47:24<05:09, 154.87s/it]
Task 12, Epoch 19/20 => Loss 0.319, Loss_clf 0.252, Loss_aux 0.067, Train_accy 94.07:  90%|█████████ | 18/20 [49:48<05:09, 154.87s/it]
Task 12, Epoch 19/20 => Loss 0.319, Loss_clf 0.252, Loss_aux 0.067, Train_accy 94.07:  95%|█████████▌| 19/20 [49:48<02:31, 151.75s/it]
Task 12, Epoch 20/20 => Loss 0.352, Loss_clf 0.276, Loss_aux 0.076, Train_accy 93.86:  95%|█████████▌| 19/20 [52:11<02:31, 151.75s/it]
Task 12, Epoch 20/20 => Loss 0.352, Loss_clf 0.276, Loss_aux 0.076, Train_accy 93.86: 100%|██████████| 20/20 [52:12<00:00, 149.26s/it]
Task 12, Epoch 20/20 => Loss 0.352, Loss_clf 0.276, Loss_aux 0.076, Train_accy 93.86: 100%|██████████| 20/20 [52:12<00:00, 156.60s/it]2024-09-12 18:57:41,659 [der.py] => Task 12, Epoch 20/20 => Loss 0.352, Loss_clf 0.276, Loss_aux 0.076, Train_accy 93.86
2024-09-12 18:57:41,660 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 19:03:56,652 [der.py] => Exemplar size: 2600
2024-09-12 19:03:56,653 [trainer.py] => CNN: {'total': 86.15, '00-09': 75.42, '10-19': 85.27, '20-29': 94.85, '30-39': 73.64, '40-49': 87.85, '50-59': 85.59, '60-69': 81.13, '70-79': 85.82, '80-89': 93.23, '90-99': 83.82, '100-109': 91.3, '110-119': 92.04, '120-129': 90.65, 'old': 85.81, 'new': 90.65}
2024-09-12 19:03:56,665 [trainer.py] => NME: {'total': 88.31, '00-09': 83.05, '10-19': 85.27, '20-29': 96.91, '30-39': 85.45, '40-49': 90.65, '50-59': 89.19, '60-69': 83.96, '70-79': 85.82, '80-89': 92.48, '90-99': 91.18, '100-109': 92.17, '110-119': 87.61, '120-129': 85.05, 'old': 88.56, 'new': 85.05}
2024-09-12 19:03:56,679 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15]
2024-09-12 19:03:56,679 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57]
2024-09-12 19:03:56,679 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31]
2024-09-12 19:03:56,679 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82]

Average Accuracy (CNN): 92.07
Average Accuracy (NME): 93.09
2024-09-12 19:03:56,679 [trainer.py] => Average Accuracy (CNN): 92.07
2024-09-12 19:03:56,679 [trainer.py] => Average Accuracy (NME): 93.09
2024-09-12 19:03:56,690 [trainer.py] => All params: 1116689037
2024-09-12 19:03:56,699 [trainer.py] => Trainable params: 87105165
2024-09-12 19:04:01,455 [der.py] => Learning on 130-140
2024-09-12 19:04:01,496 [der.py] => All params: 1202695063
2024-09-12 19:04:01,503 [der.py] => Trainable params: 87312535

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.410, Loss_clf 0.798, Loss_aux 0.612, Train_accy 87.60, Test_accy 85.92:   0%|          | 0/20 [03:59<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.410, Loss_clf 0.798, Loss_aux 0.612, Train_accy 87.60, Test_accy 85.92:   5%|▌         | 1/20 [03:59<1:15:59, 239.96s/it]
Task 13, Epoch 2/20 => Loss 0.520, Loss_clf 0.356, Loss_aux 0.164, Train_accy 91.18:   5%|▌         | 1/20 [06:28<1:15:59, 239.96s/it]                 
Task 13, Epoch 2/20 => Loss 0.520, Loss_clf 0.356, Loss_aux 0.164, Train_accy 91.18:  10%|█         | 2/20 [06:28<55:50, 186.15s/it]  
Task 13, Epoch 3/20 => Loss 0.405, Loss_clf 0.285, Loss_aux 0.121, Train_accy 92.51:  10%|█         | 2/20 [09:03<55:50, 186.15s/it]
Task 13, Epoch 3/20 => Loss 0.405, Loss_clf 0.285, Loss_aux 0.121, Train_accy 92.51:  15%|█▌        | 3/20 [09:03<48:39, 171.75s/it]
Task 13, Epoch 4/20 => Loss 0.369, Loss_clf 0.263, Loss_aux 0.106, Train_accy 92.90:  15%|█▌        | 3/20 [11:37<48:39, 171.75s/it]
Task 13, Epoch 4/20 => Loss 0.369, Loss_clf 0.263, Loss_aux 0.106, Train_accy 92.90:  20%|██        | 4/20 [11:37<43:57, 164.85s/it]
Task 13, Epoch 5/20 => Loss 0.362, Loss_clf 0.250, Loss_aux 0.112, Train_accy 93.39:  20%|██        | 4/20 [14:11<43:57, 164.85s/it]
Task 13, Epoch 5/20 => Loss 0.362, Loss_clf 0.250, Loss_aux 0.112, Train_accy 93.39:  25%|██▌       | 5/20 [14:11<40:17, 161.17s/it]
Task 13, Epoch 6/20 => Loss 0.368, Loss_clf 0.257, Loss_aux 0.111, Train_accy 93.16, Test_accy 87.14:  25%|██▌       | 5/20 [18:05<40:17, 161.17s/it]
Task 13, Epoch 6/20 => Loss 0.368, Loss_clf 0.257, Loss_aux 0.111, Train_accy 93.16, Test_accy 87.14:  30%|███       | 6/20 [18:05<43:22, 185.89s/it]
Task 13, Epoch 7/20 => Loss 0.321, Loss_clf 0.239, Loss_aux 0.082, Train_accy 93.98:  30%|███       | 6/20 [20:46<43:22, 185.89s/it]                 
Task 13, Epoch 7/20 => Loss 0.321, Loss_clf 0.239, Loss_aux 0.082, Train_accy 93.98:  35%|███▌      | 7/20 [20:46<38:27, 177.52s/it]
Task 13, Epoch 8/20 => Loss 0.356, Loss_clf 0.256, Loss_aux 0.100, Train_accy 93.20:  35%|███▌      | 7/20 [23:20<38:27, 177.52s/it]
Task 13, Epoch 8/20 => Loss 0.356, Loss_clf 0.256, Loss_aux 0.100, Train_accy 93.20:  40%|████      | 8/20 [23:20<34:01, 170.16s/it]
Task 13, Epoch 9/20 => Loss 0.336, Loss_clf 0.243, Loss_aux 0.093, Train_accy 93.42:  40%|████      | 8/20 [25:39<34:01, 170.16s/it]
Task 13, Epoch 9/20 => Loss 0.336, Loss_clf 0.243, Loss_aux 0.093, Train_accy 93.42:  45%|████▌     | 9/20 [25:39<29:25, 160.53s/it]
Task 13, Epoch 10/20 => Loss 0.362, Loss_clf 0.271, Loss_aux 0.091, Train_accy 92.64:  45%|████▌     | 9/20 [28:14<29:25, 160.53s/it]
Task 13, Epoch 10/20 => Loss 0.362, Loss_clf 0.271, Loss_aux 0.091, Train_accy 92.64:  50%|█████     | 10/20 [28:14<26:27, 158.73s/it]
Task 13, Epoch 11/20 => Loss 0.319, Loss_clf 0.239, Loss_aux 0.080, Train_accy 93.82, Test_accy 87.14:  50%|█████     | 10/20 [32:02<26:27, 158.73s/it]
Task 13, Epoch 11/20 => Loss 0.319, Loss_clf 0.239, Loss_aux 0.080, Train_accy 93.82, Test_accy 87.14:  55%|█████▌    | 11/20 [32:02<26:59, 179.99s/it]
Task 13, Epoch 12/20 => Loss 0.280, Loss_clf 0.206, Loss_aux 0.074, Train_accy 94.34:  55%|█████▌    | 11/20 [34:37<26:59, 179.99s/it]                 
Task 13, Epoch 12/20 => Loss 0.280, Loss_clf 0.206, Loss_aux 0.074, Train_accy 94.34:  60%|██████    | 12/20 [34:37<22:58, 172.34s/it]
Task 13, Epoch 13/20 => Loss 0.272, Loss_clf 0.207, Loss_aux 0.065, Train_accy 94.56:  60%|██████    | 12/20 [37:12<22:58, 172.34s/it]
Task 13, Epoch 13/20 => Loss 0.272, Loss_clf 0.207, Loss_aux 0.065, Train_accy 94.56:  65%|██████▌   | 13/20 [37:12<19:28, 166.97s/it]
Task 13, Epoch 14/20 => Loss 0.267, Loss_clf 0.207, Loss_aux 0.060, Train_accy 94.43:  65%|██████▌   | 13/20 [39:46<19:28, 166.97s/it]
Task 13, Epoch 14/20 => Loss 0.267, Loss_clf 0.207, Loss_aux 0.060, Train_accy 94.43:  70%|███████   | 14/20 [39:46<16:19, 163.23s/it]
Task 13, Epoch 15/20 => Loss 0.302, Loss_clf 0.232, Loss_aux 0.069, Train_accy 93.95:  70%|███████   | 14/20 [42:21<16:19, 163.23s/it]
Task 13, Epoch 15/20 => Loss 0.302, Loss_clf 0.232, Loss_aux 0.069, Train_accy 93.95:  75%|███████▌  | 15/20 [42:21<13:23, 160.72s/it]
Task 13, Epoch 16/20 => Loss 0.329, Loss_clf 0.253, Loss_aux 0.076, Train_accy 93.59, Test_accy 87.57:  75%|███████▌  | 15/20 [45:54<13:23, 160.72s/it]
Task 13, Epoch 16/20 => Loss 0.329, Loss_clf 0.253, Loss_aux 0.076, Train_accy 93.59, Test_accy 87.57:  80%|████████  | 16/20 [45:54<11:46, 176.53s/it]
Task 13, Epoch 17/20 => Loss 0.317, Loss_clf 0.234, Loss_aux 0.083, Train_accy 93.75:  80%|████████  | 16/20 [48:26<11:46, 176.53s/it]                 
Task 13, Epoch 17/20 => Loss 0.317, Loss_clf 0.234, Loss_aux 0.083, Train_accy 93.75:  85%|████████▌ | 17/20 [48:26<08:27, 169.08s/it]
Task 13, Epoch 18/20 => Loss 0.287, Loss_clf 0.224, Loss_aux 0.063, Train_accy 94.47:  85%|████████▌ | 17/20 [51:01<08:27, 169.08s/it]
Task 13, Epoch 18/20 => Loss 0.287, Loss_clf 0.224, Loss_aux 0.063, Train_accy 94.47:  90%|█████████ | 18/20 [51:01<05:29, 164.64s/it]
Task 13, Epoch 19/20 => Loss 0.262, Loss_clf 0.198, Loss_aux 0.065, Train_accy 94.63:  90%|█████████ | 18/20 [53:32<05:29, 164.64s/it]
Task 13, Epoch 19/20 => Loss 0.262, Loss_clf 0.198, Loss_aux 0.065, Train_accy 94.63:  95%|█████████▌| 19/20 [53:32<02:40, 160.56s/it]
Task 13, Epoch 20/20 => Loss 0.257, Loss_clf 0.195, Loss_aux 0.062, Train_accy 94.17:  95%|█████████▌| 19/20 [56:05<02:40, 160.56s/it]
Task 13, Epoch 20/20 => Loss 0.257, Loss_clf 0.195, Loss_aux 0.062, Train_accy 94.17: 100%|██████████| 20/20 [56:05<00:00, 158.50s/it]
Task 13, Epoch 20/20 => Loss 0.257, Loss_clf 0.195, Loss_aux 0.062, Train_accy 94.17: 100%|██████████| 20/20 [56:05<00:00, 168.29s/it]2024-09-12 20:00:07,432 [der.py] => Task 13, Epoch 20/20 => Loss 0.257, Loss_clf 0.195, Loss_aux 0.062, Train_accy 94.17
2024-09-12 20:00:07,445 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 20:06:15,841 [der.py] => Exemplar size: 2800
2024-09-12 20:06:15,841 [trainer.py] => CNN: {'total': 88.06, '00-09': 85.59, '10-19': 85.27, '20-29': 94.85, '30-39': 75.45, '40-49': 89.72, '50-59': 81.98, '60-69': 82.08, '70-79': 87.23, '80-89': 92.48, '90-99': 86.03, '100-109': 93.04, '110-119': 92.92, '120-129': 89.72, '130-139': 96.61, 'old': 87.39, 'new': 96.61}
2024-09-12 20:06:15,841 [trainer.py] => NME: {'total': 88.06, '00-09': 83.9, '10-19': 85.27, '20-29': 96.91, '30-39': 86.36, '40-49': 90.65, '50-59': 88.29, '60-69': 83.96, '70-79': 85.11, '80-89': 91.73, '90-99': 90.44, '100-109': 91.3, '110-119': 88.5, '120-129': 83.18, '130-139': 88.14, 'old': 88.05, 'new': 88.14}
2024-09-12 20:06:15,841 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15, 88.06]
2024-09-12 20:06:15,841 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57, 97.75]
2024-09-12 20:06:15,842 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31, 88.06]
2024-09-12 20:06:15,842 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82, 98.48]

Average Accuracy (CNN): 91.78
Average Accuracy (NME): 92.74
2024-09-12 20:06:15,842 [trainer.py] => Average Accuracy (CNN): 91.78
2024-09-12 20:06:15,842 [trainer.py] => Average Accuracy (NME): 92.74
2024-09-12 20:06:15,850 [trainer.py] => All params: 1202695063
2024-09-12 20:06:15,857 [trainer.py] => Trainable params: 87312535
2024-09-12 20:06:32,212 [der.py] => Learning on 140-150
2024-09-12 20:06:32,232 [der.py] => All params: 1288716449
2024-09-12 20:06:32,239 [der.py] => Trainable params: 87535265

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.440, Loss_clf 0.794, Loss_aux 0.646, Train_accy 87.08, Test_accy 86.76:   0%|          | 0/20 [03:41<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.440, Loss_clf 0.794, Loss_aux 0.646, Train_accy 87.08, Test_accy 86.76:   5%|▌         | 1/20 [03:41<1:10:00, 221.08s/it]
Task 14, Epoch 2/20 => Loss 0.516, Loss_clf 0.303, Loss_aux 0.214, Train_accy 92.04:   5%|▌         | 1/20 [06:07<1:10:00, 221.08s/it]                 
Task 14, Epoch 2/20 => Loss 0.516, Loss_clf 0.303, Loss_aux 0.214, Train_accy 92.04:  10%|█         | 2/20 [06:07<53:10, 177.26s/it]  
Task 14, Epoch 3/20 => Loss 0.412, Loss_clf 0.271, Loss_aux 0.141, Train_accy 92.68:  10%|█         | 2/20 [08:33<53:10, 177.26s/it]
Task 14, Epoch 3/20 => Loss 0.412, Loss_clf 0.271, Loss_aux 0.141, Train_accy 92.68:  15%|█▌        | 3/20 [08:33<46:11, 163.02s/it]
Task 14, Epoch 4/20 => Loss 0.368, Loss_clf 0.234, Loss_aux 0.134, Train_accy 93.94:  15%|█▌        | 3/20 [11:00<46:11, 163.02s/it]
Task 14, Epoch 4/20 => Loss 0.368, Loss_clf 0.234, Loss_aux 0.134, Train_accy 93.94:  20%|██        | 4/20 [11:00<41:46, 156.67s/it]
Task 14, Epoch 5/20 => Loss 0.391, Loss_clf 0.276, Loss_aux 0.115, Train_accy 92.71:  20%|██        | 4/20 [13:27<41:46, 156.67s/it]
Task 14, Epoch 5/20 => Loss 0.391, Loss_clf 0.276, Loss_aux 0.115, Train_accy 92.71:  25%|██▌       | 5/20 [13:27<38:17, 153.20s/it]
Task 14, Epoch 6/20 => Loss 0.365, Loss_clf 0.252, Loss_aux 0.113, Train_accy 92.99, Test_accy 86.08:  25%|██▌       | 5/20 [17:05<38:17, 153.20s/it]
Task 14, Epoch 6/20 => Loss 0.365, Loss_clf 0.252, Loss_aux 0.113, Train_accy 92.99, Test_accy 86.08:  30%|███       | 6/20 [17:05<40:54, 175.29s/it]
Task 14, Epoch 7/20 => Loss 0.357, Loss_clf 0.257, Loss_aux 0.100, Train_accy 93.70:  30%|███       | 6/20 [19:33<40:54, 175.29s/it]                 
Task 14, Epoch 7/20 => Loss 0.357, Loss_clf 0.257, Loss_aux 0.100, Train_accy 93.70:  35%|███▌      | 7/20 [19:33<35:59, 166.09s/it]
Task 14, Epoch 8/20 => Loss 0.316, Loss_clf 0.225, Loss_aux 0.091, Train_accy 93.60:  35%|███▌      | 7/20 [22:00<35:59, 166.09s/it]
Task 14, Epoch 8/20 => Loss 0.316, Loss_clf 0.225, Loss_aux 0.091, Train_accy 93.60:  40%|████      | 8/20 [22:00<32:00, 160.08s/it]
Task 14, Epoch 9/20 => Loss 0.350, Loss_clf 0.254, Loss_aux 0.096, Train_accy 93.30:  40%|████      | 8/20 [24:27<32:00, 160.08s/it]
Task 14, Epoch 9/20 => Loss 0.350, Loss_clf 0.254, Loss_aux 0.096, Train_accy 93.30:  45%|████▌     | 9/20 [24:27<28:36, 156.01s/it]
Task 14, Epoch 10/20 => Loss 0.327, Loss_clf 0.241, Loss_aux 0.087, Train_accy 93.79:  45%|████▌     | 9/20 [26:54<28:36, 156.01s/it]
Task 14, Epoch 10/20 => Loss 0.327, Loss_clf 0.241, Loss_aux 0.087, Train_accy 93.79:  50%|█████     | 10/20 [26:54<25:31, 153.19s/it]
Task 14, Epoch 11/20 => Loss 0.257, Loss_clf 0.189, Loss_aux 0.068, Train_accy 94.86, Test_accy 86.76:  50%|█████     | 10/20 [30:33<25:31, 153.19s/it]
Task 14, Epoch 11/20 => Loss 0.257, Loss_clf 0.189, Loss_aux 0.068, Train_accy 94.86, Test_accy 86.76:  55%|█████▌    | 11/20 [30:33<25:59, 173.29s/it]
Task 14, Epoch 12/20 => Loss 0.344, Loss_clf 0.255, Loss_aux 0.088, Train_accy 93.17:  55%|█████▌    | 11/20 [33:00<25:59, 173.29s/it]                 
Task 14, Epoch 12/20 => Loss 0.344, Loss_clf 0.255, Loss_aux 0.088, Train_accy 93.17:  60%|██████    | 12/20 [33:00<22:02, 165.31s/it]
Task 14, Epoch 13/20 => Loss 0.313, Loss_clf 0.230, Loss_aux 0.083, Train_accy 93.85:  60%|██████    | 12/20 [35:27<22:02, 165.31s/it]
Task 14, Epoch 13/20 => Loss 0.313, Loss_clf 0.230, Loss_aux 0.083, Train_accy 93.85:  65%|██████▌   | 13/20 [35:27<18:38, 159.76s/it]
Task 14, Epoch 14/20 => Loss 0.327, Loss_clf 0.243, Loss_aux 0.084, Train_accy 93.88:  65%|██████▌   | 13/20 [37:54<18:38, 159.76s/it]
Task 14, Epoch 14/20 => Loss 0.327, Loss_clf 0.243, Loss_aux 0.084, Train_accy 93.88:  70%|███████   | 14/20 [37:54<15:35, 155.93s/it]
Task 14, Epoch 15/20 => Loss 0.312, Loss_clf 0.242, Loss_aux 0.069, Train_accy 93.76:  70%|███████   | 14/20 [40:21<15:35, 155.93s/it]
Task 14, Epoch 15/20 => Loss 0.312, Loss_clf 0.242, Loss_aux 0.069, Train_accy 93.76:  75%|███████▌  | 15/20 [40:21<12:46, 153.22s/it]
Task 14, Epoch 16/20 => Loss 0.239, Loss_clf 0.178, Loss_aux 0.062, Train_accy 94.99, Test_accy 87.66:  75%|███████▌  | 15/20 [43:59<12:46, 153.22s/it]
Task 14, Epoch 16/20 => Loss 0.239, Loss_clf 0.178, Loss_aux 0.062, Train_accy 94.99, Test_accy 87.66:  80%|████████  | 16/20 [43:59<11:31, 172.95s/it]
Task 14, Epoch 17/20 => Loss 0.277, Loss_clf 0.213, Loss_aux 0.064, Train_accy 94.34:  80%|████████  | 16/20 [46:26<11:31, 172.95s/it]                 
Task 14, Epoch 17/20 => Loss 0.277, Loss_clf 0.213, Loss_aux 0.064, Train_accy 94.34:  85%|████████▌ | 17/20 [46:26<08:15, 165.10s/it]
Task 14, Epoch 18/20 => Loss 0.284, Loss_clf 0.220, Loss_aux 0.063, Train_accy 93.97:  85%|████████▌ | 17/20 [48:53<08:15, 165.10s/it]
Task 14, Epoch 18/20 => Loss 0.284, Loss_clf 0.220, Loss_aux 0.063, Train_accy 93.97:  90%|█████████ | 18/20 [48:53<05:19, 159.63s/it]
Task 14, Epoch 19/20 => Loss 0.298, Loss_clf 0.225, Loss_aux 0.073, Train_accy 94.19:  90%|█████████ | 18/20 [51:20<05:19, 159.63s/it]
Task 14, Epoch 19/20 => Loss 0.298, Loss_clf 0.225, Loss_aux 0.073, Train_accy 94.19:  95%|█████████▌| 19/20 [51:20<02:35, 155.80s/it]
Task 14, Epoch 20/20 => Loss 0.270, Loss_clf 0.208, Loss_aux 0.062, Train_accy 94.65:  95%|█████████▌| 19/20 [53:47<02:35, 155.80s/it]
Task 14, Epoch 20/20 => Loss 0.270, Loss_clf 0.208, Loss_aux 0.062, Train_accy 94.65: 100%|██████████| 20/20 [53:47<00:00, 153.12s/it]
Task 14, Epoch 20/20 => Loss 0.270, Loss_clf 0.208, Loss_aux 0.062, Train_accy 94.65: 100%|██████████| 20/20 [53:47<00:00, 161.37s/it]2024-09-12 21:00:19,726 [der.py] => Task 14, Epoch 20/20 => Loss 0.270, Loss_clf 0.208, Loss_aux 0.062, Train_accy 94.65
2024-09-12 21:00:19,727 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 21:06:26,874 [der.py] => Exemplar size: 3000
2024-09-12 21:06:26,874 [trainer.py] => CNN: {'total': 87.72, '00-09': 78.81, '10-19': 87.6, '20-29': 91.75, '30-39': 78.18, '40-49': 89.72, '50-59': 85.59, '60-69': 83.02, '70-79': 90.07, '80-89': 89.47, '90-99': 90.44, '100-109': 93.91, '110-119': 85.84, '120-129': 85.98, '130-139': 88.98, '140-149': 94.44, 'old': 87.2, 'new': 94.44}
2024-09-12 21:06:26,874 [trainer.py] => NME: {'total': 87.38, '00-09': 83.9, '10-19': 85.27, '20-29': 96.91, '30-39': 83.64, '40-49': 88.79, '50-59': 88.29, '60-69': 83.02, '70-79': 85.11, '80-89': 91.73, '90-99': 89.71, '100-109': 91.3, '110-119': 87.61, '120-129': 84.11, '130-139': 87.29, '140-149': 84.92, 'old': 87.57, 'new': 84.92}
2024-09-12 21:06:26,874 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15, 88.06, 87.72]
2024-09-12 21:06:26,874 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57, 97.75, 97.45]
2024-09-12 21:06:26,874 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31, 88.06, 87.38]
2024-09-12 21:06:26,874 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82, 98.48, 98.42]

Average Accuracy (CNN): 91.51
Average Accuracy (NME): 92.38
2024-09-12 21:06:26,875 [trainer.py] => Average Accuracy (CNN): 91.51
2024-09-12 21:06:26,875 [trainer.py] => Average Accuracy (NME): 92.38
2024-09-12 21:06:26,883 [trainer.py] => All params: 1288716449
2024-09-12 21:06:26,891 [trainer.py] => Trainable params: 87535265
2024-09-12 21:06:28,589 [der.py] => Learning on 150-160
2024-09-12 21:06:28,605 [der.py] => All params: 1374753195
2024-09-12 21:06:28,612 [der.py] => Trainable params: 87773355

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.375, Loss_clf 0.718, Loss_aux 0.657, Train_accy 87.89, Test_accy 83.87:   0%|          | 0/20 [04:11<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.375, Loss_clf 0.718, Loss_aux 0.657, Train_accy 87.89, Test_accy 83.87:   5%|▌         | 1/20 [04:11<1:19:43, 251.78s/it]
Task 15, Epoch 2/20 => Loss 0.473, Loss_clf 0.291, Loss_aux 0.182, Train_accy 92.07:   5%|▌         | 1/20 [07:09<1:19:43, 251.78s/it]                 
Task 15, Epoch 2/20 => Loss 0.473, Loss_clf 0.291, Loss_aux 0.182, Train_accy 92.07:  10%|█         | 2/20 [07:09<1:02:28, 208.24s/it]
Task 15, Epoch 3/20 => Loss 0.429, Loss_clf 0.295, Loss_aux 0.134, Train_accy 91.90:  10%|█         | 2/20 [10:01<1:02:28, 208.24s/it]
Task 15, Epoch 3/20 => Loss 0.429, Loss_clf 0.295, Loss_aux 0.134, Train_accy 91.90:  15%|█▌        | 3/20 [10:01<54:16, 191.56s/it]  
Task 15, Epoch 4/20 => Loss 0.400, Loss_clf 0.278, Loss_aux 0.122, Train_accy 92.68:  15%|█▌        | 3/20 [12:47<54:16, 191.56s/it]
Task 15, Epoch 4/20 => Loss 0.400, Loss_clf 0.278, Loss_aux 0.122, Train_accy 92.68:  20%|██        | 4/20 [12:47<48:25, 181.57s/it]
Task 15, Epoch 5/20 => Loss 0.353, Loss_clf 0.254, Loss_aux 0.099, Train_accy 93.25:  20%|██        | 4/20 [15:33<48:25, 181.57s/it]
Task 15, Epoch 5/20 => Loss 0.353, Loss_clf 0.254, Loss_aux 0.099, Train_accy 93.25:  25%|██▌       | 5/20 [15:33<43:59, 175.97s/it]
Task 15, Epoch 6/20 => Loss 0.327, Loss_clf 0.238, Loss_aux 0.089, Train_accy 93.74, Test_accy 86.94:  25%|██▌       | 5/20 [19:41<43:59, 175.97s/it]
Task 15, Epoch 6/20 => Loss 0.327, Loss_clf 0.238, Loss_aux 0.089, Train_accy 93.74, Test_accy 86.94:  30%|███       | 6/20 [19:41<46:46, 200.44s/it]
Task 15, Epoch 7/20 => Loss 0.330, Loss_clf 0.243, Loss_aux 0.088, Train_accy 93.92:  30%|███       | 6/20 [22:27<46:46, 200.44s/it]                 
Task 15, Epoch 7/20 => Loss 0.330, Loss_clf 0.243, Loss_aux 0.088, Train_accy 93.92:  35%|███▌      | 7/20 [22:27<40:59, 189.21s/it]
Task 15, Epoch 8/20 => Loss 0.306, Loss_clf 0.229, Loss_aux 0.077, Train_accy 93.86:  35%|███▌      | 7/20 [25:13<40:59, 189.21s/it]
Task 15, Epoch 8/20 => Loss 0.306, Loss_clf 0.229, Loss_aux 0.077, Train_accy 93.86:  40%|████      | 8/20 [25:13<36:21, 181.81s/it]
Task 15, Epoch 9/20 => Loss 0.331, Loss_clf 0.252, Loss_aux 0.079, Train_accy 92.99:  40%|████      | 8/20 [27:59<36:21, 181.81s/it]
Task 15, Epoch 9/20 => Loss 0.331, Loss_clf 0.252, Loss_aux 0.079, Train_accy 92.99:  45%|████▌     | 9/20 [27:59<32:25, 176.85s/it]
Task 15, Epoch 10/20 => Loss 0.309, Loss_clf 0.239, Loss_aux 0.070, Train_accy 93.77:  45%|████▌     | 9/20 [30:45<32:25, 176.85s/it]
Task 15, Epoch 10/20 => Loss 0.309, Loss_clf 0.239, Loss_aux 0.070, Train_accy 93.77:  50%|█████     | 10/20 [30:45<28:54, 173.49s/it]
Task 15, Epoch 11/20 => Loss 0.318, Loss_clf 0.244, Loss_aux 0.074, Train_accy 93.86, Test_accy 85.77:  50%|█████     | 10/20 [34:53<28:54, 173.49s/it]
Task 15, Epoch 11/20 => Loss 0.318, Loss_clf 0.244, Loss_aux 0.074, Train_accy 93.86, Test_accy 85.77:  55%|█████▌    | 11/20 [34:53<29:26, 196.24s/it]
Task 15, Epoch 12/20 => Loss 0.306, Loss_clf 0.245, Loss_aux 0.061, Train_accy 93.97:  55%|█████▌    | 11/20 [37:39<29:26, 196.24s/it]                 
Task 15, Epoch 12/20 => Loss 0.306, Loss_clf 0.245, Loss_aux 0.061, Train_accy 93.97:  60%|██████    | 12/20 [37:39<24:56, 187.04s/it]
Task 15, Epoch 13/20 => Loss 0.295, Loss_clf 0.232, Loss_aux 0.063, Train_accy 93.80:  60%|██████    | 12/20 [40:25<24:56, 187.04s/it]
Task 15, Epoch 13/20 => Loss 0.295, Loss_clf 0.232, Loss_aux 0.063, Train_accy 93.80:  65%|██████▌   | 13/20 [40:25<21:04, 180.64s/it]
Task 15, Epoch 14/20 => Loss 0.286, Loss_clf 0.229, Loss_aux 0.058, Train_accy 93.83:  65%|██████▌   | 13/20 [43:11<21:04, 180.64s/it]
Task 15, Epoch 14/20 => Loss 0.286, Loss_clf 0.229, Loss_aux 0.058, Train_accy 93.83:  70%|███████   | 14/20 [43:11<17:37, 176.21s/it]
Task 15, Epoch 15/20 => Loss 0.280, Loss_clf 0.215, Loss_aux 0.064, Train_accy 94.32:  70%|███████   | 14/20 [45:56<17:37, 176.21s/it]
Task 15, Epoch 15/20 => Loss 0.280, Loss_clf 0.215, Loss_aux 0.064, Train_accy 94.32:  75%|███████▌  | 15/20 [45:56<14:25, 173.06s/it]
Task 15, Epoch 16/20 => Loss 0.269, Loss_clf 0.204, Loss_aux 0.065, Train_accy 94.38, Test_accy 86.73:  75%|███████▌  | 15/20 [50:05<14:25, 173.06s/it]
Task 15, Epoch 16/20 => Loss 0.269, Loss_clf 0.204, Loss_aux 0.065, Train_accy 94.38, Test_accy 86.73:  80%|████████  | 16/20 [50:05<13:02, 195.64s/it]
Task 15, Epoch 17/20 => Loss 0.302, Loss_clf 0.234, Loss_aux 0.068, Train_accy 94.09:  80%|████████  | 16/20 [52:51<13:02, 195.64s/it]                 
Task 15, Epoch 17/20 => Loss 0.302, Loss_clf 0.234, Loss_aux 0.068, Train_accy 94.09:  85%|████████▌ | 17/20 [52:51<09:20, 186.75s/it]
Task 15, Epoch 18/20 => Loss 0.285, Loss_clf 0.224, Loss_aux 0.062, Train_accy 94.09:  85%|████████▌ | 17/20 [55:37<09:20, 186.75s/it]
Task 15, Epoch 18/20 => Loss 0.285, Loss_clf 0.224, Loss_aux 0.062, Train_accy 94.09:  90%|█████████ | 18/20 [55:37<06:01, 180.52s/it]
Task 15, Epoch 19/20 => Loss 0.290, Loss_clf 0.236, Loss_aux 0.054, Train_accy 93.51:  90%|█████████ | 18/20 [58:23<06:01, 180.52s/it]
Task 15, Epoch 19/20 => Loss 0.290, Loss_clf 0.236, Loss_aux 0.054, Train_accy 93.51:  95%|█████████▌| 19/20 [58:23<02:56, 176.13s/it]
Task 15, Epoch 20/20 => Loss 0.285, Loss_clf 0.223, Loss_aux 0.062, Train_accy 94.09:  95%|█████████▌| 19/20 [1:01:09<02:56, 176.13s/it]
Task 15, Epoch 20/20 => Loss 0.285, Loss_clf 0.223, Loss_aux 0.062, Train_accy 94.09: 100%|██████████| 20/20 [1:01:09<00:00, 173.09s/it]
Task 15, Epoch 20/20 => Loss 0.285, Loss_clf 0.223, Loss_aux 0.062, Train_accy 94.09: 100%|██████████| 20/20 [1:01:09<00:00, 183.45s/it]2024-09-12 22:07:37,731 [der.py] => Task 15, Epoch 20/20 => Loss 0.285, Loss_clf 0.223, Loss_aux 0.062, Train_accy 94.09
2024-09-12 22:07:37,731 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 22:14:38,486 [der.py] => Exemplar size: 3200
2024-09-12 22:14:38,486 [trainer.py] => CNN: {'total': 87.04, '00-09': 77.97, '10-19': 86.05, '20-29': 93.81, '30-39': 80.91, '40-49': 88.79, '50-59': 84.68, '60-69': 81.13, '70-79': 87.23, '80-89': 87.22, '90-99': 84.56, '100-109': 87.83, '110-119': 89.38, '120-129': 85.98, '130-139': 88.14, '140-149': 94.44, '150-159': 94.35, 'old': 86.53, 'new': 94.35}
2024-09-12 22:14:38,486 [trainer.py] => NME: {'total': 87.73, '00-09': 83.9, '10-19': 86.05, '20-29': 95.88, '30-39': 84.55, '40-49': 88.79, '50-59': 87.39, '60-69': 83.02, '70-79': 83.69, '80-89': 90.98, '90-99': 90.44, '100-109': 89.57, '110-119': 88.5, '120-129': 85.05, '130-139': 87.29, '140-149': 88.1, '150-159': 91.13, 'old': 87.49, 'new': 91.13}
2024-09-12 22:14:38,486 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15, 88.06, 87.72, 87.04]
2024-09-12 22:14:38,486 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57, 97.75, 97.45, 97.46]
2024-09-12 22:14:38,486 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31, 88.06, 87.38, 87.73]
2024-09-12 22:14:38,486 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82, 98.48, 98.42, 98.47]

Average Accuracy (CNN): 91.23
Average Accuracy (NME): 92.09
2024-09-12 22:14:38,486 [trainer.py] => Average Accuracy (CNN): 91.23
2024-09-12 22:14:38,487 [trainer.py] => Average Accuracy (NME): 92.09
2024-09-12 22:14:38,496 [trainer.py] => All params: 1374753195
2024-09-12 22:14:38,504 [trainer.py] => Trainable params: 87773355
2024-09-12 22:14:40,560 [der.py] => Learning on 160-170
2024-09-12 22:14:40,591 [der.py] => All params: 1460805301
2024-09-12 22:14:40,603 [der.py] => Trainable params: 88026805

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.068, Loss_clf 0.668, Loss_aux 0.400, Train_accy 88.54, Test_accy 85.73:   0%|          | 0/20 [04:37<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.068, Loss_clf 0.668, Loss_aux 0.400, Train_accy 88.54, Test_accy 85.73:   5%|▌         | 1/20 [04:37<1:27:59, 277.87s/it]
Task 16, Epoch 2/20 => Loss 0.444, Loss_clf 0.303, Loss_aux 0.142, Train_accy 92.33:   5%|▌         | 1/20 [07:43<1:27:59, 277.87s/it]                 
Task 16, Epoch 2/20 => Loss 0.444, Loss_clf 0.303, Loss_aux 0.142, Train_accy 92.33:  10%|█         | 2/20 [07:43<1:07:00, 223.37s/it]
Task 16, Epoch 3/20 => Loss 0.388, Loss_clf 0.277, Loss_aux 0.111, Train_accy 92.93:  10%|█         | 2/20 [10:48<1:07:00, 223.37s/it]
Task 16, Epoch 3/20 => Loss 0.388, Loss_clf 0.277, Loss_aux 0.111, Train_accy 92.93:  15%|█▌        | 3/20 [10:48<58:21, 205.98s/it]  
Task 16, Epoch 4/20 => Loss 0.410, Loss_clf 0.299, Loss_aux 0.111, Train_accy 92.63:  15%|█▌        | 3/20 [13:53<58:21, 205.98s/it]
Task 16, Epoch 4/20 => Loss 0.410, Loss_clf 0.299, Loss_aux 0.111, Train_accy 92.63:  20%|██        | 4/20 [13:53<52:45, 197.83s/it]
Task 16, Epoch 5/20 => Loss 0.360, Loss_clf 0.274, Loss_aux 0.086, Train_accy 93.40:  20%|██        | 4/20 [16:58<52:45, 197.83s/it]
Task 16, Epoch 5/20 => Loss 0.360, Loss_clf 0.274, Loss_aux 0.086, Train_accy 93.40:  25%|██▌       | 5/20 [16:58<48:18, 193.24s/it]
Task 16, Epoch 6/20 => Loss 0.379, Loss_clf 0.289, Loss_aux 0.090, Train_accy 92.36, Test_accy 85.43:  25%|██▌       | 5/20 [21:36<48:18, 193.24s/it]
Task 16, Epoch 6/20 => Loss 0.379, Loss_clf 0.289, Loss_aux 0.090, Train_accy 92.36, Test_accy 85.43:  30%|███       | 6/20 [21:36<51:49, 222.09s/it]
Task 16, Epoch 7/20 => Loss 0.339, Loss_clf 0.266, Loss_aux 0.073, Train_accy 92.88:  30%|███       | 6/20 [24:42<51:49, 222.09s/it]                 
Task 16, Epoch 7/20 => Loss 0.339, Loss_clf 0.266, Loss_aux 0.073, Train_accy 92.88:  35%|███▌      | 7/20 [24:42<45:30, 210.03s/it]
Task 16, Epoch 8/20 => Loss 0.312, Loss_clf 0.237, Loss_aux 0.074, Train_accy 93.40:  35%|███▌      | 7/20 [27:47<45:30, 210.03s/it]
Task 16, Epoch 8/20 => Loss 0.312, Loss_clf 0.237, Loss_aux 0.074, Train_accy 93.40:  40%|████      | 8/20 [27:47<40:24, 202.05s/it]
Task 16, Epoch 9/20 => Loss 0.277, Loss_clf 0.211, Loss_aux 0.065, Train_accy 94.49:  40%|████      | 8/20 [30:52<40:24, 202.05s/it]
Task 16, Epoch 9/20 => Loss 0.277, Loss_clf 0.211, Loss_aux 0.065, Train_accy 94.49:  45%|████▌     | 9/20 [30:52<36:03, 196.71s/it]
Task 16, Epoch 10/20 => Loss 0.318, Loss_clf 0.245, Loss_aux 0.073, Train_accy 93.64:  45%|████▌     | 9/20 [33:56<36:03, 196.71s/it]
Task 16, Epoch 10/20 => Loss 0.318, Loss_clf 0.245, Loss_aux 0.073, Train_accy 93.64:  50%|█████     | 10/20 [33:56<32:10, 193.05s/it]
Task 16, Epoch 11/20 => Loss 0.309, Loss_clf 0.235, Loss_aux 0.074, Train_accy 93.56, Test_accy 86.52:  50%|█████     | 10/20 [38:35<32:10, 193.05s/it]
Task 16, Epoch 11/20 => Loss 0.309, Loss_clf 0.235, Loss_aux 0.074, Train_accy 93.56, Test_accy 86.52:  55%|█████▌    | 11/20 [38:35<32:52, 219.12s/it]
Task 16, Epoch 12/20 => Loss 0.283, Loss_clf 0.211, Loss_aux 0.072, Train_accy 94.24:  55%|█████▌    | 11/20 [41:40<32:52, 219.12s/it]                 
Task 16, Epoch 12/20 => Loss 0.283, Loss_clf 0.211, Loss_aux 0.072, Train_accy 94.24:  60%|██████    | 12/20 [41:40<27:50, 208.75s/it]
Task 16, Epoch 13/20 => Loss 0.286, Loss_clf 0.224, Loss_aux 0.062, Train_accy 94.32:  60%|██████    | 12/20 [44:45<27:50, 208.75s/it]
Task 16, Epoch 13/20 => Loss 0.286, Loss_clf 0.224, Loss_aux 0.062, Train_accy 94.32:  65%|██████▌   | 13/20 [44:45<23:30, 201.52s/it]
Task 16, Epoch 14/20 => Loss 0.288, Loss_clf 0.231, Loss_aux 0.057, Train_accy 93.89:  65%|██████▌   | 13/20 [47:49<23:30, 201.52s/it]
Task 16, Epoch 14/20 => Loss 0.288, Loss_clf 0.231, Loss_aux 0.057, Train_accy 93.89:  70%|███████   | 14/20 [47:49<19:38, 196.50s/it]
Task 16, Epoch 15/20 => Loss 0.279, Loss_clf 0.222, Loss_aux 0.056, Train_accy 93.91:  70%|███████   | 14/20 [50:54<19:38, 196.50s/it]
Task 16, Epoch 15/20 => Loss 0.279, Loss_clf 0.222, Loss_aux 0.056, Train_accy 93.91:  75%|███████▌  | 15/20 [50:54<16:05, 193.03s/it]
Task 16, Epoch 16/20 => Loss 0.289, Loss_clf 0.230, Loss_aux 0.058, Train_accy 94.24, Test_accy 85.83:  75%|███████▌  | 15/20 [55:33<16:05, 193.03s/it]
Task 16, Epoch 16/20 => Loss 0.289, Loss_clf 0.230, Loss_aux 0.058, Train_accy 94.24, Test_accy 85.83:  80%|████████  | 16/20 [55:33<14:35, 218.86s/it]
Task 16, Epoch 17/20 => Loss 0.232, Loss_clf 0.189, Loss_aux 0.043, Train_accy 94.60:  80%|████████  | 16/20 [58:38<14:35, 218.86s/it]                 
Task 16, Epoch 17/20 => Loss 0.232, Loss_clf 0.189, Loss_aux 0.043, Train_accy 94.60:  85%|████████▌ | 17/20 [58:38<10:26, 208.72s/it]
Task 16, Epoch 18/20 => Loss 0.290, Loss_clf 0.222, Loss_aux 0.068, Train_accy 93.89:  85%|████████▌ | 17/20 [1:01:44<10:26, 208.72s/it]
Task 16, Epoch 18/20 => Loss 0.290, Loss_clf 0.222, Loss_aux 0.068, Train_accy 93.89:  90%|█████████ | 18/20 [1:01:44<06:43, 201.67s/it]
Task 16, Epoch 19/20 => Loss 0.278, Loss_clf 0.219, Loss_aux 0.059, Train_accy 94.38:  90%|█████████ | 18/20 [1:04:49<06:43, 201.67s/it]
Task 16, Epoch 19/20 => Loss 0.278, Loss_clf 0.219, Loss_aux 0.059, Train_accy 94.38:  95%|█████████▌| 19/20 [1:04:49<03:16, 196.82s/it]
Task 16, Epoch 20/20 => Loss 0.261, Loss_clf 0.215, Loss_aux 0.046, Train_accy 94.81:  95%|█████████▌| 19/20 [1:07:54<03:16, 196.82s/it]
Task 16, Epoch 20/20 => Loss 0.261, Loss_clf 0.215, Loss_aux 0.046, Train_accy 94.81: 100%|██████████| 20/20 [1:07:54<00:00, 193.31s/it]
Task 16, Epoch 20/20 => Loss 0.261, Loss_clf 0.215, Loss_aux 0.046, Train_accy 94.81: 100%|██████████| 20/20 [1:07:54<00:00, 203.74s/it]2024-09-12 23:22:35,550 [der.py] => Task 16, Epoch 20/20 => Loss 0.261, Loss_clf 0.215, Loss_aux 0.046, Train_accy 94.81
2024-09-12 23:22:35,552 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-12 23:30:25,960 [der.py] => Exemplar size: 3400
2024-09-12 23:30:25,960 [trainer.py] => CNN: {'total': 86.37, '00-09': 79.66, '10-19': 86.82, '20-29': 89.69, '30-39': 81.82, '40-49': 86.92, '50-59': 83.78, '60-69': 77.36, '70-79': 82.98, '80-89': 88.72, '90-99': 84.56, '100-109': 89.57, '110-119': 89.38, '120-129': 85.05, '130-139': 90.68, '140-149': 84.92, '150-159': 91.94, '160-169': 93.28, 'old': 85.88, 'new': 93.28}
2024-09-12 23:30:25,960 [trainer.py] => NME: {'total': 87.46, '00-09': 83.9, '10-19': 86.82, '20-29': 94.85, '30-39': 84.55, '40-49': 88.79, '50-59': 88.29, '60-69': 83.02, '70-79': 83.69, '80-89': 90.23, '90-99': 88.24, '100-109': 90.43, '110-119': 89.38, '120-129': 85.05, '130-139': 88.14, '140-149': 84.92, '150-159': 91.13, '160-169': 86.57, 'old': 87.52, 'new': 86.57}
2024-09-12 23:30:25,960 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15, 88.06, 87.72, 87.04, 86.37]
2024-09-12 23:30:25,960 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57, 97.75, 97.45, 97.46, 97.23]
2024-09-12 23:30:25,960 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31, 88.06, 87.38, 87.73, 87.46]
2024-09-12 23:30:25,960 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82, 98.48, 98.42, 98.47, 98.32]

Average Accuracy (CNN): 90.94
Average Accuracy (NME): 91.82
2024-09-12 23:30:25,960 [trainer.py] => Average Accuracy (CNN): 90.94
2024-09-12 23:30:25,961 [trainer.py] => Average Accuracy (NME): 91.82
2024-09-12 23:30:25,971 [trainer.py] => All params: 1460805301
2024-09-12 23:30:25,979 [trainer.py] => Trainable params: 88026805
2024-09-12 23:30:28,132 [der.py] => Learning on 170-180
2024-09-12 23:30:28,152 [der.py] => All params: 1546872767
2024-09-12 23:30:28,160 [der.py] => Trainable params: 88295615

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.179, Loss_clf 0.635, Loss_aux 0.544, Train_accy 89.06, Test_accy 84.40:   0%|          | 0/20 [05:09<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.179, Loss_clf 0.635, Loss_aux 0.544, Train_accy 89.06, Test_accy 84.40:   5%|▌         | 1/20 [05:09<1:38:08, 309.93s/it]
Task 17, Epoch 2/20 => Loss 0.481, Loss_clf 0.306, Loss_aux 0.176, Train_accy 91.45:   5%|▌         | 1/20 [08:36<1:38:08, 309.93s/it]                 
Task 17, Epoch 2/20 => Loss 0.481, Loss_clf 0.306, Loss_aux 0.176, Train_accy 91.45:  10%|█         | 2/20 [08:36<1:14:49, 249.42s/it]
Task 17, Epoch 3/20 => Loss 0.417, Loss_clf 0.281, Loss_aux 0.136, Train_accy 92.60:  10%|█         | 2/20 [12:03<1:14:49, 249.42s/it]
Task 17, Epoch 3/20 => Loss 0.417, Loss_clf 0.281, Loss_aux 0.136, Train_accy 92.60:  15%|█▌        | 3/20 [12:03<1:05:09, 229.94s/it]
Task 17, Epoch 4/20 => Loss 0.399, Loss_clf 0.296, Loss_aux 0.102, Train_accy 92.01:  15%|█▌        | 3/20 [15:30<1:05:09, 229.94s/it]
Task 17, Epoch 4/20 => Loss 0.399, Loss_clf 0.296, Loss_aux 0.102, Train_accy 92.01:  20%|██        | 4/20 [15:30<58:54, 220.94s/it]  
Task 17, Epoch 5/20 => Loss 0.327, Loss_clf 0.237, Loss_aux 0.090, Train_accy 93.58:  20%|██        | 4/20 [18:57<58:54, 220.94s/it]
Task 17, Epoch 5/20 => Loss 0.327, Loss_clf 0.237, Loss_aux 0.090, Train_accy 93.58:  25%|██▌       | 5/20 [18:57<53:58, 215.93s/it]
Task 17, Epoch 6/20 => Loss 0.343, Loss_clf 0.252, Loss_aux 0.092, Train_accy 93.58, Test_accy 85.10:  25%|██▌       | 5/20 [24:08<53:58, 215.93s/it]
Task 17, Epoch 6/20 => Loss 0.343, Loss_clf 0.252, Loss_aux 0.092, Train_accy 93.58, Test_accy 85.10:  30%|███       | 6/20 [24:08<57:51, 248.00s/it]
Task 17, Epoch 7/20 => Loss 0.357, Loss_clf 0.262, Loss_aux 0.095, Train_accy 93.55:  30%|███       | 6/20 [27:34<57:51, 248.00s/it]                 
Task 17, Epoch 7/20 => Loss 0.357, Loss_clf 0.262, Loss_aux 0.095, Train_accy 93.55:  35%|███▌      | 7/20 [27:34<50:48, 234.53s/it]
Task 17, Epoch 8/20 => Loss 0.403, Loss_clf 0.321, Loss_aux 0.083, Train_accy 92.96:  35%|███▌      | 7/20 [31:01<50:48, 234.53s/it]
Task 17, Epoch 8/20 => Loss 0.403, Loss_clf 0.321, Loss_aux 0.083, Train_accy 92.96:  40%|████      | 8/20 [31:01<45:08, 225.72s/it]
Task 17, Epoch 9/20 => Loss 0.381, Loss_clf 0.282, Loss_aux 0.099, Train_accy 92.96:  40%|████      | 8/20 [34:28<45:08, 225.72s/it]
Task 17, Epoch 9/20 => Loss 0.381, Loss_clf 0.282, Loss_aux 0.099, Train_accy 92.96:  45%|████▌     | 9/20 [34:28<40:18, 219.85s/it]
Task 17, Epoch 10/20 => Loss 0.296, Loss_clf 0.223, Loss_aux 0.072, Train_accy 93.79:  45%|████▌     | 9/20 [37:55<40:18, 219.85s/it]
Task 17, Epoch 10/20 => Loss 0.296, Loss_clf 0.223, Loss_aux 0.072, Train_accy 93.79:  50%|█████     | 10/20 [37:55<35:58, 215.80s/it]
Task 17, Epoch 11/20 => Loss 0.336, Loss_clf 0.250, Loss_aux 0.086, Train_accy 93.97, Test_accy 85.06:  50%|█████     | 10/20 [43:05<35:58, 215.80s/it]
Task 17, Epoch 11/20 => Loss 0.336, Loss_clf 0.250, Loss_aux 0.086, Train_accy 93.97, Test_accy 85.06:  55%|█████▌    | 11/20 [43:05<36:42, 244.77s/it]
Task 17, Epoch 12/20 => Loss 0.295, Loss_clf 0.229, Loss_aux 0.066, Train_accy 94.40:  55%|█████▌    | 11/20 [46:32<36:42, 244.77s/it]                 
Task 17, Epoch 12/20 => Loss 0.295, Loss_clf 0.229, Loss_aux 0.066, Train_accy 94.40:  60%|██████    | 12/20 [46:32<31:06, 233.28s/it]
Task 17, Epoch 13/20 => Loss 0.284, Loss_clf 0.219, Loss_aux 0.065, Train_accy 94.35:  60%|██████    | 12/20 [50:00<31:06, 233.28s/it]
Task 17, Epoch 13/20 => Loss 0.284, Loss_clf 0.219, Loss_aux 0.065, Train_accy 94.35:  65%|██████▌   | 13/20 [50:00<26:18, 225.44s/it]
Task 17, Epoch 14/20 => Loss 0.363, Loss_clf 0.256, Loss_aux 0.107, Train_accy 93.40:  65%|██████▌   | 13/20 [53:27<26:18, 225.44s/it]
Task 17, Epoch 14/20 => Loss 0.363, Loss_clf 0.256, Loss_aux 0.107, Train_accy 93.40:  70%|███████   | 14/20 [53:27<21:58, 219.82s/it]
Task 17, Epoch 15/20 => Loss 0.284, Loss_clf 0.211, Loss_aux 0.073, Train_accy 94.81:  70%|███████   | 14/20 [56:54<21:58, 219.82s/it]
Task 17, Epoch 15/20 => Loss 0.284, Loss_clf 0.211, Loss_aux 0.073, Train_accy 94.81:  75%|███████▌  | 15/20 [56:54<17:59, 215.91s/it]
Task 17, Epoch 16/20 => Loss 0.320, Loss_clf 0.251, Loss_aux 0.069, Train_accy 93.50, Test_accy 86.09:  75%|███████▌  | 15/20 [1:02:04<17:59, 215.91s/it]
Task 17, Epoch 16/20 => Loss 0.320, Loss_clf 0.251, Loss_aux 0.069, Train_accy 93.50, Test_accy 86.09:  80%|████████  | 16/20 [1:02:04<16:17, 244.40s/it]
Task 17, Epoch 17/20 => Loss 0.301, Loss_clf 0.237, Loss_aux 0.064, Train_accy 93.91:  80%|████████  | 16/20 [1:05:31<16:17, 244.40s/it]                 
Task 17, Epoch 17/20 => Loss 0.301, Loss_clf 0.237, Loss_aux 0.064, Train_accy 93.91:  85%|████████▌ | 17/20 [1:05:31<11:39, 233.16s/it]
Task 17, Epoch 18/20 => Loss 0.274, Loss_clf 0.215, Loss_aux 0.060, Train_accy 94.38:  85%|████████▌ | 17/20 [1:08:58<11:39, 233.16s/it]
Task 17, Epoch 18/20 => Loss 0.274, Loss_clf 0.215, Loss_aux 0.060, Train_accy 94.38:  90%|█████████ | 18/20 [1:08:58<07:30, 225.28s/it]
Task 17, Epoch 19/20 => Loss 0.321, Loss_clf 0.259, Loss_aux 0.062, Train_accy 93.40:  90%|█████████ | 18/20 [1:12:25<07:30, 225.28s/it]
Task 17, Epoch 19/20 => Loss 0.321, Loss_clf 0.259, Loss_aux 0.062, Train_accy 93.40:  95%|█████████▌| 19/20 [1:12:25<03:39, 219.73s/it]
Task 17, Epoch 20/20 => Loss 0.278, Loss_clf 0.215, Loss_aux 0.063, Train_accy 94.63:  95%|█████████▌| 19/20 [1:15:52<03:39, 219.73s/it]
Task 17, Epoch 20/20 => Loss 0.278, Loss_clf 0.215, Loss_aux 0.063, Train_accy 94.63: 100%|██████████| 20/20 [1:15:52<00:00, 215.87s/it]
Task 17, Epoch 20/20 => Loss 0.278, Loss_clf 0.215, Loss_aux 0.063, Train_accy 94.63: 100%|██████████| 20/20 [1:15:52<00:00, 227.61s/it]2024-09-13 00:46:20,509 [der.py] => Task 17, Epoch 20/20 => Loss 0.278, Loss_clf 0.215, Loss_aux 0.063, Train_accy 94.63
2024-09-13 00:46:20,511 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 00:55:03,078 [der.py] => Exemplar size: 3600
2024-09-13 00:55:03,079 [trainer.py] => CNN: {'total': 86.28, '00-09': 77.97, '10-19': 82.17, '20-29': 89.69, '30-39': 80.0, '40-49': 89.72, '50-59': 80.18, '60-69': 78.3, '70-79': 87.23, '80-89': 87.97, '90-99': 86.03, '100-109': 93.04, '110-119': 85.84, '120-129': 81.31, '130-139': 88.98, '140-149': 84.92, '150-159': 92.74, '160-169': 91.04, '170-179': 95.15, 'old': 85.83, 'new': 95.15}
2024-09-13 00:55:03,079 [trainer.py] => NME: {'total': 86.94, '00-09': 83.05, '10-19': 85.27, '20-29': 94.85, '30-39': 84.55, '40-49': 88.79, '50-59': 88.29, '60-69': 82.08, '70-79': 83.69, '80-89': 90.23, '90-99': 87.5, '100-109': 90.43, '110-119': 86.73, '120-129': 80.37, '130-139': 88.14, '140-149': 85.71, '150-159': 92.74, '160-169': 88.06, '170-179': 84.47, 'old': 87.06, 'new': 84.47}
2024-09-13 00:55:03,079 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15, 88.06, 87.72, 87.04, 86.37, 86.28]
2024-09-13 00:55:03,079 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57, 97.75, 97.45, 97.46, 97.23, 96.8]
2024-09-13 00:55:03,079 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31, 88.06, 87.38, 87.73, 87.46, 86.94]
2024-09-13 00:55:03,079 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82, 98.48, 98.42, 98.47, 98.32, 98.21]

Average Accuracy (CNN): 90.68
Average Accuracy (NME): 91.54
2024-09-13 00:55:03,079 [trainer.py] => Average Accuracy (CNN): 90.68
2024-09-13 00:55:03,079 [trainer.py] => Average Accuracy (NME): 91.54
2024-09-13 00:55:03,090 [trainer.py] => All params: 1546872767
2024-09-13 00:55:03,099 [trainer.py] => Trainable params: 88295615
2024-09-13 00:55:04,931 [der.py] => Learning on 180-190
2024-09-13 00:55:04,968 [der.py] => All params: 1632955593
2024-09-13 00:55:04,977 [der.py] => Trainable params: 88579785

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.223, Loss_clf 0.660, Loss_aux 0.563, Train_accy 88.51, Test_accy 82.48:   0%|          | 0/20 [05:41<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.223, Loss_clf 0.660, Loss_aux 0.563, Train_accy 88.51, Test_accy 82.48:   5%|▌         | 1/20 [05:41<1:48:16, 341.91s/it]
Task 18, Epoch 2/20 => Loss 0.478, Loss_clf 0.307, Loss_aux 0.172, Train_accy 92.53:   5%|▌         | 1/20 [09:28<1:48:16, 341.91s/it]                 
Task 18, Epoch 2/20 => Loss 0.478, Loss_clf 0.307, Loss_aux 0.172, Train_accy 92.53:  10%|█         | 2/20 [09:28<1:22:14, 274.13s/it]
Task 18, Epoch 3/20 => Loss 0.428, Loss_clf 0.294, Loss_aux 0.134, Train_accy 92.65:  10%|█         | 2/20 [13:14<1:22:14, 274.13s/it]
Task 18, Epoch 3/20 => Loss 0.428, Loss_clf 0.294, Loss_aux 0.134, Train_accy 92.65:  15%|█▌        | 3/20 [13:14<1:11:27, 252.22s/it]
Task 18, Epoch 4/20 => Loss 0.395, Loss_clf 0.282, Loss_aux 0.114, Train_accy 92.75:  15%|█▌        | 3/20 [17:00<1:11:27, 252.22s/it]
Task 18, Epoch 4/20 => Loss 0.395, Loss_clf 0.282, Loss_aux 0.114, Train_accy 92.75:  20%|██        | 4/20 [17:00<1:04:31, 241.95s/it]
Task 18, Epoch 5/20 => Loss 0.352, Loss_clf 0.251, Loss_aux 0.101, Train_accy 93.19:  20%|██        | 4/20 [20:47<1:04:31, 241.95s/it]
Task 18, Epoch 5/20 => Loss 0.352, Loss_clf 0.251, Loss_aux 0.101, Train_accy 93.19:  25%|██▌       | 5/20 [20:47<59:03, 236.25s/it]  
Task 18, Epoch 6/20 => Loss 0.384, Loss_clf 0.287, Loss_aux 0.097, Train_accy 92.63, Test_accy 83.89:  25%|██▌       | 5/20 [26:29<59:03, 236.25s/it]
Task 18, Epoch 6/20 => Loss 0.384, Loss_clf 0.287, Loss_aux 0.097, Train_accy 92.63, Test_accy 83.89:  30%|███       | 6/20 [26:29<1:03:31, 272.28s/it]
Task 18, Epoch 7/20 => Loss 0.334, Loss_clf 0.243, Loss_aux 0.090, Train_accy 93.91:  30%|███       | 6/20 [30:15<1:03:31, 272.28s/it]                 
Task 18, Epoch 7/20 => Loss 0.334, Loss_clf 0.243, Loss_aux 0.090, Train_accy 93.91:  35%|███▌      | 7/20 [30:15<55:44, 257.30s/it]  
Task 18, Epoch 8/20 => Loss 0.351, Loss_clf 0.269, Loss_aux 0.083, Train_accy 93.29:  35%|███▌      | 7/20 [34:01<55:44, 257.30s/it]
Task 18, Epoch 8/20 => Loss 0.351, Loss_clf 0.269, Loss_aux 0.083, Train_accy 93.29:  40%|████      | 8/20 [34:01<49:28, 247.39s/it]
Task 18, Epoch 9/20 => Loss 0.300, Loss_clf 0.227, Loss_aux 0.073, Train_accy 94.11:  40%|████      | 8/20 [37:48<49:28, 247.39s/it]
Task 18, Epoch 9/20 => Loss 0.300, Loss_clf 0.227, Loss_aux 0.073, Train_accy 94.11:  45%|████▌     | 9/20 [37:48<44:08, 240.73s/it]
Task 18, Epoch 10/20 => Loss 0.297, Loss_clf 0.227, Loss_aux 0.069, Train_accy 94.03:  45%|████▌     | 9/20 [41:34<44:08, 240.73s/it]
Task 18, Epoch 10/20 => Loss 0.297, Loss_clf 0.227, Loss_aux 0.069, Train_accy 94.03:  50%|█████     | 10/20 [41:34<39:22, 236.24s/it]
Task 18, Epoch 11/20 => Loss 0.321, Loss_clf 0.247, Loss_aux 0.074, Train_accy 93.51, Test_accy 84.38:  50%|█████     | 10/20 [47:16<39:22, 236.24s/it]
Task 18, Epoch 11/20 => Loss 0.321, Loss_clf 0.247, Loss_aux 0.074, Train_accy 93.51, Test_accy 84.38:  55%|█████▌    | 11/20 [47:16<40:18, 268.70s/it]
Task 18, Epoch 12/20 => Loss 0.277, Loss_clf 0.209, Loss_aux 0.069, Train_accy 94.92:  55%|█████▌    | 11/20 [51:02<40:18, 268.70s/it]                 
Task 18, Epoch 12/20 => Loss 0.277, Loss_clf 0.209, Loss_aux 0.069, Train_accy 94.92:  60%|██████    | 12/20 [51:02<34:06, 255.76s/it]
Task 18, Epoch 13/20 => Loss 0.320, Loss_clf 0.250, Loss_aux 0.069, Train_accy 93.54:  60%|██████    | 12/20 [54:48<34:06, 255.76s/it]
Task 18, Epoch 13/20 => Loss 0.320, Loss_clf 0.250, Loss_aux 0.069, Train_accy 93.54:  65%|██████▌   | 13/20 [54:48<28:47, 246.82s/it]
Task 18, Epoch 14/20 => Loss 0.287, Loss_clf 0.227, Loss_aux 0.060, Train_accy 94.20:  65%|██████▌   | 13/20 [58:35<28:47, 246.82s/it]
Task 18, Epoch 14/20 => Loss 0.287, Loss_clf 0.227, Loss_aux 0.060, Train_accy 94.20:  70%|███████   | 14/20 [58:35<24:03, 240.58s/it]
Task 18, Epoch 15/20 => Loss 0.285, Loss_clf 0.228, Loss_aux 0.057, Train_accy 94.08:  70%|███████   | 14/20 [1:02:21<24:03, 240.58s/it]
Task 18, Epoch 15/20 => Loss 0.285, Loss_clf 0.228, Loss_aux 0.057, Train_accy 94.08:  75%|███████▌  | 15/20 [1:02:21<19:41, 236.33s/it]
Task 18, Epoch 16/20 => Loss 0.269, Loss_clf 0.223, Loss_aux 0.046, Train_accy 94.03, Test_accy 84.82:  75%|███████▌  | 15/20 [1:08:03<19:41, 236.33s/it]
Task 18, Epoch 16/20 => Loss 0.269, Loss_clf 0.223, Loss_aux 0.046, Train_accy 94.03, Test_accy 84.82:  80%|████████  | 16/20 [1:08:03<17:52, 268.22s/it]
Task 18, Epoch 17/20 => Loss 0.286, Loss_clf 0.227, Loss_aux 0.059, Train_accy 94.11:  80%|████████  | 16/20 [1:11:50<17:52, 268.22s/it]                 
Task 18, Epoch 17/20 => Loss 0.286, Loss_clf 0.227, Loss_aux 0.059, Train_accy 94.11:  85%|████████▌ | 17/20 [1:11:50<12:46, 255.63s/it]
Task 18, Epoch 18/20 => Loss 0.298, Loss_clf 0.232, Loss_aux 0.065, Train_accy 93.93:  85%|████████▌ | 17/20 [1:15:36<12:46, 255.63s/it]
Task 18, Epoch 18/20 => Loss 0.298, Loss_clf 0.232, Loss_aux 0.065, Train_accy 93.93:  90%|█████████ | 18/20 [1:15:36<08:13, 246.77s/it]
Task 18, Epoch 19/20 => Loss 0.272, Loss_clf 0.214, Loss_aux 0.059, Train_accy 94.60:  90%|█████████ | 18/20 [1:19:22<08:13, 246.77s/it]
Task 18, Epoch 19/20 => Loss 0.272, Loss_clf 0.214, Loss_aux 0.059, Train_accy 94.60:  95%|█████████▌| 19/20 [1:19:22<04:00, 240.58s/it]
Task 18, Epoch 20/20 => Loss 0.276, Loss_clf 0.226, Loss_aux 0.050, Train_accy 94.33:  95%|█████████▌| 19/20 [1:23:08<04:00, 240.58s/it]
Task 18, Epoch 20/20 => Loss 0.276, Loss_clf 0.226, Loss_aux 0.050, Train_accy 94.33: 100%|██████████| 20/20 [1:23:08<00:00, 236.23s/it]
Task 18, Epoch 20/20 => Loss 0.276, Loss_clf 0.226, Loss_aux 0.050, Train_accy 94.33: 100%|██████████| 20/20 [1:23:08<00:00, 249.43s/it]2024-09-13 02:18:13,711 [der.py] => Task 18, Epoch 20/20 => Loss 0.276, Loss_clf 0.226, Loss_aux 0.050, Train_accy 94.33
2024-09-13 02:18:13,713 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 02:27:56,226 [der.py] => Exemplar size: 3800
2024-09-13 02:27:56,226 [trainer.py] => CNN: {'total': 84.56, '00-09': 81.36, '10-19': 84.5, '20-29': 90.72, '30-39': 77.27, '40-49': 84.11, '50-59': 82.88, '60-69': 78.3, '70-79': 83.69, '80-89': 84.96, '90-99': 78.68, '100-109': 87.83, '110-119': 85.84, '120-129': 79.44, '130-139': 81.36, '140-149': 80.95, '150-159': 92.74, '160-169': 91.04, '170-179': 91.26, '180-189': 89.39, 'old': 84.26, 'new': 89.39}
2024-09-13 02:27:56,226 [trainer.py] => NME: {'total': 86.46, '00-09': 83.05, '10-19': 85.27, '20-29': 93.81, '30-39': 84.55, '40-49': 86.92, '50-59': 87.39, '60-69': 82.08, '70-79': 83.69, '80-89': 90.23, '90-99': 88.24, '100-109': 90.43, '110-119': 86.73, '120-129': 79.44, '130-139': 85.59, '140-149': 86.51, '150-159': 92.74, '160-169': 87.31, '170-179': 84.47, '180-189': 84.09, 'old': 86.61, 'new': 84.09}
2024-09-13 02:27:56,227 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15, 88.06, 87.72, 87.04, 86.37, 86.28, 84.56]
2024-09-13 02:27:56,227 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57, 97.75, 97.45, 97.46, 97.23, 96.8, 97.12]
2024-09-13 02:27:56,227 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31, 88.06, 87.38, 87.73, 87.46, 86.94, 86.46]
2024-09-13 02:27:56,227 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82, 98.48, 98.42, 98.47, 98.32, 98.21, 97.7]

Average Accuracy (CNN): 90.36
Average Accuracy (NME): 91.28
2024-09-13 02:27:56,227 [trainer.py] => Average Accuracy (CNN): 90.36
2024-09-13 02:27:56,227 [trainer.py] => Average Accuracy (NME): 91.28
2024-09-13 02:27:56,241 [trainer.py] => All params: 1632955593
2024-09-13 02:27:56,251 [trainer.py] => Trainable params: 88579785
2024-09-13 02:27:58,786 [der.py] => Learning on 190-200
2024-09-13 02:27:58,813 [der.py] => All params: 1719053779
2024-09-13 02:27:58,822 [der.py] => Trainable params: 88879315

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.209, Loss_clf 0.661, Loss_aux 0.548, Train_accy 88.90, Test_accy 83.12:   0%|          | 0/20 [06:17<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.209, Loss_clf 0.661, Loss_aux 0.548, Train_accy 88.90, Test_accy 83.12:   5%|▌         | 1/20 [06:17<1:59:38, 377.84s/it]
Task 19, Epoch 2/20 => Loss 0.444, Loss_clf 0.269, Loss_aux 0.175, Train_accy 93.13:   5%|▌         | 1/20 [10:28<1:59:38, 377.84s/it]                 
Task 19, Epoch 2/20 => Loss 0.444, Loss_clf 0.269, Loss_aux 0.175, Train_accy 93.13:  10%|█         | 2/20 [10:28<1:30:59, 303.30s/it]
Task 19, Epoch 3/20 => Loss 0.408, Loss_clf 0.276, Loss_aux 0.132, Train_accy 92.90:  10%|█         | 2/20 [14:40<1:30:59, 303.30s/it]
Task 19, Epoch 3/20 => Loss 0.408, Loss_clf 0.276, Loss_aux 0.132, Train_accy 92.90:  15%|█▌        | 3/20 [14:40<1:19:11, 279.52s/it]
Task 19, Epoch 4/20 => Loss 0.364, Loss_clf 0.254, Loss_aux 0.110, Train_accy 93.48:  15%|█▌        | 3/20 [18:51<1:19:11, 279.52s/it]
Task 19, Epoch 4/20 => Loss 0.364, Loss_clf 0.254, Loss_aux 0.110, Train_accy 93.48:  20%|██        | 4/20 [18:51<1:11:34, 268.38s/it]
Task 19, Epoch 5/20 => Loss 0.365, Loss_clf 0.264, Loss_aux 0.101, Train_accy 92.95:  20%|██        | 4/20 [23:02<1:11:34, 268.38s/it]
Task 19, Epoch 5/20 => Loss 0.365, Loss_clf 0.264, Loss_aux 0.101, Train_accy 92.95:  25%|██▌       | 5/20 [23:02<1:05:32, 262.17s/it]
Task 19, Epoch 6/20 => Loss 0.353, Loss_clf 0.260, Loss_aux 0.092, Train_accy 93.27, Test_accy 85.16:  25%|██▌       | 5/20 [29:20<1:05:32, 262.17s/it]
Task 19, Epoch 6/20 => Loss 0.353, Loss_clf 0.260, Loss_aux 0.092, Train_accy 93.27, Test_accy 85.16:  30%|███       | 6/20 [29:20<1:10:21, 301.56s/it]
Task 19, Epoch 7/20 => Loss 0.350, Loss_clf 0.254, Loss_aux 0.096, Train_accy 93.51:  30%|███       | 6/20 [33:31<1:10:21, 301.56s/it]                 
Task 19, Epoch 7/20 => Loss 0.350, Loss_clf 0.254, Loss_aux 0.096, Train_accy 93.51:  35%|███▌      | 7/20 [33:31<1:01:45, 285.05s/it]
Task 19, Epoch 8/20 => Loss 0.330, Loss_clf 0.244, Loss_aux 0.086, Train_accy 93.60:  35%|███▌      | 7/20 [37:42<1:01:45, 285.05s/it]
Task 19, Epoch 8/20 => Loss 0.330, Loss_clf 0.244, Loss_aux 0.086, Train_accy 93.60:  40%|████      | 8/20 [37:42<54:49, 274.16s/it]  
Task 19, Epoch 9/20 => Loss 0.298, Loss_clf 0.231, Loss_aux 0.067, Train_accy 94.09:  40%|████      | 8/20 [41:53<54:49, 274.16s/it]
Task 19, Epoch 9/20 => Loss 0.298, Loss_clf 0.231, Loss_aux 0.067, Train_accy 94.09:  45%|████▌     | 9/20 [41:53<48:56, 266.92s/it]
Task 19, Epoch 10/20 => Loss 0.330, Loss_clf 0.246, Loss_aux 0.084, Train_accy 93.37:  45%|████▌     | 9/20 [46:04<48:56, 266.92s/it]
Task 19, Epoch 10/20 => Loss 0.330, Loss_clf 0.246, Loss_aux 0.084, Train_accy 93.37:  50%|█████     | 10/20 [46:04<43:39, 261.99s/it]
Task 19, Epoch 11/20 => Loss 0.277, Loss_clf 0.209, Loss_aux 0.068, Train_accy 94.97, Test_accy 84.90:  50%|█████     | 10/20 [52:22<43:39, 261.99s/it]
Task 19, Epoch 11/20 => Loss 0.277, Loss_clf 0.209, Loss_aux 0.068, Train_accy 94.97, Test_accy 84.90:  55%|█████▌    | 11/20 [52:22<44:38, 297.64s/it]
Task 19, Epoch 12/20 => Loss 0.283, Loss_clf 0.218, Loss_aux 0.064, Train_accy 94.37:  55%|█████▌    | 11/20 [56:34<44:38, 297.64s/it]                 
Task 19, Epoch 12/20 => Loss 0.283, Loss_clf 0.218, Loss_aux 0.064, Train_accy 94.37:  60%|██████    | 12/20 [56:34<37:47, 283.46s/it]
Task 19, Epoch 13/20 => Loss 0.301, Loss_clf 0.242, Loss_aux 0.058, Train_accy 93.93:  60%|██████    | 12/20 [1:00:45<37:47, 283.46s/it]
Task 19, Epoch 13/20 => Loss 0.301, Loss_clf 0.242, Loss_aux 0.058, Train_accy 93.93:  65%|██████▌   | 13/20 [1:00:45<31:55, 273.64s/it]
Task 19, Epoch 14/20 => Loss 0.274, Loss_clf 0.211, Loss_aux 0.063, Train_accy 94.60:  65%|██████▌   | 13/20 [1:04:55<31:55, 273.64s/it]
Task 19, Epoch 14/20 => Loss 0.274, Loss_clf 0.211, Loss_aux 0.063, Train_accy 94.60:  70%|███████   | 14/20 [1:04:55<26:40, 266.78s/it]
Task 19, Epoch 15/20 => Loss 0.304, Loss_clf 0.245, Loss_aux 0.059, Train_accy 93.53:  70%|███████   | 14/20 [1:09:07<26:40, 266.78s/it]
Task 19, Epoch 15/20 => Loss 0.304, Loss_clf 0.245, Loss_aux 0.059, Train_accy 93.53:  75%|███████▌  | 15/20 [1:09:07<21:50, 262.14s/it]
Task 19, Epoch 16/20 => Loss 0.291, Loss_clf 0.230, Loss_aux 0.061, Train_accy 94.02, Test_accy 85.07:  75%|███████▌  | 15/20 [1:15:25<21:50, 262.14s/it]
Task 19, Epoch 16/20 => Loss 0.291, Loss_clf 0.230, Loss_aux 0.061, Train_accy 94.02, Test_accy 85.07:  80%|████████  | 16/20 [1:15:25<19:48, 297.02s/it]
Task 19, Epoch 17/20 => Loss 0.266, Loss_clf 0.212, Loss_aux 0.053, Train_accy 94.37:  80%|████████  | 16/20 [1:19:36<19:48, 297.02s/it]                 
Task 19, Epoch 17/20 => Loss 0.266, Loss_clf 0.212, Loss_aux 0.053, Train_accy 94.37:  85%|████████▌ | 17/20 [1:19:36<14:09, 283.17s/it]
Task 19, Epoch 18/20 => Loss 0.293, Loss_clf 0.238, Loss_aux 0.055, Train_accy 94.16:  85%|████████▌ | 17/20 [1:23:47<14:09, 283.17s/it]
Task 19, Epoch 18/20 => Loss 0.293, Loss_clf 0.238, Loss_aux 0.055, Train_accy 94.16:  90%|█████████ | 18/20 [1:23:47<09:07, 273.54s/it]
Task 19, Epoch 19/20 => Loss 0.291, Loss_clf 0.222, Loss_aux 0.069, Train_accy 94.81:  90%|█████████ | 18/20 [1:27:58<09:07, 273.54s/it]
Task 19, Epoch 19/20 => Loss 0.291, Loss_clf 0.222, Loss_aux 0.069, Train_accy 94.81:  95%|█████████▌| 19/20 [1:27:58<04:26, 266.89s/it]
Task 19, Epoch 20/20 => Loss 0.271, Loss_clf 0.213, Loss_aux 0.058, Train_accy 94.65:  95%|█████████▌| 19/20 [1:32:09<04:26, 266.89s/it]
Task 19, Epoch 20/20 => Loss 0.271, Loss_clf 0.213, Loss_aux 0.058, Train_accy 94.65: 100%|██████████| 20/20 [1:32:09<00:00, 262.13s/it]
Task 19, Epoch 20/20 => Loss 0.271, Loss_clf 0.213, Loss_aux 0.058, Train_accy 94.65: 100%|██████████| 20/20 [1:32:09<00:00, 276.50s/it]2024-09-13 04:00:08,845 [der.py] => Task 19, Epoch 20/20 => Loss 0.271, Loss_clf 0.213, Loss_aux 0.058, Train_accy 94.65
2024-09-13 04:00:08,847 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 04:10:40,292 [der.py] => Exemplar size: 4000
2024-09-13 04:10:40,292 [trainer.py] => CNN: {'total': 84.99, '00-09': 73.73, '10-19': 80.62, '20-29': 90.72, '30-39': 76.36, '40-49': 87.85, '50-59': 82.88, '60-69': 78.3, '70-79': 84.4, '80-89': 89.47, '90-99': 80.15, '100-109': 85.22, '110-119': 88.5, '120-129': 82.24, '130-139': 83.05, '140-149': 88.1, '150-159': 93.55, '160-169': 88.81, '170-179': 89.32, '180-189': 88.64, '190-199': 87.76, 'old': 84.87, 'new': 87.76}
2024-09-13 04:10:40,292 [trainer.py] => NME: {'total': 86.05, '00-09': 82.2, '10-19': 84.5, '20-29': 93.81, '30-39': 82.73, '40-49': 86.92, '50-59': 88.29, '60-69': 80.19, '70-79': 82.98, '80-89': 89.47, '90-99': 88.24, '100-109': 90.43, '110-119': 86.73, '120-129': 79.44, '130-139': 87.29, '140-149': 85.71, '150-159': 93.55, '160-169': 88.81, '170-179': 81.55, '180-189': 84.85, '190-199': 81.63, 'old': 86.24, 'new': 81.63}
2024-09-13 04:10:40,292 [trainer.py] => CNN top1 curve: [99.15, 97.98, 97.09, 95.59, 92.87, 91.22, 89.72, 90.32, 90.49, 88.89, 89.33, 88.06, 86.15, 88.06, 87.72, 87.04, 86.37, 86.28, 84.56, 84.99]
2024-09-13 04:10:40,292 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.34, 99.11, 98.96, 98.07, 98.04, 98.19, 98.15, 98.0, 97.88, 97.57, 97.75, 97.45, 97.46, 97.23, 96.8, 97.12, 96.65]
2024-09-13 04:10:40,292 [trainer.py] => NME top1 curve: [98.31, 97.98, 97.67, 96.26, 95.54, 93.45, 91.9, 90.86, 90.87, 90.15, 90.02, 88.91, 88.31, 88.06, 87.38, 87.73, 87.46, 86.94, 86.46, 86.05]
2024-09-13 04:10:40,292 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.34, 99.29, 98.96, 98.97, 99.02, 99.14, 98.91, 98.93, 98.73, 98.82, 98.48, 98.42, 98.47, 98.32, 98.21, 97.7, 97.54]

Average Accuracy (CNN): 90.09
Average Accuracy (NME): 91.02
2024-09-13 04:10:40,293 [trainer.py] => Average Accuracy (CNN): 90.09
2024-09-13 04:10:40,293 [trainer.py] => Average Accuracy (NME): 91.02
Accuracy Matrix (CNN):
[[99.15 98.31 96.61 96.61 93.22 84.75 84.75 84.75 83.05 81.36 82.2  83.05
  75.42 85.59 78.81 77.97 79.66 77.97 81.36 73.73]
 [ 0.   97.67 96.9  95.35 93.02 93.02 89.92 89.92 85.27 85.27 88.37 82.17
  85.27 85.27 87.6  86.05 86.82 82.17 84.5  80.62]
 [ 0.    0.   97.94 95.88 93.81 92.78 91.75 94.85 93.81 89.69 89.69 91.75
  94.85 94.85 91.75 93.81 89.69 89.69 90.72 90.72]
 [ 0.    0.    0.   94.55 88.18 90.   82.73 84.55 84.55 78.18 80.91 80.
  73.64 75.45 78.18 80.91 81.82 80.   77.27 76.36]
 [ 0.    0.    0.    0.   96.26 94.39 94.39 93.46 94.39 94.39 94.39 92.52
  87.85 89.72 89.72 88.79 86.92 89.72 84.11 87.85]
 [ 0.    0.    0.    0.    0.   92.79 89.19 90.09 90.99 88.29 88.29 88.29
  85.59 81.98 85.59 84.68 83.78 80.18 82.88 82.88]
 [ 0.    0.    0.    0.    0.    0.   96.23 86.79 87.74 83.96 82.08 84.91
  81.13 82.08 83.02 81.13 77.36 78.3  78.3  78.3 ]
 [ 0.    0.    0.    0.    0.    0.    0.   97.16 96.45 94.33 91.49 84.4
  85.82 87.23 90.07 87.23 82.98 87.23 83.69 84.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   96.99 94.74 93.23 90.23
  93.23 92.48 89.47 87.22 88.72 87.97 84.96 89.47]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   95.59 94.85 93.38
  83.82 86.03 90.44 84.56 84.56 86.03 78.68 80.15]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   94.78 92.17
  91.3  93.04 93.91 87.83 89.57 93.04 87.83 85.22]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   94.69
  92.04 92.92 85.84 89.38 89.38 85.84 85.84 88.5 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  90.65 89.72 85.98 85.98 85.05 81.31 79.44 82.24]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   96.61 88.98 88.14 90.68 88.98 81.36 83.05]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   94.44 94.44 84.92 84.92 80.95 88.1 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   94.35 91.94 92.74 92.74 93.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   93.28 91.04 91.04 88.81]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   95.15 91.26 89.32]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   89.39 88.64]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   87.76]]
2024-09-13 04:10:40,296 [trainer.py] => Forgetting (CNN): 10.303157894736845
Accuracy Matrix (NME):
[[98.31 97.46 96.61 96.61 95.76 87.29 87.29 85.59 84.75 84.75 83.9  83.9
  83.05 83.9  83.9  83.9  83.9  83.05 83.05 82.2 ]
 [ 0.   98.45 98.45 97.67 97.67 96.9  91.47 90.7  89.92 90.7  88.37 86.05
  85.27 85.27 85.27 86.05 86.82 85.27 85.27 84.5 ]
 [ 0.    0.   97.94 96.91 96.91 96.91 94.85 94.85 95.88 95.88 95.88 96.91
  96.91 96.91 96.91 95.88 94.85 94.85 93.81 93.81]
 [ 0.    0.    0.   93.64 91.82 92.73 92.73 91.82 90.   86.36 86.36 85.45
  85.45 86.36 83.64 84.55 84.55 84.55 84.55 82.73]
 [ 0.    0.    0.    0.   95.33 96.26 95.33 94.39 93.46 93.46 93.46 92.52
  90.65 90.65 88.79 88.79 88.79 88.79 86.92 86.92]
 [ 0.    0.    0.    0.    0.   90.99 90.99 89.19 89.19 89.19 89.19 88.29
  89.19 88.29 88.29 87.39 88.29 88.29 87.39 88.29]
 [ 0.    0.    0.    0.    0.    0.   91.51 89.62 87.74 85.85 85.85 84.91
  83.96 83.96 83.02 83.02 83.02 82.08 82.08 80.19]
 [ 0.    0.    0.    0.    0.    0.    0.   91.49 92.2  91.49 90.78 85.82
  85.82 85.11 85.11 83.69 83.69 83.69 83.69 82.98]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   94.74 94.74 93.98 93.23
  92.48 91.73 91.73 90.98 90.23 90.23 90.23 89.47]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   88.97 91.18 91.18
  91.18 90.44 89.71 90.44 88.24 87.5  88.24 88.24]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   91.3  92.17
  92.17 91.3  91.3  89.57 90.43 90.43 90.43 90.43]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   87.61
  87.61 88.5  87.61 88.5  89.38 86.73 86.73 86.73]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  85.05 83.18 84.11 85.05 85.05 80.37 79.44 79.44]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   88.14 87.29 87.29 88.14 88.14 85.59 87.29]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   84.92 88.1  84.92 85.71 86.51 85.71]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   91.13 91.13 92.74 92.74 93.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   86.57 88.06 87.31 88.81]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   84.47 84.47 81.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   84.09 84.85]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   81.63]]
2024-09-13 04:10:40,298 [trainer.py] => Forgetting (NME): 5.371052631578946
2024-09-13 04:10:57,740 [trainer.py] => config: ./exps/der_cub_B100_Inc5.json
2024-09-13 04:10:57,764 [trainer.py] => prefix: reproduce
2024-09-13 04:10:57,764 [trainer.py] => dataset: cub
2024-09-13 04:10:57,764 [trainer.py] => memory_size: 2000
2024-09-13 04:10:57,764 [trainer.py] => memory_per_class: 20
2024-09-13 04:10:57,764 [trainer.py] => fixed_memory: True
2024-09-13 04:10:57,764 [trainer.py] => shuffle: True
2024-09-13 04:10:57,765 [trainer.py] => init_cls: 100
2024-09-13 04:10:57,765 [trainer.py] => increment: 20
2024-09-13 04:10:57,765 [trainer.py] => model_name: der
2024-09-13 04:10:57,765 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-13 04:10:57,765 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 04:10:57,765 [trainer.py] => seed: 1993
2024-09-13 04:10:57,765 [trainer.py] => init_epoch: 20
2024-09-13 04:10:57,765 [trainer.py] => init_lr: 0.001
2024-09-13 04:10:57,765 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-13 04:10:57,766 [trainer.py] => init_lr_decay: 0.1
2024-09-13 04:10:57,766 [trainer.py] => init_weight_decay: 0.0005
2024-09-13 04:10:57,766 [trainer.py] => epochs: 20
2024-09-13 04:10:57,766 [trainer.py] => lrate: 0.001
2024-09-13 04:10:57,766 [trainer.py] => milestones: [80, 120, 150]
2024-09-13 04:10:57,766 [trainer.py] => lrate_decay: 0.1
2024-09-13 04:10:57,766 [trainer.py] => batch_size: 48
2024-09-13 04:10:57,766 [trainer.py] => weight_decay: 0.0002
2024-09-13 04:10:57,766 [trainer.py] => T: 2
2024-09-13 04:10:57,828 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 04:11:03,790 [trainer.py] => All params: 0
2024-09-13 04:11:03,790 [trainer.py] => Trainable params: 0
2024-09-13 04:11:06,468 [der.py] => Learning on 0-100
2024-09-13 04:11:06,469 [der.py] => All params: 85953225
2024-09-13 04:11:06,469 [der.py] => Trainable params: 85953225

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.810, Train_accy 35.60, Test_accy 82.41:   0%|          | 0/20 [00:42<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.810, Train_accy 35.60, Test_accy 82.41:   5%|▌         | 1/20 [00:42<13:19, 42.10s/it]
Task 0, Epoch 2/20 => Loss 0.903, Train_accy 75.35:   5%|▌         | 1/20 [01:18<13:19, 42.10s/it]                 
Task 0, Epoch 2/20 => Loss 0.903, Train_accy 75.35:  10%|█         | 2/20 [01:18<11:33, 38.54s/it]
Task 0, Epoch 3/20 => Loss 0.688, Train_accy 80.57:  10%|█         | 2/20 [01:54<11:33, 38.54s/it]
Task 0, Epoch 3/20 => Loss 0.688, Train_accy 80.57:  15%|█▌        | 3/20 [01:54<10:37, 37.51s/it]
Task 0, Epoch 4/20 => Loss 0.612, Train_accy 83.68:  15%|█▌        | 3/20 [02:30<10:37, 37.51s/it]
Task 0, Epoch 4/20 => Loss 0.612, Train_accy 83.68:  20%|██        | 4/20 [02:30<09:53, 37.07s/it]
Task 0, Epoch 5/20 => Loss 0.540, Train_accy 85.22:  20%|██        | 4/20 [03:07<09:53, 37.07s/it]
Task 0, Epoch 5/20 => Loss 0.540, Train_accy 85.22:  25%|██▌       | 5/20 [03:07<09:13, 36.88s/it]
Task 0, Epoch 6/20 => Loss 0.536, Train_accy 85.79, Test_accy 89.48:  25%|██▌       | 5/20 [03:47<09:13, 36.88s/it]
Task 0, Epoch 6/20 => Loss 0.536, Train_accy 85.79, Test_accy 89.48:  30%|███       | 6/20 [03:47<08:52, 38.00s/it]
Task 0, Epoch 7/20 => Loss 0.494, Train_accy 86.54:  30%|███       | 6/20 [04:23<08:52, 38.00s/it]                 
Task 0, Epoch 7/20 => Loss 0.494, Train_accy 86.54:  35%|███▌      | 7/20 [04:23<08:06, 37.41s/it]
Task 0, Epoch 8/20 => Loss 0.454, Train_accy 87.81:  35%|███▌      | 7/20 [05:00<08:06, 37.41s/it]
Task 0, Epoch 8/20 => Loss 0.454, Train_accy 87.81:  40%|████      | 8/20 [05:00<07:26, 37.19s/it]
Task 0, Epoch 9/20 => Loss 0.421, Train_accy 88.96:  40%|████      | 8/20 [05:36<07:26, 37.19s/it]
Task 0, Epoch 9/20 => Loss 0.421, Train_accy 88.96:  45%|████▌     | 9/20 [05:36<06:46, 36.95s/it]
Task 0, Epoch 10/20 => Loss 0.425, Train_accy 88.47:  45%|████▌     | 9/20 [06:13<06:46, 36.95s/it]
Task 0, Epoch 10/20 => Loss 0.425, Train_accy 88.47:  50%|█████     | 10/20 [06:13<06:08, 36.81s/it]
Task 0, Epoch 11/20 => Loss 0.422, Train_accy 88.33, Test_accy 89.23:  50%|█████     | 10/20 [06:53<06:08, 36.81s/it]
Task 0, Epoch 11/20 => Loss 0.422, Train_accy 88.33, Test_accy 89.23:  55%|█████▌    | 11/20 [06:53<05:41, 37.90s/it]
Task 0, Epoch 12/20 => Loss 0.394, Train_accy 89.16:  55%|█████▌    | 11/20 [07:30<05:41, 37.90s/it]                 
Task 0, Epoch 12/20 => Loss 0.394, Train_accy 89.16:  60%|██████    | 12/20 [07:30<04:59, 37.44s/it]
Task 0, Epoch 13/20 => Loss 0.367, Train_accy 89.86:  60%|██████    | 12/20 [08:06<04:59, 37.44s/it]
Task 0, Epoch 13/20 => Loss 0.367, Train_accy 89.86:  65%|██████▌   | 13/20 [08:06<04:19, 37.13s/it]
Task 0, Epoch 14/20 => Loss 0.371, Train_accy 89.97:  65%|██████▌   | 13/20 [08:42<04:19, 37.13s/it]
Task 0, Epoch 14/20 => Loss 0.371, Train_accy 89.97:  70%|███████   | 14/20 [08:42<03:41, 36.90s/it]
Task 0, Epoch 15/20 => Loss 0.369, Train_accy 90.01:  70%|███████   | 14/20 [09:19<03:41, 36.90s/it]
Task 0, Epoch 15/20 => Loss 0.369, Train_accy 90.01:  75%|███████▌  | 15/20 [09:19<03:03, 36.74s/it]
Task 0, Epoch 16/20 => Loss 0.360, Train_accy 90.18, Test_accy 89.65:  75%|███████▌  | 15/20 [09:59<03:03, 36.74s/it]
Task 0, Epoch 16/20 => Loss 0.360, Train_accy 90.18, Test_accy 89.65:  80%|████████  | 16/20 [09:59<02:31, 37.82s/it]
Task 0, Epoch 17/20 => Loss 0.376, Train_accy 89.94:  80%|████████  | 16/20 [10:35<02:31, 37.82s/it]                 
Task 0, Epoch 17/20 => Loss 0.376, Train_accy 89.94:  85%|████████▌ | 17/20 [10:35<01:52, 37.38s/it]
Task 0, Epoch 18/20 => Loss 0.346, Train_accy 90.75:  85%|████████▌ | 17/20 [11:12<01:52, 37.38s/it]
Task 0, Epoch 18/20 => Loss 0.346, Train_accy 90.75:  90%|█████████ | 18/20 [11:12<01:14, 37.13s/it]
Task 0, Epoch 19/20 => Loss 0.304, Train_accy 91.93:  90%|█████████ | 18/20 [11:48<01:14, 37.13s/it]
Task 0, Epoch 19/20 => Loss 0.304, Train_accy 91.93:  95%|█████████▌| 19/20 [11:48<00:36, 36.90s/it]
Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71:  95%|█████████▌| 19/20 [12:25<00:36, 36.90s/it]
Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71: 100%|██████████| 20/20 [12:25<00:00, 36.75s/it]
Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71: 100%|██████████| 20/20 [12:25<00:00, 37.27s/it]2024-09-13 04:23:32,366 [der.py] => Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71
2024-09-13 04:23:32,367 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 04:25:21,118 [der.py] => Exemplar size: 2000
2024-09-13 04:25:21,119 [trainer.py] => CNN: {'total': 88.72, '00-99': 88.72, 'old': 0, 'new': 88.72}
2024-09-13 04:25:21,119 [trainer.py] => NME: {'total': 90.99, '00-99': 90.99, 'old': 0, 'new': 90.99}
2024-09-13 04:25:21,119 [trainer.py] => CNN top1 curve: [88.72]
2024-09-13 04:25:21,119 [trainer.py] => CNN top5 curve: [98.4]
2024-09-13 04:25:21,119 [trainer.py] => NME top1 curve: [90.99]
2024-09-13 04:25:21,119 [trainer.py] => NME top5 curve: [98.91]

Average Accuracy (CNN): 88.72
Average Accuracy (NME): 90.99
2024-09-13 04:25:21,119 [trainer.py] => Average Accuracy (CNN): 88.72
2024-09-13 04:25:21,119 [trainer.py] => Average Accuracy (NME): 90.99
2024-09-13 04:25:21,120 [trainer.py] => All params: 85953225
2024-09-13 04:25:21,121 [trainer.py] => Trainable params: 85953225
2024-09-13 04:25:22,987 [der.py] => Learning on 100-120
2024-09-13 04:25:22,989 [der.py] => All params: 171797901
2024-09-13 04:25:22,990 [der.py] => Trainable params: 85999245

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.503, Loss_clf 1.447, Loss_aux 1.057, Train_accy 76.08, Test_accy 84.68:   0%|          | 0/20 [00:39<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.503, Loss_clf 1.447, Loss_aux 1.057, Train_accy 76.08, Test_accy 84.68:   5%|▌         | 1/20 [00:39<12:22, 39.08s/it]
Task 1, Epoch 2/20 => Loss 0.818, Loss_clf 0.484, Loss_aux 0.334, Train_accy 87.13:   5%|▌         | 1/20 [01:09<12:22, 39.08s/it]                 
Task 1, Epoch 2/20 => Loss 0.818, Loss_clf 0.484, Loss_aux 0.334, Train_accy 87.13:  10%|█         | 2/20 [01:09<10:13, 34.10s/it]
Task 1, Epoch 3/20 => Loss 0.779, Loss_clf 0.462, Loss_aux 0.317, Train_accy 86.69:  10%|█         | 2/20 [01:40<10:13, 34.10s/it]
Task 1, Epoch 3/20 => Loss 0.779, Loss_clf 0.462, Loss_aux 0.317, Train_accy 86.69:  15%|█▌        | 3/20 [01:40<09:13, 32.55s/it]
Task 1, Epoch 4/20 => Loss 0.632, Loss_clf 0.382, Loss_aux 0.250, Train_accy 89.23:  15%|█▌        | 3/20 [02:11<09:13, 32.55s/it]
Task 1, Epoch 4/20 => Loss 0.632, Loss_clf 0.382, Loss_aux 0.250, Train_accy 89.23:  20%|██        | 4/20 [02:11<08:30, 31.88s/it]
Task 1, Epoch 5/20 => Loss 0.592, Loss_clf 0.360, Loss_aux 0.231, Train_accy 90.04:  20%|██        | 4/20 [02:42<08:30, 31.88s/it]
Task 1, Epoch 5/20 => Loss 0.592, Loss_clf 0.360, Loss_aux 0.231, Train_accy 90.04:  25%|██▌       | 5/20 [02:42<07:52, 31.52s/it]
Task 1, Epoch 6/20 => Loss 0.523, Loss_clf 0.342, Loss_aux 0.181, Train_accy 91.06, Test_accy 87.99:  25%|██▌       | 5/20 [03:21<07:52, 31.52s/it]
Task 1, Epoch 6/20 => Loss 0.523, Loss_clf 0.342, Loss_aux 0.181, Train_accy 91.06, Test_accy 87.99:  30%|███       | 6/20 [03:21<07:58, 34.19s/it]
Task 1, Epoch 7/20 => Loss 0.472, Loss_clf 0.309, Loss_aux 0.163, Train_accy 91.57:  30%|███       | 6/20 [03:52<07:58, 34.19s/it]                 
Task 1, Epoch 7/20 => Loss 0.472, Loss_clf 0.309, Loss_aux 0.163, Train_accy 91.57:  35%|███▌      | 7/20 [03:52<07:10, 33.12s/it]
Task 1, Epoch 8/20 => Loss 0.538, Loss_clf 0.349, Loss_aux 0.188, Train_accy 91.02:  35%|███▌      | 7/20 [04:23<07:10, 33.12s/it]
Task 1, Epoch 8/20 => Loss 0.538, Loss_clf 0.349, Loss_aux 0.188, Train_accy 91.02:  40%|████      | 8/20 [04:23<06:28, 32.41s/it]
Task 1, Epoch 9/20 => Loss 0.482, Loss_clf 0.302, Loss_aux 0.180, Train_accy 92.01:  40%|████      | 8/20 [04:54<06:28, 32.41s/it]
Task 1, Epoch 9/20 => Loss 0.482, Loss_clf 0.302, Loss_aux 0.180, Train_accy 92.01:  45%|████▌     | 9/20 [04:54<05:51, 31.95s/it]
Task 1, Epoch 10/20 => Loss 0.458, Loss_clf 0.296, Loss_aux 0.162, Train_accy 91.97:  45%|████▌     | 9/20 [05:25<05:51, 31.95s/it]
Task 1, Epoch 10/20 => Loss 0.458, Loss_clf 0.296, Loss_aux 0.162, Train_accy 91.97:  50%|█████     | 10/20 [05:25<05:16, 31.65s/it]
Task 1, Epoch 11/20 => Loss 0.461, Loss_clf 0.307, Loss_aux 0.154, Train_accy 92.28, Test_accy 88.42:  50%|█████     | 10/20 [06:04<05:16, 31.65s/it]
Task 1, Epoch 11/20 => Loss 0.461, Loss_clf 0.307, Loss_aux 0.154, Train_accy 92.28, Test_accy 88.42:  55%|█████▌    | 11/20 [06:04<05:06, 34.10s/it]
Task 1, Epoch 12/20 => Loss 0.487, Loss_clf 0.318, Loss_aux 0.169, Train_accy 91.29:  55%|█████▌    | 11/20 [06:35<05:06, 34.10s/it]                 
Task 1, Epoch 12/20 => Loss 0.487, Loss_clf 0.318, Loss_aux 0.169, Train_accy 91.29:  60%|██████    | 12/20 [06:35<04:25, 33.17s/it]
Task 1, Epoch 13/20 => Loss 0.462, Loss_clf 0.311, Loss_aux 0.151, Train_accy 91.97:  60%|██████    | 12/20 [07:06<04:25, 33.17s/it]
Task 1, Epoch 13/20 => Loss 0.462, Loss_clf 0.311, Loss_aux 0.151, Train_accy 91.97:  65%|██████▌   | 13/20 [07:06<03:47, 32.51s/it]
Task 1, Epoch 14/20 => Loss 0.414, Loss_clf 0.287, Loss_aux 0.127, Train_accy 92.41:  65%|██████▌   | 13/20 [07:37<03:47, 32.51s/it]
Task 1, Epoch 14/20 => Loss 0.414, Loss_clf 0.287, Loss_aux 0.127, Train_accy 92.41:  70%|███████   | 14/20 [07:37<03:12, 32.04s/it]
Task 1, Epoch 15/20 => Loss 0.452, Loss_clf 0.322, Loss_aux 0.131, Train_accy 91.80:  70%|███████   | 14/20 [08:08<03:12, 32.04s/it]
Task 1, Epoch 15/20 => Loss 0.452, Loss_clf 0.322, Loss_aux 0.131, Train_accy 91.80:  75%|███████▌  | 15/20 [08:08<02:38, 31.70s/it]
Task 1, Epoch 16/20 => Loss 0.410, Loss_clf 0.286, Loss_aux 0.124, Train_accy 91.80, Test_accy 89.12:  75%|███████▌  | 15/20 [08:48<02:38, 31.70s/it]
Task 1, Epoch 16/20 => Loss 0.410, Loss_clf 0.286, Loss_aux 0.124, Train_accy 91.80, Test_accy 89.12:  80%|████████  | 16/20 [08:48<02:16, 34.04s/it]
Task 1, Epoch 17/20 => Loss 0.398, Loss_clf 0.268, Loss_aux 0.130, Train_accy 92.75:  80%|████████  | 16/20 [09:19<02:16, 34.04s/it]                 
Task 1, Epoch 17/20 => Loss 0.398, Loss_clf 0.268, Loss_aux 0.130, Train_accy 92.75:  85%|████████▌ | 17/20 [09:19<01:39, 33.08s/it]
Task 1, Epoch 18/20 => Loss 0.435, Loss_clf 0.288, Loss_aux 0.147, Train_accy 92.31:  85%|████████▌ | 17/20 [09:49<01:39, 33.08s/it]
Task 1, Epoch 18/20 => Loss 0.435, Loss_clf 0.288, Loss_aux 0.147, Train_accy 92.31:  90%|█████████ | 18/20 [09:49<01:04, 32.42s/it]
Task 1, Epoch 19/20 => Loss 0.411, Loss_clf 0.280, Loss_aux 0.131, Train_accy 92.65:  90%|█████████ | 18/20 [10:21<01:04, 32.42s/it]
Task 1, Epoch 19/20 => Loss 0.411, Loss_clf 0.280, Loss_aux 0.131, Train_accy 92.65:  95%|█████████▌| 19/20 [10:21<00:32, 32.01s/it]
Task 1, Epoch 20/20 => Loss 0.397, Loss_clf 0.281, Loss_aux 0.116, Train_accy 92.41:  95%|█████████▌| 19/20 [10:52<00:32, 32.01s/it]
Task 1, Epoch 20/20 => Loss 0.397, Loss_clf 0.281, Loss_aux 0.116, Train_accy 92.41: 100%|██████████| 20/20 [10:52<00:00, 31.73s/it]
Task 1, Epoch 20/20 => Loss 0.397, Loss_clf 0.281, Loss_aux 0.116, Train_accy 92.41: 100%|██████████| 20/20 [10:52<00:00, 32.60s/it]2024-09-13 04:36:15,138 [der.py] => Task 1, Epoch 20/20 => Loss 0.397, Loss_clf 0.281, Loss_aux 0.116, Train_accy 92.41
2024-09-13 04:36:15,140 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 04:37:43,703 [der.py] => Exemplar size: 2400
2024-09-13 04:37:43,703 [trainer.py] => CNN: {'total': 89.12, '00-99': 88.55, '100-119': 92.11, 'old': 88.55, 'new': 92.11}
2024-09-13 04:37:43,704 [trainer.py] => NME: {'total': 89.55, '00-99': 89.14, '100-119': 91.67, 'old': 89.14, 'new': 91.67}
2024-09-13 04:37:43,704 [trainer.py] => CNN top1 curve: [88.72, 89.12]
2024-09-13 04:37:43,704 [trainer.py] => CNN top5 curve: [98.4, 98.23]
2024-09-13 04:37:43,704 [trainer.py] => NME top1 curve: [90.99, 89.55]
2024-09-13 04:37:43,704 [trainer.py] => NME top5 curve: [98.91, 98.66]

Average Accuracy (CNN): 88.92
Average Accuracy (NME): 90.27
2024-09-13 04:37:43,704 [trainer.py] => Average Accuracy (CNN): 88.92
2024-09-13 04:37:43,704 [trainer.py] => Average Accuracy (NME): 90.27
2024-09-13 04:37:43,706 [trainer.py] => All params: 171797901
2024-09-13 04:37:43,707 [trainer.py] => Trainable params: 85999245
2024-09-13 04:37:45,523 [der.py] => Learning on 120-140
2024-09-13 04:37:45,526 [der.py] => All params: 257734817
2024-09-13 04:37:45,528 [der.py] => Trainable params: 86137505

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.149, Loss_clf 1.244, Loss_aux 0.905, Train_accy 78.35, Test_accy 85.56:   0%|          | 0/20 [00:57<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.149, Loss_clf 1.244, Loss_aux 0.905, Train_accy 78.35, Test_accy 85.56:   5%|▌         | 1/20 [00:57<18:16, 57.69s/it]
Task 2, Epoch 2/20 => Loss 0.774, Loss_clf 0.451, Loss_aux 0.324, Train_accy 87.42:   5%|▌         | 1/20 [01:41<18:16, 57.69s/it]                 
Task 2, Epoch 2/20 => Loss 0.774, Loss_clf 0.451, Loss_aux 0.324, Train_accy 87.42:  10%|█         | 2/20 [01:41<14:50, 49.48s/it]
Task 2, Epoch 3/20 => Loss 0.725, Loss_clf 0.434, Loss_aux 0.291, Train_accy 88.31:  10%|█         | 2/20 [02:25<14:50, 49.48s/it]
Task 2, Epoch 3/20 => Loss 0.725, Loss_clf 0.434, Loss_aux 0.291, Train_accy 88.31:  15%|█▌        | 3/20 [02:25<13:16, 46.88s/it]
Task 2, Epoch 4/20 => Loss 0.658, Loss_clf 0.408, Loss_aux 0.251, Train_accy 89.00:  15%|█▌        | 3/20 [03:09<13:16, 46.88s/it]
Task 2, Epoch 4/20 => Loss 0.658, Loss_clf 0.408, Loss_aux 0.251, Train_accy 89.00:  20%|██        | 4/20 [03:09<12:11, 45.72s/it]
Task 2, Epoch 5/20 => Loss 0.648, Loss_clf 0.419, Loss_aux 0.229, Train_accy 88.76:  20%|██        | 4/20 [03:53<12:11, 45.72s/it]
Task 2, Epoch 5/20 => Loss 0.648, Loss_clf 0.419, Loss_aux 0.229, Train_accy 88.76:  25%|██▌       | 5/20 [03:53<11:16, 45.10s/it]
Task 2, Epoch 6/20 => Loss 0.552, Loss_clf 0.355, Loss_aux 0.197, Train_accy 90.28, Test_accy 87.20:  25%|██▌       | 5/20 [04:51<11:16, 45.10s/it]
Task 2, Epoch 6/20 => Loss 0.552, Loss_clf 0.355, Loss_aux 0.197, Train_accy 90.28, Test_accy 87.20:  30%|███       | 6/20 [04:51<11:33, 49.52s/it]
Task 2, Epoch 7/20 => Loss 0.508, Loss_clf 0.329, Loss_aux 0.179, Train_accy 90.73:  30%|███       | 6/20 [05:35<11:33, 49.52s/it]                 
Task 2, Epoch 7/20 => Loss 0.508, Loss_clf 0.329, Loss_aux 0.179, Train_accy 90.73:  35%|███▌      | 7/20 [05:35<10:20, 47.76s/it]
Task 2, Epoch 8/20 => Loss 0.530, Loss_clf 0.339, Loss_aux 0.191, Train_accy 90.91:  35%|███▌      | 7/20 [06:19<10:20, 47.76s/it]
Task 2, Epoch 8/20 => Loss 0.530, Loss_clf 0.339, Loss_aux 0.191, Train_accy 90.91:  40%|████      | 8/20 [06:19<09:19, 46.59s/it]
Task 2, Epoch 9/20 => Loss 0.517, Loss_clf 0.337, Loss_aux 0.180, Train_accy 91.14:  40%|████      | 8/20 [07:03<09:19, 46.59s/it]
Task 2, Epoch 9/20 => Loss 0.517, Loss_clf 0.337, Loss_aux 0.180, Train_accy 91.14:  45%|████▌     | 9/20 [07:03<08:23, 45.75s/it]
Task 2, Epoch 10/20 => Loss 0.531, Loss_clf 0.353, Loss_aux 0.178, Train_accy 90.58:  45%|████▌     | 9/20 [07:47<08:23, 45.75s/it]
Task 2, Epoch 10/20 => Loss 0.531, Loss_clf 0.353, Loss_aux 0.178, Train_accy 90.58:  50%|█████     | 10/20 [07:47<07:32, 45.20s/it]
Task 2, Epoch 11/20 => Loss 0.433, Loss_clf 0.289, Loss_aux 0.144, Train_accy 92.01, Test_accy 87.81:  50%|█████     | 10/20 [08:45<07:32, 45.20s/it]
Task 2, Epoch 11/20 => Loss 0.433, Loss_clf 0.289, Loss_aux 0.144, Train_accy 92.01, Test_accy 87.81:  55%|█████▌    | 11/20 [08:45<07:22, 49.16s/it]
Task 2, Epoch 12/20 => Loss 0.491, Loss_clf 0.329, Loss_aux 0.162, Train_accy 91.35:  55%|█████▌    | 11/20 [09:29<07:22, 49.16s/it]                 
Task 2, Epoch 12/20 => Loss 0.491, Loss_clf 0.329, Loss_aux 0.162, Train_accy 91.35:  60%|██████    | 12/20 [09:29<06:20, 47.62s/it]
Task 2, Epoch 13/20 => Loss 0.492, Loss_clf 0.328, Loss_aux 0.164, Train_accy 91.59:  60%|██████    | 12/20 [10:13<06:20, 47.62s/it]
Task 2, Epoch 13/20 => Loss 0.492, Loss_clf 0.328, Loss_aux 0.164, Train_accy 91.59:  65%|██████▌   | 13/20 [10:13<05:25, 46.54s/it]
Task 2, Epoch 14/20 => Loss 0.430, Loss_clf 0.295, Loss_aux 0.134, Train_accy 92.13:  65%|██████▌   | 13/20 [10:57<05:25, 46.54s/it]
Task 2, Epoch 14/20 => Loss 0.430, Loss_clf 0.295, Loss_aux 0.134, Train_accy 92.13:  70%|███████   | 14/20 [10:57<04:34, 45.75s/it]
Task 2, Epoch 15/20 => Loss 0.481, Loss_clf 0.334, Loss_aux 0.147, Train_accy 91.32:  70%|███████   | 14/20 [11:41<04:34, 45.75s/it]
Task 2, Epoch 15/20 => Loss 0.481, Loss_clf 0.334, Loss_aux 0.147, Train_accy 91.32:  75%|███████▌  | 15/20 [11:41<03:46, 45.21s/it]
Task 2, Epoch 16/20 => Loss 0.414, Loss_clf 0.281, Loss_aux 0.133, Train_accy 92.84, Test_accy 88.12:  75%|███████▌  | 15/20 [12:39<03:46, 45.21s/it]
Task 2, Epoch 16/20 => Loss 0.414, Loss_clf 0.281, Loss_aux 0.133, Train_accy 92.84, Test_accy 88.12:  80%|████████  | 16/20 [12:39<03:16, 49.09s/it]
Task 2, Epoch 17/20 => Loss 0.424, Loss_clf 0.287, Loss_aux 0.137, Train_accy 92.75:  80%|████████  | 16/20 [13:23<03:16, 49.09s/it]                 
Task 2, Epoch 17/20 => Loss 0.424, Loss_clf 0.287, Loss_aux 0.137, Train_accy 92.75:  85%|████████▌ | 17/20 [13:23<02:22, 47.58s/it]
Task 2, Epoch 18/20 => Loss 0.447, Loss_clf 0.310, Loss_aux 0.137, Train_accy 92.40:  85%|████████▌ | 17/20 [14:07<02:22, 47.58s/it]
Task 2, Epoch 18/20 => Loss 0.447, Loss_clf 0.310, Loss_aux 0.137, Train_accy 92.40:  90%|█████████ | 18/20 [14:07<01:33, 46.53s/it]
Task 2, Epoch 19/20 => Loss 0.408, Loss_clf 0.282, Loss_aux 0.127, Train_accy 92.73:  90%|█████████ | 18/20 [14:51<01:33, 46.53s/it]
Task 2, Epoch 19/20 => Loss 0.408, Loss_clf 0.282, Loss_aux 0.127, Train_accy 92.73:  95%|█████████▌| 19/20 [14:51<00:45, 45.77s/it]
Task 2, Epoch 20/20 => Loss 0.423, Loss_clf 0.295, Loss_aux 0.128, Train_accy 92.70:  95%|█████████▌| 19/20 [15:35<00:45, 45.77s/it]
Task 2, Epoch 20/20 => Loss 0.423, Loss_clf 0.295, Loss_aux 0.128, Train_accy 92.70: 100%|██████████| 20/20 [15:35<00:00, 45.21s/it]
Task 2, Epoch 20/20 => Loss 0.423, Loss_clf 0.295, Loss_aux 0.128, Train_accy 92.70: 100%|██████████| 20/20 [15:35<00:00, 46.79s/it]2024-09-13 04:53:21,287 [der.py] => Task 2, Epoch 20/20 => Loss 0.423, Loss_clf 0.295, Loss_aux 0.128, Train_accy 92.70
2024-09-13 04:53:21,288 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 04:55:21,970 [der.py] => Exemplar size: 2800
2024-09-13 04:55:21,970 [trainer.py] => CNN: {'total': 88.06, '00-99': 86.7, '100-119': 91.67, '120-139': 91.56, 'old': 87.5, 'new': 91.56}
2024-09-13 04:55:21,970 [trainer.py] => NME: {'total': 88.18, '00-99': 88.38, '100-119': 90.35, '120-139': 84.89, 'old': 88.7, 'new': 84.89}
2024-09-13 04:55:21,970 [trainer.py] => CNN top1 curve: [88.72, 89.12, 88.06]
2024-09-13 04:55:21,970 [trainer.py] => CNN top5 curve: [98.4, 98.23, 97.62]
2024-09-13 04:55:21,970 [trainer.py] => NME top1 curve: [90.99, 89.55, 88.18]
2024-09-13 04:55:21,970 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.48]

Average Accuracy (CNN): 88.63
Average Accuracy (NME): 89.57
2024-09-13 04:55:21,970 [trainer.py] => Average Accuracy (CNN): 88.63
2024-09-13 04:55:21,970 [trainer.py] => Average Accuracy (NME): 89.57
2024-09-13 04:55:21,972 [trainer.py] => All params: 257734817
2024-09-13 04:55:21,974 [trainer.py] => Trainable params: 86137505
2024-09-13 04:55:23,457 [der.py] => Learning on 140-160
2024-09-13 04:55:23,461 [der.py] => All params: 343702453
2024-09-13 04:55:23,463 [der.py] => Trainable params: 86306485

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.207, Loss_clf 1.217, Loss_aux 0.991, Train_accy 79.14, Test_accy 84.19:   0%|          | 0/20 [01:18<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.207, Loss_clf 1.217, Loss_aux 0.991, Train_accy 79.14, Test_accy 84.19:   5%|▌         | 1/20 [01:18<25:00, 78.97s/it]
Task 3, Epoch 2/20 => Loss 0.772, Loss_clf 0.432, Loss_aux 0.339, Train_accy 88.71:   5%|▌         | 1/20 [02:17<25:00, 78.97s/it]                 
Task 3, Epoch 2/20 => Loss 0.772, Loss_clf 0.432, Loss_aux 0.339, Train_accy 88.71:  10%|█         | 2/20 [02:17<20:04, 66.90s/it]
Task 3, Epoch 3/20 => Loss 0.648, Loss_clf 0.393, Loss_aux 0.255, Train_accy 89.01:  10%|█         | 2/20 [03:15<20:04, 66.90s/it]
Task 3, Epoch 3/20 => Loss 0.648, Loss_clf 0.393, Loss_aux 0.255, Train_accy 89.01:  15%|█▌        | 3/20 [03:15<17:51, 63.04s/it]
Task 3, Epoch 4/20 => Loss 0.589, Loss_clf 0.378, Loss_aux 0.212, Train_accy 89.78:  15%|█▌        | 3/20 [04:14<17:51, 63.04s/it]
Task 3, Epoch 4/20 => Loss 0.589, Loss_clf 0.378, Loss_aux 0.212, Train_accy 89.78:  20%|██        | 4/20 [04:14<16:19, 61.24s/it]
Task 3, Epoch 5/20 => Loss 0.577, Loss_clf 0.374, Loss_aux 0.203, Train_accy 90.43:  20%|██        | 4/20 [05:12<16:19, 61.24s/it]
Task 3, Epoch 5/20 => Loss 0.577, Loss_clf 0.374, Loss_aux 0.203, Train_accy 90.43:  25%|██▌       | 5/20 [05:12<15:03, 60.26s/it]
Task 3, Epoch 6/20 => Loss 0.543, Loss_clf 0.363, Loss_aux 0.180, Train_accy 90.46, Test_accy 84.93:  25%|██▌       | 5/20 [06:32<15:03, 60.26s/it]
Task 3, Epoch 6/20 => Loss 0.543, Loss_clf 0.363, Loss_aux 0.180, Train_accy 90.46, Test_accy 84.93:  30%|███       | 6/20 [06:32<15:37, 66.98s/it]
Task 3, Epoch 7/20 => Loss 0.519, Loss_clf 0.345, Loss_aux 0.174, Train_accy 90.86:  30%|███       | 6/20 [07:31<15:37, 66.98s/it]                 
Task 3, Epoch 7/20 => Loss 0.519, Loss_clf 0.345, Loss_aux 0.174, Train_accy 90.86:  35%|███▌      | 7/20 [07:31<13:55, 64.24s/it]
Task 3, Epoch 8/20 => Loss 0.464, Loss_clf 0.306, Loss_aux 0.157, Train_accy 91.94:  35%|███▌      | 7/20 [08:30<13:55, 64.24s/it]
Task 3, Epoch 8/20 => Loss 0.464, Loss_clf 0.306, Loss_aux 0.157, Train_accy 91.94:  40%|████      | 8/20 [08:30<12:29, 62.49s/it]
Task 3, Epoch 9/20 => Loss 0.469, Loss_clf 0.322, Loss_aux 0.147, Train_accy 91.75:  40%|████      | 8/20 [09:28<12:29, 62.49s/it]
Task 3, Epoch 9/20 => Loss 0.469, Loss_clf 0.322, Loss_aux 0.147, Train_accy 91.75:  45%|████▌     | 9/20 [09:28<11:14, 61.30s/it]
Task 3, Epoch 10/20 => Loss 0.460, Loss_clf 0.318, Loss_aux 0.142, Train_accy 91.75:  45%|████▌     | 9/20 [10:27<11:14, 61.30s/it]
Task 3, Epoch 10/20 => Loss 0.460, Loss_clf 0.318, Loss_aux 0.142, Train_accy 91.75:  50%|█████     | 10/20 [10:27<10:04, 60.44s/it]
Task 3, Epoch 11/20 => Loss 0.463, Loss_clf 0.322, Loss_aux 0.141, Train_accy 91.59, Test_accy 86.67:  50%|█████     | 10/20 [11:47<10:04, 60.44s/it]
Task 3, Epoch 11/20 => Loss 0.463, Loss_clf 0.322, Loss_aux 0.141, Train_accy 91.59, Test_accy 86.67:  55%|█████▌    | 11/20 [11:47<09:56, 66.32s/it]
Task 3, Epoch 12/20 => Loss 0.444, Loss_clf 0.305, Loss_aux 0.140, Train_accy 92.07:  55%|█████▌    | 11/20 [12:45<09:56, 66.32s/it]                 
Task 3, Epoch 12/20 => Loss 0.444, Loss_clf 0.305, Loss_aux 0.140, Train_accy 92.07:  60%|██████    | 12/20 [12:45<08:32, 64.01s/it]
Task 3, Epoch 13/20 => Loss 0.465, Loss_clf 0.324, Loss_aux 0.141, Train_accy 91.80:  60%|██████    | 12/20 [13:44<08:32, 64.01s/it]
Task 3, Epoch 13/20 => Loss 0.465, Loss_clf 0.324, Loss_aux 0.141, Train_accy 91.80:  65%|██████▌   | 13/20 [13:44<07:16, 62.41s/it]
Task 3, Epoch 14/20 => Loss 0.434, Loss_clf 0.305, Loss_aux 0.129, Train_accy 92.18:  65%|██████▌   | 13/20 [14:43<07:16, 62.41s/it]
Task 3, Epoch 14/20 => Loss 0.434, Loss_clf 0.305, Loss_aux 0.129, Train_accy 92.18:  70%|███████   | 14/20 [14:43<06:07, 61.24s/it]
Task 3, Epoch 15/20 => Loss 0.466, Loss_clf 0.326, Loss_aux 0.139, Train_accy 91.21:  70%|███████   | 14/20 [15:41<06:07, 61.24s/it]
Task 3, Epoch 15/20 => Loss 0.466, Loss_clf 0.326, Loss_aux 0.139, Train_accy 91.21:  75%|███████▌  | 15/20 [15:41<05:02, 60.50s/it]
Task 3, Epoch 16/20 => Loss 0.411, Loss_clf 0.299, Loss_aux 0.112, Train_accy 92.23, Test_accy 86.99:  75%|███████▌  | 15/20 [17:01<05:02, 60.50s/it]
Task 3, Epoch 16/20 => Loss 0.411, Loss_clf 0.299, Loss_aux 0.112, Train_accy 92.23, Test_accy 86.99:  80%|████████  | 16/20 [17:01<04:25, 66.38s/it]
Task 3, Epoch 17/20 => Loss 0.388, Loss_clf 0.285, Loss_aux 0.103, Train_accy 92.53:  80%|████████  | 16/20 [18:00<04:25, 66.38s/it]                 
Task 3, Epoch 17/20 => Loss 0.388, Loss_clf 0.285, Loss_aux 0.103, Train_accy 92.53:  85%|████████▌ | 17/20 [18:00<03:12, 64.11s/it]
Task 3, Epoch 18/20 => Loss 0.392, Loss_clf 0.277, Loss_aux 0.115, Train_accy 93.17:  85%|████████▌ | 17/20 [18:59<03:12, 64.11s/it]
Task 3, Epoch 18/20 => Loss 0.392, Loss_clf 0.277, Loss_aux 0.115, Train_accy 93.17:  90%|█████████ | 18/20 [18:59<02:05, 62.52s/it]
Task 3, Epoch 19/20 => Loss 0.419, Loss_clf 0.299, Loss_aux 0.120, Train_accy 91.99:  90%|█████████ | 18/20 [19:58<02:05, 62.52s/it]
Task 3, Epoch 19/20 => Loss 0.419, Loss_clf 0.299, Loss_aux 0.120, Train_accy 91.99:  95%|█████████▌| 19/20 [19:58<01:01, 61.33s/it]
Task 3, Epoch 20/20 => Loss 0.429, Loss_clf 0.310, Loss_aux 0.119, Train_accy 92.15:  95%|█████████▌| 19/20 [20:56<01:01, 61.33s/it]
Task 3, Epoch 20/20 => Loss 0.429, Loss_clf 0.310, Loss_aux 0.119, Train_accy 92.15: 100%|██████████| 20/20 [20:56<00:00, 60.49s/it]
Task 3, Epoch 20/20 => Loss 0.429, Loss_clf 0.310, Loss_aux 0.119, Train_accy 92.15: 100%|██████████| 20/20 [20:56<00:00, 62.83s/it]2024-09-13 05:16:20,147 [der.py] => Task 3, Epoch 20/20 => Loss 0.429, Loss_clf 0.310, Loss_aux 0.119, Train_accy 92.15
2024-09-13 05:16:20,148 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 05:19:00,592 [der.py] => Exemplar size: 3200
2024-09-13 05:19:00,592 [trainer.py] => CNN: {'total': 86.73, '00-99': 85.1, '100-119': 87.72, '120-139': 87.56, '140-159': 92.8, 'old': 85.8, 'new': 92.8}
2024-09-13 05:19:00,592 [trainer.py] => NME: {'total': 88.52, '00-99': 88.22, '100-119': 89.47, '120-139': 87.11, '140-159': 90.4, 'old': 88.24, 'new': 90.4}
2024-09-13 05:19:00,592 [trainer.py] => CNN top1 curve: [88.72, 89.12, 88.06, 86.73]
2024-09-13 05:19:00,592 [trainer.py] => CNN top5 curve: [98.4, 98.23, 97.62, 97.3]
2024-09-13 05:19:00,592 [trainer.py] => NME top1 curve: [90.99, 89.55, 88.18, 88.52]
2024-09-13 05:19:00,593 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.48, 98.52]

Average Accuracy (CNN): 88.16
Average Accuracy (NME): 89.31
2024-09-13 05:19:00,593 [trainer.py] => Average Accuracy (CNN): 88.16
2024-09-13 05:19:00,593 [trainer.py] => Average Accuracy (NME): 89.31
2024-09-13 05:19:00,597 [trainer.py] => All params: 343702453
2024-09-13 05:19:00,600 [trainer.py] => Trainable params: 86306485
2024-09-13 05:19:02,671 [der.py] => Learning on 160-180
2024-09-13 05:19:02,678 [der.py] => All params: 429700809
2024-09-13 05:19:02,681 [der.py] => Trainable params: 86506185

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.892, Loss_clf 1.131, Loss_aux 0.762, Train_accy 81.89, Test_accy 83.04:   0%|          | 0/20 [01:45<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.892, Loss_clf 1.131, Loss_aux 0.762, Train_accy 81.89, Test_accy 83.04:   5%|▌         | 1/20 [01:45<33:19, 105.24s/it]
Task 4, Epoch 2/20 => Loss 0.692, Loss_clf 0.398, Loss_aux 0.293, Train_accy 89.25:   5%|▌         | 1/20 [03:01<33:19, 105.24s/it]                 
Task 4, Epoch 2/20 => Loss 0.692, Loss_clf 0.398, Loss_aux 0.293, Train_accy 89.25:  10%|█         | 2/20 [03:01<26:28, 88.25s/it] 
Task 4, Epoch 3/20 => Loss 0.601, Loss_clf 0.374, Loss_aux 0.227, Train_accy 90.45:  10%|█         | 2/20 [04:17<26:28, 88.25s/it]
Task 4, Epoch 3/20 => Loss 0.601, Loss_clf 0.374, Loss_aux 0.227, Train_accy 90.45:  15%|█▌        | 3/20 [04:17<23:27, 82.80s/it]
Task 4, Epoch 4/20 => Loss 0.616, Loss_clf 0.381, Loss_aux 0.235, Train_accy 90.19:  15%|█▌        | 3/20 [05:34<23:27, 82.80s/it]
Task 4, Epoch 4/20 => Loss 0.616, Loss_clf 0.381, Loss_aux 0.235, Train_accy 90.19:  20%|██        | 4/20 [05:34<21:24, 80.26s/it]
Task 4, Epoch 5/20 => Loss 0.517, Loss_clf 0.341, Loss_aux 0.175, Train_accy 91.17:  20%|██        | 4/20 [06:50<21:24, 80.26s/it]
Task 4, Epoch 5/20 => Loss 0.517, Loss_clf 0.341, Loss_aux 0.175, Train_accy 91.17:  25%|██▌       | 5/20 [06:50<19:43, 78.90s/it]
Task 4, Epoch 6/20 => Loss 0.502, Loss_clf 0.335, Loss_aux 0.166, Train_accy 91.20, Test_accy 85.24:  25%|██▌       | 5/20 [08:36<19:43, 78.90s/it]
Task 4, Epoch 6/20 => Loss 0.502, Loss_clf 0.335, Loss_aux 0.166, Train_accy 91.20, Test_accy 85.24:  30%|███       | 6/20 [08:36<20:34, 88.19s/it]
Task 4, Epoch 7/20 => Loss 0.471, Loss_clf 0.326, Loss_aux 0.145, Train_accy 91.63:  30%|███       | 6/20 [09:53<20:34, 88.19s/it]                 
Task 4, Epoch 7/20 => Loss 0.471, Loss_clf 0.326, Loss_aux 0.145, Train_accy 91.63:  35%|███▌      | 7/20 [09:53<18:17, 84.43s/it]
Task 4, Epoch 8/20 => Loss 0.455, Loss_clf 0.316, Loss_aux 0.139, Train_accy 91.85:  35%|███▌      | 7/20 [11:10<18:17, 84.43s/it]
Task 4, Epoch 8/20 => Loss 0.455, Loss_clf 0.316, Loss_aux 0.139, Train_accy 91.85:  40%|████      | 8/20 [11:10<16:22, 81.87s/it]
Task 4, Epoch 9/20 => Loss 0.458, Loss_clf 0.316, Loss_aux 0.142, Train_accy 92.04:  40%|████      | 8/20 [12:26<16:22, 81.87s/it]
Task 4, Epoch 9/20 => Loss 0.458, Loss_clf 0.316, Loss_aux 0.142, Train_accy 92.04:  45%|████▌     | 9/20 [12:26<14:41, 80.13s/it]
Task 4, Epoch 10/20 => Loss 0.438, Loss_clf 0.309, Loss_aux 0.128, Train_accy 91.58:  45%|████▌     | 9/20 [13:42<14:41, 80.13s/it]
Task 4, Epoch 10/20 => Loss 0.438, Loss_clf 0.309, Loss_aux 0.128, Train_accy 91.58:  50%|█████     | 10/20 [13:42<13:09, 79.00s/it]
Task 4, Epoch 11/20 => Loss 0.443, Loss_clf 0.314, Loss_aux 0.129, Train_accy 91.99, Test_accy 86.09:  50%|█████     | 10/20 [15:28<13:09, 79.00s/it]
Task 4, Epoch 11/20 => Loss 0.443, Loss_clf 0.314, Loss_aux 0.129, Train_accy 91.99, Test_accy 86.09:  55%|█████▌    | 11/20 [15:28<13:04, 87.20s/it]
Task 4, Epoch 12/20 => Loss 0.465, Loss_clf 0.329, Loss_aux 0.136, Train_accy 91.15:  55%|█████▌    | 11/20 [16:45<13:04, 87.20s/it]                 
Task 4, Epoch 12/20 => Loss 0.465, Loss_clf 0.329, Loss_aux 0.136, Train_accy 91.15:  60%|██████    | 12/20 [16:45<11:11, 83.97s/it]
Task 4, Epoch 13/20 => Loss 0.429, Loss_clf 0.299, Loss_aux 0.130, Train_accy 92.47:  60%|██████    | 12/20 [18:01<11:11, 83.97s/it]
Task 4, Epoch 13/20 => Loss 0.429, Loss_clf 0.299, Loss_aux 0.130, Train_accy 92.47:  65%|██████▌   | 13/20 [18:01<09:32, 81.71s/it]
Task 4, Epoch 14/20 => Loss 0.427, Loss_clf 0.308, Loss_aux 0.119, Train_accy 92.21:  65%|██████▌   | 13/20 [19:18<09:32, 81.71s/it]
Task 4, Epoch 14/20 => Loss 0.427, Loss_clf 0.308, Loss_aux 0.119, Train_accy 92.21:  70%|███████   | 14/20 [19:18<08:00, 80.11s/it]
Task 4, Epoch 15/20 => Loss 0.407, Loss_clf 0.291, Loss_aux 0.117, Train_accy 92.59:  70%|███████   | 14/20 [20:34<08:00, 80.11s/it]
Task 4, Epoch 15/20 => Loss 0.407, Loss_clf 0.291, Loss_aux 0.117, Train_accy 92.59:  75%|███████▌  | 15/20 [20:34<06:34, 78.99s/it]
Task 4, Epoch 16/20 => Loss 0.419, Loss_clf 0.289, Loss_aux 0.130, Train_accy 92.64, Test_accy 85.53:  75%|███████▌  | 15/20 [22:20<06:34, 78.99s/it]
Task 4, Epoch 16/20 => Loss 0.419, Loss_clf 0.289, Loss_aux 0.130, Train_accy 92.64, Test_accy 85.53:  80%|████████  | 16/20 [22:20<05:48, 87.13s/it]
Task 4, Epoch 17/20 => Loss 0.389, Loss_clf 0.271, Loss_aux 0.118, Train_accy 92.78:  80%|████████  | 16/20 [23:36<05:48, 87.13s/it]                 
Task 4, Epoch 17/20 => Loss 0.389, Loss_clf 0.271, Loss_aux 0.118, Train_accy 92.78:  85%|████████▌ | 17/20 [23:36<04:11, 83.90s/it]
Task 4, Epoch 18/20 => Loss 0.400, Loss_clf 0.293, Loss_aux 0.108, Train_accy 92.74:  85%|████████▌ | 17/20 [24:53<04:11, 83.90s/it]
Task 4, Epoch 18/20 => Loss 0.400, Loss_clf 0.293, Loss_aux 0.108, Train_accy 92.74:  90%|█████████ | 18/20 [24:53<02:43, 81.63s/it]
Task 4, Epoch 19/20 => Loss 0.406, Loss_clf 0.294, Loss_aux 0.112, Train_accy 92.35:  90%|█████████ | 18/20 [26:09<02:43, 81.63s/it]
Task 4, Epoch 19/20 => Loss 0.406, Loss_clf 0.294, Loss_aux 0.112, Train_accy 92.35:  95%|█████████▌| 19/20 [26:09<01:20, 80.05s/it]
Task 4, Epoch 20/20 => Loss 0.425, Loss_clf 0.308, Loss_aux 0.117, Train_accy 92.45:  95%|█████████▌| 19/20 [27:26<01:20, 80.05s/it]
Task 4, Epoch 20/20 => Loss 0.425, Loss_clf 0.308, Loss_aux 0.117, Train_accy 92.45: 100%|██████████| 20/20 [27:26<00:00, 78.98s/it]
Task 4, Epoch 20/20 => Loss 0.425, Loss_clf 0.308, Loss_aux 0.117, Train_accy 92.45: 100%|██████████| 20/20 [27:26<00:00, 82.31s/it]2024-09-13 05:46:28,955 [der.py] => Task 4, Epoch 20/20 => Loss 0.425, Loss_clf 0.308, Loss_aux 0.117, Train_accy 92.45
2024-09-13 05:46:28,956 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 05:49:57,655 [der.py] => Exemplar size: 3600
2024-09-13 05:49:57,655 [trainer.py] => CNN: {'total': 86.0, '00-99': 84.09, '100-119': 88.16, '120-139': 85.33, '140-159': 86.0, '160-179': 94.09, 'old': 84.98, 'new': 94.09}
2024-09-13 05:49:57,655 [trainer.py] => NME: {'total': 87.83, '00-99': 87.46, '100-119': 88.16, '120-139': 87.56, '140-159': 88.8, '160-179': 88.61, 'old': 87.73, 'new': 88.61}
2024-09-13 05:49:57,655 [trainer.py] => CNN top1 curve: [88.72, 89.12, 88.06, 86.73, 86.0]
2024-09-13 05:49:57,655 [trainer.py] => CNN top5 curve: [98.4, 98.23, 97.62, 97.3, 96.9]
2024-09-13 05:49:57,655 [trainer.py] => NME top1 curve: [90.99, 89.55, 88.18, 88.52, 87.83]
2024-09-13 05:49:57,655 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.48, 98.52, 98.21]

Average Accuracy (CNN): 87.73
Average Accuracy (NME): 89.01
2024-09-13 05:49:57,655 [trainer.py] => Average Accuracy (CNN): 87.73
2024-09-13 05:49:57,655 [trainer.py] => Average Accuracy (NME): 89.01
2024-09-13 05:49:57,659 [trainer.py] => All params: 429700809
2024-09-13 05:49:57,661 [trainer.py] => Trainable params: 86506185
2024-09-13 05:50:00,752 [der.py] => Learning on 180-200
2024-09-13 05:50:00,758 [der.py] => All params: 515729885
2024-09-13 05:50:00,760 [der.py] => Trainable params: 86736605

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.945, Loss_clf 1.058, Loss_aux 0.888, Train_accy 82.67, Test_accy 80.96:   0%|          | 0/20 [02:14<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.945, Loss_clf 1.058, Loss_aux 0.888, Train_accy 82.67, Test_accy 80.96:   5%|▌         | 1/20 [02:14<42:40, 134.75s/it]
Task 5, Epoch 2/20 => Loss 0.740, Loss_clf 0.421, Loss_aux 0.319, Train_accy 89.04:   5%|▌         | 1/20 [03:50<42:40, 134.75s/it]                 
Task 5, Epoch 2/20 => Loss 0.740, Loss_clf 0.421, Loss_aux 0.319, Train_accy 89.04:  10%|█         | 2/20 [03:50<33:36, 112.04s/it]
Task 5, Epoch 3/20 => Loss 0.645, Loss_clf 0.405, Loss_aux 0.240, Train_accy 89.08:  10%|█         | 2/20 [05:27<33:36, 112.04s/it]
Task 5, Epoch 3/20 => Loss 0.645, Loss_clf 0.405, Loss_aux 0.240, Train_accy 89.08:  15%|█▌        | 3/20 [05:27<29:42, 104.87s/it]
Task 5, Epoch 4/20 => Loss 0.589, Loss_clf 0.382, Loss_aux 0.207, Train_accy 90.03:  15%|█▌        | 3/20 [07:03<29:42, 104.87s/it]
Task 5, Epoch 4/20 => Loss 0.589, Loss_clf 0.382, Loss_aux 0.207, Train_accy 90.03:  20%|██        | 4/20 [07:03<27:03, 101.46s/it]
Task 5, Epoch 5/20 => Loss 0.571, Loss_clf 0.363, Loss_aux 0.207, Train_accy 90.64:  20%|██        | 4/20 [08:39<27:03, 101.46s/it]
Task 5, Epoch 5/20 => Loss 0.571, Loss_clf 0.363, Loss_aux 0.207, Train_accy 90.64:  25%|██▌       | 5/20 [08:39<24:53, 99.57s/it] 
Task 5, Epoch 6/20 => Loss 0.497, Loss_clf 0.342, Loss_aux 0.155, Train_accy 90.82, Test_accy 83.67:  25%|██▌       | 5/20 [10:54<24:53, 99.57s/it]
Task 5, Epoch 6/20 => Loss 0.497, Loss_clf 0.342, Loss_aux 0.155, Train_accy 90.82, Test_accy 83.67:  30%|███       | 6/20 [10:54<26:03, 111.66s/it]
Task 5, Epoch 7/20 => Loss 0.491, Loss_clf 0.329, Loss_aux 0.162, Train_accy 90.99:  30%|███       | 6/20 [12:30<26:03, 111.66s/it]                 
Task 5, Epoch 7/20 => Loss 0.491, Loss_clf 0.329, Loss_aux 0.162, Train_accy 90.99:  35%|███▌      | 7/20 [12:30<23:05, 106.56s/it]
Task 5, Epoch 8/20 => Loss 0.484, Loss_clf 0.323, Loss_aux 0.161, Train_accy 91.52:  35%|███▌      | 7/20 [14:06<23:05, 106.56s/it]
Task 5, Epoch 8/20 => Loss 0.484, Loss_clf 0.323, Loss_aux 0.161, Train_accy 91.52:  40%|████      | 8/20 [14:06<20:38, 103.17s/it]
Task 5, Epoch 9/20 => Loss 0.432, Loss_clf 0.307, Loss_aux 0.124, Train_accy 92.14:  40%|████      | 8/20 [15:42<20:38, 103.17s/it]
Task 5, Epoch 9/20 => Loss 0.432, Loss_clf 0.307, Loss_aux 0.124, Train_accy 92.14:  45%|████▌     | 9/20 [15:42<18:29, 100.85s/it]
Task 5, Epoch 10/20 => Loss 0.430, Loss_clf 0.296, Loss_aux 0.133, Train_accy 92.46:  45%|████▌     | 9/20 [17:18<18:29, 100.85s/it]
Task 5, Epoch 10/20 => Loss 0.430, Loss_clf 0.296, Loss_aux 0.133, Train_accy 92.46:  50%|█████     | 10/20 [17:18<16:33, 99.31s/it]
Task 5, Epoch 11/20 => Loss 0.445, Loss_clf 0.321, Loss_aux 0.124, Train_accy 91.72, Test_accy 84.14:  50%|█████     | 10/20 [19:33<16:33, 99.31s/it]
Task 5, Epoch 11/20 => Loss 0.445, Loss_clf 0.321, Loss_aux 0.124, Train_accy 91.72, Test_accy 84.14:  55%|█████▌    | 11/20 [19:33<16:31, 110.16s/it]
Task 5, Epoch 12/20 => Loss 0.418, Loss_clf 0.298, Loss_aux 0.120, Train_accy 92.44:  55%|█████▌    | 11/20 [21:08<16:31, 110.16s/it]                 
Task 5, Epoch 12/20 => Loss 0.418, Loss_clf 0.298, Loss_aux 0.120, Train_accy 92.44:  60%|██████    | 12/20 [21:08<14:06, 105.78s/it]
Task 5, Epoch 13/20 => Loss 0.433, Loss_clf 0.302, Loss_aux 0.130, Train_accy 92.31:  60%|██████    | 12/20 [22:44<14:06, 105.78s/it]
Task 5, Epoch 13/20 => Loss 0.433, Loss_clf 0.302, Loss_aux 0.130, Train_accy 92.31:  65%|██████▌   | 13/20 [22:44<11:59, 102.72s/it]
Task 5, Epoch 14/20 => Loss 0.417, Loss_clf 0.303, Loss_aux 0.113, Train_accy 92.36:  65%|██████▌   | 13/20 [24:20<11:59, 102.72s/it]
Task 5, Epoch 14/20 => Loss 0.417, Loss_clf 0.303, Loss_aux 0.113, Train_accy 92.36:  70%|███████   | 14/20 [24:20<10:04, 100.69s/it]
Task 5, Epoch 15/20 => Loss 0.443, Loss_clf 0.313, Loss_aux 0.130, Train_accy 92.05:  70%|███████   | 14/20 [25:56<10:04, 100.69s/it]
Task 5, Epoch 15/20 => Loss 0.443, Loss_clf 0.313, Loss_aux 0.130, Train_accy 92.05:  75%|███████▌  | 15/20 [25:56<08:16, 99.25s/it] 
Task 5, Epoch 16/20 => Loss 0.439, Loss_clf 0.321, Loss_aux 0.118, Train_accy 92.07, Test_accy 84.39:  75%|███████▌  | 15/20 [28:11<08:16, 99.25s/it]
Task 5, Epoch 16/20 => Loss 0.439, Loss_clf 0.321, Loss_aux 0.118, Train_accy 92.07, Test_accy 84.39:  80%|████████  | 16/20 [28:11<07:19, 109.95s/it]
Task 5, Epoch 17/20 => Loss 0.388, Loss_clf 0.278, Loss_aux 0.110, Train_accy 92.93:  80%|████████  | 16/20 [29:47<07:19, 109.95s/it]                 
Task 5, Epoch 17/20 => Loss 0.388, Loss_clf 0.278, Loss_aux 0.110, Train_accy 92.93:  85%|████████▌ | 17/20 [29:47<05:17, 105.73s/it]
Task 5, Epoch 18/20 => Loss 0.403, Loss_clf 0.289, Loss_aux 0.114, Train_accy 92.40:  85%|████████▌ | 17/20 [31:23<05:17, 105.73s/it]
Task 5, Epoch 18/20 => Loss 0.403, Loss_clf 0.289, Loss_aux 0.114, Train_accy 92.40:  90%|█████████ | 18/20 [31:23<03:25, 102.80s/it]
Task 5, Epoch 19/20 => Loss 0.390, Loss_clf 0.278, Loss_aux 0.112, Train_accy 92.82:  90%|█████████ | 18/20 [32:59<03:25, 102.80s/it]
Task 5, Epoch 19/20 => Loss 0.390, Loss_clf 0.278, Loss_aux 0.112, Train_accy 92.82:  95%|█████████▌| 19/20 [32:59<01:40, 100.81s/it]
Task 5, Epoch 20/20 => Loss 0.394, Loss_clf 0.283, Loss_aux 0.110, Train_accy 92.77:  95%|█████████▌| 19/20 [34:35<01:40, 100.81s/it]
Task 5, Epoch 20/20 => Loss 0.394, Loss_clf 0.283, Loss_aux 0.110, Train_accy 92.77: 100%|██████████| 20/20 [34:35<00:00, 99.42s/it] 
Task 5, Epoch 20/20 => Loss 0.394, Loss_clf 0.283, Loss_aux 0.110, Train_accy 92.77: 100%|██████████| 20/20 [34:35<00:00, 103.78s/it]2024-09-13 06:24:36,375 [der.py] => Task 5, Epoch 20/20 => Loss 0.394, Loss_clf 0.283, Loss_aux 0.110, Train_accy 92.77
2024-09-13 06:24:36,377 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 06:28:52,258 [der.py] => Exemplar size: 4000
2024-09-13 06:28:52,258 [trainer.py] => CNN: {'total': 85.03, '00-99': 82.07, '100-119': 85.96, '120-139': 82.67, '140-159': 90.4, '160-179': 89.03, '180-199': 91.74, 'old': 84.3, 'new': 91.74}
2024-09-13 06:28:52,258 [trainer.py] => NME: {'total': 87.11, '00-99': 86.45, '100-119': 87.72, '120-139': 86.22, '140-159': 90.0, '160-179': 88.61, '180-199': 86.09, 'old': 87.22, 'new': 86.09}
2024-09-13 06:28:52,258 [trainer.py] => CNN top1 curve: [88.72, 89.12, 88.06, 86.73, 86.0, 85.03]
2024-09-13 06:28:52,258 [trainer.py] => CNN top5 curve: [98.4, 98.23, 97.62, 97.3, 96.9, 96.4]
2024-09-13 06:28:52,258 [trainer.py] => NME top1 curve: [90.99, 89.55, 88.18, 88.52, 87.83, 87.11]
2024-09-13 06:28:52,258 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.48, 98.52, 98.21, 97.71]

Average Accuracy (CNN): 87.28
Average Accuracy (NME): 88.7
2024-09-13 06:28:52,259 [trainer.py] => Average Accuracy (CNN): 87.28
2024-09-13 06:28:52,259 [trainer.py] => Average Accuracy (NME): 88.7
Accuracy Matrix (CNN):
[[88.72 88.55 86.7  85.1  84.09 82.07]
 [ 0.   92.11 91.67 87.72 88.16 85.96]
 [ 0.    0.   91.56 87.56 85.33 82.67]
 [ 0.    0.    0.   92.8  86.   90.4 ]
 [ 0.    0.    0.    0.   94.09 89.03]
 [ 0.    0.    0.    0.    0.   91.74]]
2024-09-13 06:28:52,259 [trainer.py] => Forgetting (CNN): 5.830000000000001
Accuracy Matrix (NME):
[[90.99 89.14 88.38 88.22 87.46 86.45]
 [ 0.   91.67 90.35 89.47 88.16 87.72]
 [ 0.    0.   84.89 87.11 87.56 86.22]
 [ 0.    0.    0.   90.4  88.8  90.  ]
 [ 0.    0.    0.    0.   88.61 88.61]
 [ 0.    0.    0.    0.    0.   86.09]]
2024-09-13 06:28:52,260 [trainer.py] => Forgetting (NME): 2.0460000000000007
2024-09-13 06:28:54,519 [trainer.py] => config: ./exps/der_cub_B100_Inc10.json
2024-09-13 06:28:54,535 [trainer.py] => prefix: reproduce
2024-09-13 06:28:54,535 [trainer.py] => dataset: cub
2024-09-13 06:28:54,535 [trainer.py] => memory_size: 2000
2024-09-13 06:28:54,535 [trainer.py] => memory_per_class: 20
2024-09-13 06:28:54,535 [trainer.py] => fixed_memory: True
2024-09-13 06:28:54,535 [trainer.py] => shuffle: True
2024-09-13 06:28:54,535 [trainer.py] => init_cls: 100
2024-09-13 06:28:54,536 [trainer.py] => increment: 10
2024-09-13 06:28:54,536 [trainer.py] => model_name: der
2024-09-13 06:28:54,536 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-13 06:28:54,536 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 06:28:54,536 [trainer.py] => seed: 1993
2024-09-13 06:28:54,536 [trainer.py] => init_epoch: 20
2024-09-13 06:28:54,536 [trainer.py] => init_lr: 0.001
2024-09-13 06:28:54,536 [trainer.py] => init_milestones: [60, 120, 170]
2024-09-13 06:28:54,536 [trainer.py] => init_lr_decay: 0.1
2024-09-13 06:28:54,536 [trainer.py] => init_weight_decay: 0.0005
2024-09-13 06:28:54,536 [trainer.py] => epochs: 20
2024-09-13 06:28:54,537 [trainer.py] => lrate: 0.001
2024-09-13 06:28:54,537 [trainer.py] => milestones: [80, 120, 150]
2024-09-13 06:28:54,537 [trainer.py] => lrate_decay: 0.1
2024-09-13 06:28:54,537 [trainer.py] => batch_size: 48
2024-09-13 06:28:54,537 [trainer.py] => weight_decay: 0.0002
2024-09-13 06:28:54,537 [trainer.py] => T: 2
2024-09-13 06:28:54,595 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 06:28:55,134 [trainer.py] => All params: 0
2024-09-13 06:28:55,134 [trainer.py] => Trainable params: 0
2024-09-13 06:28:57,931 [der.py] => Learning on 0-100
2024-09-13 06:28:57,932 [der.py] => All params: 85953225
2024-09-13 06:28:57,933 [der.py] => Trainable params: 85953225

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.810, Train_accy 35.60, Test_accy 82.41:   0%|          | 0/20 [00:40<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.810, Train_accy 35.60, Test_accy 82.41:   5%|▌         | 1/20 [00:40<12:47, 40.39s/it]
Task 0, Epoch 2/20 => Loss 0.903, Train_accy 75.35:   5%|▌         | 1/20 [01:16<12:47, 40.39s/it]                 
Task 0, Epoch 2/20 => Loss 0.903, Train_accy 75.35:  10%|█         | 2/20 [01:16<11:24, 38.02s/it]
Task 0, Epoch 3/20 => Loss 0.688, Train_accy 80.57:  10%|█         | 2/20 [01:53<11:24, 38.02s/it]
Task 0, Epoch 3/20 => Loss 0.688, Train_accy 80.57:  15%|█▌        | 3/20 [01:53<10:32, 37.22s/it]
Task 0, Epoch 4/20 => Loss 0.612, Train_accy 83.68:  15%|█▌        | 3/20 [02:29<10:32, 37.22s/it]
Task 0, Epoch 4/20 => Loss 0.612, Train_accy 83.68:  20%|██        | 4/20 [02:29<09:50, 36.89s/it]
Task 0, Epoch 5/20 => Loss 0.540, Train_accy 85.22:  20%|██        | 4/20 [03:05<09:50, 36.89s/it]
Task 0, Epoch 5/20 => Loss 0.540, Train_accy 85.22:  25%|██▌       | 5/20 [03:05<09:10, 36.72s/it]
Task 0, Epoch 6/20 => Loss 0.536, Train_accy 85.79, Test_accy 89.48:  25%|██▌       | 5/20 [03:46<09:10, 36.72s/it]
Task 0, Epoch 6/20 => Loss 0.536, Train_accy 85.79, Test_accy 89.48:  30%|███       | 6/20 [03:46<08:50, 37.90s/it]
Task 0, Epoch 7/20 => Loss 0.494, Train_accy 86.54:  30%|███       | 6/20 [04:22<08:50, 37.90s/it]                 
Task 0, Epoch 7/20 => Loss 0.494, Train_accy 86.54:  35%|███▌      | 7/20 [04:22<08:05, 37.35s/it]
Task 0, Epoch 8/20 => Loss 0.454, Train_accy 87.81:  35%|███▌      | 7/20 [04:58<08:05, 37.35s/it]
Task 0, Epoch 8/20 => Loss 0.454, Train_accy 87.81:  40%|████      | 8/20 [04:58<07:23, 36.93s/it]
Task 0, Epoch 9/20 => Loss 0.421, Train_accy 88.96:  40%|████      | 8/20 [05:34<07:23, 36.93s/it]
Task 0, Epoch 9/20 => Loss 0.421, Train_accy 88.96:  45%|████▌     | 9/20 [05:34<06:44, 36.74s/it]
Task 0, Epoch 10/20 => Loss 0.425, Train_accy 88.47:  45%|████▌     | 9/20 [06:10<06:44, 36.74s/it]
Task 0, Epoch 10/20 => Loss 0.425, Train_accy 88.47:  50%|█████     | 10/20 [06:10<06:05, 36.56s/it]
Task 0, Epoch 11/20 => Loss 0.422, Train_accy 88.33, Test_accy 89.23:  50%|█████     | 10/20 [06:50<06:05, 36.56s/it]
Task 0, Epoch 11/20 => Loss 0.422, Train_accy 88.33, Test_accy 89.23:  55%|█████▌    | 11/20 [06:50<05:38, 37.67s/it]
Task 0, Epoch 12/20 => Loss 0.394, Train_accy 89.16:  55%|█████▌    | 11/20 [07:27<05:38, 37.67s/it]                 
Task 0, Epoch 12/20 => Loss 0.394, Train_accy 89.16:  60%|██████    | 12/20 [07:27<04:57, 37.23s/it]
Task 0, Epoch 13/20 => Loss 0.367, Train_accy 89.86:  60%|██████    | 12/20 [08:03<04:57, 37.23s/it]
Task 0, Epoch 13/20 => Loss 0.367, Train_accy 89.86:  65%|██████▌   | 13/20 [08:03<04:18, 36.93s/it]
Task 0, Epoch 14/20 => Loss 0.371, Train_accy 89.97:  65%|██████▌   | 13/20 [08:39<04:18, 36.93s/it]
Task 0, Epoch 14/20 => Loss 0.371, Train_accy 89.97:  70%|███████   | 14/20 [08:39<03:40, 36.80s/it]
Task 0, Epoch 15/20 => Loss 0.369, Train_accy 90.01:  70%|███████   | 14/20 [09:16<03:40, 36.80s/it]
Task 0, Epoch 15/20 => Loss 0.369, Train_accy 90.01:  75%|███████▌  | 15/20 [09:16<03:03, 36.67s/it]
Task 0, Epoch 16/20 => Loss 0.360, Train_accy 90.18, Test_accy 89.65:  75%|███████▌  | 15/20 [09:56<03:03, 36.67s/it]
Task 0, Epoch 16/20 => Loss 0.360, Train_accy 90.18, Test_accy 89.65:  80%|████████  | 16/20 [09:56<02:31, 37.87s/it]
Task 0, Epoch 17/20 => Loss 0.376, Train_accy 89.94:  80%|████████  | 16/20 [10:33<02:31, 37.87s/it]                 
Task 0, Epoch 17/20 => Loss 0.376, Train_accy 89.94:  85%|████████▌ | 17/20 [10:33<01:52, 37.49s/it]
Task 0, Epoch 18/20 => Loss 0.346, Train_accy 90.75:  85%|████████▌ | 17/20 [11:10<01:52, 37.49s/it]
Task 0, Epoch 18/20 => Loss 0.346, Train_accy 90.75:  90%|█████████ | 18/20 [11:10<01:14, 37.21s/it]
Task 0, Epoch 19/20 => Loss 0.304, Train_accy 91.93:  90%|█████████ | 18/20 [11:46<01:14, 37.21s/it]
Task 0, Epoch 19/20 => Loss 0.304, Train_accy 91.93:  95%|█████████▌| 19/20 [11:46<00:36, 36.93s/it]
Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71:  95%|█████████▌| 19/20 [12:22<00:36, 36.93s/it]
Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71: 100%|██████████| 20/20 [12:22<00:00, 36.73s/it]
Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71: 100%|██████████| 20/20 [12:22<00:00, 37.13s/it]2024-09-13 06:41:21,069 [der.py] => Task 0, Epoch 20/20 => Loss 0.346, Train_accy 90.71
2024-09-13 06:41:21,070 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 06:43:08,599 [der.py] => Exemplar size: 2000
2024-09-13 06:43:08,600 [trainer.py] => CNN: {'total': 88.72, '00-99': 88.72, 'old': 0, 'new': 88.72}
2024-09-13 06:43:08,600 [trainer.py] => NME: {'total': 90.99, '00-99': 90.99, 'old': 0, 'new': 90.99}
2024-09-13 06:43:08,600 [trainer.py] => CNN top1 curve: [88.72]
2024-09-13 06:43:08,600 [trainer.py] => CNN top5 curve: [98.4]
2024-09-13 06:43:08,600 [trainer.py] => NME top1 curve: [90.99]
2024-09-13 06:43:08,600 [trainer.py] => NME top5 curve: [98.91]

Average Accuracy (CNN): 88.72
Average Accuracy (NME): 90.99
2024-09-13 06:43:08,600 [trainer.py] => Average Accuracy (CNN): 88.72
2024-09-13 06:43:08,600 [trainer.py] => Average Accuracy (NME): 90.99
2024-09-13 06:43:08,601 [trainer.py] => All params: 85953225
2024-09-13 06:43:08,601 [trainer.py] => Trainable params: 85953225
2024-09-13 06:43:10,302 [der.py] => Learning on 100-110
2024-09-13 06:43:10,304 [der.py] => All params: 171774841
2024-09-13 06:43:10,305 [der.py] => Trainable params: 85976185

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.728, Loss_clf 1.035, Loss_aux 0.693, Train_accy 81.14, Test_accy 88.26:   0%|          | 0/20 [00:33<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.728, Loss_clf 1.035, Loss_aux 0.693, Train_accy 81.14, Test_accy 88.26:   5%|▌         | 1/20 [00:33<10:31, 33.24s/it]
Task 1, Epoch 2/20 => Loss 0.519, Loss_clf 0.340, Loss_aux 0.179, Train_accy 90.57:   5%|▌         | 1/20 [00:59<10:31, 33.24s/it]                 
Task 1, Epoch 2/20 => Loss 0.519, Loss_clf 0.340, Loss_aux 0.179, Train_accy 90.57:  10%|█         | 2/20 [00:59<08:39, 28.87s/it]
Task 1, Epoch 3/20 => Loss 0.510, Loss_clf 0.354, Loss_aux 0.156, Train_accy 90.77:  10%|█         | 2/20 [01:24<08:39, 28.87s/it]
Task 1, Epoch 3/20 => Loss 0.510, Loss_clf 0.354, Loss_aux 0.156, Train_accy 90.77:  15%|█▌        | 3/20 [01:24<07:47, 27.51s/it]
Task 1, Epoch 4/20 => Loss 0.432, Loss_clf 0.314, Loss_aux 0.118, Train_accy 91.41:  15%|█▌        | 3/20 [01:50<07:47, 27.51s/it]
Task 1, Epoch 4/20 => Loss 0.432, Loss_clf 0.314, Loss_aux 0.118, Train_accy 91.41:  20%|██        | 4/20 [01:50<07:10, 26.93s/it]
Task 1, Epoch 5/20 => Loss 0.361, Loss_clf 0.258, Loss_aux 0.103, Train_accy 92.70:  20%|██        | 4/20 [02:16<07:10, 26.93s/it]
Task 1, Epoch 5/20 => Loss 0.361, Loss_clf 0.258, Loss_aux 0.103, Train_accy 92.70:  25%|██▌       | 5/20 [02:16<06:38, 26.59s/it]
Task 1, Epoch 6/20 => Loss 0.446, Loss_clf 0.335, Loss_aux 0.111, Train_accy 91.25, Test_accy 89.33:  25%|██▌       | 5/20 [02:50<06:38, 26.59s/it]
Task 1, Epoch 6/20 => Loss 0.446, Loss_clf 0.335, Loss_aux 0.111, Train_accy 91.25, Test_accy 89.33:  30%|███       | 6/20 [02:50<06:46, 29.01s/it]
Task 1, Epoch 7/20 => Loss 0.415, Loss_clf 0.300, Loss_aux 0.115, Train_accy 91.74:  30%|███       | 6/20 [03:16<06:46, 29.01s/it]                 
Task 1, Epoch 7/20 => Loss 0.415, Loss_clf 0.300, Loss_aux 0.115, Train_accy 91.74:  35%|███▌      | 7/20 [03:16<06:05, 28.08s/it]
Task 1, Epoch 8/20 => Loss 0.363, Loss_clf 0.276, Loss_aux 0.087, Train_accy 93.07:  35%|███▌      | 7/20 [03:43<06:05, 28.08s/it]
Task 1, Epoch 8/20 => Loss 0.363, Loss_clf 0.276, Loss_aux 0.087, Train_accy 93.07:  40%|████      | 8/20 [03:43<05:29, 27.48s/it]
Task 1, Epoch 9/20 => Loss 0.365, Loss_clf 0.278, Loss_aux 0.087, Train_accy 92.99:  40%|████      | 8/20 [04:08<05:29, 27.48s/it]
Task 1, Epoch 9/20 => Loss 0.365, Loss_clf 0.278, Loss_aux 0.087, Train_accy 92.99:  45%|████▌     | 9/20 [04:08<04:56, 27.00s/it]
Task 1, Epoch 10/20 => Loss 0.371, Loss_clf 0.292, Loss_aux 0.078, Train_accy 92.22:  45%|████▌     | 9/20 [04:35<04:56, 27.00s/it]
Task 1, Epoch 10/20 => Loss 0.371, Loss_clf 0.292, Loss_aux 0.078, Train_accy 92.22:  50%|█████     | 10/20 [04:35<04:27, 26.77s/it]
Task 1, Epoch 11/20 => Loss 0.350, Loss_clf 0.278, Loss_aux 0.072, Train_accy 92.87, Test_accy 90.02:  50%|█████     | 10/20 [05:09<04:27, 26.77s/it]
Task 1, Epoch 11/20 => Loss 0.350, Loss_clf 0.278, Loss_aux 0.072, Train_accy 92.87, Test_accy 90.02:  55%|█████▌    | 11/20 [05:09<04:21, 29.02s/it]
Task 1, Epoch 12/20 => Loss 0.368, Loss_clf 0.285, Loss_aux 0.084, Train_accy 92.18:  55%|█████▌    | 11/20 [05:35<04:21, 29.02s/it]                 
Task 1, Epoch 12/20 => Loss 0.368, Loss_clf 0.285, Loss_aux 0.084, Train_accy 92.18:  60%|██████    | 12/20 [05:35<03:45, 28.18s/it]
Task 1, Epoch 13/20 => Loss 0.317, Loss_clf 0.253, Loss_aux 0.064, Train_accy 93.55:  60%|██████    | 12/20 [06:01<03:45, 28.18s/it]
Task 1, Epoch 13/20 => Loss 0.317, Loss_clf 0.253, Loss_aux 0.064, Train_accy 93.55:  65%|██████▌   | 13/20 [06:01<03:12, 27.53s/it]
Task 1, Epoch 14/20 => Loss 0.333, Loss_clf 0.255, Loss_aux 0.078, Train_accy 93.19:  65%|██████▌   | 13/20 [06:27<03:12, 27.53s/it]
Task 1, Epoch 14/20 => Loss 0.333, Loss_clf 0.255, Loss_aux 0.078, Train_accy 93.19:  70%|███████   | 14/20 [06:27<02:42, 27.07s/it]
Task 1, Epoch 15/20 => Loss 0.376, Loss_clf 0.285, Loss_aux 0.091, Train_accy 92.38:  70%|███████   | 14/20 [06:53<02:42, 27.07s/it]
Task 1, Epoch 15/20 => Loss 0.376, Loss_clf 0.285, Loss_aux 0.091, Train_accy 92.38:  75%|███████▌  | 15/20 [06:53<02:13, 26.76s/it]
Task 1, Epoch 16/20 => Loss 0.333, Loss_clf 0.266, Loss_aux 0.068, Train_accy 92.95, Test_accy 89.49:  75%|███████▌  | 15/20 [07:27<02:13, 26.76s/it]
Task 1, Epoch 16/20 => Loss 0.333, Loss_clf 0.266, Loss_aux 0.068, Train_accy 92.95, Test_accy 89.49:  80%|████████  | 16/20 [07:27<01:55, 28.91s/it]
Task 1, Epoch 17/20 => Loss 0.317, Loss_clf 0.253, Loss_aux 0.065, Train_accy 93.31:  80%|████████  | 16/20 [07:53<01:55, 28.91s/it]                 
Task 1, Epoch 17/20 => Loss 0.317, Loss_clf 0.253, Loss_aux 0.065, Train_accy 93.31:  85%|████████▌ | 17/20 [07:53<01:24, 28.03s/it]
Task 1, Epoch 18/20 => Loss 0.338, Loss_clf 0.259, Loss_aux 0.079, Train_accy 93.19:  85%|████████▌ | 17/20 [08:19<01:24, 28.03s/it]
Task 1, Epoch 18/20 => Loss 0.338, Loss_clf 0.259, Loss_aux 0.079, Train_accy 93.19:  90%|█████████ | 18/20 [08:19<00:54, 27.47s/it]
Task 1, Epoch 19/20 => Loss 0.369, Loss_clf 0.293, Loss_aux 0.076, Train_accy 91.98:  90%|█████████ | 18/20 [08:45<00:54, 27.47s/it]
Task 1, Epoch 19/20 => Loss 0.369, Loss_clf 0.293, Loss_aux 0.076, Train_accy 91.98:  95%|█████████▌| 19/20 [08:45<00:27, 27.06s/it]
Task 1, Epoch 20/20 => Loss 0.323, Loss_clf 0.264, Loss_aux 0.059, Train_accy 92.99:  95%|█████████▌| 19/20 [09:11<00:27, 27.06s/it]
Task 1, Epoch 20/20 => Loss 0.323, Loss_clf 0.264, Loss_aux 0.059, Train_accy 92.99: 100%|██████████| 20/20 [09:11<00:00, 26.76s/it]
Task 1, Epoch 20/20 => Loss 0.323, Loss_clf 0.264, Loss_aux 0.059, Train_accy 92.99: 100%|██████████| 20/20 [09:11<00:00, 27.60s/it]2024-09-13 06:52:22,264 [der.py] => Task 1, Epoch 20/20 => Loss 0.323, Loss_clf 0.264, Loss_aux 0.059, Train_accy 92.99
2024-09-13 06:52:22,265 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 06:53:35,738 [der.py] => Exemplar size: 2200
2024-09-13 06:53:35,738 [trainer.py] => CNN: {'total': 89.49, '00-99': 88.89, '100-109': 95.65, 'old': 88.89, 'new': 95.65}
2024-09-13 06:53:35,738 [trainer.py] => NME: {'total': 91.4, '00-99': 91.33, '100-109': 92.17, 'old': 91.33, 'new': 92.17}
2024-09-13 06:53:35,738 [trainer.py] => CNN top1 curve: [88.72, 89.49]
2024-09-13 06:53:35,738 [trainer.py] => CNN top5 curve: [98.4, 98.08]
2024-09-13 06:53:35,738 [trainer.py] => NME top1 curve: [90.99, 91.4]
2024-09-13 06:53:35,738 [trainer.py] => NME top5 curve: [98.91, 98.85]

Average Accuracy (CNN): 89.1
Average Accuracy (NME): 91.2
2024-09-13 06:53:35,738 [trainer.py] => Average Accuracy (CNN): 89.1
2024-09-13 06:53:35,738 [trainer.py] => Average Accuracy (NME): 91.2
2024-09-13 06:53:35,739 [trainer.py] => All params: 171774841
2024-09-13 06:53:35,740 [trainer.py] => Trainable params: 85976185
2024-09-13 06:53:38,350 [der.py] => Learning on 110-120
2024-09-13 06:53:38,352 [der.py] => All params: 257681027
2024-09-13 06:53:38,354 [der.py] => Trainable params: 86083715

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.663, Loss_clf 1.027, Loss_aux 0.636, Train_accy 81.69, Test_accy 87.22:   0%|          | 0/20 [00:46<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.663, Loss_clf 1.027, Loss_aux 0.636, Train_accy 81.69, Test_accy 87.22:   5%|▌         | 1/20 [00:46<14:50, 46.87s/it]
Task 2, Epoch 2/20 => Loss 0.592, Loss_clf 0.371, Loss_aux 0.221, Train_accy 89.40:   5%|▌         | 1/20 [01:21<14:50, 46.87s/it]                 
Task 2, Epoch 2/20 => Loss 0.592, Loss_clf 0.371, Loss_aux 0.221, Train_accy 89.40:  10%|█         | 2/20 [01:21<11:57, 39.85s/it]
Task 2, Epoch 3/20 => Loss 0.500, Loss_clf 0.342, Loss_aux 0.159, Train_accy 90.27:  10%|█         | 2/20 [01:56<11:57, 39.85s/it]
Task 2, Epoch 3/20 => Loss 0.500, Loss_clf 0.342, Loss_aux 0.159, Train_accy 90.27:  15%|█▌        | 3/20 [01:56<10:40, 37.65s/it]
Task 2, Epoch 4/20 => Loss 0.459, Loss_clf 0.326, Loss_aux 0.134, Train_accy 90.83:  15%|█▌        | 3/20 [02:31<10:40, 37.65s/it]
Task 2, Epoch 4/20 => Loss 0.459, Loss_clf 0.326, Loss_aux 0.134, Train_accy 90.83:  20%|██        | 4/20 [02:31<09:46, 36.63s/it]
Task 2, Epoch 5/20 => Loss 0.470, Loss_clf 0.340, Loss_aux 0.130, Train_accy 90.19:  20%|██        | 4/20 [03:06<09:46, 36.63s/it]
Task 2, Epoch 5/20 => Loss 0.470, Loss_clf 0.340, Loss_aux 0.130, Train_accy 90.19:  25%|██▌       | 5/20 [03:06<09:00, 36.04s/it]
Task 2, Epoch 6/20 => Loss 0.414, Loss_clf 0.312, Loss_aux 0.102, Train_accy 91.35, Test_accy 87.85:  25%|██▌       | 5/20 [03:54<09:00, 36.04s/it]
Task 2, Epoch 6/20 => Loss 0.414, Loss_clf 0.312, Loss_aux 0.102, Train_accy 91.35, Test_accy 87.85:  30%|███       | 6/20 [03:54<09:18, 39.88s/it]
Task 2, Epoch 7/20 => Loss 0.401, Loss_clf 0.294, Loss_aux 0.106, Train_accy 92.25:  30%|███       | 6/20 [04:29<09:18, 39.88s/it]                 
Task 2, Epoch 7/20 => Loss 0.401, Loss_clf 0.294, Loss_aux 0.106, Train_accy 92.25:  35%|███▌      | 7/20 [04:29<08:18, 38.36s/it]
Task 2, Epoch 8/20 => Loss 0.339, Loss_clf 0.258, Loss_aux 0.082, Train_accy 93.19:  35%|███▌      | 7/20 [05:04<08:18, 38.36s/it]
Task 2, Epoch 8/20 => Loss 0.339, Loss_clf 0.258, Loss_aux 0.082, Train_accy 93.19:  40%|████      | 8/20 [05:04<07:28, 37.34s/it]
Task 2, Epoch 9/20 => Loss 0.363, Loss_clf 0.275, Loss_aux 0.088, Train_accy 92.62:  40%|████      | 8/20 [05:39<07:28, 37.34s/it]
Task 2, Epoch 9/20 => Loss 0.363, Loss_clf 0.275, Loss_aux 0.088, Train_accy 92.62:  45%|████▌     | 9/20 [05:39<06:43, 36.65s/it]
Task 2, Epoch 10/20 => Loss 0.396, Loss_clf 0.290, Loss_aux 0.107, Train_accy 92.10:  45%|████▌     | 9/20 [06:14<06:43, 36.65s/it]
Task 2, Epoch 10/20 => Loss 0.396, Loss_clf 0.290, Loss_aux 0.107, Train_accy 92.10:  50%|█████     | 10/20 [06:14<06:02, 36.21s/it]
Task 2, Epoch 11/20 => Loss 0.348, Loss_clf 0.271, Loss_aux 0.077, Train_accy 92.29, Test_accy 89.27:  50%|█████     | 10/20 [07:02<06:02, 36.21s/it]
Task 2, Epoch 11/20 => Loss 0.348, Loss_clf 0.271, Loss_aux 0.077, Train_accy 92.29, Test_accy 89.27:  55%|█████▌    | 11/20 [07:02<05:57, 39.67s/it]
Task 2, Epoch 12/20 => Loss 0.378, Loss_clf 0.278, Loss_aux 0.100, Train_accy 92.51:  55%|█████▌    | 11/20 [07:37<05:57, 39.67s/it]                 
Task 2, Epoch 12/20 => Loss 0.378, Loss_clf 0.278, Loss_aux 0.100, Train_accy 92.51:  60%|██████    | 12/20 [07:37<05:06, 38.26s/it]
Task 2, Epoch 13/20 => Loss 0.373, Loss_clf 0.279, Loss_aux 0.094, Train_accy 92.59:  60%|██████    | 12/20 [08:12<05:06, 38.26s/it]
Task 2, Epoch 13/20 => Loss 0.373, Loss_clf 0.279, Loss_aux 0.094, Train_accy 92.59:  65%|██████▌   | 13/20 [08:12<04:21, 37.36s/it]
Task 2, Epoch 14/20 => Loss 0.306, Loss_clf 0.235, Loss_aux 0.071, Train_accy 93.79:  65%|██████▌   | 13/20 [08:48<04:21, 37.36s/it]
Task 2, Epoch 14/20 => Loss 0.306, Loss_clf 0.235, Loss_aux 0.071, Train_accy 93.79:  70%|███████   | 14/20 [08:48<03:40, 36.70s/it]
Task 2, Epoch 15/20 => Loss 0.333, Loss_clf 0.266, Loss_aux 0.067, Train_accy 92.62:  70%|███████   | 14/20 [09:23<03:40, 36.70s/it]
Task 2, Epoch 15/20 => Loss 0.333, Loss_clf 0.266, Loss_aux 0.067, Train_accy 92.62:  75%|███████▌  | 15/20 [09:23<03:01, 36.30s/it]
Task 2, Epoch 16/20 => Loss 0.318, Loss_clf 0.258, Loss_aux 0.060, Train_accy 92.85, Test_accy 88.98:  75%|███████▌  | 15/20 [10:10<03:01, 36.30s/it]
Task 2, Epoch 16/20 => Loss 0.318, Loss_clf 0.258, Loss_aux 0.060, Train_accy 92.85, Test_accy 88.98:  80%|████████  | 16/20 [10:10<02:38, 39.64s/it]
Task 2, Epoch 17/20 => Loss 0.326, Loss_clf 0.256, Loss_aux 0.070, Train_accy 93.22:  80%|████████  | 16/20 [10:46<02:38, 39.64s/it]                 
Task 2, Epoch 17/20 => Loss 0.326, Loss_clf 0.256, Loss_aux 0.070, Train_accy 93.22:  85%|████████▌ | 17/20 [10:46<01:54, 38.32s/it]
Task 2, Epoch 18/20 => Loss 0.315, Loss_clf 0.257, Loss_aux 0.058, Train_accy 93.15:  85%|████████▌ | 17/20 [11:21<01:54, 38.32s/it]
Task 2, Epoch 18/20 => Loss 0.315, Loss_clf 0.257, Loss_aux 0.058, Train_accy 93.15:  90%|█████████ | 18/20 [11:21<01:14, 37.40s/it]
Task 2, Epoch 19/20 => Loss 0.339, Loss_clf 0.266, Loss_aux 0.073, Train_accy 92.89:  90%|█████████ | 18/20 [11:56<01:14, 37.40s/it]
Task 2, Epoch 19/20 => Loss 0.339, Loss_clf 0.266, Loss_aux 0.073, Train_accy 92.89:  95%|█████████▌| 19/20 [11:56<00:36, 36.78s/it]
Task 2, Epoch 20/20 => Loss 0.316, Loss_clf 0.257, Loss_aux 0.059, Train_accy 93.56:  95%|█████████▌| 19/20 [12:32<00:36, 36.78s/it]
Task 2, Epoch 20/20 => Loss 0.316, Loss_clf 0.257, Loss_aux 0.059, Train_accy 93.56: 100%|██████████| 20/20 [12:32<00:00, 36.36s/it]
Task 2, Epoch 20/20 => Loss 0.316, Loss_clf 0.257, Loss_aux 0.059, Train_accy 93.56: 100%|██████████| 20/20 [12:32<00:00, 37.60s/it]2024-09-13 07:06:10,424 [der.py] => Task 2, Epoch 20/20 => Loss 0.316, Loss_clf 0.257, Loss_aux 0.059, Train_accy 93.56
2024-09-13 07:06:10,426 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 07:07:48,920 [der.py] => Exemplar size: 2400
2024-09-13 07:07:48,920 [trainer.py] => CNN: {'total': 89.34, '00-99': 88.8, '100-109': 94.78, '110-119': 89.38, 'old': 89.33, 'new': 89.38}
2024-09-13 07:07:48,920 [trainer.py] => NME: {'total': 89.83, '00-99': 89.9, '100-109': 92.17, '110-119': 86.73, 'old': 90.1, 'new': 86.73}
2024-09-13 07:07:48,920 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34]
2024-09-13 07:07:48,920 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16]
2024-09-13 07:07:48,920 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83]
2024-09-13 07:07:48,920 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59]

Average Accuracy (CNN): 89.18
Average Accuracy (NME): 90.74
2024-09-13 07:07:48,921 [trainer.py] => Average Accuracy (CNN): 89.18
2024-09-13 07:07:48,921 [trainer.py] => Average Accuracy (NME): 90.74
2024-09-13 07:07:48,923 [trainer.py] => All params: 257681027
2024-09-13 07:07:48,924 [trainer.py] => Trainable params: 86083715
2024-09-13 07:07:51,229 [der.py] => Learning on 120-130
2024-09-13 07:07:51,233 [der.py] => All params: 343602573
2024-09-13 07:07:51,235 [der.py] => Trainable params: 86206605

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.601, Loss_clf 0.925, Loss_aux 0.677, Train_accy 83.90, Test_accy 86.47:   0%|          | 0/20 [01:02<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.601, Loss_clf 0.925, Loss_aux 0.677, Train_accy 83.90, Test_accy 86.47:   5%|▌         | 1/20 [01:02<19:46, 62.47s/it]
Task 3, Epoch 2/20 => Loss 0.602, Loss_clf 0.394, Loss_aux 0.208, Train_accy 88.65:   5%|▌         | 1/20 [01:47<19:46, 62.47s/it]                 
Task 3, Epoch 2/20 => Loss 0.602, Loss_clf 0.394, Loss_aux 0.208, Train_accy 88.65:  10%|█         | 2/20 [01:47<15:44, 52.47s/it]
Task 3, Epoch 3/20 => Loss 0.471, Loss_clf 0.312, Loss_aux 0.159, Train_accy 91.39:  10%|█         | 2/20 [02:33<15:44, 52.47s/it]
Task 3, Epoch 3/20 => Loss 0.471, Loss_clf 0.312, Loss_aux 0.159, Train_accy 91.39:  15%|█▌        | 3/20 [02:33<14:00, 49.45s/it]
Task 3, Epoch 4/20 => Loss 0.440, Loss_clf 0.310, Loss_aux 0.130, Train_accy 91.64:  15%|█▌        | 3/20 [03:19<14:00, 49.45s/it]
Task 3, Epoch 4/20 => Loss 0.440, Loss_clf 0.310, Loss_aux 0.130, Train_accy 91.64:  20%|██        | 4/20 [03:19<12:47, 47.94s/it]
Task 3, Epoch 5/20 => Loss 0.469, Loss_clf 0.337, Loss_aux 0.132, Train_accy 90.46:  20%|██        | 4/20 [04:05<12:47, 47.94s/it]
Task 3, Epoch 5/20 => Loss 0.469, Loss_clf 0.337, Loss_aux 0.132, Train_accy 90.46:  25%|██▌       | 5/20 [04:05<11:46, 47.09s/it]
Task 3, Epoch 6/20 => Loss 0.476, Loss_clf 0.351, Loss_aux 0.125, Train_accy 90.46, Test_accy 87.39:  25%|██▌       | 5/20 [05:07<11:46, 47.09s/it]
Task 3, Epoch 6/20 => Loss 0.476, Loss_clf 0.351, Loss_aux 0.125, Train_accy 90.46, Test_accy 87.39:  30%|███       | 6/20 [05:07<12:13, 52.40s/it]
Task 3, Epoch 7/20 => Loss 0.434, Loss_clf 0.304, Loss_aux 0.129, Train_accy 91.57:  30%|███       | 6/20 [05:53<12:13, 52.40s/it]                 
Task 3, Epoch 7/20 => Loss 0.434, Loss_clf 0.304, Loss_aux 0.129, Train_accy 91.57:  35%|███▌      | 7/20 [05:53<10:51, 50.12s/it]
Task 3, Epoch 8/20 => Loss 0.397, Loss_clf 0.319, Loss_aux 0.079, Train_accy 92.02:  35%|███▌      | 7/20 [06:38<10:51, 50.12s/it]
Task 3, Epoch 8/20 => Loss 0.397, Loss_clf 0.319, Loss_aux 0.079, Train_accy 92.02:  40%|████      | 8/20 [06:38<09:43, 48.62s/it]
Task 3, Epoch 9/20 => Loss 0.402, Loss_clf 0.293, Loss_aux 0.109, Train_accy 92.05:  40%|████      | 8/20 [07:23<09:43, 48.62s/it]
Task 3, Epoch 9/20 => Loss 0.402, Loss_clf 0.293, Loss_aux 0.109, Train_accy 92.05:  45%|████▌     | 9/20 [07:23<08:43, 47.62s/it]
Task 3, Epoch 10/20 => Loss 0.348, Loss_clf 0.250, Loss_aux 0.099, Train_accy 92.96:  45%|████▌     | 9/20 [08:09<08:43, 47.62s/it]
Task 3, Epoch 10/20 => Loss 0.348, Loss_clf 0.250, Loss_aux 0.099, Train_accy 92.96:  50%|█████     | 10/20 [08:09<07:49, 46.99s/it]
Task 3, Epoch 11/20 => Loss 0.341, Loss_clf 0.256, Loss_aux 0.085, Train_accy 93.51, Test_accy 87.66:  50%|█████     | 10/20 [09:12<07:49, 46.99s/it]
Task 3, Epoch 11/20 => Loss 0.341, Loss_clf 0.256, Loss_aux 0.085, Train_accy 93.51, Test_accy 87.66:  55%|█████▌    | 11/20 [09:12<07:47, 51.89s/it]
Task 3, Epoch 12/20 => Loss 0.381, Loss_clf 0.293, Loss_aux 0.088, Train_accy 91.95:  55%|█████▌    | 11/20 [09:57<07:47, 51.89s/it]                 
Task 3, Epoch 12/20 => Loss 0.381, Loss_clf 0.293, Loss_aux 0.088, Train_accy 91.95:  60%|██████    | 12/20 [09:57<06:39, 49.92s/it]
Task 3, Epoch 13/20 => Loss 0.382, Loss_clf 0.296, Loss_aux 0.087, Train_accy 91.95:  60%|██████    | 12/20 [10:43<06:39, 49.92s/it]
Task 3, Epoch 13/20 => Loss 0.382, Loss_clf 0.296, Loss_aux 0.087, Train_accy 91.95:  65%|██████▌   | 13/20 [10:43<05:40, 48.63s/it]
Task 3, Epoch 14/20 => Loss 0.361, Loss_clf 0.281, Loss_aux 0.080, Train_accy 92.30:  65%|██████▌   | 13/20 [11:29<05:40, 48.63s/it]
Task 3, Epoch 14/20 => Loss 0.361, Loss_clf 0.281, Loss_aux 0.080, Train_accy 92.30:  70%|███████   | 14/20 [11:29<04:46, 47.74s/it]
Task 3, Epoch 15/20 => Loss 0.344, Loss_clf 0.262, Loss_aux 0.082, Train_accy 92.82:  70%|███████   | 14/20 [12:14<04:46, 47.74s/it]
Task 3, Epoch 15/20 => Loss 0.344, Loss_clf 0.262, Loss_aux 0.082, Train_accy 92.82:  75%|███████▌  | 15/20 [12:14<03:55, 47.09s/it]
Task 3, Epoch 16/20 => Loss 0.340, Loss_clf 0.258, Loss_aux 0.082, Train_accy 93.10, Test_accy 87.85:  75%|███████▌  | 15/20 [13:17<03:55, 47.09s/it]
Task 3, Epoch 16/20 => Loss 0.340, Loss_clf 0.258, Loss_aux 0.082, Train_accy 93.10, Test_accy 87.85:  80%|████████  | 16/20 [13:17<03:27, 51.85s/it]
Task 3, Epoch 17/20 => Loss 0.339, Loss_clf 0.262, Loss_aux 0.077, Train_accy 93.30:  80%|████████  | 16/20 [14:03<03:27, 51.85s/it]                 
Task 3, Epoch 17/20 => Loss 0.339, Loss_clf 0.262, Loss_aux 0.077, Train_accy 93.30:  85%|████████▌ | 17/20 [14:03<02:30, 50.00s/it]
Task 3, Epoch 18/20 => Loss 0.362, Loss_clf 0.292, Loss_aux 0.070, Train_accy 93.27:  85%|████████▌ | 17/20 [14:49<02:30, 50.00s/it]
Task 3, Epoch 18/20 => Loss 0.362, Loss_clf 0.292, Loss_aux 0.070, Train_accy 93.27:  90%|█████████ | 18/20 [14:49<01:37, 48.65s/it]
Task 3, Epoch 19/20 => Loss 0.348, Loss_clf 0.269, Loss_aux 0.079, Train_accy 93.16:  90%|█████████ | 18/20 [15:34<01:37, 48.65s/it]
Task 3, Epoch 19/20 => Loss 0.348, Loss_clf 0.269, Loss_aux 0.079, Train_accy 93.16:  95%|█████████▌| 19/20 [15:34<00:47, 47.69s/it]
Task 3, Epoch 20/20 => Loss 0.312, Loss_clf 0.238, Loss_aux 0.073, Train_accy 93.51:  95%|█████████▌| 19/20 [16:19<00:47, 47.69s/it]
Task 3, Epoch 20/20 => Loss 0.312, Loss_clf 0.238, Loss_aux 0.073, Train_accy 93.51: 100%|██████████| 20/20 [16:19<00:00, 47.04s/it]
Task 3, Epoch 20/20 => Loss 0.312, Loss_clf 0.238, Loss_aux 0.073, Train_accy 93.51: 100%|██████████| 20/20 [16:19<00:00, 49.00s/it]2024-09-13 07:24:11,280 [der.py] => Task 3, Epoch 20/20 => Loss 0.312, Loss_clf 0.238, Loss_aux 0.073, Train_accy 93.51
2024-09-13 07:24:11,281 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 07:26:15,319 [der.py] => Exemplar size: 2600
2024-09-13 07:26:15,320 [trainer.py] => CNN: {'total': 87.92, '00-99': 87.29, '100-109': 92.17, '110-119': 87.61, '120-129': 90.65, 'old': 87.71, 'new': 90.65}
2024-09-13 07:26:15,320 [trainer.py] => NME: {'total': 89.3, '00-99': 89.31, '100-109': 92.17, '110-119': 88.5, '120-129': 86.92, 'old': 89.48, 'new': 86.92}
2024-09-13 07:26:15,320 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92]
2024-09-13 07:26:15,320 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16]
2024-09-13 07:26:15,320 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3]
2024-09-13 07:26:15,320 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62]

Average Accuracy (CNN): 88.87
Average Accuracy (NME): 90.38
2024-09-13 07:26:15,320 [trainer.py] => Average Accuracy (CNN): 88.87
2024-09-13 07:26:15,320 [trainer.py] => Average Accuracy (NME): 90.38
2024-09-13 07:26:15,322 [trainer.py] => All params: 343602573
2024-09-13 07:26:15,324 [trainer.py] => Trainable params: 86206605
2024-09-13 07:26:17,859 [der.py] => Learning on 130-140
2024-09-13 07:26:17,865 [der.py] => All params: 429539479
2024-09-13 07:26:17,867 [der.py] => Trainable params: 86344855

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.513, Loss_clf 0.803, Loss_aux 0.710, Train_accy 85.48, Test_accy 86.90:   0%|          | 0/20 [01:19<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.513, Loss_clf 0.803, Loss_aux 0.710, Train_accy 85.48, Test_accy 86.90:   5%|▌         | 1/20 [01:19<25:04, 79.19s/it]
Task 4, Epoch 2/20 => Loss 0.606, Loss_clf 0.380, Loss_aux 0.226, Train_accy 89.13:   5%|▌         | 1/20 [02:15<25:04, 79.19s/it]                 
Task 4, Epoch 2/20 => Loss 0.606, Loss_clf 0.380, Loss_aux 0.226, Train_accy 89.13:  10%|█         | 2/20 [02:15<19:46, 65.92s/it]
Task 4, Epoch 3/20 => Loss 0.501, Loss_clf 0.332, Loss_aux 0.170, Train_accy 90.89:  10%|█         | 2/20 [03:12<19:46, 65.92s/it]
Task 4, Epoch 3/20 => Loss 0.501, Loss_clf 0.332, Loss_aux 0.170, Train_accy 90.89:  15%|█▌        | 3/20 [03:12<17:29, 61.76s/it]
Task 4, Epoch 4/20 => Loss 0.407, Loss_clf 0.288, Loss_aux 0.119, Train_accy 92.38:  15%|█▌        | 3/20 [04:09<17:29, 61.76s/it]
Task 4, Epoch 4/20 => Loss 0.407, Loss_clf 0.288, Loss_aux 0.119, Train_accy 92.38:  20%|██        | 4/20 [04:09<15:57, 59.84s/it]
Task 4, Epoch 5/20 => Loss 0.380, Loss_clf 0.283, Loss_aux 0.097, Train_accy 92.32:  20%|██        | 4/20 [05:06<15:57, 59.84s/it]
Task 4, Epoch 5/20 => Loss 0.380, Loss_clf 0.283, Loss_aux 0.097, Train_accy 92.32:  25%|██▌       | 5/20 [05:06<14:41, 58.77s/it]
Task 4, Epoch 6/20 => Loss 0.406, Loss_clf 0.305, Loss_aux 0.101, Train_accy 91.63, Test_accy 87.08:  25%|██▌       | 5/20 [06:26<14:41, 58.77s/it]
Task 4, Epoch 6/20 => Loss 0.406, Loss_clf 0.305, Loss_aux 0.101, Train_accy 91.63, Test_accy 87.08:  30%|███       | 6/20 [06:26<15:22, 65.87s/it]
Task 4, Epoch 7/20 => Loss 0.326, Loss_clf 0.241, Loss_aux 0.085, Train_accy 93.29:  30%|███       | 6/20 [07:22<15:22, 65.87s/it]                 
Task 4, Epoch 7/20 => Loss 0.326, Loss_clf 0.241, Loss_aux 0.085, Train_accy 93.29:  35%|███▌      | 7/20 [07:22<13:37, 62.89s/it]
Task 4, Epoch 8/20 => Loss 0.333, Loss_clf 0.255, Loss_aux 0.078, Train_accy 93.26:  35%|███▌      | 7/20 [08:19<13:37, 62.89s/it]
Task 4, Epoch 8/20 => Loss 0.333, Loss_clf 0.255, Loss_aux 0.078, Train_accy 93.26:  40%|████      | 8/20 [08:19<12:11, 60.93s/it]
Task 4, Epoch 9/20 => Loss 0.353, Loss_clf 0.269, Loss_aux 0.084, Train_accy 92.77:  40%|████      | 8/20 [09:16<12:11, 60.93s/it]
Task 4, Epoch 9/20 => Loss 0.353, Loss_clf 0.269, Loss_aux 0.084, Train_accy 92.77:  45%|████▌     | 9/20 [09:16<10:55, 59.56s/it]
Task 4, Epoch 10/20 => Loss 0.346, Loss_clf 0.272, Loss_aux 0.074, Train_accy 93.00:  45%|████▌     | 9/20 [10:12<10:55, 59.56s/it]
Task 4, Epoch 10/20 => Loss 0.346, Loss_clf 0.272, Loss_aux 0.074, Train_accy 93.00:  50%|█████     | 10/20 [10:12<09:46, 58.69s/it]
Task 4, Epoch 11/20 => Loss 0.342, Loss_clf 0.271, Loss_aux 0.071, Train_accy 92.97, Test_accy 87.26:  50%|█████     | 10/20 [11:32<09:46, 58.69s/it]
Task 4, Epoch 11/20 => Loss 0.342, Loss_clf 0.271, Loss_aux 0.071, Train_accy 92.97, Test_accy 87.26:  55%|█████▌    | 11/20 [11:32<09:46, 65.20s/it]
Task 4, Epoch 12/20 => Loss 0.352, Loss_clf 0.272, Loss_aux 0.080, Train_accy 93.00:  55%|█████▌    | 11/20 [12:29<09:46, 65.20s/it]                 
Task 4, Epoch 12/20 => Loss 0.352, Loss_clf 0.272, Loss_aux 0.080, Train_accy 93.00:  60%|██████    | 12/20 [12:29<08:21, 62.65s/it]
Task 4, Epoch 13/20 => Loss 0.363, Loss_clf 0.282, Loss_aux 0.081, Train_accy 92.74:  60%|██████    | 12/20 [13:26<08:21, 62.65s/it]
Task 4, Epoch 13/20 => Loss 0.363, Loss_clf 0.282, Loss_aux 0.081, Train_accy 92.74:  65%|██████▌   | 13/20 [13:26<07:05, 60.84s/it]
Task 4, Epoch 14/20 => Loss 0.310, Loss_clf 0.245, Loss_aux 0.065, Train_accy 93.52:  65%|██████▌   | 13/20 [14:22<07:05, 60.84s/it]
Task 4, Epoch 14/20 => Loss 0.310, Loss_clf 0.245, Loss_aux 0.065, Train_accy 93.52:  70%|███████   | 14/20 [14:22<05:57, 59.58s/it]
Task 4, Epoch 15/20 => Loss 0.324, Loss_clf 0.256, Loss_aux 0.068, Train_accy 93.75:  70%|███████   | 14/20 [15:19<05:57, 59.58s/it]
Task 4, Epoch 15/20 => Loss 0.324, Loss_clf 0.256, Loss_aux 0.068, Train_accy 93.75:  75%|███████▌  | 15/20 [15:19<04:53, 58.69s/it]
Task 4, Epoch 16/20 => Loss 0.310, Loss_clf 0.250, Loss_aux 0.060, Train_accy 93.42, Test_accy 87.39:  75%|███████▌  | 15/20 [16:39<04:53, 58.69s/it]
Task 4, Epoch 16/20 => Loss 0.310, Loss_clf 0.250, Loss_aux 0.060, Train_accy 93.42, Test_accy 87.39:  80%|████████  | 16/20 [16:39<04:19, 64.94s/it]
Task 4, Epoch 17/20 => Loss 0.325, Loss_clf 0.263, Loss_aux 0.062, Train_accy 93.49:  80%|████████  | 16/20 [17:35<04:19, 64.94s/it]                 
Task 4, Epoch 17/20 => Loss 0.325, Loss_clf 0.263, Loss_aux 0.062, Train_accy 93.49:  85%|████████▌ | 17/20 [17:35<03:07, 62.49s/it]
Task 4, Epoch 18/20 => Loss 0.308, Loss_clf 0.251, Loss_aux 0.057, Train_accy 93.10:  85%|████████▌ | 17/20 [18:32<03:07, 62.49s/it]
Task 4, Epoch 18/20 => Loss 0.308, Loss_clf 0.251, Loss_aux 0.057, Train_accy 93.10:  90%|█████████ | 18/20 [18:32<02:01, 60.81s/it]
Task 4, Epoch 19/20 => Loss 0.306, Loss_clf 0.232, Loss_aux 0.074, Train_accy 93.95:  90%|█████████ | 18/20 [19:29<02:01, 60.81s/it]
Task 4, Epoch 19/20 => Loss 0.306, Loss_clf 0.232, Loss_aux 0.074, Train_accy 93.95:  95%|█████████▌| 19/20 [19:29<00:59, 59.53s/it]
Task 4, Epoch 20/20 => Loss 0.291, Loss_clf 0.238, Loss_aux 0.052, Train_accy 93.55:  95%|█████████▌| 19/20 [20:25<00:59, 59.53s/it]
Task 4, Epoch 20/20 => Loss 0.291, Loss_clf 0.238, Loss_aux 0.052, Train_accy 93.55: 100%|██████████| 20/20 [20:25<00:00, 58.65s/it]
Task 4, Epoch 20/20 => Loss 0.291, Loss_clf 0.238, Loss_aux 0.052, Train_accy 93.55: 100%|██████████| 20/20 [20:25<00:00, 61.29s/it]2024-09-13 07:46:43,810 [der.py] => Task 4, Epoch 20/20 => Loss 0.291, Loss_clf 0.238, Loss_aux 0.052, Train_accy 93.55
2024-09-13 07:46:43,812 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 07:49:18,400 [der.py] => Exemplar size: 2800
2024-09-13 07:49:18,400 [trainer.py] => CNN: {'total': 87.75, '00-99': 86.95, '100-109': 92.17, '110-119': 86.73, '120-129': 85.05, '130-139': 94.92, 'old': 87.2, 'new': 94.92}
2024-09-13 07:49:18,400 [trainer.py] => NME: {'total': 88.24, '00-99': 88.3, '100-109': 92.17, '110-119': 90.27, '120-129': 83.18, '130-139': 86.44, 'old': 88.38, 'new': 86.44}
2024-09-13 07:49:18,401 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92, 87.75]
2024-09-13 07:49:18,401 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16, 97.81]
2024-09-13 07:49:18,401 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3, 88.24]
2024-09-13 07:49:18,401 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62, 98.54]

Average Accuracy (CNN): 88.64
Average Accuracy (NME): 89.95
2024-09-13 07:49:18,401 [trainer.py] => Average Accuracy (CNN): 88.64
2024-09-13 07:49:18,401 [trainer.py] => Average Accuracy (NME): 89.95
2024-09-13 07:49:18,404 [trainer.py] => All params: 429539479
2024-09-13 07:49:18,406 [trainer.py] => Trainable params: 86344855
2024-09-13 07:49:20,819 [der.py] => Learning on 140-150
2024-09-13 07:49:20,829 [der.py] => All params: 515491745
2024-09-13 07:49:20,832 [der.py] => Trainable params: 86498465

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.460, Loss_clf 0.797, Loss_aux 0.663, Train_accy 86.01, Test_accy 85.34:   0%|          | 0/20 [01:37<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.460, Loss_clf 0.797, Loss_aux 0.663, Train_accy 86.01, Test_accy 85.34:   5%|▌         | 1/20 [01:37<30:47, 97.23s/it]
Task 5, Epoch 2/20 => Loss 0.606, Loss_clf 0.369, Loss_aux 0.237, Train_accy 90.44:   5%|▌         | 1/20 [02:45<30:47, 97.23s/it]                 
Task 5, Epoch 2/20 => Loss 0.606, Loss_clf 0.369, Loss_aux 0.237, Train_accy 90.44:  10%|█         | 2/20 [02:45<24:06, 80.36s/it]
Task 5, Epoch 3/20 => Loss 0.473, Loss_clf 0.305, Loss_aux 0.168, Train_accy 91.70:  10%|█         | 2/20 [03:54<24:06, 80.36s/it]
Task 5, Epoch 3/20 => Loss 0.473, Loss_clf 0.305, Loss_aux 0.168, Train_accy 91.70:  15%|█▌        | 3/20 [03:54<21:14, 74.97s/it]
Task 5, Epoch 4/20 => Loss 0.464, Loss_clf 0.324, Loss_aux 0.140, Train_accy 91.70:  15%|█▌        | 3/20 [05:02<21:14, 74.97s/it]
Task 5, Epoch 4/20 => Loss 0.464, Loss_clf 0.324, Loss_aux 0.140, Train_accy 91.70:  20%|██        | 4/20 [05:02<19:18, 72.43s/it]
Task 5, Epoch 5/20 => Loss 0.444, Loss_clf 0.324, Loss_aux 0.119, Train_accy 91.61:  20%|██        | 4/20 [06:11<19:18, 72.43s/it]
Task 5, Epoch 5/20 => Loss 0.444, Loss_clf 0.324, Loss_aux 0.119, Train_accy 91.61:  25%|██▌       | 5/20 [06:11<17:46, 71.12s/it]
Task 5, Epoch 6/20 => Loss 0.398, Loss_clf 0.290, Loss_aux 0.109, Train_accy 92.53, Test_accy 85.63:  25%|██▌       | 5/20 [07:50<17:46, 71.12s/it]
Task 5, Epoch 6/20 => Loss 0.398, Loss_clf 0.290, Loss_aux 0.109, Train_accy 92.53, Test_accy 85.63:  30%|███       | 6/20 [07:50<18:45, 80.42s/it]
Task 5, Epoch 7/20 => Loss 0.407, Loss_clf 0.303, Loss_aux 0.105, Train_accy 91.73:  30%|███       | 6/20 [08:58<18:45, 80.42s/it]                 
Task 5, Epoch 7/20 => Loss 0.407, Loss_clf 0.303, Loss_aux 0.105, Train_accy 91.73:  35%|███▌      | 7/20 [08:58<16:35, 76.60s/it]
Task 5, Epoch 8/20 => Loss 0.378, Loss_clf 0.286, Loss_aux 0.092, Train_accy 92.00:  35%|███▌      | 7/20 [10:07<16:35, 76.60s/it]
Task 5, Epoch 8/20 => Loss 0.378, Loss_clf 0.286, Loss_aux 0.092, Train_accy 92.00:  40%|████      | 8/20 [10:07<14:48, 74.06s/it]
Task 5, Epoch 9/20 => Loss 0.351, Loss_clf 0.272, Loss_aux 0.078, Train_accy 92.77:  40%|████      | 8/20 [11:16<14:48, 74.06s/it]
Task 5, Epoch 9/20 => Loss 0.351, Loss_clf 0.272, Loss_aux 0.078, Train_accy 92.77:  45%|████▌     | 9/20 [11:16<13:16, 72.41s/it]
Task 5, Epoch 10/20 => Loss 0.383, Loss_clf 0.312, Loss_aux 0.070, Train_accy 91.82:  45%|████▌     | 9/20 [12:25<13:16, 72.41s/it]
Task 5, Epoch 10/20 => Loss 0.383, Loss_clf 0.312, Loss_aux 0.070, Train_accy 91.82:  50%|█████     | 10/20 [12:25<11:53, 71.30s/it]
Task 5, Epoch 11/20 => Loss 0.331, Loss_clf 0.257, Loss_aux 0.073, Train_accy 93.39, Test_accy 85.96:  50%|█████     | 10/20 [14:03<11:53, 71.30s/it]
Task 5, Epoch 11/20 => Loss 0.331, Loss_clf 0.257, Loss_aux 0.073, Train_accy 93.39, Test_accy 85.96:  55%|█████▌    | 11/20 [14:03<11:55, 79.47s/it]
Task 5, Epoch 12/20 => Loss 0.354, Loss_clf 0.274, Loss_aux 0.080, Train_accy 92.80:  55%|█████▌    | 11/20 [15:11<11:55, 79.47s/it]                 
Task 5, Epoch 12/20 => Loss 0.354, Loss_clf 0.274, Loss_aux 0.080, Train_accy 92.80:  60%|██████    | 12/20 [15:11<10:09, 76.15s/it]
Task 5, Epoch 13/20 => Loss 0.346, Loss_clf 0.272, Loss_aux 0.075, Train_accy 93.02:  60%|██████    | 12/20 [16:20<10:09, 76.15s/it]
Task 5, Epoch 13/20 => Loss 0.346, Loss_clf 0.272, Loss_aux 0.075, Train_accy 93.02:  65%|██████▌   | 13/20 [16:20<08:36, 73.85s/it]
Task 5, Epoch 14/20 => Loss 0.357, Loss_clf 0.276, Loss_aux 0.080, Train_accy 93.08:  65%|██████▌   | 13/20 [17:28<08:36, 73.85s/it]
Task 5, Epoch 14/20 => Loss 0.357, Loss_clf 0.276, Loss_aux 0.080, Train_accy 93.08:  70%|███████   | 14/20 [17:28<07:13, 72.25s/it]
Task 5, Epoch 15/20 => Loss 0.316, Loss_clf 0.258, Loss_aux 0.058, Train_accy 93.05:  70%|███████   | 14/20 [18:37<07:13, 72.25s/it]
Task 5, Epoch 15/20 => Loss 0.316, Loss_clf 0.258, Loss_aux 0.058, Train_accy 93.05:  75%|███████▌  | 15/20 [18:37<05:55, 71.19s/it]
Task 5, Epoch 16/20 => Loss 0.341, Loss_clf 0.281, Loss_aux 0.060, Train_accy 93.20, Test_accy 86.25:  75%|███████▌  | 15/20 [20:15<05:55, 71.19s/it]
Task 5, Epoch 16/20 => Loss 0.341, Loss_clf 0.281, Loss_aux 0.060, Train_accy 93.20, Test_accy 86.25:  80%|████████  | 16/20 [20:15<05:17, 79.28s/it]
Task 5, Epoch 17/20 => Loss 0.330, Loss_clf 0.270, Loss_aux 0.059, Train_accy 93.11:  80%|████████  | 16/20 [21:24<05:17, 79.28s/it]                 
Task 5, Epoch 17/20 => Loss 0.330, Loss_clf 0.270, Loss_aux 0.059, Train_accy 93.11:  85%|████████▌ | 17/20 [21:24<03:48, 76.11s/it]
Task 5, Epoch 18/20 => Loss 0.318, Loss_clf 0.250, Loss_aux 0.068, Train_accy 93.45:  85%|████████▌ | 17/20 [22:32<03:48, 76.11s/it]
Task 5, Epoch 18/20 => Loss 0.318, Loss_clf 0.250, Loss_aux 0.068, Train_accy 93.45:  90%|█████████ | 18/20 [22:32<02:27, 73.88s/it]
Task 5, Epoch 19/20 => Loss 0.341, Loss_clf 0.264, Loss_aux 0.077, Train_accy 93.33:  90%|█████████ | 18/20 [23:41<02:27, 73.88s/it]
Task 5, Epoch 19/20 => Loss 0.341, Loss_clf 0.264, Loss_aux 0.077, Train_accy 93.33:  95%|█████████▌| 19/20 [23:41<01:12, 72.37s/it]
Task 5, Epoch 20/20 => Loss 0.270, Loss_clf 0.227, Loss_aux 0.043, Train_accy 94.56:  95%|█████████▌| 19/20 [24:50<01:12, 72.37s/it]
Task 5, Epoch 20/20 => Loss 0.270, Loss_clf 0.227, Loss_aux 0.043, Train_accy 94.56: 100%|██████████| 20/20 [24:50<00:00, 71.30s/it]
Task 5, Epoch 20/20 => Loss 0.270, Loss_clf 0.227, Loss_aux 0.043, Train_accy 94.56: 100%|██████████| 20/20 [24:50<00:00, 74.53s/it]2024-09-13 08:14:11,534 [der.py] => Task 5, Epoch 20/20 => Loss 0.270, Loss_clf 0.227, Loss_aux 0.043, Train_accy 94.56
2024-09-13 08:14:11,535 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 08:17:16,772 [der.py] => Exemplar size: 3000
2024-09-13 08:17:16,772 [trainer.py] => CNN: {'total': 85.68, '00-99': 84.09, '100-109': 91.3, '110-119': 86.73, '120-129': 83.18, '130-139': 85.59, '140-149': 96.83, 'old': 84.83, 'new': 96.83}
2024-09-13 08:17:16,772 [trainer.py] => NME: {'total': 87.89, '00-99': 88.13, '100-109': 91.3, '110-119': 90.27, '120-129': 83.18, '130-139': 88.14, '140-149': 84.13, 'old': 88.18, 'new': 84.13}
2024-09-13 08:17:16,772 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92, 87.75, 85.68]
2024-09-13 08:17:16,772 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16, 97.81, 97.06]
2024-09-13 08:17:16,773 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3, 88.24, 87.89]
2024-09-13 08:17:16,773 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62, 98.54, 98.53]

Average Accuracy (CNN): 88.15
Average Accuracy (NME): 89.61
2024-09-13 08:17:16,773 [trainer.py] => Average Accuracy (CNN): 88.15
2024-09-13 08:17:16,773 [trainer.py] => Average Accuracy (NME): 89.61
2024-09-13 08:17:16,778 [trainer.py] => All params: 515491745
2024-09-13 08:17:16,782 [trainer.py] => Trainable params: 86498465
2024-09-13 08:17:18,795 [der.py] => Learning on 150-160
2024-09-13 08:17:18,802 [der.py] => All params: 601459371
2024-09-13 08:17:18,805 [der.py] => Trainable params: 86667435

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.439, Loss_clf 0.720, Loss_aux 0.720, Train_accy 86.68, Test_accy 84.40:   0%|          | 0/20 [01:58<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.439, Loss_clf 0.720, Loss_aux 0.720, Train_accy 86.68, Test_accy 84.40:   5%|▌         | 1/20 [01:58<37:24, 118.13s/it]
Task 6, Epoch 2/20 => Loss 0.563, Loss_clf 0.352, Loss_aux 0.211, Train_accy 90.72:   5%|▌         | 1/20 [03:20<37:24, 118.13s/it]                 
Task 6, Epoch 2/20 => Loss 0.563, Loss_clf 0.352, Loss_aux 0.211, Train_accy 90.72:  10%|█         | 2/20 [03:20<29:08, 97.13s/it] 
Task 6, Epoch 3/20 => Loss 0.444, Loss_clf 0.298, Loss_aux 0.146, Train_accy 92.39:  10%|█         | 2/20 [04:43<29:08, 97.13s/it]
Task 6, Epoch 3/20 => Loss 0.444, Loss_clf 0.298, Loss_aux 0.146, Train_accy 92.39:  15%|█▌        | 3/20 [04:43<25:38, 90.50s/it]
Task 6, Epoch 4/20 => Loss 0.454, Loss_clf 0.324, Loss_aux 0.130, Train_accy 91.61:  15%|█▌        | 3/20 [06:05<25:38, 90.50s/it]
Task 6, Epoch 4/20 => Loss 0.454, Loss_clf 0.324, Loss_aux 0.130, Train_accy 91.61:  20%|██        | 4/20 [06:05<23:17, 87.35s/it]
Task 6, Epoch 5/20 => Loss 0.401, Loss_clf 0.299, Loss_aux 0.102, Train_accy 92.04:  20%|██        | 4/20 [07:28<23:17, 87.35s/it]
Task 6, Epoch 5/20 => Loss 0.401, Loss_clf 0.299, Loss_aux 0.102, Train_accy 92.04:  25%|██▌       | 5/20 [07:28<21:23, 85.59s/it]
Task 6, Epoch 6/20 => Loss 0.331, Loss_clf 0.248, Loss_aux 0.083, Train_accy 93.45, Test_accy 86.52:  25%|██▌       | 5/20 [09:27<21:23, 85.59s/it]
Task 6, Epoch 6/20 => Loss 0.331, Loss_clf 0.248, Loss_aux 0.083, Train_accy 93.45, Test_accy 86.52:  30%|███       | 6/20 [09:27<22:38, 97.02s/it]
Task 6, Epoch 7/20 => Loss 0.359, Loss_clf 0.275, Loss_aux 0.084, Train_accy 92.79:  30%|███       | 6/20 [10:50<22:38, 97.02s/it]                 
Task 6, Epoch 7/20 => Loss 0.359, Loss_clf 0.275, Loss_aux 0.084, Train_accy 92.79:  35%|███▌      | 7/20 [10:50<20:01, 92.39s/it]
Task 6, Epoch 8/20 => Loss 0.341, Loss_clf 0.263, Loss_aux 0.078, Train_accy 93.51:  35%|███▌      | 7/20 [12:12<20:01, 92.39s/it]
Task 6, Epoch 8/20 => Loss 0.341, Loss_clf 0.263, Loss_aux 0.078, Train_accy 93.51:  40%|████      | 8/20 [12:12<17:51, 89.26s/it]
Task 6, Epoch 9/20 => Loss 0.325, Loss_clf 0.254, Loss_aux 0.072, Train_accy 93.08:  40%|████      | 8/20 [13:35<17:51, 89.26s/it]
Task 6, Epoch 9/20 => Loss 0.325, Loss_clf 0.254, Loss_aux 0.072, Train_accy 93.08:  45%|████▌     | 9/20 [13:35<15:59, 87.19s/it]
Task 6, Epoch 10/20 => Loss 0.350, Loss_clf 0.281, Loss_aux 0.069, Train_accy 93.14:  45%|████▌     | 9/20 [14:57<15:59, 87.19s/it]
Task 6, Epoch 10/20 => Loss 0.350, Loss_clf 0.281, Loss_aux 0.069, Train_accy 93.14:  50%|█████     | 10/20 [14:57<14:17, 85.76s/it]
Task 6, Epoch 11/20 => Loss 0.338, Loss_clf 0.263, Loss_aux 0.075, Train_accy 93.66, Test_accy 85.72:  50%|█████     | 10/20 [16:56<14:17, 85.76s/it]
Task 6, Epoch 11/20 => Loss 0.338, Loss_clf 0.263, Loss_aux 0.075, Train_accy 93.66, Test_accy 85.72:  55%|█████▌    | 11/20 [16:56<14:23, 95.91s/it]
Task 6, Epoch 12/20 => Loss 0.337, Loss_clf 0.273, Loss_aux 0.065, Train_accy 93.11:  55%|█████▌    | 11/20 [18:19<14:23, 95.91s/it]                 
Task 6, Epoch 12/20 => Loss 0.337, Loss_clf 0.273, Loss_aux 0.065, Train_accy 93.11:  60%|██████    | 12/20 [18:19<12:15, 91.91s/it]
Task 6, Epoch 13/20 => Loss 0.309, Loss_clf 0.226, Loss_aux 0.083, Train_accy 94.09:  60%|██████    | 12/20 [19:42<12:15, 91.91s/it]
Task 6, Epoch 13/20 => Loss 0.309, Loss_clf 0.226, Loss_aux 0.083, Train_accy 94.09:  65%|██████▌   | 13/20 [19:42<10:23, 89.14s/it]
Task 6, Epoch 14/20 => Loss 0.356, Loss_clf 0.279, Loss_aux 0.077, Train_accy 93.08:  65%|██████▌   | 13/20 [21:05<10:23, 89.14s/it]
Task 6, Epoch 14/20 => Loss 0.356, Loss_clf 0.279, Loss_aux 0.077, Train_accy 93.08:  70%|███████   | 14/20 [21:05<08:43, 87.17s/it]
Task 6, Epoch 15/20 => Loss 0.348, Loss_clf 0.270, Loss_aux 0.078, Train_accy 93.14:  70%|███████   | 14/20 [22:27<08:43, 87.17s/it]
Task 6, Epoch 15/20 => Loss 0.348, Loss_clf 0.270, Loss_aux 0.078, Train_accy 93.14:  75%|███████▌  | 15/20 [22:27<07:09, 85.88s/it]
Task 6, Epoch 16/20 => Loss 0.310, Loss_clf 0.245, Loss_aux 0.065, Train_accy 93.60, Test_accy 85.99:  75%|███████▌  | 15/20 [24:27<07:09, 85.88s/it]
Task 6, Epoch 16/20 => Loss 0.310, Loss_clf 0.245, Loss_aux 0.065, Train_accy 93.60, Test_accy 85.99:  80%|████████  | 16/20 [24:27<06:23, 95.93s/it]
Task 6, Epoch 17/20 => Loss 0.345, Loss_clf 0.273, Loss_aux 0.073, Train_accy 93.14:  80%|████████  | 16/20 [25:49<06:23, 95.93s/it]                 
Task 6, Epoch 17/20 => Loss 0.345, Loss_clf 0.273, Loss_aux 0.073, Train_accy 93.14:  85%|████████▌ | 17/20 [25:49<04:35, 91.95s/it]
Task 6, Epoch 18/20 => Loss 0.327, Loss_clf 0.261, Loss_aux 0.066, Train_accy 93.22:  85%|████████▌ | 17/20 [27:12<04:35, 91.95s/it]
Task 6, Epoch 18/20 => Loss 0.327, Loss_clf 0.261, Loss_aux 0.066, Train_accy 93.22:  90%|█████████ | 18/20 [27:12<02:58, 89.16s/it]
Task 6, Epoch 19/20 => Loss 0.310, Loss_clf 0.257, Loss_aux 0.053, Train_accy 93.45:  90%|█████████ | 18/20 [28:35<02:58, 89.16s/it]
Task 6, Epoch 19/20 => Loss 0.310, Loss_clf 0.257, Loss_aux 0.053, Train_accy 93.45:  95%|█████████▌| 19/20 [28:35<01:27, 87.18s/it]
Task 6, Epoch 20/20 => Loss 0.324, Loss_clf 0.263, Loss_aux 0.061, Train_accy 92.94:  95%|█████████▌| 19/20 [29:57<01:27, 87.18s/it]
Task 6, Epoch 20/20 => Loss 0.324, Loss_clf 0.263, Loss_aux 0.061, Train_accy 92.94: 100%|██████████| 20/20 [29:57<00:00, 85.77s/it]
Task 6, Epoch 20/20 => Loss 0.324, Loss_clf 0.263, Loss_aux 0.061, Train_accy 92.94: 100%|██████████| 20/20 [29:57<00:00, 89.88s/it]2024-09-13 08:47:16,498 [der.py] => Task 6, Epoch 20/20 => Loss 0.324, Loss_clf 0.263, Loss_aux 0.061, Train_accy 92.94
2024-09-13 08:47:16,500 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 08:50:58,057 [der.py] => Exemplar size: 3200
2024-09-13 08:50:58,057 [trainer.py] => CNN: {'total': 86.14, '00-99': 84.26, '100-109': 86.09, '110-119': 88.5, '120-129': 81.31, '130-139': 90.68, '140-149': 90.48, '150-159': 97.58, 'old': 85.34, 'new': 97.58}
2024-09-13 08:50:58,057 [trainer.py] => NME: {'total': 87.94, '00-99': 87.63, '100-109': 89.57, '110-119': 88.5, '120-129': 83.18, '130-139': 88.14, '140-149': 85.71, '150-159': 95.16, 'old': 87.44, 'new': 95.16}
2024-09-13 08:50:58,057 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92, 87.75, 85.68, 86.14]
2024-09-13 08:50:58,058 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16, 97.81, 97.06, 97.04]
2024-09-13 08:50:58,058 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3, 88.24, 87.89, 87.94]
2024-09-13 08:50:58,058 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62, 98.54, 98.53, 98.52]

Average Accuracy (CNN): 87.86
Average Accuracy (NME): 89.37
2024-09-13 08:50:58,058 [trainer.py] => Average Accuracy (CNN): 87.86
2024-09-13 08:50:58,058 [trainer.py] => Average Accuracy (NME): 89.37
2024-09-13 08:50:58,066 [trainer.py] => All params: 601459371
2024-09-13 08:50:58,070 [trainer.py] => Trainable params: 86667435
2024-09-13 08:50:59,990 [der.py] => Learning on 160-170
2024-09-13 08:51:00,000 [der.py] => All params: 687442357
2024-09-13 08:51:00,004 [der.py] => Trainable params: 86851765

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.247, Loss_clf 0.714, Loss_aux 0.533, Train_accy 87.31, Test_accy 84.79:   0%|          | 0/20 [02:21<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.247, Loss_clf 0.714, Loss_aux 0.533, Train_accy 87.31, Test_accy 84.79:   5%|▌         | 1/20 [02:21<44:50, 141.62s/it]
Task 7, Epoch 2/20 => Loss 0.474, Loss_clf 0.307, Loss_aux 0.166, Train_accy 91.78:   5%|▌         | 1/20 [03:58<44:50, 141.62s/it]                 
Task 7, Epoch 2/20 => Loss 0.474, Loss_clf 0.307, Loss_aux 0.166, Train_accy 91.78:  10%|█         | 2/20 [03:58<34:36, 115.37s/it]
Task 7, Epoch 3/20 => Loss 0.427, Loss_clf 0.306, Loss_aux 0.120, Train_accy 92.17:  10%|█         | 2/20 [05:35<34:36, 115.37s/it]
Task 7, Epoch 3/20 => Loss 0.427, Loss_clf 0.306, Loss_aux 0.120, Train_accy 92.17:  15%|█▌        | 3/20 [05:35<30:20, 107.11s/it]
Task 7, Epoch 4/20 => Loss 0.401, Loss_clf 0.294, Loss_aux 0.107, Train_accy 92.25:  15%|█▌        | 3/20 [07:12<30:20, 107.11s/it]
Task 7, Epoch 4/20 => Loss 0.401, Loss_clf 0.294, Loss_aux 0.107, Train_accy 92.25:  20%|██        | 4/20 [07:12<27:30, 103.13s/it]
Task 7, Epoch 5/20 => Loss 0.378, Loss_clf 0.280, Loss_aux 0.098, Train_accy 92.63:  20%|██        | 4/20 [08:50<27:30, 103.13s/it]
Task 7, Epoch 5/20 => Loss 0.378, Loss_clf 0.280, Loss_aux 0.098, Train_accy 92.63:  25%|██▌       | 5/20 [08:50<25:14, 100.99s/it]
Task 7, Epoch 6/20 => Loss 0.346, Loss_clf 0.262, Loss_aux 0.084, Train_accy 92.71, Test_accy 85.83:  25%|██▌       | 5/20 [11:11<25:14, 100.99s/it]
Task 7, Epoch 6/20 => Loss 0.346, Loss_clf 0.262, Loss_aux 0.084, Train_accy 92.71, Test_accy 85.83:  30%|███       | 6/20 [11:11<26:46, 114.73s/it]
Task 7, Epoch 7/20 => Loss 0.330, Loss_clf 0.256, Loss_aux 0.074, Train_accy 93.34:  30%|███       | 6/20 [12:48<26:46, 114.73s/it]                 
Task 7, Epoch 7/20 => Loss 0.330, Loss_clf 0.256, Loss_aux 0.074, Train_accy 93.34:  35%|███▌      | 7/20 [12:48<23:36, 108.95s/it]
Task 7, Epoch 8/20 => Loss 0.349, Loss_clf 0.270, Loss_aux 0.079, Train_accy 92.90:  35%|███▌      | 7/20 [14:25<23:36, 108.95s/it]
Task 7, Epoch 8/20 => Loss 0.349, Loss_clf 0.270, Loss_aux 0.079, Train_accy 92.90:  40%|████      | 8/20 [14:25<21:01, 105.14s/it]
Task 7, Epoch 9/20 => Loss 0.397, Loss_clf 0.302, Loss_aux 0.095, Train_accy 92.25:  40%|████      | 8/20 [16:02<21:01, 105.14s/it]
Task 7, Epoch 9/20 => Loss 0.397, Loss_clf 0.302, Loss_aux 0.095, Train_accy 92.25:  45%|████▌     | 9/20 [16:02<18:48, 102.60s/it]
Task 7, Epoch 10/20 => Loss 0.344, Loss_clf 0.274, Loss_aux 0.070, Train_accy 92.66:  45%|████▌     | 9/20 [17:39<18:48, 102.60s/it]
Task 7, Epoch 10/20 => Loss 0.344, Loss_clf 0.274, Loss_aux 0.070, Train_accy 92.66:  50%|█████     | 10/20 [17:39<16:49, 100.92s/it]
Task 7, Epoch 11/20 => Loss 0.359, Loss_clf 0.280, Loss_aux 0.079, Train_accy 92.30, Test_accy 85.48:  50%|█████     | 10/20 [20:01<16:49, 100.92s/it]
Task 7, Epoch 11/20 => Loss 0.359, Loss_clf 0.280, Loss_aux 0.079, Train_accy 92.30, Test_accy 85.48:  55%|█████▌    | 11/20 [20:01<16:59, 113.28s/it]
Task 7, Epoch 12/20 => Loss 0.330, Loss_clf 0.255, Loss_aux 0.075, Train_accy 93.07:  55%|█████▌    | 11/20 [21:38<16:59, 113.28s/it]                 
Task 7, Epoch 12/20 => Loss 0.330, Loss_clf 0.255, Loss_aux 0.075, Train_accy 93.07:  60%|██████    | 12/20 [21:38<14:26, 108.37s/it]
Task 7, Epoch 13/20 => Loss 0.319, Loss_clf 0.251, Loss_aux 0.068, Train_accy 93.42:  60%|██████    | 12/20 [23:15<14:26, 108.37s/it]
Task 7, Epoch 13/20 => Loss 0.319, Loss_clf 0.251, Loss_aux 0.068, Train_accy 93.42:  65%|██████▌   | 13/20 [23:15<12:14, 104.94s/it]
Task 7, Epoch 14/20 => Loss 0.320, Loss_clf 0.250, Loss_aux 0.070, Train_accy 93.70:  65%|██████▌   | 13/20 [24:52<12:14, 104.94s/it]
Task 7, Epoch 14/20 => Loss 0.320, Loss_clf 0.250, Loss_aux 0.070, Train_accy 93.70:  70%|███████   | 14/20 [24:52<10:15, 102.53s/it]
Task 7, Epoch 15/20 => Loss 0.337, Loss_clf 0.271, Loss_aux 0.066, Train_accy 92.88:  70%|███████   | 14/20 [26:29<10:15, 102.53s/it]
Task 7, Epoch 15/20 => Loss 0.337, Loss_clf 0.271, Loss_aux 0.066, Train_accy 92.88:  75%|███████▌  | 15/20 [26:29<08:24, 100.87s/it]
Task 7, Epoch 16/20 => Loss 0.338, Loss_clf 0.270, Loss_aux 0.068, Train_accy 93.12, Test_accy 86.22:  75%|███████▌  | 15/20 [28:50<08:24, 100.87s/it]
Task 7, Epoch 16/20 => Loss 0.338, Loss_clf 0.270, Loss_aux 0.068, Train_accy 93.12, Test_accy 86.22:  80%|████████  | 16/20 [28:50<07:32, 113.12s/it]
Task 7, Epoch 17/20 => Loss 0.277, Loss_clf 0.224, Loss_aux 0.053, Train_accy 94.13:  80%|████████  | 16/20 [30:27<07:32, 113.12s/it]                 
Task 7, Epoch 17/20 => Loss 0.277, Loss_clf 0.224, Loss_aux 0.053, Train_accy 94.13:  85%|████████▌ | 17/20 [30:27<05:24, 108.30s/it]
Task 7, Epoch 18/20 => Loss 0.303, Loss_clf 0.251, Loss_aux 0.052, Train_accy 93.78:  85%|████████▌ | 17/20 [32:05<05:24, 108.30s/it]
Task 7, Epoch 18/20 => Loss 0.303, Loss_clf 0.251, Loss_aux 0.052, Train_accy 93.78:  90%|█████████ | 18/20 [32:05<03:30, 105.05s/it]
Task 7, Epoch 19/20 => Loss 0.323, Loss_clf 0.262, Loss_aux 0.061, Train_accy 93.45:  90%|█████████ | 18/20 [33:42<03:30, 105.05s/it]
Task 7, Epoch 19/20 => Loss 0.323, Loss_clf 0.262, Loss_aux 0.061, Train_accy 93.45:  95%|█████████▌| 19/20 [33:42<01:42, 102.66s/it]
Task 7, Epoch 20/20 => Loss 0.287, Loss_clf 0.234, Loss_aux 0.053, Train_accy 94.00:  95%|█████████▌| 19/20 [35:19<01:42, 102.66s/it]
Task 7, Epoch 20/20 => Loss 0.287, Loss_clf 0.234, Loss_aux 0.053, Train_accy 94.00: 100%|██████████| 20/20 [35:19<00:00, 101.06s/it]
Task 7, Epoch 20/20 => Loss 0.287, Loss_clf 0.234, Loss_aux 0.053, Train_accy 94.00: 100%|██████████| 20/20 [35:19<00:00, 105.99s/it]2024-09-13 09:26:19,829 [der.py] => Task 7, Epoch 20/20 => Loss 0.287, Loss_clf 0.234, Loss_aux 0.053, Train_accy 94.00
2024-09-13 09:26:19,831 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 09:30:42,311 [der.py] => Exemplar size: 3400
2024-09-13 09:30:42,311 [trainer.py] => CNN: {'total': 85.28, '00-99': 83.92, '100-109': 84.35, '110-119': 84.96, '120-129': 83.18, '130-139': 88.98, '140-149': 80.16, '150-159': 94.35, '160-169': 93.28, 'old': 84.72, 'new': 93.28}
2024-09-13 09:30:42,311 [trainer.py] => NME: {'total': 87.9, '00-99': 87.63, '100-109': 89.57, '110-119': 87.61, '120-129': 83.18, '130-139': 88.14, '140-149': 85.71, '150-159': 95.16, '160-169': 88.06, 'old': 87.89, 'new': 88.06}
2024-09-13 09:30:42,311 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92, 87.75, 85.68, 86.14, 85.28]
2024-09-13 09:30:42,311 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16, 97.81, 97.06, 97.04, 96.64]
2024-09-13 09:30:42,311 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3, 88.24, 87.89, 87.94, 87.9]
2024-09-13 09:30:42,311 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62, 98.54, 98.53, 98.52, 98.42]

Average Accuracy (CNN): 87.54
Average Accuracy (NME): 89.19
2024-09-13 09:30:42,311 [trainer.py] => Average Accuracy (CNN): 87.54
2024-09-13 09:30:42,311 [trainer.py] => Average Accuracy (NME): 89.19
2024-09-13 09:30:42,317 [trainer.py] => All params: 687442357
2024-09-13 09:30:42,321 [trainer.py] => Trainable params: 86851765
2024-09-13 09:30:44,745 [der.py] => Learning on 170-180
2024-09-13 09:30:44,756 [der.py] => All params: 773440703
2024-09-13 09:30:44,760 [der.py] => Trainable params: 87051455

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.139, Loss_clf 0.605, Loss_aux 0.534, Train_accy 89.14, Test_accy 84.02:   0%|          | 0/20 [02:45<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.139, Loss_clf 0.605, Loss_aux 0.534, Train_accy 89.14, Test_accy 84.02:   5%|▌         | 1/20 [02:45<52:30, 165.82s/it]
Task 8, Epoch 2/20 => Loss 0.451, Loss_clf 0.283, Loss_aux 0.168, Train_accy 92.63:   5%|▌         | 1/20 [04:39<52:30, 165.82s/it]                 
Task 8, Epoch 2/20 => Loss 0.451, Loss_clf 0.283, Loss_aux 0.168, Train_accy 92.63:  10%|█         | 2/20 [04:39<40:31, 135.09s/it]
Task 8, Epoch 3/20 => Loss 0.393, Loss_clf 0.275, Loss_aux 0.119, Train_accy 92.91:  10%|█         | 2/20 [06:33<40:31, 135.09s/it]
Task 8, Epoch 3/20 => Loss 0.393, Loss_clf 0.275, Loss_aux 0.119, Train_accy 92.91:  15%|█▌        | 3/20 [06:33<35:30, 125.32s/it]
Task 8, Epoch 4/20 => Loss 0.375, Loss_clf 0.270, Loss_aux 0.105, Train_accy 92.71:  15%|█▌        | 3/20 [08:26<35:30, 125.32s/it]
Task 8, Epoch 4/20 => Loss 0.375, Loss_clf 0.270, Loss_aux 0.105, Train_accy 92.71:  20%|██        | 4/20 [08:26<32:10, 120.67s/it]
Task 8, Epoch 5/20 => Loss 0.383, Loss_clf 0.284, Loss_aux 0.099, Train_accy 92.55:  20%|██        | 4/20 [10:20<32:10, 120.67s/it]
Task 8, Epoch 5/20 => Loss 0.383, Loss_clf 0.284, Loss_aux 0.099, Train_accy 92.55:  25%|██▌       | 5/20 [10:20<29:31, 118.11s/it]
Task 8, Epoch 6/20 => Loss 0.370, Loss_clf 0.277, Loss_aux 0.093, Train_accy 92.86, Test_accy 83.93:  25%|██▌       | 5/20 [13:06<29:31, 118.11s/it]
Task 8, Epoch 6/20 => Loss 0.370, Loss_clf 0.277, Loss_aux 0.093, Train_accy 92.86, Test_accy 83.93:  30%|███       | 6/20 [13:06<31:21, 134.41s/it]
Task 8, Epoch 7/20 => Loss 0.375, Loss_clf 0.288, Loss_aux 0.086, Train_accy 92.86:  30%|███       | 6/20 [15:00<31:21, 134.41s/it]                 
Task 8, Epoch 7/20 => Loss 0.375, Loss_clf 0.288, Loss_aux 0.086, Train_accy 92.86:  35%|███▌      | 7/20 [15:00<27:39, 127.67s/it]
Task 8, Epoch 8/20 => Loss 0.354, Loss_clf 0.257, Loss_aux 0.097, Train_accy 93.12:  35%|███▌      | 7/20 [16:53<27:39, 127.67s/it]
Task 8, Epoch 8/20 => Loss 0.354, Loss_clf 0.257, Loss_aux 0.097, Train_accy 93.12:  40%|████      | 8/20 [16:53<24:39, 123.28s/it]
Task 8, Epoch 9/20 => Loss 0.328, Loss_clf 0.250, Loss_aux 0.078, Train_accy 93.43:  40%|████      | 8/20 [18:47<24:39, 123.28s/it]
Task 8, Epoch 9/20 => Loss 0.328, Loss_clf 0.250, Loss_aux 0.078, Train_accy 93.43:  45%|████▌     | 9/20 [18:47<22:02, 120.23s/it]
Task 8, Epoch 10/20 => Loss 0.327, Loss_clf 0.257, Loss_aux 0.070, Train_accy 93.30:  45%|████▌     | 9/20 [20:40<22:02, 120.23s/it]
Task 8, Epoch 10/20 => Loss 0.327, Loss_clf 0.257, Loss_aux 0.070, Train_accy 93.30:  50%|█████     | 10/20 [20:40<19:41, 118.14s/it]
Task 8, Epoch 11/20 => Loss 0.347, Loss_clf 0.268, Loss_aux 0.079, Train_accy 93.40, Test_accy 85.43:  50%|█████     | 10/20 [23:27<19:41, 118.14s/it]
Task 8, Epoch 11/20 => Loss 0.347, Loss_clf 0.268, Loss_aux 0.079, Train_accy 93.40, Test_accy 85.43:  55%|█████▌    | 11/20 [23:27<19:55, 132.84s/it]
Task 8, Epoch 12/20 => Loss 0.353, Loss_clf 0.269, Loss_aux 0.084, Train_accy 93.07:  55%|█████▌    | 11/20 [25:20<19:55, 132.84s/it]                 
Task 8, Epoch 12/20 => Loss 0.353, Loss_clf 0.269, Loss_aux 0.084, Train_accy 93.07:  60%|██████    | 12/20 [25:20<16:56, 127.03s/it]
Task 8, Epoch 13/20 => Loss 0.315, Loss_clf 0.230, Loss_aux 0.085, Train_accy 93.63:  60%|██████    | 12/20 [27:14<16:56, 127.03s/it]
Task 8, Epoch 13/20 => Loss 0.315, Loss_clf 0.230, Loss_aux 0.085, Train_accy 93.63:  65%|██████▌   | 13/20 [27:14<14:20, 122.98s/it]
Task 8, Epoch 14/20 => Loss 0.352, Loss_clf 0.279, Loss_aux 0.073, Train_accy 92.84:  65%|██████▌   | 13/20 [29:08<14:20, 122.98s/it]
Task 8, Epoch 14/20 => Loss 0.352, Loss_clf 0.279, Loss_aux 0.073, Train_accy 92.84:  70%|███████   | 14/20 [29:08<12:01, 120.22s/it]
Task 8, Epoch 15/20 => Loss 0.346, Loss_clf 0.279, Loss_aux 0.067, Train_accy 92.50:  70%|███████   | 14/20 [31:01<12:01, 120.22s/it]
Task 8, Epoch 15/20 => Loss 0.346, Loss_clf 0.279, Loss_aux 0.067, Train_accy 92.50:  75%|███████▌  | 15/20 [31:01<09:50, 118.15s/it]
Task 8, Epoch 16/20 => Loss 0.333, Loss_clf 0.268, Loss_aux 0.064, Train_accy 93.40, Test_accy 85.39:  75%|███████▌  | 15/20 [33:43<09:50, 118.15s/it]
Task 8, Epoch 16/20 => Loss 0.333, Loss_clf 0.268, Loss_aux 0.064, Train_accy 93.40, Test_accy 85.39:  80%|████████  | 16/20 [33:43<08:45, 131.40s/it]
Task 8, Epoch 17/20 => Loss 0.352, Loss_clf 0.269, Loss_aux 0.083, Train_accy 93.14:  80%|████████  | 16/20 [35:34<08:45, 131.40s/it]                 
Task 8, Epoch 17/20 => Loss 0.352, Loss_clf 0.269, Loss_aux 0.083, Train_accy 93.14:  85%|████████▌ | 17/20 [35:34<06:15, 125.16s/it]
Task 8, Epoch 18/20 => Loss 0.342, Loss_clf 0.262, Loss_aux 0.080, Train_accy 93.35:  85%|████████▌ | 17/20 [37:25<06:15, 125.16s/it]
Task 8, Epoch 18/20 => Loss 0.342, Loss_clf 0.262, Loss_aux 0.080, Train_accy 93.35:  90%|█████████ | 18/20 [37:25<04:01, 120.83s/it]
Task 8, Epoch 19/20 => Loss 0.306, Loss_clf 0.243, Loss_aux 0.063, Train_accy 93.68:  90%|█████████ | 18/20 [39:15<04:01, 120.83s/it]
Task 8, Epoch 19/20 => Loss 0.306, Loss_clf 0.243, Loss_aux 0.063, Train_accy 93.68:  95%|█████████▌| 19/20 [39:15<01:57, 117.76s/it]
Task 8, Epoch 20/20 => Loss 0.302, Loss_clf 0.245, Loss_aux 0.057, Train_accy 93.68:  95%|█████████▌| 19/20 [41:06<01:57, 117.76s/it]
Task 8, Epoch 20/20 => Loss 0.302, Loss_clf 0.245, Loss_aux 0.057, Train_accy 93.68: 100%|██████████| 20/20 [41:06<00:00, 115.56s/it]
Task 8, Epoch 20/20 => Loss 0.302, Loss_clf 0.245, Loss_aux 0.057, Train_accy 93.68: 100%|██████████| 20/20 [41:06<00:00, 123.32s/it]2024-09-13 10:11:51,142 [der.py] => Task 8, Epoch 20/20 => Loss 0.302, Loss_clf 0.245, Loss_aux 0.057, Train_accy 93.68
2024-09-13 10:11:51,143 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 10:16:52,224 [der.py] => Exemplar size: 3600
2024-09-13 10:16:52,224 [trainer.py] => CNN: {'total': 85.24, '00-99': 83.42, '100-109': 91.3, '110-119': 84.96, '120-129': 82.24, '130-139': 88.14, '140-149': 78.57, '150-159': 87.9, '160-169': 93.28, '170-179': 94.17, 'old': 84.79, 'new': 94.17}
2024-09-13 10:16:52,224 [trainer.py] => NME: {'total': 87.03, '00-99': 86.62, '100-109': 88.7, '110-119': 85.84, '120-129': 84.11, '130-139': 89.83, '140-149': 84.13, '150-159': 94.35, '160-169': 88.81, '170-179': 83.5, 'old': 87.21, 'new': 83.5}
2024-09-13 10:16:52,224 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92, 87.75, 85.68, 86.14, 85.28, 85.24]
2024-09-13 10:16:52,225 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16, 97.81, 97.06, 97.04, 96.64, 97.04]
2024-09-13 10:16:52,225 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3, 88.24, 87.89, 87.94, 87.9, 87.03]
2024-09-13 10:16:52,225 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62, 98.54, 98.53, 98.52, 98.42, 98.4]

Average Accuracy (CNN): 87.28
Average Accuracy (NME): 88.95
2024-09-13 10:16:52,225 [trainer.py] => Average Accuracy (CNN): 87.28
2024-09-13 10:16:52,225 [trainer.py] => Average Accuracy (NME): 88.95
2024-09-13 10:16:52,232 [trainer.py] => All params: 773440703
2024-09-13 10:16:52,239 [trainer.py] => Trainable params: 87051455
2024-09-13 10:16:54,914 [der.py] => Learning on 180-190
2024-09-13 10:16:54,927 [der.py] => All params: 859454409
2024-09-13 10:16:54,932 [der.py] => Trainable params: 87266505

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.223, Loss_clf 0.703, Loss_aux 0.521, Train_accy 88.16, Test_accy 82.88:   0%|          | 0/20 [03:05<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.223, Loss_clf 0.703, Loss_aux 0.521, Train_accy 88.16, Test_accy 82.88:   5%|▌         | 1/20 [03:05<58:43, 185.42s/it]
Task 9, Epoch 2/20 => Loss 0.499, Loss_clf 0.334, Loss_aux 0.164, Train_accy 91.25:   5%|▌         | 1/20 [05:11<58:43, 185.42s/it]                 
Task 9, Epoch 2/20 => Loss 0.499, Loss_clf 0.334, Loss_aux 0.164, Train_accy 91.25:  10%|█         | 2/20 [05:11<45:04, 150.25s/it]
Task 9, Epoch 3/20 => Loss 0.421, Loss_clf 0.293, Loss_aux 0.128, Train_accy 92.08:  10%|█         | 2/20 [07:16<45:04, 150.25s/it]
Task 9, Epoch 3/20 => Loss 0.421, Loss_clf 0.293, Loss_aux 0.128, Train_accy 92.08:  15%|█▌        | 3/20 [07:16<39:24, 139.08s/it]
Task 9, Epoch 4/20 => Loss 0.416, Loss_clf 0.305, Loss_aux 0.111, Train_accy 92.01:  15%|█▌        | 3/20 [09:22<39:24, 139.08s/it]
Task 9, Epoch 4/20 => Loss 0.416, Loss_clf 0.305, Loss_aux 0.111, Train_accy 92.01:  20%|██        | 4/20 [09:22<35:38, 133.66s/it]
Task 9, Epoch 5/20 => Loss 0.364, Loss_clf 0.266, Loss_aux 0.098, Train_accy 93.27:  20%|██        | 4/20 [11:27<35:38, 133.66s/it]
Task 9, Epoch 5/20 => Loss 0.364, Loss_clf 0.266, Loss_aux 0.098, Train_accy 93.27:  25%|██▌       | 5/20 [11:27<32:41, 130.76s/it]
Task 9, Epoch 6/20 => Loss 0.368, Loss_clf 0.279, Loss_aux 0.090, Train_accy 92.77, Test_accy 83.45:  25%|██▌       | 5/20 [14:33<32:41, 130.76s/it]
Task 9, Epoch 6/20 => Loss 0.368, Loss_clf 0.279, Loss_aux 0.090, Train_accy 92.77, Test_accy 83.45:  30%|███       | 6/20 [14:33<34:51, 149.41s/it]
Task 9, Epoch 7/20 => Loss 0.365, Loss_clf 0.286, Loss_aux 0.079, Train_accy 92.82:  30%|███       | 6/20 [16:39<34:51, 149.41s/it]                 
Task 9, Epoch 7/20 => Loss 0.365, Loss_clf 0.286, Loss_aux 0.079, Train_accy 92.82:  35%|███▌      | 7/20 [16:39<30:42, 141.72s/it]
Task 9, Epoch 8/20 => Loss 0.351, Loss_clf 0.271, Loss_aux 0.080, Train_accy 93.12:  35%|███▌      | 7/20 [18:44<30:42, 141.72s/it]
Task 9, Epoch 8/20 => Loss 0.351, Loss_clf 0.271, Loss_aux 0.080, Train_accy 93.12:  40%|████      | 8/20 [18:44<27:18, 136.51s/it]
Task 9, Epoch 9/20 => Loss 0.358, Loss_clf 0.286, Loss_aux 0.071, Train_accy 92.85:  40%|████      | 8/20 [20:50<27:18, 136.51s/it]
Task 9, Epoch 9/20 => Loss 0.358, Loss_clf 0.286, Loss_aux 0.071, Train_accy 92.85:  45%|████▌     | 9/20 [20:50<24:23, 133.04s/it]
Task 9, Epoch 10/20 => Loss 0.368, Loss_clf 0.298, Loss_aux 0.070, Train_accy 92.13:  45%|████▌     | 9/20 [22:55<24:23, 133.04s/it]
Task 9, Epoch 10/20 => Loss 0.368, Loss_clf 0.298, Loss_aux 0.070, Train_accy 92.13:  50%|█████     | 10/20 [22:55<21:47, 130.75s/it]
Task 9, Epoch 11/20 => Loss 0.341, Loss_clf 0.274, Loss_aux 0.067, Train_accy 93.12, Test_accy 83.94:  50%|█████     | 10/20 [26:01<21:47, 130.75s/it]
Task 9, Epoch 11/20 => Loss 0.341, Loss_clf 0.274, Loss_aux 0.067, Train_accy 93.12, Test_accy 83.94:  55%|█████▌    | 11/20 [26:01<22:07, 147.45s/it]
Task 9, Epoch 12/20 => Loss 0.331, Loss_clf 0.256, Loss_aux 0.075, Train_accy 93.19:  55%|█████▌    | 11/20 [28:06<22:07, 147.45s/it]                 
Task 9, Epoch 12/20 => Loss 0.331, Loss_clf 0.256, Loss_aux 0.075, Train_accy 93.19:  60%|██████    | 12/20 [28:06<18:46, 140.79s/it]
Task 9, Epoch 13/20 => Loss 0.325, Loss_clf 0.265, Loss_aux 0.060, Train_accy 93.14:  60%|██████    | 12/20 [30:11<18:46, 140.79s/it]
Task 9, Epoch 13/20 => Loss 0.325, Loss_clf 0.265, Loss_aux 0.060, Train_accy 93.14:  65%|██████▌   | 13/20 [30:11<15:52, 136.12s/it]
Task 9, Epoch 14/20 => Loss 0.345, Loss_clf 0.272, Loss_aux 0.073, Train_accy 92.92:  65%|██████▌   | 13/20 [32:17<15:52, 136.12s/it]
Task 9, Epoch 14/20 => Loss 0.345, Loss_clf 0.272, Loss_aux 0.073, Train_accy 92.92:  70%|███████   | 14/20 [32:17<13:17, 132.94s/it]
Task 9, Epoch 15/20 => Loss 0.321, Loss_clf 0.257, Loss_aux 0.064, Train_accy 93.34:  70%|███████   | 14/20 [34:23<13:17, 132.94s/it]
Task 9, Epoch 15/20 => Loss 0.321, Loss_clf 0.257, Loss_aux 0.064, Train_accy 93.34:  75%|███████▌  | 15/20 [34:23<10:53, 130.69s/it]
Task 9, Epoch 16/20 => Loss 0.336, Loss_clf 0.279, Loss_aux 0.057, Train_accy 92.87, Test_accy 84.73:  75%|███████▌  | 15/20 [37:28<10:53, 130.69s/it]
Task 9, Epoch 16/20 => Loss 0.336, Loss_clf 0.279, Loss_aux 0.057, Train_accy 92.87, Test_accy 84.73:  80%|████████  | 16/20 [37:28<09:48, 147.11s/it]
Task 9, Epoch 17/20 => Loss 0.294, Loss_clf 0.250, Loss_aux 0.044, Train_accy 94.18:  80%|████████  | 16/20 [39:34<09:48, 147.11s/it]                 
Task 9, Epoch 17/20 => Loss 0.294, Loss_clf 0.250, Loss_aux 0.044, Train_accy 94.18:  85%|████████▌ | 17/20 [39:34<07:02, 140.70s/it]
Task 9, Epoch 18/20 => Loss 0.309, Loss_clf 0.255, Loss_aux 0.055, Train_accy 93.46:  85%|████████▌ | 17/20 [41:39<07:02, 140.70s/it]
Task 9, Epoch 18/20 => Loss 0.309, Loss_clf 0.255, Loss_aux 0.055, Train_accy 93.46:  90%|█████████ | 18/20 [41:39<04:32, 136.13s/it]
Task 9, Epoch 19/20 => Loss 0.328, Loss_clf 0.264, Loss_aux 0.063, Train_accy 93.37:  90%|█████████ | 18/20 [43:45<04:32, 136.13s/it]
Task 9, Epoch 19/20 => Loss 0.328, Loss_clf 0.264, Loss_aux 0.063, Train_accy 93.37:  95%|█████████▌| 19/20 [43:45<02:12, 132.93s/it]
Task 9, Epoch 20/20 => Loss 0.288, Loss_clf 0.239, Loss_aux 0.049, Train_accy 93.83:  95%|█████████▌| 19/20 [45:50<02:12, 132.93s/it]
Task 9, Epoch 20/20 => Loss 0.288, Loss_clf 0.239, Loss_aux 0.049, Train_accy 93.83: 100%|██████████| 20/20 [45:50<00:00, 130.71s/it]
Task 9, Epoch 20/20 => Loss 0.288, Loss_clf 0.239, Loss_aux 0.049, Train_accy 93.83: 100%|██████████| 20/20 [45:50<00:00, 137.53s/it]2024-09-13 11:02:45,583 [der.py] => Task 9, Epoch 20/20 => Loss 0.288, Loss_clf 0.239, Loss_aux 0.049, Train_accy 93.83
2024-09-13 11:02:45,583 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 11:08:30,604 [der.py] => Exemplar size: 3800
2024-09-13 11:08:30,604 [trainer.py] => CNN: {'total': 84.82, '00-99': 83.92, '100-109': 86.09, '110-119': 86.73, '120-129': 80.37, '130-139': 82.2, '140-149': 76.19, '150-159': 91.13, '160-169': 91.04, '170-179': 91.26, '180-189': 87.12, 'old': 84.68, 'new': 87.12}
2024-09-13 11:08:30,604 [trainer.py] => NME: {'total': 86.68, '00-99': 86.45, '100-109': 88.7, '110-119': 86.73, '120-129': 82.24, '130-139': 86.44, '140-149': 83.33, '150-159': 96.77, '160-169': 89.55, '170-179': 83.5, '180-189': 84.09, 'old': 86.84, 'new': 84.09}
2024-09-13 11:08:30,604 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92, 87.75, 85.68, 86.14, 85.28, 85.24, 84.82]
2024-09-13 11:08:30,604 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16, 97.81, 97.06, 97.04, 96.64, 97.04, 96.81]
2024-09-13 11:08:30,604 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3, 88.24, 87.89, 87.94, 87.9, 87.03, 86.68]
2024-09-13 11:08:30,605 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62, 98.54, 98.53, 98.52, 98.42, 98.4, 97.96]

Average Accuracy (CNN): 87.04
Average Accuracy (NME): 88.72
2024-09-13 11:08:30,605 [trainer.py] => Average Accuracy (CNN): 87.04
2024-09-13 11:08:30,605 [trainer.py] => Average Accuracy (NME): 88.72
2024-09-13 11:08:30,615 [trainer.py] => All params: 859454409
2024-09-13 11:08:30,620 [trainer.py] => Trainable params: 87266505
2024-09-13 11:08:33,295 [der.py] => Learning on 190-200
2024-09-13 11:08:33,311 [der.py] => All params: 945483475
2024-09-13 11:08:33,318 [der.py] => Trainable params: 87496915

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.276, Loss_clf 0.648, Loss_aux 0.628, Train_accy 88.34, Test_accy 81.85:   0%|          | 0/20 [03:32<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.276, Loss_clf 0.648, Loss_aux 0.628, Train_accy 88.34, Test_accy 81.85:   5%|▌         | 1/20 [03:32<1:07:16, 212.45s/it]
Task 10, Epoch 2/20 => Loss 0.517, Loss_clf 0.328, Loss_aux 0.189, Train_accy 91.37:   5%|▌         | 1/20 [05:56<1:07:16, 212.45s/it]                 
Task 10, Epoch 2/20 => Loss 0.517, Loss_clf 0.328, Loss_aux 0.189, Train_accy 91.37:  10%|█         | 2/20 [05:56<51:39, 172.22s/it]  
Task 10, Epoch 3/20 => Loss 0.457, Loss_clf 0.307, Loss_aux 0.150, Train_accy 92.06:  10%|█         | 2/20 [08:20<51:39, 172.22s/it]
Task 10, Epoch 3/20 => Loss 0.457, Loss_clf 0.307, Loss_aux 0.150, Train_accy 92.06:  15%|█▌        | 3/20 [08:20<45:11, 159.50s/it]
Task 10, Epoch 4/20 => Loss 0.407, Loss_clf 0.284, Loss_aux 0.123, Train_accy 92.65:  15%|█▌        | 3/20 [10:44<45:11, 159.50s/it]
Task 10, Epoch 4/20 => Loss 0.407, Loss_clf 0.284, Loss_aux 0.123, Train_accy 92.65:  20%|██        | 4/20 [10:44<40:54, 153.40s/it]
Task 10, Epoch 5/20 => Loss 0.370, Loss_clf 0.261, Loss_aux 0.109, Train_accy 93.06:  20%|██        | 4/20 [13:09<40:54, 153.40s/it]
Task 10, Epoch 5/20 => Loss 0.370, Loss_clf 0.261, Loss_aux 0.109, Train_accy 93.06:  25%|██▌       | 5/20 [13:09<37:31, 150.07s/it]
Task 10, Epoch 6/20 => Loss 0.350, Loss_clf 0.266, Loss_aux 0.083, Train_accy 93.02, Test_accy 84.10:  25%|██▌       | 5/20 [16:41<37:31, 150.07s/it]
Task 10, Epoch 6/20 => Loss 0.350, Loss_clf 0.266, Loss_aux 0.083, Train_accy 93.02, Test_accy 84.10:  30%|███       | 6/20 [16:41<39:59, 171.41s/it]
Task 10, Epoch 7/20 => Loss 0.370, Loss_clf 0.275, Loss_aux 0.096, Train_accy 93.06:  30%|███       | 6/20 [19:06<39:59, 171.41s/it]                 
Task 10, Epoch 7/20 => Loss 0.370, Loss_clf 0.275, Loss_aux 0.096, Train_accy 93.06:  35%|███▌      | 7/20 [19:06<35:12, 162.50s/it]
Task 10, Epoch 8/20 => Loss 0.358, Loss_clf 0.269, Loss_aux 0.088, Train_accy 93.04:  35%|███▌      | 7/20 [21:29<35:12, 162.50s/it]
Task 10, Epoch 8/20 => Loss 0.358, Loss_clf 0.269, Loss_aux 0.088, Train_accy 93.04:  40%|████      | 8/20 [21:29<31:18, 156.54s/it]
Task 10, Epoch 9/20 => Loss 0.362, Loss_clf 0.288, Loss_aux 0.074, Train_accy 92.60:  40%|████      | 8/20 [23:53<31:18, 156.54s/it]
Task 10, Epoch 9/20 => Loss 0.362, Loss_clf 0.288, Loss_aux 0.074, Train_accy 92.60:  45%|████▌     | 9/20 [23:53<27:58, 152.61s/it]
Task 10, Epoch 10/20 => Loss 0.315, Loss_clf 0.257, Loss_aux 0.058, Train_accy 93.09:  45%|████▌     | 9/20 [26:18<27:58, 152.61s/it]
Task 10, Epoch 10/20 => Loss 0.315, Loss_clf 0.257, Loss_aux 0.058, Train_accy 93.09:  50%|█████     | 10/20 [26:18<25:00, 150.01s/it]
Task 10, Epoch 11/20 => Loss 0.293, Loss_clf 0.230, Loss_aux 0.063, Train_accy 94.32, Test_accy 83.63:  50%|█████     | 10/20 [29:51<25:00, 150.01s/it]
Task 10, Epoch 11/20 => Loss 0.293, Loss_clf 0.230, Loss_aux 0.063, Train_accy 94.32, Test_accy 83.63:  55%|█████▌    | 11/20 [29:51<25:24, 169.35s/it]
Task 10, Epoch 12/20 => Loss 0.317, Loss_clf 0.244, Loss_aux 0.073, Train_accy 93.93:  55%|█████▌    | 11/20 [32:15<25:24, 169.35s/it]                 
Task 10, Epoch 12/20 => Loss 0.317, Loss_clf 0.244, Loss_aux 0.073, Train_accy 93.93:  60%|██████    | 12/20 [32:15<21:33, 161.69s/it]
Task 10, Epoch 13/20 => Loss 0.332, Loss_clf 0.264, Loss_aux 0.068, Train_accy 93.04:  60%|██████    | 12/20 [34:41<21:33, 161.69s/it]
Task 10, Epoch 13/20 => Loss 0.332, Loss_clf 0.264, Loss_aux 0.068, Train_accy 93.04:  65%|██████▌   | 13/20 [34:41<18:18, 156.98s/it]
Task 10, Epoch 14/20 => Loss 0.314, Loss_clf 0.251, Loss_aux 0.064, Train_accy 93.55:  65%|██████▌   | 13/20 [37:09<18:18, 156.98s/it]
Task 10, Epoch 14/20 => Loss 0.314, Loss_clf 0.251, Loss_aux 0.064, Train_accy 93.55:  70%|███████   | 14/20 [37:09<15:26, 154.37s/it]
Task 10, Epoch 15/20 => Loss 0.326, Loss_clf 0.253, Loss_aux 0.072, Train_accy 93.46:  70%|███████   | 14/20 [39:38<15:26, 154.37s/it]
Task 10, Epoch 15/20 => Loss 0.326, Loss_clf 0.253, Loss_aux 0.072, Train_accy 93.46:  75%|███████▌  | 15/20 [39:38<12:42, 152.50s/it]
Task 10, Epoch 16/20 => Loss 0.342, Loss_clf 0.280, Loss_aux 0.062, Train_accy 93.16, Test_accy 84.10:  75%|███████▌  | 15/20 [43:16<12:42, 152.50s/it]
Task 10, Epoch 16/20 => Loss 0.342, Loss_clf 0.280, Loss_aux 0.062, Train_accy 93.16, Test_accy 84.10:  80%|████████  | 16/20 [43:16<11:29, 172.40s/it]
Task 10, Epoch 17/20 => Loss 0.312, Loss_clf 0.247, Loss_aux 0.065, Train_accy 94.04:  80%|████████  | 16/20 [45:44<11:29, 172.40s/it]                 
Task 10, Epoch 17/20 => Loss 0.312, Loss_clf 0.247, Loss_aux 0.065, Train_accy 94.04:  85%|████████▌ | 17/20 [45:44<08:15, 165.05s/it]
Task 10, Epoch 18/20 => Loss 0.341, Loss_clf 0.277, Loss_aux 0.064, Train_accy 93.13:  85%|████████▌ | 17/20 [48:13<08:15, 165.05s/it]
Task 10, Epoch 18/20 => Loss 0.341, Loss_clf 0.277, Loss_aux 0.064, Train_accy 93.13:  90%|█████████ | 18/20 [48:13<05:20, 160.05s/it]
Task 10, Epoch 19/20 => Loss 0.317, Loss_clf 0.260, Loss_aux 0.058, Train_accy 93.74:  90%|█████████ | 18/20 [50:40<05:20, 160.05s/it]
Task 10, Epoch 19/20 => Loss 0.317, Loss_clf 0.260, Loss_aux 0.058, Train_accy 93.74:  95%|█████████▌| 19/20 [50:40<02:36, 156.41s/it]
Task 10, Epoch 20/20 => Loss 0.273, Loss_clf 0.224, Loss_aux 0.049, Train_accy 94.11:  95%|█████████▌| 19/20 [53:09<02:36, 156.41s/it]
Task 10, Epoch 20/20 => Loss 0.273, Loss_clf 0.224, Loss_aux 0.049, Train_accy 94.11: 100%|██████████| 20/20 [53:09<00:00, 153.91s/it]
Task 10, Epoch 20/20 => Loss 0.273, Loss_clf 0.224, Loss_aux 0.049, Train_accy 94.11: 100%|██████████| 20/20 [53:09<00:00, 159.45s/it]2024-09-13 12:01:42,404 [der.py] => Task 10, Epoch 20/20 => Loss 0.273, Loss_clf 0.224, Loss_aux 0.049, Train_accy 94.11
2024-09-13 12:01:42,406 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 12:08:11,328 [der.py] => Exemplar size: 4000
2024-09-13 12:08:11,329 [trainer.py] => CNN: {'total': 83.93, '00-99': 80.3, '100-109': 88.7, '110-119': 84.07, '120-129': 77.57, '130-139': 89.83, '140-149': 87.3, '150-159': 90.32, '160-169': 89.55, '170-179': 93.2, '180-189': 87.88, '190-199': 86.73, 'old': 83.81, 'new': 86.73}
2024-09-13 12:08:11,329 [trainer.py] => NME: {'total': 86.17, '00-99': 85.86, '100-109': 88.7, '110-119': 87.61, '120-129': 82.24, '130-139': 86.44, '140-149': 84.92, '150-159': 95.97, '160-169': 87.31, '170-179': 83.5, '180-189': 82.58, '190-199': 84.69, 'old': 86.24, 'new': 84.69}
2024-09-13 12:08:11,329 [trainer.py] => CNN top1 curve: [88.72, 89.49, 89.34, 87.92, 87.75, 85.68, 86.14, 85.28, 85.24, 84.82, 83.93]
2024-09-13 12:08:11,329 [trainer.py] => CNN top5 curve: [98.4, 98.08, 98.16, 98.16, 97.81, 97.06, 97.04, 96.64, 97.04, 96.81, 96.31]
2024-09-13 12:08:11,329 [trainer.py] => NME top1 curve: [90.99, 91.4, 89.83, 89.3, 88.24, 87.89, 87.94, 87.9, 87.03, 86.68, 86.17]
2024-09-13 12:08:11,329 [trainer.py] => NME top5 curve: [98.91, 98.85, 98.59, 98.62, 98.54, 98.53, 98.52, 98.42, 98.4, 97.96, 97.96]

Average Accuracy (CNN): 86.76
Average Accuracy (NME): 88.49
2024-09-13 12:08:11,329 [trainer.py] => Average Accuracy (CNN): 86.76
2024-09-13 12:08:11,329 [trainer.py] => Average Accuracy (NME): 88.49
Accuracy Matrix (CNN):
[[88.72 88.89 88.8  87.29 86.95 84.09 84.26 83.92 83.42 83.92 80.3 ]
 [ 0.   95.65 94.78 92.17 92.17 91.3  86.09 84.35 91.3  86.09 88.7 ]
 [ 0.    0.   89.38 87.61 86.73 86.73 88.5  84.96 84.96 86.73 84.07]
 [ 0.    0.    0.   90.65 85.05 83.18 81.31 83.18 82.24 80.37 77.57]
 [ 0.    0.    0.    0.   94.92 85.59 90.68 88.98 88.14 82.2  89.83]
 [ 0.    0.    0.    0.    0.   96.83 90.48 80.16 78.57 76.19 87.3 ]
 [ 0.    0.    0.    0.    0.    0.   97.58 94.35 87.9  91.13 90.32]
 [ 0.    0.    0.    0.    0.    0.    0.   93.28 93.28 91.04 89.55]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   94.17 91.26 93.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   87.12 87.88]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   86.73]]
2024-09-13 12:08:11,331 [trainer.py] => Forgetting (CNN): 6.051000000000004
Accuracy Matrix (NME):
[[90.99 91.33 89.9  89.31 88.3  88.13 87.63 87.63 86.62 86.45 85.86]
 [ 0.   92.17 92.17 92.17 92.17 91.3  89.57 89.57 88.7  88.7  88.7 ]
 [ 0.    0.   86.73 88.5  90.27 90.27 88.5  87.61 85.84 86.73 87.61]
 [ 0.    0.    0.   86.92 83.18 83.18 83.18 83.18 84.11 82.24 82.24]
 [ 0.    0.    0.    0.   86.44 88.14 88.14 88.14 89.83 86.44 86.44]
 [ 0.    0.    0.    0.    0.   84.13 85.71 85.71 84.13 83.33 84.92]
 [ 0.    0.    0.    0.    0.    0.   95.16 95.16 94.35 96.77 95.97]
 [ 0.    0.    0.    0.    0.    0.    0.   88.06 88.81 89.55 87.31]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   83.5  83.5  83.5 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   84.09 82.58]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   84.69]]
2024-09-13 12:08:11,332 [trainer.py] => Forgetting (NME): 2.500999999999999
2024-09-05 01:40:21,719 [trainer.py] => config: ./exps/foster_cub_B0_Inc5.json
2024-09-05 01:40:21,719 [trainer.py] => prefix: cil
2024-09-05 01:40:21,719 [trainer.py] => dataset: cub
2024-09-05 01:40:21,719 [trainer.py] => memory_size: 4000
2024-09-05 01:40:21,719 [trainer.py] => memory_per_class: 20
2024-09-05 01:40:21,719 [trainer.py] => fixed_memory: True
2024-09-05 01:40:21,719 [trainer.py] => shuffle: True
2024-09-05 01:40:21,719 [trainer.py] => init_cls: 40
2024-09-05 01:40:21,719 [trainer.py] => increment: 40
2024-09-05 01:40:21,719 [trainer.py] => model_name: foster
2024-09-05 01:40:21,719 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 01:40:21,719 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 01:40:21,719 [trainer.py] => seed: 1993
2024-09-05 01:40:21,719 [trainer.py] => beta1: 0.96
2024-09-05 01:40:21,719 [trainer.py] => beta2: 0.97
2024-09-05 01:40:21,719 [trainer.py] => oofc: ft
2024-09-05 01:40:21,719 [trainer.py] => is_teacher_wa: False
2024-09-05 01:40:21,720 [trainer.py] => is_student_wa: False
2024-09-05 01:40:21,720 [trainer.py] => lambda_okd: 1
2024-09-05 01:40:21,720 [trainer.py] => wa_value: 1
2024-09-05 01:40:21,720 [trainer.py] => init_epochs: 20
2024-09-05 01:40:21,720 [trainer.py] => init_lr: 0.001
2024-09-05 01:40:21,720 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 01:40:21,720 [trainer.py] => boosting_epochs: 20
2024-09-05 01:40:21,720 [trainer.py] => compression_epochs: 20
2024-09-05 01:40:21,720 [trainer.py] => lr: 0.001
2024-09-05 01:40:21,720 [trainer.py] => batch_size: 48
2024-09-05 01:40:21,720 [trainer.py] => weight_decay: 0.0005
2024-09-05 01:40:21,720 [trainer.py] => num_workers: 8
2024-09-05 01:40:21,720 [trainer.py] => T: 2
2024-09-05 01:40:21,756 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 01:40:22,044 [trainer.py] => All params: 0
2024-09-05 01:40:22,044 [trainer.py] => Trainable params: 0
2024-09-05 01:40:23,595 [foster.py] => Learning on 0-40
2024-09-05 01:40:23,595 [foster.py] => All params: 85860176
2024-09-05 01:40:23,596 [foster.py] => Trainable params: 85860176

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.597, Train_accy 33.10, Test_accy 80.18:   0%|          | 0/20 [00:16<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.597, Train_accy 33.10, Test_accy 80.18:   5%|▌         | 1/20 [00:16<05:13, 16.49s/it]
Task 0, Epoch 2/20 => Loss 0.734, Train_accy 79.06:   5%|▌         | 1/20 [00:30<05:13, 16.49s/it]                 
Task 0, Epoch 2/20 => Loss 0.734, Train_accy 79.06:  10%|█         | 2/20 [00:30<04:35, 15.29s/it]
Task 0, Epoch 3/20 => Loss 0.485, Train_accy 85.77:  10%|█         | 2/20 [00:45<04:35, 15.29s/it]
Task 0, Epoch 3/20 => Loss 0.485, Train_accy 85.77:  15%|█▌        | 3/20 [00:45<04:13, 14.93s/it]
Task 0, Epoch 4/20 => Loss 0.421, Train_accy 88.15:  15%|█▌        | 3/20 [00:59<04:13, 14.93s/it]
Task 0, Epoch 4/20 => Loss 0.421, Train_accy 88.15:  20%|██        | 4/20 [00:59<03:56, 14.75s/it]
Task 0, Epoch 5/20 => Loss 0.333, Train_accy 90.75:  20%|██        | 4/20 [01:14<03:56, 14.75s/it]
Task 0, Epoch 5/20 => Loss 0.333, Train_accy 90.75:  25%|██▌       | 5/20 [01:14<03:39, 14.65s/it]
Task 0, Epoch 6/20 => Loss 0.353, Train_accy 89.58, Test_accy 94.49:  25%|██▌       | 5/20 [01:30<03:39, 14.65s/it]
Task 0, Epoch 6/20 => Loss 0.353, Train_accy 89.58, Test_accy 94.49:  30%|███       | 6/20 [01:30<03:32, 15.19s/it]
Task 0, Epoch 7/20 => Loss 0.313, Train_accy 91.17:  30%|███       | 6/20 [01:45<03:32, 15.19s/it]                 
Task 0, Epoch 7/20 => Loss 0.313, Train_accy 91.17:  35%|███▌      | 7/20 [01:45<03:14, 14.96s/it]
Task 0, Epoch 8/20 => Loss 0.254, Train_accy 92.44:  35%|███▌      | 7/20 [01:59<03:14, 14.96s/it]
Task 0, Epoch 8/20 => Loss 0.254, Train_accy 92.44:  40%|████      | 8/20 [01:59<02:57, 14.81s/it]
Task 0, Epoch 9/20 => Loss 0.259, Train_accy 92.65:  40%|████      | 8/20 [02:14<02:57, 14.81s/it]
Task 0, Epoch 9/20 => Loss 0.259, Train_accy 92.65:  45%|████▌     | 9/20 [02:14<02:42, 14.73s/it]
Task 0, Epoch 10/20 => Loss 0.194, Train_accy 94.08:  45%|████▌     | 9/20 [02:28<02:42, 14.73s/it]
Task 0, Epoch 10/20 => Loss 0.194, Train_accy 94.08:  50%|█████     | 10/20 [02:28<02:26, 14.66s/it]
Task 0, Epoch 11/20 => Loss 0.215, Train_accy 93.87, Test_accy 95.81:  50%|█████     | 10/20 [02:44<02:26, 14.66s/it]
Task 0, Epoch 11/20 => Loss 0.215, Train_accy 93.87, Test_accy 95.81:  55%|█████▌    | 11/20 [02:44<02:16, 15.15s/it]
Task 0, Epoch 12/20 => Loss 0.212, Train_accy 93.65:  55%|█████▌    | 11/20 [02:59<02:16, 15.15s/it]                 
Task 0, Epoch 12/20 => Loss 0.212, Train_accy 93.65:  60%|██████    | 12/20 [02:59<01:59, 14.98s/it]
Task 0, Epoch 13/20 => Loss 0.209, Train_accy 93.81:  60%|██████    | 12/20 [03:14<01:59, 14.98s/it]
Task 0, Epoch 13/20 => Loss 0.209, Train_accy 93.81:  65%|██████▌   | 13/20 [03:14<01:43, 14.84s/it]
Task 0, Epoch 14/20 => Loss 0.187, Train_accy 94.55:  65%|██████▌   | 13/20 [03:28<01:43, 14.84s/it]
Task 0, Epoch 14/20 => Loss 0.187, Train_accy 94.55:  70%|███████   | 14/20 [03:28<01:28, 14.76s/it]
Task 0, Epoch 15/20 => Loss 0.185, Train_accy 94.24:  70%|███████   | 14/20 [03:43<01:28, 14.76s/it]
Task 0, Epoch 15/20 => Loss 0.185, Train_accy 94.24:  75%|███████▌  | 15/20 [03:43<01:13, 14.69s/it]
Task 0, Epoch 16/20 => Loss 0.166, Train_accy 94.82, Test_accy 97.14:  75%|███████▌  | 15/20 [03:59<01:13, 14.69s/it]
Task 0, Epoch 16/20 => Loss 0.166, Train_accy 94.82, Test_accy 97.14:  80%|████████  | 16/20 [03:59<01:00, 15.18s/it]
Task 0, Epoch 17/20 => Loss 0.175, Train_accy 94.87:  80%|████████  | 16/20 [04:13<01:00, 15.18s/it]                 
Task 0, Epoch 17/20 => Loss 0.175, Train_accy 94.87:  85%|████████▌ | 17/20 [04:13<00:44, 14.99s/it]
Task 0, Epoch 18/20 => Loss 0.178, Train_accy 94.76:  85%|████████▌ | 17/20 [04:28<00:44, 14.99s/it]
Task 0, Epoch 18/20 => Loss 0.178, Train_accy 94.76:  90%|█████████ | 18/20 [04:28<00:29, 14.86s/it]
Task 0, Epoch 19/20 => Loss 0.159, Train_accy 95.24:  90%|█████████ | 18/20 [04:43<00:29, 14.86s/it]
Task 0, Epoch 19/20 => Loss 0.159, Train_accy 95.24:  95%|█████████▌| 19/20 [04:43<00:14, 14.78s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.61:  95%|█████████▌| 19/20 [04:57<00:14, 14.78s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.61: 100%|██████████| 20/20 [04:57<00:00, 14.70s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.61: 100%|██████████| 20/20 [04:57<00:00, 14.88s/it]
2024-09-05 01:45:21,720 [foster.py] => Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.61
2024-09-05 01:45:21,722 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 01:45:57,543 [foster.py] => Exemplar size: 800
2024-09-05 01:45:57,543 [trainer.py] => CNN: {'total': 96.92, '00-39': 96.92, 'old': 0, 'new': 96.92}
2024-09-05 01:45:57,543 [trainer.py] => NME: {'total': 96.92, '00-39': 96.92, 'old': 0, 'new': 96.92}
2024-09-05 01:45:57,543 [trainer.py] => CNN top1 curve: [96.92]
2024-09-05 01:45:57,543 [trainer.py] => CNN top5 curve: [99.56]
2024-09-05 01:45:57,543 [trainer.py] => NME top1 curve: [96.92]
2024-09-05 01:45:57,543 [trainer.py] => NME top5 curve: [99.56]

Average Accuracy (CNN): 96.92
Average Accuracy (NME): 96.92
2024-09-05 01:45:57,544 [trainer.py] => Average Accuracy (CNN): 96.92
2024-09-05 01:45:57,544 [trainer.py] => Average Accuracy (NME): 96.92
2024-09-05 01:45:57,545 [trainer.py] => All params: 85860176
2024-09-05 01:45:57,545 [trainer.py] => Trainable params: 85860176
2024-09-05 01:45:59,023 [foster.py] => Learning on 40-80
2024-09-05 01:45:59,025 [foster.py] => All params: 171812552
2024-09-05 01:45:59,025 [foster.py] => Trainable params: 85983136
2024-09-05 01:45:59,070 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.736, Loss_clf 1.852, Loss_fe 2.501, Loss_kd 0.691, Train_accy 50.99, Test_accy 70.84:   0%|          | 0/20 [00:32<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.736, Loss_clf 1.852, Loss_fe 2.501, Loss_kd 0.691, Train_accy 50.99, Test_accy 70.84:   5%|▌         | 1/20 [00:32<10:26, 32.99s/it]
Task 1, Epoch 2/20 => Loss 3.544, Loss_clf 0.850, Loss_fe 1.284, Loss_kd 0.705, Train_accy 59.06:   5%|▌         | 1/20 [01:00<10:26, 32.99s/it]                 
Task 1, Epoch 2/20 => Loss 3.544, Loss_clf 0.850, Loss_fe 1.284, Loss_kd 0.705, Train_accy 59.06:  10%|█         | 2/20 [01:00<08:56, 29.82s/it]
Task 1, Epoch 3/20 => Loss 3.170, Loss_clf 0.662, Loss_fe 1.099, Loss_kd 0.705, Train_accy 61.40:  10%|█         | 2/20 [01:28<08:56, 29.82s/it]
Task 1, Epoch 3/20 => Loss 3.170, Loss_clf 0.662, Loss_fe 1.099, Loss_kd 0.705, Train_accy 61.40:  15%|█▌        | 3/20 [01:28<08:10, 28.85s/it]
Task 1, Epoch 4/20 => Loss 3.384, Loss_clf 0.584, Loss_fe 1.436, Loss_kd 0.681, Train_accy 61.18:  15%|█▌        | 3/20 [01:56<08:10, 28.85s/it]
Task 1, Epoch 4/20 => Loss 3.384, Loss_clf 0.584, Loss_fe 1.436, Loss_kd 0.681, Train_accy 61.18:  20%|██        | 4/20 [01:56<07:35, 28.44s/it]
Task 1, Epoch 5/20 => Loss 2.602, Loss_clf 0.476, Loss_fe 0.794, Loss_kd 0.666, Train_accy 65.04:  20%|██        | 4/20 [02:23<07:35, 28.44s/it]
Task 1, Epoch 5/20 => Loss 2.602, Loss_clf 0.476, Loss_fe 0.794, Loss_kd 0.666, Train_accy 65.04:  25%|██▌       | 5/20 [02:23<07:03, 28.21s/it]
Task 1, Epoch 6/20 => Loss 2.225, Loss_clf 0.380, Loss_fe 0.537, Loss_kd 0.654, Train_accy 67.13, Test_accy 78.13:  25%|██▌       | 5/20 [02:57<07:03, 28.21s/it]
Task 1, Epoch 6/20 => Loss 2.225, Loss_clf 0.380, Loss_fe 0.537, Loss_kd 0.654, Train_accy 67.13, Test_accy 78.13:  30%|███       | 6/20 [02:57<06:59, 29.98s/it]
Task 1, Epoch 7/20 => Loss 2.265, Loss_clf 0.393, Loss_fe 0.518, Loss_kd 0.677, Train_accy 68.72:  30%|███       | 6/20 [03:25<06:59, 29.98s/it]                 
Task 1, Epoch 7/20 => Loss 2.265, Loss_clf 0.393, Loss_fe 0.518, Loss_kd 0.677, Train_accy 68.72:  35%|███▌      | 7/20 [03:25<06:20, 29.28s/it]
Task 1, Epoch 8/20 => Loss 2.219, Loss_clf 0.381, Loss_fe 0.490, Loss_kd 0.674, Train_accy 67.83:  35%|███▌      | 7/20 [03:53<06:20, 29.28s/it]
Task 1, Epoch 8/20 => Loss 2.219, Loss_clf 0.381, Loss_fe 0.490, Loss_kd 0.674, Train_accy 67.83:  40%|████      | 8/20 [03:53<05:45, 28.83s/it]
Task 1, Epoch 9/20 => Loss 2.129, Loss_clf 0.343, Loss_fe 0.429, Loss_kd 0.679, Train_accy 69.28:  40%|████      | 8/20 [04:20<05:45, 28.83s/it]
Task 1, Epoch 9/20 => Loss 2.129, Loss_clf 0.343, Loss_fe 0.429, Loss_kd 0.679, Train_accy 69.28:  45%|████▌     | 9/20 [04:20<05:14, 28.55s/it]
Task 1, Epoch 10/20 => Loss 2.145, Loss_clf 0.347, Loss_fe 0.467, Loss_kd 0.665, Train_accy 70.62:  45%|████▌     | 9/20 [04:48<05:14, 28.55s/it]
Task 1, Epoch 10/20 => Loss 2.145, Loss_clf 0.347, Loss_fe 0.467, Loss_kd 0.665, Train_accy 70.62:  50%|█████     | 10/20 [04:48<04:43, 28.34s/it]
Task 1, Epoch 11/20 => Loss 2.205, Loss_clf 0.338, Loss_fe 0.467, Loss_kd 0.700, Train_accy 69.43, Test_accy 80.52:  50%|█████     | 10/20 [05:22<04:43, 28.34s/it]
Task 1, Epoch 11/20 => Loss 2.205, Loss_clf 0.338, Loss_fe 0.467, Loss_kd 0.700, Train_accy 69.43, Test_accy 80.52:  55%|█████▌    | 11/20 [05:22<04:29, 29.90s/it]
Task 1, Epoch 12/20 => Loss 2.027, Loss_clf 0.314, Loss_fe 0.357, Loss_kd 0.678, Train_accy 71.74:  55%|█████▌    | 11/20 [05:50<04:29, 29.90s/it]                 
Task 1, Epoch 12/20 => Loss 2.027, Loss_clf 0.314, Loss_fe 0.357, Loss_kd 0.678, Train_accy 71.74:  60%|██████    | 12/20 [05:50<03:54, 29.27s/it]
Task 1, Epoch 13/20 => Loss 1.961, Loss_clf 0.284, Loss_fe 0.332, Loss_kd 0.673, Train_accy 72.00:  60%|██████    | 12/20 [06:17<03:54, 29.27s/it]
Task 1, Epoch 13/20 => Loss 1.961, Loss_clf 0.284, Loss_fe 0.332, Loss_kd 0.673, Train_accy 72.00:  65%|██████▌   | 13/20 [06:17<03:21, 28.85s/it]
Task 1, Epoch 14/20 => Loss 2.068, Loss_clf 0.312, Loss_fe 0.362, Loss_kd 0.697, Train_accy 71.63:  65%|██████▌   | 13/20 [06:45<03:21, 28.85s/it]
Task 1, Epoch 14/20 => Loss 2.068, Loss_clf 0.312, Loss_fe 0.362, Loss_kd 0.697, Train_accy 71.63:  70%|███████   | 14/20 [06:45<02:51, 28.57s/it]
Task 1, Epoch 15/20 => Loss 1.980, Loss_clf 0.306, Loss_fe 0.344, Loss_kd 0.665, Train_accy 74.04:  70%|███████   | 14/20 [07:13<02:51, 28.57s/it]
Task 1, Epoch 15/20 => Loss 1.980, Loss_clf 0.306, Loss_fe 0.344, Loss_kd 0.665, Train_accy 74.04:  75%|███████▌  | 15/20 [07:13<02:21, 28.37s/it]
Task 1, Epoch 16/20 => Loss 1.915, Loss_clf 0.265, Loss_fe 0.287, Loss_kd 0.681, Train_accy 72.96, Test_accy 81.18:  75%|███████▌  | 15/20 [07:47<02:21, 28.37s/it]
Task 1, Epoch 16/20 => Loss 1.915, Loss_clf 0.265, Loss_fe 0.287, Loss_kd 0.681, Train_accy 72.96, Test_accy 81.18:  80%|████████  | 16/20 [07:47<01:59, 29.91s/it]
Task 1, Epoch 17/20 => Loss 1.930, Loss_clf 0.271, Loss_fe 0.303, Loss_kd 0.678, Train_accy 72.00:  80%|████████  | 16/20 [08:15<01:59, 29.91s/it]                 
Task 1, Epoch 17/20 => Loss 1.930, Loss_clf 0.271, Loss_fe 0.303, Loss_kd 0.678, Train_accy 72.00:  85%|████████▌ | 17/20 [08:15<01:27, 29.31s/it]
Task 1, Epoch 18/20 => Loss 1.938, Loss_clf 0.276, Loss_fe 0.308, Loss_kd 0.677, Train_accy 71.89:  85%|████████▌ | 17/20 [08:43<01:27, 29.31s/it]
Task 1, Epoch 18/20 => Loss 1.938, Loss_clf 0.276, Loss_fe 0.308, Loss_kd 0.677, Train_accy 71.89:  90%|█████████ | 18/20 [08:43<00:57, 28.89s/it]
Task 1, Epoch 19/20 => Loss 1.948, Loss_clf 0.280, Loss_fe 0.317, Loss_kd 0.676, Train_accy 72.18:  90%|█████████ | 18/20 [09:11<00:57, 28.89s/it]
Task 1, Epoch 19/20 => Loss 1.948, Loss_clf 0.280, Loss_fe 0.317, Loss_kd 0.676, Train_accy 72.18:  95%|█████████▌| 19/20 [09:11<00:28, 28.60s/it]
Task 1, Epoch 20/20 => Loss 1.859, Loss_clf 0.256, Loss_fe 0.272, Loss_kd 0.666, Train_accy 72.82:  95%|█████████▌| 19/20 [09:38<00:28, 28.60s/it]
Task 1, Epoch 20/20 => Loss 1.859, Loss_clf 0.256, Loss_fe 0.272, Loss_kd 0.666, Train_accy 72.82: 100%|██████████| 20/20 [09:38<00:00, 28.38s/it]
Task 1, Epoch 20/20 => Loss 1.859, Loss_clf 0.256, Loss_fe 0.272, Loss_kd 0.666, Train_accy 72.82: 100%|██████████| 20/20 [09:38<00:00, 28.94s/it]
2024-09-05 01:55:37,972 [foster.py] => Task 1, Epoch 20/20 => Loss 1.859, Loss_clf 0.256, Loss_fe 0.272, Loss_kd 0.666, Train_accy 72.82
2024-09-05 01:55:37,973 [foster.py] => do not weight align teacher!
2024-09-05 01:55:37,978 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.772,  Train_accy 47.68, Test_accy 74.10:   0%|          | 0/20 [00:38<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.772,  Train_accy 47.68, Test_accy 74.10:   5%|▌         | 1/20 [00:38<12:07, 38.32s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.358,  Train_accy 60.28:   5%|▌         | 1/20 [01:13<12:07, 38.32s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.358,  Train_accy 60.28:  10%|█         | 2/20 [01:13<10:54, 36.35s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.279,  Train_accy 62.03:  10%|█         | 2/20 [01:48<10:54, 36.35s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.279,  Train_accy 62.03:  15%|█▌        | 3/20 [01:48<10:07, 35.72s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.237,  Train_accy 63.82:  15%|█▌        | 3/20 [02:23<10:07, 35.72s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.237,  Train_accy 63.82:  20%|██        | 4/20 [02:23<09:27, 35.44s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.223,  Train_accy 63.85:  20%|██        | 4/20 [02:58<09:27, 35.44s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.223,  Train_accy 63.85:  25%|██▌       | 5/20 [02:58<08:49, 35.29s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.233,  Train_accy 63.63, Test_accy 76.61:  25%|██▌       | 5/20 [03:36<08:49, 35.29s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.233,  Train_accy 63.63, Test_accy 76.61:  30%|███       | 6/20 [03:36<08:27, 36.27s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.200,  Train_accy 64.56:  30%|███       | 6/20 [04:11<08:27, 36.27s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.200,  Train_accy 64.56:  35%|███▌      | 7/20 [04:11<07:46, 35.85s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.253,  Train_accy 64.11:  35%|███▌      | 7/20 [04:46<07:46, 35.85s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.253,  Train_accy 64.11:  40%|████      | 8/20 [04:46<07:06, 35.56s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.287,  Train_accy 63.33:  40%|████      | 8/20 [05:21<07:06, 35.56s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.287,  Train_accy 63.33:  45%|████▌     | 9/20 [05:21<06:29, 35.37s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.229,  Train_accy 65.41:  45%|████▌     | 9/20 [05:56<06:29, 35.37s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.229,  Train_accy 65.41:  50%|█████     | 10/20 [05:56<05:52, 35.25s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.210,  Train_accy 64.34, Test_accy 76.28:  50%|█████     | 10/20 [06:34<05:52, 35.25s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.210,  Train_accy 64.34, Test_accy 76.28:  55%|█████▌    | 11/20 [06:34<05:25, 36.12s/it]
SNet: Task 1, Epoch 12/20 => Loss 1.195,  Train_accy 64.86:  55%|█████▌    | 11/20 [07:09<05:25, 36.12s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 1.195,  Train_accy 64.86:  60%|██████    | 12/20 [07:09<04:46, 35.76s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.203,  Train_accy 63.41:  60%|██████    | 12/20 [07:44<04:46, 35.76s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.203,  Train_accy 63.41:  65%|██████▌   | 13/20 [07:44<04:08, 35.53s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.236,  Train_accy 64.19:  65%|██████▌   | 13/20 [08:19<04:08, 35.53s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.236,  Train_accy 64.19:  70%|███████   | 14/20 [08:19<03:32, 35.37s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.212,  Train_accy 65.53:  70%|███████   | 14/20 [08:54<03:32, 35.37s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.212,  Train_accy 65.53:  75%|███████▌  | 15/20 [08:54<02:56, 35.25s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.184,  Train_accy 64.82, Test_accy 76.50:  75%|███████▌  | 15/20 [09:32<02:56, 35.25s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.184,  Train_accy 64.82, Test_accy 76.50:  80%|████████  | 16/20 [09:32<02:24, 36.11s/it]
SNet: Task 1, Epoch 17/20 => Loss 1.210,  Train_accy 65.60:  80%|████████  | 16/20 [10:07<02:24, 36.11s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 1.210,  Train_accy 65.60:  85%|████████▌ | 17/20 [10:07<01:47, 35.78s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.270,  Train_accy 64.56:  85%|████████▌ | 17/20 [10:42<01:47, 35.78s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.270,  Train_accy 64.56:  90%|█████████ | 18/20 [10:42<01:11, 35.57s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.224,  Train_accy 65.15:  90%|█████████ | 18/20 [11:17<01:11, 35.57s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.224,  Train_accy 65.15:  95%|█████████▌| 19/20 [11:17<00:35, 35.40s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.182,  Train_accy 65.08:  95%|█████████▌| 19/20 [11:52<00:35, 35.40s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.182,  Train_accy 65.08: 100%|██████████| 20/20 [11:52<00:00, 35.27s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.182,  Train_accy 65.08: 100%|██████████| 20/20 [11:52<00:00, 35.63s/it]
2024-09-05 02:07:32,017 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.182,  Train_accy 65.08
2024-09-05 02:07:32,018 [foster.py] => do not weight align student!
2024-09-05 02:07:35,159 [foster.py] => darknet eval: 
2024-09-05 02:07:35,159 [foster.py] => CNN top1 curve: 76.5
2024-09-05 02:07:35,160 [foster.py] => CNN top5 curve: 98.26
2024-09-05 02:07:35,162 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 02:08:45,267 [foster.py] => Exemplar size: 1600
2024-09-05 02:08:45,267 [trainer.py] => CNN: {'total': 81.39, '00-39': 96.92, '40-79': 66.24, 'old': 96.92, 'new': 66.24}
2024-09-05 02:08:45,267 [trainer.py] => NME: {'total': 92.06, '00-39': 92.29, '40-79': 91.83, 'old': 92.29, 'new': 91.83}
2024-09-05 02:08:45,267 [trainer.py] => CNN top1 curve: [96.92, 81.39]
2024-09-05 02:08:45,267 [trainer.py] => CNN top5 curve: [99.56, 98.69]
2024-09-05 02:08:45,267 [trainer.py] => NME top1 curve: [96.92, 92.06]
2024-09-05 02:08:45,267 [trainer.py] => NME top5 curve: [99.56, 99.24]

Average Accuracy (CNN): 89.16
Average Accuracy (NME): 94.49
2024-09-05 02:08:45,267 [trainer.py] => Average Accuracy (CNN): 89.16
2024-09-05 02:08:45,268 [trainer.py] => Average Accuracy (NME): 94.49
2024-09-05 02:08:45,269 [trainer.py] => All params: 171812552
2024-09-05 02:08:45,270 [trainer.py] => Trainable params: 85983136
2024-09-05 02:08:46,831 [foster.py] => Learning on 80-120
2024-09-05 02:08:46,832 [foster.py] => All params: 171935552
2024-09-05 02:08:46,833 [foster.py] => Trainable params: 86075376
2024-09-05 02:08:46,882 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 6.142, Loss_clf 1.736, Loss_fe 2.752, Loss_kd 1.103, Train_accy 48.76, Test_accy 67.09:   0%|          | 0/20 [00:43<?, ?it/s]
Task 2, Epoch 1/20 => Loss 6.142, Loss_clf 1.736, Loss_fe 2.752, Loss_kd 1.103, Train_accy 48.76, Test_accy 67.09:   5%|▌         | 1/20 [00:43<13:49, 43.67s/it]
Task 2, Epoch 2/20 => Loss 3.416, Loss_clf 0.837, Loss_fe 0.977, Loss_kd 1.068, Train_accy 54.30:   5%|▌         | 1/20 [01:19<13:49, 43.67s/it]                 
Task 2, Epoch 2/20 => Loss 3.416, Loss_clf 0.837, Loss_fe 0.977, Loss_kd 1.068, Train_accy 54.30:  10%|█         | 2/20 [01:19<11:41, 38.96s/it]
Task 2, Epoch 3/20 => Loss 3.029, Loss_clf 0.673, Loss_fe 0.760, Loss_kd 1.064, Train_accy 57.59:  10%|█         | 2/20 [01:55<11:41, 38.96s/it]
Task 2, Epoch 3/20 => Loss 3.029, Loss_clf 0.673, Loss_fe 0.760, Loss_kd 1.064, Train_accy 57.59:  15%|█▌        | 3/20 [01:55<10:37, 37.49s/it]
Task 2, Epoch 4/20 => Loss 2.854, Loss_clf 0.597, Loss_fe 0.655, Loss_kd 1.068, Train_accy 58.68:  15%|█▌        | 3/20 [02:30<10:37, 37.49s/it]
Task 2, Epoch 4/20 => Loss 2.854, Loss_clf 0.597, Loss_fe 0.655, Loss_kd 1.068, Train_accy 58.68:  20%|██        | 4/20 [02:30<09:49, 36.82s/it]
Task 2, Epoch 5/20 => Loss 2.796, Loss_clf 0.578, Loss_fe 0.607, Loss_kd 1.074, Train_accy 59.03:  20%|██        | 4/20 [03:06<09:49, 36.82s/it]
Task 2, Epoch 5/20 => Loss 2.796, Loss_clf 0.578, Loss_fe 0.607, Loss_kd 1.074, Train_accy 59.03:  25%|██▌       | 5/20 [03:06<09:07, 36.49s/it]
Task 2, Epoch 6/20 => Loss 2.623, Loss_clf 0.515, Loss_fe 0.513, Loss_kd 1.064, Train_accy 60.27, Test_accy 70.97:  25%|██▌       | 5/20 [03:51<09:07, 36.49s/it]
Task 2, Epoch 6/20 => Loss 2.623, Loss_clf 0.515, Loss_fe 0.513, Loss_kd 1.064, Train_accy 60.27, Test_accy 70.97:  30%|███       | 6/20 [03:51<09:07, 39.14s/it]
Task 2, Epoch 7/20 => Loss 2.544, Loss_clf 0.476, Loss_fe 0.470, Loss_kd 1.065, Train_accy 61.83:  30%|███       | 6/20 [04:26<09:07, 39.14s/it]                 
Task 2, Epoch 7/20 => Loss 2.544, Loss_clf 0.476, Loss_fe 0.470, Loss_kd 1.065, Train_accy 61.83:  35%|███▌      | 7/20 [04:26<08:14, 38.05s/it]
Task 2, Epoch 8/20 => Loss 2.443, Loss_clf 0.432, Loss_fe 0.429, Loss_kd 1.055, Train_accy 62.64:  35%|███▌      | 7/20 [05:02<08:14, 38.05s/it]
Task 2, Epoch 8/20 => Loss 2.443, Loss_clf 0.432, Loss_fe 0.429, Loss_kd 1.055, Train_accy 62.64:  40%|████      | 8/20 [05:02<07:28, 37.34s/it]
Task 2, Epoch 9/20 => Loss 2.476, Loss_clf 0.453, Loss_fe 0.421, Loss_kd 1.068, Train_accy 61.86:  40%|████      | 8/20 [05:38<07:28, 37.34s/it]
Task 2, Epoch 9/20 => Loss 2.476, Loss_clf 0.453, Loss_fe 0.421, Loss_kd 1.068, Train_accy 61.86:  45%|████▌     | 9/20 [05:38<06:45, 36.86s/it]
Task 2, Epoch 10/20 => Loss 2.348, Loss_clf 0.413, Loss_fe 0.366, Loss_kd 1.046, Train_accy 63.42:  45%|████▌     | 9/20 [06:14<06:45, 36.86s/it]
Task 2, Epoch 10/20 => Loss 2.348, Loss_clf 0.413, Loss_fe 0.366, Loss_kd 1.046, Train_accy 63.42:  50%|█████     | 10/20 [06:14<06:05, 36.52s/it]
Task 2, Epoch 11/20 => Loss 2.456, Loss_clf 0.434, Loss_fe 0.397, Loss_kd 1.083, Train_accy 64.43, Test_accy 71.68:  50%|█████     | 10/20 [06:58<06:05, 36.52s/it]
Task 2, Epoch 11/20 => Loss 2.456, Loss_clf 0.434, Loss_fe 0.397, Loss_kd 1.083, Train_accy 64.43, Test_accy 71.68:  55%|█████▌    | 11/20 [06:58<05:49, 38.86s/it]
Task 2, Epoch 12/20 => Loss 2.385, Loss_clf 0.411, Loss_fe 0.362, Loss_kd 1.075, Train_accy 63.99:  55%|█████▌    | 11/20 [07:34<05:49, 38.86s/it]                 
Task 2, Epoch 12/20 => Loss 2.385, Loss_clf 0.411, Loss_fe 0.362, Loss_kd 1.075, Train_accy 63.99:  60%|██████    | 12/20 [07:34<05:03, 37.91s/it]
Task 2, Epoch 13/20 => Loss 2.311, Loss_clf 0.389, Loss_fe 0.334, Loss_kd 1.058, Train_accy 65.38:  60%|██████    | 12/20 [08:09<05:03, 37.91s/it]
Task 2, Epoch 13/20 => Loss 2.311, Loss_clf 0.389, Loss_fe 0.334, Loss_kd 1.058, Train_accy 65.38:  65%|██████▌   | 13/20 [08:09<04:20, 37.28s/it]
Task 2, Epoch 14/20 => Loss 2.216, Loss_clf 0.348, Loss_fe 0.296, Loss_kd 1.048, Train_accy 65.26:  65%|██████▌   | 13/20 [08:45<04:20, 37.28s/it]
Task 2, Epoch 14/20 => Loss 2.216, Loss_clf 0.348, Loss_fe 0.296, Loss_kd 1.048, Train_accy 65.26:  70%|███████   | 14/20 [08:45<03:40, 36.83s/it]
Task 2, Epoch 15/20 => Loss 2.285, Loss_clf 0.367, Loss_fe 0.305, Loss_kd 1.076, Train_accy 65.98:  70%|███████   | 14/20 [09:21<03:40, 36.83s/it]
Task 2, Epoch 15/20 => Loss 2.285, Loss_clf 0.367, Loss_fe 0.305, Loss_kd 1.076, Train_accy 65.98:  75%|███████▌  | 15/20 [09:21<03:02, 36.53s/it]
Task 2, Epoch 16/20 => Loss 2.251, Loss_clf 0.370, Loss_fe 0.292, Loss_kd 1.060, Train_accy 65.09, Test_accy 72.46:  75%|███████▌  | 15/20 [10:05<03:02, 36.53s/it]
Task 2, Epoch 16/20 => Loss 2.251, Loss_clf 0.370, Loss_fe 0.292, Loss_kd 1.060, Train_accy 65.09, Test_accy 72.46:  80%|████████  | 16/20 [10:05<02:35, 38.85s/it]
Task 2, Epoch 17/20 => Loss 2.187, Loss_clf 0.320, Loss_fe 0.260, Loss_kd 1.071, Train_accy 66.36:  80%|████████  | 16/20 [10:41<02:35, 38.85s/it]                 
Task 2, Epoch 17/20 => Loss 2.187, Loss_clf 0.320, Loss_fe 0.260, Loss_kd 1.071, Train_accy 66.36:  85%|████████▌ | 17/20 [10:41<01:53, 37.93s/it]
Task 2, Epoch 18/20 => Loss 2.238, Loss_clf 0.354, Loss_fe 0.286, Loss_kd 1.065, Train_accy 66.01:  85%|████████▌ | 17/20 [11:17<01:53, 37.93s/it]
Task 2, Epoch 18/20 => Loss 2.238, Loss_clf 0.354, Loss_fe 0.286, Loss_kd 1.065, Train_accy 66.01:  90%|█████████ | 18/20 [11:17<01:14, 37.32s/it]
Task 2, Epoch 19/20 => Loss 2.231, Loss_clf 0.343, Loss_fe 0.278, Loss_kd 1.073, Train_accy 65.93:  90%|█████████ | 18/20 [11:53<01:14, 37.32s/it]
Task 2, Epoch 19/20 => Loss 2.231, Loss_clf 0.343, Loss_fe 0.278, Loss_kd 1.073, Train_accy 65.93:  95%|█████████▌| 19/20 [11:53<00:36, 36.86s/it]
Task 2, Epoch 20/20 => Loss 2.270, Loss_clf 0.368, Loss_fe 0.302, Loss_kd 1.066, Train_accy 65.44:  95%|█████████▌| 19/20 [12:29<00:36, 36.86s/it]
Task 2, Epoch 20/20 => Loss 2.270, Loss_clf 0.368, Loss_fe 0.302, Loss_kd 1.066, Train_accy 65.44: 100%|██████████| 20/20 [12:29<00:00, 36.54s/it]
Task 2, Epoch 20/20 => Loss 2.270, Loss_clf 0.368, Loss_fe 0.302, Loss_kd 1.066, Train_accy 65.44: 100%|██████████| 20/20 [12:29<00:00, 37.46s/it]
2024-09-05 02:21:16,007 [foster.py] => Task 2, Epoch 20/20 => Loss 2.270, Loss_clf 0.368, Loss_fe 0.302, Loss_kd 1.066, Train_accy 65.44
2024-09-05 02:21:16,008 [foster.py] => do not weight align teacher!
2024-09-05 02:21:16,013 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.852,  Train_accy 45.44, Test_accy 68.50:   0%|          | 0/20 [00:49<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.852,  Train_accy 45.44, Test_accy 68.50:   5%|▌         | 1/20 [00:49<15:44, 49.72s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.596,  Train_accy 52.25:   5%|▌         | 1/20 [01:34<15:44, 49.72s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.596,  Train_accy 52.25:  10%|█         | 2/20 [01:34<14:04, 46.94s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.560,  Train_accy 53.38:  10%|█         | 2/20 [02:19<14:04, 46.94s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.560,  Train_accy 53.38:  15%|█▌        | 3/20 [02:19<13:02, 46.05s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.538,  Train_accy 55.08:  15%|█▌        | 3/20 [03:04<13:02, 46.05s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.538,  Train_accy 55.08:  20%|██        | 4/20 [03:04<12:10, 45.63s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.542,  Train_accy 54.70:  20%|██        | 4/20 [03:49<12:10, 45.63s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.542,  Train_accy 54.70:  25%|██▌       | 5/20 [03:49<11:20, 45.40s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.552,  Train_accy 55.42, Test_accy 69.84:  25%|██▌       | 5/20 [04:39<11:20, 45.40s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.552,  Train_accy 55.42, Test_accy 69.84:  30%|███       | 6/20 [04:39<10:55, 46.82s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.552,  Train_accy 55.45:  30%|███       | 6/20 [05:24<10:55, 46.82s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.552,  Train_accy 55.45:  35%|███▌      | 7/20 [05:24<10:00, 46.22s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.540,  Train_accy 55.19:  35%|███▌      | 7/20 [06:09<10:00, 46.22s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.540,  Train_accy 55.19:  40%|████      | 8/20 [06:09<09:10, 45.83s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.529,  Train_accy 56.84:  40%|████      | 8/20 [06:54<09:10, 45.83s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.529,  Train_accy 56.84:  45%|████▌     | 9/20 [06:54<08:21, 45.58s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.517,  Train_accy 56.15:  45%|████▌     | 9/20 [07:39<08:21, 45.58s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.517,  Train_accy 56.15:  50%|█████     | 10/20 [07:39<07:33, 45.39s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.485,  Train_accy 56.78, Test_accy 68.79:  50%|█████     | 10/20 [08:28<07:33, 45.39s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.485,  Train_accy 56.78, Test_accy 68.79:  55%|█████▌    | 11/20 [08:28<07:00, 46.69s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.534,  Train_accy 56.26:  55%|█████▌    | 11/20 [09:13<07:00, 46.69s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.534,  Train_accy 56.26:  60%|██████    | 12/20 [09:13<06:09, 46.18s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.508,  Train_accy 56.35:  60%|██████    | 12/20 [09:58<06:09, 46.18s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.508,  Train_accy 56.35:  65%|██████▌   | 13/20 [09:58<05:20, 45.81s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.515,  Train_accy 56.64:  65%|██████▌   | 13/20 [10:43<05:20, 45.81s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.515,  Train_accy 56.64:  70%|███████   | 14/20 [10:43<04:33, 45.58s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.506,  Train_accy 56.95:  70%|███████   | 14/20 [11:28<04:33, 45.58s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.506,  Train_accy 56.95:  75%|███████▌  | 15/20 [11:28<03:46, 45.40s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.514,  Train_accy 56.29, Test_accy 69.21:  75%|███████▌  | 15/20 [12:18<03:46, 45.40s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.514,  Train_accy 56.29, Test_accy 69.21:  80%|████████  | 16/20 [12:18<03:06, 46.66s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.516,  Train_accy 55.65:  80%|████████  | 16/20 [13:03<03:06, 46.66s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.516,  Train_accy 55.65:  85%|████████▌ | 17/20 [13:03<02:18, 46.16s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.495,  Train_accy 57.10:  85%|████████▌ | 17/20 [13:48<02:18, 46.16s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.495,  Train_accy 57.10:  90%|█████████ | 18/20 [13:48<01:31, 45.80s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.547,  Train_accy 55.60:  90%|█████████ | 18/20 [14:33<01:31, 45.80s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.547,  Train_accy 55.60:  95%|█████████▌| 19/20 [14:33<00:45, 45.56s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.528,  Train_accy 56.46:  95%|█████████▌| 19/20 [15:18<00:45, 45.56s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.528,  Train_accy 56.46: 100%|██████████| 20/20 [15:18<00:00, 45.40s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.528,  Train_accy 56.46: 100%|██████████| 20/20 [15:18<00:00, 45.92s/it]
2024-09-05 02:36:35,906 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.528,  Train_accy 56.46
2024-09-05 02:36:35,907 [foster.py] => do not weight align student!
2024-09-05 02:36:40,494 [foster.py] => darknet eval: 
2024-09-05 02:36:40,494 [foster.py] => CNN top1 curve: 69.0
2024-09-05 02:36:40,494 [foster.py] => CNN top5 curve: 97.39
2024-09-05 02:36:40,498 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 02:38:17,459 [foster.py] => Exemplar size: 2400
2024-09-05 02:38:17,459 [trainer.py] => CNN: {'total': 72.95, '00-39': 95.59, '40-79': 78.49, '80-119': 47.08, 'old': 86.94, 'new': 47.08}
2024-09-05 02:38:17,459 [trainer.py] => NME: {'total': 89.27, '00-39': 89.21, '40-79': 88.39, '80-119': 90.14, 'old': 88.79, 'new': 90.14}
2024-09-05 02:38:17,459 [trainer.py] => CNN top1 curve: [96.92, 81.39, 72.95]
2024-09-05 02:38:17,459 [trainer.py] => CNN top5 curve: [99.56, 98.69, 97.74]
2024-09-05 02:38:17,459 [trainer.py] => NME top1 curve: [96.92, 92.06, 89.27]
2024-09-05 02:38:17,459 [trainer.py] => NME top5 curve: [99.56, 99.24, 98.73]

Average Accuracy (CNN): 83.75
Average Accuracy (NME): 92.75
2024-09-05 02:38:17,459 [trainer.py] => Average Accuracy (CNN): 83.75
2024-09-05 02:38:17,459 [trainer.py] => Average Accuracy (NME): 92.75
2024-09-05 02:38:17,460 [trainer.py] => All params: 171935552
2024-09-05 02:38:17,461 [trainer.py] => Trainable params: 86075376
2024-09-05 02:38:18,993 [foster.py] => Learning on 120-160
2024-09-05 02:38:18,995 [foster.py] => All params: 172058552
2024-09-05 02:38:18,996 [foster.py] => Trainable params: 86167616
2024-09-05 02:38:19,045 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 6.744, Loss_clf 1.734, Loss_fe 3.154, Loss_kd 1.392, Train_accy 51.43, Test_accy 69.75:   0%|          | 0/20 [00:54<?, ?it/s]
Task 3, Epoch 1/20 => Loss 6.744, Loss_clf 1.734, Loss_fe 3.154, Loss_kd 1.392, Train_accy 51.43, Test_accy 69.75:   5%|▌         | 1/20 [00:54<17:10, 54.25s/it]
Task 3, Epoch 2/20 => Loss 3.913, Loss_clf 0.892, Loss_fe 1.155, Loss_kd 1.400, Train_accy 56.25:   5%|▌         | 1/20 [01:38<17:10, 54.25s/it]                 
Task 3, Epoch 2/20 => Loss 3.913, Loss_clf 0.892, Loss_fe 1.155, Loss_kd 1.400, Train_accy 56.25:  10%|█         | 2/20 [01:38<14:25, 48.08s/it]
Task 3, Epoch 3/20 => Loss 3.602, Loss_clf 0.818, Loss_fe 0.928, Loss_kd 1.391, Train_accy 57.67:  10%|█         | 2/20 [02:21<14:25, 48.08s/it]
Task 3, Epoch 3/20 => Loss 3.602, Loss_clf 0.818, Loss_fe 0.928, Loss_kd 1.391, Train_accy 57.67:  15%|█▌        | 3/20 [02:21<13:04, 46.17s/it]
Task 3, Epoch 4/20 => Loss 3.612, Loss_clf 0.823, Loss_fe 0.873, Loss_kd 1.437, Train_accy 58.96:  15%|█▌        | 3/20 [03:05<13:04, 46.17s/it]
Task 3, Epoch 4/20 => Loss 3.612, Loss_clf 0.823, Loss_fe 0.873, Loss_kd 1.437, Train_accy 58.96:  20%|██        | 4/20 [03:05<12:05, 45.32s/it]
Task 3, Epoch 5/20 => Loss 3.194, Loss_clf 0.659, Loss_fe 0.680, Loss_kd 1.391, Train_accy 59.69:  20%|██        | 4/20 [03:49<12:05, 45.32s/it]
Task 3, Epoch 5/20 => Loss 3.194, Loss_clf 0.659, Loss_fe 0.680, Loss_kd 1.391, Train_accy 59.69:  25%|██▌       | 5/20 [03:49<11:13, 44.87s/it]
Task 3, Epoch 6/20 => Loss 3.166, Loss_clf 0.641, Loss_fe 0.665, Loss_kd 1.395, Train_accy 61.07, Test_accy 69.54:  25%|██▌       | 5/20 [04:45<11:13, 44.87s/it]
Task 3, Epoch 6/20 => Loss 3.166, Loss_clf 0.641, Loss_fe 0.665, Loss_kd 1.395, Train_accy 61.07, Test_accy 69.54:  30%|███       | 6/20 [04:45<11:17, 48.42s/it]
Task 3, Epoch 7/20 => Loss 3.091, Loss_clf 0.618, Loss_fe 0.622, Loss_kd 1.389, Train_accy 61.65:  30%|███       | 6/20 [05:29<11:17, 48.42s/it]                 
Task 3, Epoch 7/20 => Loss 3.091, Loss_clf 0.618, Loss_fe 0.622, Loss_kd 1.389, Train_accy 61.65:  35%|███▌      | 7/20 [05:29<10:11, 47.01s/it]
Task 3, Epoch 8/20 => Loss 3.296, Loss_clf 0.776, Loss_fe 0.686, Loss_kd 1.375, Train_accy 60.06:  35%|███▌      | 7/20 [06:13<10:11, 47.01s/it]
Task 3, Epoch 8/20 => Loss 3.296, Loss_clf 0.776, Loss_fe 0.686, Loss_kd 1.375, Train_accy 60.06:  40%|████      | 8/20 [06:13<09:12, 46.07s/it]
Task 3, Epoch 9/20 => Loss 2.882, Loss_clf 0.538, Loss_fe 0.516, Loss_kd 1.371, Train_accy 63.15:  40%|████      | 8/20 [06:57<09:12, 46.07s/it]
Task 3, Epoch 9/20 => Loss 2.882, Loss_clf 0.538, Loss_fe 0.516, Loss_kd 1.371, Train_accy 63.15:  45%|████▌     | 9/20 [06:57<08:20, 45.46s/it]
Task 3, Epoch 10/20 => Loss 2.896, Loss_clf 0.553, Loss_fe 0.536, Loss_kd 1.355, Train_accy 63.34:  45%|████▌     | 9/20 [07:41<08:20, 45.46s/it]
Task 3, Epoch 10/20 => Loss 2.896, Loss_clf 0.553, Loss_fe 0.536, Loss_kd 1.355, Train_accy 63.34:  50%|█████     | 10/20 [07:41<07:30, 45.04s/it]
Task 3, Epoch 11/20 => Loss 2.801, Loss_clf 0.504, Loss_fe 0.455, Loss_kd 1.381, Train_accy 64.88, Test_accy 72.03:  50%|█████     | 10/20 [08:36<07:30, 45.04s/it]
Task 3, Epoch 11/20 => Loss 2.801, Loss_clf 0.504, Loss_fe 0.455, Loss_kd 1.381, Train_accy 64.88, Test_accy 72.03:  55%|█████▌    | 11/20 [08:36<07:13, 48.16s/it]
Task 3, Epoch 12/20 => Loss 2.738, Loss_clf 0.496, Loss_fe 0.426, Loss_kd 1.361, Train_accy 64.55:  55%|█████▌    | 11/20 [09:21<07:13, 48.16s/it]                 
Task 3, Epoch 12/20 => Loss 2.738, Loss_clf 0.496, Loss_fe 0.426, Loss_kd 1.361, Train_accy 64.55:  60%|██████    | 12/20 [09:21<06:15, 46.93s/it]
Task 3, Epoch 13/20 => Loss 2.684, Loss_clf 0.466, Loss_fe 0.403, Loss_kd 1.361, Train_accy 64.97:  60%|██████    | 12/20 [10:05<06:15, 46.93s/it]
Task 3, Epoch 13/20 => Loss 2.684, Loss_clf 0.466, Loss_fe 0.403, Loss_kd 1.361, Train_accy 64.97:  65%|██████▌   | 13/20 [10:05<05:22, 46.09s/it]
Task 3, Epoch 14/20 => Loss 2.635, Loss_clf 0.447, Loss_fe 0.371, Loss_kd 1.363, Train_accy 65.68:  65%|██████▌   | 13/20 [10:49<05:22, 46.09s/it]
Task 3, Epoch 14/20 => Loss 2.635, Loss_clf 0.447, Loss_fe 0.371, Loss_kd 1.363, Train_accy 65.68:  70%|███████   | 14/20 [10:49<04:32, 45.49s/it]
Task 3, Epoch 15/20 => Loss 2.609, Loss_clf 0.438, Loss_fe 0.351, Loss_kd 1.364, Train_accy 66.12:  70%|███████   | 14/20 [11:33<04:32, 45.49s/it]
Task 3, Epoch 15/20 => Loss 2.609, Loss_clf 0.438, Loss_fe 0.351, Loss_kd 1.364, Train_accy 66.12:  75%|███████▌  | 15/20 [11:33<03:45, 45.08s/it]
Task 3, Epoch 16/20 => Loss 2.572, Loss_clf 0.427, Loss_fe 0.350, Loss_kd 1.346, Train_accy 65.58, Test_accy 71.66:  75%|███████▌  | 15/20 [12:28<03:45, 45.08s/it]
Task 3, Epoch 16/20 => Loss 2.572, Loss_clf 0.427, Loss_fe 0.350, Loss_kd 1.346, Train_accy 65.58, Test_accy 71.66:  80%|████████  | 16/20 [12:28<03:12, 48.13s/it]
Task 3, Epoch 17/20 => Loss 2.619, Loss_clf 0.432, Loss_fe 0.353, Loss_kd 1.376, Train_accy 66.87:  80%|████████  | 16/20 [13:12<03:12, 48.13s/it]                 
Task 3, Epoch 17/20 => Loss 2.619, Loss_clf 0.432, Loss_fe 0.353, Loss_kd 1.376, Train_accy 66.87:  85%|████████▌ | 17/20 [13:12<02:20, 46.93s/it]
Task 3, Epoch 18/20 => Loss 2.694, Loss_clf 0.458, Loss_fe 0.403, Loss_kd 1.374, Train_accy 66.38:  85%|████████▌ | 17/20 [13:56<02:20, 46.93s/it]
Task 3, Epoch 18/20 => Loss 2.694, Loss_clf 0.458, Loss_fe 0.403, Loss_kd 1.374, Train_accy 66.38:  90%|█████████ | 18/20 [13:56<01:32, 46.09s/it]
Task 3, Epoch 19/20 => Loss 2.593, Loss_clf 0.425, Loss_fe 0.347, Loss_kd 1.366, Train_accy 66.03:  90%|█████████ | 18/20 [14:41<01:32, 46.09s/it]
Task 3, Epoch 19/20 => Loss 2.593, Loss_clf 0.425, Loss_fe 0.347, Loss_kd 1.366, Train_accy 66.03:  95%|█████████▌| 19/20 [14:41<00:45, 45.50s/it]
Task 3, Epoch 20/20 => Loss 2.637, Loss_clf 0.455, Loss_fe 0.358, Loss_kd 1.368, Train_accy 65.30:  95%|█████████▌| 19/20 [15:25<00:45, 45.50s/it]
Task 3, Epoch 20/20 => Loss 2.637, Loss_clf 0.455, Loss_fe 0.358, Loss_kd 1.368, Train_accy 65.30: 100%|██████████| 20/20 [15:25<00:00, 45.07s/it]
Task 3, Epoch 20/20 => Loss 2.637, Loss_clf 0.455, Loss_fe 0.358, Loss_kd 1.368, Train_accy 65.30: 100%|██████████| 20/20 [15:25<00:00, 46.26s/it]
2024-09-05 02:53:44,178 [foster.py] => Task 3, Epoch 20/20 => Loss 2.637, Loss_clf 0.455, Loss_fe 0.358, Loss_kd 1.368, Train_accy 65.30
2024-09-05 02:53:44,179 [foster.py] => do not weight align teacher!
2024-09-05 02:53:44,184 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.938,  Train_accy 49.25, Test_accy 67.27:   0%|          | 0/20 [01:01<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.938,  Train_accy 49.25, Test_accy 67.27:   5%|▌         | 1/20 [01:01<19:26, 61.39s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.774,  Train_accy 54.75:   5%|▌         | 1/20 [01:56<19:26, 61.39s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.774,  Train_accy 54.75:  10%|█         | 2/20 [01:56<17:21, 57.85s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.773,  Train_accy 55.10:  10%|█         | 2/20 [02:52<17:21, 57.85s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.773,  Train_accy 55.10:  15%|█▌        | 3/20 [02:52<16:04, 56.74s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.726,  Train_accy 56.79:  15%|█▌        | 3/20 [03:47<16:04, 56.74s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.726,  Train_accy 56.79:  20%|██        | 4/20 [03:47<14:59, 56.21s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.725,  Train_accy 58.21:  20%|██        | 4/20 [04:43<14:59, 56.21s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.725,  Train_accy 58.21:  25%|██▌       | 5/20 [04:43<13:58, 55.93s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.762,  Train_accy 56.86, Test_accy 68.80:  25%|██▌       | 5/20 [05:44<13:58, 55.93s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.762,  Train_accy 56.86, Test_accy 68.80:  30%|███       | 6/20 [05:44<13:29, 57.79s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.702,  Train_accy 58.70:  30%|███       | 6/20 [06:39<13:29, 57.79s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.702,  Train_accy 58.70:  35%|███▌      | 7/20 [06:39<12:21, 57.03s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.713,  Train_accy 58.17:  35%|███▌      | 7/20 [07:35<12:21, 57.03s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.713,  Train_accy 58.17:  40%|████      | 8/20 [07:35<11:18, 56.53s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.701,  Train_accy 59.05:  40%|████      | 8/20 [08:30<11:18, 56.53s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.701,  Train_accy 59.05:  45%|████▌     | 9/20 [08:30<10:18, 56.18s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.738,  Train_accy 58.00:  45%|████▌     | 9/20 [09:26<10:18, 56.18s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.738,  Train_accy 58.00:  50%|█████     | 10/20 [09:26<09:19, 55.95s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.703,  Train_accy 59.10, Test_accy 68.80:  50%|█████     | 10/20 [10:27<09:19, 55.95s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.703,  Train_accy 59.10, Test_accy 68.80:  55%|█████▌    | 11/20 [10:27<08:38, 57.63s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.735,  Train_accy 59.48:  55%|█████▌    | 11/20 [11:23<08:38, 57.63s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.735,  Train_accy 59.48:  60%|██████    | 12/20 [11:23<07:35, 56.98s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.697,  Train_accy 59.05:  60%|██████    | 12/20 [12:18<07:35, 56.98s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.697,  Train_accy 59.05:  65%|██████▌   | 13/20 [12:18<06:35, 56.51s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.697,  Train_accy 58.82:  65%|██████▌   | 13/20 [13:13<06:35, 56.51s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.697,  Train_accy 58.82:  70%|███████   | 14/20 [13:13<05:36, 56.16s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.700,  Train_accy 59.12:  70%|███████   | 14/20 [14:09<05:36, 56.16s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.700,  Train_accy 59.12:  75%|███████▌  | 15/20 [14:09<04:39, 55.95s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.698,  Train_accy 59.12, Test_accy 68.85:  75%|███████▌  | 15/20 [15:10<04:39, 55.95s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.698,  Train_accy 59.12, Test_accy 68.85:  80%|████████  | 16/20 [15:10<03:50, 57.60s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.679,  Train_accy 60.01:  80%|████████  | 16/20 [16:06<03:50, 57.60s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.679,  Train_accy 60.01:  85%|████████▌ | 17/20 [16:06<02:50, 56.93s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.703,  Train_accy 58.94:  85%|████████▌ | 17/20 [17:01<02:50, 56.93s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.703,  Train_accy 58.94:  90%|█████████ | 18/20 [17:01<01:52, 56.46s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.659,  Train_accy 59.24:  90%|█████████ | 18/20 [17:56<01:52, 56.46s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.659,  Train_accy 59.24:  95%|█████████▌| 19/20 [17:56<00:56, 56.14s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.695,  Train_accy 58.70:  95%|█████████▌| 19/20 [18:52<00:56, 56.14s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.695,  Train_accy 58.70: 100%|██████████| 20/20 [18:52<00:00, 55.92s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.695,  Train_accy 58.70: 100%|██████████| 20/20 [18:52<00:00, 56.62s/it]
2024-09-05 03:12:38,049 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.695,  Train_accy 58.70
2024-09-05 03:12:38,049 [foster.py] => do not weight align student!
2024-09-05 03:12:44,032 [foster.py] => darknet eval: 
2024-09-05 03:12:44,033 [foster.py] => CNN top1 curve: 69.01
2024-09-05 03:12:44,033 [foster.py] => CNN top5 curve: 94.82
2024-09-05 03:12:44,035 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 03:14:46,151 [foster.py] => Exemplar size: 3200
2024-09-05 03:14:46,152 [trainer.py] => CNN: {'total': 71.07, '00-39': 95.15, '40-79': 83.66, '80-119': 72.23, '120-159': 34.53, 'old': 83.33, 'new': 34.53}
2024-09-05 03:14:46,152 [trainer.py] => NME: {'total': 87.63, '00-39': 88.55, '40-79': 88.39, '80-119': 85.71, '120-159': 88.0, 'old': 87.5, 'new': 88.0}
2024-09-05 03:14:46,152 [trainer.py] => CNN top1 curve: [96.92, 81.39, 72.95, 71.07]
2024-09-05 03:14:46,152 [trainer.py] => CNN top5 curve: [99.56, 98.69, 97.74, 96.46]
2024-09-05 03:14:46,152 [trainer.py] => NME top1 curve: [96.92, 92.06, 89.27, 87.63]
2024-09-05 03:14:46,152 [trainer.py] => NME top5 curve: [99.56, 99.24, 98.73, 98.57]

Average Accuracy (CNN): 80.58
Average Accuracy (NME): 91.47
2024-09-05 03:14:46,152 [trainer.py] => Average Accuracy (CNN): 80.58
2024-09-05 03:14:46,152 [trainer.py] => Average Accuracy (NME): 91.47
2024-09-05 03:14:46,153 [trainer.py] => All params: 172058552
2024-09-05 03:14:46,154 [trainer.py] => Trainable params: 86167616
2024-09-05 03:14:47,580 [foster.py] => Learning on 160-200
2024-09-05 03:14:47,582 [foster.py] => All params: 172181552
2024-09-05 03:14:47,582 [foster.py] => Trainable params: 86259856
2024-09-05 03:14:47,634 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 7.160, Loss_clf 1.746, Loss_fe 3.406, Loss_kd 1.607, Train_accy 54.64, Test_accy 68.66:   0%|          | 0/20 [01:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 7.160, Loss_clf 1.746, Loss_fe 3.406, Loss_kd 1.607, Train_accy 54.64, Test_accy 68.66:   5%|▌         | 1/20 [01:05<20:37, 65.11s/it]
Task 4, Epoch 2/20 => Loss 4.286, Loss_clf 0.970, Loss_fe 1.342, Loss_kd 1.580, Train_accy 57.12:   5%|▌         | 1/20 [01:57<20:37, 65.11s/it]                 
Task 4, Epoch 2/20 => Loss 4.286, Loss_clf 0.970, Loss_fe 1.342, Loss_kd 1.580, Train_accy 57.12:  10%|█         | 2/20 [01:57<17:15, 57.51s/it]
Task 4, Epoch 3/20 => Loss 3.932, Loss_clf 0.867, Loss_fe 1.063, Loss_kd 1.602, Train_accy 57.98:  10%|█         | 2/20 [02:49<17:15, 57.51s/it]
Task 4, Epoch 3/20 => Loss 3.932, Loss_clf 0.867, Loss_fe 1.063, Loss_kd 1.602, Train_accy 57.98:  15%|█▌        | 3/20 [02:49<15:38, 55.22s/it]
Task 4, Epoch 4/20 => Loss 3.581, Loss_clf 0.764, Loss_fe 0.852, Loss_kd 1.571, Train_accy 60.47:  15%|█▌        | 3/20 [03:42<15:38, 55.22s/it]
Task 4, Epoch 4/20 => Loss 3.581, Loss_clf 0.764, Loss_fe 0.852, Loss_kd 1.571, Train_accy 60.47:  20%|██        | 4/20 [03:42<14:26, 54.17s/it]
Task 4, Epoch 5/20 => Loss 3.351, Loss_clf 0.678, Loss_fe 0.731, Loss_kd 1.553, Train_accy 61.43:  20%|██        | 4/20 [04:35<14:26, 54.17s/it]
Task 4, Epoch 5/20 => Loss 3.351, Loss_clf 0.678, Loss_fe 0.731, Loss_kd 1.553, Train_accy 61.43:  25%|██▌       | 5/20 [04:35<13:24, 53.62s/it]
Task 4, Epoch 6/20 => Loss 3.403, Loss_clf 0.700, Loss_fe 0.719, Loss_kd 1.587, Train_accy 61.04, Test_accy 71.42:  25%|██▌       | 5/20 [05:41<13:24, 53.62s/it]
Task 4, Epoch 6/20 => Loss 3.403, Loss_clf 0.700, Loss_fe 0.719, Loss_kd 1.587, Train_accy 61.04, Test_accy 71.42:  30%|███       | 6/20 [05:41<13:30, 57.93s/it]
Task 4, Epoch 7/20 => Loss 3.277, Loss_clf 0.664, Loss_fe 0.645, Loss_kd 1.575, Train_accy 61.96:  30%|███       | 6/20 [06:33<13:30, 57.93s/it]                 
Task 4, Epoch 7/20 => Loss 3.277, Loss_clf 0.664, Loss_fe 0.645, Loss_kd 1.575, Train_accy 61.96:  35%|███▌      | 7/20 [06:33<12:10, 56.19s/it]
Task 4, Epoch 8/20 => Loss 3.161, Loss_clf 0.622, Loss_fe 0.585, Loss_kd 1.563, Train_accy 63.01:  35%|███▌      | 7/20 [07:26<12:10, 56.19s/it]
Task 4, Epoch 8/20 => Loss 3.161, Loss_clf 0.622, Loss_fe 0.585, Loss_kd 1.563, Train_accy 63.01:  40%|████      | 8/20 [07:26<11:00, 55.06s/it]
Task 4, Epoch 9/20 => Loss 3.068, Loss_clf 0.575, Loss_fe 0.542, Loss_kd 1.561, Train_accy 63.35:  40%|████      | 8/20 [08:19<11:00, 55.06s/it]
Task 4, Epoch 9/20 => Loss 3.068, Loss_clf 0.575, Loss_fe 0.542, Loss_kd 1.561, Train_accy 63.35:  45%|████▌     | 9/20 [08:19<09:57, 54.29s/it]
Task 4, Epoch 10/20 => Loss 3.040, Loss_clf 0.554, Loss_fe 0.513, Loss_kd 1.578, Train_accy 63.87:  45%|████▌     | 9/20 [09:11<09:57, 54.29s/it]
Task 4, Epoch 10/20 => Loss 3.040, Loss_clf 0.554, Loss_fe 0.513, Loss_kd 1.578, Train_accy 63.87:  50%|█████     | 10/20 [09:11<08:57, 53.77s/it]
Task 4, Epoch 11/20 => Loss 2.963, Loss_clf 0.526, Loss_fe 0.479, Loss_kd 1.567, Train_accy 64.21, Test_accy 70.74:  50%|█████     | 10/20 [10:17<08:57, 53.77s/it]
Task 4, Epoch 11/20 => Loss 2.963, Loss_clf 0.526, Loss_fe 0.479, Loss_kd 1.567, Train_accy 64.21, Test_accy 70.74:  55%|█████▌    | 11/20 [10:17<08:38, 57.59s/it]
Task 4, Epoch 12/20 => Loss 2.867, Loss_clf 0.488, Loss_fe 0.431, Loss_kd 1.558, Train_accy 64.93:  55%|█████▌    | 11/20 [11:10<08:38, 57.59s/it]                 
Task 4, Epoch 12/20 => Loss 2.867, Loss_clf 0.488, Loss_fe 0.431, Loss_kd 1.558, Train_accy 64.93:  60%|██████    | 12/20 [11:10<07:28, 56.07s/it]
Task 4, Epoch 13/20 => Loss 2.839, Loss_clf 0.485, Loss_fe 0.411, Loss_kd 1.554, Train_accy 64.68:  60%|██████    | 12/20 [12:03<07:28, 56.07s/it]
Task 4, Epoch 13/20 => Loss 2.839, Loss_clf 0.485, Loss_fe 0.411, Loss_kd 1.554, Train_accy 64.68:  65%|██████▌   | 13/20 [12:03<06:25, 55.03s/it]
Task 4, Epoch 14/20 => Loss 2.820, Loss_clf 0.477, Loss_fe 0.395, Loss_kd 1.558, Train_accy 65.56:  65%|██████▌   | 13/20 [12:55<06:25, 55.03s/it]
Task 4, Epoch 14/20 => Loss 2.820, Loss_clf 0.477, Loss_fe 0.395, Loss_kd 1.558, Train_accy 65.56:  70%|███████   | 14/20 [12:55<05:25, 54.28s/it]
Task 4, Epoch 15/20 => Loss 2.791, Loss_clf 0.469, Loss_fe 0.393, Loss_kd 1.543, Train_accy 65.87:  70%|███████   | 14/20 [13:48<05:25, 54.28s/it]
Task 4, Epoch 15/20 => Loss 2.791, Loss_clf 0.469, Loss_fe 0.393, Loss_kd 1.543, Train_accy 65.87:  75%|███████▌  | 15/20 [13:48<04:28, 53.78s/it]
Task 4, Epoch 16/20 => Loss 2.693, Loss_clf 0.433, Loss_fe 0.347, Loss_kd 1.531, Train_accy 66.52, Test_accy 70.31:  75%|███████▌  | 15/20 [14:54<04:28, 53.78s/it]
Task 4, Epoch 16/20 => Loss 2.693, Loss_clf 0.433, Loss_fe 0.347, Loss_kd 1.531, Train_accy 66.52, Test_accy 70.31:  80%|████████  | 16/20 [14:54<03:50, 57.52s/it]
Task 4, Epoch 17/20 => Loss 2.744, Loss_clf 0.457, Loss_fe 0.357, Loss_kd 1.544, Train_accy 66.83:  80%|████████  | 16/20 [15:47<03:50, 57.52s/it]                 
Task 4, Epoch 17/20 => Loss 2.744, Loss_clf 0.457, Loss_fe 0.357, Loss_kd 1.544, Train_accy 66.83:  85%|████████▌ | 17/20 [15:47<02:48, 56.03s/it]
Task 4, Epoch 18/20 => Loss 2.743, Loss_clf 0.449, Loss_fe 0.361, Loss_kd 1.546, Train_accy 65.89:  85%|████████▌ | 17/20 [16:39<02:48, 56.03s/it]
Task 4, Epoch 18/20 => Loss 2.743, Loss_clf 0.449, Loss_fe 0.361, Loss_kd 1.546, Train_accy 65.89:  90%|█████████ | 18/20 [16:39<01:50, 55.01s/it]
Task 4, Epoch 19/20 => Loss 2.731, Loss_clf 0.446, Loss_fe 0.354, Loss_kd 1.544, Train_accy 65.99:  90%|█████████ | 18/20 [17:32<01:50, 55.01s/it]
Task 4, Epoch 19/20 => Loss 2.731, Loss_clf 0.446, Loss_fe 0.354, Loss_kd 1.544, Train_accy 65.99:  95%|█████████▌| 19/20 [17:32<00:54, 54.27s/it]
Task 4, Epoch 20/20 => Loss 2.766, Loss_clf 0.458, Loss_fe 0.365, Loss_kd 1.555, Train_accy 65.85:  95%|█████████▌| 19/20 [18:24<00:54, 54.27s/it]
Task 4, Epoch 20/20 => Loss 2.766, Loss_clf 0.458, Loss_fe 0.365, Loss_kd 1.555, Train_accy 65.85: 100%|██████████| 20/20 [18:24<00:00, 53.76s/it]
Task 4, Epoch 20/20 => Loss 2.766, Loss_clf 0.458, Loss_fe 0.365, Loss_kd 1.555, Train_accy 65.85: 100%|██████████| 20/20 [18:24<00:00, 55.25s/it]
2024-09-05 03:33:12,550 [foster.py] => Task 4, Epoch 20/20 => Loss 2.766, Loss_clf 0.458, Loss_fe 0.365, Loss_kd 1.555, Train_accy 65.85
2024-09-05 03:33:12,551 [foster.py] => do not weight align teacher!
2024-09-05 03:33:12,557 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.976,  Train_accy 53.07, Test_accy 69.00:   0%|          | 0/20 [01:13<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.976,  Train_accy 53.07, Test_accy 69.00:   5%|▌         | 1/20 [01:13<23:15, 73.43s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.873,  Train_accy 56.07:   5%|▌         | 1/20 [02:19<23:15, 73.43s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.873,  Train_accy 56.07:  10%|█         | 2/20 [02:19<20:44, 69.14s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.825,  Train_accy 58.06:  10%|█         | 2/20 [03:25<20:44, 69.14s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.825,  Train_accy 58.06:  15%|█▌        | 3/20 [03:25<19:12, 67.77s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.819,  Train_accy 58.24:  15%|█▌        | 3/20 [04:31<19:12, 67.77s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.819,  Train_accy 58.24:  20%|██        | 4/20 [04:31<17:54, 67.14s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.812,  Train_accy 58.98:  20%|██        | 4/20 [05:38<17:54, 67.14s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.812,  Train_accy 58.98:  25%|██▌       | 5/20 [05:38<16:41, 66.77s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.796,  Train_accy 59.02, Test_accy 70.02:  25%|██▌       | 5/20 [06:51<16:41, 66.77s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.796,  Train_accy 59.02, Test_accy 70.02:  30%|███       | 6/20 [06:51<16:06, 69.07s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.775,  Train_accy 60.37:  30%|███       | 6/20 [07:57<16:06, 69.07s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.775,  Train_accy 60.37:  35%|███▌      | 7/20 [07:57<14:45, 68.12s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.804,  Train_accy 59.16:  35%|███▌      | 7/20 [09:03<14:45, 68.12s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.804,  Train_accy 59.16:  40%|████      | 8/20 [09:03<13:29, 67.49s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.791,  Train_accy 59.94:  40%|████      | 8/20 [10:10<13:29, 67.49s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.791,  Train_accy 59.94:  45%|████▌     | 9/20 [10:10<12:17, 67.08s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.783,  Train_accy 60.22:  45%|████▌     | 9/20 [11:16<12:17, 67.08s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.783,  Train_accy 60.22:  50%|█████     | 10/20 [11:16<11:08, 66.80s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.781,  Train_accy 60.02, Test_accy 70.36:  50%|█████     | 10/20 [12:29<11:08, 66.80s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.781,  Train_accy 60.02, Test_accy 70.36:  55%|█████▌    | 11/20 [12:29<10:19, 68.83s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.784,  Train_accy 59.94:  55%|█████▌    | 11/20 [13:35<10:19, 68.83s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.784,  Train_accy 59.94:  60%|██████    | 12/20 [13:35<09:04, 68.01s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.787,  Train_accy 59.59:  60%|██████    | 12/20 [14:41<09:04, 68.01s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.787,  Train_accy 59.59:  65%|██████▌   | 13/20 [14:41<07:52, 67.44s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.814,  Train_accy 60.23:  65%|██████▌   | 13/20 [15:48<07:52, 67.44s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.814,  Train_accy 60.23:  70%|███████   | 14/20 [15:48<06:42, 67.05s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.762,  Train_accy 60.55:  70%|███████   | 14/20 [16:54<06:42, 67.05s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.762,  Train_accy 60.55:  75%|███████▌  | 15/20 [16:54<05:33, 66.76s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.775,  Train_accy 60.51, Test_accy 70.14:  75%|███████▌  | 15/20 [18:07<05:33, 66.76s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.775,  Train_accy 60.51, Test_accy 70.14:  80%|████████  | 16/20 [18:07<04:35, 68.79s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.772,  Train_accy 60.47:  80%|████████  | 16/20 [19:13<04:35, 68.79s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.772,  Train_accy 60.47:  85%|████████▌ | 17/20 [19:13<03:23, 67.99s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.770,  Train_accy 61.02:  85%|████████▌ | 17/20 [20:19<03:23, 67.99s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.770,  Train_accy 61.02:  90%|█████████ | 18/20 [20:19<02:14, 67.44s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.778,  Train_accy 61.12:  90%|█████████ | 18/20 [21:26<02:14, 67.44s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.778,  Train_accy 61.12:  95%|█████████▌| 19/20 [21:26<01:07, 67.04s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.772,  Train_accy 60.51:  95%|█████████▌| 19/20 [22:32<01:07, 67.04s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.772,  Train_accy 60.51: 100%|██████████| 20/20 [22:32<00:00, 66.76s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.772,  Train_accy 60.51: 100%|██████████| 20/20 [22:32<00:00, 67.61s/it]
2024-09-05 03:55:46,143 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.772,  Train_accy 60.51
2024-09-05 03:55:46,143 [foster.py] => do not weight align student!
2024-09-05 03:55:53,479 [foster.py] => darknet eval: 
2024-09-05 03:55:53,480 [foster.py] => CNN top1 curve: 70.44
2024-09-05 03:55:53,480 [foster.py] => CNN top5 curve: 93.0
2024-09-05 03:55:53,483 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 03:58:18,520 [foster.py] => Exemplar size: 4000
2024-09-05 03:58:18,520 [trainer.py] => CNN: {'total': 70.44, '00-39': 92.29, '40-79': 84.73, '80-119': 81.89, '120-159': 64.21, '160-199': 29.12, 'old': 80.65, 'new': 29.12}
2024-09-05 03:58:18,520 [trainer.py] => NME: {'total': 87.02, '00-39': 87.22, '40-79': 87.74, '80-119': 87.32, '120-159': 84.42, '160-199': 88.44, 'old': 86.67, 'new': 88.44}
2024-09-05 03:58:18,520 [trainer.py] => CNN top1 curve: [96.92, 81.39, 72.95, 71.07, 70.44]
2024-09-05 03:58:18,520 [trainer.py] => CNN top5 curve: [99.56, 98.69, 97.74, 96.46, 94.61]
2024-09-05 03:58:18,520 [trainer.py] => NME top1 curve: [96.92, 92.06, 89.27, 87.63, 87.02]
2024-09-05 03:58:18,520 [trainer.py] => NME top5 curve: [99.56, 99.24, 98.73, 98.57, 98.13]

Average Accuracy (CNN): 78.55
Average Accuracy (NME): 90.58
2024-09-05 03:58:18,520 [trainer.py] => Average Accuracy (CNN): 78.55
2024-09-05 03:58:18,520 [trainer.py] => Average Accuracy (NME): 90.58
Accuracy Matrix (CNN):
[[96.92 96.92 95.59 95.15 92.29]
 [ 0.   66.24 78.49 83.66 84.73]
 [ 0.    0.   47.08 72.23 81.89]
 [ 0.    0.    0.   34.53 64.21]
 [ 0.    0.    0.    0.   29.12]]
2024-09-05 03:58:18,521 [trainer.py] => Forgetting (CNN): 1.1574999999999989
Accuracy Matrix (NME):
[[96.92 92.29 89.21 88.55 87.22]
 [ 0.   91.83 88.39 88.39 87.74]
 [ 0.    0.   90.14 85.71 87.32]
 [ 0.    0.    0.   88.   84.42]
 [ 0.    0.    0.    0.   88.44]]
2024-09-05 03:58:18,521 [trainer.py] => Forgetting (NME): 5.047500000000003
2024-09-05 03:58:21,485 [trainer.py] => config: ./exps/foster_cub_B0_Inc10.json
2024-09-05 03:58:21,485 [trainer.py] => prefix: cil
2024-09-05 03:58:21,485 [trainer.py] => dataset: cub
2024-09-05 03:58:21,485 [trainer.py] => memory_size: 4000
2024-09-05 03:58:21,485 [trainer.py] => memory_per_class: 20
2024-09-05 03:58:21,485 [trainer.py] => fixed_memory: True
2024-09-05 03:58:21,485 [trainer.py] => shuffle: True
2024-09-05 03:58:21,485 [trainer.py] => init_cls: 20
2024-09-05 03:58:21,485 [trainer.py] => increment: 20
2024-09-05 03:58:21,485 [trainer.py] => model_name: foster
2024-09-05 03:58:21,485 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 03:58:21,485 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 03:58:21,485 [trainer.py] => seed: 1993
2024-09-05 03:58:21,485 [trainer.py] => beta1: 0.96
2024-09-05 03:58:21,485 [trainer.py] => beta2: 0.97
2024-09-05 03:58:21,485 [trainer.py] => oofc: ft
2024-09-05 03:58:21,485 [trainer.py] => is_teacher_wa: False
2024-09-05 03:58:21,485 [trainer.py] => is_student_wa: False
2024-09-05 03:58:21,485 [trainer.py] => lambda_okd: 1
2024-09-05 03:58:21,485 [trainer.py] => wa_value: 1
2024-09-05 03:58:21,485 [trainer.py] => init_epochs: 20
2024-09-05 03:58:21,485 [trainer.py] => init_lr: 0.001
2024-09-05 03:58:21,485 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 03:58:21,485 [trainer.py] => boosting_epochs: 20
2024-09-05 03:58:21,485 [trainer.py] => compression_epochs: 20
2024-09-05 03:58:21,485 [trainer.py] => lr: 0.001
2024-09-05 03:58:21,485 [trainer.py] => batch_size: 48
2024-09-05 03:58:21,486 [trainer.py] => weight_decay: 0.0005
2024-09-05 03:58:21,486 [trainer.py] => num_workers: 8
2024-09-05 03:58:21,486 [trainer.py] => T: 2
2024-09-05 03:58:21,522 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 03:58:21,813 [trainer.py] => All params: 0
2024-09-05 03:58:21,813 [trainer.py] => Trainable params: 0
2024-09-05 03:58:23,351 [foster.py] => Learning on 0-20
2024-09-05 03:58:23,351 [foster.py] => All params: 85829416
2024-09-05 03:58:23,352 [foster.py] => Trainable params: 85829416

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.170, Train_accy 38.27, Test_accy 80.97:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.170, Train_accy 38.27, Test_accy 80.97:   5%|▌         | 1/20 [00:08<02:46,  8.78s/it]
Task 0, Epoch 2/20 => Loss 0.783, Train_accy 77.06:   5%|▌         | 1/20 [00:16<02:46,  8.78s/it]                 
Task 0, Epoch 2/20 => Loss 0.783, Train_accy 77.06:  10%|█         | 2/20 [00:16<02:22,  7.92s/it]
Task 0, Epoch 3/20 => Loss 0.415, Train_accy 87.53:  10%|█         | 2/20 [00:23<02:22,  7.92s/it]
Task 0, Epoch 3/20 => Loss 0.415, Train_accy 87.53:  15%|█▌        | 3/20 [00:23<02:10,  7.66s/it]
Task 0, Epoch 4/20 => Loss 0.337, Train_accy 89.01:  15%|█▌        | 3/20 [00:30<02:10,  7.66s/it]
Task 0, Epoch 4/20 => Loss 0.337, Train_accy 89.01:  20%|██        | 4/20 [00:30<02:00,  7.53s/it]
Task 0, Epoch 5/20 => Loss 0.287, Train_accy 91.54:  20%|██        | 4/20 [00:38<02:00,  7.53s/it]
Task 0, Epoch 5/20 => Loss 0.287, Train_accy 91.54:  25%|██▌       | 5/20 [00:38<01:51,  7.46s/it]
Task 0, Epoch 6/20 => Loss 0.278, Train_accy 91.33, Test_accy 96.76:  25%|██▌       | 5/20 [00:46<01:51,  7.46s/it]
Task 0, Epoch 6/20 => Loss 0.278, Train_accy 91.33, Test_accy 96.76:  30%|███       | 6/20 [00:46<01:49,  7.82s/it]
Task 0, Epoch 7/20 => Loss 0.290, Train_accy 91.23:  30%|███       | 6/20 [00:53<01:49,  7.82s/it]                 
Task 0, Epoch 7/20 => Loss 0.290, Train_accy 91.23:  35%|███▌      | 7/20 [00:53<01:39,  7.67s/it]
Task 0, Epoch 8/20 => Loss 0.263, Train_accy 91.54:  35%|███▌      | 7/20 [01:01<01:39,  7.67s/it]
Task 0, Epoch 8/20 => Loss 0.263, Train_accy 91.54:  40%|████      | 8/20 [01:01<01:30,  7.58s/it]
Task 0, Epoch 9/20 => Loss 0.206, Train_accy 93.13:  40%|████      | 8/20 [01:08<01:30,  7.58s/it]
Task 0, Epoch 9/20 => Loss 0.206, Train_accy 93.13:  45%|████▌     | 9/20 [01:08<01:22,  7.51s/it]
Task 0, Epoch 10/20 => Loss 0.208, Train_accy 94.19:  45%|████▌     | 9/20 [01:16<01:22,  7.51s/it]
Task 0, Epoch 10/20 => Loss 0.208, Train_accy 94.19:  50%|█████     | 10/20 [01:16<01:14,  7.49s/it]
Task 0, Epoch 11/20 => Loss 0.187, Train_accy 94.71, Test_accy 99.19:  50%|█████     | 10/20 [01:24<01:14,  7.49s/it]
Task 0, Epoch 11/20 => Loss 0.187, Train_accy 94.71, Test_accy 99.19:  55%|█████▌    | 11/20 [01:24<01:10,  7.80s/it]
Task 0, Epoch 12/20 => Loss 0.168, Train_accy 94.93:  55%|█████▌    | 11/20 [01:32<01:10,  7.80s/it]                 
Task 0, Epoch 12/20 => Loss 0.168, Train_accy 94.93:  60%|██████    | 12/20 [01:32<01:01,  7.67s/it]
Task 0, Epoch 13/20 => Loss 0.217, Train_accy 93.13:  60%|██████    | 12/20 [01:39<01:01,  7.67s/it]
Task 0, Epoch 13/20 => Loss 0.217, Train_accy 93.13:  65%|██████▌   | 13/20 [01:39<00:53,  7.59s/it]
Task 0, Epoch 14/20 => Loss 0.185, Train_accy 94.29:  65%|██████▌   | 13/20 [01:46<00:53,  7.59s/it]
Task 0, Epoch 14/20 => Loss 0.185, Train_accy 94.29:  70%|███████   | 14/20 [01:46<00:45,  7.53s/it]
Task 0, Epoch 15/20 => Loss 0.161, Train_accy 95.14:  70%|███████   | 14/20 [01:54<00:45,  7.53s/it]
Task 0, Epoch 15/20 => Loss 0.161, Train_accy 95.14:  75%|███████▌  | 15/20 [01:54<00:37,  7.50s/it]
Task 0, Epoch 16/20 => Loss 0.161, Train_accy 94.29, Test_accy 98.79:  75%|███████▌  | 15/20 [02:02<00:37,  7.50s/it]
Task 0, Epoch 16/20 => Loss 0.161, Train_accy 94.29, Test_accy 98.79:  80%|████████  | 16/20 [02:02<00:31,  7.82s/it]
Task 0, Epoch 17/20 => Loss 0.129, Train_accy 95.67:  80%|████████  | 16/20 [02:10<00:31,  7.82s/it]                 
Task 0, Epoch 17/20 => Loss 0.129, Train_accy 95.67:  85%|████████▌ | 17/20 [02:10<00:23,  7.68s/it]
Task 0, Epoch 18/20 => Loss 0.190, Train_accy 94.93:  85%|████████▌ | 17/20 [02:17<00:23,  7.68s/it]
Task 0, Epoch 18/20 => Loss 0.190, Train_accy 94.93:  90%|█████████ | 18/20 [02:17<00:15,  7.61s/it]
Task 0, Epoch 19/20 => Loss 0.124, Train_accy 96.09:  90%|█████████ | 18/20 [02:25<00:15,  7.61s/it]
Task 0, Epoch 19/20 => Loss 0.124, Train_accy 96.09:  95%|█████████▌| 19/20 [02:25<00:07,  7.57s/it]
Task 0, Epoch 20/20 => Loss 0.206, Train_accy 93.23:  95%|█████████▌| 19/20 [02:32<00:07,  7.57s/it]
Task 0, Epoch 20/20 => Loss 0.206, Train_accy 93.23: 100%|██████████| 20/20 [02:32<00:00,  7.53s/it]
Task 0, Epoch 20/20 => Loss 0.206, Train_accy 93.23: 100%|██████████| 20/20 [02:32<00:00,  7.63s/it]
2024-09-05 04:00:56,362 [foster.py] => Task 0, Epoch 20/20 => Loss 0.206, Train_accy 93.23
2024-09-05 04:00:56,364 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 04:01:14,758 [foster.py] => Exemplar size: 400
2024-09-05 04:01:14,758 [trainer.py] => CNN: {'total': 99.19, '00-19': 99.19, 'old': 0, 'new': 99.19}
2024-09-05 04:01:14,758 [trainer.py] => NME: {'total': 99.19, '00-19': 99.19, 'old': 0, 'new': 99.19}
2024-09-05 04:01:14,758 [trainer.py] => CNN top1 curve: [99.19]
2024-09-05 04:01:14,759 [trainer.py] => CNN top5 curve: [100.0]
2024-09-05 04:01:14,759 [trainer.py] => NME top1 curve: [99.19]
2024-09-05 04:01:14,759 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.19
Average Accuracy (NME): 99.19
2024-09-05 04:01:14,759 [trainer.py] => Average Accuracy (CNN): 99.19
2024-09-05 04:01:14,759 [trainer.py] => Average Accuracy (NME): 99.19
2024-09-05 04:01:14,760 [trainer.py] => All params: 85829416
2024-09-05 04:01:14,761 [trainer.py] => Trainable params: 85829416
2024-09-05 04:01:16,165 [foster.py] => Learning on 20-40
2024-09-05 04:01:16,166 [foster.py] => All params: 171704932
2024-09-05 04:01:16,167 [foster.py] => Trainable params: 85890896
2024-09-05 04:01:16,213 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.485, Loss_clf 1.813, Loss_fe 2.498, Loss_kd 0.587, Train_accy 51.45, Test_accy 76.43:   0%|          | 0/20 [00:16<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.485, Loss_clf 1.813, Loss_fe 2.498, Loss_kd 0.587, Train_accy 51.45, Test_accy 76.43:   5%|▌         | 1/20 [00:16<05:21, 16.90s/it]
Task 1, Epoch 2/20 => Loss 2.779, Loss_clf 0.598, Loss_fe 1.053, Loss_kd 0.564, Train_accy 62.83:   5%|▌         | 1/20 [00:30<05:21, 16.90s/it]                 
Task 1, Epoch 2/20 => Loss 2.779, Loss_clf 0.598, Loss_fe 1.053, Loss_kd 0.564, Train_accy 62.83:  10%|█         | 2/20 [00:30<04:33, 15.18s/it]
Task 1, Epoch 3/20 => Loss 2.914, Loss_clf 0.663, Loss_fe 1.027, Loss_kd 0.612, Train_accy 66.84:  10%|█         | 2/20 [00:44<04:33, 15.18s/it]
Task 1, Epoch 3/20 => Loss 2.914, Loss_clf 0.663, Loss_fe 1.027, Loss_kd 0.612, Train_accy 66.84:  15%|█▌        | 3/20 [00:44<04:09, 14.68s/it]
Task 1, Epoch 4/20 => Loss 2.217, Loss_clf 0.421, Loss_fe 0.692, Loss_kd 0.552, Train_accy 68.33:  15%|█▌        | 3/20 [00:58<04:09, 14.68s/it]
Task 1, Epoch 4/20 => Loss 2.217, Loss_clf 0.421, Loss_fe 0.692, Loss_kd 0.552, Train_accy 68.33:  20%|██        | 4/20 [00:58<03:50, 14.42s/it]
Task 1, Epoch 5/20 => Loss 2.040, Loss_clf 0.349, Loss_fe 0.546, Loss_kd 0.573, Train_accy 70.56:  20%|██        | 4/20 [01:13<03:50, 14.42s/it]
Task 1, Epoch 5/20 => Loss 2.040, Loss_clf 0.349, Loss_fe 0.546, Loss_kd 0.573, Train_accy 70.56:  25%|██▌       | 5/20 [01:13<03:34, 14.30s/it]
Task 1, Epoch 6/20 => Loss 2.283, Loss_clf 0.369, Loss_fe 0.820, Loss_kd 0.547, Train_accy 69.07, Test_accy 83.04:  25%|██▌       | 5/20 [01:30<03:34, 14.30s/it]
Task 1, Epoch 6/20 => Loss 2.283, Loss_clf 0.369, Loss_fe 0.820, Loss_kd 0.547, Train_accy 69.07, Test_accy 83.04:  30%|███       | 6/20 [01:30<03:33, 15.26s/it]
Task 1, Epoch 7/20 => Loss 1.894, Loss_clf 0.280, Loss_fe 0.501, Loss_kd 0.556, Train_accy 72.04:  30%|███       | 6/20 [01:44<03:33, 15.26s/it]                 
Task 1, Epoch 7/20 => Loss 1.894, Loss_clf 0.280, Loss_fe 0.501, Loss_kd 0.556, Train_accy 72.04:  35%|███▌      | 7/20 [01:44<03:13, 14.88s/it]
Task 1, Epoch 8/20 => Loss 1.867, Loss_clf 0.303, Loss_fe 0.427, Loss_kd 0.569, Train_accy 73.90:  35%|███▌      | 7/20 [01:58<03:13, 14.88s/it]
Task 1, Epoch 8/20 => Loss 1.867, Loss_clf 0.303, Loss_fe 0.427, Loss_kd 0.569, Train_accy 73.90:  40%|████      | 8/20 [01:58<02:55, 14.64s/it]
Task 1, Epoch 9/20 => Loss 1.980, Loss_clf 0.308, Loss_fe 0.560, Loss_kd 0.556, Train_accy 74.72:  40%|████      | 8/20 [02:12<02:55, 14.64s/it]
Task 1, Epoch 9/20 => Loss 1.980, Loss_clf 0.308, Loss_fe 0.560, Loss_kd 0.556, Train_accy 74.72:  45%|████▌     | 9/20 [02:12<02:39, 14.48s/it]
Task 1, Epoch 10/20 => Loss 1.691, Loss_clf 0.244, Loss_fe 0.337, Loss_kd 0.555, Train_accy 75.39:  45%|████▌     | 9/20 [02:26<02:39, 14.48s/it]
Task 1, Epoch 10/20 => Loss 1.691, Loss_clf 0.244, Loss_fe 0.337, Loss_kd 0.555, Train_accy 75.39:  50%|█████     | 10/20 [02:26<02:23, 14.39s/it]
Task 1, Epoch 11/20 => Loss 1.614, Loss_clf 0.219, Loss_fe 0.286, Loss_kd 0.554, Train_accy 76.43, Test_accy 88.77:  50%|█████     | 10/20 [02:43<02:23, 14.39s/it]
Task 1, Epoch 11/20 => Loss 1.614, Loss_clf 0.219, Loss_fe 0.286, Loss_kd 0.554, Train_accy 76.43, Test_accy 88.77:  55%|█████▌    | 11/20 [02:43<02:17, 15.23s/it]
Task 1, Epoch 12/20 => Loss 1.700, Loss_clf 0.233, Loss_fe 0.275, Loss_kd 0.596, Train_accy 78.44:  55%|█████▌    | 11/20 [02:58<02:17, 15.23s/it]                 
Task 1, Epoch 12/20 => Loss 1.700, Loss_clf 0.233, Loss_fe 0.275, Loss_kd 0.596, Train_accy 78.44:  60%|██████    | 12/20 [02:58<01:59, 14.90s/it]
Task 1, Epoch 13/20 => Loss 1.626, Loss_clf 0.244, Loss_fe 0.289, Loss_kd 0.547, Train_accy 80.89:  60%|██████    | 12/20 [03:12<01:59, 14.90s/it]
Task 1, Epoch 13/20 => Loss 1.626, Loss_clf 0.244, Loss_fe 0.289, Loss_kd 0.547, Train_accy 80.89:  65%|██████▌   | 13/20 [03:12<01:42, 14.68s/it]
Task 1, Epoch 14/20 => Loss 1.563, Loss_clf 0.207, Loss_fe 0.255, Loss_kd 0.551, Train_accy 77.92:  65%|██████▌   | 13/20 [03:26<01:42, 14.68s/it]
Task 1, Epoch 14/20 => Loss 1.563, Loss_clf 0.207, Loss_fe 0.255, Loss_kd 0.551, Train_accy 77.92:  70%|███████   | 14/20 [03:26<01:27, 14.53s/it]
Task 1, Epoch 15/20 => Loss 1.609, Loss_clf 0.224, Loss_fe 0.243, Loss_kd 0.571, Train_accy 77.99:  70%|███████   | 14/20 [03:40<01:27, 14.53s/it]
Task 1, Epoch 15/20 => Loss 1.609, Loss_clf 0.224, Loss_fe 0.243, Loss_kd 0.571, Train_accy 77.99:  75%|███████▌  | 15/20 [03:40<01:12, 14.43s/it]
Task 1, Epoch 16/20 => Loss 1.528, Loss_clf 0.196, Loss_fe 0.225, Loss_kd 0.554, Train_accy 80.74, Test_accy 88.99:  75%|███████▌  | 15/20 [03:57<01:12, 14.43s/it]
Task 1, Epoch 16/20 => Loss 1.528, Loss_clf 0.196, Loss_fe 0.225, Loss_kd 0.554, Train_accy 80.74, Test_accy 88.99:  80%|████████  | 16/20 [03:57<01:01, 15.26s/it]
Task 1, Epoch 17/20 => Loss 1.566, Loss_clf 0.217, Loss_fe 0.236, Loss_kd 0.557, Train_accy 79.70:  80%|████████  | 16/20 [04:11<01:01, 15.26s/it]                 
Task 1, Epoch 17/20 => Loss 1.566, Loss_clf 0.217, Loss_fe 0.236, Loss_kd 0.557, Train_accy 79.70:  85%|████████▌ | 17/20 [04:11<00:44, 14.94s/it]
Task 1, Epoch 18/20 => Loss 1.705, Loss_clf 0.257, Loss_fe 0.270, Loss_kd 0.589, Train_accy 79.33:  85%|████████▌ | 17/20 [04:26<00:44, 14.94s/it]
Task 1, Epoch 18/20 => Loss 1.705, Loss_clf 0.257, Loss_fe 0.270, Loss_kd 0.589, Train_accy 79.33:  90%|█████████ | 18/20 [04:26<00:29, 14.71s/it]
Task 1, Epoch 19/20 => Loss 1.561, Loss_clf 0.206, Loss_fe 0.228, Loss_kd 0.563, Train_accy 80.82:  90%|█████████ | 18/20 [04:40<00:29, 14.71s/it]
Task 1, Epoch 19/20 => Loss 1.561, Loss_clf 0.206, Loss_fe 0.228, Loss_kd 0.563, Train_accy 80.82:  95%|█████████▌| 19/20 [04:40<00:14, 14.55s/it]
Task 1, Epoch 20/20 => Loss 1.536, Loss_clf 0.213, Loss_fe 0.219, Loss_kd 0.552, Train_accy 79.70:  95%|█████████▌| 19/20 [04:54<00:14, 14.55s/it]
Task 1, Epoch 20/20 => Loss 1.536, Loss_clf 0.213, Loss_fe 0.219, Loss_kd 0.552, Train_accy 79.70: 100%|██████████| 20/20 [04:54<00:00, 14.45s/it]
Task 1, Epoch 20/20 => Loss 1.536, Loss_clf 0.213, Loss_fe 0.219, Loss_kd 0.552, Train_accy 79.70: 100%|██████████| 20/20 [04:54<00:00, 14.73s/it]
2024-09-05 04:06:10,731 [foster.py] => Task 1, Epoch 20/20 => Loss 1.536, Loss_clf 0.213, Loss_fe 0.219, Loss_kd 0.552, Train_accy 79.70
2024-09-05 04:06:10,732 [foster.py] => do not weight align teacher!
2024-09-05 04:06:10,735 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.839,  Train_accy 43.20, Test_accy 77.75:   0%|          | 0/20 [00:19<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.839,  Train_accy 43.20, Test_accy 77.75:   5%|▌         | 1/20 [00:19<06:15, 19.75s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.153,  Train_accy 65.13:   5%|▌         | 1/20 [00:37<06:15, 19.75s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.153,  Train_accy 65.13:  10%|█         | 2/20 [00:37<05:35, 18.61s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.078,  Train_accy 67.66:  10%|█         | 2/20 [00:55<05:35, 18.61s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.078,  Train_accy 67.66:  15%|█▌        | 3/20 [00:55<05:10, 18.25s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.099,  Train_accy 67.51:  15%|█▌        | 3/20 [01:13<05:10, 18.25s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.099,  Train_accy 67.51:  20%|██        | 4/20 [01:13<04:49, 18.06s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.076,  Train_accy 67.51:  20%|██        | 4/20 [01:30<04:49, 18.06s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.076,  Train_accy 67.51:  25%|██▌       | 5/20 [01:30<04:29, 17.97s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.079,  Train_accy 67.81, Test_accy 81.94:  25%|██▌       | 5/20 [01:50<04:29, 17.97s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.079,  Train_accy 67.81, Test_accy 81.94:  30%|███       | 6/20 [01:50<04:19, 18.52s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.072,  Train_accy 67.14:  30%|███       | 6/20 [02:08<04:19, 18.52s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.072,  Train_accy 67.14:  35%|███▌      | 7/20 [02:08<03:57, 18.30s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.052,  Train_accy 68.33:  35%|███▌      | 7/20 [02:26<03:57, 18.30s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.052,  Train_accy 68.33:  40%|████      | 8/20 [02:26<03:37, 18.15s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.092,  Train_accy 66.02:  40%|████      | 8/20 [02:44<03:37, 18.15s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.092,  Train_accy 66.02:  45%|████▌     | 9/20 [02:44<03:18, 18.04s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.156,  Train_accy 67.81:  45%|████▌     | 9/20 [03:01<03:18, 18.04s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.156,  Train_accy 67.81:  50%|█████     | 10/20 [03:01<02:59, 17.96s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.029,  Train_accy 68.62, Test_accy 83.26:  50%|█████     | 10/20 [03:21<02:59, 17.96s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.029,  Train_accy 68.62, Test_accy 83.26:  55%|█████▌    | 11/20 [03:21<02:46, 18.46s/it]
SNet: Task 1, Epoch 12/20 => Loss 1.110,  Train_accy 67.58:  55%|█████▌    | 11/20 [03:39<02:46, 18.46s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 1.110,  Train_accy 67.58:  60%|██████    | 12/20 [03:39<02:25, 18.24s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.132,  Train_accy 68.25:  60%|██████    | 12/20 [03:56<02:25, 18.24s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.132,  Train_accy 68.25:  65%|██████▌   | 13/20 [03:56<02:06, 18.09s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.038,  Train_accy 69.81:  65%|██████▌   | 13/20 [04:14<02:06, 18.09s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.038,  Train_accy 69.81:  70%|███████   | 14/20 [04:14<01:47, 18.00s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.051,  Train_accy 69.74:  70%|███████   | 14/20 [04:32<01:47, 18.00s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.051,  Train_accy 69.74:  75%|███████▌  | 15/20 [04:32<01:29, 17.92s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.096,  Train_accy 68.70, Test_accy 83.48:  75%|███████▌  | 15/20 [04:52<01:29, 17.92s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.096,  Train_accy 68.70, Test_accy 83.48:  80%|████████  | 16/20 [04:52<01:13, 18.42s/it]
SNet: Task 1, Epoch 17/20 => Loss 1.074,  Train_accy 70.04:  80%|████████  | 16/20 [05:09<01:13, 18.42s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 1.074,  Train_accy 70.04:  85%|████████▌ | 17/20 [05:09<00:54, 18.21s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.075,  Train_accy 69.44:  85%|████████▌ | 17/20 [05:27<00:54, 18.21s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.075,  Train_accy 69.44:  90%|█████████ | 18/20 [05:27<00:36, 18.06s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.046,  Train_accy 68.10:  90%|█████████ | 18/20 [05:45<00:36, 18.06s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.046,  Train_accy 68.10:  95%|█████████▌| 19/20 [05:45<00:17, 17.98s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.048,  Train_accy 67.73:  95%|█████████▌| 19/20 [06:03<00:17, 17.98s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.048,  Train_accy 67.73: 100%|██████████| 20/20 [06:03<00:00, 17.92s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.048,  Train_accy 67.73: 100%|██████████| 20/20 [06:03<00:00, 18.15s/it]
2024-09-05 04:12:15,162 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.048,  Train_accy 67.73
2024-09-05 04:12:15,163 [foster.py] => do not weight align student!
2024-09-05 04:12:16,979 [foster.py] => darknet eval: 
2024-09-05 04:12:16,980 [foster.py] => CNN top1 curve: 83.48
2024-09-05 04:12:16,980 [foster.py] => CNN top5 curve: 99.34
2024-09-05 04:12:16,983 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 04:12:52,824 [foster.py] => Exemplar size: 800
2024-09-05 04:12:52,824 [trainer.py] => CNN: {'total': 88.99, '00-19': 98.38, '20-39': 77.78, 'old': 98.38, 'new': 77.78}
2024-09-05 04:12:52,824 [trainer.py] => NME: {'total': 96.7, '00-19': 97.98, '20-39': 95.17, 'old': 97.98, 'new': 95.17}
2024-09-05 04:12:52,825 [trainer.py] => CNN top1 curve: [99.19, 88.99]
2024-09-05 04:12:52,825 [trainer.py] => CNN top5 curve: [100.0, 99.56]
2024-09-05 04:12:52,825 [trainer.py] => NME top1 curve: [99.19, 96.7]
2024-09-05 04:12:52,825 [trainer.py] => NME top5 curve: [100.0, 99.56]

Average Accuracy (CNN): 94.09
Average Accuracy (NME): 97.94
2024-09-05 04:12:52,825 [trainer.py] => Average Accuracy (CNN): 94.09
2024-09-05 04:12:52,825 [trainer.py] => Average Accuracy (NME): 97.94
2024-09-05 04:12:52,826 [trainer.py] => All params: 171704932
2024-09-05 04:12:52,827 [trainer.py] => Trainable params: 85890896
2024-09-05 04:12:54,244 [foster.py] => Learning on 40-60
2024-09-05 04:12:54,245 [foster.py] => All params: 171766432
2024-09-05 04:12:54,246 [foster.py] => Trainable params: 85937016
2024-09-05 04:12:54,293 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.788, Loss_clf 1.646, Loss_fe 2.533, Loss_kd 1.072, Train_accy 57.09, Test_accy 78.57:   0%|          | 0/20 [00:22<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.788, Loss_clf 1.646, Loss_fe 2.533, Loss_kd 1.072, Train_accy 57.09, Test_accy 78.57:   5%|▌         | 1/20 [00:22<07:02, 22.24s/it]
Task 2, Epoch 2/20 => Loss 3.042, Loss_clf 0.646, Loss_fe 0.815, Loss_kd 1.054, Train_accy 66.49:   5%|▌         | 1/20 [00:40<07:02, 22.24s/it]                 
Task 2, Epoch 2/20 => Loss 3.042, Loss_clf 0.646, Loss_fe 0.815, Loss_kd 1.054, Train_accy 66.49:  10%|█         | 2/20 [00:40<05:56, 19.78s/it]
Task 2, Epoch 3/20 => Loss 2.816, Loss_clf 0.576, Loss_fe 0.663, Loss_kd 1.051, Train_accy 67.99:  10%|█         | 2/20 [00:58<05:56, 19.78s/it]
Task 2, Epoch 3/20 => Loss 2.816, Loss_clf 0.576, Loss_fe 0.663, Loss_kd 1.051, Train_accy 67.99:  15%|█▌        | 3/20 [00:58<05:22, 19.00s/it]
Task 2, Epoch 4/20 => Loss 2.645, Loss_clf 0.527, Loss_fe 0.549, Loss_kd 1.046, Train_accy 68.22:  15%|█▌        | 3/20 [01:16<05:22, 19.00s/it]
Task 2, Epoch 4/20 => Loss 2.645, Loss_clf 0.527, Loss_fe 0.549, Loss_kd 1.046, Train_accy 68.22:  20%|██        | 4/20 [01:16<04:58, 18.66s/it]
Task 2, Epoch 5/20 => Loss 2.429, Loss_clf 0.429, Loss_fe 0.454, Loss_kd 1.031, Train_accy 71.54:  20%|██        | 4/20 [01:34<04:58, 18.66s/it]
Task 2, Epoch 5/20 => Loss 2.429, Loss_clf 0.429, Loss_fe 0.454, Loss_kd 1.031, Train_accy 71.54:  25%|██▌       | 5/20 [01:34<04:37, 18.50s/it]
Task 2, Epoch 6/20 => Loss 2.505, Loss_clf 0.472, Loss_fe 0.477, Loss_kd 1.037, Train_accy 69.94, Test_accy 82.29:  25%|██▌       | 5/20 [01:57<04:37, 18.50s/it]
Task 2, Epoch 6/20 => Loss 2.505, Loss_clf 0.472, Loss_fe 0.477, Loss_kd 1.037, Train_accy 69.94, Test_accy 82.29:  30%|███       | 6/20 [01:57<04:38, 19.86s/it]
Task 2, Epoch 7/20 => Loss 2.419, Loss_clf 0.429, Loss_fe 0.414, Loss_kd 1.051, Train_accy 72.23:  30%|███       | 6/20 [02:15<04:38, 19.86s/it]                 
Task 2, Epoch 7/20 => Loss 2.419, Loss_clf 0.429, Loss_fe 0.414, Loss_kd 1.051, Train_accy 72.23:  35%|███▌      | 7/20 [02:15<04:11, 19.33s/it]
Task 2, Epoch 8/20 => Loss 2.323, Loss_clf 0.379, Loss_fe 0.373, Loss_kd 1.047, Train_accy 73.90:  35%|███▌      | 7/20 [02:33<04:11, 19.33s/it]
Task 2, Epoch 8/20 => Loss 2.323, Loss_clf 0.379, Loss_fe 0.373, Loss_kd 1.047, Train_accy 73.90:  40%|████      | 8/20 [02:33<03:47, 18.98s/it]
Task 2, Epoch 9/20 => Loss 2.230, Loss_clf 0.353, Loss_fe 0.328, Loss_kd 1.033, Train_accy 73.90:  40%|████      | 8/20 [02:51<03:47, 18.98s/it]
Task 2, Epoch 9/20 => Loss 2.230, Loss_clf 0.353, Loss_fe 0.328, Loss_kd 1.033, Train_accy 73.90:  45%|████▌     | 9/20 [02:51<03:26, 18.74s/it]
Task 2, Epoch 10/20 => Loss 2.306, Loss_clf 0.390, Loss_fe 0.358, Loss_kd 1.039, Train_accy 74.30:  45%|████▌     | 9/20 [03:10<03:26, 18.74s/it]
Task 2, Epoch 10/20 => Loss 2.306, Loss_clf 0.390, Loss_fe 0.358, Loss_kd 1.039, Train_accy 74.30:  50%|█████     | 10/20 [03:10<03:05, 18.58s/it]
Task 2, Epoch 11/20 => Loss 2.246, Loss_clf 0.355, Loss_fe 0.327, Loss_kd 1.043, Train_accy 75.85, Test_accy 83.78:  50%|█████     | 10/20 [03:32<03:05, 18.58s/it]
Task 2, Epoch 11/20 => Loss 2.246, Loss_clf 0.355, Loss_fe 0.327, Loss_kd 1.043, Train_accy 75.85, Test_accy 83.78:  55%|█████▌    | 11/20 [03:32<02:58, 19.78s/it]
Task 2, Epoch 12/20 => Loss 2.097, Loss_clf 0.304, Loss_fe 0.257, Loss_kd 1.024, Train_accy 76.13:  55%|█████▌    | 11/20 [03:50<02:58, 19.78s/it]                 
Task 2, Epoch 12/20 => Loss 2.097, Loss_clf 0.304, Loss_fe 0.257, Loss_kd 1.024, Train_accy 76.13:  60%|██████    | 12/20 [03:50<02:34, 19.32s/it]
Task 2, Epoch 13/20 => Loss 2.165, Loss_clf 0.337, Loss_fe 0.281, Loss_kd 1.031, Train_accy 75.16:  60%|██████    | 12/20 [04:09<02:34, 19.32s/it]
Task 2, Epoch 13/20 => Loss 2.165, Loss_clf 0.337, Loss_fe 0.281, Loss_kd 1.031, Train_accy 75.16:  65%|██████▌   | 13/20 [04:09<02:12, 19.00s/it]
Task 2, Epoch 14/20 => Loss 2.129, Loss_clf 0.315, Loss_fe 0.250, Loss_kd 1.043, Train_accy 75.90:  65%|██████▌   | 13/20 [04:27<02:12, 19.00s/it]
Task 2, Epoch 14/20 => Loss 2.129, Loss_clf 0.315, Loss_fe 0.250, Loss_kd 1.043, Train_accy 75.90:  70%|███████   | 14/20 [04:27<01:52, 18.76s/it]
Task 2, Epoch 15/20 => Loss 2.099, Loss_clf 0.296, Loss_fe 0.253, Loss_kd 1.034, Train_accy 77.22:  70%|███████   | 14/20 [04:45<01:52, 18.76s/it]
Task 2, Epoch 15/20 => Loss 2.099, Loss_clf 0.296, Loss_fe 0.253, Loss_kd 1.034, Train_accy 77.22:  75%|███████▌  | 15/20 [04:45<01:33, 18.61s/it]
Task 2, Epoch 16/20 => Loss 2.096, Loss_clf 0.300, Loss_fe 0.251, Loss_kd 1.030, Train_accy 78.03, Test_accy 84.23:  75%|███████▌  | 15/20 [05:08<01:33, 18.61s/it]
Task 2, Epoch 16/20 => Loss 2.096, Loss_clf 0.300, Loss_fe 0.251, Loss_kd 1.030, Train_accy 78.03, Test_accy 84.23:  80%|████████  | 16/20 [05:08<01:19, 19.80s/it]
Task 2, Epoch 17/20 => Loss 2.044, Loss_clf 0.279, Loss_fe 0.221, Loss_kd 1.029, Train_accy 78.37:  80%|████████  | 16/20 [05:26<01:19, 19.80s/it]                 
Task 2, Epoch 17/20 => Loss 2.044, Loss_clf 0.279, Loss_fe 0.221, Loss_kd 1.029, Train_accy 78.37:  85%|████████▌ | 17/20 [05:26<00:57, 19.33s/it]
Task 2, Epoch 18/20 => Loss 1.961, Loss_clf 0.243, Loss_fe 0.194, Loss_kd 1.016, Train_accy 79.58:  85%|████████▌ | 17/20 [05:44<00:57, 19.33s/it]
Task 2, Epoch 18/20 => Loss 1.961, Loss_clf 0.243, Loss_fe 0.194, Loss_kd 1.016, Train_accy 79.58:  90%|█████████ | 18/20 [05:44<00:38, 19.01s/it]
Task 2, Epoch 19/20 => Loss 2.000, Loss_clf 0.255, Loss_fe 0.212, Loss_kd 1.022, Train_accy 78.26:  90%|█████████ | 18/20 [06:02<00:38, 19.01s/it]
Task 2, Epoch 19/20 => Loss 2.000, Loss_clf 0.255, Loss_fe 0.212, Loss_kd 1.022, Train_accy 78.26:  95%|█████████▌| 19/20 [06:02<00:18, 18.79s/it]
Task 2, Epoch 20/20 => Loss 2.029, Loss_clf 0.283, Loss_fe 0.217, Loss_kd 1.019, Train_accy 78.14:  95%|█████████▌| 19/20 [06:21<00:18, 18.79s/it]
Task 2, Epoch 20/20 => Loss 2.029, Loss_clf 0.283, Loss_fe 0.217, Loss_kd 1.019, Train_accy 78.14: 100%|██████████| 20/20 [06:21<00:00, 18.63s/it]
Task 2, Epoch 20/20 => Loss 2.029, Loss_clf 0.283, Loss_fe 0.217, Loss_kd 1.019, Train_accy 78.14: 100%|██████████| 20/20 [06:21<00:00, 19.06s/it]
2024-09-05 04:19:15,538 [foster.py] => Task 2, Epoch 20/20 => Loss 2.029, Loss_clf 0.283, Loss_fe 0.217, Loss_kd 1.019, Train_accy 78.14
2024-09-05 04:19:15,539 [foster.py] => do not weight align teacher!
2024-09-05 04:19:15,542 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.787,  Train_accy 51.06, Test_accy 77.23:   0%|          | 0/20 [00:25<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.787,  Train_accy 51.06, Test_accy 77.23:   5%|▌         | 1/20 [00:25<08:02, 25.39s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.444,  Train_accy 62.82:   5%|▌         | 1/20 [00:48<08:02, 25.39s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.444,  Train_accy 62.82:  10%|█         | 2/20 [00:48<07:10, 23.90s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.390,  Train_accy 66.38:  10%|█         | 2/20 [01:11<07:10, 23.90s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.390,  Train_accy 66.38:  15%|█▌        | 3/20 [01:11<06:38, 23.42s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.383,  Train_accy 66.15:  15%|█▌        | 3/20 [01:33<06:38, 23.42s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.383,  Train_accy 66.15:  20%|██        | 4/20 [01:33<06:11, 23.20s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.391,  Train_accy 67.41:  20%|██        | 4/20 [01:56<06:11, 23.20s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.391,  Train_accy 67.41:  25%|██▌       | 5/20 [01:56<05:46, 23.08s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.371,  Train_accy 68.45, Test_accy 81.10:  25%|██▌       | 5/20 [02:22<05:46, 23.08s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.371,  Train_accy 68.45, Test_accy 81.10:  30%|███       | 6/20 [02:22<05:34, 23.89s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.330,  Train_accy 68.16:  30%|███       | 6/20 [02:45<05:34, 23.89s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.330,  Train_accy 68.16:  35%|███▌      | 7/20 [02:45<05:06, 23.58s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.371,  Train_accy 67.99:  35%|███▌      | 7/20 [03:08<05:06, 23.58s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.371,  Train_accy 67.99:  40%|████      | 8/20 [03:08<04:40, 23.37s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.368,  Train_accy 68.39:  40%|████      | 8/20 [03:31<04:40, 23.37s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.368,  Train_accy 68.39:  45%|████▌     | 9/20 [03:31<04:15, 23.23s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.394,  Train_accy 68.33:  45%|████▌     | 9/20 [03:54<04:15, 23.23s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.394,  Train_accy 68.33:  50%|█████     | 10/20 [03:54<03:51, 23.14s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.370,  Train_accy 66.61, Test_accy 81.40:  50%|█████     | 10/20 [04:19<03:51, 23.14s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.370,  Train_accy 66.61, Test_accy 81.40:  55%|█████▌    | 11/20 [04:19<03:34, 23.85s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.339,  Train_accy 68.90:  55%|█████▌    | 11/20 [04:42<03:34, 23.85s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.339,  Train_accy 68.90:  60%|██████    | 12/20 [04:42<03:08, 23.59s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.347,  Train_accy 68.16:  60%|██████    | 12/20 [05:05<03:08, 23.59s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.347,  Train_accy 68.16:  65%|██████▌   | 13/20 [05:05<02:43, 23.38s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.359,  Train_accy 68.85:  65%|██████▌   | 13/20 [05:28<02:43, 23.38s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.359,  Train_accy 68.85:  70%|███████   | 14/20 [05:28<02:19, 23.25s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.376,  Train_accy 68.45:  70%|███████   | 14/20 [05:51<02:19, 23.25s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.376,  Train_accy 68.45:  75%|███████▌  | 15/20 [05:51<01:55, 23.16s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.360,  Train_accy 67.99, Test_accy 81.10:  75%|███████▌  | 15/20 [06:16<01:55, 23.16s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.360,  Train_accy 67.99, Test_accy 81.10:  80%|████████  | 16/20 [06:16<01:35, 23.86s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.335,  Train_accy 68.45:  80%|████████  | 16/20 [06:39<01:35, 23.86s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.335,  Train_accy 68.45:  85%|████████▌ | 17/20 [06:39<01:10, 23.59s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.362,  Train_accy 69.36:  85%|████████▌ | 17/20 [07:02<01:10, 23.59s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.362,  Train_accy 69.36:  90%|█████████ | 18/20 [07:02<00:46, 23.39s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.350,  Train_accy 68.67:  90%|█████████ | 18/20 [07:25<00:46, 23.39s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.350,  Train_accy 68.67:  95%|█████████▌| 19/20 [07:25<00:23, 23.26s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.329,  Train_accy 69.65:  95%|█████████▌| 19/20 [07:48<00:23, 23.26s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.329,  Train_accy 69.65: 100%|██████████| 20/20 [07:48<00:00, 23.17s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.329,  Train_accy 69.65: 100%|██████████| 20/20 [07:48<00:00, 23.43s/it]
2024-09-05 04:27:05,553 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.329,  Train_accy 69.65
2024-09-05 04:27:05,553 [foster.py] => do not weight align student!
2024-09-05 04:27:08,058 [foster.py] => darknet eval: 
2024-09-05 04:27:08,058 [foster.py] => CNN top1 curve: 81.4
2024-09-05 04:27:08,058 [foster.py] => CNN top5 curve: 98.36
2024-09-05 04:27:08,059 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 04:27:58,354 [foster.py] => Exemplar size: 1200
2024-09-05 04:27:58,354 [trainer.py] => CNN: {'total': 83.48, '00-19': 98.79, '20-39': 85.51, '40-59': 64.22, 'old': 92.73, 'new': 64.22}
2024-09-05 04:27:58,354 [trainer.py] => NME: {'total': 94.05, '00-19': 93.52, '20-39': 94.69, '40-59': 94.04, 'old': 94.05, 'new': 94.04}
2024-09-05 04:27:58,354 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48]
2024-09-05 04:27:58,354 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66]
2024-09-05 04:27:58,354 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05]
2024-09-05 04:27:58,354 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4]

Average Accuracy (CNN): 90.55
Average Accuracy (NME): 96.65
2024-09-05 04:27:58,354 [trainer.py] => Average Accuracy (CNN): 90.55
2024-09-05 04:27:58,354 [trainer.py] => Average Accuracy (NME): 96.65
2024-09-05 04:27:58,355 [trainer.py] => All params: 171766432
2024-09-05 04:27:58,356 [trainer.py] => Trainable params: 85937016
2024-09-05 04:27:59,868 [foster.py] => Learning on 60-80
2024-09-05 04:27:59,870 [foster.py] => All params: 171827932
2024-09-05 04:27:59,870 [foster.py] => Trainable params: 85983136
2024-09-05 04:27:59,922 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 6.188, Loss_clf 1.533, Loss_fe 3.043, Loss_kd 1.209, Train_accy 55.68, Test_accy 75.08:   0%|          | 0/20 [00:27<?, ?it/s]
Task 3, Epoch 1/20 => Loss 6.188, Loss_clf 1.533, Loss_fe 3.043, Loss_kd 1.209, Train_accy 55.68, Test_accy 75.08:   5%|▌         | 1/20 [00:27<08:46, 27.71s/it]
Task 3, Epoch 2/20 => Loss 3.283, Loss_clf 0.714, Loss_fe 0.968, Loss_kd 1.201, Train_accy 62.30:   5%|▌         | 1/20 [00:49<08:46, 27.71s/it]                 
Task 3, Epoch 2/20 => Loss 3.283, Loss_clf 0.714, Loss_fe 0.968, Loss_kd 1.201, Train_accy 62.30:  10%|█         | 2/20 [00:49<07:19, 24.44s/it]
Task 3, Epoch 3/20 => Loss 2.865, Loss_clf 0.588, Loss_fe 0.684, Loss_kd 1.194, Train_accy 61.42:  10%|█         | 2/20 [01:12<07:19, 24.44s/it]
Task 3, Epoch 3/20 => Loss 2.865, Loss_clf 0.588, Loss_fe 0.684, Loss_kd 1.194, Train_accy 61.42:  15%|█▌        | 3/20 [01:12<06:38, 23.42s/it]
Task 3, Epoch 4/20 => Loss 2.744, Loss_clf 0.540, Loss_fe 0.605, Loss_kd 1.200, Train_accy 64.68:  15%|█▌        | 3/20 [01:34<06:38, 23.42s/it]
Task 3, Epoch 4/20 => Loss 2.744, Loss_clf 0.540, Loss_fe 0.605, Loss_kd 1.200, Train_accy 64.68:  20%|██        | 4/20 [01:34<06:07, 22.97s/it]
Task 3, Epoch 5/20 => Loss 2.689, Loss_clf 0.533, Loss_fe 0.566, Loss_kd 1.192, Train_accy 64.54:  20%|██        | 4/20 [01:56<06:07, 22.97s/it]
Task 3, Epoch 5/20 => Loss 2.689, Loss_clf 0.533, Loss_fe 0.566, Loss_kd 1.192, Train_accy 64.54:  25%|██▌       | 5/20 [01:56<05:41, 22.76s/it]
Task 3, Epoch 6/20 => Loss 2.562, Loss_clf 0.475, Loss_fe 0.494, Loss_kd 1.195, Train_accy 65.80, Test_accy 76.28:  25%|██▌       | 5/20 [02:24<05:41, 22.76s/it]
Task 3, Epoch 6/20 => Loss 2.562, Loss_clf 0.475, Loss_fe 0.494, Loss_kd 1.195, Train_accy 65.80, Test_accy 76.28:  30%|███       | 6/20 [02:24<05:44, 24.59s/it]
Task 3, Epoch 7/20 => Loss 2.466, Loss_clf 0.459, Loss_fe 0.432, Loss_kd 1.182, Train_accy 66.54:  30%|███       | 6/20 [02:47<05:44, 24.59s/it]                 
Task 3, Epoch 7/20 => Loss 2.466, Loss_clf 0.459, Loss_fe 0.432, Loss_kd 1.182, Train_accy 66.54:  35%|███▌      | 7/20 [02:47<05:10, 23.87s/it]
Task 3, Epoch 8/20 => Loss 2.497, Loss_clf 0.451, Loss_fe 0.433, Loss_kd 1.210, Train_accy 66.82:  35%|███▌      | 7/20 [03:09<05:10, 23.87s/it]
Task 3, Epoch 8/20 => Loss 2.497, Loss_clf 0.451, Loss_fe 0.433, Loss_kd 1.210, Train_accy 66.82:  40%|████      | 8/20 [03:09<04:40, 23.40s/it]
Task 3, Epoch 9/20 => Loss 2.392, Loss_clf 0.425, Loss_fe 0.379, Loss_kd 1.191, Train_accy 69.52:  40%|████      | 8/20 [03:32<04:40, 23.40s/it]
Task 3, Epoch 9/20 => Loss 2.392, Loss_clf 0.425, Loss_fe 0.379, Loss_kd 1.191, Train_accy 69.52:  45%|████▌     | 9/20 [03:32<04:13, 23.08s/it]
Task 3, Epoch 10/20 => Loss 2.348, Loss_clf 0.414, Loss_fe 0.354, Loss_kd 1.185, Train_accy 66.64:  45%|████▌     | 9/20 [03:54<04:13, 23.08s/it]
Task 3, Epoch 10/20 => Loss 2.348, Loss_clf 0.414, Loss_fe 0.354, Loss_kd 1.185, Train_accy 66.64:  50%|█████     | 10/20 [03:54<03:48, 22.88s/it]
Task 3, Epoch 11/20 => Loss 2.260, Loss_clf 0.365, Loss_fe 0.321, Loss_kd 1.180, Train_accy 69.80, Test_accy 78.13:  50%|█████     | 10/20 [04:22<03:48, 22.88s/it]
Task 3, Epoch 11/20 => Loss 2.260, Loss_clf 0.365, Loss_fe 0.321, Loss_kd 1.180, Train_accy 69.80, Test_accy 78.13:  55%|█████▌    | 11/20 [04:22<03:40, 24.51s/it]
Task 3, Epoch 12/20 => Loss 2.341, Loss_clf 0.403, Loss_fe 0.349, Loss_kd 1.191, Train_accy 67.89:  55%|█████▌    | 11/20 [04:45<03:40, 24.51s/it]                 
Task 3, Epoch 12/20 => Loss 2.341, Loss_clf 0.403, Loss_fe 0.349, Loss_kd 1.191, Train_accy 67.89:  60%|██████    | 12/20 [04:45<03:10, 23.87s/it]
Task 3, Epoch 13/20 => Loss 2.196, Loss_clf 0.345, Loss_fe 0.294, Loss_kd 1.168, Train_accy 69.57:  60%|██████    | 12/20 [05:07<03:10, 23.87s/it]
Task 3, Epoch 13/20 => Loss 2.196, Loss_clf 0.345, Loss_fe 0.294, Loss_kd 1.168, Train_accy 69.57:  65%|██████▌   | 13/20 [05:07<02:44, 23.43s/it]
Task 3, Epoch 14/20 => Loss 2.249, Loss_clf 0.351, Loss_fe 0.302, Loss_kd 1.197, Train_accy 68.45:  65%|██████▌   | 13/20 [05:29<02:44, 23.43s/it]
Task 3, Epoch 14/20 => Loss 2.249, Loss_clf 0.351, Loss_fe 0.302, Loss_kd 1.197, Train_accy 68.45:  70%|███████   | 14/20 [05:29<02:18, 23.13s/it]
Task 3, Epoch 15/20 => Loss 2.197, Loss_clf 0.341, Loss_fe 0.277, Loss_kd 1.184, Train_accy 70.46:  70%|███████   | 14/20 [05:52<02:18, 23.13s/it]
Task 3, Epoch 15/20 => Loss 2.197, Loss_clf 0.341, Loss_fe 0.277, Loss_kd 1.184, Train_accy 70.46:  75%|███████▌  | 15/20 [05:52<01:54, 22.93s/it]
Task 3, Epoch 16/20 => Loss 2.357, Loss_clf 0.386, Loss_fe 0.338, Loss_kd 1.226, Train_accy 69.94, Test_accy 76.50:  75%|███████▌  | 15/20 [06:20<01:54, 22.93s/it]
Task 3, Epoch 16/20 => Loss 2.357, Loss_clf 0.386, Loss_fe 0.338, Loss_kd 1.226, Train_accy 69.94, Test_accy 76.50:  80%|████████  | 16/20 [06:20<01:38, 24.50s/it]
Task 3, Epoch 17/20 => Loss 2.089, Loss_clf 0.306, Loss_fe 0.236, Loss_kd 1.161, Train_accy 71.30:  80%|████████  | 16/20 [06:43<01:38, 24.50s/it]                 
Task 3, Epoch 17/20 => Loss 2.089, Loss_clf 0.306, Loss_fe 0.236, Loss_kd 1.161, Train_accy 71.30:  85%|████████▌ | 17/20 [06:43<01:11, 23.88s/it]
Task 3, Epoch 18/20 => Loss 2.145, Loss_clf 0.323, Loss_fe 0.246, Loss_kd 1.182, Train_accy 71.81:  85%|████████▌ | 17/20 [07:05<01:11, 23.88s/it]
Task 3, Epoch 18/20 => Loss 2.145, Loss_clf 0.323, Loss_fe 0.246, Loss_kd 1.182, Train_accy 71.81:  90%|█████████ | 18/20 [07:05<00:46, 23.45s/it]
Task 3, Epoch 19/20 => Loss 2.185, Loss_clf 0.354, Loss_fe 0.265, Loss_kd 1.175, Train_accy 69.90:  90%|█████████ | 18/20 [07:27<00:46, 23.45s/it]
Task 3, Epoch 19/20 => Loss 2.185, Loss_clf 0.354, Loss_fe 0.265, Loss_kd 1.175, Train_accy 69.90:  95%|█████████▌| 19/20 [07:27<00:23, 23.15s/it]
Task 3, Epoch 20/20 => Loss 2.173, Loss_clf 0.325, Loss_fe 0.258, Loss_kd 1.192, Train_accy 70.08:  95%|█████████▌| 19/20 [07:50<00:23, 23.15s/it]
Task 3, Epoch 20/20 => Loss 2.173, Loss_clf 0.325, Loss_fe 0.258, Loss_kd 1.192, Train_accy 70.08: 100%|██████████| 20/20 [07:50<00:00, 22.93s/it]
Task 3, Epoch 20/20 => Loss 2.173, Loss_clf 0.325, Loss_fe 0.258, Loss_kd 1.192, Train_accy 70.08: 100%|██████████| 20/20 [07:50<00:00, 23.52s/it]
2024-09-05 04:35:50,246 [foster.py] => Task 3, Epoch 20/20 => Loss 2.173, Loss_clf 0.325, Loss_fe 0.258, Loss_kd 1.192, Train_accy 70.08
2024-09-05 04:35:50,247 [foster.py] => do not weight align teacher!
2024-09-05 04:35:50,250 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.775,  Train_accy 51.35, Test_accy 70.08:   0%|          | 0/20 [00:31<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.775,  Train_accy 51.35, Test_accy 70.08:   5%|▌         | 1/20 [00:31<09:55, 31.35s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.548,  Train_accy 58.90:   5%|▌         | 1/20 [00:59<09:55, 31.35s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.548,  Train_accy 58.90:  10%|█         | 2/20 [00:59<08:49, 29.44s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.495,  Train_accy 59.88:  10%|█         | 2/20 [01:27<08:49, 29.44s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.495,  Train_accy 59.88:  15%|█▌        | 3/20 [01:27<08:10, 28.83s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.528,  Train_accy 59.93:  15%|█▌        | 3/20 [01:55<08:10, 28.83s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.528,  Train_accy 59.93:  20%|██        | 4/20 [01:55<07:36, 28.56s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.531,  Train_accy 60.30:  20%|██        | 4/20 [02:23<07:36, 28.56s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.531,  Train_accy 60.30:  25%|██▌       | 5/20 [02:23<07:05, 28.40s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.488,  Train_accy 61.32, Test_accy 71.82:  25%|██▌       | 5/20 [02:55<07:05, 28.40s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.488,  Train_accy 61.32, Test_accy 71.82:  30%|███       | 6/20 [02:55<06:51, 29.42s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.549,  Train_accy 60.16:  30%|███       | 6/20 [03:23<06:51, 29.42s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.549,  Train_accy 60.16:  35%|███▌      | 7/20 [03:23<06:17, 29.00s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.488,  Train_accy 61.42:  35%|███▌      | 7/20 [03:51<06:17, 29.00s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.488,  Train_accy 61.42:  40%|████      | 8/20 [03:51<05:44, 28.72s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.486,  Train_accy 61.37:  40%|████      | 8/20 [04:19<05:44, 28.72s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.486,  Train_accy 61.37:  45%|████▌     | 9/20 [04:19<05:14, 28.55s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.519,  Train_accy 61.23:  45%|████▌     | 9/20 [04:47<05:14, 28.55s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.519,  Train_accy 61.23:  50%|█████     | 10/20 [04:47<04:44, 28.42s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.545,  Train_accy 62.30, Test_accy 72.69:  50%|█████     | 10/20 [05:19<04:44, 28.42s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.545,  Train_accy 62.30, Test_accy 72.69:  55%|█████▌    | 11/20 [05:19<04:23, 29.31s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.504,  Train_accy 61.60:  55%|█████▌    | 11/20 [05:47<04:23, 29.31s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.504,  Train_accy 61.60:  60%|██████    | 12/20 [05:47<03:51, 28.95s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.489,  Train_accy 61.09:  60%|██████    | 12/20 [06:15<03:51, 28.95s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.489,  Train_accy 61.09:  65%|██████▌   | 13/20 [06:15<03:20, 28.71s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.507,  Train_accy 61.14:  65%|██████▌   | 13/20 [06:43<03:20, 28.71s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.507,  Train_accy 61.14:  70%|███████   | 14/20 [06:43<02:51, 28.53s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.515,  Train_accy 61.51:  70%|███████   | 14/20 [07:11<02:51, 28.53s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.515,  Train_accy 61.51:  75%|███████▌  | 15/20 [07:11<02:22, 28.40s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.473,  Train_accy 62.44, Test_accy 73.01:  75%|███████▌  | 15/20 [07:42<02:22, 28.40s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.473,  Train_accy 62.44, Test_accy 73.01:  80%|████████  | 16/20 [07:42<01:57, 29.29s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.504,  Train_accy 60.81:  80%|████████  | 16/20 [08:11<01:57, 29.29s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.504,  Train_accy 60.81:  85%|████████▌ | 17/20 [08:11<01:26, 28.92s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.497,  Train_accy 61.93:  85%|████████▌ | 17/20 [08:39<01:26, 28.92s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.497,  Train_accy 61.93:  90%|█████████ | 18/20 [08:39<00:57, 28.68s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.533,  Train_accy 60.67:  90%|█████████ | 18/20 [09:07<00:57, 28.68s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.533,  Train_accy 60.67:  95%|█████████▌| 19/20 [09:07<00:28, 28.52s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.500,  Train_accy 61.14:  95%|█████████▌| 19/20 [09:35<00:28, 28.52s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.500,  Train_accy 61.14: 100%|██████████| 20/20 [09:35<00:00, 28.42s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.500,  Train_accy 61.14: 100%|██████████| 20/20 [09:35<00:00, 28.77s/it]
2024-09-05 04:45:27,187 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.500,  Train_accy 61.14
2024-09-05 04:45:27,187 [foster.py] => do not weight align student!
2024-09-05 04:45:30,435 [foster.py] => darknet eval: 
2024-09-05 04:45:30,436 [foster.py] => CNN top1 curve: 72.69
2024-09-05 04:45:30,436 [foster.py] => CNN top5 curve: 97.17
2024-09-05 04:45:30,439 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 04:46:33,925 [foster.py] => Exemplar size: 1600
2024-09-05 04:46:33,925 [trainer.py] => CNN: {'total': 76.17, '00-19': 97.17, '20-39': 91.3, '40-59': 76.61, '60-79': 42.11, 'old': 88.69, 'new': 42.11}
2024-09-05 04:46:33,925 [trainer.py] => NME: {'total': 91.29, '00-19': 89.88, '20-39': 91.79, '40-59': 91.74, '60-79': 91.9, 'old': 91.07, 'new': 91.9}
2024-09-05 04:46:33,925 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48, 76.17]
2024-09-05 04:46:33,925 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 97.71]
2024-09-05 04:46:33,925 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05, 91.29]
2024-09-05 04:46:33,925 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.24]

Average Accuracy (CNN): 86.96
Average Accuracy (NME): 95.31
2024-09-05 04:46:33,925 [trainer.py] => Average Accuracy (CNN): 86.96
2024-09-05 04:46:33,926 [trainer.py] => Average Accuracy (NME): 95.31
2024-09-05 04:46:33,927 [trainer.py] => All params: 171827932
2024-09-05 04:46:33,928 [trainer.py] => Trainable params: 85983136
2024-09-05 04:46:35,402 [foster.py] => Learning on 80-100
2024-09-05 04:46:35,403 [foster.py] => All params: 171889432
2024-09-05 04:46:35,404 [foster.py] => Trainable params: 86029256
2024-09-05 04:46:35,459 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 6.405, Loss_clf 1.442, Loss_fe 3.140, Loss_kd 1.458, Train_accy 59.82, Test_accy 75.00:   0%|          | 0/20 [00:32<?, ?it/s]
Task 4, Epoch 1/20 => Loss 6.405, Loss_clf 1.442, Loss_fe 3.140, Loss_kd 1.458, Train_accy 59.82, Test_accy 75.00:   5%|▌         | 1/20 [00:32<10:22, 32.78s/it]
Task 4, Epoch 2/20 => Loss 3.580, Loss_clf 0.761, Loss_fe 1.024, Loss_kd 1.436, Train_accy 64.40:   5%|▌         | 1/20 [00:58<10:22, 32.78s/it]                 
Task 4, Epoch 2/20 => Loss 3.580, Loss_clf 0.761, Loss_fe 1.024, Loss_kd 1.436, Train_accy 64.40:  10%|█         | 2/20 [00:58<08:36, 28.71s/it]
Task 4, Epoch 3/20 => Loss 3.132, Loss_clf 0.617, Loss_fe 0.751, Loss_kd 1.411, Train_accy 65.35:  10%|█         | 2/20 [01:24<08:36, 28.71s/it]
Task 4, Epoch 3/20 => Loss 3.132, Loss_clf 0.617, Loss_fe 0.751, Loss_kd 1.411, Train_accy 65.35:  15%|█▌        | 3/20 [01:24<07:46, 27.47s/it]
Task 4, Epoch 4/20 => Loss 3.083, Loss_clf 0.623, Loss_fe 0.706, Loss_kd 1.403, Train_accy 66.51:  15%|█▌        | 3/20 [01:50<07:46, 27.47s/it]
Task 4, Epoch 4/20 => Loss 3.083, Loss_clf 0.623, Loss_fe 0.706, Loss_kd 1.403, Train_accy 66.51:  20%|██        | 4/20 [01:50<07:10, 26.93s/it]
Task 4, Epoch 5/20 => Loss 2.924, Loss_clf 0.567, Loss_fe 0.598, Loss_kd 1.407, Train_accy 69.45:  20%|██        | 4/20 [02:16<07:10, 26.93s/it]
Task 4, Epoch 5/20 => Loss 2.924, Loss_clf 0.567, Loss_fe 0.598, Loss_kd 1.407, Train_accy 69.45:  25%|██▌       | 5/20 [02:16<06:39, 26.62s/it]
Task 4, Epoch 6/20 => Loss 2.783, Loss_clf 0.509, Loss_fe 0.517, Loss_kd 1.406, Train_accy 70.21, Test_accy 75.08:  25%|██▌       | 5/20 [02:50<06:39, 26.62s/it]
Task 4, Epoch 6/20 => Loss 2.783, Loss_clf 0.509, Loss_fe 0.517, Loss_kd 1.406, Train_accy 70.21, Test_accy 75.08:  30%|███       | 6/20 [02:50<06:44, 28.93s/it]
Task 4, Epoch 7/20 => Loss 2.810, Loss_clf 0.536, Loss_fe 0.515, Loss_kd 1.407, Train_accy 70.80:  30%|███       | 6/20 [03:16<06:44, 28.93s/it]                 
Task 4, Epoch 7/20 => Loss 2.810, Loss_clf 0.536, Loss_fe 0.515, Loss_kd 1.407, Train_accy 70.80:  35%|███▌      | 7/20 [03:16<06:04, 28.03s/it]
Task 4, Epoch 8/20 => Loss 2.755, Loss_clf 0.495, Loss_fe 0.487, Loss_kd 1.419, Train_accy 69.69:  35%|███▌      | 7/20 [03:42<06:04, 28.03s/it]
Task 4, Epoch 8/20 => Loss 2.755, Loss_clf 0.495, Loss_fe 0.487, Loss_kd 1.419, Train_accy 69.69:  40%|████      | 8/20 [03:42<05:29, 27.45s/it]
Task 4, Epoch 9/20 => Loss 2.671, Loss_clf 0.474, Loss_fe 0.426, Loss_kd 1.417, Train_accy 71.56:  40%|████      | 8/20 [04:08<05:29, 27.45s/it]
Task 4, Epoch 9/20 => Loss 2.671, Loss_clf 0.474, Loss_fe 0.426, Loss_kd 1.417, Train_accy 71.56:  45%|████▌     | 9/20 [04:08<04:57, 27.03s/it]
Task 4, Epoch 10/20 => Loss 2.534, Loss_clf 0.418, Loss_fe 0.359, Loss_kd 1.406, Train_accy 72.51:  45%|████▌     | 9/20 [04:34<04:57, 27.03s/it]
Task 4, Epoch 10/20 => Loss 2.534, Loss_clf 0.418, Loss_fe 0.359, Loss_kd 1.406, Train_accy 72.51:  50%|█████     | 10/20 [04:34<04:27, 26.77s/it]
Task 4, Epoch 11/20 => Loss 2.596, Loss_clf 0.435, Loss_fe 0.381, Loss_kd 1.424, Train_accy 72.63, Test_accy 76.85:  50%|█████     | 10/20 [05:08<04:27, 26.77s/it]
Task 4, Epoch 11/20 => Loss 2.596, Loss_clf 0.435, Loss_fe 0.381, Loss_kd 1.424, Train_accy 72.63, Test_accy 76.85:  55%|█████▌    | 11/20 [05:08<04:19, 28.78s/it]
Task 4, Epoch 12/20 => Loss 2.683, Loss_clf 0.465, Loss_fe 0.413, Loss_kd 1.444, Train_accy 72.59:  55%|█████▌    | 11/20 [05:34<04:19, 28.78s/it]                 
Task 4, Epoch 12/20 => Loss 2.683, Loss_clf 0.465, Loss_fe 0.413, Loss_kd 1.444, Train_accy 72.59:  60%|██████    | 12/20 [05:34<03:44, 28.00s/it]
Task 4, Epoch 13/20 => Loss 2.531, Loss_clf 0.426, Loss_fe 0.333, Loss_kd 1.418, Train_accy 73.23:  60%|██████    | 12/20 [06:00<03:44, 28.00s/it]
Task 4, Epoch 13/20 => Loss 2.531, Loss_clf 0.426, Loss_fe 0.333, Loss_kd 1.418, Train_accy 73.23:  65%|██████▌   | 13/20 [06:00<03:12, 27.44s/it]
Task 4, Epoch 14/20 => Loss 2.447, Loss_clf 0.379, Loss_fe 0.311, Loss_kd 1.406, Train_accy 73.79:  65%|██████▌   | 13/20 [06:26<03:12, 27.44s/it]
Task 4, Epoch 14/20 => Loss 2.447, Loss_clf 0.379, Loss_fe 0.311, Loss_kd 1.406, Train_accy 73.79:  70%|███████   | 14/20 [06:26<02:42, 27.06s/it]
Task 4, Epoch 15/20 => Loss 2.513, Loss_clf 0.419, Loss_fe 0.325, Loss_kd 1.415, Train_accy 72.79:  70%|███████   | 14/20 [06:52<02:42, 27.06s/it]
Task 4, Epoch 15/20 => Loss 2.513, Loss_clf 0.419, Loss_fe 0.325, Loss_kd 1.415, Train_accy 72.79:  75%|███████▌  | 15/20 [06:52<02:13, 26.79s/it]
Task 4, Epoch 16/20 => Loss 2.461, Loss_clf 0.392, Loss_fe 0.292, Loss_kd 1.421, Train_accy 73.35, Test_accy 78.03:  75%|███████▌  | 15/20 [07:26<02:13, 26.79s/it]
Task 4, Epoch 16/20 => Loss 2.461, Loss_clf 0.392, Loss_fe 0.292, Loss_kd 1.421, Train_accy 73.35, Test_accy 78.03:  80%|████████  | 16/20 [07:26<01:55, 28.81s/it]
Task 4, Epoch 17/20 => Loss 2.370, Loss_clf 0.348, Loss_fe 0.274, Loss_kd 1.399, Train_accy 74.94:  80%|████████  | 16/20 [07:52<01:55, 28.81s/it]                 
Task 4, Epoch 17/20 => Loss 2.370, Loss_clf 0.348, Loss_fe 0.274, Loss_kd 1.399, Train_accy 74.94:  85%|████████▌ | 17/20 [07:52<01:24, 28.01s/it]
Task 4, Epoch 18/20 => Loss 2.396, Loss_clf 0.369, Loss_fe 0.294, Loss_kd 1.386, Train_accy 74.38:  85%|████████▌ | 17/20 [08:18<01:24, 28.01s/it]
Task 4, Epoch 18/20 => Loss 2.396, Loss_clf 0.369, Loss_fe 0.294, Loss_kd 1.386, Train_accy 74.38:  90%|█████████ | 18/20 [08:18<00:54, 27.46s/it]
Task 4, Epoch 19/20 => Loss 2.375, Loss_clf 0.353, Loss_fe 0.261, Loss_kd 1.409, Train_accy 75.62:  90%|█████████ | 18/20 [08:44<00:54, 27.46s/it]
Task 4, Epoch 19/20 => Loss 2.375, Loss_clf 0.353, Loss_fe 0.261, Loss_kd 1.409, Train_accy 75.62:  95%|█████████▌| 19/20 [08:44<00:27, 27.08s/it]
Task 4, Epoch 20/20 => Loss 2.450, Loss_clf 0.377, Loss_fe 0.300, Loss_kd 1.419, Train_accy 74.54:  95%|█████████▌| 19/20 [09:11<00:27, 27.08s/it]
Task 4, Epoch 20/20 => Loss 2.450, Loss_clf 0.377, Loss_fe 0.300, Loss_kd 1.419, Train_accy 74.54: 100%|██████████| 20/20 [09:11<00:00, 26.83s/it]
Task 4, Epoch 20/20 => Loss 2.450, Loss_clf 0.377, Loss_fe 0.300, Loss_kd 1.419, Train_accy 74.54: 100%|██████████| 20/20 [09:11<00:00, 27.56s/it]
2024-09-05 04:55:46,691 [foster.py] => Task 4, Epoch 20/20 => Loss 2.450, Loss_clf 0.377, Loss_fe 0.300, Loss_kd 1.419, Train_accy 74.54
2024-09-05 04:55:46,692 [foster.py] => do not weight align teacher!
2024-09-05 04:55:46,696 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.807,  Train_accy 56.56, Test_accy 72.39:   0%|          | 0/20 [00:36<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.807,  Train_accy 56.56, Test_accy 72.39:   5%|▌         | 1/20 [00:36<11:39, 36.79s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.606,  Train_accy 63.25:   5%|▌         | 1/20 [01:09<11:39, 36.79s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.606,  Train_accy 63.25:  10%|█         | 2/20 [01:09<10:20, 34.47s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.580,  Train_accy 65.16:  10%|█         | 2/20 [01:42<10:20, 34.47s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.580,  Train_accy 65.16:  15%|█▌        | 3/20 [01:42<09:33, 33.73s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.577,  Train_accy 65.31:  15%|█▌        | 3/20 [02:15<09:33, 33.73s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.577,  Train_accy 65.31:  20%|██        | 4/20 [02:15<08:54, 33.38s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.602,  Train_accy 65.19:  20%|██        | 4/20 [02:48<08:54, 33.38s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.602,  Train_accy 65.19:  25%|██▌       | 5/20 [02:48<08:17, 33.17s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.570,  Train_accy 66.67, Test_accy 74.33:  25%|██▌       | 5/20 [03:24<08:17, 33.17s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.570,  Train_accy 66.67, Test_accy 74.33:  30%|███       | 6/20 [03:24<08:01, 34.41s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.592,  Train_accy 65.47:  30%|███       | 6/20 [03:57<08:01, 34.41s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.592,  Train_accy 65.47:  35%|███▌      | 7/20 [03:57<07:20, 33.90s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.548,  Train_accy 66.27:  35%|███▌      | 7/20 [04:30<07:20, 33.90s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.548,  Train_accy 66.27:  40%|████      | 8/20 [04:30<06:42, 33.56s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.574,  Train_accy 65.47:  40%|████      | 8/20 [05:03<06:42, 33.56s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.574,  Train_accy 65.47:  45%|████▌     | 9/20 [05:03<06:06, 33.35s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.574,  Train_accy 66.07:  45%|████▌     | 9/20 [05:36<06:06, 33.35s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.574,  Train_accy 66.07:  50%|█████     | 10/20 [05:36<05:31, 33.19s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.560,  Train_accy 66.51, Test_accy 74.83:  50%|█████     | 10/20 [06:13<05:31, 33.19s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.560,  Train_accy 66.51, Test_accy 74.83:  55%|█████▌    | 11/20 [06:13<05:09, 34.35s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.561,  Train_accy 66.71:  55%|█████▌    | 11/20 [06:46<05:09, 34.35s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.561,  Train_accy 66.71:  60%|██████    | 12/20 [06:46<04:31, 33.90s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.551,  Train_accy 66.98:  60%|██████    | 12/20 [07:19<04:31, 33.90s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.551,  Train_accy 66.98:  65%|██████▌   | 13/20 [07:19<03:55, 33.59s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.525,  Train_accy 67.30:  65%|██████▌   | 13/20 [07:51<03:55, 33.59s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.525,  Train_accy 67.30:  70%|███████   | 14/20 [07:51<03:20, 33.38s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.566,  Train_accy 66.03:  70%|███████   | 14/20 [08:24<03:20, 33.38s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.566,  Train_accy 66.03:  75%|███████▌  | 15/20 [08:24<02:46, 33.21s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.551,  Train_accy 66.67, Test_accy 74.49:  75%|███████▌  | 15/20 [09:01<02:46, 33.21s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.551,  Train_accy 66.67, Test_accy 74.49:  80%|████████  | 16/20 [09:01<02:17, 34.30s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.544,  Train_accy 67.50:  80%|████████  | 16/20 [09:34<02:17, 34.30s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.544,  Train_accy 67.50:  85%|████████▌ | 17/20 [09:34<01:41, 33.85s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.551,  Train_accy 66.83:  85%|████████▌ | 17/20 [10:07<01:41, 33.85s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.551,  Train_accy 66.83:  90%|█████████ | 18/20 [10:07<01:07, 33.55s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.551,  Train_accy 67.30:  90%|█████████ | 18/20 [10:40<01:07, 33.55s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.551,  Train_accy 67.30:  95%|█████████▌| 19/20 [10:40<00:33, 33.34s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.565,  Train_accy 67.46:  95%|█████████▌| 19/20 [11:12<00:33, 33.34s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.565,  Train_accy 67.46: 100%|██████████| 20/20 [11:12<00:00, 33.18s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.565,  Train_accy 67.46: 100%|██████████| 20/20 [11:12<00:00, 33.65s/it]
2024-09-05 05:07:01,294 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.565,  Train_accy 67.46
2024-09-05 05:07:01,295 [foster.py] => do not weight align student!
2024-09-05 05:07:05,298 [foster.py] => darknet eval: 
2024-09-05 05:07:05,298 [foster.py] => CNN top1 curve: 74.41
2024-09-05 05:07:05,299 [foster.py] => CNN top5 curve: 97.31
2024-09-05 05:07:05,302 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 05:08:19,557 [foster.py] => Exemplar size: 2000
2024-09-05 05:08:19,557 [trainer.py] => CNN: {'total': 76.6, '00-19': 95.55, '20-39': 91.3, '40-59': 83.94, '60-79': 68.83, '80-99': 49.07, 'old': 84.66, 'new': 49.07}
2024-09-05 05:08:19,557 [trainer.py] => NME: {'total': 90.66, '00-19': 89.47, '20-39': 87.92, '40-59': 91.28, '60-79': 89.07, '80-99': 94.8, 'old': 89.45, 'new': 94.8}
2024-09-05 05:08:19,557 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48, 76.17, 76.6]
2024-09-05 05:08:19,557 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 97.71, 97.64]
2024-09-05 05:08:19,557 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05, 91.29, 90.66]
2024-09-05 05:08:19,557 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.24, 98.91]

Average Accuracy (CNN): 84.89
Average Accuracy (NME): 94.38
2024-09-05 05:08:19,557 [trainer.py] => Average Accuracy (CNN): 84.89
2024-09-05 05:08:19,558 [trainer.py] => Average Accuracy (NME): 94.38
2024-09-05 05:08:19,559 [trainer.py] => All params: 171889432
2024-09-05 05:08:19,560 [trainer.py] => Trainable params: 86029256
2024-09-05 05:08:21,148 [foster.py] => Learning on 100-120
2024-09-05 05:08:21,149 [foster.py] => All params: 171950932
2024-09-05 05:08:21,150 [foster.py] => Trainable params: 86075376
2024-09-05 05:08:21,205 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 6.224, Loss_clf 1.296, Loss_fe 3.150, Loss_kd 1.482, Train_accy 62.36, Test_accy 76.27:   0%|          | 0/20 [00:38<?, ?it/s]
Task 5, Epoch 1/20 => Loss 6.224, Loss_clf 1.296, Loss_fe 3.150, Loss_kd 1.482, Train_accy 62.36, Test_accy 76.27:   5%|▌         | 1/20 [00:38<12:09, 38.40s/it]
Task 5, Epoch 2/20 => Loss 3.758, Loss_clf 0.790, Loss_fe 1.169, Loss_kd 1.500, Train_accy 64.63:   5%|▌         | 1/20 [01:08<12:09, 38.40s/it]                 
Task 5, Epoch 2/20 => Loss 3.758, Loss_clf 0.790, Loss_fe 1.169, Loss_kd 1.500, Train_accy 64.63:  10%|█         | 2/20 [01:08<10:04, 33.61s/it]
Task 5, Epoch 3/20 => Loss 3.188, Loss_clf 0.620, Loss_fe 0.811, Loss_kd 1.464, Train_accy 67.48:  10%|█         | 2/20 [01:39<10:04, 33.61s/it]
Task 5, Epoch 3/20 => Loss 3.188, Loss_clf 0.620, Loss_fe 0.811, Loss_kd 1.464, Train_accy 67.48:  15%|█▌        | 3/20 [01:39<09:06, 32.16s/it]
Task 5, Epoch 4/20 => Loss 3.053, Loss_clf 0.589, Loss_fe 0.696, Loss_kd 1.474, Train_accy 68.12:  15%|█▌        | 3/20 [02:09<09:06, 32.16s/it]
Task 5, Epoch 4/20 => Loss 3.053, Loss_clf 0.589, Loss_fe 0.696, Loss_kd 1.474, Train_accy 68.12:  20%|██        | 4/20 [02:09<08:23, 31.49s/it]
Task 5, Epoch 5/20 => Loss 2.895, Loss_clf 0.545, Loss_fe 0.606, Loss_kd 1.454, Train_accy 69.04:  20%|██        | 4/20 [02:40<08:23, 31.49s/it]
Task 5, Epoch 5/20 => Loss 2.895, Loss_clf 0.545, Loss_fe 0.606, Loss_kd 1.454, Train_accy 69.04:  25%|██▌       | 5/20 [02:40<07:47, 31.16s/it]
Task 5, Epoch 6/20 => Loss 2.913, Loss_clf 0.553, Loss_fe 0.583, Loss_kd 1.481, Train_accy 69.48, Test_accy 78.74:  25%|██▌       | 5/20 [03:19<07:47, 31.16s/it]
Task 5, Epoch 6/20 => Loss 2.913, Loss_clf 0.553, Loss_fe 0.583, Loss_kd 1.481, Train_accy 69.48, Test_accy 78.74:  30%|███       | 6/20 [03:19<07:53, 33.83s/it]
Task 5, Epoch 7/20 => Loss 2.813, Loss_clf 0.515, Loss_fe 0.536, Loss_kd 1.469, Train_accy 69.58:  30%|███       | 6/20 [03:49<07:53, 33.83s/it]                 
Task 5, Epoch 7/20 => Loss 2.813, Loss_clf 0.515, Loss_fe 0.536, Loss_kd 1.469, Train_accy 69.58:  35%|███▌      | 7/20 [03:49<07:05, 32.77s/it]
Task 5, Epoch 8/20 => Loss 2.705, Loss_clf 0.482, Loss_fe 0.463, Loss_kd 1.468, Train_accy 70.63:  35%|███▌      | 7/20 [04:20<07:05, 32.77s/it]
Task 5, Epoch 8/20 => Loss 2.705, Loss_clf 0.482, Loss_fe 0.463, Loss_kd 1.468, Train_accy 70.63:  40%|████      | 8/20 [04:20<06:25, 32.09s/it]
Task 5, Epoch 9/20 => Loss 2.708, Loss_clf 0.477, Loss_fe 0.466, Loss_kd 1.471, Train_accy 70.93:  40%|████      | 8/20 [04:50<06:25, 32.09s/it]
Task 5, Epoch 9/20 => Loss 2.708, Loss_clf 0.477, Loss_fe 0.466, Loss_kd 1.471, Train_accy 70.93:  45%|████▌     | 9/20 [04:50<05:47, 31.63s/it]
Task 5, Epoch 10/20 => Loss 2.538, Loss_clf 0.423, Loss_fe 0.370, Loss_kd 1.454, Train_accy 71.61:  45%|████▌     | 9/20 [05:21<05:47, 31.63s/it]
Task 5, Epoch 10/20 => Loss 2.538, Loss_clf 0.423, Loss_fe 0.370, Loss_kd 1.454, Train_accy 71.61:  50%|█████     | 10/20 [05:21<05:13, 31.31s/it]
Task 5, Epoch 11/20 => Loss 2.598, Loss_clf 0.436, Loss_fe 0.394, Loss_kd 1.473, Train_accy 71.21, Test_accy 78.04:  50%|█████     | 10/20 [06:00<05:13, 31.31s/it]
Task 5, Epoch 11/20 => Loss 2.598, Loss_clf 0.436, Loss_fe 0.394, Loss_kd 1.473, Train_accy 71.21, Test_accy 78.04:  55%|█████▌    | 11/20 [06:00<05:03, 33.68s/it]
Task 5, Epoch 12/20 => Loss 2.498, Loss_clf 0.407, Loss_fe 0.359, Loss_kd 1.443, Train_accy 71.99:  55%|█████▌    | 11/20 [06:31<05:03, 33.68s/it]                 
Task 5, Epoch 12/20 => Loss 2.498, Loss_clf 0.407, Loss_fe 0.359, Loss_kd 1.443, Train_accy 71.99:  60%|██████    | 12/20 [06:31<04:21, 32.74s/it]
Task 5, Epoch 13/20 => Loss 2.449, Loss_clf 0.386, Loss_fe 0.322, Loss_kd 1.451, Train_accy 72.63:  60%|██████    | 12/20 [07:01<04:21, 32.74s/it]
Task 5, Epoch 13/20 => Loss 2.449, Loss_clf 0.386, Loss_fe 0.322, Loss_kd 1.451, Train_accy 72.63:  65%|██████▌   | 13/20 [07:01<03:44, 32.11s/it]
Task 5, Epoch 14/20 => Loss 2.515, Loss_clf 0.411, Loss_fe 0.349, Loss_kd 1.462, Train_accy 73.51:  65%|██████▌   | 13/20 [07:32<03:44, 32.11s/it]
Task 5, Epoch 14/20 => Loss 2.515, Loss_clf 0.411, Loss_fe 0.349, Loss_kd 1.462, Train_accy 73.51:  70%|███████   | 14/20 [07:32<03:09, 31.67s/it]
Task 5, Epoch 15/20 => Loss 2.408, Loss_clf 0.380, Loss_fe 0.304, Loss_kd 1.436, Train_accy 73.14:  70%|███████   | 14/20 [08:03<03:09, 31.67s/it]
Task 5, Epoch 15/20 => Loss 2.408, Loss_clf 0.380, Loss_fe 0.304, Loss_kd 1.436, Train_accy 73.14:  75%|███████▌  | 15/20 [08:03<02:37, 31.41s/it]
Task 5, Epoch 16/20 => Loss 2.513, Loss_clf 0.412, Loss_fe 0.325, Loss_kd 1.480, Train_accy 71.71, Test_accy 78.32:  75%|███████▌  | 15/20 [08:42<02:37, 31.41s/it]
Task 5, Epoch 16/20 => Loss 2.513, Loss_clf 0.412, Loss_fe 0.325, Loss_kd 1.480, Train_accy 71.71, Test_accy 78.32:  80%|████████  | 16/20 [08:42<02:14, 33.75s/it]
Task 5, Epoch 17/20 => Loss 2.398, Loss_clf 0.367, Loss_fe 0.300, Loss_kd 1.443, Train_accy 72.59:  80%|████████  | 16/20 [09:13<02:14, 33.75s/it]                 
Task 5, Epoch 17/20 => Loss 2.398, Loss_clf 0.367, Loss_fe 0.300, Loss_kd 1.443, Train_accy 72.59:  85%|████████▌ | 17/20 [09:13<01:38, 32.81s/it]
Task 5, Epoch 18/20 => Loss 2.451, Loss_clf 0.394, Loss_fe 0.319, Loss_kd 1.448, Train_accy 72.43:  85%|████████▌ | 17/20 [09:43<01:38, 32.81s/it]
Task 5, Epoch 18/20 => Loss 2.451, Loss_clf 0.394, Loss_fe 0.319, Loss_kd 1.448, Train_accy 72.43:  90%|█████████ | 18/20 [09:43<01:04, 32.16s/it]
Task 5, Epoch 19/20 => Loss 2.409, Loss_clf 0.381, Loss_fe 0.297, Loss_kd 1.443, Train_accy 72.76:  90%|█████████ | 18/20 [10:14<01:04, 32.16s/it]
Task 5, Epoch 19/20 => Loss 2.409, Loss_clf 0.381, Loss_fe 0.297, Loss_kd 1.443, Train_accy 72.76:  95%|█████████▌| 19/20 [10:14<00:31, 31.70s/it]
Task 5, Epoch 20/20 => Loss 2.362, Loss_clf 0.344, Loss_fe 0.259, Loss_kd 1.466, Train_accy 73.85:  95%|█████████▌| 19/20 [10:45<00:31, 31.70s/it]
Task 5, Epoch 20/20 => Loss 2.362, Loss_clf 0.344, Loss_fe 0.259, Loss_kd 1.466, Train_accy 73.85: 100%|██████████| 20/20 [10:45<00:00, 31.38s/it]
Task 5, Epoch 20/20 => Loss 2.362, Loss_clf 0.344, Loss_fe 0.259, Loss_kd 1.466, Train_accy 73.85: 100%|██████████| 20/20 [10:45<00:00, 32.25s/it]
2024-09-05 05:19:06,248 [foster.py] => Task 5, Epoch 20/20 => Loss 2.362, Loss_clf 0.344, Loss_fe 0.259, Loss_kd 1.466, Train_accy 73.85
2024-09-05 05:19:06,249 [foster.py] => do not weight align teacher!
2024-09-05 05:19:06,253 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.735,  Train_accy 60.23, Test_accy 75.14:   0%|          | 0/20 [00:43<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.735,  Train_accy 60.23, Test_accy 75.14:   5%|▌         | 1/20 [00:43<13:38, 43.08s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.595,  Train_accy 64.74:   5%|▌         | 1/20 [01:21<13:38, 43.08s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.595,  Train_accy 64.74:  10%|█         | 2/20 [01:21<12:06, 40.35s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.619,  Train_accy 65.35:  10%|█         | 2/20 [01:59<12:06, 40.35s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.619,  Train_accy 65.35:  15%|█▌        | 3/20 [01:59<11:11, 39.48s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.606,  Train_accy 65.45:  15%|█▌        | 3/20 [02:38<11:11, 39.48s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.606,  Train_accy 65.45:  20%|██        | 4/20 [02:38<10:25, 39.07s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.633,  Train_accy 65.85:  20%|██        | 4/20 [03:16<10:25, 39.07s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.633,  Train_accy 65.85:  25%|██▌       | 5/20 [03:16<09:42, 38.85s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.582,  Train_accy 67.11, Test_accy 76.20:  25%|██▌       | 5/20 [03:59<09:42, 38.85s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.582,  Train_accy 67.11, Test_accy 76.20:  30%|███       | 6/20 [03:59<09:24, 40.29s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.559,  Train_accy 67.58:  30%|███       | 6/20 [04:38<09:24, 40.29s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.559,  Train_accy 67.58:  35%|███▌      | 7/20 [04:38<08:35, 39.68s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.575,  Train_accy 66.90:  35%|███▌      | 7/20 [05:16<08:35, 39.68s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.575,  Train_accy 66.90:  40%|████      | 8/20 [05:16<07:51, 39.29s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.609,  Train_accy 66.57:  40%|████      | 8/20 [05:55<07:51, 39.29s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.609,  Train_accy 66.57:  45%|████▌     | 9/20 [05:55<07:09, 39.01s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.581,  Train_accy 66.67:  45%|████▌     | 9/20 [06:33<07:09, 39.01s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.581,  Train_accy 66.67:  50%|█████     | 10/20 [06:33<06:28, 38.82s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.563,  Train_accy 67.04, Test_accy 76.77:  50%|█████     | 10/20 [07:16<06:28, 38.82s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.563,  Train_accy 67.04, Test_accy 76.77:  55%|█████▌    | 11/20 [07:16<06:01, 40.12s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.582,  Train_accy 66.77:  55%|█████▌    | 11/20 [07:55<06:01, 40.12s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.582,  Train_accy 66.77:  60%|██████    | 12/20 [07:55<05:16, 39.60s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.621,  Train_accy 66.06:  60%|██████    | 12/20 [08:33<05:16, 39.60s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.621,  Train_accy 66.06:  65%|██████▌   | 13/20 [08:33<04:34, 39.23s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.566,  Train_accy 67.65:  65%|██████▌   | 13/20 [09:11<04:34, 39.23s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.566,  Train_accy 67.65:  70%|███████   | 14/20 [09:11<03:53, 38.98s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.607,  Train_accy 66.40:  70%|███████   | 14/20 [09:50<03:53, 38.98s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.607,  Train_accy 66.40:  75%|███████▌  | 15/20 [09:50<03:14, 38.81s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.588,  Train_accy 67.01, Test_accy 76.84:  75%|███████▌  | 15/20 [10:33<03:14, 38.81s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.588,  Train_accy 67.01, Test_accy 76.84:  80%|████████  | 16/20 [10:33<02:40, 40.09s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.584,  Train_accy 67.11:  80%|████████  | 16/20 [11:11<02:40, 40.09s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.584,  Train_accy 67.11:  85%|████████▌ | 17/20 [11:11<01:58, 39.60s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.577,  Train_accy 67.04:  85%|████████▌ | 17/20 [11:50<01:58, 39.60s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.577,  Train_accy 67.04:  90%|█████████ | 18/20 [11:50<01:18, 39.25s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.566,  Train_accy 67.24:  90%|█████████ | 18/20 [12:28<01:18, 39.25s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.566,  Train_accy 67.24:  95%|█████████▌| 19/20 [12:28<00:38, 38.99s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.577,  Train_accy 67.92:  95%|█████████▌| 19/20 [13:07<00:38, 38.99s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.577,  Train_accy 67.92: 100%|██████████| 20/20 [13:07<00:00, 38.82s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.577,  Train_accy 67.92: 100%|██████████| 20/20 [13:07<00:00, 39.35s/it]
2024-09-05 05:32:14,748 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.577,  Train_accy 67.92
2024-09-05 05:32:14,748 [foster.py] => do not weight align student!
2024-09-05 05:32:19,454 [foster.py] => darknet eval: 
2024-09-05 05:32:19,454 [foster.py] => CNN top1 curve: 76.69
2024-09-05 05:32:19,454 [foster.py] => CNN top5 curve: 97.03
2024-09-05 05:32:19,458 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 05:33:45,339 [foster.py] => Exemplar size: 2400
2024-09-05 05:33:45,340 [trainer.py] => CNN: {'total': 78.25, '00-19': 95.55, '20-39': 88.89, '40-59': 86.24, '60-79': 82.19, '80-99': 76.95, '100-119': 39.47, 'old': 85.69, 'new': 39.47}
2024-09-05 05:33:45,340 [trainer.py] => NME: {'total': 89.12, '00-19': 87.04, '20-39': 89.37, '40-59': 91.74, '60-79': 86.23, '80-99': 91.82, '100-119': 88.6, 'old': 89.23, 'new': 88.6}
2024-09-05 05:33:45,340 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48, 76.17, 76.6, 78.25]
2024-09-05 05:33:45,340 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 97.71, 97.64, 97.1]
2024-09-05 05:33:45,340 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05, 91.29, 90.66, 89.12]
2024-09-05 05:33:45,340 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.24, 98.91, 98.94]

Average Accuracy (CNN): 83.78
Average Accuracy (NME): 93.5
2024-09-05 05:33:45,340 [trainer.py] => Average Accuracy (CNN): 83.78
2024-09-05 05:33:45,340 [trainer.py] => Average Accuracy (NME): 93.5
2024-09-05 05:33:45,341 [trainer.py] => All params: 171950932
2024-09-05 05:33:45,342 [trainer.py] => Trainable params: 86075376
2024-09-05 05:33:46,754 [foster.py] => Learning on 120-140
2024-09-05 05:33:46,756 [foster.py] => All params: 172012432
2024-09-05 05:33:46,757 [foster.py] => Trainable params: 86121496
2024-09-05 05:33:46,810 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 6.702, Loss_clf 1.398, Loss_fe 3.475, Loss_kd 1.568, Train_accy 62.76, Test_accy 75.87:   0%|          | 0/20 [00:43<?, ?it/s]
Task 6, Epoch 1/20 => Loss 6.702, Loss_clf 1.398, Loss_fe 3.475, Loss_kd 1.568, Train_accy 62.76, Test_accy 75.87:   5%|▌         | 1/20 [00:43<13:47, 43.56s/it]
Task 6, Epoch 2/20 => Loss 3.929, Loss_clf 0.867, Loss_fe 1.242, Loss_kd 1.560, Train_accy 66.96:   5%|▌         | 1/20 [01:17<13:47, 43.56s/it]                 
Task 6, Epoch 2/20 => Loss 3.929, Loss_clf 0.867, Loss_fe 1.242, Loss_kd 1.560, Train_accy 66.96:  10%|█         | 2/20 [01:17<11:27, 38.18s/it]
Task 6, Epoch 3/20 => Loss 3.357, Loss_clf 0.683, Loss_fe 0.876, Loss_kd 1.542, Train_accy 67.92:  10%|█         | 2/20 [01:52<11:27, 38.18s/it]
Task 6, Epoch 3/20 => Loss 3.357, Loss_clf 0.683, Loss_fe 0.876, Loss_kd 1.542, Train_accy 67.92:  15%|█▌        | 3/20 [01:52<10:20, 36.49s/it]
Task 6, Epoch 4/20 => Loss 3.164, Loss_clf 0.612, Loss_fe 0.744, Loss_kd 1.550, Train_accy 69.59:  15%|█▌        | 3/20 [02:26<10:20, 36.49s/it]
Task 6, Epoch 4/20 => Loss 3.164, Loss_clf 0.612, Loss_fe 0.744, Loss_kd 1.550, Train_accy 69.59:  20%|██        | 4/20 [02:26<09:31, 35.72s/it]
Task 6, Epoch 5/20 => Loss 3.075, Loss_clf 0.600, Loss_fe 0.675, Loss_kd 1.543, Train_accy 70.90:  20%|██        | 4/20 [03:01<09:31, 35.72s/it]
Task 6, Epoch 5/20 => Loss 3.075, Loss_clf 0.600, Loss_fe 0.675, Loss_kd 1.543, Train_accy 70.90:  25%|██▌       | 5/20 [03:01<08:49, 35.32s/it]
Task 6, Epoch 6/20 => Loss 2.913, Loss_clf 0.540, Loss_fe 0.591, Loss_kd 1.527, Train_accy 71.91, Test_accy 76.84:  25%|██▌       | 5/20 [03:45<08:49, 35.32s/it]
Task 6, Epoch 6/20 => Loss 2.913, Loss_clf 0.540, Loss_fe 0.591, Loss_kd 1.527, Train_accy 71.91, Test_accy 76.84:  30%|███       | 6/20 [03:45<08:57, 38.38s/it]
Task 6, Epoch 7/20 => Loss 2.770, Loss_clf 0.500, Loss_fe 0.512, Loss_kd 1.507, Train_accy 72.66:  30%|███       | 6/20 [04:20<08:57, 38.38s/it]                 
Task 6, Epoch 7/20 => Loss 2.770, Loss_clf 0.500, Loss_fe 0.512, Loss_kd 1.507, Train_accy 72.66:  35%|███▌      | 7/20 [04:20<08:03, 37.16s/it]
Task 6, Epoch 8/20 => Loss 2.751, Loss_clf 0.500, Loss_fe 0.482, Loss_kd 1.516, Train_accy 72.42:  35%|███▌      | 7/20 [04:55<08:03, 37.16s/it]
Task 6, Epoch 8/20 => Loss 2.751, Loss_clf 0.500, Loss_fe 0.482, Loss_kd 1.516, Train_accy 72.42:  40%|████      | 8/20 [04:55<07:16, 36.38s/it]
Task 6, Epoch 9/20 => Loss 2.856, Loss_clf 0.539, Loss_fe 0.506, Loss_kd 1.552, Train_accy 72.63:  40%|████      | 8/20 [05:29<07:16, 36.38s/it]
Task 6, Epoch 9/20 => Loss 2.856, Loss_clf 0.539, Loss_fe 0.506, Loss_kd 1.552, Train_accy 72.63:  45%|████▌     | 9/20 [05:29<06:34, 35.86s/it]
Task 6, Epoch 10/20 => Loss 2.652, Loss_clf 0.441, Loss_fe 0.416, Loss_kd 1.539, Train_accy 73.82:  45%|████▌     | 9/20 [06:04<06:34, 35.86s/it]
Task 6, Epoch 10/20 => Loss 2.652, Loss_clf 0.441, Loss_fe 0.416, Loss_kd 1.539, Train_accy 73.82:  50%|█████     | 10/20 [06:04<05:55, 35.51s/it]
Task 6, Epoch 11/20 => Loss 2.575, Loss_clf 0.434, Loss_fe 0.385, Loss_kd 1.505, Train_accy 73.46, Test_accy 77.45:  50%|█████     | 10/20 [06:49<05:55, 35.51s/it]
Task 6, Epoch 11/20 => Loss 2.575, Loss_clf 0.434, Loss_fe 0.385, Loss_kd 1.505, Train_accy 73.46, Test_accy 77.45:  55%|█████▌    | 11/20 [06:49<05:44, 38.22s/it]
Task 6, Epoch 12/20 => Loss 2.696, Loss_clf 0.463, Loss_fe 0.425, Loss_kd 1.550, Train_accy 73.85:  55%|█████▌    | 11/20 [07:23<05:44, 38.22s/it]                 
Task 6, Epoch 12/20 => Loss 2.696, Loss_clf 0.463, Loss_fe 0.425, Loss_kd 1.550, Train_accy 73.85:  60%|██████    | 12/20 [07:23<04:57, 37.14s/it]
Task 6, Epoch 13/20 => Loss 2.610, Loss_clf 0.435, Loss_fe 0.376, Loss_kd 1.543, Train_accy 73.64:  60%|██████    | 12/20 [07:58<04:57, 37.14s/it]
Task 6, Epoch 13/20 => Loss 2.610, Loss_clf 0.435, Loss_fe 0.376, Loss_kd 1.543, Train_accy 73.64:  65%|██████▌   | 13/20 [07:58<04:14, 36.41s/it]
Task 6, Epoch 14/20 => Loss 2.619, Loss_clf 0.444, Loss_fe 0.372, Loss_kd 1.545, Train_accy 73.64:  65%|██████▌   | 13/20 [08:33<04:14, 36.41s/it]
Task 6, Epoch 14/20 => Loss 2.619, Loss_clf 0.444, Loss_fe 0.372, Loss_kd 1.545, Train_accy 73.64:  70%|███████   | 14/20 [08:33<03:35, 35.89s/it]
Task 6, Epoch 15/20 => Loss 2.527, Loss_clf 0.413, Loss_fe 0.338, Loss_kd 1.522, Train_accy 74.66:  70%|███████   | 14/20 [09:07<03:35, 35.89s/it]
Task 6, Epoch 15/20 => Loss 2.527, Loss_clf 0.413, Loss_fe 0.338, Loss_kd 1.522, Train_accy 74.66:  75%|███████▌  | 15/20 [09:07<02:57, 35.54s/it]
Task 6, Epoch 16/20 => Loss 2.670, Loss_clf 0.462, Loss_fe 0.384, Loss_kd 1.563, Train_accy 74.27, Test_accy 76.23:  75%|███████▌  | 15/20 [09:52<02:57, 35.54s/it]
Task 6, Epoch 16/20 => Loss 2.670, Loss_clf 0.462, Loss_fe 0.384, Loss_kd 1.563, Train_accy 74.27, Test_accy 76.23:  80%|████████  | 16/20 [09:52<02:32, 38.20s/it]
Task 6, Epoch 17/20 => Loss 2.560, Loss_clf 0.427, Loss_fe 0.338, Loss_kd 1.538, Train_accy 73.52:  80%|████████  | 16/20 [10:26<02:32, 38.20s/it]                 
Task 6, Epoch 17/20 => Loss 2.560, Loss_clf 0.427, Loss_fe 0.338, Loss_kd 1.538, Train_accy 73.52:  85%|████████▌ | 17/20 [10:26<01:51, 37.14s/it]
Task 6, Epoch 18/20 => Loss 2.426, Loss_clf 0.357, Loss_fe 0.300, Loss_kd 1.516, Train_accy 76.21:  85%|████████▌ | 17/20 [11:01<01:51, 37.14s/it]
Task 6, Epoch 18/20 => Loss 2.426, Loss_clf 0.357, Loss_fe 0.300, Loss_kd 1.516, Train_accy 76.21:  90%|█████████ | 18/20 [11:01<01:12, 36.42s/it]
Task 6, Epoch 19/20 => Loss 2.561, Loss_clf 0.417, Loss_fe 0.333, Loss_kd 1.553, Train_accy 75.28:  90%|█████████ | 18/20 [11:36<01:12, 36.42s/it]
Task 6, Epoch 19/20 => Loss 2.561, Loss_clf 0.417, Loss_fe 0.333, Loss_kd 1.553, Train_accy 75.28:  95%|█████████▌| 19/20 [11:36<00:35, 35.90s/it]
Task 6, Epoch 20/20 => Loss 2.457, Loss_clf 0.385, Loss_fe 0.305, Loss_kd 1.514, Train_accy 75.07:  95%|█████████▌| 19/20 [12:11<00:35, 35.90s/it]
Task 6, Epoch 20/20 => Loss 2.457, Loss_clf 0.385, Loss_fe 0.305, Loss_kd 1.514, Train_accy 75.07: 100%|██████████| 20/20 [12:11<00:00, 35.55s/it]
Task 6, Epoch 20/20 => Loss 2.457, Loss_clf 0.385, Loss_fe 0.305, Loss_kd 1.514, Train_accy 75.07: 100%|██████████| 20/20 [12:11<00:00, 36.56s/it]
2024-09-05 05:45:57,934 [foster.py] => Task 6, Epoch 20/20 => Loss 2.457, Loss_clf 0.385, Loss_fe 0.305, Loss_kd 1.514, Train_accy 75.07
2024-09-05 05:45:57,936 [foster.py] => do not weight align teacher!
2024-09-05 05:45:57,940 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.768,  Train_accy 62.85, Test_accy 74.77:   0%|          | 0/20 [00:48<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.768,  Train_accy 62.85, Test_accy 74.77:   5%|▌         | 1/20 [00:48<15:27, 48.83s/it]
SNet: Task 6, Epoch 2/20 => Loss 1.682,  Train_accy 66.28:   5%|▌         | 1/20 [01:32<15:27, 48.83s/it]                 
SNet: Task 6, Epoch 2/20 => Loss 1.682,  Train_accy 66.28:  10%|█         | 2/20 [01:32<13:43, 45.76s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.618,  Train_accy 67.56:  10%|█         | 2/20 [02:16<13:43, 45.76s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.618,  Train_accy 67.56:  15%|█▌        | 3/20 [02:16<12:41, 44.78s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.633,  Train_accy 68.07:  15%|█▌        | 3/20 [02:59<12:41, 44.78s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.633,  Train_accy 68.07:  20%|██        | 4/20 [02:59<11:49, 44.32s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.665,  Train_accy 67.05:  20%|██        | 4/20 [03:43<11:49, 44.32s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.665,  Train_accy 67.05:  25%|██▌       | 5/20 [03:43<11:00, 44.05s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.657,  Train_accy 67.65, Test_accy 75.14:  25%|██▌       | 5/20 [04:32<11:00, 44.05s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.657,  Train_accy 67.65, Test_accy 75.14:  30%|███       | 6/20 [04:32<10:39, 45.69s/it]
SNet: Task 6, Epoch 7/20 => Loss 1.668,  Train_accy 67.20:  30%|███       | 6/20 [05:15<10:39, 45.69s/it]                 
SNet: Task 6, Epoch 7/20 => Loss 1.668,  Train_accy 67.20:  35%|███▌      | 7/20 [05:15<09:44, 45.00s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.632,  Train_accy 68.84:  35%|███▌      | 7/20 [05:59<09:44, 45.00s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.632,  Train_accy 68.84:  40%|████      | 8/20 [05:59<08:54, 44.55s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.623,  Train_accy 68.37:  40%|████      | 8/20 [06:42<08:54, 44.55s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.623,  Train_accy 68.37:  45%|████▌     | 9/20 [06:42<08:06, 44.24s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.633,  Train_accy 68.87:  45%|████▌     | 9/20 [07:26<08:06, 44.24s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.633,  Train_accy 68.87:  50%|█████     | 10/20 [07:26<07:20, 44.05s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.609,  Train_accy 69.89, Test_accy 74.65:  50%|█████     | 10/20 [08:15<07:20, 44.05s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.609,  Train_accy 69.89, Test_accy 74.65:  55%|█████▌    | 11/20 [08:15<06:49, 45.53s/it]
SNet: Task 6, Epoch 12/20 => Loss 1.636,  Train_accy 69.02:  55%|█████▌    | 11/20 [08:58<06:49, 45.53s/it]                 
SNet: Task 6, Epoch 12/20 => Loss 1.636,  Train_accy 69.02:  60%|██████    | 12/20 [08:58<05:59, 44.93s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.635,  Train_accy 68.57:  60%|██████    | 12/20 [09:42<05:59, 44.93s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.635,  Train_accy 68.57:  65%|██████▌   | 13/20 [09:42<05:11, 44.52s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.617,  Train_accy 68.93:  65%|██████▌   | 13/20 [10:26<05:11, 44.52s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.617,  Train_accy 68.93:  70%|███████   | 14/20 [10:26<04:25, 44.24s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.613,  Train_accy 69.80:  70%|███████   | 14/20 [11:09<04:25, 44.24s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.613,  Train_accy 69.80:  75%|███████▌  | 15/20 [11:09<03:40, 44.03s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.626,  Train_accy 69.17, Test_accy 75.26:  75%|███████▌  | 15/20 [11:58<03:40, 44.03s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.626,  Train_accy 69.17, Test_accy 75.26:  80%|████████  | 16/20 [11:58<03:01, 45.47s/it]
SNet: Task 6, Epoch 17/20 => Loss 1.622,  Train_accy 69.35:  80%|████████  | 16/20 [12:41<03:01, 45.47s/it]                 
SNet: Task 6, Epoch 17/20 => Loss 1.622,  Train_accy 69.35:  85%|████████▌ | 17/20 [12:41<02:14, 44.90s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.613,  Train_accy 69.56:  85%|████████▌ | 17/20 [13:25<02:14, 44.90s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.613,  Train_accy 69.56:  90%|█████████ | 18/20 [13:25<01:28, 44.50s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.609,  Train_accy 69.32:  90%|█████████ | 18/20 [14:09<01:28, 44.50s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.609,  Train_accy 69.32:  95%|█████████▌| 19/20 [14:09<00:44, 44.21s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.612,  Train_accy 69.23:  95%|█████████▌| 19/20 [14:52<00:44, 44.21s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.612,  Train_accy 69.23: 100%|██████████| 20/20 [14:52<00:00, 44.01s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.612,  Train_accy 69.23: 100%|██████████| 20/20 [14:52<00:00, 44.63s/it]
2024-09-05 06:00:52,035 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.612,  Train_accy 69.23
2024-09-05 06:00:52,036 [foster.py] => do not weight align student!
2024-09-05 06:00:57,331 [foster.py] => darknet eval: 
2024-09-05 06:00:57,332 [foster.py] => CNN top1 curve: 75.32
2024-09-05 06:00:57,332 [foster.py] => CNN top5 curve: 95.98
2024-09-05 06:00:57,336 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 06:02:33,757 [foster.py] => Exemplar size: 2800
2024-09-05 06:02:33,757 [trainer.py] => CNN: {'total': 76.42, '00-19': 93.93, '20-39': 87.92, '40-59': 86.7, '60-79': 83.0, '80-99': 84.76, '100-119': 67.98, '120-139': 28.0, 'old': 84.11, 'new': 28.0}
2024-09-05 06:02:33,757 [trainer.py] => NME: {'total': 88.36, '00-19': 89.88, '20-39': 89.86, '40-59': 88.99, '60-79': 86.64, '80-99': 90.71, '100-119': 87.72, '120-139': 84.44, 'old': 88.98, 'new': 84.44}
2024-09-05 06:02:33,757 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48, 76.17, 76.6, 78.25, 76.42]
2024-09-05 06:02:33,757 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 97.71, 97.64, 97.1, 97.07]
2024-09-05 06:02:33,757 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05, 91.29, 90.66, 89.12, 88.36]
2024-09-05 06:02:33,757 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.24, 98.91, 98.94, 98.6]

Average Accuracy (CNN): 82.73
Average Accuracy (NME): 92.77
2024-09-05 06:02:33,757 [trainer.py] => Average Accuracy (CNN): 82.73
2024-09-05 06:02:33,758 [trainer.py] => Average Accuracy (NME): 92.77
2024-09-05 06:02:33,759 [trainer.py] => All params: 172012432
2024-09-05 06:02:33,760 [trainer.py] => Trainable params: 86121496
2024-09-05 06:02:35,166 [foster.py] => Learning on 140-160
2024-09-05 06:02:35,168 [foster.py] => All params: 172073932
2024-09-05 06:02:35,168 [foster.py] => Trainable params: 86167616
2024-09-05 06:02:35,220 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 6.625, Loss_clf 1.280, Loss_fe 3.508, Loss_kd 1.607, Train_accy 64.78, Test_accy 74.35:   0%|          | 0/20 [00:48<?, ?it/s]
Task 7, Epoch 1/20 => Loss 6.625, Loss_clf 1.280, Loss_fe 3.508, Loss_kd 1.607, Train_accy 64.78, Test_accy 74.35:   5%|▌         | 1/20 [00:48<15:23, 48.62s/it]
Task 7, Epoch 2/20 => Loss 3.912, Loss_clf 0.787, Loss_fe 1.292, Loss_kd 1.604, Train_accy 69.01:   5%|▌         | 1/20 [01:26<15:23, 48.62s/it]                 
Task 7, Epoch 2/20 => Loss 3.912, Loss_clf 0.787, Loss_fe 1.292, Loss_kd 1.604, Train_accy 69.01:  10%|█         | 2/20 [01:26<12:43, 42.41s/it]
Task 7, Epoch 3/20 => Loss 3.469, Loss_clf 0.680, Loss_fe 0.949, Loss_kd 1.610, Train_accy 70.05:  10%|█         | 2/20 [02:04<12:43, 42.41s/it]
Task 7, Epoch 3/20 => Loss 3.469, Loss_clf 0.680, Loss_fe 0.949, Loss_kd 1.610, Train_accy 70.05:  15%|█▌        | 3/20 [02:04<11:28, 40.51s/it]
Task 7, Epoch 4/20 => Loss 3.351, Loss_clf 0.668, Loss_fe 0.838, Loss_kd 1.615, Train_accy 70.13:  15%|█▌        | 3/20 [02:43<11:28, 40.51s/it]
Task 7, Epoch 4/20 => Loss 3.351, Loss_clf 0.668, Loss_fe 0.838, Loss_kd 1.615, Train_accy 70.13:  20%|██        | 4/20 [02:43<10:34, 39.66s/it]
Task 7, Epoch 5/20 => Loss 3.066, Loss_clf 0.598, Loss_fe 0.667, Loss_kd 1.576, Train_accy 70.62:  20%|██        | 4/20 [03:21<10:34, 39.66s/it]
Task 7, Epoch 5/20 => Loss 3.066, Loss_clf 0.598, Loss_fe 0.667, Loss_kd 1.576, Train_accy 70.62:  25%|██▌       | 5/20 [03:21<09:47, 39.20s/it]
Task 7, Epoch 6/20 => Loss 3.025, Loss_clf 0.569, Loss_fe 0.635, Loss_kd 1.594, Train_accy 71.67, Test_accy 74.14:  25%|██▌       | 5/20 [04:11<09:47, 39.20s/it]
Task 7, Epoch 6/20 => Loss 3.025, Loss_clf 0.569, Loss_fe 0.635, Loss_kd 1.594, Train_accy 71.67, Test_accy 74.14:  30%|███       | 6/20 [04:11<09:57, 42.68s/it]
Task 7, Epoch 7/20 => Loss 2.972, Loss_clf 0.560, Loss_fe 0.591, Loss_kd 1.593, Train_accy 71.96:  30%|███       | 6/20 [04:49<09:57, 42.68s/it]                 
Task 7, Epoch 7/20 => Loss 2.972, Loss_clf 0.560, Loss_fe 0.591, Loss_kd 1.593, Train_accy 71.96:  35%|███▌      | 7/20 [04:49<08:56, 41.28s/it]
Task 7, Epoch 8/20 => Loss 2.839, Loss_clf 0.518, Loss_fe 0.524, Loss_kd 1.572, Train_accy 72.53:  35%|███▌      | 7/20 [05:27<08:56, 41.28s/it]
Task 7, Epoch 8/20 => Loss 2.839, Loss_clf 0.518, Loss_fe 0.524, Loss_kd 1.572, Train_accy 72.53:  40%|████      | 8/20 [05:27<08:04, 40.39s/it]
Task 7, Epoch 9/20 => Loss 2.913, Loss_clf 0.532, Loss_fe 0.534, Loss_kd 1.615, Train_accy 72.07:  40%|████      | 8/20 [06:06<08:04, 40.39s/it]
Task 7, Epoch 9/20 => Loss 2.913, Loss_clf 0.532, Loss_fe 0.534, Loss_kd 1.615, Train_accy 72.07:  45%|████▌     | 9/20 [06:06<07:17, 39.76s/it]
Task 7, Epoch 10/20 => Loss 2.876, Loss_clf 0.520, Loss_fe 0.505, Loss_kd 1.619, Train_accy 71.96:  45%|████▌     | 9/20 [06:44<07:17, 39.76s/it]
Task 7, Epoch 10/20 => Loss 2.876, Loss_clf 0.520, Loss_fe 0.505, Loss_kd 1.619, Train_accy 71.96:  50%|█████     | 10/20 [06:44<06:33, 39.36s/it]
Task 7, Epoch 11/20 => Loss 2.763, Loss_clf 0.487, Loss_fe 0.439, Loss_kd 1.607, Train_accy 72.74, Test_accy 75.94:  50%|█████     | 10/20 [07:34<06:33, 39.36s/it]
Task 7, Epoch 11/20 => Loss 2.763, Loss_clf 0.487, Loss_fe 0.439, Loss_kd 1.607, Train_accy 72.74, Test_accy 75.94:  55%|█████▌    | 11/20 [07:34<06:22, 42.46s/it]
Task 7, Epoch 12/20 => Loss 2.655, Loss_clf 0.448, Loss_fe 0.392, Loss_kd 1.588, Train_accy 74.70:  55%|█████▌    | 11/20 [08:12<06:22, 42.46s/it]                 
Task 7, Epoch 12/20 => Loss 2.655, Loss_clf 0.448, Loss_fe 0.392, Loss_kd 1.588, Train_accy 74.70:  60%|██████    | 12/20 [08:12<05:29, 41.23s/it]
Task 7, Epoch 13/20 => Loss 2.634, Loss_clf 0.446, Loss_fe 0.394, Loss_kd 1.570, Train_accy 73.87:  60%|██████    | 12/20 [08:51<05:29, 41.23s/it]
Task 7, Epoch 13/20 => Loss 2.634, Loss_clf 0.446, Loss_fe 0.394, Loss_kd 1.570, Train_accy 73.87:  65%|██████▌   | 13/20 [08:51<04:42, 40.39s/it]
Task 7, Epoch 14/20 => Loss 2.593, Loss_clf 0.433, Loss_fe 0.368, Loss_kd 1.568, Train_accy 74.46:  65%|██████▌   | 13/20 [09:29<04:42, 40.39s/it]
Task 7, Epoch 14/20 => Loss 2.593, Loss_clf 0.433, Loss_fe 0.368, Loss_kd 1.568, Train_accy 74.46:  70%|███████   | 14/20 [09:29<03:58, 39.80s/it]
Task 7, Epoch 15/20 => Loss 2.582, Loss_clf 0.423, Loss_fe 0.361, Loss_kd 1.574, Train_accy 74.30:  70%|███████   | 14/20 [10:08<03:58, 39.80s/it]
Task 7, Epoch 15/20 => Loss 2.582, Loss_clf 0.423, Loss_fe 0.361, Loss_kd 1.574, Train_accy 74.30:  75%|███████▌  | 15/20 [10:08<03:16, 39.39s/it]
Task 7, Epoch 16/20 => Loss 2.625, Loss_clf 0.453, Loss_fe 0.358, Loss_kd 1.588, Train_accy 74.06, Test_accy 74.88:  75%|███████▌  | 15/20 [10:57<03:16, 39.39s/it]
Task 7, Epoch 16/20 => Loss 2.625, Loss_clf 0.453, Loss_fe 0.358, Loss_kd 1.588, Train_accy 74.06, Test_accy 74.88:  80%|████████  | 16/20 [10:57<02:49, 42.43s/it]
Task 7, Epoch 17/20 => Loss 2.582, Loss_clf 0.428, Loss_fe 0.359, Loss_kd 1.570, Train_accy 75.05:  80%|████████  | 16/20 [11:35<02:49, 42.43s/it]                 
Task 7, Epoch 17/20 => Loss 2.582, Loss_clf 0.428, Loss_fe 0.359, Loss_kd 1.570, Train_accy 75.05:  85%|████████▌ | 17/20 [11:35<02:03, 41.21s/it]
Task 7, Epoch 18/20 => Loss 2.573, Loss_clf 0.414, Loss_fe 0.345, Loss_kd 1.587, Train_accy 75.05:  85%|████████▌ | 17/20 [12:14<02:03, 41.21s/it]
Task 7, Epoch 18/20 => Loss 2.573, Loss_clf 0.414, Loss_fe 0.345, Loss_kd 1.587, Train_accy 75.05:  90%|█████████ | 18/20 [12:14<01:20, 40.39s/it]
Task 7, Epoch 19/20 => Loss 2.518, Loss_clf 0.401, Loss_fe 0.326, Loss_kd 1.567, Train_accy 75.67:  90%|█████████ | 18/20 [12:52<01:20, 40.39s/it]
Task 7, Epoch 19/20 => Loss 2.518, Loss_clf 0.401, Loss_fe 0.326, Loss_kd 1.567, Train_accy 75.67:  95%|█████████▌| 19/20 [12:52<00:39, 39.82s/it]
Task 7, Epoch 20/20 => Loss 2.609, Loss_clf 0.437, Loss_fe 0.350, Loss_kd 1.594, Train_accy 74.44:  95%|█████████▌| 19/20 [13:31<00:39, 39.82s/it]
Task 7, Epoch 20/20 => Loss 2.609, Loss_clf 0.437, Loss_fe 0.350, Loss_kd 1.594, Train_accy 74.44: 100%|██████████| 20/20 [13:31<00:00, 39.42s/it]
Task 7, Epoch 20/20 => Loss 2.609, Loss_clf 0.437, Loss_fe 0.350, Loss_kd 1.594, Train_accy 74.44: 100%|██████████| 20/20 [13:31<00:00, 40.57s/it]
2024-09-05 06:16:06,631 [foster.py] => Task 7, Epoch 20/20 => Loss 2.609, Loss_clf 0.437, Loss_fe 0.350, Loss_kd 1.594, Train_accy 74.44
2024-09-05 06:16:06,632 [foster.py] => do not weight align teacher!
2024-09-05 06:16:06,636 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.762,  Train_accy 65.13, Test_accy 74.30:   0%|          | 0/20 [00:54<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.762,  Train_accy 65.13, Test_accy 74.30:   5%|▌         | 1/20 [00:54<17:10, 54.24s/it]
SNet: Task 7, Epoch 2/20 => Loss 1.683,  Train_accy 67.80:   5%|▌         | 1/20 [01:42<17:10, 54.24s/it]                 
SNet: Task 7, Epoch 2/20 => Loss 1.683,  Train_accy 67.80:  10%|█         | 2/20 [01:42<15:13, 50.74s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.661,  Train_accy 68.49:  10%|█         | 2/20 [02:30<15:13, 50.74s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.661,  Train_accy 68.49:  15%|█▌        | 3/20 [02:30<14:03, 49.63s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.680,  Train_accy 69.25:  15%|█▌        | 3/20 [03:19<14:03, 49.63s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.680,  Train_accy 69.25:  20%|██        | 4/20 [03:19<13:05, 49.12s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.640,  Train_accy 69.19:  20%|██        | 4/20 [04:07<13:05, 49.12s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.640,  Train_accy 69.19:  25%|██▌       | 5/20 [04:07<12:12, 48.84s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.640,  Train_accy 68.92, Test_accy 73.93:  25%|██▌       | 5/20 [05:01<12:12, 48.84s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.640,  Train_accy 68.92, Test_accy 73.93:  30%|███       | 6/20 [05:01<11:49, 50.71s/it]
SNet: Task 7, Epoch 7/20 => Loss 1.669,  Train_accy 69.49:  30%|███       | 6/20 [05:50<11:49, 50.71s/it]                 
SNet: Task 7, Epoch 7/20 => Loss 1.669,  Train_accy 69.49:  35%|███▌      | 7/20 [05:50<10:48, 49.92s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.643,  Train_accy 69.38:  35%|███▌      | 7/20 [06:38<10:48, 49.92s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.643,  Train_accy 69.38:  40%|████      | 8/20 [06:38<09:52, 49.40s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.622,  Train_accy 69.60:  40%|████      | 8/20 [07:26<09:52, 49.40s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.622,  Train_accy 69.60:  45%|████▌     | 9/20 [07:26<08:59, 49.05s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.649,  Train_accy 69.25:  45%|████▌     | 9/20 [08:15<08:59, 49.05s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.649,  Train_accy 69.25:  50%|█████     | 10/20 [08:15<08:08, 48.82s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.639,  Train_accy 70.24, Test_accy 73.93:  50%|█████     | 10/20 [09:09<08:08, 48.82s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.639,  Train_accy 70.24, Test_accy 73.93:  55%|█████▌    | 11/20 [09:09<07:34, 50.50s/it]
SNet: Task 7, Epoch 12/20 => Loss 1.654,  Train_accy 70.13:  55%|█████▌    | 11/20 [09:57<07:34, 50.50s/it]                 
SNet: Task 7, Epoch 12/20 => Loss 1.654,  Train_accy 70.13:  60%|██████    | 12/20 [09:57<06:38, 49.83s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.646,  Train_accy 69.84:  60%|██████    | 12/20 [10:45<06:38, 49.83s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.646,  Train_accy 69.84:  65%|██████▌   | 13/20 [10:45<05:45, 49.38s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.653,  Train_accy 70.27:  65%|██████▌   | 13/20 [11:34<05:45, 49.38s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.653,  Train_accy 70.27:  70%|███████   | 14/20 [11:34<04:54, 49.07s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.641,  Train_accy 70.38:  70%|███████   | 14/20 [12:22<04:54, 49.07s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.641,  Train_accy 70.38:  75%|███████▌  | 15/20 [12:22<04:04, 48.84s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.626,  Train_accy 70.32, Test_accy 74.09:  75%|███████▌  | 15/20 [13:16<04:04, 48.84s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.626,  Train_accy 70.32, Test_accy 74.09:  80%|████████  | 16/20 [13:16<03:21, 50.48s/it]
SNet: Task 7, Epoch 17/20 => Loss 1.622,  Train_accy 70.75:  80%|████████  | 16/20 [14:05<03:21, 50.48s/it]                 
SNet: Task 7, Epoch 17/20 => Loss 1.622,  Train_accy 70.75:  85%|████████▌ | 17/20 [14:05<02:29, 49.83s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.660,  Train_accy 69.65:  85%|████████▌ | 17/20 [14:53<02:29, 49.83s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.660,  Train_accy 69.65:  90%|█████████ | 18/20 [14:53<01:38, 49.37s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.624,  Train_accy 70.16:  90%|█████████ | 18/20 [15:41<01:38, 49.37s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.624,  Train_accy 70.16:  95%|█████████▌| 19/20 [15:41<00:49, 49.04s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.649,  Train_accy 69.92:  95%|█████████▌| 19/20 [16:30<00:49, 49.04s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.649,  Train_accy 69.92: 100%|██████████| 20/20 [16:30<00:00, 48.83s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.649,  Train_accy 69.92: 100%|██████████| 20/20 [16:30<00:00, 49.51s/it]
2024-09-05 06:32:38,226 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 1.649,  Train_accy 69.92
2024-09-05 06:32:38,226 [foster.py] => do not weight align student!
2024-09-05 06:32:44,240 [foster.py] => darknet eval: 
2024-09-05 06:32:44,241 [foster.py] => CNN top1 curve: 74.09
2024-09-05 06:32:44,241 [foster.py] => CNN top5 curve: 95.72
2024-09-05 06:32:44,244 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 06:34:31,933 [foster.py] => Exemplar size: 3200
2024-09-05 06:34:31,933 [trainer.py] => CNN: {'total': 74.19, '00-19': 89.88, '20-39': 88.41, '40-59': 88.07, '60-79': 83.4, '80-99': 87.36, '100-119': 77.63, '120-139': 57.33, '140-159': 23.6, 'old': 81.9, 'new': 23.6}
2024-09-05 06:34:31,933 [trainer.py] => NME: {'total': 87.41, '00-19': 87.04, '20-39': 88.89, '40-59': 87.16, '60-79': 85.43, '80-99': 91.45, '100-119': 87.28, '120-139': 84.0, '140-159': 87.6, 'old': 87.39, 'new': 87.6}
2024-09-05 06:34:31,933 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48, 76.17, 76.6, 78.25, 76.42, 74.19]
2024-09-05 06:34:31,933 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 97.71, 97.64, 97.1, 97.07, 95.72]
2024-09-05 06:34:31,933 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05, 91.29, 90.66, 89.12, 88.36, 87.41]
2024-09-05 06:34:31,933 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.24, 98.91, 98.94, 98.6, 98.52]

Average Accuracy (CNN): 81.66
Average Accuracy (NME): 92.1
2024-09-05 06:34:31,933 [trainer.py] => Average Accuracy (CNN): 81.66
2024-09-05 06:34:31,933 [trainer.py] => Average Accuracy (NME): 92.1
2024-09-05 06:34:31,934 [trainer.py] => All params: 172073932
2024-09-05 06:34:31,935 [trainer.py] => Trainable params: 86167616
2024-09-05 06:34:33,529 [foster.py] => Learning on 160-180
2024-09-05 06:34:33,531 [foster.py] => All params: 172135432
2024-09-05 06:34:33,532 [foster.py] => Trainable params: 86213736
2024-09-05 06:34:33,581 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 6.873, Loss_clf 1.229, Loss_fe 3.795, Loss_kd 1.644, Train_accy 67.10, Test_accy 75.23:   0%|          | 0/20 [00:54<?, ?it/s]
Task 8, Epoch 1/20 => Loss 6.873, Loss_clf 1.229, Loss_fe 3.795, Loss_kd 1.644, Train_accy 67.10, Test_accy 75.23:   5%|▌         | 1/20 [00:54<17:13, 54.38s/it]
Task 8, Epoch 2/20 => Loss 4.026, Loss_clf 0.806, Loss_fe 1.356, Loss_kd 1.657, Train_accy 68.90:   5%|▌         | 1/20 [01:37<17:13, 54.38s/it]                 
Task 8, Epoch 2/20 => Loss 4.026, Loss_clf 0.806, Loss_fe 1.356, Loss_kd 1.657, Train_accy 68.90:  10%|█         | 2/20 [01:37<14:14, 47.47s/it]
Task 8, Epoch 3/20 => Loss 3.399, Loss_clf 0.641, Loss_fe 0.943, Loss_kd 1.613, Train_accy 70.61:  10%|█         | 2/20 [02:19<14:14, 47.47s/it]
Task 8, Epoch 3/20 => Loss 3.399, Loss_clf 0.641, Loss_fe 0.943, Loss_kd 1.613, Train_accy 70.61:  15%|█▌        | 3/20 [02:19<12:50, 45.33s/it]
Task 8, Epoch 4/20 => Loss 3.302, Loss_clf 0.636, Loss_fe 0.820, Loss_kd 1.641, Train_accy 71.74:  15%|█▌        | 3/20 [03:02<12:50, 45.33s/it]
Task 8, Epoch 4/20 => Loss 3.302, Loss_clf 0.636, Loss_fe 0.820, Loss_kd 1.641, Train_accy 71.74:  20%|██        | 4/20 [03:02<11:49, 44.36s/it]
Task 8, Epoch 5/20 => Loss 3.185, Loss_clf 0.611, Loss_fe 0.724, Loss_kd 1.644, Train_accy 71.79:  20%|██        | 4/20 [03:45<11:49, 44.36s/it]
Task 8, Epoch 5/20 => Loss 3.185, Loss_clf 0.611, Loss_fe 0.724, Loss_kd 1.644, Train_accy 71.79:  25%|██▌       | 5/20 [03:45<10:57, 43.82s/it]
Task 8, Epoch 6/20 => Loss 2.986, Loss_clf 0.543, Loss_fe 0.626, Loss_kd 1.616, Train_accy 73.02, Test_accy 76.32:  25%|██▌       | 5/20 [04:40<10:57, 43.82s/it]
Task 8, Epoch 6/20 => Loss 2.986, Loss_clf 0.543, Loss_fe 0.626, Loss_kd 1.616, Train_accy 73.02, Test_accy 76.32:  30%|███       | 6/20 [04:40<11:08, 47.74s/it]
Task 8, Epoch 7/20 => Loss 2.989, Loss_clf 0.555, Loss_fe 0.598, Loss_kd 1.632, Train_accy 73.50:  30%|███       | 6/20 [05:23<11:08, 47.74s/it]                 
Task 8, Epoch 7/20 => Loss 2.989, Loss_clf 0.555, Loss_fe 0.598, Loss_kd 1.632, Train_accy 73.50:  35%|███▌      | 7/20 [05:23<10:00, 46.17s/it]
Task 8, Epoch 8/20 => Loss 2.952, Loss_clf 0.541, Loss_fe 0.561, Loss_kd 1.644, Train_accy 73.83:  35%|███▌      | 7/20 [06:06<10:00, 46.17s/it]
Task 8, Epoch 8/20 => Loss 2.952, Loss_clf 0.541, Loss_fe 0.561, Loss_kd 1.644, Train_accy 73.83:  40%|████      | 8/20 [06:06<09:01, 45.13s/it]
Task 8, Epoch 9/20 => Loss 2.815, Loss_clf 0.504, Loss_fe 0.501, Loss_kd 1.609, Train_accy 75.28:  40%|████      | 8/20 [06:49<09:01, 45.13s/it]
Task 8, Epoch 9/20 => Loss 2.815, Loss_clf 0.504, Loss_fe 0.501, Loss_kd 1.609, Train_accy 75.28:  45%|████▌     | 9/20 [06:49<08:09, 44.46s/it]
Task 8, Epoch 10/20 => Loss 2.782, Loss_clf 0.487, Loss_fe 0.477, Loss_kd 1.616, Train_accy 75.23:  45%|████▌     | 9/20 [07:32<08:09, 44.46s/it]
Task 8, Epoch 10/20 => Loss 2.782, Loss_clf 0.487, Loss_fe 0.477, Loss_kd 1.616, Train_accy 75.23:  50%|█████     | 10/20 [07:32<07:19, 43.98s/it]
Task 8, Epoch 11/20 => Loss 2.790, Loss_clf 0.488, Loss_fe 0.469, Loss_kd 1.628, Train_accy 74.51, Test_accy 76.46:  50%|█████     | 10/20 [08:27<07:19, 43.98s/it]
Task 8, Epoch 11/20 => Loss 2.790, Loss_clf 0.488, Loss_fe 0.469, Loss_kd 1.628, Train_accy 74.51, Test_accy 76.46:  55%|█████▌    | 11/20 [08:27<07:06, 47.43s/it]
Task 8, Epoch 12/20 => Loss 2.796, Loss_clf 0.495, Loss_fe 0.449, Loss_kd 1.646, Train_accy 75.01:  55%|█████▌    | 11/20 [09:10<07:06, 47.43s/it]                 
Task 8, Epoch 12/20 => Loss 2.796, Loss_clf 0.495, Loss_fe 0.449, Loss_kd 1.646, Train_accy 75.01:  60%|██████    | 12/20 [09:10<06:08, 46.05s/it]
Task 8, Epoch 13/20 => Loss 2.712, Loss_clf 0.452, Loss_fe 0.415, Loss_kd 1.640, Train_accy 74.80:  60%|██████    | 12/20 [09:53<06:08, 46.05s/it]
Task 8, Epoch 13/20 => Loss 2.712, Loss_clf 0.452, Loss_fe 0.415, Loss_kd 1.640, Train_accy 74.80:  65%|██████▌   | 13/20 [09:53<05:15, 45.10s/it]
Task 8, Epoch 14/20 => Loss 2.761, Loss_clf 0.486, Loss_fe 0.414, Loss_kd 1.654, Train_accy 74.68:  65%|██████▌   | 13/20 [10:36<05:15, 45.10s/it]
Task 8, Epoch 14/20 => Loss 2.761, Loss_clf 0.486, Loss_fe 0.414, Loss_kd 1.654, Train_accy 74.68:  70%|███████   | 14/20 [10:36<04:26, 44.45s/it]
Task 8, Epoch 15/20 => Loss 2.589, Loss_clf 0.412, Loss_fe 0.351, Loss_kd 1.623, Train_accy 76.12:  70%|███████   | 14/20 [11:19<04:26, 44.45s/it]
Task 8, Epoch 15/20 => Loss 2.589, Loss_clf 0.412, Loss_fe 0.351, Loss_kd 1.623, Train_accy 76.12:  75%|███████▌  | 15/20 [11:19<03:39, 43.99s/it]
Task 8, Epoch 16/20 => Loss 2.620, Loss_clf 0.438, Loss_fe 0.370, Loss_kd 1.611, Train_accy 75.88, Test_accy 76.08:  75%|███████▌  | 15/20 [12:14<03:39, 43.99s/it]
Task 8, Epoch 16/20 => Loss 2.620, Loss_clf 0.438, Loss_fe 0.370, Loss_kd 1.611, Train_accy 75.88, Test_accy 76.08:  80%|████████  | 16/20 [12:14<03:09, 47.37s/it]
Task 8, Epoch 17/20 => Loss 2.549, Loss_clf 0.408, Loss_fe 0.336, Loss_kd 1.605, Train_accy 76.58:  80%|████████  | 16/20 [12:57<03:09, 47.37s/it]                 
Task 8, Epoch 17/20 => Loss 2.549, Loss_clf 0.408, Loss_fe 0.336, Loss_kd 1.605, Train_accy 76.58:  85%|████████▌ | 17/20 [12:57<02:18, 46.02s/it]
Task 8, Epoch 18/20 => Loss 2.562, Loss_clf 0.395, Loss_fe 0.332, Loss_kd 1.632, Train_accy 77.25:  85%|████████▌ | 17/20 [13:40<02:18, 46.02s/it]
Task 8, Epoch 18/20 => Loss 2.562, Loss_clf 0.395, Loss_fe 0.332, Loss_kd 1.632, Train_accy 77.25:  90%|█████████ | 18/20 [13:40<01:30, 45.08s/it]
Task 8, Epoch 19/20 => Loss 2.503, Loss_clf 0.392, Loss_fe 0.316, Loss_kd 1.596, Train_accy 76.60:  90%|█████████ | 18/20 [14:23<01:30, 45.08s/it]
Task 8, Epoch 19/20 => Loss 2.503, Loss_clf 0.392, Loss_fe 0.316, Loss_kd 1.596, Train_accy 76.60:  95%|█████████▌| 19/20 [14:23<00:44, 44.41s/it]
Task 8, Epoch 20/20 => Loss 2.519, Loss_clf 0.388, Loss_fe 0.323, Loss_kd 1.607, Train_accy 76.48:  95%|█████████▌| 19/20 [15:06<00:44, 44.41s/it]
Task 8, Epoch 20/20 => Loss 2.519, Loss_clf 0.388, Loss_fe 0.323, Loss_kd 1.607, Train_accy 76.48: 100%|██████████| 20/20 [15:06<00:00, 43.97s/it]
Task 8, Epoch 20/20 => Loss 2.519, Loss_clf 0.388, Loss_fe 0.323, Loss_kd 1.607, Train_accy 76.48: 100%|██████████| 20/20 [15:06<00:00, 45.32s/it]
2024-09-05 06:49:39,901 [foster.py] => Task 8, Epoch 20/20 => Loss 2.519, Loss_clf 0.388, Loss_fe 0.323, Loss_kd 1.607, Train_accy 76.48
2024-09-05 06:49:39,902 [foster.py] => do not weight align teacher!
2024-09-05 06:49:39,907 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.742,  Train_accy 67.22, Test_accy 75.05:   0%|          | 0/20 [01:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.742,  Train_accy 67.22, Test_accy 75.05:   5%|▌         | 1/20 [01:00<19:10, 60.54s/it]
SNet: Task 8, Epoch 2/20 => Loss 1.709,  Train_accy 68.93:   5%|▌         | 1/20 [01:54<19:10, 60.54s/it]                 
SNet: Task 8, Epoch 2/20 => Loss 1.709,  Train_accy 68.93:  10%|█         | 2/20 [01:54<16:59, 56.62s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.676,  Train_accy 70.97:  10%|█         | 2/20 [02:48<16:59, 56.62s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.676,  Train_accy 70.97:  15%|█▌        | 3/20 [02:48<15:41, 55.39s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.657,  Train_accy 71.21:  15%|█▌        | 3/20 [03:42<15:41, 55.39s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.657,  Train_accy 71.21:  20%|██        | 4/20 [03:42<14:37, 54.83s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.653,  Train_accy 71.62:  20%|██        | 4/20 [04:36<14:37, 54.83s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.653,  Train_accy 71.62:  25%|██▌       | 5/20 [04:36<13:37, 54.52s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.655,  Train_accy 71.62, Test_accy 76.13:  25%|██▌       | 5/20 [05:36<13:37, 54.52s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.655,  Train_accy 71.62, Test_accy 76.13:  30%|███       | 6/20 [05:36<13:12, 56.58s/it]
SNet: Task 8, Epoch 7/20 => Loss 1.673,  Train_accy 71.16:  30%|███       | 6/20 [06:30<13:12, 56.58s/it]                 
SNet: Task 8, Epoch 7/20 => Loss 1.673,  Train_accy 71.16:  35%|███▌      | 7/20 [06:30<12:04, 55.72s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.647,  Train_accy 71.48:  35%|███▌      | 7/20 [07:24<12:04, 55.72s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.647,  Train_accy 71.48:  40%|████      | 8/20 [07:24<11:01, 55.15s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.658,  Train_accy 71.91:  40%|████      | 8/20 [08:18<11:01, 55.15s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.658,  Train_accy 71.91:  45%|████▌     | 9/20 [08:18<10:02, 54.77s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.639,  Train_accy 71.72:  45%|████▌     | 9/20 [09:12<10:02, 54.77s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.639,  Train_accy 71.72:  50%|█████     | 10/20 [09:12<09:05, 54.52s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.614,  Train_accy 72.58, Test_accy 76.27:  50%|█████     | 10/20 [10:13<09:05, 54.52s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.614,  Train_accy 72.58, Test_accy 76.27:  55%|█████▌    | 11/20 [10:13<08:27, 56.39s/it]
SNet: Task 8, Epoch 12/20 => Loss 1.666,  Train_accy 71.24:  55%|█████▌    | 11/20 [11:07<08:27, 56.39s/it]                 
SNet: Task 8, Epoch 12/20 => Loss 1.666,  Train_accy 71.24:  60%|██████    | 12/20 [11:07<07:25, 55.63s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.663,  Train_accy 71.52:  60%|██████    | 12/20 [12:01<07:25, 55.63s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.663,  Train_accy 71.52:  65%|██████▌   | 13/20 [12:01<06:25, 55.10s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.665,  Train_accy 71.84:  65%|██████▌   | 13/20 [12:54<06:25, 55.10s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.665,  Train_accy 71.84:  70%|███████   | 14/20 [12:54<05:28, 54.75s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.657,  Train_accy 71.93:  70%|███████   | 14/20 [13:48<05:28, 54.75s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.657,  Train_accy 71.93:  75%|███████▌  | 15/20 [13:48<04:32, 54.48s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.619,  Train_accy 72.46, Test_accy 76.41:  75%|███████▌  | 15/20 [14:49<04:32, 54.48s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.619,  Train_accy 72.46, Test_accy 76.41:  80%|████████  | 16/20 [14:49<03:45, 56.35s/it]
SNet: Task 8, Epoch 17/20 => Loss 1.644,  Train_accy 71.98:  80%|████████  | 16/20 [15:43<03:45, 56.35s/it]                 
SNet: Task 8, Epoch 17/20 => Loss 1.644,  Train_accy 71.98:  85%|████████▌ | 17/20 [15:43<02:46, 55.63s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.627,  Train_accy 72.27:  85%|████████▌ | 17/20 [16:37<02:46, 55.63s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.627,  Train_accy 72.27:  90%|█████████ | 18/20 [16:37<01:50, 55.10s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.682,  Train_accy 71.33:  90%|█████████ | 18/20 [17:31<01:50, 55.10s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.682,  Train_accy 71.33:  95%|█████████▌| 19/20 [17:31<00:54, 54.76s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.652,  Train_accy 72.51:  95%|█████████▌| 19/20 [18:25<00:54, 54.76s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.652,  Train_accy 72.51: 100%|██████████| 20/20 [18:25<00:00, 54.51s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.652,  Train_accy 72.51: 100%|██████████| 20/20 [18:25<00:00, 55.26s/it]
2024-09-05 07:08:06,657 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.652,  Train_accy 72.51
2024-09-05 07:08:06,658 [foster.py] => do not weight align student!
2024-09-05 07:08:13,323 [foster.py] => darknet eval: 
2024-09-05 07:08:13,323 [foster.py] => CNN top1 curve: 76.27
2024-09-05 07:08:13,323 [foster.py] => CNN top5 curve: 95.44
2024-09-05 07:08:13,326 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 07:10:11,709 [foster.py] => Exemplar size: 3600
2024-09-05 07:10:11,709 [trainer.py] => CNN: {'total': 76.27, '00-19': 89.47, '20-39': 87.92, '40-59': 88.99, '60-79': 83.4, '80-99': 86.99, '100-119': 82.46, '120-139': 72.0, '140-159': 61.2, '160-179': 35.02, 'old': 81.44, 'new': 35.02}
2024-09-05 07:10:11,709 [trainer.py] => NME: {'total': 87.59, '00-19': 87.85, '20-39': 89.37, '40-59': 88.53, '60-79': 85.83, '80-99': 88.85, '100-119': 86.4, '120-139': 85.78, '140-159': 87.2, '160-179': 88.61, 'old': 87.47, 'new': 88.61}
2024-09-05 07:10:11,709 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48, 76.17, 76.6, 78.25, 76.42, 74.19, 76.27]
2024-09-05 07:10:11,709 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 97.71, 97.64, 97.1, 97.07, 95.72, 95.86]
2024-09-05 07:10:11,709 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05, 91.29, 90.66, 89.12, 88.36, 87.41, 87.59]
2024-09-05 07:10:11,709 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.24, 98.91, 98.94, 98.6, 98.52, 98.17]

Average Accuracy (CNN): 81.06
Average Accuracy (NME): 91.6
2024-09-05 07:10:11,709 [trainer.py] => Average Accuracy (CNN): 81.06
2024-09-05 07:10:11,709 [trainer.py] => Average Accuracy (NME): 91.6
2024-09-05 07:10:11,710 [trainer.py] => All params: 172135432
2024-09-05 07:10:11,711 [trainer.py] => Trainable params: 86213736
2024-09-05 07:10:13,218 [foster.py] => Learning on 180-200
2024-09-05 07:10:13,220 [foster.py] => All params: 172196932
2024-09-05 07:10:13,221 [foster.py] => Trainable params: 86259856
2024-09-05 07:10:13,271 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 6.810, Loss_clf 1.214, Loss_fe 3.795, Loss_kd 1.622, Train_accy 67.53, Test_accy 75.57:   0%|          | 0/20 [00:59<?, ?it/s]
Task 9, Epoch 1/20 => Loss 6.810, Loss_clf 1.214, Loss_fe 3.795, Loss_kd 1.622, Train_accy 67.53, Test_accy 75.57:   5%|▌         | 1/20 [00:59<18:51, 59.54s/it]
Task 9, Epoch 2/20 => Loss 3.986, Loss_clf 0.799, Loss_fe 1.390, Loss_kd 1.618, Train_accy 69.66:   5%|▌         | 1/20 [01:46<18:51, 59.54s/it]                 
Task 9, Epoch 2/20 => Loss 3.986, Loss_clf 0.799, Loss_fe 1.390, Loss_kd 1.618, Train_accy 69.66:  10%|█         | 2/20 [01:46<15:33, 51.87s/it]
Task 9, Epoch 3/20 => Loss 3.591, Loss_clf 0.721, Loss_fe 1.057, Loss_kd 1.632, Train_accy 70.61:  10%|█         | 2/20 [02:32<15:33, 51.87s/it]
Task 9, Epoch 3/20 => Loss 3.591, Loss_clf 0.721, Loss_fe 1.057, Loss_kd 1.632, Train_accy 70.61:  15%|█▌        | 3/20 [02:32<14:01, 49.51s/it]
Task 9, Epoch 4/20 => Loss 3.255, Loss_clf 0.644, Loss_fe 0.847, Loss_kd 1.587, Train_accy 72.63:  15%|█▌        | 3/20 [03:19<14:01, 49.51s/it]
Task 9, Epoch 4/20 => Loss 3.255, Loss_clf 0.644, Loss_fe 0.847, Loss_kd 1.587, Train_accy 72.63:  20%|██        | 4/20 [03:19<12:54, 48.43s/it]
Task 9, Epoch 5/20 => Loss 3.116, Loss_clf 0.611, Loss_fe 0.741, Loss_kd 1.588, Train_accy 73.35:  20%|██        | 4/20 [04:06<12:54, 48.43s/it]
Task 9, Epoch 5/20 => Loss 3.116, Loss_clf 0.611, Loss_fe 0.741, Loss_kd 1.588, Train_accy 73.35:  25%|██▌       | 5/20 [04:06<11:57, 47.86s/it]
Task 9, Epoch 6/20 => Loss 2.936, Loss_clf 0.559, Loss_fe 0.630, Loss_kd 1.572, Train_accy 73.44, Test_accy 77.48:  25%|██▌       | 5/20 [05:06<11:57, 47.86s/it]
Task 9, Epoch 6/20 => Loss 2.936, Loss_clf 0.559, Loss_fe 0.630, Loss_kd 1.572, Train_accy 73.44, Test_accy 77.48:  30%|███       | 6/20 [05:06<12:10, 52.19s/it]
Task 9, Epoch 7/20 => Loss 3.085, Loss_clf 0.606, Loss_fe 0.667, Loss_kd 1.632, Train_accy 72.69:  30%|███       | 6/20 [05:53<12:10, 52.19s/it]                 
Task 9, Epoch 7/20 => Loss 3.085, Loss_clf 0.606, Loss_fe 0.667, Loss_kd 1.632, Train_accy 72.69:  35%|███▌      | 7/20 [05:53<10:55, 50.44s/it]
Task 9, Epoch 8/20 => Loss 2.879, Loss_clf 0.526, Loss_fe 0.578, Loss_kd 1.597, Train_accy 73.73:  35%|███▌      | 7/20 [06:40<10:55, 50.44s/it]
Task 9, Epoch 8/20 => Loss 2.879, Loss_clf 0.526, Loss_fe 0.578, Loss_kd 1.597, Train_accy 73.73:  40%|████      | 8/20 [06:40<09:51, 49.32s/it]
Task 9, Epoch 9/20 => Loss 2.846, Loss_clf 0.526, Loss_fe 0.540, Loss_kd 1.602, Train_accy 73.97:  40%|████      | 8/20 [07:27<09:51, 49.32s/it]
Task 9, Epoch 9/20 => Loss 2.846, Loss_clf 0.526, Loss_fe 0.540, Loss_kd 1.602, Train_accy 73.97:  45%|████▌     | 9/20 [07:27<08:54, 48.57s/it]
Task 9, Epoch 10/20 => Loss 2.856, Loss_clf 0.526, Loss_fe 0.525, Loss_kd 1.624, Train_accy 73.84:  45%|████▌     | 9/20 [08:14<08:54, 48.57s/it]
Task 9, Epoch 10/20 => Loss 2.856, Loss_clf 0.526, Loss_fe 0.525, Loss_kd 1.624, Train_accy 73.84:  50%|█████     | 10/20 [08:14<08:00, 48.05s/it]
Task 9, Epoch 11/20 => Loss 2.774, Loss_clf 0.507, Loss_fe 0.481, Loss_kd 1.607, Train_accy 74.34, Test_accy 77.78:  50%|█████     | 10/20 [09:15<08:00, 48.05s/it]
Task 9, Epoch 11/20 => Loss 2.774, Loss_clf 0.507, Loss_fe 0.481, Loss_kd 1.607, Train_accy 74.34, Test_accy 77.78:  55%|█████▌    | 11/20 [09:15<07:47, 51.91s/it]
Task 9, Epoch 12/20 => Loss 2.747, Loss_clf 0.496, Loss_fe 0.470, Loss_kd 1.603, Train_accy 74.52:  55%|█████▌    | 11/20 [10:02<07:47, 51.91s/it]                 
Task 9, Epoch 12/20 => Loss 2.747, Loss_clf 0.496, Loss_fe 0.470, Loss_kd 1.603, Train_accy 74.52:  60%|██████    | 12/20 [10:02<06:43, 50.39s/it]
Task 9, Epoch 13/20 => Loss 2.627, Loss_clf 0.451, Loss_fe 0.411, Loss_kd 1.589, Train_accy 75.18:  60%|██████    | 12/20 [10:48<06:43, 50.39s/it]
Task 9, Epoch 13/20 => Loss 2.627, Loss_clf 0.451, Loss_fe 0.411, Loss_kd 1.589, Train_accy 75.18:  65%|██████▌   | 13/20 [10:48<05:45, 49.33s/it]
Task 9, Epoch 14/20 => Loss 2.601, Loss_clf 0.444, Loss_fe 0.401, Loss_kd 1.581, Train_accy 74.38:  65%|██████▌   | 13/20 [11:35<05:45, 49.33s/it]
Task 9, Epoch 14/20 => Loss 2.601, Loss_clf 0.444, Loss_fe 0.401, Loss_kd 1.581, Train_accy 74.38:  70%|███████   | 14/20 [11:35<04:51, 48.60s/it]
Task 9, Epoch 15/20 => Loss 2.635, Loss_clf 0.458, Loss_fe 0.392, Loss_kd 1.607, Train_accy 74.89:  70%|███████   | 14/20 [12:22<04:51, 48.60s/it]
Task 9, Epoch 15/20 => Loss 2.635, Loss_clf 0.458, Loss_fe 0.392, Loss_kd 1.607, Train_accy 74.89:  75%|███████▌  | 15/20 [12:22<04:00, 48.09s/it]
Task 9, Epoch 16/20 => Loss 2.646, Loss_clf 0.456, Loss_fe 0.397, Loss_kd 1.614, Train_accy 75.26, Test_accy 77.48:  75%|███████▌  | 15/20 [13:23<04:00, 48.09s/it]
Task 9, Epoch 16/20 => Loss 2.646, Loss_clf 0.456, Loss_fe 0.397, Loss_kd 1.614, Train_accy 75.26, Test_accy 77.48:  80%|████████  | 16/20 [13:23<03:27, 51.85s/it]
Task 9, Epoch 17/20 => Loss 2.506, Loss_clf 0.416, Loss_fe 0.341, Loss_kd 1.574, Train_accy 75.35:  80%|████████  | 16/20 [14:10<03:27, 51.85s/it]                 
Task 9, Epoch 17/20 => Loss 2.506, Loss_clf 0.416, Loss_fe 0.341, Loss_kd 1.574, Train_accy 75.35:  85%|████████▌ | 17/20 [14:10<02:31, 50.37s/it]
Task 9, Epoch 18/20 => Loss 2.599, Loss_clf 0.434, Loss_fe 0.377, Loss_kd 1.610, Train_accy 75.75:  85%|████████▌ | 17/20 [14:57<02:31, 50.37s/it]
Task 9, Epoch 18/20 => Loss 2.599, Loss_clf 0.434, Loss_fe 0.377, Loss_kd 1.610, Train_accy 75.75:  90%|█████████ | 18/20 [14:57<01:38, 49.34s/it]
Task 9, Epoch 19/20 => Loss 2.614, Loss_clf 0.460, Loss_fe 0.376, Loss_kd 1.601, Train_accy 75.33:  90%|█████████ | 18/20 [15:44<01:38, 49.34s/it]
Task 9, Epoch 19/20 => Loss 2.614, Loss_clf 0.460, Loss_fe 0.376, Loss_kd 1.601, Train_accy 75.33:  95%|█████████▌| 19/20 [15:44<00:48, 48.61s/it]
Task 9, Epoch 20/20 => Loss 2.518, Loss_clf 0.416, Loss_fe 0.350, Loss_kd 1.577, Train_accy 76.25:  95%|█████████▌| 19/20 [16:31<00:48, 48.61s/it]
Task 9, Epoch 20/20 => Loss 2.518, Loss_clf 0.416, Loss_fe 0.350, Loss_kd 1.577, Train_accy 76.25: 100%|██████████| 20/20 [16:31<00:00, 48.09s/it]
Task 9, Epoch 20/20 => Loss 2.518, Loss_clf 0.416, Loss_fe 0.350, Loss_kd 1.577, Train_accy 76.25: 100%|██████████| 20/20 [16:31<00:00, 49.55s/it]
2024-09-05 07:26:44,320 [foster.py] => Task 9, Epoch 20/20 => Loss 2.518, Loss_clf 0.416, Loss_fe 0.350, Loss_kd 1.577, Train_accy 76.25
2024-09-05 07:26:44,320 [foster.py] => do not weight align teacher!
2024-09-05 07:26:44,322 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.672,  Train_accy 68.61, Test_accy 75.74:   0%|          | 0/20 [01:06<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.672,  Train_accy 68.61, Test_accy 75.74:   5%|▌         | 1/20 [01:06<20:58, 66.24s/it]
SNet: Task 9, Epoch 2/20 => Loss 1.628,  Train_accy 70.28:   5%|▌         | 1/20 [02:05<20:58, 66.24s/it]                 
SNet: Task 9, Epoch 2/20 => Loss 1.628,  Train_accy 70.28:  10%|█         | 2/20 [02:05<18:35, 61.95s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.627,  Train_accy 70.83:  10%|█         | 2/20 [03:04<18:35, 61.95s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.627,  Train_accy 70.83:  15%|█▌        | 3/20 [03:04<17:09, 60.57s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.638,  Train_accy 71.18:  15%|█▌        | 3/20 [04:03<17:09, 60.57s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.638,  Train_accy 71.18:  20%|██        | 4/20 [04:03<15:58, 59.93s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.619,  Train_accy 70.85:  20%|██        | 4/20 [05:02<15:58, 59.93s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.619,  Train_accy 70.85:  25%|██▌       | 5/20 [05:02<14:53, 59.57s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.615,  Train_accy 71.09, Test_accy 76.93:  25%|██▌       | 5/20 [06:08<14:53, 59.57s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.615,  Train_accy 71.09, Test_accy 76.93:  30%|███       | 6/20 [06:08<14:25, 61.86s/it]
SNet: Task 9, Epoch 7/20 => Loss 1.603,  Train_accy 72.06:  30%|███       | 6/20 [07:07<14:25, 61.86s/it]                 
SNet: Task 9, Epoch 7/20 => Loss 1.603,  Train_accy 72.06:  35%|███▌      | 7/20 [07:07<13:11, 60.91s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.598,  Train_accy 72.12:  35%|███▌      | 7/20 [08:06<13:11, 60.91s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.598,  Train_accy 72.12:  40%|████      | 8/20 [08:06<12:03, 60.29s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.594,  Train_accy 72.10:  40%|████      | 8/20 [09:05<12:03, 60.29s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.594,  Train_accy 72.10:  45%|████▌     | 9/20 [09:05<10:58, 59.86s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.595,  Train_accy 72.19:  45%|████▌     | 9/20 [10:04<10:58, 59.86s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.595,  Train_accy 72.19:  50%|█████     | 10/20 [10:04<09:55, 59.57s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.590,  Train_accy 71.51, Test_accy 77.01:  50%|█████     | 10/20 [11:10<09:55, 59.57s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.590,  Train_accy 71.51, Test_accy 77.01:  55%|█████▌    | 11/20 [11:10<09:14, 61.61s/it]
SNet: Task 9, Epoch 12/20 => Loss 1.583,  Train_accy 72.65:  55%|█████▌    | 11/20 [12:09<09:14, 61.61s/it]                 
SNet: Task 9, Epoch 12/20 => Loss 1.583,  Train_accy 72.65:  60%|██████    | 12/20 [12:09<08:06, 60.80s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.592,  Train_accy 72.45:  60%|██████    | 12/20 [13:08<08:06, 60.80s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.592,  Train_accy 72.45:  65%|██████▌   | 13/20 [13:08<07:01, 60.21s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.583,  Train_accy 73.04:  65%|██████▌   | 13/20 [14:07<07:01, 60.21s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.583,  Train_accy 73.04:  70%|███████   | 14/20 [14:07<05:58, 59.82s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.584,  Train_accy 72.03:  70%|███████   | 14/20 [15:05<05:58, 59.82s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.584,  Train_accy 72.03:  75%|███████▌  | 15/20 [15:05<04:57, 59.55s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.609,  Train_accy 72.58, Test_accy 76.55:  75%|███████▌  | 15/20 [16:12<04:57, 59.55s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.609,  Train_accy 72.58, Test_accy 76.55:  80%|████████  | 16/20 [16:12<04:06, 61.57s/it]
SNet: Task 9, Epoch 17/20 => Loss 1.598,  Train_accy 72.36:  80%|████████  | 16/20 [17:11<04:06, 61.57s/it]                 
SNet: Task 9, Epoch 17/20 => Loss 1.598,  Train_accy 72.36:  85%|████████▌ | 17/20 [17:11<03:02, 60.77s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.595,  Train_accy 72.78:  85%|████████▌ | 17/20 [18:10<03:02, 60.77s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.595,  Train_accy 72.78:  90%|█████████ | 18/20 [18:10<02:00, 60.22s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.568,  Train_accy 72.72:  90%|█████████ | 18/20 [19:08<02:00, 60.22s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.568,  Train_accy 72.72:  95%|█████████▌| 19/20 [19:08<00:59, 59.82s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.590,  Train_accy 72.72:  95%|█████████▌| 19/20 [20:07<00:59, 59.82s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.590,  Train_accy 72.72: 100%|██████████| 20/20 [20:07<00:00, 59.56s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.590,  Train_accy 72.72: 100%|██████████| 20/20 [20:07<00:00, 60.39s/it]
2024-09-05 07:46:53,697 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 1.590,  Train_accy 72.72
2024-09-05 07:46:53,698 [foster.py] => do not weight align student!
2024-09-05 07:47:01,043 [foster.py] => darknet eval: 
2024-09-05 07:47:01,043 [foster.py] => CNN top1 curve: 76.72
2024-09-05 07:47:01,043 [foster.py] => CNN top5 curve: 94.91
2024-09-05 07:47:01,045 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 07:49:10,948 [foster.py] => Exemplar size: 4000
2024-09-05 07:49:10,948 [trainer.py] => CNN: {'total': 77.44, '00-19': 90.69, '20-39': 87.44, '40-59': 88.99, '60-79': 84.62, '80-99': 87.73, '100-119': 83.33, '120-139': 76.44, '140-159': 78.0, '160-179': 71.31, '180-199': 24.35, 'old': 83.18, 'new': 24.35}
2024-09-05 07:49:10,948 [trainer.py] => NME: {'total': 86.17, '00-19': 87.85, '20-39': 87.92, '40-59': 87.61, '60-79': 83.0, '80-99': 91.45, '100-119': 85.09, '120-139': 81.33, '140-159': 86.8, '160-179': 86.08, '180-199': 83.91, 'old': 86.42, 'new': 83.91}
2024-09-05 07:49:10,948 [trainer.py] => CNN top1 curve: [99.19, 88.99, 83.48, 76.17, 76.6, 78.25, 76.42, 74.19, 76.27, 77.44]
2024-09-05 07:49:10,948 [trainer.py] => CNN top5 curve: [100.0, 99.56, 98.66, 97.71, 97.64, 97.1, 97.07, 95.72, 95.86, 95.84]
2024-09-05 07:49:10,948 [trainer.py] => NME top1 curve: [99.19, 96.7, 94.05, 91.29, 90.66, 89.12, 88.36, 87.41, 87.59, 86.17]
2024-09-05 07:49:10,948 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.24, 98.91, 98.94, 98.6, 98.52, 98.17, 97.96]

Average Accuracy (CNN): 80.7
Average Accuracy (NME): 91.05
2024-09-05 07:49:10,948 [trainer.py] => Average Accuracy (CNN): 80.7
2024-09-05 07:49:10,948 [trainer.py] => Average Accuracy (NME): 91.05
Accuracy Matrix (CNN):
[[99.19 98.38 98.79 97.17 95.55 95.55 93.93 89.88 89.47 90.69]
 [ 0.   77.78 85.51 91.3  91.3  88.89 87.92 88.41 87.92 87.44]
 [ 0.    0.   64.22 76.61 83.94 86.24 86.7  88.07 88.99 88.99]
 [ 0.    0.    0.   42.11 68.83 82.19 83.   83.4  83.4  84.62]
 [ 0.    0.    0.    0.   49.07 76.95 84.76 87.36 86.99 87.73]
 [ 0.    0.    0.    0.    0.   39.47 67.98 77.63 82.46 83.33]
 [ 0.    0.    0.    0.    0.    0.   28.   57.33 72.   76.44]
 [ 0.    0.    0.    0.    0.    0.    0.   23.6  61.2  78.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   35.02 71.31]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   24.35]]
2024-09-05 07:49:10,949 [trainer.py] => Forgetting (CNN): 1.3733333333333333
Accuracy Matrix (NME):
[[99.19 97.98 93.52 89.88 89.47 87.04 89.88 87.04 87.85 87.85]
 [ 0.   95.17 94.69 91.79 87.92 89.37 89.86 88.89 89.37 87.92]
 [ 0.    0.   94.04 91.74 91.28 91.74 88.99 87.16 88.53 87.61]
 [ 0.    0.    0.   91.9  89.07 86.23 86.64 85.43 85.83 83.  ]
 [ 0.    0.    0.    0.   94.8  91.82 90.71 91.45 88.85 91.45]
 [ 0.    0.    0.    0.    0.   88.6  87.72 87.28 86.4  85.09]
 [ 0.    0.    0.    0.    0.    0.   84.44 84.   85.78 81.33]
 [ 0.    0.    0.    0.    0.    0.    0.   87.6  87.2  86.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   88.61 86.08]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   83.91]]
2024-09-05 07:49:10,949 [trainer.py] => Forgetting (NME): 5.395555555555556
2024-09-05 07:49:13,830 [trainer.py] => config: ./exps/foster_cub_B0_Inc20.json
2024-09-05 07:49:13,830 [trainer.py] => prefix: cil
2024-09-05 07:49:13,830 [trainer.py] => dataset: cub
2024-09-05 07:49:13,830 [trainer.py] => memory_size: 4000
2024-09-05 07:49:13,830 [trainer.py] => memory_per_class: 20
2024-09-05 07:49:13,830 [trainer.py] => fixed_memory: True
2024-09-05 07:49:13,831 [trainer.py] => shuffle: True
2024-09-05 07:49:13,831 [trainer.py] => init_cls: 10
2024-09-05 07:49:13,831 [trainer.py] => increment: 10
2024-09-05 07:49:13,831 [trainer.py] => model_name: foster
2024-09-05 07:49:13,831 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 07:49:13,831 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 07:49:13,831 [trainer.py] => seed: 1993
2024-09-05 07:49:13,831 [trainer.py] => beta1: 0.96
2024-09-05 07:49:13,831 [trainer.py] => beta2: 0.97
2024-09-05 07:49:13,831 [trainer.py] => oofc: ft
2024-09-05 07:49:13,831 [trainer.py] => is_teacher_wa: False
2024-09-05 07:49:13,831 [trainer.py] => is_student_wa: False
2024-09-05 07:49:13,831 [trainer.py] => lambda_okd: 1
2024-09-05 07:49:13,831 [trainer.py] => wa_value: 1
2024-09-05 07:49:13,831 [trainer.py] => init_epochs: 20
2024-09-05 07:49:13,831 [trainer.py] => init_lr: 0.001
2024-09-05 07:49:13,831 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 07:49:13,831 [trainer.py] => boosting_epochs: 20
2024-09-05 07:49:13,831 [trainer.py] => compression_epochs: 20
2024-09-05 07:49:13,831 [trainer.py] => lr: 0.001
2024-09-05 07:49:13,831 [trainer.py] => batch_size: 48
2024-09-05 07:49:13,831 [trainer.py] => weight_decay: 0.0005
2024-09-05 07:49:13,831 [trainer.py] => num_workers: 8
2024-09-05 07:49:13,831 [trainer.py] => T: 2
2024-09-05 07:49:13,868 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 07:49:14,134 [trainer.py] => All params: 0
2024-09-05 07:49:14,134 [trainer.py] => Trainable params: 0
2024-09-05 07:49:15,655 [foster.py] => Learning on 0-10
2024-09-05 07:49:15,656 [foster.py] => All params: 85814036
2024-09-05 07:49:15,656 [foster.py] => Trainable params: 85814036

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.494, Train_accy 53.65, Test_accy 89.83:   0%|          | 0/20 [00:04<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.494, Train_accy 53.65, Test_accy 89.83:   5%|▌         | 1/20 [00:04<01:33,  4.92s/it]
Task 0, Epoch 2/20 => Loss 0.551, Train_accy 82.05:   5%|▌         | 1/20 [00:08<01:33,  4.92s/it]                 
Task 0, Epoch 2/20 => Loss 0.551, Train_accy 82.05:  10%|█         | 2/20 [00:08<01:17,  4.29s/it]
Task 0, Epoch 3/20 => Loss 0.377, Train_accy 87.27:  10%|█         | 2/20 [00:12<01:17,  4.29s/it]
Task 0, Epoch 3/20 => Loss 0.377, Train_accy 87.27:  15%|█▌        | 3/20 [00:12<01:09,  4.10s/it]
Task 0, Epoch 4/20 => Loss 0.296, Train_accy 89.14:  15%|█▌        | 3/20 [00:16<01:09,  4.10s/it]
Task 0, Epoch 4/20 => Loss 0.296, Train_accy 89.14:  20%|██        | 4/20 [00:16<01:04,  4.00s/it]
Task 0, Epoch 5/20 => Loss 0.236, Train_accy 92.48:  20%|██        | 4/20 [00:20<01:04,  4.00s/it]
Task 0, Epoch 5/20 => Loss 0.236, Train_accy 92.48:  25%|██▌       | 5/20 [00:20<00:59,  3.97s/it]
Task 0, Epoch 6/20 => Loss 0.162, Train_accy 94.57, Test_accy 97.46:  25%|██▌       | 5/20 [00:25<00:59,  3.97s/it]
Task 0, Epoch 6/20 => Loss 0.162, Train_accy 94.57, Test_accy 97.46:  30%|███       | 6/20 [00:25<00:58,  4.21s/it]
Task 0, Epoch 7/20 => Loss 0.213, Train_accy 93.11:  30%|███       | 6/20 [00:28<00:58,  4.21s/it]                 
Task 0, Epoch 7/20 => Loss 0.213, Train_accy 93.11:  35%|███▌      | 7/20 [00:28<00:53,  4.11s/it]
Task 0, Epoch 8/20 => Loss 0.176, Train_accy 93.32:  35%|███▌      | 7/20 [00:32<00:53,  4.11s/it]
Task 0, Epoch 8/20 => Loss 0.176, Train_accy 93.32:  40%|████      | 8/20 [00:32<00:48,  4.06s/it]
Task 0, Epoch 9/20 => Loss 0.203, Train_accy 93.95:  40%|████      | 8/20 [00:36<00:48,  4.06s/it]
Task 0, Epoch 9/20 => Loss 0.203, Train_accy 93.95:  45%|████▌     | 9/20 [00:36<00:44,  4.02s/it]
Task 0, Epoch 10/20 => Loss 0.170, Train_accy 93.53:  45%|████▌     | 9/20 [00:40<00:44,  4.02s/it]
Task 0, Epoch 10/20 => Loss 0.170, Train_accy 93.53:  50%|█████     | 10/20 [00:40<00:39,  4.00s/it]
Task 0, Epoch 11/20 => Loss 0.090, Train_accy 96.24, Test_accy 98.31:  50%|█████     | 10/20 [00:45<00:39,  4.00s/it]
Task 0, Epoch 11/20 => Loss 0.090, Train_accy 96.24, Test_accy 98.31:  55%|█████▌    | 11/20 [00:45<00:37,  4.20s/it]
Task 0, Epoch 12/20 => Loss 0.157, Train_accy 95.62:  55%|█████▌    | 11/20 [00:49<00:37,  4.20s/it]                 
Task 0, Epoch 12/20 => Loss 0.157, Train_accy 95.62:  60%|██████    | 12/20 [00:49<00:32,  4.12s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 94.99:  60%|██████    | 12/20 [00:53<00:32,  4.12s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 94.99:  65%|██████▌   | 13/20 [00:53<00:28,  4.07s/it]
Task 0, Epoch 14/20 => Loss 0.090, Train_accy 96.66:  65%|██████▌   | 13/20 [00:57<00:28,  4.07s/it]
Task 0, Epoch 14/20 => Loss 0.090, Train_accy 96.66:  70%|███████   | 14/20 [00:57<00:24,  4.01s/it]
Task 0, Epoch 15/20 => Loss 0.107, Train_accy 95.82:  70%|███████   | 14/20 [01:01<00:24,  4.01s/it]
Task 0, Epoch 15/20 => Loss 0.107, Train_accy 95.82:  75%|███████▌  | 15/20 [01:01<00:19,  3.98s/it]
Task 0, Epoch 16/20 => Loss 0.129, Train_accy 96.24, Test_accy 99.15:  75%|███████▌  | 15/20 [01:05<00:19,  3.98s/it]
Task 0, Epoch 16/20 => Loss 0.129, Train_accy 96.24, Test_accy 99.15:  80%|████████  | 16/20 [01:05<00:16,  4.18s/it]
Task 0, Epoch 17/20 => Loss 0.088, Train_accy 96.66:  80%|████████  | 16/20 [01:09<00:16,  4.18s/it]                 
Task 0, Epoch 17/20 => Loss 0.088, Train_accy 96.66:  85%|████████▌ | 17/20 [01:09<00:12,  4.10s/it]
Task 0, Epoch 18/20 => Loss 0.075, Train_accy 97.29:  85%|████████▌ | 17/20 [01:13<00:12,  4.10s/it]
Task 0, Epoch 18/20 => Loss 0.075, Train_accy 97.29:  90%|█████████ | 18/20 [01:13<00:08,  4.06s/it]
Task 0, Epoch 19/20 => Loss 0.073, Train_accy 97.70:  90%|█████████ | 18/20 [01:17<00:08,  4.06s/it]
Task 0, Epoch 19/20 => Loss 0.073, Train_accy 97.70:  95%|█████████▌| 19/20 [01:17<00:04,  4.03s/it]
Task 0, Epoch 20/20 => Loss 0.073, Train_accy 97.08:  95%|█████████▌| 19/20 [01:21<00:04,  4.03s/it]
Task 0, Epoch 20/20 => Loss 0.073, Train_accy 97.08: 100%|██████████| 20/20 [01:21<00:00,  4.02s/it]
Task 0, Epoch 20/20 => Loss 0.073, Train_accy 97.08: 100%|██████████| 20/20 [01:21<00:00,  4.08s/it]
2024-09-05 07:50:37,749 [foster.py] => Task 0, Epoch 20/20 => Loss 0.073, Train_accy 97.08
2024-09-05 07:50:37,751 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 07:50:47,318 [foster.py] => Exemplar size: 200
2024-09-05 07:50:47,319 [trainer.py] => CNN: {'total': 99.15, '00-09': 99.15, 'old': 0, 'new': 99.15}
2024-09-05 07:50:47,319 [trainer.py] => NME: {'total': 99.15, '00-09': 99.15, 'old': 0, 'new': 99.15}
2024-09-05 07:50:47,319 [trainer.py] => CNN top1 curve: [99.15]
2024-09-05 07:50:47,319 [trainer.py] => CNN top5 curve: [100.0]
2024-09-05 07:50:47,319 [trainer.py] => NME top1 curve: [99.15]
2024-09-05 07:50:47,320 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.15
Average Accuracy (NME): 99.15
2024-09-05 07:50:47,320 [trainer.py] => Average Accuracy (CNN): 99.15
2024-09-05 07:50:47,320 [trainer.py] => Average Accuracy (NME): 99.15
2024-09-05 07:50:47,322 [trainer.py] => All params: 85814036
2024-09-05 07:50:47,323 [trainer.py] => Trainable params: 85814036
2024-09-05 07:50:48,878 [foster.py] => Learning on 10-20
2024-09-05 07:50:48,880 [foster.py] => All params: 171651122
2024-09-05 07:50:48,881 [foster.py] => Trainable params: 85844776
2024-09-05 07:50:48,926 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.337, Loss_clf 1.769, Loss_fe 2.395, Loss_kd 0.586, Train_accy 54.87, Test_accy 91.50:   0%|          | 0/20 [00:08<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.337, Loss_clf 1.769, Loss_fe 2.395, Loss_kd 0.586, Train_accy 54.87, Test_accy 91.50:   5%|▌         | 1/20 [00:08<02:50,  8.95s/it]
Task 1, Epoch 2/20 => Loss 2.221, Loss_clf 0.485, Loss_fe 0.589, Loss_kd 0.573, Train_accy 78.26:   5%|▌         | 1/20 [00:16<02:50,  8.95s/it]                 
Task 1, Epoch 2/20 => Loss 2.221, Loss_clf 0.485, Loss_fe 0.589, Loss_kd 0.573, Train_accy 78.26:  10%|█         | 2/20 [00:16<02:21,  7.87s/it]
Task 1, Epoch 3/20 => Loss 1.821, Loss_clf 0.300, Loss_fe 0.360, Loss_kd 0.581, Train_accy 80.96:  10%|█         | 2/20 [00:23<02:21,  7.87s/it]
Task 1, Epoch 3/20 => Loss 1.821, Loss_clf 0.300, Loss_fe 0.360, Loss_kd 0.581, Train_accy 80.96:  15%|█▌        | 3/20 [00:23<02:08,  7.54s/it]
Task 1, Epoch 4/20 => Loss 1.704, Loss_clf 0.230, Loss_fe 0.317, Loss_kd 0.579, Train_accy 84.41:  15%|█▌        | 3/20 [00:30<02:08,  7.54s/it]
Task 1, Epoch 4/20 => Loss 1.704, Loss_clf 0.230, Loss_fe 0.317, Loss_kd 0.579, Train_accy 84.41:  20%|██        | 4/20 [00:30<01:58,  7.40s/it]
Task 1, Epoch 5/20 => Loss 1.624, Loss_clf 0.223, Loss_fe 0.267, Loss_kd 0.567, Train_accy 83.66:  20%|██        | 4/20 [00:37<01:58,  7.40s/it]
Task 1, Epoch 5/20 => Loss 1.624, Loss_clf 0.223, Loss_fe 0.267, Loss_kd 0.567, Train_accy 83.66:  25%|██▌       | 5/20 [00:37<01:49,  7.31s/it]
Task 1, Epoch 6/20 => Loss 1.674, Loss_clf 0.243, Loss_fe 0.289, Loss_kd 0.571, Train_accy 85.16, Test_accy 93.12:  25%|██▌       | 5/20 [00:46<01:49,  7.31s/it]
Task 1, Epoch 6/20 => Loss 1.674, Loss_clf 0.243, Loss_fe 0.289, Loss_kd 0.571, Train_accy 85.16, Test_accy 93.12:  30%|███       | 6/20 [00:46<01:50,  7.91s/it]
Task 1, Epoch 7/20 => Loss 1.462, Loss_clf 0.162, Loss_fe 0.192, Loss_kd 0.554, Train_accy 87.56:  30%|███       | 6/20 [00:53<01:50,  7.91s/it]                 
Task 1, Epoch 7/20 => Loss 1.462, Loss_clf 0.162, Loss_fe 0.192, Loss_kd 0.554, Train_accy 87.56:  35%|███▌      | 7/20 [00:53<01:39,  7.66s/it]
Task 1, Epoch 8/20 => Loss 1.487, Loss_clf 0.175, Loss_fe 0.182, Loss_kd 0.565, Train_accy 86.81:  35%|███▌      | 7/20 [01:00<01:39,  7.66s/it]
Task 1, Epoch 8/20 => Loss 1.487, Loss_clf 0.175, Loss_fe 0.182, Loss_kd 0.565, Train_accy 86.81:  40%|████      | 8/20 [01:00<01:30,  7.50s/it]
Task 1, Epoch 9/20 => Loss 1.525, Loss_clf 0.186, Loss_fe 0.192, Loss_kd 0.573, Train_accy 89.36:  40%|████      | 8/20 [01:08<01:30,  7.50s/it]
Task 1, Epoch 9/20 => Loss 1.525, Loss_clf 0.186, Loss_fe 0.192, Loss_kd 0.573, Train_accy 89.36:  45%|████▌     | 9/20 [01:08<01:21,  7.39s/it]
Task 1, Epoch 10/20 => Loss 1.553, Loss_clf 0.210, Loss_fe 0.217, Loss_kd 0.563, Train_accy 83.81:  45%|████▌     | 9/20 [01:15<01:21,  7.39s/it]
Task 1, Epoch 10/20 => Loss 1.553, Loss_clf 0.210, Loss_fe 0.217, Loss_kd 0.563, Train_accy 83.81:  50%|█████     | 10/20 [01:15<01:13,  7.33s/it]
Task 1, Epoch 11/20 => Loss 1.439, Loss_clf 0.145, Loss_fe 0.161, Loss_kd 0.567, Train_accy 92.20, Test_accy 94.74:  50%|█████     | 10/20 [01:24<01:13,  7.33s/it]
Task 1, Epoch 11/20 => Loss 1.439, Loss_clf 0.145, Loss_fe 0.161, Loss_kd 0.567, Train_accy 92.20, Test_accy 94.74:  55%|█████▌    | 11/20 [01:24<01:10,  7.86s/it]
Task 1, Epoch 12/20 => Loss 1.535, Loss_clf 0.197, Loss_fe 0.204, Loss_kd 0.567, Train_accy 86.36:  55%|█████▌    | 11/20 [01:31<01:10,  7.86s/it]                 
Task 1, Epoch 12/20 => Loss 1.535, Loss_clf 0.197, Loss_fe 0.204, Loss_kd 0.567, Train_accy 86.36:  60%|██████    | 12/20 [01:31<01:01,  7.68s/it]
Task 1, Epoch 13/20 => Loss 1.470, Loss_clf 0.172, Loss_fe 0.178, Loss_kd 0.560, Train_accy 86.06:  60%|██████    | 12/20 [01:38<01:01,  7.68s/it]
Task 1, Epoch 13/20 => Loss 1.470, Loss_clf 0.172, Loss_fe 0.178, Loss_kd 0.560, Train_accy 86.06:  65%|██████▌   | 13/20 [01:38<00:52,  7.55s/it]
Task 1, Epoch 14/20 => Loss 1.479, Loss_clf 0.173, Loss_fe 0.169, Loss_kd 0.569, Train_accy 87.56:  65%|██████▌   | 13/20 [01:46<00:52,  7.55s/it]
Task 1, Epoch 14/20 => Loss 1.479, Loss_clf 0.173, Loss_fe 0.169, Loss_kd 0.569, Train_accy 87.56:  70%|███████   | 14/20 [01:46<00:44,  7.45s/it]
Task 1, Epoch 15/20 => Loss 1.469, Loss_clf 0.181, Loss_fe 0.163, Loss_kd 0.562, Train_accy 88.46:  70%|███████   | 14/20 [01:53<00:44,  7.45s/it]
Task 1, Epoch 15/20 => Loss 1.469, Loss_clf 0.181, Loss_fe 0.163, Loss_kd 0.562, Train_accy 88.46:  75%|███████▌  | 15/20 [01:53<00:36,  7.39s/it]
Task 1, Epoch 16/20 => Loss 1.456, Loss_clf 0.160, Loss_fe 0.152, Loss_kd 0.572, Train_accy 89.21, Test_accy 94.74:  75%|███████▌  | 15/20 [02:02<00:36,  7.39s/it]
Task 1, Epoch 16/20 => Loss 1.456, Loss_clf 0.160, Loss_fe 0.152, Loss_kd 0.572, Train_accy 89.21, Test_accy 94.74:  80%|████████  | 16/20 [02:02<00:31,  7.90s/it]
Task 1, Epoch 17/20 => Loss 1.405, Loss_clf 0.130, Loss_fe 0.135, Loss_kd 0.570, Train_accy 90.55:  80%|████████  | 16/20 [02:09<00:31,  7.90s/it]                 
Task 1, Epoch 17/20 => Loss 1.405, Loss_clf 0.130, Loss_fe 0.135, Loss_kd 0.570, Train_accy 90.55:  85%|████████▌ | 17/20 [02:09<00:23,  7.68s/it]
Task 1, Epoch 18/20 => Loss 1.438, Loss_clf 0.166, Loss_fe 0.142, Loss_kd 0.565, Train_accy 90.55:  85%|████████▌ | 17/20 [02:16<00:23,  7.68s/it]
Task 1, Epoch 18/20 => Loss 1.438, Loss_clf 0.166, Loss_fe 0.142, Loss_kd 0.565, Train_accy 90.55:  90%|█████████ | 18/20 [02:16<00:15,  7.55s/it]
Task 1, Epoch 19/20 => Loss 1.480, Loss_clf 0.173, Loss_fe 0.168, Loss_kd 0.569, Train_accy 88.61:  90%|█████████ | 18/20 [02:24<00:15,  7.55s/it]
Task 1, Epoch 19/20 => Loss 1.480, Loss_clf 0.173, Loss_fe 0.168, Loss_kd 0.569, Train_accy 88.61:  95%|█████████▌| 19/20 [02:24<00:07,  7.44s/it]
Task 1, Epoch 20/20 => Loss 1.455, Loss_clf 0.159, Loss_fe 0.168, Loss_kd 0.564, Train_accy 89.51:  95%|█████████▌| 19/20 [02:31<00:07,  7.44s/it]
Task 1, Epoch 20/20 => Loss 1.455, Loss_clf 0.159, Loss_fe 0.168, Loss_kd 0.564, Train_accy 89.51: 100%|██████████| 20/20 [02:31<00:00,  7.36s/it]
Task 1, Epoch 20/20 => Loss 1.455, Loss_clf 0.159, Loss_fe 0.168, Loss_kd 0.564, Train_accy 89.51: 100%|██████████| 20/20 [02:31<00:00,  7.56s/it]
2024-09-05 07:53:20,107 [foster.py] => Task 1, Epoch 20/20 => Loss 1.455, Loss_clf 0.159, Loss_fe 0.168, Loss_kd 0.564, Train_accy 89.51
2024-09-05 07:53:20,108 [foster.py] => do not weight align teacher!
2024-09-05 07:53:20,110 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.720,  Train_accy 43.63, Test_accy 73.28:   0%|          | 0/20 [00:10<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.720,  Train_accy 43.63, Test_accy 73.28:   5%|▌         | 1/20 [00:10<03:13, 10.17s/it]
SNet: Task 1, Epoch 2/20 => Loss 0.957,  Train_accy 75.26:   5%|▌         | 1/20 [00:19<03:13, 10.17s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 0.957,  Train_accy 75.26:  10%|█         | 2/20 [00:19<02:50,  9.48s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.824,  Train_accy 77.81:  10%|█         | 2/20 [00:28<02:50,  9.48s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.824,  Train_accy 77.81:  15%|█▌        | 3/20 [00:28<02:36,  9.23s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.769,  Train_accy 81.56:  15%|█▌        | 3/20 [00:37<02:36,  9.23s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.769,  Train_accy 81.56:  20%|██        | 4/20 [00:37<02:26,  9.14s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.759,  Train_accy 80.21:  20%|██        | 4/20 [00:46<02:26,  9.14s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.759,  Train_accy 80.21:  25%|██▌       | 5/20 [00:46<02:16,  9.10s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.747,  Train_accy 81.56, Test_accy 92.31:  25%|██▌       | 5/20 [00:56<02:16,  9.10s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.747,  Train_accy 81.56, Test_accy 92.31:  30%|███       | 6/20 [00:56<02:13,  9.50s/it]
SNet: Task 1, Epoch 7/20 => Loss 0.725,  Train_accy 82.31:  30%|███       | 6/20 [01:05<02:13,  9.50s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 0.725,  Train_accy 82.31:  35%|███▌      | 7/20 [01:05<02:01,  9.35s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.752,  Train_accy 82.46:  35%|███▌      | 7/20 [01:14<02:01,  9.35s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.752,  Train_accy 82.46:  40%|████      | 8/20 [01:14<01:50,  9.22s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.798,  Train_accy 80.66:  40%|████      | 8/20 [01:23<01:50,  9.22s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.798,  Train_accy 80.66:  45%|████▌     | 9/20 [01:23<01:40,  9.15s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.738,  Train_accy 82.01:  45%|████▌     | 9/20 [01:32<01:40,  9.15s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.738,  Train_accy 82.01:  50%|█████     | 10/20 [01:32<01:30,  9.10s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.758,  Train_accy 81.56, Test_accy 91.09:  50%|█████     | 10/20 [01:42<01:30,  9.10s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.758,  Train_accy 81.56, Test_accy 91.09:  55%|█████▌    | 11/20 [01:42<01:24,  9.44s/it]
SNet: Task 1, Epoch 12/20 => Loss 0.712,  Train_accy 81.56:  55%|█████▌    | 11/20 [01:51<01:24,  9.44s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 0.712,  Train_accy 81.56:  60%|██████    | 12/20 [01:51<01:14,  9.31s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.783,  Train_accy 80.36:  60%|██████    | 12/20 [02:00<01:14,  9.31s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.783,  Train_accy 80.36:  65%|██████▌   | 13/20 [02:00<01:04,  9.24s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.699,  Train_accy 83.66:  65%|██████▌   | 13/20 [02:09<01:04,  9.24s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.699,  Train_accy 83.66:  70%|███████   | 14/20 [02:09<00:54,  9.16s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.744,  Train_accy 82.61:  70%|███████   | 14/20 [02:18<00:54,  9.16s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.744,  Train_accy 82.61:  75%|███████▌  | 15/20 [02:18<00:45,  9.10s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.725,  Train_accy 80.66, Test_accy 91.09:  75%|███████▌  | 15/20 [02:28<00:45,  9.10s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.725,  Train_accy 80.66, Test_accy 91.09:  80%|████████  | 16/20 [02:28<00:37,  9.45s/it]
SNet: Task 1, Epoch 17/20 => Loss 0.736,  Train_accy 83.51:  80%|████████  | 16/20 [02:37<00:37,  9.45s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 0.736,  Train_accy 83.51:  85%|████████▌ | 17/20 [02:37<00:27,  9.32s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.721,  Train_accy 82.91:  85%|████████▌ | 17/20 [02:46<00:27,  9.32s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.721,  Train_accy 82.91:  90%|█████████ | 18/20 [02:46<00:18,  9.22s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.760,  Train_accy 80.96:  90%|█████████ | 18/20 [02:55<00:18,  9.22s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.760,  Train_accy 80.96:  95%|█████████▌| 19/20 [02:55<00:09,  9.16s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.697,  Train_accy 83.96:  95%|█████████▌| 19/20 [03:04<00:09,  9.16s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.697,  Train_accy 83.96: 100%|██████████| 20/20 [03:04<00:00,  9.13s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.697,  Train_accy 83.96: 100%|██████████| 20/20 [03:04<00:00,  9.25s/it]
2024-09-05 07:56:26,585 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.697,  Train_accy 83.96
2024-09-05 07:56:26,586 [foster.py] => do not weight align student!
2024-09-05 07:56:27,814 [foster.py] => darknet eval: 
2024-09-05 07:56:27,814 [foster.py] => CNN top1 curve: 91.09
2024-09-05 07:56:27,814 [foster.py] => CNN top5 curve: 100.0
2024-09-05 07:56:27,817 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 07:56:46,683 [foster.py] => Exemplar size: 400
2024-09-05 07:56:46,683 [trainer.py] => CNN: {'total': 94.74, '00-09': 100.0, '10-19': 89.92, 'old': 100.0, 'new': 89.92}
2024-09-05 07:56:46,683 [trainer.py] => NME: {'total': 97.17, '00-09': 98.31, '10-19': 96.12, 'old': 98.31, 'new': 96.12}
2024-09-05 07:56:46,683 [trainer.py] => CNN top1 curve: [99.15, 94.74]
2024-09-05 07:56:46,684 [trainer.py] => CNN top5 curve: [100.0, 100.0]
2024-09-05 07:56:46,684 [trainer.py] => NME top1 curve: [99.15, 97.17]
2024-09-05 07:56:46,684 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 96.94
Average Accuracy (NME): 98.16
2024-09-05 07:56:46,684 [trainer.py] => Average Accuracy (CNN): 96.94
2024-09-05 07:56:46,684 [trainer.py] => Average Accuracy (NME): 98.16
2024-09-05 07:56:46,686 [trainer.py] => All params: 171651122
2024-09-05 07:56:46,688 [trainer.py] => Trainable params: 85844776
2024-09-05 07:56:48,100 [foster.py] => Learning on 20-30
2024-09-05 07:56:48,102 [foster.py] => All params: 171681872
2024-09-05 07:56:48,102 [foster.py] => Trainable params: 85867836
2024-09-05 07:56:48,147 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.447, Loss_clf 1.749, Loss_fe 2.468, Loss_kd 0.820, Train_accy 61.07, Test_accy 84.88:   0%|          | 0/20 [00:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.447, Loss_clf 1.749, Loss_fe 2.468, Loss_kd 0.820, Train_accy 61.07, Test_accy 84.88:   5%|▌         | 1/20 [00:11<03:45, 11.89s/it]
Task 2, Epoch 2/20 => Loss 2.098, Loss_clf 0.398, Loss_fe 0.574, Loss_kd 0.750, Train_accy 69.75:   5%|▌         | 1/20 [00:21<03:45, 11.89s/it]                 
Task 2, Epoch 2/20 => Loss 2.098, Loss_clf 0.398, Loss_fe 0.574, Loss_kd 0.750, Train_accy 69.75:  10%|█         | 2/20 [00:21<03:07, 10.42s/it]
Task 2, Epoch 3/20 => Loss 1.726, Loss_clf 0.268, Loss_fe 0.349, Loss_kd 0.739, Train_accy 75.23:  10%|█         | 2/20 [00:30<03:07, 10.42s/it]
Task 2, Epoch 3/20 => Loss 1.726, Loss_clf 0.268, Loss_fe 0.349, Loss_kd 0.739, Train_accy 75.23:  15%|█▌        | 3/20 [00:30<02:49,  9.96s/it]
Task 2, Epoch 4/20 => Loss 1.829, Loss_clf 0.320, Loss_fe 0.372, Loss_kd 0.758, Train_accy 72.15:  15%|█▌        | 3/20 [00:40<02:49,  9.96s/it]
Task 2, Epoch 4/20 => Loss 1.829, Loss_clf 0.320, Loss_fe 0.372, Loss_kd 0.758, Train_accy 72.15:  20%|██        | 4/20 [00:40<02:35,  9.74s/it]
Task 2, Epoch 5/20 => Loss 1.630, Loss_clf 0.244, Loss_fe 0.301, Loss_kd 0.724, Train_accy 77.28:  20%|██        | 4/20 [00:49<02:35,  9.74s/it]
Task 2, Epoch 5/20 => Loss 1.630, Loss_clf 0.244, Loss_fe 0.301, Loss_kd 0.724, Train_accy 77.28:  25%|██▌       | 5/20 [00:49<02:24,  9.64s/it]
Task 2, Epoch 6/20 => Loss 1.687, Loss_clf 0.296, Loss_fe 0.299, Loss_kd 0.728, Train_accy 77.63, Test_accy 92.44:  25%|██▌       | 5/20 [01:01<02:24,  9.64s/it]
Task 2, Epoch 6/20 => Loss 1.687, Loss_clf 0.296, Loss_fe 0.299, Loss_kd 0.728, Train_accy 77.63, Test_accy 92.44:  30%|███       | 6/20 [01:01<02:25, 10.41s/it]
Task 2, Epoch 7/20 => Loss 1.572, Loss_clf 0.225, Loss_fe 0.241, Loss_kd 0.737, Train_accy 84.93:  30%|███       | 6/20 [01:10<02:25, 10.41s/it]                 
Task 2, Epoch 7/20 => Loss 1.572, Loss_clf 0.225, Loss_fe 0.241, Loss_kd 0.737, Train_accy 84.93:  35%|███▌      | 7/20 [01:10<02:10, 10.08s/it]
Task 2, Epoch 8/20 => Loss 1.563, Loss_clf 0.243, Loss_fe 0.240, Loss_kd 0.720, Train_accy 81.96:  35%|███▌      | 7/20 [01:20<02:10, 10.08s/it]
Task 2, Epoch 8/20 => Loss 1.563, Loss_clf 0.243, Loss_fe 0.240, Loss_kd 0.720, Train_accy 81.96:  40%|████      | 8/20 [01:20<01:58,  9.86s/it]
Task 2, Epoch 9/20 => Loss 1.498, Loss_clf 0.214, Loss_fe 0.194, Loss_kd 0.727, Train_accy 83.90:  40%|████      | 8/20 [01:29<01:58,  9.86s/it]
Task 2, Epoch 9/20 => Loss 1.498, Loss_clf 0.214, Loss_fe 0.194, Loss_kd 0.727, Train_accy 83.90:  45%|████▌     | 9/20 [01:29<01:46,  9.71s/it]
Task 2, Epoch 10/20 => Loss 1.463, Loss_clf 0.192, Loss_fe 0.172, Loss_kd 0.733, Train_accy 84.36:  45%|████▌     | 9/20 [01:39<01:46,  9.71s/it]
Task 2, Epoch 10/20 => Loss 1.463, Loss_clf 0.192, Loss_fe 0.172, Loss_kd 0.733, Train_accy 84.36:  50%|█████     | 10/20 [01:39<01:36,  9.62s/it]
Task 2, Epoch 11/20 => Loss 1.526, Loss_clf 0.229, Loss_fe 0.200, Loss_kd 0.732, Train_accy 83.68, Test_accy 92.44:  50%|█████     | 10/20 [01:50<01:36,  9.62s/it]
Task 2, Epoch 11/20 => Loss 1.526, Loss_clf 0.229, Loss_fe 0.200, Loss_kd 0.732, Train_accy 83.68, Test_accy 92.44:  55%|█████▌    | 11/20 [01:50<01:32, 10.30s/it]
Task 2, Epoch 12/20 => Loss 1.439, Loss_clf 0.186, Loss_fe 0.154, Loss_kd 0.733, Train_accy 83.45:  55%|█████▌    | 11/20 [02:00<01:32, 10.30s/it]                 
Task 2, Epoch 12/20 => Loss 1.439, Loss_clf 0.186, Loss_fe 0.154, Loss_kd 0.733, Train_accy 83.45:  60%|██████    | 12/20 [02:00<01:20, 10.03s/it]
Task 2, Epoch 13/20 => Loss 1.442, Loss_clf 0.190, Loss_fe 0.165, Loss_kd 0.725, Train_accy 83.11:  60%|██████    | 12/20 [02:09<01:20, 10.03s/it]
Task 2, Epoch 13/20 => Loss 1.442, Loss_clf 0.190, Loss_fe 0.165, Loss_kd 0.725, Train_accy 83.11:  65%|██████▌   | 13/20 [02:09<01:08,  9.84s/it]
Task 2, Epoch 14/20 => Loss 1.362, Loss_clf 0.158, Loss_fe 0.144, Loss_kd 0.707, Train_accy 82.31:  65%|██████▌   | 13/20 [02:19<01:08,  9.84s/it]
Task 2, Epoch 14/20 => Loss 1.362, Loss_clf 0.158, Loss_fe 0.144, Loss_kd 0.707, Train_accy 82.31:  70%|███████   | 14/20 [02:19<00:58,  9.72s/it]
Task 2, Epoch 15/20 => Loss 1.417, Loss_clf 0.179, Loss_fe 0.163, Loss_kd 0.717, Train_accy 83.56:  70%|███████   | 14/20 [02:28<00:58,  9.72s/it]
Task 2, Epoch 15/20 => Loss 1.417, Loss_clf 0.179, Loss_fe 0.163, Loss_kd 0.717, Train_accy 83.56:  75%|███████▌  | 15/20 [02:28<00:48,  9.65s/it]
Task 2, Epoch 16/20 => Loss 1.484, Loss_clf 0.184, Loss_fe 0.157, Loss_kd 0.762, Train_accy 84.25, Test_accy 91.28:  75%|███████▌  | 15/20 [02:40<00:48,  9.65s/it]
Task 2, Epoch 16/20 => Loss 1.484, Loss_clf 0.184, Loss_fe 0.157, Loss_kd 0.762, Train_accy 84.25, Test_accy 91.28:  80%|████████  | 16/20 [02:40<00:41, 10.33s/it]
Task 2, Epoch 17/20 => Loss 1.438, Loss_clf 0.193, Loss_fe 0.152, Loss_kd 0.729, Train_accy 82.31:  80%|████████  | 16/20 [02:49<00:41, 10.33s/it]                 
Task 2, Epoch 17/20 => Loss 1.438, Loss_clf 0.193, Loss_fe 0.152, Loss_kd 0.729, Train_accy 82.31:  85%|████████▌ | 17/20 [02:49<00:30, 10.06s/it]
Task 2, Epoch 18/20 => Loss 1.464, Loss_clf 0.199, Loss_fe 0.164, Loss_kd 0.734, Train_accy 81.51:  85%|████████▌ | 17/20 [02:59<00:30, 10.06s/it]
Task 2, Epoch 18/20 => Loss 1.464, Loss_clf 0.199, Loss_fe 0.164, Loss_kd 0.734, Train_accy 81.51:  90%|█████████ | 18/20 [02:59<00:19,  9.91s/it]
Task 2, Epoch 19/20 => Loss 1.566, Loss_clf 0.209, Loss_fe 0.195, Loss_kd 0.775, Train_accy 83.11:  90%|█████████ | 18/20 [03:09<00:19,  9.91s/it]
Task 2, Epoch 19/20 => Loss 1.566, Loss_clf 0.209, Loss_fe 0.195, Loss_kd 0.775, Train_accy 83.11:  95%|█████████▌| 19/20 [03:09<00:09,  9.78s/it]
Task 2, Epoch 20/20 => Loss 1.342, Loss_clf 0.151, Loss_fe 0.133, Loss_kd 0.706, Train_accy 84.13:  95%|█████████▌| 19/20 [03:18<00:09,  9.78s/it]
Task 2, Epoch 20/20 => Loss 1.342, Loss_clf 0.151, Loss_fe 0.133, Loss_kd 0.706, Train_accy 84.13: 100%|██████████| 20/20 [03:18<00:00,  9.67s/it]
Task 2, Epoch 20/20 => Loss 1.342, Loss_clf 0.151, Loss_fe 0.133, Loss_kd 0.706, Train_accy 84.13: 100%|██████████| 20/20 [03:18<00:00,  9.92s/it]
2024-09-05 08:00:06,581 [foster.py] => Task 2, Epoch 20/20 => Loss 1.342, Loss_clf 0.151, Loss_fe 0.133, Loss_kd 0.706, Train_accy 84.13
2024-09-05 08:00:06,582 [foster.py] => do not weight align teacher!
2024-09-05 08:00:06,584 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.598,  Train_accy 51.26, Test_accy 79.94:   0%|          | 0/20 [00:13<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.598,  Train_accy 51.26, Test_accy 79.94:   5%|▌         | 1/20 [00:13<04:12, 13.27s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.112,  Train_accy 67.01:   5%|▌         | 1/20 [00:25<04:12, 13.27s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.112,  Train_accy 67.01:  10%|█         | 2/20 [00:25<03:43, 12.39s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.049,  Train_accy 70.66:  10%|█         | 2/20 [00:36<03:43, 12.39s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.049,  Train_accy 70.66:  15%|█▌        | 3/20 [00:36<03:25, 12.11s/it]
SNet: Task 2, Epoch 4/20 => Loss 0.992,  Train_accy 70.66:  15%|█▌        | 3/20 [00:48<03:25, 12.11s/it]
SNet: Task 2, Epoch 4/20 => Loss 0.992,  Train_accy 70.66:  20%|██        | 4/20 [00:48<03:11, 11.97s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.027,  Train_accy 73.29:  20%|██        | 4/20 [01:00<03:11, 11.97s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.027,  Train_accy 73.29:  25%|██▌       | 5/20 [01:00<02:58, 11.89s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.001,  Train_accy 72.37, Test_accy 86.63:  25%|██▌       | 5/20 [01:13<02:58, 11.89s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.001,  Train_accy 72.37, Test_accy 86.63:  30%|███       | 6/20 [01:13<02:53, 12.37s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.002,  Train_accy 72.95:  30%|███       | 6/20 [01:25<02:53, 12.37s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.002,  Train_accy 72.95:  35%|███▌      | 7/20 [01:25<02:37, 12.15s/it]
SNet: Task 2, Epoch 8/20 => Loss 0.960,  Train_accy 72.03:  35%|███▌      | 7/20 [01:37<02:37, 12.15s/it]
SNet: Task 2, Epoch 8/20 => Loss 0.960,  Train_accy 72.03:  40%|████      | 8/20 [01:37<02:24, 12.04s/it]
SNet: Task 2, Epoch 9/20 => Loss 0.967,  Train_accy 72.72:  40%|████      | 8/20 [01:48<02:24, 12.04s/it]
SNet: Task 2, Epoch 9/20 => Loss 0.967,  Train_accy 72.72:  45%|████▌     | 9/20 [01:48<02:11, 11.95s/it]
SNet: Task 2, Epoch 10/20 => Loss 0.978,  Train_accy 73.06:  45%|████▌     | 9/20 [02:00<02:11, 11.95s/it]
SNet: Task 2, Epoch 10/20 => Loss 0.978,  Train_accy 73.06:  50%|█████     | 10/20 [02:00<01:59, 11.91s/it]
SNet: Task 2, Epoch 11/20 => Loss 0.997,  Train_accy 70.89, Test_accy 87.21:  50%|█████     | 10/20 [02:13<01:59, 11.91s/it]
SNet: Task 2, Epoch 11/20 => Loss 0.997,  Train_accy 70.89, Test_accy 87.21:  55%|█████▌    | 11/20 [02:13<01:50, 12.33s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.003,  Train_accy 73.97:  55%|█████▌    | 11/20 [02:25<01:50, 12.33s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.003,  Train_accy 73.97:  60%|██████    | 12/20 [02:25<01:37, 12.14s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.031,  Train_accy 70.55:  60%|██████    | 12/20 [02:37<01:37, 12.14s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.031,  Train_accy 70.55:  65%|██████▌   | 13/20 [02:37<01:24, 12.03s/it]
SNet: Task 2, Epoch 14/20 => Loss 0.964,  Train_accy 74.20:  65%|██████▌   | 13/20 [02:49<01:24, 12.03s/it]
SNet: Task 2, Epoch 14/20 => Loss 0.964,  Train_accy 74.20:  70%|███████   | 14/20 [02:49<01:11, 11.94s/it]
SNet: Task 2, Epoch 15/20 => Loss 0.993,  Train_accy 72.37:  70%|███████   | 14/20 [03:00<01:11, 11.94s/it]
SNet: Task 2, Epoch 15/20 => Loss 0.993,  Train_accy 72.37:  75%|███████▌  | 15/20 [03:00<00:59, 11.88s/it]
SNet: Task 2, Epoch 16/20 => Loss 0.991,  Train_accy 72.72, Test_accy 86.92:  75%|███████▌  | 15/20 [03:14<00:59, 11.88s/it]
SNet: Task 2, Epoch 16/20 => Loss 0.991,  Train_accy 72.72, Test_accy 86.92:  80%|████████  | 16/20 [03:14<00:49, 12.31s/it]
SNet: Task 2, Epoch 17/20 => Loss 0.939,  Train_accy 73.06:  80%|████████  | 16/20 [03:25<00:49, 12.31s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 0.939,  Train_accy 73.06:  85%|████████▌ | 17/20 [03:25<00:36, 12.13s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.006,  Train_accy 72.15:  85%|████████▌ | 17/20 [03:37<00:36, 12.13s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.006,  Train_accy 72.15:  90%|█████████ | 18/20 [03:37<00:24, 12.01s/it]
SNet: Task 2, Epoch 19/20 => Loss 0.971,  Train_accy 73.63:  90%|█████████ | 18/20 [03:49<00:24, 12.01s/it]
SNet: Task 2, Epoch 19/20 => Loss 0.971,  Train_accy 73.63:  95%|█████████▌| 19/20 [03:49<00:11, 11.93s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.002,  Train_accy 72.37:  95%|█████████▌| 19/20 [04:01<00:11, 11.93s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.002,  Train_accy 72.37: 100%|██████████| 20/20 [04:01<00:00, 11.87s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.002,  Train_accy 72.37: 100%|██████████| 20/20 [04:01<00:00, 12.06s/it]
2024-09-05 08:04:09,196 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.002,  Train_accy 72.37
2024-09-05 08:04:09,196 [foster.py] => do not weight align student!
2024-09-05 08:04:10,728 [foster.py] => darknet eval: 
2024-09-05 08:04:10,728 [foster.py] => CNN top1 curve: 87.5
2024-09-05 08:04:10,729 [foster.py] => CNN top5 curve: 99.71
2024-09-05 08:04:10,732 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 08:04:35,272 [foster.py] => Exemplar size: 600
2024-09-05 08:04:35,272 [trainer.py] => CNN: {'total': 92.15, '00-09': 100.0, '10-19': 94.57, '20-29': 79.38, 'old': 97.17, 'new': 79.38}
2024-09-05 08:04:35,272 [trainer.py] => NME: {'total': 97.38, '00-09': 98.31, '10-19': 96.9, '20-29': 96.91, 'old': 97.57, 'new': 96.91}
2024-09-05 08:04:35,273 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15]
2024-09-05 08:04:35,273 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71]
2024-09-05 08:04:35,273 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38]
2024-09-05 08:04:35,273 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71]

Average Accuracy (CNN): 95.35
Average Accuracy (NME): 97.9
2024-09-05 08:04:35,273 [trainer.py] => Average Accuracy (CNN): 95.35
2024-09-05 08:04:35,273 [trainer.py] => Average Accuracy (NME): 97.9
2024-09-05 08:04:35,275 [trainer.py] => All params: 171681872
2024-09-05 08:04:35,276 [trainer.py] => Trainable params: 85867836
2024-09-05 08:04:36,767 [foster.py] => Learning on 30-40
2024-09-05 08:04:36,768 [foster.py] => All params: 171712622
2024-09-05 08:04:36,769 [foster.py] => Trainable params: 85890896
2024-09-05 08:04:36,814 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.673, Loss_clf 1.505, Loss_fe 2.724, Loss_kd 1.083, Train_accy 60.80, Test_accy 79.74:   0%|          | 0/20 [00:14<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.673, Loss_clf 1.505, Loss_fe 2.724, Loss_kd 1.083, Train_accy 60.80, Test_accy 79.74:   5%|▌         | 1/20 [00:14<04:32, 14.32s/it]
Task 3, Epoch 2/20 => Loss 2.812, Loss_clf 0.548, Loss_fe 0.794, Loss_kd 1.102, Train_accy 71.84:   5%|▌         | 1/20 [00:25<04:32, 14.32s/it]                 
Task 3, Epoch 2/20 => Loss 2.812, Loss_clf 0.548, Loss_fe 0.794, Loss_kd 1.102, Train_accy 71.84:  10%|█         | 2/20 [00:25<03:45, 12.55s/it]
Task 3, Epoch 3/20 => Loss 2.328, Loss_clf 0.445, Loss_fe 0.481, Loss_kd 1.052, Train_accy 75.02:  10%|█         | 2/20 [00:36<03:45, 12.55s/it]
Task 3, Epoch 3/20 => Loss 2.328, Loss_clf 0.445, Loss_fe 0.481, Loss_kd 1.052, Train_accy 75.02:  15%|█▌        | 3/20 [00:36<03:24, 12.01s/it]
Task 3, Epoch 4/20 => Loss 2.135, Loss_clf 0.344, Loss_fe 0.390, Loss_kd 1.050, Train_accy 75.77:  15%|█▌        | 3/20 [00:48<03:24, 12.01s/it]
Task 3, Epoch 4/20 => Loss 2.135, Loss_clf 0.344, Loss_fe 0.390, Loss_kd 1.050, Train_accy 75.77:  20%|██        | 4/20 [00:48<03:07, 11.74s/it]
Task 3, Epoch 5/20 => Loss 2.087, Loss_clf 0.334, Loss_fe 0.334, Loss_kd 1.064, Train_accy 78.77:  20%|██        | 4/20 [00:59<03:07, 11.74s/it]
Task 3, Epoch 5/20 => Loss 2.087, Loss_clf 0.334, Loss_fe 0.334, Loss_kd 1.064, Train_accy 78.77:  25%|██▌       | 5/20 [00:59<02:53, 11.59s/it]
Task 3, Epoch 6/20 => Loss 1.960, Loss_clf 0.300, Loss_fe 0.279, Loss_kd 1.036, Train_accy 79.14, Test_accy 89.43:  25%|██▌       | 5/20 [01:14<02:53, 11.59s/it]
Task 3, Epoch 6/20 => Loss 1.960, Loss_clf 0.300, Loss_fe 0.279, Loss_kd 1.036, Train_accy 79.14, Test_accy 89.43:  30%|███       | 6/20 [01:14<02:55, 12.55s/it]
Task 3, Epoch 7/20 => Loss 1.903, Loss_clf 0.285, Loss_fe 0.249, Loss_kd 1.027, Train_accy 80.36:  30%|███       | 6/20 [01:25<02:55, 12.55s/it]                 
Task 3, Epoch 7/20 => Loss 1.903, Loss_clf 0.285, Loss_fe 0.249, Loss_kd 1.027, Train_accy 80.36:  35%|███▌      | 7/20 [01:25<02:38, 12.16s/it]
Task 3, Epoch 8/20 => Loss 1.845, Loss_clf 0.255, Loss_fe 0.226, Loss_kd 1.023, Train_accy 81.20:  35%|███▌      | 7/20 [01:36<02:38, 12.16s/it]
Task 3, Epoch 8/20 => Loss 1.845, Loss_clf 0.255, Loss_fe 0.226, Loss_kd 1.023, Train_accy 81.20:  40%|████      | 8/20 [01:36<02:23, 11.92s/it]
Task 3, Epoch 9/20 => Loss 1.994, Loss_clf 0.292, Loss_fe 0.280, Loss_kd 1.066, Train_accy 80.64:  40%|████      | 8/20 [01:48<02:23, 11.92s/it]
Task 3, Epoch 9/20 => Loss 1.994, Loss_clf 0.292, Loss_fe 0.280, Loss_kd 1.066, Train_accy 80.64:  45%|████▌     | 9/20 [01:48<02:09, 11.75s/it]
Task 3, Epoch 10/20 => Loss 1.875, Loss_clf 0.269, Loss_fe 0.224, Loss_kd 1.037, Train_accy 81.57:  45%|████▌     | 9/20 [01:59<02:09, 11.75s/it]
Task 3, Epoch 10/20 => Loss 1.875, Loss_clf 0.269, Loss_fe 0.224, Loss_kd 1.037, Train_accy 81.57:  50%|█████     | 10/20 [01:59<01:56, 11.64s/it]
Task 3, Epoch 11/20 => Loss 1.919, Loss_clf 0.268, Loss_fe 0.239, Loss_kd 1.059, Train_accy 80.64, Test_accy 89.21:  50%|█████     | 10/20 [02:14<01:56, 11.64s/it]
Task 3, Epoch 11/20 => Loss 1.919, Loss_clf 0.268, Loss_fe 0.239, Loss_kd 1.059, Train_accy 80.64, Test_accy 89.21:  55%|█████▌    | 11/20 [02:14<01:52, 12.51s/it]
Task 3, Epoch 12/20 => Loss 1.952, Loss_clf 0.287, Loss_fe 0.244, Loss_kd 1.065, Train_accy 81.67:  55%|█████▌    | 11/20 [02:25<01:52, 12.51s/it]                 
Task 3, Epoch 12/20 => Loss 1.952, Loss_clf 0.287, Loss_fe 0.244, Loss_kd 1.065, Train_accy 81.67:  60%|██████    | 12/20 [02:25<01:37, 12.19s/it]
Task 3, Epoch 13/20 => Loss 1.830, Loss_clf 0.238, Loss_fe 0.212, Loss_kd 1.036, Train_accy 82.79:  60%|██████    | 12/20 [02:36<01:37, 12.19s/it]
Task 3, Epoch 13/20 => Loss 1.830, Loss_clf 0.238, Loss_fe 0.212, Loss_kd 1.036, Train_accy 82.79:  65%|██████▌   | 13/20 [02:36<01:23, 11.96s/it]
Task 3, Epoch 14/20 => Loss 1.849, Loss_clf 0.236, Loss_fe 0.198, Loss_kd 1.061, Train_accy 83.16:  65%|██████▌   | 13/20 [02:48<01:23, 11.96s/it]
Task 3, Epoch 14/20 => Loss 1.849, Loss_clf 0.236, Loss_fe 0.198, Loss_kd 1.061, Train_accy 83.16:  70%|███████   | 14/20 [02:48<01:10, 11.78s/it]
Task 3, Epoch 15/20 => Loss 1.902, Loss_clf 0.267, Loss_fe 0.222, Loss_kd 1.059, Train_accy 82.41:  70%|███████   | 14/20 [02:59<01:10, 11.78s/it]
Task 3, Epoch 15/20 => Loss 1.902, Loss_clf 0.267, Loss_fe 0.222, Loss_kd 1.059, Train_accy 82.41:  75%|███████▌  | 15/20 [02:59<00:58, 11.66s/it]
Task 3, Epoch 16/20 => Loss 1.744, Loss_clf 0.215, Loss_fe 0.160, Loss_kd 1.027, Train_accy 82.60, Test_accy 89.21:  75%|███████▌  | 15/20 [03:14<00:58, 11.66s/it]
Task 3, Epoch 16/20 => Loss 1.744, Loss_clf 0.215, Loss_fe 0.160, Loss_kd 1.027, Train_accy 82.60, Test_accy 89.21:  80%|████████  | 16/20 [03:14<00:50, 12.50s/it]
Task 3, Epoch 17/20 => Loss 1.776, Loss_clf 0.215, Loss_fe 0.161, Loss_kd 1.049, Train_accy 83.72:  80%|████████  | 16/20 [03:25<00:50, 12.50s/it]                 
Task 3, Epoch 17/20 => Loss 1.776, Loss_clf 0.215, Loss_fe 0.161, Loss_kd 1.049, Train_accy 83.72:  85%|████████▌ | 17/20 [03:25<00:36, 12.15s/it]
Task 3, Epoch 18/20 => Loss 1.852, Loss_clf 0.235, Loss_fe 0.202, Loss_kd 1.061, Train_accy 84.47:  85%|████████▌ | 17/20 [03:36<00:36, 12.15s/it]
Task 3, Epoch 18/20 => Loss 1.852, Loss_clf 0.235, Loss_fe 0.202, Loss_kd 1.061, Train_accy 84.47:  90%|█████████ | 18/20 [03:36<00:23, 11.93s/it]
Task 3, Epoch 19/20 => Loss 1.689, Loss_clf 0.192, Loss_fe 0.142, Loss_kd 1.016, Train_accy 83.63:  90%|█████████ | 18/20 [03:48<00:23, 11.93s/it]
Task 3, Epoch 19/20 => Loss 1.689, Loss_clf 0.192, Loss_fe 0.142, Loss_kd 1.016, Train_accy 83.63:  95%|█████████▌| 19/20 [03:48<00:11, 11.79s/it]
Task 3, Epoch 20/20 => Loss 1.707, Loss_clf 0.190, Loss_fe 0.144, Loss_kd 1.029, Train_accy 84.85:  95%|█████████▌| 19/20 [03:59<00:11, 11.79s/it]
Task 3, Epoch 20/20 => Loss 1.707, Loss_clf 0.190, Loss_fe 0.144, Loss_kd 1.029, Train_accy 84.85: 100%|██████████| 20/20 [03:59<00:00, 11.69s/it]
Task 3, Epoch 20/20 => Loss 1.707, Loss_clf 0.190, Loss_fe 0.144, Loss_kd 1.029, Train_accy 84.85: 100%|██████████| 20/20 [03:59<00:00, 11.99s/it]
2024-09-05 08:08:36,658 [foster.py] => Task 3, Epoch 20/20 => Loss 1.707, Loss_clf 0.190, Loss_fe 0.144, Loss_kd 1.029, Train_accy 84.85
2024-09-05 08:08:36,659 [foster.py] => do not weight align teacher!
2024-09-05 08:08:36,661 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.529,  Train_accy 59.68, Test_accy 81.06:   0%|          | 0/20 [00:16<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.529,  Train_accy 59.68, Test_accy 81.06:   5%|▌         | 1/20 [00:16<05:05, 16.06s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.267,  Train_accy 69.78:   5%|▌         | 1/20 [00:30<05:05, 16.06s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.267,  Train_accy 69.78:  10%|█         | 2/20 [00:30<04:29, 14.99s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.203,  Train_accy 72.40:  10%|█         | 2/20 [00:44<04:29, 14.99s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.203,  Train_accy 72.40:  15%|█▌        | 3/20 [00:44<04:09, 14.66s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.167,  Train_accy 72.50:  15%|█▌        | 3/20 [00:58<04:09, 14.66s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.167,  Train_accy 72.50:  20%|██        | 4/20 [00:58<03:51, 14.47s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.189,  Train_accy 72.40:  20%|██        | 4/20 [01:13<03:51, 14.47s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.189,  Train_accy 72.40:  25%|██▌       | 5/20 [01:13<03:35, 14.40s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.155,  Train_accy 73.99, Test_accy 85.24:  25%|██▌       | 5/20 [01:29<03:35, 14.40s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.155,  Train_accy 73.99, Test_accy 85.24:  30%|███       | 6/20 [01:29<03:29, 14.98s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.179,  Train_accy 74.65:  30%|███       | 6/20 [01:43<03:29, 14.98s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.179,  Train_accy 74.65:  35%|███▌      | 7/20 [01:43<03:11, 14.74s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.157,  Train_accy 73.71:  35%|███▌      | 7/20 [01:57<03:11, 14.74s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.157,  Train_accy 73.71:  40%|████      | 8/20 [01:57<02:55, 14.60s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.160,  Train_accy 74.46:  40%|████      | 8/20 [02:11<02:55, 14.60s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.160,  Train_accy 74.46:  45%|████▌     | 9/20 [02:11<02:39, 14.50s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.191,  Train_accy 73.43:  45%|████▌     | 9/20 [02:26<02:39, 14.50s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.191,  Train_accy 73.43:  50%|█████     | 10/20 [02:26<02:24, 14.42s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.142,  Train_accy 73.99, Test_accy 84.80:  50%|█████     | 10/20 [02:42<02:24, 14.42s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.142,  Train_accy 73.99, Test_accy 84.80:  55%|█████▌    | 11/20 [02:42<02:14, 14.94s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.196,  Train_accy 73.25:  55%|█████▌    | 11/20 [02:56<02:14, 14.94s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.196,  Train_accy 73.25:  60%|██████    | 12/20 [02:56<01:57, 14.73s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.148,  Train_accy 74.93:  60%|██████    | 12/20 [03:10<01:57, 14.73s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.148,  Train_accy 74.93:  65%|██████▌   | 13/20 [03:10<01:42, 14.59s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.183,  Train_accy 75.58:  65%|██████▌   | 13/20 [03:25<01:42, 14.59s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.183,  Train_accy 75.58:  70%|███████   | 14/20 [03:25<01:26, 14.49s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.165,  Train_accy 75.49:  70%|███████   | 14/20 [03:39<01:26, 14.49s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.165,  Train_accy 75.49:  75%|███████▌  | 15/20 [03:39<01:12, 14.43s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.114,  Train_accy 76.71, Test_accy 85.02:  75%|███████▌  | 15/20 [03:55<01:12, 14.43s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.114,  Train_accy 76.71, Test_accy 85.02:  80%|████████  | 16/20 [03:55<00:59, 14.95s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.147,  Train_accy 74.46:  80%|████████  | 16/20 [04:09<00:59, 14.95s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.147,  Train_accy 74.46:  85%|████████▌ | 17/20 [04:09<00:44, 14.74s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.175,  Train_accy 74.74:  85%|████████▌ | 17/20 [04:24<00:44, 14.74s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.175,  Train_accy 74.74:  90%|█████████ | 18/20 [04:24<00:29, 14.59s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.122,  Train_accy 75.02:  90%|█████████ | 18/20 [04:38<00:29, 14.59s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.122,  Train_accy 75.02:  95%|█████████▌| 19/20 [04:38<00:14, 14.48s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.150,  Train_accy 75.02:  95%|█████████▌| 19/20 [04:52<00:14, 14.48s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.150,  Train_accy 75.02: 100%|██████████| 20/20 [04:52<00:00, 14.41s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.150,  Train_accy 75.02: 100%|██████████| 20/20 [04:52<00:00, 14.63s/it]
2024-09-05 08:13:30,713 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.150,  Train_accy 75.02
2024-09-05 08:13:30,713 [foster.py] => do not weight align student!
2024-09-05 08:13:32,587 [foster.py] => darknet eval: 
2024-09-05 08:13:32,587 [foster.py] => CNN top1 curve: 84.14
2024-09-05 08:13:32,587 [foster.py] => CNN top5 curve: 98.9
2024-09-05 08:13:32,590 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 08:14:03,266 [foster.py] => Exemplar size: 800
2024-09-05 08:14:03,267 [trainer.py] => CNN: {'total': 89.65, '00-09': 100.0, '10-19': 97.67, '20-29': 87.63, '30-39': 70.91, 'old': 95.64, 'new': 70.91}
2024-09-05 08:14:03,267 [trainer.py] => NME: {'total': 96.7, '00-09': 96.61, '10-19': 96.9, '20-29': 96.91, '30-39': 96.36, 'old': 96.8, 'new': 96.36}
2024-09-05 08:14:03,267 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65]
2024-09-05 08:14:03,267 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34]
2024-09-05 08:14:03,267 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7]
2024-09-05 08:14:03,267 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56]

Average Accuracy (CNN): 93.92
Average Accuracy (NME): 97.6
2024-09-05 08:14:03,267 [trainer.py] => Average Accuracy (CNN): 93.92
2024-09-05 08:14:03,267 [trainer.py] => Average Accuracy (NME): 97.6
2024-09-05 08:14:03,268 [trainer.py] => All params: 171712622
2024-09-05 08:14:03,269 [trainer.py] => Trainable params: 85890896
2024-09-05 08:14:04,760 [foster.py] => Learning on 40-50
2024-09-05 08:14:04,761 [foster.py] => All params: 171743372
2024-09-05 08:14:04,762 [foster.py] => Trainable params: 85913956
2024-09-05 08:14:04,807 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 5.557, Loss_clf 1.208, Loss_fe 2.778, Loss_kd 1.257, Train_accy 67.61, Test_accy 87.52:   0%|          | 0/20 [00:16<?, ?it/s]
Task 4, Epoch 1/20 => Loss 5.557, Loss_clf 1.208, Loss_fe 2.778, Loss_kd 1.257, Train_accy 67.61, Test_accy 87.52:   5%|▌         | 1/20 [00:16<05:20, 16.85s/it]
Task 4, Epoch 2/20 => Loss 2.874, Loss_clf 0.552, Loss_fe 0.795, Loss_kd 1.222, Train_accy 79.04:   5%|▌         | 1/20 [00:30<05:20, 16.85s/it]                 
Task 4, Epoch 2/20 => Loss 2.874, Loss_clf 0.552, Loss_fe 0.795, Loss_kd 1.222, Train_accy 79.04:  10%|█         | 2/20 [00:30<04:26, 14.80s/it]
Task 4, Epoch 3/20 => Loss 2.472, Loss_clf 0.415, Loss_fe 0.525, Loss_kd 1.226, Train_accy 79.28:  10%|█         | 2/20 [00:43<04:26, 14.80s/it]
Task 4, Epoch 3/20 => Loss 2.472, Loss_clf 0.415, Loss_fe 0.525, Loss_kd 1.226, Train_accy 79.28:  15%|█▌        | 3/20 [00:43<04:00, 14.14s/it]
Task 4, Epoch 4/20 => Loss 2.423, Loss_clf 0.411, Loss_fe 0.486, Loss_kd 1.222, Train_accy 79.12:  15%|█▌        | 3/20 [00:56<04:00, 14.14s/it]
Task 4, Epoch 4/20 => Loss 2.423, Loss_clf 0.411, Loss_fe 0.486, Loss_kd 1.222, Train_accy 79.12:  20%|██        | 4/20 [00:56<03:41, 13.85s/it]
Task 4, Epoch 5/20 => Loss 2.203, Loss_clf 0.330, Loss_fe 0.343, Loss_kd 1.224, Train_accy 83.29:  20%|██        | 4/20 [01:10<03:41, 13.85s/it]
Task 4, Epoch 5/20 => Loss 2.203, Loss_clf 0.330, Loss_fe 0.343, Loss_kd 1.224, Train_accy 83.29:  25%|██▌       | 5/20 [01:10<03:25, 13.67s/it]
Task 4, Epoch 6/20 => Loss 2.192, Loss_clf 0.333, Loss_fe 0.321, Loss_kd 1.231, Train_accy 84.48, Test_accy 89.13:  25%|██▌       | 5/20 [01:27<03:25, 13.67s/it]
Task 4, Epoch 6/20 => Loss 2.192, Loss_clf 0.333, Loss_fe 0.321, Loss_kd 1.231, Train_accy 84.48, Test_accy 89.13:  30%|███       | 6/20 [01:27<03:27, 14.82s/it]
Task 4, Epoch 7/20 => Loss 2.194, Loss_clf 0.342, Loss_fe 0.321, Loss_kd 1.225, Train_accy 82.51:  30%|███       | 6/20 [01:40<03:27, 14.82s/it]                 
Task 4, Epoch 7/20 => Loss 2.194, Loss_clf 0.342, Loss_fe 0.321, Loss_kd 1.225, Train_accy 82.51:  35%|███▌      | 7/20 [01:40<03:06, 14.37s/it]
Task 4, Epoch 8/20 => Loss 2.254, Loss_clf 0.377, Loss_fe 0.354, Loss_kd 1.219, Train_accy 81.80:  35%|███▌      | 7/20 [01:54<03:06, 14.37s/it]
Task 4, Epoch 8/20 => Loss 2.254, Loss_clf 0.377, Loss_fe 0.354, Loss_kd 1.219, Train_accy 81.80:  40%|████      | 8/20 [01:54<02:48, 14.08s/it]
Task 4, Epoch 9/20 => Loss 2.138, Loss_clf 0.318, Loss_fe 0.299, Loss_kd 1.217, Train_accy 84.95:  40%|████      | 8/20 [02:07<02:48, 14.08s/it]
Task 4, Epoch 9/20 => Loss 2.138, Loss_clf 0.318, Loss_fe 0.299, Loss_kd 1.217, Train_accy 84.95:  45%|████▌     | 9/20 [02:07<02:32, 13.87s/it]
Task 4, Epoch 10/20 => Loss 2.063, Loss_clf 0.289, Loss_fe 0.269, Loss_kd 1.203, Train_accy 84.00:  45%|████▌     | 9/20 [02:21<02:32, 13.87s/it]
Task 4, Epoch 10/20 => Loss 2.063, Loss_clf 0.289, Loss_fe 0.269, Loss_kd 1.203, Train_accy 84.00:  50%|█████     | 10/20 [02:21<02:17, 13.71s/it]
Task 4, Epoch 11/20 => Loss 2.093, Loss_clf 0.298, Loss_fe 0.254, Loss_kd 1.233, Train_accy 82.98, Test_accy 87.88:  50%|█████     | 10/20 [02:38<02:17, 13.71s/it]
Task 4, Epoch 11/20 => Loss 2.093, Loss_clf 0.298, Loss_fe 0.254, Loss_kd 1.233, Train_accy 82.98, Test_accy 87.88:  55%|█████▌    | 11/20 [02:38<02:12, 14.77s/it]
Task 4, Epoch 12/20 => Loss 2.159, Loss_clf 0.325, Loss_fe 0.294, Loss_kd 1.232, Train_accy 83.61:  55%|█████▌    | 11/20 [02:51<02:12, 14.77s/it]                 
Task 4, Epoch 12/20 => Loss 2.159, Loss_clf 0.325, Loss_fe 0.294, Loss_kd 1.232, Train_accy 83.61:  60%|██████    | 12/20 [02:51<01:54, 14.35s/it]
Task 4, Epoch 13/20 => Loss 2.051, Loss_clf 0.275, Loss_fe 0.226, Loss_kd 1.240, Train_accy 85.03:  60%|██████    | 12/20 [03:05<01:54, 14.35s/it]
Task 4, Epoch 13/20 => Loss 2.051, Loss_clf 0.275, Loss_fe 0.226, Loss_kd 1.240, Train_accy 85.03:  65%|██████▌   | 13/20 [03:05<01:38, 14.07s/it]
Task 4, Epoch 14/20 => Loss 2.019, Loss_clf 0.274, Loss_fe 0.231, Loss_kd 1.212, Train_accy 84.63:  65%|██████▌   | 13/20 [03:18<01:38, 14.07s/it]
Task 4, Epoch 14/20 => Loss 2.019, Loss_clf 0.274, Loss_fe 0.231, Loss_kd 1.212, Train_accy 84.63:  70%|███████   | 14/20 [03:18<01:23, 13.87s/it]
Task 4, Epoch 15/20 => Loss 2.002, Loss_clf 0.276, Loss_fe 0.222, Loss_kd 1.204, Train_accy 87.16:  70%|███████   | 14/20 [03:31<01:23, 13.87s/it]
Task 4, Epoch 15/20 => Loss 2.002, Loss_clf 0.276, Loss_fe 0.222, Loss_kd 1.204, Train_accy 87.16:  75%|███████▌  | 15/20 [03:31<01:08, 13.73s/it]
Task 4, Epoch 16/20 => Loss 1.954, Loss_clf 0.260, Loss_fe 0.197, Loss_kd 1.197, Train_accy 87.86, Test_accy 90.02:  75%|███████▌  | 15/20 [03:49<01:08, 13.73s/it]
Task 4, Epoch 16/20 => Loss 1.954, Loss_clf 0.260, Loss_fe 0.197, Loss_kd 1.197, Train_accy 87.86, Test_accy 90.02:  80%|████████  | 16/20 [03:49<00:59, 14.77s/it]
Task 4, Epoch 17/20 => Loss 2.035, Loss_clf 0.284, Loss_fe 0.227, Loss_kd 1.219, Train_accy 85.34:  80%|████████  | 16/20 [04:02<00:59, 14.77s/it]                 
Task 4, Epoch 17/20 => Loss 2.035, Loss_clf 0.284, Loss_fe 0.227, Loss_kd 1.219, Train_accy 85.34:  85%|████████▌ | 17/20 [04:02<00:43, 14.38s/it]
Task 4, Epoch 18/20 => Loss 2.010, Loss_clf 0.261, Loss_fe 0.213, Loss_kd 1.229, Train_accy 86.21:  85%|████████▌ | 17/20 [04:15<00:43, 14.38s/it]
Task 4, Epoch 18/20 => Loss 2.010, Loss_clf 0.261, Loss_fe 0.213, Loss_kd 1.229, Train_accy 86.21:  90%|█████████ | 18/20 [04:15<00:28, 14.10s/it]
Task 4, Epoch 19/20 => Loss 1.979, Loss_clf 0.263, Loss_fe 0.210, Loss_kd 1.204, Train_accy 85.34:  90%|█████████ | 18/20 [04:29<00:28, 14.10s/it]
Task 4, Epoch 19/20 => Loss 1.979, Loss_clf 0.263, Loss_fe 0.210, Loss_kd 1.204, Train_accy 85.34:  95%|█████████▌| 19/20 [04:29<00:13, 13.90s/it]
Task 4, Epoch 20/20 => Loss 2.016, Loss_clf 0.293, Loss_fe 0.204, Loss_kd 1.216, Train_accy 84.55:  95%|█████████▌| 19/20 [04:42<00:13, 13.90s/it]
Task 4, Epoch 20/20 => Loss 2.016, Loss_clf 0.293, Loss_fe 0.204, Loss_kd 1.216, Train_accy 84.55: 100%|██████████| 20/20 [04:42<00:00, 13.78s/it]
Task 4, Epoch 20/20 => Loss 2.016, Loss_clf 0.293, Loss_fe 0.204, Loss_kd 1.216, Train_accy 84.55: 100%|██████████| 20/20 [04:42<00:00, 14.14s/it]
2024-09-05 08:18:47,699 [foster.py] => Task 4, Epoch 20/20 => Loss 2.016, Loss_clf 0.293, Loss_fe 0.204, Loss_kd 1.216, Train_accy 84.55
2024-09-05 08:18:47,700 [foster.py] => do not weight align teacher!
2024-09-05 08:18:47,701 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.562,  Train_accy 64.70, Test_accy 83.24:   0%|          | 0/20 [00:18<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.562,  Train_accy 64.70, Test_accy 83.24:   5%|▌         | 1/20 [00:18<06:00, 18.96s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.290,  Train_accy 75.49:   5%|▌         | 1/20 [00:35<06:00, 18.96s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.290,  Train_accy 75.49:  10%|█         | 2/20 [00:35<05:17, 17.66s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.319,  Train_accy 75.02:  10%|█         | 2/20 [00:52<05:17, 17.66s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.319,  Train_accy 75.02:  15%|█▌        | 3/20 [00:52<04:53, 17.26s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.275,  Train_accy 76.44:  15%|█▌        | 3/20 [01:09<04:53, 17.26s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.275,  Train_accy 76.44:  20%|██        | 4/20 [01:09<04:33, 17.09s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.270,  Train_accy 77.07:  20%|██        | 4/20 [01:26<04:33, 17.09s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.270,  Train_accy 77.07:  25%|██▌       | 5/20 [01:26<04:15, 17.01s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.271,  Train_accy 77.46, Test_accy 86.45:  25%|██▌       | 5/20 [01:45<04:15, 17.01s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.271,  Train_accy 77.46, Test_accy 86.45:  30%|███       | 6/20 [01:45<04:07, 17.70s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.227,  Train_accy 77.78:  30%|███       | 6/20 [02:02<04:07, 17.70s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.227,  Train_accy 77.78:  35%|███▌      | 7/20 [02:02<03:46, 17.40s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.256,  Train_accy 78.25:  35%|███▌      | 7/20 [02:18<03:46, 17.40s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.256,  Train_accy 78.25:  40%|████      | 8/20 [02:18<03:26, 17.22s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.288,  Train_accy 77.38:  40%|████      | 8/20 [02:35<03:26, 17.22s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.288,  Train_accy 77.38:  45%|████▌     | 9/20 [02:35<03:08, 17.11s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.247,  Train_accy 78.49:  45%|████▌     | 9/20 [02:52<03:08, 17.11s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.247,  Train_accy 78.49:  50%|█████     | 10/20 [02:52<02:50, 17.04s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.264,  Train_accy 78.33, Test_accy 86.45:  50%|█████     | 10/20 [03:11<02:50, 17.04s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.264,  Train_accy 78.33, Test_accy 86.45:  55%|█████▌    | 11/20 [03:11<02:38, 17.65s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.222,  Train_accy 79.12:  55%|█████▌    | 11/20 [03:28<02:38, 17.65s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.222,  Train_accy 79.12:  60%|██████    | 12/20 [03:28<02:19, 17.40s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.246,  Train_accy 78.33:  60%|██████    | 12/20 [03:45<02:19, 17.40s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.246,  Train_accy 78.33:  65%|██████▌   | 13/20 [03:45<02:00, 17.23s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.235,  Train_accy 77.78:  65%|██████▌   | 13/20 [04:02<02:00, 17.23s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.235,  Train_accy 77.78:  70%|███████   | 14/20 [04:02<01:42, 17.11s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.213,  Train_accy 80.54:  70%|███████   | 14/20 [04:18<01:42, 17.11s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.213,  Train_accy 80.54:  75%|███████▌  | 15/20 [04:18<01:25, 17.03s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.256,  Train_accy 79.35, Test_accy 86.27:  75%|███████▌  | 15/20 [04:38<01:25, 17.03s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.256,  Train_accy 79.35, Test_accy 86.27:  80%|████████  | 16/20 [04:38<01:10, 17.63s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.225,  Train_accy 78.96:  80%|████████  | 16/20 [04:54<01:10, 17.63s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.225,  Train_accy 78.96:  85%|████████▌ | 17/20 [04:54<00:52, 17.38s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.201,  Train_accy 80.06:  85%|████████▌ | 17/20 [05:11<00:52, 17.38s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.201,  Train_accy 80.06:  90%|█████████ | 18/20 [05:11<00:34, 17.22s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.249,  Train_accy 78.96:  90%|█████████ | 18/20 [05:28<00:34, 17.22s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.249,  Train_accy 78.96:  95%|█████████▌| 19/20 [05:28<00:17, 17.10s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.265,  Train_accy 76.91:  95%|█████████▌| 19/20 [05:45<00:17, 17.10s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.265,  Train_accy 76.91: 100%|██████████| 20/20 [05:45<00:00, 17.02s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.265,  Train_accy 76.91: 100%|██████████| 20/20 [05:45<00:00, 17.27s/it]
2024-09-05 08:24:34,426 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.265,  Train_accy 76.91
2024-09-05 08:24:34,426 [foster.py] => do not weight align student!
2024-09-05 08:24:36,609 [foster.py] => darknet eval: 
2024-09-05 08:24:36,610 [foster.py] => CNN top1 curve: 86.27
2024-09-05 08:24:36,610 [foster.py] => CNN top5 curve: 98.57
2024-09-05 08:24:36,613 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 08:25:12,678 [foster.py] => Exemplar size: 1000
2024-09-05 08:25:12,678 [trainer.py] => CNN: {'total': 88.59, '00-09': 99.15, '10-19': 98.45, '20-29': 91.75, '30-39': 77.27, '40-49': 73.83, 'old': 92.07, 'new': 73.83}
2024-09-05 08:25:12,678 [trainer.py] => NME: {'total': 95.72, '00-09': 96.61, '10-19': 95.35, '20-29': 97.94, '30-39': 92.73, '40-49': 96.26, 'old': 95.59, 'new': 96.26}
2024-09-05 08:25:12,678 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59]
2024-09-05 08:25:12,678 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75]
2024-09-05 08:25:12,678 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72]
2024-09-05 08:25:12,678 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47]

Average Accuracy (CNN): 92.86
Average Accuracy (NME): 97.22
2024-09-05 08:25:12,678 [trainer.py] => Average Accuracy (CNN): 92.86
2024-09-05 08:25:12,678 [trainer.py] => Average Accuracy (NME): 97.22
2024-09-05 08:25:12,680 [trainer.py] => All params: 171743372
2024-09-05 08:25:12,681 [trainer.py] => Trainable params: 85913956
2024-09-05 08:25:14,137 [foster.py] => Learning on 50-60
2024-09-05 08:25:14,139 [foster.py] => All params: 171774122
2024-09-05 08:25:14,140 [foster.py] => Trainable params: 85937016
2024-09-05 08:25:14,186 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.487, Loss_clf 1.110, Loss_fe 2.887, Loss_kd 1.242, Train_accy 67.44, Test_accy 84.08:   0%|          | 0/20 [00:19<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.487, Loss_clf 1.110, Loss_fe 2.887, Loss_kd 1.242, Train_accy 67.44, Test_accy 84.08:   5%|▌         | 1/20 [00:19<06:13, 19.64s/it]
Task 5, Epoch 2/20 => Loss 2.763, Loss_clf 0.540, Loss_fe 0.777, Loss_kd 1.205, Train_accy 75.51:   5%|▌         | 1/20 [00:35<06:13, 19.64s/it]                 
Task 5, Epoch 2/20 => Loss 2.763, Loss_clf 0.540, Loss_fe 0.777, Loss_kd 1.205, Train_accy 75.51:  10%|█         | 2/20 [00:35<05:08, 17.14s/it]
Task 5, Epoch 3/20 => Loss 2.555, Loss_clf 0.540, Loss_fe 0.573, Loss_kd 1.201, Train_accy 75.98:  10%|█         | 2/20 [00:50<05:08, 17.14s/it]
Task 5, Epoch 3/20 => Loss 2.555, Loss_clf 0.540, Loss_fe 0.573, Loss_kd 1.201, Train_accy 75.98:  15%|█▌        | 3/20 [00:50<04:37, 16.33s/it]
Task 5, Epoch 4/20 => Loss 2.396, Loss_clf 0.445, Loss_fe 0.499, Loss_kd 1.209, Train_accy 74.97:  15%|█▌        | 3/20 [01:05<04:37, 16.33s/it]
Task 5, Epoch 4/20 => Loss 2.396, Loss_clf 0.445, Loss_fe 0.499, Loss_kd 1.209, Train_accy 74.97:  20%|██        | 4/20 [01:05<04:15, 15.95s/it]
Task 5, Epoch 5/20 => Loss 2.361, Loss_clf 0.436, Loss_fe 0.468, Loss_kd 1.213, Train_accy 76.73:  20%|██        | 4/20 [01:21<04:15, 15.95s/it]
Task 5, Epoch 5/20 => Loss 2.361, Loss_clf 0.436, Loss_fe 0.468, Loss_kd 1.213, Train_accy 76.73:  25%|██▌       | 5/20 [01:21<03:56, 15.79s/it]
Task 5, Epoch 6/20 => Loss 2.323, Loss_clf 0.435, Loss_fe 0.447, Loss_kd 1.201, Train_accy 75.37, Test_accy 86.01:  25%|██▌       | 5/20 [01:41<03:56, 15.79s/it]
Task 5, Epoch 6/20 => Loss 2.323, Loss_clf 0.435, Loss_fe 0.447, Loss_kd 1.201, Train_accy 75.37, Test_accy 86.01:  30%|███       | 6/20 [01:41<04:00, 17.15s/it]
Task 5, Epoch 7/20 => Loss 2.182, Loss_clf 0.353, Loss_fe 0.357, Loss_kd 1.228, Train_accy 77.20:  30%|███       | 6/20 [01:56<04:00, 17.15s/it]                 
Task 5, Epoch 7/20 => Loss 2.182, Loss_clf 0.353, Loss_fe 0.357, Loss_kd 1.228, Train_accy 77.20:  35%|███▌      | 7/20 [01:56<03:35, 16.59s/it]
Task 5, Epoch 8/20 => Loss 2.138, Loss_clf 0.347, Loss_fe 0.350, Loss_kd 1.201, Train_accy 77.41:  35%|███▌      | 7/20 [02:12<03:35, 16.59s/it]
Task 5, Epoch 8/20 => Loss 2.138, Loss_clf 0.347, Loss_fe 0.350, Loss_kd 1.201, Train_accy 77.41:  40%|████      | 8/20 [02:12<03:15, 16.26s/it]
Task 5, Epoch 9/20 => Loss 2.131, Loss_clf 0.357, Loss_fe 0.333, Loss_kd 1.201, Train_accy 77.95:  40%|████      | 8/20 [02:27<03:15, 16.26s/it]
Task 5, Epoch 9/20 => Loss 2.131, Loss_clf 0.357, Loss_fe 0.333, Loss_kd 1.201, Train_accy 77.95:  45%|████▌     | 9/20 [02:27<02:56, 16.01s/it]
Task 5, Epoch 10/20 => Loss 1.968, Loss_clf 0.282, Loss_fe 0.258, Loss_kd 1.190, Train_accy 80.12:  45%|████▌     | 9/20 [02:42<02:56, 16.01s/it]
Task 5, Epoch 10/20 => Loss 1.968, Loss_clf 0.282, Loss_fe 0.258, Loss_kd 1.190, Train_accy 80.12:  50%|█████     | 10/20 [02:42<02:38, 15.84s/it]
Task 5, Epoch 11/20 => Loss 2.065, Loss_clf 0.322, Loss_fe 0.283, Loss_kd 1.216, Train_accy 79.10, Test_accy 86.61:  50%|█████     | 10/20 [03:02<02:38, 15.84s/it]
Task 5, Epoch 11/20 => Loss 2.065, Loss_clf 0.322, Loss_fe 0.283, Loss_kd 1.216, Train_accy 79.10, Test_accy 86.61:  55%|█████▌    | 11/20 [03:02<02:33, 17.07s/it]
Task 5, Epoch 12/20 => Loss 2.036, Loss_clf 0.320, Loss_fe 0.274, Loss_kd 1.202, Train_accy 79.78:  55%|█████▌    | 11/20 [03:18<02:33, 17.07s/it]                 
Task 5, Epoch 12/20 => Loss 2.036, Loss_clf 0.320, Loss_fe 0.274, Loss_kd 1.202, Train_accy 79.78:  60%|██████    | 12/20 [03:18<02:12, 16.60s/it]
Task 5, Epoch 13/20 => Loss 2.025, Loss_clf 0.318, Loss_fe 0.267, Loss_kd 1.200, Train_accy 80.39:  60%|██████    | 12/20 [03:33<02:12, 16.60s/it]
Task 5, Epoch 13/20 => Loss 2.025, Loss_clf 0.318, Loss_fe 0.267, Loss_kd 1.200, Train_accy 80.39:  65%|██████▌   | 13/20 [03:33<01:53, 16.28s/it]
Task 5, Epoch 14/20 => Loss 1.983, Loss_clf 0.301, Loss_fe 0.240, Loss_kd 1.202, Train_accy 79.78:  65%|██████▌   | 13/20 [03:49<01:53, 16.28s/it]
Task 5, Epoch 14/20 => Loss 1.983, Loss_clf 0.301, Loss_fe 0.240, Loss_kd 1.202, Train_accy 79.78:  70%|███████   | 14/20 [03:49<01:36, 16.06s/it]
Task 5, Epoch 15/20 => Loss 1.988, Loss_clf 0.302, Loss_fe 0.243, Loss_kd 1.203, Train_accy 81.14:  70%|███████   | 14/20 [04:04<01:36, 16.06s/it]
Task 5, Epoch 15/20 => Loss 1.988, Loss_clf 0.302, Loss_fe 0.243, Loss_kd 1.203, Train_accy 81.14:  75%|███████▌  | 15/20 [04:04<01:19, 15.88s/it]
Task 5, Epoch 16/20 => Loss 1.914, Loss_clf 0.263, Loss_fe 0.225, Loss_kd 1.189, Train_accy 80.39, Test_accy 86.01:  75%|███████▌  | 15/20 [04:24<01:19, 15.88s/it]
Task 5, Epoch 16/20 => Loss 1.914, Loss_clf 0.263, Loss_fe 0.225, Loss_kd 1.189, Train_accy 80.39, Test_accy 86.01:  80%|████████  | 16/20 [04:24<01:08, 17.08s/it]
Task 5, Epoch 17/20 => Loss 1.950, Loss_clf 0.279, Loss_fe 0.235, Loss_kd 1.196, Train_accy 80.66:  80%|████████  | 16/20 [04:40<01:08, 17.08s/it]                 
Task 5, Epoch 17/20 => Loss 1.950, Loss_clf 0.279, Loss_fe 0.235, Loss_kd 1.196, Train_accy 80.66:  85%|████████▌ | 17/20 [04:40<00:49, 16.62s/it]
Task 5, Epoch 18/20 => Loss 1.902, Loss_clf 0.279, Loss_fe 0.201, Loss_kd 1.185, Train_accy 79.65:  85%|████████▌ | 17/20 [04:55<00:49, 16.62s/it]
Task 5, Epoch 18/20 => Loss 1.902, Loss_clf 0.279, Loss_fe 0.201, Loss_kd 1.185, Train_accy 79.65:  90%|█████████ | 18/20 [04:55<00:32, 16.30s/it]
Task 5, Epoch 19/20 => Loss 1.929, Loss_clf 0.285, Loss_fe 0.222, Loss_kd 1.186, Train_accy 79.99:  90%|█████████ | 18/20 [05:11<00:32, 16.30s/it]
Task 5, Epoch 19/20 => Loss 1.929, Loss_clf 0.285, Loss_fe 0.222, Loss_kd 1.186, Train_accy 79.99:  95%|█████████▌| 19/20 [05:11<00:16, 16.06s/it]
Task 5, Epoch 20/20 => Loss 1.977, Loss_clf 0.312, Loss_fe 0.230, Loss_kd 1.195, Train_accy 80.19:  95%|█████████▌| 19/20 [05:26<00:16, 16.06s/it]
Task 5, Epoch 20/20 => Loss 1.977, Loss_clf 0.312, Loss_fe 0.230, Loss_kd 1.195, Train_accy 80.19: 100%|██████████| 20/20 [05:26<00:00, 15.91s/it]
Task 5, Epoch 20/20 => Loss 1.977, Loss_clf 0.312, Loss_fe 0.230, Loss_kd 1.195, Train_accy 80.19: 100%|██████████| 20/20 [05:26<00:00, 16.35s/it]
2024-09-05 08:30:41,135 [foster.py] => Task 5, Epoch 20/20 => Loss 1.977, Loss_clf 0.312, Loss_fe 0.230, Loss_kd 1.195, Train_accy 80.19
2024-09-05 08:30:41,136 [foster.py] => do not weight align teacher!
2024-09-05 08:30:41,139 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.488,  Train_accy 65.88, Test_accy 83.63:   0%|          | 0/20 [00:21<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.488,  Train_accy 65.88, Test_accy 83.63:   5%|▌         | 1/20 [00:21<06:55, 21.89s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.341,  Train_accy 72.66:   5%|▌         | 1/20 [00:41<06:55, 21.89s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.341,  Train_accy 72.66:  10%|█         | 2/20 [00:41<06:07, 20.43s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.296,  Train_accy 72.18:  10%|█         | 2/20 [01:00<06:07, 20.43s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.296,  Train_accy 72.18:  15%|█▌        | 3/20 [01:00<05:39, 19.99s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.293,  Train_accy 73.88:  15%|█▌        | 3/20 [01:20<05:39, 19.99s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.293,  Train_accy 73.88:  20%|██        | 4/20 [01:20<05:16, 19.79s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.272,  Train_accy 74.56:  20%|██        | 4/20 [01:39<05:16, 19.79s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.272,  Train_accy 74.56:  25%|██▌       | 5/20 [01:39<04:54, 19.65s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.280,  Train_accy 75.31, Test_accy 85.71:  25%|██▌       | 5/20 [02:01<04:54, 19.65s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.280,  Train_accy 75.31, Test_accy 85.71:  30%|███       | 6/20 [02:01<04:46, 20.46s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.271,  Train_accy 75.92:  30%|███       | 6/20 [02:21<04:46, 20.46s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.271,  Train_accy 75.92:  35%|███▌      | 7/20 [02:21<04:21, 20.12s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.287,  Train_accy 74.97:  35%|███▌      | 7/20 [02:40<04:21, 20.12s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.287,  Train_accy 74.97:  40%|████      | 8/20 [02:40<03:59, 19.92s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.285,  Train_accy 73.41:  40%|████      | 8/20 [03:00<03:59, 19.92s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.285,  Train_accy 73.41:  45%|████▌     | 9/20 [03:00<03:37, 19.79s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.247,  Train_accy 74.42:  45%|████▌     | 9/20 [03:19<03:37, 19.79s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.247,  Train_accy 74.42:  50%|█████     | 10/20 [03:19<03:16, 19.69s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.261,  Train_accy 74.90, Test_accy 84.82:  50%|█████     | 10/20 [03:41<03:16, 19.69s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.261,  Train_accy 74.90, Test_accy 84.82:  55%|█████▌    | 11/20 [03:41<03:03, 20.37s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.269,  Train_accy 74.76:  55%|█████▌    | 11/20 [04:00<03:03, 20.37s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.269,  Train_accy 74.76:  60%|██████    | 12/20 [04:00<02:40, 20.08s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.310,  Train_accy 75.98:  60%|██████    | 12/20 [04:20<02:40, 20.08s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.310,  Train_accy 75.98:  65%|██████▌   | 13/20 [04:20<02:19, 19.90s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.283,  Train_accy 74.63:  65%|██████▌   | 13/20 [04:39<02:19, 19.90s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.283,  Train_accy 74.63:  70%|███████   | 14/20 [04:39<01:58, 19.77s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.285,  Train_accy 75.37:  70%|███████   | 14/20 [04:59<01:58, 19.77s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.285,  Train_accy 75.37:  75%|███████▌  | 15/20 [04:59<01:38, 19.67s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.274,  Train_accy 73.81, Test_accy 85.57:  75%|███████▌  | 15/20 [05:21<01:38, 19.67s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.274,  Train_accy 73.81, Test_accy 85.57:  80%|████████  | 16/20 [05:21<01:21, 20.35s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.261,  Train_accy 75.03:  80%|████████  | 16/20 [05:40<01:21, 20.35s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.261,  Train_accy 75.03:  85%|████████▌ | 17/20 [05:40<01:00, 20.08s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.261,  Train_accy 73.20:  85%|████████▌ | 17/20 [06:00<01:00, 20.08s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.261,  Train_accy 73.20:  90%|█████████ | 18/20 [06:00<00:39, 19.89s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.251,  Train_accy 74.76:  90%|█████████ | 18/20 [06:19<00:39, 19.89s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.251,  Train_accy 74.76:  95%|█████████▌| 19/20 [06:19<00:19, 19.76s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.283,  Train_accy 75.10:  95%|█████████▌| 19/20 [06:39<00:19, 19.76s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.283,  Train_accy 75.10: 100%|██████████| 20/20 [06:39<00:00, 19.67s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.283,  Train_accy 75.10: 100%|██████████| 20/20 [06:39<00:00, 19.95s/it]
2024-09-05 08:37:21,632 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.283,  Train_accy 75.10
2024-09-05 08:37:21,633 [foster.py] => do not weight align student!
2024-09-05 08:37:24,126 [foster.py] => darknet eval: 
2024-09-05 08:37:24,126 [foster.py] => CNN top1 curve: 85.27
2024-09-05 08:37:24,126 [foster.py] => CNN top5 curve: 98.36
2024-09-05 08:37:24,129 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 08:38:05,745 [foster.py] => Exemplar size: 1200
2024-09-05 08:38:05,745 [trainer.py] => CNN: {'total': 86.01, '00-09': 99.15, '10-19': 98.45, '20-29': 94.85, '30-39': 83.64, '40-49': 86.92, '50-59': 51.35, 'old': 92.87, 'new': 51.35}
2024-09-05 08:38:05,745 [trainer.py] => NME: {'total': 93.3, '00-09': 88.98, '10-19': 95.35, '20-29': 96.91, '30-39': 91.82, '40-49': 95.33, '50-59': 91.89, 'old': 93.58, 'new': 91.89}
2024-09-05 08:38:05,745 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01]
2024-09-05 08:38:05,745 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66]
2024-09-05 08:38:05,745 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3]
2024-09-05 08:38:05,745 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4]

Average Accuracy (CNN): 91.71
Average Accuracy (NME): 96.57
2024-09-05 08:38:05,745 [trainer.py] => Average Accuracy (CNN): 91.71
2024-09-05 08:38:05,745 [trainer.py] => Average Accuracy (NME): 96.57
2024-09-05 08:38:05,747 [trainer.py] => All params: 171774122
2024-09-05 08:38:05,748 [trainer.py] => Trainable params: 85937016
2024-09-05 08:38:07,137 [foster.py] => Learning on 60-70
2024-09-05 08:38:07,139 [foster.py] => All params: 171804872
2024-09-05 08:38:07,140 [foster.py] => Trainable params: 85960076
2024-09-05 08:38:07,185 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 5.525, Loss_clf 1.154, Loss_fe 2.883, Loss_kd 1.276, Train_accy 67.34, Test_accy 83.42:   0%|          | 0/20 [00:22<?, ?it/s]
Task 6, Epoch 1/20 => Loss 5.525, Loss_clf 1.154, Loss_fe 2.883, Loss_kd 1.276, Train_accy 67.34, Test_accy 83.42:   5%|▌         | 1/20 [00:22<07:05, 22.37s/it]
Task 6, Epoch 2/20 => Loss 3.085, Loss_clf 0.701, Loss_fe 0.881, Loss_kd 1.288, Train_accy 71.49:   5%|▌         | 1/20 [00:39<07:05, 22.37s/it]                 
Task 6, Epoch 2/20 => Loss 3.085, Loss_clf 0.701, Loss_fe 0.881, Loss_kd 1.288, Train_accy 71.49:  10%|█         | 2/20 [00:39<05:51, 19.51s/it]
Task 6, Epoch 3/20 => Loss 2.569, Loss_clf 0.499, Loss_fe 0.595, Loss_kd 1.265, Train_accy 71.72:  10%|█         | 2/20 [00:57<05:51, 19.51s/it]
Task 6, Epoch 3/20 => Loss 2.569, Loss_clf 0.499, Loss_fe 0.595, Loss_kd 1.265, Train_accy 71.72:  15%|█▌        | 3/20 [00:57<05:16, 18.63s/it]
Task 6, Epoch 4/20 => Loss 2.506, Loss_clf 0.501, Loss_fe 0.530, Loss_kd 1.264, Train_accy 73.15:  15%|█▌        | 3/20 [01:15<05:16, 18.63s/it]
Task 6, Epoch 4/20 => Loss 2.506, Loss_clf 0.501, Loss_fe 0.530, Loss_kd 1.264, Train_accy 73.15:  20%|██        | 4/20 [01:15<04:51, 18.21s/it]
Task 6, Epoch 5/20 => Loss 2.623, Loss_clf 0.511, Loss_fe 0.571, Loss_kd 1.321, Train_accy 72.14:  20%|██        | 4/20 [01:32<04:51, 18.21s/it]
Task 6, Epoch 5/20 => Loss 2.623, Loss_clf 0.511, Loss_fe 0.571, Loss_kd 1.321, Train_accy 72.14:  25%|██▌       | 5/20 [01:32<04:30, 18.01s/it]
Task 6, Epoch 6/20 => Loss 2.392, Loss_clf 0.460, Loss_fe 0.452, Loss_kd 1.268, Train_accy 73.27, Test_accy 83.93:  25%|██▌       | 5/20 [01:55<04:30, 18.01s/it]
Task 6, Epoch 6/20 => Loss 2.392, Loss_clf 0.460, Loss_fe 0.452, Loss_kd 1.268, Train_accy 73.27, Test_accy 83.93:  30%|███       | 6/20 [01:55<04:33, 19.53s/it]
Task 6, Epoch 7/20 => Loss 2.324, Loss_clf 0.400, Loss_fe 0.420, Loss_kd 1.289, Train_accy 74.87:  30%|███       | 6/20 [02:12<04:33, 19.53s/it]                 
Task 6, Epoch 7/20 => Loss 2.324, Loss_clf 0.400, Loss_fe 0.420, Loss_kd 1.289, Train_accy 74.87:  35%|███▌      | 7/20 [02:12<04:06, 18.93s/it]
Task 6, Epoch 8/20 => Loss 2.199, Loss_clf 0.363, Loss_fe 0.363, Loss_kd 1.263, Train_accy 75.34:  35%|███▌      | 7/20 [02:30<04:06, 18.93s/it]
Task 6, Epoch 8/20 => Loss 2.199, Loss_clf 0.363, Loss_fe 0.363, Loss_kd 1.263, Train_accy 75.34:  40%|████      | 8/20 [02:30<03:42, 18.52s/it]
Task 6, Epoch 9/20 => Loss 2.270, Loss_clf 0.399, Loss_fe 0.377, Loss_kd 1.281, Train_accy 75.40:  40%|████      | 8/20 [02:48<03:42, 18.52s/it]
Task 6, Epoch 9/20 => Loss 2.270, Loss_clf 0.399, Loss_fe 0.377, Loss_kd 1.281, Train_accy 75.40:  45%|████▌     | 9/20 [02:48<03:20, 18.27s/it]
Task 6, Epoch 10/20 => Loss 2.252, Loss_clf 0.384, Loss_fe 0.366, Loss_kd 1.287, Train_accy 73.38:  45%|████▌     | 9/20 [03:05<03:20, 18.27s/it]
Task 6, Epoch 10/20 => Loss 2.252, Loss_clf 0.384, Loss_fe 0.366, Loss_kd 1.287, Train_accy 73.38:  50%|█████     | 10/20 [03:05<03:00, 18.08s/it]
Task 6, Epoch 11/20 => Loss 2.187, Loss_clf 0.347, Loss_fe 0.330, Loss_kd 1.295, Train_accy 76.64, Test_accy 84.45:  50%|█████     | 10/20 [03:28<03:00, 18.08s/it]
Task 6, Epoch 11/20 => Loss 2.187, Loss_clf 0.347, Loss_fe 0.330, Loss_kd 1.295, Train_accy 76.64, Test_accy 84.45:  55%|█████▌    | 11/20 [03:28<02:55, 19.47s/it]
Task 6, Epoch 12/20 => Loss 2.065, Loss_clf 0.339, Loss_fe 0.279, Loss_kd 1.241, Train_accy 77.53:  55%|█████▌    | 11/20 [03:46<02:55, 19.47s/it]                 
Task 6, Epoch 12/20 => Loss 2.065, Loss_clf 0.339, Loss_fe 0.279, Loss_kd 1.241, Train_accy 77.53:  60%|██████    | 12/20 [03:46<02:31, 18.96s/it]
Task 6, Epoch 13/20 => Loss 2.148, Loss_clf 0.372, Loss_fe 0.299, Loss_kd 1.266, Train_accy 74.75:  60%|██████    | 12/20 [04:03<02:31, 18.96s/it]
Task 6, Epoch 13/20 => Loss 2.148, Loss_clf 0.372, Loss_fe 0.299, Loss_kd 1.266, Train_accy 74.75:  65%|██████▌   | 13/20 [04:03<02:09, 18.57s/it]
Task 6, Epoch 14/20 => Loss 2.159, Loss_clf 0.359, Loss_fe 0.312, Loss_kd 1.276, Train_accy 76.59:  65%|██████▌   | 13/20 [04:21<02:09, 18.57s/it]
Task 6, Epoch 14/20 => Loss 2.159, Loss_clf 0.359, Loss_fe 0.312, Loss_kd 1.276, Train_accy 76.59:  70%|███████   | 14/20 [04:21<01:49, 18.32s/it]
Task 6, Epoch 15/20 => Loss 2.070, Loss_clf 0.317, Loss_fe 0.291, Loss_kd 1.253, Train_accy 76.47:  70%|███████   | 14/20 [04:39<01:49, 18.32s/it]
Task 6, Epoch 15/20 => Loss 2.070, Loss_clf 0.317, Loss_fe 0.291, Loss_kd 1.253, Train_accy 76.47:  75%|███████▌  | 15/20 [04:39<01:30, 18.13s/it]
Task 6, Epoch 16/20 => Loss 2.087, Loss_clf 0.327, Loss_fe 0.259, Loss_kd 1.286, Train_accy 76.70, Test_accy 85.22:  75%|███████▌  | 15/20 [05:02<01:30, 18.13s/it]
Task 6, Epoch 16/20 => Loss 2.087, Loss_clf 0.327, Loss_fe 0.259, Loss_kd 1.286, Train_accy 76.70, Test_accy 85.22:  80%|████████  | 16/20 [05:02<01:17, 19.48s/it]
Task 6, Epoch 17/20 => Loss 2.091, Loss_clf 0.327, Loss_fe 0.264, Loss_kd 1.286, Train_accy 77.24:  80%|████████  | 16/20 [05:19<01:17, 19.48s/it]                 
Task 6, Epoch 17/20 => Loss 2.091, Loss_clf 0.327, Loss_fe 0.264, Loss_kd 1.286, Train_accy 77.24:  85%|████████▌ | 17/20 [05:19<00:56, 18.96s/it]
Task 6, Epoch 18/20 => Loss 2.127, Loss_clf 0.362, Loss_fe 0.288, Loss_kd 1.267, Train_accy 75.82:  85%|████████▌ | 17/20 [05:37<00:56, 18.96s/it]
Task 6, Epoch 18/20 => Loss 2.127, Loss_clf 0.362, Loss_fe 0.288, Loss_kd 1.267, Train_accy 75.82:  90%|█████████ | 18/20 [05:37<00:37, 18.58s/it]
Task 6, Epoch 19/20 => Loss 1.960, Loss_clf 0.293, Loss_fe 0.228, Loss_kd 1.233, Train_accy 77.53:  90%|█████████ | 18/20 [05:55<00:37, 18.58s/it]
Task 6, Epoch 19/20 => Loss 1.960, Loss_clf 0.293, Loss_fe 0.228, Loss_kd 1.233, Train_accy 77.53:  95%|█████████▌| 19/20 [05:55<00:18, 18.31s/it]
Task 6, Epoch 20/20 => Loss 2.026, Loss_clf 0.299, Loss_fe 0.251, Loss_kd 1.265, Train_accy 77.18:  95%|█████████▌| 19/20 [06:12<00:18, 18.31s/it]
Task 6, Epoch 20/20 => Loss 2.026, Loss_clf 0.299, Loss_fe 0.251, Loss_kd 1.265, Train_accy 77.18: 100%|██████████| 20/20 [06:12<00:00, 18.14s/it]
Task 6, Epoch 20/20 => Loss 2.026, Loss_clf 0.299, Loss_fe 0.251, Loss_kd 1.265, Train_accy 77.18: 100%|██████████| 20/20 [06:12<00:00, 18.64s/it]
2024-09-05 08:44:20,080 [foster.py] => Task 6, Epoch 20/20 => Loss 2.026, Loss_clf 0.299, Loss_fe 0.251, Loss_kd 1.265, Train_accy 77.18
2024-09-05 08:44:20,081 [foster.py] => do not weight align teacher!
2024-09-05 08:44:20,084 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.467,  Train_accy 65.68, Test_accy 81.36:   0%|          | 0/20 [00:24<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.467,  Train_accy 65.68, Test_accy 81.36:   5%|▌         | 1/20 [00:24<07:54, 24.99s/it]
SNet: Task 6, Epoch 2/20 => Loss 1.394,  Train_accy 68.70:   5%|▌         | 1/20 [00:47<07:54, 24.99s/it]                 
SNet: Task 6, Epoch 2/20 => Loss 1.394,  Train_accy 68.70:  10%|█         | 2/20 [00:47<07:00, 23.37s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.350,  Train_accy 70.66:  10%|█         | 2/20 [01:09<07:00, 23.37s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.350,  Train_accy 70.66:  15%|█▌        | 3/20 [01:09<06:28, 22.83s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.367,  Train_accy 70.18:  15%|█▌        | 3/20 [01:31<06:28, 22.83s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.367,  Train_accy 70.18:  20%|██        | 4/20 [01:31<06:01, 22.59s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.369,  Train_accy 70.12:  20%|██        | 4/20 [01:53<06:01, 22.59s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.369,  Train_accy 70.12:  25%|██▌       | 5/20 [01:53<05:36, 22.46s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.370,  Train_accy 70.36, Test_accy 81.11:  25%|██▌       | 5/20 [02:18<05:36, 22.46s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.370,  Train_accy 70.36, Test_accy 81.11:  30%|███       | 6/20 [02:18<05:26, 23.32s/it]
SNet: Task 6, Epoch 7/20 => Loss 1.357,  Train_accy 70.84:  30%|███       | 6/20 [02:41<05:26, 23.32s/it]                 
SNet: Task 6, Epoch 7/20 => Loss 1.357,  Train_accy 70.84:  35%|███▌      | 7/20 [02:41<04:58, 22.95s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.319,  Train_accy 71.67:  35%|███▌      | 7/20 [03:03<04:58, 22.95s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.319,  Train_accy 71.67:  40%|████      | 8/20 [03:03<04:32, 22.70s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.339,  Train_accy 70.84:  40%|████      | 8/20 [03:25<04:32, 22.70s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.339,  Train_accy 70.84:  45%|████▌     | 9/20 [03:25<04:08, 22.55s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.342,  Train_accy 71.25:  45%|████▌     | 9/20 [03:47<04:08, 22.55s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.342,  Train_accy 71.25:  50%|█████     | 10/20 [03:47<03:44, 22.45s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.357,  Train_accy 70.36, Test_accy 82.65:  50%|█████     | 10/20 [04:12<03:44, 22.45s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.357,  Train_accy 70.36, Test_accy 82.65:  55%|█████▌    | 11/20 [04:12<03:29, 23.24s/it]
SNet: Task 6, Epoch 12/20 => Loss 1.371,  Train_accy 70.90:  55%|█████▌    | 11/20 [04:34<03:29, 23.24s/it]                 
SNet: Task 6, Epoch 12/20 => Loss 1.371,  Train_accy 70.90:  60%|██████    | 12/20 [04:34<03:03, 22.92s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.354,  Train_accy 70.78:  60%|██████    | 12/20 [04:57<03:03, 22.92s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.354,  Train_accy 70.78:  65%|██████▌   | 13/20 [04:57<02:38, 22.70s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.365,  Train_accy 70.48:  65%|██████▌   | 13/20 [05:19<02:38, 22.70s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.365,  Train_accy 70.48:  70%|███████   | 14/20 [05:19<02:15, 22.54s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.318,  Train_accy 71.78:  70%|███████   | 14/20 [05:41<02:15, 22.54s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.318,  Train_accy 71.78:  75%|███████▌  | 15/20 [05:41<01:52, 22.43s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.336,  Train_accy 71.90, Test_accy 82.65:  75%|███████▌  | 15/20 [06:06<01:52, 22.43s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.336,  Train_accy 71.90, Test_accy 82.65:  80%|████████  | 16/20 [06:06<01:32, 23.23s/it]
SNet: Task 6, Epoch 17/20 => Loss 1.343,  Train_accy 71.19:  80%|████████  | 16/20 [06:28<01:32, 23.23s/it]                 
SNet: Task 6, Epoch 17/20 => Loss 1.343,  Train_accy 71.19:  85%|████████▌ | 17/20 [06:28<01:08, 22.95s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.325,  Train_accy 72.20:  85%|████████▌ | 17/20 [06:50<01:08, 22.95s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.325,  Train_accy 72.20:  90%|█████████ | 18/20 [06:50<00:45, 22.73s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.338,  Train_accy 71.13:  90%|█████████ | 18/20 [07:13<00:45, 22.73s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.338,  Train_accy 71.13:  95%|█████████▌| 19/20 [07:13<00:22, 22.58s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.357,  Train_accy 71.67:  95%|█████████▌| 19/20 [07:35<00:22, 22.58s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.357,  Train_accy 71.67: 100%|██████████| 20/20 [07:35<00:00, 22.46s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.357,  Train_accy 71.67: 100%|██████████| 20/20 [07:35<00:00, 22.77s/it]
2024-09-05 08:51:56,961 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.357,  Train_accy 71.67
2024-09-05 08:51:56,961 [foster.py] => do not weight align student!
2024-09-05 08:51:59,764 [foster.py] => darknet eval: 
2024-09-05 08:51:59,765 [foster.py] => CNN top1 curve: 82.52
2024-09-05 08:51:59,765 [foster.py] => CNN top5 curve: 97.56
2024-09-05 08:51:59,768 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 08:52:47,042 [foster.py] => Exemplar size: 1400
2024-09-05 08:52:47,042 [trainer.py] => CNN: {'total': 84.7, '00-09': 96.61, '10-19': 98.45, '20-29': 96.91, '30-39': 89.09, '40-49': 93.46, '50-59': 74.77, '60-69': 40.57, 'old': 91.67, 'new': 40.57}
2024-09-05 08:52:47,042 [trainer.py] => NME: {'total': 92.54, '00-09': 90.68, '10-19': 92.25, '20-29': 97.94, '30-39': 88.18, '40-49': 95.33, '50-59': 90.09, '60-69': 94.34, 'old': 92.26, 'new': 94.34}
2024-09-05 08:52:47,042 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7]
2024-09-05 08:52:47,042 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71]
2024-09-05 08:52:47,042 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54]
2024-09-05 08:52:47,042 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23]

Average Accuracy (CNN): 90.71
Average Accuracy (NME): 95.99
2024-09-05 08:52:47,042 [trainer.py] => Average Accuracy (CNN): 90.71
2024-09-05 08:52:47,042 [trainer.py] => Average Accuracy (NME): 95.99
2024-09-05 08:52:47,043 [trainer.py] => All params: 171804872
2024-09-05 08:52:47,044 [trainer.py] => Trainable params: 85960076
2024-09-05 08:52:48,568 [foster.py] => Learning on 70-80
2024-09-05 08:52:48,570 [foster.py] => All params: 171835622
2024-09-05 08:52:48,571 [foster.py] => Trainable params: 85983136
2024-09-05 08:52:48,617 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 5.563, Loss_clf 1.040, Loss_fe 2.943, Loss_kd 1.383, Train_accy 71.44, Test_accy 81.94:   0%|          | 0/20 [00:24<?, ?it/s]
Task 7, Epoch 1/20 => Loss 5.563, Loss_clf 1.040, Loss_fe 2.943, Loss_kd 1.383, Train_accy 71.44, Test_accy 81.94:   5%|▌         | 1/20 [00:24<07:49, 24.70s/it]
Task 7, Epoch 2/20 => Loss 2.972, Loss_clf 0.543, Loss_fe 0.850, Loss_kd 1.381, Train_accy 75.04:   5%|▌         | 1/20 [00:43<07:49, 24.70s/it]                 
Task 7, Epoch 2/20 => Loss 2.972, Loss_clf 0.543, Loss_fe 0.850, Loss_kd 1.381, Train_accy 75.04:  10%|█         | 2/20 [00:43<06:26, 21.49s/it]
Task 7, Epoch 3/20 => Loss 2.668, Loss_clf 0.462, Loss_fe 0.635, Loss_kd 1.375, Train_accy 76.98:  10%|█         | 2/20 [01:03<06:26, 21.49s/it]
Task 7, Epoch 3/20 => Loss 2.668, Loss_clf 0.462, Loss_fe 0.635, Loss_kd 1.375, Train_accy 76.98:  15%|█▌        | 3/20 [01:03<05:48, 20.48s/it]
Task 7, Epoch 4/20 => Loss 2.519, Loss_clf 0.449, Loss_fe 0.518, Loss_kd 1.358, Train_accy 78.70:  15%|█▌        | 3/20 [01:22<05:48, 20.48s/it]
Task 7, Epoch 4/20 => Loss 2.519, Loss_clf 0.449, Loss_fe 0.518, Loss_kd 1.358, Train_accy 78.70:  20%|██        | 4/20 [01:22<05:20, 20.04s/it]
Task 7, Epoch 5/20 => Loss 2.429, Loss_clf 0.418, Loss_fe 0.471, Loss_kd 1.347, Train_accy 79.99:  20%|██        | 4/20 [01:41<05:20, 20.04s/it]
Task 7, Epoch 5/20 => Loss 2.429, Loss_clf 0.418, Loss_fe 0.471, Loss_kd 1.347, Train_accy 79.99:  25%|██▌       | 5/20 [01:41<04:56, 19.79s/it]
Task 7, Epoch 6/20 => Loss 2.346, Loss_clf 0.383, Loss_fe 0.425, Loss_kd 1.346, Train_accy 81.01, Test_accy 82.81:  25%|██▌       | 5/20 [02:07<04:56, 19.79s/it]
Task 7, Epoch 6/20 => Loss 2.346, Loss_clf 0.383, Loss_fe 0.425, Loss_kd 1.346, Train_accy 81.01, Test_accy 82.81:  30%|███       | 6/20 [02:07<05:02, 21.59s/it]
Task 7, Epoch 7/20 => Loss 2.391, Loss_clf 0.409, Loss_fe 0.434, Loss_kd 1.354, Train_accy 79.07:  30%|███       | 6/20 [02:26<05:02, 21.59s/it]                 
Task 7, Epoch 7/20 => Loss 2.391, Loss_clf 0.409, Loss_fe 0.434, Loss_kd 1.354, Train_accy 79.07:  35%|███▌      | 7/20 [02:26<04:31, 20.89s/it]
Task 7, Epoch 8/20 => Loss 2.260, Loss_clf 0.349, Loss_fe 0.383, Loss_kd 1.337, Train_accy 81.71:  35%|███▌      | 7/20 [02:45<04:31, 20.89s/it]
Task 7, Epoch 8/20 => Loss 2.260, Loss_clf 0.349, Loss_fe 0.383, Loss_kd 1.337, Train_accy 81.71:  40%|████      | 8/20 [02:45<04:05, 20.42s/it]
Task 7, Epoch 9/20 => Loss 2.273, Loss_clf 0.369, Loss_fe 0.356, Loss_kd 1.354, Train_accy 81.76:  40%|████      | 8/20 [03:05<04:05, 20.42s/it]
Task 7, Epoch 9/20 => Loss 2.273, Loss_clf 0.369, Loss_fe 0.356, Loss_kd 1.354, Train_accy 81.76:  45%|████▌     | 9/20 [03:05<03:41, 20.11s/it]
Task 7, Epoch 10/20 => Loss 2.189, Loss_clf 0.340, Loss_fe 0.312, Loss_kd 1.344, Train_accy 82.30:  45%|████▌     | 9/20 [03:24<03:41, 20.11s/it]
Task 7, Epoch 10/20 => Loss 2.189, Loss_clf 0.340, Loss_fe 0.312, Loss_kd 1.344, Train_accy 82.30:  50%|█████     | 10/20 [03:24<03:18, 19.89s/it]
Task 7, Epoch 11/20 => Loss 2.227, Loss_clf 0.365, Loss_fe 0.317, Loss_kd 1.351, Train_accy 80.96, Test_accy 82.59:  50%|█████     | 10/20 [03:49<03:18, 19.89s/it]
Task 7, Epoch 11/20 => Loss 2.227, Loss_clf 0.365, Loss_fe 0.317, Loss_kd 1.351, Train_accy 80.96, Test_accy 82.59:  55%|█████▌    | 11/20 [03:49<03:13, 21.51s/it]
Task 7, Epoch 12/20 => Loss 2.102, Loss_clf 0.307, Loss_fe 0.284, Loss_kd 1.323, Train_accy 83.00:  55%|█████▌    | 11/20 [04:09<03:13, 21.51s/it]                 
Task 7, Epoch 12/20 => Loss 2.102, Loss_clf 0.307, Loss_fe 0.284, Loss_kd 1.323, Train_accy 83.00:  60%|██████    | 12/20 [04:09<02:47, 20.88s/it]
Task 7, Epoch 13/20 => Loss 2.157, Loss_clf 0.338, Loss_fe 0.290, Loss_kd 1.338, Train_accy 82.68:  60%|██████    | 12/20 [04:28<02:47, 20.88s/it]
Task 7, Epoch 13/20 => Loss 2.157, Loss_clf 0.338, Loss_fe 0.290, Loss_kd 1.338, Train_accy 82.68:  65%|██████▌   | 13/20 [04:28<02:23, 20.45s/it]
Task 7, Epoch 14/20 => Loss 2.107, Loss_clf 0.320, Loss_fe 0.264, Loss_kd 1.332, Train_accy 82.36:  65%|██████▌   | 13/20 [04:48<02:23, 20.45s/it]
Task 7, Epoch 14/20 => Loss 2.107, Loss_clf 0.320, Loss_fe 0.264, Loss_kd 1.332, Train_accy 82.36:  70%|███████   | 14/20 [04:48<02:00, 20.14s/it]
Task 7, Epoch 15/20 => Loss 2.107, Loss_clf 0.340, Loss_fe 0.259, Loss_kd 1.320, Train_accy 83.43:  70%|███████   | 14/20 [05:07<02:00, 20.14s/it]
Task 7, Epoch 15/20 => Loss 2.107, Loss_clf 0.340, Loss_fe 0.259, Loss_kd 1.320, Train_accy 83.43:  75%|███████▌  | 15/20 [05:07<01:39, 19.92s/it]
Task 7, Epoch 16/20 => Loss 2.139, Loss_clf 0.324, Loss_fe 0.262, Loss_kd 1.358, Train_accy 83.38, Test_accy 83.57:  75%|███████▌  | 15/20 [05:32<01:39, 19.92s/it]
Task 7, Epoch 16/20 => Loss 2.139, Loss_clf 0.324, Loss_fe 0.262, Loss_kd 1.358, Train_accy 83.38, Test_accy 83.57:  80%|████████  | 16/20 [05:32<01:26, 21.50s/it]
Task 7, Epoch 17/20 => Loss 2.209, Loss_clf 0.362, Loss_fe 0.295, Loss_kd 1.359, Train_accy 82.73:  80%|████████  | 16/20 [05:52<01:26, 21.50s/it]                 
Task 7, Epoch 17/20 => Loss 2.209, Loss_clf 0.362, Loss_fe 0.295, Loss_kd 1.359, Train_accy 82.73:  85%|████████▌ | 17/20 [05:52<01:02, 20.89s/it]
Task 7, Epoch 18/20 => Loss 2.063, Loss_clf 0.303, Loss_fe 0.233, Loss_kd 1.336, Train_accy 82.73:  85%|████████▌ | 17/20 [06:11<01:02, 20.89s/it]
Task 7, Epoch 18/20 => Loss 2.063, Loss_clf 0.303, Loss_fe 0.233, Loss_kd 1.336, Train_accy 82.73:  90%|█████████ | 18/20 [06:11<00:40, 20.47s/it]
Task 7, Epoch 19/20 => Loss 2.080, Loss_clf 0.322, Loss_fe 0.241, Loss_kd 1.327, Train_accy 82.79:  90%|█████████ | 18/20 [06:31<00:40, 20.47s/it]
Task 7, Epoch 19/20 => Loss 2.080, Loss_clf 0.322, Loss_fe 0.241, Loss_kd 1.327, Train_accy 82.79:  95%|█████████▌| 19/20 [06:31<00:20, 20.17s/it]
Task 7, Epoch 20/20 => Loss 2.179, Loss_clf 0.352, Loss_fe 0.278, Loss_kd 1.355, Train_accy 81.60:  95%|█████████▌| 19/20 [06:50<00:20, 20.17s/it]
Task 7, Epoch 20/20 => Loss 2.179, Loss_clf 0.352, Loss_fe 0.278, Loss_kd 1.355, Train_accy 81.60: 100%|██████████| 20/20 [06:50<00:00, 19.97s/it]
Task 7, Epoch 20/20 => Loss 2.179, Loss_clf 0.352, Loss_fe 0.278, Loss_kd 1.355, Train_accy 81.60: 100%|██████████| 20/20 [06:50<00:00, 20.54s/it]
2024-09-05 08:59:39,343 [foster.py] => Task 7, Epoch 20/20 => Loss 2.179, Loss_clf 0.352, Loss_fe 0.278, Loss_kd 1.355, Train_accy 81.60
2024-09-05 08:59:39,344 [foster.py] => do not weight align teacher!
2024-09-05 08:59:39,347 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.507,  Train_accy 70.52, Test_accy 81.28:   0%|          | 0/20 [00:27<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.507,  Train_accy 70.52, Test_accy 81.28:   5%|▌         | 1/20 [00:27<08:43, 27.54s/it]
SNet: Task 7, Epoch 2/20 => Loss 1.372,  Train_accy 75.15:   5%|▌         | 1/20 [00:51<08:43, 27.54s/it]                 
SNet: Task 7, Epoch 2/20 => Loss 1.372,  Train_accy 75.15:  10%|█         | 2/20 [00:51<07:41, 25.65s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.347,  Train_accy 75.36:  10%|█         | 2/20 [01:16<07:41, 25.65s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.347,  Train_accy 75.36:  15%|█▌        | 3/20 [01:16<07:06, 25.07s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.356,  Train_accy 76.55:  15%|█▌        | 3/20 [01:40<07:06, 25.07s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.356,  Train_accy 76.55:  20%|██        | 4/20 [01:40<06:36, 24.80s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.372,  Train_accy 76.44:  20%|██        | 4/20 [02:05<06:36, 24.80s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.372,  Train_accy 76.44:  25%|██▌       | 5/20 [02:05<06:09, 24.66s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.321,  Train_accy 77.95, Test_accy 81.07:  25%|██▌       | 5/20 [02:32<06:09, 24.66s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.321,  Train_accy 77.95, Test_accy 81.07:  30%|███       | 6/20 [02:32<05:59, 25.66s/it]
SNet: Task 7, Epoch 7/20 => Loss 1.329,  Train_accy 77.84:  30%|███       | 6/20 [02:57<05:59, 25.66s/it]                 
SNet: Task 7, Epoch 7/20 => Loss 1.329,  Train_accy 77.84:  35%|███▌      | 7/20 [02:57<05:28, 25.26s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.326,  Train_accy 77.68:  35%|███▌      | 7/20 [03:21<05:28, 25.26s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.326,  Train_accy 77.68:  40%|████      | 8/20 [03:21<04:59, 24.99s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.337,  Train_accy 76.92:  40%|████      | 8/20 [03:45<04:59, 24.99s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.337,  Train_accy 76.92:  45%|████▌     | 9/20 [03:45<04:32, 24.80s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.331,  Train_accy 77.89:  45%|████▌     | 9/20 [04:10<04:32, 24.80s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.331,  Train_accy 77.89:  50%|█████     | 10/20 [04:10<04:06, 24.67s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.351,  Train_accy 77.35, Test_accy 82.05:  50%|█████     | 10/20 [04:37<04:06, 24.67s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.351,  Train_accy 77.35, Test_accy 82.05:  55%|█████▌    | 11/20 [04:37<03:50, 25.56s/it]
SNet: Task 7, Epoch 12/20 => Loss 1.296,  Train_accy 78.38:  55%|█████▌    | 11/20 [05:02<03:50, 25.56s/it]                 
SNet: Task 7, Epoch 12/20 => Loss 1.296,  Train_accy 78.38:  60%|██████    | 12/20 [05:02<03:21, 25.21s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.344,  Train_accy 76.60:  60%|██████    | 12/20 [05:26<03:21, 25.21s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.344,  Train_accy 76.60:  65%|██████▌   | 13/20 [05:26<02:54, 24.96s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.343,  Train_accy 77.95:  65%|██████▌   | 13/20 [05:51<02:54, 24.96s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.343,  Train_accy 77.95:  70%|███████   | 14/20 [05:51<02:28, 24.80s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.328,  Train_accy 78.43:  70%|███████   | 14/20 [06:15<02:28, 24.80s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.328,  Train_accy 78.43:  75%|███████▌  | 15/20 [06:15<02:03, 24.67s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.313,  Train_accy 77.84, Test_accy 81.39:  75%|███████▌  | 15/20 [06:43<02:03, 24.67s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.313,  Train_accy 77.84, Test_accy 81.39:  80%|████████  | 16/20 [06:43<01:42, 25.58s/it]
SNet: Task 7, Epoch 17/20 => Loss 1.332,  Train_accy 77.41:  80%|████████  | 16/20 [07:07<01:42, 25.58s/it]                 
SNet: Task 7, Epoch 17/20 => Loss 1.332,  Train_accy 77.41:  85%|████████▌ | 17/20 [07:07<01:15, 25.22s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.319,  Train_accy 78.43:  85%|████████▌ | 17/20 [07:31<01:15, 25.22s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.319,  Train_accy 78.43:  90%|█████████ | 18/20 [07:31<00:49, 24.97s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.363,  Train_accy 77.51:  90%|█████████ | 18/20 [07:56<00:49, 24.97s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.363,  Train_accy 77.51:  95%|█████████▌| 19/20 [07:56<00:24, 24.79s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.341,  Train_accy 78.05:  95%|█████████▌| 19/20 [08:20<00:24, 24.79s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.341,  Train_accy 78.05: 100%|██████████| 20/20 [08:20<00:00, 24.68s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.341,  Train_accy 78.05: 100%|██████████| 20/20 [08:20<00:00, 25.03s/it]
2024-09-05 09:08:01,437 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 1.341,  Train_accy 78.05
2024-09-05 09:08:01,438 [foster.py] => do not weight align student!
2024-09-05 09:08:04,651 [foster.py] => darknet eval: 
2024-09-05 09:08:04,651 [foster.py] => CNN top1 curve: 81.07
2024-09-05 09:08:04,651 [foster.py] => CNN top5 curve: 98.37
2024-09-05 09:08:04,655 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 09:08:57,843 [foster.py] => Exemplar size: 1600
2024-09-05 09:08:57,844 [trainer.py] => CNN: {'total': 83.35, '00-09': 95.76, '10-19': 94.57, '20-29': 95.88, '30-39': 90.0, '40-49': 93.46, '50-59': 85.59, '60-69': 66.98, '70-79': 51.77, 'old': 89.07, 'new': 51.77}
2024-09-05 09:08:57,844 [trainer.py] => NME: {'total': 92.38, '00-09': 88.98, '10-19': 91.47, '20-29': 97.94, '30-39': 88.18, '40-49': 95.33, '50-59': 90.99, '60-69': 92.45, '70-79': 94.33, 'old': 92.03, 'new': 94.33}
2024-09-05 09:08:57,844 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35]
2024-09-05 09:08:57,844 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04]
2024-09-05 09:08:57,844 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38]
2024-09-05 09:08:57,844 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02]

Average Accuracy (CNN): 89.79
Average Accuracy (NME): 95.54
2024-09-05 09:08:57,844 [trainer.py] => Average Accuracy (CNN): 89.79
2024-09-05 09:08:57,844 [trainer.py] => Average Accuracy (NME): 95.54
2024-09-05 09:08:57,846 [trainer.py] => All params: 171835622
2024-09-05 09:08:57,846 [trainer.py] => Trainable params: 85983136
2024-09-05 09:08:59,379 [foster.py] => Learning on 80-90
2024-09-05 09:08:59,381 [foster.py] => All params: 171866372
2024-09-05 09:08:59,381 [foster.py] => Trainable params: 86006196
2024-09-05 09:08:59,428 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 5.450, Loss_clf 1.019, Loss_fe 2.867, Loss_kd 1.390, Train_accy 71.96, Test_accy 80.99:   0%|          | 0/20 [00:27<?, ?it/s]
Task 8, Epoch 1/20 => Loss 5.450, Loss_clf 1.019, Loss_fe 2.867, Loss_kd 1.390, Train_accy 71.96, Test_accy 80.99:   5%|▌         | 1/20 [00:27<08:41, 27.44s/it]
Task 8, Epoch 2/20 => Loss 2.900, Loss_clf 0.529, Loss_fe 0.805, Loss_kd 1.393, Train_accy 76.52:   5%|▌         | 1/20 [00:48<08:41, 27.44s/it]                 
Task 8, Epoch 2/20 => Loss 2.900, Loss_clf 0.529, Loss_fe 0.805, Loss_kd 1.393, Train_accy 76.52:  10%|█         | 2/20 [00:48<07:08, 23.80s/it]
Task 8, Epoch 3/20 => Loss 2.705, Loss_clf 0.512, Loss_fe 0.657, Loss_kd 1.365, Train_accy 77.63:  10%|█         | 2/20 [01:09<07:08, 23.80s/it]
Task 8, Epoch 3/20 => Loss 2.705, Loss_clf 0.512, Loss_fe 0.657, Loss_kd 1.365, Train_accy 77.63:  15%|█▌        | 3/20 [01:09<06:24, 22.65s/it]
Task 8, Epoch 4/20 => Loss 2.615, Loss_clf 0.493, Loss_fe 0.586, Loss_kd 1.364, Train_accy 77.92:  15%|█▌        | 3/20 [01:31<06:24, 22.65s/it]
Task 8, Epoch 4/20 => Loss 2.615, Loss_clf 0.493, Loss_fe 0.586, Loss_kd 1.364, Train_accy 77.92:  20%|██        | 4/20 [01:31<05:54, 22.14s/it]
Task 8, Epoch 5/20 => Loss 2.447, Loss_clf 0.427, Loss_fe 0.509, Loss_kd 1.343, Train_accy 79.67:  20%|██        | 4/20 [01:52<05:54, 22.14s/it]
Task 8, Epoch 5/20 => Loss 2.447, Loss_clf 0.427, Loss_fe 0.509, Loss_kd 1.343, Train_accy 79.67:  25%|██▌       | 5/20 [01:52<05:28, 21.88s/it]
Task 8, Epoch 6/20 => Loss 2.499, Loss_clf 0.439, Loss_fe 0.512, Loss_kd 1.376, Train_accy 78.26, Test_accy 83.65:  25%|██▌       | 5/20 [02:20<05:28, 21.88s/it]
Task 8, Epoch 6/20 => Loss 2.499, Loss_clf 0.439, Loss_fe 0.512, Loss_kd 1.376, Train_accy 78.26, Test_accy 83.65:  30%|███       | 6/20 [02:20<05:34, 23.92s/it]
Task 8, Epoch 7/20 => Loss 2.323, Loss_clf 0.386, Loss_fe 0.408, Loss_kd 1.359, Train_accy 78.85:  30%|███       | 6/20 [02:42<05:34, 23.92s/it]                 
Task 8, Epoch 7/20 => Loss 2.323, Loss_clf 0.386, Loss_fe 0.408, Loss_kd 1.359, Train_accy 78.85:  35%|███▌      | 7/20 [02:42<05:00, 23.11s/it]
Task 8, Epoch 8/20 => Loss 2.337, Loss_clf 0.392, Loss_fe 0.424, Loss_kd 1.352, Train_accy 79.43:  35%|███▌      | 7/20 [03:03<05:00, 23.11s/it]
Task 8, Epoch 8/20 => Loss 2.337, Loss_clf 0.392, Loss_fe 0.424, Loss_kd 1.352, Train_accy 79.43:  40%|████      | 8/20 [03:03<04:31, 22.59s/it]
Task 8, Epoch 9/20 => Loss 2.267, Loss_clf 0.361, Loss_fe 0.371, Loss_kd 1.364, Train_accy 80.45:  40%|████      | 8/20 [03:24<04:31, 22.59s/it]
Task 8, Epoch 9/20 => Loss 2.267, Loss_clf 0.361, Loss_fe 0.371, Loss_kd 1.364, Train_accy 80.45:  45%|████▌     | 9/20 [03:24<04:04, 22.23s/it]
Task 8, Epoch 10/20 => Loss 2.282, Loss_clf 0.372, Loss_fe 0.367, Loss_kd 1.372, Train_accy 80.35:  45%|████▌     | 9/20 [03:46<04:04, 22.23s/it]
Task 8, Epoch 10/20 => Loss 2.282, Loss_clf 0.372, Loss_fe 0.367, Loss_kd 1.372, Train_accy 80.35:  50%|█████     | 10/20 [03:46<03:39, 21.99s/it]
Task 8, Epoch 11/20 => Loss 2.274, Loss_clf 0.374, Loss_fe 0.359, Loss_kd 1.370, Train_accy 80.93, Test_accy 85.46:  50%|█████     | 10/20 [04:14<03:39, 21.99s/it]
Task 8, Epoch 11/20 => Loss 2.274, Loss_clf 0.374, Loss_fe 0.359, Loss_kd 1.370, Train_accy 80.93, Test_accy 85.46:  55%|█████▌    | 11/20 [04:14<03:34, 23.81s/it]
Task 8, Epoch 12/20 => Loss 2.104, Loss_clf 0.313, Loss_fe 0.278, Loss_kd 1.344, Train_accy 82.39:  55%|█████▌    | 11/20 [04:35<03:34, 23.81s/it]                 
Task 8, Epoch 12/20 => Loss 2.104, Loss_clf 0.313, Loss_fe 0.278, Loss_kd 1.344, Train_accy 82.39:  60%|██████    | 12/20 [04:35<03:04, 23.09s/it]
Task 8, Epoch 13/20 => Loss 2.231, Loss_clf 0.366, Loss_fe 0.326, Loss_kd 1.368, Train_accy 80.79:  60%|██████    | 12/20 [04:57<03:04, 23.09s/it]
Task 8, Epoch 13/20 => Loss 2.231, Loss_clf 0.366, Loss_fe 0.326, Loss_kd 1.368, Train_accy 80.79:  65%|██████▌   | 13/20 [04:57<02:38, 22.60s/it]
Task 8, Epoch 14/20 => Loss 2.088, Loss_clf 0.327, Loss_fe 0.279, Loss_kd 1.318, Train_accy 80.45:  65%|██████▌   | 13/20 [05:18<02:38, 22.60s/it]
Task 8, Epoch 14/20 => Loss 2.088, Loss_clf 0.327, Loss_fe 0.279, Loss_kd 1.318, Train_accy 80.45:  70%|███████   | 14/20 [05:18<02:13, 22.27s/it]
Task 8, Epoch 15/20 => Loss 2.110, Loss_clf 0.334, Loss_fe 0.274, Loss_kd 1.335, Train_accy 81.17:  70%|███████   | 14/20 [05:40<02:13, 22.27s/it]
Task 8, Epoch 15/20 => Loss 2.110, Loss_clf 0.334, Loss_fe 0.274, Loss_kd 1.335, Train_accy 81.17:  75%|███████▌  | 15/20 [05:40<01:50, 22.03s/it]
Task 8, Epoch 16/20 => Loss 2.060, Loss_clf 0.296, Loss_fe 0.265, Loss_kd 1.332, Train_accy 81.95, Test_accy 83.94:  75%|███████▌  | 15/20 [06:08<01:50, 22.03s/it]
Task 8, Epoch 16/20 => Loss 2.060, Loss_clf 0.296, Loss_fe 0.265, Loss_kd 1.332, Train_accy 81.95, Test_accy 83.94:  80%|████████  | 16/20 [06:08<01:35, 23.80s/it]
Task 8, Epoch 17/20 => Loss 2.158, Loss_clf 0.354, Loss_fe 0.287, Loss_kd 1.348, Train_accy 80.20:  80%|████████  | 16/20 [06:29<01:35, 23.80s/it]                 
Task 8, Epoch 17/20 => Loss 2.158, Loss_clf 0.354, Loss_fe 0.287, Loss_kd 1.348, Train_accy 80.20:  85%|████████▌ | 17/20 [06:29<01:09, 23.10s/it]
Task 8, Epoch 18/20 => Loss 2.169, Loss_clf 0.355, Loss_fe 0.288, Loss_kd 1.357, Train_accy 81.13:  85%|████████▌ | 17/20 [06:51<01:09, 23.10s/it]
Task 8, Epoch 18/20 => Loss 2.169, Loss_clf 0.355, Loss_fe 0.288, Loss_kd 1.357, Train_accy 81.13:  90%|█████████ | 18/20 [06:51<00:45, 22.63s/it]
Task 8, Epoch 19/20 => Loss 2.117, Loss_clf 0.321, Loss_fe 0.267, Loss_kd 1.359, Train_accy 81.27:  90%|█████████ | 18/20 [07:12<00:45, 22.63s/it]
Task 8, Epoch 19/20 => Loss 2.117, Loss_clf 0.321, Loss_fe 0.267, Loss_kd 1.359, Train_accy 81.27:  95%|█████████▌| 19/20 [07:12<00:22, 22.30s/it]
Task 8, Epoch 20/20 => Loss 1.994, Loss_clf 0.273, Loss_fe 0.228, Loss_kd 1.327, Train_accy 83.31:  95%|█████████▌| 19/20 [07:34<00:22, 22.30s/it]
Task 8, Epoch 20/20 => Loss 1.994, Loss_clf 0.273, Loss_fe 0.228, Loss_kd 1.327, Train_accy 83.31: 100%|██████████| 20/20 [07:34<00:00, 22.06s/it]
Task 8, Epoch 20/20 => Loss 1.994, Loss_clf 0.273, Loss_fe 0.228, Loss_kd 1.327, Train_accy 83.31: 100%|██████████| 20/20 [07:34<00:00, 22.71s/it]
2024-09-05 09:16:33,637 [foster.py] => Task 8, Epoch 20/20 => Loss 1.994, Loss_clf 0.273, Loss_fe 0.228, Loss_kd 1.327, Train_accy 83.31
2024-09-05 09:16:33,638 [foster.py] => do not weight align teacher!
2024-09-05 09:16:33,641 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.437,  Train_accy 71.32, Test_accy 81.08:   0%|          | 0/20 [00:30<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.437,  Train_accy 71.32, Test_accy 81.08:   5%|▌         | 1/20 [00:30<09:40, 30.53s/it]
SNet: Task 8, Epoch 2/20 => Loss 1.390,  Train_accy 73.75:   5%|▌         | 1/20 [00:57<09:40, 30.53s/it]                 
SNet: Task 8, Epoch 2/20 => Loss 1.390,  Train_accy 73.75:  10%|█         | 2/20 [00:57<08:31, 28.42s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.369,  Train_accy 75.50:  10%|█         | 2/20 [01:24<08:31, 28.42s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.369,  Train_accy 75.50:  15%|█▌        | 3/20 [01:24<07:51, 27.74s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.343,  Train_accy 76.27:  15%|█▌        | 3/20 [01:51<07:51, 27.74s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.343,  Train_accy 76.27:  20%|██        | 4/20 [01:51<07:19, 27.45s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.330,  Train_accy 76.71:  20%|██        | 4/20 [02:18<07:19, 27.45s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.330,  Train_accy 76.71:  25%|██▌       | 5/20 [02:18<06:49, 27.28s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.330,  Train_accy 76.76, Test_accy 81.94:  25%|██▌       | 5/20 [02:49<06:49, 27.28s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.330,  Train_accy 76.76, Test_accy 81.94:  30%|███       | 6/20 [02:49<06:37, 28.42s/it]
SNet: Task 8, Epoch 7/20 => Loss 1.343,  Train_accy 76.18:  30%|███       | 6/20 [03:16<06:37, 28.42s/it]                 
SNet: Task 8, Epoch 7/20 => Loss 1.343,  Train_accy 76.18:  35%|███▌      | 7/20 [03:16<06:03, 27.98s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.337,  Train_accy 75.84:  35%|███▌      | 7/20 [03:43<06:03, 27.98s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.337,  Train_accy 75.84:  40%|████      | 8/20 [03:43<05:31, 27.66s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.356,  Train_accy 76.18:  40%|████      | 8/20 [04:10<05:31, 27.66s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.356,  Train_accy 76.18:  45%|████▌     | 9/20 [04:10<05:02, 27.46s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.337,  Train_accy 76.32:  45%|████▌     | 9/20 [04:37<05:02, 27.46s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.337,  Train_accy 76.32:  50%|█████     | 10/20 [04:37<04:33, 27.32s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.314,  Train_accy 76.81, Test_accy 81.94:  50%|█████     | 10/20 [05:07<04:33, 27.32s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.314,  Train_accy 76.81, Test_accy 81.94:  55%|█████▌    | 11/20 [05:07<04:14, 28.33s/it]
SNet: Task 8, Epoch 12/20 => Loss 1.336,  Train_accy 76.23:  55%|█████▌    | 11/20 [05:34<04:14, 28.33s/it]                 
SNet: Task 8, Epoch 12/20 => Loss 1.336,  Train_accy 76.23:  60%|██████    | 12/20 [05:34<03:43, 27.91s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.338,  Train_accy 77.15:  60%|██████    | 12/20 [06:01<03:43, 27.91s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.338,  Train_accy 77.15:  65%|██████▌   | 13/20 [06:01<03:13, 27.64s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.351,  Train_accy 76.32:  65%|██████▌   | 13/20 [06:28<03:13, 27.64s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.351,  Train_accy 76.32:  70%|███████   | 14/20 [06:28<02:44, 27.43s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.342,  Train_accy 77.00:  70%|███████   | 14/20 [06:55<02:44, 27.43s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.342,  Train_accy 77.00:  75%|███████▌  | 15/20 [06:55<02:16, 27.31s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.361,  Train_accy 76.27, Test_accy 81.94:  75%|███████▌  | 15/20 [07:26<02:16, 27.31s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.361,  Train_accy 76.27, Test_accy 81.94:  80%|████████  | 16/20 [07:26<01:53, 28.30s/it]
SNet: Task 8, Epoch 17/20 => Loss 1.321,  Train_accy 77.10:  80%|████████  | 16/20 [07:53<01:53, 28.30s/it]                 
SNet: Task 8, Epoch 17/20 => Loss 1.321,  Train_accy 77.10:  85%|████████▌ | 17/20 [07:53<01:23, 27.90s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.297,  Train_accy 78.26:  85%|████████▌ | 17/20 [08:20<01:23, 27.90s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.297,  Train_accy 78.26:  90%|█████████ | 18/20 [08:20<00:55, 27.62s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.363,  Train_accy 76.37:  90%|█████████ | 18/20 [08:47<00:55, 27.62s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.363,  Train_accy 76.37:  95%|█████████▌| 19/20 [08:47<00:27, 27.43s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.343,  Train_accy 76.66:  95%|█████████▌| 19/20 [09:14<00:27, 27.43s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.343,  Train_accy 76.66: 100%|██████████| 20/20 [09:14<00:00, 27.28s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.343,  Train_accy 76.66: 100%|██████████| 20/20 [09:14<00:00, 27.71s/it]
2024-09-05 09:25:49,189 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.343,  Train_accy 76.66
2024-09-05 09:25:49,190 [foster.py] => do not weight align student!
2024-09-05 09:25:52,768 [foster.py] => darknet eval: 
2024-09-05 09:25:52,769 [foster.py] => CNN top1 curve: 81.75
2024-09-05 09:25:52,769 [foster.py] => CNN top5 curve: 98.67
2024-09-05 09:25:52,772 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 09:26:51,304 [foster.py] => Exemplar size: 1800
2024-09-05 09:26:51,304 [trainer.py] => CNN: {'total': 84.7, '00-09': 94.07, '10-19': 95.35, '20-29': 95.88, '30-39': 88.18, '40-49': 91.59, '50-59': 85.59, '60-69': 84.91, '70-79': 80.85, '80-89': 52.63, 'old': 89.34, 'new': 52.63}
2024-09-05 09:26:51,304 [trainer.py] => NME: {'total': 92.21, '00-09': 88.98, '10-19': 91.47, '20-29': 97.94, '30-39': 89.09, '40-49': 94.39, '50-59': 89.19, '60-69': 92.45, '70-79': 94.33, '80-89': 92.48, 'old': 92.17, 'new': 92.48}
2024-09-05 09:26:51,304 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7]
2024-09-05 09:26:51,304 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38]
2024-09-05 09:26:51,304 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21]
2024-09-05 09:26:51,304 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05]

Average Accuracy (CNN): 89.23
Average Accuracy (NME): 95.17
2024-09-05 09:26:51,304 [trainer.py] => Average Accuracy (CNN): 89.23
2024-09-05 09:26:51,304 [trainer.py] => Average Accuracy (NME): 95.17
2024-09-05 09:26:51,306 [trainer.py] => All params: 171866372
2024-09-05 09:26:51,307 [trainer.py] => Trainable params: 86006196
2024-09-05 09:26:52,690 [foster.py] => Learning on 90-100
2024-09-05 09:26:52,692 [foster.py] => All params: 171897122
2024-09-05 09:26:52,693 [foster.py] => Trainable params: 86029256
2024-09-05 09:26:52,741 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 5.677, Loss_clf 1.029, Loss_fe 3.129, Loss_kd 1.367, Train_accy 73.55, Test_accy 81.73:   0%|          | 0/20 [00:30<?, ?it/s]
Task 9, Epoch 1/20 => Loss 5.677, Loss_clf 1.029, Loss_fe 3.129, Loss_kd 1.367, Train_accy 73.55, Test_accy 81.73:   5%|▌         | 1/20 [00:30<09:32, 30.13s/it]
Task 9, Epoch 2/20 => Loss 3.104, Loss_clf 0.617, Loss_fe 0.930, Loss_kd 1.401, Train_accy 76.08:   5%|▌         | 1/20 [00:53<09:32, 30.13s/it]                 
Task 9, Epoch 2/20 => Loss 3.104, Loss_clf 0.617, Loss_fe 0.930, Loss_kd 1.401, Train_accy 76.08:  10%|█         | 2/20 [00:53<07:50, 26.12s/it]
Task 9, Epoch 3/20 => Loss 2.714, Loss_clf 0.519, Loss_fe 0.696, Loss_kd 1.350, Train_accy 77.63:  10%|█         | 2/20 [01:17<07:50, 26.12s/it]
Task 9, Epoch 3/20 => Loss 2.714, Loss_clf 0.519, Loss_fe 0.696, Loss_kd 1.350, Train_accy 77.63:  15%|█▌        | 3/20 [01:17<07:04, 24.95s/it]
Task 9, Epoch 4/20 => Loss 2.490, Loss_clf 0.445, Loss_fe 0.565, Loss_kd 1.332, Train_accy 79.94:  15%|█▌        | 3/20 [01:40<07:04, 24.95s/it]
Task 9, Epoch 4/20 => Loss 2.490, Loss_clf 0.445, Loss_fe 0.565, Loss_kd 1.332, Train_accy 79.94:  20%|██        | 4/20 [01:40<06:30, 24.42s/it]
Task 9, Epoch 5/20 => Loss 2.514, Loss_clf 0.485, Loss_fe 0.548, Loss_kd 1.333, Train_accy 78.43:  20%|██        | 4/20 [02:04<06:30, 24.42s/it]
Task 9, Epoch 5/20 => Loss 2.514, Loss_clf 0.485, Loss_fe 0.548, Loss_kd 1.333, Train_accy 78.43:  25%|██▌       | 5/20 [02:04<06:01, 24.08s/it]
Task 9, Epoch 6/20 => Loss 2.503, Loss_clf 0.470, Loss_fe 0.513, Loss_kd 1.367, Train_accy 77.81, Test_accy 82.41:  25%|██▌       | 5/20 [02:34<06:01, 24.08s/it]
Task 9, Epoch 6/20 => Loss 2.503, Loss_clf 0.470, Loss_fe 0.513, Loss_kd 1.367, Train_accy 77.81, Test_accy 82.41:  30%|███       | 6/20 [02:34<06:08, 26.33s/it]
Task 9, Epoch 7/20 => Loss 2.273, Loss_clf 0.396, Loss_fe 0.419, Loss_kd 1.312, Train_accy 79.54:  30%|███       | 6/20 [02:58<06:08, 26.33s/it]                 
Task 9, Epoch 7/20 => Loss 2.273, Loss_clf 0.396, Loss_fe 0.419, Loss_kd 1.312, Train_accy 79.54:  35%|███▌      | 7/20 [02:58<05:30, 25.42s/it]
Task 9, Epoch 8/20 => Loss 2.223, Loss_clf 0.412, Loss_fe 0.369, Loss_kd 1.298, Train_accy 80.83:  35%|███▌      | 7/20 [03:21<05:30, 25.42s/it]
Task 9, Epoch 8/20 => Loss 2.223, Loss_clf 0.412, Loss_fe 0.369, Loss_kd 1.298, Train_accy 80.83:  40%|████      | 8/20 [03:21<04:57, 24.81s/it]
Task 9, Epoch 9/20 => Loss 2.229, Loss_clf 0.394, Loss_fe 0.370, Loss_kd 1.318, Train_accy 81.00:  40%|████      | 8/20 [03:45<04:57, 24.81s/it]
Task 9, Epoch 9/20 => Loss 2.229, Loss_clf 0.394, Loss_fe 0.370, Loss_kd 1.318, Train_accy 81.00:  45%|████▌     | 9/20 [03:45<04:28, 24.41s/it]
Task 9, Epoch 10/20 => Loss 2.195, Loss_clf 0.360, Loss_fe 0.355, Loss_kd 1.332, Train_accy 79.98:  45%|████▌     | 9/20 [04:08<04:28, 24.41s/it]
Task 9, Epoch 10/20 => Loss 2.195, Loss_clf 0.360, Loss_fe 0.355, Loss_kd 1.332, Train_accy 79.98:  50%|█████     | 10/20 [04:08<04:01, 24.14s/it]
Task 9, Epoch 11/20 => Loss 2.178, Loss_clf 0.367, Loss_fe 0.337, Loss_kd 1.327, Train_accy 80.56, Test_accy 84.43:  50%|█████     | 10/20 [04:39<04:01, 24.14s/it]
Task 9, Epoch 11/20 => Loss 2.178, Loss_clf 0.367, Loss_fe 0.337, Loss_kd 1.327, Train_accy 80.56, Test_accy 84.43:  55%|█████▌    | 11/20 [04:39<03:55, 26.14s/it]
Task 9, Epoch 12/20 => Loss 2.131, Loss_clf 0.344, Loss_fe 0.321, Loss_kd 1.319, Train_accy 81.31:  55%|█████▌    | 11/20 [05:03<03:55, 26.14s/it]                 
Task 9, Epoch 12/20 => Loss 2.131, Loss_clf 0.344, Loss_fe 0.321, Loss_kd 1.319, Train_accy 81.31:  60%|██████    | 12/20 [05:03<03:22, 25.34s/it]
Task 9, Epoch 13/20 => Loss 2.160, Loss_clf 0.351, Loss_fe 0.328, Loss_kd 1.332, Train_accy 81.14:  60%|██████    | 12/20 [05:26<03:22, 25.34s/it]
Task 9, Epoch 13/20 => Loss 2.160, Loss_clf 0.351, Loss_fe 0.328, Loss_kd 1.332, Train_accy 81.14:  65%|██████▌   | 13/20 [05:26<02:53, 24.78s/it]
Task 9, Epoch 14/20 => Loss 2.106, Loss_clf 0.334, Loss_fe 0.292, Loss_kd 1.332, Train_accy 82.02:  65%|██████▌   | 13/20 [05:50<02:53, 24.78s/it]
Task 9, Epoch 14/20 => Loss 2.106, Loss_clf 0.334, Loss_fe 0.292, Loss_kd 1.332, Train_accy 82.02:  70%|███████   | 14/20 [05:50<02:26, 24.39s/it]
Task 9, Epoch 15/20 => Loss 2.108, Loss_clf 0.341, Loss_fe 0.301, Loss_kd 1.320, Train_accy 80.96:  70%|███████   | 14/20 [06:13<02:26, 24.39s/it]
Task 9, Epoch 15/20 => Loss 2.108, Loss_clf 0.341, Loss_fe 0.301, Loss_kd 1.320, Train_accy 80.96:  75%|███████▌  | 15/20 [06:13<02:00, 24.12s/it]
Task 9, Epoch 16/20 => Loss 2.087, Loss_clf 0.335, Loss_fe 0.281, Loss_kd 1.324, Train_accy 82.25, Test_accy 84.09:  75%|███████▌  | 15/20 [06:44<02:00, 24.12s/it]
Task 9, Epoch 16/20 => Loss 2.087, Loss_clf 0.335, Loss_fe 0.281, Loss_kd 1.324, Train_accy 82.25, Test_accy 84.09:  80%|████████  | 16/20 [06:44<01:44, 26.09s/it]
Task 9, Epoch 17/20 => Loss 2.091, Loss_clf 0.338, Loss_fe 0.285, Loss_kd 1.321, Train_accy 82.02:  80%|████████  | 16/20 [07:07<01:44, 26.09s/it]                 
Task 9, Epoch 17/20 => Loss 2.091, Loss_clf 0.338, Loss_fe 0.285, Loss_kd 1.321, Train_accy 82.02:  85%|████████▌ | 17/20 [07:07<01:15, 25.30s/it]
Task 9, Epoch 18/20 => Loss 2.123, Loss_clf 0.342, Loss_fe 0.292, Loss_kd 1.340, Train_accy 81.49:  85%|████████▌ | 17/20 [07:31<01:15, 25.30s/it]
Task 9, Epoch 18/20 => Loss 2.123, Loss_clf 0.342, Loss_fe 0.292, Loss_kd 1.340, Train_accy 81.49:  90%|█████████ | 18/20 [07:31<00:49, 24.74s/it]
Task 9, Epoch 19/20 => Loss 2.075, Loss_clf 0.330, Loss_fe 0.276, Loss_kd 1.322, Train_accy 82.38:  90%|█████████ | 18/20 [07:54<00:49, 24.74s/it]
Task 9, Epoch 19/20 => Loss 2.075, Loss_clf 0.330, Loss_fe 0.276, Loss_kd 1.322, Train_accy 82.38:  95%|█████████▌| 19/20 [07:54<00:24, 24.37s/it]
Task 9, Epoch 20/20 => Loss 2.119, Loss_clf 0.362, Loss_fe 0.278, Loss_kd 1.331, Train_accy 81.49:  95%|█████████▌| 19/20 [08:18<00:24, 24.37s/it]
Task 9, Epoch 20/20 => Loss 2.119, Loss_clf 0.362, Loss_fe 0.278, Loss_kd 1.331, Train_accy 81.49: 100%|██████████| 20/20 [08:18<00:00, 24.09s/it]
Task 9, Epoch 20/20 => Loss 2.119, Loss_clf 0.362, Loss_fe 0.278, Loss_kd 1.331, Train_accy 81.49: 100%|██████████| 20/20 [08:18<00:00, 24.90s/it]
2024-09-05 09:35:10,832 [foster.py] => Task 9, Epoch 20/20 => Loss 2.119, Loss_clf 0.362, Loss_fe 0.278, Loss_kd 1.331, Train_accy 81.49
2024-09-05 09:35:10,833 [foster.py] => do not weight align teacher!
2024-09-05 09:35:10,837 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.437,  Train_accy 73.64, Test_accy 83.08:   0%|          | 0/20 [00:33<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.437,  Train_accy 73.64, Test_accy 83.08:   5%|▌         | 1/20 [00:33<10:34, 33.38s/it]
SNet: Task 9, Epoch 2/20 => Loss 1.335,  Train_accy 77.41:   5%|▌         | 1/20 [01:02<10:34, 33.38s/it]                 
SNet: Task 9, Epoch 2/20 => Loss 1.335,  Train_accy 77.41:  10%|█         | 2/20 [01:02<09:18, 31.05s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.304,  Train_accy 76.74:  10%|█         | 2/20 [01:32<09:18, 31.05s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.304,  Train_accy 76.74:  15%|█▌        | 3/20 [01:32<08:35, 30.32s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.282,  Train_accy 78.38:  15%|█▌        | 3/20 [02:01<08:35, 30.32s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.282,  Train_accy 78.38:  20%|██        | 4/20 [02:01<07:59, 29.97s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.311,  Train_accy 77.41:  20%|██        | 4/20 [02:31<07:59, 29.97s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.311,  Train_accy 77.41:  25%|██▌       | 5/20 [02:31<07:26, 29.79s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.305,  Train_accy 77.10, Test_accy 83.25:  25%|██▌       | 5/20 [03:04<07:26, 29.79s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.305,  Train_accy 77.10, Test_accy 83.25:  30%|███       | 6/20 [03:04<07:14, 31.04s/it]
SNet: Task 9, Epoch 7/20 => Loss 1.259,  Train_accy 79.49:  30%|███       | 6/20 [03:34<07:14, 31.04s/it]                 
SNet: Task 9, Epoch 7/20 => Loss 1.259,  Train_accy 79.49:  35%|███▌      | 7/20 [03:34<06:36, 30.52s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.278,  Train_accy 78.43:  35%|███▌      | 7/20 [04:03<06:36, 30.52s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.278,  Train_accy 78.43:  40%|████      | 8/20 [04:03<06:02, 30.17s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.273,  Train_accy 79.14:  40%|████      | 8/20 [04:32<06:02, 30.17s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.273,  Train_accy 79.14:  45%|████▌     | 9/20 [04:32<05:29, 29.94s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.294,  Train_accy 78.43:  45%|████▌     | 9/20 [05:02<05:29, 29.94s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.294,  Train_accy 78.43:  50%|█████     | 10/20 [05:02<04:57, 29.78s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.294,  Train_accy 77.72, Test_accy 83.33:  50%|█████     | 10/20 [05:35<04:57, 29.78s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.294,  Train_accy 77.72, Test_accy 83.33:  55%|█████▌    | 11/20 [05:35<04:38, 30.91s/it]
SNet: Task 9, Epoch 12/20 => Loss 1.290,  Train_accy 79.05:  55%|█████▌    | 11/20 [06:05<04:38, 30.91s/it]                 
SNet: Task 9, Epoch 12/20 => Loss 1.290,  Train_accy 79.05:  60%|██████    | 12/20 [06:05<04:03, 30.46s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.280,  Train_accy 78.56:  60%|██████    | 12/20 [06:34<04:03, 30.46s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.280,  Train_accy 78.56:  65%|██████▌   | 13/20 [06:34<03:31, 30.17s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.304,  Train_accy 78.43:  65%|██████▌   | 13/20 [07:04<03:31, 30.17s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.304,  Train_accy 78.43:  70%|███████   | 14/20 [07:04<02:59, 29.97s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.303,  Train_accy 78.47:  70%|███████   | 14/20 [07:33<02:59, 29.97s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.303,  Train_accy 78.47:  75%|███████▌  | 15/20 [07:33<02:29, 29.82s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.284,  Train_accy 79.41, Test_accy 83.00:  75%|███████▌  | 15/20 [08:07<02:29, 29.82s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.284,  Train_accy 79.41, Test_accy 83.00:  80%|████████  | 16/20 [08:07<02:03, 30.91s/it]
SNet: Task 9, Epoch 17/20 => Loss 1.314,  Train_accy 78.21:  80%|████████  | 16/20 [08:36<02:03, 30.91s/it]                 
SNet: Task 9, Epoch 17/20 => Loss 1.314,  Train_accy 78.21:  85%|████████▌ | 17/20 [08:36<01:31, 30.49s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.293,  Train_accy 79.67:  85%|████████▌ | 17/20 [09:06<01:31, 30.49s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.293,  Train_accy 79.67:  90%|█████████ | 18/20 [09:06<01:00, 30.19s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.272,  Train_accy 80.20:  90%|█████████ | 18/20 [09:35<01:00, 30.19s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.272,  Train_accy 80.20:  95%|█████████▌| 19/20 [09:35<00:29, 29.98s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.297,  Train_accy 79.36:  95%|█████████▌| 19/20 [10:05<00:29, 29.98s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.297,  Train_accy 79.36: 100%|██████████| 20/20 [10:05<00:00, 29.83s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.297,  Train_accy 79.36: 100%|██████████| 20/20 [10:05<00:00, 30.26s/it]
2024-09-05 09:45:17,385 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 1.297,  Train_accy 79.36
2024-09-05 09:45:17,386 [foster.py] => do not weight align student!
2024-09-05 09:45:21,369 [foster.py] => darknet eval: 
2024-09-05 09:45:21,369 [foster.py] => CNN top1 curve: 83.67
2024-09-05 09:45:21,369 [foster.py] => CNN top5 curve: 98.82
2024-09-05 09:45:21,372 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 09:46:25,740 [foster.py] => Exemplar size: 2000
2024-09-05 09:46:25,740 [trainer.py] => CNN: {'total': 84.18, '00-09': 93.22, '10-19': 94.57, '20-29': 95.88, '30-39': 89.09, '40-49': 92.52, '50-59': 85.59, '60-69': 83.96, '70-79': 88.65, '80-89': 75.19, '90-99': 50.74, 'old': 88.5, 'new': 50.74}
2024-09-05 09:46:25,740 [trainer.py] => NME: {'total': 92.09, '00-09': 89.83, '10-19': 93.02, '20-29': 96.91, '30-39': 85.45, '40-49': 93.46, '50-59': 90.09, '60-69': 90.57, '70-79': 95.04, '80-89': 93.23, '90-99': 92.65, 'old': 92.02, 'new': 92.65}
2024-09-05 09:46:25,740 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18]
2024-09-05 09:46:25,740 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65]
2024-09-05 09:46:25,740 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09]
2024-09-05 09:46:25,740 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16]

Average Accuracy (CNN): 88.72
Average Accuracy (NME): 94.86
2024-09-05 09:46:25,740 [trainer.py] => Average Accuracy (CNN): 88.72
2024-09-05 09:46:25,740 [trainer.py] => Average Accuracy (NME): 94.86
2024-09-05 09:46:25,742 [trainer.py] => All params: 171897122
2024-09-05 09:46:25,743 [trainer.py] => Trainable params: 86029256
2024-09-05 09:46:27,133 [foster.py] => Learning on 100-110
2024-09-05 09:46:27,135 [foster.py] => All params: 171927872
2024-09-05 09:46:27,136 [foster.py] => Trainable params: 86052316
2024-09-05 09:46:27,183 [foster.py] => per cls weights : [1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 0.5813577  0.5813577
 0.5813577  0.5813577  0.5813577  0.5813577  0.5813577  0.5813577
 0.5813577  0.5813577 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 5.788, Loss_clf 0.934, Loss_fe 3.304, Loss_kd 1.409, Train_accy 75.13, Test_accy 84.50:   0%|          | 0/20 [00:33<?, ?it/s]
Task 10, Epoch 1/20 => Loss 5.788, Loss_clf 0.934, Loss_fe 3.304, Loss_kd 1.409, Train_accy 75.13, Test_accy 84.50:   5%|▌         | 1/20 [00:33<10:27, 33.02s/it]
Task 10, Epoch 2/20 => Loss 3.052, Loss_clf 0.548, Loss_fe 0.978, Loss_kd 1.387, Train_accy 79.20:   5%|▌         | 1/20 [00:58<10:27, 33.02s/it]                 
Task 10, Epoch 2/20 => Loss 3.052, Loss_clf 0.548, Loss_fe 0.978, Loss_kd 1.387, Train_accy 79.20:  10%|█         | 2/20 [00:58<08:34, 28.60s/it]
Task 10, Epoch 3/20 => Loss 2.728, Loss_clf 0.490, Loss_fe 0.723, Loss_kd 1.377, Train_accy 78.27:  10%|█         | 2/20 [01:24<08:34, 28.60s/it]
Task 10, Epoch 3/20 => Loss 2.728, Loss_clf 0.490, Loss_fe 0.723, Loss_kd 1.377, Train_accy 78.27:  15%|█▌        | 3/20 [01:24<07:42, 27.23s/it]
Task 10, Epoch 4/20 => Loss 2.621, Loss_clf 0.482, Loss_fe 0.616, Loss_kd 1.385, Train_accy 78.72:  15%|█▌        | 3/20 [01:49<07:42, 27.23s/it]
Task 10, Epoch 4/20 => Loss 2.621, Loss_clf 0.482, Loss_fe 0.616, Loss_kd 1.385, Train_accy 78.72:  20%|██        | 4/20 [01:49<07:05, 26.61s/it]
Task 10, Epoch 5/20 => Loss 2.486, Loss_clf 0.438, Loss_fe 0.550, Loss_kd 1.362, Train_accy 80.49:  20%|██        | 4/20 [02:15<07:05, 26.61s/it]
Task 10, Epoch 5/20 => Loss 2.486, Loss_clf 0.438, Loss_fe 0.550, Loss_kd 1.362, Train_accy 80.49:  25%|██▌       | 5/20 [02:15<06:34, 26.28s/it]
Task 10, Epoch 6/20 => Loss 2.424, Loss_clf 0.422, Loss_fe 0.487, Loss_kd 1.378, Train_accy 80.01, Test_accy 86.11:  25%|██▌       | 5/20 [02:49<06:34, 26.28s/it]
Task 10, Epoch 6/20 => Loss 2.424, Loss_clf 0.422, Loss_fe 0.487, Loss_kd 1.378, Train_accy 80.01, Test_accy 86.11:  30%|███       | 6/20 [02:49<06:42, 28.74s/it]
Task 10, Epoch 7/20 => Loss 2.330, Loss_clf 0.397, Loss_fe 0.442, Loss_kd 1.356, Train_accy 81.74:  30%|███       | 6/20 [03:14<06:42, 28.74s/it]                 
Task 10, Epoch 7/20 => Loss 2.330, Loss_clf 0.397, Loss_fe 0.442, Loss_kd 1.356, Train_accy 81.74:  35%|███▌      | 7/20 [03:14<06:00, 27.76s/it]
Task 10, Epoch 8/20 => Loss 2.380, Loss_clf 0.415, Loss_fe 0.456, Loss_kd 1.372, Train_accy 80.65:  35%|███▌      | 7/20 [03:40<06:00, 27.76s/it]
Task 10, Epoch 8/20 => Loss 2.380, Loss_clf 0.415, Loss_fe 0.456, Loss_kd 1.372, Train_accy 80.65:  40%|████      | 8/20 [03:40<05:25, 27.12s/it]
Task 10, Epoch 9/20 => Loss 2.193, Loss_clf 0.348, Loss_fe 0.356, Loss_kd 1.354, Train_accy 81.46:  40%|████      | 8/20 [04:06<05:25, 27.12s/it]
Task 10, Epoch 9/20 => Loss 2.193, Loss_clf 0.348, Loss_fe 0.356, Loss_kd 1.354, Train_accy 81.46:  45%|████▌     | 9/20 [04:06<04:53, 26.69s/it]
Task 10, Epoch 10/20 => Loss 2.265, Loss_clf 0.367, Loss_fe 0.380, Loss_kd 1.381, Train_accy 81.90:  45%|████▌     | 9/20 [04:32<04:53, 26.69s/it]
Task 10, Epoch 10/20 => Loss 2.265, Loss_clf 0.367, Loss_fe 0.380, Loss_kd 1.381, Train_accy 81.90:  50%|█████     | 10/20 [04:32<04:24, 26.40s/it]
Task 10, Epoch 11/20 => Loss 2.187, Loss_clf 0.355, Loss_fe 0.338, Loss_kd 1.358, Train_accy 81.74, Test_accy 84.88:  50%|█████     | 10/20 [05:05<04:24, 26.40s/it]
Task 10, Epoch 11/20 => Loss 2.187, Loss_clf 0.355, Loss_fe 0.338, Loss_kd 1.358, Train_accy 81.74, Test_accy 84.88:  55%|█████▌    | 11/20 [05:05<04:17, 28.60s/it]
Task 10, Epoch 12/20 => Loss 2.205, Loss_clf 0.365, Loss_fe 0.339, Loss_kd 1.365, Train_accy 82.18:  55%|█████▌    | 11/20 [05:31<04:17, 28.60s/it]                 
Task 10, Epoch 12/20 => Loss 2.205, Loss_clf 0.365, Loss_fe 0.339, Loss_kd 1.365, Train_accy 82.18:  60%|██████    | 12/20 [05:31<03:42, 27.75s/it]
Task 10, Epoch 13/20 => Loss 2.130, Loss_clf 0.342, Loss_fe 0.315, Loss_kd 1.339, Train_accy 83.31:  60%|██████    | 12/20 [05:57<03:42, 27.75s/it]
Task 10, Epoch 13/20 => Loss 2.130, Loss_clf 0.342, Loss_fe 0.315, Loss_kd 1.339, Train_accy 83.31:  65%|██████▌   | 13/20 [05:57<03:10, 27.15s/it]
Task 10, Epoch 14/20 => Loss 2.173, Loss_clf 0.355, Loss_fe 0.310, Loss_kd 1.371, Train_accy 82.27:  65%|██████▌   | 13/20 [06:23<03:10, 27.15s/it]
Task 10, Epoch 14/20 => Loss 2.173, Loss_clf 0.355, Loss_fe 0.310, Loss_kd 1.371, Train_accy 82.27:  70%|███████   | 14/20 [06:23<02:40, 26.76s/it]
Task 10, Epoch 15/20 => Loss 2.124, Loss_clf 0.330, Loss_fe 0.298, Loss_kd 1.360, Train_accy 82.59:  70%|███████   | 14/20 [06:48<02:40, 26.76s/it]
Task 10, Epoch 15/20 => Loss 2.124, Loss_clf 0.330, Loss_fe 0.298, Loss_kd 1.360, Train_accy 82.59:  75%|███████▌  | 15/20 [06:48<02:12, 26.46s/it]
Task 10, Epoch 16/20 => Loss 2.098, Loss_clf 0.334, Loss_fe 0.279, Loss_kd 1.350, Train_accy 83.51, Test_accy 85.50:  75%|███████▌  | 15/20 [07:22<02:12, 26.46s/it]
Task 10, Epoch 16/20 => Loss 2.098, Loss_clf 0.334, Loss_fe 0.279, Loss_kd 1.350, Train_accy 83.51, Test_accy 85.50:  80%|████████  | 16/20 [07:22<01:54, 28.61s/it]
Task 10, Epoch 17/20 => Loss 2.159, Loss_clf 0.339, Loss_fe 0.295, Loss_kd 1.387, Train_accy 82.35:  80%|████████  | 16/20 [07:48<01:54, 28.61s/it]                 
Task 10, Epoch 17/20 => Loss 2.159, Loss_clf 0.339, Loss_fe 0.295, Loss_kd 1.387, Train_accy 82.35:  85%|████████▌ | 17/20 [07:48<01:23, 27.77s/it]
Task 10, Epoch 18/20 => Loss 2.070, Loss_clf 0.313, Loss_fe 0.272, Loss_kd 1.350, Train_accy 83.15:  85%|████████▌ | 17/20 [08:13<01:23, 27.77s/it]
Task 10, Epoch 18/20 => Loss 2.070, Loss_clf 0.313, Loss_fe 0.272, Loss_kd 1.350, Train_accy 83.15:  90%|█████████ | 18/20 [08:13<00:54, 27.17s/it]
Task 10, Epoch 19/20 => Loss 2.112, Loss_clf 0.337, Loss_fe 0.292, Loss_kd 1.349, Train_accy 83.11:  90%|█████████ | 18/20 [08:39<00:54, 27.17s/it]
Task 10, Epoch 19/20 => Loss 2.112, Loss_clf 0.337, Loss_fe 0.292, Loss_kd 1.349, Train_accy 83.11:  95%|█████████▌| 19/20 [08:39<00:26, 26.76s/it]
Task 10, Epoch 20/20 => Loss 2.000, Loss_clf 0.300, Loss_fe 0.243, Loss_kd 1.325, Train_accy 83.51:  95%|█████████▌| 19/20 [09:05<00:26, 26.76s/it]
Task 10, Epoch 20/20 => Loss 2.000, Loss_clf 0.300, Loss_fe 0.243, Loss_kd 1.325, Train_accy 83.51: 100%|██████████| 20/20 [09:05<00:00, 26.46s/it]
Task 10, Epoch 20/20 => Loss 2.000, Loss_clf 0.300, Loss_fe 0.243, Loss_kd 1.325, Train_accy 83.51: 100%|██████████| 20/20 [09:05<00:00, 27.28s/it]
2024-09-05 09:55:32,737 [foster.py] => Task 10, Epoch 20/20 => Loss 2.000, Loss_clf 0.300, Loss_fe 0.243, Loss_kd 1.325, Train_accy 83.51
2024-09-05 09:55:32,738 [foster.py] => do not weight align teacher!
2024-09-05 09:55:32,742 [foster.py] => per cls weights : [1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 0.47993148 0.47993148
 0.47993148 0.47993148 0.47993148 0.47993148 0.47993148 0.47993148
 0.47993148 0.47993148]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 1.448,  Train_accy 73.68, Test_accy 84.34:   0%|          | 0/20 [00:36<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 1.448,  Train_accy 73.68, Test_accy 84.34:   5%|▌         | 1/20 [00:36<11:37, 36.71s/it]
SNet: Task 10, Epoch 2/20 => Loss 1.348,  Train_accy 77.47:   5%|▌         | 1/20 [01:09<11:37, 36.71s/it]                 
SNet: Task 10, Epoch 2/20 => Loss 1.348,  Train_accy 77.47:  10%|█         | 2/20 [01:09<10:14, 34.17s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.360,  Train_accy 78.19:  10%|█         | 2/20 [01:41<10:14, 34.17s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.360,  Train_accy 78.19:  15%|█▌        | 3/20 [01:41<09:27, 33.35s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.388,  Train_accy 77.51:  15%|█▌        | 3/20 [02:13<09:27, 33.35s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.388,  Train_accy 77.51:  20%|██        | 4/20 [02:13<08:48, 33.02s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.327,  Train_accy 78.40:  20%|██        | 4/20 [02:46<08:48, 33.02s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.327,  Train_accy 78.40:  25%|██▌       | 5/20 [02:46<08:12, 32.80s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.349,  Train_accy 78.32, Test_accy 84.19:  25%|██▌       | 5/20 [03:23<08:12, 32.80s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.349,  Train_accy 78.32, Test_accy 84.19:  30%|███       | 6/20 [03:23<07:58, 34.15s/it]
SNet: Task 10, Epoch 7/20 => Loss 1.382,  Train_accy 78.56:  30%|███       | 6/20 [03:55<07:58, 34.15s/it]                 
SNet: Task 10, Epoch 7/20 => Loss 1.382,  Train_accy 78.56:  35%|███▌      | 7/20 [03:55<07:16, 33.56s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.371,  Train_accy 79.56:  35%|███▌      | 7/20 [04:27<07:16, 33.56s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.371,  Train_accy 79.56:  40%|████      | 8/20 [04:27<06:38, 33.18s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.360,  Train_accy 78.07:  40%|████      | 8/20 [05:00<06:38, 33.18s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.360,  Train_accy 78.07:  45%|████▌     | 9/20 [05:00<06:02, 32.94s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.369,  Train_accy 78.19:  45%|████▌     | 9/20 [05:32<06:02, 32.94s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.369,  Train_accy 78.19:  50%|█████     | 10/20 [05:32<05:27, 32.76s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.360,  Train_accy 78.23, Test_accy 84.50:  50%|█████     | 10/20 [06:09<05:27, 32.76s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.360,  Train_accy 78.23, Test_accy 84.50:  55%|█████▌    | 11/20 [06:09<05:05, 33.99s/it]
SNet: Task 10, Epoch 12/20 => Loss 1.350,  Train_accy 78.44:  55%|█████▌    | 11/20 [06:41<05:05, 33.99s/it]                 
SNet: Task 10, Epoch 12/20 => Loss 1.350,  Train_accy 78.44:  60%|██████    | 12/20 [06:41<04:28, 33.51s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.337,  Train_accy 79.16:  60%|██████    | 12/20 [07:14<04:28, 33.51s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.337,  Train_accy 79.16:  65%|██████▌   | 13/20 [07:14<03:52, 33.17s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.388,  Train_accy 77.43:  65%|██████▌   | 13/20 [07:46<03:52, 33.17s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.388,  Train_accy 77.43:  70%|███████   | 14/20 [07:46<03:17, 32.92s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.320,  Train_accy 79.04:  70%|███████   | 14/20 [08:18<03:17, 32.92s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.320,  Train_accy 79.04:  75%|███████▌  | 15/20 [08:18<02:43, 32.76s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.366,  Train_accy 79.32, Test_accy 84.11:  75%|███████▌  | 15/20 [08:55<02:43, 32.76s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.366,  Train_accy 79.32, Test_accy 84.11:  80%|████████  | 16/20 [08:55<02:15, 33.95s/it]
SNet: Task 10, Epoch 17/20 => Loss 1.387,  Train_accy 78.32:  80%|████████  | 16/20 [09:28<02:15, 33.95s/it]                 
SNet: Task 10, Epoch 17/20 => Loss 1.387,  Train_accy 78.32:  85%|████████▌ | 17/20 [09:28<01:40, 33.47s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.382,  Train_accy 79.28:  85%|████████▌ | 17/20 [10:00<01:40, 33.47s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.382,  Train_accy 79.28:  90%|█████████ | 18/20 [10:00<01:06, 33.15s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.336,  Train_accy 79.32:  90%|█████████ | 18/20 [10:32<01:06, 33.15s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.336,  Train_accy 79.32:  95%|█████████▌| 19/20 [10:32<00:32, 32.91s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.361,  Train_accy 78.27:  95%|█████████▌| 19/20 [11:05<00:32, 32.91s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.361,  Train_accy 78.27: 100%|██████████| 20/20 [11:05<00:00, 32.74s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.361,  Train_accy 78.27: 100%|██████████| 20/20 [11:05<00:00, 33.26s/it]
2024-09-05 10:06:39,382 [foster.py] => SNet: Task 10, Epoch 20/20 => Loss 1.361,  Train_accy 78.27
2024-09-05 10:06:39,382 [foster.py] => do not weight align student!
2024-09-05 10:06:43,676 [foster.py] => darknet eval: 
2024-09-05 10:06:43,677 [foster.py] => CNN top1 curve: 84.42
2024-09-05 10:06:43,677 [foster.py] => CNN top5 curve: 97.93
2024-09-05 10:06:43,681 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 10:07:53,180 [foster.py] => Exemplar size: 2200
2024-09-05 10:07:53,180 [trainer.py] => CNN: {'total': 85.8, '00-09': 94.07, '10-19': 93.8, '20-29': 95.88, '30-39': 85.45, '40-49': 93.46, '50-59': 89.19, '60-69': 83.02, '70-79': 90.78, '80-89': 87.97, '90-99': 79.41, '100-109': 51.3, 'old': 89.14, 'new': 51.3}
2024-09-05 10:07:53,180 [trainer.py] => NME: {'total': 92.17, '00-09': 90.68, '10-19': 90.7, '20-29': 97.94, '30-39': 82.73, '40-49': 95.33, '50-59': 89.19, '60-69': 92.45, '70-79': 95.04, '80-89': 93.98, '90-99': 91.91, '100-109': 93.91, 'old': 92.0, 'new': 93.91}
2024-09-05 10:07:53,180 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8]
2024-09-05 10:07:53,180 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16]
2024-09-05 10:07:53,180 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17]
2024-09-05 10:07:53,180 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85]

Average Accuracy (CNN): 88.46
Average Accuracy (NME): 94.62
2024-09-05 10:07:53,180 [trainer.py] => Average Accuracy (CNN): 88.46
2024-09-05 10:07:53,180 [trainer.py] => Average Accuracy (NME): 94.62
2024-09-05 10:07:53,182 [trainer.py] => All params: 171927872
2024-09-05 10:07:53,183 [trainer.py] => Trainable params: 86052316
2024-09-05 10:07:54,539 [foster.py] => Learning on 110-120
2024-09-05 10:07:54,541 [foster.py] => All params: 171958622
2024-09-05 10:07:54,541 [foster.py] => Trainable params: 86075376
2024-09-05 10:07:54,590 [foster.py] => per cls weights : [1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 0.57933658 0.57933658 0.57933658 0.57933658
 0.57933658 0.57933658 0.57933658 0.57933658 0.57933658 0.57933658]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 5.706, Loss_clf 0.963, Loss_fe 3.290, Loss_kd 1.332, Train_accy 74.32, Test_accy 82.98:   0%|          | 0/20 [00:35<?, ?it/s]
Task 11, Epoch 1/20 => Loss 5.706, Loss_clf 0.963, Loss_fe 3.290, Loss_kd 1.332, Train_accy 74.32, Test_accy 82.98:   5%|▌         | 1/20 [00:35<11:15, 35.53s/it]
Task 11, Epoch 2/20 => Loss 3.152, Loss_clf 0.613, Loss_fe 1.067, Loss_kd 1.349, Train_accy 75.33:   5%|▌         | 1/20 [01:02<11:15, 35.53s/it]                 
Task 11, Epoch 2/20 => Loss 3.152, Loss_clf 0.613, Loss_fe 1.067, Loss_kd 1.349, Train_accy 75.33:  10%|█         | 2/20 [01:02<09:13, 30.73s/it]
Task 11, Epoch 3/20 => Loss 2.793, Loss_clf 0.556, Loss_fe 0.801, Loss_kd 1.316, Train_accy 76.75:  10%|█         | 2/20 [01:30<09:13, 30.73s/it]
Task 11, Epoch 3/20 => Loss 2.793, Loss_clf 0.556, Loss_fe 0.801, Loss_kd 1.316, Train_accy 76.75:  15%|█▌        | 3/20 [01:30<08:17, 29.27s/it]
Task 11, Epoch 4/20 => Loss 2.564, Loss_clf 0.489, Loss_fe 0.643, Loss_kd 1.312, Train_accy 77.12:  15%|█▌        | 3/20 [01:58<08:17, 29.27s/it]
Task 11, Epoch 4/20 => Loss 2.564, Loss_clf 0.489, Loss_fe 0.643, Loss_kd 1.312, Train_accy 77.12:  20%|██        | 4/20 [01:58<07:37, 28.62s/it]
Task 11, Epoch 5/20 => Loss 2.459, Loss_clf 0.449, Loss_fe 0.582, Loss_kd 1.309, Train_accy 77.76:  20%|██        | 4/20 [02:25<07:37, 28.62s/it]
Task 11, Epoch 5/20 => Loss 2.459, Loss_clf 0.449, Loss_fe 0.582, Loss_kd 1.309, Train_accy 77.76:  25%|██▌       | 5/20 [02:25<07:03, 28.25s/it]
Task 11, Epoch 6/20 => Loss 2.427, Loss_clf 0.471, Loss_fe 0.537, Loss_kd 1.301, Train_accy 78.25, Test_accy 84.25:  25%|██▌       | 5/20 [03:01<07:03, 28.25s/it]
Task 11, Epoch 6/20 => Loss 2.427, Loss_clf 0.471, Loss_fe 0.537, Loss_kd 1.301, Train_accy 78.25, Test_accy 84.25:  30%|███       | 6/20 [03:01<07:12, 30.91s/it]
Task 11, Epoch 7/20 => Loss 2.329, Loss_clf 0.431, Loss_fe 0.482, Loss_kd 1.298, Train_accy 78.10:  30%|███       | 6/20 [03:29<07:12, 30.91s/it]                 
Task 11, Epoch 7/20 => Loss 2.329, Loss_clf 0.431, Loss_fe 0.482, Loss_kd 1.298, Train_accy 78.10:  35%|███▌      | 7/20 [03:29<06:27, 29.85s/it]
Task 11, Epoch 8/20 => Loss 2.196, Loss_clf 0.382, Loss_fe 0.413, Loss_kd 1.284, Train_accy 79.22:  35%|███▌      | 7/20 [03:57<06:27, 29.85s/it]
Task 11, Epoch 8/20 => Loss 2.196, Loss_clf 0.382, Loss_fe 0.413, Loss_kd 1.284, Train_accy 79.22:  40%|████      | 8/20 [03:57<05:49, 29.16s/it]
Task 11, Epoch 9/20 => Loss 2.320, Loss_clf 0.427, Loss_fe 0.442, Loss_kd 1.330, Train_accy 77.99:  40%|████      | 8/20 [04:24<05:49, 29.16s/it]
Task 11, Epoch 9/20 => Loss 2.320, Loss_clf 0.427, Loss_fe 0.442, Loss_kd 1.330, Train_accy 77.99:  45%|████▌     | 9/20 [04:24<05:15, 28.69s/it]
Task 11, Epoch 10/20 => Loss 2.154, Loss_clf 0.359, Loss_fe 0.384, Loss_kd 1.293, Train_accy 80.31:  45%|████▌     | 9/20 [04:52<05:15, 28.69s/it]
Task 11, Epoch 10/20 => Loss 2.154, Loss_clf 0.359, Loss_fe 0.384, Loss_kd 1.293, Train_accy 80.31:  50%|█████     | 10/20 [04:52<04:43, 28.37s/it]
Task 11, Epoch 11/20 => Loss 2.142, Loss_clf 0.355, Loss_fe 0.371, Loss_kd 1.297, Train_accy 79.37, Test_accy 84.11:  50%|█████     | 10/20 [05:28<04:43, 28.37s/it]
Task 11, Epoch 11/20 => Loss 2.142, Loss_clf 0.355, Loss_fe 0.371, Loss_kd 1.297, Train_accy 79.37, Test_accy 84.11:  55%|█████▌    | 11/20 [05:28<04:36, 30.74s/it]
Task 11, Epoch 12/20 => Loss 2.144, Loss_clf 0.388, Loss_fe 0.357, Loss_kd 1.283, Train_accy 78.70:  55%|█████▌    | 11/20 [05:56<04:36, 30.74s/it]                 
Task 11, Epoch 12/20 => Loss 2.144, Loss_clf 0.388, Loss_fe 0.357, Loss_kd 1.283, Train_accy 78.70:  60%|██████    | 12/20 [05:56<03:58, 29.83s/it]
Task 11, Epoch 13/20 => Loss 2.176, Loss_clf 0.375, Loss_fe 0.363, Loss_kd 1.318, Train_accy 79.75:  60%|██████    | 12/20 [06:23<03:58, 29.83s/it]
Task 11, Epoch 13/20 => Loss 2.176, Loss_clf 0.375, Loss_fe 0.363, Loss_kd 1.318, Train_accy 79.75:  65%|██████▌   | 13/20 [06:23<03:24, 29.20s/it]
Task 11, Epoch 14/20 => Loss 2.082, Loss_clf 0.354, Loss_fe 0.325, Loss_kd 1.286, Train_accy 79.78:  65%|██████▌   | 13/20 [06:51<03:24, 29.20s/it]
Task 11, Epoch 14/20 => Loss 2.082, Loss_clf 0.354, Loss_fe 0.325, Loss_kd 1.286, Train_accy 79.78:  70%|███████   | 14/20 [06:51<02:52, 28.76s/it]
Task 11, Epoch 15/20 => Loss 2.025, Loss_clf 0.330, Loss_fe 0.296, Loss_kd 1.283, Train_accy 80.87:  70%|███████   | 14/20 [07:19<02:52, 28.76s/it]
Task 11, Epoch 15/20 => Loss 2.025, Loss_clf 0.330, Loss_fe 0.296, Loss_kd 1.283, Train_accy 80.87:  75%|███████▌  | 15/20 [07:19<02:22, 28.44s/it]
Task 11, Epoch 16/20 => Loss 2.057, Loss_clf 0.348, Loss_fe 0.302, Loss_kd 1.289, Train_accy 80.61, Test_accy 84.46:  75%|███████▌  | 15/20 [07:55<02:22, 28.44s/it]
Task 11, Epoch 16/20 => Loss 2.057, Loss_clf 0.348, Loss_fe 0.302, Loss_kd 1.289, Train_accy 80.61, Test_accy 84.46:  80%|████████  | 16/20 [07:55<02:02, 30.75s/it]
Task 11, Epoch 17/20 => Loss 1.962, Loss_clf 0.310, Loss_fe 0.273, Loss_kd 1.264, Train_accy 80.87:  80%|████████  | 16/20 [08:23<02:02, 30.75s/it]                 
Task 11, Epoch 17/20 => Loss 1.962, Loss_clf 0.310, Loss_fe 0.273, Loss_kd 1.264, Train_accy 80.87:  85%|████████▌ | 17/20 [08:23<01:29, 29.85s/it]
Task 11, Epoch 18/20 => Loss 2.092, Loss_clf 0.376, Loss_fe 0.307, Loss_kd 1.291, Train_accy 79.60:  85%|████████▌ | 17/20 [08:50<01:29, 29.85s/it]
Task 11, Epoch 18/20 => Loss 2.092, Loss_clf 0.376, Loss_fe 0.307, Loss_kd 1.291, Train_accy 79.60:  90%|█████████ | 18/20 [08:50<00:58, 29.20s/it]
Task 11, Epoch 19/20 => Loss 2.049, Loss_clf 0.345, Loss_fe 0.298, Loss_kd 1.290, Train_accy 80.12:  90%|█████████ | 18/20 [09:18<00:58, 29.20s/it]
Task 11, Epoch 19/20 => Loss 2.049, Loss_clf 0.345, Loss_fe 0.298, Loss_kd 1.290, Train_accy 80.12:  95%|█████████▌| 19/20 [09:18<00:28, 28.77s/it]
Task 11, Epoch 20/20 => Loss 2.057, Loss_clf 0.339, Loss_fe 0.298, Loss_kd 1.301, Train_accy 80.19:  95%|█████████▌| 19/20 [09:46<00:28, 28.77s/it]
Task 11, Epoch 20/20 => Loss 2.057, Loss_clf 0.339, Loss_fe 0.298, Loss_kd 1.301, Train_accy 80.19: 100%|██████████| 20/20 [09:46<00:00, 28.46s/it]
Task 11, Epoch 20/20 => Loss 2.057, Loss_clf 0.339, Loss_fe 0.298, Loss_kd 1.301, Train_accy 80.19: 100%|██████████| 20/20 [09:46<00:00, 29.32s/it]
2024-09-05 10:17:41,063 [foster.py] => Task 11, Epoch 20/20 => Loss 2.057, Loss_clf 0.339, Loss_fe 0.298, Loss_kd 1.301, Train_accy 80.19
2024-09-05 10:17:41,064 [foster.py] => do not weight align teacher!
2024-09-05 10:17:41,068 [foster.py] => per cls weights : [1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 0.47786048 0.47786048 0.47786048 0.47786048
 0.47786048 0.47786048 0.47786048 0.47786048 0.47786048 0.47786048]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 11, Epoch 1/20 => Loss 1.379,  Train_accy 74.62, Test_accy 83.83:   0%|          | 0/20 [00:39<?, ?it/s]
SNet: Task 11, Epoch 1/20 => Loss 1.379,  Train_accy 74.62, Test_accy 83.83:   5%|▌         | 1/20 [00:39<12:29, 39.47s/it]
SNet: Task 11, Epoch 2/20 => Loss 1.280,  Train_accy 76.49:   5%|▌         | 1/20 [01:14<12:29, 39.47s/it]                 
SNet: Task 11, Epoch 2/20 => Loss 1.280,  Train_accy 76.49:  10%|█         | 2/20 [01:14<11:00, 36.71s/it]
SNet: Task 11, Epoch 3/20 => Loss 1.305,  Train_accy 76.26:  10%|█         | 2/20 [01:49<11:00, 36.71s/it]
SNet: Task 11, Epoch 3/20 => Loss 1.305,  Train_accy 76.26:  15%|█▌        | 3/20 [01:49<10:09, 35.85s/it]
SNet: Task 11, Epoch 4/20 => Loss 1.247,  Train_accy 77.35:  15%|█▌        | 3/20 [02:23<10:09, 35.85s/it]
SNet: Task 11, Epoch 4/20 => Loss 1.247,  Train_accy 77.35:  20%|██        | 4/20 [02:23<09:27, 35.45s/it]
SNet: Task 11, Epoch 5/20 => Loss 1.256,  Train_accy 76.79:  20%|██        | 4/20 [02:58<09:27, 35.45s/it]
SNet: Task 11, Epoch 5/20 => Loss 1.256,  Train_accy 76.79:  25%|██▌       | 5/20 [02:58<08:48, 35.22s/it]
SNet: Task 11, Epoch 6/20 => Loss 1.282,  Train_accy 76.41, Test_accy 84.18:  25%|██▌       | 5/20 [03:38<08:48, 35.22s/it]
SNet: Task 11, Epoch 6/20 => Loss 1.282,  Train_accy 76.41, Test_accy 84.18:  30%|███       | 6/20 [03:38<08:33, 36.66s/it]
SNet: Task 11, Epoch 7/20 => Loss 1.264,  Train_accy 77.76:  30%|███       | 6/20 [04:12<08:33, 36.66s/it]                 
SNet: Task 11, Epoch 7/20 => Loss 1.264,  Train_accy 77.76:  35%|███▌      | 7/20 [04:12<07:48, 36.05s/it]
SNet: Task 11, Epoch 8/20 => Loss 1.240,  Train_accy 78.06:  35%|███▌      | 7/20 [04:47<07:48, 36.05s/it]
SNet: Task 11, Epoch 8/20 => Loss 1.240,  Train_accy 78.06:  40%|████      | 8/20 [04:47<07:07, 35.66s/it]
SNet: Task 11, Epoch 9/20 => Loss 1.266,  Train_accy 77.87:  40%|████      | 8/20 [05:22<07:07, 35.66s/it]
SNet: Task 11, Epoch 9/20 => Loss 1.266,  Train_accy 77.87:  45%|████▌     | 9/20 [05:22<06:29, 35.38s/it]
SNet: Task 11, Epoch 10/20 => Loss 1.260,  Train_accy 77.54:  45%|████▌     | 9/20 [05:57<06:29, 35.38s/it]
SNet: Task 11, Epoch 10/20 => Loss 1.260,  Train_accy 77.54:  50%|█████     | 10/20 [05:57<05:52, 35.22s/it]
SNet: Task 11, Epoch 11/20 => Loss 1.276,  Train_accy 77.87, Test_accy 84.11:  50%|█████     | 10/20 [06:36<05:52, 35.22s/it]
SNet: Task 11, Epoch 11/20 => Loss 1.276,  Train_accy 77.87, Test_accy 84.11:  55%|█████▌    | 11/20 [06:36<05:28, 36.51s/it]
SNet: Task 11, Epoch 12/20 => Loss 1.257,  Train_accy 77.24:  55%|█████▌    | 11/20 [07:11<05:28, 36.51s/it]                 
SNet: Task 11, Epoch 12/20 => Loss 1.257,  Train_accy 77.24:  60%|██████    | 12/20 [07:11<04:47, 36.00s/it]
SNet: Task 11, Epoch 13/20 => Loss 1.272,  Train_accy 78.40:  60%|██████    | 12/20 [07:46<04:47, 36.00s/it]
SNet: Task 11, Epoch 13/20 => Loss 1.272,  Train_accy 78.40:  65%|██████▌   | 13/20 [07:46<04:09, 35.63s/it]
SNet: Task 11, Epoch 14/20 => Loss 1.259,  Train_accy 77.20:  65%|██████▌   | 13/20 [08:21<04:09, 35.63s/it]
SNet: Task 11, Epoch 14/20 => Loss 1.259,  Train_accy 77.20:  70%|███████   | 14/20 [08:21<03:32, 35.39s/it]
SNet: Task 11, Epoch 15/20 => Loss 1.281,  Train_accy 77.05:  70%|███████   | 14/20 [08:56<03:32, 35.39s/it]
SNet: Task 11, Epoch 15/20 => Loss 1.281,  Train_accy 77.05:  75%|███████▌  | 15/20 [08:56<02:56, 35.20s/it]
SNet: Task 11, Epoch 16/20 => Loss 1.246,  Train_accy 78.40, Test_accy 84.39:  75%|███████▌  | 15/20 [09:35<02:56, 35.20s/it]
SNet: Task 11, Epoch 16/20 => Loss 1.246,  Train_accy 78.40, Test_accy 84.39:  80%|████████  | 16/20 [09:35<02:25, 36.49s/it]
SNet: Task 11, Epoch 17/20 => Loss 1.246,  Train_accy 77.50:  80%|████████  | 16/20 [10:10<02:25, 36.49s/it]                 
SNet: Task 11, Epoch 17/20 => Loss 1.246,  Train_accy 77.50:  85%|████████▌ | 17/20 [10:10<01:47, 35.97s/it]
SNet: Task 11, Epoch 18/20 => Loss 1.271,  Train_accy 77.99:  85%|████████▌ | 17/20 [10:45<01:47, 35.97s/it]
SNet: Task 11, Epoch 18/20 => Loss 1.271,  Train_accy 77.99:  90%|█████████ | 18/20 [10:45<01:11, 35.61s/it]
SNet: Task 11, Epoch 19/20 => Loss 1.250,  Train_accy 78.32:  90%|█████████ | 18/20 [11:19<01:11, 35.61s/it]
SNet: Task 11, Epoch 19/20 => Loss 1.250,  Train_accy 78.32:  95%|█████████▌| 19/20 [11:19<00:35, 35.36s/it]
SNet: Task 11, Epoch 20/20 => Loss 1.227,  Train_accy 78.51:  95%|█████████▌| 19/20 [11:54<00:35, 35.36s/it]
SNet: Task 11, Epoch 20/20 => Loss 1.227,  Train_accy 78.51: 100%|██████████| 20/20 [11:54<00:00, 35.20s/it]
SNet: Task 11, Epoch 20/20 => Loss 1.227,  Train_accy 78.51: 100%|██████████| 20/20 [11:54<00:00, 35.73s/it]
2024-09-05 10:29:37,318 [foster.py] => SNet: Task 11, Epoch 20/20 => Loss 1.227,  Train_accy 78.51
2024-09-05 10:29:37,318 [foster.py] => do not weight align student!
2024-09-05 10:29:41,948 [foster.py] => darknet eval: 
2024-09-05 10:29:41,948 [foster.py] => CNN top1 curve: 84.25
2024-09-05 10:29:41,949 [foster.py] => CNN top5 curve: 97.6
2024-09-05 10:29:41,951 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 10:30:57,023 [foster.py] => Exemplar size: 2400
2024-09-05 10:30:57,023 [trainer.py] => CNN: {'total': 84.25, '00-09': 92.37, '10-19': 92.25, '20-29': 96.91, '30-39': 86.36, '40-49': 93.46, '50-59': 85.59, '60-69': 87.74, '70-79': 88.65, '80-89': 91.73, '90-99': 86.03, '100-109': 74.78, '110-119': 33.63, 'old': 88.64, 'new': 33.63}
2024-09-05 10:30:57,023 [trainer.py] => NME: {'total': 89.97, '00-09': 87.29, '10-19': 89.92, '20-29': 97.94, '30-39': 81.82, '40-49': 94.39, '50-59': 86.49, '60-69': 90.57, '70-79': 87.94, '80-89': 93.98, '90-99': 90.44, '100-109': 93.04, '110-119': 86.73, 'old': 90.25, 'new': 86.73}
2024-09-05 10:30:57,023 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25]
2024-09-05 10:30:57,023 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52]
2024-09-05 10:30:57,023 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97]
2024-09-05 10:30:57,023 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59]

Average Accuracy (CNN): 88.11
Average Accuracy (NME): 94.23
2024-09-05 10:30:57,023 [trainer.py] => Average Accuracy (CNN): 88.11
2024-09-05 10:30:57,023 [trainer.py] => Average Accuracy (NME): 94.23
2024-09-05 10:30:57,025 [trainer.py] => All params: 171958622
2024-09-05 10:30:57,026 [trainer.py] => Trainable params: 86075376
2024-09-05 10:30:58,531 [foster.py] => Learning on 120-130
2024-09-05 10:30:58,533 [foster.py] => All params: 171989372
2024-09-05 10:30:58,533 [foster.py] => Trainable params: 86098436
2024-09-05 10:30:58,581 [foster.py] => per cls weights : [1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 0.57763734 0.57763734 0.57763734 0.57763734 0.57763734 0.57763734
 0.57763734 0.57763734 0.57763734 0.57763734]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 5.966, Loss_clf 0.948, Loss_fe 3.532, Loss_kd 1.372, Train_accy 75.43, Test_accy 84.11:   0%|          | 0/20 [00:38<?, ?it/s]
Task 12, Epoch 1/20 => Loss 5.966, Loss_clf 0.948, Loss_fe 3.532, Loss_kd 1.372, Train_accy 75.43, Test_accy 84.11:   5%|▌         | 1/20 [00:38<12:06, 38.24s/it]
Task 12, Epoch 2/20 => Loss 3.202, Loss_clf 0.549, Loss_fe 1.184, Loss_kd 1.356, Train_accy 78.87:   5%|▌         | 1/20 [01:07<12:06, 38.24s/it]                 
Task 12, Epoch 2/20 => Loss 3.202, Loss_clf 0.549, Loss_fe 1.184, Loss_kd 1.356, Train_accy 78.87:  10%|█         | 2/20 [01:07<09:56, 33.13s/it]
Task 12, Epoch 3/20 => Loss 2.887, Loss_clf 0.557, Loss_fe 0.855, Loss_kd 1.362, Train_accy 79.15:  10%|█         | 2/20 [01:37<09:56, 33.13s/it]
Task 12, Epoch 3/20 => Loss 2.887, Loss_clf 0.557, Loss_fe 0.855, Loss_kd 1.362, Train_accy 79.15:  15%|█▌        | 3/20 [01:37<08:56, 31.57s/it]
Task 12, Epoch 4/20 => Loss 2.776, Loss_clf 0.543, Loss_fe 0.763, Loss_kd 1.358, Train_accy 79.32:  15%|█▌        | 3/20 [02:07<08:56, 31.57s/it]
Task 12, Epoch 4/20 => Loss 2.776, Loss_clf 0.543, Loss_fe 0.763, Loss_kd 1.358, Train_accy 79.32:  20%|██        | 4/20 [02:07<08:13, 30.87s/it]
Task 12, Epoch 5/20 => Loss 2.565, Loss_clf 0.463, Loss_fe 0.609, Loss_kd 1.379, Train_accy 81.09:  20%|██        | 4/20 [02:37<08:13, 30.87s/it]
Task 12, Epoch 5/20 => Loss 2.565, Loss_clf 0.463, Loss_fe 0.609, Loss_kd 1.379, Train_accy 81.09:  25%|██▌       | 5/20 [02:37<07:37, 30.50s/it]
Task 12, Epoch 6/20 => Loss 2.436, Loss_clf 0.429, Loss_fe 0.555, Loss_kd 1.340, Train_accy 81.64, Test_accy 84.31:  25%|██▌       | 5/20 [03:16<07:37, 30.50s/it]
Task 12, Epoch 6/20 => Loss 2.436, Loss_clf 0.429, Loss_fe 0.555, Loss_kd 1.340, Train_accy 81.64, Test_accy 84.31:  30%|███       | 6/20 [03:16<07:46, 33.34s/it]
Task 12, Epoch 7/20 => Loss 2.432, Loss_clf 0.442, Loss_fe 0.510, Loss_kd 1.366, Train_accy 80.85:  30%|███       | 6/20 [03:45<07:46, 33.34s/it]                 
Task 12, Epoch 7/20 => Loss 2.432, Loss_clf 0.442, Loss_fe 0.510, Loss_kd 1.366, Train_accy 80.85:  35%|███▌      | 7/20 [03:45<06:58, 32.19s/it]
Task 12, Epoch 8/20 => Loss 2.372, Loss_clf 0.425, Loss_fe 0.484, Loss_kd 1.351, Train_accy 80.99:  35%|███▌      | 7/20 [04:15<06:58, 32.19s/it]
Task 12, Epoch 8/20 => Loss 2.372, Loss_clf 0.425, Loss_fe 0.484, Loss_kd 1.351, Train_accy 80.99:  40%|████      | 8/20 [04:15<06:17, 31.45s/it]
Task 12, Epoch 9/20 => Loss 2.424, Loss_clf 0.462, Loss_fe 0.473, Loss_kd 1.375, Train_accy 80.81:  40%|████      | 8/20 [04:45<06:17, 31.45s/it]
Task 12, Epoch 9/20 => Loss 2.424, Loss_clf 0.462, Loss_fe 0.473, Loss_kd 1.375, Train_accy 80.81:  45%|████▌     | 9/20 [04:45<05:40, 30.95s/it]
Task 12, Epoch 10/20 => Loss 2.358, Loss_clf 0.446, Loss_fe 0.446, Loss_kd 1.354, Train_accy 82.10:  45%|████▌     | 9/20 [05:15<05:40, 30.95s/it]
Task 12, Epoch 10/20 => Loss 2.358, Loss_clf 0.446, Loss_fe 0.446, Loss_kd 1.354, Train_accy 82.10:  50%|█████     | 10/20 [05:15<05:06, 30.62s/it]
Task 12, Epoch 11/20 => Loss 2.283, Loss_clf 0.405, Loss_fe 0.419, Loss_kd 1.347, Train_accy 82.44, Test_accy 85.10:  50%|█████     | 10/20 [05:54<05:06, 30.62s/it]
Task 12, Epoch 11/20 => Loss 2.283, Loss_clf 0.405, Loss_fe 0.419, Loss_kd 1.347, Train_accy 82.44, Test_accy 85.10:  55%|█████▌    | 11/20 [05:54<04:58, 33.16s/it]
Task 12, Epoch 12/20 => Loss 2.365, Loss_clf 0.446, Loss_fe 0.422, Loss_kd 1.382, Train_accy 81.85:  55%|█████▌    | 11/20 [06:24<04:58, 33.16s/it]                 
Task 12, Epoch 12/20 => Loss 2.365, Loss_clf 0.446, Loss_fe 0.422, Loss_kd 1.382, Train_accy 81.85:  60%|██████    | 12/20 [06:24<04:17, 32.16s/it]
Task 12, Epoch 13/20 => Loss 2.108, Loss_clf 0.342, Loss_fe 0.324, Loss_kd 1.330, Train_accy 83.55:  60%|██████    | 12/20 [06:54<04:17, 32.16s/it]
Task 12, Epoch 13/20 => Loss 2.108, Loss_clf 0.342, Loss_fe 0.324, Loss_kd 1.330, Train_accy 83.55:  65%|██████▌   | 13/20 [06:54<03:40, 31.46s/it]
Task 12, Epoch 14/20 => Loss 2.257, Loss_clf 0.384, Loss_fe 0.382, Loss_kd 1.376, Train_accy 83.34:  65%|██████▌   | 13/20 [07:23<03:40, 31.46s/it]
Task 12, Epoch 14/20 => Loss 2.257, Loss_clf 0.384, Loss_fe 0.382, Loss_kd 1.376, Train_accy 83.34:  70%|███████   | 14/20 [07:23<03:05, 30.98s/it]
Task 12, Epoch 15/20 => Loss 2.133, Loss_clf 0.348, Loss_fe 0.335, Loss_kd 1.338, Train_accy 83.52:  70%|███████   | 14/20 [07:53<03:05, 30.98s/it]
Task 12, Epoch 15/20 => Loss 2.133, Loss_clf 0.348, Loss_fe 0.335, Loss_kd 1.338, Train_accy 83.52:  75%|███████▌  | 15/20 [07:53<02:33, 30.65s/it]
Task 12, Epoch 16/20 => Loss 2.140, Loss_clf 0.376, Loss_fe 0.320, Loss_kd 1.333, Train_accy 83.62, Test_accy 85.29:  75%|███████▌  | 15/20 [08:32<02:33, 30.65s/it]
Task 12, Epoch 16/20 => Loss 2.140, Loss_clf 0.376, Loss_fe 0.320, Loss_kd 1.333, Train_accy 83.62, Test_accy 85.29:  80%|████████  | 16/20 [08:32<02:12, 33.16s/it]
Task 12, Epoch 17/20 => Loss 2.156, Loss_clf 0.372, Loss_fe 0.301, Loss_kd 1.369, Train_accy 85.25:  80%|████████  | 16/20 [09:02<02:12, 33.16s/it]                 
Task 12, Epoch 17/20 => Loss 2.156, Loss_clf 0.372, Loss_fe 0.301, Loss_kd 1.369, Train_accy 85.25:  85%|████████▌ | 17/20 [09:02<01:36, 32.17s/it]
Task 12, Epoch 18/20 => Loss 2.088, Loss_clf 0.360, Loss_fe 0.295, Loss_kd 1.322, Train_accy 83.97:  85%|████████▌ | 17/20 [09:32<01:36, 32.17s/it]
Task 12, Epoch 18/20 => Loss 2.088, Loss_clf 0.360, Loss_fe 0.295, Loss_kd 1.322, Train_accy 83.97:  90%|█████████ | 18/20 [09:32<01:02, 31.48s/it]
Task 12, Epoch 19/20 => Loss 2.159, Loss_clf 0.375, Loss_fe 0.319, Loss_kd 1.353, Train_accy 83.55:  90%|█████████ | 18/20 [10:02<01:02, 31.48s/it]
Task 12, Epoch 19/20 => Loss 2.159, Loss_clf 0.375, Loss_fe 0.319, Loss_kd 1.353, Train_accy 83.55:  95%|█████████▌| 19/20 [10:02<00:31, 31.01s/it]
Task 12, Epoch 20/20 => Loss 2.178, Loss_clf 0.392, Loss_fe 0.322, Loss_kd 1.352, Train_accy 83.83:  95%|█████████▌| 19/20 [10:32<00:31, 31.01s/it]
Task 12, Epoch 20/20 => Loss 2.178, Loss_clf 0.392, Loss_fe 0.322, Loss_kd 1.352, Train_accy 83.83: 100%|██████████| 20/20 [10:32<00:00, 30.67s/it]
Task 12, Epoch 20/20 => Loss 2.178, Loss_clf 0.392, Loss_fe 0.322, Loss_kd 1.352, Train_accy 83.83: 100%|██████████| 20/20 [10:32<00:00, 31.62s/it]
2024-09-05 10:41:30,914 [foster.py] => Task 12, Epoch 20/20 => Loss 2.178, Loss_clf 0.392, Loss_fe 0.322, Loss_kd 1.352, Train_accy 83.83
2024-09-05 10:41:30,914 [foster.py] => do not weight align teacher!
2024-09-05 10:41:30,916 [foster.py] => per cls weights : [1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 0.476122  0.476122  0.476122  0.476122  0.476122  0.476122
 0.476122  0.476122  0.476122  0.476122 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 12, Epoch 1/20 => Loss 1.426,  Train_accy 75.82, Test_accy 84.11:   0%|          | 0/20 [00:42<?, ?it/s]
SNet: Task 12, Epoch 1/20 => Loss 1.426,  Train_accy 75.82, Test_accy 84.11:   5%|▌         | 1/20 [00:42<13:25, 42.41s/it]
SNet: Task 12, Epoch 2/20 => Loss 1.300,  Train_accy 79.81:   5%|▌         | 1/20 [01:19<13:25, 42.41s/it]                 
SNet: Task 12, Epoch 2/20 => Loss 1.300,  Train_accy 79.81:  10%|█         | 2/20 [01:19<11:51, 39.53s/it]
SNet: Task 12, Epoch 3/20 => Loss 1.317,  Train_accy 79.63:  10%|█         | 2/20 [01:57<11:51, 39.53s/it]
SNet: Task 12, Epoch 3/20 => Loss 1.317,  Train_accy 79.63:  15%|█▌        | 3/20 [01:57<10:56, 38.61s/it]
SNet: Task 12, Epoch 4/20 => Loss 1.312,  Train_accy 79.74:  15%|█▌        | 3/20 [02:34<10:56, 38.61s/it]
SNet: Task 12, Epoch 4/20 => Loss 1.312,  Train_accy 79.74:  20%|██        | 4/20 [02:34<10:10, 38.17s/it]
SNet: Task 12, Epoch 5/20 => Loss 1.317,  Train_accy 80.05:  20%|██        | 4/20 [03:12<10:10, 38.17s/it]
SNet: Task 12, Epoch 5/20 => Loss 1.317,  Train_accy 80.05:  25%|██▌       | 5/20 [03:12<09:29, 37.94s/it]
SNet: Task 12, Epoch 6/20 => Loss 1.330,  Train_accy 81.23, Test_accy 84.64:  25%|██▌       | 5/20 [03:54<09:29, 37.94s/it]
SNet: Task 12, Epoch 6/20 => Loss 1.330,  Train_accy 81.23, Test_accy 84.64:  30%|███       | 6/20 [03:54<09:12, 39.49s/it]
SNet: Task 12, Epoch 7/20 => Loss 1.326,  Train_accy 81.30:  30%|███       | 6/20 [04:32<09:12, 39.49s/it]                 
SNet: Task 12, Epoch 7/20 => Loss 1.326,  Train_accy 81.30:  35%|███▌      | 7/20 [04:32<08:24, 38.85s/it]
SNet: Task 12, Epoch 8/20 => Loss 1.298,  Train_accy 80.99:  35%|███▌      | 7/20 [05:09<08:24, 38.85s/it]
SNet: Task 12, Epoch 8/20 => Loss 1.298,  Train_accy 80.99:  40%|████      | 8/20 [05:09<07:41, 38.42s/it]
SNet: Task 12, Epoch 9/20 => Loss 1.269,  Train_accy 81.05:  40%|████      | 8/20 [05:47<07:41, 38.42s/it]
SNet: Task 12, Epoch 9/20 => Loss 1.269,  Train_accy 81.05:  45%|████▌     | 9/20 [05:47<06:59, 38.14s/it]
SNet: Task 12, Epoch 10/20 => Loss 1.305,  Train_accy 81.16:  45%|████▌     | 9/20 [06:25<06:59, 38.14s/it]
SNet: Task 12, Epoch 10/20 => Loss 1.305,  Train_accy 81.16:  50%|█████     | 10/20 [06:25<06:19, 37.97s/it]
SNet: Task 12, Epoch 11/20 => Loss 1.270,  Train_accy 81.40, Test_accy 84.24:  50%|█████     | 10/20 [07:07<06:19, 37.97s/it]
SNet: Task 12, Epoch 11/20 => Loss 1.270,  Train_accy 81.40, Test_accy 84.24:  55%|█████▌    | 11/20 [07:07<05:54, 39.34s/it]
SNet: Task 12, Epoch 12/20 => Loss 1.288,  Train_accy 81.92:  55%|█████▌    | 11/20 [07:45<05:54, 39.34s/it]                 
SNet: Task 12, Epoch 12/20 => Loss 1.288,  Train_accy 81.92:  60%|██████    | 12/20 [07:45<05:10, 38.79s/it]
SNet: Task 12, Epoch 13/20 => Loss 1.256,  Train_accy 81.51:  60%|██████    | 12/20 [08:22<05:10, 38.79s/it]
SNet: Task 12, Epoch 13/20 => Loss 1.256,  Train_accy 81.51:  65%|██████▌   | 13/20 [08:22<04:28, 38.40s/it]
SNet: Task 12, Epoch 14/20 => Loss 1.286,  Train_accy 81.64:  65%|██████▌   | 13/20 [09:00<04:28, 38.40s/it]
SNet: Task 12, Epoch 14/20 => Loss 1.286,  Train_accy 81.64:  70%|███████   | 14/20 [09:00<03:48, 38.15s/it]
SNet: Task 12, Epoch 15/20 => Loss 1.287,  Train_accy 81.26:  70%|███████   | 14/20 [09:37<03:48, 38.15s/it]
SNet: Task 12, Epoch 15/20 => Loss 1.287,  Train_accy 81.26:  75%|███████▌  | 15/20 [09:37<03:09, 37.96s/it]
SNet: Task 12, Epoch 16/20 => Loss 1.310,  Train_accy 81.09, Test_accy 84.50:  75%|███████▌  | 15/20 [10:20<03:09, 37.96s/it]
SNet: Task 12, Epoch 16/20 => Loss 1.310,  Train_accy 81.09, Test_accy 84.50:  80%|████████  | 16/20 [10:20<02:37, 39.31s/it]
SNet: Task 12, Epoch 17/20 => Loss 1.328,  Train_accy 80.64:  80%|████████  | 16/20 [10:57<02:37, 39.31s/it]                 
SNet: Task 12, Epoch 17/20 => Loss 1.328,  Train_accy 80.64:  85%|████████▌ | 17/20 [10:57<01:56, 38.77s/it]
SNet: Task 12, Epoch 18/20 => Loss 1.313,  Train_accy 81.09:  85%|████████▌ | 17/20 [11:35<01:56, 38.77s/it]
SNet: Task 12, Epoch 18/20 => Loss 1.313,  Train_accy 81.09:  90%|█████████ | 18/20 [11:35<01:16, 38.38s/it]
SNet: Task 12, Epoch 19/20 => Loss 1.313,  Train_accy 80.78:  90%|█████████ | 18/20 [12:12<01:16, 38.38s/it]
SNet: Task 12, Epoch 19/20 => Loss 1.313,  Train_accy 80.78:  95%|█████████▌| 19/20 [12:12<00:38, 38.14s/it]
SNet: Task 12, Epoch 20/20 => Loss 1.319,  Train_accy 80.88:  95%|█████████▌| 19/20 [12:50<00:38, 38.14s/it]
SNet: Task 12, Epoch 20/20 => Loss 1.319,  Train_accy 80.88: 100%|██████████| 20/20 [12:50<00:00, 37.96s/it]
SNet: Task 12, Epoch 20/20 => Loss 1.319,  Train_accy 80.88: 100%|██████████| 20/20 [12:50<00:00, 38.51s/it]
2024-09-05 10:54:22,695 [foster.py] => SNet: Task 12, Epoch 20/20 => Loss 1.319,  Train_accy 80.88
2024-09-05 10:54:22,695 [foster.py] => do not weight align student!
2024-09-05 10:54:27,624 [foster.py] => darknet eval: 
2024-09-05 10:54:27,625 [foster.py] => CNN top1 curve: 84.64
2024-09-05 10:54:27,625 [foster.py] => CNN top5 curve: 98.03
2024-09-05 10:54:27,627 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 10:55:48,756 [foster.py] => Exemplar size: 2600
2024-09-05 10:55:48,756 [trainer.py] => CNN: {'total': 84.96, '00-09': 90.68, '10-19': 91.47, '20-29': 95.88, '30-39': 84.55, '40-49': 92.52, '50-59': 87.39, '60-69': 89.62, '70-79': 92.2, '80-89': 90.98, '90-99': 88.97, '100-109': 87.83, '110-119': 60.18, '120-129': 47.66, 'old': 87.78, 'new': 47.66}
2024-09-05 10:55:48,756 [trainer.py] => NME: {'total': 89.23, '00-09': 88.14, '10-19': 87.6, '20-29': 96.91, '30-39': 84.55, '40-49': 88.79, '50-59': 89.19, '60-69': 90.57, '70-79': 89.36, '80-89': 93.98, '90-99': 88.97, '100-109': 95.65, '110-119': 81.42, '120-129': 85.05, 'old': 89.55, 'new': 85.05}
2024-09-05 10:55:48,756 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96]
2024-09-05 10:55:48,756 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36]
2024-09-05 10:55:48,756 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23]
2024-09-05 10:55:48,756 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82]

Average Accuracy (CNN): 87.86
Average Accuracy (NME): 93.85
2024-09-05 10:55:48,756 [trainer.py] => Average Accuracy (CNN): 87.86
2024-09-05 10:55:48,756 [trainer.py] => Average Accuracy (NME): 93.85
2024-09-05 10:55:48,758 [trainer.py] => All params: 171989372
2024-09-05 10:55:48,759 [trainer.py] => Trainable params: 86098436
2024-09-05 10:55:50,324 [foster.py] => Learning on 130-140
2024-09-05 10:55:50,325 [foster.py] => All params: 172020122
2024-09-05 10:55:50,326 [foster.py] => Trainable params: 86121496
2024-09-05 10:55:50,377 [foster.py] => per cls weights : [1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 0.57618877 0.57618877
 0.57618877 0.57618877 0.57618877 0.57618877 0.57618877 0.57618877
 0.57618877 0.57618877]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 5.622, Loss_clf 0.888, Loss_fe 3.307, Loss_kd 1.325, Train_accy 75.49, Test_accy 81.23:   0%|          | 0/20 [00:40<?, ?it/s]
Task 13, Epoch 1/20 => Loss 5.622, Loss_clf 0.888, Loss_fe 3.307, Loss_kd 1.325, Train_accy 75.49, Test_accy 81.23:   5%|▌         | 1/20 [00:40<12:54, 40.75s/it]
Task 13, Epoch 2/20 => Loss 3.100, Loss_clf 0.569, Loss_fe 1.101, Loss_kd 1.328, Train_accy 77.86:   5%|▌         | 1/20 [01:12<12:54, 40.75s/it]                 
Task 13, Epoch 2/20 => Loss 3.100, Loss_clf 0.569, Loss_fe 1.101, Loss_kd 1.328, Train_accy 77.86:  10%|█         | 2/20 [01:12<10:35, 35.30s/it]
Task 13, Epoch 3/20 => Loss 2.734, Loss_clf 0.527, Loss_fe 0.769, Loss_kd 1.335, Train_accy 78.91:  10%|█         | 2/20 [01:43<10:35, 35.30s/it]
Task 13, Epoch 3/20 => Loss 2.734, Loss_clf 0.527, Loss_fe 0.769, Loss_kd 1.335, Train_accy 78.91:  15%|█▌        | 3/20 [01:43<09:31, 33.62s/it]
Task 13, Epoch 4/20 => Loss 2.634, Loss_clf 0.517, Loss_fe 0.698, Loss_kd 1.317, Train_accy 80.86:  15%|█▌        | 3/20 [02:15<09:31, 33.62s/it]
Task 13, Epoch 4/20 => Loss 2.634, Loss_clf 0.517, Loss_fe 0.698, Loss_kd 1.317, Train_accy 80.86:  20%|██        | 4/20 [02:15<08:45, 32.84s/it]
Task 13, Epoch 5/20 => Loss 2.475, Loss_clf 0.460, Loss_fe 0.594, Loss_kd 1.319, Train_accy 80.24:  20%|██        | 4/20 [02:47<08:45, 32.84s/it]
Task 13, Epoch 5/20 => Loss 2.475, Loss_clf 0.460, Loss_fe 0.594, Loss_kd 1.319, Train_accy 80.24:  25%|██▌       | 5/20 [02:47<08:06, 32.43s/it]
Task 13, Epoch 6/20 => Loss 2.407, Loss_clf 0.464, Loss_fe 0.535, Loss_kd 1.308, Train_accy 82.26, Test_accy 84.64:  25%|██▌       | 5/20 [03:28<08:06, 32.43s/it]
Task 13, Epoch 6/20 => Loss 2.407, Loss_clf 0.464, Loss_fe 0.535, Loss_kd 1.308, Train_accy 82.26, Test_accy 84.64:  30%|███       | 6/20 [03:28<08:16, 35.47s/it]
Task 13, Epoch 7/20 => Loss 2.302, Loss_clf 0.431, Loss_fe 0.481, Loss_kd 1.290, Train_accy 81.77:  30%|███       | 6/20 [04:00<08:16, 35.47s/it]                 
Task 13, Epoch 7/20 => Loss 2.302, Loss_clf 0.431, Loss_fe 0.481, Loss_kd 1.290, Train_accy 81.77:  35%|███▌      | 7/20 [04:00<07:25, 34.26s/it]
Task 13, Epoch 8/20 => Loss 2.292, Loss_clf 0.423, Loss_fe 0.463, Loss_kd 1.306, Train_accy 81.93:  35%|███▌      | 7/20 [04:32<07:25, 34.26s/it]
Task 13, Epoch 8/20 => Loss 2.292, Loss_clf 0.423, Loss_fe 0.463, Loss_kd 1.306, Train_accy 81.93:  40%|████      | 8/20 [04:32<06:41, 33.47s/it]
Task 13, Epoch 9/20 => Loss 2.187, Loss_clf 0.381, Loss_fe 0.409, Loss_kd 1.298, Train_accy 82.81:  40%|████      | 8/20 [05:03<06:41, 33.47s/it]
Task 13, Epoch 9/20 => Loss 2.187, Loss_clf 0.381, Loss_fe 0.409, Loss_kd 1.298, Train_accy 82.81:  45%|████▌     | 9/20 [05:03<06:02, 32.95s/it]
Task 13, Epoch 10/20 => Loss 2.153, Loss_clf 0.376, Loss_fe 0.388, Loss_kd 1.290, Train_accy 83.24:  45%|████▌     | 9/20 [05:35<06:02, 32.95s/it]
Task 13, Epoch 10/20 => Loss 2.153, Loss_clf 0.376, Loss_fe 0.388, Loss_kd 1.290, Train_accy 83.24:  50%|█████     | 10/20 [05:35<05:26, 32.61s/it]
Task 13, Epoch 11/20 => Loss 2.175, Loss_clf 0.386, Loss_fe 0.394, Loss_kd 1.296, Train_accy 83.07, Test_accy 84.03:  50%|█████     | 10/20 [06:17<05:26, 32.61s/it]
Task 13, Epoch 11/20 => Loss 2.175, Loss_clf 0.386, Loss_fe 0.394, Loss_kd 1.296, Train_accy 83.07, Test_accy 84.03:  55%|█████▌    | 11/20 [06:17<05:17, 35.33s/it]
Task 13, Epoch 12/20 => Loss 2.212, Loss_clf 0.415, Loss_fe 0.375, Loss_kd 1.320, Train_accy 81.64:  55%|█████▌    | 11/20 [06:49<05:17, 35.33s/it]                 
Task 13, Epoch 12/20 => Loss 2.212, Loss_clf 0.415, Loss_fe 0.375, Loss_kd 1.320, Train_accy 81.64:  60%|██████    | 12/20 [06:49<04:34, 34.26s/it]
Task 13, Epoch 13/20 => Loss 2.165, Loss_clf 0.383, Loss_fe 0.373, Loss_kd 1.309, Train_accy 82.49:  60%|██████    | 12/20 [07:20<04:34, 34.26s/it]
Task 13, Epoch 13/20 => Loss 2.165, Loss_clf 0.383, Loss_fe 0.373, Loss_kd 1.309, Train_accy 82.49:  65%|██████▌   | 13/20 [07:20<03:54, 33.52s/it]
Task 13, Epoch 14/20 => Loss 2.151, Loss_clf 0.375, Loss_fe 0.349, Loss_kd 1.325, Train_accy 82.88:  65%|██████▌   | 13/20 [07:52<03:54, 33.52s/it]
Task 13, Epoch 14/20 => Loss 2.151, Loss_clf 0.375, Loss_fe 0.349, Loss_kd 1.325, Train_accy 82.88:  70%|███████   | 14/20 [07:52<03:17, 32.99s/it]
Task 13, Epoch 15/20 => Loss 2.178, Loss_clf 0.392, Loss_fe 0.355, Loss_kd 1.329, Train_accy 82.91:  70%|███████   | 14/20 [08:24<03:17, 32.99s/it]
Task 13, Epoch 15/20 => Loss 2.178, Loss_clf 0.392, Loss_fe 0.355, Loss_kd 1.329, Train_accy 82.91:  75%|███████▌  | 15/20 [08:24<02:43, 32.63s/it]
Task 13, Epoch 16/20 => Loss 2.066, Loss_clf 0.352, Loss_fe 0.327, Loss_kd 1.289, Train_accy 83.92, Test_accy 84.64:  75%|███████▌  | 15/20 [09:05<02:43, 32.63s/it]
Task 13, Epoch 16/20 => Loss 2.066, Loss_clf 0.352, Loss_fe 0.327, Loss_kd 1.289, Train_accy 83.92, Test_accy 84.64:  80%|████████  | 16/20 [09:05<02:21, 35.30s/it]
Task 13, Epoch 17/20 => Loss 2.141, Loss_clf 0.368, Loss_fe 0.337, Loss_kd 1.333, Train_accy 83.50:  80%|████████  | 16/20 [09:37<02:21, 35.30s/it]                 
Task 13, Epoch 17/20 => Loss 2.141, Loss_clf 0.368, Loss_fe 0.337, Loss_kd 1.333, Train_accy 83.50:  85%|████████▌ | 17/20 [09:37<01:42, 34.25s/it]
Task 13, Epoch 18/20 => Loss 2.026, Loss_clf 0.340, Loss_fe 0.299, Loss_kd 1.288, Train_accy 83.14:  85%|████████▌ | 17/20 [10:09<01:42, 34.25s/it]
Task 13, Epoch 18/20 => Loss 2.026, Loss_clf 0.340, Loss_fe 0.299, Loss_kd 1.288, Train_accy 83.14:  90%|█████████ | 18/20 [10:09<01:07, 33.52s/it]
Task 13, Epoch 19/20 => Loss 2.038, Loss_clf 0.351, Loss_fe 0.293, Loss_kd 1.294, Train_accy 83.76:  90%|█████████ | 18/20 [10:41<01:07, 33.52s/it]
Task 13, Epoch 19/20 => Loss 2.038, Loss_clf 0.351, Loss_fe 0.293, Loss_kd 1.294, Train_accy 83.76:  95%|█████████▌| 19/20 [10:41<00:33, 33.01s/it]
Task 13, Epoch 20/20 => Loss 2.098, Loss_clf 0.361, Loss_fe 0.320, Loss_kd 1.317, Train_accy 83.53:  95%|█████████▌| 19/20 [11:13<00:33, 33.01s/it]
Task 13, Epoch 20/20 => Loss 2.098, Loss_clf 0.361, Loss_fe 0.320, Loss_kd 1.317, Train_accy 83.53: 100%|██████████| 20/20 [11:13<00:00, 32.65s/it]
Task 13, Epoch 20/20 => Loss 2.098, Loss_clf 0.361, Loss_fe 0.320, Loss_kd 1.317, Train_accy 83.53: 100%|██████████| 20/20 [11:13<00:00, 33.66s/it]
2024-09-05 11:07:03,609 [foster.py] => Task 13, Epoch 20/20 => Loss 2.098, Loss_clf 0.361, Loss_fe 0.320, Loss_kd 1.317, Train_accy 83.53
2024-09-05 11:07:03,610 [foster.py] => do not weight align teacher!
2024-09-05 11:07:03,614 [foster.py] => per cls weights : [1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 0.47464191 0.47464191
 0.47464191 0.47464191 0.47464191 0.47464191 0.47464191 0.47464191
 0.47464191 0.47464191]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 13, Epoch 1/20 => Loss 1.375,  Train_accy 75.00, Test_accy 81.47:   0%|          | 0/20 [00:45<?, ?it/s]
SNet: Task 13, Epoch 1/20 => Loss 1.375,  Train_accy 75.00, Test_accy 81.47:   5%|▌         | 1/20 [00:45<14:22, 45.38s/it]
SNet: Task 13, Epoch 2/20 => Loss 1.257,  Train_accy 78.97:   5%|▌         | 1/20 [01:25<14:22, 45.38s/it]                 
SNet: Task 13, Epoch 2/20 => Loss 1.257,  Train_accy 78.97:  10%|█         | 2/20 [01:25<12:40, 42.23s/it]
SNet: Task 13, Epoch 3/20 => Loss 1.298,  Train_accy 78.32:  10%|█         | 2/20 [02:05<12:40, 42.23s/it]
SNet: Task 13, Epoch 3/20 => Loss 1.298,  Train_accy 78.32:  15%|█▌        | 3/20 [02:05<11:40, 41.19s/it]
SNet: Task 13, Epoch 4/20 => Loss 1.255,  Train_accy 79.59:  15%|█▌        | 3/20 [02:45<11:40, 41.19s/it]
SNet: Task 13, Epoch 4/20 => Loss 1.255,  Train_accy 79.59:  20%|██        | 4/20 [02:45<10:51, 40.69s/it]
SNet: Task 13, Epoch 5/20 => Loss 1.304,  Train_accy 79.00:  20%|██        | 4/20 [03:25<10:51, 40.69s/it]
SNet: Task 13, Epoch 5/20 => Loss 1.304,  Train_accy 79.00:  25%|██▌       | 5/20 [03:25<10:06, 40.43s/it]
SNet: Task 13, Epoch 6/20 => Loss 1.283,  Train_accy 79.00, Test_accy 83.18:  25%|██▌       | 5/20 [04:10<10:06, 40.43s/it]
SNet: Task 13, Epoch 6/20 => Loss 1.283,  Train_accy 79.00, Test_accy 83.18:  30%|███       | 6/20 [04:10<09:48, 42.04s/it]
SNet: Task 13, Epoch 7/20 => Loss 1.214,  Train_accy 79.92:  30%|███       | 6/20 [04:50<09:48, 42.04s/it]                 
SNet: Task 13, Epoch 7/20 => Loss 1.214,  Train_accy 79.92:  35%|███▌      | 7/20 [04:50<08:57, 41.36s/it]
SNet: Task 13, Epoch 8/20 => Loss 1.255,  Train_accy 79.07:  35%|███▌      | 7/20 [05:30<08:57, 41.36s/it]
SNet: Task 13, Epoch 8/20 => Loss 1.255,  Train_accy 79.07:  40%|████      | 8/20 [05:30<08:10, 40.91s/it]
SNet: Task 13, Epoch 9/20 => Loss 1.260,  Train_accy 80.05:  40%|████      | 8/20 [06:10<08:10, 40.91s/it]
SNet: Task 13, Epoch 9/20 => Loss 1.260,  Train_accy 80.05:  45%|████▌     | 9/20 [06:10<07:26, 40.62s/it]
SNet: Task 13, Epoch 10/20 => Loss 1.276,  Train_accy 78.91:  45%|████▌     | 9/20 [06:50<07:26, 40.62s/it]
SNet: Task 13, Epoch 10/20 => Loss 1.276,  Train_accy 78.91:  50%|█████     | 10/20 [06:50<06:44, 40.40s/it]
SNet: Task 13, Epoch 11/20 => Loss 1.261,  Train_accy 79.98, Test_accy 83.49:  50%|█████     | 10/20 [07:35<06:44, 40.40s/it]
SNet: Task 13, Epoch 11/20 => Loss 1.261,  Train_accy 79.98, Test_accy 83.49:  55%|█████▌    | 11/20 [07:35<06:16, 41.88s/it]
SNet: Task 13, Epoch 12/20 => Loss 1.245,  Train_accy 79.88:  55%|█████▌    | 11/20 [08:15<06:16, 41.88s/it]                 
SNet: Task 13, Epoch 12/20 => Loss 1.245,  Train_accy 79.88:  60%|██████    | 12/20 [08:15<05:30, 41.29s/it]
SNet: Task 13, Epoch 13/20 => Loss 1.288,  Train_accy 78.71:  60%|██████    | 12/20 [08:55<05:30, 41.29s/it]
SNet: Task 13, Epoch 13/20 => Loss 1.288,  Train_accy 78.71:  65%|██████▌   | 13/20 [08:55<04:46, 40.88s/it]
SNet: Task 13, Epoch 14/20 => Loss 1.244,  Train_accy 80.37:  65%|██████▌   | 13/20 [09:35<04:46, 40.88s/it]
SNet: Task 13, Epoch 14/20 => Loss 1.244,  Train_accy 80.37:  70%|███████   | 14/20 [09:35<04:03, 40.61s/it]
SNet: Task 13, Epoch 15/20 => Loss 1.263,  Train_accy 80.05:  70%|███████   | 14/20 [10:15<04:03, 40.61s/it]
SNet: Task 13, Epoch 15/20 => Loss 1.263,  Train_accy 80.05:  75%|███████▌  | 15/20 [10:15<03:21, 40.40s/it]
SNet: Task 13, Epoch 16/20 => Loss 1.277,  Train_accy 79.07, Test_accy 83.18:  75%|███████▌  | 15/20 [11:00<03:21, 40.40s/it]
SNet: Task 13, Epoch 16/20 => Loss 1.277,  Train_accy 79.07, Test_accy 83.18:  80%|████████  | 16/20 [11:00<02:47, 41.83s/it]
SNet: Task 13, Epoch 17/20 => Loss 1.242,  Train_accy 80.18:  80%|████████  | 16/20 [11:40<02:47, 41.83s/it]                 
SNet: Task 13, Epoch 17/20 => Loss 1.242,  Train_accy 80.18:  85%|████████▌ | 17/20 [11:40<02:03, 41.28s/it]
SNet: Task 13, Epoch 18/20 => Loss 1.232,  Train_accy 80.27:  85%|████████▌ | 17/20 [12:20<02:03, 41.28s/it]
SNet: Task 13, Epoch 18/20 => Loss 1.232,  Train_accy 80.27:  90%|█████████ | 18/20 [12:20<01:21, 40.90s/it]
SNet: Task 13, Epoch 19/20 => Loss 1.287,  Train_accy 79.13:  90%|█████████ | 18/20 [13:00<01:21, 40.90s/it]
SNet: Task 13, Epoch 19/20 => Loss 1.287,  Train_accy 79.13:  95%|█████████▌| 19/20 [13:00<00:40, 40.63s/it]
SNet: Task 13, Epoch 20/20 => Loss 1.274,  Train_accy 79.20:  95%|█████████▌| 19/20 [13:40<00:40, 40.63s/it]
SNet: Task 13, Epoch 20/20 => Loss 1.274,  Train_accy 79.20: 100%|██████████| 20/20 [13:40<00:00, 40.43s/it]
SNet: Task 13, Epoch 20/20 => Loss 1.274,  Train_accy 79.20: 100%|██████████| 20/20 [13:40<00:00, 41.02s/it]
2024-09-05 11:20:45,416 [foster.py] => SNet: Task 13, Epoch 20/20 => Loss 1.274,  Train_accy 79.20
2024-09-05 11:20:45,416 [foster.py] => do not weight align student!
2024-09-05 11:20:50,690 [foster.py] => darknet eval: 
2024-09-05 11:20:50,690 [foster.py] => CNN top1 curve: 83.06
2024-09-05 11:20:50,690 [foster.py] => CNN top5 curve: 97.44
2024-09-05 11:20:50,694 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 11:22:16,536 [foster.py] => Exemplar size: 2800
2024-09-05 11:22:16,536 [trainer.py] => CNN: {'total': 84.52, '00-09': 92.37, '10-19': 89.92, '20-29': 96.91, '30-39': 88.18, '40-49': 91.59, '50-59': 87.39, '60-69': 87.74, '70-79': 87.94, '80-89': 92.48, '90-99': 88.24, '100-109': 89.57, '110-119': 76.99, '120-129': 71.03, '130-139': 42.37, 'old': 87.79, 'new': 42.37}
2024-09-05 11:22:16,536 [trainer.py] => NME: {'total': 88.67, '00-09': 87.29, '10-19': 90.7, '20-29': 97.94, '30-39': 83.64, '40-49': 90.65, '50-59': 89.19, '60-69': 90.57, '70-79': 86.52, '80-89': 93.23, '90-99': 88.24, '100-109': 94.78, '110-119': 83.19, '120-129': 77.57, '130-139': 88.14, 'old': 88.71, 'new': 88.14}
2024-09-05 11:22:16,536 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96, 84.52]
2024-09-05 11:22:16,536 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36, 97.99]
2024-09-05 11:22:16,536 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23, 88.67]
2024-09-05 11:22:16,536 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82, 98.66]

Average Accuracy (CNN): 87.62
Average Accuracy (NME): 93.48
2024-09-05 11:22:16,536 [trainer.py] => Average Accuracy (CNN): 87.62
2024-09-05 11:22:16,536 [trainer.py] => Average Accuracy (NME): 93.48
2024-09-05 11:22:16,537 [trainer.py] => All params: 172020122
2024-09-05 11:22:16,538 [trainer.py] => Trainable params: 86121496
2024-09-05 11:22:18,036 [foster.py] => Learning on 140-150
2024-09-05 11:22:18,038 [foster.py] => All params: 172050872
2024-09-05 11:22:18,038 [foster.py] => Trainable params: 86144556
2024-09-05 11:22:18,086 [foster.py] => per cls weights : [1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 0.5749392  0.5749392  0.5749392  0.5749392
 0.5749392  0.5749392  0.5749392  0.5749392  0.5749392  0.5749392 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 5.866, Loss_clf 0.919, Loss_fe 3.505, Loss_kd 1.346, Train_accy 77.77, Test_accy 80.25:   0%|          | 0/20 [00:43<?, ?it/s]
Task 14, Epoch 1/20 => Loss 5.866, Loss_clf 0.919, Loss_fe 3.505, Loss_kd 1.346, Train_accy 77.77, Test_accy 80.25:   5%|▌         | 1/20 [00:43<13:42, 43.31s/it]
Task 14, Epoch 2/20 => Loss 3.085, Loss_clf 0.577, Loss_fe 1.103, Loss_kd 1.311, Train_accy 79.77:   5%|▌         | 1/20 [01:16<13:42, 43.31s/it]                 
Task 14, Epoch 2/20 => Loss 3.085, Loss_clf 0.577, Loss_fe 1.103, Loss_kd 1.311, Train_accy 79.77:  10%|█         | 2/20 [01:16<11:13, 37.44s/it]
Task 14, Epoch 3/20 => Loss 2.838, Loss_clf 0.536, Loss_fe 0.867, Loss_kd 1.339, Train_accy 79.49:  10%|█         | 2/20 [01:50<11:13, 37.44s/it]
Task 14, Epoch 3/20 => Loss 2.838, Loss_clf 0.536, Loss_fe 0.867, Loss_kd 1.339, Train_accy 79.49:  15%|█▌        | 3/20 [01:50<10:05, 35.64s/it]
Task 14, Epoch 4/20 => Loss 2.599, Loss_clf 0.483, Loss_fe 0.722, Loss_kd 1.302, Train_accy 80.41:  15%|█▌        | 3/20 [02:23<10:05, 35.64s/it]
Task 14, Epoch 4/20 => Loss 2.599, Loss_clf 0.483, Loss_fe 0.722, Loss_kd 1.302, Train_accy 80.41:  20%|██        | 4/20 [02:23<09:17, 34.83s/it]
Task 14, Epoch 5/20 => Loss 2.503, Loss_clf 0.471, Loss_fe 0.637, Loss_kd 1.302, Train_accy 81.52:  20%|██        | 4/20 [02:57<09:17, 34.83s/it]
Task 14, Epoch 5/20 => Loss 2.503, Loss_clf 0.471, Loss_fe 0.637, Loss_kd 1.302, Train_accy 81.52:  25%|██▌       | 5/20 [02:57<08:35, 34.40s/it]
Task 14, Epoch 6/20 => Loss 2.470, Loss_clf 0.477, Loss_fe 0.578, Loss_kd 1.320, Train_accy 80.87, Test_accy 81.89:  25%|██▌       | 5/20 [03:41<08:35, 34.40s/it]
Task 14, Epoch 6/20 => Loss 2.470, Loss_clf 0.477, Loss_fe 0.578, Loss_kd 1.320, Train_accy 80.87, Test_accy 81.89:  30%|███       | 6/20 [03:41<08:48, 37.71s/it]
Task 14, Epoch 7/20 => Loss 2.428, Loss_clf 0.447, Loss_fe 0.555, Loss_kd 1.332, Train_accy 81.80:  30%|███       | 6/20 [04:15<08:48, 37.71s/it]                 
Task 14, Epoch 7/20 => Loss 2.428, Loss_clf 0.447, Loss_fe 0.555, Loss_kd 1.332, Train_accy 81.80:  35%|███▌      | 7/20 [04:15<07:53, 36.39s/it]
Task 14, Epoch 8/20 => Loss 2.311, Loss_clf 0.414, Loss_fe 0.483, Loss_kd 1.320, Train_accy 82.47:  35%|███▌      | 7/20 [04:48<07:53, 36.39s/it]
Task 14, Epoch 8/20 => Loss 2.311, Loss_clf 0.414, Loss_fe 0.483, Loss_kd 1.320, Train_accy 82.47:  40%|████      | 8/20 [04:48<07:06, 35.52s/it]
Task 14, Epoch 9/20 => Loss 2.224, Loss_clf 0.414, Loss_fe 0.430, Loss_kd 1.288, Train_accy 81.95:  40%|████      | 8/20 [05:22<07:06, 35.52s/it]
Task 14, Epoch 9/20 => Loss 2.224, Loss_clf 0.414, Loss_fe 0.430, Loss_kd 1.288, Train_accy 81.95:  45%|████▌     | 9/20 [05:22<06:24, 34.96s/it]
Task 14, Epoch 10/20 => Loss 2.250, Loss_clf 0.411, Loss_fe 0.441, Loss_kd 1.305, Train_accy 81.83:  45%|████▌     | 9/20 [05:56<06:24, 34.96s/it]
Task 14, Epoch 10/20 => Loss 2.250, Loss_clf 0.411, Loss_fe 0.441, Loss_kd 1.305, Train_accy 81.83:  50%|█████     | 10/20 [05:56<05:45, 34.57s/it]
Task 14, Epoch 11/20 => Loss 2.147, Loss_clf 0.381, Loss_fe 0.395, Loss_kd 1.280, Train_accy 83.52, Test_accy 82.00:  50%|█████     | 10/20 [06:40<05:45, 34.57s/it]
Task 14, Epoch 11/20 => Loss 2.147, Loss_clf 0.381, Loss_fe 0.395, Loss_kd 1.280, Train_accy 83.52, Test_accy 82.00:  55%|█████▌    | 11/20 [06:40<05:37, 37.49s/it]
Task 14, Epoch 12/20 => Loss 2.235, Loss_clf 0.414, Loss_fe 0.415, Loss_kd 1.311, Train_accy 82.90:  55%|█████▌    | 11/20 [07:14<05:37, 37.49s/it]                 
Task 14, Epoch 12/20 => Loss 2.235, Loss_clf 0.414, Loss_fe 0.415, Loss_kd 1.311, Train_accy 82.90:  60%|██████    | 12/20 [07:14<04:50, 36.32s/it]
Task 14, Epoch 13/20 => Loss 2.186, Loss_clf 0.393, Loss_fe 0.381, Loss_kd 1.318, Train_accy 82.32:  60%|██████    | 12/20 [07:47<04:50, 36.32s/it]
Task 14, Epoch 13/20 => Loss 2.186, Loss_clf 0.393, Loss_fe 0.381, Loss_kd 1.318, Train_accy 82.32:  65%|██████▌   | 13/20 [07:47<04:08, 35.51s/it]
Task 14, Epoch 14/20 => Loss 2.057, Loss_clf 0.346, Loss_fe 0.334, Loss_kd 1.285, Train_accy 83.86:  65%|██████▌   | 13/20 [08:21<04:08, 35.51s/it]
Task 14, Epoch 14/20 => Loss 2.057, Loss_clf 0.346, Loss_fe 0.334, Loss_kd 1.285, Train_accy 83.86:  70%|███████   | 14/20 [08:21<03:29, 34.96s/it]
Task 14, Epoch 15/20 => Loss 2.000, Loss_clf 0.324, Loss_fe 0.308, Loss_kd 1.277, Train_accy 84.53:  70%|███████   | 14/20 [08:55<03:29, 34.96s/it]
Task 14, Epoch 15/20 => Loss 2.000, Loss_clf 0.324, Loss_fe 0.308, Loss_kd 1.277, Train_accy 84.53:  75%|███████▌  | 15/20 [08:55<02:52, 34.59s/it]
Task 14, Epoch 16/20 => Loss 2.260, Loss_clf 0.431, Loss_fe 0.377, Loss_kd 1.355, Train_accy 81.58, Test_accy 82.06:  75%|███████▌  | 15/20 [09:39<02:52, 34.59s/it]
Task 14, Epoch 16/20 => Loss 2.260, Loss_clf 0.431, Loss_fe 0.377, Loss_kd 1.355, Train_accy 81.58, Test_accy 82.06:  80%|████████  | 16/20 [09:39<02:29, 37.46s/it]
Task 14, Epoch 17/20 => Loss 2.103, Loss_clf 0.361, Loss_fe 0.337, Loss_kd 1.311, Train_accy 83.03:  80%|████████  | 16/20 [10:12<02:29, 37.46s/it]                 
Task 14, Epoch 17/20 => Loss 2.103, Loss_clf 0.361, Loss_fe 0.337, Loss_kd 1.311, Train_accy 83.03:  85%|████████▌ | 17/20 [10:12<01:48, 36.33s/it]
Task 14, Epoch 18/20 => Loss 2.106, Loss_clf 0.378, Loss_fe 0.334, Loss_kd 1.301, Train_accy 82.87:  85%|████████▌ | 17/20 [10:46<01:48, 36.33s/it]
Task 14, Epoch 18/20 => Loss 2.106, Loss_clf 0.378, Loss_fe 0.334, Loss_kd 1.301, Train_accy 82.87:  90%|█████████ | 18/20 [10:46<01:11, 35.53s/it]
Task 14, Epoch 19/20 => Loss 2.112, Loss_clf 0.374, Loss_fe 0.333, Loss_kd 1.311, Train_accy 82.78:  90%|█████████ | 18/20 [11:20<01:11, 35.53s/it]
Task 14, Epoch 19/20 => Loss 2.112, Loss_clf 0.374, Loss_fe 0.333, Loss_kd 1.311, Train_accy 82.78:  95%|█████████▌| 19/20 [11:20<00:34, 34.97s/it]
Task 14, Epoch 20/20 => Loss 2.015, Loss_clf 0.341, Loss_fe 0.295, Loss_kd 1.287, Train_accy 83.36:  95%|█████████▌| 19/20 [11:53<00:34, 34.97s/it]
Task 14, Epoch 20/20 => Loss 2.015, Loss_clf 0.341, Loss_fe 0.295, Loss_kd 1.287, Train_accy 83.36: 100%|██████████| 20/20 [11:53<00:00, 34.59s/it]
Task 14, Epoch 20/20 => Loss 2.015, Loss_clf 0.341, Loss_fe 0.295, Loss_kd 1.287, Train_accy 83.36: 100%|██████████| 20/20 [11:53<00:00, 35.70s/it]
2024-09-05 11:34:12,056 [foster.py] => Task 14, Epoch 20/20 => Loss 2.015, Loss_clf 0.341, Loss_fe 0.295, Loss_kd 1.287, Train_accy 83.36
2024-09-05 11:34:12,057 [foster.py] => do not weight align teacher!
2024-09-05 11:34:12,061 [foster.py] => per cls weights : [1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 0.4733666  0.4733666  0.4733666  0.4733666
 0.4733666  0.4733666  0.4733666  0.4733666  0.4733666  0.4733666 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 14, Epoch 1/20 => Loss 1.345,  Train_accy 77.55, Test_accy 81.32:   0%|          | 0/20 [00:48<?, ?it/s]
SNet: Task 14, Epoch 1/20 => Loss 1.345,  Train_accy 77.55, Test_accy 81.32:   5%|▌         | 1/20 [00:48<15:12, 48.03s/it]
SNet: Task 14, Epoch 2/20 => Loss 1.297,  Train_accy 80.04:   5%|▌         | 1/20 [01:30<15:12, 48.03s/it]                 
SNet: Task 14, Epoch 2/20 => Loss 1.297,  Train_accy 80.04:  10%|█         | 2/20 [01:30<13:23, 44.65s/it]
SNet: Task 14, Epoch 3/20 => Loss 1.279,  Train_accy 79.83:  10%|█         | 2/20 [02:12<13:23, 44.65s/it]
SNet: Task 14, Epoch 3/20 => Loss 1.279,  Train_accy 79.83:  15%|█▌        | 3/20 [02:12<12:21, 43.59s/it]
SNet: Task 14, Epoch 4/20 => Loss 1.279,  Train_accy 79.89:  15%|█▌        | 3/20 [02:54<12:21, 43.59s/it]
SNet: Task 14, Epoch 4/20 => Loss 1.279,  Train_accy 79.89:  20%|██        | 4/20 [02:54<11:29, 43.08s/it]
SNet: Task 14, Epoch 5/20 => Loss 1.259,  Train_accy 79.92:  20%|██        | 4/20 [03:37<11:29, 43.08s/it]
SNet: Task 14, Epoch 5/20 => Loss 1.259,  Train_accy 79.92:  25%|██▌       | 5/20 [03:37<10:42, 42.81s/it]
SNet: Task 14, Epoch 6/20 => Loss 1.259,  Train_accy 80.04, Test_accy 82.46:  25%|██▌       | 5/20 [04:25<10:42, 42.81s/it]
SNet: Task 14, Epoch 6/20 => Loss 1.259,  Train_accy 80.04, Test_accy 82.46:  30%|███       | 6/20 [04:25<10:23, 44.56s/it]
SNet: Task 14, Epoch 7/20 => Loss 1.318,  Train_accy 79.06:  30%|███       | 6/20 [05:07<10:23, 44.56s/it]                 
SNet: Task 14, Epoch 7/20 => Loss 1.318,  Train_accy 79.06:  35%|███▌      | 7/20 [05:07<09:29, 43.84s/it]
SNet: Task 14, Epoch 8/20 => Loss 1.295,  Train_accy 80.60:  35%|███▌      | 7/20 [05:49<09:29, 43.84s/it]
SNet: Task 14, Epoch 8/20 => Loss 1.295,  Train_accy 80.60:  40%|████      | 8/20 [05:49<08:40, 43.35s/it]
SNet: Task 14, Epoch 9/20 => Loss 1.259,  Train_accy 80.66:  40%|████      | 8/20 [06:32<08:40, 43.35s/it]
SNet: Task 14, Epoch 9/20 => Loss 1.259,  Train_accy 80.66:  45%|████▌     | 9/20 [06:32<07:53, 43.01s/it]
SNet: Task 14, Epoch 10/20 => Loss 1.241,  Train_accy 81.43:  45%|████▌     | 9/20 [07:14<07:53, 43.01s/it]
SNet: Task 14, Epoch 10/20 => Loss 1.241,  Train_accy 81.43:  50%|█████     | 10/20 [07:14<07:08, 42.81s/it]
SNet: Task 14, Epoch 11/20 => Loss 1.260,  Train_accy 80.44, Test_accy 82.51:  50%|█████     | 10/20 [08:02<07:08, 42.81s/it]
SNet: Task 14, Epoch 11/20 => Loss 1.260,  Train_accy 80.44, Test_accy 82.51:  55%|█████▌    | 11/20 [08:02<06:39, 44.42s/it]
SNet: Task 14, Epoch 12/20 => Loss 1.255,  Train_accy 81.24:  55%|█████▌    | 11/20 [08:44<06:39, 44.42s/it]                 
SNet: Task 14, Epoch 12/20 => Loss 1.255,  Train_accy 81.24:  60%|██████    | 12/20 [08:44<05:50, 43.77s/it]
SNet: Task 14, Epoch 13/20 => Loss 1.232,  Train_accy 81.58:  60%|██████    | 12/20 [09:27<05:50, 43.77s/it]
SNet: Task 14, Epoch 13/20 => Loss 1.232,  Train_accy 81.58:  65%|██████▌   | 13/20 [09:27<05:03, 43.32s/it]
SNet: Task 14, Epoch 14/20 => Loss 1.239,  Train_accy 80.81:  65%|██████▌   | 13/20 [10:09<05:03, 43.32s/it]
SNet: Task 14, Epoch 14/20 => Loss 1.239,  Train_accy 80.81:  70%|███████   | 14/20 [10:09<04:18, 43.01s/it]
SNet: Task 14, Epoch 15/20 => Loss 1.256,  Train_accy 80.93:  70%|███████   | 14/20 [10:51<04:18, 43.01s/it]
SNet: Task 14, Epoch 15/20 => Loss 1.256,  Train_accy 80.93:  75%|███████▌  | 15/20 [10:51<03:33, 42.79s/it]
SNet: Task 14, Epoch 16/20 => Loss 1.288,  Train_accy 80.35, Test_accy 82.46:  75%|███████▌  | 15/20 [11:39<03:33, 42.79s/it]
SNet: Task 14, Epoch 16/20 => Loss 1.288,  Train_accy 80.35, Test_accy 82.46:  80%|████████  | 16/20 [11:39<02:57, 44.33s/it]
SNet: Task 14, Epoch 17/20 => Loss 1.240,  Train_accy 81.61:  80%|████████  | 16/20 [12:21<02:57, 44.33s/it]                 
SNet: Task 14, Epoch 17/20 => Loss 1.240,  Train_accy 81.61:  85%|████████▌ | 17/20 [12:21<02:11, 43.71s/it]
SNet: Task 14, Epoch 18/20 => Loss 1.254,  Train_accy 81.09:  85%|████████▌ | 17/20 [13:04<02:11, 43.71s/it]
SNet: Task 14, Epoch 18/20 => Loss 1.254,  Train_accy 81.09:  90%|█████████ | 18/20 [13:04<01:26, 43.31s/it]
SNet: Task 14, Epoch 19/20 => Loss 1.275,  Train_accy 80.41:  90%|█████████ | 18/20 [13:46<01:26, 43.31s/it]
SNet: Task 14, Epoch 19/20 => Loss 1.275,  Train_accy 80.41:  95%|█████████▌| 19/20 [13:46<00:43, 43.01s/it]
SNet: Task 14, Epoch 20/20 => Loss 1.257,  Train_accy 81.21:  95%|█████████▌| 19/20 [14:28<00:43, 43.01s/it]
SNet: Task 14, Epoch 20/20 => Loss 1.257,  Train_accy 81.21: 100%|██████████| 20/20 [14:28<00:00, 42.80s/it]
SNet: Task 14, Epoch 20/20 => Loss 1.257,  Train_accy 81.21: 100%|██████████| 20/20 [14:28<00:00, 43.45s/it]
2024-09-05 11:48:42,475 [foster.py] => SNet: Task 14, Epoch 20/20 => Loss 1.257,  Train_accy 81.21
2024-09-05 11:48:42,475 [foster.py] => do not weight align student!
2024-09-05 11:48:48,152 [foster.py] => darknet eval: 
2024-09-05 11:48:48,153 [foster.py] => CNN top1 curve: 82.46
2024-09-05 11:48:48,153 [foster.py] => CNN top5 curve: 97.4
2024-09-05 11:48:48,155 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 11:50:24,609 [foster.py] => Exemplar size: 3000
2024-09-05 11:50:24,609 [trainer.py] => CNN: {'total': 81.66, '00-09': 87.29, '10-19': 88.37, '20-29': 94.85, '30-39': 84.55, '40-49': 91.59, '50-59': 87.39, '60-69': 84.91, '70-79': 87.94, '80-89': 92.48, '90-99': 87.5, '100-109': 90.43, '110-119': 79.65, '120-129': 74.77, '130-139': 63.56, '140-149': 32.54, 'old': 85.44, 'new': 32.54}
2024-09-05 11:50:24,609 [trainer.py] => NME: {'total': 88.0, '00-09': 85.59, '10-19': 90.7, '20-29': 97.94, '30-39': 79.09, '40-49': 88.79, '50-59': 89.19, '60-69': 88.68, '70-79': 87.23, '80-89': 92.48, '90-99': 90.44, '100-109': 93.91, '110-119': 82.3, '120-129': 78.5, '130-139': 86.44, '140-149': 88.1, 'old': 88.0, 'new': 88.1}
2024-09-05 11:50:24,609 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96, 84.52, 81.66]
2024-09-05 11:50:24,609 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36, 97.99, 97.62]
2024-09-05 11:50:24,609 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23, 88.67, 88.0]
2024-09-05 11:50:24,609 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82, 98.66, 98.64]

Average Accuracy (CNN): 87.23
Average Accuracy (NME): 93.11
2024-09-05 11:50:24,609 [trainer.py] => Average Accuracy (CNN): 87.23
2024-09-05 11:50:24,610 [trainer.py] => Average Accuracy (NME): 93.11
2024-09-05 11:50:24,611 [trainer.py] => All params: 172050872
2024-09-05 11:50:24,612 [trainer.py] => Trainable params: 86144556
2024-09-05 11:50:26,260 [foster.py] => Learning on 150-160
2024-09-05 11:50:26,261 [foster.py] => All params: 172081622
2024-09-05 11:50:26,262 [foster.py] => Trainable params: 86167616
2024-09-05 11:50:26,319 [foster.py] => per cls weights : [1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 0.57385027 0.57385027 0.57385027 0.57385027 0.57385027 0.57385027
 0.57385027 0.57385027 0.57385027 0.57385027]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 5.522, Loss_clf 0.777, Loss_fe 3.342, Loss_kd 1.315, Train_accy 77.48, Test_accy 80.59:   0%|          | 0/20 [00:46<?, ?it/s]
Task 15, Epoch 1/20 => Loss 5.522, Loss_clf 0.777, Loss_fe 3.342, Loss_kd 1.315, Train_accy 77.48, Test_accy 80.59:   5%|▌         | 1/20 [00:46<14:36, 46.13s/it]
Task 15, Epoch 2/20 => Loss 3.153, Loss_clf 0.581, Loss_fe 1.149, Loss_kd 1.334, Train_accy 79.44:   5%|▌         | 1/20 [01:21<14:36, 46.13s/it]                 
Task 15, Epoch 2/20 => Loss 3.153, Loss_clf 0.581, Loss_fe 1.149, Loss_kd 1.334, Train_accy 79.44:  10%|█         | 2/20 [01:21<11:58, 39.90s/it]
Task 15, Epoch 3/20 => Loss 2.908, Loss_clf 0.558, Loss_fe 0.900, Loss_kd 1.360, Train_accy 79.73:  10%|█         | 2/20 [01:57<11:58, 39.90s/it]
Task 15, Epoch 3/20 => Loss 2.908, Loss_clf 0.558, Loss_fe 0.900, Loss_kd 1.360, Train_accy 79.73:  15%|█▌        | 3/20 [01:57<10:46, 38.00s/it]
Task 15, Epoch 4/20 => Loss 2.582, Loss_clf 0.474, Loss_fe 0.717, Loss_kd 1.304, Train_accy 80.80:  15%|█▌        | 3/20 [02:33<10:46, 38.00s/it]
Task 15, Epoch 4/20 => Loss 2.582, Loss_clf 0.474, Loss_fe 0.717, Loss_kd 1.304, Train_accy 80.80:  20%|██        | 4/20 [02:33<09:53, 37.11s/it]
Task 15, Epoch 5/20 => Loss 2.497, Loss_clf 0.462, Loss_fe 0.633, Loss_kd 1.314, Train_accy 81.95:  20%|██        | 4/20 [03:09<09:53, 37.11s/it]
Task 15, Epoch 5/20 => Loss 2.497, Loss_clf 0.462, Loss_fe 0.633, Loss_kd 1.314, Train_accy 81.95:  25%|██▌       | 5/20 [03:09<09:09, 36.66s/it]
Task 15, Epoch 6/20 => Loss 2.455, Loss_clf 0.472, Loss_fe 0.598, Loss_kd 1.299, Train_accy 81.26, Test_accy 82.02:  25%|██▌       | 5/20 [03:55<09:09, 36.66s/it]
Task 15, Epoch 6/20 => Loss 2.455, Loss_clf 0.472, Loss_fe 0.598, Loss_kd 1.299, Train_accy 81.26, Test_accy 82.02:  30%|███       | 6/20 [03:55<09:22, 40.15s/it]
Task 15, Epoch 7/20 => Loss 2.416, Loss_clf 0.458, Loss_fe 0.529, Loss_kd 1.340, Train_accy 82.32:  30%|███       | 6/20 [04:31<09:22, 40.15s/it]                 
Task 15, Epoch 7/20 => Loss 2.416, Loss_clf 0.458, Loss_fe 0.529, Loss_kd 1.340, Train_accy 82.32:  35%|███▌      | 7/20 [04:31<08:23, 38.74s/it]
Task 15, Epoch 8/20 => Loss 2.256, Loss_clf 0.416, Loss_fe 0.475, Loss_kd 1.280, Train_accy 82.41:  35%|███▌      | 7/20 [05:07<08:23, 38.74s/it]
Task 15, Epoch 8/20 => Loss 2.256, Loss_clf 0.416, Loss_fe 0.475, Loss_kd 1.280, Train_accy 82.41:  40%|████      | 8/20 [05:07<07:33, 37.82s/it]
Task 15, Epoch 9/20 => Loss 2.355, Loss_clf 0.443, Loss_fe 0.496, Loss_kd 1.327, Train_accy 81.83:  40%|████      | 8/20 [05:43<07:33, 37.82s/it]
Task 15, Epoch 9/20 => Loss 2.355, Loss_clf 0.443, Loss_fe 0.496, Loss_kd 1.327, Train_accy 81.83:  45%|████▌     | 9/20 [05:43<06:49, 37.20s/it]
Task 15, Epoch 10/20 => Loss 2.295, Loss_clf 0.425, Loss_fe 0.463, Loss_kd 1.319, Train_accy 81.98:  45%|████▌     | 9/20 [06:19<06:49, 37.20s/it]
Task 15, Epoch 10/20 => Loss 2.295, Loss_clf 0.425, Loss_fe 0.463, Loss_kd 1.319, Train_accy 81.98:  50%|█████     | 10/20 [06:19<06:08, 36.80s/it]
Task 15, Epoch 11/20 => Loss 2.290, Loss_clf 0.434, Loss_fe 0.432, Loss_kd 1.334, Train_accy 82.73, Test_accy 81.23:  50%|█████     | 10/20 [07:06<06:08, 36.80s/it]
Task 15, Epoch 11/20 => Loss 2.290, Loss_clf 0.434, Loss_fe 0.432, Loss_kd 1.334, Train_accy 82.73, Test_accy 81.23:  55%|█████▌    | 11/20 [07:06<05:59, 39.93s/it]
Task 15, Epoch 12/20 => Loss 2.162, Loss_clf 0.395, Loss_fe 0.377, Loss_kd 1.303, Train_accy 83.45:  55%|█████▌    | 11/20 [07:42<05:59, 39.93s/it]                 
Task 15, Epoch 12/20 => Loss 2.162, Loss_clf 0.395, Loss_fe 0.377, Loss_kd 1.303, Train_accy 83.45:  60%|██████    | 12/20 [07:42<05:09, 38.71s/it]
Task 15, Epoch 13/20 => Loss 2.097, Loss_clf 0.372, Loss_fe 0.352, Loss_kd 1.287, Train_accy 83.28:  60%|██████    | 12/20 [08:18<05:09, 38.71s/it]
Task 15, Epoch 13/20 => Loss 2.097, Loss_clf 0.372, Loss_fe 0.352, Loss_kd 1.287, Train_accy 83.28:  65%|██████▌   | 13/20 [08:18<04:24, 37.85s/it]
Task 15, Epoch 14/20 => Loss 2.133, Loss_clf 0.385, Loss_fe 0.352, Loss_kd 1.309, Train_accy 83.13:  65%|██████▌   | 13/20 [08:54<04:24, 37.85s/it]
Task 15, Epoch 14/20 => Loss 2.133, Loss_clf 0.385, Loss_fe 0.352, Loss_kd 1.309, Train_accy 83.13:  70%|███████   | 14/20 [08:54<03:43, 37.27s/it]
Task 15, Epoch 15/20 => Loss 2.057, Loss_clf 0.372, Loss_fe 0.325, Loss_kd 1.275, Train_accy 83.97:  70%|███████   | 14/20 [09:30<03:43, 37.27s/it]
Task 15, Epoch 15/20 => Loss 2.057, Loss_clf 0.372, Loss_fe 0.325, Loss_kd 1.275, Train_accy 83.97:  75%|███████▌  | 15/20 [09:30<03:04, 36.86s/it]
Task 15, Epoch 16/20 => Loss 2.225, Loss_clf 0.415, Loss_fe 0.370, Loss_kd 1.349, Train_accy 82.27, Test_accy 81.28:  75%|███████▌  | 15/20 [10:17<03:04, 36.86s/it]
Task 15, Epoch 16/20 => Loss 2.225, Loss_clf 0.415, Loss_fe 0.370, Loss_kd 1.349, Train_accy 82.27, Test_accy 81.28:  80%|████████  | 16/20 [10:17<02:39, 39.92s/it]
Task 15, Epoch 17/20 => Loss 2.110, Loss_clf 0.372, Loss_fe 0.339, Loss_kd 1.312, Train_accy 83.71:  80%|████████  | 16/20 [10:52<02:39, 39.92s/it]                 
Task 15, Epoch 17/20 => Loss 2.110, Loss_clf 0.372, Loss_fe 0.339, Loss_kd 1.312, Train_accy 83.71:  85%|████████▌ | 17/20 [10:52<01:56, 38.71s/it]
Task 15, Epoch 18/20 => Loss 2.089, Loss_clf 0.370, Loss_fe 0.328, Loss_kd 1.304, Train_accy 83.59:  85%|████████▌ | 17/20 [11:28<01:56, 38.71s/it]
Task 15, Epoch 18/20 => Loss 2.089, Loss_clf 0.370, Loss_fe 0.328, Loss_kd 1.304, Train_accy 83.59:  90%|█████████ | 18/20 [11:28<01:15, 37.88s/it]
Task 15, Epoch 19/20 => Loss 2.030, Loss_clf 0.350, Loss_fe 0.302, Loss_kd 1.292, Train_accy 83.97:  90%|█████████ | 18/20 [12:04<01:15, 37.88s/it]
Task 15, Epoch 19/20 => Loss 2.030, Loss_clf 0.350, Loss_fe 0.302, Loss_kd 1.292, Train_accy 83.97:  95%|█████████▌| 19/20 [12:04<00:37, 37.29s/it]
Task 15, Epoch 20/20 => Loss 2.086, Loss_clf 0.354, Loss_fe 0.322, Loss_kd 1.322, Train_accy 84.23:  95%|█████████▌| 19/20 [12:40<00:37, 37.29s/it]
Task 15, Epoch 20/20 => Loss 2.086, Loss_clf 0.354, Loss_fe 0.322, Loss_kd 1.322, Train_accy 84.23: 100%|██████████| 20/20 [12:40<00:00, 36.88s/it]
Task 15, Epoch 20/20 => Loss 2.086, Loss_clf 0.354, Loss_fe 0.322, Loss_kd 1.322, Train_accy 84.23: 100%|██████████| 20/20 [12:40<00:00, 38.04s/it]
2024-09-05 12:03:07,061 [foster.py] => Task 15, Epoch 20/20 => Loss 2.086, Loss_clf 0.354, Loss_fe 0.322, Loss_kd 1.322, Train_accy 84.23
2024-09-05 12:03:07,063 [foster.py] => do not weight align teacher!
2024-09-05 12:03:07,068 [foster.py] => per cls weights : [1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 0.4722563  0.4722563  0.4722563  0.4722563  0.4722563  0.4722563
 0.4722563  0.4722563  0.4722563  0.4722563 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 15, Epoch 1/20 => Loss 1.339,  Train_accy 77.45, Test_accy 80.43:   0%|          | 0/20 [00:51<?, ?it/s]
SNet: Task 15, Epoch 1/20 => Loss 1.339,  Train_accy 77.45, Test_accy 80.43:   5%|▌         | 1/20 [00:51<16:10, 51.09s/it]
SNet: Task 15, Epoch 2/20 => Loss 1.268,  Train_accy 80.22:   5%|▌         | 1/20 [01:36<16:10, 51.09s/it]                 
SNet: Task 15, Epoch 2/20 => Loss 1.268,  Train_accy 80.22:  10%|█         | 2/20 [01:36<14:16, 47.59s/it]
SNet: Task 15, Epoch 3/20 => Loss 1.267,  Train_accy 80.25:  10%|█         | 2/20 [02:21<14:16, 47.59s/it]
SNet: Task 15, Epoch 3/20 => Loss 1.267,  Train_accy 80.25:  15%|█▌        | 3/20 [02:21<13:09, 46.43s/it]
SNet: Task 15, Epoch 4/20 => Loss 1.331,  Train_accy 79.67:  15%|█▌        | 3/20 [03:06<13:09, 46.43s/it]
SNet: Task 15, Epoch 4/20 => Loss 1.331,  Train_accy 79.67:  20%|██        | 4/20 [03:06<12:14, 45.89s/it]
SNet: Task 15, Epoch 5/20 => Loss 1.253,  Train_accy 80.62:  20%|██        | 4/20 [03:51<12:14, 45.89s/it]
SNet: Task 15, Epoch 5/20 => Loss 1.253,  Train_accy 80.62:  25%|██▌       | 5/20 [03:51<11:23, 45.60s/it]
SNet: Task 15, Epoch 6/20 => Loss 1.270,  Train_accy 80.19, Test_accy 80.86:  25%|██▌       | 5/20 [04:42<11:23, 45.60s/it]
SNet: Task 15, Epoch 6/20 => Loss 1.270,  Train_accy 80.19, Test_accy 80.86:  30%|███       | 6/20 [04:42<11:04, 47.48s/it]
SNet: Task 15, Epoch 7/20 => Loss 1.271,  Train_accy 80.68:  30%|███       | 6/20 [05:27<11:04, 47.48s/it]                 
SNet: Task 15, Epoch 7/20 => Loss 1.271,  Train_accy 80.68:  35%|███▌      | 7/20 [05:27<10:07, 46.70s/it]
SNet: Task 15, Epoch 8/20 => Loss 1.264,  Train_accy 80.91:  35%|███▌      | 7/20 [06:12<10:07, 46.70s/it]
SNet: Task 15, Epoch 8/20 => Loss 1.264,  Train_accy 80.91:  40%|████      | 8/20 [06:12<09:14, 46.20s/it]
SNet: Task 15, Epoch 9/20 => Loss 1.255,  Train_accy 81.03:  40%|████      | 8/20 [06:57<09:14, 46.20s/it]
SNet: Task 15, Epoch 9/20 => Loss 1.255,  Train_accy 81.03:  45%|████▌     | 9/20 [06:57<08:24, 45.86s/it]
SNet: Task 15, Epoch 10/20 => Loss 1.249,  Train_accy 80.85:  45%|████▌     | 9/20 [07:43<08:24, 45.86s/it]
SNet: Task 15, Epoch 10/20 => Loss 1.249,  Train_accy 80.85:  50%|█████     | 10/20 [07:43<07:36, 45.63s/it]
SNet: Task 15, Epoch 11/20 => Loss 1.255,  Train_accy 81.20, Test_accy 81.23:  50%|█████     | 10/20 [08:34<07:36, 45.63s/it]
SNet: Task 15, Epoch 11/20 => Loss 1.255,  Train_accy 81.20, Test_accy 81.23:  55%|█████▌    | 11/20 [08:34<07:05, 47.31s/it]
SNet: Task 15, Epoch 12/20 => Loss 1.258,  Train_accy 80.57:  55%|█████▌    | 11/20 [09:19<07:05, 47.31s/it]                 
SNet: Task 15, Epoch 12/20 => Loss 1.258,  Train_accy 80.57:  60%|██████    | 12/20 [09:19<06:12, 46.62s/it]
SNet: Task 15, Epoch 13/20 => Loss 1.257,  Train_accy 81.00:  60%|██████    | 12/20 [10:04<06:12, 46.62s/it]
SNet: Task 15, Epoch 13/20 => Loss 1.257,  Train_accy 81.00:  65%|██████▌   | 13/20 [10:04<05:23, 46.17s/it]
SNet: Task 15, Epoch 14/20 => Loss 1.233,  Train_accy 81.29:  65%|██████▌   | 13/20 [10:49<05:23, 46.17s/it]
SNet: Task 15, Epoch 14/20 => Loss 1.233,  Train_accy 81.29:  70%|███████   | 14/20 [10:49<04:35, 45.84s/it]
SNet: Task 15, Epoch 15/20 => Loss 1.251,  Train_accy 81.14:  70%|███████   | 14/20 [11:34<04:35, 45.84s/it]
SNet: Task 15, Epoch 15/20 => Loss 1.251,  Train_accy 81.14:  75%|███████▌  | 15/20 [11:34<03:48, 45.62s/it]
SNet: Task 15, Epoch 16/20 => Loss 1.251,  Train_accy 81.20, Test_accy 81.17:  75%|███████▌  | 15/20 [12:25<03:48, 45.62s/it]
SNet: Task 15, Epoch 16/20 => Loss 1.251,  Train_accy 81.20, Test_accy 81.17:  80%|████████  | 16/20 [12:25<03:09, 47.27s/it]
SNet: Task 15, Epoch 17/20 => Loss 1.238,  Train_accy 81.26:  80%|████████  | 16/20 [13:10<03:09, 47.27s/it]                 
SNet: Task 15, Epoch 17/20 => Loss 1.238,  Train_accy 81.26:  85%|████████▌ | 17/20 [13:10<02:19, 46.62s/it]
SNet: Task 15, Epoch 18/20 => Loss 1.283,  Train_accy 80.59:  85%|████████▌ | 17/20 [13:55<02:19, 46.62s/it]
SNet: Task 15, Epoch 18/20 => Loss 1.283,  Train_accy 80.59:  90%|█████████ | 18/20 [13:55<01:32, 46.15s/it]
SNet: Task 15, Epoch 19/20 => Loss 1.284,  Train_accy 80.85:  90%|█████████ | 18/20 [14:40<01:32, 46.15s/it]
SNet: Task 15, Epoch 19/20 => Loss 1.284,  Train_accy 80.85:  95%|█████████▌| 19/20 [14:40<00:45, 45.84s/it]
SNet: Task 15, Epoch 20/20 => Loss 1.293,  Train_accy 81.17:  95%|█████████▌| 19/20 [15:25<00:45, 45.84s/it]
SNet: Task 15, Epoch 20/20 => Loss 1.293,  Train_accy 81.17: 100%|██████████| 20/20 [15:25<00:00, 45.61s/it]
SNet: Task 15, Epoch 20/20 => Loss 1.293,  Train_accy 81.17: 100%|██████████| 20/20 [15:25<00:00, 46.30s/it]
2024-09-05 12:18:34,663 [foster.py] => SNet: Task 15, Epoch 20/20 => Loss 1.293,  Train_accy 81.17
2024-09-05 12:18:34,663 [foster.py] => do not weight align student!
2024-09-05 12:18:40,665 [foster.py] => darknet eval: 
2024-09-05 12:18:40,665 [foster.py] => CNN top1 curve: 81.17
2024-09-05 12:18:40,665 [foster.py] => CNN top5 curve: 97.3
2024-09-05 12:18:40,669 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 12:20:21,824 [foster.py] => Exemplar size: 3200
2024-09-05 12:20:21,824 [trainer.py] => CNN: {'total': 81.65, '00-09': 88.14, '10-19': 88.37, '20-29': 95.88, '30-39': 86.36, '40-49': 91.59, '50-59': 86.49, '60-69': 86.79, '70-79': 85.82, '80-89': 88.72, '90-99': 87.5, '100-109': 91.3, '110-119': 82.3, '120-129': 77.57, '130-139': 80.51, '140-149': 58.73, '150-159': 35.48, 'old': 84.89, 'new': 35.48}
2024-09-05 12:20:21,824 [trainer.py] => NME: {'total': 88.15, '00-09': 85.59, '10-19': 88.37, '20-29': 97.94, '30-39': 80.91, '40-49': 87.85, '50-59': 88.29, '60-69': 86.79, '70-79': 84.4, '80-89': 91.73, '90-99': 88.97, '100-109': 93.91, '110-119': 80.53, '120-129': 79.44, '130-139': 88.14, '140-149': 90.48, '150-159': 96.77, 'old': 87.55, 'new': 96.77}
2024-09-05 12:20:21,824 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96, 84.52, 81.66, 81.65]
2024-09-05 12:20:21,824 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36, 97.99, 97.62, 97.73]
2024-09-05 12:20:21,824 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23, 88.67, 88.0, 88.15]
2024-09-05 12:20:21,824 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82, 98.66, 98.64, 98.52]

Average Accuracy (CNN): 86.88
Average Accuracy (NME): 92.8
2024-09-05 12:20:21,824 [trainer.py] => Average Accuracy (CNN): 86.88
2024-09-05 12:20:21,824 [trainer.py] => Average Accuracy (NME): 92.8
2024-09-05 12:20:21,826 [trainer.py] => All params: 172081622
2024-09-05 12:20:21,827 [trainer.py] => Trainable params: 86167616
2024-09-05 12:20:23,323 [foster.py] => Learning on 160-170
2024-09-05 12:20:23,324 [foster.py] => All params: 172112372
2024-09-05 12:20:23,325 [foster.py] => Trainable params: 86190676
2024-09-05 12:20:23,380 [foster.py] => per cls weights : [1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  0.57289286 0.57289286
 0.57289286 0.57289286 0.57289286 0.57289286 0.57289286 0.57289286
 0.57289286 0.57289286]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 5.771, Loss_clf 0.876, Loss_fe 3.471, Loss_kd 1.341, Train_accy 78.60, Test_accy 80.99:   0%|          | 0/20 [00:48<?, ?it/s]
Task 16, Epoch 1/20 => Loss 5.771, Loss_clf 0.876, Loss_fe 3.471, Loss_kd 1.341, Train_accy 78.60, Test_accy 80.99:   5%|▌         | 1/20 [00:48<15:26, 48.78s/it]
Task 16, Epoch 2/20 => Loss 3.274, Loss_clf 0.619, Loss_fe 1.223, Loss_kd 1.347, Train_accy 80.02:   5%|▌         | 1/20 [01:26<15:26, 48.78s/it]                 
Task 16, Epoch 2/20 => Loss 3.274, Loss_clf 0.619, Loss_fe 1.223, Loss_kd 1.347, Train_accy 80.02:  10%|█         | 2/20 [01:26<12:41, 42.28s/it]
Task 16, Epoch 3/20 => Loss 2.789, Loss_clf 0.512, Loss_fe 0.878, Loss_kd 1.317, Train_accy 82.04:  10%|█         | 2/20 [02:04<12:41, 42.28s/it]
Task 16, Epoch 3/20 => Loss 2.789, Loss_clf 0.512, Loss_fe 0.878, Loss_kd 1.317, Train_accy 82.04:  15%|█▌        | 3/20 [02:04<11:23, 40.18s/it]
Task 16, Epoch 4/20 => Loss 2.613, Loss_clf 0.505, Loss_fe 0.710, Loss_kd 1.315, Train_accy 81.47:  15%|█▌        | 3/20 [02:41<11:23, 40.18s/it]
Task 16, Epoch 4/20 => Loss 2.613, Loss_clf 0.505, Loss_fe 0.710, Loss_kd 1.315, Train_accy 81.47:  20%|██        | 4/20 [02:41<10:27, 39.22s/it]
Task 16, Epoch 5/20 => Loss 2.552, Loss_clf 0.477, Loss_fe 0.666, Loss_kd 1.327, Train_accy 82.45:  20%|██        | 4/20 [03:19<10:27, 39.22s/it]
Task 16, Epoch 5/20 => Loss 2.552, Loss_clf 0.477, Loss_fe 0.666, Loss_kd 1.327, Train_accy 82.45:  25%|██▌       | 5/20 [03:19<09:40, 38.70s/it]
Task 16, Epoch 6/20 => Loss 2.502, Loss_clf 0.483, Loss_fe 0.612, Loss_kd 1.323, Train_accy 81.63, Test_accy 82.96:  25%|██▌       | 5/20 [04:09<09:40, 38.70s/it]
Task 16, Epoch 6/20 => Loss 2.502, Loss_clf 0.483, Loss_fe 0.612, Loss_kd 1.323, Train_accy 81.63, Test_accy 82.96:  30%|███       | 6/20 [04:09<09:54, 42.44s/it]
Task 16, Epoch 7/20 => Loss 2.344, Loss_clf 0.432, Loss_fe 0.530, Loss_kd 1.302, Train_accy 82.86:  30%|███       | 6/20 [04:47<09:54, 42.44s/it]                 
Task 16, Epoch 7/20 => Loss 2.344, Loss_clf 0.432, Loss_fe 0.530, Loss_kd 1.302, Train_accy 82.86:  35%|███▌      | 7/20 [04:47<08:52, 40.94s/it]
Task 16, Epoch 8/20 => Loss 2.295, Loss_clf 0.416, Loss_fe 0.488, Loss_kd 1.309, Train_accy 83.32:  35%|███▌      | 7/20 [05:25<08:52, 40.94s/it]
Task 16, Epoch 8/20 => Loss 2.295, Loss_clf 0.416, Loss_fe 0.488, Loss_kd 1.309, Train_accy 83.32:  40%|████      | 8/20 [05:25<07:59, 39.98s/it]
Task 16, Epoch 9/20 => Loss 2.325, Loss_clf 0.424, Loss_fe 0.489, Loss_kd 1.329, Train_accy 83.79:  40%|████      | 8/20 [06:03<07:59, 39.98s/it]
Task 16, Epoch 9/20 => Loss 2.325, Loss_clf 0.424, Loss_fe 0.489, Loss_kd 1.329, Train_accy 83.79:  45%|████▌     | 9/20 [06:03<07:12, 39.34s/it]
Task 16, Epoch 10/20 => Loss 2.191, Loss_clf 0.382, Loss_fe 0.426, Loss_kd 1.301, Train_accy 83.41:  45%|████▌     | 9/20 [06:41<07:12, 39.34s/it]
Task 16, Epoch 10/20 => Loss 2.191, Loss_clf 0.382, Loss_fe 0.426, Loss_kd 1.301, Train_accy 83.41:  50%|█████     | 10/20 [06:41<06:29, 38.91s/it]
Task 16, Epoch 11/20 => Loss 2.170, Loss_clf 0.380, Loss_fe 0.395, Loss_kd 1.313, Train_accy 84.36, Test_accy 82.27:  50%|█████     | 10/20 [07:30<06:29, 38.91s/it]
Task 16, Epoch 11/20 => Loss 2.170, Loss_clf 0.380, Loss_fe 0.395, Loss_kd 1.313, Train_accy 84.36, Test_accy 82.27:  55%|█████▌    | 11/20 [07:30<06:19, 42.22s/it]
Task 16, Epoch 12/20 => Loss 2.184, Loss_clf 0.389, Loss_fe 0.398, Loss_kd 1.315, Train_accy 83.19:  55%|█████▌    | 11/20 [08:08<06:19, 42.22s/it]                 
Task 16, Epoch 12/20 => Loss 2.184, Loss_clf 0.389, Loss_fe 0.398, Loss_kd 1.315, Train_accy 83.19:  60%|██████    | 12/20 [08:08<05:27, 40.90s/it]
Task 16, Epoch 13/20 => Loss 2.082, Loss_clf 0.352, Loss_fe 0.362, Loss_kd 1.288, Train_accy 84.50:  60%|██████    | 12/20 [08:46<05:27, 40.90s/it]
Task 16, Epoch 13/20 => Loss 2.082, Loss_clf 0.352, Loss_fe 0.362, Loss_kd 1.288, Train_accy 84.50:  65%|██████▌   | 13/20 [08:46<04:39, 39.99s/it]
Task 16, Epoch 14/20 => Loss 2.097, Loss_clf 0.366, Loss_fe 0.353, Loss_kd 1.296, Train_accy 84.50:  65%|██████▌   | 13/20 [09:24<04:39, 39.99s/it]
Task 16, Epoch 14/20 => Loss 2.097, Loss_clf 0.366, Loss_fe 0.353, Loss_kd 1.296, Train_accy 84.50:  70%|███████   | 14/20 [09:24<03:56, 39.36s/it]
Task 16, Epoch 15/20 => Loss 2.078, Loss_clf 0.368, Loss_fe 0.329, Loss_kd 1.300, Train_accy 84.69:  70%|███████   | 14/20 [10:02<03:56, 39.36s/it]
Task 16, Epoch 15/20 => Loss 2.078, Loss_clf 0.368, Loss_fe 0.329, Loss_kd 1.300, Train_accy 84.69:  75%|███████▌  | 15/20 [10:02<03:14, 38.93s/it]
Task 16, Epoch 16/20 => Loss 2.112, Loss_clf 0.382, Loss_fe 0.341, Loss_kd 1.308, Train_accy 83.57, Test_accy 83.01:  75%|███████▌  | 15/20 [10:52<03:14, 38.93s/it]
Task 16, Epoch 16/20 => Loss 2.112, Loss_clf 0.382, Loss_fe 0.341, Loss_kd 1.308, Train_accy 83.57, Test_accy 83.01:  80%|████████  | 16/20 [10:52<02:48, 42.18s/it]
Task 16, Epoch 17/20 => Loss 2.046, Loss_clf 0.346, Loss_fe 0.322, Loss_kd 1.297, Train_accy 85.29:  80%|████████  | 16/20 [11:30<02:48, 42.18s/it]                 
Task 16, Epoch 17/20 => Loss 2.046, Loss_clf 0.346, Loss_fe 0.322, Loss_kd 1.297, Train_accy 85.29:  85%|████████▌ | 17/20 [11:30<02:02, 40.88s/it]
Task 16, Epoch 18/20 => Loss 2.052, Loss_clf 0.362, Loss_fe 0.312, Loss_kd 1.298, Train_accy 84.25:  85%|████████▌ | 17/20 [12:07<02:02, 40.88s/it]
Task 16, Epoch 18/20 => Loss 2.052, Loss_clf 0.362, Loss_fe 0.312, Loss_kd 1.298, Train_accy 84.25:  90%|█████████ | 18/20 [12:07<01:19, 39.98s/it]
Task 16, Epoch 19/20 => Loss 2.084, Loss_clf 0.362, Loss_fe 0.322, Loss_kd 1.317, Train_accy 84.74:  90%|█████████ | 18/20 [12:45<01:19, 39.98s/it]
Task 16, Epoch 19/20 => Loss 2.084, Loss_clf 0.362, Loss_fe 0.322, Loss_kd 1.317, Train_accy 84.74:  95%|█████████▌| 19/20 [12:45<00:39, 39.36s/it]
Task 16, Epoch 20/20 => Loss 2.147, Loss_clf 0.389, Loss_fe 0.350, Loss_kd 1.325, Train_accy 84.01:  95%|█████████▌| 19/20 [13:23<00:39, 39.36s/it]
Task 16, Epoch 20/20 => Loss 2.147, Loss_clf 0.389, Loss_fe 0.350, Loss_kd 1.325, Train_accy 84.01: 100%|██████████| 20/20 [13:23<00:00, 38.91s/it]
Task 16, Epoch 20/20 => Loss 2.147, Loss_clf 0.389, Loss_fe 0.350, Loss_kd 1.325, Train_accy 84.01: 100%|██████████| 20/20 [13:23<00:00, 40.18s/it]
2024-09-05 12:33:47,053 [foster.py] => Task 16, Epoch 20/20 => Loss 2.147, Loss_clf 0.389, Loss_fe 0.350, Loss_kd 1.325, Train_accy 84.01
2024-09-05 12:33:47,054 [foster.py] => do not weight align teacher!
2024-09-05 12:33:47,055 [foster.py] => per cls weights : [1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 0.47128095 0.47128095
 0.47128095 0.47128095 0.47128095 0.47128095 0.47128095 0.47128095
 0.47128095 0.47128095]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 16, Epoch 1/20 => Loss 1.339,  Train_accy 79.42, Test_accy 82.12:   0%|          | 0/20 [00:53<?, ?it/s]
SNet: Task 16, Epoch 1/20 => Loss 1.339,  Train_accy 79.42, Test_accy 82.12:   5%|▌         | 1/20 [00:53<17:05, 53.98s/it]
SNet: Task 16, Epoch 2/20 => Loss 1.274,  Train_accy 82.07:   5%|▌         | 1/20 [01:41<17:05, 53.98s/it]                 
SNet: Task 16, Epoch 2/20 => Loss 1.274,  Train_accy 82.07:  10%|█         | 2/20 [01:41<15:04, 50.25s/it]
SNet: Task 16, Epoch 3/20 => Loss 1.251,  Train_accy 81.44:  10%|█         | 2/20 [02:29<15:04, 50.25s/it]
SNet: Task 16, Epoch 3/20 => Loss 1.251,  Train_accy 81.44:  15%|█▌        | 3/20 [02:29<13:53, 49.05s/it]
SNet: Task 16, Epoch 4/20 => Loss 1.261,  Train_accy 81.74:  15%|█▌        | 3/20 [03:16<13:53, 49.05s/it]
SNet: Task 16, Epoch 4/20 => Loss 1.261,  Train_accy 81.74:  20%|██        | 4/20 [03:16<12:55, 48.49s/it]
SNet: Task 16, Epoch 5/20 => Loss 1.268,  Train_accy 82.40:  20%|██        | 4/20 [04:04<12:55, 48.49s/it]
SNet: Task 16, Epoch 5/20 => Loss 1.268,  Train_accy 82.40:  25%|██▌       | 5/20 [04:04<12:02, 48.18s/it]
SNet: Task 16, Epoch 6/20 => Loss 1.232,  Train_accy 82.23, Test_accy 82.37:  25%|██▌       | 5/20 [04:58<12:02, 48.18s/it]
SNet: Task 16, Epoch 6/20 => Loss 1.232,  Train_accy 82.23, Test_accy 82.37:  30%|███       | 6/20 [04:58<11:42, 50.16s/it]
SNet: Task 16, Epoch 7/20 => Loss 1.256,  Train_accy 81.85:  30%|███       | 6/20 [05:46<11:42, 50.16s/it]                 
SNet: Task 16, Epoch 7/20 => Loss 1.256,  Train_accy 81.85:  35%|███▌      | 7/20 [05:46<10:41, 49.35s/it]
SNet: Task 16, Epoch 8/20 => Loss 1.255,  Train_accy 81.80:  35%|███▌      | 7/20 [06:33<10:41, 49.35s/it]
SNet: Task 16, Epoch 8/20 => Loss 1.255,  Train_accy 81.80:  40%|████      | 8/20 [06:33<09:45, 48.79s/it]
SNet: Task 16, Epoch 9/20 => Loss 1.244,  Train_accy 82.70:  40%|████      | 8/20 [07:21<09:45, 48.79s/it]
SNet: Task 16, Epoch 9/20 => Loss 1.244,  Train_accy 82.70:  45%|████▌     | 9/20 [07:21<08:52, 48.43s/it]
SNet: Task 16, Epoch 10/20 => Loss 1.251,  Train_accy 82.72:  45%|████▌     | 9/20 [08:09<08:52, 48.43s/it]
SNet: Task 16, Epoch 10/20 => Loss 1.251,  Train_accy 82.72:  50%|█████     | 10/20 [08:09<08:01, 48.18s/it]
SNet: Task 16, Epoch 11/20 => Loss 1.235,  Train_accy 82.10, Test_accy 82.37:  50%|█████     | 10/20 [09:03<08:01, 48.18s/it]
SNet: Task 16, Epoch 11/20 => Loss 1.235,  Train_accy 82.10, Test_accy 82.37:  55%|█████▌    | 11/20 [09:03<07:29, 49.96s/it]
SNet: Task 16, Epoch 12/20 => Loss 1.258,  Train_accy 82.53:  55%|█████▌    | 11/20 [09:50<07:29, 49.96s/it]                 
SNet: Task 16, Epoch 12/20 => Loss 1.258,  Train_accy 82.53:  60%|██████    | 12/20 [09:50<06:33, 49.24s/it]
SNet: Task 16, Epoch 13/20 => Loss 1.248,  Train_accy 82.40:  60%|██████    | 12/20 [10:38<06:33, 49.24s/it]
SNet: Task 16, Epoch 13/20 => Loss 1.248,  Train_accy 82.40:  65%|██████▌   | 13/20 [10:38<05:41, 48.74s/it]
SNet: Task 16, Epoch 14/20 => Loss 1.248,  Train_accy 82.29:  65%|██████▌   | 13/20 [11:25<05:41, 48.74s/it]
SNet: Task 16, Epoch 14/20 => Loss 1.248,  Train_accy 82.29:  70%|███████   | 14/20 [11:25<04:50, 48.39s/it]
SNet: Task 16, Epoch 15/20 => Loss 1.242,  Train_accy 82.31:  70%|███████   | 14/20 [12:13<04:50, 48.39s/it]
SNet: Task 16, Epoch 15/20 => Loss 1.242,  Train_accy 82.31:  75%|███████▌  | 15/20 [12:13<04:00, 48.15s/it]
SNet: Task 16, Epoch 16/20 => Loss 1.232,  Train_accy 82.53, Test_accy 82.47:  75%|███████▌  | 15/20 [13:07<04:00, 48.15s/it]
SNet: Task 16, Epoch 16/20 => Loss 1.232,  Train_accy 82.53, Test_accy 82.47:  80%|████████  | 16/20 [13:07<03:19, 49.93s/it]
SNet: Task 16, Epoch 17/20 => Loss 1.234,  Train_accy 83.16:  80%|████████  | 16/20 [13:55<03:19, 49.93s/it]                 
SNet: Task 16, Epoch 17/20 => Loss 1.234,  Train_accy 83.16:  85%|████████▌ | 17/20 [13:55<02:27, 49.25s/it]
SNet: Task 16, Epoch 18/20 => Loss 1.278,  Train_accy 81.44:  85%|████████▌ | 17/20 [14:42<02:27, 49.25s/it]
SNet: Task 16, Epoch 18/20 => Loss 1.278,  Train_accy 81.44:  90%|█████████ | 18/20 [14:42<01:37, 48.77s/it]
SNet: Task 16, Epoch 19/20 => Loss 1.254,  Train_accy 82.10:  90%|█████████ | 18/20 [15:30<01:37, 48.77s/it]
SNet: Task 16, Epoch 19/20 => Loss 1.254,  Train_accy 82.10:  95%|█████████▌| 19/20 [15:30<00:48, 48.43s/it]
SNet: Task 16, Epoch 20/20 => Loss 1.251,  Train_accy 82.31:  95%|█████████▌| 19/20 [16:17<00:48, 48.43s/it]
SNet: Task 16, Epoch 20/20 => Loss 1.251,  Train_accy 82.31: 100%|██████████| 20/20 [16:17<00:00, 48.18s/it]
SNet: Task 16, Epoch 20/20 => Loss 1.251,  Train_accy 82.31: 100%|██████████| 20/20 [16:17<00:00, 48.90s/it]
2024-09-05 12:50:06,534 [foster.py] => SNet: Task 16, Epoch 20/20 => Loss 1.251,  Train_accy 82.31
2024-09-05 12:50:06,534 [foster.py] => do not weight align student!
2024-09-05 12:50:12,964 [foster.py] => darknet eval: 
2024-09-05 12:50:12,964 [foster.py] => CNN top1 curve: 82.67
2024-09-05 12:50:12,964 [foster.py] => CNN top5 curve: 97.33
2024-09-05 12:50:12,968 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 12:52:00,189 [foster.py] => Exemplar size: 3400
2024-09-05 12:52:00,189 [trainer.py] => CNN: {'total': 82.52, '00-09': 88.98, '10-19': 90.7, '20-29': 94.85, '30-39': 89.09, '40-49': 91.59, '50-59': 84.68, '60-69': 84.91, '70-79': 87.94, '80-89': 90.98, '90-99': 88.24, '100-109': 92.17, '110-119': 82.3, '120-129': 76.64, '130-139': 83.05, '140-149': 73.81, '150-159': 71.77, '160-169': 38.06, 'old': 85.67, 'new': 38.06}
2024-09-05 12:52:00,189 [trainer.py] => NME: {'total': 88.35, '00-09': 86.44, '10-19': 88.37, '20-29': 97.94, '30-39': 82.73, '40-49': 88.79, '50-59': 88.29, '60-69': 91.51, '70-79': 83.69, '80-89': 91.73, '90-99': 88.97, '100-109': 92.17, '110-119': 84.07, '120-129': 79.44, '130-139': 90.68, '140-149': 84.92, '150-159': 94.35, '160-169': 88.81, 'old': 88.31, 'new': 88.81}
2024-09-05 12:52:00,190 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96, 84.52, 81.66, 81.65, 82.52]
2024-09-05 12:52:00,190 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36, 97.99, 97.62, 97.73, 97.63]
2024-09-05 12:52:00,190 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23, 88.67, 88.0, 88.15, 88.35]
2024-09-05 12:52:00,190 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82, 98.66, 98.64, 98.52, 98.57]

Average Accuracy (CNN): 86.62
Average Accuracy (NME): 92.54
2024-09-05 12:52:00,190 [trainer.py] => Average Accuracy (CNN): 86.62
2024-09-05 12:52:00,190 [trainer.py] => Average Accuracy (NME): 92.54
2024-09-05 12:52:00,191 [trainer.py] => All params: 172112372
2024-09-05 12:52:00,192 [trainer.py] => Trainable params: 86190676
2024-09-05 12:52:01,739 [foster.py] => Learning on 170-180
2024-09-05 12:52:01,741 [foster.py] => All params: 172143122
2024-09-05 12:52:01,742 [foster.py] => Trainable params: 86213736
2024-09-05 12:52:01,792 [foster.py] => per cls weights : [1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 0.57204451 0.57204451 0.57204451 0.57204451
 0.57204451 0.57204451 0.57204451 0.57204451 0.57204451 0.57204451]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 5.626, Loss_clf 0.807, Loss_fe 3.429, Loss_kd 1.312, Train_accy 79.28, Test_accy 81.44:   0%|          | 0/20 [00:51<?, ?it/s]
Task 17, Epoch 1/20 => Loss 5.626, Loss_clf 0.807, Loss_fe 3.429, Loss_kd 1.312, Train_accy 79.28, Test_accy 81.44:   5%|▌         | 1/20 [00:51<16:23, 51.78s/it]
Task 17, Epoch 2/20 => Loss 3.313, Loss_clf 0.608, Loss_fe 1.245, Loss_kd 1.378, Train_accy 79.69:   5%|▌         | 1/20 [01:31<16:23, 51.78s/it]                 
Task 17, Epoch 2/20 => Loss 3.313, Loss_clf 0.608, Loss_fe 1.245, Loss_kd 1.378, Train_accy 79.69:  10%|█         | 2/20 [01:31<13:25, 44.78s/it]
Task 17, Epoch 3/20 => Loss 2.884, Loss_clf 0.535, Loss_fe 0.947, Loss_kd 1.325, Train_accy 80.87:  10%|█         | 2/20 [02:11<13:25, 44.78s/it]
Task 17, Epoch 3/20 => Loss 2.884, Loss_clf 0.535, Loss_fe 0.947, Loss_kd 1.325, Train_accy 80.87:  15%|█▌        | 3/20 [02:11<12:04, 42.60s/it]
Task 17, Epoch 4/20 => Loss 2.633, Loss_clf 0.493, Loss_fe 0.761, Loss_kd 1.303, Train_accy 81.77:  15%|█▌        | 3/20 [02:51<12:04, 42.60s/it]
Task 17, Epoch 4/20 => Loss 2.633, Loss_clf 0.493, Loss_fe 0.761, Loss_kd 1.303, Train_accy 81.77:  20%|██        | 4/20 [02:51<11:07, 41.69s/it]
Task 17, Epoch 5/20 => Loss 2.537, Loss_clf 0.472, Loss_fe 0.698, Loss_kd 1.292, Train_accy 82.82:  20%|██        | 4/20 [03:32<11:07, 41.69s/it]
Task 17, Epoch 5/20 => Loss 2.537, Loss_clf 0.472, Loss_fe 0.698, Loss_kd 1.292, Train_accy 82.82:  25%|██▌       | 5/20 [03:32<10:18, 41.22s/it]
Task 17, Epoch 6/20 => Loss 2.445, Loss_clf 0.444, Loss_fe 0.608, Loss_kd 1.316, Train_accy 81.79, Test_accy 83.22:  25%|██▌       | 5/20 [04:25<10:18, 41.22s/it]
Task 17, Epoch 6/20 => Loss 2.445, Loss_clf 0.444, Loss_fe 0.608, Loss_kd 1.316, Train_accy 81.79, Test_accy 83.22:  30%|███       | 6/20 [04:25<10:31, 45.12s/it]
Task 17, Epoch 7/20 => Loss 2.367, Loss_clf 0.435, Loss_fe 0.540, Loss_kd 1.314, Train_accy 82.51:  30%|███       | 6/20 [05:05<10:31, 45.12s/it]                 
Task 17, Epoch 7/20 => Loss 2.367, Loss_clf 0.435, Loss_fe 0.540, Loss_kd 1.314, Train_accy 82.51:  35%|███▌      | 7/20 [05:05<09:25, 43.54s/it]
Task 17, Epoch 8/20 => Loss 2.425, Loss_clf 0.447, Loss_fe 0.563, Loss_kd 1.336, Train_accy 82.79:  35%|███▌      | 7/20 [05:45<09:25, 43.54s/it]
Task 17, Epoch 8/20 => Loss 2.425, Loss_clf 0.447, Loss_fe 0.563, Loss_kd 1.336, Train_accy 82.79:  40%|████      | 8/20 [05:45<08:29, 42.47s/it]
Task 17, Epoch 9/20 => Loss 2.301, Loss_clf 0.427, Loss_fe 0.488, Loss_kd 1.310, Train_accy 82.43:  40%|████      | 8/20 [06:25<08:29, 42.47s/it]
Task 17, Epoch 9/20 => Loss 2.301, Loss_clf 0.427, Loss_fe 0.488, Loss_kd 1.310, Train_accy 82.43:  45%|████▌     | 9/20 [06:25<07:39, 41.79s/it]
Task 17, Epoch 10/20 => Loss 2.295, Loss_clf 0.417, Loss_fe 0.474, Loss_kd 1.326, Train_accy 83.00:  45%|████▌     | 9/20 [07:05<07:39, 41.79s/it]
Task 17, Epoch 10/20 => Loss 2.295, Loss_clf 0.417, Loss_fe 0.474, Loss_kd 1.326, Train_accy 83.00:  50%|█████     | 10/20 [07:05<06:53, 41.30s/it]
Task 17, Epoch 11/20 => Loss 2.261, Loss_clf 0.426, Loss_fe 0.450, Loss_kd 1.308, Train_accy 82.41, Test_accy 82.94:  50%|█████     | 10/20 [07:58<06:53, 41.30s/it]
Task 17, Epoch 11/20 => Loss 2.261, Loss_clf 0.426, Loss_fe 0.450, Loss_kd 1.308, Train_accy 82.41, Test_accy 82.94:  55%|█████▌    | 11/20 [07:58<06:42, 44.77s/it]
Task 17, Epoch 12/20 => Loss 2.157, Loss_clf 0.389, Loss_fe 0.400, Loss_kd 1.292, Train_accy 83.51:  55%|█████▌    | 11/20 [08:38<06:42, 44.77s/it]                 
Task 17, Epoch 12/20 => Loss 2.157, Loss_clf 0.389, Loss_fe 0.400, Loss_kd 1.292, Train_accy 83.51:  60%|██████    | 12/20 [08:38<05:47, 43.39s/it]
Task 17, Epoch 13/20 => Loss 2.194, Loss_clf 0.403, Loss_fe 0.414, Loss_kd 1.301, Train_accy 83.90:  60%|██████    | 12/20 [09:19<05:47, 43.39s/it]
Task 17, Epoch 13/20 => Loss 2.194, Loss_clf 0.403, Loss_fe 0.414, Loss_kd 1.301, Train_accy 83.90:  65%|██████▌   | 13/20 [09:19<04:56, 42.42s/it]
Task 17, Epoch 14/20 => Loss 2.212, Loss_clf 0.398, Loss_fe 0.406, Loss_kd 1.330, Train_accy 83.33:  65%|██████▌   | 13/20 [09:59<04:56, 42.42s/it]
Task 17, Epoch 14/20 => Loss 2.212, Loss_clf 0.398, Loss_fe 0.406, Loss_kd 1.330, Train_accy 83.33:  70%|███████   | 14/20 [09:59<04:10, 41.75s/it]
Task 17, Epoch 15/20 => Loss 2.176, Loss_clf 0.411, Loss_fe 0.380, Loss_kd 1.308, Train_accy 83.36:  70%|███████   | 14/20 [10:39<04:10, 41.75s/it]
Task 17, Epoch 15/20 => Loss 2.176, Loss_clf 0.411, Loss_fe 0.380, Loss_kd 1.308, Train_accy 83.36:  75%|███████▌  | 15/20 [10:39<03:26, 41.30s/it]
Task 17, Epoch 16/20 => Loss 2.120, Loss_clf 0.381, Loss_fe 0.370, Loss_kd 1.292, Train_accy 83.20, Test_accy 83.69:  75%|███████▌  | 15/20 [11:32<03:26, 41.30s/it]
Task 17, Epoch 16/20 => Loss 2.120, Loss_clf 0.381, Loss_fe 0.370, Loss_kd 1.292, Train_accy 83.20, Test_accy 83.69:  80%|████████  | 16/20 [11:32<02:58, 44.72s/it]
Task 17, Epoch 17/20 => Loss 2.093, Loss_clf 0.364, Loss_fe 0.352, Loss_kd 1.301, Train_accy 84.18:  80%|████████  | 16/20 [12:12<02:58, 44.72s/it]                 
Task 17, Epoch 17/20 => Loss 2.093, Loss_clf 0.364, Loss_fe 0.352, Loss_kd 1.301, Train_accy 84.18:  85%|████████▌ | 17/20 [12:12<02:10, 43.35s/it]
Task 17, Epoch 18/20 => Loss 2.112, Loss_clf 0.372, Loss_fe 0.355, Loss_kd 1.308, Train_accy 84.41:  85%|████████▌ | 17/20 [12:52<02:10, 43.35s/it]
Task 17, Epoch 18/20 => Loss 2.112, Loss_clf 0.372, Loss_fe 0.355, Loss_kd 1.308, Train_accy 84.41:  90%|█████████ | 18/20 [12:52<01:24, 42.40s/it]
Task 17, Epoch 19/20 => Loss 2.070, Loss_clf 0.361, Loss_fe 0.344, Loss_kd 1.289, Train_accy 83.77:  90%|█████████ | 18/20 [13:32<01:24, 42.40s/it]
Task 17, Epoch 19/20 => Loss 2.070, Loss_clf 0.361, Loss_fe 0.344, Loss_kd 1.289, Train_accy 83.77:  95%|█████████▌| 19/20 [13:32<00:41, 41.75s/it]
Task 17, Epoch 20/20 => Loss 2.074, Loss_clf 0.371, Loss_fe 0.328, Loss_kd 1.299, Train_accy 83.90:  95%|█████████▌| 19/20 [14:12<00:41, 41.75s/it]
Task 17, Epoch 20/20 => Loss 2.074, Loss_clf 0.371, Loss_fe 0.328, Loss_kd 1.299, Train_accy 83.90: 100%|██████████| 20/20 [14:12<00:00, 41.27s/it]
Task 17, Epoch 20/20 => Loss 2.074, Loss_clf 0.371, Loss_fe 0.328, Loss_kd 1.299, Train_accy 83.90: 100%|██████████| 20/20 [14:12<00:00, 42.65s/it]
2024-09-05 13:06:14,712 [foster.py] => Task 17, Epoch 20/20 => Loss 2.074, Loss_clf 0.371, Loss_fe 0.328, Loss_kd 1.299, Train_accy 83.90
2024-09-05 13:06:14,713 [foster.py] => do not weight align teacher!
2024-09-05 13:06:14,718 [foster.py] => per cls weights : [1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 0.47041734 0.47041734 0.47041734 0.47041734
 0.47041734 0.47041734 0.47041734 0.47041734 0.47041734 0.47041734]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 17, Epoch 1/20 => Loss 1.309,  Train_accy 79.48, Test_accy 83.08:   0%|          | 0/20 [00:57<?, ?it/s]
SNet: Task 17, Epoch 1/20 => Loss 1.309,  Train_accy 79.48, Test_accy 83.08:   5%|▌         | 1/20 [00:57<18:05, 57.15s/it]
SNet: Task 17, Epoch 2/20 => Loss 1.280,  Train_accy 80.20:   5%|▌         | 1/20 [01:47<18:05, 57.15s/it]                 
SNet: Task 17, Epoch 2/20 => Loss 1.280,  Train_accy 80.20:  10%|█         | 2/20 [01:47<15:58, 53.25s/it]
SNet: Task 17, Epoch 3/20 => Loss 1.227,  Train_accy 81.48:  10%|█         | 2/20 [02:38<15:58, 53.25s/it]
SNet: Task 17, Epoch 3/20 => Loss 1.227,  Train_accy 81.48:  15%|█▌        | 3/20 [02:38<14:44, 52.00s/it]
SNet: Task 17, Epoch 4/20 => Loss 1.230,  Train_accy 81.07:  15%|█▌        | 3/20 [03:28<14:44, 52.00s/it]
SNet: Task 17, Epoch 4/20 => Loss 1.230,  Train_accy 81.07:  20%|██        | 4/20 [03:28<13:43, 51.44s/it]
SNet: Task 17, Epoch 5/20 => Loss 1.244,  Train_accy 81.48:  20%|██        | 4/20 [04:19<13:43, 51.44s/it]
SNet: Task 17, Epoch 5/20 => Loss 1.244,  Train_accy 81.48:  25%|██▌       | 5/20 [04:19<12:46, 51.11s/it]
SNet: Task 17, Epoch 6/20 => Loss 1.253,  Train_accy 81.05, Test_accy 83.18:  25%|██▌       | 5/20 [05:16<12:46, 51.11s/it]
SNet: Task 17, Epoch 6/20 => Loss 1.253,  Train_accy 81.05, Test_accy 83.18:  30%|███       | 6/20 [05:16<12:24, 53.18s/it]
SNet: Task 17, Epoch 7/20 => Loss 1.251,  Train_accy 81.28:  30%|███       | 6/20 [06:07<12:24, 53.18s/it]                 
SNet: Task 17, Epoch 7/20 => Loss 1.251,  Train_accy 81.28:  35%|███▌      | 7/20 [06:07<11:20, 52.32s/it]
SNet: Task 17, Epoch 8/20 => Loss 1.255,  Train_accy 81.56:  35%|███▌      | 7/20 [06:57<11:20, 52.32s/it]
SNet: Task 17, Epoch 8/20 => Loss 1.255,  Train_accy 81.56:  40%|████      | 8/20 [06:57<10:20, 51.74s/it]
SNet: Task 17, Epoch 9/20 => Loss 1.273,  Train_accy 81.23:  40%|████      | 8/20 [07:48<10:20, 51.74s/it]
SNet: Task 17, Epoch 9/20 => Loss 1.273,  Train_accy 81.23:  45%|████▌     | 9/20 [07:48<09:25, 51.37s/it]
SNet: Task 17, Epoch 10/20 => Loss 1.265,  Train_accy 81.18:  45%|████▌     | 9/20 [08:38<09:25, 51.37s/it]
SNet: Task 17, Epoch 10/20 => Loss 1.265,  Train_accy 81.18:  50%|█████     | 10/20 [08:38<08:31, 51.11s/it]
SNet: Task 17, Epoch 11/20 => Loss 1.254,  Train_accy 81.15, Test_accy 83.83:  50%|█████     | 10/20 [09:35<08:31, 51.11s/it]
SNet: Task 17, Epoch 11/20 => Loss 1.254,  Train_accy 81.15, Test_accy 83.83:  55%|█████▌    | 11/20 [09:35<07:56, 52.99s/it]
SNet: Task 17, Epoch 12/20 => Loss 1.238,  Train_accy 81.74:  55%|█████▌    | 11/20 [10:26<07:56, 52.99s/it]                 
SNet: Task 17, Epoch 12/20 => Loss 1.238,  Train_accy 81.74:  60%|██████    | 12/20 [10:26<06:57, 52.24s/it]
SNet: Task 17, Epoch 13/20 => Loss 1.214,  Train_accy 82.28:  60%|██████    | 12/20 [11:16<06:57, 52.24s/it]
SNet: Task 17, Epoch 13/20 => Loss 1.214,  Train_accy 82.28:  65%|██████▌   | 13/20 [11:16<06:02, 51.72s/it]
SNet: Task 17, Epoch 14/20 => Loss 1.240,  Train_accy 81.90:  65%|██████▌   | 13/20 [12:07<06:02, 51.72s/it]
SNet: Task 17, Epoch 14/20 => Loss 1.240,  Train_accy 81.90:  70%|███████   | 14/20 [12:07<05:08, 51.38s/it]
SNet: Task 17, Epoch 15/20 => Loss 1.238,  Train_accy 81.51:  70%|███████   | 14/20 [12:58<05:08, 51.38s/it]
SNet: Task 17, Epoch 15/20 => Loss 1.238,  Train_accy 81.51:  75%|███████▌  | 15/20 [12:58<04:15, 51.13s/it]
SNet: Task 17, Epoch 16/20 => Loss 1.259,  Train_accy 81.46, Test_accy 83.74:  75%|███████▌  | 15/20 [13:55<04:15, 51.13s/it]
SNet: Task 17, Epoch 16/20 => Loss 1.259,  Train_accy 81.46, Test_accy 83.74:  80%|████████  | 16/20 [13:55<03:31, 52.99s/it]
SNet: Task 17, Epoch 17/20 => Loss 1.232,  Train_accy 81.59:  80%|████████  | 16/20 [14:45<03:31, 52.99s/it]                 
SNet: Task 17, Epoch 17/20 => Loss 1.232,  Train_accy 81.59:  85%|████████▌ | 17/20 [14:45<02:36, 52.25s/it]
SNet: Task 17, Epoch 18/20 => Loss 1.232,  Train_accy 82.13:  85%|████████▌ | 17/20 [15:36<02:36, 52.25s/it]
SNet: Task 17, Epoch 18/20 => Loss 1.232,  Train_accy 82.13:  90%|█████████ | 18/20 [15:36<01:43, 51.74s/it]
SNet: Task 17, Epoch 19/20 => Loss 1.234,  Train_accy 82.00:  90%|█████████ | 18/20 [16:27<01:43, 51.74s/it]
SNet: Task 17, Epoch 19/20 => Loss 1.234,  Train_accy 82.00:  95%|█████████▌| 19/20 [16:27<00:51, 51.39s/it]
SNet: Task 17, Epoch 20/20 => Loss 1.229,  Train_accy 81.72:  95%|█████████▌| 19/20 [17:17<00:51, 51.39s/it]
SNet: Task 17, Epoch 20/20 => Loss 1.229,  Train_accy 81.72: 100%|██████████| 20/20 [17:17<00:00, 51.15s/it]
SNet: Task 17, Epoch 20/20 => Loss 1.229,  Train_accy 81.72: 100%|██████████| 20/20 [17:17<00:00, 51.88s/it]
2024-09-05 13:23:33,888 [foster.py] => SNet: Task 17, Epoch 20/20 => Loss 1.229,  Train_accy 81.72
2024-09-05 13:23:33,888 [foster.py] => do not weight align student!
2024-09-05 13:23:40,568 [foster.py] => darknet eval: 
2024-09-05 13:23:40,568 [foster.py] => CNN top1 curve: 83.79
2024-09-05 13:23:40,569 [foster.py] => CNN top5 curve: 97.7
2024-09-05 13:23:40,572 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 13:25:32,757 [foster.py] => Exemplar size: 3600
2024-09-05 13:25:32,757 [trainer.py] => CNN: {'total': 83.55, '00-09': 88.14, '10-19': 89.92, '20-29': 95.88, '30-39': 82.73, '40-49': 89.72, '50-59': 85.59, '60-69': 83.96, '70-79': 87.94, '80-89': 89.47, '90-99': 89.71, '100-109': 90.43, '110-119': 83.19, '120-129': 82.24, '130-139': 87.29, '140-149': 76.98, '150-159': 83.87, '160-169': 74.63, '170-179': 37.86, 'old': 85.88, 'new': 37.86}
2024-09-05 13:25:32,757 [trainer.py] => NME: {'total': 88.49, '00-09': 85.59, '10-19': 89.92, '20-29': 96.91, '30-39': 83.64, '40-49': 87.85, '50-59': 89.19, '60-69': 89.62, '70-79': 86.52, '80-89': 90.98, '90-99': 86.76, '100-109': 94.78, '110-119': 82.3, '120-129': 78.5, '130-139': 88.98, '140-149': 85.71, '150-159': 95.97, '160-169': 89.55, '170-179': 90.29, 'old': 88.4, 'new': 90.29}
2024-09-05 13:25:32,757 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96, 84.52, 81.66, 81.65, 82.52, 83.55]
2024-09-05 13:25:32,757 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36, 97.99, 97.62, 97.73, 97.63, 97.42]
2024-09-05 13:25:32,757 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23, 88.67, 88.0, 88.15, 88.35, 88.49]
2024-09-05 13:25:32,757 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82, 98.66, 98.64, 98.52, 98.57, 98.45]

Average Accuracy (CNN): 86.45
Average Accuracy (NME): 92.32
2024-09-05 13:25:32,757 [trainer.py] => Average Accuracy (CNN): 86.45
2024-09-05 13:25:32,758 [trainer.py] => Average Accuracy (NME): 92.32
2024-09-05 13:25:32,759 [trainer.py] => All params: 172143122
2024-09-05 13:25:32,760 [trainer.py] => Trainable params: 86213736
2024-09-05 13:25:34,387 [foster.py] => Learning on 180-190
2024-09-05 13:25:34,388 [foster.py] => All params: 172173872
2024-09-05 13:25:34,389 [foster.py] => Trainable params: 86236796
2024-09-05 13:25:34,440 [foster.py] => per cls weights : [1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 0.57128759 0.57128759 0.57128759 0.57128759 0.57128759 0.57128759
 0.57128759 0.57128759 0.57128759 0.57128759]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 5.572, Loss_clf 0.828, Loss_fe 3.398, Loss_kd 1.275, Train_accy 79.53, Test_accy 80.75:   0%|          | 0/20 [00:54<?, ?it/s]
Task 18, Epoch 1/20 => Loss 5.572, Loss_clf 0.828, Loss_fe 3.398, Loss_kd 1.275, Train_accy 79.53, Test_accy 80.75:   5%|▌         | 1/20 [00:54<17:06, 54.04s/it]
Task 18, Epoch 2/20 => Loss 3.171, Loss_clf 0.574, Loss_fe 1.235, Loss_kd 1.290, Train_accy 80.86:   5%|▌         | 1/20 [01:35<17:06, 54.04s/it]                 
Task 18, Epoch 2/20 => Loss 3.171, Loss_clf 0.574, Loss_fe 1.235, Loss_kd 1.290, Train_accy 80.86:  10%|█         | 2/20 [01:35<13:59, 46.65s/it]
Task 18, Epoch 3/20 => Loss 2.787, Loss_clf 0.528, Loss_fe 0.917, Loss_kd 1.272, Train_accy 81.45:  10%|█         | 2/20 [02:17<13:59, 46.65s/it]
Task 18, Epoch 3/20 => Loss 2.787, Loss_clf 0.528, Loss_fe 0.917, Loss_kd 1.272, Train_accy 81.45:  15%|█▌        | 3/20 [02:17<12:33, 44.35s/it]
Task 18, Epoch 4/20 => Loss 2.702, Loss_clf 0.524, Loss_fe 0.798, Loss_kd 1.308, Train_accy 81.01:  15%|█▌        | 3/20 [02:58<12:33, 44.35s/it]
Task 18, Epoch 4/20 => Loss 2.702, Loss_clf 0.524, Loss_fe 0.798, Loss_kd 1.308, Train_accy 81.01:  20%|██        | 4/20 [02:58<11:32, 43.31s/it]
Task 18, Epoch 5/20 => Loss 2.472, Loss_clf 0.479, Loss_fe 0.676, Loss_kd 1.248, Train_accy 81.36:  20%|██        | 4/20 [03:40<11:32, 43.31s/it]
Task 18, Epoch 5/20 => Loss 2.472, Loss_clf 0.479, Loss_fe 0.676, Loss_kd 1.248, Train_accy 81.36:  25%|██▌       | 5/20 [03:40<10:41, 42.78s/it]
Task 18, Epoch 6/20 => Loss 2.452, Loss_clf 0.481, Loss_fe 0.617, Loss_kd 1.282, Train_accy 81.58, Test_accy 82.17:  25%|██▌       | 5/20 [04:35<10:41, 42.78s/it]
Task 18, Epoch 6/20 => Loss 2.452, Loss_clf 0.481, Loss_fe 0.617, Loss_kd 1.282, Train_accy 81.58, Test_accy 82.17:  30%|███       | 6/20 [04:35<10:56, 46.90s/it]
Task 18, Epoch 7/20 => Loss 2.391, Loss_clf 0.471, Loss_fe 0.563, Loss_kd 1.285, Train_accy 81.38:  30%|███       | 6/20 [05:17<10:56, 46.90s/it]                 
Task 18, Epoch 7/20 => Loss 2.391, Loss_clf 0.471, Loss_fe 0.563, Loss_kd 1.285, Train_accy 81.38:  35%|███▌      | 7/20 [05:17<09:48, 45.25s/it]
Task 18, Epoch 8/20 => Loss 2.413, Loss_clf 0.476, Loss_fe 0.571, Loss_kd 1.294, Train_accy 81.11:  35%|███▌      | 7/20 [05:59<09:48, 45.25s/it]
Task 18, Epoch 8/20 => Loss 2.413, Loss_clf 0.476, Loss_fe 0.571, Loss_kd 1.294, Train_accy 81.11:  40%|████      | 8/20 [05:59<08:50, 44.17s/it]
Task 18, Epoch 9/20 => Loss 2.320, Loss_clf 0.437, Loss_fe 0.528, Loss_kd 1.284, Train_accy 82.10:  40%|████      | 8/20 [06:41<08:50, 44.17s/it]
Task 18, Epoch 9/20 => Loss 2.320, Loss_clf 0.437, Loss_fe 0.528, Loss_kd 1.284, Train_accy 82.10:  45%|████▌     | 9/20 [06:41<07:57, 43.45s/it]
Task 18, Epoch 10/20 => Loss 2.187, Loss_clf 0.418, Loss_fe 0.454, Loss_kd 1.245, Train_accy 82.96:  45%|████▌     | 9/20 [07:23<07:57, 43.45s/it]
Task 18, Epoch 10/20 => Loss 2.187, Loss_clf 0.418, Loss_fe 0.454, Loss_kd 1.245, Train_accy 82.96:  50%|█████     | 10/20 [07:23<07:09, 42.95s/it]
Task 18, Epoch 11/20 => Loss 2.178, Loss_clf 0.414, Loss_fe 0.435, Loss_kd 1.259, Train_accy 82.61, Test_accy 82.30:  50%|█████     | 10/20 [08:18<07:09, 42.95s/it]
Task 18, Epoch 11/20 => Loss 2.178, Loss_clf 0.414, Loss_fe 0.435, Loss_kd 1.259, Train_accy 82.61, Test_accy 82.30:  55%|█████▌    | 11/20 [08:18<06:59, 46.65s/it]
Task 18, Epoch 12/20 => Loss 2.145, Loss_clf 0.401, Loss_fe 0.420, Loss_kd 1.254, Train_accy 82.76:  55%|█████▌    | 11/20 [08:59<06:59, 46.65s/it]                 
Task 18, Epoch 12/20 => Loss 2.145, Loss_clf 0.401, Loss_fe 0.420, Loss_kd 1.254, Train_accy 82.76:  60%|██████    | 12/20 [08:59<06:01, 45.19s/it]
Task 18, Epoch 13/20 => Loss 2.201, Loss_clf 0.417, Loss_fe 0.422, Loss_kd 1.290, Train_accy 83.28:  60%|██████    | 12/20 [09:41<06:01, 45.19s/it]
Task 18, Epoch 13/20 => Loss 2.201, Loss_clf 0.417, Loss_fe 0.422, Loss_kd 1.290, Train_accy 83.28:  65%|██████▌   | 13/20 [09:41<05:09, 44.19s/it]
Task 18, Epoch 14/20 => Loss 2.042, Loss_clf 0.365, Loss_fe 0.365, Loss_kd 1.243, Train_accy 84.09:  65%|██████▌   | 13/20 [10:23<05:09, 44.19s/it]
Task 18, Epoch 14/20 => Loss 2.042, Loss_clf 0.365, Loss_fe 0.365, Loss_kd 1.243, Train_accy 84.09:  70%|███████   | 14/20 [10:23<04:20, 43.50s/it]
Task 18, Epoch 15/20 => Loss 2.239, Loss_clf 0.438, Loss_fe 0.424, Loss_kd 1.304, Train_accy 81.97:  70%|███████   | 14/20 [11:05<04:20, 43.50s/it]
Task 18, Epoch 15/20 => Loss 2.239, Loss_clf 0.438, Loss_fe 0.424, Loss_kd 1.304, Train_accy 81.97:  75%|███████▌  | 15/20 [11:05<03:35, 43.00s/it]
Task 18, Epoch 16/20 => Loss 2.022, Loss_clf 0.374, Loss_fe 0.346, Loss_kd 1.234, Train_accy 83.40, Test_accy 81.95:  75%|███████▌  | 15/20 [12:00<03:35, 43.00s/it]
Task 18, Epoch 16/20 => Loss 2.022, Loss_clf 0.374, Loss_fe 0.346, Loss_kd 1.234, Train_accy 83.40, Test_accy 81.95:  80%|████████  | 16/20 [12:00<03:06, 46.62s/it]
Task 18, Epoch 17/20 => Loss 2.002, Loss_clf 0.371, Loss_fe 0.337, Loss_kd 1.226, Train_accy 83.35:  80%|████████  | 16/20 [12:42<03:06, 46.62s/it]                 
Task 18, Epoch 17/20 => Loss 2.002, Loss_clf 0.371, Loss_fe 0.337, Loss_kd 1.226, Train_accy 83.35:  85%|████████▌ | 17/20 [12:42<02:15, 45.17s/it]
Task 18, Epoch 18/20 => Loss 2.120, Loss_clf 0.397, Loss_fe 0.368, Loss_kd 1.284, Train_accy 82.61:  85%|████████▌ | 17/20 [13:24<02:15, 45.17s/it]
Task 18, Epoch 18/20 => Loss 2.120, Loss_clf 0.397, Loss_fe 0.368, Loss_kd 1.284, Train_accy 82.61:  90%|█████████ | 18/20 [13:24<01:28, 44.19s/it]
Task 18, Epoch 19/20 => Loss 2.008, Loss_clf 0.359, Loss_fe 0.335, Loss_kd 1.244, Train_accy 83.45:  90%|█████████ | 18/20 [14:06<01:28, 44.19s/it]
Task 18, Epoch 19/20 => Loss 2.008, Loss_clf 0.359, Loss_fe 0.335, Loss_kd 1.244, Train_accy 83.45:  95%|█████████▌| 19/20 [14:06<00:43, 43.51s/it]
Task 18, Epoch 20/20 => Loss 2.034, Loss_clf 0.354, Loss_fe 0.334, Loss_kd 1.275, Train_accy 84.07:  95%|█████████▌| 19/20 [14:48<00:43, 43.51s/it]
Task 18, Epoch 20/20 => Loss 2.034, Loss_clf 0.354, Loss_fe 0.334, Loss_kd 1.275, Train_accy 84.07: 100%|██████████| 20/20 [14:48<00:00, 43.02s/it]
Task 18, Epoch 20/20 => Loss 2.034, Loss_clf 0.354, Loss_fe 0.334, Loss_kd 1.275, Train_accy 84.07: 100%|██████████| 20/20 [14:48<00:00, 44.40s/it]
2024-09-05 13:40:22,500 [foster.py] => Task 18, Epoch 20/20 => Loss 2.034, Loss_clf 0.354, Loss_fe 0.334, Loss_kd 1.275, Train_accy 84.07
2024-09-05 13:40:22,501 [foster.py] => do not weight align teacher!
2024-09-05 13:40:22,506 [foster.py] => per cls weights : [1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 0.46964732 0.46964732 0.46964732 0.46964732 0.46964732 0.46964732
 0.46964732 0.46964732 0.46964732 0.46964732]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 18, Epoch 1/20 => Loss 1.255,  Train_accy 80.00, Test_accy 82.57:   0%|          | 0/20 [00:59<?, ?it/s]
SNet: Task 18, Epoch 1/20 => Loss 1.255,  Train_accy 80.00, Test_accy 82.57:   5%|▌         | 1/20 [00:59<18:53, 59.68s/it]
SNet: Task 18, Epoch 2/20 => Loss 1.239,  Train_accy 80.59:   5%|▌         | 1/20 [01:52<18:53, 59.68s/it]                 
SNet: Task 18, Epoch 2/20 => Loss 1.239,  Train_accy 80.59:  10%|█         | 2/20 [01:52<16:39, 55.51s/it]
SNet: Task 18, Epoch 3/20 => Loss 1.222,  Train_accy 80.44:  10%|█         | 2/20 [02:44<16:39, 55.51s/it]
SNet: Task 18, Epoch 3/20 => Loss 1.222,  Train_accy 80.44:  15%|█▌        | 3/20 [02:44<15:21, 54.20s/it]
SNet: Task 18, Epoch 4/20 => Loss 1.268,  Train_accy 80.35:  15%|█▌        | 3/20 [03:37<15:21, 54.20s/it]
SNet: Task 18, Epoch 4/20 => Loss 1.268,  Train_accy 80.35:  20%|██        | 4/20 [03:37<14:17, 53.59s/it]
SNet: Task 18, Epoch 5/20 => Loss 1.236,  Train_accy 80.81:  20%|██        | 4/20 [04:30<14:17, 53.59s/it]
SNet: Task 18, Epoch 5/20 => Loss 1.236,  Train_accy 80.81:  25%|██▌       | 5/20 [04:30<13:18, 53.25s/it]
SNet: Task 18, Epoch 6/20 => Loss 1.230,  Train_accy 81.41, Test_accy 82.35:  25%|██▌       | 5/20 [05:29<13:18, 53.25s/it]
SNet: Task 18, Epoch 6/20 => Loss 1.230,  Train_accy 81.41, Test_accy 82.35:  30%|███       | 6/20 [05:29<12:56, 55.46s/it]
SNet: Task 18, Epoch 7/20 => Loss 1.223,  Train_accy 81.45:  30%|███       | 6/20 [06:22<12:56, 55.46s/it]                 
SNet: Task 18, Epoch 7/20 => Loss 1.223,  Train_accy 81.45:  35%|███▌      | 7/20 [06:22<11:48, 54.53s/it]
SNet: Task 18, Epoch 8/20 => Loss 1.225,  Train_accy 81.16:  35%|███▌      | 7/20 [07:15<11:48, 54.53s/it]
SNet: Task 18, Epoch 8/20 => Loss 1.225,  Train_accy 81.16:  40%|████      | 8/20 [07:15<10:47, 53.93s/it]
SNet: Task 18, Epoch 9/20 => Loss 1.200,  Train_accy 81.58:  40%|████      | 8/20 [08:07<10:47, 53.93s/it]
SNet: Task 18, Epoch 9/20 => Loss 1.200,  Train_accy 81.58:  45%|████▌     | 9/20 [08:07<09:48, 53.53s/it]
SNet: Task 18, Epoch 10/20 => Loss 1.225,  Train_accy 81.60:  45%|████▌     | 9/20 [09:00<09:48, 53.53s/it]
SNet: Task 18, Epoch 10/20 => Loss 1.225,  Train_accy 81.60:  50%|█████     | 10/20 [09:00<08:52, 53.25s/it]
SNet: Task 18, Epoch 11/20 => Loss 1.190,  Train_accy 81.95, Test_accy 82.43:  50%|█████     | 10/20 [10:00<08:52, 53.25s/it]
SNet: Task 18, Epoch 11/20 => Loss 1.190,  Train_accy 81.95, Test_accy 82.43:  55%|█████▌    | 11/20 [10:00<08:17, 55.25s/it]
SNet: Task 18, Epoch 12/20 => Loss 1.215,  Train_accy 81.50:  55%|█████▌    | 11/20 [10:52<08:17, 55.25s/it]                 
SNet: Task 18, Epoch 12/20 => Loss 1.215,  Train_accy 81.50:  60%|██████    | 12/20 [10:52<07:15, 54.46s/it]
SNet: Task 18, Epoch 13/20 => Loss 1.207,  Train_accy 81.75:  60%|██████    | 12/20 [11:45<07:15, 54.46s/it]
SNet: Task 18, Epoch 13/20 => Loss 1.207,  Train_accy 81.75:  65%|██████▌   | 13/20 [11:45<06:17, 53.90s/it]
SNet: Task 18, Epoch 14/20 => Loss 1.227,  Train_accy 81.70:  65%|██████▌   | 13/20 [12:38<06:17, 53.90s/it]
SNet: Task 18, Epoch 14/20 => Loss 1.227,  Train_accy 81.70:  70%|███████   | 14/20 [12:38<05:21, 53.51s/it]
SNet: Task 18, Epoch 15/20 => Loss 1.195,  Train_accy 81.78:  70%|███████   | 14/20 [13:30<05:21, 53.51s/it]
SNet: Task 18, Epoch 15/20 => Loss 1.195,  Train_accy 81.78:  75%|███████▌  | 15/20 [13:30<04:26, 53.23s/it]
SNet: Task 18, Epoch 16/20 => Loss 1.209,  Train_accy 82.07, Test_accy 82.61:  75%|███████▌  | 15/20 [14:30<04:26, 53.23s/it]
SNet: Task 18, Epoch 16/20 => Loss 1.209,  Train_accy 82.07, Test_accy 82.61:  80%|████████  | 16/20 [14:30<03:40, 55.18s/it]
SNet: Task 18, Epoch 17/20 => Loss 1.211,  Train_accy 82.15:  80%|████████  | 16/20 [15:23<03:40, 55.18s/it]                 
SNet: Task 18, Epoch 17/20 => Loss 1.211,  Train_accy 82.15:  85%|████████▌ | 17/20 [15:23<02:43, 54.40s/it]
SNet: Task 18, Epoch 18/20 => Loss 1.192,  Train_accy 82.49:  85%|████████▌ | 17/20 [16:15<02:43, 54.40s/it]
SNet: Task 18, Epoch 18/20 => Loss 1.192,  Train_accy 82.49:  90%|█████████ | 18/20 [16:15<01:47, 53.86s/it]
SNet: Task 18, Epoch 19/20 => Loss 1.205,  Train_accy 81.90:  90%|█████████ | 18/20 [17:08<01:47, 53.86s/it]
SNet: Task 18, Epoch 19/20 => Loss 1.205,  Train_accy 81.90:  95%|█████████▌| 19/20 [17:08<00:53, 53.49s/it]
SNet: Task 18, Epoch 20/20 => Loss 1.198,  Train_accy 81.73:  95%|█████████▌| 19/20 [18:00<00:53, 53.49s/it]
SNet: Task 18, Epoch 20/20 => Loss 1.198,  Train_accy 81.73: 100%|██████████| 20/20 [18:00<00:00, 53.23s/it]
SNet: Task 18, Epoch 20/20 => Loss 1.198,  Train_accy 81.73: 100%|██████████| 20/20 [18:00<00:00, 54.04s/it]
2024-09-05 13:58:24,979 [foster.py] => SNet: Task 18, Epoch 20/20 => Loss 1.198,  Train_accy 81.73
2024-09-05 13:58:24,980 [foster.py] => do not weight align student!
2024-09-05 13:58:32,031 [foster.py] => darknet eval: 
2024-09-05 13:58:32,032 [foster.py] => CNN top1 curve: 82.57
2024-09-05 13:58:32,032 [foster.py] => CNN top5 curve: 96.5
2024-09-05 13:58:32,035 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 14:00:29,613 [foster.py] => Exemplar size: 3800
2024-09-05 14:00:29,613 [trainer.py] => CNN: {'total': 81.9, '00-09': 86.44, '10-19': 89.15, '20-29': 95.88, '30-39': 85.45, '40-49': 89.72, '50-59': 84.68, '60-69': 84.91, '70-79': 87.23, '80-89': 87.97, '90-99': 86.76, '100-109': 92.17, '110-119': 83.19, '120-129': 82.24, '130-139': 88.14, '140-149': 76.19, '150-159': 87.9, '160-169': 82.09, '170-179': 74.76, '180-189': 18.94, 'old': 85.81, 'new': 18.94}
2024-09-05 14:00:29,613 [trainer.py] => NME: {'total': 88.54, '00-09': 86.44, '10-19': 89.15, '20-29': 95.88, '30-39': 81.82, '40-49': 86.92, '50-59': 87.39, '60-69': 89.62, '70-79': 85.82, '80-89': 90.98, '90-99': 88.24, '100-109': 95.65, '110-119': 84.07, '120-129': 76.64, '130-139': 88.98, '140-149': 87.3, '150-159': 96.77, '160-169': 89.55, '170-179': 91.26, '180-189': 89.39, 'old': 88.49, 'new': 89.39}
2024-09-05 14:00:29,613 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96, 84.52, 81.66, 81.65, 82.52, 83.55, 81.9]
2024-09-05 14:00:29,613 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36, 97.99, 97.62, 97.73, 97.63, 97.42, 97.3]
2024-09-05 14:00:29,613 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23, 88.67, 88.0, 88.15, 88.35, 88.49, 88.54]
2024-09-05 14:00:29,613 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82, 98.66, 98.64, 98.52, 98.57, 98.45, 98.32]

Average Accuracy (CNN): 86.21
Average Accuracy (NME): 92.12
2024-09-05 14:00:29,613 [trainer.py] => Average Accuracy (CNN): 86.21
2024-09-05 14:00:29,614 [trainer.py] => Average Accuracy (NME): 92.12
2024-09-05 14:00:29,615 [trainer.py] => All params: 172173872
2024-09-05 14:00:29,616 [trainer.py] => Trainable params: 86236796
2024-09-05 14:00:31,207 [foster.py] => Learning on 190-200
2024-09-05 14:00:31,209 [foster.py] => All params: 172204622
2024-09-05 14:00:31,210 [foster.py] => Trainable params: 86259856
2024-09-05 14:00:31,263 [foster.py] => per cls weights : [1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 0.57060807 0.57060807
 0.57060807 0.57060807 0.57060807 0.57060807 0.57060807 0.57060807
 0.57060807 0.57060807]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 5.866, Loss_clf 0.896, Loss_fe 3.587, Loss_kd 1.314, Train_accy 77.82, Test_accy 80.20:   0%|          | 0/20 [00:57<?, ?it/s]
Task 19, Epoch 1/20 => Loss 5.866, Loss_clf 0.896, Loss_fe 3.587, Loss_kd 1.314, Train_accy 77.82, Test_accy 80.20:   5%|▌         | 1/20 [00:57<18:03, 57.01s/it]
Task 19, Epoch 2/20 => Loss 3.183, Loss_clf 0.592, Loss_fe 1.275, Loss_kd 1.250, Train_accy 79.40:   5%|▌         | 1/20 [01:40<18:03, 57.01s/it]                 
Task 19, Epoch 2/20 => Loss 3.183, Loss_clf 0.592, Loss_fe 1.275, Loss_kd 1.250, Train_accy 79.40:  10%|█         | 2/20 [01:40<14:47, 49.30s/it]
Task 19, Epoch 3/20 => Loss 2.840, Loss_clf 0.562, Loss_fe 0.938, Loss_kd 1.273, Train_accy 80.27:  10%|█         | 2/20 [02:25<14:47, 49.30s/it]
Task 19, Epoch 3/20 => Loss 2.840, Loss_clf 0.562, Loss_fe 0.938, Loss_kd 1.273, Train_accy 80.27:  15%|█▌        | 3/20 [02:25<13:17, 46.92s/it]
Task 19, Epoch 4/20 => Loss 2.629, Loss_clf 0.507, Loss_fe 0.802, Loss_kd 1.253, Train_accy 80.15:  15%|█▌        | 3/20 [03:09<13:17, 46.92s/it]
Task 19, Epoch 4/20 => Loss 2.629, Loss_clf 0.507, Loss_fe 0.802, Loss_kd 1.253, Train_accy 80.15:  20%|██        | 4/20 [03:09<12:13, 45.85s/it]
Task 19, Epoch 5/20 => Loss 2.580, Loss_clf 0.491, Loss_fe 0.717, Loss_kd 1.303, Train_accy 81.31:  20%|██        | 4/20 [03:53<12:13, 45.85s/it]
Task 19, Epoch 5/20 => Loss 2.580, Loss_clf 0.491, Loss_fe 0.717, Loss_kd 1.303, Train_accy 81.31:  25%|██▌       | 5/20 [03:53<11:19, 45.27s/it]
Task 19, Epoch 6/20 => Loss 2.428, Loss_clf 0.461, Loss_fe 0.648, Loss_kd 1.253, Train_accy 81.43, Test_accy 83.08:  25%|██▌       | 5/20 [04:51<11:19, 45.27s/it]
Task 19, Epoch 6/20 => Loss 2.428, Loss_clf 0.461, Loss_fe 0.648, Loss_kd 1.253, Train_accy 81.43, Test_accy 83.08:  30%|███       | 6/20 [04:51<11:34, 49.58s/it]
Task 19, Epoch 7/20 => Loss 2.270, Loss_clf 0.427, Loss_fe 0.547, Loss_kd 1.232, Train_accy 82.52:  30%|███       | 6/20 [05:35<11:34, 49.58s/it]                 
Task 19, Epoch 7/20 => Loss 2.270, Loss_clf 0.427, Loss_fe 0.547, Loss_kd 1.232, Train_accy 82.52:  35%|███▌      | 7/20 [05:35<10:22, 47.86s/it]
Task 19, Epoch 8/20 => Loss 2.336, Loss_clf 0.438, Loss_fe 0.554, Loss_kd 1.276, Train_accy 82.38:  35%|███▌      | 7/20 [06:20<10:22, 47.86s/it]
Task 19, Epoch 8/20 => Loss 2.336, Loss_clf 0.438, Loss_fe 0.554, Loss_kd 1.276, Train_accy 82.38:  40%|████      | 8/20 [06:20<09:20, 46.73s/it]
Task 19, Epoch 9/20 => Loss 2.327, Loss_clf 0.455, Loss_fe 0.534, Loss_kd 1.271, Train_accy 81.89:  40%|████      | 8/20 [07:04<09:20, 46.73s/it]
Task 19, Epoch 9/20 => Loss 2.327, Loss_clf 0.455, Loss_fe 0.534, Loss_kd 1.271, Train_accy 81.89:  45%|████▌     | 9/20 [07:04<08:25, 45.97s/it]
Task 19, Epoch 10/20 => Loss 2.214, Loss_clf 0.426, Loss_fe 0.461, Loss_kd 1.261, Train_accy 82.34:  45%|████▌     | 9/20 [07:48<08:25, 45.97s/it]
Task 19, Epoch 10/20 => Loss 2.214, Loss_clf 0.426, Loss_fe 0.461, Loss_kd 1.261, Train_accy 82.34:  50%|█████     | 10/20 [07:48<07:34, 45.47s/it]
Task 19, Epoch 11/20 => Loss 2.146, Loss_clf 0.404, Loss_fe 0.429, Loss_kd 1.248, Train_accy 82.41, Test_accy 82.74:  50%|█████     | 10/20 [08:46<07:34, 45.47s/it]
Task 19, Epoch 11/20 => Loss 2.146, Loss_clf 0.404, Loss_fe 0.429, Loss_kd 1.248, Train_accy 82.41, Test_accy 82.74:  55%|█████▌    | 11/20 [08:46<07:23, 49.30s/it]
Task 19, Epoch 12/20 => Loss 2.221, Loss_clf 0.438, Loss_fe 0.450, Loss_kd 1.266, Train_accy 81.99:  55%|█████▌    | 11/20 [09:30<07:23, 49.30s/it]                 
Task 19, Epoch 12/20 => Loss 2.221, Loss_clf 0.438, Loss_fe 0.450, Loss_kd 1.266, Train_accy 81.99:  60%|██████    | 12/20 [09:30<06:22, 47.79s/it]
Task 19, Epoch 13/20 => Loss 2.092, Loss_clf 0.392, Loss_fe 0.391, Loss_kd 1.244, Train_accy 82.52:  60%|██████    | 12/20 [10:15<06:22, 47.79s/it]
Task 19, Epoch 13/20 => Loss 2.092, Loss_clf 0.392, Loss_fe 0.391, Loss_kd 1.244, Train_accy 82.52:  65%|██████▌   | 13/20 [10:15<05:27, 46.74s/it]
Task 19, Epoch 14/20 => Loss 1.973, Loss_clf 0.355, Loss_fe 0.349, Loss_kd 1.206, Train_accy 83.41:  65%|██████▌   | 13/20 [10:59<05:27, 46.74s/it]
Task 19, Epoch 14/20 => Loss 1.973, Loss_clf 0.355, Loss_fe 0.349, Loss_kd 1.206, Train_accy 83.41:  70%|███████   | 14/20 [10:59<04:36, 46.01s/it]
Task 19, Epoch 15/20 => Loss 2.141, Loss_clf 0.408, Loss_fe 0.396, Loss_kd 1.270, Train_accy 82.57:  70%|███████   | 14/20 [11:43<04:36, 46.01s/it]
Task 19, Epoch 15/20 => Loss 2.141, Loss_clf 0.408, Loss_fe 0.396, Loss_kd 1.270, Train_accy 82.57:  75%|███████▌  | 15/20 [11:43<03:47, 45.50s/it]
Task 19, Epoch 16/20 => Loss 2.093, Loss_clf 0.389, Loss_fe 0.372, Loss_kd 1.265, Train_accy 83.01, Test_accy 82.57:  75%|███████▌  | 15/20 [12:41<03:47, 45.50s/it]
Task 19, Epoch 16/20 => Loss 2.093, Loss_clf 0.389, Loss_fe 0.372, Loss_kd 1.265, Train_accy 83.01, Test_accy 82.57:  80%|████████  | 16/20 [12:41<03:17, 49.26s/it]
Task 19, Epoch 17/20 => Loss 2.114, Loss_clf 0.408, Loss_fe 0.377, Loss_kd 1.262, Train_accy 83.08:  80%|████████  | 16/20 [13:26<03:17, 49.26s/it]                 
Task 19, Epoch 17/20 => Loss 2.114, Loss_clf 0.408, Loss_fe 0.377, Loss_kd 1.262, Train_accy 83.08:  85%|████████▌ | 17/20 [13:26<02:23, 47.76s/it]
Task 19, Epoch 18/20 => Loss 2.112, Loss_clf 0.405, Loss_fe 0.370, Loss_kd 1.270, Train_accy 82.78:  85%|████████▌ | 17/20 [14:10<02:23, 47.76s/it]
Task 19, Epoch 18/20 => Loss 2.112, Loss_clf 0.405, Loss_fe 0.370, Loss_kd 1.270, Train_accy 82.78:  90%|█████████ | 18/20 [14:10<01:33, 46.73s/it]
Task 19, Epoch 19/20 => Loss 2.052, Loss_clf 0.381, Loss_fe 0.354, Loss_kd 1.251, Train_accy 83.50:  90%|█████████ | 18/20 [14:54<01:33, 46.73s/it]
Task 19, Epoch 19/20 => Loss 2.052, Loss_clf 0.381, Loss_fe 0.354, Loss_kd 1.251, Train_accy 83.50:  95%|█████████▌| 19/20 [14:54<00:45, 46.00s/it]
Task 19, Epoch 20/20 => Loss 2.046, Loss_clf 0.383, Loss_fe 0.347, Loss_kd 1.249, Train_accy 83.20:  95%|█████████▌| 19/20 [15:39<00:45, 46.00s/it]
Task 19, Epoch 20/20 => Loss 2.046, Loss_clf 0.383, Loss_fe 0.347, Loss_kd 1.249, Train_accy 83.20: 100%|██████████| 20/20 [15:39<00:00, 45.49s/it]
Task 19, Epoch 20/20 => Loss 2.046, Loss_clf 0.383, Loss_fe 0.347, Loss_kd 1.249, Train_accy 83.20: 100%|██████████| 20/20 [15:39<00:00, 46.96s/it]
2024-09-05 14:16:10,439 [foster.py] => Task 19, Epoch 20/20 => Loss 2.046, Loss_clf 0.383, Loss_fe 0.347, Loss_kd 1.249, Train_accy 83.20
2024-09-05 14:16:10,440 [foster.py] => do not weight align teacher!
2024-09-05 14:16:10,441 [foster.py] => per cls weights : [1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 0.46895645 0.46895645
 0.46895645 0.46895645 0.46895645 0.46895645 0.46895645 0.46895645
 0.46895645 0.46895645]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 19, Epoch 1/20 => Loss 1.257,  Train_accy 79.22, Test_accy 82.82:   0%|          | 0/20 [01:03<?, ?it/s]
SNet: Task 19, Epoch 1/20 => Loss 1.257,  Train_accy 79.22, Test_accy 82.82:   5%|▌         | 1/20 [01:03<20:00, 63.17s/it]
SNet: Task 19, Epoch 2/20 => Loss 1.246,  Train_accy 80.10:   5%|▌         | 1/20 [01:58<20:00, 63.17s/it]                 
SNet: Task 19, Epoch 2/20 => Loss 1.246,  Train_accy 80.10:  10%|█         | 2/20 [01:58<17:37, 58.74s/it]
SNet: Task 19, Epoch 3/20 => Loss 1.264,  Train_accy 79.78:  10%|█         | 2/20 [02:54<17:37, 58.74s/it]
SNet: Task 19, Epoch 3/20 => Loss 1.264,  Train_accy 79.78:  15%|█▌        | 3/20 [02:54<16:15, 57.38s/it]
SNet: Task 19, Epoch 4/20 => Loss 1.213,  Train_accy 81.03:  15%|█▌        | 3/20 [03:50<16:15, 57.38s/it]
SNet: Task 19, Epoch 4/20 => Loss 1.213,  Train_accy 81.03:  20%|██        | 4/20 [03:50<15:07, 56.72s/it]
SNet: Task 19, Epoch 5/20 => Loss 1.210,  Train_accy 80.80:  20%|██        | 4/20 [04:45<15:07, 56.72s/it]
SNet: Task 19, Epoch 5/20 => Loss 1.210,  Train_accy 80.80:  25%|██▌       | 5/20 [04:45<14:05, 56.36s/it]
SNet: Task 19, Epoch 6/20 => Loss 1.236,  Train_accy 81.01, Test_accy 82.78:  25%|██▌       | 5/20 [05:49<14:05, 56.36s/it]
SNet: Task 19, Epoch 6/20 => Loss 1.236,  Train_accy 81.01, Test_accy 82.78:  30%|███       | 6/20 [05:49<13:41, 58.70s/it]
SNet: Task 19, Epoch 7/20 => Loss 1.199,  Train_accy 81.34:  30%|███       | 6/20 [06:45<13:41, 58.70s/it]                 
SNet: Task 19, Epoch 7/20 => Loss 1.199,  Train_accy 81.34:  35%|███▌      | 7/20 [06:45<12:30, 57.74s/it]
SNet: Task 19, Epoch 8/20 => Loss 1.210,  Train_accy 80.92:  35%|███▌      | 7/20 [07:40<12:30, 57.74s/it]
SNet: Task 19, Epoch 8/20 => Loss 1.210,  Train_accy 80.92:  40%|████      | 8/20 [07:40<11:25, 57.12s/it]
SNet: Task 19, Epoch 9/20 => Loss 1.180,  Train_accy 81.96:  40%|████      | 8/20 [08:36<11:25, 57.12s/it]
SNet: Task 19, Epoch 9/20 => Loss 1.180,  Train_accy 81.96:  45%|████▌     | 9/20 [08:36<10:23, 56.69s/it]
SNet: Task 19, Epoch 10/20 => Loss 1.222,  Train_accy 81.48:  45%|████▌     | 9/20 [09:32<10:23, 56.69s/it]
SNet: Task 19, Epoch 10/20 => Loss 1.222,  Train_accy 81.48:  50%|█████     | 10/20 [09:32<09:23, 56.39s/it]
SNet: Task 19, Epoch 11/20 => Loss 1.216,  Train_accy 80.68, Test_accy 82.61:  50%|█████     | 10/20 [10:35<09:23, 56.39s/it]
SNet: Task 19, Epoch 11/20 => Loss 1.216,  Train_accy 80.68, Test_accy 82.61:  55%|█████▌    | 11/20 [10:35<08:46, 58.46s/it]
SNet: Task 19, Epoch 12/20 => Loss 1.220,  Train_accy 81.68:  55%|█████▌    | 11/20 [11:31<08:46, 58.46s/it]                 
SNet: Task 19, Epoch 12/20 => Loss 1.220,  Train_accy 81.68:  60%|██████    | 12/20 [11:31<07:40, 57.62s/it]
SNet: Task 19, Epoch 13/20 => Loss 1.221,  Train_accy 81.68:  60%|██████    | 12/20 [12:26<07:40, 57.62s/it]
SNet: Task 19, Epoch 13/20 => Loss 1.221,  Train_accy 81.68:  65%|██████▌   | 13/20 [12:26<06:39, 57.05s/it]
SNet: Task 19, Epoch 14/20 => Loss 1.193,  Train_accy 81.64:  65%|██████▌   | 13/20 [13:22<06:39, 57.05s/it]
SNet: Task 19, Epoch 14/20 => Loss 1.193,  Train_accy 81.64:  70%|███████   | 14/20 [13:22<05:39, 56.64s/it]
SNet: Task 19, Epoch 15/20 => Loss 1.203,  Train_accy 81.75:  70%|███████   | 14/20 [14:18<05:39, 56.64s/it]
SNet: Task 19, Epoch 15/20 => Loss 1.203,  Train_accy 81.75:  75%|███████▌  | 15/20 [14:18<04:41, 56.35s/it]
SNet: Task 19, Epoch 16/20 => Loss 1.230,  Train_accy 81.10, Test_accy 82.74:  75%|███████▌  | 15/20 [15:21<04:41, 56.35s/it]
SNet: Task 19, Epoch 16/20 => Loss 1.230,  Train_accy 81.10, Test_accy 82.74:  80%|████████  | 16/20 [15:21<03:53, 58.40s/it]
SNet: Task 19, Epoch 17/20 => Loss 1.200,  Train_accy 81.96:  80%|████████  | 16/20 [16:17<03:53, 58.40s/it]                 
SNet: Task 19, Epoch 17/20 => Loss 1.200,  Train_accy 81.96:  85%|████████▌ | 17/20 [16:17<02:52, 57.58s/it]
SNet: Task 19, Epoch 18/20 => Loss 1.204,  Train_accy 81.75:  85%|████████▌ | 17/20 [17:12<02:52, 57.58s/it]
SNet: Task 19, Epoch 18/20 => Loss 1.204,  Train_accy 81.75:  90%|█████████ | 18/20 [17:12<01:54, 57.02s/it]
SNet: Task 19, Epoch 19/20 => Loss 1.212,  Train_accy 81.20:  90%|█████████ | 18/20 [18:08<01:54, 57.02s/it]
SNet: Task 19, Epoch 19/20 => Loss 1.212,  Train_accy 81.20:  95%|█████████▌| 19/20 [18:08<00:56, 56.63s/it]
SNet: Task 19, Epoch 20/20 => Loss 1.193,  Train_accy 81.27:  95%|█████████▌| 19/20 [19:04<00:56, 56.63s/it]
SNet: Task 19, Epoch 20/20 => Loss 1.193,  Train_accy 81.27: 100%|██████████| 20/20 [19:04<00:00, 56.36s/it]
SNet: Task 19, Epoch 20/20 => Loss 1.193,  Train_accy 81.27: 100%|██████████| 20/20 [19:04<00:00, 57.21s/it]
2024-09-05 14:35:16,097 [foster.py] => SNet: Task 19, Epoch 20/20 => Loss 1.193,  Train_accy 81.27
2024-09-05 14:35:16,097 [foster.py] => do not weight align student!
2024-09-05 14:35:23,472 [foster.py] => darknet eval: 
2024-09-05 14:35:23,473 [foster.py] => CNN top1 curve: 82.74
2024-09-05 14:35:23,473 [foster.py] => CNN top5 curve: 97.54
2024-09-05 14:35:23,477 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 14:37:27,854 [foster.py] => Exemplar size: 4000
2024-09-05 14:37:27,855 [trainer.py] => CNN: {'total': 82.53, '00-09': 89.83, '10-19': 89.92, '20-29': 93.81, '30-39': 82.73, '40-49': 91.59, '50-59': 83.78, '60-69': 83.96, '70-79': 86.52, '80-89': 90.23, '90-99': 88.24, '100-109': 88.7, '110-119': 84.96, '120-129': 78.5, '130-139': 84.75, '140-149': 81.75, '150-159': 93.55, '160-169': 85.82, '170-179': 78.64, '180-189': 60.61, '190-199': 23.47, 'old': 85.09, 'new': 23.47}
2024-09-05 14:37:27,855 [trainer.py] => NME: {'total': 87.57, '00-09': 87.29, '10-19': 87.6, '20-29': 95.88, '30-39': 80.0, '40-49': 87.85, '50-59': 88.29, '60-69': 83.02, '70-79': 85.11, '80-89': 92.48, '90-99': 87.5, '100-109': 91.3, '110-119': 81.42, '120-129': 76.64, '130-139': 86.44, '140-149': 86.51, '150-159': 95.16, '160-169': 88.81, '170-179': 88.35, '180-189': 89.39, '190-199': 91.84, 'old': 87.39, 'new': 91.84}
2024-09-05 14:37:27,855 [trainer.py] => CNN top1 curve: [99.15, 94.74, 92.15, 89.65, 88.59, 86.01, 84.7, 83.35, 84.7, 84.18, 85.8, 84.25, 84.96, 84.52, 81.66, 81.65, 82.52, 83.55, 81.9, 82.53]
2024-09-05 14:37:27,855 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.34, 98.75, 98.66, 98.71, 98.04, 98.38, 98.65, 98.16, 98.52, 98.36, 97.99, 97.62, 97.73, 97.63, 97.42, 97.3, 97.58]
2024-09-05 14:37:27,855 [trainer.py] => NME top1 curve: [99.15, 97.17, 97.38, 96.7, 95.72, 93.3, 92.54, 92.38, 92.21, 92.09, 92.17, 89.97, 89.23, 88.67, 88.0, 88.15, 88.35, 88.49, 88.54, 87.57]
2024-09-05 14:37:27,855 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.71, 99.56, 99.47, 99.4, 99.23, 99.02, 99.05, 99.16, 98.85, 98.59, 98.82, 98.66, 98.64, 98.52, 98.57, 98.45, 98.32, 98.39]

Average Accuracy (CNN): 86.03
Average Accuracy (NME): 91.89
2024-09-05 14:37:27,855 [trainer.py] => Average Accuracy (CNN): 86.03
2024-09-05 14:37:27,855 [trainer.py] => Average Accuracy (NME): 91.89
Accuracy Matrix (CNN):
[[ 99.15 100.   100.   100.    99.15  99.15  96.61  95.76  94.07  93.22
   94.07  92.37  90.68  92.37  87.29  88.14  88.98  88.14  86.44  89.83]
 [  0.    89.92  94.57  97.67  98.45  98.45  98.45  94.57  95.35  94.57
   93.8   92.25  91.47  89.92  88.37  88.37  90.7   89.92  89.15  89.92]
 [  0.     0.    79.38  87.63  91.75  94.85  96.91  95.88  95.88  95.88
   95.88  96.91  95.88  96.91  94.85  95.88  94.85  95.88  95.88  93.81]
 [  0.     0.     0.    70.91  77.27  83.64  89.09  90.    88.18  89.09
   85.45  86.36  84.55  88.18  84.55  86.36  89.09  82.73  85.45  82.73]
 [  0.     0.     0.     0.    73.83  86.92  93.46  93.46  91.59  92.52
   93.46  93.46  92.52  91.59  91.59  91.59  91.59  89.72  89.72  91.59]
 [  0.     0.     0.     0.     0.    51.35  74.77  85.59  85.59  85.59
   89.19  85.59  87.39  87.39  87.39  86.49  84.68  85.59  84.68  83.78]
 [  0.     0.     0.     0.     0.     0.    40.57  66.98  84.91  83.96
   83.02  87.74  89.62  87.74  84.91  86.79  84.91  83.96  84.91  83.96]
 [  0.     0.     0.     0.     0.     0.     0.    51.77  80.85  88.65
   90.78  88.65  92.2   87.94  87.94  85.82  87.94  87.94  87.23  86.52]
 [  0.     0.     0.     0.     0.     0.     0.     0.    52.63  75.19
   87.97  91.73  90.98  92.48  92.48  88.72  90.98  89.47  87.97  90.23]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    50.74
   79.41  86.03  88.97  88.24  87.5   87.5   88.24  89.71  86.76  88.24]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
   51.3   74.78  87.83  89.57  90.43  91.3   92.17  90.43  92.17  88.7 ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.    33.63  60.18  76.99  79.65  82.3   82.3   83.19  83.19  84.96]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.    47.66  71.03  74.77  77.57  76.64  82.24  82.24  78.5 ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.    42.37  63.56  80.51  83.05  87.29  88.14  84.75]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.    32.54  58.73  73.81  76.98  76.19  81.75]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.    35.48  71.77  83.87  87.9   93.55]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.    38.06  74.63  82.09  85.82]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.    37.86  74.76  78.64]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.    18.94  60.61]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.     0.    23.47]]
2024-09-05 14:37:27,857 [trainer.py] => Forgetting (CNN): 3.2636842105263155
Accuracy Matrix (NME):
[[99.15 98.31 98.31 96.61 96.61 88.98 90.68 88.98 88.98 89.83 90.68 87.29
  88.14 87.29 85.59 85.59 86.44 85.59 86.44 87.29]
 [ 0.   96.12 96.9  96.9  95.35 95.35 92.25 91.47 91.47 93.02 90.7  89.92
  87.6  90.7  90.7  88.37 88.37 89.92 89.15 87.6 ]
 [ 0.    0.   96.91 96.91 97.94 96.91 97.94 97.94 97.94 96.91 97.94 97.94
  96.91 97.94 97.94 97.94 97.94 96.91 95.88 95.88]
 [ 0.    0.    0.   96.36 92.73 91.82 88.18 88.18 89.09 85.45 82.73 81.82
  84.55 83.64 79.09 80.91 82.73 83.64 81.82 80.  ]
 [ 0.    0.    0.    0.   96.26 95.33 95.33 95.33 94.39 93.46 95.33 94.39
  88.79 90.65 88.79 87.85 88.79 87.85 86.92 87.85]
 [ 0.    0.    0.    0.    0.   91.89 90.09 90.99 89.19 90.09 89.19 86.49
  89.19 89.19 89.19 88.29 88.29 89.19 87.39 88.29]
 [ 0.    0.    0.    0.    0.    0.   94.34 92.45 92.45 90.57 92.45 90.57
  90.57 90.57 88.68 86.79 91.51 89.62 89.62 83.02]
 [ 0.    0.    0.    0.    0.    0.    0.   94.33 94.33 95.04 95.04 87.94
  89.36 86.52 87.23 84.4  83.69 86.52 85.82 85.11]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   92.48 93.23 93.98 93.98
  93.98 93.23 92.48 91.73 91.73 90.98 90.98 92.48]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   92.65 91.91 90.44
  88.97 88.24 90.44 88.97 88.97 86.76 88.24 87.5 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   93.91 93.04
  95.65 94.78 93.91 93.91 92.17 94.78 95.65 91.3 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   86.73
  81.42 83.19 82.3  80.53 84.07 82.3  84.07 81.42]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  85.05 77.57 78.5  79.44 79.44 78.5  76.64 76.64]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   88.14 86.44 88.14 90.68 88.98 88.98 86.44]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   88.1  90.48 84.92 85.71 87.3  86.51]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   96.77 94.35 95.97 96.77 95.16]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   88.81 89.55 89.55 88.81]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   90.29 91.26 88.35]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   89.39 89.39]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   91.84]]
2024-09-05 14:37:27,859 [trainer.py] => Forgetting (NME): 5.843684210526319
2024-09-05 14:37:30,728 [trainer.py] => config: ./exps/foster_cub_B100_Inc5.json
2024-09-05 14:37:30,747 [trainer.py] => prefix: cil
2024-09-05 14:37:30,747 [trainer.py] => dataset: cub
2024-09-05 14:37:30,747 [trainer.py] => memory_size: 4000
2024-09-05 14:37:30,747 [trainer.py] => memory_per_class: 20
2024-09-05 14:37:30,747 [trainer.py] => fixed_memory: True
2024-09-05 14:37:30,747 [trainer.py] => shuffle: True
2024-09-05 14:37:30,747 [trainer.py] => init_cls: 100
2024-09-05 14:37:30,747 [trainer.py] => increment: 20
2024-09-05 14:37:30,748 [trainer.py] => model_name: foster
2024-09-05 14:37:30,748 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 14:37:30,748 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 14:37:30,748 [trainer.py] => seed: 1993
2024-09-05 14:37:30,748 [trainer.py] => beta1: 0.96
2024-09-05 14:37:30,748 [trainer.py] => beta2: 0.97
2024-09-05 14:37:30,748 [trainer.py] => oofc: ft
2024-09-05 14:37:30,748 [trainer.py] => is_teacher_wa: False
2024-09-05 14:37:30,748 [trainer.py] => is_student_wa: False
2024-09-05 14:37:30,748 [trainer.py] => lambda_okd: 1
2024-09-05 14:37:30,748 [trainer.py] => wa_value: 1
2024-09-05 14:37:30,748 [trainer.py] => init_epochs: 20
2024-09-05 14:37:30,748 [trainer.py] => init_lr: 0.001
2024-09-05 14:37:30,748 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 14:37:30,748 [trainer.py] => boosting_epochs: 20
2024-09-05 14:37:30,748 [trainer.py] => compression_epochs: 20
2024-09-05 14:37:30,748 [trainer.py] => lr: 0.001
2024-09-05 14:37:30,748 [trainer.py] => batch_size: 48
2024-09-05 14:37:30,748 [trainer.py] => weight_decay: 0.0005
2024-09-05 14:37:30,748 [trainer.py] => num_workers: 8
2024-09-05 14:37:30,748 [trainer.py] => T: 2
2024-09-05 14:37:30,789 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 14:37:31,080 [trainer.py] => All params: 0
2024-09-05 14:37:31,080 [trainer.py] => Trainable params: 0
2024-09-05 14:37:32,609 [foster.py] => Learning on 0-100
2024-09-05 14:37:32,609 [foster.py] => All params: 85952456
2024-09-05 14:37:32,610 [foster.py] => Trainable params: 85952456

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.746, Train_accy 0.89, Test_accy 1.18:   0%|          | 0/20 [00:38<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.746, Train_accy 0.89, Test_accy 1.18:   5%|▌         | 1/20 [00:38<12:20, 38.95s/it]
Task 0, Epoch 2/20 => Loss 3.817, Train_accy 15.40:   5%|▌         | 1/20 [01:14<12:20, 38.95s/it]               
Task 0, Epoch 2/20 => Loss 3.817, Train_accy 15.40:  10%|█         | 2/20 [01:14<11:00, 36.70s/it]
Task 0, Epoch 3/20 => Loss 1.113, Train_accy 69.26:  10%|█         | 2/20 [01:49<11:00, 36.70s/it]
Task 0, Epoch 3/20 => Loss 1.113, Train_accy 69.26:  15%|█▌        | 3/20 [01:49<10:12, 36.05s/it]
Task 0, Epoch 4/20 => Loss 0.754, Train_accy 79.48:  15%|█▌        | 3/20 [02:24<10:12, 36.05s/it]
Task 0, Epoch 4/20 => Loss 0.754, Train_accy 79.48:  20%|██        | 4/20 [02:24<09:32, 35.79s/it]
Task 0, Epoch 5/20 => Loss 0.620, Train_accy 82.77:  20%|██        | 4/20 [03:00<09:32, 35.79s/it]
Task 0, Epoch 5/20 => Loss 0.620, Train_accy 82.77:  25%|██▌       | 5/20 [03:00<08:55, 35.69s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 84.70, Test_accy 88.97:  25%|██▌       | 5/20 [03:39<08:55, 35.69s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 84.70, Test_accy 88.97:  30%|███       | 6/20 [03:39<08:37, 36.94s/it]
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 87.09:  30%|███       | 6/20 [04:15<08:37, 36.94s/it]                 
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 87.09:  35%|███▌      | 7/20 [04:15<07:53, 36.46s/it]
Task 0, Epoch 8/20 => Loss 0.448, Train_accy 87.58:  35%|███▌      | 7/20 [04:50<07:53, 36.46s/it]
Task 0, Epoch 8/20 => Loss 0.448, Train_accy 87.58:  40%|████      | 8/20 [04:50<07:13, 36.15s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 88.45:  40%|████      | 8/20 [05:26<07:13, 36.15s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 88.45:  45%|████▌     | 9/20 [05:26<06:35, 35.98s/it]
Task 0, Epoch 10/20 => Loss 0.397, Train_accy 89.45:  45%|████▌     | 9/20 [06:01<06:35, 35.98s/it]
Task 0, Epoch 10/20 => Loss 0.397, Train_accy 89.45:  50%|█████     | 10/20 [06:01<05:58, 35.83s/it]
Task 0, Epoch 11/20 => Loss 0.389, Train_accy 89.33, Test_accy 90.40:  50%|█████     | 10/20 [06:41<05:58, 35.83s/it]
Task 0, Epoch 11/20 => Loss 0.389, Train_accy 89.33, Test_accy 90.40:  55%|█████▌    | 11/20 [06:41<05:32, 36.92s/it]
Task 0, Epoch 12/20 => Loss 0.353, Train_accy 90.16:  55%|█████▌    | 11/20 [07:16<05:32, 36.92s/it]                 
Task 0, Epoch 12/20 => Loss 0.353, Train_accy 90.16:  60%|██████    | 12/20 [07:16<04:51, 36.50s/it]
Task 0, Epoch 13/20 => Loss 0.313, Train_accy 91.76:  60%|██████    | 12/20 [07:52<04:51, 36.50s/it]
Task 0, Epoch 13/20 => Loss 0.313, Train_accy 91.76:  65%|██████▌   | 13/20 [07:52<04:13, 36.22s/it]
Task 0, Epoch 14/20 => Loss 0.313, Train_accy 91.63:  65%|██████▌   | 13/20 [08:27<04:13, 36.22s/it]
Task 0, Epoch 14/20 => Loss 0.313, Train_accy 91.63:  70%|███████   | 14/20 [08:27<03:36, 36.03s/it]
Task 0, Epoch 15/20 => Loss 0.296, Train_accy 92.25:  70%|███████   | 14/20 [09:03<03:36, 36.03s/it]
Task 0, Epoch 15/20 => Loss 0.296, Train_accy 92.25:  75%|███████▌  | 15/20 [09:03<02:59, 35.87s/it]
Task 0, Epoch 16/20 => Loss 0.282, Train_accy 92.37, Test_accy 91.41:  75%|███████▌  | 15/20 [09:42<02:59, 35.87s/it]
Task 0, Epoch 16/20 => Loss 0.282, Train_accy 92.37, Test_accy 91.41:  80%|████████  | 16/20 [09:42<02:27, 36.92s/it]
Task 0, Epoch 17/20 => Loss 0.282, Train_accy 92.25:  80%|████████  | 16/20 [10:18<02:27, 36.92s/it]                 
Task 0, Epoch 17/20 => Loss 0.282, Train_accy 92.25:  85%|████████▌ | 17/20 [10:18<01:49, 36.50s/it]
Task 0, Epoch 18/20 => Loss 0.293, Train_accy 92.16:  85%|████████▌ | 17/20 [10:53<01:49, 36.50s/it]
Task 0, Epoch 18/20 => Loss 0.293, Train_accy 92.16:  90%|█████████ | 18/20 [10:53<01:12, 36.22s/it]
Task 0, Epoch 19/20 => Loss 0.270, Train_accy 92.67:  90%|█████████ | 18/20 [11:29<01:12, 36.22s/it]
Task 0, Epoch 19/20 => Loss 0.270, Train_accy 92.67:  95%|█████████▌| 19/20 [11:29<00:36, 36.01s/it]
Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35:  95%|█████████▌| 19/20 [12:04<00:36, 36.01s/it]
Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35: 100%|██████████| 20/20 [12:04<00:00, 35.88s/it]
Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35: 100%|██████████| 20/20 [12:04<00:00, 36.24s/it]
2024-09-05 14:49:37,909 [foster.py] => Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35
2024-09-05 14:49:37,910 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 14:51:04,534 [foster.py] => Exemplar size: 2000
2024-09-05 14:51:04,534 [trainer.py] => CNN: {'total': 92.0, '00-99': 92.0, 'old': 0, 'new': 92.0}
2024-09-05 14:51:04,534 [trainer.py] => NME: {'total': 91.5, '00-99': 91.5, 'old': 0, 'new': 91.5}
2024-09-05 14:51:04,534 [trainer.py] => CNN top1 curve: [92.0]
2024-09-05 14:51:04,534 [trainer.py] => CNN top5 curve: [98.91]
2024-09-05 14:51:04,534 [trainer.py] => NME top1 curve: [91.5]
2024-09-05 14:51:04,534 [trainer.py] => NME top5 curve: [99.16]

Average Accuracy (CNN): 92.0
Average Accuracy (NME): 91.5
2024-09-05 14:51:04,534 [trainer.py] => Average Accuracy (CNN): 92.0
2024-09-05 14:51:04,534 [trainer.py] => Average Accuracy (NME): 91.5
2024-09-05 14:51:04,535 [trainer.py] => All params: 85952456
2024-09-05 14:51:04,535 [trainer.py] => Trainable params: 85952456
2024-09-05 14:51:05,938 [foster.py] => Learning on 100-120
2024-09-05 14:51:05,940 [foster.py] => All params: 171950932
2024-09-05 14:51:05,941 [foster.py] => Trainable params: 86075376
2024-09-05 14:51:05,988 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.595, Loss_clf 1.225, Loss_fe 3.234, Loss_kd 0.947, Train_accy 69.65, Test_accy 82.98:   0%|          | 0/20 [00:38<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.595, Loss_clf 1.225, Loss_fe 3.234, Loss_kd 0.947, Train_accy 69.65, Test_accy 82.98:   5%|▌         | 1/20 [00:38<12:02, 38.03s/it]
Task 1, Epoch 2/20 => Loss 2.508, Loss_clf 0.503, Loss_fe 0.889, Loss_kd 0.930, Train_accy 73.71:   5%|▌         | 1/20 [01:08<12:02, 38.03s/it]                 
Task 1, Epoch 2/20 => Loss 2.508, Loss_clf 0.503, Loss_fe 0.889, Loss_kd 0.930, Train_accy 73.71:  10%|█         | 2/20 [01:08<10:02, 33.49s/it]
Task 1, Epoch 3/20 => Loss 2.251, Loss_clf 0.439, Loss_fe 0.692, Loss_kd 0.934, Train_accy 74.05:  10%|█         | 2/20 [01:38<10:02, 33.49s/it]
Task 1, Epoch 3/20 => Loss 2.251, Loss_clf 0.439, Loss_fe 0.692, Loss_kd 0.934, Train_accy 74.05:  15%|█▌        | 3/20 [01:38<09:05, 32.08s/it]
Task 1, Epoch 4/20 => Loss 2.199, Loss_clf 0.424, Loss_fe 0.657, Loss_kd 0.932, Train_accy 74.49:  15%|█▌        | 3/20 [02:09<09:05, 32.08s/it]
Task 1, Epoch 4/20 => Loss 2.199, Loss_clf 0.424, Loss_fe 0.657, Loss_kd 0.932, Train_accy 74.49:  20%|██        | 4/20 [02:09<08:22, 31.41s/it]
Task 1, Epoch 5/20 => Loss 2.020, Loss_clf 0.363, Loss_fe 0.548, Loss_kd 0.925, Train_accy 74.90:  20%|██        | 4/20 [02:39<08:22, 31.41s/it]
Task 1, Epoch 5/20 => Loss 2.020, Loss_clf 0.363, Loss_fe 0.548, Loss_kd 0.925, Train_accy 74.90:  25%|██▌       | 5/20 [02:39<07:45, 31.06s/it]
Task 1, Epoch 6/20 => Loss 1.857, Loss_clf 0.330, Loss_fe 0.454, Loss_kd 0.895, Train_accy 74.36, Test_accy 85.24:  25%|██▌       | 5/20 [03:18<07:45, 31.06s/it]
Task 1, Epoch 6/20 => Loss 1.857, Loss_clf 0.330, Loss_fe 0.454, Loss_kd 0.895, Train_accy 74.36, Test_accy 85.24:  30%|███       | 6/20 [03:18<07:52, 33.74s/it]
Task 1, Epoch 7/20 => Loss 1.846, Loss_clf 0.320, Loss_fe 0.432, Loss_kd 0.912, Train_accy 75.64:  30%|███       | 6/20 [03:49<07:52, 33.74s/it]                 
Task 1, Epoch 7/20 => Loss 1.846, Loss_clf 0.320, Loss_fe 0.432, Loss_kd 0.912, Train_accy 75.64:  35%|███▌      | 7/20 [03:49<07:04, 32.69s/it]
Task 1, Epoch 8/20 => Loss 1.811, Loss_clf 0.316, Loss_fe 0.406, Loss_kd 0.908, Train_accy 76.69:  35%|███▌      | 7/20 [04:19<07:04, 32.69s/it]
Task 1, Epoch 8/20 => Loss 1.811, Loss_clf 0.316, Loss_fe 0.406, Loss_kd 0.908, Train_accy 76.69:  40%|████      | 8/20 [04:19<06:24, 32.01s/it]
Task 1, Epoch 9/20 => Loss 1.812, Loss_clf 0.300, Loss_fe 0.384, Loss_kd 0.939, Train_accy 76.32:  40%|████      | 8/20 [04:50<06:24, 32.01s/it]
Task 1, Epoch 9/20 => Loss 1.812, Loss_clf 0.300, Loss_fe 0.384, Loss_kd 0.939, Train_accy 76.32:  45%|████▌     | 9/20 [04:50<05:47, 31.57s/it]
Task 1, Epoch 10/20 => Loss 1.776, Loss_clf 0.303, Loss_fe 0.383, Loss_kd 0.909, Train_accy 75.85:  45%|████▌     | 9/20 [05:20<05:47, 31.57s/it]
Task 1, Epoch 10/20 => Loss 1.776, Loss_clf 0.303, Loss_fe 0.383, Loss_kd 0.909, Train_accy 75.85:  50%|█████     | 10/20 [05:20<05:12, 31.26s/it]
Task 1, Epoch 11/20 => Loss 1.688, Loss_clf 0.273, Loss_fe 0.327, Loss_kd 0.906, Train_accy 75.95, Test_accy 84.82:  50%|█████     | 10/20 [05:59<05:12, 31.26s/it]
Task 1, Epoch 11/20 => Loss 1.688, Loss_clf 0.273, Loss_fe 0.327, Loss_kd 0.906, Train_accy 75.95, Test_accy 84.82:  55%|█████▌    | 11/20 [05:59<05:02, 33.61s/it]
Task 1, Epoch 12/20 => Loss 1.826, Loss_clf 0.333, Loss_fe 0.380, Loss_kd 0.928, Train_accy 75.10:  55%|█████▌    | 11/20 [06:30<05:02, 33.61s/it]                 
Task 1, Epoch 12/20 => Loss 1.826, Loss_clf 0.333, Loss_fe 0.380, Loss_kd 0.928, Train_accy 75.10:  60%|██████    | 12/20 [06:30<04:21, 32.67s/it]
Task 1, Epoch 13/20 => Loss 1.702, Loss_clf 0.280, Loss_fe 0.318, Loss_kd 0.920, Train_accy 76.93:  60%|██████    | 12/20 [07:00<04:21, 32.67s/it]
Task 1, Epoch 13/20 => Loss 1.702, Loss_clf 0.280, Loss_fe 0.318, Loss_kd 0.920, Train_accy 76.93:  65%|██████▌   | 13/20 [07:00<03:44, 32.04s/it]
Task 1, Epoch 14/20 => Loss 1.733, Loss_clf 0.285, Loss_fe 0.329, Loss_kd 0.932, Train_accy 75.98:  65%|██████▌   | 13/20 [07:31<03:44, 32.04s/it]
Task 1, Epoch 14/20 => Loss 1.733, Loss_clf 0.285, Loss_fe 0.329, Loss_kd 0.932, Train_accy 75.98:  70%|███████   | 14/20 [07:31<03:09, 31.58s/it]
Task 1, Epoch 15/20 => Loss 1.668, Loss_clf 0.264, Loss_fe 0.295, Loss_kd 0.924, Train_accy 76.46:  70%|███████   | 14/20 [08:01<03:09, 31.58s/it]
Task 1, Epoch 15/20 => Loss 1.668, Loss_clf 0.264, Loss_fe 0.295, Loss_kd 0.924, Train_accy 76.46:  75%|███████▌  | 15/20 [08:01<02:36, 31.26s/it]
Task 1, Epoch 16/20 => Loss 1.655, Loss_clf 0.275, Loss_fe 0.283, Loss_kd 0.914, Train_accy 76.63, Test_accy 85.03:  75%|███████▌  | 15/20 [08:40<02:36, 31.26s/it]
Task 1, Epoch 16/20 => Loss 1.655, Loss_clf 0.275, Loss_fe 0.283, Loss_kd 0.914, Train_accy 76.63, Test_accy 85.03:  80%|████████  | 16/20 [08:40<02:14, 33.55s/it]
Task 1, Epoch 17/20 => Loss 1.664, Loss_clf 0.279, Loss_fe 0.284, Loss_kd 0.917, Train_accy 76.36:  80%|████████  | 16/20 [09:11<02:14, 33.55s/it]                 
Task 1, Epoch 17/20 => Loss 1.664, Loss_clf 0.279, Loss_fe 0.284, Loss_kd 0.917, Train_accy 76.36:  85%|████████▌ | 17/20 [09:11<01:37, 32.63s/it]
Task 1, Epoch 18/20 => Loss 1.662, Loss_clf 0.272, Loss_fe 0.289, Loss_kd 0.918, Train_accy 76.22:  85%|████████▌ | 17/20 [09:41<01:37, 32.63s/it]
Task 1, Epoch 18/20 => Loss 1.662, Loss_clf 0.272, Loss_fe 0.289, Loss_kd 0.918, Train_accy 76.22:  90%|█████████ | 18/20 [09:41<01:03, 31.99s/it]
Task 1, Epoch 19/20 => Loss 1.618, Loss_clf 0.259, Loss_fe 0.271, Loss_kd 0.906, Train_accy 77.71:  90%|█████████ | 18/20 [10:12<01:03, 31.99s/it]
Task 1, Epoch 19/20 => Loss 1.618, Loss_clf 0.259, Loss_fe 0.271, Loss_kd 0.906, Train_accy 77.71:  95%|█████████▌| 19/20 [10:12<00:31, 31.54s/it]
Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68:  95%|█████████▌| 19/20 [10:42<00:31, 31.54s/it]
Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68: 100%|██████████| 20/20 [10:42<00:00, 31.22s/it]
Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68: 100%|██████████| 20/20 [10:42<00:00, 32.13s/it]
2024-09-05 15:01:48,651 [foster.py] => Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68
2024-09-05 15:01:48,652 [foster.py] => do not weight align teacher!
2024-09-05 15:01:48,655 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.221,  Train_accy 67.68, Test_accy 82.91:   0%|          | 0/20 [00:42<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.221,  Train_accy 67.68, Test_accy 82.91:   5%|▌         | 1/20 [00:42<13:36, 42.96s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.038,  Train_accy 72.32:   5%|▌         | 1/20 [01:21<13:36, 42.96s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.038,  Train_accy 72.32:  10%|█         | 2/20 [01:21<12:04, 40.24s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.025,  Train_accy 72.66:  10%|█         | 2/20 [01:59<12:04, 40.24s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.025,  Train_accy 72.66:  15%|█▌        | 3/20 [01:59<11:09, 39.37s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.039,  Train_accy 72.26:  15%|█▌        | 3/20 [02:37<11:09, 39.37s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.039,  Train_accy 72.26:  20%|██        | 4/20 [02:37<10:23, 38.96s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.039,  Train_accy 71.88:  20%|██        | 4/20 [03:16<10:23, 38.96s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.039,  Train_accy 71.88:  25%|██▌       | 5/20 [03:16<09:41, 38.74s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.002,  Train_accy 73.07, Test_accy 83.40:  25%|██▌       | 5/20 [03:59<09:41, 38.74s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.002,  Train_accy 73.07, Test_accy 83.40:  30%|███       | 6/20 [03:59<09:22, 40.17s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.030,  Train_accy 72.26:  30%|███       | 6/20 [04:37<09:22, 40.17s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.030,  Train_accy 72.26:  35%|███▌      | 7/20 [04:37<08:34, 39.56s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.005,  Train_accy 72.36:  35%|███▌      | 7/20 [05:15<08:34, 39.56s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.005,  Train_accy 72.36:  40%|████      | 8/20 [05:15<07:50, 39.18s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.018,  Train_accy 72.70:  40%|████      | 8/20 [05:54<07:50, 39.18s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.018,  Train_accy 72.70:  45%|████▌     | 9/20 [05:54<07:08, 38.92s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.037,  Train_accy 72.59:  45%|████▌     | 9/20 [06:32<07:08, 38.92s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.037,  Train_accy 72.59:  50%|█████     | 10/20 [06:32<06:27, 38.75s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.037,  Train_accy 72.46, Test_accy 83.76:  50%|█████     | 10/20 [07:15<06:27, 38.75s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.037,  Train_accy 72.46, Test_accy 83.76:  55%|█████▌    | 11/20 [07:15<06:00, 40.04s/it]
SNet: Task 1, Epoch 12/20 => Loss 0.999,  Train_accy 73.24:  55%|█████▌    | 11/20 [07:53<06:00, 40.04s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 0.999,  Train_accy 73.24:  60%|██████    | 12/20 [07:53<05:16, 39.52s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.028,  Train_accy 72.39:  60%|██████    | 12/20 [08:32<05:16, 39.52s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.028,  Train_accy 72.39:  65%|██████▌   | 13/20 [08:32<04:34, 39.18s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.019,  Train_accy 72.09:  65%|██████▌   | 13/20 [09:10<04:34, 39.18s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.019,  Train_accy 72.09:  70%|███████   | 14/20 [09:10<03:53, 38.94s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.004,  Train_accy 72.93:  70%|███████   | 14/20 [09:49<03:53, 38.94s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.004,  Train_accy 72.93:  75%|███████▌  | 15/20 [09:49<03:13, 38.75s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.025,  Train_accy 71.71, Test_accy 83.76:  75%|███████▌  | 15/20 [10:31<03:13, 38.75s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.025,  Train_accy 71.71, Test_accy 83.76:  80%|████████  | 16/20 [10:31<02:40, 40.01s/it]
SNet: Task 1, Epoch 17/20 => Loss 0.994,  Train_accy 73.64:  80%|████████  | 16/20 [11:10<02:40, 40.01s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 0.994,  Train_accy 73.64:  85%|████████▌ | 17/20 [11:10<01:58, 39.51s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.006,  Train_accy 73.41:  85%|████████▌ | 17/20 [11:48<01:58, 39.51s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.006,  Train_accy 73.41:  90%|█████████ | 18/20 [11:48<01:18, 39.15s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.978,  Train_accy 73.48:  90%|█████████ | 18/20 [12:26<01:18, 39.15s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.978,  Train_accy 73.48:  95%|█████████▌| 19/20 [12:26<00:38, 38.91s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07:  95%|█████████▌| 19/20 [13:05<00:38, 38.91s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07: 100%|██████████| 20/20 [13:05<00:00, 38.73s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07: 100%|██████████| 20/20 [13:05<00:00, 39.26s/it]
2024-09-05 15:14:55,563 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07
2024-09-05 15:14:55,564 [foster.py] => do not weight align student!
2024-09-05 15:15:00,173 [foster.py] => darknet eval: 
2024-09-05 15:15:00,174 [foster.py] => CNN top1 curve: 83.55
2024-09-05 15:15:00,174 [foster.py] => CNN top5 curve: 97.88
2024-09-05 15:15:00,177 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 15:16:17,866 [foster.py] => Exemplar size: 2400
2024-09-05 15:16:17,867 [trainer.py] => CNN: {'total': 84.89, '00-99': 91.67, '100-119': 49.56, 'old': 91.67, 'new': 49.56}
2024-09-05 15:16:17,867 [trainer.py] => NME: {'total': 90.18, '00-99': 90.15, '100-119': 90.35, 'old': 90.15, 'new': 90.35}
2024-09-05 15:16:17,867 [trainer.py] => CNN top1 curve: [92.0, 84.89]
2024-09-05 15:16:17,867 [trainer.py] => CNN top5 curve: [98.91, 98.02]
2024-09-05 15:16:17,867 [trainer.py] => NME top1 curve: [91.5, 90.18]
2024-09-05 15:16:17,867 [trainer.py] => NME top5 curve: [99.16, 98.73]

Average Accuracy (CNN): 88.44
Average Accuracy (NME): 90.84
2024-09-05 15:16:17,867 [trainer.py] => Average Accuracy (CNN): 88.44
2024-09-05 15:16:17,867 [trainer.py] => Average Accuracy (NME): 90.84
2024-09-05 15:16:17,868 [trainer.py] => All params: 171950932
2024-09-05 15:16:17,869 [trainer.py] => Trainable params: 86075376
2024-09-05 15:16:19,261 [foster.py] => Learning on 120-140
2024-09-05 15:16:19,263 [foster.py] => All params: 172012432
2024-09-05 15:16:19,264 [foster.py] => Trainable params: 86121496
2024-09-05 15:16:19,311 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.870, Loss_clf 1.266, Loss_fe 3.315, Loss_kd 1.105, Train_accy 69.02, Test_accy 80.80:   0%|          | 0/20 [00:43<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.870, Loss_clf 1.266, Loss_fe 3.315, Loss_kd 1.105, Train_accy 69.02, Test_accy 80.80:   5%|▌         | 1/20 [00:43<13:47, 43.57s/it]
Task 2, Epoch 2/20 => Loss 2.839, Loss_clf 0.627, Loss_fe 0.969, Loss_kd 1.065, Train_accy 72.69:   5%|▌         | 1/20 [01:17<13:47, 43.57s/it]                 
Task 2, Epoch 2/20 => Loss 2.839, Loss_clf 0.627, Loss_fe 0.969, Loss_kd 1.065, Train_accy 72.69:  10%|█         | 2/20 [01:17<11:26, 38.16s/it]
Task 2, Epoch 3/20 => Loss 2.532, Loss_clf 0.536, Loss_fe 0.743, Loss_kd 1.074, Train_accy 74.18:  10%|█         | 2/20 [01:52<11:26, 38.16s/it]
Task 2, Epoch 3/20 => Loss 2.532, Loss_clf 0.536, Loss_fe 0.743, Loss_kd 1.074, Train_accy 74.18:  15%|█▌        | 3/20 [01:52<10:19, 36.47s/it]
Task 2, Epoch 4/20 => Loss 2.370, Loss_clf 0.485, Loss_fe 0.644, Loss_kd 1.064, Train_accy 74.42:  15%|█▌        | 3/20 [02:26<10:19, 36.47s/it]
Task 2, Epoch 4/20 => Loss 2.370, Loss_clf 0.485, Loss_fe 0.644, Loss_kd 1.064, Train_accy 74.42:  20%|██        | 4/20 [02:26<09:31, 35.73s/it]
Task 2, Epoch 5/20 => Loss 2.366, Loss_clf 0.489, Loss_fe 0.608, Loss_kd 1.088, Train_accy 74.81:  20%|██        | 4/20 [03:01<09:31, 35.73s/it]
Task 2, Epoch 5/20 => Loss 2.366, Loss_clf 0.489, Loss_fe 0.608, Loss_kd 1.088, Train_accy 74.81:  25%|██▌       | 5/20 [03:01<08:50, 35.34s/it]
Task 2, Epoch 6/20 => Loss 2.204, Loss_clf 0.428, Loss_fe 0.517, Loss_kd 1.079, Train_accy 76.18, Test_accy 83.30:  25%|██▌       | 5/20 [03:45<08:50, 35.34s/it]
Task 2, Epoch 6/20 => Loss 2.204, Loss_clf 0.428, Loss_fe 0.517, Loss_kd 1.079, Train_accy 76.18, Test_accy 83.30:  30%|███       | 6/20 [03:45<08:57, 38.38s/it]
Task 2, Epoch 7/20 => Loss 2.089, Loss_clf 0.404, Loss_fe 0.451, Loss_kd 1.057, Train_accy 76.71:  30%|███       | 6/20 [04:20<08:57, 38.38s/it]                 
Task 2, Epoch 7/20 => Loss 2.089, Loss_clf 0.404, Loss_fe 0.451, Loss_kd 1.057, Train_accy 76.71:  35%|███▌      | 7/20 [04:20<08:03, 37.17s/it]
Task 2, Epoch 8/20 => Loss 2.194, Loss_clf 0.436, Loss_fe 0.476, Loss_kd 1.098, Train_accy 75.10:  35%|███▌      | 7/20 [04:55<08:03, 37.17s/it]
Task 2, Epoch 8/20 => Loss 2.194, Loss_clf 0.436, Loss_fe 0.476, Loss_kd 1.098, Train_accy 75.10:  40%|████      | 8/20 [04:55<07:16, 36.37s/it]
Task 2, Epoch 9/20 => Loss 2.044, Loss_clf 0.372, Loss_fe 0.419, Loss_kd 1.073, Train_accy 76.48:  40%|████      | 8/20 [05:29<07:16, 36.37s/it]
Task 2, Epoch 9/20 => Loss 2.044, Loss_clf 0.372, Loss_fe 0.419, Loss_kd 1.073, Train_accy 76.48:  45%|████▌     | 9/20 [05:29<06:34, 35.83s/it]
Task 2, Epoch 10/20 => Loss 2.024, Loss_clf 0.385, Loss_fe 0.392, Loss_kd 1.069, Train_accy 76.62:  45%|████▌     | 9/20 [06:04<06:34, 35.83s/it]
Task 2, Epoch 10/20 => Loss 2.024, Loss_clf 0.385, Loss_fe 0.392, Loss_kd 1.069, Train_accy 76.62:  50%|█████     | 10/20 [06:04<05:54, 35.45s/it]
Task 2, Epoch 11/20 => Loss 1.946, Loss_clf 0.335, Loss_fe 0.370, Loss_kd 1.064, Train_accy 77.40, Test_accy 83.06:  50%|█████     | 10/20 [06:48<05:54, 35.45s/it]
Task 2, Epoch 11/20 => Loss 1.946, Loss_clf 0.335, Loss_fe 0.370, Loss_kd 1.064, Train_accy 77.40, Test_accy 83.06:  55%|█████▌    | 11/20 [06:48<05:43, 38.17s/it]
Task 2, Epoch 12/20 => Loss 1.913, Loss_clf 0.341, Loss_fe 0.339, Loss_kd 1.057, Train_accy 77.79:  55%|█████▌    | 11/20 [07:23<05:43, 38.17s/it]                 
Task 2, Epoch 12/20 => Loss 1.913, Loss_clf 0.341, Loss_fe 0.339, Loss_kd 1.057, Train_accy 77.79:  60%|██████    | 12/20 [07:23<04:56, 37.09s/it]
Task 2, Epoch 13/20 => Loss 1.885, Loss_clf 0.332, Loss_fe 0.319, Loss_kd 1.058, Train_accy 77.19:  60%|██████    | 12/20 [07:58<04:56, 37.09s/it]
Task 2, Epoch 13/20 => Loss 1.885, Loss_clf 0.332, Loss_fe 0.319, Loss_kd 1.058, Train_accy 77.19:  65%|██████▌   | 13/20 [07:58<04:14, 36.36s/it]
Task 2, Epoch 14/20 => Loss 1.941, Loss_clf 0.338, Loss_fe 0.350, Loss_kd 1.074, Train_accy 78.29:  65%|██████▌   | 13/20 [08:32<04:14, 36.36s/it]
Task 2, Epoch 14/20 => Loss 1.941, Loss_clf 0.338, Loss_fe 0.350, Loss_kd 1.074, Train_accy 78.29:  70%|███████   | 14/20 [08:32<03:35, 35.88s/it]
Task 2, Epoch 15/20 => Loss 1.945, Loss_clf 0.356, Loss_fe 0.341, Loss_kd 1.070, Train_accy 76.95:  70%|███████   | 14/20 [09:07<03:35, 35.88s/it]
Task 2, Epoch 15/20 => Loss 1.945, Loss_clf 0.356, Loss_fe 0.341, Loss_kd 1.070, Train_accy 76.95:  75%|███████▌  | 15/20 [09:07<02:57, 35.51s/it]
Task 2, Epoch 16/20 => Loss 1.854, Loss_clf 0.321, Loss_fe 0.302, Loss_kd 1.055, Train_accy 77.55, Test_accy 82.88:  75%|███████▌  | 15/20 [09:51<02:57, 35.51s/it]
Task 2, Epoch 16/20 => Loss 1.854, Loss_clf 0.321, Loss_fe 0.302, Loss_kd 1.055, Train_accy 77.55, Test_accy 82.88:  80%|████████  | 16/20 [09:51<02:32, 38.17s/it]
Task 2, Epoch 17/20 => Loss 1.868, Loss_clf 0.321, Loss_fe 0.307, Loss_kd 1.063, Train_accy 78.71:  80%|████████  | 16/20 [10:26<02:32, 38.17s/it]                 
Task 2, Epoch 17/20 => Loss 1.868, Loss_clf 0.321, Loss_fe 0.307, Loss_kd 1.063, Train_accy 78.71:  85%|████████▌ | 17/20 [10:26<01:51, 37.11s/it]
Task 2, Epoch 18/20 => Loss 2.010, Loss_clf 0.369, Loss_fe 0.342, Loss_kd 1.114, Train_accy 78.12:  85%|████████▌ | 17/20 [11:01<01:51, 37.11s/it]
Task 2, Epoch 18/20 => Loss 2.010, Loss_clf 0.369, Loss_fe 0.342, Loss_kd 1.114, Train_accy 78.12:  90%|█████████ | 18/20 [11:01<01:12, 36.37s/it]
Task 2, Epoch 19/20 => Loss 1.874, Loss_clf 0.326, Loss_fe 0.308, Loss_kd 1.064, Train_accy 78.38:  90%|█████████ | 18/20 [11:35<01:12, 36.37s/it]
Task 2, Epoch 19/20 => Loss 1.874, Loss_clf 0.326, Loss_fe 0.308, Loss_kd 1.064, Train_accy 78.38:  95%|█████████▌| 19/20 [11:35<00:35, 35.87s/it]
Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89:  95%|█████████▌| 19/20 [12:10<00:35, 35.87s/it]
Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89: 100%|██████████| 20/20 [12:10<00:00, 35.51s/it]
Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89: 100%|██████████| 20/20 [12:10<00:00, 36.53s/it]
2024-09-05 15:28:29,920 [foster.py] => Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89
2024-09-05 15:28:29,921 [foster.py] => do not weight align teacher!
2024-09-05 15:28:29,926 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.342,  Train_accy 66.52, Test_accy 82.08:   0%|          | 0/20 [00:48<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.342,  Train_accy 66.52, Test_accy 82.08:   5%|▌         | 1/20 [00:48<15:25, 48.73s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.169,  Train_accy 72.66:   5%|▌         | 1/20 [01:32<15:25, 48.73s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.169,  Train_accy 72.66:  10%|█         | 2/20 [01:32<13:42, 45.67s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.158,  Train_accy 73.23:  10%|█         | 2/20 [02:15<13:42, 45.67s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.158,  Train_accy 73.23:  15%|█▌        | 3/20 [02:15<12:40, 44.71s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.163,  Train_accy 73.11:  15%|█▌        | 3/20 [02:59<12:40, 44.71s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.163,  Train_accy 73.11:  20%|██        | 4/20 [02:59<11:48, 44.26s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.149,  Train_accy 73.46:  20%|██        | 4/20 [03:42<11:48, 44.26s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.149,  Train_accy 73.46:  25%|██▌       | 5/20 [03:42<11:00, 44.01s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.166,  Train_accy 73.94, Test_accy 82.45:  25%|██▌       | 5/20 [04:31<11:00, 44.01s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.166,  Train_accy 73.94, Test_accy 82.45:  30%|███       | 6/20 [04:31<10:39, 45.64s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.180,  Train_accy 73.76:  30%|███       | 6/20 [05:15<10:39, 45.64s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.180,  Train_accy 73.76:  35%|███▌      | 7/20 [05:15<09:44, 44.96s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.150,  Train_accy 73.67:  35%|███▌      | 7/20 [05:58<09:44, 44.96s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.150,  Train_accy 73.67:  40%|████      | 8/20 [05:58<08:54, 44.53s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.148,  Train_accy 73.23:  40%|████      | 8/20 [06:42<08:54, 44.53s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.148,  Train_accy 73.23:  45%|████▌     | 9/20 [06:42<08:06, 44.21s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.133,  Train_accy 74.75:  45%|████▌     | 9/20 [07:25<08:06, 44.21s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.133,  Train_accy 74.75:  50%|█████     | 10/20 [07:25<07:20, 44.00s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.111,  Train_accy 75.07, Test_accy 82.69:  50%|█████     | 10/20 [08:14<07:20, 44.00s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.111,  Train_accy 75.07, Test_accy 82.69:  55%|█████▌    | 11/20 [08:14<06:49, 45.45s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.156,  Train_accy 74.90:  55%|█████▌    | 11/20 [08:58<06:49, 45.45s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.156,  Train_accy 74.90:  60%|██████    | 12/20 [08:58<05:59, 44.88s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.135,  Train_accy 74.30:  60%|██████    | 12/20 [09:41<05:59, 44.88s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.135,  Train_accy 74.30:  65%|██████▌   | 13/20 [09:41<05:11, 44.49s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.095,  Train_accy 74.96:  65%|██████▌   | 13/20 [10:25<05:11, 44.49s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.095,  Train_accy 74.96:  70%|███████   | 14/20 [10:25<04:25, 44.20s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.124,  Train_accy 74.21:  70%|███████   | 14/20 [11:09<04:25, 44.20s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.124,  Train_accy 74.21:  75%|███████▌  | 15/20 [11:09<03:40, 44.02s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.114,  Train_accy 74.81, Test_accy 82.21:  75%|███████▌  | 15/20 [11:57<03:40, 44.02s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.114,  Train_accy 74.81, Test_accy 82.21:  80%|████████  | 16/20 [11:57<03:01, 45.46s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.155,  Train_accy 73.49:  80%|████████  | 16/20 [12:41<03:01, 45.46s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.155,  Train_accy 73.49:  85%|████████▌ | 17/20 [12:41<02:14, 44.88s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.121,  Train_accy 74.48:  85%|████████▌ | 17/20 [13:24<02:14, 44.88s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.121,  Train_accy 74.48:  90%|█████████ | 18/20 [13:24<01:28, 44.50s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.154,  Train_accy 73.91:  90%|█████████ | 18/20 [14:08<01:28, 44.50s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.154,  Train_accy 73.91:  95%|█████████▌| 19/20 [14:08<00:44, 44.22s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07:  95%|█████████▌| 19/20 [14:52<00:44, 44.22s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07: 100%|██████████| 20/20 [14:52<00:00, 44.01s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07: 100%|██████████| 20/20 [14:52<00:00, 44.60s/it]
2024-09-05 15:43:23,433 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07
2024-09-05 15:43:23,433 [foster.py] => do not weight align student!
2024-09-05 15:43:28,671 [foster.py] => darknet eval: 
2024-09-05 15:43:28,671 [foster.py] => CNN top1 curve: 82.57
2024-09-05 15:43:28,671 [foster.py] => CNN top5 curve: 97.93
2024-09-05 15:43:28,673 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 15:44:59,784 [foster.py] => Exemplar size: 2800
2024-09-05 15:44:59,784 [trainer.py] => CNN: {'total': 82.69, '00-99': 92.09, '100-119': 69.74, '120-139': 46.22, 'old': 88.49, 'new': 46.22}
2024-09-05 15:44:59,784 [trainer.py] => NME: {'total': 88.67, '00-99': 89.23, '100-119': 88.6, '120-139': 85.78, 'old': 89.12, 'new': 85.78}
2024-09-05 15:44:59,785 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69]
2024-09-05 15:44:59,785 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05]
2024-09-05 15:44:59,785 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67]
2024-09-05 15:44:59,785 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72]

Average Accuracy (CNN): 86.53
Average Accuracy (NME): 90.12
2024-09-05 15:44:59,785 [trainer.py] => Average Accuracy (CNN): 86.53
2024-09-05 15:44:59,785 [trainer.py] => Average Accuracy (NME): 90.12
2024-09-05 15:44:59,786 [trainer.py] => All params: 172012432
2024-09-05 15:44:59,787 [trainer.py] => Trainable params: 86121496
2024-09-05 15:45:01,273 [foster.py] => Learning on 140-160
2024-09-05 15:45:01,275 [foster.py] => All params: 172073932
2024-09-05 15:45:01,276 [foster.py] => Trainable params: 86167616
2024-09-05 15:45:01,325 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.979, Loss_clf 1.208, Loss_fe 3.400, Loss_kd 1.200, Train_accy 69.73, Test_accy 76.89:   0%|          | 0/20 [00:48<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.979, Loss_clf 1.208, Loss_fe 3.400, Loss_kd 1.200, Train_accy 69.73, Test_accy 76.89:   5%|▌         | 1/20 [00:48<15:24, 48.67s/it]
Task 3, Epoch 2/20 => Loss 3.176, Loss_clf 0.681, Loss_fe 1.097, Loss_kd 1.223, Train_accy 71.26:   5%|▌         | 1/20 [01:26<15:24, 48.67s/it]                 
Task 3, Epoch 2/20 => Loss 3.176, Loss_clf 0.681, Loss_fe 1.097, Loss_kd 1.223, Train_accy 71.26:  10%|█         | 2/20 [01:26<12:44, 42.45s/it]
Task 3, Epoch 3/20 => Loss 2.740, Loss_clf 0.567, Loss_fe 0.813, Loss_kd 1.190, Train_accy 72.58:  10%|█         | 2/20 [02:05<12:44, 42.45s/it]
Task 3, Epoch 3/20 => Loss 2.740, Loss_clf 0.567, Loss_fe 0.813, Loss_kd 1.190, Train_accy 72.58:  15%|█▌        | 3/20 [02:05<11:28, 40.53s/it]
Task 3, Epoch 4/20 => Loss 2.632, Loss_clf 0.547, Loss_fe 0.710, Loss_kd 1.203, Train_accy 73.39:  15%|█▌        | 3/20 [02:43<11:28, 40.53s/it]
Task 3, Epoch 4/20 => Loss 2.632, Loss_clf 0.547, Loss_fe 0.710, Loss_kd 1.203, Train_accy 73.39:  20%|██        | 4/20 [02:43<10:34, 39.66s/it]
Task 3, Epoch 5/20 => Loss 2.459, Loss_clf 0.476, Loss_fe 0.618, Loss_kd 1.194, Train_accy 73.71:  20%|██        | 4/20 [03:21<10:34, 39.66s/it]
Task 3, Epoch 5/20 => Loss 2.459, Loss_clf 0.476, Loss_fe 0.618, Loss_kd 1.194, Train_accy 73.71:  25%|██▌       | 5/20 [03:21<09:47, 39.18s/it]
Task 3, Epoch 6/20 => Loss 2.506, Loss_clf 0.514, Loss_fe 0.594, Loss_kd 1.223, Train_accy 73.84, Test_accy 79.32:  25%|██▌       | 5/20 [04:11<09:47, 39.18s/it]
Task 3, Epoch 6/20 => Loss 2.506, Loss_clf 0.514, Loss_fe 0.594, Loss_kd 1.223, Train_accy 73.84, Test_accy 79.32:  30%|███       | 6/20 [04:11<09:57, 42.67s/it]
Task 3, Epoch 7/20 => Loss 2.332, Loss_clf 0.450, Loss_fe 0.512, Loss_kd 1.199, Train_accy 75.35:  30%|███       | 6/20 [04:49<09:57, 42.67s/it]                 
Task 3, Epoch 7/20 => Loss 2.332, Loss_clf 0.450, Loss_fe 0.512, Loss_kd 1.199, Train_accy 75.35:  35%|███▌      | 7/20 [04:49<08:56, 41.27s/it]
Task 3, Epoch 8/20 => Loss 2.286, Loss_clf 0.443, Loss_fe 0.477, Loss_kd 1.195, Train_accy 75.32:  35%|███▌      | 7/20 [05:27<08:56, 41.27s/it]
Task 3, Epoch 8/20 => Loss 2.286, Loss_clf 0.443, Loss_fe 0.477, Loss_kd 1.195, Train_accy 75.32:  40%|████      | 8/20 [05:27<08:04, 40.35s/it]
Task 3, Epoch 9/20 => Loss 2.206, Loss_clf 0.405, Loss_fe 0.444, Loss_kd 1.188, Train_accy 75.56:  40%|████      | 8/20 [06:06<08:04, 40.35s/it]
Task 3, Epoch 9/20 => Loss 2.206, Loss_clf 0.405, Loss_fe 0.444, Loss_kd 1.188, Train_accy 75.56:  45%|████▌     | 9/20 [06:06<07:17, 39.76s/it]
Task 3, Epoch 10/20 => Loss 2.169, Loss_clf 0.407, Loss_fe 0.412, Loss_kd 1.182, Train_accy 76.02:  45%|████▌     | 9/20 [06:44<07:17, 39.76s/it]
Task 3, Epoch 10/20 => Loss 2.169, Loss_clf 0.407, Loss_fe 0.412, Loss_kd 1.182, Train_accy 76.02:  50%|█████     | 10/20 [06:44<06:33, 39.35s/it]
Task 3, Epoch 11/20 => Loss 2.066, Loss_clf 0.366, Loss_fe 0.371, Loss_kd 1.163, Train_accy 75.97, Test_accy 80.65:  50%|█████     | 10/20 [07:34<06:33, 39.35s/it]
Task 3, Epoch 11/20 => Loss 2.066, Loss_clf 0.366, Loss_fe 0.371, Loss_kd 1.163, Train_accy 75.97, Test_accy 80.65:  55%|█████▌    | 11/20 [07:34<06:22, 42.47s/it]
Task 3, Epoch 12/20 => Loss 2.091, Loss_clf 0.377, Loss_fe 0.367, Loss_kd 1.179, Train_accy 76.80:  55%|█████▌    | 11/20 [08:12<06:22, 42.47s/it]                 
Task 3, Epoch 12/20 => Loss 2.091, Loss_clf 0.377, Loss_fe 0.367, Loss_kd 1.179, Train_accy 76.80:  60%|██████    | 12/20 [08:12<05:29, 41.24s/it]
Task 3, Epoch 13/20 => Loss 2.179, Loss_clf 0.397, Loss_fe 0.399, Loss_kd 1.210, Train_accy 76.80:  60%|██████    | 12/20 [08:51<05:29, 41.24s/it]
Task 3, Epoch 13/20 => Loss 2.179, Loss_clf 0.397, Loss_fe 0.399, Loss_kd 1.210, Train_accy 76.80:  65%|██████▌   | 13/20 [08:51<04:42, 40.40s/it]
Task 3, Epoch 14/20 => Loss 1.919, Loss_clf 0.318, Loss_fe 0.296, Loss_kd 1.143, Train_accy 77.80:  65%|██████▌   | 13/20 [09:29<04:42, 40.40s/it]
Task 3, Epoch 14/20 => Loss 1.919, Loss_clf 0.318, Loss_fe 0.296, Loss_kd 1.143, Train_accy 77.80:  70%|███████   | 14/20 [09:29<03:58, 39.80s/it]
Task 3, Epoch 15/20 => Loss 2.060, Loss_clf 0.367, Loss_fe 0.326, Loss_kd 1.196, Train_accy 77.23:  70%|███████   | 14/20 [10:08<03:58, 39.80s/it]
Task 3, Epoch 15/20 => Loss 2.060, Loss_clf 0.367, Loss_fe 0.326, Loss_kd 1.196, Train_accy 77.23:  75%|███████▌  | 15/20 [10:08<03:16, 39.39s/it]
Task 3, Epoch 16/20 => Loss 2.053, Loss_clf 0.358, Loss_fe 0.333, Loss_kd 1.192, Train_accy 76.83, Test_accy 79.75:  75%|███████▌  | 15/20 [10:57<03:16, 39.39s/it]
Task 3, Epoch 16/20 => Loss 2.053, Loss_clf 0.358, Loss_fe 0.333, Loss_kd 1.192, Train_accy 76.83, Test_accy 79.75:  80%|████████  | 16/20 [10:57<02:49, 42.42s/it]
Task 3, Epoch 17/20 => Loss 2.062, Loss_clf 0.365, Loss_fe 0.324, Loss_kd 1.201, Train_accy 76.53:  80%|████████  | 16/20 [11:35<02:49, 42.42s/it]                 
Task 3, Epoch 17/20 => Loss 2.062, Loss_clf 0.365, Loss_fe 0.324, Loss_kd 1.201, Train_accy 76.53:  85%|████████▌ | 17/20 [11:35<02:03, 41.23s/it]
Task 3, Epoch 18/20 => Loss 2.079, Loss_clf 0.377, Loss_fe 0.346, Loss_kd 1.187, Train_accy 76.21:  85%|████████▌ | 17/20 [12:14<02:03, 41.23s/it]
Task 3, Epoch 18/20 => Loss 2.079, Loss_clf 0.377, Loss_fe 0.346, Loss_kd 1.187, Train_accy 76.21:  90%|█████████ | 18/20 [12:14<01:20, 40.39s/it]
Task 3, Epoch 19/20 => Loss 2.088, Loss_clf 0.392, Loss_fe 0.344, Loss_kd 1.183, Train_accy 75.94:  90%|█████████ | 18/20 [12:52<01:20, 40.39s/it]
Task 3, Epoch 19/20 => Loss 2.088, Loss_clf 0.392, Loss_fe 0.344, Loss_kd 1.183, Train_accy 75.94:  95%|█████████▌| 19/20 [12:52<00:39, 39.81s/it]
Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94:  95%|█████████▌| 19/20 [13:31<00:39, 39.81s/it]
Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94: 100%|██████████| 20/20 [13:31<00:00, 39.41s/it]
Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94: 100%|██████████| 20/20 [13:31<00:00, 40.57s/it]
2024-09-05 15:58:32,689 [foster.py] => Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94
2024-09-05 15:58:32,691 [foster.py] => do not weight align teacher!
2024-09-05 15:58:32,695 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.449,  Train_accy 66.75, Test_accy 78.16:   0%|          | 0/20 [00:54<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.449,  Train_accy 66.75, Test_accy 78.16:   5%|▌         | 1/20 [00:54<17:10, 54.26s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.309,  Train_accy 71.13:   5%|▌         | 1/20 [01:42<17:10, 54.26s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.309,  Train_accy 71.13:  10%|█         | 2/20 [01:42<15:13, 50.76s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.261,  Train_accy 72.88:  10%|█         | 2/20 [02:30<15:13, 50.76s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.261,  Train_accy 72.88:  15%|█▌        | 3/20 [02:30<14:03, 49.62s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.264,  Train_accy 72.47:  15%|█▌        | 3/20 [03:19<14:03, 49.62s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.264,  Train_accy 72.47:  20%|██        | 4/20 [03:19<13:05, 49.10s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.292,  Train_accy 72.15:  20%|██        | 4/20 [04:07<13:05, 49.10s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.292,  Train_accy 72.15:  25%|██▌       | 5/20 [04:07<12:12, 48.82s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.250,  Train_accy 72.66, Test_accy 78.90:  25%|██▌       | 5/20 [05:01<12:12, 48.82s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.250,  Train_accy 72.66, Test_accy 78.90:  30%|███       | 6/20 [05:01<11:49, 50.69s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.264,  Train_accy 72.90:  30%|███       | 6/20 [05:50<11:49, 50.69s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.264,  Train_accy 72.90:  35%|███▌      | 7/20 [05:50<10:48, 49.91s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.266,  Train_accy 71.83:  35%|███▌      | 7/20 [06:38<10:48, 49.91s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.266,  Train_accy 71.83:  40%|████      | 8/20 [06:38<09:52, 49.39s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.267,  Train_accy 72.55:  40%|████      | 8/20 [07:26<09:52, 49.39s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.267,  Train_accy 72.55:  45%|████▌     | 9/20 [07:26<08:59, 49.05s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.246,  Train_accy 73.04:  45%|████▌     | 9/20 [08:14<08:59, 49.05s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.246,  Train_accy 73.04:  50%|█████     | 10/20 [08:14<08:08, 48.80s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.280,  Train_accy 72.37, Test_accy 78.90:  50%|█████     | 10/20 [09:09<08:08, 48.80s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.280,  Train_accy 72.37, Test_accy 78.90:  55%|█████▌    | 11/20 [09:09<07:34, 50.47s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.246,  Train_accy 73.58:  55%|█████▌    | 11/20 [09:57<07:34, 50.47s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.246,  Train_accy 73.58:  60%|██████    | 12/20 [09:57<06:38, 49.80s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.247,  Train_accy 73.52:  60%|██████    | 12/20 [10:45<06:38, 49.80s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.247,  Train_accy 73.52:  65%|██████▌   | 13/20 [10:45<05:45, 49.34s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.231,  Train_accy 73.39:  65%|██████▌   | 13/20 [11:33<05:45, 49.34s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.231,  Train_accy 73.39:  70%|███████   | 14/20 [11:33<04:54, 49.02s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.210,  Train_accy 73.95:  70%|███████   | 14/20 [12:22<04:54, 49.02s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.210,  Train_accy 73.95:  75%|███████▌  | 15/20 [12:22<04:04, 48.81s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.224,  Train_accy 73.66, Test_accy 78.95:  75%|███████▌  | 15/20 [13:16<04:04, 48.81s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.224,  Train_accy 73.66, Test_accy 78.95:  80%|████████  | 16/20 [13:16<03:21, 50.45s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.240,  Train_accy 74.22:  80%|████████  | 16/20 [14:04<03:21, 50.45s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.240,  Train_accy 74.22:  85%|████████▌ | 17/20 [14:04<02:29, 49.80s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.243,  Train_accy 73.79:  85%|████████▌ | 17/20 [14:53<02:29, 49.80s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.243,  Train_accy 73.79:  90%|█████████ | 18/20 [14:53<01:38, 49.33s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.249,  Train_accy 73.58:  90%|█████████ | 18/20 [15:41<01:38, 49.33s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.249,  Train_accy 73.58:  95%|█████████▌| 19/20 [15:41<00:49, 49.02s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70:  95%|█████████▌| 19/20 [16:29<00:49, 49.02s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70: 100%|██████████| 20/20 [16:29<00:00, 48.80s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70: 100%|██████████| 20/20 [16:29<00:00, 49.48s/it]
2024-09-05 16:15:03,907 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70
2024-09-05 16:15:03,908 [foster.py] => do not weight align student!
2024-09-05 16:15:09,894 [foster.py] => darknet eval: 
2024-09-05 16:15:09,894 [foster.py] => CNN top1 curve: 78.95
2024-09-05 16:15:09,894 [foster.py] => CNN top5 curve: 97.3
2024-09-05 16:15:09,897 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 16:16:54,910 [foster.py] => Exemplar size: 3200
2024-09-05 16:16:54,910 [trainer.py] => CNN: {'total': 79.69, '00-99': 90.99, '100-119': 80.7, '120-139': 67.11, '140-159': 36.4, 'old': 86.29, 'new': 36.4}
2024-09-05 16:16:54,910 [trainer.py] => NME: {'total': 88.05, '00-99': 87.88, '100-119': 87.72, '120-139': 86.22, '140-159': 90.8, 'old': 87.63, 'new': 90.8}
2024-09-05 16:16:54,910 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69, 79.69]
2024-09-05 16:16:54,910 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05, 97.62]
2024-09-05 16:16:54,910 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67, 88.05]
2024-09-05 16:16:54,911 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72, 98.78]

Average Accuracy (CNN): 84.82
Average Accuracy (NME): 89.6
2024-09-05 16:16:54,911 [trainer.py] => Average Accuracy (CNN): 84.82
2024-09-05 16:16:54,911 [trainer.py] => Average Accuracy (NME): 89.6
2024-09-05 16:16:54,912 [trainer.py] => All params: 172073932
2024-09-05 16:16:54,913 [trainer.py] => Trainable params: 86167616
2024-09-05 16:16:56,384 [foster.py] => Learning on 160-180
2024-09-05 16:16:56,386 [foster.py] => All params: 172135432
2024-09-05 16:16:56,387 [foster.py] => Trainable params: 86213736
2024-09-05 16:16:56,435 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 6.110, Loss_clf 1.174, Loss_fe 3.456, Loss_kd 1.315, Train_accy 69.24, Test_accy 78.52:   0%|          | 0/20 [00:54<?, ?it/s]
Task 4, Epoch 1/20 => Loss 6.110, Loss_clf 1.174, Loss_fe 3.456, Loss_kd 1.315, Train_accy 69.24, Test_accy 78.52:   5%|▌         | 1/20 [00:54<17:11, 54.28s/it]
Task 4, Epoch 2/20 => Loss 3.272, Loss_clf 0.665, Loss_fe 1.151, Loss_kd 1.294, Train_accy 73.04:   5%|▌         | 1/20 [01:36<17:11, 54.28s/it]                 
Task 4, Epoch 2/20 => Loss 3.272, Loss_clf 0.665, Loss_fe 1.151, Loss_kd 1.294, Train_accy 73.04:  10%|█         | 2/20 [01:36<14:12, 47.36s/it]
Task 4, Epoch 3/20 => Loss 2.963, Loss_clf 0.625, Loss_fe 0.876, Loss_kd 1.300, Train_accy 73.45:  10%|█         | 2/20 [02:19<14:12, 47.36s/it]
Task 4, Epoch 3/20 => Loss 2.963, Loss_clf 0.625, Loss_fe 0.876, Loss_kd 1.300, Train_accy 73.45:  15%|█▌        | 3/20 [02:19<12:48, 45.21s/it]
Task 4, Epoch 4/20 => Loss 2.753, Loss_clf 0.551, Loss_fe 0.737, Loss_kd 1.303, Train_accy 74.94:  15%|█▌        | 3/20 [03:02<12:48, 45.21s/it]
Task 4, Epoch 4/20 => Loss 2.753, Loss_clf 0.551, Loss_fe 0.737, Loss_kd 1.303, Train_accy 74.94:  20%|██        | 4/20 [03:02<11:47, 44.23s/it]
Task 4, Epoch 5/20 => Loss 2.627, Loss_clf 0.517, Loss_fe 0.661, Loss_kd 1.289, Train_accy 75.20:  20%|██        | 4/20 [03:44<11:47, 44.23s/it]
Task 4, Epoch 5/20 => Loss 2.627, Loss_clf 0.517, Loss_fe 0.661, Loss_kd 1.289, Train_accy 75.20:  25%|██▌       | 5/20 [03:44<10:55, 43.72s/it]
Task 4, Epoch 6/20 => Loss 2.564, Loss_clf 0.500, Loss_fe 0.607, Loss_kd 1.295, Train_accy 75.28, Test_accy 80.03:  25%|██▌       | 5/20 [04:40<10:55, 43.72s/it]
Task 4, Epoch 6/20 => Loss 2.564, Loss_clf 0.500, Loss_fe 0.607, Loss_kd 1.295, Train_accy 75.28, Test_accy 80.03:  30%|███       | 6/20 [04:40<11:06, 47.61s/it]
Task 4, Epoch 7/20 => Loss 2.466, Loss_clf 0.487, Loss_fe 0.553, Loss_kd 1.268, Train_accy 76.29:  30%|███       | 6/20 [05:23<11:06, 47.61s/it]                 
Task 4, Epoch 7/20 => Loss 2.466, Loss_clf 0.487, Loss_fe 0.553, Loss_kd 1.268, Train_accy 76.29:  35%|███▌      | 7/20 [05:23<09:58, 46.06s/it]
Task 4, Epoch 8/20 => Loss 2.340, Loss_clf 0.436, Loss_fe 0.484, Loss_kd 1.262, Train_accy 76.19:  35%|███▌      | 7/20 [06:05<09:58, 46.06s/it]
Task 4, Epoch 8/20 => Loss 2.340, Loss_clf 0.436, Loss_fe 0.484, Loss_kd 1.262, Train_accy 76.19:  40%|████      | 8/20 [06:05<09:00, 45.04s/it]
Task 4, Epoch 9/20 => Loss 2.346, Loss_clf 0.446, Loss_fe 0.477, Loss_kd 1.265, Train_accy 76.29:  40%|████      | 8/20 [06:48<09:00, 45.04s/it]
Task 4, Epoch 9/20 => Loss 2.346, Loss_clf 0.446, Loss_fe 0.477, Loss_kd 1.265, Train_accy 76.29:  45%|████▌     | 9/20 [06:48<08:07, 44.36s/it]
Task 4, Epoch 10/20 => Loss 2.310, Loss_clf 0.436, Loss_fe 0.446, Loss_kd 1.270, Train_accy 75.78:  45%|████▌     | 9/20 [07:31<08:07, 44.36s/it]
Task 4, Epoch 10/20 => Loss 2.310, Loss_clf 0.436, Loss_fe 0.446, Loss_kd 1.270, Train_accy 75.78:  50%|█████     | 10/20 [07:31<07:19, 43.90s/it]
Task 4, Epoch 11/20 => Loss 2.290, Loss_clf 0.420, Loss_fe 0.426, Loss_kd 1.284, Train_accy 76.21, Test_accy 79.75:  50%|█████     | 10/20 [08:26<07:19, 43.90s/it]
Task 4, Epoch 11/20 => Loss 2.290, Loss_clf 0.420, Loss_fe 0.426, Loss_kd 1.284, Train_accy 76.21, Test_accy 79.75:  55%|█████▌    | 11/20 [08:26<07:06, 47.39s/it]
Task 4, Epoch 12/20 => Loss 2.288, Loss_clf 0.428, Loss_fe 0.425, Loss_kd 1.276, Train_accy 75.78:  55%|█████▌    | 11/20 [09:09<07:06, 47.39s/it]                 
Task 4, Epoch 12/20 => Loss 2.288, Loss_clf 0.428, Loss_fe 0.425, Loss_kd 1.276, Train_accy 75.78:  60%|██████    | 12/20 [09:09<06:08, 46.05s/it]
Task 4, Epoch 13/20 => Loss 2.161, Loss_clf 0.373, Loss_fe 0.371, Loss_kd 1.259, Train_accy 76.67:  60%|██████    | 12/20 [09:52<06:08, 46.05s/it]
Task 4, Epoch 13/20 => Loss 2.161, Loss_clf 0.373, Loss_fe 0.371, Loss_kd 1.259, Train_accy 76.67:  65%|██████▌   | 13/20 [09:52<05:15, 45.10s/it]
Task 4, Epoch 14/20 => Loss 2.236, Loss_clf 0.403, Loss_fe 0.381, Loss_kd 1.291, Train_accy 76.86:  65%|██████▌   | 13/20 [10:35<05:15, 45.10s/it]
Task 4, Epoch 14/20 => Loss 2.236, Loss_clf 0.403, Loss_fe 0.381, Loss_kd 1.291, Train_accy 76.86:  70%|███████   | 14/20 [10:35<04:26, 44.44s/it]
Task 4, Epoch 15/20 => Loss 2.234, Loss_clf 0.405, Loss_fe 0.385, Loss_kd 1.284, Train_accy 76.91:  70%|███████   | 14/20 [11:18<04:26, 44.44s/it]
Task 4, Epoch 15/20 => Loss 2.234, Loss_clf 0.405, Loss_fe 0.385, Loss_kd 1.284, Train_accy 76.91:  75%|███████▌  | 15/20 [11:18<03:39, 43.98s/it]
Task 4, Epoch 16/20 => Loss 2.187, Loss_clf 0.383, Loss_fe 0.352, Loss_kd 1.291, Train_accy 77.34, Test_accy 79.89:  75%|███████▌  | 15/20 [12:13<03:39, 43.98s/it]
Task 4, Epoch 16/20 => Loss 2.187, Loss_clf 0.383, Loss_fe 0.352, Loss_kd 1.291, Train_accy 77.34, Test_accy 79.89:  80%|████████  | 16/20 [12:13<03:09, 47.36s/it]
Task 4, Epoch 17/20 => Loss 2.171, Loss_clf 0.379, Loss_fe 0.352, Loss_kd 1.281, Train_accy 77.27:  80%|████████  | 16/20 [12:56<03:09, 47.36s/it]                 
Task 4, Epoch 17/20 => Loss 2.171, Loss_clf 0.379, Loss_fe 0.352, Loss_kd 1.281, Train_accy 77.27:  85%|████████▌ | 17/20 [12:56<02:18, 46.00s/it]
Task 4, Epoch 18/20 => Loss 2.200, Loss_clf 0.402, Loss_fe 0.353, Loss_kd 1.285, Train_accy 76.41:  85%|████████▌ | 17/20 [13:39<02:18, 46.00s/it]
Task 4, Epoch 18/20 => Loss 2.200, Loss_clf 0.402, Loss_fe 0.353, Loss_kd 1.285, Train_accy 76.41:  90%|█████████ | 18/20 [13:39<01:30, 45.06s/it]
Task 4, Epoch 19/20 => Loss 2.165, Loss_clf 0.384, Loss_fe 0.348, Loss_kd 1.273, Train_accy 77.51:  90%|█████████ | 18/20 [14:22<01:30, 45.06s/it]
Task 4, Epoch 19/20 => Loss 2.165, Loss_clf 0.384, Loss_fe 0.348, Loss_kd 1.273, Train_accy 77.51:  95%|█████████▌| 19/20 [14:22<00:44, 44.39s/it]
Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26:  95%|█████████▌| 19/20 [15:05<00:44, 44.39s/it]
Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26: 100%|██████████| 20/20 [15:05<00:00, 43.92s/it]
Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26: 100%|██████████| 20/20 [15:05<00:00, 45.26s/it]
2024-09-05 16:32:01,667 [foster.py] => Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26
2024-09-05 16:32:01,668 [foster.py] => do not weight align teacher!
2024-09-05 16:32:01,673 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.442,  Train_accy 68.13, Test_accy 79.09:   0%|          | 0/20 [01:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.442,  Train_accy 68.13, Test_accy 79.09:   5%|▌         | 1/20 [01:00<19:09, 60.51s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.356,  Train_accy 71.26:   5%|▌         | 1/20 [01:54<19:09, 60.51s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.356,  Train_accy 71.26:  10%|█         | 2/20 [01:54<16:59, 56.63s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.339,  Train_accy 72.15:  10%|█         | 2/20 [02:48<16:59, 56.63s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.339,  Train_accy 72.15:  15%|█▌        | 3/20 [02:48<15:41, 55.40s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.288,  Train_accy 72.46:  15%|█▌        | 3/20 [03:42<15:41, 55.40s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.288,  Train_accy 72.46:  20%|██        | 4/20 [03:42<14:36, 54.80s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.315,  Train_accy 73.18:  20%|██        | 4/20 [04:36<14:36, 54.80s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.315,  Train_accy 73.18:  25%|██▌       | 5/20 [04:36<13:36, 54.46s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.307,  Train_accy 73.76, Test_accy 79.14:  25%|██▌       | 5/20 [05:36<13:36, 54.46s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.307,  Train_accy 73.76, Test_accy 79.14:  30%|███       | 6/20 [05:36<13:11, 56.53s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.313,  Train_accy 73.86:  30%|███       | 6/20 [06:30<13:11, 56.53s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.313,  Train_accy 73.86:  35%|███▌      | 7/20 [06:30<12:03, 55.66s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.288,  Train_accy 73.64:  35%|███▌      | 7/20 [07:24<12:03, 55.66s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.288,  Train_accy 73.64:  40%|████      | 8/20 [07:24<11:00, 55.08s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.288,  Train_accy 74.12:  40%|████      | 8/20 [08:18<11:00, 55.08s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.288,  Train_accy 74.12:  45%|████▌     | 9/20 [08:18<10:01, 54.71s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.282,  Train_accy 74.00:  45%|████▌     | 9/20 [09:12<10:01, 54.71s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.282,  Train_accy 74.00:  50%|█████     | 10/20 [09:12<09:04, 54.46s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.304,  Train_accy 73.26, Test_accy 79.14:  50%|█████     | 10/20 [10:12<09:04, 54.46s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.304,  Train_accy 73.26, Test_accy 79.14:  55%|█████▌    | 11/20 [10:12<08:26, 56.33s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.305,  Train_accy 74.27:  55%|█████▌    | 11/20 [11:06<08:26, 56.33s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.305,  Train_accy 74.27:  60%|██████    | 12/20 [11:06<07:24, 55.58s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.278,  Train_accy 74.84:  60%|██████    | 12/20 [12:00<07:24, 55.58s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.278,  Train_accy 74.84:  65%|██████▌   | 13/20 [12:00<06:25, 55.06s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.335,  Train_accy 73.76:  65%|██████▌   | 13/20 [12:54<06:25, 55.06s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.335,  Train_accy 73.76:  70%|███████   | 14/20 [12:54<05:28, 54.69s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.277,  Train_accy 74.27:  70%|███████   | 14/20 [13:48<05:28, 54.69s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.277,  Train_accy 74.27:  75%|███████▌  | 15/20 [13:48<04:32, 54.43s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.286,  Train_accy 73.88, Test_accy 79.28:  75%|███████▌  | 15/20 [14:48<04:32, 54.43s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.286,  Train_accy 73.88, Test_accy 79.28:  80%|████████  | 16/20 [14:48<03:45, 56.27s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.286,  Train_accy 74.22:  80%|████████  | 16/20 [15:42<03:45, 56.27s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.286,  Train_accy 74.22:  85%|████████▌ | 17/20 [15:42<02:46, 55.54s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.283,  Train_accy 73.40:  85%|████████▌ | 17/20 [16:36<02:46, 55.54s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.283,  Train_accy 73.40:  90%|█████████ | 18/20 [16:36<01:50, 55.05s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.278,  Train_accy 74.56:  90%|█████████ | 18/20 [17:30<01:50, 55.05s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.278,  Train_accy 74.56:  95%|█████████▌| 19/20 [17:30<00:54, 54.71s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59:  95%|█████████▌| 19/20 [18:24<00:54, 54.71s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59: 100%|██████████| 20/20 [18:24<00:00, 54.46s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59: 100%|██████████| 20/20 [18:24<00:00, 55.21s/it]
2024-09-05 16:50:27,329 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59
2024-09-05 16:50:27,330 [foster.py] => do not weight align student!
2024-09-05 16:50:33,988 [foster.py] => darknet eval: 
2024-09-05 16:50:33,988 [foster.py] => CNN top1 curve: 79.42
2024-09-05 16:50:33,989 [foster.py] => CNN top5 curve: 96.99
2024-09-05 16:50:33,991 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 16:52:30,312 [foster.py] => Exemplar size: 3600
2024-09-05 16:52:30,312 [trainer.py] => CNN: {'total': 79.7, '00-99': 90.4, '100-119': 85.09, '120-139': 76.44, '140-159': 66.8, '160-179': 37.55, 'old': 84.98, 'new': 37.55}
2024-09-05 16:52:30,312 [trainer.py] => NME: {'total': 88.35, '00-99': 88.64, '100-119': 87.72, '120-139': 85.78, '140-159': 89.2, '160-179': 89.03, 'old': 88.26, 'new': 89.03}
2024-09-05 16:52:30,312 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69, 79.69, 79.7]
2024-09-05 16:52:30,312 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05, 97.62, 97.32]
2024-09-05 16:52:30,312 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67, 88.05, 88.35]
2024-09-05 16:52:30,312 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72, 98.78, 98.5]

Average Accuracy (CNN): 83.79
Average Accuracy (NME): 89.35
2024-09-05 16:52:30,312 [trainer.py] => Average Accuracy (CNN): 83.79
2024-09-05 16:52:30,312 [trainer.py] => Average Accuracy (NME): 89.35
2024-09-05 16:52:30,314 [trainer.py] => All params: 172135432
2024-09-05 16:52:30,315 [trainer.py] => Trainable params: 86213736
2024-09-05 16:52:31,860 [foster.py] => Learning on 180-200
2024-09-05 16:52:31,861 [foster.py] => All params: 172196932
2024-09-05 16:52:31,862 [foster.py] => Trainable params: 86259856
2024-09-05 16:52:31,912 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 6.468, Loss_clf 1.173, Loss_fe 3.799, Loss_kd 1.346, Train_accy 69.84, Test_accy 78.75:   0%|          | 0/20 [00:59<?, ?it/s]
Task 5, Epoch 1/20 => Loss 6.468, Loss_clf 1.173, Loss_fe 3.799, Loss_kd 1.346, Train_accy 69.84, Test_accy 78.75:   5%|▌         | 1/20 [00:59<18:50, 59.52s/it]
Task 5, Epoch 2/20 => Loss 3.433, Loss_clf 0.689, Loss_fe 1.269, Loss_kd 1.327, Train_accy 72.83:   5%|▌         | 1/20 [01:46<18:50, 59.52s/it]                 
Task 5, Epoch 2/20 => Loss 3.433, Loss_clf 0.689, Loss_fe 1.269, Loss_kd 1.327, Train_accy 72.83:  10%|█         | 2/20 [01:46<15:33, 51.86s/it]
Task 5, Epoch 3/20 => Loss 3.015, Loss_clf 0.607, Loss_fe 0.936, Loss_kd 1.325, Train_accy 73.77:  10%|█         | 2/20 [02:32<15:33, 51.86s/it]
Task 5, Epoch 3/20 => Loss 3.015, Loss_clf 0.607, Loss_fe 0.936, Loss_kd 1.325, Train_accy 73.77:  15%|█▌        | 3/20 [02:32<14:01, 49.49s/it]
Task 5, Epoch 4/20 => Loss 2.829, Loss_clf 0.558, Loss_fe 0.784, Loss_kd 1.338, Train_accy 74.49:  15%|█▌        | 3/20 [03:19<14:01, 49.49s/it]
Task 5, Epoch 4/20 => Loss 2.829, Loss_clf 0.558, Loss_fe 0.784, Loss_kd 1.338, Train_accy 74.49:  20%|██        | 4/20 [03:19<12:54, 48.41s/it]
Task 5, Epoch 5/20 => Loss 2.720, Loss_clf 0.528, Loss_fe 0.699, Loss_kd 1.344, Train_accy 73.77:  20%|██        | 4/20 [04:06<12:54, 48.41s/it]
Task 5, Epoch 5/20 => Loss 2.720, Loss_clf 0.528, Loss_fe 0.699, Loss_kd 1.344, Train_accy 73.77:  25%|██▌       | 5/20 [04:06<11:58, 47.87s/it]
Task 5, Epoch 6/20 => Loss 2.539, Loss_clf 0.486, Loss_fe 0.607, Loss_kd 1.301, Train_accy 75.07, Test_accy 79.64:  25%|██▌       | 5/20 [05:07<11:58, 47.87s/it]
Task 5, Epoch 6/20 => Loss 2.539, Loss_clf 0.486, Loss_fe 0.607, Loss_kd 1.301, Train_accy 75.07, Test_accy 79.64:  30%|███       | 6/20 [05:07<12:11, 52.28s/it]
Task 5, Epoch 7/20 => Loss 2.631, Loss_clf 0.506, Loss_fe 0.626, Loss_kd 1.349, Train_accy 74.12:  30%|███       | 6/20 [05:54<12:11, 52.28s/it]                 
Task 5, Epoch 7/20 => Loss 2.631, Loss_clf 0.506, Loss_fe 0.626, Loss_kd 1.349, Train_accy 74.12:  35%|███▌      | 7/20 [05:54<10:57, 50.55s/it]
Task 5, Epoch 8/20 => Loss 2.466, Loss_clf 0.466, Loss_fe 0.522, Loss_kd 1.330, Train_accy 75.22:  35%|███▌      | 7/20 [06:41<10:57, 50.55s/it]
Task 5, Epoch 8/20 => Loss 2.466, Loss_clf 0.466, Loss_fe 0.522, Loss_kd 1.330, Train_accy 75.22:  40%|████      | 8/20 [06:41<09:52, 49.38s/it]
Task 5, Epoch 9/20 => Loss 2.490, Loss_clf 0.475, Loss_fe 0.515, Loss_kd 1.350, Train_accy 75.18:  40%|████      | 8/20 [07:27<09:52, 49.38s/it]
Task 5, Epoch 9/20 => Loss 2.490, Loss_clf 0.475, Loss_fe 0.515, Loss_kd 1.350, Train_accy 75.18:  45%|████▌     | 9/20 [07:27<08:54, 48.61s/it]
Task 5, Epoch 10/20 => Loss 2.399, Loss_clf 0.452, Loss_fe 0.483, Loss_kd 1.318, Train_accy 75.29:  45%|████▌     | 9/20 [08:14<08:54, 48.61s/it]
Task 5, Epoch 10/20 => Loss 2.399, Loss_clf 0.452, Loss_fe 0.483, Loss_kd 1.318, Train_accy 75.29:  50%|█████     | 10/20 [08:14<08:00, 48.08s/it]
Task 5, Epoch 11/20 => Loss 2.361, Loss_clf 0.438, Loss_fe 0.450, Loss_kd 1.326, Train_accy 75.83, Test_accy 79.13:  50%|█████     | 10/20 [09:15<08:00, 48.08s/it]
Task 5, Epoch 11/20 => Loss 2.361, Loss_clf 0.438, Loss_fe 0.450, Loss_kd 1.326, Train_accy 75.83, Test_accy 79.13:  55%|█████▌    | 11/20 [09:15<07:47, 51.90s/it]
Task 5, Epoch 12/20 => Loss 2.289, Loss_clf 0.422, Loss_fe 0.415, Loss_kd 1.307, Train_accy 75.55:  55%|█████▌    | 11/20 [10:02<07:47, 51.90s/it]                 
Task 5, Epoch 12/20 => Loss 2.289, Loss_clf 0.422, Loss_fe 0.415, Loss_kd 1.307, Train_accy 75.55:  60%|██████    | 12/20 [10:02<06:43, 50.38s/it]
Task 5, Epoch 13/20 => Loss 2.373, Loss_clf 0.431, Loss_fe 0.435, Loss_kd 1.357, Train_accy 76.12:  60%|██████    | 12/20 [10:49<06:43, 50.38s/it]
Task 5, Epoch 13/20 => Loss 2.373, Loss_clf 0.431, Loss_fe 0.435, Loss_kd 1.357, Train_accy 76.12:  65%|██████▌   | 13/20 [10:49<05:45, 49.31s/it]
Task 5, Epoch 14/20 => Loss 2.285, Loss_clf 0.426, Loss_fe 0.390, Loss_kd 1.323, Train_accy 75.97:  65%|██████▌   | 13/20 [11:36<05:45, 49.31s/it]
Task 5, Epoch 14/20 => Loss 2.285, Loss_clf 0.426, Loss_fe 0.390, Loss_kd 1.323, Train_accy 75.97:  70%|███████   | 14/20 [11:36<04:51, 48.57s/it]
Task 5, Epoch 15/20 => Loss 2.314, Loss_clf 0.429, Loss_fe 0.401, Loss_kd 1.335, Train_accy 76.71:  70%|███████   | 14/20 [12:22<04:51, 48.57s/it]
Task 5, Epoch 15/20 => Loss 2.314, Loss_clf 0.429, Loss_fe 0.401, Loss_kd 1.335, Train_accy 76.71:  75%|███████▌  | 15/20 [12:22<04:00, 48.06s/it]
Task 5, Epoch 16/20 => Loss 2.240, Loss_clf 0.407, Loss_fe 0.369, Loss_kd 1.318, Train_accy 76.98, Test_accy 79.18:  75%|███████▌  | 15/20 [13:23<04:00, 48.06s/it]
Task 5, Epoch 16/20 => Loss 2.240, Loss_clf 0.407, Loss_fe 0.369, Loss_kd 1.318, Train_accy 76.98, Test_accy 79.18:  80%|████████  | 16/20 [13:23<03:27, 51.82s/it]
Task 5, Epoch 17/20 => Loss 2.240, Loss_clf 0.404, Loss_fe 0.370, Loss_kd 1.319, Train_accy 76.87:  80%|████████  | 16/20 [14:10<03:27, 51.82s/it]                 
Task 5, Epoch 17/20 => Loss 2.240, Loss_clf 0.404, Loss_fe 0.370, Loss_kd 1.319, Train_accy 76.87:  85%|████████▌ | 17/20 [14:10<02:31, 50.35s/it]
Task 5, Epoch 18/20 => Loss 2.187, Loss_clf 0.387, Loss_fe 0.344, Loss_kd 1.310, Train_accy 76.74:  85%|████████▌ | 17/20 [14:57<02:31, 50.35s/it]
Task 5, Epoch 18/20 => Loss 2.187, Loss_clf 0.387, Loss_fe 0.344, Loss_kd 1.310, Train_accy 76.74:  90%|█████████ | 18/20 [14:57<01:38, 49.29s/it]
Task 5, Epoch 19/20 => Loss 2.157, Loss_clf 0.367, Loss_fe 0.320, Loss_kd 1.323, Train_accy 77.86:  90%|█████████ | 18/20 [15:44<01:38, 49.29s/it]
Task 5, Epoch 19/20 => Loss 2.157, Loss_clf 0.367, Loss_fe 0.320, Loss_kd 1.323, Train_accy 77.86:  95%|█████████▌| 19/20 [15:44<00:48, 48.56s/it]
Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88:  95%|█████████▌| 19/20 [16:30<00:48, 48.56s/it]
Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88: 100%|██████████| 20/20 [16:30<00:00, 48.06s/it]
Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88: 100%|██████████| 20/20 [16:30<00:00, 49.55s/it]
2024-09-05 17:09:02,882 [foster.py] => Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88
2024-09-05 17:09:02,884 [foster.py] => do not weight align teacher!
2024-09-05 17:09:02,889 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.452,  Train_accy 70.30, Test_accy 78.33:   0%|          | 0/20 [01:06<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.452,  Train_accy 70.30, Test_accy 78.33:   5%|▌         | 1/20 [01:06<20:58, 66.25s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.399,  Train_accy 71.70:   5%|▌         | 1/20 [02:05<20:58, 66.25s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.399,  Train_accy 71.70:  10%|█         | 2/20 [02:05<18:35, 61.95s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.363,  Train_accy 72.76:  10%|█         | 2/20 [03:04<18:35, 61.95s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.363,  Train_accy 72.76:  15%|█▌        | 3/20 [03:04<17:10, 60.61s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.367,  Train_accy 73.15:  15%|█▌        | 3/20 [04:03<17:10, 60.61s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.367,  Train_accy 73.15:  20%|██        | 4/20 [04:03<15:59, 59.98s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.355,  Train_accy 73.31:  20%|██        | 4/20 [05:02<15:59, 59.98s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.355,  Train_accy 73.31:  25%|██▌       | 5/20 [05:02<14:54, 59.61s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.326,  Train_accy 73.99, Test_accy 78.97:  25%|██▌       | 5/20 [06:08<14:54, 59.61s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.326,  Train_accy 73.99, Test_accy 78.97:  30%|███       | 6/20 [06:08<14:26, 61.90s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.396,  Train_accy 73.70:  30%|███       | 6/20 [07:07<14:26, 61.90s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.396,  Train_accy 73.70:  35%|███▌      | 7/20 [07:07<13:12, 60.93s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.360,  Train_accy 73.37:  35%|███▌      | 7/20 [08:06<13:12, 60.93s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.360,  Train_accy 73.37:  40%|████      | 8/20 [08:06<12:03, 60.29s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.383,  Train_accy 73.13:  40%|████      | 8/20 [09:05<12:03, 60.29s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.383,  Train_accy 73.13:  45%|████▌     | 9/20 [09:05<10:58, 59.87s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.360,  Train_accy 72.87:  45%|████▌     | 9/20 [10:04<10:58, 59.87s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.360,  Train_accy 72.87:  50%|█████     | 10/20 [10:04<09:55, 59.59s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.329,  Train_accy 73.81, Test_accy 78.84:  50%|█████     | 10/20 [11:10<09:55, 59.59s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.329,  Train_accy 73.81, Test_accy 78.84:  55%|█████▌    | 11/20 [11:10<09:14, 61.62s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.311,  Train_accy 74.08:  55%|█████▌    | 11/20 [12:09<09:14, 61.62s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.311,  Train_accy 74.08:  60%|██████    | 12/20 [12:09<08:06, 60.81s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.322,  Train_accy 74.03:  60%|██████    | 12/20 [13:08<08:06, 60.81s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.322,  Train_accy 74.03:  65%|██████▌   | 13/20 [13:08<07:01, 60.26s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.343,  Train_accy 73.84:  65%|██████▌   | 13/20 [14:07<07:01, 60.26s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.343,  Train_accy 73.84:  70%|███████   | 14/20 [14:07<05:59, 59.86s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.334,  Train_accy 73.95:  70%|███████   | 14/20 [15:06<05:59, 59.86s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.334,  Train_accy 73.95:  75%|███████▌  | 15/20 [15:06<04:57, 59.58s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.339,  Train_accy 74.28, Test_accy 78.71:  75%|███████▌  | 15/20 [16:12<04:57, 59.58s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.339,  Train_accy 74.28, Test_accy 78.71:  80%|████████  | 16/20 [16:12<04:06, 61.60s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.343,  Train_accy 74.08:  80%|████████  | 16/20 [17:11<04:06, 61.60s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.343,  Train_accy 74.08:  85%|████████▌ | 17/20 [17:11<03:02, 60.81s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.351,  Train_accy 73.62:  85%|████████▌ | 17/20 [18:10<03:02, 60.81s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.351,  Train_accy 73.62:  90%|█████████ | 18/20 [18:10<02:00, 60.26s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.376,  Train_accy 73.20:  90%|█████████ | 18/20 [19:09<02:00, 60.26s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.376,  Train_accy 73.20:  95%|█████████▌| 19/20 [19:09<00:59, 59.85s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21:  95%|█████████▌| 19/20 [20:08<00:59, 59.85s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21: 100%|██████████| 20/20 [20:08<00:00, 59.59s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21: 100%|██████████| 20/20 [20:08<00:00, 60.42s/it]
2024-09-05 17:29:12,877 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21
2024-09-05 17:29:12,877 [foster.py] => do not weight align student!
2024-09-05 17:29:20,248 [foster.py] => darknet eval: 
2024-09-05 17:29:20,249 [foster.py] => CNN top1 curve: 78.92
2024-09-05 17:29:20,249 [foster.py] => CNN top5 curve: 95.8
2024-09-05 17:29:20,253 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 17:31:28,381 [foster.py] => Exemplar size: 4000
2024-09-05 17:31:28,381 [trainer.py] => CNN: {'total': 78.88, '00-99': 89.65, '100-119': 85.53, '120-139': 79.11, '140-159': 78.0, '160-179': 69.2, '180-199': 27.39, 'old': 84.45, 'new': 27.39}
2024-09-05 17:31:28,381 [trainer.py] => NME: {'total': 88.25, '00-99': 88.13, '100-119': 88.6, '120-139': 86.22, '140-159': 90.4, '160-179': 89.03, '180-199': 87.39, 'old': 88.35, 'new': 87.39}
2024-09-05 17:31:28,381 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69, 79.69, 79.7, 78.88]
2024-09-05 17:31:28,381 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05, 97.62, 97.32, 96.86]
2024-09-05 17:31:28,381 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67, 88.05, 88.35, 88.25]
2024-09-05 17:31:28,382 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72, 98.78, 98.5, 98.13]

Average Accuracy (CNN): 82.98
Average Accuracy (NME): 89.17
2024-09-05 17:31:28,382 [trainer.py] => Average Accuracy (CNN): 82.98
2024-09-05 17:31:28,382 [trainer.py] => Average Accuracy (NME): 89.17
Accuracy Matrix (CNN):
[[92.   91.67 92.09 90.99 90.4  89.65]
 [ 0.   49.56 69.74 80.7  85.09 85.53]
 [ 0.    0.   46.22 67.11 76.44 79.11]
 [ 0.    0.    0.   36.4  66.8  78.  ]
 [ 0.    0.    0.    0.   37.55 69.2 ]
 [ 0.    0.    0.    0.    0.   27.39]]
2024-09-05 17:31:28,382 [trainer.py] => Forgetting (CNN): 0.48799999999999955
Accuracy Matrix (NME):
[[91.5  90.15 89.23 87.88 88.64 88.13]
 [ 0.   90.35 88.6  87.72 87.72 88.6 ]
 [ 0.    0.   85.78 86.22 85.78 86.22]
 [ 0.    0.    0.   90.8  89.2  90.4 ]
 [ 0.    0.    0.    0.   89.03 89.03]
 [ 0.    0.    0.    0.    0.   87.39]]
2024-09-05 17:31:28,382 [trainer.py] => Forgetting (NME): 1.1039999999999992
2024-09-05 17:31:31,251 [trainer.py] => config: ./exps/foster_cub_B100_Inc10.json
2024-09-05 17:31:31,251 [trainer.py] => prefix: cil
2024-09-05 17:31:31,251 [trainer.py] => dataset: cub
2024-09-05 17:31:31,251 [trainer.py] => memory_size: 4000
2024-09-05 17:31:31,251 [trainer.py] => memory_per_class: 20
2024-09-05 17:31:31,251 [trainer.py] => fixed_memory: True
2024-09-05 17:31:31,251 [trainer.py] => shuffle: True
2024-09-05 17:31:31,251 [trainer.py] => init_cls: 100
2024-09-05 17:31:31,251 [trainer.py] => increment: 20
2024-09-05 17:31:31,251 [trainer.py] => model_name: foster
2024-09-05 17:31:31,251 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-05 17:31:31,251 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 17:31:31,251 [trainer.py] => seed: 1993
2024-09-05 17:31:31,251 [trainer.py] => beta1: 0.96
2024-09-05 17:31:31,251 [trainer.py] => beta2: 0.97
2024-09-05 17:31:31,251 [trainer.py] => oofc: ft
2024-09-05 17:31:31,251 [trainer.py] => is_teacher_wa: False
2024-09-05 17:31:31,251 [trainer.py] => is_student_wa: False
2024-09-05 17:31:31,251 [trainer.py] => lambda_okd: 1
2024-09-05 17:31:31,251 [trainer.py] => wa_value: 1
2024-09-05 17:31:31,251 [trainer.py] => init_epochs: 20
2024-09-05 17:31:31,251 [trainer.py] => init_lr: 0.001
2024-09-05 17:31:31,251 [trainer.py] => init_weight_decay: 0.0005
2024-09-05 17:31:31,251 [trainer.py] => boosting_epochs: 20
2024-09-05 17:31:31,251 [trainer.py] => compression_epochs: 20
2024-09-05 17:31:31,252 [trainer.py] => lr: 0.001
2024-09-05 17:31:31,252 [trainer.py] => batch_size: 48
2024-09-05 17:31:31,252 [trainer.py] => weight_decay: 0.0005
2024-09-05 17:31:31,252 [trainer.py] => num_workers: 8
2024-09-05 17:31:31,252 [trainer.py] => T: 2
2024-09-05 17:31:31,288 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 17:31:31,581 [trainer.py] => All params: 0
2024-09-05 17:31:31,581 [trainer.py] => Trainable params: 0
2024-09-05 17:31:33,142 [foster.py] => Learning on 0-100
2024-09-05 17:31:33,142 [foster.py] => All params: 85952456
2024-09-05 17:31:33,143 [foster.py] => Trainable params: 85952456

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.746, Train_accy 0.89, Test_accy 1.18:   0%|          | 0/20 [00:38<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.746, Train_accy 0.89, Test_accy 1.18:   5%|▌         | 1/20 [00:38<12:20, 38.99s/it]
Task 0, Epoch 2/20 => Loss 3.817, Train_accy 15.40:   5%|▌         | 1/20 [01:14<12:20, 38.99s/it]               
Task 0, Epoch 2/20 => Loss 3.817, Train_accy 15.40:  10%|█         | 2/20 [01:14<11:00, 36.71s/it]
Task 0, Epoch 3/20 => Loss 1.113, Train_accy 69.26:  10%|█         | 2/20 [01:49<11:00, 36.71s/it]
Task 0, Epoch 3/20 => Loss 1.113, Train_accy 69.26:  15%|█▌        | 3/20 [01:49<10:13, 36.06s/it]
Task 0, Epoch 4/20 => Loss 0.754, Train_accy 79.48:  15%|█▌        | 3/20 [02:24<10:13, 36.06s/it]
Task 0, Epoch 4/20 => Loss 0.754, Train_accy 79.48:  20%|██        | 4/20 [02:24<09:32, 35.77s/it]
Task 0, Epoch 5/20 => Loss 0.620, Train_accy 82.77:  20%|██        | 4/20 [03:00<09:32, 35.77s/it]
Task 0, Epoch 5/20 => Loss 0.620, Train_accy 82.77:  25%|██▌       | 5/20 [03:00<08:55, 35.67s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 84.70, Test_accy 88.97:  25%|██▌       | 5/20 [03:39<08:55, 35.67s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 84.70, Test_accy 88.97:  30%|███       | 6/20 [03:39<08:36, 36.88s/it]
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 87.09:  30%|███       | 6/20 [04:14<08:36, 36.88s/it]                 
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 87.09:  35%|███▌      | 7/20 [04:14<07:53, 36.43s/it]
Task 0, Epoch 8/20 => Loss 0.448, Train_accy 87.58:  35%|███▌      | 7/20 [04:50<07:53, 36.43s/it]
Task 0, Epoch 8/20 => Loss 0.448, Train_accy 87.58:  40%|████      | 8/20 [04:50<07:13, 36.13s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 88.45:  40%|████      | 8/20 [05:26<07:13, 36.13s/it]
Task 0, Epoch 9/20 => Loss 0.424, Train_accy 88.45:  45%|████▌     | 9/20 [05:26<06:35, 35.96s/it]
Task 0, Epoch 10/20 => Loss 0.397, Train_accy 89.45:  45%|████▌     | 9/20 [06:01<06:35, 35.96s/it]
Task 0, Epoch 10/20 => Loss 0.397, Train_accy 89.45:  50%|█████     | 10/20 [06:01<05:58, 35.82s/it]
Task 0, Epoch 11/20 => Loss 0.389, Train_accy 89.33, Test_accy 90.40:  50%|█████     | 10/20 [06:40<05:58, 35.82s/it]
Task 0, Epoch 11/20 => Loss 0.389, Train_accy 89.33, Test_accy 90.40:  55%|█████▌    | 11/20 [06:40<05:32, 36.90s/it]
Task 0, Epoch 12/20 => Loss 0.353, Train_accy 90.16:  55%|█████▌    | 11/20 [07:16<05:32, 36.90s/it]                 
Task 0, Epoch 12/20 => Loss 0.353, Train_accy 90.16:  60%|██████    | 12/20 [07:16<04:51, 36.49s/it]
Task 0, Epoch 13/20 => Loss 0.313, Train_accy 91.76:  60%|██████    | 12/20 [07:51<04:51, 36.49s/it]
Task 0, Epoch 13/20 => Loss 0.313, Train_accy 91.76:  65%|██████▌   | 13/20 [07:51<04:13, 36.20s/it]
Task 0, Epoch 14/20 => Loss 0.313, Train_accy 91.63:  65%|██████▌   | 13/20 [08:27<04:13, 36.20s/it]
Task 0, Epoch 14/20 => Loss 0.313, Train_accy 91.63:  70%|███████   | 14/20 [08:27<03:35, 35.99s/it]
Task 0, Epoch 15/20 => Loss 0.296, Train_accy 92.25:  70%|███████   | 14/20 [09:02<03:35, 35.99s/it]
Task 0, Epoch 15/20 => Loss 0.296, Train_accy 92.25:  75%|███████▌  | 15/20 [09:02<02:59, 35.85s/it]
Task 0, Epoch 16/20 => Loss 0.282, Train_accy 92.37, Test_accy 91.41:  75%|███████▌  | 15/20 [09:42<02:59, 35.85s/it]
Task 0, Epoch 16/20 => Loss 0.282, Train_accy 92.37, Test_accy 91.41:  80%|████████  | 16/20 [09:42<02:27, 36.91s/it]
Task 0, Epoch 17/20 => Loss 0.282, Train_accy 92.25:  80%|████████  | 16/20 [10:17<02:27, 36.91s/it]                 
Task 0, Epoch 17/20 => Loss 0.282, Train_accy 92.25:  85%|████████▌ | 17/20 [10:17<01:49, 36.50s/it]
Task 0, Epoch 18/20 => Loss 0.293, Train_accy 92.16:  85%|████████▌ | 17/20 [10:53<01:49, 36.50s/it]
Task 0, Epoch 18/20 => Loss 0.293, Train_accy 92.16:  90%|█████████ | 18/20 [10:53<01:12, 36.22s/it]
Task 0, Epoch 19/20 => Loss 0.270, Train_accy 92.67:  90%|█████████ | 18/20 [11:28<01:12, 36.22s/it]
Task 0, Epoch 19/20 => Loss 0.270, Train_accy 92.67:  95%|█████████▌| 19/20 [11:28<00:36, 36.00s/it]
Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35:  95%|█████████▌| 19/20 [12:04<00:36, 36.00s/it]
Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35: 100%|██████████| 20/20 [12:04<00:00, 35.86s/it]
Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35: 100%|██████████| 20/20 [12:04<00:00, 36.23s/it]
2024-09-05 17:43:38,131 [foster.py] => Task 0, Epoch 20/20 => Loss 0.234, Train_accy 93.35
2024-09-05 17:43:38,132 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 17:45:05,016 [foster.py] => Exemplar size: 2000
2024-09-05 17:45:05,016 [trainer.py] => CNN: {'total': 92.0, '00-99': 92.0, 'old': 0, 'new': 92.0}
2024-09-05 17:45:05,016 [trainer.py] => NME: {'total': 91.5, '00-99': 91.5, 'old': 0, 'new': 91.5}
2024-09-05 17:45:05,016 [trainer.py] => CNN top1 curve: [92.0]
2024-09-05 17:45:05,016 [trainer.py] => CNN top5 curve: [98.91]
2024-09-05 17:45:05,016 [trainer.py] => NME top1 curve: [91.5]
2024-09-05 17:45:05,016 [trainer.py] => NME top5 curve: [99.16]

Average Accuracy (CNN): 92.0
Average Accuracy (NME): 91.5
2024-09-05 17:45:05,016 [trainer.py] => Average Accuracy (CNN): 92.0
2024-09-05 17:45:05,017 [trainer.py] => Average Accuracy (NME): 91.5
2024-09-05 17:45:05,017 [trainer.py] => All params: 85952456
2024-09-05 17:45:05,018 [trainer.py] => Trainable params: 85952456
2024-09-05 17:45:06,474 [foster.py] => Learning on 100-120
2024-09-05 17:45:06,476 [foster.py] => All params: 171950932
2024-09-05 17:45:06,476 [foster.py] => Trainable params: 86075376
2024-09-05 17:45:06,525 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.595, Loss_clf 1.225, Loss_fe 3.234, Loss_kd 0.947, Train_accy 69.65, Test_accy 82.98:   0%|          | 0/20 [00:37<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.595, Loss_clf 1.225, Loss_fe 3.234, Loss_kd 0.947, Train_accy 69.65, Test_accy 82.98:   5%|▌         | 1/20 [00:37<12:00, 37.94s/it]
Task 1, Epoch 2/20 => Loss 2.508, Loss_clf 0.503, Loss_fe 0.889, Loss_kd 0.930, Train_accy 73.71:   5%|▌         | 1/20 [01:08<12:00, 37.94s/it]                 
Task 1, Epoch 2/20 => Loss 2.508, Loss_clf 0.503, Loss_fe 0.889, Loss_kd 0.930, Train_accy 73.71:  10%|█         | 2/20 [01:08<09:59, 33.31s/it]
Task 1, Epoch 3/20 => Loss 2.251, Loss_clf 0.439, Loss_fe 0.692, Loss_kd 0.934, Train_accy 74.05:  10%|█         | 2/20 [01:38<09:59, 33.31s/it]
Task 1, Epoch 3/20 => Loss 2.251, Loss_clf 0.439, Loss_fe 0.692, Loss_kd 0.934, Train_accy 74.05:  15%|█▌        | 3/20 [01:38<09:02, 31.90s/it]
Task 1, Epoch 4/20 => Loss 2.199, Loss_clf 0.424, Loss_fe 0.657, Loss_kd 0.932, Train_accy 74.49:  15%|█▌        | 3/20 [02:08<09:02, 31.90s/it]
Task 1, Epoch 4/20 => Loss 2.199, Loss_clf 0.424, Loss_fe 0.657, Loss_kd 0.932, Train_accy 74.49:  20%|██        | 4/20 [02:08<08:20, 31.27s/it]
Task 1, Epoch 5/20 => Loss 2.020, Loss_clf 0.363, Loss_fe 0.548, Loss_kd 0.925, Train_accy 74.90:  20%|██        | 4/20 [02:38<08:20, 31.27s/it]
Task 1, Epoch 5/20 => Loss 2.020, Loss_clf 0.363, Loss_fe 0.548, Loss_kd 0.925, Train_accy 74.90:  25%|██▌       | 5/20 [02:38<07:44, 30.95s/it]
Task 1, Epoch 6/20 => Loss 1.857, Loss_clf 0.330, Loss_fe 0.454, Loss_kd 0.895, Train_accy 74.36, Test_accy 85.24:  25%|██▌       | 5/20 [03:17<07:44, 30.95s/it]
Task 1, Epoch 6/20 => Loss 1.857, Loss_clf 0.330, Loss_fe 0.454, Loss_kd 0.895, Train_accy 74.36, Test_accy 85.24:  30%|███       | 6/20 [03:17<07:50, 33.61s/it]
Task 1, Epoch 7/20 => Loss 1.846, Loss_clf 0.320, Loss_fe 0.432, Loss_kd 0.912, Train_accy 75.64:  30%|███       | 6/20 [03:48<07:50, 33.61s/it]                 
Task 1, Epoch 7/20 => Loss 1.846, Loss_clf 0.320, Loss_fe 0.432, Loss_kd 0.912, Train_accy 75.64:  35%|███▌      | 7/20 [03:48<07:03, 32.57s/it]
Task 1, Epoch 8/20 => Loss 1.811, Loss_clf 0.316, Loss_fe 0.406, Loss_kd 0.908, Train_accy 76.69:  35%|███▌      | 7/20 [04:18<07:03, 32.57s/it]
Task 1, Epoch 8/20 => Loss 1.811, Loss_clf 0.316, Loss_fe 0.406, Loss_kd 0.908, Train_accy 76.69:  40%|████      | 8/20 [04:18<06:22, 31.90s/it]
Task 1, Epoch 9/20 => Loss 1.812, Loss_clf 0.300, Loss_fe 0.384, Loss_kd 0.939, Train_accy 76.32:  40%|████      | 8/20 [04:49<06:22, 31.90s/it]
Task 1, Epoch 9/20 => Loss 1.812, Loss_clf 0.300, Loss_fe 0.384, Loss_kd 0.939, Train_accy 76.32:  45%|████▌     | 9/20 [04:49<05:46, 31.47s/it]
Task 1, Epoch 10/20 => Loss 1.776, Loss_clf 0.303, Loss_fe 0.383, Loss_kd 0.909, Train_accy 75.85:  45%|████▌     | 9/20 [05:19<05:46, 31.47s/it]
Task 1, Epoch 10/20 => Loss 1.776, Loss_clf 0.303, Loss_fe 0.383, Loss_kd 0.909, Train_accy 75.85:  50%|█████     | 10/20 [05:19<05:11, 31.17s/it]
Task 1, Epoch 11/20 => Loss 1.688, Loss_clf 0.273, Loss_fe 0.327, Loss_kd 0.906, Train_accy 75.95, Test_accy 84.82:  50%|█████     | 10/20 [05:58<05:11, 31.17s/it]
Task 1, Epoch 11/20 => Loss 1.688, Loss_clf 0.273, Loss_fe 0.327, Loss_kd 0.906, Train_accy 75.95, Test_accy 84.82:  55%|█████▌    | 11/20 [05:58<05:01, 33.51s/it]
Task 1, Epoch 12/20 => Loss 1.826, Loss_clf 0.333, Loss_fe 0.380, Loss_kd 0.928, Train_accy 75.10:  55%|█████▌    | 11/20 [06:28<05:01, 33.51s/it]                 
Task 1, Epoch 12/20 => Loss 1.826, Loss_clf 0.333, Loss_fe 0.380, Loss_kd 0.928, Train_accy 75.10:  60%|██████    | 12/20 [06:28<04:20, 32.58s/it]
Task 1, Epoch 13/20 => Loss 1.702, Loss_clf 0.280, Loss_fe 0.318, Loss_kd 0.920, Train_accy 76.93:  60%|██████    | 12/20 [06:59<04:20, 32.58s/it]
Task 1, Epoch 13/20 => Loss 1.702, Loss_clf 0.280, Loss_fe 0.318, Loss_kd 0.920, Train_accy 76.93:  65%|██████▌   | 13/20 [06:59<03:43, 31.95s/it]
Task 1, Epoch 14/20 => Loss 1.733, Loss_clf 0.285, Loss_fe 0.329, Loss_kd 0.932, Train_accy 75.98:  65%|██████▌   | 13/20 [07:29<03:43, 31.95s/it]
Task 1, Epoch 14/20 => Loss 1.733, Loss_clf 0.285, Loss_fe 0.329, Loss_kd 0.932, Train_accy 75.98:  70%|███████   | 14/20 [07:29<03:09, 31.51s/it]
Task 1, Epoch 15/20 => Loss 1.668, Loss_clf 0.264, Loss_fe 0.295, Loss_kd 0.924, Train_accy 76.46:  70%|███████   | 14/20 [08:00<03:09, 31.51s/it]
Task 1, Epoch 15/20 => Loss 1.668, Loss_clf 0.264, Loss_fe 0.295, Loss_kd 0.924, Train_accy 76.46:  75%|███████▌  | 15/20 [08:00<02:35, 31.20s/it]
Task 1, Epoch 16/20 => Loss 1.655, Loss_clf 0.275, Loss_fe 0.283, Loss_kd 0.914, Train_accy 76.63, Test_accy 85.03:  75%|███████▌  | 15/20 [08:39<02:35, 31.20s/it]
Task 1, Epoch 16/20 => Loss 1.655, Loss_clf 0.275, Loss_fe 0.283, Loss_kd 0.914, Train_accy 76.63, Test_accy 85.03:  80%|████████  | 16/20 [08:39<02:13, 33.49s/it]
Task 1, Epoch 17/20 => Loss 1.664, Loss_clf 0.279, Loss_fe 0.284, Loss_kd 0.917, Train_accy 76.36:  80%|████████  | 16/20 [09:09<02:13, 33.49s/it]                 
Task 1, Epoch 17/20 => Loss 1.664, Loss_clf 0.279, Loss_fe 0.284, Loss_kd 0.917, Train_accy 76.36:  85%|████████▌ | 17/20 [09:09<01:37, 32.60s/it]
Task 1, Epoch 18/20 => Loss 1.662, Loss_clf 0.272, Loss_fe 0.289, Loss_kd 0.918, Train_accy 76.22:  85%|████████▌ | 17/20 [09:40<01:37, 32.60s/it]
Task 1, Epoch 18/20 => Loss 1.662, Loss_clf 0.272, Loss_fe 0.289, Loss_kd 0.918, Train_accy 76.22:  90%|█████████ | 18/20 [09:40<01:03, 31.96s/it]
Task 1, Epoch 19/20 => Loss 1.618, Loss_clf 0.259, Loss_fe 0.271, Loss_kd 0.906, Train_accy 77.71:  90%|█████████ | 18/20 [10:10<01:03, 31.96s/it]
Task 1, Epoch 19/20 => Loss 1.618, Loss_clf 0.259, Loss_fe 0.271, Loss_kd 0.906, Train_accy 77.71:  95%|█████████▌| 19/20 [10:10<00:31, 31.52s/it]
Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68:  95%|█████████▌| 19/20 [10:41<00:31, 31.52s/it]
Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68: 100%|██████████| 20/20 [10:41<00:00, 31.22s/it]
Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68: 100%|██████████| 20/20 [10:41<00:00, 32.06s/it]
2024-09-05 17:55:47,712 [foster.py] => Task 1, Epoch 20/20 => Loss 1.509, Loss_clf 0.225, Loss_fe 0.235, Loss_kd 0.874, Train_accy 77.68
2024-09-05 17:55:47,713 [foster.py] => do not weight align teacher!
2024-09-05 17:55:47,717 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.221,  Train_accy 67.68, Test_accy 82.91:   0%|          | 0/20 [00:42<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.221,  Train_accy 67.68, Test_accy 82.91:   5%|▌         | 1/20 [00:42<13:34, 42.87s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.038,  Train_accy 72.32:   5%|▌         | 1/20 [01:21<13:34, 42.87s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.038,  Train_accy 72.32:  10%|█         | 2/20 [01:21<12:03, 40.22s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.025,  Train_accy 72.66:  10%|█         | 2/20 [01:59<12:03, 40.22s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.025,  Train_accy 72.66:  15%|█▌        | 3/20 [01:59<11:08, 39.35s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.039,  Train_accy 72.26:  15%|█▌        | 3/20 [02:37<11:08, 39.35s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.039,  Train_accy 72.26:  20%|██        | 4/20 [02:37<10:23, 38.96s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.039,  Train_accy 71.88:  20%|██        | 4/20 [03:16<10:23, 38.96s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.039,  Train_accy 71.88:  25%|██▌       | 5/20 [03:16<09:41, 38.74s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.002,  Train_accy 73.07, Test_accy 83.40:  25%|██▌       | 5/20 [03:59<09:41, 38.74s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.002,  Train_accy 73.07, Test_accy 83.40:  30%|███       | 6/20 [03:59<09:21, 40.14s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.030,  Train_accy 72.26:  30%|███       | 6/20 [04:37<09:21, 40.14s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.030,  Train_accy 72.26:  35%|███▌      | 7/20 [04:37<08:34, 39.56s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.005,  Train_accy 72.36:  35%|███▌      | 7/20 [05:15<08:34, 39.56s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.005,  Train_accy 72.36:  40%|████      | 8/20 [05:15<07:49, 39.17s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.018,  Train_accy 72.70:  40%|████      | 8/20 [05:54<07:49, 39.17s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.018,  Train_accy 72.70:  45%|████▌     | 9/20 [05:54<07:08, 38.91s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.037,  Train_accy 72.59:  45%|████▌     | 9/20 [06:32<07:08, 38.91s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.037,  Train_accy 72.59:  50%|█████     | 10/20 [06:32<06:27, 38.74s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.037,  Train_accy 72.46, Test_accy 83.76:  50%|█████     | 10/20 [07:15<06:27, 38.74s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.037,  Train_accy 72.46, Test_accy 83.76:  55%|█████▌    | 11/20 [07:15<06:00, 40.03s/it]
SNet: Task 1, Epoch 12/20 => Loss 0.999,  Train_accy 73.24:  55%|█████▌    | 11/20 [07:53<06:00, 40.03s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 0.999,  Train_accy 73.24:  60%|██████    | 12/20 [07:53<05:16, 39.51s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.028,  Train_accy 72.39:  60%|██████    | 12/20 [08:32<05:16, 39.51s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.028,  Train_accy 72.39:  65%|██████▌   | 13/20 [08:32<04:34, 39.15s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.019,  Train_accy 72.09:  65%|██████▌   | 13/20 [09:10<04:34, 39.15s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.019,  Train_accy 72.09:  70%|███████   | 14/20 [09:10<03:53, 38.91s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.004,  Train_accy 72.93:  70%|███████   | 14/20 [09:48<03:53, 38.91s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.004,  Train_accy 72.93:  75%|███████▌  | 15/20 [09:48<03:13, 38.73s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.025,  Train_accy 71.71, Test_accy 83.76:  75%|███████▌  | 15/20 [10:31<03:13, 38.73s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.025,  Train_accy 71.71, Test_accy 83.76:  80%|████████  | 16/20 [10:31<02:39, 39.97s/it]
SNet: Task 1, Epoch 17/20 => Loss 0.994,  Train_accy 73.64:  80%|████████  | 16/20 [11:09<02:39, 39.97s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 0.994,  Train_accy 73.64:  85%|████████▌ | 17/20 [11:09<01:58, 39.47s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.006,  Train_accy 73.41:  85%|████████▌ | 17/20 [11:48<01:58, 39.47s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.006,  Train_accy 73.41:  90%|█████████ | 18/20 [11:48<01:18, 39.13s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.978,  Train_accy 73.48:  90%|█████████ | 18/20 [12:26<01:18, 39.13s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.978,  Train_accy 73.48:  95%|█████████▌| 19/20 [12:26<00:38, 38.90s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07:  95%|█████████▌| 19/20 [13:04<00:38, 38.90s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07: 100%|██████████| 20/20 [13:04<00:00, 38.72s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07: 100%|██████████| 20/20 [13:04<00:00, 39.25s/it]
2024-09-05 18:08:54,204 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.999,  Train_accy 73.07
2024-09-05 18:08:54,204 [foster.py] => do not weight align student!
2024-09-05 18:08:58,756 [foster.py] => darknet eval: 
2024-09-05 18:08:58,757 [foster.py] => CNN top1 curve: 83.55
2024-09-05 18:08:58,757 [foster.py] => CNN top5 curve: 97.88
2024-09-05 18:08:58,759 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 18:10:16,856 [foster.py] => Exemplar size: 2400
2024-09-05 18:10:16,856 [trainer.py] => CNN: {'total': 84.89, '00-99': 91.67, '100-119': 49.56, 'old': 91.67, 'new': 49.56}
2024-09-05 18:10:16,856 [trainer.py] => NME: {'total': 90.18, '00-99': 90.15, '100-119': 90.35, 'old': 90.15, 'new': 90.35}
2024-09-05 18:10:16,856 [trainer.py] => CNN top1 curve: [92.0, 84.89]
2024-09-05 18:10:16,856 [trainer.py] => CNN top5 curve: [98.91, 98.02]
2024-09-05 18:10:16,856 [trainer.py] => NME top1 curve: [91.5, 90.18]
2024-09-05 18:10:16,856 [trainer.py] => NME top5 curve: [99.16, 98.73]

Average Accuracy (CNN): 88.44
Average Accuracy (NME): 90.84
2024-09-05 18:10:16,856 [trainer.py] => Average Accuracy (CNN): 88.44
2024-09-05 18:10:16,856 [trainer.py] => Average Accuracy (NME): 90.84
2024-09-05 18:10:16,857 [trainer.py] => All params: 171950932
2024-09-05 18:10:16,858 [trainer.py] => Trainable params: 86075376
2024-09-05 18:10:18,495 [foster.py] => Learning on 120-140
2024-09-05 18:10:18,497 [foster.py] => All params: 172012432
2024-09-05 18:10:18,497 [foster.py] => Trainable params: 86121496
2024-09-05 18:10:18,545 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.870, Loss_clf 1.266, Loss_fe 3.315, Loss_kd 1.105, Train_accy 69.02, Test_accy 80.80:   0%|          | 0/20 [00:43<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.870, Loss_clf 1.266, Loss_fe 3.315, Loss_kd 1.105, Train_accy 69.02, Test_accy 80.80:   5%|▌         | 1/20 [00:43<13:46, 43.50s/it]
Task 2, Epoch 2/20 => Loss 2.839, Loss_clf 0.627, Loss_fe 0.969, Loss_kd 1.065, Train_accy 72.69:   5%|▌         | 1/20 [01:17<13:46, 43.50s/it]                 
Task 2, Epoch 2/20 => Loss 2.839, Loss_clf 0.627, Loss_fe 0.969, Loss_kd 1.065, Train_accy 72.69:  10%|█         | 2/20 [01:17<11:25, 38.11s/it]
Task 2, Epoch 3/20 => Loss 2.532, Loss_clf 0.536, Loss_fe 0.743, Loss_kd 1.074, Train_accy 74.18:  10%|█         | 2/20 [01:52<11:25, 38.11s/it]
Task 2, Epoch 3/20 => Loss 2.532, Loss_clf 0.536, Loss_fe 0.743, Loss_kd 1.074, Train_accy 74.18:  15%|█▌        | 3/20 [01:52<10:19, 36.42s/it]
Task 2, Epoch 4/20 => Loss 2.370, Loss_clf 0.485, Loss_fe 0.644, Loss_kd 1.064, Train_accy 74.42:  15%|█▌        | 3/20 [02:26<10:19, 36.42s/it]
Task 2, Epoch 4/20 => Loss 2.370, Loss_clf 0.485, Loss_fe 0.644, Loss_kd 1.064, Train_accy 74.42:  20%|██        | 4/20 [02:26<09:30, 35.67s/it]
Task 2, Epoch 5/20 => Loss 2.366, Loss_clf 0.489, Loss_fe 0.608, Loss_kd 1.088, Train_accy 74.81:  20%|██        | 4/20 [03:01<09:30, 35.67s/it]
Task 2, Epoch 5/20 => Loss 2.366, Loss_clf 0.489, Loss_fe 0.608, Loss_kd 1.088, Train_accy 74.81:  25%|██▌       | 5/20 [03:01<08:49, 35.28s/it]
Task 2, Epoch 6/20 => Loss 2.204, Loss_clf 0.428, Loss_fe 0.517, Loss_kd 1.079, Train_accy 76.18, Test_accy 83.30:  25%|██▌       | 5/20 [03:45<08:49, 35.28s/it]
Task 2, Epoch 6/20 => Loss 2.204, Loss_clf 0.428, Loss_fe 0.517, Loss_kd 1.079, Train_accy 76.18, Test_accy 83.30:  30%|███       | 6/20 [03:45<08:56, 38.33s/it]
Task 2, Epoch 7/20 => Loss 2.089, Loss_clf 0.404, Loss_fe 0.451, Loss_kd 1.057, Train_accy 76.71:  30%|███       | 6/20 [04:20<08:56, 38.33s/it]                 
Task 2, Epoch 7/20 => Loss 2.089, Loss_clf 0.404, Loss_fe 0.451, Loss_kd 1.057, Train_accy 76.71:  35%|███▌      | 7/20 [04:20<08:02, 37.13s/it]
Task 2, Epoch 8/20 => Loss 2.194, Loss_clf 0.436, Loss_fe 0.476, Loss_kd 1.098, Train_accy 75.10:  35%|███▌      | 7/20 [04:54<08:02, 37.13s/it]
Task 2, Epoch 8/20 => Loss 2.194, Loss_clf 0.436, Loss_fe 0.476, Loss_kd 1.098, Train_accy 75.10:  40%|████      | 8/20 [04:54<07:16, 36.34s/it]
Task 2, Epoch 9/20 => Loss 2.044, Loss_clf 0.372, Loss_fe 0.419, Loss_kd 1.073, Train_accy 76.48:  40%|████      | 8/20 [05:29<07:16, 36.34s/it]
Task 2, Epoch 9/20 => Loss 2.044, Loss_clf 0.372, Loss_fe 0.419, Loss_kd 1.073, Train_accy 76.48:  45%|████▌     | 9/20 [05:29<06:33, 35.81s/it]
Task 2, Epoch 10/20 => Loss 2.024, Loss_clf 0.385, Loss_fe 0.392, Loss_kd 1.069, Train_accy 76.62:  45%|████▌     | 9/20 [06:04<06:33, 35.81s/it]
Task 2, Epoch 10/20 => Loss 2.024, Loss_clf 0.385, Loss_fe 0.392, Loss_kd 1.069, Train_accy 76.62:  50%|█████     | 10/20 [06:04<05:54, 35.46s/it]
Task 2, Epoch 11/20 => Loss 1.946, Loss_clf 0.335, Loss_fe 0.370, Loss_kd 1.064, Train_accy 77.40, Test_accy 83.06:  50%|█████     | 10/20 [06:48<05:54, 35.46s/it]
Task 2, Epoch 11/20 => Loss 1.946, Loss_clf 0.335, Loss_fe 0.370, Loss_kd 1.064, Train_accy 77.40, Test_accy 83.06:  55%|█████▌    | 11/20 [06:48<05:43, 38.16s/it]
Task 2, Epoch 12/20 => Loss 1.913, Loss_clf 0.341, Loss_fe 0.339, Loss_kd 1.057, Train_accy 77.79:  55%|█████▌    | 11/20 [07:23<05:43, 38.16s/it]                 
Task 2, Epoch 12/20 => Loss 1.913, Loss_clf 0.341, Loss_fe 0.339, Loss_kd 1.057, Train_accy 77.79:  60%|██████    | 12/20 [07:23<04:56, 37.07s/it]
Task 2, Epoch 13/20 => Loss 1.885, Loss_clf 0.332, Loss_fe 0.319, Loss_kd 1.058, Train_accy 77.19:  60%|██████    | 12/20 [07:57<04:56, 37.07s/it]
Task 2, Epoch 13/20 => Loss 1.885, Loss_clf 0.332, Loss_fe 0.319, Loss_kd 1.058, Train_accy 77.19:  65%|██████▌   | 13/20 [07:57<04:14, 36.34s/it]
Task 2, Epoch 14/20 => Loss 1.941, Loss_clf 0.338, Loss_fe 0.350, Loss_kd 1.074, Train_accy 78.29:  65%|██████▌   | 13/20 [08:32<04:14, 36.34s/it]
Task 2, Epoch 14/20 => Loss 1.941, Loss_clf 0.338, Loss_fe 0.350, Loss_kd 1.074, Train_accy 78.29:  70%|███████   | 14/20 [08:32<03:34, 35.82s/it]
Task 2, Epoch 15/20 => Loss 1.945, Loss_clf 0.356, Loss_fe 0.341, Loss_kd 1.070, Train_accy 76.95:  70%|███████   | 14/20 [09:07<03:34, 35.82s/it]
Task 2, Epoch 15/20 => Loss 1.945, Loss_clf 0.356, Loss_fe 0.341, Loss_kd 1.070, Train_accy 76.95:  75%|███████▌  | 15/20 [09:07<02:57, 35.47s/it]
Task 2, Epoch 16/20 => Loss 1.854, Loss_clf 0.321, Loss_fe 0.302, Loss_kd 1.055, Train_accy 77.55, Test_accy 82.88:  75%|███████▌  | 15/20 [09:51<02:57, 35.47s/it]
Task 2, Epoch 16/20 => Loss 1.854, Loss_clf 0.321, Loss_fe 0.302, Loss_kd 1.055, Train_accy 77.55, Test_accy 82.88:  80%|████████  | 16/20 [09:51<02:32, 38.13s/it]
Task 2, Epoch 17/20 => Loss 1.868, Loss_clf 0.321, Loss_fe 0.307, Loss_kd 1.063, Train_accy 78.71:  80%|████████  | 16/20 [10:25<02:32, 38.13s/it]                 
Task 2, Epoch 17/20 => Loss 1.868, Loss_clf 0.321, Loss_fe 0.307, Loss_kd 1.063, Train_accy 78.71:  85%|████████▌ | 17/20 [10:25<01:51, 37.07s/it]
Task 2, Epoch 18/20 => Loss 2.010, Loss_clf 0.369, Loss_fe 0.342, Loss_kd 1.114, Train_accy 78.12:  85%|████████▌ | 17/20 [11:00<01:51, 37.07s/it]
Task 2, Epoch 18/20 => Loss 2.010, Loss_clf 0.369, Loss_fe 0.342, Loss_kd 1.114, Train_accy 78.12:  90%|█████████ | 18/20 [11:00<01:12, 36.35s/it]
Task 2, Epoch 19/20 => Loss 1.874, Loss_clf 0.326, Loss_fe 0.308, Loss_kd 1.064, Train_accy 78.38:  90%|█████████ | 18/20 [11:35<01:12, 36.35s/it]
Task 2, Epoch 19/20 => Loss 1.874, Loss_clf 0.326, Loss_fe 0.308, Loss_kd 1.064, Train_accy 78.38:  95%|█████████▌| 19/20 [11:35<00:35, 35.84s/it]
Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89:  95%|█████████▌| 19/20 [12:09<00:35, 35.84s/it]
Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89: 100%|██████████| 20/20 [12:09<00:00, 35.48s/it]
Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89: 100%|██████████| 20/20 [12:09<00:00, 36.50s/it]
2024-09-05 18:22:28,450 [foster.py] => Task 2, Epoch 20/20 => Loss 1.893, Loss_clf 0.329, Loss_fe 0.298, Loss_kd 1.085, Train_accy 78.89
2024-09-05 18:22:28,451 [foster.py] => do not weight align teacher!
2024-09-05 18:22:28,456 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.342,  Train_accy 66.52, Test_accy 82.08:   0%|          | 0/20 [00:48<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.342,  Train_accy 66.52, Test_accy 82.08:   5%|▌         | 1/20 [00:48<15:25, 48.72s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.169,  Train_accy 72.66:   5%|▌         | 1/20 [01:32<15:25, 48.72s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.169,  Train_accy 72.66:  10%|█         | 2/20 [01:32<13:41, 45.66s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.158,  Train_accy 73.23:  10%|█         | 2/20 [02:15<13:41, 45.66s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.158,  Train_accy 73.23:  15%|█▌        | 3/20 [02:15<12:39, 44.69s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.163,  Train_accy 73.11:  15%|█▌        | 3/20 [02:59<12:39, 44.69s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.163,  Train_accy 73.11:  20%|██        | 4/20 [02:59<11:47, 44.24s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.149,  Train_accy 73.46:  20%|██        | 4/20 [03:42<11:47, 44.24s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.149,  Train_accy 73.46:  25%|██▌       | 5/20 [03:42<10:59, 43.98s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.166,  Train_accy 73.94, Test_accy 82.45:  25%|██▌       | 5/20 [04:31<10:59, 43.98s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.166,  Train_accy 73.94, Test_accy 82.45:  30%|███       | 6/20 [04:31<10:38, 45.61s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.180,  Train_accy 73.76:  30%|███       | 6/20 [05:15<10:38, 45.61s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.180,  Train_accy 73.76:  35%|███▌      | 7/20 [05:15<09:44, 44.95s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.150,  Train_accy 73.67:  35%|███▌      | 7/20 [05:58<09:44, 44.95s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.150,  Train_accy 73.67:  40%|████      | 8/20 [05:58<08:54, 44.51s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.148,  Train_accy 73.23:  40%|████      | 8/20 [06:42<08:54, 44.51s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.148,  Train_accy 73.23:  45%|████▌     | 9/20 [06:42<08:06, 44.20s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.133,  Train_accy 74.75:  45%|████▌     | 9/20 [07:25<08:06, 44.20s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.133,  Train_accy 74.75:  50%|█████     | 10/20 [07:25<07:20, 44.01s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.111,  Train_accy 75.07, Test_accy 82.69:  50%|█████     | 10/20 [08:14<07:20, 44.01s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.111,  Train_accy 75.07, Test_accy 82.69:  55%|█████▌    | 11/20 [08:14<06:49, 45.47s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.156,  Train_accy 74.90:  55%|█████▌    | 11/20 [08:58<06:49, 45.47s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.156,  Train_accy 74.90:  60%|██████    | 12/20 [08:58<05:59, 44.89s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.135,  Train_accy 74.30:  60%|██████    | 12/20 [09:41<05:59, 44.89s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.135,  Train_accy 74.30:  65%|██████▌   | 13/20 [09:41<05:11, 44.47s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.095,  Train_accy 74.96:  65%|██████▌   | 13/20 [10:25<05:11, 44.47s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.095,  Train_accy 74.96:  70%|███████   | 14/20 [10:25<04:25, 44.19s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.124,  Train_accy 74.21:  70%|███████   | 14/20 [11:08<04:25, 44.19s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.124,  Train_accy 74.21:  75%|███████▌  | 15/20 [11:08<03:40, 44.01s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.114,  Train_accy 74.81, Test_accy 82.21:  75%|███████▌  | 15/20 [11:57<03:40, 44.01s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.114,  Train_accy 74.81, Test_accy 82.21:  80%|████████  | 16/20 [11:57<03:01, 45.45s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.155,  Train_accy 73.49:  80%|████████  | 16/20 [12:41<03:01, 45.45s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.155,  Train_accy 73.49:  85%|████████▌ | 17/20 [12:41<02:14, 44.87s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.121,  Train_accy 74.48:  85%|████████▌ | 17/20 [13:24<02:14, 44.87s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.121,  Train_accy 74.48:  90%|█████████ | 18/20 [13:24<01:28, 44.47s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.154,  Train_accy 73.91:  90%|█████████ | 18/20 [14:08<01:28, 44.47s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.154,  Train_accy 73.91:  95%|█████████▌| 19/20 [14:08<00:44, 44.20s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07:  95%|█████████▌| 19/20 [14:51<00:44, 44.20s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07: 100%|██████████| 20/20 [14:51<00:00, 44.00s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07: 100%|██████████| 20/20 [14:51<00:00, 44.59s/it]
2024-09-05 18:37:21,750 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.083,  Train_accy 75.07
2024-09-05 18:37:21,750 [foster.py] => do not weight align student!
2024-09-05 18:37:26,967 [foster.py] => darknet eval: 
2024-09-05 18:37:26,968 [foster.py] => CNN top1 curve: 82.57
2024-09-05 18:37:26,968 [foster.py] => CNN top5 curve: 97.93
2024-09-05 18:37:26,971 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 18:38:58,298 [foster.py] => Exemplar size: 2800
2024-09-05 18:38:58,298 [trainer.py] => CNN: {'total': 82.69, '00-99': 92.09, '100-119': 69.74, '120-139': 46.22, 'old': 88.49, 'new': 46.22}
2024-09-05 18:38:58,298 [trainer.py] => NME: {'total': 88.67, '00-99': 89.23, '100-119': 88.6, '120-139': 85.78, 'old': 89.12, 'new': 85.78}
2024-09-05 18:38:58,298 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69]
2024-09-05 18:38:58,298 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05]
2024-09-05 18:38:58,299 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67]
2024-09-05 18:38:58,299 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72]

Average Accuracy (CNN): 86.53
Average Accuracy (NME): 90.12
2024-09-05 18:38:58,299 [trainer.py] => Average Accuracy (CNN): 86.53
2024-09-05 18:38:58,299 [trainer.py] => Average Accuracy (NME): 90.12
2024-09-05 18:38:58,300 [trainer.py] => All params: 172012432
2024-09-05 18:38:58,301 [trainer.py] => Trainable params: 86121496
2024-09-05 18:38:59,897 [foster.py] => Learning on 140-160
2024-09-05 18:38:59,898 [foster.py] => All params: 172073932
2024-09-05 18:38:59,899 [foster.py] => Trainable params: 86167616
2024-09-05 18:38:59,947 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.979, Loss_clf 1.208, Loss_fe 3.400, Loss_kd 1.200, Train_accy 69.73, Test_accy 76.89:   0%|          | 0/20 [00:48<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.979, Loss_clf 1.208, Loss_fe 3.400, Loss_kd 1.200, Train_accy 69.73, Test_accy 76.89:   5%|▌         | 1/20 [00:48<15:23, 48.60s/it]
Task 3, Epoch 2/20 => Loss 3.176, Loss_clf 0.681, Loss_fe 1.097, Loss_kd 1.223, Train_accy 71.26:   5%|▌         | 1/20 [01:26<15:23, 48.60s/it]                 
Task 3, Epoch 2/20 => Loss 3.176, Loss_clf 0.681, Loss_fe 1.097, Loss_kd 1.223, Train_accy 71.26:  10%|█         | 2/20 [01:26<12:42, 42.37s/it]
Task 3, Epoch 3/20 => Loss 2.740, Loss_clf 0.567, Loss_fe 0.813, Loss_kd 1.190, Train_accy 72.58:  10%|█         | 2/20 [02:04<12:42, 42.37s/it]
Task 3, Epoch 3/20 => Loss 2.740, Loss_clf 0.567, Loss_fe 0.813, Loss_kd 1.190, Train_accy 72.58:  15%|█▌        | 3/20 [02:04<11:27, 40.44s/it]
Task 3, Epoch 4/20 => Loss 2.632, Loss_clf 0.547, Loss_fe 0.710, Loss_kd 1.203, Train_accy 73.39:  15%|█▌        | 3/20 [02:43<11:27, 40.44s/it]
Task 3, Epoch 4/20 => Loss 2.632, Loss_clf 0.547, Loss_fe 0.710, Loss_kd 1.203, Train_accy 73.39:  20%|██        | 4/20 [02:43<10:33, 39.59s/it]
Task 3, Epoch 5/20 => Loss 2.459, Loss_clf 0.476, Loss_fe 0.618, Loss_kd 1.194, Train_accy 73.71:  20%|██        | 4/20 [03:21<10:33, 39.59s/it]
Task 3, Epoch 5/20 => Loss 2.459, Loss_clf 0.476, Loss_fe 0.618, Loss_kd 1.194, Train_accy 73.71:  25%|██▌       | 5/20 [03:21<09:46, 39.13s/it]
Task 3, Epoch 6/20 => Loss 2.506, Loss_clf 0.514, Loss_fe 0.594, Loss_kd 1.223, Train_accy 73.84, Test_accy 79.32:  25%|██▌       | 5/20 [04:10<09:46, 39.13s/it]
Task 3, Epoch 6/20 => Loss 2.506, Loss_clf 0.514, Loss_fe 0.594, Loss_kd 1.223, Train_accy 73.84, Test_accy 79.32:  30%|███       | 6/20 [04:10<09:56, 42.62s/it]
Task 3, Epoch 7/20 => Loss 2.332, Loss_clf 0.450, Loss_fe 0.512, Loss_kd 1.199, Train_accy 75.35:  30%|███       | 6/20 [04:49<09:56, 42.62s/it]                 
Task 3, Epoch 7/20 => Loss 2.332, Loss_clf 0.450, Loss_fe 0.512, Loss_kd 1.199, Train_accy 75.35:  35%|███▌      | 7/20 [04:49<08:56, 41.25s/it]
Task 3, Epoch 8/20 => Loss 2.286, Loss_clf 0.443, Loss_fe 0.477, Loss_kd 1.195, Train_accy 75.32:  35%|███▌      | 7/20 [05:27<08:56, 41.25s/it]
Task 3, Epoch 8/20 => Loss 2.286, Loss_clf 0.443, Loss_fe 0.477, Loss_kd 1.195, Train_accy 75.32:  40%|████      | 8/20 [05:27<08:04, 40.34s/it]
Task 3, Epoch 9/20 => Loss 2.206, Loss_clf 0.405, Loss_fe 0.444, Loss_kd 1.188, Train_accy 75.56:  40%|████      | 8/20 [06:05<08:04, 40.34s/it]
Task 3, Epoch 9/20 => Loss 2.206, Loss_clf 0.405, Loss_fe 0.444, Loss_kd 1.188, Train_accy 75.56:  45%|████▌     | 9/20 [06:05<07:17, 39.74s/it]
Task 3, Epoch 10/20 => Loss 2.169, Loss_clf 0.407, Loss_fe 0.412, Loss_kd 1.182, Train_accy 76.02:  45%|████▌     | 9/20 [06:44<07:17, 39.74s/it]
Task 3, Epoch 10/20 => Loss 2.169, Loss_clf 0.407, Loss_fe 0.412, Loss_kd 1.182, Train_accy 76.02:  50%|█████     | 10/20 [06:44<06:33, 39.33s/it]
Task 3, Epoch 11/20 => Loss 2.066, Loss_clf 0.366, Loss_fe 0.371, Loss_kd 1.163, Train_accy 75.97, Test_accy 80.65:  50%|█████     | 10/20 [07:33<06:33, 39.33s/it]
Task 3, Epoch 11/20 => Loss 2.066, Loss_clf 0.366, Loss_fe 0.371, Loss_kd 1.163, Train_accy 75.97, Test_accy 80.65:  55%|█████▌    | 11/20 [07:33<06:22, 42.46s/it]
Task 3, Epoch 12/20 => Loss 2.091, Loss_clf 0.377, Loss_fe 0.367, Loss_kd 1.179, Train_accy 76.80:  55%|█████▌    | 11/20 [08:12<06:22, 42.46s/it]                 
Task 3, Epoch 12/20 => Loss 2.091, Loss_clf 0.377, Loss_fe 0.367, Loss_kd 1.179, Train_accy 76.80:  60%|██████    | 12/20 [08:12<05:29, 41.23s/it]
Task 3, Epoch 13/20 => Loss 2.179, Loss_clf 0.397, Loss_fe 0.399, Loss_kd 1.210, Train_accy 76.80:  60%|██████    | 12/20 [08:50<05:29, 41.23s/it]
Task 3, Epoch 13/20 => Loss 2.179, Loss_clf 0.397, Loss_fe 0.399, Loss_kd 1.210, Train_accy 76.80:  65%|██████▌   | 13/20 [08:50<04:42, 40.37s/it]
Task 3, Epoch 14/20 => Loss 1.919, Loss_clf 0.318, Loss_fe 0.296, Loss_kd 1.143, Train_accy 77.80:  65%|██████▌   | 13/20 [09:29<04:42, 40.37s/it]
Task 3, Epoch 14/20 => Loss 1.919, Loss_clf 0.318, Loss_fe 0.296, Loss_kd 1.143, Train_accy 77.80:  70%|███████   | 14/20 [09:29<03:58, 39.78s/it]
Task 3, Epoch 15/20 => Loss 2.060, Loss_clf 0.367, Loss_fe 0.326, Loss_kd 1.196, Train_accy 77.23:  70%|███████   | 14/20 [10:07<03:58, 39.78s/it]
Task 3, Epoch 15/20 => Loss 2.060, Loss_clf 0.367, Loss_fe 0.326, Loss_kd 1.196, Train_accy 77.23:  75%|███████▌  | 15/20 [10:07<03:16, 39.37s/it]
Task 3, Epoch 16/20 => Loss 2.053, Loss_clf 0.358, Loss_fe 0.333, Loss_kd 1.192, Train_accy 76.83, Test_accy 79.75:  75%|███████▌  | 15/20 [10:57<03:16, 39.37s/it]
Task 3, Epoch 16/20 => Loss 2.053, Loss_clf 0.358, Loss_fe 0.333, Loss_kd 1.192, Train_accy 76.83, Test_accy 79.75:  80%|████████  | 16/20 [10:57<02:49, 42.41s/it]
Task 3, Epoch 17/20 => Loss 2.062, Loss_clf 0.365, Loss_fe 0.324, Loss_kd 1.201, Train_accy 76.53:  80%|████████  | 16/20 [11:35<02:49, 42.41s/it]                 
Task 3, Epoch 17/20 => Loss 2.062, Loss_clf 0.365, Loss_fe 0.324, Loss_kd 1.201, Train_accy 76.53:  85%|████████▌ | 17/20 [11:35<02:03, 41.20s/it]
Task 3, Epoch 18/20 => Loss 2.079, Loss_clf 0.377, Loss_fe 0.346, Loss_kd 1.187, Train_accy 76.21:  85%|████████▌ | 17/20 [12:13<02:03, 41.20s/it]
Task 3, Epoch 18/20 => Loss 2.079, Loss_clf 0.377, Loss_fe 0.346, Loss_kd 1.187, Train_accy 76.21:  90%|█████████ | 18/20 [12:13<01:20, 40.37s/it]
Task 3, Epoch 19/20 => Loss 2.088, Loss_clf 0.392, Loss_fe 0.344, Loss_kd 1.183, Train_accy 75.94:  90%|█████████ | 18/20 [12:52<01:20, 40.37s/it]
Task 3, Epoch 19/20 => Loss 2.088, Loss_clf 0.392, Loss_fe 0.344, Loss_kd 1.183, Train_accy 75.94:  95%|█████████▌| 19/20 [12:52<00:39, 39.79s/it]
Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94:  95%|█████████▌| 19/20 [13:30<00:39, 39.79s/it]
Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94: 100%|██████████| 20/20 [13:30<00:00, 39.38s/it]
Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94: 100%|██████████| 20/20 [13:30<00:00, 40.54s/it]
2024-09-05 18:52:30,706 [foster.py] => Task 3, Epoch 20/20 => Loss 2.025, Loss_clf 0.347, Loss_fe 0.321, Loss_kd 1.188, Train_accy 76.94
2024-09-05 18:52:30,708 [foster.py] => do not weight align teacher!
2024-09-05 18:52:30,712 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.449,  Train_accy 66.75, Test_accy 78.16:   0%|          | 0/20 [00:54<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.449,  Train_accy 66.75, Test_accy 78.16:   5%|▌         | 1/20 [00:54<17:08, 54.15s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.309,  Train_accy 71.13:   5%|▌         | 1/20 [01:42<17:08, 54.15s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.309,  Train_accy 71.13:  10%|█         | 2/20 [01:42<15:11, 50.66s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.261,  Train_accy 72.88:  10%|█         | 2/20 [02:30<15:11, 50.66s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.261,  Train_accy 72.88:  15%|█▌        | 3/20 [02:30<14:02, 49.56s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.264,  Train_accy 72.47:  15%|█▌        | 3/20 [03:18<14:02, 49.56s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.264,  Train_accy 72.47:  20%|██        | 4/20 [03:18<13:05, 49.07s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.292,  Train_accy 72.15:  20%|██        | 4/20 [04:07<13:05, 49.07s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.292,  Train_accy 72.15:  25%|██▌       | 5/20 [04:07<12:12, 48.80s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.250,  Train_accy 72.66, Test_accy 78.90:  25%|██▌       | 5/20 [05:01<12:12, 48.80s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.250,  Train_accy 72.66, Test_accy 78.90:  30%|███       | 6/20 [05:01<11:49, 50.65s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.264,  Train_accy 72.90:  30%|███       | 6/20 [05:49<11:49, 50.65s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.264,  Train_accy 72.90:  35%|███▌      | 7/20 [05:49<10:48, 49.88s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.266,  Train_accy 71.83:  35%|███▌      | 7/20 [06:38<10:48, 49.88s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.266,  Train_accy 71.83:  40%|████      | 8/20 [06:38<09:52, 49.38s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.267,  Train_accy 72.55:  40%|████      | 8/20 [07:26<09:52, 49.38s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.267,  Train_accy 72.55:  45%|████▌     | 9/20 [07:26<08:59, 49.06s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.246,  Train_accy 73.04:  45%|████▌     | 9/20 [08:14<08:59, 49.06s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.246,  Train_accy 73.04:  50%|█████     | 10/20 [08:14<08:08, 48.81s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.280,  Train_accy 72.37, Test_accy 78.90:  50%|█████     | 10/20 [09:08<08:08, 48.81s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.280,  Train_accy 72.37, Test_accy 78.90:  55%|█████▌    | 11/20 [09:08<07:34, 50.46s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.246,  Train_accy 73.58:  55%|█████▌    | 11/20 [09:57<07:34, 50.46s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.246,  Train_accy 73.58:  60%|██████    | 12/20 [09:57<06:38, 49.80s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.247,  Train_accy 73.52:  60%|██████    | 12/20 [10:45<06:38, 49.80s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.247,  Train_accy 73.52:  65%|██████▌   | 13/20 [10:45<05:45, 49.33s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.231,  Train_accy 73.39:  65%|██████▌   | 13/20 [11:33<05:45, 49.33s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.231,  Train_accy 73.39:  70%|███████   | 14/20 [11:33<04:53, 49.00s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.210,  Train_accy 73.95:  70%|███████   | 14/20 [12:21<04:53, 49.00s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.210,  Train_accy 73.95:  75%|███████▌  | 15/20 [12:21<04:03, 48.79s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.224,  Train_accy 73.66, Test_accy 78.95:  75%|███████▌  | 15/20 [13:16<04:03, 48.79s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.224,  Train_accy 73.66, Test_accy 78.95:  80%|████████  | 16/20 [13:16<03:21, 50.44s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.240,  Train_accy 74.22:  80%|████████  | 16/20 [14:04<03:21, 50.44s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.240,  Train_accy 74.22:  85%|████████▌ | 17/20 [14:04<02:29, 49.80s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.243,  Train_accy 73.79:  85%|████████▌ | 17/20 [14:52<02:29, 49.80s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.243,  Train_accy 73.79:  90%|█████████ | 18/20 [14:52<01:38, 49.33s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.249,  Train_accy 73.58:  90%|█████████ | 18/20 [15:41<01:38, 49.33s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.249,  Train_accy 73.58:  95%|█████████▌| 19/20 [15:41<00:49, 49.00s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70:  95%|█████████▌| 19/20 [16:29<00:49, 49.00s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70: 100%|██████████| 20/20 [16:29<00:00, 48.78s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70: 100%|██████████| 20/20 [16:29<00:00, 49.46s/it]
2024-09-05 19:09:01,455 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.222,  Train_accy 74.70
2024-09-05 19:09:01,455 [foster.py] => do not weight align student!
2024-09-05 19:09:07,426 [foster.py] => darknet eval: 
2024-09-05 19:09:07,427 [foster.py] => CNN top1 curve: 78.95
2024-09-05 19:09:07,427 [foster.py] => CNN top5 curve: 97.3
2024-09-05 19:09:07,430 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 19:10:52,362 [foster.py] => Exemplar size: 3200
2024-09-05 19:10:52,363 [trainer.py] => CNN: {'total': 79.69, '00-99': 90.99, '100-119': 80.7, '120-139': 67.11, '140-159': 36.4, 'old': 86.29, 'new': 36.4}
2024-09-05 19:10:52,363 [trainer.py] => NME: {'total': 88.05, '00-99': 87.88, '100-119': 87.72, '120-139': 86.22, '140-159': 90.8, 'old': 87.63, 'new': 90.8}
2024-09-05 19:10:52,363 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69, 79.69]
2024-09-05 19:10:52,363 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05, 97.62]
2024-09-05 19:10:52,363 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67, 88.05]
2024-09-05 19:10:52,363 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72, 98.78]

Average Accuracy (CNN): 84.82
Average Accuracy (NME): 89.6
2024-09-05 19:10:52,363 [trainer.py] => Average Accuracy (CNN): 84.82
2024-09-05 19:10:52,363 [trainer.py] => Average Accuracy (NME): 89.6
2024-09-05 19:10:52,364 [trainer.py] => All params: 172073932
2024-09-05 19:10:52,365 [trainer.py] => Trainable params: 86167616
2024-09-05 19:10:53,902 [foster.py] => Learning on 160-180
2024-09-05 19:10:53,904 [foster.py] => All params: 172135432
2024-09-05 19:10:53,905 [foster.py] => Trainable params: 86213736
2024-09-05 19:10:53,953 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 6.110, Loss_clf 1.174, Loss_fe 3.456, Loss_kd 1.315, Train_accy 69.24, Test_accy 78.52:   0%|          | 0/20 [00:54<?, ?it/s]
Task 4, Epoch 1/20 => Loss 6.110, Loss_clf 1.174, Loss_fe 3.456, Loss_kd 1.315, Train_accy 69.24, Test_accy 78.52:   5%|▌         | 1/20 [00:54<17:13, 54.42s/it]
Task 4, Epoch 2/20 => Loss 3.272, Loss_clf 0.665, Loss_fe 1.151, Loss_kd 1.294, Train_accy 73.04:   5%|▌         | 1/20 [01:37<17:13, 54.42s/it]                 
Task 4, Epoch 2/20 => Loss 3.272, Loss_clf 0.665, Loss_fe 1.151, Loss_kd 1.294, Train_accy 73.04:  10%|█         | 2/20 [01:37<14:15, 47.50s/it]
Task 4, Epoch 3/20 => Loss 2.963, Loss_clf 0.625, Loss_fe 0.876, Loss_kd 1.300, Train_accy 73.45:  10%|█         | 2/20 [02:19<14:15, 47.50s/it]
Task 4, Epoch 3/20 => Loss 2.963, Loss_clf 0.625, Loss_fe 0.876, Loss_kd 1.300, Train_accy 73.45:  15%|█▌        | 3/20 [02:19<12:51, 45.35s/it]
Task 4, Epoch 4/20 => Loss 2.753, Loss_clf 0.551, Loss_fe 0.737, Loss_kd 1.303, Train_accy 74.94:  15%|█▌        | 3/20 [03:02<12:51, 45.35s/it]
Task 4, Epoch 4/20 => Loss 2.753, Loss_clf 0.551, Loss_fe 0.737, Loss_kd 1.303, Train_accy 74.94:  20%|██        | 4/20 [03:02<11:49, 44.37s/it]
Task 4, Epoch 5/20 => Loss 2.627, Loss_clf 0.517, Loss_fe 0.661, Loss_kd 1.289, Train_accy 75.20:  20%|██        | 4/20 [03:45<11:49, 44.37s/it]
Task 4, Epoch 5/20 => Loss 2.627, Loss_clf 0.517, Loss_fe 0.661, Loss_kd 1.289, Train_accy 75.20:  25%|██▌       | 5/20 [03:45<10:57, 43.83s/it]
Task 4, Epoch 6/20 => Loss 2.564, Loss_clf 0.500, Loss_fe 0.607, Loss_kd 1.295, Train_accy 75.28, Test_accy 80.03:  25%|██▌       | 5/20 [04:40<10:57, 43.83s/it]
Task 4, Epoch 6/20 => Loss 2.564, Loss_clf 0.500, Loss_fe 0.607, Loss_kd 1.295, Train_accy 75.28, Test_accy 80.03:  30%|███       | 6/20 [04:40<11:07, 47.71s/it]
Task 4, Epoch 7/20 => Loss 2.466, Loss_clf 0.487, Loss_fe 0.553, Loss_kd 1.268, Train_accy 76.29:  30%|███       | 6/20 [05:23<11:07, 47.71s/it]                 
Task 4, Epoch 7/20 => Loss 2.466, Loss_clf 0.487, Loss_fe 0.553, Loss_kd 1.268, Train_accy 76.29:  35%|███▌      | 7/20 [05:23<09:59, 46.13s/it]
Task 4, Epoch 8/20 => Loss 2.340, Loss_clf 0.436, Loss_fe 0.484, Loss_kd 1.262, Train_accy 76.19:  35%|███▌      | 7/20 [06:06<09:59, 46.13s/it]
Task 4, Epoch 8/20 => Loss 2.340, Loss_clf 0.436, Loss_fe 0.484, Loss_kd 1.262, Train_accy 76.19:  40%|████      | 8/20 [06:06<09:01, 45.09s/it]
Task 4, Epoch 9/20 => Loss 2.346, Loss_clf 0.446, Loss_fe 0.477, Loss_kd 1.265, Train_accy 76.29:  40%|████      | 8/20 [06:49<09:01, 45.09s/it]
Task 4, Epoch 9/20 => Loss 2.346, Loss_clf 0.446, Loss_fe 0.477, Loss_kd 1.265, Train_accy 76.29:  45%|████▌     | 9/20 [06:49<08:08, 44.38s/it]
Task 4, Epoch 10/20 => Loss 2.310, Loss_clf 0.436, Loss_fe 0.446, Loss_kd 1.270, Train_accy 75.78:  45%|████▌     | 9/20 [07:32<08:08, 44.38s/it]
Task 4, Epoch 10/20 => Loss 2.310, Loss_clf 0.436, Loss_fe 0.446, Loss_kd 1.270, Train_accy 75.78:  50%|█████     | 10/20 [07:32<07:19, 43.93s/it]
Task 4, Epoch 11/20 => Loss 2.290, Loss_clf 0.420, Loss_fe 0.426, Loss_kd 1.284, Train_accy 76.21, Test_accy 79.75:  50%|█████     | 10/20 [08:27<07:19, 43.93s/it]
Task 4, Epoch 11/20 => Loss 2.290, Loss_clf 0.420, Loss_fe 0.426, Loss_kd 1.284, Train_accy 76.21, Test_accy 79.75:  55%|█████▌    | 11/20 [08:27<07:06, 47.38s/it]
Task 4, Epoch 12/20 => Loss 2.288, Loss_clf 0.428, Loss_fe 0.425, Loss_kd 1.276, Train_accy 75.78:  55%|█████▌    | 11/20 [09:10<07:06, 47.38s/it]                 
Task 4, Epoch 12/20 => Loss 2.288, Loss_clf 0.428, Loss_fe 0.425, Loss_kd 1.276, Train_accy 75.78:  60%|██████    | 12/20 [09:10<06:07, 45.99s/it]
Task 4, Epoch 13/20 => Loss 2.161, Loss_clf 0.373, Loss_fe 0.371, Loss_kd 1.259, Train_accy 76.67:  60%|██████    | 12/20 [09:53<06:07, 45.99s/it]
Task 4, Epoch 13/20 => Loss 2.161, Loss_clf 0.373, Loss_fe 0.371, Loss_kd 1.259, Train_accy 76.67:  65%|██████▌   | 13/20 [09:53<05:15, 45.04s/it]
Task 4, Epoch 14/20 => Loss 2.236, Loss_clf 0.403, Loss_fe 0.381, Loss_kd 1.291, Train_accy 76.86:  65%|██████▌   | 13/20 [10:36<05:15, 45.04s/it]
Task 4, Epoch 14/20 => Loss 2.236, Loss_clf 0.403, Loss_fe 0.381, Loss_kd 1.291, Train_accy 76.86:  70%|███████   | 14/20 [10:36<04:26, 44.38s/it]
Task 4, Epoch 15/20 => Loss 2.234, Loss_clf 0.405, Loss_fe 0.385, Loss_kd 1.284, Train_accy 76.91:  70%|███████   | 14/20 [11:18<04:26, 44.38s/it]
Task 4, Epoch 15/20 => Loss 2.234, Loss_clf 0.405, Loss_fe 0.385, Loss_kd 1.284, Train_accy 76.91:  75%|███████▌  | 15/20 [11:18<03:39, 43.91s/it]
Task 4, Epoch 16/20 => Loss 2.187, Loss_clf 0.383, Loss_fe 0.352, Loss_kd 1.291, Train_accy 77.34, Test_accy 79.89:  75%|███████▌  | 15/20 [12:14<03:39, 43.91s/it]
Task 4, Epoch 16/20 => Loss 2.187, Loss_clf 0.383, Loss_fe 0.352, Loss_kd 1.291, Train_accy 77.34, Test_accy 79.89:  80%|████████  | 16/20 [12:14<03:09, 47.30s/it]
Task 4, Epoch 17/20 => Loss 2.171, Loss_clf 0.379, Loss_fe 0.352, Loss_kd 1.281, Train_accy 77.27:  80%|████████  | 16/20 [12:56<03:09, 47.30s/it]                 
Task 4, Epoch 17/20 => Loss 2.171, Loss_clf 0.379, Loss_fe 0.352, Loss_kd 1.281, Train_accy 77.27:  85%|████████▌ | 17/20 [12:56<02:17, 45.95s/it]
Task 4, Epoch 18/20 => Loss 2.200, Loss_clf 0.402, Loss_fe 0.353, Loss_kd 1.285, Train_accy 76.41:  85%|████████▌ | 17/20 [13:39<02:17, 45.95s/it]
Task 4, Epoch 18/20 => Loss 2.200, Loss_clf 0.402, Loss_fe 0.353, Loss_kd 1.285, Train_accy 76.41:  90%|█████████ | 18/20 [13:39<01:30, 45.01s/it]
Task 4, Epoch 19/20 => Loss 2.165, Loss_clf 0.384, Loss_fe 0.348, Loss_kd 1.273, Train_accy 77.51:  90%|█████████ | 18/20 [14:22<01:30, 45.01s/it]
Task 4, Epoch 19/20 => Loss 2.165, Loss_clf 0.384, Loss_fe 0.348, Loss_kd 1.273, Train_accy 77.51:  95%|█████████▌| 19/20 [14:22<00:44, 44.35s/it]
Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26:  95%|█████████▌| 19/20 [15:05<00:44, 44.35s/it]
Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26: 100%|██████████| 20/20 [15:05<00:00, 43.89s/it]
Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26: 100%|██████████| 20/20 [15:05<00:00, 45.27s/it]
2024-09-05 19:25:59,289 [foster.py] => Task 4, Epoch 20/20 => Loss 2.078, Loss_clf 0.351, Loss_fe 0.318, Loss_kd 1.253, Train_accy 78.26
2024-09-05 19:25:59,290 [foster.py] => do not weight align teacher!
2024-09-05 19:25:59,295 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.442,  Train_accy 68.13, Test_accy 79.09:   0%|          | 0/20 [01:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.442,  Train_accy 68.13, Test_accy 79.09:   5%|▌         | 1/20 [01:00<19:08, 60.45s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.356,  Train_accy 71.26:   5%|▌         | 1/20 [01:54<19:08, 60.45s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.356,  Train_accy 71.26:  10%|█         | 2/20 [01:54<16:58, 56.56s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.339,  Train_accy 72.15:  10%|█         | 2/20 [02:48<16:58, 56.56s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.339,  Train_accy 72.15:  15%|█▌        | 3/20 [02:48<15:40, 55.32s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.288,  Train_accy 72.46:  15%|█▌        | 3/20 [03:41<15:40, 55.32s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.288,  Train_accy 72.46:  20%|██        | 4/20 [03:41<14:35, 54.74s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.315,  Train_accy 73.18:  20%|██        | 4/20 [04:35<14:35, 54.74s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.315,  Train_accy 73.18:  25%|██▌       | 5/20 [04:35<13:36, 54.42s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.307,  Train_accy 73.76, Test_accy 79.14:  25%|██▌       | 5/20 [05:36<13:36, 54.42s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.307,  Train_accy 73.76, Test_accy 79.14:  30%|███       | 6/20 [05:36<13:10, 56.48s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.313,  Train_accy 73.86:  30%|███       | 6/20 [06:30<13:10, 56.48s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.313,  Train_accy 73.86:  35%|███▌      | 7/20 [06:30<12:03, 55.63s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.288,  Train_accy 73.64:  35%|███▌      | 7/20 [07:24<12:03, 55.63s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.288,  Train_accy 73.64:  40%|████      | 8/20 [07:24<11:00, 55.07s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.288,  Train_accy 74.12:  40%|████      | 8/20 [08:17<11:00, 55.07s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.288,  Train_accy 74.12:  45%|████▌     | 9/20 [08:17<10:01, 54.70s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.282,  Train_accy 74.00:  45%|████▌     | 9/20 [09:11<10:01, 54.70s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.282,  Train_accy 74.00:  50%|█████     | 10/20 [09:11<09:04, 54.44s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.304,  Train_accy 73.26, Test_accy 79.14:  50%|█████     | 10/20 [10:12<09:04, 54.44s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.304,  Train_accy 73.26, Test_accy 79.14:  55%|█████▌    | 11/20 [10:12<08:26, 56.32s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.305,  Train_accy 74.27:  55%|█████▌    | 11/20 [11:06<08:26, 56.32s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.305,  Train_accy 74.27:  60%|██████    | 12/20 [11:06<07:24, 55.58s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.278,  Train_accy 74.84:  60%|██████    | 12/20 [12:00<07:24, 55.58s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.278,  Train_accy 74.84:  65%|██████▌   | 13/20 [12:00<06:25, 55.08s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.335,  Train_accy 73.76:  65%|██████▌   | 13/20 [12:54<06:25, 55.08s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.335,  Train_accy 73.76:  70%|███████   | 14/20 [12:54<05:28, 54.71s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.277,  Train_accy 74.27:  70%|███████   | 14/20 [13:47<05:28, 54.71s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.277,  Train_accy 74.27:  75%|███████▌  | 15/20 [13:47<04:32, 54.47s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.286,  Train_accy 73.88, Test_accy 79.28:  75%|███████▌  | 15/20 [14:48<04:32, 54.47s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.286,  Train_accy 73.88, Test_accy 79.28:  80%|████████  | 16/20 [14:48<03:45, 56.30s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.286,  Train_accy 74.22:  80%|████████  | 16/20 [15:42<03:45, 56.30s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.286,  Train_accy 74.22:  85%|████████▌ | 17/20 [15:42<02:46, 55.57s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.283,  Train_accy 73.40:  85%|████████▌ | 17/20 [16:36<02:46, 55.57s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.283,  Train_accy 73.40:  90%|█████████ | 18/20 [16:36<01:50, 55.08s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.278,  Train_accy 74.56:  90%|█████████ | 18/20 [17:30<01:50, 55.08s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.278,  Train_accy 74.56:  95%|█████████▌| 19/20 [17:30<00:54, 54.72s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59:  95%|█████████▌| 19/20 [18:24<00:54, 54.72s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59: 100%|██████████| 20/20 [18:24<00:00, 54.47s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59: 100%|██████████| 20/20 [18:24<00:00, 55.21s/it]
2024-09-05 19:44:24,814 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.320,  Train_accy 73.59
2024-09-05 19:44:24,815 [foster.py] => do not weight align student!
2024-09-05 19:44:31,431 [foster.py] => darknet eval: 
2024-09-05 19:44:31,432 [foster.py] => CNN top1 curve: 79.42
2024-09-05 19:44:31,432 [foster.py] => CNN top5 curve: 96.99
2024-09-05 19:44:31,435 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 19:46:28,190 [foster.py] => Exemplar size: 3600
2024-09-05 19:46:28,190 [trainer.py] => CNN: {'total': 79.7, '00-99': 90.4, '100-119': 85.09, '120-139': 76.44, '140-159': 66.8, '160-179': 37.55, 'old': 84.98, 'new': 37.55}
2024-09-05 19:46:28,190 [trainer.py] => NME: {'total': 88.35, '00-99': 88.64, '100-119': 87.72, '120-139': 85.78, '140-159': 89.2, '160-179': 89.03, 'old': 88.26, 'new': 89.03}
2024-09-05 19:46:28,190 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69, 79.69, 79.7]
2024-09-05 19:46:28,190 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05, 97.62, 97.32]
2024-09-05 19:46:28,190 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67, 88.05, 88.35]
2024-09-05 19:46:28,190 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72, 98.78, 98.5]

Average Accuracy (CNN): 83.79
Average Accuracy (NME): 89.35
2024-09-05 19:46:28,190 [trainer.py] => Average Accuracy (CNN): 83.79
2024-09-05 19:46:28,190 [trainer.py] => Average Accuracy (NME): 89.35
2024-09-05 19:46:28,192 [trainer.py] => All params: 172135432
2024-09-05 19:46:28,193 [trainer.py] => Trainable params: 86213736
2024-09-05 19:46:29,701 [foster.py] => Learning on 180-200
2024-09-05 19:46:29,703 [foster.py] => All params: 172196932
2024-09-05 19:46:29,704 [foster.py] => Trainable params: 86259856
2024-09-05 19:46:29,756 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 6.468, Loss_clf 1.173, Loss_fe 3.799, Loss_kd 1.346, Train_accy 69.84, Test_accy 78.75:   0%|          | 0/20 [00:59<?, ?it/s]
Task 5, Epoch 1/20 => Loss 6.468, Loss_clf 1.173, Loss_fe 3.799, Loss_kd 1.346, Train_accy 69.84, Test_accy 78.75:   5%|▌         | 1/20 [00:59<18:50, 59.48s/it]
Task 5, Epoch 2/20 => Loss 3.433, Loss_clf 0.689, Loss_fe 1.269, Loss_kd 1.327, Train_accy 72.83:   5%|▌         | 1/20 [01:45<18:50, 59.48s/it]                 
Task 5, Epoch 2/20 => Loss 3.433, Loss_clf 0.689, Loss_fe 1.269, Loss_kd 1.327, Train_accy 72.83:  10%|█         | 2/20 [01:45<15:32, 51.81s/it]
Task 5, Epoch 3/20 => Loss 3.015, Loss_clf 0.607, Loss_fe 0.936, Loss_kd 1.325, Train_accy 73.77:  10%|█         | 2/20 [02:32<15:32, 51.81s/it]
Task 5, Epoch 3/20 => Loss 3.015, Loss_clf 0.607, Loss_fe 0.936, Loss_kd 1.325, Train_accy 73.77:  15%|█▌        | 3/20 [02:32<14:01, 49.47s/it]
Task 5, Epoch 4/20 => Loss 2.829, Loss_clf 0.558, Loss_fe 0.784, Loss_kd 1.338, Train_accy 74.49:  15%|█▌        | 3/20 [03:19<14:01, 49.47s/it]
Task 5, Epoch 4/20 => Loss 2.829, Loss_clf 0.558, Loss_fe 0.784, Loss_kd 1.338, Train_accy 74.49:  20%|██        | 4/20 [03:19<12:54, 48.41s/it]
Task 5, Epoch 5/20 => Loss 2.720, Loss_clf 0.528, Loss_fe 0.699, Loss_kd 1.344, Train_accy 73.77:  20%|██        | 4/20 [04:06<12:54, 48.41s/it]
Task 5, Epoch 5/20 => Loss 2.720, Loss_clf 0.528, Loss_fe 0.699, Loss_kd 1.344, Train_accy 73.77:  25%|██▌       | 5/20 [04:06<11:57, 47.86s/it]
Task 5, Epoch 6/20 => Loss 2.539, Loss_clf 0.486, Loss_fe 0.607, Loss_kd 1.301, Train_accy 75.07, Test_accy 79.64:  25%|██▌       | 5/20 [05:06<11:57, 47.86s/it]
Task 5, Epoch 6/20 => Loss 2.539, Loss_clf 0.486, Loss_fe 0.607, Loss_kd 1.301, Train_accy 75.07, Test_accy 79.64:  30%|███       | 6/20 [05:06<12:10, 52.16s/it]
Task 5, Epoch 7/20 => Loss 2.631, Loss_clf 0.506, Loss_fe 0.626, Loss_kd 1.349, Train_accy 74.12:  30%|███       | 6/20 [05:53<12:10, 52.16s/it]                 
Task 5, Epoch 7/20 => Loss 2.631, Loss_clf 0.506, Loss_fe 0.626, Loss_kd 1.349, Train_accy 74.12:  35%|███▌      | 7/20 [05:53<10:55, 50.43s/it]
Task 5, Epoch 8/20 => Loss 2.466, Loss_clf 0.466, Loss_fe 0.522, Loss_kd 1.330, Train_accy 75.22:  35%|███▌      | 7/20 [06:40<10:55, 50.43s/it]
Task 5, Epoch 8/20 => Loss 2.466, Loss_clf 0.466, Loss_fe 0.522, Loss_kd 1.330, Train_accy 75.22:  40%|████      | 8/20 [06:40<09:51, 49.29s/it]
Task 5, Epoch 9/20 => Loss 2.490, Loss_clf 0.475, Loss_fe 0.515, Loss_kd 1.350, Train_accy 75.18:  40%|████      | 8/20 [07:27<09:51, 49.29s/it]
Task 5, Epoch 9/20 => Loss 2.490, Loss_clf 0.475, Loss_fe 0.515, Loss_kd 1.350, Train_accy 75.18:  45%|████▌     | 9/20 [07:27<08:53, 48.54s/it]
Task 5, Epoch 10/20 => Loss 2.399, Loss_clf 0.452, Loss_fe 0.483, Loss_kd 1.318, Train_accy 75.29:  45%|████▌     | 9/20 [08:14<08:53, 48.54s/it]
Task 5, Epoch 10/20 => Loss 2.399, Loss_clf 0.452, Loss_fe 0.483, Loss_kd 1.318, Train_accy 75.29:  50%|█████     | 10/20 [08:14<08:00, 48.05s/it]
Task 5, Epoch 11/20 => Loss 2.361, Loss_clf 0.438, Loss_fe 0.450, Loss_kd 1.326, Train_accy 75.83, Test_accy 79.13:  50%|█████     | 10/20 [09:14<08:00, 48.05s/it]
Task 5, Epoch 11/20 => Loss 2.361, Loss_clf 0.438, Loss_fe 0.450, Loss_kd 1.326, Train_accy 75.83, Test_accy 79.13:  55%|█████▌    | 11/20 [09:14<07:46, 51.88s/it]
Task 5, Epoch 12/20 => Loss 2.289, Loss_clf 0.422, Loss_fe 0.415, Loss_kd 1.307, Train_accy 75.55:  55%|█████▌    | 11/20 [10:01<07:46, 51.88s/it]                 
Task 5, Epoch 12/20 => Loss 2.289, Loss_clf 0.422, Loss_fe 0.415, Loss_kd 1.307, Train_accy 75.55:  60%|██████    | 12/20 [10:01<06:42, 50.37s/it]
Task 5, Epoch 13/20 => Loss 2.373, Loss_clf 0.431, Loss_fe 0.435, Loss_kd 1.357, Train_accy 76.12:  60%|██████    | 12/20 [10:48<06:42, 50.37s/it]
Task 5, Epoch 13/20 => Loss 2.373, Loss_clf 0.431, Loss_fe 0.435, Loss_kd 1.357, Train_accy 76.12:  65%|██████▌   | 13/20 [10:48<05:45, 49.32s/it]
Task 5, Epoch 14/20 => Loss 2.285, Loss_clf 0.426, Loss_fe 0.390, Loss_kd 1.323, Train_accy 75.97:  65%|██████▌   | 13/20 [11:35<05:45, 49.32s/it]
Task 5, Epoch 14/20 => Loss 2.285, Loss_clf 0.426, Loss_fe 0.390, Loss_kd 1.323, Train_accy 75.97:  70%|███████   | 14/20 [11:35<04:51, 48.57s/it]
Task 5, Epoch 15/20 => Loss 2.314, Loss_clf 0.429, Loss_fe 0.401, Loss_kd 1.335, Train_accy 76.71:  70%|███████   | 14/20 [12:22<04:51, 48.57s/it]
Task 5, Epoch 15/20 => Loss 2.314, Loss_clf 0.429, Loss_fe 0.401, Loss_kd 1.335, Train_accy 76.71:  75%|███████▌  | 15/20 [12:22<04:00, 48.07s/it]
Task 5, Epoch 16/20 => Loss 2.240, Loss_clf 0.407, Loss_fe 0.369, Loss_kd 1.318, Train_accy 76.98, Test_accy 79.18:  75%|███████▌  | 15/20 [13:22<04:00, 48.07s/it]
Task 5, Epoch 16/20 => Loss 2.240, Loss_clf 0.407, Loss_fe 0.369, Loss_kd 1.318, Train_accy 76.98, Test_accy 79.18:  80%|████████  | 16/20 [13:22<03:27, 51.81s/it]
Task 5, Epoch 17/20 => Loss 2.240, Loss_clf 0.404, Loss_fe 0.370, Loss_kd 1.319, Train_accy 76.87:  80%|████████  | 16/20 [14:09<03:27, 51.81s/it]                 
Task 5, Epoch 17/20 => Loss 2.240, Loss_clf 0.404, Loss_fe 0.370, Loss_kd 1.319, Train_accy 76.87:  85%|████████▌ | 17/20 [14:09<02:30, 50.31s/it]
Task 5, Epoch 18/20 => Loss 2.187, Loss_clf 0.387, Loss_fe 0.344, Loss_kd 1.310, Train_accy 76.74:  85%|████████▌ | 17/20 [14:56<02:30, 50.31s/it]
Task 5, Epoch 18/20 => Loss 2.187, Loss_clf 0.387, Loss_fe 0.344, Loss_kd 1.310, Train_accy 76.74:  90%|█████████ | 18/20 [14:56<01:38, 49.27s/it]
Task 5, Epoch 19/20 => Loss 2.157, Loss_clf 0.367, Loss_fe 0.320, Loss_kd 1.323, Train_accy 77.86:  90%|█████████ | 18/20 [15:43<01:38, 49.27s/it]
Task 5, Epoch 19/20 => Loss 2.157, Loss_clf 0.367, Loss_fe 0.320, Loss_kd 1.323, Train_accy 77.86:  95%|█████████▌| 19/20 [15:43<00:48, 48.54s/it]
Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88:  95%|█████████▌| 19/20 [16:30<00:48, 48.54s/it]
Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88: 100%|██████████| 20/20 [16:30<00:00, 48.04s/it]
Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88: 100%|██████████| 20/20 [16:30<00:00, 49.52s/it]
2024-09-05 20:03:00,102 [foster.py] => Task 5, Epoch 20/20 => Loss 2.156, Loss_clf 0.365, Loss_fe 0.336, Loss_kd 1.310, Train_accy 77.88
2024-09-05 20:03:00,104 [foster.py] => do not weight align teacher!
2024-09-05 20:03:00,109 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.452,  Train_accy 70.30, Test_accy 78.33:   0%|          | 0/20 [01:06<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.452,  Train_accy 70.30, Test_accy 78.33:   5%|▌         | 1/20 [01:06<20:57, 66.19s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.399,  Train_accy 71.70:   5%|▌         | 1/20 [02:05<20:57, 66.19s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.399,  Train_accy 71.70:  10%|█         | 2/20 [02:05<18:34, 61.89s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.363,  Train_accy 72.76:  10%|█         | 2/20 [03:03<18:34, 61.89s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.363,  Train_accy 72.76:  15%|█▌        | 3/20 [03:03<17:08, 60.52s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.367,  Train_accy 73.15:  15%|█▌        | 3/20 [04:02<17:08, 60.52s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.367,  Train_accy 73.15:  20%|██        | 4/20 [04:02<15:58, 59.91s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.355,  Train_accy 73.31:  20%|██        | 4/20 [05:01<15:58, 59.91s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.355,  Train_accy 73.31:  25%|██▌       | 5/20 [05:01<14:53, 59.57s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.326,  Train_accy 73.99, Test_accy 78.97:  25%|██▌       | 5/20 [06:08<14:53, 59.57s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.326,  Train_accy 73.99, Test_accy 78.97:  30%|███       | 6/20 [06:08<14:25, 61.82s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.396,  Train_accy 73.70:  30%|███       | 6/20 [07:06<14:25, 61.82s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.396,  Train_accy 73.70:  35%|███▌      | 7/20 [07:06<13:11, 60.87s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.360,  Train_accy 73.37:  35%|███▌      | 7/20 [08:05<13:11, 60.87s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.360,  Train_accy 73.37:  40%|████      | 8/20 [08:05<12:03, 60.27s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.383,  Train_accy 73.13:  40%|████      | 8/20 [09:04<12:03, 60.27s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.383,  Train_accy 73.13:  45%|████▌     | 9/20 [09:04<10:58, 59.85s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.360,  Train_accy 72.87:  45%|████▌     | 9/20 [10:03<10:58, 59.85s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.360,  Train_accy 72.87:  50%|█████     | 10/20 [10:03<09:55, 59.56s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.329,  Train_accy 73.81, Test_accy 78.84:  50%|█████     | 10/20 [11:09<09:55, 59.56s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.329,  Train_accy 73.81, Test_accy 78.84:  55%|█████▌    | 11/20 [11:09<09:14, 61.58s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.311,  Train_accy 74.08:  55%|█████▌    | 11/20 [12:08<09:14, 61.58s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.311,  Train_accy 74.08:  60%|██████    | 12/20 [12:08<08:06, 60.79s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.322,  Train_accy 74.03:  60%|██████    | 12/20 [13:07<08:06, 60.79s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.322,  Train_accy 74.03:  65%|██████▌   | 13/20 [13:07<07:01, 60.23s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.343,  Train_accy 73.84:  65%|██████▌   | 13/20 [14:06<07:01, 60.23s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.343,  Train_accy 73.84:  70%|███████   | 14/20 [14:06<05:59, 59.85s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.334,  Train_accy 73.95:  70%|███████   | 14/20 [15:05<05:59, 59.85s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.334,  Train_accy 73.95:  75%|███████▌  | 15/20 [15:05<04:57, 59.57s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.339,  Train_accy 74.28, Test_accy 78.71:  75%|███████▌  | 15/20 [16:12<04:57, 59.57s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.339,  Train_accy 74.28, Test_accy 78.71:  80%|████████  | 16/20 [16:12<04:06, 61.57s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.343,  Train_accy 74.08:  80%|████████  | 16/20 [17:10<04:06, 61.57s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.343,  Train_accy 74.08:  85%|████████▌ | 17/20 [17:10<03:02, 60.78s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.351,  Train_accy 73.62:  85%|████████▌ | 17/20 [18:09<03:02, 60.78s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.351,  Train_accy 73.62:  90%|█████████ | 18/20 [18:09<02:00, 60.24s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.376,  Train_accy 73.20:  90%|█████████ | 18/20 [19:08<02:00, 60.24s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.376,  Train_accy 73.20:  95%|█████████▌| 19/20 [19:08<00:59, 59.83s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21:  95%|█████████▌| 19/20 [20:07<00:59, 59.83s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21: 100%|██████████| 20/20 [20:07<00:00, 59.56s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21: 100%|██████████| 20/20 [20:07<00:00, 60.39s/it]
2024-09-05 20:23:09,298 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.335,  Train_accy 74.21
2024-09-05 20:23:09,299 [foster.py] => do not weight align student!
2024-09-05 20:23:16,595 [foster.py] => darknet eval: 
2024-09-05 20:23:16,596 [foster.py] => CNN top1 curve: 78.92
2024-09-05 20:23:16,596 [foster.py] => CNN top5 curve: 95.8
2024-09-05 20:23:16,599 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-05 20:25:23,964 [foster.py] => Exemplar size: 4000
2024-09-05 20:25:23,964 [trainer.py] => CNN: {'total': 78.88, '00-99': 89.65, '100-119': 85.53, '120-139': 79.11, '140-159': 78.0, '160-179': 69.2, '180-199': 27.39, 'old': 84.45, 'new': 27.39}
2024-09-05 20:25:23,964 [trainer.py] => NME: {'total': 88.25, '00-99': 88.13, '100-119': 88.6, '120-139': 86.22, '140-159': 90.4, '160-179': 89.03, '180-199': 87.39, 'old': 88.35, 'new': 87.39}
2024-09-05 20:25:23,964 [trainer.py] => CNN top1 curve: [92.0, 84.89, 82.69, 79.69, 79.7, 78.88]
2024-09-05 20:25:23,964 [trainer.py] => CNN top5 curve: [98.91, 98.02, 98.05, 97.62, 97.32, 96.86]
2024-09-05 20:25:23,964 [trainer.py] => NME top1 curve: [91.5, 90.18, 88.67, 88.05, 88.35, 88.25]
2024-09-05 20:25:23,964 [trainer.py] => NME top5 curve: [99.16, 98.73, 98.72, 98.78, 98.5, 98.13]

Average Accuracy (CNN): 82.98
Average Accuracy (NME): 89.17
2024-09-05 20:25:23,965 [trainer.py] => Average Accuracy (CNN): 82.98
2024-09-05 20:25:23,965 [trainer.py] => Average Accuracy (NME): 89.17
Accuracy Matrix (CNN):
[[92.   91.67 92.09 90.99 90.4  89.65]
 [ 0.   49.56 69.74 80.7  85.09 85.53]
 [ 0.    0.   46.22 67.11 76.44 79.11]
 [ 0.    0.    0.   36.4  66.8  78.  ]
 [ 0.    0.    0.    0.   37.55 69.2 ]
 [ 0.    0.    0.    0.    0.   27.39]]
2024-09-05 20:25:23,965 [trainer.py] => Forgetting (CNN): 0.48799999999999955
Accuracy Matrix (NME):
[[91.5  90.15 89.23 87.88 88.64 88.13]
 [ 0.   90.35 88.6  87.72 87.72 88.6 ]
 [ 0.    0.   85.78 86.22 85.78 86.22]
 [ 0.    0.    0.   90.8  89.2  90.4 ]
 [ 0.    0.    0.    0.   89.03 89.03]
 [ 0.    0.    0.    0.    0.   87.39]]
2024-09-05 20:25:23,965 [trainer.py] => Forgetting (NME): 1.1039999999999992
2024-09-13 12:08:14,063 [trainer.py] => config: ./exps/foster_cub_B100_Inc10.json
2024-09-13 12:08:14,063 [trainer.py] => prefix: cil
2024-09-13 12:08:14,063 [trainer.py] => dataset: cub
2024-09-13 12:08:14,063 [trainer.py] => memory_size: 4000
2024-09-13 12:08:14,063 [trainer.py] => memory_per_class: 20
2024-09-13 12:08:14,063 [trainer.py] => fixed_memory: True
2024-09-13 12:08:14,063 [trainer.py] => shuffle: True
2024-09-13 12:08:14,063 [trainer.py] => init_cls: 100
2024-09-13 12:08:14,063 [trainer.py] => increment: 10
2024-09-13 12:08:14,063 [trainer.py] => model_name: foster
2024-09-13 12:08:14,063 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-09-13 12:08:14,063 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 12:08:14,063 [trainer.py] => seed: 1993
2024-09-13 12:08:14,063 [trainer.py] => beta1: 0.96
2024-09-13 12:08:14,063 [trainer.py] => beta2: 0.97
2024-09-13 12:08:14,063 [trainer.py] => oofc: ft
2024-09-13 12:08:14,063 [trainer.py] => is_teacher_wa: False
2024-09-13 12:08:14,063 [trainer.py] => is_student_wa: False
2024-09-13 12:08:14,064 [trainer.py] => lambda_okd: 1
2024-09-13 12:08:14,064 [trainer.py] => wa_value: 1
2024-09-13 12:08:14,064 [trainer.py] => init_epochs: 20
2024-09-13 12:08:14,064 [trainer.py] => init_lr: 0.001
2024-09-13 12:08:14,064 [trainer.py] => init_weight_decay: 0.0005
2024-09-13 12:08:14,064 [trainer.py] => boosting_epochs: 20
2024-09-13 12:08:14,064 [trainer.py] => compression_epochs: 20
2024-09-13 12:08:14,064 [trainer.py] => lr: 0.001
2024-09-13 12:08:14,064 [trainer.py] => batch_size: 48
2024-09-13 12:08:14,064 [trainer.py] => weight_decay: 0.0005
2024-09-13 12:08:14,064 [trainer.py] => num_workers: 8
2024-09-13 12:08:14,064 [trainer.py] => T: 2
2024-09-13 12:08:14,107 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 12:08:14,677 [trainer.py] => All params: 0
2024-09-13 12:08:14,677 [trainer.py] => Trainable params: 0
2024-09-13 12:08:16,538 [foster.py] => Learning on 0-100
2024-09-13 12:08:16,538 [foster.py] => All params: 85952456
2024-09-13 12:08:16,539 [foster.py] => Trainable params: 85952456

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.113, Train_accy 29.40, Test_accy 75.76:   0%|          | 0/20 [00:39<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.113, Train_accy 29.40, Test_accy 75.76:   5%|▌         | 1/20 [00:39<12:32, 39.60s/it]
Task 0, Epoch 2/20 => Loss 0.971, Train_accy 72.75:   5%|▌         | 1/20 [01:14<12:32, 39.60s/it]                 
Task 0, Epoch 2/20 => Loss 0.971, Train_accy 72.75:  10%|█         | 2/20 [01:14<11:06, 37.01s/it]
Task 0, Epoch 3/20 => Loss 0.750, Train_accy 79.34:  10%|█         | 2/20 [01:50<11:06, 37.01s/it]
Task 0, Epoch 3/20 => Loss 0.750, Train_accy 79.34:  15%|█▌        | 3/20 [01:50<10:15, 36.21s/it]
Task 0, Epoch 4/20 => Loss 0.645, Train_accy 82.30:  15%|█▌        | 3/20 [02:25<10:15, 36.21s/it]
Task 0, Epoch 4/20 => Loss 0.645, Train_accy 82.30:  20%|██        | 4/20 [02:25<09:33, 35.85s/it]
Task 0, Epoch 5/20 => Loss 0.572, Train_accy 84.02:  20%|██        | 4/20 [03:00<09:33, 35.85s/it]
Task 0, Epoch 5/20 => Loss 0.572, Train_accy 84.02:  25%|██▌       | 5/20 [03:00<08:54, 35.66s/it]
Task 0, Epoch 6/20 => Loss 0.515, Train_accy 86.02, Test_accy 88.89:  25%|██▌       | 5/20 [03:39<08:54, 35.66s/it]
Task 0, Epoch 6/20 => Loss 0.515, Train_accy 86.02, Test_accy 88.89:  30%|███       | 6/20 [03:39<08:36, 36.89s/it]
Task 0, Epoch 7/20 => Loss 0.434, Train_accy 87.98:  30%|███       | 6/20 [04:15<08:36, 36.89s/it]                 
Task 0, Epoch 7/20 => Loss 0.434, Train_accy 87.98:  35%|███▌      | 7/20 [04:15<07:52, 36.37s/it]
Task 0, Epoch 8/20 => Loss 0.429, Train_accy 88.07:  35%|███▌      | 7/20 [04:50<07:52, 36.37s/it]
Task 0, Epoch 8/20 => Loss 0.429, Train_accy 88.07:  40%|████      | 8/20 [04:50<07:12, 36.02s/it]
Task 0, Epoch 9/20 => Loss 0.421, Train_accy 88.41:  40%|████      | 8/20 [05:25<07:12, 36.02s/it]
Task 0, Epoch 9/20 => Loss 0.421, Train_accy 88.41:  45%|████▌     | 9/20 [05:25<06:33, 35.79s/it]
Task 0, Epoch 10/20 => Loss 0.382, Train_accy 89.82:  45%|████▌     | 9/20 [06:01<06:33, 35.79s/it]
Task 0, Epoch 10/20 => Loss 0.382, Train_accy 89.82:  50%|█████     | 10/20 [06:01<05:56, 35.64s/it]
Task 0, Epoch 11/20 => Loss 0.373, Train_accy 90.33, Test_accy 90.57:  50%|█████     | 10/20 [06:40<05:56, 35.64s/it]
Task 0, Epoch 11/20 => Loss 0.373, Train_accy 90.33, Test_accy 90.57:  55%|█████▌    | 11/20 [06:40<05:30, 36.72s/it]
Task 0, Epoch 12/20 => Loss 0.346, Train_accy 90.54:  55%|█████▌    | 11/20 [07:15<05:30, 36.72s/it]                 
Task 0, Epoch 12/20 => Loss 0.346, Train_accy 90.54:  60%|██████    | 12/20 [07:15<04:50, 36.30s/it]
Task 0, Epoch 13/20 => Loss 0.304, Train_accy 92.07:  60%|██████    | 12/20 [07:50<04:50, 36.30s/it]
Task 0, Epoch 13/20 => Loss 0.304, Train_accy 92.07:  65%|██████▌   | 13/20 [07:50<04:11, 35.99s/it]
Task 0, Epoch 14/20 => Loss 0.303, Train_accy 92.12:  65%|██████▌   | 13/20 [08:26<04:11, 35.99s/it]
Task 0, Epoch 14/20 => Loss 0.303, Train_accy 92.12:  70%|███████   | 14/20 [08:26<03:34, 35.79s/it]
Task 0, Epoch 15/20 => Loss 0.290, Train_accy 92.22:  70%|███████   | 14/20 [09:01<03:34, 35.79s/it]
Task 0, Epoch 15/20 => Loss 0.290, Train_accy 92.22:  75%|███████▌  | 15/20 [09:01<02:58, 35.64s/it]
Task 0, Epoch 16/20 => Loss 0.281, Train_accy 92.65, Test_accy 91.75:  75%|███████▌  | 15/20 [09:40<02:58, 35.64s/it]
Task 0, Epoch 16/20 => Loss 0.281, Train_accy 92.65, Test_accy 91.75:  80%|████████  | 16/20 [09:40<02:27, 36.76s/it]
Task 0, Epoch 17/20 => Loss 0.274, Train_accy 92.50:  80%|████████  | 16/20 [10:16<02:27, 36.76s/it]                 
Task 0, Epoch 17/20 => Loss 0.274, Train_accy 92.50:  85%|████████▌ | 17/20 [10:16<01:49, 36.34s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 92.50:  85%|████████▌ | 17/20 [10:51<01:49, 36.34s/it]
Task 0, Epoch 18/20 => Loss 0.288, Train_accy 92.50:  90%|█████████ | 18/20 [10:51<01:12, 36.02s/it]
Task 0, Epoch 19/20 => Loss 0.263, Train_accy 93.18:  90%|█████████ | 18/20 [11:26<01:12, 36.02s/it]
Task 0, Epoch 19/20 => Loss 0.263, Train_accy 93.18:  95%|█████████▌| 19/20 [11:26<00:35, 35.82s/it]
Task 0, Epoch 20/20 => Loss 0.230, Train_accy 93.84:  95%|█████████▌| 19/20 [12:02<00:35, 35.82s/it]
Task 0, Epoch 20/20 => Loss 0.230, Train_accy 93.84: 100%|██████████| 20/20 [12:02<00:00, 35.71s/it]
Task 0, Epoch 20/20 => Loss 0.230, Train_accy 93.84: 100%|██████████| 20/20 [12:02<00:00, 36.12s/it]2024-09-13 12:20:19,304 [foster.py] => Task 0, Epoch 20/20 => Loss 0.230, Train_accy 93.84
2024-09-13 12:20:19,305 [base.py] => Constructing exemplars for new classes...(20 per classes)

2024-09-13 12:22:01,320 [foster.py] => Exemplar size: 2000
2024-09-13 12:22:01,320 [trainer.py] => CNN: {'total': 91.84, '00-99': 91.84, 'old': 0, 'new': 91.84}
2024-09-13 12:22:01,320 [trainer.py] => NME: {'total': 91.08, '00-99': 91.08, 'old': 0, 'new': 91.08}
2024-09-13 12:22:01,320 [trainer.py] => CNN top1 curve: [91.84]
2024-09-13 12:22:01,320 [trainer.py] => CNN top5 curve: [98.82]
2024-09-13 12:22:01,320 [trainer.py] => NME top1 curve: [91.08]
2024-09-13 12:22:01,320 [trainer.py] => NME top5 curve: [99.16]

Average Accuracy (CNN): 91.84
Average Accuracy (NME): 91.08
2024-09-13 12:22:01,320 [trainer.py] => Average Accuracy (CNN): 91.84
2024-09-13 12:22:01,320 [trainer.py] => Average Accuracy (NME): 91.08
2024-09-13 12:22:01,322 [trainer.py] => All params: 85952456
2024-09-13 12:22:01,322 [trainer.py] => Trainable params: 85952456
2024-09-13 12:22:03,722 [foster.py] => Learning on 100-110
2024-09-13 12:22:03,724 [foster.py] => All params: 171927872
2024-09-13 12:22:03,725 [foster.py] => Trainable params: 86052316
2024-09-13 12:22:03,776 [foster.py] => per cls weights : [1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423 1.04186423
 1.04186423 1.04186423 1.04186423 1.04186423 0.5813577  0.5813577
 0.5813577  0.5813577  0.5813577  0.5813577  0.5813577  0.5813577
 0.5813577  0.5813577 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.213, Loss_clf 0.756, Loss_fe 3.518, Loss_kd 0.853, Train_accy 80.61, Test_accy 87.41:   0%|          | 0/20 [00:32<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.213, Loss_clf 0.756, Loss_fe 3.518, Loss_kd 0.853, Train_accy 80.61, Test_accy 87.41:   5%|▌         | 1/20 [00:32<10:22, 32.77s/it]
Task 1, Epoch 2/20 => Loss 2.230, Loss_clf 0.401, Loss_fe 0.888, Loss_kd 0.855, Train_accy 82.51:   5%|▌         | 1/20 [00:58<10:22, 32.77s/it]                 
Task 1, Epoch 2/20 => Loss 2.230, Loss_clf 0.401, Loss_fe 0.888, Loss_kd 0.855, Train_accy 82.51:  10%|█         | 2/20 [00:58<08:31, 28.44s/it]
Task 1, Epoch 3/20 => Loss 1.952, Loss_clf 0.352, Loss_fe 0.637, Loss_kd 0.876, Train_accy 83.56:  10%|█         | 2/20 [01:23<08:31, 28.44s/it]
Task 1, Epoch 3/20 => Loss 1.952, Loss_clf 0.352, Loss_fe 0.637, Loss_kd 0.876, Train_accy 83.56:  15%|█▌        | 3/20 [01:23<07:39, 27.01s/it]
Task 1, Epoch 4/20 => Loss 1.835, Loss_clf 0.337, Loss_fe 0.549, Loss_kd 0.862, Train_accy 83.15:  15%|█▌        | 3/20 [01:48<07:39, 27.01s/it]
Task 1, Epoch 4/20 => Loss 1.835, Loss_clf 0.337, Loss_fe 0.549, Loss_kd 0.862, Train_accy 83.15:  20%|██        | 4/20 [01:48<07:02, 26.38s/it]
Task 1, Epoch 5/20 => Loss 1.742, Loss_clf 0.325, Loss_fe 0.486, Loss_kd 0.845, Train_accy 83.80:  20%|██        | 4/20 [02:14<07:02, 26.38s/it]
Task 1, Epoch 5/20 => Loss 1.742, Loss_clf 0.325, Loss_fe 0.486, Loss_kd 0.845, Train_accy 83.80:  25%|██▌       | 5/20 [02:14<06:30, 26.05s/it]
Task 1, Epoch 6/20 => Loss 1.720, Loss_clf 0.306, Loss_fe 0.454, Loss_kd 0.872, Train_accy 83.72, Test_accy 87.72:  25%|██▌       | 5/20 [02:47<06:30, 26.05s/it]
Task 1, Epoch 6/20 => Loss 1.720, Loss_clf 0.306, Loss_fe 0.454, Loss_kd 0.872, Train_accy 83.72, Test_accy 87.72:  30%|███       | 6/20 [02:47<06:38, 28.49s/it]
Task 1, Epoch 7/20 => Loss 1.680, Loss_clf 0.309, Loss_fe 0.402, Loss_kd 0.881, Train_accy 84.20:  30%|███       | 6/20 [03:13<06:38, 28.49s/it]                 
Task 1, Epoch 7/20 => Loss 1.680, Loss_clf 0.309, Loss_fe 0.402, Loss_kd 0.881, Train_accy 84.20:  35%|███▌      | 7/20 [03:13<05:57, 27.50s/it]
Task 1, Epoch 8/20 => Loss 1.662, Loss_clf 0.285, Loss_fe 0.406, Loss_kd 0.883, Train_accy 84.20:  35%|███▌      | 7/20 [03:38<05:57, 27.50s/it]
Task 1, Epoch 8/20 => Loss 1.662, Loss_clf 0.285, Loss_fe 0.406, Loss_kd 0.883, Train_accy 84.20:  40%|████      | 8/20 [03:38<05:22, 26.88s/it]
Task 1, Epoch 9/20 => Loss 1.591, Loss_clf 0.288, Loss_fe 0.372, Loss_kd 0.847, Train_accy 84.64:  40%|████      | 8/20 [04:04<05:22, 26.88s/it]
Task 1, Epoch 9/20 => Loss 1.591, Loss_clf 0.288, Loss_fe 0.372, Loss_kd 0.847, Train_accy 84.64:  45%|████▌     | 9/20 [04:04<04:51, 26.47s/it]
Task 1, Epoch 10/20 => Loss 1.526, Loss_clf 0.271, Loss_fe 0.338, Loss_kd 0.834, Train_accy 85.09:  45%|████▌     | 9/20 [04:29<04:51, 26.47s/it]
Task 1, Epoch 10/20 => Loss 1.526, Loss_clf 0.271, Loss_fe 0.338, Loss_kd 0.834, Train_accy 85.09:  50%|█████     | 10/20 [04:29<04:21, 26.17s/it]
Task 1, Epoch 11/20 => Loss 1.605, Loss_clf 0.296, Loss_fe 0.340, Loss_kd 0.881, Train_accy 84.24, Test_accy 87.64:  50%|█████     | 10/20 [05:03<04:21, 26.17s/it]
Task 1, Epoch 11/20 => Loss 1.605, Loss_clf 0.296, Loss_fe 0.340, Loss_kd 0.881, Train_accy 84.24, Test_accy 87.64:  55%|█████▌    | 11/20 [05:03<04:15, 28.37s/it]
Task 1, Epoch 12/20 => Loss 1.467, Loss_clf 0.244, Loss_fe 0.299, Loss_kd 0.840, Train_accy 86.01:  55%|█████▌    | 11/20 [05:28<04:15, 28.37s/it]                 
Task 1, Epoch 12/20 => Loss 1.467, Loss_clf 0.244, Loss_fe 0.299, Loss_kd 0.840, Train_accy 86.01:  60%|██████    | 12/20 [05:28<03:40, 27.53s/it]
Task 1, Epoch 13/20 => Loss 1.526, Loss_clf 0.262, Loss_fe 0.306, Loss_kd 0.871, Train_accy 85.29:  60%|██████    | 12/20 [05:54<03:40, 27.53s/it]
Task 1, Epoch 13/20 => Loss 1.526, Loss_clf 0.262, Loss_fe 0.306, Loss_kd 0.871, Train_accy 85.29:  65%|██████▌   | 13/20 [05:54<03:08, 26.94s/it]
Task 1, Epoch 14/20 => Loss 1.504, Loss_clf 0.260, Loss_fe 0.294, Loss_kd 0.864, Train_accy 85.41:  65%|██████▌   | 13/20 [06:19<03:08, 26.94s/it]
Task 1, Epoch 14/20 => Loss 1.504, Loss_clf 0.260, Loss_fe 0.294, Loss_kd 0.864, Train_accy 85.41:  70%|███████   | 14/20 [06:19<02:39, 26.53s/it]
Task 1, Epoch 15/20 => Loss 1.432, Loss_clf 0.234, Loss_fe 0.268, Loss_kd 0.846, Train_accy 85.73:  70%|███████   | 14/20 [06:45<02:39, 26.53s/it]
Task 1, Epoch 15/20 => Loss 1.432, Loss_clf 0.234, Loss_fe 0.268, Loss_kd 0.846, Train_accy 85.73:  75%|███████▌  | 15/20 [06:45<02:11, 26.26s/it]
Task 1, Epoch 16/20 => Loss 1.508, Loss_clf 0.265, Loss_fe 0.287, Loss_kd 0.869, Train_accy 84.93, Test_accy 88.41:  75%|███████▌  | 15/20 [07:18<02:11, 26.26s/it]
Task 1, Epoch 16/20 => Loss 1.508, Loss_clf 0.265, Loss_fe 0.287, Loss_kd 0.869, Train_accy 84.93, Test_accy 88.41:  80%|████████  | 16/20 [07:18<01:53, 28.42s/it]
Task 1, Epoch 17/20 => Loss 1.429, Loss_clf 0.247, Loss_fe 0.244, Loss_kd 0.852, Train_accy 85.57:  80%|████████  | 16/20 [07:44<01:53, 28.42s/it]                 
Task 1, Epoch 17/20 => Loss 1.429, Loss_clf 0.247, Loss_fe 0.244, Loss_kd 0.852, Train_accy 85.57:  85%|████████▌ | 17/20 [07:44<01:22, 27.61s/it]
Task 1, Epoch 18/20 => Loss 1.475, Loss_clf 0.263, Loss_fe 0.269, Loss_kd 0.858, Train_accy 85.69:  85%|████████▌ | 17/20 [08:10<01:22, 27.61s/it]
Task 1, Epoch 18/20 => Loss 1.475, Loss_clf 0.263, Loss_fe 0.269, Loss_kd 0.858, Train_accy 85.69:  90%|█████████ | 18/20 [08:10<00:54, 27.01s/it]
Task 1, Epoch 19/20 => Loss 1.428, Loss_clf 0.250, Loss_fe 0.252, Loss_kd 0.842, Train_accy 85.33:  90%|█████████ | 18/20 [08:35<00:54, 27.01s/it]
Task 1, Epoch 19/20 => Loss 1.428, Loss_clf 0.250, Loss_fe 0.252, Loss_kd 0.842, Train_accy 85.33:  95%|█████████▌| 19/20 [08:35<00:26, 26.58s/it]
Task 1, Epoch 20/20 => Loss 1.478, Loss_clf 0.253, Loss_fe 0.271, Loss_kd 0.867, Train_accy 85.21:  95%|█████████▌| 19/20 [09:01<00:26, 26.58s/it]
Task 1, Epoch 20/20 => Loss 1.478, Loss_clf 0.253, Loss_fe 0.271, Loss_kd 0.867, Train_accy 85.21: 100%|██████████| 20/20 [09:01<00:00, 26.27s/it]
Task 1, Epoch 20/20 => Loss 1.478, Loss_clf 0.253, Loss_fe 0.271, Loss_kd 0.867, Train_accy 85.21: 100%|██████████| 20/20 [09:01<00:00, 27.07s/it]2024-09-13 12:31:05,120 [foster.py] => Task 1, Epoch 20/20 => Loss 1.478, Loss_clf 0.253, Loss_fe 0.271, Loss_kd 0.867, Train_accy 85.21
2024-09-13 12:31:05,121 [foster.py] => do not weight align teacher!
2024-09-13 12:31:05,124 [foster.py] => per cls weights : [1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685 1.05200685
 1.05200685 1.05200685 1.05200685 1.05200685 0.47993148 0.47993148
 0.47993148 0.47993148 0.47993148 0.47993148 0.47993148 0.47993148
 0.47993148 0.47993148]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 0.988,  Train_accy 79.81, Test_accy 87.80:   0%|          | 0/20 [00:36<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 0.988,  Train_accy 79.81, Test_accy 87.80:   5%|▌         | 1/20 [00:36<11:34, 36.57s/it]
SNet: Task 1, Epoch 2/20 => Loss 0.905,  Train_accy 81.30:   5%|▌         | 1/20 [01:08<11:34, 36.57s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 0.905,  Train_accy 81.30:  10%|█         | 2/20 [01:08<10:11, 33.96s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.853,  Train_accy 83.23:  10%|█         | 2/20 [01:40<10:11, 33.96s/it]
SNet: Task 1, Epoch 3/20 => Loss 0.853,  Train_accy 83.23:  15%|█▌        | 3/20 [01:40<09:23, 33.13s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.844,  Train_accy 82.99:  15%|█▌        | 3/20 [02:12<09:23, 33.13s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.844,  Train_accy 82.99:  20%|██        | 4/20 [02:12<08:43, 32.70s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.879,  Train_accy 81.82:  20%|██        | 4/20 [02:44<08:43, 32.70s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.879,  Train_accy 81.82:  25%|██▌       | 5/20 [02:44<08:07, 32.48s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.823,  Train_accy 83.11, Test_accy 88.03:  25%|██▌       | 5/20 [03:21<08:07, 32.48s/it]
SNet: Task 1, Epoch 6/20 => Loss 0.823,  Train_accy 83.11, Test_accy 88.03:  30%|███       | 6/20 [03:21<07:54, 33.90s/it]
SNet: Task 1, Epoch 7/20 => Loss 0.871,  Train_accy 82.67:  30%|███       | 6/20 [03:53<07:54, 33.90s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 0.871,  Train_accy 82.67:  35%|███▌      | 7/20 [03:53<07:13, 33.31s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.865,  Train_accy 81.90:  35%|███▌      | 7/20 [04:25<07:13, 33.31s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.865,  Train_accy 81.90:  40%|████      | 8/20 [04:25<06:35, 32.96s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.830,  Train_accy 83.92:  40%|████      | 8/20 [04:58<06:35, 32.96s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.830,  Train_accy 83.92:  45%|████▌     | 9/20 [04:58<05:59, 32.69s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.886,  Train_accy 82.10:  45%|████▌     | 9/20 [05:30<05:59, 32.69s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.886,  Train_accy 82.10:  50%|█████     | 10/20 [05:30<05:25, 32.53s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.867,  Train_accy 82.02, Test_accy 88.33:  50%|█████     | 10/20 [06:06<05:25, 32.53s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.867,  Train_accy 82.02, Test_accy 88.33:  55%|█████▌    | 11/20 [06:06<05:04, 33.78s/it]
SNet: Task 1, Epoch 12/20 => Loss 0.851,  Train_accy 83.56:  55%|█████▌    | 11/20 [06:38<05:04, 33.78s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 0.851,  Train_accy 83.56:  60%|██████    | 12/20 [06:38<04:26, 33.25s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.855,  Train_accy 82.71:  60%|██████    | 12/20 [07:10<04:26, 33.25s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.855,  Train_accy 82.71:  65%|██████▌   | 13/20 [07:10<03:50, 32.89s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.828,  Train_accy 83.19:  65%|██████▌   | 13/20 [07:43<03:50, 32.89s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.828,  Train_accy 83.19:  70%|███████   | 14/20 [07:43<03:15, 32.66s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.831,  Train_accy 82.95:  70%|███████   | 14/20 [08:15<03:15, 32.66s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.831,  Train_accy 82.95:  75%|███████▌  | 15/20 [08:15<02:42, 32.50s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.865,  Train_accy 82.59, Test_accy 88.33:  75%|███████▌  | 15/20 [08:51<02:42, 32.50s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.865,  Train_accy 82.59, Test_accy 88.33:  80%|████████  | 16/20 [08:51<02:14, 33.71s/it]
SNet: Task 1, Epoch 17/20 => Loss 0.856,  Train_accy 81.94:  80%|████████  | 16/20 [09:23<02:14, 33.71s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 0.856,  Train_accy 81.94:  85%|████████▌ | 17/20 [09:23<01:39, 33.23s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.848,  Train_accy 83.07:  85%|████████▌ | 17/20 [09:55<01:39, 33.23s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.848,  Train_accy 83.07:  90%|█████████ | 18/20 [09:55<01:05, 32.92s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.844,  Train_accy 82.43:  90%|█████████ | 18/20 [10:28<01:05, 32.92s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.844,  Train_accy 82.43:  95%|█████████▌| 19/20 [10:28<00:32, 32.67s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.852,  Train_accy 82.63:  95%|█████████▌| 19/20 [11:00<00:32, 32.67s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.852,  Train_accy 82.63: 100%|██████████| 20/20 [11:00<00:00, 32.53s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.852,  Train_accy 82.63: 100%|██████████| 20/20 [11:00<00:00, 33.02s/it]2024-09-13 12:42:08,120 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.852,  Train_accy 82.63
2024-09-13 12:42:08,120 [foster.py] => do not weight align student!

2024-09-13 12:42:12,473 [foster.py] => darknet eval: 
2024-09-13 12:42:12,474 [foster.py] => CNN top1 curve: 88.18
2024-09-13 12:42:12,474 [foster.py] => CNN top5 curve: 98.47
2024-09-13 12:42:12,476 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 12:43:26,907 [foster.py] => Exemplar size: 2200
2024-09-13 12:43:26,907 [trainer.py] => CNN: {'total': 88.33, '00-99': 91.33, '100-109': 57.39, 'old': 91.33, 'new': 57.39}
2024-09-13 12:43:26,907 [trainer.py] => NME: {'total': 90.87, '00-99': 90.91, '100-109': 90.43, 'old': 90.91, 'new': 90.43}
2024-09-13 12:43:26,908 [trainer.py] => CNN top1 curve: [91.84, 88.33]
2024-09-13 12:43:26,908 [trainer.py] => CNN top5 curve: [98.82, 98.47]
2024-09-13 12:43:26,908 [trainer.py] => NME top1 curve: [91.08, 90.87]
2024-09-13 12:43:26,908 [trainer.py] => NME top5 curve: [99.16, 99.08]

Average Accuracy (CNN): 90.08
Average Accuracy (NME): 90.98
2024-09-13 12:43:26,908 [trainer.py] => Average Accuracy (CNN): 90.08
2024-09-13 12:43:26,908 [trainer.py] => Average Accuracy (NME): 90.98
2024-09-13 12:43:26,909 [trainer.py] => All params: 171927872
2024-09-13 12:43:26,910 [trainer.py] => Trainable params: 86052316
2024-09-13 12:43:29,246 [foster.py] => Learning on 110-120
2024-09-13 12:43:29,248 [foster.py] => All params: 171958622
2024-09-13 12:43:29,249 [foster.py] => Trainable params: 86075376
2024-09-13 12:43:29,302 [foster.py] => per cls weights : [1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213 1.03824213
 1.03824213 1.03824213 0.57933658 0.57933658 0.57933658 0.57933658
 0.57933658 0.57933658 0.57933658 0.57933658 0.57933658 0.57933658]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 4.852, Loss_clf 0.827, Loss_fe 3.037, Loss_kd 0.905, Train_accy 76.97, Test_accy 85.59:   0%|          | 0/20 [00:35<?, ?it/s]
Task 2, Epoch 1/20 => Loss 4.852, Loss_clf 0.827, Loss_fe 3.037, Loss_kd 0.905, Train_accy 76.97, Test_accy 85.59:   5%|▌         | 1/20 [00:35<11:13, 35.45s/it]
Task 2, Epoch 2/20 => Loss 2.220, Loss_clf 0.464, Loss_fe 0.845, Loss_kd 0.836, Train_accy 78.81:   5%|▌         | 1/20 [01:02<11:13, 35.45s/it]                 
Task 2, Epoch 2/20 => Loss 2.220, Loss_clf 0.464, Loss_fe 0.845, Loss_kd 0.836, Train_accy 78.81:  10%|█         | 2/20 [01:02<09:13, 30.74s/it]
Task 2, Epoch 3/20 => Loss 2.071, Loss_clf 0.462, Loss_fe 0.667, Loss_kd 0.863, Train_accy 78.92:  10%|█         | 2/20 [01:30<09:13, 30.74s/it]
Task 2, Epoch 3/20 => Loss 2.071, Loss_clf 0.462, Loss_fe 0.667, Loss_kd 0.863, Train_accy 78.92:  15%|█▌        | 3/20 [01:30<08:16, 29.18s/it]
Task 2, Epoch 4/20 => Loss 1.884, Loss_clf 0.383, Loss_fe 0.564, Loss_kd 0.859, Train_accy 79.67:  15%|█▌        | 3/20 [01:57<08:16, 29.18s/it]
Task 2, Epoch 4/20 => Loss 1.884, Loss_clf 0.383, Loss_fe 0.564, Loss_kd 0.859, Train_accy 79.67:  20%|██        | 4/20 [01:57<07:35, 28.47s/it]
Task 2, Epoch 5/20 => Loss 1.722, Loss_clf 0.328, Loss_fe 0.474, Loss_kd 0.843, Train_accy 80.94:  20%|██        | 4/20 [02:25<07:35, 28.47s/it]
Task 2, Epoch 5/20 => Loss 1.722, Loss_clf 0.328, Loss_fe 0.474, Loss_kd 0.843, Train_accy 80.94:  25%|██▌       | 5/20 [02:25<07:01, 28.11s/it]
Task 2, Epoch 6/20 => Loss 1.717, Loss_clf 0.355, Loss_fe 0.440, Loss_kd 0.845, Train_accy 80.04, Test_accy 86.65:  25%|██▌       | 5/20 [03:01<07:01, 28.11s/it]
Task 2, Epoch 6/20 => Loss 1.717, Loss_clf 0.355, Loss_fe 0.440, Loss_kd 0.845, Train_accy 80.04, Test_accy 86.65:  30%|███       | 6/20 [03:01<07:11, 30.79s/it]
Task 2, Epoch 7/20 => Loss 1.758, Loss_clf 0.351, Loss_fe 0.458, Loss_kd 0.870, Train_accy 79.45:  30%|███       | 6/20 [03:28<07:11, 30.79s/it]                 
Task 2, Epoch 7/20 => Loss 1.758, Loss_clf 0.351, Loss_fe 0.458, Loss_kd 0.870, Train_accy 79.45:  35%|███▌      | 7/20 [03:28<06:26, 29.70s/it]
Task 2, Epoch 8/20 => Loss 1.655, Loss_clf 0.332, Loss_fe 0.384, Loss_kd 0.861, Train_accy 79.90:  35%|███▌      | 7/20 [03:56<06:26, 29.70s/it]
Task 2, Epoch 8/20 => Loss 1.655, Loss_clf 0.332, Loss_fe 0.384, Loss_kd 0.861, Train_accy 79.90:  40%|████      | 8/20 [03:56<05:48, 29.01s/it]
Task 2, Epoch 9/20 => Loss 1.615, Loss_clf 0.309, Loss_fe 0.368, Loss_kd 0.860, Train_accy 80.42:  40%|████      | 8/20 [04:23<05:48, 29.01s/it]
Task 2, Epoch 9/20 => Loss 1.615, Loss_clf 0.309, Loss_fe 0.368, Loss_kd 0.860, Train_accy 80.42:  45%|████▌     | 9/20 [04:23<05:13, 28.53s/it]
Task 2, Epoch 10/20 => Loss 1.475, Loss_clf 0.272, Loss_fe 0.315, Loss_kd 0.814, Train_accy 81.43:  45%|████▌     | 9/20 [04:51<05:13, 28.53s/it]
Task 2, Epoch 10/20 => Loss 1.475, Loss_clf 0.272, Loss_fe 0.315, Loss_kd 0.814, Train_accy 81.43:  50%|█████     | 10/20 [04:51<04:42, 28.23s/it]
Task 2, Epoch 11/20 => Loss 1.489, Loss_clf 0.289, Loss_fe 0.312, Loss_kd 0.814, Train_accy 81.13, Test_accy 86.44:  50%|█████     | 10/20 [05:27<04:42, 28.23s/it]
Task 2, Epoch 11/20 => Loss 1.489, Loss_clf 0.289, Loss_fe 0.312, Loss_kd 0.814, Train_accy 81.13, Test_accy 86.44:  55%|█████▌    | 11/20 [05:27<04:35, 30.66s/it]
Task 2, Epoch 12/20 => Loss 1.613, Loss_clf 0.310, Loss_fe 0.350, Loss_kd 0.873, Train_accy 80.38:  55%|█████▌    | 11/20 [05:54<04:35, 30.66s/it]                 
Task 2, Epoch 12/20 => Loss 1.613, Loss_clf 0.310, Loss_fe 0.350, Loss_kd 0.873, Train_accy 80.38:  60%|██████    | 12/20 [05:54<03:57, 29.72s/it]
Task 2, Epoch 13/20 => Loss 1.572, Loss_clf 0.314, Loss_fe 0.319, Loss_kd 0.861, Train_accy 80.04:  60%|██████    | 12/20 [06:22<03:57, 29.72s/it]
Task 2, Epoch 13/20 => Loss 1.572, Loss_clf 0.314, Loss_fe 0.319, Loss_kd 0.861, Train_accy 80.04:  65%|██████▌   | 13/20 [06:22<03:23, 29.08s/it]
Task 2, Epoch 14/20 => Loss 1.488, Loss_clf 0.276, Loss_fe 0.284, Loss_kd 0.850, Train_accy 81.09:  65%|██████▌   | 13/20 [06:50<03:23, 29.08s/it]
Task 2, Epoch 14/20 => Loss 1.488, Loss_clf 0.276, Loss_fe 0.284, Loss_kd 0.850, Train_accy 81.09:  70%|███████   | 14/20 [06:50<02:51, 28.64s/it]
Task 2, Epoch 15/20 => Loss 1.488, Loss_clf 0.283, Loss_fe 0.297, Loss_kd 0.833, Train_accy 81.09:  70%|███████   | 14/20 [07:17<02:51, 28.64s/it]
Task 2, Epoch 15/20 => Loss 1.488, Loss_clf 0.283, Loss_fe 0.297, Loss_kd 0.833, Train_accy 81.09:  75%|███████▌  | 15/20 [07:17<02:21, 28.30s/it]
Task 2, Epoch 16/20 => Loss 1.456, Loss_clf 0.271, Loss_fe 0.277, Loss_kd 0.833, Train_accy 81.06, Test_accy 86.02:  75%|███████▌  | 15/20 [07:53<02:21, 28.30s/it]
Task 2, Epoch 16/20 => Loss 1.456, Loss_clf 0.271, Loss_fe 0.277, Loss_kd 0.833, Train_accy 81.06, Test_accy 86.02:  80%|████████  | 16/20 [07:53<02:02, 30.66s/it]
Task 2, Epoch 17/20 => Loss 1.545, Loss_clf 0.305, Loss_fe 0.293, Loss_kd 0.868, Train_accy 79.75:  80%|████████  | 16/20 [08:21<02:02, 30.66s/it]                 
Task 2, Epoch 17/20 => Loss 1.545, Loss_clf 0.305, Loss_fe 0.293, Loss_kd 0.868, Train_accy 79.75:  85%|████████▌ | 17/20 [08:21<01:29, 29.74s/it]
Task 2, Epoch 18/20 => Loss 1.486, Loss_clf 0.277, Loss_fe 0.271, Loss_kd 0.860, Train_accy 81.17:  85%|████████▌ | 17/20 [08:48<01:29, 29.74s/it]
Task 2, Epoch 18/20 => Loss 1.486, Loss_clf 0.277, Loss_fe 0.271, Loss_kd 0.860, Train_accy 81.17:  90%|█████████ | 18/20 [08:48<00:58, 29.08s/it]
Task 2, Epoch 19/20 => Loss 1.477, Loss_clf 0.288, Loss_fe 0.272, Loss_kd 0.840, Train_accy 80.68:  90%|█████████ | 18/20 [09:16<00:58, 29.08s/it]
Task 2, Epoch 19/20 => Loss 1.477, Loss_clf 0.288, Loss_fe 0.272, Loss_kd 0.840, Train_accy 80.68:  95%|█████████▌| 19/20 [09:16<00:28, 28.63s/it]
Task 2, Epoch 20/20 => Loss 1.367, Loss_clf 0.248, Loss_fe 0.238, Loss_kd 0.808, Train_accy 81.51:  95%|█████████▌| 19/20 [09:43<00:28, 28.63s/it]
Task 2, Epoch 20/20 => Loss 1.367, Loss_clf 0.248, Loss_fe 0.238, Loss_kd 0.808, Train_accy 81.51: 100%|██████████| 20/20 [09:43<00:00, 28.28s/it]
Task 2, Epoch 20/20 => Loss 1.367, Loss_clf 0.248, Loss_fe 0.238, Loss_kd 0.808, Train_accy 81.51: 100%|██████████| 20/20 [09:43<00:00, 29.20s/it]2024-09-13 12:53:13,210 [foster.py] => Task 2, Epoch 20/20 => Loss 1.367, Loss_clf 0.248, Loss_fe 0.238, Loss_kd 0.808, Train_accy 81.51
2024-09-13 12:53:13,211 [foster.py] => do not weight align teacher!
2024-09-13 12:53:13,215 [foster.py] => per cls weights : [1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723 1.04746723
 1.04746723 1.04746723 0.47786048 0.47786048 0.47786048 0.47786048
 0.47786048 0.47786048 0.47786048 0.47786048 0.47786048 0.47786048]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 0.914,  Train_accy 77.01, Test_accy 85.03:   0%|          | 0/20 [00:39<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 0.914,  Train_accy 77.01, Test_accy 85.03:   5%|▌         | 1/20 [00:39<12:24, 39.18s/it]
SNet: Task 2, Epoch 2/20 => Loss 0.872,  Train_accy 78.14:   5%|▌         | 1/20 [01:13<12:24, 39.18s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 0.872,  Train_accy 78.14:  10%|█         | 2/20 [01:13<10:56, 36.47s/it]
SNet: Task 2, Epoch 3/20 => Loss 0.879,  Train_accy 78.44:  10%|█         | 2/20 [01:48<10:56, 36.47s/it]
SNet: Task 2, Epoch 3/20 => Loss 0.879,  Train_accy 78.44:  15%|█▌        | 3/20 [01:48<10:06, 35.65s/it]
SNet: Task 2, Epoch 4/20 => Loss 0.893,  Train_accy 78.02:  15%|█▌        | 3/20 [02:24<10:06, 35.65s/it]
SNet: Task 2, Epoch 4/20 => Loss 0.893,  Train_accy 78.02:  20%|██        | 4/20 [02:24<09:35, 35.99s/it]
SNet: Task 2, Epoch 5/20 => Loss 0.867,  Train_accy 77.99:  20%|██        | 4/20 [03:03<09:35, 35.99s/it]
SNet: Task 2, Epoch 5/20 => Loss 0.867,  Train_accy 77.99:  25%|██▌       | 5/20 [03:03<09:14, 36.97s/it]
SNet: Task 2, Epoch 6/20 => Loss 0.854,  Train_accy 78.66, Test_accy 85.88:  25%|██▌       | 5/20 [03:47<09:14, 36.97s/it]
SNet: Task 2, Epoch 6/20 => Loss 0.854,  Train_accy 78.66, Test_accy 85.88:  30%|███       | 6/20 [03:47<09:11, 39.40s/it]
SNet: Task 2, Epoch 7/20 => Loss 0.860,  Train_accy 78.58:  30%|███       | 6/20 [04:26<09:11, 39.40s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 0.860,  Train_accy 78.58:  35%|███▌      | 7/20 [04:26<08:29, 39.17s/it]
SNet: Task 2, Epoch 8/20 => Loss 0.876,  Train_accy 78.62:  35%|███▌      | 7/20 [05:05<08:29, 39.17s/it]
SNet: Task 2, Epoch 8/20 => Loss 0.876,  Train_accy 78.62:  40%|████      | 8/20 [05:05<07:47, 38.99s/it]
SNet: Task 2, Epoch 9/20 => Loss 0.875,  Train_accy 78.77:  40%|████      | 8/20 [05:43<07:47, 38.99s/it]
SNet: Task 2, Epoch 9/20 => Loss 0.875,  Train_accy 78.77:  45%|████▌     | 9/20 [05:43<07:07, 38.84s/it]
SNet: Task 2, Epoch 10/20 => Loss 0.861,  Train_accy 78.17:  45%|████▌     | 9/20 [06:22<07:07, 38.84s/it]
SNet: Task 2, Epoch 10/20 => Loss 0.861,  Train_accy 78.17:  50%|█████     | 10/20 [06:22<06:27, 38.80s/it]
SNet: Task 2, Epoch 11/20 => Loss 0.852,  Train_accy 79.00, Test_accy 85.88:  50%|█████     | 10/20 [07:06<06:27, 38.80s/it]
SNet: Task 2, Epoch 11/20 => Loss 0.852,  Train_accy 79.00, Test_accy 85.88:  55%|█████▌    | 11/20 [07:06<06:03, 40.34s/it]
SNet: Task 2, Epoch 12/20 => Loss 0.842,  Train_accy 78.81:  55%|█████▌    | 11/20 [07:44<06:03, 40.34s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 0.842,  Train_accy 78.81:  60%|██████    | 12/20 [07:44<05:19, 39.88s/it]
SNet: Task 2, Epoch 13/20 => Loss 0.857,  Train_accy 78.73:  60%|██████    | 12/20 [08:24<05:19, 39.88s/it]
SNet: Task 2, Epoch 13/20 => Loss 0.857,  Train_accy 78.73:  65%|██████▌   | 13/20 [08:24<04:38, 39.73s/it]
SNet: Task 2, Epoch 14/20 => Loss 0.864,  Train_accy 79.26:  65%|██████▌   | 13/20 [09:03<04:38, 39.73s/it]
SNet: Task 2, Epoch 14/20 => Loss 0.864,  Train_accy 79.26:  70%|███████   | 14/20 [09:03<03:57, 39.63s/it]
SNet: Task 2, Epoch 15/20 => Loss 0.895,  Train_accy 78.25:  70%|███████   | 14/20 [09:43<03:57, 39.63s/it]
SNet: Task 2, Epoch 15/20 => Loss 0.895,  Train_accy 78.25:  75%|███████▌  | 15/20 [09:43<03:17, 39.57s/it]
SNet: Task 2, Epoch 16/20 => Loss 0.859,  Train_accy 78.70, Test_accy 85.66:  75%|███████▌  | 15/20 [10:27<03:17, 39.57s/it]
SNet: Task 2, Epoch 16/20 => Loss 0.859,  Train_accy 78.70, Test_accy 85.66:  80%|████████  | 16/20 [10:27<02:44, 41.15s/it]
SNet: Task 2, Epoch 17/20 => Loss 0.889,  Train_accy 78.40:  80%|████████  | 16/20 [11:06<02:44, 41.15s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 0.889,  Train_accy 78.40:  85%|████████▌ | 17/20 [11:06<02:01, 40.43s/it]
SNet: Task 2, Epoch 18/20 => Loss 0.870,  Train_accy 78.77:  85%|████████▌ | 17/20 [11:45<02:01, 40.43s/it]
SNet: Task 2, Epoch 18/20 => Loss 0.870,  Train_accy 78.77:  90%|█████████ | 18/20 [11:45<01:19, 39.93s/it]
SNet: Task 2, Epoch 19/20 => Loss 0.877,  Train_accy 79.22:  90%|█████████ | 18/20 [12:24<01:19, 39.93s/it]
SNet: Task 2, Epoch 19/20 => Loss 0.877,  Train_accy 79.22:  95%|█████████▌| 19/20 [12:24<00:39, 39.52s/it]
SNet: Task 2, Epoch 20/20 => Loss 0.830,  Train_accy 79.37:  95%|█████████▌| 19/20 [13:02<00:39, 39.52s/it]
SNet: Task 2, Epoch 20/20 => Loss 0.830,  Train_accy 79.37: 100%|██████████| 20/20 [13:02<00:00, 39.28s/it]
SNet: Task 2, Epoch 20/20 => Loss 0.830,  Train_accy 79.37: 100%|██████████| 20/20 [13:02<00:00, 39.14s/it]2024-09-13 13:06:17,939 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 0.830,  Train_accy 79.37
2024-09-13 13:06:17,940 [foster.py] => do not weight align student!

2024-09-13 13:06:23,498 [foster.py] => darknet eval: 
2024-09-13 13:06:23,498 [foster.py] => CNN top1 curve: 85.52
2024-09-13 13:06:23,498 [foster.py] => CNN top5 curve: 98.45
2024-09-13 13:06:23,500 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 13:07:55,651 [foster.py] => Exemplar size: 2400
2024-09-13 13:07:55,651 [trainer.py] => CNN: {'total': 86.23, '00-99': 91.75, '100-109': 79.13, '110-119': 35.4, 'old': 90.64, 'new': 35.4}
2024-09-13 13:07:55,651 [trainer.py] => NME: {'total': 88.98, '00-99': 88.97, '100-109': 91.3, '110-119': 86.73, 'old': 89.18, 'new': 86.73}
2024-09-13 13:07:55,652 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23]
2024-09-13 13:07:55,652 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66]
2024-09-13 13:07:55,652 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98]
2024-09-13 13:07:55,652 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66]

Average Accuracy (CNN): 88.8
Average Accuracy (NME): 90.31
2024-09-13 13:07:55,652 [trainer.py] => Average Accuracy (CNN): 88.8
2024-09-13 13:07:55,652 [trainer.py] => Average Accuracy (NME): 90.31
2024-09-13 13:07:55,654 [trainer.py] => All params: 171958622
2024-09-13 13:07:55,655 [trainer.py] => Trainable params: 86075376
2024-09-13 13:08:01,069 [foster.py] => Learning on 120-130
2024-09-13 13:08:01,073 [foster.py] => All params: 171989372
2024-09-13 13:08:01,074 [foster.py] => Trainable params: 86098436
2024-09-13 13:08:01,148 [foster.py] => per cls weights : [1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689 1.03519689
 0.57763734 0.57763734 0.57763734 0.57763734 0.57763734 0.57763734
 0.57763734 0.57763734 0.57763734 0.57763734]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.140, Loss_clf 0.934, Loss_fe 3.093, Loss_kd 1.027, Train_accy 78.11, Test_accy 84.96:   0%|          | 0/20 [00:43<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.140, Loss_clf 0.934, Loss_fe 3.093, Loss_kd 1.027, Train_accy 78.11, Test_accy 84.96:   5%|▌         | 1/20 [00:43<13:43, 43.34s/it]
Task 3, Epoch 2/20 => Loss 2.488, Loss_clf 0.508, Loss_fe 0.903, Loss_kd 0.994, Train_accy 81.12:   5%|▌         | 1/20 [01:16<13:43, 43.34s/it]                 
Task 3, Epoch 2/20 => Loss 2.488, Loss_clf 0.508, Loss_fe 0.903, Loss_kd 0.994, Train_accy 81.12:  10%|█         | 2/20 [01:16<11:17, 37.62s/it]
Task 3, Epoch 3/20 => Loss 2.196, Loss_clf 0.509, Loss_fe 0.651, Loss_kd 0.957, Train_accy 81.92:  10%|█         | 2/20 [01:50<11:17, 37.62s/it]
Task 3, Epoch 3/20 => Loss 2.196, Loss_clf 0.509, Loss_fe 0.651, Loss_kd 0.957, Train_accy 81.92:  15%|█▌        | 3/20 [01:50<10:09, 35.83s/it]
Task 3, Epoch 4/20 => Loss 2.098, Loss_clf 0.442, Loss_fe 0.598, Loss_kd 0.976, Train_accy 82.06:  15%|█▌        | 3/20 [02:24<10:09, 35.83s/it]
Task 3, Epoch 4/20 => Loss 2.098, Loss_clf 0.442, Loss_fe 0.598, Loss_kd 0.976, Train_accy 82.06:  20%|██        | 4/20 [02:24<09:19, 34.96s/it]
Task 3, Epoch 5/20 => Loss 1.947, Loss_clf 0.359, Loss_fe 0.507, Loss_kd 0.998, Train_accy 82.58:  20%|██        | 4/20 [02:58<09:19, 34.96s/it]
Task 3, Epoch 5/20 => Loss 1.947, Loss_clf 0.359, Loss_fe 0.507, Loss_kd 0.998, Train_accy 82.58:  25%|██▌       | 5/20 [02:58<08:38, 34.58s/it]
Task 3, Epoch 6/20 => Loss 2.000, Loss_clf 0.416, Loss_fe 0.500, Loss_kd 1.001, Train_accy 82.48, Test_accy 85.42:  25%|██▌       | 5/20 [03:41<08:38, 34.58s/it]
Task 3, Epoch 6/20 => Loss 2.000, Loss_clf 0.416, Loss_fe 0.500, Loss_kd 1.001, Train_accy 82.48, Test_accy 85.42:  30%|███       | 6/20 [03:41<08:46, 37.59s/it]
Task 3, Epoch 7/20 => Loss 1.913, Loss_clf 0.377, Loss_fe 0.469, Loss_kd 0.985, Train_accy 83.03:  30%|███       | 6/20 [04:14<08:46, 37.59s/it]                 
Task 3, Epoch 7/20 => Loss 1.913, Loss_clf 0.377, Loss_fe 0.469, Loss_kd 0.985, Train_accy 83.03:  35%|███▌      | 7/20 [04:14<07:50, 36.19s/it]
Task 3, Epoch 8/20 => Loss 1.844, Loss_clf 0.354, Loss_fe 0.431, Loss_kd 0.977, Train_accy 83.45:  35%|███▌      | 7/20 [04:48<07:50, 36.19s/it]
Task 3, Epoch 8/20 => Loss 1.844, Loss_clf 0.354, Loss_fe 0.431, Loss_kd 0.977, Train_accy 83.45:  40%|████      | 8/20 [04:48<07:02, 35.24s/it]
Task 3, Epoch 9/20 => Loss 1.756, Loss_clf 0.323, Loss_fe 0.383, Loss_kd 0.969, Train_accy 84.14:  40%|████      | 8/20 [05:21<07:02, 35.24s/it]
Task 3, Epoch 9/20 => Loss 1.756, Loss_clf 0.323, Loss_fe 0.383, Loss_kd 0.969, Train_accy 84.14:  45%|████▌     | 9/20 [05:21<06:20, 34.61s/it]
Task 3, Epoch 10/20 => Loss 1.913, Loss_clf 0.369, Loss_fe 0.421, Loss_kd 1.037, Train_accy 82.55:  45%|████▌     | 9/20 [05:54<06:20, 34.61s/it]
Task 3, Epoch 10/20 => Loss 1.913, Loss_clf 0.369, Loss_fe 0.421, Loss_kd 1.037, Train_accy 82.55:  50%|█████     | 10/20 [05:54<05:42, 34.21s/it]
Task 3, Epoch 11/20 => Loss 1.706, Loss_clf 0.338, Loss_fe 0.335, Loss_kd 0.953, Train_accy 83.52, Test_accy 86.41:  50%|█████     | 10/20 [06:38<05:42, 34.21s/it]
Task 3, Epoch 11/20 => Loss 1.706, Loss_clf 0.338, Loss_fe 0.335, Loss_kd 0.953, Train_accy 83.52, Test_accy 86.41:  55%|█████▌    | 11/20 [06:38<05:33, 37.11s/it]
Task 3, Epoch 12/20 => Loss 1.806, Loss_clf 0.383, Loss_fe 0.347, Loss_kd 0.993, Train_accy 84.00:  55%|█████▌    | 11/20 [07:11<05:33, 37.11s/it]                 
Task 3, Epoch 12/20 => Loss 1.806, Loss_clf 0.383, Loss_fe 0.347, Loss_kd 0.993, Train_accy 84.00:  60%|██████    | 12/20 [07:11<04:47, 35.96s/it]
Task 3, Epoch 13/20 => Loss 1.770, Loss_clf 0.330, Loss_fe 0.397, Loss_kd 0.962, Train_accy 83.76:  60%|██████    | 12/20 [07:45<04:47, 35.96s/it]
Task 3, Epoch 13/20 => Loss 1.770, Loss_clf 0.330, Loss_fe 0.397, Loss_kd 0.962, Train_accy 83.76:  65%|██████▌   | 13/20 [07:45<04:06, 35.16s/it]
Task 3, Epoch 14/20 => Loss 1.695, Loss_clf 0.314, Loss_fe 0.325, Loss_kd 0.974, Train_accy 84.07:  65%|██████▌   | 13/20 [08:18<04:06, 35.16s/it]
Task 3, Epoch 14/20 => Loss 1.695, Loss_clf 0.314, Loss_fe 0.325, Loss_kd 0.974, Train_accy 84.07:  70%|███████   | 14/20 [08:18<03:28, 34.71s/it]
Task 3, Epoch 15/20 => Loss 1.715, Loss_clf 0.324, Loss_fe 0.329, Loss_kd 0.980, Train_accy 83.31:  70%|███████   | 14/20 [08:52<03:28, 34.71s/it]
Task 3, Epoch 15/20 => Loss 1.715, Loss_clf 0.324, Loss_fe 0.329, Loss_kd 0.980, Train_accy 83.31:  75%|███████▌  | 15/20 [08:52<02:52, 34.46s/it]
Task 3, Epoch 16/20 => Loss 1.731, Loss_clf 0.329, Loss_fe 0.318, Loss_kd 1.001, Train_accy 84.11, Test_accy 86.67:  75%|███████▌  | 15/20 [09:36<02:52, 34.46s/it]
Task 3, Epoch 16/20 => Loss 1.731, Loss_clf 0.329, Loss_fe 0.318, Loss_kd 1.001, Train_accy 84.11, Test_accy 86.67:  80%|████████  | 16/20 [09:36<02:29, 37.36s/it]
Task 3, Epoch 17/20 => Loss 1.777, Loss_clf 0.333, Loss_fe 0.339, Loss_kd 1.020, Train_accy 83.59:  80%|████████  | 16/20 [10:10<02:29, 37.36s/it]                 
Task 3, Epoch 17/20 => Loss 1.777, Loss_clf 0.333, Loss_fe 0.339, Loss_kd 1.020, Train_accy 83.59:  85%|████████▌ | 17/20 [10:10<01:48, 36.31s/it]
Task 3, Epoch 18/20 => Loss 1.559, Loss_clf 0.261, Loss_fe 0.267, Loss_kd 0.952, Train_accy 84.94:  85%|████████▌ | 17/20 [10:44<01:48, 36.31s/it]
Task 3, Epoch 18/20 => Loss 1.559, Loss_clf 0.261, Loss_fe 0.267, Loss_kd 0.952, Train_accy 84.94:  90%|█████████ | 18/20 [10:44<01:11, 35.54s/it]
Task 3, Epoch 19/20 => Loss 1.703, Loss_clf 0.295, Loss_fe 0.302, Loss_kd 1.020, Train_accy 84.80:  90%|█████████ | 18/20 [11:17<01:11, 35.54s/it]
Task 3, Epoch 19/20 => Loss 1.703, Loss_clf 0.295, Loss_fe 0.302, Loss_kd 1.020, Train_accy 84.80:  95%|█████████▌| 19/20 [11:17<00:34, 34.87s/it]
Task 3, Epoch 20/20 => Loss 1.571, Loss_clf 0.273, Loss_fe 0.269, Loss_kd 0.950, Train_accy 85.15:  95%|█████████▌| 19/20 [11:50<00:34, 34.87s/it]
Task 3, Epoch 20/20 => Loss 1.571, Loss_clf 0.273, Loss_fe 0.269, Loss_kd 0.950, Train_accy 85.15: 100%|██████████| 20/20 [11:50<00:00, 34.36s/it]
Task 3, Epoch 20/20 => Loss 1.571, Loss_clf 0.273, Loss_fe 0.269, Loss_kd 0.950, Train_accy 85.15: 100%|██████████| 20/20 [11:50<00:00, 35.54s/it]2024-09-13 13:19:51,920 [foster.py] => Task 3, Epoch 20/20 => Loss 1.571, Loss_clf 0.273, Loss_fe 0.269, Loss_kd 0.950, Train_accy 85.15
2024-09-13 13:19:51,920 [foster.py] => do not weight align teacher!
2024-09-13 13:19:51,922 [foster.py] => per cls weights : [1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565 1.0436565
 1.0436565 0.476122  0.476122  0.476122  0.476122  0.476122  0.476122
 0.476122  0.476122  0.476122  0.476122 ]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.117,  Train_accy 77.72, Test_accy 85.29:   0%|          | 0/20 [00:47<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.117,  Train_accy 77.72, Test_accy 85.29:   5%|▌         | 1/20 [00:47<15:03, 47.58s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.003,  Train_accy 79.74:   5%|▌         | 1/20 [01:29<15:03, 47.58s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.003,  Train_accy 79.74:  10%|█         | 2/20 [01:29<13:15, 44.20s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.014,  Train_accy 81.05:  10%|█         | 2/20 [02:11<13:15, 44.20s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.014,  Train_accy 81.05:  15%|█▌        | 3/20 [02:11<12:12, 43.09s/it]
SNet: Task 3, Epoch 4/20 => Loss 0.955,  Train_accy 80.95:  15%|█▌        | 3/20 [02:52<12:12, 43.09s/it]
SNet: Task 3, Epoch 4/20 => Loss 0.955,  Train_accy 80.95:  20%|██        | 4/20 [02:52<11:20, 42.55s/it]
SNet: Task 3, Epoch 5/20 => Loss 0.992,  Train_accy 81.30:  20%|██        | 4/20 [03:34<11:20, 42.55s/it]
SNet: Task 3, Epoch 5/20 => Loss 0.992,  Train_accy 81.30:  25%|██▌       | 5/20 [03:34<10:33, 42.23s/it]
SNet: Task 3, Epoch 6/20 => Loss 0.941,  Train_accy 82.10, Test_accy 86.08:  25%|██▌       | 5/20 [04:22<10:33, 42.23s/it]
SNet: Task 3, Epoch 6/20 => Loss 0.941,  Train_accy 82.10, Test_accy 86.08:  30%|███       | 6/20 [04:22<10:18, 44.20s/it]
SNet: Task 3, Epoch 7/20 => Loss 0.998,  Train_accy 81.44:  30%|███       | 6/20 [05:05<10:18, 44.20s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 0.998,  Train_accy 81.44:  35%|███▌      | 7/20 [05:05<09:28, 43.73s/it]
SNet: Task 3, Epoch 8/20 => Loss 0.948,  Train_accy 82.51:  35%|███▌      | 7/20 [05:48<09:28, 43.73s/it]
SNet: Task 3, Epoch 8/20 => Loss 0.948,  Train_accy 82.51:  40%|████      | 8/20 [05:48<08:41, 43.44s/it]
SNet: Task 3, Epoch 9/20 => Loss 0.978,  Train_accy 81.96:  40%|████      | 8/20 [06:30<08:41, 43.44s/it]
SNet: Task 3, Epoch 9/20 => Loss 0.978,  Train_accy 81.96:  45%|████▌     | 9/20 [06:30<07:55, 43.19s/it]
SNet: Task 3, Epoch 10/20 => Loss 0.991,  Train_accy 81.89:  45%|████▌     | 9/20 [07:12<07:55, 43.19s/it]
SNet: Task 3, Epoch 10/20 => Loss 0.991,  Train_accy 81.89:  50%|█████     | 10/20 [07:12<07:08, 42.80s/it]
SNet: Task 3, Epoch 11/20 => Loss 0.940,  Train_accy 82.89, Test_accy 85.55:  50%|█████     | 10/20 [08:00<07:08, 42.80s/it]
SNet: Task 3, Epoch 11/20 => Loss 0.940,  Train_accy 82.89, Test_accy 85.55:  55%|█████▌    | 11/20 [08:00<06:38, 44.27s/it]
SNet: Task 3, Epoch 12/20 => Loss 0.965,  Train_accy 82.48:  55%|█████▌    | 11/20 [08:42<06:38, 44.27s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 0.965,  Train_accy 82.48:  60%|██████    | 12/20 [08:42<05:48, 43.52s/it]
SNet: Task 3, Epoch 13/20 => Loss 0.954,  Train_accy 82.65:  60%|██████    | 12/20 [09:24<05:48, 43.52s/it]
SNet: Task 3, Epoch 13/20 => Loss 0.954,  Train_accy 82.65:  65%|██████▌   | 13/20 [09:24<05:01, 43.03s/it]
SNet: Task 3, Epoch 14/20 => Loss 0.948,  Train_accy 82.13:  65%|██████▌   | 13/20 [10:06<05:01, 43.03s/it]
SNet: Task 3, Epoch 14/20 => Loss 0.948,  Train_accy 82.13:  70%|███████   | 14/20 [10:06<04:16, 42.71s/it]
SNet: Task 3, Epoch 15/20 => Loss 0.960,  Train_accy 81.61:  70%|███████   | 14/20 [10:47<04:16, 42.71s/it]
SNet: Task 3, Epoch 15/20 => Loss 0.960,  Train_accy 81.61:  75%|███████▌  | 15/20 [10:47<03:32, 42.45s/it]
SNet: Task 3, Epoch 16/20 => Loss 0.941,  Train_accy 82.79, Test_accy 86.01:  75%|███████▌  | 15/20 [11:35<03:32, 42.45s/it]
SNet: Task 3, Epoch 16/20 => Loss 0.941,  Train_accy 82.79, Test_accy 86.01:  80%|████████  | 16/20 [11:35<02:56, 44.06s/it]
SNet: Task 3, Epoch 17/20 => Loss 0.978,  Train_accy 83.41:  80%|████████  | 16/20 [12:18<02:56, 44.06s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 0.978,  Train_accy 83.41:  85%|████████▌ | 17/20 [12:18<02:10, 43.57s/it]
SNet: Task 3, Epoch 18/20 => Loss 0.941,  Train_accy 81.37:  85%|████████▌ | 17/20 [13:00<02:10, 43.57s/it]
SNet: Task 3, Epoch 18/20 => Loss 0.941,  Train_accy 81.37:  90%|█████████ | 18/20 [13:00<01:26, 43.26s/it]
SNet: Task 3, Epoch 19/20 => Loss 0.947,  Train_accy 81.47:  90%|█████████ | 18/20 [13:43<01:26, 43.26s/it]
SNet: Task 3, Epoch 19/20 => Loss 0.947,  Train_accy 81.47:  95%|█████████▌| 19/20 [13:43<00:43, 43.05s/it]
SNet: Task 3, Epoch 20/20 => Loss 0.932,  Train_accy 82.30:  95%|█████████▌| 19/20 [14:25<00:43, 43.05s/it]
SNet: Task 3, Epoch 20/20 => Loss 0.932,  Train_accy 82.30: 100%|██████████| 20/20 [14:25<00:00, 42.92s/it]
SNet: Task 3, Epoch 20/20 => Loss 0.932,  Train_accy 82.30: 100%|██████████| 20/20 [14:25<00:00, 43.29s/it]2024-09-13 13:34:22,580 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 0.932,  Train_accy 82.30
2024-09-13 13:34:22,580 [foster.py] => do not weight align student!

2024-09-13 13:34:28,243 [foster.py] => darknet eval: 
2024-09-13 13:34:28,244 [foster.py] => CNN top1 curve: 85.88
2024-09-13 13:34:28,244 [foster.py] => CNN top5 curve: 98.29
2024-09-13 13:34:28,247 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 13:36:11,426 [foster.py] => Exemplar size: 2600
2024-09-13 13:36:11,427 [trainer.py] => CNN: {'total': 86.74, '00-99': 91.84, '100-109': 86.96, '110-119': 66.37, '120-129': 51.4, 'old': 89.41, 'new': 51.4}
2024-09-13 13:36:11,427 [trainer.py] => NME: {'total': 88.25, '00-99': 88.64, '100-109': 92.17, '110-119': 80.53, '120-129': 87.85, 'old': 88.28, 'new': 87.85}
2024-09-13 13:36:11,427 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74]
2024-09-13 13:36:11,427 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42]
2024-09-13 13:36:11,427 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25]
2024-09-13 13:36:11,427 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69]

Average Accuracy (CNN): 88.29
Average Accuracy (NME): 89.8
2024-09-13 13:36:11,427 [trainer.py] => Average Accuracy (CNN): 88.29
2024-09-13 13:36:11,427 [trainer.py] => Average Accuracy (NME): 89.8
2024-09-13 13:36:11,429 [trainer.py] => All params: 171989372
2024-09-13 13:36:11,430 [trainer.py] => Trainable params: 86098436
2024-09-13 13:36:16,718 [foster.py] => Learning on 130-140
2024-09-13 13:36:16,721 [foster.py] => All params: 172020122
2024-09-13 13:36:16,723 [foster.py] => Trainable params: 86121496
2024-09-13 13:36:16,788 [foster.py] => per cls weights : [1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086 1.03260086
 1.03260086 1.03260086 1.03260086 1.03260086 0.57618877 0.57618877
 0.57618877 0.57618877 0.57618877 0.57618877 0.57618877 0.57618877
 0.57618877 0.57618877]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 5.318, Loss_clf 0.880, Loss_fe 3.321, Loss_kd 1.038, Train_accy 77.80, Test_accy 84.46:   0%|          | 0/20 [00:46<?, ?it/s]
Task 4, Epoch 1/20 => Loss 5.318, Loss_clf 0.880, Loss_fe 3.321, Loss_kd 1.038, Train_accy 77.80, Test_accy 84.46:   5%|▌         | 1/20 [00:46<14:36, 46.12s/it]
Task 4, Epoch 2/20 => Loss 2.542, Loss_clf 0.504, Loss_fe 0.948, Loss_kd 1.011, Train_accy 79.26:   5%|▌         | 1/20 [01:21<14:36, 46.12s/it]                 
Task 4, Epoch 2/20 => Loss 2.542, Loss_clf 0.504, Loss_fe 0.948, Loss_kd 1.011, Train_accy 79.26:  10%|█         | 2/20 [01:21<11:55, 39.74s/it]
Task 4, Epoch 3/20 => Loss 2.268, Loss_clf 0.472, Loss_fe 0.723, Loss_kd 0.996, Train_accy 79.85:  10%|█         | 2/20 [01:57<11:55, 39.74s/it]
Task 4, Epoch 3/20 => Loss 2.268, Loss_clf 0.472, Loss_fe 0.723, Loss_kd 0.996, Train_accy 79.85:  15%|█▌        | 3/20 [01:57<10:43, 37.88s/it]
Task 4, Epoch 4/20 => Loss 2.114, Loss_clf 0.402, Loss_fe 0.635, Loss_kd 1.000, Train_accy 80.92:  15%|█▌        | 3/20 [02:32<10:43, 37.88s/it]
Task 4, Epoch 4/20 => Loss 2.114, Loss_clf 0.402, Loss_fe 0.635, Loss_kd 1.000, Train_accy 80.92:  20%|██        | 4/20 [02:32<09:50, 36.93s/it]
Task 4, Epoch 5/20 => Loss 1.997, Loss_clf 0.398, Loss_fe 0.545, Loss_kd 0.978, Train_accy 81.97:  20%|██        | 4/20 [03:08<09:50, 36.93s/it]
Task 4, Epoch 5/20 => Loss 1.997, Loss_clf 0.398, Loss_fe 0.545, Loss_kd 0.978, Train_accy 81.97:  25%|██▌       | 5/20 [03:08<09:08, 36.60s/it]
Task 4, Epoch 6/20 => Loss 1.999, Loss_clf 0.391, Loss_fe 0.519, Loss_kd 1.012, Train_accy 81.90, Test_accy 84.28:  25%|██▌       | 5/20 [03:55<09:08, 36.60s/it]
Task 4, Epoch 6/20 => Loss 1.999, Loss_clf 0.391, Loss_fe 0.519, Loss_kd 1.012, Train_accy 81.90, Test_accy 84.28:  30%|███       | 6/20 [03:55<09:22, 40.19s/it]
Task 4, Epoch 7/20 => Loss 1.810, Loss_clf 0.335, Loss_fe 0.432, Loss_kd 0.969, Train_accy 82.94:  30%|███       | 6/20 [04:31<09:22, 40.19s/it]                 
Task 4, Epoch 7/20 => Loss 1.810, Loss_clf 0.335, Loss_fe 0.432, Loss_kd 0.969, Train_accy 82.94:  35%|███▌      | 7/20 [04:31<08:24, 38.84s/it]
Task 4, Epoch 8/20 => Loss 1.779, Loss_clf 0.338, Loss_fe 0.408, Loss_kd 0.959, Train_accy 83.63:  35%|███▌      | 7/20 [05:07<08:24, 38.84s/it]
Task 4, Epoch 8/20 => Loss 1.779, Loss_clf 0.338, Loss_fe 0.408, Loss_kd 0.959, Train_accy 83.63:  40%|████      | 8/20 [05:07<07:35, 37.96s/it]
Task 4, Epoch 9/20 => Loss 1.804, Loss_clf 0.347, Loss_fe 0.398, Loss_kd 0.983, Train_accy 83.11:  40%|████      | 8/20 [05:43<07:35, 37.96s/it]
Task 4, Epoch 9/20 => Loss 1.804, Loss_clf 0.347, Loss_fe 0.398, Loss_kd 0.983, Train_accy 83.11:  45%|████▌     | 9/20 [05:43<06:49, 37.21s/it]
Task 4, Epoch 10/20 => Loss 1.855, Loss_clf 0.365, Loss_fe 0.407, Loss_kd 1.005, Train_accy 83.01:  45%|████▌     | 9/20 [06:18<06:49, 37.21s/it]
Task 4, Epoch 10/20 => Loss 1.855, Loss_clf 0.365, Loss_fe 0.407, Loss_kd 1.005, Train_accy 83.01:  50%|█████     | 10/20 [06:18<06:06, 36.62s/it]
Task 4, Epoch 11/20 => Loss 1.722, Loss_clf 0.312, Loss_fe 0.363, Loss_kd 0.973, Train_accy 83.82, Test_accy 84.77:  50%|█████     | 10/20 [07:04<06:06, 36.62s/it]
Task 4, Epoch 11/20 => Loss 1.722, Loss_clf 0.312, Loss_fe 0.363, Loss_kd 0.973, Train_accy 83.82, Test_accy 84.77:  55%|█████▌    | 11/20 [07:04<05:56, 39.58s/it]
Task 4, Epoch 12/20 => Loss 1.817, Loss_clf 0.361, Loss_fe 0.368, Loss_kd 1.010, Train_accy 82.26:  55%|█████▌    | 11/20 [07:40<05:56, 39.58s/it]                 
Task 4, Epoch 12/20 => Loss 1.817, Loss_clf 0.361, Loss_fe 0.368, Loss_kd 1.010, Train_accy 82.26:  60%|██████    | 12/20 [07:40<05:06, 38.28s/it]
Task 4, Epoch 13/20 => Loss 1.807, Loss_clf 0.350, Loss_fe 0.366, Loss_kd 1.013, Train_accy 81.87:  60%|██████    | 12/20 [08:15<05:06, 38.28s/it]
Task 4, Epoch 13/20 => Loss 1.807, Loss_clf 0.350, Loss_fe 0.366, Loss_kd 1.013, Train_accy 81.87:  65%|██████▌   | 13/20 [08:15<04:22, 37.45s/it]
Task 4, Epoch 14/20 => Loss 1.755, Loss_clf 0.327, Loss_fe 0.333, Loss_kd 1.017, Train_accy 83.95:  65%|██████▌   | 13/20 [08:51<04:22, 37.45s/it]
Task 4, Epoch 14/20 => Loss 1.755, Loss_clf 0.327, Loss_fe 0.333, Loss_kd 1.017, Train_accy 83.95:  70%|███████   | 14/20 [08:51<03:41, 36.85s/it]
Task 4, Epoch 15/20 => Loss 1.669, Loss_clf 0.319, Loss_fe 0.311, Loss_kd 0.965, Train_accy 84.24:  70%|███████   | 14/20 [09:26<03:41, 36.85s/it]
Task 4, Epoch 15/20 => Loss 1.669, Loss_clf 0.319, Loss_fe 0.311, Loss_kd 0.965, Train_accy 84.24:  75%|███████▌  | 15/20 [09:26<03:02, 36.46s/it]
Task 4, Epoch 16/20 => Loss 1.684, Loss_clf 0.316, Loss_fe 0.303, Loss_kd 0.988, Train_accy 84.08, Test_accy 85.62:  75%|███████▌  | 15/20 [10:13<03:02, 36.46s/it]
Task 4, Epoch 16/20 => Loss 1.684, Loss_clf 0.316, Loss_fe 0.303, Loss_kd 0.988, Train_accy 84.08, Test_accy 85.62:  80%|████████  | 16/20 [10:13<02:37, 39.45s/it]
Task 4, Epoch 17/20 => Loss 1.578, Loss_clf 0.283, Loss_fe 0.269, Loss_kd 0.953, Train_accy 84.83:  80%|████████  | 16/20 [10:49<02:37, 39.45s/it]                 
Task 4, Epoch 17/20 => Loss 1.578, Loss_clf 0.283, Loss_fe 0.269, Loss_kd 0.953, Train_accy 84.83:  85%|████████▌ | 17/20 [10:49<01:55, 38.42s/it]
Task 4, Epoch 18/20 => Loss 1.726, Loss_clf 0.337, Loss_fe 0.315, Loss_kd 0.997, Train_accy 83.59:  85%|████████▌ | 17/20 [11:25<01:55, 38.42s/it]
Task 4, Epoch 18/20 => Loss 1.726, Loss_clf 0.337, Loss_fe 0.315, Loss_kd 0.997, Train_accy 83.59:  90%|█████████ | 18/20 [11:25<01:15, 37.74s/it]
Task 4, Epoch 19/20 => Loss 1.552, Loss_clf 0.273, Loss_fe 0.260, Loss_kd 0.947, Train_accy 85.22:  90%|█████████ | 18/20 [12:01<01:15, 37.74s/it]
Task 4, Epoch 19/20 => Loss 1.552, Loss_clf 0.273, Loss_fe 0.260, Loss_kd 0.947, Train_accy 85.22:  95%|█████████▌| 19/20 [12:01<00:37, 37.24s/it]
Task 4, Epoch 20/20 => Loss 1.676, Loss_clf 0.324, Loss_fe 0.290, Loss_kd 0.987, Train_accy 84.21:  95%|█████████▌| 19/20 [12:37<00:37, 37.24s/it]
Task 4, Epoch 20/20 => Loss 1.676, Loss_clf 0.324, Loss_fe 0.290, Loss_kd 0.987, Train_accy 84.21: 100%|██████████| 20/20 [12:37<00:00, 36.94s/it]
Task 4, Epoch 20/20 => Loss 1.676, Loss_clf 0.324, Loss_fe 0.290, Loss_kd 0.987, Train_accy 84.21: 100%|██████████| 20/20 [12:37<00:00, 37.89s/it]2024-09-13 13:48:54,563 [foster.py] => Task 4, Epoch 20/20 => Loss 1.676, Loss_clf 0.324, Loss_fe 0.290, Loss_kd 0.987, Train_accy 84.21
2024-09-13 13:48:54,564 [foster.py] => do not weight align teacher!
2024-09-13 13:48:54,568 [foster.py] => per cls weights : [1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216 1.04041216
 1.04041216 1.04041216 1.04041216 1.04041216 0.47464191 0.47464191
 0.47464191 0.47464191 0.47464191 0.47464191 0.47464191 0.47464191
 0.47464191 0.47464191]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.076,  Train_accy 78.52, Test_accy 84.46:   0%|          | 0/20 [00:51<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.076,  Train_accy 78.52, Test_accy 84.46:   5%|▌         | 1/20 [00:51<16:09, 51.01s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.009,  Train_accy 79.23:   5%|▌         | 1/20 [01:35<16:09, 51.01s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.009,  Train_accy 79.23:  10%|█         | 2/20 [01:35<14:10, 47.25s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.011,  Train_accy 80.86:  10%|█         | 2/20 [02:20<14:10, 47.25s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.011,  Train_accy 80.86:  15%|█▌        | 3/20 [02:20<13:02, 46.03s/it]
SNet: Task 4, Epoch 4/20 => Loss 0.994,  Train_accy 81.28:  15%|█▌        | 3/20 [03:04<13:02, 46.03s/it]
SNet: Task 4, Epoch 4/20 => Loss 0.994,  Train_accy 81.28:  20%|██        | 4/20 [03:04<12:07, 45.50s/it]
SNet: Task 4, Epoch 5/20 => Loss 0.968,  Train_accy 81.22:  20%|██        | 4/20 [03:49<12:07, 45.50s/it]
SNet: Task 4, Epoch 5/20 => Loss 0.968,  Train_accy 81.22:  25%|██▌       | 5/20 [03:49<11:18, 45.22s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.009,  Train_accy 80.66, Test_accy 84.64:  25%|██▌       | 5/20 [04:40<11:18, 45.22s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.009,  Train_accy 80.66, Test_accy 84.64:  30%|███       | 6/20 [04:40<11:00, 47.17s/it]
SNet: Task 4, Epoch 7/20 => Loss 0.988,  Train_accy 81.02:  30%|███       | 6/20 [05:25<11:00, 47.17s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 0.988,  Train_accy 81.02:  35%|███▌      | 7/20 [05:25<10:03, 46.39s/it]
SNet: Task 4, Epoch 8/20 => Loss 0.986,  Train_accy 80.96:  35%|███▌      | 7/20 [06:10<10:03, 46.39s/it]
SNet: Task 4, Epoch 8/20 => Loss 0.986,  Train_accy 80.96:  40%|████      | 8/20 [06:10<09:12, 46.05s/it]
SNet: Task 4, Epoch 9/20 => Loss 0.997,  Train_accy 80.99:  40%|████      | 8/20 [06:56<09:12, 46.05s/it]
SNet: Task 4, Epoch 9/20 => Loss 0.997,  Train_accy 80.99:  45%|████▌     | 9/20 [06:56<08:24, 45.82s/it]
SNet: Task 4, Epoch 10/20 => Loss 0.991,  Train_accy 80.89:  45%|████▌     | 9/20 [07:41<08:24, 45.82s/it]
SNet: Task 4, Epoch 10/20 => Loss 0.991,  Train_accy 80.89:  50%|█████     | 10/20 [07:41<07:36, 45.67s/it]
SNet: Task 4, Epoch 11/20 => Loss 0.973,  Train_accy 81.28, Test_accy 84.70:  50%|█████     | 10/20 [08:32<07:36, 45.67s/it]
SNet: Task 4, Epoch 11/20 => Loss 0.973,  Train_accy 81.28, Test_accy 84.70:  55%|█████▌    | 11/20 [08:32<07:05, 47.29s/it]
SNet: Task 4, Epoch 12/20 => Loss 0.982,  Train_accy 80.86:  55%|█████▌    | 11/20 [09:16<07:05, 47.29s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 0.982,  Train_accy 80.86:  60%|██████    | 12/20 [09:16<06:11, 46.42s/it]
SNet: Task 4, Epoch 13/20 => Loss 0.947,  Train_accy 81.67:  60%|██████    | 12/20 [10:01<06:11, 46.42s/it]
SNet: Task 4, Epoch 13/20 => Loss 0.947,  Train_accy 81.67:  65%|██████▌   | 13/20 [10:01<05:20, 45.84s/it]
SNet: Task 4, Epoch 14/20 => Loss 0.991,  Train_accy 80.47:  65%|██████▌   | 13/20 [10:45<05:20, 45.84s/it]
SNet: Task 4, Epoch 14/20 => Loss 0.991,  Train_accy 80.47:  70%|███████   | 14/20 [10:45<04:32, 45.46s/it]
SNet: Task 4, Epoch 15/20 => Loss 0.983,  Train_accy 81.02:  70%|███████   | 14/20 [11:30<04:32, 45.46s/it]
SNet: Task 4, Epoch 15/20 => Loss 0.983,  Train_accy 81.02:  75%|███████▌  | 15/20 [11:30<03:45, 45.11s/it]
SNet: Task 4, Epoch 16/20 => Loss 0.976,  Train_accy 81.05, Test_accy 84.52:  75%|███████▌  | 15/20 [12:20<03:45, 45.11s/it]
SNet: Task 4, Epoch 16/20 => Loss 0.976,  Train_accy 81.05, Test_accy 84.52:  80%|████████  | 16/20 [12:20<03:07, 46.80s/it]
SNet: Task 4, Epoch 17/20 => Loss 0.977,  Train_accy 81.71:  80%|████████  | 16/20 [13:05<03:07, 46.80s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 0.977,  Train_accy 81.71:  85%|████████▌ | 17/20 [13:05<02:18, 46.08s/it]
SNet: Task 4, Epoch 18/20 => Loss 0.992,  Train_accy 81.25:  85%|████████▌ | 17/20 [13:50<02:18, 46.08s/it]
SNet: Task 4, Epoch 18/20 => Loss 0.992,  Train_accy 81.25:  90%|█████████ | 18/20 [13:50<01:31, 45.84s/it]
SNet: Task 4, Epoch 19/20 => Loss 0.978,  Train_accy 81.41:  90%|█████████ | 18/20 [14:35<01:31, 45.84s/it]
SNet: Task 4, Epoch 19/20 => Loss 0.978,  Train_accy 81.41:  95%|█████████▌| 19/20 [14:35<00:45, 45.72s/it]
SNet: Task 4, Epoch 20/20 => Loss 0.953,  Train_accy 81.38:  95%|█████████▌| 19/20 [15:21<00:45, 45.72s/it]
SNet: Task 4, Epoch 20/20 => Loss 0.953,  Train_accy 81.38: 100%|██████████| 20/20 [15:21<00:00, 45.61s/it]
SNet: Task 4, Epoch 20/20 => Loss 0.953,  Train_accy 81.38: 100%|██████████| 20/20 [15:21<00:00, 46.06s/it]2024-09-13 14:04:19,069 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 0.953,  Train_accy 81.38
2024-09-13 14:04:19,069 [foster.py] => do not weight align student!

2024-09-13 14:04:25,260 [foster.py] => darknet eval: 
2024-09-13 14:04:25,260 [foster.py] => CNN top1 curve: 84.4
2024-09-13 14:04:25,260 [foster.py] => CNN top5 curve: 97.87
2024-09-13 14:04:25,264 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 14:06:12,644 [foster.py] => Exemplar size: 2800
2024-09-13 14:06:12,644 [trainer.py] => CNN: {'total': 85.56, '00-99': 90.82, '100-109': 89.57, '110-119': 78.76, '120-129': 75.7, '130-139': 44.07, 'old': 88.77, 'new': 44.07}
2024-09-13 14:06:12,644 [trainer.py] => NME: {'total': 88.54, '00-99': 89.23, '100-109': 93.04, '110-119': 81.42, '120-129': 83.18, '130-139': 88.98, 'old': 88.51, 'new': 88.98}
2024-09-13 14:06:12,644 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74, 85.56]
2024-09-13 14:06:12,644 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42, 98.11]
2024-09-13 14:06:12,644 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25, 88.54]
2024-09-13 14:06:12,644 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69, 98.66]

Average Accuracy (CNN): 87.74
Average Accuracy (NME): 89.54
2024-09-13 14:06:12,644 [trainer.py] => Average Accuracy (CNN): 87.74
2024-09-13 14:06:12,645 [trainer.py] => Average Accuracy (NME): 89.54
2024-09-13 14:06:12,646 [trainer.py] => All params: 172020122
2024-09-13 14:06:12,647 [trainer.py] => Trainable params: 86121496
2024-09-13 14:06:18,497 [foster.py] => Learning on 140-150
2024-09-13 14:06:18,500 [foster.py] => All params: 172050872
2024-09-13 14:06:18,500 [foster.py] => Trainable params: 86144556
2024-09-13 14:06:18,561 [foster.py] => per cls weights : [1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149 1.03036149
 1.03036149 1.03036149 0.5749392  0.5749392  0.5749392  0.5749392
 0.5749392  0.5749392  0.5749392  0.5749392  0.5749392  0.5749392 ]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.683, Loss_clf 0.881, Loss_fe 3.658, Loss_kd 1.068, Train_accy 78.32, Test_accy 82.97:   0%|          | 0/20 [00:49<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.683, Loss_clf 0.881, Loss_fe 3.658, Loss_kd 1.068, Train_accy 78.32, Test_accy 82.97:   5%|▌         | 1/20 [00:49<15:31, 49.02s/it]
Task 5, Epoch 2/20 => Loss 2.667, Loss_clf 0.498, Loss_fe 1.046, Loss_kd 1.048, Train_accy 80.90:   5%|▌         | 1/20 [01:26<15:31, 49.02s/it]                 
Task 5, Epoch 2/20 => Loss 2.667, Loss_clf 0.498, Loss_fe 1.046, Loss_kd 1.048, Train_accy 80.90:  10%|█         | 2/20 [01:26<12:39, 42.20s/it]
Task 5, Epoch 3/20 => Loss 2.340, Loss_clf 0.464, Loss_fe 0.762, Loss_kd 1.039, Train_accy 82.23:  10%|█         | 2/20 [02:03<12:39, 42.20s/it]
Task 5, Epoch 3/20 => Loss 2.340, Loss_clf 0.464, Loss_fe 0.762, Loss_kd 1.039, Train_accy 82.23:  15%|█▌        | 3/20 [02:03<11:20, 40.02s/it]
Task 5, Epoch 4/20 => Loss 2.261, Loss_clf 0.443, Loss_fe 0.702, Loss_kd 1.042, Train_accy 81.18:  15%|█▌        | 3/20 [02:41<11:20, 40.02s/it]
Task 5, Epoch 4/20 => Loss 2.261, Loss_clf 0.443, Loss_fe 0.702, Loss_kd 1.042, Train_accy 81.18:  20%|██        | 4/20 [02:41<10:25, 39.09s/it]
Task 5, Epoch 5/20 => Loss 2.257, Loss_clf 0.459, Loss_fe 0.640, Loss_kd 1.082, Train_accy 80.66:  20%|██        | 4/20 [03:19<10:25, 39.09s/it]
Task 5, Epoch 5/20 => Loss 2.257, Loss_clf 0.459, Loss_fe 0.640, Loss_kd 1.082, Train_accy 80.66:  25%|██▌       | 5/20 [03:19<09:41, 38.77s/it]
Task 5, Epoch 6/20 => Loss 2.061, Loss_clf 0.405, Loss_fe 0.544, Loss_kd 1.038, Train_accy 82.56, Test_accy 83.31:  25%|██▌       | 5/20 [04:09<09:41, 38.77s/it]
Task 5, Epoch 6/20 => Loss 2.061, Loss_clf 0.405, Loss_fe 0.544, Loss_kd 1.038, Train_accy 82.56, Test_accy 83.31:  30%|███       | 6/20 [04:09<09:56, 42.60s/it]
Task 5, Epoch 7/20 => Loss 2.010, Loss_clf 0.384, Loss_fe 0.503, Loss_kd 1.048, Train_accy 81.98:  30%|███       | 6/20 [04:48<09:56, 42.60s/it]                 
Task 5, Epoch 7/20 => Loss 2.010, Loss_clf 0.384, Loss_fe 0.503, Loss_kd 1.048, Train_accy 81.98:  35%|███▌      | 7/20 [04:48<08:55, 41.18s/it]
Task 5, Epoch 8/20 => Loss 2.000, Loss_clf 0.390, Loss_fe 0.471, Loss_kd 1.063, Train_accy 82.56:  35%|███▌      | 7/20 [05:26<08:55, 41.18s/it]
Task 5, Epoch 8/20 => Loss 2.000, Loss_clf 0.390, Loss_fe 0.471, Loss_kd 1.063, Train_accy 82.56:  40%|████      | 8/20 [05:26<08:02, 40.24s/it]
Task 5, Epoch 9/20 => Loss 1.972, Loss_clf 0.380, Loss_fe 0.455, Loss_kd 1.061, Train_accy 82.50:  40%|████      | 8/20 [06:04<08:02, 40.24s/it]
Task 5, Epoch 9/20 => Loss 1.972, Loss_clf 0.380, Loss_fe 0.455, Loss_kd 1.061, Train_accy 82.50:  45%|████▌     | 9/20 [06:04<07:15, 39.62s/it]
Task 5, Epoch 10/20 => Loss 1.925, Loss_clf 0.364, Loss_fe 0.426, Loss_kd 1.059, Train_accy 82.93:  45%|████▌     | 9/20 [06:42<07:15, 39.62s/it]
Task 5, Epoch 10/20 => Loss 1.925, Loss_clf 0.364, Loss_fe 0.426, Loss_kd 1.059, Train_accy 82.93:  50%|█████     | 10/20 [06:42<06:31, 39.18s/it]
Task 5, Epoch 11/20 => Loss 1.904, Loss_clf 0.380, Loss_fe 0.400, Loss_kd 1.050, Train_accy 82.63, Test_accy 83.64:  50%|█████     | 10/20 [07:32<06:31, 39.18s/it]
Task 5, Epoch 11/20 => Loss 1.904, Loss_clf 0.380, Loss_fe 0.400, Loss_kd 1.050, Train_accy 82.63, Test_accy 83.64:  55%|█████▌    | 11/20 [07:32<06:22, 42.51s/it]
Task 5, Epoch 12/20 => Loss 1.810, Loss_clf 0.348, Loss_fe 0.365, Loss_kd 1.023, Train_accy 83.12:  55%|█████▌    | 11/20 [08:10<06:22, 42.51s/it]                 
Task 5, Epoch 12/20 => Loss 1.810, Loss_clf 0.348, Loss_fe 0.365, Loss_kd 1.023, Train_accy 83.12:  60%|██████    | 12/20 [08:10<05:29, 41.20s/it]
Task 5, Epoch 13/20 => Loss 1.778, Loss_clf 0.329, Loss_fe 0.348, Loss_kd 1.027, Train_accy 83.86:  60%|██████    | 12/20 [08:49<05:29, 41.20s/it]
Task 5, Epoch 13/20 => Loss 1.778, Loss_clf 0.329, Loss_fe 0.348, Loss_kd 1.027, Train_accy 83.86:  65%|██████▌   | 13/20 [08:49<04:42, 40.33s/it]
Task 5, Epoch 14/20 => Loss 1.745, Loss_clf 0.319, Loss_fe 0.322, Loss_kd 1.030, Train_accy 83.55:  65%|██████▌   | 13/20 [09:27<04:42, 40.33s/it]
Task 5, Epoch 14/20 => Loss 1.745, Loss_clf 0.319, Loss_fe 0.322, Loss_kd 1.030, Train_accy 83.55:  70%|███████   | 14/20 [09:27<03:58, 39.73s/it]
Task 5, Epoch 15/20 => Loss 1.797, Loss_clf 0.343, Loss_fe 0.329, Loss_kd 1.050, Train_accy 83.03:  70%|███████   | 14/20 [10:05<03:58, 39.73s/it]
Task 5, Epoch 15/20 => Loss 1.797, Loss_clf 0.343, Loss_fe 0.329, Loss_kd 1.050, Train_accy 83.03:  75%|███████▌  | 15/20 [10:05<03:16, 39.29s/it]
Task 5, Epoch 16/20 => Loss 1.788, Loss_clf 0.345, Loss_fe 0.330, Loss_kd 1.039, Train_accy 83.95, Test_accy 83.59:  75%|███████▌  | 15/20 [10:56<03:16, 39.29s/it]
Task 5, Epoch 16/20 => Loss 1.788, Loss_clf 0.345, Loss_fe 0.330, Loss_kd 1.039, Train_accy 83.95, Test_accy 83.59:  80%|████████  | 16/20 [10:56<02:50, 42.55s/it]
Task 5, Epoch 17/20 => Loss 1.708, Loss_clf 0.320, Loss_fe 0.294, Loss_kd 1.020, Train_accy 83.92:  80%|████████  | 16/20 [11:34<02:50, 42.55s/it]                 
Task 5, Epoch 17/20 => Loss 1.708, Loss_clf 0.320, Loss_fe 0.294, Loss_kd 1.020, Train_accy 83.92:  85%|████████▌ | 17/20 [11:34<02:03, 41.23s/it]
Task 5, Epoch 18/20 => Loss 1.736, Loss_clf 0.322, Loss_fe 0.301, Loss_kd 1.039, Train_accy 84.13:  85%|████████▌ | 17/20 [12:12<02:03, 41.23s/it]
Task 5, Epoch 18/20 => Loss 1.736, Loss_clf 0.322, Loss_fe 0.301, Loss_kd 1.039, Train_accy 84.13:  90%|█████████ | 18/20 [12:12<01:20, 40.33s/it]
Task 5, Epoch 19/20 => Loss 1.679, Loss_clf 0.299, Loss_fe 0.287, Loss_kd 1.019, Train_accy 84.44:  90%|█████████ | 18/20 [12:50<01:20, 40.33s/it]
Task 5, Epoch 19/20 => Loss 1.679, Loss_clf 0.299, Loss_fe 0.287, Loss_kd 1.019, Train_accy 84.44:  95%|█████████▌| 19/20 [12:50<00:39, 39.70s/it]
Task 5, Epoch 20/20 => Loss 1.846, Loss_clf 0.361, Loss_fe 0.342, Loss_kd 1.067, Train_accy 83.58:  95%|█████████▌| 19/20 [13:28<00:39, 39.70s/it]
Task 5, Epoch 20/20 => Loss 1.846, Loss_clf 0.361, Loss_fe 0.342, Loss_kd 1.067, Train_accy 83.58: 100%|██████████| 20/20 [13:28<00:00, 39.25s/it]
Task 5, Epoch 20/20 => Loss 1.846, Loss_clf 0.361, Loss_fe 0.342, Loss_kd 1.067, Train_accy 83.58: 100%|██████████| 20/20 [13:28<00:00, 40.44s/it]2024-09-13 14:19:47,454 [foster.py] => Task 5, Epoch 20/20 => Loss 1.846, Loss_clf 0.361, Loss_fe 0.342, Loss_kd 1.067, Train_accy 83.58
2024-09-13 14:19:47,455 [foster.py] => do not weight align teacher!
2024-09-13 14:19:47,457 [foster.py] => per cls weights : [1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667 1.03761667
 1.03761667 1.03761667 0.4733666  0.4733666  0.4733666  0.4733666
 0.4733666  0.4733666  0.4733666  0.4733666  0.4733666  0.4733666 ]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.058,  Train_accy 79.52, Test_accy 84.10:   0%|          | 0/20 [00:54<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.058,  Train_accy 79.52, Test_accy 84.10:   5%|▌         | 1/20 [00:54<17:14, 54.46s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.043,  Train_accy 79.80:   5%|▌         | 1/20 [01:42<17:14, 54.46s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.043,  Train_accy 79.80:  10%|█         | 2/20 [01:42<15:13, 50.73s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.004,  Train_accy 81.33:  10%|█         | 2/20 [02:30<15:13, 50.73s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.004,  Train_accy 81.33:  15%|█▌        | 3/20 [02:30<14:01, 49.48s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.021,  Train_accy 80.47:  15%|█▌        | 3/20 [03:18<14:01, 49.48s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.021,  Train_accy 80.47:  20%|██        | 4/20 [03:18<13:02, 48.91s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.010,  Train_accy 81.33:  20%|██        | 4/20 [04:06<13:02, 48.91s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.010,  Train_accy 81.33:  25%|██▌       | 5/20 [04:06<12:09, 48.62s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.020,  Train_accy 81.15, Test_accy 84.32:  25%|██▌       | 5/20 [05:01<12:09, 48.62s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.020,  Train_accy 81.15, Test_accy 84.32:  30%|███       | 6/20 [05:01<11:48, 50.61s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.034,  Train_accy 80.50:  30%|███       | 6/20 [05:49<11:48, 50.61s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.034,  Train_accy 80.50:  35%|███▌      | 7/20 [05:49<10:46, 49.76s/it]
SNet: Task 5, Epoch 8/20 => Loss 0.994,  Train_accy 81.61:  35%|███▌      | 7/20 [06:37<10:46, 49.76s/it]
SNet: Task 5, Epoch 8/20 => Loss 0.994,  Train_accy 81.61:  40%|████      | 8/20 [06:37<09:50, 49.19s/it]
SNet: Task 5, Epoch 9/20 => Loss 0.986,  Train_accy 82.10:  40%|████      | 8/20 [07:25<09:50, 49.19s/it]
SNet: Task 5, Epoch 9/20 => Loss 0.986,  Train_accy 82.10:  45%|████▌     | 9/20 [07:25<08:56, 48.80s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.025,  Train_accy 81.27:  45%|████▌     | 9/20 [08:13<08:56, 48.80s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.025,  Train_accy 81.27:  50%|█████     | 10/20 [08:13<08:05, 48.56s/it]
SNet: Task 5, Epoch 11/20 => Loss 0.994,  Train_accy 81.67, Test_accy 83.53:  50%|█████     | 10/20 [09:07<08:05, 48.56s/it]
SNet: Task 5, Epoch 11/20 => Loss 0.994,  Train_accy 81.67, Test_accy 83.53:  55%|█████▌    | 11/20 [09:07<07:33, 50.35s/it]
SNet: Task 5, Epoch 12/20 => Loss 0.997,  Train_accy 81.73:  55%|█████▌    | 11/20 [09:55<07:33, 50.35s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 0.997,  Train_accy 81.73:  60%|██████    | 12/20 [09:55<06:37, 49.64s/it]
SNet: Task 5, Epoch 13/20 => Loss 0.992,  Train_accy 82.07:  60%|██████    | 12/20 [10:43<06:37, 49.64s/it]
SNet: Task 5, Epoch 13/20 => Loss 0.992,  Train_accy 82.07:  65%|██████▌   | 13/20 [10:43<05:43, 49.14s/it]
SNet: Task 5, Epoch 14/20 => Loss 0.973,  Train_accy 81.77:  65%|██████▌   | 13/20 [11:31<05:43, 49.14s/it]
SNet: Task 5, Epoch 14/20 => Loss 0.973,  Train_accy 81.77:  70%|███████   | 14/20 [11:31<04:52, 48.78s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.011,  Train_accy 80.87:  70%|███████   | 14/20 [12:19<04:52, 48.78s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.011,  Train_accy 80.87:  75%|███████▌  | 15/20 [12:19<04:02, 48.52s/it]
SNet: Task 5, Epoch 16/20 => Loss 0.996,  Train_accy 81.33, Test_accy 83.70:  75%|███████▌  | 15/20 [13:13<04:02, 48.52s/it]
SNet: Task 5, Epoch 16/20 => Loss 0.996,  Train_accy 81.33, Test_accy 83.70:  80%|████████  | 16/20 [13:13<03:21, 50.29s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.002,  Train_accy 81.37:  80%|████████  | 16/20 [14:01<03:21, 50.29s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.002,  Train_accy 81.37:  85%|████████▌ | 17/20 [14:01<02:28, 49.57s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.013,  Train_accy 80.97:  85%|████████▌ | 17/20 [14:49<02:28, 49.57s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.013,  Train_accy 80.97:  90%|█████████ | 18/20 [14:49<01:38, 49.09s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.010,  Train_accy 82.38:  90%|█████████ | 18/20 [15:37<01:38, 49.09s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.010,  Train_accy 82.38:  95%|█████████▌| 19/20 [15:37<00:48, 48.73s/it]
SNet: Task 5, Epoch 20/20 => Loss 0.996,  Train_accy 81.83:  95%|█████████▌| 19/20 [16:25<00:48, 48.73s/it]
SNet: Task 5, Epoch 20/20 => Loss 0.996,  Train_accy 81.83: 100%|██████████| 20/20 [16:25<00:00, 48.51s/it]
SNet: Task 5, Epoch 20/20 => Loss 0.996,  Train_accy 81.83: 100%|██████████| 20/20 [16:25<00:00, 49.28s/it]2024-09-13 14:36:15,524 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 0.996,  Train_accy 81.83
2024-09-13 14:36:15,525 [foster.py] => do not weight align student!

2024-09-13 14:36:21,990 [foster.py] => darknet eval: 
2024-09-13 14:36:21,991 [foster.py] => CNN top1 curve: 83.87
2024-09-13 14:36:21,991 [foster.py] => CNN top5 curve: 97.91
2024-09-13 14:36:21,993 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 14:38:10,585 [foster.py] => Exemplar size: 3000
2024-09-13 14:38:10,585 [trainer.py] => CNN: {'total': 84.32, '00-99': 89.98, '100-109': 90.43, '110-119': 82.3, '120-129': 84.11, '130-139': 72.88, '140-149': 38.1, 'old': 87.87, 'new': 38.1}
2024-09-13 14:38:10,585 [trainer.py] => NME: {'total': 88.57, '00-99': 88.72, '100-109': 92.17, '110-119': 83.19, '120-129': 85.98, '130-139': 88.98, '140-149': 90.48, 'old': 88.42, 'new': 90.48}
2024-09-13 14:38:10,585 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74, 85.56, 84.32]
2024-09-13 14:38:10,585 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42, 98.11, 97.85]
2024-09-13 14:38:10,585 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25, 88.54, 88.57]
2024-09-13 14:38:10,586 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69, 98.66, 98.53]

Average Accuracy (CNN): 87.17
Average Accuracy (NME): 89.38
2024-09-13 14:38:10,586 [trainer.py] => Average Accuracy (CNN): 87.17
2024-09-13 14:38:10,586 [trainer.py] => Average Accuracy (NME): 89.38
2024-09-13 14:38:10,588 [trainer.py] => All params: 172050872
2024-09-13 14:38:10,590 [trainer.py] => Trainable params: 86144556
2024-09-13 14:38:13,809 [foster.py] => Learning on 150-160
2024-09-13 14:38:13,810 [foster.py] => All params: 172081622
2024-09-13 14:38:13,811 [foster.py] => Trainable params: 86167616
2024-09-13 14:38:13,872 [foster.py] => per cls weights : [1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998 1.02840998
 0.57385027 0.57385027 0.57385027 0.57385027 0.57385027 0.57385027
 0.57385027 0.57385027 0.57385027 0.57385027]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 5.258, Loss_clf 0.881, Loss_fe 3.184, Loss_kd 1.118, Train_accy 78.63, Test_accy 81.70:   0%|          | 0/20 [00:53<?, ?it/s]
Task 6, Epoch 1/20 => Loss 5.258, Loss_clf 0.881, Loss_fe 3.184, Loss_kd 1.118, Train_accy 78.63, Test_accy 81.70:   5%|▌         | 1/20 [00:53<16:54, 53.41s/it]
Task 6, Epoch 2/20 => Loss 2.758, Loss_clf 0.551, Loss_fe 1.031, Loss_kd 1.103, Train_accy 80.39:   5%|▌         | 1/20 [01:34<16:54, 53.41s/it]                 
Task 6, Epoch 2/20 => Loss 2.758, Loss_clf 0.551, Loss_fe 1.031, Loss_kd 1.103, Train_accy 80.39:  10%|█         | 2/20 [01:34<13:46, 45.91s/it]
Task 6, Epoch 3/20 => Loss 2.426, Loss_clf 0.474, Loss_fe 0.780, Loss_kd 1.099, Train_accy 81.55:  10%|█         | 2/20 [02:14<13:46, 45.91s/it]
Task 6, Epoch 3/20 => Loss 2.426, Loss_clf 0.474, Loss_fe 0.780, Loss_kd 1.099, Train_accy 81.55:  15%|█▌        | 3/20 [02:14<12:19, 43.52s/it]
Task 6, Epoch 4/20 => Loss 2.229, Loss_clf 0.430, Loss_fe 0.657, Loss_kd 1.070, Train_accy 83.19:  15%|█▌        | 3/20 [02:55<12:19, 43.52s/it]
Task 6, Epoch 4/20 => Loss 2.229, Loss_clf 0.430, Loss_fe 0.657, Loss_kd 1.070, Train_accy 83.19:  20%|██        | 4/20 [02:55<11:18, 42.39s/it]
Task 6, Epoch 5/20 => Loss 2.173, Loss_clf 0.425, Loss_fe 0.595, Loss_kd 1.082, Train_accy 82.32:  20%|██        | 4/20 [03:36<11:18, 42.39s/it]
Task 6, Epoch 5/20 => Loss 2.173, Loss_clf 0.425, Loss_fe 0.595, Loss_kd 1.082, Train_accy 82.32:  25%|██▌       | 5/20 [03:36<10:26, 41.78s/it]
Task 6, Epoch 6/20 => Loss 2.155, Loss_clf 0.435, Loss_fe 0.553, Loss_kd 1.094, Train_accy 82.35, Test_accy 83.50:  25%|██▌       | 5/20 [04:29<10:26, 41.78s/it]
Task 6, Epoch 6/20 => Loss 2.155, Loss_clf 0.435, Loss_fe 0.553, Loss_kd 1.094, Train_accy 82.35, Test_accy 83.50:  30%|███       | 6/20 [04:29<10:39, 45.69s/it]
Task 6, Epoch 7/20 => Loss 2.081, Loss_clf 0.422, Loss_fe 0.509, Loss_kd 1.077, Train_accy 82.55:  30%|███       | 6/20 [05:10<10:39, 45.69s/it]                 
Task 6, Epoch 7/20 => Loss 2.081, Loss_clf 0.422, Loss_fe 0.509, Loss_kd 1.077, Train_accy 82.55:  35%|███▌      | 7/20 [05:10<09:32, 44.05s/it]
Task 6, Epoch 8/20 => Loss 2.047, Loss_clf 0.402, Loss_fe 0.480, Loss_kd 1.092, Train_accy 83.10:  35%|███▌      | 7/20 [05:50<09:32, 44.05s/it]
Task 6, Epoch 8/20 => Loss 2.047, Loss_clf 0.402, Loss_fe 0.480, Loss_kd 1.092, Train_accy 83.10:  40%|████      | 8/20 [05:50<08:35, 42.99s/it]
Task 6, Epoch 9/20 => Loss 2.041, Loss_clf 0.410, Loss_fe 0.462, Loss_kd 1.096, Train_accy 83.19:  40%|████      | 8/20 [06:31<08:35, 42.99s/it]
Task 6, Epoch 9/20 => Loss 2.041, Loss_clf 0.410, Loss_fe 0.462, Loss_kd 1.096, Train_accy 83.19:  45%|████▌     | 9/20 [06:31<07:45, 42.31s/it]
Task 6, Epoch 10/20 => Loss 1.941, Loss_clf 0.380, Loss_fe 0.419, Loss_kd 1.071, Train_accy 83.82:  45%|████▌     | 9/20 [07:12<07:45, 42.31s/it]
Task 6, Epoch 10/20 => Loss 1.941, Loss_clf 0.380, Loss_fe 0.419, Loss_kd 1.071, Train_accy 83.82:  50%|█████     | 10/20 [07:12<06:58, 41.84s/it]
Task 6, Epoch 11/20 => Loss 1.893, Loss_clf 0.353, Loss_fe 0.390, Loss_kd 1.078, Train_accy 84.40, Test_accy 83.82:  50%|█████     | 10/20 [08:05<06:58, 41.84s/it]
Task 6, Epoch 11/20 => Loss 1.893, Loss_clf 0.353, Loss_fe 0.390, Loss_kd 1.078, Train_accy 84.40, Test_accy 83.82:  55%|█████▌    | 11/20 [08:05<06:48, 45.37s/it]
Task 6, Epoch 12/20 => Loss 1.932, Loss_clf 0.382, Loss_fe 0.389, Loss_kd 1.089, Train_accy 82.90:  55%|█████▌    | 11/20 [08:46<06:48, 45.37s/it]                 
Task 6, Epoch 12/20 => Loss 1.932, Loss_clf 0.382, Loss_fe 0.389, Loss_kd 1.089, Train_accy 82.90:  60%|██████    | 12/20 [08:46<05:51, 43.99s/it]
Task 6, Epoch 13/20 => Loss 1.834, Loss_clf 0.339, Loss_fe 0.342, Loss_kd 1.080, Train_accy 84.28:  60%|██████    | 12/20 [09:27<05:51, 43.99s/it]
Task 6, Epoch 13/20 => Loss 1.834, Loss_clf 0.339, Loss_fe 0.342, Loss_kd 1.080, Train_accy 84.28:  65%|██████▌   | 13/20 [09:27<05:01, 43.01s/it]
Task 6, Epoch 14/20 => Loss 1.763, Loss_clf 0.332, Loss_fe 0.317, Loss_kd 1.044, Train_accy 84.66:  65%|██████▌   | 13/20 [10:08<05:01, 43.01s/it]
Task 6, Epoch 14/20 => Loss 1.763, Loss_clf 0.332, Loss_fe 0.317, Loss_kd 1.044, Train_accy 84.66:  70%|███████   | 14/20 [10:08<04:13, 42.33s/it]
Task 6, Epoch 15/20 => Loss 1.846, Loss_clf 0.350, Loss_fe 0.361, Loss_kd 1.065, Train_accy 84.52:  70%|███████   | 14/20 [10:48<04:13, 42.33s/it]
Task 6, Epoch 15/20 => Loss 1.846, Loss_clf 0.350, Loss_fe 0.361, Loss_kd 1.065, Train_accy 84.52:  75%|███████▌  | 15/20 [10:48<03:29, 41.81s/it]
Task 6, Epoch 16/20 => Loss 1.725, Loss_clf 0.321, Loss_fe 0.296, Loss_kd 1.039, Train_accy 84.54, Test_accy 83.77:  75%|███████▌  | 15/20 [11:41<03:29, 41.81s/it]
Task 6, Epoch 16/20 => Loss 1.725, Loss_clf 0.321, Loss_fe 0.296, Loss_kd 1.039, Train_accy 84.54, Test_accy 83.77:  80%|████████  | 16/20 [11:41<03:01, 45.26s/it]
Task 6, Epoch 17/20 => Loss 1.779, Loss_clf 0.335, Loss_fe 0.306, Loss_kd 1.067, Train_accy 83.97:  80%|████████  | 16/20 [12:22<03:01, 45.26s/it]                 
Task 6, Epoch 17/20 => Loss 1.779, Loss_clf 0.335, Loss_fe 0.306, Loss_kd 1.067, Train_accy 83.97:  85%|████████▌ | 17/20 [12:22<02:11, 43.88s/it]
Task 6, Epoch 18/20 => Loss 1.807, Loss_clf 0.345, Loss_fe 0.319, Loss_kd 1.072, Train_accy 84.08:  85%|████████▌ | 17/20 [13:03<02:11, 43.88s/it]
Task 6, Epoch 18/20 => Loss 1.807, Loss_clf 0.345, Loss_fe 0.319, Loss_kd 1.072, Train_accy 84.08:  90%|█████████ | 18/20 [13:03<01:25, 42.95s/it]
Task 6, Epoch 19/20 => Loss 1.728, Loss_clf 0.325, Loss_fe 0.297, Loss_kd 1.037, Train_accy 84.86:  90%|█████████ | 18/20 [13:44<01:25, 42.95s/it]
Task 6, Epoch 19/20 => Loss 1.728, Loss_clf 0.325, Loss_fe 0.297, Loss_kd 1.037, Train_accy 84.86:  95%|█████████▌| 19/20 [13:44<00:42, 42.27s/it]
Task 6, Epoch 20/20 => Loss 1.790, Loss_clf 0.337, Loss_fe 0.314, Loss_kd 1.068, Train_accy 84.49:  95%|█████████▌| 19/20 [14:24<00:42, 42.27s/it]
Task 6, Epoch 20/20 => Loss 1.790, Loss_clf 0.337, Loss_fe 0.314, Loss_kd 1.068, Train_accy 84.49: 100%|██████████| 20/20 [14:24<00:00, 41.80s/it]
Task 6, Epoch 20/20 => Loss 1.790, Loss_clf 0.337, Loss_fe 0.314, Loss_kd 1.068, Train_accy 84.49: 100%|██████████| 20/20 [14:24<00:00, 43.24s/it]2024-09-13 14:52:38,700 [foster.py] => Task 6, Epoch 20/20 => Loss 1.790, Loss_clf 0.337, Loss_fe 0.314, Loss_kd 1.068, Train_accy 84.49
2024-09-13 14:52:38,701 [foster.py] => do not weight align teacher!
2024-09-13 14:52:38,706 [foster.py] => per cls weights : [1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291 1.03518291
 0.4722563  0.4722563  0.4722563  0.4722563  0.4722563  0.4722563
 0.4722563  0.4722563  0.4722563  0.4722563 ]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.107,  Train_accy 79.41, Test_accy 83.50:   0%|          | 0/20 [00:58<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.107,  Train_accy 79.41, Test_accy 83.50:   5%|▌         | 1/20 [00:58<18:23, 58.05s/it]
SNet: Task 6, Epoch 2/20 => Loss 1.061,  Train_accy 80.80:   5%|▌         | 1/20 [01:49<18:23, 58.05s/it]                 
SNet: Task 6, Epoch 2/20 => Loss 1.061,  Train_accy 80.80:  10%|█         | 2/20 [01:49<16:13, 54.08s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.013,  Train_accy 81.37:  10%|█         | 2/20 [02:40<16:13, 54.08s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.013,  Train_accy 81.37:  15%|█▌        | 3/20 [02:40<14:56, 52.71s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.037,  Train_accy 81.60:  15%|█▌        | 3/20 [03:31<14:56, 52.71s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.037,  Train_accy 81.60:  20%|██        | 4/20 [03:31<13:54, 52.13s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.028,  Train_accy 82.61:  20%|██        | 4/20 [04:22<13:54, 52.13s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.028,  Train_accy 82.61:  25%|██▌       | 5/20 [04:22<12:56, 51.77s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.012,  Train_accy 82.32, Test_accy 83.08:  25%|██▌       | 5/20 [05:21<12:56, 51.77s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.012,  Train_accy 82.32, Test_accy 83.08:  30%|███       | 6/20 [05:21<12:35, 53.97s/it]
SNet: Task 6, Epoch 7/20 => Loss 1.050,  Train_accy 81.69:  30%|███       | 6/20 [06:12<12:35, 53.97s/it]                 
SNet: Task 6, Epoch 7/20 => Loss 1.050,  Train_accy 81.69:  35%|███▌      | 7/20 [06:12<11:29, 53.03s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.023,  Train_accy 82.53:  35%|███▌      | 7/20 [07:03<11:29, 53.03s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.023,  Train_accy 82.53:  40%|████      | 8/20 [07:03<10:28, 52.39s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.004,  Train_accy 82.73:  40%|████      | 8/20 [07:54<10:28, 52.39s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.004,  Train_accy 82.73:  45%|████▌     | 9/20 [07:54<09:31, 51.99s/it]
SNet: Task 6, Epoch 10/20 => Loss 0.997,  Train_accy 83.22:  45%|████▌     | 9/20 [08:45<09:31, 51.99s/it]
SNet: Task 6, Epoch 10/20 => Loss 0.997,  Train_accy 83.22:  50%|█████     | 10/20 [08:45<08:37, 51.71s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.035,  Train_accy 82.15, Test_accy 83.24:  50%|█████     | 10/20 [09:43<08:37, 51.71s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.035,  Train_accy 82.15, Test_accy 83.24:  55%|█████▌    | 11/20 [09:43<08:02, 53.65s/it]
SNet: Task 6, Epoch 12/20 => Loss 1.027,  Train_accy 81.78:  55%|█████▌    | 11/20 [10:34<08:02, 53.65s/it]                 
SNet: Task 6, Epoch 12/20 => Loss 1.027,  Train_accy 81.78:  60%|██████    | 12/20 [10:34<07:01, 52.72s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.023,  Train_accy 82.93:  60%|██████    | 12/20 [11:25<07:01, 52.72s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.023,  Train_accy 82.93:  65%|██████▌   | 13/20 [11:25<06:05, 52.23s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.009,  Train_accy 83.19:  65%|██████▌   | 13/20 [12:16<06:05, 52.23s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.009,  Train_accy 83.19:  70%|███████   | 14/20 [12:16<05:11, 51.86s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.031,  Train_accy 82.06:  70%|███████   | 14/20 [13:07<05:11, 51.86s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.031,  Train_accy 82.06:  75%|███████▌  | 15/20 [13:07<04:18, 51.66s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.047,  Train_accy 81.75, Test_accy 83.55:  75%|███████▌  | 15/20 [14:05<04:18, 51.66s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.047,  Train_accy 81.75, Test_accy 83.55:  80%|████████  | 16/20 [14:05<03:34, 53.64s/it]
SNet: Task 6, Epoch 17/20 => Loss 0.999,  Train_accy 82.38:  80%|████████  | 16/20 [14:56<03:34, 53.64s/it]                 
SNet: Task 6, Epoch 17/20 => Loss 0.999,  Train_accy 82.38:  85%|████████▌ | 17/20 [14:56<02:38, 52.88s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.034,  Train_accy 82.21:  85%|████████▌ | 17/20 [15:47<02:38, 52.88s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.034,  Train_accy 82.21:  90%|█████████ | 18/20 [15:47<01:44, 52.31s/it]
SNet: Task 6, Epoch 19/20 => Loss 0.982,  Train_accy 82.96:  90%|█████████ | 18/20 [16:38<01:44, 52.31s/it]
SNet: Task 6, Epoch 19/20 => Loss 0.982,  Train_accy 82.96:  95%|█████████▌| 19/20 [16:38<00:51, 51.93s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.018,  Train_accy 82.70:  95%|█████████▌| 19/20 [17:29<00:51, 51.93s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.018,  Train_accy 82.70: 100%|██████████| 20/20 [17:29<00:00, 51.72s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.018,  Train_accy 82.70: 100%|██████████| 20/20 [17:29<00:00, 52.50s/it]2024-09-13 15:10:11,398 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.018,  Train_accy 82.70
2024-09-13 15:10:11,398 [foster.py] => do not weight align student!

2024-09-13 15:10:18,300 [foster.py] => darknet eval: 
2024-09-13 15:10:18,301 [foster.py] => CNN top1 curve: 83.5
2024-09-13 15:10:18,301 [foster.py] => CNN top5 curve: 97.57
2024-09-13 15:10:18,304 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 15:12:13,871 [foster.py] => Exemplar size: 3200
2024-09-13 15:12:13,871 [trainer.py] => CNN: {'total': 84.08, '00-99': 90.24, '100-109': 91.3, '110-119': 83.19, '120-129': 85.05, '130-139': 75.42, '140-149': 69.05, '150-159': 41.94, 'old': 87.04, 'new': 41.94}
2024-09-13 15:12:13,872 [trainer.py] => NME: {'total': 88.47, '00-99': 87.96, '100-109': 91.3, '110-119': 86.73, '120-129': 87.85, '130-139': 89.83, '140-149': 85.71, '150-159': 94.35, 'old': 88.06, 'new': 94.35}
2024-09-13 15:12:13,872 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74, 85.56, 84.32, 84.08]
2024-09-13 15:12:13,872 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42, 98.11, 97.85, 98.15]
2024-09-13 15:12:13,872 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25, 88.54, 88.57, 88.47]
2024-09-13 15:12:13,872 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69, 98.66, 98.53, 98.47]

Average Accuracy (CNN): 86.73
Average Accuracy (NME): 89.25
2024-09-13 15:12:13,872 [trainer.py] => Average Accuracy (CNN): 86.73
2024-09-13 15:12:13,872 [trainer.py] => Average Accuracy (NME): 89.25
2024-09-13 15:12:13,874 [trainer.py] => All params: 172081622
2024-09-13 15:12:13,875 [trainer.py] => Trainable params: 86167616
2024-09-13 15:12:15,748 [foster.py] => Learning on 160-170
2024-09-13 15:12:15,750 [foster.py] => All params: 172112372
2024-09-13 15:12:15,751 [foster.py] => Trainable params: 86190676
2024-09-13 15:12:15,808 [foster.py] => per cls weights : [1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  1.0266942  1.0266942
 1.0266942  1.0266942  1.0266942  1.0266942  0.57289286 0.57289286
 0.57289286 0.57289286 0.57289286 0.57289286 0.57289286 0.57289286
 0.57289286 0.57289286]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 5.167, Loss_clf 0.809, Loss_fe 3.191, Loss_kd 1.097, Train_accy 80.10, Test_accy 83.36:   0%|          | 0/20 [00:56<?, ?it/s]
Task 7, Epoch 1/20 => Loss 5.167, Loss_clf 0.809, Loss_fe 3.191, Loss_kd 1.097, Train_accy 80.10, Test_accy 83.36:   5%|▌         | 1/20 [00:56<17:52, 56.44s/it]
Task 7, Epoch 2/20 => Loss 2.744, Loss_clf 0.522, Loss_fe 1.057, Loss_kd 1.097, Train_accy 81.91:   5%|▌         | 1/20 [01:39<17:52, 56.44s/it]                 
Task 7, Epoch 2/20 => Loss 2.744, Loss_clf 0.522, Loss_fe 1.057, Loss_kd 1.097, Train_accy 81.91:  10%|█         | 2/20 [01:39<14:33, 48.51s/it]
Task 7, Epoch 3/20 => Loss 2.455, Loss_clf 0.488, Loss_fe 0.794, Loss_kd 1.103, Train_accy 81.99:  10%|█         | 2/20 [02:22<14:33, 48.51s/it]
Task 7, Epoch 3/20 => Loss 2.455, Loss_clf 0.488, Loss_fe 0.794, Loss_kd 1.103, Train_accy 81.99:  15%|█▌        | 3/20 [02:22<13:01, 45.98s/it]
Task 7, Epoch 4/20 => Loss 2.274, Loss_clf 0.421, Loss_fe 0.682, Loss_kd 1.102, Train_accy 83.11:  15%|█▌        | 3/20 [03:05<13:01, 45.98s/it]
Task 7, Epoch 4/20 => Loss 2.274, Loss_clf 0.421, Loss_fe 0.682, Loss_kd 1.102, Train_accy 83.11:  20%|██        | 4/20 [03:05<11:56, 44.81s/it]
Task 7, Epoch 5/20 => Loss 2.159, Loss_clf 0.410, Loss_fe 0.599, Loss_kd 1.082, Train_accy 83.11:  20%|██        | 4/20 [03:48<11:56, 44.81s/it]
Task 7, Epoch 5/20 => Loss 2.159, Loss_clf 0.410, Loss_fe 0.599, Loss_kd 1.082, Train_accy 83.11:  25%|██▌       | 5/20 [03:48<11:02, 44.18s/it]
Task 7, Epoch 6/20 => Loss 2.114, Loss_clf 0.402, Loss_fe 0.553, Loss_kd 1.090, Train_accy 83.24, Test_accy 83.16:  25%|██▌       | 5/20 [04:44<11:02, 44.18s/it]
Task 7, Epoch 6/20 => Loss 2.114, Loss_clf 0.402, Loss_fe 0.553, Loss_kd 1.090, Train_accy 83.24, Test_accy 83.16:  30%|███       | 6/20 [04:44<11:17, 48.36s/it]
Task 7, Epoch 7/20 => Loss 2.048, Loss_clf 0.393, Loss_fe 0.506, Loss_kd 1.082, Train_accy 83.16:  30%|███       | 6/20 [05:27<11:17, 48.36s/it]                 
Task 7, Epoch 7/20 => Loss 2.048, Loss_clf 0.393, Loss_fe 0.506, Loss_kd 1.082, Train_accy 83.16:  35%|███▌      | 7/20 [05:27<10:06, 46.63s/it]
Task 7, Epoch 8/20 => Loss 1.997, Loss_clf 0.381, Loss_fe 0.461, Loss_kd 1.086, Train_accy 84.09:  35%|███▌      | 7/20 [06:10<10:06, 46.63s/it]
Task 7, Epoch 8/20 => Loss 1.997, Loss_clf 0.381, Loss_fe 0.461, Loss_kd 1.086, Train_accy 84.09:  40%|████      | 8/20 [06:10<09:05, 45.44s/it]
Task 7, Epoch 9/20 => Loss 2.005, Loss_clf 0.378, Loss_fe 0.457, Loss_kd 1.101, Train_accy 82.86:  40%|████      | 8/20 [06:53<09:05, 45.44s/it]
Task 7, Epoch 9/20 => Loss 2.005, Loss_clf 0.378, Loss_fe 0.457, Loss_kd 1.101, Train_accy 82.86:  45%|████▌     | 9/20 [06:53<08:11, 44.67s/it]
Task 7, Epoch 10/20 => Loss 2.027, Loss_clf 0.386, Loss_fe 0.443, Loss_kd 1.128, Train_accy 83.43:  45%|████▌     | 9/20 [07:36<08:11, 44.67s/it]
Task 7, Epoch 10/20 => Loss 2.027, Loss_clf 0.386, Loss_fe 0.443, Loss_kd 1.128, Train_accy 83.43:  50%|█████     | 10/20 [07:36<07:21, 44.14s/it]
Task 7, Epoch 11/20 => Loss 1.940, Loss_clf 0.367, Loss_fe 0.407, Loss_kd 1.098, Train_accy 84.47, Test_accy 83.70:  50%|█████     | 10/20 [08:33<07:21, 44.14s/it]
Task 7, Epoch 11/20 => Loss 1.940, Loss_clf 0.367, Loss_fe 0.407, Loss_kd 1.098, Train_accy 84.47, Test_accy 83.70:  55%|█████▌    | 11/20 [08:33<07:11, 47.91s/it]
Task 7, Epoch 12/20 => Loss 1.872, Loss_clf 0.347, Loss_fe 0.379, Loss_kd 1.078, Train_accy 84.01:  55%|█████▌    | 11/20 [09:16<07:11, 47.91s/it]                 
Task 7, Epoch 12/20 => Loss 1.872, Loss_clf 0.347, Loss_fe 0.379, Loss_kd 1.078, Train_accy 84.01:  60%|██████    | 12/20 [09:16<06:11, 46.40s/it]
Task 7, Epoch 13/20 => Loss 1.851, Loss_clf 0.335, Loss_fe 0.362, Loss_kd 1.086, Train_accy 85.02:  60%|██████    | 12/20 [09:59<06:11, 46.40s/it]
Task 7, Epoch 13/20 => Loss 1.851, Loss_clf 0.335, Loss_fe 0.362, Loss_kd 1.086, Train_accy 85.02:  65%|██████▌   | 13/20 [09:59<05:17, 45.39s/it]
Task 7, Epoch 14/20 => Loss 1.906, Loss_clf 0.359, Loss_fe 0.364, Loss_kd 1.114, Train_accy 84.14:  65%|██████▌   | 13/20 [10:42<05:17, 45.39s/it]
Task 7, Epoch 14/20 => Loss 1.906, Loss_clf 0.359, Loss_fe 0.364, Loss_kd 1.114, Train_accy 84.14:  70%|███████   | 14/20 [10:42<04:28, 44.68s/it]
Task 7, Epoch 15/20 => Loss 1.954, Loss_clf 0.379, Loss_fe 0.376, Loss_kd 1.128, Train_accy 83.27:  70%|███████   | 14/20 [11:25<04:28, 44.68s/it]
Task 7, Epoch 15/20 => Loss 1.954, Loss_clf 0.379, Loss_fe 0.376, Loss_kd 1.128, Train_accy 83.27:  75%|███████▌  | 15/20 [11:25<03:40, 44.16s/it]
Task 7, Epoch 16/20 => Loss 1.841, Loss_clf 0.345, Loss_fe 0.332, Loss_kd 1.095, Train_accy 84.12, Test_accy 83.46:  75%|███████▌  | 15/20 [12:21<03:40, 44.16s/it]
Task 7, Epoch 16/20 => Loss 1.841, Loss_clf 0.345, Loss_fe 0.332, Loss_kd 1.095, Train_accy 84.12, Test_accy 83.46:  80%|████████  | 16/20 [12:21<03:11, 47.87s/it]
Task 7, Epoch 17/20 => Loss 1.865, Loss_clf 0.360, Loss_fe 0.336, Loss_kd 1.101, Train_accy 83.54:  80%|████████  | 16/20 [13:04<03:11, 47.87s/it]                 
Task 7, Epoch 17/20 => Loss 1.865, Loss_clf 0.360, Loss_fe 0.336, Loss_kd 1.101, Train_accy 83.54:  85%|████████▌ | 17/20 [13:04<02:19, 46.40s/it]
Task 7, Epoch 18/20 => Loss 1.824, Loss_clf 0.346, Loss_fe 0.321, Loss_kd 1.088, Train_accy 84.22:  85%|████████▌ | 17/20 [13:47<02:19, 46.40s/it]
Task 7, Epoch 18/20 => Loss 1.824, Loss_clf 0.346, Loss_fe 0.321, Loss_kd 1.088, Train_accy 84.22:  90%|█████████ | 18/20 [13:47<01:30, 45.36s/it]
Task 7, Epoch 19/20 => Loss 1.781, Loss_clf 0.323, Loss_fe 0.312, Loss_kd 1.079, Train_accy 84.83:  90%|█████████ | 18/20 [14:30<01:30, 45.36s/it]
Task 7, Epoch 19/20 => Loss 1.781, Loss_clf 0.323, Loss_fe 0.312, Loss_kd 1.079, Train_accy 84.83:  95%|█████████▌| 19/20 [14:30<00:44, 44.65s/it]
Task 7, Epoch 20/20 => Loss 1.803, Loss_clf 0.337, Loss_fe 0.315, Loss_kd 1.084, Train_accy 84.50:  95%|█████████▌| 19/20 [15:13<00:44, 44.65s/it]
Task 7, Epoch 20/20 => Loss 1.803, Loss_clf 0.337, Loss_fe 0.315, Loss_kd 1.084, Train_accy 84.50: 100%|██████████| 20/20 [15:13<00:00, 44.12s/it]
Task 7, Epoch 20/20 => Loss 1.803, Loss_clf 0.337, Loss_fe 0.315, Loss_kd 1.084, Train_accy 84.50: 100%|██████████| 20/20 [15:13<00:00, 45.68s/it]2024-09-13 15:27:29,377 [foster.py] => Task 7, Epoch 20/20 => Loss 1.803, Loss_clf 0.337, Loss_fe 0.315, Loss_kd 1.084, Train_accy 84.50
2024-09-13 15:27:29,378 [foster.py] => do not weight align teacher!
2024-09-13 15:27:29,383 [foster.py] => per cls weights : [1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494 1.03304494
 1.03304494 1.03304494 1.03304494 1.03304494 0.47128095 0.47128095
 0.47128095 0.47128095 0.47128095 0.47128095 0.47128095 0.47128095
 0.47128095 0.47128095]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.143,  Train_accy 79.72, Test_accy 83.31:   0%|          | 0/20 [00:54<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.143,  Train_accy 79.72, Test_accy 83.31:   5%|▌         | 1/20 [00:54<17:15, 54.49s/it]
SNet: Task 7, Epoch 2/20 => Loss 1.050,  Train_accy 81.69:   5%|▌         | 1/20 [01:41<17:15, 54.49s/it]                 
SNet: Task 7, Epoch 2/20 => Loss 1.050,  Train_accy 81.69:  10%|█         | 2/20 [01:41<15:05, 50.29s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.043,  Train_accy 82.26:  10%|█         | 2/20 [02:29<15:05, 50.29s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.043,  Train_accy 82.26:  15%|█▌        | 3/20 [02:29<13:51, 48.94s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.041,  Train_accy 82.37:  15%|█▌        | 3/20 [03:16<13:51, 48.94s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.041,  Train_accy 82.37:  20%|██        | 4/20 [03:16<12:53, 48.35s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.082,  Train_accy 81.74:  20%|██        | 4/20 [04:03<12:53, 48.35s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.082,  Train_accy 81.74:  25%|██▌       | 5/20 [04:03<11:59, 47.98s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.044,  Train_accy 82.81, Test_accy 83.75:  25%|██▌       | 5/20 [04:57<11:59, 47.98s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.044,  Train_accy 82.81, Test_accy 83.75:  30%|███       | 6/20 [04:57<11:40, 50.02s/it]
SNet: Task 7, Epoch 7/20 => Loss 1.044,  Train_accy 81.96:  30%|███       | 6/20 [05:45<11:40, 50.02s/it]                 
SNet: Task 7, Epoch 7/20 => Loss 1.044,  Train_accy 81.96:  35%|███▌      | 7/20 [05:45<10:38, 49.14s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.019,  Train_accy 82.48:  35%|███▌      | 7/20 [06:32<10:38, 49.14s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.019,  Train_accy 82.48:  40%|████      | 8/20 [06:32<09:42, 48.55s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.022,  Train_accy 82.78:  40%|████      | 8/20 [07:19<09:42, 48.55s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.022,  Train_accy 82.78:  45%|████▌     | 9/20 [07:19<08:49, 48.17s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.081,  Train_accy 81.80:  45%|████▌     | 9/20 [08:07<08:49, 48.17s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.081,  Train_accy 81.80:  50%|█████     | 10/20 [08:07<07:59, 47.93s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.032,  Train_accy 82.72, Test_accy 83.60:  50%|█████     | 10/20 [09:01<07:59, 47.93s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.032,  Train_accy 82.72, Test_accy 83.60:  55%|█████▌    | 11/20 [09:01<07:27, 49.71s/it]
SNet: Task 7, Epoch 12/20 => Loss 1.040,  Train_accy 82.56:  55%|█████▌    | 11/20 [09:48<07:27, 49.71s/it]                 
SNet: Task 7, Epoch 12/20 => Loss 1.040,  Train_accy 82.56:  60%|██████    | 12/20 [09:48<06:31, 48.98s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.020,  Train_accy 82.75:  60%|██████    | 12/20 [10:35<06:31, 48.98s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.020,  Train_accy 82.75:  65%|██████▌   | 13/20 [10:35<05:39, 48.46s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.043,  Train_accy 82.83:  65%|██████▌   | 13/20 [11:22<05:39, 48.46s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.043,  Train_accy 82.83:  70%|███████   | 14/20 [11:22<04:48, 48.11s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.027,  Train_accy 82.94:  70%|███████   | 14/20 [12:10<04:48, 48.11s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.027,  Train_accy 82.94:  75%|███████▌  | 15/20 [12:10<03:59, 47.89s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.057,  Train_accy 82.61, Test_accy 83.56:  75%|███████▌  | 15/20 [13:04<03:59, 47.89s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.057,  Train_accy 82.61, Test_accy 83.56:  80%|████████  | 16/20 [13:04<03:18, 49.73s/it]
SNet: Task 7, Epoch 17/20 => Loss 1.034,  Train_accy 82.86:  80%|████████  | 16/20 [13:51<03:18, 49.73s/it]                 
SNet: Task 7, Epoch 17/20 => Loss 1.034,  Train_accy 82.86:  85%|████████▌ | 17/20 [13:51<02:27, 49.02s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.030,  Train_accy 83.05:  85%|████████▌ | 17/20 [14:38<02:27, 49.02s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.030,  Train_accy 83.05:  90%|█████████ | 18/20 [14:38<01:36, 48.49s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.048,  Train_accy 82.18:  90%|█████████ | 18/20 [15:26<01:36, 48.49s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.048,  Train_accy 82.18:  95%|█████████▌| 19/20 [15:26<00:48, 48.14s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.043,  Train_accy 82.78:  95%|█████████▌| 19/20 [16:13<00:48, 48.14s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.043,  Train_accy 82.78: 100%|██████████| 20/20 [16:13<00:00, 47.88s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.043,  Train_accy 82.78: 100%|██████████| 20/20 [16:13<00:00, 48.67s/it]2024-09-13 15:43:45,291 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 1.043,  Train_accy 82.78
2024-09-13 15:43:45,292 [foster.py] => do not weight align student!

2024-09-13 15:43:51,893 [foster.py] => darknet eval: 
2024-09-13 15:43:51,894 [foster.py] => CNN top1 curve: 83.75
2024-09-13 15:43:51,894 [foster.py] => CNN top5 curve: 97.68
2024-09-13 15:43:51,897 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 15:45:49,579 [foster.py] => Exemplar size: 3400
2024-09-13 15:45:49,579 [trainer.py] => CNN: {'total': 83.8, '00-99': 89.98, '100-109': 90.43, '110-119': 81.42, '120-129': 88.79, '130-139': 80.51, '140-149': 80.95, '150-159': 68.55, '160-169': 41.04, 'old': 86.83, 'new': 41.04}
2024-09-13 15:45:49,579 [trainer.py] => NME: {'total': 88.49, '00-99': 87.96, '100-109': 93.91, '110-119': 84.96, '120-129': 85.05, '130-139': 88.14, '140-149': 86.51, '150-159': 95.16, '160-169': 90.3, 'old': 88.37, 'new': 90.3}
2024-09-13 15:45:49,579 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74, 85.56, 84.32, 84.08, 83.8]
2024-09-13 15:45:49,579 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42, 98.11, 97.85, 98.15, 97.93]
2024-09-13 15:45:49,579 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25, 88.54, 88.57, 88.47, 88.49]
2024-09-13 15:45:49,579 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69, 98.66, 98.53, 98.47, 98.52]

Average Accuracy (CNN): 86.36
Average Accuracy (NME): 89.16
2024-09-13 15:45:49,579 [trainer.py] => Average Accuracy (CNN): 86.36
2024-09-13 15:45:49,579 [trainer.py] => Average Accuracy (NME): 89.16
2024-09-13 15:45:49,581 [trainer.py] => All params: 172112372
2024-09-13 15:45:49,582 [trainer.py] => Trainable params: 86190676
2024-09-13 15:45:54,159 [foster.py] => Learning on 170-180
2024-09-13 15:45:54,161 [foster.py] => All params: 172143122
2024-09-13 15:45:54,162 [foster.py] => Trainable params: 86213736
2024-09-13 15:45:54,221 [foster.py] => per cls weights : [1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385 1.02517385
 1.02517385 1.02517385 0.57204451 0.57204451 0.57204451 0.57204451
 0.57204451 0.57204451 0.57204451 0.57204451 0.57204451 0.57204451]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 5.480, Loss_clf 0.788, Loss_fe 3.498, Loss_kd 1.128, Train_accy 79.33, Test_accy 84.12:   0%|          | 0/20 [00:51<?, ?it/s]
Task 8, Epoch 1/20 => Loss 5.480, Loss_clf 0.788, Loss_fe 3.498, Loss_kd 1.128, Train_accy 79.33, Test_accy 84.12:   5%|▌         | 1/20 [00:51<16:23, 51.75s/it]
Task 8, Epoch 2/20 => Loss 2.907, Loss_clf 0.587, Loss_fe 1.090, Loss_kd 1.162, Train_accy 80.74:   5%|▌         | 1/20 [01:31<16:23, 51.75s/it]                 
Task 8, Epoch 2/20 => Loss 2.907, Loss_clf 0.587, Loss_fe 1.090, Loss_kd 1.162, Train_accy 80.74:  10%|█         | 2/20 [01:31<13:23, 44.65s/it]
Task 8, Epoch 3/20 => Loss 2.548, Loss_clf 0.478, Loss_fe 0.843, Loss_kd 1.159, Train_accy 81.74:  10%|█         | 2/20 [02:11<13:23, 44.65s/it]
Task 8, Epoch 3/20 => Loss 2.548, Loss_clf 0.478, Loss_fe 0.843, Loss_kd 1.159, Train_accy 81.74:  15%|█▌        | 3/20 [02:11<12:01, 42.44s/it]
Task 8, Epoch 4/20 => Loss 2.328, Loss_clf 0.432, Loss_fe 0.723, Loss_kd 1.109, Train_accy 82.13:  15%|█▌        | 3/20 [02:51<12:01, 42.44s/it]
Task 8, Epoch 4/20 => Loss 2.328, Loss_clf 0.432, Loss_fe 0.723, Loss_kd 1.109, Train_accy 82.13:  20%|██        | 4/20 [02:51<11:02, 41.39s/it]
Task 8, Epoch 5/20 => Loss 2.210, Loss_clf 0.428, Loss_fe 0.610, Loss_kd 1.106, Train_accy 82.46:  20%|██        | 4/20 [03:31<11:02, 41.39s/it]
Task 8, Epoch 5/20 => Loss 2.210, Loss_clf 0.428, Loss_fe 0.610, Loss_kd 1.106, Train_accy 82.46:  25%|██▌       | 5/20 [03:31<10:13, 40.91s/it]
Task 8, Epoch 6/20 => Loss 2.149, Loss_clf 0.405, Loss_fe 0.563, Loss_kd 1.116, Train_accy 83.20, Test_accy 84.96:  25%|██▌       | 5/20 [04:23<10:13, 40.91s/it]
Task 8, Epoch 6/20 => Loss 2.149, Loss_clf 0.405, Loss_fe 0.563, Loss_kd 1.116, Train_accy 83.20, Test_accy 84.96:  30%|███       | 6/20 [04:23<10:28, 44.90s/it]
Task 8, Epoch 7/20 => Loss 2.100, Loss_clf 0.392, Loss_fe 0.502, Loss_kd 1.139, Train_accy 83.03:  30%|███       | 6/20 [05:03<10:28, 44.90s/it]                 
Task 8, Epoch 7/20 => Loss 2.100, Loss_clf 0.392, Loss_fe 0.502, Loss_kd 1.139, Train_accy 83.03:  35%|███▌      | 7/20 [05:03<09:22, 43.27s/it]
Task 8, Epoch 8/20 => Loss 2.079, Loss_clf 0.404, Loss_fe 0.482, Loss_kd 1.126, Train_accy 83.18:  35%|███▌      | 7/20 [05:43<09:22, 43.27s/it]
Task 8, Epoch 8/20 => Loss 2.079, Loss_clf 0.404, Loss_fe 0.482, Loss_kd 1.126, Train_accy 83.18:  40%|████      | 8/20 [05:43<08:26, 42.22s/it]
Task 8, Epoch 9/20 => Loss 2.094, Loss_clf 0.406, Loss_fe 0.481, Loss_kd 1.140, Train_accy 83.08:  40%|████      | 8/20 [06:23<08:26, 42.22s/it]
Task 8, Epoch 9/20 => Loss 2.094, Loss_clf 0.406, Loss_fe 0.481, Loss_kd 1.140, Train_accy 83.08:  45%|████▌     | 9/20 [06:23<07:36, 41.54s/it]
Task 8, Epoch 10/20 => Loss 1.890, Loss_clf 0.346, Loss_fe 0.403, Loss_kd 1.077, Train_accy 84.05:  45%|████▌     | 9/20 [07:03<07:36, 41.54s/it]
Task 8, Epoch 10/20 => Loss 1.890, Loss_clf 0.346, Loss_fe 0.403, Loss_kd 1.077, Train_accy 84.05:  50%|█████     | 10/20 [07:03<06:50, 41.06s/it]
Task 8, Epoch 11/20 => Loss 2.055, Loss_clf 0.400, Loss_fe 0.437, Loss_kd 1.150, Train_accy 83.46, Test_accy 84.02:  50%|█████     | 10/20 [07:56<06:50, 41.06s/it]
Task 8, Epoch 11/20 => Loss 2.055, Loss_clf 0.400, Loss_fe 0.437, Loss_kd 1.150, Train_accy 83.46, Test_accy 84.02:  55%|█████▌    | 11/20 [07:56<06:41, 44.57s/it]
Task 8, Epoch 12/20 => Loss 1.906, Loss_clf 0.345, Loss_fe 0.382, Loss_kd 1.113, Train_accy 84.51:  55%|█████▌    | 11/20 [08:36<06:41, 44.57s/it]                 
Task 8, Epoch 12/20 => Loss 1.906, Loss_clf 0.345, Loss_fe 0.382, Loss_kd 1.113, Train_accy 84.51:  60%|██████    | 12/20 [08:36<05:45, 43.14s/it]
Task 8, Epoch 13/20 => Loss 1.924, Loss_clf 0.371, Loss_fe 0.376, Loss_kd 1.111, Train_accy 84.16:  60%|██████    | 12/20 [09:16<05:45, 43.14s/it]
Task 8, Epoch 13/20 => Loss 1.924, Loss_clf 0.371, Loss_fe 0.376, Loss_kd 1.111, Train_accy 84.16:  65%|██████▌   | 13/20 [09:16<04:55, 42.19s/it]
Task 8, Epoch 14/20 => Loss 1.902, Loss_clf 0.356, Loss_fe 0.369, Loss_kd 1.111, Train_accy 84.10:  65%|██████▌   | 13/20 [09:55<04:55, 42.19s/it]
Task 8, Epoch 14/20 => Loss 1.902, Loss_clf 0.356, Loss_fe 0.369, Loss_kd 1.111, Train_accy 84.10:  70%|███████   | 14/20 [09:55<04:09, 41.50s/it]
Task 8, Epoch 15/20 => Loss 1.832, Loss_clf 0.340, Loss_fe 0.342, Loss_kd 1.086, Train_accy 84.26:  70%|███████   | 14/20 [10:35<04:09, 41.50s/it]
Task 8, Epoch 15/20 => Loss 1.832, Loss_clf 0.340, Loss_fe 0.342, Loss_kd 1.086, Train_accy 84.26:  75%|███████▌  | 15/20 [10:35<03:25, 41.06s/it]
Task 8, Epoch 16/20 => Loss 1.856, Loss_clf 0.333, Loss_fe 0.342, Loss_kd 1.115, Train_accy 85.03, Test_accy 84.12:  75%|███████▌  | 15/20 [11:28<03:25, 41.06s/it]
Task 8, Epoch 16/20 => Loss 1.856, Loss_clf 0.333, Loss_fe 0.342, Loss_kd 1.115, Train_accy 85.03, Test_accy 84.12:  80%|████████  | 16/20 [11:28<02:58, 44.52s/it]
Task 8, Epoch 17/20 => Loss 1.799, Loss_clf 0.334, Loss_fe 0.313, Loss_kd 1.088, Train_accy 84.41:  80%|████████  | 16/20 [12:08<02:58, 44.52s/it]                 
Task 8, Epoch 17/20 => Loss 1.799, Loss_clf 0.334, Loss_fe 0.313, Loss_kd 1.088, Train_accy 84.41:  85%|████████▌ | 17/20 [12:08<02:09, 43.13s/it]
Task 8, Epoch 18/20 => Loss 1.799, Loss_clf 0.331, Loss_fe 0.317, Loss_kd 1.087, Train_accy 84.41:  85%|████████▌ | 17/20 [12:48<02:09, 43.13s/it]
Task 8, Epoch 18/20 => Loss 1.799, Loss_clf 0.331, Loss_fe 0.317, Loss_kd 1.087, Train_accy 84.41:  90%|█████████ | 18/20 [12:48<01:24, 42.22s/it]
Task 8, Epoch 19/20 => Loss 1.850, Loss_clf 0.341, Loss_fe 0.334, Loss_kd 1.109, Train_accy 85.13:  90%|█████████ | 18/20 [13:28<01:24, 42.22s/it]
Task 8, Epoch 19/20 => Loss 1.850, Loss_clf 0.341, Loss_fe 0.334, Loss_kd 1.109, Train_accy 85.13:  95%|█████████▌| 19/20 [13:28<00:41, 41.57s/it]
Task 8, Epoch 20/20 => Loss 1.839, Loss_clf 0.345, Loss_fe 0.320, Loss_kd 1.109, Train_accy 84.36:  95%|█████████▌| 19/20 [14:08<00:41, 41.57s/it]
Task 8, Epoch 20/20 => Loss 1.839, Loss_clf 0.345, Loss_fe 0.320, Loss_kd 1.109, Train_accy 84.36: 100%|██████████| 20/20 [14:08<00:00, 41.08s/it]
Task 8, Epoch 20/20 => Loss 1.839, Loss_clf 0.345, Loss_fe 0.320, Loss_kd 1.109, Train_accy 84.36: 100%|██████████| 20/20 [14:08<00:00, 42.43s/it]2024-09-13 16:00:02,773 [foster.py] => Task 8, Epoch 20/20 => Loss 1.839, Loss_clf 0.345, Loss_fe 0.320, Loss_kd 1.109, Train_accy 84.36
2024-09-13 16:00:02,774 [foster.py] => do not weight align teacher!
2024-09-13 16:00:02,775 [foster.py] => per cls weights : [1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192 1.03115192
 1.03115192 1.03115192 0.47041734 0.47041734 0.47041734 0.47041734
 0.47041734 0.47041734 0.47041734 0.47041734 0.47041734 0.47041734]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.123,  Train_accy 79.61, Test_accy 84.40:   0%|          | 0/20 [00:56<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.123,  Train_accy 79.61, Test_accy 84.40:   5%|▌         | 1/20 [00:56<18:02, 56.97s/it]
SNet: Task 8, Epoch 2/20 => Loss 1.069,  Train_accy 81.97:   5%|▌         | 1/20 [01:47<18:02, 56.97s/it]                 
SNet: Task 8, Epoch 2/20 => Loss 1.069,  Train_accy 81.97:  10%|█         | 2/20 [01:47<15:54, 53.02s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.068,  Train_accy 81.46:  10%|█         | 2/20 [02:37<15:54, 53.02s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.068,  Train_accy 81.46:  15%|█▌        | 3/20 [02:37<14:38, 51.71s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.058,  Train_accy 82.10:  15%|█▌        | 3/20 [03:27<14:38, 51.71s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.058,  Train_accy 82.10:  20%|██        | 4/20 [03:27<13:37, 51.10s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.076,  Train_accy 82.51:  20%|██        | 4/20 [04:17<13:37, 51.10s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.076,  Train_accy 82.51:  25%|██▌       | 5/20 [04:17<12:41, 50.77s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.063,  Train_accy 82.33, Test_accy 84.45:  25%|██▌       | 5/20 [05:14<12:41, 50.77s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.063,  Train_accy 82.33, Test_accy 84.45:  30%|███       | 6/20 [05:14<12:20, 52.88s/it]
SNet: Task 8, Epoch 7/20 => Loss 1.066,  Train_accy 82.31:  30%|███       | 6/20 [06:04<12:20, 52.88s/it]                 
SNet: Task 8, Epoch 7/20 => Loss 1.066,  Train_accy 82.31:  35%|███▌      | 7/20 [06:04<11:15, 51.99s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.064,  Train_accy 82.46:  35%|███▌      | 7/20 [06:55<11:15, 51.99s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.064,  Train_accy 82.46:  40%|████      | 8/20 [06:55<10:17, 51.42s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.060,  Train_accy 82.59:  40%|████      | 8/20 [07:45<10:17, 51.42s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.060,  Train_accy 82.59:  45%|████▌     | 9/20 [07:45<09:21, 51.01s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.059,  Train_accy 82.59:  45%|████▌     | 9/20 [08:35<09:21, 51.01s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.059,  Train_accy 82.59:  50%|█████     | 10/20 [08:35<08:27, 50.77s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.073,  Train_accy 82.18, Test_accy 84.30:  50%|█████     | 10/20 [09:32<08:27, 50.77s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.073,  Train_accy 82.18, Test_accy 84.30:  55%|█████▌    | 11/20 [09:32<07:54, 52.68s/it]
SNet: Task 8, Epoch 12/20 => Loss 1.086,  Train_accy 81.48:  55%|█████▌    | 11/20 [10:22<07:54, 52.68s/it]                 
SNet: Task 8, Epoch 12/20 => Loss 1.086,  Train_accy 81.48:  60%|██████    | 12/20 [10:22<06:55, 51.92s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.037,  Train_accy 82.82:  60%|██████    | 12/20 [11:12<06:55, 51.92s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.037,  Train_accy 82.82:  65%|██████▌   | 13/20 [11:12<05:59, 51.38s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.043,  Train_accy 82.67:  65%|██████▌   | 13/20 [12:02<05:59, 51.38s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.043,  Train_accy 82.67:  70%|███████   | 14/20 [12:02<05:06, 51.04s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.019,  Train_accy 83.31:  70%|███████   | 14/20 [12:53<05:06, 51.04s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.019,  Train_accy 83.31:  75%|███████▌  | 15/20 [12:53<04:13, 50.79s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.049,  Train_accy 82.79, Test_accy 84.49:  75%|███████▌  | 15/20 [13:50<04:13, 50.79s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.049,  Train_accy 82.79, Test_accy 84.49:  80%|████████  | 16/20 [13:50<03:30, 52.67s/it]
SNet: Task 8, Epoch 17/20 => Loss 1.067,  Train_accy 83.03:  80%|████████  | 16/20 [14:40<03:30, 52.67s/it]                 
SNet: Task 8, Epoch 17/20 => Loss 1.067,  Train_accy 83.03:  85%|████████▌ | 17/20 [14:40<02:35, 51.91s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.094,  Train_accy 82.13:  85%|████████▌ | 17/20 [15:30<02:35, 51.91s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.094,  Train_accy 82.13:  90%|█████████ | 18/20 [15:30<01:42, 51.37s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.082,  Train_accy 82.87:  90%|█████████ | 18/20 [16:20<01:42, 51.37s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.082,  Train_accy 82.87:  95%|█████████▌| 19/20 [16:20<00:50, 51.00s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.036,  Train_accy 82.85:  95%|█████████▌| 19/20 [17:10<00:50, 51.00s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.036,  Train_accy 82.85: 100%|██████████| 20/20 [17:10<00:00, 50.75s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.036,  Train_accy 82.85: 100%|██████████| 20/20 [17:10<00:00, 51.54s/it]2024-09-13 16:17:15,765 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.036,  Train_accy 82.85
2024-09-13 16:17:15,766 [foster.py] => do not weight align student!

2024-09-13 16:17:22,625 [foster.py] => darknet eval: 
2024-09-13 16:17:22,626 [foster.py] => CNN top1 curve: 84.59
2024-09-13 16:17:22,626 [foster.py] => CNN top5 curve: 97.32
2024-09-13 16:17:22,628 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 16:19:24,109 [foster.py] => Exemplar size: 3600
2024-09-13 16:19:24,109 [trainer.py] => CNN: {'total': 83.88, '00-99': 88.13, '100-109': 90.43, '110-119': 84.07, '120-129': 88.79, '130-139': 86.44, '140-149': 81.75, '150-159': 88.71, '160-169': 67.16, '170-179': 37.86, 'old': 86.22, 'new': 37.86}
2024-09-13 16:19:24,109 [trainer.py] => NME: {'total': 87.92, '00-99': 87.54, '100-109': 92.17, '110-119': 83.19, '120-129': 84.11, '130-139': 88.98, '140-149': 84.92, '150-159': 95.97, '160-169': 90.3, '170-179': 86.41, 'old': 88.0, 'new': 86.41}
2024-09-13 16:19:24,109 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74, 85.56, 84.32, 84.08, 83.8, 83.88]
2024-09-13 16:19:24,109 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42, 98.11, 97.85, 98.15, 97.93, 97.6]
2024-09-13 16:19:24,109 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25, 88.54, 88.57, 88.47, 88.49, 87.92]
2024-09-13 16:19:24,109 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69, 98.66, 98.53, 98.47, 98.52, 98.31]

Average Accuracy (CNN): 86.09
Average Accuracy (NME): 89.02
2024-09-13 16:19:24,109 [trainer.py] => Average Accuracy (CNN): 86.09
2024-09-13 16:19:24,109 [trainer.py] => Average Accuracy (NME): 89.02
2024-09-13 16:19:24,111 [trainer.py] => All params: 172143122
2024-09-13 16:19:24,113 [trainer.py] => Trainable params: 86213736
2024-09-13 16:19:26,281 [foster.py] => Learning on 180-190
2024-09-13 16:19:26,283 [foster.py] => All params: 172173872
2024-09-13 16:19:26,284 [foster.py] => Trainable params: 86236796
2024-09-13 16:19:26,336 [foster.py] => per cls weights : [1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736 1.02381736
 0.57128759 0.57128759 0.57128759 0.57128759 0.57128759 0.57128759
 0.57128759 0.57128759 0.57128759 0.57128759]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 5.474, Loss_clf 0.785, Loss_fe 3.534, Loss_kd 1.094, Train_accy 80.10, Test_accy 81.86:   0%|          | 0/20 [00:53<?, ?it/s]
Task 9, Epoch 1/20 => Loss 5.474, Loss_clf 0.785, Loss_fe 3.534, Loss_kd 1.094, Train_accy 80.10, Test_accy 81.86:   5%|▌         | 1/20 [00:53<17:04, 53.92s/it]
Task 9, Epoch 2/20 => Loss 2.952, Loss_clf 0.555, Loss_fe 1.170, Loss_kd 1.162, Train_accy 80.20:   5%|▌         | 1/20 [01:35<17:04, 53.92s/it]                 
Task 9, Epoch 2/20 => Loss 2.952, Loss_clf 0.555, Loss_fe 1.170, Loss_kd 1.162, Train_accy 80.20:  10%|█         | 2/20 [01:35<13:57, 46.51s/it]
Task 9, Epoch 3/20 => Loss 2.601, Loss_clf 0.528, Loss_fe 0.882, Loss_kd 1.127, Train_accy 80.96:  10%|█         | 2/20 [02:16<13:57, 46.51s/it]
Task 9, Epoch 3/20 => Loss 2.601, Loss_clf 0.528, Loss_fe 0.882, Loss_kd 1.127, Train_accy 80.96:  15%|█▌        | 3/20 [02:16<12:30, 44.14s/it]
Task 9, Epoch 4/20 => Loss 2.460, Loss_clf 0.490, Loss_fe 0.766, Loss_kd 1.140, Train_accy 81.33:  15%|█▌        | 3/20 [02:58<12:30, 44.14s/it]
Task 9, Epoch 4/20 => Loss 2.460, Loss_clf 0.490, Loss_fe 0.766, Loss_kd 1.140, Train_accy 81.33:  20%|██        | 4/20 [02:58<11:29, 43.10s/it]
Task 9, Epoch 5/20 => Loss 2.396, Loss_clf 0.470, Loss_fe 0.711, Loss_kd 1.151, Train_accy 80.67:  20%|██        | 4/20 [03:39<11:29, 43.10s/it]
Task 9, Epoch 5/20 => Loss 2.396, Loss_clf 0.470, Loss_fe 0.711, Loss_kd 1.151, Train_accy 80.67:  25%|██▌       | 5/20 [03:39<10:38, 42.54s/it]
Task 9, Epoch 6/20 => Loss 2.226, Loss_clf 0.443, Loss_fe 0.603, Loss_kd 1.118, Train_accy 82.32, Test_accy 82.74:  25%|██▌       | 5/20 [04:34<10:38, 42.54s/it]
Task 9, Epoch 6/20 => Loss 2.226, Loss_clf 0.443, Loss_fe 0.603, Loss_kd 1.118, Train_accy 82.32, Test_accy 82.74:  30%|███       | 6/20 [04:34<10:53, 46.69s/it]
Task 9, Epoch 7/20 => Loss 2.150, Loss_clf 0.419, Loss_fe 0.546, Loss_kd 1.122, Train_accy 82.86:  30%|███       | 6/20 [05:15<10:53, 46.69s/it]                 
Task 9, Epoch 7/20 => Loss 2.150, Loss_clf 0.419, Loss_fe 0.546, Loss_kd 1.122, Train_accy 82.86:  35%|███▌      | 7/20 [05:15<09:45, 45.00s/it]
Task 9, Epoch 8/20 => Loss 2.161, Loss_clf 0.438, Loss_fe 0.537, Loss_kd 1.124, Train_accy 82.64:  35%|███▌      | 7/20 [05:57<09:45, 45.00s/it]
Task 9, Epoch 8/20 => Loss 2.161, Loss_clf 0.438, Loss_fe 0.537, Loss_kd 1.124, Train_accy 82.64:  40%|████      | 8/20 [05:57<08:46, 43.89s/it]
Task 9, Epoch 9/20 => Loss 2.127, Loss_clf 0.428, Loss_fe 0.505, Loss_kd 1.131, Train_accy 82.42:  40%|████      | 8/20 [06:39<08:46, 43.89s/it]
Task 9, Epoch 9/20 => Loss 2.127, Loss_clf 0.428, Loss_fe 0.505, Loss_kd 1.131, Train_accy 82.42:  45%|████▌     | 9/20 [06:39<07:55, 43.21s/it]
Task 9, Epoch 10/20 => Loss 1.961, Loss_clf 0.379, Loss_fe 0.433, Loss_kd 1.088, Train_accy 83.70:  45%|████▌     | 9/20 [07:20<07:55, 43.21s/it]
Task 9, Epoch 10/20 => Loss 1.961, Loss_clf 0.379, Loss_fe 0.433, Loss_kd 1.088, Train_accy 83.70:  50%|█████     | 10/20 [07:20<07:07, 42.70s/it]
Task 9, Epoch 11/20 => Loss 1.997, Loss_clf 0.381, Loss_fe 0.432, Loss_kd 1.122, Train_accy 83.11, Test_accy 82.83:  50%|█████     | 10/20 [08:15<07:07, 42.70s/it]
Task 9, Epoch 11/20 => Loss 1.997, Loss_clf 0.381, Loss_fe 0.432, Loss_kd 1.122, Train_accy 83.11, Test_accy 82.83:  55%|█████▌    | 11/20 [08:15<06:57, 46.42s/it]
Task 9, Epoch 12/20 => Loss 1.899, Loss_clf 0.364, Loss_fe 0.383, Loss_kd 1.091, Train_accy 83.48:  55%|█████▌    | 11/20 [08:57<06:57, 46.42s/it]                 
Task 9, Epoch 12/20 => Loss 1.899, Loss_clf 0.364, Loss_fe 0.383, Loss_kd 1.091, Train_accy 83.48:  60%|██████    | 12/20 [08:57<05:59, 44.94s/it]
Task 9, Epoch 13/20 => Loss 1.913, Loss_clf 0.364, Loss_fe 0.388, Loss_kd 1.100, Train_accy 83.53:  60%|██████    | 12/20 [09:38<05:59, 44.94s/it]
Task 9, Epoch 13/20 => Loss 1.913, Loss_clf 0.364, Loss_fe 0.388, Loss_kd 1.100, Train_accy 83.53:  65%|██████▌   | 13/20 [09:38<05:07, 43.90s/it]
Task 9, Epoch 14/20 => Loss 1.906, Loss_clf 0.365, Loss_fe 0.385, Loss_kd 1.095, Train_accy 83.82:  65%|██████▌   | 13/20 [10:20<05:07, 43.90s/it]
Task 9, Epoch 14/20 => Loss 1.906, Loss_clf 0.365, Loss_fe 0.385, Loss_kd 1.095, Train_accy 83.82:  70%|███████   | 14/20 [10:20<04:19, 43.20s/it]
Task 9, Epoch 15/20 => Loss 1.942, Loss_clf 0.374, Loss_fe 0.381, Loss_kd 1.124, Train_accy 83.87:  70%|███████   | 14/20 [11:01<04:19, 43.20s/it]
Task 9, Epoch 15/20 => Loss 1.942, Loss_clf 0.374, Loss_fe 0.381, Loss_kd 1.124, Train_accy 83.87:  75%|███████▌  | 15/20 [11:01<03:33, 42.70s/it]
Task 9, Epoch 16/20 => Loss 1.890, Loss_clf 0.364, Loss_fe 0.349, Loss_kd 1.114, Train_accy 83.92, Test_accy 82.74:  75%|███████▌  | 15/20 [11:56<03:33, 42.70s/it]
Task 9, Epoch 16/20 => Loss 1.890, Loss_clf 0.364, Loss_fe 0.349, Loss_kd 1.114, Train_accy 83.92, Test_accy 82.74:  80%|████████  | 16/20 [11:56<03:05, 46.30s/it]
Task 9, Epoch 17/20 => Loss 1.814, Loss_clf 0.339, Loss_fe 0.329, Loss_kd 1.086, Train_accy 84.39:  80%|████████  | 16/20 [12:37<03:05, 46.30s/it]                 
Task 9, Epoch 17/20 => Loss 1.814, Loss_clf 0.339, Loss_fe 0.329, Loss_kd 1.086, Train_accy 84.39:  85%|████████▌ | 17/20 [12:37<02:14, 44.89s/it]
Task 9, Epoch 18/20 => Loss 1.862, Loss_clf 0.353, Loss_fe 0.339, Loss_kd 1.109, Train_accy 84.27:  85%|████████▌ | 17/20 [13:19<02:14, 44.89s/it]
Task 9, Epoch 18/20 => Loss 1.862, Loss_clf 0.353, Loss_fe 0.339, Loss_kd 1.109, Train_accy 84.27:  90%|█████████ | 18/20 [13:19<01:27, 43.92s/it]
Task 9, Epoch 19/20 => Loss 1.829, Loss_clf 0.353, Loss_fe 0.334, Loss_kd 1.082, Train_accy 83.40:  90%|█████████ | 18/20 [14:01<01:27, 43.92s/it]
Task 9, Epoch 19/20 => Loss 1.829, Loss_clf 0.353, Loss_fe 0.334, Loss_kd 1.082, Train_accy 83.40:  95%|█████████▌| 19/20 [14:01<00:43, 43.25s/it]
Task 9, Epoch 20/20 => Loss 1.757, Loss_clf 0.322, Loss_fe 0.307, Loss_kd 1.069, Train_accy 84.49:  95%|█████████▌| 19/20 [14:42<00:43, 43.25s/it]
Task 9, Epoch 20/20 => Loss 1.757, Loss_clf 0.322, Loss_fe 0.307, Loss_kd 1.069, Train_accy 84.49: 100%|██████████| 20/20 [14:42<00:00, 42.74s/it]
Task 9, Epoch 20/20 => Loss 1.757, Loss_clf 0.322, Loss_fe 0.307, Loss_kd 1.069, Train_accy 84.49: 100%|██████████| 20/20 [14:42<00:00, 44.14s/it]2024-09-13 16:34:09,204 [foster.py] => Task 9, Epoch 20/20 => Loss 1.757, Loss_clf 0.322, Loss_fe 0.307, Loss_kd 1.069, Train_accy 84.49
2024-09-13 16:34:09,205 [foster.py] => do not weight align teacher!
2024-09-13 16:34:09,207 [foster.py] => per cls weights : [1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404 1.02946404
 0.46964732 0.46964732 0.46964732 0.46964732 0.46964732 0.46964732
 0.46964732 0.46964732 0.46964732 0.46964732]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.130,  Train_accy 79.85, Test_accy 82.39:   0%|          | 0/20 [00:59<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.130,  Train_accy 79.85, Test_accy 82.39:   5%|▌         | 1/20 [00:59<18:44, 59.18s/it]
SNet: Task 9, Epoch 2/20 => Loss 1.103,  Train_accy 80.74:   5%|▌         | 1/20 [01:51<18:44, 59.18s/it]                 
SNet: Task 9, Epoch 2/20 => Loss 1.103,  Train_accy 80.74:  10%|█         | 2/20 [01:51<16:31, 55.10s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.088,  Train_accy 81.43:  10%|█         | 2/20 [02:43<16:31, 55.10s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.088,  Train_accy 81.43:  15%|█▌        | 3/20 [02:43<15:14, 53.78s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.078,  Train_accy 81.50:  15%|█▌        | 3/20 [03:35<15:14, 53.78s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.078,  Train_accy 81.50:  20%|██        | 4/20 [03:35<14:10, 53.19s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.052,  Train_accy 81.63:  20%|██        | 4/20 [04:28<14:10, 53.19s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.052,  Train_accy 81.63:  25%|██▌       | 5/20 [04:28<13:12, 52.83s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.074,  Train_accy 81.87, Test_accy 82.96:  25%|██▌       | 5/20 [05:27<13:12, 52.83s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.074,  Train_accy 81.87, Test_accy 82.96:  30%|███       | 6/20 [05:27<12:52, 55.19s/it]
SNet: Task 9, Epoch 7/20 => Loss 1.050,  Train_accy 82.15:  30%|███       | 6/20 [06:20<12:52, 55.19s/it]                 
SNet: Task 9, Epoch 7/20 => Loss 1.050,  Train_accy 82.15:  35%|███▌      | 7/20 [06:20<11:45, 54.24s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.091,  Train_accy 81.87:  35%|███▌      | 7/20 [07:12<11:45, 54.24s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.091,  Train_accy 81.87:  40%|████      | 8/20 [07:12<10:43, 53.62s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.087,  Train_accy 82.15:  40%|████      | 8/20 [08:04<10:43, 53.62s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.087,  Train_accy 82.15:  45%|████▌     | 9/20 [08:04<09:45, 53.18s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.058,  Train_accy 82.44:  45%|████▌     | 9/20 [08:56<09:45, 53.18s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.058,  Train_accy 82.44:  50%|█████     | 10/20 [08:56<08:48, 52.89s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.066,  Train_accy 82.15, Test_accy 82.52:  50%|█████     | 10/20 [09:56<08:48, 52.89s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.066,  Train_accy 82.15, Test_accy 82.52:  55%|█████▌    | 11/20 [09:56<08:14, 54.91s/it]
SNet: Task 9, Epoch 12/20 => Loss 1.032,  Train_accy 82.27:  55%|█████▌    | 11/20 [10:48<08:14, 54.91s/it]                 
SNet: Task 9, Epoch 12/20 => Loss 1.032,  Train_accy 82.27:  60%|██████    | 12/20 [10:48<07:12, 54.10s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.066,  Train_accy 81.75:  60%|██████    | 12/20 [11:40<07:12, 54.10s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.066,  Train_accy 81.75:  65%|██████▌   | 13/20 [11:40<06:14, 53.57s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.071,  Train_accy 82.86:  65%|██████▌   | 13/20 [12:33<06:14, 53.57s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.071,  Train_accy 82.86:  70%|███████   | 14/20 [12:33<05:19, 53.20s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.050,  Train_accy 82.17:  70%|███████   | 14/20 [13:25<05:19, 53.20s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.050,  Train_accy 82.17:  75%|███████▌  | 15/20 [13:25<04:24, 52.94s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.034,  Train_accy 82.22, Test_accy 82.65:  75%|███████▌  | 15/20 [14:25<04:24, 52.94s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.034,  Train_accy 82.22, Test_accy 82.65:  80%|████████  | 16/20 [14:25<03:39, 54.90s/it]
SNet: Task 9, Epoch 17/20 => Loss 1.081,  Train_accy 82.10:  80%|████████  | 16/20 [15:17<03:39, 54.90s/it]                 
SNet: Task 9, Epoch 17/20 => Loss 1.081,  Train_accy 82.10:  85%|████████▌ | 17/20 [15:17<02:42, 54.07s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.097,  Train_accy 81.23:  85%|████████▌ | 17/20 [16:09<02:42, 54.07s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.097,  Train_accy 81.23:  90%|█████████ | 18/20 [16:09<01:47, 53.51s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.032,  Train_accy 82.84:  90%|█████████ | 18/20 [17:01<01:47, 53.51s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.032,  Train_accy 82.84:  95%|█████████▌| 19/20 [17:01<00:53, 53.14s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.044,  Train_accy 83.08:  95%|█████████▌| 19/20 [17:53<00:53, 53.14s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.044,  Train_accy 83.08: 100%|██████████| 20/20 [17:53<00:00, 52.87s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.044,  Train_accy 83.08: 100%|██████████| 20/20 [17:53<00:00, 53.70s/it]2024-09-13 16:52:04,882 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 1.044,  Train_accy 83.08
2024-09-13 16:52:04,882 [foster.py] => do not weight align student!

2024-09-13 16:52:12,009 [foster.py] => darknet eval: 
2024-09-13 16:52:12,009 [foster.py] => CNN top1 curve: 82.74
2024-09-13 16:52:12,010 [foster.py] => CNN top5 curve: 96.19
2024-09-13 16:52:12,013 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 16:54:18,109 [foster.py] => Exemplar size: 3800
2024-09-13 16:54:18,110 [trainer.py] => CNN: {'total': 82.48, '00-99': 88.22, '100-109': 89.57, '110-119': 84.96, '120-129': 87.85, '130-139': 85.59, '140-149': 80.16, '150-159': 92.74, '160-169': 81.34, '170-179': 68.93, '180-189': 19.7, 'old': 86.37, 'new': 19.7}
2024-09-13 16:54:18,110 [trainer.py] => NME: {'total': 87.83, '00-99': 87.96, '100-109': 92.17, '110-119': 81.42, '120-129': 85.05, '130-139': 88.14, '140-149': 83.33, '150-159': 93.55, '160-169': 88.81, '170-179': 89.32, '180-189': 87.12, 'old': 87.88, 'new': 87.12}
2024-09-13 16:54:18,110 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74, 85.56, 84.32, 84.08, 83.8, 83.88, 82.48]
2024-09-13 16:54:18,110 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42, 98.11, 97.85, 98.15, 97.93, 97.6, 96.95]
2024-09-13 16:54:18,110 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25, 88.54, 88.57, 88.47, 88.49, 87.92, 87.83]
2024-09-13 16:54:18,110 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69, 98.66, 98.53, 98.47, 98.52, 98.31, 97.7]

Average Accuracy (CNN): 85.73
Average Accuracy (NME): 88.9
2024-09-13 16:54:18,110 [trainer.py] => Average Accuracy (CNN): 85.73
2024-09-13 16:54:18,110 [trainer.py] => Average Accuracy (NME): 88.9
2024-09-13 16:54:18,112 [trainer.py] => All params: 172173872
2024-09-13 16:54:18,113 [trainer.py] => Trainable params: 86236796
2024-09-13 16:54:19,836 [foster.py] => Learning on 190-200
2024-09-13 16:54:19,838 [foster.py] => All params: 172204622
2024-09-13 16:54:19,838 [foster.py] => Trainable params: 86259856
2024-09-13 16:54:19,929 [foster.py] => per cls weights : [1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958 1.02259958
 1.02259958 1.02259958 1.02259958 1.02259958 0.57060807 0.57060807
 0.57060807 0.57060807 0.57060807 0.57060807 0.57060807 0.57060807
 0.57060807 0.57060807]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 5.685, Loss_clf 0.779, Loss_fe 3.713, Loss_kd 1.133, Train_accy 79.54, Test_accy 82.02:   0%|          | 0/20 [00:56<?, ?it/s]
Task 10, Epoch 1/20 => Loss 5.685, Loss_clf 0.779, Loss_fe 3.713, Loss_kd 1.133, Train_accy 79.54, Test_accy 82.02:   5%|▌         | 1/20 [00:56<17:58, 56.76s/it]
Task 10, Epoch 2/20 => Loss 2.949, Loss_clf 0.563, Loss_fe 1.182, Loss_kd 1.143, Train_accy 80.66:   5%|▌         | 1/20 [01:40<17:58, 56.76s/it]                 
Task 10, Epoch 2/20 => Loss 2.949, Loss_clf 0.563, Loss_fe 1.182, Loss_kd 1.143, Train_accy 80.66:  10%|█         | 2/20 [01:40<14:42, 49.05s/it]
Task 10, Epoch 3/20 => Loss 2.557, Loss_clf 0.482, Loss_fe 0.888, Loss_kd 1.128, Train_accy 81.73:  10%|█         | 2/20 [02:24<14:42, 49.05s/it]
Task 10, Epoch 3/20 => Loss 2.557, Loss_clf 0.482, Loss_fe 0.888, Loss_kd 1.128, Train_accy 81.73:  15%|█▌        | 3/20 [02:24<13:13, 46.65s/it]
Task 10, Epoch 4/20 => Loss 2.385, Loss_clf 0.473, Loss_fe 0.724, Loss_kd 1.129, Train_accy 82.45:  15%|█▌        | 3/20 [03:08<13:13, 46.65s/it]
Task 10, Epoch 4/20 => Loss 2.385, Loss_clf 0.473, Loss_fe 0.724, Loss_kd 1.129, Train_accy 82.45:  20%|██        | 4/20 [03:08<12:08, 45.55s/it]
Task 10, Epoch 5/20 => Loss 2.322, Loss_clf 0.459, Loss_fe 0.662, Loss_kd 1.141, Train_accy 82.50:  20%|██        | 4/20 [03:51<12:08, 45.55s/it]
Task 10, Epoch 5/20 => Loss 2.322, Loss_clf 0.459, Loss_fe 0.662, Loss_kd 1.141, Train_accy 82.50:  25%|██▌       | 5/20 [03:51<11:14, 44.96s/it]
Task 10, Epoch 6/20 => Loss 2.263, Loss_clf 0.441, Loss_fe 0.618, Loss_kd 1.144, Train_accy 82.64, Test_accy 84.22:  25%|██▌       | 5/20 [04:49<11:14, 44.96s/it]
Task 10, Epoch 6/20 => Loss 2.263, Loss_clf 0.441, Loss_fe 0.618, Loss_kd 1.144, Train_accy 82.64, Test_accy 84.22:  30%|███       | 6/20 [04:49<11:28, 49.21s/it]
Task 10, Epoch 7/20 => Loss 2.154, Loss_clf 0.419, Loss_fe 0.550, Loss_kd 1.126, Train_accy 82.69:  30%|███       | 6/20 [05:33<11:28, 49.21s/it]                 
Task 10, Epoch 7/20 => Loss 2.154, Loss_clf 0.419, Loss_fe 0.550, Loss_kd 1.126, Train_accy 82.69:  35%|███▌      | 7/20 [05:33<10:17, 47.51s/it]
Task 10, Epoch 8/20 => Loss 2.143, Loss_clf 0.419, Loss_fe 0.538, Loss_kd 1.126, Train_accy 82.94:  35%|███▌      | 7/20 [06:17<10:17, 47.51s/it]
Task 10, Epoch 8/20 => Loss 2.143, Loss_clf 0.419, Loss_fe 0.538, Loss_kd 1.126, Train_accy 82.94:  40%|████      | 8/20 [06:17<09:16, 46.36s/it]
Task 10, Epoch 9/20 => Loss 2.101, Loss_clf 0.410, Loss_fe 0.496, Loss_kd 1.135, Train_accy 83.03:  40%|████      | 8/20 [07:01<09:16, 46.36s/it]
Task 10, Epoch 9/20 => Loss 2.101, Loss_clf 0.410, Loss_fe 0.496, Loss_kd 1.135, Train_accy 83.03:  45%|████▌     | 9/20 [07:01<08:21, 45.62s/it]
Task 10, Epoch 10/20 => Loss 1.989, Loss_clf 0.382, Loss_fe 0.433, Loss_kd 1.115, Train_accy 83.80:  45%|████▌     | 9/20 [07:45<08:21, 45.62s/it]
Task 10, Epoch 10/20 => Loss 1.989, Loss_clf 0.382, Loss_fe 0.433, Loss_kd 1.115, Train_accy 83.80:  50%|█████     | 10/20 [07:45<07:31, 45.12s/it]
Task 10, Epoch 11/20 => Loss 2.018, Loss_clf 0.388, Loss_fe 0.450, Loss_kd 1.122, Train_accy 83.08, Test_accy 84.01:  50%|█████     | 10/20 [08:42<07:31, 45.12s/it]
Task 10, Epoch 11/20 => Loss 2.018, Loss_clf 0.388, Loss_fe 0.450, Loss_kd 1.122, Train_accy 83.08, Test_accy 84.01:  55%|█████▌    | 11/20 [08:42<07:20, 48.95s/it]
Task 10, Epoch 12/20 => Loss 1.955, Loss_clf 0.363, Loss_fe 0.407, Loss_kd 1.126, Train_accy 83.92:  55%|█████▌    | 11/20 [09:26<07:20, 48.95s/it]                 
Task 10, Epoch 12/20 => Loss 1.955, Loss_clf 0.363, Loss_fe 0.407, Loss_kd 1.126, Train_accy 83.92:  60%|██████    | 12/20 [09:26<06:19, 47.43s/it]
Task 10, Epoch 13/20 => Loss 2.002, Loss_clf 0.388, Loss_fe 0.420, Loss_kd 1.134, Train_accy 83.69:  60%|██████    | 12/20 [10:10<06:19, 47.43s/it]
Task 10, Epoch 13/20 => Loss 2.002, Loss_clf 0.388, Loss_fe 0.420, Loss_kd 1.134, Train_accy 83.69:  65%|██████▌   | 13/20 [10:10<05:24, 46.38s/it]
Task 10, Epoch 14/20 => Loss 1.936, Loss_clf 0.378, Loss_fe 0.376, Loss_kd 1.123, Train_accy 83.85:  65%|██████▌   | 13/20 [10:54<05:24, 46.38s/it]
Task 10, Epoch 14/20 => Loss 1.936, Loss_clf 0.378, Loss_fe 0.376, Loss_kd 1.123, Train_accy 83.85:  70%|███████   | 14/20 [10:54<04:33, 45.64s/it]
Task 10, Epoch 15/20 => Loss 1.791, Loss_clf 0.321, Loss_fe 0.327, Loss_kd 1.086, Train_accy 84.87:  70%|███████   | 14/20 [11:38<04:33, 45.64s/it]
Task 10, Epoch 15/20 => Loss 1.791, Loss_clf 0.321, Loss_fe 0.327, Loss_kd 1.086, Train_accy 84.87:  75%|███████▌  | 15/20 [11:38<03:45, 45.13s/it]
Task 10, Epoch 16/20 => Loss 1.893, Loss_clf 0.362, Loss_fe 0.365, Loss_kd 1.108, Train_accy 83.48, Test_accy 84.18:  75%|███████▌  | 15/20 [12:36<03:45, 45.13s/it]
Task 10, Epoch 16/20 => Loss 1.893, Loss_clf 0.362, Loss_fe 0.365, Loss_kd 1.108, Train_accy 83.48, Test_accy 84.18:  80%|████████  | 16/20 [12:36<03:15, 48.89s/it]
Task 10, Epoch 17/20 => Loss 1.911, Loss_clf 0.372, Loss_fe 0.356, Loss_kd 1.123, Train_accy 84.11:  80%|████████  | 16/20 [13:20<03:15, 48.89s/it]                 
Task 10, Epoch 17/20 => Loss 1.911, Loss_clf 0.372, Loss_fe 0.356, Loss_kd 1.123, Train_accy 84.11:  85%|████████▌ | 17/20 [13:20<02:22, 47.38s/it]
Task 10, Epoch 18/20 => Loss 1.769, Loss_clf 0.322, Loss_fe 0.306, Loss_kd 1.085, Train_accy 84.48:  85%|████████▌ | 17/20 [14:04<02:22, 47.38s/it]
Task 10, Epoch 18/20 => Loss 1.769, Loss_clf 0.322, Loss_fe 0.306, Loss_kd 1.085, Train_accy 84.48:  90%|█████████ | 18/20 [14:04<01:32, 46.37s/it]
Task 10, Epoch 19/20 => Loss 1.885, Loss_clf 0.364, Loss_fe 0.343, Loss_kd 1.118, Train_accy 84.24:  90%|█████████ | 18/20 [14:48<01:32, 46.37s/it]
Task 10, Epoch 19/20 => Loss 1.885, Loss_clf 0.364, Loss_fe 0.343, Loss_kd 1.118, Train_accy 84.24:  95%|█████████▌| 19/20 [14:48<00:45, 45.65s/it]
Task 10, Epoch 20/20 => Loss 1.832, Loss_clf 0.339, Loss_fe 0.334, Loss_kd 1.101, Train_accy 84.45:  95%|█████████▌| 19/20 [15:32<00:45, 45.65s/it]
Task 10, Epoch 20/20 => Loss 1.832, Loss_clf 0.339, Loss_fe 0.334, Loss_kd 1.101, Train_accy 84.45: 100%|██████████| 20/20 [15:32<00:00, 45.17s/it]
Task 10, Epoch 20/20 => Loss 1.832, Loss_clf 0.339, Loss_fe 0.334, Loss_kd 1.101, Train_accy 84.45: 100%|██████████| 20/20 [15:32<00:00, 46.62s/it]2024-09-13 17:09:52,248 [foster.py] => Task 10, Epoch 20/20 => Loss 1.832, Loss_clf 0.339, Loss_fe 0.334, Loss_kd 1.101, Train_accy 84.45
2024-09-13 17:09:52,249 [foster.py] => do not weight align teacher!
2024-09-13 17:09:52,252 [foster.py] => per cls weights : [1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966 1.02794966
 1.02794966 1.02794966 1.02794966 1.02794966 0.46895645 0.46895645
 0.46895645 0.46895645 0.46895645 0.46895645 0.46895645 0.46895645
 0.46895645 0.46895645]


  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 1.111,  Train_accy 80.01, Test_accy 83.67:   0%|          | 0/20 [01:02<?, ?it/s]
SNet: Task 10, Epoch 1/20 => Loss 1.111,  Train_accy 80.01, Test_accy 83.67:   5%|▌         | 1/20 [01:02<19:48, 62.53s/it]
SNet: Task 10, Epoch 2/20 => Loss 1.100,  Train_accy 81.15:   5%|▌         | 1/20 [01:57<19:48, 62.53s/it]                 
SNet: Task 10, Epoch 2/20 => Loss 1.100,  Train_accy 81.15:  10%|█         | 2/20 [01:57<17:27, 58.20s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.109,  Train_accy 81.31:  10%|█         | 2/20 [02:52<17:27, 58.20s/it]
SNet: Task 10, Epoch 3/20 => Loss 1.109,  Train_accy 81.31:  15%|█▌        | 3/20 [02:52<16:06, 56.84s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.065,  Train_accy 81.94:  15%|█▌        | 3/20 [03:48<16:06, 56.84s/it]
SNet: Task 10, Epoch 4/20 => Loss 1.065,  Train_accy 81.94:  20%|██        | 4/20 [03:48<14:59, 56.24s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.078,  Train_accy 81.59:  20%|██        | 4/20 [04:43<14:59, 56.24s/it]
SNet: Task 10, Epoch 5/20 => Loss 1.078,  Train_accy 81.59:  25%|██▌       | 5/20 [04:43<13:58, 55.88s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.100,  Train_accy 81.38, Test_accy 84.05:  25%|██▌       | 5/20 [05:46<13:58, 55.88s/it]
SNet: Task 10, Epoch 6/20 => Loss 1.100,  Train_accy 81.38, Test_accy 84.05:  30%|███       | 6/20 [05:46<13:35, 58.22s/it]
SNet: Task 10, Epoch 7/20 => Loss 1.030,  Train_accy 83.06:  30%|███       | 6/20 [06:41<13:35, 58.22s/it]                 
SNet: Task 10, Epoch 7/20 => Loss 1.030,  Train_accy 83.06:  35%|███▌      | 7/20 [06:41<12:24, 57.23s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.031,  Train_accy 83.43:  35%|███▌      | 7/20 [07:36<12:24, 57.23s/it]
SNet: Task 10, Epoch 8/20 => Loss 1.031,  Train_accy 83.43:  40%|████      | 8/20 [07:36<11:19, 56.60s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.077,  Train_accy 82.52:  40%|████      | 8/20 [08:32<11:19, 56.60s/it]
SNet: Task 10, Epoch 9/20 => Loss 1.077,  Train_accy 82.52:  45%|████▌     | 9/20 [08:32<10:18, 56.20s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.110,  Train_accy 81.48:  45%|████▌     | 9/20 [09:27<10:18, 56.20s/it]
SNet: Task 10, Epoch 10/20 => Loss 1.110,  Train_accy 81.48:  50%|█████     | 10/20 [09:27<09:19, 55.91s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.057,  Train_accy 82.43, Test_accy 84.10:  50%|█████     | 10/20 [10:29<09:19, 55.91s/it]
SNet: Task 10, Epoch 11/20 => Loss 1.057,  Train_accy 82.43, Test_accy 84.10:  55%|█████▌    | 11/20 [10:29<08:41, 57.96s/it]
SNet: Task 10, Epoch 12/20 => Loss 1.048,  Train_accy 82.29:  55%|█████▌    | 11/20 [11:25<08:41, 57.96s/it]                 
SNet: Task 10, Epoch 12/20 => Loss 1.048,  Train_accy 82.29:  60%|██████    | 12/20 [11:25<07:37, 57.14s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.092,  Train_accy 82.52:  60%|██████    | 12/20 [12:20<07:37, 57.14s/it]
SNet: Task 10, Epoch 13/20 => Loss 1.092,  Train_accy 82.52:  65%|██████▌   | 13/20 [12:20<06:36, 56.57s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.080,  Train_accy 82.50:  65%|██████▌   | 13/20 [13:15<06:36, 56.57s/it]
SNet: Task 10, Epoch 14/20 => Loss 1.080,  Train_accy 82.50:  70%|███████   | 14/20 [13:15<05:37, 56.23s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.057,  Train_accy 82.59:  70%|███████   | 14/20 [14:11<05:37, 56.23s/it]
SNet: Task 10, Epoch 15/20 => Loss 1.057,  Train_accy 82.59:  75%|███████▌  | 15/20 [14:11<04:39, 55.93s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.040,  Train_accy 83.27, Test_accy 84.01:  75%|███████▌  | 15/20 [15:13<04:39, 55.93s/it]
SNet: Task 10, Epoch 16/20 => Loss 1.040,  Train_accy 83.27, Test_accy 84.01:  80%|████████  | 16/20 [15:13<03:51, 57.94s/it]
SNet: Task 10, Epoch 17/20 => Loss 1.072,  Train_accy 82.41:  80%|████████  | 16/20 [16:08<03:51, 57.94s/it]                 
SNet: Task 10, Epoch 17/20 => Loss 1.072,  Train_accy 82.41:  85%|████████▌ | 17/20 [16:08<02:51, 57.12s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.086,  Train_accy 82.90:  85%|████████▌ | 17/20 [17:04<02:51, 57.12s/it]
SNet: Task 10, Epoch 18/20 => Loss 1.086,  Train_accy 82.90:  90%|█████████ | 18/20 [17:04<01:53, 56.57s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.058,  Train_accy 82.48:  90%|█████████ | 18/20 [17:59<01:53, 56.57s/it]
SNet: Task 10, Epoch 19/20 => Loss 1.058,  Train_accy 82.48:  95%|█████████▌| 19/20 [17:59<00:56, 56.19s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.079,  Train_accy 82.15:  95%|█████████▌| 19/20 [18:54<00:56, 56.19s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.079,  Train_accy 82.15: 100%|██████████| 20/20 [18:54<00:00, 55.93s/it]
SNet: Task 10, Epoch 20/20 => Loss 1.079,  Train_accy 82.15: 100%|██████████| 20/20 [18:54<00:00, 56.74s/it]2024-09-13 17:28:49,373 [foster.py] => SNet: Task 10, Epoch 20/20 => Loss 1.079,  Train_accy 82.15
2024-09-13 17:28:49,374 [foster.py] => do not weight align student!

2024-09-13 17:28:56,753 [foster.py] => darknet eval: 
2024-09-13 17:28:56,754 [foster.py] => CNN top1 curve: 84.1
2024-09-13 17:28:56,754 [foster.py] => CNN top5 curve: 97.12
2024-09-13 17:28:56,756 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-09-13 17:33:18,240 [foster.py] => Exemplar size: 4000
2024-09-13 17:33:18,241 [trainer.py] => CNN: {'total': 83.8, '00-99': 88.47, '100-109': 88.7, '110-119': 83.19, '120-129': 85.98, '130-139': 87.29, '140-149': 83.33, '150-159': 93.55, '160-169': 82.84, '170-179': 79.61, '180-189': 65.15, '190-199': 34.69, 'old': 85.93, 'new': 34.69}
2024-09-13 17:33:18,241 [trainer.py] => NME: {'total': 86.68, '00-99': 86.95, '100-109': 92.17, '110-119': 84.07, '120-129': 81.31, '130-139': 84.75, '140-149': 83.33, '150-159': 94.35, '160-169': 88.06, '170-179': 89.32, '180-189': 84.09, '190-199': 81.63, 'old': 86.9, 'new': 81.63}
2024-09-13 17:33:18,241 [trainer.py] => CNN top1 curve: [91.84, 88.33, 86.23, 86.74, 85.56, 84.32, 84.08, 83.8, 83.88, 82.48, 83.8]
2024-09-13 17:33:18,241 [trainer.py] => CNN top5 curve: [98.82, 98.47, 98.66, 98.42, 98.11, 97.85, 98.15, 97.93, 97.6, 96.95, 97.24]
2024-09-13 17:33:18,241 [trainer.py] => NME top1 curve: [91.08, 90.87, 88.98, 88.25, 88.54, 88.57, 88.47, 88.49, 87.92, 87.83, 86.68]
2024-09-13 17:33:18,241 [trainer.py] => NME top5 curve: [99.16, 99.08, 98.66, 98.69, 98.66, 98.53, 98.47, 98.52, 98.31, 97.7, 97.79]

Average Accuracy (CNN): 85.55
Average Accuracy (NME): 88.7
2024-09-13 17:33:18,241 [trainer.py] => Average Accuracy (CNN): 85.55
2024-09-13 17:33:18,241 [trainer.py] => Average Accuracy (NME): 88.7
Accuracy Matrix (CNN):
[[91.84 91.33 91.75 91.84 90.82 89.98 90.24 89.98 88.13 88.22 88.47]
 [ 0.   57.39 79.13 86.96 89.57 90.43 91.3  90.43 90.43 89.57 88.7 ]
 [ 0.    0.   35.4  66.37 78.76 82.3  83.19 81.42 84.07 84.96 83.19]
 [ 0.    0.    0.   51.4  75.7  84.11 85.05 88.79 88.79 87.85 85.98]
 [ 0.    0.    0.    0.   44.07 72.88 75.42 80.51 86.44 85.59 87.29]
 [ 0.    0.    0.    0.    0.   38.1  69.05 80.95 81.75 80.16 83.33]
 [ 0.    0.    0.    0.    0.    0.   41.94 68.55 88.71 92.74 93.55]
 [ 0.    0.    0.    0.    0.    0.    0.   41.04 67.16 81.34 82.84]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   37.86 68.93 79.61]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   19.7  65.15]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   34.69]]
2024-09-13 17:33:18,242 [trainer.py] => Forgetting (CNN): 1.0549999999999997
Accuracy Matrix (NME):
[[91.08 90.91 88.97 88.64 89.23 88.72 87.96 87.96 87.54 87.96 86.95]
 [ 0.   90.43 91.3  92.17 93.04 92.17 91.3  93.91 92.17 92.17 92.17]
 [ 0.    0.   86.73 80.53 81.42 83.19 86.73 84.96 83.19 81.42 84.07]
 [ 0.    0.    0.   87.85 83.18 85.98 87.85 85.05 84.11 85.05 81.31]
 [ 0.    0.    0.    0.   88.98 88.98 89.83 88.14 88.98 88.14 84.75]
 [ 0.    0.    0.    0.    0.   90.48 85.71 86.51 84.92 83.33 83.33]
 [ 0.    0.    0.    0.    0.    0.   94.35 95.16 95.97 93.55 94.35]
 [ 0.    0.    0.    0.    0.    0.    0.   90.3  90.3  88.81 88.06]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   86.41 89.32 89.32]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   87.12 84.09]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   81.63]]
2024-09-13 17:33:18,244 [trainer.py] => Forgetting (NME): 3.4189999999999996
2024-09-05 20:25:26,788 [trainer.py] => config: ./exps/l2p_cub_B0_Inc5.json
2024-09-05 20:25:26,788 [trainer.py] => prefix:  
2024-09-05 20:25:26,788 [trainer.py] => dataset: cub
2024-09-05 20:25:26,788 [trainer.py] => memory_size: 0
2024-09-05 20:25:26,788 [trainer.py] => memory_per_class: 0
2024-09-05 20:25:26,788 [trainer.py] => fixed_memory: False
2024-09-05 20:25:26,788 [trainer.py] => shuffle: True
2024-09-05 20:25:26,788 [trainer.py] => init_cls: 40
2024-09-05 20:25:26,788 [trainer.py] => increment: 40
2024-09-05 20:25:26,788 [trainer.py] => model_name: l2p
2024-09-05 20:25:26,788 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-05 20:25:26,788 [trainer.py] => get_original_backbone: True
2024-09-05 20:25:26,788 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 20:25:26,788 [trainer.py] => seed: 1993
2024-09-05 20:25:26,789 [trainer.py] => tuned_epoch: 20
2024-09-05 20:25:26,789 [trainer.py] => init_lr: 0.001875
2024-09-05 20:25:26,789 [trainer.py] => batch_size: 48
2024-09-05 20:25:26,789 [trainer.py] => weight_decay: 0
2024-09-05 20:25:26,789 [trainer.py] => min_lr: 1e-05
2024-09-05 20:25:26,789 [trainer.py] => optimizer: adam
2024-09-05 20:25:26,789 [trainer.py] => scheduler: constant
2024-09-05 20:25:26,789 [trainer.py] => reinit_optimizer: True
2024-09-05 20:25:26,789 [trainer.py] => global_pool: token
2024-09-05 20:25:26,789 [trainer.py] => head_type: prompt
2024-09-05 20:25:26,789 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-05 20:25:26,789 [trainer.py] => pretrained: True
2024-09-05 20:25:26,789 [trainer.py] => drop: 0.0
2024-09-05 20:25:26,789 [trainer.py] => drop_path: 0.0
2024-09-05 20:25:26,789 [trainer.py] => prompt_pool: True
2024-09-05 20:25:26,789 [trainer.py] => size: 10
2024-09-05 20:25:26,789 [trainer.py] => length: 5
2024-09-05 20:25:26,789 [trainer.py] => top_k: 5
2024-09-05 20:25:26,789 [trainer.py] => initializer: uniform
2024-09-05 20:25:26,789 [trainer.py] => prompt_key: True
2024-09-05 20:25:26,789 [trainer.py] => prompt_key_init: uniform
2024-09-05 20:25:26,789 [trainer.py] => use_prompt_mask: False
2024-09-05 20:25:26,789 [trainer.py] => shared_prompt_pool: False
2024-09-05 20:25:26,789 [trainer.py] => shared_prompt_key: False
2024-09-05 20:25:26,789 [trainer.py] => batchwise_prompt: True
2024-09-05 20:25:26,789 [trainer.py] => embedding_key: cls
2024-09-05 20:25:26,789 [trainer.py] => predefined_key: 
2024-09-05 20:25:26,789 [trainer.py] => pull_constraint: True
2024-09-05 20:25:26,789 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-05 20:25:26,826 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 20:25:28,425 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-05 20:25:28,426 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-05 20:25:30,259 [l2p.py] => 86,017,736 model total parameters.
2024-09-05 20:25:30,259 [l2p.py] => 199,880 model training parameters.
2024-09-05 20:25:30,259 [l2p.py] => prompt.prompt: 38400
2024-09-05 20:25:30,259 [l2p.py] => prompt.prompt_key: 7680
2024-09-05 20:25:30,260 [l2p.py] => head.weight: 153600
2024-09-05 20:25:30,260 [l2p.py] => head.bias: 200
2024-09-05 20:25:30,260 [trainer.py] => All params: 171970192
2024-09-05 20:25:30,261 [trainer.py] => Trainable params: 199880
2024-09-05 20:25:30,261 [l2p.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.649, Train_accy 57.85:   0%|          | 0/20 [00:18<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.649, Train_accy 57.85:   5%|▌         | 1/20 [00:18<05:45, 18.19s/it]
Task 0, Epoch 2/20 => Loss 0.466, Train_accy 84.72:   5%|▌         | 1/20 [00:35<05:45, 18.19s/it]
Task 0, Epoch 2/20 => Loss 0.466, Train_accy 84.72:  10%|█         | 2/20 [00:35<05:19, 17.73s/it]
Task 0, Epoch 3/20 => Loss 0.391, Train_accy 87.68:  10%|█         | 2/20 [00:53<05:19, 17.73s/it]
Task 0, Epoch 3/20 => Loss 0.391, Train_accy 87.68:  15%|█▌        | 3/20 [00:53<04:59, 17.61s/it]
Task 0, Epoch 4/20 => Loss 0.313, Train_accy 89.74:  15%|█▌        | 3/20 [01:10<04:59, 17.61s/it]
Task 0, Epoch 4/20 => Loss 0.313, Train_accy 89.74:  20%|██        | 4/20 [01:10<04:41, 17.58s/it]
Task 0, Epoch 5/20 => Loss 0.268, Train_accy 90.32, Test_accy 95.59:  20%|██        | 4/20 [01:31<04:41, 17.58s/it]
Task 0, Epoch 5/20 => Loss 0.268, Train_accy 90.32, Test_accy 95.59:  25%|██▌       | 5/20 [01:31<04:40, 18.73s/it]
Task 0, Epoch 6/20 => Loss 0.222, Train_accy 91.01:  25%|██▌       | 5/20 [01:48<04:40, 18.73s/it]                 
Task 0, Epoch 6/20 => Loss 0.222, Train_accy 91.01:  30%|███       | 6/20 [01:48<04:16, 18.34s/it]
Task 0, Epoch 7/20 => Loss 0.182, Train_accy 92.38:  30%|███       | 6/20 [02:06<04:16, 18.34s/it]
Task 0, Epoch 7/20 => Loss 0.182, Train_accy 92.38:  35%|███▌      | 7/20 [02:06<03:55, 18.09s/it]
Task 0, Epoch 8/20 => Loss 0.167, Train_accy 91.43:  35%|███▌      | 7/20 [02:24<03:55, 18.09s/it]
Task 0, Epoch 8/20 => Loss 0.167, Train_accy 91.43:  40%|████      | 8/20 [02:24<03:35, 17.96s/it]
Task 0, Epoch 9/20 => Loss 0.139, Train_accy 91.27:  40%|████      | 8/20 [02:41<03:35, 17.96s/it]
Task 0, Epoch 9/20 => Loss 0.139, Train_accy 91.27:  45%|████▌     | 9/20 [02:41<03:16, 17.89s/it]
Task 0, Epoch 10/20 => Loss 0.135, Train_accy 91.38, Test_accy 96.26:  45%|████▌     | 9/20 [03:02<03:16, 17.89s/it]
Task 0, Epoch 10/20 => Loss 0.135, Train_accy 91.38, Test_accy 96.26:  50%|█████     | 10/20 [03:02<03:08, 18.85s/it]
Task 0, Epoch 11/20 => Loss 0.133, Train_accy 91.27:  50%|█████     | 10/20 [03:20<03:08, 18.85s/it]                 
Task 0, Epoch 11/20 => Loss 0.133, Train_accy 91.27:  55%|█████▌    | 11/20 [03:20<02:46, 18.50s/it]
Task 0, Epoch 12/20 => Loss 0.073, Train_accy 92.76:  55%|█████▌    | 11/20 [03:38<02:46, 18.50s/it]
Task 0, Epoch 12/20 => Loss 0.073, Train_accy 92.76:  60%|██████    | 12/20 [03:38<02:26, 18.25s/it]
Task 0, Epoch 13/20 => Loss 0.068, Train_accy 92.86:  60%|██████    | 12/20 [03:56<02:26, 18.25s/it]
Task 0, Epoch 13/20 => Loss 0.068, Train_accy 92.86:  65%|██████▌   | 13/20 [03:56<02:06, 18.13s/it]
Task 0, Epoch 14/20 => Loss -0.001, Train_accy 93.92:  65%|██████▌   | 13/20 [04:13<02:06, 18.13s/it]
Task 0, Epoch 14/20 => Loss -0.001, Train_accy 93.92:  70%|███████   | 14/20 [04:13<01:48, 18.02s/it]
Task 0, Epoch 15/20 => Loss -0.007, Train_accy 93.13, Test_accy 95.37:  70%|███████   | 14/20 [04:34<01:48, 18.02s/it]
Task 0, Epoch 15/20 => Loss -0.007, Train_accy 93.13, Test_accy 95.37:  75%|███████▌  | 15/20 [04:34<01:34, 18.90s/it]
Task 0, Epoch 16/20 => Loss 0.007, Train_accy 93.71:  75%|███████▌  | 15/20 [04:52<01:34, 18.90s/it]                  
Task 0, Epoch 16/20 => Loss 0.007, Train_accy 93.71:  80%|████████  | 16/20 [04:52<01:14, 18.55s/it]
Task 0, Epoch 17/20 => Loss -0.025, Train_accy 94.08:  80%|████████  | 16/20 [05:10<01:14, 18.55s/it]
Task 0, Epoch 17/20 => Loss -0.025, Train_accy 94.08:  85%|████████▌ | 17/20 [05:10<00:54, 18.32s/it]
Task 0, Epoch 18/20 => Loss -0.015, Train_accy 93.81:  85%|████████▌ | 17/20 [05:28<00:54, 18.32s/it]
Task 0, Epoch 18/20 => Loss -0.015, Train_accy 93.81:  90%|█████████ | 18/20 [05:28<00:36, 18.14s/it]
Task 0, Epoch 19/20 => Loss 0.041, Train_accy 92.28:  90%|█████████ | 18/20 [05:45<00:36, 18.14s/it] 
Task 0, Epoch 19/20 => Loss 0.041, Train_accy 92.28:  95%|█████████▌| 19/20 [05:45<00:18, 18.01s/it]
Task 0, Epoch 20/20 => Loss 0.044, Train_accy 92.97, Test_accy 95.37:  95%|█████████▌| 19/20 [06:06<00:18, 18.01s/it]
Task 0, Epoch 20/20 => Loss 0.044, Train_accy 92.97, Test_accy 95.37: 100%|██████████| 20/20 [06:06<00:00, 18.91s/it]
Task 0, Epoch 20/20 => Loss 0.044, Train_accy 92.97, Test_accy 95.37: 100%|██████████| 20/20 [06:06<00:00, 18.34s/it]
2024-09-05 20:31:37,684 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.044, Train_accy 92.97, Test_accy 95.37
2024-09-05 20:31:40,868 [trainer.py] => No NME accuracy.
2024-09-05 20:31:40,868 [trainer.py] => CNN: {'total': 95.37, '00-39': 95.37, 'old': 0, 'new': 95.37}
2024-09-05 20:31:40,868 [trainer.py] => CNN top1 curve: [95.37]
2024-09-05 20:31:40,868 [trainer.py] => CNN top5 curve: [99.34]

Average Accuracy (CNN): 95.37
2024-09-05 20:31:40,869 [trainer.py] => Average Accuracy (CNN): 95.37 

2024-09-05 20:31:40,871 [trainer.py] => All params: 171970192
2024-09-05 20:31:40,873 [trainer.py] => Trainable params: 199880
2024-09-05 20:31:40,873 [l2p.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.853, Train_accy 73.00:   0%|          | 0/20 [00:17<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.853, Train_accy 73.00:   5%|▌         | 1/20 [00:17<05:36, 17.70s/it]
Task 1, Epoch 2/20 => Loss 0.135, Train_accy 89.94:   5%|▌         | 1/20 [00:35<05:36, 17.70s/it]
Task 1, Epoch 2/20 => Loss 0.135, Train_accy 89.94:  10%|█         | 2/20 [00:35<05:19, 17.73s/it]
Task 1, Epoch 3/20 => Loss 0.092, Train_accy 90.42:  10%|█         | 2/20 [00:53<05:19, 17.73s/it]
Task 1, Epoch 3/20 => Loss 0.092, Train_accy 90.42:  15%|█▌        | 3/20 [00:53<05:01, 17.75s/it]
Task 1, Epoch 4/20 => Loss 0.080, Train_accy 90.42:  15%|█▌        | 3/20 [01:10<05:01, 17.75s/it]
Task 1, Epoch 4/20 => Loss 0.080, Train_accy 90.42:  20%|██        | 4/20 [01:10<04:43, 17.73s/it]
Task 1, Epoch 5/20 => Loss 0.032, Train_accy 92.01, Test_accy 81.83:  20%|██        | 4/20 [01:34<04:43, 17.73s/it]
Task 1, Epoch 5/20 => Loss 0.032, Train_accy 92.01, Test_accy 81.83:  25%|██▌       | 5/20 [01:34<04:57, 19.87s/it]
Task 1, Epoch 6/20 => Loss 0.070, Train_accy 91.37:  25%|██▌       | 5/20 [01:52<04:57, 19.87s/it]                 
Task 1, Epoch 6/20 => Loss 0.070, Train_accy 91.37:  30%|███       | 6/20 [01:52<04:27, 19.14s/it]
Task 1, Epoch 7/20 => Loss 0.014, Train_accy 92.80:  30%|███       | 6/20 [02:10<04:27, 19.14s/it]
Task 1, Epoch 7/20 => Loss 0.014, Train_accy 92.80:  35%|███▌      | 7/20 [02:10<04:03, 18.70s/it]
Task 1, Epoch 8/20 => Loss 0.028, Train_accy 92.64:  35%|███▌      | 7/20 [02:27<04:03, 18.70s/it]
Task 1, Epoch 8/20 => Loss 0.028, Train_accy 92.64:  40%|████      | 8/20 [02:27<03:40, 18.41s/it]
Task 1, Epoch 9/20 => Loss 0.063, Train_accy 91.85:  40%|████      | 8/20 [02:45<03:40, 18.41s/it]
Task 1, Epoch 9/20 => Loss 0.063, Train_accy 91.85:  45%|████▌     | 9/20 [02:45<03:20, 18.21s/it]
Task 1, Epoch 10/20 => Loss 0.013, Train_accy 92.75, Test_accy 85.64:  45%|████▌     | 9/20 [03:09<03:20, 18.21s/it]
Task 1, Epoch 10/20 => Loss 0.013, Train_accy 92.75, Test_accy 85.64:  50%|█████     | 10/20 [03:09<03:19, 19.95s/it]
Task 1, Epoch 11/20 => Loss 0.018, Train_accy 92.38:  50%|█████     | 10/20 [03:27<03:19, 19.95s/it]                 
Task 1, Epoch 11/20 => Loss 0.018, Train_accy 92.38:  55%|█████▌    | 11/20 [03:27<02:53, 19.29s/it]
Task 1, Epoch 12/20 => Loss 0.012, Train_accy 92.96:  55%|█████▌    | 11/20 [03:45<02:53, 19.29s/it]
Task 1, Epoch 12/20 => Loss 0.012, Train_accy 92.96:  60%|██████    | 12/20 [03:45<02:30, 18.82s/it]
Task 1, Epoch 13/20 => Loss 0.009, Train_accy 92.64:  60%|██████    | 12/20 [04:02<02:30, 18.82s/it]
Task 1, Epoch 13/20 => Loss 0.009, Train_accy 92.64:  65%|██████▌   | 13/20 [04:02<02:09, 18.52s/it]
Task 1, Epoch 14/20 => Loss -0.032, Train_accy 93.86:  65%|██████▌   | 13/20 [04:20<02:09, 18.52s/it]
Task 1, Epoch 14/20 => Loss -0.032, Train_accy 93.86:  70%|███████   | 14/20 [04:20<01:49, 18.27s/it]
Task 1, Epoch 15/20 => Loss -0.013, Train_accy 93.22, Test_accy 87.60:  70%|███████   | 14/20 [04:44<01:49, 18.27s/it]
Task 1, Epoch 15/20 => Loss -0.013, Train_accy 93.22, Test_accy 87.60:  75%|███████▌  | 15/20 [04:44<01:39, 19.92s/it]
Task 1, Epoch 16/20 => Loss -0.058, Train_accy 94.71:  75%|███████▌  | 15/20 [05:02<01:39, 19.92s/it]                 
Task 1, Epoch 16/20 => Loss -0.058, Train_accy 94.71:  80%|████████  | 16/20 [05:02<01:17, 19.27s/it]
Task 1, Epoch 17/20 => Loss -0.024, Train_accy 93.86:  80%|████████  | 16/20 [05:19<01:17, 19.27s/it]
Task 1, Epoch 17/20 => Loss -0.024, Train_accy 93.86:  85%|████████▌ | 17/20 [05:19<00:56, 18.81s/it]
Task 1, Epoch 18/20 => Loss -0.020, Train_accy 93.97:  85%|████████▌ | 17/20 [05:37<00:56, 18.81s/it]
Task 1, Epoch 18/20 => Loss -0.020, Train_accy 93.97:  90%|█████████ | 18/20 [05:37<00:36, 18.49s/it]
Task 1, Epoch 19/20 => Loss -0.077, Train_accy 94.97:  90%|█████████ | 18/20 [05:55<00:36, 18.49s/it]
Task 1, Epoch 19/20 => Loss -0.077, Train_accy 94.97:  95%|█████████▌| 19/20 [05:55<00:18, 18.26s/it]
Task 1, Epoch 20/20 => Loss -0.024, Train_accy 93.86, Test_accy 84.55:  95%|█████████▌| 19/20 [06:18<00:18, 18.26s/it]
Task 1, Epoch 20/20 => Loss -0.024, Train_accy 93.86, Test_accy 84.55: 100%|██████████| 20/20 [06:18<00:00, 19.88s/it]
Task 1, Epoch 20/20 => Loss -0.024, Train_accy 93.86, Test_accy 84.55: 100%|██████████| 20/20 [06:18<00:00, 18.95s/it]
2024-09-05 20:37:59,809 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.024, Train_accy 93.86, Test_accy 84.55
2024-09-05 20:38:05,730 [trainer.py] => No NME accuracy.
2024-09-05 20:38:05,731 [trainer.py] => CNN: {'total': 84.55, '00-39': 81.28, '40-79': 87.74, 'old': 81.28, 'new': 87.74}
2024-09-05 20:38:05,731 [trainer.py] => CNN top1 curve: [95.37, 84.55]
2024-09-05 20:38:05,731 [trainer.py] => CNN top5 curve: [99.34, 98.8]

Average Accuracy (CNN): 89.96
2024-09-05 20:38:05,732 [trainer.py] => Average Accuracy (CNN): 89.96 

2024-09-05 20:38:05,735 [trainer.py] => All params: 171970192
2024-09-05 20:38:05,737 [trainer.py] => Trainable params: 199880
2024-09-05 20:38:05,737 [l2p.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.734, Train_accy 73.90:   0%|          | 0/20 [00:17<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.734, Train_accy 73.90:   5%|▌         | 1/20 [00:17<05:31, 17.47s/it]
Task 2, Epoch 2/20 => Loss 0.063, Train_accy 90.03:   5%|▌         | 1/20 [00:35<05:31, 17.47s/it]
Task 2, Epoch 2/20 => Loss 0.063, Train_accy 90.03:  10%|█         | 2/20 [00:35<05:15, 17.52s/it]
Task 2, Epoch 3/20 => Loss 0.072, Train_accy 90.73:  10%|█         | 2/20 [00:52<05:15, 17.52s/it]
Task 2, Epoch 3/20 => Loss 0.072, Train_accy 90.73:  15%|█▌        | 3/20 [00:52<04:57, 17.52s/it]
Task 2, Epoch 4/20 => Loss 0.025, Train_accy 91.21:  15%|█▌        | 3/20 [01:10<04:57, 17.52s/it]
Task 2, Epoch 4/20 => Loss 0.025, Train_accy 91.21:  20%|██        | 4/20 [01:10<04:40, 17.55s/it]
Task 2, Epoch 5/20 => Loss 0.012, Train_accy 92.44, Test_accy 73.31:  20%|██        | 4/20 [01:36<04:40, 17.55s/it]
Task 2, Epoch 5/20 => Loss 0.012, Train_accy 92.44, Test_accy 73.31:  25%|██▌       | 5/20 [01:36<05:10, 20.73s/it]
Task 2, Epoch 6/20 => Loss 0.031, Train_accy 91.32:  25%|██▌       | 5/20 [01:54<05:10, 20.73s/it]                 
Task 2, Epoch 6/20 => Loss 0.031, Train_accy 91.32:  30%|███       | 6/20 [01:54<04:34, 19.63s/it]
Task 2, Epoch 7/20 => Loss 0.037, Train_accy 91.64:  30%|███       | 6/20 [02:11<04:34, 19.63s/it]
Task 2, Epoch 7/20 => Loss 0.037, Train_accy 91.64:  35%|███▌      | 7/20 [02:11<04:06, 18.95s/it]
Task 2, Epoch 8/20 => Loss -0.025, Train_accy 93.19:  35%|███▌      | 7/20 [02:29<04:06, 18.95s/it]
Task 2, Epoch 8/20 => Loss -0.025, Train_accy 93.19:  40%|████      | 8/20 [02:29<03:41, 18.50s/it]
Task 2, Epoch 9/20 => Loss -0.064, Train_accy 94.64:  40%|████      | 8/20 [02:46<03:41, 18.50s/it]
Task 2, Epoch 9/20 => Loss -0.064, Train_accy 94.64:  45%|████▌     | 9/20 [02:46<03:20, 18.22s/it]
Task 2, Epoch 10/20 => Loss -0.010, Train_accy 92.93, Test_accy 76.48:  45%|████▌     | 9/20 [03:13<03:20, 18.22s/it]
Task 2, Epoch 10/20 => Loss -0.010, Train_accy 92.93, Test_accy 76.48:  50%|█████     | 10/20 [03:13<03:27, 20.78s/it]
Task 2, Epoch 11/20 => Loss -0.003, Train_accy 92.87:  50%|█████     | 10/20 [03:30<03:27, 20.78s/it]                 
Task 2, Epoch 11/20 => Loss -0.003, Train_accy 92.87:  55%|█████▌    | 11/20 [03:30<02:58, 19.81s/it]
Task 2, Epoch 12/20 => Loss -0.018, Train_accy 93.03:  55%|█████▌    | 11/20 [03:48<02:58, 19.81s/it]
Task 2, Epoch 12/20 => Loss -0.018, Train_accy 93.03:  60%|██████    | 12/20 [03:48<02:33, 19.13s/it]
Task 2, Epoch 13/20 => Loss -0.023, Train_accy 93.41:  60%|██████    | 12/20 [04:05<02:33, 19.13s/it]
Task 2, Epoch 13/20 => Loss -0.023, Train_accy 93.41:  65%|██████▌   | 13/20 [04:05<02:10, 18.63s/it]
Task 2, Epoch 14/20 => Loss -0.029, Train_accy 93.84:  65%|██████▌   | 13/20 [04:23<02:10, 18.63s/it]
Task 2, Epoch 14/20 => Loss -0.029, Train_accy 93.84:  70%|███████   | 14/20 [04:23<01:49, 18.30s/it]
Task 2, Epoch 15/20 => Loss -0.024, Train_accy 92.98, Test_accy 79.66:  70%|███████   | 14/20 [04:49<01:49, 18.30s/it]
Task 2, Epoch 15/20 => Loss -0.024, Train_accy 92.98, Test_accy 79.66:  75%|███████▌  | 15/20 [04:49<01:43, 20.78s/it]
Task 2, Epoch 16/20 => Loss -0.058, Train_accy 94.21:  75%|███████▌  | 15/20 [05:07<01:43, 20.78s/it]                 
Task 2, Epoch 16/20 => Loss -0.058, Train_accy 94.21:  80%|████████  | 16/20 [05:07<01:19, 19.81s/it]
Task 2, Epoch 17/20 => Loss -0.078, Train_accy 95.12:  80%|████████  | 16/20 [05:25<01:19, 19.81s/it]
Task 2, Epoch 17/20 => Loss -0.078, Train_accy 95.12:  85%|████████▌ | 17/20 [05:25<00:57, 19.12s/it]
Task 2, Epoch 18/20 => Loss -0.070, Train_accy 94.48:  85%|████████▌ | 17/20 [05:42<00:57, 19.12s/it]
Task 2, Epoch 18/20 => Loss -0.070, Train_accy 94.48:  90%|█████████ | 18/20 [05:42<00:37, 18.72s/it]
Task 2, Epoch 19/20 => Loss -0.042, Train_accy 93.78:  90%|█████████ | 18/20 [06:00<00:37, 18.72s/it]
Task 2, Epoch 19/20 => Loss -0.042, Train_accy 93.78:  95%|█████████▌| 19/20 [06:00<00:18, 18.38s/it]
Task 2, Epoch 20/20 => Loss -0.033, Train_accy 93.35, Test_accy 81.36:  95%|█████████▌| 19/20 [06:26<00:18, 18.38s/it]
Task 2, Epoch 20/20 => Loss -0.033, Train_accy 93.35, Test_accy 81.36: 100%|██████████| 20/20 [06:26<00:00, 20.83s/it]
Task 2, Epoch 20/20 => Loss -0.033, Train_accy 93.35, Test_accy 81.36: 100%|██████████| 20/20 [06:26<00:00, 19.35s/it]
2024-09-05 20:44:32,668 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.033, Train_accy 93.35, Test_accy 81.36
2024-09-05 20:44:41,560 [trainer.py] => No NME accuracy.
2024-09-05 20:44:41,561 [trainer.py] => CNN: {'total': 81.36, '00-39': 79.52, '40-79': 86.88, '80-119': 77.87, 'old': 83.24, 'new': 77.87}
2024-09-05 20:44:41,561 [trainer.py] => CNN top1 curve: [95.37, 84.55, 81.36]
2024-09-05 20:44:41,561 [trainer.py] => CNN top5 curve: [99.34, 98.8, 98.8]

Average Accuracy (CNN): 87.09
2024-09-05 20:44:41,561 [trainer.py] => Average Accuracy (CNN): 87.09 

2024-09-05 20:44:41,563 [trainer.py] => All params: 171970192
2024-09-05 20:44:41,565 [trainer.py] => Trainable params: 199880
2024-09-05 20:44:41,565 [l2p.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.850, Train_accy 70.54:   0%|          | 0/20 [00:17<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.850, Train_accy 70.54:   5%|▌         | 1/20 [00:17<05:35, 17.64s/it]
Task 3, Epoch 2/20 => Loss 0.194, Train_accy 85.43:   5%|▌         | 1/20 [00:35<05:35, 17.64s/it]
Task 3, Epoch 2/20 => Loss 0.194, Train_accy 85.43:  10%|█         | 2/20 [00:35<05:16, 17.61s/it]
Task 3, Epoch 3/20 => Loss 0.109, Train_accy 87.94:  10%|█         | 2/20 [00:52<05:16, 17.61s/it]
Task 3, Epoch 3/20 => Loss 0.109, Train_accy 87.94:  15%|█▌        | 3/20 [00:52<04:59, 17.62s/it]
Task 3, Epoch 4/20 => Loss 0.062, Train_accy 89.43:  15%|█▌        | 3/20 [01:10<04:59, 17.62s/it]
Task 3, Epoch 4/20 => Loss 0.062, Train_accy 89.43:  20%|██        | 4/20 [01:10<04:41, 17.61s/it]
Task 3, Epoch 5/20 => Loss 0.074, Train_accy 89.70, Test_accy 74.51:  20%|██        | 4/20 [01:39<04:41, 17.61s/it]
Task 3, Epoch 5/20 => Loss 0.074, Train_accy 89.70, Test_accy 74.51:  25%|██▌       | 5/20 [01:39<05:27, 21.85s/it]
Task 3, Epoch 6/20 => Loss 0.060, Train_accy 90.39:  25%|██▌       | 5/20 [01:57<05:27, 21.85s/it]                 
Task 3, Epoch 6/20 => Loss 0.060, Train_accy 90.39:  30%|███       | 6/20 [01:57<04:45, 20.41s/it]
Task 3, Epoch 7/20 => Loss 0.054, Train_accy 92.21:  30%|███       | 6/20 [02:15<04:45, 20.41s/it]
Task 3, Epoch 7/20 => Loss 0.054, Train_accy 92.21:  35%|███▌      | 7/20 [02:15<04:13, 19.49s/it]
Task 3, Epoch 8/20 => Loss 0.008, Train_accy 92.10:  35%|███▌      | 7/20 [02:32<04:13, 19.49s/it]
Task 3, Epoch 8/20 => Loss 0.008, Train_accy 92.10:  40%|████      | 8/20 [02:32<03:46, 18.89s/it]
Task 3, Epoch 9/20 => Loss 0.020, Train_accy 91.73:  40%|████      | 8/20 [02:50<03:46, 18.89s/it]
Task 3, Epoch 9/20 => Loss 0.020, Train_accy 91.73:  45%|████▌     | 9/20 [02:50<03:23, 18.48s/it]
Task 3, Epoch 10/20 => Loss 0.000, Train_accy 92.16, Test_accy 78.05:  45%|████▌     | 9/20 [03:19<03:23, 18.48s/it]
Task 3, Epoch 10/20 => Loss 0.000, Train_accy 92.16, Test_accy 78.05:  50%|█████     | 10/20 [03:19<03:38, 21.80s/it]
Task 3, Epoch 11/20 => Loss -0.002, Train_accy 92.48:  50%|█████     | 10/20 [03:37<03:38, 21.80s/it]                
Task 3, Epoch 11/20 => Loss -0.002, Train_accy 92.48:  55%|█████▌    | 11/20 [03:37<03:04, 20.54s/it]
Task 3, Epoch 12/20 => Loss -0.037, Train_accy 93.70:  55%|█████▌    | 11/20 [03:54<03:04, 20.54s/it]
Task 3, Epoch 12/20 => Loss -0.037, Train_accy 93.70:  60%|██████    | 12/20 [03:54<02:37, 19.63s/it]
Task 3, Epoch 13/20 => Loss -0.048, Train_accy 92.74:  60%|██████    | 12/20 [04:12<02:37, 19.63s/it]
Task 3, Epoch 13/20 => Loss -0.048, Train_accy 92.74:  65%|██████▌   | 13/20 [04:12<02:13, 19.02s/it]
Task 3, Epoch 14/20 => Loss 0.040, Train_accy 92.48:  65%|██████▌   | 13/20 [04:29<02:13, 19.02s/it] 
Task 3, Epoch 14/20 => Loss 0.040, Train_accy 92.48:  70%|███████   | 14/20 [04:29<01:51, 18.58s/it]
Task 3, Epoch 15/20 => Loss 0.010, Train_accy 92.69, Test_accy 78.16:  70%|███████   | 14/20 [04:59<01:51, 18.58s/it]
Task 3, Epoch 15/20 => Loss 0.010, Train_accy 92.69, Test_accy 78.16:  75%|███████▌  | 15/20 [04:59<01:49, 21.83s/it]
Task 3, Epoch 16/20 => Loss 0.013, Train_accy 92.42:  75%|███████▌  | 15/20 [05:16<01:49, 21.83s/it]                 
Task 3, Epoch 16/20 => Loss 0.013, Train_accy 92.42:  80%|████████  | 16/20 [05:16<01:22, 20.56s/it]
Task 3, Epoch 17/20 => Loss -0.012, Train_accy 93.60:  80%|████████  | 16/20 [05:34<01:22, 20.56s/it]
Task 3, Epoch 17/20 => Loss -0.012, Train_accy 93.60:  85%|████████▌ | 17/20 [05:34<00:59, 19.67s/it]
Task 3, Epoch 18/20 => Loss -0.025, Train_accy 93.44:  85%|████████▌ | 17/20 [05:52<00:59, 19.67s/it]
Task 3, Epoch 18/20 => Loss -0.025, Train_accy 93.44:  90%|█████████ | 18/20 [05:52<00:38, 19.05s/it]
Task 3, Epoch 19/20 => Loss 0.024, Train_accy 93.12:  90%|█████████ | 18/20 [06:09<00:38, 19.05s/it] 
Task 3, Epoch 19/20 => Loss 0.024, Train_accy 93.12:  95%|█████████▌| 19/20 [06:09<00:18, 18.64s/it]
Task 3, Epoch 20/20 => Loss -0.020, Train_accy 93.06, Test_accy 79.06:  95%|█████████▌| 19/20 [06:39<00:18, 18.64s/it]
Task 3, Epoch 20/20 => Loss -0.020, Train_accy 93.06, Test_accy 79.06: 100%|██████████| 20/20 [06:39<00:00, 21.84s/it]
Task 3, Epoch 20/20 => Loss -0.020, Train_accy 93.06, Test_accy 79.06: 100%|██████████| 20/20 [06:39<00:00, 19.95s/it]
2024-09-05 20:51:20,622 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.020, Train_accy 93.06, Test_accy 79.06
2024-09-05 20:51:32,324 [trainer.py] => No NME accuracy.
2024-09-05 20:51:32,325 [trainer.py] => CNN: {'total': 79.06, '00-39': 73.79, '40-79': 85.81, '80-119': 78.07, '120-159': 78.53, 'old': 79.24, 'new': 78.53}
2024-09-05 20:51:32,325 [trainer.py] => CNN top1 curve: [95.37, 84.55, 81.36, 79.06]
2024-09-05 20:51:32,325 [trainer.py] => CNN top5 curve: [99.34, 98.8, 98.8, 98.47]

Average Accuracy (CNN): 85.08
2024-09-05 20:51:32,326 [trainer.py] => Average Accuracy (CNN): 85.08 

2024-09-05 20:51:32,328 [trainer.py] => All params: 171970192
2024-09-05 20:51:32,330 [trainer.py] => Trainable params: 199880
2024-09-05 20:51:32,331 [l2p.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.712, Train_accy 75.65:   0%|          | 0/20 [00:17<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.712, Train_accy 75.65:   5%|▌         | 1/20 [00:17<05:41, 17.96s/it]
Task 4, Epoch 2/20 => Loss 0.112, Train_accy 88.80:   5%|▌         | 1/20 [00:35<05:41, 17.96s/it]
Task 4, Epoch 2/20 => Loss 0.112, Train_accy 88.80:  10%|█         | 2/20 [00:35<05:23, 17.95s/it]
Task 4, Epoch 3/20 => Loss 0.063, Train_accy 90.89:  10%|█         | 2/20 [00:53<05:23, 17.95s/it]
Task 4, Epoch 3/20 => Loss 0.063, Train_accy 90.89:  15%|█▌        | 3/20 [00:53<05:05, 17.96s/it]
Task 4, Epoch 4/20 => Loss 0.049, Train_accy 91.47:  15%|█▌        | 3/20 [01:11<05:05, 17.96s/it]
Task 4, Epoch 4/20 => Loss 0.049, Train_accy 91.47:  20%|██        | 4/20 [01:11<04:47, 17.94s/it]
Task 4, Epoch 5/20 => Loss 0.015, Train_accy 92.09, Test_accy 74.00:  20%|██        | 4/20 [01:44<04:47, 17.94s/it]
Task 4, Epoch 5/20 => Loss 0.015, Train_accy 92.09, Test_accy 74.00:  25%|██▌       | 5/20 [01:44<05:47, 23.18s/it]
Task 4, Epoch 6/20 => Loss -0.001, Train_accy 92.36:  25%|██▌       | 5/20 [02:02<05:47, 23.18s/it]                
Task 4, Epoch 6/20 => Loss -0.001, Train_accy 92.36:  30%|███       | 6/20 [02:02<04:59, 21.42s/it]
Task 4, Epoch 7/20 => Loss 0.007, Train_accy 93.14:  30%|███       | 6/20 [02:20<04:59, 21.42s/it] 
Task 4, Epoch 7/20 => Loss 0.007, Train_accy 93.14:  35%|███▌      | 7/20 [02:20<04:23, 20.28s/it]
Task 4, Epoch 8/20 => Loss -0.031, Train_accy 93.56:  35%|███▌      | 7/20 [02:38<04:23, 20.28s/it]
Task 4, Epoch 8/20 => Loss -0.031, Train_accy 93.56:  40%|████      | 8/20 [02:38<03:54, 19.56s/it]
Task 4, Epoch 9/20 => Loss -0.041, Train_accy 93.66:  40%|████      | 8/20 [02:56<03:54, 19.56s/it]
Task 4, Epoch 9/20 => Loss -0.041, Train_accy 93.66:  45%|████▌     | 9/20 [02:56<03:29, 19.07s/it]
Task 4, Epoch 10/20 => Loss -0.018, Train_accy 93.19, Test_accy 76.51:  45%|████▌     | 9/20 [03:28<03:29, 19.07s/it]
Task 4, Epoch 10/20 => Loss -0.018, Train_accy 93.19, Test_accy 76.51:  50%|█████     | 10/20 [03:28<03:51, 23.20s/it]
Task 4, Epoch 11/20 => Loss -0.061, Train_accy 94.35:  50%|█████     | 10/20 [03:46<03:51, 23.20s/it]                 
Task 4, Epoch 11/20 => Loss -0.061, Train_accy 94.35:  55%|█████▌    | 11/20 [03:46<03:14, 21.60s/it]
Task 4, Epoch 12/20 => Loss -0.027, Train_accy 93.19:  55%|█████▌    | 11/20 [04:04<03:14, 21.60s/it]
Task 4, Epoch 12/20 => Loss -0.027, Train_accy 93.19:  60%|██████    | 12/20 [04:04<02:43, 20.48s/it]
Task 4, Epoch 13/20 => Loss -0.038, Train_accy 93.19:  60%|██████    | 12/20 [04:22<02:43, 20.48s/it]
Task 4, Epoch 13/20 => Loss -0.038, Train_accy 93.19:  65%|██████▌   | 13/20 [04:22<02:17, 19.71s/it]
Task 4, Epoch 14/20 => Loss -0.076, Train_accy 94.82:  65%|██████▌   | 13/20 [04:40<02:17, 19.71s/it]
Task 4, Epoch 14/20 => Loss -0.076, Train_accy 94.82:  70%|███████   | 14/20 [04:40<01:55, 19.17s/it]
Task 4, Epoch 15/20 => Loss -0.021, Train_accy 93.19, Test_accy 77.86:  70%|███████   | 14/20 [05:12<01:55, 19.17s/it]
Task 4, Epoch 15/20 => Loss -0.021, Train_accy 93.19, Test_accy 77.86:  75%|███████▌  | 15/20 [05:12<01:55, 23.16s/it]
Task 4, Epoch 16/20 => Loss -0.044, Train_accy 93.19:  75%|███████▌  | 15/20 [05:30<01:55, 23.16s/it]                 
Task 4, Epoch 16/20 => Loss -0.044, Train_accy 93.19:  80%|████████  | 16/20 [05:30<01:26, 21.59s/it]
Task 4, Epoch 17/20 => Loss -0.062, Train_accy 94.40:  80%|████████  | 16/20 [05:48<01:26, 21.59s/it]
Task 4, Epoch 17/20 => Loss -0.062, Train_accy 94.40:  85%|████████▌ | 17/20 [05:48<01:01, 20.50s/it]
Task 4, Epoch 18/20 => Loss -0.065, Train_accy 94.24:  85%|████████▌ | 17/20 [06:06<01:01, 20.50s/it]
Task 4, Epoch 18/20 => Loss -0.065, Train_accy 94.24:  90%|█████████ | 18/20 [06:06<00:39, 19.72s/it]
Task 4, Epoch 19/20 => Loss -0.070, Train_accy 93.93:  90%|█████████ | 18/20 [06:24<00:39, 19.72s/it]
Task 4, Epoch 19/20 => Loss -0.070, Train_accy 93.93:  95%|█████████▌| 19/20 [06:24<00:19, 19.19s/it]
Task 4, Epoch 20/20 => Loss -0.062, Train_accy 94.29, Test_accy 78.63:  95%|█████████▌| 19/20 [06:57<00:19, 19.19s/it]
Task 4, Epoch 20/20 => Loss -0.062, Train_accy 94.29, Test_accy 78.63: 100%|██████████| 20/20 [06:57<00:00, 23.17s/it]
Task 4, Epoch 20/20 => Loss -0.062, Train_accy 94.29, Test_accy 78.63: 100%|██████████| 20/20 [06:57<00:00, 20.85s/it]
2024-09-05 20:58:29,373 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.062, Train_accy 94.29, Test_accy 78.63
2024-09-05 20:58:43,897 [trainer.py] => No NME accuracy.
2024-09-05 20:58:43,897 [trainer.py] => CNN: {'total': 78.63, '00-39': 71.37, '40-79': 84.52, '80-119': 75.65, '120-159': 78.53, '160-199': 83.08, 'old': 77.53, 'new': 83.08}
2024-09-05 20:58:43,897 [trainer.py] => CNN top1 curve: [95.37, 84.55, 81.36, 79.06, 78.63]
2024-09-05 20:58:43,898 [trainer.py] => CNN top5 curve: [99.34, 98.8, 98.8, 98.47, 97.54]

Average Accuracy (CNN): 83.79
2024-09-05 20:58:43,898 [trainer.py] => Average Accuracy (CNN): 83.79 

Accuracy Matrix (CNN):
[[95.37 81.28 79.52 73.79 71.37]
 [ 0.   87.74 86.88 85.81 84.52]
 [ 0.    0.   77.87 78.07 75.65]
 [ 0.    0.    0.   78.53 78.53]
 [ 0.    0.    0.    0.   83.08]]
2024-09-05 20:58:43,900 [trainer.py] => Forgetting (CNN): 7.409999999999997
2024-09-05 20:58:46,680 [trainer.py] => config: ./exps/l2p_cub_B0_Inc10.json
2024-09-05 20:58:46,702 [trainer.py] => prefix:  
2024-09-05 20:58:46,702 [trainer.py] => dataset: cub
2024-09-05 20:58:46,702 [trainer.py] => memory_size: 0
2024-09-05 20:58:46,702 [trainer.py] => memory_per_class: 0
2024-09-05 20:58:46,702 [trainer.py] => fixed_memory: False
2024-09-05 20:58:46,702 [trainer.py] => shuffle: True
2024-09-05 20:58:46,702 [trainer.py] => init_cls: 20
2024-09-05 20:58:46,702 [trainer.py] => increment: 20
2024-09-05 20:58:46,702 [trainer.py] => model_name: l2p
2024-09-05 20:58:46,702 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-05 20:58:46,702 [trainer.py] => get_original_backbone: True
2024-09-05 20:58:46,702 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 20:58:46,702 [trainer.py] => seed: 1993
2024-09-05 20:58:46,702 [trainer.py] => tuned_epoch: 20
2024-09-05 20:58:46,702 [trainer.py] => init_lr: 0.001875
2024-09-05 20:58:46,702 [trainer.py] => batch_size: 48
2024-09-05 20:58:46,702 [trainer.py] => weight_decay: 0
2024-09-05 20:58:46,702 [trainer.py] => min_lr: 1e-05
2024-09-05 20:58:46,702 [trainer.py] => optimizer: adam
2024-09-05 20:58:46,702 [trainer.py] => scheduler: constant
2024-09-05 20:58:46,702 [trainer.py] => reinit_optimizer: True
2024-09-05 20:58:46,703 [trainer.py] => global_pool: token
2024-09-05 20:58:46,703 [trainer.py] => head_type: prompt
2024-09-05 20:58:46,703 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-05 20:58:46,703 [trainer.py] => pretrained: True
2024-09-05 20:58:46,703 [trainer.py] => drop: 0.0
2024-09-05 20:58:46,703 [trainer.py] => drop_path: 0.0
2024-09-05 20:58:46,703 [trainer.py] => prompt_pool: True
2024-09-05 20:58:46,703 [trainer.py] => size: 10
2024-09-05 20:58:46,703 [trainer.py] => length: 5
2024-09-05 20:58:46,703 [trainer.py] => top_k: 5
2024-09-05 20:58:46,703 [trainer.py] => initializer: uniform
2024-09-05 20:58:46,703 [trainer.py] => prompt_key: True
2024-09-05 20:58:46,703 [trainer.py] => prompt_key_init: uniform
2024-09-05 20:58:46,703 [trainer.py] => use_prompt_mask: False
2024-09-05 20:58:46,703 [trainer.py] => shared_prompt_pool: False
2024-09-05 20:58:46,703 [trainer.py] => shared_prompt_key: False
2024-09-05 20:58:46,703 [trainer.py] => batchwise_prompt: True
2024-09-05 20:58:46,703 [trainer.py] => embedding_key: cls
2024-09-05 20:58:46,703 [trainer.py] => predefined_key: 
2024-09-05 20:58:46,703 [trainer.py] => pull_constraint: True
2024-09-05 20:58:46,703 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-05 20:58:46,744 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 20:58:48,145 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-05 20:58:48,145 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-05 20:58:49,925 [l2p.py] => 86,017,736 model total parameters.
2024-09-05 20:58:49,926 [l2p.py] => 199,880 model training parameters.
2024-09-05 20:58:49,926 [l2p.py] => prompt.prompt: 38400
2024-09-05 20:58:49,926 [l2p.py] => prompt.prompt_key: 7680
2024-09-05 20:58:49,926 [l2p.py] => head.weight: 153600
2024-09-05 20:58:49,926 [l2p.py] => head.bias: 200
2024-09-05 20:58:49,927 [trainer.py] => All params: 171970192
2024-09-05 20:58:49,928 [trainer.py] => Trainable params: 199880
2024-09-05 20:58:49,928 [l2p.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.380, Train_accy 57.72:   0%|          | 0/20 [00:09<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.380, Train_accy 57.72:   5%|▌         | 1/20 [00:09<02:58,  9.39s/it]
Task 0, Epoch 2/20 => Loss 0.411, Train_accy 87.74:   5%|▌         | 1/20 [00:18<02:58,  9.39s/it]
Task 0, Epoch 2/20 => Loss 0.411, Train_accy 87.74:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]
Task 0, Epoch 3/20 => Loss 0.310, Train_accy 89.85:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]
Task 0, Epoch 3/20 => Loss 0.310, Train_accy 89.85:  15%|█▌        | 3/20 [00:27<02:34,  9.09s/it]
Task 0, Epoch 4/20 => Loss 0.297, Train_accy 89.85:  15%|█▌        | 3/20 [00:36<02:34,  9.09s/it]
Task 0, Epoch 4/20 => Loss 0.297, Train_accy 89.85:  20%|██        | 4/20 [00:36<02:25,  9.06s/it]
Task 0, Epoch 5/20 => Loss 0.253, Train_accy 89.85, Test_accy 98.38:  20%|██        | 4/20 [00:47<02:25,  9.06s/it]
Task 0, Epoch 5/20 => Loss 0.253, Train_accy 89.85, Test_accy 98.38:  25%|██▌       | 5/20 [00:47<02:26,  9.77s/it]
Task 0, Epoch 6/20 => Loss 0.203, Train_accy 91.75:  25%|██▌       | 5/20 [00:56<02:26,  9.77s/it]                 
Task 0, Epoch 6/20 => Loss 0.203, Train_accy 91.75:  30%|███       | 6/20 [00:56<02:13,  9.51s/it]
Task 0, Epoch 7/20 => Loss 0.201, Train_accy 91.97:  30%|███       | 6/20 [01:05<02:13,  9.51s/it]
Task 0, Epoch 7/20 => Loss 0.201, Train_accy 91.97:  35%|███▌      | 7/20 [01:05<02:01,  9.36s/it]
Task 0, Epoch 8/20 => Loss 0.177, Train_accy 91.86:  35%|███▌      | 7/20 [01:14<02:01,  9.36s/it]
Task 0, Epoch 8/20 => Loss 0.177, Train_accy 91.86:  40%|████      | 8/20 [01:14<01:51,  9.27s/it]
Task 0, Epoch 9/20 => Loss 0.119, Train_accy 94.19:  40%|████      | 8/20 [01:23<01:51,  9.27s/it]
Task 0, Epoch 9/20 => Loss 0.119, Train_accy 94.19:  45%|████▌     | 9/20 [01:23<01:41,  9.22s/it]
Task 0, Epoch 10/20 => Loss 0.149, Train_accy 92.49, Test_accy 99.19:  45%|████▌     | 9/20 [01:34<01:41,  9.22s/it]
Task 0, Epoch 10/20 => Loss 0.149, Train_accy 92.49, Test_accy 99.19:  50%|█████     | 10/20 [01:34<01:37,  9.78s/it]
Task 0, Epoch 11/20 => Loss 0.118, Train_accy 93.02:  50%|█████     | 10/20 [01:43<01:37,  9.78s/it]                 
Task 0, Epoch 11/20 => Loss 0.118, Train_accy 93.02:  55%|█████▌    | 11/20 [01:43<01:25,  9.54s/it]
Task 0, Epoch 12/20 => Loss 0.114, Train_accy 93.66:  55%|█████▌    | 11/20 [01:52<01:25,  9.54s/it]
Task 0, Epoch 12/20 => Loss 0.114, Train_accy 93.66:  60%|██████    | 12/20 [01:52<01:15,  9.41s/it]
Task 0, Epoch 13/20 => Loss 0.068, Train_accy 94.19:  60%|██████    | 12/20 [02:01<01:15,  9.41s/it]
Task 0, Epoch 13/20 => Loss 0.068, Train_accy 94.19:  65%|██████▌   | 13/20 [02:01<01:05,  9.30s/it]
Task 0, Epoch 14/20 => Loss 0.076, Train_accy 94.40:  65%|██████▌   | 13/20 [02:10<01:05,  9.30s/it]
Task 0, Epoch 14/20 => Loss 0.076, Train_accy 94.40:  70%|███████   | 14/20 [02:10<00:55,  9.23s/it]
Task 0, Epoch 15/20 => Loss 0.100, Train_accy 92.49, Test_accy 97.98:  70%|███████   | 14/20 [02:21<00:55,  9.23s/it]
Task 0, Epoch 15/20 => Loss 0.100, Train_accy 92.49, Test_accy 97.98:  75%|███████▌  | 15/20 [02:21<00:48,  9.78s/it]
Task 0, Epoch 16/20 => Loss 0.078, Train_accy 92.92:  75%|███████▌  | 15/20 [02:31<00:48,  9.78s/it]                 
Task 0, Epoch 16/20 => Loss 0.078, Train_accy 92.92:  80%|████████  | 16/20 [02:31<00:38,  9.56s/it]
Task 0, Epoch 17/20 => Loss 0.000, Train_accy 94.93:  80%|████████  | 16/20 [02:40<00:38,  9.56s/it]
Task 0, Epoch 17/20 => Loss 0.000, Train_accy 94.93:  85%|████████▌ | 17/20 [02:40<00:28,  9.41s/it]
Task 0, Epoch 18/20 => Loss 0.014, Train_accy 94.19:  85%|████████▌ | 17/20 [02:49<00:28,  9.41s/it]
Task 0, Epoch 18/20 => Loss 0.014, Train_accy 94.19:  90%|█████████ | 18/20 [02:49<00:18,  9.31s/it]
Task 0, Epoch 19/20 => Loss 0.036, Train_accy 94.08:  90%|█████████ | 18/20 [02:58<00:18,  9.31s/it]
Task 0, Epoch 19/20 => Loss 0.036, Train_accy 94.08:  95%|█████████▌| 19/20 [02:58<00:09,  9.24s/it]
Task 0, Epoch 20/20 => Loss 0.012, Train_accy 94.29, Test_accy 97.57:  95%|█████████▌| 19/20 [03:09<00:09,  9.24s/it]
Task 0, Epoch 20/20 => Loss 0.012, Train_accy 94.29, Test_accy 97.57: 100%|██████████| 20/20 [03:09<00:00,  9.77s/it]
Task 0, Epoch 20/20 => Loss 0.012, Train_accy 94.29, Test_accy 97.57: 100%|██████████| 20/20 [03:09<00:00,  9.46s/it]
2024-09-05 21:01:59,753 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.012, Train_accy 94.29, Test_accy 97.57
2024-09-05 21:02:01,677 [trainer.py] => No NME accuracy.
2024-09-05 21:02:01,677 [trainer.py] => CNN: {'total': 97.57, '00-19': 97.57, 'old': 0, 'new': 97.57}
2024-09-05 21:02:01,677 [trainer.py] => CNN top1 curve: [97.57]
2024-09-05 21:02:01,678 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.57
2024-09-05 21:02:01,678 [trainer.py] => Average Accuracy (CNN): 97.57 

2024-09-05 21:02:01,681 [trainer.py] => All params: 171970192
2024-09-05 21:02:01,683 [trainer.py] => Trainable params: 199880
2024-09-05 21:02:01,684 [l2p.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.952, Train_accy 67.83:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.952, Train_accy 67.83:   5%|▌         | 1/20 [00:09<02:51,  9.03s/it]
Task 1, Epoch 2/20 => Loss 0.193, Train_accy 88.78:   5%|▌         | 1/20 [00:18<02:51,  9.03s/it]
Task 1, Epoch 2/20 => Loss 0.193, Train_accy 88.78:  10%|█         | 2/20 [00:18<02:42,  9.04s/it]
Task 1, Epoch 3/20 => Loss 0.069, Train_accy 92.38:  10%|█         | 2/20 [00:27<02:42,  9.04s/it]
Task 1, Epoch 3/20 => Loss 0.069, Train_accy 92.38:  15%|█▌        | 3/20 [00:27<02:33,  9.04s/it]
Task 1, Epoch 4/20 => Loss 0.030, Train_accy 93.02:  15%|█▌        | 3/20 [00:36<02:33,  9.04s/it]
Task 1, Epoch 4/20 => Loss 0.030, Train_accy 93.02:  20%|██        | 4/20 [00:36<02:24,  9.03s/it]
Task 1, Epoch 5/20 => Loss 0.051, Train_accy 92.38, Test_accy 85.46:  20%|██        | 4/20 [00:48<02:24,  9.03s/it]
Task 1, Epoch 5/20 => Loss 0.051, Train_accy 92.38, Test_accy 85.46:  25%|██▌       | 5/20 [00:48<02:33, 10.22s/it]
Task 1, Epoch 6/20 => Loss 0.041, Train_accy 93.23:  25%|██▌       | 5/20 [00:57<02:33, 10.22s/it]                 
Task 1, Epoch 6/20 => Loss 0.041, Train_accy 93.23:  30%|███       | 6/20 [00:57<02:17,  9.80s/it]
Task 1, Epoch 7/20 => Loss -0.023, Train_accy 93.65:  30%|███       | 6/20 [01:06<02:17,  9.80s/it]
Task 1, Epoch 7/20 => Loss -0.023, Train_accy 93.65:  35%|███▌      | 7/20 [01:06<02:04,  9.57s/it]
Task 1, Epoch 8/20 => Loss -0.020, Train_accy 93.86:  35%|███▌      | 7/20 [01:15<02:04,  9.57s/it]
Task 1, Epoch 8/20 => Loss -0.020, Train_accy 93.86:  40%|████      | 8/20 [01:15<01:52,  9.40s/it]
Task 1, Epoch 9/20 => Loss -0.015, Train_accy 93.65:  40%|████      | 8/20 [01:24<01:52,  9.40s/it]
Task 1, Epoch 9/20 => Loss -0.015, Train_accy 93.65:  45%|████▌     | 9/20 [01:24<01:42,  9.30s/it]
Task 1, Epoch 10/20 => Loss -0.077, Train_accy 95.45, Test_accy 87.44:  45%|████▌     | 9/20 [01:36<01:42,  9.30s/it]
Task 1, Epoch 10/20 => Loss -0.077, Train_accy 95.45, Test_accy 87.44:  50%|█████     | 10/20 [01:36<01:42, 10.20s/it]
Task 1, Epoch 11/20 => Loss -0.064, Train_accy 95.34:  50%|█████     | 10/20 [01:46<01:42, 10.20s/it]                 
Task 1, Epoch 11/20 => Loss -0.064, Train_accy 95.34:  55%|█████▌    | 11/20 [01:46<01:28,  9.88s/it]
Task 1, Epoch 12/20 => Loss -0.033, Train_accy 93.76:  55%|█████▌    | 11/20 [01:55<01:28,  9.88s/it]
Task 1, Epoch 12/20 => Loss -0.033, Train_accy 93.76:  60%|██████    | 12/20 [01:55<01:16,  9.62s/it]
Task 1, Epoch 13/20 => Loss -0.061, Train_accy 95.45:  60%|██████    | 12/20 [02:04<01:16,  9.62s/it]
Task 1, Epoch 13/20 => Loss -0.061, Train_accy 95.45:  65%|██████▌   | 13/20 [02:04<01:06,  9.46s/it]
Task 1, Epoch 14/20 => Loss -0.070, Train_accy 95.66:  65%|██████▌   | 13/20 [02:13<01:06,  9.46s/it]
Task 1, Epoch 14/20 => Loss -0.070, Train_accy 95.66:  70%|███████   | 14/20 [02:13<00:56,  9.34s/it]
Task 1, Epoch 15/20 => Loss -0.081, Train_accy 95.56, Test_accy 89.21:  70%|███████   | 14/20 [02:25<00:56,  9.34s/it]
Task 1, Epoch 15/20 => Loss -0.081, Train_accy 95.56, Test_accy 89.21:  75%|███████▌  | 15/20 [02:25<00:51, 10.20s/it]
Task 1, Epoch 16/20 => Loss -0.089, Train_accy 95.24:  75%|███████▌  | 15/20 [02:34<00:51, 10.20s/it]                 
Task 1, Epoch 16/20 => Loss -0.089, Train_accy 95.24:  80%|████████  | 16/20 [02:34<00:39,  9.86s/it]
Task 1, Epoch 17/20 => Loss -0.085, Train_accy 94.71:  80%|████████  | 16/20 [02:43<00:39,  9.86s/it]
Task 1, Epoch 17/20 => Loss -0.085, Train_accy 94.71:  85%|████████▌ | 17/20 [02:43<00:28,  9.62s/it]
Task 1, Epoch 18/20 => Loss -0.044, Train_accy 93.12:  85%|████████▌ | 17/20 [02:52<00:28,  9.62s/it]
Task 1, Epoch 18/20 => Loss -0.044, Train_accy 93.12:  90%|█████████ | 18/20 [02:52<00:18,  9.46s/it]
Task 1, Epoch 19/20 => Loss -0.058, Train_accy 94.71:  90%|█████████ | 18/20 [03:01<00:18,  9.46s/it]
Task 1, Epoch 19/20 => Loss -0.058, Train_accy 94.71:  95%|█████████▌| 19/20 [03:01<00:09,  9.34s/it]
Task 1, Epoch 20/20 => Loss -0.032, Train_accy 94.07, Test_accy 89.43:  95%|█████████▌| 19/20 [03:13<00:09,  9.34s/it]
Task 1, Epoch 20/20 => Loss -0.032, Train_accy 94.07, Test_accy 89.43: 100%|██████████| 20/20 [03:13<00:00, 10.23s/it]
Task 1, Epoch 20/20 => Loss -0.032, Train_accy 94.07, Test_accy 89.43: 100%|██████████| 20/20 [03:13<00:00,  9.70s/it]
2024-09-05 21:05:15,682 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.032, Train_accy 94.07, Test_accy 89.43
2024-09-05 21:05:18,843 [trainer.py] => No NME accuracy.
2024-09-05 21:05:18,843 [trainer.py] => CNN: {'total': 89.43, '00-19': 95.55, '20-39': 82.13, 'old': 95.55, 'new': 82.13}
2024-09-05 21:05:18,844 [trainer.py] => CNN top1 curve: [97.57, 89.43]
2024-09-05 21:05:18,844 [trainer.py] => CNN top5 curve: [100.0, 99.34]

Average Accuracy (CNN): 93.5
2024-09-05 21:05:18,844 [trainer.py] => Average Accuracy (CNN): 93.5 

2024-09-05 21:05:18,845 [trainer.py] => All params: 171970192
2024-09-05 21:05:18,846 [trainer.py] => Trainable params: 199880
2024-09-05 21:05:18,846 [l2p.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.836, Train_accy 70.31:   0%|          | 0/20 [00:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.836, Train_accy 70.31:   5%|▌         | 1/20 [00:09<02:52,  9.08s/it]
Task 2, Epoch 2/20 => Loss 0.011, Train_accy 91.83:   5%|▌         | 1/20 [00:18<02:52,  9.08s/it]
Task 2, Epoch 2/20 => Loss 0.011, Train_accy 91.83:  10%|█         | 2/20 [00:18<02:42,  9.05s/it]
Task 2, Epoch 3/20 => Loss 0.013, Train_accy 91.09:  10%|█         | 2/20 [00:27<02:42,  9.05s/it]
Task 2, Epoch 3/20 => Loss 0.013, Train_accy 91.09:  15%|█▌        | 3/20 [00:27<02:33,  9.06s/it]
Task 2, Epoch 4/20 => Loss -0.022, Train_accy 92.58:  15%|█▌        | 3/20 [00:36<02:33,  9.06s/it]
Task 2, Epoch 4/20 => Loss -0.022, Train_accy 92.58:  20%|██        | 4/20 [00:36<02:24,  9.05s/it]
Task 2, Epoch 5/20 => Loss -0.040, Train_accy 93.85, Test_accy 84.82:  20%|██        | 4/20 [00:49<02:24,  9.05s/it]
Task 2, Epoch 5/20 => Loss -0.040, Train_accy 93.85, Test_accy 84.82:  25%|██▌       | 5/20 [00:49<02:39, 10.65s/it]
Task 2, Epoch 6/20 => Loss -0.024, Train_accy 92.58:  25%|██▌       | 5/20 [00:58<02:39, 10.65s/it]                 
Task 2, Epoch 6/20 => Loss -0.024, Train_accy 92.58:  30%|███       | 6/20 [00:58<02:21, 10.10s/it]
Task 2, Epoch 7/20 => Loss -0.042, Train_accy 93.64:  30%|███       | 6/20 [01:07<02:21, 10.10s/it]
Task 2, Epoch 7/20 => Loss -0.042, Train_accy 93.64:  35%|███▌      | 7/20 [01:07<02:06,  9.76s/it]
Task 2, Epoch 8/20 => Loss -0.052, Train_accy 94.06:  35%|███▌      | 7/20 [01:16<02:06,  9.76s/it]
Task 2, Epoch 8/20 => Loss -0.052, Train_accy 94.06:  40%|████      | 8/20 [01:16<01:54,  9.53s/it]
Task 2, Epoch 9/20 => Loss -0.083, Train_accy 94.91:  40%|████      | 8/20 [01:25<01:54,  9.53s/it]
Task 2, Epoch 9/20 => Loss -0.083, Train_accy 94.91:  45%|████▌     | 9/20 [01:25<01:43,  9.38s/it]
Task 2, Epoch 10/20 => Loss -0.052, Train_accy 94.06, Test_accy 87.05:  45%|████▌     | 9/20 [01:39<01:43,  9.38s/it]
Task 2, Epoch 10/20 => Loss -0.052, Train_accy 94.06, Test_accy 87.05:  50%|█████     | 10/20 [01:39<01:46, 10.65s/it]
Task 2, Epoch 11/20 => Loss -0.035, Train_accy 93.64:  50%|█████     | 10/20 [01:48<01:46, 10.65s/it]                 
Task 2, Epoch 11/20 => Loss -0.035, Train_accy 93.64:  55%|█████▌    | 11/20 [01:48<01:31, 10.14s/it]
Task 2, Epoch 12/20 => Loss -0.069, Train_accy 94.80:  55%|█████▌    | 11/20 [01:57<01:31, 10.14s/it]
Task 2, Epoch 12/20 => Loss -0.069, Train_accy 94.80:  60%|██████    | 12/20 [01:57<01:18,  9.81s/it]
Task 2, Epoch 13/20 => Loss -0.050, Train_accy 93.96:  60%|██████    | 12/20 [02:06<01:18,  9.81s/it]
Task 2, Epoch 13/20 => Loss -0.050, Train_accy 93.96:  65%|██████▌   | 13/20 [02:06<01:07,  9.57s/it]
Task 2, Epoch 14/20 => Loss -0.112, Train_accy 95.65:  65%|██████▌   | 13/20 [02:15<01:07,  9.57s/it]
Task 2, Epoch 14/20 => Loss -0.112, Train_accy 95.65:  70%|███████   | 14/20 [02:15<00:56,  9.40s/it]
Task 2, Epoch 15/20 => Loss -0.065, Train_accy 94.17, Test_accy 87.05:  70%|███████   | 14/20 [02:28<00:56,  9.40s/it]
Task 2, Epoch 15/20 => Loss -0.065, Train_accy 94.17, Test_accy 87.05:  75%|███████▌  | 15/20 [02:28<00:53, 10.63s/it]
Task 2, Epoch 16/20 => Loss -0.118, Train_accy 95.86:  75%|███████▌  | 15/20 [02:37<00:53, 10.63s/it]                 
Task 2, Epoch 16/20 => Loss -0.118, Train_accy 95.86:  80%|████████  | 16/20 [02:37<00:40, 10.15s/it]
Task 2, Epoch 17/20 => Loss -0.107, Train_accy 95.33:  80%|████████  | 16/20 [02:47<00:40, 10.15s/it]
Task 2, Epoch 17/20 => Loss -0.107, Train_accy 95.33:  85%|████████▌ | 17/20 [02:47<00:29,  9.82s/it]
Task 2, Epoch 18/20 => Loss -0.078, Train_accy 95.23:  85%|████████▌ | 17/20 [02:56<00:29,  9.82s/it]
Task 2, Epoch 18/20 => Loss -0.078, Train_accy 95.23:  90%|█████████ | 18/20 [02:56<00:19,  9.59s/it]
Task 2, Epoch 19/20 => Loss -0.126, Train_accy 96.18:  90%|█████████ | 18/20 [03:05<00:19,  9.59s/it]
Task 2, Epoch 19/20 => Loss -0.126, Train_accy 96.18:  95%|█████████▌| 19/20 [03:05<00:09,  9.46s/it]
Task 2, Epoch 20/20 => Loss -0.092, Train_accy 95.12, Test_accy 88.69:  95%|█████████▌| 19/20 [03:18<00:09,  9.46s/it]
Task 2, Epoch 20/20 => Loss -0.092, Train_accy 95.12, Test_accy 88.69: 100%|██████████| 20/20 [03:18<00:00, 10.74s/it]
Task 2, Epoch 20/20 => Loss -0.092, Train_accy 95.12, Test_accy 88.69: 100%|██████████| 20/20 [03:18<00:00,  9.95s/it]
2024-09-05 21:08:37,805 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.092, Train_accy 95.12, Test_accy 88.69
2024-09-05 21:08:42,305 [trainer.py] => No NME accuracy.
2024-09-05 21:08:42,305 [trainer.py] => CNN: {'total': 88.69, '00-19': 89.88, '20-39': 85.51, '40-59': 90.37, 'old': 87.89, 'new': 90.37}
2024-09-05 21:08:42,306 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69]
2024-09-05 21:08:42,306 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66]

Average Accuracy (CNN): 91.9
2024-09-05 21:08:42,306 [trainer.py] => Average Accuracy (CNN): 91.9 

2024-09-05 21:08:42,308 [trainer.py] => All params: 171970192
2024-09-05 21:08:42,310 [trainer.py] => Trainable params: 199880
2024-09-05 21:08:42,310 [l2p.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.789, Train_accy 73.04:   0%|          | 0/20 [00:09<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.789, Train_accy 73.04:   5%|▌         | 1/20 [00:09<02:53,  9.14s/it]
Task 3, Epoch 2/20 => Loss 0.017, Train_accy 91.97:   5%|▌         | 1/20 [00:18<02:53,  9.14s/it]
Task 3, Epoch 2/20 => Loss 0.017, Train_accy 91.97:  10%|█         | 2/20 [00:18<02:43,  9.09s/it]
Task 3, Epoch 3/20 => Loss -0.004, Train_accy 92.07:  10%|█         | 2/20 [00:27<02:43,  9.09s/it]
Task 3, Epoch 3/20 => Loss -0.004, Train_accy 92.07:  15%|█▌        | 3/20 [00:27<02:34,  9.09s/it]
Task 3, Epoch 4/20 => Loss -0.020, Train_accy 92.81:  15%|█▌        | 3/20 [00:36<02:34,  9.09s/it]
Task 3, Epoch 4/20 => Loss -0.020, Train_accy 92.81:  20%|██        | 4/20 [00:36<02:25,  9.08s/it]
Task 3, Epoch 5/20 => Loss -0.090, Train_accy 94.50, Test_accy 82.26:  20%|██        | 4/20 [00:51<02:25,  9.08s/it]
Task 3, Epoch 5/20 => Loss -0.090, Train_accy 94.50, Test_accy 82.26:  25%|██▌       | 5/20 [00:51<02:48, 11.23s/it]
Task 3, Epoch 6/20 => Loss -0.038, Train_accy 93.55:  25%|██▌       | 5/20 [01:00<02:48, 11.23s/it]                 
Task 3, Epoch 6/20 => Loss -0.038, Train_accy 93.55:  30%|███       | 6/20 [01:00<02:26, 10.49s/it]
Task 3, Epoch 7/20 => Loss -0.056, Train_accy 93.66:  30%|███       | 6/20 [01:09<02:26, 10.49s/it]
Task 3, Epoch 7/20 => Loss -0.056, Train_accy 93.66:  35%|███▌      | 7/20 [01:09<02:10, 10.03s/it]
Task 3, Epoch 8/20 => Loss -0.072, Train_accy 94.19:  35%|███▌      | 7/20 [01:18<02:10, 10.03s/it]
Task 3, Epoch 8/20 => Loss -0.072, Train_accy 94.19:  40%|████      | 8/20 [01:18<01:56,  9.73s/it]
Task 3, Epoch 9/20 => Loss -0.095, Train_accy 94.93:  40%|████      | 8/20 [01:27<01:56,  9.73s/it]
Task 3, Epoch 9/20 => Loss -0.095, Train_accy 94.93:  45%|████▌     | 9/20 [01:27<01:44,  9.54s/it]
Task 3, Epoch 10/20 => Loss -0.078, Train_accy 95.35, Test_accy 82.81:  45%|████▌     | 9/20 [01:42<01:44,  9.54s/it]
Task 3, Epoch 10/20 => Loss -0.078, Train_accy 95.35, Test_accy 82.81:  50%|█████     | 10/20 [01:42<01:52, 11.25s/it]
Task 3, Epoch 11/20 => Loss -0.103, Train_accy 95.24:  50%|█████     | 10/20 [01:51<01:52, 11.25s/it]                 
Task 3, Epoch 11/20 => Loss -0.103, Train_accy 95.24:  55%|█████▌    | 11/20 [01:51<01:35, 10.57s/it]
Task 3, Epoch 12/20 => Loss -0.102, Train_accy 95.35:  55%|█████▌    | 11/20 [02:00<01:35, 10.57s/it]
Task 3, Epoch 12/20 => Loss -0.102, Train_accy 95.35:  60%|██████    | 12/20 [02:00<01:20, 10.12s/it]
Task 3, Epoch 13/20 => Loss -0.077, Train_accy 94.29:  60%|██████    | 12/20 [02:10<01:20, 10.12s/it]
Task 3, Epoch 13/20 => Loss -0.077, Train_accy 94.29:  65%|██████▌   | 13/20 [02:10<01:08,  9.81s/it]
Task 3, Epoch 14/20 => Loss -0.073, Train_accy 94.08:  65%|██████▌   | 13/20 [02:19<01:08,  9.81s/it]
Task 3, Epoch 14/20 => Loss -0.073, Train_accy 94.08:  70%|███████   | 14/20 [02:19<00:57,  9.58s/it]
Task 3, Epoch 15/20 => Loss -0.090, Train_accy 95.14, Test_accy 85.42:  70%|███████   | 14/20 [02:34<00:57,  9.58s/it]
Task 3, Epoch 15/20 => Loss -0.090, Train_accy 95.14, Test_accy 85.42:  75%|███████▌  | 15/20 [02:34<00:56, 11.23s/it]
Task 3, Epoch 16/20 => Loss -0.128, Train_accy 95.77:  75%|███████▌  | 15/20 [02:43<00:56, 11.23s/it]                 
Task 3, Epoch 16/20 => Loss -0.128, Train_accy 95.77:  80%|████████  | 16/20 [02:43<00:42, 10.58s/it]
Task 3, Epoch 17/20 => Loss -0.140, Train_accy 96.51:  80%|████████  | 16/20 [02:52<00:42, 10.58s/it]
Task 3, Epoch 17/20 => Loss -0.140, Train_accy 96.51:  85%|████████▌ | 17/20 [02:52<00:30, 10.12s/it]
Task 3, Epoch 18/20 => Loss -0.110, Train_accy 96.30:  85%|████████▌ | 17/20 [03:01<00:30, 10.12s/it]
Task 3, Epoch 18/20 => Loss -0.110, Train_accy 96.30:  90%|█████████ | 18/20 [03:01<00:19,  9.81s/it]
Task 3, Epoch 19/20 => Loss -0.115, Train_accy 95.45:  90%|█████████ | 18/20 [03:10<00:19,  9.81s/it]
Task 3, Epoch 19/20 => Loss -0.115, Train_accy 95.45:  95%|█████████▌| 19/20 [03:10<00:09,  9.58s/it]
Task 3, Epoch 20/20 => Loss -0.097, Train_accy 95.45, Test_accy 83.46:  95%|█████████▌| 19/20 [03:25<00:09,  9.58s/it]
Task 3, Epoch 20/20 => Loss -0.097, Train_accy 95.45, Test_accy 83.46: 100%|██████████| 20/20 [03:25<00:00, 11.21s/it]
Task 3, Epoch 20/20 => Loss -0.097, Train_accy 95.45, Test_accy 83.46: 100%|██████████| 20/20 [03:25<00:00, 10.27s/it]
2024-09-05 21:12:07,712 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.097, Train_accy 95.45, Test_accy 83.46
2024-09-05 21:12:13,629 [trainer.py] => No NME accuracy.
2024-09-05 21:12:13,630 [trainer.py] => CNN: {'total': 83.46, '00-19': 80.16, '20-39': 82.61, '40-59': 90.83, '60-79': 80.97, 'old': 84.38, 'new': 80.97}
2024-09-05 21:12:13,630 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69, 83.46]
2024-09-05 21:12:13,630 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66, 98.59]

Average Accuracy (CNN): 89.79
2024-09-05 21:12:13,630 [trainer.py] => Average Accuracy (CNN): 89.79 

2024-09-05 21:12:13,632 [trainer.py] => All params: 171970192
2024-09-05 21:12:13,635 [trainer.py] => Trainable params: 199880
2024-09-05 21:12:13,635 [l2p.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.576, Train_accy 77.02:   0%|          | 0/20 [00:08<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.576, Train_accy 77.02:   5%|▌         | 1/20 [00:08<02:46,  8.78s/it]
Task 4, Epoch 2/20 => Loss 0.024, Train_accy 90.37:   5%|▌         | 1/20 [00:17<02:46,  8.78s/it]
Task 4, Epoch 2/20 => Loss 0.024, Train_accy 90.37:  10%|█         | 2/20 [00:17<02:37,  8.78s/it]
Task 4, Epoch 3/20 => Loss -0.029, Train_accy 92.12:  10%|█         | 2/20 [00:26<02:37,  8.78s/it]
Task 4, Epoch 3/20 => Loss -0.029, Train_accy 92.12:  15%|█▌        | 3/20 [00:26<02:29,  8.77s/it]
Task 4, Epoch 4/20 => Loss 0.023, Train_accy 92.56:  15%|█▌        | 3/20 [00:35<02:29,  8.77s/it] 
Task 4, Epoch 4/20 => Loss 0.023, Train_accy 92.56:  20%|██        | 4/20 [00:35<02:20,  8.81s/it]
Task 4, Epoch 5/20 => Loss -0.007, Train_accy 93.11, Test_accy 77.44:  20%|██        | 4/20 [00:51<02:20,  8.81s/it]
Task 4, Epoch 5/20 => Loss -0.007, Train_accy 93.11, Test_accy 77.44:  25%|██▌       | 5/20 [00:51<02:52, 11.52s/it]
Task 4, Epoch 6/20 => Loss -0.011, Train_accy 93.44:  25%|██▌       | 5/20 [01:00<02:52, 11.52s/it]                 
Task 4, Epoch 6/20 => Loss -0.011, Train_accy 93.44:  30%|███       | 6/20 [01:00<02:28, 10.59s/it]
Task 4, Epoch 7/20 => Loss -0.023, Train_accy 92.67:  30%|███       | 6/20 [01:09<02:28, 10.59s/it]
Task 4, Epoch 7/20 => Loss -0.023, Train_accy 92.67:  35%|███▌      | 7/20 [01:09<02:10, 10.01s/it]
Task 4, Epoch 8/20 => Loss -0.037, Train_accy 93.22:  35%|███▌      | 7/20 [01:17<02:10, 10.01s/it]
Task 4, Epoch 8/20 => Loss -0.037, Train_accy 93.22:  40%|████      | 8/20 [01:17<01:55,  9.64s/it]
Task 4, Epoch 9/20 => Loss -0.062, Train_accy 94.20:  40%|████      | 8/20 [01:26<01:55,  9.64s/it]
Task 4, Epoch 9/20 => Loss -0.062, Train_accy 94.20:  45%|████▌     | 9/20 [01:26<01:43,  9.38s/it]
Task 4, Epoch 10/20 => Loss 0.024, Train_accy 94.97, Test_accy 79.63:  45%|████▌     | 9/20 [01:43<01:43,  9.38s/it]
Task 4, Epoch 10/20 => Loss 0.024, Train_accy 94.97, Test_accy 79.63:  50%|█████     | 10/20 [01:43<01:55, 11.55s/it]
Task 4, Epoch 11/20 => Loss -0.049, Train_accy 94.09:  50%|█████     | 10/20 [01:51<01:55, 11.55s/it]                
Task 4, Epoch 11/20 => Loss -0.049, Train_accy 94.09:  55%|█████▌    | 11/20 [01:51<01:36, 10.71s/it]
Task 4, Epoch 12/20 => Loss 0.060, Train_accy 91.36:  55%|█████▌    | 11/20 [02:00<01:36, 10.71s/it] 
Task 4, Epoch 12/20 => Loss 0.060, Train_accy 91.36:  60%|██████    | 12/20 [02:00<01:21, 10.14s/it]
Task 4, Epoch 13/20 => Loss -0.020, Train_accy 93.44:  60%|██████    | 12/20 [02:09<01:21, 10.14s/it]
Task 4, Epoch 13/20 => Loss -0.020, Train_accy 93.44:  65%|██████▌   | 13/20 [02:09<01:08,  9.74s/it]
Task 4, Epoch 14/20 => Loss -0.081, Train_accy 94.31:  65%|██████▌   | 13/20 [02:18<01:08,  9.74s/it]
Task 4, Epoch 14/20 => Loss -0.081, Train_accy 94.31:  70%|███████   | 14/20 [02:18<00:56,  9.45s/it]
Task 4, Epoch 15/20 => Loss -0.090, Train_accy 94.53, Test_accy 80.89:  70%|███████   | 14/20 [02:34<00:56,  9.45s/it]
Task 4, Epoch 15/20 => Loss -0.090, Train_accy 94.53, Test_accy 80.89:  75%|███████▌  | 15/20 [02:34<00:57, 11.55s/it]
Task 4, Epoch 16/20 => Loss -0.109, Train_accy 94.97:  75%|███████▌  | 15/20 [02:43<00:57, 11.55s/it]                 
Task 4, Epoch 16/20 => Loss -0.109, Train_accy 94.97:  80%|████████  | 16/20 [02:43<00:42, 10.72s/it]
Task 4, Epoch 17/20 => Loss -0.066, Train_accy 95.62:  80%|████████  | 16/20 [02:52<00:42, 10.72s/it]
Task 4, Epoch 17/20 => Loss -0.066, Train_accy 95.62:  85%|████████▌ | 17/20 [02:52<00:30, 10.14s/it]
Task 4, Epoch 18/20 => Loss -0.088, Train_accy 94.64:  85%|████████▌ | 17/20 [03:01<00:30, 10.14s/it]
Task 4, Epoch 18/20 => Loss -0.088, Train_accy 94.64:  90%|█████████ | 18/20 [03:01<00:19,  9.74s/it]
Task 4, Epoch 19/20 => Loss -0.122, Train_accy 95.62:  90%|█████████ | 18/20 [03:10<00:19,  9.74s/it]
Task 4, Epoch 19/20 => Loss -0.122, Train_accy 95.62:  95%|█████████▌| 19/20 [03:10<00:09,  9.46s/it]
Task 4, Epoch 20/20 => Loss -0.081, Train_accy 95.19, Test_accy 81.23:  95%|█████████▌| 19/20 [03:26<00:09,  9.46s/it]
Task 4, Epoch 20/20 => Loss -0.081, Train_accy 95.19, Test_accy 81.23: 100%|██████████| 20/20 [03:26<00:00, 11.52s/it]
Task 4, Epoch 20/20 => Loss -0.081, Train_accy 95.19, Test_accy 81.23: 100%|██████████| 20/20 [03:26<00:00, 10.32s/it]
2024-09-05 21:15:39,999 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.081, Train_accy 95.19, Test_accy 81.23
2024-09-05 21:15:47,585 [trainer.py] => No NME accuracy.
2024-09-05 21:15:47,586 [trainer.py] => CNN: {'total': 81.23, '00-19': 75.3, '20-39': 81.16, '40-59': 90.37, '60-79': 81.78, '80-99': 78.81, 'old': 81.94, 'new': 78.81}
2024-09-05 21:15:47,586 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69, 83.46, 81.23]
2024-09-05 21:15:47,586 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66, 98.59, 98.57]

Average Accuracy (CNN): 88.08
2024-09-05 21:15:47,586 [trainer.py] => Average Accuracy (CNN): 88.08 

2024-09-05 21:15:47,589 [trainer.py] => All params: 171970192
2024-09-05 21:15:47,591 [trainer.py] => Trainable params: 199880
2024-09-05 21:15:47,591 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.630, Train_accy 77.94:   0%|          | 0/20 [00:09<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.630, Train_accy 77.94:   5%|▌         | 1/20 [00:09<02:53,  9.13s/it]
Task 5, Epoch 2/20 => Loss -0.054, Train_accy 94.12:   5%|▌         | 1/20 [00:18<02:53,  9.13s/it]
Task 5, Epoch 2/20 => Loss -0.054, Train_accy 94.12:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]
Task 5, Epoch 3/20 => Loss -0.105, Train_accy 95.90:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]
Task 5, Epoch 3/20 => Loss -0.105, Train_accy 95.90:  15%|█▌        | 3/20 [00:27<02:35,  9.14s/it]
Task 5, Epoch 4/20 => Loss -0.073, Train_accy 94.01:  15%|█▌        | 3/20 [00:36<02:35,  9.14s/it]
Task 5, Epoch 4/20 => Loss -0.073, Train_accy 94.01:  20%|██        | 4/20 [00:36<02:26,  9.14s/it]
Task 5, Epoch 5/20 => Loss -0.091, Train_accy 94.96, Test_accy 76.98:  20%|██        | 4/20 [00:54<02:26,  9.14s/it]
Task 5, Epoch 5/20 => Loss -0.091, Train_accy 94.96, Test_accy 76.98:  25%|██▌       | 5/20 [00:54<03:04, 12.33s/it]
Task 5, Epoch 6/20 => Loss -0.126, Train_accy 96.53:  25%|██▌       | 5/20 [01:03<03:04, 12.33s/it]                 
Task 5, Epoch 6/20 => Loss -0.126, Train_accy 96.53:  30%|███       | 6/20 [01:03<02:37, 11.25s/it]
Task 5, Epoch 7/20 => Loss -0.141, Train_accy 96.11:  30%|███       | 6/20 [01:12<02:37, 11.25s/it]
Task 5, Epoch 7/20 => Loss -0.141, Train_accy 96.11:  35%|███▌      | 7/20 [01:12<02:17, 10.55s/it]
Task 5, Epoch 8/20 => Loss -0.124, Train_accy 96.01:  35%|███▌      | 7/20 [01:21<02:17, 10.55s/it]
Task 5, Epoch 8/20 => Loss -0.124, Train_accy 96.01:  40%|████      | 8/20 [01:21<02:01, 10.10s/it]
Task 5, Epoch 9/20 => Loss -0.097, Train_accy 95.27:  40%|████      | 8/20 [01:31<02:01, 10.10s/it]
Task 5, Epoch 9/20 => Loss -0.097, Train_accy 95.27:  45%|████▌     | 9/20 [01:31<01:47,  9.79s/it]
Task 5, Epoch 10/20 => Loss -0.136, Train_accy 95.90, Test_accy 77.82:  45%|████▌     | 9/20 [01:49<01:47,  9.79s/it]
Task 5, Epoch 10/20 => Loss -0.136, Train_accy 95.90, Test_accy 77.82:  50%|█████     | 10/20 [01:49<02:03, 12.35s/it]
Task 5, Epoch 11/20 => Loss -0.094, Train_accy 95.80:  50%|█████     | 10/20 [01:58<02:03, 12.35s/it]                 
Task 5, Epoch 11/20 => Loss -0.094, Train_accy 95.80:  55%|█████▌    | 11/20 [01:58<01:42, 11.38s/it]
Task 5, Epoch 12/20 => Loss -0.150, Train_accy 97.06:  55%|█████▌    | 11/20 [02:07<01:42, 11.38s/it]
Task 5, Epoch 12/20 => Loss -0.150, Train_accy 97.06:  60%|██████    | 12/20 [02:07<01:25, 10.70s/it]
Task 5, Epoch 13/20 => Loss -0.134, Train_accy 96.22:  60%|██████    | 12/20 [02:16<01:25, 10.70s/it]
Task 5, Epoch 13/20 => Loss -0.134, Train_accy 96.22:  65%|██████▌   | 13/20 [02:16<01:11, 10.23s/it]
Task 5, Epoch 14/20 => Loss -0.111, Train_accy 96.01:  65%|██████▌   | 13/20 [02:25<01:11, 10.23s/it]
Task 5, Epoch 14/20 => Loss -0.111, Train_accy 96.01:  70%|███████   | 14/20 [02:25<00:59,  9.89s/it]
Task 5, Epoch 15/20 => Loss -0.149, Train_accy 97.16, Test_accy 78.32:  70%|███████   | 14/20 [02:43<00:59,  9.89s/it]
Task 5, Epoch 15/20 => Loss -0.149, Train_accy 97.16, Test_accy 78.32:  75%|███████▌  | 15/20 [02:43<01:01, 12.37s/it]
Task 5, Epoch 16/20 => Loss -0.110, Train_accy 95.48:  75%|███████▌  | 15/20 [02:53<01:01, 12.37s/it]                 
Task 5, Epoch 16/20 => Loss -0.110, Train_accy 95.48:  80%|████████  | 16/20 [02:53<00:45, 11.41s/it]
Task 5, Epoch 17/20 => Loss -0.105, Train_accy 95.80:  80%|████████  | 16/20 [03:02<00:45, 11.41s/it]
Task 5, Epoch 17/20 => Loss -0.105, Train_accy 95.80:  85%|████████▌ | 17/20 [03:02<00:32, 10.73s/it]
Task 5, Epoch 18/20 => Loss -0.123, Train_accy 96.64:  85%|████████▌ | 17/20 [03:11<00:32, 10.73s/it]
Task 5, Epoch 18/20 => Loss -0.123, Train_accy 96.64:  90%|█████████ | 18/20 [03:11<00:20, 10.25s/it]
Task 5, Epoch 19/20 => Loss -0.070, Train_accy 94.85:  90%|█████████ | 18/20 [03:20<00:20, 10.25s/it]
Task 5, Epoch 19/20 => Loss -0.070, Train_accy 94.85:  95%|█████████▌| 19/20 [03:20<00:09,  9.91s/it]
Task 5, Epoch 20/20 => Loss -0.147, Train_accy 96.74, Test_accy 79.17:  95%|█████████▌| 19/20 [03:38<00:09,  9.91s/it]
Task 5, Epoch 20/20 => Loss -0.147, Train_accy 96.74, Test_accy 79.17: 100%|██████████| 20/20 [03:38<00:00, 12.38s/it]
Task 5, Epoch 20/20 => Loss -0.147, Train_accy 96.74, Test_accy 79.17: 100%|██████████| 20/20 [03:38<00:00, 10.93s/it]
2024-09-05 21:19:26,161 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.147, Train_accy 96.74, Test_accy 79.17
2024-09-05 21:19:35,074 [trainer.py] => No NME accuracy.
2024-09-05 21:19:35,075 [trainer.py] => CNN: {'total': 79.17, '00-19': 75.3, '20-39': 79.23, '40-59': 86.7, '60-79': 80.16, '80-99': 79.18, '100-119': 75.0, 'old': 79.97, 'new': 75.0}
2024-09-05 21:19:35,075 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69, 83.46, 81.23, 79.17]
2024-09-05 21:19:35,075 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66, 98.59, 98.57, 98.45]

Average Accuracy (CNN): 86.59
2024-09-05 21:19:35,075 [trainer.py] => Average Accuracy (CNN): 86.59 

2024-09-05 21:19:35,078 [trainer.py] => All params: 171970192
2024-09-05 21:19:35,080 [trainer.py] => Trainable params: 199880
2024-09-05 21:19:35,081 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.856, Train_accy 66.88:   0%|          | 0/20 [00:09<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.856, Train_accy 66.88:   5%|▌         | 1/20 [00:09<02:54,  9.20s/it]
Task 6, Epoch 2/20 => Loss 0.097, Train_accy 86.16:   5%|▌         | 1/20 [00:18<02:54,  9.20s/it]
Task 6, Epoch 2/20 => Loss 0.097, Train_accy 86.16:  10%|█         | 2/20 [00:18<02:45,  9.18s/it]
Task 6, Epoch 3/20 => Loss 0.038, Train_accy 89.94:  10%|█         | 2/20 [00:27<02:45,  9.18s/it]
Task 6, Epoch 3/20 => Loss 0.038, Train_accy 89.94:  15%|█▌        | 3/20 [00:27<02:35,  9.17s/it]
Task 6, Epoch 4/20 => Loss 0.024, Train_accy 89.94:  15%|█▌        | 3/20 [00:36<02:35,  9.17s/it]
Task 6, Epoch 4/20 => Loss 0.024, Train_accy 89.94:  20%|██        | 4/20 [00:36<02:26,  9.16s/it]
Task 6, Epoch 5/20 => Loss 0.047, Train_accy 89.52, Test_accy 75.44:  20%|██        | 4/20 [00:56<02:26,  9.16s/it]
Task 6, Epoch 5/20 => Loss 0.047, Train_accy 89.52, Test_accy 75.44:  25%|██▌       | 5/20 [00:56<03:12, 12.83s/it]
Task 6, Epoch 6/20 => Loss -0.009, Train_accy 90.78:  25%|██▌       | 5/20 [01:05<03:12, 12.83s/it]                
Task 6, Epoch 6/20 => Loss -0.009, Train_accy 90.78:  30%|███       | 6/20 [01:05<02:42, 11.59s/it]
Task 6, Epoch 7/20 => Loss -0.002, Train_accy 91.40:  30%|███       | 6/20 [01:14<02:42, 11.59s/it]
Task 6, Epoch 7/20 => Loss -0.002, Train_accy 91.40:  35%|███▌      | 7/20 [01:14<02:20, 10.82s/it]
Task 6, Epoch 8/20 => Loss 0.011, Train_accy 90.67:  35%|███▌      | 7/20 [01:23<02:20, 10.82s/it] 
Task 6, Epoch 8/20 => Loss 0.011, Train_accy 90.67:  40%|████      | 8/20 [01:23<02:03, 10.28s/it]
Task 6, Epoch 9/20 => Loss -0.054, Train_accy 92.87:  40%|████      | 8/20 [01:32<02:03, 10.28s/it]
Task 6, Epoch 9/20 => Loss -0.054, Train_accy 92.87:  45%|████▌     | 9/20 [01:32<01:49,  9.93s/it]
Task 6, Epoch 10/20 => Loss -0.056, Train_accy 92.56, Test_accy 76.54:  45%|████▌     | 9/20 [01:52<01:49,  9.93s/it]
Task 6, Epoch 10/20 => Loss -0.056, Train_accy 92.56, Test_accy 76.54:  50%|█████     | 10/20 [01:52<02:08, 12.86s/it]
Task 6, Epoch 11/20 => Loss -0.052, Train_accy 92.77:  50%|█████     | 10/20 [02:01<02:08, 12.86s/it]                 
Task 6, Epoch 11/20 => Loss -0.052, Train_accy 92.77:  55%|█████▌    | 11/20 [02:01<01:45, 11.74s/it]
Task 6, Epoch 12/20 => Loss -0.075, Train_accy 93.92:  55%|█████▌    | 11/20 [02:10<01:45, 11.74s/it]
Task 6, Epoch 12/20 => Loss -0.075, Train_accy 93.92:  60%|██████    | 12/20 [02:10<01:27, 10.94s/it]
Task 6, Epoch 13/20 => Loss -0.045, Train_accy 92.66:  60%|██████    | 12/20 [02:19<01:27, 10.94s/it]
Task 6, Epoch 13/20 => Loss -0.045, Train_accy 92.66:  65%|██████▌   | 13/20 [02:19<01:12, 10.40s/it]
Task 6, Epoch 14/20 => Loss -0.075, Train_accy 94.03:  65%|██████▌   | 13/20 [02:28<01:12, 10.40s/it]
Task 6, Epoch 14/20 => Loss -0.075, Train_accy 94.03:  70%|███████   | 14/20 [02:28<01:00, 10.02s/it]
Task 6, Epoch 15/20 => Loss -0.099, Train_accy 94.13, Test_accy 76.84:  70%|███████   | 14/20 [02:48<01:00, 10.02s/it]
Task 6, Epoch 15/20 => Loss -0.099, Train_accy 94.13, Test_accy 76.84:  75%|███████▌  | 15/20 [02:48<01:04, 12.82s/it]
Task 6, Epoch 16/20 => Loss -0.047, Train_accy 92.56:  75%|███████▌  | 15/20 [02:57<01:04, 12.82s/it]                 
Task 6, Epoch 16/20 => Loss -0.047, Train_accy 92.56:  80%|████████  | 16/20 [02:57<00:46, 11.72s/it]
Task 6, Epoch 17/20 => Loss -0.050, Train_accy 92.87:  80%|████████  | 16/20 [03:06<00:46, 11.72s/it]
Task 6, Epoch 17/20 => Loss -0.050, Train_accy 92.87:  85%|████████▌ | 17/20 [03:06<00:32, 10.95s/it]
Task 6, Epoch 18/20 => Loss -0.072, Train_accy 93.71:  85%|████████▌ | 17/20 [03:15<00:32, 10.95s/it]
Task 6, Epoch 18/20 => Loss -0.072, Train_accy 93.71:  90%|█████████ | 18/20 [03:15<00:20, 10.41s/it]
Task 6, Epoch 19/20 => Loss -0.111, Train_accy 95.07:  90%|█████████ | 18/20 [03:24<00:20, 10.41s/it]
Task 6, Epoch 19/20 => Loss -0.111, Train_accy 95.07:  95%|█████████▌| 19/20 [03:24<00:10, 10.03s/it]
Task 6, Epoch 20/20 => Loss -0.136, Train_accy 95.49, Test_accy 77.33:  95%|█████████▌| 19/20 [03:44<00:10, 10.03s/it]
Task 6, Epoch 20/20 => Loss -0.136, Train_accy 95.49, Test_accy 77.33: 100%|██████████| 20/20 [03:44<00:00, 12.83s/it]
Task 6, Epoch 20/20 => Loss -0.136, Train_accy 95.49, Test_accy 77.33: 100%|██████████| 20/20 [03:44<00:00, 11.20s/it]
2024-09-05 21:23:19,127 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.136, Train_accy 95.49, Test_accy 77.33
2024-09-05 21:23:29,386 [trainer.py] => No NME accuracy.
2024-09-05 21:23:29,386 [trainer.py] => CNN: {'total': 77.33, '00-19': 71.26, '20-39': 75.85, '40-59': 84.4, '60-79': 79.76, '80-99': 75.84, '100-119': 75.88, '120-139': 79.11, 'old': 77.05, 'new': 79.11}
2024-09-05 21:23:29,386 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69, 83.46, 81.23, 79.17, 77.33]
2024-09-05 21:23:29,386 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66, 98.59, 98.57, 98.45, 98.23]

Average Accuracy (CNN): 85.27
2024-09-05 21:23:29,386 [trainer.py] => Average Accuracy (CNN): 85.27 

2024-09-05 21:23:29,388 [trainer.py] => All params: 171970192
2024-09-05 21:23:29,390 [trainer.py] => Trainable params: 199880
2024-09-05 21:23:29,390 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.754, Train_accy 72.39:   0%|          | 0/20 [00:08<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.754, Train_accy 72.39:   5%|▌         | 1/20 [00:08<02:48,  8.85s/it]
Task 7, Epoch 2/20 => Loss 0.029, Train_accy 91.30:   5%|▌         | 1/20 [00:17<02:48,  8.85s/it]
Task 7, Epoch 2/20 => Loss 0.029, Train_accy 91.30:  10%|█         | 2/20 [00:17<02:39,  8.86s/it]
Task 7, Epoch 3/20 => Loss -0.019, Train_accy 93.26:  10%|█         | 2/20 [00:26<02:39,  8.86s/it]
Task 7, Epoch 3/20 => Loss -0.019, Train_accy 93.26:  15%|█▌        | 3/20 [00:26<02:31,  8.90s/it]
Task 7, Epoch 4/20 => Loss -0.056, Train_accy 93.37:  15%|█▌        | 3/20 [00:35<02:31,  8.90s/it]
Task 7, Epoch 4/20 => Loss -0.056, Train_accy 93.37:  20%|██        | 4/20 [00:35<02:22,  8.89s/it]
Task 7, Epoch 5/20 => Loss -0.065, Train_accy 93.91, Test_accy 74.78:  20%|██        | 4/20 [00:56<02:22,  8.89s/it]
Task 7, Epoch 5/20 => Loss -0.065, Train_accy 93.91, Test_accy 74.78:  25%|██▌       | 5/20 [00:56<03:16, 13.09s/it]
Task 7, Epoch 6/20 => Loss -0.047, Train_accy 93.80:  25%|██▌       | 5/20 [01:04<03:16, 13.09s/it]                 
Task 7, Epoch 6/20 => Loss -0.047, Train_accy 93.80:  30%|███       | 6/20 [01:04<02:43, 11.65s/it]
Task 7, Epoch 7/20 => Loss -0.053, Train_accy 94.46:  30%|███       | 6/20 [01:13<02:43, 11.65s/it]
Task 7, Epoch 7/20 => Loss -0.053, Train_accy 94.46:  35%|███▌      | 7/20 [01:13<02:19, 10.73s/it]
Task 7, Epoch 8/20 => Loss -0.047, Train_accy 93.26:  35%|███▌      | 7/20 [01:22<02:19, 10.73s/it]
Task 7, Epoch 8/20 => Loss -0.047, Train_accy 93.26:  40%|████      | 8/20 [01:22<02:01, 10.13s/it]
Task 7, Epoch 9/20 => Loss -0.080, Train_accy 94.46:  40%|████      | 8/20 [01:31<02:01, 10.13s/it]
Task 7, Epoch 9/20 => Loss -0.080, Train_accy 94.46:  45%|████▌     | 9/20 [01:31<01:46,  9.72s/it]
Task 7, Epoch 10/20 => Loss -0.106, Train_accy 95.22, Test_accy 76.04:  45%|████▌     | 9/20 [01:51<01:46,  9.72s/it]
Task 7, Epoch 10/20 => Loss -0.106, Train_accy 95.22, Test_accy 76.04:  50%|█████     | 10/20 [01:51<02:10, 13.07s/it]
Task 7, Epoch 11/20 => Loss -0.067, Train_accy 95.11:  50%|█████     | 10/20 [02:00<02:10, 13.07s/it]                 
Task 7, Epoch 11/20 => Loss -0.067, Train_accy 95.11:  55%|█████▌    | 11/20 [02:00<01:45, 11.77s/it]
Task 7, Epoch 12/20 => Loss -0.024, Train_accy 93.91:  55%|█████▌    | 11/20 [02:09<01:45, 11.77s/it]
Task 7, Epoch 12/20 => Loss -0.024, Train_accy 93.91:  60%|██████    | 12/20 [02:09<01:27, 10.88s/it]
Task 7, Epoch 13/20 => Loss -0.088, Train_accy 94.78:  60%|██████    | 12/20 [02:18<01:27, 10.88s/it]
Task 7, Epoch 13/20 => Loss -0.088, Train_accy 94.78:  65%|██████▌   | 13/20 [02:18<01:11, 10.25s/it]
Task 7, Epoch 14/20 => Loss -0.103, Train_accy 95.87:  65%|██████▌   | 13/20 [02:27<01:11, 10.25s/it]
Task 7, Epoch 14/20 => Loss -0.103, Train_accy 95.87:  70%|███████   | 14/20 [02:27<00:58,  9.82s/it]
Task 7, Epoch 15/20 => Loss -0.062, Train_accy 95.11, Test_accy 75.52:  70%|███████   | 14/20 [02:47<00:58,  9.82s/it]
Task 7, Epoch 15/20 => Loss -0.062, Train_accy 95.11, Test_accy 75.52:  75%|███████▌  | 15/20 [02:47<01:05, 13.06s/it]
Task 7, Epoch 16/20 => Loss -0.054, Train_accy 94.35:  75%|███████▌  | 15/20 [02:56<01:05, 13.06s/it]                 
Task 7, Epoch 16/20 => Loss -0.054, Train_accy 94.35:  80%|████████  | 16/20 [02:56<00:47, 11.80s/it]
Task 7, Epoch 17/20 => Loss -0.093, Train_accy 95.22:  80%|████████  | 16/20 [03:05<00:47, 11.80s/it]
Task 7, Epoch 17/20 => Loss -0.093, Train_accy 95.22:  85%|████████▌ | 17/20 [03:05<00:32, 10.92s/it]
Task 7, Epoch 18/20 => Loss -0.091, Train_accy 94.78:  85%|████████▌ | 17/20 [03:14<00:32, 10.92s/it]
Task 7, Epoch 18/20 => Loss -0.091, Train_accy 94.78:  90%|█████████ | 18/20 [03:14<00:20, 10.30s/it]
Task 7, Epoch 19/20 => Loss -0.126, Train_accy 95.54:  90%|█████████ | 18/20 [03:23<00:20, 10.30s/it]
Task 7, Epoch 19/20 => Loss -0.126, Train_accy 95.54:  95%|█████████▌| 19/20 [03:23<00:09,  9.86s/it]
Task 7, Epoch 20/20 => Loss -0.114, Train_accy 95.87, Test_accy 75.52:  95%|█████████▌| 19/20 [03:43<00:09,  9.86s/it]
Task 7, Epoch 20/20 => Loss -0.114, Train_accy 95.87, Test_accy 75.52: 100%|██████████| 20/20 [03:43<00:00, 13.09s/it]
Task 7, Epoch 20/20 => Loss -0.114, Train_accy 95.87, Test_accy 75.52: 100%|██████████| 20/20 [03:43<00:00, 11.20s/it]
2024-09-05 21:27:13,333 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.114, Train_accy 95.87, Test_accy 75.52
2024-09-05 21:27:25,029 [trainer.py] => No NME accuracy.
2024-09-05 21:27:25,030 [trainer.py] => CNN: {'total': 75.52, '00-19': 67.21, '20-39': 71.98, '40-59': 79.36, '60-79': 75.3, '80-99': 74.35, '100-119': 73.68, '120-139': 77.78, '140-159': 84.4, 'old': 74.16, 'new': 84.4}
2024-09-05 21:27:25,030 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69, 83.46, 81.23, 79.17, 77.33, 75.52]
2024-09-05 21:27:25,030 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66, 98.59, 98.57, 98.45, 98.23, 98.15]

Average Accuracy (CNN): 84.05
2024-09-05 21:27:25,030 [trainer.py] => Average Accuracy (CNN): 84.05 

2024-09-05 21:27:25,033 [trainer.py] => All params: 171970192
2024-09-05 21:27:25,035 [trainer.py] => Trainable params: 199880
2024-09-05 21:27:25,035 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.702, Train_accy 73.80:   0%|          | 0/20 [00:09<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.702, Train_accy 73.80:   5%|▌         | 1/20 [00:09<02:54,  9.21s/it]
Task 8, Epoch 2/20 => Loss -0.014, Train_accy 92.59:   5%|▌         | 1/20 [00:18<02:54,  9.21s/it]
Task 8, Epoch 2/20 => Loss -0.014, Train_accy 92.59:  10%|█         | 2/20 [00:18<02:45,  9.18s/it]
Task 8, Epoch 3/20 => Loss -0.056, Train_accy 93.01:  10%|█         | 2/20 [00:27<02:45,  9.18s/it]
Task 8, Epoch 3/20 => Loss -0.056, Train_accy 93.01:  15%|█▌        | 3/20 [00:27<02:36,  9.20s/it]
Task 8, Epoch 4/20 => Loss -0.102, Train_accy 95.09:  15%|█▌        | 3/20 [00:36<02:36,  9.20s/it]
Task 8, Epoch 4/20 => Loss -0.102, Train_accy 95.09:  20%|██        | 4/20 [00:36<02:27,  9.19s/it]
Task 8, Epoch 5/20 => Loss -0.059, Train_accy 93.63, Test_accy 72.46:  20%|██        | 4/20 [00:59<02:27,  9.19s/it]
Task 8, Epoch 5/20 => Loss -0.059, Train_accy 93.63, Test_accy 72.46:  25%|██▌       | 5/20 [00:59<03:29, 13.94s/it]
Task 8, Epoch 6/20 => Loss -0.117, Train_accy 95.62:  25%|██▌       | 5/20 [01:08<03:29, 13.94s/it]                 
Task 8, Epoch 6/20 => Loss -0.117, Train_accy 95.62:  30%|███       | 6/20 [01:08<02:52, 12.33s/it]
Task 8, Epoch 7/20 => Loss -0.083, Train_accy 94.36:  30%|███       | 6/20 [01:17<02:52, 12.33s/it]
Task 8, Epoch 7/20 => Loss -0.083, Train_accy 94.36:  35%|███▌      | 7/20 [01:17<02:27, 11.32s/it]
Task 8, Epoch 8/20 => Loss -0.080, Train_accy 94.36:  35%|███▌      | 7/20 [01:26<02:27, 11.32s/it]
Task 8, Epoch 8/20 => Loss -0.080, Train_accy 94.36:  40%|████      | 8/20 [01:26<02:07, 10.63s/it]
Task 8, Epoch 9/20 => Loss -0.110, Train_accy 94.89:  40%|████      | 8/20 [01:35<02:07, 10.63s/it]
Task 8, Epoch 9/20 => Loss -0.110, Train_accy 94.89:  45%|████▌     | 9/20 [01:35<01:51, 10.18s/it]
Task 8, Epoch 10/20 => Loss -0.080, Train_accy 93.95, Test_accy 73.78:  45%|████▌     | 9/20 [01:58<01:51, 10.18s/it]
Task 8, Epoch 10/20 => Loss -0.080, Train_accy 93.95, Test_accy 73.78:  50%|█████     | 10/20 [01:58<02:18, 13.90s/it]
Task 8, Epoch 11/20 => Loss -0.136, Train_accy 95.82:  50%|█████     | 10/20 [02:07<02:18, 13.90s/it]                 
Task 8, Epoch 11/20 => Loss -0.136, Train_accy 95.82:  55%|█████▌    | 11/20 [02:07<01:52, 12.46s/it]
Task 8, Epoch 12/20 => Loss -0.107, Train_accy 94.68:  55%|█████▌    | 11/20 [02:16<01:52, 12.46s/it]
Task 8, Epoch 12/20 => Loss -0.107, Train_accy 94.68:  60%|██████    | 12/20 [02:16<01:31, 11.46s/it]
Task 8, Epoch 13/20 => Loss -0.123, Train_accy 95.20:  60%|██████    | 12/20 [02:25<01:31, 11.46s/it]
Task 8, Epoch 13/20 => Loss -0.123, Train_accy 95.20:  65%|██████▌   | 13/20 [02:25<01:15, 10.78s/it]
Task 8, Epoch 14/20 => Loss -0.110, Train_accy 94.78:  65%|██████▌   | 13/20 [02:34<01:15, 10.78s/it]
Task 8, Epoch 14/20 => Loss -0.110, Train_accy 94.78:  70%|███████   | 14/20 [02:34<01:01, 10.31s/it]
Task 8, Epoch 15/20 => Loss -0.087, Train_accy 94.68, Test_accy 73.87:  70%|███████   | 14/20 [02:57<01:01, 10.31s/it]
Task 8, Epoch 15/20 => Loss -0.087, Train_accy 94.68, Test_accy 73.87:  75%|███████▌  | 15/20 [02:57<01:09, 13.93s/it]
Task 8, Epoch 16/20 => Loss -0.139, Train_accy 96.14:  75%|███████▌  | 15/20 [03:06<01:09, 13.93s/it]                 
Task 8, Epoch 16/20 => Loss -0.139, Train_accy 96.14:  80%|████████  | 16/20 [03:06<00:50, 12.51s/it]
Task 8, Epoch 17/20 => Loss -0.126, Train_accy 95.72:  80%|████████  | 16/20 [03:15<00:50, 12.51s/it]
Task 8, Epoch 17/20 => Loss -0.126, Train_accy 95.72:  85%|████████▌ | 17/20 [03:15<00:34, 11.51s/it]
Task 8, Epoch 18/20 => Loss -0.106, Train_accy 95.09:  85%|████████▌ | 17/20 [03:24<00:34, 11.51s/it]
Task 8, Epoch 18/20 => Loss -0.106, Train_accy 95.09:  90%|█████████ | 18/20 [03:24<00:21, 10.83s/it]
Task 8, Epoch 19/20 => Loss -0.141, Train_accy 96.24:  90%|█████████ | 18/20 [03:34<00:21, 10.83s/it]
Task 8, Epoch 19/20 => Loss -0.141, Train_accy 96.24:  95%|█████████▌| 19/20 [03:34<00:10, 10.34s/it]
Task 8, Epoch 20/20 => Loss -0.121, Train_accy 95.41, Test_accy 73.36:  95%|█████████▌| 19/20 [03:56<00:10, 10.34s/it]
Task 8, Epoch 20/20 => Loss -0.121, Train_accy 95.41, Test_accy 73.36: 100%|██████████| 20/20 [03:56<00:00, 13.91s/it]
Task 8, Epoch 20/20 => Loss -0.121, Train_accy 95.41, Test_accy 73.36: 100%|██████████| 20/20 [03:56<00:00, 11.82s/it]
2024-09-05 21:31:21,405 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.121, Train_accy 95.41, Test_accy 73.36
2024-09-05 21:31:34,546 [trainer.py] => No NME accuracy.
2024-09-05 21:31:34,546 [trainer.py] => CNN: {'total': 73.36, '00-19': 65.59, '20-39': 71.5, '40-59': 78.44, '60-79': 72.87, '80-99': 72.86, '100-119': 70.61, '120-139': 79.56, '140-159': 83.2, '160-179': 65.82, 'old': 74.3, 'new': 65.82}
2024-09-05 21:31:34,546 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69, 83.46, 81.23, 79.17, 77.33, 75.52, 73.36]
2024-09-05 21:31:34,547 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66, 98.59, 98.57, 98.45, 98.23, 98.15, 97.89]

Average Accuracy (CNN): 82.86
2024-09-05 21:31:34,547 [trainer.py] => Average Accuracy (CNN): 82.86 

2024-09-05 21:31:34,548 [trainer.py] => All params: 171970192
2024-09-05 21:31:34,550 [trainer.py] => Trainable params: 199880
2024-09-05 21:31:34,550 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.573, Train_accy 77.73:   0%|          | 0/20 [00:09<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.573, Train_accy 77.73:   5%|▌         | 1/20 [00:09<02:53,  9.15s/it]
Task 9, Epoch 2/20 => Loss -0.069, Train_accy 94.22:   5%|▌         | 1/20 [00:18<02:53,  9.15s/it]
Task 9, Epoch 2/20 => Loss -0.069, Train_accy 94.22:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]
Task 9, Epoch 3/20 => Loss -0.077, Train_accy 94.33:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]
Task 9, Epoch 3/20 => Loss -0.077, Train_accy 94.33:  15%|█▌        | 3/20 [00:27<02:35,  9.13s/it]
Task 9, Epoch 4/20 => Loss -0.060, Train_accy 93.91:  15%|█▌        | 3/20 [00:36<02:35,  9.13s/it]
Task 9, Epoch 4/20 => Loss -0.060, Train_accy 93.91:  20%|██        | 4/20 [00:36<02:26,  9.13s/it]
Task 9, Epoch 5/20 => Loss -0.115, Train_accy 96.11, Test_accy 70.14:  20%|██        | 4/20 [01:00<02:26,  9.13s/it]
Task 9, Epoch 5/20 => Loss -0.115, Train_accy 96.11, Test_accy 70.14:  25%|██▌       | 5/20 [01:00<03:34, 14.30s/it]
Task 9, Epoch 6/20 => Loss -0.082, Train_accy 94.43:  25%|██▌       | 5/20 [01:09<03:34, 14.30s/it]                 
Task 9, Epoch 6/20 => Loss -0.082, Train_accy 94.43:  30%|███       | 6/20 [01:09<02:55, 12.54s/it]
Task 9, Epoch 7/20 => Loss -0.078, Train_accy 93.91:  30%|███       | 6/20 [01:18<02:55, 12.54s/it]
Task 9, Epoch 7/20 => Loss -0.078, Train_accy 93.91:  35%|███▌      | 7/20 [01:18<02:28, 11.42s/it]
Task 9, Epoch 8/20 => Loss -0.068, Train_accy 94.22:  35%|███▌      | 7/20 [01:27<02:28, 11.42s/it]
Task 9, Epoch 8/20 => Loss -0.068, Train_accy 94.22:  40%|████      | 8/20 [01:27<02:08, 10.70s/it]
Task 9, Epoch 9/20 => Loss -0.106, Train_accy 95.48:  40%|████      | 8/20 [01:36<02:08, 10.70s/it]
Task 9, Epoch 9/20 => Loss -0.106, Train_accy 95.48:  45%|████▌     | 9/20 [01:36<01:52, 10.22s/it]
Task 9, Epoch 10/20 => Loss -0.116, Train_accy 95.69, Test_accy 71.63:  45%|████▌     | 9/20 [02:00<01:52, 10.22s/it]
Task 9, Epoch 10/20 => Loss -0.116, Train_accy 95.69, Test_accy 71.63:  50%|█████     | 10/20 [02:00<02:23, 14.35s/it]
Task 9, Epoch 11/20 => Loss -0.068, Train_accy 93.28:  50%|█████     | 10/20 [02:09<02:23, 14.35s/it]                 
Task 9, Epoch 11/20 => Loss -0.068, Train_accy 93.28:  55%|█████▌    | 11/20 [02:09<01:54, 12.74s/it]
Task 9, Epoch 12/20 => Loss -0.105, Train_accy 95.06:  55%|█████▌    | 11/20 [02:18<01:54, 12.74s/it]
Task 9, Epoch 12/20 => Loss -0.105, Train_accy 95.06:  60%|██████    | 12/20 [02:18<01:33, 11.64s/it]
Task 9, Epoch 13/20 => Loss -0.133, Train_accy 96.11:  60%|██████    | 12/20 [02:27<01:33, 11.64s/it]
Task 9, Epoch 13/20 => Loss -0.133, Train_accy 96.11:  65%|██████▌   | 13/20 [02:27<01:16, 10.87s/it]
Task 9, Epoch 14/20 => Loss -0.119, Train_accy 95.80:  65%|██████▌   | 13/20 [02:36<01:16, 10.87s/it]
Task 9, Epoch 14/20 => Loss -0.119, Train_accy 95.80:  70%|███████   | 14/20 [02:36<01:02, 10.34s/it]
Task 9, Epoch 15/20 => Loss -0.102, Train_accy 95.17, Test_accy 71.20:  70%|███████   | 14/20 [03:00<01:02, 10.34s/it]
Task 9, Epoch 15/20 => Loss -0.102, Train_accy 95.17, Test_accy 71.20:  75%|███████▌  | 15/20 [03:00<01:11, 14.33s/it]
Task 9, Epoch 16/20 => Loss -0.088, Train_accy 94.33:  75%|███████▌  | 15/20 [03:09<01:11, 14.33s/it]                 
Task 9, Epoch 16/20 => Loss -0.088, Train_accy 94.33:  80%|████████  | 16/20 [03:09<00:51, 12.76s/it]
Task 9, Epoch 17/20 => Loss -0.110, Train_accy 95.06:  80%|████████  | 16/20 [03:18<00:51, 12.76s/it]
Task 9, Epoch 17/20 => Loss -0.110, Train_accy 95.06:  85%|████████▌ | 17/20 [03:18<00:35, 11.67s/it]
Task 9, Epoch 18/20 => Loss -0.151, Train_accy 95.80:  85%|████████▌ | 17/20 [03:27<00:35, 11.67s/it]
Task 9, Epoch 18/20 => Loss -0.151, Train_accy 95.80:  90%|█████████ | 18/20 [03:27<00:21, 10.91s/it]
Task 9, Epoch 19/20 => Loss -0.103, Train_accy 95.27:  90%|█████████ | 18/20 [03:36<00:21, 10.91s/it]
Task 9, Epoch 19/20 => Loss -0.103, Train_accy 95.27:  95%|█████████▌| 19/20 [03:36<00:10, 10.38s/it]
Task 9, Epoch 20/20 => Loss -0.107, Train_accy 95.38, Test_accy 71.88:  95%|█████████▌| 19/20 [04:00<00:10, 10.38s/it]
Task 9, Epoch 20/20 => Loss -0.107, Train_accy 95.38, Test_accy 71.88: 100%|██████████| 20/20 [04:00<00:00, 14.40s/it]
Task 9, Epoch 20/20 => Loss -0.107, Train_accy 95.38, Test_accy 71.88: 100%|██████████| 20/20 [04:00<00:00, 12.02s/it]
2024-09-05 21:35:35,019 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.107, Train_accy 95.38, Test_accy 71.88
2024-09-05 21:35:49,673 [trainer.py] => No NME accuracy.
2024-09-05 21:35:49,673 [trainer.py] => CNN: {'total': 71.88, '00-19': 63.56, '20-39': 64.73, '40-59': 78.44, '60-79': 72.87, '80-99': 69.89, '100-119': 70.61, '120-139': 74.22, '140-159': 82.4, '160-179': 64.56, '180-199': 77.39, 'old': 71.29, 'new': 77.39}
2024-09-05 21:35:49,673 [trainer.py] => CNN top1 curve: [97.57, 89.43, 88.69, 83.46, 81.23, 79.17, 77.33, 75.52, 73.36, 71.88]
2024-09-05 21:35:49,674 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.66, 98.59, 98.57, 98.45, 98.23, 98.15, 97.89, 97.33]

Average Accuracy (CNN): 81.76
2024-09-05 21:35:49,674 [trainer.py] => Average Accuracy (CNN): 81.76 

Accuracy Matrix (CNN):
[[97.57 95.55 89.88 80.16 75.3  75.3  71.26 67.21 65.59 63.56]
 [ 0.   82.13 85.51 82.61 81.16 79.23 75.85 71.98 71.5  64.73]
 [ 0.    0.   90.37 90.83 90.37 86.7  84.4  79.36 78.44 78.44]
 [ 0.    0.    0.   80.97 81.78 80.16 79.76 75.3  72.87 72.87]
 [ 0.    0.    0.    0.   78.81 79.18 75.84 74.35 72.86 69.89]
 [ 0.    0.    0.    0.    0.   75.   75.88 73.68 70.61 70.61]
 [ 0.    0.    0.    0.    0.    0.   79.11 77.78 79.56 74.22]
 [ 0.    0.    0.    0.    0.    0.    0.   84.4  83.2  82.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   65.82 64.56]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   77.39]]
2024-09-05 21:35:49,677 [trainer.py] => Forgetting (CNN): 11.027777777777777
2024-09-05 21:35:52,526 [trainer.py] => config: ./exps/l2p_cub_B0_Inc20.json
2024-09-05 21:35:52,526 [trainer.py] => prefix:  
2024-09-05 21:35:52,526 [trainer.py] => dataset: cub
2024-09-05 21:35:52,526 [trainer.py] => memory_size: 0
2024-09-05 21:35:52,526 [trainer.py] => memory_per_class: 0
2024-09-05 21:35:52,526 [trainer.py] => fixed_memory: False
2024-09-05 21:35:52,526 [trainer.py] => shuffle: True
2024-09-05 21:35:52,526 [trainer.py] => init_cls: 10
2024-09-05 21:35:52,526 [trainer.py] => increment: 10
2024-09-05 21:35:52,526 [trainer.py] => model_name: l2p
2024-09-05 21:35:52,526 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-05 21:35:52,526 [trainer.py] => get_original_backbone: True
2024-09-05 21:35:52,526 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 21:35:52,526 [trainer.py] => seed: 1993
2024-09-05 21:35:52,526 [trainer.py] => tuned_epoch: 20
2024-09-05 21:35:52,526 [trainer.py] => init_lr: 0.001875
2024-09-05 21:35:52,526 [trainer.py] => batch_size: 48
2024-09-05 21:35:52,526 [trainer.py] => weight_decay: 0
2024-09-05 21:35:52,526 [trainer.py] => min_lr: 1e-05
2024-09-05 21:35:52,526 [trainer.py] => optimizer: adam
2024-09-05 21:35:52,526 [trainer.py] => scheduler: constant
2024-09-05 21:35:52,527 [trainer.py] => reinit_optimizer: True
2024-09-05 21:35:52,527 [trainer.py] => global_pool: token
2024-09-05 21:35:52,527 [trainer.py] => head_type: prompt
2024-09-05 21:35:52,527 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-05 21:35:52,527 [trainer.py] => pretrained: True
2024-09-05 21:35:52,527 [trainer.py] => drop: 0.0
2024-09-05 21:35:52,527 [trainer.py] => drop_path: 0.0
2024-09-05 21:35:52,527 [trainer.py] => prompt_pool: True
2024-09-05 21:35:52,527 [trainer.py] => size: 10
2024-09-05 21:35:52,527 [trainer.py] => length: 5
2024-09-05 21:35:52,527 [trainer.py] => top_k: 5
2024-09-05 21:35:52,527 [trainer.py] => initializer: uniform
2024-09-05 21:35:52,527 [trainer.py] => prompt_key: True
2024-09-05 21:35:52,527 [trainer.py] => prompt_key_init: uniform
2024-09-05 21:35:52,527 [trainer.py] => use_prompt_mask: False
2024-09-05 21:35:52,527 [trainer.py] => shared_prompt_pool: False
2024-09-05 21:35:52,527 [trainer.py] => shared_prompt_key: False
2024-09-05 21:35:52,527 [trainer.py] => batchwise_prompt: True
2024-09-05 21:35:52,527 [trainer.py] => embedding_key: cls
2024-09-05 21:35:52,527 [trainer.py] => predefined_key: 
2024-09-05 21:35:52,527 [trainer.py] => pull_constraint: True
2024-09-05 21:35:52,527 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-05 21:35:52,565 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 21:35:53,997 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-05 21:35:53,997 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-05 21:35:55,920 [l2p.py] => 86,017,736 model total parameters.
2024-09-05 21:35:55,920 [l2p.py] => 199,880 model training parameters.
2024-09-05 21:35:55,920 [l2p.py] => prompt.prompt: 38400
2024-09-05 21:35:55,920 [l2p.py] => prompt.prompt_key: 7680
2024-09-05 21:35:55,921 [l2p.py] => head.weight: 153600
2024-09-05 21:35:55,921 [l2p.py] => head.bias: 200
2024-09-05 21:35:55,922 [trainer.py] => All params: 171970192
2024-09-05 21:35:55,923 [trainer.py] => Trainable params: 199880
2024-09-05 21:35:55,923 [l2p.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.470, Train_accy 53.65:   0%|          | 0/20 [00:05<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.470, Train_accy 53.65:   5%|▌         | 1/20 [00:05<01:37,  5.15s/it]
Task 0, Epoch 2/20 => Loss 0.410, Train_accy 87.89:   5%|▌         | 1/20 [00:09<01:37,  5.15s/it]
Task 0, Epoch 2/20 => Loss 0.410, Train_accy 87.89:  10%|█         | 2/20 [00:09<01:28,  4.94s/it]
Task 0, Epoch 3/20 => Loss 0.286, Train_accy 90.61:  10%|█         | 2/20 [00:14<01:28,  4.94s/it]
Task 0, Epoch 3/20 => Loss 0.286, Train_accy 90.61:  15%|█▌        | 3/20 [00:14<01:22,  4.87s/it]
Task 0, Epoch 4/20 => Loss 0.210, Train_accy 92.69:  15%|█▌        | 3/20 [00:19<01:22,  4.87s/it]
Task 0, Epoch 4/20 => Loss 0.210, Train_accy 92.69:  20%|██        | 4/20 [00:19<01:17,  4.85s/it]
Task 0, Epoch 5/20 => Loss 0.209, Train_accy 92.07, Test_accy 98.31:  20%|██        | 4/20 [00:25<01:17,  4.85s/it]
Task 0, Epoch 5/20 => Loss 0.209, Train_accy 92.07, Test_accy 98.31:  25%|██▌       | 5/20 [00:25<01:18,  5.26s/it]
Task 0, Epoch 6/20 => Loss 0.218, Train_accy 91.02:  25%|██▌       | 5/20 [00:30<01:18,  5.26s/it]                 
Task 0, Epoch 6/20 => Loss 0.218, Train_accy 91.02:  30%|███       | 6/20 [00:30<01:11,  5.09s/it]
Task 0, Epoch 7/20 => Loss 0.189, Train_accy 92.07:  30%|███       | 6/20 [00:35<01:11,  5.09s/it]
Task 0, Epoch 7/20 => Loss 0.189, Train_accy 92.07:  35%|███▌      | 7/20 [00:35<01:04,  4.99s/it]
Task 0, Epoch 8/20 => Loss 0.136, Train_accy 93.95:  35%|███▌      | 7/20 [00:39<01:04,  4.99s/it]
Task 0, Epoch 8/20 => Loss 0.136, Train_accy 93.95:  40%|████      | 8/20 [00:39<00:59,  4.92s/it]
Task 0, Epoch 9/20 => Loss 0.101, Train_accy 95.41:  40%|████      | 8/20 [00:44<00:59,  4.92s/it]
Task 0, Epoch 9/20 => Loss 0.101, Train_accy 95.41:  45%|████▌     | 9/20 [00:44<00:53,  4.87s/it]
Task 0, Epoch 10/20 => Loss 0.141, Train_accy 94.15, Test_accy 100.00:  45%|████▌     | 9/20 [00:50<00:53,  4.87s/it]
Task 0, Epoch 10/20 => Loss 0.141, Train_accy 94.15, Test_accy 100.00:  50%|█████     | 10/20 [00:50<00:52,  5.21s/it]
Task 0, Epoch 11/20 => Loss 0.100, Train_accy 93.74:  50%|█████     | 10/20 [00:55<00:52,  5.21s/it]                  
Task 0, Epoch 11/20 => Loss 0.100, Train_accy 93.74:  55%|█████▌    | 11/20 [00:55<00:45,  5.08s/it]
Task 0, Epoch 12/20 => Loss 0.163, Train_accy 92.28:  55%|█████▌    | 11/20 [01:00<00:45,  5.08s/it]
Task 0, Epoch 12/20 => Loss 0.163, Train_accy 92.28:  60%|██████    | 12/20 [01:00<00:40,  5.00s/it]
Task 0, Epoch 13/20 => Loss 0.137, Train_accy 93.74:  60%|██████    | 12/20 [01:05<00:40,  5.00s/it]
Task 0, Epoch 13/20 => Loss 0.137, Train_accy 93.74:  65%|██████▌   | 13/20 [01:05<00:34,  4.95s/it]
Task 0, Epoch 14/20 => Loss 0.103, Train_accy 94.15:  65%|██████▌   | 13/20 [01:09<00:34,  4.95s/it]
Task 0, Epoch 14/20 => Loss 0.103, Train_accy 94.15:  70%|███████   | 14/20 [01:09<00:29,  4.90s/it]
Task 0, Epoch 15/20 => Loss 0.094, Train_accy 92.69, Test_accy 99.15:  70%|███████   | 14/20 [01:15<00:29,  4.90s/it]
Task 0, Epoch 15/20 => Loss 0.094, Train_accy 92.69, Test_accy 99.15:  75%|███████▌  | 15/20 [01:15<00:26,  5.23s/it]
Task 0, Epoch 16/20 => Loss 0.037, Train_accy 96.03:  75%|███████▌  | 15/20 [01:20<00:26,  5.23s/it]                 
Task 0, Epoch 16/20 => Loss 0.037, Train_accy 96.03:  80%|████████  | 16/20 [01:20<00:20,  5.09s/it]
Task 0, Epoch 17/20 => Loss 0.090, Train_accy 93.74:  80%|████████  | 16/20 [01:25<00:20,  5.09s/it]
Task 0, Epoch 17/20 => Loss 0.090, Train_accy 93.74:  85%|████████▌ | 17/20 [01:25<00:15,  5.01s/it]
Task 0, Epoch 18/20 => Loss 0.074, Train_accy 93.95:  85%|████████▌ | 17/20 [01:30<00:15,  5.01s/it]
Task 0, Epoch 18/20 => Loss 0.074, Train_accy 93.95:  90%|█████████ | 18/20 [01:30<00:09,  4.95s/it]
Task 0, Epoch 19/20 => Loss 0.076, Train_accy 94.57:  90%|█████████ | 18/20 [01:34<00:09,  4.95s/it]
Task 0, Epoch 19/20 => Loss 0.076, Train_accy 94.57:  95%|█████████▌| 19/20 [01:34<00:04,  4.89s/it]
Task 0, Epoch 20/20 => Loss 0.069, Train_accy 93.95, Test_accy 99.15:  95%|█████████▌| 19/20 [01:40<00:04,  4.89s/it]
Task 0, Epoch 20/20 => Loss 0.069, Train_accy 93.95, Test_accy 99.15: 100%|██████████| 20/20 [01:40<00:00,  5.23s/it]
Task 0, Epoch 20/20 => Loss 0.069, Train_accy 93.95, Test_accy 99.15: 100%|██████████| 20/20 [01:40<00:00,  5.05s/it]
2024-09-05 21:37:37,496 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.069, Train_accy 93.95, Test_accy 99.15
2024-09-05 21:37:38,647 [trainer.py] => No NME accuracy.
2024-09-05 21:37:38,648 [trainer.py] => CNN: {'total': 99.15, '00-09': 99.15, 'old': 0, 'new': 99.15}
2024-09-05 21:37:38,648 [trainer.py] => CNN top1 curve: [99.15]
2024-09-05 21:37:38,648 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.15
2024-09-05 21:37:38,648 [trainer.py] => Average Accuracy (CNN): 99.15 

2024-09-05 21:37:38,650 [trainer.py] => All params: 171970192
2024-09-05 21:37:38,652 [trainer.py] => Trainable params: 199880
2024-09-05 21:37:38,652 [l2p.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.345, Train_accy 53.10:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.345, Train_accy 53.10:   5%|▌         | 1/20 [00:04<01:28,  4.64s/it]
Task 1, Epoch 2/20 => Loss 0.383, Train_accy 81.37:   5%|▌         | 1/20 [00:09<01:28,  4.64s/it]
Task 1, Epoch 2/20 => Loss 0.383, Train_accy 81.37:  10%|█         | 2/20 [00:09<01:23,  4.65s/it]
Task 1, Epoch 3/20 => Loss 0.157, Train_accy 92.08:  10%|█         | 2/20 [00:13<01:23,  4.65s/it]
Task 1, Epoch 3/20 => Loss 0.157, Train_accy 92.08:  15%|█▌        | 3/20 [00:13<01:19,  4.67s/it]
Task 1, Epoch 4/20 => Loss 0.152, Train_accy 91.65:  15%|█▌        | 3/20 [00:18<01:19,  4.67s/it]
Task 1, Epoch 4/20 => Loss 0.152, Train_accy 91.65:  20%|██        | 4/20 [00:18<01:14,  4.68s/it]
Task 1, Epoch 5/20 => Loss 0.102, Train_accy 93.15, Test_accy 89.07:  20%|██        | 4/20 [00:25<01:14,  4.68s/it]
Task 1, Epoch 5/20 => Loss 0.102, Train_accy 93.15, Test_accy 89.07:  25%|██▌       | 5/20 [00:25<01:21,  5.40s/it]
Task 1, Epoch 6/20 => Loss 0.078, Train_accy 94.43:  25%|██▌       | 5/20 [00:30<01:21,  5.40s/it]                 
Task 1, Epoch 6/20 => Loss 0.078, Train_accy 94.43:  30%|███       | 6/20 [00:30<01:12,  5.14s/it]
Task 1, Epoch 7/20 => Loss 0.075, Train_accy 94.00:  30%|███       | 6/20 [00:34<01:12,  5.14s/it]
Task 1, Epoch 7/20 => Loss 0.075, Train_accy 94.00:  35%|███▌      | 7/20 [00:34<01:04,  4.99s/it]
Task 1, Epoch 8/20 => Loss 0.056, Train_accy 93.58:  35%|███▌      | 7/20 [00:39<01:04,  4.99s/it]
Task 1, Epoch 8/20 => Loss 0.056, Train_accy 93.58:  40%|████      | 8/20 [00:39<00:58,  4.89s/it]
Task 1, Epoch 9/20 => Loss 0.034, Train_accy 95.07:  40%|████      | 8/20 [00:44<00:58,  4.89s/it]
Task 1, Epoch 9/20 => Loss 0.034, Train_accy 95.07:  45%|████▌     | 9/20 [00:44<00:53,  4.83s/it]
Task 1, Epoch 10/20 => Loss -0.037, Train_accy 97.64, Test_accy 89.88:  45%|████▌     | 9/20 [00:50<00:53,  4.83s/it]
Task 1, Epoch 10/20 => Loss -0.037, Train_accy 97.64, Test_accy 89.88:  50%|█████     | 10/20 [00:50<00:53,  5.38s/it]
Task 1, Epoch 11/20 => Loss -0.008, Train_accy 95.93:  50%|█████     | 10/20 [00:55<00:53,  5.38s/it]                 
Task 1, Epoch 11/20 => Loss -0.008, Train_accy 95.93:  55%|█████▌    | 11/20 [00:55<00:46,  5.16s/it]
Task 1, Epoch 12/20 => Loss 0.028, Train_accy 95.07:  55%|█████▌    | 11/20 [01:00<00:46,  5.16s/it] 
Task 1, Epoch 12/20 => Loss 0.028, Train_accy 95.07:  60%|██████    | 12/20 [01:00<00:40,  5.03s/it]
Task 1, Epoch 13/20 => Loss 0.072, Train_accy 93.15:  60%|██████    | 12/20 [01:04<00:40,  5.03s/it]
Task 1, Epoch 13/20 => Loss 0.072, Train_accy 93.15:  65%|██████▌   | 13/20 [01:04<00:34,  4.94s/it]
Task 1, Epoch 14/20 => Loss 0.051, Train_accy 94.43:  65%|██████▌   | 13/20 [01:09<00:34,  4.94s/it]
Task 1, Epoch 14/20 => Loss 0.051, Train_accy 94.43:  70%|███████   | 14/20 [01:09<00:29,  4.87s/it]
Task 1, Epoch 15/20 => Loss -0.018, Train_accy 95.93, Test_accy 91.50:  70%|███████   | 14/20 [01:16<00:29,  4.87s/it]
Task 1, Epoch 15/20 => Loss -0.018, Train_accy 95.93, Test_accy 91.50:  75%|███████▌  | 15/20 [01:16<00:27,  5.42s/it]
Task 1, Epoch 16/20 => Loss -0.014, Train_accy 95.50:  75%|███████▌  | 15/20 [01:20<00:27,  5.42s/it]                 
Task 1, Epoch 16/20 => Loss -0.014, Train_accy 95.50:  80%|████████  | 16/20 [01:20<00:20,  5.19s/it]
Task 1, Epoch 17/20 => Loss -0.018, Train_accy 95.50:  80%|████████  | 16/20 [01:25<00:20,  5.19s/it]
Task 1, Epoch 17/20 => Loss -0.018, Train_accy 95.50:  85%|████████▌ | 17/20 [01:25<00:15,  5.05s/it]
Task 1, Epoch 18/20 => Loss 0.001, Train_accy 94.22:  85%|████████▌ | 17/20 [01:30<00:15,  5.05s/it] 
Task 1, Epoch 18/20 => Loss 0.001, Train_accy 94.22:  90%|█████████ | 18/20 [01:30<00:09,  4.94s/it]
Task 1, Epoch 19/20 => Loss 0.056, Train_accy 93.36:  90%|█████████ | 18/20 [01:34<00:09,  4.94s/it]
Task 1, Epoch 19/20 => Loss 0.056, Train_accy 93.36:  95%|█████████▌| 19/20 [01:34<00:04,  4.86s/it]
Task 1, Epoch 20/20 => Loss -0.053, Train_accy 96.57, Test_accy 91.90:  95%|█████████▌| 19/20 [01:41<00:04,  4.86s/it]
Task 1, Epoch 20/20 => Loss -0.053, Train_accy 96.57, Test_accy 91.90: 100%|██████████| 20/20 [01:41<00:00,  5.40s/it]
Task 1, Epoch 20/20 => Loss -0.053, Train_accy 96.57, Test_accy 91.90: 100%|██████████| 20/20 [01:41<00:00,  5.08s/it]
2024-09-05 21:39:20,256 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.053, Train_accy 96.57, Test_accy 91.90
2024-09-05 21:39:22,205 [trainer.py] => No NME accuracy.
2024-09-05 21:39:22,205 [trainer.py] => CNN: {'total': 91.9, '00-09': 97.46, '10-19': 86.82, 'old': 97.46, 'new': 86.82}
2024-09-05 21:39:22,205 [trainer.py] => CNN top1 curve: [99.15, 91.9]
2024-09-05 21:39:22,205 [trainer.py] => CNN top5 curve: [100.0, 99.6]

Average Accuracy (CNN): 95.52
2024-09-05 21:39:22,206 [trainer.py] => Average Accuracy (CNN): 95.52 

2024-09-05 21:39:22,208 [trainer.py] => All params: 171970192
2024-09-05 21:39:22,210 [trainer.py] => Trainable params: 199880
2024-09-05 21:39:22,210 [l2p.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.808, Train_accy 71.43:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.808, Train_accy 71.43:   5%|▌         | 1/20 [00:04<01:30,  4.74s/it]
Task 2, Epoch 2/20 => Loss 0.082, Train_accy 92.86:   5%|▌         | 1/20 [00:09<01:30,  4.74s/it]
Task 2, Epoch 2/20 => Loss 0.082, Train_accy 92.86:  10%|█         | 2/20 [00:09<01:25,  4.75s/it]
Task 2, Epoch 3/20 => Loss -0.011, Train_accy 94.75:  10%|█         | 2/20 [00:14<01:25,  4.75s/it]
Task 2, Epoch 3/20 => Loss -0.011, Train_accy 94.75:  15%|█▌        | 3/20 [00:14<01:20,  4.75s/it]
Task 2, Epoch 4/20 => Loss -0.062, Train_accy 96.22:  15%|█▌        | 3/20 [00:19<01:20,  4.75s/it]
Task 2, Epoch 4/20 => Loss -0.062, Train_accy 96.22:  20%|██        | 4/20 [00:19<01:16,  4.76s/it]
Task 2, Epoch 5/20 => Loss -0.038, Train_accy 95.80, Test_accy 88.95:  20%|██        | 4/20 [00:26<01:16,  4.76s/it]
Task 2, Epoch 5/20 => Loss -0.038, Train_accy 95.80, Test_accy 88.95:  25%|██▌       | 5/20 [00:26<01:25,  5.69s/it]
Task 2, Epoch 6/20 => Loss -0.058, Train_accy 97.06:  25%|██▌       | 5/20 [00:31<01:25,  5.69s/it]                 
Task 2, Epoch 6/20 => Loss -0.058, Train_accy 97.06:  30%|███       | 6/20 [00:31<01:15,  5.37s/it]
Task 2, Epoch 7/20 => Loss -0.034, Train_accy 95.80:  30%|███       | 6/20 [00:35<01:15,  5.37s/it]
Task 2, Epoch 7/20 => Loss -0.034, Train_accy 95.80:  35%|███▌      | 7/20 [00:35<01:07,  5.17s/it]
Task 2, Epoch 8/20 => Loss -0.090, Train_accy 97.06:  35%|███▌      | 7/20 [00:40<01:07,  5.17s/it]
Task 2, Epoch 8/20 => Loss -0.090, Train_accy 97.06:  40%|████      | 8/20 [00:40<01:00,  5.04s/it]
Task 2, Epoch 9/20 => Loss -0.089, Train_accy 97.06:  40%|████      | 8/20 [00:45<01:00,  5.04s/it]
Task 2, Epoch 9/20 => Loss -0.089, Train_accy 97.06:  45%|████▌     | 9/20 [00:45<00:54,  4.95s/it]
Task 2, Epoch 10/20 => Loss -0.099, Train_accy 96.64, Test_accy 90.99:  45%|████▌     | 9/20 [00:52<00:54,  4.95s/it]
Task 2, Epoch 10/20 => Loss -0.099, Train_accy 96.64, Test_accy 90.99:  50%|█████     | 10/20 [00:52<00:56,  5.68s/it]
Task 2, Epoch 11/20 => Loss -0.119, Train_accy 97.48:  50%|█████     | 10/20 [00:57<00:56,  5.68s/it]                 
Task 2, Epoch 11/20 => Loss -0.119, Train_accy 97.48:  55%|█████▌    | 11/20 [00:57<00:48,  5.39s/it]
Task 2, Epoch 12/20 => Loss -0.073, Train_accy 96.85:  55%|█████▌    | 11/20 [01:02<00:48,  5.39s/it]
Task 2, Epoch 12/20 => Loss -0.073, Train_accy 96.85:  60%|██████    | 12/20 [01:02<00:41,  5.19s/it]
Task 2, Epoch 13/20 => Loss -0.084, Train_accy 96.43:  60%|██████    | 12/20 [01:06<00:41,  5.19s/it]
Task 2, Epoch 13/20 => Loss -0.084, Train_accy 96.43:  65%|██████▌   | 13/20 [01:06<00:35,  5.06s/it]
Task 2, Epoch 14/20 => Loss -0.122, Train_accy 97.69:  65%|██████▌   | 13/20 [01:11<00:35,  5.06s/it]
Task 2, Epoch 14/20 => Loss -0.122, Train_accy 97.69:  70%|███████   | 14/20 [01:11<00:29,  4.97s/it]
Task 2, Epoch 15/20 => Loss -0.138, Train_accy 97.48, Test_accy 88.37:  70%|███████   | 14/20 [01:18<00:29,  4.97s/it]
Task 2, Epoch 15/20 => Loss -0.138, Train_accy 97.48, Test_accy 88.37:  75%|███████▌  | 15/20 [01:18<00:28,  5.65s/it]
Task 2, Epoch 16/20 => Loss -0.120, Train_accy 97.27:  75%|███████▌  | 15/20 [01:23<00:28,  5.65s/it]                 
Task 2, Epoch 16/20 => Loss -0.120, Train_accy 97.27:  80%|████████  | 16/20 [01:23<00:21,  5.38s/it]
Task 2, Epoch 17/20 => Loss -0.129, Train_accy 97.27:  80%|████████  | 16/20 [01:28<00:21,  5.38s/it]
Task 2, Epoch 17/20 => Loss -0.129, Train_accy 97.27:  85%|████████▌ | 17/20 [01:28<00:15,  5.19s/it]
Task 2, Epoch 18/20 => Loss -0.121, Train_accy 96.01:  85%|████████▌ | 17/20 [01:33<00:15,  5.19s/it]
Task 2, Epoch 18/20 => Loss -0.121, Train_accy 96.01:  90%|█████████ | 18/20 [01:33<00:10,  5.06s/it]
Task 2, Epoch 19/20 => Loss -0.133, Train_accy 97.27:  90%|█████████ | 18/20 [01:37<00:10,  5.06s/it]
Task 2, Epoch 19/20 => Loss -0.133, Train_accy 97.27:  95%|█████████▌| 19/20 [01:37<00:04,  4.97s/it]
Task 2, Epoch 20/20 => Loss -0.108, Train_accy 95.80, Test_accy 90.70:  95%|█████████▌| 19/20 [01:45<00:04,  4.97s/it]
Task 2, Epoch 20/20 => Loss -0.108, Train_accy 95.80, Test_accy 90.70: 100%|██████████| 20/20 [01:45<00:00,  5.67s/it]
Task 2, Epoch 20/20 => Loss -0.108, Train_accy 95.80, Test_accy 90.70: 100%|██████████| 20/20 [01:45<00:00,  5.26s/it]
2024-09-05 21:41:07,450 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.108, Train_accy 95.80, Test_accy 90.70
2024-09-05 21:41:09,964 [trainer.py] => No NME accuracy.
2024-09-05 21:41:09,965 [trainer.py] => CNN: {'total': 90.7, '00-09': 93.22, '10-19': 86.82, '20-29': 92.78, 'old': 89.88, 'new': 92.78}
2024-09-05 21:41:09,965 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7]
2024-09-05 21:41:09,965 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42]

Average Accuracy (CNN): 93.92
2024-09-05 21:41:09,965 [trainer.py] => Average Accuracy (CNN): 93.92 

2024-09-05 21:41:09,968 [trainer.py] => All params: 171970192
2024-09-05 21:41:09,971 [trainer.py] => Trainable params: 199880
2024-09-05 21:41:09,971 [l2p.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.813, Train_accy 68.66:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.813, Train_accy 68.66:   5%|▌         | 1/20 [00:04<01:29,  4.70s/it]
Task 3, Epoch 2/20 => Loss 0.030, Train_accy 93.60:   5%|▌         | 1/20 [00:09<01:29,  4.70s/it]
Task 3, Epoch 2/20 => Loss 0.030, Train_accy 93.60:  10%|█         | 2/20 [00:09<01:26,  4.82s/it]
Task 3, Epoch 3/20 => Loss -0.011, Train_accy 93.82:  10%|█         | 2/20 [00:14<01:26,  4.82s/it]
Task 3, Epoch 3/20 => Loss -0.011, Train_accy 93.82:  15%|█▌        | 3/20 [00:14<01:21,  4.77s/it]
Task 3, Epoch 4/20 => Loss -0.019, Train_accy 94.67:  15%|█▌        | 3/20 [00:19<01:21,  4.77s/it]
Task 3, Epoch 4/20 => Loss -0.019, Train_accy 94.67:  20%|██        | 4/20 [00:19<01:15,  4.74s/it]
Task 3, Epoch 5/20 => Loss -0.052, Train_accy 95.10, Test_accy 87.22:  20%|██        | 4/20 [00:26<01:15,  4.74s/it]
Task 3, Epoch 5/20 => Loss -0.052, Train_accy 95.10, Test_accy 87.22:  25%|██▌       | 5/20 [00:26<01:28,  5.87s/it]
Task 3, Epoch 6/20 => Loss -0.061, Train_accy 95.31:  25%|██▌       | 5/20 [00:31<01:28,  5.87s/it]                 
Task 3, Epoch 6/20 => Loss -0.061, Train_accy 95.31:  30%|███       | 6/20 [00:31<01:16,  5.47s/it]
Task 3, Epoch 7/20 => Loss -0.070, Train_accy 93.18:  30%|███       | 6/20 [00:36<01:16,  5.47s/it]
Task 3, Epoch 7/20 => Loss -0.070, Train_accy 93.18:  35%|███▌      | 7/20 [00:36<01:07,  5.21s/it]
Task 3, Epoch 8/20 => Loss -0.107, Train_accy 96.80:  35%|███▌      | 7/20 [00:41<01:07,  5.21s/it]
Task 3, Epoch 8/20 => Loss -0.107, Train_accy 96.80:  40%|████      | 8/20 [00:41<01:00,  5.07s/it]
Task 3, Epoch 9/20 => Loss -0.080, Train_accy 94.67:  40%|████      | 8/20 [00:45<01:00,  5.07s/it]
Task 3, Epoch 9/20 => Loss -0.080, Train_accy 94.67:  45%|████▌     | 9/20 [00:45<00:54,  4.95s/it]
Task 3, Epoch 10/20 => Loss -0.092, Train_accy 95.10, Test_accy 88.77:  45%|████▌     | 9/20 [00:53<00:54,  4.95s/it]
Task 3, Epoch 10/20 => Loss -0.092, Train_accy 95.10, Test_accy 88.77:  50%|█████     | 10/20 [00:53<00:58,  5.86s/it]
Task 3, Epoch 11/20 => Loss -0.127, Train_accy 96.80:  50%|█████     | 10/20 [00:58<00:58,  5.86s/it]                 
Task 3, Epoch 11/20 => Loss -0.127, Train_accy 96.80:  55%|█████▌    | 11/20 [00:58<00:49,  5.49s/it]
Task 3, Epoch 12/20 => Loss -0.074, Train_accy 94.88:  55%|█████▌    | 11/20 [01:02<00:49,  5.49s/it]
Task 3, Epoch 12/20 => Loss -0.074, Train_accy 94.88:  60%|██████    | 12/20 [01:02<00:41,  5.25s/it]
Task 3, Epoch 13/20 => Loss -0.139, Train_accy 97.01:  60%|██████    | 12/20 [01:07<00:41,  5.25s/it]
Task 3, Epoch 13/20 => Loss -0.139, Train_accy 97.01:  65%|██████▌   | 13/20 [01:07<00:35,  5.08s/it]
Task 3, Epoch 14/20 => Loss -0.146, Train_accy 97.01:  65%|██████▌   | 13/20 [01:12<00:35,  5.08s/it]
Task 3, Epoch 14/20 => Loss -0.146, Train_accy 97.01:  70%|███████   | 14/20 [01:12<00:29,  4.96s/it]
Task 3, Epoch 15/20 => Loss -0.175, Train_accy 97.65, Test_accy 88.33:  70%|███████   | 14/20 [01:20<00:29,  4.96s/it]
Task 3, Epoch 15/20 => Loss -0.175, Train_accy 97.65, Test_accy 88.33:  75%|███████▌  | 15/20 [01:20<00:29,  5.84s/it]
Task 3, Epoch 16/20 => Loss -0.159, Train_accy 97.87:  75%|███████▌  | 15/20 [01:24<00:29,  5.84s/it]                 
Task 3, Epoch 16/20 => Loss -0.159, Train_accy 97.87:  80%|████████  | 16/20 [01:24<00:21,  5.50s/it]
Task 3, Epoch 17/20 => Loss -0.109, Train_accy 96.16:  80%|████████  | 16/20 [01:29<00:21,  5.50s/it]
Task 3, Epoch 17/20 => Loss -0.109, Train_accy 96.16:  85%|████████▌ | 17/20 [01:29<00:15,  5.25s/it]
Task 3, Epoch 18/20 => Loss -0.171, Train_accy 98.08:  85%|████████▌ | 17/20 [01:34<00:15,  5.25s/it]
Task 3, Epoch 18/20 => Loss -0.171, Train_accy 98.08:  90%|█████████ | 18/20 [01:34<00:10,  5.07s/it]
Task 3, Epoch 19/20 => Loss -0.149, Train_accy 96.80:  90%|█████████ | 18/20 [01:38<00:10,  5.07s/it]
Task 3, Epoch 19/20 => Loss -0.149, Train_accy 96.80:  95%|█████████▌| 19/20 [01:38<00:04,  4.96s/it]
Task 3, Epoch 20/20 => Loss -0.136, Train_accy 96.38, Test_accy 89.43:  95%|█████████▌| 19/20 [01:46<00:04,  4.96s/it]
Task 3, Epoch 20/20 => Loss -0.136, Train_accy 96.38, Test_accy 89.43: 100%|██████████| 20/20 [01:46<00:00,  5.85s/it]
Task 3, Epoch 20/20 => Loss -0.136, Train_accy 96.38, Test_accy 89.43: 100%|██████████| 20/20 [01:46<00:00,  5.34s/it]
2024-09-05 21:42:56,858 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.136, Train_accy 96.38, Test_accy 89.43
2024-09-05 21:43:00,017 [trainer.py] => No NME accuracy.
2024-09-05 21:43:00,018 [trainer.py] => CNN: {'total': 89.43, '00-09': 93.22, '10-19': 86.82, '20-29': 92.78, '30-39': 85.45, 'old': 90.7, 'new': 85.45}
2024-09-05 21:43:00,018 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43]
2024-09-05 21:43:00,018 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12]

Average Accuracy (CNN): 92.8
2024-09-05 21:43:00,018 [trainer.py] => Average Accuracy (CNN): 92.8 

2024-09-05 21:43:00,021 [trainer.py] => All params: 171970192
2024-09-05 21:43:00,023 [trainer.py] => Trainable params: 199880
2024-09-05 21:43:00,023 [l2p.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.754, Train_accy 69.51:   0%|          | 0/20 [00:04<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.754, Train_accy 69.51:   5%|▌         | 1/20 [00:04<01:29,  4.69s/it]
Task 4, Epoch 2/20 => Loss -0.008, Train_accy 92.96:   5%|▌         | 1/20 [00:09<01:29,  4.69s/it]
Task 4, Epoch 2/20 => Loss -0.008, Train_accy 92.96:  10%|█         | 2/20 [00:09<01:24,  4.70s/it]
Task 4, Epoch 3/20 => Loss -0.035, Train_accy 93.18:  10%|█         | 2/20 [00:14<01:24,  4.70s/it]
Task 4, Epoch 3/20 => Loss -0.035, Train_accy 93.18:  15%|█▌        | 3/20 [00:14<01:19,  4.70s/it]
Task 4, Epoch 4/20 => Loss -0.102, Train_accy 95.10:  15%|█▌        | 3/20 [00:18<01:19,  4.70s/it]
Task 4, Epoch 4/20 => Loss -0.102, Train_accy 95.10:  20%|██        | 4/20 [00:18<01:15,  4.70s/it]
Task 4, Epoch 5/20 => Loss -0.034, Train_accy 93.39, Test_accy 87.52:  20%|██        | 4/20 [00:27<01:15,  4.70s/it]
Task 4, Epoch 5/20 => Loss -0.034, Train_accy 93.39, Test_accy 87.52:  25%|██▌       | 5/20 [00:27<01:31,  6.09s/it]
Task 4, Epoch 6/20 => Loss -0.133, Train_accy 96.38:  25%|██▌       | 5/20 [00:32<01:31,  6.09s/it]                 
Task 4, Epoch 6/20 => Loss -0.133, Train_accy 96.38:  30%|███       | 6/20 [00:32<01:18,  5.63s/it]
Task 4, Epoch 7/20 => Loss -0.094, Train_accy 95.10:  30%|███       | 6/20 [00:36<01:18,  5.63s/it]
Task 4, Epoch 7/20 => Loss -0.094, Train_accy 95.10:  35%|███▌      | 7/20 [00:36<01:09,  5.32s/it]
Task 4, Epoch 8/20 => Loss -0.107, Train_accy 95.52:  35%|███▌      | 7/20 [00:41<01:09,  5.32s/it]
Task 4, Epoch 8/20 => Loss -0.107, Train_accy 95.52:  40%|████      | 8/20 [00:41<01:01,  5.11s/it]
Task 4, Epoch 9/20 => Loss -0.153, Train_accy 96.59:  40%|████      | 8/20 [00:46<01:01,  5.11s/it]
Task 4, Epoch 9/20 => Loss -0.153, Train_accy 96.59:  45%|████▌     | 9/20 [00:46<00:54,  4.98s/it]
Task 4, Epoch 10/20 => Loss -0.126, Train_accy 95.74, Test_accy 88.77:  45%|████▌     | 9/20 [00:54<00:54,  4.98s/it]
Task 4, Epoch 10/20 => Loss -0.126, Train_accy 95.74, Test_accy 88.77:  50%|█████     | 10/20 [00:54<01:00,  6.04s/it]
Task 4, Epoch 11/20 => Loss -0.133, Train_accy 95.74:  50%|█████     | 10/20 [00:59<01:00,  6.04s/it]                 
Task 4, Epoch 11/20 => Loss -0.133, Train_accy 95.74:  55%|█████▌    | 11/20 [00:59<00:50,  5.62s/it]
Task 4, Epoch 12/20 => Loss -0.157, Train_accy 95.52:  55%|█████▌    | 11/20 [01:03<00:50,  5.62s/it]
Task 4, Epoch 12/20 => Loss -0.157, Train_accy 95.52:  60%|██████    | 12/20 [01:03<00:42,  5.33s/it]
Task 4, Epoch 13/20 => Loss -0.165, Train_accy 96.80:  60%|██████    | 12/20 [01:08<00:42,  5.33s/it]
Task 4, Epoch 13/20 => Loss -0.165, Train_accy 96.80:  65%|██████▌   | 13/20 [01:08<00:35,  5.13s/it]
Task 4, Epoch 14/20 => Loss -0.149, Train_accy 96.16:  65%|██████▌   | 13/20 [01:13<00:35,  5.13s/it]
Task 4, Epoch 14/20 => Loss -0.149, Train_accy 96.16:  70%|███████   | 14/20 [01:13<00:29,  4.99s/it]
Task 4, Epoch 15/20 => Loss -0.138, Train_accy 95.95, Test_accy 87.52:  70%|███████   | 14/20 [01:21<00:29,  4.99s/it]
Task 4, Epoch 15/20 => Loss -0.138, Train_accy 95.95, Test_accy 87.52:  75%|███████▌  | 15/20 [01:21<00:30,  6.04s/it]
Task 4, Epoch 16/20 => Loss -0.203, Train_accy 97.44:  75%|███████▌  | 15/20 [01:26<00:30,  6.04s/it]                 
Task 4, Epoch 16/20 => Loss -0.203, Train_accy 97.44:  80%|████████  | 16/20 [01:26<00:22,  5.63s/it]
Task 4, Epoch 17/20 => Loss -0.191, Train_accy 97.65:  80%|████████  | 16/20 [01:31<00:22,  5.63s/it]
Task 4, Epoch 17/20 => Loss -0.191, Train_accy 97.65:  85%|████████▌ | 17/20 [01:31<00:16,  5.36s/it]
Task 4, Epoch 18/20 => Loss -0.139, Train_accy 95.74:  85%|████████▌ | 17/20 [01:35<00:16,  5.36s/it]
Task 4, Epoch 18/20 => Loss -0.139, Train_accy 95.74:  90%|█████████ | 18/20 [01:35<00:10,  5.16s/it]
Task 4, Epoch 19/20 => Loss -0.188, Train_accy 97.65:  90%|█████████ | 18/20 [01:40<00:10,  5.16s/it]
Task 4, Epoch 19/20 => Loss -0.188, Train_accy 97.65:  95%|█████████▌| 19/20 [01:40<00:05,  5.01s/it]
Task 4, Epoch 20/20 => Loss -0.139, Train_accy 95.52, Test_accy 88.41:  95%|█████████▌| 19/20 [01:48<00:05,  5.01s/it]
Task 4, Epoch 20/20 => Loss -0.139, Train_accy 95.52, Test_accy 88.41: 100%|██████████| 20/20 [01:48<00:00,  6.05s/it]
Task 4, Epoch 20/20 => Loss -0.139, Train_accy 95.52, Test_accy 88.41: 100%|██████████| 20/20 [01:48<00:00,  5.45s/it]
2024-09-05 21:44:48,965 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.139, Train_accy 95.52, Test_accy 88.41
2024-09-05 21:44:52,779 [trainer.py] => No NME accuracy.
2024-09-05 21:44:52,779 [trainer.py] => CNN: {'total': 88.41, '00-09': 90.68, '10-19': 85.27, '20-29': 93.81, '30-39': 85.45, '40-49': 87.85, 'old': 88.55, 'new': 87.85}
2024-09-05 21:44:52,779 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41]
2024-09-05 21:44:52,779 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11]

Average Accuracy (CNN): 91.92
2024-09-05 21:44:52,780 [trainer.py] => Average Accuracy (CNN): 91.92 

2024-09-05 21:44:52,781 [trainer.py] => All params: 171970192
2024-09-05 21:44:52,783 [trainer.py] => Trainable params: 199880
2024-09-05 21:44:52,783 [l2p.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.961, Train_accy 63.50:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.961, Train_accy 63.50:   5%|▌         | 1/20 [00:04<01:29,  4.71s/it]
Task 5, Epoch 2/20 => Loss 0.074, Train_accy 89.24:   5%|▌         | 1/20 [00:09<01:29,  4.71s/it]
Task 5, Epoch 2/20 => Loss 0.074, Train_accy 89.24:  10%|█         | 2/20 [00:09<01:24,  4.70s/it]
Task 5, Epoch 3/20 => Loss -0.029, Train_accy 93.88:  10%|█         | 2/20 [00:14<01:24,  4.70s/it]
Task 5, Epoch 3/20 => Loss -0.029, Train_accy 93.88:  15%|█▌        | 3/20 [00:14<01:19,  4.70s/it]
Task 5, Epoch 4/20 => Loss -0.095, Train_accy 94.30:  15%|█▌        | 3/20 [00:18<01:19,  4.70s/it]
Task 5, Epoch 4/20 => Loss -0.095, Train_accy 94.30:  20%|██        | 4/20 [00:18<01:15,  4.70s/it]
Task 5, Epoch 5/20 => Loss -0.116, Train_accy 94.73, Test_accy 83.78:  20%|██        | 4/20 [00:27<01:15,  4.70s/it]
Task 5, Epoch 5/20 => Loss -0.116, Train_accy 94.73, Test_accy 83.78:  25%|██▌       | 5/20 [00:27<01:34,  6.30s/it]
Task 5, Epoch 6/20 => Loss -0.077, Train_accy 94.73:  25%|██▌       | 5/20 [00:32<01:34,  6.30s/it]                 
Task 5, Epoch 6/20 => Loss -0.077, Train_accy 94.73:  30%|███       | 6/20 [00:32<01:20,  5.77s/it]
Task 5, Epoch 7/20 => Loss -0.077, Train_accy 93.46:  30%|███       | 6/20 [00:37<01:20,  5.77s/it]
Task 5, Epoch 7/20 => Loss -0.077, Train_accy 93.46:  35%|███▌      | 7/20 [00:37<01:10,  5.44s/it]
Task 5, Epoch 8/20 => Loss -0.101, Train_accy 94.30:  35%|███▌      | 7/20 [00:42<01:10,  5.44s/it]
Task 5, Epoch 8/20 => Loss -0.101, Train_accy 94.30:  40%|████      | 8/20 [00:42<01:02,  5.22s/it]
Task 5, Epoch 9/20 => Loss -0.162, Train_accy 97.05:  40%|████      | 8/20 [00:46<01:02,  5.22s/it]
Task 5, Epoch 9/20 => Loss -0.162, Train_accy 97.05:  45%|████▌     | 9/20 [00:46<00:55,  5.07s/it]
Task 5, Epoch 10/20 => Loss -0.169, Train_accy 97.89, Test_accy 84.08:  45%|████▌     | 9/20 [00:56<00:55,  5.07s/it]
Task 5, Epoch 10/20 => Loss -0.169, Train_accy 97.89, Test_accy 84.08:  50%|█████     | 10/20 [00:56<01:03,  6.33s/it]
Task 5, Epoch 11/20 => Loss -0.129, Train_accy 95.78:  50%|█████     | 10/20 [01:00<01:03,  6.33s/it]                 
Task 5, Epoch 11/20 => Loss -0.129, Train_accy 95.78:  55%|█████▌    | 11/20 [01:00<00:52,  5.84s/it]
Task 5, Epoch 12/20 => Loss -0.111, Train_accy 95.99:  55%|█████▌    | 11/20 [01:05<00:52,  5.84s/it]
Task 5, Epoch 12/20 => Loss -0.111, Train_accy 95.99:  60%|██████    | 12/20 [01:05<00:44,  5.51s/it]
Task 5, Epoch 13/20 => Loss -0.135, Train_accy 95.36:  60%|██████    | 12/20 [01:10<00:44,  5.51s/it]
Task 5, Epoch 13/20 => Loss -0.135, Train_accy 95.36:  65%|██████▌   | 13/20 [01:10<00:36,  5.28s/it]
Task 5, Epoch 14/20 => Loss -0.102, Train_accy 95.36:  65%|██████▌   | 13/20 [01:15<00:36,  5.28s/it]
Task 5, Epoch 14/20 => Loss -0.102, Train_accy 95.36:  70%|███████   | 14/20 [01:15<00:30,  5.11s/it]
Task 5, Epoch 15/20 => Loss -0.164, Train_accy 96.62, Test_accy 84.82:  70%|███████   | 14/20 [01:24<00:30,  5.11s/it]
Task 5, Epoch 15/20 => Loss -0.164, Train_accy 96.62, Test_accy 84.82:  75%|███████▌  | 15/20 [01:24<00:31,  6.34s/it]
Task 5, Epoch 16/20 => Loss -0.185, Train_accy 97.89:  75%|███████▌  | 15/20 [01:28<00:31,  6.34s/it]                 
Task 5, Epoch 16/20 => Loss -0.185, Train_accy 97.89:  80%|████████  | 16/20 [01:28<00:23,  5.85s/it]
Task 5, Epoch 17/20 => Loss -0.076, Train_accy 94.09:  80%|████████  | 16/20 [01:33<00:23,  5.85s/it]
Task 5, Epoch 17/20 => Loss -0.076, Train_accy 94.09:  85%|████████▌ | 17/20 [01:33<00:16,  5.51s/it]
Task 5, Epoch 18/20 => Loss -0.161, Train_accy 97.05:  85%|████████▌ | 17/20 [01:38<00:16,  5.51s/it]
Task 5, Epoch 18/20 => Loss -0.161, Train_accy 97.05:  90%|█████████ | 18/20 [01:38<00:10,  5.27s/it]
Task 5, Epoch 19/20 => Loss -0.164, Train_accy 96.20:  90%|█████████ | 18/20 [01:43<00:10,  5.27s/it]
Task 5, Epoch 19/20 => Loss -0.164, Train_accy 96.20:  95%|█████████▌| 19/20 [01:43<00:05,  5.10s/it]
Task 5, Epoch 20/20 => Loss -0.170, Train_accy 97.47, Test_accy 84.23:  95%|█████████▌| 19/20 [01:52<00:05,  5.10s/it]
Task 5, Epoch 20/20 => Loss -0.170, Train_accy 97.47, Test_accy 84.23: 100%|██████████| 20/20 [01:52<00:00,  6.31s/it]
Task 5, Epoch 20/20 => Loss -0.170, Train_accy 97.47, Test_accy 84.23: 100%|██████████| 20/20 [01:52<00:00,  5.61s/it]
2024-09-05 21:46:45,007 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.170, Train_accy 97.47, Test_accy 84.23
2024-09-05 21:46:49,471 [trainer.py] => No NME accuracy.
2024-09-05 21:46:49,472 [trainer.py] => CNN: {'total': 84.23, '00-09': 75.42, '10-19': 85.27, '20-29': 94.85, '30-39': 79.09, '40-49': 87.85, '50-59': 84.68, 'old': 84.14, 'new': 84.68}
2024-09-05 21:46:49,472 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23]
2024-09-05 21:46:49,472 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36]

Average Accuracy (CNN): 90.64
2024-09-05 21:46:49,472 [trainer.py] => Average Accuracy (CNN): 90.64 

2024-09-05 21:46:49,476 [trainer.py] => All params: 171970192
2024-09-05 21:46:49,478 [trainer.py] => Trainable params: 199880
2024-09-05 21:46:49,478 [l2p.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.778, Train_accy 67.56:   0%|          | 0/20 [00:04<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.778, Train_accy 67.56:   5%|▌         | 1/20 [00:04<01:32,  4.85s/it]
Task 6, Epoch 2/20 => Loss -0.027, Train_accy 93.84:   5%|▌         | 1/20 [00:09<01:32,  4.85s/it]
Task 6, Epoch 2/20 => Loss -0.027, Train_accy 93.84:  10%|█         | 2/20 [00:09<01:27,  4.85s/it]
Task 6, Epoch 3/20 => Loss -0.042, Train_accy 92.40:  10%|█         | 2/20 [00:14<01:27,  4.85s/it]
Task 6, Epoch 3/20 => Loss -0.042, Train_accy 92.40:  15%|█▌        | 3/20 [00:14<01:22,  4.86s/it]
Task 6, Epoch 4/20 => Loss -0.098, Train_accy 94.87:  15%|█▌        | 3/20 [00:19<01:22,  4.86s/it]
Task 6, Epoch 4/20 => Loss -0.098, Train_accy 94.87:  20%|██        | 4/20 [00:19<01:17,  4.86s/it]
Task 6, Epoch 5/20 => Loss -0.106, Train_accy 94.66, Test_accy 81.49:  20%|██        | 4/20 [00:29<01:17,  4.86s/it]
Task 6, Epoch 5/20 => Loss -0.106, Train_accy 94.66, Test_accy 81.49:  25%|██▌       | 5/20 [00:29<01:40,  6.69s/it]
Task 6, Epoch 6/20 => Loss -0.154, Train_accy 96.71:  25%|██▌       | 5/20 [00:34<01:40,  6.69s/it]                 
Task 6, Epoch 6/20 => Loss -0.154, Train_accy 96.71:  30%|███       | 6/20 [00:34<01:24,  6.06s/it]
Task 6, Epoch 7/20 => Loss -0.110, Train_accy 95.69:  30%|███       | 6/20 [00:39<01:24,  6.06s/it]
Task 6, Epoch 7/20 => Loss -0.110, Train_accy 95.69:  35%|███▌      | 7/20 [00:39<01:13,  5.65s/it]
Task 6, Epoch 8/20 => Loss -0.111, Train_accy 96.10:  35%|███▌      | 7/20 [00:43<01:13,  5.65s/it]
Task 6, Epoch 8/20 => Loss -0.111, Train_accy 96.10:  40%|████      | 8/20 [00:43<01:04,  5.41s/it]
Task 6, Epoch 9/20 => Loss -0.103, Train_accy 94.46:  40%|████      | 8/20 [00:48<01:04,  5.41s/it]
Task 6, Epoch 9/20 => Loss -0.103, Train_accy 94.46:  45%|████▌     | 9/20 [00:48<00:57,  5.23s/it]
Task 6, Epoch 10/20 => Loss -0.158, Train_accy 96.51, Test_accy 81.62:  45%|████▌     | 9/20 [00:58<00:57,  5.23s/it]
Task 6, Epoch 10/20 => Loss -0.158, Train_accy 96.51, Test_accy 81.62:  50%|█████     | 10/20 [00:58<01:06,  6.68s/it]
Task 6, Epoch 11/20 => Loss -0.136, Train_accy 95.07:  50%|█████     | 10/20 [01:03<01:06,  6.68s/it]                 
Task 6, Epoch 11/20 => Loss -0.136, Train_accy 95.07:  55%|█████▌    | 11/20 [01:03<00:55,  6.13s/it]
Task 6, Epoch 12/20 => Loss -0.145, Train_accy 95.69:  55%|█████▌    | 11/20 [01:08<00:55,  6.13s/it]
Task 6, Epoch 12/20 => Loss -0.145, Train_accy 95.69:  60%|██████    | 12/20 [01:08<00:45,  5.75s/it]
Task 6, Epoch 13/20 => Loss -0.167, Train_accy 96.30:  60%|██████    | 12/20 [01:13<00:45,  5.75s/it]
Task 6, Epoch 13/20 => Loss -0.167, Train_accy 96.30:  65%|██████▌   | 13/20 [01:13<00:38,  5.47s/it]
Task 6, Epoch 14/20 => Loss -0.185, Train_accy 97.95:  65%|██████▌   | 13/20 [01:18<00:38,  5.47s/it]
Task 6, Epoch 14/20 => Loss -0.185, Train_accy 97.95:  70%|███████   | 14/20 [01:18<00:31,  5.29s/it]
Task 6, Epoch 15/20 => Loss -0.138, Train_accy 96.10, Test_accy 82.39:  70%|███████   | 14/20 [01:28<00:31,  5.29s/it]
Task 6, Epoch 15/20 => Loss -0.138, Train_accy 96.10, Test_accy 82.39:  75%|███████▌  | 15/20 [01:28<00:33,  6.73s/it]
Task 6, Epoch 16/20 => Loss -0.154, Train_accy 96.10:  75%|███████▌  | 15/20 [01:33<00:33,  6.73s/it]                 
Task 6, Epoch 16/20 => Loss -0.154, Train_accy 96.10:  80%|████████  | 16/20 [01:33<00:24,  6.16s/it]
Task 6, Epoch 17/20 => Loss -0.100, Train_accy 95.07:  80%|████████  | 16/20 [01:37<00:24,  6.16s/it]
Task 6, Epoch 17/20 => Loss -0.100, Train_accy 95.07:  85%|████████▌ | 17/20 [01:37<00:17,  5.78s/it]
Task 6, Epoch 18/20 => Loss -0.161, Train_accy 95.69:  85%|████████▌ | 17/20 [01:42<00:17,  5.78s/it]
Task 6, Epoch 18/20 => Loss -0.161, Train_accy 95.69:  90%|█████████ | 18/20 [01:42<00:11,  5.50s/it]
Task 6, Epoch 19/20 => Loss -0.163, Train_accy 96.92:  90%|█████████ | 18/20 [01:47<00:11,  5.50s/it]
Task 6, Epoch 19/20 => Loss -0.163, Train_accy 96.92:  95%|█████████▌| 19/20 [01:47<00:05,  5.31s/it]
Task 6, Epoch 20/20 => Loss -0.167, Train_accy 95.89, Test_accy 82.13:  95%|█████████▌| 19/20 [01:57<00:05,  5.31s/it]
Task 6, Epoch 20/20 => Loss -0.167, Train_accy 95.89, Test_accy 82.13: 100%|██████████| 20/20 [01:57<00:00,  6.69s/it]
Task 6, Epoch 20/20 => Loss -0.167, Train_accy 95.89, Test_accy 82.13: 100%|██████████| 20/20 [01:57<00:00,  5.88s/it]
2024-09-05 21:48:47,030 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.167, Train_accy 95.89, Test_accy 82.13
2024-09-05 21:48:52,090 [trainer.py] => No NME accuracy.
2024-09-05 21:48:52,091 [trainer.py] => CNN: {'total': 82.13, '00-09': 74.58, '10-19': 83.72, '20-29': 93.81, '30-39': 77.27, '40-49': 85.98, '50-59': 82.88, '60-69': 78.3, 'old': 82.74, 'new': 78.3}
2024-09-05 21:48:52,091 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13]
2024-09-05 21:48:52,091 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07]

Average Accuracy (CNN): 89.42
2024-09-05 21:48:52,091 [trainer.py] => Average Accuracy (CNN): 89.42 

2024-09-05 21:48:52,094 [trainer.py] => All params: 171970192
2024-09-05 21:48:52,096 [trainer.py] => Trainable params: 199880
2024-09-05 21:48:52,096 [l2p.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.576, Train_accy 76.47:   0%|          | 0/20 [00:04<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.576, Train_accy 76.47:   5%|▌         | 1/20 [00:04<01:26,  4.55s/it]
Task 7, Epoch 2/20 => Loss -0.078, Train_accy 94.55:   5%|▌         | 1/20 [00:09<01:26,  4.55s/it]
Task 7, Epoch 2/20 => Loss -0.078, Train_accy 94.55:  10%|█         | 2/20 [00:09<01:22,  4.59s/it]
Task 7, Epoch 3/20 => Loss -0.153, Train_accy 96.51:  10%|█         | 2/20 [00:13<01:22,  4.59s/it]
Task 7, Epoch 3/20 => Loss -0.153, Train_accy 96.51:  15%|█▌        | 3/20 [00:13<01:18,  4.59s/it]
Task 7, Epoch 4/20 => Loss -0.134, Train_accy 96.30:  15%|█▌        | 3/20 [00:18<01:18,  4.59s/it]
Task 7, Epoch 4/20 => Loss -0.134, Train_accy 96.30:  20%|██        | 4/20 [00:18<01:13,  4.59s/it]
Task 7, Epoch 5/20 => Loss -0.152, Train_accy 96.73, Test_accy 80.96:  20%|██        | 4/20 [00:28<01:13,  4.59s/it]
Task 7, Epoch 5/20 => Loss -0.152, Train_accy 96.73, Test_accy 80.96:  25%|██▌       | 5/20 [00:28<01:41,  6.75s/it]
Task 7, Epoch 6/20 => Loss -0.149, Train_accy 96.08:  25%|██▌       | 5/20 [00:33<01:41,  6.75s/it]                 
Task 7, Epoch 6/20 => Loss -0.149, Train_accy 96.08:  30%|███       | 6/20 [00:33<01:24,  6.02s/it]
Task 7, Epoch 7/20 => Loss -0.134, Train_accy 95.64:  30%|███       | 6/20 [00:38<01:24,  6.02s/it]
Task 7, Epoch 7/20 => Loss -0.134, Train_accy 95.64:  35%|███▌      | 7/20 [00:38<01:12,  5.56s/it]
Task 7, Epoch 8/20 => Loss -0.173, Train_accy 97.17:  35%|███▌      | 7/20 [00:42<01:12,  5.56s/it]
Task 7, Epoch 8/20 => Loss -0.173, Train_accy 97.17:  40%|████      | 8/20 [00:42<01:03,  5.27s/it]
Task 7, Epoch 9/20 => Loss -0.158, Train_accy 96.73:  40%|████      | 8/20 [00:47<01:03,  5.27s/it]
Task 7, Epoch 9/20 => Loss -0.158, Train_accy 96.73:  45%|████▌     | 9/20 [00:47<00:55,  5.06s/it]
Task 7, Epoch 10/20 => Loss -0.159, Train_accy 96.73, Test_accy 79.76:  45%|████▌     | 9/20 [00:57<00:55,  5.06s/it]
Task 7, Epoch 10/20 => Loss -0.159, Train_accy 96.73, Test_accy 79.76:  50%|█████     | 10/20 [00:57<01:07,  6.75s/it]
Task 7, Epoch 11/20 => Loss -0.181, Train_accy 97.17:  50%|█████     | 10/20 [01:02<01:07,  6.75s/it]                 
Task 7, Epoch 11/20 => Loss -0.181, Train_accy 97.17:  55%|█████▌    | 11/20 [01:02<00:54,  6.09s/it]
Task 7, Epoch 12/20 => Loss -0.172, Train_accy 96.95:  55%|█████▌    | 11/20 [01:07<00:54,  6.09s/it]
Task 7, Epoch 12/20 => Loss -0.172, Train_accy 96.95:  60%|██████    | 12/20 [01:07<00:45,  5.64s/it]
Task 7, Epoch 13/20 => Loss -0.186, Train_accy 97.60:  60%|██████    | 12/20 [01:11<00:45,  5.64s/it]
Task 7, Epoch 13/20 => Loss -0.186, Train_accy 97.60:  65%|██████▌   | 13/20 [01:11<00:37,  5.33s/it]
Task 7, Epoch 14/20 => Loss -0.179, Train_accy 96.30:  65%|██████▌   | 13/20 [01:16<00:37,  5.33s/it]
Task 7, Epoch 14/20 => Loss -0.179, Train_accy 96.30:  70%|███████   | 14/20 [01:16<00:30,  5.10s/it]
Task 7, Epoch 15/20 => Loss -0.191, Train_accy 97.39, Test_accy 79.54:  70%|███████   | 14/20 [01:26<00:30,  5.10s/it]
Task 7, Epoch 15/20 => Loss -0.191, Train_accy 97.39, Test_accy 79.54:  75%|███████▌  | 15/20 [01:26<00:33,  6.73s/it]
Task 7, Epoch 16/20 => Loss -0.187, Train_accy 96.95:  75%|███████▌  | 15/20 [01:31<00:33,  6.73s/it]                 
Task 7, Epoch 16/20 => Loss -0.187, Train_accy 96.95:  80%|████████  | 16/20 [01:31<00:24,  6.08s/it]
Task 7, Epoch 17/20 => Loss -0.170, Train_accy 96.95:  80%|████████  | 16/20 [01:36<00:24,  6.08s/it]
Task 7, Epoch 17/20 => Loss -0.170, Train_accy 96.95:  85%|████████▌ | 17/20 [01:36<00:16,  5.64s/it]
Task 7, Epoch 18/20 => Loss -0.148, Train_accy 96.73:  85%|████████▌ | 17/20 [01:40<00:16,  5.64s/it]
Task 7, Epoch 18/20 => Loss -0.148, Train_accy 96.73:  90%|█████████ | 18/20 [01:40<00:10,  5.33s/it]
Task 7, Epoch 19/20 => Loss -0.170, Train_accy 97.17:  90%|█████████ | 18/20 [01:45<00:10,  5.33s/it]
Task 7, Epoch 19/20 => Loss -0.170, Train_accy 97.17:  95%|█████████▌| 19/20 [01:45<00:05,  5.11s/it]
Task 7, Epoch 20/20 => Loss -0.194, Train_accy 97.82, Test_accy 81.50:  95%|█████████▌| 19/20 [01:55<00:05,  5.11s/it]
Task 7, Epoch 20/20 => Loss -0.194, Train_accy 97.82, Test_accy 81.50: 100%|██████████| 20/20 [01:55<00:00,  6.70s/it]
Task 7, Epoch 20/20 => Loss -0.194, Train_accy 97.82, Test_accy 81.50: 100%|██████████| 20/20 [01:55<00:00,  5.78s/it]
2024-09-05 21:50:47,756 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.194, Train_accy 97.82, Test_accy 81.50
2024-09-05 21:50:53,655 [trainer.py] => No NME accuracy.
2024-09-05 21:50:53,656 [trainer.py] => CNN: {'total': 81.5, '00-09': 72.03, '10-19': 76.74, '20-29': 93.81, '30-39': 78.18, '40-49': 85.98, '50-59': 81.98, '60-69': 78.3, '70-79': 86.52, 'old': 80.59, 'new': 86.52}
2024-09-05 21:50:53,656 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5]
2024-09-05 21:50:53,656 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04]

Average Accuracy (CNN): 88.43
2024-09-05 21:50:53,656 [trainer.py] => Average Accuracy (CNN): 88.43 

2024-09-05 21:50:53,659 [trainer.py] => All params: 171970192
2024-09-05 21:50:53,662 [trainer.py] => Trainable params: 199880
2024-09-05 21:50:53,662 [l2p.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.578, Train_accy 75.27:   0%|          | 0/20 [00:04<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.578, Train_accy 75.27:   5%|▌         | 1/20 [00:04<01:27,  4.63s/it]
Task 8, Epoch 2/20 => Loss -0.019, Train_accy 94.14:   5%|▌         | 1/20 [00:09<01:27,  4.63s/it]
Task 8, Epoch 2/20 => Loss -0.019, Train_accy 94.14:  10%|█         | 2/20 [00:09<01:23,  4.61s/it]
Task 8, Epoch 3/20 => Loss -0.070, Train_accy 94.14:  10%|█         | 2/20 [00:13<01:23,  4.61s/it]
Task 8, Epoch 3/20 => Loss -0.070, Train_accy 94.14:  15%|█▌        | 3/20 [00:13<01:18,  4.64s/it]
Task 8, Epoch 4/20 => Loss -0.088, Train_accy 95.01:  15%|█▌        | 3/20 [00:18<01:18,  4.64s/it]
Task 8, Epoch 4/20 => Loss -0.088, Train_accy 95.01:  20%|██        | 4/20 [00:18<01:14,  4.64s/it]
Task 8, Epoch 5/20 => Loss -0.177, Train_accy 96.96, Test_accy 77.85:  20%|██        | 4/20 [00:29<01:14,  4.64s/it]
Task 8, Epoch 5/20 => Loss -0.177, Train_accy 96.96, Test_accy 77.85:  25%|██▌       | 5/20 [00:29<01:45,  7.03s/it]
Task 8, Epoch 6/20 => Loss -0.163, Train_accy 97.18:  25%|██▌       | 5/20 [00:34<01:45,  7.03s/it]                 
Task 8, Epoch 6/20 => Loss -0.163, Train_accy 97.18:  30%|███       | 6/20 [00:34<01:26,  6.20s/it]
Task 8, Epoch 7/20 => Loss -0.098, Train_accy 93.71:  30%|███       | 6/20 [00:39<01:26,  6.20s/it]
Task 8, Epoch 7/20 => Loss -0.098, Train_accy 93.71:  35%|███▌      | 7/20 [00:39<01:13,  5.69s/it]
Task 8, Epoch 8/20 => Loss -0.144, Train_accy 95.66:  35%|███▌      | 7/20 [00:43<01:13,  5.69s/it]
Task 8, Epoch 8/20 => Loss -0.144, Train_accy 95.66:  40%|████      | 8/20 [00:43<01:04,  5.34s/it]
Task 8, Epoch 9/20 => Loss -0.147, Train_accy 95.23:  40%|████      | 8/20 [00:48<01:04,  5.34s/it]
Task 8, Epoch 9/20 => Loss -0.147, Train_accy 95.23:  45%|████▌     | 9/20 [00:48<00:56,  5.11s/it]
Task 8, Epoch 10/20 => Loss -0.139, Train_accy 95.23, Test_accy 77.57:  45%|████▌     | 9/20 [00:59<00:56,  5.11s/it]
Task 8, Epoch 10/20 => Loss -0.139, Train_accy 95.23, Test_accy 77.57:  50%|█████     | 10/20 [00:59<01:10,  7.01s/it]
Task 8, Epoch 11/20 => Loss -0.171, Train_accy 97.18:  50%|█████     | 10/20 [01:04<01:10,  7.01s/it]                 
Task 8, Epoch 11/20 => Loss -0.171, Train_accy 97.18:  55%|█████▌    | 11/20 [01:04<00:56,  6.28s/it]
Task 8, Epoch 12/20 => Loss -0.150, Train_accy 96.10:  55%|█████▌    | 11/20 [01:08<00:56,  6.28s/it]
Task 8, Epoch 12/20 => Loss -0.150, Train_accy 96.10:  60%|██████    | 12/20 [01:08<00:46,  5.78s/it]
Task 8, Epoch 13/20 => Loss -0.145, Train_accy 96.31:  60%|██████    | 12/20 [01:13<00:46,  5.78s/it]
Task 8, Epoch 13/20 => Loss -0.145, Train_accy 96.31:  65%|██████▌   | 13/20 [01:13<00:38,  5.43s/it]
Task 8, Epoch 14/20 => Loss -0.118, Train_accy 94.79:  65%|██████▌   | 13/20 [01:18<00:38,  5.43s/it]
Task 8, Epoch 14/20 => Loss -0.118, Train_accy 94.79:  70%|███████   | 14/20 [01:18<00:31,  5.20s/it]
Task 8, Epoch 15/20 => Loss -0.100, Train_accy 94.14, Test_accy 78.04:  70%|███████   | 14/20 [01:29<00:31,  5.20s/it]
Task 8, Epoch 15/20 => Loss -0.100, Train_accy 94.14, Test_accy 78.04:  75%|███████▌  | 15/20 [01:29<00:35,  7.05s/it]
Task 8, Epoch 16/20 => Loss -0.142, Train_accy 95.23:  75%|███████▌  | 15/20 [01:34<00:35,  7.05s/it]                 
Task 8, Epoch 16/20 => Loss -0.142, Train_accy 95.23:  80%|████████  | 16/20 [01:34<00:25,  6.32s/it]
Task 8, Epoch 17/20 => Loss -0.156, Train_accy 96.75:  80%|████████  | 16/20 [01:38<00:25,  6.32s/it]
Task 8, Epoch 17/20 => Loss -0.156, Train_accy 96.75:  85%|████████▌ | 17/20 [01:38<00:17,  5.81s/it]
Task 8, Epoch 18/20 => Loss -0.093, Train_accy 95.23:  85%|████████▌ | 17/20 [01:43<00:17,  5.81s/it]
Task 8, Epoch 18/20 => Loss -0.093, Train_accy 95.23:  90%|█████████ | 18/20 [01:43<00:10,  5.45s/it]
Task 8, Epoch 19/20 => Loss -0.130, Train_accy 95.44:  90%|█████████ | 18/20 [01:47<00:10,  5.45s/it]
Task 8, Epoch 19/20 => Loss -0.130, Train_accy 95.44:  95%|█████████▌| 19/20 [01:47<00:05,  5.20s/it]
Task 8, Epoch 20/20 => Loss -0.168, Train_accy 97.18, Test_accy 78.52:  95%|█████████▌| 19/20 [01:59<00:05,  5.20s/it]
Task 8, Epoch 20/20 => Loss -0.168, Train_accy 97.18, Test_accy 78.52: 100%|██████████| 20/20 [01:59<00:00,  7.04s/it]
Task 8, Epoch 20/20 => Loss -0.168, Train_accy 97.18, Test_accy 78.52: 100%|██████████| 20/20 [01:59<00:00,  5.96s/it]
2024-09-05 21:52:52,863 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.168, Train_accy 97.18, Test_accy 78.52
2024-09-05 21:52:59,583 [trainer.py] => No NME accuracy.
2024-09-05 21:52:59,584 [trainer.py] => CNN: {'total': 78.52, '00-09': 68.64, '10-19': 58.14, '20-29': 94.85, '30-39': 76.36, '40-49': 85.98, '50-59': 81.98, '60-69': 79.25, '70-79': 84.4, '80-89': 81.2, 'old': 78.13, 'new': 81.2}
2024-09-05 21:52:59,584 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52]
2024-09-05 21:52:59,584 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29]

Average Accuracy (CNN): 87.33
2024-09-05 21:52:59,584 [trainer.py] => Average Accuracy (CNN): 87.33 

2024-09-05 21:52:59,587 [trainer.py] => All params: 171970192
2024-09-05 21:52:59,589 [trainer.py] => Trainable params: 199880
2024-09-05 21:52:59,589 [l2p.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.647, Train_accy 68.87:   0%|          | 0/20 [00:04<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.647, Train_accy 68.87:   5%|▌         | 1/20 [00:04<01:26,  4.54s/it]
Task 9, Epoch 2/20 => Loss -0.009, Train_accy 90.07:   5%|▌         | 1/20 [00:09<01:26,  4.54s/it]
Task 9, Epoch 2/20 => Loss -0.009, Train_accy 90.07:  10%|█         | 2/20 [00:09<01:21,  4.54s/it]
Task 9, Epoch 3/20 => Loss -0.069, Train_accy 93.82:  10%|█         | 2/20 [00:13<01:21,  4.54s/it]
Task 9, Epoch 3/20 => Loss -0.069, Train_accy 93.82:  15%|█▌        | 3/20 [00:13<01:17,  4.55s/it]
Task 9, Epoch 4/20 => Loss -0.117, Train_accy 94.04:  15%|█▌        | 3/20 [00:18<01:17,  4.55s/it]
Task 9, Epoch 4/20 => Loss -0.117, Train_accy 94.04:  20%|██        | 4/20 [00:18<01:12,  4.55s/it]
Task 9, Epoch 5/20 => Loss -0.076, Train_accy 92.94, Test_accy 75.51:  20%|██        | 4/20 [00:30<01:12,  4.55s/it]
Task 9, Epoch 5/20 => Loss -0.076, Train_accy 92.94, Test_accy 75.51:  25%|██▌       | 5/20 [00:30<01:48,  7.24s/it]
Task 9, Epoch 6/20 => Loss -0.092, Train_accy 93.60:  25%|██▌       | 5/20 [00:34<01:48,  7.24s/it]                 
Task 9, Epoch 6/20 => Loss -0.092, Train_accy 93.60:  30%|███       | 6/20 [00:34<01:28,  6.33s/it]
Task 9, Epoch 7/20 => Loss -0.082, Train_accy 93.82:  30%|███       | 6/20 [00:39<01:28,  6.33s/it]
Task 9, Epoch 7/20 => Loss -0.082, Train_accy 93.82:  35%|███▌      | 7/20 [00:39<01:14,  5.75s/it]
Task 9, Epoch 8/20 => Loss -0.098, Train_accy 93.82:  35%|███▌      | 7/20 [00:43<01:14,  5.75s/it]
Task 9, Epoch 8/20 => Loss -0.098, Train_accy 93.82:  40%|████      | 8/20 [00:43<01:04,  5.36s/it]
Task 9, Epoch 9/20 => Loss -0.140, Train_accy 95.14:  40%|████      | 8/20 [00:48<01:04,  5.36s/it]
Task 9, Epoch 9/20 => Loss -0.140, Train_accy 95.14:  45%|████▌     | 9/20 [00:48<00:56,  5.11s/it]
Task 9, Epoch 10/20 => Loss -0.143, Train_accy 96.03, Test_accy 75.93:  45%|████▌     | 9/20 [01:00<00:56,  5.11s/it]
Task 9, Epoch 10/20 => Loss -0.143, Train_accy 96.03, Test_accy 75.93:  50%|█████     | 10/20 [01:00<01:12,  7.24s/it]
Task 9, Epoch 11/20 => Loss -0.188, Train_accy 98.23:  50%|█████     | 10/20 [01:04<01:12,  7.24s/it]                 
Task 9, Epoch 11/20 => Loss -0.188, Train_accy 98.23:  55%|█████▌    | 11/20 [01:04<00:57,  6.42s/it]
Task 9, Epoch 12/20 => Loss -0.173, Train_accy 96.47:  55%|█████▌    | 11/20 [01:09<00:57,  6.42s/it]
Task 9, Epoch 12/20 => Loss -0.173, Train_accy 96.47:  60%|██████    | 12/20 [01:09<00:46,  5.85s/it]
Task 9, Epoch 13/20 => Loss -0.118, Train_accy 94.92:  60%|██████    | 12/20 [01:14<00:46,  5.85s/it]
Task 9, Epoch 13/20 => Loss -0.118, Train_accy 94.92:  65%|██████▌   | 13/20 [01:14<00:38,  5.45s/it]
Task 9, Epoch 14/20 => Loss -0.162, Train_accy 96.25:  65%|██████▌   | 13/20 [01:18<00:38,  5.45s/it]
Task 9, Epoch 14/20 => Loss -0.162, Train_accy 96.25:  70%|███████   | 14/20 [01:18<00:31,  5.18s/it]
Task 9, Epoch 15/20 => Loss -0.141, Train_accy 95.81, Test_accy 76.77:  70%|███████   | 14/20 [01:30<00:31,  5.18s/it]
Task 9, Epoch 15/20 => Loss -0.141, Train_accy 95.81, Test_accy 76.77:  75%|███████▌  | 15/20 [01:30<00:36,  7.24s/it]
Task 9, Epoch 16/20 => Loss -0.150, Train_accy 95.14:  75%|███████▌  | 15/20 [01:35<00:36,  7.24s/it]                 
Task 9, Epoch 16/20 => Loss -0.150, Train_accy 95.14:  80%|████████  | 16/20 [01:35<00:25,  6.43s/it]
Task 9, Epoch 17/20 => Loss -0.178, Train_accy 97.13:  80%|████████  | 16/20 [01:39<00:25,  6.43s/it]
Task 9, Epoch 17/20 => Loss -0.178, Train_accy 97.13:  85%|████████▌ | 17/20 [01:39<00:17,  5.87s/it]
Task 9, Epoch 18/20 => Loss -0.190, Train_accy 97.35:  85%|████████▌ | 17/20 [01:44<00:17,  5.87s/it]
Task 9, Epoch 18/20 => Loss -0.190, Train_accy 97.35:  90%|█████████ | 18/20 [01:44<00:10,  5.47s/it]
Task 9, Epoch 19/20 => Loss -0.186, Train_accy 96.91:  90%|█████████ | 18/20 [01:48<00:10,  5.47s/it]
Task 9, Epoch 19/20 => Loss -0.186, Train_accy 96.91:  95%|█████████▌| 19/20 [01:48<00:05,  5.21s/it]
Task 9, Epoch 20/20 => Loss -0.153, Train_accy 97.13, Test_accy 77.19:  95%|█████████▌| 19/20 [02:00<00:05,  5.21s/it]
Task 9, Epoch 20/20 => Loss -0.153, Train_accy 97.13, Test_accy 77.19: 100%|██████████| 20/20 [02:00<00:00,  7.24s/it]
Task 9, Epoch 20/20 => Loss -0.153, Train_accy 97.13, Test_accy 77.19: 100%|██████████| 20/20 [02:00<00:00,  6.04s/it]
2024-09-05 21:55:00,459 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.153, Train_accy 97.13, Test_accy 77.19
2024-09-05 21:55:07,901 [trainer.py] => No NME accuracy.
2024-09-05 21:55:07,901 [trainer.py] => CNN: {'total': 77.19, '00-09': 68.64, '10-19': 58.14, '20-29': 94.85, '30-39': 76.36, '40-49': 85.98, '50-59': 81.98, '60-69': 79.25, '70-79': 79.43, '80-89': 80.45, '90-99': 72.79, 'old': 77.76, 'new': 72.79}
2024-09-05 21:55:07,901 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19]
2024-09-05 21:55:07,901 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15]

Average Accuracy (CNN): 86.32
2024-09-05 21:55:07,902 [trainer.py] => Average Accuracy (CNN): 86.32 

2024-09-05 21:55:07,904 [trainer.py] => All params: 171970192
2024-09-05 21:55:07,906 [trainer.py] => Trainable params: 199880
2024-09-05 21:55:07,906 [l2p.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.653, Train_accy 73.60:   0%|          | 0/20 [00:04<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.653, Train_accy 73.60:   5%|▌         | 1/20 [00:04<01:32,  4.85s/it]
Task 10, Epoch 2/20 => Loss -0.114, Train_accy 95.43:   5%|▌         | 1/20 [00:09<01:32,  4.85s/it]
Task 10, Epoch 2/20 => Loss -0.114, Train_accy 95.43:  10%|█         | 2/20 [00:09<01:26,  4.82s/it]
Task 10, Epoch 3/20 => Loss -0.151, Train_accy 96.05:  10%|█         | 2/20 [00:14<01:26,  4.82s/it]
Task 10, Epoch 3/20 => Loss -0.151, Train_accy 96.05:  15%|█▌        | 3/20 [00:14<01:21,  4.82s/it]
Task 10, Epoch 4/20 => Loss -0.144, Train_accy 96.05:  15%|█▌        | 3/20 [00:19<01:21,  4.82s/it]
Task 10, Epoch 4/20 => Loss -0.144, Train_accy 96.05:  20%|██        | 4/20 [00:19<01:17,  4.82s/it]
Task 10, Epoch 5/20 => Loss -0.163, Train_accy 96.47, Test_accy 76.75:  20%|██        | 4/20 [00:32<01:17,  4.82s/it]
Task 10, Epoch 5/20 => Loss -0.163, Train_accy 96.47, Test_accy 76.75:  25%|██▌       | 5/20 [00:32<01:56,  7.78s/it]
Task 10, Epoch 6/20 => Loss -0.161, Train_accy 96.88:  25%|██▌       | 5/20 [00:37<01:56,  7.78s/it]                 
Task 10, Epoch 6/20 => Loss -0.161, Train_accy 96.88:  30%|███       | 6/20 [00:37<01:34,  6.77s/it]
Task 10, Epoch 7/20 => Loss -0.195, Train_accy 97.51:  30%|███       | 6/20 [00:41<01:34,  6.77s/it]
Task 10, Epoch 7/20 => Loss -0.195, Train_accy 97.51:  35%|███▌      | 7/20 [00:41<01:19,  6.13s/it]
Task 10, Epoch 8/20 => Loss -0.197, Train_accy 97.71:  35%|███▌      | 7/20 [00:46<01:19,  6.13s/it]
Task 10, Epoch 8/20 => Loss -0.197, Train_accy 97.71:  40%|████      | 8/20 [00:46<01:08,  5.73s/it]
Task 10, Epoch 9/20 => Loss -0.198, Train_accy 97.51:  40%|████      | 8/20 [00:51<01:08,  5.73s/it]
Task 10, Epoch 9/20 => Loss -0.198, Train_accy 97.51:  45%|████▌     | 9/20 [00:51<00:59,  5.45s/it]
Task 10, Epoch 10/20 => Loss -0.143, Train_accy 96.05, Test_accy 77.51:  45%|████▌     | 9/20 [01:04<00:59,  5.45s/it]
Task 10, Epoch 10/20 => Loss -0.143, Train_accy 96.05, Test_accy 77.51:  50%|█████     | 10/20 [01:04<01:17,  7.78s/it]
Task 10, Epoch 11/20 => Loss -0.086, Train_accy 95.43:  50%|█████     | 10/20 [01:09<01:17,  7.78s/it]                 
Task 10, Epoch 11/20 => Loss -0.086, Train_accy 95.43:  55%|█████▌    | 11/20 [01:09<01:01,  6.88s/it]
Task 10, Epoch 12/20 => Loss -0.121, Train_accy 95.01:  55%|█████▌    | 11/20 [01:14<01:01,  6.88s/it]
Task 10, Epoch 12/20 => Loss -0.121, Train_accy 95.01:  60%|██████    | 12/20 [01:14<00:50,  6.25s/it]
Task 10, Epoch 13/20 => Loss -0.145, Train_accy 95.43:  60%|██████    | 12/20 [01:19<00:50,  6.25s/it]
Task 10, Epoch 13/20 => Loss -0.145, Train_accy 95.43:  65%|██████▌   | 13/20 [01:19<00:40,  5.81s/it]
Task 10, Epoch 14/20 => Loss -0.172, Train_accy 96.47:  65%|██████▌   | 13/20 [01:23<00:40,  5.81s/it]
Task 10, Epoch 14/20 => Loss -0.172, Train_accy 96.47:  70%|███████   | 14/20 [01:23<00:33,  5.51s/it]
Task 10, Epoch 15/20 => Loss -0.198, Train_accy 97.51, Test_accy 76.44:  70%|███████   | 14/20 [01:36<00:33,  5.51s/it]
Task 10, Epoch 15/20 => Loss -0.198, Train_accy 97.51, Test_accy 76.44:  75%|███████▌  | 15/20 [01:36<00:38,  7.75s/it]
Task 10, Epoch 16/20 => Loss -0.137, Train_accy 98.34:  75%|███████▌  | 15/20 [01:41<00:38,  7.75s/it]                 
Task 10, Epoch 16/20 => Loss -0.137, Train_accy 98.34:  80%|████████  | 16/20 [01:41<00:27,  6.86s/it]
Task 10, Epoch 17/20 => Loss -0.140, Train_accy 97.30:  80%|████████  | 16/20 [01:46<00:27,  6.86s/it]
Task 10, Epoch 17/20 => Loss -0.140, Train_accy 97.30:  85%|████████▌ | 17/20 [01:46<00:18,  6.26s/it]
Task 10, Epoch 18/20 => Loss -0.093, Train_accy 95.01:  85%|████████▌ | 17/20 [01:51<00:18,  6.26s/it]
Task 10, Epoch 18/20 => Loss -0.093, Train_accy 95.01:  90%|█████████ | 18/20 [01:51<00:11,  5.83s/it]
Task 10, Epoch 19/20 => Loss -0.167, Train_accy 96.47:  90%|█████████ | 18/20 [01:56<00:11,  5.83s/it]
Task 10, Epoch 19/20 => Loss -0.167, Train_accy 96.47:  95%|█████████▌| 19/20 [01:56<00:05,  5.53s/it]
Task 10, Epoch 20/20 => Loss -0.149, Train_accy 96.88, Test_accy 75.44:  95%|█████████▌| 19/20 [02:09<00:05,  5.53s/it]
Task 10, Epoch 20/20 => Loss -0.149, Train_accy 96.88, Test_accy 75.44: 100%|██████████| 20/20 [02:09<00:00,  7.76s/it]
Task 10, Epoch 20/20 => Loss -0.149, Train_accy 96.88, Test_accy 75.44: 100%|██████████| 20/20 [02:09<00:00,  6.46s/it]
2024-09-05 21:57:17,044 [l2p.py] => Task 10, Epoch 20/20 => Loss -0.149, Train_accy 96.88, Test_accy 75.44
2024-09-05 21:57:25,221 [trainer.py] => No NME accuracy.
2024-09-05 21:57:25,222 [trainer.py] => CNN: {'total': 75.44, '00-09': 66.95, '10-19': 51.16, '20-29': 93.81, '30-39': 74.55, '40-49': 78.5, '50-59': 74.77, '60-69': 80.19, '70-79': 78.01, '80-89': 78.2, '90-99': 72.06, '100-109': 87.83, 'old': 74.24, 'new': 87.83}
2024-09-05 21:57:25,222 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44]
2024-09-05 21:57:25,222 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77]

Average Accuracy (CNN): 85.33
2024-09-05 21:57:25,223 [trainer.py] => Average Accuracy (CNN): 85.33 

2024-09-05 21:57:25,226 [trainer.py] => All params: 171970192
2024-09-05 21:57:25,229 [trainer.py] => Trainable params: 199880
2024-09-05 21:57:25,229 [l2p.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.546, Train_accy 74.52:   0%|          | 0/20 [00:04<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.546, Train_accy 74.52:   5%|▌         | 1/20 [00:04<01:29,  4.71s/it]
Task 11, Epoch 2/20 => Loss -0.114, Train_accy 96.39:   5%|▌         | 1/20 [00:09<01:29,  4.71s/it]
Task 11, Epoch 2/20 => Loss -0.114, Train_accy 96.39:  10%|█         | 2/20 [00:09<01:24,  4.70s/it]
Task 11, Epoch 3/20 => Loss -0.139, Train_accy 96.82:  10%|█         | 2/20 [00:14<01:24,  4.70s/it]
Task 11, Epoch 3/20 => Loss -0.139, Train_accy 96.82:  15%|█▌        | 3/20 [00:14<01:19,  4.69s/it]
Task 11, Epoch 4/20 => Loss -0.165, Train_accy 97.88:  15%|█▌        | 3/20 [00:18<01:19,  4.69s/it]
Task 11, Epoch 4/20 => Loss -0.165, Train_accy 97.88:  20%|██        | 4/20 [00:18<01:15,  4.70s/it]
Task 11, Epoch 5/20 => Loss -0.171, Train_accy 97.24, Test_accy 74.44:  20%|██        | 4/20 [00:32<01:15,  4.70s/it]
Task 11, Epoch 5/20 => Loss -0.171, Train_accy 97.24, Test_accy 74.44:  25%|██▌       | 5/20 [00:32<01:58,  7.89s/it]
Task 11, Epoch 6/20 => Loss -0.156, Train_accy 97.24:  25%|██▌       | 5/20 [00:37<01:58,  7.89s/it]                 
Task 11, Epoch 6/20 => Loss -0.156, Train_accy 97.24:  30%|███       | 6/20 [00:37<01:35,  6.81s/it]
Task 11, Epoch 7/20 => Loss -0.163, Train_accy 97.03:  30%|███       | 6/20 [00:41<01:35,  6.81s/it]
Task 11, Epoch 7/20 => Loss -0.163, Train_accy 97.03:  35%|███▌      | 7/20 [00:41<01:19,  6.12s/it]
Task 11, Epoch 8/20 => Loss -0.172, Train_accy 97.66:  35%|███▌      | 7/20 [00:46<01:19,  6.12s/it]
Task 11, Epoch 8/20 => Loss -0.172, Train_accy 97.66:  40%|████      | 8/20 [00:46<01:08,  5.68s/it]
Task 11, Epoch 9/20 => Loss -0.178, Train_accy 97.45:  40%|████      | 8/20 [00:51<01:08,  5.68s/it]
Task 11, Epoch 9/20 => Loss -0.178, Train_accy 97.45:  45%|████▌     | 9/20 [00:51<00:59,  5.39s/it]
Task 11, Epoch 10/20 => Loss -0.190, Train_accy 97.88, Test_accy 75.00:  45%|████▌     | 9/20 [01:04<00:59,  5.39s/it]
Task 11, Epoch 10/20 => Loss -0.190, Train_accy 97.88, Test_accy 75.00:  50%|█████     | 10/20 [01:04<01:19,  7.94s/it]
Task 11, Epoch 11/20 => Loss -0.193, Train_accy 97.66:  50%|█████     | 10/20 [01:09<01:19,  7.94s/it]                 
Task 11, Epoch 11/20 => Loss -0.193, Train_accy 97.66:  55%|█████▌    | 11/20 [01:09<01:02,  6.96s/it]
Task 11, Epoch 12/20 => Loss -0.184, Train_accy 98.09:  55%|█████▌    | 11/20 [01:14<01:02,  6.96s/it]
Task 11, Epoch 12/20 => Loss -0.184, Train_accy 98.09:  60%|██████    | 12/20 [01:14<00:50,  6.27s/it]
Task 11, Epoch 13/20 => Loss -0.209, Train_accy 98.94:  60%|██████    | 12/20 [01:19<00:50,  6.27s/it]
Task 11, Epoch 13/20 => Loss -0.209, Train_accy 98.94:  65%|██████▌   | 13/20 [01:19<00:40,  5.79s/it]
Task 11, Epoch 14/20 => Loss -0.177, Train_accy 96.82:  65%|██████▌   | 13/20 [01:23<00:40,  5.79s/it]
Task 11, Epoch 14/20 => Loss -0.177, Train_accy 96.82:  70%|███████   | 14/20 [01:23<00:32,  5.46s/it]
Task 11, Epoch 15/20 => Loss -0.200, Train_accy 97.66, Test_accy 74.65:  70%|███████   | 14/20 [01:37<00:32,  5.46s/it]
Task 11, Epoch 15/20 => Loss -0.200, Train_accy 97.66, Test_accy 74.65:  75%|███████▌  | 15/20 [01:37<00:39,  7.88s/it]
Task 11, Epoch 16/20 => Loss -0.201, Train_accy 97.88:  75%|███████▌  | 15/20 [01:41<00:39,  7.88s/it]                 
Task 11, Epoch 16/20 => Loss -0.201, Train_accy 97.88:  80%|████████  | 16/20 [01:41<00:27,  6.93s/it]
Task 11, Epoch 17/20 => Loss -0.182, Train_accy 97.03:  80%|████████  | 16/20 [01:46<00:27,  6.93s/it]
Task 11, Epoch 17/20 => Loss -0.182, Train_accy 97.03:  85%|████████▌ | 17/20 [01:46<00:18,  6.26s/it]
Task 11, Epoch 18/20 => Loss -0.207, Train_accy 98.30:  85%|████████▌ | 17/20 [01:51<00:18,  6.26s/it]
Task 11, Epoch 18/20 => Loss -0.207, Train_accy 98.30:  90%|█████████ | 18/20 [01:51<00:11,  5.80s/it]
Task 11, Epoch 19/20 => Loss -0.225, Train_accy 99.36:  90%|█████████ | 18/20 [01:56<00:11,  5.80s/it]
Task 11, Epoch 19/20 => Loss -0.225, Train_accy 99.36:  95%|█████████▌| 19/20 [01:56<00:05,  5.49s/it]
Task 11, Epoch 20/20 => Loss -0.182, Train_accy 97.45, Test_accy 74.72:  95%|█████████▌| 19/20 [02:09<00:05,  5.49s/it]
Task 11, Epoch 20/20 => Loss -0.182, Train_accy 97.45, Test_accy 74.72: 100%|██████████| 20/20 [02:09<00:00,  7.93s/it]
Task 11, Epoch 20/20 => Loss -0.182, Train_accy 97.45, Test_accy 74.72: 100%|██████████| 20/20 [02:09<00:00,  6.49s/it]
2024-09-05 21:59:34,976 [l2p.py] => Task 11, Epoch 20/20 => Loss -0.182, Train_accy 97.45, Test_accy 74.72
2024-09-05 21:59:43,825 [trainer.py] => No NME accuracy.
2024-09-05 21:59:43,826 [trainer.py] => CNN: {'total': 74.72, '00-09': 65.25, '10-19': 48.84, '20-29': 93.81, '30-39': 74.55, '40-49': 77.57, '50-59': 72.97, '60-69': 74.53, '70-79': 75.89, '80-89': 75.94, '90-99': 71.32, '100-109': 88.7, '110-119': 84.07, 'old': 73.91, 'new': 84.07}
2024-09-05 21:59:43,826 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72]
2024-09-05 21:59:43,826 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6]

Average Accuracy (CNN): 84.44
2024-09-05 21:59:43,826 [trainer.py] => Average Accuracy (CNN): 84.44 

2024-09-05 21:59:43,829 [trainer.py] => All params: 171970192
2024-09-05 21:59:43,831 [trainer.py] => Trainable params: 199880
2024-09-05 21:59:43,832 [l2p.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.730, Train_accy 62.66:   0%|          | 0/20 [00:04<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.730, Train_accy 62.66:   5%|▌         | 1/20 [00:04<01:31,  4.84s/it]
Task 12, Epoch 2/20 => Loss 0.003, Train_accy 87.76:   5%|▌         | 1/20 [00:09<01:31,  4.84s/it]
Task 12, Epoch 2/20 => Loss 0.003, Train_accy 87.76:  10%|█         | 2/20 [00:09<01:27,  4.84s/it]
Task 12, Epoch 3/20 => Loss 0.042, Train_accy 87.55:  10%|█         | 2/20 [00:14<01:27,  4.84s/it]
Task 12, Epoch 3/20 => Loss 0.042, Train_accy 87.55:  15%|█▌        | 3/20 [00:14<01:22,  4.83s/it]
Task 12, Epoch 4/20 => Loss -0.074, Train_accy 91.70:  15%|█▌        | 3/20 [00:19<01:22,  4.83s/it]
Task 12, Epoch 4/20 => Loss -0.074, Train_accy 91.70:  20%|██        | 4/20 [00:19<01:17,  4.83s/it]
Task 12, Epoch 5/20 => Loss -0.105, Train_accy 94.19, Test_accy 73.67:  20%|██        | 4/20 [00:33<01:17,  4.83s/it]
Task 12, Epoch 5/20 => Loss -0.105, Train_accy 94.19, Test_accy 73.67:  25%|██▌       | 5/20 [00:33<02:03,  8.23s/it]
Task 12, Epoch 6/20 => Loss -0.101, Train_accy 94.40:  25%|██▌       | 5/20 [00:38<02:03,  8.23s/it]                 
Task 12, Epoch 6/20 => Loss -0.101, Train_accy 94.40:  30%|███       | 6/20 [00:38<01:38,  7.07s/it]
Task 12, Epoch 7/20 => Loss -0.086, Train_accy 92.53:  30%|███       | 6/20 [00:43<01:38,  7.07s/it]
Task 12, Epoch 7/20 => Loss -0.086, Train_accy 92.53:  35%|███▌      | 7/20 [00:43<01:22,  6.33s/it]
Task 12, Epoch 8/20 => Loss -0.137, Train_accy 94.61:  35%|███▌      | 7/20 [00:48<01:22,  6.33s/it]
Task 12, Epoch 8/20 => Loss -0.137, Train_accy 94.61:  40%|████      | 8/20 [00:48<01:10,  5.85s/it]
Task 12, Epoch 9/20 => Loss -0.077, Train_accy 92.74:  40%|████      | 8/20 [00:52<01:10,  5.85s/it]
Task 12, Epoch 9/20 => Loss -0.077, Train_accy 92.74:  45%|████▌     | 9/20 [00:52<01:00,  5.52s/it]
Task 12, Epoch 10/20 => Loss -0.140, Train_accy 94.19, Test_accy 73.47:  45%|████▌     | 9/20 [01:07<01:00,  5.52s/it]
Task 12, Epoch 10/20 => Loss -0.140, Train_accy 94.19, Test_accy 73.47:  50%|█████     | 10/20 [01:07<01:22,  8.22s/it]
Task 12, Epoch 11/20 => Loss -0.152, Train_accy 96.06:  50%|█████     | 10/20 [01:11<01:22,  8.22s/it]                 
Task 12, Epoch 11/20 => Loss -0.152, Train_accy 96.06:  55%|█████▌    | 11/20 [01:11<01:04,  7.17s/it]
Task 12, Epoch 12/20 => Loss -0.147, Train_accy 93.98:  55%|█████▌    | 11/20 [01:16<01:04,  7.17s/it]
Task 12, Epoch 12/20 => Loss -0.147, Train_accy 93.98:  60%|██████    | 12/20 [01:16<00:51,  6.45s/it]
Task 12, Epoch 13/20 => Loss -0.158, Train_accy 95.02:  60%|██████    | 12/20 [01:21<00:51,  6.45s/it]
Task 12, Epoch 13/20 => Loss -0.158, Train_accy 95.02:  65%|██████▌   | 13/20 [01:21<00:41,  5.96s/it]
Task 12, Epoch 14/20 => Loss -0.155, Train_accy 94.81:  65%|██████▌   | 13/20 [01:26<00:41,  5.96s/it]
Task 12, Epoch 14/20 => Loss -0.155, Train_accy 94.81:  70%|███████   | 14/20 [01:26<00:33,  5.61s/it]
Task 12, Epoch 15/20 => Loss -0.154, Train_accy 95.02, Test_accy 73.54:  70%|███████   | 14/20 [01:40<00:33,  5.61s/it]
Task 12, Epoch 15/20 => Loss -0.154, Train_accy 95.02, Test_accy 73.54:  75%|███████▌  | 15/20 [01:40<00:41,  8.25s/it]
Task 12, Epoch 16/20 => Loss -0.145, Train_accy 96.06:  75%|███████▌  | 15/20 [01:45<00:41,  8.25s/it]                 
Task 12, Epoch 16/20 => Loss -0.145, Train_accy 96.06:  80%|████████  | 16/20 [01:45<00:28,  7.22s/it]
Task 12, Epoch 17/20 => Loss -0.091, Train_accy 93.36:  80%|████████  | 16/20 [01:50<00:28,  7.22s/it]
Task 12, Epoch 17/20 => Loss -0.091, Train_accy 93.36:  85%|████████▌ | 17/20 [01:50<00:19,  6.50s/it]
Task 12, Epoch 18/20 => Loss -0.125, Train_accy 94.40:  85%|████████▌ | 17/20 [01:55<00:19,  6.50s/it]
Task 12, Epoch 18/20 => Loss -0.125, Train_accy 94.40:  90%|█████████ | 18/20 [01:55<00:11,  5.99s/it]
Task 12, Epoch 19/20 => Loss -0.110, Train_accy 94.40:  90%|█████████ | 18/20 [01:59<00:11,  5.99s/it]
Task 12, Epoch 19/20 => Loss -0.110, Train_accy 94.40:  95%|█████████▌| 19/20 [01:59<00:05,  5.65s/it]
Task 12, Epoch 20/20 => Loss -0.118, Train_accy 93.36, Test_accy 73.60:  95%|█████████▌| 19/20 [02:14<00:05,  5.65s/it]
Task 12, Epoch 20/20 => Loss -0.118, Train_accy 93.36, Test_accy 73.60: 100%|██████████| 20/20 [02:14<00:00,  8.24s/it]
Task 12, Epoch 20/20 => Loss -0.118, Train_accy 93.36, Test_accy 73.60: 100%|██████████| 20/20 [02:14<00:00,  6.71s/it]
2024-09-05 22:01:58,099 [l2p.py] => Task 12, Epoch 20/20 => Loss -0.118, Train_accy 93.36, Test_accy 73.60
2024-09-05 22:02:07,580 [trainer.py] => No NME accuracy.
2024-09-05 22:02:07,580 [trainer.py] => CNN: {'total': 73.6, '00-09': 59.32, '10-19': 46.51, '20-29': 88.66, '30-39': 67.27, '40-49': 75.7, '50-59': 72.97, '60-69': 76.42, '70-79': 75.89, '80-89': 76.69, '90-99': 68.38, '100-109': 89.57, '110-119': 84.07, '120-129': 82.24, 'old': 72.95, 'new': 82.24}
2024-09-05 22:02:07,581 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6]
2024-09-05 22:02:07,581 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31]

Average Accuracy (CNN): 83.61
2024-09-05 22:02:07,581 [trainer.py] => Average Accuracy (CNN): 83.61 

2024-09-05 22:02:07,583 [trainer.py] => All params: 171970192
2024-09-05 22:02:07,585 [trainer.py] => Trainable params: 199880
2024-09-05 22:02:07,585 [l2p.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.729, Train_accy 65.47:   0%|          | 0/20 [00:04<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.729, Train_accy 65.47:   5%|▌         | 1/20 [00:04<01:30,  4.79s/it]
Task 13, Epoch 2/20 => Loss -0.028, Train_accy 92.16:   5%|▌         | 1/20 [00:09<01:30,  4.79s/it]
Task 13, Epoch 2/20 => Loss -0.028, Train_accy 92.16:  10%|█         | 2/20 [00:09<01:25,  4.77s/it]
Task 13, Epoch 3/20 => Loss -0.141, Train_accy 94.49:  10%|█         | 2/20 [00:14<01:25,  4.77s/it]
Task 13, Epoch 3/20 => Loss -0.141, Train_accy 94.49:  15%|█▌        | 3/20 [00:14<01:20,  4.75s/it]
Task 13, Epoch 4/20 => Loss -0.152, Train_accy 95.97:  15%|█▌        | 3/20 [00:18<01:20,  4.75s/it]
Task 13, Epoch 4/20 => Loss -0.152, Train_accy 95.97:  20%|██        | 4/20 [00:18<01:15,  4.74s/it]
Task 13, Epoch 5/20 => Loss -0.093, Train_accy 93.64, Test_accy 72.21:  20%|██        | 4/20 [00:33<01:15,  4.74s/it]
Task 13, Epoch 5/20 => Loss -0.093, Train_accy 93.64, Test_accy 72.21:  25%|██▌       | 5/20 [00:33<02:05,  8.40s/it]
Task 13, Epoch 6/20 => Loss -0.122, Train_accy 94.07:  25%|██▌       | 5/20 [00:38<02:05,  8.40s/it]                 
Task 13, Epoch 6/20 => Loss -0.122, Train_accy 94.07:  30%|███       | 6/20 [00:38<01:39,  7.14s/it]
Task 13, Epoch 7/20 => Loss -0.113, Train_accy 93.86:  30%|███       | 6/20 [00:43<01:39,  7.14s/it]
Task 13, Epoch 7/20 => Loss -0.113, Train_accy 93.86:  35%|███▌      | 7/20 [00:43<01:22,  6.34s/it]
Task 13, Epoch 8/20 => Loss -0.131, Train_accy 94.49:  35%|███▌      | 7/20 [00:48<01:22,  6.34s/it]
Task 13, Epoch 8/20 => Loss -0.131, Train_accy 94.49:  40%|████      | 8/20 [00:48<01:10,  5.83s/it]
Task 13, Epoch 9/20 => Loss -0.165, Train_accy 96.40:  40%|████      | 8/20 [00:52<01:10,  5.83s/it]
Task 13, Epoch 9/20 => Loss -0.165, Train_accy 96.40:  45%|████▌     | 9/20 [00:52<01:00,  5.48s/it]
Task 13, Epoch 10/20 => Loss -0.119, Train_accy 94.70, Test_accy 72.09:  45%|████▌     | 9/20 [01:07<01:00,  5.48s/it]
Task 13, Epoch 10/20 => Loss -0.119, Train_accy 94.70, Test_accy 72.09:  50%|█████     | 10/20 [01:07<01:23,  8.39s/it]
Task 13, Epoch 11/20 => Loss -0.172, Train_accy 96.19:  50%|█████     | 10/20 [01:12<01:23,  8.39s/it]                 
Task 13, Epoch 11/20 => Loss -0.172, Train_accy 96.19:  55%|█████▌    | 11/20 [01:12<01:05,  7.26s/it]
Task 13, Epoch 12/20 => Loss -0.187, Train_accy 96.61:  55%|█████▌    | 11/20 [01:17<01:05,  7.26s/it]
Task 13, Epoch 12/20 => Loss -0.187, Train_accy 96.61:  60%|██████    | 12/20 [01:17<00:51,  6.49s/it]
Task 13, Epoch 13/20 => Loss -0.174, Train_accy 97.03:  60%|██████    | 12/20 [01:21<00:51,  6.49s/it]
Task 13, Epoch 13/20 => Loss -0.174, Train_accy 97.03:  65%|██████▌   | 13/20 [01:21<00:41,  5.95s/it]
Task 13, Epoch 14/20 => Loss -0.181, Train_accy 96.61:  65%|██████▌   | 13/20 [01:26<00:41,  5.95s/it]
Task 13, Epoch 14/20 => Loss -0.181, Train_accy 96.61:  70%|███████   | 14/20 [01:26<00:33,  5.57s/it]
Task 13, Epoch 15/20 => Loss -0.181, Train_accy 95.76, Test_accy 72.64:  70%|███████   | 14/20 [01:41<00:33,  5.57s/it]
Task 13, Epoch 15/20 => Loss -0.181, Train_accy 95.76, Test_accy 72.64:  75%|███████▌  | 15/20 [01:41<00:41,  8.38s/it]
Task 13, Epoch 16/20 => Loss -0.185, Train_accy 97.03:  75%|███████▌  | 15/20 [01:46<00:41,  8.38s/it]                 
Task 13, Epoch 16/20 => Loss -0.185, Train_accy 97.03:  80%|████████  | 16/20 [01:46<00:29,  7.29s/it]
Task 13, Epoch 17/20 => Loss -0.124, Train_accy 94.70:  80%|████████  | 16/20 [01:50<00:29,  7.29s/it]
Task 13, Epoch 17/20 => Loss -0.124, Train_accy 94.70:  85%|████████▌ | 17/20 [01:50<00:19,  6.51s/it]
Task 13, Epoch 18/20 => Loss -0.168, Train_accy 96.82:  85%|████████▌ | 17/20 [01:55<00:19,  6.51s/it]
Task 13, Epoch 18/20 => Loss -0.168, Train_accy 96.82:  90%|█████████ | 18/20 [01:55<00:11,  5.97s/it]
Task 13, Epoch 19/20 => Loss -0.150, Train_accy 96.19:  90%|█████████ | 18/20 [02:00<00:11,  5.97s/it]
Task 13, Epoch 19/20 => Loss -0.150, Train_accy 96.19:  95%|█████████▌| 19/20 [02:00<00:05,  5.60s/it]
Task 13, Epoch 20/20 => Loss -0.150, Train_accy 95.97, Test_accy 73.31:  95%|█████████▌| 19/20 [02:15<00:05,  5.60s/it]
Task 13, Epoch 20/20 => Loss -0.150, Train_accy 95.97, Test_accy 73.31: 100%|██████████| 20/20 [02:15<00:00,  8.39s/it]
Task 13, Epoch 20/20 => Loss -0.150, Train_accy 95.97, Test_accy 73.31: 100%|██████████| 20/20 [02:15<00:00,  6.76s/it]
2024-09-05 22:04:22,750 [l2p.py] => Task 13, Epoch 20/20 => Loss -0.150, Train_accy 95.97, Test_accy 73.31
2024-09-05 22:04:32,895 [trainer.py] => No NME accuracy.
2024-09-05 22:04:32,895 [trainer.py] => CNN: {'total': 73.31, '00-09': 60.17, '10-19': 47.29, '20-29': 88.66, '30-39': 67.27, '40-49': 76.64, '50-59': 72.97, '60-69': 76.42, '70-79': 76.6, '80-89': 76.69, '90-99': 66.91, '100-109': 87.83, '110-119': 83.19, '120-129': 80.37, '130-139': 72.03, 'old': 73.41, 'new': 72.03}
2024-09-05 22:04:32,895 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6, 73.31]
2024-09-05 22:04:32,896 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31, 97.14]

Average Accuracy (CNN): 82.87
2024-09-05 22:04:32,896 [trainer.py] => Average Accuracy (CNN): 82.87 

2024-09-05 22:04:32,898 [trainer.py] => All params: 171970192
2024-09-05 22:04:32,901 [trainer.py] => Trainable params: 199880
2024-09-05 22:04:32,901 [l2p.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.711, Train_accy 70.35:   0%|          | 0/20 [00:04<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.711, Train_accy 70.35:   5%|▌         | 1/20 [00:04<01:26,  4.56s/it]
Task 14, Epoch 2/20 => Loss -0.055, Train_accy 95.13:   5%|▌         | 1/20 [00:09<01:26,  4.56s/it]
Task 14, Epoch 2/20 => Loss -0.055, Train_accy 95.13:  10%|█         | 2/20 [00:09<01:22,  4.56s/it]
Task 14, Epoch 3/20 => Loss -0.105, Train_accy 95.13:  10%|█         | 2/20 [00:13<01:22,  4.56s/it]
Task 14, Epoch 3/20 => Loss -0.105, Train_accy 95.13:  15%|█▌        | 3/20 [00:13<01:17,  4.56s/it]
Task 14, Epoch 4/20 => Loss -0.099, Train_accy 96.02:  15%|█▌        | 3/20 [00:18<01:17,  4.56s/it]
Task 14, Epoch 4/20 => Loss -0.099, Train_accy 96.02:  20%|██        | 4/20 [00:18<01:12,  4.55s/it]
Task 14, Epoch 5/20 => Loss -0.156, Train_accy 96.68, Test_accy 72.38:  20%|██        | 4/20 [00:33<01:12,  4.55s/it]
Task 14, Epoch 5/20 => Loss -0.156, Train_accy 96.68, Test_accy 72.38:  25%|██▌       | 5/20 [00:33<02:07,  8.49s/it]
Task 14, Epoch 6/20 => Loss -0.149, Train_accy 96.24:  25%|██▌       | 5/20 [00:38<02:07,  8.49s/it]                 
Task 14, Epoch 6/20 => Loss -0.149, Train_accy 96.24:  30%|███       | 6/20 [00:38<01:40,  7.15s/it]
Task 14, Epoch 7/20 => Loss -0.125, Train_accy 96.02:  30%|███       | 6/20 [00:42<01:40,  7.15s/it]
Task 14, Epoch 7/20 => Loss -0.125, Train_accy 96.02:  35%|███▌      | 7/20 [00:42<01:21,  6.29s/it]
Task 14, Epoch 8/20 => Loss -0.131, Train_accy 95.13:  35%|███▌      | 7/20 [00:47<01:21,  6.29s/it]
Task 14, Epoch 8/20 => Loss -0.131, Train_accy 95.13:  40%|████      | 8/20 [00:47<01:08,  5.74s/it]
Task 14, Epoch 9/20 => Loss -0.166, Train_accy 96.68:  40%|████      | 8/20 [00:51<01:08,  5.74s/it]
Task 14, Epoch 9/20 => Loss -0.166, Train_accy 96.68:  45%|████▌     | 9/20 [00:51<00:58,  5.36s/it]
Task 14, Epoch 10/20 => Loss -0.225, Train_accy 98.89, Test_accy 72.67:  45%|████▌     | 9/20 [01:07<00:58,  5.36s/it]
Task 14, Epoch 10/20 => Loss -0.225, Train_accy 98.89, Test_accy 72.67:  50%|█████     | 10/20 [01:07<01:24,  8.48s/it]
Task 14, Epoch 11/20 => Loss -0.171, Train_accy 96.90:  50%|█████     | 10/20 [01:11<01:24,  8.48s/it]                 
Task 14, Epoch 11/20 => Loss -0.171, Train_accy 96.90:  55%|█████▌    | 11/20 [01:11<01:05,  7.29s/it]
Task 14, Epoch 12/20 => Loss -0.211, Train_accy 97.79:  55%|█████▌    | 11/20 [01:16<01:05,  7.29s/it]
Task 14, Epoch 12/20 => Loss -0.211, Train_accy 97.79:  60%|██████    | 12/20 [01:16<00:51,  6.46s/it]
Task 14, Epoch 13/20 => Loss -0.114, Train_accy 95.13:  60%|██████    | 12/20 [01:21<00:51,  6.46s/it]
Task 14, Epoch 13/20 => Loss -0.114, Train_accy 95.13:  65%|██████▌   | 13/20 [01:21<00:41,  5.89s/it]
Task 14, Epoch 14/20 => Loss -0.158, Train_accy 96.90:  65%|██████▌   | 13/20 [01:25<00:41,  5.89s/it]
Task 14, Epoch 14/20 => Loss -0.158, Train_accy 96.90:  70%|███████   | 14/20 [01:25<00:32,  5.48s/it]
Task 14, Epoch 15/20 => Loss -0.142, Train_accy 95.35, Test_accy 72.72:  70%|███████   | 14/20 [01:41<00:32,  5.48s/it]
Task 14, Epoch 15/20 => Loss -0.142, Train_accy 95.35, Test_accy 72.72:  75%|███████▌  | 15/20 [01:41<00:42,  8.48s/it]
Task 14, Epoch 16/20 => Loss -0.157, Train_accy 96.02:  75%|███████▌  | 15/20 [01:45<00:42,  8.48s/it]                 
Task 14, Epoch 16/20 => Loss -0.157, Train_accy 96.02:  80%|████████  | 16/20 [01:45<00:29,  7.29s/it]
Task 14, Epoch 17/20 => Loss -0.155, Train_accy 95.35:  80%|████████  | 16/20 [01:50<00:29,  7.29s/it]
Task 14, Epoch 17/20 => Loss -0.155, Train_accy 95.35:  85%|████████▌ | 17/20 [01:50<00:19,  6.46s/it]
Task 14, Epoch 18/20 => Loss -0.152, Train_accy 96.02:  85%|████████▌ | 17/20 [01:54<00:19,  6.46s/it]
Task 14, Epoch 18/20 => Loss -0.152, Train_accy 96.02:  90%|█████████ | 18/20 [01:54<00:11,  5.89s/it]
Task 14, Epoch 19/20 => Loss -0.204, Train_accy 97.57:  90%|█████████ | 18/20 [01:59<00:11,  5.89s/it]
Task 14, Epoch 19/20 => Loss -0.204, Train_accy 97.57:  95%|█████████▌| 19/20 [01:59<00:05,  5.49s/it]
Task 14, Epoch 20/20 => Loss -0.175, Train_accy 96.90, Test_accy 73.23:  95%|█████████▌| 19/20 [02:14<00:05,  5.49s/it]
Task 14, Epoch 20/20 => Loss -0.175, Train_accy 96.90, Test_accy 73.23: 100%|██████████| 20/20 [02:14<00:00,  8.46s/it]
Task 14, Epoch 20/20 => Loss -0.175, Train_accy 96.90, Test_accy 73.23: 100%|██████████| 20/20 [02:14<00:00,  6.73s/it]
2024-09-05 22:06:47,498 [l2p.py] => Task 14, Epoch 20/20 => Loss -0.175, Train_accy 96.90, Test_accy 73.23
2024-09-05 22:06:58,429 [trainer.py] => No NME accuracy.
2024-09-05 22:06:58,430 [trainer.py] => CNN: {'total': 73.23, '00-09': 57.63, '10-19': 47.29, '20-29': 88.66, '30-39': 69.09, '40-49': 73.83, '50-59': 64.86, '60-69': 76.42, '70-79': 75.18, '80-89': 76.69, '90-99': 66.91, '100-109': 88.7, '110-119': 80.53, '120-129': 82.24, '130-139': 72.88, '140-149': 83.33, 'old': 72.46, 'new': 83.33}
2024-09-05 22:06:58,430 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6, 73.31, 73.23]
2024-09-05 22:06:58,430 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31, 97.14, 96.89]

Average Accuracy (CNN): 82.23
2024-09-05 22:06:58,430 [trainer.py] => Average Accuracy (CNN): 82.23 

2024-09-05 22:06:58,432 [trainer.py] => All params: 171970192
2024-09-05 22:06:58,434 [trainer.py] => Trainable params: 199880
2024-09-05 22:06:58,435 [l2p.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.760, Train_accy 69.02:   0%|          | 0/20 [00:04<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.760, Train_accy 69.02:   5%|▌         | 1/20 [00:04<01:29,  4.70s/it]
Task 15, Epoch 2/20 => Loss -0.050, Train_accy 93.80:   5%|▌         | 1/20 [00:09<01:29,  4.70s/it]
Task 15, Epoch 2/20 => Loss -0.050, Train_accy 93.80:  10%|█         | 2/20 [00:09<01:24,  4.69s/it]
Task 15, Epoch 3/20 => Loss -0.082, Train_accy 94.66:  10%|█         | 2/20 [00:14<01:24,  4.69s/it]
Task 15, Epoch 3/20 => Loss -0.082, Train_accy 94.66:  15%|█▌        | 3/20 [00:14<01:19,  4.68s/it]
Task 15, Epoch 4/20 => Loss -0.088, Train_accy 94.44:  15%|█▌        | 3/20 [00:18<01:19,  4.68s/it]
Task 15, Epoch 4/20 => Loss -0.088, Train_accy 94.44:  20%|██        | 4/20 [00:18<01:14,  4.67s/it]
Task 15, Epoch 5/20 => Loss -0.150, Train_accy 96.79, Test_accy 71.07:  20%|██        | 4/20 [00:35<01:14,  4.67s/it]
Task 15, Epoch 5/20 => Loss -0.150, Train_accy 96.79, Test_accy 71.07:  25%|██▌       | 5/20 [00:35<02:13,  8.91s/it]
Task 15, Epoch 6/20 => Loss -0.151, Train_accy 96.37:  25%|██▌       | 5/20 [00:39<02:13,  8.91s/it]                 
Task 15, Epoch 6/20 => Loss -0.151, Train_accy 96.37:  30%|███       | 6/20 [00:39<01:44,  7.48s/it]
Task 15, Epoch 7/20 => Loss -0.145, Train_accy 96.15:  30%|███       | 6/20 [00:44<01:44,  7.48s/it]
Task 15, Epoch 7/20 => Loss -0.145, Train_accy 96.15:  35%|███▌      | 7/20 [00:44<01:25,  6.58s/it]
Task 15, Epoch 8/20 => Loss -0.149, Train_accy 97.44:  35%|███▌      | 7/20 [00:49<01:25,  6.58s/it]
Task 15, Epoch 8/20 => Loss -0.149, Train_accy 97.44:  40%|████      | 8/20 [00:49<01:11,  5.98s/it]
Task 15, Epoch 9/20 => Loss -0.190, Train_accy 97.44:  40%|████      | 8/20 [00:53<01:11,  5.98s/it]
Task 15, Epoch 9/20 => Loss -0.190, Train_accy 97.44:  45%|████▌     | 9/20 [00:53<01:01,  5.56s/it]
Task 15, Epoch 10/20 => Loss -0.156, Train_accy 96.37, Test_accy 71.97:  45%|████▌     | 9/20 [01:10<01:01,  5.56s/it]
Task 15, Epoch 10/20 => Loss -0.156, Train_accy 96.37, Test_accy 71.97:  50%|█████     | 10/20 [01:10<01:28,  8.88s/it]
Task 15, Epoch 11/20 => Loss -0.204, Train_accy 98.08:  50%|█████     | 10/20 [01:14<01:28,  8.88s/it]                 
Task 15, Epoch 11/20 => Loss -0.204, Train_accy 98.08:  55%|█████▌    | 11/20 [01:14<01:08,  7.59s/it]
Task 15, Epoch 12/20 => Loss -0.162, Train_accy 96.58:  55%|█████▌    | 11/20 [01:19<01:08,  7.59s/it]
Task 15, Epoch 12/20 => Loss -0.162, Train_accy 96.58:  60%|██████    | 12/20 [01:19<00:53,  6.70s/it]
Task 15, Epoch 13/20 => Loss -0.174, Train_accy 97.01:  60%|██████    | 12/20 [01:24<00:53,  6.70s/it]
Task 15, Epoch 13/20 => Loss -0.174, Train_accy 97.01:  65%|██████▌   | 13/20 [01:24<00:42,  6.08s/it]
Task 15, Epoch 14/20 => Loss -0.156, Train_accy 96.15:  65%|██████▌   | 13/20 [01:28<00:42,  6.08s/it]
Task 15, Epoch 14/20 => Loss -0.156, Train_accy 96.15:  70%|███████   | 14/20 [01:28<00:33,  5.65s/it]
Task 15, Epoch 15/20 => Loss -0.172, Train_accy 96.79, Test_accy 72.29:  70%|███████   | 14/20 [01:45<00:33,  5.65s/it]
Task 15, Epoch 15/20 => Loss -0.172, Train_accy 96.79, Test_accy 72.29:  75%|███████▌  | 15/20 [01:45<00:44,  8.84s/it]
Task 15, Epoch 16/20 => Loss -0.120, Train_accy 95.73:  75%|███████▌  | 15/20 [01:49<00:44,  8.84s/it]                 
Task 15, Epoch 16/20 => Loss -0.120, Train_accy 95.73:  80%|████████  | 16/20 [01:49<00:30,  7.59s/it]
Task 15, Epoch 17/20 => Loss -0.170, Train_accy 97.22:  80%|████████  | 16/20 [01:54<00:30,  7.59s/it]
Task 15, Epoch 17/20 => Loss -0.170, Train_accy 97.22:  85%|████████▌ | 17/20 [01:54<00:20,  6.71s/it]
Task 15, Epoch 18/20 => Loss -0.183, Train_accy 97.22:  85%|████████▌ | 17/20 [01:59<00:20,  6.71s/it]
Task 15, Epoch 18/20 => Loss -0.183, Train_accy 97.22:  90%|█████████ | 18/20 [01:59<00:12,  6.10s/it]
Task 15, Epoch 19/20 => Loss -0.166, Train_accy 96.58:  90%|█████████ | 18/20 [02:03<00:12,  6.10s/it]
Task 15, Epoch 19/20 => Loss -0.166, Train_accy 96.58:  95%|█████████▌| 19/20 [02:03<00:05,  5.67s/it]
Task 15, Epoch 20/20 => Loss -0.142, Train_accy 95.51, Test_accy 72.45:  95%|█████████▌| 19/20 [02:20<00:05,  5.67s/it]
Task 15, Epoch 20/20 => Loss -0.142, Train_accy 95.51, Test_accy 72.45: 100%|██████████| 20/20 [02:20<00:00,  8.85s/it]
Task 15, Epoch 20/20 => Loss -0.142, Train_accy 95.51, Test_accy 72.45: 100%|██████████| 20/20 [02:20<00:00,  7.00s/it]
2024-09-05 22:09:18,469 [l2p.py] => Task 15, Epoch 20/20 => Loss -0.142, Train_accy 95.51, Test_accy 72.45
2024-09-05 22:09:30,066 [trainer.py] => No NME accuracy.
2024-09-05 22:09:30,067 [trainer.py] => CNN: {'total': 72.45, '00-09': 54.24, '10-19': 47.29, '20-29': 86.6, '30-39': 68.18, '40-49': 74.77, '50-59': 62.16, '60-69': 76.42, '70-79': 73.76, '80-89': 78.2, '90-99': 65.44, '100-109': 86.96, '110-119': 80.53, '120-129': 85.05, '130-139': 72.03, '140-149': 84.13, '150-159': 69.35, 'old': 72.67, 'new': 69.35}
2024-09-05 22:09:30,067 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6, 73.31, 73.23, 72.45]
2024-09-05 22:09:30,067 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31, 97.14, 96.89, 96.46]

Average Accuracy (CNN): 81.62
2024-09-05 22:09:30,067 [trainer.py] => Average Accuracy (CNN): 81.62 

2024-09-05 22:09:30,070 [trainer.py] => All params: 171970192
2024-09-05 22:09:30,073 [trainer.py] => Trainable params: 199880
2024-09-05 22:09:30,073 [l2p.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.595, Train_accy 74.57:   0%|          | 0/20 [00:04<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.595, Train_accy 74.57:   5%|▌         | 1/20 [00:04<01:27,  4.63s/it]
Task 16, Epoch 2/20 => Loss -0.071, Train_accy 94.40:   5%|▌         | 1/20 [00:09<01:27,  4.63s/it]
Task 16, Epoch 2/20 => Loss -0.071, Train_accy 94.40:  10%|█         | 2/20 [00:09<01:23,  4.63s/it]
Task 16, Epoch 3/20 => Loss -0.169, Train_accy 97.20:  10%|█         | 2/20 [00:13<01:23,  4.63s/it]
Task 16, Epoch 3/20 => Loss -0.169, Train_accy 97.20:  15%|█▌        | 3/20 [00:13<01:18,  4.62s/it]
Task 16, Epoch 4/20 => Loss -0.132, Train_accy 95.69:  15%|█▌        | 3/20 [00:18<01:18,  4.62s/it]
Task 16, Epoch 4/20 => Loss -0.132, Train_accy 95.69:  20%|██        | 4/20 [00:18<01:14,  4.63s/it]
Task 16, Epoch 5/20 => Loss -0.206, Train_accy 98.06, Test_accy 70.27:  20%|██        | 4/20 [00:35<01:14,  4.63s/it]
Task 16, Epoch 5/20 => Loss -0.206, Train_accy 98.06, Test_accy 70.27:  25%|██▌       | 5/20 [00:35<02:16,  9.08s/it]
Task 16, Epoch 6/20 => Loss -0.156, Train_accy 96.12:  25%|██▌       | 5/20 [00:40<02:16,  9.08s/it]                 
Task 16, Epoch 6/20 => Loss -0.156, Train_accy 96.12:  30%|███       | 6/20 [00:40<01:45,  7.56s/it]
Task 16, Epoch 7/20 => Loss -0.121, Train_accy 95.47:  30%|███       | 6/20 [00:44<01:45,  7.56s/it]
Task 16, Epoch 7/20 => Loss -0.121, Train_accy 95.47:  35%|███▌      | 7/20 [00:44<01:25,  6.60s/it]
Task 16, Epoch 8/20 => Loss -0.188, Train_accy 97.20:  35%|███▌      | 7/20 [00:49<01:25,  6.60s/it]
Task 16, Epoch 8/20 => Loss -0.188, Train_accy 97.20:  40%|████      | 8/20 [00:49<01:11,  5.98s/it]
Task 16, Epoch 9/20 => Loss -0.160, Train_accy 95.26:  40%|████      | 8/20 [00:54<01:11,  5.98s/it]
Task 16, Epoch 9/20 => Loss -0.160, Train_accy 95.26:  45%|████▌     | 9/20 [00:54<01:01,  5.56s/it]
Task 16, Epoch 10/20 => Loss -0.158, Train_accy 96.34, Test_accy 70.57:  45%|████▌     | 9/20 [01:11<01:01,  5.56s/it]
Task 16, Epoch 10/20 => Loss -0.158, Train_accy 96.34, Test_accy 70.57:  50%|█████     | 10/20 [01:11<01:31,  9.11s/it]
Task 16, Epoch 11/20 => Loss -0.202, Train_accy 98.06:  50%|█████     | 10/20 [01:15<01:31,  9.11s/it]                 
Task 16, Epoch 11/20 => Loss -0.202, Train_accy 98.06:  55%|█████▌    | 11/20 [01:15<01:09,  7.77s/it]
Task 16, Epoch 12/20 => Loss -0.189, Train_accy 97.63:  55%|█████▌    | 11/20 [01:20<01:09,  7.77s/it]
Task 16, Epoch 12/20 => Loss -0.189, Train_accy 97.63:  60%|██████    | 12/20 [01:20<00:54,  6.81s/it]
Task 16, Epoch 13/20 => Loss -0.173, Train_accy 96.77:  60%|██████    | 12/20 [01:25<00:54,  6.81s/it]
Task 16, Epoch 13/20 => Loss -0.173, Train_accy 96.77:  65%|██████▌   | 13/20 [01:25<00:43,  6.16s/it]
Task 16, Epoch 14/20 => Loss -0.196, Train_accy 97.20:  65%|██████▌   | 13/20 [01:29<00:43,  6.16s/it]
Task 16, Epoch 14/20 => Loss -0.196, Train_accy 97.20:  70%|███████   | 14/20 [01:29<00:34,  5.70s/it]
Task 16, Epoch 15/20 => Loss -0.191, Train_accy 96.98, Test_accy 71.21:  70%|███████   | 14/20 [01:46<00:34,  5.70s/it]
Task 16, Epoch 15/20 => Loss -0.191, Train_accy 96.98, Test_accy 71.21:  75%|███████▌  | 15/20 [01:46<00:45,  9.12s/it]
Task 16, Epoch 16/20 => Loss -0.210, Train_accy 97.63:  75%|███████▌  | 15/20 [01:51<00:45,  9.12s/it]                 
Task 16, Epoch 16/20 => Loss -0.210, Train_accy 97.63:  80%|████████  | 16/20 [01:51<00:31,  7.80s/it]
Task 16, Epoch 17/20 => Loss -0.178, Train_accy 96.77:  80%|████████  | 16/20 [01:56<00:31,  7.80s/it]
Task 16, Epoch 17/20 => Loss -0.178, Train_accy 96.77:  85%|████████▌ | 17/20 [01:56<00:20,  6.86s/it]
Task 16, Epoch 18/20 => Loss -0.182, Train_accy 96.55:  85%|████████▌ | 17/20 [02:00<00:20,  6.86s/it]
Task 16, Epoch 18/20 => Loss -0.182, Train_accy 96.55:  90%|█████████ | 18/20 [02:00<00:12,  6.20s/it]
Task 16, Epoch 19/20 => Loss -0.178, Train_accy 96.98:  90%|█████████ | 18/20 [02:05<00:12,  6.20s/it]
Task 16, Epoch 19/20 => Loss -0.178, Train_accy 96.98:  95%|█████████▌| 19/20 [02:05<00:05,  5.74s/it]
Task 16, Epoch 20/20 => Loss -0.156, Train_accy 95.91, Test_accy 71.41:  95%|█████████▌| 19/20 [02:22<00:05,  5.74s/it]
Task 16, Epoch 20/20 => Loss -0.156, Train_accy 95.91, Test_accy 71.41: 100%|██████████| 20/20 [02:22<00:00,  9.15s/it]
Task 16, Epoch 20/20 => Loss -0.156, Train_accy 95.91, Test_accy 71.41: 100%|██████████| 20/20 [02:22<00:00,  7.13s/it]
2024-09-05 22:11:52,711 [l2p.py] => Task 16, Epoch 20/20 => Loss -0.156, Train_accy 95.91, Test_accy 71.41
2024-09-05 22:12:05,201 [trainer.py] => No NME accuracy.
2024-09-05 22:12:05,202 [trainer.py] => CNN: {'total': 71.41, '00-09': 51.69, '10-19': 46.51, '20-29': 86.6, '30-39': 66.36, '40-49': 65.42, '50-59': 61.26, '60-69': 75.47, '70-79': 73.76, '80-89': 77.44, '90-99': 66.18, '100-109': 87.83, '110-119': 79.65, '120-129': 85.98, '130-139': 71.19, '140-149': 76.19, '150-159': 68.55, '160-169': 78.36, 'old': 70.91, 'new': 78.36}
2024-09-05 22:12:05,202 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6, 73.31, 73.23, 72.45, 71.41]
2024-09-05 22:12:05,202 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31, 97.14, 96.89, 96.46, 95.75]

Average Accuracy (CNN): 81.02
2024-09-05 22:12:05,203 [trainer.py] => Average Accuracy (CNN): 81.02 

2024-09-05 22:12:05,206 [trainer.py] => All params: 171970192
2024-09-05 22:12:05,208 [trainer.py] => Trainable params: 199880
2024-09-05 22:12:05,209 [l2p.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.442, Train_accy 75.91:   0%|          | 0/20 [00:04<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.442, Train_accy 75.91:   5%|▌         | 1/20 [00:04<01:33,  4.92s/it]
Task 17, Epoch 2/20 => Loss -0.099, Train_accy 94.53:   5%|▌         | 1/20 [00:09<01:33,  4.92s/it]
Task 17, Epoch 2/20 => Loss -0.099, Train_accy 94.53:  10%|█         | 2/20 [00:09<01:28,  4.93s/it]
Task 17, Epoch 3/20 => Loss -0.117, Train_accy 95.14:  10%|█         | 2/20 [00:14<01:28,  4.93s/it]
Task 17, Epoch 3/20 => Loss -0.117, Train_accy 95.14:  15%|█▌        | 3/20 [00:14<01:23,  4.93s/it]
Task 17, Epoch 4/20 => Loss -0.187, Train_accy 96.96:  15%|█▌        | 3/20 [00:19<01:23,  4.93s/it]
Task 17, Epoch 4/20 => Loss -0.187, Train_accy 96.96:  20%|██        | 4/20 [00:19<01:18,  4.93s/it]
Task 17, Epoch 5/20 => Loss -0.115, Train_accy 95.75, Test_accy 70.54:  20%|██        | 4/20 [00:37<01:18,  4.93s/it]
Task 17, Epoch 5/20 => Loss -0.115, Train_accy 95.75, Test_accy 70.54:  25%|██▌       | 5/20 [00:37<02:24,  9.62s/it]
Task 17, Epoch 6/20 => Loss -0.165, Train_accy 96.96:  25%|██▌       | 5/20 [00:42<02:24,  9.62s/it]                 
Task 17, Epoch 6/20 => Loss -0.165, Train_accy 96.96:  30%|███       | 6/20 [00:42<01:52,  8.02s/it]
Task 17, Epoch 7/20 => Loss -0.106, Train_accy 94.53:  30%|███       | 6/20 [00:47<01:52,  8.02s/it]
Task 17, Epoch 7/20 => Loss -0.106, Train_accy 94.53:  35%|███▌      | 7/20 [00:47<01:31,  7.01s/it]
Task 17, Epoch 8/20 => Loss -0.172, Train_accy 96.15:  35%|███▌      | 7/20 [00:52<01:31,  7.01s/it]
Task 17, Epoch 8/20 => Loss -0.172, Train_accy 96.15:  40%|████      | 8/20 [00:52<01:16,  6.34s/it]
Task 17, Epoch 9/20 => Loss -0.113, Train_accy 94.74:  40%|████      | 8/20 [00:57<01:16,  6.34s/it]
Task 17, Epoch 9/20 => Loss -0.113, Train_accy 94.74:  45%|████▌     | 9/20 [00:57<01:05,  5.92s/it]
Task 17, Epoch 10/20 => Loss -0.131, Train_accy 95.95, Test_accy 70.58:  45%|████▌     | 9/20 [01:15<01:05,  5.92s/it]
Task 17, Epoch 10/20 => Loss -0.131, Train_accy 95.95, Test_accy 70.58:  50%|█████     | 10/20 [01:15<01:36,  9.65s/it]
Task 17, Epoch 11/20 => Loss -0.211, Train_accy 97.17:  50%|█████     | 10/20 [01:20<01:36,  9.65s/it]                 
Task 17, Epoch 11/20 => Loss -0.211, Train_accy 97.17:  55%|█████▌    | 11/20 [01:20<01:13,  8.21s/it]
Task 17, Epoch 12/20 => Loss -0.147, Train_accy 95.34:  55%|█████▌    | 11/20 [01:25<01:13,  8.21s/it]
Task 17, Epoch 12/20 => Loss -0.147, Train_accy 95.34:  60%|██████    | 12/20 [01:25<00:57,  7.21s/it]
Task 17, Epoch 13/20 => Loss -0.176, Train_accy 96.56:  60%|██████    | 12/20 [01:30<00:57,  7.21s/it]
Task 17, Epoch 13/20 => Loss -0.176, Train_accy 96.56:  65%|██████▌   | 13/20 [01:30<00:45,  6.53s/it]
Task 17, Epoch 14/20 => Loss -0.156, Train_accy 96.15:  65%|██████▌   | 13/20 [01:35<00:45,  6.53s/it]
Task 17, Epoch 14/20 => Loss -0.156, Train_accy 96.15:  70%|███████   | 14/20 [01:35<00:36,  6.05s/it]
Task 17, Epoch 15/20 => Loss -0.120, Train_accy 95.55, Test_accy 70.72:  70%|███████   | 14/20 [01:53<00:36,  6.05s/it]
Task 17, Epoch 15/20 => Loss -0.120, Train_accy 95.55, Test_accy 70.72:  75%|███████▌  | 15/20 [01:53<00:48,  9.66s/it]
Task 17, Epoch 16/20 => Loss -0.153, Train_accy 95.75:  75%|███████▌  | 15/20 [01:58<00:48,  9.66s/it]                 
Task 17, Epoch 16/20 => Loss -0.153, Train_accy 95.75:  80%|████████  | 16/20 [01:58<00:32,  8.25s/it]
Task 17, Epoch 17/20 => Loss -0.105, Train_accy 95.75:  80%|████████  | 16/20 [02:03<00:32,  8.25s/it]
Task 17, Epoch 17/20 => Loss -0.105, Train_accy 95.75:  85%|████████▌ | 17/20 [02:03<00:21,  7.26s/it]
Task 17, Epoch 18/20 => Loss -0.162, Train_accy 95.95:  85%|████████▌ | 17/20 [02:08<00:21,  7.26s/it]
Task 17, Epoch 18/20 => Loss -0.162, Train_accy 95.95:  90%|█████████ | 18/20 [02:08<00:13,  6.56s/it]
Task 17, Epoch 19/20 => Loss -0.172, Train_accy 95.55:  90%|█████████ | 18/20 [02:13<00:13,  6.56s/it]
Task 17, Epoch 19/20 => Loss -0.172, Train_accy 95.55:  95%|█████████▌| 19/20 [02:13<00:06,  6.09s/it]
Task 17, Epoch 20/20 => Loss -0.143, Train_accy 96.15, Test_accy 70.54:  95%|█████████▌| 19/20 [02:31<00:06,  6.09s/it]
Task 17, Epoch 20/20 => Loss -0.143, Train_accy 96.15, Test_accy 70.54: 100%|██████████| 20/20 [02:31<00:00,  9.67s/it]
Task 17, Epoch 20/20 => Loss -0.143, Train_accy 96.15, Test_accy 70.54: 100%|██████████| 20/20 [02:31<00:00,  7.55s/it]
2024-09-05 22:14:36,299 [l2p.py] => Task 17, Epoch 20/20 => Loss -0.143, Train_accy 96.15, Test_accy 70.54
2024-09-05 22:14:49,387 [trainer.py] => No NME accuracy.
2024-09-05 22:14:49,388 [trainer.py] => CNN: {'total': 70.54, '00-09': 50.0, '10-19': 44.19, '20-29': 85.57, '30-39': 68.18, '40-49': 66.36, '50-59': 62.16, '60-69': 68.87, '70-79': 74.47, '80-89': 76.69, '90-99': 66.18, '100-109': 87.83, '110-119': 80.53, '120-129': 85.05, '130-139': 72.03, '140-149': 75.4, '150-159': 66.94, '160-169': 76.87, '170-179': 66.02, 'old': 70.77, 'new': 66.02}
2024-09-05 22:14:49,388 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6, 73.31, 73.23, 72.45, 71.41, 70.54]
2024-09-05 22:14:49,388 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31, 97.14, 96.89, 96.46, 95.75, 95.58]

Average Accuracy (CNN): 80.44
2024-09-05 22:14:49,388 [trainer.py] => Average Accuracy (CNN): 80.44 

2024-09-05 22:14:49,391 [trainer.py] => All params: 171970192
2024-09-05 22:14:49,393 [trainer.py] => Trainable params: 199880
2024-09-05 22:14:49,393 [l2p.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.656, Train_accy 70.99:   0%|          | 0/20 [00:04<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.656, Train_accy 70.99:   5%|▌         | 1/20 [00:04<01:26,  4.54s/it]
Task 18, Epoch 2/20 => Loss -0.056, Train_accy 93.41:   5%|▌         | 1/20 [00:09<01:26,  4.54s/it]
Task 18, Epoch 2/20 => Loss -0.056, Train_accy 93.41:  10%|█         | 2/20 [00:09<01:21,  4.54s/it]
Task 18, Epoch 3/20 => Loss -0.021, Train_accy 92.97:  10%|█         | 2/20 [00:13<01:21,  4.54s/it]
Task 18, Epoch 3/20 => Loss -0.021, Train_accy 92.97:  15%|█▌        | 3/20 [00:13<01:17,  4.55s/it]
Task 18, Epoch 4/20 => Loss -0.113, Train_accy 95.16:  15%|█▌        | 3/20 [00:18<01:17,  4.55s/it]
Task 18, Epoch 4/20 => Loss -0.113, Train_accy 95.16:  20%|██        | 4/20 [00:18<01:12,  4.55s/it]
Task 18, Epoch 5/20 => Loss -0.112, Train_accy 94.51, Test_accy 69.07:  20%|██        | 4/20 [00:36<01:12,  4.55s/it]
Task 18, Epoch 5/20 => Loss -0.112, Train_accy 94.51, Test_accy 69.07:  25%|██▌       | 5/20 [00:36<02:22,  9.52s/it]
Task 18, Epoch 6/20 => Loss -0.166, Train_accy 96.26:  25%|██▌       | 5/20 [00:41<02:22,  9.52s/it]                 
Task 18, Epoch 6/20 => Loss -0.166, Train_accy 96.26:  30%|███       | 6/20 [00:41<01:49,  7.83s/it]
Task 18, Epoch 7/20 => Loss -0.147, Train_accy 96.04:  30%|███       | 6/20 [00:45<01:49,  7.83s/it]
Task 18, Epoch 7/20 => Loss -0.147, Train_accy 96.04:  35%|███▌      | 7/20 [00:45<01:27,  6.77s/it]
Task 18, Epoch 8/20 => Loss -0.130, Train_accy 95.16:  35%|███▌      | 7/20 [00:50<01:27,  6.77s/it]
Task 18, Epoch 8/20 => Loss -0.130, Train_accy 95.16:  40%|████      | 8/20 [00:50<01:12,  6.06s/it]
Task 18, Epoch 9/20 => Loss -0.188, Train_accy 96.48:  40%|████      | 8/20 [00:54<01:12,  6.06s/it]
Task 18, Epoch 9/20 => Loss -0.188, Train_accy 96.48:  45%|████▌     | 9/20 [00:54<01:01,  5.60s/it]
Task 18, Epoch 10/20 => Loss -0.108, Train_accy 94.51, Test_accy 69.34:  45%|████▌     | 9/20 [01:13<01:01,  5.60s/it]
Task 18, Epoch 10/20 => Loss -0.108, Train_accy 94.51, Test_accy 69.34:  50%|█████     | 10/20 [01:13<01:35,  9.54s/it]
Task 18, Epoch 11/20 => Loss -0.162, Train_accy 95.82:  50%|█████     | 10/20 [01:17<01:35,  9.54s/it]                 
Task 18, Epoch 11/20 => Loss -0.162, Train_accy 95.82:  55%|█████▌    | 11/20 [01:17<01:12,  8.02s/it]
Task 18, Epoch 12/20 => Loss -0.210, Train_accy 98.24:  55%|█████▌    | 11/20 [01:22<01:12,  8.02s/it]
Task 18, Epoch 12/20 => Loss -0.210, Train_accy 98.24:  60%|██████    | 12/20 [01:22<00:55,  6.97s/it]
Task 18, Epoch 13/20 => Loss -0.167, Train_accy 95.82:  60%|██████    | 12/20 [01:26<00:55,  6.97s/it]
Task 18, Epoch 13/20 => Loss -0.167, Train_accy 95.82:  65%|██████▌   | 13/20 [01:26<00:43,  6.25s/it]
Task 18, Epoch 14/20 => Loss -0.200, Train_accy 97.58:  65%|██████▌   | 13/20 [01:31<00:43,  6.25s/it]
Task 18, Epoch 14/20 => Loss -0.200, Train_accy 97.58:  70%|███████   | 14/20 [01:31<00:34,  5.74s/it]
Task 18, Epoch 15/20 => Loss -0.162, Train_accy 96.48, Test_accy 69.16:  70%|███████   | 14/20 [01:49<00:34,  5.74s/it]
Task 18, Epoch 15/20 => Loss -0.162, Train_accy 96.48, Test_accy 69.16:  75%|███████▌  | 15/20 [01:49<00:47,  9.56s/it]
Task 18, Epoch 16/20 => Loss -0.182, Train_accy 97.36:  75%|███████▌  | 15/20 [01:54<00:47,  9.56s/it]                 
Task 18, Epoch 16/20 => Loss -0.182, Train_accy 97.36:  80%|████████  | 16/20 [01:54<00:32,  8.07s/it]
Task 18, Epoch 17/20 => Loss -0.162, Train_accy 95.38:  80%|████████  | 16/20 [01:59<00:32,  8.07s/it]
Task 18, Epoch 17/20 => Loss -0.162, Train_accy 95.38:  85%|████████▌ | 17/20 [01:59<00:21,  7.03s/it]
Task 18, Epoch 18/20 => Loss -0.198, Train_accy 96.70:  85%|████████▌ | 17/20 [02:03<00:21,  7.03s/it]
Task 18, Epoch 18/20 => Loss -0.198, Train_accy 96.70:  90%|█████████ | 18/20 [02:03<00:12,  6.30s/it]
Task 18, Epoch 19/20 => Loss -0.170, Train_accy 97.58:  90%|█████████ | 18/20 [02:08<00:12,  6.30s/it]
Task 18, Epoch 19/20 => Loss -0.170, Train_accy 97.58:  95%|█████████▌| 19/20 [02:08<00:05,  5.79s/it]
Task 18, Epoch 20/20 => Loss -0.177, Train_accy 97.14, Test_accy 69.42:  95%|█████████▌| 19/20 [02:26<00:05,  5.79s/it]
Task 18, Epoch 20/20 => Loss -0.177, Train_accy 97.14, Test_accy 69.42: 100%|██████████| 20/20 [02:26<00:00,  9.57s/it]
Task 18, Epoch 20/20 => Loss -0.177, Train_accy 97.14, Test_accy 69.42: 100%|██████████| 20/20 [02:26<00:00,  7.33s/it]
2024-09-05 22:17:16,094 [l2p.py] => Task 18, Epoch 20/20 => Loss -0.177, Train_accy 97.14, Test_accy 69.42
2024-09-05 22:17:29,952 [trainer.py] => No NME accuracy.
2024-09-05 22:17:29,953 [trainer.py] => CNN: {'total': 69.42, '00-09': 48.31, '10-19': 44.19, '20-29': 84.54, '30-39': 65.45, '40-49': 66.36, '50-59': 63.96, '60-69': 69.81, '70-79': 73.76, '80-89': 76.69, '90-99': 66.18, '100-109': 87.83, '110-119': 80.53, '120-129': 79.44, '130-139': 64.41, '140-149': 73.02, '150-159': 67.74, '160-169': 76.12, '170-179': 65.05, '180-189': 68.94, 'old': 69.45, 'new': 68.94}
2024-09-05 22:17:29,953 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6, 73.31, 73.23, 72.45, 71.41, 70.54, 69.42]
2024-09-05 22:17:29,953 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31, 97.14, 96.89, 96.46, 95.75, 95.58, 95.35]

Average Accuracy (CNN): 79.86
2024-09-05 22:17:29,953 [trainer.py] => Average Accuracy (CNN): 79.86 

2024-09-05 22:17:29,957 [trainer.py] => All params: 171970192
2024-09-05 22:17:29,959 [trainer.py] => Trainable params: 199880
2024-09-05 22:17:29,959 [l2p.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.659, Train_accy 72.64:   0%|          | 0/20 [00:04<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.659, Train_accy 72.64:   5%|▌         | 1/20 [00:04<01:34,  4.96s/it]
Task 19, Epoch 2/20 => Loss 0.022, Train_accy 92.56:   5%|▌         | 1/20 [00:09<01:34,  4.96s/it]
Task 19, Epoch 2/20 => Loss 0.022, Train_accy 92.56:  10%|█         | 2/20 [00:09<01:29,  4.97s/it]
Task 19, Epoch 3/20 => Loss -0.061, Train_accy 92.56:  10%|█         | 2/20 [00:14<01:29,  4.97s/it]
Task 19, Epoch 3/20 => Loss -0.061, Train_accy 92.56:  15%|█▌        | 3/20 [00:14<01:24,  4.95s/it]
Task 19, Epoch 4/20 => Loss -0.071, Train_accy 94.16:  15%|█▌        | 3/20 [00:19<01:24,  4.95s/it]
Task 19, Epoch 4/20 => Loss -0.071, Train_accy 94.16:  20%|██        | 4/20 [00:19<01:19,  4.96s/it]
Task 19, Epoch 5/20 => Loss -0.117, Train_accy 95.17, Test_accy 68.19:  20%|██        | 4/20 [00:39<01:19,  4.96s/it]
Task 19, Epoch 5/20 => Loss -0.117, Train_accy 95.17, Test_accy 68.19:  25%|██▌       | 5/20 [00:39<02:32, 10.16s/it]
Task 19, Epoch 6/20 => Loss -0.143, Train_accy 96.18:  25%|██▌       | 5/20 [00:44<02:32, 10.16s/it]                 
Task 19, Epoch 6/20 => Loss -0.143, Train_accy 96.18:  30%|███       | 6/20 [00:44<01:57,  8.39s/it]
Task 19, Epoch 7/20 => Loss -0.114, Train_accy 95.17:  30%|███       | 6/20 [00:49<01:57,  8.39s/it]
Task 19, Epoch 7/20 => Loss -0.114, Train_accy 95.17:  35%|███▌      | 7/20 [00:49<01:34,  7.27s/it]
Task 19, Epoch 8/20 => Loss -0.134, Train_accy 95.37:  35%|███▌      | 7/20 [00:54<01:34,  7.27s/it]
Task 19, Epoch 8/20 => Loss -0.134, Train_accy 95.37:  40%|████      | 8/20 [00:54<01:18,  6.54s/it]
Task 19, Epoch 9/20 => Loss -0.136, Train_accy 94.16:  40%|████      | 8/20 [00:59<01:18,  6.54s/it]
Task 19, Epoch 9/20 => Loss -0.136, Train_accy 94.16:  45%|████▌     | 9/20 [00:59<01:06,  6.05s/it]
Task 19, Epoch 10/20 => Loss -0.136, Train_accy 95.77, Test_accy 68.62:  45%|████▌     | 9/20 [01:18<01:06,  6.05s/it]
Task 19, Epoch 10/20 => Loss -0.136, Train_accy 95.77, Test_accy 68.62:  50%|█████     | 10/20 [01:18<01:41, 10.16s/it]
Task 19, Epoch 11/20 => Loss -0.161, Train_accy 96.18:  50%|█████     | 10/20 [01:23<01:41, 10.16s/it]                 
Task 19, Epoch 11/20 => Loss -0.161, Train_accy 96.18:  55%|█████▌    | 11/20 [01:23<01:17,  8.56s/it]
Task 19, Epoch 12/20 => Loss -0.132, Train_accy 95.57:  55%|█████▌    | 11/20 [01:28<01:17,  8.56s/it]
Task 19, Epoch 12/20 => Loss -0.132, Train_accy 95.57:  60%|██████    | 12/20 [01:28<00:59,  7.46s/it]
Task 19, Epoch 13/20 => Loss -0.166, Train_accy 96.18:  60%|██████    | 12/20 [01:33<00:59,  7.46s/it]
Task 19, Epoch 13/20 => Loss -0.166, Train_accy 96.18:  65%|██████▌   | 13/20 [01:33<00:46,  6.70s/it]
Task 19, Epoch 14/20 => Loss -0.149, Train_accy 96.58:  65%|██████▌   | 13/20 [01:38<00:46,  6.70s/it]
Task 19, Epoch 14/20 => Loss -0.149, Train_accy 96.58:  70%|███████   | 14/20 [01:38<00:36,  6.16s/it]
Task 19, Epoch 15/20 => Loss -0.177, Train_accy 97.18, Test_accy 67.68:  70%|███████   | 14/20 [01:57<00:36,  6.16s/it]
Task 19, Epoch 15/20 => Loss -0.177, Train_accy 97.18, Test_accy 67.68:  75%|███████▌  | 15/20 [01:57<00:50, 10.14s/it]
Task 19, Epoch 16/20 => Loss -0.182, Train_accy 97.38:  75%|███████▌  | 15/20 [02:02<00:50, 10.14s/it]                 
Task 19, Epoch 16/20 => Loss -0.182, Train_accy 97.38:  80%|████████  | 16/20 [02:02<00:34,  8.58s/it]
Task 19, Epoch 17/20 => Loss -0.152, Train_accy 96.58:  80%|████████  | 16/20 [02:07<00:34,  8.58s/it]
Task 19, Epoch 17/20 => Loss -0.152, Train_accy 96.58:  85%|████████▌ | 17/20 [02:07<00:22,  7.50s/it]
Task 19, Epoch 18/20 => Loss -0.182, Train_accy 96.78:  85%|████████▌ | 17/20 [02:12<00:22,  7.50s/it]
Task 19, Epoch 18/20 => Loss -0.182, Train_accy 96.78:  90%|█████████ | 18/20 [02:12<00:13,  6.74s/it]
Task 19, Epoch 19/20 => Loss -0.170, Train_accy 95.77:  90%|█████████ | 18/20 [02:17<00:13,  6.74s/it]
Task 19, Epoch 19/20 => Loss -0.170, Train_accy 95.77:  95%|█████████▌| 19/20 [02:17<00:06,  6.20s/it]
Task 19, Epoch 20/20 => Loss -0.123, Train_accy 95.57, Test_accy 69.17:  95%|█████████▌| 19/20 [02:36<00:06,  6.20s/it]
Task 19, Epoch 20/20 => Loss -0.123, Train_accy 95.57, Test_accy 69.17: 100%|██████████| 20/20 [02:36<00:00, 10.15s/it]
Task 19, Epoch 20/20 => Loss -0.123, Train_accy 95.57, Test_accy 69.17: 100%|██████████| 20/20 [02:36<00:00,  7.84s/it]
2024-09-05 22:20:06,770 [l2p.py] => Task 19, Epoch 20/20 => Loss -0.123, Train_accy 95.57, Test_accy 69.17
2024-09-05 22:20:21,202 [trainer.py] => No NME accuracy.
2024-09-05 22:20:21,203 [trainer.py] => CNN: {'total': 69.17, '00-09': 51.69, '10-19': 44.19, '20-29': 86.6, '30-39': 64.55, '40-49': 68.22, '50-59': 64.86, '60-69': 69.81, '70-79': 73.05, '80-89': 75.94, '90-99': 65.44, '100-109': 86.96, '110-119': 79.65, '120-129': 79.44, '130-139': 65.25, '140-149': 73.81, '150-159': 67.74, '160-169': 65.67, '170-179': 66.02, '180-189': 68.18, '190-199': 72.45, 'old': 69.03, 'new': 72.45}
2024-09-05 22:20:21,203 [trainer.py] => CNN top1 curve: [99.15, 91.9, 90.7, 89.43, 88.41, 84.23, 82.13, 81.5, 78.52, 77.19, 75.44, 74.72, 73.6, 73.31, 73.23, 72.45, 71.41, 70.54, 69.42, 69.17]
2024-09-05 22:20:21,203 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.42, 99.12, 99.11, 98.36, 98.07, 98.04, 98.29, 98.15, 97.77, 97.6, 97.31, 97.14, 96.89, 96.46, 95.75, 95.58, 95.35, 95.04]

Average Accuracy (CNN): 79.32
2024-09-05 22:20:21,203 [trainer.py] => Average Accuracy (CNN): 79.32 

Accuracy Matrix (CNN):
[[99.15 97.46 93.22 93.22 90.68 75.42 74.58 72.03 68.64 68.64 66.95 65.25
  59.32 60.17 57.63 54.24 51.69 50.   48.31 51.69]
 [ 0.   86.82 86.82 86.82 85.27 85.27 83.72 76.74 58.14 58.14 51.16 48.84
  46.51 47.29 47.29 47.29 46.51 44.19 44.19 44.19]
 [ 0.    0.   92.78 92.78 93.81 94.85 93.81 93.81 94.85 94.85 93.81 93.81
  88.66 88.66 88.66 86.6  86.6  85.57 84.54 86.6 ]
 [ 0.    0.    0.   85.45 85.45 79.09 77.27 78.18 76.36 76.36 74.55 74.55
  67.27 67.27 69.09 68.18 66.36 68.18 65.45 64.55]
 [ 0.    0.    0.    0.   87.85 87.85 85.98 85.98 85.98 85.98 78.5  77.57
  75.7  76.64 73.83 74.77 65.42 66.36 66.36 68.22]
 [ 0.    0.    0.    0.    0.   84.68 82.88 81.98 81.98 81.98 74.77 72.97
  72.97 72.97 64.86 62.16 61.26 62.16 63.96 64.86]
 [ 0.    0.    0.    0.    0.    0.   78.3  78.3  79.25 79.25 80.19 74.53
  76.42 76.42 76.42 76.42 75.47 68.87 69.81 69.81]
 [ 0.    0.    0.    0.    0.    0.    0.   86.52 84.4  79.43 78.01 75.89
  75.89 76.6  75.18 73.76 73.76 74.47 73.76 73.05]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   81.2  80.45 78.2  75.94
  76.69 76.69 76.69 78.2  77.44 76.69 76.69 75.94]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   72.79 72.06 71.32
  68.38 66.91 66.91 65.44 66.18 66.18 66.18 65.44]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   87.83 88.7
  89.57 87.83 88.7  86.96 87.83 87.83 87.83 86.96]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   84.07
  84.07 83.19 80.53 80.53 79.65 80.53 80.53 79.65]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  82.24 80.37 82.24 85.05 85.98 85.05 79.44 79.44]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.   72.03 72.88 72.03 71.19 72.03 64.41 65.25]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.   83.33 84.13 76.19 75.4  73.02 73.81]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.   69.35 68.55 66.94 67.74 67.74]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.   78.36 76.87 76.12 65.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.   66.02 65.05 66.02]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.   68.94 68.18]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   0.    0.    0.    0.    0.    0.    0.   72.45]]
2024-09-05 22:20:21,210 [trainer.py] => Forgetting (CNN): 12.722631578947366
2024-09-05 22:20:23,963 [trainer.py] => config: ./exps/l2p_cub_B100_Inc5.json
2024-09-05 22:20:23,988 [trainer.py] => prefix:  
2024-09-05 22:20:23,988 [trainer.py] => dataset: cub
2024-09-05 22:20:23,988 [trainer.py] => memory_size: 0
2024-09-05 22:20:23,988 [trainer.py] => memory_per_class: 0
2024-09-05 22:20:23,988 [trainer.py] => fixed_memory: False
2024-09-05 22:20:23,988 [trainer.py] => shuffle: True
2024-09-05 22:20:23,988 [trainer.py] => init_cls: 100
2024-09-05 22:20:23,989 [trainer.py] => increment: 20
2024-09-05 22:20:23,989 [trainer.py] => model_name: l2p
2024-09-05 22:20:23,989 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-05 22:20:23,989 [trainer.py] => get_original_backbone: True
2024-09-05 22:20:23,989 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 22:20:23,989 [trainer.py] => seed: 1993
2024-09-05 22:20:23,989 [trainer.py] => tuned_epoch: 20
2024-09-05 22:20:23,989 [trainer.py] => init_lr: 0.001875
2024-09-05 22:20:23,989 [trainer.py] => batch_size: 48
2024-09-05 22:20:23,989 [trainer.py] => weight_decay: 0
2024-09-05 22:20:23,989 [trainer.py] => min_lr: 1e-05
2024-09-05 22:20:23,989 [trainer.py] => optimizer: adam
2024-09-05 22:20:23,989 [trainer.py] => scheduler: constant
2024-09-05 22:20:23,989 [trainer.py] => reinit_optimizer: True
2024-09-05 22:20:23,989 [trainer.py] => global_pool: token
2024-09-05 22:20:23,989 [trainer.py] => head_type: prompt
2024-09-05 22:20:23,989 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-05 22:20:23,989 [trainer.py] => pretrained: True
2024-09-05 22:20:23,989 [trainer.py] => drop: 0.0
2024-09-05 22:20:23,989 [trainer.py] => drop_path: 0.0
2024-09-05 22:20:23,989 [trainer.py] => prompt_pool: True
2024-09-05 22:20:23,990 [trainer.py] => size: 10
2024-09-05 22:20:23,990 [trainer.py] => length: 5
2024-09-05 22:20:23,990 [trainer.py] => top_k: 5
2024-09-05 22:20:23,990 [trainer.py] => initializer: uniform
2024-09-05 22:20:23,990 [trainer.py] => prompt_key: True
2024-09-05 22:20:23,990 [trainer.py] => prompt_key_init: uniform
2024-09-05 22:20:23,990 [trainer.py] => use_prompt_mask: False
2024-09-05 22:20:23,990 [trainer.py] => shared_prompt_pool: False
2024-09-05 22:20:23,990 [trainer.py] => shared_prompt_key: False
2024-09-05 22:20:23,990 [trainer.py] => batchwise_prompt: True
2024-09-05 22:20:23,990 [trainer.py] => embedding_key: cls
2024-09-05 22:20:23,990 [trainer.py] => predefined_key: 
2024-09-05 22:20:23,990 [trainer.py] => pull_constraint: True
2024-09-05 22:20:23,990 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-05 22:20:24,031 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 22:20:25,488 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-05 22:20:25,489 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-05 22:20:27,362 [l2p.py] => 86,017,736 model total parameters.
2024-09-05 22:20:27,362 [l2p.py] => 199,880 model training parameters.
2024-09-05 22:20:27,362 [l2p.py] => prompt.prompt: 38400
2024-09-05 22:20:27,362 [l2p.py] => prompt.prompt_key: 7680
2024-09-05 22:20:27,363 [l2p.py] => head.weight: 153600
2024-09-05 22:20:27,363 [l2p.py] => head.bias: 200
2024-09-05 22:20:27,364 [trainer.py] => All params: 171970192
2024-09-05 22:20:27,364 [trainer.py] => Trainable params: 199880
2024-09-05 22:20:27,364 [l2p.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.865, Train_accy 56.77:   0%|          | 0/20 [00:43<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.865, Train_accy 56.77:   5%|▌         | 1/20 [00:43<13:41, 43.24s/it]
Task 0, Epoch 2/20 => Loss 0.771, Train_accy 77.78:   5%|▌         | 1/20 [01:26<13:41, 43.24s/it]
Task 0, Epoch 2/20 => Loss 0.771, Train_accy 77.78:  10%|█         | 2/20 [01:26<12:56, 43.15s/it]
Task 0, Epoch 3/20 => Loss 0.532, Train_accy 83.19:  10%|█         | 2/20 [02:09<12:56, 43.15s/it]
Task 0, Epoch 3/20 => Loss 0.532, Train_accy 83.19:  15%|█▌        | 3/20 [02:09<12:13, 43.16s/it]
Task 0, Epoch 4/20 => Loss 0.460, Train_accy 84.38:  15%|█▌        | 3/20 [02:52<12:13, 43.16s/it]
Task 0, Epoch 4/20 => Loss 0.460, Train_accy 84.38:  20%|██        | 4/20 [02:52<11:31, 43.24s/it]
Task 0, Epoch 5/20 => Loss 0.348, Train_accy 85.47, Test_accy 89.73:  20%|██        | 4/20 [03:43<11:31, 43.24s/it]
Task 0, Epoch 5/20 => Loss 0.348, Train_accy 85.47, Test_accy 89.73:  25%|██▌       | 5/20 [03:43<11:29, 45.98s/it]
Task 0, Epoch 6/20 => Loss 0.278, Train_accy 87.11:  25%|██▌       | 5/20 [04:27<11:29, 45.98s/it]                 
Task 0, Epoch 6/20 => Loss 0.278, Train_accy 87.11:  30%|███       | 6/20 [04:27<10:31, 45.09s/it]
Task 0, Epoch 7/20 => Loss 0.281, Train_accy 86.94:  30%|███       | 6/20 [05:10<10:31, 45.09s/it]
Task 0, Epoch 7/20 => Loss 0.281, Train_accy 86.94:  35%|███▌      | 7/20 [05:10<09:38, 44.48s/it]
Task 0, Epoch 8/20 => Loss 0.187, Train_accy 88.54:  35%|███▌      | 7/20 [05:53<09:38, 44.48s/it]
Task 0, Epoch 8/20 => Loss 0.187, Train_accy 88.54:  40%|████      | 8/20 [05:53<08:48, 44.08s/it]
Task 0, Epoch 9/20 => Loss 0.189, Train_accy 88.71:  40%|████      | 8/20 [06:36<08:48, 44.08s/it]
Task 0, Epoch 9/20 => Loss 0.189, Train_accy 88.71:  45%|████▌     | 9/20 [06:36<08:02, 43.86s/it]
Task 0, Epoch 10/20 => Loss 0.157, Train_accy 89.73, Test_accy 92.09:  45%|████▌     | 9/20 [07:27<08:02, 43.86s/it]
Task 0, Epoch 10/20 => Loss 0.157, Train_accy 89.73, Test_accy 92.09:  50%|█████     | 10/20 [07:27<07:39, 46.00s/it]
Task 0, Epoch 11/20 => Loss 0.155, Train_accy 89.63:  50%|█████     | 10/20 [08:10<07:39, 46.00s/it]                 
Task 0, Epoch 11/20 => Loss 0.155, Train_accy 89.63:  55%|█████▌    | 11/20 [08:10<06:46, 45.17s/it]
Task 0, Epoch 12/20 => Loss 0.144, Train_accy 89.48:  55%|█████▌    | 11/20 [08:54<06:46, 45.17s/it]
Task 0, Epoch 12/20 => Loss 0.144, Train_accy 89.48:  60%|██████    | 12/20 [08:54<05:56, 44.60s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 90.14:  60%|██████    | 12/20 [09:37<05:56, 44.60s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 90.14:  65%|██████▌   | 13/20 [09:37<05:09, 44.20s/it]
Task 0, Epoch 14/20 => Loss 0.142, Train_accy 89.69:  65%|██████▌   | 13/20 [10:20<05:09, 44.20s/it]
Task 0, Epoch 14/20 => Loss 0.142, Train_accy 89.69:  70%|███████   | 14/20 [10:20<04:23, 43.95s/it]
Task 0, Epoch 15/20 => Loss 0.119, Train_accy 90.35, Test_accy 91.25:  70%|███████   | 14/20 [11:11<04:23, 43.95s/it]
Task 0, Epoch 15/20 => Loss 0.119, Train_accy 90.35, Test_accy 91.25:  75%|███████▌  | 15/20 [11:11<03:49, 45.98s/it]
Task 0, Epoch 16/20 => Loss 0.115, Train_accy 91.20:  75%|███████▌  | 15/20 [11:54<03:49, 45.98s/it]                 
Task 0, Epoch 16/20 => Loss 0.115, Train_accy 91.20:  80%|████████  | 16/20 [11:54<03:00, 45.14s/it]
Task 0, Epoch 17/20 => Loss 0.086, Train_accy 91.29:  80%|████████  | 16/20 [12:38<03:00, 45.14s/it]
Task 0, Epoch 17/20 => Loss 0.086, Train_accy 91.29:  85%|████████▌ | 17/20 [12:38<02:13, 44.56s/it]
Task 0, Epoch 18/20 => Loss 0.074, Train_accy 91.50:  85%|████████▌ | 17/20 [13:21<02:13, 44.56s/it]
Task 0, Epoch 18/20 => Loss 0.074, Train_accy 91.50:  90%|█████████ | 18/20 [13:21<01:28, 44.20s/it]
Task 0, Epoch 19/20 => Loss 0.088, Train_accy 91.22:  90%|█████████ | 18/20 [14:04<01:28, 44.20s/it]
Task 0, Epoch 19/20 => Loss 0.088, Train_accy 91.22:  95%|█████████▌| 19/20 [14:04<00:43, 43.94s/it]
Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50:  95%|█████████▌| 19/20 [14:55<00:43, 43.94s/it]
Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50: 100%|██████████| 20/20 [14:55<00:00, 46.01s/it]
Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50: 100%|██████████| 20/20 [14:55<00:00, 44.78s/it]
2024-09-05 22:35:23,430 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50
2024-09-05 22:35:30,937 [trainer.py] => No NME accuracy.
2024-09-05 22:35:30,938 [trainer.py] => CNN: {'total': 91.5, '00-99': 91.5, 'old': 0, 'new': 91.5}
2024-09-05 22:35:30,938 [trainer.py] => CNN top1 curve: [91.5]
2024-09-05 22:35:30,938 [trainer.py] => CNN top5 curve: [99.07]

Average Accuracy (CNN): 91.5
2024-09-05 22:35:30,938 [trainer.py] => Average Accuracy (CNN): 91.5 

2024-09-05 22:35:30,942 [trainer.py] => All params: 171970192
2024-09-05 22:35:30,944 [trainer.py] => Trainable params: 199880
2024-09-05 22:35:30,944 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.647, Train_accy 77.94:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.647, Train_accy 77.94:   5%|▌         | 1/20 [00:09<02:54,  9.17s/it]
Task 1, Epoch 2/20 => Loss -0.045, Train_accy 93.38:   5%|▌         | 1/20 [00:18<02:54,  9.17s/it]
Task 1, Epoch 2/20 => Loss -0.045, Train_accy 93.38:  10%|█         | 2/20 [00:18<02:44,  9.13s/it]
Task 1, Epoch 3/20 => Loss -0.096, Train_accy 95.69:  10%|█         | 2/20 [00:27<02:44,  9.13s/it]
Task 1, Epoch 3/20 => Loss -0.096, Train_accy 95.69:  15%|█▌        | 3/20 [00:27<02:35,  9.14s/it]
Task 1, Epoch 4/20 => Loss -0.112, Train_accy 95.38:  15%|█▌        | 3/20 [00:36<02:35,  9.14s/it]
Task 1, Epoch 4/20 => Loss -0.112, Train_accy 95.38:  20%|██        | 4/20 [00:36<02:26,  9.13s/it]
Task 1, Epoch 5/20 => Loss -0.113, Train_accy 95.90, Test_accy 82.27:  20%|██        | 4/20 [00:54<02:26,  9.13s/it]
Task 1, Epoch 5/20 => Loss -0.113, Train_accy 95.90, Test_accy 82.27:  25%|██▌       | 5/20 [00:54<03:04, 12.33s/it]
Task 1, Epoch 6/20 => Loss -0.111, Train_accy 96.11:  25%|██▌       | 5/20 [01:03<03:04, 12.33s/it]                 
Task 1, Epoch 6/20 => Loss -0.111, Train_accy 96.11:  30%|███       | 6/20 [01:03<02:37, 11.24s/it]
Task 1, Epoch 7/20 => Loss -0.160, Train_accy 96.85:  30%|███       | 6/20 [01:12<02:37, 11.24s/it]
Task 1, Epoch 7/20 => Loss -0.160, Train_accy 96.85:  35%|███▌      | 7/20 [01:12<02:17, 10.54s/it]
Task 1, Epoch 8/20 => Loss -0.085, Train_accy 95.17:  35%|███▌      | 7/20 [01:21<02:17, 10.54s/it]
Task 1, Epoch 8/20 => Loss -0.085, Train_accy 95.17:  40%|████      | 8/20 [01:21<02:01, 10.09s/it]
Task 1, Epoch 9/20 => Loss -0.104, Train_accy 95.17:  40%|████      | 8/20 [01:31<02:01, 10.09s/it]
Task 1, Epoch 9/20 => Loss -0.104, Train_accy 95.17:  45%|████▌     | 9/20 [01:31<01:47,  9.80s/it]
Task 1, Epoch 10/20 => Loss -0.085, Train_accy 94.96, Test_accy 82.91:  45%|████▌     | 9/20 [01:49<01:47,  9.80s/it]
Task 1, Epoch 10/20 => Loss -0.085, Train_accy 94.96, Test_accy 82.91:  50%|█████     | 10/20 [01:49<02:03, 12.33s/it]
Task 1, Epoch 11/20 => Loss -0.161, Train_accy 97.16:  50%|█████     | 10/20 [01:58<02:03, 12.33s/it]                 
Task 1, Epoch 11/20 => Loss -0.161, Train_accy 97.16:  55%|█████▌    | 11/20 [01:58<01:42, 11.35s/it]
Task 1, Epoch 12/20 => Loss -0.168, Train_accy 96.95:  55%|█████▌    | 11/20 [02:07<01:42, 11.35s/it]
Task 1, Epoch 12/20 => Loss -0.168, Train_accy 96.95:  60%|██████    | 12/20 [02:07<01:25, 10.67s/it]
Task 1, Epoch 13/20 => Loss -0.151, Train_accy 97.27:  60%|██████    | 12/20 [02:16<01:25, 10.67s/it]
Task 1, Epoch 13/20 => Loss -0.151, Train_accy 97.27:  65%|██████▌   | 13/20 [02:16<01:11, 10.20s/it]
Task 1, Epoch 14/20 => Loss -0.131, Train_accy 95.80:  65%|██████▌   | 13/20 [02:25<01:11, 10.20s/it]
Task 1, Epoch 14/20 => Loss -0.131, Train_accy 95.80:  70%|███████   | 14/20 [02:25<00:59,  9.89s/it]
Task 1, Epoch 15/20 => Loss -0.168, Train_accy 96.95, Test_accy 84.11:  70%|███████   | 14/20 [02:43<00:59,  9.89s/it]
Task 1, Epoch 15/20 => Loss -0.168, Train_accy 96.95, Test_accy 84.11:  75%|███████▌  | 15/20 [02:43<01:01, 12.33s/it]
Task 1, Epoch 16/20 => Loss -0.152, Train_accy 97.06:  75%|███████▌  | 15/20 [02:52<01:01, 12.33s/it]                 
Task 1, Epoch 16/20 => Loss -0.152, Train_accy 97.06:  80%|████████  | 16/20 [02:52<00:45, 11.36s/it]
Task 1, Epoch 17/20 => Loss -0.152, Train_accy 96.74:  80%|████████  | 16/20 [03:01<00:45, 11.36s/it]
Task 1, Epoch 17/20 => Loss -0.152, Train_accy 96.74:  85%|████████▌ | 17/20 [03:01<00:32, 10.68s/it]
Task 1, Epoch 18/20 => Loss -0.137, Train_accy 96.22:  85%|████████▌ | 17/20 [03:10<00:32, 10.68s/it]
Task 1, Epoch 18/20 => Loss -0.137, Train_accy 96.22:  90%|█████████ | 18/20 [03:10<00:20, 10.21s/it]
Task 1, Epoch 19/20 => Loss -0.129, Train_accy 96.32:  90%|█████████ | 18/20 [03:20<00:20, 10.21s/it]
Task 1, Epoch 19/20 => Loss -0.129, Train_accy 96.32:  95%|█████████▌| 19/20 [03:20<00:09,  9.89s/it]
Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.10:  95%|█████████▌| 19/20 [03:38<00:09,  9.89s/it]
Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.10: 100%|██████████| 20/20 [03:38<00:00, 12.34s/it]
Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.10: 100%|██████████| 20/20 [03:38<00:00, 10.90s/it]
2024-09-05 22:39:09,031 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.10
2024-09-05 22:39:17,875 [trainer.py] => No NME accuracy.
2024-09-05 22:39:17,876 [trainer.py] => CNN: {'total': 85.1, '00-99': 91.33, '100-119': 52.63, 'old': 91.33, 'new': 52.63}
2024-09-05 22:39:17,876 [trainer.py] => CNN top1 curve: [91.5, 85.1]
2024-09-05 22:39:17,876 [trainer.py] => CNN top5 curve: [99.07, 99.01]

Average Accuracy (CNN): 88.3
2024-09-05 22:39:17,876 [trainer.py] => Average Accuracy (CNN): 88.3 

2024-09-05 22:39:17,879 [trainer.py] => All params: 171970192
2024-09-05 22:39:17,882 [trainer.py] => Trainable params: 199880
2024-09-05 22:39:17,882 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.824, Train_accy 65.72:   0%|          | 0/20 [00:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.824, Train_accy 65.72:   5%|▌         | 1/20 [00:09<02:53,  9.15s/it]
Task 2, Epoch 2/20 => Loss 0.100, Train_accy 87.74:   5%|▌         | 1/20 [00:18<02:53,  9.15s/it]
Task 2, Epoch 2/20 => Loss 0.100, Train_accy 87.74:  10%|█         | 2/20 [00:18<02:44,  9.16s/it]
Task 2, Epoch 3/20 => Loss -0.003, Train_accy 91.51:  10%|█         | 2/20 [00:27<02:44,  9.16s/it]
Task 2, Epoch 3/20 => Loss -0.003, Train_accy 91.51:  15%|█▌        | 3/20 [00:27<02:35,  9.15s/it]
Task 2, Epoch 4/20 => Loss -0.025, Train_accy 90.99:  15%|█▌        | 3/20 [00:36<02:35,  9.15s/it]
Task 2, Epoch 4/20 => Loss -0.025, Train_accy 90.99:  20%|██        | 4/20 [00:36<02:26,  9.14s/it]
Task 2, Epoch 5/20 => Loss 0.014, Train_accy 90.04, Test_accy 78.85:  20%|██        | 4/20 [00:56<02:26,  9.14s/it]
Task 2, Epoch 5/20 => Loss 0.014, Train_accy 90.04, Test_accy 78.85:  25%|██▌       | 5/20 [00:56<03:13, 12.88s/it]
Task 2, Epoch 6/20 => Loss -0.004, Train_accy 90.57:  25%|██▌       | 5/20 [01:05<03:13, 12.88s/it]                
Task 2, Epoch 6/20 => Loss -0.004, Train_accy 90.57:  30%|███       | 6/20 [01:05<02:42, 11.61s/it]
Task 2, Epoch 7/20 => Loss -0.025, Train_accy 91.51:  30%|███       | 6/20 [01:14<02:42, 11.61s/it]
Task 2, Epoch 7/20 => Loss -0.025, Train_accy 91.51:  35%|███▌      | 7/20 [01:14<02:20, 10.80s/it]
Task 2, Epoch 8/20 => Loss -0.080, Train_accy 93.61:  35%|███▌      | 7/20 [01:23<02:20, 10.80s/it]
Task 2, Epoch 8/20 => Loss -0.080, Train_accy 93.61:  40%|████      | 8/20 [01:23<02:03, 10.27s/it]
Task 2, Epoch 9/20 => Loss -0.037, Train_accy 93.19:  40%|████      | 8/20 [01:32<02:03, 10.27s/it]
Task 2, Epoch 9/20 => Loss -0.037, Train_accy 93.19:  45%|████▌     | 9/20 [01:32<01:49,  9.91s/it]
Task 2, Epoch 10/20 => Loss -0.051, Train_accy 92.98, Test_accy 79.83:  45%|████▌     | 9/20 [01:51<01:49,  9.91s/it]
Task 2, Epoch 10/20 => Loss -0.051, Train_accy 92.98, Test_accy 79.83:  50%|█████     | 10/20 [01:51<02:08, 12.83s/it]
Task 2, Epoch 11/20 => Loss -0.060, Train_accy 92.87:  50%|█████     | 10/20 [02:01<02:08, 12.83s/it]                 
Task 2, Epoch 11/20 => Loss -0.060, Train_accy 92.87:  55%|█████▌    | 11/20 [02:01<01:45, 11.69s/it]
Task 2, Epoch 12/20 => Loss -0.035, Train_accy 92.03:  55%|█████▌    | 11/20 [02:10<01:45, 11.69s/it]
Task 2, Epoch 12/20 => Loss -0.035, Train_accy 92.03:  60%|██████    | 12/20 [02:10<01:27, 10.90s/it]
Task 2, Epoch 13/20 => Loss -0.025, Train_accy 91.61:  60%|██████    | 12/20 [02:19<01:27, 10.90s/it]
Task 2, Epoch 13/20 => Loss -0.025, Train_accy 91.61:  65%|██████▌   | 13/20 [02:19<01:12, 10.36s/it]
Task 2, Epoch 14/20 => Loss -0.078, Train_accy 93.61:  65%|██████▌   | 13/20 [02:28<01:12, 10.36s/it]
Task 2, Epoch 14/20 => Loss -0.078, Train_accy 93.61:  70%|███████   | 14/20 [02:28<00:59,  9.98s/it]
Task 2, Epoch 15/20 => Loss -0.094, Train_accy 94.34, Test_accy 80.26:  70%|███████   | 14/20 [02:47<00:59,  9.98s/it]
Task 2, Epoch 15/20 => Loss -0.094, Train_accy 94.34, Test_accy 80.26:  75%|███████▌  | 15/20 [02:47<01:03, 12.77s/it]
Task 2, Epoch 16/20 => Loss -0.126, Train_accy 94.97:  75%|███████▌  | 15/20 [02:56<01:03, 12.77s/it]                 
Task 2, Epoch 16/20 => Loss -0.126, Train_accy 94.97:  80%|████████  | 16/20 [02:56<00:46, 11.66s/it]
Task 2, Epoch 17/20 => Loss -0.094, Train_accy 94.76:  80%|████████  | 16/20 [03:05<00:46, 11.66s/it]
Task 2, Epoch 17/20 => Loss -0.094, Train_accy 94.76:  85%|████████▌ | 17/20 [03:05<00:32, 10.91s/it]
Task 2, Epoch 18/20 => Loss -0.108, Train_accy 94.76:  85%|████████▌ | 17/20 [03:15<00:32, 10.91s/it]
Task 2, Epoch 18/20 => Loss -0.108, Train_accy 94.76:  90%|█████████ | 18/20 [03:15<00:20, 10.38s/it]
Task 2, Epoch 19/20 => Loss -0.119, Train_accy 95.18:  90%|█████████ | 18/20 [03:24<00:20, 10.38s/it]
Task 2, Epoch 19/20 => Loss -0.119, Train_accy 95.18:  95%|█████████▌| 19/20 [03:24<00:10, 10.01s/it]
Task 2, Epoch 20/20 => Loss -0.083, Train_accy 94.34, Test_accy 81.29:  95%|█████████▌| 19/20 [03:43<00:10, 10.01s/it]
Task 2, Epoch 20/20 => Loss -0.083, Train_accy 94.34, Test_accy 81.29: 100%|██████████| 20/20 [03:43<00:00, 12.85s/it]
Task 2, Epoch 20/20 => Loss -0.083, Train_accy 94.34, Test_accy 81.29: 100%|██████████| 20/20 [03:43<00:00, 11.18s/it]
2024-09-05 22:43:01,550 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.083, Train_accy 94.34, Test_accy 81.29
2024-09-05 22:43:11,714 [trainer.py] => No NME accuracy.
2024-09-05 22:43:11,714 [trainer.py] => CNN: {'total': 81.29, '00-99': 91.25, '100-119': 54.82, '120-139': 55.56, 'old': 85.38, 'new': 55.56}
2024-09-05 22:43:11,714 [trainer.py] => CNN top1 curve: [91.5, 85.1, 81.29]
2024-09-05 22:43:11,714 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66]

Average Accuracy (CNN): 85.96
2024-09-05 22:43:11,714 [trainer.py] => Average Accuracy (CNN): 85.96 

2024-09-05 22:43:11,715 [trainer.py] => All params: 171970192
2024-09-05 22:43:11,716 [trainer.py] => Trainable params: 199880
2024-09-05 22:43:11,716 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.767, Train_accy 71.85:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.767, Train_accy 71.85:   5%|▌         | 1/20 [00:08<02:47,  8.83s/it]
Task 3, Epoch 2/20 => Loss 0.019, Train_accy 92.17:   5%|▌         | 1/20 [00:17<02:47,  8.83s/it]
Task 3, Epoch 2/20 => Loss 0.019, Train_accy 92.17:  10%|█         | 2/20 [00:17<02:39,  8.84s/it]
Task 3, Epoch 3/20 => Loss -0.017, Train_accy 91.96:  10%|█         | 2/20 [00:26<02:39,  8.84s/it]
Task 3, Epoch 3/20 => Loss -0.017, Train_accy 91.96:  15%|█▌        | 3/20 [00:26<02:30,  8.83s/it]
Task 3, Epoch 4/20 => Loss -0.061, Train_accy 93.59:  15%|█▌        | 3/20 [00:35<02:30,  8.83s/it]
Task 3, Epoch 4/20 => Loss -0.061, Train_accy 93.59:  20%|██        | 4/20 [00:35<02:21,  8.81s/it]
Task 3, Epoch 5/20 => Loss -0.042, Train_accy 93.04, Test_accy 74.41:  20%|██        | 4/20 [00:55<02:21,  8.81s/it]
Task 3, Epoch 5/20 => Loss -0.042, Train_accy 93.04, Test_accy 74.41:  25%|██▌       | 5/20 [00:55<03:15, 13.03s/it]
Task 3, Epoch 6/20 => Loss -0.055, Train_accy 94.13:  25%|██▌       | 5/20 [01:04<03:15, 13.03s/it]                 
Task 3, Epoch 6/20 => Loss -0.055, Train_accy 94.13:  30%|███       | 6/20 [01:04<02:42, 11.61s/it]
Task 3, Epoch 7/20 => Loss -0.099, Train_accy 95.43:  30%|███       | 6/20 [01:13<02:42, 11.61s/it]
Task 3, Epoch 7/20 => Loss -0.099, Train_accy 95.43:  35%|███▌      | 7/20 [01:13<02:18, 10.69s/it]
Task 3, Epoch 8/20 => Loss -0.111, Train_accy 95.00:  35%|███▌      | 7/20 [01:22<02:18, 10.69s/it]
Task 3, Epoch 8/20 => Loss -0.111, Train_accy 95.00:  40%|████      | 8/20 [01:22<02:01, 10.09s/it]
Task 3, Epoch 9/20 => Loss -0.122, Train_accy 95.22:  40%|████      | 8/20 [01:31<02:01, 10.09s/it]
Task 3, Epoch 9/20 => Loss -0.122, Train_accy 95.22:  45%|████▌     | 9/20 [01:31<01:46,  9.68s/it]
Task 3, Epoch 10/20 => Loss -0.126, Train_accy 95.87, Test_accy 75.15:  45%|████▌     | 9/20 [01:51<01:46,  9.68s/it]
Task 3, Epoch 10/20 => Loss -0.126, Train_accy 95.87, Test_accy 75.15:  50%|█████     | 10/20 [01:51<02:10, 13.03s/it]
Task 3, Epoch 11/20 => Loss -0.109, Train_accy 96.41:  50%|█████     | 10/20 [02:00<02:10, 13.03s/it]                 
Task 3, Epoch 11/20 => Loss -0.109, Train_accy 96.41:  55%|█████▌    | 11/20 [02:00<01:45, 11.75s/it]
Task 3, Epoch 12/20 => Loss -0.127, Train_accy 95.54:  55%|█████▌    | 11/20 [02:09<01:45, 11.75s/it]
Task 3, Epoch 12/20 => Loss -0.127, Train_accy 95.54:  60%|██████    | 12/20 [02:09<01:26, 10.86s/it]
Task 3, Epoch 13/20 => Loss -0.139, Train_accy 96.41:  60%|██████    | 12/20 [02:18<01:26, 10.86s/it]
Task 3, Epoch 13/20 => Loss -0.139, Train_accy 96.41:  65%|██████▌   | 13/20 [02:18<01:11, 10.24s/it]
Task 3, Epoch 14/20 => Loss -0.138, Train_accy 95.87:  65%|██████▌   | 13/20 [02:26<01:11, 10.24s/it]
Task 3, Epoch 14/20 => Loss -0.138, Train_accy 95.87:  70%|███████   | 14/20 [02:26<00:58,  9.82s/it]
Task 3, Epoch 15/20 => Loss -0.119, Train_accy 95.54, Test_accy 76.15:  70%|███████   | 14/20 [02:47<00:58,  9.82s/it]
Task 3, Epoch 15/20 => Loss -0.119, Train_accy 95.54, Test_accy 76.15:  75%|███████▌  | 15/20 [02:47<01:05, 13.03s/it]
Task 3, Epoch 16/20 => Loss -0.116, Train_accy 95.11:  75%|███████▌  | 15/20 [02:56<01:05, 13.03s/it]                 
Task 3, Epoch 16/20 => Loss -0.116, Train_accy 95.11:  80%|████████  | 16/20 [02:56<00:47, 11.76s/it]
Task 3, Epoch 17/20 => Loss -0.110, Train_accy 95.54:  80%|████████  | 16/20 [03:04<00:47, 11.76s/it]
Task 3, Epoch 17/20 => Loss -0.110, Train_accy 95.54:  85%|████████▌ | 17/20 [03:04<00:32, 10.88s/it]
Task 3, Epoch 18/20 => Loss -0.083, Train_accy 95.22:  85%|████████▌ | 17/20 [03:13<00:32, 10.88s/it]
Task 3, Epoch 18/20 => Loss -0.083, Train_accy 95.22:  90%|█████████ | 18/20 [03:13<00:20, 10.26s/it]
Task 3, Epoch 19/20 => Loss -0.126, Train_accy 95.11:  90%|█████████ | 18/20 [03:22<00:20, 10.26s/it]
Task 3, Epoch 19/20 => Loss -0.126, Train_accy 95.11:  95%|█████████▌| 19/20 [03:22<00:09,  9.84s/it]
Task 3, Epoch 20/20 => Loss -0.139, Train_accy 96.41, Test_accy 76.41:  95%|█████████▌| 19/20 [03:43<00:09,  9.84s/it]
Task 3, Epoch 20/20 => Loss -0.139, Train_accy 96.41, Test_accy 76.41: 100%|██████████| 20/20 [03:43<00:00, 13.08s/it]
Task 3, Epoch 20/20 => Loss -0.139, Train_accy 96.41, Test_accy 76.41: 100%|██████████| 20/20 [03:43<00:00, 11.16s/it]
2024-09-05 22:46:55,009 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.139, Train_accy 96.41, Test_accy 76.41
2024-09-05 22:47:06,667 [trainer.py] => No NME accuracy.
2024-09-05 22:47:06,668 [trainer.py] => CNN: {'total': 76.41, '00-99': 90.91, '100-119': 55.7, '120-139': 55.56, '140-159': 45.2, 'old': 81.17, 'new': 45.2}
2024-09-05 22:47:06,668 [trainer.py] => CNN top1 curve: [91.5, 85.1, 81.29, 76.41]
2024-09-05 22:47:06,668 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66, 98.63]

Average Accuracy (CNN): 83.57
2024-09-05 22:47:06,668 [trainer.py] => Average Accuracy (CNN): 83.57 

2024-09-05 22:47:06,671 [trainer.py] => All params: 171970192
2024-09-05 22:47:06,674 [trainer.py] => Trainable params: 199880
2024-09-05 22:47:06,674 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.620, Train_accy 75.68:   0%|          | 0/20 [00:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.620, Train_accy 75.68:   5%|▌         | 1/20 [00:09<02:54,  9.19s/it]
Task 4, Epoch 2/20 => Loss 0.008, Train_accy 92.17:   5%|▌         | 1/20 [00:18<02:54,  9.19s/it]
Task 4, Epoch 2/20 => Loss 0.008, Train_accy 92.17:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]
Task 4, Epoch 3/20 => Loss -0.070, Train_accy 93.32:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]
Task 4, Epoch 3/20 => Loss -0.070, Train_accy 93.32:  15%|█▌        | 3/20 [00:27<02:35,  9.17s/it]
Task 4, Epoch 4/20 => Loss -0.097, Train_accy 94.68:  15%|█▌        | 3/20 [00:36<02:35,  9.17s/it]
Task 4, Epoch 4/20 => Loss -0.097, Train_accy 94.68:  20%|██        | 4/20 [00:36<02:26,  9.17s/it]
Task 4, Epoch 5/20 => Loss -0.071, Train_accy 93.22, Test_accy 70.77:  20%|██        | 4/20 [00:58<02:26,  9.17s/it]
Task 4, Epoch 5/20 => Loss -0.071, Train_accy 93.22, Test_accy 70.77:  25%|██▌       | 5/20 [00:58<03:27, 13.84s/it]
Task 4, Epoch 6/20 => Loss -0.070, Train_accy 93.01:  25%|██▌       | 5/20 [01:07<03:27, 13.84s/it]                 
Task 4, Epoch 6/20 => Loss -0.070, Train_accy 93.01:  30%|███       | 6/20 [01:07<02:51, 12.24s/it]
Task 4, Epoch 7/20 => Loss -0.082, Train_accy 93.95:  30%|███       | 6/20 [01:17<02:51, 12.24s/it]
Task 4, Epoch 7/20 => Loss -0.082, Train_accy 93.95:  35%|███▌      | 7/20 [01:17<02:26, 11.23s/it]
Task 4, Epoch 8/20 => Loss -0.055, Train_accy 93.32:  35%|███▌      | 7/20 [01:26<02:26, 11.23s/it]
Task 4, Epoch 8/20 => Loss -0.055, Train_accy 93.32:  40%|████      | 8/20 [01:26<02:06, 10.58s/it]
Task 4, Epoch 9/20 => Loss -0.090, Train_accy 94.05:  40%|████      | 8/20 [01:35<02:06, 10.58s/it]
Task 4, Epoch 9/20 => Loss -0.090, Train_accy 94.05:  45%|████▌     | 9/20 [01:35<01:51, 10.16s/it]
Task 4, Epoch 10/20 => Loss -0.078, Train_accy 93.84, Test_accy 71.90:  45%|████▌     | 9/20 [01:57<01:51, 10.16s/it]
Task 4, Epoch 10/20 => Loss -0.078, Train_accy 93.84, Test_accy 71.90:  50%|█████     | 10/20 [01:57<02:18, 13.89s/it]
Task 4, Epoch 11/20 => Loss -0.097, Train_accy 94.57:  50%|█████     | 10/20 [02:06<02:18, 13.89s/it]                 
Task 4, Epoch 11/20 => Loss -0.097, Train_accy 94.57:  55%|█████▌    | 11/20 [02:06<01:52, 12.45s/it]
Task 4, Epoch 12/20 => Loss -0.088, Train_accy 94.26:  55%|█████▌    | 11/20 [02:16<01:52, 12.45s/it]
Task 4, Epoch 12/20 => Loss -0.088, Train_accy 94.26:  60%|██████    | 12/20 [02:16<01:31, 11.45s/it]
Task 4, Epoch 13/20 => Loss -0.136, Train_accy 95.93:  60%|██████    | 12/20 [02:25<01:31, 11.45s/it]
Task 4, Epoch 13/20 => Loss -0.136, Train_accy 95.93:  65%|██████▌   | 13/20 [02:25<01:15, 10.77s/it]
Task 4, Epoch 14/20 => Loss -0.142, Train_accy 96.24:  65%|██████▌   | 13/20 [02:34<01:15, 10.77s/it]
Task 4, Epoch 14/20 => Loss -0.142, Train_accy 96.24:  70%|███████   | 14/20 [02:34<01:01, 10.28s/it]
Task 4, Epoch 15/20 => Loss -0.076, Train_accy 94.15, Test_accy 72.51:  70%|███████   | 14/20 [02:56<01:01, 10.28s/it]
Task 4, Epoch 15/20 => Loss -0.076, Train_accy 94.15, Test_accy 72.51:  75%|███████▌  | 15/20 [02:56<01:09, 13.91s/it]
Task 4, Epoch 16/20 => Loss -0.093, Train_accy 94.47:  75%|███████▌  | 15/20 [03:05<01:09, 13.91s/it]                 
Task 4, Epoch 16/20 => Loss -0.093, Train_accy 94.47:  80%|████████  | 16/20 [03:05<00:49, 12.48s/it]
Task 4, Epoch 17/20 => Loss -0.135, Train_accy 95.93:  80%|████████  | 16/20 [03:15<00:49, 12.48s/it]
Task 4, Epoch 17/20 => Loss -0.135, Train_accy 95.93:  85%|████████▌ | 17/20 [03:15<00:34, 11.49s/it]
Task 4, Epoch 18/20 => Loss -0.131, Train_accy 95.82:  85%|████████▌ | 17/20 [03:24<00:34, 11.49s/it]
Task 4, Epoch 18/20 => Loss -0.131, Train_accy 95.82:  90%|█████████ | 18/20 [03:24<00:21, 10.78s/it]
Task 4, Epoch 19/20 => Loss -0.135, Train_accy 95.93:  90%|█████████ | 18/20 [03:33<00:21, 10.78s/it]
Task 4, Epoch 19/20 => Loss -0.135, Train_accy 95.93:  95%|█████████▌| 19/20 [03:33<00:10, 10.29s/it]
Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03:  95%|█████████▌| 19/20 [03:55<00:10, 10.29s/it]
Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03: 100%|██████████| 20/20 [03:55<00:00, 13.87s/it]
Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03: 100%|██████████| 20/20 [03:55<00:00, 11.78s/it]
2024-09-05 22:51:02,312 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03
2024-09-05 22:51:15,353 [trainer.py] => No NME accuracy.
2024-09-05 22:51:15,354 [trainer.py] => CNN: {'total': 73.03, '00-99': 90.99, '100-119': 56.14, '120-139': 54.22, '140-159': 45.2, '160-179': 46.41, 'old': 76.36, 'new': 46.41}
2024-09-05 22:51:15,354 [trainer.py] => CNN top1 curve: [91.5, 85.1, 81.29, 76.41, 73.03]
2024-09-05 22:51:15,354 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66, 98.63, 98.12]

Average Accuracy (CNN): 81.47
2024-09-05 22:51:15,354 [trainer.py] => Average Accuracy (CNN): 81.47 

2024-09-05 22:51:15,357 [trainer.py] => All params: 171970192
2024-09-05 22:51:15,359 [trainer.py] => Trainable params: 199880
2024-09-05 22:51:15,359 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.676, Train_accy 74.79:   0%|          | 0/20 [00:09<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.676, Train_accy 74.79:   5%|▌         | 1/20 [00:09<02:52,  9.10s/it]
Task 5, Epoch 2/20 => Loss -0.009, Train_accy 92.33:   5%|▌         | 1/20 [00:18<02:52,  9.10s/it]
Task 5, Epoch 2/20 => Loss -0.009, Train_accy 92.33:  10%|█         | 2/20 [00:18<02:43,  9.09s/it]
Task 5, Epoch 3/20 => Loss -0.045, Train_accy 92.23:  10%|█         | 2/20 [00:27<02:43,  9.09s/it]
Task 5, Epoch 3/20 => Loss -0.045, Train_accy 92.23:  15%|█▌        | 3/20 [00:27<02:34,  9.08s/it]
Task 5, Epoch 4/20 => Loss -0.073, Train_accy 94.12:  15%|█▌        | 3/20 [00:36<02:34,  9.08s/it]
Task 5, Epoch 4/20 => Loss -0.073, Train_accy 94.12:  20%|██        | 4/20 [00:36<02:25,  9.08s/it]
Task 5, Epoch 5/20 => Loss -0.109, Train_accy 94.43, Test_accy 67.18:  20%|██        | 4/20 [00:59<02:25,  9.08s/it]
Task 5, Epoch 5/20 => Loss -0.109, Train_accy 94.43, Test_accy 67.18:  25%|██▌       | 5/20 [00:59<03:34, 14.30s/it]
Task 5, Epoch 6/20 => Loss -0.073, Train_accy 93.59:  25%|██▌       | 5/20 [01:09<03:34, 14.30s/it]                 
Task 5, Epoch 6/20 => Loss -0.073, Train_accy 93.59:  30%|███       | 6/20 [01:09<02:55, 12.57s/it]
Task 5, Epoch 7/20 => Loss -0.091, Train_accy 94.01:  30%|███       | 6/20 [01:18<02:55, 12.57s/it]
Task 5, Epoch 7/20 => Loss -0.091, Train_accy 94.01:  35%|███▌      | 7/20 [01:18<02:28, 11.45s/it]
Task 5, Epoch 8/20 => Loss -0.098, Train_accy 94.54:  35%|███▌      | 7/20 [01:27<02:28, 11.45s/it]
Task 5, Epoch 8/20 => Loss -0.098, Train_accy 94.54:  40%|████      | 8/20 [01:27<02:08, 10.71s/it]
Task 5, Epoch 9/20 => Loss -0.083, Train_accy 94.01:  40%|████      | 8/20 [01:36<02:08, 10.71s/it]
Task 5, Epoch 9/20 => Loss -0.083, Train_accy 94.01:  45%|████▌     | 9/20 [01:36<01:52, 10.20s/it]
Task 5, Epoch 10/20 => Loss -0.104, Train_accy 94.64, Test_accy 67.98:  45%|████▌     | 9/20 [02:00<01:52, 10.20s/it]
Task 5, Epoch 10/20 => Loss -0.104, Train_accy 94.64, Test_accy 67.98:  50%|█████     | 10/20 [02:00<02:23, 14.33s/it]
Task 5, Epoch 11/20 => Loss -0.088, Train_accy 94.12:  50%|█████     | 10/20 [02:09<02:23, 14.33s/it]                 
Task 5, Epoch 11/20 => Loss -0.088, Train_accy 94.12:  55%|█████▌    | 11/20 [02:09<01:54, 12.74s/it]
Task 5, Epoch 12/20 => Loss -0.092, Train_accy 94.12:  55%|█████▌    | 11/20 [02:18<01:54, 12.74s/it]
Task 5, Epoch 12/20 => Loss -0.092, Train_accy 94.12:  60%|██████    | 12/20 [02:18<01:33, 11.65s/it]
Task 5, Epoch 13/20 => Loss -0.123, Train_accy 95.38:  60%|██████    | 12/20 [02:27<01:33, 11.65s/it]
Task 5, Epoch 13/20 => Loss -0.123, Train_accy 95.38:  65%|██████▌   | 13/20 [02:27<01:16, 10.87s/it]
Task 5, Epoch 14/20 => Loss -0.125, Train_accy 95.17:  65%|██████▌   | 13/20 [02:36<01:16, 10.87s/it]
Task 5, Epoch 14/20 => Loss -0.125, Train_accy 95.17:  70%|███████   | 14/20 [02:36<01:02, 10.35s/it]
Task 5, Epoch 15/20 => Loss -0.109, Train_accy 94.54, Test_accy 68.45:  70%|███████   | 14/20 [03:00<01:02, 10.35s/it]
Task 5, Epoch 15/20 => Loss -0.109, Train_accy 94.54, Test_accy 68.45:  75%|███████▌  | 15/20 [03:00<01:11, 14.32s/it]
Task 5, Epoch 16/20 => Loss -0.118, Train_accy 95.90:  75%|███████▌  | 15/20 [03:09<01:11, 14.32s/it]                 
Task 5, Epoch 16/20 => Loss -0.118, Train_accy 95.90:  80%|████████  | 16/20 [03:09<00:51, 12.76s/it]
Task 5, Epoch 17/20 => Loss -0.099, Train_accy 94.43:  80%|████████  | 16/20 [03:18<00:51, 12.76s/it]
Task 5, Epoch 17/20 => Loss -0.099, Train_accy 94.43:  85%|████████▌ | 17/20 [03:18<00:34, 11.66s/it]
Task 5, Epoch 18/20 => Loss -0.150, Train_accy 96.01:  85%|████████▌ | 17/20 [03:27<00:34, 11.66s/it]
Task 5, Epoch 18/20 => Loss -0.150, Train_accy 96.01:  90%|█████████ | 18/20 [03:27<00:21, 10.90s/it]
Task 5, Epoch 19/20 => Loss -0.148, Train_accy 96.85:  90%|█████████ | 18/20 [03:36<00:21, 10.90s/it]
Task 5, Epoch 19/20 => Loss -0.148, Train_accy 96.85:  95%|█████████▌| 19/20 [03:36<00:10, 10.36s/it]
Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.08:  95%|█████████▌| 19/20 [03:59<00:10, 10.36s/it]
Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.08: 100%|██████████| 20/20 [03:59<00:00, 14.28s/it]
Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.08: 100%|██████████| 20/20 [03:59<00:00, 12.00s/it]
2024-09-05 22:55:15,324 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.08
2024-09-05 22:55:29,656 [trainer.py] => No NME accuracy.
2024-09-05 22:55:29,657 [trainer.py] => CNN: {'total': 69.08, '00-99': 90.82, '100-119': 55.7, '120-139': 53.78, '140-159': 44.4, '160-179': 45.15, '180-199': 36.52, 'old': 72.6, 'new': 36.52}
2024-09-05 22:55:29,657 [trainer.py] => CNN top1 curve: [91.5, 85.1, 81.29, 76.41, 73.03, 69.08]
2024-09-05 22:55:29,657 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66, 98.63, 98.12, 97.12]

Average Accuracy (CNN): 79.4
2024-09-05 22:55:29,657 [trainer.py] => Average Accuracy (CNN): 79.4 

Accuracy Matrix (CNN):
[[91.5  91.33 91.25 90.91 90.99 90.82]
 [ 0.   52.63 54.82 55.7  56.14 55.7 ]
 [ 0.    0.   55.56 55.56 54.22 53.78]
 [ 0.    0.    0.   45.2  45.2  44.4 ]
 [ 0.    0.    0.    0.   46.41 45.15]
 [ 0.    0.    0.    0.    0.   36.52]]
2024-09-05 22:55:29,659 [trainer.py] => Forgetting (CNN): 0.9920000000000015
2024-09-05 22:55:32,351 [trainer.py] => config: ./exps/l2p_cub_B100_Inc10.json
2024-09-05 22:55:32,351 [trainer.py] => prefix:  
2024-09-05 22:55:32,351 [trainer.py] => dataset: cub
2024-09-05 22:55:32,351 [trainer.py] => memory_size: 0
2024-09-05 22:55:32,351 [trainer.py] => memory_per_class: 0
2024-09-05 22:55:32,351 [trainer.py] => fixed_memory: False
2024-09-05 22:55:32,351 [trainer.py] => shuffle: True
2024-09-05 22:55:32,351 [trainer.py] => init_cls: 100
2024-09-05 22:55:32,351 [trainer.py] => increment: 10
2024-09-05 22:55:32,351 [trainer.py] => model_name: l2p
2024-09-05 22:55:32,351 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-09-05 22:55:32,351 [trainer.py] => get_original_backbone: True
2024-09-05 22:55:32,351 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 22:55:32,351 [trainer.py] => seed: 1993
2024-09-05 22:55:32,351 [trainer.py] => tuned_epoch: 20
2024-09-05 22:55:32,351 [trainer.py] => init_lr: 0.001875
2024-09-05 22:55:32,351 [trainer.py] => batch_size: 48
2024-09-05 22:55:32,351 [trainer.py] => weight_decay: 0
2024-09-05 22:55:32,351 [trainer.py] => min_lr: 1e-05
2024-09-05 22:55:32,352 [trainer.py] => optimizer: adam
2024-09-05 22:55:32,352 [trainer.py] => scheduler: constant
2024-09-05 22:55:32,352 [trainer.py] => reinit_optimizer: True
2024-09-05 22:55:32,352 [trainer.py] => global_pool: token
2024-09-05 22:55:32,352 [trainer.py] => head_type: prompt
2024-09-05 22:55:32,352 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-05 22:55:32,352 [trainer.py] => pretrained: True
2024-09-05 22:55:32,352 [trainer.py] => drop: 0.0
2024-09-05 22:55:32,352 [trainer.py] => drop_path: 0.0
2024-09-05 22:55:32,352 [trainer.py] => prompt_pool: True
2024-09-05 22:55:32,352 [trainer.py] => size: 10
2024-09-05 22:55:32,352 [trainer.py] => length: 5
2024-09-05 22:55:32,352 [trainer.py] => top_k: 5
2024-09-05 22:55:32,352 [trainer.py] => initializer: uniform
2024-09-05 22:55:32,352 [trainer.py] => prompt_key: True
2024-09-05 22:55:32,352 [trainer.py] => prompt_key_init: uniform
2024-09-05 22:55:32,352 [trainer.py] => use_prompt_mask: False
2024-09-05 22:55:32,352 [trainer.py] => shared_prompt_pool: False
2024-09-05 22:55:32,352 [trainer.py] => shared_prompt_key: False
2024-09-05 22:55:32,352 [trainer.py] => batchwise_prompt: True
2024-09-05 22:55:32,352 [trainer.py] => embedding_key: cls
2024-09-05 22:55:32,352 [trainer.py] => predefined_key: 
2024-09-05 22:55:32,352 [trainer.py] => pull_constraint: True
2024-09-05 22:55:32,352 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-05 22:55:32,388 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 22:55:33,756 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-09-05 22:55:33,756 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-09-05 22:55:35,462 [l2p.py] => 86,017,736 model total parameters.
2024-09-05 22:55:35,463 [l2p.py] => 199,880 model training parameters.
2024-09-05 22:55:35,463 [l2p.py] => prompt.prompt: 38400
2024-09-05 22:55:35,463 [l2p.py] => prompt.prompt_key: 7680
2024-09-05 22:55:35,463 [l2p.py] => head.weight: 153600
2024-09-05 22:55:35,463 [l2p.py] => head.bias: 200
2024-09-05 22:55:35,464 [trainer.py] => All params: 171970192
2024-09-05 22:55:35,465 [trainer.py] => Trainable params: 199880
2024-09-05 22:55:35,465 [l2p.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.865, Train_accy 56.77:   0%|          | 0/20 [00:43<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.865, Train_accy 56.77:   5%|▌         | 1/20 [00:43<13:45, 43.42s/it]
Task 0, Epoch 2/20 => Loss 0.771, Train_accy 77.78:   5%|▌         | 1/20 [01:26<13:45, 43.42s/it]
Task 0, Epoch 2/20 => Loss 0.771, Train_accy 77.78:  10%|█         | 2/20 [01:26<12:59, 43.29s/it]
Task 0, Epoch 3/20 => Loss 0.532, Train_accy 83.19:  10%|█         | 2/20 [02:09<12:59, 43.29s/it]
Task 0, Epoch 3/20 => Loss 0.532, Train_accy 83.19:  15%|█▌        | 3/20 [02:09<12:15, 43.27s/it]
Task 0, Epoch 4/20 => Loss 0.460, Train_accy 84.38:  15%|█▌        | 3/20 [02:53<12:15, 43.27s/it]
Task 0, Epoch 4/20 => Loss 0.460, Train_accy 84.38:  20%|██        | 4/20 [02:53<11:32, 43.27s/it]
Task 0, Epoch 5/20 => Loss 0.348, Train_accy 85.47, Test_accy 89.73:  20%|██        | 4/20 [03:43<11:32, 43.27s/it]
Task 0, Epoch 5/20 => Loss 0.348, Train_accy 85.47, Test_accy 89.73:  25%|██▌       | 5/20 [03:43<11:29, 45.98s/it]
Task 0, Epoch 6/20 => Loss 0.278, Train_accy 87.11:  25%|██▌       | 5/20 [04:27<11:29, 45.98s/it]                 
Task 0, Epoch 6/20 => Loss 0.278, Train_accy 87.11:  30%|███       | 6/20 [04:27<10:31, 45.07s/it]
Task 0, Epoch 7/20 => Loss 0.281, Train_accy 86.94:  30%|███       | 6/20 [05:10<10:31, 45.07s/it]
Task 0, Epoch 7/20 => Loss 0.281, Train_accy 86.94:  35%|███▌      | 7/20 [05:10<09:38, 44.52s/it]
Task 0, Epoch 8/20 => Loss 0.187, Train_accy 88.54:  35%|███▌      | 7/20 [05:53<09:38, 44.52s/it]
Task 0, Epoch 8/20 => Loss 0.187, Train_accy 88.54:  40%|████      | 8/20 [05:53<08:49, 44.15s/it]
Task 0, Epoch 9/20 => Loss 0.189, Train_accy 88.71:  40%|████      | 8/20 [06:37<08:49, 44.15s/it]
Task 0, Epoch 9/20 => Loss 0.189, Train_accy 88.71:  45%|████▌     | 9/20 [06:37<08:02, 43.89s/it]
Task 0, Epoch 10/20 => Loss 0.157, Train_accy 89.73, Test_accy 92.09:  45%|████▌     | 9/20 [07:28<08:02, 43.89s/it]
Task 0, Epoch 10/20 => Loss 0.157, Train_accy 89.73, Test_accy 92.09:  50%|█████     | 10/20 [07:28<07:40, 46.08s/it]
Task 0, Epoch 11/20 => Loss 0.155, Train_accy 89.63:  50%|█████     | 10/20 [08:11<07:40, 46.08s/it]                 
Task 0, Epoch 11/20 => Loss 0.155, Train_accy 89.63:  55%|█████▌    | 11/20 [08:11<06:47, 45.27s/it]
Task 0, Epoch 12/20 => Loss 0.144, Train_accy 89.48:  55%|█████▌    | 11/20 [08:55<06:47, 45.27s/it]
Task 0, Epoch 12/20 => Loss 0.144, Train_accy 89.48:  60%|██████    | 12/20 [08:55<05:57, 44.71s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 90.14:  60%|██████    | 12/20 [09:38<05:57, 44.71s/it]
Task 0, Epoch 13/20 => Loss 0.130, Train_accy 90.14:  65%|██████▌   | 13/20 [09:38<05:10, 44.31s/it]
Task 0, Epoch 14/20 => Loss 0.142, Train_accy 89.69:  65%|██████▌   | 13/20 [10:21<05:10, 44.31s/it]
Task 0, Epoch 14/20 => Loss 0.142, Train_accy 89.69:  70%|███████   | 14/20 [10:21<04:24, 44.05s/it]
Task 0, Epoch 15/20 => Loss 0.119, Train_accy 90.35, Test_accy 91.25:  70%|███████   | 14/20 [11:12<04:24, 44.05s/it]
Task 0, Epoch 15/20 => Loss 0.119, Train_accy 90.35, Test_accy 91.25:  75%|███████▌  | 15/20 [11:12<03:50, 46.15s/it]
Task 0, Epoch 16/20 => Loss 0.115, Train_accy 91.20:  75%|███████▌  | 15/20 [11:56<03:50, 46.15s/it]                 
Task 0, Epoch 16/20 => Loss 0.115, Train_accy 91.20:  80%|████████  | 16/20 [11:56<03:01, 45.39s/it]
Task 0, Epoch 17/20 => Loss 0.086, Train_accy 91.29:  80%|████████  | 16/20 [12:40<03:01, 45.39s/it]
Task 0, Epoch 17/20 => Loss 0.086, Train_accy 91.29:  85%|████████▌ | 17/20 [12:40<02:14, 44.86s/it]
Task 0, Epoch 18/20 => Loss 0.074, Train_accy 91.50:  85%|████████▌ | 17/20 [13:23<02:14, 44.86s/it]
Task 0, Epoch 18/20 => Loss 0.074, Train_accy 91.50:  90%|█████████ | 18/20 [13:23<01:28, 44.42s/it]
Task 0, Epoch 19/20 => Loss 0.088, Train_accy 91.22:  90%|█████████ | 18/20 [14:07<01:28, 44.42s/it]
Task 0, Epoch 19/20 => Loss 0.088, Train_accy 91.22:  95%|█████████▌| 19/20 [14:07<00:44, 44.15s/it]
Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50:  95%|█████████▌| 19/20 [14:58<00:44, 44.15s/it]
Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50: 100%|██████████| 20/20 [14:58<00:00, 46.17s/it]
Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50: 100%|██████████| 20/20 [14:58<00:00, 44.90s/it]
2024-09-05 23:10:34,076 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50
2024-09-05 23:10:41,587 [trainer.py] => No NME accuracy.
2024-09-05 23:10:41,587 [trainer.py] => CNN: {'total': 91.5, '00-99': 91.5, 'old': 0, 'new': 91.5}
2024-09-05 23:10:41,588 [trainer.py] => CNN top1 curve: [91.5]
2024-09-05 23:10:41,588 [trainer.py] => CNN top5 curve: [99.07]

Average Accuracy (CNN): 91.5
2024-09-05 23:10:41,588 [trainer.py] => Average Accuracy (CNN): 91.5 

2024-09-05 23:10:41,590 [trainer.py] => All params: 171970192
2024-09-05 23:10:41,592 [trainer.py] => Trainable params: 199880
2024-09-05 23:10:41,592 [l2p.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.686, Train_accy 73.80:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.686, Train_accy 73.80:   5%|▌         | 1/20 [00:04<01:32,  4.86s/it]
Task 1, Epoch 2/20 => Loss -0.028, Train_accy 92.52:   5%|▌         | 1/20 [00:09<01:32,  4.86s/it]
Task 1, Epoch 2/20 => Loss -0.028, Train_accy 92.52:  10%|█         | 2/20 [00:09<01:27,  4.86s/it]
Task 1, Epoch 3/20 => Loss -0.117, Train_accy 95.01:  10%|█         | 2/20 [00:14<01:27,  4.86s/it]
Task 1, Epoch 3/20 => Loss -0.117, Train_accy 95.01:  15%|█▌        | 3/20 [00:14<01:22,  4.85s/it]
Task 1, Epoch 4/20 => Loss -0.172, Train_accy 97.71:  15%|█▌        | 3/20 [00:19<01:22,  4.85s/it]
Task 1, Epoch 4/20 => Loss -0.172, Train_accy 97.71:  20%|██        | 4/20 [00:19<01:17,  4.85s/it]
Task 1, Epoch 5/20 => Loss -0.145, Train_accy 95.84, Test_accy 86.11:  20%|██        | 4/20 [00:32<01:17,  4.85s/it]
Task 1, Epoch 5/20 => Loss -0.145, Train_accy 95.84, Test_accy 86.11:  25%|██▌       | 5/20 [00:32<01:56,  7.79s/it]
Task 1, Epoch 6/20 => Loss -0.165, Train_accy 96.88:  25%|██▌       | 5/20 [00:37<01:56,  7.79s/it]                 
Task 1, Epoch 6/20 => Loss -0.165, Train_accy 96.88:  30%|███       | 6/20 [00:37<01:35,  6.79s/it]
Task 1, Epoch 7/20 => Loss -0.194, Train_accy 98.13:  30%|███       | 6/20 [00:42<01:35,  6.79s/it]
Task 1, Epoch 7/20 => Loss -0.194, Train_accy 98.13:  35%|███▌      | 7/20 [00:42<01:19,  6.15s/it]
Task 1, Epoch 8/20 => Loss -0.151, Train_accy 95.84:  35%|███▌      | 7/20 [00:46<01:19,  6.15s/it]
Task 1, Epoch 8/20 => Loss -0.151, Train_accy 95.84:  40%|████      | 8/20 [00:46<01:08,  5.73s/it]
Task 1, Epoch 9/20 => Loss -0.202, Train_accy 97.51:  40%|████      | 8/20 [00:51<01:08,  5.73s/it]
Task 1, Epoch 9/20 => Loss -0.202, Train_accy 97.51:  45%|████▌     | 9/20 [00:51<00:59,  5.45s/it]
Task 1, Epoch 10/20 => Loss -0.202, Train_accy 98.13, Test_accy 86.03:  45%|████▌     | 9/20 [01:04<00:59,  5.45s/it]
Task 1, Epoch 10/20 => Loss -0.202, Train_accy 98.13, Test_accy 86.03:  50%|█████     | 10/20 [01:04<01:17,  7.79s/it]
Task 1, Epoch 11/20 => Loss -0.189, Train_accy 97.09:  50%|█████     | 10/20 [01:09<01:17,  7.79s/it]                 
Task 1, Epoch 11/20 => Loss -0.189, Train_accy 97.09:  55%|█████▌    | 11/20 [01:09<01:02,  6.89s/it]
Task 1, Epoch 12/20 => Loss 0.139, Train_accy 96.88:  55%|█████▌    | 11/20 [01:14<01:02,  6.89s/it] 
Task 1, Epoch 12/20 => Loss 0.139, Train_accy 96.88:  60%|██████    | 12/20 [01:14<00:50,  6.26s/it]
Task 1, Epoch 13/20 => Loss -0.130, Train_accy 95.43:  60%|██████    | 12/20 [01:19<00:50,  6.26s/it]
Task 1, Epoch 13/20 => Loss -0.130, Train_accy 95.43:  65%|██████▌   | 13/20 [01:19<00:40,  5.83s/it]
Task 1, Epoch 14/20 => Loss -0.071, Train_accy 95.43:  65%|██████▌   | 13/20 [01:24<00:40,  5.83s/it]
Task 1, Epoch 14/20 => Loss -0.071, Train_accy 95.43:  70%|███████   | 14/20 [01:24<00:33,  5.54s/it]
Task 1, Epoch 15/20 => Loss -0.181, Train_accy 97.51, Test_accy 86.49:  70%|███████   | 14/20 [01:37<00:33,  5.54s/it]
Task 1, Epoch 15/20 => Loss -0.181, Train_accy 97.51, Test_accy 86.49:  75%|███████▌  | 15/20 [01:37<00:38,  7.79s/it]
Task 1, Epoch 16/20 => Loss -0.151, Train_accy 96.26:  75%|███████▌  | 15/20 [01:42<00:38,  7.79s/it]                 
Task 1, Epoch 16/20 => Loss -0.151, Train_accy 96.26:  80%|████████  | 16/20 [01:42<00:27,  6.90s/it]
Task 1, Epoch 17/20 => Loss -0.188, Train_accy 97.51:  80%|████████  | 16/20 [01:46<00:27,  6.90s/it]
Task 1, Epoch 17/20 => Loss -0.188, Train_accy 97.51:  85%|████████▌ | 17/20 [01:46<00:18,  6.29s/it]
Task 1, Epoch 18/20 => Loss -0.212, Train_accy 98.34:  85%|████████▌ | 17/20 [01:51<00:18,  6.29s/it]
Task 1, Epoch 18/20 => Loss -0.212, Train_accy 98.34:  90%|█████████ | 18/20 [01:51<00:11,  5.85s/it]
Task 1, Epoch 19/20 => Loss -0.184, Train_accy 96.67:  90%|█████████ | 18/20 [01:56<00:11,  5.85s/it]
Task 1, Epoch 19/20 => Loss -0.184, Train_accy 96.67:  95%|█████████▌| 19/20 [01:56<00:05,  5.55s/it]
Task 1, Epoch 20/20 => Loss -0.182, Train_accy 96.88, Test_accy 87.26:  95%|█████████▌| 19/20 [02:09<00:05,  5.55s/it]
Task 1, Epoch 20/20 => Loss -0.182, Train_accy 96.88, Test_accy 87.26: 100%|██████████| 20/20 [02:09<00:00,  7.80s/it]
Task 1, Epoch 20/20 => Loss -0.182, Train_accy 96.88, Test_accy 87.26: 100%|██████████| 20/20 [02:09<00:00,  6.48s/it]
2024-09-05 23:12:51,229 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.182, Train_accy 96.88, Test_accy 87.26
2024-09-05 23:12:59,415 [trainer.py] => No NME accuracy.
2024-09-05 23:12:59,415 [trainer.py] => CNN: {'total': 87.26, '00-99': 91.67, '100-109': 41.74, 'old': 91.67, 'new': 41.74}
2024-09-05 23:12:59,416 [trainer.py] => CNN top1 curve: [91.5, 87.26]
2024-09-05 23:12:59,416 [trainer.py] => CNN top5 curve: [99.07, 98.93]

Average Accuracy (CNN): 89.38
2024-09-05 23:12:59,416 [trainer.py] => Average Accuracy (CNN): 89.38 

2024-09-05 23:12:59,419 [trainer.py] => All params: 171970192
2024-09-05 23:12:59,421 [trainer.py] => Trainable params: 199880
2024-09-05 23:12:59,421 [l2p.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.619, Train_accy 74.31:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.619, Train_accy 74.31:   5%|▌         | 1/20 [00:04<01:29,  4.73s/it]
Task 2, Epoch 2/20 => Loss -0.078, Train_accy 94.90:   5%|▌         | 1/20 [00:09<01:29,  4.73s/it]
Task 2, Epoch 2/20 => Loss -0.078, Train_accy 94.90:  10%|█         | 2/20 [00:09<01:24,  4.72s/it]
Task 2, Epoch 3/20 => Loss -0.118, Train_accy 96.39:  10%|█         | 2/20 [00:14<01:24,  4.72s/it]
Task 2, Epoch 3/20 => Loss -0.118, Train_accy 96.39:  15%|█▌        | 3/20 [00:14<01:20,  4.74s/it]
Task 2, Epoch 4/20 => Loss -0.120, Train_accy 95.75:  15%|█▌        | 3/20 [00:18<01:20,  4.74s/it]
Task 2, Epoch 4/20 => Loss -0.120, Train_accy 95.75:  20%|██        | 4/20 [00:18<01:15,  4.74s/it]
Task 2, Epoch 5/20 => Loss -0.175, Train_accy 97.45, Test_accy 81.92:  20%|██        | 4/20 [00:32<01:15,  4.74s/it]
Task 2, Epoch 5/20 => Loss -0.175, Train_accy 97.45, Test_accy 81.92:  25%|██▌       | 5/20 [00:32<01:58,  7.91s/it]
Task 2, Epoch 6/20 => Loss -0.158, Train_accy 96.60:  25%|██▌       | 5/20 [00:37<01:58,  7.91s/it]                 
Task 2, Epoch 6/20 => Loss -0.158, Train_accy 96.60:  30%|███       | 6/20 [00:37<01:36,  6.86s/it]
Task 2, Epoch 7/20 => Loss -0.158, Train_accy 96.82:  30%|███       | 6/20 [00:42<01:36,  6.86s/it]
Task 2, Epoch 7/20 => Loss -0.158, Train_accy 96.82:  35%|███▌      | 7/20 [00:42<01:20,  6.19s/it]
Task 2, Epoch 8/20 => Loss -0.200, Train_accy 98.30:  35%|███▌      | 7/20 [00:46<01:20,  6.19s/it]
Task 2, Epoch 8/20 => Loss -0.200, Train_accy 98.30:  40%|████      | 8/20 [00:46<01:08,  5.71s/it]
Task 2, Epoch 9/20 => Loss -0.206, Train_accy 98.30:  40%|████      | 8/20 [00:51<01:08,  5.71s/it]
Task 2, Epoch 9/20 => Loss -0.206, Train_accy 98.30:  45%|████▌     | 9/20 [00:51<00:59,  5.41s/it]
Task 2, Epoch 10/20 => Loss -0.194, Train_accy 98.09, Test_accy 82.77:  45%|████▌     | 9/20 [01:05<00:59,  5.41s/it]
Task 2, Epoch 10/20 => Loss -0.194, Train_accy 98.09, Test_accy 82.77:  50%|█████     | 10/20 [01:05<01:19,  7.96s/it]
Task 2, Epoch 11/20 => Loss -0.185, Train_accy 98.09:  50%|█████     | 10/20 [01:09<01:19,  7.96s/it]                 
Task 2, Epoch 11/20 => Loss -0.185, Train_accy 98.09:  55%|█████▌    | 11/20 [01:09<01:02,  6.96s/it]
Task 2, Epoch 12/20 => Loss -0.201, Train_accy 98.09:  55%|█████▌    | 11/20 [01:14<01:02,  6.96s/it]
Task 2, Epoch 12/20 => Loss -0.201, Train_accy 98.09:  60%|██████    | 12/20 [01:14<00:50,  6.33s/it]
Task 2, Epoch 13/20 => Loss -0.212, Train_accy 98.09:  60%|██████    | 12/20 [01:19<00:50,  6.33s/it]
Task 2, Epoch 13/20 => Loss -0.212, Train_accy 98.09:  65%|██████▌   | 13/20 [01:19<00:40,  5.85s/it]
Task 2, Epoch 14/20 => Loss -0.192, Train_accy 97.88:  65%|██████▌   | 13/20 [01:24<00:40,  5.85s/it]
Task 2, Epoch 14/20 => Loss -0.192, Train_accy 97.88:  70%|███████   | 14/20 [01:24<00:32,  5.50s/it]
Task 2, Epoch 15/20 => Loss -0.193, Train_accy 97.66, Test_accy 82.98:  70%|███████   | 14/20 [01:37<00:32,  5.50s/it]
Task 2, Epoch 15/20 => Loss -0.193, Train_accy 97.66, Test_accy 82.98:  75%|███████▌  | 15/20 [01:37<00:39,  7.92s/it]
Task 2, Epoch 16/20 => Loss -0.198, Train_accy 98.09:  75%|███████▌  | 15/20 [01:42<00:39,  7.92s/it]                 
Task 2, Epoch 16/20 => Loss -0.198, Train_accy 98.09:  80%|████████  | 16/20 [01:42<00:27,  6.96s/it]
Task 2, Epoch 17/20 => Loss -0.214, Train_accy 98.73:  80%|████████  | 16/20 [01:47<00:27,  6.96s/it]
Task 2, Epoch 17/20 => Loss -0.214, Train_accy 98.73:  85%|████████▌ | 17/20 [01:47<00:18,  6.28s/it]
Task 2, Epoch 18/20 => Loss -0.186, Train_accy 97.66:  85%|████████▌ | 17/20 [01:51<00:18,  6.28s/it]
Task 2, Epoch 18/20 => Loss -0.186, Train_accy 97.66:  90%|█████████ | 18/20 [01:51<00:11,  5.81s/it]
Task 2, Epoch 19/20 => Loss -0.189, Train_accy 97.88:  90%|█████████ | 18/20 [01:56<00:11,  5.81s/it]
Task 2, Epoch 19/20 => Loss -0.189, Train_accy 97.88:  95%|█████████▌| 19/20 [01:56<00:05,  5.48s/it]
Task 2, Epoch 20/20 => Loss -0.196, Train_accy 97.66, Test_accy 82.77:  95%|█████████▌| 19/20 [02:10<00:05,  5.48s/it]
Task 2, Epoch 20/20 => Loss -0.196, Train_accy 97.66, Test_accy 82.77: 100%|██████████| 20/20 [02:10<00:00,  7.90s/it]
Task 2, Epoch 20/20 => Loss -0.196, Train_accy 97.66, Test_accy 82.77: 100%|██████████| 20/20 [02:10<00:00,  6.51s/it]
2024-09-05 23:15:09,608 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.196, Train_accy 97.66, Test_accy 82.77
2024-09-05 23:15:18,428 [trainer.py] => No NME accuracy.
2024-09-05 23:15:18,429 [trainer.py] => CNN: {'total': 82.77, '00-99': 91.67, '100-109': 42.61, '110-119': 30.09, 'old': 87.34, 'new': 30.09}
2024-09-05 23:15:18,429 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77]
2024-09-05 23:15:18,429 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87]

Average Accuracy (CNN): 87.18
2024-09-05 23:15:18,429 [trainer.py] => Average Accuracy (CNN): 87.18 

2024-09-05 23:15:18,432 [trainer.py] => All params: 171970192
2024-09-05 23:15:18,434 [trainer.py] => Trainable params: 199880
2024-09-05 23:15:18,434 [l2p.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.662, Train_accy 69.50:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.662, Train_accy 69.50:   5%|▌         | 1/20 [00:04<01:31,  4.81s/it]
Task 3, Epoch 2/20 => Loss 0.047, Train_accy 86.31:   5%|▌         | 1/20 [00:09<01:31,  4.81s/it]
Task 3, Epoch 2/20 => Loss 0.047, Train_accy 86.31:  10%|█         | 2/20 [00:09<01:26,  4.81s/it]
Task 3, Epoch 3/20 => Loss -0.025, Train_accy 91.29:  10%|█         | 2/20 [00:14<01:26,  4.81s/it]
Task 3, Epoch 3/20 => Loss -0.025, Train_accy 91.29:  15%|█▌        | 3/20 [00:14<01:21,  4.82s/it]
Task 3, Epoch 4/20 => Loss -0.044, Train_accy 91.91:  15%|█▌        | 3/20 [00:19<01:21,  4.82s/it]
Task 3, Epoch 4/20 => Loss -0.044, Train_accy 91.91:  20%|██        | 4/20 [00:19<01:17,  4.82s/it]
Task 3, Epoch 5/20 => Loss -0.087, Train_accy 92.12, Test_accy 80.04:  20%|██        | 4/20 [00:33<01:17,  4.82s/it]
Task 3, Epoch 5/20 => Loss -0.087, Train_accy 92.12, Test_accy 80.04:  25%|██▌       | 5/20 [00:33<02:03,  8.24s/it]
Task 3, Epoch 6/20 => Loss -0.089, Train_accy 92.95:  25%|██▌       | 5/20 [00:38<02:03,  8.24s/it]                 
Task 3, Epoch 6/20 => Loss -0.089, Train_accy 92.95:  30%|███       | 6/20 [00:38<01:39,  7.09s/it]
Task 3, Epoch 7/20 => Loss -0.038, Train_accy 92.53:  30%|███       | 6/20 [00:43<01:39,  7.09s/it]
Task 3, Epoch 7/20 => Loss -0.038, Train_accy 92.53:  35%|███▌      | 7/20 [00:43<01:22,  6.35s/it]
Task 3, Epoch 8/20 => Loss -0.097, Train_accy 91.29:  35%|███▌      | 7/20 [00:48<01:22,  6.35s/it]
Task 3, Epoch 8/20 => Loss -0.097, Train_accy 91.29:  40%|████      | 8/20 [00:48<01:10,  5.86s/it]
Task 3, Epoch 9/20 => Loss -0.109, Train_accy 92.53:  40%|████      | 8/20 [00:52<01:10,  5.86s/it]
Task 3, Epoch 9/20 => Loss -0.109, Train_accy 92.53:  45%|████▌     | 9/20 [00:52<01:00,  5.54s/it]
Task 3, Epoch 10/20 => Loss -0.145, Train_accy 94.40, Test_accy 80.11:  45%|████▌     | 9/20 [01:07<01:00,  5.54s/it]
Task 3, Epoch 10/20 => Loss -0.145, Train_accy 94.40, Test_accy 80.11:  50%|█████     | 10/20 [01:07<01:22,  8.27s/it]
Task 3, Epoch 11/20 => Loss -0.164, Train_accy 95.02:  50%|█████     | 10/20 [01:12<01:22,  8.27s/it]                 
Task 3, Epoch 11/20 => Loss -0.164, Train_accy 95.02:  55%|█████▌    | 11/20 [01:12<01:05,  7.23s/it]
Task 3, Epoch 12/20 => Loss -0.159, Train_accy 95.02:  55%|█████▌    | 11/20 [01:17<01:05,  7.23s/it]
Task 3, Epoch 12/20 => Loss -0.159, Train_accy 95.02:  60%|██████    | 12/20 [01:17<00:52,  6.51s/it]
Task 3, Epoch 13/20 => Loss -0.172, Train_accy 96.27:  60%|██████    | 12/20 [01:21<00:52,  6.51s/it]
Task 3, Epoch 13/20 => Loss -0.172, Train_accy 96.27:  65%|██████▌   | 13/20 [01:21<00:41,  6.00s/it]
Task 3, Epoch 14/20 => Loss -0.153, Train_accy 94.19:  65%|██████▌   | 13/20 [01:26<00:41,  6.00s/it]
Task 3, Epoch 14/20 => Loss -0.153, Train_accy 94.19:  70%|███████   | 14/20 [01:26<00:33,  5.65s/it]
Task 3, Epoch 15/20 => Loss -0.135, Train_accy 94.61, Test_accy 80.43:  70%|███████   | 14/20 [01:40<00:33,  5.65s/it]
Task 3, Epoch 15/20 => Loss -0.135, Train_accy 94.61, Test_accy 80.43:  75%|███████▌  | 15/20 [01:40<00:41,  8.26s/it]
Task 3, Epoch 16/20 => Loss -0.145, Train_accy 93.98:  75%|███████▌  | 15/20 [01:45<00:41,  8.26s/it]                 
Task 3, Epoch 16/20 => Loss -0.145, Train_accy 93.98:  80%|████████  | 16/20 [01:45<00:28,  7.23s/it]
Task 3, Epoch 17/20 => Loss -0.125, Train_accy 95.44:  80%|████████  | 16/20 [01:50<00:28,  7.23s/it]
Task 3, Epoch 17/20 => Loss -0.125, Train_accy 95.44:  85%|████████▌ | 17/20 [01:50<00:19,  6.50s/it]
Task 3, Epoch 18/20 => Loss -0.162, Train_accy 94.61:  85%|████████▌ | 17/20 [01:55<00:19,  6.50s/it]
Task 3, Epoch 18/20 => Loss -0.162, Train_accy 94.61:  90%|█████████ | 18/20 [01:55<00:11,  6.00s/it]
Task 3, Epoch 19/20 => Loss -0.188, Train_accy 95.64:  90%|█████████ | 18/20 [02:00<00:11,  6.00s/it]
Task 3, Epoch 19/20 => Loss -0.188, Train_accy 95.64:  95%|█████████▌| 19/20 [02:00<00:05,  5.65s/it]
Task 3, Epoch 20/20 => Loss -0.173, Train_accy 96.06, Test_accy 80.11:  95%|█████████▌| 19/20 [02:14<00:05,  5.65s/it]
Task 3, Epoch 20/20 => Loss -0.173, Train_accy 96.06, Test_accy 80.11: 100%|██████████| 20/20 [02:14<00:00,  8.28s/it]
Task 3, Epoch 20/20 => Loss -0.173, Train_accy 96.06, Test_accy 80.11: 100%|██████████| 20/20 [02:14<00:00,  6.74s/it]
2024-09-05 23:17:33,148 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.173, Train_accy 96.06, Test_accy 80.11
2024-09-05 23:17:42,627 [trainer.py] => No NME accuracy.
2024-09-05 23:17:42,627 [trainer.py] => CNN: {'total': 80.11, '00-99': 91.67, '100-109': 40.87, '110-119': 30.09, '120-129': 46.73, 'old': 82.63, 'new': 46.73}
2024-09-05 23:17:42,627 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11]
2024-09-05 23:17:42,627 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49]

Average Accuracy (CNN): 85.41
2024-09-05 23:17:42,627 [trainer.py] => Average Accuracy (CNN): 85.41 

2024-09-05 23:17:42,629 [trainer.py] => All params: 171970192
2024-09-05 23:17:42,631 [trainer.py] => Trainable params: 199880
2024-09-05 23:17:42,631 [l2p.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.757, Train_accy 65.68:   0%|          | 0/20 [00:04<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.757, Train_accy 65.68:   5%|▌         | 1/20 [00:04<01:29,  4.74s/it]
Task 4, Epoch 2/20 => Loss 0.004, Train_accy 92.58:   5%|▌         | 1/20 [00:09<01:29,  4.74s/it]
Task 4, Epoch 2/20 => Loss 0.004, Train_accy 92.58:  10%|█         | 2/20 [00:09<01:25,  4.73s/it]
Task 4, Epoch 3/20 => Loss -0.042, Train_accy 90.89:  10%|█         | 2/20 [00:14<01:25,  4.73s/it]
Task 4, Epoch 3/20 => Loss -0.042, Train_accy 90.89:  15%|█▌        | 3/20 [00:14<01:20,  4.72s/it]
Task 4, Epoch 4/20 => Loss -0.115, Train_accy 94.49:  15%|█▌        | 3/20 [00:18<01:20,  4.72s/it]
Task 4, Epoch 4/20 => Loss -0.115, Train_accy 94.49:  20%|██        | 4/20 [00:18<01:15,  4.72s/it]
Task 4, Epoch 5/20 => Loss -0.116, Train_accy 94.49, Test_accy 75.56:  20%|██        | 4/20 [00:33<01:15,  4.72s/it]
Task 4, Epoch 5/20 => Loss -0.116, Train_accy 94.49, Test_accy 75.56:  25%|██▌       | 5/20 [00:33<02:06,  8.41s/it]
Task 4, Epoch 6/20 => Loss -0.129, Train_accy 94.92:  25%|██▌       | 5/20 [00:38<02:06,  8.41s/it]                 
Task 4, Epoch 6/20 => Loss -0.129, Train_accy 94.92:  30%|███       | 6/20 [00:38<01:40,  7.18s/it]
Task 4, Epoch 7/20 => Loss -0.115, Train_accy 94.70:  30%|███       | 6/20 [00:43<01:40,  7.18s/it]
Task 4, Epoch 7/20 => Loss -0.115, Train_accy 94.70:  35%|███▌      | 7/20 [00:43<01:22,  6.37s/it]
Task 4, Epoch 8/20 => Loss -0.144, Train_accy 95.97:  35%|███▌      | 7/20 [00:48<01:22,  6.37s/it]
Task 4, Epoch 8/20 => Loss -0.144, Train_accy 95.97:  40%|████      | 8/20 [00:48<01:10,  5.85s/it]
Task 4, Epoch 9/20 => Loss -0.182, Train_accy 97.25:  40%|████      | 8/20 [00:52<01:10,  5.85s/it]
Task 4, Epoch 9/20 => Loss -0.182, Train_accy 97.25:  45%|████▌     | 9/20 [00:52<01:00,  5.49s/it]
Task 4, Epoch 10/20 => Loss -0.189, Train_accy 96.19, Test_accy 75.93:  45%|████▌     | 9/20 [01:07<01:00,  5.49s/it]
Task 4, Epoch 10/20 => Loss -0.189, Train_accy 96.19, Test_accy 75.93:  50%|█████     | 10/20 [01:07<01:24,  8.42s/it]
Task 4, Epoch 11/20 => Loss -0.159, Train_accy 95.97:  50%|█████     | 10/20 [01:12<01:24,  8.42s/it]                 
Task 4, Epoch 11/20 => Loss -0.159, Train_accy 95.97:  55%|█████▌    | 11/20 [01:12<01:05,  7.28s/it]
Task 4, Epoch 12/20 => Loss -0.146, Train_accy 95.13:  55%|█████▌    | 11/20 [01:17<01:05,  7.28s/it]
Task 4, Epoch 12/20 => Loss -0.146, Train_accy 95.13:  60%|██████    | 12/20 [01:17<00:52,  6.51s/it]
Task 4, Epoch 13/20 => Loss -0.124, Train_accy 95.34:  60%|██████    | 12/20 [01:21<00:52,  6.51s/it]
Task 4, Epoch 13/20 => Loss -0.124, Train_accy 95.34:  65%|██████▌   | 13/20 [01:21<00:41,  5.98s/it]
Task 4, Epoch 14/20 => Loss -0.168, Train_accy 96.19:  65%|██████▌   | 13/20 [01:26<00:41,  5.98s/it]
Task 4, Epoch 14/20 => Loss -0.168, Train_accy 96.19:  70%|███████   | 14/20 [01:26<00:33,  5.61s/it]
Task 4, Epoch 15/20 => Loss -0.170, Train_accy 95.97, Test_accy 76.60:  70%|███████   | 14/20 [01:41<00:33,  5.61s/it]
Task 4, Epoch 15/20 => Loss -0.170, Train_accy 95.97, Test_accy 76.60:  75%|███████▌  | 15/20 [01:41<00:42,  8.41s/it]
Task 4, Epoch 16/20 => Loss -0.184, Train_accy 96.82:  75%|███████▌  | 15/20 [01:46<00:42,  8.41s/it]                 
Task 4, Epoch 16/20 => Loss -0.184, Train_accy 96.82:  80%|████████  | 16/20 [01:46<00:29,  7.30s/it]
Task 4, Epoch 17/20 => Loss -0.187, Train_accy 97.46:  80%|████████  | 16/20 [01:51<00:29,  7.30s/it]
Task 4, Epoch 17/20 => Loss -0.187, Train_accy 97.46:  85%|████████▌ | 17/20 [01:51<00:19,  6.53s/it]
Task 4, Epoch 18/20 => Loss -0.175, Train_accy 96.61:  85%|████████▌ | 17/20 [01:55<00:19,  6.53s/it]
Task 4, Epoch 18/20 => Loss -0.175, Train_accy 96.61:  90%|█████████ | 18/20 [01:55<00:11,  5.99s/it]
Task 4, Epoch 19/20 => Loss -0.198, Train_accy 96.82:  90%|█████████ | 18/20 [02:00<00:11,  5.99s/it]
Task 4, Epoch 19/20 => Loss -0.198, Train_accy 96.82:  95%|█████████▌| 19/20 [02:00<00:05,  5.61s/it]
Task 4, Epoch 20/20 => Loss -0.212, Train_accy 97.46, Test_accy 77.27:  95%|█████████▌| 19/20 [02:15<00:05,  5.61s/it]
Task 4, Epoch 20/20 => Loss -0.212, Train_accy 97.46, Test_accy 77.27: 100%|██████████| 20/20 [02:15<00:00,  8.43s/it]
Task 4, Epoch 20/20 => Loss -0.212, Train_accy 97.46, Test_accy 77.27: 100%|██████████| 20/20 [02:15<00:00,  6.78s/it]
2024-09-05 23:19:58,196 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.212, Train_accy 97.46, Test_accy 77.27
2024-09-05 23:20:08,463 [trainer.py] => No NME accuracy.
2024-09-05 23:20:08,464 [trainer.py] => CNN: {'total': 77.27, '00-99': 91.67, '100-109': 44.35, '110-119': 30.97, '120-129': 48.6, '130-139': 34.75, 'old': 80.56, 'new': 34.75}
2024-09-05 23:20:08,464 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11, 77.27]
2024-09-05 23:20:08,464 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49, 98.17]

Average Accuracy (CNN): 83.78
2024-09-05 23:20:08,464 [trainer.py] => Average Accuracy (CNN): 83.78 

2024-09-05 23:20:08,467 [trainer.py] => All params: 171970192
2024-09-05 23:20:08,470 [trainer.py] => Trainable params: 199880
2024-09-05 23:20:08,470 [l2p.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.761, Train_accy 68.14:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.761, Train_accy 68.14:   5%|▌         | 1/20 [00:04<01:26,  4.53s/it]
Task 5, Epoch 2/20 => Loss 0.016, Train_accy 91.81:   5%|▌         | 1/20 [00:09<01:26,  4.53s/it]
Task 5, Epoch 2/20 => Loss 0.016, Train_accy 91.81:  10%|█         | 2/20 [00:09<01:21,  4.55s/it]
Task 5, Epoch 3/20 => Loss -0.120, Train_accy 96.02:  10%|█         | 2/20 [00:13<01:21,  4.55s/it]
Task 5, Epoch 3/20 => Loss -0.120, Train_accy 96.02:  15%|█▌        | 3/20 [00:13<01:17,  4.58s/it]
Task 5, Epoch 4/20 => Loss -0.125, Train_accy 96.02:  15%|█▌        | 3/20 [00:18<01:17,  4.58s/it]
Task 5, Epoch 4/20 => Loss -0.125, Train_accy 96.02:  20%|██        | 4/20 [00:18<01:13,  4.58s/it]
Task 5, Epoch 5/20 => Loss -0.150, Train_accy 96.68, Test_accy 72.55:  20%|██        | 4/20 [00:33<01:13,  4.58s/it]
Task 5, Epoch 5/20 => Loss -0.150, Train_accy 96.68, Test_accy 72.55:  25%|██▌       | 5/20 [00:33<02:07,  8.51s/it]
Task 5, Epoch 6/20 => Loss -0.118, Train_accy 95.13:  25%|██▌       | 5/20 [00:38<02:07,  8.51s/it]                 
Task 5, Epoch 6/20 => Loss -0.118, Train_accy 95.13:  30%|███       | 6/20 [00:38<01:40,  7.16s/it]
Task 5, Epoch 7/20 => Loss -0.154, Train_accy 95.80:  30%|███       | 6/20 [00:42<01:40,  7.16s/it]
Task 5, Epoch 7/20 => Loss -0.154, Train_accy 95.80:  35%|███▌      | 7/20 [00:42<01:22,  6.31s/it]
Task 5, Epoch 8/20 => Loss -0.123, Train_accy 95.13:  35%|███▌      | 7/20 [00:47<01:22,  6.31s/it]
Task 5, Epoch 8/20 => Loss -0.123, Train_accy 95.13:  40%|████      | 8/20 [00:47<01:08,  5.74s/it]
Task 5, Epoch 9/20 => Loss -0.171, Train_accy 97.35:  40%|████      | 8/20 [00:51<01:08,  5.74s/it]
Task 5, Epoch 9/20 => Loss -0.171, Train_accy 97.35:  45%|████▌     | 9/20 [00:51<00:58,  5.36s/it]
Task 5, Epoch 10/20 => Loss -0.142, Train_accy 95.58, Test_accy 72.55:  45%|████▌     | 9/20 [01:07<00:58,  5.36s/it]
Task 5, Epoch 10/20 => Loss -0.142, Train_accy 95.58, Test_accy 72.55:  50%|█████     | 10/20 [01:07<01:24,  8.49s/it]
Task 5, Epoch 11/20 => Loss -0.155, Train_accy 95.58:  50%|█████     | 10/20 [01:11<01:24,  8.49s/it]                 
Task 5, Epoch 11/20 => Loss -0.155, Train_accy 95.58:  55%|█████▌    | 11/20 [01:11<01:05,  7.29s/it]
Task 5, Epoch 12/20 => Loss -0.157, Train_accy 97.12:  55%|█████▌    | 11/20 [01:16<01:05,  7.29s/it]
Task 5, Epoch 12/20 => Loss -0.157, Train_accy 97.12:  60%|██████    | 12/20 [01:16<00:51,  6.46s/it]
Task 5, Epoch 13/20 => Loss -0.173, Train_accy 96.46:  60%|██████    | 12/20 [01:21<00:51,  6.46s/it]
Task 5, Epoch 13/20 => Loss -0.173, Train_accy 96.46:  65%|██████▌   | 13/20 [01:21<00:41,  5.87s/it]
Task 5, Epoch 14/20 => Loss -0.187, Train_accy 97.12:  65%|██████▌   | 13/20 [01:25<00:41,  5.87s/it]
Task 5, Epoch 14/20 => Loss -0.187, Train_accy 97.12:  70%|███████   | 14/20 [01:25<00:32,  5.47s/it]
Task 5, Epoch 15/20 => Loss -0.174, Train_accy 97.12, Test_accy 73.29:  70%|███████   | 14/20 [01:41<00:32,  5.47s/it]
Task 5, Epoch 15/20 => Loss -0.174, Train_accy 97.12, Test_accy 73.29:  75%|███████▌  | 15/20 [01:41<00:42,  8.50s/it]
Task 5, Epoch 16/20 => Loss -0.154, Train_accy 96.24:  75%|███████▌  | 15/20 [01:45<00:42,  8.50s/it]                 
Task 5, Epoch 16/20 => Loss -0.154, Train_accy 96.24:  80%|████████  | 16/20 [01:45<00:29,  7.32s/it]
Task 5, Epoch 17/20 => Loss -0.148, Train_accy 95.58:  80%|████████  | 16/20 [01:50<00:29,  7.32s/it]
Task 5, Epoch 17/20 => Loss -0.148, Train_accy 95.58:  85%|████████▌ | 17/20 [01:50<00:19,  6.50s/it]
Task 5, Epoch 18/20 => Loss -0.183, Train_accy 96.90:  85%|████████▌ | 17/20 [01:54<00:19,  6.50s/it]
Task 5, Epoch 18/20 => Loss -0.183, Train_accy 96.90:  90%|█████████ | 18/20 [01:54<00:11,  5.93s/it]
Task 5, Epoch 19/20 => Loss -0.215, Train_accy 98.23:  90%|█████████ | 18/20 [01:59<00:11,  5.93s/it]
Task 5, Epoch 19/20 => Loss -0.215, Train_accy 98.23:  95%|█████████▌| 19/20 [01:59<00:05,  5.53s/it]
Task 5, Epoch 20/20 => Loss -0.206, Train_accy 97.79, Test_accy 73.17:  95%|█████████▌| 19/20 [02:15<00:05,  5.53s/it]
Task 5, Epoch 20/20 => Loss -0.206, Train_accy 97.79, Test_accy 73.17: 100%|██████████| 20/20 [02:15<00:00,  8.57s/it]
Task 5, Epoch 20/20 => Loss -0.206, Train_accy 97.79, Test_accy 73.17: 100%|██████████| 20/20 [02:15<00:00,  6.76s/it]
2024-09-05 23:22:23,644 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.206, Train_accy 97.79, Test_accy 73.17
2024-09-05 23:22:34,674 [trainer.py] => No NME accuracy.
2024-09-05 23:22:34,674 [trainer.py] => CNN: {'total': 73.17, '00-99': 91.58, '100-109': 44.35, '110-119': 30.97, '120-129': 49.53, '130-139': 33.9, '140-149': 20.63, 'old': 77.21, 'new': 20.63}
2024-09-05 23:22:34,675 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11, 77.27, 73.17]
2024-09-05 23:22:34,675 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49, 98.17, 97.91]

Average Accuracy (CNN): 82.01
2024-09-05 23:22:34,675 [trainer.py] => Average Accuracy (CNN): 82.01 

2024-09-05 23:22:34,677 [trainer.py] => All params: 171970192
2024-09-05 23:22:34,679 [trainer.py] => Trainable params: 199880
2024-09-05 23:22:34,679 [l2p.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.790, Train_accy 67.95:   0%|          | 0/20 [00:04<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.790, Train_accy 67.95:   5%|▌         | 1/20 [00:04<01:28,  4.68s/it]
Task 6, Epoch 2/20 => Loss -0.023, Train_accy 92.52:   5%|▌         | 1/20 [00:09<01:28,  4.68s/it]
Task 6, Epoch 2/20 => Loss -0.023, Train_accy 92.52:  10%|█         | 2/20 [00:09<01:24,  4.69s/it]
Task 6, Epoch 3/20 => Loss -0.115, Train_accy 94.66:  10%|█         | 2/20 [00:14<01:24,  4.69s/it]
Task 6, Epoch 3/20 => Loss -0.115, Train_accy 94.66:  15%|█▌        | 3/20 [00:14<01:19,  4.69s/it]
Task 6, Epoch 4/20 => Loss -0.125, Train_accy 95.30:  15%|█▌        | 3/20 [00:18<01:19,  4.69s/it]
Task 6, Epoch 4/20 => Loss -0.125, Train_accy 95.30:  20%|██        | 4/20 [00:18<01:14,  4.69s/it]
Task 6, Epoch 5/20 => Loss -0.102, Train_accy 94.23, Test_accy 69.65:  20%|██        | 4/20 [00:35<01:14,  4.69s/it]
Task 6, Epoch 5/20 => Loss -0.102, Train_accy 94.23, Test_accy 69.65:  25%|██▌       | 5/20 [00:35<02:13,  8.87s/it]
Task 6, Epoch 6/20 => Loss -0.160, Train_accy 96.58:  25%|██▌       | 5/20 [00:39<02:13,  8.87s/it]                 
Task 6, Epoch 6/20 => Loss -0.160, Train_accy 96.58:  30%|███       | 6/20 [00:39<01:44,  7.46s/it]
Task 6, Epoch 7/20 => Loss -0.123, Train_accy 95.51:  30%|███       | 6/20 [00:44<01:44,  7.46s/it]
Task 6, Epoch 7/20 => Loss -0.123, Train_accy 95.51:  35%|███▌      | 7/20 [00:44<01:25,  6.56s/it]
Task 6, Epoch 8/20 => Loss -0.131, Train_accy 95.30:  35%|███▌      | 7/20 [00:49<01:25,  6.56s/it]
Task 6, Epoch 8/20 => Loss -0.131, Train_accy 95.30:  40%|████      | 8/20 [00:49<01:11,  5.97s/it]
Task 6, Epoch 9/20 => Loss -0.163, Train_accy 95.30:  40%|████      | 8/20 [00:53<01:11,  5.97s/it]
Task 6, Epoch 9/20 => Loss -0.163, Train_accy 95.30:  45%|████▌     | 9/20 [00:53<01:01,  5.57s/it]
Task 6, Epoch 10/20 => Loss -0.182, Train_accy 97.65, Test_accy 70.02:  45%|████▌     | 9/20 [01:10<01:01,  5.57s/it]
Task 6, Epoch 10/20 => Loss -0.182, Train_accy 97.65, Test_accy 70.02:  50%|█████     | 10/20 [01:10<01:28,  8.89s/it]
Task 6, Epoch 11/20 => Loss -0.160, Train_accy 95.94:  50%|█████     | 10/20 [01:14<01:28,  8.89s/it]                 
Task 6, Epoch 11/20 => Loss -0.160, Train_accy 95.94:  55%|█████▌    | 11/20 [01:14<01:08,  7.61s/it]
Task 6, Epoch 12/20 => Loss -0.191, Train_accy 96.79:  55%|█████▌    | 11/20 [01:19<01:08,  7.61s/it]
Task 6, Epoch 12/20 => Loss -0.191, Train_accy 96.79:  60%|██████    | 12/20 [01:19<00:53,  6.73s/it]
Task 6, Epoch 13/20 => Loss -0.178, Train_accy 97.01:  60%|██████    | 12/20 [01:24<00:53,  6.73s/it]
Task 6, Epoch 13/20 => Loss -0.178, Train_accy 97.01:  65%|██████▌   | 13/20 [01:24<00:42,  6.12s/it]
Task 6, Epoch 14/20 => Loss -0.212, Train_accy 98.08:  65%|██████▌   | 13/20 [01:29<00:42,  6.12s/it]
Task 6, Epoch 14/20 => Loss -0.212, Train_accy 98.08:  70%|███████   | 14/20 [01:29<00:34,  5.69s/it]
Task 6, Epoch 15/20 => Loss -0.175, Train_accy 97.22, Test_accy 70.28:  70%|███████   | 14/20 [01:45<00:34,  5.69s/it]
Task 6, Epoch 15/20 => Loss -0.175, Train_accy 97.22, Test_accy 70.28:  75%|███████▌  | 15/20 [01:45<00:44,  8.90s/it]
Task 6, Epoch 16/20 => Loss -0.128, Train_accy 95.73:  75%|███████▌  | 15/20 [01:50<00:44,  8.90s/it]                 
Task 6, Epoch 16/20 => Loss -0.128, Train_accy 95.73:  80%|████████  | 16/20 [01:50<00:30,  7.64s/it]
Task 6, Epoch 17/20 => Loss -0.180, Train_accy 96.37:  80%|████████  | 16/20 [01:54<00:30,  7.64s/it]
Task 6, Epoch 17/20 => Loss -0.180, Train_accy 96.37:  85%|████████▌ | 17/20 [01:54<00:20,  6.75s/it]
Task 6, Epoch 18/20 => Loss -0.162, Train_accy 97.22:  85%|████████▌ | 17/20 [01:59<00:20,  6.75s/it]
Task 6, Epoch 18/20 => Loss -0.162, Train_accy 97.22:  90%|█████████ | 18/20 [01:59<00:12,  6.15s/it]
Task 6, Epoch 19/20 => Loss -0.151, Train_accy 95.94:  90%|█████████ | 18/20 [02:04<00:12,  6.15s/it]
Task 6, Epoch 19/20 => Loss -0.151, Train_accy 95.94:  95%|█████████▌| 19/20 [02:04<00:05,  5.72s/it]
Task 6, Epoch 20/20 => Loss -0.171, Train_accy 97.01, Test_accy 70.65:  95%|█████████▌| 19/20 [02:20<00:05,  5.72s/it]
Task 6, Epoch 20/20 => Loss -0.171, Train_accy 97.01, Test_accy 70.65: 100%|██████████| 20/20 [02:20<00:00,  8.92s/it]
Task 6, Epoch 20/20 => Loss -0.171, Train_accy 97.01, Test_accy 70.65: 100%|██████████| 20/20 [02:20<00:00,  7.03s/it]
2024-09-05 23:24:55,309 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.171, Train_accy 97.01, Test_accy 70.65
2024-09-05 23:25:06,999 [trainer.py] => No NME accuracy.
2024-09-05 23:25:07,000 [trainer.py] => CNN: {'total': 70.65, '00-99': 91.58, '100-109': 45.22, '110-119': 30.97, '120-129': 48.6, '130-139': 35.59, '140-149': 21.43, '150-159': 32.26, 'old': 73.34, 'new': 32.26}
2024-09-05 23:25:07,000 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11, 77.27, 73.17, 70.65]
2024-09-05 23:25:07,000 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49, 98.17, 97.91, 97.41]

Average Accuracy (CNN): 80.39
2024-09-05 23:25:07,001 [trainer.py] => Average Accuracy (CNN): 80.39 

2024-09-05 23:25:07,003 [trainer.py] => All params: 171970192
2024-09-05 23:25:07,005 [trainer.py] => Trainable params: 199880
2024-09-05 23:25:07,005 [l2p.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.578, Train_accy 72.84:   0%|          | 0/20 [00:04<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.578, Train_accy 72.84:   5%|▌         | 1/20 [00:04<01:29,  4.71s/it]
Task 7, Epoch 2/20 => Loss -0.123, Train_accy 95.47:   5%|▌         | 1/20 [00:09<01:29,  4.71s/it]
Task 7, Epoch 2/20 => Loss -0.123, Train_accy 95.47:  10%|█         | 2/20 [00:09<01:24,  4.67s/it]
Task 7, Epoch 3/20 => Loss -0.146, Train_accy 95.47:  10%|█         | 2/20 [00:14<01:24,  4.67s/it]
Task 7, Epoch 3/20 => Loss -0.146, Train_accy 95.47:  15%|█▌        | 3/20 [00:14<01:19,  4.67s/it]
Task 7, Epoch 4/20 => Loss -0.164, Train_accy 96.55:  15%|█▌        | 3/20 [00:18<01:19,  4.67s/it]
Task 7, Epoch 4/20 => Loss -0.164, Train_accy 96.55:  20%|██        | 4/20 [00:18<01:14,  4.68s/it]
Task 7, Epoch 5/20 => Loss -0.179, Train_accy 97.20, Test_accy 67.36:  20%|██        | 4/20 [00:35<01:14,  4.68s/it]
Task 7, Epoch 5/20 => Loss -0.179, Train_accy 97.20, Test_accy 67.36:  25%|██▌       | 5/20 [00:35<02:18,  9.21s/it]
Task 7, Epoch 6/20 => Loss -0.189, Train_accy 96.98:  25%|██▌       | 5/20 [00:40<02:18,  9.21s/it]                 
Task 7, Epoch 6/20 => Loss -0.189, Train_accy 96.98:  30%|███       | 6/20 [00:40<01:47,  7.67s/it]
Task 7, Epoch 7/20 => Loss -0.178, Train_accy 96.98:  30%|███       | 6/20 [00:45<01:47,  7.67s/it]
Task 7, Epoch 7/20 => Loss -0.178, Train_accy 96.98:  35%|███▌      | 7/20 [00:45<01:26,  6.68s/it]
Task 7, Epoch 8/20 => Loss -0.145, Train_accy 95.04:  35%|███▌      | 7/20 [00:49<01:26,  6.68s/it]
Task 7, Epoch 8/20 => Loss -0.145, Train_accy 95.04:  40%|████      | 8/20 [00:49<01:12,  6.04s/it]
Task 7, Epoch 9/20 => Loss -0.192, Train_accy 97.20:  40%|████      | 8/20 [00:54<01:12,  6.04s/it]
Task 7, Epoch 9/20 => Loss -0.192, Train_accy 97.20:  45%|████▌     | 9/20 [00:54<01:01,  5.61s/it]
Task 7, Epoch 10/20 => Loss -0.207, Train_accy 97.41, Test_accy 67.26:  45%|████▌     | 9/20 [01:11<01:01,  5.61s/it]
Task 7, Epoch 10/20 => Loss -0.207, Train_accy 97.41, Test_accy 67.26:  50%|█████     | 10/20 [01:11<01:31,  9.16s/it]
Task 7, Epoch 11/20 => Loss -0.157, Train_accy 95.69:  50%|█████     | 10/20 [01:16<01:31,  9.16s/it]                 
Task 7, Epoch 11/20 => Loss -0.157, Train_accy 95.69:  55%|█████▌    | 11/20 [01:16<01:10,  7.80s/it]
Task 7, Epoch 12/20 => Loss -0.167, Train_accy 95.91:  55%|█████▌    | 11/20 [01:21<01:10,  7.80s/it]
Task 7, Epoch 12/20 => Loss -0.167, Train_accy 95.91:  60%|██████    | 12/20 [01:21<00:54,  6.84s/it]
Task 7, Epoch 13/20 => Loss -0.214, Train_accy 98.28:  60%|██████    | 12/20 [01:25<00:54,  6.84s/it]
Task 7, Epoch 13/20 => Loss -0.214, Train_accy 98.28:  65%|██████▌   | 13/20 [01:25<00:43,  6.18s/it]
Task 7, Epoch 14/20 => Loss -0.198, Train_accy 97.41:  65%|██████▌   | 13/20 [01:30<00:43,  6.18s/it]
Task 7, Epoch 14/20 => Loss -0.198, Train_accy 97.41:  70%|███████   | 14/20 [01:30<00:34,  5.72s/it]
Task 7, Epoch 15/20 => Loss -0.172, Train_accy 96.55, Test_accy 67.51:  70%|███████   | 14/20 [01:47<00:34,  5.72s/it]
Task 7, Epoch 15/20 => Loss -0.172, Train_accy 96.55, Test_accy 67.51:  75%|███████▌  | 15/20 [01:47<00:45,  9.14s/it]
Task 7, Epoch 16/20 => Loss -0.142, Train_accy 96.12:  75%|███████▌  | 15/20 [01:52<00:45,  9.14s/it]                 
Task 7, Epoch 16/20 => Loss -0.142, Train_accy 96.12:  80%|████████  | 16/20 [01:52<00:31,  7.80s/it]
Task 7, Epoch 17/20 => Loss -0.167, Train_accy 96.77:  80%|████████  | 16/20 [01:56<00:31,  7.80s/it]
Task 7, Epoch 17/20 => Loss -0.167, Train_accy 96.77:  85%|████████▌ | 17/20 [01:56<00:20,  6.87s/it]
Task 7, Epoch 18/20 => Loss -0.148, Train_accy 95.91:  85%|████████▌ | 17/20 [02:01<00:20,  6.87s/it]
Task 7, Epoch 18/20 => Loss -0.148, Train_accy 95.91:  90%|█████████ | 18/20 [02:01<00:12,  6.21s/it]
Task 7, Epoch 19/20 => Loss -0.188, Train_accy 96.77:  90%|█████████ | 18/20 [02:06<00:12,  6.21s/it]
Task 7, Epoch 19/20 => Loss -0.188, Train_accy 96.77:  95%|█████████▌| 19/20 [02:06<00:05,  5.74s/it]
Task 7, Epoch 20/20 => Loss -0.228, Train_accy 98.49, Test_accy 67.36:  95%|█████████▌| 19/20 [02:23<00:05,  5.74s/it]
Task 7, Epoch 20/20 => Loss -0.228, Train_accy 98.49, Test_accy 67.36: 100%|██████████| 20/20 [02:23<00:00,  9.15s/it]
Task 7, Epoch 20/20 => Loss -0.228, Train_accy 98.49, Test_accy 67.36: 100%|██████████| 20/20 [02:23<00:00,  7.16s/it]
2024-09-05 23:27:30,296 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.228, Train_accy 98.49, Test_accy 67.36
2024-09-05 23:27:42,780 [trainer.py] => No NME accuracy.
2024-09-05 23:27:42,781 [trainer.py] => CNN: {'total': 67.36, '00-99': 90.99, '100-109': 45.22, '110-119': 30.97, '120-129': 48.6, '130-139': 35.59, '140-149': 21.43, '150-159': 31.45, '160-169': 26.87, 'old': 70.23, 'new': 26.87}
2024-09-05 23:27:42,781 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11, 77.27, 73.17, 70.65, 67.36]
2024-09-05 23:27:42,781 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49, 98.17, 97.91, 97.41, 97.09]

Average Accuracy (CNN): 78.76
2024-09-05 23:27:42,781 [trainer.py] => Average Accuracy (CNN): 78.76 

2024-09-05 23:27:42,785 [trainer.py] => All params: 171970192
2024-09-05 23:27:42,788 [trainer.py] => Trainable params: 199880
2024-09-05 23:27:42,788 [l2p.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.545, Train_accy 74.70:   0%|          | 0/20 [00:04<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.545, Train_accy 74.70:   5%|▌         | 1/20 [00:04<01:33,  4.93s/it]
Task 8, Epoch 2/20 => Loss -0.109, Train_accy 94.53:   5%|▌         | 1/20 [00:09<01:33,  4.93s/it]
Task 8, Epoch 2/20 => Loss -0.109, Train_accy 94.53:  10%|█         | 2/20 [00:09<01:28,  4.93s/it]
Task 8, Epoch 3/20 => Loss -0.153, Train_accy 96.36:  10%|█         | 2/20 [00:14<01:28,  4.93s/it]
Task 8, Epoch 3/20 => Loss -0.153, Train_accy 96.36:  15%|█▌        | 3/20 [00:14<01:23,  4.93s/it]
Task 8, Epoch 4/20 => Loss -0.101, Train_accy 94.13:  15%|█▌        | 3/20 [00:19<01:23,  4.93s/it]
Task 8, Epoch 4/20 => Loss -0.101, Train_accy 94.13:  20%|██        | 4/20 [00:19<01:19,  4.94s/it]
Task 8, Epoch 5/20 => Loss -0.161, Train_accy 95.95, Test_accy 65.27:  20%|██        | 4/20 [00:37<01:19,  4.94s/it]
Task 8, Epoch 5/20 => Loss -0.161, Train_accy 95.95, Test_accy 65.27:  25%|██▌       | 5/20 [00:37<02:24,  9.66s/it]
Task 8, Epoch 6/20 => Loss -0.160, Train_accy 95.75:  25%|██▌       | 5/20 [00:42<02:24,  9.66s/it]                 
Task 8, Epoch 6/20 => Loss -0.160, Train_accy 95.75:  30%|███       | 6/20 [00:42<01:52,  8.06s/it]
Task 8, Epoch 7/20 => Loss -0.160, Train_accy 95.55:  30%|███       | 6/20 [00:47<01:52,  8.06s/it]
Task 8, Epoch 7/20 => Loss -0.160, Train_accy 95.55:  35%|███▌      | 7/20 [00:47<01:31,  7.04s/it]
Task 8, Epoch 8/20 => Loss -0.148, Train_accy 95.14:  35%|███▌      | 7/20 [00:52<01:31,  7.04s/it]
Task 8, Epoch 8/20 => Loss -0.148, Train_accy 95.14:  40%|████      | 8/20 [00:52<01:16,  6.37s/it]
Task 8, Epoch 9/20 => Loss -0.170, Train_accy 96.76:  40%|████      | 8/20 [00:57<01:16,  6.37s/it]
Task 8, Epoch 9/20 => Loss -0.170, Train_accy 96.76:  45%|████▌     | 9/20 [00:57<01:05,  5.93s/it]
Task 8, Epoch 10/20 => Loss -0.153, Train_accy 95.34, Test_accy 65.27:  45%|████▌     | 9/20 [01:15<01:05,  5.93s/it]
Task 8, Epoch 10/20 => Loss -0.153, Train_accy 95.34, Test_accy 65.27:  50%|█████     | 10/20 [01:15<01:36,  9.65s/it]
Task 8, Epoch 11/20 => Loss -0.207, Train_accy 97.17:  50%|█████     | 10/20 [01:20<01:36,  9.65s/it]                 
Task 8, Epoch 11/20 => Loss -0.207, Train_accy 97.17:  55%|█████▌    | 11/20 [01:20<01:13,  8.21s/it]
Task 8, Epoch 12/20 => Loss -0.173, Train_accy 96.36:  55%|█████▌    | 11/20 [01:25<01:13,  8.21s/it]
Task 8, Epoch 12/20 => Loss -0.173, Train_accy 96.36:  60%|██████    | 12/20 [01:25<00:57,  7.23s/it]
Task 8, Epoch 13/20 => Loss -0.134, Train_accy 94.33:  60%|██████    | 12/20 [01:30<00:57,  7.23s/it]
Task 8, Epoch 13/20 => Loss -0.134, Train_accy 94.33:  65%|██████▌   | 13/20 [01:30<00:45,  6.54s/it]
Task 8, Epoch 14/20 => Loss -0.137, Train_accy 96.36:  65%|██████▌   | 13/20 [01:35<00:45,  6.54s/it]
Task 8, Epoch 14/20 => Loss -0.137, Train_accy 96.36:  70%|███████   | 14/20 [01:35<00:36,  6.05s/it]
Task 8, Epoch 15/20 => Loss -0.172, Train_accy 96.56, Test_accy 65.55:  70%|███████   | 14/20 [01:53<00:36,  6.05s/it]
Task 8, Epoch 15/20 => Loss -0.172, Train_accy 96.56, Test_accy 65.55:  75%|███████▌  | 15/20 [01:53<00:48,  9.65s/it]
Task 8, Epoch 16/20 => Loss -0.182, Train_accy 96.96:  75%|███████▌  | 15/20 [01:58<00:48,  9.65s/it]                 
Task 8, Epoch 16/20 => Loss -0.182, Train_accy 96.96:  80%|████████  | 16/20 [01:58<00:32,  8.23s/it]
Task 8, Epoch 17/20 => Loss -0.174, Train_accy 96.76:  80%|████████  | 16/20 [02:03<00:32,  8.23s/it]
Task 8, Epoch 17/20 => Loss -0.174, Train_accy 96.76:  85%|████████▌ | 17/20 [02:03<00:21,  7.24s/it]
Task 8, Epoch 18/20 => Loss -0.160, Train_accy 95.75:  85%|████████▌ | 17/20 [02:08<00:21,  7.24s/it]
Task 8, Epoch 18/20 => Loss -0.160, Train_accy 95.75:  90%|█████████ | 18/20 [02:08<00:13,  6.55s/it]
Task 8, Epoch 19/20 => Loss -0.210, Train_accy 97.17:  90%|█████████ | 18/20 [02:13<00:13,  6.55s/it]
Task 8, Epoch 19/20 => Loss -0.210, Train_accy 97.17:  95%|█████████▌| 19/20 [02:13<00:06,  6.06s/it]
Task 8, Epoch 20/20 => Loss -0.202, Train_accy 96.76, Test_accy 65.70:  95%|█████████▌| 19/20 [02:31<00:06,  6.06s/it]
Task 8, Epoch 20/20 => Loss -0.202, Train_accy 96.76, Test_accy 65.70: 100%|██████████| 20/20 [02:31<00:00,  9.66s/it]
Task 8, Epoch 20/20 => Loss -0.202, Train_accy 96.76, Test_accy 65.70: 100%|██████████| 20/20 [02:31<00:00,  7.55s/it]
2024-09-05 23:30:13,904 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.202, Train_accy 96.76, Test_accy 65.70
2024-09-05 23:30:27,042 [trainer.py] => No NME accuracy.
2024-09-05 23:30:27,043 [trainer.py] => CNN: {'total': 65.7, '00-99': 91.16, '100-109': 46.09, '110-119': 30.09, '120-129': 48.6, '130-139': 35.59, '140-149': 21.43, '150-159': 30.65, '160-169': 26.12, '170-179': 33.01, 'old': 67.36, 'new': 33.01}
2024-09-05 23:30:27,043 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11, 77.27, 73.17, 70.65, 67.36, 65.7]
2024-09-05 23:30:27,043 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49, 98.17, 97.91, 97.41, 97.09, 96.43]

Average Accuracy (CNN): 77.31
2024-09-05 23:30:27,044 [trainer.py] => Average Accuracy (CNN): 77.31 

2024-09-05 23:30:27,047 [trainer.py] => All params: 171970192
2024-09-05 23:30:27,049 [trainer.py] => Trainable params: 199880
2024-09-05 23:30:27,050 [l2p.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.541, Train_accy 75.16:   0%|          | 0/20 [00:04<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.541, Train_accy 75.16:   5%|▌         | 1/20 [00:04<01:27,  4.58s/it]
Task 9, Epoch 2/20 => Loss -0.078, Train_accy 94.51:   5%|▌         | 1/20 [00:09<01:27,  4.58s/it]
Task 9, Epoch 2/20 => Loss -0.078, Train_accy 94.51:  10%|█         | 2/20 [00:09<01:22,  4.58s/it]
Task 9, Epoch 3/20 => Loss -0.139, Train_accy 95.38:  10%|█         | 2/20 [00:13<01:22,  4.58s/it]
Task 9, Epoch 3/20 => Loss -0.139, Train_accy 95.38:  15%|█▌        | 3/20 [00:13<01:17,  4.58s/it]
Task 9, Epoch 4/20 => Loss -0.151, Train_accy 96.04:  15%|█▌        | 3/20 [00:18<01:17,  4.58s/it]
Task 9, Epoch 4/20 => Loss -0.151, Train_accy 96.04:  20%|██        | 4/20 [00:18<01:13,  4.59s/it]
Task 9, Epoch 5/20 => Loss -0.184, Train_accy 96.70, Test_accy 62.30:  20%|██        | 4/20 [00:36<01:13,  4.59s/it]
Task 9, Epoch 5/20 => Loss -0.184, Train_accy 96.70, Test_accy 62.30:  25%|██▌       | 5/20 [00:36<02:23,  9.56s/it]
Task 9, Epoch 6/20 => Loss -0.161, Train_accy 95.60:  25%|██▌       | 5/20 [00:41<02:23,  9.56s/it]                 
Task 9, Epoch 6/20 => Loss -0.161, Train_accy 95.60:  30%|███       | 6/20 [00:41<01:50,  7.86s/it]
Task 9, Epoch 7/20 => Loss -0.121, Train_accy 95.60:  30%|███       | 6/20 [00:45<01:50,  7.86s/it]
Task 9, Epoch 7/20 => Loss -0.121, Train_accy 95.60:  35%|███▌      | 7/20 [00:45<01:28,  6.80s/it]
Task 9, Epoch 8/20 => Loss -0.115, Train_accy 94.95:  35%|███▌      | 7/20 [00:50<01:28,  6.80s/it]
Task 9, Epoch 8/20 => Loss -0.115, Train_accy 94.95:  40%|████      | 8/20 [00:50<01:13,  6.08s/it]
Task 9, Epoch 9/20 => Loss -0.154, Train_accy 95.82:  40%|████      | 8/20 [00:55<01:13,  6.08s/it]
Task 9, Epoch 9/20 => Loss -0.154, Train_accy 95.82:  45%|████▌     | 9/20 [00:55<01:01,  5.62s/it]
Task 9, Epoch 10/20 => Loss -0.163, Train_accy 95.82, Test_accy 62.57:  45%|████▌     | 9/20 [01:13<01:01,  5.62s/it]
Task 9, Epoch 10/20 => Loss -0.163, Train_accy 95.82, Test_accy 62.57:  50%|█████     | 10/20 [01:13<01:36,  9.60s/it]
Task 9, Epoch 11/20 => Loss -0.118, Train_accy 94.51:  50%|█████     | 10/20 [01:18<01:36,  9.60s/it]                 
Task 9, Epoch 11/20 => Loss -0.118, Train_accy 94.51:  55%|█████▌    | 11/20 [01:18<01:12,  8.08s/it]
Task 9, Epoch 12/20 => Loss -0.160, Train_accy 96.70:  55%|█████▌    | 11/20 [01:22<01:12,  8.08s/it]
Task 9, Epoch 12/20 => Loss -0.160, Train_accy 96.70:  60%|██████    | 12/20 [01:22<00:56,  7.02s/it]
Task 9, Epoch 13/20 => Loss -0.169, Train_accy 96.92:  60%|██████    | 12/20 [01:27<00:56,  7.02s/it]
Task 9, Epoch 13/20 => Loss -0.169, Train_accy 96.92:  65%|██████▌   | 13/20 [01:27<00:44,  6.30s/it]
Task 9, Epoch 14/20 => Loss -0.129, Train_accy 95.38:  65%|██████▌   | 13/20 [01:32<00:44,  6.30s/it]
Task 9, Epoch 14/20 => Loss -0.129, Train_accy 95.38:  70%|███████   | 14/20 [01:32<00:34,  5.79s/it]
Task 9, Epoch 15/20 => Loss -0.172, Train_accy 96.70, Test_accy 62.70:  70%|███████   | 14/20 [01:50<00:34,  5.79s/it]
Task 9, Epoch 15/20 => Loss -0.172, Train_accy 96.70, Test_accy 62.70:  75%|███████▌  | 15/20 [01:50<00:48,  9.66s/it]
Task 9, Epoch 16/20 => Loss -0.169, Train_accy 96.70:  75%|███████▌  | 15/20 [01:55<00:48,  9.66s/it]                 
Task 9, Epoch 16/20 => Loss -0.169, Train_accy 96.70:  80%|████████  | 16/20 [01:55<00:32,  8.14s/it]
Task 9, Epoch 17/20 => Loss -0.184, Train_accy 95.82:  80%|████████  | 16/20 [01:59<00:32,  8.14s/it]
Task 9, Epoch 17/20 => Loss -0.184, Train_accy 95.82:  85%|████████▌ | 17/20 [01:59<00:21,  7.08s/it]
Task 9, Epoch 18/20 => Loss -0.198, Train_accy 97.14:  85%|████████▌ | 17/20 [02:04<00:21,  7.08s/it]
Task 9, Epoch 18/20 => Loss -0.198, Train_accy 97.14:  90%|█████████ | 18/20 [02:04<00:12,  6.35s/it]
Task 9, Epoch 19/20 => Loss -0.197, Train_accy 97.14:  90%|█████████ | 18/20 [02:09<00:12,  6.35s/it]
Task 9, Epoch 19/20 => Loss -0.197, Train_accy 97.14:  95%|█████████▌| 19/20 [02:09<00:05,  5.82s/it]
Task 9, Epoch 20/20 => Loss -0.180, Train_accy 96.48, Test_accy 63.54:  95%|█████████▌| 19/20 [02:27<00:05,  5.82s/it]
Task 9, Epoch 20/20 => Loss -0.180, Train_accy 96.48, Test_accy 63.54: 100%|██████████| 20/20 [02:27<00:00,  9.63s/it]
Task 9, Epoch 20/20 => Loss -0.180, Train_accy 96.48, Test_accy 63.54: 100%|██████████| 20/20 [02:27<00:00,  7.38s/it]
2024-09-05 23:32:54,721 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.180, Train_accy 96.48, Test_accy 63.54
2024-09-05 23:33:08,655 [trainer.py] => No NME accuracy.
2024-09-05 23:33:08,656 [trainer.py] => CNN: {'total': 63.54, '00-99': 91.33, '100-109': 47.83, '110-119': 30.09, '120-129': 48.6, '130-139': 34.75, '140-149': 22.22, '150-159': 31.45, '160-169': 26.87, '170-179': 33.01, '180-189': 24.24, 'old': 65.98, 'new': 24.24}
2024-09-05 23:33:08,656 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11, 77.27, 73.17, 70.65, 67.36, 65.7, 63.54]
2024-09-05 23:33:08,656 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49, 98.17, 97.91, 97.41, 97.09, 96.43, 95.88]

Average Accuracy (CNN): 75.93
2024-09-05 23:33:08,656 [trainer.py] => Average Accuracy (CNN): 75.93 

2024-09-05 23:33:08,659 [trainer.py] => All params: 171970192
2024-09-05 23:33:08,662 [trainer.py] => Trainable params: 199880
2024-09-05 23:33:08,662 [l2p.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.655, Train_accy 71.43:   0%|          | 0/20 [00:05<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.655, Train_accy 71.43:   5%|▌         | 1/20 [00:05<01:35,  5.02s/it]
Task 10, Epoch 2/20 => Loss 0.037, Train_accy 91.55:   5%|▌         | 1/20 [00:10<01:35,  5.02s/it]
Task 10, Epoch 2/20 => Loss 0.037, Train_accy 91.55:  10%|█         | 2/20 [00:10<01:30,  5.00s/it]
Task 10, Epoch 3/20 => Loss -0.071, Train_accy 94.16:  10%|█         | 2/20 [00:14<01:30,  5.00s/it]
Task 10, Epoch 3/20 => Loss -0.071, Train_accy 94.16:  15%|█▌        | 3/20 [00:14<01:24,  4.99s/it]
Task 10, Epoch 4/20 => Loss -0.073, Train_accy 93.76:  15%|█▌        | 3/20 [00:19<01:24,  4.99s/it]
Task 10, Epoch 4/20 => Loss -0.073, Train_accy 93.76:  20%|██        | 4/20 [00:19<01:19,  4.99s/it]
Task 10, Epoch 5/20 => Loss -0.118, Train_accy 95.57, Test_accy 61.07:  20%|██        | 4/20 [00:39<01:19,  4.99s/it]
Task 10, Epoch 5/20 => Loss -0.118, Train_accy 95.57, Test_accy 61.07:  25%|██▌       | 5/20 [00:39<02:33, 10.20s/it]
Task 10, Epoch 6/20 => Loss -0.160, Train_accy 96.18:  25%|██▌       | 5/20 [00:44<02:33, 10.20s/it]                 
Task 10, Epoch 6/20 => Loss -0.160, Train_accy 96.18:  30%|███       | 6/20 [00:44<01:58,  8.45s/it]
Task 10, Epoch 7/20 => Loss -0.112, Train_accy 94.77:  30%|███       | 6/20 [00:49<01:58,  8.45s/it]
Task 10, Epoch 7/20 => Loss -0.112, Train_accy 94.77:  35%|███▌      | 7/20 [00:49<01:34,  7.30s/it]
Task 10, Epoch 8/20 => Loss -0.166, Train_accy 95.57:  35%|███▌      | 7/20 [00:54<01:34,  7.30s/it]
Task 10, Epoch 8/20 => Loss -0.166, Train_accy 95.57:  40%|████      | 8/20 [00:54<01:18,  6.57s/it]
Task 10, Epoch 9/20 => Loss -0.137, Train_accy 94.37:  40%|████      | 8/20 [00:59<01:18,  6.57s/it]
Task 10, Epoch 9/20 => Loss -0.137, Train_accy 94.37:  45%|████▌     | 9/20 [00:59<01:06,  6.08s/it]
Task 10, Epoch 10/20 => Loss -0.147, Train_accy 95.57, Test_accy 61.54:  45%|████▌     | 9/20 [01:18<01:06,  6.08s/it]
Task 10, Epoch 10/20 => Loss -0.147, Train_accy 95.57, Test_accy 61.54:  50%|█████     | 10/20 [01:18<01:41, 10.17s/it]
Task 10, Epoch 11/20 => Loss -0.138, Train_accy 95.17:  50%|█████     | 10/20 [01:23<01:41, 10.17s/it]                 
Task 10, Epoch 11/20 => Loss -0.138, Train_accy 95.17:  55%|█████▌    | 11/20 [01:23<01:17,  8.57s/it]
Task 10, Epoch 12/20 => Loss -0.163, Train_accy 96.38:  55%|█████▌    | 11/20 [01:28<01:17,  8.57s/it]
Task 10, Epoch 12/20 => Loss -0.163, Train_accy 96.38:  60%|██████    | 12/20 [01:28<00:59,  7.47s/it]
Task 10, Epoch 13/20 => Loss -0.166, Train_accy 96.38:  60%|██████    | 12/20 [01:33<00:59,  7.47s/it]
Task 10, Epoch 13/20 => Loss -0.166, Train_accy 96.38:  65%|██████▌   | 13/20 [01:33<00:46,  6.71s/it]
Task 10, Epoch 14/20 => Loss -0.182, Train_accy 96.18:  65%|██████▌   | 13/20 [01:38<00:46,  6.71s/it]
Task 10, Epoch 14/20 => Loss -0.182, Train_accy 96.18:  70%|███████   | 14/20 [01:38<00:37,  6.18s/it]
Task 10, Epoch 15/20 => Loss -0.182, Train_accy 96.38, Test_accy 61.37:  70%|███████   | 14/20 [01:57<00:37,  6.18s/it]
Task 10, Epoch 15/20 => Loss -0.182, Train_accy 96.38, Test_accy 61.37:  75%|███████▌  | 15/20 [01:57<00:50, 10.15s/it]
Task 10, Epoch 16/20 => Loss -0.147, Train_accy 95.98:  75%|███████▌  | 15/20 [02:02<00:50, 10.15s/it]                 
Task 10, Epoch 16/20 => Loss -0.147, Train_accy 95.98:  80%|████████  | 16/20 [02:02<00:34,  8.58s/it]
Task 10, Epoch 17/20 => Loss -0.175, Train_accy 96.18:  80%|████████  | 16/20 [02:07<00:34,  8.58s/it]
Task 10, Epoch 17/20 => Loss -0.175, Train_accy 96.18:  85%|████████▌ | 17/20 [02:07<00:22,  7.49s/it]
Task 10, Epoch 18/20 => Loss -0.212, Train_accy 98.19:  85%|████████▌ | 17/20 [02:12<00:22,  7.49s/it]
Task 10, Epoch 18/20 => Loss -0.212, Train_accy 98.19:  90%|█████████ | 18/20 [02:12<00:13,  6.74s/it]
Task 10, Epoch 19/20 => Loss -0.205, Train_accy 97.38:  90%|█████████ | 18/20 [02:17<00:13,  6.74s/it]
Task 10, Epoch 19/20 => Loss -0.205, Train_accy 97.38:  95%|█████████▌| 19/20 [02:17<00:06,  6.20s/it]
Task 10, Epoch 20/20 => Loss -0.142, Train_accy 95.57, Test_accy 61.45:  95%|█████████▌| 19/20 [02:37<00:06,  6.20s/it]
Task 10, Epoch 20/20 => Loss -0.142, Train_accy 95.57, Test_accy 61.45: 100%|██████████| 20/20 [02:37<00:00, 10.18s/it]
Task 10, Epoch 20/20 => Loss -0.142, Train_accy 95.57, Test_accy 61.45: 100%|██████████| 20/20 [02:37<00:00,  7.86s/it]
2024-09-05 23:35:45,873 [l2p.py] => Task 10, Epoch 20/20 => Loss -0.142, Train_accy 95.57, Test_accy 61.45
2024-09-05 23:36:00,386 [trainer.py] => No NME accuracy.
2024-09-05 23:36:00,387 [trainer.py] => CNN: {'total': 61.45, '00-99': 91.08, '100-109': 43.48, '110-119': 30.09, '120-129': 49.53, '130-139': 32.2, '140-149': 22.22, '150-159': 31.45, '160-169': 26.87, '170-179': 33.01, '180-189': 22.73, '190-199': 25.51, 'old': 63.01, 'new': 25.51}
2024-09-05 23:36:00,387 [trainer.py] => CNN top1 curve: [91.5, 87.26, 82.77, 80.11, 77.27, 73.17, 70.65, 67.36, 65.7, 63.54, 61.45]
2024-09-05 23:36:00,387 [trainer.py] => CNN top5 curve: [99.07, 98.93, 98.87, 98.49, 98.17, 97.91, 97.41, 97.09, 96.43, 95.88, 95.34]

Average Accuracy (CNN): 74.62
2024-09-05 23:36:00,387 [trainer.py] => Average Accuracy (CNN): 74.62 

Accuracy Matrix (CNN):
[[91.5  91.67 91.67 91.67 91.67 91.58 91.58 90.99 91.16 91.33 91.08]
 [ 0.   41.74 42.61 40.87 44.35 44.35 45.22 45.22 46.09 47.83 43.48]
 [ 0.    0.   30.09 30.09 30.97 30.97 30.97 30.97 30.09 30.09 30.09]
 [ 0.    0.    0.   46.73 48.6  49.53 48.6  48.6  48.6  48.6  49.53]
 [ 0.    0.    0.    0.   34.75 33.9  35.59 35.59 35.59 34.75 32.2 ]
 [ 0.    0.    0.    0.    0.   20.63 21.43 21.43 21.43 22.22 22.22]
 [ 0.    0.    0.    0.    0.    0.   32.26 31.45 30.65 31.45 31.45]
 [ 0.    0.    0.    0.    0.    0.    0.   26.87 26.12 26.87 26.87]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   33.01 33.01 33.01]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   24.24 22.73]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   25.51]]
2024-09-05 23:36:00,390 [trainer.py] => Forgetting (CNN): 1.153
2024-09-13 17:33:23,249 [trainer.py] => config: ./exps/dualprompt_cub_B0_Inc5.json
2024-09-13 17:33:23,250 [trainer.py] => prefix:  
2024-09-13 17:33:23,250 [trainer.py] => dataset: cub
2024-09-13 17:33:23,250 [trainer.py] => memory_size: 0
2024-09-13 17:33:23,250 [trainer.py] => memory_per_class: 0
2024-09-13 17:33:23,250 [trainer.py] => fixed_memory: True
2024-09-13 17:33:23,250 [trainer.py] => shuffle: True
2024-09-13 17:33:23,250 [trainer.py] => init_cls: 40
2024-09-13 17:33:23,250 [trainer.py] => increment: 40
2024-09-13 17:33:23,250 [trainer.py] => model_name: dualprompt
2024-09-13 17:33:23,250 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-13 17:33:23,250 [trainer.py] => get_original_backbone: True
2024-09-13 17:33:23,250 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 17:33:23,250 [trainer.py] => seed: 1993
2024-09-13 17:33:23,250 [trainer.py] => tuned_epoch: 20
2024-09-13 17:33:23,250 [trainer.py] => init_lr: 0.001
2024-09-13 17:33:23,250 [trainer.py] => batch_size: 48
2024-09-13 17:33:23,250 [trainer.py] => weight_decay: 0
2024-09-13 17:33:23,250 [trainer.py] => min_lr: 1e-05
2024-09-13 17:33:23,250 [trainer.py] => optimizer: adam
2024-09-13 17:33:23,250 [trainer.py] => scheduler: constant
2024-09-13 17:33:23,250 [trainer.py] => reinit_optimizer: True
2024-09-13 17:33:23,250 [trainer.py] => global_pool: token
2024-09-13 17:33:23,250 [trainer.py] => head_type: token
2024-09-13 17:33:23,250 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-13 17:33:23,250 [trainer.py] => pretrained: True
2024-09-13 17:33:23,250 [trainer.py] => drop: 0.0
2024-09-13 17:33:23,250 [trainer.py] => drop_path: 0.0
2024-09-13 17:33:23,250 [trainer.py] => use_g_prompt: True
2024-09-13 17:33:23,251 [trainer.py] => g_prompt_length: 5
2024-09-13 17:33:23,251 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-13 17:33:23,251 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-13 17:33:23,251 [trainer.py] => use_e_prompt: True
2024-09-13 17:33:23,251 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-13 17:33:23,251 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-13 17:33:23,251 [trainer.py] => prompt_pool: True
2024-09-13 17:33:23,251 [trainer.py] => size: 10
2024-09-13 17:33:23,251 [trainer.py] => length: 5
2024-09-13 17:33:23,251 [trainer.py] => top_k: 1
2024-09-13 17:33:23,251 [trainer.py] => initializer: uniform
2024-09-13 17:33:23,251 [trainer.py] => prompt_key: True
2024-09-13 17:33:23,251 [trainer.py] => prompt_key_init: uniform
2024-09-13 17:33:23,251 [trainer.py] => use_prompt_mask: True
2024-09-13 17:33:23,251 [trainer.py] => shared_prompt_pool: True
2024-09-13 17:33:23,251 [trainer.py] => shared_prompt_key: False
2024-09-13 17:33:23,251 [trainer.py] => batchwise_prompt: True
2024-09-13 17:33:23,251 [trainer.py] => embedding_key: cls
2024-09-13 17:33:23,251 [trainer.py] => predefined_key: 
2024-09-13 17:33:23,251 [trainer.py] => pull_constraint: True
2024-09-13 17:33:23,251 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-13 17:33:23,251 [trainer.py] => same_key_value: False
2024-09-13 17:33:23,292 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 17:33:31,233 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-13 17:33:31,234 [dualprompt.py] => 407,240 model training parameters.
2024-09-13 17:33:31,234 [dualprompt.py] => g_prompt: 15360
2024-09-13 17:33:31,234 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-13 17:33:31,234 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-13 17:33:31,234 [dualprompt.py] => head.weight: 153600
2024-09-13 17:33:31,234 [dualprompt.py] => head.bias: 200
2024-09-13 17:33:31,235 [trainer.py] => All params: 172158352
2024-09-13 17:33:31,236 [trainer.py] => Trainable params: 407240
2024-09-13 17:33:31,236 [dualprompt.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.309, Train_accy 67.79:   0%|          | 0/20 [00:17<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.309, Train_accy 67.79:   5%|▌         | 1/20 [00:17<05:36, 17.74s/it]
Task 0, Epoch 2/20 => Loss 0.361, Train_accy 90.27:   5%|▌         | 1/20 [00:33<05:36, 17.74s/it]
Task 0, Epoch 2/20 => Loss 0.361, Train_accy 90.27:  10%|█         | 2/20 [00:33<05:03, 16.84s/it]
Task 0, Epoch 3/20 => Loss 0.272, Train_accy 92.70:  10%|█         | 2/20 [00:50<05:03, 16.84s/it]
Task 0, Epoch 3/20 => Loss 0.272, Train_accy 92.70:  15%|█▌        | 3/20 [00:50<04:40, 16.53s/it]
Task 0, Epoch 4/20 => Loss 0.247, Train_accy 93.44:  15%|█▌        | 3/20 [01:06<04:40, 16.53s/it]
Task 0, Epoch 4/20 => Loss 0.247, Train_accy 93.44:  20%|██        | 4/20 [01:06<04:22, 16.41s/it]
Task 0, Epoch 5/20 => Loss 0.257, Train_accy 93.02, Test_accy 96.92:  20%|██        | 4/20 [01:25<04:22, 16.41s/it]
Task 0, Epoch 5/20 => Loss 0.257, Train_accy 93.02, Test_accy 96.92:  25%|██▌       | 5/20 [01:25<04:23, 17.54s/it]
Task 0, Epoch 6/20 => Loss 0.230, Train_accy 94.02:  25%|██▌       | 5/20 [01:42<04:23, 17.54s/it]                 
Task 0, Epoch 6/20 => Loss 0.230, Train_accy 94.02:  30%|███       | 6/20 [01:42<04:00, 17.14s/it]
Task 0, Epoch 7/20 => Loss 0.240, Train_accy 92.38:  30%|███       | 6/20 [01:58<04:00, 17.14s/it]
Task 0, Epoch 7/20 => Loss 0.240, Train_accy 92.38:  35%|███▌      | 7/20 [01:58<03:40, 16.94s/it]
Task 0, Epoch 8/20 => Loss 0.186, Train_accy 94.13:  35%|███▌      | 7/20 [02:15<03:40, 16.94s/it]
Task 0, Epoch 8/20 => Loss 0.186, Train_accy 94.13:  40%|████      | 8/20 [02:15<03:20, 16.75s/it]
Task 0, Epoch 9/20 => Loss 0.193, Train_accy 94.13:  40%|████      | 8/20 [02:31<03:20, 16.75s/it]
Task 0, Epoch 9/20 => Loss 0.193, Train_accy 94.13:  45%|████▌     | 9/20 [02:31<03:03, 16.67s/it]
Task 0, Epoch 10/20 => Loss 0.177, Train_accy 94.71, Test_accy 97.14:  45%|████▌     | 9/20 [02:51<03:03, 16.67s/it]
Task 0, Epoch 10/20 => Loss 0.177, Train_accy 94.71, Test_accy 97.14:  50%|█████     | 10/20 [02:51<02:55, 17.58s/it]
Task 0, Epoch 11/20 => Loss 0.186, Train_accy 94.13:  50%|█████     | 10/20 [03:07<02:55, 17.58s/it]                 
Task 0, Epoch 11/20 => Loss 0.186, Train_accy 94.13:  55%|█████▌    | 11/20 [03:07<02:34, 17.21s/it]
Task 0, Epoch 12/20 => Loss 0.160, Train_accy 95.24:  55%|█████▌    | 11/20 [03:23<02:34, 17.21s/it]
Task 0, Epoch 12/20 => Loss 0.160, Train_accy 95.24:  60%|██████    | 12/20 [03:23<02:15, 16.95s/it]
Task 0, Epoch 13/20 => Loss 0.165, Train_accy 95.19:  60%|██████    | 12/20 [03:40<02:15, 16.95s/it]
Task 0, Epoch 13/20 => Loss 0.165, Train_accy 95.19:  65%|██████▌   | 13/20 [03:40<01:57, 16.77s/it]
Task 0, Epoch 14/20 => Loss 0.147, Train_accy 95.93:  65%|██████▌   | 13/20 [03:56<01:57, 16.77s/it]
Task 0, Epoch 14/20 => Loss 0.147, Train_accy 95.93:  70%|███████   | 14/20 [03:56<01:39, 16.66s/it]
Task 0, Epoch 15/20 => Loss 0.171, Train_accy 94.55, Test_accy 97.36:  70%|███████   | 14/20 [04:16<01:39, 16.66s/it]
Task 0, Epoch 15/20 => Loss 0.171, Train_accy 94.55, Test_accy 97.36:  75%|███████▌  | 15/20 [04:16<01:27, 17.58s/it]
Task 0, Epoch 16/20 => Loss 0.126, Train_accy 95.61:  75%|███████▌  | 15/20 [04:32<01:27, 17.58s/it]                 
Task 0, Epoch 16/20 => Loss 0.126, Train_accy 95.61:  80%|████████  | 16/20 [04:32<01:08, 17.24s/it]
Task 0, Epoch 17/20 => Loss 0.126, Train_accy 95.72:  80%|████████  | 16/20 [04:49<01:08, 17.24s/it]
Task 0, Epoch 17/20 => Loss 0.126, Train_accy 95.72:  85%|████████▌ | 17/20 [04:49<00:51, 17.05s/it]
Task 0, Epoch 18/20 => Loss 0.166, Train_accy 94.61:  85%|████████▌ | 17/20 [05:05<00:51, 17.05s/it]
Task 0, Epoch 18/20 => Loss 0.166, Train_accy 94.61:  90%|█████████ | 18/20 [05:05<00:33, 16.84s/it]
Task 0, Epoch 19/20 => Loss 0.123, Train_accy 95.82:  90%|█████████ | 18/20 [05:22<00:33, 16.84s/it]
Task 0, Epoch 19/20 => Loss 0.123, Train_accy 95.82:  95%|█████████▌| 19/20 [05:22<00:16, 16.73s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.19, Test_accy 97.14:  95%|█████████▌| 19/20 [05:41<00:16, 16.73s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.19, Test_accy 97.14: 100%|██████████| 20/20 [05:41<00:00, 17.59s/it]
Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.19, Test_accy 97.14: 100%|██████████| 20/20 [05:41<00:00, 17.09s/it]2024-09-13 17:39:13,745 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.151, Train_accy 95.19, Test_accy 97.14

2024-09-13 17:39:17,021 [trainer.py] => No NME accuracy.
2024-09-13 17:39:17,022 [trainer.py] => CNN: {'total': 97.14, '00-39': 97.14, 'old': 0, 'new': 97.14}
2024-09-13 17:39:17,022 [trainer.py] => CNN top1 curve: [97.14]
2024-09-13 17:39:17,023 [trainer.py] => CNN top5 curve: [99.56]

Average Accuracy (CNN): 97.14
2024-09-13 17:39:17,023 [trainer.py] => Average Accuracy (CNN): 97.14 

2024-09-13 17:39:17,026 [trainer.py] => All params: 172158352
2024-09-13 17:39:17,028 [trainer.py] => Trainable params: 407240
2024-09-13 17:39:17,029 [dualprompt.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.313, Train_accy 68.55:   0%|          | 0/20 [00:16<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.313, Train_accy 68.55:   5%|▌         | 1/20 [00:16<05:18, 16.75s/it]
Task 1, Epoch 2/20 => Loss 0.336, Train_accy 91.16:   5%|▌         | 1/20 [00:33<05:18, 16.75s/it]
Task 1, Epoch 2/20 => Loss 0.336, Train_accy 91.16:  10%|█         | 2/20 [00:33<04:58, 16.56s/it]
Task 1, Epoch 3/20 => Loss 0.297, Train_accy 92.06:  10%|█         | 2/20 [00:49<04:58, 16.56s/it]
Task 1, Epoch 3/20 => Loss 0.297, Train_accy 92.06:  15%|█▌        | 3/20 [00:49<04:41, 16.57s/it]
Task 1, Epoch 4/20 => Loss 0.234, Train_accy 92.91:  15%|█▌        | 3/20 [01:06<04:41, 16.57s/it]
Task 1, Epoch 4/20 => Loss 0.234, Train_accy 92.91:  20%|██        | 4/20 [01:06<04:24, 16.50s/it]
Task 1, Epoch 5/20 => Loss 0.214, Train_accy 93.75, Test_accy 84.11:  20%|██        | 4/20 [01:28<04:24, 16.50s/it]
Task 1, Epoch 5/20 => Loss 0.214, Train_accy 93.75, Test_accy 84.11:  25%|██▌       | 5/20 [01:28<04:38, 18.59s/it]
Task 1, Epoch 6/20 => Loss 0.235, Train_accy 93.12:  25%|██▌       | 5/20 [01:44<04:38, 18.59s/it]                 
Task 1, Epoch 6/20 => Loss 0.235, Train_accy 93.12:  30%|███       | 6/20 [01:44<04:09, 17.84s/it]
Task 1, Epoch 7/20 => Loss 0.199, Train_accy 93.70:  30%|███       | 6/20 [02:01<04:09, 17.84s/it]
Task 1, Epoch 7/20 => Loss 0.199, Train_accy 93.70:  35%|███▌      | 7/20 [02:01<03:45, 17.37s/it]
Task 1, Epoch 8/20 => Loss 0.213, Train_accy 93.12:  35%|███▌      | 7/20 [02:17<03:45, 17.37s/it]
Task 1, Epoch 8/20 => Loss 0.213, Train_accy 93.12:  40%|████      | 8/20 [02:17<03:25, 17.09s/it]
Task 1, Epoch 9/20 => Loss 0.187, Train_accy 94.23:  40%|████      | 8/20 [02:34<03:25, 17.09s/it]
Task 1, Epoch 9/20 => Loss 0.187, Train_accy 94.23:  45%|████▌     | 9/20 [02:34<03:05, 16.85s/it]
Task 1, Epoch 10/20 => Loss 0.180, Train_accy 94.28, Test_accy 86.40:  45%|████▌     | 9/20 [02:56<03:05, 16.85s/it]
Task 1, Epoch 10/20 => Loss 0.180, Train_accy 94.28, Test_accy 86.40:  50%|█████     | 10/20 [02:56<03:05, 18.51s/it]
Task 1, Epoch 11/20 => Loss 0.176, Train_accy 94.60:  50%|█████     | 10/20 [03:12<03:05, 18.51s/it]                 
Task 1, Epoch 11/20 => Loss 0.176, Train_accy 94.60:  55%|█████▌    | 11/20 [03:12<02:41, 17.90s/it]
Task 1, Epoch 12/20 => Loss 0.152, Train_accy 95.18:  55%|█████▌    | 11/20 [03:29<02:41, 17.90s/it]
Task 1, Epoch 12/20 => Loss 0.152, Train_accy 95.18:  60%|██████    | 12/20 [03:29<02:19, 17.46s/it]
Task 1, Epoch 13/20 => Loss 0.150, Train_accy 95.24:  60%|██████    | 12/20 [03:45<02:19, 17.46s/it]
Task 1, Epoch 13/20 => Loss 0.150, Train_accy 95.24:  65%|██████▌   | 13/20 [03:45<01:59, 17.14s/it]
Task 1, Epoch 14/20 => Loss 0.159, Train_accy 94.87:  65%|██████▌   | 13/20 [04:02<01:59, 17.14s/it]
Task 1, Epoch 14/20 => Loss 0.159, Train_accy 94.87:  70%|███████   | 14/20 [04:02<01:41, 16.95s/it]
Task 1, Epoch 15/20 => Loss 0.174, Train_accy 94.71, Test_accy 88.36:  70%|███████   | 14/20 [04:24<01:41, 16.95s/it]
Task 1, Epoch 15/20 => Loss 0.174, Train_accy 94.71, Test_accy 88.36:  75%|███████▌  | 15/20 [04:24<01:33, 18.60s/it]
Task 1, Epoch 16/20 => Loss 0.160, Train_accy 94.97:  75%|███████▌  | 15/20 [04:40<01:33, 18.60s/it]                 
Task 1, Epoch 16/20 => Loss 0.160, Train_accy 94.97:  80%|████████  | 16/20 [04:40<01:11, 17.92s/it]
Task 1, Epoch 17/20 => Loss 0.145, Train_accy 95.45:  80%|████████  | 16/20 [04:57<01:11, 17.92s/it]
Task 1, Epoch 17/20 => Loss 0.145, Train_accy 95.45:  85%|████████▌ | 17/20 [04:57<00:52, 17.49s/it]
Task 1, Epoch 18/20 => Loss 0.147, Train_accy 94.92:  85%|████████▌ | 17/20 [05:13<00:52, 17.49s/it]
Task 1, Epoch 18/20 => Loss 0.147, Train_accy 94.92:  90%|█████████ | 18/20 [05:13<00:34, 17.14s/it]
Task 1, Epoch 19/20 => Loss 0.175, Train_accy 94.44:  90%|█████████ | 18/20 [05:30<00:34, 17.14s/it]
Task 1, Epoch 19/20 => Loss 0.175, Train_accy 94.44:  95%|█████████▌| 19/20 [05:30<00:16, 16.94s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 95.08, Test_accy 90.21:  95%|█████████▌| 19/20 [05:52<00:16, 16.94s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 95.08, Test_accy 90.21: 100%|██████████| 20/20 [05:52<00:00, 18.55s/it]
Task 1, Epoch 20/20 => Loss 0.130, Train_accy 95.08, Test_accy 90.21: 100%|██████████| 20/20 [05:52<00:00, 17.63s/it]2024-09-13 17:45:09,576 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.130, Train_accy 95.08, Test_accy 90.21

2024-09-13 17:45:15,315 [trainer.py] => No NME accuracy.
2024-09-13 17:45:15,315 [trainer.py] => CNN: {'total': 90.21, '00-39': 93.39, '40-79': 87.1, 'old': 93.39, 'new': 87.1}
2024-09-13 17:45:15,316 [trainer.py] => CNN top1 curve: [97.14, 90.21]
2024-09-13 17:45:15,316 [trainer.py] => CNN top5 curve: [99.56, 98.8]

Average Accuracy (CNN): 93.68
2024-09-13 17:45:15,316 [trainer.py] => Average Accuracy (CNN): 93.68 

2024-09-13 17:45:15,317 [trainer.py] => All params: 172158352
2024-09-13 17:45:15,318 [trainer.py] => Trainable params: 407240
2024-09-13 17:45:15,318 [dualprompt.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.278, Train_accy 69.77:   0%|          | 0/20 [00:16<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.278, Train_accy 69.77:   5%|▌         | 1/20 [00:16<05:14, 16.54s/it]
Task 2, Epoch 2/20 => Loss 0.342, Train_accy 89.92:   5%|▌         | 1/20 [00:32<05:14, 16.54s/it]
Task 2, Epoch 2/20 => Loss 0.342, Train_accy 89.92:  10%|█         | 2/20 [00:32<04:54, 16.34s/it]
Task 2, Epoch 3/20 => Loss 0.308, Train_accy 90.68:  10%|█         | 2/20 [00:48<04:54, 16.34s/it]
Task 2, Epoch 3/20 => Loss 0.308, Train_accy 90.68:  15%|█▌        | 3/20 [00:48<04:36, 16.29s/it]
Task 2, Epoch 4/20 => Loss 0.288, Train_accy 90.94:  15%|█▌        | 3/20 [01:05<04:36, 16.29s/it]
Task 2, Epoch 4/20 => Loss 0.288, Train_accy 90.94:  20%|██        | 4/20 [01:05<04:20, 16.29s/it]
Task 2, Epoch 5/20 => Loss 0.214, Train_accy 93.57, Test_accy 79.31:  20%|██        | 4/20 [01:30<04:20, 16.29s/it]
Task 2, Epoch 5/20 => Loss 0.214, Train_accy 93.57, Test_accy 79.31:  25%|██▌       | 5/20 [01:30<04:50, 19.38s/it]
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 92.93:  25%|██▌       | 5/20 [01:46<04:50, 19.38s/it]                 
Task 2, Epoch 6/20 => Loss 0.241, Train_accy 92.93:  30%|███       | 6/20 [01:46<04:16, 18.35s/it]
Task 2, Epoch 7/20 => Loss 0.207, Train_accy 93.46:  30%|███       | 6/20 [02:02<04:16, 18.35s/it]
Task 2, Epoch 7/20 => Loss 0.207, Train_accy 93.46:  35%|███▌      | 7/20 [02:02<03:50, 17.70s/it]
Task 2, Epoch 8/20 => Loss 0.187, Train_accy 94.53:  35%|███▌      | 7/20 [02:19<03:50, 17.70s/it]
Task 2, Epoch 8/20 => Loss 0.187, Train_accy 94.53:  40%|████      | 8/20 [02:19<03:27, 17.29s/it]
Task 2, Epoch 9/20 => Loss 0.158, Train_accy 94.96:  40%|████      | 8/20 [02:35<03:27, 17.29s/it]
Task 2, Epoch 9/20 => Loss 0.158, Train_accy 94.96:  45%|████▌     | 9/20 [02:35<03:06, 16.99s/it]
Task 2, Epoch 10/20 => Loss 0.183, Train_accy 94.21, Test_accy 81.92:  45%|████▌     | 9/20 [03:00<03:06, 16.99s/it]
Task 2, Epoch 10/20 => Loss 0.183, Train_accy 94.21, Test_accy 81.92:  50%|█████     | 10/20 [03:00<03:13, 19.36s/it]
Task 2, Epoch 11/20 => Loss 0.141, Train_accy 94.86:  50%|█████     | 10/20 [03:16<03:13, 19.36s/it]                 
Task 2, Epoch 11/20 => Loss 0.141, Train_accy 94.86:  55%|█████▌    | 11/20 [03:16<02:45, 18.39s/it]
Task 2, Epoch 12/20 => Loss 0.175, Train_accy 93.94:  55%|█████▌    | 11/20 [03:32<02:45, 18.39s/it]
Task 2, Epoch 12/20 => Loss 0.175, Train_accy 93.94:  60%|██████    | 12/20 [03:32<02:22, 17.76s/it]
Task 2, Epoch 13/20 => Loss 0.156, Train_accy 95.28:  60%|██████    | 12/20 [03:49<02:22, 17.76s/it]
Task 2, Epoch 13/20 => Loss 0.156, Train_accy 95.28:  65%|██████▌   | 13/20 [03:49<02:01, 17.32s/it]
Task 2, Epoch 14/20 => Loss 0.145, Train_accy 94.69:  65%|██████▌   | 13/20 [04:05<02:01, 17.32s/it]
Task 2, Epoch 14/20 => Loss 0.145, Train_accy 94.69:  70%|███████   | 14/20 [04:05<01:42, 17.06s/it]
Task 2, Epoch 15/20 => Loss 0.152, Train_accy 94.75, Test_accy 83.12:  70%|███████   | 14/20 [04:30<01:42, 17.06s/it]
Task 2, Epoch 15/20 => Loss 0.152, Train_accy 94.75, Test_accy 83.12:  75%|███████▌  | 15/20 [04:30<01:37, 19.45s/it]
Task 2, Epoch 16/20 => Loss 0.135, Train_accy 95.28:  75%|███████▌  | 15/20 [04:46<01:37, 19.45s/it]                 
Task 2, Epoch 16/20 => Loss 0.135, Train_accy 95.28:  80%|████████  | 16/20 [04:46<01:14, 18.52s/it]
Task 2, Epoch 17/20 => Loss 0.114, Train_accy 95.87:  80%|████████  | 16/20 [05:03<01:14, 18.52s/it]
Task 2, Epoch 17/20 => Loss 0.114, Train_accy 95.87:  85%|████████▌ | 17/20 [05:03<00:53, 17.86s/it]
Task 2, Epoch 18/20 => Loss 0.140, Train_accy 95.34:  85%|████████▌ | 17/20 [05:19<00:53, 17.86s/it]
Task 2, Epoch 18/20 => Loss 0.140, Train_accy 95.34:  90%|█████████ | 18/20 [05:19<00:34, 17.37s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 95.23:  90%|█████████ | 18/20 [05:35<00:34, 17.37s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 95.23:  95%|█████████▌| 19/20 [05:35<00:17, 17.07s/it]
Task 2, Epoch 20/20 => Loss 0.100, Train_accy 95.87, Test_accy 84.75:  95%|█████████▌| 19/20 [06:00<00:17, 17.07s/it]
Task 2, Epoch 20/20 => Loss 0.100, Train_accy 95.87, Test_accy 84.75: 100%|██████████| 20/20 [06:00<00:00, 19.40s/it]
Task 2, Epoch 20/20 => Loss 0.100, Train_accy 95.87, Test_accy 84.75: 100%|██████████| 20/20 [06:00<00:00, 18.03s/it]2024-09-13 17:51:15,950 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.100, Train_accy 95.87, Test_accy 84.75

2024-09-13 17:51:24,572 [trainer.py] => No NME accuracy.
2024-09-13 17:51:24,572 [trainer.py] => CNN: {'total': 84.75, '00-39': 92.95, '40-79': 84.95, '80-119': 77.06, 'old': 88.9, 'new': 77.06}
2024-09-13 17:51:24,572 [trainer.py] => CNN top1 curve: [97.14, 90.21, 84.75]
2024-09-13 17:51:24,573 [trainer.py] => CNN top5 curve: [99.56, 98.8, 98.8]

Average Accuracy (CNN): 90.7
2024-09-13 17:51:24,573 [trainer.py] => Average Accuracy (CNN): 90.7 

2024-09-13 17:51:24,576 [trainer.py] => All params: 172158352
2024-09-13 17:51:24,579 [trainer.py] => Trainable params: 407240
2024-09-13 17:51:24,579 [dualprompt.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.416, Train_accy 63.50:   0%|          | 0/20 [00:16<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.416, Train_accy 63.50:   5%|▌         | 1/20 [00:16<05:15, 16.61s/it]
Task 3, Epoch 2/20 => Loss 0.430, Train_accy 86.98:   5%|▌         | 1/20 [00:32<05:15, 16.61s/it]
Task 3, Epoch 2/20 => Loss 0.430, Train_accy 86.98:  10%|█         | 2/20 [00:32<04:56, 16.46s/it]
Task 3, Epoch 3/20 => Loss 0.347, Train_accy 89.49:  10%|█         | 2/20 [00:49<04:56, 16.46s/it]
Task 3, Epoch 3/20 => Loss 0.347, Train_accy 89.49:  15%|█▌        | 3/20 [00:49<04:38, 16.40s/it]
Task 3, Epoch 4/20 => Loss 0.294, Train_accy 90.88:  15%|█▌        | 3/20 [01:05<04:38, 16.40s/it]
Task 3, Epoch 4/20 => Loss 0.294, Train_accy 90.88:  20%|██        | 4/20 [01:05<04:22, 16.38s/it]
Task 3, Epoch 5/20 => Loss 0.269, Train_accy 92.05, Test_accy 74.88:  20%|██        | 4/20 [01:33<04:22, 16.38s/it]
Task 3, Epoch 5/20 => Loss 0.269, Train_accy 92.05, Test_accy 74.88:  25%|██▌       | 5/20 [01:33<05:05, 20.40s/it]
Task 3, Epoch 6/20 => Loss 0.222, Train_accy 92.90:  25%|██▌       | 5/20 [01:49<05:05, 20.40s/it]                 
Task 3, Epoch 6/20 => Loss 0.222, Train_accy 92.90:  30%|███       | 6/20 [01:49<04:26, 19.02s/it]
Task 3, Epoch 7/20 => Loss 0.231, Train_accy 92.80:  30%|███       | 6/20 [02:05<04:26, 19.02s/it]
Task 3, Epoch 7/20 => Loss 0.231, Train_accy 92.80:  35%|███▌      | 7/20 [02:05<03:56, 18.16s/it]
Task 3, Epoch 8/20 => Loss 0.198, Train_accy 93.33:  35%|███▌      | 7/20 [02:22<03:56, 18.16s/it]
Task 3, Epoch 8/20 => Loss 0.198, Train_accy 93.33:  40%|████      | 8/20 [02:22<03:31, 17.60s/it]
Task 3, Epoch 9/20 => Loss 0.211, Train_accy 93.33:  40%|████      | 8/20 [02:38<03:31, 17.60s/it]
Task 3, Epoch 9/20 => Loss 0.211, Train_accy 93.33:  45%|████▌     | 9/20 [02:38<03:09, 17.20s/it]
Task 3, Epoch 10/20 => Loss 0.234, Train_accy 92.96, Test_accy 77.15:  45%|████▌     | 9/20 [03:06<03:09, 17.20s/it]
Task 3, Epoch 10/20 => Loss 0.234, Train_accy 92.96, Test_accy 77.15:  50%|█████     | 10/20 [03:06<03:23, 20.36s/it]
Task 3, Epoch 11/20 => Loss 0.227, Train_accy 93.01:  50%|█████     | 10/20 [03:22<03:23, 20.36s/it]                 
Task 3, Epoch 11/20 => Loss 0.227, Train_accy 93.01:  55%|█████▌    | 11/20 [03:22<02:51, 19.11s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 94.24:  55%|█████▌    | 11/20 [03:38<02:51, 19.11s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 94.24:  60%|██████    | 12/20 [03:38<02:26, 18.27s/it]
Task 3, Epoch 13/20 => Loss 0.227, Train_accy 93.70:  60%|██████    | 12/20 [03:55<02:26, 18.27s/it]
Task 3, Epoch 13/20 => Loss 0.227, Train_accy 93.70:  65%|██████▌   | 13/20 [03:55<02:04, 17.72s/it]
Task 3, Epoch 14/20 => Loss 0.181, Train_accy 94.24:  65%|██████▌   | 13/20 [04:11<02:04, 17.72s/it]
Task 3, Epoch 14/20 => Loss 0.181, Train_accy 94.24:  70%|███████   | 14/20 [04:11<01:43, 17.31s/it]
Task 3, Epoch 15/20 => Loss 0.175, Train_accy 93.81, Test_accy 78.85:  70%|███████   | 14/20 [04:39<01:43, 17.31s/it]
Task 3, Epoch 15/20 => Loss 0.175, Train_accy 93.81, Test_accy 78.85:  75%|███████▌  | 15/20 [04:39<01:42, 20.46s/it]
Task 3, Epoch 16/20 => Loss 0.176, Train_accy 93.81:  75%|███████▌  | 15/20 [04:55<01:42, 20.46s/it]                 
Task 3, Epoch 16/20 => Loss 0.176, Train_accy 93.81:  80%|████████  | 16/20 [04:55<01:16, 19.21s/it]
Task 3, Epoch 17/20 => Loss 0.133, Train_accy 95.14:  80%|████████  | 16/20 [05:11<01:16, 19.21s/it]
Task 3, Epoch 17/20 => Loss 0.133, Train_accy 95.14:  85%|████████▌ | 17/20 [05:11<00:54, 18.33s/it]
Task 3, Epoch 18/20 => Loss 0.157, Train_accy 94.56:  85%|████████▌ | 17/20 [05:28<00:54, 18.33s/it]
Task 3, Epoch 18/20 => Loss 0.157, Train_accy 94.56:  90%|█████████ | 18/20 [05:28<00:35, 17.73s/it]
Task 3, Epoch 19/20 => Loss 0.163, Train_accy 94.40:  90%|█████████ | 18/20 [05:44<00:35, 17.73s/it]
Task 3, Epoch 19/20 => Loss 0.163, Train_accy 94.40:  95%|█████████▌| 19/20 [05:44<00:17, 17.31s/it]
Task 3, Epoch 20/20 => Loss 0.189, Train_accy 94.29, Test_accy 79.32:  95%|█████████▌| 19/20 [06:11<00:17, 17.31s/it]
Task 3, Epoch 20/20 => Loss 0.189, Train_accy 94.29, Test_accy 79.32: 100%|██████████| 20/20 [06:11<00:00, 20.36s/it]
Task 3, Epoch 20/20 => Loss 0.189, Train_accy 94.29, Test_accy 79.32: 100%|██████████| 20/20 [06:11<00:00, 18.60s/it]2024-09-13 17:57:36,584 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.189, Train_accy 94.29, Test_accy 79.32

2024-09-13 17:57:47,709 [trainer.py] => No NME accuracy.
2024-09-13 17:57:47,710 [trainer.py] => CNN: {'total': 79.32, '00-39': 92.73, '40-79': 83.23, '80-119': 73.44, '120-159': 68.84, 'old': 82.84, 'new': 68.84}
2024-09-13 17:57:47,710 [trainer.py] => CNN top1 curve: [97.14, 90.21, 84.75, 79.32]
2024-09-13 17:57:47,710 [trainer.py] => CNN top5 curve: [99.56, 98.8, 98.8, 98.57]

Average Accuracy (CNN): 87.86
2024-09-13 17:57:47,710 [trainer.py] => Average Accuracy (CNN): 87.86 

2024-09-13 17:57:47,713 [trainer.py] => All params: 172158352
2024-09-13 17:57:47,715 [trainer.py] => Trainable params: 407240
2024-09-13 17:57:47,715 [dualprompt.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.275, Train_accy 67.80:   0%|          | 0/20 [00:16<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.275, Train_accy 67.80:   5%|▌         | 1/20 [00:16<05:21, 16.90s/it]
Task 4, Epoch 2/20 => Loss 0.386, Train_accy 89.69:   5%|▌         | 1/20 [00:33<05:21, 16.90s/it]
Task 4, Epoch 2/20 => Loss 0.386, Train_accy 89.69:  10%|█         | 2/20 [00:33<05:02, 16.80s/it]
Task 4, Epoch 3/20 => Loss 0.302, Train_accy 90.79:  10%|█         | 2/20 [00:50<05:02, 16.80s/it]
Task 4, Epoch 3/20 => Loss 0.302, Train_accy 90.79:  15%|█▌        | 3/20 [00:50<04:45, 16.77s/it]
Task 4, Epoch 4/20 => Loss 0.265, Train_accy 92.62:  15%|█▌        | 3/20 [01:07<04:45, 16.77s/it]
Task 4, Epoch 4/20 => Loss 0.265, Train_accy 92.62:  20%|██        | 4/20 [01:07<04:28, 16.77s/it]
Task 4, Epoch 5/20 => Loss 0.213, Train_accy 93.66, Test_accy 71.08:  20%|██        | 4/20 [01:37<04:28, 16.77s/it]
Task 4, Epoch 5/20 => Loss 0.213, Train_accy 93.66, Test_accy 71.08:  25%|██▌       | 5/20 [01:37<05:25, 21.71s/it]
Task 4, Epoch 6/20 => Loss 0.208, Train_accy 93.66:  25%|██▌       | 5/20 [01:54<05:25, 21.71s/it]                 
Task 4, Epoch 6/20 => Loss 0.208, Train_accy 93.66:  30%|███       | 6/20 [01:54<04:39, 19.96s/it]
Task 4, Epoch 7/20 => Loss 0.255, Train_accy 92.51:  30%|███       | 6/20 [02:10<04:39, 19.96s/it]
Task 4, Epoch 7/20 => Loss 0.255, Train_accy 92.51:  35%|███▌      | 7/20 [02:10<04:05, 18.87s/it]
Task 4, Epoch 8/20 => Loss 0.183, Train_accy 94.45:  35%|███▌      | 7/20 [02:27<04:05, 18.87s/it]
Task 4, Epoch 8/20 => Loss 0.183, Train_accy 94.45:  40%|████      | 8/20 [02:27<03:38, 18.21s/it]
Task 4, Epoch 9/20 => Loss 0.201, Train_accy 94.03:  40%|████      | 8/20 [02:44<03:38, 18.21s/it]
Task 4, Epoch 9/20 => Loss 0.201, Train_accy 94.03:  45%|████▌     | 9/20 [02:44<03:15, 17.77s/it]
Task 4, Epoch 10/20 => Loss 0.175, Train_accy 94.40, Test_accy 73.16:  45%|████▌     | 9/20 [03:14<03:15, 17.77s/it]
Task 4, Epoch 10/20 => Loss 0.175, Train_accy 94.40, Test_accy 73.16:  50%|█████     | 10/20 [03:14<03:36, 21.67s/it]
Task 4, Epoch 11/20 => Loss 0.186, Train_accy 93.98:  50%|█████     | 10/20 [03:31<03:36, 21.67s/it]                 
Task 4, Epoch 11/20 => Loss 0.186, Train_accy 93.98:  55%|█████▌    | 11/20 [03:31<03:01, 20.12s/it]
Task 4, Epoch 12/20 => Loss 0.167, Train_accy 94.55:  55%|█████▌    | 11/20 [03:48<03:01, 20.12s/it]
Task 4, Epoch 12/20 => Loss 0.167, Train_accy 94.55:  60%|██████    | 12/20 [03:48<02:32, 19.06s/it]
Task 4, Epoch 13/20 => Loss 0.185, Train_accy 94.24:  60%|██████    | 12/20 [04:04<02:32, 19.06s/it]
Task 4, Epoch 13/20 => Loss 0.185, Train_accy 94.24:  65%|██████▌   | 13/20 [04:04<02:08, 18.33s/it]
Task 4, Epoch 14/20 => Loss 0.172, Train_accy 94.35:  65%|██████▌   | 13/20 [04:21<02:08, 18.33s/it]
Task 4, Epoch 14/20 => Loss 0.172, Train_accy 94.35:  70%|███████   | 14/20 [04:21<01:47, 17.84s/it]
Task 4, Epoch 15/20 => Loss 0.118, Train_accy 95.76, Test_accy 74.60:  70%|███████   | 14/20 [04:52<01:47, 17.84s/it]
Task 4, Epoch 15/20 => Loss 0.118, Train_accy 95.76, Test_accy 74.60:  75%|███████▌  | 15/20 [04:52<01:48, 21.74s/it]
Task 4, Epoch 16/20 => Loss 0.158, Train_accy 94.50:  75%|███████▌  | 15/20 [05:08<01:48, 21.74s/it]                 
Task 4, Epoch 16/20 => Loss 0.158, Train_accy 94.50:  80%|████████  | 16/20 [05:08<01:20, 20.19s/it]
Task 4, Epoch 17/20 => Loss 0.149, Train_accy 94.97:  80%|████████  | 16/20 [05:25<01:20, 20.19s/it]
Task 4, Epoch 17/20 => Loss 0.149, Train_accy 94.97:  85%|████████▌ | 17/20 [05:25<00:57, 19.12s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.45:  85%|████████▌ | 17/20 [05:42<00:57, 19.12s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.45:  90%|█████████ | 18/20 [05:42<00:36, 18.37s/it]
Task 4, Epoch 19/20 => Loss 0.138, Train_accy 95.08:  90%|█████████ | 18/20 [05:58<00:36, 18.37s/it]
Task 4, Epoch 19/20 => Loss 0.138, Train_accy 95.08:  95%|█████████▌| 19/20 [05:58<00:17, 17.83s/it]
Task 4, Epoch 20/20 => Loss 0.136, Train_accy 94.71, Test_accy 76.00:  95%|█████████▌| 19/20 [06:29<00:17, 17.83s/it]
Task 4, Epoch 20/20 => Loss 0.136, Train_accy 94.71, Test_accy 76.00: 100%|██████████| 20/20 [06:29<00:00, 21.64s/it]
Task 4, Epoch 20/20 => Loss 0.136, Train_accy 94.71, Test_accy 76.00: 100%|██████████| 20/20 [06:29<00:00, 19.45s/it]2024-09-13 18:04:16,819 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.136, Train_accy 94.71, Test_accy 76.00

2024-09-13 18:04:30,555 [trainer.py] => No NME accuracy.
2024-09-13 18:04:30,556 [trainer.py] => CNN: {'total': 76.0, '00-39': 91.19, '40-79': 82.15, '80-119': 72.84, '120-159': 67.79, '160-199': 66.81, 'old': 78.27, 'new': 66.81}
2024-09-13 18:04:30,556 [trainer.py] => CNN top1 curve: [97.14, 90.21, 84.75, 79.32, 76.0]
2024-09-13 18:04:30,556 [trainer.py] => CNN top5 curve: [99.56, 98.8, 98.8, 98.57, 98.05]

Average Accuracy (CNN): 85.48
2024-09-13 18:04:30,557 [trainer.py] => Average Accuracy (CNN): 85.48 

Accuracy Matrix (CNN):
[[97.14 93.39 92.95 92.73 91.19]
 [ 0.   87.1  84.95 83.23 82.15]
 [ 0.    0.   77.06 73.44 72.84]
 [ 0.    0.    0.   68.84 67.79]
 [ 0.    0.    0.    0.   66.81]]
2024-09-13 18:04:30,559 [trainer.py] => Forgetting (CNN): 4.042499999999997
2024-09-13 18:04:32,854 [trainer.py] => config: ./exps/dualprompt_cub_B0_Inc10.json
2024-09-13 18:04:32,887 [trainer.py] => prefix:  
2024-09-13 18:04:32,887 [trainer.py] => dataset: cub
2024-09-13 18:04:32,888 [trainer.py] => memory_size: 0
2024-09-13 18:04:32,888 [trainer.py] => memory_per_class: 0
2024-09-13 18:04:32,888 [trainer.py] => fixed_memory: True
2024-09-13 18:04:32,888 [trainer.py] => shuffle: True
2024-09-13 18:04:32,888 [trainer.py] => init_cls: 20
2024-09-13 18:04:32,888 [trainer.py] => increment: 20
2024-09-13 18:04:32,888 [trainer.py] => model_name: dualprompt
2024-09-13 18:04:32,888 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-13 18:04:32,888 [trainer.py] => get_original_backbone: True
2024-09-13 18:04:32,889 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 18:04:32,889 [trainer.py] => seed: 1993
2024-09-13 18:04:32,889 [trainer.py] => tuned_epoch: 20
2024-09-13 18:04:32,889 [trainer.py] => init_lr: 0.001
2024-09-13 18:04:32,889 [trainer.py] => batch_size: 48
2024-09-13 18:04:32,889 [trainer.py] => weight_decay: 0
2024-09-13 18:04:32,889 [trainer.py] => min_lr: 1e-05
2024-09-13 18:04:32,889 [trainer.py] => optimizer: adam
2024-09-13 18:04:32,889 [trainer.py] => scheduler: constant
2024-09-13 18:04:32,890 [trainer.py] => reinit_optimizer: True
2024-09-13 18:04:32,890 [trainer.py] => global_pool: token
2024-09-13 18:04:32,890 [trainer.py] => head_type: token
2024-09-13 18:04:32,890 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-13 18:04:32,890 [trainer.py] => pretrained: True
2024-09-13 18:04:32,890 [trainer.py] => drop: 0.0
2024-09-13 18:04:32,890 [trainer.py] => drop_path: 0.0
2024-09-13 18:04:32,890 [trainer.py] => use_g_prompt: True
2024-09-13 18:04:32,890 [trainer.py] => g_prompt_length: 5
2024-09-13 18:04:32,890 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-13 18:04:32,891 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-13 18:04:32,891 [trainer.py] => use_e_prompt: True
2024-09-13 18:04:32,891 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-13 18:04:32,891 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-13 18:04:32,891 [trainer.py] => prompt_pool: True
2024-09-13 18:04:32,891 [trainer.py] => size: 10
2024-09-13 18:04:32,891 [trainer.py] => length: 5
2024-09-13 18:04:32,891 [trainer.py] => top_k: 1
2024-09-13 18:04:32,891 [trainer.py] => initializer: uniform
2024-09-13 18:04:32,891 [trainer.py] => prompt_key: True
2024-09-13 18:04:32,892 [trainer.py] => prompt_key_init: uniform
2024-09-13 18:04:32,892 [trainer.py] => use_prompt_mask: True
2024-09-13 18:04:32,892 [trainer.py] => shared_prompt_pool: True
2024-09-13 18:04:32,892 [trainer.py] => shared_prompt_key: False
2024-09-13 18:04:32,892 [trainer.py] => batchwise_prompt: True
2024-09-13 18:04:32,892 [trainer.py] => embedding_key: cls
2024-09-13 18:04:32,892 [trainer.py] => predefined_key: 
2024-09-13 18:04:32,892 [trainer.py] => pull_constraint: True
2024-09-13 18:04:32,892 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-13 18:04:32,892 [trainer.py] => same_key_value: False
2024-09-13 18:04:32,951 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 18:04:38,542 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-13 18:04:38,543 [dualprompt.py] => 407,240 model training parameters.
2024-09-13 18:04:38,543 [dualprompt.py] => g_prompt: 15360
2024-09-13 18:04:38,543 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-13 18:04:38,543 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-13 18:04:38,543 [dualprompt.py] => head.weight: 153600
2024-09-13 18:04:38,544 [dualprompt.py] => head.bias: 200
2024-09-13 18:04:38,545 [trainer.py] => All params: 172158352
2024-09-13 18:04:38,546 [trainer.py] => Trainable params: 407240
2024-09-13 18:04:38,546 [dualprompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.421, Train_accy 60.47:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.421, Train_accy 60.47:   5%|▌         | 1/20 [00:08<02:47,  8.83s/it]
Task 0, Epoch 2/20 => Loss 0.345, Train_accy 89.85:   5%|▌         | 1/20 [00:17<02:47,  8.83s/it]
Task 0, Epoch 2/20 => Loss 0.345, Train_accy 89.85:  10%|█         | 2/20 [00:17<02:35,  8.64s/it]
Task 0, Epoch 3/20 => Loss 0.252, Train_accy 93.45:  10%|█         | 2/20 [00:25<02:35,  8.64s/it]
Task 0, Epoch 3/20 => Loss 0.252, Train_accy 93.45:  15%|█▌        | 3/20 [00:25<02:25,  8.55s/it]
Task 0, Epoch 4/20 => Loss 0.229, Train_accy 92.49:  15%|█▌        | 3/20 [00:34<02:25,  8.55s/it]
Task 0, Epoch 4/20 => Loss 0.229, Train_accy 92.49:  20%|██        | 4/20 [00:34<02:16,  8.52s/it]
Task 0, Epoch 5/20 => Loss 0.199, Train_accy 94.71, Test_accy 98.79:  20%|██        | 4/20 [00:44<02:16,  8.52s/it]
Task 0, Epoch 5/20 => Loss 0.199, Train_accy 94.71, Test_accy 98.79:  25%|██▌       | 5/20 [00:44<02:19,  9.27s/it]
Task 0, Epoch 6/20 => Loss 0.187, Train_accy 95.14:  25%|██▌       | 5/20 [00:53<02:19,  9.27s/it]                 
Task 0, Epoch 6/20 => Loss 0.187, Train_accy 95.14:  30%|███       | 6/20 [00:53<02:06,  9.00s/it]
Task 0, Epoch 7/20 => Loss 0.169, Train_accy 94.71:  30%|███       | 6/20 [01:01<02:06,  9.00s/it]
Task 0, Epoch 7/20 => Loss 0.169, Train_accy 94.71:  35%|███▌      | 7/20 [01:01<01:54,  8.82s/it]
Task 0, Epoch 8/20 => Loss 0.163, Train_accy 95.24:  35%|███▌      | 7/20 [01:10<01:54,  8.82s/it]
Task 0, Epoch 8/20 => Loss 0.163, Train_accy 95.24:  40%|████      | 8/20 [01:10<01:44,  8.70s/it]
Task 0, Epoch 9/20 => Loss 0.143, Train_accy 95.98:  40%|████      | 8/20 [01:18<01:44,  8.70s/it]
Task 0, Epoch 9/20 => Loss 0.143, Train_accy 95.98:  45%|████▌     | 9/20 [01:18<01:34,  8.62s/it]
Task 0, Epoch 10/20 => Loss 0.151, Train_accy 95.35, Test_accy 98.79:  45%|████▌     | 9/20 [01:29<01:34,  8.62s/it]
Task 0, Epoch 10/20 => Loss 0.151, Train_accy 95.35, Test_accy 98.79:  50%|█████     | 10/20 [01:29<01:32,  9.24s/it]
Task 0, Epoch 11/20 => Loss 0.140, Train_accy 96.09:  50%|█████     | 10/20 [01:37<01:32,  9.24s/it]                 
Task 0, Epoch 11/20 => Loss 0.140, Train_accy 96.09:  55%|█████▌    | 11/20 [01:37<01:21,  9.01s/it]
Task 0, Epoch 12/20 => Loss 0.121, Train_accy 96.19:  55%|█████▌    | 11/20 [01:46<01:21,  9.01s/it]
Task 0, Epoch 12/20 => Loss 0.121, Train_accy 96.19:  60%|██████    | 12/20 [01:46<01:10,  8.83s/it]
Task 0, Epoch 13/20 => Loss 0.131, Train_accy 95.77:  60%|██████    | 12/20 [01:54<01:10,  8.83s/it]
Task 0, Epoch 13/20 => Loss 0.131, Train_accy 95.77:  65%|██████▌   | 13/20 [01:54<01:01,  8.73s/it]
Task 0, Epoch 14/20 => Loss 0.122, Train_accy 96.19:  65%|██████▌   | 13/20 [02:03<01:01,  8.73s/it]
Task 0, Epoch 14/20 => Loss 0.122, Train_accy 96.19:  70%|███████   | 14/20 [02:03<00:52,  8.67s/it]
Task 0, Epoch 15/20 => Loss 0.109, Train_accy 96.09, Test_accy 98.79:  70%|███████   | 14/20 [02:13<00:52,  8.67s/it]
Task 0, Epoch 15/20 => Loss 0.109, Train_accy 96.09, Test_accy 98.79:  75%|███████▌  | 15/20 [02:13<00:46,  9.22s/it]
Task 0, Epoch 16/20 => Loss 0.108, Train_accy 97.04:  75%|███████▌  | 15/20 [02:22<00:46,  9.22s/it]                 
Task 0, Epoch 16/20 => Loss 0.108, Train_accy 97.04:  80%|████████  | 16/20 [02:22<00:36,  9.02s/it]
Task 0, Epoch 17/20 => Loss 0.129, Train_accy 95.67:  80%|████████  | 16/20 [02:30<00:36,  9.02s/it]
Task 0, Epoch 17/20 => Loss 0.129, Train_accy 95.67:  85%|████████▌ | 17/20 [02:30<00:26,  8.86s/it]
Task 0, Epoch 18/20 => Loss 0.104, Train_accy 96.62:  85%|████████▌ | 17/20 [02:39<00:26,  8.86s/it]
Task 0, Epoch 18/20 => Loss 0.104, Train_accy 96.62:  90%|█████████ | 18/20 [02:39<00:17,  8.77s/it]
Task 0, Epoch 19/20 => Loss 0.117, Train_accy 96.41:  90%|█████████ | 18/20 [02:47<00:17,  8.77s/it]
Task 0, Epoch 19/20 => Loss 0.117, Train_accy 96.41:  95%|█████████▌| 19/20 [02:47<00:08,  8.67s/it]
Task 0, Epoch 20/20 => Loss 0.107, Train_accy 96.51, Test_accy 98.79:  95%|█████████▌| 19/20 [02:58<00:08,  8.67s/it]
Task 0, Epoch 20/20 => Loss 0.107, Train_accy 96.51, Test_accy 98.79: 100%|██████████| 20/20 [02:58<00:00,  9.24s/it]
Task 0, Epoch 20/20 => Loss 0.107, Train_accy 96.51, Test_accy 98.79: 100%|██████████| 20/20 [02:58<00:00,  8.92s/it]2024-09-13 18:07:37,619 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.107, Train_accy 96.51, Test_accy 98.79

2024-09-13 18:07:39,637 [trainer.py] => No NME accuracy.
2024-09-13 18:07:39,638 [trainer.py] => CNN: {'total': 98.79, '00-19': 98.79, 'old': 0, 'new': 98.79}
2024-09-13 18:07:39,638 [trainer.py] => CNN top1 curve: [98.79]
2024-09-13 18:07:39,638 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.79
2024-09-13 18:07:39,638 [trainer.py] => Average Accuracy (CNN): 98.79 

2024-09-13 18:07:39,641 [trainer.py] => All params: 172158352
2024-09-13 18:07:39,643 [trainer.py] => Trainable params: 407240
2024-09-13 18:07:39,644 [dualprompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.316, Train_accy 64.13:   0%|          | 0/20 [00:08<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.316, Train_accy 64.13:   5%|▌         | 1/20 [00:08<02:41,  8.52s/it]
Task 1, Epoch 2/20 => Loss 0.307, Train_accy 91.64:   5%|▌         | 1/20 [00:16<02:41,  8.52s/it]
Task 1, Epoch 2/20 => Loss 0.307, Train_accy 91.64:  10%|█         | 2/20 [00:16<02:32,  8.48s/it]
Task 1, Epoch 3/20 => Loss 0.215, Train_accy 94.18:  10%|█         | 2/20 [00:25<02:32,  8.48s/it]
Task 1, Epoch 3/20 => Loss 0.215, Train_accy 94.18:  15%|█▌        | 3/20 [00:25<02:24,  8.47s/it]
Task 1, Epoch 4/20 => Loss 0.197, Train_accy 93.97:  15%|█▌        | 3/20 [00:33<02:24,  8.47s/it]
Task 1, Epoch 4/20 => Loss 0.197, Train_accy 93.97:  20%|██        | 4/20 [00:33<02:15,  8.49s/it]
Task 1, Epoch 5/20 => Loss 0.159, Train_accy 95.56, Test_accy 92.95:  20%|██        | 4/20 [00:45<02:15,  8.49s/it]
Task 1, Epoch 5/20 => Loss 0.159, Train_accy 95.56, Test_accy 92.95:  25%|██▌       | 5/20 [00:45<02:24,  9.63s/it]
Task 1, Epoch 6/20 => Loss 0.135, Train_accy 95.87:  25%|██▌       | 5/20 [00:54<02:24,  9.63s/it]                 
Task 1, Epoch 6/20 => Loss 0.135, Train_accy 95.87:  30%|███       | 6/20 [00:54<02:09,  9.24s/it]
Task 1, Epoch 7/20 => Loss 0.133, Train_accy 95.56:  30%|███       | 6/20 [01:02<02:09,  9.24s/it]
Task 1, Epoch 7/20 => Loss 0.133, Train_accy 95.56:  35%|███▌      | 7/20 [01:02<01:56,  8.98s/it]
Task 1, Epoch 8/20 => Loss 0.128, Train_accy 96.40:  35%|███▌      | 7/20 [01:11<01:56,  8.98s/it]
Task 1, Epoch 8/20 => Loss 0.128, Train_accy 96.40:  40%|████      | 8/20 [01:11<01:45,  8.82s/it]
Task 1, Epoch 9/20 => Loss 0.147, Train_accy 95.98:  40%|████      | 8/20 [01:19<01:45,  8.82s/it]
Task 1, Epoch 9/20 => Loss 0.147, Train_accy 95.98:  45%|████▌     | 9/20 [01:19<01:35,  8.71s/it]
Task 1, Epoch 10/20 => Loss 0.115, Train_accy 95.87, Test_accy 94.93:  45%|████▌     | 9/20 [01:31<01:35,  8.71s/it]
Task 1, Epoch 10/20 => Loss 0.115, Train_accy 95.87, Test_accy 94.93:  50%|█████     | 10/20 [01:31<01:36,  9.62s/it]
Task 1, Epoch 11/20 => Loss 0.096, Train_accy 97.14:  50%|█████     | 10/20 [01:39<01:36,  9.62s/it]                 
Task 1, Epoch 11/20 => Loss 0.096, Train_accy 97.14:  55%|█████▌    | 11/20 [01:39<01:23,  9.30s/it]
Task 1, Epoch 12/20 => Loss 0.109, Train_accy 96.30:  55%|█████▌    | 11/20 [01:48<01:23,  9.30s/it]
Task 1, Epoch 12/20 => Loss 0.109, Train_accy 96.30:  60%|██████    | 12/20 [01:48<01:12,  9.07s/it]
Task 1, Epoch 13/20 => Loss 0.089, Train_accy 96.72:  60%|██████    | 12/20 [01:56<01:12,  9.07s/it]
Task 1, Epoch 13/20 => Loss 0.089, Train_accy 96.72:  65%|██████▌   | 13/20 [01:56<01:02,  8.89s/it]
Task 1, Epoch 14/20 => Loss 0.104, Train_accy 96.30:  65%|██████▌   | 13/20 [02:05<01:02,  8.89s/it]
Task 1, Epoch 14/20 => Loss 0.104, Train_accy 96.30:  70%|███████   | 14/20 [02:05<00:52,  8.80s/it]
Task 1, Epoch 15/20 => Loss 0.129, Train_accy 95.66, Test_accy 95.59:  70%|███████   | 14/20 [02:16<00:52,  8.80s/it]
Task 1, Epoch 15/20 => Loss 0.129, Train_accy 95.66, Test_accy 95.59:  75%|███████▌  | 15/20 [02:16<00:48,  9.66s/it]
Task 1, Epoch 16/20 => Loss 0.080, Train_accy 97.78:  75%|███████▌  | 15/20 [02:25<00:48,  9.66s/it]                 
Task 1, Epoch 16/20 => Loss 0.080, Train_accy 97.78:  80%|████████  | 16/20 [02:25<00:37,  9.30s/it]
Task 1, Epoch 17/20 => Loss 0.066, Train_accy 97.67:  80%|████████  | 16/20 [02:34<00:37,  9.30s/it]
Task 1, Epoch 17/20 => Loss 0.066, Train_accy 97.67:  85%|████████▌ | 17/20 [02:34<00:27,  9.10s/it]
Task 1, Epoch 18/20 => Loss 0.104, Train_accy 97.04:  85%|████████▌ | 17/20 [02:42<00:27,  9.10s/it]
Task 1, Epoch 18/20 => Loss 0.104, Train_accy 97.04:  90%|█████████ | 18/20 [02:42<00:17,  8.90s/it]
Task 1, Epoch 19/20 => Loss 0.076, Train_accy 97.25:  90%|█████████ | 18/20 [02:50<00:17,  8.90s/it]
Task 1, Epoch 19/20 => Loss 0.076, Train_accy 97.25:  95%|█████████▌| 19/20 [02:50<00:08,  8.77s/it]
Task 1, Epoch 20/20 => Loss 0.101, Train_accy 96.19, Test_accy 96.04:  95%|█████████▌| 19/20 [03:02<00:08,  8.77s/it]
Task 1, Epoch 20/20 => Loss 0.101, Train_accy 96.19, Test_accy 96.04: 100%|██████████| 20/20 [03:02<00:00,  9.66s/it]
Task 1, Epoch 20/20 => Loss 0.101, Train_accy 96.19, Test_accy 96.04: 100%|██████████| 20/20 [03:02<00:00,  9.13s/it]2024-09-13 18:10:42,351 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.101, Train_accy 96.19, Test_accy 96.04

2024-09-13 18:10:45,530 [trainer.py] => No NME accuracy.
2024-09-13 18:10:45,530 [trainer.py] => CNN: {'total': 96.04, '00-19': 97.17, '20-39': 94.69, 'old': 97.17, 'new': 94.69}
2024-09-13 18:10:45,530 [trainer.py] => CNN top1 curve: [98.79, 96.04]
2024-09-13 18:10:45,530 [trainer.py] => CNN top5 curve: [100.0, 99.34]

Average Accuracy (CNN): 97.42
2024-09-13 18:10:45,530 [trainer.py] => Average Accuracy (CNN): 97.42 

2024-09-13 18:10:45,532 [trainer.py] => All params: 172158352
2024-09-13 18:10:45,533 [trainer.py] => Trainable params: 407240
2024-09-13 18:10:45,533 [dualprompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.359, Train_accy 64.79:   0%|          | 0/20 [00:08<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.359, Train_accy 64.79:   5%|▌         | 1/20 [00:08<02:41,  8.53s/it]
Task 2, Epoch 2/20 => Loss 0.320, Train_accy 90.77:   5%|▌         | 1/20 [00:16<02:41,  8.53s/it]
Task 2, Epoch 2/20 => Loss 0.320, Train_accy 90.77:  10%|█         | 2/20 [00:16<02:32,  8.48s/it]
Task 2, Epoch 3/20 => Loss 0.223, Train_accy 93.32:  10%|█         | 2/20 [00:25<02:32,  8.48s/it]
Task 2, Epoch 3/20 => Loss 0.223, Train_accy 93.32:  15%|█▌        | 3/20 [00:25<02:23,  8.47s/it]
Task 2, Epoch 4/20 => Loss 0.207, Train_accy 93.64:  15%|█▌        | 3/20 [00:33<02:23,  8.47s/it]
Task 2, Epoch 4/20 => Loss 0.207, Train_accy 93.64:  20%|██        | 4/20 [00:33<02:16,  8.51s/it]
Task 2, Epoch 5/20 => Loss 0.168, Train_accy 95.23, Test_accy 89.43:  20%|██        | 4/20 [00:46<02:16,  8.51s/it]
Task 2, Epoch 5/20 => Loss 0.168, Train_accy 95.23, Test_accy 89.43:  25%|██▌       | 5/20 [00:46<02:31, 10.08s/it]
Task 2, Epoch 6/20 => Loss 0.200, Train_accy 93.85:  25%|██▌       | 5/20 [00:55<02:31, 10.08s/it]                 
Task 2, Epoch 6/20 => Loss 0.200, Train_accy 93.85:  30%|███       | 6/20 [00:55<02:13,  9.54s/it]
Task 2, Epoch 7/20 => Loss 0.173, Train_accy 95.44:  30%|███       | 6/20 [01:03<02:13,  9.54s/it]
Task 2, Epoch 7/20 => Loss 0.173, Train_accy 95.44:  35%|███▌      | 7/20 [01:03<01:59,  9.19s/it]
Task 2, Epoch 8/20 => Loss 0.139, Train_accy 95.76:  35%|███▌      | 7/20 [01:12<01:59,  9.19s/it]
Task 2, Epoch 8/20 => Loss 0.139, Train_accy 95.76:  40%|████      | 8/20 [01:12<01:47,  8.97s/it]
Task 2, Epoch 9/20 => Loss 0.162, Train_accy 94.91:  40%|████      | 8/20 [01:20<01:47,  8.97s/it]
Task 2, Epoch 9/20 => Loss 0.162, Train_accy 94.91:  45%|████▌     | 9/20 [01:20<01:36,  8.82s/it]
Task 2, Epoch 10/20 => Loss 0.129, Train_accy 95.76, Test_accy 91.52:  45%|████▌     | 9/20 [01:33<01:36,  8.82s/it]
Task 2, Epoch 10/20 => Loss 0.129, Train_accy 95.76, Test_accy 91.52:  50%|█████     | 10/20 [01:33<01:40, 10.05s/it]
Task 2, Epoch 11/20 => Loss 0.098, Train_accy 97.03:  50%|█████     | 10/20 [01:42<01:40, 10.05s/it]                 
Task 2, Epoch 11/20 => Loss 0.098, Train_accy 97.03:  55%|█████▌    | 11/20 [01:42<01:26,  9.57s/it]
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 95.97:  55%|█████▌    | 11/20 [01:50<01:26,  9.57s/it]
Task 2, Epoch 12/20 => Loss 0.133, Train_accy 95.97:  60%|██████    | 12/20 [01:50<01:13,  9.23s/it]
Task 2, Epoch 13/20 => Loss 0.151, Train_accy 95.44:  60%|██████    | 12/20 [01:58<01:13,  9.23s/it]
Task 2, Epoch 13/20 => Loss 0.151, Train_accy 95.44:  65%|██████▌   | 13/20 [01:58<01:02,  8.99s/it]
Task 2, Epoch 14/20 => Loss 0.107, Train_accy 96.39:  65%|██████▌   | 13/20 [02:07<01:02,  8.99s/it]
Task 2, Epoch 14/20 => Loss 0.107, Train_accy 96.39:  70%|███████   | 14/20 [02:07<00:52,  8.81s/it]
Task 2, Epoch 15/20 => Loss 0.160, Train_accy 94.91, Test_accy 92.41:  70%|███████   | 14/20 [02:20<00:52,  8.81s/it]
Task 2, Epoch 15/20 => Loss 0.160, Train_accy 94.91, Test_accy 92.41:  75%|███████▌  | 15/20 [02:20<00:50, 10.02s/it]
Task 2, Epoch 16/20 => Loss 0.129, Train_accy 96.39:  75%|███████▌  | 15/20 [02:28<00:50, 10.02s/it]                 
Task 2, Epoch 16/20 => Loss 0.129, Train_accy 96.39:  80%|████████  | 16/20 [02:28<00:38,  9.55s/it]
Task 2, Epoch 17/20 => Loss 0.103, Train_accy 96.50:  80%|████████  | 16/20 [02:37<00:38,  9.55s/it]
Task 2, Epoch 17/20 => Loss 0.103, Train_accy 96.50:  85%|████████▌ | 17/20 [02:37<00:27,  9.25s/it]
Task 2, Epoch 18/20 => Loss 0.101, Train_accy 96.71:  85%|████████▌ | 17/20 [02:45<00:27,  9.25s/it]
Task 2, Epoch 18/20 => Loss 0.101, Train_accy 96.71:  90%|█████████ | 18/20 [02:45<00:18,  9.03s/it]
Task 2, Epoch 19/20 => Loss 0.087, Train_accy 96.82:  90%|█████████ | 18/20 [02:54<00:18,  9.03s/it]
Task 2, Epoch 19/20 => Loss 0.087, Train_accy 96.82:  95%|█████████▌| 19/20 [02:54<00:08,  8.85s/it]
Task 2, Epoch 20/20 => Loss 0.103, Train_accy 96.39, Test_accy 93.45:  95%|█████████▌| 19/20 [03:07<00:08,  8.85s/it]
Task 2, Epoch 20/20 => Loss 0.103, Train_accy 96.39, Test_accy 93.45: 100%|██████████| 20/20 [03:07<00:00, 10.11s/it]
Task 2, Epoch 20/20 => Loss 0.103, Train_accy 96.39, Test_accy 93.45: 100%|██████████| 20/20 [03:07<00:00,  9.36s/it]2024-09-13 18:13:52,756 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.103, Train_accy 96.39, Test_accy 93.45

2024-09-13 18:13:57,143 [trainer.py] => No NME accuracy.
2024-09-13 18:13:57,143 [trainer.py] => CNN: {'total': 93.45, '00-19': 95.95, '20-39': 93.72, '40-59': 90.37, 'old': 94.93, 'new': 90.37}
2024-09-13 18:13:57,143 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45]
2024-09-13 18:13:57,144 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11]

Average Accuracy (CNN): 96.09
2024-09-13 18:13:57,144 [trainer.py] => Average Accuracy (CNN): 96.09 

2024-09-13 18:13:57,146 [trainer.py] => All params: 172158352
2024-09-13 18:13:57,149 [trainer.py] => Trainable params: 407240
2024-09-13 18:13:57,149 [dualprompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.274, Train_accy 65.86:   0%|          | 0/20 [00:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.274, Train_accy 65.86:   5%|▌         | 1/20 [00:08<02:43,  8.59s/it]
Task 3, Epoch 2/20 => Loss 0.269, Train_accy 91.97:   5%|▌         | 1/20 [00:17<02:43,  8.59s/it]
Task 3, Epoch 2/20 => Loss 0.269, Train_accy 91.97:  10%|█         | 2/20 [00:17<02:34,  8.58s/it]
Task 3, Epoch 3/20 => Loss 0.222, Train_accy 92.81:  10%|█         | 2/20 [00:25<02:34,  8.58s/it]
Task 3, Epoch 3/20 => Loss 0.222, Train_accy 92.81:  15%|█▌        | 3/20 [00:25<02:26,  8.61s/it]
Task 3, Epoch 4/20 => Loss 0.167, Train_accy 95.03:  15%|█▌        | 3/20 [00:34<02:26,  8.61s/it]
Task 3, Epoch 4/20 => Loss 0.167, Train_accy 95.03:  20%|██        | 4/20 [00:34<02:17,  8.57s/it]
Task 3, Epoch 5/20 => Loss 0.193, Train_accy 93.66, Test_accy 85.53:  20%|██        | 4/20 [00:48<02:17,  8.57s/it]
Task 3, Epoch 5/20 => Loss 0.193, Train_accy 93.66, Test_accy 85.53:  25%|██▌       | 5/20 [00:48<02:40, 10.69s/it]
Task 3, Epoch 6/20 => Loss 0.172, Train_accy 94.50:  25%|██▌       | 5/20 [00:57<02:40, 10.69s/it]                 
Task 3, Epoch 6/20 => Loss 0.172, Train_accy 94.50:  30%|███       | 6/20 [00:57<02:19,  9.93s/it]
Task 3, Epoch 7/20 => Loss 0.169, Train_accy 94.93:  30%|███       | 6/20 [01:05<02:19,  9.93s/it]
Task 3, Epoch 7/20 => Loss 0.169, Train_accy 94.93:  35%|███▌      | 7/20 [01:05<02:03,  9.48s/it]
Task 3, Epoch 8/20 => Loss 0.130, Train_accy 95.88:  35%|███▌      | 7/20 [01:14<02:03,  9.48s/it]
Task 3, Epoch 8/20 => Loss 0.130, Train_accy 95.88:  40%|████      | 8/20 [01:14<01:49,  9.17s/it]
Task 3, Epoch 9/20 => Loss 0.144, Train_accy 95.35:  40%|████      | 8/20 [01:22<01:49,  9.17s/it]
Task 3, Epoch 9/20 => Loss 0.144, Train_accy 95.35:  45%|████▌     | 9/20 [01:22<01:38,  8.96s/it]
Task 3, Epoch 10/20 => Loss 0.136, Train_accy 95.56, Test_accy 87.70:  45%|████▌     | 9/20 [01:37<01:38,  8.96s/it]
Task 3, Epoch 10/20 => Loss 0.136, Train_accy 95.56, Test_accy 87.70:  50%|█████     | 10/20 [01:37<01:45, 10.59s/it]
Task 3, Epoch 11/20 => Loss 0.101, Train_accy 96.51:  50%|█████     | 10/20 [01:45<01:45, 10.59s/it]                 
Task 3, Epoch 11/20 => Loss 0.101, Train_accy 96.51:  55%|█████▌    | 11/20 [01:45<01:29,  9.95s/it]
Task 3, Epoch 12/20 => Loss 0.131, Train_accy 95.45:  55%|█████▌    | 11/20 [01:54<01:29,  9.95s/it]
Task 3, Epoch 12/20 => Loss 0.131, Train_accy 95.45:  60%|██████    | 12/20 [01:54<01:16,  9.54s/it]
Task 3, Epoch 13/20 => Loss 0.112, Train_accy 95.98:  60%|██████    | 12/20 [02:02<01:16,  9.54s/it]
Task 3, Epoch 13/20 => Loss 0.112, Train_accy 95.98:  65%|██████▌   | 13/20 [02:02<01:04,  9.21s/it]
Task 3, Epoch 14/20 => Loss 0.106, Train_accy 96.09:  65%|██████▌   | 13/20 [02:11<01:04,  9.21s/it]
Task 3, Epoch 14/20 => Loss 0.106, Train_accy 96.09:  70%|███████   | 14/20 [02:11<00:54,  9.00s/it]
Task 3, Epoch 15/20 => Loss 0.129, Train_accy 95.24, Test_accy 88.57:  70%|███████   | 14/20 [02:25<00:54,  9.00s/it]
Task 3, Epoch 15/20 => Loss 0.129, Train_accy 95.24, Test_accy 88.57:  75%|███████▌  | 15/20 [02:25<00:52, 10.59s/it]
Task 3, Epoch 16/20 => Loss 0.097, Train_accy 96.51:  75%|███████▌  | 15/20 [02:33<00:52, 10.59s/it]                 
Task 3, Epoch 16/20 => Loss 0.097, Train_accy 96.51:  80%|████████  | 16/20 [02:33<00:39,  9.95s/it]
Task 3, Epoch 17/20 => Loss 0.109, Train_accy 96.19:  80%|████████  | 16/20 [02:42<00:39,  9.95s/it]
Task 3, Epoch 17/20 => Loss 0.109, Train_accy 96.19:  85%|████████▌ | 17/20 [02:42<00:28,  9.59s/it]
Task 3, Epoch 18/20 => Loss 0.086, Train_accy 96.83:  85%|████████▌ | 17/20 [02:51<00:28,  9.59s/it]
Task 3, Epoch 18/20 => Loss 0.086, Train_accy 96.83:  90%|█████████ | 18/20 [02:51<00:18,  9.28s/it]
Task 3, Epoch 19/20 => Loss 0.085, Train_accy 96.72:  90%|█████████ | 18/20 [02:59<00:18,  9.28s/it]
Task 3, Epoch 19/20 => Loss 0.085, Train_accy 96.72:  95%|█████████▌| 19/20 [02:59<00:09,  9.03s/it]
Task 3, Epoch 20/20 => Loss 0.099, Train_accy 96.62, Test_accy 88.25:  95%|█████████▌| 19/20 [03:13<00:09,  9.03s/it]
Task 3, Epoch 20/20 => Loss 0.099, Train_accy 96.62, Test_accy 88.25: 100%|██████████| 20/20 [03:13<00:00, 10.63s/it]
Task 3, Epoch 20/20 => Loss 0.099, Train_accy 96.62, Test_accy 88.25: 100%|██████████| 20/20 [03:13<00:00,  9.70s/it]2024-09-13 18:17:11,131 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.099, Train_accy 96.62, Test_accy 88.25

2024-09-13 18:17:16,838 [trainer.py] => No NME accuracy.
2024-09-13 18:17:16,838 [trainer.py] => CNN: {'total': 88.25, '00-19': 91.9, '20-39': 91.79, '40-59': 88.53, '60-79': 81.38, 'old': 90.77, 'new': 81.38}
2024-09-13 18:17:16,838 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45, 88.25]
2024-09-13 18:17:16,838 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11, 99.02]

Average Accuracy (CNN): 94.13
2024-09-13 18:17:16,838 [trainer.py] => Average Accuracy (CNN): 94.13 

2024-09-13 18:17:16,840 [trainer.py] => All params: 172158352
2024-09-13 18:17:16,842 [trainer.py] => Trainable params: 407240
2024-09-13 18:17:16,842 [dualprompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.387, Train_accy 63.57:   0%|          | 0/20 [00:08<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.387, Train_accy 63.57:   5%|▌         | 1/20 [00:08<02:37,  8.28s/it]
Task 4, Epoch 2/20 => Loss 0.361, Train_accy 87.75:   5%|▌         | 1/20 [00:16<02:37,  8.28s/it]
Task 4, Epoch 2/20 => Loss 0.361, Train_accy 87.75:  10%|█         | 2/20 [00:16<02:28,  8.23s/it]
Task 4, Epoch 3/20 => Loss 0.260, Train_accy 90.70:  10%|█         | 2/20 [00:24<02:28,  8.23s/it]
Task 4, Epoch 3/20 => Loss 0.260, Train_accy 90.70:  15%|█▌        | 3/20 [00:24<02:19,  8.22s/it]
Task 4, Epoch 4/20 => Loss 0.228, Train_accy 91.79:  15%|█▌        | 3/20 [00:33<02:19,  8.22s/it]
Task 4, Epoch 4/20 => Loss 0.228, Train_accy 91.79:  20%|██        | 4/20 [00:33<02:12,  8.26s/it]
Task 4, Epoch 5/20 => Loss 0.168, Train_accy 94.42, Test_accy 81.57:  20%|██        | 4/20 [00:48<02:12,  8.26s/it]
Task 4, Epoch 5/20 => Loss 0.168, Train_accy 94.42, Test_accy 81.57:  25%|██▌       | 5/20 [00:48<02:43, 10.87s/it]
Task 4, Epoch 6/20 => Loss 0.153, Train_accy 93.54:  25%|██▌       | 5/20 [00:56<02:43, 10.87s/it]                 
Task 4, Epoch 6/20 => Loss 0.153, Train_accy 93.54:  30%|███       | 6/20 [00:56<02:19,  9.99s/it]
Task 4, Epoch 7/20 => Loss 0.159, Train_accy 94.86:  30%|███       | 6/20 [01:04<02:19,  9.99s/it]
Task 4, Epoch 7/20 => Loss 0.159, Train_accy 94.86:  35%|███▌      | 7/20 [01:04<02:02,  9.40s/it]
Task 4, Epoch 8/20 => Loss 0.186, Train_accy 93.33:  35%|███▌      | 7/20 [01:13<02:02,  9.40s/it]
Task 4, Epoch 8/20 => Loss 0.186, Train_accy 93.33:  40%|████      | 8/20 [01:13<01:48,  9.04s/it]
Task 4, Epoch 9/20 => Loss 0.165, Train_accy 94.75:  40%|████      | 8/20 [01:21<01:48,  9.04s/it]
Task 4, Epoch 9/20 => Loss 0.165, Train_accy 94.75:  45%|████▌     | 9/20 [01:21<01:36,  8.79s/it]
Task 4, Epoch 10/20 => Loss 0.156, Train_accy 94.64, Test_accy 83.33:  45%|████▌     | 9/20 [01:37<01:36,  8.79s/it]
Task 4, Epoch 10/20 => Loss 0.156, Train_accy 94.64, Test_accy 83.33:  50%|█████     | 10/20 [01:37<01:49, 10.93s/it]
Task 4, Epoch 11/20 => Loss 0.128, Train_accy 95.73:  50%|█████     | 10/20 [01:45<01:49, 10.93s/it]                 
Task 4, Epoch 11/20 => Loss 0.128, Train_accy 95.73:  55%|█████▌    | 11/20 [01:45<01:30, 10.11s/it]
Task 4, Epoch 12/20 => Loss 0.144, Train_accy 94.42:  55%|█████▌    | 11/20 [01:53<01:30, 10.11s/it]
Task 4, Epoch 12/20 => Loss 0.144, Train_accy 94.42:  60%|██████    | 12/20 [01:53<01:16,  9.54s/it]
Task 4, Epoch 13/20 => Loss 0.136, Train_accy 95.84:  60%|██████    | 12/20 [02:02<01:16,  9.54s/it]
Task 4, Epoch 13/20 => Loss 0.136, Train_accy 95.84:  65%|██████▌   | 13/20 [02:02<01:04,  9.17s/it]
Task 4, Epoch 14/20 => Loss 0.181, Train_accy 94.86:  65%|██████▌   | 13/20 [02:10<01:04,  9.17s/it]
Task 4, Epoch 14/20 => Loss 0.181, Train_accy 94.86:  70%|███████   | 14/20 [02:10<00:53,  8.88s/it]
Task 4, Epoch 15/20 => Loss 0.127, Train_accy 95.19, Test_accy 84.51:  70%|███████   | 14/20 [02:25<00:53,  8.88s/it]
Task 4, Epoch 15/20 => Loss 0.127, Train_accy 95.19, Test_accy 84.51:  75%|███████▌  | 15/20 [02:25<00:54, 10.87s/it]
Task 4, Epoch 16/20 => Loss 0.134, Train_accy 95.19:  75%|███████▌  | 15/20 [02:33<00:54, 10.87s/it]                 
Task 4, Epoch 16/20 => Loss 0.134, Train_accy 95.19:  80%|████████  | 16/20 [02:33<00:40, 10.05s/it]
Task 4, Epoch 17/20 => Loss 0.106, Train_accy 96.72:  80%|████████  | 16/20 [02:42<00:40, 10.05s/it]
Task 4, Epoch 17/20 => Loss 0.106, Train_accy 96.72:  85%|████████▌ | 17/20 [02:42<00:28,  9.48s/it]
Task 4, Epoch 18/20 => Loss 0.119, Train_accy 95.51:  85%|████████▌ | 17/20 [02:50<00:28,  9.48s/it]
Task 4, Epoch 18/20 => Loss 0.119, Train_accy 95.51:  90%|█████████ | 18/20 [02:50<00:18,  9.10s/it]
Task 4, Epoch 19/20 => Loss 0.119, Train_accy 95.08:  90%|█████████ | 18/20 [02:58<00:18,  9.10s/it]
Task 4, Epoch 19/20 => Loss 0.119, Train_accy 95.08:  95%|█████████▌| 19/20 [02:58<00:08,  8.85s/it]
Task 4, Epoch 20/20 => Loss 0.143, Train_accy 95.08, Test_accy 84.76:  95%|█████████▌| 19/20 [03:13<00:08,  8.85s/it]
Task 4, Epoch 20/20 => Loss 0.143, Train_accy 95.08, Test_accy 84.76: 100%|██████████| 20/20 [03:13<00:00, 10.85s/it]
Task 4, Epoch 20/20 => Loss 0.143, Train_accy 95.08, Test_accy 84.76: 100%|██████████| 20/20 [03:13<00:00,  9.70s/it]2024-09-13 18:20:30,842 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.143, Train_accy 95.08, Test_accy 84.76

2024-09-13 18:20:38,107 [trainer.py] => No NME accuracy.
2024-09-13 18:20:38,108 [trainer.py] => CNN: {'total': 84.76, '00-19': 91.09, '20-39': 92.75, '40-59': 88.53, '60-79': 80.16, '80-99': 73.98, 'old': 87.92, 'new': 73.98}
2024-09-13 18:20:38,108 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45, 88.25, 84.76]
2024-09-13 18:20:38,108 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11, 99.02, 99.24]

Average Accuracy (CNN): 92.26
2024-09-13 18:20:38,108 [trainer.py] => Average Accuracy (CNN): 92.26 

2024-09-13 18:20:38,110 [trainer.py] => All params: 172158352
2024-09-13 18:20:38,112 [trainer.py] => Trainable params: 407240
2024-09-13 18:20:38,112 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.163, Train_accy 69.12:   0%|          | 0/20 [00:08<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.163, Train_accy 69.12:   5%|▌         | 1/20 [00:08<02:41,  8.51s/it]
Task 5, Epoch 2/20 => Loss 0.260, Train_accy 92.65:   5%|▌         | 1/20 [00:17<02:41,  8.51s/it]
Task 5, Epoch 2/20 => Loss 0.260, Train_accy 92.65:  10%|█         | 2/20 [00:17<02:33,  8.52s/it]
Task 5, Epoch 3/20 => Loss 0.159, Train_accy 95.69:  10%|█         | 2/20 [00:25<02:33,  8.52s/it]
Task 5, Epoch 3/20 => Loss 0.159, Train_accy 95.69:  15%|█▌        | 3/20 [00:25<02:24,  8.53s/it]
Task 5, Epoch 4/20 => Loss 0.137, Train_accy 95.59:  15%|█▌        | 3/20 [00:34<02:24,  8.53s/it]
Task 5, Epoch 4/20 => Loss 0.137, Train_accy 95.59:  20%|██        | 4/20 [00:34<02:17,  8.58s/it]
Task 5, Epoch 5/20 => Loss 0.132, Train_accy 96.53, Test_accy 79.45:  20%|██        | 4/20 [00:51<02:17,  8.58s/it]
Task 5, Epoch 5/20 => Loss 0.132, Train_accy 96.53, Test_accy 79.45:  25%|██▌       | 5/20 [00:51<02:55, 11.73s/it]
Task 5, Epoch 6/20 => Loss 0.103, Train_accy 96.85:  25%|██▌       | 5/20 [01:00<02:55, 11.73s/it]                 
Task 5, Epoch 6/20 => Loss 0.103, Train_accy 96.85:  30%|███       | 6/20 [01:00<02:30, 10.72s/it]
Task 5, Epoch 7/20 => Loss 0.118, Train_accy 96.22:  30%|███       | 6/20 [01:08<02:30, 10.72s/it]
Task 5, Epoch 7/20 => Loss 0.118, Train_accy 96.22:  35%|███▌      | 7/20 [01:08<02:10, 10.05s/it]
Task 5, Epoch 8/20 => Loss 0.143, Train_accy 95.69:  35%|███▌      | 7/20 [01:17<02:10, 10.05s/it]
Task 5, Epoch 8/20 => Loss 0.143, Train_accy 95.69:  40%|████      | 8/20 [01:17<01:55,  9.63s/it]
Task 5, Epoch 9/20 => Loss 0.129, Train_accy 96.11:  40%|████      | 8/20 [01:26<01:55,  9.63s/it]
Task 5, Epoch 9/20 => Loss 0.129, Train_accy 96.11:  45%|████▌     | 9/20 [01:26<01:42,  9.31s/it]
Task 5, Epoch 10/20 => Loss 0.105, Train_accy 96.53, Test_accy 80.08:  45%|████▌     | 9/20 [01:43<01:42,  9.31s/it]
Task 5, Epoch 10/20 => Loss 0.105, Train_accy 96.53, Test_accy 80.08:  50%|█████     | 10/20 [01:43<01:56, 11.68s/it]
Task 5, Epoch 11/20 => Loss 0.094, Train_accy 96.74:  50%|█████     | 10/20 [01:51<01:56, 11.68s/it]                 
Task 5, Epoch 11/20 => Loss 0.094, Train_accy 96.74:  55%|█████▌    | 11/20 [01:51<01:36, 10.73s/it]
Task 5, Epoch 12/20 => Loss 0.099, Train_accy 96.22:  55%|█████▌    | 11/20 [02:00<01:36, 10.73s/it]
Task 5, Epoch 12/20 => Loss 0.099, Train_accy 96.22:  60%|██████    | 12/20 [02:00<01:20, 10.04s/it]
Task 5, Epoch 13/20 => Loss 0.100, Train_accy 96.32:  60%|██████    | 12/20 [02:08<01:20, 10.04s/it]
Task 5, Epoch 13/20 => Loss 0.100, Train_accy 96.32:  65%|██████▌   | 13/20 [02:08<01:07,  9.58s/it]
Task 5, Epoch 14/20 => Loss 0.077, Train_accy 96.74:  65%|██████▌   | 13/20 [02:17<01:07,  9.58s/it]
Task 5, Epoch 14/20 => Loss 0.077, Train_accy 96.74:  70%|███████   | 14/20 [02:17<00:55,  9.29s/it]
Task 5, Epoch 15/20 => Loss 0.111, Train_accy 95.80, Test_accy 80.44:  70%|███████   | 14/20 [02:34<00:55,  9.29s/it]
Task 5, Epoch 15/20 => Loss 0.111, Train_accy 95.80, Test_accy 80.44:  75%|███████▌  | 15/20 [02:34<00:58, 11.62s/it]
Task 5, Epoch 16/20 => Loss 0.088, Train_accy 96.85:  75%|███████▌  | 15/20 [02:42<00:58, 11.62s/it]                 
Task 5, Epoch 16/20 => Loss 0.088, Train_accy 96.85:  80%|████████  | 16/20 [02:43<00:42, 10.68s/it]
Task 5, Epoch 17/20 => Loss 0.120, Train_accy 95.69:  80%|████████  | 16/20 [02:51<00:42, 10.68s/it]
Task 5, Epoch 17/20 => Loss 0.120, Train_accy 95.69:  85%|████████▌ | 17/20 [02:51<00:30, 10.05s/it]
Task 5, Epoch 18/20 => Loss 0.057, Train_accy 98.11:  85%|████████▌ | 17/20 [03:00<00:30, 10.05s/it]
Task 5, Epoch 18/20 => Loss 0.057, Train_accy 98.11:  90%|█████████ | 18/20 [03:00<00:19,  9.62s/it]
Task 5, Epoch 19/20 => Loss 0.067, Train_accy 97.27:  90%|█████████ | 18/20 [03:08<00:19,  9.62s/it]
Task 5, Epoch 19/20 => Loss 0.067, Train_accy 97.27:  95%|█████████▌| 19/20 [03:08<00:09,  9.32s/it]
Task 5, Epoch 20/20 => Loss 0.098, Train_accy 96.74, Test_accy 80.86:  95%|█████████▌| 19/20 [03:25<00:09,  9.32s/it]
Task 5, Epoch 20/20 => Loss 0.098, Train_accy 96.74, Test_accy 80.86: 100%|██████████| 20/20 [03:25<00:00, 11.63s/it]
Task 5, Epoch 20/20 => Loss 0.098, Train_accy 96.74, Test_accy 80.86: 100%|██████████| 20/20 [03:25<00:00, 10.29s/it]2024-09-13 18:24:03,957 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.098, Train_accy 96.74, Test_accy 80.86

2024-09-13 18:24:12,516 [trainer.py] => No NME accuracy.
2024-09-13 18:24:12,517 [trainer.py] => CNN: {'total': 80.86, '00-19': 89.47, '20-39': 92.27, '40-59': 87.16, '60-79': 77.73, '80-99': 72.86, '100-119': 67.98, 'old': 83.33, 'new': 67.98}
2024-09-13 18:24:12,517 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45, 88.25, 84.76, 80.86]
2024-09-13 18:24:12,517 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11, 99.02, 99.24, 98.94]

Average Accuracy (CNN): 90.36
2024-09-13 18:24:12,517 [trainer.py] => Average Accuracy (CNN): 90.36 

2024-09-13 18:24:12,520 [trainer.py] => All params: 172158352
2024-09-13 18:24:12,522 [trainer.py] => Trainable params: 407240
2024-09-13 18:24:12,523 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.489, Train_accy 58.39:   0%|          | 0/20 [00:08<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.489, Train_accy 58.39:   5%|▌         | 1/20 [00:08<02:42,  8.55s/it]
Task 6, Epoch 2/20 => Loss 0.462, Train_accy 85.12:   5%|▌         | 1/20 [00:17<02:42,  8.55s/it]
Task 6, Epoch 2/20 => Loss 0.462, Train_accy 85.12:  10%|█         | 2/20 [00:17<02:34,  8.59s/it]
Task 6, Epoch 3/20 => Loss 0.301, Train_accy 89.20:  10%|█         | 2/20 [00:25<02:34,  8.59s/it]
Task 6, Epoch 3/20 => Loss 0.301, Train_accy 89.20:  15%|█▌        | 3/20 [00:25<02:26,  8.59s/it]
Task 6, Epoch 4/20 => Loss 0.300, Train_accy 89.62:  15%|█▌        | 3/20 [00:34<02:26,  8.59s/it]
Task 6, Epoch 4/20 => Loss 0.300, Train_accy 89.62:  20%|██        | 4/20 [00:34<02:17,  8.58s/it]
Task 6, Epoch 5/20 => Loss 0.247, Train_accy 92.03, Test_accy 76.97:  20%|██        | 4/20 [00:52<02:17,  8.58s/it]
Task 6, Epoch 5/20 => Loss 0.247, Train_accy 92.03, Test_accy 76.97:  25%|██▌       | 5/20 [00:52<03:01, 12.13s/it]
Task 6, Epoch 6/20 => Loss 0.237, Train_accy 92.35:  25%|██▌       | 5/20 [01:01<03:01, 12.13s/it]                 
Task 6, Epoch 6/20 => Loss 0.237, Train_accy 92.35:  30%|███       | 6/20 [01:01<02:33, 10.95s/it]
Task 6, Epoch 7/20 => Loss 0.224, Train_accy 92.77:  30%|███       | 6/20 [01:09<02:33, 10.95s/it]
Task 6, Epoch 7/20 => Loss 0.224, Train_accy 92.77:  35%|███▌      | 7/20 [01:09<02:12, 10.15s/it]
Task 6, Epoch 8/20 => Loss 0.235, Train_accy 91.93:  35%|███▌      | 7/20 [01:18<02:12, 10.15s/it]
Task 6, Epoch 8/20 => Loss 0.235, Train_accy 91.93:  40%|████      | 8/20 [01:18<01:55,  9.66s/it]
Task 6, Epoch 9/20 => Loss 0.174, Train_accy 94.55:  40%|████      | 8/20 [01:27<01:55,  9.66s/it]
Task 6, Epoch 9/20 => Loss 0.174, Train_accy 94.55:  45%|████▌     | 9/20 [01:27<01:42,  9.30s/it]
Task 6, Epoch 10/20 => Loss 0.173, Train_accy 94.03, Test_accy 77.88:  45%|████▌     | 9/20 [01:45<01:42,  9.30s/it]
Task 6, Epoch 10/20 => Loss 0.173, Train_accy 94.03, Test_accy 77.88:  50%|█████     | 10/20 [01:45<02:01, 12.14s/it]
Task 6, Epoch 11/20 => Loss 0.167, Train_accy 94.65:  50%|█████     | 10/20 [01:54<02:01, 12.14s/it]                 
Task 6, Epoch 11/20 => Loss 0.167, Train_accy 94.65:  55%|█████▌    | 11/20 [01:54<01:39, 11.03s/it]
Task 6, Epoch 12/20 => Loss 0.181, Train_accy 94.34:  55%|█████▌    | 11/20 [02:02<01:39, 11.03s/it]
Task 6, Epoch 12/20 => Loss 0.181, Train_accy 94.34:  60%|██████    | 12/20 [02:02<01:22, 10.29s/it]
Task 6, Epoch 13/20 => Loss 0.178, Train_accy 94.65:  60%|██████    | 12/20 [02:11<01:22, 10.29s/it]
Task 6, Epoch 13/20 => Loss 0.178, Train_accy 94.65:  65%|██████▌   | 13/20 [02:11<01:08,  9.77s/it]
Task 6, Epoch 14/20 => Loss 0.154, Train_accy 94.86:  65%|██████▌   | 13/20 [02:19<01:08,  9.77s/it]
Task 6, Epoch 14/20 => Loss 0.154, Train_accy 94.86:  70%|███████   | 14/20 [02:19<00:56,  9.43s/it]
Task 6, Epoch 15/20 => Loss 0.176, Train_accy 94.65, Test_accy 78.49:  70%|███████   | 14/20 [02:38<00:56,  9.43s/it]
Task 6, Epoch 15/20 => Loss 0.176, Train_accy 94.65, Test_accy 78.49:  75%|███████▌  | 15/20 [02:38<01:00, 12.08s/it]
Task 6, Epoch 16/20 => Loss 0.140, Train_accy 95.18:  75%|███████▌  | 15/20 [02:46<01:00, 12.08s/it]                 
Task 6, Epoch 16/20 => Loss 0.140, Train_accy 95.18:  80%|████████  | 16/20 [02:46<00:44, 11.00s/it]
Task 6, Epoch 17/20 => Loss 0.163, Train_accy 94.44:  80%|████████  | 16/20 [02:55<00:44, 11.00s/it]
Task 6, Epoch 17/20 => Loss 0.163, Train_accy 94.44:  85%|████████▌ | 17/20 [02:55<00:30, 10.29s/it]
Task 6, Epoch 18/20 => Loss 0.099, Train_accy 96.23:  85%|████████▌ | 17/20 [03:03<00:30, 10.29s/it]
Task 6, Epoch 18/20 => Loss 0.099, Train_accy 96.23:  90%|█████████ | 18/20 [03:03<00:19,  9.76s/it]
Task 6, Epoch 19/20 => Loss 0.151, Train_accy 94.76:  90%|█████████ | 18/20 [03:12<00:19,  9.76s/it]
Task 6, Epoch 19/20 => Loss 0.151, Train_accy 94.76:  95%|█████████▌| 19/20 [03:12<00:09,  9.39s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.81, Test_accy 79.28:  95%|█████████▌| 19/20 [03:30<00:09,  9.39s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.81, Test_accy 79.28: 100%|██████████| 20/20 [03:30<00:00, 12.05s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.81, Test_accy 79.28: 100%|██████████| 20/20 [03:30<00:00, 10.53s/it]2024-09-13 18:27:43,050 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.81, Test_accy 79.28

2024-09-13 18:27:52,793 [trainer.py] => No NME accuracy.
2024-09-13 18:27:52,793 [trainer.py] => CNN: {'total': 79.28, '00-19': 89.88, '20-39': 92.27, '40-59': 86.24, '60-79': 77.73, '80-99': 74.35, '100-119': 68.42, '120-139': 67.56, 'old': 81.14, 'new': 67.56}
2024-09-13 18:27:52,793 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45, 88.25, 84.76, 80.86, 79.28]
2024-09-13 18:27:52,793 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11, 99.02, 99.24, 98.94, 98.48]

Average Accuracy (CNN): 88.78
2024-09-13 18:27:52,793 [trainer.py] => Average Accuracy (CNN): 88.78 

2024-09-13 18:27:52,795 [trainer.py] => All params: 172158352
2024-09-13 18:27:52,796 [trainer.py] => Trainable params: 407240
2024-09-13 18:27:52,796 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.413, Train_accy 60.33:   0%|          | 0/20 [00:08<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.413, Train_accy 60.33:   5%|▌         | 1/20 [00:08<02:37,  8.28s/it]
Task 7, Epoch 2/20 => Loss 0.337, Train_accy 90.43:   5%|▌         | 1/20 [00:16<02:37,  8.28s/it]
Task 7, Epoch 2/20 => Loss 0.337, Train_accy 90.43:  10%|█         | 2/20 [00:16<02:29,  8.29s/it]
Task 7, Epoch 3/20 => Loss 0.294, Train_accy 91.96:  10%|█         | 2/20 [00:24<02:29,  8.29s/it]
Task 7, Epoch 3/20 => Loss 0.294, Train_accy 91.96:  15%|█▌        | 3/20 [00:24<02:20,  8.27s/it]
Task 7, Epoch 4/20 => Loss 0.198, Train_accy 94.13:  15%|█▌        | 3/20 [00:33<02:20,  8.27s/it]
Task 7, Epoch 4/20 => Loss 0.198, Train_accy 94.13:  20%|██        | 4/20 [00:33<02:12,  8.29s/it]
Task 7, Epoch 5/20 => Loss 0.166, Train_accy 95.65, Test_accy 74.25:  20%|██        | 4/20 [00:52<02:12,  8.29s/it]
Task 7, Epoch 5/20 => Loss 0.166, Train_accy 95.65, Test_accy 74.25:  25%|██▌       | 5/20 [00:52<03:03, 12.26s/it]
Task 7, Epoch 6/20 => Loss 0.205, Train_accy 94.24:  25%|██▌       | 5/20 [01:00<03:03, 12.26s/it]                 
Task 7, Epoch 6/20 => Loss 0.205, Train_accy 94.24:  30%|███       | 6/20 [01:00<02:32, 10.91s/it]
Task 7, Epoch 7/20 => Loss 0.153, Train_accy 95.00:  30%|███       | 6/20 [01:08<02:32, 10.91s/it]
Task 7, Epoch 7/20 => Loss 0.153, Train_accy 95.00:  35%|███▌      | 7/20 [01:08<02:10, 10.03s/it]
Task 7, Epoch 8/20 => Loss 0.144, Train_accy 95.11:  35%|███▌      | 7/20 [01:17<02:10, 10.03s/it]
Task 7, Epoch 8/20 => Loss 0.144, Train_accy 95.11:  40%|████      | 8/20 [01:17<01:53,  9.47s/it]
Task 7, Epoch 9/20 => Loss 0.119, Train_accy 95.87:  40%|████      | 8/20 [01:25<01:53,  9.47s/it]
Task 7, Epoch 9/20 => Loss 0.119, Train_accy 95.87:  45%|████▌     | 9/20 [01:25<01:40,  9.13s/it]
Task 7, Epoch 10/20 => Loss 0.113, Train_accy 96.52, Test_accy 76.10:  45%|████▌     | 9/20 [01:45<01:40,  9.13s/it]
Task 7, Epoch 10/20 => Loss 0.113, Train_accy 96.52, Test_accy 76.10:  50%|█████     | 10/20 [01:45<02:03, 12.33s/it]
Task 7, Epoch 11/20 => Loss 0.134, Train_accy 95.22:  50%|█████     | 10/20 [01:53<02:03, 12.33s/it]                 
Task 7, Epoch 11/20 => Loss 0.134, Train_accy 95.22:  55%|█████▌    | 11/20 [01:53<01:39, 11.08s/it]
Task 7, Epoch 12/20 => Loss 0.158, Train_accy 94.02:  55%|█████▌    | 11/20 [02:01<01:39, 11.08s/it]
Task 7, Epoch 12/20 => Loss 0.158, Train_accy 94.02:  60%|██████    | 12/20 [02:01<01:21, 10.24s/it]
Task 7, Epoch 13/20 => Loss 0.150, Train_accy 95.54:  60%|██████    | 12/20 [02:09<01:21, 10.24s/it]
Task 7, Epoch 13/20 => Loss 0.150, Train_accy 95.54:  65%|██████▌   | 13/20 [02:09<01:07,  9.64s/it]
Task 7, Epoch 14/20 => Loss 0.150, Train_accy 94.78:  65%|██████▌   | 13/20 [02:18<01:07,  9.64s/it]
Task 7, Epoch 14/20 => Loss 0.150, Train_accy 94.78:  70%|███████   | 14/20 [02:18<00:55,  9.22s/it]
Task 7, Epoch 15/20 => Loss 0.141, Train_accy 95.76, Test_accy 76.47:  70%|███████   | 14/20 [02:37<00:55,  9.22s/it]
Task 7, Epoch 15/20 => Loss 0.141, Train_accy 95.76, Test_accy 76.47:  75%|███████▌  | 15/20 [02:37<01:01, 12.25s/it]
Task 7, Epoch 16/20 => Loss 0.120, Train_accy 95.43:  75%|███████▌  | 15/20 [02:45<01:01, 12.25s/it]                 
Task 7, Epoch 16/20 => Loss 0.120, Train_accy 95.43:  80%|████████  | 16/20 [02:45<00:44, 11.06s/it]
Task 7, Epoch 17/20 => Loss 0.116, Train_accy 95.65:  80%|████████  | 16/20 [02:54<00:44, 11.06s/it]
Task 7, Epoch 17/20 => Loss 0.116, Train_accy 95.65:  85%|████████▌ | 17/20 [02:54<00:30, 10.22s/it]
Task 7, Epoch 18/20 => Loss 0.103, Train_accy 95.65:  85%|████████▌ | 17/20 [03:02<00:30, 10.22s/it]
Task 7, Epoch 18/20 => Loss 0.103, Train_accy 95.65:  90%|█████████ | 18/20 [03:02<00:19,  9.65s/it]
Task 7, Epoch 19/20 => Loss 0.112, Train_accy 96.52:  90%|█████████ | 18/20 [03:10<00:19,  9.65s/it]
Task 7, Epoch 19/20 => Loss 0.112, Train_accy 96.52:  95%|█████████▌| 19/20 [03:10<00:09,  9.24s/it]
Task 7, Epoch 20/20 => Loss 0.115, Train_accy 96.30, Test_accy 76.89:  95%|█████████▌| 19/20 [03:29<00:09,  9.24s/it]
Task 7, Epoch 20/20 => Loss 0.115, Train_accy 96.30, Test_accy 76.89: 100%|██████████| 20/20 [03:29<00:00, 12.26s/it]
Task 7, Epoch 20/20 => Loss 0.115, Train_accy 96.30, Test_accy 76.89: 100%|██████████| 20/20 [03:29<00:00, 10.50s/it]2024-09-13 18:31:22,743 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.115, Train_accy 96.30, Test_accy 76.89

2024-09-13 18:31:33,893 [trainer.py] => No NME accuracy.
2024-09-13 18:31:33,893 [trainer.py] => CNN: {'total': 76.89, '00-19': 88.66, '20-39': 91.3, '40-59': 84.86, '60-79': 76.52, '80-99': 73.61, '100-119': 66.67, '120-139': 68.0, '140-159': 67.6, 'old': 78.31, 'new': 67.6}
2024-09-13 18:31:33,893 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45, 88.25, 84.76, 80.86, 79.28, 76.89]
2024-09-13 18:31:33,893 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11, 99.02, 99.24, 98.94, 98.48, 98.41]

Average Accuracy (CNN): 87.29
2024-09-13 18:31:33,894 [trainer.py] => Average Accuracy (CNN): 87.29 

2024-09-13 18:31:33,895 [trainer.py] => All params: 172158352
2024-09-13 18:31:33,897 [trainer.py] => Trainable params: 407240
2024-09-13 18:31:33,897 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.299, Train_accy 65.66:   0%|          | 0/20 [00:08<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.299, Train_accy 65.66:   5%|▌         | 1/20 [00:08<02:43,  8.61s/it]
Task 8, Epoch 2/20 => Loss 0.301, Train_accy 90.92:   5%|▌         | 1/20 [00:17<02:43,  8.61s/it]
Task 8, Epoch 2/20 => Loss 0.301, Train_accy 90.92:  10%|█         | 2/20 [00:17<02:34,  8.58s/it]
Task 8, Epoch 3/20 => Loss 0.225, Train_accy 92.90:  10%|█         | 2/20 [00:25<02:34,  8.58s/it]
Task 8, Epoch 3/20 => Loss 0.225, Train_accy 92.90:  15%|█▌        | 3/20 [00:25<02:26,  8.65s/it]
Task 8, Epoch 4/20 => Loss 0.201, Train_accy 93.84:  15%|█▌        | 3/20 [00:34<02:26,  8.65s/it]
Task 8, Epoch 4/20 => Loss 0.201, Train_accy 93.84:  20%|██        | 4/20 [00:34<02:17,  8.60s/it]
Task 8, Epoch 5/20 => Loss 0.158, Train_accy 95.51, Test_accy 72.98:  20%|██        | 4/20 [00:55<02:17,  8.60s/it]
Task 8, Epoch 5/20 => Loss 0.158, Train_accy 95.51, Test_accy 72.98:  25%|██▌       | 5/20 [00:55<03:17, 13.14s/it]
Task 8, Epoch 6/20 => Loss 0.152, Train_accy 95.51:  25%|██▌       | 5/20 [01:04<03:17, 13.14s/it]                 
Task 8, Epoch 6/20 => Loss 0.152, Train_accy 95.51:  30%|███       | 6/20 [01:04<02:42, 11.58s/it]
Task 8, Epoch 7/20 => Loss 0.170, Train_accy 94.57:  30%|███       | 6/20 [01:12<02:42, 11.58s/it]
Task 8, Epoch 7/20 => Loss 0.170, Train_accy 94.57:  35%|███▌      | 7/20 [01:12<02:17, 10.61s/it]
Task 8, Epoch 8/20 => Loss 0.167, Train_accy 94.15:  35%|███▌      | 7/20 [01:21<02:17, 10.61s/it]
Task 8, Epoch 8/20 => Loss 0.167, Train_accy 94.15:  40%|████      | 8/20 [01:21<01:59,  9.96s/it]
Task 8, Epoch 9/20 => Loss 0.145, Train_accy 94.89:  40%|████      | 8/20 [01:29<01:59,  9.96s/it]
Task 8, Epoch 9/20 => Loss 0.145, Train_accy 94.89:  45%|████▌     | 9/20 [01:29<01:44,  9.54s/it]
Task 8, Epoch 10/20 => Loss 0.137, Train_accy 95.41, Test_accy 75.00:  45%|████▌     | 9/20 [01:51<01:44,  9.54s/it]
Task 8, Epoch 10/20 => Loss 0.137, Train_accy 95.41, Test_accy 75.00:  50%|█████     | 10/20 [01:51<02:11, 13.16s/it]
Task 8, Epoch 11/20 => Loss 0.165, Train_accy 94.36:  50%|█████     | 10/20 [01:59<02:11, 13.16s/it]                 
Task 8, Epoch 11/20 => Loss 0.165, Train_accy 94.36:  55%|█████▌    | 11/20 [01:59<01:45, 11.76s/it]
Task 8, Epoch 12/20 => Loss 0.124, Train_accy 96.14:  55%|█████▌    | 11/20 [02:08<01:45, 11.76s/it]
Task 8, Epoch 12/20 => Loss 0.124, Train_accy 96.14:  60%|██████    | 12/20 [02:08<01:26, 10.83s/it]
Task 8, Epoch 13/20 => Loss 0.111, Train_accy 96.14:  60%|██████    | 12/20 [02:17<01:26, 10.83s/it]
Task 8, Epoch 13/20 => Loss 0.111, Train_accy 96.14:  65%|██████▌   | 13/20 [02:17<01:10, 10.13s/it]
Task 8, Epoch 14/20 => Loss 0.113, Train_accy 96.35:  65%|██████▌   | 13/20 [02:25<01:10, 10.13s/it]
Task 8, Epoch 14/20 => Loss 0.113, Train_accy 96.35:  70%|███████   | 14/20 [02:25<00:58,  9.69s/it]
Task 8, Epoch 15/20 => Loss 0.125, Train_accy 95.62, Test_accy 75.00:  70%|███████   | 14/20 [02:46<00:58,  9.69s/it]
Task 8, Epoch 15/20 => Loss 0.125, Train_accy 95.62, Test_accy 75.00:  75%|███████▌  | 15/20 [02:46<01:05, 13.14s/it]
Task 8, Epoch 16/20 => Loss 0.155, Train_accy 95.30:  75%|███████▌  | 15/20 [02:55<01:05, 13.14s/it]                 
Task 8, Epoch 16/20 => Loss 0.155, Train_accy 95.30:  80%|████████  | 16/20 [02:55<00:47, 11.77s/it]
Task 8, Epoch 17/20 => Loss 0.101, Train_accy 96.45:  80%|████████  | 16/20 [03:03<00:47, 11.77s/it]
Task 8, Epoch 17/20 => Loss 0.101, Train_accy 96.45:  85%|████████▌ | 17/20 [03:03<00:32, 10.81s/it]
Task 8, Epoch 18/20 => Loss 0.110, Train_accy 95.93:  85%|████████▌ | 17/20 [03:12<00:32, 10.81s/it]
Task 8, Epoch 18/20 => Loss 0.110, Train_accy 95.93:  90%|█████████ | 18/20 [03:12<00:20, 10.20s/it]
Task 8, Epoch 19/20 => Loss 0.095, Train_accy 96.56:  90%|█████████ | 18/20 [03:21<00:20, 10.20s/it]
Task 8, Epoch 19/20 => Loss 0.095, Train_accy 96.56:  95%|█████████▌| 19/20 [03:21<00:09,  9.73s/it]
Task 8, Epoch 20/20 => Loss 0.122, Train_accy 95.30, Test_accy 76.27:  95%|█████████▌| 19/20 [03:42<00:09,  9.73s/it]
Task 8, Epoch 20/20 => Loss 0.122, Train_accy 95.30, Test_accy 76.27: 100%|██████████| 20/20 [03:42<00:00, 13.16s/it]
Task 8, Epoch 20/20 => Loss 0.122, Train_accy 95.30, Test_accy 76.27: 100%|██████████| 20/20 [03:42<00:00, 11.13s/it]2024-09-13 18:35:16,487 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.122, Train_accy 95.30, Test_accy 76.27

2024-09-13 18:35:29,042 [trainer.py] => No NME accuracy.
2024-09-13 18:35:29,043 [trainer.py] => CNN: {'total': 76.27, '00-19': 87.45, '20-39': 91.3, '40-59': 84.86, '60-79': 75.71, '80-99': 72.12, '100-119': 66.23, '120-139': 68.89, '140-159': 67.2, '160-179': 75.11, 'old': 76.41, 'new': 75.11}
2024-09-13 18:35:29,043 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45, 88.25, 84.76, 80.86, 79.28, 76.89, 76.27]
2024-09-13 18:35:29,043 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11, 99.02, 99.24, 98.94, 98.48, 98.41, 97.84]

Average Accuracy (CNN): 86.07
2024-09-13 18:35:29,043 [trainer.py] => Average Accuracy (CNN): 86.07 

2024-09-13 18:35:29,045 [trainer.py] => All params: 172158352
2024-09-13 18:35:29,047 [trainer.py] => Trainable params: 407240
2024-09-13 18:35:29,047 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.309, Train_accy 65.76:   0%|          | 0/20 [00:08<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.309, Train_accy 65.76:   5%|▌         | 1/20 [00:08<02:44,  8.65s/it]
Task 9, Epoch 2/20 => Loss 0.273, Train_accy 91.81:   5%|▌         | 1/20 [00:17<02:44,  8.65s/it]
Task 9, Epoch 2/20 => Loss 0.273, Train_accy 91.81:  10%|█         | 2/20 [00:17<02:33,  8.55s/it]
Task 9, Epoch 3/20 => Loss 0.246, Train_accy 91.81:  10%|█         | 2/20 [00:25<02:33,  8.55s/it]
Task 9, Epoch 3/20 => Loss 0.246, Train_accy 91.81:  15%|█▌        | 3/20 [00:25<02:25,  8.55s/it]
Task 9, Epoch 4/20 => Loss 0.203, Train_accy 93.80:  15%|█▌        | 3/20 [00:34<02:25,  8.55s/it]
Task 9, Epoch 4/20 => Loss 0.203, Train_accy 93.80:  20%|██        | 4/20 [00:34<02:16,  8.54s/it]
Task 9, Epoch 5/20 => Loss 0.169, Train_accy 94.85, Test_accy 72.52:  20%|██        | 4/20 [00:56<02:16,  8.54s/it]
Task 9, Epoch 5/20 => Loss 0.169, Train_accy 94.85, Test_accy 72.52:  25%|██▌       | 5/20 [00:56<03:22, 13.51s/it]
Task 9, Epoch 6/20 => Loss 0.166, Train_accy 94.22:  25%|██▌       | 5/20 [01:05<03:22, 13.51s/it]                 
Task 9, Epoch 6/20 => Loss 0.166, Train_accy 94.22:  30%|███       | 6/20 [01:05<02:45, 11.84s/it]
Task 9, Epoch 7/20 => Loss 0.128, Train_accy 96.01:  30%|███       | 6/20 [01:13<02:45, 11.84s/it]
Task 9, Epoch 7/20 => Loss 0.128, Train_accy 96.01:  35%|███▌      | 7/20 [01:13<02:19, 10.77s/it]
Task 9, Epoch 8/20 => Loss 0.166, Train_accy 94.85:  35%|███▌      | 7/20 [01:22<02:19, 10.77s/it]
Task 9, Epoch 8/20 => Loss 0.166, Train_accy 94.85:  40%|████      | 8/20 [01:22<02:00, 10.07s/it]
Task 9, Epoch 9/20 => Loss 0.145, Train_accy 94.85:  40%|████      | 8/20 [01:30<02:00, 10.07s/it]
Task 9, Epoch 9/20 => Loss 0.145, Train_accy 94.85:  45%|████▌     | 9/20 [01:30<01:45,  9.63s/it]
Task 9, Epoch 10/20 => Loss 0.145, Train_accy 94.85, Test_accy 73.11:  45%|████▌     | 9/20 [01:53<01:45,  9.63s/it]
Task 9, Epoch 10/20 => Loss 0.145, Train_accy 94.85, Test_accy 73.11:  50%|█████     | 10/20 [01:53<02:15, 13.52s/it]
Task 9, Epoch 11/20 => Loss 0.143, Train_accy 95.69:  50%|█████     | 10/20 [02:01<02:15, 13.52s/it]                 
Task 9, Epoch 11/20 => Loss 0.143, Train_accy 95.69:  55%|█████▌    | 11/20 [02:01<01:48, 12.06s/it]
Task 9, Epoch 12/20 => Loss 0.116, Train_accy 95.80:  55%|█████▌    | 11/20 [02:10<01:48, 12.06s/it]
Task 9, Epoch 12/20 => Loss 0.116, Train_accy 95.80:  60%|██████    | 12/20 [02:10<01:28, 11.03s/it]
Task 9, Epoch 13/20 => Loss 0.117, Train_accy 96.43:  60%|██████    | 12/20 [02:19<01:28, 11.03s/it]
Task 9, Epoch 13/20 => Loss 0.117, Train_accy 96.43:  65%|██████▌   | 13/20 [02:19<01:12, 10.36s/it]
Task 9, Epoch 14/20 => Loss 0.145, Train_accy 94.96:  65%|██████▌   | 13/20 [02:28<01:12, 10.36s/it]
Task 9, Epoch 14/20 => Loss 0.145, Train_accy 94.96:  70%|███████   | 14/20 [02:28<00:59,  9.87s/it]
Task 9, Epoch 15/20 => Loss 0.102, Train_accy 96.53, Test_accy 73.66:  70%|███████   | 14/20 [02:50<00:59,  9.87s/it]
Task 9, Epoch 15/20 => Loss 0.102, Train_accy 96.53, Test_accy 73.66:  75%|███████▌  | 15/20 [02:50<01:08, 13.66s/it]
Task 9, Epoch 16/20 => Loss 0.102, Train_accy 95.90:  75%|███████▌  | 15/20 [02:59<01:08, 13.66s/it]                 
Task 9, Epoch 16/20 => Loss 0.102, Train_accy 95.90:  80%|████████  | 16/20 [02:59<00:48, 12.15s/it]
Task 9, Epoch 17/20 => Loss 0.146, Train_accy 95.48:  80%|████████  | 16/20 [03:07<00:48, 12.15s/it]
Task 9, Epoch 17/20 => Loss 0.146, Train_accy 95.48:  85%|████████▌ | 17/20 [03:07<00:33, 11.06s/it]
Task 9, Epoch 18/20 => Loss 0.107, Train_accy 96.53:  85%|████████▌ | 17/20 [03:16<00:33, 11.06s/it]
Task 9, Epoch 18/20 => Loss 0.107, Train_accy 96.53:  90%|█████████ | 18/20 [03:16<00:20, 10.30s/it]
Task 9, Epoch 19/20 => Loss 0.090, Train_accy 96.64:  90%|█████████ | 18/20 [03:24<00:20, 10.30s/it]
Task 9, Epoch 19/20 => Loss 0.090, Train_accy 96.64:  95%|█████████▌| 19/20 [03:24<00:09,  9.79s/it]
Task 9, Epoch 20/20 => Loss 0.105, Train_accy 96.74, Test_accy 74.09:  95%|█████████▌| 19/20 [03:47<00:09,  9.79s/it]
Task 9, Epoch 20/20 => Loss 0.105, Train_accy 96.74, Test_accy 74.09: 100%|██████████| 20/20 [03:47<00:00, 13.53s/it]
Task 9, Epoch 20/20 => Loss 0.105, Train_accy 96.74, Test_accy 74.09: 100%|██████████| 20/20 [03:47<00:00, 11.36s/it]2024-09-13 18:39:16,192 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.105, Train_accy 96.74, Test_accy 74.09

2024-09-13 18:39:30,016 [trainer.py] => No NME accuracy.
2024-09-13 18:39:30,017 [trainer.py] => CNN: {'total': 74.09, '00-19': 86.23, '20-39': 89.37, '40-59': 83.94, '60-79': 76.11, '80-99': 71.0, '100-119': 65.35, '120-139': 67.11, '140-159': 67.2, '160-179': 72.57, '180-199': 63.91, 'old': 75.19, 'new': 63.91}
2024-09-13 18:39:30,017 [trainer.py] => CNN top1 curve: [98.79, 96.04, 93.45, 88.25, 84.76, 80.86, 79.28, 76.89, 76.27, 74.09]
2024-09-13 18:39:30,017 [trainer.py] => CNN top5 curve: [100.0, 99.34, 99.11, 99.02, 99.24, 98.94, 98.48, 98.41, 97.84, 97.2]

Average Accuracy (CNN): 84.87
2024-09-13 18:39:30,017 [trainer.py] => Average Accuracy (CNN): 84.87 

Accuracy Matrix (CNN):
[[98.79 97.17 95.95 91.9  91.09 89.47 89.88 88.66 87.45 86.23]
 [ 0.   94.69 93.72 91.79 92.75 92.27 92.27 91.3  91.3  89.37]
 [ 0.    0.   90.37 88.53 88.53 87.16 86.24 84.86 84.86 83.94]
 [ 0.    0.    0.   81.38 80.16 77.73 77.73 76.52 75.71 76.11]
 [ 0.    0.    0.    0.   73.98 72.86 74.35 73.61 72.12 71.  ]
 [ 0.    0.    0.    0.    0.   67.98 68.42 66.67 66.23 65.35]
 [ 0.    0.    0.    0.    0.    0.   67.56 68.   68.89 67.11]
 [ 0.    0.    0.    0.    0.    0.    0.   67.6  67.2  67.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   75.11 72.57]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   63.91]]
2024-09-13 18:39:30,020 [trainer.py] => Forgetting (CNN): 4.524444444444445
2024-09-13 18:39:32,309 [trainer.py] => config: ./exps/dualprompt_cub_B0_Inc20.json
2024-09-13 18:39:32,310 [trainer.py] => prefix:  
2024-09-13 18:39:32,310 [trainer.py] => dataset: cub
2024-09-13 18:39:32,310 [trainer.py] => memory_size: 0
2024-09-13 18:39:32,310 [trainer.py] => memory_per_class: 0
2024-09-13 18:39:32,310 [trainer.py] => fixed_memory: True
2024-09-13 18:39:32,310 [trainer.py] => shuffle: True
2024-09-13 18:39:32,310 [trainer.py] => init_cls: 10
2024-09-13 18:39:32,310 [trainer.py] => increment: 10
2024-09-13 18:39:32,310 [trainer.py] => model_name: dualprompt
2024-09-13 18:39:32,310 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-13 18:39:32,310 [trainer.py] => get_original_backbone: True
2024-09-13 18:39:32,310 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 18:39:32,310 [trainer.py] => seed: 1993
2024-09-13 18:39:32,310 [trainer.py] => tuned_epoch: 20
2024-09-13 18:39:32,310 [trainer.py] => init_lr: 0.001
2024-09-13 18:39:32,310 [trainer.py] => batch_size: 48
2024-09-13 18:39:32,310 [trainer.py] => weight_decay: 0
2024-09-13 18:39:32,310 [trainer.py] => min_lr: 1e-05
2024-09-13 18:39:32,310 [trainer.py] => optimizer: adam
2024-09-13 18:39:32,310 [trainer.py] => scheduler: constant
2024-09-13 18:39:32,310 [trainer.py] => reinit_optimizer: True
2024-09-13 18:39:32,311 [trainer.py] => global_pool: token
2024-09-13 18:39:32,311 [trainer.py] => head_type: token
2024-09-13 18:39:32,311 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-13 18:39:32,311 [trainer.py] => pretrained: True
2024-09-13 18:39:32,311 [trainer.py] => drop: 0.0
2024-09-13 18:39:32,311 [trainer.py] => drop_path: 0.0
2024-09-13 18:39:32,311 [trainer.py] => use_g_prompt: True
2024-09-13 18:39:32,311 [trainer.py] => g_prompt_length: 5
2024-09-13 18:39:32,311 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-13 18:39:32,311 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-13 18:39:32,311 [trainer.py] => use_e_prompt: True
2024-09-13 18:39:32,311 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-13 18:39:32,311 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-13 18:39:32,311 [trainer.py] => prompt_pool: True
2024-09-13 18:39:32,311 [trainer.py] => size: 10
2024-09-13 18:39:32,311 [trainer.py] => length: 5
2024-09-13 18:39:32,311 [trainer.py] => top_k: 1
2024-09-13 18:39:32,311 [trainer.py] => initializer: uniform
2024-09-13 18:39:32,311 [trainer.py] => prompt_key: True
2024-09-13 18:39:32,311 [trainer.py] => prompt_key_init: uniform
2024-09-13 18:39:32,311 [trainer.py] => use_prompt_mask: True
2024-09-13 18:39:32,311 [trainer.py] => shared_prompt_pool: True
2024-09-13 18:39:32,311 [trainer.py] => shared_prompt_key: False
2024-09-13 18:39:32,311 [trainer.py] => batchwise_prompt: True
2024-09-13 18:39:32,311 [trainer.py] => embedding_key: cls
2024-09-13 18:39:32,311 [trainer.py] => predefined_key: 
2024-09-13 18:39:32,312 [trainer.py] => pull_constraint: True
2024-09-13 18:39:32,312 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-13 18:39:32,312 [trainer.py] => same_key_value: False
2024-09-13 18:39:32,358 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 18:39:37,432 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-13 18:39:37,433 [dualprompt.py] => 407,240 model training parameters.
2024-09-13 18:39:37,433 [dualprompt.py] => g_prompt: 15360
2024-09-13 18:39:37,433 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-13 18:39:37,433 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-13 18:39:37,433 [dualprompt.py] => head.weight: 153600
2024-09-13 18:39:37,433 [dualprompt.py] => head.bias: 200
2024-09-13 18:39:37,434 [trainer.py] => All params: 172158352
2024-09-13 18:39:37,435 [trainer.py] => Trainable params: 407240
2024-09-13 18:39:37,435 [dualprompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.309, Train_accy 63.26:   0%|          | 0/20 [00:04<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.309, Train_accy 63.26:   5%|▌         | 1/20 [00:04<01:32,  4.88s/it]
Task 0, Epoch 2/20 => Loss 0.333, Train_accy 90.61:   5%|▌         | 1/20 [00:09<01:32,  4.88s/it]
Task 0, Epoch 2/20 => Loss 0.333, Train_accy 90.61:  10%|█         | 2/20 [00:09<01:26,  4.78s/it]
Task 0, Epoch 3/20 => Loss 0.219, Train_accy 94.57:  10%|█         | 2/20 [00:14<01:26,  4.78s/it]
Task 0, Epoch 3/20 => Loss 0.219, Train_accy 94.57:  15%|█▌        | 3/20 [00:14<01:19,  4.66s/it]
Task 0, Epoch 4/20 => Loss 0.188, Train_accy 94.15:  15%|█▌        | 3/20 [00:18<01:19,  4.66s/it]
Task 0, Epoch 4/20 => Loss 0.188, Train_accy 94.15:  20%|██        | 4/20 [00:18<01:13,  4.60s/it]
Task 0, Epoch 5/20 => Loss 0.140, Train_accy 96.24, Test_accy 100.00:  20%|██        | 4/20 [00:24<01:13,  4.60s/it]
Task 0, Epoch 5/20 => Loss 0.140, Train_accy 96.24, Test_accy 100.00:  25%|██▌       | 5/20 [00:24<01:15,  5.04s/it]
Task 0, Epoch 6/20 => Loss 0.154, Train_accy 94.57:  25%|██▌       | 5/20 [00:28<01:15,  5.04s/it]                  
Task 0, Epoch 6/20 => Loss 0.154, Train_accy 94.57:  30%|███       | 6/20 [00:28<01:07,  4.86s/it]
Task 0, Epoch 7/20 => Loss 0.140, Train_accy 95.82:  30%|███       | 6/20 [00:33<01:07,  4.86s/it]
Task 0, Epoch 7/20 => Loss 0.140, Train_accy 95.82:  35%|███▌      | 7/20 [00:33<01:01,  4.76s/it]
Task 0, Epoch 8/20 => Loss 0.135, Train_accy 95.62:  35%|███▌      | 7/20 [00:38<01:01,  4.76s/it]
Task 0, Epoch 8/20 => Loss 0.135, Train_accy 95.62:  40%|████      | 8/20 [00:38<00:56,  4.68s/it]
Task 0, Epoch 9/20 => Loss 0.117, Train_accy 95.20:  40%|████      | 8/20 [00:42<00:56,  4.68s/it]
Task 0, Epoch 9/20 => Loss 0.117, Train_accy 95.20:  45%|████▌     | 9/20 [00:42<00:51,  4.65s/it]
Task 0, Epoch 10/20 => Loss 0.118, Train_accy 96.03, Test_accy 100.00:  45%|████▌     | 9/20 [00:48<00:51,  4.65s/it]
Task 0, Epoch 10/20 => Loss 0.118, Train_accy 96.03, Test_accy 100.00:  50%|█████     | 10/20 [00:48<00:50,  5.02s/it]
Task 0, Epoch 11/20 => Loss 0.120, Train_accy 96.45:  50%|█████     | 10/20 [00:53<00:50,  5.02s/it]                  
Task 0, Epoch 11/20 => Loss 0.120, Train_accy 96.45:  55%|█████▌    | 11/20 [00:53<00:44,  4.89s/it]
Task 0, Epoch 12/20 => Loss 0.124, Train_accy 95.41:  55%|█████▌    | 11/20 [00:57<00:44,  4.89s/it]
Task 0, Epoch 12/20 => Loss 0.124, Train_accy 95.41:  60%|██████    | 12/20 [00:57<00:38,  4.78s/it]
Task 0, Epoch 13/20 => Loss 0.104, Train_accy 96.45:  60%|██████    | 12/20 [01:02<00:38,  4.78s/it]
Task 0, Epoch 13/20 => Loss 0.104, Train_accy 96.45:  65%|██████▌   | 13/20 [01:02<00:33,  4.74s/it]
Task 0, Epoch 14/20 => Loss 0.129, Train_accy 94.99:  65%|██████▌   | 13/20 [01:06<00:33,  4.74s/it]
Task 0, Epoch 14/20 => Loss 0.129, Train_accy 94.99:  70%|███████   | 14/20 [01:06<00:28,  4.68s/it]
Task 0, Epoch 15/20 => Loss 0.109, Train_accy 96.03, Test_accy 100.00:  70%|███████   | 14/20 [01:12<00:28,  4.68s/it]
Task 0, Epoch 15/20 => Loss 0.109, Train_accy 96.03, Test_accy 100.00:  75%|███████▌  | 15/20 [01:12<00:25,  5.06s/it]
Task 0, Epoch 16/20 => Loss 0.090, Train_accy 97.49:  75%|███████▌  | 15/20 [01:17<00:25,  5.06s/it]                  
Task 0, Epoch 16/20 => Loss 0.090, Train_accy 97.49:  80%|████████  | 16/20 [01:17<00:19,  4.91s/it]
Task 0, Epoch 17/20 => Loss 0.112, Train_accy 96.24:  80%|████████  | 16/20 [01:21<00:19,  4.91s/it]
Task 0, Epoch 17/20 => Loss 0.112, Train_accy 96.24:  85%|████████▌ | 17/20 [01:21<00:14,  4.82s/it]
Task 0, Epoch 18/20 => Loss 0.114, Train_accy 96.24:  85%|████████▌ | 17/20 [01:26<00:14,  4.82s/it]
Task 0, Epoch 18/20 => Loss 0.114, Train_accy 96.24:  90%|█████████ | 18/20 [01:26<00:09,  4.73s/it]
Task 0, Epoch 19/20 => Loss 0.071, Train_accy 97.08:  90%|█████████ | 18/20 [01:30<00:09,  4.73s/it]
Task 0, Epoch 19/20 => Loss 0.071, Train_accy 97.08:  95%|█████████▌| 19/20 [01:30<00:04,  4.68s/it]
Task 0, Epoch 20/20 => Loss 0.115, Train_accy 95.20, Test_accy 100.00:  95%|█████████▌| 19/20 [01:36<00:04,  4.68s/it]
Task 0, Epoch 20/20 => Loss 0.115, Train_accy 95.20, Test_accy 100.00: 100%|██████████| 20/20 [01:36<00:00,  5.01s/it]
Task 0, Epoch 20/20 => Loss 0.115, Train_accy 95.20, Test_accy 100.00: 100%|██████████| 20/20 [01:36<00:00,  4.84s/it]2024-09-13 18:41:14,709 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.115, Train_accy 95.20, Test_accy 100.00

2024-09-13 18:41:15,928 [trainer.py] => No NME accuracy.
2024-09-13 18:41:15,929 [trainer.py] => CNN: {'total': 100.0, '00-09': 100.0, 'old': 0, 'new': 100.0}
2024-09-13 18:41:15,929 [trainer.py] => CNN top1 curve: [100.0]
2024-09-13 18:41:15,929 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 100.0
2024-09-13 18:41:15,929 [trainer.py] => Average Accuracy (CNN): 100.0 

2024-09-13 18:41:15,931 [trainer.py] => All params: 172158352
2024-09-13 18:41:15,933 [trainer.py] => Trainable params: 407240
2024-09-13 18:41:15,933 [dualprompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.336, Train_accy 55.67:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.336, Train_accy 55.67:   5%|▌         | 1/20 [00:04<01:27,  4.63s/it]
Task 1, Epoch 2/20 => Loss 0.476, Train_accy 82.01:   5%|▌         | 1/20 [00:09<01:27,  4.63s/it]
Task 1, Epoch 2/20 => Loss 0.476, Train_accy 82.01:  10%|█         | 2/20 [00:09<01:21,  4.53s/it]
Task 1, Epoch 3/20 => Loss 0.208, Train_accy 93.58:  10%|█         | 2/20 [00:13<01:21,  4.53s/it]
Task 1, Epoch 3/20 => Loss 0.208, Train_accy 93.58:  15%|█▌        | 3/20 [00:13<01:17,  4.56s/it]
Task 1, Epoch 4/20 => Loss 0.216, Train_accy 94.00:  15%|█▌        | 3/20 [00:18<01:17,  4.56s/it]
Task 1, Epoch 4/20 => Loss 0.216, Train_accy 94.00:  20%|██        | 4/20 [00:18<01:12,  4.51s/it]
Task 1, Epoch 5/20 => Loss 0.143, Train_accy 95.72, Test_accy 96.36:  20%|██        | 4/20 [00:24<01:12,  4.51s/it]
Task 1, Epoch 5/20 => Loss 0.143, Train_accy 95.72, Test_accy 96.36:  25%|██▌       | 5/20 [00:24<01:18,  5.22s/it]
Task 1, Epoch 6/20 => Loss 0.140, Train_accy 96.36:  25%|██▌       | 5/20 [00:29<01:18,  5.22s/it]                 
Task 1, Epoch 6/20 => Loss 0.140, Train_accy 96.36:  30%|███       | 6/20 [00:29<01:09,  4.98s/it]
Task 1, Epoch 7/20 => Loss 0.181, Train_accy 94.86:  30%|███       | 6/20 [00:33<01:09,  4.98s/it]
Task 1, Epoch 7/20 => Loss 0.181, Train_accy 94.86:  35%|███▌      | 7/20 [00:33<01:02,  4.79s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 96.36:  35%|███▌      | 7/20 [00:37<01:02,  4.79s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 96.36:  40%|████      | 8/20 [00:37<00:56,  4.68s/it]
Task 1, Epoch 9/20 => Loss 0.164, Train_accy 94.22:  40%|████      | 8/20 [00:42<00:56,  4.68s/it]
Task 1, Epoch 9/20 => Loss 0.164, Train_accy 94.22:  45%|████▌     | 9/20 [00:42<00:50,  4.60s/it]
Task 1, Epoch 10/20 => Loss 0.091, Train_accy 96.36, Test_accy 96.36:  45%|████▌     | 9/20 [00:48<00:50,  4.60s/it]
Task 1, Epoch 10/20 => Loss 0.091, Train_accy 96.36, Test_accy 96.36:  50%|█████     | 10/20 [00:48<00:51,  5.17s/it]
Task 1, Epoch 11/20 => Loss 0.106, Train_accy 97.22:  50%|█████     | 10/20 [00:53<00:51,  5.17s/it]                 
Task 1, Epoch 11/20 => Loss 0.106, Train_accy 97.22:  55%|█████▌    | 11/20 [00:53<00:44,  4.95s/it]
Task 1, Epoch 12/20 => Loss 0.083, Train_accy 97.43:  55%|█████▌    | 11/20 [00:57<00:44,  4.95s/it]
Task 1, Epoch 12/20 => Loss 0.083, Train_accy 97.43:  60%|██████    | 12/20 [00:57<00:38,  4.83s/it]
Task 1, Epoch 13/20 => Loss 0.093, Train_accy 97.43:  60%|██████    | 12/20 [01:02<00:38,  4.83s/it]
Task 1, Epoch 13/20 => Loss 0.093, Train_accy 97.43:  65%|██████▌   | 13/20 [01:02<00:33,  4.72s/it]
Task 1, Epoch 14/20 => Loss 0.127, Train_accy 95.29:  65%|██████▌   | 13/20 [01:06<00:33,  4.72s/it]
Task 1, Epoch 14/20 => Loss 0.127, Train_accy 95.29:  70%|███████   | 14/20 [01:06<00:27,  4.64s/it]
Task 1, Epoch 15/20 => Loss 0.080, Train_accy 97.43, Test_accy 97.17:  70%|███████   | 14/20 [01:13<00:27,  4.64s/it]
Task 1, Epoch 15/20 => Loss 0.080, Train_accy 97.43, Test_accy 97.17:  75%|███████▌  | 15/20 [01:13<00:26,  5.22s/it]
Task 1, Epoch 16/20 => Loss 0.130, Train_accy 95.72:  75%|███████▌  | 15/20 [01:17<00:26,  5.22s/it]                 
Task 1, Epoch 16/20 => Loss 0.130, Train_accy 95.72:  80%|████████  | 16/20 [01:17<00:20,  5.00s/it]
Task 1, Epoch 17/20 => Loss 0.107, Train_accy 96.57:  80%|████████  | 16/20 [01:22<00:20,  5.00s/it]
Task 1, Epoch 17/20 => Loss 0.107, Train_accy 96.57:  85%|████████▌ | 17/20 [01:22<00:14,  4.84s/it]
Task 1, Epoch 18/20 => Loss 0.107, Train_accy 96.15:  85%|████████▌ | 17/20 [01:26<00:14,  4.84s/it]
Task 1, Epoch 18/20 => Loss 0.107, Train_accy 96.15:  90%|█████████ | 18/20 [01:26<00:09,  4.73s/it]
Task 1, Epoch 19/20 => Loss 0.066, Train_accy 97.64:  90%|█████████ | 18/20 [01:31<00:09,  4.73s/it]
Task 1, Epoch 19/20 => Loss 0.066, Train_accy 97.64:  95%|█████████▌| 19/20 [01:31<00:04,  4.68s/it]
Task 1, Epoch 20/20 => Loss 0.080, Train_accy 97.43, Test_accy 93.52:  95%|█████████▌| 19/20 [01:37<00:04,  4.68s/it]
Task 1, Epoch 20/20 => Loss 0.080, Train_accy 97.43, Test_accy 93.52: 100%|██████████| 20/20 [01:37<00:00,  5.20s/it]
Task 1, Epoch 20/20 => Loss 0.080, Train_accy 97.43, Test_accy 93.52: 100%|██████████| 20/20 [01:37<00:00,  4.89s/it]2024-09-13 18:42:53,669 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.080, Train_accy 97.43, Test_accy 93.52

2024-09-13 18:42:55,605 [trainer.py] => No NME accuracy.
2024-09-13 18:42:55,606 [trainer.py] => CNN: {'total': 93.52, '00-09': 89.83, '10-19': 96.9, 'old': 89.83, 'new': 96.9}
2024-09-13 18:42:55,606 [trainer.py] => CNN top1 curve: [100.0, 93.52]
2024-09-13 18:42:55,606 [trainer.py] => CNN top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 96.76
2024-09-13 18:42:55,606 [trainer.py] => Average Accuracy (CNN): 96.76 

2024-09-13 18:42:55,609 [trainer.py] => All params: 172158352
2024-09-13 18:42:55,612 [trainer.py] => Trainable params: 407240
2024-09-13 18:42:55,613 [dualprompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.217, Train_accy 65.76:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.217, Train_accy 65.76:   5%|▌         | 1/20 [00:04<01:25,  4.53s/it]
Task 2, Epoch 2/20 => Loss 0.166, Train_accy 96.64:   5%|▌         | 1/20 [00:09<01:25,  4.53s/it]
Task 2, Epoch 2/20 => Loss 0.166, Train_accy 96.64:  10%|█         | 2/20 [00:09<01:21,  4.52s/it]
Task 2, Epoch 3/20 => Loss 0.133, Train_accy 95.80:  10%|█         | 2/20 [00:13<01:21,  4.52s/it]
Task 2, Epoch 3/20 => Loss 0.133, Train_accy 95.80:  15%|█▌        | 3/20 [00:13<01:16,  4.51s/it]
Task 2, Epoch 4/20 => Loss 0.096, Train_accy 97.27:  15%|█▌        | 3/20 [00:18<01:16,  4.51s/it]
Task 2, Epoch 4/20 => Loss 0.096, Train_accy 97.27:  20%|██        | 4/20 [00:18<01:12,  4.53s/it]
Task 2, Epoch 5/20 => Loss 0.090, Train_accy 97.69, Test_accy 92.15:  20%|██        | 4/20 [00:25<01:12,  4.53s/it]
Task 2, Epoch 5/20 => Loss 0.090, Train_accy 97.69, Test_accy 92.15:  25%|██▌       | 5/20 [00:25<01:22,  5.51s/it]
Task 2, Epoch 6/20 => Loss 0.066, Train_accy 97.69:  25%|██▌       | 5/20 [00:29<01:22,  5.51s/it]                 
Task 2, Epoch 6/20 => Loss 0.066, Train_accy 97.69:  30%|███       | 6/20 [00:29<01:12,  5.18s/it]
Task 2, Epoch 7/20 => Loss 0.106, Train_accy 96.01:  30%|███       | 6/20 [00:34<01:12,  5.18s/it]
Task 2, Epoch 7/20 => Loss 0.106, Train_accy 96.01:  35%|███▌      | 7/20 [00:34<01:04,  4.99s/it]
Task 2, Epoch 8/20 => Loss 0.066, Train_accy 97.90:  35%|███▌      | 7/20 [00:39<01:04,  4.99s/it]
Task 2, Epoch 8/20 => Loss 0.066, Train_accy 97.90:  40%|████      | 8/20 [00:39<00:58,  4.85s/it]
Task 2, Epoch 9/20 => Loss 0.060, Train_accy 98.11:  40%|████      | 8/20 [00:43<00:58,  4.85s/it]
Task 2, Epoch 9/20 => Loss 0.060, Train_accy 98.11:  45%|████▌     | 9/20 [00:43<00:52,  4.75s/it]
Task 2, Epoch 10/20 => Loss 0.062, Train_accy 97.48, Test_accy 93.02:  45%|████▌     | 9/20 [00:50<00:52,  4.75s/it]
Task 2, Epoch 10/20 => Loss 0.062, Train_accy 97.48, Test_accy 93.02:  50%|█████     | 10/20 [00:50<00:54,  5.45s/it]
Task 2, Epoch 11/20 => Loss 0.093, Train_accy 96.22:  50%|█████     | 10/20 [00:55<00:54,  5.45s/it]                 
Task 2, Epoch 11/20 => Loss 0.093, Train_accy 96.22:  55%|█████▌    | 11/20 [00:55<00:46,  5.17s/it]
Task 2, Epoch 12/20 => Loss 0.037, Train_accy 98.95:  55%|█████▌    | 11/20 [00:59<00:46,  5.17s/it]
Task 2, Epoch 12/20 => Loss 0.037, Train_accy 98.95:  60%|██████    | 12/20 [00:59<00:39,  4.96s/it]
Task 2, Epoch 13/20 => Loss 0.037, Train_accy 98.53:  60%|██████    | 12/20 [01:04<00:39,  4.96s/it]
Task 2, Epoch 13/20 => Loss 0.037, Train_accy 98.53:  65%|██████▌   | 13/20 [01:04<00:33,  4.82s/it]
Task 2, Epoch 14/20 => Loss 0.046, Train_accy 98.32:  65%|██████▌   | 13/20 [01:08<00:33,  4.82s/it]
Task 2, Epoch 14/20 => Loss 0.046, Train_accy 98.32:  70%|███████   | 14/20 [01:08<00:28,  4.73s/it]
Task 2, Epoch 15/20 => Loss 0.040, Train_accy 98.53, Test_accy 93.90:  70%|███████   | 14/20 [01:15<00:28,  4.73s/it]
Task 2, Epoch 15/20 => Loss 0.040, Train_accy 98.53, Test_accy 93.90:  75%|███████▌  | 15/20 [01:15<00:27,  5.43s/it]
Task 2, Epoch 16/20 => Loss 0.058, Train_accy 98.11:  75%|███████▌  | 15/20 [01:20<00:27,  5.43s/it]                 
Task 2, Epoch 16/20 => Loss 0.058, Train_accy 98.11:  80%|████████  | 16/20 [01:20<00:20,  5.15s/it]
Task 2, Epoch 17/20 => Loss 0.046, Train_accy 98.32:  80%|████████  | 16/20 [01:24<00:20,  5.15s/it]
Task 2, Epoch 17/20 => Loss 0.046, Train_accy 98.32:  85%|████████▌ | 17/20 [01:24<00:14,  4.95s/it]
Task 2, Epoch 18/20 => Loss 0.046, Train_accy 97.90:  85%|████████▌ | 17/20 [01:29<00:14,  4.95s/it]
Task 2, Epoch 18/20 => Loss 0.046, Train_accy 97.90:  90%|█████████ | 18/20 [01:29<00:09,  4.83s/it]
Task 2, Epoch 19/20 => Loss 0.043, Train_accy 98.32:  90%|█████████ | 18/20 [01:33<00:09,  4.83s/it]
Task 2, Epoch 19/20 => Loss 0.043, Train_accy 98.32:  95%|█████████▌| 19/20 [01:33<00:04,  4.75s/it]
Task 2, Epoch 20/20 => Loss 0.029, Train_accy 98.32, Test_accy 94.19:  95%|█████████▌| 19/20 [01:40<00:04,  4.75s/it]
Task 2, Epoch 20/20 => Loss 0.029, Train_accy 98.32, Test_accy 94.19: 100%|██████████| 20/20 [01:40<00:00,  5.47s/it]
Task 2, Epoch 20/20 => Loss 0.029, Train_accy 98.32, Test_accy 94.19: 100%|██████████| 20/20 [01:40<00:00,  5.05s/it]2024-09-13 18:44:36,536 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.029, Train_accy 98.32, Test_accy 94.19

2024-09-13 18:44:39,223 [trainer.py] => No NME accuracy.
2024-09-13 18:44:39,223 [trainer.py] => CNN: {'total': 94.19, '00-09': 89.83, '10-19': 96.12, '20-29': 96.91, 'old': 93.12, 'new': 96.91}
2024-09-13 18:44:39,223 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19]
2024-09-13 18:44:39,223 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42]

Average Accuracy (CNN): 95.9
2024-09-13 18:44:39,224 [trainer.py] => Average Accuracy (CNN): 95.9 

2024-09-13 18:44:39,226 [trainer.py] => All params: 172158352
2024-09-13 18:44:39,229 [trainer.py] => Trainable params: 407240
2024-09-13 18:44:39,229 [dualprompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.224, Train_accy 63.11:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.224, Train_accy 63.11:   5%|▌         | 1/20 [00:04<01:24,  4.46s/it]
Task 3, Epoch 2/20 => Loss 0.288, Train_accy 91.26:   5%|▌         | 1/20 [00:08<01:24,  4.46s/it]
Task 3, Epoch 2/20 => Loss 0.288, Train_accy 91.26:  10%|█         | 2/20 [00:08<01:20,  4.50s/it]
Task 3, Epoch 3/20 => Loss 0.188, Train_accy 94.24:  10%|█         | 2/20 [00:13<01:20,  4.50s/it]
Task 3, Epoch 3/20 => Loss 0.188, Train_accy 94.24:  15%|█▌        | 3/20 [00:13<01:16,  4.48s/it]
Task 3, Epoch 4/20 => Loss 0.147, Train_accy 95.31:  15%|█▌        | 3/20 [00:17<01:16,  4.48s/it]
Task 3, Epoch 4/20 => Loss 0.147, Train_accy 95.31:  20%|██        | 4/20 [00:17<01:11,  4.48s/it]
Task 3, Epoch 5/20 => Loss 0.130, Train_accy 96.16, Test_accy 88.99:  20%|██        | 4/20 [00:25<01:11,  4.48s/it]
Task 3, Epoch 5/20 => Loss 0.130, Train_accy 96.16, Test_accy 88.99:  25%|██▌       | 5/20 [00:25<01:23,  5.58s/it]
Task 3, Epoch 6/20 => Loss 0.092, Train_accy 97.23:  25%|██▌       | 5/20 [00:29<01:23,  5.58s/it]                 
Task 3, Epoch 6/20 => Loss 0.092, Train_accy 97.23:  30%|███       | 6/20 [00:29<01:13,  5.22s/it]
Task 3, Epoch 7/20 => Loss 0.114, Train_accy 96.16:  30%|███       | 6/20 [00:34<01:13,  5.22s/it]
Task 3, Epoch 7/20 => Loss 0.114, Train_accy 96.16:  35%|███▌      | 7/20 [00:34<01:05,  5.03s/it]
Task 3, Epoch 8/20 => Loss 0.102, Train_accy 96.59:  35%|███▌      | 7/20 [00:39<01:05,  5.03s/it]
Task 3, Epoch 8/20 => Loss 0.102, Train_accy 96.59:  40%|████      | 8/20 [00:39<00:59,  4.93s/it]
Task 3, Epoch 9/20 => Loss 0.098, Train_accy 97.01:  40%|████      | 8/20 [00:43<00:59,  4.93s/it]
Task 3, Epoch 9/20 => Loss 0.098, Train_accy 97.01:  45%|████▌     | 9/20 [00:43<00:52,  4.78s/it]
Task 3, Epoch 10/20 => Loss 0.073, Train_accy 97.65, Test_accy 90.09:  45%|████▌     | 9/20 [00:51<00:52,  4.78s/it]
Task 3, Epoch 10/20 => Loss 0.073, Train_accy 97.65, Test_accy 90.09:  50%|█████     | 10/20 [00:51<00:56,  5.63s/it]
Task 3, Epoch 11/20 => Loss 0.075, Train_accy 97.87:  50%|█████     | 10/20 [00:55<00:56,  5.63s/it]                 
Task 3, Epoch 11/20 => Loss 0.075, Train_accy 97.87:  55%|█████▌    | 11/20 [00:55<00:47,  5.26s/it]
Task 3, Epoch 12/20 => Loss 0.088, Train_accy 96.80:  55%|█████▌    | 11/20 [01:00<00:47,  5.26s/it]
Task 3, Epoch 12/20 => Loss 0.088, Train_accy 96.80:  60%|██████    | 12/20 [01:00<00:40,  5.03s/it]
Task 3, Epoch 13/20 => Loss 0.071, Train_accy 97.87:  60%|██████    | 12/20 [01:04<00:40,  5.03s/it]
Task 3, Epoch 13/20 => Loss 0.071, Train_accy 97.87:  65%|██████▌   | 13/20 [01:04<00:34,  4.92s/it]
Task 3, Epoch 14/20 => Loss 0.074, Train_accy 97.65:  65%|██████▌   | 13/20 [01:09<00:34,  4.92s/it]
Task 3, Epoch 14/20 => Loss 0.074, Train_accy 97.65:  70%|███████   | 14/20 [01:09<00:28,  4.78s/it]
Task 3, Epoch 15/20 => Loss 0.071, Train_accy 97.23, Test_accy 90.53:  70%|███████   | 14/20 [01:16<00:28,  4.78s/it]
Task 3, Epoch 15/20 => Loss 0.071, Train_accy 97.23, Test_accy 90.53:  75%|███████▌  | 15/20 [01:16<00:28,  5.62s/it]
Task 3, Epoch 16/20 => Loss 0.089, Train_accy 95.95:  75%|███████▌  | 15/20 [01:21<00:28,  5.62s/it]                 
Task 3, Epoch 16/20 => Loss 0.089, Train_accy 95.95:  80%|████████  | 16/20 [01:21<00:21,  5.32s/it]
Task 3, Epoch 17/20 => Loss 0.069, Train_accy 97.44:  80%|████████  | 16/20 [01:26<00:21,  5.32s/it]
Task 3, Epoch 17/20 => Loss 0.069, Train_accy 97.44:  85%|████████▌ | 17/20 [01:26<00:15,  5.10s/it]
Task 3, Epoch 18/20 => Loss 0.067, Train_accy 97.44:  85%|████████▌ | 17/20 [01:30<00:15,  5.10s/it]
Task 3, Epoch 18/20 => Loss 0.067, Train_accy 97.44:  90%|█████████ | 18/20 [01:30<00:09,  4.97s/it]
Task 3, Epoch 19/20 => Loss 0.056, Train_accy 98.51:  90%|█████████ | 18/20 [01:35<00:09,  4.97s/it]
Task 3, Epoch 19/20 => Loss 0.056, Train_accy 98.51:  95%|█████████▌| 19/20 [01:35<00:04,  4.81s/it]
Task 3, Epoch 20/20 => Loss 0.073, Train_accy 97.23, Test_accy 91.63:  95%|█████████▌| 19/20 [01:42<00:04,  4.81s/it]
Task 3, Epoch 20/20 => Loss 0.073, Train_accy 97.23, Test_accy 91.63: 100%|██████████| 20/20 [01:42<00:00,  5.64s/it]
Task 3, Epoch 20/20 => Loss 0.073, Train_accy 97.23, Test_accy 91.63: 100%|██████████| 20/20 [01:42<00:00,  5.14s/it]2024-09-13 18:46:22,054 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.073, Train_accy 97.23, Test_accy 91.63

2024-09-13 18:46:25,278 [trainer.py] => No NME accuracy.
2024-09-13 18:46:25,278 [trainer.py] => CNN: {'total': 91.63, '00-09': 88.98, '10-19': 93.8, '20-29': 95.88, '30-39': 88.18, 'old': 92.73, 'new': 88.18}
2024-09-13 18:46:25,278 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63]
2024-09-13 18:46:25,278 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34]

Average Accuracy (CNN): 94.84
2024-09-13 18:46:25,278 [trainer.py] => Average Accuracy (CNN): 94.84 

2024-09-13 18:46:25,280 [trainer.py] => All params: 172158352
2024-09-13 18:46:25,282 [trainer.py] => Trainable params: 407240
2024-09-13 18:46:25,282 [dualprompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.264, Train_accy 61.83:   0%|          | 0/20 [00:04<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.264, Train_accy 61.83:   5%|▌         | 1/20 [00:04<01:25,  4.49s/it]
Task 4, Epoch 2/20 => Loss 0.327, Train_accy 90.41:   5%|▌         | 1/20 [00:09<01:25,  4.49s/it]
Task 4, Epoch 2/20 => Loss 0.327, Train_accy 90.41:  10%|█         | 2/20 [00:09<01:22,  4.56s/it]
Task 4, Epoch 3/20 => Loss 0.208, Train_accy 92.75:  10%|█         | 2/20 [00:13<01:22,  4.56s/it]
Task 4, Epoch 3/20 => Loss 0.208, Train_accy 92.75:  15%|█▌        | 3/20 [00:13<01:16,  4.51s/it]
Task 4, Epoch 4/20 => Loss 0.142, Train_accy 95.10:  15%|█▌        | 3/20 [00:18<01:16,  4.51s/it]
Task 4, Epoch 4/20 => Loss 0.142, Train_accy 95.10:  20%|██        | 4/20 [00:18<01:12,  4.52s/it]
Task 4, Epoch 5/20 => Loss 0.144, Train_accy 94.67, Test_accy 91.27:  20%|██        | 4/20 [00:26<01:12,  4.52s/it]
Task 4, Epoch 5/20 => Loss 0.144, Train_accy 94.67, Test_accy 91.27:  25%|██▌       | 5/20 [00:26<01:29,  5.94s/it]
Task 4, Epoch 6/20 => Loss 0.143, Train_accy 94.46:  25%|██▌       | 5/20 [00:31<01:29,  5.94s/it]                 
Task 4, Epoch 6/20 => Loss 0.143, Train_accy 94.46:  30%|███       | 6/20 [00:31<01:16,  5.50s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 94.24:  30%|███       | 6/20 [00:35<01:16,  5.50s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 94.24:  35%|███▌      | 7/20 [00:35<01:06,  5.14s/it]
Task 4, Epoch 8/20 => Loss 0.120, Train_accy 95.52:  35%|███▌      | 7/20 [00:40<01:06,  5.14s/it]
Task 4, Epoch 8/20 => Loss 0.120, Train_accy 95.52:  40%|████      | 8/20 [00:40<00:59,  4.94s/it]
Task 4, Epoch 9/20 => Loss 0.113, Train_accy 95.74:  40%|████      | 8/20 [00:44<00:59,  4.94s/it]
Task 4, Epoch 9/20 => Loss 0.113, Train_accy 95.74:  45%|████▌     | 9/20 [00:44<00:52,  4.78s/it]
Task 4, Epoch 10/20 => Loss 0.132, Train_accy 96.38, Test_accy 91.80:  45%|████▌     | 9/20 [00:52<00:52,  4.78s/it]
Task 4, Epoch 10/20 => Loss 0.132, Train_accy 96.38, Test_accy 91.80:  50%|█████     | 10/20 [00:52<00:58,  5.85s/it]
Task 4, Epoch 11/20 => Loss 0.083, Train_accy 96.59:  50%|█████     | 10/20 [00:57<00:58,  5.85s/it]                 
Task 4, Epoch 11/20 => Loss 0.083, Train_accy 96.59:  55%|█████▌    | 11/20 [00:57<00:48,  5.42s/it]
Task 4, Epoch 12/20 => Loss 0.114, Train_accy 95.10:  55%|█████▌    | 11/20 [01:01<00:48,  5.42s/it]
Task 4, Epoch 12/20 => Loss 0.114, Train_accy 95.10:  60%|██████    | 12/20 [01:01<00:40,  5.12s/it]
Task 4, Epoch 13/20 => Loss 0.100, Train_accy 96.80:  60%|██████    | 12/20 [01:06<00:40,  5.12s/it]
Task 4, Epoch 13/20 => Loss 0.100, Train_accy 96.80:  65%|██████▌   | 13/20 [01:06<00:34,  4.96s/it]
Task 4, Epoch 14/20 => Loss 0.103, Train_accy 96.38:  65%|██████▌   | 13/20 [01:10<00:34,  4.96s/it]
Task 4, Epoch 14/20 => Loss 0.103, Train_accy 96.38:  70%|███████   | 14/20 [01:10<00:28,  4.83s/it]
Task 4, Epoch 15/20 => Loss 0.118, Train_accy 96.38, Test_accy 91.44:  70%|███████   | 14/20 [01:18<00:28,  4.83s/it]
Task 4, Epoch 15/20 => Loss 0.118, Train_accy 96.38, Test_accy 91.44:  75%|███████▌  | 15/20 [01:18<00:29,  5.83s/it]
Task 4, Epoch 16/20 => Loss 0.085, Train_accy 97.01:  75%|███████▌  | 15/20 [01:23<00:29,  5.83s/it]                 
Task 4, Epoch 16/20 => Loss 0.085, Train_accy 97.01:  80%|████████  | 16/20 [01:23<00:21,  5.43s/it]
Task 4, Epoch 17/20 => Loss 0.089, Train_accy 96.80:  80%|████████  | 16/20 [01:27<00:21,  5.43s/it]
Task 4, Epoch 17/20 => Loss 0.089, Train_accy 96.80:  85%|████████▌ | 17/20 [01:27<00:15,  5.13s/it]
Task 4, Epoch 18/20 => Loss 0.097, Train_accy 95.95:  85%|████████▌ | 17/20 [01:32<00:15,  5.13s/it]
Task 4, Epoch 18/20 => Loss 0.097, Train_accy 95.95:  90%|█████████ | 18/20 [01:32<00:09,  4.95s/it]
Task 4, Epoch 19/20 => Loss 0.125, Train_accy 95.95:  90%|█████████ | 18/20 [01:36<00:09,  4.95s/it]
Task 4, Epoch 19/20 => Loss 0.125, Train_accy 95.95:  95%|█████████▌| 19/20 [01:36<00:04,  4.82s/it]
Task 4, Epoch 20/20 => Loss 0.097, Train_accy 96.16, Test_accy 91.80:  95%|█████████▌| 19/20 [01:44<00:04,  4.82s/it]
Task 4, Epoch 20/20 => Loss 0.097, Train_accy 96.16, Test_accy 91.80: 100%|██████████| 20/20 [01:44<00:00,  5.80s/it]
Task 4, Epoch 20/20 => Loss 0.097, Train_accy 96.16, Test_accy 91.80: 100%|██████████| 20/20 [01:44<00:00,  5.25s/it]2024-09-13 18:48:10,288 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.097, Train_accy 96.16, Test_accy 91.80

2024-09-13 18:48:14,031 [trainer.py] => No NME accuracy.
2024-09-13 18:48:14,031 [trainer.py] => CNN: {'total': 91.8, '00-09': 88.14, '10-19': 94.57, '20-29': 95.88, '30-39': 88.18, '40-49': 92.52, 'old': 91.63, 'new': 92.52}
2024-09-13 18:48:14,032 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8]
2024-09-13 18:48:14,032 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47]

Average Accuracy (CNN): 94.23
2024-09-13 18:48:14,032 [trainer.py] => Average Accuracy (CNN): 94.23 

2024-09-13 18:48:14,035 [trainer.py] => All params: 172158352
2024-09-13 18:48:14,037 [trainer.py] => Trainable params: 407240
2024-09-13 18:48:14,037 [dualprompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.718, Train_accy 47.89:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.718, Train_accy 47.89:   5%|▌         | 1/20 [00:04<01:24,  4.47s/it]
Task 5, Epoch 2/20 => Loss 0.378, Train_accy 89.24:   5%|▌         | 1/20 [00:08<01:24,  4.47s/it]
Task 5, Epoch 2/20 => Loss 0.378, Train_accy 89.24:  10%|█         | 2/20 [00:08<01:20,  4.46s/it]
Task 5, Epoch 3/20 => Loss 0.216, Train_accy 93.88:  10%|█         | 2/20 [00:13<01:20,  4.46s/it]
Task 5, Epoch 3/20 => Loss 0.216, Train_accy 93.88:  15%|█▌        | 3/20 [00:13<01:16,  4.51s/it]
Task 5, Epoch 4/20 => Loss 0.181, Train_accy 94.94:  15%|█▌        | 3/20 [00:18<01:16,  4.51s/it]
Task 5, Epoch 4/20 => Loss 0.181, Train_accy 94.94:  20%|██        | 4/20 [00:18<01:12,  4.55s/it]
Task 5, Epoch 5/20 => Loss 0.190, Train_accy 93.46, Test_accy 87.50:  20%|██        | 4/20 [00:27<01:12,  4.55s/it]
Task 5, Epoch 5/20 => Loss 0.190, Train_accy 93.46, Test_accy 87.50:  25%|██▌       | 5/20 [00:27<01:31,  6.12s/it]
Task 5, Epoch 6/20 => Loss 0.174, Train_accy 94.30:  25%|██▌       | 5/20 [00:31<01:31,  6.12s/it]                 
Task 5, Epoch 6/20 => Loss 0.174, Train_accy 94.30:  30%|███       | 6/20 [00:31<01:18,  5.58s/it]
Task 5, Epoch 7/20 => Loss 0.140, Train_accy 95.15:  30%|███       | 6/20 [00:36<01:18,  5.58s/it]
Task 5, Epoch 7/20 => Loss 0.140, Train_accy 95.15:  35%|███▌      | 7/20 [00:36<01:08,  5.23s/it]
Task 5, Epoch 8/20 => Loss 0.159, Train_accy 95.78:  35%|███▌      | 7/20 [00:40<01:08,  5.23s/it]
Task 5, Epoch 8/20 => Loss 0.159, Train_accy 95.78:  40%|████      | 8/20 [00:40<00:59,  4.98s/it]
Task 5, Epoch 9/20 => Loss 0.104, Train_accy 96.84:  40%|████      | 8/20 [00:45<00:59,  4.98s/it]
Task 5, Epoch 9/20 => Loss 0.104, Train_accy 96.84:  45%|████▌     | 9/20 [00:45<00:53,  4.87s/it]
Task 5, Epoch 10/20 => Loss 0.141, Train_accy 95.36, Test_accy 88.54:  45%|████▌     | 9/20 [00:54<00:53,  4.87s/it]
Task 5, Epoch 10/20 => Loss 0.141, Train_accy 95.36, Test_accy 88.54:  50%|█████     | 10/20 [00:54<01:01,  6.20s/it]
Task 5, Epoch 11/20 => Loss 0.150, Train_accy 94.73:  50%|█████     | 10/20 [00:58<01:01,  6.20s/it]                 
Task 5, Epoch 11/20 => Loss 0.150, Train_accy 94.73:  55%|█████▌    | 11/20 [00:58<00:51,  5.67s/it]
Task 5, Epoch 12/20 => Loss 0.161, Train_accy 95.36:  55%|█████▌    | 11/20 [01:03<00:51,  5.67s/it]
Task 5, Epoch 12/20 => Loss 0.161, Train_accy 95.36:  60%|██████    | 12/20 [01:03<00:42,  5.31s/it]
Task 5, Epoch 13/20 => Loss 0.133, Train_accy 95.15:  60%|██████    | 12/20 [01:07<00:42,  5.31s/it]
Task 5, Epoch 13/20 => Loss 0.133, Train_accy 95.15:  65%|██████▌   | 13/20 [01:07<00:35,  5.09s/it]
Task 5, Epoch 14/20 => Loss 0.114, Train_accy 95.15:  65%|██████▌   | 13/20 [01:12<00:35,  5.09s/it]
Task 5, Epoch 14/20 => Loss 0.114, Train_accy 95.15:  70%|███████   | 14/20 [01:12<00:29,  4.95s/it]
Task 5, Epoch 15/20 => Loss 0.071, Train_accy 97.68, Test_accy 88.99:  70%|███████   | 14/20 [01:21<00:29,  4.95s/it]
Task 5, Epoch 15/20 => Loss 0.071, Train_accy 97.68, Test_accy 88.99:  75%|███████▌  | 15/20 [01:21<00:30,  6.11s/it]
Task 5, Epoch 16/20 => Loss 0.084, Train_accy 96.84:  75%|███████▌  | 15/20 [01:25<00:30,  6.11s/it]                 
Task 5, Epoch 16/20 => Loss 0.084, Train_accy 96.84:  80%|████████  | 16/20 [01:25<00:22,  5.65s/it]
Task 5, Epoch 17/20 => Loss 0.118, Train_accy 95.36:  80%|████████  | 16/20 [01:30<00:22,  5.65s/it]
Task 5, Epoch 17/20 => Loss 0.118, Train_accy 95.36:  85%|████████▌ | 17/20 [01:30<00:15,  5.30s/it]
Task 5, Epoch 18/20 => Loss 0.101, Train_accy 95.78:  85%|████████▌ | 17/20 [01:34<00:15,  5.30s/it]
Task 5, Epoch 18/20 => Loss 0.101, Train_accy 95.78:  90%|█████████ | 18/20 [01:34<00:10,  5.05s/it]
Task 5, Epoch 19/20 => Loss 0.095, Train_accy 96.20:  90%|█████████ | 18/20 [01:39<00:10,  5.05s/it]
Task 5, Epoch 19/20 => Loss 0.095, Train_accy 96.20:  95%|█████████▌| 19/20 [01:39<00:04,  4.91s/it]
Task 5, Epoch 20/20 => Loss 0.089, Train_accy 96.84, Test_accy 89.14:  95%|█████████▌| 19/20 [01:48<00:04,  4.91s/it]
Task 5, Epoch 20/20 => Loss 0.089, Train_accy 96.84, Test_accy 89.14: 100%|██████████| 20/20 [01:48<00:00,  6.08s/it]
Task 5, Epoch 20/20 => Loss 0.089, Train_accy 96.84, Test_accy 89.14: 100%|██████████| 20/20 [01:48<00:00,  5.41s/it]2024-09-13 18:50:02,238 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.089, Train_accy 96.84, Test_accy 89.14

2024-09-13 18:50:06,622 [trainer.py] => No NME accuracy.
2024-09-13 18:50:06,623 [trainer.py] => CNN: {'total': 89.14, '00-09': 87.29, '10-19': 95.35, '20-29': 95.88, '30-39': 87.27, '40-49': 92.52, '50-59': 76.58, 'old': 91.62, 'new': 76.58}
2024-09-13 18:50:06,623 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14]
2024-09-13 18:50:06,623 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11]

Average Accuracy (CNN): 93.38
2024-09-13 18:50:06,623 [trainer.py] => Average Accuracy (CNN): 93.38 

2024-09-13 18:50:06,626 [trainer.py] => All params: 172158352
2024-09-13 18:50:06,628 [trainer.py] => Trainable params: 407240
2024-09-13 18:50:06,628 [dualprompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.211, Train_accy 60.99:   0%|          | 0/20 [00:04<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.211, Train_accy 60.99:   5%|▌         | 1/20 [00:04<01:27,  4.61s/it]
Task 6, Epoch 2/20 => Loss 0.289, Train_accy 91.58:   5%|▌         | 1/20 [00:09<01:27,  4.61s/it]
Task 6, Epoch 2/20 => Loss 0.289, Train_accy 91.58:  10%|█         | 2/20 [00:09<01:24,  4.67s/it]
Task 6, Epoch 3/20 => Loss 0.155, Train_accy 95.28:  10%|█         | 2/20 [00:13<01:24,  4.67s/it]
Task 6, Epoch 3/20 => Loss 0.155, Train_accy 95.28:  15%|█▌        | 3/20 [00:13<01:18,  4.63s/it]
Task 6, Epoch 4/20 => Loss 0.189, Train_accy 93.22:  15%|█▌        | 3/20 [00:18<01:18,  4.63s/it]
Task 6, Epoch 4/20 => Loss 0.189, Train_accy 93.22:  20%|██        | 4/20 [00:18<01:14,  4.69s/it]
Task 6, Epoch 5/20 => Loss 0.139, Train_accy 95.07, Test_accy 84.19:  20%|██        | 4/20 [00:28<01:14,  4.69s/it]
Task 6, Epoch 5/20 => Loss 0.139, Train_accy 95.07, Test_accy 84.19:  25%|██▌       | 5/20 [00:28<01:36,  6.43s/it]
Task 6, Epoch 6/20 => Loss 0.205, Train_accy 94.25:  25%|██▌       | 5/20 [00:32<01:36,  6.43s/it]                 
Task 6, Epoch 6/20 => Loss 0.205, Train_accy 94.25:  30%|███       | 6/20 [00:32<01:21,  5.80s/it]
Task 6, Epoch 7/20 => Loss 0.121, Train_accy 96.30:  30%|███       | 6/20 [00:37<01:21,  5.80s/it]
Task 6, Epoch 7/20 => Loss 0.121, Train_accy 96.30:  35%|███▌      | 7/20 [00:37<01:10,  5.40s/it]
Task 6, Epoch 8/20 => Loss 0.132, Train_accy 95.07:  35%|███▌      | 7/20 [00:42<01:10,  5.40s/it]
Task 6, Epoch 8/20 => Loss 0.132, Train_accy 95.07:  40%|████      | 8/20 [00:42<01:02,  5.19s/it]
Task 6, Epoch 9/20 => Loss 0.112, Train_accy 95.89:  40%|████      | 8/20 [00:46<01:02,  5.19s/it]
Task 6, Epoch 9/20 => Loss 0.112, Train_accy 95.89:  45%|████▌     | 9/20 [00:46<00:55,  5.01s/it]
Task 6, Epoch 10/20 => Loss 0.120, Train_accy 95.89, Test_accy 85.48:  45%|████▌     | 9/20 [00:56<00:55,  5.01s/it]
Task 6, Epoch 10/20 => Loss 0.120, Train_accy 95.89, Test_accy 85.48:  50%|█████     | 10/20 [00:56<01:04,  6.45s/it]
Task 6, Epoch 11/20 => Loss 0.092, Train_accy 97.13:  50%|█████     | 10/20 [01:01<01:04,  6.45s/it]                 
Task 6, Epoch 11/20 => Loss 0.092, Train_accy 97.13:  55%|█████▌    | 11/20 [01:01<00:53,  5.90s/it]
Task 6, Epoch 12/20 => Loss 0.090, Train_accy 96.30:  55%|█████▌    | 11/20 [01:05<00:53,  5.90s/it]
Task 6, Epoch 12/20 => Loss 0.090, Train_accy 96.30:  60%|██████    | 12/20 [01:05<00:44,  5.54s/it]
Task 6, Epoch 13/20 => Loss 0.122, Train_accy 95.48:  60%|██████    | 12/20 [01:10<00:44,  5.54s/it]
Task 6, Epoch 13/20 => Loss 0.122, Train_accy 95.48:  65%|██████▌   | 13/20 [01:10<00:36,  5.26s/it]
Task 6, Epoch 14/20 => Loss 0.088, Train_accy 96.71:  65%|██████▌   | 13/20 [01:15<00:36,  5.26s/it]
Task 6, Epoch 14/20 => Loss 0.088, Train_accy 96.71:  70%|███████   | 14/20 [01:15<00:30,  5.08s/it]
Task 6, Epoch 15/20 => Loss 0.076, Train_accy 97.33, Test_accy 85.60:  70%|███████   | 14/20 [01:24<00:30,  5.08s/it]
Task 6, Epoch 15/20 => Loss 0.076, Train_accy 97.33, Test_accy 85.60:  75%|███████▌  | 15/20 [01:24<00:32,  6.47s/it]
Task 6, Epoch 16/20 => Loss 0.141, Train_accy 97.13:  75%|███████▌  | 15/20 [01:29<00:32,  6.47s/it]                 
Task 6, Epoch 16/20 => Loss 0.141, Train_accy 97.13:  80%|████████  | 16/20 [01:29<00:23,  5.93s/it]
Task 6, Epoch 17/20 => Loss 0.075, Train_accy 96.92:  80%|████████  | 16/20 [01:33<00:23,  5.93s/it]
Task 6, Epoch 17/20 => Loss 0.075, Train_accy 96.92:  85%|████████▌ | 17/20 [01:33<00:16,  5.52s/it]
Task 6, Epoch 18/20 => Loss 0.092, Train_accy 96.10:  85%|████████▌ | 17/20 [01:38<00:16,  5.52s/it]
Task 6, Epoch 18/20 => Loss 0.092, Train_accy 96.10:  90%|█████████ | 18/20 [01:38<00:10,  5.31s/it]
Task 6, Epoch 19/20 => Loss 0.091, Train_accy 96.10:  90%|█████████ | 18/20 [01:43<00:10,  5.31s/it]
Task 6, Epoch 19/20 => Loss 0.091, Train_accy 96.10:  95%|█████████▌| 19/20 [01:43<00:05,  5.09s/it]
Task 6, Epoch 20/20 => Loss 0.068, Train_accy 97.74, Test_accy 85.73:  95%|█████████▌| 19/20 [01:53<00:05,  5.09s/it]
Task 6, Epoch 20/20 => Loss 0.068, Train_accy 97.74, Test_accy 85.73: 100%|██████████| 20/20 [01:53<00:00,  6.48s/it]
Task 6, Epoch 20/20 => Loss 0.068, Train_accy 97.74, Test_accy 85.73: 100%|██████████| 20/20 [01:53<00:00,  5.65s/it]2024-09-13 18:51:59,699 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.068, Train_accy 97.74, Test_accy 85.73

2024-09-13 18:52:04,650 [trainer.py] => No NME accuracy.
2024-09-13 18:52:04,651 [trainer.py] => CNN: {'total': 85.73, '00-09': 87.29, '10-19': 92.25, '20-29': 95.88, '30-39': 85.45, '40-49': 91.59, '50-59': 76.58, '60-69': 70.75, 'old': 88.1, 'new': 70.75}
2024-09-13 18:52:04,651 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73]
2024-09-13 18:52:04,651 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71]

Average Accuracy (CNN): 92.29
2024-09-13 18:52:04,651 [trainer.py] => Average Accuracy (CNN): 92.29 

2024-09-13 18:52:04,654 [trainer.py] => All params: 172158352
2024-09-13 18:52:04,657 [trainer.py] => Trainable params: 407240
2024-09-13 18:52:04,657 [dualprompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.213, Train_accy 62.96:   0%|          | 0/20 [00:04<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.213, Train_accy 62.96:   5%|▌         | 1/20 [00:04<01:24,  4.45s/it]
Task 7, Epoch 2/20 => Loss 0.186, Train_accy 94.99:   5%|▌         | 1/20 [00:08<01:24,  4.45s/it]
Task 7, Epoch 2/20 => Loss 0.186, Train_accy 94.99:  10%|█         | 2/20 [00:08<01:19,  4.41s/it]
Task 7, Epoch 3/20 => Loss 0.127, Train_accy 96.30:  10%|█         | 2/20 [00:13<01:19,  4.41s/it]
Task 7, Epoch 3/20 => Loss 0.127, Train_accy 96.30:  15%|█▌        | 3/20 [00:13<01:14,  4.40s/it]
Task 7, Epoch 4/20 => Loss 0.107, Train_accy 96.73:  15%|█▌        | 3/20 [00:17<01:14,  4.40s/it]
Task 7, Epoch 4/20 => Loss 0.107, Train_accy 96.73:  20%|██        | 4/20 [00:17<01:10,  4.39s/it]
Task 7, Epoch 5/20 => Loss 0.073, Train_accy 97.17, Test_accy 85.53:  20%|██        | 4/20 [00:27<01:10,  4.39s/it]
Task 7, Epoch 5/20 => Loss 0.073, Train_accy 97.17, Test_accy 85.53:  25%|██▌       | 5/20 [00:27<01:37,  6.49s/it]
Task 7, Epoch 6/20 => Loss 0.103, Train_accy 96.08:  25%|██▌       | 5/20 [00:32<01:37,  6.49s/it]                 
Task 7, Epoch 6/20 => Loss 0.103, Train_accy 96.08:  30%|███       | 6/20 [00:32<01:20,  5.78s/it]
Task 7, Epoch 7/20 => Loss 0.070, Train_accy 97.39:  30%|███       | 6/20 [00:36<01:20,  5.78s/it]
Task 7, Epoch 7/20 => Loss 0.070, Train_accy 97.39:  35%|███▌      | 7/20 [00:36<01:09,  5.33s/it]
Task 7, Epoch 8/20 => Loss 0.087, Train_accy 97.17:  35%|███▌      | 7/20 [00:41<01:09,  5.33s/it]
Task 7, Epoch 8/20 => Loss 0.087, Train_accy 97.17:  40%|████      | 8/20 [00:41<01:00,  5.06s/it]
Task 7, Epoch 9/20 => Loss 0.085, Train_accy 96.73:  40%|████      | 8/20 [00:45<01:00,  5.06s/it]
Task 7, Epoch 9/20 => Loss 0.085, Train_accy 96.73:  45%|████▌     | 9/20 [00:45<00:53,  4.84s/it]
Task 7, Epoch 10/20 => Loss 0.089, Train_accy 97.39, Test_accy 85.75:  45%|████▌     | 9/20 [00:55<00:53,  4.84s/it]
Task 7, Epoch 10/20 => Loss 0.089, Train_accy 97.39, Test_accy 85.75:  50%|█████     | 10/20 [00:55<01:04,  6.44s/it]
Task 7, Epoch 11/20 => Loss 0.091, Train_accy 96.30:  50%|█████     | 10/20 [00:59<01:04,  6.44s/it]                 
Task 7, Epoch 11/20 => Loss 0.091, Train_accy 96.30:  55%|█████▌    | 11/20 [00:59<00:52,  5.85s/it]
Task 7, Epoch 12/20 => Loss 0.069, Train_accy 97.39:  55%|█████▌    | 11/20 [01:04<00:52,  5.85s/it]
Task 7, Epoch 12/20 => Loss 0.069, Train_accy 97.39:  60%|██████    | 12/20 [01:04<00:43,  5.40s/it]
Task 7, Epoch 13/20 => Loss 0.066, Train_accy 97.17:  60%|██████    | 12/20 [01:08<00:43,  5.40s/it]
Task 7, Epoch 13/20 => Loss 0.066, Train_accy 97.17:  65%|██████▌   | 13/20 [01:08<00:35,  5.08s/it]
Task 7, Epoch 14/20 => Loss 0.070, Train_accy 97.39:  65%|██████▌   | 13/20 [01:13<00:35,  5.08s/it]
Task 7, Epoch 14/20 => Loss 0.070, Train_accy 97.39:  70%|███████   | 14/20 [01:13<00:29,  4.86s/it]
Task 7, Epoch 15/20 => Loss 0.096, Train_accy 96.08, Test_accy 86.18:  70%|███████   | 14/20 [01:23<00:29,  4.86s/it]
Task 7, Epoch 15/20 => Loss 0.096, Train_accy 96.08, Test_accy 86.18:  75%|███████▌  | 15/20 [01:23<00:32,  6.43s/it]
Task 7, Epoch 16/20 => Loss 0.081, Train_accy 96.73:  75%|███████▌  | 15/20 [01:27<00:32,  6.43s/it]                 
Task 7, Epoch 16/20 => Loss 0.081, Train_accy 96.73:  80%|████████  | 16/20 [01:27<00:23,  5.81s/it]
Task 7, Epoch 17/20 => Loss 0.090, Train_accy 96.95:  80%|████████  | 16/20 [01:31<00:23,  5.81s/it]
Task 7, Epoch 17/20 => Loss 0.090, Train_accy 96.95:  85%|████████▌ | 17/20 [01:31<00:16,  5.37s/it]
Task 7, Epoch 18/20 => Loss 0.052, Train_accy 97.60:  85%|████████▌ | 17/20 [01:36<00:16,  5.37s/it]
Task 7, Epoch 18/20 => Loss 0.052, Train_accy 97.60:  90%|█████████ | 18/20 [01:36<00:10,  5.06s/it]
Task 7, Epoch 19/20 => Loss 0.046, Train_accy 97.82:  90%|█████████ | 18/20 [01:40<00:10,  5.06s/it]
Task 7, Epoch 19/20 => Loss 0.046, Train_accy 97.82:  95%|█████████▌| 19/20 [01:40<00:04,  4.86s/it]
Task 7, Epoch 20/20 => Loss 0.057, Train_accy 97.60, Test_accy 86.07:  95%|█████████▌| 19/20 [01:50<00:04,  4.86s/it]
Task 7, Epoch 20/20 => Loss 0.057, Train_accy 97.60, Test_accy 86.07: 100%|██████████| 20/20 [01:50<00:00,  6.46s/it]
Task 7, Epoch 20/20 => Loss 0.057, Train_accy 97.60, Test_accy 86.07: 100%|██████████| 20/20 [01:50<00:00,  5.54s/it]2024-09-13 18:53:55,439 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.057, Train_accy 97.60, Test_accy 86.07

2024-09-13 18:54:01,108 [trainer.py] => No NME accuracy.
2024-09-13 18:54:01,109 [trainer.py] => CNN: {'total': 86.07, '00-09': 87.29, '10-19': 92.25, '20-29': 94.85, '30-39': 81.82, '40-49': 91.59, '50-59': 76.58, '60-69': 69.81, '70-79': 92.2, 'old': 84.96, 'new': 92.2}
2024-09-13 18:54:01,109 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07]
2024-09-13 18:54:01,109 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69]

Average Accuracy (CNN): 91.51
2024-09-13 18:54:01,109 [trainer.py] => Average Accuracy (CNN): 91.51 

2024-09-13 18:54:01,112 [trainer.py] => All params: 172158352
2024-09-13 18:54:01,114 [trainer.py] => Trainable params: 407240
2024-09-13 18:54:01,114 [dualprompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.476, Train_accy 52.93:   0%|          | 0/20 [00:04<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.476, Train_accy 52.93:   5%|▌         | 1/20 [00:04<01:24,  4.42s/it]
Task 8, Epoch 2/20 => Loss 0.320, Train_accy 91.32:   5%|▌         | 1/20 [00:08<01:24,  4.42s/it]
Task 8, Epoch 2/20 => Loss 0.320, Train_accy 91.32:  10%|█         | 2/20 [00:08<01:19,  4.43s/it]
Task 8, Epoch 3/20 => Loss 0.216, Train_accy 93.71:  10%|█         | 2/20 [00:13<01:19,  4.43s/it]
Task 8, Epoch 3/20 => Loss 0.216, Train_accy 93.71:  15%|█▌        | 3/20 [00:13<01:16,  4.47s/it]
Task 8, Epoch 4/20 => Loss 0.162, Train_accy 95.66:  15%|█▌        | 3/20 [00:17<01:16,  4.47s/it]
Task 8, Epoch 4/20 => Loss 0.162, Train_accy 95.66:  20%|██        | 4/20 [00:17<01:11,  4.49s/it]
Task 8, Epoch 5/20 => Loss 0.166, Train_accy 95.01, Test_accy 85.36:  20%|██        | 4/20 [00:28<01:11,  4.49s/it]
Task 8, Epoch 5/20 => Loss 0.166, Train_accy 95.01, Test_accy 85.36:  25%|██▌       | 5/20 [00:28<01:41,  6.76s/it]
Task 8, Epoch 6/20 => Loss 0.147, Train_accy 95.23:  25%|██▌       | 5/20 [00:33<01:41,  6.76s/it]                 
Task 8, Epoch 6/20 => Loss 0.147, Train_accy 95.23:  30%|███       | 6/20 [00:33<01:23,  5.96s/it]
Task 8, Epoch 7/20 => Loss 0.117, Train_accy 96.53:  30%|███       | 6/20 [00:37<01:23,  5.96s/it]
Task 8, Epoch 7/20 => Loss 0.117, Train_accy 96.53:  35%|███▌      | 7/20 [00:37<01:10,  5.45s/it]
Task 8, Epoch 8/20 => Loss 0.127, Train_accy 95.23:  35%|███▌      | 7/20 [00:41<01:10,  5.45s/it]
Task 8, Epoch 8/20 => Loss 0.127, Train_accy 95.23:  40%|████      | 8/20 [00:41<01:01,  5.14s/it]
Task 8, Epoch 9/20 => Loss 0.088, Train_accy 97.18:  40%|████      | 8/20 [00:46<01:01,  5.14s/it]
Task 8, Epoch 9/20 => Loss 0.088, Train_accy 97.18:  45%|████▌     | 9/20 [00:46<00:54,  4.91s/it]
Task 8, Epoch 10/20 => Loss 0.119, Train_accy 95.88, Test_accy 85.93:  45%|████▌     | 9/20 [00:57<00:54,  4.91s/it]
Task 8, Epoch 10/20 => Loss 0.119, Train_accy 95.88, Test_accy 85.93:  50%|█████     | 10/20 [00:57<01:07,  6.77s/it]
Task 8, Epoch 11/20 => Loss 0.093, Train_accy 96.53:  50%|█████     | 10/20 [01:01<01:07,  6.77s/it]                 
Task 8, Epoch 11/20 => Loss 0.093, Train_accy 96.53:  55%|█████▌    | 11/20 [01:01<00:54,  6.05s/it]
Task 8, Epoch 12/20 => Loss 0.110, Train_accy 95.66:  55%|█████▌    | 11/20 [01:06<00:54,  6.05s/it]
Task 8, Epoch 12/20 => Loss 0.110, Train_accy 95.66:  60%|██████    | 12/20 [01:06<00:44,  5.58s/it]
Task 8, Epoch 13/20 => Loss 0.119, Train_accy 95.44:  60%|██████    | 12/20 [01:10<00:44,  5.58s/it]
Task 8, Epoch 13/20 => Loss 0.119, Train_accy 95.44:  65%|██████▌   | 13/20 [01:10<00:36,  5.21s/it]
Task 8, Epoch 14/20 => Loss 0.108, Train_accy 95.66:  65%|██████▌   | 13/20 [01:15<00:36,  5.21s/it]
Task 8, Epoch 14/20 => Loss 0.108, Train_accy 95.66:  70%|███████   | 14/20 [01:15<00:30,  5.02s/it]
Task 8, Epoch 15/20 => Loss 0.089, Train_accy 96.10, Test_accy 86.12:  70%|███████   | 14/20 [01:26<00:30,  5.02s/it]
Task 8, Epoch 15/20 => Loss 0.089, Train_accy 96.10, Test_accy 86.12:  75%|███████▌  | 15/20 [01:26<00:33,  6.80s/it]
Task 8, Epoch 16/20 => Loss 0.072, Train_accy 97.40:  75%|███████▌  | 15/20 [01:30<00:33,  6.80s/it]                 
Task 8, Epoch 16/20 => Loss 0.072, Train_accy 97.40:  80%|████████  | 16/20 [01:30<00:24,  6.08s/it]
Task 8, Epoch 17/20 => Loss 0.100, Train_accy 95.66:  80%|████████  | 16/20 [01:34<00:24,  6.08s/it]
Task 8, Epoch 17/20 => Loss 0.100, Train_accy 95.66:  85%|████████▌ | 17/20 [01:34<00:16,  5.57s/it]
Task 8, Epoch 18/20 => Loss 0.081, Train_accy 95.66:  85%|████████▌ | 17/20 [01:39<00:16,  5.57s/it]
Task 8, Epoch 18/20 => Loss 0.081, Train_accy 95.66:  90%|█████████ | 18/20 [01:39<00:10,  5.23s/it]
Task 8, Epoch 19/20 => Loss 0.097, Train_accy 96.53:  90%|█████████ | 18/20 [01:43<00:10,  5.23s/it]
Task 8, Epoch 19/20 => Loss 0.097, Train_accy 96.53:  95%|█████████▌| 19/20 [01:43<00:04,  4.97s/it]
Task 8, Epoch 20/20 => Loss 0.101, Train_accy 95.88, Test_accy 85.74:  95%|█████████▌| 19/20 [01:54<00:04,  4.97s/it]
Task 8, Epoch 20/20 => Loss 0.101, Train_accy 95.88, Test_accy 85.74: 100%|██████████| 20/20 [01:54<00:00,  6.74s/it]
Task 8, Epoch 20/20 => Loss 0.101, Train_accy 95.88, Test_accy 85.74: 100%|██████████| 20/20 [01:54<00:00,  5.73s/it]2024-09-13 18:55:55,686 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.101, Train_accy 95.88, Test_accy 85.74

2024-09-13 18:56:02,184 [trainer.py] => No NME accuracy.
2024-09-13 18:56:02,185 [trainer.py] => CNN: {'total': 85.74, '00-09': 85.59, '10-19': 88.37, '20-29': 95.88, '30-39': 81.82, '40-49': 91.59, '50-59': 75.68, '60-69': 68.87, '70-79': 92.2, '80-89': 89.47, 'old': 85.2, 'new': 89.47}
2024-09-13 18:56:02,185 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74]
2024-09-13 18:56:02,185 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86]

Average Accuracy (CNN): 90.87
2024-09-13 18:56:02,185 [trainer.py] => Average Accuracy (CNN): 90.87 

2024-09-13 18:56:02,188 [trainer.py] => All params: 172158352
2024-09-13 18:56:02,189 [trainer.py] => Trainable params: 407240
2024-09-13 18:56:02,189 [dualprompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.336, Train_accy 54.97:   0%|          | 0/20 [00:04<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.336, Train_accy 54.97:   5%|▌         | 1/20 [00:04<01:22,  4.36s/it]
Task 9, Epoch 2/20 => Loss 0.308, Train_accy 90.07:   5%|▌         | 1/20 [00:08<01:22,  4.36s/it]
Task 9, Epoch 2/20 => Loss 0.308, Train_accy 90.07:  10%|█         | 2/20 [00:08<01:18,  4.35s/it]
Task 9, Epoch 3/20 => Loss 0.189, Train_accy 93.16:  10%|█         | 2/20 [00:13<01:18,  4.35s/it]
Task 9, Epoch 3/20 => Loss 0.189, Train_accy 93.16:  15%|█▌        | 3/20 [00:13<01:14,  4.38s/it]
Task 9, Epoch 4/20 => Loss 0.153, Train_accy 95.58:  15%|█▌        | 3/20 [00:17<01:14,  4.38s/it]
Task 9, Epoch 4/20 => Loss 0.153, Train_accy 95.58:  20%|██        | 4/20 [00:17<01:10,  4.39s/it]
Task 9, Epoch 5/20 => Loss 0.165, Train_accy 94.04, Test_accy 83.08:  20%|██        | 4/20 [00:29<01:10,  4.39s/it]
Task 9, Epoch 5/20 => Loss 0.165, Train_accy 94.04, Test_accy 83.08:  25%|██▌       | 5/20 [00:29<01:44,  6.98s/it]
Task 9, Epoch 6/20 => Loss 0.158, Train_accy 94.48:  25%|██▌       | 5/20 [00:33<01:44,  6.98s/it]                 
Task 9, Epoch 6/20 => Loss 0.158, Train_accy 94.48:  30%|███       | 6/20 [00:33<01:25,  6.08s/it]
Task 9, Epoch 7/20 => Loss 0.138, Train_accy 94.48:  30%|███       | 6/20 [00:37<01:25,  6.08s/it]
Task 9, Epoch 7/20 => Loss 0.138, Train_accy 94.48:  35%|███▌      | 7/20 [00:37<01:11,  5.50s/it]
Task 9, Epoch 8/20 => Loss 0.109, Train_accy 95.36:  35%|███▌      | 7/20 [00:42<01:11,  5.50s/it]
Task 9, Epoch 8/20 => Loss 0.109, Train_accy 95.36:  40%|████      | 8/20 [00:42<01:01,  5.13s/it]
Task 9, Epoch 9/20 => Loss 0.098, Train_accy 97.57:  40%|████      | 8/20 [00:46<01:01,  5.13s/it]
Task 9, Epoch 9/20 => Loss 0.098, Train_accy 97.57:  45%|████▌     | 9/20 [00:46<00:53,  4.86s/it]
Task 9, Epoch 10/20 => Loss 0.116, Train_accy 96.69, Test_accy 84.26:  45%|████▌     | 9/20 [00:57<00:53,  4.86s/it]
Task 9, Epoch 10/20 => Loss 0.116, Train_accy 96.69, Test_accy 84.26:  50%|█████     | 10/20 [00:57<01:09,  6.92s/it]
Task 9, Epoch 11/20 => Loss 0.105, Train_accy 95.81:  50%|█████     | 10/20 [01:02<01:09,  6.92s/it]                 
Task 9, Epoch 11/20 => Loss 0.105, Train_accy 95.81:  55%|█████▌    | 11/20 [01:02<00:55,  6.12s/it]
Task 9, Epoch 12/20 => Loss 0.107, Train_accy 96.03:  55%|█████▌    | 11/20 [01:06<00:55,  6.12s/it]
Task 9, Epoch 12/20 => Loss 0.107, Train_accy 96.03:  60%|██████    | 12/20 [01:06<00:44,  5.56s/it]
Task 9, Epoch 13/20 => Loss 0.100, Train_accy 96.47:  60%|██████    | 12/20 [01:10<00:44,  5.56s/it]
Task 9, Epoch 13/20 => Loss 0.100, Train_accy 96.47:  65%|██████▌   | 13/20 [01:10<00:36,  5.19s/it]
Task 9, Epoch 14/20 => Loss 0.112, Train_accy 96.25:  65%|██████▌   | 13/20 [01:15<00:36,  5.19s/it]
Task 9, Epoch 14/20 => Loss 0.112, Train_accy 96.25:  70%|███████   | 14/20 [01:15<00:29,  4.93s/it]
Task 9, Epoch 15/20 => Loss 0.082, Train_accy 96.25, Test_accy 84.76:  70%|███████   | 14/20 [01:26<00:29,  4.93s/it]
Task 9, Epoch 15/20 => Loss 0.082, Train_accy 96.25, Test_accy 84.76:  75%|███████▌  | 15/20 [01:26<00:34,  6.90s/it]
Task 9, Epoch 16/20 => Loss 0.090, Train_accy 97.13:  75%|███████▌  | 15/20 [01:30<00:34,  6.90s/it]                 
Task 9, Epoch 16/20 => Loss 0.090, Train_accy 97.13:  80%|████████  | 16/20 [01:30<00:24,  6.14s/it]
Task 9, Epoch 17/20 => Loss 0.145, Train_accy 94.48:  80%|████████  | 16/20 [01:35<00:24,  6.14s/it]
Task 9, Epoch 17/20 => Loss 0.145, Train_accy 94.48:  85%|████████▌ | 17/20 [01:35<00:16,  5.60s/it]
Task 9, Epoch 18/20 => Loss 0.083, Train_accy 96.47:  85%|████████▌ | 17/20 [01:39<00:16,  5.60s/it]
Task 9, Epoch 18/20 => Loss 0.083, Train_accy 96.47:  90%|█████████ | 18/20 [01:39<00:10,  5.23s/it]
Task 9, Epoch 19/20 => Loss 0.071, Train_accy 98.23:  90%|█████████ | 18/20 [01:44<00:10,  5.23s/it]
Task 9, Epoch 19/20 => Loss 0.071, Train_accy 98.23:  95%|█████████▌| 19/20 [01:44<00:04,  4.95s/it]
Task 9, Epoch 20/20 => Loss 0.067, Train_accy 97.35, Test_accy 84.09:  95%|█████████▌| 19/20 [01:55<00:04,  4.95s/it]
Task 9, Epoch 20/20 => Loss 0.067, Train_accy 97.35, Test_accy 84.09: 100%|██████████| 20/20 [01:55<00:00,  6.96s/it]
Task 9, Epoch 20/20 => Loss 0.067, Train_accy 97.35, Test_accy 84.09: 100%|██████████| 20/20 [01:55<00:00,  5.78s/it]2024-09-13 18:57:57,829 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.067, Train_accy 97.35, Test_accy 84.09

2024-09-13 18:58:05,181 [trainer.py] => No NME accuracy.
2024-09-13 18:58:05,182 [trainer.py] => CNN: {'total': 84.09, '00-09': 82.2, '10-19': 89.92, '20-29': 95.88, '30-39': 80.0, '40-49': 90.65, '50-59': 76.58, '60-69': 68.87, '70-79': 91.49, '80-89': 90.23, '90-99': 74.26, 'old': 85.36, 'new': 74.26}
2024-09-13 18:58:05,182 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09]
2024-09-13 18:58:05,182 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82]

Average Accuracy (CNN): 90.19
2024-09-13 18:58:05,182 [trainer.py] => Average Accuracy (CNN): 90.19 

2024-09-13 18:58:05,184 [trainer.py] => All params: 172158352
2024-09-13 18:58:05,187 [trainer.py] => Trainable params: 407240
2024-09-13 18:58:05,187 [dualprompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.183, Train_accy 60.29:   0%|          | 0/20 [00:04<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.183, Train_accy 60.29:   5%|▌         | 1/20 [00:04<01:31,  4.83s/it]
Task 10, Epoch 2/20 => Loss 0.211, Train_accy 92.52:   5%|▌         | 1/20 [00:09<01:31,  4.83s/it]
Task 10, Epoch 2/20 => Loss 0.211, Train_accy 92.52:  10%|█         | 2/20 [00:09<01:24,  4.68s/it]
Task 10, Epoch 3/20 => Loss 0.129, Train_accy 94.80:  10%|█         | 2/20 [00:13<01:24,  4.68s/it]
Task 10, Epoch 3/20 => Loss 0.129, Train_accy 94.80:  15%|█▌        | 3/20 [00:13<01:18,  4.63s/it]
Task 10, Epoch 4/20 => Loss 0.095, Train_accy 97.09:  15%|█▌        | 3/20 [00:18<01:18,  4.63s/it]
Task 10, Epoch 4/20 => Loss 0.095, Train_accy 97.09:  20%|██        | 4/20 [00:18<01:13,  4.61s/it]
Task 10, Epoch 5/20 => Loss 0.077, Train_accy 97.09, Test_accy 82.66:  20%|██        | 4/20 [00:30<01:13,  4.61s/it]
Task 10, Epoch 5/20 => Loss 0.077, Train_accy 97.09, Test_accy 82.66:  25%|██▌       | 5/20 [00:30<01:51,  7.43s/it]
Task 10, Epoch 6/20 => Loss 0.049, Train_accy 97.71:  25%|██▌       | 5/20 [00:35<01:51,  7.43s/it]                 
Task 10, Epoch 6/20 => Loss 0.049, Train_accy 97.71:  30%|███       | 6/20 [00:35<01:30,  6.45s/it]
Task 10, Epoch 7/20 => Loss 0.057, Train_accy 97.71:  30%|███       | 6/20 [00:40<01:30,  6.45s/it]
Task 10, Epoch 7/20 => Loss 0.057, Train_accy 97.71:  35%|███▌      | 7/20 [00:40<01:15,  5.84s/it]
Task 10, Epoch 8/20 => Loss 0.058, Train_accy 96.88:  35%|███▌      | 7/20 [00:44<01:15,  5.84s/it]
Task 10, Epoch 8/20 => Loss 0.058, Train_accy 96.88:  40%|████      | 8/20 [00:44<01:05,  5.47s/it]
Task 10, Epoch 9/20 => Loss 0.063, Train_accy 97.09:  40%|████      | 8/20 [00:49<01:05,  5.47s/it]
Task 10, Epoch 9/20 => Loss 0.063, Train_accy 97.09:  45%|████▌     | 9/20 [00:49<00:57,  5.20s/it]
Task 10, Epoch 10/20 => Loss 0.056, Train_accy 97.30, Test_accy 82.96:  45%|████▌     | 9/20 [01:01<00:57,  5.20s/it]
Task 10, Epoch 10/20 => Loss 0.056, Train_accy 97.30, Test_accy 82.96:  50%|█████     | 10/20 [01:01<01:14,  7.47s/it]
Task 10, Epoch 11/20 => Loss 0.049, Train_accy 98.13:  50%|█████     | 10/20 [01:06<01:14,  7.47s/it]                 
Task 10, Epoch 11/20 => Loss 0.049, Train_accy 98.13:  55%|█████▌    | 11/20 [01:06<00:59,  6.60s/it]
Task 10, Epoch 12/20 => Loss 0.033, Train_accy 97.92:  55%|█████▌    | 11/20 [01:11<00:59,  6.60s/it]
Task 10, Epoch 12/20 => Loss 0.033, Train_accy 97.92:  60%|██████    | 12/20 [01:11<00:47,  6.00s/it]
Task 10, Epoch 13/20 => Loss 0.046, Train_accy 97.30:  60%|██████    | 12/20 [01:15<00:47,  6.00s/it]
Task 10, Epoch 13/20 => Loss 0.046, Train_accy 97.30:  65%|██████▌   | 13/20 [01:15<00:39,  5.58s/it]
Task 10, Epoch 14/20 => Loss 0.061, Train_accy 96.67:  65%|██████▌   | 13/20 [01:20<00:39,  5.58s/it]
Task 10, Epoch 14/20 => Loss 0.061, Train_accy 96.67:  70%|███████   | 14/20 [01:20<00:31,  5.27s/it]
Task 10, Epoch 15/20 => Loss 0.079, Train_accy 96.88, Test_accy 83.19:  70%|███████   | 14/20 [01:32<00:31,  5.27s/it]
Task 10, Epoch 15/20 => Loss 0.079, Train_accy 96.88, Test_accy 83.19:  75%|███████▌  | 15/20 [01:32<00:37,  7.41s/it]
Task 10, Epoch 16/20 => Loss 0.078, Train_accy 96.47:  75%|███████▌  | 15/20 [01:37<00:37,  7.41s/it]                 
Task 10, Epoch 16/20 => Loss 0.078, Train_accy 96.47:  80%|████████  | 16/20 [01:37<00:26,  6.59s/it]
Task 10, Epoch 17/20 => Loss 0.035, Train_accy 98.13:  80%|████████  | 16/20 [01:42<00:26,  6.59s/it]
Task 10, Epoch 17/20 => Loss 0.035, Train_accy 98.13:  85%|████████▌ | 17/20 [01:42<00:17,  5.99s/it]
Task 10, Epoch 18/20 => Loss 0.037, Train_accy 97.30:  85%|████████▌ | 17/20 [01:46<00:17,  5.99s/it]
Task 10, Epoch 18/20 => Loss 0.037, Train_accy 97.30:  90%|█████████ | 18/20 [01:46<00:11,  5.62s/it]
Task 10, Epoch 19/20 => Loss 0.041, Train_accy 96.67:  90%|█████████ | 18/20 [01:51<00:11,  5.62s/it]
Task 10, Epoch 19/20 => Loss 0.041, Train_accy 96.67:  95%|█████████▌| 19/20 [01:51<00:05,  5.33s/it]
Task 10, Epoch 20/20 => Loss 0.033, Train_accy 98.34, Test_accy 83.35:  95%|█████████▌| 19/20 [02:03<00:05,  5.33s/it]
Task 10, Epoch 20/20 => Loss 0.033, Train_accy 98.34, Test_accy 83.35: 100%|██████████| 20/20 [02:03<00:00,  7.46s/it]
Task 10, Epoch 20/20 => Loss 0.033, Train_accy 98.34, Test_accy 83.35: 100%|██████████| 20/20 [02:03<00:00,  6.19s/it]2024-09-13 19:00:09,089 [dualprompt.py] => Task 10, Epoch 20/20 => Loss 0.033, Train_accy 98.34, Test_accy 83.35

2024-09-13 19:00:16,906 [trainer.py] => No NME accuracy.
2024-09-13 19:00:16,906 [trainer.py] => CNN: {'total': 83.35, '00-09': 82.2, '10-19': 89.92, '20-29': 95.88, '30-39': 79.09, '40-49': 90.65, '50-59': 76.58, '60-69': 65.09, '70-79': 91.49, '80-89': 90.23, '90-99': 73.53, '100-109': 80.87, 'old': 83.59, 'new': 80.87}
2024-09-13 19:00:16,906 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35]
2024-09-13 19:00:16,906 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77]

Average Accuracy (CNN): 89.57
2024-09-13 19:00:16,907 [trainer.py] => Average Accuracy (CNN): 89.57 

2024-09-13 19:00:16,910 [trainer.py] => All params: 172158352
2024-09-13 19:00:16,912 [trainer.py] => Trainable params: 407240
2024-09-13 19:00:16,912 [dualprompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.167, Train_accy 64.54:   0%|          | 0/20 [00:04<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.167, Train_accy 64.54:   5%|▌         | 1/20 [00:04<01:25,  4.49s/it]
Task 11, Epoch 2/20 => Loss 0.163, Train_accy 95.75:   5%|▌         | 1/20 [00:09<01:25,  4.49s/it]
Task 11, Epoch 2/20 => Loss 0.163, Train_accy 95.75:  10%|█         | 2/20 [00:09<01:21,  4.51s/it]
Task 11, Epoch 3/20 => Loss 0.093, Train_accy 97.24:  10%|█         | 2/20 [00:13<01:21,  4.51s/it]
Task 11, Epoch 3/20 => Loss 0.093, Train_accy 97.24:  15%|█▌        | 3/20 [00:13<01:16,  4.50s/it]
Task 11, Epoch 4/20 => Loss 0.087, Train_accy 96.82:  15%|█▌        | 3/20 [00:18<01:16,  4.50s/it]
Task 11, Epoch 4/20 => Loss 0.087, Train_accy 96.82:  20%|██        | 4/20 [00:18<01:13,  4.57s/it]
Task 11, Epoch 5/20 => Loss 0.057, Train_accy 97.88, Test_accy 80.23:  20%|██        | 4/20 [00:31<01:13,  4.57s/it]
Task 11, Epoch 5/20 => Loss 0.057, Train_accy 97.88, Test_accy 80.23:  25%|██▌       | 5/20 [00:31<01:53,  7.60s/it]
Task 11, Epoch 6/20 => Loss 0.052, Train_accy 97.45:  25%|██▌       | 5/20 [00:35<01:53,  7.60s/it]                 
Task 11, Epoch 6/20 => Loss 0.052, Train_accy 97.45:  30%|███       | 6/20 [00:35<01:31,  6.56s/it]
Task 11, Epoch 7/20 => Loss 0.083, Train_accy 97.45:  30%|███       | 6/20 [00:40<01:31,  6.56s/it]
Task 11, Epoch 7/20 => Loss 0.083, Train_accy 97.45:  35%|███▌      | 7/20 [00:40<01:16,  5.88s/it]
Task 11, Epoch 8/20 => Loss 0.062, Train_accy 97.24:  35%|███▌      | 7/20 [00:44<01:16,  5.88s/it]
Task 11, Epoch 8/20 => Loss 0.062, Train_accy 97.24:  40%|████      | 8/20 [00:44<01:05,  5.46s/it]
Task 11, Epoch 9/20 => Loss 0.039, Train_accy 98.09:  40%|████      | 8/20 [00:49<01:05,  5.46s/it]
Task 11, Epoch 9/20 => Loss 0.039, Train_accy 98.09:  45%|████▌     | 9/20 [00:49<00:57,  5.20s/it]
Task 11, Epoch 10/20 => Loss 0.025, Train_accy 98.51, Test_accy 80.58:  45%|████▌     | 9/20 [01:02<00:57,  5.20s/it]
Task 11, Epoch 10/20 => Loss 0.025, Train_accy 98.51, Test_accy 80.58:  50%|█████     | 10/20 [01:02<01:15,  7.60s/it]
Task 11, Epoch 11/20 => Loss 0.039, Train_accy 98.30:  50%|█████     | 10/20 [01:06<01:15,  7.60s/it]                 
Task 11, Epoch 11/20 => Loss 0.039, Train_accy 98.30:  55%|█████▌    | 11/20 [01:06<01:00,  6.70s/it]
Task 11, Epoch 12/20 => Loss 0.032, Train_accy 98.09:  55%|█████▌    | 11/20 [01:11<01:00,  6.70s/it]
Task 11, Epoch 12/20 => Loss 0.032, Train_accy 98.09:  60%|██████    | 12/20 [01:11<00:48,  6.03s/it]
Task 11, Epoch 13/20 => Loss 0.037, Train_accy 98.09:  60%|██████    | 12/20 [01:16<00:48,  6.03s/it]
Task 11, Epoch 13/20 => Loss 0.037, Train_accy 98.09:  65%|██████▌   | 13/20 [01:16<00:38,  5.57s/it]
Task 11, Epoch 14/20 => Loss 0.040, Train_accy 97.88:  65%|██████▌   | 13/20 [01:20<00:38,  5.57s/it]
Task 11, Epoch 14/20 => Loss 0.040, Train_accy 97.88:  70%|███████   | 14/20 [01:20<00:31,  5.25s/it]
Task 11, Epoch 15/20 => Loss 0.026, Train_accy 98.51, Test_accy 80.37:  70%|███████   | 14/20 [01:33<00:31,  5.25s/it]
Task 11, Epoch 15/20 => Loss 0.026, Train_accy 98.51, Test_accy 80.37:  75%|███████▌  | 15/20 [01:33<00:38,  7.63s/it]
Task 11, Epoch 16/20 => Loss 0.035, Train_accy 98.09:  75%|███████▌  | 15/20 [01:38<00:38,  7.63s/it]                 
Task 11, Epoch 16/20 => Loss 0.035, Train_accy 98.09:  80%|████████  | 16/20 [01:38<00:26,  6.68s/it]
Task 11, Epoch 17/20 => Loss 0.043, Train_accy 97.88:  80%|████████  | 16/20 [01:42<00:26,  6.68s/it]
Task 11, Epoch 17/20 => Loss 0.043, Train_accy 97.88:  85%|████████▌ | 17/20 [01:42<00:18,  6.06s/it]
Task 11, Epoch 18/20 => Loss 0.037, Train_accy 97.66:  85%|████████▌ | 17/20 [01:47<00:18,  6.06s/it]
Task 11, Epoch 18/20 => Loss 0.037, Train_accy 97.66:  90%|█████████ | 18/20 [01:47<00:11,  5.59s/it]
Task 11, Epoch 19/20 => Loss 0.071, Train_accy 97.24:  90%|█████████ | 18/20 [01:51<00:11,  5.59s/it]
Task 11, Epoch 19/20 => Loss 0.071, Train_accy 97.24:  95%|█████████▌| 19/20 [01:51<00:05,  5.31s/it]
Task 11, Epoch 20/20 => Loss 0.037, Train_accy 97.88, Test_accy 80.08:  95%|█████████▌| 19/20 [02:04<00:05,  5.31s/it]
Task 11, Epoch 20/20 => Loss 0.037, Train_accy 97.88, Test_accy 80.08: 100%|██████████| 20/20 [02:04<00:00,  7.63s/it]
Task 11, Epoch 20/20 => Loss 0.037, Train_accy 97.88, Test_accy 80.08: 100%|██████████| 20/20 [02:04<00:00,  6.25s/it]2024-09-13 19:02:21,868 [dualprompt.py] => Task 11, Epoch 20/20 => Loss 0.037, Train_accy 97.88, Test_accy 80.08

2024-09-13 19:02:30,322 [trainer.py] => No NME accuracy.
2024-09-13 19:02:30,322 [trainer.py] => CNN: {'total': 80.08, '00-09': 79.66, '10-19': 89.92, '20-29': 94.85, '30-39': 76.36, '40-49': 89.72, '50-59': 72.97, '60-69': 63.21, '70-79': 87.23, '80-89': 91.73, '90-99': 72.79, '100-109': 80.87, '110-119': 59.29, 'old': 81.89, 'new': 59.29}
2024-09-13 19:02:30,322 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08]
2024-09-13 19:02:30,322 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59]

Average Accuracy (CNN): 88.78
2024-09-13 19:02:30,322 [trainer.py] => Average Accuracy (CNN): 88.78 

2024-09-13 19:02:30,324 [trainer.py] => All params: 172158352
2024-09-13 19:02:30,326 [trainer.py] => Trainable params: 407240
2024-09-13 19:02:30,326 [dualprompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.289, Train_accy 59.75:   0%|          | 0/20 [00:04<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.289, Train_accy 59.75:   5%|▌         | 1/20 [00:04<01:28,  4.64s/it]
Task 12, Epoch 2/20 => Loss 0.324, Train_accy 86.72:   5%|▌         | 1/20 [00:09<01:28,  4.64s/it]
Task 12, Epoch 2/20 => Loss 0.324, Train_accy 86.72:  10%|█         | 2/20 [00:09<01:24,  4.70s/it]
Task 12, Epoch 3/20 => Loss 0.285, Train_accy 90.66:  10%|█         | 2/20 [00:14<01:24,  4.70s/it]
Task 12, Epoch 3/20 => Loss 0.285, Train_accy 90.66:  15%|█▌        | 3/20 [00:14<01:20,  4.71s/it]
Task 12, Epoch 4/20 => Loss 0.167, Train_accy 91.91:  15%|█▌        | 3/20 [00:18<01:20,  4.71s/it]
Task 12, Epoch 4/20 => Loss 0.167, Train_accy 91.91:  20%|██        | 4/20 [00:18<01:14,  4.67s/it]
Task 12, Epoch 5/20 => Loss 0.137, Train_accy 93.15, Test_accy 77.87:  20%|██        | 4/20 [00:32<01:14,  4.67s/it]
Task 12, Epoch 5/20 => Loss 0.137, Train_accy 93.15, Test_accy 77.87:  25%|██▌       | 5/20 [00:32<01:58,  7.91s/it]
Task 12, Epoch 6/20 => Loss 0.144, Train_accy 93.15:  25%|██▌       | 5/20 [00:37<01:58,  7.91s/it]                 
Task 12, Epoch 6/20 => Loss 0.144, Train_accy 93.15:  30%|███       | 6/20 [00:37<01:35,  6.81s/it]
Task 12, Epoch 7/20 => Loss 0.094, Train_accy 95.64:  30%|███       | 6/20 [00:41<01:35,  6.81s/it]
Task 12, Epoch 7/20 => Loss 0.094, Train_accy 95.64:  35%|███▌      | 7/20 [00:41<01:19,  6.10s/it]
Task 12, Epoch 8/20 => Loss 0.105, Train_accy 95.23:  35%|███▌      | 7/20 [00:46<01:19,  6.10s/it]
Task 12, Epoch 8/20 => Loss 0.105, Train_accy 95.23:  40%|████      | 8/20 [00:46<01:07,  5.65s/it]
Task 12, Epoch 9/20 => Loss 0.094, Train_accy 97.10:  40%|████      | 8/20 [00:50<01:07,  5.65s/it]
Task 12, Epoch 9/20 => Loss 0.094, Train_accy 97.10:  45%|████▌     | 9/20 [00:50<00:58,  5.33s/it]
Task 12, Epoch 10/20 => Loss 0.137, Train_accy 94.81, Test_accy 78.20:  45%|████▌     | 9/20 [01:04<00:58,  5.33s/it]
Task 12, Epoch 10/20 => Loss 0.137, Train_accy 94.81, Test_accy 78.20:  50%|█████     | 10/20 [01:04<01:19,  7.96s/it]
Task 12, Epoch 11/20 => Loss 0.113, Train_accy 95.02:  50%|█████     | 10/20 [01:09<01:19,  7.96s/it]                 
Task 12, Epoch 11/20 => Loss 0.113, Train_accy 95.02:  55%|█████▌    | 11/20 [01:09<01:02,  6.97s/it]
Task 12, Epoch 12/20 => Loss 0.128, Train_accy 94.81:  55%|█████▌    | 11/20 [01:14<01:02,  6.97s/it]
Task 12, Epoch 12/20 => Loss 0.128, Train_accy 94.81:  60%|██████    | 12/20 [01:14<00:50,  6.28s/it]
Task 12, Epoch 13/20 => Loss 0.097, Train_accy 95.02:  60%|██████    | 12/20 [01:18<00:50,  6.28s/it]
Task 12, Epoch 13/20 => Loss 0.097, Train_accy 95.02:  65%|██████▌   | 13/20 [01:18<00:40,  5.78s/it]
Task 12, Epoch 14/20 => Loss 0.064, Train_accy 95.85:  65%|██████▌   | 13/20 [01:23<00:40,  5.78s/it]
Task 12, Epoch 14/20 => Loss 0.064, Train_accy 95.85:  70%|███████   | 14/20 [01:23<00:32,  5.43s/it]
Task 12, Epoch 15/20 => Loss 0.089, Train_accy 96.27, Test_accy 78.07:  70%|███████   | 14/20 [01:37<00:32,  5.43s/it]
Task 12, Epoch 15/20 => Loss 0.089, Train_accy 96.27, Test_accy 78.07:  75%|███████▌  | 15/20 [01:37<00:39,  7.91s/it]
Task 12, Epoch 16/20 => Loss 0.057, Train_accy 96.47:  75%|███████▌  | 15/20 [01:41<00:39,  7.91s/it]                 
Task 12, Epoch 16/20 => Loss 0.057, Train_accy 96.47:  80%|████████  | 16/20 [01:41<00:27,  6.95s/it]
Task 12, Epoch 17/20 => Loss 0.080, Train_accy 96.68:  80%|████████  | 16/20 [01:46<00:27,  6.95s/it]
Task 12, Epoch 17/20 => Loss 0.080, Train_accy 96.68:  85%|████████▌ | 17/20 [01:46<00:18,  6.26s/it]
Task 12, Epoch 18/20 => Loss 0.060, Train_accy 96.68:  85%|████████▌ | 17/20 [01:51<00:18,  6.26s/it]
Task 12, Epoch 18/20 => Loss 0.060, Train_accy 96.68:  90%|█████████ | 18/20 [01:51<00:11,  5.78s/it]
Task 12, Epoch 19/20 => Loss 0.060, Train_accy 96.68:  90%|█████████ | 18/20 [01:55<00:11,  5.78s/it]
Task 12, Epoch 19/20 => Loss 0.060, Train_accy 96.68:  95%|█████████▌| 19/20 [01:55<00:05,  5.43s/it]
Task 12, Epoch 20/20 => Loss 0.066, Train_accy 95.64, Test_accy 78.46:  95%|█████████▌| 19/20 [02:09<00:05,  5.43s/it]
Task 12, Epoch 20/20 => Loss 0.066, Train_accy 95.64, Test_accy 78.46: 100%|██████████| 20/20 [02:09<00:00,  7.89s/it]
Task 12, Epoch 20/20 => Loss 0.066, Train_accy 95.64, Test_accy 78.46: 100%|██████████| 20/20 [02:09<00:00,  6.47s/it]2024-09-13 19:04:39,791 [dualprompt.py] => Task 12, Epoch 20/20 => Loss 0.066, Train_accy 95.64, Test_accy 78.46

2024-09-13 19:04:48,813 [trainer.py] => No NME accuracy.
2024-09-13 19:04:48,814 [trainer.py] => CNN: {'total': 78.46, '00-09': 79.66, '10-19': 89.15, '20-29': 94.85, '30-39': 71.82, '40-49': 88.79, '50-59': 74.77, '60-69': 62.26, '70-79': 87.23, '80-89': 92.48, '90-99': 69.12, '100-109': 81.74, '110-119': 60.18, '120-129': 64.49, 'old': 79.52, 'new': 64.49}
2024-09-13 19:04:48,814 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46]
2024-09-13 19:04:48,814 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36]

Average Accuracy (CNN): 87.98
2024-09-13 19:04:48,814 [trainer.py] => Average Accuracy (CNN): 87.98 

2024-09-13 19:04:48,816 [trainer.py] => All params: 172158352
2024-09-13 19:04:48,818 [trainer.py] => Trainable params: 407240
2024-09-13 19:04:48,818 [dualprompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.476, Train_accy 54.24:   0%|          | 0/20 [00:04<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.476, Train_accy 54.24:   5%|▌         | 1/20 [00:04<01:26,  4.55s/it]
Task 13, Epoch 2/20 => Loss 0.357, Train_accy 86.44:   5%|▌         | 1/20 [00:09<01:26,  4.55s/it]
Task 13, Epoch 2/20 => Loss 0.357, Train_accy 86.44:  10%|█         | 2/20 [00:09<01:21,  4.53s/it]
Task 13, Epoch 3/20 => Loss 0.260, Train_accy 88.77:  10%|█         | 2/20 [00:13<01:21,  4.53s/it]
Task 13, Epoch 3/20 => Loss 0.260, Train_accy 88.77:  15%|█▌        | 3/20 [00:13<01:17,  4.54s/it]
Task 13, Epoch 4/20 => Loss 0.148, Train_accy 94.28:  15%|█▌        | 3/20 [00:18<01:17,  4.54s/it]
Task 13, Epoch 4/20 => Loss 0.148, Train_accy 94.28:  20%|██        | 4/20 [00:18<01:12,  4.53s/it]
Task 13, Epoch 5/20 => Loss 0.144, Train_accy 94.28, Test_accy 75.93:  20%|██        | 4/20 [00:32<01:12,  4.53s/it]
Task 13, Epoch 5/20 => Loss 0.144, Train_accy 94.28, Test_accy 75.93:  25%|██▌       | 5/20 [00:32<02:00,  8.01s/it]
Task 13, Epoch 6/20 => Loss 0.111, Train_accy 94.49:  25%|██▌       | 5/20 [00:36<02:00,  8.01s/it]                 
Task 13, Epoch 6/20 => Loss 0.111, Train_accy 94.49:  30%|███       | 6/20 [00:36<01:35,  6.80s/it]
Task 13, Epoch 7/20 => Loss 0.112, Train_accy 93.86:  30%|███       | 6/20 [00:41<01:35,  6.80s/it]
Task 13, Epoch 7/20 => Loss 0.112, Train_accy 93.86:  35%|███▌      | 7/20 [00:41<01:18,  6.06s/it]
Task 13, Epoch 8/20 => Loss 0.050, Train_accy 96.61:  35%|███▌      | 7/20 [00:45<01:18,  6.06s/it]
Task 13, Epoch 8/20 => Loss 0.050, Train_accy 96.61:  40%|████      | 8/20 [00:45<01:06,  5.56s/it]
Task 13, Epoch 9/20 => Loss 0.076, Train_accy 95.76:  40%|████      | 8/20 [00:50<01:06,  5.56s/it]
Task 13, Epoch 9/20 => Loss 0.076, Train_accy 95.76:  45%|████▌     | 9/20 [00:50<00:57,  5.23s/it]
Task 13, Epoch 10/20 => Loss 0.098, Train_accy 95.13, Test_accy 76.54:  45%|████▌     | 9/20 [01:04<00:57,  5.23s/it]
Task 13, Epoch 10/20 => Loss 0.098, Train_accy 95.13, Test_accy 76.54:  50%|█████     | 10/20 [01:04<01:19,  7.98s/it]
Task 13, Epoch 11/20 => Loss 0.075, Train_accy 95.97:  50%|█████     | 10/20 [01:08<01:19,  7.98s/it]                 
Task 13, Epoch 11/20 => Loss 0.075, Train_accy 95.97:  55%|█████▌    | 11/20 [01:08<01:02,  6.92s/it]
Task 13, Epoch 12/20 => Loss 0.068, Train_accy 96.40:  55%|█████▌    | 11/20 [01:13<01:02,  6.92s/it]
Task 13, Epoch 12/20 => Loss 0.068, Train_accy 96.40:  60%|██████    | 12/20 [01:13<00:49,  6.18s/it]
Task 13, Epoch 13/20 => Loss 0.099, Train_accy 95.76:  60%|██████    | 12/20 [01:17<00:49,  6.18s/it]
Task 13, Epoch 13/20 => Loss 0.099, Train_accy 95.76:  65%|██████▌   | 13/20 [01:17<00:39,  5.68s/it]
Task 13, Epoch 14/20 => Loss 0.058, Train_accy 96.61:  65%|██████▌   | 13/20 [01:22<00:39,  5.68s/it]
Task 13, Epoch 14/20 => Loss 0.058, Train_accy 96.61:  70%|███████   | 14/20 [01:22<00:32,  5.37s/it]
Task 13, Epoch 15/20 => Loss 0.075, Train_accy 96.40, Test_accy 76.60:  70%|███████   | 14/20 [01:38<00:32,  5.37s/it]
Task 13, Epoch 15/20 => Loss 0.075, Train_accy 96.40, Test_accy 76.60:  75%|███████▌  | 15/20 [01:38<00:41,  8.39s/it]
Task 13, Epoch 16/20 => Loss 0.084, Train_accy 95.13:  75%|███████▌  | 15/20 [01:43<00:41,  8.39s/it]                 
Task 13, Epoch 16/20 => Loss 0.084, Train_accy 95.13:  80%|████████  | 16/20 [01:43<00:29,  7.38s/it]
Task 13, Epoch 17/20 => Loss 0.051, Train_accy 97.03:  80%|████████  | 16/20 [01:48<00:29,  7.38s/it]
Task 13, Epoch 17/20 => Loss 0.051, Train_accy 97.03:  85%|████████▌ | 17/20 [01:48<00:20,  6.68s/it]
Task 13, Epoch 18/20 => Loss 0.080, Train_accy 95.55:  85%|████████▌ | 17/20 [01:53<00:20,  6.68s/it]
Task 13, Epoch 18/20 => Loss 0.080, Train_accy 95.55:  90%|█████████ | 18/20 [01:53<00:12,  6.16s/it]
Task 13, Epoch 19/20 => Loss 0.059, Train_accy 97.03:  90%|█████████ | 18/20 [01:58<00:12,  6.16s/it]
Task 13, Epoch 19/20 => Loss 0.059, Train_accy 97.03:  95%|█████████▌| 19/20 [01:58<00:05,  5.82s/it]
Task 13, Epoch 20/20 => Loss 0.059, Train_accy 96.82, Test_accy 76.48:  95%|█████████▌| 19/20 [02:13<00:05,  5.82s/it]
Task 13, Epoch 20/20 => Loss 0.059, Train_accy 96.82, Test_accy 76.48: 100%|██████████| 20/20 [02:13<00:00,  8.80s/it]
Task 13, Epoch 20/20 => Loss 0.059, Train_accy 96.82, Test_accy 76.48: 100%|██████████| 20/20 [02:13<00:00,  6.69s/it]2024-09-13 19:07:02,639 [dualprompt.py] => Task 13, Epoch 20/20 => Loss 0.059, Train_accy 96.82, Test_accy 76.48

2024-09-13 19:07:13,367 [trainer.py] => No NME accuracy.
2024-09-13 19:07:13,368 [trainer.py] => CNN: {'total': 76.48, '00-09': 79.66, '10-19': 87.6, '20-29': 94.85, '30-39': 70.0, '40-49': 87.85, '50-59': 75.68, '60-69': 62.26, '70-79': 86.52, '80-89': 89.47, '90-99': 69.85, '100-109': 81.74, '110-119': 60.18, '120-129': 60.75, '130-139': 61.02, 'old': 77.68, 'new': 61.02}
2024-09-13 19:07:13,368 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46, 76.48]
2024-09-13 19:07:13,368 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36, 98.11]

Average Accuracy (CNN): 87.16
2024-09-13 19:07:13,368 [trainer.py] => Average Accuracy (CNN): 87.16 

2024-09-13 19:07:13,370 [trainer.py] => All params: 172158352
2024-09-13 19:07:13,371 [trainer.py] => Trainable params: 407240
2024-09-13 19:07:13,371 [dualprompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.604, Train_accy 50.88:   0%|          | 0/20 [00:04<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.604, Train_accy 50.88:   5%|▌         | 1/20 [00:04<01:32,  4.88s/it]
Task 14, Epoch 2/20 => Loss 0.292, Train_accy 90.49:   5%|▌         | 1/20 [00:09<01:32,  4.88s/it]
Task 14, Epoch 2/20 => Loss 0.292, Train_accy 90.49:  10%|█         | 2/20 [00:09<01:27,  4.87s/it]
Task 14, Epoch 3/20 => Loss 0.176, Train_accy 92.92:  10%|█         | 2/20 [00:14<01:27,  4.87s/it]
Task 14, Epoch 3/20 => Loss 0.176, Train_accy 92.92:  15%|█▌        | 3/20 [00:14<01:21,  4.78s/it]
Task 14, Epoch 4/20 => Loss 0.124, Train_accy 94.91:  15%|█▌        | 3/20 [00:19<01:21,  4.78s/it]
Task 14, Epoch 4/20 => Loss 0.124, Train_accy 94.91:  20%|██        | 4/20 [00:19<01:17,  4.83s/it]
Task 14, Epoch 5/20 => Loss 0.125, Train_accy 94.25, Test_accy 73.85:  20%|██        | 4/20 [00:35<01:17,  4.83s/it]
Task 14, Epoch 5/20 => Loss 0.125, Train_accy 94.25, Test_accy 73.85:  25%|██▌       | 5/20 [00:35<02:15,  9.06s/it]
Task 14, Epoch 6/20 => Loss 0.073, Train_accy 95.80:  25%|██▌       | 5/20 [00:40<02:15,  9.06s/it]                 
Task 14, Epoch 6/20 => Loss 0.073, Train_accy 95.80:  30%|███       | 6/20 [00:40<01:46,  7.61s/it]
Task 14, Epoch 7/20 => Loss 0.109, Train_accy 95.35:  30%|███       | 6/20 [00:45<01:46,  7.61s/it]
Task 14, Epoch 7/20 => Loss 0.109, Train_accy 95.35:  35%|███▌      | 7/20 [00:45<01:27,  6.74s/it]
Task 14, Epoch 8/20 => Loss 0.076, Train_accy 96.02:  35%|███▌      | 7/20 [00:50<01:27,  6.74s/it]
Task 14, Epoch 8/20 => Loss 0.076, Train_accy 96.02:  40%|████      | 8/20 [00:50<01:13,  6.12s/it]
Task 14, Epoch 9/20 => Loss 0.116, Train_accy 94.91:  40%|████      | 8/20 [00:55<01:13,  6.12s/it]
Task 14, Epoch 9/20 => Loss 0.116, Train_accy 94.91:  45%|████▌     | 9/20 [00:55<01:02,  5.68s/it]
Task 14, Epoch 10/20 => Loss 0.059, Train_accy 96.68, Test_accy 74.25:  45%|████▌     | 9/20 [01:11<01:02,  5.68s/it]
Task 14, Epoch 10/20 => Loss 0.059, Train_accy 96.68, Test_accy 74.25:  50%|█████     | 10/20 [01:11<01:29,  8.97s/it]
Task 14, Epoch 11/20 => Loss 0.087, Train_accy 95.58:  50%|█████     | 10/20 [01:16<01:29,  8.97s/it]                 
Task 14, Epoch 11/20 => Loss 0.087, Train_accy 95.58:  55%|█████▌    | 11/20 [01:16<01:09,  7.72s/it]
Task 14, Epoch 12/20 => Loss 0.031, Train_accy 97.35:  55%|█████▌    | 11/20 [01:21<01:09,  7.72s/it]
Task 14, Epoch 12/20 => Loss 0.031, Train_accy 97.35:  60%|██████    | 12/20 [01:21<00:54,  6.79s/it]
Task 14, Epoch 13/20 => Loss 0.071, Train_accy 96.24:  60%|██████    | 12/20 [01:25<00:54,  6.79s/it]
Task 14, Epoch 13/20 => Loss 0.071, Train_accy 96.24:  65%|██████▌   | 13/20 [01:25<00:43,  6.19s/it]
Task 14, Epoch 14/20 => Loss 0.074, Train_accy 96.68:  65%|██████▌   | 13/20 [01:30<00:43,  6.19s/it]
Task 14, Epoch 14/20 => Loss 0.074, Train_accy 96.68:  70%|███████   | 14/20 [01:30<00:34,  5.75s/it]
Task 14, Epoch 15/20 => Loss 0.034, Train_accy 98.45, Test_accy 74.25:  70%|███████   | 14/20 [01:46<00:34,  5.75s/it]
Task 14, Epoch 15/20 => Loss 0.034, Train_accy 98.45, Test_accy 74.25:  75%|███████▌  | 15/20 [01:46<00:44,  8.93s/it]
Task 14, Epoch 16/20 => Loss 0.055, Train_accy 96.46:  75%|███████▌  | 15/20 [01:51<00:44,  8.93s/it]                 
Task 14, Epoch 16/20 => Loss 0.055, Train_accy 96.46:  80%|████████  | 16/20 [01:51<00:30,  7.73s/it]
Task 14, Epoch 17/20 => Loss 0.078, Train_accy 96.46:  80%|████████  | 16/20 [01:56<00:30,  7.73s/it]
Task 14, Epoch 17/20 => Loss 0.078, Train_accy 96.46:  85%|████████▌ | 17/20 [01:56<00:20,  6.86s/it]
Task 14, Epoch 18/20 => Loss 0.052, Train_accy 96.46:  85%|████████▌ | 17/20 [02:01<00:20,  6.86s/it]
Task 14, Epoch 18/20 => Loss 0.052, Train_accy 96.46:  90%|█████████ | 18/20 [02:01<00:12,  6.27s/it]
Task 14, Epoch 19/20 => Loss 0.035, Train_accy 98.01:  90%|█████████ | 18/20 [02:06<00:12,  6.27s/it]
Task 14, Epoch 19/20 => Loss 0.035, Train_accy 98.01:  95%|█████████▌| 19/20 [02:06<00:05,  5.88s/it]
Task 14, Epoch 20/20 => Loss 0.025, Train_accy 97.57, Test_accy 74.59:  95%|█████████▌| 19/20 [02:22<00:05,  5.88s/it]
Task 14, Epoch 20/20 => Loss 0.025, Train_accy 97.57, Test_accy 74.59: 100%|██████████| 20/20 [02:22<00:00,  8.95s/it]
Task 14, Epoch 20/20 => Loss 0.025, Train_accy 97.57, Test_accy 74.59: 100%|██████████| 20/20 [02:22<00:00,  7.13s/it]2024-09-13 19:09:36,032 [dualprompt.py] => Task 14, Epoch 20/20 => Loss 0.025, Train_accy 97.57, Test_accy 74.59

2024-09-13 19:09:46,624 [trainer.py] => No NME accuracy.
2024-09-13 19:09:46,624 [trainer.py] => CNN: {'total': 74.59, '00-09': 78.81, '10-19': 87.6, '20-29': 93.81, '30-39': 69.09, '40-49': 87.85, '50-59': 72.97, '60-69': 63.21, '70-79': 86.52, '80-89': 88.72, '90-99': 69.12, '100-109': 81.74, '110-119': 60.18, '120-129': 60.75, '130-139': 61.02, '140-149': 55.56, 'old': 76.05, 'new': 55.56}
2024-09-13 19:09:46,624 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46, 76.48, 74.59]
2024-09-13 19:09:46,624 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36, 98.11, 97.85]

Average Accuracy (CNN): 86.32
2024-09-13 19:09:46,624 [trainer.py] => Average Accuracy (CNN): 86.32 

2024-09-13 19:09:46,627 [trainer.py] => All params: 172158352
2024-09-13 19:09:46,629 [trainer.py] => Trainable params: 407240
2024-09-13 19:09:46,629 [dualprompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.358, Train_accy 54.91:   0%|          | 0/20 [00:05<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.358, Train_accy 54.91:   5%|▌         | 1/20 [00:05<01:35,  5.01s/it]
Task 15, Epoch 2/20 => Loss 0.256, Train_accy 91.67:   5%|▌         | 1/20 [00:10<01:35,  5.01s/it]
Task 15, Epoch 2/20 => Loss 0.256, Train_accy 91.67:  10%|█         | 2/20 [00:10<01:30,  5.04s/it]
Task 15, Epoch 3/20 => Loss 0.157, Train_accy 94.23:  10%|█         | 2/20 [00:15<01:30,  5.04s/it]
Task 15, Epoch 3/20 => Loss 0.157, Train_accy 94.23:  15%|█▌        | 3/20 [00:15<01:24,  4.99s/it]
Task 15, Epoch 4/20 => Loss 0.109, Train_accy 95.09:  15%|█▌        | 3/20 [00:19<01:24,  4.99s/it]
Task 15, Epoch 4/20 => Loss 0.109, Train_accy 95.09:  20%|██        | 4/20 [00:19<01:19,  4.99s/it]
Task 15, Epoch 5/20 => Loss 0.115, Train_accy 94.23, Test_accy 72.98:  20%|██        | 4/20 [00:37<01:19,  4.99s/it]
Task 15, Epoch 5/20 => Loss 0.115, Train_accy 94.23, Test_accy 72.98:  25%|██▌       | 5/20 [00:37<02:20,  9.35s/it]
Task 15, Epoch 6/20 => Loss 0.080, Train_accy 96.15:  25%|██▌       | 5/20 [00:42<02:20,  9.35s/it]                 
Task 15, Epoch 6/20 => Loss 0.080, Train_accy 96.15:  30%|███       | 6/20 [00:42<01:50,  7.88s/it]
Task 15, Epoch 7/20 => Loss 0.090, Train_accy 94.66:  30%|███       | 6/20 [00:47<01:50,  7.88s/it]
Task 15, Epoch 7/20 => Loss 0.090, Train_accy 94.66:  35%|███▌      | 7/20 [00:47<01:30,  6.96s/it]
Task 15, Epoch 8/20 => Loss 0.083, Train_accy 95.51:  35%|███▌      | 7/20 [00:52<01:30,  6.96s/it]
Task 15, Epoch 8/20 => Loss 0.083, Train_accy 95.51:  40%|████      | 8/20 [00:52<01:16,  6.37s/it]
Task 15, Epoch 9/20 => Loss 0.093, Train_accy 94.66:  40%|████      | 8/20 [00:57<01:16,  6.37s/it]
Task 15, Epoch 9/20 => Loss 0.093, Train_accy 94.66:  45%|████▌     | 9/20 [00:57<01:05,  5.96s/it]
Task 15, Epoch 10/20 => Loss 0.070, Train_accy 96.58, Test_accy 73.51:  45%|████▌     | 9/20 [01:14<01:05,  5.96s/it]
Task 15, Epoch 10/20 => Loss 0.070, Train_accy 96.58, Test_accy 73.51:  50%|█████     | 10/20 [01:14<01:34,  9.44s/it]
Task 15, Epoch 11/20 => Loss 0.077, Train_accy 95.09:  50%|█████     | 10/20 [01:19<01:34,  9.44s/it]                 
Task 15, Epoch 11/20 => Loss 0.077, Train_accy 95.09:  55%|█████▌    | 11/20 [01:19<01:12,  8.10s/it]
Task 15, Epoch 12/20 => Loss 0.046, Train_accy 96.79:  55%|█████▌    | 11/20 [01:24<01:12,  8.10s/it]
Task 15, Epoch 12/20 => Loss 0.046, Train_accy 96.79:  60%|██████    | 12/20 [01:24<00:57,  7.13s/it]
Task 15, Epoch 13/20 => Loss 0.052, Train_accy 96.58:  60%|██████    | 12/20 [01:29<00:57,  7.13s/it]
Task 15, Epoch 13/20 => Loss 0.052, Train_accy 96.58:  65%|██████▌   | 13/20 [01:29<00:45,  6.51s/it]
Task 15, Epoch 14/20 => Loss 0.040, Train_accy 97.01:  65%|██████▌   | 13/20 [01:34<00:45,  6.51s/it]
Task 15, Epoch 14/20 => Loss 0.040, Train_accy 97.01:  70%|███████   | 14/20 [01:34<00:36,  6.02s/it]
Task 15, Epoch 15/20 => Loss 0.039, Train_accy 97.01, Test_accy 74.25:  70%|███████   | 14/20 [01:51<00:36,  6.02s/it]
Task 15, Epoch 15/20 => Loss 0.039, Train_accy 97.01, Test_accy 74.25:  75%|███████▌  | 15/20 [01:51<00:46,  9.36s/it]
Task 15, Epoch 16/20 => Loss 0.067, Train_accy 96.58:  75%|███████▌  | 15/20 [01:56<00:46,  9.36s/it]                 
Task 15, Epoch 16/20 => Loss 0.067, Train_accy 96.58:  80%|████████  | 16/20 [01:56<00:32,  8.07s/it]
Task 15, Epoch 17/20 => Loss 0.041, Train_accy 97.01:  80%|████████  | 16/20 [02:01<00:32,  8.07s/it]
Task 15, Epoch 17/20 => Loss 0.041, Train_accy 97.01:  85%|████████▌ | 17/20 [02:01<00:21,  7.16s/it]
Task 15, Epoch 18/20 => Loss 0.010, Train_accy 98.08:  85%|████████▌ | 17/20 [02:06<00:21,  7.16s/it]
Task 15, Epoch 18/20 => Loss 0.010, Train_accy 98.08:  90%|█████████ | 18/20 [02:06<00:13,  6.53s/it]
Task 15, Epoch 19/20 => Loss 0.027, Train_accy 97.01:  90%|█████████ | 18/20 [02:11<00:13,  6.53s/it]
Task 15, Epoch 19/20 => Loss 0.027, Train_accy 97.01:  95%|█████████▌| 19/20 [02:11<00:06,  6.08s/it]
Task 15, Epoch 20/20 => Loss 0.005, Train_accy 98.08, Test_accy 74.35:  95%|█████████▌| 19/20 [02:29<00:06,  6.08s/it]
Task 15, Epoch 20/20 => Loss 0.005, Train_accy 98.08, Test_accy 74.35: 100%|██████████| 20/20 [02:29<00:00,  9.44s/it]
Task 15, Epoch 20/20 => Loss 0.005, Train_accy 98.08, Test_accy 74.35: 100%|██████████| 20/20 [02:29<00:00,  7.45s/it]2024-09-13 19:12:15,719 [dualprompt.py] => Task 15, Epoch 20/20 => Loss 0.005, Train_accy 98.08, Test_accy 74.35

2024-09-13 19:12:28,046 [trainer.py] => No NME accuracy.
2024-09-13 19:12:28,047 [trainer.py] => CNN: {'total': 74.35, '00-09': 79.66, '10-19': 87.6, '20-29': 92.78, '30-39': 71.82, '40-49': 87.85, '50-59': 72.07, '60-69': 63.21, '70-79': 85.82, '80-89': 88.72, '90-99': 69.12, '100-109': 80.0, '110-119': 59.29, '120-129': 60.75, '130-139': 59.32, '140-149': 54.76, '150-159': 75.0, 'old': 74.31, 'new': 75.0}
2024-09-13 19:12:28,047 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46, 76.48, 74.59, 74.35]
2024-09-13 19:12:28,047 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36, 98.11, 97.85, 97.78]

Average Accuracy (CNN): 85.58
2024-09-13 19:12:28,047 [trainer.py] => Average Accuracy (CNN): 85.58 

2024-09-13 19:12:28,051 [trainer.py] => All params: 172158352
2024-09-13 19:12:28,053 [trainer.py] => Trainable params: 407240
2024-09-13 19:12:28,054 [dualprompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.165, Train_accy 66.16:   0%|          | 0/20 [00:04<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.165, Train_accy 66.16:   5%|▌         | 1/20 [00:04<01:32,  4.85s/it]
Task 16, Epoch 2/20 => Loss 0.200, Train_accy 92.89:   5%|▌         | 1/20 [00:09<01:32,  4.85s/it]
Task 16, Epoch 2/20 => Loss 0.200, Train_accy 92.89:  10%|█         | 2/20 [00:09<01:28,  4.91s/it]
Task 16, Epoch 3/20 => Loss 0.115, Train_accy 93.97:  10%|█         | 2/20 [00:14<01:28,  4.91s/it]
Task 16, Epoch 3/20 => Loss 0.115, Train_accy 93.97:  15%|█▌        | 3/20 [00:14<01:25,  5.00s/it]
Task 16, Epoch 4/20 => Loss 0.064, Train_accy 96.12:  15%|█▌        | 3/20 [00:19<01:25,  5.00s/it]
Task 16, Epoch 4/20 => Loss 0.064, Train_accy 96.12:  20%|██        | 4/20 [00:19<01:19,  4.97s/it]
Task 16, Epoch 5/20 => Loss 0.048, Train_accy 96.55, Test_accy 73.48:  20%|██        | 4/20 [00:37<01:19,  4.97s/it]
Task 16, Epoch 5/20 => Loss 0.048, Train_accy 96.55, Test_accy 73.48:  25%|██▌       | 5/20 [00:37<02:24,  9.66s/it]
Task 16, Epoch 6/20 => Loss 0.017, Train_accy 97.84:  25%|██▌       | 5/20 [00:42<02:24,  9.66s/it]                 
Task 16, Epoch 6/20 => Loss 0.017, Train_accy 97.84:  30%|███       | 6/20 [00:42<01:50,  7.89s/it]
Task 16, Epoch 7/20 => Loss 0.075, Train_accy 95.26:  30%|███       | 6/20 [00:46<01:50,  7.89s/it]
Task 16, Epoch 7/20 => Loss 0.075, Train_accy 95.26:  35%|███▌      | 7/20 [00:46<01:28,  6.77s/it]
Task 16, Epoch 8/20 => Loss 0.069, Train_accy 96.12:  35%|███▌      | 7/20 [00:51<01:28,  6.77s/it]
Task 16, Epoch 8/20 => Loss 0.069, Train_accy 96.12:  40%|████      | 8/20 [00:51<01:12,  6.06s/it]
Task 16, Epoch 9/20 => Loss 0.031, Train_accy 96.98:  40%|████      | 8/20 [00:56<01:12,  6.06s/it]
Task 16, Epoch 9/20 => Loss 0.031, Train_accy 96.98:  45%|████▌     | 9/20 [00:56<01:02,  5.70s/it]
Task 16, Epoch 10/20 => Loss 0.069, Train_accy 95.26, Test_accy 73.43:  45%|████▌     | 9/20 [01:14<01:02,  5.70s/it]
Task 16, Epoch 10/20 => Loss 0.069, Train_accy 95.26, Test_accy 73.43:  50%|█████     | 10/20 [01:14<01:34,  9.48s/it]
Task 16, Epoch 11/20 => Loss 0.042, Train_accy 97.20:  50%|█████     | 10/20 [01:19<01:34,  9.48s/it]                 
Task 16, Epoch 11/20 => Loss 0.042, Train_accy 97.20:  55%|█████▌    | 11/20 [01:19<01:12,  8.09s/it]
Task 16, Epoch 12/20 => Loss -0.004, Train_accy 98.28:  55%|█████▌    | 11/20 [01:24<01:12,  8.09s/it]
Task 16, Epoch 12/20 => Loss -0.004, Train_accy 98.28:  60%|██████    | 12/20 [01:24<00:57,  7.16s/it]
Task 16, Epoch 13/20 => Loss 0.041, Train_accy 96.98:  60%|██████    | 12/20 [01:29<00:57,  7.16s/it] 
Task 16, Epoch 13/20 => Loss 0.041, Train_accy 96.98:  65%|██████▌   | 13/20 [01:29<00:45,  6.50s/it]
Task 16, Epoch 14/20 => Loss 0.017, Train_accy 98.06:  65%|██████▌   | 13/20 [01:34<00:45,  6.50s/it]
Task 16, Epoch 14/20 => Loss 0.017, Train_accy 98.06:  70%|███████   | 14/20 [01:34<00:36,  6.05s/it]
Task 16, Epoch 15/20 => Loss 0.046, Train_accy 96.55, Test_accy 73.98:  70%|███████   | 14/20 [01:51<00:36,  6.05s/it]
Task 16, Epoch 15/20 => Loss 0.046, Train_accy 96.55, Test_accy 73.98:  75%|███████▌  | 15/20 [01:51<00:48,  9.63s/it]
Task 16, Epoch 16/20 => Loss 0.041, Train_accy 96.77:  75%|███████▌  | 15/20 [01:57<00:48,  9.63s/it]                 
Task 16, Epoch 16/20 => Loss 0.041, Train_accy 96.77:  80%|████████  | 16/20 [01:57<00:33,  8.26s/it]
Task 16, Epoch 17/20 => Loss 0.027, Train_accy 97.41:  80%|████████  | 16/20 [02:02<00:33,  8.26s/it]
Task 16, Epoch 17/20 => Loss 0.027, Train_accy 97.41:  85%|████████▌ | 17/20 [02:02<00:21,  7.27s/it]
Task 16, Epoch 18/20 => Loss 0.024, Train_accy 97.20:  85%|████████▌ | 17/20 [02:07<00:21,  7.27s/it]
Task 16, Epoch 18/20 => Loss 0.024, Train_accy 97.20:  90%|█████████ | 18/20 [02:07<00:13,  6.58s/it]
Task 16, Epoch 19/20 => Loss 0.044, Train_accy 96.98:  90%|█████████ | 18/20 [02:11<00:13,  6.58s/it]
Task 16, Epoch 19/20 => Loss 0.044, Train_accy 96.98:  95%|█████████▌| 19/20 [02:11<00:06,  6.08s/it]
Task 16, Epoch 20/20 => Loss 0.044, Train_accy 96.77, Test_accy 73.88:  95%|█████████▌| 19/20 [02:30<00:06,  6.08s/it]
Task 16, Epoch 20/20 => Loss 0.044, Train_accy 96.77, Test_accy 73.88: 100%|██████████| 20/20 [02:30<00:00,  9.73s/it]
Task 16, Epoch 20/20 => Loss 0.044, Train_accy 96.77, Test_accy 73.88: 100%|██████████| 20/20 [02:30<00:00,  7.51s/it]2024-09-13 19:14:58,254 [dualprompt.py] => Task 16, Epoch 20/20 => Loss 0.044, Train_accy 96.77, Test_accy 73.88

2024-09-13 19:15:11,504 [trainer.py] => No NME accuracy.
2024-09-13 19:15:11,505 [trainer.py] => CNN: {'total': 73.88, '00-09': 78.81, '10-19': 88.37, '20-29': 92.78, '30-39': 71.82, '40-49': 87.85, '50-59': 72.07, '60-69': 63.21, '70-79': 85.11, '80-89': 88.72, '90-99': 69.12, '100-109': 79.13, '110-119': 57.52, '120-129': 59.81, '130-139': 57.63, '140-149': 53.97, '150-159': 75.0, '160-169': 73.13, 'old': 73.93, 'new': 73.13}
2024-09-13 19:15:11,505 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46, 76.48, 74.59, 74.35, 73.88]
2024-09-13 19:15:11,505 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36, 98.11, 97.85, 97.78, 97.43]

Average Accuracy (CNN): 84.89
2024-09-13 19:15:11,505 [trainer.py] => Average Accuracy (CNN): 84.89 

2024-09-13 19:15:11,507 [trainer.py] => All params: 172158352
2024-09-13 19:15:11,508 [trainer.py] => Trainable params: 407240
2024-09-13 19:15:11,508 [dualprompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.350, Train_accy 56.07:   0%|          | 0/20 [00:05<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.350, Train_accy 56.07:   5%|▌         | 1/20 [00:05<01:40,  5.29s/it]
Task 17, Epoch 2/20 => Loss 0.233, Train_accy 91.09:   5%|▌         | 1/20 [00:10<01:40,  5.29s/it]
Task 17, Epoch 2/20 => Loss 0.233, Train_accy 91.09:  10%|█         | 2/20 [00:10<01:34,  5.26s/it]
Task 17, Epoch 3/20 => Loss 0.136, Train_accy 93.12:  10%|█         | 2/20 [00:15<01:34,  5.26s/it]
Task 17, Epoch 3/20 => Loss 0.136, Train_accy 93.12:  15%|█▌        | 3/20 [00:15<01:29,  5.26s/it]
Task 17, Epoch 4/20 => Loss 0.061, Train_accy 95.75:  15%|█▌        | 3/20 [00:21<01:29,  5.26s/it]
Task 17, Epoch 4/20 => Loss 0.061, Train_accy 95.75:  20%|██        | 4/20 [00:21<01:23,  5.24s/it]
Task 17, Epoch 5/20 => Loss 0.079, Train_accy 96.15, Test_accy 72.70:  20%|██        | 4/20 [00:39<01:23,  5.24s/it]
Task 17, Epoch 5/20 => Loss 0.079, Train_accy 96.15, Test_accy 72.70:  25%|██▌       | 5/20 [00:39<02:32, 10.19s/it]
Task 17, Epoch 6/20 => Loss 0.067, Train_accy 96.15:  25%|██▌       | 5/20 [00:45<02:32, 10.19s/it]                 
Task 17, Epoch 6/20 => Loss 0.067, Train_accy 96.15:  30%|███       | 6/20 [00:45<01:58,  8.46s/it]
Task 17, Epoch 7/20 => Loss 0.063, Train_accy 96.15:  30%|███       | 6/20 [00:50<01:58,  8.46s/it]
Task 17, Epoch 7/20 => Loss 0.063, Train_accy 96.15:  35%|███▌      | 7/20 [00:50<01:36,  7.43s/it]
Task 17, Epoch 8/20 => Loss 0.071, Train_accy 96.15:  35%|███▌      | 7/20 [00:55<01:36,  7.43s/it]
Task 17, Epoch 8/20 => Loss 0.071, Train_accy 96.15:  40%|████      | 8/20 [00:55<01:20,  6.73s/it]
Task 17, Epoch 9/20 => Loss 0.059, Train_accy 96.15:  40%|████      | 8/20 [01:00<01:20,  6.73s/it]
Task 17, Epoch 9/20 => Loss 0.059, Train_accy 96.15:  45%|████▌     | 9/20 [01:00<01:09,  6.29s/it]
Task 17, Epoch 10/20 => Loss 0.066, Train_accy 94.94, Test_accy 72.93:  45%|████▌     | 9/20 [01:19<01:09,  6.29s/it]
Task 17, Epoch 10/20 => Loss 0.066, Train_accy 94.94, Test_accy 72.93:  50%|█████     | 10/20 [01:19<01:42, 10.22s/it]
Task 17, Epoch 11/20 => Loss 0.051, Train_accy 96.96:  50%|█████     | 10/20 [01:25<01:42, 10.22s/it]                 
Task 17, Epoch 11/20 => Loss 0.051, Train_accy 96.96:  55%|█████▌    | 11/20 [01:25<01:18,  8.72s/it]
Task 17, Epoch 12/20 => Loss 0.082, Train_accy 96.15:  55%|█████▌    | 11/20 [01:30<01:18,  8.72s/it]
Task 17, Epoch 12/20 => Loss 0.082, Train_accy 96.15:  60%|██████    | 12/20 [01:30<01:01,  7.67s/it]
Task 17, Epoch 13/20 => Loss 0.081, Train_accy 95.34:  60%|██████    | 12/20 [01:35<01:01,  7.67s/it]
Task 17, Epoch 13/20 => Loss 0.081, Train_accy 95.34:  65%|██████▌   | 13/20 [01:35<00:47,  6.83s/it]
Task 17, Epoch 14/20 => Loss 0.053, Train_accy 95.95:  65%|██████▌   | 13/20 [01:40<00:47,  6.83s/it]
Task 17, Epoch 14/20 => Loss 0.053, Train_accy 95.95:  70%|███████   | 14/20 [01:40<00:37,  6.18s/it]
Task 17, Epoch 15/20 => Loss 0.068, Train_accy 95.55, Test_accy 72.98:  70%|███████   | 14/20 [01:58<00:37,  6.18s/it]
Task 17, Epoch 15/20 => Loss 0.068, Train_accy 95.55, Test_accy 72.98:  75%|███████▌  | 15/20 [01:58<00:49,  9.86s/it]
Task 17, Epoch 16/20 => Loss 0.046, Train_accy 97.17:  75%|███████▌  | 15/20 [02:03<00:49,  9.86s/it]                 
Task 17, Epoch 16/20 => Loss 0.046, Train_accy 97.17:  80%|████████  | 16/20 [02:03<00:33,  8.46s/it]
Task 17, Epoch 17/20 => Loss 0.021, Train_accy 97.57:  80%|████████  | 16/20 [02:08<00:33,  8.46s/it]
Task 17, Epoch 17/20 => Loss 0.021, Train_accy 97.57:  85%|████████▌ | 17/20 [02:08<00:22,  7.50s/it]
Task 17, Epoch 18/20 => Loss 0.026, Train_accy 97.17:  85%|████████▌ | 17/20 [02:14<00:22,  7.50s/it]
Task 17, Epoch 18/20 => Loss 0.026, Train_accy 97.17:  90%|█████████ | 18/20 [02:14<00:13,  6.81s/it]
Task 17, Epoch 19/20 => Loss 0.038, Train_accy 97.17:  90%|█████████ | 18/20 [02:19<00:13,  6.81s/it]
Task 17, Epoch 19/20 => Loss 0.038, Train_accy 97.17:  95%|█████████▌| 19/20 [02:19<00:06,  6.37s/it]
Task 17, Epoch 20/20 => Loss 0.042, Train_accy 96.15, Test_accy 73.17:  95%|█████████▌| 19/20 [02:38<00:06,  6.37s/it]
Task 17, Epoch 20/20 => Loss 0.042, Train_accy 96.15, Test_accy 73.17: 100%|██████████| 20/20 [02:38<00:00, 10.16s/it]
Task 17, Epoch 20/20 => Loss 0.042, Train_accy 96.15, Test_accy 73.17: 100%|██████████| 20/20 [02:38<00:00,  7.92s/it]2024-09-13 19:17:50,019 [dualprompt.py] => Task 17, Epoch 20/20 => Loss 0.042, Train_accy 96.15, Test_accy 73.17

2024-09-13 19:18:03,871 [trainer.py] => No NME accuracy.
2024-09-13 19:18:03,872 [trainer.py] => CNN: {'total': 73.17, '00-09': 77.97, '10-19': 86.05, '20-29': 92.78, '30-39': 70.91, '40-49': 87.85, '50-59': 70.27, '60-69': 62.26, '70-79': 85.11, '80-89': 88.72, '90-99': 69.85, '100-109': 78.26, '110-119': 57.52, '120-129': 59.81, '130-139': 59.32, '140-149': 53.97, '150-159': 75.0, '160-169': 72.39, '170-179': 66.02, 'old': 73.53, 'new': 66.02}
2024-09-13 19:18:03,872 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46, 76.48, 74.59, 74.35, 73.88, 73.17]
2024-09-13 19:18:03,872 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36, 98.11, 97.85, 97.78, 97.43, 97.18]

Average Accuracy (CNN): 84.24
2024-09-13 19:18:03,872 [trainer.py] => Average Accuracy (CNN): 84.24 

2024-09-13 19:18:03,874 [trainer.py] => All params: 172158352
2024-09-13 19:18:03,875 [trainer.py] => Trainable params: 407240
2024-09-13 19:18:03,875 [dualprompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.390, Train_accy 55.16:   0%|          | 0/20 [00:04<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.390, Train_accy 55.16:   5%|▌         | 1/20 [00:04<01:34,  4.97s/it]
Task 18, Epoch 2/20 => Loss 0.228, Train_accy 91.21:   5%|▌         | 1/20 [00:09<01:34,  4.97s/it]
Task 18, Epoch 2/20 => Loss 0.228, Train_accy 91.21:  10%|█         | 2/20 [00:09<01:28,  4.93s/it]
Task 18, Epoch 3/20 => Loss 0.180, Train_accy 93.63:  10%|█         | 2/20 [00:14<01:28,  4.93s/it]
Task 18, Epoch 3/20 => Loss 0.180, Train_accy 93.63:  15%|█▌        | 3/20 [00:14<01:23,  4.89s/it]
Task 18, Epoch 4/20 => Loss 0.122, Train_accy 93.63:  15%|█▌        | 3/20 [00:19<01:23,  4.89s/it]
Task 18, Epoch 4/20 => Loss 0.122, Train_accy 93.63:  20%|██        | 4/20 [00:19<01:18,  4.90s/it]
Task 18, Epoch 5/20 => Loss 0.100, Train_accy 94.73, Test_accy 71.33:  20%|██        | 4/20 [00:39<01:18,  4.90s/it]
Task 18, Epoch 5/20 => Loss 0.100, Train_accy 94.73, Test_accy 71.33:  25%|██▌       | 5/20 [00:39<02:32, 10.15s/it]
Task 18, Epoch 6/20 => Loss 0.039, Train_accy 97.14:  25%|██▌       | 5/20 [00:43<02:32, 10.15s/it]                 
Task 18, Epoch 6/20 => Loss 0.039, Train_accy 97.14:  30%|███       | 6/20 [00:43<01:56,  8.32s/it]
Task 18, Epoch 7/20 => Loss 0.075, Train_accy 95.82:  30%|███       | 6/20 [00:48<01:56,  8.32s/it]
Task 18, Epoch 7/20 => Loss 0.075, Train_accy 95.82:  35%|███▌      | 7/20 [00:48<01:33,  7.20s/it]
Task 18, Epoch 8/20 => Loss 0.068, Train_accy 95.82:  35%|███▌      | 7/20 [00:53<01:33,  7.20s/it]
Task 18, Epoch 8/20 => Loss 0.068, Train_accy 95.82:  40%|████      | 8/20 [00:53<01:17,  6.47s/it]
Task 18, Epoch 9/20 => Loss 0.071, Train_accy 95.82:  40%|████      | 8/20 [00:58<01:17,  6.47s/it]
Task 18, Epoch 9/20 => Loss 0.071, Train_accy 95.82:  45%|████▌     | 9/20 [00:58<01:05,  5.96s/it]
Task 18, Epoch 10/20 => Loss 0.066, Train_accy 95.60, Test_accy 71.77:  45%|████▌     | 9/20 [01:18<01:05,  5.96s/it]
Task 18, Epoch 10/20 => Loss 0.066, Train_accy 95.60, Test_accy 71.77:  50%|█████     | 10/20 [01:18<01:41, 10.15s/it]
Task 18, Epoch 11/20 => Loss 0.051, Train_accy 96.70:  50%|█████     | 10/20 [01:22<01:41, 10.15s/it]                 
Task 18, Epoch 11/20 => Loss 0.051, Train_accy 96.70:  55%|█████▌    | 11/20 [01:22<01:16,  8.53s/it]
Task 18, Epoch 12/20 => Loss 0.100, Train_accy 95.16:  55%|█████▌    | 11/20 [01:27<01:16,  8.53s/it]
Task 18, Epoch 12/20 => Loss 0.100, Train_accy 95.16:  60%|██████    | 12/20 [01:27<00:59,  7.41s/it]
Task 18, Epoch 13/20 => Loss 0.014, Train_accy 97.58:  60%|██████    | 12/20 [01:32<00:59,  7.41s/it]
Task 18, Epoch 13/20 => Loss 0.014, Train_accy 97.58:  65%|██████▌   | 13/20 [01:32<00:46,  6.61s/it]
Task 18, Epoch 14/20 => Loss 0.044, Train_accy 96.70:  65%|██████▌   | 13/20 [01:37<00:46,  6.61s/it]
Task 18, Epoch 14/20 => Loss 0.044, Train_accy 96.70:  70%|███████   | 14/20 [01:37<00:36,  6.12s/it]
Task 18, Epoch 15/20 => Loss 0.040, Train_accy 97.14, Test_accy 71.73:  70%|███████   | 14/20 [01:56<00:36,  6.12s/it]
Task 18, Epoch 15/20 => Loss 0.040, Train_accy 97.14, Test_accy 71.73:  75%|███████▌  | 15/20 [01:56<00:50, 10.15s/it]
Task 18, Epoch 16/20 => Loss 0.070, Train_accy 96.04:  75%|███████▌  | 15/20 [02:01<00:50, 10.15s/it]                 
Task 18, Epoch 16/20 => Loss 0.070, Train_accy 96.04:  80%|████████  | 16/20 [02:01<00:34,  8.53s/it]
Task 18, Epoch 17/20 => Loss 0.039, Train_accy 97.14:  80%|████████  | 16/20 [02:06<00:34,  8.53s/it]
Task 18, Epoch 17/20 => Loss 0.039, Train_accy 97.14:  85%|████████▌ | 17/20 [02:06<00:22,  7.45s/it]
Task 18, Epoch 18/20 => Loss 0.019, Train_accy 97.36:  85%|████████▌ | 17/20 [02:11<00:22,  7.45s/it]
Task 18, Epoch 18/20 => Loss 0.019, Train_accy 97.36:  90%|█████████ | 18/20 [02:11<00:13,  6.70s/it]
Task 18, Epoch 19/20 => Loss 0.009, Train_accy 97.80:  90%|█████████ | 18/20 [02:16<00:13,  6.70s/it]
Task 18, Epoch 19/20 => Loss 0.009, Train_accy 97.80:  95%|█████████▌| 19/20 [02:16<00:06,  6.08s/it]
Task 18, Epoch 20/20 => Loss 0.094, Train_accy 95.16, Test_accy 72.08:  95%|█████████▌| 19/20 [02:34<00:06,  6.08s/it]
Task 18, Epoch 20/20 => Loss 0.094, Train_accy 95.16, Test_accy 72.08: 100%|██████████| 20/20 [02:34<00:00,  9.76s/it]
Task 18, Epoch 20/20 => Loss 0.094, Train_accy 95.16, Test_accy 72.08: 100%|██████████| 20/20 [02:34<00:00,  7.73s/it]2024-09-13 19:20:38,497 [dualprompt.py] => Task 18, Epoch 20/20 => Loss 0.094, Train_accy 95.16, Test_accy 72.08

2024-09-13 19:20:53,043 [trainer.py] => No NME accuracy.
2024-09-13 19:20:53,043 [trainer.py] => CNN: {'total': 72.08, '00-09': 77.97, '10-19': 86.82, '20-29': 92.78, '30-39': 70.0, '40-49': 87.85, '50-59': 70.27, '60-69': 62.26, '70-79': 85.11, '80-89': 88.72, '90-99': 69.85, '100-109': 78.26, '110-119': 57.52, '120-129': 57.94, '130-139': 58.47, '140-149': 53.97, '150-159': 74.19, '160-169': 72.39, '170-179': 66.02, '180-189': 57.58, 'old': 72.98, 'new': 57.58}
2024-09-13 19:20:53,043 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46, 76.48, 74.59, 74.35, 73.88, 73.17, 72.08]
2024-09-13 19:20:53,043 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36, 98.11, 97.85, 97.78, 97.43, 97.18, 96.42]

Average Accuracy (CNN): 83.6
2024-09-13 19:20:53,043 [trainer.py] => Average Accuracy (CNN): 83.6 

2024-09-13 19:20:53,045 [trainer.py] => All params: 172158352
2024-09-13 19:20:53,046 [trainer.py] => Trainable params: 407240
2024-09-13 19:20:53,046 [dualprompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.059, Train_accy 66.60:   0%|          | 0/20 [00:05<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.059, Train_accy 66.60:   5%|▌         | 1/20 [00:05<01:43,  5.46s/it]
Task 19, Epoch 2/20 => Loss 0.199, Train_accy 92.96:   5%|▌         | 1/20 [00:10<01:43,  5.46s/it]
Task 19, Epoch 2/20 => Loss 0.199, Train_accy 92.96:  10%|█         | 2/20 [00:10<01:35,  5.30s/it]
Task 19, Epoch 3/20 => Loss 0.198, Train_accy 92.76:  10%|█         | 2/20 [00:15<01:35,  5.30s/it]
Task 19, Epoch 3/20 => Loss 0.198, Train_accy 92.76:  15%|█▌        | 3/20 [00:15<01:29,  5.27s/it]
Task 19, Epoch 4/20 => Loss 0.109, Train_accy 94.16:  15%|█▌        | 3/20 [00:21<01:29,  5.27s/it]
Task 19, Epoch 4/20 => Loss 0.109, Train_accy 94.16:  20%|██        | 4/20 [00:21<01:24,  5.29s/it]
Task 19, Epoch 5/20 => Loss 0.129, Train_accy 94.16, Test_accy 70.48:  20%|██        | 4/20 [00:41<01:24,  5.29s/it]
Task 19, Epoch 5/20 => Loss 0.129, Train_accy 94.16, Test_accy 70.48:  25%|██▌       | 5/20 [00:41<02:40, 10.69s/it]
Task 19, Epoch 6/20 => Loss 0.122, Train_accy 93.36:  25%|██▌       | 5/20 [00:46<02:40, 10.69s/it]                 
Task 19, Epoch 6/20 => Loss 0.122, Train_accy 93.36:  30%|███       | 6/20 [00:46<02:03,  8.84s/it]
Task 19, Epoch 7/20 => Loss 0.090, Train_accy 96.18:  30%|███       | 6/20 [00:52<02:03,  8.84s/it]
Task 19, Epoch 7/20 => Loss 0.090, Train_accy 96.18:  35%|███▌      | 7/20 [00:52<01:40,  7.70s/it]
Task 19, Epoch 8/20 => Loss 0.083, Train_accy 95.57:  35%|███▌      | 7/20 [00:57<01:40,  7.70s/it]
Task 19, Epoch 8/20 => Loss 0.083, Train_accy 95.57:  40%|████      | 8/20 [00:57<01:23,  6.92s/it]
Task 19, Epoch 9/20 => Loss 0.044, Train_accy 96.98:  40%|████      | 8/20 [01:02<01:23,  6.92s/it]
Task 19, Epoch 9/20 => Loss 0.044, Train_accy 96.98:  45%|████▌     | 9/20 [01:02<01:10,  6.41s/it]
Task 19, Epoch 10/20 => Loss 0.070, Train_accy 96.18, Test_accy 70.61:  45%|████▌     | 9/20 [01:22<01:10,  6.41s/it]
Task 19, Epoch 10/20 => Loss 0.070, Train_accy 96.18, Test_accy 70.61:  50%|█████     | 10/20 [01:22<01:46, 10.70s/it]
Task 19, Epoch 11/20 => Loss 0.052, Train_accy 95.57:  50%|█████     | 10/20 [01:28<01:46, 10.70s/it]                 
Task 19, Epoch 11/20 => Loss 0.052, Train_accy 95.57:  55%|█████▌    | 11/20 [01:28<01:21,  9.06s/it]
Task 19, Epoch 12/20 => Loss 0.066, Train_accy 95.77:  55%|█████▌    | 11/20 [01:33<01:21,  9.06s/it]
Task 19, Epoch 12/20 => Loss 0.066, Train_accy 95.77:  60%|██████    | 12/20 [01:33<01:03,  7.92s/it]
Task 19, Epoch 13/20 => Loss 0.023, Train_accy 97.59:  60%|██████    | 12/20 [01:38<01:03,  7.92s/it]
Task 19, Epoch 13/20 => Loss 0.023, Train_accy 97.59:  65%|██████▌   | 13/20 [01:38<00:49,  7.12s/it]
Task 19, Epoch 14/20 => Loss 0.055, Train_accy 95.98:  65%|██████▌   | 13/20 [01:44<00:49,  7.12s/it]
Task 19, Epoch 14/20 => Loss 0.055, Train_accy 95.98:  70%|███████   | 14/20 [01:44<00:39,  6.58s/it]
Task 19, Epoch 15/20 => Loss 0.073, Train_accy 96.18, Test_accy 70.74:  70%|███████   | 14/20 [02:04<00:39,  6.58s/it]
Task 19, Epoch 15/20 => Loss 0.073, Train_accy 96.18, Test_accy 70.74:  75%|███████▌  | 15/20 [02:04<00:53, 10.70s/it]
Task 19, Epoch 16/20 => Loss 0.023, Train_accy 97.18:  75%|███████▌  | 15/20 [02:09<00:53, 10.70s/it]                 
Task 19, Epoch 16/20 => Loss 0.023, Train_accy 97.18:  80%|████████  | 16/20 [02:09<00:36,  9.05s/it]
Task 19, Epoch 17/20 => Loss 0.047, Train_accy 96.18:  80%|████████  | 16/20 [02:15<00:36,  9.05s/it]
Task 19, Epoch 17/20 => Loss 0.047, Train_accy 96.18:  85%|████████▌ | 17/20 [02:15<00:23,  7.95s/it]
Task 19, Epoch 18/20 => Loss 0.013, Train_accy 98.79:  85%|████████▌ | 17/20 [02:20<00:23,  7.95s/it]
Task 19, Epoch 18/20 => Loss 0.013, Train_accy 98.79:  90%|█████████ | 18/20 [02:20<00:14,  7.15s/it]
Task 19, Epoch 19/20 => Loss 0.051, Train_accy 96.58:  90%|█████████ | 18/20 [02:25<00:14,  7.15s/it]
Task 19, Epoch 19/20 => Loss 0.051, Train_accy 96.58:  95%|█████████▌| 19/20 [02:25<00:06,  6.60s/it]
Task 19, Epoch 20/20 => Loss 0.022, Train_accy 97.38, Test_accy 70.82:  95%|█████████▌| 19/20 [02:45<00:06,  6.60s/it]
Task 19, Epoch 20/20 => Loss 0.022, Train_accy 97.38, Test_accy 70.82: 100%|██████████| 20/20 [02:45<00:00, 10.71s/it]
Task 19, Epoch 20/20 => Loss 0.022, Train_accy 97.38, Test_accy 70.82: 100%|██████████| 20/20 [02:45<00:00,  8.30s/it]2024-09-13 19:23:38,990 [dualprompt.py] => Task 19, Epoch 20/20 => Loss 0.022, Train_accy 97.38, Test_accy 70.82

2024-09-13 19:23:54,034 [trainer.py] => No NME accuracy.
2024-09-13 19:23:54,034 [trainer.py] => CNN: {'total': 70.82, '00-09': 75.42, '10-19': 86.05, '20-29': 92.78, '30-39': 70.91, '40-49': 87.85, '50-59': 70.27, '60-69': 62.26, '70-79': 83.69, '80-89': 87.97, '90-99': 70.59, '100-109': 77.39, '110-119': 57.52, '120-129': 57.94, '130-139': 58.47, '140-149': 54.76, '150-159': 75.81, '160-169': 70.15, '170-179': 66.02, '180-189': 57.58, '190-199': 47.96, 'old': 71.81, 'new': 47.96}
2024-09-13 19:23:54,034 [trainer.py] => CNN top1 curve: [100.0, 93.52, 94.19, 91.63, 91.8, 89.14, 85.73, 86.07, 85.74, 84.09, 83.35, 80.08, 78.46, 76.48, 74.59, 74.35, 73.88, 73.17, 72.08, 70.82]
2024-09-13 19:23:54,034 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.42, 99.34, 99.47, 99.11, 98.71, 98.69, 98.86, 98.82, 98.77, 98.59, 98.36, 98.11, 97.85, 97.78, 97.43, 97.18, 96.42, 96.14]

Average Accuracy (CNN): 82.96
2024-09-13 19:23:54,034 [trainer.py] => Average Accuracy (CNN): 82.96 

Accuracy Matrix (CNN):
[[100.    89.83  89.83  88.98  88.14  87.29  87.29  87.29  85.59  82.2
   82.2   79.66  79.66  79.66  78.81  79.66  78.81  77.97  77.97  75.42]
 [  0.    96.9   96.12  93.8   94.57  95.35  92.25  92.25  88.37  89.92
   89.92  89.92  89.15  87.6   87.6   87.6   88.37  86.05  86.82  86.05]
 [  0.     0.    96.91  95.88  95.88  95.88  95.88  94.85  95.88  95.88
   95.88  94.85  94.85  94.85  93.81  92.78  92.78  92.78  92.78  92.78]
 [  0.     0.     0.    88.18  88.18  87.27  85.45  81.82  81.82  80.
   79.09  76.36  71.82  70.    69.09  71.82  71.82  70.91  70.    70.91]
 [  0.     0.     0.     0.    92.52  92.52  91.59  91.59  91.59  90.65
   90.65  89.72  88.79  87.85  87.85  87.85  87.85  87.85  87.85  87.85]
 [  0.     0.     0.     0.     0.    76.58  76.58  76.58  75.68  76.58
   76.58  72.97  74.77  75.68  72.97  72.07  72.07  70.27  70.27  70.27]
 [  0.     0.     0.     0.     0.     0.    70.75  69.81  68.87  68.87
   65.09  63.21  62.26  62.26  63.21  63.21  63.21  62.26  62.26  62.26]
 [  0.     0.     0.     0.     0.     0.     0.    92.2   92.2   91.49
   91.49  87.23  87.23  86.52  86.52  85.82  85.11  85.11  85.11  83.69]
 [  0.     0.     0.     0.     0.     0.     0.     0.    89.47  90.23
   90.23  91.73  92.48  89.47  88.72  88.72  88.72  88.72  88.72  87.97]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    74.26
   73.53  72.79  69.12  69.85  69.12  69.12  69.12  69.85  69.85  70.59]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
   80.87  80.87  81.74  81.74  81.74  80.    79.13  78.26  78.26  77.39]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.    59.29  60.18  60.18  60.18  59.29  57.52  57.52  57.52  57.52]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.    64.49  60.75  60.75  60.75  59.81  59.81  57.94  57.94]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.    61.02  61.02  59.32  57.63  59.32  58.47  58.47]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.    55.56  54.76  53.97  53.97  53.97  54.76]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.    75.    75.    75.    74.19  75.81]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.    73.13  72.39  72.39  70.15]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.    66.02  66.02  66.02]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.    57.58  57.58]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.     0.    47.96]]
2024-09-13 19:23:54,037 [trainer.py] => Forgetting (CNN): 5.941052631578948
2024-09-13 19:23:58,589 [trainer.py] => config: ./exps/dualprompt_cub_B100_Inc5.json
2024-09-13 19:23:58,599 [trainer.py] => prefix:  
2024-09-13 19:23:58,600 [trainer.py] => dataset: cub
2024-09-13 19:23:58,600 [trainer.py] => memory_size: 0
2024-09-13 19:23:58,600 [trainer.py] => memory_per_class: 0
2024-09-13 19:23:58,600 [trainer.py] => fixed_memory: True
2024-09-13 19:23:58,600 [trainer.py] => shuffle: True
2024-09-13 19:23:58,600 [trainer.py] => init_cls: 100
2024-09-13 19:23:58,600 [trainer.py] => increment: 20
2024-09-13 19:23:58,600 [trainer.py] => model_name: dualprompt
2024-09-13 19:23:58,600 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-13 19:23:58,600 [trainer.py] => get_original_backbone: True
2024-09-13 19:23:58,600 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 19:23:58,600 [trainer.py] => seed: 1993
2024-09-13 19:23:58,600 [trainer.py] => tuned_epoch: 20
2024-09-13 19:23:58,600 [trainer.py] => init_lr: 0.001
2024-09-13 19:23:58,600 [trainer.py] => batch_size: 48
2024-09-13 19:23:58,600 [trainer.py] => weight_decay: 0
2024-09-13 19:23:58,600 [trainer.py] => min_lr: 1e-05
2024-09-13 19:23:58,600 [trainer.py] => optimizer: adam
2024-09-13 19:23:58,600 [trainer.py] => scheduler: constant
2024-09-13 19:23:58,600 [trainer.py] => reinit_optimizer: True
2024-09-13 19:23:58,600 [trainer.py] => global_pool: token
2024-09-13 19:23:58,601 [trainer.py] => head_type: token
2024-09-13 19:23:58,601 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-13 19:23:58,601 [trainer.py] => pretrained: True
2024-09-13 19:23:58,601 [trainer.py] => drop: 0.0
2024-09-13 19:23:58,601 [trainer.py] => drop_path: 0.0
2024-09-13 19:23:58,601 [trainer.py] => use_g_prompt: True
2024-09-13 19:23:58,601 [trainer.py] => g_prompt_length: 5
2024-09-13 19:23:58,601 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-13 19:23:58,601 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-13 19:23:58,601 [trainer.py] => use_e_prompt: True
2024-09-13 19:23:58,601 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-13 19:23:58,601 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-13 19:23:58,601 [trainer.py] => prompt_pool: True
2024-09-13 19:23:58,601 [trainer.py] => size: 10
2024-09-13 19:23:58,601 [trainer.py] => length: 5
2024-09-13 19:23:58,601 [trainer.py] => top_k: 1
2024-09-13 19:23:58,601 [trainer.py] => initializer: uniform
2024-09-13 19:23:58,601 [trainer.py] => prompt_key: True
2024-09-13 19:23:58,601 [trainer.py] => prompt_key_init: uniform
2024-09-13 19:23:58,601 [trainer.py] => use_prompt_mask: True
2024-09-13 19:23:58,601 [trainer.py] => shared_prompt_pool: True
2024-09-13 19:23:58,601 [trainer.py] => shared_prompt_key: False
2024-09-13 19:23:58,602 [trainer.py] => batchwise_prompt: True
2024-09-13 19:23:58,602 [trainer.py] => embedding_key: cls
2024-09-13 19:23:58,602 [trainer.py] => predefined_key: 
2024-09-13 19:23:58,602 [trainer.py] => pull_constraint: True
2024-09-13 19:23:58,602 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-13 19:23:58,602 [trainer.py] => same_key_value: False
2024-09-13 19:23:58,672 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 19:24:03,648 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-13 19:24:03,649 [dualprompt.py] => 407,240 model training parameters.
2024-09-13 19:24:03,649 [dualprompt.py] => g_prompt: 15360
2024-09-13 19:24:03,649 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-13 19:24:03,649 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-13 19:24:03,649 [dualprompt.py] => head.weight: 153600
2024-09-13 19:24:03,650 [dualprompt.py] => head.bias: 200
2024-09-13 19:24:03,650 [trainer.py] => All params: 172158352
2024-09-13 19:24:03,651 [trainer.py] => Trainable params: 407240
2024-09-13 19:24:03,651 [dualprompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.524, Train_accy 65.13:   0%|          | 0/20 [00:43<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.524, Train_accy 65.13:   5%|▌         | 1/20 [00:43<13:55, 43.98s/it]
Task 0, Epoch 2/20 => Loss 0.568, Train_accy 85.07:   5%|▌         | 1/20 [01:27<13:55, 43.98s/it]
Task 0, Epoch 2/20 => Loss 0.568, Train_accy 85.07:  10%|█         | 2/20 [01:27<13:11, 43.97s/it]
Task 0, Epoch 3/20 => Loss 0.441, Train_accy 88.28:  10%|█         | 2/20 [02:12<13:11, 43.97s/it]
Task 0, Epoch 3/20 => Loss 0.441, Train_accy 88.28:  15%|█▌        | 3/20 [02:12<12:28, 44.05s/it]
Task 0, Epoch 4/20 => Loss 0.410, Train_accy 89.09:  15%|█▌        | 3/20 [02:56<12:28, 44.05s/it]
Task 0, Epoch 4/20 => Loss 0.410, Train_accy 89.09:  20%|██        | 4/20 [02:56<11:44, 44.02s/it]
Task 0, Epoch 5/20 => Loss 0.355, Train_accy 90.20, Test_accy 90.15:  20%|██        | 4/20 [03:46<11:44, 44.02s/it]
Task 0, Epoch 5/20 => Loss 0.355, Train_accy 90.20, Test_accy 90.15:  25%|██▌       | 5/20 [03:46<11:35, 46.35s/it]
Task 0, Epoch 6/20 => Loss 0.339, Train_accy 90.90:  25%|██▌       | 5/20 [04:30<11:35, 46.35s/it]                 
Task 0, Epoch 6/20 => Loss 0.339, Train_accy 90.90:  30%|███       | 6/20 [04:30<10:37, 45.53s/it]
Task 0, Epoch 7/20 => Loss 0.331, Train_accy 90.67:  30%|███       | 6/20 [05:14<10:37, 45.53s/it]
Task 0, Epoch 7/20 => Loss 0.331, Train_accy 90.67:  35%|███▌      | 7/20 [05:14<09:45, 45.07s/it]
Task 0, Epoch 8/20 => Loss 0.305, Train_accy 91.35:  35%|███▌      | 7/20 [05:58<09:45, 45.07s/it]
Task 0, Epoch 8/20 => Loss 0.305, Train_accy 91.35:  40%|████      | 8/20 [05:58<08:56, 44.69s/it]
Task 0, Epoch 9/20 => Loss 0.297, Train_accy 91.41:  40%|████      | 8/20 [06:42<08:56, 44.69s/it]
Task 0, Epoch 9/20 => Loss 0.297, Train_accy 91.41:  45%|████▌     | 9/20 [06:42<08:08, 44.43s/it]
Task 0, Epoch 10/20 => Loss 0.275, Train_accy 92.10, Test_accy 90.91:  45%|████▌     | 9/20 [07:33<08:08, 44.43s/it]
Task 0, Epoch 10/20 => Loss 0.275, Train_accy 92.10, Test_accy 90.91:  50%|█████     | 10/20 [07:33<07:44, 46.44s/it]
Task 0, Epoch 11/20 => Loss 0.298, Train_accy 91.27:  50%|█████     | 10/20 [08:16<07:44, 46.44s/it]                 
Task 0, Epoch 11/20 => Loss 0.298, Train_accy 91.27:  55%|█████▌    | 11/20 [08:16<06:50, 45.60s/it]
Task 0, Epoch 12/20 => Loss 0.245, Train_accy 92.76:  55%|█████▌    | 11/20 [09:00<06:50, 45.60s/it]
Task 0, Epoch 12/20 => Loss 0.245, Train_accy 92.76:  60%|██████    | 12/20 [09:00<06:00, 45.07s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.84:  60%|██████    | 12/20 [09:44<06:00, 45.07s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.84:  65%|██████▌   | 13/20 [09:44<05:13, 44.77s/it]
Task 0, Epoch 14/20 => Loss 0.252, Train_accy 92.39:  65%|██████▌   | 13/20 [10:28<05:13, 44.77s/it]
Task 0, Epoch 14/20 => Loss 0.252, Train_accy 92.39:  70%|███████   | 14/20 [10:28<04:27, 44.51s/it]
Task 0, Epoch 15/20 => Loss 0.238, Train_accy 92.42, Test_accy 91.33:  70%|███████   | 14/20 [11:19<04:27, 44.51s/it]
Task 0, Epoch 15/20 => Loss 0.238, Train_accy 92.42, Test_accy 91.33:  75%|███████▌  | 15/20 [11:19<03:52, 46.44s/it]
Task 0, Epoch 16/20 => Loss 0.210, Train_accy 93.50:  75%|███████▌  | 15/20 [12:03<03:52, 46.44s/it]                 
Task 0, Epoch 16/20 => Loss 0.210, Train_accy 93.50:  80%|████████  | 16/20 [12:03<03:02, 45.59s/it]
Task 0, Epoch 17/20 => Loss 0.208, Train_accy 93.42:  80%|████████  | 16/20 [12:47<03:02, 45.59s/it]
Task 0, Epoch 17/20 => Loss 0.208, Train_accy 93.42:  85%|████████▌ | 17/20 [12:47<02:15, 45.12s/it]
Task 0, Epoch 18/20 => Loss 0.230, Train_accy 93.10:  85%|████████▌ | 17/20 [13:31<02:15, 45.12s/it]
Task 0, Epoch 18/20 => Loss 0.230, Train_accy 93.10:  90%|█████████ | 18/20 [13:31<01:29, 44.71s/it]
Task 0, Epoch 19/20 => Loss 0.222, Train_accy 93.23:  90%|█████████ | 18/20 [14:15<01:29, 44.71s/it]
Task 0, Epoch 19/20 => Loss 0.222, Train_accy 93.23:  95%|█████████▌| 19/20 [14:15<00:44, 44.52s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98:  95%|█████████▌| 19/20 [15:06<00:44, 44.52s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98: 100%|██████████| 20/20 [15:06<00:00, 46.50s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98: 100%|██████████| 20/20 [15:06<00:00, 45.32s/it]2024-09-13 19:39:10,582 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98

2024-09-13 19:39:18,291 [trainer.py] => No NME accuracy.
2024-09-13 19:39:18,292 [trainer.py] => CNN: {'total': 89.98, '00-99': 89.98, 'old': 0, 'new': 89.98}
2024-09-13 19:39:18,292 [trainer.py] => CNN top1 curve: [89.98]
2024-09-13 19:39:18,292 [trainer.py] => CNN top5 curve: [98.82]

Average Accuracy (CNN): 89.98
2024-09-13 19:39:18,292 [trainer.py] => Average Accuracy (CNN): 89.98 

2024-09-13 19:39:18,295 [trainer.py] => All params: 172158352
2024-09-13 19:39:18,296 [trainer.py] => Trainable params: 407240
2024-09-13 19:39:18,297 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.184, Train_accy 69.33:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.184, Train_accy 69.33:   5%|▌         | 1/20 [00:09<03:01,  9.56s/it]
Task 1, Epoch 2/20 => Loss 0.193, Train_accy 94.85:   5%|▌         | 1/20 [00:19<03:01,  9.56s/it]
Task 1, Epoch 2/20 => Loss 0.193, Train_accy 94.85:  10%|█         | 2/20 [00:19<02:52,  9.56s/it]
Task 1, Epoch 3/20 => Loss 0.178, Train_accy 95.69:  10%|█         | 2/20 [00:28<02:52,  9.56s/it]
Task 1, Epoch 3/20 => Loss 0.178, Train_accy 95.69:  15%|█▌        | 3/20 [00:28<02:41,  9.48s/it]
Task 1, Epoch 4/20 => Loss 0.122, Train_accy 95.90:  15%|█▌        | 3/20 [00:37<02:41,  9.48s/it]
Task 1, Epoch 4/20 => Loss 0.122, Train_accy 95.90:  20%|██        | 4/20 [00:37<02:30,  9.44s/it]
Task 1, Epoch 5/20 => Loss 0.119, Train_accy 96.95, Test_accy 81.78:  20%|██        | 4/20 [00:56<02:30,  9.44s/it]
Task 1, Epoch 5/20 => Loss 0.119, Train_accy 96.95, Test_accy 81.78:  25%|██▌       | 5/20 [00:56<03:11, 12.74s/it]
Task 1, Epoch 6/20 => Loss 0.160, Train_accy 94.85:  25%|██▌       | 5/20 [01:05<03:11, 12.74s/it]                 
Task 1, Epoch 6/20 => Loss 0.160, Train_accy 94.85:  30%|███       | 6/20 [01:05<02:42, 11.61s/it]
Task 1, Epoch 7/20 => Loss 0.127, Train_accy 95.69:  30%|███       | 6/20 [01:15<02:42, 11.61s/it]
Task 1, Epoch 7/20 => Loss 0.127, Train_accy 95.69:  35%|███▌      | 7/20 [01:15<02:21, 10.89s/it]
Task 1, Epoch 8/20 => Loss 0.106, Train_accy 96.53:  35%|███▌      | 7/20 [01:24<02:21, 10.89s/it]
Task 1, Epoch 8/20 => Loss 0.106, Train_accy 96.53:  40%|████      | 8/20 [01:24<02:05, 10.47s/it]
Task 1, Epoch 9/20 => Loss 0.096, Train_accy 96.85:  40%|████      | 8/20 [01:34<02:05, 10.47s/it]
Task 1, Epoch 9/20 => Loss 0.096, Train_accy 96.85:  45%|████▌     | 9/20 [01:34<01:51, 10.15s/it]
Task 1, Epoch 10/20 => Loss 0.126, Train_accy 95.69, Test_accy 82.42:  45%|████▌     | 9/20 [01:53<01:51, 10.15s/it]
Task 1, Epoch 10/20 => Loss 0.126, Train_accy 95.69, Test_accy 82.42:  50%|█████     | 10/20 [01:53<02:09, 12.90s/it]
Task 1, Epoch 11/20 => Loss 0.112, Train_accy 96.01:  50%|█████     | 10/20 [02:02<02:09, 12.90s/it]                 
Task 1, Epoch 11/20 => Loss 0.112, Train_accy 96.01:  55%|█████▌    | 11/20 [02:02<01:46, 11.88s/it]
Task 1, Epoch 12/20 => Loss 0.099, Train_accy 96.85:  55%|█████▌    | 11/20 [02:12<01:46, 11.88s/it]
Task 1, Epoch 12/20 => Loss 0.099, Train_accy 96.85:  60%|██████    | 12/20 [02:12<01:29, 11.14s/it]
Task 1, Epoch 13/20 => Loss 0.090, Train_accy 96.53:  60%|██████    | 12/20 [02:21<01:29, 11.14s/it]
Task 1, Epoch 13/20 => Loss 0.090, Train_accy 96.53:  65%|██████▌   | 13/20 [02:21<01:14, 10.64s/it]
Task 1, Epoch 14/20 => Loss 0.080, Train_accy 97.27:  65%|██████▌   | 13/20 [02:31<01:14, 10.64s/it]
Task 1, Epoch 14/20 => Loss 0.080, Train_accy 97.27:  70%|███████   | 14/20 [02:31<01:01, 10.25s/it]
Task 1, Epoch 15/20 => Loss 0.104, Train_accy 96.43, Test_accy 82.98:  70%|███████   | 14/20 [02:50<01:01, 10.25s/it]
Task 1, Epoch 15/20 => Loss 0.104, Train_accy 96.43, Test_accy 82.98:  75%|███████▌  | 15/20 [02:50<01:04, 12.83s/it]
Task 1, Epoch 16/20 => Loss 0.056, Train_accy 97.79:  75%|███████▌  | 15/20 [02:59<01:04, 12.83s/it]                 
Task 1, Epoch 16/20 => Loss 0.056, Train_accy 97.79:  80%|████████  | 16/20 [02:59<00:47, 11.80s/it]
Task 1, Epoch 17/20 => Loss 0.086, Train_accy 97.27:  80%|████████  | 16/20 [03:08<00:47, 11.80s/it]
Task 1, Epoch 17/20 => Loss 0.086, Train_accy 97.27:  85%|████████▌ | 17/20 [03:08<00:33, 11.08s/it]
Task 1, Epoch 18/20 => Loss 0.078, Train_accy 97.16:  85%|████████▌ | 17/20 [03:18<00:33, 11.08s/it]
Task 1, Epoch 18/20 => Loss 0.078, Train_accy 97.16:  90%|█████████ | 18/20 [03:18<00:21, 10.59s/it]
Task 1, Epoch 19/20 => Loss 0.082, Train_accy 97.27:  90%|█████████ | 18/20 [03:27<00:21, 10.59s/it]
Task 1, Epoch 19/20 => Loss 0.082, Train_accy 97.27:  95%|█████████▌| 19/20 [03:27<00:10, 10.19s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.22, Test_accy 83.40:  95%|█████████▌| 19/20 [03:45<00:10, 10.19s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.22, Test_accy 83.40: 100%|██████████| 20/20 [03:45<00:00, 12.50s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.22, Test_accy 83.40: 100%|██████████| 20/20 [03:45<00:00, 11.27s/it]2024-09-13 19:43:03,763 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.22, Test_accy 83.40

2024-09-13 19:43:13,233 [trainer.py] => No NME accuracy.
2024-09-13 19:43:13,233 [trainer.py] => CNN: {'total': 83.4, '00-99': 90.32, '100-119': 47.37, 'old': 90.32, 'new': 47.37}
2024-09-13 19:43:13,233 [trainer.py] => CNN top1 curve: [89.98, 83.4]
2024-09-13 19:43:13,234 [trainer.py] => CNN top5 curve: [98.82, 98.59]

Average Accuracy (CNN): 86.69
2024-09-13 19:43:13,234 [trainer.py] => Average Accuracy (CNN): 86.69 

2024-09-13 19:43:13,236 [trainer.py] => All params: 172158352
2024-09-13 19:43:13,237 [trainer.py] => Trainable params: 407240
2024-09-13 19:43:13,237 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.460, Train_accy 56.60:   0%|          | 0/20 [00:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.460, Train_accy 56.60:   5%|▌         | 1/20 [00:09<02:56,  9.31s/it]
Task 2, Epoch 2/20 => Loss 0.423, Train_accy 85.95:   5%|▌         | 1/20 [00:18<02:56,  9.31s/it]
Task 2, Epoch 2/20 => Loss 0.423, Train_accy 85.95:  10%|█         | 2/20 [00:18<02:48,  9.34s/it]
Task 2, Epoch 3/20 => Loss 0.312, Train_accy 89.52:  10%|█         | 2/20 [00:28<02:48,  9.34s/it]
Task 2, Epoch 3/20 => Loss 0.312, Train_accy 89.52:  15%|█▌        | 3/20 [00:28<02:39,  9.38s/it]
Task 2, Epoch 4/20 => Loss 0.236, Train_accy 92.45:  15%|█▌        | 3/20 [00:37<02:39,  9.38s/it]
Task 2, Epoch 4/20 => Loss 0.236, Train_accy 92.45:  20%|██        | 4/20 [00:37<02:30,  9.40s/it]
Task 2, Epoch 5/20 => Loss 0.248, Train_accy 92.56, Test_accy 76.23:  20%|██        | 4/20 [00:57<02:30,  9.40s/it]
Task 2, Epoch 5/20 => Loss 0.248, Train_accy 92.56, Test_accy 76.23:  25%|██▌       | 5/20 [00:57<03:18, 13.26s/it]
Task 2, Epoch 6/20 => Loss 0.220, Train_accy 93.29:  25%|██▌       | 5/20 [01:07<03:18, 13.26s/it]                 
Task 2, Epoch 6/20 => Loss 0.220, Train_accy 93.29:  30%|███       | 6/20 [01:07<02:47, 11.94s/it]
Task 2, Epoch 7/20 => Loss 0.199, Train_accy 94.13:  30%|███       | 6/20 [01:16<02:47, 11.94s/it]
Task 2, Epoch 7/20 => Loss 0.199, Train_accy 94.13:  35%|███▌      | 7/20 [01:16<02:25, 11.16s/it]
Task 2, Epoch 8/20 => Loss 0.175, Train_accy 93.19:  35%|███▌      | 7/20 [01:26<02:25, 11.16s/it]
Task 2, Epoch 8/20 => Loss 0.175, Train_accy 93.19:  40%|████      | 8/20 [01:26<02:08, 10.67s/it]
Task 2, Epoch 9/20 => Loss 0.176, Train_accy 93.61:  40%|████      | 8/20 [01:35<02:08, 10.67s/it]
Task 2, Epoch 9/20 => Loss 0.176, Train_accy 93.61:  45%|████▌     | 9/20 [01:35<01:53, 10.29s/it]
Task 2, Epoch 10/20 => Loss 0.197, Train_accy 94.03, Test_accy 77.21:  45%|████▌     | 9/20 [01:56<01:53, 10.29s/it]
Task 2, Epoch 10/20 => Loss 0.197, Train_accy 94.03, Test_accy 77.21:  50%|█████     | 10/20 [01:56<02:14, 13.41s/it]
Task 2, Epoch 11/20 => Loss 0.165, Train_accy 95.28:  50%|█████     | 10/20 [02:05<02:14, 13.41s/it]                 
Task 2, Epoch 11/20 => Loss 0.165, Train_accy 95.28:  55%|█████▌    | 11/20 [02:05<01:49, 12.20s/it]
Task 2, Epoch 12/20 => Loss 0.159, Train_accy 94.44:  55%|█████▌    | 11/20 [02:15<01:49, 12.20s/it]
Task 2, Epoch 12/20 => Loss 0.159, Train_accy 94.44:  60%|██████    | 12/20 [02:15<01:31, 11.38s/it]
Task 2, Epoch 13/20 => Loss 0.137, Train_accy 95.28:  60%|██████    | 12/20 [02:24<01:31, 11.38s/it]
Task 2, Epoch 13/20 => Loss 0.137, Train_accy 95.28:  65%|██████▌   | 13/20 [02:24<01:15, 10.79s/it]
Task 2, Epoch 14/20 => Loss 0.148, Train_accy 95.60:  65%|██████▌   | 13/20 [02:33<01:15, 10.79s/it]
Task 2, Epoch 14/20 => Loss 0.148, Train_accy 95.60:  70%|███████   | 14/20 [02:33<01:02, 10.39s/it]
Task 2, Epoch 15/20 => Loss 0.153, Train_accy 94.76, Test_accy 77.76:  70%|███████   | 14/20 [02:54<01:02, 10.39s/it]
Task 2, Epoch 15/20 => Loss 0.153, Train_accy 94.76, Test_accy 77.76:  75%|███████▌  | 15/20 [02:54<01:06, 13.37s/it]
Task 2, Epoch 16/20 => Loss 0.134, Train_accy 95.81:  75%|███████▌  | 15/20 [03:03<01:06, 13.37s/it]                 
Task 2, Epoch 16/20 => Loss 0.134, Train_accy 95.81:  80%|████████  | 16/20 [03:03<00:48, 12.17s/it]
Task 2, Epoch 17/20 => Loss 0.130, Train_accy 95.81:  80%|████████  | 16/20 [03:12<00:48, 12.17s/it]
Task 2, Epoch 17/20 => Loss 0.130, Train_accy 95.81:  85%|████████▌ | 17/20 [03:12<00:34, 11.34s/it]
Task 2, Epoch 18/20 => Loss 0.141, Train_accy 95.28:  85%|████████▌ | 17/20 [03:22<00:34, 11.34s/it]
Task 2, Epoch 18/20 => Loss 0.141, Train_accy 95.28:  90%|█████████ | 18/20 [03:22<00:21, 10.65s/it]
Task 2, Epoch 19/20 => Loss 0.147, Train_accy 94.65:  90%|█████████ | 18/20 [03:30<00:21, 10.65s/it]
Task 2, Epoch 19/20 => Loss 0.147, Train_accy 94.65:  95%|█████████▌| 19/20 [03:30<00:10, 10.02s/it]
Task 2, Epoch 20/20 => Loss 0.129, Train_accy 95.49, Test_accy 78.06:  95%|█████████▌| 19/20 [03:50<00:10, 10.02s/it]
Task 2, Epoch 20/20 => Loss 0.129, Train_accy 95.49, Test_accy 78.06: 100%|██████████| 20/20 [03:50<00:00, 13.09s/it]
Task 2, Epoch 20/20 => Loss 0.129, Train_accy 95.49, Test_accy 78.06: 100%|██████████| 20/20 [03:50<00:00, 11.54s/it]2024-09-13 19:47:04,090 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.129, Train_accy 95.49, Test_accy 78.06

2024-09-13 19:47:14,727 [trainer.py] => No NME accuracy.
2024-09-13 19:47:14,727 [trainer.py] => CNN: {'total': 78.06, '00-99': 90.15, '100-119': 46.49, '120-139': 46.22, 'old': 83.12, 'new': 46.22}
2024-09-13 19:47:14,727 [trainer.py] => CNN top1 curve: [89.98, 83.4, 78.06]
2024-09-13 19:47:14,727 [trainer.py] => CNN top5 curve: [98.82, 98.59, 98.29]

Average Accuracy (CNN): 83.81
2024-09-13 19:47:14,727 [trainer.py] => Average Accuracy (CNN): 83.81 

2024-09-13 19:47:14,729 [trainer.py] => All params: 172158352
2024-09-13 19:47:14,730 [trainer.py] => Trainable params: 407240
2024-09-13 19:47:14,730 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.384, Train_accy 61.52:   0%|          | 0/20 [00:09<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.384, Train_accy 61.52:   5%|▌         | 1/20 [00:09<02:54,  9.21s/it]
Task 3, Epoch 2/20 => Loss 0.348, Train_accy 90.00:   5%|▌         | 1/20 [00:18<02:54,  9.21s/it]
Task 3, Epoch 2/20 => Loss 0.348, Train_accy 90.00:  10%|█         | 2/20 [00:18<02:47,  9.28s/it]
Task 3, Epoch 3/20 => Loss 0.271, Train_accy 91.20:  10%|█         | 2/20 [00:27<02:47,  9.28s/it]
Task 3, Epoch 3/20 => Loss 0.271, Train_accy 91.20:  15%|█▌        | 3/20 [00:27<02:36,  9.22s/it]
Task 3, Epoch 4/20 => Loss 0.196, Train_accy 94.13:  15%|█▌        | 3/20 [00:36<02:36,  9.22s/it]
Task 3, Epoch 4/20 => Loss 0.196, Train_accy 94.13:  20%|██        | 4/20 [00:36<02:27,  9.23s/it]
Task 3, Epoch 5/20 => Loss 0.211, Train_accy 93.59, Test_accy 71.29:  20%|██        | 4/20 [00:58<02:27,  9.23s/it]
Task 3, Epoch 5/20 => Loss 0.211, Train_accy 93.59, Test_accy 71.29:  25%|██▌       | 5/20 [00:58<03:25, 13.72s/it]
Task 3, Epoch 6/20 => Loss 0.169, Train_accy 95.22:  25%|██▌       | 5/20 [01:07<03:25, 13.72s/it]                 
Task 3, Epoch 6/20 => Loss 0.169, Train_accy 95.22:  30%|███       | 6/20 [01:07<02:50, 12.17s/it]
Task 3, Epoch 7/20 => Loss 0.167, Train_accy 94.67:  30%|███       | 6/20 [01:16<02:50, 12.17s/it]
Task 3, Epoch 7/20 => Loss 0.167, Train_accy 94.67:  35%|███▌      | 7/20 [01:16<02:25, 11.17s/it]
Task 3, Epoch 8/20 => Loss 0.159, Train_accy 94.57:  35%|███▌      | 7/20 [01:26<02:25, 11.17s/it]
Task 3, Epoch 8/20 => Loss 0.159, Train_accy 94.57:  40%|████      | 8/20 [01:26<02:06, 10.53s/it]
Task 3, Epoch 9/20 => Loss 0.125, Train_accy 96.20:  40%|████      | 8/20 [01:35<02:06, 10.53s/it]
Task 3, Epoch 9/20 => Loss 0.125, Train_accy 96.20:  45%|████▌     | 9/20 [01:35<01:50, 10.08s/it]
Task 3, Epoch 10/20 => Loss 0.141, Train_accy 94.89, Test_accy 71.92:  45%|████▌     | 9/20 [01:56<01:50, 10.08s/it]
Task 3, Epoch 10/20 => Loss 0.141, Train_accy 94.89, Test_accy 71.92:  50%|█████     | 10/20 [01:56<02:15, 13.59s/it]
Task 3, Epoch 11/20 => Loss 0.150, Train_accy 95.00:  50%|█████     | 10/20 [02:05<02:15, 13.59s/it]                 
Task 3, Epoch 11/20 => Loss 0.150, Train_accy 95.00:  55%|█████▌    | 11/20 [02:05<01:50, 12.26s/it]
Task 3, Epoch 12/20 => Loss 0.106, Train_accy 96.52:  55%|█████▌    | 11/20 [02:14<01:50, 12.26s/it]
Task 3, Epoch 12/20 => Loss 0.106, Train_accy 96.52:  60%|██████    | 12/20 [02:14<01:30, 11.27s/it]
Task 3, Epoch 13/20 => Loss 0.133, Train_accy 95.43:  60%|██████    | 12/20 [02:23<01:30, 11.27s/it]
Task 3, Epoch 13/20 => Loss 0.133, Train_accy 95.43:  65%|██████▌   | 13/20 [02:23<01:14, 10.60s/it]
Task 3, Epoch 14/20 => Loss 0.111, Train_accy 95.98:  65%|██████▌   | 13/20 [02:33<01:14, 10.60s/it]
Task 3, Epoch 14/20 => Loss 0.111, Train_accy 95.98:  70%|███████   | 14/20 [02:33<01:00, 10.15s/it]
Task 3, Epoch 15/20 => Loss 0.119, Train_accy 95.87, Test_accy 72.71:  70%|███████   | 14/20 [02:54<01:00, 10.15s/it]
Task 3, Epoch 15/20 => Loss 0.119, Train_accy 95.87, Test_accy 72.71:  75%|███████▌  | 15/20 [02:54<01:07, 13.60s/it]
Task 3, Epoch 16/20 => Loss 0.094, Train_accy 96.09:  75%|███████▌  | 15/20 [03:03<01:07, 13.60s/it]                 
Task 3, Epoch 16/20 => Loss 0.094, Train_accy 96.09:  80%|████████  | 16/20 [03:03<00:49, 12.29s/it]
Task 3, Epoch 17/20 => Loss 0.131, Train_accy 95.43:  80%|████████  | 16/20 [03:12<00:49, 12.29s/it]
Task 3, Epoch 17/20 => Loss 0.131, Train_accy 95.43:  85%|████████▌ | 17/20 [03:12<00:33, 11.13s/it]
Task 3, Epoch 18/20 => Loss 0.125, Train_accy 95.00:  85%|████████▌ | 17/20 [03:20<00:33, 11.13s/it]
Task 3, Epoch 18/20 => Loss 0.125, Train_accy 95.00:  90%|█████████ | 18/20 [03:20<00:20, 10.37s/it]
Task 3, Epoch 19/20 => Loss 0.114, Train_accy 96.20:  90%|█████████ | 18/20 [03:29<00:20, 10.37s/it]
Task 3, Epoch 19/20 => Loss 0.114, Train_accy 96.20:  95%|█████████▌| 19/20 [03:30<00:09,  9.99s/it]
Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 73.19:  95%|█████████▌| 19/20 [03:51<00:09,  9.99s/it]
Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 73.19: 100%|██████████| 20/20 [03:51<00:00, 13.38s/it]
Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 73.19: 100%|██████████| 20/20 [03:51<00:00, 11.56s/it]2024-09-13 19:51:06,012 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 73.19

2024-09-13 19:51:18,261 [trainer.py] => No NME accuracy.
2024-09-13 19:51:18,262 [trainer.py] => CNN: {'total': 73.19, '00-99': 90.07, '100-119': 45.61, '120-139': 46.67, '140-159': 42.0, 'old': 77.94, 'new': 42.0}
2024-09-13 19:51:18,262 [trainer.py] => CNN top1 curve: [89.98, 83.4, 78.06, 73.19]
2024-09-13 19:51:18,262 [trainer.py] => CNN top5 curve: [98.82, 98.59, 98.29, 98.2]

Average Accuracy (CNN): 81.16
2024-09-13 19:51:18,262 [trainer.py] => Average Accuracy (CNN): 81.16 

2024-09-13 19:51:18,263 [trainer.py] => All params: 172158352
2024-09-13 19:51:18,264 [trainer.py] => Trainable params: 407240
2024-09-13 19:51:18,264 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.162, Train_accy 68.27:   0%|          | 0/20 [00:09<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.162, Train_accy 68.27:   5%|▌         | 1/20 [00:09<03:01,  9.55s/it]
Task 4, Epoch 2/20 => Loss 0.257, Train_accy 92.48:   5%|▌         | 1/20 [00:19<03:01,  9.55s/it]
Task 4, Epoch 2/20 => Loss 0.257, Train_accy 92.48:  10%|█         | 2/20 [00:19<02:51,  9.51s/it]
Task 4, Epoch 3/20 => Loss 0.189, Train_accy 93.42:  10%|█         | 2/20 [00:28<02:51,  9.51s/it]
Task 4, Epoch 3/20 => Loss 0.189, Train_accy 93.42:  15%|█▌        | 3/20 [00:28<02:40,  9.47s/it]
Task 4, Epoch 4/20 => Loss 0.194, Train_accy 93.63:  15%|█▌        | 3/20 [00:37<02:40,  9.47s/it]
Task 4, Epoch 4/20 => Loss 0.194, Train_accy 93.63:  20%|██        | 4/20 [00:37<02:31,  9.50s/it]
Task 4, Epoch 5/20 => Loss 0.138, Train_accy 95.41, Test_accy 68.89:  20%|██        | 4/20 [01:01<02:31,  9.50s/it]
Task 4, Epoch 5/20 => Loss 0.138, Train_accy 95.41, Test_accy 68.89:  25%|██▌       | 5/20 [01:01<03:37, 14.49s/it]
Task 4, Epoch 6/20 => Loss 0.166, Train_accy 94.15:  25%|██▌       | 5/20 [01:10<03:37, 14.49s/it]                 
Task 4, Epoch 6/20 => Loss 0.166, Train_accy 94.15:  30%|███       | 6/20 [01:10<02:59, 12.80s/it]
Task 4, Epoch 7/20 => Loss 0.163, Train_accy 94.47:  30%|███       | 6/20 [01:20<02:59, 12.80s/it]
Task 4, Epoch 7/20 => Loss 0.163, Train_accy 94.47:  35%|███▌      | 7/20 [01:20<02:31, 11.69s/it]
Task 4, Epoch 8/20 => Loss 0.184, Train_accy 94.05:  35%|███▌      | 7/20 [01:29<02:31, 11.69s/it]
Task 4, Epoch 8/20 => Loss 0.184, Train_accy 94.05:  40%|████      | 8/20 [01:29<02:11, 10.97s/it]
Task 4, Epoch 9/20 => Loss 0.135, Train_accy 95.51:  40%|████      | 8/20 [01:39<02:11, 10.97s/it]
Task 4, Epoch 9/20 => Loss 0.135, Train_accy 95.51:  45%|████▌     | 9/20 [01:39<01:55, 10.50s/it]
Task 4, Epoch 10/20 => Loss 0.110, Train_accy 96.24, Test_accy 69.55:  45%|████▌     | 9/20 [02:02<01:55, 10.50s/it]
Task 4, Epoch 10/20 => Loss 0.110, Train_accy 96.24, Test_accy 69.55:  50%|█████     | 10/20 [02:02<02:24, 14.42s/it]
Task 4, Epoch 11/20 => Loss 0.119, Train_accy 96.24:  50%|█████     | 10/20 [02:11<02:24, 14.42s/it]                 
Task 4, Epoch 11/20 => Loss 0.119, Train_accy 96.24:  55%|█████▌    | 11/20 [02:11<01:55, 12.88s/it]
Task 4, Epoch 12/20 => Loss 0.151, Train_accy 94.78:  55%|█████▌    | 11/20 [02:21<01:55, 12.88s/it]
Task 4, Epoch 12/20 => Loss 0.151, Train_accy 94.78:  60%|██████    | 12/20 [02:21<01:34, 11.87s/it]
Task 4, Epoch 13/20 => Loss 0.098, Train_accy 96.66:  60%|██████    | 12/20 [02:31<01:34, 11.87s/it]
Task 4, Epoch 13/20 => Loss 0.098, Train_accy 96.66:  65%|██████▌   | 13/20 [02:31<01:18, 11.22s/it]
Task 4, Epoch 14/20 => Loss 0.156, Train_accy 94.26:  65%|██████▌   | 13/20 [02:40<01:18, 11.22s/it]
Task 4, Epoch 14/20 => Loss 0.156, Train_accy 94.26:  70%|███████   | 14/20 [02:40<01:04, 10.72s/it]
Task 4, Epoch 15/20 => Loss 0.097, Train_accy 96.14, Test_accy 69.92:  70%|███████   | 14/20 [03:02<01:04, 10.72s/it]
Task 4, Epoch 15/20 => Loss 0.097, Train_accy 96.14, Test_accy 69.92:  75%|███████▌  | 15/20 [03:02<01:10, 14.08s/it]
Task 4, Epoch 16/20 => Loss 0.123, Train_accy 95.82:  75%|███████▌  | 15/20 [03:11<01:10, 14.08s/it]                 
Task 4, Epoch 16/20 => Loss 0.123, Train_accy 95.82:  80%|████████  | 16/20 [03:11<00:50, 12.60s/it]
Task 4, Epoch 17/20 => Loss 0.108, Train_accy 95.93:  80%|████████  | 16/20 [03:21<00:50, 12.60s/it]
Task 4, Epoch 17/20 => Loss 0.108, Train_accy 95.93:  85%|████████▌ | 17/20 [03:21<00:34, 11.65s/it]
Task 4, Epoch 18/20 => Loss 0.087, Train_accy 96.87:  85%|████████▌ | 17/20 [03:30<00:34, 11.65s/it]
Task 4, Epoch 18/20 => Loss 0.087, Train_accy 96.87:  90%|█████████ | 18/20 [03:30<00:22, 11.01s/it]
Task 4, Epoch 19/20 => Loss 0.104, Train_accy 96.03:  90%|█████████ | 18/20 [03:40<00:22, 11.01s/it]
Task 4, Epoch 19/20 => Loss 0.104, Train_accy 96.03:  95%|█████████▌| 19/20 [03:40<00:10, 10.55s/it]
Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.76, Test_accy 70.58:  95%|█████████▌| 19/20 [04:03<00:10, 10.55s/it]
Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.76, Test_accy 70.58: 100%|██████████| 20/20 [04:03<00:00, 14.33s/it]
Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.76, Test_accy 70.58: 100%|██████████| 20/20 [04:03<00:00, 12.16s/it]2024-09-13 19:55:21,468 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.76, Test_accy 70.58

2024-09-13 19:55:35,008 [trainer.py] => No NME accuracy.
2024-09-13 19:55:35,008 [trainer.py] => CNN: {'total': 70.58, '00-99': 90.07, '100-119': 46.05, '120-139': 43.56, '140-159': 42.0, '160-179': 52.32, 'old': 72.87, 'new': 52.32}
2024-09-13 19:55:35,009 [trainer.py] => CNN top1 curve: [89.98, 83.4, 78.06, 73.19, 70.58]
2024-09-13 19:55:35,009 [trainer.py] => CNN top5 curve: [98.82, 98.59, 98.29, 98.2, 97.56]

Average Accuracy (CNN): 79.04
2024-09-13 19:55:35,009 [trainer.py] => Average Accuracy (CNN): 79.04 

2024-09-13 19:55:35,010 [trainer.py] => All params: 172158352
2024-09-13 19:55:35,011 [trainer.py] => Trainable params: 407240
2024-09-13 19:55:35,011 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.264, Train_accy 65.02:   0%|          | 0/20 [00:09<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.264, Train_accy 65.02:   5%|▌         | 1/20 [00:09<02:58,  9.38s/it]
Task 5, Epoch 2/20 => Loss 0.292, Train_accy 92.02:   5%|▌         | 1/20 [00:18<02:58,  9.38s/it]
Task 5, Epoch 2/20 => Loss 0.292, Train_accy 92.02:  10%|█         | 2/20 [00:18<02:49,  9.42s/it]
Task 5, Epoch 3/20 => Loss 0.226, Train_accy 93.49:  10%|█         | 2/20 [00:28<02:49,  9.42s/it]
Task 5, Epoch 3/20 => Loss 0.226, Train_accy 93.49:  15%|█▌        | 3/20 [00:28<02:40,  9.43s/it]
Task 5, Epoch 4/20 => Loss 0.205, Train_accy 93.80:  15%|█▌        | 3/20 [00:37<02:40,  9.43s/it]
Task 5, Epoch 4/20 => Loss 0.205, Train_accy 93.80:  20%|██        | 4/20 [00:37<02:30,  9.44s/it]
Task 5, Epoch 5/20 => Loss 0.162, Train_accy 94.54, Test_accy 65.86:  20%|██        | 4/20 [01:02<02:30,  9.44s/it]
Task 5, Epoch 5/20 => Loss 0.162, Train_accy 94.54, Test_accy 65.86:  25%|██▌       | 5/20 [01:02<03:43, 14.88s/it]
Task 5, Epoch 6/20 => Loss 0.194, Train_accy 94.54:  25%|██▌       | 5/20 [01:11<03:43, 14.88s/it]                 
Task 5, Epoch 6/20 => Loss 0.194, Train_accy 94.54:  30%|███       | 6/20 [01:11<03:02, 13.03s/it]
Task 5, Epoch 7/20 => Loss 0.174, Train_accy 94.22:  30%|███       | 6/20 [01:21<03:02, 13.03s/it]
Task 5, Epoch 7/20 => Loss 0.174, Train_accy 94.22:  35%|███▌      | 7/20 [01:21<02:33, 11.83s/it]
Task 5, Epoch 8/20 => Loss 0.181, Train_accy 93.91:  35%|███▌      | 7/20 [01:30<02:33, 11.83s/it]
Task 5, Epoch 8/20 => Loss 0.181, Train_accy 93.91:  40%|████      | 8/20 [01:30<02:13, 11.09s/it]
Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.69:  40%|████      | 8/20 [01:39<02:13, 11.09s/it]
Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.69:  45%|████▌     | 9/20 [01:39<01:56, 10.57s/it]
Task 5, Epoch 10/20 => Loss 0.150, Train_accy 95.06, Test_accy 66.54:  45%|████▌     | 9/20 [02:04<01:56, 10.57s/it]
Task 5, Epoch 10/20 => Loss 0.150, Train_accy 95.06, Test_accy 66.54:  50%|█████     | 10/20 [02:04<02:28, 14.86s/it]
Task 5, Epoch 11/20 => Loss 0.147, Train_accy 95.38:  50%|█████     | 10/20 [02:13<02:28, 14.86s/it]                 
Task 5, Epoch 11/20 => Loss 0.147, Train_accy 95.38:  55%|█████▌    | 11/20 [02:13<01:58, 13.21s/it]
Task 5, Epoch 12/20 => Loss 0.146, Train_accy 95.48:  55%|█████▌    | 11/20 [02:23<01:58, 13.21s/it]
Task 5, Epoch 12/20 => Loss 0.146, Train_accy 95.48:  60%|██████    | 12/20 [02:23<01:36, 12.06s/it]
Task 5, Epoch 13/20 => Loss 0.138, Train_accy 95.27:  60%|██████    | 12/20 [02:32<01:36, 12.06s/it]
Task 5, Epoch 13/20 => Loss 0.138, Train_accy 95.27:  65%|██████▌   | 13/20 [02:32<01:18, 11.26s/it]
Task 5, Epoch 14/20 => Loss 0.141, Train_accy 95.38:  65%|██████▌   | 13/20 [02:42<01:18, 11.26s/it]
Task 5, Epoch 14/20 => Loss 0.141, Train_accy 95.38:  70%|███████   | 14/20 [02:42<01:04, 10.71s/it]
Task 5, Epoch 15/20 => Loss 0.129, Train_accy 96.11, Test_accy 67.01:  70%|███████   | 14/20 [03:05<01:04, 10.71s/it]
Task 5, Epoch 15/20 => Loss 0.129, Train_accy 96.11, Test_accy 67.01:  75%|███████▌  | 15/20 [03:05<01:12, 14.53s/it]
Task 5, Epoch 16/20 => Loss 0.109, Train_accy 96.53:  75%|███████▌  | 15/20 [03:14<01:12, 14.53s/it]                 
Task 5, Epoch 16/20 => Loss 0.109, Train_accy 96.53:  80%|████████  | 16/20 [03:14<00:51, 12.88s/it]
Task 5, Epoch 17/20 => Loss 0.147, Train_accy 94.75:  80%|████████  | 16/20 [03:24<00:51, 12.88s/it]
Task 5, Epoch 17/20 => Loss 0.147, Train_accy 94.75:  85%|████████▌ | 17/20 [03:24<00:35, 11.84s/it]
Task 5, Epoch 18/20 => Loss 0.089, Train_accy 96.43:  85%|████████▌ | 17/20 [03:33<00:35, 11.84s/it]
Task 5, Epoch 18/20 => Loss 0.089, Train_accy 96.43:  90%|█████████ | 18/20 [03:33<00:22, 11.10s/it]
Task 5, Epoch 19/20 => Loss 0.124, Train_accy 96.11:  90%|█████████ | 18/20 [03:42<00:22, 11.10s/it]
Task 5, Epoch 19/20 => Loss 0.124, Train_accy 96.11:  95%|█████████▌| 19/20 [03:42<00:10, 10.53s/it]
Task 5, Epoch 20/20 => Loss 0.116, Train_accy 95.17, Test_accy 67.18:  95%|█████████▌| 19/20 [04:06<00:10, 10.53s/it]
Task 5, Epoch 20/20 => Loss 0.116, Train_accy 95.17, Test_accy 67.18: 100%|██████████| 20/20 [04:06<00:00, 14.65s/it]
Task 5, Epoch 20/20 => Loss 0.116, Train_accy 95.17, Test_accy 67.18: 100%|██████████| 20/20 [04:06<00:00, 12.35s/it]2024-09-13 19:59:41,925 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.116, Train_accy 95.17, Test_accy 67.18

2024-09-13 19:59:56,591 [trainer.py] => No NME accuracy.
2024-09-13 19:59:56,591 [trainer.py] => CNN: {'total': 67.18, '00-99': 89.98, '100-119': 45.18, '120-139': 44.89, '140-159': 41.6, '160-179': 52.32, '180-199': 36.09, 'old': 70.54, 'new': 36.09}
2024-09-13 19:59:56,591 [trainer.py] => CNN top1 curve: [89.98, 83.4, 78.06, 73.19, 70.58, 67.18]
2024-09-13 19:59:56,591 [trainer.py] => CNN top5 curve: [98.82, 98.59, 98.29, 98.2, 97.56, 96.69]

Average Accuracy (CNN): 77.06
2024-09-13 19:59:56,591 [trainer.py] => Average Accuracy (CNN): 77.06 

Accuracy Matrix (CNN):
[[89.98 90.32 90.15 90.07 90.07 89.98]
 [ 0.   47.37 46.49 45.61 46.05 45.18]
 [ 0.    0.   46.22 46.67 43.56 44.89]
 [ 0.    0.    0.   42.   42.   41.6 ]
 [ 0.    0.    0.    0.   52.32 52.32]
 [ 0.    0.    0.    0.    0.   36.09]]
2024-09-13 19:59:56,592 [trainer.py] => Forgetting (CNN): 0.9419999999999973
2024-09-13 19:59:59,836 [trainer.py] => config: ./exps/dualprompt_cub_B100_Inc10.json
2024-09-13 19:59:59,836 [trainer.py] => prefix:  
2024-09-13 19:59:59,836 [trainer.py] => dataset: cub
2024-09-13 19:59:59,836 [trainer.py] => memory_size: 0
2024-09-13 19:59:59,836 [trainer.py] => memory_per_class: 0
2024-09-13 19:59:59,836 [trainer.py] => fixed_memory: True
2024-09-13 19:59:59,836 [trainer.py] => shuffle: True
2024-09-13 19:59:59,836 [trainer.py] => init_cls: 100
2024-09-13 19:59:59,836 [trainer.py] => increment: 10
2024-09-13 19:59:59,836 [trainer.py] => model_name: dualprompt
2024-09-13 19:59:59,836 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-09-13 19:59:59,836 [trainer.py] => get_original_backbone: True
2024-09-13 19:59:59,836 [trainer.py] => device: [device(type='cuda', index=2)]
2024-09-13 19:59:59,836 [trainer.py] => seed: 1993
2024-09-13 19:59:59,836 [trainer.py] => tuned_epoch: 20
2024-09-13 19:59:59,836 [trainer.py] => init_lr: 0.001
2024-09-13 19:59:59,836 [trainer.py] => batch_size: 48
2024-09-13 19:59:59,836 [trainer.py] => weight_decay: 0
2024-09-13 19:59:59,837 [trainer.py] => min_lr: 1e-05
2024-09-13 19:59:59,837 [trainer.py] => optimizer: adam
2024-09-13 19:59:59,837 [trainer.py] => scheduler: constant
2024-09-13 19:59:59,837 [trainer.py] => reinit_optimizer: True
2024-09-13 19:59:59,837 [trainer.py] => global_pool: token
2024-09-13 19:59:59,837 [trainer.py] => head_type: token
2024-09-13 19:59:59,837 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-09-13 19:59:59,837 [trainer.py] => pretrained: True
2024-09-13 19:59:59,837 [trainer.py] => drop: 0.0
2024-09-13 19:59:59,837 [trainer.py] => drop_path: 0.0
2024-09-13 19:59:59,837 [trainer.py] => use_g_prompt: True
2024-09-13 19:59:59,837 [trainer.py] => g_prompt_length: 5
2024-09-13 19:59:59,837 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-09-13 19:59:59,837 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-09-13 19:59:59,837 [trainer.py] => use_e_prompt: True
2024-09-13 19:59:59,837 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-09-13 19:59:59,837 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-09-13 19:59:59,837 [trainer.py] => prompt_pool: True
2024-09-13 19:59:59,837 [trainer.py] => size: 10
2024-09-13 19:59:59,837 [trainer.py] => length: 5
2024-09-13 19:59:59,837 [trainer.py] => top_k: 1
2024-09-13 19:59:59,837 [trainer.py] => initializer: uniform
2024-09-13 19:59:59,837 [trainer.py] => prompt_key: True
2024-09-13 19:59:59,837 [trainer.py] => prompt_key_init: uniform
2024-09-13 19:59:59,837 [trainer.py] => use_prompt_mask: True
2024-09-13 19:59:59,838 [trainer.py] => shared_prompt_pool: True
2024-09-13 19:59:59,838 [trainer.py] => shared_prompt_key: False
2024-09-13 19:59:59,838 [trainer.py] => batchwise_prompt: True
2024-09-13 19:59:59,838 [trainer.py] => embedding_key: cls
2024-09-13 19:59:59,838 [trainer.py] => predefined_key: 
2024-09-13 19:59:59,838 [trainer.py] => pull_constraint: True
2024-09-13 19:59:59,838 [trainer.py] => pull_constraint_coeff: 0.1
2024-09-13 19:59:59,838 [trainer.py] => same_key_value: False
2024-09-13 19:59:59,899 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-13 20:00:15,870 [dualprompt.py] => 86,205,896 model total parameters.
2024-09-13 20:00:15,870 [dualprompt.py] => 407,240 model training parameters.
2024-09-13 20:00:15,871 [dualprompt.py] => g_prompt: 15360
2024-09-13 20:00:15,871 [dualprompt.py] => e_prompt.prompt: 230400
2024-09-13 20:00:15,871 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-09-13 20:00:15,871 [dualprompt.py] => head.weight: 153600
2024-09-13 20:00:15,871 [dualprompt.py] => head.bias: 200
2024-09-13 20:00:15,873 [trainer.py] => All params: 172158352
2024-09-13 20:00:15,874 [trainer.py] => Trainable params: 407240
2024-09-13 20:00:15,874 [dualprompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.524, Train_accy 65.13:   0%|          | 0/20 [00:42<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.524, Train_accy 65.13:   5%|▌         | 1/20 [00:42<13:31, 42.71s/it]
Task 0, Epoch 2/20 => Loss 0.568, Train_accy 85.07:   5%|▌         | 1/20 [01:24<13:31, 42.71s/it]
Task 0, Epoch 2/20 => Loss 0.568, Train_accy 85.07:  10%|█         | 2/20 [01:24<12:43, 42.44s/it]
Task 0, Epoch 3/20 => Loss 0.441, Train_accy 88.28:  10%|█         | 2/20 [02:07<12:43, 42.44s/it]
Task 0, Epoch 3/20 => Loss 0.441, Train_accy 88.28:  15%|█▌        | 3/20 [02:07<12:01, 42.42s/it]
Task 0, Epoch 4/20 => Loss 0.410, Train_accy 89.09:  15%|█▌        | 3/20 [02:49<12:01, 42.42s/it]
Task 0, Epoch 4/20 => Loss 0.410, Train_accy 89.09:  20%|██        | 4/20 [02:49<11:14, 42.19s/it]
Task 0, Epoch 5/20 => Loss 0.355, Train_accy 90.20, Test_accy 90.15:  20%|██        | 4/20 [03:38<11:14, 42.19s/it]
Task 0, Epoch 5/20 => Loss 0.355, Train_accy 90.20, Test_accy 90.15:  25%|██▌       | 5/20 [03:38<11:10, 44.72s/it]
Task 0, Epoch 6/20 => Loss 0.339, Train_accy 90.90:  25%|██▌       | 5/20 [04:20<11:10, 44.72s/it]                 
Task 0, Epoch 6/20 => Loss 0.339, Train_accy 90.90:  30%|███       | 6/20 [04:20<10:14, 43.93s/it]
Task 0, Epoch 7/20 => Loss 0.331, Train_accy 90.67:  30%|███       | 6/20 [05:02<10:14, 43.93s/it]
Task 0, Epoch 7/20 => Loss 0.331, Train_accy 90.67:  35%|███▌      | 7/20 [05:02<09:23, 43.36s/it]
Task 0, Epoch 8/20 => Loss 0.305, Train_accy 91.35:  35%|███▌      | 7/20 [05:45<09:23, 43.36s/it]
Task 0, Epoch 8/20 => Loss 0.305, Train_accy 91.35:  40%|████      | 8/20 [05:45<08:36, 43.02s/it]
Task 0, Epoch 9/20 => Loss 0.297, Train_accy 91.41:  40%|████      | 8/20 [06:27<08:36, 43.02s/it]
Task 0, Epoch 9/20 => Loss 0.297, Train_accy 91.41:  45%|████▌     | 9/20 [06:27<07:50, 42.78s/it]
Task 0, Epoch 10/20 => Loss 0.275, Train_accy 92.10, Test_accy 90.91:  45%|████▌     | 9/20 [07:17<07:50, 42.78s/it]
Task 0, Epoch 10/20 => Loss 0.275, Train_accy 92.10, Test_accy 90.91:  50%|█████     | 10/20 [07:17<07:30, 45.10s/it]
Task 0, Epoch 11/20 => Loss 0.298, Train_accy 91.27:  50%|█████     | 10/20 [07:58<07:30, 45.10s/it]                 
Task 0, Epoch 11/20 => Loss 0.298, Train_accy 91.27:  55%|█████▌    | 11/20 [07:58<06:34, 43.82s/it]
Task 0, Epoch 12/20 => Loss 0.245, Train_accy 92.76:  55%|█████▌    | 11/20 [08:41<06:34, 43.82s/it]
Task 0, Epoch 12/20 => Loss 0.245, Train_accy 92.76:  60%|██████    | 12/20 [08:41<05:46, 43.36s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.84:  60%|██████    | 12/20 [09:23<05:46, 43.36s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.84:  65%|██████▌   | 13/20 [09:23<05:01, 43.07s/it]
Task 0, Epoch 14/20 => Loss 0.252, Train_accy 92.39:  65%|██████▌   | 13/20 [10:05<05:01, 43.07s/it]
Task 0, Epoch 14/20 => Loss 0.252, Train_accy 92.39:  70%|███████   | 14/20 [10:05<04:17, 42.91s/it]
Task 0, Epoch 15/20 => Loss 0.238, Train_accy 92.42, Test_accy 91.33:  70%|███████   | 14/20 [10:56<04:17, 42.91s/it]
Task 0, Epoch 15/20 => Loss 0.238, Train_accy 92.42, Test_accy 91.33:  75%|███████▌  | 15/20 [10:56<03:45, 45.14s/it]
Task 0, Epoch 16/20 => Loss 0.210, Train_accy 93.50:  75%|███████▌  | 15/20 [11:38<03:45, 45.14s/it]                 
Task 0, Epoch 16/20 => Loss 0.210, Train_accy 93.50:  80%|████████  | 16/20 [11:38<02:57, 44.33s/it]
Task 0, Epoch 17/20 => Loss 0.208, Train_accy 93.42:  80%|████████  | 16/20 [12:19<02:57, 44.33s/it]
Task 0, Epoch 17/20 => Loss 0.208, Train_accy 93.42:  85%|████████▌ | 17/20 [12:19<02:10, 43.37s/it]
Task 0, Epoch 18/20 => Loss 0.230, Train_accy 93.10:  85%|████████▌ | 17/20 [13:01<02:10, 43.37s/it]
Task 0, Epoch 18/20 => Loss 0.230, Train_accy 93.10:  90%|█████████ | 18/20 [13:01<01:25, 42.96s/it]
Task 0, Epoch 19/20 => Loss 0.222, Train_accy 93.23:  90%|█████████ | 18/20 [13:44<01:25, 42.96s/it]
Task 0, Epoch 19/20 => Loss 0.222, Train_accy 93.23:  95%|█████████▌| 19/20 [13:44<00:42, 42.76s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98:  95%|█████████▌| 19/20 [14:34<00:42, 42.76s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98: 100%|██████████| 20/20 [14:34<00:00, 44.97s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98: 100%|██████████| 20/20 [14:34<00:00, 43.72s/it]2024-09-13 20:14:50,981 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.35, Test_accy 89.98

2024-09-13 20:14:58,752 [trainer.py] => No NME accuracy.
2024-09-13 20:14:58,752 [trainer.py] => CNN: {'total': 89.98, '00-99': 89.98, 'old': 0, 'new': 89.98}
2024-09-13 20:14:58,752 [trainer.py] => CNN top1 curve: [89.98]
2024-09-13 20:14:58,752 [trainer.py] => CNN top5 curve: [98.82]

Average Accuracy (CNN): 89.98
2024-09-13 20:14:58,752 [trainer.py] => Average Accuracy (CNN): 89.98 

2024-09-13 20:14:58,754 [trainer.py] => All params: 172158352
2024-09-13 20:14:58,755 [trainer.py] => Trainable params: 407240
2024-09-13 20:14:58,755 [dualprompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.176, Train_accy 60.08:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.176, Train_accy 60.08:   5%|▌         | 1/20 [00:05<01:36,  5.10s/it]
Task 1, Epoch 2/20 => Loss 0.210, Train_accy 93.14:   5%|▌         | 1/20 [00:10<01:36,  5.10s/it]
Task 1, Epoch 2/20 => Loss 0.210, Train_accy 93.14:  10%|█         | 2/20 [00:10<01:32,  5.12s/it]
Task 1, Epoch 3/20 => Loss 0.124, Train_accy 95.43:  10%|█         | 2/20 [00:15<01:32,  5.12s/it]
Task 1, Epoch 3/20 => Loss 0.124, Train_accy 95.43:  15%|█▌        | 3/20 [00:15<01:26,  5.07s/it]
Task 1, Epoch 4/20 => Loss 0.097, Train_accy 95.63:  15%|█▌        | 3/20 [00:20<01:26,  5.07s/it]
Task 1, Epoch 4/20 => Loss 0.097, Train_accy 95.63:  20%|██        | 4/20 [00:20<01:21,  5.08s/it]
Task 1, Epoch 5/20 => Loss 0.084, Train_accy 97.09, Test_accy 86.03:  20%|██        | 4/20 [00:33<01:21,  5.08s/it]
Task 1, Epoch 5/20 => Loss 0.084, Train_accy 97.09, Test_accy 86.03:  25%|██▌       | 5/20 [00:33<02:02,  8.15s/it]
Task 1, Epoch 6/20 => Loss 0.075, Train_accy 98.34:  25%|██▌       | 5/20 [00:39<02:02,  8.15s/it]                 
Task 1, Epoch 6/20 => Loss 0.075, Train_accy 98.34:  30%|███       | 6/20 [00:39<01:39,  7.12s/it]
Task 1, Epoch 7/20 => Loss 0.088, Train_accy 96.67:  30%|███       | 6/20 [00:44<01:39,  7.12s/it]
Task 1, Epoch 7/20 => Loss 0.088, Train_accy 96.67:  35%|███▌      | 7/20 [00:44<01:23,  6.46s/it]
Task 1, Epoch 8/20 => Loss 0.092, Train_accy 95.84:  35%|███▌      | 7/20 [00:49<01:23,  6.46s/it]
Task 1, Epoch 8/20 => Loss 0.092, Train_accy 95.84:  40%|████      | 8/20 [00:49<01:11,  5.99s/it]
Task 1, Epoch 9/20 => Loss 0.073, Train_accy 97.92:  40%|████      | 8/20 [00:54<01:11,  5.99s/it]
Task 1, Epoch 9/20 => Loss 0.073, Train_accy 97.92:  45%|████▌     | 9/20 [00:54<01:02,  5.68s/it]
Task 1, Epoch 10/20 => Loss 0.065, Train_accy 97.71, Test_accy 86.26:  45%|████▌     | 9/20 [01:07<01:02,  5.68s/it]
Task 1, Epoch 10/20 => Loss 0.065, Train_accy 97.71, Test_accy 86.26:  50%|█████     | 10/20 [01:07<01:21,  8.17s/it]
Task 1, Epoch 11/20 => Loss 0.067, Train_accy 98.96:  50%|█████     | 10/20 [01:12<01:21,  8.17s/it]                 
Task 1, Epoch 11/20 => Loss 0.067, Train_accy 98.96:  55%|█████▌    | 11/20 [01:12<01:04,  7.19s/it]
Task 1, Epoch 12/20 => Loss 0.065, Train_accy 98.13:  55%|█████▌    | 11/20 [01:17<01:04,  7.19s/it]
Task 1, Epoch 12/20 => Loss 0.065, Train_accy 98.13:  60%|██████    | 12/20 [01:17<00:52,  6.55s/it]
Task 1, Epoch 13/20 => Loss 0.047, Train_accy 98.75:  60%|██████    | 12/20 [01:23<00:52,  6.55s/it]
Task 1, Epoch 13/20 => Loss 0.047, Train_accy 98.75:  65%|██████▌   | 13/20 [01:23<00:42,  6.11s/it]
Task 1, Epoch 14/20 => Loss 0.064, Train_accy 96.26:  65%|██████▌   | 13/20 [01:28<00:42,  6.11s/it]
Task 1, Epoch 14/20 => Loss 0.064, Train_accy 96.26:  70%|███████   | 14/20 [01:28<00:35,  5.84s/it]
Task 1, Epoch 15/20 => Loss 0.061, Train_accy 97.09, Test_accy 86.34:  70%|███████   | 14/20 [01:41<00:35,  5.84s/it]
Task 1, Epoch 15/20 => Loss 0.061, Train_accy 97.09, Test_accy 86.34:  75%|███████▌  | 15/20 [01:41<00:40,  8.18s/it]
Task 1, Epoch 16/20 => Loss 0.063, Train_accy 96.88:  75%|███████▌  | 15/20 [01:46<00:40,  8.18s/it]                 
Task 1, Epoch 16/20 => Loss 0.063, Train_accy 96.88:  80%|████████  | 16/20 [01:46<00:28,  7.23s/it]
Task 1, Epoch 17/20 => Loss 0.051, Train_accy 97.92:  80%|████████  | 16/20 [01:51<00:28,  7.23s/it]
Task 1, Epoch 17/20 => Loss 0.051, Train_accy 97.92:  85%|████████▌ | 17/20 [01:51<00:19,  6.59s/it]
Task 1, Epoch 18/20 => Loss 0.063, Train_accy 97.71:  85%|████████▌ | 17/20 [01:57<00:19,  6.59s/it]
Task 1, Epoch 18/20 => Loss 0.063, Train_accy 97.71:  90%|█████████ | 18/20 [01:57<00:12,  6.14s/it]
Task 1, Epoch 19/20 => Loss 0.063, Train_accy 97.51:  90%|█████████ | 18/20 [02:02<00:12,  6.14s/it]
Task 1, Epoch 19/20 => Loss 0.063, Train_accy 97.51:  95%|█████████▌| 19/20 [02:02<00:05,  5.81s/it]
Task 1, Epoch 20/20 => Loss 0.037, Train_accy 98.13, Test_accy 86.49:  95%|█████████▌| 19/20 [02:14<00:05,  5.81s/it]
Task 1, Epoch 20/20 => Loss 0.037, Train_accy 98.13, Test_accy 86.49: 100%|██████████| 20/20 [02:14<00:00,  7.87s/it]
Task 1, Epoch 20/20 => Loss 0.037, Train_accy 98.13, Test_accy 86.49: 100%|██████████| 20/20 [02:14<00:00,  6.74s/it]2024-09-13 20:17:13,544 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.037, Train_accy 98.13, Test_accy 86.49

2024-09-13 20:17:21,535 [trainer.py] => No NME accuracy.
2024-09-13 20:17:21,535 [trainer.py] => CNN: {'total': 86.49, '00-99': 90.4, '100-109': 46.09, 'old': 90.4, 'new': 46.09}
2024-09-13 20:17:21,535 [trainer.py] => CNN top1 curve: [89.98, 86.49]
2024-09-13 20:17:21,535 [trainer.py] => CNN top5 curve: [98.82, 98.7]

Average Accuracy (CNN): 88.24
2024-09-13 20:17:21,535 [trainer.py] => Average Accuracy (CNN): 88.24 

2024-09-13 20:17:21,537 [trainer.py] => All params: 172158352
2024-09-13 20:17:21,538 [trainer.py] => Trainable params: 407240
2024-09-13 20:17:21,538 [dualprompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.144, Train_accy 64.97:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.144, Train_accy 64.97:   5%|▌         | 1/20 [00:04<01:34,  4.95s/it]
Task 2, Epoch 2/20 => Loss 0.232, Train_accy 93.21:   5%|▌         | 1/20 [00:09<01:34,  4.95s/it]
Task 2, Epoch 2/20 => Loss 0.232, Train_accy 93.21:  10%|█         | 2/20 [00:09<01:28,  4.89s/it]
Task 2, Epoch 3/20 => Loss 0.161, Train_accy 94.69:  10%|█         | 2/20 [00:14<01:28,  4.89s/it]
Task 2, Epoch 3/20 => Loss 0.161, Train_accy 94.69:  15%|█▌        | 3/20 [00:14<01:24,  4.94s/it]
Task 2, Epoch 4/20 => Loss 0.092, Train_accy 97.24:  15%|█▌        | 3/20 [00:19<01:24,  4.94s/it]
Task 2, Epoch 4/20 => Loss 0.092, Train_accy 97.24:  20%|██        | 4/20 [00:19<01:19,  4.95s/it]
Task 2, Epoch 5/20 => Loss 0.092, Train_accy 97.45, Test_accy 81.71:  20%|██        | 4/20 [00:34<01:19,  4.95s/it]
Task 2, Epoch 5/20 => Loss 0.092, Train_accy 97.45, Test_accy 81.71:  25%|██▌       | 5/20 [00:34<02:04,  8.32s/it]
Task 2, Epoch 6/20 => Loss 0.054, Train_accy 97.88:  25%|██▌       | 5/20 [00:39<02:04,  8.32s/it]                 
Task 2, Epoch 6/20 => Loss 0.054, Train_accy 97.88:  30%|███       | 6/20 [00:39<01:40,  7.18s/it]
Task 2, Epoch 7/20 => Loss 0.062, Train_accy 98.09:  30%|███       | 6/20 [00:43<01:40,  7.18s/it]
Task 2, Epoch 7/20 => Loss 0.062, Train_accy 98.09:  35%|███▌      | 7/20 [00:43<01:23,  6.43s/it]
Task 2, Epoch 8/20 => Loss 0.091, Train_accy 96.82:  35%|███▌      | 7/20 [00:48<01:23,  6.43s/it]
Task 2, Epoch 8/20 => Loss 0.091, Train_accy 96.82:  40%|████      | 8/20 [00:48<01:11,  5.95s/it]
Task 2, Epoch 9/20 => Loss 0.059, Train_accy 98.09:  40%|████      | 8/20 [00:53<01:11,  5.95s/it]
Task 2, Epoch 9/20 => Loss 0.059, Train_accy 98.09:  45%|████▌     | 9/20 [00:53<01:02,  5.65s/it]
Task 2, Epoch 10/20 => Loss 0.086, Train_accy 96.60, Test_accy 81.92:  45%|████▌     | 9/20 [01:08<01:02,  5.65s/it]
Task 2, Epoch 10/20 => Loss 0.086, Train_accy 96.60, Test_accy 81.92:  50%|█████     | 10/20 [01:08<01:22,  8.29s/it]
Task 2, Epoch 11/20 => Loss 0.098, Train_accy 96.60:  50%|█████     | 10/20 [01:13<01:22,  8.29s/it]                 
Task 2, Epoch 11/20 => Loss 0.098, Train_accy 96.60:  55%|█████▌    | 11/20 [01:13<01:05,  7.28s/it]
Task 2, Epoch 12/20 => Loss 0.053, Train_accy 98.51:  55%|█████▌    | 11/20 [01:18<01:05,  7.28s/it]
Task 2, Epoch 12/20 => Loss 0.053, Train_accy 98.51:  60%|██████    | 12/20 [01:18<00:52,  6.60s/it]
Task 2, Epoch 13/20 => Loss 0.039, Train_accy 98.09:  60%|██████    | 12/20 [01:23<00:52,  6.60s/it]
Task 2, Epoch 13/20 => Loss 0.039, Train_accy 98.09:  65%|██████▌   | 13/20 [01:23<00:42,  6.11s/it]
Task 2, Epoch 14/20 => Loss 0.045, Train_accy 97.88:  65%|██████▌   | 13/20 [01:28<00:42,  6.11s/it]
Task 2, Epoch 14/20 => Loss 0.045, Train_accy 97.88:  70%|███████   | 14/20 [01:28<00:34,  5.81s/it]
Task 2, Epoch 15/20 => Loss 0.038, Train_accy 98.30, Test_accy 82.06:  70%|███████   | 14/20 [01:42<00:34,  5.81s/it]
Task 2, Epoch 15/20 => Loss 0.038, Train_accy 98.30, Test_accy 82.06:  75%|███████▌  | 15/20 [01:42<00:41,  8.37s/it]
Task 2, Epoch 16/20 => Loss 0.048, Train_accy 98.09:  75%|███████▌  | 15/20 [01:47<00:41,  8.37s/it]                 
Task 2, Epoch 16/20 => Loss 0.048, Train_accy 98.09:  80%|████████  | 16/20 [01:47<00:29,  7.36s/it]
Task 2, Epoch 17/20 => Loss 0.032, Train_accy 98.73:  80%|████████  | 16/20 [01:52<00:29,  7.36s/it]
Task 2, Epoch 17/20 => Loss 0.032, Train_accy 98.73:  85%|████████▌ | 17/20 [01:52<00:19,  6.66s/it]
Task 2, Epoch 18/20 => Loss 0.032, Train_accy 98.94:  85%|████████▌ | 17/20 [01:57<00:19,  6.66s/it]
Task 2, Epoch 18/20 => Loss 0.032, Train_accy 98.94:  90%|█████████ | 18/20 [01:57<00:12,  6.17s/it]
Task 2, Epoch 19/20 => Loss 0.075, Train_accy 97.66:  90%|█████████ | 18/20 [02:02<00:12,  6.17s/it]
Task 2, Epoch 19/20 => Loss 0.075, Train_accy 97.66:  95%|█████████▌| 19/20 [02:02<00:05,  5.80s/it]
Task 2, Epoch 20/20 => Loss 0.035, Train_accy 99.15, Test_accy 82.06:  95%|█████████▌| 19/20 [02:16<00:05,  5.80s/it]
Task 2, Epoch 20/20 => Loss 0.035, Train_accy 99.15, Test_accy 82.06: 100%|██████████| 20/20 [02:16<00:00,  8.29s/it]
Task 2, Epoch 20/20 => Loss 0.035, Train_accy 99.15, Test_accy 82.06: 100%|██████████| 20/20 [02:16<00:00,  6.83s/it]2024-09-13 20:19:38,115 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.035, Train_accy 99.15, Test_accy 82.06

2024-09-13 20:19:47,233 [trainer.py] => No NME accuracy.
2024-09-13 20:19:47,234 [trainer.py] => CNN: {'total': 82.06, '00-99': 90.49, '100-109': 46.09, '110-119': 30.09, 'old': 86.57, 'new': 30.09}
2024-09-13 20:19:47,234 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06]
2024-09-13 20:19:47,234 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59]

Average Accuracy (CNN): 86.18
2024-09-13 20:19:47,234 [trainer.py] => Average Accuracy (CNN): 86.18 

2024-09-13 20:19:47,236 [trainer.py] => All params: 172158352
2024-09-13 20:19:47,237 [trainer.py] => Trainable params: 407240
2024-09-13 20:19:47,237 [dualprompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.235, Train_accy 57.68:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.235, Train_accy 57.68:   5%|▌         | 1/20 [00:05<01:36,  5.06s/it]
Task 3, Epoch 2/20 => Loss 0.440, Train_accy 86.10:   5%|▌         | 1/20 [00:10<01:36,  5.06s/it]
Task 3, Epoch 2/20 => Loss 0.440, Train_accy 86.10:  10%|█         | 2/20 [00:10<01:30,  5.05s/it]
Task 3, Epoch 3/20 => Loss 0.331, Train_accy 90.66:  10%|█         | 2/20 [00:15<01:30,  5.05s/it]
Task 3, Epoch 3/20 => Loss 0.331, Train_accy 90.66:  15%|█▌        | 3/20 [00:15<01:26,  5.06s/it]
Task 3, Epoch 4/20 => Loss 0.188, Train_accy 92.53:  15%|█▌        | 3/20 [00:20<01:26,  5.06s/it]
Task 3, Epoch 4/20 => Loss 0.188, Train_accy 92.53:  20%|██        | 4/20 [00:20<01:21,  5.12s/it]
Task 3, Epoch 5/20 => Loss 0.149, Train_accy 93.98, Test_accy 78.73:  20%|██        | 4/20 [00:35<01:21,  5.12s/it]
Task 3, Epoch 5/20 => Loss 0.149, Train_accy 93.98, Test_accy 78.73:  25%|██▌       | 5/20 [00:35<02:09,  8.63s/it]
Task 3, Epoch 6/20 => Loss 0.164, Train_accy 92.95:  25%|██▌       | 5/20 [00:40<02:09,  8.63s/it]                 
Task 3, Epoch 6/20 => Loss 0.164, Train_accy 92.95:  30%|███       | 6/20 [00:40<01:44,  7.43s/it]
Task 3, Epoch 7/20 => Loss 0.162, Train_accy 94.40:  30%|███       | 6/20 [00:45<01:44,  7.43s/it]
Task 3, Epoch 7/20 => Loss 0.162, Train_accy 94.40:  35%|███▌      | 7/20 [00:45<01:26,  6.68s/it]
Task 3, Epoch 8/20 => Loss 0.164, Train_accy 95.85:  35%|███▌      | 7/20 [00:50<01:26,  6.68s/it]
Task 3, Epoch 8/20 => Loss 0.164, Train_accy 95.85:  40%|████      | 8/20 [00:50<01:14,  6.19s/it]
Task 3, Epoch 9/20 => Loss 0.123, Train_accy 95.44:  40%|████      | 8/20 [00:55<01:14,  6.19s/it]
Task 3, Epoch 9/20 => Loss 0.123, Train_accy 95.44:  45%|████▌     | 9/20 [00:55<01:04,  5.85s/it]
Task 3, Epoch 10/20 => Loss 0.152, Train_accy 93.15, Test_accy 78.79:  45%|████▌     | 9/20 [01:10<01:04,  5.85s/it]
Task 3, Epoch 10/20 => Loss 0.152, Train_accy 93.15, Test_accy 78.79:  50%|█████     | 10/20 [01:10<01:26,  8.68s/it]
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 95.64:  50%|█████     | 10/20 [01:15<01:26,  8.68s/it]                 
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 95.64:  55%|█████▌    | 11/20 [01:15<01:08,  7.60s/it]
Task 3, Epoch 12/20 => Loss 0.104, Train_accy 96.47:  55%|█████▌    | 11/20 [01:21<01:08,  7.60s/it]
Task 3, Epoch 12/20 => Loss 0.104, Train_accy 96.47:  60%|██████    | 12/20 [01:21<00:54,  6.86s/it]
Task 3, Epoch 13/20 => Loss 0.075, Train_accy 97.30:  60%|██████    | 12/20 [01:26<00:54,  6.86s/it]
Task 3, Epoch 13/20 => Loss 0.075, Train_accy 97.30:  65%|██████▌   | 13/20 [01:26<00:44,  6.35s/it]
Task 3, Epoch 14/20 => Loss 0.100, Train_accy 95.85:  65%|██████▌   | 13/20 [01:31<00:44,  6.35s/it]
Task 3, Epoch 14/20 => Loss 0.100, Train_accy 95.85:  70%|███████   | 14/20 [01:31<00:35,  6.00s/it]
Task 3, Epoch 15/20 => Loss 0.107, Train_accy 95.64, Test_accy 78.92:  70%|███████   | 14/20 [01:46<00:35,  6.00s/it]
Task 3, Epoch 15/20 => Loss 0.107, Train_accy 95.64, Test_accy 78.92:  75%|███████▌  | 15/20 [01:46<00:43,  8.65s/it]
Task 3, Epoch 16/20 => Loss 0.154, Train_accy 95.64:  75%|███████▌  | 15/20 [01:50<00:43,  8.65s/it]                 
Task 3, Epoch 16/20 => Loss 0.154, Train_accy 95.64:  80%|████████  | 16/20 [01:50<00:29,  7.42s/it]
Task 3, Epoch 17/20 => Loss 0.124, Train_accy 93.98:  80%|████████  | 16/20 [01:55<00:29,  7.42s/it]
Task 3, Epoch 17/20 => Loss 0.124, Train_accy 93.98:  85%|████████▌ | 17/20 [01:55<00:19,  6.62s/it]
Task 3, Epoch 18/20 => Loss 0.126, Train_accy 94.19:  85%|████████▌ | 17/20 [02:00<00:19,  6.62s/it]
Task 3, Epoch 18/20 => Loss 0.126, Train_accy 94.19:  90%|█████████ | 18/20 [02:00<00:12,  6.01s/it]
Task 3, Epoch 19/20 => Loss 0.082, Train_accy 96.27:  90%|█████████ | 18/20 [02:05<00:12,  6.01s/it]
Task 3, Epoch 19/20 => Loss 0.082, Train_accy 96.27:  95%|█████████▌| 19/20 [02:05<00:05,  5.68s/it]
Task 3, Epoch 20/20 => Loss 0.081, Train_accy 96.89, Test_accy 79.32:  95%|█████████▌| 19/20 [02:19<00:05,  5.68s/it]
Task 3, Epoch 20/20 => Loss 0.081, Train_accy 96.89, Test_accy 79.32: 100%|██████████| 20/20 [02:19<00:00,  8.46s/it]
Task 3, Epoch 20/20 => Loss 0.081, Train_accy 96.89, Test_accy 79.32: 100%|██████████| 20/20 [02:19<00:00,  7.00s/it]2024-09-13 20:22:07,218 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.081, Train_accy 96.89, Test_accy 79.32

2024-09-13 20:22:17,052 [trainer.py] => No NME accuracy.
2024-09-13 20:22:17,052 [trainer.py] => CNN: {'total': 79.32, '00-99': 90.24, '100-109': 46.96, '110-119': 30.09, '120-129': 44.86, 'old': 81.92, 'new': 44.86}
2024-09-13 20:22:17,053 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32]
2024-09-13 20:22:17,053 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36]

Average Accuracy (CNN): 84.46
2024-09-13 20:22:17,053 [trainer.py] => Average Accuracy (CNN): 84.46 

2024-09-13 20:22:17,054 [trainer.py] => All params: 172158352
2024-09-13 20:22:17,055 [trainer.py] => Trainable params: 407240
2024-09-13 20:22:17,055 [dualprompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.561, Train_accy 51.06:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.561, Train_accy 51.06:   5%|▌         | 1/20 [00:05<01:35,  5.02s/it]
Task 4, Epoch 2/20 => Loss 0.331, Train_accy 88.77:   5%|▌         | 1/20 [00:09<01:35,  5.02s/it]
Task 4, Epoch 2/20 => Loss 0.331, Train_accy 88.77:  10%|█         | 2/20 [00:09<01:29,  4.98s/it]
Task 4, Epoch 3/20 => Loss 0.178, Train_accy 94.49:  10%|█         | 2/20 [00:15<01:29,  4.98s/it]
Task 4, Epoch 3/20 => Loss 0.178, Train_accy 94.49:  15%|█▌        | 3/20 [00:15<01:25,  5.03s/it]
Task 4, Epoch 4/20 => Loss 0.163, Train_accy 94.49:  15%|█▌        | 3/20 [00:20<01:25,  5.03s/it]
Task 4, Epoch 4/20 => Loss 0.163, Train_accy 94.49:  20%|██        | 4/20 [00:20<01:20,  5.02s/it]
Task 4, Epoch 5/20 => Loss 0.139, Train_accy 94.70, Test_accy 74.77:  20%|██        | 4/20 [00:35<01:20,  5.02s/it]
Task 4, Epoch 5/20 => Loss 0.139, Train_accy 94.70, Test_accy 74.77:  25%|██▌       | 5/20 [00:35<02:13,  8.91s/it]
Task 4, Epoch 6/20 => Loss 0.185, Train_accy 94.49:  25%|██▌       | 5/20 [00:40<02:13,  8.91s/it]                 
Task 4, Epoch 6/20 => Loss 0.185, Train_accy 94.49:  30%|███       | 6/20 [00:40<01:46,  7.58s/it]
Task 4, Epoch 7/20 => Loss 0.131, Train_accy 95.13:  30%|███       | 6/20 [00:45<01:46,  7.58s/it]
Task 4, Epoch 7/20 => Loss 0.131, Train_accy 95.13:  35%|███▌      | 7/20 [00:45<01:27,  6.75s/it]
Task 4, Epoch 8/20 => Loss 0.113, Train_accy 95.97:  35%|███▌      | 7/20 [00:50<01:27,  6.75s/it]
Task 4, Epoch 8/20 => Loss 0.113, Train_accy 95.97:  40%|████      | 8/20 [00:50<01:13,  6.16s/it]
Task 4, Epoch 9/20 => Loss 0.136, Train_accy 95.55:  40%|████      | 8/20 [00:55<01:13,  6.16s/it]
Task 4, Epoch 9/20 => Loss 0.136, Train_accy 95.55:  45%|████▌     | 9/20 [00:55<01:04,  5.83s/it]
Task 4, Epoch 10/20 => Loss 0.079, Train_accy 97.88, Test_accy 74.95:  45%|████▌     | 9/20 [01:11<01:04,  5.83s/it]
Task 4, Epoch 10/20 => Loss 0.079, Train_accy 97.88, Test_accy 74.95:  50%|█████     | 10/20 [01:11<01:28,  8.89s/it]
Task 4, Epoch 11/20 => Loss 0.148, Train_accy 94.07:  50%|█████     | 10/20 [01:16<01:28,  8.89s/it]                 
Task 4, Epoch 11/20 => Loss 0.148, Train_accy 94.07:  55%|█████▌    | 11/20 [01:16<01:09,  7.69s/it]
Task 4, Epoch 12/20 => Loss 0.069, Train_accy 97.46:  55%|█████▌    | 11/20 [01:21<01:09,  7.69s/it]
Task 4, Epoch 12/20 => Loss 0.069, Train_accy 97.46:  60%|██████    | 12/20 [01:21<00:54,  6.85s/it]
Task 4, Epoch 13/20 => Loss 0.065, Train_accy 97.25:  60%|██████    | 12/20 [01:26<00:54,  6.85s/it]
Task 4, Epoch 13/20 => Loss 0.065, Train_accy 97.25:  65%|██████▌   | 13/20 [01:26<00:43,  6.27s/it]
Task 4, Epoch 14/20 => Loss 0.097, Train_accy 96.40:  65%|██████▌   | 13/20 [01:31<00:43,  6.27s/it]
Task 4, Epoch 14/20 => Loss 0.097, Train_accy 96.40:  70%|███████   | 14/20 [01:31<00:35,  5.91s/it]
Task 4, Epoch 15/20 => Loss 0.073, Train_accy 97.67, Test_accy 75.20:  70%|███████   | 14/20 [01:46<00:35,  5.91s/it]
Task 4, Epoch 15/20 => Loss 0.073, Train_accy 97.67, Test_accy 75.20:  75%|███████▌  | 15/20 [01:46<00:43,  8.76s/it]
Task 4, Epoch 16/20 => Loss 0.085, Train_accy 96.40:  75%|███████▌  | 15/20 [01:51<00:43,  8.76s/it]                 
Task 4, Epoch 16/20 => Loss 0.085, Train_accy 96.40:  80%|████████  | 16/20 [01:51<00:30,  7.62s/it]
Task 4, Epoch 17/20 => Loss 0.098, Train_accy 96.82:  80%|████████  | 16/20 [01:56<00:30,  7.62s/it]
Task 4, Epoch 17/20 => Loss 0.098, Train_accy 96.82:  85%|████████▌ | 17/20 [01:56<00:20,  6.83s/it]
Task 4, Epoch 18/20 => Loss 0.084, Train_accy 95.97:  85%|████████▌ | 17/20 [02:01<00:20,  6.83s/it]
Task 4, Epoch 18/20 => Loss 0.084, Train_accy 95.97:  90%|█████████ | 18/20 [02:01<00:12,  6.26s/it]
Task 4, Epoch 19/20 => Loss 0.096, Train_accy 95.55:  90%|█████████ | 18/20 [02:06<00:12,  6.26s/it]
Task 4, Epoch 19/20 => Loss 0.096, Train_accy 95.55:  95%|█████████▌| 19/20 [02:06<00:05,  5.88s/it]
Task 4, Epoch 20/20 => Loss 0.145, Train_accy 94.28, Test_accy 75.32:  95%|█████████▌| 19/20 [02:22<00:05,  5.88s/it]
Task 4, Epoch 20/20 => Loss 0.145, Train_accy 94.28, Test_accy 75.32: 100%|██████████| 20/20 [02:22<00:00,  8.78s/it]
Task 4, Epoch 20/20 => Loss 0.145, Train_accy 94.28, Test_accy 75.32: 100%|██████████| 20/20 [02:22<00:00,  7.12s/it]2024-09-13 20:24:39,446 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.145, Train_accy 94.28, Test_accy 75.32

2024-09-13 20:24:50,042 [trainer.py] => No NME accuracy.
2024-09-13 20:24:50,042 [trainer.py] => CNN: {'total': 75.32, '00-99': 90.24, '100-109': 46.09, '110-119': 29.2, '120-129': 43.93, '130-139': 26.27, 'old': 79.12, 'new': 26.27}
2024-09-13 20:24:50,042 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32, 75.32]
2024-09-13 20:24:50,042 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36, 98.05]

Average Accuracy (CNN): 82.63
2024-09-13 20:24:50,042 [trainer.py] => Average Accuracy (CNN): 82.63 

2024-09-13 20:24:50,044 [trainer.py] => All params: 172158352
2024-09-13 20:24:50,045 [trainer.py] => Trainable params: 407240
2024-09-13 20:24:50,045 [dualprompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.691, Train_accy 48.01:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.691, Train_accy 48.01:   5%|▌         | 1/20 [00:04<01:33,  4.93s/it]
Task 5, Epoch 2/20 => Loss 0.296, Train_accy 91.15:   5%|▌         | 1/20 [00:09<01:33,  4.93s/it]
Task 5, Epoch 2/20 => Loss 0.296, Train_accy 91.15:  10%|█         | 2/20 [00:09<01:27,  4.89s/it]
Task 5, Epoch 3/20 => Loss 0.190, Train_accy 95.35:  10%|█         | 2/20 [00:14<01:27,  4.89s/it]
Task 5, Epoch 3/20 => Loss 0.190, Train_accy 95.35:  15%|█▌        | 3/20 [00:14<01:22,  4.87s/it]
Task 5, Epoch 4/20 => Loss 0.164, Train_accy 94.47:  15%|█▌        | 3/20 [00:19<01:22,  4.87s/it]
Task 5, Epoch 4/20 => Loss 0.164, Train_accy 94.47:  20%|██        | 4/20 [00:19<01:17,  4.86s/it]
Task 5, Epoch 5/20 => Loss 0.198, Train_accy 93.58, Test_accy 71.42:  20%|██        | 4/20 [00:35<01:17,  4.86s/it]
Task 5, Epoch 5/20 => Loss 0.198, Train_accy 93.58, Test_accy 71.42:  25%|██▌       | 5/20 [00:35<02:13,  8.92s/it]
Task 5, Epoch 6/20 => Loss 0.189, Train_accy 93.14:  25%|██▌       | 5/20 [00:40<02:13,  8.92s/it]                 
Task 5, Epoch 6/20 => Loss 0.189, Train_accy 93.14:  30%|███       | 6/20 [00:40<01:45,  7.55s/it]
Task 5, Epoch 7/20 => Loss 0.111, Train_accy 96.02:  30%|███       | 6/20 [00:45<01:45,  7.55s/it]
Task 5, Epoch 7/20 => Loss 0.111, Train_accy 96.02:  35%|███▌      | 7/20 [00:45<01:26,  6.63s/it]
Task 5, Epoch 8/20 => Loss 0.129, Train_accy 95.58:  35%|███▌      | 7/20 [00:50<01:26,  6.63s/it]
Task 5, Epoch 8/20 => Loss 0.129, Train_accy 95.58:  40%|████      | 8/20 [00:50<01:12,  6.08s/it]
Task 5, Epoch 9/20 => Loss 0.078, Train_accy 97.35:  40%|████      | 8/20 [00:55<01:12,  6.08s/it]
Task 5, Epoch 9/20 => Loss 0.078, Train_accy 97.35:  45%|████▌     | 9/20 [00:55<01:02,  5.72s/it]
Task 5, Epoch 10/20 => Loss 0.156, Train_accy 95.35, Test_accy 71.70:  45%|████▌     | 9/20 [01:10<01:02,  5.72s/it]
Task 5, Epoch 10/20 => Loss 0.156, Train_accy 95.35, Test_accy 71.70:  50%|█████     | 10/20 [01:10<01:28,  8.86s/it]
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 97.35:  50%|█████     | 10/20 [01:15<01:28,  8.86s/it]                 
Task 5, Epoch 11/20 => Loss 0.100, Train_accy 97.35:  55%|█████▌    | 11/20 [01:15<01:08,  7.58s/it]
Task 5, Epoch 12/20 => Loss 0.119, Train_accy 95.35:  55%|█████▌    | 11/20 [01:20<01:08,  7.58s/it]
Task 5, Epoch 12/20 => Loss 0.119, Train_accy 95.35:  60%|██████    | 12/20 [01:20<00:53,  6.64s/it]
Task 5, Epoch 13/20 => Loss 0.099, Train_accy 96.24:  60%|██████    | 12/20 [01:24<00:53,  6.64s/it]
Task 5, Epoch 13/20 => Loss 0.099, Train_accy 96.24:  65%|██████▌   | 13/20 [01:24<00:41,  5.97s/it]
Task 5, Epoch 14/20 => Loss 0.074, Train_accy 96.68:  65%|██████▌   | 13/20 [01:28<00:41,  5.97s/it]
Task 5, Epoch 14/20 => Loss 0.074, Train_accy 96.68:  70%|███████   | 14/20 [01:28<00:32,  5.50s/it]
Task 5, Epoch 15/20 => Loss 0.107, Train_accy 96.24, Test_accy 71.82:  70%|███████   | 14/20 [01:44<00:32,  5.50s/it]
Task 5, Epoch 15/20 => Loss 0.107, Train_accy 96.24, Test_accy 71.82:  75%|███████▌  | 15/20 [01:44<00:42,  8.55s/it]
Task 5, Epoch 16/20 => Loss 0.099, Train_accy 96.02:  75%|███████▌  | 15/20 [01:49<00:42,  8.55s/it]                 
Task 5, Epoch 16/20 => Loss 0.099, Train_accy 96.02:  80%|████████  | 16/20 [01:49<00:29,  7.43s/it]
Task 5, Epoch 17/20 => Loss 0.100, Train_accy 96.24:  80%|████████  | 16/20 [01:54<00:29,  7.43s/it]
Task 5, Epoch 17/20 => Loss 0.100, Train_accy 96.24:  85%|████████▌ | 17/20 [01:54<00:20,  6.68s/it]
Task 5, Epoch 18/20 => Loss 0.127, Train_accy 95.58:  85%|████████▌ | 17/20 [01:59<00:20,  6.68s/it]
Task 5, Epoch 18/20 => Loss 0.127, Train_accy 95.58:  90%|█████████ | 18/20 [01:59<00:12,  6.12s/it]
Task 5, Epoch 19/20 => Loss 0.103, Train_accy 97.12:  90%|█████████ | 18/20 [02:03<00:12,  6.12s/it]
Task 5, Epoch 19/20 => Loss 0.103, Train_accy 97.12:  95%|█████████▌| 19/20 [02:03<00:05,  5.74s/it]
Task 5, Epoch 20/20 => Loss 0.036, Train_accy 98.67, Test_accy 71.87:  95%|█████████▌| 19/20 [02:20<00:05,  5.74s/it]
Task 5, Epoch 20/20 => Loss 0.036, Train_accy 98.67, Test_accy 71.87: 100%|██████████| 20/20 [02:20<00:00,  8.86s/it]
Task 5, Epoch 20/20 => Loss 0.036, Train_accy 98.67, Test_accy 71.87: 100%|██████████| 20/20 [02:20<00:00,  7.01s/it]2024-09-13 20:27:10,180 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.036, Train_accy 98.67, Test_accy 71.87

2024-09-13 20:27:21,599 [trainer.py] => No NME accuracy.
2024-09-13 20:27:21,599 [trainer.py] => CNN: {'total': 71.87, '00-99': 90.15, '100-109': 46.09, '110-119': 29.2, '120-129': 43.93, '130-139': 26.27, '140-149': 27.78, 'old': 75.26, 'new': 27.78}
2024-09-13 20:27:21,600 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32, 75.32, 71.87]
2024-09-13 20:27:21,600 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36, 98.05, 98.02]

Average Accuracy (CNN): 80.84
2024-09-13 20:27:21,600 [trainer.py] => Average Accuracy (CNN): 80.84 

2024-09-13 20:27:21,601 [trainer.py] => All params: 172158352
2024-09-13 20:27:21,603 [trainer.py] => Trainable params: 407240
2024-09-13 20:27:21,603 [dualprompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.400, Train_accy 56.20:   0%|          | 0/20 [00:04<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.400, Train_accy 56.20:   5%|▌         | 1/20 [00:04<01:33,  4.92s/it]
Task 6, Epoch 2/20 => Loss 0.277, Train_accy 90.38:   5%|▌         | 1/20 [00:09<01:33,  4.92s/it]
Task 6, Epoch 2/20 => Loss 0.277, Train_accy 90.38:  10%|█         | 2/20 [00:09<01:29,  4.99s/it]
Task 6, Epoch 3/20 => Loss 0.229, Train_accy 93.16:  10%|█         | 2/20 [00:14<01:29,  4.99s/it]
Task 6, Epoch 3/20 => Loss 0.229, Train_accy 93.16:  15%|█▌        | 3/20 [00:14<01:24,  4.99s/it]
Task 6, Epoch 4/20 => Loss 0.149, Train_accy 95.30:  15%|█▌        | 3/20 [00:20<01:24,  4.99s/it]
Task 6, Epoch 4/20 => Loss 0.149, Train_accy 95.30:  20%|██        | 4/20 [00:20<01:20,  5.04s/it]
Task 6, Epoch 5/20 => Loss 0.174, Train_accy 94.23, Test_accy 68.54:  20%|██        | 4/20 [00:36<01:20,  5.04s/it]
Task 6, Epoch 5/20 => Loss 0.174, Train_accy 94.23, Test_accy 68.54:  25%|██▌       | 5/20 [00:36<02:19,  9.30s/it]
Task 6, Epoch 6/20 => Loss 0.108, Train_accy 95.94:  25%|██▌       | 5/20 [00:42<02:19,  9.30s/it]                 
Task 6, Epoch 6/20 => Loss 0.108, Train_accy 95.94:  30%|███       | 6/20 [00:42<01:50,  7.90s/it]
Task 6, Epoch 7/20 => Loss 0.140, Train_accy 94.44:  30%|███       | 6/20 [00:46<01:50,  7.90s/it]
Task 6, Epoch 7/20 => Loss 0.140, Train_accy 94.44:  35%|███▌      | 7/20 [00:46<01:29,  6.91s/it]
Task 6, Epoch 8/20 => Loss 0.089, Train_accy 96.79:  35%|███▌      | 7/20 [00:51<01:29,  6.91s/it]
Task 6, Epoch 8/20 => Loss 0.089, Train_accy 96.79:  40%|████      | 8/20 [00:51<01:15,  6.28s/it]
Task 6, Epoch 9/20 => Loss 0.136, Train_accy 95.73:  40%|████      | 8/20 [00:56<01:15,  6.28s/it]
Task 6, Epoch 9/20 => Loss 0.136, Train_accy 95.73:  45%|████▌     | 9/20 [00:56<01:04,  5.85s/it]
Task 6, Epoch 10/20 => Loss 0.131, Train_accy 95.30, Test_accy 68.75:  45%|████▌     | 9/20 [01:13<01:04,  5.85s/it]
Task 6, Epoch 10/20 => Loss 0.131, Train_accy 95.30, Test_accy 68.75:  50%|█████     | 10/20 [01:13<01:32,  9.23s/it]
Task 6, Epoch 11/20 => Loss 0.104, Train_accy 96.37:  50%|█████     | 10/20 [01:18<01:32,  9.23s/it]                 
Task 6, Epoch 11/20 => Loss 0.104, Train_accy 96.37:  55%|█████▌    | 11/20 [01:18<01:11,  7.93s/it]
Task 6, Epoch 12/20 => Loss 0.099, Train_accy 96.37:  55%|█████▌    | 11/20 [01:23<01:11,  7.93s/it]
Task 6, Epoch 12/20 => Loss 0.099, Train_accy 96.37:  60%|██████    | 12/20 [01:23<00:56,  7.03s/it]
Task 6, Epoch 13/20 => Loss 0.143, Train_accy 95.09:  60%|██████    | 12/20 [01:28<00:56,  7.03s/it]
Task 6, Epoch 13/20 => Loss 0.143, Train_accy 95.09:  65%|██████▌   | 13/20 [01:28<00:44,  6.38s/it]
Task 6, Epoch 14/20 => Loss 0.102, Train_accy 96.15:  65%|██████▌   | 13/20 [01:33<00:44,  6.38s/it]
Task 6, Epoch 14/20 => Loss 0.102, Train_accy 96.15:  70%|███████   | 14/20 [01:33<00:35,  5.92s/it]
Task 6, Epoch 15/20 => Loss 0.087, Train_accy 96.58, Test_accy 68.85:  70%|███████   | 14/20 [01:50<00:35,  5.92s/it]
Task 6, Epoch 15/20 => Loss 0.087, Train_accy 96.58, Test_accy 68.85:  75%|███████▌  | 15/20 [01:50<00:46,  9.27s/it]
Task 6, Epoch 16/20 => Loss 0.085, Train_accy 98.08:  75%|███████▌  | 15/20 [01:55<00:46,  9.27s/it]                 
Task 6, Epoch 16/20 => Loss 0.085, Train_accy 98.08:  80%|████████  | 16/20 [01:55<00:31,  7.97s/it]
Task 6, Epoch 17/20 => Loss 0.061, Train_accy 97.44:  80%|████████  | 16/20 [02:00<00:31,  7.97s/it]
Task 6, Epoch 17/20 => Loss 0.061, Train_accy 97.44:  85%|████████▌ | 17/20 [02:00<00:21,  7.10s/it]
Task 6, Epoch 18/20 => Loss 0.087, Train_accy 96.15:  85%|████████▌ | 17/20 [02:05<00:21,  7.10s/it]
Task 6, Epoch 18/20 => Loss 0.087, Train_accy 96.15:  90%|█████████ | 18/20 [02:05<00:12,  6.47s/it]
Task 6, Epoch 19/20 => Loss 0.077, Train_accy 97.86:  90%|█████████ | 18/20 [02:10<00:12,  6.47s/it]
Task 6, Epoch 19/20 => Loss 0.077, Train_accy 97.86:  95%|█████████▌| 19/20 [02:10<00:06,  6.02s/it]
Task 6, Epoch 20/20 => Loss 0.086, Train_accy 97.22, Test_accy 69.17:  95%|█████████▌| 19/20 [02:27<00:06,  6.02s/it]
Task 6, Epoch 20/20 => Loss 0.086, Train_accy 97.22, Test_accy 69.17: 100%|██████████| 20/20 [02:27<00:00,  9.30s/it]
Task 6, Epoch 20/20 => Loss 0.086, Train_accy 97.22, Test_accy 69.17: 100%|██████████| 20/20 [02:27<00:00,  7.37s/it]2024-09-13 20:29:48,916 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.086, Train_accy 97.22, Test_accy 69.17

2024-09-13 20:30:00,786 [trainer.py] => No NME accuracy.
2024-09-13 20:30:00,786 [trainer.py] => CNN: {'total': 69.17, '00-99': 90.15, '100-109': 46.09, '110-119': 29.2, '120-129': 43.93, '130-139': 26.27, '140-149': 27.78, '150-159': 30.65, 'old': 71.87, 'new': 30.65}
2024-09-13 20:30:00,786 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32, 75.32, 71.87, 69.17]
2024-09-13 20:30:00,786 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36, 98.05, 98.02, 97.62]

Average Accuracy (CNN): 79.17
2024-09-13 20:30:00,786 [trainer.py] => Average Accuracy (CNN): 79.17 

2024-09-13 20:30:00,788 [trainer.py] => All params: 172158352
2024-09-13 20:30:00,789 [trainer.py] => Trainable params: 407240
2024-09-13 20:30:00,789 [dualprompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.203, Train_accy 62.28:   0%|          | 0/20 [00:05<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.203, Train_accy 62.28:   5%|▌         | 1/20 [00:05<01:35,  5.00s/it]
Task 7, Epoch 2/20 => Loss 0.201, Train_accy 95.04:   5%|▌         | 1/20 [00:09<01:35,  5.00s/it]
Task 7, Epoch 2/20 => Loss 0.201, Train_accy 95.04:  10%|█         | 2/20 [00:09<01:29,  4.97s/it]
Task 7, Epoch 3/20 => Loss 0.141, Train_accy 94.61:  10%|█         | 2/20 [00:14<01:29,  4.97s/it]
Task 7, Epoch 3/20 => Loss 0.141, Train_accy 94.61:  15%|█▌        | 3/20 [00:14<01:23,  4.94s/it]
Task 7, Epoch 4/20 => Loss 0.098, Train_accy 95.91:  15%|█▌        | 3/20 [00:19<01:23,  4.94s/it]
Task 7, Epoch 4/20 => Loss 0.098, Train_accy 95.91:  20%|██        | 4/20 [00:19<01:18,  4.91s/it]
Task 7, Epoch 5/20 => Loss 0.083, Train_accy 97.41, Test_accy 66.52:  20%|██        | 4/20 [00:37<01:18,  4.91s/it]
Task 7, Epoch 5/20 => Loss 0.083, Train_accy 97.41, Test_accy 66.52:  25%|██▌       | 5/20 [00:37<02:23,  9.57s/it]
Task 7, Epoch 6/20 => Loss 0.096, Train_accy 96.77:  25%|██▌       | 5/20 [00:42<02:23,  9.57s/it]                 
Task 7, Epoch 6/20 => Loss 0.096, Train_accy 96.77:  30%|███       | 6/20 [00:42<01:51,  7.95s/it]
Task 7, Epoch 7/20 => Loss 0.065, Train_accy 97.20:  30%|███       | 6/20 [00:46<01:51,  7.95s/it]
Task 7, Epoch 7/20 => Loss 0.065, Train_accy 97.20:  35%|███▌      | 7/20 [00:46<01:28,  6.81s/it]
Task 7, Epoch 8/20 => Loss 0.109, Train_accy 96.34:  35%|███▌      | 7/20 [00:51<01:28,  6.81s/it]
Task 7, Epoch 8/20 => Loss 0.109, Train_accy 96.34:  40%|████      | 8/20 [00:51<01:12,  6.06s/it]
Task 7, Epoch 9/20 => Loss 0.094, Train_accy 96.12:  40%|████      | 8/20 [00:55<01:12,  6.06s/it]
Task 7, Epoch 9/20 => Loss 0.094, Train_accy 96.12:  45%|████▌     | 9/20 [00:55<01:00,  5.54s/it]
Task 7, Epoch 10/20 => Loss 0.100, Train_accy 96.77, Test_accy 66.81:  45%|████▌     | 9/20 [01:13<01:00,  5.54s/it]
Task 7, Epoch 10/20 => Loss 0.100, Train_accy 96.77, Test_accy 66.81:  50%|█████     | 10/20 [01:13<01:32,  9.25s/it]
Task 7, Epoch 11/20 => Loss 0.087, Train_accy 96.77:  50%|█████     | 10/20 [01:18<01:32,  9.25s/it]                 
Task 7, Epoch 11/20 => Loss 0.087, Train_accy 96.77:  55%|█████▌    | 11/20 [01:18<01:11,  7.92s/it]
Task 7, Epoch 12/20 => Loss 0.112, Train_accy 95.69:  55%|█████▌    | 11/20 [01:23<01:11,  7.92s/it]
Task 7, Epoch 12/20 => Loss 0.112, Train_accy 95.69:  60%|██████    | 12/20 [01:23<00:56,  7.01s/it]
Task 7, Epoch 13/20 => Loss 0.063, Train_accy 98.06:  60%|██████    | 12/20 [01:28<00:56,  7.01s/it]
Task 7, Epoch 13/20 => Loss 0.063, Train_accy 98.06:  65%|██████▌   | 13/20 [01:28<00:44,  6.39s/it]
Task 7, Epoch 14/20 => Loss 0.108, Train_accy 96.77:  65%|██████▌   | 13/20 [01:33<00:44,  6.39s/it]
Task 7, Epoch 14/20 => Loss 0.108, Train_accy 96.77:  70%|███████   | 14/20 [01:33<00:35,  5.97s/it]
Task 7, Epoch 15/20 => Loss 0.063, Train_accy 97.41, Test_accy 67.06:  70%|███████   | 14/20 [01:50<00:35,  5.97s/it]
Task 7, Epoch 15/20 => Loss 0.063, Train_accy 97.41, Test_accy 67.06:  75%|███████▌  | 15/20 [01:50<00:47,  9.54s/it]
Task 7, Epoch 16/20 => Loss 0.100, Train_accy 96.55:  75%|███████▌  | 15/20 [01:55<00:47,  9.54s/it]                 
Task 7, Epoch 16/20 => Loss 0.100, Train_accy 96.55:  80%|████████  | 16/20 [01:55<00:32,  8.17s/it]
Task 7, Epoch 17/20 => Loss 0.069, Train_accy 97.41:  80%|████████  | 16/20 [02:00<00:32,  8.17s/it]
Task 7, Epoch 17/20 => Loss 0.069, Train_accy 97.41:  85%|████████▌ | 17/20 [02:00<00:21,  7.20s/it]
Task 7, Epoch 18/20 => Loss 0.096, Train_accy 96.55:  85%|████████▌ | 17/20 [02:05<00:21,  7.20s/it]
Task 7, Epoch 18/20 => Loss 0.096, Train_accy 96.55:  90%|█████████ | 18/20 [02:05<00:13,  6.52s/it]
Task 7, Epoch 19/20 => Loss 0.089, Train_accy 96.55:  90%|█████████ | 18/20 [02:10<00:13,  6.52s/it]
Task 7, Epoch 19/20 => Loss 0.089, Train_accy 96.55:  95%|█████████▌| 19/20 [02:10<00:06,  6.05s/it]
Task 7, Epoch 20/20 => Loss 0.059, Train_accy 97.63, Test_accy 67.31:  95%|█████████▌| 19/20 [02:28<00:06,  6.05s/it]
Task 7, Epoch 20/20 => Loss 0.059, Train_accy 97.63, Test_accy 67.31: 100%|██████████| 20/20 [02:28<00:00,  9.53s/it]
Task 7, Epoch 20/20 => Loss 0.059, Train_accy 97.63, Test_accy 67.31: 100%|██████████| 20/20 [02:28<00:00,  7.42s/it]2024-09-13 20:32:29,111 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.059, Train_accy 97.63, Test_accy 67.31

2024-09-13 20:32:42,091 [trainer.py] => No NME accuracy.
2024-09-13 20:32:42,091 [trainer.py] => CNN: {'total': 67.31, '00-99': 90.24, '100-109': 46.09, '110-119': 29.2, '120-129': 43.93, '130-139': 27.12, '140-149': 27.78, '150-159': 30.65, '160-169': 39.55, 'old': 69.28, 'new': 39.55}
2024-09-13 20:32:42,091 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32, 75.32, 71.87, 69.17, 67.31]
2024-09-13 20:32:42,092 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36, 98.05, 98.02, 97.62, 97.14]

Average Accuracy (CNN): 77.69
2024-09-13 20:32:42,092 [trainer.py] => Average Accuracy (CNN): 77.69 

2024-09-13 20:32:42,094 [trainer.py] => All params: 172158352
2024-09-13 20:32:42,095 [trainer.py] => Trainable params: 407240
2024-09-13 20:32:42,095 [dualprompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.299, Train_accy 58.70:   0%|          | 0/20 [00:05<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.299, Train_accy 58.70:   5%|▌         | 1/20 [00:05<01:40,  5.27s/it]
Task 8, Epoch 2/20 => Loss 0.239, Train_accy 92.51:   5%|▌         | 1/20 [00:10<01:40,  5.27s/it]
Task 8, Epoch 2/20 => Loss 0.239, Train_accy 92.51:  10%|█         | 2/20 [00:10<01:35,  5.30s/it]
Task 8, Epoch 3/20 => Loss 0.186, Train_accy 93.72:  10%|█         | 2/20 [00:15<01:35,  5.30s/it]
Task 8, Epoch 3/20 => Loss 0.186, Train_accy 93.72:  15%|█▌        | 3/20 [00:15<01:28,  5.21s/it]
Task 8, Epoch 4/20 => Loss 0.147, Train_accy 95.55:  15%|█▌        | 3/20 [00:20<01:28,  5.21s/it]
Task 8, Epoch 4/20 => Loss 0.147, Train_accy 95.55:  20%|██        | 4/20 [00:20<01:23,  5.23s/it]
Task 8, Epoch 5/20 => Loss 0.093, Train_accy 96.56, Test_accy 65.46:  20%|██        | 4/20 [00:39<01:23,  5.23s/it]
Task 8, Epoch 5/20 => Loss 0.093, Train_accy 96.56, Test_accy 65.46:  25%|██▌       | 5/20 [00:39<02:31, 10.10s/it]
Task 8, Epoch 6/20 => Loss 0.137, Train_accy 95.34:  25%|██▌       | 5/20 [00:44<02:31, 10.10s/it]                 
Task 8, Epoch 6/20 => Loss 0.137, Train_accy 95.34:  30%|███       | 6/20 [00:44<01:58,  8.44s/it]
Task 8, Epoch 7/20 => Loss 0.120, Train_accy 94.94:  30%|███       | 6/20 [00:50<01:58,  8.44s/it]
Task 8, Epoch 7/20 => Loss 0.120, Train_accy 94.94:  35%|███▌      | 7/20 [00:50<01:36,  7.40s/it]
Task 8, Epoch 8/20 => Loss 0.089, Train_accy 96.56:  35%|███▌      | 7/20 [00:55<01:36,  7.40s/it]
Task 8, Epoch 8/20 => Loss 0.089, Train_accy 96.56:  40%|████      | 8/20 [00:55<01:20,  6.70s/it]
Task 8, Epoch 9/20 => Loss 0.111, Train_accy 95.75:  40%|████      | 8/20 [01:00<01:20,  6.70s/it]
Task 8, Epoch 9/20 => Loss 0.111, Train_accy 95.75:  45%|████▌     | 9/20 [01:00<01:08,  6.25s/it]
Task 8, Epoch 10/20 => Loss 0.112, Train_accy 96.36, Test_accy 65.51:  45%|████▌     | 9/20 [01:19<01:08,  6.25s/it]
Task 8, Epoch 10/20 => Loss 0.112, Train_accy 96.36, Test_accy 65.51:  50%|█████     | 10/20 [01:19<01:40, 10.06s/it]
Task 8, Epoch 11/20 => Loss 0.096, Train_accy 95.75:  50%|█████     | 10/20 [01:24<01:40, 10.06s/it]                 
Task 8, Epoch 11/20 => Loss 0.096, Train_accy 95.75:  55%|█████▌    | 11/20 [01:24<01:17,  8.59s/it]
Task 8, Epoch 12/20 => Loss 0.092, Train_accy 96.36:  55%|█████▌    | 11/20 [01:29<01:17,  8.59s/it]
Task 8, Epoch 12/20 => Loss 0.092, Train_accy 96.36:  60%|██████    | 12/20 [01:29<01:00,  7.52s/it]
Task 8, Epoch 13/20 => Loss 0.130, Train_accy 96.15:  60%|██████    | 12/20 [01:34<01:00,  7.52s/it]
Task 8, Epoch 13/20 => Loss 0.130, Train_accy 96.15:  65%|██████▌   | 13/20 [01:34<00:47,  6.76s/it]
Task 8, Epoch 14/20 => Loss 0.085, Train_accy 96.96:  65%|██████▌   | 13/20 [01:39<00:47,  6.76s/it]
Task 8, Epoch 14/20 => Loss 0.085, Train_accy 96.96:  70%|███████   | 14/20 [01:39<00:37,  6.30s/it]
Task 8, Epoch 15/20 => Loss 0.113, Train_accy 95.55, Test_accy 65.65:  70%|███████   | 14/20 [01:58<00:37,  6.30s/it]
Task 8, Epoch 15/20 => Loss 0.113, Train_accy 95.55, Test_accy 65.65:  75%|███████▌  | 15/20 [01:58<00:50, 10.02s/it]
Task 8, Epoch 16/20 => Loss 0.075, Train_accy 97.37:  75%|███████▌  | 15/20 [02:03<00:50, 10.02s/it]                 
Task 8, Epoch 16/20 => Loss 0.075, Train_accy 97.37:  80%|████████  | 16/20 [02:03<00:34,  8.56s/it]
Task 8, Epoch 17/20 => Loss 0.092, Train_accy 96.96:  80%|████████  | 16/20 [02:08<00:34,  8.56s/it]
Task 8, Epoch 17/20 => Loss 0.092, Train_accy 96.96:  85%|████████▌ | 17/20 [02:08<00:22,  7.54s/it]
Task 8, Epoch 18/20 => Loss 0.055, Train_accy 97.77:  85%|████████▌ | 17/20 [02:14<00:22,  7.54s/it]
Task 8, Epoch 18/20 => Loss 0.055, Train_accy 97.77:  90%|█████████ | 18/20 [02:14<00:13,  6.85s/it]
Task 8, Epoch 19/20 => Loss 0.085, Train_accy 96.76:  90%|█████████ | 18/20 [02:19<00:13,  6.85s/it]
Task 8, Epoch 19/20 => Loss 0.085, Train_accy 96.76:  95%|█████████▌| 19/20 [02:19<00:06,  6.38s/it]
Task 8, Epoch 20/20 => Loss 0.114, Train_accy 96.76, Test_accy 65.88:  95%|█████████▌| 19/20 [02:37<00:06,  6.38s/it]
Task 8, Epoch 20/20 => Loss 0.114, Train_accy 96.76, Test_accy 65.88: 100%|██████████| 20/20 [02:37<00:00,  9.89s/it]
Task 8, Epoch 20/20 => Loss 0.114, Train_accy 96.76, Test_accy 65.88: 100%|██████████| 20/20 [02:37<00:00,  7.87s/it]2024-09-13 20:35:19,487 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.114, Train_accy 96.76, Test_accy 65.88

2024-09-13 20:35:31,720 [trainer.py] => No NME accuracy.
2024-09-13 20:35:31,720 [trainer.py] => CNN: {'total': 65.88, '00-99': 90.15, '100-109': 46.09, '110-119': 28.32, '120-129': 43.93, '130-139': 27.12, '140-149': 28.57, '150-159': 29.84, '160-169': 39.55, '170-179': 39.81, 'old': 67.21, 'new': 39.81}
2024-09-13 20:35:31,720 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32, 75.32, 71.87, 69.17, 67.31, 65.88]
2024-09-13 20:35:31,720 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36, 98.05, 98.02, 97.62, 97.14, 96.57]

Average Accuracy (CNN): 76.38
2024-09-13 20:35:31,721 [trainer.py] => Average Accuracy (CNN): 76.38 

2024-09-13 20:35:31,723 [trainer.py] => All params: 172158352
2024-09-13 20:35:31,725 [trainer.py] => Trainable params: 407240
2024-09-13 20:35:31,725 [dualprompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.382, Train_accy 58.46:   0%|          | 0/20 [00:04<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.382, Train_accy 58.46:   5%|▌         | 1/20 [00:04<01:30,  4.77s/it]
Task 9, Epoch 2/20 => Loss 0.217, Train_accy 93.41:   5%|▌         | 1/20 [00:09<01:30,  4.77s/it]
Task 9, Epoch 2/20 => Loss 0.217, Train_accy 93.41:  10%|█         | 2/20 [00:09<01:26,  4.82s/it]
Task 9, Epoch 3/20 => Loss 0.180, Train_accy 93.41:  10%|█         | 2/20 [00:14<01:26,  4.82s/it]
Task 9, Epoch 3/20 => Loss 0.180, Train_accy 93.41:  15%|█▌        | 3/20 [00:14<01:22,  4.85s/it]
Task 9, Epoch 4/20 => Loss 0.096, Train_accy 97.58:  15%|█▌        | 3/20 [00:19<01:22,  4.85s/it]
Task 9, Epoch 4/20 => Loss 0.096, Train_accy 97.58:  20%|██        | 4/20 [00:19<01:17,  4.87s/it]
Task 9, Epoch 5/20 => Loss 0.165, Train_accy 93.85, Test_accy 62.92:  20%|██        | 4/20 [00:38<01:17,  4.87s/it]
Task 9, Epoch 5/20 => Loss 0.165, Train_accy 93.85, Test_accy 62.92:  25%|██▌       | 5/20 [00:38<02:29,  9.95s/it]
Task 9, Epoch 6/20 => Loss 0.180, Train_accy 93.63:  25%|██▌       | 5/20 [00:43<02:29,  9.95s/it]                 
Task 9, Epoch 6/20 => Loss 0.180, Train_accy 93.63:  30%|███       | 6/20 [00:43<01:55,  8.23s/it]
Task 9, Epoch 7/20 => Loss 0.132, Train_accy 95.38:  30%|███       | 6/20 [00:48<01:55,  8.23s/it]
Task 9, Epoch 7/20 => Loss 0.132, Train_accy 95.38:  35%|███▌      | 7/20 [00:48<01:32,  7.14s/it]
Task 9, Epoch 8/20 => Loss 0.139, Train_accy 95.16:  35%|███▌      | 7/20 [00:53<01:32,  7.14s/it]
Task 9, Epoch 8/20 => Loss 0.139, Train_accy 95.16:  40%|████      | 8/20 [00:53<01:16,  6.41s/it]
Task 9, Epoch 9/20 => Loss 0.122, Train_accy 95.16:  40%|████      | 8/20 [00:57<01:16,  6.41s/it]
Task 9, Epoch 9/20 => Loss 0.122, Train_accy 95.16:  45%|████▌     | 9/20 [00:57<01:05,  5.93s/it]
Task 9, Epoch 10/20 => Loss 0.139, Train_accy 95.38, Test_accy 63.05:  45%|████▌     | 9/20 [01:17<01:05,  5.93s/it]
Task 9, Epoch 10/20 => Loss 0.139, Train_accy 95.38, Test_accy 63.05:  50%|█████     | 10/20 [01:17<01:40, 10.05s/it]
Task 9, Epoch 11/20 => Loss 0.103, Train_accy 96.92:  50%|█████     | 10/20 [01:22<01:40, 10.05s/it]                 
Task 9, Epoch 11/20 => Loss 0.103, Train_accy 96.92:  55%|█████▌    | 11/20 [01:22<01:16,  8.51s/it]
Task 9, Epoch 12/20 => Loss 0.097, Train_accy 95.38:  55%|█████▌    | 11/20 [01:27<01:16,  8.51s/it]
Task 9, Epoch 12/20 => Loss 0.097, Train_accy 95.38:  60%|██████    | 12/20 [01:27<00:59,  7.43s/it]
Task 9, Epoch 13/20 => Loss 0.094, Train_accy 95.82:  60%|██████    | 12/20 [01:31<00:59,  7.43s/it]
Task 9, Epoch 13/20 => Loss 0.094, Train_accy 95.82:  65%|██████▌   | 13/20 [01:31<00:46,  6.65s/it]
Task 9, Epoch 14/20 => Loss 0.100, Train_accy 96.48:  65%|██████▌   | 13/20 [01:36<00:46,  6.65s/it]
Task 9, Epoch 14/20 => Loss 0.100, Train_accy 96.48:  70%|███████   | 14/20 [01:36<00:36,  6.08s/it]
Task 9, Epoch 15/20 => Loss 0.070, Train_accy 96.70, Test_accy 63.23:  70%|███████   | 14/20 [01:55<00:36,  6.08s/it]
Task 9, Epoch 15/20 => Loss 0.070, Train_accy 96.70, Test_accy 63.23:  75%|███████▌  | 15/20 [01:55<00:49,  9.98s/it]
Task 9, Epoch 16/20 => Loss 0.053, Train_accy 97.36:  75%|███████▌  | 15/20 [02:00<00:49,  9.98s/it]                 
Task 9, Epoch 16/20 => Loss 0.053, Train_accy 97.36:  80%|████████  | 16/20 [02:00<00:33,  8.45s/it]
Task 9, Epoch 17/20 => Loss 0.105, Train_accy 96.26:  80%|████████  | 16/20 [02:05<00:33,  8.45s/it]
Task 9, Epoch 17/20 => Loss 0.105, Train_accy 96.26:  85%|████████▌ | 17/20 [02:05<00:22,  7.37s/it]
Task 9, Epoch 18/20 => Loss 0.122, Train_accy 95.60:  85%|████████▌ | 17/20 [02:10<00:22,  7.37s/it]
Task 9, Epoch 18/20 => Loss 0.122, Train_accy 95.60:  90%|█████████ | 18/20 [02:10<00:13,  6.64s/it]
Task 9, Epoch 19/20 => Loss 0.098, Train_accy 96.70:  90%|█████████ | 18/20 [02:15<00:13,  6.64s/it]
Task 9, Epoch 19/20 => Loss 0.098, Train_accy 96.70:  95%|█████████▌| 19/20 [02:15<00:06,  6.11s/it]
Task 9, Epoch 20/20 => Loss 0.058, Train_accy 98.46, Test_accy 63.45:  95%|█████████▌| 19/20 [02:34<00:06,  6.11s/it]
Task 9, Epoch 20/20 => Loss 0.058, Train_accy 98.46, Test_accy 63.45: 100%|██████████| 20/20 [02:34<00:00,  9.98s/it]
Task 9, Epoch 20/20 => Loss 0.058, Train_accy 98.46, Test_accy 63.45: 100%|██████████| 20/20 [02:34<00:00,  7.72s/it]2024-09-13 20:38:06,067 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.058, Train_accy 98.46, Test_accy 63.45

2024-09-13 20:38:20,276 [trainer.py] => No NME accuracy.
2024-09-13 20:38:20,276 [trainer.py] => CNN: {'total': 63.45, '00-99': 90.15, '100-109': 46.09, '110-119': 28.32, '120-129': 43.93, '130-139': 27.12, '140-149': 28.57, '150-159': 29.84, '160-169': 39.55, '170-179': 39.81, '180-189': 24.24, 'old': 65.88, 'new': 24.24}
2024-09-13 20:38:20,276 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32, 75.32, 71.87, 69.17, 67.31, 65.88, 63.45]
2024-09-13 20:38:20,276 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36, 98.05, 98.02, 97.62, 97.14, 96.57, 95.84]

Average Accuracy (CNN): 75.09
2024-09-13 20:38:20,276 [trainer.py] => Average Accuracy (CNN): 75.09 

2024-09-13 20:38:20,278 [trainer.py] => All params: 172158352
2024-09-13 20:38:20,280 [trainer.py] => Trainable params: 407240
2024-09-13 20:38:20,280 [dualprompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.130, Train_accy 60.16:   0%|          | 0/20 [00:05<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.130, Train_accy 60.16:   5%|▌         | 1/20 [00:05<01:40,  5.31s/it]
Task 10, Epoch 2/20 => Loss 0.160, Train_accy 94.37:   5%|▌         | 1/20 [00:10<01:40,  5.31s/it]
Task 10, Epoch 2/20 => Loss 0.160, Train_accy 94.37:  10%|█         | 2/20 [00:10<01:34,  5.24s/it]
Task 10, Epoch 3/20 => Loss 0.113, Train_accy 94.77:  10%|█         | 2/20 [00:15<01:34,  5.24s/it]
Task 10, Epoch 3/20 => Loss 0.113, Train_accy 94.77:  15%|█▌        | 3/20 [00:15<01:28,  5.22s/it]
Task 10, Epoch 4/20 => Loss 0.091, Train_accy 96.18:  15%|█▌        | 3/20 [00:20<01:28,  5.22s/it]
Task 10, Epoch 4/20 => Loss 0.091, Train_accy 96.18:  20%|██        | 4/20 [00:20<01:23,  5.19s/it]
Task 10, Epoch 5/20 => Loss 0.078, Train_accy 95.17, Test_accy 61.62:  20%|██        | 4/20 [00:40<01:23,  5.19s/it]
Task 10, Epoch 5/20 => Loss 0.078, Train_accy 95.17, Test_accy 61.62:  25%|██▌       | 5/20 [00:40<02:37, 10.53s/it]
Task 10, Epoch 6/20 => Loss 0.074, Train_accy 95.57:  25%|██▌       | 5/20 [00:46<02:37, 10.53s/it]                 
Task 10, Epoch 6/20 => Loss 0.074, Train_accy 95.57:  30%|███       | 6/20 [00:46<02:02,  8.73s/it]
Task 10, Epoch 7/20 => Loss 0.060, Train_accy 95.57:  30%|███       | 6/20 [00:51<02:02,  8.73s/it]
Task 10, Epoch 7/20 => Loss 0.060, Train_accy 95.57:  35%|███▌      | 7/20 [00:51<01:39,  7.62s/it]
Task 10, Epoch 8/20 => Loss 0.091, Train_accy 94.97:  35%|███▌      | 7/20 [00:56<01:39,  7.62s/it]
Task 10, Epoch 8/20 => Loss 0.091, Train_accy 94.97:  40%|████      | 8/20 [00:56<01:22,  6.88s/it]
Task 10, Epoch 9/20 => Loss 0.051, Train_accy 96.18:  40%|████      | 8/20 [01:02<01:22,  6.88s/it]
Task 10, Epoch 9/20 => Loss 0.051, Train_accy 96.18:  45%|████▌     | 9/20 [01:02<01:10,  6.38s/it]
Task 10, Epoch 10/20 => Loss 0.073, Train_accy 95.77, Test_accy 61.62:  45%|████▌     | 9/20 [01:21<01:10,  6.38s/it]
Task 10, Epoch 10/20 => Loss 0.073, Train_accy 95.77, Test_accy 61.62:  50%|█████     | 10/20 [01:21<01:45, 10.58s/it]
Task 10, Epoch 11/20 => Loss 0.077, Train_accy 95.98:  50%|█████     | 10/20 [01:27<01:45, 10.58s/it]                 
Task 10, Epoch 11/20 => Loss 0.077, Train_accy 95.98:  55%|█████▌    | 11/20 [01:27<01:20,  8.91s/it]
Task 10, Epoch 12/20 => Loss 0.041, Train_accy 96.18:  55%|█████▌    | 11/20 [01:31<01:20,  8.91s/it]
Task 10, Epoch 12/20 => Loss 0.041, Train_accy 96.18:  60%|██████    | 12/20 [01:31<01:01,  7.67s/it]
Task 10, Epoch 13/20 => Loss 0.042, Train_accy 96.98:  60%|██████    | 12/20 [01:36<01:01,  7.67s/it]
Task 10, Epoch 13/20 => Loss 0.042, Train_accy 96.98:  65%|██████▌   | 13/20 [01:36<00:47,  6.76s/it]
Task 10, Epoch 14/20 => Loss 0.059, Train_accy 95.77:  65%|██████▌   | 13/20 [01:41<00:47,  6.76s/it]
Task 10, Epoch 14/20 => Loss 0.059, Train_accy 95.77:  70%|███████   | 14/20 [01:41<00:36,  6.14s/it]
Task 10, Epoch 15/20 => Loss 0.035, Train_accy 96.58, Test_accy 61.75:  70%|███████   | 14/20 [02:01<00:36,  6.14s/it]
Task 10, Epoch 15/20 => Loss 0.035, Train_accy 96.58, Test_accy 61.75:  75%|███████▌  | 15/20 [02:01<00:51, 10.26s/it]
Task 10, Epoch 16/20 => Loss 0.070, Train_accy 96.78:  75%|███████▌  | 15/20 [02:06<00:51, 10.26s/it]                 
Task 10, Epoch 16/20 => Loss 0.070, Train_accy 96.78:  80%|████████  | 16/20 [02:06<00:34,  8.73s/it]
Task 10, Epoch 17/20 => Loss 0.069, Train_accy 96.18:  80%|████████  | 16/20 [02:11<00:34,  8.73s/it]
Task 10, Epoch 17/20 => Loss 0.069, Train_accy 96.18:  85%|████████▌ | 17/20 [02:11<00:23,  7.70s/it]
Task 10, Epoch 18/20 => Loss 0.018, Train_accy 98.19:  85%|████████▌ | 17/20 [02:16<00:23,  7.70s/it]
Task 10, Epoch 18/20 => Loss 0.018, Train_accy 98.19:  90%|█████████ | 18/20 [02:16<00:13,  6.95s/it]
Task 10, Epoch 19/20 => Loss 0.006, Train_accy 98.19:  90%|█████████ | 18/20 [02:21<00:13,  6.95s/it]
Task 10, Epoch 19/20 => Loss 0.006, Train_accy 98.19:  95%|█████████▌| 19/20 [02:21<00:06,  6.42s/it]
Task 10, Epoch 20/20 => Loss -0.000, Train_accy 97.99, Test_accy 61.70:  95%|█████████▌| 19/20 [02:41<00:06,  6.42s/it]
Task 10, Epoch 20/20 => Loss -0.000, Train_accy 97.99, Test_accy 61.70: 100%|██████████| 20/20 [02:41<00:00, 10.47s/it]
Task 10, Epoch 20/20 => Loss -0.000, Train_accy 97.99, Test_accy 61.70: 100%|██████████| 20/20 [02:41<00:00,  8.10s/it]2024-09-13 20:41:02,196 [dualprompt.py] => Task 10, Epoch 20/20 => Loss -0.000, Train_accy 97.99, Test_accy 61.70

2024-09-13 20:41:16,886 [trainer.py] => No NME accuracy.
2024-09-13 20:41:16,886 [trainer.py] => CNN: {'total': 61.7, '00-99': 89.98, '100-109': 46.09, '110-119': 27.43, '120-129': 43.93, '130-139': 27.97, '140-149': 27.78, '150-159': 29.03, '160-169': 38.06, '170-179': 38.83, '180-189': 22.73, '190-199': 30.61, 'old': 63.05, 'new': 30.61}
2024-09-13 20:41:16,886 [trainer.py] => CNN top1 curve: [89.98, 86.49, 82.06, 79.32, 75.32, 71.87, 69.17, 67.31, 65.88, 63.45, 61.7]
2024-09-13 20:41:16,886 [trainer.py] => CNN top5 curve: [98.82, 98.7, 98.59, 98.36, 98.05, 98.02, 97.62, 97.14, 96.57, 95.84, 95.38]

Average Accuracy (CNN): 73.87
2024-09-13 20:41:16,886 [trainer.py] => Average Accuracy (CNN): 73.87 

Accuracy Matrix (CNN):
[[89.98 90.4  90.49 90.24 90.24 90.15 90.15 90.24 90.15 90.15 89.98]
 [ 0.   46.09 46.09 46.96 46.09 46.09 46.09 46.09 46.09 46.09 46.09]
 [ 0.    0.   30.09 30.09 29.2  29.2  29.2  29.2  28.32 28.32 27.43]
 [ 0.    0.    0.   44.86 43.93 43.93 43.93 43.93 43.93 43.93 43.93]
 [ 0.    0.    0.    0.   26.27 26.27 26.27 27.12 27.12 27.12 27.97]
 [ 0.    0.    0.    0.    0.   27.78 27.78 27.78 28.57 28.57 27.78]
 [ 0.    0.    0.    0.    0.    0.   30.65 30.65 29.84 29.84 29.03]
 [ 0.    0.    0.    0.    0.    0.    0.   39.55 39.55 39.55 38.06]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   39.81 39.81 38.83]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   24.24 22.73]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   30.61]]
2024-09-13 20:41:16,887 [trainer.py] => Forgetting (CNN): 1.1359999999999981
2024-09-05 23:36:14,525 [trainer.py] => config: ./exps/coda_prompt_cub_B0_Inc5.json
2024-09-05 23:36:14,525 [trainer.py] => prefix:  
2024-09-05 23:36:14,525 [trainer.py] => dataset: cub
2024-09-05 23:36:14,525 [trainer.py] => memory_size: 0
2024-09-05 23:36:14,525 [trainer.py] => memory_per_class: 0
2024-09-05 23:36:14,525 [trainer.py] => fixed_memory: False
2024-09-05 23:36:14,525 [trainer.py] => shuffle: True
2024-09-05 23:36:14,525 [trainer.py] => init_cls: 40
2024-09-05 23:36:14,525 [trainer.py] => increment: 40
2024-09-05 23:36:14,525 [trainer.py] => model_name: coda_prompt
2024-09-05 23:36:14,526 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-05 23:36:14,526 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-05 23:36:14,526 [trainer.py] => seed: 1993
2024-09-05 23:36:14,526 [trainer.py] => tuned_epoch: 20
2024-09-05 23:36:14,526 [trainer.py] => init_lr: 0.001
2024-09-05 23:36:14,526 [trainer.py] => batch_size: 48
2024-09-05 23:36:14,526 [trainer.py] => weight_decay: 0
2024-09-05 23:36:14,526 [trainer.py] => min_lr: 1e-05
2024-09-05 23:36:14,526 [trainer.py] => optimizer: adam
2024-09-05 23:36:14,526 [trainer.py] => scheduler: cosine
2024-09-05 23:36:14,526 [trainer.py] => reinit_optimizer: True
2024-09-05 23:36:14,526 [trainer.py] => pretrained: True
2024-09-05 23:36:14,526 [trainer.py] => drop: 0.0
2024-09-05 23:36:14,526 [trainer.py] => drop_path: 0.0
2024-09-05 23:36:14,526 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-05 23:36:14,562 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-05 23:36:16,472 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-05 23:36:16,472 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-05 23:36:16,473 [trainer.py] => All params: 89792456
2024-09-05 23:36:16,473 [trainer.py] => Trainable params: 89792456
2024-09-05 23:36:16,473 [coda_prompt.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.335, Train_accy 67.90:   0%|          | 0/20 [00:20<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.335, Train_accy 67.90:   5%|▌         | 1/20 [00:20<06:34, 20.78s/it]
Task 0, Epoch 2/20 => Loss 0.338, Train_accy 90.92:   5%|▌         | 1/20 [00:41<06:34, 20.78s/it]
Task 0, Epoch 2/20 => Loss 0.338, Train_accy 90.92:  10%|█         | 2/20 [00:41<06:10, 20.61s/it]
Task 0, Epoch 3/20 => Loss 0.250, Train_accy 92.68:  10%|█         | 2/20 [01:01<06:10, 20.61s/it]
Task 0, Epoch 3/20 => Loss 0.250, Train_accy 92.68:  15%|█▌        | 3/20 [01:01<05:50, 20.60s/it]
Task 0, Epoch 4/20 => Loss 0.224, Train_accy 93.11:  15%|█▌        | 3/20 [01:22<05:50, 20.60s/it]
Task 0, Epoch 4/20 => Loss 0.224, Train_accy 93.11:  20%|██        | 4/20 [01:22<05:28, 20.53s/it]
Task 0, Epoch 5/20 => Loss 0.247, Train_accy 92.63, Test_accy 96.70:  20%|██        | 4/20 [01:45<05:28, 20.53s/it]
Task 0, Epoch 5/20 => Loss 0.247, Train_accy 92.63, Test_accy 96.70:  25%|██▌       | 5/20 [01:45<05:24, 21.66s/it]
Task 0, Epoch 6/20 => Loss 0.184, Train_accy 94.82:  25%|██▌       | 5/20 [02:06<05:24, 21.66s/it]                 
Task 0, Epoch 6/20 => Loss 0.184, Train_accy 94.82:  30%|███       | 6/20 [02:06<04:58, 21.31s/it]
Task 0, Epoch 7/20 => Loss 0.164, Train_accy 95.19:  30%|███       | 6/20 [02:27<04:58, 21.31s/it]
Task 0, Epoch 7/20 => Loss 0.164, Train_accy 95.19:  35%|███▌      | 7/20 [02:27<04:33, 21.07s/it]
Task 0, Epoch 8/20 => Loss 0.194, Train_accy 94.50:  35%|███▌      | 7/20 [02:47<04:33, 21.07s/it]
Task 0, Epoch 8/20 => Loss 0.194, Train_accy 94.50:  40%|████      | 8/20 [02:47<04:11, 20.95s/it]
Task 0, Epoch 9/20 => Loss 0.175, Train_accy 95.03:  40%|████      | 8/20 [03:08<04:11, 20.95s/it]
Task 0, Epoch 9/20 => Loss 0.175, Train_accy 95.03:  45%|████▌     | 9/20 [03:08<03:49, 20.85s/it]
Task 0, Epoch 10/20 => Loss 0.176, Train_accy 95.09, Test_accy 97.80:  45%|████▌     | 9/20 [03:32<03:49, 20.85s/it]
Task 0, Epoch 10/20 => Loss 0.176, Train_accy 95.09, Test_accy 97.80:  50%|█████     | 10/20 [03:32<03:37, 21.73s/it]
Task 0, Epoch 11/20 => Loss 0.163, Train_accy 95.57:  50%|█████     | 10/20 [03:52<03:37, 21.73s/it]                 
Task 0, Epoch 11/20 => Loss 0.163, Train_accy 95.57:  55%|█████▌    | 11/20 [03:52<03:12, 21.40s/it]
Task 0, Epoch 12/20 => Loss 0.176, Train_accy 94.44:  55%|█████▌    | 11/20 [04:13<03:12, 21.40s/it]
Task 0, Epoch 12/20 => Loss 0.176, Train_accy 94.44:  60%|██████    | 12/20 [04:13<02:49, 21.19s/it]
Task 0, Epoch 13/20 => Loss 0.156, Train_accy 95.41:  60%|██████    | 12/20 [04:34<02:49, 21.19s/it]
Task 0, Epoch 13/20 => Loss 0.156, Train_accy 95.41:  65%|██████▌   | 13/20 [04:34<02:27, 21.04s/it]
Task 0, Epoch 14/20 => Loss 0.158, Train_accy 94.98:  65%|██████▌   | 13/20 [04:54<02:27, 21.04s/it]
Task 0, Epoch 14/20 => Loss 0.158, Train_accy 94.98:  70%|███████   | 14/20 [04:54<02:05, 20.93s/it]
Task 0, Epoch 15/20 => Loss 0.156, Train_accy 95.35, Test_accy 96.92:  70%|███████   | 14/20 [05:18<02:05, 20.93s/it]
Task 0, Epoch 15/20 => Loss 0.156, Train_accy 95.35, Test_accy 96.92:  75%|███████▌  | 15/20 [05:18<01:48, 21.75s/it]
Task 0, Epoch 16/20 => Loss 0.169, Train_accy 94.50:  75%|███████▌  | 15/20 [05:39<01:48, 21.75s/it]                 
Task 0, Epoch 16/20 => Loss 0.169, Train_accy 94.50:  80%|████████  | 16/20 [05:39<01:25, 21.42s/it]
Task 0, Epoch 17/20 => Loss 0.111, Train_accy 96.85:  80%|████████  | 16/20 [05:59<01:25, 21.42s/it]
Task 0, Epoch 17/20 => Loss 0.111, Train_accy 96.85:  85%|████████▌ | 17/20 [05:59<01:03, 21.20s/it]
Task 0, Epoch 18/20 => Loss 0.129, Train_accy 95.99:  85%|████████▌ | 17/20 [06:20<01:03, 21.20s/it]
Task 0, Epoch 18/20 => Loss 0.129, Train_accy 95.99:  90%|█████████ | 18/20 [06:20<00:42, 21.05s/it]
Task 0, Epoch 19/20 => Loss 0.134, Train_accy 96.05:  90%|█████████ | 18/20 [06:41<00:42, 21.05s/it]
Task 0, Epoch 19/20 => Loss 0.134, Train_accy 96.05:  95%|█████████▌| 19/20 [06:41<00:20, 20.95s/it]
Task 0, Epoch 20/20 => Loss 0.139, Train_accy 96.31, Test_accy 96.48:  95%|█████████▌| 19/20 [07:04<00:20, 20.95s/it]
Task 0, Epoch 20/20 => Loss 0.139, Train_accy 96.31, Test_accy 96.48: 100%|██████████| 20/20 [07:04<00:00, 21.76s/it]
Task 0, Epoch 20/20 => Loss 0.139, Train_accy 96.31, Test_accy 96.48: 100%|██████████| 20/20 [07:04<00:00, 21.25s/it]
2024-09-05 23:43:21,901 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.139, Train_accy 96.31, Test_accy 96.48
2024-09-05 23:43:24,928 [trainer.py] => No NME accuracy.
2024-09-05 23:43:24,928 [trainer.py] => CNN: {'total': 96.48, '00-39': 96.48, 'old': 0, 'new': 96.48}
2024-09-05 23:43:24,928 [trainer.py] => CNN top1 curve: [96.48]
2024-09-05 23:43:24,929 [trainer.py] => CNN top5 curve: [99.34]

Average Accuracy (CNN): 96.48
2024-09-05 23:43:24,929 [trainer.py] => Average Accuracy (CNN): 96.48 

2024-09-05 23:43:24,930 [trainer.py] => All params: 89792456
2024-09-05 23:43:24,932 [trainer.py] => Trainable params: 89792456
2024-09-05 23:43:26,084 [coda_prompt.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.385, Train_accy 66.77:   0%|          | 0/20 [00:20<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.385, Train_accy 66.77:   5%|▌         | 1/20 [00:20<06:34, 20.76s/it]
Task 1, Epoch 2/20 => Loss 0.379, Train_accy 89.48:   5%|▌         | 1/20 [00:41<06:34, 20.76s/it]
Task 1, Epoch 2/20 => Loss 0.379, Train_accy 89.48:  10%|█         | 2/20 [00:41<06:13, 20.73s/it]
Task 1, Epoch 3/20 => Loss 0.316, Train_accy 90.92:  10%|█         | 2/20 [01:02<06:13, 20.73s/it]
Task 1, Epoch 3/20 => Loss 0.316, Train_accy 90.92:  15%|█▌        | 3/20 [01:02<05:52, 20.75s/it]
Task 1, Epoch 4/20 => Loss 0.274, Train_accy 92.52:  15%|█▌        | 3/20 [01:22<05:52, 20.75s/it]
Task 1, Epoch 4/20 => Loss 0.274, Train_accy 92.52:  20%|██        | 4/20 [01:22<05:31, 20.75s/it]
Task 1, Epoch 5/20 => Loss 0.257, Train_accy 93.11, Test_accy 84.44:  20%|██        | 4/20 [01:49<05:31, 20.75s/it]
Task 1, Epoch 5/20 => Loss 0.257, Train_accy 93.11, Test_accy 84.44:  25%|██▌       | 5/20 [01:49<05:41, 22.77s/it]
Task 1, Epoch 6/20 => Loss 0.198, Train_accy 93.80:  25%|██▌       | 5/20 [02:10<05:41, 22.77s/it]                 
Task 1, Epoch 6/20 => Loss 0.198, Train_accy 93.80:  30%|███       | 6/20 [02:10<05:09, 22.10s/it]
Task 1, Epoch 7/20 => Loss 0.250, Train_accy 93.11:  30%|███       | 6/20 [02:30<05:09, 22.10s/it]
Task 1, Epoch 7/20 => Loss 0.250, Train_accy 93.11:  35%|███▌      | 7/20 [02:30<04:41, 21.65s/it]
Task 1, Epoch 8/20 => Loss 0.200, Train_accy 94.50:  35%|███▌      | 7/20 [02:51<04:41, 21.65s/it]
Task 1, Epoch 8/20 => Loss 0.200, Train_accy 94.50:  40%|████      | 8/20 [02:51<04:16, 21.37s/it]
Task 1, Epoch 9/20 => Loss 0.203, Train_accy 94.12:  40%|████      | 8/20 [03:12<04:16, 21.37s/it]
Task 1, Epoch 9/20 => Loss 0.203, Train_accy 94.12:  45%|████▌     | 9/20 [03:12<03:52, 21.17s/it]
Task 1, Epoch 10/20 => Loss 0.202, Train_accy 94.12, Test_accy 87.81:  45%|████▌     | 9/20 [03:38<03:52, 21.17s/it]
Task 1, Epoch 10/20 => Loss 0.202, Train_accy 94.12, Test_accy 87.81:  50%|█████     | 10/20 [03:38<03:47, 22.78s/it]
Task 1, Epoch 11/20 => Loss 0.185, Train_accy 95.03:  50%|█████     | 10/20 [03:59<03:47, 22.78s/it]                 
Task 1, Epoch 11/20 => Loss 0.185, Train_accy 95.03:  55%|█████▌    | 11/20 [03:59<03:19, 22.16s/it]
Task 1, Epoch 12/20 => Loss 0.168, Train_accy 94.93:  55%|█████▌    | 11/20 [04:20<03:19, 22.16s/it]
Task 1, Epoch 12/20 => Loss 0.168, Train_accy 94.93:  60%|██████    | 12/20 [04:20<02:53, 21.73s/it]
Task 1, Epoch 13/20 => Loss 0.175, Train_accy 94.87:  60%|██████    | 12/20 [04:40<02:53, 21.73s/it]
Task 1, Epoch 13/20 => Loss 0.175, Train_accy 94.87:  65%|██████▌   | 13/20 [04:40<02:29, 21.43s/it]
Task 1, Epoch 14/20 => Loss 0.148, Train_accy 95.41:  65%|██████▌   | 13/20 [05:01<02:29, 21.43s/it]
Task 1, Epoch 14/20 => Loss 0.148, Train_accy 95.41:  70%|███████   | 14/20 [05:01<02:07, 21.23s/it]
Task 1, Epoch 15/20 => Loss 0.160, Train_accy 95.67, Test_accy 88.57:  70%|███████   | 14/20 [05:28<02:07, 21.23s/it]
Task 1, Epoch 15/20 => Loss 0.160, Train_accy 95.67, Test_accy 88.57:  75%|███████▌  | 15/20 [05:28<01:53, 22.79s/it]
Task 1, Epoch 16/20 => Loss 0.148, Train_accy 95.83:  75%|███████▌  | 15/20 [05:48<01:53, 22.79s/it]                 
Task 1, Epoch 16/20 => Loss 0.148, Train_accy 95.83:  80%|████████  | 16/20 [05:48<01:28, 22.18s/it]
Task 1, Epoch 17/20 => Loss 0.169, Train_accy 95.25:  80%|████████  | 16/20 [06:09<01:28, 22.18s/it]
Task 1, Epoch 17/20 => Loss 0.169, Train_accy 95.25:  85%|████████▌ | 17/20 [06:09<01:05, 21.77s/it]
Task 1, Epoch 18/20 => Loss 0.164, Train_accy 95.35:  85%|████████▌ | 17/20 [06:30<01:05, 21.77s/it]
Task 1, Epoch 18/20 => Loss 0.164, Train_accy 95.35:  90%|█████████ | 18/20 [06:30<00:42, 21.47s/it]
Task 1, Epoch 19/20 => Loss 0.162, Train_accy 95.41:  90%|█████████ | 18/20 [06:51<00:42, 21.47s/it]
Task 1, Epoch 19/20 => Loss 0.162, Train_accy 95.41:  95%|█████████▌| 19/20 [06:51<00:21, 21.24s/it]
Task 1, Epoch 20/20 => Loss 0.149, Train_accy 95.46, Test_accy 89.34:  95%|█████████▌| 19/20 [07:17<00:21, 21.24s/it]
Task 1, Epoch 20/20 => Loss 0.149, Train_accy 95.46, Test_accy 89.34: 100%|██████████| 20/20 [07:17<00:00, 22.79s/it]
Task 1, Epoch 20/20 => Loss 0.149, Train_accy 95.46, Test_accy 89.34: 100%|██████████| 20/20 [07:17<00:00, 21.88s/it]
2024-09-05 23:50:43,720 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.149, Train_accy 95.46, Test_accy 89.34
2024-09-05 23:50:49,312 [trainer.py] => No NME accuracy.
2024-09-05 23:50:49,313 [trainer.py] => CNN: {'total': 89.34, '00-39': 93.39, '40-79': 85.38, 'old': 93.39, 'new': 85.38}
2024-09-05 23:50:49,313 [trainer.py] => CNN top1 curve: [96.48, 89.34]
2024-09-05 23:50:49,313 [trainer.py] => CNN top5 curve: [99.34, 99.13]

Average Accuracy (CNN): 92.91
2024-09-05 23:50:49,313 [trainer.py] => Average Accuracy (CNN): 92.91 

2024-09-05 23:50:49,314 [trainer.py] => All params: 89792456
2024-09-05 23:50:49,315 [trainer.py] => Trainable params: 89792456
2024-09-05 23:50:51,293 [coda_prompt.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.323, Train_accy 66.39:   0%|          | 0/20 [00:20<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.323, Train_accy 66.39:   5%|▌         | 1/20 [00:20<06:23, 20.18s/it]
Task 2, Epoch 2/20 => Loss 0.348, Train_accy 89.86:   5%|▌         | 1/20 [00:40<06:23, 20.18s/it]
Task 2, Epoch 2/20 => Loss 0.348, Train_accy 89.86:  10%|█         | 2/20 [00:40<06:04, 20.23s/it]
Task 2, Epoch 3/20 => Loss 0.234, Train_accy 92.93:  10%|█         | 2/20 [01:00<06:04, 20.23s/it]
Task 2, Epoch 3/20 => Loss 0.234, Train_accy 92.93:  15%|█▌        | 3/20 [01:00<05:43, 20.22s/it]
Task 2, Epoch 4/20 => Loss 0.218, Train_accy 93.15:  15%|█▌        | 3/20 [01:20<05:43, 20.22s/it]
Task 2, Epoch 4/20 => Loss 0.218, Train_accy 93.15:  20%|██        | 4/20 [01:20<05:23, 20.21s/it]
Task 2, Epoch 5/20 => Loss 0.206, Train_accy 94.13, Test_accy 79.59:  20%|██        | 4/20 [01:49<05:23, 20.21s/it]
Task 2, Epoch 5/20 => Loss 0.206, Train_accy 94.13, Test_accy 79.59:  25%|██▌       | 5/20 [01:49<05:48, 23.26s/it]
Task 2, Epoch 6/20 => Loss 0.215, Train_accy 93.80:  25%|██▌       | 5/20 [02:09<05:48, 23.26s/it]                 
Task 2, Epoch 6/20 => Loss 0.215, Train_accy 93.80:  30%|███       | 6/20 [02:09<05:11, 22.23s/it]
Task 2, Epoch 7/20 => Loss 0.208, Train_accy 94.02:  30%|███       | 6/20 [02:30<05:11, 22.23s/it]
Task 2, Epoch 7/20 => Loss 0.208, Train_accy 94.02:  35%|███▌      | 7/20 [02:30<04:40, 21.59s/it]
Task 2, Epoch 8/20 => Loss 0.203, Train_accy 93.86:  35%|███▌      | 7/20 [02:50<04:40, 21.59s/it]
Task 2, Epoch 8/20 => Loss 0.203, Train_accy 93.86:  40%|████      | 8/20 [02:50<04:13, 21.16s/it]
Task 2, Epoch 9/20 => Loss 0.188, Train_accy 94.41:  40%|████      | 8/20 [03:10<04:13, 21.16s/it]
Task 2, Epoch 9/20 => Loss 0.188, Train_accy 94.41:  45%|████▌     | 9/20 [03:10<03:49, 20.87s/it]
Task 2, Epoch 10/20 => Loss 0.153, Train_accy 95.07, Test_accy 82.20:  45%|████▌     | 9/20 [03:39<03:49, 20.87s/it]
Task 2, Epoch 10/20 => Loss 0.153, Train_accy 95.07, Test_accy 82.20:  50%|█████     | 10/20 [03:39<03:52, 23.23s/it]
Task 2, Epoch 11/20 => Loss 0.178, Train_accy 94.85:  50%|█████     | 10/20 [03:59<03:52, 23.23s/it]                 
Task 2, Epoch 11/20 => Loss 0.178, Train_accy 94.85:  55%|█████▌    | 11/20 [03:59<03:20, 22.31s/it]
Task 2, Epoch 12/20 => Loss 0.140, Train_accy 95.83:  55%|█████▌    | 11/20 [04:19<03:20, 22.31s/it]
Task 2, Epoch 12/20 => Loss 0.140, Train_accy 95.83:  60%|██████    | 12/20 [04:19<02:53, 21.67s/it]
Task 2, Epoch 13/20 => Loss 0.176, Train_accy 94.46:  60%|██████    | 12/20 [04:39<02:53, 21.67s/it]
Task 2, Epoch 13/20 => Loss 0.176, Train_accy 94.46:  65%|██████▌   | 13/20 [04:39<02:28, 21.24s/it]
Task 2, Epoch 14/20 => Loss 0.132, Train_accy 96.05:  65%|██████▌   | 13/20 [04:59<02:28, 21.24s/it]
Task 2, Epoch 14/20 => Loss 0.132, Train_accy 96.05:  70%|███████   | 14/20 [04:59<02:05, 20.94s/it]
Task 2, Epoch 15/20 => Loss 0.170, Train_accy 95.12, Test_accy 83.69:  70%|███████   | 14/20 [05:28<02:05, 20.94s/it]
Task 2, Epoch 15/20 => Loss 0.170, Train_accy 95.12, Test_accy 83.69:  75%|███████▌  | 15/20 [05:28<01:56, 23.24s/it]
Task 2, Epoch 16/20 => Loss 0.128, Train_accy 96.11:  75%|███████▌  | 15/20 [05:48<01:56, 23.24s/it]                 
Task 2, Epoch 16/20 => Loss 0.128, Train_accy 96.11:  80%|████████  | 16/20 [05:48<01:29, 22.33s/it]
Task 2, Epoch 17/20 => Loss 0.146, Train_accy 95.67:  80%|████████  | 16/20 [06:08<01:29, 22.33s/it]
Task 2, Epoch 17/20 => Loss 0.146, Train_accy 95.67:  85%|████████▌ | 17/20 [06:08<01:05, 21.70s/it]
Task 2, Epoch 18/20 => Loss 0.126, Train_accy 96.60:  85%|████████▌ | 17/20 [06:29<01:05, 21.70s/it]
Task 2, Epoch 18/20 => Loss 0.126, Train_accy 96.60:  90%|█████████ | 18/20 [06:29<00:42, 21.23s/it]
Task 2, Epoch 19/20 => Loss 0.141, Train_accy 95.72:  90%|█████████ | 18/20 [06:49<00:42, 21.23s/it]
Task 2, Epoch 19/20 => Loss 0.141, Train_accy 95.72:  95%|█████████▌| 19/20 [06:49<00:20, 20.93s/it]
Task 2, Epoch 20/20 => Loss 0.135, Train_accy 96.27, Test_accy 83.90:  95%|█████████▌| 19/20 [07:18<00:20, 20.93s/it]
Task 2, Epoch 20/20 => Loss 0.135, Train_accy 96.27, Test_accy 83.90: 100%|██████████| 20/20 [07:18<00:00, 23.26s/it]
Task 2, Epoch 20/20 => Loss 0.135, Train_accy 96.27, Test_accy 83.90: 100%|██████████| 20/20 [07:18<00:00, 21.90s/it]
2024-09-05 23:58:09,325 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.135, Train_accy 96.27, Test_accy 83.90
2024-09-05 23:58:17,748 [trainer.py] => No NME accuracy.
2024-09-05 23:58:17,749 [trainer.py] => CNN: {'total': 83.9, '00-39': 92.73, '40-79': 81.72, '80-119': 77.87, 'old': 87.16, 'new': 77.87}
2024-09-05 23:58:17,749 [trainer.py] => CNN top1 curve: [96.48, 89.34, 83.9]
2024-09-05 23:58:17,749 [trainer.py] => CNN top5 curve: [99.34, 99.13, 98.8]

Average Accuracy (CNN): 89.91
2024-09-05 23:58:17,749 [trainer.py] => Average Accuracy (CNN): 89.91 

2024-09-05 23:58:17,750 [trainer.py] => All params: 89792456
2024-09-05 23:58:17,751 [trainer.py] => Trainable params: 89792456
2024-09-05 23:58:20,405 [coda_prompt.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.485, Train_accy 63.19:   0%|          | 0/20 [00:20<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.485, Train_accy 63.19:   5%|▌         | 1/20 [00:20<06:34, 20.78s/it]
Task 3, Epoch 2/20 => Loss 0.422, Train_accy 87.55:   5%|▌         | 1/20 [00:41<06:34, 20.78s/it]
Task 3, Epoch 2/20 => Loss 0.422, Train_accy 87.55:  10%|█         | 2/20 [00:41<06:14, 20.83s/it]
Task 3, Epoch 3/20 => Loss 0.337, Train_accy 89.48:  10%|█         | 2/20 [01:02<06:14, 20.83s/it]
Task 3, Epoch 3/20 => Loss 0.337, Train_accy 89.48:  15%|█▌        | 3/20 [01:02<05:53, 20.82s/it]
Task 3, Epoch 4/20 => Loss 0.315, Train_accy 90.60:  15%|█▌        | 3/20 [01:23<05:53, 20.82s/it]
Task 3, Epoch 4/20 => Loss 0.315, Train_accy 90.60:  20%|██        | 4/20 [01:23<05:32, 20.81s/it]
Task 3, Epoch 5/20 => Loss 0.260, Train_accy 92.20, Test_accy 78.05:  20%|██        | 4/20 [01:55<05:32, 20.81s/it]
Task 3, Epoch 5/20 => Loss 0.260, Train_accy 92.20, Test_accy 78.05:  25%|██▌       | 5/20 [01:55<06:11, 24.79s/it]
Task 3, Epoch 6/20 => Loss 0.276, Train_accy 92.04:  25%|██▌       | 5/20 [02:15<06:11, 24.79s/it]                 
Task 3, Epoch 6/20 => Loss 0.276, Train_accy 92.04:  30%|███       | 6/20 [02:15<05:28, 23.45s/it]
Task 3, Epoch 7/20 => Loss 0.235, Train_accy 92.90:  30%|███       | 6/20 [02:36<05:28, 23.45s/it]
Task 3, Epoch 7/20 => Loss 0.235, Train_accy 92.90:  35%|███▌      | 7/20 [02:36<04:53, 22.59s/it]
Task 3, Epoch 8/20 => Loss 0.210, Train_accy 93.96:  35%|███▌      | 7/20 [02:57<04:53, 22.59s/it]
Task 3, Epoch 8/20 => Loss 0.210, Train_accy 93.96:  40%|████      | 8/20 [02:57<04:24, 22.03s/it]
Task 3, Epoch 9/20 => Loss 0.213, Train_accy 93.91:  40%|████      | 8/20 [03:18<04:24, 22.03s/it]
Task 3, Epoch 9/20 => Loss 0.213, Train_accy 93.91:  45%|████▌     | 9/20 [03:18<03:58, 21.65s/it]
Task 3, Epoch 10/20 => Loss 0.210, Train_accy 94.28, Test_accy 79.48:  45%|████▌     | 9/20 [03:50<03:58, 21.65s/it]
Task 3, Epoch 10/20 => Loss 0.210, Train_accy 94.28, Test_accy 79.48:  50%|█████     | 10/20 [03:50<04:08, 24.81s/it]
Task 3, Epoch 11/20 => Loss 0.210, Train_accy 93.54:  50%|█████     | 10/20 [04:11<04:08, 24.81s/it]                 
Task 3, Epoch 11/20 => Loss 0.210, Train_accy 93.54:  55%|█████▌    | 11/20 [04:11<03:32, 23.60s/it]
Task 3, Epoch 12/20 => Loss 0.209, Train_accy 93.86:  55%|█████▌    | 11/20 [04:31<03:32, 23.60s/it]
Task 3, Epoch 12/20 => Loss 0.209, Train_accy 93.86:  60%|██████    | 12/20 [04:31<03:01, 22.73s/it]
Task 3, Epoch 13/20 => Loss 0.205, Train_accy 93.96:  60%|██████    | 12/20 [04:52<03:01, 22.73s/it]
Task 3, Epoch 13/20 => Loss 0.205, Train_accy 93.96:  65%|██████▌   | 13/20 [04:52<02:35, 22.16s/it]
Task 3, Epoch 14/20 => Loss 0.228, Train_accy 93.32:  65%|██████▌   | 13/20 [05:13<02:35, 22.16s/it]
Task 3, Epoch 14/20 => Loss 0.228, Train_accy 93.32:  70%|███████   | 14/20 [05:13<02:10, 21.75s/it]
Task 3, Epoch 15/20 => Loss 0.187, Train_accy 94.82, Test_accy 79.90:  70%|███████   | 14/20 [05:45<02:10, 21.75s/it]
Task 3, Epoch 15/20 => Loss 0.187, Train_accy 94.82, Test_accy 79.90:  75%|███████▌  | 15/20 [05:45<02:03, 24.79s/it]
Task 3, Epoch 16/20 => Loss 0.169, Train_accy 95.51:  75%|███████▌  | 15/20 [06:06<02:03, 24.79s/it]                 
Task 3, Epoch 16/20 => Loss 0.169, Train_accy 95.51:  80%|████████  | 16/20 [06:06<01:34, 23.59s/it]
Task 3, Epoch 17/20 => Loss 0.190, Train_accy 94.93:  80%|████████  | 16/20 [06:27<01:34, 23.59s/it]
Task 3, Epoch 17/20 => Loss 0.190, Train_accy 94.93:  85%|████████▌ | 17/20 [06:27<01:08, 22.78s/it]
Task 3, Epoch 18/20 => Loss 0.192, Train_accy 94.44:  85%|████████▌ | 17/20 [06:47<01:08, 22.78s/it]
Task 3, Epoch 18/20 => Loss 0.192, Train_accy 94.44:  90%|█████████ | 18/20 [06:47<00:44, 22.19s/it]
Task 3, Epoch 19/20 => Loss 0.149, Train_accy 95.67:  90%|█████████ | 18/20 [07:08<00:44, 22.19s/it]
Task 3, Epoch 19/20 => Loss 0.149, Train_accy 95.67:  95%|█████████▌| 19/20 [07:08<00:21, 21.76s/it]
Task 3, Epoch 20/20 => Loss 0.158, Train_accy 95.57, Test_accy 80.17:  95%|█████████▌| 19/20 [07:40<00:21, 21.76s/it]
Task 3, Epoch 20/20 => Loss 0.158, Train_accy 95.57, Test_accy 80.17: 100%|██████████| 20/20 [07:40<00:00, 24.80s/it]
Task 3, Epoch 20/20 => Loss 0.158, Train_accy 95.57, Test_accy 80.17: 100%|██████████| 20/20 [07:40<00:00, 23.03s/it]
2024-09-06 00:06:00,952 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.158, Train_accy 95.57, Test_accy 80.17
2024-09-06 00:06:12,019 [trainer.py] => No NME accuracy.
2024-09-06 00:06:12,020 [trainer.py] => CNN: {'total': 80.17, '00-39': 91.85, '40-79': 79.35, '80-119': 75.25, '120-159': 74.95, 'old': 81.92, 'new': 74.95}
2024-09-06 00:06:12,020 [trainer.py] => CNN top1 curve: [96.48, 89.34, 83.9, 80.17]
2024-09-06 00:06:12,020 [trainer.py] => CNN top5 curve: [99.34, 99.13, 98.8, 98.63]

Average Accuracy (CNN): 87.47
2024-09-06 00:06:12,021 [trainer.py] => Average Accuracy (CNN): 87.47 

2024-09-06 00:06:12,022 [trainer.py] => All params: 89792456
2024-09-06 00:06:12,024 [trainer.py] => Trainable params: 89792456
2024-09-06 00:06:15,561 [coda_prompt.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.434, Train_accy 64.16:   0%|          | 0/20 [00:20<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.434, Train_accy 64.16:   5%|▌         | 1/20 [00:20<06:34, 20.74s/it]
Task 4, Epoch 2/20 => Loss 0.367, Train_accy 89.69:   5%|▌         | 1/20 [00:41<06:34, 20.74s/it]
Task 4, Epoch 2/20 => Loss 0.367, Train_accy 89.69:  10%|█         | 2/20 [00:41<06:13, 20.76s/it]
Task 4, Epoch 3/20 => Loss 0.325, Train_accy 90.81:  10%|█         | 2/20 [01:02<06:13, 20.76s/it]
Task 4, Epoch 3/20 => Loss 0.325, Train_accy 90.81:  15%|█▌        | 3/20 [01:02<05:53, 20.79s/it]
Task 4, Epoch 4/20 => Loss 0.291, Train_accy 91.77:  15%|█▌        | 3/20 [01:23<05:53, 20.79s/it]
Task 4, Epoch 4/20 => Loss 0.291, Train_accy 91.77:  20%|██        | 4/20 [01:23<05:33, 20.87s/it]
Task 4, Epoch 5/20 => Loss 0.270, Train_accy 92.09, Test_accy 75.36:  20%|██        | 4/20 [01:57<05:33, 20.87s/it]
Task 4, Epoch 5/20 => Loss 0.270, Train_accy 92.09, Test_accy 75.36:  25%|██▌       | 5/20 [01:57<06:27, 25.82s/it]
Task 4, Epoch 6/20 => Loss 0.224, Train_accy 93.70:  25%|██▌       | 5/20 [02:18<06:27, 25.82s/it]                 
Task 4, Epoch 6/20 => Loss 0.224, Train_accy 93.70:  30%|███       | 6/20 [02:18<05:37, 24.14s/it]
Task 4, Epoch 7/20 => Loss 0.237, Train_accy 93.59:  30%|███       | 6/20 [02:39<05:37, 24.14s/it]
Task 4, Epoch 7/20 => Loss 0.237, Train_accy 93.59:  35%|███▌      | 7/20 [02:39<04:59, 23.05s/it]
Task 4, Epoch 8/20 => Loss 0.202, Train_accy 94.07:  35%|███▌      | 7/20 [03:00<04:59, 23.05s/it]
Task 4, Epoch 8/20 => Loss 0.202, Train_accy 94.07:  40%|████      | 8/20 [03:00<04:28, 22.35s/it]
Task 4, Epoch 9/20 => Loss 0.191, Train_accy 94.71:  40%|████      | 8/20 [03:21<04:28, 22.35s/it]
Task 4, Epoch 9/20 => Loss 0.191, Train_accy 94.71:  45%|████▌     | 9/20 [03:21<04:00, 21.87s/it]
Task 4, Epoch 10/20 => Loss 0.215, Train_accy 93.75, Test_accy 77.52:  45%|████▌     | 9/20 [03:55<04:00, 21.87s/it]
Task 4, Epoch 10/20 => Loss 0.215, Train_accy 93.75, Test_accy 77.52:  50%|█████     | 10/20 [03:55<04:17, 25.75s/it]
Task 4, Epoch 11/20 => Loss 0.187, Train_accy 94.44:  50%|█████     | 10/20 [04:16<04:17, 25.75s/it]                 
Task 4, Epoch 11/20 => Loss 0.187, Train_accy 94.44:  55%|█████▌    | 11/20 [04:16<03:38, 24.25s/it]
Task 4, Epoch 12/20 => Loss 0.223, Train_accy 93.43:  55%|█████▌    | 11/20 [04:37<03:38, 24.25s/it]
Task 4, Epoch 12/20 => Loss 0.223, Train_accy 93.43:  60%|██████    | 12/20 [04:37<03:05, 23.20s/it]
Task 4, Epoch 13/20 => Loss 0.178, Train_accy 95.30:  60%|██████    | 12/20 [04:58<03:05, 23.20s/it]
Task 4, Epoch 13/20 => Loss 0.178, Train_accy 95.30:  65%|██████▌   | 13/20 [04:58<02:37, 22.48s/it]
Task 4, Epoch 14/20 => Loss 0.196, Train_accy 94.82:  65%|██████▌   | 13/20 [05:19<02:37, 22.48s/it]
Task 4, Epoch 14/20 => Loss 0.196, Train_accy 94.82:  70%|███████   | 14/20 [05:19<02:11, 21.99s/it]
Task 4, Epoch 15/20 => Loss 0.177, Train_accy 94.98, Test_accy 78.07:  70%|███████   | 14/20 [05:53<02:11, 21.99s/it]
Task 4, Epoch 15/20 => Loss 0.177, Train_accy 94.98, Test_accy 78.07:  75%|███████▌  | 15/20 [05:53<02:08, 25.80s/it]
Task 4, Epoch 16/20 => Loss 0.186, Train_accy 95.14:  75%|███████▌  | 15/20 [06:14<02:08, 25.80s/it]                 
Task 4, Epoch 16/20 => Loss 0.186, Train_accy 95.14:  80%|████████  | 16/20 [06:14<01:37, 24.31s/it]
Task 4, Epoch 17/20 => Loss 0.171, Train_accy 95.19:  80%|████████  | 16/20 [06:35<01:37, 24.31s/it]
Task 4, Epoch 17/20 => Loss 0.171, Train_accy 95.19:  85%|████████▌ | 17/20 [06:35<01:09, 23.28s/it]
Task 4, Epoch 18/20 => Loss 0.160, Train_accy 95.57:  85%|████████▌ | 17/20 [06:56<01:09, 23.28s/it]
Task 4, Epoch 18/20 => Loss 0.160, Train_accy 95.57:  90%|█████████ | 18/20 [06:56<00:45, 22.56s/it]
Task 4, Epoch 19/20 => Loss 0.163, Train_accy 94.93:  90%|█████████ | 18/20 [07:17<00:45, 22.56s/it]
Task 4, Epoch 19/20 => Loss 0.163, Train_accy 94.93:  95%|█████████▌| 19/20 [07:17<00:22, 22.05s/it]
Task 4, Epoch 20/20 => Loss 0.186, Train_accy 94.60, Test_accy 78.37:  95%|█████████▌| 19/20 [07:51<00:22, 22.05s/it]
Task 4, Epoch 20/20 => Loss 0.186, Train_accy 94.60, Test_accy 78.37: 100%|██████████| 20/20 [07:51<00:00, 25.81s/it]
Task 4, Epoch 20/20 => Loss 0.186, Train_accy 94.60, Test_accy 78.37: 100%|██████████| 20/20 [07:51<00:00, 23.59s/it]
2024-09-06 00:14:07,305 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.186, Train_accy 94.60, Test_accy 78.37
2024-09-06 00:14:20,987 [trainer.py] => No NME accuracy.
2024-09-06 00:14:20,987 [trainer.py] => CNN: {'total': 78.37, '00-39': 90.31, '40-79': 78.71, '80-119': 73.44, '120-159': 74.53, '160-199': 75.59, 'old': 79.06, 'new': 75.59}
2024-09-06 00:14:20,988 [trainer.py] => CNN top1 curve: [96.48, 89.34, 83.9, 80.17, 78.37]
2024-09-06 00:14:20,988 [trainer.py] => CNN top5 curve: [99.34, 99.13, 98.8, 98.63, 98.05]

Average Accuracy (CNN): 85.65
2024-09-06 00:14:20,988 [trainer.py] => Average Accuracy (CNN): 85.65 

Accuracy Matrix (CNN):
[[96.48 93.39 92.73 91.85 90.31]
 [ 0.   85.38 81.72 79.35 78.71]
 [ 0.    0.   77.87 75.25 73.44]
 [ 0.    0.    0.   74.95 74.53]
 [ 0.    0.    0.    0.   75.59]]
2024-09-06 00:14:20,990 [trainer.py] => Forgetting (CNN): 4.422500000000003
2024-09-06 00:14:23,622 [trainer.py] => config: ./exps/coda_prompt_cub_B0_Inc10.json
2024-09-06 00:14:23,634 [trainer.py] => prefix:  
2024-09-06 00:14:23,634 [trainer.py] => dataset: cub
2024-09-06 00:14:23,634 [trainer.py] => memory_size: 0
2024-09-06 00:14:23,634 [trainer.py] => memory_per_class: 0
2024-09-06 00:14:23,634 [trainer.py] => fixed_memory: False
2024-09-06 00:14:23,634 [trainer.py] => shuffle: True
2024-09-06 00:14:23,634 [trainer.py] => init_cls: 20
2024-09-06 00:14:23,634 [trainer.py] => increment: 20
2024-09-06 00:14:23,634 [trainer.py] => model_name: coda_prompt
2024-09-06 00:14:23,634 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-06 00:14:23,634 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 00:14:23,634 [trainer.py] => seed: 1993
2024-09-06 00:14:23,634 [trainer.py] => tuned_epoch: 20
2024-09-06 00:14:23,634 [trainer.py] => init_lr: 0.001
2024-09-06 00:14:23,635 [trainer.py] => batch_size: 48
2024-09-06 00:14:23,635 [trainer.py] => weight_decay: 0
2024-09-06 00:14:23,635 [trainer.py] => min_lr: 1e-05
2024-09-06 00:14:23,635 [trainer.py] => optimizer: adam
2024-09-06 00:14:23,635 [trainer.py] => scheduler: cosine
2024-09-06 00:14:23,635 [trainer.py] => reinit_optimizer: True
2024-09-06 00:14:23,635 [trainer.py] => pretrained: True
2024-09-06 00:14:23,635 [trainer.py] => drop: 0.0
2024-09-06 00:14:23,635 [trainer.py] => drop_path: 0.0
2024-09-06 00:14:23,635 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-06 00:14:23,672 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-06 00:14:25,572 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-06 00:14:25,573 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-06 00:14:25,573 [trainer.py] => All params: 89792456
2024-09-06 00:14:25,574 [trainer.py] => Trainable params: 89792456
2024-09-06 00:14:25,574 [coda_prompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.447, Train_accy 62.72:   0%|          | 0/20 [00:10<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.447, Train_accy 62.72:   5%|▌         | 1/20 [00:10<03:20, 10.56s/it]
Task 0, Epoch 2/20 => Loss 0.361, Train_accy 90.13:   5%|▌         | 1/20 [00:20<03:20, 10.56s/it]
Task 0, Epoch 2/20 => Loss 0.361, Train_accy 90.13:  10%|█         | 2/20 [00:20<03:06, 10.36s/it]
Task 0, Epoch 3/20 => Loss 0.252, Train_accy 93.31:  10%|█         | 2/20 [00:31<03:06, 10.36s/it]
Task 0, Epoch 3/20 => Loss 0.252, Train_accy 93.31:  15%|█▌        | 3/20 [00:31<02:55, 10.31s/it]
Task 0, Epoch 4/20 => Loss 0.218, Train_accy 94.08:  15%|█▌        | 3/20 [00:41<02:55, 10.31s/it]
Task 0, Epoch 4/20 => Loss 0.218, Train_accy 94.08:  20%|██        | 4/20 [00:41<02:44, 10.28s/it]
Task 0, Epoch 5/20 => Loss 0.222, Train_accy 93.86, Test_accy 97.98:  20%|██        | 4/20 [00:53<02:44, 10.28s/it]
Task 0, Epoch 5/20 => Loss 0.222, Train_accy 93.86, Test_accy 97.98:  25%|██▌       | 5/20 [00:53<02:43, 10.93s/it]
Task 0, Epoch 6/20 => Loss 0.159, Train_accy 94.96:  25%|██▌       | 5/20 [01:03<02:43, 10.93s/it]                 
Task 0, Epoch 6/20 => Loss 0.159, Train_accy 94.96:  30%|███       | 6/20 [01:03<02:29, 10.69s/it]
Task 0, Epoch 7/20 => Loss 0.169, Train_accy 94.85:  30%|███       | 6/20 [01:13<02:29, 10.69s/it]
Task 0, Epoch 7/20 => Loss 0.169, Train_accy 94.85:  35%|███▌      | 7/20 [01:13<02:17, 10.54s/it]
Task 0, Epoch 8/20 => Loss 0.154, Train_accy 95.50:  35%|███▌      | 7/20 [01:24<02:17, 10.54s/it]
Task 0, Epoch 8/20 => Loss 0.154, Train_accy 95.50:  40%|████      | 8/20 [01:24<02:05, 10.45s/it]
Task 0, Epoch 9/20 => Loss 0.155, Train_accy 95.29:  40%|████      | 8/20 [01:34<02:05, 10.45s/it]
Task 0, Epoch 9/20 => Loss 0.155, Train_accy 95.29:  45%|████▌     | 9/20 [01:34<01:54, 10.40s/it]
Task 0, Epoch 10/20 => Loss 0.113, Train_accy 96.38, Test_accy 97.57:  45%|████▌     | 9/20 [01:46<01:54, 10.40s/it]
Task 0, Epoch 10/20 => Loss 0.113, Train_accy 96.38, Test_accy 97.57:  50%|█████     | 10/20 [01:46<01:49, 10.92s/it]
Task 0, Epoch 11/20 => Loss 0.122, Train_accy 95.83:  50%|█████     | 10/20 [01:56<01:49, 10.92s/it]                 
Task 0, Epoch 11/20 => Loss 0.122, Train_accy 95.83:  55%|█████▌    | 11/20 [01:56<01:36, 10.70s/it]
Task 0, Epoch 12/20 => Loss 0.161, Train_accy 95.29:  55%|█████▌    | 11/20 [02:06<01:36, 10.70s/it]
Task 0, Epoch 12/20 => Loss 0.161, Train_accy 95.29:  60%|██████    | 12/20 [02:06<01:24, 10.56s/it]
Task 0, Epoch 13/20 => Loss 0.140, Train_accy 95.83:  60%|██████    | 12/20 [02:17<01:24, 10.56s/it]
Task 0, Epoch 13/20 => Loss 0.140, Train_accy 95.83:  65%|██████▌   | 13/20 [02:17<01:13, 10.47s/it]
Task 0, Epoch 14/20 => Loss 0.111, Train_accy 96.60:  65%|██████▌   | 13/20 [02:27<01:13, 10.47s/it]
Task 0, Epoch 14/20 => Loss 0.111, Train_accy 96.60:  70%|███████   | 14/20 [02:27<01:02, 10.41s/it]
Task 0, Epoch 15/20 => Loss 0.103, Train_accy 96.82, Test_accy 97.98:  70%|███████   | 14/20 [02:39<01:02, 10.41s/it]
Task 0, Epoch 15/20 => Loss 0.103, Train_accy 96.82, Test_accy 97.98:  75%|███████▌  | 15/20 [02:39<00:54, 10.93s/it]
Task 0, Epoch 16/20 => Loss 0.131, Train_accy 95.83:  75%|███████▌  | 15/20 [02:49<00:54, 10.93s/it]                 
Task 0, Epoch 16/20 => Loss 0.131, Train_accy 95.83:  80%|████████  | 16/20 [02:49<00:42, 10.73s/it]
Task 0, Epoch 17/20 => Loss 0.113, Train_accy 96.16:  80%|████████  | 16/20 [03:00<00:42, 10.73s/it]
Task 0, Epoch 17/20 => Loss 0.113, Train_accy 96.16:  85%|████████▌ | 17/20 [03:00<00:31, 10.59s/it]
Task 0, Epoch 18/20 => Loss 0.110, Train_accy 96.71:  85%|████████▌ | 17/20 [03:10<00:31, 10.59s/it]
Task 0, Epoch 18/20 => Loss 0.110, Train_accy 96.71:  90%|█████████ | 18/20 [03:10<00:20, 10.49s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 96.05:  90%|█████████ | 18/20 [03:20<00:20, 10.49s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 96.05:  95%|█████████▌| 19/20 [03:20<00:10, 10.45s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 97.26, Test_accy 97.98:  95%|█████████▌| 19/20 [03:32<00:10, 10.45s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 97.26, Test_accy 97.98: 100%|██████████| 20/20 [03:32<00:00, 10.94s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 97.26, Test_accy 97.98: 100%|██████████| 20/20 [03:32<00:00, 10.64s/it]
2024-09-06 00:17:58,791 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.103, Train_accy 97.26, Test_accy 97.98
2024-09-06 00:18:00,615 [trainer.py] => No NME accuracy.
2024-09-06 00:18:00,616 [trainer.py] => CNN: {'total': 97.98, '00-19': 97.98, 'old': 0, 'new': 97.98}
2024-09-06 00:18:00,616 [trainer.py] => CNN top1 curve: [97.98]
2024-09-06 00:18:00,616 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.98
2024-09-06 00:18:00,616 [trainer.py] => Average Accuracy (CNN): 97.98 

2024-09-06 00:18:00,618 [trainer.py] => All params: 89792456
2024-09-06 00:18:00,619 [trainer.py] => Trainable params: 89792456
2024-09-06 00:18:00,927 [coda_prompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.332, Train_accy 63.49:   0%|          | 0/20 [00:10<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.332, Train_accy 63.49:   5%|▌         | 1/20 [00:10<03:14, 10.25s/it]
Task 1, Epoch 2/20 => Loss 0.267, Train_accy 91.78:   5%|▌         | 1/20 [00:20<03:14, 10.25s/it]
Task 1, Epoch 2/20 => Loss 0.267, Train_accy 91.78:  10%|█         | 2/20 [00:20<03:04, 10.25s/it]
Task 1, Epoch 3/20 => Loss 0.204, Train_accy 94.63:  10%|█         | 2/20 [00:30<03:04, 10.25s/it]
Task 1, Epoch 3/20 => Loss 0.204, Train_accy 94.63:  15%|█▌        | 3/20 [00:30<02:54, 10.25s/it]
Task 1, Epoch 4/20 => Loss 0.207, Train_accy 93.97:  15%|█▌        | 3/20 [00:41<02:54, 10.25s/it]
Task 1, Epoch 4/20 => Loss 0.207, Train_accy 93.97:  20%|██        | 4/20 [00:41<02:44, 10.26s/it]
Task 1, Epoch 5/20 => Loss 0.160, Train_accy 95.61, Test_accy 93.17:  20%|██        | 4/20 [00:54<02:44, 10.26s/it]
Task 1, Epoch 5/20 => Loss 0.160, Train_accy 95.61, Test_accy 93.17:  25%|██▌       | 5/20 [00:54<02:50, 11.35s/it]
Task 1, Epoch 6/20 => Loss 0.155, Train_accy 95.39:  25%|██▌       | 5/20 [01:04<02:50, 11.35s/it]                 
Task 1, Epoch 6/20 => Loss 0.155, Train_accy 95.39:  30%|███       | 6/20 [01:04<02:33, 10.97s/it]
Task 1, Epoch 7/20 => Loss 0.125, Train_accy 96.16:  30%|███       | 6/20 [01:14<02:33, 10.97s/it]
Task 1, Epoch 7/20 => Loss 0.125, Train_accy 96.16:  35%|███▌      | 7/20 [01:14<02:19, 10.73s/it]
Task 1, Epoch 8/20 => Loss 0.136, Train_accy 95.61:  35%|███▌      | 7/20 [01:25<02:19, 10.73s/it]
Task 1, Epoch 8/20 => Loss 0.136, Train_accy 95.61:  40%|████      | 8/20 [01:25<02:06, 10.58s/it]
Task 1, Epoch 9/20 => Loss 0.106, Train_accy 96.82:  40%|████      | 8/20 [01:35<02:06, 10.58s/it]
Task 1, Epoch 9/20 => Loss 0.106, Train_accy 96.82:  45%|████▌     | 9/20 [01:35<01:55, 10.48s/it]
Task 1, Epoch 10/20 => Loss 0.127, Train_accy 96.49, Test_accy 94.71:  45%|████▌     | 9/20 [01:48<01:55, 10.48s/it]
Task 1, Epoch 10/20 => Loss 0.127, Train_accy 96.49, Test_accy 94.71:  50%|█████     | 10/20 [01:48<01:53, 11.33s/it]
Task 1, Epoch 11/20 => Loss 0.117, Train_accy 96.38:  50%|█████     | 10/20 [01:58<01:53, 11.33s/it]                 
Task 1, Epoch 11/20 => Loss 0.117, Train_accy 96.38:  55%|█████▌    | 11/20 [01:58<01:39, 11.02s/it]
Task 1, Epoch 12/20 => Loss 0.114, Train_accy 96.60:  55%|█████▌    | 11/20 [02:09<01:39, 11.02s/it]
Task 1, Epoch 12/20 => Loss 0.114, Train_accy 96.60:  60%|██████    | 12/20 [02:09<01:26, 10.78s/it]
Task 1, Epoch 13/20 => Loss 0.093, Train_accy 97.26:  60%|██████    | 12/20 [02:19<01:26, 10.78s/it]
Task 1, Epoch 13/20 => Loss 0.093, Train_accy 97.26:  65%|██████▌   | 13/20 [02:19<01:14, 10.60s/it]
Task 1, Epoch 14/20 => Loss 0.126, Train_accy 95.94:  65%|██████▌   | 13/20 [02:29<01:14, 10.60s/it]
Task 1, Epoch 14/20 => Loss 0.126, Train_accy 95.94:  70%|███████   | 14/20 [02:29<01:02, 10.50s/it]
Task 1, Epoch 15/20 => Loss 0.096, Train_accy 96.93, Test_accy 95.15:  70%|███████   | 14/20 [02:42<01:02, 10.50s/it]
Task 1, Epoch 15/20 => Loss 0.096, Train_accy 96.93, Test_accy 95.15:  75%|███████▌  | 15/20 [02:42<00:56, 11.33s/it]
Task 1, Epoch 16/20 => Loss 0.095, Train_accy 97.15:  75%|███████▌  | 15/20 [02:53<00:56, 11.33s/it]                 
Task 1, Epoch 16/20 => Loss 0.095, Train_accy 97.15:  80%|████████  | 16/20 [02:53<00:44, 11.01s/it]
Task 1, Epoch 17/20 => Loss 0.076, Train_accy 97.70:  80%|████████  | 16/20 [03:03<00:44, 11.01s/it]
Task 1, Epoch 17/20 => Loss 0.076, Train_accy 97.70:  85%|████████▌ | 17/20 [03:03<00:32, 10.78s/it]
Task 1, Epoch 18/20 => Loss 0.094, Train_accy 97.37:  85%|████████▌ | 17/20 [03:13<00:32, 10.78s/it]
Task 1, Epoch 18/20 => Loss 0.094, Train_accy 97.37:  90%|█████████ | 18/20 [03:13<00:21, 10.63s/it]
Task 1, Epoch 19/20 => Loss 0.095, Train_accy 97.37:  90%|█████████ | 18/20 [03:23<00:21, 10.63s/it]
Task 1, Epoch 19/20 => Loss 0.095, Train_accy 97.37:  95%|█████████▌| 19/20 [03:23<00:10, 10.52s/it]
Task 1, Epoch 20/20 => Loss 0.103, Train_accy 96.71, Test_accy 95.15:  95%|█████████▌| 19/20 [03:37<00:10, 10.52s/it]
Task 1, Epoch 20/20 => Loss 0.103, Train_accy 96.71, Test_accy 95.15: 100%|██████████| 20/20 [03:37<00:00, 11.36s/it]
Task 1, Epoch 20/20 => Loss 0.103, Train_accy 96.71, Test_accy 95.15: 100%|██████████| 20/20 [03:37<00:00, 10.86s/it]
2024-09-06 00:21:38,081 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.103, Train_accy 96.71, Test_accy 95.15
2024-09-06 00:21:41,067 [trainer.py] => No NME accuracy.
2024-09-06 00:21:41,068 [trainer.py] => CNN: {'total': 95.15, '00-19': 97.57, '20-39': 92.27, 'old': 97.57, 'new': 92.27}
2024-09-06 00:21:41,068 [trainer.py] => CNN top1 curve: [97.98, 95.15]
2024-09-06 00:21:41,068 [trainer.py] => CNN top5 curve: [100.0, 99.78]

Average Accuracy (CNN): 96.56
2024-09-06 00:21:41,068 [trainer.py] => Average Accuracy (CNN): 96.56 

2024-09-06 00:21:41,069 [trainer.py] => All params: 89792456
2024-09-06 00:21:41,071 [trainer.py] => Trainable params: 89792456
2024-09-06 00:21:41,560 [coda_prompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.511, Train_accy 58.11:   0%|          | 0/20 [00:10<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.511, Train_accy 58.11:   5%|▌         | 1/20 [00:10<03:14, 10.25s/it]
Task 2, Epoch 2/20 => Loss 0.327, Train_accy 91.34:   5%|▌         | 1/20 [00:20<03:14, 10.25s/it]
Task 2, Epoch 2/20 => Loss 0.327, Train_accy 91.34:  10%|█         | 2/20 [00:20<03:04, 10.25s/it]
Task 2, Epoch 3/20 => Loss 0.254, Train_accy 92.54:  10%|█         | 2/20 [00:30<03:04, 10.25s/it]
Task 2, Epoch 3/20 => Loss 0.254, Train_accy 92.54:  15%|█▌        | 3/20 [00:30<02:54, 10.26s/it]
Task 2, Epoch 4/20 => Loss 0.166, Train_accy 94.96:  15%|█▌        | 3/20 [00:41<02:54, 10.26s/it]
Task 2, Epoch 4/20 => Loss 0.166, Train_accy 94.96:  20%|██        | 4/20 [00:41<02:44, 10.27s/it]
Task 2, Epoch 5/20 => Loss 0.192, Train_accy 94.63, Test_accy 88.69:  20%|██        | 4/20 [00:55<02:44, 10.27s/it]
Task 2, Epoch 5/20 => Loss 0.192, Train_accy 94.63, Test_accy 88.69:  25%|██▌       | 5/20 [00:55<02:56, 11.80s/it]
Task 2, Epoch 6/20 => Loss 0.161, Train_accy 94.74:  25%|██▌       | 5/20 [01:05<02:56, 11.80s/it]                 
Task 2, Epoch 6/20 => Loss 0.161, Train_accy 94.74:  30%|███       | 6/20 [01:05<02:37, 11.27s/it]
Task 2, Epoch 7/20 => Loss 0.164, Train_accy 95.61:  30%|███       | 6/20 [01:16<02:37, 11.27s/it]
Task 2, Epoch 7/20 => Loss 0.164, Train_accy 95.61:  35%|███▌      | 7/20 [01:16<02:22, 10.94s/it]
Task 2, Epoch 8/20 => Loss 0.193, Train_accy 94.85:  35%|███▌      | 7/20 [01:26<02:22, 10.94s/it]
Task 2, Epoch 8/20 => Loss 0.193, Train_accy 94.85:  40%|████      | 8/20 [01:26<02:08, 10.73s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 95.18:  40%|████      | 8/20 [01:36<02:08, 10.73s/it]
Task 2, Epoch 9/20 => Loss 0.149, Train_accy 95.18:  45%|████▌     | 9/20 [01:36<01:56, 10.58s/it]
Task 2, Epoch 10/20 => Loss 0.149, Train_accy 95.18, Test_accy 89.29:  45%|████▌     | 9/20 [01:51<01:56, 10.58s/it]
Task 2, Epoch 10/20 => Loss 0.149, Train_accy 95.18, Test_accy 89.29:  50%|█████     | 10/20 [01:51<01:57, 11.78s/it]
Task 2, Epoch 11/20 => Loss 0.171, Train_accy 95.07:  50%|█████     | 10/20 [02:01<01:57, 11.78s/it]                 
Task 2, Epoch 11/20 => Loss 0.171, Train_accy 95.07:  55%|█████▌    | 11/20 [02:01<01:41, 11.32s/it]
Task 2, Epoch 12/20 => Loss 0.198, Train_accy 92.98:  55%|█████▌    | 11/20 [02:11<01:41, 11.32s/it]
Task 2, Epoch 12/20 => Loss 0.198, Train_accy 92.98:  60%|██████    | 12/20 [02:11<01:28, 11.00s/it]
Task 2, Epoch 13/20 => Loss 0.118, Train_accy 96.27:  60%|██████    | 12/20 [02:21<01:28, 11.00s/it]
Task 2, Epoch 13/20 => Loss 0.118, Train_accy 96.27:  65%|██████▌   | 13/20 [02:21<01:15, 10.77s/it]
Task 2, Epoch 14/20 => Loss 0.136, Train_accy 96.05:  65%|██████▌   | 13/20 [02:32<01:15, 10.77s/it]
Task 2, Epoch 14/20 => Loss 0.136, Train_accy 96.05:  70%|███████   | 14/20 [02:32<01:03, 10.62s/it]
Task 2, Epoch 15/20 => Loss 0.116, Train_accy 96.05, Test_accy 90.03:  70%|███████   | 14/20 [02:46<01:03, 10.62s/it]
Task 2, Epoch 15/20 => Loss 0.116, Train_accy 96.05, Test_accy 90.03:  75%|███████▌  | 15/20 [02:46<00:58, 11.78s/it]
Task 2, Epoch 16/20 => Loss 0.140, Train_accy 95.29:  75%|███████▌  | 15/20 [02:56<00:58, 11.78s/it]                 
Task 2, Epoch 16/20 => Loss 0.140, Train_accy 95.29:  80%|████████  | 16/20 [02:56<00:45, 11.31s/it]
Task 2, Epoch 17/20 => Loss 0.124, Train_accy 96.38:  80%|████████  | 16/20 [03:07<00:45, 11.31s/it]
Task 2, Epoch 17/20 => Loss 0.124, Train_accy 96.38:  85%|████████▌ | 17/20 [03:07<00:32, 10.99s/it]
Task 2, Epoch 18/20 => Loss 0.140, Train_accy 95.61:  85%|████████▌ | 17/20 [03:17<00:32, 10.99s/it]
Task 2, Epoch 18/20 => Loss 0.140, Train_accy 95.61:  90%|█████████ | 18/20 [03:17<00:21, 10.77s/it]
Task 2, Epoch 19/20 => Loss 0.136, Train_accy 96.05:  90%|█████████ | 18/20 [03:27<00:21, 10.77s/it]
Task 2, Epoch 19/20 => Loss 0.136, Train_accy 96.05:  95%|█████████▌| 19/20 [03:27<00:10, 10.63s/it]
Task 2, Epoch 20/20 => Loss 0.138, Train_accy 95.83, Test_accy 89.73:  95%|█████████▌| 19/20 [03:42<00:10, 10.63s/it]
Task 2, Epoch 20/20 => Loss 0.138, Train_accy 95.83, Test_accy 89.73: 100%|██████████| 20/20 [03:42<00:00, 11.78s/it]
Task 2, Epoch 20/20 => Loss 0.138, Train_accy 95.83, Test_accy 89.73: 100%|██████████| 20/20 [03:42<00:00, 11.10s/it]
2024-09-06 00:25:23,645 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.138, Train_accy 95.83, Test_accy 89.73
2024-09-06 00:25:27,817 [trainer.py] => No NME accuracy.
2024-09-06 00:25:27,817 [trainer.py] => CNN: {'total': 89.73, '00-19': 95.55, '20-39': 91.3, '40-59': 81.65, 'old': 93.61, 'new': 81.65}
2024-09-06 00:25:27,817 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73]
2024-09-06 00:25:27,817 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26]

Average Accuracy (CNN): 94.29
2024-09-06 00:25:27,817 [trainer.py] => Average Accuracy (CNN): 94.29 

2024-09-06 00:25:27,819 [trainer.py] => All params: 89792456
2024-09-06 00:25:27,820 [trainer.py] => Trainable params: 89792456
2024-09-06 00:25:28,488 [coda_prompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.382, Train_accy 65.79:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.382, Train_accy 65.79:   5%|▌         | 1/20 [00:10<03:15, 10.29s/it]
Task 3, Epoch 2/20 => Loss 0.296, Train_accy 90.13:   5%|▌         | 1/20 [00:20<03:15, 10.29s/it]
Task 3, Epoch 2/20 => Loss 0.296, Train_accy 90.13:  10%|█         | 2/20 [00:20<03:05, 10.28s/it]
Task 3, Epoch 3/20 => Loss 0.189, Train_accy 94.19:  10%|█         | 2/20 [00:30<03:05, 10.28s/it]
Task 3, Epoch 3/20 => Loss 0.189, Train_accy 94.19:  15%|█▌        | 3/20 [00:30<02:54, 10.27s/it]
Task 3, Epoch 4/20 => Loss 0.237, Train_accy 92.98:  15%|█▌        | 3/20 [00:41<02:54, 10.27s/it]
Task 3, Epoch 4/20 => Loss 0.237, Train_accy 92.98:  20%|██        | 4/20 [00:41<02:44, 10.27s/it]
Task 3, Epoch 5/20 => Loss 0.157, Train_accy 94.74, Test_accy 87.05:  20%|██        | 4/20 [00:57<02:44, 10.27s/it]
Task 3, Epoch 5/20 => Loss 0.157, Train_accy 94.74, Test_accy 87.05:  25%|██▌       | 5/20 [00:57<03:04, 12.31s/it]
Task 3, Epoch 6/20 => Loss 0.168, Train_accy 94.08:  25%|██▌       | 5/20 [01:07<03:04, 12.31s/it]                 
Task 3, Epoch 6/20 => Loss 0.168, Train_accy 94.08:  30%|███       | 6/20 [01:07<02:42, 11.61s/it]
Task 3, Epoch 7/20 => Loss 0.173, Train_accy 94.63:  30%|███       | 6/20 [01:17<02:42, 11.61s/it]
Task 3, Epoch 7/20 => Loss 0.173, Train_accy 94.63:  35%|███▌      | 7/20 [01:17<02:24, 11.12s/it]
Task 3, Epoch 8/20 => Loss 0.143, Train_accy 95.61:  35%|███▌      | 7/20 [01:27<02:24, 11.12s/it]
Task 3, Epoch 8/20 => Loss 0.143, Train_accy 95.61:  40%|████      | 8/20 [01:27<02:09, 10.81s/it]
Task 3, Epoch 9/20 => Loss 0.119, Train_accy 96.27:  40%|████      | 8/20 [01:37<02:09, 10.81s/it]
Task 3, Epoch 9/20 => Loss 0.119, Train_accy 96.27:  45%|████▌     | 9/20 [01:37<01:57, 10.64s/it]
Task 3, Epoch 10/20 => Loss 0.160, Train_accy 94.85, Test_accy 87.60:  45%|████▌     | 9/20 [01:53<01:57, 10.64s/it]
Task 3, Epoch 10/20 => Loss 0.160, Train_accy 94.85, Test_accy 87.60:  50%|█████     | 10/20 [01:53<02:02, 12.25s/it]
Task 3, Epoch 11/20 => Loss 0.138, Train_accy 95.39:  50%|█████     | 10/20 [02:04<02:02, 12.25s/it]                 
Task 3, Epoch 11/20 => Loss 0.138, Train_accy 95.39:  55%|█████▌    | 11/20 [02:04<01:45, 11.71s/it]
Task 3, Epoch 12/20 => Loss 0.112, Train_accy 96.71:  55%|█████▌    | 11/20 [02:14<01:45, 11.71s/it]
Task 3, Epoch 12/20 => Loss 0.112, Train_accy 96.71:  60%|██████    | 12/20 [02:14<01:30, 11.27s/it]
Task 3, Epoch 13/20 => Loss 0.140, Train_accy 95.07:  60%|██████    | 12/20 [02:24<01:30, 11.27s/it]
Task 3, Epoch 13/20 => Loss 0.140, Train_accy 95.07:  65%|██████▌   | 13/20 [02:24<01:16, 10.97s/it]
Task 3, Epoch 14/20 => Loss 0.128, Train_accy 95.61:  65%|██████▌   | 13/20 [02:34<01:16, 10.97s/it]
Task 3, Epoch 14/20 => Loss 0.128, Train_accy 95.61:  70%|███████   | 14/20 [02:34<01:04, 10.76s/it]
Task 3, Epoch 15/20 => Loss 0.111, Train_accy 96.49, Test_accy 88.03:  70%|███████   | 14/20 [02:50<01:04, 10.76s/it]
Task 3, Epoch 15/20 => Loss 0.111, Train_accy 96.49, Test_accy 88.03:  75%|███████▌  | 15/20 [02:50<01:01, 12.30s/it]
Task 3, Epoch 16/20 => Loss 0.097, Train_accy 96.71:  75%|███████▌  | 15/20 [03:01<01:01, 12.30s/it]                 
Task 3, Epoch 16/20 => Loss 0.097, Train_accy 96.71:  80%|████████  | 16/20 [03:01<00:46, 11.69s/it]
Task 3, Epoch 17/20 => Loss 0.107, Train_accy 96.71:  80%|████████  | 16/20 [03:11<00:46, 11.69s/it]
Task 3, Epoch 17/20 => Loss 0.107, Train_accy 96.71:  85%|████████▌ | 17/20 [03:11<00:33, 11.28s/it]
Task 3, Epoch 18/20 => Loss 0.119, Train_accy 96.49:  85%|████████▌ | 17/20 [03:21<00:33, 11.28s/it]
Task 3, Epoch 18/20 => Loss 0.119, Train_accy 96.49:  90%|█████████ | 18/20 [03:21<00:21, 10.97s/it]
Task 3, Epoch 19/20 => Loss 0.103, Train_accy 96.60:  90%|█████████ | 18/20 [03:31<00:21, 10.97s/it]
Task 3, Epoch 19/20 => Loss 0.103, Train_accy 96.60:  95%|█████████▌| 19/20 [03:31<00:10, 10.76s/it]
Task 3, Epoch 20/20 => Loss 0.116, Train_accy 96.49, Test_accy 88.03:  95%|█████████▌| 19/20 [03:47<00:10, 10.76s/it]
Task 3, Epoch 20/20 => Loss 0.116, Train_accy 96.49, Test_accy 88.03: 100%|██████████| 20/20 [03:47<00:00, 12.30s/it]
Task 3, Epoch 20/20 => Loss 0.116, Train_accy 96.49, Test_accy 88.03: 100%|██████████| 20/20 [03:47<00:00, 11.39s/it]
2024-09-06 00:29:16,314 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.116, Train_accy 96.49, Test_accy 88.03
2024-09-06 00:29:21,915 [trainer.py] => No NME accuracy.
2024-09-06 00:29:21,916 [trainer.py] => CNN: {'total': 88.03, '00-19': 92.31, '20-39': 87.92, '40-59': 81.65, '60-79': 89.47, 'old': 87.5, 'new': 89.47}
2024-09-06 00:29:21,916 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73, 88.03]
2024-09-06 00:29:21,916 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.35]

Average Accuracy (CNN): 92.72
2024-09-06 00:29:21,917 [trainer.py] => Average Accuracy (CNN): 92.72 

2024-09-06 00:29:21,918 [trainer.py] => All params: 89792456
2024-09-06 00:29:21,920 [trainer.py] => Trainable params: 89792456
2024-09-06 00:29:22,794 [coda_prompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.284, Train_accy 65.68:   0%|          | 0/20 [00:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.284, Train_accy 65.68:   5%|▌         | 1/20 [00:10<03:15, 10.29s/it]
Task 4, Epoch 2/20 => Loss 0.299, Train_accy 90.24:   5%|▌         | 1/20 [00:20<03:15, 10.29s/it]
Task 4, Epoch 2/20 => Loss 0.299, Train_accy 90.24:  10%|█         | 2/20 [00:20<03:04, 10.28s/it]
Task 4, Epoch 3/20 => Loss 0.225, Train_accy 93.20:  10%|█         | 2/20 [00:30<03:04, 10.28s/it]
Task 4, Epoch 3/20 => Loss 0.225, Train_accy 93.20:  15%|█▌        | 3/20 [00:30<02:54, 10.28s/it]
Task 4, Epoch 4/20 => Loss 0.217, Train_accy 93.20:  15%|█▌        | 3/20 [00:41<02:54, 10.28s/it]
Task 4, Epoch 4/20 => Loss 0.217, Train_accy 93.20:  20%|██        | 4/20 [00:41<02:44, 10.29s/it]
Task 4, Epoch 5/20 => Loss 0.206, Train_accy 94.08, Test_accy 82.83:  20%|██        | 4/20 [00:58<02:44, 10.29s/it]
Task 4, Epoch 5/20 => Loss 0.206, Train_accy 94.08, Test_accy 82.83:  25%|██▌       | 5/20 [00:58<03:12, 12.83s/it]
Task 4, Epoch 6/20 => Loss 0.152, Train_accy 94.96:  25%|██▌       | 5/20 [01:08<03:12, 12.83s/it]                 
Task 4, Epoch 6/20 => Loss 0.152, Train_accy 94.96:  30%|███       | 6/20 [01:08<02:47, 11.97s/it]
Task 4, Epoch 7/20 => Loss 0.169, Train_accy 95.07:  30%|███       | 6/20 [01:19<02:47, 11.97s/it]
Task 4, Epoch 7/20 => Loss 0.169, Train_accy 95.07:  35%|███▌      | 7/20 [01:19<02:28, 11.41s/it]
Task 4, Epoch 8/20 => Loss 0.181, Train_accy 93.53:  35%|███▌      | 7/20 [01:29<02:28, 11.41s/it]
Task 4, Epoch 8/20 => Loss 0.181, Train_accy 93.53:  40%|████      | 8/20 [01:29<02:12, 11.05s/it]
Task 4, Epoch 9/20 => Loss 0.161, Train_accy 94.96:  40%|████      | 8/20 [01:39<02:12, 11.05s/it]
Task 4, Epoch 9/20 => Loss 0.161, Train_accy 94.96:  45%|████▌     | 9/20 [01:39<01:58, 10.81s/it]
Task 4, Epoch 10/20 => Loss 0.132, Train_accy 96.05, Test_accy 84.09:  45%|████▌     | 9/20 [01:57<01:58, 10.81s/it]
Task 4, Epoch 10/20 => Loss 0.132, Train_accy 96.05, Test_accy 84.09:  50%|█████     | 10/20 [01:57<02:08, 12.85s/it]
Task 4, Epoch 11/20 => Loss 0.158, Train_accy 95.29:  50%|█████     | 10/20 [02:07<02:08, 12.85s/it]                 
Task 4, Epoch 11/20 => Loss 0.158, Train_accy 95.29:  55%|█████▌    | 11/20 [02:07<01:48, 12.06s/it]
Task 4, Epoch 12/20 => Loss 0.141, Train_accy 95.29:  55%|█████▌    | 11/20 [02:17<01:48, 12.06s/it]
Task 4, Epoch 12/20 => Loss 0.141, Train_accy 95.29:  60%|██████    | 12/20 [02:17<01:32, 11.51s/it]
Task 4, Epoch 13/20 => Loss 0.107, Train_accy 96.93:  60%|██████    | 12/20 [02:27<01:32, 11.51s/it]
Task 4, Epoch 13/20 => Loss 0.107, Train_accy 96.93:  65%|██████▌   | 13/20 [02:27<01:17, 11.13s/it]
Task 4, Epoch 14/20 => Loss 0.169, Train_accy 95.07:  65%|██████▌   | 13/20 [02:38<01:17, 11.13s/it]
Task 4, Epoch 14/20 => Loss 0.169, Train_accy 95.07:  70%|███████   | 14/20 [02:38<01:05, 10.87s/it]
Task 4, Epoch 15/20 => Loss 0.122, Train_accy 96.05, Test_accy 83.84:  70%|███████   | 14/20 [02:55<01:05, 10.87s/it]
Task 4, Epoch 15/20 => Loss 0.122, Train_accy 96.05, Test_accy 83.84:  75%|███████▌  | 15/20 [02:55<01:04, 12.80s/it]
Task 4, Epoch 16/20 => Loss 0.100, Train_accy 96.93:  75%|███████▌  | 15/20 [03:05<01:04, 12.80s/it]                 
Task 4, Epoch 16/20 => Loss 0.100, Train_accy 96.93:  80%|████████  | 16/20 [03:05<00:48, 12.05s/it]
Task 4, Epoch 17/20 => Loss 0.104, Train_accy 96.71:  80%|████████  | 16/20 [03:15<00:48, 12.05s/it]
Task 4, Epoch 17/20 => Loss 0.104, Train_accy 96.71:  85%|████████▌ | 17/20 [03:15<00:34, 11.51s/it]
Task 4, Epoch 18/20 => Loss 0.114, Train_accy 97.26:  85%|████████▌ | 17/20 [03:26<00:34, 11.51s/it]
Task 4, Epoch 18/20 => Loss 0.114, Train_accy 97.26:  90%|█████████ | 18/20 [03:26<00:22, 11.15s/it]
Task 4, Epoch 19/20 => Loss 0.120, Train_accy 95.72:  90%|█████████ | 18/20 [03:36<00:22, 11.15s/it]
Task 4, Epoch 19/20 => Loss 0.120, Train_accy 95.72:  95%|█████████▌| 19/20 [03:36<00:10, 10.89s/it]
Task 4, Epoch 20/20 => Loss 0.115, Train_accy 96.05, Test_accy 84.51:  95%|█████████▌| 19/20 [03:53<00:10, 10.89s/it]
Task 4, Epoch 20/20 => Loss 0.115, Train_accy 96.05, Test_accy 84.51: 100%|██████████| 20/20 [03:53<00:00, 12.84s/it]
Task 4, Epoch 20/20 => Loss 0.115, Train_accy 96.05, Test_accy 84.51: 100%|██████████| 20/20 [03:53<00:00, 11.69s/it]
2024-09-06 00:33:16,668 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.115, Train_accy 96.05, Test_accy 84.51
2024-09-06 00:33:23,747 [trainer.py] => No NME accuracy.
2024-09-06 00:33:23,747 [trainer.py] => CNN: {'total': 84.51, '00-19': 92.31, '20-39': 86.96, '40-59': 78.9, '60-79': 87.85, '80-99': 76.95, 'old': 86.72, 'new': 76.95}
2024-09-06 00:33:23,747 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73, 88.03, 84.51]
2024-09-06 00:33:23,747 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.35, 99.16]

Average Accuracy (CNN): 91.08
2024-09-06 00:33:23,748 [trainer.py] => Average Accuracy (CNN): 91.08 

2024-09-06 00:33:23,749 [trainer.py] => All params: 89792456
2024-09-06 00:33:23,750 [trainer.py] => Trainable params: 89792456
2024-09-06 00:33:24,786 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.454, Train_accy 62.06:   0%|          | 0/20 [00:10<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.454, Train_accy 62.06:   5%|▌         | 1/20 [00:10<03:15, 10.30s/it]
Task 5, Epoch 2/20 => Loss 0.205, Train_accy 93.75:   5%|▌         | 1/20 [00:20<03:15, 10.30s/it]
Task 5, Epoch 2/20 => Loss 0.205, Train_accy 93.75:  10%|█         | 2/20 [00:20<03:05, 10.30s/it]
Task 5, Epoch 3/20 => Loss 0.129, Train_accy 96.16:  10%|█         | 2/20 [00:30<03:05, 10.30s/it]
Task 5, Epoch 3/20 => Loss 0.129, Train_accy 96.16:  15%|█▌        | 3/20 [00:30<02:54, 10.29s/it]
Task 5, Epoch 4/20 => Loss 0.163, Train_accy 94.96:  15%|█▌        | 3/20 [00:41<02:54, 10.29s/it]
Task 5, Epoch 4/20 => Loss 0.163, Train_accy 94.96:  20%|██        | 4/20 [00:41<02:44, 10.28s/it]
Task 5, Epoch 5/20 => Loss 0.140, Train_accy 95.50, Test_accy 79.94:  20%|██        | 4/20 [00:59<02:44, 10.28s/it]
Task 5, Epoch 5/20 => Loss 0.140, Train_accy 95.50, Test_accy 79.94:  25%|██▌       | 5/20 [00:59<03:19, 13.29s/it]
Task 5, Epoch 6/20 => Loss 0.165, Train_accy 94.96:  25%|██▌       | 5/20 [01:10<03:19, 13.29s/it]                 
Task 5, Epoch 6/20 => Loss 0.165, Train_accy 94.96:  30%|███       | 6/20 [01:10<02:51, 12.27s/it]
Task 5, Epoch 7/20 => Loss 0.119, Train_accy 96.60:  30%|███       | 6/20 [01:20<02:51, 12.27s/it]
Task 5, Epoch 7/20 => Loss 0.119, Train_accy 96.60:  35%|███▌      | 7/20 [01:20<02:31, 11.63s/it]
Task 5, Epoch 8/20 => Loss 0.121, Train_accy 96.93:  35%|███▌      | 7/20 [01:30<02:31, 11.63s/it]
Task 5, Epoch 8/20 => Loss 0.121, Train_accy 96.93:  40%|████      | 8/20 [01:30<02:14, 11.21s/it]
Task 5, Epoch 9/20 => Loss 0.119, Train_accy 96.71:  40%|████      | 8/20 [01:40<02:14, 11.21s/it]
Task 5, Epoch 9/20 => Loss 0.119, Train_accy 96.71:  45%|████▌     | 9/20 [01:40<02:00, 10.92s/it]
Task 5, Epoch 10/20 => Loss 0.110, Train_accy 96.49, Test_accy 80.79:  45%|████▌     | 9/20 [01:59<02:00, 10.92s/it]
Task 5, Epoch 10/20 => Loss 0.110, Train_accy 96.49, Test_accy 80.79:  50%|█████     | 10/20 [01:59<02:13, 13.32s/it]
Task 5, Epoch 11/20 => Loss 0.103, Train_accy 96.93:  50%|█████     | 10/20 [02:09<02:13, 13.32s/it]                 
Task 5, Epoch 11/20 => Loss 0.103, Train_accy 96.93:  55%|█████▌    | 11/20 [02:09<01:51, 12.39s/it]
Task 5, Epoch 12/20 => Loss 0.137, Train_accy 95.50:  55%|█████▌    | 11/20 [02:20<01:51, 12.39s/it]
Task 5, Epoch 12/20 => Loss 0.137, Train_accy 95.50:  60%|██████    | 12/20 [02:20<01:34, 11.76s/it]
Task 5, Epoch 13/20 => Loss 0.110, Train_accy 96.82:  60%|██████    | 12/20 [02:30<01:34, 11.76s/it]
Task 5, Epoch 13/20 => Loss 0.110, Train_accy 96.82:  65%|██████▌   | 13/20 [02:30<01:19, 11.32s/it]
Task 5, Epoch 14/20 => Loss 0.127, Train_accy 95.61:  65%|██████▌   | 13/20 [02:40<01:19, 11.32s/it]
Task 5, Epoch 14/20 => Loss 0.127, Train_accy 95.61:  70%|███████   | 14/20 [02:40<01:06, 11.01s/it]
Task 5, Epoch 15/20 => Loss 0.107, Train_accy 96.16, Test_accy 81.07:  70%|███████   | 14/20 [02:59<01:06, 11.01s/it]
Task 5, Epoch 15/20 => Loss 0.107, Train_accy 96.16, Test_accy 81.07:  75%|███████▌  | 15/20 [02:59<01:06, 13.30s/it]
Task 5, Epoch 16/20 => Loss 0.084, Train_accy 97.70:  75%|███████▌  | 15/20 [03:09<01:06, 13.30s/it]                 
Task 5, Epoch 16/20 => Loss 0.084, Train_accy 97.70:  80%|████████  | 16/20 [03:09<00:49, 12.42s/it]
Task 5, Epoch 17/20 => Loss 0.094, Train_accy 97.04:  80%|████████  | 16/20 [03:20<00:49, 12.42s/it]
Task 5, Epoch 17/20 => Loss 0.094, Train_accy 97.04:  85%|████████▌ | 17/20 [03:20<00:35, 11.79s/it]
Task 5, Epoch 18/20 => Loss 0.093, Train_accy 97.04:  85%|████████▌ | 17/20 [03:30<00:35, 11.79s/it]
Task 5, Epoch 18/20 => Loss 0.093, Train_accy 97.04:  90%|█████████ | 18/20 [03:30<00:22, 11.35s/it]
Task 5, Epoch 19/20 => Loss 0.088, Train_accy 97.70:  90%|█████████ | 18/20 [03:40<00:22, 11.35s/it]
Task 5, Epoch 19/20 => Loss 0.088, Train_accy 97.70:  95%|█████████▌| 19/20 [03:40<00:11, 11.03s/it]
Task 5, Epoch 20/20 => Loss 0.101, Train_accy 96.93, Test_accy 80.79:  95%|█████████▌| 19/20 [03:59<00:11, 11.03s/it]
Task 5, Epoch 20/20 => Loss 0.101, Train_accy 96.93, Test_accy 80.79: 100%|██████████| 20/20 [03:59<00:00, 13.31s/it]
Task 5, Epoch 20/20 => Loss 0.101, Train_accy 96.93, Test_accy 80.79: 100%|██████████| 20/20 [03:59<00:00, 11.97s/it]
2024-09-06 00:37:24,204 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.101, Train_accy 96.93, Test_accy 80.79
2024-09-06 00:37:32,581 [trainer.py] => No NME accuracy.
2024-09-06 00:37:32,581 [trainer.py] => CNN: {'total': 80.79, '00-19': 91.9, '20-39': 84.06, '40-59': 77.06, '60-79': 86.23, '80-99': 76.21, '100-119': 68.86, 'old': 83.08, 'new': 68.86}
2024-09-06 00:37:32,581 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73, 88.03, 84.51, 80.79]
2024-09-06 00:37:32,581 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.35, 99.16, 98.87]

Average Accuracy (CNN): 89.36
2024-09-06 00:37:32,582 [trainer.py] => Average Accuracy (CNN): 89.36 

2024-09-06 00:37:32,583 [trainer.py] => All params: 89792456
2024-09-06 00:37:32,584 [trainer.py] => Trainable params: 89792456
2024-09-06 00:37:33,819 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.482, Train_accy 57.89:   0%|          | 0/20 [00:10<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.482, Train_accy 57.89:   5%|▌         | 1/20 [00:10<03:15, 10.28s/it]
Task 6, Epoch 2/20 => Loss 0.450, Train_accy 84.54:   5%|▌         | 1/20 [00:20<03:15, 10.28s/it]
Task 6, Epoch 2/20 => Loss 0.450, Train_accy 84.54:  10%|█         | 2/20 [00:20<03:04, 10.27s/it]
Task 6, Epoch 3/20 => Loss 0.364, Train_accy 87.50:  10%|█         | 2/20 [00:30<03:04, 10.27s/it]
Task 6, Epoch 3/20 => Loss 0.364, Train_accy 87.50:  15%|█▌        | 3/20 [00:30<02:54, 10.28s/it]
Task 6, Epoch 4/20 => Loss 0.287, Train_accy 91.45:  15%|█▌        | 3/20 [00:41<02:54, 10.28s/it]
Task 6, Epoch 4/20 => Loss 0.287, Train_accy 91.45:  20%|██        | 4/20 [00:41<02:44, 10.29s/it]
Task 6, Epoch 5/20 => Loss 0.271, Train_accy 91.12, Test_accy 79.52:  20%|██        | 4/20 [01:01<02:44, 10.29s/it]
Task 6, Epoch 5/20 => Loss 0.271, Train_accy 91.12, Test_accy 79.52:  25%|██▌       | 5/20 [01:01<03:26, 13.76s/it]
Task 6, Epoch 6/20 => Loss 0.221, Train_accy 92.87:  25%|██▌       | 5/20 [01:11<03:26, 13.76s/it]                 
Task 6, Epoch 6/20 => Loss 0.221, Train_accy 92.87:  30%|███       | 6/20 [01:11<02:56, 12.59s/it]
Task 6, Epoch 7/20 => Loss 0.188, Train_accy 93.64:  30%|███       | 6/20 [01:21<02:56, 12.59s/it]
Task 6, Epoch 7/20 => Loss 0.188, Train_accy 93.64:  35%|███▌      | 7/20 [01:21<02:33, 11.85s/it]
Task 6, Epoch 8/20 => Loss 0.209, Train_accy 93.09:  35%|███▌      | 7/20 [01:32<02:33, 11.85s/it]
Task 6, Epoch 8/20 => Loss 0.209, Train_accy 93.09:  40%|████      | 8/20 [01:32<02:16, 11.38s/it]
Task 6, Epoch 9/20 => Loss 0.208, Train_accy 92.98:  40%|████      | 8/20 [01:42<02:16, 11.38s/it]
Task 6, Epoch 9/20 => Loss 0.208, Train_accy 92.98:  45%|████▌     | 9/20 [01:42<02:01, 11.04s/it]
Task 6, Epoch 10/20 => Loss 0.178, Train_accy 94.19, Test_accy 79.40:  45%|████▌     | 9/20 [02:02<02:01, 11.04s/it]
Task 6, Epoch 10/20 => Loss 0.178, Train_accy 94.19, Test_accy 79.40:  50%|█████     | 10/20 [02:02<02:17, 13.79s/it]
Task 6, Epoch 11/20 => Loss 0.167, Train_accy 94.96:  50%|█████     | 10/20 [02:12<02:17, 13.79s/it]                 
Task 6, Epoch 11/20 => Loss 0.167, Train_accy 94.96:  55%|█████▌    | 11/20 [02:12<01:54, 12.72s/it]
Task 6, Epoch 12/20 => Loss 0.144, Train_accy 95.61:  55%|█████▌    | 11/20 [02:22<01:54, 12.72s/it]
Task 6, Epoch 12/20 => Loss 0.144, Train_accy 95.61:  60%|██████    | 12/20 [02:22<01:35, 11.98s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 95.83:  60%|██████    | 12/20 [02:33<01:35, 11.98s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 95.83:  65%|██████▌   | 13/20 [02:33<01:20, 11.47s/it]
Task 6, Epoch 14/20 => Loss 0.134, Train_accy 96.05:  65%|██████▌   | 13/20 [02:43<01:20, 11.47s/it]
Task 6, Epoch 14/20 => Loss 0.134, Train_accy 96.05:  70%|███████   | 14/20 [02:43<01:06, 11.12s/it]
Task 6, Epoch 15/20 => Loss 0.153, Train_accy 94.74, Test_accy 80.07:  70%|███████   | 14/20 [03:03<01:06, 11.12s/it]
Task 6, Epoch 15/20 => Loss 0.153, Train_accy 94.74, Test_accy 80.07:  75%|███████▌  | 15/20 [03:03<01:08, 13.77s/it]
Task 6, Epoch 16/20 => Loss 0.152, Train_accy 95.50:  75%|███████▌  | 15/20 [03:13<01:08, 13.77s/it]                 
Task 6, Epoch 16/20 => Loss 0.152, Train_accy 95.50:  80%|████████  | 16/20 [03:13<00:50, 12.72s/it]
Task 6, Epoch 17/20 => Loss 0.158, Train_accy 94.74:  80%|████████  | 16/20 [03:23<00:50, 12.72s/it]
Task 6, Epoch 17/20 => Loss 0.158, Train_accy 94.74:  85%|████████▌ | 17/20 [03:23<00:35, 11.99s/it]
Task 6, Epoch 18/20 => Loss 0.152, Train_accy 96.05:  85%|████████▌ | 17/20 [03:34<00:35, 11.99s/it]
Task 6, Epoch 18/20 => Loss 0.152, Train_accy 96.05:  90%|█████████ | 18/20 [03:34<00:22, 11.49s/it]
Task 6, Epoch 19/20 => Loss 0.121, Train_accy 96.27:  90%|█████████ | 18/20 [03:44<00:22, 11.49s/it]
Task 6, Epoch 19/20 => Loss 0.121, Train_accy 96.27:  95%|█████████▌| 19/20 [03:44<00:11, 11.15s/it]
Task 6, Epoch 20/20 => Loss 0.144, Train_accy 95.50, Test_accy 80.07:  95%|█████████▌| 19/20 [04:04<00:11, 11.15s/it]
Task 6, Epoch 20/20 => Loss 0.144, Train_accy 95.50, Test_accy 80.07: 100%|██████████| 20/20 [04:04<00:00, 13.79s/it]
Task 6, Epoch 20/20 => Loss 0.144, Train_accy 95.50, Test_accy 80.07: 100%|██████████| 20/20 [04:04<00:00, 12.23s/it]
2024-09-06 00:41:38,442 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.144, Train_accy 95.50, Test_accy 80.07
2024-09-06 00:41:48,150 [trainer.py] => No NME accuracy.
2024-09-06 00:41:48,151 [trainer.py] => CNN: {'total': 80.07, '00-19': 91.9, '20-39': 82.13, '40-59': 77.52, '60-79': 85.43, '80-99': 74.72, '100-119': 69.3, '120-139': 79.11, 'old': 80.23, 'new': 79.11}
2024-09-06 00:41:48,151 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73, 88.03, 84.51, 80.79, 80.07]
2024-09-06 00:41:48,151 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.35, 99.16, 98.87, 98.54]

Average Accuracy (CNN): 88.04
2024-09-06 00:41:48,151 [trainer.py] => Average Accuracy (CNN): 88.04 

2024-09-06 00:41:48,153 [trainer.py] => All params: 89792456
2024-09-06 00:41:48,154 [trainer.py] => Trainable params: 89792456
2024-09-06 00:41:49,568 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.535, Train_accy 59.76:   0%|          | 0/20 [00:10<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.535, Train_accy 59.76:   5%|▌         | 1/20 [00:10<03:15, 10.27s/it]
Task 7, Epoch 2/20 => Loss 0.336, Train_accy 89.58:   5%|▌         | 1/20 [00:20<03:15, 10.27s/it]
Task 7, Epoch 2/20 => Loss 0.336, Train_accy 89.58:  10%|█         | 2/20 [00:20<03:05, 10.29s/it]
Task 7, Epoch 3/20 => Loss 0.206, Train_accy 94.19:  10%|█         | 2/20 [00:30<03:05, 10.29s/it]
Task 7, Epoch 3/20 => Loss 0.206, Train_accy 94.19:  15%|█▌        | 3/20 [00:30<02:54, 10.29s/it]
Task 7, Epoch 4/20 => Loss 0.207, Train_accy 94.08:  15%|█▌        | 3/20 [00:41<02:54, 10.29s/it]
Task 7, Epoch 4/20 => Loss 0.207, Train_accy 94.08:  20%|██        | 4/20 [00:41<02:44, 10.30s/it]
Task 7, Epoch 5/20 => Loss 0.242, Train_accy 92.32, Test_accy 78.64:  20%|██        | 4/20 [01:02<02:44, 10.30s/it]
Task 7, Epoch 5/20 => Loss 0.242, Train_accy 92.32, Test_accy 78.64:  25%|██▌       | 5/20 [01:02<03:34, 14.28s/it]
Task 7, Epoch 6/20 => Loss 0.157, Train_accy 94.63:  25%|██▌       | 5/20 [01:12<03:34, 14.28s/it]                 
Task 7, Epoch 6/20 => Loss 0.157, Train_accy 94.63:  30%|███       | 6/20 [01:12<03:01, 12.93s/it]
Task 7, Epoch 7/20 => Loss 0.161, Train_accy 94.96:  30%|███       | 6/20 [01:23<03:01, 12.93s/it]
Task 7, Epoch 7/20 => Loss 0.161, Train_accy 94.96:  35%|███▌      | 7/20 [01:23<02:37, 12.08s/it]
Task 7, Epoch 8/20 => Loss 0.163, Train_accy 94.85:  35%|███▌      | 7/20 [01:33<02:37, 12.08s/it]
Task 7, Epoch 8/20 => Loss 0.163, Train_accy 94.85:  40%|████      | 8/20 [01:33<02:18, 11.53s/it]
Task 7, Epoch 9/20 => Loss 0.185, Train_accy 93.86:  40%|████      | 8/20 [01:43<02:18, 11.53s/it]
Task 7, Epoch 9/20 => Loss 0.185, Train_accy 93.86:  45%|████▌     | 9/20 [01:43<02:02, 11.15s/it]
Task 7, Epoch 10/20 => Loss 0.147, Train_accy 95.07, Test_accy 79.22:  45%|████▌     | 9/20 [02:05<02:02, 11.15s/it]
Task 7, Epoch 10/20 => Loss 0.147, Train_accy 95.07, Test_accy 79.22:  50%|█████     | 10/20 [02:05<02:22, 14.28s/it]
Task 7, Epoch 11/20 => Loss 0.093, Train_accy 97.04:  50%|█████     | 10/20 [02:15<02:22, 14.28s/it]                 
Task 7, Epoch 11/20 => Loss 0.093, Train_accy 97.04:  55%|█████▌    | 11/20 [02:15<01:57, 13.08s/it]
Task 7, Epoch 12/20 => Loss 0.146, Train_accy 95.61:  55%|█████▌    | 11/20 [02:25<01:57, 13.08s/it]
Task 7, Epoch 12/20 => Loss 0.146, Train_accy 95.61:  60%|██████    | 12/20 [02:25<01:37, 12.24s/it]
Task 7, Epoch 13/20 => Loss 0.157, Train_accy 95.50:  60%|██████    | 12/20 [02:36<01:37, 12.24s/it]
Task 7, Epoch 13/20 => Loss 0.157, Train_accy 95.50:  65%|██████▌   | 13/20 [02:36<01:21, 11.65s/it]
Task 7, Epoch 14/20 => Loss 0.137, Train_accy 95.39:  65%|██████▌   | 13/20 [02:46<01:21, 11.65s/it]
Task 7, Epoch 14/20 => Loss 0.137, Train_accy 95.39:  70%|███████   | 14/20 [02:46<01:07, 11.25s/it]
Task 7, Epoch 15/20 => Loss 0.121, Train_accy 95.83, Test_accy 79.27:  70%|███████   | 14/20 [03:07<01:07, 11.25s/it]
Task 7, Epoch 15/20 => Loss 0.121, Train_accy 95.83, Test_accy 79.27:  75%|███████▌  | 15/20 [03:07<01:11, 14.30s/it]
Task 7, Epoch 16/20 => Loss 0.126, Train_accy 95.83:  75%|███████▌  | 15/20 [03:18<01:11, 14.30s/it]                 
Task 7, Epoch 16/20 => Loss 0.126, Train_accy 95.83:  80%|████████  | 16/20 [03:18<00:52, 13.09s/it]
Task 7, Epoch 17/20 => Loss 0.120, Train_accy 96.49:  80%|████████  | 16/20 [03:28<00:52, 13.09s/it]
Task 7, Epoch 17/20 => Loss 0.120, Train_accy 96.49:  85%|████████▌ | 17/20 [03:28<00:36, 12.28s/it]
Task 7, Epoch 18/20 => Loss 0.127, Train_accy 96.27:  85%|████████▌ | 17/20 [03:38<00:36, 12.28s/it]
Task 7, Epoch 18/20 => Loss 0.127, Train_accy 96.27:  90%|█████████ | 18/20 [03:38<00:23, 11.70s/it]
Task 7, Epoch 19/20 => Loss 0.117, Train_accy 96.27:  90%|█████████ | 18/20 [03:49<00:23, 11.70s/it]
Task 7, Epoch 19/20 => Loss 0.117, Train_accy 96.27:  95%|█████████▌| 19/20 [03:49<00:11, 11.28s/it]
Task 7, Epoch 20/20 => Loss 0.123, Train_accy 96.60, Test_accy 79.43:  95%|█████████▌| 19/20 [04:10<00:11, 11.28s/it]
Task 7, Epoch 20/20 => Loss 0.123, Train_accy 96.60, Test_accy 79.43: 100%|██████████| 20/20 [04:10<00:00, 14.28s/it]
Task 7, Epoch 20/20 => Loss 0.123, Train_accy 96.60, Test_accy 79.43: 100%|██████████| 20/20 [04:10<00:00, 12.52s/it]
2024-09-06 00:45:59,947 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.123, Train_accy 96.60, Test_accy 79.43
2024-09-06 00:46:11,025 [trainer.py] => No NME accuracy.
2024-09-06 00:46:11,025 [trainer.py] => CNN: {'total': 79.43, '00-19': 91.09, '20-39': 80.68, '40-59': 75.69, '60-79': 84.62, '80-99': 74.72, '100-119': 68.42, '120-139': 79.11, '140-159': 80.4, 'old': 79.28, 'new': 80.4}
2024-09-06 00:46:11,025 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73, 88.03, 84.51, 80.79, 80.07, 79.43]
2024-09-06 00:46:11,026 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.35, 99.16, 98.87, 98.54, 98.25]

Average Accuracy (CNN): 86.96
2024-09-06 00:46:11,026 [trainer.py] => Average Accuracy (CNN): 86.96 

2024-09-06 00:46:11,027 [trainer.py] => All params: 89792456
2024-09-06 00:46:11,029 [trainer.py] => Trainable params: 89792456
2024-09-06 00:46:12,660 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.547, Train_accy 61.73:   0%|          | 0/20 [00:10<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.547, Train_accy 61.73:   5%|▌         | 1/20 [00:10<03:15, 10.31s/it]
Task 8, Epoch 2/20 => Loss 0.307, Train_accy 90.79:   5%|▌         | 1/20 [00:20<03:15, 10.31s/it]
Task 8, Epoch 2/20 => Loss 0.307, Train_accy 90.79:  10%|█         | 2/20 [00:20<03:05, 10.33s/it]
Task 8, Epoch 3/20 => Loss 0.215, Train_accy 92.76:  10%|█         | 2/20 [00:30<03:05, 10.33s/it]
Task 8, Epoch 3/20 => Loss 0.215, Train_accy 92.76:  15%|█▌        | 3/20 [00:30<02:55, 10.33s/it]
Task 8, Epoch 4/20 => Loss 0.198, Train_accy 94.52:  15%|█▌        | 3/20 [00:41<02:55, 10.33s/it]
Task 8, Epoch 4/20 => Loss 0.198, Train_accy 94.52:  20%|██        | 4/20 [00:41<02:45, 10.33s/it]
Task 8, Epoch 5/20 => Loss 0.151, Train_accy 95.72, Test_accy 76.97:  20%|██        | 4/20 [01:03<02:45, 10.33s/it]
Task 8, Epoch 5/20 => Loss 0.151, Train_accy 95.72, Test_accy 76.97:  25%|██▌       | 5/20 [01:03<03:41, 14.78s/it]
Task 8, Epoch 6/20 => Loss 0.169, Train_accy 95.07:  25%|██▌       | 5/20 [01:14<03:41, 14.78s/it]                 
Task 8, Epoch 6/20 => Loss 0.169, Train_accy 95.07:  30%|███       | 6/20 [01:14<03:05, 13.27s/it]
Task 8, Epoch 7/20 => Loss 0.197, Train_accy 94.74:  30%|███       | 6/20 [01:24<03:05, 13.27s/it]
Task 8, Epoch 7/20 => Loss 0.197, Train_accy 94.74:  35%|███▌      | 7/20 [01:24<02:40, 12.31s/it]
Task 8, Epoch 8/20 => Loss 0.167, Train_accy 94.85:  35%|███▌      | 7/20 [01:34<02:40, 12.31s/it]
Task 8, Epoch 8/20 => Loss 0.167, Train_accy 94.85:  40%|████      | 8/20 [01:34<02:20, 11.68s/it]
Task 8, Epoch 9/20 => Loss 0.195, Train_accy 94.08:  40%|████      | 8/20 [01:45<02:20, 11.68s/it]
Task 8, Epoch 9/20 => Loss 0.195, Train_accy 94.08:  45%|████▌     | 9/20 [01:45<02:03, 11.26s/it]
Task 8, Epoch 10/20 => Loss 0.147, Train_accy 95.83, Test_accy 77.82:  45%|████▌     | 9/20 [02:08<02:03, 11.26s/it]
Task 8, Epoch 10/20 => Loss 0.147, Train_accy 95.83, Test_accy 77.82:  50%|█████     | 10/20 [02:08<02:27, 14.79s/it]
Task 8, Epoch 11/20 => Loss 0.143, Train_accy 95.61:  50%|█████     | 10/20 [02:18<02:27, 14.79s/it]                 
Task 8, Epoch 11/20 => Loss 0.143, Train_accy 95.61:  55%|█████▌    | 11/20 [02:18<02:00, 13.42s/it]
Task 8, Epoch 12/20 => Loss 0.172, Train_accy 95.29:  55%|█████▌    | 11/20 [02:28<02:00, 13.42s/it]
Task 8, Epoch 12/20 => Loss 0.172, Train_accy 95.29:  60%|██████    | 12/20 [02:28<01:39, 12.48s/it]
Task 8, Epoch 13/20 => Loss 0.120, Train_accy 96.27:  60%|██████    | 12/20 [02:38<01:39, 12.48s/it]
Task 8, Epoch 13/20 => Loss 0.120, Train_accy 96.27:  65%|██████▌   | 13/20 [02:38<01:22, 11.82s/it]
Task 8, Epoch 14/20 => Loss 0.211, Train_accy 93.20:  65%|██████▌   | 13/20 [02:49<01:22, 11.82s/it]
Task 8, Epoch 14/20 => Loss 0.211, Train_accy 93.20:  70%|███████   | 14/20 [02:49<01:08, 11.36s/it]
Task 8, Epoch 15/20 => Loss 0.145, Train_accy 94.96, Test_accy 78.24:  70%|███████   | 14/20 [03:11<01:08, 11.36s/it]
Task 8, Epoch 15/20 => Loss 0.145, Train_accy 94.96, Test_accy 78.24:  75%|███████▌  | 15/20 [03:11<01:13, 14.78s/it]
Task 8, Epoch 16/20 => Loss 0.171, Train_accy 94.85:  75%|███████▌  | 15/20 [03:22<01:13, 14.78s/it]                 
Task 8, Epoch 16/20 => Loss 0.171, Train_accy 94.85:  80%|████████  | 16/20 [03:22<00:53, 13.45s/it]
Task 8, Epoch 17/20 => Loss 0.129, Train_accy 95.61:  80%|████████  | 16/20 [03:32<00:53, 13.45s/it]
Task 8, Epoch 17/20 => Loss 0.129, Train_accy 95.61:  85%|████████▌ | 17/20 [03:32<00:37, 12.51s/it]
Task 8, Epoch 18/20 => Loss 0.186, Train_accy 94.96:  85%|████████▌ | 17/20 [03:43<00:37, 12.51s/it]
Task 8, Epoch 18/20 => Loss 0.186, Train_accy 94.96:  90%|█████████ | 18/20 [03:43<00:23, 11.86s/it]
Task 8, Epoch 19/20 => Loss 0.137, Train_accy 96.05:  90%|█████████ | 18/20 [03:53<00:23, 11.86s/it]
Task 8, Epoch 19/20 => Loss 0.137, Train_accy 96.05:  95%|█████████▌| 19/20 [03:53<00:11, 11.40s/it]
Task 8, Epoch 20/20 => Loss 0.122, Train_accy 96.16, Test_accy 78.05:  95%|█████████▌| 19/20 [04:15<00:11, 11.40s/it]
Task 8, Epoch 20/20 => Loss 0.122, Train_accy 96.16, Test_accy 78.05: 100%|██████████| 20/20 [04:16<00:00, 14.78s/it]
Task 8, Epoch 20/20 => Loss 0.122, Train_accy 96.16, Test_accy 78.05: 100%|██████████| 20/20 [04:16<00:00, 12.80s/it]
2024-09-06 00:50:28,671 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.122, Train_accy 96.16, Test_accy 78.05
2024-09-06 00:50:40,971 [trainer.py] => No NME accuracy.
2024-09-06 00:50:40,972 [trainer.py] => CNN: {'total': 78.05, '00-19': 89.47, '20-39': 79.71, '40-59': 73.85, '60-79': 83.81, '80-99': 75.09, '100-119': 67.54, '120-139': 78.22, '140-159': 78.0, '160-179': 75.95, 'old': 78.32, 'new': 75.95}
2024-09-06 00:50:40,972 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73, 88.03, 84.51, 80.79, 80.07, 79.43, 78.05]
2024-09-06 00:50:40,972 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.35, 99.16, 98.87, 98.54, 98.25, 98.12]

Average Accuracy (CNN): 85.97
2024-09-06 00:50:40,972 [trainer.py] => Average Accuracy (CNN): 85.97 

2024-09-06 00:50:40,974 [trainer.py] => All params: 89792456
2024-09-06 00:50:40,975 [trainer.py] => Trainable params: 89792456
2024-09-06 00:50:42,764 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.305, Train_accy 65.68:   0%|          | 0/20 [00:10<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.305, Train_accy 65.68:   5%|▌         | 1/20 [00:10<03:16, 10.36s/it]
Task 9, Epoch 2/20 => Loss 0.282, Train_accy 91.67:   5%|▌         | 1/20 [00:20<03:16, 10.36s/it]
Task 9, Epoch 2/20 => Loss 0.282, Train_accy 91.67:  10%|█         | 2/20 [00:20<03:06, 10.34s/it]
Task 9, Epoch 3/20 => Loss 0.253, Train_accy 92.21:  10%|█         | 2/20 [00:30<03:06, 10.34s/it]
Task 9, Epoch 3/20 => Loss 0.253, Train_accy 92.21:  15%|█▌        | 3/20 [00:30<02:55, 10.32s/it]
Task 9, Epoch 4/20 => Loss 0.185, Train_accy 93.97:  15%|█▌        | 3/20 [00:41<02:55, 10.32s/it]
Task 9, Epoch 4/20 => Loss 0.185, Train_accy 93.97:  20%|██        | 4/20 [00:41<02:45, 10.32s/it]
Task 9, Epoch 5/20 => Loss 0.235, Train_accy 92.87, Test_accy 75.53:  20%|██        | 4/20 [01:05<02:45, 10.32s/it]
Task 9, Epoch 5/20 => Loss 0.235, Train_accy 92.87, Test_accy 75.53:  25%|██▌       | 5/20 [01:05<03:48, 15.21s/it]
Task 9, Epoch 6/20 => Loss 0.183, Train_accy 94.30:  25%|██▌       | 5/20 [01:15<03:48, 15.21s/it]                 
Task 9, Epoch 6/20 => Loss 0.183, Train_accy 94.30:  30%|███       | 6/20 [01:15<03:09, 13.54s/it]
Task 9, Epoch 7/20 => Loss 0.176, Train_accy 94.41:  30%|███       | 6/20 [01:25<03:09, 13.54s/it]
Task 9, Epoch 7/20 => Loss 0.176, Train_accy 94.41:  35%|███▌      | 7/20 [01:25<02:42, 12.48s/it]
Task 9, Epoch 8/20 => Loss 0.159, Train_accy 94.41:  35%|███▌      | 7/20 [01:36<02:42, 12.48s/it]
Task 9, Epoch 8/20 => Loss 0.159, Train_accy 94.41:  40%|████      | 8/20 [01:36<02:21, 11.80s/it]
Task 9, Epoch 9/20 => Loss 0.139, Train_accy 95.94:  40%|████      | 8/20 [01:46<02:21, 11.80s/it]
Task 9, Epoch 9/20 => Loss 0.139, Train_accy 95.94:  45%|████▌     | 9/20 [01:46<02:04, 11.34s/it]
Task 9, Epoch 10/20 => Loss 0.147, Train_accy 95.94, Test_accy 76.12:  45%|████▌     | 9/20 [02:10<02:04, 11.34s/it]
Task 9, Epoch 10/20 => Loss 0.147, Train_accy 95.94, Test_accy 76.12:  50%|█████     | 10/20 [02:10<02:32, 15.26s/it]
Task 9, Epoch 11/20 => Loss 0.154, Train_accy 95.39:  50%|█████     | 10/20 [02:20<02:32, 15.26s/it]                 
Task 9, Epoch 11/20 => Loss 0.154, Train_accy 95.39:  55%|█████▌    | 11/20 [02:20<02:04, 13.78s/it]
Task 9, Epoch 12/20 => Loss 0.140, Train_accy 94.85:  55%|█████▌    | 11/20 [02:31<02:04, 13.78s/it]
Task 9, Epoch 12/20 => Loss 0.140, Train_accy 94.85:  60%|██████    | 12/20 [02:31<01:42, 12.76s/it]
Task 9, Epoch 13/20 => Loss 0.150, Train_accy 95.29:  60%|██████    | 12/20 [02:41<01:42, 12.76s/it]
Task 9, Epoch 13/20 => Loss 0.150, Train_accy 95.29:  65%|██████▌   | 13/20 [02:41<01:24, 12.04s/it]
Task 9, Epoch 14/20 => Loss 0.128, Train_accy 95.83:  65%|██████▌   | 13/20 [02:52<01:24, 12.04s/it]
Task 9, Epoch 14/20 => Loss 0.128, Train_accy 95.83:  70%|███████   | 14/20 [02:52<01:09, 11.53s/it]
Task 9, Epoch 15/20 => Loss 0.141, Train_accy 95.72, Test_accy 76.21:  70%|███████   | 14/20 [03:16<01:09, 11.53s/it]
Task 9, Epoch 15/20 => Loss 0.141, Train_accy 95.72, Test_accy 76.21:  75%|███████▌  | 15/20 [03:16<01:16, 15.29s/it]
Task 9, Epoch 16/20 => Loss 0.121, Train_accy 96.27:  75%|███████▌  | 15/20 [03:26<01:16, 15.29s/it]                 
Task 9, Epoch 16/20 => Loss 0.121, Train_accy 96.27:  80%|████████  | 16/20 [03:26<00:55, 13.80s/it]
Task 9, Epoch 17/20 => Loss 0.126, Train_accy 96.49:  80%|████████  | 16/20 [03:36<00:55, 13.80s/it]
Task 9, Epoch 17/20 => Loss 0.126, Train_accy 96.49:  85%|████████▌ | 17/20 [03:36<00:38, 12.76s/it]
Task 9, Epoch 18/20 => Loss 0.141, Train_accy 95.29:  85%|████████▌ | 17/20 [03:47<00:38, 12.76s/it]
Task 9, Epoch 18/20 => Loss 0.141, Train_accy 95.29:  90%|█████████ | 18/20 [03:47<00:24, 12.02s/it]
Task 9, Epoch 19/20 => Loss 0.115, Train_accy 96.16:  90%|█████████ | 18/20 [03:57<00:24, 12.02s/it]
Task 9, Epoch 19/20 => Loss 0.115, Train_accy 96.16:  95%|█████████▌| 19/20 [03:57<00:11, 11.52s/it]
Task 9, Epoch 20/20 => Loss 0.104, Train_accy 96.82, Test_accy 76.38:  95%|█████████▌| 19/20 [04:21<00:11, 11.52s/it]
Task 9, Epoch 20/20 => Loss 0.104, Train_accy 96.82, Test_accy 76.38: 100%|██████████| 20/20 [04:21<00:00, 15.24s/it]
Task 9, Epoch 20/20 => Loss 0.104, Train_accy 96.82, Test_accy 76.38: 100%|██████████| 20/20 [04:21<00:00, 13.07s/it]
2024-09-06 00:55:04,119 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.104, Train_accy 96.82, Test_accy 76.38
2024-09-06 00:55:17,730 [trainer.py] => No NME accuracy.
2024-09-06 00:55:17,731 [trainer.py] => CNN: {'total': 76.38, '00-19': 89.47, '20-39': 77.78, '40-59': 73.39, '60-79': 83.0, '80-99': 72.12, '100-119': 67.11, '120-139': 76.44, '140-159': 78.4, '160-179': 75.11, '180-199': 70.0, 'old': 77.07, 'new': 70.0}
2024-09-06 00:55:17,731 [trainer.py] => CNN top1 curve: [97.98, 95.15, 89.73, 88.03, 84.51, 80.79, 80.07, 79.43, 78.05, 76.38]
2024-09-06 00:55:17,731 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.35, 99.16, 98.87, 98.54, 98.25, 98.12, 97.58]

Average Accuracy (CNN): 85.01
2024-09-06 00:55:17,731 [trainer.py] => Average Accuracy (CNN): 85.01 

Accuracy Matrix (CNN):
[[97.98 97.57 95.55 92.31 92.31 91.9  91.9  91.09 89.47 89.47]
 [ 0.   92.27 91.3  87.92 86.96 84.06 82.13 80.68 79.71 77.78]
 [ 0.    0.   81.65 81.65 78.9  77.06 77.52 75.69 73.85 73.39]
 [ 0.    0.    0.   89.47 87.85 86.23 85.43 84.62 83.81 83.  ]
 [ 0.    0.    0.    0.   76.95 76.21 74.72 74.72 75.09 72.12]
 [ 0.    0.    0.    0.    0.   68.86 69.3  68.42 67.54 67.11]
 [ 0.    0.    0.    0.    0.    0.   79.11 79.11 78.22 76.44]
 [ 0.    0.    0.    0.    0.    0.    0.   80.4  78.   78.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   75.95 75.11]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   70.  ]]
2024-09-06 00:55:17,733 [trainer.py] => Forgetting (CNN): 5.584444444444445
2024-09-06 00:55:20,318 [trainer.py] => config: ./exps/coda_prompt_cub_B0_Inc20.json
2024-09-06 00:55:20,318 [trainer.py] => prefix:  
2024-09-06 00:55:20,318 [trainer.py] => dataset: cub
2024-09-06 00:55:20,318 [trainer.py] => memory_size: 0
2024-09-06 00:55:20,318 [trainer.py] => memory_per_class: 0
2024-09-06 00:55:20,318 [trainer.py] => fixed_memory: False
2024-09-06 00:55:20,318 [trainer.py] => shuffle: True
2024-09-06 00:55:20,318 [trainer.py] => init_cls: 10
2024-09-06 00:55:20,318 [trainer.py] => increment: 10
2024-09-06 00:55:20,318 [trainer.py] => model_name: coda_prompt
2024-09-06 00:55:20,319 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-06 00:55:20,319 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 00:55:20,319 [trainer.py] => seed: 1993
2024-09-06 00:55:20,319 [trainer.py] => tuned_epoch: 20
2024-09-06 00:55:20,319 [trainer.py] => init_lr: 0.001
2024-09-06 00:55:20,319 [trainer.py] => batch_size: 48
2024-09-06 00:55:20,319 [trainer.py] => weight_decay: 0
2024-09-06 00:55:20,319 [trainer.py] => min_lr: 1e-05
2024-09-06 00:55:20,319 [trainer.py] => optimizer: adam
2024-09-06 00:55:20,319 [trainer.py] => scheduler: cosine
2024-09-06 00:55:20,319 [trainer.py] => reinit_optimizer: True
2024-09-06 00:55:20,319 [trainer.py] => pretrained: True
2024-09-06 00:55:20,319 [trainer.py] => drop: 0.0
2024-09-06 00:55:20,319 [trainer.py] => drop_path: 0.0
2024-09-06 00:55:20,319 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-06 00:55:20,355 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-06 00:55:22,272 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-06 00:55:22,272 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-06 00:55:22,273 [trainer.py] => All params: 89792456
2024-09-06 00:55:22,273 [trainer.py] => Trainable params: 89792456
2024-09-06 00:55:22,273 [coda_prompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.561, Train_accy 51.85:   0%|          | 0/20 [00:05<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.561, Train_accy 51.85:   5%|▌         | 1/20 [00:05<01:42,  5.37s/it]
Task 0, Epoch 2/20 => Loss 0.340, Train_accy 93.75:   5%|▌         | 1/20 [00:10<01:42,  5.37s/it]
Task 0, Epoch 2/20 => Loss 0.340, Train_accy 93.75:  10%|█         | 2/20 [00:10<01:33,  5.20s/it]
Task 0, Epoch 3/20 => Loss 0.225, Train_accy 93.75:  10%|█         | 2/20 [00:15<01:33,  5.20s/it]
Task 0, Epoch 3/20 => Loss 0.225, Train_accy 93.75:  15%|█▌        | 3/20 [00:15<01:27,  5.14s/it]
Task 0, Epoch 4/20 => Loss 0.144, Train_accy 95.37:  15%|█▌        | 3/20 [00:20<01:27,  5.14s/it]
Task 0, Epoch 4/20 => Loss 0.144, Train_accy 95.37:  20%|██        | 4/20 [00:20<01:21,  5.11s/it]
Task 0, Epoch 5/20 => Loss 0.219, Train_accy 93.06, Test_accy 100.00:  20%|██        | 4/20 [00:26<01:21,  5.11s/it]
Task 0, Epoch 5/20 => Loss 0.219, Train_accy 93.06, Test_accy 100.00:  25%|██▌       | 5/20 [00:26<01:22,  5.49s/it]
Task 0, Epoch 6/20 => Loss 0.175, Train_accy 94.68:  25%|██▌       | 5/20 [00:31<01:22,  5.49s/it]                  
Task 0, Epoch 6/20 => Loss 0.175, Train_accy 94.68:  30%|███       | 6/20 [00:31<01:15,  5.36s/it]
Task 0, Epoch 7/20 => Loss 0.184, Train_accy 93.29:  30%|███       | 6/20 [00:36<01:15,  5.36s/it]
Task 0, Epoch 7/20 => Loss 0.184, Train_accy 93.29:  35%|███▌      | 7/20 [00:36<01:08,  5.26s/it]
Task 0, Epoch 8/20 => Loss 0.120, Train_accy 96.06:  35%|███▌      | 7/20 [00:41<01:08,  5.26s/it]
Task 0, Epoch 8/20 => Loss 0.120, Train_accy 96.06:  40%|████      | 8/20 [00:41<01:02,  5.19s/it]
Task 0, Epoch 9/20 => Loss 0.133, Train_accy 96.06:  40%|████      | 8/20 [00:47<01:02,  5.19s/it]
Task 0, Epoch 9/20 => Loss 0.133, Train_accy 96.06:  45%|████▌     | 9/20 [00:47<00:56,  5.15s/it]
Task 0, Epoch 10/20 => Loss 0.121, Train_accy 95.60, Test_accy 100.00:  45%|████▌     | 9/20 [00:53<00:56,  5.15s/it]
Task 0, Epoch 10/20 => Loss 0.121, Train_accy 95.60, Test_accy 100.00:  50%|█████     | 10/20 [00:53<00:54,  5.46s/it]
Task 0, Epoch 11/20 => Loss 0.144, Train_accy 95.14:  50%|█████     | 10/20 [00:58<00:54,  5.46s/it]                  
Task 0, Epoch 11/20 => Loss 0.144, Train_accy 95.14:  55%|█████▌    | 11/20 [00:58<00:48,  5.34s/it]
Task 0, Epoch 12/20 => Loss 0.131, Train_accy 96.06:  55%|█████▌    | 11/20 [01:03<00:48,  5.34s/it]
Task 0, Epoch 12/20 => Loss 0.131, Train_accy 96.06:  60%|██████    | 12/20 [01:03<00:41,  5.24s/it]
Task 0, Epoch 13/20 => Loss 0.129, Train_accy 96.06:  60%|██████    | 12/20 [01:08<00:41,  5.24s/it]
Task 0, Epoch 13/20 => Loss 0.129, Train_accy 96.06:  65%|██████▌   | 13/20 [01:08<00:36,  5.19s/it]
Task 0, Epoch 14/20 => Loss 0.120, Train_accy 95.83:  65%|██████▌   | 13/20 [01:13<00:36,  5.19s/it]
Task 0, Epoch 14/20 => Loss 0.120, Train_accy 95.83:  70%|███████   | 14/20 [01:13<00:30,  5.15s/it]
Task 0, Epoch 15/20 => Loss 0.070, Train_accy 97.92, Test_accy 100.00:  70%|███████   | 14/20 [01:19<00:30,  5.15s/it]
Task 0, Epoch 15/20 => Loss 0.070, Train_accy 97.92, Test_accy 100.00:  75%|███████▌  | 15/20 [01:19<00:27,  5.46s/it]
Task 0, Epoch 16/20 => Loss 0.127, Train_accy 95.83:  75%|███████▌  | 15/20 [01:24<00:27,  5.46s/it]                  
Task 0, Epoch 16/20 => Loss 0.127, Train_accy 95.83:  80%|████████  | 16/20 [01:24<00:21,  5.34s/it]
Task 0, Epoch 17/20 => Loss 0.126, Train_accy 95.37:  80%|████████  | 16/20 [01:29<00:21,  5.34s/it]
Task 0, Epoch 17/20 => Loss 0.126, Train_accy 95.37:  85%|████████▌ | 17/20 [01:29<00:15,  5.25s/it]
Task 0, Epoch 18/20 => Loss 0.089, Train_accy 97.22:  85%|████████▌ | 17/20 [01:34<00:15,  5.25s/it]
Task 0, Epoch 18/20 => Loss 0.089, Train_accy 97.22:  90%|█████████ | 18/20 [01:34<00:10,  5.19s/it]
Task 0, Epoch 19/20 => Loss 0.074, Train_accy 98.38:  90%|█████████ | 18/20 [01:39<00:10,  5.19s/it]
Task 0, Epoch 19/20 => Loss 0.074, Train_accy 98.38:  95%|█████████▌| 19/20 [01:39<00:05,  5.15s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.99, Test_accy 100.00:  95%|█████████▌| 19/20 [01:45<00:05,  5.15s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.99, Test_accy 100.00: 100%|██████████| 20/20 [01:45<00:00,  5.46s/it]
Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.99, Test_accy 100.00: 100%|██████████| 20/20 [01:45<00:00,  5.30s/it]
2024-09-06 00:57:08,735 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.103, Train_accy 96.99, Test_accy 100.00
2024-09-06 00:57:09,854 [trainer.py] => No NME accuracy.
2024-09-06 00:57:09,854 [trainer.py] => CNN: {'total': 100.0, '00-09': 100.0, 'old': 0, 'new': 100.0}
2024-09-06 00:57:09,855 [trainer.py] => CNN top1 curve: [100.0]
2024-09-06 00:57:09,855 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 100.0
2024-09-06 00:57:09,855 [trainer.py] => Average Accuracy (CNN): 100.0 

2024-09-06 00:57:09,856 [trainer.py] => All params: 89792456
2024-09-06 00:57:09,858 [trainer.py] => Trainable params: 89792456
2024-09-06 00:57:09,952 [coda_prompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.483, Train_accy 53.47:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.483, Train_accy 53.47:   5%|▌         | 1/20 [00:05<01:35,  5.03s/it]
Task 1, Epoch 2/20 => Loss 0.461, Train_accy 87.73:   5%|▌         | 1/20 [00:10<01:35,  5.03s/it]
Task 1, Epoch 2/20 => Loss 0.461, Train_accy 87.73:  10%|█         | 2/20 [00:10<01:30,  5.04s/it]
Task 1, Epoch 3/20 => Loss 0.254, Train_accy 93.29:  10%|█         | 2/20 [00:15<01:30,  5.04s/it]
Task 1, Epoch 3/20 => Loss 0.254, Train_accy 93.29:  15%|█▌        | 3/20 [00:15<01:25,  5.05s/it]
Task 1, Epoch 4/20 => Loss 0.153, Train_accy 96.30:  15%|█▌        | 3/20 [00:20<01:25,  5.05s/it]
Task 1, Epoch 4/20 => Loss 0.153, Train_accy 96.30:  20%|██        | 4/20 [00:20<01:20,  5.05s/it]
Task 1, Epoch 5/20 => Loss 0.162, Train_accy 95.60, Test_accy 95.55:  20%|██        | 4/20 [00:27<01:20,  5.05s/it]
Task 1, Epoch 5/20 => Loss 0.162, Train_accy 95.60, Test_accy 95.55:  25%|██▌       | 5/20 [00:27<01:25,  5.72s/it]
Task 1, Epoch 6/20 => Loss 0.126, Train_accy 96.06:  25%|██▌       | 5/20 [00:32<01:25,  5.72s/it]                 
Task 1, Epoch 6/20 => Loss 0.126, Train_accy 96.06:  30%|███       | 6/20 [00:32<01:16,  5.50s/it]
Task 1, Epoch 7/20 => Loss 0.152, Train_accy 96.06:  30%|███       | 6/20 [00:37<01:16,  5.50s/it]
Task 1, Epoch 7/20 => Loss 0.152, Train_accy 96.06:  35%|███▌      | 7/20 [00:37<01:09,  5.36s/it]
Task 1, Epoch 8/20 => Loss 0.136, Train_accy 96.76:  35%|███▌      | 7/20 [00:42<01:09,  5.36s/it]
Task 1, Epoch 8/20 => Loss 0.136, Train_accy 96.76:  40%|████      | 8/20 [00:42<01:03,  5.26s/it]
Task 1, Epoch 9/20 => Loss 0.142, Train_accy 95.60:  40%|████      | 8/20 [00:47<01:03,  5.26s/it]
Task 1, Epoch 9/20 => Loss 0.142, Train_accy 95.60:  45%|████▌     | 9/20 [00:47<00:57,  5.22s/it]
Task 1, Epoch 10/20 => Loss 0.086, Train_accy 97.45, Test_accy 96.76:  45%|████▌     | 9/20 [00:54<00:57,  5.22s/it]
Task 1, Epoch 10/20 => Loss 0.086, Train_accy 97.45, Test_accy 96.76:  50%|█████     | 10/20 [00:54<00:57,  5.73s/it]
Task 1, Epoch 11/20 => Loss 0.116, Train_accy 96.76:  50%|█████     | 10/20 [00:59<00:57,  5.73s/it]                 
Task 1, Epoch 11/20 => Loss 0.116, Train_accy 96.76:  55%|█████▌    | 11/20 [00:59<00:49,  5.52s/it]
Task 1, Epoch 12/20 => Loss 0.101, Train_accy 96.76:  55%|█████▌    | 11/20 [01:04<00:49,  5.52s/it]
Task 1, Epoch 12/20 => Loss 0.101, Train_accy 96.76:  60%|██████    | 12/20 [01:04<00:43,  5.38s/it]
Task 1, Epoch 13/20 => Loss 0.098, Train_accy 98.15:  60%|██████    | 12/20 [01:09<00:43,  5.38s/it]
Task 1, Epoch 13/20 => Loss 0.098, Train_accy 98.15:  65%|██████▌   | 13/20 [01:09<00:36,  5.28s/it]
Task 1, Epoch 14/20 => Loss 0.100, Train_accy 96.53:  65%|██████▌   | 13/20 [01:14<00:36,  5.28s/it]
Task 1, Epoch 14/20 => Loss 0.100, Train_accy 96.53:  70%|███████   | 14/20 [01:14<00:31,  5.21s/it]
Task 1, Epoch 15/20 => Loss 0.057, Train_accy 98.15, Test_accy 96.36:  70%|███████   | 14/20 [01:21<00:31,  5.21s/it]
Task 1, Epoch 15/20 => Loss 0.057, Train_accy 98.15, Test_accy 96.36:  75%|███████▌  | 15/20 [01:21<00:28,  5.71s/it]
Task 1, Epoch 16/20 => Loss 0.118, Train_accy 96.76:  75%|███████▌  | 15/20 [01:26<00:28,  5.71s/it]                 
Task 1, Epoch 16/20 => Loss 0.118, Train_accy 96.76:  80%|████████  | 16/20 [01:26<00:21,  5.50s/it]
Task 1, Epoch 17/20 => Loss 0.081, Train_accy 97.69:  80%|████████  | 16/20 [01:31<00:21,  5.50s/it]
Task 1, Epoch 17/20 => Loss 0.081, Train_accy 97.69:  85%|████████▌ | 17/20 [01:31<00:16,  5.37s/it]
Task 1, Epoch 18/20 => Loss 0.068, Train_accy 98.15:  85%|████████▌ | 17/20 [01:36<00:16,  5.37s/it]
Task 1, Epoch 18/20 => Loss 0.068, Train_accy 98.15:  90%|█████████ | 18/20 [01:36<00:10,  5.30s/it]
Task 1, Epoch 19/20 => Loss 0.105, Train_accy 96.76:  90%|█████████ | 18/20 [01:41<00:10,  5.30s/it]
Task 1, Epoch 19/20 => Loss 0.105, Train_accy 96.76:  95%|█████████▌| 19/20 [01:41<00:05,  5.24s/it]
Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.53, Test_accy 95.95:  95%|█████████▌| 19/20 [01:48<00:05,  5.24s/it]
Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.53, Test_accy 95.95: 100%|██████████| 20/20 [01:48<00:00,  5.73s/it]
Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.53, Test_accy 95.95: 100%|██████████| 20/20 [01:48<00:00,  5.43s/it]
2024-09-06 00:58:58,494 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.53, Test_accy 95.95
2024-09-06 00:59:00,372 [trainer.py] => No NME accuracy.
2024-09-06 00:59:00,372 [trainer.py] => CNN: {'total': 95.95, '00-09': 97.46, '10-19': 94.57, 'old': 97.46, 'new': 94.57}
2024-09-06 00:59:00,373 [trainer.py] => CNN top1 curve: [100.0, 95.95]
2024-09-06 00:59:00,373 [trainer.py] => CNN top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 97.98
2024-09-06 00:59:00,373 [trainer.py] => Average Accuracy (CNN): 97.98 

2024-09-06 00:59:00,375 [trainer.py] => All params: 89792456
2024-09-06 00:59:00,376 [trainer.py] => Trainable params: 89792456
2024-09-06 00:59:00,516 [coda_prompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.261, Train_accy 63.19:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.261, Train_accy 63.19:   5%|▌         | 1/20 [00:05<01:35,  5.02s/it]
Task 2, Epoch 2/20 => Loss 0.196, Train_accy 95.37:   5%|▌         | 1/20 [00:10<01:35,  5.02s/it]
Task 2, Epoch 2/20 => Loss 0.196, Train_accy 95.37:  10%|█         | 2/20 [00:10<01:30,  5.02s/it]
Task 2, Epoch 3/20 => Loss 0.138, Train_accy 95.37:  10%|█         | 2/20 [00:15<01:30,  5.02s/it]
Task 2, Epoch 3/20 => Loss 0.138, Train_accy 95.37:  15%|█▌        | 3/20 [00:15<01:25,  5.02s/it]
Task 2, Epoch 4/20 => Loss 0.120, Train_accy 96.99:  15%|█▌        | 3/20 [00:20<01:25,  5.02s/it]
Task 2, Epoch 4/20 => Loss 0.120, Train_accy 96.99:  20%|██        | 4/20 [00:20<01:20,  5.03s/it]
Task 2, Epoch 5/20 => Loss 0.071, Train_accy 98.15, Test_accy 95.06:  20%|██        | 4/20 [00:27<01:20,  5.03s/it]
Task 2, Epoch 5/20 => Loss 0.071, Train_accy 98.15, Test_accy 95.06:  25%|██▌       | 5/20 [00:27<01:28,  5.89s/it]
Task 2, Epoch 6/20 => Loss 0.073, Train_accy 97.69:  25%|██▌       | 5/20 [00:32<01:28,  5.89s/it]                 
Task 2, Epoch 6/20 => Loss 0.073, Train_accy 97.69:  30%|███       | 6/20 [00:32<01:18,  5.60s/it]
Task 2, Epoch 7/20 => Loss 0.083, Train_accy 97.69:  30%|███       | 6/20 [00:37<01:18,  5.60s/it]
Task 2, Epoch 7/20 => Loss 0.083, Train_accy 97.69:  35%|███▌      | 7/20 [00:37<01:10,  5.42s/it]
Task 2, Epoch 8/20 => Loss 0.061, Train_accy 98.61:  35%|███▌      | 7/20 [00:42<01:10,  5.42s/it]
Task 2, Epoch 8/20 => Loss 0.061, Train_accy 98.61:  40%|████      | 8/20 [00:42<01:03,  5.30s/it]
Task 2, Epoch 9/20 => Loss 0.066, Train_accy 97.69:  40%|████      | 8/20 [00:47<01:03,  5.30s/it]
Task 2, Epoch 9/20 => Loss 0.066, Train_accy 97.69:  45%|████▌     | 9/20 [00:47<00:57,  5.22s/it]
Task 2, Epoch 10/20 => Loss 0.054, Train_accy 98.15, Test_accy 95.35:  45%|████▌     | 9/20 [00:55<00:57,  5.22s/it]
Task 2, Epoch 10/20 => Loss 0.054, Train_accy 98.15, Test_accy 95.35:  50%|█████     | 10/20 [00:55<00:59,  5.90s/it]
Task 2, Epoch 11/20 => Loss 0.107, Train_accy 96.53:  50%|█████     | 10/20 [01:00<00:59,  5.90s/it]                 
Task 2, Epoch 11/20 => Loss 0.107, Train_accy 96.53:  55%|█████▌    | 11/20 [01:00<00:50,  5.64s/it]
Task 2, Epoch 12/20 => Loss 0.075, Train_accy 97.22:  55%|█████▌    | 11/20 [01:05<00:50,  5.64s/it]
Task 2, Epoch 12/20 => Loss 0.075, Train_accy 97.22:  60%|██████    | 12/20 [01:05<00:43,  5.46s/it]
Task 2, Epoch 13/20 => Loss 0.061, Train_accy 97.45:  60%|██████    | 12/20 [01:10<00:43,  5.46s/it]
Task 2, Epoch 13/20 => Loss 0.061, Train_accy 97.45:  65%|██████▌   | 13/20 [01:10<00:37,  5.34s/it]
Task 2, Epoch 14/20 => Loss 0.046, Train_accy 98.61:  65%|██████▌   | 13/20 [01:15<00:37,  5.34s/it]
Task 2, Epoch 14/20 => Loss 0.046, Train_accy 98.61:  70%|███████   | 14/20 [01:15<00:31,  5.26s/it]
Task 2, Epoch 15/20 => Loss 0.069, Train_accy 97.92, Test_accy 95.06:  70%|███████   | 14/20 [01:22<00:31,  5.26s/it]
Task 2, Epoch 15/20 => Loss 0.069, Train_accy 97.92, Test_accy 95.06:  75%|███████▌  | 15/20 [01:22<00:29,  5.93s/it]
Task 2, Epoch 16/20 => Loss 0.066, Train_accy 97.69:  75%|███████▌  | 15/20 [01:27<00:29,  5.93s/it]                 
Task 2, Epoch 16/20 => Loss 0.066, Train_accy 97.69:  80%|████████  | 16/20 [01:27<00:22,  5.66s/it]
Task 2, Epoch 17/20 => Loss 0.066, Train_accy 97.22:  80%|████████  | 16/20 [01:32<00:22,  5.66s/it]
Task 2, Epoch 17/20 => Loss 0.066, Train_accy 97.22:  85%|████████▌ | 17/20 [01:32<00:16,  5.48s/it]
Task 2, Epoch 18/20 => Loss 0.051, Train_accy 98.61:  85%|████████▌ | 17/20 [01:37<00:16,  5.48s/it]
Task 2, Epoch 18/20 => Loss 0.051, Train_accy 98.61:  90%|█████████ | 18/20 [01:37<00:10,  5.35s/it]
Task 2, Epoch 19/20 => Loss 0.034, Train_accy 99.31:  90%|█████████ | 18/20 [01:43<00:10,  5.35s/it]
Task 2, Epoch 19/20 => Loss 0.034, Train_accy 99.31:  95%|█████████▌| 19/20 [01:43<00:05,  5.26s/it]
Task 2, Epoch 20/20 => Loss 0.065, Train_accy 98.38, Test_accy 95.06:  95%|█████████▌| 19/20 [01:50<00:05,  5.26s/it]
Task 2, Epoch 20/20 => Loss 0.065, Train_accy 98.38, Test_accy 95.06: 100%|██████████| 20/20 [01:50<00:00,  5.92s/it]
Task 2, Epoch 20/20 => Loss 0.065, Train_accy 98.38, Test_accy 95.06: 100%|██████████| 20/20 [01:50<00:00,  5.52s/it]
2024-09-06 01:00:50,988 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.065, Train_accy 98.38, Test_accy 95.06
2024-09-06 01:00:53,359 [trainer.py] => No NME accuracy.
2024-09-06 01:00:53,360 [trainer.py] => CNN: {'total': 95.06, '00-09': 96.61, '10-19': 94.57, '20-29': 93.81, 'old': 95.55, 'new': 93.81}
2024-09-06 01:00:53,360 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06]
2024-09-06 01:00:53,360 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0]

Average Accuracy (CNN): 97.0
2024-09-06 01:00:53,361 [trainer.py] => Average Accuracy (CNN): 97.0 

2024-09-06 01:00:53,362 [trainer.py] => All params: 89792456
2024-09-06 01:00:53,364 [trainer.py] => Trainable params: 89792456
2024-09-06 01:00:53,551 [coda_prompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.518, Train_accy 53.94:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.518, Train_accy 53.94:   5%|▌         | 1/20 [00:05<01:36,  5.05s/it]
Task 3, Epoch 2/20 => Loss 0.326, Train_accy 90.74:   5%|▌         | 1/20 [00:10<01:36,  5.05s/it]
Task 3, Epoch 2/20 => Loss 0.326, Train_accy 90.74:  10%|█         | 2/20 [00:10<01:31,  5.06s/it]
Task 3, Epoch 3/20 => Loss 0.206, Train_accy 93.29:  10%|█         | 2/20 [00:15<01:31,  5.06s/it]
Task 3, Epoch 3/20 => Loss 0.206, Train_accy 93.29:  15%|█▌        | 3/20 [00:15<01:25,  5.06s/it]
Task 3, Epoch 4/20 => Loss 0.198, Train_accy 93.98:  15%|█▌        | 3/20 [00:20<01:25,  5.06s/it]
Task 3, Epoch 4/20 => Loss 0.198, Train_accy 93.98:  20%|██        | 4/20 [00:20<01:20,  5.05s/it]
Task 3, Epoch 5/20 => Loss 0.113, Train_accy 95.83, Test_accy 91.85:  20%|██        | 4/20 [00:28<01:20,  5.05s/it]
Task 3, Epoch 5/20 => Loss 0.113, Train_accy 95.83, Test_accy 91.85:  25%|██▌       | 5/20 [00:28<01:31,  6.13s/it]
Task 3, Epoch 6/20 => Loss 0.112, Train_accy 95.37:  25%|██▌       | 5/20 [00:33<01:31,  6.13s/it]                 
Task 3, Epoch 6/20 => Loss 0.112, Train_accy 95.37:  30%|███       | 6/20 [00:33<01:20,  5.76s/it]
Task 3, Epoch 7/20 => Loss 0.124, Train_accy 96.30:  30%|███       | 6/20 [00:38<01:20,  5.76s/it]
Task 3, Epoch 7/20 => Loss 0.124, Train_accy 96.30:  35%|███▌      | 7/20 [00:38<01:11,  5.53s/it]
Task 3, Epoch 8/20 => Loss 0.096, Train_accy 97.22:  35%|███▌      | 7/20 [00:43<01:11,  5.53s/it]
Task 3, Epoch 8/20 => Loss 0.096, Train_accy 97.22:  40%|████      | 8/20 [00:43<01:04,  5.38s/it]
Task 3, Epoch 9/20 => Loss 0.094, Train_accy 97.22:  40%|████      | 8/20 [00:48<01:04,  5.38s/it]
Task 3, Epoch 9/20 => Loss 0.094, Train_accy 97.22:  45%|████▌     | 9/20 [00:48<00:58,  5.31s/it]
Task 3, Epoch 10/20 => Loss 0.102, Train_accy 96.99, Test_accy 92.29:  45%|████▌     | 9/20 [00:56<00:58,  5.31s/it]
Task 3, Epoch 10/20 => Loss 0.102, Train_accy 96.99, Test_accy 92.29:  50%|█████     | 10/20 [00:56<01:01,  6.18s/it]
Task 3, Epoch 11/20 => Loss 0.085, Train_accy 97.92:  50%|█████     | 10/20 [01:01<01:01,  6.18s/it]                 
Task 3, Epoch 11/20 => Loss 0.085, Train_accy 97.92:  55%|█████▌    | 11/20 [01:01<00:52,  5.83s/it]
Task 3, Epoch 12/20 => Loss 0.071, Train_accy 97.92:  55%|█████▌    | 11/20 [01:06<00:52,  5.83s/it]
Task 3, Epoch 12/20 => Loss 0.071, Train_accy 97.92:  60%|██████    | 12/20 [01:06<00:44,  5.61s/it]
Task 3, Epoch 13/20 => Loss 0.091, Train_accy 97.45:  60%|██████    | 12/20 [01:11<00:44,  5.61s/it]
Task 3, Epoch 13/20 => Loss 0.091, Train_accy 97.45:  65%|██████▌   | 13/20 [01:11<00:38,  5.46s/it]
Task 3, Epoch 14/20 => Loss 0.062, Train_accy 97.92:  65%|██████▌   | 13/20 [01:16<00:38,  5.46s/it]
Task 3, Epoch 14/20 => Loss 0.062, Train_accy 97.92:  70%|███████   | 14/20 [01:17<00:32,  5.34s/it]
Task 3, Epoch 15/20 => Loss 0.108, Train_accy 96.53, Test_accy 92.95:  70%|███████   | 14/20 [01:25<00:32,  5.34s/it]
Task 3, Epoch 15/20 => Loss 0.108, Train_accy 96.53, Test_accy 92.95:  75%|███████▌  | 15/20 [01:25<00:30,  6.15s/it]
Task 3, Epoch 16/20 => Loss 0.098, Train_accy 96.30:  75%|███████▌  | 15/20 [01:30<00:30,  6.15s/it]                 
Task 3, Epoch 16/20 => Loss 0.098, Train_accy 96.30:  80%|████████  | 16/20 [01:30<00:23,  5.82s/it]
Task 3, Epoch 17/20 => Loss 0.078, Train_accy 97.92:  80%|████████  | 16/20 [01:35<00:23,  5.82s/it]
Task 3, Epoch 17/20 => Loss 0.078, Train_accy 97.92:  85%|████████▌ | 17/20 [01:35<00:16,  5.59s/it]
Task 3, Epoch 18/20 => Loss 0.085, Train_accy 97.69:  85%|████████▌ | 17/20 [01:40<00:16,  5.59s/it]
Task 3, Epoch 18/20 => Loss 0.085, Train_accy 97.69:  90%|█████████ | 18/20 [01:40<00:10,  5.43s/it]
Task 3, Epoch 19/20 => Loss 0.091, Train_accy 97.22:  90%|█████████ | 18/20 [01:45<00:10,  5.43s/it]
Task 3, Epoch 19/20 => Loss 0.091, Train_accy 97.22:  95%|█████████▌| 19/20 [01:45<00:05,  5.31s/it]
Task 3, Epoch 20/20 => Loss 0.088, Train_accy 96.53, Test_accy 92.07:  95%|█████████▌| 19/20 [01:53<00:05,  5.31s/it]
Task 3, Epoch 20/20 => Loss 0.088, Train_accy 96.53, Test_accy 92.07: 100%|██████████| 20/20 [01:53<00:00,  6.11s/it]
Task 3, Epoch 20/20 => Loss 0.088, Train_accy 96.53, Test_accy 92.07: 100%|██████████| 20/20 [01:53<00:00,  5.66s/it]
2024-09-06 01:02:46,782 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.088, Train_accy 96.53, Test_accy 92.07
2024-09-06 01:02:49,744 [trainer.py] => No NME accuracy.
2024-09-06 01:02:49,744 [trainer.py] => CNN: {'total': 92.07, '00-09': 95.76, '10-19': 93.02, '20-29': 88.66, '30-39': 90.0, 'old': 92.73, 'new': 90.0}
2024-09-06 01:02:49,745 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07]
2024-09-06 01:02:49,745 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0]

Average Accuracy (CNN): 95.77
2024-09-06 01:02:49,745 [trainer.py] => Average Accuracy (CNN): 95.77 

2024-09-06 01:02:49,746 [trainer.py] => All params: 89792456
2024-09-06 01:02:49,748 [trainer.py] => Trainable params: 89792456
2024-09-06 01:02:49,976 [coda_prompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.810, Train_accy 45.37:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.810, Train_accy 45.37:   5%|▌         | 1/20 [00:05<01:36,  5.05s/it]
Task 4, Epoch 2/20 => Loss 0.303, Train_accy 92.36:   5%|▌         | 1/20 [00:10<01:36,  5.05s/it]
Task 4, Epoch 2/20 => Loss 0.303, Train_accy 92.36:  10%|█         | 2/20 [00:10<01:31,  5.06s/it]
Task 4, Epoch 3/20 => Loss 0.157, Train_accy 95.14:  10%|█         | 2/20 [00:15<01:31,  5.06s/it]
Task 4, Epoch 3/20 => Loss 0.157, Train_accy 95.14:  15%|█▌        | 3/20 [00:15<01:26,  5.06s/it]
Task 4, Epoch 4/20 => Loss 0.158, Train_accy 93.98:  15%|█▌        | 3/20 [00:20<01:26,  5.06s/it]
Task 4, Epoch 4/20 => Loss 0.158, Train_accy 93.98:  20%|██        | 4/20 [00:20<01:20,  5.05s/it]
Task 4, Epoch 5/20 => Loss 0.205, Train_accy 93.52, Test_accy 88.77:  20%|██        | 4/20 [00:28<01:20,  5.05s/it]
Task 4, Epoch 5/20 => Loss 0.205, Train_accy 93.52, Test_accy 88.77:  25%|██▌       | 5/20 [00:28<01:35,  6.35s/it]
Task 4, Epoch 6/20 => Loss 0.114, Train_accy 96.30:  25%|██▌       | 5/20 [00:33<01:35,  6.35s/it]                 
Task 4, Epoch 6/20 => Loss 0.114, Train_accy 96.30:  30%|███       | 6/20 [00:33<01:22,  5.90s/it]
Task 4, Epoch 7/20 => Loss 0.160, Train_accy 93.52:  30%|███       | 6/20 [00:38<01:22,  5.90s/it]
Task 4, Epoch 7/20 => Loss 0.160, Train_accy 93.52:  35%|███▌      | 7/20 [00:38<01:13,  5.62s/it]
Task 4, Epoch 8/20 => Loss 0.113, Train_accy 95.83:  35%|███▌      | 7/20 [00:43<01:13,  5.62s/it]
Task 4, Epoch 8/20 => Loss 0.113, Train_accy 95.83:  40%|████      | 8/20 [00:43<01:05,  5.43s/it]
Task 4, Epoch 9/20 => Loss 0.091, Train_accy 96.53:  40%|████      | 8/20 [00:48<01:05,  5.43s/it]
Task 4, Epoch 9/20 => Loss 0.091, Train_accy 96.53:  45%|████▌     | 9/20 [00:48<00:58,  5.30s/it]
Task 4, Epoch 10/20 => Loss 0.071, Train_accy 98.15, Test_accy 89.30:  45%|████▌     | 9/20 [00:57<00:58,  5.30s/it]
Task 4, Epoch 10/20 => Loss 0.071, Train_accy 98.15, Test_accy 89.30:  50%|█████     | 10/20 [00:57<01:03,  6.32s/it]
Task 4, Epoch 11/20 => Loss 0.155, Train_accy 95.37:  50%|█████     | 10/20 [01:02<01:03,  6.32s/it]                 
Task 4, Epoch 11/20 => Loss 0.155, Train_accy 95.37:  55%|█████▌    | 11/20 [01:02<00:53,  5.94s/it]
Task 4, Epoch 12/20 => Loss 0.106, Train_accy 96.76:  55%|█████▌    | 11/20 [01:07<00:53,  5.94s/it]
Task 4, Epoch 12/20 => Loss 0.106, Train_accy 96.76:  60%|██████    | 12/20 [01:07<00:45,  5.67s/it]
Task 4, Epoch 13/20 => Loss 0.116, Train_accy 96.53:  60%|██████    | 12/20 [01:12<00:45,  5.67s/it]
Task 4, Epoch 13/20 => Loss 0.116, Train_accy 96.53:  65%|██████▌   | 13/20 [01:12<00:38,  5.48s/it]
Task 4, Epoch 14/20 => Loss 0.110, Train_accy 96.06:  65%|██████▌   | 13/20 [01:17<00:38,  5.48s/it]
Task 4, Epoch 14/20 => Loss 0.110, Train_accy 96.06:  70%|███████   | 14/20 [01:17<00:32,  5.36s/it]
Task 4, Epoch 15/20 => Loss 0.126, Train_accy 96.06, Test_accy 90.02:  70%|███████   | 14/20 [01:26<00:32,  5.36s/it]
Task 4, Epoch 15/20 => Loss 0.126, Train_accy 96.06, Test_accy 90.02:  75%|███████▌  | 15/20 [01:26<00:31,  6.35s/it]
Task 4, Epoch 16/20 => Loss 0.171, Train_accy 93.98:  75%|███████▌  | 15/20 [01:31<00:31,  6.35s/it]                 
Task 4, Epoch 16/20 => Loss 0.171, Train_accy 93.98:  80%|████████  | 16/20 [01:31<00:23,  5.96s/it]
Task 4, Epoch 17/20 => Loss 0.096, Train_accy 96.53:  80%|████████  | 16/20 [01:36<00:23,  5.96s/it]
Task 4, Epoch 17/20 => Loss 0.096, Train_accy 96.53:  85%|████████▌ | 17/20 [01:36<00:17,  5.68s/it]
Task 4, Epoch 18/20 => Loss 0.100, Train_accy 96.76:  85%|████████▌ | 17/20 [01:41<00:17,  5.68s/it]
Task 4, Epoch 18/20 => Loss 0.100, Train_accy 96.76:  90%|█████████ | 18/20 [01:41<00:10,  5.49s/it]
Task 4, Epoch 19/20 => Loss 0.111, Train_accy 96.99:  90%|█████████ | 18/20 [01:46<00:10,  5.49s/it]
Task 4, Epoch 19/20 => Loss 0.111, Train_accy 96.99:  95%|█████████▌| 19/20 [01:46<00:05,  5.35s/it]
Task 4, Epoch 20/20 => Loss 0.117, Train_accy 95.83, Test_accy 89.84:  95%|█████████▌| 19/20 [01:55<00:05,  5.35s/it]
Task 4, Epoch 20/20 => Loss 0.117, Train_accy 95.83, Test_accy 89.84: 100%|██████████| 20/20 [01:55<00:00,  6.33s/it]
Task 4, Epoch 20/20 => Loss 0.117, Train_accy 95.83, Test_accy 89.84: 100%|██████████| 20/20 [01:55<00:00,  5.76s/it]
2024-09-06 01:04:45,217 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.117, Train_accy 95.83, Test_accy 89.84
2024-09-06 01:04:48,766 [trainer.py] => No NME accuracy.
2024-09-06 01:04:48,767 [trainer.py] => CNN: {'total': 89.84, '00-09': 95.76, '10-19': 93.02, '20-29': 88.66, '30-39': 90.0, '40-49': 80.37, 'old': 92.07, 'new': 80.37}
2024-09-06 01:04:48,767 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84]
2024-09-06 01:04:48,767 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64]

Average Accuracy (CNN): 94.58
2024-09-06 01:04:48,767 [trainer.py] => Average Accuracy (CNN): 94.58 

2024-09-06 01:04:48,768 [trainer.py] => All params: 89792456
2024-09-06 01:04:48,769 [trainer.py] => Trainable params: 89792456
2024-09-06 01:04:49,041 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.608, Train_accy 48.15:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.608, Train_accy 48.15:   5%|▌         | 1/20 [00:05<01:35,  5.04s/it]
Task 5, Epoch 2/20 => Loss 0.361, Train_accy 87.27:   5%|▌         | 1/20 [00:10<01:35,  5.04s/it]
Task 5, Epoch 2/20 => Loss 0.361, Train_accy 87.27:  10%|█         | 2/20 [00:10<01:33,  5.17s/it]
Task 5, Epoch 3/20 => Loss 0.250, Train_accy 91.67:  10%|█         | 2/20 [00:15<01:33,  5.17s/it]
Task 5, Epoch 3/20 => Loss 0.250, Train_accy 91.67:  15%|█▌        | 3/20 [00:15<01:26,  5.12s/it]
Task 5, Epoch 4/20 => Loss 0.215, Train_accy 92.13:  15%|█▌        | 3/20 [00:20<01:26,  5.12s/it]
Task 5, Epoch 4/20 => Loss 0.215, Train_accy 92.13:  20%|██        | 4/20 [00:20<01:21,  5.09s/it]
Task 5, Epoch 5/20 => Loss 0.184, Train_accy 94.44, Test_accy 85.27:  20%|██        | 4/20 [00:29<01:21,  5.09s/it]
Task 5, Epoch 5/20 => Loss 0.184, Train_accy 94.44, Test_accy 85.27:  25%|██▌       | 5/20 [00:29<01:38,  6.59s/it]
Task 5, Epoch 6/20 => Loss 0.171, Train_accy 94.44:  25%|██▌       | 5/20 [00:34<01:38,  6.59s/it]                 
Task 5, Epoch 6/20 => Loss 0.171, Train_accy 94.44:  30%|███       | 6/20 [00:34<01:24,  6.07s/it]
Task 5, Epoch 7/20 => Loss 0.138, Train_accy 95.60:  30%|███       | 6/20 [00:39<01:24,  6.07s/it]
Task 5, Epoch 7/20 => Loss 0.138, Train_accy 95.60:  35%|███▌      | 7/20 [00:39<01:14,  5.75s/it]
Task 5, Epoch 8/20 => Loss 0.098, Train_accy 96.76:  35%|███▌      | 7/20 [00:44<01:14,  5.75s/it]
Task 5, Epoch 8/20 => Loss 0.098, Train_accy 96.76:  40%|████      | 8/20 [00:44<01:06,  5.54s/it]
Task 5, Epoch 9/20 => Loss 0.147, Train_accy 95.83:  40%|████      | 8/20 [00:49<01:06,  5.54s/it]
Task 5, Epoch 9/20 => Loss 0.147, Train_accy 95.83:  45%|████▌     | 9/20 [00:49<00:59,  5.39s/it]
Task 5, Epoch 10/20 => Loss 0.143, Train_accy 95.37, Test_accy 87.05:  45%|████▌     | 9/20 [00:59<00:59,  5.39s/it]
Task 5, Epoch 10/20 => Loss 0.143, Train_accy 95.37, Test_accy 87.05:  50%|█████     | 10/20 [00:59<01:05,  6.57s/it]
Task 5, Epoch 11/20 => Loss 0.121, Train_accy 96.06:  50%|█████     | 10/20 [01:04<01:05,  6.57s/it]                 
Task 5, Epoch 11/20 => Loss 0.121, Train_accy 96.06:  55%|█████▌    | 11/20 [01:04<00:54,  6.10s/it]
Task 5, Epoch 12/20 => Loss 0.095, Train_accy 96.53:  55%|█████▌    | 11/20 [01:09<00:54,  6.10s/it]
Task 5, Epoch 12/20 => Loss 0.095, Train_accy 96.53:  60%|██████    | 12/20 [01:09<00:46,  5.80s/it]
Task 5, Epoch 13/20 => Loss 0.121, Train_accy 96.53:  60%|██████    | 12/20 [01:14<00:46,  5.80s/it]
Task 5, Epoch 13/20 => Loss 0.121, Train_accy 96.53:  65%|██████▌   | 13/20 [01:14<00:39,  5.58s/it]
Task 5, Epoch 14/20 => Loss 0.116, Train_accy 97.45:  65%|██████▌   | 13/20 [01:19<00:39,  5.58s/it]
Task 5, Epoch 14/20 => Loss 0.116, Train_accy 97.45:  70%|███████   | 14/20 [01:19<00:32,  5.42s/it]
Task 5, Epoch 15/20 => Loss 0.116, Train_accy 96.53, Test_accy 87.05:  70%|███████   | 14/20 [01:28<00:32,  5.42s/it]
Task 5, Epoch 15/20 => Loss 0.116, Train_accy 96.53, Test_accy 87.05:  75%|███████▌  | 15/20 [01:28<00:32,  6.58s/it]
Task 5, Epoch 16/20 => Loss 0.076, Train_accy 97.92:  75%|███████▌  | 15/20 [01:33<00:32,  6.58s/it]                 
Task 5, Epoch 16/20 => Loss 0.076, Train_accy 97.92:  80%|████████  | 16/20 [01:33<00:24,  6.12s/it]
Task 5, Epoch 17/20 => Loss 0.096, Train_accy 97.22:  80%|████████  | 16/20 [01:38<00:24,  6.12s/it]
Task 5, Epoch 17/20 => Loss 0.096, Train_accy 97.22:  85%|████████▌ | 17/20 [01:38<00:17,  5.79s/it]
Task 5, Epoch 18/20 => Loss 0.091, Train_accy 97.69:  85%|████████▌ | 17/20 [01:43<00:17,  5.79s/it]
Task 5, Epoch 18/20 => Loss 0.091, Train_accy 97.69:  90%|█████████ | 18/20 [01:43<00:11,  5.56s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 96.06:  90%|█████████ | 18/20 [01:48<00:11,  5.56s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 96.06:  95%|█████████▌| 19/20 [01:48<00:05,  5.41s/it]
Task 5, Epoch 20/20 => Loss 0.120, Train_accy 95.83, Test_accy 87.65:  95%|█████████▌| 19/20 [01:58<00:05,  5.41s/it]
Task 5, Epoch 20/20 => Loss 0.120, Train_accy 95.83, Test_accy 87.65: 100%|██████████| 20/20 [01:58<00:00,  6.55s/it]
Task 5, Epoch 20/20 => Loss 0.120, Train_accy 95.83, Test_accy 87.65: 100%|██████████| 20/20 [01:58<00:00,  5.90s/it]
2024-09-06 01:06:47,131 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.120, Train_accy 95.83, Test_accy 87.65
2024-09-06 01:06:51,340 [trainer.py] => No NME accuracy.
2024-09-06 01:06:51,340 [trainer.py] => CNN: {'total': 87.65, '00-09': 91.53, '10-19': 93.8, '20-29': 88.66, '30-39': 91.82, '40-49': 80.37, '50-59': 78.38, 'old': 89.48, 'new': 78.38}
2024-09-06 01:06:51,341 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65]
2024-09-06 01:06:51,341 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11]

Average Accuracy (CNN): 93.43
2024-09-06 01:06:51,341 [trainer.py] => Average Accuracy (CNN): 93.43 

2024-09-06 01:06:51,342 [trainer.py] => All params: 89792456
2024-09-06 01:06:51,343 [trainer.py] => Trainable params: 89792456
2024-09-06 01:06:51,662 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.439, Train_accy 58.54:   0%|          | 0/20 [00:05<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.439, Train_accy 58.54:   5%|▌         | 1/20 [00:05<01:45,  5.56s/it]
Task 6, Epoch 2/20 => Loss 0.257, Train_accy 91.46:   5%|▌         | 1/20 [00:11<01:45,  5.56s/it]
Task 6, Epoch 2/20 => Loss 0.257, Train_accy 91.46:  10%|█         | 2/20 [00:11<01:39,  5.54s/it]
Task 6, Epoch 3/20 => Loss 0.171, Train_accy 95.21:  10%|█         | 2/20 [00:16<01:39,  5.54s/it]
Task 6, Epoch 3/20 => Loss 0.171, Train_accy 95.21:  15%|█▌        | 3/20 [00:16<01:34,  5.55s/it]
Task 6, Epoch 4/20 => Loss 0.150, Train_accy 95.83:  15%|█▌        | 3/20 [00:22<01:34,  5.55s/it]
Task 6, Epoch 4/20 => Loss 0.150, Train_accy 95.83:  20%|██        | 4/20 [00:22<01:28,  5.56s/it]
Task 6, Epoch 5/20 => Loss 0.158, Train_accy 94.58, Test_accy 83.29:  20%|██        | 4/20 [00:32<01:28,  5.56s/it]
Task 6, Epoch 5/20 => Loss 0.158, Train_accy 94.58, Test_accy 83.29:  25%|██▌       | 5/20 [00:32<01:49,  7.28s/it]
Task 6, Epoch 6/20 => Loss 0.181, Train_accy 93.75:  25%|██▌       | 5/20 [00:38<01:49,  7.28s/it]                 
Task 6, Epoch 6/20 => Loss 0.181, Train_accy 93.75:  30%|███       | 6/20 [00:38<01:33,  6.69s/it]
Task 6, Epoch 7/20 => Loss 0.129, Train_accy 95.42:  30%|███       | 6/20 [00:43<01:33,  6.69s/it]
Task 6, Epoch 7/20 => Loss 0.129, Train_accy 95.42:  35%|███▌      | 7/20 [00:43<01:22,  6.32s/it]
Task 6, Epoch 8/20 => Loss 0.125, Train_accy 94.79:  35%|███▌      | 7/20 [00:49<01:22,  6.32s/it]
Task 6, Epoch 8/20 => Loss 0.125, Train_accy 94.79:  40%|████      | 8/20 [00:49<01:12,  6.08s/it]
Task 6, Epoch 9/20 => Loss 0.123, Train_accy 95.83:  40%|████      | 8/20 [00:54<01:12,  6.08s/it]
Task 6, Epoch 9/20 => Loss 0.123, Train_accy 95.83:  45%|████▌     | 9/20 [00:54<01:05,  5.92s/it]
Task 6, Epoch 10/20 => Loss 0.137, Train_accy 96.46, Test_accy 84.19:  45%|████▌     | 9/20 [01:05<01:05,  5.92s/it]
Task 6, Epoch 10/20 => Loss 0.137, Train_accy 96.46, Test_accy 84.19:  50%|█████     | 10/20 [01:05<01:12,  7.28s/it]
Task 6, Epoch 11/20 => Loss 0.080, Train_accy 97.50:  50%|█████     | 10/20 [01:10<01:12,  7.28s/it]                 
Task 6, Epoch 11/20 => Loss 0.080, Train_accy 97.50:  55%|█████▌    | 11/20 [01:10<01:00,  6.75s/it]
Task 6, Epoch 12/20 => Loss 0.092, Train_accy 96.46:  55%|█████▌    | 11/20 [01:16<01:00,  6.75s/it]
Task 6, Epoch 12/20 => Loss 0.092, Train_accy 96.46:  60%|██████    | 12/20 [01:16<00:51,  6.39s/it]
Task 6, Epoch 13/20 => Loss 0.079, Train_accy 96.88:  60%|██████    | 12/20 [01:21<00:51,  6.39s/it]
Task 6, Epoch 13/20 => Loss 0.079, Train_accy 96.88:  65%|██████▌   | 13/20 [01:21<00:43,  6.17s/it]
Task 6, Epoch 14/20 => Loss 0.083, Train_accy 97.71:  65%|██████▌   | 13/20 [01:27<00:43,  6.17s/it]
Task 6, Epoch 14/20 => Loss 0.083, Train_accy 97.71:  70%|███████   | 14/20 [01:27<00:35,  5.99s/it]
Task 6, Epoch 15/20 => Loss 0.088, Train_accy 97.71, Test_accy 84.58:  70%|███████   | 14/20 [01:37<00:35,  5.99s/it]
Task 6, Epoch 15/20 => Loss 0.088, Train_accy 97.71, Test_accy 84.58:  75%|███████▌  | 15/20 [01:37<00:36,  7.33s/it]
Task 6, Epoch 16/20 => Loss 0.105, Train_accy 96.67:  75%|███████▌  | 15/20 [01:43<00:36,  7.33s/it]                 
Task 6, Epoch 16/20 => Loss 0.105, Train_accy 96.67:  80%|████████  | 16/20 [01:43<00:27,  6.80s/it]
Task 6, Epoch 17/20 => Loss 0.092, Train_accy 96.88:  80%|████████  | 16/20 [01:49<00:27,  6.80s/it]
Task 6, Epoch 17/20 => Loss 0.092, Train_accy 96.88:  85%|████████▌ | 17/20 [01:49<00:19,  6.44s/it]
Task 6, Epoch 18/20 => Loss 0.119, Train_accy 96.46:  85%|████████▌ | 17/20 [01:54<00:19,  6.44s/it]
Task 6, Epoch 18/20 => Loss 0.119, Train_accy 96.46:  90%|█████████ | 18/20 [01:54<00:12,  6.18s/it]
Task 6, Epoch 19/20 => Loss 0.108, Train_accy 97.08:  90%|█████████ | 18/20 [02:00<00:12,  6.18s/it]
Task 6, Epoch 19/20 => Loss 0.108, Train_accy 97.08:  95%|█████████▌| 19/20 [02:00<00:06,  6.02s/it]
Task 6, Epoch 20/20 => Loss 0.098, Train_accy 96.88, Test_accy 84.58:  95%|█████████▌| 19/20 [02:10<00:06,  6.02s/it]
Task 6, Epoch 20/20 => Loss 0.098, Train_accy 96.88, Test_accy 84.58: 100%|██████████| 20/20 [02:10<00:00,  7.34s/it]
Task 6, Epoch 20/20 => Loss 0.098, Train_accy 96.88, Test_accy 84.58: 100%|██████████| 20/20 [02:10<00:00,  6.54s/it]
2024-09-06 01:09:02,405 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.098, Train_accy 96.88, Test_accy 84.58
2024-09-06 01:09:07,170 [trainer.py] => No NME accuracy.
2024-09-06 01:09:07,170 [trainer.py] => CNN: {'total': 84.58, '00-09': 89.83, '10-19': 88.37, '20-29': 88.66, '30-39': 89.09, '40-49': 75.7, '50-59': 76.58, '60-69': 83.02, 'old': 84.82, 'new': 83.02}
2024-09-06 01:09:07,170 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58]
2024-09-06 01:09:07,170 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97]

Average Accuracy (CNN): 92.16
2024-09-06 01:09:07,171 [trainer.py] => Average Accuracy (CNN): 92.16 

2024-09-06 01:09:07,172 [trainer.py] => All params: 89792456
2024-09-06 01:09:07,173 [trainer.py] => Trainable params: 89792456
2024-09-06 01:09:07,554 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.332, Train_accy 60.88:   0%|          | 0/20 [00:05<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.332, Train_accy 60.88:   5%|▌         | 1/20 [00:05<01:35,  5.02s/it]
Task 7, Epoch 2/20 => Loss 0.218, Train_accy 93.29:   5%|▌         | 1/20 [00:10<01:35,  5.02s/it]
Task 7, Epoch 2/20 => Loss 0.218, Train_accy 93.29:  10%|█         | 2/20 [00:10<01:30,  5.04s/it]
Task 7, Epoch 3/20 => Loss 0.133, Train_accy 95.83:  10%|█         | 2/20 [00:15<01:30,  5.04s/it]
Task 7, Epoch 3/20 => Loss 0.133, Train_accy 95.83:  15%|█▌        | 3/20 [00:15<01:25,  5.01s/it]
Task 7, Epoch 4/20 => Loss 0.134, Train_accy 95.83:  15%|█▌        | 3/20 [00:20<01:25,  5.01s/it]
Task 7, Epoch 4/20 => Loss 0.134, Train_accy 95.83:  20%|██        | 4/20 [00:20<01:20,  5.02s/it]
Task 7, Epoch 5/20 => Loss 0.121, Train_accy 96.06, Test_accy 85.31:  20%|██        | 4/20 [00:30<01:20,  5.02s/it]
Task 7, Epoch 5/20 => Loss 0.121, Train_accy 96.06, Test_accy 85.31:  25%|██▌       | 5/20 [00:30<01:45,  7.05s/it]
Task 7, Epoch 6/20 => Loss 0.107, Train_accy 95.83:  25%|██▌       | 5/20 [00:35<01:45,  7.05s/it]                 
Task 7, Epoch 6/20 => Loss 0.107, Train_accy 95.83:  30%|███       | 6/20 [00:35<01:29,  6.37s/it]
Task 7, Epoch 7/20 => Loss 0.087, Train_accy 97.22:  30%|███       | 6/20 [00:40<01:29,  6.37s/it]
Task 7, Epoch 7/20 => Loss 0.087, Train_accy 97.22:  35%|███▌      | 7/20 [00:40<01:16,  5.92s/it]
Task 7, Epoch 8/20 => Loss 0.078, Train_accy 97.45:  35%|███▌      | 7/20 [00:45<01:16,  5.92s/it]
Task 7, Epoch 8/20 => Loss 0.078, Train_accy 97.45:  40%|████      | 8/20 [00:45<01:07,  5.65s/it]
Task 7, Epoch 9/20 => Loss 0.084, Train_accy 97.45:  40%|████      | 8/20 [00:50<01:07,  5.65s/it]
Task 7, Epoch 9/20 => Loss 0.084, Train_accy 97.45:  45%|████▌     | 9/20 [00:50<01:00,  5.48s/it]
Task 7, Epoch 10/20 => Loss 0.096, Train_accy 96.53, Test_accy 85.09:  45%|████▌     | 9/20 [01:01<01:00,  5.48s/it]
Task 7, Epoch 10/20 => Loss 0.096, Train_accy 96.53, Test_accy 85.09:  50%|█████     | 10/20 [01:01<01:10,  7.08s/it]
Task 7, Epoch 11/20 => Loss 0.077, Train_accy 97.92:  50%|█████     | 10/20 [01:06<01:10,  7.08s/it]                 
Task 7, Epoch 11/20 => Loss 0.077, Train_accy 97.92:  55%|█████▌    | 11/20 [01:06<00:58,  6.46s/it]
Task 7, Epoch 12/20 => Loss 0.092, Train_accy 97.22:  55%|█████▌    | 11/20 [01:11<00:58,  6.46s/it]
Task 7, Epoch 12/20 => Loss 0.092, Train_accy 97.22:  60%|██████    | 12/20 [01:11<00:48,  6.04s/it]
Task 7, Epoch 13/20 => Loss 0.068, Train_accy 98.15:  60%|██████    | 12/20 [01:16<00:48,  6.04s/it]
Task 7, Epoch 13/20 => Loss 0.068, Train_accy 98.15:  65%|██████▌   | 13/20 [01:16<00:40,  5.74s/it]
Task 7, Epoch 14/20 => Loss 0.064, Train_accy 97.92:  65%|██████▌   | 13/20 [01:21<00:40,  5.74s/it]
Task 7, Epoch 14/20 => Loss 0.064, Train_accy 97.92:  70%|███████   | 14/20 [01:21<00:33,  5.53s/it]
Task 7, Epoch 15/20 => Loss 0.100, Train_accy 95.60, Test_accy 84.87:  70%|███████   | 14/20 [01:32<00:33,  5.53s/it]
Task 7, Epoch 15/20 => Loss 0.100, Train_accy 95.60, Test_accy 84.87:  75%|███████▌  | 15/20 [01:32<00:35,  7.06s/it]
Task 7, Epoch 16/20 => Loss 0.073, Train_accy 96.99:  75%|███████▌  | 15/20 [01:37<00:35,  7.06s/it]                 
Task 7, Epoch 16/20 => Loss 0.073, Train_accy 96.99:  80%|████████  | 16/20 [01:37<00:25,  6.46s/it]
Task 7, Epoch 17/20 => Loss 0.046, Train_accy 98.84:  80%|████████  | 16/20 [01:42<00:25,  6.46s/it]
Task 7, Epoch 17/20 => Loss 0.046, Train_accy 98.84:  85%|████████▌ | 17/20 [01:42<00:18,  6.04s/it]
Task 7, Epoch 18/20 => Loss 0.080, Train_accy 97.45:  85%|████████▌ | 17/20 [01:47<00:18,  6.04s/it]
Task 7, Epoch 18/20 => Loss 0.080, Train_accy 97.45:  90%|█████████ | 18/20 [01:47<00:11,  5.75s/it]
Task 7, Epoch 19/20 => Loss 0.071, Train_accy 97.45:  90%|█████████ | 18/20 [01:52<00:11,  5.75s/it]
Task 7, Epoch 19/20 => Loss 0.071, Train_accy 97.45:  95%|█████████▌| 19/20 [01:52<00:05,  5.56s/it]
Task 7, Epoch 20/20 => Loss 0.070, Train_accy 97.69, Test_accy 85.20:  95%|█████████▌| 19/20 [02:03<00:05,  5.56s/it]
Task 7, Epoch 20/20 => Loss 0.070, Train_accy 97.69, Test_accy 85.20: 100%|██████████| 20/20 [02:03<00:00,  7.07s/it]
Task 7, Epoch 20/20 => Loss 0.070, Train_accy 97.69, Test_accy 85.20: 100%|██████████| 20/20 [02:03<00:00,  6.17s/it]
2024-09-06 01:11:10,945 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.070, Train_accy 97.69, Test_accy 85.20
2024-09-06 01:11:16,503 [trainer.py] => No NME accuracy.
2024-09-06 01:11:16,503 [trainer.py] => CNN: {'total': 85.2, '00-09': 88.98, '10-19': 85.27, '20-29': 88.66, '30-39': 87.27, '40-49': 75.7, '50-59': 76.58, '60-69': 82.08, '70-79': 94.33, 'old': 83.55, 'new': 94.33}
2024-09-06 01:11:16,504 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2]
2024-09-06 01:11:16,504 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8]

Average Accuracy (CNN): 91.29
2024-09-06 01:11:16,504 [trainer.py] => Average Accuracy (CNN): 91.29 

2024-09-06 01:11:16,505 [trainer.py] => All params: 89792456
2024-09-06 01:11:16,506 [trainer.py] => Trainable params: 89792456
2024-09-06 01:11:16,922 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.405, Train_accy 58.56:   0%|          | 0/20 [00:05<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.405, Train_accy 58.56:   5%|▌         | 1/20 [00:05<01:36,  5.05s/it]
Task 8, Epoch 2/20 => Loss 0.265, Train_accy 92.13:   5%|▌         | 1/20 [00:10<01:36,  5.05s/it]
Task 8, Epoch 2/20 => Loss 0.265, Train_accy 92.13:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 8, Epoch 3/20 => Loss 0.145, Train_accy 95.83:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 8, Epoch 3/20 => Loss 0.145, Train_accy 95.83:  15%|█▌        | 3/20 [00:15<01:26,  5.07s/it]
Task 8, Epoch 4/20 => Loss 0.163, Train_accy 95.37:  15%|█▌        | 3/20 [00:20<01:26,  5.07s/it]
Task 8, Epoch 4/20 => Loss 0.163, Train_accy 95.37:  20%|██        | 4/20 [00:20<01:21,  5.07s/it]
Task 8, Epoch 5/20 => Loss 0.156, Train_accy 94.68, Test_accy 83.75:  20%|██        | 4/20 [00:31<01:21,  5.07s/it]
Task 8, Epoch 5/20 => Loss 0.156, Train_accy 94.68, Test_accy 83.75:  25%|██▌       | 5/20 [00:31<01:50,  7.34s/it]
Task 8, Epoch 6/20 => Loss 0.209, Train_accy 93.52:  25%|██▌       | 5/20 [00:36<01:50,  7.34s/it]                 
Task 8, Epoch 6/20 => Loss 0.209, Train_accy 93.52:  30%|███       | 6/20 [00:36<01:31,  6.57s/it]
Task 8, Epoch 7/20 => Loss 0.108, Train_accy 96.53:  30%|███       | 6/20 [00:41<01:31,  6.57s/it]
Task 8, Epoch 7/20 => Loss 0.108, Train_accy 96.53:  35%|███▌      | 7/20 [00:41<01:18,  6.07s/it]
Task 8, Epoch 8/20 => Loss 0.143, Train_accy 95.60:  35%|███▌      | 7/20 [00:46<01:18,  6.07s/it]
Task 8, Epoch 8/20 => Loss 0.143, Train_accy 95.60:  40%|████      | 8/20 [00:46<01:09,  5.76s/it]
Task 8, Epoch 9/20 => Loss 0.107, Train_accy 96.30:  40%|████      | 8/20 [00:51<01:09,  5.76s/it]
Task 8, Epoch 9/20 => Loss 0.107, Train_accy 96.30:  45%|████▌     | 9/20 [00:51<01:01,  5.55s/it]
Task 8, Epoch 10/20 => Loss 0.140, Train_accy 94.68, Test_accy 84.22:  45%|████▌     | 9/20 [01:03<01:01,  5.55s/it]
Task 8, Epoch 10/20 => Loss 0.140, Train_accy 94.68, Test_accy 84.22:  50%|█████     | 10/20 [01:03<01:13,  7.37s/it]
Task 8, Epoch 11/20 => Loss 0.120, Train_accy 96.30:  50%|█████     | 10/20 [01:08<01:13,  7.37s/it]                 
Task 8, Epoch 11/20 => Loss 0.120, Train_accy 96.30:  55%|█████▌    | 11/20 [01:08<01:00,  6.68s/it]
Task 8, Epoch 12/20 => Loss 0.122, Train_accy 96.53:  55%|█████▌    | 11/20 [01:13<01:00,  6.68s/it]
Task 8, Epoch 12/20 => Loss 0.122, Train_accy 96.53:  60%|██████    | 12/20 [01:13<00:49,  6.20s/it]
Task 8, Epoch 13/20 => Loss 0.109, Train_accy 96.30:  60%|██████    | 12/20 [01:18<00:49,  6.20s/it]
Task 8, Epoch 13/20 => Loss 0.109, Train_accy 96.30:  65%|██████▌   | 13/20 [01:18<00:41,  5.87s/it]
Task 8, Epoch 14/20 => Loss 0.125, Train_accy 95.14:  65%|██████▌   | 13/20 [01:23<00:41,  5.87s/it]
Task 8, Epoch 14/20 => Loss 0.125, Train_accy 95.14:  70%|███████   | 14/20 [01:23<00:33,  5.60s/it]
Task 8, Epoch 15/20 => Loss 0.125, Train_accy 95.60, Test_accy 84.51:  70%|███████   | 14/20 [01:35<00:33,  5.60s/it]
Task 8, Epoch 15/20 => Loss 0.125, Train_accy 95.60, Test_accy 84.51:  75%|███████▌  | 15/20 [01:35<00:36,  7.34s/it]
Task 8, Epoch 16/20 => Loss 0.083, Train_accy 97.22:  75%|███████▌  | 15/20 [01:40<00:36,  7.34s/it]                 
Task 8, Epoch 16/20 => Loss 0.083, Train_accy 97.22:  80%|████████  | 16/20 [01:40<00:26,  6.68s/it]
Task 8, Epoch 17/20 => Loss 0.111, Train_accy 95.60:  80%|████████  | 16/20 [01:45<00:26,  6.68s/it]
Task 8, Epoch 17/20 => Loss 0.111, Train_accy 95.60:  85%|████████▌ | 17/20 [01:45<00:18,  6.19s/it]
Task 8, Epoch 18/20 => Loss 0.101, Train_accy 96.06:  85%|████████▌ | 17/20 [01:50<00:18,  6.19s/it]
Task 8, Epoch 18/20 => Loss 0.101, Train_accy 96.06:  90%|█████████ | 18/20 [01:50<00:11,  5.85s/it]
Task 8, Epoch 19/20 => Loss 0.109, Train_accy 95.60:  90%|█████████ | 18/20 [01:55<00:11,  5.85s/it]
Task 8, Epoch 19/20 => Loss 0.109, Train_accy 95.60:  95%|█████████▌| 19/20 [01:55<00:05,  5.61s/it]
Task 8, Epoch 20/20 => Loss 0.099, Train_accy 96.53, Test_accy 84.51:  95%|█████████▌| 19/20 [02:06<00:05,  5.61s/it]
Task 8, Epoch 20/20 => Loss 0.099, Train_accy 96.53, Test_accy 84.51: 100%|██████████| 20/20 [02:06<00:00,  7.34s/it]
Task 8, Epoch 20/20 => Loss 0.099, Train_accy 96.53, Test_accy 84.51: 100%|██████████| 20/20 [02:06<00:00,  6.34s/it]
2024-09-06 01:13:23,646 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.099, Train_accy 96.53, Test_accy 84.51
2024-09-06 01:13:29,949 [trainer.py] => No NME accuracy.
2024-09-06 01:13:29,950 [trainer.py] => CNN: {'total': 84.51, '00-09': 88.98, '10-19': 84.5, '20-29': 88.66, '30-39': 88.18, '40-49': 74.77, '50-59': 73.87, '60-69': 83.02, '70-79': 93.62, '80-89': 82.71, 'old': 84.77, 'new': 82.71}
2024-09-06 01:13:29,950 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51]
2024-09-06 01:13:29,950 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67]

Average Accuracy (CNN): 90.54
2024-09-06 01:13:29,950 [trainer.py] => Average Accuracy (CNN): 90.54 

2024-09-06 01:13:29,951 [trainer.py] => All params: 89792456
2024-09-06 01:13:29,952 [trainer.py] => Trainable params: 89792456
2024-09-06 01:13:30,420 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.715, Train_accy 46.06:   0%|          | 0/20 [00:05<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.715, Train_accy 46.06:   5%|▌         | 1/20 [00:05<01:36,  5.06s/it]
Task 9, Epoch 2/20 => Loss 0.406, Train_accy 85.65:   5%|▌         | 1/20 [00:10<01:36,  5.06s/it]
Task 9, Epoch 2/20 => Loss 0.406, Train_accy 85.65:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 9, Epoch 3/20 => Loss 0.203, Train_accy 92.36:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 9, Epoch 3/20 => Loss 0.203, Train_accy 92.36:  15%|█▌        | 3/20 [00:15<01:26,  5.08s/it]
Task 9, Epoch 4/20 => Loss 0.198, Train_accy 92.36:  15%|█▌        | 3/20 [00:20<01:26,  5.08s/it]
Task 9, Epoch 4/20 => Loss 0.198, Train_accy 92.36:  20%|██        | 4/20 [00:20<01:21,  5.07s/it]
Task 9, Epoch 5/20 => Loss 0.143, Train_accy 93.98, Test_accy 80.72:  20%|██        | 4/20 [00:32<01:21,  5.07s/it]
Task 9, Epoch 5/20 => Loss 0.143, Train_accy 93.98, Test_accy 80.72:  25%|██▌       | 5/20 [00:32<01:54,  7.61s/it]
Task 9, Epoch 6/20 => Loss 0.134, Train_accy 93.98:  25%|██▌       | 5/20 [00:37<01:54,  7.61s/it]                 
Task 9, Epoch 6/20 => Loss 0.134, Train_accy 93.98:  30%|███       | 6/20 [00:37<01:34,  6.75s/it]
Task 9, Epoch 7/20 => Loss 0.170, Train_accy 93.98:  30%|███       | 6/20 [00:42<01:34,  6.75s/it]
Task 9, Epoch 7/20 => Loss 0.170, Train_accy 93.98:  35%|███▌      | 7/20 [00:42<01:20,  6.20s/it]
Task 9, Epoch 8/20 => Loss 0.153, Train_accy 93.75:  35%|███▌      | 7/20 [00:47<01:20,  6.20s/it]
Task 9, Epoch 8/20 => Loss 0.153, Train_accy 93.75:  40%|████      | 8/20 [00:47<01:10,  5.84s/it]
Task 9, Epoch 9/20 => Loss 0.140, Train_accy 95.37:  40%|████      | 8/20 [00:52<01:10,  5.84s/it]
Task 9, Epoch 9/20 => Loss 0.140, Train_accy 95.37:  45%|████▌     | 9/20 [00:52<01:01,  5.59s/it]
Task 9, Epoch 10/20 => Loss 0.140, Train_accy 95.37, Test_accy 81.82:  45%|████▌     | 9/20 [01:04<01:01,  5.59s/it]
Task 9, Epoch 10/20 => Loss 0.140, Train_accy 95.37, Test_accy 81.82:  50%|█████     | 10/20 [01:04<01:16,  7.62s/it]
Task 9, Epoch 11/20 => Loss 0.111, Train_accy 95.60:  50%|█████     | 10/20 [01:09<01:16,  7.62s/it]                 
Task 9, Epoch 11/20 => Loss 0.111, Train_accy 95.60:  55%|█████▌    | 11/20 [01:09<01:01,  6.84s/it]
Task 9, Epoch 12/20 => Loss 0.135, Train_accy 95.83:  55%|█████▌    | 11/20 [01:14<01:01,  6.84s/it]
Task 9, Epoch 12/20 => Loss 0.135, Train_accy 95.83:  60%|██████    | 12/20 [01:14<00:50,  6.30s/it]
Task 9, Epoch 13/20 => Loss 0.117, Train_accy 95.60:  60%|██████    | 12/20 [01:20<00:50,  6.30s/it]
Task 9, Epoch 13/20 => Loss 0.117, Train_accy 95.60:  65%|██████▌   | 13/20 [01:20<00:41,  5.92s/it]
Task 9, Epoch 14/20 => Loss 0.119, Train_accy 95.14:  65%|██████▌   | 13/20 [01:25<00:41,  5.92s/it]
Task 9, Epoch 14/20 => Loss 0.119, Train_accy 95.14:  70%|███████   | 14/20 [01:25<00:33,  5.67s/it]
Task 9, Epoch 15/20 => Loss 0.115, Train_accy 96.76, Test_accy 81.99:  70%|███████   | 14/20 [01:37<00:33,  5.67s/it]
Task 9, Epoch 15/20 => Loss 0.115, Train_accy 96.76, Test_accy 81.99:  75%|███████▌  | 15/20 [01:37<00:38,  7.63s/it]
Task 9, Epoch 16/20 => Loss 0.115, Train_accy 96.99:  75%|███████▌  | 15/20 [01:42<00:38,  7.63s/it]                 
Task 9, Epoch 16/20 => Loss 0.115, Train_accy 96.99:  80%|████████  | 16/20 [01:42<00:27,  6.85s/it]
Task 9, Epoch 17/20 => Loss 0.109, Train_accy 97.22:  80%|████████  | 16/20 [01:47<00:27,  6.85s/it]
Task 9, Epoch 17/20 => Loss 0.109, Train_accy 97.22:  85%|████████▌ | 17/20 [01:47<00:18,  6.30s/it]
Task 9, Epoch 18/20 => Loss 0.109, Train_accy 96.06:  85%|████████▌ | 17/20 [01:52<00:18,  6.30s/it]
Task 9, Epoch 18/20 => Loss 0.109, Train_accy 96.06:  90%|█████████ | 18/20 [01:52<00:11,  5.93s/it]
Task 9, Epoch 19/20 => Loss 0.113, Train_accy 96.06:  90%|█████████ | 18/20 [01:57<00:11,  5.93s/it]
Task 9, Epoch 19/20 => Loss 0.113, Train_accy 96.06:  95%|█████████▌| 19/20 [01:57<00:05,  5.68s/it]
Task 9, Epoch 20/20 => Loss 0.098, Train_accy 96.76, Test_accy 82.15:  95%|█████████▌| 19/20 [02:09<00:05,  5.68s/it]
Task 9, Epoch 20/20 => Loss 0.098, Train_accy 96.76, Test_accy 82.15: 100%|██████████| 20/20 [02:09<00:00,  7.62s/it]
Task 9, Epoch 20/20 => Loss 0.098, Train_accy 96.76, Test_accy 82.15: 100%|██████████| 20/20 [02:09<00:00,  6.48s/it]
2024-09-06 01:15:40,068 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.098, Train_accy 96.76, Test_accy 82.15
2024-09-06 01:15:47,195 [trainer.py] => No NME accuracy.
2024-09-06 01:15:47,195 [trainer.py] => CNN: {'total': 82.15, '00-09': 89.83, '10-19': 84.5, '20-29': 88.66, '30-39': 88.18, '40-49': 74.77, '50-59': 73.87, '60-69': 80.19, '70-79': 92.91, '80-89': 82.71, '90-99': 66.18, 'old': 84.22, 'new': 66.18}
2024-09-06 01:15:47,195 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15]
2024-09-06 01:15:47,195 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4]

Average Accuracy (CNN): 89.7
2024-09-06 01:15:47,195 [trainer.py] => Average Accuracy (CNN): 89.7 

2024-09-06 01:15:47,197 [trainer.py] => All params: 89792456
2024-09-06 01:15:47,197 [trainer.py] => Trainable params: 89792456
2024-09-06 01:15:47,705 [coda_prompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.483, Train_accy 58.12:   0%|          | 0/20 [00:05<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.483, Train_accy 58.12:   5%|▌         | 1/20 [00:05<01:46,  5.59s/it]
Task 10, Epoch 2/20 => Loss 0.222, Train_accy 93.96:   5%|▌         | 1/20 [00:11<01:46,  5.59s/it]
Task 10, Epoch 2/20 => Loss 0.222, Train_accy 93.96:  10%|█         | 2/20 [00:11<01:40,  5.59s/it]
Task 10, Epoch 3/20 => Loss 0.156, Train_accy 96.25:  10%|█         | 2/20 [00:16<01:40,  5.59s/it]
Task 10, Epoch 3/20 => Loss 0.156, Train_accy 96.25:  15%|█▌        | 3/20 [00:16<01:35,  5.61s/it]
Task 10, Epoch 4/20 => Loss 0.110, Train_accy 95.83:  15%|█▌        | 3/20 [00:22<01:35,  5.61s/it]
Task 10, Epoch 4/20 => Loss 0.110, Train_accy 95.83:  20%|██        | 4/20 [00:22<01:29,  5.61s/it]
Task 10, Epoch 5/20 => Loss 0.085, Train_accy 97.71, Test_accy 81.04:  20%|██        | 4/20 [00:35<01:29,  5.61s/it]
Task 10, Epoch 5/20 => Loss 0.085, Train_accy 97.71, Test_accy 81.04:  25%|██▌       | 5/20 [00:35<02:06,  8.40s/it]
Task 10, Epoch 6/20 => Loss 0.089, Train_accy 97.08:  25%|██▌       | 5/20 [00:41<02:06,  8.40s/it]                 
Task 10, Epoch 6/20 => Loss 0.089, Train_accy 97.08:  30%|███       | 6/20 [00:41<01:44,  7.46s/it]
Task 10, Epoch 7/20 => Loss 0.078, Train_accy 97.08:  30%|███       | 6/20 [00:46<01:44,  7.46s/it]
Task 10, Epoch 7/20 => Loss 0.078, Train_accy 97.08:  35%|███▌      | 7/20 [00:46<01:29,  6.85s/it]
Task 10, Epoch 8/20 => Loss 0.106, Train_accy 96.04:  35%|███▌      | 7/20 [00:52<01:29,  6.85s/it]
Task 10, Epoch 8/20 => Loss 0.106, Train_accy 96.04:  40%|████      | 8/20 [00:52<01:17,  6.45s/it]
Task 10, Epoch 9/20 => Loss 0.080, Train_accy 96.88:  40%|████      | 8/20 [00:58<01:17,  6.45s/it]
Task 10, Epoch 9/20 => Loss 0.080, Train_accy 96.88:  45%|████▌     | 9/20 [00:58<01:07,  6.17s/it]
Task 10, Epoch 10/20 => Loss 0.083, Train_accy 97.50, Test_accy 81.27:  45%|████▌     | 9/20 [01:11<01:07,  6.17s/it]
Task 10, Epoch 10/20 => Loss 0.083, Train_accy 97.50, Test_accy 81.27:  50%|█████     | 10/20 [01:11<01:23,  8.37s/it]
Task 10, Epoch 11/20 => Loss 0.102, Train_accy 96.67:  50%|█████     | 10/20 [01:17<01:23,  8.37s/it]                 
Task 10, Epoch 11/20 => Loss 0.102, Train_accy 96.67:  55%|█████▌    | 11/20 [01:17<01:07,  7.52s/it]
Task 10, Epoch 12/20 => Loss 0.067, Train_accy 97.29:  55%|█████▌    | 11/20 [01:22<01:07,  7.52s/it]
Task 10, Epoch 12/20 => Loss 0.067, Train_accy 97.29:  60%|██████    | 12/20 [01:22<00:55,  6.93s/it]
Task 10, Epoch 13/20 => Loss 0.098, Train_accy 96.46:  60%|██████    | 12/20 [01:28<00:55,  6.93s/it]
Task 10, Epoch 13/20 => Loss 0.098, Train_accy 96.46:  65%|██████▌   | 13/20 [01:28<00:45,  6.52s/it]
Task 10, Epoch 14/20 => Loss 0.099, Train_accy 96.67:  65%|██████▌   | 13/20 [01:33<00:45,  6.52s/it]
Task 10, Epoch 14/20 => Loss 0.099, Train_accy 96.67:  70%|███████   | 14/20 [01:33<00:37,  6.25s/it]
Task 10, Epoch 15/20 => Loss 0.077, Train_accy 96.88, Test_accy 81.66:  70%|███████   | 14/20 [01:47<00:37,  6.25s/it]
Task 10, Epoch 15/20 => Loss 0.077, Train_accy 96.88, Test_accy 81.66:  75%|███████▌  | 15/20 [01:47<00:41,  8.37s/it]
Task 10, Epoch 16/20 => Loss 0.073, Train_accy 97.71:  75%|███████▌  | 15/20 [01:52<00:41,  8.37s/it]                 
Task 10, Epoch 16/20 => Loss 0.073, Train_accy 97.71:  80%|████████  | 16/20 [01:52<00:30,  7.53s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 97.08:  80%|████████  | 16/20 [01:58<00:30,  7.53s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 97.08:  85%|████████▌ | 17/20 [01:58<00:20,  6.95s/it]
Task 10, Epoch 18/20 => Loss 0.058, Train_accy 98.12:  85%|████████▌ | 17/20 [02:03<00:20,  6.95s/it]
Task 10, Epoch 18/20 => Loss 0.058, Train_accy 98.12:  90%|█████████ | 18/20 [02:03<00:13,  6.54s/it]
Task 10, Epoch 19/20 => Loss 0.065, Train_accy 97.71:  90%|█████████ | 18/20 [02:09<00:13,  6.54s/it]
Task 10, Epoch 19/20 => Loss 0.065, Train_accy 97.71:  95%|█████████▌| 19/20 [02:09<00:06,  6.25s/it]
Task 10, Epoch 20/20 => Loss 0.062, Train_accy 97.92, Test_accy 81.50:  95%|█████████▌| 19/20 [02:22<00:06,  6.25s/it]
Task 10, Epoch 20/20 => Loss 0.062, Train_accy 97.92, Test_accy 81.50: 100%|██████████| 20/20 [02:22<00:00,  8.36s/it]
Task 10, Epoch 20/20 => Loss 0.062, Train_accy 97.92, Test_accy 81.50: 100%|██████████| 20/20 [02:22<00:00,  7.14s/it]
2024-09-06 01:18:10,438 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.062, Train_accy 97.92, Test_accy 81.50
2024-09-06 01:18:18,148 [trainer.py] => No NME accuracy.
2024-09-06 01:18:18,149 [trainer.py] => CNN: {'total': 81.5, '00-09': 88.98, '10-19': 83.72, '20-29': 87.63, '30-39': 87.27, '40-49': 74.77, '50-59': 71.17, '60-69': 80.19, '70-79': 92.2, '80-89': 81.2, '90-99': 65.44, '100-109': 84.35, 'old': 81.23, 'new': 84.35}
2024-09-06 01:18:18,149 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5]
2024-09-06 01:18:18,149 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23]

Average Accuracy (CNN): 88.96
2024-09-06 01:18:18,149 [trainer.py] => Average Accuracy (CNN): 88.96 

2024-09-06 01:18:18,151 [trainer.py] => All params: 89792456
2024-09-06 01:18:18,152 [trainer.py] => Trainable params: 89792456
2024-09-06 01:18:18,704 [coda_prompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.887, Train_accy 41.67:   0%|          | 0/20 [00:05<?, ?it/s]
Task 11, Epoch 1/20 => Loss 1.887, Train_accy 41.67:   5%|▌         | 1/20 [00:05<01:36,  5.05s/it]
Task 11, Epoch 2/20 => Loss 0.283, Train_accy 91.90:   5%|▌         | 1/20 [00:10<01:36,  5.05s/it]
Task 11, Epoch 2/20 => Loss 0.283, Train_accy 91.90:  10%|█         | 2/20 [00:10<01:31,  5.06s/it]
Task 11, Epoch 3/20 => Loss 0.161, Train_accy 95.37:  10%|█         | 2/20 [00:15<01:31,  5.06s/it]
Task 11, Epoch 3/20 => Loss 0.161, Train_accy 95.37:  15%|█▌        | 3/20 [00:15<01:26,  5.06s/it]
Task 11, Epoch 4/20 => Loss 0.094, Train_accy 96.53:  15%|█▌        | 3/20 [00:20<01:26,  5.06s/it]
Task 11, Epoch 4/20 => Loss 0.094, Train_accy 96.53:  20%|██        | 4/20 [00:20<01:21,  5.07s/it]
Task 11, Epoch 5/20 => Loss 0.073, Train_accy 97.92, Test_accy 78.95:  20%|██        | 4/20 [00:33<01:21,  5.07s/it]
Task 11, Epoch 5/20 => Loss 0.073, Train_accy 97.92, Test_accy 78.95:  25%|██▌       | 5/20 [00:33<02:00,  8.06s/it]
Task 11, Epoch 6/20 => Loss 0.123, Train_accy 96.76:  25%|██▌       | 5/20 [00:38<02:00,  8.06s/it]                 
Task 11, Epoch 6/20 => Loss 0.123, Train_accy 96.76:  30%|███       | 6/20 [00:38<01:38,  7.04s/it]
Task 11, Epoch 7/20 => Loss 0.057, Train_accy 98.61:  30%|███       | 6/20 [00:43<01:38,  7.04s/it]
Task 11, Epoch 7/20 => Loss 0.057, Train_accy 98.61:  35%|███▌      | 7/20 [00:43<01:23,  6.39s/it]
Task 11, Epoch 8/20 => Loss 0.127, Train_accy 95.60:  35%|███▌      | 7/20 [00:48<01:23,  6.39s/it]
Task 11, Epoch 8/20 => Loss 0.127, Train_accy 95.60:  40%|████      | 8/20 [00:48<01:11,  5.96s/it]
Task 11, Epoch 9/20 => Loss 0.085, Train_accy 98.15:  40%|████      | 8/20 [00:53<01:11,  5.96s/it]
Task 11, Epoch 9/20 => Loss 0.085, Train_accy 98.15:  45%|████▌     | 9/20 [00:53<01:02,  5.70s/it]
Task 11, Epoch 10/20 => Loss 0.077, Train_accy 97.69, Test_accy 79.10:  45%|████▌     | 9/20 [01:07<01:02,  5.70s/it]
Task 11, Epoch 10/20 => Loss 0.077, Train_accy 97.69, Test_accy 79.10:  50%|█████     | 10/20 [01:07<01:20,  8.07s/it]
Task 11, Epoch 11/20 => Loss 0.062, Train_accy 98.15:  50%|█████     | 10/20 [01:12<01:20,  8.07s/it]                 
Task 11, Epoch 11/20 => Loss 0.062, Train_accy 98.15:  55%|█████▌    | 11/20 [01:12<01:04,  7.15s/it]
Task 11, Epoch 12/20 => Loss 0.102, Train_accy 97.22:  55%|█████▌    | 11/20 [01:17<01:04,  7.15s/it]
Task 11, Epoch 12/20 => Loss 0.102, Train_accy 97.22:  60%|██████    | 12/20 [01:17<00:52,  6.51s/it]
Task 11, Epoch 13/20 => Loss 0.063, Train_accy 98.61:  60%|██████    | 12/20 [01:22<00:52,  6.51s/it]
Task 11, Epoch 13/20 => Loss 0.063, Train_accy 98.61:  65%|██████▌   | 13/20 [01:22<00:42,  6.09s/it]
Task 11, Epoch 14/20 => Loss 0.072, Train_accy 97.92:  65%|██████▌   | 13/20 [01:27<00:42,  6.09s/it]
Task 11, Epoch 14/20 => Loss 0.072, Train_accy 97.92:  70%|███████   | 14/20 [01:27<00:34,  5.78s/it]
Task 11, Epoch 15/20 => Loss 0.081, Train_accy 97.22, Test_accy 79.24:  70%|███████   | 14/20 [01:40<00:34,  5.78s/it]
Task 11, Epoch 15/20 => Loss 0.081, Train_accy 97.22, Test_accy 79.24:  75%|███████▌  | 15/20 [01:40<00:40,  8.08s/it]
Task 11, Epoch 16/20 => Loss 0.103, Train_accy 97.22:  75%|███████▌  | 15/20 [01:46<00:40,  8.08s/it]                 
Task 11, Epoch 16/20 => Loss 0.103, Train_accy 97.22:  80%|████████  | 16/20 [01:46<00:28,  7.18s/it]
Task 11, Epoch 17/20 => Loss 0.082, Train_accy 97.45:  80%|████████  | 16/20 [01:51<00:28,  7.18s/it]
Task 11, Epoch 17/20 => Loss 0.082, Train_accy 97.45:  85%|████████▌ | 17/20 [01:51<00:19,  6.54s/it]
Task 11, Epoch 18/20 => Loss 0.052, Train_accy 98.15:  85%|████████▌ | 17/20 [01:56<00:19,  6.54s/it]
Task 11, Epoch 18/20 => Loss 0.052, Train_accy 98.15:  90%|█████████ | 18/20 [01:56<00:12,  6.10s/it]
Task 11, Epoch 19/20 => Loss 0.067, Train_accy 98.15:  90%|█████████ | 18/20 [02:01<00:12,  6.10s/it]
Task 11, Epoch 19/20 => Loss 0.067, Train_accy 98.15:  95%|█████████▌| 19/20 [02:01<00:05,  5.79s/it]
Task 11, Epoch 20/20 => Loss 0.045, Train_accy 98.61, Test_accy 79.31:  95%|█████████▌| 19/20 [02:14<00:05,  5.79s/it]
Task 11, Epoch 20/20 => Loss 0.045, Train_accy 98.61, Test_accy 79.31: 100%|██████████| 20/20 [02:14<00:00,  8.08s/it]
Task 11, Epoch 20/20 => Loss 0.045, Train_accy 98.61, Test_accy 79.31: 100%|██████████| 20/20 [02:14<00:00,  6.73s/it]
2024-09-06 01:20:33,383 [coda_prompt.py] => Task 11, Epoch 20/20 => Loss 0.045, Train_accy 98.61, Test_accy 79.31
2024-09-06 01:20:41,749 [trainer.py] => No NME accuracy.
2024-09-06 01:20:41,750 [trainer.py] => CNN: {'total': 79.31, '00-09': 89.83, '10-19': 83.72, '20-29': 87.63, '30-39': 87.27, '40-49': 74.77, '50-59': 68.47, '60-69': 80.19, '70-79': 89.36, '80-89': 79.7, '90-99': 66.18, '100-109': 84.35, '110-119': 60.18, 'old': 80.97, 'new': 60.18}
2024-09-06 01:20:41,750 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31]
2024-09-06 01:20:41,750 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09]

Average Accuracy (CNN): 88.15
2024-09-06 01:20:41,750 [trainer.py] => Average Accuracy (CNN): 88.15 

2024-09-06 01:20:41,752 [trainer.py] => All params: 89792456
2024-09-06 01:20:41,753 [trainer.py] => Trainable params: 89792456
2024-09-06 01:20:42,350 [coda_prompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.504, Train_accy 55.62:   0%|          | 0/20 [00:05<?, ?it/s]
Task 12, Epoch 1/20 => Loss 1.504, Train_accy 55.62:   5%|▌         | 1/20 [00:05<01:45,  5.57s/it]
Task 12, Epoch 2/20 => Loss 0.346, Train_accy 86.46:   5%|▌         | 1/20 [00:11<01:45,  5.57s/it]
Task 12, Epoch 2/20 => Loss 0.346, Train_accy 86.46:  10%|█         | 2/20 [00:11<01:40,  5.58s/it]
Task 12, Epoch 3/20 => Loss 0.262, Train_accy 90.21:  10%|█         | 2/20 [00:16<01:40,  5.58s/it]
Task 12, Epoch 3/20 => Loss 0.262, Train_accy 90.21:  15%|█▌        | 3/20 [00:16<01:34,  5.58s/it]
Task 12, Epoch 4/20 => Loss 0.240, Train_accy 90.42:  15%|█▌        | 3/20 [00:22<01:34,  5.58s/it]
Task 12, Epoch 4/20 => Loss 0.240, Train_accy 90.42:  20%|██        | 4/20 [00:22<01:29,  5.58s/it]
Task 12, Epoch 5/20 => Loss 0.189, Train_accy 92.92, Test_accy 77.74:  20%|██        | 4/20 [00:36<01:29,  5.58s/it]
Task 12, Epoch 5/20 => Loss 0.189, Train_accy 92.92, Test_accy 77.74:  25%|██▌       | 5/20 [00:36<02:11,  8.79s/it]
Task 12, Epoch 6/20 => Loss 0.177, Train_accy 93.96:  25%|██▌       | 5/20 [00:42<02:11,  8.79s/it]                 
Task 12, Epoch 6/20 => Loss 0.177, Train_accy 93.96:  30%|███       | 6/20 [00:42<01:47,  7.69s/it]
Task 12, Epoch 7/20 => Loss 0.135, Train_accy 95.42:  30%|███       | 6/20 [00:47<01:47,  7.69s/it]
Task 12, Epoch 7/20 => Loss 0.135, Train_accy 95.42:  35%|███▌      | 7/20 [00:47<01:31,  7.00s/it]
Task 12, Epoch 8/20 => Loss 0.119, Train_accy 95.62:  35%|███▌      | 7/20 [00:53<01:31,  7.00s/it]
Task 12, Epoch 8/20 => Loss 0.119, Train_accy 95.62:  40%|████      | 8/20 [00:53<01:18,  6.54s/it]
Task 12, Epoch 9/20 => Loss 0.137, Train_accy 95.21:  40%|████      | 8/20 [00:59<01:18,  6.54s/it]
Task 12, Epoch 9/20 => Loss 0.137, Train_accy 95.21:  45%|████▌     | 9/20 [00:59<01:08,  6.24s/it]
Task 12, Epoch 10/20 => Loss 0.137, Train_accy 95.00, Test_accy 77.94:  45%|████▌     | 9/20 [01:13<01:08,  6.24s/it]
Task 12, Epoch 10/20 => Loss 0.137, Train_accy 95.00, Test_accy 77.94:  50%|█████     | 10/20 [01:13<01:27,  8.79s/it]
Task 12, Epoch 11/20 => Loss 0.143, Train_accy 96.04:  50%|█████     | 10/20 [01:19<01:27,  8.79s/it]                 
Task 12, Epoch 11/20 => Loss 0.143, Train_accy 96.04:  55%|█████▌    | 11/20 [01:19<01:10,  7.81s/it]
Task 12, Epoch 12/20 => Loss 0.133, Train_accy 96.46:  55%|█████▌    | 11/20 [01:24<01:10,  7.81s/it]
Task 12, Epoch 12/20 => Loss 0.133, Train_accy 96.46:  60%|██████    | 12/20 [01:24<00:57,  7.13s/it]
Task 12, Epoch 13/20 => Loss 0.166, Train_accy 94.58:  60%|██████    | 12/20 [01:30<00:57,  7.13s/it]
Task 12, Epoch 13/20 => Loss 0.166, Train_accy 94.58:  65%|██████▌   | 13/20 [01:30<00:46,  6.65s/it]
Task 12, Epoch 14/20 => Loss 0.120, Train_accy 96.04:  65%|██████▌   | 13/20 [01:35<00:46,  6.65s/it]
Task 12, Epoch 14/20 => Loss 0.120, Train_accy 96.04:  70%|███████   | 14/20 [01:35<00:38,  6.36s/it]
Task 12, Epoch 15/20 => Loss 0.118, Train_accy 95.83, Test_accy 78.07:  70%|███████   | 14/20 [01:50<00:38,  6.36s/it]
Task 12, Epoch 15/20 => Loss 0.118, Train_accy 95.83, Test_accy 78.07:  75%|███████▌  | 15/20 [01:50<00:44,  8.82s/it]
Task 12, Epoch 16/20 => Loss 0.129, Train_accy 95.83:  75%|███████▌  | 15/20 [01:56<00:44,  8.82s/it]                 
Task 12, Epoch 16/20 => Loss 0.129, Train_accy 95.83:  80%|████████  | 16/20 [01:56<00:31,  7.86s/it]
Task 12, Epoch 17/20 => Loss 0.121, Train_accy 96.46:  80%|████████  | 16/20 [02:01<00:31,  7.86s/it]
Task 12, Epoch 17/20 => Loss 0.121, Train_accy 96.46:  85%|████████▌ | 17/20 [02:01<00:21,  7.17s/it]
Task 12, Epoch 18/20 => Loss 0.125, Train_accy 95.42:  85%|████████▌ | 17/20 [02:07<00:21,  7.17s/it]
Task 12, Epoch 18/20 => Loss 0.125, Train_accy 95.42:  90%|█████████ | 18/20 [02:07<00:13,  6.71s/it]
Task 12, Epoch 19/20 => Loss 0.131, Train_accy 95.83:  90%|█████████ | 18/20 [02:12<00:13,  6.71s/it]
Task 12, Epoch 19/20 => Loss 0.131, Train_accy 95.83:  95%|█████████▌| 19/20 [02:12<00:06,  6.37s/it]
Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.25, Test_accy 77.87:  95%|█████████▌| 19/20 [02:27<00:06,  6.37s/it]
Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.25, Test_accy 77.87: 100%|██████████| 20/20 [02:27<00:00,  8.82s/it]
Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.25, Test_accy 77.87: 100%|██████████| 20/20 [02:27<00:00,  7.37s/it]
2024-09-06 01:23:09,784 [coda_prompt.py] => Task 12, Epoch 20/20 => Loss 0.113, Train_accy 96.25, Test_accy 77.87
2024-09-06 01:23:18,753 [trainer.py] => No NME accuracy.
2024-09-06 01:23:18,753 [trainer.py] => CNN: {'total': 77.87, '00-09': 88.14, '10-19': 83.72, '20-29': 88.66, '30-39': 85.45, '40-49': 72.9, '50-59': 69.37, '60-69': 80.19, '70-79': 89.36, '80-89': 79.7, '90-99': 61.76, '100-109': 82.61, '110-119': 60.18, '120-129': 70.09, 'old': 78.46, 'new': 70.09}
2024-09-06 01:23:18,753 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87]
2024-09-06 01:23:18,754 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9]

Average Accuracy (CNN): 87.36
2024-09-06 01:23:18,754 [trainer.py] => Average Accuracy (CNN): 87.36 

2024-09-06 01:23:18,755 [trainer.py] => All params: 89792456
2024-09-06 01:23:18,756 [trainer.py] => Trainable params: 89792456
2024-09-06 01:23:19,401 [coda_prompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.728, Train_accy 46.53:   0%|          | 0/20 [00:05<?, ?it/s]
Task 13, Epoch 1/20 => Loss 1.728, Train_accy 46.53:   5%|▌         | 1/20 [00:05<01:36,  5.05s/it]
Task 13, Epoch 2/20 => Loss 0.403, Train_accy 86.34:   5%|▌         | 1/20 [00:10<01:36,  5.05s/it]
Task 13, Epoch 2/20 => Loss 0.403, Train_accy 86.34:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 13, Epoch 3/20 => Loss 0.287, Train_accy 90.74:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 13, Epoch 3/20 => Loss 0.287, Train_accy 90.74:  15%|█▌        | 3/20 [00:15<01:26,  5.06s/it]
Task 13, Epoch 4/20 => Loss 0.195, Train_accy 93.98:  15%|█▌        | 3/20 [00:20<01:26,  5.06s/it]
Task 13, Epoch 4/20 => Loss 0.195, Train_accy 93.98:  20%|██        | 4/20 [00:20<01:20,  5.06s/it]
Task 13, Epoch 5/20 => Loss 0.158, Train_accy 94.44, Test_accy 76.48:  20%|██        | 4/20 [00:34<01:20,  5.06s/it]
Task 13, Epoch 5/20 => Loss 0.158, Train_accy 94.44, Test_accy 76.48:  25%|██▌       | 5/20 [00:34<02:07,  8.51s/it]
Task 13, Epoch 6/20 => Loss 0.125, Train_accy 96.53:  25%|██▌       | 5/20 [00:39<02:07,  8.51s/it]                 
Task 13, Epoch 6/20 => Loss 0.125, Train_accy 96.53:  30%|███       | 6/20 [00:39<01:42,  7.31s/it]
Task 13, Epoch 7/20 => Loss 0.129, Train_accy 96.30:  30%|███       | 6/20 [00:44<01:42,  7.31s/it]
Task 13, Epoch 7/20 => Loss 0.129, Train_accy 96.30:  35%|███▌      | 7/20 [00:44<01:25,  6.55s/it]
Task 13, Epoch 8/20 => Loss 0.151, Train_accy 95.37:  35%|███▌      | 7/20 [00:49<01:25,  6.55s/it]
Task 13, Epoch 8/20 => Loss 0.151, Train_accy 95.37:  40%|████      | 8/20 [00:49<01:12,  6.08s/it]
Task 13, Epoch 9/20 => Loss 0.127, Train_accy 95.83:  40%|████      | 8/20 [00:54<01:12,  6.08s/it]
Task 13, Epoch 9/20 => Loss 0.127, Train_accy 95.83:  45%|████▌     | 9/20 [00:54<01:03,  5.76s/it]
Task 13, Epoch 10/20 => Loss 0.166, Train_accy 93.98, Test_accy 76.97:  45%|████▌     | 9/20 [01:09<01:03,  5.76s/it]
Task 13, Epoch 10/20 => Loss 0.166, Train_accy 93.98, Test_accy 76.97:  50%|█████     | 10/20 [01:09<01:25,  8.51s/it]
Task 13, Epoch 11/20 => Loss 0.102, Train_accy 96.30:  50%|█████     | 10/20 [01:14<01:25,  8.51s/it]                 
Task 13, Epoch 11/20 => Loss 0.102, Train_accy 96.30:  55%|█████▌    | 11/20 [01:14<01:07,  7.46s/it]
Task 13, Epoch 12/20 => Loss 0.124, Train_accy 95.60:  55%|█████▌    | 11/20 [01:19<01:07,  7.46s/it]
Task 13, Epoch 12/20 => Loss 0.124, Train_accy 95.60:  60%|██████    | 12/20 [01:19<00:53,  6.73s/it]
Task 13, Epoch 13/20 => Loss 0.135, Train_accy 95.83:  60%|██████    | 12/20 [01:24<00:53,  6.73s/it]
Task 13, Epoch 13/20 => Loss 0.135, Train_accy 95.83:  65%|██████▌   | 13/20 [01:24<00:43,  6.23s/it]
Task 13, Epoch 14/20 => Loss 0.133, Train_accy 95.83:  65%|██████▌   | 13/20 [01:29<00:43,  6.23s/it]
Task 13, Epoch 14/20 => Loss 0.133, Train_accy 95.83:  70%|███████   | 14/20 [01:29<00:35,  5.88s/it]
Task 13, Epoch 15/20 => Loss 0.110, Train_accy 96.30, Test_accy 77.21:  70%|███████   | 14/20 [01:44<00:35,  5.88s/it]
Task 13, Epoch 15/20 => Loss 0.110, Train_accy 96.30, Test_accy 77.21:  75%|███████▌  | 15/20 [01:44<00:42,  8.55s/it]
Task 13, Epoch 16/20 => Loss 0.091, Train_accy 96.30:  75%|███████▌  | 15/20 [01:49<00:42,  8.55s/it]                 
Task 13, Epoch 16/20 => Loss 0.091, Train_accy 96.30:  80%|████████  | 16/20 [01:49<00:29,  7.50s/it]
Task 13, Epoch 17/20 => Loss 0.134, Train_accy 96.06:  80%|████████  | 16/20 [01:54<00:29,  7.50s/it]
Task 13, Epoch 17/20 => Loss 0.134, Train_accy 96.06:  85%|████████▌ | 17/20 [01:54<00:20,  6.77s/it]
Task 13, Epoch 18/20 => Loss 0.129, Train_accy 95.37:  85%|████████▌ | 17/20 [01:59<00:20,  6.77s/it]
Task 13, Epoch 18/20 => Loss 0.129, Train_accy 95.37:  90%|█████████ | 18/20 [01:59<00:12,  6.27s/it]
Task 13, Epoch 19/20 => Loss 0.098, Train_accy 96.06:  90%|█████████ | 18/20 [02:04<00:12,  6.27s/it]
Task 13, Epoch 19/20 => Loss 0.098, Train_accy 96.06:  95%|█████████▌| 19/20 [02:04<00:05,  5.90s/it]
Task 13, Epoch 20/20 => Loss 0.108, Train_accy 96.53, Test_accy 77.15:  95%|█████████▌| 19/20 [02:19<00:05,  5.90s/it]
Task 13, Epoch 20/20 => Loss 0.108, Train_accy 96.53, Test_accy 77.15: 100%|██████████| 20/20 [02:19<00:00,  8.53s/it]
Task 13, Epoch 20/20 => Loss 0.108, Train_accy 96.53, Test_accy 77.15: 100%|██████████| 20/20 [02:19<00:00,  6.98s/it]
2024-09-06 01:25:39,017 [coda_prompt.py] => Task 13, Epoch 20/20 => Loss 0.108, Train_accy 96.53, Test_accy 77.15
2024-09-06 01:25:48,611 [trainer.py] => No NME accuracy.
2024-09-06 01:25:48,612 [trainer.py] => CNN: {'total': 77.15, '00-09': 88.14, '10-19': 83.72, '20-29': 88.66, '30-39': 83.64, '40-49': 72.9, '50-59': 68.47, '60-69': 80.19, '70-79': 89.36, '80-89': 78.95, '90-99': 61.76, '100-109': 82.61, '110-119': 60.18, '120-129': 68.22, '130-139': 72.88, 'old': 77.48, 'new': 72.88}
2024-09-06 01:25:48,612 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87, 77.15]
2024-09-06 01:25:48,612 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9, 97.68]

Average Accuracy (CNN): 86.63
2024-09-06 01:25:48,612 [trainer.py] => Average Accuracy (CNN): 86.63 

2024-09-06 01:25:48,614 [trainer.py] => All params: 89792456
2024-09-06 01:25:48,615 [trainer.py] => Trainable params: 89792456
2024-09-06 01:25:49,305 [coda_prompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.938, Train_accy 45.83:   0%|          | 0/20 [00:05<?, ?it/s]
Task 14, Epoch 1/20 => Loss 1.938, Train_accy 45.83:   5%|▌         | 1/20 [00:05<01:36,  5.06s/it]
Task 14, Epoch 2/20 => Loss 0.334, Train_accy 89.81:   5%|▌         | 1/20 [00:10<01:36,  5.06s/it]
Task 14, Epoch 2/20 => Loss 0.334, Train_accy 89.81:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 14, Epoch 3/20 => Loss 0.182, Train_accy 94.44:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 14, Epoch 3/20 => Loss 0.182, Train_accy 94.44:  15%|█▌        | 3/20 [00:15<01:26,  5.07s/it]
Task 14, Epoch 4/20 => Loss 0.149, Train_accy 94.91:  15%|█▌        | 3/20 [00:20<01:26,  5.07s/it]
Task 14, Epoch 4/20 => Loss 0.149, Train_accy 94.91:  20%|██        | 4/20 [00:20<01:20,  5.03s/it]
Task 14, Epoch 5/20 => Loss 0.148, Train_accy 94.91, Test_accy 75.33:  20%|██        | 4/20 [00:35<01:20,  5.03s/it]
Task 14, Epoch 5/20 => Loss 0.148, Train_accy 94.91, Test_accy 75.33:  25%|██▌       | 5/20 [00:35<02:10,  8.73s/it]
Task 14, Epoch 6/20 => Loss 0.174, Train_accy 94.21:  25%|██▌       | 5/20 [00:40<02:10,  8.73s/it]                 
Task 14, Epoch 6/20 => Loss 0.174, Train_accy 94.21:  30%|███       | 6/20 [00:40<01:44,  7.50s/it]
Task 14, Epoch 7/20 => Loss 0.172, Train_accy 94.44:  30%|███       | 6/20 [00:45<01:44,  7.50s/it]
Task 14, Epoch 7/20 => Loss 0.172, Train_accy 94.44:  35%|███▌      | 7/20 [00:45<01:27,  6.70s/it]
Task 14, Epoch 8/20 => Loss 0.109, Train_accy 96.99:  35%|███▌      | 7/20 [00:50<01:27,  6.70s/it]
Task 14, Epoch 8/20 => Loss 0.109, Train_accy 96.99:  40%|████      | 8/20 [00:50<01:14,  6.19s/it]
Task 14, Epoch 9/20 => Loss 0.128, Train_accy 96.06:  40%|████      | 8/20 [00:55<01:14,  6.19s/it]
Task 14, Epoch 9/20 => Loss 0.128, Train_accy 96.06:  45%|████▌     | 9/20 [00:55<01:04,  5.84s/it]
Task 14, Epoch 10/20 => Loss 0.084, Train_accy 96.76, Test_accy 75.33:  45%|████▌     | 9/20 [01:11<01:04,  5.84s/it]
Task 14, Epoch 10/20 => Loss 0.084, Train_accy 96.76, Test_accy 75.33:  50%|█████     | 10/20 [01:11<01:27,  8.78s/it]
Task 14, Epoch 11/20 => Loss 0.092, Train_accy 96.76:  50%|█████     | 10/20 [01:16<01:27,  8.78s/it]                 
Task 14, Epoch 11/20 => Loss 0.092, Train_accy 96.76:  55%|█████▌    | 11/20 [01:16<01:08,  7.64s/it]
Task 14, Epoch 12/20 => Loss 0.116, Train_accy 96.53:  55%|█████▌    | 11/20 [01:21<01:08,  7.64s/it]
Task 14, Epoch 12/20 => Loss 0.116, Train_accy 96.53:  60%|██████    | 12/20 [01:21<00:54,  6.86s/it]
Task 14, Epoch 13/20 => Loss 0.111, Train_accy 95.83:  60%|██████    | 12/20 [01:26<00:54,  6.86s/it]
Task 14, Epoch 13/20 => Loss 0.111, Train_accy 95.83:  65%|██████▌   | 13/20 [01:26<00:44,  6.32s/it]
Task 14, Epoch 14/20 => Loss 0.131, Train_accy 95.60:  65%|██████▌   | 13/20 [01:31<00:44,  6.32s/it]
Task 14, Epoch 14/20 => Loss 0.131, Train_accy 95.60:  70%|███████   | 14/20 [01:31<00:35,  5.94s/it]
Task 14, Epoch 15/20 => Loss 0.132, Train_accy 96.06, Test_accy 75.44:  70%|███████   | 14/20 [01:46<00:35,  5.94s/it]
Task 14, Epoch 15/20 => Loss 0.132, Train_accy 96.06, Test_accy 75.44:  75%|███████▌  | 15/20 [01:46<00:43,  8.78s/it]
Task 14, Epoch 16/20 => Loss 0.114, Train_accy 96.30:  75%|███████▌  | 15/20 [01:51<00:43,  8.78s/it]                 
Task 14, Epoch 16/20 => Loss 0.114, Train_accy 96.30:  80%|████████  | 16/20 [01:51<00:30,  7.66s/it]
Task 14, Epoch 17/20 => Loss 0.108, Train_accy 96.53:  80%|████████  | 16/20 [01:56<00:30,  7.66s/it]
Task 14, Epoch 17/20 => Loss 0.108, Train_accy 96.53:  85%|████████▌ | 17/20 [01:56<00:20,  6.88s/it]
Task 14, Epoch 18/20 => Loss 0.068, Train_accy 98.15:  85%|████████▌ | 17/20 [02:01<00:20,  6.88s/it]
Task 14, Epoch 18/20 => Loss 0.068, Train_accy 98.15:  90%|█████████ | 18/20 [02:01<00:12,  6.34s/it]
Task 14, Epoch 19/20 => Loss 0.050, Train_accy 98.38:  90%|█████████ | 18/20 [02:07<00:12,  6.34s/it]
Task 14, Epoch 19/20 => Loss 0.050, Train_accy 98.38:  95%|█████████▌| 19/20 [02:07<00:05,  5.96s/it]
Task 14, Epoch 20/20 => Loss 0.097, Train_accy 96.99, Test_accy 75.55:  95%|█████████▌| 19/20 [02:22<00:05,  5.96s/it]
Task 14, Epoch 20/20 => Loss 0.097, Train_accy 96.99, Test_accy 75.55: 100%|██████████| 20/20 [02:22<00:00,  8.78s/it]
Task 14, Epoch 20/20 => Loss 0.097, Train_accy 96.99, Test_accy 75.55: 100%|██████████| 20/20 [02:22<00:00,  7.12s/it]
2024-09-06 01:28:11,714 [coda_prompt.py] => Task 14, Epoch 20/20 => Loss 0.097, Train_accy 96.99, Test_accy 75.55
2024-09-06 01:28:22,010 [trainer.py] => No NME accuracy.
2024-09-06 01:28:22,010 [trainer.py] => CNN: {'total': 75.55, '00-09': 83.05, '10-19': 83.72, '20-29': 88.66, '30-39': 84.55, '40-49': 69.16, '50-59': 65.77, '60-69': 79.25, '70-79': 88.65, '80-89': 78.95, '90-99': 59.56, '100-109': 83.48, '110-119': 57.52, '120-129': 68.22, '130-139': 72.88, '140-149': 69.84, 'old': 75.99, 'new': 69.84}
2024-09-06 01:28:22,011 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87, 77.15, 75.55]
2024-09-06 01:28:22,011 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9, 97.68, 97.51]

Average Accuracy (CNN): 85.89
2024-09-06 01:28:22,011 [trainer.py] => Average Accuracy (CNN): 85.89 

2024-09-06 01:28:22,012 [trainer.py] => All params: 89792456
2024-09-06 01:28:22,013 [trainer.py] => Trainable params: 89792456
2024-09-06 01:28:22,745 [coda_prompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.598, Train_accy 53.47:   0%|          | 0/20 [00:05<?, ?it/s]
Task 15, Epoch 1/20 => Loss 1.598, Train_accy 53.47:   5%|▌         | 1/20 [00:05<01:36,  5.06s/it]
Task 15, Epoch 2/20 => Loss 0.301, Train_accy 90.97:   5%|▌         | 1/20 [00:10<01:36,  5.06s/it]
Task 15, Epoch 2/20 => Loss 0.301, Train_accy 90.97:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 15, Epoch 3/20 => Loss 0.176, Train_accy 95.37:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 15, Epoch 3/20 => Loss 0.176, Train_accy 95.37:  15%|█▌        | 3/20 [00:15<01:26,  5.07s/it]
Task 15, Epoch 4/20 => Loss 0.158, Train_accy 94.21:  15%|█▌        | 3/20 [00:20<01:26,  5.07s/it]
Task 15, Epoch 4/20 => Loss 0.158, Train_accy 94.21:  20%|██        | 4/20 [00:20<01:21,  5.07s/it]
Task 15, Epoch 5/20 => Loss 0.162, Train_accy 94.68, Test_accy 75.20:  20%|██        | 4/20 [00:36<01:21,  5.07s/it]
Task 15, Epoch 5/20 => Loss 0.162, Train_accy 94.68, Test_accy 75.20:  25%|██▌       | 5/20 [00:36<02:16,  9.08s/it]
Task 15, Epoch 6/20 => Loss 0.161, Train_accy 94.44:  25%|██▌       | 5/20 [00:41<02:16,  9.08s/it]                 
Task 15, Epoch 6/20 => Loss 0.161, Train_accy 94.44:  30%|███       | 6/20 [00:41<01:48,  7.72s/it]
Task 15, Epoch 7/20 => Loss 0.123, Train_accy 96.30:  30%|███       | 6/20 [00:46<01:48,  7.72s/it]
Task 15, Epoch 7/20 => Loss 0.123, Train_accy 96.30:  35%|███▌      | 7/20 [00:46<01:29,  6.85s/it]
Task 15, Epoch 8/20 => Loss 0.130, Train_accy 95.60:  35%|███▌      | 7/20 [00:51<01:29,  6.85s/it]
Task 15, Epoch 8/20 => Loss 0.130, Train_accy 95.60:  40%|████      | 8/20 [00:51<01:15,  6.30s/it]
Task 15, Epoch 9/20 => Loss 0.162, Train_accy 94.44:  40%|████      | 8/20 [00:56<01:15,  6.30s/it]
Task 15, Epoch 9/20 => Loss 0.162, Train_accy 94.44:  45%|████▌     | 9/20 [00:56<01:05,  5.94s/it]
Task 15, Epoch 10/20 => Loss 0.089, Train_accy 97.22, Test_accy 75.30:  45%|████▌     | 9/20 [01:13<01:05,  5.94s/it]
Task 15, Epoch 10/20 => Loss 0.089, Train_accy 97.22, Test_accy 75.30:  50%|█████     | 10/20 [01:13<01:30,  9.10s/it]
Task 15, Epoch 11/20 => Loss 0.100, Train_accy 96.06:  50%|█████     | 10/20 [01:18<01:30,  9.10s/it]                 
Task 15, Epoch 11/20 => Loss 0.100, Train_accy 96.06:  55%|█████▌    | 11/20 [01:18<01:10,  7.87s/it]
Task 15, Epoch 12/20 => Loss 0.137, Train_accy 95.60:  55%|█████▌    | 11/20 [01:23<01:10,  7.87s/it]
Task 15, Epoch 12/20 => Loss 0.137, Train_accy 95.60:  60%|██████    | 12/20 [01:23<00:56,  7.02s/it]
Task 15, Epoch 13/20 => Loss 0.130, Train_accy 96.53:  60%|██████    | 12/20 [01:28<00:56,  7.02s/it]
Task 15, Epoch 13/20 => Loss 0.130, Train_accy 96.53:  65%|██████▌   | 13/20 [01:28<00:45,  6.43s/it]
Task 15, Epoch 14/20 => Loss 0.130, Train_accy 96.76:  65%|██████▌   | 13/20 [01:33<00:45,  6.43s/it]
Task 15, Epoch 14/20 => Loss 0.130, Train_accy 96.76:  70%|███████   | 14/20 [01:33<00:36,  6.02s/it]
Task 15, Epoch 15/20 => Loss 0.115, Train_accy 96.30, Test_accy 75.41:  70%|███████   | 14/20 [01:49<00:36,  6.02s/it]
Task 15, Epoch 15/20 => Loss 0.115, Train_accy 96.30, Test_accy 75.41:  75%|███████▌  | 15/20 [01:49<00:45,  9.03s/it]
Task 15, Epoch 16/20 => Loss 0.108, Train_accy 96.06:  75%|███████▌  | 15/20 [01:54<00:45,  9.03s/it]                 
Task 15, Epoch 16/20 => Loss 0.108, Train_accy 96.06:  80%|████████  | 16/20 [01:54<00:31,  7.85s/it]
Task 15, Epoch 17/20 => Loss 0.064, Train_accy 97.92:  80%|████████  | 16/20 [01:59<00:31,  7.85s/it]
Task 15, Epoch 17/20 => Loss 0.064, Train_accy 97.92:  85%|████████▌ | 17/20 [01:59<00:21,  7.01s/it]
Task 15, Epoch 18/20 => Loss 0.068, Train_accy 98.38:  85%|████████▌ | 17/20 [02:04<00:21,  7.01s/it]
Task 15, Epoch 18/20 => Loss 0.068, Train_accy 98.38:  90%|█████████ | 18/20 [02:04<00:12,  6.43s/it]
Task 15, Epoch 19/20 => Loss 0.093, Train_accy 96.76:  90%|█████████ | 18/20 [02:09<00:12,  6.43s/it]
Task 15, Epoch 19/20 => Loss 0.093, Train_accy 96.76:  95%|█████████▌| 19/20 [02:09<00:06,  6.02s/it]
Task 15, Epoch 20/20 => Loss 0.090, Train_accy 96.76, Test_accy 75.41:  95%|█████████▌| 19/20 [02:25<00:06,  6.02s/it]
Task 15, Epoch 20/20 => Loss 0.090, Train_accy 96.76, Test_accy 75.41: 100%|██████████| 20/20 [02:25<00:00,  9.05s/it]
Task 15, Epoch 20/20 => Loss 0.090, Train_accy 96.76, Test_accy 75.41: 100%|██████████| 20/20 [02:25<00:00,  7.29s/it]
2024-09-06 01:30:48,560 [coda_prompt.py] => Task 15, Epoch 20/20 => Loss 0.090, Train_accy 96.76, Test_accy 75.41
2024-09-06 01:30:59,659 [trainer.py] => No NME accuracy.
2024-09-06 01:30:59,659 [trainer.py] => CNN: {'total': 75.41, '00-09': 83.05, '10-19': 83.72, '20-29': 86.6, '30-39': 84.55, '40-49': 69.16, '50-59': 65.77, '60-69': 79.25, '70-79': 88.65, '80-89': 78.95, '90-99': 57.35, '100-109': 82.61, '110-119': 57.52, '120-129': 68.22, '130-139': 72.88, '140-149': 69.84, '150-159': 78.23, 'old': 75.21, 'new': 78.23}
2024-09-06 01:30:59,659 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87, 77.15, 75.55, 75.41]
2024-09-06 01:30:59,660 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9, 97.68, 97.51, 97.46]

Average Accuracy (CNN): 85.24
2024-09-06 01:30:59,660 [trainer.py] => Average Accuracy (CNN): 85.24 

2024-09-06 01:30:59,661 [trainer.py] => All params: 89792456
2024-09-06 01:30:59,662 [trainer.py] => Trainable params: 89792456
2024-09-06 01:31:00,442 [coda_prompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.430, Train_accy 58.80:   0%|          | 0/20 [00:05<?, ?it/s]
Task 16, Epoch 1/20 => Loss 1.430, Train_accy 58.80:   5%|▌         | 1/20 [00:05<01:36,  5.05s/it]
Task 16, Epoch 2/20 => Loss 0.262, Train_accy 92.13:   5%|▌         | 1/20 [00:10<01:36,  5.05s/it]
Task 16, Epoch 2/20 => Loss 0.262, Train_accy 92.13:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 16, Epoch 3/20 => Loss 0.166, Train_accy 95.14:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 16, Epoch 3/20 => Loss 0.166, Train_accy 95.14:  15%|█▌        | 3/20 [00:15<01:26,  5.08s/it]
Task 16, Epoch 4/20 => Loss 0.175, Train_accy 94.44:  15%|█▌        | 3/20 [00:20<01:26,  5.08s/it]
Task 16, Epoch 4/20 => Loss 0.175, Train_accy 94.44:  20%|██        | 4/20 [00:20<01:21,  5.07s/it]
Task 16, Epoch 5/20 => Loss 0.106, Train_accy 96.06, Test_accy 73.98:  20%|██        | 4/20 [00:37<01:21,  5.07s/it]
Task 16, Epoch 5/20 => Loss 0.106, Train_accy 96.06, Test_accy 73.98:  25%|██▌       | 5/20 [00:37<02:19,  9.30s/it]
Task 16, Epoch 6/20 => Loss 0.133, Train_accy 95.83:  25%|██▌       | 5/20 [00:42<02:19,  9.30s/it]                 
Task 16, Epoch 6/20 => Loss 0.133, Train_accy 95.83:  30%|███       | 6/20 [00:42<01:50,  7.87s/it]
Task 16, Epoch 7/20 => Loss 0.141, Train_accy 95.37:  30%|███       | 6/20 [00:47<01:50,  7.87s/it]
Task 16, Epoch 7/20 => Loss 0.141, Train_accy 95.37:  35%|███▌      | 7/20 [00:47<01:30,  6.96s/it]
Task 16, Epoch 8/20 => Loss 0.090, Train_accy 97.45:  35%|███▌      | 7/20 [00:52<01:30,  6.96s/it]
Task 16, Epoch 8/20 => Loss 0.090, Train_accy 97.45:  40%|████      | 8/20 [00:52<01:16,  6.35s/it]
Task 16, Epoch 9/20 => Loss 0.084, Train_accy 97.22:  40%|████      | 8/20 [00:57<01:16,  6.35s/it]
Task 16, Epoch 9/20 => Loss 0.084, Train_accy 97.22:  45%|████▌     | 9/20 [00:57<01:05,  5.96s/it]
Task 16, Epoch 10/20 => Loss 0.113, Train_accy 96.53, Test_accy 74.72:  45%|████▌     | 9/20 [01:14<01:05,  5.96s/it]
Task 16, Epoch 10/20 => Loss 0.113, Train_accy 96.53, Test_accy 74.72:  50%|█████     | 10/20 [01:14<01:33,  9.34s/it]
Task 16, Epoch 11/20 => Loss 0.091, Train_accy 96.76:  50%|█████     | 10/20 [01:19<01:33,  9.34s/it]                 
Task 16, Epoch 11/20 => Loss 0.091, Train_accy 96.76:  55%|█████▌    | 11/20 [01:19<01:12,  8.04s/it]
Task 16, Epoch 12/20 => Loss 0.123, Train_accy 95.83:  55%|█████▌    | 11/20 [01:24<01:12,  8.04s/it]
Task 16, Epoch 12/20 => Loss 0.123, Train_accy 95.83:  60%|██████    | 12/20 [01:24<00:57,  7.14s/it]
Task 16, Epoch 13/20 => Loss 0.074, Train_accy 97.45:  60%|██████    | 12/20 [01:29<00:57,  7.14s/it]
Task 16, Epoch 13/20 => Loss 0.074, Train_accy 97.45:  65%|██████▌   | 13/20 [01:29<00:45,  6.52s/it]
Task 16, Epoch 14/20 => Loss 0.079, Train_accy 97.69:  65%|██████▌   | 13/20 [01:34<00:45,  6.52s/it]
Task 16, Epoch 14/20 => Loss 0.079, Train_accy 97.69:  70%|███████   | 14/20 [01:34<00:36,  6.08s/it]
Task 16, Epoch 15/20 => Loss 0.108, Train_accy 96.76, Test_accy 74.86:  70%|███████   | 14/20 [01:51<00:36,  6.08s/it]
Task 16, Epoch 15/20 => Loss 0.108, Train_accy 96.76, Test_accy 74.86:  75%|███████▌  | 15/20 [01:51<00:46,  9.30s/it]
Task 16, Epoch 16/20 => Loss 0.098, Train_accy 96.30:  75%|███████▌  | 15/20 [01:56<00:46,  9.30s/it]                 
Task 16, Epoch 16/20 => Loss 0.098, Train_accy 96.30:  80%|████████  | 16/20 [01:56<00:32,  8.03s/it]
Task 16, Epoch 17/20 => Loss 0.101, Train_accy 96.76:  80%|████████  | 16/20 [02:01<00:32,  8.03s/it]
Task 16, Epoch 17/20 => Loss 0.101, Train_accy 96.76:  85%|████████▌ | 17/20 [02:01<00:21,  7.14s/it]
Task 16, Epoch 18/20 => Loss 0.105, Train_accy 96.53:  85%|████████▌ | 17/20 [02:06<00:21,  7.14s/it]
Task 16, Epoch 18/20 => Loss 0.105, Train_accy 96.53:  90%|█████████ | 18/20 [02:06<00:13,  6.52s/it]
Task 16, Epoch 19/20 => Loss 0.100, Train_accy 96.76:  90%|█████████ | 18/20 [02:11<00:13,  6.52s/it]
Task 16, Epoch 19/20 => Loss 0.100, Train_accy 96.76:  95%|█████████▌| 19/20 [02:11<00:06,  6.09s/it]
Task 16, Epoch 20/20 => Loss 0.101, Train_accy 96.76, Test_accy 74.91:  95%|█████████▌| 19/20 [02:28<00:06,  6.09s/it]
Task 16, Epoch 20/20 => Loss 0.101, Train_accy 96.76, Test_accy 74.91: 100%|██████████| 20/20 [02:28<00:00,  9.32s/it]
Task 16, Epoch 20/20 => Loss 0.101, Train_accy 96.76, Test_accy 74.91: 100%|██████████| 20/20 [02:28<00:00,  7.43s/it]
2024-09-06 01:33:29,024 [coda_prompt.py] => Task 16, Epoch 20/20 => Loss 0.101, Train_accy 96.76, Test_accy 74.91
2024-09-06 01:33:40,775 [trainer.py] => No NME accuracy.
2024-09-06 01:33:40,775 [trainer.py] => CNN: {'total': 74.91, '00-09': 83.05, '10-19': 84.5, '20-29': 86.6, '30-39': 84.55, '40-49': 62.62, '50-59': 65.77, '60-69': 78.3, '70-79': 88.65, '80-89': 78.95, '90-99': 56.62, '100-109': 81.74, '110-119': 57.52, '120-129': 67.29, '130-139': 73.73, '140-149': 68.25, '150-159': 77.42, '160-169': 76.87, 'old': 74.78, 'new': 76.87}
2024-09-06 01:33:40,775 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87, 77.15, 75.55, 75.41, 74.91]
2024-09-06 01:33:40,776 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9, 97.68, 97.51, 97.46, 97.33]

Average Accuracy (CNN): 84.63
2024-09-06 01:33:40,776 [trainer.py] => Average Accuracy (CNN): 84.63 

2024-09-06 01:33:40,777 [trainer.py] => All params: 89792456
2024-09-06 01:33:40,778 [trainer.py] => Trainable params: 89792456
2024-09-06 01:33:41,612 [coda_prompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.737, Train_accy 51.46:   0%|          | 0/20 [00:05<?, ?it/s]
Task 17, Epoch 1/20 => Loss 1.737, Train_accy 51.46:   5%|▌         | 1/20 [00:05<01:46,  5.61s/it]
Task 17, Epoch 2/20 => Loss 0.338, Train_accy 89.17:   5%|▌         | 1/20 [00:11<01:46,  5.61s/it]
Task 17, Epoch 2/20 => Loss 0.338, Train_accy 89.17:  10%|█         | 2/20 [00:11<01:40,  5.61s/it]
Task 17, Epoch 3/20 => Loss 0.262, Train_accy 92.29:  10%|█         | 2/20 [00:16<01:40,  5.61s/it]
Task 17, Epoch 3/20 => Loss 0.262, Train_accy 92.29:  15%|█▌        | 3/20 [00:16<01:35,  5.61s/it]
Task 17, Epoch 4/20 => Loss 0.209, Train_accy 92.50:  15%|█▌        | 3/20 [00:22<01:35,  5.61s/it]
Task 17, Epoch 4/20 => Loss 0.209, Train_accy 92.50:  20%|██        | 4/20 [00:22<01:29,  5.61s/it]
Task 17, Epoch 5/20 => Loss 0.137, Train_accy 96.04, Test_accy 73.68:  20%|██        | 4/20 [00:40<01:29,  5.61s/it]
Task 17, Epoch 5/20 => Loss 0.137, Train_accy 96.04, Test_accy 73.68:  25%|██▌       | 5/20 [00:40<02:30, 10.04s/it]
Task 17, Epoch 6/20 => Loss 0.120, Train_accy 96.25:  25%|██▌       | 5/20 [00:45<02:30, 10.04s/it]                 
Task 17, Epoch 6/20 => Loss 0.120, Train_accy 96.25:  30%|███       | 6/20 [00:45<01:59,  8.53s/it]
Task 17, Epoch 7/20 => Loss 0.163, Train_accy 95.42:  30%|███       | 6/20 [00:51<01:59,  8.53s/it]
Task 17, Epoch 7/20 => Loss 0.163, Train_accy 95.42:  35%|███▌      | 7/20 [00:51<01:38,  7.57s/it]
Task 17, Epoch 8/20 => Loss 0.179, Train_accy 93.54:  35%|███▌      | 7/20 [00:57<01:38,  7.57s/it]
Task 17, Epoch 8/20 => Loss 0.179, Train_accy 93.54:  40%|████      | 8/20 [00:57<01:23,  6.94s/it]
Task 17, Epoch 9/20 => Loss 0.114, Train_accy 96.25:  40%|████      | 8/20 [01:02<01:23,  6.94s/it]
Task 17, Epoch 9/20 => Loss 0.114, Train_accy 96.25:  45%|████▌     | 9/20 [01:02<01:11,  6.52s/it]
Task 17, Epoch 10/20 => Loss 0.104, Train_accy 96.04, Test_accy 73.87:  45%|████▌     | 9/20 [01:20<01:11,  6.52s/it]
Task 17, Epoch 10/20 => Loss 0.104, Train_accy 96.04, Test_accy 73.87:  50%|█████     | 10/20 [01:20<01:40, 10.08s/it]
Task 17, Epoch 11/20 => Loss 0.106, Train_accy 96.67:  50%|█████     | 10/20 [01:26<01:40, 10.08s/it]                 
Task 17, Epoch 11/20 => Loss 0.106, Train_accy 96.67:  55%|█████▌    | 11/20 [01:26<01:18,  8.72s/it]
Task 17, Epoch 12/20 => Loss 0.124, Train_accy 95.42:  55%|█████▌    | 11/20 [01:32<01:18,  8.72s/it]
Task 17, Epoch 12/20 => Loss 0.124, Train_accy 95.42:  60%|██████    | 12/20 [01:32<01:02,  7.79s/it]
Task 17, Epoch 13/20 => Loss 0.149, Train_accy 95.62:  60%|██████    | 12/20 [01:37<01:02,  7.79s/it]
Task 17, Epoch 13/20 => Loss 0.149, Train_accy 95.62:  65%|██████▌   | 13/20 [01:37<00:49,  7.13s/it]
Task 17, Epoch 14/20 => Loss 0.118, Train_accy 95.62:  65%|██████▌   | 13/20 [01:43<00:49,  7.13s/it]
Task 17, Epoch 14/20 => Loss 0.118, Train_accy 95.62:  70%|███████   | 14/20 [01:43<00:39,  6.67s/it]
Task 17, Epoch 15/20 => Loss 0.080, Train_accy 97.08, Test_accy 73.87:  70%|███████   | 14/20 [02:01<00:39,  6.67s/it]
Task 17, Epoch 15/20 => Loss 0.080, Train_accy 97.08, Test_accy 73.87:  75%|███████▌  | 15/20 [02:01<00:50, 10.06s/it]
Task 17, Epoch 16/20 => Loss 0.106, Train_accy 96.04:  75%|███████▌  | 15/20 [02:06<00:50, 10.06s/it]                 
Task 17, Epoch 16/20 => Loss 0.106, Train_accy 96.04:  80%|████████  | 16/20 [02:06<00:34,  8.72s/it]
Task 17, Epoch 17/20 => Loss 0.113, Train_accy 95.83:  80%|████████  | 16/20 [02:12<00:34,  8.72s/it]
Task 17, Epoch 17/20 => Loss 0.113, Train_accy 95.83:  85%|████████▌ | 17/20 [02:12<00:23,  7.78s/it]
Task 17, Epoch 18/20 => Loss 0.106, Train_accy 96.67:  85%|████████▌ | 17/20 [02:18<00:23,  7.78s/it]
Task 17, Epoch 18/20 => Loss 0.106, Train_accy 96.67:  90%|█████████ | 18/20 [02:18<00:14,  7.13s/it]
Task 17, Epoch 19/20 => Loss 0.095, Train_accy 97.29:  90%|█████████ | 18/20 [02:23<00:14,  7.13s/it]
Task 17, Epoch 19/20 => Loss 0.095, Train_accy 97.29:  95%|█████████▌| 19/20 [02:23<00:06,  6.67s/it]
Task 17, Epoch 20/20 => Loss 0.137, Train_accy 96.04, Test_accy 73.87:  95%|█████████▌| 19/20 [02:41<00:06,  6.67s/it]
Task 17, Epoch 20/20 => Loss 0.137, Train_accy 96.04, Test_accy 73.87: 100%|██████████| 20/20 [02:41<00:00, 10.03s/it]
Task 17, Epoch 20/20 => Loss 0.137, Train_accy 96.04, Test_accy 73.87: 100%|██████████| 20/20 [02:41<00:00,  8.07s/it]
2024-09-06 01:36:23,088 [coda_prompt.py] => Task 17, Epoch 20/20 => Loss 0.137, Train_accy 96.04, Test_accy 73.87
2024-09-06 01:36:35,367 [trainer.py] => No NME accuracy.
2024-09-06 01:36:35,367 [trainer.py] => CNN: {'total': 73.87, '00-09': 81.36, '10-19': 82.17, '20-29': 86.6, '30-39': 83.64, '40-49': 62.62, '50-59': 65.77, '60-69': 74.53, '70-79': 88.65, '80-89': 78.95, '90-99': 56.62, '100-109': 81.74, '110-119': 57.52, '120-129': 65.42, '130-139': 73.73, '140-149': 66.67, '150-159': 75.81, '160-169': 76.12, '170-179': 69.9, 'old': 74.07, 'new': 69.9}
2024-09-06 01:36:35,367 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87, 77.15, 75.55, 75.41, 74.91, 73.87]
2024-09-06 01:36:35,368 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9, 97.68, 97.51, 97.46, 97.33, 97.27]

Average Accuracy (CNN): 84.03
2024-09-06 01:36:35,368 [trainer.py] => Average Accuracy (CNN): 84.03 

2024-09-06 01:36:35,369 [trainer.py] => All params: 89792456
2024-09-06 01:36:35,370 [trainer.py] => Trainable params: 89792456
2024-09-06 01:36:36,251 [coda_prompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.541, Train_accy 53.47:   0%|          | 0/20 [00:05<?, ?it/s]
Task 18, Epoch 1/20 => Loss 1.541, Train_accy 53.47:   5%|▌         | 1/20 [00:05<01:36,  5.06s/it]
Task 18, Epoch 2/20 => Loss 0.302, Train_accy 90.74:   5%|▌         | 1/20 [00:10<01:36,  5.06s/it]
Task 18, Epoch 2/20 => Loss 0.302, Train_accy 90.74:  10%|█         | 2/20 [00:10<01:31,  5.06s/it]
Task 18, Epoch 3/20 => Loss 0.176, Train_accy 94.91:  10%|█         | 2/20 [00:15<01:31,  5.06s/it]
Task 18, Epoch 3/20 => Loss 0.176, Train_accy 94.91:  15%|█▌        | 3/20 [00:15<01:26,  5.06s/it]
Task 18, Epoch 4/20 => Loss 0.156, Train_accy 94.68:  15%|█▌        | 3/20 [00:20<01:26,  5.06s/it]
Task 18, Epoch 4/20 => Loss 0.156, Train_accy 94.68:  20%|██        | 4/20 [00:20<01:21,  5.06s/it]
Task 18, Epoch 5/20 => Loss 0.156, Train_accy 94.44, Test_accy 72.83:  20%|██        | 4/20 [00:38<01:21,  5.06s/it]
Task 18, Epoch 5/20 => Loss 0.156, Train_accy 94.44, Test_accy 72.83:  25%|██▌       | 5/20 [00:38<02:26,  9.76s/it]
Task 18, Epoch 6/20 => Loss 0.150, Train_accy 94.68:  25%|██▌       | 5/20 [00:43<02:26,  9.76s/it]                 
Task 18, Epoch 6/20 => Loss 0.150, Train_accy 94.68:  30%|███       | 6/20 [00:43<01:54,  8.17s/it]
Task 18, Epoch 7/20 => Loss 0.133, Train_accy 95.60:  30%|███       | 6/20 [00:48<01:54,  8.17s/it]
Task 18, Epoch 7/20 => Loss 0.133, Train_accy 95.60:  35%|███▌      | 7/20 [00:48<01:33,  7.17s/it]
Task 18, Epoch 8/20 => Loss 0.135, Train_accy 94.68:  35%|███▌      | 7/20 [00:53<01:33,  7.17s/it]
Task 18, Epoch 8/20 => Loss 0.135, Train_accy 94.68:  40%|████      | 8/20 [00:53<01:18,  6.51s/it]
Task 18, Epoch 9/20 => Loss 0.118, Train_accy 96.53:  40%|████      | 8/20 [00:58<01:18,  6.51s/it]
Task 18, Epoch 9/20 => Loss 0.118, Train_accy 96.53:  45%|████▌     | 9/20 [00:58<01:06,  6.06s/it]
Task 18, Epoch 10/20 => Loss 0.081, Train_accy 96.99, Test_accy 73.01:  45%|████▌     | 9/20 [01:16<01:06,  6.06s/it]
Task 18, Epoch 10/20 => Loss 0.081, Train_accy 96.99, Test_accy 73.01:  50%|█████     | 10/20 [01:16<01:37,  9.78s/it]
Task 18, Epoch 11/20 => Loss 0.104, Train_accy 96.76:  50%|█████     | 10/20 [01:21<01:37,  9.78s/it]                 
Task 18, Epoch 11/20 => Loss 0.104, Train_accy 96.76:  55%|█████▌    | 11/20 [01:21<01:15,  8.35s/it]
Task 18, Epoch 12/20 => Loss 0.122, Train_accy 96.53:  55%|█████▌    | 11/20 [01:26<01:15,  8.35s/it]
Task 18, Epoch 12/20 => Loss 0.122, Train_accy 96.53:  60%|██████    | 12/20 [01:26<00:58,  7.35s/it]
Task 18, Epoch 13/20 => Loss 0.113, Train_accy 95.37:  60%|██████    | 12/20 [01:32<00:58,  7.35s/it]
Task 18, Epoch 13/20 => Loss 0.113, Train_accy 95.37:  65%|██████▌   | 13/20 [01:32<00:46,  6.67s/it]
Task 18, Epoch 14/20 => Loss 0.080, Train_accy 97.69:  65%|██████▌   | 13/20 [01:37<00:46,  6.67s/it]
Task 18, Epoch 14/20 => Loss 0.080, Train_accy 97.69:  70%|███████   | 14/20 [01:37<00:37,  6.18s/it]
Task 18, Epoch 15/20 => Loss 0.102, Train_accy 97.22, Test_accy 73.36:  70%|███████   | 14/20 [01:55<00:37,  6.18s/it]
Task 18, Epoch 15/20 => Loss 0.102, Train_accy 97.22, Test_accy 73.36:  75%|███████▌  | 15/20 [01:55<00:48,  9.78s/it]
Task 18, Epoch 16/20 => Loss 0.083, Train_accy 97.22:  75%|███████▌  | 15/20 [02:00<00:48,  9.78s/it]                 
Task 18, Epoch 16/20 => Loss 0.083, Train_accy 97.22:  80%|████████  | 16/20 [02:00<00:33,  8.36s/it]
Task 18, Epoch 17/20 => Loss 0.089, Train_accy 96.99:  80%|████████  | 16/20 [02:05<00:33,  8.36s/it]
Task 18, Epoch 17/20 => Loss 0.089, Train_accy 96.99:  85%|████████▌ | 17/20 [02:05<00:22,  7.38s/it]
Task 18, Epoch 18/20 => Loss 0.104, Train_accy 96.76:  85%|████████▌ | 17/20 [02:10<00:22,  7.38s/it]
Task 18, Epoch 18/20 => Loss 0.104, Train_accy 96.76:  90%|█████████ | 18/20 [02:10<00:13,  6.68s/it]
Task 18, Epoch 19/20 => Loss 0.100, Train_accy 96.99:  90%|█████████ | 18/20 [02:15<00:13,  6.68s/it]
Task 18, Epoch 19/20 => Loss 0.100, Train_accy 96.99:  95%|█████████▌| 19/20 [02:15<00:06,  6.20s/it]
Task 18, Epoch 20/20 => Loss 0.083, Train_accy 97.22, Test_accy 73.32:  95%|█████████▌| 19/20 [02:33<00:06,  6.20s/it]
Task 18, Epoch 20/20 => Loss 0.083, Train_accy 97.22, Test_accy 73.32: 100%|██████████| 20/20 [02:33<00:00,  9.78s/it]
Task 18, Epoch 20/20 => Loss 0.083, Train_accy 97.22, Test_accy 73.32: 100%|██████████| 20/20 [02:33<00:00,  7.68s/it]
2024-09-06 01:39:09,959 [coda_prompt.py] => Task 18, Epoch 20/20 => Loss 0.083, Train_accy 97.22, Test_accy 73.32
2024-09-06 01:39:23,112 [trainer.py] => No NME accuracy.
2024-09-06 01:39:23,113 [trainer.py] => CNN: {'total': 73.32, '00-09': 81.36, '10-19': 82.17, '20-29': 86.6, '30-39': 80.91, '40-49': 61.68, '50-59': 66.67, '60-69': 74.53, '70-79': 87.94, '80-89': 78.95, '90-99': 55.88, '100-109': 81.74, '110-119': 57.52, '120-129': 65.42, '130-139': 71.19, '140-149': 67.46, '150-159': 75.81, '160-169': 75.37, '170-179': 69.9, '180-189': 70.45, 'old': 73.5, 'new': 70.45}
2024-09-06 01:39:23,113 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87, 77.15, 75.55, 75.41, 74.91, 73.87, 73.32]
2024-09-06 01:39:23,113 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9, 97.68, 97.51, 97.46, 97.33, 97.27, 96.73]

Average Accuracy (CNN): 83.47
2024-09-06 01:39:23,113 [trainer.py] => Average Accuracy (CNN): 83.47 

2024-09-06 01:39:23,114 [trainer.py] => All params: 89792456
2024-09-06 01:39:23,115 [trainer.py] => Trainable params: 89792456
2024-09-06 01:39:24,039 [coda_prompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.278, Train_accy 62.08:   0%|          | 0/20 [00:05<?, ?it/s]
Task 19, Epoch 1/20 => Loss 1.278, Train_accy 62.08:   5%|▌         | 1/20 [00:05<01:46,  5.62s/it]
Task 19, Epoch 2/20 => Loss 0.255, Train_accy 92.08:   5%|▌         | 1/20 [00:11<01:46,  5.62s/it]
Task 19, Epoch 2/20 => Loss 0.255, Train_accy 92.08:  10%|█         | 2/20 [00:11<01:41,  5.62s/it]
Task 19, Epoch 3/20 => Loss 0.228, Train_accy 92.08:  10%|█         | 2/20 [00:16<01:41,  5.62s/it]
Task 19, Epoch 3/20 => Loss 0.228, Train_accy 92.08:  15%|█▌        | 3/20 [00:16<01:35,  5.62s/it]
Task 19, Epoch 4/20 => Loss 0.191, Train_accy 94.38:  15%|█▌        | 3/20 [00:22<01:35,  5.62s/it]
Task 19, Epoch 4/20 => Loss 0.191, Train_accy 94.38:  20%|██        | 4/20 [00:22<01:29,  5.62s/it]
Task 19, Epoch 5/20 => Loss 0.150, Train_accy 95.83, Test_accy 72.18:  20%|██        | 4/20 [00:41<01:29,  5.62s/it]
Task 19, Epoch 5/20 => Loss 0.150, Train_accy 95.83, Test_accy 72.18:  25%|██▌       | 5/20 [00:41<02:38, 10.54s/it]
Task 19, Epoch 6/20 => Loss 0.138, Train_accy 95.83:  25%|██▌       | 5/20 [00:47<02:38, 10.54s/it]                 
Task 19, Epoch 6/20 => Loss 0.138, Train_accy 95.83:  30%|███       | 6/20 [00:47<02:04,  8.87s/it]
Task 19, Epoch 7/20 => Loss 0.161, Train_accy 95.00:  30%|███       | 6/20 [00:52<02:04,  8.87s/it]
Task 19, Epoch 7/20 => Loss 0.161, Train_accy 95.00:  35%|███▌      | 7/20 [00:52<01:41,  7.80s/it]
Task 19, Epoch 8/20 => Loss 0.161, Train_accy 94.58:  35%|███▌      | 7/20 [00:58<01:41,  7.80s/it]
Task 19, Epoch 8/20 => Loss 0.161, Train_accy 94.58:  40%|████      | 8/20 [00:58<01:25,  7.11s/it]
Task 19, Epoch 9/20 => Loss 0.098, Train_accy 96.88:  40%|████      | 8/20 [01:04<01:25,  7.11s/it]
Task 19, Epoch 9/20 => Loss 0.098, Train_accy 96.88:  45%|████▌     | 9/20 [01:04<01:13,  6.64s/it]
Task 19, Epoch 10/20 => Loss 0.143, Train_accy 95.42, Test_accy 72.18:  45%|████▌     | 9/20 [01:23<01:13,  6.64s/it]
Task 19, Epoch 10/20 => Loss 0.143, Train_accy 95.42, Test_accy 72.18:  50%|█████     | 10/20 [01:23<01:45, 10.52s/it]
Task 19, Epoch 11/20 => Loss 0.076, Train_accy 97.50:  50%|█████     | 10/20 [01:29<01:45, 10.52s/it]                 
Task 19, Epoch 11/20 => Loss 0.076, Train_accy 97.50:  55%|█████▌    | 11/20 [01:29<01:21,  9.04s/it]
Task 19, Epoch 12/20 => Loss 0.117, Train_accy 96.25:  55%|█████▌    | 11/20 [01:34<01:21,  9.04s/it]
Task 19, Epoch 12/20 => Loss 0.117, Train_accy 96.25:  60%|██████    | 12/20 [01:34<01:04,  8.00s/it]
Task 19, Epoch 13/20 => Loss 0.148, Train_accy 95.83:  60%|██████    | 12/20 [01:40<01:04,  8.00s/it]
Task 19, Epoch 13/20 => Loss 0.148, Train_accy 95.83:  65%|██████▌   | 13/20 [01:40<00:50,  7.28s/it]
Task 19, Epoch 14/20 => Loss 0.152, Train_accy 94.79:  65%|██████▌   | 13/20 [01:45<00:50,  7.28s/it]
Task 19, Epoch 14/20 => Loss 0.152, Train_accy 94.79:  70%|███████   | 14/20 [01:45<00:40,  6.78s/it]
Task 19, Epoch 15/20 => Loss 0.109, Train_accy 96.46, Test_accy 72.26:  70%|███████   | 14/20 [02:05<00:40,  6.78s/it]
Task 19, Epoch 15/20 => Loss 0.109, Train_accy 96.46, Test_accy 72.26:  75%|███████▌  | 15/20 [02:05<00:52, 10.55s/it]
Task 19, Epoch 16/20 => Loss 0.069, Train_accy 97.92:  75%|███████▌  | 15/20 [02:10<00:52, 10.55s/it]                 
Task 19, Epoch 16/20 => Loss 0.069, Train_accy 97.92:  80%|████████  | 16/20 [02:10<00:36,  9.08s/it]
Task 19, Epoch 17/20 => Loss 0.113, Train_accy 95.83:  80%|████████  | 16/20 [02:16<00:36,  9.08s/it]
Task 19, Epoch 17/20 => Loss 0.113, Train_accy 95.83:  85%|████████▌ | 17/20 [02:16<00:24,  8.04s/it]
Task 19, Epoch 18/20 => Loss 0.101, Train_accy 96.88:  85%|████████▌ | 17/20 [02:22<00:24,  8.04s/it]
Task 19, Epoch 18/20 => Loss 0.101, Train_accy 96.88:  90%|█████████ | 18/20 [02:22<00:14,  7.31s/it]
Task 19, Epoch 19/20 => Loss 0.103, Train_accy 96.25:  90%|█████████ | 18/20 [02:27<00:14,  7.31s/it]
Task 19, Epoch 19/20 => Loss 0.103, Train_accy 96.25:  95%|█████████▌| 19/20 [02:27<00:06,  6.80s/it]
Task 19, Epoch 20/20 => Loss 0.100, Train_accy 96.88, Test_accy 72.56:  95%|█████████▌| 19/20 [02:47<00:06,  6.80s/it]
Task 19, Epoch 20/20 => Loss 0.100, Train_accy 96.88, Test_accy 72.56: 100%|██████████| 20/20 [02:47<00:00, 10.53s/it]
Task 19, Epoch 20/20 => Loss 0.100, Train_accy 96.88, Test_accy 72.56: 100%|██████████| 20/20 [02:47<00:00,  8.35s/it]
2024-09-06 01:42:11,049 [coda_prompt.py] => Task 19, Epoch 20/20 => Loss 0.100, Train_accy 96.88, Test_accy 72.56
2024-09-06 01:42:24,683 [trainer.py] => No NME accuracy.
2024-09-06 01:42:24,684 [trainer.py] => CNN: {'total': 72.56, '00-09': 80.51, '10-19': 81.4, '20-29': 86.6, '30-39': 78.18, '40-49': 61.68, '50-59': 64.86, '60-69': 73.58, '70-79': 87.94, '80-89': 78.95, '90-99': 55.88, '100-109': 81.74, '110-119': 57.52, '120-129': 65.42, '130-139': 71.19, '140-149': 67.46, '150-159': 75.81, '160-169': 73.88, '170-179': 68.93, '180-189': 70.45, '190-199': 66.33, 'old': 72.83, 'new': 66.33}
2024-09-06 01:42:24,684 [trainer.py] => CNN top1 curve: [100.0, 95.95, 95.06, 92.07, 89.84, 87.65, 84.58, 85.2, 84.51, 82.15, 81.5, 79.31, 77.87, 77.15, 75.55, 75.41, 74.91, 73.87, 73.32, 72.56]
2024-09-06 01:42:24,684 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.64, 99.11, 98.97, 98.8, 98.67, 98.4, 98.23, 98.09, 97.9, 97.68, 97.51, 97.46, 97.33, 97.27, 96.73, 96.69]

Average Accuracy (CNN): 82.92
2024-09-06 01:42:24,684 [trainer.py] => Average Accuracy (CNN): 82.92 

Accuracy Matrix (CNN):
[[100.    97.46  96.61  95.76  95.76  91.53  89.83  88.98  88.98  89.83
   88.98  89.83  88.14  88.14  83.05  83.05  83.05  81.36  81.36  80.51]
 [  0.    94.57  94.57  93.02  93.02  93.8   88.37  85.27  84.5   84.5
   83.72  83.72  83.72  83.72  83.72  83.72  84.5   82.17  82.17  81.4 ]
 [  0.     0.    93.81  88.66  88.66  88.66  88.66  88.66  88.66  88.66
   87.63  87.63  88.66  88.66  88.66  86.6   86.6   86.6   86.6   86.6 ]
 [  0.     0.     0.    90.    90.    91.82  89.09  87.27  88.18  88.18
   87.27  87.27  85.45  83.64  84.55  84.55  84.55  83.64  80.91  78.18]
 [  0.     0.     0.     0.    80.37  80.37  75.7   75.7   74.77  74.77
   74.77  74.77  72.9   72.9   69.16  69.16  62.62  62.62  61.68  61.68]
 [  0.     0.     0.     0.     0.    78.38  76.58  76.58  73.87  73.87
   71.17  68.47  69.37  68.47  65.77  65.77  65.77  65.77  66.67  64.86]
 [  0.     0.     0.     0.     0.     0.    83.02  82.08  83.02  80.19
   80.19  80.19  80.19  80.19  79.25  79.25  78.3   74.53  74.53  73.58]
 [  0.     0.     0.     0.     0.     0.     0.    94.33  93.62  92.91
   92.2   89.36  89.36  89.36  88.65  88.65  88.65  88.65  87.94  87.94]
 [  0.     0.     0.     0.     0.     0.     0.     0.    82.71  82.71
   81.2   79.7   79.7   78.95  78.95  78.95  78.95  78.95  78.95  78.95]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    66.18
   65.44  66.18  61.76  61.76  59.56  57.35  56.62  56.62  55.88  55.88]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
   84.35  84.35  82.61  82.61  83.48  82.61  81.74  81.74  81.74  81.74]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.    60.18  60.18  60.18  57.52  57.52  57.52  57.52  57.52  57.52]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.    70.09  68.22  68.22  68.22  67.29  65.42  65.42  65.42]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.    72.88  72.88  72.88  73.73  73.73  71.19  71.19]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.    69.84  69.84  68.25  66.67  67.46  67.46]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.    78.23  77.42  75.81  75.81  75.81]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.    76.87  76.12  75.37  73.88]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.    69.9   69.9   68.93]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.    70.45  70.45]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.     0.    66.33]]
2024-09-06 01:42:24,691 [trainer.py] => Forgetting (CNN): 7.2026315789473685
2024-09-06 01:42:27,361 [trainer.py] => config: ./exps/coda_prompt_cub_B100_Inc5.json
2024-09-06 01:42:27,379 [trainer.py] => prefix:  
2024-09-06 01:42:27,380 [trainer.py] => dataset: cub
2024-09-06 01:42:27,380 [trainer.py] => memory_size: 0
2024-09-06 01:42:27,380 [trainer.py] => memory_per_class: 0
2024-09-06 01:42:27,380 [trainer.py] => fixed_memory: False
2024-09-06 01:42:27,380 [trainer.py] => shuffle: True
2024-09-06 01:42:27,380 [trainer.py] => init_cls: 100
2024-09-06 01:42:27,380 [trainer.py] => increment: 20
2024-09-06 01:42:27,380 [trainer.py] => model_name: coda_prompt
2024-09-06 01:42:27,380 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-06 01:42:27,380 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 01:42:27,380 [trainer.py] => seed: 1993
2024-09-06 01:42:27,380 [trainer.py] => tuned_epoch: 20
2024-09-06 01:42:27,380 [trainer.py] => init_lr: 0.001
2024-09-06 01:42:27,380 [trainer.py] => batch_size: 48
2024-09-06 01:42:27,380 [trainer.py] => weight_decay: 0
2024-09-06 01:42:27,380 [trainer.py] => min_lr: 1e-05
2024-09-06 01:42:27,380 [trainer.py] => optimizer: adam
2024-09-06 01:42:27,380 [trainer.py] => scheduler: cosine
2024-09-06 01:42:27,380 [trainer.py] => reinit_optimizer: True
2024-09-06 01:42:27,380 [trainer.py] => pretrained: True
2024-09-06 01:42:27,381 [trainer.py] => drop: 0.0
2024-09-06 01:42:27,381 [trainer.py] => drop_path: 0.0
2024-09-06 01:42:27,381 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-06 01:42:27,422 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-06 01:42:29,235 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-06 01:42:29,235 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-06 01:42:29,235 [trainer.py] => All params: 89792456
2024-09-06 01:42:29,236 [trainer.py] => Trainable params: 89792456
2024-09-06 01:42:29,236 [coda_prompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.502, Train_accy 64.39:   0%|          | 0/20 [00:50<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.502, Train_accy 64.39:   5%|▌         | 1/20 [00:50<16:06, 50.89s/it]
Task 0, Epoch 2/20 => Loss 0.529, Train_accy 85.87:   5%|▌         | 1/20 [01:41<16:06, 50.89s/it]
Task 0, Epoch 2/20 => Loss 0.529, Train_accy 85.87:  10%|█         | 2/20 [01:41<15:15, 50.88s/it]
Task 0, Epoch 3/20 => Loss 0.425, Train_accy 88.12:  10%|█         | 2/20 [02:32<15:15, 50.88s/it]
Task 0, Epoch 3/20 => Loss 0.425, Train_accy 88.12:  15%|█▌        | 3/20 [02:32<14:25, 50.92s/it]
Task 0, Epoch 4/20 => Loss 0.376, Train_accy 89.05:  15%|█▌        | 3/20 [03:23<14:25, 50.92s/it]
Task 0, Epoch 4/20 => Loss 0.376, Train_accy 89.05:  20%|██        | 4/20 [03:23<13:34, 50.93s/it]
Task 0, Epoch 5/20 => Loss 0.369, Train_accy 90.03, Test_accy 90.99:  20%|██        | 4/20 [04:21<13:34, 50.93s/it]
Task 0, Epoch 5/20 => Loss 0.369, Train_accy 90.03, Test_accy 90.99:  25%|██▌       | 5/20 [04:21<13:22, 53.50s/it]
Task 0, Epoch 6/20 => Loss 0.294, Train_accy 92.16:  25%|██▌       | 5/20 [05:12<13:22, 53.50s/it]                 
Task 0, Epoch 6/20 => Loss 0.294, Train_accy 92.16:  30%|███       | 6/20 [05:12<12:16, 52.58s/it]
Task 0, Epoch 7/20 => Loss 0.295, Train_accy 92.01:  30%|███       | 6/20 [06:03<12:16, 52.58s/it]
Task 0, Epoch 7/20 => Loss 0.295, Train_accy 92.01:  35%|███▌      | 7/20 [06:03<11:16, 52.01s/it]
Task 0, Epoch 8/20 => Loss 0.269, Train_accy 92.78:  35%|███▌      | 7/20 [06:54<11:16, 52.01s/it]
Task 0, Epoch 8/20 => Loss 0.269, Train_accy 92.78:  40%|████      | 8/20 [06:54<10:19, 51.63s/it]
Task 0, Epoch 9/20 => Loss 0.283, Train_accy 92.63:  40%|████      | 8/20 [07:44<10:19, 51.63s/it]
Task 0, Epoch 9/20 => Loss 0.283, Train_accy 92.63:  45%|████▌     | 9/20 [07:44<09:25, 51.37s/it]
Task 0, Epoch 10/20 => Loss 0.276, Train_accy 92.83, Test_accy 90.91:  45%|████▌     | 9/20 [08:42<09:25, 51.37s/it]
Task 0, Epoch 10/20 => Loss 0.276, Train_accy 92.83, Test_accy 90.91:  50%|█████     | 10/20 [08:42<08:53, 53.40s/it]
Task 0, Epoch 11/20 => Loss 0.263, Train_accy 93.04:  50%|█████     | 10/20 [09:33<08:53, 53.40s/it]                 
Task 0, Epoch 11/20 => Loss 0.263, Train_accy 93.04:  55%|█████▌    | 11/20 [09:33<07:53, 52.62s/it]
Task 0, Epoch 12/20 => Loss 0.255, Train_accy 92.91:  55%|█████▌    | 11/20 [10:24<07:53, 52.62s/it]
Task 0, Epoch 12/20 => Loss 0.255, Train_accy 92.91:  60%|██████    | 12/20 [10:24<06:56, 52.08s/it]
Task 0, Epoch 13/20 => Loss 0.240, Train_accy 93.56:  60%|██████    | 12/20 [11:15<06:56, 52.08s/it]
Task 0, Epoch 13/20 => Loss 0.240, Train_accy 93.56:  65%|██████▌   | 13/20 [11:15<06:01, 51.69s/it]
Task 0, Epoch 14/20 => Loss 0.245, Train_accy 93.34:  65%|██████▌   | 13/20 [12:06<06:01, 51.69s/it]
Task 0, Epoch 14/20 => Loss 0.245, Train_accy 93.34:  70%|███████   | 14/20 [12:06<05:08, 51.45s/it]
Task 0, Epoch 15/20 => Loss 0.222, Train_accy 93.58, Test_accy 90.40:  70%|███████   | 14/20 [13:04<05:08, 51.45s/it]
Task 0, Epoch 15/20 => Loss 0.222, Train_accy 93.58, Test_accy 90.40:  75%|███████▌  | 15/20 [13:04<04:26, 53.39s/it]
Task 0, Epoch 16/20 => Loss 0.220, Train_accy 94.22:  75%|███████▌  | 15/20 [13:55<04:26, 53.39s/it]                 
Task 0, Epoch 16/20 => Loss 0.220, Train_accy 94.22:  80%|████████  | 16/20 [13:55<03:30, 52.65s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 94.01:  80%|████████  | 16/20 [14:46<03:30, 52.65s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 94.01:  85%|████████▌ | 17/20 [14:46<02:36, 52.13s/it]
Task 0, Epoch 18/20 => Loss 0.207, Train_accy 94.20:  85%|████████▌ | 17/20 [15:36<02:36, 52.13s/it]
Task 0, Epoch 18/20 => Loss 0.207, Train_accy 94.20:  90%|█████████ | 18/20 [15:36<01:43, 51.76s/it]
Task 0, Epoch 19/20 => Loss 0.198, Train_accy 94.85:  90%|█████████ | 18/20 [16:27<01:43, 51.76s/it]
Task 0, Epoch 19/20 => Loss 0.198, Train_accy 94.85:  95%|█████████▌| 19/20 [16:27<00:51, 51.52s/it]
Task 0, Epoch 20/20 => Loss 0.202, Train_accy 94.54, Test_accy 91.75:  95%|█████████▌| 19/20 [17:25<00:51, 51.52s/it]
Task 0, Epoch 20/20 => Loss 0.202, Train_accy 94.54, Test_accy 91.75: 100%|██████████| 20/20 [17:25<00:00, 53.47s/it]
Task 0, Epoch 20/20 => Loss 0.202, Train_accy 94.54, Test_accy 91.75: 100%|██████████| 20/20 [17:25<00:00, 52.30s/it]
2024-09-06 01:59:55,595 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.202, Train_accy 94.54, Test_accy 91.75
2024-09-06 02:00:02,756 [trainer.py] => No NME accuracy.
2024-09-06 02:00:02,757 [trainer.py] => CNN: {'total': 91.75, '00-99': 91.75, 'old': 0, 'new': 91.75}
2024-09-06 02:00:02,757 [trainer.py] => CNN top1 curve: [91.75]
2024-09-06 02:00:02,757 [trainer.py] => CNN top5 curve: [99.16]

Average Accuracy (CNN): 91.75
2024-09-06 02:00:02,757 [trainer.py] => Average Accuracy (CNN): 91.75 

2024-09-06 02:00:02,758 [trainer.py] => All params: 89792456
2024-09-06 02:00:02,759 [trainer.py] => Trainable params: 89792456
2024-09-06 02:00:03,495 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.414, Train_accy 62.17:   0%|          | 0/20 [00:10<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.414, Train_accy 62.17:   5%|▌         | 1/20 [00:10<03:15, 10.28s/it]
Task 1, Epoch 2/20 => Loss 0.231, Train_accy 93.53:   5%|▌         | 1/20 [00:20<03:15, 10.28s/it]
Task 1, Epoch 2/20 => Loss 0.231, Train_accy 93.53:  10%|█         | 2/20 [00:20<03:05, 10.31s/it]
Task 1, Epoch 3/20 => Loss 0.187, Train_accy 94.52:  10%|█         | 2/20 [00:30<03:05, 10.31s/it]
Task 1, Epoch 3/20 => Loss 0.187, Train_accy 94.52:  15%|█▌        | 3/20 [00:30<02:55, 10.30s/it]
Task 1, Epoch 4/20 => Loss 0.144, Train_accy 96.05:  15%|█▌        | 3/20 [00:41<02:55, 10.30s/it]
Task 1, Epoch 4/20 => Loss 0.144, Train_accy 96.05:  20%|██        | 4/20 [00:41<02:44, 10.29s/it]
Task 1, Epoch 5/20 => Loss 0.146, Train_accy 96.16, Test_accy 84.11:  20%|██        | 4/20 [00:59<02:44, 10.29s/it]
Task 1, Epoch 5/20 => Loss 0.146, Train_accy 96.16, Test_accy 84.11:  25%|██▌       | 5/20 [00:59<03:19, 13.29s/it]
Task 1, Epoch 6/20 => Loss 0.144, Train_accy 95.18:  25%|██▌       | 5/20 [01:10<03:19, 13.29s/it]                 
Task 1, Epoch 6/20 => Loss 0.144, Train_accy 95.18:  30%|███       | 6/20 [01:10<02:51, 12.27s/it]
Task 1, Epoch 7/20 => Loss 0.143, Train_accy 95.83:  30%|███       | 6/20 [01:20<02:51, 12.27s/it]
Task 1, Epoch 7/20 => Loss 0.143, Train_accy 95.83:  35%|███▌      | 7/20 [01:20<02:30, 11.61s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 95.61:  35%|███▌      | 7/20 [01:30<02:30, 11.61s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 95.61:  40%|████      | 8/20 [01:30<02:14, 11.19s/it]
Task 1, Epoch 9/20 => Loss 0.102, Train_accy 97.26:  40%|████      | 8/20 [01:40<02:14, 11.19s/it]
Task 1, Epoch 9/20 => Loss 0.102, Train_accy 97.26:  45%|████▌     | 9/20 [01:40<02:00, 10.92s/it]
Task 1, Epoch 10/20 => Loss 0.108, Train_accy 96.16, Test_accy 84.75:  45%|████▌     | 9/20 [01:59<02:00, 10.92s/it]
Task 1, Epoch 10/20 => Loss 0.108, Train_accy 96.16, Test_accy 84.75:  50%|█████     | 10/20 [01:59<02:13, 13.32s/it]
Task 1, Epoch 11/20 => Loss 0.108, Train_accy 96.82:  50%|█████     | 10/20 [02:09<02:13, 13.32s/it]                 
Task 1, Epoch 11/20 => Loss 0.108, Train_accy 96.82:  55%|█████▌    | 11/20 [02:09<01:51, 12.39s/it]
Task 1, Epoch 12/20 => Loss 0.081, Train_accy 97.48:  55%|█████▌    | 11/20 [02:20<01:51, 12.39s/it]
Task 1, Epoch 12/20 => Loss 0.081, Train_accy 97.48:  60%|██████    | 12/20 [02:20<01:33, 11.75s/it]
Task 1, Epoch 13/20 => Loss 0.097, Train_accy 97.04:  60%|██████    | 12/20 [02:30<01:33, 11.75s/it]
Task 1, Epoch 13/20 => Loss 0.097, Train_accy 97.04:  65%|██████▌   | 13/20 [02:30<01:19, 11.29s/it]
Task 1, Epoch 14/20 => Loss 0.098, Train_accy 97.15:  65%|██████▌   | 13/20 [02:40<01:19, 11.29s/it]
Task 1, Epoch 14/20 => Loss 0.098, Train_accy 97.15:  70%|███████   | 14/20 [02:40<01:05, 10.98s/it]
Task 1, Epoch 15/20 => Loss 0.112, Train_accy 96.38, Test_accy 85.24:  70%|███████   | 14/20 [02:59<01:05, 10.98s/it]
Task 1, Epoch 15/20 => Loss 0.112, Train_accy 96.38, Test_accy 85.24:  75%|███████▌  | 15/20 [02:59<01:06, 13.30s/it]
Task 1, Epoch 16/20 => Loss 0.103, Train_accy 96.71:  75%|███████▌  | 15/20 [03:09<01:06, 13.30s/it]                 
Task 1, Epoch 16/20 => Loss 0.103, Train_accy 96.71:  80%|████████  | 16/20 [03:09<00:49, 12.39s/it]
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 96.82:  80%|████████  | 16/20 [03:19<00:49, 12.39s/it]
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 96.82:  85%|████████▌ | 17/20 [03:19<00:35, 11.77s/it]
Task 1, Epoch 18/20 => Loss 0.087, Train_accy 96.82:  85%|████████▌ | 17/20 [03:30<00:35, 11.77s/it]
Task 1, Epoch 18/20 => Loss 0.087, Train_accy 96.82:  90%|█████████ | 18/20 [03:30<00:22, 11.34s/it]
Task 1, Epoch 19/20 => Loss 0.100, Train_accy 96.93:  90%|█████████ | 18/20 [03:40<00:22, 11.34s/it]
Task 1, Epoch 19/20 => Loss 0.100, Train_accy 96.93:  95%|█████████▌| 19/20 [03:40<00:11, 11.02s/it]
Task 1, Epoch 20/20 => Loss 0.096, Train_accy 97.04, Test_accy 85.03:  95%|█████████▌| 19/20 [03:59<00:11, 11.02s/it]
Task 1, Epoch 20/20 => Loss 0.096, Train_accy 97.04, Test_accy 85.03: 100%|██████████| 20/20 [03:59<00:00, 13.34s/it]
Task 1, Epoch 20/20 => Loss 0.096, Train_accy 97.04, Test_accy 85.03: 100%|██████████| 20/20 [03:59<00:00, 11.97s/it]
2024-09-06 02:04:02,833 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.096, Train_accy 97.04, Test_accy 85.03
2024-09-06 02:04:11,248 [trainer.py] => No NME accuracy.
2024-09-06 02:04:11,248 [trainer.py] => CNN: {'total': 85.03, '00-99': 91.92, '100-119': 49.12, 'old': 91.92, 'new': 49.12}
2024-09-06 02:04:11,249 [trainer.py] => CNN top1 curve: [91.75, 85.03]
2024-09-06 02:04:11,249 [trainer.py] => CNN top5 curve: [99.16, 98.87]

Average Accuracy (CNN): 88.39
2024-09-06 02:04:11,249 [trainer.py] => Average Accuracy (CNN): 88.39 

2024-09-06 02:04:11,251 [trainer.py] => All params: 89792456
2024-09-06 02:04:11,252 [trainer.py] => Trainable params: 89792456
2024-09-06 02:04:12,576 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.417, Train_accy 58.66:   0%|          | 0/20 [00:10<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.417, Train_accy 58.66:   5%|▌         | 1/20 [00:10<03:15, 10.29s/it]
Task 2, Epoch 2/20 => Loss 0.428, Train_accy 84.43:   5%|▌         | 1/20 [00:20<03:15, 10.29s/it]
Task 2, Epoch 2/20 => Loss 0.428, Train_accy 84.43:  10%|█         | 2/20 [00:20<03:05, 10.29s/it]
Task 2, Epoch 3/20 => Loss 0.316, Train_accy 89.80:  10%|█         | 2/20 [00:30<03:05, 10.29s/it]
Task 2, Epoch 3/20 => Loss 0.316, Train_accy 89.80:  15%|█▌        | 3/20 [00:30<02:55, 10.30s/it]
Task 2, Epoch 4/20 => Loss 0.262, Train_accy 91.67:  15%|█▌        | 3/20 [00:41<02:55, 10.30s/it]
Task 2, Epoch 4/20 => Loss 0.262, Train_accy 91.67:  20%|██        | 4/20 [00:41<02:44, 10.30s/it]
Task 2, Epoch 5/20 => Loss 0.235, Train_accy 91.89, Test_accy 78.98:  20%|██        | 4/20 [01:01<02:44, 10.30s/it]
Task 2, Epoch 5/20 => Loss 0.235, Train_accy 91.89, Test_accy 78.98:  25%|██▌       | 5/20 [01:01<03:27, 13.81s/it]
Task 2, Epoch 6/20 => Loss 0.208, Train_accy 93.31:  25%|██▌       | 5/20 [01:11<03:27, 13.81s/it]                 
Task 2, Epoch 6/20 => Loss 0.208, Train_accy 93.31:  30%|███       | 6/20 [01:11<02:56, 12.62s/it]
Task 2, Epoch 7/20 => Loss 0.206, Train_accy 93.64:  30%|███       | 6/20 [01:21<02:56, 12.62s/it]
Task 2, Epoch 7/20 => Loss 0.206, Train_accy 93.64:  35%|███▌      | 7/20 [01:21<02:34, 11.86s/it]
Task 2, Epoch 8/20 => Loss 0.172, Train_accy 95.18:  35%|███▌      | 7/20 [01:32<02:34, 11.86s/it]
Task 2, Epoch 8/20 => Loss 0.172, Train_accy 95.18:  40%|████      | 8/20 [01:32<02:16, 11.36s/it]
Task 2, Epoch 9/20 => Loss 0.193, Train_accy 94.30:  40%|████      | 8/20 [01:42<02:16, 11.36s/it]
Task 2, Epoch 9/20 => Loss 0.193, Train_accy 94.30:  45%|████▌     | 9/20 [01:42<02:01, 11.03s/it]
Task 2, Epoch 10/20 => Loss 0.203, Train_accy 93.31, Test_accy 79.95:  45%|████▌     | 9/20 [02:02<02:01, 11.03s/it]
Task 2, Epoch 10/20 => Loss 0.203, Train_accy 93.31, Test_accy 79.95:  50%|█████     | 10/20 [02:02<02:17, 13.77s/it]
Task 2, Epoch 11/20 => Loss 0.180, Train_accy 93.97:  50%|█████     | 10/20 [02:12<02:17, 13.77s/it]                 
Task 2, Epoch 11/20 => Loss 0.180, Train_accy 93.97:  55%|█████▌    | 11/20 [02:12<01:54, 12.71s/it]
Task 2, Epoch 12/20 => Loss 0.191, Train_accy 93.86:  55%|█████▌    | 11/20 [02:22<01:54, 12.71s/it]
Task 2, Epoch 12/20 => Loss 0.191, Train_accy 93.86:  60%|██████    | 12/20 [02:22<01:35, 11.98s/it]
Task 2, Epoch 13/20 => Loss 0.153, Train_accy 94.52:  60%|██████    | 12/20 [02:33<01:35, 11.98s/it]
Task 2, Epoch 13/20 => Loss 0.153, Train_accy 94.52:  65%|██████▌   | 13/20 [02:33<01:20, 11.48s/it]
Task 2, Epoch 14/20 => Loss 0.139, Train_accy 95.18:  65%|██████▌   | 13/20 [02:43<01:20, 11.48s/it]
Task 2, Epoch 14/20 => Loss 0.139, Train_accy 95.18:  70%|███████   | 14/20 [02:43<01:06, 11.12s/it]
Task 2, Epoch 15/20 => Loss 0.167, Train_accy 94.52, Test_accy 80.13:  70%|███████   | 14/20 [03:03<01:06, 11.12s/it]
Task 2, Epoch 15/20 => Loss 0.167, Train_accy 94.52, Test_accy 80.13:  75%|███████▌  | 15/20 [03:03<01:08, 13.78s/it]
Task 2, Epoch 16/20 => Loss 0.149, Train_accy 95.72:  75%|███████▌  | 15/20 [03:13<01:08, 13.78s/it]                 
Task 2, Epoch 16/20 => Loss 0.149, Train_accy 95.72:  80%|████████  | 16/20 [03:13<00:50, 12.73s/it]
Task 2, Epoch 17/20 => Loss 0.150, Train_accy 95.61:  80%|████████  | 16/20 [03:24<00:50, 12.73s/it]
Task 2, Epoch 17/20 => Loss 0.150, Train_accy 95.61:  85%|████████▌ | 17/20 [03:24<00:35, 12.00s/it]
Task 2, Epoch 18/20 => Loss 0.155, Train_accy 94.63:  85%|████████▌ | 17/20 [03:34<00:35, 12.00s/it]
Task 2, Epoch 18/20 => Loss 0.155, Train_accy 94.63:  90%|█████████ | 18/20 [03:34<00:22, 11.49s/it]
Task 2, Epoch 19/20 => Loss 0.154, Train_accy 95.07:  90%|█████████ | 18/20 [03:44<00:22, 11.49s/it]
Task 2, Epoch 19/20 => Loss 0.154, Train_accy 95.07:  95%|█████████▌| 19/20 [03:44<00:11, 11.13s/it]
Task 2, Epoch 20/20 => Loss 0.143, Train_accy 95.72, Test_accy 80.32:  95%|█████████▌| 19/20 [04:04<00:11, 11.13s/it]
Task 2, Epoch 20/20 => Loss 0.143, Train_accy 95.72, Test_accy 80.32: 100%|██████████| 20/20 [04:04<00:00, 13.78s/it]
Task 2, Epoch 20/20 => Loss 0.143, Train_accy 95.72, Test_accy 80.32: 100%|██████████| 20/20 [04:04<00:00, 12.23s/it]
2024-09-06 02:08:17,239 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.143, Train_accy 95.72, Test_accy 80.32
2024-09-06 02:08:26,909 [trainer.py] => No NME accuracy.
2024-09-06 02:08:26,910 [trainer.py] => CNN: {'total': 80.32, '00-99': 91.67, '100-119': 49.56, '120-139': 51.56, 'old': 84.89, 'new': 51.56}
2024-09-06 02:08:26,910 [trainer.py] => CNN top1 curve: [91.75, 85.03, 80.32]
2024-09-06 02:08:26,910 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.54]

Average Accuracy (CNN): 85.7
2024-09-06 02:08:26,911 [trainer.py] => Average Accuracy (CNN): 85.7 

2024-09-06 02:08:26,912 [trainer.py] => All params: 89792456
2024-09-06 02:08:26,913 [trainer.py] => Trainable params: 89792456
2024-09-06 02:08:28,634 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.459, Train_accy 61.84:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.459, Train_accy 61.84:   5%|▌         | 1/20 [00:10<03:15, 10.30s/it]
Task 3, Epoch 2/20 => Loss 0.344, Train_accy 89.69:   5%|▌         | 1/20 [00:20<03:15, 10.30s/it]
Task 3, Epoch 2/20 => Loss 0.344, Train_accy 89.69:  10%|█         | 2/20 [00:20<03:05, 10.31s/it]
Task 3, Epoch 3/20 => Loss 0.205, Train_accy 94.19:  10%|█         | 2/20 [00:30<03:05, 10.31s/it]
Task 3, Epoch 3/20 => Loss 0.205, Train_accy 94.19:  15%|█▌        | 3/20 [00:30<02:55, 10.30s/it]
Task 3, Epoch 4/20 => Loss 0.201, Train_accy 93.75:  15%|█▌        | 3/20 [00:41<02:55, 10.30s/it]
Task 3, Epoch 4/20 => Loss 0.201, Train_accy 93.75:  20%|██        | 4/20 [00:41<02:45, 10.35s/it]
Task 3, Epoch 5/20 => Loss 0.178, Train_accy 94.96, Test_accy 74.93:  20%|██        | 4/20 [01:02<02:45, 10.35s/it]
Task 3, Epoch 5/20 => Loss 0.178, Train_accy 94.96, Test_accy 74.93:  25%|██▌       | 5/20 [01:02<03:34, 14.33s/it]
Task 3, Epoch 6/20 => Loss 0.193, Train_accy 94.19:  25%|██▌       | 5/20 [01:13<03:34, 14.33s/it]                 
Task 3, Epoch 6/20 => Loss 0.193, Train_accy 94.19:  30%|███       | 6/20 [01:13<03:01, 12.96s/it]
Task 3, Epoch 7/20 => Loss 0.172, Train_accy 95.39:  30%|███       | 6/20 [01:23<03:01, 12.96s/it]
Task 3, Epoch 7/20 => Loss 0.172, Train_accy 95.39:  35%|███▌      | 7/20 [01:23<02:37, 12.09s/it]
Task 3, Epoch 8/20 => Loss 0.153, Train_accy 95.39:  35%|███▌      | 7/20 [01:33<02:37, 12.09s/it]
Task 3, Epoch 8/20 => Loss 0.153, Train_accy 95.39:  40%|████      | 8/20 [01:33<02:18, 11.53s/it]
Task 3, Epoch 9/20 => Loss 0.132, Train_accy 95.72:  40%|████      | 8/20 [01:43<02:18, 11.53s/it]
Task 3, Epoch 9/20 => Loss 0.132, Train_accy 95.72:  45%|████▌     | 9/20 [01:43<02:02, 11.16s/it]
Task 3, Epoch 10/20 => Loss 0.148, Train_accy 95.94, Test_accy 75.67:  45%|████▌     | 9/20 [02:05<02:02, 11.16s/it]
Task 3, Epoch 10/20 => Loss 0.148, Train_accy 95.94, Test_accy 75.67:  50%|█████     | 10/20 [02:05<02:23, 14.32s/it]
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 95.29:  50%|█████     | 10/20 [02:15<02:23, 14.32s/it]                 
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 95.29:  55%|█████▌    | 11/20 [02:15<01:57, 13.10s/it]
Task 3, Epoch 12/20 => Loss 0.141, Train_accy 95.39:  55%|█████▌    | 11/20 [02:25<01:57, 13.10s/it]
Task 3, Epoch 12/20 => Loss 0.141, Train_accy 95.39:  60%|██████    | 12/20 [02:25<01:37, 12.24s/it]
Task 3, Epoch 13/20 => Loss 0.131, Train_accy 95.50:  60%|██████    | 12/20 [02:36<01:37, 12.24s/it]
Task 3, Epoch 13/20 => Loss 0.131, Train_accy 95.50:  65%|██████▌   | 13/20 [02:36<01:21, 11.65s/it]
Task 3, Epoch 14/20 => Loss 0.111, Train_accy 96.38:  65%|██████▌   | 13/20 [02:46<01:21, 11.65s/it]
Task 3, Epoch 14/20 => Loss 0.111, Train_accy 96.38:  70%|███████   | 14/20 [02:46<01:07, 11.25s/it]
Task 3, Epoch 15/20 => Loss 0.105, Train_accy 97.26, Test_accy 75.99:  70%|███████   | 14/20 [03:07<01:07, 11.25s/it]
Task 3, Epoch 15/20 => Loss 0.105, Train_accy 97.26, Test_accy 75.99:  75%|███████▌  | 15/20 [03:07<01:11, 14.30s/it]
Task 3, Epoch 16/20 => Loss 0.128, Train_accy 95.94:  75%|███████▌  | 15/20 [03:18<01:11, 14.30s/it]                 
Task 3, Epoch 16/20 => Loss 0.128, Train_accy 95.94:  80%|████████  | 16/20 [03:18<00:52, 13.10s/it]
Task 3, Epoch 17/20 => Loss 0.084, Train_accy 97.26:  80%|████████  | 16/20 [03:28<00:52, 13.10s/it]
Task 3, Epoch 17/20 => Loss 0.084, Train_accy 97.26:  85%|████████▌ | 17/20 [03:28<00:36, 12.26s/it]
Task 3, Epoch 18/20 => Loss 0.114, Train_accy 96.38:  85%|████████▌ | 17/20 [03:38<00:36, 12.26s/it]
Task 3, Epoch 18/20 => Loss 0.114, Train_accy 96.38:  90%|█████████ | 18/20 [03:38<00:23, 11.67s/it]
Task 3, Epoch 19/20 => Loss 0.128, Train_accy 95.94:  90%|█████████ | 18/20 [03:49<00:23, 11.67s/it]
Task 3, Epoch 19/20 => Loss 0.128, Train_accy 95.94:  95%|█████████▌| 19/20 [03:49<00:11, 11.30s/it]
Task 3, Epoch 20/20 => Loss 0.102, Train_accy 96.93, Test_accy 75.99:  95%|█████████▌| 19/20 [04:10<00:11, 11.30s/it]
Task 3, Epoch 20/20 => Loss 0.102, Train_accy 96.93, Test_accy 75.99: 100%|██████████| 20/20 [04:10<00:00, 14.35s/it]
Task 3, Epoch 20/20 => Loss 0.102, Train_accy 96.93, Test_accy 75.99: 100%|██████████| 20/20 [04:10<00:00, 12.54s/it]
2024-09-06 02:12:39,421 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.102, Train_accy 96.93, Test_accy 75.99
2024-09-06 02:12:50,458 [trainer.py] => No NME accuracy.
2024-09-06 02:12:50,458 [trainer.py] => CNN: {'total': 75.99, '00-99': 91.67, '100-119': 46.49, '120-139': 51.56, '140-159': 50.4, 'old': 79.89, 'new': 50.4}
2024-09-06 02:12:50,459 [trainer.py] => CNN top1 curve: [91.75, 85.03, 80.32, 75.99]
2024-09-06 02:12:50,459 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.54, 98.68]

Average Accuracy (CNN): 83.27
2024-09-06 02:12:50,459 [trainer.py] => Average Accuracy (CNN): 83.27 

2024-09-06 02:12:50,460 [trainer.py] => All params: 89792456
2024-09-06 02:12:50,461 [trainer.py] => Trainable params: 89792456
2024-09-06 02:12:52,611 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.520, Train_accy 59.54:   0%|          | 0/20 [00:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.520, Train_accy 59.54:   5%|▌         | 1/20 [00:10<03:15, 10.30s/it]
Task 4, Epoch 2/20 => Loss 0.291, Train_accy 91.12:   5%|▌         | 1/20 [00:20<03:15, 10.30s/it]
Task 4, Epoch 2/20 => Loss 0.291, Train_accy 91.12:  10%|█         | 2/20 [00:20<03:05, 10.31s/it]
Task 4, Epoch 3/20 => Loss 0.197, Train_accy 94.30:  10%|█         | 2/20 [00:30<03:05, 10.31s/it]
Task 4, Epoch 3/20 => Loss 0.197, Train_accy 94.30:  15%|█▌        | 3/20 [00:30<02:55, 10.31s/it]
Task 4, Epoch 4/20 => Loss 0.220, Train_accy 93.53:  15%|█▌        | 3/20 [00:41<02:55, 10.31s/it]
Task 4, Epoch 4/20 => Loss 0.220, Train_accy 93.53:  20%|██        | 4/20 [00:41<02:45, 10.32s/it]
Task 4, Epoch 5/20 => Loss 0.196, Train_accy 94.52, Test_accy 72.93:  20%|██        | 4/20 [01:03<02:45, 10.32s/it]
Task 4, Epoch 5/20 => Loss 0.196, Train_accy 94.52, Test_accy 72.93:  25%|██▌       | 5/20 [01:03<03:41, 14.77s/it]
Task 4, Epoch 6/20 => Loss 0.170, Train_accy 94.52:  25%|██▌       | 5/20 [01:14<03:41, 14.77s/it]                 
Task 4, Epoch 6/20 => Loss 0.170, Train_accy 94.52:  30%|███       | 6/20 [01:14<03:05, 13.25s/it]
Task 4, Epoch 7/20 => Loss 0.158, Train_accy 95.18:  30%|███       | 6/20 [01:24<03:05, 13.25s/it]
Task 4, Epoch 7/20 => Loss 0.158, Train_accy 95.18:  35%|███▌      | 7/20 [01:24<02:39, 12.28s/it]
Task 4, Epoch 8/20 => Loss 0.167, Train_accy 94.85:  35%|███▌      | 7/20 [01:34<02:39, 12.28s/it]
Task 4, Epoch 8/20 => Loss 0.167, Train_accy 94.85:  40%|████      | 8/20 [01:34<02:19, 11.66s/it]
Task 4, Epoch 9/20 => Loss 0.187, Train_accy 94.19:  40%|████      | 8/20 [01:45<02:19, 11.66s/it]
Task 4, Epoch 9/20 => Loss 0.187, Train_accy 94.19:  45%|████▌     | 9/20 [01:45<02:03, 11.24s/it]
Task 4, Epoch 10/20 => Loss 0.168, Train_accy 95.18, Test_accy 73.36:  45%|████▌     | 9/20 [02:07<02:03, 11.24s/it]
Task 4, Epoch 10/20 => Loss 0.168, Train_accy 95.18, Test_accy 73.36:  50%|█████     | 10/20 [02:07<02:27, 14.76s/it]
Task 4, Epoch 11/20 => Loss 0.151, Train_accy 94.96:  50%|█████     | 10/20 [02:18<02:27, 14.76s/it]                 
Task 4, Epoch 11/20 => Loss 0.151, Train_accy 94.96:  55%|█████▌    | 11/20 [02:18<02:00, 13.40s/it]
Task 4, Epoch 12/20 => Loss 0.158, Train_accy 95.18:  55%|█████▌    | 11/20 [02:28<02:00, 13.40s/it]
Task 4, Epoch 12/20 => Loss 0.158, Train_accy 95.18:  60%|██████    | 12/20 [02:28<01:39, 12.47s/it]
Task 4, Epoch 13/20 => Loss 0.159, Train_accy 95.29:  60%|██████    | 12/20 [02:38<01:39, 12.47s/it]
Task 4, Epoch 13/20 => Loss 0.159, Train_accy 95.29:  65%|██████▌   | 13/20 [02:38<01:22, 11.81s/it]
Task 4, Epoch 14/20 => Loss 0.154, Train_accy 95.29:  65%|██████▌   | 13/20 [02:49<01:22, 11.81s/it]
Task 4, Epoch 14/20 => Loss 0.154, Train_accy 95.29:  70%|███████   | 14/20 [02:49<01:08, 11.37s/it]
Task 4, Epoch 15/20 => Loss 0.135, Train_accy 95.83, Test_accy 73.78:  70%|███████   | 14/20 [03:11<01:08, 11.37s/it]
Task 4, Epoch 15/20 => Loss 0.135, Train_accy 95.83, Test_accy 73.78:  75%|███████▌  | 15/20 [03:11<01:13, 14.79s/it]
Task 4, Epoch 16/20 => Loss 0.149, Train_accy 95.94:  75%|███████▌  | 15/20 [03:22<01:13, 14.79s/it]                 
Task 4, Epoch 16/20 => Loss 0.149, Train_accy 95.94:  80%|████████  | 16/20 [03:22<00:53, 13.45s/it]
Task 4, Epoch 17/20 => Loss 0.103, Train_accy 96.49:  80%|████████  | 16/20 [03:32<00:53, 13.45s/it]
Task 4, Epoch 17/20 => Loss 0.103, Train_accy 96.49:  85%|████████▌ | 17/20 [03:32<00:37, 12.51s/it]
Task 4, Epoch 18/20 => Loss 0.164, Train_accy 95.29:  85%|████████▌ | 17/20 [03:42<00:37, 12.51s/it]
Task 4, Epoch 18/20 => Loss 0.164, Train_accy 95.29:  90%|█████████ | 18/20 [03:42<00:23, 11.85s/it]
Task 4, Epoch 19/20 => Loss 0.113, Train_accy 96.49:  90%|█████████ | 18/20 [03:53<00:23, 11.85s/it]
Task 4, Epoch 19/20 => Loss 0.113, Train_accy 96.49:  95%|█████████▌| 19/20 [03:53<00:11, 11.42s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 95.94, Test_accy 73.78:  95%|█████████▌| 19/20 [04:15<00:11, 11.42s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 95.94, Test_accy 73.78: 100%|██████████| 20/20 [04:15<00:00, 14.83s/it]
Task 4, Epoch 20/20 => Loss 0.131, Train_accy 95.94, Test_accy 73.78: 100%|██████████| 20/20 [04:15<00:00, 12.80s/it]
2024-09-06 02:17:08,599 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.131, Train_accy 95.94, Test_accy 73.78
2024-09-06 02:17:20,986 [trainer.py] => No NME accuracy.
2024-09-06 02:17:20,987 [trainer.py] => CNN: {'total': 73.78, '00-99': 91.41, '100-119': 47.37, '120-139': 52.0, '140-159': 50.0, '160-179': 56.54, 'old': 75.94, 'new': 56.54}
2024-09-06 02:17:20,987 [trainer.py] => CNN top1 curve: [91.75, 85.03, 80.32, 75.99, 73.78]
2024-09-06 02:17:20,987 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.54, 98.68, 98.31]

Average Accuracy (CNN): 81.37
2024-09-06 02:17:20,988 [trainer.py] => Average Accuracy (CNN): 81.37 

2024-09-06 02:17:20,989 [trainer.py] => All params: 89792456
2024-09-06 02:17:20,990 [trainer.py] => Trainable params: 89792456
2024-09-06 02:17:23,740 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.365, Train_accy 61.07:   0%|          | 0/20 [00:10<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.365, Train_accy 61.07:   5%|▌         | 1/20 [00:10<03:16, 10.32s/it]
Task 5, Epoch 2/20 => Loss 0.345, Train_accy 89.69:   5%|▌         | 1/20 [00:20<03:16, 10.32s/it]
Task 5, Epoch 2/20 => Loss 0.345, Train_accy 89.69:  10%|█         | 2/20 [00:20<03:06, 10.38s/it]
Task 5, Epoch 3/20 => Loss 0.209, Train_accy 93.75:  10%|█         | 2/20 [00:31<03:06, 10.38s/it]
Task 5, Epoch 3/20 => Loss 0.209, Train_accy 93.75:  15%|█▌        | 3/20 [00:31<02:56, 10.36s/it]
Task 5, Epoch 4/20 => Loss 0.203, Train_accy 93.75:  15%|█▌        | 3/20 [00:41<02:56, 10.36s/it]
Task 5, Epoch 4/20 => Loss 0.203, Train_accy 93.75:  20%|██        | 4/20 [00:41<02:45, 10.36s/it]
Task 5, Epoch 5/20 => Loss 0.193, Train_accy 94.08, Test_accy 70.02:  20%|██        | 4/20 [01:05<02:45, 10.36s/it]
Task 5, Epoch 5/20 => Loss 0.193, Train_accy 94.08, Test_accy 70.02:  25%|██▌       | 5/20 [01:05<03:49, 15.27s/it]
Task 5, Epoch 6/20 => Loss 0.226, Train_accy 93.64:  25%|██▌       | 5/20 [01:15<03:49, 15.27s/it]                 
Task 5, Epoch 6/20 => Loss 0.226, Train_accy 93.64:  30%|███       | 6/20 [01:15<03:10, 13.60s/it]
Task 5, Epoch 7/20 => Loss 0.154, Train_accy 94.85:  30%|███       | 6/20 [01:26<03:10, 13.60s/it]
Task 5, Epoch 7/20 => Loss 0.154, Train_accy 94.85:  35%|███▌      | 7/20 [01:26<02:42, 12.53s/it]
Task 5, Epoch 8/20 => Loss 0.165, Train_accy 94.85:  35%|███▌      | 7/20 [01:36<02:42, 12.53s/it]
Task 5, Epoch 8/20 => Loss 0.165, Train_accy 94.85:  40%|████      | 8/20 [01:36<02:21, 11.83s/it]
Task 5, Epoch 9/20 => Loss 0.172, Train_accy 94.85:  40%|████      | 8/20 [01:46<02:21, 11.83s/it]
Task 5, Epoch 9/20 => Loss 0.172, Train_accy 94.85:  45%|████▌     | 9/20 [01:46<02:04, 11.36s/it]
Task 5, Epoch 10/20 => Loss 0.138, Train_accy 95.50, Test_accy 70.27:  45%|████▌     | 9/20 [02:10<02:04, 11.36s/it]
Task 5, Epoch 10/20 => Loss 0.138, Train_accy 95.50, Test_accy 70.27:  50%|█████     | 10/20 [02:10<02:32, 15.28s/it]
Task 5, Epoch 11/20 => Loss 0.154, Train_accy 95.50:  50%|█████     | 10/20 [02:21<02:32, 15.28s/it]                 
Task 5, Epoch 11/20 => Loss 0.154, Train_accy 95.50:  55%|█████▌    | 11/20 [02:21<02:03, 13.78s/it]
Task 5, Epoch 12/20 => Loss 0.122, Train_accy 95.72:  55%|█████▌    | 11/20 [02:31<02:03, 13.78s/it]
Task 5, Epoch 12/20 => Loss 0.122, Train_accy 95.72:  60%|██████    | 12/20 [02:31<01:41, 12.71s/it]
Task 5, Epoch 13/20 => Loss 0.128, Train_accy 96.38:  60%|██████    | 12/20 [02:41<01:41, 12.71s/it]
Task 5, Epoch 13/20 => Loss 0.128, Train_accy 96.38:  65%|██████▌   | 13/20 [02:41<01:23, 11.99s/it]
Task 5, Epoch 14/20 => Loss 0.128, Train_accy 96.16:  65%|██████▌   | 13/20 [02:52<01:23, 11.99s/it]
Task 5, Epoch 14/20 => Loss 0.128, Train_accy 96.16:  70%|███████   | 14/20 [02:52<01:09, 11.50s/it]
Task 5, Epoch 15/20 => Loss 0.117, Train_accy 96.93, Test_accy 70.70:  70%|███████   | 14/20 [03:16<01:09, 11.50s/it]
Task 5, Epoch 15/20 => Loss 0.117, Train_accy 96.93, Test_accy 70.70:  75%|███████▌  | 15/20 [03:16<01:16, 15.28s/it]
Task 5, Epoch 16/20 => Loss 0.118, Train_accy 96.60:  75%|███████▌  | 15/20 [03:26<01:16, 15.28s/it]                 
Task 5, Epoch 16/20 => Loss 0.118, Train_accy 96.60:  80%|████████  | 16/20 [03:26<00:55, 13.80s/it]
Task 5, Epoch 17/20 => Loss 0.131, Train_accy 96.49:  80%|████████  | 16/20 [03:36<00:55, 13.80s/it]
Task 5, Epoch 17/20 => Loss 0.131, Train_accy 96.49:  85%|████████▌ | 17/20 [03:36<00:38, 12.76s/it]
Task 5, Epoch 18/20 => Loss 0.146, Train_accy 95.39:  85%|████████▌ | 17/20 [03:47<00:38, 12.76s/it]
Task 5, Epoch 18/20 => Loss 0.146, Train_accy 95.39:  90%|█████████ | 18/20 [03:47<00:24, 12.03s/it]
Task 5, Epoch 19/20 => Loss 0.118, Train_accy 96.49:  90%|█████████ | 18/20 [03:57<00:24, 12.03s/it]
Task 5, Epoch 19/20 => Loss 0.118, Train_accy 96.49:  95%|█████████▌| 19/20 [03:57<00:11, 11.52s/it]
Task 5, Epoch 20/20 => Loss 0.090, Train_accy 97.26, Test_accy 70.74:  95%|█████████▌| 19/20 [04:21<00:11, 11.52s/it]
Task 5, Epoch 20/20 => Loss 0.090, Train_accy 97.26, Test_accy 70.74: 100%|██████████| 20/20 [04:21<00:00, 15.26s/it]
Task 5, Epoch 20/20 => Loss 0.090, Train_accy 97.26, Test_accy 70.74: 100%|██████████| 20/20 [04:21<00:00, 13.08s/it]
2024-09-06 02:21:45,297 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.090, Train_accy 97.26, Test_accy 70.74
2024-09-06 02:21:58,940 [trainer.py] => No NME accuracy.
2024-09-06 02:21:58,941 [trainer.py] => CNN: {'total': 70.74, '00-99': 91.25, '100-119': 47.37, '120-139': 51.11, '140-159': 50.0, '160-179': 55.27, '180-199': 45.65, 'old': 73.45, 'new': 45.65}
2024-09-06 02:21:58,941 [trainer.py] => CNN top1 curve: [91.75, 85.03, 80.32, 75.99, 73.78, 70.74]
2024-09-06 02:21:58,941 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.54, 98.68, 98.31, 97.54]

Average Accuracy (CNN): 79.6
2024-09-06 02:21:58,942 [trainer.py] => Average Accuracy (CNN): 79.6 

Accuracy Matrix (CNN):
[[91.75 91.92 91.67 91.67 91.41 91.25]
 [ 0.   49.12 49.56 46.49 47.37 47.37]
 [ 0.    0.   51.56 51.56 52.   51.11]
 [ 0.    0.    0.   50.4  50.   50.  ]
 [ 0.    0.    0.    0.   56.54 55.27]
 [ 0.    0.    0.    0.    0.   45.65]]
2024-09-06 02:21:58,944 [trainer.py] => Forgetting (CNN): 1.0840000000000003
2024-09-06 02:22:01,546 [trainer.py] => config: ./exps/coda_prompt_cub_B100_Inc10.json
2024-09-06 02:22:01,546 [trainer.py] => prefix:  
2024-09-06 02:22:01,546 [trainer.py] => dataset: cub
2024-09-06 02:22:01,546 [trainer.py] => memory_size: 0
2024-09-06 02:22:01,546 [trainer.py] => memory_per_class: 0
2024-09-06 02:22:01,546 [trainer.py] => fixed_memory: False
2024-09-06 02:22:01,546 [trainer.py] => shuffle: True
2024-09-06 02:22:01,546 [trainer.py] => init_cls: 100
2024-09-06 02:22:01,547 [trainer.py] => increment: 10
2024-09-06 02:22:01,547 [trainer.py] => model_name: coda_prompt
2024-09-06 02:22:01,547 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-06 02:22:01,547 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 02:22:01,547 [trainer.py] => seed: 1993
2024-09-06 02:22:01,547 [trainer.py] => tuned_epoch: 20
2024-09-06 02:22:01,547 [trainer.py] => init_lr: 0.001
2024-09-06 02:22:01,547 [trainer.py] => batch_size: 48
2024-09-06 02:22:01,547 [trainer.py] => weight_decay: 0
2024-09-06 02:22:01,547 [trainer.py] => min_lr: 1e-05
2024-09-06 02:22:01,547 [trainer.py] => optimizer: adam
2024-09-06 02:22:01,547 [trainer.py] => scheduler: cosine
2024-09-06 02:22:01,547 [trainer.py] => reinit_optimizer: True
2024-09-06 02:22:01,547 [trainer.py] => pretrained: True
2024-09-06 02:22:01,547 [trainer.py] => drop: 0.0
2024-09-06 02:22:01,547 [trainer.py] => drop_path: 0.0
2024-09-06 02:22:01,547 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-06 02:22:01,583 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-09-06 02:22:03,347 [coda_prompt.py] => 89,792,456 total parameters.
2024-09-06 02:22:03,347 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-09-06 02:22:03,348 [trainer.py] => All params: 89792456
2024-09-06 02:22:03,348 [trainer.py] => Trainable params: 89792456
2024-09-06 02:22:03,348 [coda_prompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.486, Train_accy 66.17:   0%|          | 0/20 [00:51<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.486, Train_accy 66.17:   5%|▌         | 1/20 [00:51<16:09, 51.04s/it]
Task 0, Epoch 2/20 => Loss 0.535, Train_accy 86.00:   5%|▌         | 1/20 [01:41<16:09, 51.04s/it]
Task 0, Epoch 2/20 => Loss 0.535, Train_accy 86.00:  10%|█         | 2/20 [01:41<15:15, 50.89s/it]
Task 0, Epoch 3/20 => Loss 0.434, Train_accy 87.93:  10%|█         | 2/20 [02:32<15:15, 50.89s/it]
Task 0, Epoch 3/20 => Loss 0.434, Train_accy 87.93:  15%|█▌        | 3/20 [02:32<14:24, 50.86s/it]
Task 0, Epoch 4/20 => Loss 0.390, Train_accy 89.30:  15%|█▌        | 3/20 [03:23<14:24, 50.86s/it]
Task 0, Epoch 4/20 => Loss 0.390, Train_accy 89.30:  20%|██        | 4/20 [03:23<13:33, 50.83s/it]
Task 0, Epoch 5/20 => Loss 0.365, Train_accy 90.34, Test_accy 90.57:  20%|██        | 4/20 [04:21<13:33, 50.83s/it]
Task 0, Epoch 5/20 => Loss 0.365, Train_accy 90.34, Test_accy 90.57:  25%|██▌       | 5/20 [04:21<13:20, 53.37s/it]
Task 0, Epoch 6/20 => Loss 0.328, Train_accy 90.98:  25%|██▌       | 5/20 [05:12<13:20, 53.37s/it]                 
Task 0, Epoch 6/20 => Loss 0.328, Train_accy 90.98:  30%|███       | 6/20 [05:12<12:14, 52.50s/it]
Task 0, Epoch 7/20 => Loss 0.318, Train_accy 90.89:  30%|███       | 6/20 [06:02<12:14, 52.50s/it]
Task 0, Epoch 7/20 => Loss 0.318, Train_accy 90.89:  35%|███▌      | 7/20 [06:02<11:15, 51.95s/it]
Task 0, Epoch 8/20 => Loss 0.309, Train_accy 91.32:  35%|███▌      | 7/20 [06:53<11:15, 51.95s/it]
Task 0, Epoch 8/20 => Loss 0.309, Train_accy 91.32:  40%|████      | 8/20 [06:53<10:19, 51.59s/it]
Task 0, Epoch 9/20 => Loss 0.270, Train_accy 92.68:  40%|████      | 8/20 [07:44<10:19, 51.59s/it]
Task 0, Epoch 9/20 => Loss 0.270, Train_accy 92.68:  45%|████▌     | 9/20 [07:44<09:24, 51.34s/it]
Task 0, Epoch 10/20 => Loss 0.271, Train_accy 92.80, Test_accy 91.33:  45%|████▌     | 9/20 [08:42<09:24, 51.34s/it]
Task 0, Epoch 10/20 => Loss 0.271, Train_accy 92.80, Test_accy 91.33:  50%|█████     | 10/20 [08:42<08:53, 53.37s/it]
Task 0, Epoch 11/20 => Loss 0.272, Train_accy 92.78:  50%|█████     | 10/20 [09:33<08:53, 53.37s/it]                 
Task 0, Epoch 11/20 => Loss 0.272, Train_accy 92.78:  55%|█████▌    | 11/20 [09:33<07:53, 52.57s/it]
Task 0, Epoch 12/20 => Loss 0.236, Train_accy 93.64:  55%|█████▌    | 11/20 [10:24<07:53, 52.57s/it]
Task 0, Epoch 12/20 => Loss 0.236, Train_accy 93.64:  60%|██████    | 12/20 [10:24<06:56, 52.03s/it]
Task 0, Epoch 13/20 => Loss 0.229, Train_accy 94.14:  60%|██████    | 12/20 [11:14<06:56, 52.03s/it]
Task 0, Epoch 13/20 => Loss 0.229, Train_accy 94.14:  65%|██████▌   | 13/20 [11:14<06:01, 51.66s/it]
Task 0, Epoch 14/20 => Loss 0.225, Train_accy 93.94:  65%|██████▌   | 13/20 [12:05<06:01, 51.66s/it]
Task 0, Epoch 14/20 => Loss 0.225, Train_accy 93.94:  70%|███████   | 14/20 [12:05<05:08, 51.40s/it]
Task 0, Epoch 15/20 => Loss 0.184, Train_accy 95.08, Test_accy 91.84:  70%|███████   | 14/20 [13:03<05:08, 51.40s/it]
Task 0, Epoch 15/20 => Loss 0.184, Train_accy 95.08, Test_accy 91.84:  75%|███████▌  | 15/20 [13:03<04:26, 53.34s/it]
Task 0, Epoch 16/20 => Loss 0.232, Train_accy 94.01:  75%|███████▌  | 15/20 [13:54<04:26, 53.34s/it]                 
Task 0, Epoch 16/20 => Loss 0.232, Train_accy 94.01:  80%|████████  | 16/20 [13:54<03:30, 52.57s/it]
Task 0, Epoch 17/20 => Loss 0.219, Train_accy 93.96:  80%|████████  | 16/20 [14:45<03:30, 52.57s/it]
Task 0, Epoch 17/20 => Loss 0.219, Train_accy 93.96:  85%|████████▌ | 17/20 [14:45<02:36, 52.04s/it]
Task 0, Epoch 18/20 => Loss 0.202, Train_accy 94.59:  85%|████████▌ | 17/20 [15:35<02:36, 52.04s/it]
Task 0, Epoch 18/20 => Loss 0.202, Train_accy 94.59:  90%|█████████ | 18/20 [15:35<01:43, 51.67s/it]
Task 0, Epoch 19/20 => Loss 0.202, Train_accy 94.27:  90%|█████████ | 18/20 [16:26<01:43, 51.67s/it]
Task 0, Epoch 19/20 => Loss 0.202, Train_accy 94.27:  95%|█████████▌| 19/20 [16:26<00:51, 51.41s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 94.74, Test_accy 91.92:  95%|█████████▌| 19/20 [17:24<00:51, 51.41s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 94.74, Test_accy 91.92: 100%|██████████| 20/20 [17:24<00:00, 53.36s/it]
Task 0, Epoch 20/20 => Loss 0.203, Train_accy 94.74, Test_accy 91.92: 100%|██████████| 20/20 [17:24<00:00, 52.23s/it]
2024-09-06 02:39:28,361 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.203, Train_accy 94.74, Test_accy 91.92
2024-09-06 02:39:35,427 [trainer.py] => No NME accuracy.
2024-09-06 02:39:35,428 [trainer.py] => CNN: {'total': 91.92, '00-99': 91.92, 'old': 0, 'new': 91.92}
2024-09-06 02:39:35,428 [trainer.py] => CNN top1 curve: [91.92]
2024-09-06 02:39:35,428 [trainer.py] => CNN top5 curve: [99.07]

Average Accuracy (CNN): 91.92
2024-09-06 02:39:35,429 [trainer.py] => Average Accuracy (CNN): 91.92 

2024-09-06 02:39:35,430 [trainer.py] => All params: 89792456
2024-09-06 02:39:35,432 [trainer.py] => Trainable params: 89792456
2024-09-06 02:39:35,692 [coda_prompt.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.393, Train_accy 55.83:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.393, Train_accy 55.83:   5%|▌         | 1/20 [00:05<01:45,  5.54s/it]
Task 1, Epoch 2/20 => Loss 0.195, Train_accy 94.17:   5%|▌         | 1/20 [00:11<01:45,  5.54s/it]
Task 1, Epoch 2/20 => Loss 0.195, Train_accy 94.17:  10%|█         | 2/20 [00:11<01:39,  5.55s/it]
Task 1, Epoch 3/20 => Loss 0.117, Train_accy 95.83:  10%|█         | 2/20 [00:16<01:39,  5.55s/it]
Task 1, Epoch 3/20 => Loss 0.117, Train_accy 95.83:  15%|█▌        | 3/20 [00:16<01:34,  5.56s/it]
Task 1, Epoch 4/20 => Loss 0.104, Train_accy 97.08:  15%|█▌        | 3/20 [00:22<01:34,  5.56s/it]
Task 1, Epoch 4/20 => Loss 0.104, Train_accy 97.08:  20%|██        | 4/20 [00:22<01:28,  5.56s/it]
Task 1, Epoch 5/20 => Loss 0.124, Train_accy 96.25, Test_accy 88.33:  20%|██        | 4/20 [00:35<01:28,  5.56s/it]
Task 1, Epoch 5/20 => Loss 0.124, Train_accy 96.25, Test_accy 88.33:  25%|██▌       | 5/20 [00:35<02:05,  8.34s/it]
Task 1, Epoch 6/20 => Loss 0.126, Train_accy 95.42:  25%|██▌       | 5/20 [00:41<02:05,  8.34s/it]                 
Task 1, Epoch 6/20 => Loss 0.126, Train_accy 95.42:  30%|███       | 6/20 [00:41<01:44,  7.44s/it]
Task 1, Epoch 7/20 => Loss 0.084, Train_accy 97.50:  30%|███       | 6/20 [00:46<01:44,  7.44s/it]
Task 1, Epoch 7/20 => Loss 0.084, Train_accy 97.50:  35%|███▌      | 7/20 [00:46<01:28,  6.83s/it]
Task 1, Epoch 8/20 => Loss 0.073, Train_accy 98.33:  35%|███▌      | 7/20 [00:52<01:28,  6.83s/it]
Task 1, Epoch 8/20 => Loss 0.073, Train_accy 98.33:  40%|████      | 8/20 [00:52<01:17,  6.44s/it]
Task 1, Epoch 9/20 => Loss 0.107, Train_accy 96.25:  40%|████      | 8/20 [00:57<01:17,  6.44s/it]
Task 1, Epoch 9/20 => Loss 0.107, Train_accy 96.25:  45%|████▌     | 9/20 [00:57<01:07,  6.18s/it]
Task 1, Epoch 10/20 => Loss 0.073, Train_accy 97.29, Test_accy 88.33:  45%|████▌     | 9/20 [01:11<01:07,  6.18s/it]
Task 1, Epoch 10/20 => Loss 0.073, Train_accy 97.29, Test_accy 88.33:  50%|█████     | 10/20 [01:11<01:23,  8.38s/it]
Task 1, Epoch 11/20 => Loss 0.094, Train_accy 96.88:  50%|█████     | 10/20 [01:16<01:23,  8.38s/it]                 
Task 1, Epoch 11/20 => Loss 0.094, Train_accy 96.88:  55%|█████▌    | 11/20 [01:16<01:07,  7.53s/it]
Task 1, Epoch 12/20 => Loss 0.081, Train_accy 97.29:  55%|█████▌    | 11/20 [01:22<01:07,  7.53s/it]
Task 1, Epoch 12/20 => Loss 0.081, Train_accy 97.29:  60%|██████    | 12/20 [01:22<00:55,  6.93s/it]
Task 1, Epoch 13/20 => Loss 0.110, Train_accy 95.83:  60%|██████    | 12/20 [01:28<00:55,  6.93s/it]
Task 1, Epoch 13/20 => Loss 0.110, Train_accy 95.83:  65%|██████▌   | 13/20 [01:28<00:45,  6.54s/it]
Task 1, Epoch 14/20 => Loss 0.082, Train_accy 97.50:  65%|██████▌   | 13/20 [01:33<00:45,  6.54s/it]
Task 1, Epoch 14/20 => Loss 0.082, Train_accy 97.50:  70%|███████   | 14/20 [01:33<00:37,  6.25s/it]
Task 1, Epoch 15/20 => Loss 0.075, Train_accy 97.29, Test_accy 88.26:  70%|███████   | 14/20 [01:46<00:37,  6.25s/it]
Task 1, Epoch 15/20 => Loss 0.075, Train_accy 97.29, Test_accy 88.26:  75%|███████▌  | 15/20 [01:46<00:41,  8.38s/it]
Task 1, Epoch 16/20 => Loss 0.075, Train_accy 97.71:  75%|███████▌  | 15/20 [01:52<00:41,  8.38s/it]                 
Task 1, Epoch 16/20 => Loss 0.075, Train_accy 97.71:  80%|████████  | 16/20 [01:52<00:30,  7.53s/it]
Task 1, Epoch 17/20 => Loss 0.075, Train_accy 98.12:  80%|████████  | 16/20 [01:58<00:30,  7.53s/it]
Task 1, Epoch 17/20 => Loss 0.075, Train_accy 98.12:  85%|████████▌ | 17/20 [01:58<00:20,  6.94s/it]
Task 1, Epoch 18/20 => Loss 0.086, Train_accy 96.25:  85%|████████▌ | 17/20 [02:03<00:20,  6.94s/it]
Task 1, Epoch 18/20 => Loss 0.086, Train_accy 96.25:  90%|█████████ | 18/20 [02:03<00:13,  6.54s/it]
Task 1, Epoch 19/20 => Loss 0.064, Train_accy 98.12:  90%|█████████ | 18/20 [02:09<00:13,  6.54s/it]
Task 1, Epoch 19/20 => Loss 0.064, Train_accy 98.12:  95%|█████████▌| 19/20 [02:09<00:06,  6.25s/it]
Task 1, Epoch 20/20 => Loss 0.056, Train_accy 98.12, Test_accy 88.18:  95%|█████████▌| 19/20 [02:22<00:06,  6.25s/it]
Task 1, Epoch 20/20 => Loss 0.056, Train_accy 98.12, Test_accy 88.18: 100%|██████████| 20/20 [02:22<00:00,  8.36s/it]
Task 1, Epoch 20/20 => Loss 0.056, Train_accy 98.12, Test_accy 88.18: 100%|██████████| 20/20 [02:22<00:00,  7.13s/it]
2024-09-06 02:41:58,261 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.056, Train_accy 98.12, Test_accy 88.18
2024-09-06 02:42:05,982 [trainer.py] => No NME accuracy.
2024-09-06 02:42:05,982 [trainer.py] => CNN: {'total': 88.18, '00-99': 91.67, '100-109': 52.17, 'old': 91.67, 'new': 52.17}
2024-09-06 02:42:05,983 [trainer.py] => CNN top1 curve: [91.92, 88.18]
2024-09-06 02:42:05,983 [trainer.py] => CNN top5 curve: [99.07, 98.77]

Average Accuracy (CNN): 90.05
2024-09-06 02:42:05,983 [trainer.py] => Average Accuracy (CNN): 90.05 

2024-09-06 02:42:05,984 [trainer.py] => All params: 89792456
2024-09-06 02:42:05,985 [trainer.py] => Trainable params: 89792456
2024-09-06 02:42:06,389 [coda_prompt.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.004, Train_accy 42.36:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.004, Train_accy 42.36:   5%|▌         | 1/20 [00:05<01:36,  5.06s/it]
Task 2, Epoch 2/20 => Loss 0.271, Train_accy 92.36:   5%|▌         | 1/20 [00:10<01:36,  5.06s/it]
Task 2, Epoch 2/20 => Loss 0.271, Train_accy 92.36:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 2, Epoch 3/20 => Loss 0.153, Train_accy 95.14:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 2, Epoch 3/20 => Loss 0.153, Train_accy 95.14:  15%|█▌        | 3/20 [00:15<01:26,  5.09s/it]
Task 2, Epoch 4/20 => Loss 0.139, Train_accy 95.37:  15%|█▌        | 3/20 [00:20<01:26,  5.09s/it]
Task 2, Epoch 4/20 => Loss 0.139, Train_accy 95.37:  20%|██        | 4/20 [00:20<01:20,  5.05s/it]
Task 2, Epoch 5/20 => Loss 0.104, Train_accy 96.06, Test_accy 83.26:  20%|██        | 4/20 [00:33<01:20,  5.05s/it]
Task 2, Epoch 5/20 => Loss 0.104, Train_accy 96.06, Test_accy 83.26:  25%|██▌       | 5/20 [00:33<02:01,  8.07s/it]
Task 2, Epoch 6/20 => Loss 0.070, Train_accy 98.15:  25%|██▌       | 5/20 [00:38<02:01,  8.07s/it]                 
Task 2, Epoch 6/20 => Loss 0.070, Train_accy 98.15:  30%|███       | 6/20 [00:38<01:38,  7.05s/it]
Task 2, Epoch 7/20 => Loss 0.090, Train_accy 97.92:  30%|███       | 6/20 [00:43<01:38,  7.05s/it]
Task 2, Epoch 7/20 => Loss 0.090, Train_accy 97.92:  35%|███▌      | 7/20 [00:43<01:23,  6.42s/it]
Task 2, Epoch 8/20 => Loss 0.093, Train_accy 97.22:  35%|███▌      | 7/20 [00:48<01:23,  6.42s/it]
Task 2, Epoch 8/20 => Loss 0.093, Train_accy 97.22:  40%|████      | 8/20 [00:48<01:11,  5.99s/it]
Task 2, Epoch 9/20 => Loss 0.077, Train_accy 98.15:  40%|████      | 8/20 [00:53<01:11,  5.99s/it]
Task 2, Epoch 9/20 => Loss 0.077, Train_accy 98.15:  45%|████▌     | 9/20 [00:53<01:02,  5.70s/it]
Task 2, Epoch 10/20 => Loss 0.080, Train_accy 98.15, Test_accy 83.40:  45%|████▌     | 9/20 [01:07<01:02,  5.70s/it]
Task 2, Epoch 10/20 => Loss 0.080, Train_accy 98.15, Test_accy 83.40:  50%|█████     | 10/20 [01:07<01:21,  8.10s/it]
Task 2, Epoch 11/20 => Loss 0.100, Train_accy 96.76:  50%|█████     | 10/20 [01:12<01:21,  8.10s/it]                 
Task 2, Epoch 11/20 => Loss 0.100, Train_accy 96.76:  55%|█████▌    | 11/20 [01:12<01:04,  7.17s/it]
Task 2, Epoch 12/20 => Loss 0.060, Train_accy 98.38:  55%|█████▌    | 11/20 [01:17<01:04,  7.17s/it]
Task 2, Epoch 12/20 => Loss 0.060, Train_accy 98.38:  60%|██████    | 12/20 [01:17<00:52,  6.53s/it]
Task 2, Epoch 13/20 => Loss 0.099, Train_accy 96.99:  60%|██████    | 12/20 [01:22<00:52,  6.53s/it]
Task 2, Epoch 13/20 => Loss 0.099, Train_accy 96.99:  65%|██████▌   | 13/20 [01:22<00:42,  6.09s/it]
Task 2, Epoch 14/20 => Loss 0.089, Train_accy 97.69:  65%|██████▌   | 13/20 [01:27<00:42,  6.09s/it]
Task 2, Epoch 14/20 => Loss 0.089, Train_accy 97.69:  70%|███████   | 14/20 [01:27<00:34,  5.79s/it]
Task 2, Epoch 15/20 => Loss 0.050, Train_accy 98.38, Test_accy 83.55:  70%|███████   | 14/20 [01:41<00:34,  5.79s/it]
Task 2, Epoch 15/20 => Loss 0.050, Train_accy 98.38, Test_accy 83.55:  75%|███████▌  | 15/20 [01:41<00:40,  8.07s/it]
Task 2, Epoch 16/20 => Loss 0.053, Train_accy 99.31:  75%|███████▌  | 15/20 [01:46<00:40,  8.07s/it]                 
Task 2, Epoch 16/20 => Loss 0.053, Train_accy 99.31:  80%|████████  | 16/20 [01:46<00:28,  7.16s/it]
Task 2, Epoch 17/20 => Loss 0.072, Train_accy 97.92:  80%|████████  | 16/20 [01:51<00:28,  7.16s/it]
Task 2, Epoch 17/20 => Loss 0.072, Train_accy 97.92:  85%|████████▌ | 17/20 [01:51<00:19,  6.53s/it]
Task 2, Epoch 18/20 => Loss 0.062, Train_accy 97.69:  85%|████████▌ | 17/20 [01:56<00:19,  6.53s/it]
Task 2, Epoch 18/20 => Loss 0.062, Train_accy 97.69:  90%|█████████ | 18/20 [01:56<00:12,  6.08s/it]
Task 2, Epoch 19/20 => Loss 0.065, Train_accy 98.15:  90%|█████████ | 18/20 [02:01<00:12,  6.08s/it]
Task 2, Epoch 19/20 => Loss 0.065, Train_accy 98.15:  95%|█████████▌| 19/20 [02:01<00:05,  5.77s/it]
Task 2, Epoch 20/20 => Loss 0.084, Train_accy 96.99, Test_accy 83.55:  95%|█████████▌| 19/20 [02:14<00:05,  5.77s/it]
Task 2, Epoch 20/20 => Loss 0.084, Train_accy 96.99, Test_accy 83.55: 100%|██████████| 20/20 [02:14<00:00,  8.07s/it]
Task 2, Epoch 20/20 => Loss 0.084, Train_accy 96.99, Test_accy 83.55: 100%|██████████| 20/20 [02:14<00:00,  6.74s/it]
2024-09-06 02:44:21,140 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.084, Train_accy 96.99, Test_accy 83.55
2024-09-06 02:44:29,470 [trainer.py] => No NME accuracy.
2024-09-06 02:44:29,471 [trainer.py] => CNN: {'total': 83.55, '00-99': 91.75, '100-109': 53.04, '110-119': 28.32, 'old': 88.33, 'new': 28.32}
2024-09-06 02:44:29,471 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55]
2024-09-06 02:44:29,471 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66]

Average Accuracy (CNN): 87.88
2024-09-06 02:44:29,471 [trainer.py] => Average Accuracy (CNN): 87.88 

2024-09-06 02:44:29,472 [trainer.py] => All params: 89792456
2024-09-06 02:44:29,473 [trainer.py] => Trainable params: 89792456
2024-09-06 02:44:30,027 [coda_prompt.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.578, Train_accy 51.88:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.578, Train_accy 51.88:   5%|▌         | 1/20 [00:05<01:47,  5.64s/it]
Task 3, Epoch 2/20 => Loss 0.361, Train_accy 87.71:   5%|▌         | 1/20 [00:11<01:47,  5.64s/it]
Task 3, Epoch 2/20 => Loss 0.361, Train_accy 87.71:  10%|█         | 2/20 [00:11<01:40,  5.60s/it]
Task 3, Epoch 3/20 => Loss 0.234, Train_accy 90.21:  10%|█         | 2/20 [00:16<01:40,  5.60s/it]
Task 3, Epoch 3/20 => Loss 0.234, Train_accy 90.21:  15%|█▌        | 3/20 [00:16<01:35,  5.59s/it]
Task 3, Epoch 4/20 => Loss 0.204, Train_accy 92.50:  15%|█▌        | 3/20 [00:22<01:35,  5.59s/it]
Task 3, Epoch 4/20 => Loss 0.204, Train_accy 92.50:  20%|██        | 4/20 [00:22<01:29,  5.58s/it]
Task 3, Epoch 5/20 => Loss 0.172, Train_accy 94.58, Test_accy 80.43:  20%|██        | 4/20 [00:36<01:29,  5.58s/it]
Task 3, Epoch 5/20 => Loss 0.172, Train_accy 94.58, Test_accy 80.43:  25%|██▌       | 5/20 [00:36<02:12,  8.83s/it]
Task 3, Epoch 6/20 => Loss 0.157, Train_accy 93.96:  25%|██▌       | 5/20 [00:42<02:12,  8.83s/it]                 
Task 3, Epoch 6/20 => Loss 0.157, Train_accy 93.96:  30%|███       | 6/20 [00:42<01:48,  7.73s/it]
Task 3, Epoch 7/20 => Loss 0.198, Train_accy 92.71:  30%|███       | 6/20 [00:48<01:48,  7.73s/it]
Task 3, Epoch 7/20 => Loss 0.198, Train_accy 92.71:  35%|███▌      | 7/20 [00:48<01:31,  7.03s/it]
Task 3, Epoch 8/20 => Loss 0.145, Train_accy 95.62:  35%|███▌      | 7/20 [00:53<01:31,  7.03s/it]
Task 3, Epoch 8/20 => Loss 0.145, Train_accy 95.62:  40%|████      | 8/20 [00:53<01:18,  6.57s/it]
Task 3, Epoch 9/20 => Loss 0.137, Train_accy 96.04:  40%|████      | 8/20 [00:59<01:18,  6.57s/it]
Task 3, Epoch 9/20 => Loss 0.137, Train_accy 96.04:  45%|████▌     | 9/20 [00:59<01:08,  6.27s/it]
Task 3, Epoch 10/20 => Loss 0.145, Train_accy 93.54, Test_accy 80.76:  45%|████▌     | 9/20 [01:13<01:08,  6.27s/it]
Task 3, Epoch 10/20 => Loss 0.145, Train_accy 93.54, Test_accy 80.76:  50%|█████     | 10/20 [01:13<01:27,  8.80s/it]
Task 3, Epoch 11/20 => Loss 0.114, Train_accy 96.46:  50%|█████     | 10/20 [01:19<01:27,  8.80s/it]                 
Task 3, Epoch 11/20 => Loss 0.114, Train_accy 96.46:  55%|█████▌    | 11/20 [01:19<01:10,  7.82s/it]
Task 3, Epoch 12/20 => Loss 0.157, Train_accy 95.83:  55%|█████▌    | 11/20 [01:24<01:10,  7.82s/it]
Task 3, Epoch 12/20 => Loss 0.157, Train_accy 95.83:  60%|██████    | 12/20 [01:24<00:57,  7.14s/it]
Task 3, Epoch 13/20 => Loss 0.146, Train_accy 95.21:  60%|██████    | 12/20 [01:30<00:57,  7.14s/it]
Task 3, Epoch 13/20 => Loss 0.146, Train_accy 95.21:  65%|██████▌   | 13/20 [01:30<00:46,  6.67s/it]
Task 3, Epoch 14/20 => Loss 0.097, Train_accy 96.88:  65%|██████▌   | 13/20 [01:36<00:46,  6.67s/it]
Task 3, Epoch 14/20 => Loss 0.097, Train_accy 96.88:  70%|███████   | 14/20 [01:36<00:38,  6.35s/it]
Task 3, Epoch 15/20 => Loss 0.139, Train_accy 96.04, Test_accy 80.96:  70%|███████   | 14/20 [01:50<00:38,  6.35s/it]
Task 3, Epoch 15/20 => Loss 0.139, Train_accy 96.04, Test_accy 80.96:  75%|███████▌  | 15/20 [01:50<00:44,  8.82s/it]
Task 3, Epoch 16/20 => Loss 0.124, Train_accy 96.25:  75%|███████▌  | 15/20 [01:56<00:44,  8.82s/it]                 
Task 3, Epoch 16/20 => Loss 0.124, Train_accy 96.25:  80%|████████  | 16/20 [01:56<00:31,  7.85s/it]
Task 3, Epoch 17/20 => Loss 0.118, Train_accy 96.67:  80%|████████  | 16/20 [02:01<00:31,  7.85s/it]
Task 3, Epoch 17/20 => Loss 0.118, Train_accy 96.67:  85%|████████▌ | 17/20 [02:01<00:21,  7.17s/it]
Task 3, Epoch 18/20 => Loss 0.096, Train_accy 97.71:  85%|████████▌ | 17/20 [02:07<00:21,  7.17s/it]
Task 3, Epoch 18/20 => Loss 0.096, Train_accy 97.71:  90%|█████████ | 18/20 [02:07<00:13,  6.70s/it]
Task 3, Epoch 19/20 => Loss 0.122, Train_accy 95.62:  90%|█████████ | 18/20 [02:13<00:13,  6.70s/it]
Task 3, Epoch 19/20 => Loss 0.122, Train_accy 95.62:  95%|█████████▌| 19/20 [02:13<00:06,  6.36s/it]
Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.46, Test_accy 80.76:  95%|█████████▌| 19/20 [02:27<00:06,  6.36s/it]
Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.46, Test_accy 80.76: 100%|██████████| 20/20 [02:27<00:00,  8.82s/it]
Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.46, Test_accy 80.76: 100%|██████████| 20/20 [02:27<00:00,  7.38s/it]
2024-09-06 02:46:57,652 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.46, Test_accy 80.76
2024-09-06 02:47:06,565 [trainer.py] => No NME accuracy.
2024-09-06 02:47:06,566 [trainer.py] => CNN: {'total': 80.76, '00-99': 91.92, '100-109': 53.04, '110-119': 28.32, '120-129': 42.06, 'old': 83.69, 'new': 42.06}
2024-09-06 02:47:06,566 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76]
2024-09-06 02:47:06,567 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49]

Average Accuracy (CNN): 86.1
2024-09-06 02:47:06,567 [trainer.py] => Average Accuracy (CNN): 86.1 

2024-09-06 02:47:06,568 [trainer.py] => All params: 89792456
2024-09-06 02:47:06,570 [trainer.py] => Trainable params: 89792456
2024-09-06 02:47:07,349 [coda_prompt.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.539, Train_accy 53.24:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.539, Train_accy 53.24:   5%|▌         | 1/20 [00:05<01:35,  5.05s/it]
Task 4, Epoch 2/20 => Loss 0.410, Train_accy 86.34:   5%|▌         | 1/20 [00:10<01:35,  5.05s/it]
Task 4, Epoch 2/20 => Loss 0.410, Train_accy 86.34:  10%|█         | 2/20 [00:10<01:30,  5.05s/it]
Task 4, Epoch 3/20 => Loss 0.190, Train_accy 93.52:  10%|█         | 2/20 [00:15<01:30,  5.05s/it]
Task 4, Epoch 3/20 => Loss 0.190, Train_accy 93.52:  15%|█▌        | 3/20 [00:15<01:25,  5.05s/it]
Task 4, Epoch 4/20 => Loss 0.179, Train_accy 93.52:  15%|█▌        | 3/20 [00:20<01:25,  5.05s/it]
Task 4, Epoch 4/20 => Loss 0.179, Train_accy 93.52:  20%|██        | 4/20 [00:20<01:20,  5.05s/it]
Task 4, Epoch 5/20 => Loss 0.159, Train_accy 93.75, Test_accy 76.97:  20%|██        | 4/20 [00:34<01:20,  5.05s/it]
Task 4, Epoch 5/20 => Loss 0.159, Train_accy 93.75, Test_accy 76.97:  25%|██▌       | 5/20 [00:34<02:07,  8.49s/it]
Task 4, Epoch 6/20 => Loss 0.158, Train_accy 95.14:  25%|██▌       | 5/20 [00:39<02:07,  8.49s/it]                 
Task 4, Epoch 6/20 => Loss 0.158, Train_accy 95.14:  30%|███       | 6/20 [00:39<01:42,  7.32s/it]
Task 4, Epoch 7/20 => Loss 0.119, Train_accy 96.06:  30%|███       | 6/20 [00:44<01:42,  7.32s/it]
Task 4, Epoch 7/20 => Loss 0.119, Train_accy 96.06:  35%|███▌      | 7/20 [00:44<01:25,  6.57s/it]
Task 4, Epoch 8/20 => Loss 0.166, Train_accy 93.75:  35%|███▌      | 7/20 [00:49<01:25,  6.57s/it]
Task 4, Epoch 8/20 => Loss 0.166, Train_accy 93.75:  40%|████      | 8/20 [00:49<01:13,  6.08s/it]
Task 4, Epoch 9/20 => Loss 0.138, Train_accy 95.83:  40%|████      | 8/20 [00:54<01:13,  6.08s/it]
Task 4, Epoch 9/20 => Loss 0.138, Train_accy 95.83:  45%|████▌     | 9/20 [00:54<01:03,  5.76s/it]
Task 4, Epoch 10/20 => Loss 0.124, Train_accy 95.60, Test_accy 77.39:  45%|████▌     | 9/20 [01:09<01:03,  5.76s/it]
Task 4, Epoch 10/20 => Loss 0.124, Train_accy 95.60, Test_accy 77.39:  50%|█████     | 10/20 [01:09<01:25,  8.50s/it]
Task 4, Epoch 11/20 => Loss 0.108, Train_accy 96.99:  50%|█████     | 10/20 [01:14<01:25,  8.50s/it]                 
Task 4, Epoch 11/20 => Loss 0.108, Train_accy 96.99:  55%|█████▌    | 11/20 [01:14<01:06,  7.44s/it]
Task 4, Epoch 12/20 => Loss 0.092, Train_accy 97.45:  55%|█████▌    | 11/20 [01:19<01:06,  7.44s/it]
Task 4, Epoch 12/20 => Loss 0.092, Train_accy 97.45:  60%|██████    | 12/20 [01:19<00:53,  6.71s/it]
Task 4, Epoch 13/20 => Loss 0.087, Train_accy 97.69:  60%|██████    | 12/20 [01:24<00:53,  6.71s/it]
Task 4, Epoch 13/20 => Loss 0.087, Train_accy 97.69:  65%|██████▌   | 13/20 [01:24<00:43,  6.21s/it]
Task 4, Epoch 14/20 => Loss 0.145, Train_accy 94.68:  65%|██████▌   | 13/20 [01:29<00:43,  6.21s/it]
Task 4, Epoch 14/20 => Loss 0.145, Train_accy 94.68:  70%|███████   | 14/20 [01:29<00:35,  5.85s/it]
Task 4, Epoch 15/20 => Loss 0.109, Train_accy 96.53, Test_accy 77.70:  70%|███████   | 14/20 [01:44<00:35,  5.85s/it]
Task 4, Epoch 15/20 => Loss 0.109, Train_accy 96.53, Test_accy 77.70:  75%|███████▌  | 15/20 [01:44<00:42,  8.49s/it]
Task 4, Epoch 16/20 => Loss 0.155, Train_accy 95.83:  75%|███████▌  | 15/20 [01:49<00:42,  8.49s/it]                 
Task 4, Epoch 16/20 => Loss 0.155, Train_accy 95.83:  80%|████████  | 16/20 [01:49<00:29,  7.45s/it]
Task 4, Epoch 17/20 => Loss 0.114, Train_accy 95.60:  80%|████████  | 16/20 [01:54<00:29,  7.45s/it]
Task 4, Epoch 17/20 => Loss 0.114, Train_accy 95.60:  85%|████████▌ | 17/20 [01:54<00:20,  6.73s/it]
Task 4, Epoch 18/20 => Loss 0.098, Train_accy 96.76:  85%|████████▌ | 17/20 [01:59<00:20,  6.73s/it]
Task 4, Epoch 18/20 => Loss 0.098, Train_accy 96.76:  90%|█████████ | 18/20 [01:59<00:12,  6.23s/it]
Task 4, Epoch 19/20 => Loss 0.088, Train_accy 96.76:  90%|█████████ | 18/20 [02:04<00:12,  6.23s/it]
Task 4, Epoch 19/20 => Loss 0.088, Train_accy 96.76:  95%|█████████▌| 19/20 [02:04<00:05,  5.88s/it]
Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.53, Test_accy 77.82:  95%|█████████▌| 19/20 [02:19<00:05,  5.88s/it]
Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.53, Test_accy 77.82: 100%|██████████| 20/20 [02:19<00:00,  8.55s/it]
Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.53, Test_accy 77.82: 100%|██████████| 20/20 [02:19<00:00,  6.97s/it]
2024-09-06 02:49:26,718 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.53, Test_accy 77.82
2024-09-06 02:49:36,384 [trainer.py] => No NME accuracy.
2024-09-06 02:49:36,385 [trainer.py] => CNN: {'total': 77.82, '00-99': 91.92, '100-109': 53.04, '110-119': 28.32, '120-129': 41.12, '130-139': 40.68, 'old': 80.7, 'new': 40.68}
2024-09-06 02:49:36,385 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76, 77.82]
2024-09-06 02:49:36,385 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49, 98.11]

Average Accuracy (CNN): 84.45
2024-09-06 02:49:36,385 [trainer.py] => Average Accuracy (CNN): 84.45 

2024-09-06 02:49:36,387 [trainer.py] => All params: 89792456
2024-09-06 02:49:36,388 [trainer.py] => Trainable params: 89792456
2024-09-06 02:49:37,236 [coda_prompt.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.851, Train_accy 48.61:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.851, Train_accy 48.61:   5%|▌         | 1/20 [00:05<01:35,  5.05s/it]
Task 5, Epoch 2/20 => Loss 0.351, Train_accy 87.96:   5%|▌         | 1/20 [00:10<01:35,  5.05s/it]
Task 5, Epoch 2/20 => Loss 0.351, Train_accy 87.96:  10%|█         | 2/20 [00:10<01:30,  5.05s/it]
Task 5, Epoch 3/20 => Loss 0.169, Train_accy 95.60:  10%|█         | 2/20 [00:15<01:30,  5.05s/it]
Task 5, Epoch 3/20 => Loss 0.169, Train_accy 95.60:  15%|█▌        | 3/20 [00:15<01:25,  5.05s/it]
Task 5, Epoch 4/20 => Loss 0.130, Train_accy 95.37:  15%|█▌        | 3/20 [00:20<01:25,  5.05s/it]
Task 5, Epoch 4/20 => Loss 0.130, Train_accy 95.37:  20%|██        | 4/20 [00:20<01:20,  5.04s/it]
Task 5, Epoch 5/20 => Loss 0.166, Train_accy 94.68, Test_accy 73.74:  20%|██        | 4/20 [00:35<01:20,  5.04s/it]
Task 5, Epoch 5/20 => Loss 0.166, Train_accy 94.68, Test_accy 73.74:  25%|██▌       | 5/20 [00:35<02:11,  8.75s/it]
Task 5, Epoch 6/20 => Loss 0.104, Train_accy 96.76:  25%|██▌       | 5/20 [00:40<02:11,  8.75s/it]                 
Task 5, Epoch 6/20 => Loss 0.104, Train_accy 96.76:  30%|███       | 6/20 [00:40<01:44,  7.50s/it]
Task 5, Epoch 7/20 => Loss 0.152, Train_accy 94.91:  30%|███       | 6/20 [00:45<01:44,  7.50s/it]
Task 5, Epoch 7/20 => Loss 0.152, Train_accy 94.91:  35%|███▌      | 7/20 [00:45<01:27,  6.70s/it]
Task 5, Epoch 8/20 => Loss 0.101, Train_accy 96.76:  35%|███▌      | 7/20 [00:50<01:27,  6.70s/it]
Task 5, Epoch 8/20 => Loss 0.101, Train_accy 96.76:  40%|████      | 8/20 [00:50<01:14,  6.19s/it]
Task 5, Epoch 9/20 => Loss 0.113, Train_accy 96.06:  40%|████      | 8/20 [00:55<01:14,  6.19s/it]
Task 5, Epoch 9/20 => Loss 0.113, Train_accy 96.06:  45%|████▌     | 9/20 [00:55<01:04,  5.84s/it]
Task 5, Epoch 10/20 => Loss 0.084, Train_accy 96.99, Test_accy 74.31:  45%|████▌     | 9/20 [01:11<01:04,  5.84s/it]
Task 5, Epoch 10/20 => Loss 0.084, Train_accy 96.99, Test_accy 74.31:  50%|█████     | 10/20 [01:11<01:27,  8.78s/it]
Task 5, Epoch 11/20 => Loss 0.108, Train_accy 96.99:  50%|█████     | 10/20 [01:16<01:27,  8.78s/it]                 
Task 5, Epoch 11/20 => Loss 0.108, Train_accy 96.99:  55%|█████▌    | 11/20 [01:16<01:08,  7.64s/it]
Task 5, Epoch 12/20 => Loss 0.102, Train_accy 96.06:  55%|█████▌    | 11/20 [01:21<01:08,  7.64s/it]
Task 5, Epoch 12/20 => Loss 0.102, Train_accy 96.06:  60%|██████    | 12/20 [01:21<00:54,  6.87s/it]
Task 5, Epoch 13/20 => Loss 0.083, Train_accy 98.15:  60%|██████    | 12/20 [01:26<00:54,  6.87s/it]
Task 5, Epoch 13/20 => Loss 0.083, Train_accy 98.15:  65%|██████▌   | 13/20 [01:26<00:44,  6.32s/it]
Task 5, Epoch 14/20 => Loss 0.092, Train_accy 97.22:  65%|██████▌   | 13/20 [01:31<00:44,  6.32s/it]
Task 5, Epoch 14/20 => Loss 0.092, Train_accy 97.22:  70%|███████   | 14/20 [01:31<00:35,  5.94s/it]
Task 5, Epoch 15/20 => Loss 0.082, Train_accy 96.99, Test_accy 74.42:  70%|███████   | 14/20 [01:46<00:35,  5.94s/it]
Task 5, Epoch 15/20 => Loss 0.082, Train_accy 96.99, Test_accy 74.42:  75%|███████▌  | 15/20 [01:46<00:43,  8.78s/it]
Task 5, Epoch 16/20 => Loss 0.126, Train_accy 95.83:  75%|███████▌  | 15/20 [01:51<00:43,  8.78s/it]                 
Task 5, Epoch 16/20 => Loss 0.126, Train_accy 95.83:  80%|████████  | 16/20 [01:51<00:30,  7.67s/it]
Task 5, Epoch 17/20 => Loss 0.106, Train_accy 96.99:  80%|████████  | 16/20 [01:56<00:30,  7.67s/it]
Task 5, Epoch 17/20 => Loss 0.106, Train_accy 96.99:  85%|████████▌ | 17/20 [01:56<00:20,  6.89s/it]
Task 5, Epoch 18/20 => Loss 0.092, Train_accy 96.99:  85%|████████▌ | 17/20 [02:02<00:20,  6.89s/it]
Task 5, Epoch 18/20 => Loss 0.092, Train_accy 96.99:  90%|█████████ | 18/20 [02:02<00:12,  6.35s/it]
Task 5, Epoch 19/20 => Loss 0.093, Train_accy 96.30:  90%|█████████ | 18/20 [02:07<00:12,  6.35s/it]
Task 5, Epoch 19/20 => Loss 0.093, Train_accy 96.30:  95%|█████████▌| 19/20 [02:07<00:05,  5.97s/it]
Task 5, Epoch 20/20 => Loss 0.103, Train_accy 96.06, Test_accy 74.36:  95%|█████████▌| 19/20 [02:22<00:05,  5.97s/it]
Task 5, Epoch 20/20 => Loss 0.103, Train_accy 96.06, Test_accy 74.36: 100%|██████████| 20/20 [02:22<00:00,  8.79s/it]
Task 5, Epoch 20/20 => Loss 0.103, Train_accy 96.06, Test_accy 74.36: 100%|██████████| 20/20 [02:22<00:00,  7.13s/it]
2024-09-06 02:51:59,746 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.103, Train_accy 96.06, Test_accy 74.36
2024-09-06 02:52:10,132 [trainer.py] => No NME accuracy.
2024-09-06 02:52:10,133 [trainer.py] => CNN: {'total': 74.36, '00-99': 91.84, '100-109': 53.04, '110-119': 28.32, '120-129': 41.12, '130-139': 38.98, '140-149': 31.75, 'old': 77.64, 'new': 31.75}
2024-09-06 02:52:10,133 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76, 77.82, 74.36]
2024-09-06 02:52:10,133 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49, 98.11, 97.91]

Average Accuracy (CNN): 82.76
2024-09-06 02:52:10,133 [trainer.py] => Average Accuracy (CNN): 82.76 

2024-09-06 02:52:10,134 [trainer.py] => All params: 89792456
2024-09-06 02:52:10,135 [trainer.py] => Trainable params: 89792456
2024-09-06 02:52:11,123 [coda_prompt.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.582, Train_accy 53.70:   0%|          | 0/20 [00:05<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.582, Train_accy 53.70:   5%|▌         | 1/20 [00:05<01:37,  5.14s/it]
Task 6, Epoch 2/20 => Loss 0.299, Train_accy 90.28:   5%|▌         | 1/20 [00:10<01:37,  5.14s/it]
Task 6, Epoch 2/20 => Loss 0.299, Train_accy 90.28:  10%|█         | 2/20 [00:10<01:32,  5.15s/it]
Task 6, Epoch 3/20 => Loss 0.242, Train_accy 91.67:  10%|█         | 2/20 [00:15<01:32,  5.15s/it]
Task 6, Epoch 3/20 => Loss 0.242, Train_accy 91.67:  15%|█▌        | 3/20 [00:15<01:26,  5.11s/it]
Task 6, Epoch 4/20 => Loss 0.147, Train_accy 95.83:  15%|█▌        | 3/20 [00:20<01:26,  5.11s/it]
Task 6, Epoch 4/20 => Loss 0.147, Train_accy 95.83:  20%|██        | 4/20 [00:20<01:21,  5.11s/it]
Task 6, Epoch 5/20 => Loss 0.176, Train_accy 95.14, Test_accy 72.08:  20%|██        | 4/20 [00:36<01:21,  5.11s/it]
Task 6, Epoch 5/20 => Loss 0.176, Train_accy 95.14, Test_accy 72.08:  25%|██▌       | 5/20 [00:36<02:15,  9.06s/it]
Task 6, Epoch 6/20 => Loss 0.166, Train_accy 93.75:  25%|██▌       | 5/20 [00:41<02:15,  9.06s/it]                 
Task 6, Epoch 6/20 => Loss 0.166, Train_accy 93.75:  30%|███       | 6/20 [00:41<01:48,  7.73s/it]
Task 6, Epoch 7/20 => Loss 0.123, Train_accy 94.44:  30%|███       | 6/20 [00:46<01:48,  7.73s/it]
Task 6, Epoch 7/20 => Loss 0.123, Train_accy 94.44:  35%|███▌      | 7/20 [00:46<01:29,  6.86s/it]
Task 6, Epoch 8/20 => Loss 0.104, Train_accy 96.99:  35%|███▌      | 7/20 [00:51<01:29,  6.86s/it]
Task 6, Epoch 8/20 => Loss 0.104, Train_accy 96.99:  40%|████      | 8/20 [00:51<01:15,  6.28s/it]
Task 6, Epoch 9/20 => Loss 0.135, Train_accy 95.14:  40%|████      | 8/20 [00:56<01:15,  6.28s/it]
Task 6, Epoch 9/20 => Loss 0.135, Train_accy 95.14:  45%|████▌     | 9/20 [00:56<01:04,  5.90s/it]
Task 6, Epoch 10/20 => Loss 0.120, Train_accy 94.91, Test_accy 72.55:  45%|████▌     | 9/20 [01:12<01:04,  5.90s/it]
Task 6, Epoch 10/20 => Loss 0.120, Train_accy 94.91, Test_accy 72.55:  50%|█████     | 10/20 [01:12<01:30,  9.05s/it]
Task 6, Epoch 11/20 => Loss 0.093, Train_accy 96.53:  50%|█████     | 10/20 [01:18<01:30,  9.05s/it]                 
Task 6, Epoch 11/20 => Loss 0.093, Train_accy 96.53:  55%|█████▌    | 11/20 [01:18<01:10,  7.84s/it]
Task 6, Epoch 12/20 => Loss 0.108, Train_accy 95.37:  55%|█████▌    | 11/20 [01:23<01:10,  7.84s/it]
Task 6, Epoch 12/20 => Loss 0.108, Train_accy 95.37:  60%|██████    | 12/20 [01:23<00:56,  7.00s/it]
Task 6, Epoch 13/20 => Loss 0.089, Train_accy 96.76:  60%|██████    | 12/20 [01:28<00:56,  7.00s/it]
Task 6, Epoch 13/20 => Loss 0.089, Train_accy 96.76:  65%|██████▌   | 13/20 [01:28<00:44,  6.42s/it]
Task 6, Epoch 14/20 => Loss 0.121, Train_accy 95.37:  65%|██████▌   | 13/20 [01:33<00:44,  6.42s/it]
Task 6, Epoch 14/20 => Loss 0.121, Train_accy 95.37:  70%|███████   | 14/20 [01:33<00:36,  6.02s/it]
Task 6, Epoch 15/20 => Loss 0.085, Train_accy 97.22, Test_accy 72.71:  70%|███████   | 14/20 [01:49<00:36,  6.02s/it]
Task 6, Epoch 15/20 => Loss 0.085, Train_accy 97.22, Test_accy 72.71:  75%|███████▌  | 15/20 [01:49<00:45,  9.08s/it]
Task 6, Epoch 16/20 => Loss 0.100, Train_accy 97.22:  75%|███████▌  | 15/20 [01:54<00:45,  9.08s/it]                 
Task 6, Epoch 16/20 => Loss 0.100, Train_accy 97.22:  80%|████████  | 16/20 [01:54<00:31,  7.88s/it]
Task 6, Epoch 17/20 => Loss 0.097, Train_accy 96.99:  80%|████████  | 16/20 [01:59<00:31,  7.88s/it]
Task 6, Epoch 17/20 => Loss 0.097, Train_accy 96.99:  85%|████████▌ | 17/20 [01:59<00:21,  7.05s/it]
Task 6, Epoch 18/20 => Loss 0.116, Train_accy 96.06:  85%|████████▌ | 17/20 [02:04<00:21,  7.05s/it]
Task 6, Epoch 18/20 => Loss 0.116, Train_accy 96.06:  90%|█████████ | 18/20 [02:04<00:12,  6.47s/it]
Task 6, Epoch 19/20 => Loss 0.077, Train_accy 97.45:  90%|█████████ | 18/20 [02:09<00:12,  6.47s/it]
Task 6, Epoch 19/20 => Loss 0.077, Train_accy 97.45:  95%|█████████▌| 19/20 [02:09<00:06,  6.07s/it]
Task 6, Epoch 20/20 => Loss 0.164, Train_accy 93.52, Test_accy 72.61:  95%|█████████▌| 19/20 [02:26<00:06,  6.07s/it]
Task 6, Epoch 20/20 => Loss 0.164, Train_accy 93.52, Test_accy 72.61: 100%|██████████| 20/20 [02:26<00:00,  9.12s/it]
Task 6, Epoch 20/20 => Loss 0.164, Train_accy 93.52, Test_accy 72.61: 100%|██████████| 20/20 [02:26<00:00,  7.31s/it]
2024-09-06 02:54:37,313 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.164, Train_accy 93.52, Test_accy 72.61
2024-09-06 02:54:48,429 [trainer.py] => No NME accuracy.
2024-09-06 02:54:48,430 [trainer.py] => CNN: {'total': 72.61, '00-99': 91.84, '100-109': 53.91, '110-119': 28.32, '120-129': 41.12, '130-139': 38.14, '140-149': 32.54, '150-159': 46.77, 'old': 74.42, 'new': 46.77}
2024-09-06 02:54:48,430 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76, 77.82, 74.36, 72.61]
2024-09-06 02:54:48,430 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49, 98.11, 97.91, 97.57]

Average Accuracy (CNN): 81.31
2024-09-06 02:54:48,430 [trainer.py] => Average Accuracy (CNN): 81.31 

2024-09-06 02:54:48,432 [trainer.py] => All params: 89792456
2024-09-06 02:54:48,433 [trainer.py] => Trainable params: 89792456
2024-09-06 02:54:49,580 [coda_prompt.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.440, Train_accy 58.33:   0%|          | 0/20 [00:05<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.440, Train_accy 58.33:   5%|▌         | 1/20 [00:05<01:37,  5.11s/it]
Task 7, Epoch 2/20 => Loss 0.227, Train_accy 92.59:   5%|▌         | 1/20 [00:10<01:37,  5.11s/it]
Task 7, Epoch 2/20 => Loss 0.227, Train_accy 92.59:  10%|█         | 2/20 [00:10<01:31,  5.11s/it]
Task 7, Epoch 3/20 => Loss 0.174, Train_accy 94.91:  10%|█         | 2/20 [00:15<01:31,  5.11s/it]
Task 7, Epoch 3/20 => Loss 0.174, Train_accy 94.91:  15%|█▌        | 3/20 [00:15<01:26,  5.10s/it]
Task 7, Epoch 4/20 => Loss 0.093, Train_accy 97.45:  15%|█▌        | 3/20 [00:20<01:26,  5.10s/it]
Task 7, Epoch 4/20 => Loss 0.093, Train_accy 97.45:  20%|██        | 4/20 [00:20<01:22,  5.13s/it]
Task 7, Epoch 5/20 => Loss 0.135, Train_accy 95.37, Test_accy 69.88:  20%|██        | 4/20 [00:37<01:22,  5.13s/it]
Task 7, Epoch 5/20 => Loss 0.135, Train_accy 95.37, Test_accy 69.88:  25%|██▌       | 5/20 [00:37<02:20,  9.40s/it]
Task 7, Epoch 6/20 => Loss 0.088, Train_accy 97.22:  25%|██▌       | 5/20 [00:42<02:20,  9.40s/it]                 
Task 7, Epoch 6/20 => Loss 0.088, Train_accy 97.22:  30%|███       | 6/20 [00:42<01:51,  7.94s/it]
Task 7, Epoch 7/20 => Loss 0.099, Train_accy 96.99:  30%|███       | 6/20 [00:47<01:51,  7.94s/it]
Task 7, Epoch 7/20 => Loss 0.099, Train_accy 96.99:  35%|███▌      | 7/20 [00:47<01:31,  7.01s/it]
Task 7, Epoch 8/20 => Loss 0.134, Train_accy 95.37:  35%|███▌      | 7/20 [00:52<01:31,  7.01s/it]
Task 7, Epoch 8/20 => Loss 0.134, Train_accy 95.37:  40%|████      | 8/20 [00:52<01:16,  6.40s/it]
Task 7, Epoch 9/20 => Loss 0.107, Train_accy 96.53:  40%|████      | 8/20 [00:57<01:16,  6.40s/it]
Task 7, Epoch 9/20 => Loss 0.107, Train_accy 96.53:  45%|████▌     | 9/20 [00:57<01:05,  6.00s/it]
Task 7, Epoch 10/20 => Loss 0.082, Train_accy 97.45, Test_accy 70.57:  45%|████▌     | 9/20 [01:14<01:05,  6.00s/it]
Task 7, Epoch 10/20 => Loss 0.082, Train_accy 97.45, Test_accy 70.57:  50%|█████     | 10/20 [01:14<01:33,  9.36s/it]
Task 7, Epoch 11/20 => Loss 0.078, Train_accy 96.99:  50%|█████     | 10/20 [01:19<01:33,  9.36s/it]                 
Task 7, Epoch 11/20 => Loss 0.078, Train_accy 96.99:  55%|█████▌    | 11/20 [01:19<01:12,  8.05s/it]
Task 7, Epoch 12/20 => Loss 0.083, Train_accy 97.45:  55%|█████▌    | 11/20 [01:24<01:12,  8.05s/it]
Task 7, Epoch 12/20 => Loss 0.083, Train_accy 97.45:  60%|██████    | 12/20 [01:24<00:57,  7.15s/it]
Task 7, Epoch 13/20 => Loss 0.078, Train_accy 97.22:  60%|██████    | 12/20 [01:29<00:57,  7.15s/it]
Task 7, Epoch 13/20 => Loss 0.078, Train_accy 97.22:  65%|██████▌   | 13/20 [01:29<00:45,  6.52s/it]
Task 7, Epoch 14/20 => Loss 0.074, Train_accy 97.22:  65%|██████▌   | 13/20 [01:35<00:45,  6.52s/it]
Task 7, Epoch 14/20 => Loss 0.074, Train_accy 97.22:  70%|███████   | 14/20 [01:35<00:36,  6.08s/it]
Task 7, Epoch 15/20 => Loss 0.077, Train_accy 97.22, Test_accy 70.67:  70%|███████   | 14/20 [01:51<00:36,  6.08s/it]
Task 7, Epoch 15/20 => Loss 0.077, Train_accy 97.22, Test_accy 70.67:  75%|███████▌  | 15/20 [01:51<00:46,  9.30s/it]
Task 7, Epoch 16/20 => Loss 0.114, Train_accy 96.99:  75%|███████▌  | 15/20 [01:56<00:46,  9.30s/it]                 
Task 7, Epoch 16/20 => Loss 0.114, Train_accy 96.99:  80%|████████  | 16/20 [01:56<00:32,  8.03s/it]
Task 7, Epoch 17/20 => Loss 0.091, Train_accy 96.06:  80%|████████  | 16/20 [02:02<00:32,  8.03s/it]
Task 7, Epoch 17/20 => Loss 0.091, Train_accy 96.06:  85%|████████▌ | 17/20 [02:02<00:21,  7.16s/it]
Task 7, Epoch 18/20 => Loss 0.082, Train_accy 96.99:  85%|████████▌ | 17/20 [02:07<00:21,  7.16s/it]
Task 7, Epoch 18/20 => Loss 0.082, Train_accy 96.99:  90%|█████████ | 18/20 [02:07<00:13,  6.53s/it]
Task 7, Epoch 19/20 => Loss 0.082, Train_accy 97.45:  90%|█████████ | 18/20 [02:12<00:13,  6.53s/it]
Task 7, Epoch 19/20 => Loss 0.082, Train_accy 97.45:  95%|█████████▌| 19/20 [02:12<00:06,  6.09s/it]
Task 7, Epoch 20/20 => Loss 0.074, Train_accy 97.22, Test_accy 70.67:  95%|█████████▌| 19/20 [02:28<00:06,  6.09s/it]
Task 7, Epoch 20/20 => Loss 0.074, Train_accy 97.22, Test_accy 70.67: 100%|██████████| 20/20 [02:28<00:00,  9.31s/it]
Task 7, Epoch 20/20 => Loss 0.074, Train_accy 97.22, Test_accy 70.67: 100%|██████████| 20/20 [02:28<00:00,  7.45s/it]
2024-09-06 02:57:18,545 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.074, Train_accy 97.22, Test_accy 70.67
2024-09-06 02:57:30,359 [trainer.py] => No NME accuracy.
2024-09-06 02:57:30,359 [trainer.py] => CNN: {'total': 70.67, '00-99': 91.92, '100-109': 53.91, '110-119': 28.32, '120-129': 41.12, '130-139': 38.14, '140-149': 32.54, '150-159': 46.77, '160-169': 42.54, 'old': 72.66, 'new': 42.54}
2024-09-06 02:57:30,360 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76, 77.82, 74.36, 72.61, 70.67]
2024-09-06 02:57:30,360 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49, 98.11, 97.91, 97.57, 97.38]

Average Accuracy (CNN): 79.98
2024-09-06 02:57:30,360 [trainer.py] => Average Accuracy (CNN): 79.98 

2024-09-06 02:57:30,361 [trainer.py] => All params: 89792456
2024-09-06 02:57:30,363 [trainer.py] => Trainable params: 89792456
2024-09-06 02:57:31,672 [coda_prompt.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.561, Train_accy 53.12:   0%|          | 0/20 [00:05<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.561, Train_accy 53.12:   5%|▌         | 1/20 [00:05<01:46,  5.58s/it]
Task 8, Epoch 2/20 => Loss 0.299, Train_accy 90.21:   5%|▌         | 1/20 [00:11<01:46,  5.58s/it]
Task 8, Epoch 2/20 => Loss 0.299, Train_accy 90.21:  10%|█         | 2/20 [00:11<01:40,  5.60s/it]
Task 8, Epoch 3/20 => Loss 0.172, Train_accy 94.58:  10%|█         | 2/20 [00:16<01:40,  5.60s/it]
Task 8, Epoch 3/20 => Loss 0.172, Train_accy 94.58:  15%|█▌        | 3/20 [00:16<01:35,  5.60s/it]
Task 8, Epoch 4/20 => Loss 0.160, Train_accy 95.00:  15%|█▌        | 3/20 [00:22<01:35,  5.60s/it]
Task 8, Epoch 4/20 => Loss 0.160, Train_accy 95.00:  20%|██        | 4/20 [00:22<01:29,  5.60s/it]
Task 8, Epoch 5/20 => Loss 0.128, Train_accy 95.62, Test_accy 68.80:  20%|██        | 4/20 [00:40<01:29,  5.60s/it]
Task 8, Epoch 5/20 => Loss 0.128, Train_accy 95.62, Test_accy 68.80:  25%|██▌       | 5/20 [00:40<02:30, 10.04s/it]
Task 8, Epoch 6/20 => Loss 0.111, Train_accy 96.04:  25%|██▌       | 5/20 [00:45<02:30, 10.04s/it]                 
Task 8, Epoch 6/20 => Loss 0.111, Train_accy 96.04:  30%|███       | 6/20 [00:45<01:59,  8.53s/it]
Task 8, Epoch 7/20 => Loss 0.141, Train_accy 96.04:  30%|███       | 6/20 [00:51<01:59,  8.53s/it]
Task 8, Epoch 7/20 => Loss 0.141, Train_accy 96.04:  35%|███▌      | 7/20 [00:51<01:38,  7.57s/it]
Task 8, Epoch 8/20 => Loss 0.161, Train_accy 95.00:  35%|███▌      | 7/20 [00:57<01:38,  7.57s/it]
Task 8, Epoch 8/20 => Loss 0.161, Train_accy 95.00:  40%|████      | 8/20 [00:57<01:23,  6.94s/it]
Task 8, Epoch 9/20 => Loss 0.160, Train_accy 94.58:  40%|████      | 8/20 [01:02<01:23,  6.94s/it]
Task 8, Epoch 9/20 => Loss 0.160, Train_accy 94.58:  45%|████▌     | 9/20 [01:02<01:11,  6.52s/it]
Task 8, Epoch 10/20 => Loss 0.135, Train_accy 96.04, Test_accy 69.22:  45%|████▌     | 9/20 [01:20<01:11,  6.52s/it]
Task 8, Epoch 10/20 => Loss 0.135, Train_accy 96.04, Test_accy 69.22:  50%|█████     | 10/20 [01:20<01:40, 10.06s/it]
Task 8, Epoch 11/20 => Loss 0.090, Train_accy 97.29:  50%|█████     | 10/20 [01:26<01:40, 10.06s/it]                 
Task 8, Epoch 11/20 => Loss 0.090, Train_accy 97.29:  55%|█████▌    | 11/20 [01:26<01:18,  8.70s/it]
Task 8, Epoch 12/20 => Loss 0.098, Train_accy 96.88:  55%|█████▌    | 11/20 [01:31<01:18,  8.70s/it]
Task 8, Epoch 12/20 => Loss 0.098, Train_accy 96.88:  60%|██████    | 12/20 [01:31<01:02,  7.76s/it]
Task 8, Epoch 13/20 => Loss 0.104, Train_accy 96.67:  60%|██████    | 12/20 [01:37<01:02,  7.76s/it]
Task 8, Epoch 13/20 => Loss 0.104, Train_accy 96.67:  65%|██████▌   | 13/20 [01:37<00:49,  7.10s/it]
Task 8, Epoch 14/20 => Loss 0.104, Train_accy 96.88:  65%|██████▌   | 13/20 [01:43<00:49,  7.10s/it]
Task 8, Epoch 14/20 => Loss 0.104, Train_accy 96.88:  70%|███████   | 14/20 [01:43<00:39,  6.65s/it]
Task 8, Epoch 15/20 => Loss 0.104, Train_accy 97.08, Test_accy 69.31:  70%|███████   | 14/20 [02:01<00:39,  6.65s/it]
Task 8, Epoch 15/20 => Loss 0.104, Train_accy 97.08, Test_accy 69.31:  75%|███████▌  | 15/20 [02:01<00:50, 10.08s/it]
Task 8, Epoch 16/20 => Loss 0.112, Train_accy 95.21:  75%|███████▌  | 15/20 [02:06<00:50, 10.08s/it]                 
Task 8, Epoch 16/20 => Loss 0.112, Train_accy 95.21:  80%|████████  | 16/20 [02:06<00:34,  8.74s/it]
Task 8, Epoch 17/20 => Loss 0.110, Train_accy 95.83:  80%|████████  | 16/20 [02:12<00:34,  8.74s/it]
Task 8, Epoch 17/20 => Loss 0.110, Train_accy 95.83:  85%|████████▌ | 17/20 [02:12<00:23,  7.79s/it]
Task 8, Epoch 18/20 => Loss 0.079, Train_accy 97.08:  85%|████████▌ | 17/20 [02:17<00:23,  7.79s/it]
Task 8, Epoch 18/20 => Loss 0.079, Train_accy 97.08:  90%|█████████ | 18/20 [02:17<00:14,  7.13s/it]
Task 8, Epoch 19/20 => Loss 0.137, Train_accy 94.79:  90%|█████████ | 18/20 [02:23<00:14,  7.13s/it]
Task 8, Epoch 19/20 => Loss 0.137, Train_accy 94.79:  95%|█████████▌| 19/20 [02:23<00:06,  6.67s/it]
Task 8, Epoch 20/20 => Loss 0.108, Train_accy 96.25, Test_accy 69.41:  95%|█████████▌| 19/20 [02:41<00:06,  6.67s/it]
Task 8, Epoch 20/20 => Loss 0.108, Train_accy 96.25, Test_accy 69.41: 100%|██████████| 20/20 [02:41<00:00, 10.08s/it]
Task 8, Epoch 20/20 => Loss 0.108, Train_accy 96.25, Test_accy 69.41: 100%|██████████| 20/20 [02:41<00:00,  8.08s/it]
2024-09-06 03:00:13,220 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.108, Train_accy 96.25, Test_accy 69.41
2024-09-06 03:00:25,553 [trainer.py] => No NME accuracy.
2024-09-06 03:00:25,554 [trainer.py] => CNN: {'total': 69.41, '00-99': 91.84, '100-109': 53.04, '110-119': 28.32, '120-129': 42.06, '130-139': 38.14, '140-149': 34.13, '150-159': 46.77, '160-169': 43.28, '170-179': 42.72, 'old': 70.77, 'new': 42.72}
2024-09-06 03:00:25,554 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76, 77.82, 74.36, 72.61, 70.67, 69.41]
2024-09-06 03:00:25,554 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49, 98.11, 97.91, 97.57, 97.38, 96.8]

Average Accuracy (CNN): 78.81
2024-09-06 03:00:25,554 [trainer.py] => Average Accuracy (CNN): 78.81 

2024-09-06 03:00:25,556 [trainer.py] => All params: 89792456
2024-09-06 03:00:25,557 [trainer.py] => Trainable params: 89792456
2024-09-06 03:00:27,014 [coda_prompt.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.588, Train_accy 49.54:   0%|          | 0/20 [00:05<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.588, Train_accy 49.54:   5%|▌         | 1/20 [00:05<01:36,  5.07s/it]
Task 9, Epoch 2/20 => Loss 0.312, Train_accy 89.58:   5%|▌         | 1/20 [00:10<01:36,  5.07s/it]
Task 9, Epoch 2/20 => Loss 0.312, Train_accy 89.58:  10%|█         | 2/20 [00:10<01:31,  5.07s/it]
Task 9, Epoch 3/20 => Loss 0.213, Train_accy 92.36:  10%|█         | 2/20 [00:15<01:31,  5.07s/it]
Task 9, Epoch 3/20 => Loss 0.213, Train_accy 92.36:  15%|█▌        | 3/20 [00:15<01:26,  5.07s/it]
Task 9, Epoch 4/20 => Loss 0.138, Train_accy 96.06:  15%|█▌        | 3/20 [00:20<01:26,  5.07s/it]
Task 9, Epoch 4/20 => Loss 0.138, Train_accy 96.06:  20%|██        | 4/20 [00:20<01:21,  5.07s/it]
Task 9, Epoch 5/20 => Loss 0.090, Train_accy 96.99, Test_accy 67.08:  20%|██        | 4/20 [00:38<01:21,  5.07s/it]
Task 9, Epoch 5/20 => Loss 0.090, Train_accy 96.99, Test_accy 67.08:  25%|██▌       | 5/20 [00:38<02:26,  9.78s/it]
Task 9, Epoch 6/20 => Loss 0.185, Train_accy 94.21:  25%|██▌       | 5/20 [00:43<02:26,  9.78s/it]                 
Task 9, Epoch 6/20 => Loss 0.185, Train_accy 94.21:  30%|███       | 6/20 [00:43<01:54,  8.18s/it]
Task 9, Epoch 7/20 => Loss 0.166, Train_accy 93.75:  30%|███       | 6/20 [00:48<01:54,  8.18s/it]
Task 9, Epoch 7/20 => Loss 0.166, Train_accy 93.75:  35%|███▌      | 7/20 [00:48<01:33,  7.17s/it]
Task 9, Epoch 8/20 => Loss 0.085, Train_accy 97.22:  35%|███▌      | 7/20 [00:53<01:33,  7.17s/it]
Task 9, Epoch 8/20 => Loss 0.085, Train_accy 97.22:  40%|████      | 8/20 [00:53<01:18,  6.51s/it]
Task 9, Epoch 9/20 => Loss 0.148, Train_accy 94.68:  40%|████      | 8/20 [00:58<01:18,  6.51s/it]
Task 9, Epoch 9/20 => Loss 0.148, Train_accy 94.68:  45%|████▌     | 9/20 [00:58<01:06,  6.06s/it]
Task 9, Epoch 10/20 => Loss 0.152, Train_accy 95.14, Test_accy 67.52:  45%|████▌     | 9/20 [01:16<01:06,  6.06s/it]
Task 9, Epoch 10/20 => Loss 0.152, Train_accy 95.14, Test_accy 67.52:  50%|█████     | 10/20 [01:16<01:38,  9.80s/it]
Task 9, Epoch 11/20 => Loss 0.100, Train_accy 97.22:  50%|█████     | 10/20 [01:22<01:38,  9.80s/it]                 
Task 9, Epoch 11/20 => Loss 0.100, Train_accy 97.22:  55%|█████▌    | 11/20 [01:22<01:15,  8.37s/it]
Task 9, Epoch 12/20 => Loss 0.079, Train_accy 97.69:  55%|█████▌    | 11/20 [01:27<01:15,  8.37s/it]
Task 9, Epoch 12/20 => Loss 0.079, Train_accy 97.69:  60%|██████    | 12/20 [01:27<00:59,  7.39s/it]
Task 9, Epoch 13/20 => Loss 0.061, Train_accy 98.38:  60%|██████    | 12/20 [01:32<00:59,  7.39s/it]
Task 9, Epoch 13/20 => Loss 0.061, Train_accy 98.38:  65%|██████▌   | 13/20 [01:32<00:46,  6.70s/it]
Task 9, Epoch 14/20 => Loss 0.100, Train_accy 96.30:  65%|██████▌   | 13/20 [01:37<00:46,  6.70s/it]
Task 9, Epoch 14/20 => Loss 0.100, Train_accy 96.30:  70%|███████   | 14/20 [01:37<00:37,  6.22s/it]
Task 9, Epoch 15/20 => Loss 0.118, Train_accy 95.37, Test_accy 67.70:  70%|███████   | 14/20 [01:55<00:37,  6.22s/it]
Task 9, Epoch 15/20 => Loss 0.118, Train_accy 95.37, Test_accy 67.70:  75%|███████▌  | 15/20 [01:55<00:49,  9.83s/it]
Task 9, Epoch 16/20 => Loss 0.077, Train_accy 97.45:  75%|███████▌  | 15/20 [02:00<00:49,  9.83s/it]                 
Task 9, Epoch 16/20 => Loss 0.077, Train_accy 97.45:  80%|████████  | 16/20 [02:00<00:33,  8.41s/it]
Task 9, Epoch 17/20 => Loss 0.100, Train_accy 96.06:  80%|████████  | 16/20 [02:05<00:33,  8.41s/it]
Task 9, Epoch 17/20 => Loss 0.100, Train_accy 96.06:  85%|████████▌ | 17/20 [02:05<00:22,  7.40s/it]
Task 9, Epoch 18/20 => Loss 0.090, Train_accy 96.53:  85%|████████▌ | 17/20 [02:10<00:22,  7.40s/it]
Task 9, Epoch 18/20 => Loss 0.090, Train_accy 96.53:  90%|█████████ | 18/20 [02:10<00:13,  6.72s/it]
Task 9, Epoch 19/20 => Loss 0.117, Train_accy 96.76:  90%|█████████ | 18/20 [02:16<00:13,  6.72s/it]
Task 9, Epoch 19/20 => Loss 0.117, Train_accy 96.76:  95%|█████████▌| 19/20 [02:16<00:06,  6.23s/it]
Task 9, Epoch 20/20 => Loss 0.116, Train_accy 95.60, Test_accy 67.70:  95%|█████████▌| 19/20 [02:34<00:06,  6.23s/it]
Task 9, Epoch 20/20 => Loss 0.116, Train_accy 95.60, Test_accy 67.70: 100%|██████████| 20/20 [02:34<00:00,  9.82s/it]
Task 9, Epoch 20/20 => Loss 0.116, Train_accy 95.60, Test_accy 67.70: 100%|██████████| 20/20 [02:34<00:00,  7.71s/it]
2024-09-06 03:03:01,245 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.116, Train_accy 95.60, Test_accy 67.70
2024-09-06 03:03:14,426 [trainer.py] => No NME accuracy.
2024-09-06 03:03:14,427 [trainer.py] => CNN: {'total': 67.7, '00-99': 91.84, '100-109': 52.17, '110-119': 28.32, '120-129': 42.06, '130-139': 38.14, '140-149': 32.54, '150-159': 47.58, '160-169': 42.54, '170-179': 42.72, '180-189': 42.42, 'old': 69.27, 'new': 42.42}
2024-09-06 03:03:14,427 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76, 77.82, 74.36, 72.61, 70.67, 69.41, 67.7]
2024-09-06 03:03:14,427 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49, 98.11, 97.91, 97.57, 97.38, 96.8, 96.37]

Average Accuracy (CNN): 77.7
2024-09-06 03:03:14,427 [trainer.py] => Average Accuracy (CNN): 77.7 

2024-09-06 03:03:14,429 [trainer.py] => All params: 89792456
2024-09-06 03:03:14,430 [trainer.py] => Trainable params: 89792456
2024-09-06 03:03:16,145 [coda_prompt.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.259, Train_accy 60.83:   0%|          | 0/20 [00:05<?, ?it/s]
Task 10, Epoch 1/20 => Loss 1.259, Train_accy 60.83:   5%|▌         | 1/20 [00:05<01:46,  5.62s/it]
Task 10, Epoch 2/20 => Loss 0.274, Train_accy 92.29:   5%|▌         | 1/20 [00:11<01:46,  5.62s/it]
Task 10, Epoch 2/20 => Loss 0.274, Train_accy 92.29:  10%|█         | 2/20 [00:11<01:41,  5.63s/it]
Task 10, Epoch 3/20 => Loss 0.215, Train_accy 91.88:  10%|█         | 2/20 [00:16<01:41,  5.63s/it]
Task 10, Epoch 3/20 => Loss 0.215, Train_accy 91.88:  15%|█▌        | 3/20 [00:16<01:35,  5.64s/it]
Task 10, Epoch 4/20 => Loss 0.216, Train_accy 92.29:  15%|█▌        | 3/20 [00:22<01:35,  5.64s/it]
Task 10, Epoch 4/20 => Loss 0.216, Train_accy 92.29:  20%|██        | 4/20 [00:22<01:30,  5.64s/it]
Task 10, Epoch 5/20 => Loss 0.142, Train_accy 95.21, Test_accy 66.07:  20%|██        | 4/20 [00:42<01:30,  5.64s/it]
Task 10, Epoch 5/20 => Loss 0.142, Train_accy 95.21, Test_accy 66.07:  25%|██▌       | 5/20 [00:42<02:39, 10.64s/it]
Task 10, Epoch 6/20 => Loss 0.149, Train_accy 95.42:  25%|██▌       | 5/20 [00:47<02:39, 10.64s/it]                 
Task 10, Epoch 6/20 => Loss 0.149, Train_accy 95.42:  30%|███       | 6/20 [00:47<02:05,  8.94s/it]
Task 10, Epoch 7/20 => Loss 0.135, Train_accy 96.46:  30%|███       | 6/20 [00:53<02:05,  8.94s/it]
Task 10, Epoch 7/20 => Loss 0.135, Train_accy 96.46:  35%|███▌      | 7/20 [00:53<01:42,  7.85s/it]
Task 10, Epoch 8/20 => Loss 0.132, Train_accy 95.83:  35%|███▌      | 7/20 [00:58<01:42,  7.85s/it]
Task 10, Epoch 8/20 => Loss 0.132, Train_accy 95.83:  40%|████      | 8/20 [00:58<01:25,  7.15s/it]
Task 10, Epoch 9/20 => Loss 0.085, Train_accy 97.71:  40%|████      | 8/20 [01:04<01:25,  7.15s/it]
Task 10, Epoch 9/20 => Loss 0.085, Train_accy 97.71:  45%|████▌     | 9/20 [01:04<01:13,  6.67s/it]
Task 10, Epoch 10/20 => Loss 0.133, Train_accy 94.58, Test_accy 65.90:  45%|████▌     | 9/20 [01:23<01:13,  6.67s/it]
Task 10, Epoch 10/20 => Loss 0.133, Train_accy 94.58, Test_accy 65.90:  50%|█████     | 10/20 [01:23<01:45, 10.57s/it]
Task 10, Epoch 11/20 => Loss 0.123, Train_accy 95.21:  50%|█████     | 10/20 [01:29<01:45, 10.57s/it]                 
Task 10, Epoch 11/20 => Loss 0.123, Train_accy 95.21:  55%|█████▌    | 11/20 [01:29<01:21,  9.05s/it]
Task 10, Epoch 12/20 => Loss 0.088, Train_accy 97.08:  55%|█████▌    | 11/20 [01:35<01:21,  9.05s/it]
Task 10, Epoch 12/20 => Loss 0.088, Train_accy 97.08:  60%|██████    | 12/20 [01:35<01:04,  8.01s/it]
Task 10, Epoch 13/20 => Loss 0.124, Train_accy 95.83:  60%|██████    | 12/20 [01:40<01:04,  8.01s/it]
Task 10, Epoch 13/20 => Loss 0.124, Train_accy 95.83:  65%|██████▌   | 13/20 [01:40<00:50,  7.28s/it]
Task 10, Epoch 14/20 => Loss 0.131, Train_accy 96.04:  65%|██████▌   | 13/20 [01:46<00:50,  7.28s/it]
Task 10, Epoch 14/20 => Loss 0.131, Train_accy 96.04:  70%|███████   | 14/20 [01:46<00:40,  6.79s/it]
Task 10, Epoch 15/20 => Loss 0.088, Train_accy 96.88, Test_accy 65.90:  70%|███████   | 14/20 [02:05<00:40,  6.79s/it]
Task 10, Epoch 15/20 => Loss 0.088, Train_accy 96.88, Test_accy 65.90:  75%|███████▌  | 15/20 [02:05<00:52, 10.58s/it]
Task 10, Epoch 16/20 => Loss 0.091, Train_accy 96.88:  75%|███████▌  | 15/20 [02:11<00:52, 10.58s/it]                 
Task 10, Epoch 16/20 => Loss 0.091, Train_accy 96.88:  80%|████████  | 16/20 [02:11<00:36,  9.09s/it]
Task 10, Epoch 17/20 => Loss 0.123, Train_accy 96.25:  80%|████████  | 16/20 [02:17<00:36,  9.09s/it]
Task 10, Epoch 17/20 => Loss 0.123, Train_accy 96.25:  85%|████████▌ | 17/20 [02:17<00:24,  8.05s/it]
Task 10, Epoch 18/20 => Loss 0.073, Train_accy 97.71:  85%|████████▌ | 17/20 [02:22<00:24,  8.05s/it]
Task 10, Epoch 18/20 => Loss 0.073, Train_accy 97.71:  90%|█████████ | 18/20 [02:22<00:14,  7.33s/it]
Task 10, Epoch 19/20 => Loss 0.087, Train_accy 97.71:  90%|█████████ | 18/20 [02:28<00:14,  7.33s/it]
Task 10, Epoch 19/20 => Loss 0.087, Train_accy 97.71:  95%|█████████▌| 19/20 [02:28<00:06,  6.82s/it]
Task 10, Epoch 20/20 => Loss 0.110, Train_accy 96.25, Test_accy 65.90:  95%|█████████▌| 19/20 [02:47<00:06,  6.82s/it]
Task 10, Epoch 20/20 => Loss 0.110, Train_accy 96.25, Test_accy 65.90: 100%|██████████| 20/20 [02:47<00:00, 10.56s/it]
Task 10, Epoch 20/20 => Loss 0.110, Train_accy 96.25, Test_accy 65.90: 100%|██████████| 20/20 [02:47<00:00,  8.38s/it]
2024-09-06 03:06:03,732 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.110, Train_accy 96.25, Test_accy 65.90
2024-09-06 03:06:17,417 [trainer.py] => No NME accuracy.
2024-09-06 03:06:17,417 [trainer.py] => CNN: {'total': 65.9, '00-99': 91.67, '100-109': 52.17, '110-119': 28.32, '120-129': 42.06, '130-139': 38.14, '140-149': 31.75, '150-159': 47.58, '160-169': 40.3, '170-179': 42.72, '180-189': 41.67, '190-199': 31.63, 'old': 67.39, 'new': 31.63}
2024-09-06 03:06:17,418 [trainer.py] => CNN top1 curve: [91.92, 88.18, 83.55, 80.76, 77.82, 74.36, 72.61, 70.67, 69.41, 67.7, 65.9]
2024-09-06 03:06:17,418 [trainer.py] => CNN top5 curve: [99.07, 98.77, 98.66, 98.49, 98.11, 97.91, 97.57, 97.38, 96.8, 96.37, 96.18]

Average Accuracy (CNN): 76.63
2024-09-06 03:06:17,418 [trainer.py] => Average Accuracy (CNN): 76.63 

Accuracy Matrix (CNN):
[[91.92 91.67 91.75 91.92 91.92 91.84 91.84 91.92 91.84 91.84 91.67]
 [ 0.   52.17 53.04 53.04 53.04 53.04 53.91 53.91 53.04 52.17 52.17]
 [ 0.    0.   28.32 28.32 28.32 28.32 28.32 28.32 28.32 28.32 28.32]
 [ 0.    0.    0.   42.06 41.12 41.12 41.12 41.12 42.06 42.06 42.06]
 [ 0.    0.    0.    0.   40.68 38.98 38.14 38.14 38.14 38.14 38.14]
 [ 0.    0.    0.    0.    0.   31.75 32.54 32.54 34.13 32.54 31.75]
 [ 0.    0.    0.    0.    0.    0.   46.77 46.77 46.77 47.58 47.58]
 [ 0.    0.    0.    0.    0.    0.    0.   42.54 43.28 42.54 40.3 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   42.72 42.72 42.72]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   42.42 41.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   31.63]]
2024-09-06 03:06:17,421 [trainer.py] => Forgetting (CNN): 1.064
2024-09-06 03:06:20,066 [trainer.py] => config: ./exps/ease_cub_B0_Inc5.json
2024-09-06 03:06:20,066 [trainer.py] => prefix:  
2024-09-06 03:06:20,066 [trainer.py] => dataset: cub
2024-09-06 03:06:20,067 [trainer.py] => memory_size: 0
2024-09-06 03:06:20,067 [trainer.py] => memory_per_class: 0
2024-09-06 03:06:20,067 [trainer.py] => fixed_memory: False
2024-09-06 03:06:20,067 [trainer.py] => shuffle: True
2024-09-06 03:06:20,067 [trainer.py] => init_cls: 40
2024-09-06 03:06:20,067 [trainer.py] => increment: 40
2024-09-06 03:06:20,067 [trainer.py] => model_name: ease
2024-09-06 03:06:20,067 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-06 03:06:20,067 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 03:06:20,067 [trainer.py] => seed: 1993
2024-09-06 03:06:20,067 [trainer.py] => init_epochs: 20
2024-09-06 03:06:20,067 [trainer.py] => init_lr: 0.025
2024-09-06 03:06:20,067 [trainer.py] => later_epochs: 20
2024-09-06 03:06:20,067 [trainer.py] => later_lr: 0.025
2024-09-06 03:06:20,067 [trainer.py] => batch_size: 48
2024-09-06 03:06:20,067 [trainer.py] => weight_decay: 0.0005
2024-09-06 03:06:20,067 [trainer.py] => min_lr: 0
2024-09-06 03:06:20,067 [trainer.py] => optimizer: sgd
2024-09-06 03:06:20,067 [trainer.py] => scheduler: cosine
2024-09-06 03:06:20,067 [trainer.py] => pretrained: True
2024-09-06 03:06:20,067 [trainer.py] => vpt_type: Deep
2024-09-06 03:06:20,067 [trainer.py] => prompt_token_num: 5
2024-09-06 03:06:20,067 [trainer.py] => ffn_num: 16
2024-09-06 03:06:20,067 [trainer.py] => use_diagonal: False
2024-09-06 03:06:20,067 [trainer.py] => recalc_sim: True
2024-09-06 03:06:20,067 [trainer.py] => alpha: 0.1
2024-09-06 03:06:20,067 [trainer.py] => use_init_ptm: False
2024-09-06 03:06:20,067 [trainer.py] => beta: 0
2024-09-06 03:06:20,067 [trainer.py] => use_old_data: False
2024-09-06 03:06:20,067 [trainer.py] => use_reweight: True
2024-09-06 03:06:20,067 [trainer.py] => moni_adam: False
2024-09-06 03:06:20,067 [trainer.py] => adapter_num: -1
2024-09-06 03:06:20,104 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-06 03:06:22,799 [trainer.py] => All params: 86102976
2024-09-06 03:06:22,800 [trainer.py] => Trainable params: 304320
2024-09-06 03:06:22,807 [ease.py] => Learning on 0-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.604, Train_accy 34.43:   0%|          | 0/20 [00:11<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.604, Train_accy 34.43:   5%|▌         | 1/20 [00:11<03:44, 11.80s/it]
Task 0, Epoch 2/20 => Loss 2.926, Train_accy 78.95:   5%|▌         | 1/20 [00:23<03:44, 11.80s/it]
Task 0, Epoch 2/20 => Loss 2.926, Train_accy 78.95:  10%|█         | 2/20 [00:23<03:29, 11.61s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 88.79:  10%|█         | 2/20 [00:34<03:29, 11.61s/it]
Task 0, Epoch 3/20 => Loss 1.371, Train_accy 88.79:  15%|█▌        | 3/20 [00:34<03:16, 11.54s/it]
Task 0, Epoch 4/20 => Loss 0.623, Train_accy 91.54:  15%|█▌        | 3/20 [00:46<03:16, 11.54s/it]
Task 0, Epoch 4/20 => Loss 0.623, Train_accy 91.54:  20%|██        | 4/20 [00:46<03:03, 11.49s/it]
Task 0, Epoch 5/20 => Loss 0.503, Train_accy 91.38:  20%|██        | 4/20 [00:57<03:03, 11.49s/it]
Task 0, Epoch 5/20 => Loss 0.503, Train_accy 91.38:  25%|██▌       | 5/20 [00:57<02:52, 11.51s/it]
Task 0, Epoch 6/20 => Loss 0.394, Train_accy 92.91:  25%|██▌       | 5/20 [01:09<02:52, 11.51s/it]
Task 0, Epoch 6/20 => Loss 0.394, Train_accy 92.91:  30%|███       | 6/20 [01:09<02:41, 11.51s/it]
Task 0, Epoch 7/20 => Loss 0.401, Train_accy 92.65:  30%|███       | 6/20 [01:20<02:41, 11.51s/it]
Task 0, Epoch 7/20 => Loss 0.401, Train_accy 92.65:  35%|███▌      | 7/20 [01:20<02:29, 11.51s/it]
Task 0, Epoch 8/20 => Loss 0.381, Train_accy 92.28:  35%|███▌      | 7/20 [01:32<02:29, 11.51s/it]
Task 0, Epoch 8/20 => Loss 0.381, Train_accy 92.28:  40%|████      | 8/20 [01:32<02:17, 11.50s/it]
Task 0, Epoch 9/20 => Loss 0.347, Train_accy 92.49:  40%|████      | 8/20 [01:43<02:17, 11.50s/it]
Task 0, Epoch 9/20 => Loss 0.347, Train_accy 92.49:  45%|████▌     | 9/20 [01:43<02:06, 11.52s/it]
Task 0, Epoch 10/20 => Loss 0.325, Train_accy 93.34:  45%|████▌     | 9/20 [01:55<02:06, 11.52s/it]
Task 0, Epoch 10/20 => Loss 0.325, Train_accy 93.34:  50%|█████     | 10/20 [01:55<01:55, 11.51s/it]
Task 0, Epoch 11/20 => Loss 0.351, Train_accy 92.60:  50%|█████     | 10/20 [02:06<01:55, 11.51s/it]
Task 0, Epoch 11/20 => Loss 0.351, Train_accy 92.60:  55%|█████▌    | 11/20 [02:06<01:43, 11.53s/it]
Task 0, Epoch 12/20 => Loss 0.338, Train_accy 92.23:  55%|█████▌    | 11/20 [02:18<01:43, 11.53s/it]
Task 0, Epoch 12/20 => Loss 0.338, Train_accy 92.23:  60%|██████    | 12/20 [02:18<01:32, 11.54s/it]
Task 0, Epoch 13/20 => Loss 0.294, Train_accy 94.13:  60%|██████    | 12/20 [02:29<01:32, 11.54s/it]
Task 0, Epoch 13/20 => Loss 0.294, Train_accy 94.13:  65%|██████▌   | 13/20 [02:29<01:20, 11.56s/it]
Task 0, Epoch 14/20 => Loss 0.296, Train_accy 93.97:  65%|██████▌   | 13/20 [02:41<01:20, 11.56s/it]
Task 0, Epoch 14/20 => Loss 0.296, Train_accy 93.97:  70%|███████   | 14/20 [02:41<01:09, 11.53s/it]
Task 0, Epoch 15/20 => Loss 0.312, Train_accy 93.39:  70%|███████   | 14/20 [02:53<01:09, 11.53s/it]
Task 0, Epoch 15/20 => Loss 0.312, Train_accy 93.39:  75%|███████▌  | 15/20 [02:53<00:57, 11.54s/it]
Task 0, Epoch 16/20 => Loss 0.290, Train_accy 94.13:  75%|███████▌  | 15/20 [03:04<00:57, 11.54s/it]
Task 0, Epoch 16/20 => Loss 0.290, Train_accy 94.13:  80%|████████  | 16/20 [03:04<00:46, 11.53s/it]
Task 0, Epoch 17/20 => Loss 0.287, Train_accy 93.34:  80%|████████  | 16/20 [03:15<00:46, 11.53s/it]
Task 0, Epoch 17/20 => Loss 0.287, Train_accy 93.34:  85%|████████▌ | 17/20 [03:15<00:34, 11.51s/it]
Task 0, Epoch 18/20 => Loss 0.291, Train_accy 93.92:  85%|████████▌ | 17/20 [03:27<00:34, 11.51s/it]
Task 0, Epoch 18/20 => Loss 0.291, Train_accy 93.92:  90%|█████████ | 18/20 [03:27<00:22, 11.49s/it]
Task 0, Epoch 19/20 => Loss 0.287, Train_accy 94.18:  90%|█████████ | 18/20 [03:38<00:22, 11.49s/it]
Task 0, Epoch 19/20 => Loss 0.287, Train_accy 94.18:  95%|█████████▌| 19/20 [03:38<00:11, 11.51s/it]
Task 0, Epoch 20/20 => Loss 0.283, Train_accy 93.76:  95%|█████████▌| 19/20 [03:50<00:11, 11.51s/it]
Task 0, Epoch 20/20 => Loss 0.283, Train_accy 93.76: 100%|██████████| 20/20 [03:50<00:00, 11.53s/it]
Task 0, Epoch 20/20 => Loss 0.283, Train_accy 93.76: 100%|██████████| 20/20 [03:50<00:00, 11.53s/it]
2024-09-06 03:10:13,441 [ease.py] => Task 0, Epoch 20/20 => Loss 0.283, Train_accy 93.76
2024-09-06 03:10:21,613 [ease.py] => Task correct: 100.0
2024-09-06 03:10:21,614 [ease.py] => Task acc: 97.57709251101322
2024-09-06 03:10:21,636 [trainer.py] => No NME accuracy.
2024-09-06 03:10:21,636 [trainer.py] => CNN: {'total': 97.58, '00-39': 97.58, 'old': 0, 'new': 97.58}
2024-09-06 03:10:21,636 [trainer.py] => CNN top1 curve: [97.58]
2024-09-06 03:10:21,636 [trainer.py] => CNN top5 curve: [99.78]

Average Accuracy (CNN): 97.58
2024-09-06 03:10:21,636 [trainer.py] => Average Accuracy (CNN): 97.58 

2024-09-06 03:10:21,637 [trainer.py] => All params: 86164418
2024-09-06 03:10:21,637 [trainer.py] => Trainable params: 304320
2024-09-06 03:10:21,639 [ease.py] => Learning on 40-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.615, Train_accy 32.35:   0%|          | 0/20 [00:11<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.615, Train_accy 32.35:   5%|▌         | 1/20 [00:11<03:37, 11.43s/it]
Task 1, Epoch 2/20 => Loss 3.019, Train_accy 80.89:   5%|▌         | 1/20 [00:23<03:37, 11.43s/it]
Task 1, Epoch 2/20 => Loss 3.019, Train_accy 80.89:  10%|█         | 2/20 [00:23<03:27, 11.52s/it]
Task 1, Epoch 3/20 => Loss 1.475, Train_accy 88.57:  10%|█         | 2/20 [00:34<03:27, 11.52s/it]
Task 1, Epoch 3/20 => Loss 1.475, Train_accy 88.57:  15%|█▌        | 3/20 [00:34<03:16, 11.54s/it]
Task 1, Epoch 4/20 => Loss 0.620, Train_accy 91.48:  15%|█▌        | 3/20 [00:46<03:16, 11.54s/it]
Task 1, Epoch 4/20 => Loss 0.620, Train_accy 91.48:  20%|██        | 4/20 [00:46<03:04, 11.54s/it]
Task 1, Epoch 5/20 => Loss 0.469, Train_accy 91.42:  20%|██        | 4/20 [00:57<03:04, 11.54s/it]
Task 1, Epoch 5/20 => Loss 0.469, Train_accy 91.42:  25%|██▌       | 5/20 [00:57<02:53, 11.54s/it]
Task 1, Epoch 6/20 => Loss 0.436, Train_accy 91.74:  25%|██▌       | 5/20 [01:09<02:53, 11.54s/it]
Task 1, Epoch 6/20 => Loss 0.436, Train_accy 91.74:  30%|███       | 6/20 [01:09<02:41, 11.55s/it]
Task 1, Epoch 7/20 => Loss 0.394, Train_accy 92.01:  30%|███       | 6/20 [01:20<02:41, 11.55s/it]
Task 1, Epoch 7/20 => Loss 0.394, Train_accy 92.01:  35%|███▌      | 7/20 [01:20<02:29, 11.53s/it]
Task 1, Epoch 8/20 => Loss 0.357, Train_accy 93.07:  35%|███▌      | 7/20 [01:32<02:29, 11.53s/it]
Task 1, Epoch 8/20 => Loss 0.357, Train_accy 93.07:  40%|████      | 8/20 [01:32<02:18, 11.51s/it]
Task 1, Epoch 9/20 => Loss 0.331, Train_accy 93.49:  40%|████      | 8/20 [01:43<02:18, 11.51s/it]
Task 1, Epoch 9/20 => Loss 0.331, Train_accy 93.49:  45%|████▌     | 9/20 [01:43<02:06, 11.50s/it]
Task 1, Epoch 10/20 => Loss 0.367, Train_accy 91.48:  45%|████▌     | 9/20 [01:55<02:06, 11.50s/it]
Task 1, Epoch 10/20 => Loss 0.367, Train_accy 91.48:  50%|█████     | 10/20 [01:55<01:55, 11.50s/it]
Task 1, Epoch 11/20 => Loss 0.339, Train_accy 92.75:  50%|█████     | 10/20 [02:06<01:55, 11.50s/it]
Task 1, Epoch 11/20 => Loss 0.339, Train_accy 92.75:  55%|█████▌    | 11/20 [02:06<01:43, 11.52s/it]
Task 1, Epoch 12/20 => Loss 0.328, Train_accy 93.07:  55%|█████▌    | 11/20 [02:18<01:43, 11.52s/it]
Task 1, Epoch 12/20 => Loss 0.328, Train_accy 93.07:  60%|██████    | 12/20 [02:18<01:32, 11.54s/it]
Task 1, Epoch 13/20 => Loss 0.322, Train_accy 93.44:  60%|██████    | 12/20 [02:29<01:32, 11.54s/it]
Task 1, Epoch 13/20 => Loss 0.322, Train_accy 93.44:  65%|██████▌   | 13/20 [02:29<01:20, 11.52s/it]
Task 1, Epoch 14/20 => Loss 0.312, Train_accy 93.44:  65%|██████▌   | 13/20 [02:41<01:20, 11.52s/it]
Task 1, Epoch 14/20 => Loss 0.312, Train_accy 93.44:  70%|███████   | 14/20 [02:41<01:09, 11.54s/it]
Task 1, Epoch 15/20 => Loss 0.320, Train_accy 92.91:  70%|███████   | 14/20 [02:52<01:09, 11.54s/it]
Task 1, Epoch 15/20 => Loss 0.320, Train_accy 92.91:  75%|███████▌  | 15/20 [02:52<00:57, 11.52s/it]
Task 1, Epoch 16/20 => Loss 0.287, Train_accy 93.91:  75%|███████▌  | 15/20 [03:04<00:57, 11.52s/it]
Task 1, Epoch 16/20 => Loss 0.287, Train_accy 93.91:  80%|████████  | 16/20 [03:04<00:46, 11.53s/it]
Task 1, Epoch 17/20 => Loss 0.323, Train_accy 92.54:  80%|████████  | 16/20 [03:15<00:46, 11.53s/it]
Task 1, Epoch 17/20 => Loss 0.323, Train_accy 92.54:  85%|████████▌ | 17/20 [03:15<00:34, 11.53s/it]
Task 1, Epoch 18/20 => Loss 0.284, Train_accy 93.97:  85%|████████▌ | 17/20 [03:27<00:34, 11.53s/it]
Task 1, Epoch 18/20 => Loss 0.284, Train_accy 93.97:  90%|█████████ | 18/20 [03:27<00:23, 11.54s/it]
Task 1, Epoch 19/20 => Loss 0.309, Train_accy 92.96:  90%|█████████ | 18/20 [03:38<00:23, 11.54s/it]
Task 1, Epoch 19/20 => Loss 0.309, Train_accy 92.96:  95%|█████████▌| 19/20 [03:38<00:11, 11.53s/it]
Task 1, Epoch 20/20 => Loss 0.304, Train_accy 93.70:  95%|█████████▌| 19/20 [03:50<00:11, 11.53s/it]
Task 1, Epoch 20/20 => Loss 0.304, Train_accy 93.70: 100%|██████████| 20/20 [03:50<00:00, 11.52s/it]
Task 1, Epoch 20/20 => Loss 0.304, Train_accy 93.70: 100%|██████████| 20/20 [03:50<00:00, 11.52s/it]
2024-09-06 03:14:12,128 [ease.py] => Task 1, Epoch 20/20 => Loss 0.304, Train_accy 93.70
2024-09-06 03:14:30,558 [ease.py] => Task correct: 94.45048966267682
2024-09-06 03:14:30,559 [ease.py] => Task acc: 96.95321001088139
2024-09-06 03:14:30,586 [trainer.py] => No NME accuracy.
2024-09-06 03:14:30,586 [trainer.py] => CNN: {'total': 92.06, '00-39': 88.77, '40-79': 95.27, 'old': 88.77, 'new': 95.27}
2024-09-06 03:14:30,586 [trainer.py] => CNN top1 curve: [97.58, 92.06]
2024-09-06 03:14:30,587 [trainer.py] => CNN top5 curve: [99.78, 99.24]

Average Accuracy (CNN): 94.82
2024-09-06 03:14:30,587 [trainer.py] => Average Accuracy (CNN): 94.82 

2024-09-06 03:14:30,588 [trainer.py] => All params: 86256578
2024-09-06 03:14:30,588 [trainer.py] => Trainable params: 304320
2024-09-06 03:14:30,593 [ease.py] => Learning on 80-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.607, Train_accy 36.39:   0%|          | 0/20 [00:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.607, Train_accy 36.39:   5%|▌         | 1/20 [00:11<03:36, 11.40s/it]
Task 2, Epoch 2/20 => Loss 2.971, Train_accy 80.44:   5%|▌         | 1/20 [00:22<03:36, 11.40s/it]
Task 2, Epoch 2/20 => Loss 2.971, Train_accy 80.44:  10%|█         | 2/20 [00:22<03:24, 11.38s/it]
Task 2, Epoch 3/20 => Loss 1.425, Train_accy 85.74:  10%|█         | 2/20 [00:34<03:24, 11.38s/it]
Task 2, Epoch 3/20 => Loss 1.425, Train_accy 85.74:  15%|█▌        | 3/20 [00:34<03:13, 11.39s/it]
Task 2, Epoch 4/20 => Loss 0.672, Train_accy 88.53:  15%|█▌        | 3/20 [00:45<03:13, 11.39s/it]
Task 2, Epoch 4/20 => Loss 0.672, Train_accy 88.53:  20%|██        | 4/20 [00:45<03:02, 11.40s/it]
Task 2, Epoch 5/20 => Loss 0.507, Train_accy 89.17:  20%|██        | 4/20 [00:56<03:02, 11.40s/it]
Task 2, Epoch 5/20 => Loss 0.507, Train_accy 89.17:  25%|██▌       | 5/20 [00:56<02:50, 11.39s/it]
Task 2, Epoch 6/20 => Loss 0.403, Train_accy 92.12:  25%|██▌       | 5/20 [01:08<02:50, 11.39s/it]
Task 2, Epoch 6/20 => Loss 0.403, Train_accy 92.12:  30%|███       | 6/20 [01:08<02:39, 11.40s/it]
Task 2, Epoch 7/20 => Loss 0.393, Train_accy 91.75:  30%|███       | 6/20 [01:19<02:39, 11.40s/it]
Task 2, Epoch 7/20 => Loss 0.393, Train_accy 91.75:  35%|███▌      | 7/20 [01:19<02:28, 11.42s/it]
Task 2, Epoch 8/20 => Loss 0.344, Train_accy 92.28:  35%|███▌      | 7/20 [01:31<02:28, 11.42s/it]
Task 2, Epoch 8/20 => Loss 0.344, Train_accy 92.28:  40%|████      | 8/20 [01:31<02:16, 11.40s/it]
Task 2, Epoch 9/20 => Loss 0.378, Train_accy 91.26:  40%|████      | 8/20 [01:42<02:16, 11.40s/it]
Task 2, Epoch 9/20 => Loss 0.378, Train_accy 91.26:  45%|████▌     | 9/20 [01:42<02:05, 11.41s/it]
Task 2, Epoch 10/20 => Loss 0.339, Train_accy 92.28:  45%|████▌     | 9/20 [01:54<02:05, 11.41s/it]
Task 2, Epoch 10/20 => Loss 0.339, Train_accy 92.28:  50%|█████     | 10/20 [01:54<01:54, 11.47s/it]
Task 2, Epoch 11/20 => Loss 0.336, Train_accy 92.28:  50%|█████     | 10/20 [02:05<01:54, 11.47s/it]
Task 2, Epoch 11/20 => Loss 0.336, Train_accy 92.28:  55%|█████▌    | 11/20 [02:05<01:42, 11.44s/it]
Task 2, Epoch 12/20 => Loss 0.313, Train_accy 92.98:  55%|█████▌    | 11/20 [02:17<01:42, 11.44s/it]
Task 2, Epoch 12/20 => Loss 0.313, Train_accy 92.98:  60%|██████    | 12/20 [02:17<01:31, 11.43s/it]
Task 2, Epoch 13/20 => Loss 0.294, Train_accy 94.00:  60%|██████    | 12/20 [02:28<01:31, 11.43s/it]
Task 2, Epoch 13/20 => Loss 0.294, Train_accy 94.00:  65%|██████▌   | 13/20 [02:28<01:20, 11.43s/it]
Task 2, Epoch 14/20 => Loss 0.304, Train_accy 93.30:  65%|██████▌   | 13/20 [02:39<01:20, 11.43s/it]
Task 2, Epoch 14/20 => Loss 0.304, Train_accy 93.30:  70%|███████   | 14/20 [02:39<01:08, 11.43s/it]
Task 2, Epoch 15/20 => Loss 0.318, Train_accy 92.87:  70%|███████   | 14/20 [02:51<01:08, 11.43s/it]
Task 2, Epoch 15/20 => Loss 0.318, Train_accy 92.87:  75%|███████▌  | 15/20 [02:51<00:57, 11.41s/it]
Task 2, Epoch 16/20 => Loss 0.303, Train_accy 93.46:  75%|███████▌  | 15/20 [03:02<00:57, 11.41s/it]
Task 2, Epoch 16/20 => Loss 0.303, Train_accy 93.46:  80%|████████  | 16/20 [03:02<00:45, 11.41s/it]
Task 2, Epoch 17/20 => Loss 0.289, Train_accy 92.87:  80%|████████  | 16/20 [03:14<00:45, 11.41s/it]
Task 2, Epoch 17/20 => Loss 0.289, Train_accy 92.87:  85%|████████▌ | 17/20 [03:14<00:34, 11.41s/it]
Task 2, Epoch 18/20 => Loss 0.288, Train_accy 94.32:  85%|████████▌ | 17/20 [03:25<00:34, 11.41s/it]
Task 2, Epoch 18/20 => Loss 0.288, Train_accy 94.32:  90%|█████████ | 18/20 [03:25<00:22, 11.39s/it]
Task 2, Epoch 19/20 => Loss 0.328, Train_accy 92.50:  90%|█████████ | 18/20 [03:36<00:22, 11.39s/it]
Task 2, Epoch 19/20 => Loss 0.328, Train_accy 92.50:  95%|█████████▌| 19/20 [03:36<00:11, 11.38s/it]
Task 2, Epoch 20/20 => Loss 0.283, Train_accy 93.84:  95%|█████████▌| 19/20 [03:48<00:11, 11.38s/it]
Task 2, Epoch 20/20 => Loss 0.283, Train_accy 93.84: 100%|██████████| 20/20 [03:48<00:00, 11.38s/it]
Task 2, Epoch 20/20 => Loss 0.283, Train_accy 93.84: 100%|██████████| 20/20 [03:48<00:00, 11.41s/it]
2024-09-06 03:18:18,754 [ease.py] => Task 2, Epoch 20/20 => Loss 0.283, Train_accy 93.84
2024-09-06 03:18:50,336 [ease.py] => Task correct: 90.67796610169492
2024-09-06 03:18:50,337 [ease.py] => Task acc: 96.25706214689265
2024-09-06 03:18:50,362 [trainer.py] => No NME accuracy.
2024-09-06 03:18:50,362 [trainer.py] => CNN: {'total': 88.35, '00-39': 83.48, '40-79': 88.6, '80-119': 92.56, 'old': 86.07, 'new': 92.56}
2024-09-06 03:18:50,362 [trainer.py] => CNN top1 curve: [97.58, 92.06, 88.35]
2024-09-06 03:18:50,362 [trainer.py] => CNN top5 curve: [99.78, 99.24, 98.87]

Average Accuracy (CNN): 92.66
2024-09-06 03:18:50,362 [trainer.py] => Average Accuracy (CNN): 92.66 

2024-09-06 03:18:50,363 [trainer.py] => All params: 86410178
2024-09-06 03:18:50,363 [trainer.py] => Trainable params: 304320
2024-09-06 03:18:50,370 [ease.py] => Learning on 120-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.610, Train_accy 31.59:   0%|          | 0/20 [00:11<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.610, Train_accy 31.59:   5%|▌         | 1/20 [00:11<03:38, 11.48s/it]
Task 3, Epoch 2/20 => Loss 3.062, Train_accy 68.73:   5%|▌         | 1/20 [00:22<03:38, 11.48s/it]
Task 3, Epoch 2/20 => Loss 3.062, Train_accy 68.73:  10%|█         | 2/20 [00:22<03:25, 11.44s/it]
Task 3, Epoch 3/20 => Loss 1.664, Train_accy 82.55:  10%|█         | 2/20 [00:34<03:25, 11.44s/it]
Task 3, Epoch 3/20 => Loss 1.664, Train_accy 82.55:  15%|█▌        | 3/20 [00:34<03:14, 11.45s/it]
Task 3, Epoch 4/20 => Loss 0.790, Train_accy 86.77:  15%|█▌        | 3/20 [00:45<03:14, 11.45s/it]
Task 3, Epoch 4/20 => Loss 0.790, Train_accy 86.77:  20%|██        | 4/20 [00:45<03:02, 11.43s/it]
Task 3, Epoch 5/20 => Loss 0.599, Train_accy 88.42:  20%|██        | 4/20 [00:57<03:02, 11.43s/it]
Task 3, Epoch 5/20 => Loss 0.599, Train_accy 88.42:  25%|██▌       | 5/20 [00:57<02:51, 11.44s/it]
Task 3, Epoch 6/20 => Loss 0.521, Train_accy 89.49:  25%|██▌       | 5/20 [01:08<02:51, 11.44s/it]
Task 3, Epoch 6/20 => Loss 0.521, Train_accy 89.49:  30%|███       | 6/20 [01:08<02:40, 11.43s/it]
Task 3, Epoch 7/20 => Loss 0.488, Train_accy 88.53:  30%|███       | 6/20 [01:20<02:40, 11.43s/it]
Task 3, Epoch 7/20 => Loss 0.488, Train_accy 88.53:  35%|███▌      | 7/20 [01:20<02:28, 11.43s/it]
Task 3, Epoch 8/20 => Loss 0.491, Train_accy 89.91:  35%|███▌      | 7/20 [01:31<02:28, 11.43s/it]
Task 3, Epoch 8/20 => Loss 0.491, Train_accy 89.91:  40%|████      | 8/20 [01:31<02:17, 11.43s/it]
Task 3, Epoch 9/20 => Loss 0.437, Train_accy 90.02:  40%|████      | 8/20 [01:42<02:17, 11.43s/it]
Task 3, Epoch 9/20 => Loss 0.437, Train_accy 90.02:  45%|████▌     | 9/20 [01:42<02:05, 11.44s/it]
Task 3, Epoch 10/20 => Loss 0.417, Train_accy 90.61:  45%|████▌     | 9/20 [01:54<02:05, 11.44s/it]
Task 3, Epoch 10/20 => Loss 0.417, Train_accy 90.61:  50%|█████     | 10/20 [01:54<01:54, 11.44s/it]
Task 3, Epoch 11/20 => Loss 0.407, Train_accy 91.20:  50%|█████     | 10/20 [02:05<01:54, 11.44s/it]
Task 3, Epoch 11/20 => Loss 0.407, Train_accy 91.20:  55%|█████▌    | 11/20 [02:05<01:43, 11.46s/it]
Task 3, Epoch 12/20 => Loss 0.446, Train_accy 89.49:  55%|█████▌    | 11/20 [02:17<01:43, 11.46s/it]
Task 3, Epoch 12/20 => Loss 0.446, Train_accy 89.49:  60%|██████    | 12/20 [02:17<01:31, 11.45s/it]
Task 3, Epoch 13/20 => Loss 0.420, Train_accy 90.88:  60%|██████    | 12/20 [02:28<01:31, 11.45s/it]
Task 3, Epoch 13/20 => Loss 0.420, Train_accy 90.88:  65%|██████▌   | 13/20 [02:28<01:20, 11.47s/it]
Task 3, Epoch 14/20 => Loss 0.366, Train_accy 92.10:  65%|██████▌   | 13/20 [02:40<01:20, 11.47s/it]
Task 3, Epoch 14/20 => Loss 0.366, Train_accy 92.10:  70%|███████   | 14/20 [02:40<01:08, 11.47s/it]
Task 3, Epoch 15/20 => Loss 0.374, Train_accy 90.88:  70%|███████   | 14/20 [02:51<01:08, 11.47s/it]
Task 3, Epoch 15/20 => Loss 0.374, Train_accy 90.88:  75%|███████▌  | 15/20 [02:51<00:57, 11.47s/it]
Task 3, Epoch 16/20 => Loss 0.350, Train_accy 92.16:  75%|███████▌  | 15/20 [03:03<00:57, 11.47s/it]
Task 3, Epoch 16/20 => Loss 0.350, Train_accy 92.16:  80%|████████  | 16/20 [03:03<00:45, 11.47s/it]
Task 3, Epoch 17/20 => Loss 0.392, Train_accy 91.89:  80%|████████  | 16/20 [03:14<00:45, 11.47s/it]
Task 3, Epoch 17/20 => Loss 0.392, Train_accy 91.89:  85%|████████▌ | 17/20 [03:14<00:34, 11.47s/it]
Task 3, Epoch 18/20 => Loss 0.338, Train_accy 92.90:  85%|████████▌ | 17/20 [03:26<00:34, 11.47s/it]
Task 3, Epoch 18/20 => Loss 0.338, Train_accy 92.90:  90%|█████████ | 18/20 [03:26<00:22, 11.47s/it]
Task 3, Epoch 19/20 => Loss 0.344, Train_accy 92.05:  90%|█████████ | 18/20 [03:37<00:22, 11.47s/it]
Task 3, Epoch 19/20 => Loss 0.344, Train_accy 92.05:  95%|█████████▌| 19/20 [03:37<00:11, 11.47s/it]
Task 3, Epoch 20/20 => Loss 0.336, Train_accy 92.69:  95%|█████████▌| 19/20 [03:49<00:11, 11.47s/it]
Task 3, Epoch 20/20 => Loss 0.336, Train_accy 92.69: 100%|██████████| 20/20 [03:49<00:00, 11.47s/it]
Task 3, Epoch 20/20 => Loss 0.336, Train_accy 92.69: 100%|██████████| 20/20 [03:49<00:00, 11.46s/it]
2024-09-06 03:22:39,522 [ease.py] => Task 3, Epoch 20/20 => Loss 0.336, Train_accy 92.69
2024-09-06 03:23:26,955 [ease.py] => Task correct: 89.31782125859334
2024-09-06 03:23:26,956 [ease.py] => Task acc: 95.98096245372818
2024-09-06 03:23:26,979 [trainer.py] => No NME accuracy.
2024-09-06 03:23:26,979 [trainer.py] => CNN: {'total': 86.83, '00-39': 82.38, '40-79': 86.45, '80-119': 91.55, '120-159': 86.53, 'old': 86.94, 'new': 86.53}
2024-09-06 03:23:26,979 [trainer.py] => CNN top1 curve: [97.58, 92.06, 88.35, 86.83]
2024-09-06 03:23:26,979 [trainer.py] => CNN top5 curve: [99.78, 99.24, 98.87, 98.78]

Average Accuracy (CNN): 91.2
2024-09-06 03:23:26,979 [trainer.py] => Average Accuracy (CNN): 91.2 

2024-09-06 03:23:26,980 [trainer.py] => All params: 86625218
2024-09-06 03:23:26,981 [trainer.py] => Trainable params: 304320
2024-09-06 03:23:26,987 [ease.py] => Learning on 160-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.616, Train_accy 32.09:   0%|          | 0/20 [00:11<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.616, Train_accy 32.09:   5%|▌         | 1/20 [00:11<03:40, 11.59s/it]
Task 4, Epoch 2/20 => Loss 3.052, Train_accy 77.64:   5%|▌         | 1/20 [00:23<03:40, 11.59s/it]
Task 4, Epoch 2/20 => Loss 3.052, Train_accy 77.64:  10%|█         | 2/20 [00:23<03:29, 11.61s/it]
Task 4, Epoch 3/20 => Loss 1.585, Train_accy 86.44:  10%|█         | 2/20 [00:34<03:29, 11.61s/it]
Task 4, Epoch 3/20 => Loss 1.585, Train_accy 86.44:  15%|█▌        | 3/20 [00:34<03:17, 11.63s/it]
Task 4, Epoch 4/20 => Loss 0.735, Train_accy 89.16:  15%|█▌        | 3/20 [00:46<03:17, 11.63s/it]
Task 4, Epoch 4/20 => Loss 0.735, Train_accy 89.16:  20%|██        | 4/20 [00:46<03:06, 11.65s/it]
Task 4, Epoch 5/20 => Loss 0.575, Train_accy 89.11:  20%|██        | 4/20 [00:58<03:06, 11.65s/it]
Task 4, Epoch 5/20 => Loss 0.575, Train_accy 89.11:  25%|██▌       | 5/20 [00:58<02:54, 11.65s/it]
Task 4, Epoch 6/20 => Loss 0.481, Train_accy 90.99:  25%|██▌       | 5/20 [01:09<02:54, 11.65s/it]
Task 4, Epoch 6/20 => Loss 0.481, Train_accy 90.99:  30%|███       | 6/20 [01:09<02:43, 11.66s/it]
Task 4, Epoch 7/20 => Loss 0.461, Train_accy 90.89:  30%|███       | 6/20 [01:21<02:43, 11.66s/it]
Task 4, Epoch 7/20 => Loss 0.461, Train_accy 90.89:  35%|███▌      | 7/20 [01:21<02:31, 11.65s/it]
Task 4, Epoch 8/20 => Loss 0.436, Train_accy 90.79:  35%|███▌      | 7/20 [01:33<02:31, 11.65s/it]
Task 4, Epoch 8/20 => Loss 0.436, Train_accy 90.79:  40%|████      | 8/20 [01:33<02:19, 11.65s/it]
Task 4, Epoch 9/20 => Loss 0.379, Train_accy 92.57:  40%|████      | 8/20 [01:44<02:19, 11.65s/it]
Task 4, Epoch 9/20 => Loss 0.379, Train_accy 92.57:  45%|████▌     | 9/20 [01:44<02:08, 11.67s/it]
Task 4, Epoch 10/20 => Loss 0.379, Train_accy 92.30:  45%|████▌     | 9/20 [01:56<02:08, 11.67s/it]
Task 4, Epoch 10/20 => Loss 0.379, Train_accy 92.30:  50%|█████     | 10/20 [01:56<01:56, 11.66s/it]
Task 4, Epoch 11/20 => Loss 0.358, Train_accy 92.62:  50%|█████     | 10/20 [02:08<01:56, 11.66s/it]
Task 4, Epoch 11/20 => Loss 0.358, Train_accy 92.62:  55%|█████▌    | 11/20 [02:08<01:44, 11.66s/it]
Task 4, Epoch 12/20 => Loss 0.355, Train_accy 93.25:  55%|█████▌    | 11/20 [02:19<01:44, 11.66s/it]
Task 4, Epoch 12/20 => Loss 0.355, Train_accy 93.25:  60%|██████    | 12/20 [02:19<01:33, 11.66s/it]
Task 4, Epoch 13/20 => Loss 0.364, Train_accy 92.09:  60%|██████    | 12/20 [02:31<01:33, 11.66s/it]
Task 4, Epoch 13/20 => Loss 0.364, Train_accy 92.09:  65%|██████▌   | 13/20 [02:31<01:21, 11.67s/it]
Task 4, Epoch 14/20 => Loss 0.330, Train_accy 93.19:  65%|██████▌   | 13/20 [02:43<01:21, 11.67s/it]
Task 4, Epoch 14/20 => Loss 0.330, Train_accy 93.19:  70%|███████   | 14/20 [02:43<01:09, 11.66s/it]
Task 4, Epoch 15/20 => Loss 0.340, Train_accy 92.77:  70%|███████   | 14/20 [02:54<01:09, 11.66s/it]
Task 4, Epoch 15/20 => Loss 0.340, Train_accy 92.77:  75%|███████▌  | 15/20 [02:54<00:58, 11.67s/it]
Task 4, Epoch 16/20 => Loss 0.348, Train_accy 92.09:  75%|███████▌  | 15/20 [03:06<00:58, 11.67s/it]
Task 4, Epoch 16/20 => Loss 0.348, Train_accy 92.09:  80%|████████  | 16/20 [03:06<00:46, 11.67s/it]
Task 4, Epoch 17/20 => Loss 0.335, Train_accy 92.83:  80%|████████  | 16/20 [03:18<00:46, 11.67s/it]
Task 4, Epoch 17/20 => Loss 0.335, Train_accy 92.83:  85%|████████▌ | 17/20 [03:18<00:34, 11.66s/it]
Task 4, Epoch 18/20 => Loss 0.318, Train_accy 93.72:  85%|████████▌ | 17/20 [03:29<00:34, 11.66s/it]
Task 4, Epoch 18/20 => Loss 0.318, Train_accy 93.72:  90%|█████████ | 18/20 [03:29<00:23, 11.65s/it]
Task 4, Epoch 19/20 => Loss 0.347, Train_accy 92.36:  90%|█████████ | 18/20 [03:41<00:23, 11.65s/it]
Task 4, Epoch 19/20 => Loss 0.347, Train_accy 92.36:  95%|█████████▌| 19/20 [03:41<00:11, 11.67s/it]
Task 4, Epoch 20/20 => Loss 0.360, Train_accy 92.09:  95%|█████████▌| 19/20 [03:53<00:11, 11.67s/it]
Task 4, Epoch 20/20 => Loss 0.360, Train_accy 92.09: 100%|██████████| 20/20 [03:53<00:00, 11.65s/it]
Task 4, Epoch 20/20 => Loss 0.360, Train_accy 92.09: 100%|██████████| 20/20 [03:53<00:00, 11.66s/it]
2024-09-06 03:27:20,104 [ease.py] => Task 4, Epoch 20/20 => Loss 0.360, Train_accy 92.09
2024-09-06 03:28:26,978 [ease.py] => Task correct: 88.42239185750635
2024-09-06 03:28:26,979 [ease.py] => Task acc: 95.84393553859202
2024-09-06 03:28:27,006 [trainer.py] => No NME accuracy.
2024-09-06 03:28:27,007 [trainer.py] => CNN: {'total': 86.17, '00-39': 81.5, '40-79': 86.02, '80-119': 88.73, '120-159': 84.21, '160-199': 90.15, 'old': 85.19, 'new': 90.15}
2024-09-06 03:28:27,007 [trainer.py] => CNN top1 curve: [97.58, 92.06, 88.35, 86.83, 86.17]
2024-09-06 03:28:27,007 [trainer.py] => CNN top5 curve: [99.78, 99.24, 98.87, 98.78, 98.3]

Average Accuracy (CNN): 90.2
2024-09-06 03:28:27,007 [trainer.py] => Average Accuracy (CNN): 90.2 

Accuracy Matrix (CNN):
[[97.58 88.77 83.48 82.38 81.5 ]
 [ 0.   95.27 88.6  86.45 86.02]
 [ 0.    0.   92.56 91.55 88.73]
 [ 0.    0.    0.   86.53 84.21]
 [ 0.    0.    0.    0.   90.15]]
2024-09-06 03:28:27,008 [trainer.py] => Forgetting (CNN): 7.870000000000001
2024-09-06 03:28:29,673 [trainer.py] => config: ./exps/ease_cub_B0_Inc10.json
2024-09-06 03:28:29,674 [trainer.py] => prefix:  
2024-09-06 03:28:29,674 [trainer.py] => dataset: cub
2024-09-06 03:28:29,674 [trainer.py] => memory_size: 0
2024-09-06 03:28:29,674 [trainer.py] => memory_per_class: 0
2024-09-06 03:28:29,674 [trainer.py] => fixed_memory: False
2024-09-06 03:28:29,674 [trainer.py] => shuffle: True
2024-09-06 03:28:29,674 [trainer.py] => init_cls: 20
2024-09-06 03:28:29,674 [trainer.py] => increment: 20
2024-09-06 03:28:29,674 [trainer.py] => model_name: ease
2024-09-06 03:28:29,674 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-06 03:28:29,674 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 03:28:29,674 [trainer.py] => seed: 1993
2024-09-06 03:28:29,674 [trainer.py] => init_epochs: 20
2024-09-06 03:28:29,674 [trainer.py] => init_lr: 0.025
2024-09-06 03:28:29,674 [trainer.py] => later_epochs: 20
2024-09-06 03:28:29,674 [trainer.py] => later_lr: 0.025
2024-09-06 03:28:29,674 [trainer.py] => batch_size: 48
2024-09-06 03:28:29,674 [trainer.py] => weight_decay: 0.0005
2024-09-06 03:28:29,674 [trainer.py] => min_lr: 0
2024-09-06 03:28:29,674 [trainer.py] => optimizer: sgd
2024-09-06 03:28:29,674 [trainer.py] => scheduler: cosine
2024-09-06 03:28:29,674 [trainer.py] => pretrained: True
2024-09-06 03:28:29,674 [trainer.py] => vpt_type: Deep
2024-09-06 03:28:29,674 [trainer.py] => prompt_token_num: 5
2024-09-06 03:28:29,674 [trainer.py] => ffn_num: 16
2024-09-06 03:28:29,674 [trainer.py] => use_diagonal: False
2024-09-06 03:28:29,674 [trainer.py] => recalc_sim: True
2024-09-06 03:28:29,674 [trainer.py] => alpha: 0.1
2024-09-06 03:28:29,674 [trainer.py] => use_init_ptm: False
2024-09-06 03:28:29,674 [trainer.py] => beta: 0
2024-09-06 03:28:29,674 [trainer.py] => use_old_data: False
2024-09-06 03:28:29,674 [trainer.py] => use_reweight: True
2024-09-06 03:28:29,674 [trainer.py] => moni_adam: False
2024-09-06 03:28:29,674 [trainer.py] => adapter_num: -1
2024-09-06 03:28:29,711 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-06 03:28:32,528 [trainer.py] => All params: 86102976
2024-09-06 03:28:32,528 [trainer.py] => Trainable params: 304320
2024-09-06 03:28:32,538 [ease.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.945, Train_accy 35.31:   0%|          | 0/20 [00:06<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.945, Train_accy 35.31:   5%|▌         | 1/20 [00:06<01:57,  6.21s/it]
Task 0, Epoch 2/20 => Loss 2.692, Train_accy 75.79:   5%|▌         | 1/20 [00:12<01:57,  6.21s/it]
Task 0, Epoch 2/20 => Loss 2.692, Train_accy 75.79:  10%|█         | 2/20 [00:12<01:48,  6.03s/it]
Task 0, Epoch 3/20 => Loss 2.101, Train_accy 84.04:  10%|█         | 2/20 [00:18<01:48,  6.03s/it]
Task 0, Epoch 3/20 => Loss 2.101, Train_accy 84.04:  15%|█▌        | 3/20 [00:18<01:41,  5.98s/it]
Task 0, Epoch 4/20 => Loss 1.378, Train_accy 90.59:  15%|█▌        | 3/20 [00:23<01:41,  5.98s/it]
Task 0, Epoch 4/20 => Loss 1.378, Train_accy 90.59:  20%|██        | 4/20 [00:23<01:35,  5.97s/it]
Task 0, Epoch 5/20 => Loss 0.852, Train_accy 92.60:  20%|██        | 4/20 [00:29<01:35,  5.97s/it]
Task 0, Epoch 5/20 => Loss 0.852, Train_accy 92.60:  25%|██▌       | 5/20 [00:29<01:29,  5.95s/it]
Task 0, Epoch 6/20 => Loss 0.619, Train_accy 92.71:  25%|██▌       | 5/20 [00:35<01:29,  5.95s/it]
Task 0, Epoch 6/20 => Loss 0.619, Train_accy 92.71:  30%|███       | 6/20 [00:35<01:23,  5.94s/it]
Task 0, Epoch 7/20 => Loss 0.497, Train_accy 93.02:  30%|███       | 6/20 [00:41<01:23,  5.94s/it]
Task 0, Epoch 7/20 => Loss 0.497, Train_accy 93.02:  35%|███▌      | 7/20 [00:41<01:17,  5.93s/it]
Task 0, Epoch 8/20 => Loss 0.435, Train_accy 93.02:  35%|███▌      | 7/20 [00:47<01:17,  5.93s/it]
Task 0, Epoch 8/20 => Loss 0.435, Train_accy 93.02:  40%|████      | 8/20 [00:47<01:11,  5.94s/it]
Task 0, Epoch 9/20 => Loss 0.374, Train_accy 94.61:  40%|████      | 8/20 [00:53<01:11,  5.94s/it]
Task 0, Epoch 9/20 => Loss 0.374, Train_accy 94.61:  45%|████▌     | 9/20 [00:53<01:05,  5.94s/it]
Task 0, Epoch 10/20 => Loss 0.362, Train_accy 94.08:  45%|████▌     | 9/20 [00:59<01:05,  5.94s/it]
Task 0, Epoch 10/20 => Loss 0.362, Train_accy 94.08:  50%|█████     | 10/20 [00:59<00:59,  5.93s/it]
Task 0, Epoch 11/20 => Loss 0.363, Train_accy 93.02:  50%|█████     | 10/20 [01:05<00:59,  5.93s/it]
Task 0, Epoch 11/20 => Loss 0.363, Train_accy 93.02:  55%|█████▌    | 11/20 [01:05<00:53,  5.93s/it]
Task 0, Epoch 12/20 => Loss 0.319, Train_accy 94.71:  55%|█████▌    | 11/20 [01:11<00:53,  5.93s/it]
Task 0, Epoch 12/20 => Loss 0.319, Train_accy 94.71:  60%|██████    | 12/20 [01:11<00:47,  5.92s/it]
Task 0, Epoch 13/20 => Loss 0.309, Train_accy 94.71:  60%|██████    | 12/20 [01:17<00:47,  5.92s/it]
Task 0, Epoch 13/20 => Loss 0.309, Train_accy 94.71:  65%|██████▌   | 13/20 [01:17<00:41,  5.92s/it]
Task 0, Epoch 14/20 => Loss 0.342, Train_accy 93.55:  65%|██████▌   | 13/20 [01:23<00:41,  5.92s/it]
Task 0, Epoch 14/20 => Loss 0.342, Train_accy 93.55:  70%|███████   | 14/20 [01:23<00:35,  5.92s/it]
Task 0, Epoch 15/20 => Loss 0.305, Train_accy 94.19:  70%|███████   | 14/20 [01:29<00:35,  5.92s/it]
Task 0, Epoch 15/20 => Loss 0.305, Train_accy 94.19:  75%|███████▌  | 15/20 [01:29<00:29,  5.93s/it]
Task 0, Epoch 16/20 => Loss 0.311, Train_accy 94.08:  75%|███████▌  | 15/20 [01:35<00:29,  5.93s/it]
Task 0, Epoch 16/20 => Loss 0.311, Train_accy 94.08:  80%|████████  | 16/20 [01:35<00:23,  5.93s/it]
Task 0, Epoch 17/20 => Loss 0.292, Train_accy 95.03:  80%|████████  | 16/20 [01:41<00:23,  5.93s/it]
Task 0, Epoch 17/20 => Loss 0.292, Train_accy 95.03:  85%|████████▌ | 17/20 [01:41<00:17,  5.93s/it]
Task 0, Epoch 18/20 => Loss 0.298, Train_accy 95.14:  85%|████████▌ | 17/20 [01:46<00:17,  5.93s/it]
Task 0, Epoch 18/20 => Loss 0.298, Train_accy 95.14:  90%|█████████ | 18/20 [01:46<00:11,  5.93s/it]
Task 0, Epoch 19/20 => Loss 0.327, Train_accy 93.55:  90%|█████████ | 18/20 [01:52<00:11,  5.93s/it]
Task 0, Epoch 19/20 => Loss 0.327, Train_accy 93.55:  95%|█████████▌| 19/20 [01:52<00:05,  5.93s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 93.97:  95%|█████████▌| 19/20 [01:58<00:05,  5.93s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 93.97: 100%|██████████| 20/20 [01:58<00:00,  5.92s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 93.97: 100%|██████████| 20/20 [01:58<00:00,  5.94s/it]
2024-09-06 03:30:31,392 [ease.py] => Task 0, Epoch 20/20 => Loss 0.311, Train_accy 93.97
2024-09-06 03:30:35,949 [ease.py] => Task correct: 100.0
2024-09-06 03:30:35,949 [ease.py] => Task acc: 98.78542510121457
2024-09-06 03:30:35,972 [trainer.py] => No NME accuracy.
2024-09-06 03:30:35,972 [trainer.py] => CNN: {'total': 98.79, '00-19': 98.79, 'old': 0, 'new': 98.79}
2024-09-06 03:30:35,972 [trainer.py] => CNN top1 curve: [98.79]
2024-09-06 03:30:35,972 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.79
2024-09-06 03:30:35,972 [trainer.py] => Average Accuracy (CNN): 98.79 

2024-09-06 03:30:35,973 [trainer.py] => All params: 86133698
2024-09-06 03:30:35,974 [trainer.py] => Trainable params: 304320
2024-09-06 03:30:35,975 [ease.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.948, Train_accy 33.54:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.948, Train_accy 33.54:   5%|▌         | 1/20 [00:05<01:51,  5.87s/it]
Task 1, Epoch 2/20 => Loss 2.686, Train_accy 82.96:   5%|▌         | 1/20 [00:11<01:51,  5.87s/it]
Task 1, Epoch 2/20 => Loss 2.686, Train_accy 82.96:  10%|█         | 2/20 [00:11<01:45,  5.88s/it]
Task 1, Epoch 3/20 => Loss 2.067, Train_accy 87.09:  10%|█         | 2/20 [00:17<01:45,  5.88s/it]
Task 1, Epoch 3/20 => Loss 2.067, Train_accy 87.09:  15%|█▌        | 3/20 [00:17<01:40,  5.92s/it]
Task 1, Epoch 4/20 => Loss 1.281, Train_accy 91.43:  15%|█▌        | 3/20 [00:23<01:40,  5.92s/it]
Task 1, Epoch 4/20 => Loss 1.281, Train_accy 91.43:  20%|██        | 4/20 [00:23<01:34,  5.92s/it]
Task 1, Epoch 5/20 => Loss 0.789, Train_accy 92.80:  20%|██        | 4/20 [00:29<01:34,  5.92s/it]
Task 1, Epoch 5/20 => Loss 0.789, Train_accy 92.80:  25%|██▌       | 5/20 [00:29<01:28,  5.91s/it]
Task 1, Epoch 6/20 => Loss 0.526, Train_accy 95.03:  25%|██▌       | 5/20 [00:35<01:28,  5.91s/it]
Task 1, Epoch 6/20 => Loss 0.526, Train_accy 95.03:  30%|███       | 6/20 [00:35<01:22,  5.92s/it]
Task 1, Epoch 7/20 => Loss 0.472, Train_accy 93.23:  30%|███       | 6/20 [00:41<01:22,  5.92s/it]
Task 1, Epoch 7/20 => Loss 0.472, Train_accy 93.23:  35%|███▌      | 7/20 [00:41<01:16,  5.91s/it]
Task 1, Epoch 8/20 => Loss 0.395, Train_accy 94.07:  35%|███▌      | 7/20 [00:47<01:16,  5.91s/it]
Task 1, Epoch 8/20 => Loss 0.395, Train_accy 94.07:  40%|████      | 8/20 [00:47<01:10,  5.92s/it]
Task 1, Epoch 9/20 => Loss 0.365, Train_accy 94.50:  40%|████      | 8/20 [00:53<01:10,  5.92s/it]
Task 1, Epoch 9/20 => Loss 0.365, Train_accy 94.50:  45%|████▌     | 9/20 [00:53<01:04,  5.90s/it]
Task 1, Epoch 10/20 => Loss 0.333, Train_accy 94.92:  45%|████▌     | 9/20 [00:59<01:04,  5.90s/it]
Task 1, Epoch 10/20 => Loss 0.333, Train_accy 94.92:  50%|█████     | 10/20 [00:59<00:59,  5.91s/it]
Task 1, Epoch 11/20 => Loss 0.338, Train_accy 94.92:  50%|█████     | 10/20 [01:04<00:59,  5.91s/it]
Task 1, Epoch 11/20 => Loss 0.338, Train_accy 94.92:  55%|█████▌    | 11/20 [01:04<00:53,  5.90s/it]
Task 1, Epoch 12/20 => Loss 0.282, Train_accy 95.77:  55%|█████▌    | 11/20 [01:10<00:53,  5.90s/it]
Task 1, Epoch 12/20 => Loss 0.282, Train_accy 95.77:  60%|██████    | 12/20 [01:10<00:47,  5.91s/it]
Task 1, Epoch 13/20 => Loss 0.281, Train_accy 95.34:  60%|██████    | 12/20 [01:16<00:47,  5.91s/it]
Task 1, Epoch 13/20 => Loss 0.281, Train_accy 95.34:  65%|██████▌   | 13/20 [01:16<00:41,  5.93s/it]
Task 1, Epoch 14/20 => Loss 0.295, Train_accy 95.34:  65%|██████▌   | 13/20 [01:22<00:41,  5.93s/it]
Task 1, Epoch 14/20 => Loss 0.295, Train_accy 95.34:  70%|███████   | 14/20 [01:22<00:35,  5.93s/it]
Task 1, Epoch 15/20 => Loss 0.264, Train_accy 95.66:  70%|███████   | 14/20 [01:28<00:35,  5.93s/it]
Task 1, Epoch 15/20 => Loss 0.264, Train_accy 95.66:  75%|███████▌  | 15/20 [01:28<00:29,  5.92s/it]
Task 1, Epoch 16/20 => Loss 0.278, Train_accy 95.13:  75%|███████▌  | 15/20 [01:34<00:29,  5.92s/it]
Task 1, Epoch 16/20 => Loss 0.278, Train_accy 95.13:  80%|████████  | 16/20 [01:34<00:23,  5.91s/it]
Task 1, Epoch 17/20 => Loss 0.277, Train_accy 95.87:  80%|████████  | 16/20 [01:40<00:23,  5.91s/it]
Task 1, Epoch 17/20 => Loss 0.277, Train_accy 95.87:  85%|████████▌ | 17/20 [01:40<00:17,  5.91s/it]
Task 1, Epoch 18/20 => Loss 0.289, Train_accy 94.60:  85%|████████▌ | 17/20 [01:46<00:17,  5.91s/it]
Task 1, Epoch 18/20 => Loss 0.289, Train_accy 94.60:  90%|█████████ | 18/20 [01:46<00:11,  5.91s/it]
Task 1, Epoch 19/20 => Loss 0.278, Train_accy 94.92:  90%|█████████ | 18/20 [01:52<00:11,  5.91s/it]
Task 1, Epoch 19/20 => Loss 0.278, Train_accy 94.92:  95%|█████████▌| 19/20 [01:52<00:05,  5.91s/it]
Task 1, Epoch 20/20 => Loss 0.294, Train_accy 95.13:  95%|█████████▌| 19/20 [01:58<00:05,  5.91s/it]
Task 1, Epoch 20/20 => Loss 0.294, Train_accy 95.13: 100%|██████████| 20/20 [01:58<00:00,  5.91s/it]
Task 1, Epoch 20/20 => Loss 0.294, Train_accy 95.13: 100%|██████████| 20/20 [01:58<00:00,  5.91s/it]
2024-09-06 03:32:34,211 [ease.py] => Task 1, Epoch 20/20 => Loss 0.294, Train_accy 95.13
2024-09-06 03:32:43,970 [ease.py] => Task correct: 98.01762114537445
2024-09-06 03:32:43,970 [ease.py] => Task acc: 98.6784140969163
2024-09-06 03:32:43,992 [trainer.py] => No NME accuracy.
2024-09-06 03:32:43,992 [trainer.py] => CNN: {'total': 96.92, '00-19': 96.36, '20-39': 97.58, 'old': 96.36, 'new': 97.58}
2024-09-06 03:32:43,992 [trainer.py] => CNN top1 curve: [98.79, 96.92]
2024-09-06 03:32:43,992 [trainer.py] => CNN top5 curve: [100.0, 99.78]

Average Accuracy (CNN): 97.86
2024-09-06 03:32:43,992 [trainer.py] => Average Accuracy (CNN): 97.86 

2024-09-06 03:32:43,993 [trainer.py] => All params: 86179778
2024-09-06 03:32:43,994 [trainer.py] => Trainable params: 304320
2024-09-06 03:32:43,996 [ease.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.953, Train_accy 32.03:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.953, Train_accy 32.03:   5%|▌         | 1/20 [00:05<01:52,  5.93s/it]
Task 2, Epoch 2/20 => Loss 2.719, Train_accy 84.94:   5%|▌         | 1/20 [00:11<01:52,  5.93s/it]
Task 2, Epoch 2/20 => Loss 2.719, Train_accy 84.94:  10%|█         | 2/20 [00:11<01:46,  5.92s/it]
Task 2, Epoch 3/20 => Loss 2.152, Train_accy 91.62:  10%|█         | 2/20 [00:17<01:46,  5.92s/it]
Task 2, Epoch 3/20 => Loss 2.152, Train_accy 91.62:  15%|█▌        | 3/20 [00:17<01:40,  5.91s/it]
Task 2, Epoch 4/20 => Loss 1.430, Train_accy 91.73:  15%|█▌        | 3/20 [00:23<01:40,  5.91s/it]
Task 2, Epoch 4/20 => Loss 1.430, Train_accy 91.73:  20%|██        | 4/20 [00:23<01:34,  5.90s/it]
Task 2, Epoch 5/20 => Loss 0.843, Train_accy 93.96:  20%|██        | 4/20 [00:29<01:34,  5.90s/it]
Task 2, Epoch 5/20 => Loss 0.843, Train_accy 93.96:  25%|██▌       | 5/20 [00:29<01:28,  5.90s/it]
Task 2, Epoch 6/20 => Loss 0.584, Train_accy 93.64:  25%|██▌       | 5/20 [00:35<01:28,  5.90s/it]
Task 2, Epoch 6/20 => Loss 0.584, Train_accy 93.64:  30%|███       | 6/20 [00:35<01:22,  5.90s/it]
Task 2, Epoch 7/20 => Loss 0.459, Train_accy 93.43:  30%|███       | 6/20 [00:41<01:22,  5.90s/it]
Task 2, Epoch 7/20 => Loss 0.459, Train_accy 93.43:  35%|███▌      | 7/20 [00:41<01:16,  5.89s/it]
Task 2, Epoch 8/20 => Loss 0.393, Train_accy 94.38:  35%|███▌      | 7/20 [00:47<01:16,  5.89s/it]
Task 2, Epoch 8/20 => Loss 0.393, Train_accy 94.38:  40%|████      | 8/20 [00:47<01:10,  5.90s/it]
Task 2, Epoch 9/20 => Loss 0.364, Train_accy 94.17:  40%|████      | 8/20 [00:53<01:10,  5.90s/it]
Task 2, Epoch 9/20 => Loss 0.364, Train_accy 94.17:  45%|████▌     | 9/20 [00:53<01:04,  5.90s/it]
Task 2, Epoch 10/20 => Loss 0.330, Train_accy 94.49:  45%|████▌     | 9/20 [00:59<01:04,  5.90s/it]
Task 2, Epoch 10/20 => Loss 0.330, Train_accy 94.49:  50%|█████     | 10/20 [00:59<00:58,  5.90s/it]
Task 2, Epoch 11/20 => Loss 0.362, Train_accy 93.00:  50%|█████     | 10/20 [01:04<00:58,  5.90s/it]
Task 2, Epoch 11/20 => Loss 0.362, Train_accy 93.00:  55%|█████▌    | 11/20 [01:04<00:53,  5.92s/it]
Task 2, Epoch 12/20 => Loss 0.336, Train_accy 93.53:  55%|█████▌    | 11/20 [01:10<00:53,  5.92s/it]
Task 2, Epoch 12/20 => Loss 0.336, Train_accy 93.53:  60%|██████    | 12/20 [01:10<00:47,  5.91s/it]
Task 2, Epoch 13/20 => Loss 0.320, Train_accy 93.74:  60%|██████    | 12/20 [01:16<00:47,  5.91s/it]
Task 2, Epoch 13/20 => Loss 0.320, Train_accy 93.74:  65%|██████▌   | 13/20 [01:16<00:41,  5.90s/it]
Task 2, Epoch 14/20 => Loss 0.331, Train_accy 93.53:  65%|██████▌   | 13/20 [01:22<00:41,  5.90s/it]
Task 2, Epoch 14/20 => Loss 0.331, Train_accy 93.53:  70%|███████   | 14/20 [01:22<00:35,  5.90s/it]
Task 2, Epoch 15/20 => Loss 0.304, Train_accy 94.49:  70%|███████   | 14/20 [01:28<00:35,  5.90s/it]
Task 2, Epoch 15/20 => Loss 0.304, Train_accy 94.49:  75%|███████▌  | 15/20 [01:28<00:29,  5.92s/it]
Task 2, Epoch 16/20 => Loss 0.303, Train_accy 94.59:  75%|███████▌  | 15/20 [01:34<00:29,  5.92s/it]
Task 2, Epoch 16/20 => Loss 0.303, Train_accy 94.59:  80%|████████  | 16/20 [01:34<00:23,  5.91s/it]
Task 2, Epoch 17/20 => Loss 0.273, Train_accy 94.91:  80%|████████  | 16/20 [01:40<00:23,  5.91s/it]
Task 2, Epoch 17/20 => Loss 0.273, Train_accy 94.91:  85%|████████▌ | 17/20 [01:40<00:17,  5.91s/it]
Task 2, Epoch 18/20 => Loss 0.288, Train_accy 94.59:  85%|████████▌ | 17/20 [01:46<00:17,  5.91s/it]
Task 2, Epoch 18/20 => Loss 0.288, Train_accy 94.59:  90%|█████████ | 18/20 [01:46<00:11,  5.92s/it]
Task 2, Epoch 19/20 => Loss 0.301, Train_accy 94.38:  90%|█████████ | 18/20 [01:52<00:11,  5.92s/it]
Task 2, Epoch 19/20 => Loss 0.301, Train_accy 94.38:  95%|█████████▌| 19/20 [01:52<00:05,  5.91s/it]
Task 2, Epoch 20/20 => Loss 0.279, Train_accy 94.27:  95%|█████████▌| 19/20 [01:58<00:05,  5.91s/it]
Task 2, Epoch 20/20 => Loss 0.279, Train_accy 94.27: 100%|██████████| 20/20 [01:58<00:00,  5.91s/it]
Task 2, Epoch 20/20 => Loss 0.279, Train_accy 94.27: 100%|██████████| 20/20 [01:58<00:00,  5.91s/it]
2024-09-06 03:34:42,124 [ease.py] => Task 2, Epoch 20/20 => Loss 0.279, Train_accy 94.27
2024-09-06 03:34:58,583 [ease.py] => Task correct: 94.79166666666667
2024-09-06 03:34:58,584 [ease.py] => Task acc: 98.21428571428571
2024-09-06 03:34:58,604 [trainer.py] => No NME accuracy.
2024-09-06 03:34:58,605 [trainer.py] => CNN: {'total': 93.6, '00-19': 89.88, '20-39': 96.14, '40-59': 95.41, 'old': 92.73, 'new': 95.41}
2024-09-06 03:34:58,605 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6]
2024-09-06 03:34:58,605 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26]

Average Accuracy (CNN): 96.44
2024-09-06 03:34:58,605 [trainer.py] => Average Accuracy (CNN): 96.44 

2024-09-06 03:34:58,605 [trainer.py] => All params: 86256578
2024-09-06 03:34:58,606 [trainer.py] => Trainable params: 304320
2024-09-06 03:34:58,609 [ease.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.948, Train_accy 31.61:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.948, Train_accy 31.61:   5%|▌         | 1/20 [00:05<01:52,  5.93s/it]
Task 3, Epoch 2/20 => Loss 2.688, Train_accy 84.14:   5%|▌         | 1/20 [00:11<01:52,  5.93s/it]
Task 3, Epoch 2/20 => Loss 2.688, Train_accy 84.14:  10%|█         | 2/20 [00:11<01:46,  5.91s/it]
Task 3, Epoch 3/20 => Loss 2.072, Train_accy 92.28:  10%|█         | 2/20 [00:17<01:46,  5.91s/it]
Task 3, Epoch 3/20 => Loss 2.072, Train_accy 92.28:  15%|█▌        | 3/20 [00:17<01:40,  5.91s/it]
Task 3, Epoch 4/20 => Loss 1.254, Train_accy 92.18:  15%|█▌        | 3/20 [00:23<01:40,  5.91s/it]
Task 3, Epoch 4/20 => Loss 1.254, Train_accy 92.18:  20%|██        | 4/20 [00:23<01:34,  5.91s/it]
Task 3, Epoch 5/20 => Loss 0.742, Train_accy 93.66:  20%|██        | 4/20 [00:29<01:34,  5.91s/it]
Task 3, Epoch 5/20 => Loss 0.742, Train_accy 93.66:  25%|██▌       | 5/20 [00:29<01:28,  5.91s/it]
Task 3, Epoch 6/20 => Loss 0.469, Train_accy 94.71:  25%|██▌       | 5/20 [00:35<01:28,  5.91s/it]
Task 3, Epoch 6/20 => Loss 0.469, Train_accy 94.71:  30%|███       | 6/20 [00:35<01:22,  5.92s/it]
Task 3, Epoch 7/20 => Loss 0.401, Train_accy 93.97:  30%|███       | 6/20 [00:41<01:22,  5.92s/it]
Task 3, Epoch 7/20 => Loss 0.401, Train_accy 93.97:  35%|███▌      | 7/20 [00:41<01:16,  5.92s/it]
Task 3, Epoch 8/20 => Loss 0.341, Train_accy 93.45:  35%|███▌      | 7/20 [00:47<01:16,  5.92s/it]
Task 3, Epoch 8/20 => Loss 0.341, Train_accy 93.45:  40%|████      | 8/20 [00:47<01:11,  5.92s/it]
Task 3, Epoch 9/20 => Loss 0.305, Train_accy 94.93:  40%|████      | 8/20 [00:53<01:11,  5.92s/it]
Task 3, Epoch 9/20 => Loss 0.305, Train_accy 94.93:  45%|████▌     | 9/20 [00:53<01:05,  5.91s/it]
Task 3, Epoch 10/20 => Loss 0.318, Train_accy 94.50:  45%|████▌     | 9/20 [00:59<01:05,  5.91s/it]
Task 3, Epoch 10/20 => Loss 0.318, Train_accy 94.50:  50%|█████     | 10/20 [00:59<00:59,  5.91s/it]
Task 3, Epoch 11/20 => Loss 0.291, Train_accy 94.08:  50%|█████     | 10/20 [01:05<00:59,  5.91s/it]
Task 3, Epoch 11/20 => Loss 0.291, Train_accy 94.08:  55%|█████▌    | 11/20 [01:05<00:53,  5.91s/it]
Task 3, Epoch 12/20 => Loss 0.303, Train_accy 94.29:  55%|█████▌    | 11/20 [01:10<00:53,  5.91s/it]
Task 3, Epoch 12/20 => Loss 0.303, Train_accy 94.29:  60%|██████    | 12/20 [01:10<00:47,  5.92s/it]
Task 3, Epoch 13/20 => Loss 0.278, Train_accy 94.50:  60%|██████    | 12/20 [01:16<00:47,  5.92s/it]
Task 3, Epoch 13/20 => Loss 0.278, Train_accy 94.50:  65%|██████▌   | 13/20 [01:16<00:41,  5.92s/it]
Task 3, Epoch 14/20 => Loss 0.292, Train_accy 94.40:  65%|██████▌   | 13/20 [01:22<00:41,  5.92s/it]
Task 3, Epoch 14/20 => Loss 0.292, Train_accy 94.40:  70%|███████   | 14/20 [01:22<00:35,  5.93s/it]
Task 3, Epoch 15/20 => Loss 0.262, Train_accy 95.35:  70%|███████   | 14/20 [01:28<00:35,  5.93s/it]
Task 3, Epoch 15/20 => Loss 0.262, Train_accy 95.35:  75%|███████▌  | 15/20 [01:28<00:29,  5.95s/it]
Task 3, Epoch 16/20 => Loss 0.272, Train_accy 94.50:  75%|███████▌  | 15/20 [01:34<00:29,  5.95s/it]
Task 3, Epoch 16/20 => Loss 0.272, Train_accy 94.50:  80%|████████  | 16/20 [01:34<00:23,  5.96s/it]
Task 3, Epoch 17/20 => Loss 0.226, Train_accy 96.19:  80%|████████  | 16/20 [01:40<00:23,  5.96s/it]
Task 3, Epoch 17/20 => Loss 0.226, Train_accy 96.19:  85%|████████▌ | 17/20 [01:40<00:17,  5.94s/it]
Task 3, Epoch 18/20 => Loss 0.250, Train_accy 95.03:  85%|████████▌ | 17/20 [01:46<00:17,  5.94s/it]
Task 3, Epoch 18/20 => Loss 0.250, Train_accy 95.03:  90%|█████████ | 18/20 [01:46<00:11,  5.94s/it]
Task 3, Epoch 19/20 => Loss 0.277, Train_accy 94.82:  90%|█████████ | 18/20 [01:52<00:11,  5.94s/it]
Task 3, Epoch 19/20 => Loss 0.277, Train_accy 94.82:  95%|█████████▌| 19/20 [01:52<00:05,  5.93s/it]
Task 3, Epoch 20/20 => Loss 0.238, Train_accy 95.03:  95%|█████████▌| 19/20 [01:58<00:05,  5.93s/it]
Task 3, Epoch 20/20 => Loss 0.238, Train_accy 95.03: 100%|██████████| 20/20 [01:58<00:00,  5.92s/it]
Task 3, Epoch 20/20 => Loss 0.238, Train_accy 95.03: 100%|██████████| 20/20 [01:58<00:00,  5.92s/it]
2024-09-06 03:36:57,113 [ease.py] => Task 3, Epoch 20/20 => Loss 0.238, Train_accy 95.03
2024-09-06 03:37:21,495 [ease.py] => Task correct: 92.6006528835691
2024-09-06 03:37:21,496 [ease.py] => Task acc: 98.36779107725789
2024-09-06 03:37:21,522 [trainer.py] => No NME accuracy.
2024-09-06 03:37:21,522 [trainer.py] => CNN: {'total': 91.84, '00-19': 85.83, '20-39': 93.24, '40-59': 93.12, '60-79': 95.55, 'old': 90.48, 'new': 95.55}
2024-09-06 03:37:21,522 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6, 91.84]
2024-09-06 03:37:21,522 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.13]

Average Accuracy (CNN): 95.29
2024-09-06 03:37:21,523 [trainer.py] => Average Accuracy (CNN): 95.29 

2024-09-06 03:37:21,523 [trainer.py] => All params: 86364098
2024-09-06 03:37:21,524 [trainer.py] => Trainable params: 304320
2024-09-06 03:37:21,529 [ease.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.940, Train_accy 36.00:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.940, Train_accy 36.00:   5%|▌         | 1/20 [00:05<01:48,  5.74s/it]
Task 4, Epoch 2/20 => Loss 2.665, Train_accy 80.74:   5%|▌         | 1/20 [00:11<01:48,  5.74s/it]
Task 4, Epoch 2/20 => Loss 2.665, Train_accy 80.74:  10%|█         | 2/20 [00:11<01:43,  5.75s/it]
Task 4, Epoch 3/20 => Loss 2.004, Train_accy 86.43:  10%|█         | 2/20 [00:17<01:43,  5.75s/it]
Task 4, Epoch 3/20 => Loss 2.004, Train_accy 86.43:  15%|█▌        | 3/20 [00:17<01:37,  5.75s/it]
Task 4, Epoch 4/20 => Loss 1.171, Train_accy 90.48:  15%|█▌        | 3/20 [00:23<01:37,  5.75s/it]
Task 4, Epoch 4/20 => Loss 1.171, Train_accy 90.48:  20%|██        | 4/20 [00:23<01:32,  5.75s/it]
Task 4, Epoch 5/20 => Loss 0.693, Train_accy 92.12:  20%|██        | 4/20 [00:28<01:32,  5.75s/it]
Task 4, Epoch 5/20 => Loss 0.693, Train_accy 92.12:  25%|██▌       | 5/20 [00:28<01:26,  5.77s/it]
Task 4, Epoch 6/20 => Loss 0.494, Train_accy 91.14:  25%|██▌       | 5/20 [00:34<01:26,  5.77s/it]
Task 4, Epoch 6/20 => Loss 0.494, Train_accy 91.14:  30%|███       | 6/20 [00:34<01:20,  5.77s/it]
Task 4, Epoch 7/20 => Loss 0.446, Train_accy 92.89:  30%|███       | 6/20 [00:40<01:20,  5.77s/it]
Task 4, Epoch 7/20 => Loss 0.446, Train_accy 92.89:  35%|███▌      | 7/20 [00:40<01:15,  5.77s/it]
Task 4, Epoch 8/20 => Loss 0.355, Train_accy 93.22:  35%|███▌      | 7/20 [00:46<01:15,  5.77s/it]
Task 4, Epoch 8/20 => Loss 0.355, Train_accy 93.22:  40%|████      | 8/20 [00:46<01:09,  5.77s/it]
Task 4, Epoch 9/20 => Loss 0.323, Train_accy 92.45:  40%|████      | 8/20 [00:51<01:09,  5.77s/it]
Task 4, Epoch 9/20 => Loss 0.323, Train_accy 92.45:  45%|████▌     | 9/20 [00:51<01:03,  5.79s/it]
Task 4, Epoch 10/20 => Loss 0.320, Train_accy 92.89:  45%|████▌     | 9/20 [00:57<01:03,  5.79s/it]
Task 4, Epoch 10/20 => Loss 0.320, Train_accy 92.89:  50%|█████     | 10/20 [00:57<00:57,  5.79s/it]
Task 4, Epoch 11/20 => Loss 0.313, Train_accy 92.56:  50%|█████     | 10/20 [01:03<00:57,  5.79s/it]
Task 4, Epoch 11/20 => Loss 0.313, Train_accy 92.56:  55%|█████▌    | 11/20 [01:03<00:52,  5.79s/it]
Task 4, Epoch 12/20 => Loss 0.305, Train_accy 92.67:  55%|█████▌    | 11/20 [01:09<00:52,  5.79s/it]
Task 4, Epoch 12/20 => Loss 0.305, Train_accy 92.67:  60%|██████    | 12/20 [01:09<00:46,  5.78s/it]
Task 4, Epoch 13/20 => Loss 0.290, Train_accy 93.11:  60%|██████    | 12/20 [01:15<00:46,  5.78s/it]
Task 4, Epoch 13/20 => Loss 0.290, Train_accy 93.11:  65%|██████▌   | 13/20 [01:15<00:40,  5.77s/it]
Task 4, Epoch 14/20 => Loss 0.252, Train_accy 95.30:  65%|██████▌   | 13/20 [01:20<00:40,  5.77s/it]
Task 4, Epoch 14/20 => Loss 0.252, Train_accy 95.30:  70%|███████   | 14/20 [01:20<00:34,  5.77s/it]
Task 4, Epoch 15/20 => Loss 0.294, Train_accy 94.97:  70%|███████   | 14/20 [01:26<00:34,  5.77s/it]
Task 4, Epoch 15/20 => Loss 0.294, Train_accy 94.97:  75%|███████▌  | 15/20 [01:26<00:28,  5.76s/it]
Task 4, Epoch 16/20 => Loss 0.313, Train_accy 93.44:  75%|███████▌  | 15/20 [01:32<00:28,  5.76s/it]
Task 4, Epoch 16/20 => Loss 0.313, Train_accy 93.44:  80%|████████  | 16/20 [01:32<00:23,  5.76s/it]
Task 4, Epoch 17/20 => Loss 0.259, Train_accy 94.09:  80%|████████  | 16/20 [01:38<00:23,  5.76s/it]
Task 4, Epoch 17/20 => Loss 0.259, Train_accy 94.09:  85%|████████▌ | 17/20 [01:38<00:17,  5.77s/it]
Task 4, Epoch 18/20 => Loss 0.284, Train_accy 93.11:  85%|████████▌ | 17/20 [01:43<00:17,  5.77s/it]
Task 4, Epoch 18/20 => Loss 0.284, Train_accy 93.11:  90%|█████████ | 18/20 [01:43<00:11,  5.77s/it]
Task 4, Epoch 19/20 => Loss 0.278, Train_accy 93.33:  90%|█████████ | 18/20 [01:49<00:11,  5.77s/it]
Task 4, Epoch 19/20 => Loss 0.278, Train_accy 93.33:  95%|█████████▌| 19/20 [01:49<00:05,  5.77s/it]
Task 4, Epoch 20/20 => Loss 0.286, Train_accy 92.56:  95%|█████████▌| 19/20 [01:55<00:05,  5.77s/it]
Task 4, Epoch 20/20 => Loss 0.286, Train_accy 92.56: 100%|██████████| 20/20 [01:55<00:00,  5.76s/it]
Task 4, Epoch 20/20 => Loss 0.286, Train_accy 92.56: 100%|██████████| 20/20 [01:55<00:00,  5.77s/it]
2024-09-06 03:39:16,900 [ease.py] => Task 4, Epoch 20/20 => Loss 0.286, Train_accy 92.56
2024-09-06 03:39:50,693 [ease.py] => Task correct: 90.65656565656566
2024-09-06 03:39:50,694 [ease.py] => Task acc: 98.23232323232324
2024-09-06 03:39:50,715 [trainer.py] => No NME accuracy.
2024-09-06 03:39:50,715 [trainer.py] => CNN: {'total': 89.81, '00-19': 80.16, '20-39': 89.37, '40-59': 91.28, '60-79': 92.31, '80-99': 95.54, 'old': 88.14, 'new': 95.54}
2024-09-06 03:39:50,715 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6, 91.84, 89.81]
2024-09-06 03:39:50,715 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.13, 99.16]

Average Accuracy (CNN): 94.19
2024-09-06 03:39:50,715 [trainer.py] => Average Accuracy (CNN): 94.19 

2024-09-06 03:39:50,716 [trainer.py] => All params: 86502338
2024-09-06 03:39:50,716 [trainer.py] => Trainable params: 304320
2024-09-06 03:39:50,721 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.955, Train_accy 29.83:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.955, Train_accy 29.83:   5%|▌         | 1/20 [00:05<01:53,  5.99s/it]
Task 5, Epoch 2/20 => Loss 2.709, Train_accy 87.92:   5%|▌         | 1/20 [00:11<01:53,  5.99s/it]
Task 5, Epoch 2/20 => Loss 2.709, Train_accy 87.92:  10%|█         | 2/20 [00:11<01:47,  5.97s/it]
Task 5, Epoch 3/20 => Loss 2.114, Train_accy 92.12:  10%|█         | 2/20 [00:17<01:47,  5.97s/it]
Task 5, Epoch 3/20 => Loss 2.114, Train_accy 92.12:  15%|█▌        | 3/20 [00:17<01:41,  5.95s/it]
Task 5, Epoch 4/20 => Loss 1.280, Train_accy 95.59:  15%|█▌        | 3/20 [00:23<01:41,  5.95s/it]
Task 5, Epoch 4/20 => Loss 1.280, Train_accy 95.59:  20%|██        | 4/20 [00:23<01:35,  5.95s/it]
Task 5, Epoch 5/20 => Loss 0.739, Train_accy 94.22:  20%|██        | 4/20 [00:29<01:35,  5.95s/it]
Task 5, Epoch 5/20 => Loss 0.739, Train_accy 94.22:  25%|██▌       | 5/20 [00:29<01:29,  5.95s/it]
Task 5, Epoch 6/20 => Loss 0.496, Train_accy 94.96:  25%|██▌       | 5/20 [00:35<01:29,  5.95s/it]
Task 5, Epoch 6/20 => Loss 0.496, Train_accy 94.96:  30%|███       | 6/20 [00:35<01:23,  5.96s/it]
Task 5, Epoch 7/20 => Loss 0.382, Train_accy 95.06:  30%|███       | 6/20 [00:41<01:23,  5.96s/it]
Task 5, Epoch 7/20 => Loss 0.382, Train_accy 95.06:  35%|███▌      | 7/20 [00:41<01:17,  5.95s/it]
Task 5, Epoch 8/20 => Loss 0.346, Train_accy 94.85:  35%|███▌      | 7/20 [00:47<01:17,  5.95s/it]
Task 5, Epoch 8/20 => Loss 0.346, Train_accy 94.85:  40%|████      | 8/20 [00:47<01:11,  5.96s/it]
Task 5, Epoch 9/20 => Loss 0.306, Train_accy 95.48:  40%|████      | 8/20 [00:53<01:11,  5.96s/it]
Task 5, Epoch 9/20 => Loss 0.306, Train_accy 95.48:  45%|████▌     | 9/20 [00:53<01:05,  5.96s/it]
Task 5, Epoch 10/20 => Loss 0.278, Train_accy 95.69:  45%|████▌     | 9/20 [00:59<01:05,  5.96s/it]
Task 5, Epoch 10/20 => Loss 0.278, Train_accy 95.69:  50%|█████     | 10/20 [00:59<00:59,  5.96s/it]
Task 5, Epoch 11/20 => Loss 0.247, Train_accy 96.32:  50%|█████     | 10/20 [01:05<00:59,  5.96s/it]
Task 5, Epoch 11/20 => Loss 0.247, Train_accy 96.32:  55%|█████▌    | 11/20 [01:05<00:53,  5.97s/it]
Task 5, Epoch 12/20 => Loss 0.244, Train_accy 95.80:  55%|█████▌    | 11/20 [01:11<00:53,  5.97s/it]
Task 5, Epoch 12/20 => Loss 0.244, Train_accy 95.80:  60%|██████    | 12/20 [01:11<00:47,  5.96s/it]
Task 5, Epoch 13/20 => Loss 0.283, Train_accy 94.01:  60%|██████    | 12/20 [01:17<00:47,  5.96s/it]
Task 5, Epoch 13/20 => Loss 0.283, Train_accy 94.01:  65%|██████▌   | 13/20 [01:17<00:41,  5.96s/it]
Task 5, Epoch 14/20 => Loss 0.270, Train_accy 94.43:  65%|██████▌   | 13/20 [01:23<00:41,  5.96s/it]
Task 5, Epoch 14/20 => Loss 0.270, Train_accy 94.43:  70%|███████   | 14/20 [01:23<00:35,  5.95s/it]
Task 5, Epoch 15/20 => Loss 0.251, Train_accy 94.85:  70%|███████   | 14/20 [01:29<00:35,  5.95s/it]
Task 5, Epoch 15/20 => Loss 0.251, Train_accy 94.85:  75%|███████▌  | 15/20 [01:29<00:29,  5.95s/it]
Task 5, Epoch 16/20 => Loss 0.233, Train_accy 95.48:  75%|███████▌  | 15/20 [01:35<00:29,  5.95s/it]
Task 5, Epoch 16/20 => Loss 0.233, Train_accy 95.48:  80%|████████  | 16/20 [01:35<00:23,  5.95s/it]
Task 5, Epoch 17/20 => Loss 0.221, Train_accy 95.80:  80%|████████  | 16/20 [01:41<00:23,  5.95s/it]
Task 5, Epoch 17/20 => Loss 0.221, Train_accy 95.80:  85%|████████▌ | 17/20 [01:41<00:17,  5.95s/it]
Task 5, Epoch 18/20 => Loss 0.238, Train_accy 95.69:  85%|████████▌ | 17/20 [01:47<00:17,  5.95s/it]
Task 5, Epoch 18/20 => Loss 0.238, Train_accy 95.69:  90%|█████████ | 18/20 [01:47<00:11,  5.95s/it]
Task 5, Epoch 19/20 => Loss 0.227, Train_accy 96.01:  90%|█████████ | 18/20 [01:53<00:11,  5.95s/it]
Task 5, Epoch 19/20 => Loss 0.227, Train_accy 96.01:  95%|█████████▌| 19/20 [01:53<00:05,  5.95s/it]
Task 5, Epoch 20/20 => Loss 0.261, Train_accy 94.64:  95%|█████████▌| 19/20 [01:59<00:05,  5.95s/it]
Task 5, Epoch 20/20 => Loss 0.261, Train_accy 94.64: 100%|██████████| 20/20 [01:59<00:00,  5.95s/it]
Task 5, Epoch 20/20 => Loss 0.261, Train_accy 94.64: 100%|██████████| 20/20 [01:59<00:00,  5.95s/it]
2024-09-06 03:41:49,809 [ease.py] => Task 5, Epoch 20/20 => Loss 0.261, Train_accy 94.64
2024-09-06 03:42:35,061 [ease.py] => Task correct: 88.77118644067797
2024-09-06 03:42:35,061 [ease.py] => Task acc: 98.1638418079096
2024-09-06 03:42:35,083 [trainer.py] => No NME accuracy.
2024-09-06 03:42:35,083 [trainer.py] => CNN: {'total': 88.06, '00-19': 78.95, '20-39': 89.86, '40-59': 87.16, '60-79': 87.04, '80-99': 94.05, '100-119': 91.23, 'old': 87.46, 'new': 91.23}
2024-09-06 03:42:35,083 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6, 91.84, 89.81, 88.06]
2024-09-06 03:42:35,083 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.13, 99.16, 98.87]

Average Accuracy (CNN): 93.17
2024-09-06 03:42:35,084 [trainer.py] => Average Accuracy (CNN): 93.17 

2024-09-06 03:42:35,084 [trainer.py] => All params: 86671298
2024-09-06 03:42:35,085 [trainer.py] => Trainable params: 304320
2024-09-06 03:42:35,091 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.951, Train_accy 27.46:   0%|          | 0/20 [00:05<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.951, Train_accy 27.46:   5%|▌         | 1/20 [00:05<01:53,  5.97s/it]
Task 6, Epoch 2/20 => Loss 2.715, Train_accy 67.40:   5%|▌         | 1/20 [00:11<01:53,  5.97s/it]
Task 6, Epoch 2/20 => Loss 2.715, Train_accy 67.40:  10%|█         | 2/20 [00:11<01:47,  5.96s/it]
Task 6, Epoch 3/20 => Loss 2.192, Train_accy 80.08:  10%|█         | 2/20 [00:17<01:47,  5.96s/it]
Task 6, Epoch 3/20 => Loss 2.192, Train_accy 80.08:  15%|█▌        | 3/20 [00:17<01:41,  5.97s/it]
Task 6, Epoch 4/20 => Loss 1.501, Train_accy 84.70:  15%|█▌        | 3/20 [00:23<01:41,  5.97s/it]
Task 6, Epoch 4/20 => Loss 1.501, Train_accy 84.70:  20%|██        | 4/20 [00:23<01:35,  5.96s/it]
Task 6, Epoch 5/20 => Loss 1.019, Train_accy 86.48:  20%|██        | 4/20 [00:29<01:35,  5.96s/it]
Task 6, Epoch 5/20 => Loss 1.019, Train_accy 86.48:  25%|██▌       | 5/20 [00:29<01:29,  5.96s/it]
Task 6, Epoch 6/20 => Loss 0.758, Train_accy 87.74:  25%|██▌       | 5/20 [00:35<01:29,  5.96s/it]
Task 6, Epoch 6/20 => Loss 0.758, Train_accy 87.74:  30%|███       | 6/20 [00:35<01:23,  5.97s/it]
Task 6, Epoch 7/20 => Loss 0.617, Train_accy 88.47:  30%|███       | 6/20 [00:41<01:23,  5.97s/it]
Task 6, Epoch 7/20 => Loss 0.617, Train_accy 88.47:  35%|███▌      | 7/20 [00:41<01:17,  5.97s/it]
Task 6, Epoch 8/20 => Loss 0.533, Train_accy 89.94:  35%|███▌      | 7/20 [00:47<01:17,  5.97s/it]
Task 6, Epoch 8/20 => Loss 0.533, Train_accy 89.94:  40%|████      | 8/20 [00:47<01:11,  5.97s/it]
Task 6, Epoch 9/20 => Loss 0.509, Train_accy 90.15:  40%|████      | 8/20 [00:53<01:11,  5.97s/it]
Task 6, Epoch 9/20 => Loss 0.509, Train_accy 90.15:  45%|████▌     | 9/20 [00:53<01:05,  5.97s/it]
Task 6, Epoch 10/20 => Loss 0.458, Train_accy 89.83:  45%|████▌     | 9/20 [00:59<01:05,  5.97s/it]
Task 6, Epoch 10/20 => Loss 0.458, Train_accy 89.83:  50%|█████     | 10/20 [00:59<00:59,  5.97s/it]
Task 6, Epoch 11/20 => Loss 0.444, Train_accy 91.30:  50%|█████     | 10/20 [01:05<00:59,  5.97s/it]
Task 6, Epoch 11/20 => Loss 0.444, Train_accy 91.30:  55%|█████▌    | 11/20 [01:05<00:53,  5.97s/it]
Task 6, Epoch 12/20 => Loss 0.425, Train_accy 92.14:  55%|█████▌    | 11/20 [01:11<00:53,  5.97s/it]
Task 6, Epoch 12/20 => Loss 0.425, Train_accy 92.14:  60%|██████    | 12/20 [01:11<00:47,  5.96s/it]
Task 6, Epoch 13/20 => Loss 0.421, Train_accy 91.09:  60%|██████    | 12/20 [01:17<00:47,  5.96s/it]
Task 6, Epoch 13/20 => Loss 0.421, Train_accy 91.09:  65%|██████▌   | 13/20 [01:17<00:41,  5.99s/it]
Task 6, Epoch 14/20 => Loss 0.382, Train_accy 92.14:  65%|██████▌   | 13/20 [01:23<00:41,  5.99s/it]
Task 6, Epoch 14/20 => Loss 0.382, Train_accy 92.14:  70%|███████   | 14/20 [01:23<00:35,  5.97s/it]
Task 6, Epoch 15/20 => Loss 0.386, Train_accy 92.56:  70%|███████   | 14/20 [01:29<00:35,  5.97s/it]
Task 6, Epoch 15/20 => Loss 0.386, Train_accy 92.56:  75%|███████▌  | 15/20 [01:29<00:29,  5.98s/it]
Task 6, Epoch 16/20 => Loss 0.431, Train_accy 89.94:  75%|███████▌  | 15/20 [01:35<00:29,  5.98s/it]
Task 6, Epoch 16/20 => Loss 0.431, Train_accy 89.94:  80%|████████  | 16/20 [01:35<00:23,  5.97s/it]
Task 6, Epoch 17/20 => Loss 0.402, Train_accy 91.82:  80%|████████  | 16/20 [01:41<00:23,  5.97s/it]
Task 6, Epoch 17/20 => Loss 0.402, Train_accy 91.82:  85%|████████▌ | 17/20 [01:41<00:17,  5.98s/it]
Task 6, Epoch 18/20 => Loss 0.386, Train_accy 92.03:  85%|████████▌ | 17/20 [01:47<00:17,  5.98s/it]
Task 6, Epoch 18/20 => Loss 0.386, Train_accy 92.03:  90%|█████████ | 18/20 [01:47<00:11,  5.97s/it]
Task 6, Epoch 19/20 => Loss 0.379, Train_accy 92.98:  90%|█████████ | 18/20 [01:53<00:11,  5.97s/it]
Task 6, Epoch 19/20 => Loss 0.379, Train_accy 92.98:  95%|█████████▌| 19/20 [01:53<00:05,  5.97s/it]
Task 6, Epoch 20/20 => Loss 0.397, Train_accy 92.03:  95%|█████████▌| 19/20 [01:59<00:05,  5.97s/it]
Task 6, Epoch 20/20 => Loss 0.397, Train_accy 92.03: 100%|██████████| 20/20 [01:59<00:00,  5.97s/it]
Task 6, Epoch 20/20 => Loss 0.397, Train_accy 92.03: 100%|██████████| 20/20 [01:59<00:00,  5.97s/it]
2024-09-06 03:44:34,526 [ease.py] => Task 6, Epoch 20/20 => Loss 0.397, Train_accy 92.03
2024-09-06 03:45:31,688 [ease.py] => Task correct: 88.23887873248019
2024-09-06 03:45:31,689 [ease.py] => Task acc: 97.37964655697745
2024-09-06 03:45:31,706 [trainer.py] => No NME accuracy.
2024-09-06 03:45:31,706 [trainer.py] => CNN: {'total': 86.96, '00-19': 77.73, '20-39': 90.34, '40-59': 84.86, '60-79': 86.64, '80-99': 93.68, '100-119': 91.23, '120-139': 84.0, 'old': 87.43, 'new': 84.0}
2024-09-06 03:45:31,706 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6, 91.84, 89.81, 88.06, 86.96]
2024-09-06 03:45:31,706 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.13, 99.16, 98.87, 98.72]

Average Accuracy (CNN): 92.28
2024-09-06 03:45:31,706 [trainer.py] => Average Accuracy (CNN): 92.28 

2024-09-06 03:45:31,708 [trainer.py] => All params: 86870978
2024-09-06 03:45:31,709 [trainer.py] => Trainable params: 304320
2024-09-06 03:45:31,722 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.953, Train_accy 29.67:   0%|          | 0/20 [00:05<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.953, Train_accy 29.67:   5%|▌         | 1/20 [00:05<01:49,  5.78s/it]
Task 7, Epoch 2/20 => Loss 2.723, Train_accy 81.63:   5%|▌         | 1/20 [00:11<01:49,  5.78s/it]
Task 7, Epoch 2/20 => Loss 2.723, Train_accy 81.63:  10%|█         | 2/20 [00:11<01:44,  5.79s/it]
Task 7, Epoch 3/20 => Loss 2.190, Train_accy 89.67:  10%|█         | 2/20 [00:17<01:44,  5.79s/it]
Task 7, Epoch 3/20 => Loss 2.190, Train_accy 89.67:  15%|█▌        | 3/20 [00:17<01:38,  5.79s/it]
Task 7, Epoch 4/20 => Loss 1.444, Train_accy 92.28:  15%|█▌        | 3/20 [00:23<01:38,  5.79s/it]
Task 7, Epoch 4/20 => Loss 1.444, Train_accy 92.28:  20%|██        | 4/20 [00:23<01:32,  5.79s/it]
Task 7, Epoch 5/20 => Loss 0.925, Train_accy 92.17:  20%|██        | 4/20 [00:28<01:32,  5.79s/it]
Task 7, Epoch 5/20 => Loss 0.925, Train_accy 92.17:  25%|██▌       | 5/20 [00:28<01:26,  5.78s/it]
Task 7, Epoch 6/20 => Loss 0.677, Train_accy 91.09:  25%|██▌       | 5/20 [00:34<01:26,  5.78s/it]
Task 7, Epoch 6/20 => Loss 0.677, Train_accy 91.09:  30%|███       | 6/20 [00:34<01:20,  5.78s/it]
Task 7, Epoch 7/20 => Loss 0.512, Train_accy 92.39:  30%|███       | 6/20 [00:40<01:20,  5.78s/it]
Task 7, Epoch 7/20 => Loss 0.512, Train_accy 92.39:  35%|███▌      | 7/20 [00:40<01:15,  5.77s/it]
Task 7, Epoch 8/20 => Loss 0.452, Train_accy 92.83:  35%|███▌      | 7/20 [00:46<01:15,  5.77s/it]
Task 7, Epoch 8/20 => Loss 0.452, Train_accy 92.83:  40%|████      | 8/20 [00:46<01:09,  5.78s/it]
Task 7, Epoch 9/20 => Loss 0.390, Train_accy 94.35:  40%|████      | 8/20 [00:52<01:09,  5.78s/it]
Task 7, Epoch 9/20 => Loss 0.390, Train_accy 94.35:  45%|████▌     | 9/20 [00:52<01:03,  5.78s/it]
Task 7, Epoch 10/20 => Loss 0.366, Train_accy 94.35:  45%|████▌     | 9/20 [00:57<01:03,  5.78s/it]
Task 7, Epoch 10/20 => Loss 0.366, Train_accy 94.35:  50%|█████     | 10/20 [00:57<00:57,  5.79s/it]
Task 7, Epoch 11/20 => Loss 0.342, Train_accy 93.70:  50%|█████     | 10/20 [01:03<00:57,  5.79s/it]
Task 7, Epoch 11/20 => Loss 0.342, Train_accy 93.70:  55%|█████▌    | 11/20 [01:03<00:52,  5.80s/it]
Task 7, Epoch 12/20 => Loss 0.349, Train_accy 93.26:  55%|█████▌    | 11/20 [01:09<00:52,  5.80s/it]
Task 7, Epoch 12/20 => Loss 0.349, Train_accy 93.26:  60%|██████    | 12/20 [01:09<00:46,  5.80s/it]
Task 7, Epoch 13/20 => Loss 0.333, Train_accy 94.57:  60%|██████    | 12/20 [01:15<00:46,  5.80s/it]
Task 7, Epoch 13/20 => Loss 0.333, Train_accy 94.57:  65%|██████▌   | 13/20 [01:15<00:40,  5.79s/it]
Task 7, Epoch 14/20 => Loss 0.334, Train_accy 94.57:  65%|██████▌   | 13/20 [01:21<00:40,  5.79s/it]
Task 7, Epoch 14/20 => Loss 0.334, Train_accy 94.57:  70%|███████   | 14/20 [01:21<00:34,  5.79s/it]
Task 7, Epoch 15/20 => Loss 0.297, Train_accy 94.67:  70%|███████   | 14/20 [01:26<00:34,  5.79s/it]
Task 7, Epoch 15/20 => Loss 0.297, Train_accy 94.67:  75%|███████▌  | 15/20 [01:26<00:28,  5.78s/it]
Task 7, Epoch 16/20 => Loss 0.355, Train_accy 92.93:  75%|███████▌  | 15/20 [01:32<00:28,  5.78s/it]
Task 7, Epoch 16/20 => Loss 0.355, Train_accy 92.93:  80%|████████  | 16/20 [01:32<00:23,  5.78s/it]
Task 7, Epoch 17/20 => Loss 0.347, Train_accy 93.80:  80%|████████  | 16/20 [01:38<00:23,  5.78s/it]
Task 7, Epoch 17/20 => Loss 0.347, Train_accy 93.80:  85%|████████▌ | 17/20 [01:38<00:17,  5.78s/it]
Task 7, Epoch 18/20 => Loss 0.303, Train_accy 93.37:  85%|████████▌ | 17/20 [01:44<00:17,  5.78s/it]
Task 7, Epoch 18/20 => Loss 0.303, Train_accy 93.37:  90%|█████████ | 18/20 [01:44<00:11,  5.78s/it]
Task 7, Epoch 19/20 => Loss 0.319, Train_accy 94.02:  90%|█████████ | 18/20 [01:49<00:11,  5.78s/it]
Task 7, Epoch 19/20 => Loss 0.319, Train_accy 94.02:  95%|█████████▌| 19/20 [01:49<00:05,  5.79s/it]
Task 7, Epoch 20/20 => Loss 0.269, Train_accy 95.33:  95%|█████████▌| 19/20 [01:55<00:05,  5.79s/it]
Task 7, Epoch 20/20 => Loss 0.269, Train_accy 95.33: 100%|██████████| 20/20 [01:55<00:00,  5.78s/it]
Task 7, Epoch 20/20 => Loss 0.269, Train_accy 95.33: 100%|██████████| 20/20 [01:55<00:00,  5.78s/it]
2024-09-06 03:47:27,399 [ease.py] => Task 7, Epoch 20/20 => Loss 0.269, Train_accy 95.33
2024-09-06 03:48:37,877 [ease.py] => Task correct: 87.14965626652565
2024-09-06 03:48:37,877 [ease.py] => Task acc: 97.67318878900053
2024-09-06 03:48:37,902 [trainer.py] => No NME accuracy.
2024-09-06 03:48:37,902 [trainer.py] => CNN: {'total': 86.04, '00-19': 76.11, '20-39': 88.41, '40-59': 82.11, '60-79': 86.23, '80-99': 91.82, '100-119': 89.04, '120-139': 83.56, '140-159': 90.4, 'old': 85.37, 'new': 90.4}
2024-09-06 03:48:37,902 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6, 91.84, 89.81, 88.06, 86.96, 86.04]
2024-09-06 03:48:37,902 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.13, 99.16, 98.87, 98.72, 98.63]

Average Accuracy (CNN): 91.5
2024-09-06 03:48:37,902 [trainer.py] => Average Accuracy (CNN): 91.5 

2024-09-06 03:48:37,903 [trainer.py] => All params: 87101378
2024-09-06 03:48:37,904 [trainer.py] => Trainable params: 304320
2024-09-06 03:48:37,916 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.946, Train_accy 27.97:   0%|          | 0/20 [00:06<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.946, Train_accy 27.97:   5%|▌         | 1/20 [00:06<01:54,  6.01s/it]
Task 8, Epoch 2/20 => Loss 2.713, Train_accy 80.27:   5%|▌         | 1/20 [00:12<01:54,  6.01s/it]
Task 8, Epoch 2/20 => Loss 2.713, Train_accy 80.27:  10%|█         | 2/20 [00:12<01:48,  6.01s/it]
Task 8, Epoch 3/20 => Loss 2.166, Train_accy 89.04:  10%|█         | 2/20 [00:18<01:48,  6.01s/it]
Task 8, Epoch 3/20 => Loss 2.166, Train_accy 89.04:  15%|█▌        | 3/20 [00:18<01:42,  6.01s/it]
Task 8, Epoch 4/20 => Loss 1.430, Train_accy 93.32:  15%|█▌        | 3/20 [00:24<01:42,  6.01s/it]
Task 8, Epoch 4/20 => Loss 1.430, Train_accy 93.32:  20%|██        | 4/20 [00:24<01:36,  6.00s/it]
Task 8, Epoch 5/20 => Loss 0.884, Train_accy 92.90:  20%|██        | 4/20 [00:30<01:36,  6.00s/it]
Task 8, Epoch 5/20 => Loss 0.884, Train_accy 92.90:  25%|██▌       | 5/20 [00:30<01:30,  6.00s/it]
Task 8, Epoch 6/20 => Loss 0.616, Train_accy 92.38:  25%|██▌       | 5/20 [00:36<01:30,  6.00s/it]
Task 8, Epoch 6/20 => Loss 0.616, Train_accy 92.38:  30%|███       | 6/20 [00:36<01:24,  6.00s/it]
Task 8, Epoch 7/20 => Loss 0.455, Train_accy 94.05:  30%|███       | 6/20 [00:42<01:24,  6.00s/it]
Task 8, Epoch 7/20 => Loss 0.455, Train_accy 94.05:  35%|███▌      | 7/20 [00:42<01:18,  6.01s/it]
Task 8, Epoch 8/20 => Loss 0.411, Train_accy 93.95:  35%|███▌      | 7/20 [00:48<01:18,  6.01s/it]
Task 8, Epoch 8/20 => Loss 0.411, Train_accy 93.95:  40%|████      | 8/20 [00:48<01:12,  6.01s/it]
Task 8, Epoch 9/20 => Loss 0.388, Train_accy 93.01:  40%|████      | 8/20 [00:54<01:12,  6.01s/it]
Task 8, Epoch 9/20 => Loss 0.388, Train_accy 93.01:  45%|████▌     | 9/20 [00:54<01:06,  6.00s/it]
Task 8, Epoch 10/20 => Loss 0.378, Train_accy 92.28:  45%|████▌     | 9/20 [01:00<01:06,  6.00s/it]
Task 8, Epoch 10/20 => Loss 0.378, Train_accy 92.28:  50%|█████     | 10/20 [01:00<01:00,  6.01s/it]
Task 8, Epoch 11/20 => Loss 0.332, Train_accy 94.78:  50%|█████     | 10/20 [01:06<01:00,  6.01s/it]
Task 8, Epoch 11/20 => Loss 0.332, Train_accy 94.78:  55%|█████▌    | 11/20 [01:06<00:54,  6.01s/it]
Task 8, Epoch 12/20 => Loss 0.315, Train_accy 94.78:  55%|█████▌    | 11/20 [01:12<00:54,  6.01s/it]
Task 8, Epoch 12/20 => Loss 0.315, Train_accy 94.78:  60%|██████    | 12/20 [01:12<00:48,  6.01s/it]
Task 8, Epoch 13/20 => Loss 0.303, Train_accy 94.68:  60%|██████    | 12/20 [01:18<00:48,  6.01s/it]
Task 8, Epoch 13/20 => Loss 0.303, Train_accy 94.68:  65%|██████▌   | 13/20 [01:18<00:42,  6.00s/it]
Task 8, Epoch 14/20 => Loss 0.290, Train_accy 94.47:  65%|██████▌   | 13/20 [01:24<00:42,  6.00s/it]
Task 8, Epoch 14/20 => Loss 0.290, Train_accy 94.47:  70%|███████   | 14/20 [01:24<00:35,  6.00s/it]
Task 8, Epoch 15/20 => Loss 0.298, Train_accy 94.47:  70%|███████   | 14/20 [01:30<00:35,  6.00s/it]
Task 8, Epoch 15/20 => Loss 0.298, Train_accy 94.47:  75%|███████▌  | 15/20 [01:30<00:29,  5.99s/it]
Task 8, Epoch 16/20 => Loss 0.313, Train_accy 93.53:  75%|███████▌  | 15/20 [01:36<00:29,  5.99s/it]
Task 8, Epoch 16/20 => Loss 0.313, Train_accy 93.53:  80%|████████  | 16/20 [01:36<00:23,  6.00s/it]
Task 8, Epoch 17/20 => Loss 0.294, Train_accy 94.15:  80%|████████  | 16/20 [01:42<00:23,  6.00s/it]
Task 8, Epoch 17/20 => Loss 0.294, Train_accy 94.15:  85%|████████▌ | 17/20 [01:42<00:17,  6.00s/it]
Task 8, Epoch 18/20 => Loss 0.291, Train_accy 94.47:  85%|████████▌ | 17/20 [01:48<00:17,  6.00s/it]
Task 8, Epoch 18/20 => Loss 0.291, Train_accy 94.47:  90%|█████████ | 18/20 [01:48<00:11,  6.00s/it]
Task 8, Epoch 19/20 => Loss 0.303, Train_accy 94.15:  90%|█████████ | 18/20 [01:54<00:11,  6.00s/it]
Task 8, Epoch 19/20 => Loss 0.303, Train_accy 94.15:  95%|█████████▌| 19/20 [01:54<00:05,  6.00s/it]
Task 8, Epoch 20/20 => Loss 0.312, Train_accy 93.95:  95%|█████████▌| 19/20 [02:00<00:05,  6.00s/it]
Task 8, Epoch 20/20 => Loss 0.312, Train_accy 93.95: 100%|██████████| 20/20 [02:00<00:00,  5.99s/it]
Task 8, Epoch 20/20 => Loss 0.312, Train_accy 93.95: 100%|██████████| 20/20 [02:00<00:00,  6.00s/it]
2024-09-06 03:50:37,938 [ease.py] => Task 8, Epoch 20/20 => Loss 0.312, Train_accy 93.95
2024-09-06 03:52:04,866 [ease.py] => Task correct: 86.74812030075188
2024-09-06 03:52:04,866 [ease.py] => Task acc: 97.65037593984962
2024-09-06 03:52:04,890 [trainer.py] => No NME accuracy.
2024-09-06 03:52:04,890 [trainer.py] => CNN: {'total': 85.67, '00-19': 75.71, '20-39': 87.92, '40-59': 82.11, '60-79': 85.83, '80-99': 91.08, '100-119': 87.72, '120-139': 82.67, '140-159': 88.8, '160-179': 88.61, 'old': 85.3, 'new': 88.61}
2024-09-06 03:52:04,891 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6, 91.84, 89.81, 88.06, 86.96, 86.04, 85.67]
2024-09-06 03:52:04,891 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.13, 99.16, 98.87, 98.72, 98.63, 98.31]

Average Accuracy (CNN): 90.85
2024-09-06 03:52:04,891 [trainer.py] => Average Accuracy (CNN): 90.85 

2024-09-06 03:52:04,891 [trainer.py] => All params: 87362498
2024-09-06 03:52:04,892 [trainer.py] => Trainable params: 304320
2024-09-06 03:52:04,906 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.952, Train_accy 30.57:   0%|          | 0/20 [00:05<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.952, Train_accy 30.57:   5%|▌         | 1/20 [00:05<01:52,  5.93s/it]
Task 9, Epoch 2/20 => Loss 2.711, Train_accy 82.46:   5%|▌         | 1/20 [00:11<01:52,  5.93s/it]
Task 9, Epoch 2/20 => Loss 2.711, Train_accy 82.46:  10%|█         | 2/20 [00:11<01:46,  5.94s/it]
Task 9, Epoch 3/20 => Loss 2.150, Train_accy 88.45:  10%|█         | 2/20 [00:17<01:46,  5.94s/it]
Task 9, Epoch 3/20 => Loss 2.150, Train_accy 88.45:  15%|█▌        | 3/20 [00:17<01:40,  5.94s/it]
Task 9, Epoch 4/20 => Loss 1.371, Train_accy 91.81:  15%|█▌        | 3/20 [00:23<01:40,  5.94s/it]
Task 9, Epoch 4/20 => Loss 1.371, Train_accy 91.81:  20%|██        | 4/20 [00:23<01:35,  5.96s/it]
Task 9, Epoch 5/20 => Loss 0.881, Train_accy 91.28:  20%|██        | 4/20 [00:29<01:35,  5.96s/it]
Task 9, Epoch 5/20 => Loss 0.881, Train_accy 91.28:  25%|██▌       | 5/20 [00:29<01:29,  5.98s/it]
Task 9, Epoch 6/20 => Loss 0.555, Train_accy 93.59:  25%|██▌       | 5/20 [00:35<01:29,  5.98s/it]
Task 9, Epoch 6/20 => Loss 0.555, Train_accy 93.59:  30%|███       | 6/20 [00:35<01:23,  5.97s/it]
Task 9, Epoch 7/20 => Loss 0.470, Train_accy 92.44:  30%|███       | 6/20 [00:41<01:23,  5.97s/it]
Task 9, Epoch 7/20 => Loss 0.470, Train_accy 92.44:  35%|███▌      | 7/20 [00:41<01:17,  5.97s/it]
Task 9, Epoch 8/20 => Loss 0.377, Train_accy 93.38:  35%|███▌      | 7/20 [00:47<01:17,  5.97s/it]
Task 9, Epoch 8/20 => Loss 0.377, Train_accy 93.38:  40%|████      | 8/20 [00:47<01:11,  5.97s/it]
Task 9, Epoch 9/20 => Loss 0.386, Train_accy 92.33:  40%|████      | 8/20 [00:53<01:11,  5.97s/it]
Task 9, Epoch 9/20 => Loss 0.386, Train_accy 92.33:  45%|████▌     | 9/20 [00:53<01:05,  5.97s/it]
Task 9, Epoch 10/20 => Loss 0.334, Train_accy 94.54:  45%|████▌     | 9/20 [00:59<01:05,  5.97s/it]
Task 9, Epoch 10/20 => Loss 0.334, Train_accy 94.54:  50%|█████     | 10/20 [00:59<00:59,  5.97s/it]
Task 9, Epoch 11/20 => Loss 0.370, Train_accy 92.86:  50%|█████     | 10/20 [01:05<00:59,  5.97s/it]
Task 9, Epoch 11/20 => Loss 0.370, Train_accy 92.86:  55%|█████▌    | 11/20 [01:05<00:53,  5.97s/it]
Task 9, Epoch 12/20 => Loss 0.326, Train_accy 93.38:  55%|█████▌    | 11/20 [01:11<00:53,  5.97s/it]
Task 9, Epoch 12/20 => Loss 0.326, Train_accy 93.38:  60%|██████    | 12/20 [01:11<00:47,  5.98s/it]
Task 9, Epoch 13/20 => Loss 0.334, Train_accy 93.17:  60%|██████    | 12/20 [01:17<00:47,  5.98s/it]
Task 9, Epoch 13/20 => Loss 0.334, Train_accy 93.17:  65%|██████▌   | 13/20 [01:17<00:41,  5.99s/it]
Task 9, Epoch 14/20 => Loss 0.305, Train_accy 93.38:  65%|██████▌   | 13/20 [01:23<00:41,  5.99s/it]
Task 9, Epoch 14/20 => Loss 0.305, Train_accy 93.38:  70%|███████   | 14/20 [01:23<00:35,  5.98s/it]
Task 9, Epoch 15/20 => Loss 0.296, Train_accy 94.54:  70%|███████   | 14/20 [01:29<00:35,  5.98s/it]
Task 9, Epoch 15/20 => Loss 0.296, Train_accy 94.54:  75%|███████▌  | 15/20 [01:29<00:29,  5.97s/it]
Task 9, Epoch 16/20 => Loss 0.346, Train_accy 92.12:  75%|███████▌  | 15/20 [01:35<00:29,  5.97s/it]
Task 9, Epoch 16/20 => Loss 0.346, Train_accy 92.12:  80%|████████  | 16/20 [01:35<00:23,  5.97s/it]
Task 9, Epoch 17/20 => Loss 0.292, Train_accy 94.22:  80%|████████  | 16/20 [01:41<00:23,  5.97s/it]
Task 9, Epoch 17/20 => Loss 0.292, Train_accy 94.22:  85%|████████▌ | 17/20 [01:41<00:17,  5.97s/it]
Task 9, Epoch 18/20 => Loss 0.305, Train_accy 93.28:  85%|████████▌ | 17/20 [01:47<00:17,  5.97s/it]
Task 9, Epoch 18/20 => Loss 0.305, Train_accy 93.28:  90%|█████████ | 18/20 [01:47<00:11,  5.97s/it]
Task 9, Epoch 19/20 => Loss 0.320, Train_accy 92.96:  90%|█████████ | 18/20 [01:53<00:11,  5.97s/it]
Task 9, Epoch 19/20 => Loss 0.320, Train_accy 92.96:  95%|█████████▌| 19/20 [01:53<00:05,  5.96s/it]
Task 9, Epoch 20/20 => Loss 0.338, Train_accy 91.70:  95%|█████████▌| 19/20 [01:59<00:05,  5.96s/it]
Task 9, Epoch 20/20 => Loss 0.338, Train_accy 91.70: 100%|██████████| 20/20 [01:59<00:00,  5.96s/it]
Task 9, Epoch 20/20 => Loss 0.338, Train_accy 91.70: 100%|██████████| 20/20 [01:59<00:00,  5.97s/it]
2024-09-06 03:54:04,267 [ease.py] => Task 9, Epoch 20/20 => Loss 0.338, Train_accy 91.70
2024-09-06 03:55:47,103 [ease.py] => Task correct: 85.07209499575912
2024-09-06 03:55:47,103 [ease.py] => Task acc: 97.66751484308736
2024-09-06 03:55:47,128 [trainer.py] => No NME accuracy.
2024-09-06 03:55:47,128 [trainer.py] => CNN: {'total': 84.18, '00-19': 75.3, '20-39': 84.54, '40-59': 80.73, '60-79': 80.97, '80-99': 88.85, '100-119': 87.72, '120-139': 78.22, '140-159': 88.0, '160-179': 86.08, '180-199': 90.87, 'old': 83.46, 'new': 90.87}
2024-09-06 03:55:47,128 [trainer.py] => CNN top1 curve: [98.79, 96.92, 93.6, 91.84, 89.81, 88.06, 86.96, 86.04, 85.67, 84.18]
2024-09-06 03:55:47,128 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.26, 99.13, 99.16, 98.87, 98.72, 98.63, 98.31, 98.01]

Average Accuracy (CNN): 90.19
2024-09-06 03:55:47,128 [trainer.py] => Average Accuracy (CNN): 90.19 

Accuracy Matrix (CNN):
[[98.79 96.36 89.88 85.83 80.16 78.95 77.73 76.11 75.71 75.3 ]
 [ 0.   97.58 96.14 93.24 89.37 89.86 90.34 88.41 87.92 84.54]
 [ 0.    0.   95.41 93.12 91.28 87.16 84.86 82.11 82.11 80.73]
 [ 0.    0.    0.   95.55 92.31 87.04 86.64 86.23 85.83 80.97]
 [ 0.    0.    0.    0.   95.54 94.05 93.68 91.82 91.08 88.85]
 [ 0.    0.    0.    0.    0.   91.23 91.23 89.04 87.72 87.72]
 [ 0.    0.    0.    0.    0.    0.   84.   83.56 82.67 78.22]
 [ 0.    0.    0.    0.    0.    0.    0.   90.4  88.8  88.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   88.61 86.08]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   90.87]]
2024-09-06 03:55:47,130 [trainer.py] => Forgetting (CNN): 9.633333333333335
2024-09-06 03:55:49,736 [trainer.py] => config: ./exps/ease_cub_B0_Inc20.json
2024-09-06 03:55:49,736 [trainer.py] => prefix:  
2024-09-06 03:55:49,736 [trainer.py] => dataset: cub
2024-09-06 03:55:49,736 [trainer.py] => memory_size: 0
2024-09-06 03:55:49,736 [trainer.py] => memory_per_class: 0
2024-09-06 03:55:49,736 [trainer.py] => fixed_memory: False
2024-09-06 03:55:49,736 [trainer.py] => shuffle: True
2024-09-06 03:55:49,736 [trainer.py] => init_cls: 10
2024-09-06 03:55:49,736 [trainer.py] => increment: 10
2024-09-06 03:55:49,736 [trainer.py] => model_name: ease
2024-09-06 03:55:49,736 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-06 03:55:49,736 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 03:55:49,736 [trainer.py] => seed: 1993
2024-09-06 03:55:49,736 [trainer.py] => init_epochs: 20
2024-09-06 03:55:49,736 [trainer.py] => init_lr: 0.025
2024-09-06 03:55:49,736 [trainer.py] => later_epochs: 20
2024-09-06 03:55:49,736 [trainer.py] => later_lr: 0.025
2024-09-06 03:55:49,736 [trainer.py] => batch_size: 48
2024-09-06 03:55:49,736 [trainer.py] => weight_decay: 0.0005
2024-09-06 03:55:49,736 [trainer.py] => min_lr: 0
2024-09-06 03:55:49,737 [trainer.py] => optimizer: sgd
2024-09-06 03:55:49,737 [trainer.py] => scheduler: cosine
2024-09-06 03:55:49,737 [trainer.py] => pretrained: True
2024-09-06 03:55:49,737 [trainer.py] => vpt_type: Deep
2024-09-06 03:55:49,737 [trainer.py] => prompt_token_num: 5
2024-09-06 03:55:49,737 [trainer.py] => ffn_num: 16
2024-09-06 03:55:49,737 [trainer.py] => use_diagonal: False
2024-09-06 03:55:49,737 [trainer.py] => recalc_sim: True
2024-09-06 03:55:49,737 [trainer.py] => alpha: 0.1
2024-09-06 03:55:49,737 [trainer.py] => use_init_ptm: False
2024-09-06 03:55:49,737 [trainer.py] => beta: 0
2024-09-06 03:55:49,737 [trainer.py] => use_old_data: False
2024-09-06 03:55:49,737 [trainer.py] => use_reweight: True
2024-09-06 03:55:49,737 [trainer.py] => moni_adam: False
2024-09-06 03:55:49,737 [trainer.py] => adapter_num: -1
2024-09-06 03:55:49,774 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-06 03:55:52,457 [trainer.py] => All params: 86102976
2024-09-06 03:55:52,458 [trainer.py] => Trainable params: 304320
2024-09-06 03:55:52,464 [ease.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.261, Train_accy 40.50:   0%|          | 0/20 [00:03<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.261, Train_accy 40.50:   5%|▌         | 1/20 [00:03<01:06,  3.49s/it]
Task 0, Epoch 2/20 => Loss 2.129, Train_accy 82.88:   5%|▌         | 1/20 [00:06<01:06,  3.49s/it]
Task 0, Epoch 2/20 => Loss 2.129, Train_accy 82.88:  10%|█         | 2/20 [00:06<00:59,  3.30s/it]
Task 0, Epoch 3/20 => Loss 1.916, Train_accy 89.35:  10%|█         | 2/20 [00:09<00:59,  3.30s/it]
Task 0, Epoch 3/20 => Loss 1.916, Train_accy 89.35:  15%|█▌        | 3/20 [00:09<00:55,  3.24s/it]
Task 0, Epoch 4/20 => Loss 1.623, Train_accy 91.23:  15%|█▌        | 3/20 [00:12<00:55,  3.24s/it]
Task 0, Epoch 4/20 => Loss 1.623, Train_accy 91.23:  20%|██        | 4/20 [00:12<00:51,  3.21s/it]
Task 0, Epoch 5/20 => Loss 1.289, Train_accy 91.44:  20%|██        | 4/20 [00:16<00:51,  3.21s/it]
Task 0, Epoch 5/20 => Loss 1.289, Train_accy 91.44:  25%|██▌       | 5/20 [00:16<00:48,  3.22s/it]
Task 0, Epoch 6/20 => Loss 1.006, Train_accy 94.57:  25%|██▌       | 5/20 [00:19<00:48,  3.22s/it]
Task 0, Epoch 6/20 => Loss 1.006, Train_accy 94.57:  30%|███       | 6/20 [00:19<00:44,  3.21s/it]
Task 0, Epoch 7/20 => Loss 0.818, Train_accy 94.99:  30%|███       | 6/20 [00:22<00:44,  3.21s/it]
Task 0, Epoch 7/20 => Loss 0.818, Train_accy 94.99:  35%|███▌      | 7/20 [00:22<00:41,  3.20s/it]
Task 0, Epoch 8/20 => Loss 0.666, Train_accy 95.41:  35%|███▌      | 7/20 [00:25<00:41,  3.20s/it]
Task 0, Epoch 8/20 => Loss 0.666, Train_accy 95.41:  40%|████      | 8/20 [00:25<00:38,  3.19s/it]
Task 0, Epoch 9/20 => Loss 0.632, Train_accy 94.36:  40%|████      | 8/20 [00:28<00:38,  3.19s/it]
Task 0, Epoch 9/20 => Loss 0.632, Train_accy 94.36:  45%|████▌     | 9/20 [00:28<00:35,  3.19s/it]
Task 0, Epoch 10/20 => Loss 0.552, Train_accy 94.57:  45%|████▌     | 9/20 [00:32<00:35,  3.19s/it]
Task 0, Epoch 10/20 => Loss 0.552, Train_accy 94.57:  50%|█████     | 10/20 [00:32<00:31,  3.18s/it]
Task 0, Epoch 11/20 => Loss 0.506, Train_accy 93.53:  50%|█████     | 10/20 [00:35<00:31,  3.18s/it]
Task 0, Epoch 11/20 => Loss 0.506, Train_accy 93.53:  55%|█████▌    | 11/20 [00:35<00:28,  3.19s/it]
Task 0, Epoch 12/20 => Loss 0.452, Train_accy 95.62:  55%|█████▌    | 11/20 [00:38<00:28,  3.19s/it]
Task 0, Epoch 12/20 => Loss 0.452, Train_accy 95.62:  60%|██████    | 12/20 [00:38<00:25,  3.18s/it]
Task 0, Epoch 13/20 => Loss 0.417, Train_accy 97.29:  60%|██████    | 12/20 [00:41<00:25,  3.18s/it]
Task 0, Epoch 13/20 => Loss 0.417, Train_accy 97.29:  65%|██████▌   | 13/20 [00:41<00:22,  3.17s/it]
Task 0, Epoch 14/20 => Loss 0.399, Train_accy 96.24:  65%|██████▌   | 13/20 [00:44<00:22,  3.17s/it]
Task 0, Epoch 14/20 => Loss 0.399, Train_accy 96.24:  70%|███████   | 14/20 [00:44<00:18,  3.16s/it]
Task 0, Epoch 15/20 => Loss 0.418, Train_accy 94.99:  70%|███████   | 14/20 [00:47<00:18,  3.16s/it]
Task 0, Epoch 15/20 => Loss 0.418, Train_accy 94.99:  75%|███████▌  | 15/20 [00:47<00:15,  3.16s/it]
Task 0, Epoch 16/20 => Loss 0.411, Train_accy 94.36:  75%|███████▌  | 15/20 [00:51<00:15,  3.16s/it]
Task 0, Epoch 16/20 => Loss 0.411, Train_accy 94.36:  80%|████████  | 16/20 [00:51<00:12,  3.16s/it]
Task 0, Epoch 17/20 => Loss 0.383, Train_accy 95.62:  80%|████████  | 16/20 [00:54<00:12,  3.16s/it]
Task 0, Epoch 17/20 => Loss 0.383, Train_accy 95.62:  85%|████████▌ | 17/20 [00:54<00:09,  3.16s/it]
Task 0, Epoch 18/20 => Loss 0.381, Train_accy 96.24:  85%|████████▌ | 17/20 [00:57<00:09,  3.16s/it]
Task 0, Epoch 18/20 => Loss 0.381, Train_accy 96.24:  90%|█████████ | 18/20 [00:57<00:06,  3.17s/it]
Task 0, Epoch 19/20 => Loss 0.400, Train_accy 95.41:  90%|█████████ | 18/20 [01:00<00:06,  3.17s/it]
Task 0, Epoch 19/20 => Loss 0.400, Train_accy 95.41:  95%|█████████▌| 19/20 [01:00<00:03,  3.17s/it]
Task 0, Epoch 20/20 => Loss 0.395, Train_accy 95.20:  95%|█████████▌| 19/20 [01:03<00:03,  3.17s/it]
Task 0, Epoch 20/20 => Loss 0.395, Train_accy 95.20: 100%|██████████| 20/20 [01:03<00:00,  3.16s/it]
Task 0, Epoch 20/20 => Loss 0.395, Train_accy 95.20: 100%|██████████| 20/20 [01:03<00:00,  3.19s/it]
2024-09-06 03:56:56,288 [ease.py] => Task 0, Epoch 20/20 => Loss 0.395, Train_accy 95.20
2024-09-06 03:56:59,012 [ease.py] => Task correct: 100.0
2024-09-06 03:56:59,013 [ease.py] => Task acc: 100.0
2024-09-06 03:56:59,038 [trainer.py] => No NME accuracy.
2024-09-06 03:56:59,038 [trainer.py] => CNN: {'total': 100.0, '00-09': 100.0, 'old': 0, 'new': 100.0}
2024-09-06 03:56:59,038 [trainer.py] => CNN top1 curve: [100.0]
2024-09-06 03:56:59,038 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 100.0
2024-09-06 03:56:59,038 [trainer.py] => Average Accuracy (CNN): 100.0 

2024-09-06 03:56:59,039 [trainer.py] => All params: 86118338
2024-09-06 03:56:59,040 [trainer.py] => Trainable params: 304320
2024-09-06 03:56:59,041 [ease.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.286, Train_accy 19.06:   0%|          | 0/20 [00:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.286, Train_accy 19.06:   5%|▌         | 1/20 [00:03<00:58,  3.10s/it]
Task 1, Epoch 2/20 => Loss 2.159, Train_accy 79.87:   5%|▌         | 1/20 [00:06<00:58,  3.10s/it]
Task 1, Epoch 2/20 => Loss 2.159, Train_accy 79.87:  10%|█         | 2/20 [00:06<00:55,  3.09s/it]
Task 1, Epoch 3/20 => Loss 1.962, Train_accy 85.87:  10%|█         | 2/20 [00:09<00:55,  3.09s/it]
Task 1, Epoch 3/20 => Loss 1.962, Train_accy 85.87:  15%|█▌        | 3/20 [00:09<00:52,  3.10s/it]
Task 1, Epoch 4/20 => Loss 1.674, Train_accy 88.01:  15%|█▌        | 3/20 [00:12<00:52,  3.10s/it]
Task 1, Epoch 4/20 => Loss 1.674, Train_accy 88.01:  20%|██        | 4/20 [00:12<00:49,  3.12s/it]
Task 1, Epoch 5/20 => Loss 1.363, Train_accy 88.65:  20%|██        | 4/20 [00:15<00:49,  3.12s/it]
Task 1, Epoch 5/20 => Loss 1.363, Train_accy 88.65:  25%|██▌       | 5/20 [00:15<00:46,  3.12s/it]
Task 1, Epoch 6/20 => Loss 1.079, Train_accy 93.79:  25%|██▌       | 5/20 [00:18<00:46,  3.12s/it]
Task 1, Epoch 6/20 => Loss 1.079, Train_accy 93.79:  30%|███       | 6/20 [00:18<00:43,  3.12s/it]
Task 1, Epoch 7/20 => Loss 0.875, Train_accy 94.43:  30%|███       | 6/20 [00:21<00:43,  3.12s/it]
Task 1, Epoch 7/20 => Loss 0.875, Train_accy 94.43:  35%|███▌      | 7/20 [00:21<00:40,  3.12s/it]
Task 1, Epoch 8/20 => Loss 0.728, Train_accy 94.86:  35%|███▌      | 7/20 [00:24<00:40,  3.12s/it]
Task 1, Epoch 8/20 => Loss 0.728, Train_accy 94.86:  40%|████      | 8/20 [00:24<00:37,  3.12s/it]
Task 1, Epoch 9/20 => Loss 0.630, Train_accy 95.07:  40%|████      | 8/20 [00:28<00:37,  3.12s/it]
Task 1, Epoch 9/20 => Loss 0.630, Train_accy 95.07:  45%|████▌     | 9/20 [00:28<00:34,  3.11s/it]
Task 1, Epoch 10/20 => Loss 0.610, Train_accy 94.43:  45%|████▌     | 9/20 [00:31<00:34,  3.11s/it]
Task 1, Epoch 10/20 => Loss 0.610, Train_accy 94.43:  50%|█████     | 10/20 [00:31<00:31,  3.11s/it]
Task 1, Epoch 11/20 => Loss 0.527, Train_accy 94.86:  50%|█████     | 10/20 [00:34<00:31,  3.11s/it]
Task 1, Epoch 11/20 => Loss 0.527, Train_accy 94.86:  55%|█████▌    | 11/20 [00:34<00:27,  3.10s/it]
Task 1, Epoch 12/20 => Loss 0.507, Train_accy 95.07:  55%|█████▌    | 11/20 [00:37<00:27,  3.10s/it]
Task 1, Epoch 12/20 => Loss 0.507, Train_accy 95.07:  60%|██████    | 12/20 [00:37<00:24,  3.11s/it]
Task 1, Epoch 13/20 => Loss 0.467, Train_accy 94.43:  60%|██████    | 12/20 [00:40<00:24,  3.11s/it]
Task 1, Epoch 13/20 => Loss 0.467, Train_accy 94.43:  65%|██████▌   | 13/20 [00:40<00:21,  3.11s/it]
Task 1, Epoch 14/20 => Loss 0.479, Train_accy 94.65:  65%|██████▌   | 13/20 [00:43<00:21,  3.11s/it]
Task 1, Epoch 14/20 => Loss 0.479, Train_accy 94.65:  70%|███████   | 14/20 [00:43<00:18,  3.11s/it]
Task 1, Epoch 15/20 => Loss 0.424, Train_accy 94.86:  70%|███████   | 14/20 [00:46<00:18,  3.11s/it]
Task 1, Epoch 15/20 => Loss 0.424, Train_accy 94.86:  75%|███████▌  | 15/20 [00:46<00:15,  3.10s/it]
Task 1, Epoch 16/20 => Loss 0.431, Train_accy 94.65:  75%|███████▌  | 15/20 [00:49<00:15,  3.10s/it]
Task 1, Epoch 16/20 => Loss 0.431, Train_accy 94.65:  80%|████████  | 16/20 [00:49<00:12,  3.11s/it]
Task 1, Epoch 17/20 => Loss 0.433, Train_accy 95.29:  80%|████████  | 16/20 [00:52<00:12,  3.11s/it]
Task 1, Epoch 17/20 => Loss 0.433, Train_accy 95.29:  85%|████████▌ | 17/20 [00:52<00:09,  3.12s/it]
Task 1, Epoch 18/20 => Loss 0.438, Train_accy 94.00:  85%|████████▌ | 17/20 [00:55<00:09,  3.12s/it]
Task 1, Epoch 18/20 => Loss 0.438, Train_accy 94.00:  90%|█████████ | 18/20 [00:55<00:06,  3.11s/it]
Task 1, Epoch 19/20 => Loss 0.390, Train_accy 95.07:  90%|█████████ | 18/20 [00:59<00:06,  3.11s/it]
Task 1, Epoch 19/20 => Loss 0.390, Train_accy 95.07:  95%|█████████▌| 19/20 [00:59<00:03,  3.10s/it]
Task 1, Epoch 20/20 => Loss 0.446, Train_accy 94.43:  95%|█████████▌| 19/20 [01:02<00:03,  3.10s/it]
Task 1, Epoch 20/20 => Loss 0.446, Train_accy 94.43: 100%|██████████| 20/20 [01:02<00:00,  3.10s/it]
Task 1, Epoch 20/20 => Loss 0.446, Train_accy 94.43: 100%|██████████| 20/20 [01:02<00:00,  3.11s/it]
2024-09-06 03:58:01,202 [ease.py] => Task 1, Epoch 20/20 => Loss 0.446, Train_accy 94.43
2024-09-06 03:58:06,807 [ease.py] => Task correct: 100.0
2024-09-06 03:58:06,808 [ease.py] => Task acc: 99.19028340080972
2024-09-06 03:58:06,831 [trainer.py] => No NME accuracy.
2024-09-06 03:58:06,831 [trainer.py] => CNN: {'total': 99.19, '00-09': 100.0, '10-19': 98.45, 'old': 100.0, 'new': 98.45}
2024-09-06 03:58:06,831 [trainer.py] => CNN top1 curve: [100.0, 99.19]
2024-09-06 03:58:06,831 [trainer.py] => CNN top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 99.6
2024-09-06 03:58:06,831 [trainer.py] => Average Accuracy (CNN): 99.6 

2024-09-06 03:58:06,832 [trainer.py] => All params: 86141378
2024-09-06 03:58:06,832 [trainer.py] => Trainable params: 304320
2024-09-06 03:58:06,834 [ease.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.278, Train_accy 32.56:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.278, Train_accy 32.56:   5%|▌         | 1/20 [00:03<00:59,  3.12s/it]
Task 2, Epoch 2/20 => Loss 2.133, Train_accy 88.87:   5%|▌         | 1/20 [00:06<00:59,  3.12s/it]
Task 2, Epoch 2/20 => Loss 2.133, Train_accy 88.87:  10%|█         | 2/20 [00:06<00:56,  3.12s/it]
Task 2, Epoch 3/20 => Loss 1.879, Train_accy 96.43:  10%|█         | 2/20 [00:09<00:56,  3.12s/it]
Task 2, Epoch 3/20 => Loss 1.879, Train_accy 96.43:  15%|█▌        | 3/20 [00:09<00:53,  3.13s/it]
Task 2, Epoch 4/20 => Loss 1.531, Train_accy 96.85:  15%|█▌        | 3/20 [00:12<00:53,  3.13s/it]
Task 2, Epoch 4/20 => Loss 1.531, Train_accy 96.85:  20%|██        | 4/20 [00:12<00:50,  3.17s/it]
Task 2, Epoch 5/20 => Loss 1.169, Train_accy 95.80:  20%|██        | 4/20 [00:15<00:50,  3.17s/it]
Task 2, Epoch 5/20 => Loss 1.169, Train_accy 95.80:  25%|██▌       | 5/20 [00:15<00:47,  3.15s/it]
Task 2, Epoch 6/20 => Loss 0.849, Train_accy 97.06:  25%|██▌       | 5/20 [00:18<00:47,  3.15s/it]
Task 2, Epoch 6/20 => Loss 0.849, Train_accy 97.06:  30%|███       | 6/20 [00:18<00:44,  3.15s/it]
Task 2, Epoch 7/20 => Loss 0.671, Train_accy 96.64:  30%|███       | 6/20 [00:22<00:44,  3.15s/it]
Task 2, Epoch 7/20 => Loss 0.671, Train_accy 96.64:  35%|███▌      | 7/20 [00:22<00:41,  3.16s/it]
Task 2, Epoch 8/20 => Loss 0.533, Train_accy 96.85:  35%|███▌      | 7/20 [00:25<00:41,  3.16s/it]
Task 2, Epoch 8/20 => Loss 0.533, Train_accy 96.85:  40%|████      | 8/20 [00:25<00:37,  3.16s/it]
Task 2, Epoch 9/20 => Loss 0.462, Train_accy 96.22:  40%|████      | 8/20 [00:28<00:37,  3.16s/it]
Task 2, Epoch 9/20 => Loss 0.462, Train_accy 96.22:  45%|████▌     | 9/20 [00:28<00:34,  3.15s/it]
Task 2, Epoch 10/20 => Loss 0.393, Train_accy 97.48:  45%|████▌     | 9/20 [00:31<00:34,  3.15s/it]
Task 2, Epoch 10/20 => Loss 0.393, Train_accy 97.48:  50%|█████     | 10/20 [00:31<00:31,  3.14s/it]
Task 2, Epoch 11/20 => Loss 0.369, Train_accy 97.06:  50%|█████     | 10/20 [00:34<00:31,  3.14s/it]
Task 2, Epoch 11/20 => Loss 0.369, Train_accy 97.06:  55%|█████▌    | 11/20 [00:34<00:28,  3.14s/it]
Task 2, Epoch 12/20 => Loss 0.340, Train_accy 97.48:  55%|█████▌    | 11/20 [00:37<00:28,  3.14s/it]
Task 2, Epoch 12/20 => Loss 0.340, Train_accy 97.48:  60%|██████    | 12/20 [00:37<00:25,  3.16s/it]
Task 2, Epoch 13/20 => Loss 0.328, Train_accy 97.48:  60%|██████    | 12/20 [00:40<00:25,  3.16s/it]
Task 2, Epoch 13/20 => Loss 0.328, Train_accy 97.48:  65%|██████▌   | 13/20 [00:40<00:22,  3.15s/it]
Task 2, Epoch 14/20 => Loss 0.297, Train_accy 97.06:  65%|██████▌   | 13/20 [00:44<00:22,  3.15s/it]
Task 2, Epoch 14/20 => Loss 0.297, Train_accy 97.06:  70%|███████   | 14/20 [00:44<00:18,  3.16s/it]
Task 2, Epoch 15/20 => Loss 0.287, Train_accy 96.85:  70%|███████   | 14/20 [00:47<00:18,  3.16s/it]
Task 2, Epoch 15/20 => Loss 0.287, Train_accy 96.85:  75%|███████▌  | 15/20 [00:47<00:15,  3.15s/it]
Task 2, Epoch 16/20 => Loss 0.258, Train_accy 97.90:  75%|███████▌  | 15/20 [00:50<00:15,  3.15s/it]
Task 2, Epoch 16/20 => Loss 0.258, Train_accy 97.90:  80%|████████  | 16/20 [00:50<00:12,  3.15s/it]
Task 2, Epoch 17/20 => Loss 0.289, Train_accy 96.64:  80%|████████  | 16/20 [00:53<00:12,  3.15s/it]
Task 2, Epoch 17/20 => Loss 0.289, Train_accy 96.64:  85%|████████▌ | 17/20 [00:53<00:09,  3.14s/it]
Task 2, Epoch 18/20 => Loss 0.297, Train_accy 97.06:  85%|████████▌ | 17/20 [00:56<00:09,  3.14s/it]
Task 2, Epoch 18/20 => Loss 0.297, Train_accy 97.06:  90%|█████████ | 18/20 [00:56<00:06,  3.13s/it]
Task 2, Epoch 19/20 => Loss 0.271, Train_accy 97.90:  90%|█████████ | 18/20 [00:59<00:06,  3.13s/it]
Task 2, Epoch 19/20 => Loss 0.271, Train_accy 97.90:  95%|█████████▌| 19/20 [00:59<00:03,  3.13s/it]
Task 2, Epoch 20/20 => Loss 0.295, Train_accy 97.27:  95%|█████████▌| 19/20 [01:02<00:03,  3.13s/it]
Task 2, Epoch 20/20 => Loss 0.295, Train_accy 97.27: 100%|██████████| 20/20 [01:02<00:00,  3.14s/it]
Task 2, Epoch 20/20 => Loss 0.295, Train_accy 97.27: 100%|██████████| 20/20 [01:02<00:00,  3.15s/it]
2024-09-06 03:59:09,778 [ease.py] => Task 2, Epoch 20/20 => Loss 0.295, Train_accy 97.27
2024-09-06 03:59:19,090 [ease.py] => Task correct: 98.83720930232558
2024-09-06 03:59:19,091 [ease.py] => Task acc: 99.12790697674419
2024-09-06 03:59:19,114 [trainer.py] => No NME accuracy.
2024-09-06 03:59:19,114 [trainer.py] => CNN: {'total': 98.26, '00-09': 98.31, '10-19': 98.45, '20-29': 97.94, 'old': 98.38, 'new': 97.94}
2024-09-06 03:59:19,114 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26]
2024-09-06 03:59:19,114 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71]

Average Accuracy (CNN): 99.15
2024-09-06 03:59:19,114 [trainer.py] => Average Accuracy (CNN): 99.15 

2024-09-06 03:59:19,115 [trainer.py] => All params: 86179778
2024-09-06 03:59:19,116 [trainer.py] => Trainable params: 304320
2024-09-06 03:59:19,117 [ease.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.265, Train_accy 39.45:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.265, Train_accy 39.45:   5%|▌         | 1/20 [00:03<01:00,  3.16s/it]
Task 3, Epoch 2/20 => Loss 2.124, Train_accy 87.21:   5%|▌         | 1/20 [00:06<01:00,  3.16s/it]
Task 3, Epoch 2/20 => Loss 2.124, Train_accy 87.21:  10%|█         | 2/20 [00:06<00:56,  3.17s/it]
Task 3, Epoch 3/20 => Loss 1.891, Train_accy 92.11:  10%|█         | 2/20 [00:09<00:56,  3.17s/it]
Task 3, Epoch 3/20 => Loss 1.891, Train_accy 92.11:  15%|█▌        | 3/20 [00:09<00:53,  3.14s/it]
Task 3, Epoch 4/20 => Loss 1.560, Train_accy 92.75:  15%|█▌        | 3/20 [00:12<00:53,  3.14s/it]
Task 3, Epoch 4/20 => Loss 1.560, Train_accy 92.75:  20%|██        | 4/20 [00:12<00:49,  3.12s/it]
Task 3, Epoch 5/20 => Loss 1.193, Train_accy 94.46:  20%|██        | 4/20 [00:15<00:49,  3.12s/it]
Task 3, Epoch 5/20 => Loss 1.193, Train_accy 94.46:  25%|██▌       | 5/20 [00:15<00:46,  3.12s/it]
Task 3, Epoch 6/20 => Loss 0.918, Train_accy 95.95:  25%|██▌       | 5/20 [00:18<00:46,  3.12s/it]
Task 3, Epoch 6/20 => Loss 0.918, Train_accy 95.95:  30%|███       | 6/20 [00:18<00:43,  3.11s/it]
Task 3, Epoch 7/20 => Loss 0.734, Train_accy 94.88:  30%|███       | 6/20 [00:21<00:43,  3.11s/it]
Task 3, Epoch 7/20 => Loss 0.734, Train_accy 94.88:  35%|███▌      | 7/20 [00:21<00:40,  3.11s/it]
Task 3, Epoch 8/20 => Loss 0.594, Train_accy 96.38:  35%|███▌      | 7/20 [00:24<00:40,  3.11s/it]
Task 3, Epoch 8/20 => Loss 0.594, Train_accy 96.38:  40%|████      | 8/20 [00:24<00:37,  3.12s/it]
Task 3, Epoch 9/20 => Loss 0.504, Train_accy 96.38:  40%|████      | 8/20 [00:28<00:37,  3.12s/it]
Task 3, Epoch 9/20 => Loss 0.504, Train_accy 96.38:  45%|████▌     | 9/20 [00:28<00:34,  3.11s/it]
Task 3, Epoch 10/20 => Loss 0.484, Train_accy 95.95:  45%|████▌     | 9/20 [00:31<00:34,  3.11s/it]
Task 3, Epoch 10/20 => Loss 0.484, Train_accy 95.95:  50%|█████     | 10/20 [00:31<00:31,  3.11s/it]
Task 3, Epoch 11/20 => Loss 0.453, Train_accy 95.31:  50%|█████     | 10/20 [00:34<00:31,  3.11s/it]
Task 3, Epoch 11/20 => Loss 0.453, Train_accy 95.31:  55%|█████▌    | 11/20 [00:34<00:27,  3.10s/it]
Task 3, Epoch 12/20 => Loss 0.425, Train_accy 94.88:  55%|█████▌    | 11/20 [00:37<00:27,  3.10s/it]
Task 3, Epoch 12/20 => Loss 0.425, Train_accy 94.88:  60%|██████    | 12/20 [00:37<00:24,  3.11s/it]
Task 3, Epoch 13/20 => Loss 0.373, Train_accy 95.31:  60%|██████    | 12/20 [00:40<00:24,  3.11s/it]
Task 3, Epoch 13/20 => Loss 0.373, Train_accy 95.31:  65%|██████▌   | 13/20 [00:40<00:21,  3.11s/it]
Task 3, Epoch 14/20 => Loss 0.344, Train_accy 96.38:  65%|██████▌   | 13/20 [00:43<00:21,  3.11s/it]
Task 3, Epoch 14/20 => Loss 0.344, Train_accy 96.38:  70%|███████   | 14/20 [00:43<00:18,  3.12s/it]
Task 3, Epoch 15/20 => Loss 0.339, Train_accy 96.80:  70%|███████   | 14/20 [00:46<00:18,  3.12s/it]
Task 3, Epoch 15/20 => Loss 0.339, Train_accy 96.80:  75%|███████▌  | 15/20 [00:46<00:15,  3.12s/it]
Task 3, Epoch 16/20 => Loss 0.384, Train_accy 94.67:  75%|███████▌  | 15/20 [00:49<00:15,  3.12s/it]
Task 3, Epoch 16/20 => Loss 0.384, Train_accy 94.67:  80%|████████  | 16/20 [00:49<00:12,  3.11s/it]
Task 3, Epoch 17/20 => Loss 0.342, Train_accy 96.80:  80%|████████  | 16/20 [00:52<00:12,  3.11s/it]
Task 3, Epoch 17/20 => Loss 0.342, Train_accy 96.80:  85%|████████▌ | 17/20 [00:52<00:09,  3.11s/it]
Task 3, Epoch 18/20 => Loss 0.310, Train_accy 97.23:  85%|████████▌ | 17/20 [00:56<00:09,  3.11s/it]
Task 3, Epoch 18/20 => Loss 0.310, Train_accy 97.23:  90%|█████████ | 18/20 [00:56<00:06,  3.12s/it]
Task 3, Epoch 19/20 => Loss 0.327, Train_accy 96.16:  90%|█████████ | 18/20 [00:59<00:06,  3.12s/it]
Task 3, Epoch 19/20 => Loss 0.327, Train_accy 96.16:  95%|█████████▌| 19/20 [00:59<00:03,  3.12s/it]
Task 3, Epoch 20/20 => Loss 0.336, Train_accy 95.10:  95%|█████████▌| 19/20 [01:02<00:03,  3.12s/it]
Task 3, Epoch 20/20 => Loss 0.336, Train_accy 95.10: 100%|██████████| 20/20 [01:02<00:00,  3.12s/it]
Task 3, Epoch 20/20 => Loss 0.336, Train_accy 95.10: 100%|██████████| 20/20 [01:02<00:00,  3.12s/it]
2024-09-06 04:00:21,462 [ease.py] => Task 3, Epoch 20/20 => Loss 0.336, Train_accy 95.10
2024-09-06 04:00:34,484 [ease.py] => Task correct: 97.3568281938326
2024-09-06 04:00:34,485 [ease.py] => Task acc: 99.33920704845815
2024-09-06 04:00:34,507 [trainer.py] => No NME accuracy.
2024-09-06 04:00:34,508 [trainer.py] => CNN: {'total': 96.92, '00-09': 97.46, '10-19': 96.9, '20-29': 95.88, '30-39': 97.27, 'old': 96.8, 'new': 97.27}
2024-09-06 04:00:34,508 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92]
2024-09-06 04:00:34,508 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78]

Average Accuracy (CNN): 98.59
2024-09-06 04:00:34,508 [trainer.py] => Average Accuracy (CNN): 98.59 

2024-09-06 04:00:34,509 [trainer.py] => All params: 86233538
2024-09-06 04:00:34,509 [trainer.py] => Trainable params: 304320
2024-09-06 04:00:34,512 [ease.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.285, Train_accy 19.83:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.285, Train_accy 19.83:   5%|▌         | 1/20 [00:03<00:58,  3.09s/it]
Task 4, Epoch 2/20 => Loss 2.166, Train_accy 74.84:   5%|▌         | 1/20 [00:06<00:58,  3.09s/it]
Task 4, Epoch 2/20 => Loss 2.166, Train_accy 74.84:  10%|█         | 2/20 [00:06<00:56,  3.12s/it]
Task 4, Epoch 3/20 => Loss 1.964, Train_accy 89.55:  10%|█         | 2/20 [00:09<00:56,  3.12s/it]
Task 4, Epoch 3/20 => Loss 1.964, Train_accy 89.55:  15%|█▌        | 3/20 [00:09<00:53,  3.14s/it]
Task 4, Epoch 4/20 => Loss 1.702, Train_accy 88.91:  15%|█▌        | 3/20 [00:12<00:53,  3.14s/it]
Task 4, Epoch 4/20 => Loss 1.702, Train_accy 88.91:  20%|██        | 4/20 [00:12<00:49,  3.12s/it]
Task 4, Epoch 5/20 => Loss 1.376, Train_accy 91.04:  20%|██        | 4/20 [00:15<00:49,  3.12s/it]
Task 4, Epoch 5/20 => Loss 1.376, Train_accy 91.04:  25%|██▌       | 5/20 [00:15<00:46,  3.12s/it]
Task 4, Epoch 6/20 => Loss 1.083, Train_accy 93.60:  25%|██▌       | 5/20 [00:18<00:46,  3.12s/it]
Task 4, Epoch 6/20 => Loss 1.083, Train_accy 93.60:  30%|███       | 6/20 [00:18<00:43,  3.11s/it]
Task 4, Epoch 7/20 => Loss 0.868, Train_accy 95.10:  30%|███       | 6/20 [00:21<00:43,  3.11s/it]
Task 4, Epoch 7/20 => Loss 0.868, Train_accy 95.10:  35%|███▌      | 7/20 [00:21<00:40,  3.10s/it]
Task 4, Epoch 8/20 => Loss 0.689, Train_accy 95.95:  35%|███▌      | 7/20 [00:24<00:40,  3.10s/it]
Task 4, Epoch 8/20 => Loss 0.689, Train_accy 95.95:  40%|████      | 8/20 [00:24<00:37,  3.10s/it]
Task 4, Epoch 9/20 => Loss 0.588, Train_accy 95.31:  40%|████      | 8/20 [00:27<00:37,  3.10s/it]
Task 4, Epoch 9/20 => Loss 0.588, Train_accy 95.31:  45%|████▌     | 9/20 [00:27<00:34,  3.10s/it]
Task 4, Epoch 10/20 => Loss 0.545, Train_accy 95.10:  45%|████▌     | 9/20 [00:31<00:34,  3.10s/it]
Task 4, Epoch 10/20 => Loss 0.545, Train_accy 95.10:  50%|█████     | 10/20 [00:31<00:30,  3.09s/it]
Task 4, Epoch 11/20 => Loss 0.477, Train_accy 95.74:  50%|█████     | 10/20 [00:34<00:30,  3.09s/it]
Task 4, Epoch 11/20 => Loss 0.477, Train_accy 95.74:  55%|█████▌    | 11/20 [00:34<00:27,  3.09s/it]
Task 4, Epoch 12/20 => Loss 0.425, Train_accy 95.74:  55%|█████▌    | 11/20 [00:37<00:27,  3.09s/it]
Task 4, Epoch 12/20 => Loss 0.425, Train_accy 95.74:  60%|██████    | 12/20 [00:37<00:24,  3.09s/it]
Task 4, Epoch 13/20 => Loss 0.434, Train_accy 95.95:  60%|██████    | 12/20 [00:40<00:24,  3.09s/it]
Task 4, Epoch 13/20 => Loss 0.434, Train_accy 95.95:  65%|██████▌   | 13/20 [00:40<00:21,  3.09s/it]
Task 4, Epoch 14/20 => Loss 0.457, Train_accy 93.39:  65%|██████▌   | 13/20 [00:43<00:21,  3.09s/it]
Task 4, Epoch 14/20 => Loss 0.457, Train_accy 93.39:  70%|███████   | 14/20 [00:43<00:18,  3.09s/it]
Task 4, Epoch 15/20 => Loss 0.376, Train_accy 95.74:  70%|███████   | 14/20 [00:46<00:18,  3.09s/it]
Task 4, Epoch 15/20 => Loss 0.376, Train_accy 95.74:  75%|███████▌  | 15/20 [00:46<00:15,  3.09s/it]
Task 4, Epoch 16/20 => Loss 0.377, Train_accy 95.95:  75%|███████▌  | 15/20 [00:49<00:15,  3.09s/it]
Task 4, Epoch 16/20 => Loss 0.377, Train_accy 95.95:  80%|████████  | 16/20 [00:49<00:12,  3.09s/it]
Task 4, Epoch 17/20 => Loss 0.367, Train_accy 96.16:  80%|████████  | 16/20 [00:52<00:12,  3.09s/it]
Task 4, Epoch 17/20 => Loss 0.367, Train_accy 96.16:  85%|████████▌ | 17/20 [00:52<00:09,  3.09s/it]
Task 4, Epoch 18/20 => Loss 0.389, Train_accy 94.46:  85%|████████▌ | 17/20 [00:55<00:09,  3.09s/it]
Task 4, Epoch 18/20 => Loss 0.389, Train_accy 94.46:  90%|█████████ | 18/20 [00:55<00:06,  3.09s/it]
Task 4, Epoch 19/20 => Loss 0.388, Train_accy 94.88:  90%|█████████ | 18/20 [00:58<00:06,  3.09s/it]
Task 4, Epoch 19/20 => Loss 0.388, Train_accy 94.88:  95%|█████████▌| 19/20 [00:58<00:03,  3.09s/it]
Task 4, Epoch 20/20 => Loss 0.362, Train_accy 95.74:  95%|█████████▌| 19/20 [01:01<00:03,  3.09s/it]
Task 4, Epoch 20/20 => Loss 0.362, Train_accy 95.74: 100%|██████████| 20/20 [01:01<00:00,  3.10s/it]
Task 4, Epoch 20/20 => Loss 0.362, Train_accy 95.74: 100%|██████████| 20/20 [01:01<00:00,  3.10s/it]
2024-09-06 04:01:36,490 [ease.py] => Task 4, Epoch 20/20 => Loss 0.362, Train_accy 95.74
2024-09-06 04:01:54,278 [ease.py] => Task correct: 96.96969696969697
2024-09-06 04:01:54,278 [ease.py] => Task acc: 99.46524064171123
2024-09-06 04:01:54,298 [trainer.py] => No NME accuracy.
2024-09-06 04:01:54,299 [trainer.py] => CNN: {'total': 96.61, '00-09': 97.46, '10-19': 96.9, '20-29': 95.88, '30-39': 95.45, '40-49': 97.2, 'old': 96.48, 'new': 97.2}
2024-09-06 04:01:54,299 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61]
2024-09-06 04:01:54,299 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64]

Average Accuracy (CNN): 98.2
2024-09-06 04:01:54,299 [trainer.py] => Average Accuracy (CNN): 98.2 

2024-09-06 04:01:54,299 [trainer.py] => All params: 86302658
2024-09-06 04:01:54,300 [trainer.py] => Trainable params: 304320
2024-09-06 04:01:54,303 [ease.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.282, Train_accy 28.27:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.282, Train_accy 28.27:   5%|▌         | 1/20 [00:03<00:59,  3.11s/it]
Task 5, Epoch 2/20 => Loss 2.163, Train_accy 79.96:   5%|▌         | 1/20 [00:06<00:59,  3.11s/it]
Task 5, Epoch 2/20 => Loss 2.163, Train_accy 79.96:  10%|█         | 2/20 [00:06<00:56,  3.12s/it]
Task 5, Epoch 3/20 => Loss 1.971, Train_accy 90.93:  10%|█         | 2/20 [00:09<00:56,  3.12s/it]
Task 5, Epoch 3/20 => Loss 1.971, Train_accy 90.93:  15%|█▌        | 3/20 [00:09<00:53,  3.12s/it]
Task 5, Epoch 4/20 => Loss 1.688, Train_accy 92.83:  15%|█▌        | 3/20 [00:12<00:53,  3.12s/it]
Task 5, Epoch 4/20 => Loss 1.688, Train_accy 92.83:  20%|██        | 4/20 [00:12<00:50,  3.13s/it]
Task 5, Epoch 5/20 => Loss 1.354, Train_accy 94.94:  20%|██        | 4/20 [00:15<00:50,  3.13s/it]
Task 5, Epoch 5/20 => Loss 1.354, Train_accy 94.94:  25%|██▌       | 5/20 [00:15<00:46,  3.13s/it]
Task 5, Epoch 6/20 => Loss 1.060, Train_accy 95.99:  25%|██▌       | 5/20 [00:18<00:46,  3.13s/it]
Task 5, Epoch 6/20 => Loss 1.060, Train_accy 95.99:  30%|███       | 6/20 [00:18<00:43,  3.13s/it]
Task 5, Epoch 7/20 => Loss 0.855, Train_accy 95.57:  30%|███       | 6/20 [00:21<00:43,  3.13s/it]
Task 5, Epoch 7/20 => Loss 0.855, Train_accy 95.57:  35%|███▌      | 7/20 [00:21<00:40,  3.13s/it]
Task 5, Epoch 8/20 => Loss 0.721, Train_accy 95.99:  35%|███▌      | 7/20 [00:25<00:40,  3.13s/it]
Task 5, Epoch 8/20 => Loss 0.721, Train_accy 95.99:  40%|████      | 8/20 [00:25<00:37,  3.13s/it]
Task 5, Epoch 9/20 => Loss 0.646, Train_accy 93.88:  40%|████      | 8/20 [00:28<00:37,  3.13s/it]
Task 5, Epoch 9/20 => Loss 0.646, Train_accy 93.88:  45%|████▌     | 9/20 [00:28<00:34,  3.13s/it]
Task 5, Epoch 10/20 => Loss 0.555, Train_accy 95.15:  45%|████▌     | 9/20 [00:31<00:34,  3.13s/it]
Task 5, Epoch 10/20 => Loss 0.555, Train_accy 95.15:  50%|█████     | 10/20 [00:31<00:31,  3.13s/it]
Task 5, Epoch 11/20 => Loss 0.490, Train_accy 95.57:  50%|█████     | 10/20 [00:34<00:31,  3.13s/it]
Task 5, Epoch 11/20 => Loss 0.490, Train_accy 95.57:  55%|█████▌    | 11/20 [00:34<00:28,  3.14s/it]
Task 5, Epoch 12/20 => Loss 0.478, Train_accy 94.51:  55%|█████▌    | 11/20 [00:37<00:28,  3.14s/it]
Task 5, Epoch 12/20 => Loss 0.478, Train_accy 94.51:  60%|██████    | 12/20 [00:37<00:25,  3.14s/it]
Task 5, Epoch 13/20 => Loss 0.452, Train_accy 94.51:  60%|██████    | 12/20 [00:40<00:25,  3.14s/it]
Task 5, Epoch 13/20 => Loss 0.452, Train_accy 94.51:  65%|██████▌   | 13/20 [00:40<00:21,  3.14s/it]
Task 5, Epoch 14/20 => Loss 0.438, Train_accy 94.30:  65%|██████▌   | 13/20 [00:43<00:21,  3.14s/it]
Task 5, Epoch 14/20 => Loss 0.438, Train_accy 94.30:  70%|███████   | 14/20 [00:43<00:18,  3.13s/it]
Task 5, Epoch 15/20 => Loss 0.423, Train_accy 94.73:  70%|███████   | 14/20 [00:46<00:18,  3.13s/it]
Task 5, Epoch 15/20 => Loss 0.423, Train_accy 94.73:  75%|███████▌  | 15/20 [00:46<00:15,  3.13s/it]
Task 5, Epoch 16/20 => Loss 0.398, Train_accy 94.30:  75%|███████▌  | 15/20 [00:50<00:15,  3.13s/it]
Task 5, Epoch 16/20 => Loss 0.398, Train_accy 94.30:  80%|████████  | 16/20 [00:50<00:12,  3.13s/it]
Task 5, Epoch 17/20 => Loss 0.426, Train_accy 93.88:  80%|████████  | 16/20 [00:53<00:12,  3.13s/it]
Task 5, Epoch 17/20 => Loss 0.426, Train_accy 93.88:  85%|████████▌ | 17/20 [00:53<00:09,  3.13s/it]
Task 5, Epoch 18/20 => Loss 0.412, Train_accy 94.94:  85%|████████▌ | 17/20 [00:56<00:09,  3.13s/it]
Task 5, Epoch 18/20 => Loss 0.412, Train_accy 94.94:  90%|█████████ | 18/20 [00:56<00:06,  3.14s/it]
Task 5, Epoch 19/20 => Loss 0.431, Train_accy 93.88:  90%|█████████ | 18/20 [00:59<00:06,  3.14s/it]
Task 5, Epoch 19/20 => Loss 0.431, Train_accy 93.88:  95%|█████████▌| 19/20 [00:59<00:03,  3.17s/it]
Task 5, Epoch 20/20 => Loss 0.391, Train_accy 94.51:  95%|█████████▌| 19/20 [01:02<00:03,  3.17s/it]
Task 5, Epoch 20/20 => Loss 0.391, Train_accy 94.51: 100%|██████████| 20/20 [01:02<00:00,  3.15s/it]
Task 5, Epoch 20/20 => Loss 0.391, Train_accy 94.51: 100%|██████████| 20/20 [01:02<00:00,  3.14s/it]
2024-09-06 04:02:57,043 [ease.py] => Task 5, Epoch 20/20 => Loss 0.391, Train_accy 94.51
2024-09-06 04:03:20,115 [ease.py] => Task correct: 93.75
2024-09-06 04:03:20,115 [ease.py] => Task acc: 98.95833333333333
2024-09-06 04:03:20,137 [trainer.py] => No NME accuracy.
2024-09-06 04:03:20,137 [trainer.py] => CNN: {'total': 93.15, '00-09': 83.9, '10-19': 96.9, '20-29': 95.88, '30-39': 95.45, '40-49': 96.26, '50-59': 90.99, 'old': 93.58, 'new': 90.99}
2024-09-06 04:03:20,138 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15]
2024-09-06 04:03:20,138 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26]

Average Accuracy (CNN): 97.36
2024-09-06 04:03:20,138 [trainer.py] => Average Accuracy (CNN): 97.36 

2024-09-06 04:03:20,139 [trainer.py] => All params: 86387138
2024-09-06 04:03:20,139 [trainer.py] => Trainable params: 304320
2024-09-06 04:03:20,144 [ease.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.278, Train_accy 26.69:   0%|          | 0/20 [00:03<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.278, Train_accy 26.69:   5%|▌         | 1/20 [00:03<01:00,  3.19s/it]
Task 6, Epoch 2/20 => Loss 2.140, Train_accy 85.63:   5%|▌         | 1/20 [00:06<01:00,  3.19s/it]
Task 6, Epoch 2/20 => Loss 2.140, Train_accy 85.63:  10%|█         | 2/20 [00:06<00:57,  3.20s/it]
Task 6, Epoch 3/20 => Loss 1.884, Train_accy 93.22:  10%|█         | 2/20 [00:09<00:57,  3.20s/it]
Task 6, Epoch 3/20 => Loss 1.884, Train_accy 93.22:  15%|█▌        | 3/20 [00:09<00:54,  3.22s/it]
Task 6, Epoch 4/20 => Loss 1.538, Train_accy 93.22:  15%|█▌        | 3/20 [00:12<00:54,  3.22s/it]
Task 6, Epoch 4/20 => Loss 1.538, Train_accy 93.22:  20%|██        | 4/20 [00:12<00:52,  3.25s/it]
Task 6, Epoch 5/20 => Loss 1.213, Train_accy 94.46:  20%|██        | 4/20 [00:16<00:52,  3.25s/it]
Task 6, Epoch 5/20 => Loss 1.213, Train_accy 94.46:  25%|██▌       | 5/20 [00:16<00:48,  3.26s/it]
Task 6, Epoch 6/20 => Loss 0.892, Train_accy 95.48:  25%|██▌       | 5/20 [00:19<00:48,  3.26s/it]
Task 6, Epoch 6/20 => Loss 0.892, Train_accy 95.48:  30%|███       | 6/20 [00:19<00:45,  3.26s/it]
Task 6, Epoch 7/20 => Loss 0.727, Train_accy 94.05:  30%|███       | 6/20 [00:22<00:45,  3.26s/it]
Task 6, Epoch 7/20 => Loss 0.727, Train_accy 94.05:  35%|███▌      | 7/20 [00:22<00:42,  3.25s/it]
Task 6, Epoch 8/20 => Loss 0.612, Train_accy 95.07:  35%|███▌      | 7/20 [00:25<00:42,  3.25s/it]
Task 6, Epoch 8/20 => Loss 0.612, Train_accy 95.07:  40%|████      | 8/20 [00:25<00:39,  3.26s/it]
Task 6, Epoch 9/20 => Loss 0.537, Train_accy 94.66:  40%|████      | 8/20 [00:29<00:39,  3.26s/it]
Task 6, Epoch 9/20 => Loss 0.537, Train_accy 94.66:  45%|████▌     | 9/20 [00:29<00:35,  3.26s/it]
Task 6, Epoch 10/20 => Loss 0.482, Train_accy 94.46:  45%|████▌     | 9/20 [00:32<00:35,  3.26s/it]
Task 6, Epoch 10/20 => Loss 0.482, Train_accy 94.46:  50%|█████     | 10/20 [00:32<00:32,  3.26s/it]
Task 6, Epoch 11/20 => Loss 0.470, Train_accy 94.46:  50%|█████     | 10/20 [00:35<00:32,  3.26s/it]
Task 6, Epoch 11/20 => Loss 0.470, Train_accy 94.46:  55%|█████▌    | 11/20 [00:35<00:29,  3.25s/it]
Task 6, Epoch 12/20 => Loss 0.373, Train_accy 96.71:  55%|█████▌    | 11/20 [00:38<00:29,  3.25s/it]
Task 6, Epoch 12/20 => Loss 0.373, Train_accy 96.71:  60%|██████    | 12/20 [00:38<00:25,  3.25s/it]
Task 6, Epoch 13/20 => Loss 0.347, Train_accy 95.69:  60%|██████    | 12/20 [00:42<00:25,  3.25s/it]
Task 6, Epoch 13/20 => Loss 0.347, Train_accy 95.69:  65%|██████▌   | 13/20 [00:42<00:22,  3.24s/it]
Task 6, Epoch 14/20 => Loss 0.368, Train_accy 95.48:  65%|██████▌   | 13/20 [00:45<00:22,  3.24s/it]
Task 6, Epoch 14/20 => Loss 0.368, Train_accy 95.48:  70%|███████   | 14/20 [00:45<00:19,  3.24s/it]
Task 6, Epoch 15/20 => Loss 0.343, Train_accy 95.48:  70%|███████   | 14/20 [00:48<00:19,  3.24s/it]
Task 6, Epoch 15/20 => Loss 0.343, Train_accy 95.48:  75%|███████▌  | 15/20 [00:48<00:16,  3.24s/it]
Task 6, Epoch 16/20 => Loss 0.348, Train_accy 95.48:  75%|███████▌  | 15/20 [00:51<00:16,  3.24s/it]
Task 6, Epoch 16/20 => Loss 0.348, Train_accy 95.48:  80%|████████  | 16/20 [00:51<00:12,  3.23s/it]
Task 6, Epoch 17/20 => Loss 0.337, Train_accy 95.69:  80%|████████  | 16/20 [00:55<00:12,  3.23s/it]
Task 6, Epoch 17/20 => Loss 0.337, Train_accy 95.69:  85%|████████▌ | 17/20 [00:55<00:09,  3.23s/it]
Task 6, Epoch 18/20 => Loss 0.295, Train_accy 96.51:  85%|████████▌ | 17/20 [00:58<00:09,  3.23s/it]
Task 6, Epoch 18/20 => Loss 0.295, Train_accy 96.51:  90%|█████████ | 18/20 [00:58<00:06,  3.23s/it]
Task 6, Epoch 19/20 => Loss 0.321, Train_accy 94.05:  90%|█████████ | 18/20 [01:01<00:06,  3.23s/it]
Task 6, Epoch 19/20 => Loss 0.321, Train_accy 94.05:  95%|█████████▌| 19/20 [01:01<00:03,  3.23s/it]
Task 6, Epoch 20/20 => Loss 0.306, Train_accy 96.10:  95%|█████████▌| 19/20 [01:04<00:03,  3.23s/it]
Task 6, Epoch 20/20 => Loss 0.306, Train_accy 96.10: 100%|██████████| 20/20 [01:04<00:00,  3.22s/it]
Task 6, Epoch 20/20 => Loss 0.306, Train_accy 96.10: 100%|██████████| 20/20 [01:04<00:00,  3.24s/it]
2024-09-06 04:04:24,920 [ease.py] => Task 6, Epoch 20/20 => Loss 0.306, Train_accy 96.10
2024-09-06 04:04:54,436 [ease.py] => Task correct: 91.77377892030849
2024-09-06 04:04:54,437 [ease.py] => Task acc: 98.97172236503856
2024-09-06 04:04:54,463 [trainer.py] => No NME accuracy.
2024-09-06 04:04:54,463 [trainer.py] => CNN: {'total': 91.39, '00-09': 83.05, '10-19': 90.7, '20-29': 95.88, '30-39': 94.55, '40-49': 95.33, '50-59': 88.29, '60-69': 93.4, 'old': 91.07, 'new': 93.4}
2024-09-06 04:04:54,463 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39]
2024-09-06 04:04:54,463 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1]

Average Accuracy (CNN): 96.5
2024-09-06 04:04:54,464 [trainer.py] => Average Accuracy (CNN): 96.5 

2024-09-06 04:04:54,464 [trainer.py] => All params: 86486978
2024-09-06 04:04:54,465 [trainer.py] => Trainable params: 304320
2024-09-06 04:04:54,471 [ease.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.269, Train_accy 28.98:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.269, Train_accy 28.98:   5%|▌         | 1/20 [00:03<00:58,  3.05s/it]
Task 7, Epoch 2/20 => Loss 2.117, Train_accy 91.72:   5%|▌         | 1/20 [00:06<00:58,  3.05s/it]
Task 7, Epoch 2/20 => Loss 2.117, Train_accy 91.72:  10%|█         | 2/20 [00:06<00:55,  3.06s/it]
Task 7, Epoch 3/20 => Loss 1.864, Train_accy 92.59:  10%|█         | 2/20 [00:09<00:55,  3.06s/it]
Task 7, Epoch 3/20 => Loss 1.864, Train_accy 92.59:  15%|█▌        | 3/20 [00:09<00:51,  3.06s/it]
Task 7, Epoch 4/20 => Loss 1.468, Train_accy 98.04:  15%|█▌        | 3/20 [00:12<00:51,  3.06s/it]
Task 7, Epoch 4/20 => Loss 1.468, Train_accy 98.04:  20%|██        | 4/20 [00:12<00:49,  3.07s/it]
Task 7, Epoch 5/20 => Loss 1.117, Train_accy 94.77:  20%|██        | 4/20 [00:15<00:49,  3.07s/it]
Task 7, Epoch 5/20 => Loss 1.117, Train_accy 94.77:  25%|██▌       | 5/20 [00:15<00:45,  3.05s/it]
Task 7, Epoch 6/20 => Loss 0.818, Train_accy 96.73:  25%|██▌       | 5/20 [00:18<00:45,  3.05s/it]
Task 7, Epoch 6/20 => Loss 0.818, Train_accy 96.73:  30%|███       | 6/20 [00:18<00:42,  3.07s/it]
Task 7, Epoch 7/20 => Loss 0.646, Train_accy 95.86:  30%|███       | 6/20 [00:21<00:42,  3.07s/it]
Task 7, Epoch 7/20 => Loss 0.646, Train_accy 95.86:  35%|███▌      | 7/20 [00:21<00:39,  3.07s/it]
Task 7, Epoch 8/20 => Loss 0.526, Train_accy 95.42:  35%|███▌      | 7/20 [00:24<00:39,  3.07s/it]
Task 7, Epoch 8/20 => Loss 0.526, Train_accy 95.42:  40%|████      | 8/20 [00:24<00:36,  3.07s/it]
Task 7, Epoch 9/20 => Loss 0.452, Train_accy 95.42:  40%|████      | 8/20 [00:27<00:36,  3.07s/it]
Task 7, Epoch 9/20 => Loss 0.452, Train_accy 95.42:  45%|████▌     | 9/20 [00:27<00:33,  3.07s/it]
Task 7, Epoch 10/20 => Loss 0.349, Train_accy 98.26:  45%|████▌     | 9/20 [00:30<00:33,  3.07s/it]
Task 7, Epoch 10/20 => Loss 0.349, Train_accy 98.26:  50%|█████     | 10/20 [00:30<00:30,  3.06s/it]
Task 7, Epoch 11/20 => Loss 0.339, Train_accy 96.30:  50%|█████     | 10/20 [00:33<00:30,  3.06s/it]
Task 7, Epoch 11/20 => Loss 0.339, Train_accy 96.30:  55%|█████▌    | 11/20 [00:33<00:27,  3.07s/it]
Task 7, Epoch 12/20 => Loss 0.352, Train_accy 95.42:  55%|█████▌    | 11/20 [00:36<00:27,  3.07s/it]
Task 7, Epoch 12/20 => Loss 0.352, Train_accy 95.42:  60%|██████    | 12/20 [00:36<00:24,  3.06s/it]
Task 7, Epoch 13/20 => Loss 0.283, Train_accy 96.95:  60%|██████    | 12/20 [00:39<00:24,  3.06s/it]
Task 7, Epoch 13/20 => Loss 0.283, Train_accy 96.95:  65%|██████▌   | 13/20 [00:39<00:21,  3.07s/it]
Task 7, Epoch 14/20 => Loss 0.296, Train_accy 96.73:  65%|██████▌   | 13/20 [00:42<00:21,  3.07s/it]
Task 7, Epoch 14/20 => Loss 0.296, Train_accy 96.73:  70%|███████   | 14/20 [00:42<00:18,  3.06s/it]
Task 7, Epoch 15/20 => Loss 0.282, Train_accy 96.73:  70%|███████   | 14/20 [00:45<00:18,  3.06s/it]
Task 7, Epoch 15/20 => Loss 0.282, Train_accy 96.73:  75%|███████▌  | 15/20 [00:45<00:15,  3.05s/it]
Task 7, Epoch 16/20 => Loss 0.312, Train_accy 95.21:  75%|███████▌  | 15/20 [00:48<00:15,  3.05s/it]
Task 7, Epoch 16/20 => Loss 0.312, Train_accy 95.21:  80%|████████  | 16/20 [00:48<00:12,  3.05s/it]
Task 7, Epoch 17/20 => Loss 0.259, Train_accy 97.17:  80%|████████  | 16/20 [00:52<00:12,  3.05s/it]
Task 7, Epoch 17/20 => Loss 0.259, Train_accy 97.17:  85%|████████▌ | 17/20 [00:52<00:09,  3.05s/it]
Task 7, Epoch 18/20 => Loss 0.262, Train_accy 97.17:  85%|████████▌ | 17/20 [00:55<00:09,  3.05s/it]
Task 7, Epoch 18/20 => Loss 0.262, Train_accy 97.17:  90%|█████████ | 18/20 [00:55<00:06,  3.06s/it]
Task 7, Epoch 19/20 => Loss 0.272, Train_accy 97.60:  90%|█████████ | 18/20 [00:58<00:06,  3.06s/it]
Task 7, Epoch 19/20 => Loss 0.272, Train_accy 97.60:  95%|█████████▌| 19/20 [00:58<00:03,  3.06s/it]
Task 7, Epoch 20/20 => Loss 0.262, Train_accy 96.51:  95%|█████████▌| 19/20 [01:01<00:03,  3.06s/it]
Task 7, Epoch 20/20 => Loss 0.262, Train_accy 96.51: 100%|██████████| 20/20 [01:01<00:00,  3.06s/it]
Task 7, Epoch 20/20 => Loss 0.262, Train_accy 96.51: 100%|██████████| 20/20 [01:01<00:00,  3.06s/it]
2024-09-06 04:05:55,682 [ease.py] => Task 7, Epoch 20/20 => Loss 0.262, Train_accy 96.51
2024-09-06 04:06:31,875 [ease.py] => Task correct: 92.6006528835691
2024-09-06 04:06:31,875 [ease.py] => Task acc: 99.12948857453755
2024-09-06 04:06:31,888 [trainer.py] => No NME accuracy.
2024-09-06 04:06:31,888 [trainer.py] => CNN: {'total': 92.27, '00-09': 83.9, '10-19': 90.7, '20-29': 95.88, '30-39': 94.55, '40-49': 95.33, '50-59': 88.29, '60-69': 93.4, '70-79': 96.45, 'old': 91.52, 'new': 96.45}
2024-09-06 04:06:31,888 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27]
2024-09-06 04:06:31,888 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02]

Average Accuracy (CNN): 95.97
2024-09-06 04:06:31,888 [trainer.py] => Average Accuracy (CNN): 95.97 

2024-09-06 04:06:31,889 [trainer.py] => All params: 86602178
2024-09-06 04:06:31,889 [trainer.py] => Trainable params: 304320
2024-09-06 04:06:31,894 [ease.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.269, Train_accy 40.56:   0%|          | 0/20 [00:03<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.269, Train_accy 40.56:   5%|▌         | 1/20 [00:03<00:58,  3.08s/it]
Task 8, Epoch 2/20 => Loss 2.130, Train_accy 84.82:   5%|▌         | 1/20 [00:06<00:58,  3.08s/it]
Task 8, Epoch 2/20 => Loss 2.130, Train_accy 84.82:  10%|█         | 2/20 [00:06<00:55,  3.08s/it]
Task 8, Epoch 3/20 => Loss 1.904, Train_accy 86.12:  10%|█         | 2/20 [00:09<00:55,  3.08s/it]
Task 8, Epoch 3/20 => Loss 1.904, Train_accy 86.12:  15%|█▌        | 3/20 [00:09<00:53,  3.13s/it]
Task 8, Epoch 4/20 => Loss 1.568, Train_accy 88.72:  15%|█▌        | 3/20 [00:12<00:53,  3.13s/it]
Task 8, Epoch 4/20 => Loss 1.568, Train_accy 88.72:  20%|██        | 4/20 [00:12<00:49,  3.12s/it]
Task 8, Epoch 5/20 => Loss 1.230, Train_accy 92.84:  20%|██        | 4/20 [00:15<00:49,  3.12s/it]
Task 8, Epoch 5/20 => Loss 1.230, Train_accy 92.84:  25%|██▌       | 5/20 [00:15<00:46,  3.12s/it]
Task 8, Epoch 6/20 => Loss 0.908, Train_accy 94.58:  25%|██▌       | 5/20 [00:18<00:46,  3.12s/it]
Task 8, Epoch 6/20 => Loss 0.908, Train_accy 94.58:  30%|███       | 6/20 [00:18<00:43,  3.11s/it]
Task 8, Epoch 7/20 => Loss 0.733, Train_accy 95.01:  30%|███       | 6/20 [00:21<00:43,  3.11s/it]
Task 8, Epoch 7/20 => Loss 0.733, Train_accy 95.01:  35%|███▌      | 7/20 [00:21<00:40,  3.11s/it]
Task 8, Epoch 8/20 => Loss 0.648, Train_accy 93.49:  35%|███▌      | 7/20 [00:24<00:40,  3.11s/it]
Task 8, Epoch 8/20 => Loss 0.648, Train_accy 93.49:  40%|████      | 8/20 [00:24<00:37,  3.11s/it]
Task 8, Epoch 9/20 => Loss 0.532, Train_accy 95.66:  40%|████      | 8/20 [00:27<00:37,  3.11s/it]
Task 8, Epoch 9/20 => Loss 0.532, Train_accy 95.66:  45%|████▌     | 9/20 [00:27<00:34,  3.11s/it]
Task 8, Epoch 10/20 => Loss 0.458, Train_accy 95.44:  45%|████▌     | 9/20 [00:31<00:34,  3.11s/it]
Task 8, Epoch 10/20 => Loss 0.458, Train_accy 95.44:  50%|█████     | 10/20 [00:31<00:30,  3.10s/it]
Task 8, Epoch 11/20 => Loss 0.428, Train_accy 94.14:  50%|█████     | 10/20 [00:34<00:30,  3.10s/it]
Task 8, Epoch 11/20 => Loss 0.428, Train_accy 94.14:  55%|█████▌    | 11/20 [00:34<00:27,  3.09s/it]
Task 8, Epoch 12/20 => Loss 0.406, Train_accy 95.01:  55%|█████▌    | 11/20 [00:37<00:27,  3.09s/it]
Task 8, Epoch 12/20 => Loss 0.406, Train_accy 95.01:  60%|██████    | 12/20 [00:37<00:24,  3.09s/it]
Task 8, Epoch 13/20 => Loss 0.409, Train_accy 93.28:  60%|██████    | 12/20 [00:40<00:24,  3.09s/it]
Task 8, Epoch 13/20 => Loss 0.409, Train_accy 93.28:  65%|██████▌   | 13/20 [00:40<00:21,  3.09s/it]
Task 8, Epoch 14/20 => Loss 0.395, Train_accy 93.93:  65%|██████▌   | 13/20 [00:43<00:21,  3.09s/it]
Task 8, Epoch 14/20 => Loss 0.395, Train_accy 93.93:  70%|███████   | 14/20 [00:43<00:18,  3.08s/it]
Task 8, Epoch 15/20 => Loss 0.365, Train_accy 94.58:  70%|███████   | 14/20 [00:46<00:18,  3.08s/it]
Task 8, Epoch 15/20 => Loss 0.365, Train_accy 94.58:  75%|███████▌  | 15/20 [00:46<00:15,  3.09s/it]
Task 8, Epoch 16/20 => Loss 0.367, Train_accy 94.14:  75%|███████▌  | 15/20 [00:49<00:15,  3.09s/it]
Task 8, Epoch 16/20 => Loss 0.367, Train_accy 94.14:  80%|████████  | 16/20 [00:49<00:12,  3.10s/it]
Task 8, Epoch 17/20 => Loss 0.350, Train_accy 93.28:  80%|████████  | 16/20 [00:52<00:12,  3.10s/it]
Task 8, Epoch 17/20 => Loss 0.350, Train_accy 93.28:  85%|████████▌ | 17/20 [00:52<00:09,  3.09s/it]
Task 8, Epoch 18/20 => Loss 0.356, Train_accy 94.14:  85%|████████▌ | 17/20 [00:55<00:09,  3.09s/it]
Task 8, Epoch 18/20 => Loss 0.356, Train_accy 94.14:  90%|█████████ | 18/20 [00:55<00:06,  3.10s/it]
Task 8, Epoch 19/20 => Loss 0.332, Train_accy 95.66:  90%|█████████ | 18/20 [00:58<00:06,  3.10s/it]
Task 8, Epoch 19/20 => Loss 0.332, Train_accy 95.66:  95%|█████████▌| 19/20 [00:58<00:03,  3.10s/it]
Task 8, Epoch 20/20 => Loss 0.311, Train_accy 95.01:  95%|█████████▌| 19/20 [01:01<00:03,  3.10s/it]
Task 8, Epoch 20/20 => Loss 0.311, Train_accy 95.01: 100%|██████████| 20/20 [01:01<00:00,  3.09s/it]
Task 8, Epoch 20/20 => Loss 0.311, Train_accy 95.01: 100%|██████████| 20/20 [01:01<00:00,  3.10s/it]
2024-09-06 04:07:33,867 [ease.py] => Task 8, Epoch 20/20 => Loss 0.311, Train_accy 95.01
2024-09-06 04:08:18,438 [ease.py] => Task correct: 92.01520912547528
2024-09-06 04:08:18,439 [ease.py] => Task acc: 99.23954372623574
2024-09-06 04:08:18,458 [trainer.py] => No NME accuracy.
2024-09-06 04:08:18,458 [trainer.py] => CNN: {'total': 91.73, '00-09': 83.05, '10-19': 86.05, '20-29': 95.88, '30-39': 93.64, '40-49': 95.33, '50-59': 87.39, '60-69': 93.4, '70-79': 96.45, '80-89': 94.74, 'old': 91.29, 'new': 94.74}
2024-09-06 04:08:18,458 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73]
2024-09-06 04:08:18,458 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14]

Average Accuracy (CNN): 95.5
2024-09-06 04:08:18,458 [trainer.py] => Average Accuracy (CNN): 95.5 

2024-09-06 04:08:18,459 [trainer.py] => All params: 86732738
2024-09-06 04:08:18,460 [trainer.py] => Trainable params: 304320
2024-09-06 04:08:18,466 [ease.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.276, Train_accy 29.14:   0%|          | 0/20 [00:03<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.276, Train_accy 29.14:   5%|▌         | 1/20 [00:03<00:57,  3.04s/it]
Task 9, Epoch 2/20 => Loss 2.140, Train_accy 77.48:   5%|▌         | 1/20 [00:06<00:57,  3.04s/it]
Task 9, Epoch 2/20 => Loss 2.140, Train_accy 77.48:  10%|█         | 2/20 [00:06<00:55,  3.08s/it]
Task 9, Epoch 3/20 => Loss 1.903, Train_accy 85.87:  10%|█         | 2/20 [00:09<00:55,  3.08s/it]
Task 9, Epoch 3/20 => Loss 1.903, Train_accy 85.87:  15%|█▌        | 3/20 [00:09<00:51,  3.06s/it]
Task 9, Epoch 4/20 => Loss 1.578, Train_accy 87.42:  15%|█▌        | 3/20 [00:12<00:51,  3.06s/it]
Task 9, Epoch 4/20 => Loss 1.578, Train_accy 87.42:  20%|██        | 4/20 [00:12<00:48,  3.04s/it]
Task 9, Epoch 5/20 => Loss 1.241, Train_accy 89.85:  20%|██        | 4/20 [00:15<00:48,  3.04s/it]
Task 9, Epoch 5/20 => Loss 1.241, Train_accy 89.85:  25%|██▌       | 5/20 [00:15<00:45,  3.05s/it]
Task 9, Epoch 6/20 => Loss 0.946, Train_accy 91.61:  25%|██▌       | 5/20 [00:18<00:45,  3.05s/it]
Task 9, Epoch 6/20 => Loss 0.946, Train_accy 91.61:  30%|███       | 6/20 [00:18<00:42,  3.05s/it]
Task 9, Epoch 7/20 => Loss 0.775, Train_accy 90.95:  30%|███       | 6/20 [00:21<00:42,  3.05s/it]
Task 9, Epoch 7/20 => Loss 0.775, Train_accy 90.95:  35%|███▌      | 7/20 [00:21<00:39,  3.04s/it]
Task 9, Epoch 8/20 => Loss 0.625, Train_accy 93.60:  35%|███▌      | 7/20 [00:24<00:39,  3.04s/it]
Task 9, Epoch 8/20 => Loss 0.625, Train_accy 93.60:  40%|████      | 8/20 [00:24<00:36,  3.03s/it]
Task 9, Epoch 9/20 => Loss 0.546, Train_accy 92.94:  40%|████      | 8/20 [00:27<00:36,  3.03s/it]
Task 9, Epoch 9/20 => Loss 0.546, Train_accy 92.94:  45%|████▌     | 9/20 [00:27<00:33,  3.03s/it]
Task 9, Epoch 10/20 => Loss 0.526, Train_accy 91.17:  45%|████▌     | 9/20 [00:30<00:33,  3.03s/it]
Task 9, Epoch 10/20 => Loss 0.526, Train_accy 91.17:  50%|█████     | 10/20 [00:30<00:30,  3.02s/it]
Task 9, Epoch 11/20 => Loss 0.444, Train_accy 92.49:  50%|█████     | 10/20 [00:33<00:30,  3.02s/it]
Task 9, Epoch 11/20 => Loss 0.444, Train_accy 92.49:  55%|█████▌    | 11/20 [00:33<00:27,  3.03s/it]
Task 9, Epoch 12/20 => Loss 0.392, Train_accy 94.04:  55%|█████▌    | 11/20 [00:36<00:27,  3.03s/it]
Task 9, Epoch 12/20 => Loss 0.392, Train_accy 94.04:  60%|██████    | 12/20 [00:36<00:24,  3.03s/it]
Task 9, Epoch 13/20 => Loss 0.397, Train_accy 92.49:  60%|██████    | 12/20 [00:39<00:24,  3.03s/it]
Task 9, Epoch 13/20 => Loss 0.397, Train_accy 92.49:  65%|██████▌   | 13/20 [00:39<00:21,  3.04s/it]
Task 9, Epoch 14/20 => Loss 0.379, Train_accy 92.49:  65%|██████▌   | 13/20 [00:42<00:21,  3.04s/it]
Task 9, Epoch 14/20 => Loss 0.379, Train_accy 92.49:  70%|███████   | 14/20 [00:42<00:18,  3.04s/it]
Task 9, Epoch 15/20 => Loss 0.377, Train_accy 92.27:  70%|███████   | 14/20 [00:45<00:18,  3.04s/it]
Task 9, Epoch 15/20 => Loss 0.377, Train_accy 92.27:  75%|███████▌  | 15/20 [00:45<00:15,  3.04s/it]
Task 9, Epoch 16/20 => Loss 0.383, Train_accy 93.60:  75%|███████▌  | 15/20 [00:48<00:15,  3.04s/it]
Task 9, Epoch 16/20 => Loss 0.383, Train_accy 93.60:  80%|████████  | 16/20 [00:48<00:12,  3.03s/it]
Task 9, Epoch 17/20 => Loss 0.373, Train_accy 94.04:  80%|████████  | 16/20 [00:51<00:12,  3.03s/it]
Task 9, Epoch 17/20 => Loss 0.373, Train_accy 94.04:  85%|████████▌ | 17/20 [00:51<00:09,  3.03s/it]
Task 9, Epoch 18/20 => Loss 0.376, Train_accy 90.95:  85%|████████▌ | 17/20 [00:54<00:09,  3.03s/it]
Task 9, Epoch 18/20 => Loss 0.376, Train_accy 90.95:  90%|█████████ | 18/20 [00:54<00:06,  3.03s/it]
Task 9, Epoch 19/20 => Loss 0.399, Train_accy 92.49:  90%|█████████ | 18/20 [00:57<00:06,  3.03s/it]
Task 9, Epoch 19/20 => Loss 0.399, Train_accy 92.49:  95%|█████████▌| 19/20 [00:57<00:03,  3.03s/it]
Task 9, Epoch 20/20 => Loss 0.360, Train_accy 92.94:  95%|█████████▌| 19/20 [01:00<00:03,  3.03s/it]
Task 9, Epoch 20/20 => Loss 0.360, Train_accy 92.94: 100%|██████████| 20/20 [01:00<00:00,  3.03s/it]
Task 9, Epoch 20/20 => Loss 0.360, Train_accy 92.94: 100%|██████████| 20/20 [01:00<00:00,  3.04s/it]
2024-09-06 04:09:19,175 [ease.py] => Task 9, Epoch 20/20 => Loss 0.360, Train_accy 92.94
2024-09-06 04:10:11,915 [ease.py] => Task correct: 91.41414141414141
2024-09-06 04:10:11,916 [ease.py] => Task acc: 98.98989898989899
2024-09-06 04:10:11,937 [trainer.py] => No NME accuracy.
2024-09-06 04:10:11,938 [trainer.py] => CNN: {'total': 90.82, '00-09': 83.05, '10-19': 86.05, '20-29': 95.88, '30-39': 86.36, '40-49': 95.33, '50-59': 88.29, '60-69': 90.57, '70-79': 95.74, '80-89': 94.74, '90-99': 91.91, 'old': 90.68, 'new': 91.91}
2024-09-06 04:10:11,938 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82]
2024-09-06 04:10:11,938 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99]

Average Accuracy (CNN): 95.03
2024-09-06 04:10:11,938 [trainer.py] => Average Accuracy (CNN): 95.03 

2024-09-06 04:10:11,939 [trainer.py] => All params: 86878658
2024-09-06 04:10:11,939 [trainer.py] => Trainable params: 304320
2024-09-06 04:10:11,947 [ease.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.275, Train_accy 30.98:   0%|          | 0/20 [00:03<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.275, Train_accy 30.98:   5%|▌         | 1/20 [00:03<01:01,  3.22s/it]
Task 10, Epoch 2/20 => Loss 2.113, Train_accy 87.73:   5%|▌         | 1/20 [00:06<01:01,  3.22s/it]
Task 10, Epoch 2/20 => Loss 2.113, Train_accy 87.73:  10%|█         | 2/20 [00:06<00:57,  3.21s/it]
Task 10, Epoch 3/20 => Loss 1.858, Train_accy 90.64:  10%|█         | 2/20 [00:09<00:57,  3.21s/it]
Task 10, Epoch 3/20 => Loss 1.858, Train_accy 90.64:  15%|█▌        | 3/20 [00:09<00:54,  3.21s/it]
Task 10, Epoch 4/20 => Loss 1.470, Train_accy 93.56:  15%|█▌        | 3/20 [00:12<00:54,  3.21s/it]
Task 10, Epoch 4/20 => Loss 1.470, Train_accy 93.56:  20%|██        | 4/20 [00:12<00:51,  3.20s/it]
Task 10, Epoch 5/20 => Loss 1.159, Train_accy 94.18:  20%|██        | 4/20 [00:16<00:51,  3.20s/it]
Task 10, Epoch 5/20 => Loss 1.159, Train_accy 94.18:  25%|██▌       | 5/20 [00:16<00:48,  3.20s/it]
Task 10, Epoch 6/20 => Loss 0.838, Train_accy 94.59:  25%|██▌       | 5/20 [00:19<00:48,  3.20s/it]
Task 10, Epoch 6/20 => Loss 0.838, Train_accy 94.59:  30%|███       | 6/20 [00:19<00:44,  3.20s/it]
Task 10, Epoch 7/20 => Loss 0.641, Train_accy 94.59:  30%|███       | 6/20 [00:22<00:44,  3.20s/it]
Task 10, Epoch 7/20 => Loss 0.641, Train_accy 94.59:  35%|███▌      | 7/20 [00:22<00:41,  3.20s/it]
Task 10, Epoch 8/20 => Loss 0.515, Train_accy 96.26:  35%|███▌      | 7/20 [00:25<00:41,  3.20s/it]
Task 10, Epoch 8/20 => Loss 0.515, Train_accy 96.26:  40%|████      | 8/20 [00:25<00:38,  3.20s/it]
Task 10, Epoch 9/20 => Loss 0.391, Train_accy 97.30:  40%|████      | 8/20 [00:28<00:38,  3.20s/it]
Task 10, Epoch 9/20 => Loss 0.391, Train_accy 97.30:  45%|████▌     | 9/20 [00:28<00:35,  3.20s/it]
Task 10, Epoch 10/20 => Loss 0.385, Train_accy 95.43:  45%|████▌     | 9/20 [00:32<00:35,  3.20s/it]
Task 10, Epoch 10/20 => Loss 0.385, Train_accy 95.43:  50%|█████     | 10/20 [00:32<00:31,  3.20s/it]
Task 10, Epoch 11/20 => Loss 0.365, Train_accy 95.84:  50%|█████     | 10/20 [00:35<00:31,  3.20s/it]
Task 10, Epoch 11/20 => Loss 0.365, Train_accy 95.84:  55%|█████▌    | 11/20 [00:35<00:28,  3.20s/it]
Task 10, Epoch 12/20 => Loss 0.318, Train_accy 96.47:  55%|█████▌    | 11/20 [00:38<00:28,  3.20s/it]
Task 10, Epoch 12/20 => Loss 0.318, Train_accy 96.47:  60%|██████    | 12/20 [00:38<00:25,  3.20s/it]
Task 10, Epoch 13/20 => Loss 0.467, Train_accy 96.47:  60%|██████    | 12/20 [00:41<00:25,  3.20s/it]
Task 10, Epoch 13/20 => Loss 0.467, Train_accy 96.47:  65%|██████▌   | 13/20 [00:41<00:22,  3.21s/it]
Task 10, Epoch 14/20 => Loss 0.310, Train_accy 94.80:  65%|██████▌   | 13/20 [00:44<00:22,  3.21s/it]
Task 10, Epoch 14/20 => Loss 0.310, Train_accy 94.80:  70%|███████   | 14/20 [00:44<00:19,  3.20s/it]
Task 10, Epoch 15/20 => Loss 0.252, Train_accy 96.88:  70%|███████   | 14/20 [00:48<00:19,  3.20s/it]
Task 10, Epoch 15/20 => Loss 0.252, Train_accy 96.88:  75%|███████▌  | 15/20 [00:48<00:16,  3.20s/it]
Task 10, Epoch 16/20 => Loss 0.256, Train_accy 95.84:  75%|███████▌  | 15/20 [00:51<00:16,  3.20s/it]
Task 10, Epoch 16/20 => Loss 0.256, Train_accy 95.84:  80%|████████  | 16/20 [00:51<00:12,  3.21s/it]
Task 10, Epoch 17/20 => Loss 0.296, Train_accy 94.59:  80%|████████  | 16/20 [00:54<00:12,  3.21s/it]
Task 10, Epoch 17/20 => Loss 0.296, Train_accy 94.59:  85%|████████▌ | 17/20 [00:54<00:09,  3.20s/it]
Task 10, Epoch 18/20 => Loss 0.227, Train_accy 97.09:  85%|████████▌ | 17/20 [00:57<00:09,  3.20s/it]
Task 10, Epoch 18/20 => Loss 0.227, Train_accy 97.09:  90%|█████████ | 18/20 [00:57<00:06,  3.20s/it]
Task 10, Epoch 19/20 => Loss 0.301, Train_accy 95.01:  90%|█████████ | 18/20 [01:00<00:06,  3.20s/it]
Task 10, Epoch 19/20 => Loss 0.301, Train_accy 95.01:  95%|█████████▌| 19/20 [01:00<00:03,  3.22s/it]
Task 10, Epoch 20/20 => Loss 0.263, Train_accy 95.22:  95%|█████████▌| 19/20 [01:04<00:03,  3.22s/it]
Task 10, Epoch 20/20 => Loss 0.263, Train_accy 95.22: 100%|██████████| 20/20 [01:04<00:00,  3.22s/it]
Task 10, Epoch 20/20 => Loss 0.263, Train_accy 95.22: 100%|██████████| 20/20 [01:04<00:00,  3.21s/it]
2024-09-06 04:11:16,079 [ease.py] => Task 10, Epoch 20/20 => Loss 0.263, Train_accy 95.22
2024-09-06 04:12:18,661 [ease.py] => Task correct: 91.32770529547199
2024-09-06 04:12:18,662 [ease.py] => Task acc: 99.0023023791251
2024-09-06 04:12:18,690 [trainer.py] => No NME accuracy.
2024-09-06 04:12:18,690 [trainer.py] => CNN: {'total': 90.87, '00-09': 83.05, '10-19': 83.72, '20-29': 95.88, '30-39': 86.36, '40-49': 95.33, '50-59': 88.29, '60-69': 89.62, '70-79': 95.74, '80-89': 94.74, '90-99': 91.91, '100-109': 94.78, 'old': 90.49, 'new': 94.78}
2024-09-06 04:12:18,691 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87]
2024-09-06 04:12:18,691 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93]

Average Accuracy (CNN): 94.66
2024-09-06 04:12:18,691 [trainer.py] => Average Accuracy (CNN): 94.66 

2024-09-06 04:12:18,692 [trainer.py] => All params: 87039938
2024-09-06 04:12:18,692 [trainer.py] => Trainable params: 304320
2024-09-06 04:12:18,703 [ease.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.278, Train_accy 23.35:   0%|          | 0/20 [00:03<?, ?it/s]
Task 11, Epoch 1/20 => Loss 2.278, Train_accy 23.35:   5%|▌         | 1/20 [00:03<00:59,  3.11s/it]
Task 11, Epoch 2/20 => Loss 2.146, Train_accy 82.80:   5%|▌         | 1/20 [00:06<00:59,  3.11s/it]
Task 11, Epoch 2/20 => Loss 2.146, Train_accy 82.80:  10%|█         | 2/20 [00:06<00:56,  3.12s/it]
Task 11, Epoch 3/20 => Loss 1.926, Train_accy 93.84:  10%|█         | 2/20 [00:09<00:56,  3.12s/it]
Task 11, Epoch 3/20 => Loss 1.926, Train_accy 93.84:  15%|█▌        | 3/20 [00:09<00:53,  3.13s/it]
Task 11, Epoch 4/20 => Loss 1.606, Train_accy 96.39:  15%|█▌        | 3/20 [00:12<00:53,  3.13s/it]
Task 11, Epoch 4/20 => Loss 1.606, Train_accy 96.39:  20%|██        | 4/20 [00:12<00:50,  3.14s/it]
Task 11, Epoch 5/20 => Loss 1.262, Train_accy 95.75:  20%|██        | 4/20 [00:15<00:50,  3.14s/it]
Task 11, Epoch 5/20 => Loss 1.262, Train_accy 95.75:  25%|██▌       | 5/20 [00:15<00:47,  3.15s/it]
Task 11, Epoch 6/20 => Loss 0.952, Train_accy 95.97:  25%|██▌       | 5/20 [00:18<00:47,  3.15s/it]
Task 11, Epoch 6/20 => Loss 0.952, Train_accy 95.97:  30%|███       | 6/20 [00:18<00:44,  3.17s/it]
Task 11, Epoch 7/20 => Loss 0.740, Train_accy 97.45:  30%|███       | 6/20 [00:22<00:44,  3.17s/it]
Task 11, Epoch 7/20 => Loss 0.740, Train_accy 97.45:  35%|███▌      | 7/20 [00:22<00:40,  3.15s/it]
Task 11, Epoch 8/20 => Loss 0.602, Train_accy 96.18:  35%|███▌      | 7/20 [00:25<00:40,  3.15s/it]
Task 11, Epoch 8/20 => Loss 0.602, Train_accy 96.18:  40%|████      | 8/20 [00:25<00:37,  3.14s/it]
Task 11, Epoch 9/20 => Loss 0.539, Train_accy 96.18:  40%|████      | 8/20 [00:28<00:37,  3.14s/it]
Task 11, Epoch 9/20 => Loss 0.539, Train_accy 96.18:  45%|████▌     | 9/20 [00:28<00:34,  3.14s/it]
Task 11, Epoch 10/20 => Loss 0.469, Train_accy 96.18:  45%|████▌     | 9/20 [00:31<00:34,  3.14s/it]
Task 11, Epoch 10/20 => Loss 0.469, Train_accy 96.18:  50%|█████     | 10/20 [00:31<00:31,  3.13s/it]
Task 11, Epoch 11/20 => Loss 0.428, Train_accy 96.18:  50%|█████     | 10/20 [00:34<00:31,  3.13s/it]
Task 11, Epoch 11/20 => Loss 0.428, Train_accy 96.18:  55%|█████▌    | 11/20 [00:34<00:28,  3.13s/it]
Task 11, Epoch 12/20 => Loss 0.386, Train_accy 97.24:  55%|█████▌    | 11/20 [00:37<00:28,  3.13s/it]
Task 11, Epoch 12/20 => Loss 0.386, Train_accy 97.24:  60%|██████    | 12/20 [00:37<00:25,  3.13s/it]
Task 11, Epoch 13/20 => Loss 0.367, Train_accy 96.82:  60%|██████    | 12/20 [00:40<00:25,  3.13s/it]
Task 11, Epoch 13/20 => Loss 0.367, Train_accy 96.82:  65%|██████▌   | 13/20 [00:40<00:21,  3.13s/it]
Task 11, Epoch 14/20 => Loss 0.358, Train_accy 96.60:  65%|██████▌   | 13/20 [00:43<00:21,  3.13s/it]
Task 11, Epoch 14/20 => Loss 0.358, Train_accy 96.60:  70%|███████   | 14/20 [00:43<00:18,  3.13s/it]
Task 11, Epoch 15/20 => Loss 0.338, Train_accy 96.82:  70%|███████   | 14/20 [00:46<00:18,  3.13s/it]
Task 11, Epoch 15/20 => Loss 0.338, Train_accy 96.82:  75%|███████▌  | 15/20 [00:46<00:15,  3.12s/it]
Task 11, Epoch 16/20 => Loss 0.303, Train_accy 97.66:  75%|███████▌  | 15/20 [00:50<00:15,  3.12s/it]
Task 11, Epoch 16/20 => Loss 0.303, Train_accy 97.66:  80%|████████  | 16/20 [00:50<00:12,  3.12s/it]
Task 11, Epoch 17/20 => Loss 0.327, Train_accy 96.60:  80%|████████  | 16/20 [00:53<00:12,  3.12s/it]
Task 11, Epoch 17/20 => Loss 0.327, Train_accy 96.60:  85%|████████▌ | 17/20 [00:53<00:09,  3.12s/it]
Task 11, Epoch 18/20 => Loss 0.307, Train_accy 97.24:  85%|████████▌ | 17/20 [00:56<00:09,  3.12s/it]
Task 11, Epoch 18/20 => Loss 0.307, Train_accy 97.24:  90%|█████████ | 18/20 [00:56<00:06,  3.15s/it]
Task 11, Epoch 19/20 => Loss 0.298, Train_accy 96.39:  90%|█████████ | 18/20 [00:59<00:06,  3.15s/it]
Task 11, Epoch 19/20 => Loss 0.298, Train_accy 96.39:  95%|█████████▌| 19/20 [00:59<00:03,  3.14s/it]
Task 11, Epoch 20/20 => Loss 0.348, Train_accy 96.18:  95%|█████████▌| 19/20 [01:02<00:03,  3.14s/it]
Task 11, Epoch 20/20 => Loss 0.348, Train_accy 96.18: 100%|██████████| 20/20 [01:02<00:00,  3.15s/it]
Task 11, Epoch 20/20 => Loss 0.348, Train_accy 96.18: 100%|██████████| 20/20 [01:02<00:00,  3.14s/it]
2024-09-06 04:13:21,460 [ease.py] => Task 11, Epoch 20/20 => Loss 0.348, Train_accy 96.18
2024-09-06 04:14:33,202 [ease.py] => Task correct: 89.3361581920904
2024-09-06 04:14:33,203 [ease.py] => Task acc: 98.94067796610169
2024-09-06 04:14:33,224 [trainer.py] => No NME accuracy.
2024-09-06 04:14:33,225 [trainer.py] => CNN: {'total': 88.98, '00-09': 83.05, '10-19': 85.27, '20-29': 95.88, '30-39': 87.27, '40-49': 95.33, '50-59': 82.88, '60-69': 87.74, '70-79': 88.65, '80-89': 93.23, '90-99': 89.71, '100-109': 94.78, '110-119': 84.96, 'old': 89.33, 'new': 84.96}
2024-09-06 04:14:33,225 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98]
2024-09-06 04:14:33,225 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73]

Average Accuracy (CNN): 94.18
2024-09-06 04:14:33,225 [trainer.py] => Average Accuracy (CNN): 94.18 

2024-09-06 04:14:33,226 [trainer.py] => All params: 87216578
2024-09-06 04:14:33,226 [trainer.py] => Trainable params: 304320
2024-09-06 04:14:33,237 [ease.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.278, Train_accy 26.76:   0%|          | 0/20 [00:03<?, ?it/s]
Task 12, Epoch 1/20 => Loss 2.278, Train_accy 26.76:   5%|▌         | 1/20 [00:03<01:00,  3.18s/it]
Task 12, Epoch 2/20 => Loss 2.140, Train_accy 79.25:   5%|▌         | 1/20 [00:06<01:00,  3.18s/it]
Task 12, Epoch 2/20 => Loss 2.140, Train_accy 79.25:  10%|█         | 2/20 [00:06<00:57,  3.18s/it]
Task 12, Epoch 3/20 => Loss 1.919, Train_accy 85.27:  10%|█         | 2/20 [00:09<00:57,  3.18s/it]
Task 12, Epoch 3/20 => Loss 1.919, Train_accy 85.27:  15%|█▌        | 3/20 [00:09<00:54,  3.19s/it]
Task 12, Epoch 4/20 => Loss 1.565, Train_accy 88.59:  15%|█▌        | 3/20 [00:12<00:54,  3.19s/it]
Task 12, Epoch 4/20 => Loss 1.565, Train_accy 88.59:  20%|██        | 4/20 [00:12<00:51,  3.19s/it]
Task 12, Epoch 5/20 => Loss 1.234, Train_accy 91.08:  20%|██        | 4/20 [00:15<00:51,  3.19s/it]
Task 12, Epoch 5/20 => Loss 1.234, Train_accy 91.08:  25%|██▌       | 5/20 [00:15<00:47,  3.19s/it]
Task 12, Epoch 6/20 => Loss 0.975, Train_accy 89.42:  25%|██▌       | 5/20 [00:19<00:47,  3.19s/it]
Task 12, Epoch 6/20 => Loss 0.975, Train_accy 89.42:  30%|███       | 6/20 [00:19<00:44,  3.20s/it]
Task 12, Epoch 7/20 => Loss 0.798, Train_accy 88.59:  30%|███       | 6/20 [00:22<00:44,  3.20s/it]
Task 12, Epoch 7/20 => Loss 0.798, Train_accy 88.59:  35%|███▌      | 7/20 [00:22<00:41,  3.20s/it]
Task 12, Epoch 8/20 => Loss 0.650, Train_accy 89.83:  35%|███▌      | 7/20 [00:25<00:41,  3.20s/it]
Task 12, Epoch 8/20 => Loss 0.650, Train_accy 89.83:  40%|████      | 8/20 [00:25<00:38,  3.20s/it]
Task 12, Epoch 9/20 => Loss 0.635, Train_accy 88.38:  40%|████      | 8/20 [00:28<00:38,  3.20s/it]
Task 12, Epoch 9/20 => Loss 0.635, Train_accy 88.38:  45%|████▌     | 9/20 [00:28<00:35,  3.21s/it]
Task 12, Epoch 10/20 => Loss 0.520, Train_accy 87.76:  45%|████▌     | 9/20 [00:32<00:35,  3.21s/it]
Task 12, Epoch 10/20 => Loss 0.520, Train_accy 87.76:  50%|█████     | 10/20 [00:32<00:32,  3.22s/it]
Task 12, Epoch 11/20 => Loss 0.619, Train_accy 90.87:  50%|█████     | 10/20 [00:35<00:32,  3.22s/it]
Task 12, Epoch 11/20 => Loss 0.619, Train_accy 90.87:  55%|█████▌    | 11/20 [00:35<00:28,  3.22s/it]
Task 12, Epoch 12/20 => Loss 0.457, Train_accy 90.87:  55%|█████▌    | 11/20 [00:38<00:28,  3.22s/it]
Task 12, Epoch 12/20 => Loss 0.457, Train_accy 90.87:  60%|██████    | 12/20 [00:38<00:25,  3.21s/it]
Task 12, Epoch 13/20 => Loss 0.409, Train_accy 93.57:  60%|██████    | 12/20 [00:41<00:25,  3.21s/it]
Task 12, Epoch 13/20 => Loss 0.409, Train_accy 93.57:  65%|██████▌   | 13/20 [00:41<00:22,  3.21s/it]
Task 12, Epoch 14/20 => Loss 0.445, Train_accy 91.29:  65%|██████▌   | 13/20 [00:44<00:22,  3.21s/it]
Task 12, Epoch 14/20 => Loss 0.445, Train_accy 91.29:  70%|███████   | 14/20 [00:44<00:19,  3.21s/it]
Task 12, Epoch 15/20 => Loss 0.401, Train_accy 91.70:  70%|███████   | 14/20 [00:48<00:19,  3.21s/it]
Task 12, Epoch 15/20 => Loss 0.401, Train_accy 91.70:  75%|███████▌  | 15/20 [00:48<00:16,  3.21s/it]
Task 12, Epoch 16/20 => Loss 0.432, Train_accy 92.32:  75%|███████▌  | 15/20 [00:51<00:16,  3.21s/it]
Task 12, Epoch 16/20 => Loss 0.432, Train_accy 92.32:  80%|████████  | 16/20 [00:51<00:12,  3.21s/it]
Task 12, Epoch 17/20 => Loss 0.361, Train_accy 92.74:  80%|████████  | 16/20 [00:54<00:12,  3.21s/it]
Task 12, Epoch 17/20 => Loss 0.361, Train_accy 92.74:  85%|████████▌ | 17/20 [00:54<00:09,  3.21s/it]
Task 12, Epoch 18/20 => Loss 0.509, Train_accy 92.53:  85%|████████▌ | 17/20 [00:57<00:09,  3.21s/it]
Task 12, Epoch 18/20 => Loss 0.509, Train_accy 92.53:  90%|█████████ | 18/20 [00:57<00:06,  3.21s/it]
Task 12, Epoch 19/20 => Loss 0.390, Train_accy 92.53:  90%|█████████ | 18/20 [01:00<00:06,  3.21s/it]
Task 12, Epoch 19/20 => Loss 0.390, Train_accy 92.53:  95%|█████████▌| 19/20 [01:00<00:03,  3.20s/it]
Task 12, Epoch 20/20 => Loss 0.384, Train_accy 92.74:  95%|█████████▌| 19/20 [01:04<00:03,  3.20s/it]
Task 12, Epoch 20/20 => Loss 0.384, Train_accy 92.74: 100%|██████████| 20/20 [01:04<00:00,  3.20s/it]
Task 12, Epoch 20/20 => Loss 0.384, Train_accy 92.74: 100%|██████████| 20/20 [01:04<00:00,  3.20s/it]
2024-09-06 04:15:37,315 [ease.py] => Task 12, Epoch 20/20 => Loss 0.384, Train_accy 92.74
2024-09-06 04:16:59,587 [ease.py] => Task correct: 88.83782009192383
2024-09-06 04:16:59,587 [ease.py] => Task acc: 98.68680236375575
2024-09-06 04:16:59,610 [trainer.py] => No NME accuracy.
2024-09-06 04:16:59,610 [trainer.py] => CNN: {'total': 88.38, '00-09': 80.51, '10-19': 84.5, '20-29': 95.88, '30-39': 87.27, '40-49': 92.52, '50-59': 82.88, '60-69': 87.74, '70-79': 88.65, '80-89': 93.23, '90-99': 88.24, '100-109': 94.78, '110-119': 84.96, '120-129': 88.79, 'old': 88.35, 'new': 88.79}
2024-09-06 04:16:59,610 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38]
2024-09-06 04:16:59,610 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75]

Average Accuracy (CNN): 93.74
2024-09-06 04:16:59,610 [trainer.py] => Average Accuracy (CNN): 93.74 

2024-09-06 04:16:59,611 [trainer.py] => All params: 87408578
2024-09-06 04:16:59,611 [trainer.py] => Trainable params: 304320
2024-09-06 04:16:59,625 [ease.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.283, Train_accy 23.94:   0%|          | 0/20 [00:03<?, ?it/s]
Task 13, Epoch 1/20 => Loss 2.283, Train_accy 23.94:   5%|▌         | 1/20 [00:03<00:59,  3.15s/it]
Task 13, Epoch 2/20 => Loss 2.164, Train_accy 80.51:   5%|▌         | 1/20 [00:06<00:59,  3.15s/it]
Task 13, Epoch 2/20 => Loss 2.164, Train_accy 80.51:  10%|█         | 2/20 [00:06<00:56,  3.13s/it]
Task 13, Epoch 3/20 => Loss 1.967, Train_accy 89.19:  10%|█         | 2/20 [00:09<00:56,  3.13s/it]
Task 13, Epoch 3/20 => Loss 1.967, Train_accy 89.19:  15%|█▌        | 3/20 [00:09<00:53,  3.13s/it]
Task 13, Epoch 4/20 => Loss 1.702, Train_accy 87.71:  15%|█▌        | 3/20 [00:12<00:53,  3.13s/it]
Task 13, Epoch 4/20 => Loss 1.702, Train_accy 87.71:  20%|██        | 4/20 [00:12<00:50,  3.13s/it]
Task 13, Epoch 5/20 => Loss 1.398, Train_accy 89.83:  20%|██        | 4/20 [00:15<00:50,  3.13s/it]
Task 13, Epoch 5/20 => Loss 1.398, Train_accy 89.83:  25%|██▌       | 5/20 [00:15<00:46,  3.13s/it]
Task 13, Epoch 6/20 => Loss 1.143, Train_accy 92.80:  25%|██▌       | 5/20 [00:18<00:46,  3.13s/it]
Task 13, Epoch 6/20 => Loss 1.143, Train_accy 92.80:  30%|███       | 6/20 [00:18<00:43,  3.13s/it]
Task 13, Epoch 7/20 => Loss 0.949, Train_accy 93.22:  30%|███       | 6/20 [00:21<00:43,  3.13s/it]
Task 13, Epoch 7/20 => Loss 0.949, Train_accy 93.22:  35%|███▌      | 7/20 [00:21<00:40,  3.14s/it]
Task 13, Epoch 8/20 => Loss 0.823, Train_accy 93.86:  35%|███▌      | 7/20 [00:25<00:40,  3.14s/it]
Task 13, Epoch 8/20 => Loss 0.823, Train_accy 93.86:  40%|████      | 8/20 [00:25<00:37,  3.14s/it]
Task 13, Epoch 9/20 => Loss 0.744, Train_accy 92.16:  40%|████      | 8/20 [00:28<00:37,  3.14s/it]
Task 13, Epoch 9/20 => Loss 0.744, Train_accy 92.16:  45%|████▌     | 9/20 [00:28<00:34,  3.13s/it]
Task 13, Epoch 10/20 => Loss 0.654, Train_accy 92.58:  45%|████▌     | 9/20 [00:31<00:34,  3.13s/it]
Task 13, Epoch 10/20 => Loss 0.654, Train_accy 92.58:  50%|█████     | 10/20 [00:31<00:31,  3.13s/it]
Task 13, Epoch 11/20 => Loss 0.626, Train_accy 91.74:  50%|█████     | 10/20 [00:34<00:31,  3.13s/it]
Task 13, Epoch 11/20 => Loss 0.626, Train_accy 91.74:  55%|█████▌    | 11/20 [00:34<00:28,  3.13s/it]
Task 13, Epoch 12/20 => Loss 0.538, Train_accy 94.49:  55%|█████▌    | 11/20 [00:37<00:28,  3.13s/it]
Task 13, Epoch 12/20 => Loss 0.538, Train_accy 94.49:  60%|██████    | 12/20 [00:37<00:25,  3.13s/it]
Task 13, Epoch 13/20 => Loss 0.515, Train_accy 94.49:  60%|██████    | 12/20 [00:40<00:25,  3.13s/it]
Task 13, Epoch 13/20 => Loss 0.515, Train_accy 94.49:  65%|██████▌   | 13/20 [00:40<00:21,  3.12s/it]
Task 13, Epoch 14/20 => Loss 0.514, Train_accy 93.43:  65%|██████▌   | 13/20 [00:43<00:21,  3.12s/it]
Task 13, Epoch 14/20 => Loss 0.514, Train_accy 93.43:  70%|███████   | 14/20 [00:43<00:18,  3.13s/it]
Task 13, Epoch 15/20 => Loss 0.490, Train_accy 94.28:  70%|███████   | 14/20 [00:46<00:18,  3.13s/it]
Task 13, Epoch 15/20 => Loss 0.490, Train_accy 94.28:  75%|███████▌  | 15/20 [00:46<00:15,  3.13s/it]
Task 13, Epoch 16/20 => Loss 0.509, Train_accy 92.80:  75%|███████▌  | 15/20 [00:50<00:15,  3.13s/it]
Task 13, Epoch 16/20 => Loss 0.509, Train_accy 92.80:  80%|████████  | 16/20 [00:50<00:12,  3.13s/it]
Task 13, Epoch 17/20 => Loss 0.438, Train_accy 94.92:  80%|████████  | 16/20 [00:53<00:12,  3.13s/it]
Task 13, Epoch 17/20 => Loss 0.438, Train_accy 94.92:  85%|████████▌ | 17/20 [00:53<00:09,  3.13s/it]
Task 13, Epoch 18/20 => Loss 0.477, Train_accy 93.64:  85%|████████▌ | 17/20 [00:56<00:09,  3.13s/it]
Task 13, Epoch 18/20 => Loss 0.477, Train_accy 93.64:  90%|█████████ | 18/20 [00:56<00:06,  3.13s/it]
Task 13, Epoch 19/20 => Loss 0.478, Train_accy 93.43:  90%|█████████ | 18/20 [00:59<00:06,  3.13s/it]
Task 13, Epoch 19/20 => Loss 0.478, Train_accy 93.43:  95%|█████████▌| 19/20 [00:59<00:03,  3.13s/it]
Task 13, Epoch 20/20 => Loss 0.500, Train_accy 92.58:  95%|█████████▌| 19/20 [01:02<00:03,  3.13s/it]
Task 13, Epoch 20/20 => Loss 0.500, Train_accy 92.58: 100%|██████████| 20/20 [01:02<00:00,  3.12s/it]
Task 13, Epoch 20/20 => Loss 0.500, Train_accy 92.58: 100%|██████████| 20/20 [01:02<00:00,  3.13s/it]
2024-09-06 04:18:02,236 [ease.py] => Task 13, Epoch 20/20 => Loss 0.500, Train_accy 92.58
2024-09-06 04:19:35,482 [ease.py] => Task correct: 88.36075563680683
2024-09-06 04:19:35,483 [ease.py] => Task acc: 98.53747714808044
2024-09-06 04:19:35,509 [trainer.py] => No NME accuracy.
2024-09-06 04:19:35,509 [trainer.py] => CNN: {'total': 87.87, '00-09': 80.51, '10-19': 85.27, '20-29': 95.88, '30-39': 87.27, '40-49': 92.52, '50-59': 82.88, '60-69': 87.74, '70-79': 88.65, '80-89': 93.23, '90-99': 88.24, '100-109': 93.91, '110-119': 84.96, '120-129': 82.24, '130-139': 87.29, 'old': 87.92, 'new': 87.29}
2024-09-06 04:19:35,509 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38, 87.87]
2024-09-06 04:19:35,510 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75, 98.6]

Average Accuracy (CNN): 93.32
2024-09-06 04:19:35,510 [trainer.py] => Average Accuracy (CNN): 93.32 

2024-09-06 04:19:35,511 [trainer.py] => All params: 87615938
2024-09-06 04:19:35,511 [trainer.py] => Trainable params: 304320
2024-09-06 04:19:35,527 [ease.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.280, Train_accy 21.46:   0%|          | 0/20 [00:03<?, ?it/s]
Task 14, Epoch 1/20 => Loss 2.280, Train_accy 21.46:   5%|▌         | 1/20 [00:03<00:57,  3.04s/it]
Task 14, Epoch 2/20 => Loss 2.156, Train_accy 82.96:   5%|▌         | 1/20 [00:06<00:57,  3.04s/it]
Task 14, Epoch 2/20 => Loss 2.156, Train_accy 82.96:  10%|█         | 2/20 [00:06<00:54,  3.02s/it]
Task 14, Epoch 3/20 => Loss 1.965, Train_accy 90.49:  10%|█         | 2/20 [00:09<00:54,  3.02s/it]
Task 14, Epoch 3/20 => Loss 1.965, Train_accy 90.49:  15%|█▌        | 3/20 [00:09<00:51,  3.05s/it]
Task 14, Epoch 4/20 => Loss 1.678, Train_accy 93.58:  15%|█▌        | 3/20 [00:12<00:51,  3.05s/it]
Task 14, Epoch 4/20 => Loss 1.678, Train_accy 93.58:  20%|██        | 4/20 [00:12<00:48,  3.03s/it]
Task 14, Epoch 5/20 => Loss 1.384, Train_accy 94.25:  20%|██        | 4/20 [00:15<00:48,  3.03s/it]
Task 14, Epoch 5/20 => Loss 1.384, Train_accy 94.25:  25%|██▌       | 5/20 [00:15<00:45,  3.03s/it]
Task 14, Epoch 6/20 => Loss 1.069, Train_accy 94.47:  25%|██▌       | 5/20 [00:18<00:45,  3.03s/it]
Task 14, Epoch 6/20 => Loss 1.069, Train_accy 94.47:  30%|███       | 6/20 [00:18<00:42,  3.02s/it]
Task 14, Epoch 7/20 => Loss 0.865, Train_accy 95.80:  30%|███       | 6/20 [00:21<00:42,  3.02s/it]
Task 14, Epoch 7/20 => Loss 0.865, Train_accy 95.80:  35%|███▌      | 7/20 [00:21<00:39,  3.02s/it]
Task 14, Epoch 8/20 => Loss 0.733, Train_accy 94.25:  35%|███▌      | 7/20 [00:24<00:39,  3.02s/it]
Task 14, Epoch 8/20 => Loss 0.733, Train_accy 94.25:  40%|████      | 8/20 [00:24<00:36,  3.01s/it]
Task 14, Epoch 9/20 => Loss 0.605, Train_accy 96.02:  40%|████      | 8/20 [00:27<00:36,  3.01s/it]
Task 14, Epoch 9/20 => Loss 0.605, Train_accy 96.02:  45%|████▌     | 9/20 [00:27<00:33,  3.01s/it]
Task 14, Epoch 10/20 => Loss 0.560, Train_accy 96.02:  45%|████▌     | 9/20 [00:30<00:33,  3.01s/it]
Task 14, Epoch 10/20 => Loss 0.560, Train_accy 96.02:  50%|█████     | 10/20 [00:30<00:30,  3.01s/it]
Task 14, Epoch 11/20 => Loss 0.514, Train_accy 95.13:  50%|█████     | 10/20 [00:33<00:30,  3.01s/it]
Task 14, Epoch 11/20 => Loss 0.514, Train_accy 95.13:  55%|█████▌    | 11/20 [00:33<00:27,  3.01s/it]
Task 14, Epoch 12/20 => Loss 0.472, Train_accy 96.68:  55%|█████▌    | 11/20 [00:36<00:27,  3.01s/it]
Task 14, Epoch 12/20 => Loss 0.472, Train_accy 96.68:  60%|██████    | 12/20 [00:36<00:24,  3.02s/it]
Task 14, Epoch 13/20 => Loss 0.483, Train_accy 94.91:  60%|██████    | 12/20 [00:39<00:24,  3.02s/it]
Task 14, Epoch 13/20 => Loss 0.483, Train_accy 94.91:  65%|██████▌   | 13/20 [00:39<00:21,  3.02s/it]
Task 14, Epoch 14/20 => Loss 0.420, Train_accy 97.12:  65%|██████▌   | 13/20 [00:42<00:21,  3.02s/it]
Task 14, Epoch 14/20 => Loss 0.420, Train_accy 97.12:  70%|███████   | 14/20 [00:42<00:18,  3.02s/it]
Task 14, Epoch 15/20 => Loss 0.413, Train_accy 96.24:  70%|███████   | 14/20 [00:45<00:18,  3.02s/it]
Task 14, Epoch 15/20 => Loss 0.413, Train_accy 96.24:  75%|███████▌  | 15/20 [00:45<00:15,  3.02s/it]
Task 14, Epoch 16/20 => Loss 0.388, Train_accy 96.46:  75%|███████▌  | 15/20 [00:48<00:15,  3.02s/it]
Task 14, Epoch 16/20 => Loss 0.388, Train_accy 96.46:  80%|████████  | 16/20 [00:48<00:12,  3.04s/it]
Task 14, Epoch 17/20 => Loss 0.412, Train_accy 95.58:  80%|████████  | 16/20 [00:51<00:12,  3.04s/it]
Task 14, Epoch 17/20 => Loss 0.412, Train_accy 95.58:  85%|████████▌ | 17/20 [00:51<00:09,  3.03s/it]
Task 14, Epoch 18/20 => Loss 0.406, Train_accy 94.47:  85%|████████▌ | 17/20 [00:54<00:09,  3.03s/it]
Task 14, Epoch 18/20 => Loss 0.406, Train_accy 94.47:  90%|█████████ | 18/20 [00:54<00:06,  3.03s/it]
Task 14, Epoch 19/20 => Loss 0.367, Train_accy 96.68:  90%|█████████ | 18/20 [00:57<00:06,  3.03s/it]
Task 14, Epoch 19/20 => Loss 0.367, Train_accy 96.68:  95%|█████████▌| 19/20 [00:57<00:03,  3.03s/it]
Task 14, Epoch 20/20 => Loss 0.396, Train_accy 95.13:  95%|█████████▌| 19/20 [01:00<00:03,  3.03s/it]
Task 14, Epoch 20/20 => Loss 0.396, Train_accy 95.13: 100%|██████████| 20/20 [01:00<00:00,  3.02s/it]
Task 14, Epoch 20/20 => Loss 0.396, Train_accy 95.13: 100%|██████████| 20/20 [01:00<00:00,  3.02s/it]
2024-09-06 04:20:35,985 [ease.py] => Task 14, Epoch 20/20 => Loss 0.396, Train_accy 95.13
2024-09-06 04:22:20,733 [ease.py] => Task correct: 87.20996038483305
2024-09-06 04:22:20,734 [ease.py] => Task acc: 98.5851726089417
2024-09-06 04:22:20,758 [trainer.py] => No NME accuracy.
2024-09-06 04:22:20,758 [trainer.py] => CNN: {'total': 86.76, '00-09': 77.12, '10-19': 86.82, '20-29': 94.85, '30-39': 83.64, '40-49': 88.79, '50-59': 81.08, '60-69': 87.74, '70-79': 88.65, '80-89': 93.23, '90-99': 86.03, '100-109': 93.91, '110-119': 82.3, '120-129': 81.31, '130-139': 86.44, '140-149': 88.89, 'old': 86.59, 'new': 88.89}
2024-09-06 04:22:20,758 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38, 87.87, 86.76]
2024-09-06 04:22:20,758 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75, 98.6, 98.53]

Average Accuracy (CNN): 92.88
2024-09-06 04:22:20,759 [trainer.py] => Average Accuracy (CNN): 92.88 

2024-09-06 04:22:20,759 [trainer.py] => All params: 87838658
2024-09-06 04:22:20,760 [trainer.py] => Trainable params: 304320
2024-09-06 04:22:20,776 [ease.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.292, Train_accy 21.58:   0%|          | 0/20 [00:03<?, ?it/s]
Task 15, Epoch 1/20 => Loss 2.292, Train_accy 21.58:   5%|▌         | 1/20 [00:03<00:58,  3.08s/it]
Task 15, Epoch 2/20 => Loss 2.172, Train_accy 86.97:   5%|▌         | 1/20 [00:06<00:58,  3.08s/it]
Task 15, Epoch 2/20 => Loss 2.172, Train_accy 86.97:  10%|█         | 2/20 [00:06<00:55,  3.09s/it]
Task 15, Epoch 3/20 => Loss 1.981, Train_accy 92.95:  10%|█         | 2/20 [00:09<00:55,  3.09s/it]
Task 15, Epoch 3/20 => Loss 1.981, Train_accy 92.95:  15%|█▌        | 3/20 [00:09<00:52,  3.09s/it]
Task 15, Epoch 4/20 => Loss 1.698, Train_accy 94.44:  15%|█▌        | 3/20 [00:12<00:52,  3.09s/it]
Task 15, Epoch 4/20 => Loss 1.698, Train_accy 94.44:  20%|██        | 4/20 [00:12<00:49,  3.10s/it]
Task 15, Epoch 5/20 => Loss 1.389, Train_accy 93.38:  20%|██        | 4/20 [00:15<00:49,  3.10s/it]
Task 15, Epoch 5/20 => Loss 1.389, Train_accy 93.38:  25%|██▌       | 5/20 [00:15<00:46,  3.10s/it]
Task 15, Epoch 6/20 => Loss 1.079, Train_accy 95.30:  25%|██▌       | 5/20 [00:18<00:46,  3.10s/it]
Task 15, Epoch 6/20 => Loss 1.079, Train_accy 95.30:  30%|███       | 6/20 [00:18<00:43,  3.10s/it]
Task 15, Epoch 7/20 => Loss 0.881, Train_accy 94.23:  30%|███       | 6/20 [00:21<00:43,  3.10s/it]
Task 15, Epoch 7/20 => Loss 0.881, Train_accy 94.23:  35%|███▌      | 7/20 [00:21<00:40,  3.10s/it]
Task 15, Epoch 8/20 => Loss 0.739, Train_accy 94.87:  35%|███▌      | 7/20 [00:24<00:40,  3.10s/it]
Task 15, Epoch 8/20 => Loss 0.739, Train_accy 94.87:  40%|████      | 8/20 [00:24<00:37,  3.09s/it]
Task 15, Epoch 9/20 => Loss 0.633, Train_accy 94.44:  40%|████      | 8/20 [00:27<00:37,  3.09s/it]
Task 15, Epoch 9/20 => Loss 0.633, Train_accy 94.44:  45%|████▌     | 9/20 [00:27<00:34,  3.10s/it]
Task 15, Epoch 10/20 => Loss 0.541, Train_accy 96.37:  45%|████▌     | 9/20 [00:30<00:34,  3.10s/it]
Task 15, Epoch 10/20 => Loss 0.541, Train_accy 96.37:  50%|█████     | 10/20 [00:30<00:30,  3.10s/it]
Task 15, Epoch 11/20 => Loss 0.495, Train_accy 95.94:  50%|█████     | 10/20 [00:34<00:30,  3.10s/it]
Task 15, Epoch 11/20 => Loss 0.495, Train_accy 95.94:  55%|█████▌    | 11/20 [00:34<00:27,  3.10s/it]
Task 15, Epoch 12/20 => Loss 0.445, Train_accy 96.37:  55%|█████▌    | 11/20 [00:37<00:27,  3.10s/it]
Task 15, Epoch 12/20 => Loss 0.445, Train_accy 96.37:  60%|██████    | 12/20 [00:37<00:24,  3.10s/it]
Task 15, Epoch 13/20 => Loss 0.441, Train_accy 95.30:  60%|██████    | 12/20 [00:40<00:24,  3.10s/it]
Task 15, Epoch 13/20 => Loss 0.441, Train_accy 95.30:  65%|██████▌   | 13/20 [00:40<00:21,  3.10s/it]
Task 15, Epoch 14/20 => Loss 0.433, Train_accy 94.66:  65%|██████▌   | 13/20 [00:43<00:21,  3.10s/it]
Task 15, Epoch 14/20 => Loss 0.433, Train_accy 94.66:  70%|███████   | 14/20 [00:43<00:18,  3.10s/it]
Task 15, Epoch 15/20 => Loss 0.397, Train_accy 95.09:  70%|███████   | 14/20 [00:46<00:18,  3.10s/it]
Task 15, Epoch 15/20 => Loss 0.397, Train_accy 95.09:  75%|███████▌  | 15/20 [00:46<00:15,  3.10s/it]
Task 15, Epoch 16/20 => Loss 0.390, Train_accy 96.15:  75%|███████▌  | 15/20 [00:49<00:15,  3.10s/it]
Task 15, Epoch 16/20 => Loss 0.390, Train_accy 96.15:  80%|████████  | 16/20 [00:49<00:12,  3.10s/it]
Task 15, Epoch 17/20 => Loss 0.388, Train_accy 95.73:  80%|████████  | 16/20 [00:52<00:12,  3.10s/it]
Task 15, Epoch 17/20 => Loss 0.388, Train_accy 95.73:  85%|████████▌ | 17/20 [00:52<00:09,  3.09s/it]
Task 15, Epoch 18/20 => Loss 0.378, Train_accy 94.44:  85%|████████▌ | 17/20 [00:55<00:09,  3.09s/it]
Task 15, Epoch 18/20 => Loss 0.378, Train_accy 94.44:  90%|█████████ | 18/20 [00:55<00:06,  3.10s/it]
Task 15, Epoch 19/20 => Loss 0.352, Train_accy 95.30:  90%|█████████ | 18/20 [00:58<00:06,  3.10s/it]
Task 15, Epoch 19/20 => Loss 0.352, Train_accy 95.30:  95%|█████████▌| 19/20 [00:58<00:03,  3.12s/it]
Task 15, Epoch 20/20 => Loss 0.354, Train_accy 96.58:  95%|█████████▌| 19/20 [01:02<00:03,  3.12s/it]
Task 15, Epoch 20/20 => Loss 0.354, Train_accy 96.58: 100%|██████████| 20/20 [01:02<00:00,  3.12s/it]
Task 15, Epoch 20/20 => Loss 0.354, Train_accy 96.58: 100%|██████████| 20/20 [01:02<00:00,  3.10s/it]
2024-09-06 04:23:22,812 [ease.py] => Task 15, Epoch 20/20 => Loss 0.354, Train_accy 96.58
2024-09-06 04:25:21,348 [ease.py] => Task correct: 87.67847699629826
2024-09-06 04:25:21,348 [ease.py] => Task acc: 98.67794817556849
2024-09-06 04:25:21,373 [trainer.py] => No NME accuracy.
2024-09-06 04:25:21,373 [trainer.py] => CNN: {'total': 87.26, '00-09': 76.27, '10-19': 86.05, '20-29': 94.85, '30-39': 84.55, '40-49': 88.79, '50-59': 82.88, '60-69': 87.74, '70-79': 87.23, '80-89': 93.23, '90-99': 86.03, '100-109': 91.3, '110-119': 82.3, '120-129': 82.24, '130-139': 87.29, '140-149': 88.89, '150-159': 95.97, 'old': 86.64, 'new': 95.97}
2024-09-06 04:25:21,373 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38, 87.87, 86.76, 87.26]
2024-09-06 04:25:21,373 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75, 98.6, 98.53, 98.47]

Average Accuracy (CNN): 92.53
2024-09-06 04:25:21,373 [trainer.py] => Average Accuracy (CNN): 92.53 

2024-09-06 04:25:21,374 [trainer.py] => All params: 88076738
2024-09-06 04:25:21,375 [trainer.py] => Trainable params: 304320
2024-09-06 04:25:21,392 [ease.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.275, Train_accy 33.19:   0%|          | 0/20 [00:03<?, ?it/s]
Task 16, Epoch 1/20 => Loss 2.275, Train_accy 33.19:   5%|▌         | 1/20 [00:03<00:58,  3.08s/it]
Task 16, Epoch 2/20 => Loss 2.143, Train_accy 88.79:   5%|▌         | 1/20 [00:06<00:58,  3.08s/it]
Task 16, Epoch 2/20 => Loss 2.143, Train_accy 88.79:  10%|█         | 2/20 [00:06<00:55,  3.07s/it]
Task 16, Epoch 3/20 => Loss 1.926, Train_accy 94.61:  10%|█         | 2/20 [00:09<00:55,  3.07s/it]
Task 16, Epoch 3/20 => Loss 1.926, Train_accy 94.61:  15%|█▌        | 3/20 [00:09<00:52,  3.08s/it]
Task 16, Epoch 4/20 => Loss 1.607, Train_accy 94.40:  15%|█▌        | 3/20 [00:12<00:52,  3.08s/it]
Task 16, Epoch 4/20 => Loss 1.607, Train_accy 94.40:  20%|██        | 4/20 [00:12<00:50,  3.13s/it]
Task 16, Epoch 5/20 => Loss 1.287, Train_accy 93.10:  20%|██        | 4/20 [00:15<00:50,  3.13s/it]
Task 16, Epoch 5/20 => Loss 1.287, Train_accy 93.10:  25%|██▌       | 5/20 [00:15<00:47,  3.20s/it]
Task 16, Epoch 6/20 => Loss 0.978, Train_accy 94.40:  25%|██▌       | 5/20 [00:18<00:47,  3.20s/it]
Task 16, Epoch 6/20 => Loss 0.978, Train_accy 94.40:  30%|███       | 6/20 [00:18<00:44,  3.16s/it]
Task 16, Epoch 7/20 => Loss 0.766, Train_accy 95.91:  30%|███       | 6/20 [00:21<00:44,  3.16s/it]
Task 16, Epoch 7/20 => Loss 0.766, Train_accy 95.91:  35%|███▌      | 7/20 [00:21<00:40,  3.14s/it]
Task 16, Epoch 8/20 => Loss 0.622, Train_accy 95.47:  35%|███▌      | 7/20 [00:25<00:40,  3.14s/it]
Task 16, Epoch 8/20 => Loss 0.622, Train_accy 95.47:  40%|████      | 8/20 [00:25<00:37,  3.12s/it]
Task 16, Epoch 9/20 => Loss 0.535, Train_accy 96.55:  40%|████      | 8/20 [00:28<00:37,  3.12s/it]
Task 16, Epoch 9/20 => Loss 0.535, Train_accy 96.55:  45%|████▌     | 9/20 [00:28<00:34,  3.11s/it]
Task 16, Epoch 10/20 => Loss 0.462, Train_accy 96.34:  45%|████▌     | 9/20 [00:31<00:34,  3.11s/it]
Task 16, Epoch 10/20 => Loss 0.462, Train_accy 96.34:  50%|█████     | 10/20 [00:31<00:30,  3.09s/it]
Task 16, Epoch 11/20 => Loss 0.406, Train_accy 95.69:  50%|█████     | 10/20 [00:34<00:30,  3.09s/it]
Task 16, Epoch 11/20 => Loss 0.406, Train_accy 95.69:  55%|█████▌    | 11/20 [00:34<00:27,  3.08s/it]
Task 16, Epoch 12/20 => Loss 0.396, Train_accy 95.69:  55%|█████▌    | 11/20 [00:37<00:27,  3.08s/it]
Task 16, Epoch 12/20 => Loss 0.396, Train_accy 95.69:  60%|██████    | 12/20 [00:37<00:24,  3.08s/it]
Task 16, Epoch 13/20 => Loss 0.374, Train_accy 95.04:  60%|██████    | 12/20 [00:40<00:24,  3.08s/it]
Task 16, Epoch 13/20 => Loss 0.374, Train_accy 95.04:  65%|██████▌   | 13/20 [00:40<00:21,  3.08s/it]
Task 16, Epoch 14/20 => Loss 0.351, Train_accy 95.47:  65%|██████▌   | 13/20 [00:43<00:21,  3.08s/it]
Task 16, Epoch 14/20 => Loss 0.351, Train_accy 95.47:  70%|███████   | 14/20 [00:43<00:18,  3.08s/it]
Task 16, Epoch 15/20 => Loss 0.323, Train_accy 96.34:  70%|███████   | 14/20 [00:46<00:18,  3.08s/it]
Task 16, Epoch 15/20 => Loss 0.323, Train_accy 96.34:  75%|███████▌  | 15/20 [00:46<00:15,  3.08s/it]
Task 16, Epoch 16/20 => Loss 0.318, Train_accy 96.34:  75%|███████▌  | 15/20 [00:49<00:15,  3.08s/it]
Task 16, Epoch 16/20 => Loss 0.318, Train_accy 96.34:  80%|████████  | 16/20 [00:49<00:12,  3.07s/it]
Task 16, Epoch 17/20 => Loss 0.317, Train_accy 96.34:  80%|████████  | 16/20 [00:52<00:12,  3.07s/it]
Task 16, Epoch 17/20 => Loss 0.317, Train_accy 96.34:  85%|████████▌ | 17/20 [00:52<00:09,  3.09s/it]
Task 16, Epoch 18/20 => Loss 0.311, Train_accy 96.12:  85%|████████▌ | 17/20 [00:55<00:09,  3.09s/it]
Task 16, Epoch 18/20 => Loss 0.311, Train_accy 96.12:  90%|█████████ | 18/20 [00:55<00:06,  3.09s/it]
Task 16, Epoch 19/20 => Loss 0.308, Train_accy 95.91:  90%|█████████ | 18/20 [00:58<00:06,  3.09s/it]
Task 16, Epoch 19/20 => Loss 0.308, Train_accy 95.91:  95%|█████████▌| 19/20 [00:58<00:03,  3.08s/it]
Task 16, Epoch 20/20 => Loss 0.330, Train_accy 96.12:  95%|█████████▌| 19/20 [01:01<00:03,  3.08s/it]
Task 16, Epoch 20/20 => Loss 0.330, Train_accy 96.12: 100%|██████████| 20/20 [01:01<00:00,  3.09s/it]
Task 16, Epoch 20/20 => Loss 0.330, Train_accy 96.12: 100%|██████████| 20/20 [01:01<00:00,  3.10s/it]
2024-09-06 04:26:23,355 [ease.py] => Task 16, Epoch 20/20 => Loss 0.330, Train_accy 96.12
2024-09-06 04:28:36,688 [ease.py] => Task correct: 87.25925925925925
2024-09-06 04:28:36,689 [ease.py] => Task acc: 98.71604938271605
2024-09-06 04:28:36,716 [trainer.py] => No NME accuracy.
2024-09-06 04:28:36,717 [trainer.py] => CNN: {'total': 86.81, '00-09': 76.27, '10-19': 86.05, '20-29': 94.85, '30-39': 84.55, '40-49': 85.98, '50-59': 82.88, '60-69': 87.74, '70-79': 87.23, '80-89': 93.23, '90-99': 83.09, '100-109': 91.3, '110-119': 82.3, '120-129': 82.24, '130-139': 85.59, '140-149': 87.3, '150-159': 95.16, '160-169': 89.55, 'old': 86.62, 'new': 89.55}
2024-09-06 04:28:36,717 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38, 87.87, 86.76, 87.26, 86.81]
2024-09-06 04:28:36,717 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75, 98.6, 98.53, 98.47, 98.37]

Average Accuracy (CNN): 92.19
2024-09-06 04:28:36,717 [trainer.py] => Average Accuracy (CNN): 92.19 

2024-09-06 04:28:36,718 [trainer.py] => All params: 88330178
2024-09-06 04:28:36,719 [trainer.py] => Trainable params: 304320
2024-09-06 04:28:36,738 [ease.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.270, Train_accy 24.90:   0%|          | 0/20 [00:03<?, ?it/s]
Task 17, Epoch 1/20 => Loss 2.270, Train_accy 24.90:   5%|▌         | 1/20 [00:03<01:01,  3.25s/it]
Task 17, Epoch 2/20 => Loss 2.133, Train_accy 76.32:   5%|▌         | 1/20 [00:06<01:01,  3.25s/it]
Task 17, Epoch 2/20 => Loss 2.133, Train_accy 76.32:  10%|█         | 2/20 [00:06<00:58,  3.26s/it]
Task 17, Epoch 3/20 => Loss 1.907, Train_accy 85.22:  10%|█         | 2/20 [00:09<00:58,  3.26s/it]
Task 17, Epoch 3/20 => Loss 1.907, Train_accy 85.22:  15%|█▌        | 3/20 [00:09<00:55,  3.26s/it]
Task 17, Epoch 4/20 => Loss 1.593, Train_accy 88.06:  15%|█▌        | 3/20 [00:13<00:55,  3.26s/it]
Task 17, Epoch 4/20 => Loss 1.593, Train_accy 88.06:  20%|██        | 4/20 [00:13<00:52,  3.28s/it]
Task 17, Epoch 5/20 => Loss 1.263, Train_accy 93.72:  20%|██        | 4/20 [00:16<00:52,  3.28s/it]
Task 17, Epoch 5/20 => Loss 1.263, Train_accy 93.72:  25%|██▌       | 5/20 [00:16<00:49,  3.27s/it]
Task 17, Epoch 6/20 => Loss 0.944, Train_accy 96.96:  25%|██▌       | 5/20 [00:19<00:49,  3.27s/it]
Task 17, Epoch 6/20 => Loss 0.944, Train_accy 96.96:  30%|███       | 6/20 [00:19<00:45,  3.28s/it]
Task 17, Epoch 7/20 => Loss 0.754, Train_accy 96.76:  30%|███       | 6/20 [00:22<00:45,  3.28s/it]
Task 17, Epoch 7/20 => Loss 0.754, Train_accy 96.76:  35%|███▌      | 7/20 [00:22<00:42,  3.29s/it]
Task 17, Epoch 8/20 => Loss 0.635, Train_accy 96.56:  35%|███▌      | 7/20 [00:26<00:42,  3.29s/it]
Task 17, Epoch 8/20 => Loss 0.635, Train_accy 96.56:  40%|████      | 8/20 [00:26<00:39,  3.28s/it]
Task 17, Epoch 9/20 => Loss 0.575, Train_accy 94.94:  40%|████      | 8/20 [00:29<00:39,  3.28s/it]
Task 17, Epoch 9/20 => Loss 0.575, Train_accy 94.94:  45%|████▌     | 9/20 [00:29<00:36,  3.27s/it]
Task 17, Epoch 10/20 => Loss 0.498, Train_accy 96.36:  45%|████▌     | 9/20 [00:32<00:36,  3.27s/it]
Task 17, Epoch 10/20 => Loss 0.498, Train_accy 96.36:  50%|█████     | 10/20 [00:32<00:32,  3.28s/it]
Task 17, Epoch 11/20 => Loss 0.426, Train_accy 96.36:  50%|█████     | 10/20 [00:36<00:32,  3.28s/it]
Task 17, Epoch 11/20 => Loss 0.426, Train_accy 96.36:  55%|█████▌    | 11/20 [00:36<00:29,  3.27s/it]
Task 17, Epoch 12/20 => Loss 0.407, Train_accy 96.15:  55%|█████▌    | 11/20 [00:39<00:29,  3.27s/it]
Task 17, Epoch 12/20 => Loss 0.407, Train_accy 96.15:  60%|██████    | 12/20 [00:39<00:26,  3.27s/it]
Task 17, Epoch 13/20 => Loss 0.423, Train_accy 95.14:  60%|██████    | 12/20 [00:42<00:26,  3.27s/it]
Task 17, Epoch 13/20 => Loss 0.423, Train_accy 95.14:  65%|██████▌   | 13/20 [00:42<00:22,  3.28s/it]
Task 17, Epoch 14/20 => Loss 0.367, Train_accy 96.36:  65%|██████▌   | 13/20 [00:45<00:22,  3.28s/it]
Task 17, Epoch 14/20 => Loss 0.367, Train_accy 96.36:  70%|███████   | 14/20 [00:45<00:19,  3.28s/it]
Task 17, Epoch 15/20 => Loss 0.367, Train_accy 95.55:  70%|███████   | 14/20 [00:49<00:19,  3.28s/it]
Task 17, Epoch 15/20 => Loss 0.367, Train_accy 95.55:  75%|███████▌  | 15/20 [00:49<00:16,  3.28s/it]
Task 17, Epoch 16/20 => Loss 0.370, Train_accy 96.56:  75%|███████▌  | 15/20 [00:52<00:16,  3.28s/it]
Task 17, Epoch 16/20 => Loss 0.370, Train_accy 96.56:  80%|████████  | 16/20 [00:52<00:13,  3.28s/it]
Task 17, Epoch 17/20 => Loss 0.349, Train_accy 95.95:  80%|████████  | 16/20 [00:55<00:13,  3.28s/it]
Task 17, Epoch 17/20 => Loss 0.349, Train_accy 95.95:  85%|████████▌ | 17/20 [00:55<00:09,  3.28s/it]
Task 17, Epoch 18/20 => Loss 0.344, Train_accy 96.36:  85%|████████▌ | 17/20 [00:58<00:09,  3.28s/it]
Task 17, Epoch 18/20 => Loss 0.344, Train_accy 96.36:  90%|█████████ | 18/20 [00:58<00:06,  3.28s/it]
Task 17, Epoch 19/20 => Loss 0.336, Train_accy 96.36:  90%|█████████ | 18/20 [01:02<00:06,  3.28s/it]
Task 17, Epoch 19/20 => Loss 0.336, Train_accy 96.36:  95%|█████████▌| 19/20 [01:02<00:03,  3.28s/it]
Task 17, Epoch 20/20 => Loss 0.364, Train_accy 94.94:  95%|█████████▌| 19/20 [01:05<00:03,  3.28s/it]
Task 17, Epoch 20/20 => Loss 0.364, Train_accy 94.94: 100%|██████████| 20/20 [01:05<00:00,  3.28s/it]
Task 17, Epoch 20/20 => Loss 0.364, Train_accy 94.94: 100%|██████████| 20/20 [01:05<00:00,  3.28s/it]
2024-09-06 04:29:42,294 [ease.py] => Task 17, Epoch 20/20 => Loss 0.364, Train_accy 94.94
2024-09-06 04:32:10,219 [ease.py] => Task correct: 87.64097744360902
2024-09-06 04:32:10,219 [ease.py] => Task acc: 98.7312030075188
2024-09-06 04:32:10,246 [trainer.py] => No NME accuracy.
2024-09-06 04:32:10,246 [trainer.py] => CNN: {'total': 87.17, '00-09': 75.42, '10-19': 86.05, '20-29': 94.85, '30-39': 84.55, '40-49': 86.92, '50-59': 83.78, '60-69': 87.74, '70-79': 87.23, '80-89': 93.23, '90-99': 83.09, '100-109': 91.3, '110-119': 79.65, '120-129': 82.24, '130-139': 85.59, '140-149': 86.51, '150-159': 95.16, '160-169': 89.55, '170-179': 97.09, 'old': 86.67, 'new': 97.09}
2024-09-06 04:32:10,246 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38, 87.87, 86.76, 87.26, 86.81, 87.17]
2024-09-06 04:32:10,246 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75, 98.6, 98.53, 98.47, 98.37, 98.31]

Average Accuracy (CNN): 91.91
2024-09-06 04:32:10,246 [trainer.py] => Average Accuracy (CNN): 91.91 

2024-09-06 04:32:10,247 [trainer.py] => All params: 88598978
2024-09-06 04:32:10,248 [trainer.py] => Trainable params: 304320
2024-09-06 04:32:10,271 [ease.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.282, Train_accy 23.52:   0%|          | 0/20 [00:03<?, ?it/s]
Task 18, Epoch 1/20 => Loss 2.282, Train_accy 23.52:   5%|▌         | 1/20 [00:03<00:57,  3.05s/it]
Task 18, Epoch 2/20 => Loss 2.152, Train_accy 81.10:   5%|▌         | 1/20 [00:06<00:57,  3.05s/it]
Task 18, Epoch 2/20 => Loss 2.152, Train_accy 81.10:  10%|█         | 2/20 [00:06<00:54,  3.05s/it]
Task 18, Epoch 3/20 => Loss 1.943, Train_accy 87.47:  10%|█         | 2/20 [00:09<00:54,  3.05s/it]
Task 18, Epoch 3/20 => Loss 1.943, Train_accy 87.47:  15%|█▌        | 3/20 [00:09<00:51,  3.04s/it]
Task 18, Epoch 4/20 => Loss 1.655, Train_accy 89.89:  15%|█▌        | 3/20 [00:12<00:51,  3.04s/it]
Task 18, Epoch 4/20 => Loss 1.655, Train_accy 89.89:  20%|██        | 4/20 [00:12<00:48,  3.04s/it]
Task 18, Epoch 5/20 => Loss 1.312, Train_accy 92.75:  20%|██        | 4/20 [00:15<00:48,  3.04s/it]
Task 18, Epoch 5/20 => Loss 1.312, Train_accy 92.75:  25%|██▌       | 5/20 [00:15<00:45,  3.04s/it]
Task 18, Epoch 6/20 => Loss 1.024, Train_accy 94.29:  25%|██▌       | 5/20 [00:18<00:45,  3.04s/it]
Task 18, Epoch 6/20 => Loss 1.024, Train_accy 94.29:  30%|███       | 6/20 [00:18<00:42,  3.03s/it]
Task 18, Epoch 7/20 => Loss 0.862, Train_accy 92.97:  30%|███       | 6/20 [00:21<00:42,  3.03s/it]
Task 18, Epoch 7/20 => Loss 0.862, Train_accy 92.97:  35%|███▌      | 7/20 [00:21<00:39,  3.03s/it]
Task 18, Epoch 8/20 => Loss 0.679, Train_accy 95.60:  35%|███▌      | 7/20 [00:24<00:39,  3.03s/it]
Task 18, Epoch 8/20 => Loss 0.679, Train_accy 95.60:  40%|████      | 8/20 [00:24<00:36,  3.03s/it]
Task 18, Epoch 9/20 => Loss 0.623, Train_accy 93.41:  40%|████      | 8/20 [00:27<00:36,  3.03s/it]
Task 18, Epoch 9/20 => Loss 0.623, Train_accy 93.41:  45%|████▌     | 9/20 [00:27<00:33,  3.03s/it]
Task 18, Epoch 10/20 => Loss 0.533, Train_accy 95.60:  45%|████▌     | 9/20 [00:30<00:33,  3.03s/it]
Task 18, Epoch 10/20 => Loss 0.533, Train_accy 95.60:  50%|█████     | 10/20 [00:30<00:30,  3.03s/it]
Task 18, Epoch 11/20 => Loss 0.472, Train_accy 94.95:  50%|█████     | 10/20 [00:33<00:30,  3.03s/it]
Task 18, Epoch 11/20 => Loss 0.472, Train_accy 94.95:  55%|█████▌    | 11/20 [00:33<00:27,  3.03s/it]
Task 18, Epoch 12/20 => Loss 0.466, Train_accy 96.48:  55%|█████▌    | 11/20 [00:36<00:27,  3.03s/it]
Task 18, Epoch 12/20 => Loss 0.466, Train_accy 96.48:  60%|██████    | 12/20 [00:36<00:24,  3.03s/it]
Task 18, Epoch 13/20 => Loss 0.481, Train_accy 93.19:  60%|██████    | 12/20 [00:39<00:24,  3.03s/it]
Task 18, Epoch 13/20 => Loss 0.481, Train_accy 93.19:  65%|██████▌   | 13/20 [00:39<00:21,  3.04s/it]
Task 18, Epoch 14/20 => Loss 0.402, Train_accy 95.82:  65%|██████▌   | 13/20 [00:42<00:21,  3.04s/it]
Task 18, Epoch 14/20 => Loss 0.402, Train_accy 95.82:  70%|███████   | 14/20 [00:42<00:18,  3.03s/it]
Task 18, Epoch 15/20 => Loss 0.369, Train_accy 96.04:  70%|███████   | 14/20 [00:45<00:18,  3.03s/it]
Task 18, Epoch 15/20 => Loss 0.369, Train_accy 96.04:  75%|███████▌  | 15/20 [00:45<00:15,  3.03s/it]
Task 18, Epoch 16/20 => Loss 0.350, Train_accy 96.04:  75%|███████▌  | 15/20 [00:48<00:15,  3.03s/it]
Task 18, Epoch 16/20 => Loss 0.350, Train_accy 96.04:  80%|████████  | 16/20 [00:48<00:12,  3.04s/it]
Task 18, Epoch 17/20 => Loss 0.389, Train_accy 93.85:  80%|████████  | 16/20 [00:51<00:12,  3.04s/it]
Task 18, Epoch 17/20 => Loss 0.389, Train_accy 93.85:  85%|████████▌ | 17/20 [00:51<00:09,  3.03s/it]
Task 18, Epoch 18/20 => Loss 0.379, Train_accy 95.16:  85%|████████▌ | 17/20 [00:54<00:09,  3.03s/it]
Task 18, Epoch 18/20 => Loss 0.379, Train_accy 95.16:  90%|█████████ | 18/20 [00:54<00:06,  3.04s/it]
Task 18, Epoch 19/20 => Loss 0.364, Train_accy 95.38:  90%|█████████ | 18/20 [00:57<00:06,  3.04s/it]
Task 18, Epoch 19/20 => Loss 0.364, Train_accy 95.38:  95%|█████████▌| 19/20 [00:57<00:03,  3.04s/it]
Task 18, Epoch 20/20 => Loss 0.380, Train_accy 95.60:  95%|█████████▌| 19/20 [01:00<00:03,  3.04s/it]
Task 18, Epoch 20/20 => Loss 0.380, Train_accy 95.60: 100%|██████████| 20/20 [01:00<00:00,  3.04s/it]
Task 18, Epoch 20/20 => Loss 0.380, Train_accy 95.60: 100%|██████████| 20/20 [01:00<00:00,  3.04s/it]
2024-09-06 04:33:10,986 [ease.py] => Task 18, Epoch 20/20 => Loss 0.380, Train_accy 95.60
2024-09-06 04:35:52,277 [ease.py] => Task correct: 87.21238938053098
2024-09-06 04:35:52,278 [ease.py] => Task acc: 98.6283185840708
2024-09-06 04:35:52,302 [trainer.py] => No NME accuracy.
2024-09-06 04:35:52,302 [trainer.py] => CNN: {'total': 86.77, '00-09': 75.42, '10-19': 86.05, '20-29': 92.78, '30-39': 81.82, '40-49': 85.98, '50-59': 83.78, '60-69': 87.74, '70-79': 87.23, '80-89': 93.98, '90-99': 83.09, '100-109': 91.3, '110-119': 79.65, '120-129': 79.44, '130-139': 85.59, '140-149': 84.92, '150-159': 95.16, '160-169': 89.55, '170-179': 97.09, '180-189': 87.88, 'old': 86.7, 'new': 87.88}
2024-09-06 04:35:52,302 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38, 87.87, 86.76, 87.26, 86.81, 87.17, 86.77]
2024-09-06 04:35:52,302 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75, 98.6, 98.53, 98.47, 98.37, 98.31, 97.96]

Average Accuracy (CNN): 91.64
2024-09-06 04:35:52,302 [trainer.py] => Average Accuracy (CNN): 91.64 

2024-09-06 04:35:52,303 [trainer.py] => All params: 88883138
2024-09-06 04:35:52,304 [trainer.py] => Trainable params: 304320
2024-09-06 04:35:52,329 [ease.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.268, Train_accy 34.81:   0%|          | 0/20 [00:03<?, ?it/s]
Task 19, Epoch 1/20 => Loss 2.268, Train_accy 34.81:   5%|▌         | 1/20 [00:03<01:02,  3.28s/it]
Task 19, Epoch 2/20 => Loss 2.124, Train_accy 89.13:   5%|▌         | 1/20 [00:06<01:02,  3.28s/it]
Task 19, Epoch 2/20 => Loss 2.124, Train_accy 89.13:  10%|█         | 2/20 [00:06<00:59,  3.28s/it]
Task 19, Epoch 3/20 => Loss 1.864, Train_accy 94.57:  10%|█         | 2/20 [00:09<00:59,  3.28s/it]
Task 19, Epoch 3/20 => Loss 1.864, Train_accy 94.57:  15%|█▌        | 3/20 [00:09<00:55,  3.27s/it]
Task 19, Epoch 4/20 => Loss 1.516, Train_accy 93.16:  15%|█▌        | 3/20 [00:13<00:55,  3.27s/it]
Task 19, Epoch 4/20 => Loss 1.516, Train_accy 93.16:  20%|██        | 4/20 [00:13<00:52,  3.27s/it]
Task 19, Epoch 5/20 => Loss 1.156, Train_accy 93.36:  20%|██        | 4/20 [00:16<00:52,  3.27s/it]
Task 19, Epoch 5/20 => Loss 1.156, Train_accy 93.36:  25%|██▌       | 5/20 [00:16<00:49,  3.27s/it]
Task 19, Epoch 6/20 => Loss 0.878, Train_accy 93.96:  25%|██▌       | 5/20 [00:19<00:49,  3.27s/it]
Task 19, Epoch 6/20 => Loss 0.878, Train_accy 93.96:  30%|███       | 6/20 [00:19<00:45,  3.27s/it]
Task 19, Epoch 7/20 => Loss 0.723, Train_accy 92.56:  30%|███       | 6/20 [00:22<00:45,  3.27s/it]
Task 19, Epoch 7/20 => Loss 0.723, Train_accy 92.56:  35%|███▌      | 7/20 [00:22<00:42,  3.27s/it]
Task 19, Epoch 8/20 => Loss 0.582, Train_accy 94.77:  35%|███▌      | 7/20 [00:26<00:42,  3.27s/it]
Task 19, Epoch 8/20 => Loss 0.582, Train_accy 94.77:  40%|████      | 8/20 [00:26<00:39,  3.27s/it]
Task 19, Epoch 9/20 => Loss 0.486, Train_accy 95.37:  40%|████      | 8/20 [00:29<00:39,  3.27s/it]
Task 19, Epoch 9/20 => Loss 0.486, Train_accy 95.37:  45%|████▌     | 9/20 [00:29<00:35,  3.26s/it]
Task 19, Epoch 10/20 => Loss 0.454, Train_accy 93.56:  45%|████▌     | 9/20 [00:32<00:35,  3.26s/it]
Task 19, Epoch 10/20 => Loss 0.454, Train_accy 93.56:  50%|█████     | 10/20 [00:32<00:32,  3.26s/it]
Task 19, Epoch 11/20 => Loss 0.422, Train_accy 92.56:  50%|█████     | 10/20 [00:35<00:32,  3.26s/it]
Task 19, Epoch 11/20 => Loss 0.422, Train_accy 92.56:  55%|█████▌    | 11/20 [00:35<00:29,  3.27s/it]
Task 19, Epoch 12/20 => Loss 0.365, Train_accy 94.97:  55%|█████▌    | 11/20 [00:39<00:29,  3.27s/it]
Task 19, Epoch 12/20 => Loss 0.365, Train_accy 94.97:  60%|██████    | 12/20 [00:39<00:26,  3.27s/it]
Task 19, Epoch 13/20 => Loss 0.337, Train_accy 94.97:  60%|██████    | 12/20 [00:42<00:26,  3.27s/it]
Task 19, Epoch 13/20 => Loss 0.337, Train_accy 94.97:  65%|██████▌   | 13/20 [00:42<00:23,  3.29s/it]
Task 19, Epoch 14/20 => Loss 0.308, Train_accy 94.97:  65%|██████▌   | 13/20 [00:45<00:23,  3.29s/it]
Task 19, Epoch 14/20 => Loss 0.308, Train_accy 94.97:  70%|███████   | 14/20 [00:45<00:19,  3.29s/it]
Task 19, Epoch 15/20 => Loss 0.341, Train_accy 93.56:  70%|███████   | 14/20 [00:49<00:19,  3.29s/it]
Task 19, Epoch 15/20 => Loss 0.341, Train_accy 93.56:  75%|███████▌  | 15/20 [00:49<00:16,  3.28s/it]
Task 19, Epoch 16/20 => Loss 0.309, Train_accy 95.37:  75%|███████▌  | 15/20 [00:52<00:16,  3.28s/it]
Task 19, Epoch 16/20 => Loss 0.309, Train_accy 95.37:  80%|████████  | 16/20 [00:52<00:13,  3.28s/it]
Task 19, Epoch 17/20 => Loss 0.296, Train_accy 95.98:  80%|████████  | 16/20 [00:55<00:13,  3.28s/it]
Task 19, Epoch 17/20 => Loss 0.296, Train_accy 95.98:  85%|████████▌ | 17/20 [00:55<00:09,  3.30s/it]
Task 19, Epoch 18/20 => Loss 0.333, Train_accy 93.76:  85%|████████▌ | 17/20 [00:59<00:09,  3.30s/it]
Task 19, Epoch 18/20 => Loss 0.333, Train_accy 93.76:  90%|█████████ | 18/20 [00:59<00:06,  3.29s/it]
Task 19, Epoch 19/20 => Loss 0.354, Train_accy 93.76:  90%|█████████ | 18/20 [01:02<00:06,  3.29s/it]
Task 19, Epoch 19/20 => Loss 0.354, Train_accy 93.76:  95%|█████████▌| 19/20 [01:02<00:03,  3.29s/it]
Task 19, Epoch 20/20 => Loss 0.308, Train_accy 94.16:  95%|█████████▌| 19/20 [01:05<00:03,  3.29s/it]
Task 19, Epoch 20/20 => Loss 0.308, Train_accy 94.16: 100%|██████████| 20/20 [01:05<00:00,  3.30s/it]
Task 19, Epoch 20/20 => Loss 0.308, Train_accy 94.16: 100%|██████████| 20/20 [01:05<00:00,  3.28s/it]
2024-09-06 04:36:57,948 [ease.py] => Task 19, Epoch 20/20 => Loss 0.308, Train_accy 94.16
2024-09-06 04:39:56,631 [ease.py] => Task correct: 86.04749787955895
2024-09-06 04:39:56,631 [ease.py] => Task acc: 98.60050890585242
2024-09-06 04:39:56,661 [trainer.py] => No NME accuracy.
2024-09-06 04:39:56,661 [trainer.py] => CNN: {'total': 85.54, '00-09': 73.73, '10-19': 85.27, '20-29': 92.78, '30-39': 77.27, '40-49': 85.98, '50-59': 82.88, '60-69': 74.53, '70-79': 86.52, '80-89': 93.98, '90-99': 83.09, '100-109': 91.3, '110-119': 79.65, '120-129': 79.44, '130-139': 85.59, '140-149': 84.13, '150-159': 95.16, '160-169': 85.82, '170-179': 95.15, '180-189': 87.12, '190-199': 90.82, 'old': 85.31, 'new': 90.82}
2024-09-06 04:39:56,661 [trainer.py] => CNN top1 curve: [100.0, 99.19, 98.26, 96.92, 96.61, 93.15, 91.39, 92.27, 91.73, 90.82, 90.87, 88.98, 88.38, 87.87, 86.76, 87.26, 86.81, 87.17, 86.77, 85.54]
2024-09-06 04:39:56,661 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.71, 99.78, 99.64, 99.26, 99.1, 99.02, 99.14, 98.99, 98.93, 98.73, 98.75, 98.6, 98.53, 98.47, 98.37, 98.31, 97.96, 98.01]

Average Accuracy (CNN): 91.34
2024-09-06 04:39:56,661 [trainer.py] => Average Accuracy (CNN): 91.34 

Accuracy Matrix (CNN):
[[100.   100.    98.31  97.46  97.46  83.9   83.05  83.9   83.05  83.05
   83.05  83.05  80.51  80.51  77.12  76.27  76.27  75.42  75.42  73.73]
 [  0.    98.45  98.45  96.9   96.9   96.9   90.7   90.7   86.05  86.05
   83.72  85.27  84.5   85.27  86.82  86.05  86.05  86.05  86.05  85.27]
 [  0.     0.    97.94  95.88  95.88  95.88  95.88  95.88  95.88  95.88
   95.88  95.88  95.88  95.88  94.85  94.85  94.85  94.85  92.78  92.78]
 [  0.     0.     0.    97.27  95.45  95.45  94.55  94.55  93.64  86.36
   86.36  87.27  87.27  87.27  83.64  84.55  84.55  84.55  81.82  77.27]
 [  0.     0.     0.     0.    97.2   96.26  95.33  95.33  95.33  95.33
   95.33  95.33  92.52  92.52  88.79  88.79  85.98  86.92  85.98  85.98]
 [  0.     0.     0.     0.     0.    90.99  88.29  88.29  87.39  88.29
   88.29  82.88  82.88  82.88  81.08  82.88  82.88  83.78  83.78  82.88]
 [  0.     0.     0.     0.     0.     0.    93.4   93.4   93.4   90.57
   89.62  87.74  87.74  87.74  87.74  87.74  87.74  87.74  87.74  74.53]
 [  0.     0.     0.     0.     0.     0.     0.    96.45  96.45  95.74
   95.74  88.65  88.65  88.65  88.65  87.23  87.23  87.23  87.23  86.52]
 [  0.     0.     0.     0.     0.     0.     0.     0.    94.74  94.74
   94.74  93.23  93.23  93.23  93.23  93.23  93.23  93.23  93.98  93.98]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    91.91
   91.91  89.71  88.24  88.24  86.03  86.03  83.09  83.09  83.09  83.09]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
   94.78  94.78  94.78  93.91  93.91  91.3   91.3   91.3   91.3   91.3 ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.    84.96  84.96  84.96  82.3   82.3   82.3   79.65  79.65  79.65]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.    88.79  82.24  81.31  82.24  82.24  82.24  79.44  79.44]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.    87.29  86.44  87.29  85.59  85.59  85.59  85.59]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.    88.89  88.89  87.3   86.51  84.92  84.13]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.    95.97  95.16  95.16  95.16  95.16]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.    89.55  89.55  89.55  85.82]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.    97.09  97.09  95.15]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.    87.88  87.12]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
    0.     0.     0.     0.     0.     0.     0.     0.     0.    90.82]]
2024-09-06 04:39:56,664 [trainer.py] => Forgetting (CNN): 8.113684210526317
2024-09-06 04:39:59,296 [trainer.py] => config: ./exps/ease_cub_B100_Inc5.json
2024-09-06 04:39:59,308 [trainer.py] => prefix:  
2024-09-06 04:39:59,308 [trainer.py] => dataset: cub
2024-09-06 04:39:59,308 [trainer.py] => memory_size: 0
2024-09-06 04:39:59,308 [trainer.py] => memory_per_class: 0
2024-09-06 04:39:59,308 [trainer.py] => fixed_memory: False
2024-09-06 04:39:59,308 [trainer.py] => shuffle: True
2024-09-06 04:39:59,308 [trainer.py] => init_cls: 100
2024-09-06 04:39:59,308 [trainer.py] => increment: 20
2024-09-06 04:39:59,308 [trainer.py] => model_name: ease
2024-09-06 04:39:59,308 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-06 04:39:59,308 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 04:39:59,308 [trainer.py] => seed: 1993
2024-09-06 04:39:59,308 [trainer.py] => init_epochs: 20
2024-09-06 04:39:59,308 [trainer.py] => init_lr: 0.025
2024-09-06 04:39:59,308 [trainer.py] => later_epochs: 20
2024-09-06 04:39:59,308 [trainer.py] => later_lr: 0.025
2024-09-06 04:39:59,308 [trainer.py] => batch_size: 48
2024-09-06 04:39:59,309 [trainer.py] => weight_decay: 0.0005
2024-09-06 04:39:59,309 [trainer.py] => min_lr: 0
2024-09-06 04:39:59,309 [trainer.py] => optimizer: sgd
2024-09-06 04:39:59,309 [trainer.py] => scheduler: cosine
2024-09-06 04:39:59,309 [trainer.py] => pretrained: True
2024-09-06 04:39:59,309 [trainer.py] => vpt_type: Deep
2024-09-06 04:39:59,309 [trainer.py] => prompt_token_num: 5
2024-09-06 04:39:59,309 [trainer.py] => ffn_num: 16
2024-09-06 04:39:59,309 [trainer.py] => use_diagonal: False
2024-09-06 04:39:59,309 [trainer.py] => recalc_sim: True
2024-09-06 04:39:59,309 [trainer.py] => alpha: 0.1
2024-09-06 04:39:59,309 [trainer.py] => use_init_ptm: False
2024-09-06 04:39:59,309 [trainer.py] => beta: 0
2024-09-06 04:39:59,309 [trainer.py] => use_old_data: False
2024-09-06 04:39:59,309 [trainer.py] => use_reweight: True
2024-09-06 04:39:59,309 [trainer.py] => moni_adam: False
2024-09-06 04:39:59,309 [trainer.py] => adapter_num: -1
2024-09-06 04:39:59,346 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-06 04:40:02,020 [trainer.py] => All params: 86102976
2024-09-06 04:40:02,021 [trainer.py] => Trainable params: 304320
2024-09-06 04:40:02,028 [ease.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.406, Train_accy 34.26:   0%|          | 0/20 [00:28<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.406, Train_accy 34.26:   5%|▌         | 1/20 [00:28<08:54, 28.14s/it]
Task 0, Epoch 2/20 => Loss 2.039, Train_accy 75.31:   5%|▌         | 1/20 [00:55<08:54, 28.14s/it]
Task 0, Epoch 2/20 => Loss 2.039, Train_accy 75.31:  10%|█         | 2/20 [00:55<08:22, 27.93s/it]
Task 0, Epoch 3/20 => Loss 0.720, Train_accy 85.92:  10%|█         | 2/20 [01:23<08:22, 27.93s/it]
Task 0, Epoch 3/20 => Loss 0.720, Train_accy 85.92:  15%|█▌        | 3/20 [01:23<07:54, 27.90s/it]
Task 0, Epoch 4/20 => Loss 0.598, Train_accy 87.07:  15%|█▌        | 3/20 [01:51<07:54, 27.90s/it]
Task 0, Epoch 4/20 => Loss 0.598, Train_accy 87.07:  20%|██        | 4/20 [01:51<07:25, 27.87s/it]
Task 0, Epoch 5/20 => Loss 0.552, Train_accy 87.77:  20%|██        | 4/20 [02:19<07:25, 27.87s/it]
Task 0, Epoch 5/20 => Loss 0.552, Train_accy 87.77:  25%|██▌       | 5/20 [02:19<06:58, 27.88s/it]
Task 0, Epoch 6/20 => Loss 0.509, Train_accy 88.37:  25%|██▌       | 5/20 [02:47<06:58, 27.88s/it]
Task 0, Epoch 6/20 => Loss 0.509, Train_accy 88.37:  30%|███       | 6/20 [02:47<06:30, 27.87s/it]
Task 0, Epoch 7/20 => Loss 0.485, Train_accy 89.03:  30%|███       | 6/20 [03:15<06:30, 27.87s/it]
Task 0, Epoch 7/20 => Loss 0.485, Train_accy 89.03:  35%|███▌      | 7/20 [03:15<06:02, 27.87s/it]
Task 0, Epoch 8/20 => Loss 0.450, Train_accy 89.71:  35%|███▌      | 7/20 [03:43<06:02, 27.87s/it]
Task 0, Epoch 8/20 => Loss 0.450, Train_accy 89.71:  40%|████      | 8/20 [03:43<05:34, 27.89s/it]
Task 0, Epoch 9/20 => Loss 0.426, Train_accy 90.31:  40%|████      | 8/20 [04:11<05:34, 27.89s/it]
Task 0, Epoch 9/20 => Loss 0.426, Train_accy 90.31:  45%|████▌     | 9/20 [04:11<05:07, 27.91s/it]
Task 0, Epoch 10/20 => Loss 0.420, Train_accy 90.33:  45%|████▌     | 9/20 [04:39<05:07, 27.91s/it]
Task 0, Epoch 10/20 => Loss 0.420, Train_accy 90.33:  50%|█████     | 10/20 [04:39<04:39, 27.92s/it]
Task 0, Epoch 11/20 => Loss 0.406, Train_accy 91.03:  50%|█████     | 10/20 [05:07<04:39, 27.92s/it]
Task 0, Epoch 11/20 => Loss 0.406, Train_accy 91.03:  55%|█████▌    | 11/20 [05:07<04:11, 27.95s/it]
Task 0, Epoch 12/20 => Loss 0.421, Train_accy 89.97:  55%|█████▌    | 11/20 [05:35<04:11, 27.95s/it]
Task 0, Epoch 12/20 => Loss 0.421, Train_accy 89.97:  60%|██████    | 12/20 [05:35<03:43, 27.94s/it]
Task 0, Epoch 13/20 => Loss 0.389, Train_accy 91.10:  60%|██████    | 12/20 [06:02<03:43, 27.94s/it]
Task 0, Epoch 13/20 => Loss 0.389, Train_accy 91.10:  65%|██████▌   | 13/20 [06:02<03:15, 27.93s/it]
Task 0, Epoch 14/20 => Loss 0.383, Train_accy 91.14:  65%|██████▌   | 13/20 [06:30<03:15, 27.93s/it]
Task 0, Epoch 14/20 => Loss 0.383, Train_accy 91.14:  70%|███████   | 14/20 [06:30<02:47, 27.93s/it]
Task 0, Epoch 15/20 => Loss 0.377, Train_accy 91.78:  70%|███████   | 14/20 [06:58<02:47, 27.93s/it]
Task 0, Epoch 15/20 => Loss 0.377, Train_accy 91.78:  75%|███████▌  | 15/20 [06:58<02:19, 27.92s/it]
Task 0, Epoch 16/20 => Loss 0.380, Train_accy 91.44:  75%|███████▌  | 15/20 [07:26<02:19, 27.92s/it]
Task 0, Epoch 16/20 => Loss 0.380, Train_accy 91.44:  80%|████████  | 16/20 [07:26<01:51, 27.96s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 91.48:  80%|████████  | 16/20 [07:54<01:51, 27.96s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 91.48:  85%|████████▌ | 17/20 [07:54<01:23, 27.98s/it]
Task 0, Epoch 18/20 => Loss 0.354, Train_accy 92.50:  85%|████████▌ | 17/20 [08:22<01:23, 27.98s/it]
Task 0, Epoch 18/20 => Loss 0.354, Train_accy 92.50:  90%|█████████ | 18/20 [08:22<00:55, 27.96s/it]
Task 0, Epoch 19/20 => Loss 0.354, Train_accy 92.50:  90%|█████████ | 18/20 [08:50<00:55, 27.96s/it]
Task 0, Epoch 19/20 => Loss 0.354, Train_accy 92.50:  95%|█████████▌| 19/20 [08:50<00:27, 27.92s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65:  95%|█████████▌| 19/20 [09:18<00:27, 27.92s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65: 100%|██████████| 20/20 [09:18<00:00, 27.91s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65: 100%|██████████| 20/20 [09:18<00:00, 27.92s/it]
2024-09-06 04:49:20,564 [ease.py] => Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65
2024-09-06 04:49:39,187 [ease.py] => Task correct: 94.10774410774411
2024-09-06 04:49:39,187 [ease.py] => Task acc: 97.47474747474747
2024-09-06 04:49:39,206 [trainer.py] => No NME accuracy.
2024-09-06 04:49:39,206 [trainer.py] => CNN: {'total': 93.35, '00-99': 93.35, 'old': 0, 'new': 93.35}
2024-09-06 04:49:39,206 [trainer.py] => CNN top1 curve: [93.35]
2024-09-06 04:49:39,206 [trainer.py] => CNN top5 curve: [98.99]

Average Accuracy (CNN): 93.35
2024-09-06 04:49:39,206 [trainer.py] => Average Accuracy (CNN): 93.35 

2024-09-06 04:49:39,207 [trainer.py] => All params: 86256578
2024-09-06 04:49:39,207 [trainer.py] => Trainable params: 304320
2024-09-06 04:49:39,210 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.947, Train_accy 33.51:   0%|          | 0/20 [00:05<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.947, Train_accy 33.51:   5%|▌         | 1/20 [00:05<01:53,  5.95s/it]
Task 1, Epoch 2/20 => Loss 2.697, Train_accy 88.66:   5%|▌         | 1/20 [00:11<01:53,  5.95s/it]
Task 1, Epoch 2/20 => Loss 2.697, Train_accy 88.66:  10%|█         | 2/20 [00:11<01:47,  5.97s/it]
Task 1, Epoch 3/20 => Loss 2.083, Train_accy 93.91:  10%|█         | 2/20 [00:17<01:47,  5.97s/it]
Task 1, Epoch 3/20 => Loss 2.083, Train_accy 93.91:  15%|█▌        | 3/20 [00:17<01:41,  5.97s/it]
Task 1, Epoch 4/20 => Loss 1.292, Train_accy 94.54:  15%|█▌        | 3/20 [00:23<01:41,  5.97s/it]
Task 1, Epoch 4/20 => Loss 1.292, Train_accy 94.54:  20%|██        | 4/20 [00:23<01:35,  5.99s/it]
Task 1, Epoch 5/20 => Loss 0.749, Train_accy 94.54:  20%|██        | 4/20 [00:29<01:35,  5.99s/it]
Task 1, Epoch 5/20 => Loss 0.749, Train_accy 94.54:  25%|██▌       | 5/20 [00:29<01:29,  5.97s/it]
Task 1, Epoch 6/20 => Loss 0.497, Train_accy 95.38:  25%|██▌       | 5/20 [00:35<01:29,  5.97s/it]
Task 1, Epoch 6/20 => Loss 0.497, Train_accy 95.38:  30%|███       | 6/20 [00:35<01:23,  5.95s/it]
Task 1, Epoch 7/20 => Loss 0.392, Train_accy 95.17:  30%|███       | 6/20 [00:41<01:23,  5.95s/it]
Task 1, Epoch 7/20 => Loss 0.392, Train_accy 95.17:  35%|███▌      | 7/20 [00:41<01:17,  5.95s/it]
Task 1, Epoch 8/20 => Loss 0.372, Train_accy 94.43:  35%|███▌      | 7/20 [00:47<01:17,  5.95s/it]
Task 1, Epoch 8/20 => Loss 0.372, Train_accy 94.43:  40%|████      | 8/20 [00:47<01:11,  5.95s/it]
Task 1, Epoch 9/20 => Loss 0.292, Train_accy 95.38:  40%|████      | 8/20 [00:53<01:11,  5.95s/it]
Task 1, Epoch 9/20 => Loss 0.292, Train_accy 95.38:  45%|████▌     | 9/20 [00:53<01:05,  5.95s/it]
Task 1, Epoch 10/20 => Loss 0.276, Train_accy 95.17:  45%|████▌     | 9/20 [00:59<01:05,  5.95s/it]
Task 1, Epoch 10/20 => Loss 0.276, Train_accy 95.17:  50%|█████     | 10/20 [00:59<00:59,  5.94s/it]
Task 1, Epoch 11/20 => Loss 0.282, Train_accy 94.96:  50%|█████     | 10/20 [01:05<00:59,  5.94s/it]
Task 1, Epoch 11/20 => Loss 0.282, Train_accy 94.96:  55%|█████▌    | 11/20 [01:05<00:53,  5.95s/it]
Task 1, Epoch 12/20 => Loss 0.240, Train_accy 95.48:  55%|█████▌    | 11/20 [01:11<00:53,  5.95s/it]
Task 1, Epoch 12/20 => Loss 0.240, Train_accy 95.48:  60%|██████    | 12/20 [01:11<00:47,  5.95s/it]
Task 1, Epoch 13/20 => Loss 0.256, Train_accy 94.96:  60%|██████    | 12/20 [01:17<00:47,  5.95s/it]
Task 1, Epoch 13/20 => Loss 0.256, Train_accy 94.96:  65%|██████▌   | 13/20 [01:17<00:41,  5.95s/it]
Task 1, Epoch 14/20 => Loss 0.261, Train_accy 94.75:  65%|██████▌   | 13/20 [01:23<00:41,  5.95s/it]
Task 1, Epoch 14/20 => Loss 0.261, Train_accy 94.75:  70%|███████   | 14/20 [01:23<00:35,  5.97s/it]
Task 1, Epoch 15/20 => Loss 0.264, Train_accy 94.54:  70%|███████   | 14/20 [01:29<00:35,  5.97s/it]
Task 1, Epoch 15/20 => Loss 0.264, Train_accy 94.54:  75%|███████▌  | 15/20 [01:29<00:29,  5.97s/it]
Task 1, Epoch 16/20 => Loss 0.227, Train_accy 95.27:  75%|███████▌  | 15/20 [01:35<00:29,  5.97s/it]
Task 1, Epoch 16/20 => Loss 0.227, Train_accy 95.27:  80%|████████  | 16/20 [01:35<00:23,  5.97s/it]
Task 1, Epoch 17/20 => Loss 0.256, Train_accy 94.75:  80%|████████  | 16/20 [01:41<00:23,  5.97s/it]
Task 1, Epoch 17/20 => Loss 0.256, Train_accy 94.75:  85%|████████▌ | 17/20 [01:41<00:17,  5.97s/it]
Task 1, Epoch 18/20 => Loss 0.241, Train_accy 95.80:  85%|████████▌ | 17/20 [01:47<00:17,  5.97s/it]
Task 1, Epoch 18/20 => Loss 0.241, Train_accy 95.80:  90%|█████████ | 18/20 [01:47<00:11,  5.96s/it]
Task 1, Epoch 19/20 => Loss 0.222, Train_accy 96.11:  90%|█████████ | 18/20 [01:53<00:11,  5.96s/it]
Task 1, Epoch 19/20 => Loss 0.222, Train_accy 96.11:  95%|█████████▌| 19/20 [01:53<00:05,  5.96s/it]
Task 1, Epoch 20/20 => Loss 0.257, Train_accy 94.85:  95%|█████████▌| 19/20 [01:59<00:05,  5.96s/it]
Task 1, Epoch 20/20 => Loss 0.257, Train_accy 94.85: 100%|██████████| 20/20 [01:59<00:00,  5.96s/it]
Task 1, Epoch 20/20 => Loss 0.257, Train_accy 94.85: 100%|██████████| 20/20 [01:59<00:00,  5.96s/it]
2024-09-06 04:51:38,443 [ease.py] => Task 1, Epoch 20/20 => Loss 0.257, Train_accy 94.85
2024-09-06 04:51:53,909 [ease.py] => Task correct: 87.57062146892656
2024-09-06 04:51:53,910 [ease.py] => Task acc: 97.45762711864407
2024-09-06 04:51:53,934 [trainer.py] => No NME accuracy.
2024-09-06 04:51:53,934 [trainer.py] => CNN: {'total': 86.86, '00-99': 85.27, '100-119': 95.18, 'old': 85.27, 'new': 95.18}
2024-09-06 04:51:53,934 [trainer.py] => CNN top1 curve: [93.35, 86.86]
2024-09-06 04:51:53,934 [trainer.py] => CNN top5 curve: [98.99, 99.01]

Average Accuracy (CNN): 90.1
2024-09-06 04:51:53,934 [trainer.py] => Average Accuracy (CNN): 90.1 

2024-09-06 04:51:53,935 [trainer.py] => All params: 86302658
2024-09-06 04:51:53,936 [trainer.py] => Trainable params: 304320
2024-09-06 04:51:53,940 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.954, Train_accy 26.62:   0%|          | 0/20 [00:05<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.954, Train_accy 26.62:   5%|▌         | 1/20 [00:05<01:53,  5.95s/it]
Task 2, Epoch 2/20 => Loss 2.724, Train_accy 73.90:   5%|▌         | 1/20 [00:11<01:53,  5.95s/it]
Task 2, Epoch 2/20 => Loss 2.724, Train_accy 73.90:  10%|█         | 2/20 [00:11<01:47,  5.98s/it]
Task 2, Epoch 3/20 => Loss 2.217, Train_accy 79.56:  10%|█         | 2/20 [00:17<01:47,  5.98s/it]
Task 2, Epoch 3/20 => Loss 2.217, Train_accy 79.56:  15%|█▌        | 3/20 [00:17<01:41,  5.97s/it]
Task 2, Epoch 4/20 => Loss 1.516, Train_accy 85.12:  15%|█▌        | 3/20 [00:23<01:41,  5.97s/it]
Task 2, Epoch 4/20 => Loss 1.516, Train_accy 85.12:  20%|██        | 4/20 [00:23<01:35,  5.99s/it]
Task 2, Epoch 5/20 => Loss 1.057, Train_accy 86.58:  20%|██        | 4/20 [00:29<01:35,  5.99s/it]
Task 2, Epoch 5/20 => Loss 1.057, Train_accy 86.58:  25%|██▌       | 5/20 [00:29<01:29,  5.99s/it]
Task 2, Epoch 6/20 => Loss 0.764, Train_accy 88.78:  25%|██▌       | 5/20 [00:35<01:29,  5.99s/it]
Task 2, Epoch 6/20 => Loss 0.764, Train_accy 88.78:  30%|███       | 6/20 [00:35<01:23,  5.99s/it]
Task 2, Epoch 7/20 => Loss 0.630, Train_accy 87.84:  30%|███       | 6/20 [00:41<01:23,  5.99s/it]
Task 2, Epoch 7/20 => Loss 0.630, Train_accy 87.84:  35%|███▌      | 7/20 [00:41<01:17,  5.98s/it]
Task 2, Epoch 8/20 => Loss 0.535, Train_accy 89.62:  35%|███▌      | 7/20 [00:47<01:17,  5.98s/it]
Task 2, Epoch 8/20 => Loss 0.535, Train_accy 89.62:  40%|████      | 8/20 [00:47<01:11,  5.97s/it]
Task 2, Epoch 9/20 => Loss 0.506, Train_accy 90.25:  40%|████      | 8/20 [00:53<01:11,  5.97s/it]
Task 2, Epoch 9/20 => Loss 0.506, Train_accy 90.25:  45%|████▌     | 9/20 [00:53<01:05,  5.97s/it]
Task 2, Epoch 10/20 => Loss 0.448, Train_accy 90.67:  45%|████▌     | 9/20 [00:59<01:05,  5.97s/it]
Task 2, Epoch 10/20 => Loss 0.448, Train_accy 90.67:  50%|█████     | 10/20 [00:59<01:00,  6.03s/it]
Task 2, Epoch 11/20 => Loss 0.455, Train_accy 90.78:  50%|█████     | 10/20 [01:05<01:00,  6.03s/it]
Task 2, Epoch 11/20 => Loss 0.455, Train_accy 90.78:  55%|█████▌    | 11/20 [01:05<00:54,  6.00s/it]
Task 2, Epoch 12/20 => Loss 0.443, Train_accy 90.57:  55%|█████▌    | 11/20 [01:11<00:54,  6.00s/it]
Task 2, Epoch 12/20 => Loss 0.443, Train_accy 90.57:  60%|██████    | 12/20 [01:11<00:47,  5.99s/it]
Task 2, Epoch 13/20 => Loss 0.412, Train_accy 91.82:  60%|██████    | 12/20 [01:17<00:47,  5.99s/it]
Task 2, Epoch 13/20 => Loss 0.412, Train_accy 91.82:  65%|██████▌   | 13/20 [01:17<00:41,  5.99s/it]
Task 2, Epoch 14/20 => Loss 0.419, Train_accy 90.36:  65%|██████▌   | 13/20 [01:23<00:41,  5.99s/it]
Task 2, Epoch 14/20 => Loss 0.419, Train_accy 90.36:  70%|███████   | 14/20 [01:23<00:35,  5.99s/it]
Task 2, Epoch 15/20 => Loss 0.402, Train_accy 92.77:  70%|███████   | 14/20 [01:29<00:35,  5.99s/it]
Task 2, Epoch 15/20 => Loss 0.402, Train_accy 92.77:  75%|███████▌  | 15/20 [01:29<00:29,  5.98s/it]
Task 2, Epoch 16/20 => Loss 0.410, Train_accy 90.46:  75%|███████▌  | 15/20 [01:35<00:29,  5.98s/it]
Task 2, Epoch 16/20 => Loss 0.410, Train_accy 90.46:  80%|████████  | 16/20 [01:35<00:23,  5.98s/it]
Task 2, Epoch 17/20 => Loss 0.393, Train_accy 92.14:  80%|████████  | 16/20 [01:41<00:23,  5.98s/it]
Task 2, Epoch 17/20 => Loss 0.393, Train_accy 92.14:  85%|████████▌ | 17/20 [01:41<00:17,  5.98s/it]
Task 2, Epoch 18/20 => Loss 0.404, Train_accy 91.09:  85%|████████▌ | 17/20 [01:47<00:17,  5.98s/it]
Task 2, Epoch 18/20 => Loss 0.404, Train_accy 91.09:  90%|█████████ | 18/20 [01:47<00:11,  5.98s/it]
Task 2, Epoch 19/20 => Loss 0.387, Train_accy 91.40:  90%|█████████ | 18/20 [01:53<00:11,  5.98s/it]
Task 2, Epoch 19/20 => Loss 0.387, Train_accy 91.40:  95%|█████████▌| 19/20 [01:53<00:05,  5.98s/it]
Task 2, Epoch 20/20 => Loss 0.407, Train_accy 91.51:  95%|█████████▌| 19/20 [01:59<00:05,  5.98s/it]
Task 2, Epoch 20/20 => Loss 0.407, Train_accy 91.51: 100%|██████████| 20/20 [01:59<00:00,  5.98s/it]
Task 2, Epoch 20/20 => Loss 0.407, Train_accy 91.51: 100%|██████████| 20/20 [01:59<00:00,  5.98s/it]
2024-09-06 04:53:53,626 [ease.py] => Task 2, Epoch 20/20 => Loss 0.407, Train_accy 91.51
2024-09-06 04:54:18,496 [ease.py] => Task correct: 85.74040219378428
2024-09-06 04:54:18,496 [ease.py] => Task acc: 96.7702620353443
2024-09-06 04:54:18,519 [trainer.py] => No NME accuracy.
2024-09-06 04:54:18,519 [trainer.py] => CNN: {'total': 84.52, '00-99': 81.65, '100-119': 95.18, '120-139': 88.89, 'old': 83.83, 'new': 88.89}
2024-09-06 04:54:18,519 [trainer.py] => CNN top1 curve: [93.35, 86.86, 84.52]
2024-09-06 04:54:18,519 [trainer.py] => CNN top5 curve: [98.99, 99.01, 98.72]

Average Accuracy (CNN): 88.24
2024-09-06 04:54:18,520 [trainer.py] => Average Accuracy (CNN): 88.24 

2024-09-06 04:54:18,520 [trainer.py] => All params: 86440898
2024-09-06 04:54:18,521 [trainer.py] => Trainable params: 304320
2024-09-06 04:54:18,526 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.956, Train_accy 25.98:   0%|          | 0/20 [00:05<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.956, Train_accy 25.98:   5%|▌         | 1/20 [00:05<01:49,  5.75s/it]
Task 3, Epoch 2/20 => Loss 2.735, Train_accy 79.57:   5%|▌         | 1/20 [00:11<01:49,  5.75s/it]
Task 3, Epoch 2/20 => Loss 2.735, Train_accy 79.57:  10%|█         | 2/20 [00:11<01:43,  5.77s/it]
Task 3, Epoch 3/20 => Loss 2.222, Train_accy 87.83:  10%|█         | 2/20 [00:17<01:43,  5.77s/it]
Task 3, Epoch 3/20 => Loss 2.222, Train_accy 87.83:  15%|█▌        | 3/20 [00:17<01:37,  5.76s/it]
Task 3, Epoch 4/20 => Loss 1.471, Train_accy 91.96:  15%|█▌        | 3/20 [00:23<01:37,  5.76s/it]
Task 3, Epoch 4/20 => Loss 1.471, Train_accy 91.96:  20%|██        | 4/20 [00:23<01:32,  5.76s/it]
Task 3, Epoch 5/20 => Loss 0.933, Train_accy 92.72:  20%|██        | 4/20 [00:28<01:32,  5.76s/it]
Task 3, Epoch 5/20 => Loss 0.933, Train_accy 92.72:  25%|██▌       | 5/20 [00:28<01:26,  5.77s/it]
Task 3, Epoch 6/20 => Loss 0.633, Train_accy 92.50:  25%|██▌       | 5/20 [00:34<01:26,  5.77s/it]
Task 3, Epoch 6/20 => Loss 0.633, Train_accy 92.50:  30%|███       | 6/20 [00:34<01:20,  5.77s/it]
Task 3, Epoch 7/20 => Loss 0.496, Train_accy 93.59:  30%|███       | 6/20 [00:40<01:20,  5.77s/it]
Task 3, Epoch 7/20 => Loss 0.496, Train_accy 93.59:  35%|███▌      | 7/20 [00:40<01:14,  5.76s/it]
Task 3, Epoch 8/20 => Loss 0.455, Train_accy 92.72:  35%|███▌      | 7/20 [00:46<01:14,  5.76s/it]
Task 3, Epoch 8/20 => Loss 0.455, Train_accy 92.72:  40%|████      | 8/20 [00:46<01:09,  5.77s/it]
Task 3, Epoch 9/20 => Loss 0.385, Train_accy 94.35:  40%|████      | 8/20 [00:51<01:09,  5.77s/it]
Task 3, Epoch 9/20 => Loss 0.385, Train_accy 94.35:  45%|████▌     | 9/20 [00:51<01:03,  5.78s/it]
Task 3, Epoch 10/20 => Loss 0.375, Train_accy 92.83:  45%|████▌     | 9/20 [00:57<01:03,  5.78s/it]
Task 3, Epoch 10/20 => Loss 0.375, Train_accy 92.83:  50%|█████     | 10/20 [00:57<00:57,  5.79s/it]
Task 3, Epoch 11/20 => Loss 0.373, Train_accy 93.37:  50%|█████     | 10/20 [01:03<00:57,  5.79s/it]
Task 3, Epoch 11/20 => Loss 0.373, Train_accy 93.37:  55%|█████▌    | 11/20 [01:03<00:52,  5.79s/it]
Task 3, Epoch 12/20 => Loss 0.341, Train_accy 94.13:  55%|█████▌    | 11/20 [01:09<00:52,  5.79s/it]
Task 3, Epoch 12/20 => Loss 0.341, Train_accy 94.13:  60%|██████    | 12/20 [01:09<00:46,  5.78s/it]
Task 3, Epoch 13/20 => Loss 0.354, Train_accy 93.70:  60%|██████    | 12/20 [01:15<00:46,  5.78s/it]
Task 3, Epoch 13/20 => Loss 0.354, Train_accy 93.70:  65%|██████▌   | 13/20 [01:15<00:40,  5.79s/it]
Task 3, Epoch 14/20 => Loss 0.296, Train_accy 94.57:  65%|██████▌   | 13/20 [01:20<00:40,  5.79s/it]
Task 3, Epoch 14/20 => Loss 0.296, Train_accy 94.57:  70%|███████   | 14/20 [01:20<00:34,  5.79s/it]
Task 3, Epoch 15/20 => Loss 0.314, Train_accy 93.80:  70%|███████   | 14/20 [01:26<00:34,  5.79s/it]
Task 3, Epoch 15/20 => Loss 0.314, Train_accy 93.80:  75%|███████▌  | 15/20 [01:26<00:28,  5.80s/it]
Task 3, Epoch 16/20 => Loss 0.302, Train_accy 94.89:  75%|███████▌  | 15/20 [01:32<00:28,  5.80s/it]
Task 3, Epoch 16/20 => Loss 0.302, Train_accy 94.89:  80%|████████  | 16/20 [01:32<00:23,  5.79s/it]
Task 3, Epoch 17/20 => Loss 0.301, Train_accy 94.35:  80%|████████  | 16/20 [01:38<00:23,  5.79s/it]
Task 3, Epoch 17/20 => Loss 0.301, Train_accy 94.35:  85%|████████▌ | 17/20 [01:38<00:17,  5.77s/it]
Task 3, Epoch 18/20 => Loss 0.285, Train_accy 94.78:  85%|████████▌ | 17/20 [01:43<00:17,  5.77s/it]
Task 3, Epoch 18/20 => Loss 0.285, Train_accy 94.78:  90%|█████████ | 18/20 [01:43<00:11,  5.77s/it]
Task 3, Epoch 19/20 => Loss 0.286, Train_accy 94.67:  90%|█████████ | 18/20 [01:49<00:11,  5.77s/it]
Task 3, Epoch 19/20 => Loss 0.286, Train_accy 94.67:  95%|█████████▌| 19/20 [01:49<00:05,  5.77s/it]
Task 3, Epoch 20/20 => Loss 0.293, Train_accy 94.67:  95%|█████████▌| 19/20 [01:55<00:05,  5.77s/it]
Task 3, Epoch 20/20 => Loss 0.293, Train_accy 94.67: 100%|██████████| 20/20 [01:55<00:00,  5.77s/it]
Task 3, Epoch 20/20 => Loss 0.293, Train_accy 94.67: 100%|██████████| 20/20 [01:55<00:00,  5.78s/it]
2024-09-06 04:56:14,051 [ease.py] => Task 3, Epoch 20/20 => Loss 0.293, Train_accy 94.67
2024-09-06 04:56:49,553 [ease.py] => Task correct: 84.45267054468535
2024-09-06 04:56:49,554 [ease.py] => Task acc: 97.14436805922792
2024-09-06 04:56:49,579 [trainer.py] => No NME accuracy.
2024-09-06 04:56:49,579 [trainer.py] => CNN: {'total': 83.45, '00-99': 78.03, '100-119': 90.35, '120-139': 88.89, '140-159': 98.0, 'old': 81.23, 'new': 98.0}
2024-09-06 04:56:49,579 [trainer.py] => CNN top1 curve: [93.35, 86.86, 84.52, 83.45]
2024-09-06 04:56:49,579 [trainer.py] => CNN top5 curve: [98.99, 99.01, 98.72, 98.57]

Average Accuracy (CNN): 87.04
2024-09-06 04:56:49,579 [trainer.py] => Average Accuracy (CNN): 87.04 

2024-09-06 04:56:49,580 [trainer.py] => All params: 86609858
2024-09-06 04:56:49,581 [trainer.py] => Trainable params: 304320
2024-09-06 04:56:49,588 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.954, Train_accy 30.38:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.954, Train_accy 30.38:   5%|▌         | 1/20 [00:05<01:53,  5.98s/it]
Task 4, Epoch 2/20 => Loss 2.735, Train_accy 82.15:   5%|▌         | 1/20 [00:11<01:53,  5.98s/it]
Task 4, Epoch 2/20 => Loss 2.735, Train_accy 82.15:  10%|█         | 2/20 [00:11<01:47,  5.97s/it]
Task 4, Epoch 3/20 => Loss 2.217, Train_accy 90.81:  10%|█         | 2/20 [00:17<01:47,  5.97s/it]
Task 4, Epoch 3/20 => Loss 2.217, Train_accy 90.81:  15%|█▌        | 3/20 [00:17<01:41,  5.99s/it]
Task 4, Epoch 4/20 => Loss 1.463, Train_accy 93.11:  15%|█▌        | 3/20 [00:23<01:41,  5.99s/it]
Task 4, Epoch 4/20 => Loss 1.463, Train_accy 93.11:  20%|██        | 4/20 [00:23<01:35,  5.99s/it]
Task 4, Epoch 5/20 => Loss 0.932, Train_accy 93.53:  20%|██        | 4/20 [00:29<01:35,  5.99s/it]
Task 4, Epoch 5/20 => Loss 0.932, Train_accy 93.53:  25%|██▌       | 5/20 [00:29<01:29,  5.99s/it]
Task 4, Epoch 6/20 => Loss 0.633, Train_accy 93.74:  25%|██▌       | 5/20 [00:35<01:29,  5.99s/it]
Task 4, Epoch 6/20 => Loss 0.633, Train_accy 93.74:  30%|███       | 6/20 [00:35<01:23,  5.99s/it]
Task 4, Epoch 7/20 => Loss 0.517, Train_accy 93.32:  30%|███       | 6/20 [00:41<01:23,  5.99s/it]
Task 4, Epoch 7/20 => Loss 0.517, Train_accy 93.32:  35%|███▌      | 7/20 [00:41<01:17,  5.98s/it]
Task 4, Epoch 8/20 => Loss 0.442, Train_accy 92.28:  35%|███▌      | 7/20 [00:47<01:17,  5.98s/it]
Task 4, Epoch 8/20 => Loss 0.442, Train_accy 92.28:  40%|████      | 8/20 [00:47<01:11,  5.99s/it]
Task 4, Epoch 9/20 => Loss 0.359, Train_accy 95.30:  40%|████      | 8/20 [00:53<01:11,  5.99s/it]
Task 4, Epoch 9/20 => Loss 0.359, Train_accy 95.30:  45%|████▌     | 9/20 [00:53<01:05,  5.98s/it]
Task 4, Epoch 10/20 => Loss 0.365, Train_accy 93.95:  45%|████▌     | 9/20 [00:59<01:05,  5.98s/it]
Task 4, Epoch 10/20 => Loss 0.365, Train_accy 93.95:  50%|█████     | 10/20 [00:59<00:59,  5.99s/it]
Task 4, Epoch 11/20 => Loss 0.334, Train_accy 94.05:  50%|█████     | 10/20 [01:05<00:59,  5.99s/it]
Task 4, Epoch 11/20 => Loss 0.334, Train_accy 94.05:  55%|█████▌    | 11/20 [01:05<00:53,  5.99s/it]
Task 4, Epoch 12/20 => Loss 0.311, Train_accy 94.78:  55%|█████▌    | 11/20 [01:11<00:53,  5.99s/it]
Task 4, Epoch 12/20 => Loss 0.311, Train_accy 94.78:  60%|██████    | 12/20 [01:11<00:47,  5.99s/it]
Task 4, Epoch 13/20 => Loss 0.320, Train_accy 93.74:  60%|██████    | 12/20 [01:17<00:47,  5.99s/it]
Task 4, Epoch 13/20 => Loss 0.320, Train_accy 93.74:  65%|██████▌   | 13/20 [01:17<00:41,  5.99s/it]
Task 4, Epoch 14/20 => Loss 0.334, Train_accy 93.22:  65%|██████▌   | 13/20 [01:23<00:41,  5.99s/it]
Task 4, Epoch 14/20 => Loss 0.334, Train_accy 93.22:  70%|███████   | 14/20 [01:23<00:35,  5.99s/it]
Task 4, Epoch 15/20 => Loss 0.316, Train_accy 93.74:  70%|███████   | 14/20 [01:29<00:35,  5.99s/it]
Task 4, Epoch 15/20 => Loss 0.316, Train_accy 93.74:  75%|███████▌  | 15/20 [01:29<00:29,  5.99s/it]
Task 4, Epoch 16/20 => Loss 0.332, Train_accy 93.74:  75%|███████▌  | 15/20 [01:35<00:29,  5.99s/it]
Task 4, Epoch 16/20 => Loss 0.332, Train_accy 93.74:  80%|████████  | 16/20 [01:35<00:23,  6.00s/it]
Task 4, Epoch 17/20 => Loss 0.290, Train_accy 94.26:  80%|████████  | 16/20 [01:41<00:23,  6.00s/it]
Task 4, Epoch 17/20 => Loss 0.290, Train_accy 94.26:  85%|████████▌ | 17/20 [01:41<00:17,  5.99s/it]
Task 4, Epoch 18/20 => Loss 0.292, Train_accy 94.89:  85%|████████▌ | 17/20 [01:47<00:17,  5.99s/it]
Task 4, Epoch 18/20 => Loss 0.292, Train_accy 94.89:  90%|█████████ | 18/20 [01:47<00:11,  5.99s/it]
Task 4, Epoch 19/20 => Loss 0.305, Train_accy 94.05:  90%|█████████ | 18/20 [01:53<00:11,  5.99s/it]
Task 4, Epoch 19/20 => Loss 0.305, Train_accy 94.05:  95%|█████████▌| 19/20 [01:53<00:05,  5.99s/it]
Task 4, Epoch 20/20 => Loss 0.334, Train_accy 93.01:  95%|█████████▌| 19/20 [01:59<00:05,  5.99s/it]
Task 4, Epoch 20/20 => Loss 0.334, Train_accy 93.01: 100%|██████████| 20/20 [01:59<00:00,  6.00s/it]
Task 4, Epoch 20/20 => Loss 0.334, Train_accy 93.01: 100%|██████████| 20/20 [01:59<00:00,  5.99s/it]
2024-09-06 04:58:49,401 [ease.py] => Task 4, Epoch 20/20 => Loss 0.334, Train_accy 93.01
2024-09-06 04:59:37,717 [ease.py] => Task correct: 84.21052631578948
2024-09-06 04:59:37,718 [ease.py] => Task acc: 97.18045112781955
2024-09-06 04:59:37,743 [trainer.py] => No NME accuracy.
2024-09-06 04:59:37,743 [trainer.py] => CNN: {'total': 83.27, '00-99': 76.94, '100-119': 90.79, '120-139': 87.56, '140-159': 94.0, '160-179': 92.41, 'old': 82.13, 'new': 92.41}
2024-09-06 04:59:37,743 [trainer.py] => CNN top1 curve: [93.35, 86.86, 84.52, 83.45, 83.27]
2024-09-06 04:59:37,743 [trainer.py] => CNN top5 curve: [98.99, 99.01, 98.72, 98.57, 98.4]

Average Accuracy (CNN): 86.29
2024-09-06 04:59:37,743 [trainer.py] => Average Accuracy (CNN): 86.29 

2024-09-06 04:59:37,744 [trainer.py] => All params: 86809538
2024-09-06 04:59:37,745 [trainer.py] => Trainable params: 304320
2024-09-06 04:59:37,753 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.955, Train_accy 28.78:   0%|          | 0/20 [00:05<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.955, Train_accy 28.78:   5%|▌         | 1/20 [00:05<01:52,  5.93s/it]
Task 5, Epoch 2/20 => Loss 2.725, Train_accy 83.61:   5%|▌         | 1/20 [00:11<01:52,  5.93s/it]
Task 5, Epoch 2/20 => Loss 2.725, Train_accy 83.61:  10%|█         | 2/20 [00:11<01:47,  5.95s/it]
Task 5, Epoch 3/20 => Loss 2.180, Train_accy 88.97:  10%|█         | 2/20 [00:17<01:47,  5.95s/it]
Task 5, Epoch 3/20 => Loss 2.180, Train_accy 88.97:  15%|█▌        | 3/20 [00:17<01:41,  5.95s/it]
Task 5, Epoch 4/20 => Loss 1.406, Train_accy 91.81:  15%|█▌        | 3/20 [00:23<01:41,  5.95s/it]
Task 5, Epoch 4/20 => Loss 1.406, Train_accy 91.81:  20%|██        | 4/20 [00:23<01:35,  5.97s/it]
Task 5, Epoch 5/20 => Loss 0.878, Train_accy 92.12:  20%|██        | 4/20 [00:29<01:35,  5.97s/it]
Task 5, Epoch 5/20 => Loss 0.878, Train_accy 92.12:  25%|██▌       | 5/20 [00:29<01:29,  5.96s/it]
Task 5, Epoch 6/20 => Loss 0.591, Train_accy 91.07:  25%|██▌       | 5/20 [00:35<01:29,  5.96s/it]
Task 5, Epoch 6/20 => Loss 0.591, Train_accy 91.07:  30%|███       | 6/20 [00:35<01:23,  5.96s/it]
Task 5, Epoch 7/20 => Loss 0.458, Train_accy 92.75:  30%|███       | 6/20 [00:41<01:23,  5.96s/it]
Task 5, Epoch 7/20 => Loss 0.458, Train_accy 92.75:  35%|███▌      | 7/20 [00:41<01:17,  5.96s/it]
Task 5, Epoch 8/20 => Loss 0.421, Train_accy 92.54:  35%|███▌      | 7/20 [00:47<01:17,  5.96s/it]
Task 5, Epoch 8/20 => Loss 0.421, Train_accy 92.54:  40%|████      | 8/20 [00:47<01:11,  5.96s/it]
Task 5, Epoch 9/20 => Loss 0.377, Train_accy 92.86:  40%|████      | 8/20 [00:53<01:11,  5.96s/it]
Task 5, Epoch 9/20 => Loss 0.377, Train_accy 92.86:  45%|████▌     | 9/20 [00:53<01:05,  5.96s/it]
Task 5, Epoch 10/20 => Loss 0.349, Train_accy 93.38:  45%|████▌     | 9/20 [00:59<01:05,  5.96s/it]
Task 5, Epoch 10/20 => Loss 0.349, Train_accy 93.38:  50%|█████     | 10/20 [00:59<00:59,  5.96s/it]
Task 5, Epoch 11/20 => Loss 0.348, Train_accy 92.96:  50%|█████     | 10/20 [01:05<00:59,  5.96s/it]
Task 5, Epoch 11/20 => Loss 0.348, Train_accy 92.96:  55%|█████▌    | 11/20 [01:05<00:53,  5.95s/it]
Task 5, Epoch 12/20 => Loss 0.337, Train_accy 93.17:  55%|█████▌    | 11/20 [01:11<00:53,  5.95s/it]
Task 5, Epoch 12/20 => Loss 0.337, Train_accy 93.17:  60%|██████    | 12/20 [01:11<00:47,  5.94s/it]
Task 5, Epoch 13/20 => Loss 0.335, Train_accy 94.12:  60%|██████    | 12/20 [01:17<00:47,  5.94s/it]
Task 5, Epoch 13/20 => Loss 0.335, Train_accy 94.12:  65%|██████▌   | 13/20 [01:17<00:41,  5.94s/it]
Task 5, Epoch 14/20 => Loss 0.333, Train_accy 93.28:  65%|██████▌   | 13/20 [01:23<00:41,  5.94s/it]
Task 5, Epoch 14/20 => Loss 0.333, Train_accy 93.28:  70%|███████   | 14/20 [01:23<00:35,  5.94s/it]
Task 5, Epoch 15/20 => Loss 0.295, Train_accy 93.80:  70%|███████   | 14/20 [01:29<00:35,  5.94s/it]
Task 5, Epoch 15/20 => Loss 0.295, Train_accy 93.80:  75%|███████▌  | 15/20 [01:29<00:29,  5.94s/it]
Task 5, Epoch 16/20 => Loss 0.317, Train_accy 93.70:  75%|███████▌  | 15/20 [01:35<00:29,  5.94s/it]
Task 5, Epoch 16/20 => Loss 0.317, Train_accy 93.70:  80%|████████  | 16/20 [01:35<00:23,  5.94s/it]
Task 5, Epoch 17/20 => Loss 0.318, Train_accy 93.17:  80%|████████  | 16/20 [01:41<00:23,  5.94s/it]
Task 5, Epoch 17/20 => Loss 0.318, Train_accy 93.17:  85%|████████▌ | 17/20 [01:41<00:17,  5.94s/it]
Task 5, Epoch 18/20 => Loss 0.264, Train_accy 95.17:  85%|████████▌ | 17/20 [01:47<00:17,  5.94s/it]
Task 5, Epoch 18/20 => Loss 0.264, Train_accy 95.17:  90%|█████████ | 18/20 [01:47<00:11,  5.94s/it]
Task 5, Epoch 19/20 => Loss 0.311, Train_accy 93.07:  90%|█████████ | 18/20 [01:53<00:11,  5.94s/it]
Task 5, Epoch 19/20 => Loss 0.311, Train_accy 93.07:  95%|█████████▌| 19/20 [01:53<00:05,  5.94s/it]
Task 5, Epoch 20/20 => Loss 0.302, Train_accy 93.80:  95%|█████████▌| 19/20 [01:58<00:05,  5.94s/it]
Task 5, Epoch 20/20 => Loss 0.302, Train_accy 93.80: 100%|██████████| 20/20 [01:58<00:00,  5.94s/it]
Task 5, Epoch 20/20 => Loss 0.302, Train_accy 93.80: 100%|██████████| 20/20 [01:58<00:00,  5.95s/it]
2024-09-06 05:01:36,731 [ease.py] => Task 5, Epoch 20/20 => Loss 0.302, Train_accy 93.80
2024-09-06 05:02:38,669 [ease.py] => Task correct: 81.12807463952502
2024-09-06 05:02:38,669 [ease.py] => Task acc: 97.20101781170483
2024-09-06 05:02:38,694 [trainer.py] => No NME accuracy.
2024-09-06 05:02:38,694 [trainer.py] => CNN: {'total': 80.32, '00-99': 71.97, '100-119': 90.79, '120-139': 79.56, '140-159': 91.6, '160-179': 89.03, '180-199': 92.61, 'old': 78.99, 'new': 92.61}
2024-09-06 05:02:38,694 [trainer.py] => CNN top1 curve: [93.35, 86.86, 84.52, 83.45, 83.27, 80.32]
2024-09-06 05:02:38,694 [trainer.py] => CNN top5 curve: [98.99, 99.01, 98.72, 98.57, 98.4, 98.09]

Average Accuracy (CNN): 85.29
2024-09-06 05:02:38,694 [trainer.py] => Average Accuracy (CNN): 85.29 

Accuracy Matrix (CNN):
[[93.35 85.27 81.65 78.03 76.94 71.97]
 [ 0.   95.18 95.18 90.35 90.79 90.79]
 [ 0.    0.   88.89 88.89 87.56 79.56]
 [ 0.    0.    0.   98.   94.   91.6 ]
 [ 0.    0.    0.    0.   92.41 89.03]
 [ 0.    0.    0.    0.    0.   92.61]]
2024-09-06 05:02:38,695 [trainer.py] => Forgetting (CNN): 8.975999999999999
2024-09-06 05:02:41,264 [trainer.py] => config: ./exps/ease_cub_B100_Inc10.json
2024-09-06 05:02:41,264 [trainer.py] => prefix:  
2024-09-06 05:02:41,264 [trainer.py] => dataset: cub
2024-09-06 05:02:41,264 [trainer.py] => memory_size: 0
2024-09-06 05:02:41,264 [trainer.py] => memory_per_class: 0
2024-09-06 05:02:41,264 [trainer.py] => fixed_memory: False
2024-09-06 05:02:41,264 [trainer.py] => shuffle: True
2024-09-06 05:02:41,264 [trainer.py] => init_cls: 100
2024-09-06 05:02:41,264 [trainer.py] => increment: 10
2024-09-06 05:02:41,264 [trainer.py] => model_name: ease
2024-09-06 05:02:41,264 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-09-06 05:02:41,264 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-06 05:02:41,264 [trainer.py] => seed: 1993
2024-09-06 05:02:41,264 [trainer.py] => init_epochs: 20
2024-09-06 05:02:41,264 [trainer.py] => init_lr: 0.025
2024-09-06 05:02:41,264 [trainer.py] => later_epochs: 20
2024-09-06 05:02:41,265 [trainer.py] => later_lr: 0.025
2024-09-06 05:02:41,265 [trainer.py] => batch_size: 48
2024-09-06 05:02:41,265 [trainer.py] => weight_decay: 0.0005
2024-09-06 05:02:41,265 [trainer.py] => min_lr: 0
2024-09-06 05:02:41,265 [trainer.py] => optimizer: sgd
2024-09-06 05:02:41,265 [trainer.py] => scheduler: cosine
2024-09-06 05:02:41,265 [trainer.py] => pretrained: True
2024-09-06 05:02:41,265 [trainer.py] => vpt_type: Deep
2024-09-06 05:02:41,265 [trainer.py] => prompt_token_num: 5
2024-09-06 05:02:41,265 [trainer.py] => ffn_num: 16
2024-09-06 05:02:41,265 [trainer.py] => use_diagonal: False
2024-09-06 05:02:41,265 [trainer.py] => recalc_sim: True
2024-09-06 05:02:41,265 [trainer.py] => alpha: 0.1
2024-09-06 05:02:41,265 [trainer.py] => use_init_ptm: False
2024-09-06 05:02:41,265 [trainer.py] => beta: 0
2024-09-06 05:02:41,265 [trainer.py] => use_old_data: False
2024-09-06 05:02:41,265 [trainer.py] => use_reweight: True
2024-09-06 05:02:41,265 [trainer.py] => moni_adam: False
2024-09-06 05:02:41,265 [trainer.py] => adapter_num: -1
2024-09-06 05:02:41,301 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
After BaseNet initialization.
2024-09-06 05:02:44,138 [trainer.py] => All params: 86102976
2024-09-06 05:02:44,139 [trainer.py] => Trainable params: 304320
2024-09-06 05:02:44,147 [ease.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.406, Train_accy 34.26:   0%|          | 0/20 [00:28<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.406, Train_accy 34.26:   5%|▌         | 1/20 [00:28<08:52, 28.05s/it]
Task 0, Epoch 2/20 => Loss 2.039, Train_accy 75.31:   5%|▌         | 1/20 [00:55<08:52, 28.05s/it]
Task 0, Epoch 2/20 => Loss 2.039, Train_accy 75.31:  10%|█         | 2/20 [00:55<08:23, 27.97s/it]
Task 0, Epoch 3/20 => Loss 0.720, Train_accy 85.92:  10%|█         | 2/20 [01:23<08:23, 27.97s/it]
Task 0, Epoch 3/20 => Loss 0.720, Train_accy 85.92:  15%|█▌        | 3/20 [01:23<07:55, 27.95s/it]
Task 0, Epoch 4/20 => Loss 0.598, Train_accy 87.07:  15%|█▌        | 3/20 [01:51<07:55, 27.95s/it]
Task 0, Epoch 4/20 => Loss 0.598, Train_accy 87.07:  20%|██        | 4/20 [01:51<07:26, 27.92s/it]
Task 0, Epoch 5/20 => Loss 0.552, Train_accy 87.77:  20%|██        | 4/20 [02:19<07:26, 27.92s/it]
Task 0, Epoch 5/20 => Loss 0.552, Train_accy 87.77:  25%|██▌       | 5/20 [02:19<06:58, 27.92s/it]
Task 0, Epoch 6/20 => Loss 0.509, Train_accy 88.37:  25%|██▌       | 5/20 [02:47<06:58, 27.92s/it]
Task 0, Epoch 6/20 => Loss 0.509, Train_accy 88.37:  30%|███       | 6/20 [02:47<06:30, 27.92s/it]
Task 0, Epoch 7/20 => Loss 0.485, Train_accy 89.03:  30%|███       | 6/20 [03:15<06:30, 27.92s/it]
Task 0, Epoch 7/20 => Loss 0.485, Train_accy 89.03:  35%|███▌      | 7/20 [03:15<06:03, 27.94s/it]
Task 0, Epoch 8/20 => Loss 0.450, Train_accy 89.71:  35%|███▌      | 7/20 [03:43<06:03, 27.94s/it]
Task 0, Epoch 8/20 => Loss 0.450, Train_accy 89.71:  40%|████      | 8/20 [03:43<05:35, 27.92s/it]
Task 0, Epoch 9/20 => Loss 0.426, Train_accy 90.31:  40%|████      | 8/20 [04:11<05:35, 27.92s/it]
Task 0, Epoch 9/20 => Loss 0.426, Train_accy 90.31:  45%|████▌     | 9/20 [04:11<05:07, 27.96s/it]
Task 0, Epoch 10/20 => Loss 0.420, Train_accy 90.33:  45%|████▌     | 9/20 [04:39<05:07, 27.96s/it]
Task 0, Epoch 10/20 => Loss 0.420, Train_accy 90.33:  50%|█████     | 10/20 [04:39<04:39, 27.92s/it]
Task 0, Epoch 11/20 => Loss 0.406, Train_accy 91.03:  50%|█████     | 10/20 [05:07<04:39, 27.92s/it]
Task 0, Epoch 11/20 => Loss 0.406, Train_accy 91.03:  55%|█████▌    | 11/20 [05:07<04:11, 27.91s/it]
Task 0, Epoch 12/20 => Loss 0.421, Train_accy 89.97:  55%|█████▌    | 11/20 [05:35<04:11, 27.91s/it]
Task 0, Epoch 12/20 => Loss 0.421, Train_accy 89.97:  60%|██████    | 12/20 [05:35<03:43, 27.93s/it]
Task 0, Epoch 13/20 => Loss 0.389, Train_accy 91.10:  60%|██████    | 12/20 [06:03<03:43, 27.93s/it]
Task 0, Epoch 13/20 => Loss 0.389, Train_accy 91.10:  65%|██████▌   | 13/20 [06:03<03:15, 27.93s/it]
Task 0, Epoch 14/20 => Loss 0.383, Train_accy 91.14:  65%|██████▌   | 13/20 [06:31<03:15, 27.93s/it]
Task 0, Epoch 14/20 => Loss 0.383, Train_accy 91.14:  70%|███████   | 14/20 [06:31<02:47, 27.92s/it]
Task 0, Epoch 15/20 => Loss 0.377, Train_accy 91.78:  70%|███████   | 14/20 [06:58<02:47, 27.92s/it]
Task 0, Epoch 15/20 => Loss 0.377, Train_accy 91.78:  75%|███████▌  | 15/20 [06:58<02:19, 27.92s/it]
Task 0, Epoch 16/20 => Loss 0.380, Train_accy 91.44:  75%|███████▌  | 15/20 [07:26<02:19, 27.92s/it]
Task 0, Epoch 16/20 => Loss 0.380, Train_accy 91.44:  80%|████████  | 16/20 [07:26<01:51, 27.92s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 91.48:  80%|████████  | 16/20 [07:54<01:51, 27.92s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 91.48:  85%|████████▌ | 17/20 [07:54<01:23, 27.96s/it]
Task 0, Epoch 18/20 => Loss 0.354, Train_accy 92.50:  85%|████████▌ | 17/20 [08:22<01:23, 27.96s/it]
Task 0, Epoch 18/20 => Loss 0.354, Train_accy 92.50:  90%|█████████ | 18/20 [08:22<00:55, 27.93s/it]
Task 0, Epoch 19/20 => Loss 0.354, Train_accy 92.50:  90%|█████████ | 18/20 [08:50<00:55, 27.93s/it]
Task 0, Epoch 19/20 => Loss 0.354, Train_accy 92.50:  95%|█████████▌| 19/20 [08:50<00:27, 27.95s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65:  95%|█████████▌| 19/20 [09:18<00:27, 27.95s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65: 100%|██████████| 20/20 [09:18<00:00, 27.91s/it]
Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65: 100%|██████████| 20/20 [09:18<00:00, 27.93s/it]
2024-09-06 05:12:02,817 [ease.py] => Task 0, Epoch 20/20 => Loss 0.366, Train_accy 91.65
2024-09-06 05:12:21,438 [ease.py] => Task correct: 93.77104377104376
2024-09-06 05:12:21,439 [ease.py] => Task acc: 98.56902356902357
2024-09-06 05:12:21,459 [trainer.py] => No NME accuracy.
2024-09-06 05:12:21,460 [trainer.py] => CNN: {'total': 93.35, '00-99': 93.35, 'old': 0, 'new': 93.35}
2024-09-06 05:12:21,460 [trainer.py] => CNN top1 curve: [93.35]
2024-09-06 05:12:21,460 [trainer.py] => CNN top5 curve: [98.99]

Average Accuracy (CNN): 93.35
2024-09-06 05:12:21,460 [trainer.py] => Average Accuracy (CNN): 93.35 

2024-09-06 05:12:21,460 [trainer.py] => All params: 86256578
2024-09-06 05:12:21,461 [trainer.py] => Trainable params: 304320
2024-09-06 05:12:21,463 [ease.py] => Learning on 100-110

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.275, Train_accy 29.73:   0%|          | 0/20 [00:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.275, Train_accy 29.73:   5%|▌         | 1/20 [00:03<01:02,  3.30s/it]
Task 1, Epoch 2/20 => Loss 2.114, Train_accy 85.86:   5%|▌         | 1/20 [00:06<01:02,  3.30s/it]
Task 1, Epoch 2/20 => Loss 2.114, Train_accy 85.86:  10%|█         | 2/20 [00:06<00:58,  3.25s/it]
Task 1, Epoch 3/20 => Loss 1.843, Train_accy 88.57:  10%|█         | 2/20 [00:09<00:58,  3.25s/it]
Task 1, Epoch 3/20 => Loss 1.843, Train_accy 88.57:  15%|█▌        | 3/20 [00:09<00:55,  3.27s/it]
Task 1, Epoch 4/20 => Loss 1.457, Train_accy 92.93:  15%|█▌        | 3/20 [00:13<00:55,  3.27s/it]
Task 1, Epoch 4/20 => Loss 1.457, Train_accy 92.93:  20%|██        | 4/20 [00:13<00:52,  3.27s/it]
Task 1, Epoch 5/20 => Loss 1.095, Train_accy 95.22:  20%|██        | 4/20 [00:16<00:52,  3.27s/it]
Task 1, Epoch 5/20 => Loss 1.095, Train_accy 95.22:  25%|██▌       | 5/20 [00:16<00:48,  3.25s/it]
Task 1, Epoch 6/20 => Loss 0.816, Train_accy 94.39:  25%|██▌       | 5/20 [00:19<00:48,  3.25s/it]
Task 1, Epoch 6/20 => Loss 0.816, Train_accy 94.39:  30%|███       | 6/20 [00:19<00:45,  3.23s/it]
Task 1, Epoch 7/20 => Loss 0.651, Train_accy 96.26:  30%|███       | 6/20 [00:22<00:45,  3.23s/it]
Task 1, Epoch 7/20 => Loss 0.651, Train_accy 96.26:  35%|███▌      | 7/20 [00:22<00:41,  3.23s/it]
Task 1, Epoch 8/20 => Loss 0.499, Train_accy 96.47:  35%|███▌      | 7/20 [00:25<00:41,  3.23s/it]
Task 1, Epoch 8/20 => Loss 0.499, Train_accy 96.47:  40%|████      | 8/20 [00:25<00:38,  3.23s/it]
Task 1, Epoch 9/20 => Loss 0.439, Train_accy 96.88:  40%|████      | 8/20 [00:29<00:38,  3.23s/it]
Task 1, Epoch 9/20 => Loss 0.439, Train_accy 96.88:  45%|████▌     | 9/20 [00:29<00:35,  3.23s/it]
Task 1, Epoch 10/20 => Loss 0.377, Train_accy 97.30:  45%|████▌     | 9/20 [00:32<00:35,  3.23s/it]
Task 1, Epoch 10/20 => Loss 0.377, Train_accy 97.30:  50%|█████     | 10/20 [00:32<00:32,  3.24s/it]
Task 1, Epoch 11/20 => Loss 0.327, Train_accy 97.71:  50%|█████     | 10/20 [00:35<00:32,  3.24s/it]
Task 1, Epoch 11/20 => Loss 0.327, Train_accy 97.71:  55%|█████▌    | 11/20 [00:35<00:29,  3.23s/it]
Task 1, Epoch 12/20 => Loss 0.296, Train_accy 97.51:  55%|█████▌    | 11/20 [00:38<00:29,  3.23s/it]
Task 1, Epoch 12/20 => Loss 0.296, Train_accy 97.51:  60%|██████    | 12/20 [00:38<00:25,  3.22s/it]
Task 1, Epoch 13/20 => Loss 0.288, Train_accy 96.88:  60%|██████    | 12/20 [00:42<00:25,  3.22s/it]
Task 1, Epoch 13/20 => Loss 0.288, Train_accy 96.88:  65%|██████▌   | 13/20 [00:42<00:22,  3.21s/it]
Task 1, Epoch 14/20 => Loss 0.286, Train_accy 95.63:  65%|██████▌   | 13/20 [00:45<00:22,  3.21s/it]
Task 1, Epoch 14/20 => Loss 0.286, Train_accy 95.63:  70%|███████   | 14/20 [00:45<00:19,  3.21s/it]
Task 1, Epoch 15/20 => Loss 0.249, Train_accy 97.92:  70%|███████   | 14/20 [00:48<00:19,  3.21s/it]
Task 1, Epoch 15/20 => Loss 0.249, Train_accy 97.92:  75%|███████▌  | 15/20 [00:48<00:16,  3.23s/it]
Task 1, Epoch 16/20 => Loss 0.269, Train_accy 95.84:  75%|███████▌  | 15/20 [00:51<00:16,  3.23s/it]
Task 1, Epoch 16/20 => Loss 0.269, Train_accy 95.84:  80%|████████  | 16/20 [00:51<00:12,  3.24s/it]
Task 1, Epoch 17/20 => Loss 0.332, Train_accy 96.67:  80%|████████  | 16/20 [00:54<00:12,  3.24s/it]
Task 1, Epoch 17/20 => Loss 0.332, Train_accy 96.67:  85%|████████▌ | 17/20 [00:54<00:09,  3.23s/it]
Task 1, Epoch 18/20 => Loss 0.396, Train_accy 97.30:  85%|████████▌ | 17/20 [00:58<00:09,  3.23s/it]
Task 1, Epoch 18/20 => Loss 0.396, Train_accy 97.30:  90%|█████████ | 18/20 [00:58<00:06,  3.25s/it]
Task 1, Epoch 19/20 => Loss 0.225, Train_accy 96.88:  90%|█████████ | 18/20 [01:01<00:06,  3.25s/it]
Task 1, Epoch 19/20 => Loss 0.225, Train_accy 96.88:  95%|█████████▌| 19/20 [01:01<00:03,  3.24s/it]
Task 1, Epoch 20/20 => Loss 0.261, Train_accy 96.05:  95%|█████████▌| 19/20 [01:04<00:03,  3.24s/it]
Task 1, Epoch 20/20 => Loss 0.261, Train_accy 96.05: 100%|██████████| 20/20 [01:04<00:00,  3.23s/it]
Task 1, Epoch 20/20 => Loss 0.261, Train_accy 96.05: 100%|██████████| 20/20 [01:04<00:00,  3.23s/it]
2024-09-06 05:13:26,161 [ease.py] => Task 1, Epoch 20/20 => Loss 0.261, Train_accy 96.05
2024-09-06 05:13:38,044 [ease.py] => Task correct: 93.32310053722179
2024-09-06 05:13:38,045 [ease.py] => Task acc: 98.61857252494244
2024-09-06 05:13:38,069 [trainer.py] => No NME accuracy.
2024-09-06 05:13:38,069 [trainer.py] => CNN: {'total': 92.94, '00-99': 92.68, '100-109': 95.65, 'old': 92.68, 'new': 95.65}
2024-09-06 05:13:38,069 [trainer.py] => CNN top1 curve: [93.35, 92.94]
2024-09-06 05:13:38,069 [trainer.py] => CNN top5 curve: [98.99, 99.08]

Average Accuracy (CNN): 93.14
2024-09-06 05:13:38,069 [trainer.py] => Average Accuracy (CNN): 93.14 

2024-09-06 05:13:38,070 [trainer.py] => All params: 86279618
2024-09-06 05:13:38,071 [trainer.py] => Trainable params: 304320
2024-09-06 05:13:38,073 [ease.py] => Learning on 110-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.276, Train_accy 24.63:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.276, Train_accy 24.63:   5%|▌         | 1/20 [00:03<00:58,  3.10s/it]
Task 2, Epoch 2/20 => Loss 2.138, Train_accy 88.54:   5%|▌         | 1/20 [00:06<00:58,  3.10s/it]
Task 2, Epoch 2/20 => Loss 2.138, Train_accy 88.54:  10%|█         | 2/20 [00:06<00:56,  3.12s/it]
Task 2, Epoch 3/20 => Loss 1.908, Train_accy 94.48:  10%|█         | 2/20 [00:09<00:56,  3.12s/it]
Task 2, Epoch 3/20 => Loss 1.908, Train_accy 94.48:  15%|█▌        | 3/20 [00:09<00:52,  3.12s/it]
Task 2, Epoch 4/20 => Loss 1.588, Train_accy 95.97:  15%|█▌        | 3/20 [00:12<00:52,  3.12s/it]
Task 2, Epoch 4/20 => Loss 1.588, Train_accy 95.97:  20%|██        | 4/20 [00:12<00:50,  3.15s/it]
Task 2, Epoch 5/20 => Loss 1.220, Train_accy 96.60:  20%|██        | 4/20 [00:15<00:50,  3.15s/it]
Task 2, Epoch 5/20 => Loss 1.220, Train_accy 96.60:  25%|██▌       | 5/20 [00:15<00:47,  3.14s/it]
Task 2, Epoch 6/20 => Loss 0.909, Train_accy 97.66:  25%|██▌       | 5/20 [00:18<00:47,  3.14s/it]
Task 2, Epoch 6/20 => Loss 0.909, Train_accy 97.66:  30%|███       | 6/20 [00:18<00:43,  3.13s/it]
Task 2, Epoch 7/20 => Loss 0.770, Train_accy 95.54:  30%|███       | 6/20 [00:21<00:43,  3.13s/it]
Task 2, Epoch 7/20 => Loss 0.770, Train_accy 95.54:  35%|███▌      | 7/20 [00:21<00:40,  3.13s/it]
Task 2, Epoch 8/20 => Loss 0.599, Train_accy 97.45:  35%|███▌      | 7/20 [00:25<00:40,  3.13s/it]
Task 2, Epoch 8/20 => Loss 0.599, Train_accy 97.45:  40%|████      | 8/20 [00:25<00:37,  3.12s/it]
Task 2, Epoch 9/20 => Loss 0.534, Train_accy 96.39:  40%|████      | 8/20 [00:28<00:37,  3.12s/it]
Task 2, Epoch 9/20 => Loss 0.534, Train_accy 96.39:  45%|████▌     | 9/20 [00:28<00:34,  3.12s/it]
Task 2, Epoch 10/20 => Loss 0.442, Train_accy 97.24:  45%|████▌     | 9/20 [00:31<00:34,  3.12s/it]
Task 2, Epoch 10/20 => Loss 0.442, Train_accy 97.24:  50%|█████     | 10/20 [00:31<00:31,  3.19s/it]
Task 2, Epoch 11/20 => Loss 0.439, Train_accy 95.54:  50%|█████     | 10/20 [00:34<00:31,  3.19s/it]
Task 2, Epoch 11/20 => Loss 0.439, Train_accy 95.54:  55%|█████▌    | 11/20 [00:34<00:28,  3.19s/it]
Task 2, Epoch 12/20 => Loss 0.377, Train_accy 96.39:  55%|█████▌    | 11/20 [00:37<00:28,  3.19s/it]
Task 2, Epoch 12/20 => Loss 0.377, Train_accy 96.39:  60%|██████    | 12/20 [00:37<00:25,  3.16s/it]
Task 2, Epoch 13/20 => Loss 0.379, Train_accy 95.12:  60%|██████    | 12/20 [00:40<00:25,  3.16s/it]
Task 2, Epoch 13/20 => Loss 0.379, Train_accy 95.12:  65%|██████▌   | 13/20 [00:40<00:22,  3.15s/it]
Task 2, Epoch 14/20 => Loss 0.324, Train_accy 97.66:  65%|██████▌   | 13/20 [00:43<00:22,  3.15s/it]
Task 2, Epoch 14/20 => Loss 0.324, Train_accy 97.66:  70%|███████   | 14/20 [00:43<00:18,  3.14s/it]
Task 2, Epoch 15/20 => Loss 0.329, Train_accy 96.82:  70%|███████   | 14/20 [00:47<00:18,  3.14s/it]
Task 2, Epoch 15/20 => Loss 0.329, Train_accy 96.82:  75%|███████▌  | 15/20 [00:47<00:15,  3.13s/it]
Task 2, Epoch 16/20 => Loss 0.303, Train_accy 97.24:  75%|███████▌  | 15/20 [00:50<00:15,  3.13s/it]
Task 2, Epoch 16/20 => Loss 0.303, Train_accy 97.24:  80%|████████  | 16/20 [00:50<00:12,  3.13s/it]
Task 2, Epoch 17/20 => Loss 0.321, Train_accy 97.45:  80%|████████  | 16/20 [00:53<00:12,  3.13s/it]
Task 2, Epoch 17/20 => Loss 0.321, Train_accy 97.45:  85%|████████▌ | 17/20 [00:53<00:09,  3.13s/it]
Task 2, Epoch 18/20 => Loss 0.311, Train_accy 96.60:  85%|████████▌ | 17/20 [00:56<00:09,  3.13s/it]
Task 2, Epoch 18/20 => Loss 0.311, Train_accy 96.60:  90%|█████████ | 18/20 [00:56<00:06,  3.13s/it]
Task 2, Epoch 19/20 => Loss 0.318, Train_accy 97.03:  90%|█████████ | 18/20 [00:59<00:06,  3.13s/it]
Task 2, Epoch 19/20 => Loss 0.318, Train_accy 97.03:  95%|█████████▌| 19/20 [00:59<00:03,  3.13s/it]
Task 2, Epoch 20/20 => Loss 0.279, Train_accy 97.88:  95%|█████████▌| 19/20 [01:02<00:03,  3.13s/it]
Task 2, Epoch 20/20 => Loss 0.279, Train_accy 97.88: 100%|██████████| 20/20 [01:02<00:00,  3.12s/it]
Task 2, Epoch 20/20 => Loss 0.279, Train_accy 97.88: 100%|██████████| 20/20 [01:02<00:00,  3.14s/it]
2024-09-06 05:14:40,796 [ease.py] => Task 2, Epoch 20/20 => Loss 0.279, Train_accy 97.88
2024-09-06 05:14:59,143 [ease.py] => Task correct: 89.75988700564972
2024-09-06 05:14:59,144 [ease.py] => Task acc: 98.58757062146893
2024-09-06 05:14:59,169 [trainer.py] => No NME accuracy.
2024-09-06 05:14:59,169 [trainer.py] => CNN: {'total': 89.48, '00-99': 88.64, '100-109': 95.65, '110-119': 92.04, 'old': 89.26, 'new': 92.04}
2024-09-06 05:14:59,169 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48]
2024-09-06 05:14:59,169 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87]

Average Accuracy (CNN): 91.92
2024-09-06 05:14:59,169 [trainer.py] => Average Accuracy (CNN): 91.92 

2024-09-06 05:14:59,170 [trainer.py] => All params: 86387138
2024-09-06 05:14:59,170 [trainer.py] => Trainable params: 304320
2024-09-06 05:14:59,174 [ease.py] => Learning on 120-130

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.273, Train_accy 31.12:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.273, Train_accy 31.12:   5%|▌         | 1/20 [00:03<01:01,  3.22s/it]
Task 3, Epoch 2/20 => Loss 2.127, Train_accy 78.22:   5%|▌         | 1/20 [00:06<01:01,  3.22s/it]
Task 3, Epoch 2/20 => Loss 2.127, Train_accy 78.22:  10%|█         | 2/20 [00:06<00:57,  3.22s/it]
Task 3, Epoch 3/20 => Loss 1.872, Train_accy 85.06:  10%|█         | 2/20 [00:09<00:57,  3.22s/it]
Task 3, Epoch 3/20 => Loss 1.872, Train_accy 85.06:  15%|█▌        | 3/20 [00:09<00:54,  3.21s/it]
Task 3, Epoch 4/20 => Loss 1.577, Train_accy 86.31:  15%|█▌        | 3/20 [00:12<00:54,  3.21s/it]
Task 3, Epoch 4/20 => Loss 1.577, Train_accy 86.31:  20%|██        | 4/20 [00:12<00:51,  3.21s/it]
Task 3, Epoch 5/20 => Loss 1.235, Train_accy 86.51:  20%|██        | 4/20 [00:16<00:51,  3.21s/it]
Task 3, Epoch 5/20 => Loss 1.235, Train_accy 86.51:  25%|██▌       | 5/20 [00:16<00:48,  3.21s/it]
Task 3, Epoch 6/20 => Loss 0.966, Train_accy 87.14:  25%|██▌       | 5/20 [00:19<00:48,  3.21s/it]
Task 3, Epoch 6/20 => Loss 0.966, Train_accy 87.14:  30%|███       | 6/20 [00:19<00:44,  3.21s/it]
Task 3, Epoch 7/20 => Loss 0.800, Train_accy 89.00:  30%|███       | 6/20 [00:22<00:44,  3.21s/it]
Task 3, Epoch 7/20 => Loss 0.800, Train_accy 89.00:  35%|███▌      | 7/20 [00:22<00:41,  3.22s/it]
Task 3, Epoch 8/20 => Loss 0.708, Train_accy 86.31:  35%|███▌      | 7/20 [00:25<00:41,  3.22s/it]
Task 3, Epoch 8/20 => Loss 0.708, Train_accy 86.31:  40%|████      | 8/20 [00:25<00:38,  3.22s/it]
Task 3, Epoch 9/20 => Loss 0.618, Train_accy 88.59:  40%|████      | 8/20 [00:28<00:38,  3.22s/it]
Task 3, Epoch 9/20 => Loss 0.618, Train_accy 88.59:  45%|████▌     | 9/20 [00:28<00:35,  3.22s/it]
Task 3, Epoch 10/20 => Loss 0.616, Train_accy 88.38:  45%|████▌     | 9/20 [00:32<00:35,  3.22s/it]
Task 3, Epoch 10/20 => Loss 0.616, Train_accy 88.38:  50%|█████     | 10/20 [00:32<00:32,  3.22s/it]
Task 3, Epoch 11/20 => Loss 0.455, Train_accy 92.53:  50%|█████     | 10/20 [00:35<00:32,  3.22s/it]
Task 3, Epoch 11/20 => Loss 0.455, Train_accy 92.53:  55%|█████▌    | 11/20 [00:35<00:28,  3.22s/it]
Task 3, Epoch 12/20 => Loss 0.439, Train_accy 93.57:  55%|█████▌    | 11/20 [00:38<00:28,  3.22s/it]
Task 3, Epoch 12/20 => Loss 0.439, Train_accy 93.57:  60%|██████    | 12/20 [00:38<00:25,  3.22s/it]
Task 3, Epoch 13/20 => Loss 0.429, Train_accy 93.78:  60%|██████    | 12/20 [00:41<00:25,  3.22s/it]
Task 3, Epoch 13/20 => Loss 0.429, Train_accy 93.78:  65%|██████▌   | 13/20 [00:41<00:22,  3.21s/it]
Task 3, Epoch 14/20 => Loss 0.407, Train_accy 92.53:  65%|██████▌   | 13/20 [00:44<00:22,  3.21s/it]
Task 3, Epoch 14/20 => Loss 0.407, Train_accy 92.53:  70%|███████   | 14/20 [00:44<00:19,  3.21s/it]
Task 3, Epoch 15/20 => Loss 0.400, Train_accy 94.61:  70%|███████   | 14/20 [00:48<00:19,  3.21s/it]
Task 3, Epoch 15/20 => Loss 0.400, Train_accy 94.61:  75%|███████▌  | 15/20 [00:48<00:16,  3.22s/it]
Task 3, Epoch 16/20 => Loss 0.347, Train_accy 93.78:  75%|███████▌  | 15/20 [00:51<00:16,  3.22s/it]
Task 3, Epoch 16/20 => Loss 0.347, Train_accy 93.78:  80%|████████  | 16/20 [00:51<00:12,  3.22s/it]
Task 3, Epoch 17/20 => Loss 0.374, Train_accy 92.95:  80%|████████  | 16/20 [00:54<00:12,  3.22s/it]
Task 3, Epoch 17/20 => Loss 0.374, Train_accy 92.95:  85%|████████▌ | 17/20 [00:54<00:09,  3.22s/it]
Task 3, Epoch 18/20 => Loss 0.448, Train_accy 91.91:  85%|████████▌ | 17/20 [00:57<00:09,  3.22s/it]
Task 3, Epoch 18/20 => Loss 0.448, Train_accy 91.91:  90%|█████████ | 18/20 [00:57<00:06,  3.23s/it]
Task 3, Epoch 19/20 => Loss 0.329, Train_accy 96.06:  90%|█████████ | 18/20 [01:01<00:06,  3.23s/it]
Task 3, Epoch 19/20 => Loss 0.329, Train_accy 96.06:  95%|█████████▌| 19/20 [01:01<00:03,  3.23s/it]
Task 3, Epoch 20/20 => Loss 0.389, Train_accy 93.98:  95%|█████████▌| 19/20 [01:04<00:03,  3.23s/it]
Task 3, Epoch 20/20 => Loss 0.389, Train_accy 93.98: 100%|██████████| 20/20 [01:04<00:00,  3.22s/it]
Task 3, Epoch 20/20 => Loss 0.389, Train_accy 93.98: 100%|██████████| 20/20 [01:04<00:00,  3.22s/it]
2024-09-06 05:16:03,516 [ease.py] => Task 3, Epoch 20/20 => Loss 0.389, Train_accy 93.98
2024-09-06 05:16:29,120 [ease.py] => Task correct: 87.78726198292843
2024-09-06 05:16:29,121 [ease.py] => Task acc: 98.35850295469469
2024-09-06 05:16:29,142 [trainer.py] => No NME accuracy.
2024-09-06 05:16:29,142 [trainer.py] => CNN: {'total': 87.52, '00-99': 86.2, '100-109': 94.78, '110-119': 90.27, '120-129': 91.59, 'old': 87.22, 'new': 91.59}
2024-09-06 05:16:29,142 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52]
2024-09-06 05:16:29,143 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75]

Average Accuracy (CNN): 90.82
2024-09-06 05:16:29,143 [trainer.py] => Average Accuracy (CNN): 90.82 

2024-09-06 05:16:29,143 [trainer.py] => All params: 86510018
2024-09-06 05:16:29,144 [trainer.py] => Trainable params: 304320
2024-09-06 05:16:29,150 [ease.py] => Learning on 130-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.273, Train_accy 30.72:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.273, Train_accy 30.72:   5%|▌         | 1/20 [00:03<01:00,  3.17s/it]
Task 4, Epoch 2/20 => Loss 2.148, Train_accy 57.42:   5%|▌         | 1/20 [00:06<01:00,  3.17s/it]
Task 4, Epoch 2/20 => Loss 2.148, Train_accy 57.42:  10%|█         | 2/20 [00:06<00:56,  3.14s/it]
Task 4, Epoch 3/20 => Loss 1.948, Train_accy 74.79:  10%|█         | 2/20 [00:09<00:56,  3.14s/it]
Task 4, Epoch 3/20 => Loss 1.948, Train_accy 74.79:  15%|█▌        | 3/20 [00:09<00:53,  3.14s/it]
Task 4, Epoch 4/20 => Loss 1.674, Train_accy 86.65:  15%|█▌        | 3/20 [00:12<00:53,  3.14s/it]
Task 4, Epoch 4/20 => Loss 1.674, Train_accy 86.65:  20%|██        | 4/20 [00:12<00:50,  3.14s/it]
Task 4, Epoch 5/20 => Loss 1.381, Train_accy 89.83:  20%|██        | 4/20 [00:15<00:50,  3.14s/it]
Task 4, Epoch 5/20 => Loss 1.381, Train_accy 89.83:  25%|██▌       | 5/20 [00:15<00:47,  3.13s/it]
Task 4, Epoch 6/20 => Loss 1.106, Train_accy 93.43:  25%|██▌       | 5/20 [00:18<00:47,  3.13s/it]
Task 4, Epoch 6/20 => Loss 1.106, Train_accy 93.43:  30%|███       | 6/20 [00:18<00:43,  3.13s/it]
Task 4, Epoch 7/20 => Loss 0.942, Train_accy 92.16:  30%|███       | 6/20 [00:21<00:43,  3.13s/it]
Task 4, Epoch 7/20 => Loss 0.942, Train_accy 92.16:  35%|███▌      | 7/20 [00:21<00:40,  3.12s/it]
Task 4, Epoch 8/20 => Loss 0.816, Train_accy 93.22:  35%|███▌      | 7/20 [00:25<00:40,  3.12s/it]
Task 4, Epoch 8/20 => Loss 0.816, Train_accy 93.22:  40%|████      | 8/20 [00:25<00:37,  3.12s/it]
Task 4, Epoch 9/20 => Loss 0.722, Train_accy 94.07:  40%|████      | 8/20 [00:28<00:37,  3.12s/it]
Task 4, Epoch 9/20 => Loss 0.722, Train_accy 94.07:  45%|████▌     | 9/20 [00:28<00:34,  3.12s/it]
Task 4, Epoch 10/20 => Loss 0.653, Train_accy 93.86:  45%|████▌     | 9/20 [00:31<00:34,  3.12s/it]
Task 4, Epoch 10/20 => Loss 0.653, Train_accy 93.86:  50%|█████     | 10/20 [00:31<00:31,  3.13s/it]
Task 4, Epoch 11/20 => Loss 0.598, Train_accy 94.28:  50%|█████     | 10/20 [00:34<00:31,  3.13s/it]
Task 4, Epoch 11/20 => Loss 0.598, Train_accy 94.28:  55%|█████▌    | 11/20 [00:34<00:28,  3.12s/it]
Task 4, Epoch 12/20 => Loss 0.577, Train_accy 93.64:  55%|█████▌    | 11/20 [00:37<00:28,  3.12s/it]
Task 4, Epoch 12/20 => Loss 0.577, Train_accy 93.64:  60%|██████    | 12/20 [00:37<00:24,  3.12s/it]
Task 4, Epoch 13/20 => Loss 0.540, Train_accy 92.80:  60%|██████    | 12/20 [00:40<00:24,  3.12s/it]
Task 4, Epoch 13/20 => Loss 0.540, Train_accy 92.80:  65%|██████▌   | 13/20 [00:40<00:21,  3.12s/it]
Task 4, Epoch 14/20 => Loss 0.507, Train_accy 93.43:  65%|██████▌   | 13/20 [00:43<00:21,  3.12s/it]
Task 4, Epoch 14/20 => Loss 0.507, Train_accy 93.43:  70%|███████   | 14/20 [00:43<00:18,  3.12s/it]
Task 4, Epoch 15/20 => Loss 0.494, Train_accy 93.43:  70%|███████   | 14/20 [00:46<00:18,  3.12s/it]
Task 4, Epoch 15/20 => Loss 0.494, Train_accy 93.43:  75%|███████▌  | 15/20 [00:46<00:15,  3.12s/it]
Task 4, Epoch 16/20 => Loss 0.480, Train_accy 94.70:  75%|███████▌  | 15/20 [00:50<00:15,  3.12s/it]
Task 4, Epoch 16/20 => Loss 0.480, Train_accy 94.70:  80%|████████  | 16/20 [00:50<00:12,  3.12s/it]
Task 4, Epoch 17/20 => Loss 0.486, Train_accy 93.01:  80%|████████  | 16/20 [00:53<00:12,  3.12s/it]
Task 4, Epoch 17/20 => Loss 0.486, Train_accy 93.01:  85%|████████▌ | 17/20 [00:53<00:09,  3.11s/it]
Task 4, Epoch 18/20 => Loss 0.464, Train_accy 93.86:  85%|████████▌ | 17/20 [00:56<00:09,  3.11s/it]
Task 4, Epoch 18/20 => Loss 0.464, Train_accy 93.86:  90%|█████████ | 18/20 [00:56<00:06,  3.12s/it]
Task 4, Epoch 19/20 => Loss 0.461, Train_accy 94.28:  90%|█████████ | 18/20 [00:59<00:06,  3.12s/it]
Task 4, Epoch 19/20 => Loss 0.461, Train_accy 94.28:  95%|█████████▌| 19/20 [00:59<00:03,  3.12s/it]
Task 4, Epoch 20/20 => Loss 0.446, Train_accy 94.70:  95%|█████████▌| 19/20 [01:02<00:03,  3.12s/it]
Task 4, Epoch 20/20 => Loss 0.446, Train_accy 94.70: 100%|██████████| 20/20 [01:02<00:00,  3.13s/it]
Task 4, Epoch 20/20 => Loss 0.446, Train_accy 94.70: 100%|██████████| 20/20 [01:02<00:00,  3.13s/it]
2024-09-06 05:17:31,668 [ease.py] => Task 4, Epoch 20/20 => Loss 0.446, Train_accy 94.70
2024-09-06 05:18:05,031 [ease.py] => Task correct: 87.38574040219379
2024-09-06 05:18:05,032 [ease.py] => Task acc: 98.23278488726386
2024-09-06 05:18:05,055 [trainer.py] => No NME accuracy.
2024-09-06 05:18:05,055 [trainer.py] => CNN: {'total': 87.02, '00-99': 85.61, '100-109': 93.91, '110-119': 90.27, '120-129': 85.98, '130-139': 92.37, 'old': 86.61, 'new': 92.37}
2024-09-06 05:18:05,055 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52, 87.02]
2024-09-06 05:18:05,055 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75, 98.48]

Average Accuracy (CNN): 90.06
2024-09-06 05:18:05,055 [trainer.py] => Average Accuracy (CNN): 90.06 

2024-09-06 05:18:05,056 [trainer.py] => All params: 86648258
2024-09-06 05:18:05,057 [trainer.py] => Trainable params: 304320
2024-09-06 05:18:05,064 [ease.py] => Learning on 140-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.284, Train_accy 18.14:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.284, Train_accy 18.14:   5%|▌         | 1/20 [00:03<00:57,  3.02s/it]
Task 5, Epoch 2/20 => Loss 2.168, Train_accy 75.22:   5%|▌         | 1/20 [00:06<00:57,  3.02s/it]
Task 5, Epoch 2/20 => Loss 2.168, Train_accy 75.22:  10%|█         | 2/20 [00:06<00:54,  3.02s/it]
Task 5, Epoch 3/20 => Loss 1.968, Train_accy 90.04:  10%|█         | 2/20 [00:09<00:54,  3.02s/it]
Task 5, Epoch 3/20 => Loss 1.968, Train_accy 90.04:  15%|█▌        | 3/20 [00:09<00:51,  3.02s/it]
Task 5, Epoch 4/20 => Loss 1.687, Train_accy 95.35:  15%|█▌        | 3/20 [00:12<00:51,  3.02s/it]
Task 5, Epoch 4/20 => Loss 1.687, Train_accy 95.35:  20%|██        | 4/20 [00:12<00:48,  3.02s/it]
Task 5, Epoch 5/20 => Loss 1.357, Train_accy 97.12:  20%|██        | 4/20 [00:15<00:48,  3.02s/it]
Task 5, Epoch 5/20 => Loss 1.357, Train_accy 97.12:  25%|██▌       | 5/20 [00:15<00:45,  3.02s/it]
Task 5, Epoch 6/20 => Loss 1.083, Train_accy 94.69:  25%|██▌       | 5/20 [00:18<00:45,  3.02s/it]
Task 5, Epoch 6/20 => Loss 1.083, Train_accy 94.69:  30%|███       | 6/20 [00:18<00:42,  3.02s/it]
Task 5, Epoch 7/20 => Loss 0.872, Train_accy 96.90:  30%|███       | 6/20 [00:21<00:42,  3.02s/it]
Task 5, Epoch 7/20 => Loss 0.872, Train_accy 96.90:  35%|███▌      | 7/20 [00:21<00:39,  3.02s/it]
Task 5, Epoch 8/20 => Loss 0.725, Train_accy 95.35:  35%|███▌      | 7/20 [00:24<00:39,  3.02s/it]
Task 5, Epoch 8/20 => Loss 0.725, Train_accy 95.35:  40%|████      | 8/20 [00:24<00:36,  3.02s/it]
Task 5, Epoch 9/20 => Loss 0.619, Train_accy 97.57:  40%|████      | 8/20 [00:27<00:36,  3.02s/it]
Task 5, Epoch 9/20 => Loss 0.619, Train_accy 97.57:  45%|████▌     | 9/20 [00:27<00:33,  3.01s/it]
Task 5, Epoch 10/20 => Loss 0.538, Train_accy 96.68:  45%|████▌     | 9/20 [00:30<00:33,  3.01s/it]
Task 5, Epoch 10/20 => Loss 0.538, Train_accy 96.68:  50%|█████     | 10/20 [00:30<00:30,  3.02s/it]
Task 5, Epoch 11/20 => Loss 0.516, Train_accy 96.02:  50%|█████     | 10/20 [00:33<00:30,  3.02s/it]
Task 5, Epoch 11/20 => Loss 0.516, Train_accy 96.02:  55%|█████▌    | 11/20 [00:33<00:27,  3.04s/it]
Task 5, Epoch 12/20 => Loss 0.499, Train_accy 95.80:  55%|█████▌    | 11/20 [00:36<00:27,  3.04s/it]
Task 5, Epoch 12/20 => Loss 0.499, Train_accy 95.80:  60%|██████    | 12/20 [00:36<00:24,  3.04s/it]
Task 5, Epoch 13/20 => Loss 0.454, Train_accy 95.35:  60%|██████    | 12/20 [00:39<00:24,  3.04s/it]
Task 5, Epoch 13/20 => Loss 0.454, Train_accy 95.35:  65%|██████▌   | 13/20 [00:39<00:21,  3.03s/it]
Task 5, Epoch 14/20 => Loss 0.433, Train_accy 96.02:  65%|██████▌   | 13/20 [00:42<00:21,  3.03s/it]
Task 5, Epoch 14/20 => Loss 0.433, Train_accy 96.02:  70%|███████   | 14/20 [00:42<00:18,  3.02s/it]
Task 5, Epoch 15/20 => Loss 0.427, Train_accy 95.58:  70%|███████   | 14/20 [00:45<00:18,  3.02s/it]
Task 5, Epoch 15/20 => Loss 0.427, Train_accy 95.58:  75%|███████▌  | 15/20 [00:45<00:15,  3.02s/it]
Task 5, Epoch 16/20 => Loss 0.392, Train_accy 96.90:  75%|███████▌  | 15/20 [00:48<00:15,  3.02s/it]
Task 5, Epoch 16/20 => Loss 0.392, Train_accy 96.90:  80%|████████  | 16/20 [00:48<00:12,  3.02s/it]
Task 5, Epoch 17/20 => Loss 0.397, Train_accy 96.68:  80%|████████  | 16/20 [00:51<00:12,  3.02s/it]
Task 5, Epoch 17/20 => Loss 0.397, Train_accy 96.68:  85%|████████▌ | 17/20 [00:51<00:09,  3.01s/it]
Task 5, Epoch 18/20 => Loss 0.394, Train_accy 96.02:  85%|████████▌ | 17/20 [00:54<00:09,  3.01s/it]
Task 5, Epoch 18/20 => Loss 0.394, Train_accy 96.02:  90%|█████████ | 18/20 [00:54<00:06,  3.00s/it]
Task 5, Epoch 19/20 => Loss 0.403, Train_accy 94.47:  90%|█████████ | 18/20 [00:57<00:06,  3.00s/it]
Task 5, Epoch 19/20 => Loss 0.403, Train_accy 94.47:  95%|█████████▌| 19/20 [00:57<00:03,  3.01s/it]
Task 5, Epoch 20/20 => Loss 0.396, Train_accy 95.35:  95%|█████████▌| 19/20 [01:00<00:03,  3.01s/it]
Task 5, Epoch 20/20 => Loss 0.396, Train_accy 95.35: 100%|██████████| 20/20 [01:00<00:00,  3.01s/it]
Task 5, Epoch 20/20 => Loss 0.396, Train_accy 95.35: 100%|██████████| 20/20 [01:00<00:00,  3.02s/it]
2024-09-06 05:19:05,445 [ease.py] => Task 5, Epoch 20/20 => Loss 0.396, Train_accy 95.35
2024-09-06 05:19:47,353 [ease.py] => Task correct: 85.96491228070175
2024-09-06 05:19:47,353 [ease.py] => Task acc: 98.30220713073005
2024-09-06 05:19:47,376 [trainer.py] => No NME accuracy.
2024-09-06 05:19:47,376 [trainer.py] => CNN: {'total': 85.63, '00-99': 83.42, '100-109': 93.04, '110-119': 85.84, '120-129': 85.98, '130-139': 92.37, '140-149': 92.86, 'old': 85.07, 'new': 92.86}
2024-09-06 05:19:47,376 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52, 87.02, 85.63]
2024-09-06 05:19:47,376 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75, 98.48, 98.3]

Average Accuracy (CNN): 89.32
2024-09-06 05:19:47,376 [trainer.py] => Average Accuracy (CNN): 89.32 

2024-09-06 05:19:47,377 [trainer.py] => All params: 86801858
2024-09-06 05:19:47,378 [trainer.py] => Trainable params: 304320
2024-09-06 05:19:47,386 [ease.py] => Learning on 150-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.274, Train_accy 32.48:   0%|          | 0/20 [00:03<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.274, Train_accy 32.48:   5%|▌         | 1/20 [00:03<00:58,  3.09s/it]
Task 6, Epoch 2/20 => Loss 2.146, Train_accy 79.91:   5%|▌         | 1/20 [00:06<00:58,  3.09s/it]
Task 6, Epoch 2/20 => Loss 2.146, Train_accy 79.91:  10%|█         | 2/20 [00:06<00:55,  3.11s/it]
Task 6, Epoch 3/20 => Loss 1.936, Train_accy 93.59:  10%|█         | 2/20 [00:09<00:55,  3.11s/it]
Task 6, Epoch 3/20 => Loss 1.936, Train_accy 93.59:  15%|█▌        | 3/20 [00:09<00:52,  3.10s/it]
Task 6, Epoch 4/20 => Loss 1.634, Train_accy 96.37:  15%|█▌        | 3/20 [00:12<00:52,  3.10s/it]
Task 6, Epoch 4/20 => Loss 1.634, Train_accy 96.37:  20%|██        | 4/20 [00:12<00:49,  3.09s/it]
Task 6, Epoch 5/20 => Loss 1.297, Train_accy 95.30:  20%|██        | 4/20 [00:15<00:49,  3.09s/it]
Task 6, Epoch 5/20 => Loss 1.297, Train_accy 95.30:  25%|██▌       | 5/20 [00:15<00:46,  3.08s/it]
Task 6, Epoch 6/20 => Loss 1.013, Train_accy 95.94:  25%|██▌       | 5/20 [00:18<00:46,  3.08s/it]
Task 6, Epoch 6/20 => Loss 1.013, Train_accy 95.94:  30%|███       | 6/20 [00:18<00:43,  3.08s/it]
Task 6, Epoch 7/20 => Loss 0.799, Train_accy 96.37:  30%|███       | 6/20 [00:21<00:43,  3.08s/it]
Task 6, Epoch 7/20 => Loss 0.799, Train_accy 96.37:  35%|███▌      | 7/20 [00:21<00:40,  3.09s/it]
Task 6, Epoch 8/20 => Loss 0.691, Train_accy 94.44:  35%|███▌      | 7/20 [00:24<00:40,  3.09s/it]
Task 6, Epoch 8/20 => Loss 0.691, Train_accy 94.44:  40%|████      | 8/20 [00:24<00:37,  3.09s/it]
Task 6, Epoch 9/20 => Loss 0.608, Train_accy 94.02:  40%|████      | 8/20 [00:27<00:37,  3.09s/it]
Task 6, Epoch 9/20 => Loss 0.608, Train_accy 94.02:  45%|████▌     | 9/20 [00:27<00:33,  3.09s/it]
Task 6, Epoch 10/20 => Loss 0.502, Train_accy 94.87:  45%|████▌     | 9/20 [00:30<00:33,  3.09s/it]
Task 6, Epoch 10/20 => Loss 0.502, Train_accy 94.87:  50%|█████     | 10/20 [00:30<00:30,  3.09s/it]
Task 6, Epoch 11/20 => Loss 0.482, Train_accy 95.73:  50%|█████     | 10/20 [00:34<00:30,  3.09s/it]
Task 6, Epoch 11/20 => Loss 0.482, Train_accy 95.73:  55%|█████▌    | 11/20 [00:34<00:27,  3.10s/it]
Task 6, Epoch 12/20 => Loss 0.447, Train_accy 93.80:  55%|█████▌    | 11/20 [00:37<00:27,  3.10s/it]
Task 6, Epoch 12/20 => Loss 0.447, Train_accy 93.80:  60%|██████    | 12/20 [00:37<00:24,  3.10s/it]
Task 6, Epoch 13/20 => Loss 0.384, Train_accy 96.15:  60%|██████    | 12/20 [00:40<00:24,  3.10s/it]
Task 6, Epoch 13/20 => Loss 0.384, Train_accy 96.15:  65%|██████▌   | 13/20 [00:40<00:21,  3.10s/it]
Task 6, Epoch 14/20 => Loss 0.393, Train_accy 94.87:  65%|██████▌   | 13/20 [00:43<00:21,  3.10s/it]
Task 6, Epoch 14/20 => Loss 0.393, Train_accy 94.87:  70%|███████   | 14/20 [00:43<00:18,  3.10s/it]
Task 6, Epoch 15/20 => Loss 0.409, Train_accy 94.44:  70%|███████   | 14/20 [00:46<00:18,  3.10s/it]
Task 6, Epoch 15/20 => Loss 0.409, Train_accy 94.44:  75%|███████▌  | 15/20 [00:46<00:15,  3.10s/it]
Task 6, Epoch 16/20 => Loss 0.383, Train_accy 94.02:  75%|███████▌  | 15/20 [00:49<00:15,  3.10s/it]
Task 6, Epoch 16/20 => Loss 0.383, Train_accy 94.02:  80%|████████  | 16/20 [00:49<00:12,  3.10s/it]
Task 6, Epoch 17/20 => Loss 0.376, Train_accy 94.66:  80%|████████  | 16/20 [00:52<00:12,  3.10s/it]
Task 6, Epoch 17/20 => Loss 0.376, Train_accy 94.66:  85%|████████▌ | 17/20 [00:52<00:09,  3.10s/it]
Task 6, Epoch 18/20 => Loss 0.369, Train_accy 95.09:  85%|████████▌ | 17/20 [00:55<00:09,  3.10s/it]
Task 6, Epoch 18/20 => Loss 0.369, Train_accy 95.09:  90%|█████████ | 18/20 [00:55<00:06,  3.10s/it]
Task 6, Epoch 19/20 => Loss 0.327, Train_accy 97.22:  90%|█████████ | 18/20 [00:58<00:06,  3.10s/it]
Task 6, Epoch 19/20 => Loss 0.327, Train_accy 97.22:  95%|█████████▌| 19/20 [00:58<00:03,  3.12s/it]
Task 6, Epoch 20/20 => Loss 0.359, Train_accy 95.73:  95%|█████████▌| 19/20 [01:01<00:03,  3.12s/it]
Task 6, Epoch 20/20 => Loss 0.359, Train_accy 95.73: 100%|██████████| 20/20 [01:01<00:00,  3.11s/it]
Task 6, Epoch 20/20 => Loss 0.359, Train_accy 95.73: 100%|██████████| 20/20 [01:01<00:00,  3.10s/it]
2024-09-06 05:20:49,377 [ease.py] => Task 6, Epoch 20/20 => Loss 0.359, Train_accy 95.73
2024-09-06 05:21:41,367 [ease.py] => Task correct: 86.62083553675303
2024-09-06 05:21:41,368 [ease.py] => Task acc: 98.41353781068217
2024-09-06 05:21:41,394 [trainer.py] => No NME accuracy.
2024-09-06 05:21:41,394 [trainer.py] => CNN: {'total': 86.3, '00-99': 83.59, '100-109': 89.57, '110-119': 85.84, '120-129': 85.98, '130-139': 91.53, '140-149': 92.06, '150-159': 99.19, 'old': 85.4, 'new': 99.19}
2024-09-06 05:21:41,394 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52, 87.02, 85.63, 86.3]
2024-09-06 05:21:41,394 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75, 98.48, 98.3, 98.2]

Average Accuracy (CNN): 88.89
2024-09-06 05:21:41,394 [trainer.py] => Average Accuracy (CNN): 88.89 

2024-09-06 05:21:41,395 [trainer.py] => All params: 86970818
2024-09-06 05:21:41,396 [trainer.py] => Trainable params: 304320
2024-09-06 05:21:41,405 [ease.py] => Learning on 160-170

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.267, Train_accy 26.08:   0%|          | 0/20 [00:03<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.267, Train_accy 26.08:   5%|▌         | 1/20 [00:03<00:58,  3.10s/it]
Task 7, Epoch 2/20 => Loss 2.138, Train_accy 89.66:   5%|▌         | 1/20 [00:06<00:58,  3.10s/it]
Task 7, Epoch 2/20 => Loss 2.138, Train_accy 89.66:  10%|█         | 2/20 [00:06<00:55,  3.10s/it]
Task 7, Epoch 3/20 => Loss 1.919, Train_accy 93.53:  10%|█         | 2/20 [00:09<00:55,  3.10s/it]
Task 7, Epoch 3/20 => Loss 1.919, Train_accy 93.53:  15%|█▌        | 3/20 [00:09<00:52,  3.09s/it]
Task 7, Epoch 4/20 => Loss 1.608, Train_accy 93.32:  15%|█▌        | 3/20 [00:12<00:52,  3.09s/it]
Task 7, Epoch 4/20 => Loss 1.608, Train_accy 93.32:  20%|██        | 4/20 [00:12<00:49,  3.10s/it]
Task 7, Epoch 5/20 => Loss 1.252, Train_accy 93.97:  20%|██        | 4/20 [00:15<00:49,  3.10s/it]
Task 7, Epoch 5/20 => Loss 1.252, Train_accy 93.97:  25%|██▌       | 5/20 [00:15<00:46,  3.10s/it]
Task 7, Epoch 6/20 => Loss 0.968, Train_accy 94.61:  25%|██▌       | 5/20 [00:18<00:46,  3.10s/it]
Task 7, Epoch 6/20 => Loss 0.968, Train_accy 94.61:  30%|███       | 6/20 [00:18<00:43,  3.09s/it]
Task 7, Epoch 7/20 => Loss 0.782, Train_accy 94.40:  30%|███       | 6/20 [00:21<00:43,  3.09s/it]
Task 7, Epoch 7/20 => Loss 0.782, Train_accy 94.40:  35%|███▌      | 7/20 [00:21<00:40,  3.09s/it]
Task 7, Epoch 8/20 => Loss 0.624, Train_accy 95.91:  35%|███▌      | 7/20 [00:24<00:40,  3.09s/it]
Task 7, Epoch 8/20 => Loss 0.624, Train_accy 95.91:  40%|████      | 8/20 [00:24<00:37,  3.09s/it]
Task 7, Epoch 9/20 => Loss 0.544, Train_accy 95.69:  40%|████      | 8/20 [00:27<00:37,  3.09s/it]
Task 7, Epoch 9/20 => Loss 0.544, Train_accy 95.69:  45%|████▌     | 9/20 [00:27<00:34,  3.10s/it]
Task 7, Epoch 10/20 => Loss 0.492, Train_accy 94.18:  45%|████▌     | 9/20 [00:30<00:34,  3.10s/it]
Task 7, Epoch 10/20 => Loss 0.492, Train_accy 94.18:  50%|█████     | 10/20 [00:30<00:30,  3.09s/it]
Task 7, Epoch 11/20 => Loss 0.404, Train_accy 96.55:  50%|█████     | 10/20 [00:34<00:30,  3.09s/it]
Task 7, Epoch 11/20 => Loss 0.404, Train_accy 96.55:  55%|█████▌    | 11/20 [00:34<00:27,  3.10s/it]
Task 7, Epoch 12/20 => Loss 0.423, Train_accy 93.97:  55%|█████▌    | 11/20 [00:37<00:27,  3.10s/it]
Task 7, Epoch 12/20 => Loss 0.423, Train_accy 93.97:  60%|██████    | 12/20 [00:37<00:24,  3.10s/it]
Task 7, Epoch 13/20 => Loss 0.343, Train_accy 96.77:  60%|██████    | 12/20 [00:40<00:24,  3.10s/it]
Task 7, Epoch 13/20 => Loss 0.343, Train_accy 96.77:  65%|██████▌   | 13/20 [00:40<00:21,  3.10s/it]
Task 7, Epoch 14/20 => Loss 0.340, Train_accy 95.26:  65%|██████▌   | 13/20 [00:43<00:21,  3.10s/it]
Task 7, Epoch 14/20 => Loss 0.340, Train_accy 95.26:  70%|███████   | 14/20 [00:43<00:18,  3.10s/it]
Task 7, Epoch 15/20 => Loss 0.356, Train_accy 94.83:  70%|███████   | 14/20 [00:46<00:18,  3.10s/it]
Task 7, Epoch 15/20 => Loss 0.356, Train_accy 94.83:  75%|███████▌  | 15/20 [00:46<00:15,  3.09s/it]
Task 7, Epoch 16/20 => Loss 0.382, Train_accy 93.53:  75%|███████▌  | 15/20 [00:49<00:15,  3.09s/it]
Task 7, Epoch 16/20 => Loss 0.382, Train_accy 93.53:  80%|████████  | 16/20 [00:49<00:12,  3.10s/it]
Task 7, Epoch 17/20 => Loss 0.332, Train_accy 95.69:  80%|████████  | 16/20 [00:52<00:12,  3.10s/it]
Task 7, Epoch 17/20 => Loss 0.332, Train_accy 95.69:  85%|████████▌ | 17/20 [00:52<00:09,  3.10s/it]
Task 7, Epoch 18/20 => Loss 0.333, Train_accy 94.40:  85%|████████▌ | 17/20 [00:55<00:09,  3.10s/it]
Task 7, Epoch 18/20 => Loss 0.333, Train_accy 94.40:  90%|█████████ | 18/20 [00:55<00:06,  3.12s/it]
Task 7, Epoch 19/20 => Loss 0.330, Train_accy 95.69:  90%|█████████ | 18/20 [00:58<00:06,  3.12s/it]
Task 7, Epoch 19/20 => Loss 0.330, Train_accy 95.69:  95%|█████████▌| 19/20 [00:58<00:03,  3.11s/it]
Task 7, Epoch 20/20 => Loss 0.337, Train_accy 95.47:  95%|█████████▌| 19/20 [01:02<00:03,  3.11s/it]
Task 7, Epoch 20/20 => Loss 0.337, Train_accy 95.47: 100%|██████████| 20/20 [01:02<00:00,  3.11s/it]
Task 7, Epoch 20/20 => Loss 0.337, Train_accy 95.47: 100%|██████████| 20/20 [01:02<00:00,  3.10s/it]
2024-09-06 05:22:43,432 [ease.py] => Task 7, Epoch 20/20 => Loss 0.337, Train_accy 95.47
2024-09-06 05:23:46,023 [ease.py] => Task correct: 86.17283950617283
2024-09-06 05:23:46,024 [ease.py] => Task acc: 98.46913580246914
2024-09-06 05:23:46,050 [trainer.py] => No NME accuracy.
2024-09-06 05:23:46,051 [trainer.py] => CNN: {'total': 85.83, '00-99': 82.83, '100-109': 89.57, '110-119': 84.96, '120-129': 85.05, '130-139': 89.83, '140-149': 88.89, '150-159': 99.19, '160-169': 91.79, 'old': 85.4, 'new': 91.79}
2024-09-06 05:23:46,051 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52, 87.02, 85.63, 86.3, 85.83]
2024-09-06 05:23:46,051 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75, 98.48, 98.3, 98.2, 98.02]

Average Accuracy (CNN): 88.51
2024-09-06 05:23:46,051 [trainer.py] => Average Accuracy (CNN): 88.51 

2024-09-06 05:23:46,052 [trainer.py] => All params: 87155138
2024-09-06 05:23:46,053 [trainer.py] => Trainable params: 304320
2024-09-06 05:23:46,064 [ease.py] => Learning on 170-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.281, Train_accy 26.11:   0%|          | 0/20 [00:03<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.281, Train_accy 26.11:   5%|▌         | 1/20 [00:03<01:01,  3.26s/it]
Task 8, Epoch 2/20 => Loss 2.150, Train_accy 78.34:   5%|▌         | 1/20 [00:06<01:01,  3.26s/it]
Task 8, Epoch 2/20 => Loss 2.150, Train_accy 78.34:  10%|█         | 2/20 [00:06<00:58,  3.26s/it]
Task 8, Epoch 3/20 => Loss 1.935, Train_accy 88.66:  10%|█         | 2/20 [00:09<00:58,  3.26s/it]
Task 8, Epoch 3/20 => Loss 1.935, Train_accy 88.66:  15%|█▌        | 3/20 [00:09<00:55,  3.26s/it]
Task 8, Epoch 4/20 => Loss 1.625, Train_accy 91.70:  15%|█▌        | 3/20 [00:13<00:55,  3.26s/it]
Task 8, Epoch 4/20 => Loss 1.625, Train_accy 91.70:  20%|██        | 4/20 [00:13<00:52,  3.26s/it]
Task 8, Epoch 5/20 => Loss 1.268, Train_accy 94.94:  20%|██        | 4/20 [00:16<00:52,  3.26s/it]
Task 8, Epoch 5/20 => Loss 1.268, Train_accy 94.94:  25%|██▌       | 5/20 [00:16<00:48,  3.26s/it]
Task 8, Epoch 6/20 => Loss 0.993, Train_accy 94.33:  25%|██▌       | 5/20 [00:19<00:48,  3.26s/it]
Task 8, Epoch 6/20 => Loss 0.993, Train_accy 94.33:  30%|███       | 6/20 [00:19<00:45,  3.25s/it]
Task 8, Epoch 7/20 => Loss 0.754, Train_accy 96.76:  30%|███       | 6/20 [00:22<00:45,  3.25s/it]
Task 8, Epoch 7/20 => Loss 0.754, Train_accy 96.76:  35%|███▌      | 7/20 [00:22<00:42,  3.25s/it]
Task 8, Epoch 8/20 => Loss 0.641, Train_accy 96.76:  35%|███▌      | 7/20 [00:26<00:42,  3.25s/it]
Task 8, Epoch 8/20 => Loss 0.641, Train_accy 96.76:  40%|████      | 8/20 [00:26<00:39,  3.25s/it]
Task 8, Epoch 9/20 => Loss 0.573, Train_accy 94.74:  40%|████      | 8/20 [00:29<00:39,  3.25s/it]
Task 8, Epoch 9/20 => Loss 0.573, Train_accy 94.74:  45%|████▌     | 9/20 [00:29<00:35,  3.26s/it]
Task 8, Epoch 10/20 => Loss 0.499, Train_accy 95.34:  45%|████▌     | 9/20 [00:32<00:35,  3.26s/it]
Task 8, Epoch 10/20 => Loss 0.499, Train_accy 95.34:  50%|█████     | 10/20 [00:32<00:32,  3.26s/it]
Task 8, Epoch 11/20 => Loss 0.478, Train_accy 95.14:  50%|█████     | 10/20 [00:35<00:32,  3.26s/it]
Task 8, Epoch 11/20 => Loss 0.478, Train_accy 95.14:  55%|█████▌    | 11/20 [00:35<00:29,  3.26s/it]
Task 8, Epoch 12/20 => Loss 0.415, Train_accy 95.14:  55%|█████▌    | 11/20 [00:39<00:29,  3.26s/it]
Task 8, Epoch 12/20 => Loss 0.415, Train_accy 95.14:  60%|██████    | 12/20 [00:39<00:26,  3.26s/it]
Task 8, Epoch 13/20 => Loss 0.410, Train_accy 94.94:  60%|██████    | 12/20 [00:42<00:26,  3.26s/it]
Task 8, Epoch 13/20 => Loss 0.410, Train_accy 94.94:  65%|██████▌   | 13/20 [00:42<00:22,  3.27s/it]
Task 8, Epoch 14/20 => Loss 0.383, Train_accy 95.34:  65%|██████▌   | 13/20 [00:45<00:22,  3.27s/it]
Task 8, Epoch 14/20 => Loss 0.383, Train_accy 95.34:  70%|███████   | 14/20 [00:45<00:19,  3.27s/it]
Task 8, Epoch 15/20 => Loss 0.380, Train_accy 95.34:  70%|███████   | 14/20 [00:48<00:19,  3.27s/it]
Task 8, Epoch 15/20 => Loss 0.380, Train_accy 95.34:  75%|███████▌  | 15/20 [00:48<00:16,  3.26s/it]
Task 8, Epoch 16/20 => Loss 0.339, Train_accy 96.15:  75%|███████▌  | 15/20 [00:52<00:16,  3.26s/it]
Task 8, Epoch 16/20 => Loss 0.339, Train_accy 96.15:  80%|████████  | 16/20 [00:52<00:13,  3.27s/it]
Task 8, Epoch 17/20 => Loss 0.345, Train_accy 96.15:  80%|████████  | 16/20 [00:55<00:13,  3.27s/it]
Task 8, Epoch 17/20 => Loss 0.345, Train_accy 96.15:  85%|████████▌ | 17/20 [00:55<00:09,  3.27s/it]
Task 8, Epoch 18/20 => Loss 0.344, Train_accy 96.36:  85%|████████▌ | 17/20 [00:58<00:09,  3.27s/it]
Task 8, Epoch 18/20 => Loss 0.344, Train_accy 96.36:  90%|█████████ | 18/20 [00:58<00:06,  3.30s/it]
Task 8, Epoch 19/20 => Loss 0.357, Train_accy 95.34:  90%|█████████ | 18/20 [01:02<00:06,  3.30s/it]
Task 8, Epoch 19/20 => Loss 0.357, Train_accy 95.34:  95%|█████████▌| 19/20 [01:02<00:03,  3.30s/it]
Task 8, Epoch 20/20 => Loss 0.343, Train_accy 95.55:  95%|█████████▌| 19/20 [01:05<00:03,  3.30s/it]
Task 8, Epoch 20/20 => Loss 0.343, Train_accy 95.55: 100%|██████████| 20/20 [01:05<00:00,  3.28s/it]
Task 8, Epoch 20/20 => Loss 0.343, Train_accy 95.55: 100%|██████████| 20/20 [01:05<00:00,  3.27s/it]
2024-09-06 05:24:51,461 [ease.py] => Task 8, Epoch 20/20 => Loss 0.343, Train_accy 95.55
2024-09-06 05:26:05,061 [ease.py] => Task correct: 86.09022556390977
2024-09-06 05:26:05,062 [ease.py] => Task acc: 98.49624060150376
2024-09-06 05:26:05,088 [trainer.py] => No NME accuracy.
2024-09-06 05:26:05,088 [trainer.py] => CNN: {'total': 85.71, '00-99': 82.41, '100-109': 90.43, '110-119': 82.3, '120-129': 83.18, '130-139': 89.83, '140-149': 85.71, '150-159': 99.19, '160-169': 91.79, '170-179': 96.12, 'old': 85.19, 'new': 96.12}
2024-09-06 05:26:05,088 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52, 87.02, 85.63, 86.3, 85.83, 85.71]
2024-09-06 05:26:05,088 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75, 98.48, 98.3, 98.2, 98.02, 97.93]

Average Accuracy (CNN): 88.2
2024-09-06 05:26:05,088 [trainer.py] => Average Accuracy (CNN): 88.2 

2024-09-06 05:26:05,089 [trainer.py] => All params: 87354818
2024-09-06 05:26:05,090 [trainer.py] => Trainable params: 304320
2024-09-06 05:26:05,103 [ease.py] => Learning on 180-190

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.279, Train_accy 26.59:   0%|          | 0/20 [00:03<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.279, Train_accy 26.59:   5%|▌         | 1/20 [00:03<00:57,  3.03s/it]
Task 9, Epoch 2/20 => Loss 2.151, Train_accy 77.14:   5%|▌         | 1/20 [00:06<00:57,  3.03s/it]
Task 9, Epoch 2/20 => Loss 2.151, Train_accy 77.14:  10%|█         | 2/20 [00:06<00:54,  3.03s/it]
Task 9, Epoch 3/20 => Loss 1.939, Train_accy 87.47:  10%|█         | 2/20 [00:09<00:54,  3.03s/it]
Task 9, Epoch 3/20 => Loss 1.939, Train_accy 87.47:  15%|█▌        | 3/20 [00:09<00:51,  3.02s/it]
Task 9, Epoch 4/20 => Loss 1.640, Train_accy 90.33:  15%|█▌        | 3/20 [00:12<00:51,  3.02s/it]
Task 9, Epoch 4/20 => Loss 1.640, Train_accy 90.33:  20%|██        | 4/20 [00:12<00:48,  3.03s/it]
Task 9, Epoch 5/20 => Loss 1.318, Train_accy 93.63:  20%|██        | 4/20 [00:15<00:48,  3.03s/it]
Task 9, Epoch 5/20 => Loss 1.318, Train_accy 93.63:  25%|██▌       | 5/20 [00:15<00:45,  3.03s/it]
Task 9, Epoch 6/20 => Loss 1.020, Train_accy 94.51:  25%|██▌       | 5/20 [00:18<00:45,  3.03s/it]
Task 9, Epoch 6/20 => Loss 1.020, Train_accy 94.51:  30%|███       | 6/20 [00:18<00:42,  3.03s/it]
Task 9, Epoch 7/20 => Loss 0.828, Train_accy 94.07:  30%|███       | 6/20 [00:21<00:42,  3.03s/it]
Task 9, Epoch 7/20 => Loss 0.828, Train_accy 94.07:  35%|███▌      | 7/20 [00:21<00:39,  3.03s/it]
Task 9, Epoch 8/20 => Loss 0.693, Train_accy 94.51:  35%|███▌      | 7/20 [00:24<00:39,  3.03s/it]
Task 9, Epoch 8/20 => Loss 0.693, Train_accy 94.51:  40%|████      | 8/20 [00:24<00:36,  3.04s/it]
Task 9, Epoch 9/20 => Loss 0.621, Train_accy 93.19:  40%|████      | 8/20 [00:27<00:36,  3.04s/it]
Task 9, Epoch 9/20 => Loss 0.621, Train_accy 93.19:  45%|████▌     | 9/20 [00:27<00:33,  3.05s/it]
Task 9, Epoch 10/20 => Loss 0.539, Train_accy 95.16:  45%|████▌     | 9/20 [00:30<00:33,  3.05s/it]
Task 9, Epoch 10/20 => Loss 0.539, Train_accy 95.16:  50%|█████     | 10/20 [00:30<00:30,  3.05s/it]
Task 9, Epoch 11/20 => Loss 0.474, Train_accy 96.04:  50%|█████     | 10/20 [00:33<00:30,  3.05s/it]
Task 9, Epoch 11/20 => Loss 0.474, Train_accy 96.04:  55%|█████▌    | 11/20 [00:33<00:27,  3.06s/it]
Task 9, Epoch 12/20 => Loss 0.441, Train_accy 94.95:  55%|█████▌    | 11/20 [00:36<00:27,  3.06s/it]
Task 9, Epoch 12/20 => Loss 0.441, Train_accy 94.95:  60%|██████    | 12/20 [00:36<00:24,  3.07s/it]
Task 9, Epoch 13/20 => Loss 0.423, Train_accy 94.07:  60%|██████    | 12/20 [00:39<00:24,  3.07s/it]
Task 9, Epoch 13/20 => Loss 0.423, Train_accy 94.07:  65%|██████▌   | 13/20 [00:39<00:21,  3.06s/it]
Task 9, Epoch 14/20 => Loss 0.397, Train_accy 95.82:  65%|██████▌   | 13/20 [00:42<00:21,  3.06s/it]
Task 9, Epoch 14/20 => Loss 0.397, Train_accy 95.82:  70%|███████   | 14/20 [00:42<00:18,  3.05s/it]
Task 9, Epoch 15/20 => Loss 0.402, Train_accy 95.60:  70%|███████   | 14/20 [00:45<00:18,  3.05s/it]
Task 9, Epoch 15/20 => Loss 0.402, Train_accy 95.60:  75%|███████▌  | 15/20 [00:45<00:15,  3.06s/it]
Task 9, Epoch 16/20 => Loss 0.389, Train_accy 94.29:  75%|███████▌  | 15/20 [00:48<00:15,  3.06s/it]
Task 9, Epoch 16/20 => Loss 0.389, Train_accy 94.29:  80%|████████  | 16/20 [00:48<00:12,  3.05s/it]
Task 9, Epoch 17/20 => Loss 0.397, Train_accy 94.73:  80%|████████  | 16/20 [00:51<00:12,  3.05s/it]
Task 9, Epoch 17/20 => Loss 0.397, Train_accy 94.73:  85%|████████▌ | 17/20 [00:51<00:09,  3.05s/it]
Task 9, Epoch 18/20 => Loss 0.393, Train_accy 93.85:  85%|████████▌ | 17/20 [00:54<00:09,  3.05s/it]
Task 9, Epoch 18/20 => Loss 0.393, Train_accy 93.85:  90%|█████████ | 18/20 [00:54<00:06,  3.05s/it]
Task 9, Epoch 19/20 => Loss 0.357, Train_accy 95.16:  90%|█████████ | 18/20 [00:57<00:06,  3.05s/it]
Task 9, Epoch 19/20 => Loss 0.357, Train_accy 95.16:  95%|█████████▌| 19/20 [00:57<00:03,  3.04s/it]
Task 9, Epoch 20/20 => Loss 0.399, Train_accy 95.16:  95%|█████████▌| 19/20 [01:00<00:03,  3.04s/it]
Task 9, Epoch 20/20 => Loss 0.399, Train_accy 95.16: 100%|██████████| 20/20 [01:00<00:00,  3.05s/it]
Task 9, Epoch 20/20 => Loss 0.399, Train_accy 95.16: 100%|██████████| 20/20 [01:00<00:00,  3.05s/it]
2024-09-06 05:27:06,015 [ease.py] => Task 9, Epoch 20/20 => Loss 0.399, Train_accy 95.16
2024-09-06 05:28:30,922 [ease.py] => Task correct: 85.79646017699115
2024-09-06 05:28:30,923 [ease.py] => Task acc: 98.40707964601769
2024-09-06 05:28:30,951 [trainer.py] => No NME accuracy.
2024-09-06 05:28:30,951 [trainer.py] => CNN: {'total': 85.44, '00-99': 82.15, '100-109': 90.43, '110-119': 81.42, '120-129': 79.44, '130-139': 88.98, '140-149': 84.92, '150-159': 99.19, '160-169': 91.04, '170-179': 95.15, '180-189': 90.15, 'old': 85.15, 'new': 90.15}
2024-09-06 05:28:30,951 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52, 87.02, 85.63, 86.3, 85.83, 85.71, 85.44]
2024-09-06 05:28:30,951 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75, 98.48, 98.3, 98.2, 98.02, 97.93, 97.61]

Average Accuracy (CNN): 87.92
2024-09-06 05:28:30,951 [trainer.py] => Average Accuracy (CNN): 87.92 

2024-09-06 05:28:30,952 [trainer.py] => All params: 87569858
2024-09-06 05:28:30,953 [trainer.py] => Trainable params: 304320
2024-09-06 05:28:30,969 [ease.py] => Learning on 190-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.268, Train_accy 35.41:   0%|          | 0/20 [00:03<?, ?it/s]
Task 10, Epoch 1/20 => Loss 2.268, Train_accy 35.41:   5%|▌         | 1/20 [00:03<01:01,  3.26s/it]
Task 10, Epoch 2/20 => Loss 2.126, Train_accy 84.31:   5%|▌         | 1/20 [00:06<01:01,  3.26s/it]
Task 10, Epoch 2/20 => Loss 2.126, Train_accy 84.31:  10%|█         | 2/20 [00:06<00:59,  3.29s/it]
Task 10, Epoch 3/20 => Loss 1.878, Train_accy 91.55:  10%|█         | 2/20 [00:09<00:59,  3.29s/it]
Task 10, Epoch 3/20 => Loss 1.878, Train_accy 91.55:  15%|█▌        | 3/20 [00:09<00:55,  3.28s/it]
Task 10, Epoch 4/20 => Loss 1.520, Train_accy 92.15:  15%|█▌        | 3/20 [00:13<00:55,  3.28s/it]
Task 10, Epoch 4/20 => Loss 1.520, Train_accy 92.15:  20%|██        | 4/20 [00:13<00:53,  3.31s/it]
Task 10, Epoch 5/20 => Loss 1.167, Train_accy 93.16:  20%|██        | 4/20 [00:16<00:53,  3.31s/it]
Task 10, Epoch 5/20 => Loss 1.167, Train_accy 93.16:  25%|██▌       | 5/20 [00:16<00:49,  3.30s/it]
Task 10, Epoch 6/20 => Loss 0.846, Train_accy 95.57:  25%|██▌       | 5/20 [00:19<00:49,  3.30s/it]
Task 10, Epoch 6/20 => Loss 0.846, Train_accy 95.57:  30%|███       | 6/20 [00:19<00:46,  3.29s/it]
Task 10, Epoch 7/20 => Loss 0.693, Train_accy 93.16:  30%|███       | 6/20 [00:23<00:46,  3.29s/it]
Task 10, Epoch 7/20 => Loss 0.693, Train_accy 93.16:  35%|███▌      | 7/20 [00:23<00:42,  3.29s/it]
Task 10, Epoch 8/20 => Loss 0.580, Train_accy 93.16:  35%|███▌      | 7/20 [00:26<00:42,  3.29s/it]
Task 10, Epoch 8/20 => Loss 0.580, Train_accy 93.16:  40%|████      | 8/20 [00:26<00:39,  3.28s/it]
Task 10, Epoch 9/20 => Loss 0.488, Train_accy 93.36:  40%|████      | 8/20 [00:29<00:39,  3.28s/it]
Task 10, Epoch 9/20 => Loss 0.488, Train_accy 93.36:  45%|████▌     | 9/20 [00:29<00:36,  3.28s/it]
Task 10, Epoch 10/20 => Loss 0.438, Train_accy 93.16:  45%|████▌     | 9/20 [00:32<00:36,  3.28s/it]
Task 10, Epoch 10/20 => Loss 0.438, Train_accy 93.16:  50%|█████     | 10/20 [00:32<00:32,  3.28s/it]
Task 10, Epoch 11/20 => Loss 0.379, Train_accy 93.96:  50%|█████     | 10/20 [00:36<00:32,  3.28s/it]
Task 10, Epoch 11/20 => Loss 0.379, Train_accy 93.96:  55%|█████▌    | 11/20 [00:36<00:29,  3.28s/it]
Task 10, Epoch 12/20 => Loss 0.333, Train_accy 95.57:  55%|█████▌    | 11/20 [00:39<00:29,  3.28s/it]
Task 10, Epoch 12/20 => Loss 0.333, Train_accy 95.57:  60%|██████    | 12/20 [00:39<00:26,  3.28s/it]
Task 10, Epoch 13/20 => Loss 0.371, Train_accy 94.16:  60%|██████    | 12/20 [00:42<00:26,  3.28s/it]
Task 10, Epoch 13/20 => Loss 0.371, Train_accy 94.16:  65%|██████▌   | 13/20 [00:42<00:23,  3.30s/it]
Task 10, Epoch 14/20 => Loss 0.339, Train_accy 94.77:  65%|██████▌   | 13/20 [00:46<00:23,  3.30s/it]
Task 10, Epoch 14/20 => Loss 0.339, Train_accy 94.77:  70%|███████   | 14/20 [00:46<00:19,  3.29s/it]
Task 10, Epoch 15/20 => Loss 0.338, Train_accy 93.96:  70%|███████   | 14/20 [00:49<00:19,  3.29s/it]
Task 10, Epoch 15/20 => Loss 0.338, Train_accy 93.96:  75%|███████▌  | 15/20 [00:49<00:16,  3.30s/it]
Task 10, Epoch 16/20 => Loss 0.333, Train_accy 92.96:  75%|███████▌  | 15/20 [00:52<00:16,  3.30s/it]
Task 10, Epoch 16/20 => Loss 0.333, Train_accy 92.96:  80%|████████  | 16/20 [00:52<00:13,  3.29s/it]
Task 10, Epoch 17/20 => Loss 0.366, Train_accy 92.76:  80%|████████  | 16/20 [00:55<00:13,  3.29s/it]
Task 10, Epoch 17/20 => Loss 0.366, Train_accy 92.76:  85%|████████▌ | 17/20 [00:55<00:09,  3.28s/it]
Task 10, Epoch 18/20 => Loss 0.321, Train_accy 94.37:  85%|████████▌ | 17/20 [00:59<00:09,  3.28s/it]
Task 10, Epoch 18/20 => Loss 0.321, Train_accy 94.37:  90%|█████████ | 18/20 [00:59<00:06,  3.28s/it]
Task 10, Epoch 19/20 => Loss 0.338, Train_accy 93.16:  90%|█████████ | 18/20 [01:02<00:06,  3.28s/it]
Task 10, Epoch 19/20 => Loss 0.338, Train_accy 93.16:  95%|█████████▌| 19/20 [01:02<00:03,  3.28s/it]
Task 10, Epoch 20/20 => Loss 0.317, Train_accy 93.96:  95%|█████████▌| 19/20 [01:05<00:03,  3.28s/it]
Task 10, Epoch 20/20 => Loss 0.317, Train_accy 93.96: 100%|██████████| 20/20 [01:05<00:00,  3.30s/it]
Task 10, Epoch 20/20 => Loss 0.317, Train_accy 93.96: 100%|██████████| 20/20 [01:05<00:00,  3.29s/it]
2024-09-06 05:29:36,752 [ease.py] => Task 10, Epoch 20/20 => Loss 0.317, Train_accy 93.96
2024-09-06 05:31:14,413 [ease.py] => Task correct: 84.13910093299407
2024-09-06 05:31:14,413 [ease.py] => Task acc: 98.38846480067853
2024-09-06 05:31:14,438 [trainer.py] => No NME accuracy.
2024-09-06 05:31:14,438 [trainer.py] => CNN: {'total': 83.76, '00-99': 79.29, '100-109': 90.43, '110-119': 81.42, '120-129': 79.44, '130-139': 88.98, '140-149': 84.13, '150-159': 98.39, '160-169': 86.57, '170-179': 93.2, '180-189': 88.64, '190-199': 91.84, 'old': 83.41, 'new': 91.84}
2024-09-06 05:31:14,438 [trainer.py] => CNN top1 curve: [93.35, 92.94, 89.48, 87.52, 87.02, 85.63, 86.3, 85.83, 85.71, 85.44, 83.76]
2024-09-06 05:31:14,438 [trainer.py] => CNN top5 curve: [98.99, 99.08, 98.87, 98.75, 98.48, 98.3, 98.2, 98.02, 97.93, 97.61, 97.63]

Average Accuracy (CNN): 87.54
2024-09-06 05:31:14,438 [trainer.py] => Average Accuracy (CNN): 87.54 

Accuracy Matrix (CNN):
[[93.35 92.68 88.64 86.2  85.61 83.42 83.59 82.83 82.41 82.15 79.29]
 [ 0.   95.65 95.65 94.78 93.91 93.04 89.57 89.57 90.43 90.43 90.43]
 [ 0.    0.   92.04 90.27 90.27 85.84 85.84 84.96 82.3  81.42 81.42]
 [ 0.    0.    0.   91.59 85.98 85.98 85.98 85.05 83.18 79.44 79.44]
 [ 0.    0.    0.    0.   92.37 92.37 91.53 89.83 89.83 88.98 88.98]
 [ 0.    0.    0.    0.    0.   92.86 92.06 88.89 85.71 84.92 84.13]
 [ 0.    0.    0.    0.    0.    0.   99.19 99.19 99.19 99.19 98.39]
 [ 0.    0.    0.    0.    0.    0.    0.   91.79 91.79 91.04 86.57]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   96.12 95.15 93.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   90.15 88.64]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   91.84]]
2024-09-06 05:31:14,440 [trainer.py] => Forgetting (CNN): 6.4620000000000015
